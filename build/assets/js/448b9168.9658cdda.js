(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[67002],{95412:(e,t,r)=>{"use strict";r.r(t),r.d(t,{assets:()=>B,contentTitle:()=>o,default:()=>c,frontMatter:()=>A,metadata:()=>s,toc:()=>D});var a=r(17624),i=r(4552),n=r(46880);const A={},o="Connecting external Javascript library",s={type:"mdx",permalink:"/wljs-docs/wljs-demo/mix-graph/",source:"@site/src/pages/wljs-demo/mix-graph/index.mdx",title:"Connecting external Javascript library",description:"How to make interactive 3D Force-Directed Graphs",frontMatter:{},unlisted:!1},B={},D=[{value:"How to make interactive 3D Force-Directed Graphs",id:"how-to-make-interactive-3d-force-directed-graphs",level:2},{value:"Testing",id:"testing",level:2}];function l(e){const t={a:"a",h1:"h1",h2:"h2",p:"p",strong:"strong",...(0,i.M)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"connecting-external-javascript-library",children:"Connecting external Javascript library"}),"\n",(0,a.jsx)(t.h2,{id:"how-to-make-interactive-3d-force-directed-graphs",children:"How to make interactive 3D Force-Directed Graphs"}),"\n",(0,a.jsxs)(t.p,{children:["There is an amazing ",(0,a.jsx)(t.a,{href:"https://github.com/vasturiano/3d-force-graph",children:"Javascript library"})," for building 3D force graphs using THREE.js."]}),"\n",(0,a.jsx)(t.p,{children:"We can build it into a standlone module for our notebooks using ESM cells. But firstly, lets fetch this library using NPM"}),"\n","\n",(0,a.jsx)(n.Af,{json:r(61848).c,notebook:r(15888).c}),"\n",(0,a.jsx)(n.EB,{display:"codemirror",nid:"0e558a46-d138-4d43-ac36-3fa77b0def40",id:"3bab2e3b-b744-473b-969a-f462a14eae74",type:"Input",opts:{},children:".sh%0Anpm%20i%203d-force-graph"}),"\n",(0,a.jsx)(n.EB,{display:"shell",nid:"0e558a46-d138-4d43-ac36-3fa77b0def40",id:"6efbe96f-ec01-455a-a217-0c3f24c94c1b",type:"Output",opts:{},children:"%0Aadded%2033%20packages%2C%20and%20audited%2037%20packages%20in%204s%0A%0Afound%200%20vulnerabilities%0A"}),"\n",(0,a.jsx)(t.p,{children:"Now define our function. WLJS Notebook has a system of shared Javascript libraries, which already provides some of the dependencies."}),"\n",(0,a.jsx)(n.EB,{display:"codemirror",nid:"0e558a46-d138-4d43-ac36-3fa77b0def40",id:"6298baa1-e049-4dda-8958-bad15ef7810d",type:"Input",opts:{Fade:!0},children:".esm%0Aimport%20ForceGraph3D%20from%20%273d-force-graph%27%3B%0A%0Acore.ForceGraph3D%20%3D%20async%20%28args%2C%20env%29%20%3D%3E%20%7B%20%0A%20%20%2F%2Fload%20shared%20library%20from%20WLJS%20Notebook%20store%0A%20%20await%20interpretate.shared.SpriteText.load%28%29%3B%0A%20%20%2F%2Finterprete%20input%20data%0A%20%20const%20data%20%3D%20await%20interpretate%28args%5B0%5D%2C%20env%29%3B%0A%0A%20%20const%20SpriteText%20%3D%20interpretate.shared.SpriteText.SpriteText%3B%0A%20%20const%20opts%20%3D%20await%20core._getRules%28args%2C%20env%29%3B%0A%0A%20%20%2F%2F%20Build%20labels%20mapping%0A%20%20const%20labels%20%3D%20%28opts.VertexLabels%20%7C%7C%20%5B%5D%29.reduce%28%28acc%2C%20%7B%20lhs%2C%20rhs%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20acc%5Blhs%5D%20%3D%20rhs%3B%0A%20%20%20%20return%20acc%3B%0A%20%20%7D%2C%20%7B%7D%29%3B%0A%0A%20%20%2F%2F%20Collect%20node%20IDs%20and%20construct%20links%0A%20%20const%20nodeIds%20%3D%20new%20Set%28%29%3B%0A%20%20const%20links%20%3D%20data.map%28%28%7B%20lhs%2C%20rhs%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20nodeIds.add%28lhs%29%3B%0A%20%20%20%20nodeIds.add%28rhs%29%3B%0A%20%20%20%20return%20%7B%20source%3A%20String%28rhs%29%2C%20target%3A%20String%28lhs%29%20%7D%3B%0A%20%20%7D%29%3B%0A%0A%20%20%2F%2F%20Create%20nodes%20with%20labels%0A%20%20const%20nodes%20%3D%20Array.from%28nodeIds%29.map%28id%20%3D%3E%20%28%7B%0A%20%20%20%20id%3A%20String%28id%29%2C%0A%20%20%20%20label%3A%20labels%5Bid%5D%20%7C%7C%20String%28id%29%2C%0A%20%20%7D%29%29%3B%0A%0A%20%20let%20imageSize%20%3D%20%28opts.ImageSize%29%20%7C%7C%20350%3B%0A%0A%20%20if%20%28%21Array.isArray%28imageSize%29%29%20%7B%0A%20%20%20%20imageSize%20%3D%20%5BimageSize%2C%20imageSize%20%2A%200.7%5D%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Initialize%20the%203D%20force%20graph%0A%20%20const%20Graph%20%3D%20ForceGraph3D%28%7B%7D%29%28env.element%29%0A%20%20%20%20.width%28imageSize%5B0%5D%29%0A%20%20%20%20.height%28imageSize%5B1%5D%29%0A%20%20%20%20.cooldownTicks%28100%29%0A%20%20%20%20.graphData%28%7B%20nodes%2C%20links%20%7D%29%0A%20%20%20%20.nodeThreeObject%28node%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20sprite%20%3D%20new%20SpriteText%28node.label%29%3B%0A%20%20%20%20%20%20sprite.material.depthWrite%20%3D%20true%3B%20%2F%2F%20Make%20sprite%20background%20transparent%0A%20%20%20%20%20%20sprite.color%20%3D%20%27white%27%3B%0A%20%20%20%20%20%20sprite.textHeight%20%3D%2012%3B%0A%20%20%20%20%20%20return%20sprite%3B%0A%20%20%20%20%7D%29%0A%20%20%20%20.nodeThreeObjectExtend%28false%29%3B%0A%0A%20%20%2F%2F%20Apply%20optional%20charge%20strength%0A%20%20if%20%28%27Charge%27%20in%20opts%29%20%7B%0A%20%20%20%20Graph.d3Force%28%27charge%27%29.strength%28opts.Charge%29%3B%0A%20%20%7D%0A%0A%20%20Graph.onEngineStop%28%28%29%20%3D%3E%20Graph.zoomToFit%28400%29%29%3B%0A%0A%20%20env.local.Graph%20%3D%20Graph%3B%0A%7D%3B%0A%0Acore.ForceGraph3D.destroy%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20console.warn%28%273D%20graph%20was%20removed%27%29%3B%0A%7D%0A%0A%2F%2Fmake%20each%20instance%20unique%0Acore.ForceGraph3D.virtual%20%3D%20true%20%20%0A"}),"\n",(0,a.jsx)(n.EB,{display:"esm",nid:"0e558a46-d138-4d43-ac36-3fa77b0def40",id:"d81ffd6f-7664-4c65-915e-4084f73925d7",type:"Output",opts:{},children:"var%20__create%20%3D%20Object.create%3B%0Avar%20__defProp%20%3D%20Object.defineProperty%3B%0Avar%20__getOwnPropDesc%20%3D%20Object.getOwnPropertyDescriptor%3B%0Avar%20__getOwnPropNames%20%3D%20Object.getOwnPropertyNames%3B%0Avar%20__getProtoOf%20%3D%20Object.getPrototypeOf%3B%0Avar%20__hasOwnProp%20%3D%20Object.prototype.hasOwnProperty%3B%0Avar%20__commonJS%20%3D%20%28cb%2C%20mod2%29%20%3D%3E%20function%20__require%28%29%20%7B%0A%20%20return%20mod2%20%7C%7C%20%280%2C%20cb%5B__getOwnPropNames%28cb%29%5B0%5D%5D%29%28%28mod2%20%3D%20%7B%20exports%3A%20%7B%7D%20%7D%29.exports%2C%20mod2%29%2C%20mod2.exports%3B%0A%7D%3B%0Avar%20__copyProps%20%3D%20%28to%2C%20from%2C%20except%2C%20desc%29%20%3D%3E%20%7B%0A%20%20if%20%28from%20%26%26%20typeof%20from%20%3D%3D%3D%20%22object%22%20%7C%7C%20typeof%20from%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20for%20%28let%20key%20of%20__getOwnPropNames%28from%29%29%0A%20%20%20%20%20%20if%20%28%21__hasOwnProp.call%28to%2C%20key%29%20%26%26%20key%20%21%3D%3D%20except%29%0A%20%20%20%20%20%20%20%20__defProp%28to%2C%20key%2C%20%7B%20get%3A%20%28%29%20%3D%3E%20from%5Bkey%5D%2C%20enumerable%3A%20%21%28desc%20%3D%20__getOwnPropDesc%28from%2C%20key%29%29%20%7C%7C%20desc.enumerable%20%7D%29%3B%0A%20%20%7D%0A%20%20return%20to%3B%0A%7D%3B%0Avar%20__toESM%20%3D%20%28mod2%2C%20isNodeMode%2C%20target%29%20%3D%3E%20%28target%20%3D%20mod2%20%21%3D%20null%20%3F%20__create%28__getProtoOf%28mod2%29%29%20%3A%20%7B%7D%2C%20__copyProps%28%0A%20%20%2F%2F%20If%20the%20importer%20is%20in%20node%20compatibility%20mode%20or%20this%20is%20not%20an%20ESM%0A%20%20%2F%2F%20file%20that%20has%20been%20converted%20to%20a%20CommonJS%20file%20using%20a%20Babel-%0A%20%20%2F%2F%20compatible%20transform%20%28i.e.%20%22__esModule%22%20has%20not%20been%20set%29%2C%20then%20set%0A%20%20%2F%2F%20%22default%22%20to%20the%20CommonJS%20%22module.exports%22%20for%20node%20compatibility.%0A%20%20isNodeMode%20%7C%7C%20%21mod2%20%7C%7C%20%21mod2.__esModule%20%3F%20__defProp%28target%2C%20%22default%22%2C%20%7B%20value%3A%20mod2%2C%20enumerable%3A%20true%20%7D%29%20%3A%20target%2C%0A%20%20mod2%0A%29%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.events%2Findex.js%0Avar%20require_ngraph%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.events%2Findex.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20module.exports%20%3D%20function%20eventify%28subject%29%20%7B%0A%20%20%20%20%20%20validateSubject%28subject%29%3B%0A%20%20%20%20%20%20var%20eventsStorage%20%3D%20createEventsStorage%28subject%29%3B%0A%20%20%20%20%20%20subject.on%20%3D%20eventsStorage.on%3B%0A%20%20%20%20%20%20subject.off%20%3D%20eventsStorage.off%3B%0A%20%20%20%20%20%20subject.fire%20%3D%20eventsStorage.fire%3B%0A%20%20%20%20%20%20return%20subject%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20function%20createEventsStorage%28subject%29%20%7B%0A%20%20%20%20%20%20var%20registeredEvents%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Object.create%28null%29%3B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20on%3A%20function%28eventName%2C%20callback%2C%20ctx%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20callback%20%21%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22callback%20is%20expected%20to%20be%20a%20function%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20handlers%20%3D%20registeredEvents%5BeventName%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21handlers%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20handlers%20%3D%20registeredEvents%5BeventName%5D%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20handlers.push%28%7B%20callback%2C%20ctx%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20subject%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20off%3A%20function%28eventName%2C%20callback%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20wantToRemoveAll%20%3D%20typeof%20eventName%20%3D%3D%3D%20%22undefined%22%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28wantToRemoveAll%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20registeredEvents%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Object.create%28null%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20subject%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28registeredEvents%5BeventName%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20deleteAllCallbacksForEvent%20%3D%20typeof%20callback%20%21%3D%3D%20%22function%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28deleteAllCallbacksForEvent%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20delete%20registeredEvents%5BeventName%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20callbacks%20%3D%20registeredEvents%5BeventName%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20callbacks.length%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28callbacks%5Bi%5D.callback%20%3D%3D%3D%20callback%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20callbacks.splice%28i%2C%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20subject%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20fire%3A%20function%28eventName%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20callbacks%20%3D%20registeredEvents%5BeventName%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21callbacks%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20subject%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20fireArguments%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28arguments.length%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20fireArguments%20%3D%20Array.prototype.splice.call%28arguments%2C%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20callbacks.length%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20callbackInfo%20%3D%20callbacks%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20callbackInfo.callback.apply%28callbackInfo.ctx%2C%20fireArguments%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20subject%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20validateSubject%28subject%29%20%7B%0A%20%20%20%20%20%20if%20%28%21subject%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Eventify%20cannot%20use%20falsy%20object%20as%20events%20subject%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20reservedWords%20%3D%20%5B%22on%22%2C%20%22fire%22%2C%20%22off%22%5D%3B%0A%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20reservedWords.length%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28subject.hasOwnProperty%28reservedWords%5Bi%5D%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Subject%20cannot%20be%20eventified%2C%20since%20it%20already%20has%20property%20%27%22%20%2B%20reservedWords%5Bi%5D%20%2B%20%22%27%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.graph%2Findex.js%0Avar%20require_ngraph2%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.graph%2Findex.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20module.exports%20%3D%20createGraph%3B%0A%20%20%20%20var%20eventify%20%3D%20require_ngraph%28%29%3B%0A%20%20%20%20function%20createGraph%28options%29%20%7B%0A%20%20%20%20%20%20options%20%3D%20options%20%7C%7C%20%7B%7D%3B%0A%20%20%20%20%20%20if%20%28%22uniqueLinkId%22%20in%20options%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%0A%20%20%20%20%20%20%20%20%20%20%22ngraph.graph%3A%20Starting%20from%20version%200.14%20%60uniqueLinkId%60%20is%20deprecated.%5CnUse%20%60multigraph%60%20option%20instead%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%20%20%22%5Cn%22%2C%0A%20%20%20%20%20%20%20%20%20%20%22Note%3A%20there%20is%20also%20change%20in%20default%20behavior%3A%20From%20now%20on%20each%20graph%5Cnis%20considered%20to%20be%20not%20a%20multigraph%20by%20default%20%28each%20edge%20is%20unique%29.%22%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20options.multigraph%20%3D%20options.uniqueLinkId%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28options.multigraph%20%3D%3D%3D%20void%200%29%20options.multigraph%20%3D%20false%3B%0A%20%20%20%20%20%20if%20%28typeof%20Map%20%21%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22ngraph.graph%20requires%20%60Map%60%20to%20be%20defined.%20Please%20polyfill%20it%20before%20using%20ngraph%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20nodes%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20%20%20var%20links%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20%20%20var%20multiEdges%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20var%20suspendEvents%20%3D%200%3B%0A%20%20%20%20%20%20var%20createLink%20%3D%20options.multigraph%20%3F%20createUniqueLink%20%3A%20createSingleLink%2C%20changes%20%3D%20%5B%5D%2C%20recordLinkChange%20%3D%20noop2%2C%20recordNodeChange%20%3D%20noop2%2C%20enterModification%20%3D%20noop2%2C%20exitModification%20%3D%20noop2%3B%0A%20%20%20%20%20%20var%20graphPart%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Sometimes%20duck%20typing%20could%20be%20slow.%20Giving%20clients%20a%20hint%20about%20data%20structure%0A%20%20%20%20%20%20%20%20%20%2A%20via%20explicit%20version%20number%20here%3A%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20version%3A%2020%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Adds%20node%20to%20the%20graph.%20If%20node%20with%20given%20id%20already%20exists%20in%20the%20graph%0A%20%20%20%20%20%20%20%20%20%2A%20its%20data%20is%20extended%20with%20whatever%20comes%20in%20%27data%27%20argument.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20nodeId%20the%20node%27s%20identifier.%20A%20string%20or%20number%20is%20preferred.%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%5Bdata%5D%20additional%20data%20for%20the%20node%20being%20added.%20If%20node%20already%0A%20%20%20%20%20%20%20%20%20%2A%20%20%20exists%20its%20data%20object%20is%20augmented%20with%20the%20new%20one.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40return%20%7Bnode%7D%20The%20newly%20added%20node%20or%20node%20with%20given%20id%20if%20it%20already%20exists.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20addNode%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Adds%20a%20link%20to%20the%20graph.%20The%20function%20always%20create%20a%20new%0A%20%20%20%20%20%20%20%20%20%2A%20link%20between%20two%20nodes.%20If%20one%20of%20the%20nodes%20does%20not%20exists%0A%20%20%20%20%20%20%20%20%20%2A%20a%20new%20node%20is%20created.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20fromId%20link%20start%20node%20id%3B%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20toId%20link%20end%20node%20id%3B%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%5Bdata%5D%20additional%20data%20to%20be%20set%20on%20the%20new%20link%3B%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40return%20%7Blink%7D%20The%20newly%20created%20link%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20addLink%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Removes%20link%20from%20the%20graph.%20If%20link%20does%20not%20exist%20does%20nothing.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20link%20-%20object%20returned%20by%20addLink%28%29%20or%20getLinks%28%29%20methods.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20true%20if%20link%20was%20removed%3B%20false%20otherwise.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20removeLink%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Removes%20node%20with%20given%20id%20from%20the%20graph.%20If%20node%20does%20not%20exist%20in%20the%20graph%0A%20%20%20%20%20%20%20%20%20%2A%20does%20nothing.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20nodeId%20node%27s%20identifier%20passed%20to%20addNode%28%29%20function.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20true%20if%20node%20was%20removed%3B%20false%20otherwise.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20removeNode%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20node%20with%20given%20identifier.%20If%20node%20does%20not%20exist%20undefined%20value%20is%20returned.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20nodeId%20requested%20node%20identifier%3B%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40return%20%7Bnode%7D%20in%20with%20requested%20identifier%20or%20undefined%20if%20no%20such%20node%20exists.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getNode%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20number%20of%20nodes%20in%20this%20graph.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40return%20number%20of%20nodes%20in%20the%20graph.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getNodeCount%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20total%20number%20of%20links%20in%20the%20graph.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getLinkCount%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20total%20number%20of%20links%20in%20the%20graph.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getEdgeCount%3A%20getLinkCount%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Synonym%20for%20%60getLinkCount%28%29%60%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getLinksCount%3A%20getLinkCount%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Synonym%20for%20%60getNodeCount%28%29%60%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getNodesCount%3A%20getNodeCount%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20all%20links%20%28inbound%20and%20outbound%29%20from%20the%20node%20with%20given%20id.%0A%20%20%20%20%20%20%20%20%20%2A%20If%20node%20with%20given%20id%20is%20not%20found%20null%20is%20returned.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20nodeId%20requested%20node%20identifier.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40return%20Set%20of%20links%20from%20and%20to%20requested%20node%20if%20such%20node%20exists%3B%0A%20%20%20%20%20%20%20%20%20%2A%20%20%20otherwise%20null%20is%20returned.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getLinks%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Invokes%20callback%20on%20each%20node%20of%20the%20graph.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7BFunction%28node%29%7D%20callback%20Function%20to%20be%20invoked.%20The%20function%0A%20%20%20%20%20%20%20%20%20%2A%20%20%20is%20passed%20one%20argument%3A%20visited%20node.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20forEachNode%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Invokes%20callback%20on%20every%20linked%20%28adjacent%29%20node%20to%20the%20given%20one.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20nodeId%20Identifier%20of%20the%20requested%20node.%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7BFunction%28node%2C%20link%29%7D%20callback%20Function%20to%20be%20called%20on%20all%20linked%20nodes.%0A%20%20%20%20%20%20%20%20%20%2A%20%20%20The%20function%20is%20passed%20two%20parameters%3A%20adjacent%20node%20and%20link%20object%20itself.%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20oriented%20if%20true%20graph%20treated%20as%20oriented.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20forEachLinkedNode%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Enumerates%20all%20links%20in%20the%20graph%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7BFunction%28link%29%7D%20callback%20Function%20to%20be%20called%20on%20all%20links%20in%20the%20graph.%0A%20%20%20%20%20%20%20%20%20%2A%20%20%20The%20function%20is%20passed%20one%20parameter%3A%20graph%27s%20link%20object.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Link%20object%20contains%20at%20least%20the%20following%20fields%3A%0A%20%20%20%20%20%20%20%20%20%2A%20%20fromId%20-%20node%20id%20where%20link%20starts%3B%0A%20%20%20%20%20%20%20%20%20%2A%20%20toId%20-%20node%20id%20where%20link%20ends%2C%0A%20%20%20%20%20%20%20%20%20%2A%20%20data%20-%20additional%20data%20passed%20to%20graph.addLink%28%29%20method.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20forEachLink%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Suspend%20all%20notifications%20about%20graph%20changes%20until%0A%20%20%20%20%20%20%20%20%20%2A%20endUpdate%20is%20called.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20beginUpdate%3A%20enterModification%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Resumes%20all%20notifications%20about%20graph%20changes%20and%20fires%0A%20%20%20%20%20%20%20%20%20%2A%20graph%20%27changed%27%20event%20in%20case%20there%20are%20any%20pending%20changes.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20endUpdate%3A%20exitModification%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Removes%20all%20nodes%20and%20links%20from%20the%20graph.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20clear%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Detects%20whether%20there%20is%20a%20link%20between%20two%20nodes.%0A%20%20%20%20%20%20%20%20%20%2A%20Operation%20complexity%20is%20O%28n%29%20where%20n%20-%20number%20of%20links%20of%20a%20node.%0A%20%20%20%20%20%20%20%20%20%2A%20NOTE%3A%20this%20function%20is%20synonym%20for%20getLink%28%29%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20link%20if%20there%20is%20one.%20null%20otherwise.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20hasLink%3A%20getLink%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Detects%20whether%20there%20is%20a%20node%20with%20given%20id%0A%20%20%20%20%20%20%20%20%20%2A%20%0A%20%20%20%20%20%20%20%20%20%2A%20Operation%20complexity%20is%20O%281%29%0A%20%20%20%20%20%20%20%20%20%2A%20NOTE%3A%20this%20function%20is%20synonym%20for%20getNode%28%29%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20node%20if%20there%20is%20one%3B%20Falsy%20value%20otherwise.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20hasNode%3A%20getNode%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20an%20edge%20between%20two%20nodes.%0A%20%20%20%20%20%20%20%20%20%2A%20Operation%20complexity%20is%20O%28n%29%20where%20n%20-%20number%20of%20links%20of%20a%20node.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bstring%7D%20fromId%20link%20start%20identifier%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bstring%7D%20toId%20link%20end%20identifier%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20link%20if%20there%20is%20one%3B%20undefined%20otherwise.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getLink%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20eventify%28graphPart%29%3B%0A%20%20%20%20%20%20monitorSubscribers%28%29%3B%0A%20%20%20%20%20%20return%20graphPart%3B%0A%20%20%20%20%20%20function%20monitorSubscribers%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20realOn%20%3D%20graphPart.on%3B%0A%20%20%20%20%20%20%20%20graphPart.on%20%3D%20on%3B%0A%20%20%20%20%20%20%20%20function%20on%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20graphPart.beginUpdate%20%3D%20enterModification%20%3D%20enterModificationReal%3B%0A%20%20%20%20%20%20%20%20%20%20graphPart.endUpdate%20%3D%20exitModification%20%3D%20exitModificationReal%3B%0A%20%20%20%20%20%20%20%20%20%20recordLinkChange%20%3D%20recordLinkChangeReal%3B%0A%20%20%20%20%20%20%20%20%20%20recordNodeChange%20%3D%20recordNodeChangeReal%3B%0A%20%20%20%20%20%20%20%20%20%20graphPart.on%20%3D%20realOn%3B%0A%20%20%20%20%20%20%20%20%20%20return%20realOn.apply%28graphPart%2C%20arguments%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20recordLinkChangeReal%28link%2C%20changeType%29%20%7B%0A%20%20%20%20%20%20%20%20changes.push%28%7B%0A%20%20%20%20%20%20%20%20%20%20link%2C%0A%20%20%20%20%20%20%20%20%20%20changeType%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20recordNodeChangeReal%28node%2C%20changeType%29%20%7B%0A%20%20%20%20%20%20%20%20changes.push%28%7B%0A%20%20%20%20%20%20%20%20%20%20node%2C%0A%20%20%20%20%20%20%20%20%20%20changeType%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20addNode%28nodeId%2C%20data%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28nodeId%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Invalid%20node%20identifier%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20enterModification%28%29%3B%0A%20%20%20%20%20%20%20%20var%20node%20%3D%20getNode%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%21node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20node%20%3D%20new%20Node2%28nodeId%2C%20data%29%3B%0A%20%20%20%20%20%20%20%20%20%20recordNodeChange%28node%2C%20%22add%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.data%20%3D%20data%3B%0A%20%20%20%20%20%20%20%20%20%20recordNodeChange%28node%2C%20%22update%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20nodes.set%28nodeId%2C%20node%29%3B%0A%20%20%20%20%20%20%20%20exitModification%28%29%3B%0A%20%20%20%20%20%20%20%20return%20node%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getNode%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20return%20nodes.get%28nodeId%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20removeNode%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20var%20node%20%3D%20getNode%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%21node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20enterModification%28%29%3B%0A%20%20%20%20%20%20%20%20var%20prevLinks%20%3D%20node.links%3B%0A%20%20%20%20%20%20%20%20if%20%28prevLinks%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20prevLinks.forEach%28removeLinkInstance%29%3B%0A%20%20%20%20%20%20%20%20%20%20node.links%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20nodes.delete%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20recordNodeChange%28node%2C%20%22remove%22%29%3B%0A%20%20%20%20%20%20%20%20exitModification%28%29%3B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20addLink%28fromId%2C%20toId%2C%20data%29%20%7B%0A%20%20%20%20%20%20%20%20enterModification%28%29%3B%0A%20%20%20%20%20%20%20%20var%20fromNode%20%3D%20getNode%28fromId%29%20%7C%7C%20addNode%28fromId%29%3B%0A%20%20%20%20%20%20%20%20var%20toNode%20%3D%20getNode%28toId%29%20%7C%7C%20addNode%28toId%29%3B%0A%20%20%20%20%20%20%20%20var%20link%20%3D%20createLink%28fromId%2C%20toId%2C%20data%29%3B%0A%20%20%20%20%20%20%20%20var%20isUpdate%20%3D%20links.has%28link.id%29%3B%0A%20%20%20%20%20%20%20%20links.set%28link.id%2C%20link%29%3B%0A%20%20%20%20%20%20%20%20addLinkToNode%28fromNode%2C%20link%29%3B%0A%20%20%20%20%20%20%20%20if%20%28fromId%20%21%3D%3D%20toId%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20addLinkToNode%28toNode%2C%20link%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20recordLinkChange%28link%2C%20isUpdate%20%3F%20%22update%22%20%3A%20%22add%22%29%3B%0A%20%20%20%20%20%20%20%20exitModification%28%29%3B%0A%20%20%20%20%20%20%20%20return%20link%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20createSingleLink%28fromId%2C%20toId%2C%20data%29%20%7B%0A%20%20%20%20%20%20%20%20var%20linkId%20%3D%20makeLinkId%28fromId%2C%20toId%29%3B%0A%20%20%20%20%20%20%20%20var%20prevLink%20%3D%20links.get%28linkId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28prevLink%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20prevLink.data%20%3D%20data%3B%0A%20%20%20%20%20%20%20%20%20%20return%20prevLink%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20new%20Link%28fromId%2C%20toId%2C%20data%2C%20linkId%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20createUniqueLink%28fromId%2C%20toId%2C%20data%29%20%7B%0A%20%20%20%20%20%20%20%20var%20linkId%20%3D%20makeLinkId%28fromId%2C%20toId%29%3B%0A%20%20%20%20%20%20%20%20var%20isMultiEdge%20%3D%20multiEdges.hasOwnProperty%28linkId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28isMultiEdge%20%7C%7C%20getLink%28fromId%2C%20toId%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21isMultiEdge%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20multiEdges%5BlinkId%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20suffix%20%3D%20%22%40%22%20%2B%20%2B%2BmultiEdges%5BlinkId%5D%3B%0A%20%20%20%20%20%20%20%20%20%20linkId%20%3D%20makeLinkId%28fromId%20%2B%20suffix%2C%20toId%20%2B%20suffix%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20new%20Link%28fromId%2C%20toId%2C%20data%2C%20linkId%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getNodeCount%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20nodes.size%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getLinkCount%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20links.size%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getLinks%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20var%20node%20%3D%20getNode%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20return%20node%20%3F%20node.links%20%3A%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20removeLink%28link%2C%20otherId%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28otherId%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20link%20%3D%20getLink%28link%2C%20otherId%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20removeLinkInstance%28link%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20removeLinkInstance%28link%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%21links.get%28link.id%29%29%20return%20false%3B%0A%20%20%20%20%20%20%20%20enterModification%28%29%3B%0A%20%20%20%20%20%20%20%20links.delete%28link.id%29%3B%0A%20%20%20%20%20%20%20%20var%20fromNode%20%3D%20getNode%28link.fromId%29%3B%0A%20%20%20%20%20%20%20%20var%20toNode%20%3D%20getNode%28link.toId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28fromNode%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20fromNode.links.delete%28link%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28toNode%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20toNode.links.delete%28link%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20recordLinkChange%28link%2C%20%22remove%22%29%3B%0A%20%20%20%20%20%20%20%20exitModification%28%29%3B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getLink%28fromNodeId%2C%20toNodeId%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28fromNodeId%20%3D%3D%3D%20void%200%20%7C%7C%20toNodeId%20%3D%3D%3D%20void%200%29%20return%20void%200%3B%0A%20%20%20%20%20%20%20%20return%20links.get%28makeLinkId%28fromNodeId%2C%20toNodeId%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20clear%28%29%20%7B%0A%20%20%20%20%20%20%20%20enterModification%28%29%3B%0A%20%20%20%20%20%20%20%20forEachNode%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20removeNode%28node.id%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20exitModification%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20forEachLink%28callback%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28typeof%20callback%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20valuesIterator%20%3D%20links.values%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20nextValue%20%3D%20valuesIterator.next%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20while%20%28%21nextValue.done%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28callback%28nextValue.value%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20nextValue%20%3D%20valuesIterator.next%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20forEachLinkedNode%28nodeId%2C%20callback%2C%20oriented%29%20%7B%0A%20%20%20%20%20%20%20%20var%20node%20%3D%20getNode%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28node%20%26%26%20node.links%20%26%26%20typeof%20callback%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28oriented%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20forEachOrientedLink%28node.links%2C%20nodeId%2C%20callback%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20forEachNonOrientedLink%28node.links%2C%20nodeId%2C%20callback%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20forEachNonOrientedLink%28links2%2C%20nodeId%2C%20callback%29%20%7B%0A%20%20%20%20%20%20%20%20var%20quitFast%3B%0A%20%20%20%20%20%20%20%20var%20valuesIterator%20%3D%20links2.values%28%29%3B%0A%20%20%20%20%20%20%20%20var%20nextValue%20%3D%20valuesIterator.next%28%29%3B%0A%20%20%20%20%20%20%20%20while%20%28%21nextValue.done%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20link%20%3D%20nextValue.value%3B%0A%20%20%20%20%20%20%20%20%20%20var%20linkedNodeId%20%3D%20link.fromId%20%3D%3D%3D%20nodeId%20%3F%20link.toId%20%3A%20link.fromId%3B%0A%20%20%20%20%20%20%20%20%20%20quitFast%20%3D%20callback%28nodes.get%28linkedNodeId%29%2C%20link%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28quitFast%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20nextValue%20%3D%20valuesIterator.next%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20forEachOrientedLink%28links2%2C%20nodeId%2C%20callback%29%20%7B%0A%20%20%20%20%20%20%20%20var%20quitFast%3B%0A%20%20%20%20%20%20%20%20var%20valuesIterator%20%3D%20links2.values%28%29%3B%0A%20%20%20%20%20%20%20%20var%20nextValue%20%3D%20valuesIterator.next%28%29%3B%0A%20%20%20%20%20%20%20%20while%20%28%21nextValue.done%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20link%20%3D%20nextValue.value%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28link.fromId%20%3D%3D%3D%20nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20quitFast%20%3D%20callback%28nodes.get%28link.toId%29%2C%20link%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28quitFast%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20nextValue%20%3D%20valuesIterator.next%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20noop2%28%29%20%7B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20enterModificationReal%28%29%20%7B%0A%20%20%20%20%20%20%20%20suspendEvents%20%2B%3D%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20exitModificationReal%28%29%20%7B%0A%20%20%20%20%20%20%20%20suspendEvents%20-%3D%201%3B%0A%20%20%20%20%20%20%20%20if%20%28suspendEvents%20%3D%3D%3D%200%20%26%26%20changes.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20graphPart.fire%28%22changed%22%2C%20changes%29%3B%0A%20%20%20%20%20%20%20%20%20%20changes.length%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20forEachNode%28callback%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28typeof%20callback%20%21%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Function%20is%20expected%20to%20iterate%20over%20graph%20nodes.%20You%20passed%20%22%20%2B%20callback%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20valuesIterator%20%3D%20nodes.values%28%29%3B%0A%20%20%20%20%20%20%20%20var%20nextValue%20%3D%20valuesIterator.next%28%29%3B%0A%20%20%20%20%20%20%20%20while%20%28%21nextValue.done%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28callback%28nextValue.value%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20nextValue%20%3D%20valuesIterator.next%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20Node2%28id2%2C%20data%29%20%7B%0A%20%20%20%20%20%20this.id%20%3D%20id2%3B%0A%20%20%20%20%20%20this.links%20%3D%20null%3B%0A%20%20%20%20%20%20this.data%20%3D%20data%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20addLinkToNode%28node%2C%20link%29%20%7B%0A%20%20%20%20%20%20if%20%28node.links%29%20%7B%0A%20%20%20%20%20%20%20%20node.links.add%28link%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node.links%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%5Blink%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20Link%28fromId%2C%20toId%2C%20data%2C%20id2%29%20%7B%0A%20%20%20%20%20%20this.fromId%20%3D%20fromId%3B%0A%20%20%20%20%20%20this.toId%20%3D%20toId%3B%0A%20%20%20%20%20%20this.data%20%3D%20data%3B%0A%20%20%20%20%20%20this.id%20%3D%20id2%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20makeLinkId%28fromId%2C%20toId%29%20%7B%0A%20%20%20%20%20%20return%20fromId.toString%28%29%20%2B%20%22%5Cu%7B1F449%7D%20%22%20%2B%20toId.toString%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgetVariableName.js%0Avar%20require_getVariableName%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgetVariableName.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20module.exports%20%3D%20function%20getVariableName%28index5%29%20%7B%0A%20%20%20%20%20%20if%20%28index5%20%3D%3D%3D%200%29%20return%20%22x%22%3B%0A%20%20%20%20%20%20if%20%28index5%20%3D%3D%3D%201%29%20return%20%22y%22%3B%0A%20%20%20%20%20%20if%20%28index5%20%3D%3D%3D%202%29%20return%20%22z%22%3B%0A%20%20%20%20%20%20return%20%22c%22%20%2B%20%28index5%20%2B%201%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FcreatePatternBuilder.js%0Avar%20require_createPatternBuilder%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FcreatePatternBuilder.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20var%20getVariableName%20%3D%20require_getVariableName%28%29%3B%0A%20%20%20%20module.exports%20%3D%20function%20createPatternBuilder%28dimension%29%20%7B%0A%20%20%20%20%20%20return%20pattern%3B%0A%20%20%20%20%20%20function%20pattern%28template%2C%20config%29%20%7B%0A%20%20%20%20%20%20%20%20let%20indent%20%3D%20config%20%26%26%20config.indent%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20let%20join%20%3D%20config%20%26%26%20config.join%20%21%3D%3D%20void%200%20%3F%20config.join%20%3A%20%22%5Cn%22%3B%0A%20%20%20%20%20%20%20%20let%20indentString%20%3D%20Array%28indent%20%2B%201%29.join%28%22%20%22%29%3B%0A%20%20%20%20%20%20%20%20let%20buffer2%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20dimension%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20let%20variableName%20%3D%20getVariableName%28i%29%3B%0A%20%20%20%20%20%20%20%20%20%20let%20prefix%20%3D%20i%20%3D%3D%3D%200%20%3F%20%22%22%20%3A%20indentString%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2.push%28prefix%20%2B%20template.replace%28%2F%7Bvar%7D%2Fg%2C%20variableName%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20buffer2.join%28join%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateCreateBody.js%0Avar%20require_generateCreateBody%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateCreateBody.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20var%20createPatternBuilder%20%3D%20require_createPatternBuilder%28%29%3B%0A%20%20%20%20module.exports%20%3D%20generateCreateBodyFunction%3B%0A%20%20%20%20module.exports.generateCreateBodyFunctionBody%20%3D%20generateCreateBodyFunctionBody%3B%0A%20%20%20%20module.exports.getVectorCode%20%3D%20getVectorCode%3B%0A%20%20%20%20module.exports.getBodyCode%20%3D%20getBodyCode%3B%0A%20%20%20%20function%20generateCreateBodyFunction%28dimension%2C%20debugSetters%29%20%7B%0A%20%20%20%20%20%20let%20code%20%3D%20generateCreateBodyFunctionBody%28dimension%2C%20debugSetters%29%3B%0A%20%20%20%20%20%20let%20%7B%20Body%20%7D%20%3D%20new%20Function%28code%29%28%29%3B%0A%20%20%20%20%20%20return%20Body%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateCreateBodyFunctionBody%28dimension%2C%20debugSetters%29%20%7B%0A%20%20%20%20%20%20let%20code%20%3D%20%60%0A%24%7BgetVectorCode%28dimension%2C%20debugSetters%29%7D%0A%24%7BgetBodyCode%28dimension%2C%20debugSetters%29%7D%0Areturn%20%7BBody%3A%20Body%2C%20Vector%3A%20Vector%7D%3B%0A%60%3B%0A%20%20%20%20%20%20return%20code%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20getBodyCode%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20pattern%20%3D%20createPatternBuilder%28dimension%29%3B%0A%20%20%20%20%20%20let%20variableList%20%3D%20pattern%28%22%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%2C%20%22%20%7D%29%3B%0A%20%20%20%20%20%20return%20%60%0Afunction%20Body%28%24%7BvariableList%7D%29%20%7B%0A%20%20this.isPinned%20%3D%20false%3B%0A%20%20this.pos%20%3D%20new%20Vector%28%24%7BvariableList%7D%29%3B%0A%20%20this.force%20%3D%20new%20Vector%28%29%3B%0A%20%20this.velocity%20%3D%20new%20Vector%28%29%3B%0A%20%20this.mass%20%3D%201%3B%0A%0A%20%20this.springCount%20%3D%200%3B%0A%20%20this.springLength%20%3D%200%3B%0A%7D%0A%0ABody.prototype.reset%20%3D%20function%28%29%20%7B%0A%20%20this.force.reset%28%29%3B%0A%20%20this.springCount%20%3D%200%3B%0A%20%20this.springLength%20%3D%200%3B%0A%7D%0A%0ABody.prototype.setPosition%20%3D%20function%20%28%24%7BvariableList%7D%29%20%7B%0A%20%20%24%7Bpattern%28%22this.pos.%7Bvar%7D%20%3D%20%7Bvar%7D%20%7C%7C%200%3B%22%2C%20%7B%20indent%3A%202%20%7D%29%7D%0A%7D%3B%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20getVectorCode%28dimension%2C%20debugSetters%29%20%7B%0A%20%20%20%20%20%20let%20pattern%20%3D%20createPatternBuilder%28dimension%29%3B%0A%20%20%20%20%20%20let%20setters%20%3D%20%22%22%3B%0A%20%20%20%20%20%20if%20%28debugSetters%29%20%7B%0A%20%20%20%20%20%20%20%20setters%20%3D%20%60%24%7Bpattern%28%22%5Cn%20%20%20var%20v%7Bvar%7D%3B%5CnObject.defineProperty%28this%2C%20%27%7Bvar%7D%27%2C%20%7B%5Cn%20%20set%3A%20function%28v%29%20%7B%20%5Cn%20%20%20%20if%20%28%21Number.isFinite%28v%29%29%20throw%20new%20Error%28%27Cannot%20set%20non-numbers%20to%20%7Bvar%7D%27%29%3B%5Cn%20%20%20%20v%7Bvar%7D%20%3D%20v%3B%20%5Cn%20%20%7D%2C%5Cn%20%20get%3A%20function%28%29%20%7B%20return%20v%7Bvar%7D%3B%20%7D%5Cn%7D%29%3B%22%29%7D%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20variableList%20%3D%20pattern%28%22%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%2C%20%22%20%7D%29%3B%0A%20%20%20%20%20%20return%20%60function%20Vector%28%24%7BvariableList%7D%29%20%7B%0A%20%20%24%7Bsetters%7D%0A%20%20%20%20if%20%28typeof%20arguments%5B0%5D%20%3D%3D%3D%20%27object%27%29%20%7B%0A%20%20%20%20%20%20%2F%2F%20could%20be%20another%20vector%0A%20%20%20%20%20%20let%20v%20%3D%20arguments%5B0%5D%3B%0A%20%20%20%20%20%20%24%7Bpattern%28%27if%20%28%21Number.isFinite%28v.%7Bvar%7D%29%29%20throw%20new%20Error%28%22Expected%20value%20is%20not%20a%20finite%20number%20at%20Vector%20constructor%20%28%7Bvar%7D%29%22%29%3B%27%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20%20%20%24%7Bpattern%28%22this.%7Bvar%7D%20%3D%20v.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%24%7Bpattern%28%27this.%7Bvar%7D%20%3D%20typeof%20%7Bvar%7D%20%3D%3D%3D%20%22number%22%20%3F%20%7Bvar%7D%20%3A%200%3B%27%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%0A%20%20Vector.prototype.reset%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20%24%7Bpattern%28%22this.%7Bvar%7D%20%3D%20%22%2C%20%7B%20join%3A%20%22%22%20%7D%29%7D0%3B%0A%20%20%7D%3B%60%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateQuadTree.js%0Avar%20require_generateQuadTree%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateQuadTree.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20var%20createPatternBuilder%20%3D%20require_createPatternBuilder%28%29%3B%0A%20%20%20%20var%20getVariableName%20%3D%20require_getVariableName%28%29%3B%0A%20%20%20%20module.exports%20%3D%20generateQuadTreeFunction%3B%0A%20%20%20%20module.exports.generateQuadTreeFunctionBody%20%3D%20generateQuadTreeFunctionBody%3B%0A%20%20%20%20module.exports.getInsertStackCode%20%3D%20getInsertStackCode%3B%0A%20%20%20%20module.exports.getQuadNodeCode%20%3D%20getQuadNodeCode%3B%0A%20%20%20%20module.exports.isSamePosition%20%3D%20isSamePosition%3B%0A%20%20%20%20module.exports.getChildBodyCode%20%3D%20getChildBodyCode%3B%0A%20%20%20%20module.exports.setChildBodyCode%20%3D%20setChildBodyCode%3B%0A%20%20%20%20function%20generateQuadTreeFunction%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20code%20%3D%20generateQuadTreeFunctionBody%28dimension%29%3B%0A%20%20%20%20%20%20return%20new%20Function%28code%29%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateQuadTreeFunctionBody%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20pattern%20%3D%20createPatternBuilder%28dimension%29%3B%0A%20%20%20%20%20%20let%20quadCount%20%3D%20Math.pow%282%2C%20dimension%29%3B%0A%20%20%20%20%20%20let%20code%20%3D%20%60%0A%24%7BgetInsertStackCode%28%29%7D%0A%24%7BgetQuadNodeCode%28dimension%29%7D%0A%24%7BisSamePosition%28dimension%29%7D%0A%24%7BgetChildBodyCode%28dimension%29%7D%0A%24%7BsetChildBodyCode%28dimension%29%7D%0A%0Afunction%20createQuadTree%28options%2C%20random%29%20%7B%0A%20%20options%20%3D%20options%20%7C%7C%20%7B%7D%3B%0A%20%20options.gravity%20%3D%20typeof%20options.gravity%20%3D%3D%3D%20%27number%27%20%3F%20options.gravity%20%3A%20-1%3B%0A%20%20options.theta%20%3D%20typeof%20options.theta%20%3D%3D%3D%20%27number%27%20%3F%20options.theta%20%3A%200.8%3B%0A%0A%20%20var%20gravity%20%3D%20options.gravity%3B%0A%20%20var%20updateQueue%20%3D%20%5B%5D%3B%0A%20%20var%20insertStack%20%3D%20new%20InsertStack%28%29%3B%0A%20%20var%20theta%20%3D%20options.theta%3B%0A%0A%20%20var%20nodesCache%20%3D%20%5B%5D%3B%0A%20%20var%20currentInCache%20%3D%200%3B%0A%20%20var%20root%20%3D%20newNode%28%29%3B%0A%0A%20%20return%20%7B%0A%20%20%20%20insertBodies%3A%20insertBodies%2C%0A%0A%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%2A%20Gets%20root%20node%20if%20it%20is%20present%0A%20%20%20%20%20%2A%2F%0A%20%20%20%20getRoot%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20root%3B%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20updateBodyForce%3A%20update%2C%0A%0A%20%20%20%20options%3A%20function%28newOptions%29%20%7B%0A%20%20%20%20%20%20if%20%28newOptions%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28typeof%20newOptions.gravity%20%3D%3D%3D%20%27number%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gravity%20%3D%20newOptions.gravity%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28typeof%20newOptions.theta%20%3D%3D%3D%20%27number%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20theta%20%3D%20newOptions.theta%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20gravity%3A%20gravity%2C%0A%20%20%20%20%20%20%20%20theta%3A%20theta%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20function%20newNode%28%29%20%7B%0A%20%20%20%20%2F%2F%20To%20avoid%20pressure%20on%20GC%20we%20reuse%20nodes.%0A%20%20%20%20var%20node%20%3D%20nodesCache%5BcurrentInCache%5D%3B%0A%20%20%20%20if%20%28node%29%20%7B%0A%24%7BassignQuads%28%22%20%20%20%20%20%20node.%22%29%7D%0A%20%20%20%20%20%20node.body%20%3D%20null%3B%0A%20%20%20%20%20%20node.mass%20%3D%20%24%7Bpattern%28%22node.mass_%7Bvar%7D%20%3D%20%22%2C%20%7B%20join%3A%20%22%22%20%7D%29%7D0%3B%0A%20%20%20%20%20%20%24%7Bpattern%28%22node.min_%7Bvar%7D%20%3D%20node.max_%7Bvar%7D%20%3D%20%22%2C%20%7B%20join%3A%20%22%22%20%7D%29%7D0%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20node%20%3D%20new%20QuadNode%28%29%3B%0A%20%20%20%20%20%20nodesCache%5BcurrentInCache%5D%20%3D%20node%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2B%2BcurrentInCache%3B%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%0A%20%20function%20update%28sourceBody%29%20%7B%0A%20%20%20%20var%20queue%20%3D%20updateQueue%3B%0A%20%20%20%20var%20v%3B%0A%20%20%20%20%24%7Bpattern%28%22var%20d%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20var%20r%3B%20%0A%20%20%20%20%24%7Bpattern%28%22var%20f%7Bvar%7D%20%3D%200%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20var%20queueLength%20%3D%201%3B%0A%20%20%20%20var%20shiftIdx%20%3D%200%3B%0A%20%20%20%20var%20pushIdx%20%3D%201%3B%0A%0A%20%20%20%20queue%5B0%5D%20%3D%20root%3B%0A%0A%20%20%20%20while%20%28queueLength%29%20%7B%0A%20%20%20%20%20%20var%20node%20%3D%20queue%5BshiftIdx%5D%3B%0A%20%20%20%20%20%20var%20body%20%3D%20node.body%3B%0A%0A%20%20%20%20%20%20queueLength%20-%3D%201%3B%0A%20%20%20%20%20%20shiftIdx%20%2B%3D%201%3B%0A%20%20%20%20%20%20var%20differentBody%20%3D%20%28body%20%21%3D%3D%20sourceBody%29%3B%0A%20%20%20%20%20%20if%20%28body%20%26%26%20differentBody%29%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20If%20the%20current%20node%20is%20a%20leaf%20node%20%28and%20it%20is%20not%20source%20body%29%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20calculate%20the%20force%20exerted%20by%20the%20current%20node%20on%20body%2C%20and%20add%20this%0A%20%20%20%20%20%20%20%20%2F%2F%20amount%20to%20body%27s%20net%20force.%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22d%7Bvar%7D%20%3D%20body.pos.%7Bvar%7D%20-%20sourceBody.pos.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%20%20%20%20%20%20%20%20r%20%3D%20Math.sqrt%28%24%7Bpattern%28%22d%7Bvar%7D%20%2A%20d%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%20%2B%20%22%20%7D%29%7D%29%3B%0A%0A%20%20%20%20%20%20%20%20if%20%28r%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20Poor%20man%27s%20protection%20against%20zero%20distance.%0A%20%20%20%20%20%20%20%20%20%20%24%7Bpattern%28%22d%7Bvar%7D%20%3D%20%28random.nextDouble%28%29%20-%200.5%29%20%2F%2050%3B%22%2C%20%7B%20indent%3A%2010%20%7D%29%7D%0A%20%20%20%20%20%20%20%20%20%20r%20%3D%20Math.sqrt%28%24%7Bpattern%28%22d%7Bvar%7D%20%2A%20d%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%20%2B%20%22%20%7D%29%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20This%20is%20standard%20gravitation%20force%20calculation%20but%20we%20divide%0A%20%20%20%20%20%20%20%20%2F%2F%20by%20r%5E3%20to%20save%20two%20operations%20when%20normalizing%20force%20vector.%0A%20%20%20%20%20%20%20%20v%20%3D%20gravity%20%2A%20body.mass%20%2A%20sourceBody.mass%20%2F%20%28r%20%2A%20r%20%2A%20r%29%3B%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22f%7Bvar%7D%20%2B%3D%20v%20%2A%20d%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28differentBody%29%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20Otherwise%2C%20calculate%20the%20ratio%20s%20%2F%20r%2C%20%20where%20s%20is%20the%20width%20of%20the%20region%0A%20%20%20%20%20%20%20%20%2F%2F%20represented%20by%20the%20internal%20node%2C%20and%20r%20is%20the%20distance%20between%20the%20body%0A%20%20%20%20%20%20%20%20%2F%2F%20and%20the%20node%27s%20center-of-mass%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22d%7Bvar%7D%20%3D%20node.mass_%7Bvar%7D%20%2F%20node.mass%20-%20sourceBody.pos.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%20%20%20%20%20%20%20%20r%20%3D%20Math.sqrt%28%24%7Bpattern%28%22d%7Bvar%7D%20%2A%20d%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%20%2B%20%22%20%7D%29%7D%29%3B%0A%0A%20%20%20%20%20%20%20%20if%20%28r%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20Sorry%20about%20code%20duplication.%20I%20don%27t%20want%20to%20create%20many%20functions%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20right%20away.%20Just%20want%20to%20see%20performance%20first.%0A%20%20%20%20%20%20%20%20%20%20%24%7Bpattern%28%22d%7Bvar%7D%20%3D%20%28random.nextDouble%28%29%20-%200.5%29%20%2F%2050%3B%22%2C%20%7B%20indent%3A%2010%20%7D%29%7D%0A%20%20%20%20%20%20%20%20%20%20r%20%3D%20Math.sqrt%28%24%7Bpattern%28%22d%7Bvar%7D%20%2A%20d%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%20%2B%20%22%20%7D%29%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20If%20s%20%2F%20r%20%3C%20%5Cu03B8%2C%20treat%20this%20internal%20node%20as%20a%20single%20body%2C%20and%20calculate%20the%0A%20%20%20%20%20%20%20%20%2F%2F%20force%20it%20exerts%20on%20sourceBody%2C%20and%20add%20this%20amount%20to%20sourceBody%27s%20net%20force.%0A%20%20%20%20%20%20%20%20if%20%28%28node.max_%24%7BgetVariableName%280%29%7D%20-%20node.min_%24%7BgetVariableName%280%29%7D%29%20%2F%20r%20%3C%20theta%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20in%20the%20if%20statement%20above%20we%20consider%20node%27s%20width%20only%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20because%20the%20region%20was%20made%20into%20square%20during%20tree%20creation.%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20Thus%20there%20is%20no%20difference%20between%20using%20width%20or%20height.%0A%20%20%20%20%20%20%20%20%20%20v%20%3D%20gravity%20%2A%20node.mass%20%2A%20sourceBody.mass%20%2F%20%28r%20%2A%20r%20%2A%20r%29%3B%0A%20%20%20%20%20%20%20%20%20%20%24%7Bpattern%28%22f%7Bvar%7D%20%2B%3D%20v%20%2A%20d%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%2010%20%7D%29%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20Otherwise%2C%20run%20the%20procedure%20recursively%20on%20each%20of%20the%20current%20node%27s%20children.%0A%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20I%20intentionally%20unfolded%20this%20loop%2C%20to%20save%20several%20CPU%20cycles.%0A%24%7BrunRecursiveOnChildren%28%29%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24%7Bpattern%28%22sourceBody.force.%7Bvar%7D%20%2B%3D%20f%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%7D%0A%0A%20%20function%20insertBodies%28bodies%29%20%7B%0A%20%20%20%20%24%7Bpattern%28%22var%20%7Bvar%7Dmin%20%3D%20Number.MAX_VALUE%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20%24%7Bpattern%28%22var%20%7Bvar%7Dmax%20%3D%20Number.MIN_VALUE%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20var%20i%20%3D%20bodies.length%3B%0A%0A%20%20%20%20%2F%2F%20To%20reduce%20quad%20tree%20depth%20we%20are%20looking%20for%20exact%20bounding%20box%20of%20all%20particles.%0A%20%20%20%20while%20%28i--%29%20%7B%0A%20%20%20%20%20%20var%20pos%20%3D%20bodies%5Bi%5D.pos%3B%0A%20%20%20%20%20%20%24%7Bpattern%28%22if%20%28pos.%7Bvar%7D%20%3C%20%7Bvar%7Dmin%29%20%7Bvar%7Dmin%20%3D%20pos.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%206%20%7D%29%7D%0A%20%20%20%20%20%20%24%7Bpattern%28%22if%20%28pos.%7Bvar%7D%20%3E%20%7Bvar%7Dmax%29%20%7Bvar%7Dmax%20%3D%20pos.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%206%20%7D%29%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20Makes%20the%20bounds%20square.%0A%20%20%20%20var%20maxSideLength%20%3D%20-Infinity%3B%0A%20%20%20%20%24%7Bpattern%28%22if%20%28%7Bvar%7Dmax%20-%20%7Bvar%7Dmin%20%3E%20maxSideLength%29%20maxSideLength%20%3D%20%7Bvar%7Dmax%20-%20%7Bvar%7Dmin%20%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%0A%20%20%20%20currentInCache%20%3D%200%3B%0A%20%20%20%20root%20%3D%20newNode%28%29%3B%0A%20%20%20%20%24%7Bpattern%28%22root.min_%7Bvar%7D%20%3D%20%7Bvar%7Dmin%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20%24%7Bpattern%28%22root.max_%7Bvar%7D%20%3D%20%7Bvar%7Dmin%20%2B%20maxSideLength%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%0A%20%20%20%20i%20%3D%20bodies.length%20-%201%3B%0A%20%20%20%20if%20%28i%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20root.body%20%3D%20bodies%5Bi%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20while%20%28i--%29%20%7B%0A%20%20%20%20%20%20insert%28bodies%5Bi%5D%2C%20root%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20function%20insert%28newBody%29%20%7B%0A%20%20%20%20insertStack.reset%28%29%3B%0A%20%20%20%20insertStack.push%28root%2C%20newBody%29%3B%0A%0A%20%20%20%20while%20%28%21insertStack.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20var%20stackItem%20%3D%20insertStack.pop%28%29%3B%0A%20%20%20%20%20%20var%20node%20%3D%20stackItem.node%3B%0A%20%20%20%20%20%20var%20body%20%3D%20stackItem.body%3B%0A%0A%20%20%20%20%20%20if%20%28%21node.body%29%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20This%20is%20internal%20node.%20Update%20the%20total%20mass%20of%20the%20node%20and%20center-of-mass.%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22var%20%7Bvar%7D%20%3D%20body.pos.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%20%20%20%20%20%20%20%20node.mass%20%2B%3D%20body.mass%3B%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22node.mass_%7Bvar%7D%20%2B%3D%20body.mass%20%2A%20%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Recursively%20insert%20the%20body%20in%20the%20appropriate%20quadrant.%0A%20%20%20%20%20%20%20%20%2F%2F%20But%20first%20find%20the%20appropriate%20quadrant.%0A%20%20%20%20%20%20%20%20var%20quadIdx%20%3D%200%3B%20%2F%2F%20Assume%20we%20are%20in%20the%200%27s%20quad.%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22var%20min_%7Bvar%7D%20%3D%20node.min_%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22var%20max_%7Bvar%7D%20%3D%20%28min_%7Bvar%7D%20%2B%20node.max_%7Bvar%7D%29%20%2F%202%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%0A%24%7BassignInsertionQuadIndex%288%29%7D%0A%0A%20%20%20%20%20%20%20%20var%20child%20%3D%20getChild%28node%2C%20quadIdx%29%3B%0A%0A%20%20%20%20%20%20%20%20if%20%28%21child%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20The%20node%20is%20internal%20but%20this%20quadrant%20is%20not%20taken.%20Add%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20subnode%20to%20it.%0A%20%20%20%20%20%20%20%20%20%20child%20%3D%20newNode%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%24%7Bpattern%28%22child.min_%7Bvar%7D%20%3D%20min_%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%2010%20%7D%29%7D%0A%20%20%20%20%20%20%20%20%20%20%24%7Bpattern%28%22child.max_%7Bvar%7D%20%3D%20max_%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%2010%20%7D%29%7D%0A%20%20%20%20%20%20%20%20%20%20child.body%20%3D%20body%3B%0A%0A%20%20%20%20%20%20%20%20%20%20setChild%28node%2C%20quadIdx%2C%20child%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20continue%20searching%20in%20this%20quadrant.%0A%20%20%20%20%20%20%20%20%20%20insertStack.push%28child%2C%20body%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20We%20are%20trying%20to%20add%20to%20the%20leaf%20node.%0A%20%20%20%20%20%20%20%20%2F%2F%20We%20have%20to%20convert%20current%20leaf%20into%20internal%20node%0A%20%20%20%20%20%20%20%20%2F%2F%20and%20continue%20adding%20two%20nodes.%0A%20%20%20%20%20%20%20%20var%20oldBody%20%3D%20node.body%3B%0A%20%20%20%20%20%20%20%20node.body%20%3D%20null%3B%20%2F%2F%20internal%20nodes%20do%20not%20cary%20bodies%0A%0A%20%20%20%20%20%20%20%20if%20%28isSamePosition%28oldBody.pos%2C%20body.pos%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20Prevent%20infinite%20subdivision%20by%20bumping%20one%20node%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20anywhere%20in%20this%20quadrant%0A%20%20%20%20%20%20%20%20%20%20var%20retriesCount%20%3D%203%3B%0A%20%20%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20offset%20%3D%20random.nextDouble%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24%7Bpattern%28%22var%20d%7Bvar%7D%20%3D%20%28node.max_%7Bvar%7D%20-%20node.min_%7Bvar%7D%29%20%2A%20offset%3B%22%2C%20%7B%20indent%3A%2012%20%7D%29%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24%7Bpattern%28%22oldBody.pos.%7Bvar%7D%20%3D%20node.min_%7Bvar%7D%20%2B%20d%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%2012%20%7D%29%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20retriesCount%20-%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Make%20sure%20we%20don%27t%20bump%20it%20out%20of%20the%20box.%20If%20we%20do%2C%20next%20iteration%20should%20fix%20it%0A%20%20%20%20%20%20%20%20%20%20%7D%20while%20%28retriesCount%20%3E%200%20%26%26%20isSamePosition%28oldBody.pos%2C%20body.pos%29%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20if%20%28retriesCount%20%3D%3D%3D%200%20%26%26%20isSamePosition%28oldBody.pos%2C%20body.pos%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20This%20is%20very%20bad%2C%20we%20ran%20out%20of%20precision.%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20if%20we%20do%20not%20return%20from%20the%20method%20we%27ll%20get%20into%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20infinite%20loop%20here.%20So%20we%20sacrifice%20correctness%20of%20layout%2C%20and%20keep%20the%20app%20running%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Next%20layout%20iteration%20should%20get%20larger%20bounding%20box%20in%20the%20first%20step%20and%20fix%20this%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20Next%20iteration%20should%20subdivide%20node%20further.%0A%20%20%20%20%20%20%20%20insertStack.push%28node%2C%20oldBody%29%3B%0A%20%20%20%20%20%20%20%20insertStack.push%28node%2C%20body%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Areturn%20createQuadTree%3B%0A%0A%60%3B%0A%20%20%20%20%20%20return%20code%3B%0A%20%20%20%20%20%20function%20assignInsertionQuadIndex%28indentCount%29%20%7B%0A%20%20%20%20%20%20%20%20let%20insertionCode%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20let%20indent%20%3D%20Array%28indentCount%20%2B%201%29.join%28%22%20%22%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20dimension%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20insertionCode.push%28indent%20%2B%20%60if%20%28%24%7BgetVariableName%28i%29%7D%20%3E%20max_%24%7BgetVariableName%28i%29%7D%29%20%7B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20insertionCode.push%28indent%20%2B%20%60%20%20quadIdx%20%3D%20quadIdx%20%2B%20%24%7BMath.pow%282%2C%20i%29%7D%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20insertionCode.push%28indent%20%2B%20%60%20%20min_%24%7BgetVariableName%28i%29%7D%20%3D%20max_%24%7BgetVariableName%28i%29%7D%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20insertionCode.push%28indent%20%2B%20%60%20%20max_%24%7BgetVariableName%28i%29%7D%20%3D%20node.max_%24%7BgetVariableName%28i%29%7D%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20insertionCode.push%28indent%20%2B%20%60%7D%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20insertionCode.join%28%22%5Cn%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20runRecursiveOnChildren%28%29%20%7B%0A%20%20%20%20%20%20%20%20let%20indent%20%3D%20Array%2811%29.join%28%22%20%22%29%3B%0A%20%20%20%20%20%20%20%20let%20recursiveCode%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20quadCount%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20recursiveCode.push%28indent%20%2B%20%60if%20%28node.quad%24%7Bi%7D%29%20%7B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20recursiveCode.push%28indent%20%2B%20%60%20%20queue%5BpushIdx%5D%20%3D%20node.quad%24%7Bi%7D%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20recursiveCode.push%28indent%20%2B%20%60%20%20queueLength%20%2B%3D%201%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20recursiveCode.push%28indent%20%2B%20%60%20%20pushIdx%20%2B%3D%201%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20recursiveCode.push%28indent%20%2B%20%60%7D%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20recursiveCode.join%28%22%5Cn%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20assignQuads%28indent%29%20%7B%0A%20%20%20%20%20%20%20%20let%20quads%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20quadCount%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20quads.push%28%60%24%7Bindent%7Dquad%24%7Bi%7D%20%3D%20null%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20quads.join%28%22%5Cn%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20isSamePosition%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20pattern%20%3D%20createPatternBuilder%28dimension%29%3B%0A%20%20%20%20%20%20return%20%60%0A%20%20function%20isSamePosition%28point1%2C%20point2%29%20%7B%0A%20%20%20%20%24%7Bpattern%28%22var%20d%7Bvar%7D%20%3D%20Math.abs%28point1.%7Bvar%7D%20-%20point2.%7Bvar%7D%29%3B%22%2C%20%7B%20indent%3A%202%20%7D%29%7D%0A%20%20%0A%20%20%20%20return%20%24%7Bpattern%28%22d%7Bvar%7D%20%3C%201e-8%22%2C%20%7B%20join%3A%20%22%20%26%26%20%22%20%7D%29%7D%3B%0A%20%20%7D%20%20%0A%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20setChildBodyCode%28dimension%29%20%7B%0A%20%20%20%20%20%20var%20quadCount%20%3D%20Math.pow%282%2C%20dimension%29%3B%0A%20%20%20%20%20%20return%20%60%0Afunction%20setChild%28node%2C%20idx%2C%20child%29%20%7B%0A%20%20%24%7BsetChildBody%28%29%7D%0A%7D%60%3B%0A%20%20%20%20%20%20function%20setChildBody%28%29%20%7B%0A%20%20%20%20%20%20%20%20let%20childBody%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20quadCount%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20let%20prefix%20%3D%20i%20%3D%3D%3D%200%20%3F%20%22%20%20%22%20%3A%20%22%20%20else%20%22%3B%0A%20%20%20%20%20%20%20%20%20%20childBody.push%28%60%24%7Bprefix%7Dif%20%28idx%20%3D%3D%3D%20%24%7Bi%7D%29%20node.quad%24%7Bi%7D%20%3D%20child%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20childBody.join%28%22%5Cn%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20getChildBodyCode%28dimension%29%20%7B%0A%20%20%20%20%20%20return%20%60function%20getChild%28node%2C%20idx%29%20%7B%0A%24%7BgetChildBody%28%29%7D%0A%20%20return%20null%3B%0A%7D%60%3B%0A%20%20%20%20%20%20function%20getChildBody%28%29%20%7B%0A%20%20%20%20%20%20%20%20let%20childBody%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20let%20quadCount%20%3D%20Math.pow%282%2C%20dimension%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20quadCount%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20childBody.push%28%60%20%20if%20%28idx%20%3D%3D%3D%20%24%7Bi%7D%29%20return%20node.quad%24%7Bi%7D%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20childBody.join%28%22%5Cn%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20getQuadNodeCode%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20pattern%20%3D%20createPatternBuilder%28dimension%29%3B%0A%20%20%20%20%20%20let%20quadCount%20%3D%20Math.pow%282%2C%20dimension%29%3B%0A%20%20%20%20%20%20var%20quadNodeCode%20%3D%20%60%0Afunction%20QuadNode%28%29%20%7B%0A%20%20%2F%2F%20body%20stored%20inside%20this%20node.%20In%20quad%20tree%20only%20leaf%20nodes%20%28by%20construction%29%0A%20%20%2F%2F%20contain%20bodies%3A%0A%20%20this.body%20%3D%20null%3B%0A%0A%20%20%2F%2F%20Child%20nodes%20are%20stored%20in%20quads.%20Each%20quad%20is%20presented%20by%20number%3A%0A%20%20%2F%2F%200%20%7C%201%0A%20%20%2F%2F%20-----%0A%20%20%2F%2F%202%20%7C%203%0A%24%7BassignQuads%28%22%20%20this.%22%29%7D%0A%0A%20%20%2F%2F%20Total%20mass%20of%20current%20node%0A%20%20this.mass%20%3D%200%3B%0A%0A%20%20%2F%2F%20Center%20of%20mass%20coordinates%0A%20%20%24%7Bpattern%28%22this.mass_%7Bvar%7D%20%3D%200%3B%22%2C%20%7B%20indent%3A%202%20%7D%29%7D%0A%0A%20%20%2F%2F%20bounding%20box%20coordinates%0A%20%20%24%7Bpattern%28%22this.min_%7Bvar%7D%20%3D%200%3B%22%2C%20%7B%20indent%3A%202%20%7D%29%7D%0A%20%20%24%7Bpattern%28%22this.max_%7Bvar%7D%20%3D%200%3B%22%2C%20%7B%20indent%3A%202%20%7D%29%7D%0A%7D%0A%60%3B%0A%20%20%20%20%20%20return%20quadNodeCode%3B%0A%20%20%20%20%20%20function%20assignQuads%28indent%29%20%7B%0A%20%20%20%20%20%20%20%20let%20quads%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20quadCount%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20quads.push%28%60%24%7Bindent%7Dquad%24%7Bi%7D%20%3D%20null%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20quads.join%28%22%5Cn%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20getInsertStackCode%28%29%20%7B%0A%20%20%20%20%20%20return%20%60%0A%2F%2A%2A%0A%20%2A%20Our%20implementation%20of%20QuadTree%20is%20non-recursive%20to%20avoid%20GC%20hit%0A%20%2A%20This%20data%20structure%20represent%20stack%20of%20elements%0A%20%2A%20which%20we%20are%20trying%20to%20insert%20into%20quad%20tree.%0A%20%2A%2F%0Afunction%20InsertStack%20%28%29%20%7B%0A%20%20%20%20this.stack%20%3D%20%5B%5D%3B%0A%20%20%20%20this.popIdx%20%3D%200%3B%0A%7D%0A%0AInsertStack.prototype%20%3D%20%7B%0A%20%20%20%20isEmpty%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this.popIdx%20%3D%3D%3D%200%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20push%3A%20function%20%28node%2C%20body%29%20%7B%0A%20%20%20%20%20%20%20%20var%20item%20%3D%20this.stack%5Bthis.popIdx%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28%21item%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20we%20are%20trying%20to%20avoid%20memory%20pressure%3A%20create%20new%20element%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20only%20when%20absolutely%20necessary%0A%20%20%20%20%20%20%20%20%20%20%20%20this.stack%5Bthis.popIdx%5D%20%3D%20new%20InsertStackElement%28node%2C%20body%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20item.node%20%3D%20node%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20item.body%20%3D%20body%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2B%2Bthis.popIdx%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20pop%3A%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.popIdx%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.stack%5B--this.popIdx%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20reset%3A%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20this.popIdx%20%3D%200%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0Afunction%20InsertStackElement%28node%2C%20body%29%20%7B%0A%20%20%20%20this.node%20%3D%20node%3B%20%2F%2F%20QuadTree%20node%0A%20%20%20%20this.body%20%3D%20body%3B%20%2F%2F%20physical%20body%20which%20needs%20to%20be%20inserted%20to%20node%0A%7D%0A%60%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateBounds.js%0Avar%20require_generateBounds%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateBounds.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20module.exports%20%3D%20generateBoundsFunction%3B%0A%20%20%20%20module.exports.generateFunctionBody%20%3D%20generateBoundsFunctionBody%3B%0A%20%20%20%20var%20createPatternBuilder%20%3D%20require_createPatternBuilder%28%29%3B%0A%20%20%20%20function%20generateBoundsFunction%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20code%20%3D%20generateBoundsFunctionBody%28dimension%29%3B%0A%20%20%20%20%20%20return%20new%20Function%28%22bodies%22%2C%20%22settings%22%2C%20%22random%22%2C%20code%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateBoundsFunctionBody%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20pattern%20%3D%20createPatternBuilder%28dimension%29%3B%0A%20%20%20%20%20%20let%20code%20%3D%20%60%0A%20%20var%20boundingBox%20%3D%20%7B%0A%20%20%20%20%24%7Bpattern%28%22min_%7Bvar%7D%3A%200%2C%20max_%7Bvar%7D%3A%200%2C%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%7D%3B%0A%0A%20%20return%20%7B%0A%20%20%20%20box%3A%20boundingBox%2C%0A%0A%20%20%20%20update%3A%20updateBoundingBox%2C%0A%0A%20%20%20%20reset%3A%20resetBoundingBox%2C%0A%0A%20%20%20%20getBestNewPosition%3A%20function%20%28neighbors%29%20%7B%0A%20%20%20%20%20%20var%20%24%7Bpattern%28%22base_%7Bvar%7D%20%3D%200%22%2C%20%7B%20join%3A%20%22%2C%20%22%20%7D%29%7D%3B%0A%0A%20%20%20%20%20%20if%20%28neighbors.length%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20neighbors.length%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20let%20neighborPos%20%3D%20neighbors%5Bi%5D.pos%3B%0A%20%20%20%20%20%20%20%20%20%20%24%7Bpattern%28%22base_%7Bvar%7D%20%2B%3D%20neighborPos.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%2010%20%7D%29%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22base_%7Bvar%7D%20%2F%3D%20neighbors.length%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22base_%7Bvar%7D%20%3D%20%28boundingBox.min_%7Bvar%7D%20%2B%20boundingBox.max_%7Bvar%7D%29%20%2F%202%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20var%20springLength%20%3D%20settings.springLength%3B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22%7Bvar%7D%3A%20base_%7Bvar%7D%20%2B%20%28random.nextDouble%28%29%20-%200.5%29%20%2A%20springLength%2C%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%0A%20%20function%20updateBoundingBox%28%29%20%7B%0A%20%20%20%20var%20i%20%3D%20bodies.length%3B%0A%20%20%20%20if%20%28i%20%3D%3D%3D%200%29%20return%3B%20%2F%2F%20No%20bodies%20-%20no%20borders.%0A%0A%20%20%20%20%24%7Bpattern%28%22var%20max_%7Bvar%7D%20%3D%20-Infinity%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20%24%7Bpattern%28%22var%20min_%7Bvar%7D%20%3D%20Infinity%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%0A%20%20%20%20while%28i--%29%20%7B%0A%20%20%20%20%20%20%2F%2F%20this%20is%20O%28n%29%2C%20it%20could%20be%20done%20faster%20with%20quadtree%2C%20if%20we%20check%20the%20root%20node%20bounds%0A%20%20%20%20%20%20var%20bodyPos%20%3D%20bodies%5Bi%5D.pos%3B%0A%20%20%20%20%20%20%24%7Bpattern%28%22if%20%28bodyPos.%7Bvar%7D%20%3C%20min_%7Bvar%7D%29%20min_%7Bvar%7D%20%3D%20bodyPos.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%206%20%7D%29%7D%0A%20%20%20%20%20%20%24%7Bpattern%28%22if%20%28bodyPos.%7Bvar%7D%20%3E%20max_%7Bvar%7D%29%20max_%7Bvar%7D%20%3D%20bodyPos.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%206%20%7D%29%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24%7Bpattern%28%22boundingBox.min_%7Bvar%7D%20%3D%20min_%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20%24%7Bpattern%28%22boundingBox.max_%7Bvar%7D%20%3D%20max_%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%7D%0A%0A%20%20function%20resetBoundingBox%28%29%20%7B%0A%20%20%20%20%24%7Bpattern%28%22boundingBox.min_%7Bvar%7D%20%3D%20boundingBox.max_%7Bvar%7D%20%3D%200%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%7D%0A%60%3B%0A%20%20%20%20%20%20return%20code%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateCreateDragForce.js%0Avar%20require_generateCreateDragForce%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateCreateDragForce.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20var%20createPatternBuilder%20%3D%20require_createPatternBuilder%28%29%3B%0A%20%20%20%20module.exports%20%3D%20generateCreateDragForceFunction%3B%0A%20%20%20%20module.exports.generateCreateDragForceFunctionBody%20%3D%20generateCreateDragForceFunctionBody%3B%0A%20%20%20%20function%20generateCreateDragForceFunction%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20code%20%3D%20generateCreateDragForceFunctionBody%28dimension%29%3B%0A%20%20%20%20%20%20return%20new%20Function%28%22options%22%2C%20code%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateCreateDragForceFunctionBody%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20pattern%20%3D%20createPatternBuilder%28dimension%29%3B%0A%20%20%20%20%20%20let%20code%20%3D%20%60%0A%20%20if%20%28%21Number.isFinite%28options.dragCoefficient%29%29%20throw%20new%20Error%28%27dragCoefficient%20is%20not%20a%20finite%20number%27%29%3B%0A%0A%20%20return%20%7B%0A%20%20%20%20update%3A%20function%28body%29%20%7B%0A%20%20%20%20%20%20%24%7Bpattern%28%22body.force.%7Bvar%7D%20-%3D%20options.dragCoefficient%20%2A%20body.velocity.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%206%20%7D%29%7D%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%60%3B%0A%20%20%20%20%20%20return%20code%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateCreateSpringForce.js%0Avar%20require_generateCreateSpringForce%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateCreateSpringForce.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20var%20createPatternBuilder%20%3D%20require_createPatternBuilder%28%29%3B%0A%20%20%20%20module.exports%20%3D%20generateCreateSpringForceFunction%3B%0A%20%20%20%20module.exports.generateCreateSpringForceFunctionBody%20%3D%20generateCreateSpringForceFunctionBody%3B%0A%20%20%20%20function%20generateCreateSpringForceFunction%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20code%20%3D%20generateCreateSpringForceFunctionBody%28dimension%29%3B%0A%20%20%20%20%20%20return%20new%20Function%28%22options%22%2C%20%22random%22%2C%20code%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateCreateSpringForceFunctionBody%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20pattern%20%3D%20createPatternBuilder%28dimension%29%3B%0A%20%20%20%20%20%20let%20code%20%3D%20%60%0A%20%20if%20%28%21Number.isFinite%28options.springCoefficient%29%29%20throw%20new%20Error%28%27Spring%20coefficient%20is%20not%20a%20number%27%29%3B%0A%20%20if%20%28%21Number.isFinite%28options.springLength%29%29%20throw%20new%20Error%28%27Spring%20length%20is%20not%20a%20number%27%29%3B%0A%0A%20%20return%20%7B%0A%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%2A%20Updates%20forces%20acting%20on%20a%20spring%0A%20%20%20%20%20%2A%2F%0A%20%20%20%20update%3A%20function%20%28spring%29%20%7B%0A%20%20%20%20%20%20var%20body1%20%3D%20spring.from%3B%0A%20%20%20%20%20%20var%20body2%20%3D%20spring.to%3B%0A%20%20%20%20%20%20var%20length%20%3D%20spring.length%20%3C%200%20%3F%20options.springLength%20%3A%20spring.length%3B%0A%20%20%20%20%20%20%24%7Bpattern%28%22var%20d%7Bvar%7D%20%3D%20body2.pos.%7Bvar%7D%20-%20body1.pos.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%206%20%7D%29%7D%0A%20%20%20%20%20%20var%20r%20%3D%20Math.sqrt%28%24%7Bpattern%28%22d%7Bvar%7D%20%2A%20d%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%20%2B%20%22%20%7D%29%7D%29%3B%0A%0A%20%20%20%20%20%20if%20%28r%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%24%7Bpattern%28%22d%7Bvar%7D%20%3D%20%28random.nextDouble%28%29%20-%200.5%29%20%2F%2050%3B%22%2C%20%7B%20indent%3A%208%20%7D%29%7D%0A%20%20%20%20%20%20%20%20r%20%3D%20Math.sqrt%28%24%7Bpattern%28%22d%7Bvar%7D%20%2A%20d%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%20%2B%20%22%20%7D%29%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20var%20d%20%3D%20r%20-%20length%3B%0A%20%20%20%20%20%20var%20coefficient%20%3D%20%28%28spring.coefficient%20%3E%200%29%20%3F%20spring.coefficient%20%3A%20options.springCoefficient%29%20%2A%20d%20%2F%20r%3B%0A%0A%20%20%20%20%20%20%24%7Bpattern%28%22body1.force.%7Bvar%7D%20%2B%3D%20coefficient%20%2A%20d%7Bvar%7D%22%2C%20%7B%20indent%3A%206%20%7D%29%7D%3B%0A%20%20%20%20%20%20body1.springCount%20%2B%3D%201%3B%0A%20%20%20%20%20%20body1.springLength%20%2B%3D%20r%3B%0A%0A%20%20%20%20%20%20%24%7Bpattern%28%22body2.force.%7Bvar%7D%20-%3D%20coefficient%20%2A%20d%7Bvar%7D%22%2C%20%7B%20indent%3A%206%20%7D%29%7D%3B%0A%20%20%20%20%20%20body2.springCount%20%2B%3D%201%3B%0A%20%20%20%20%20%20body2.springLength%20%2B%3D%20r%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%60%3B%0A%20%20%20%20%20%20return%20code%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateIntegrator.js%0Avar%20require_generateIntegrator%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcodeGenerators%2FgenerateIntegrator.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20var%20createPatternBuilder%20%3D%20require_createPatternBuilder%28%29%3B%0A%20%20%20%20module.exports%20%3D%20generateIntegratorFunction%3B%0A%20%20%20%20module.exports.generateIntegratorFunctionBody%20%3D%20generateIntegratorFunctionBody%3B%0A%20%20%20%20function%20generateIntegratorFunction%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20code%20%3D%20generateIntegratorFunctionBody%28dimension%29%3B%0A%20%20%20%20%20%20return%20new%20Function%28%22bodies%22%2C%20%22timeStep%22%2C%20%22adaptiveTimeStepWeight%22%2C%20code%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateIntegratorFunctionBody%28dimension%29%20%7B%0A%20%20%20%20%20%20let%20pattern%20%3D%20createPatternBuilder%28dimension%29%3B%0A%20%20%20%20%20%20let%20code%20%3D%20%60%0A%20%20var%20length%20%3D%20bodies.length%3B%0A%20%20if%20%28length%20%3D%3D%3D%200%29%20return%200%3B%0A%0A%20%20%24%7Bpattern%28%22var%20d%7Bvar%7D%20%3D%200%2C%20t%7Bvar%7D%20%3D%200%3B%22%2C%20%7B%20indent%3A%202%20%7D%29%7D%0A%0A%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20length%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20var%20body%20%3D%20bodies%5Bi%5D%3B%0A%20%20%20%20if%20%28body.isPinned%29%20continue%3B%0A%0A%20%20%20%20if%20%28adaptiveTimeStepWeight%20%26%26%20body.springCount%29%20%7B%0A%20%20%20%20%20%20timeStep%20%3D%20%28adaptiveTimeStepWeight%20%2A%20body.springLength%2Fbody.springCount%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20coeff%20%3D%20timeStep%20%2F%20body.mass%3B%0A%0A%20%20%20%20%24%7Bpattern%28%22body.velocity.%7Bvar%7D%20%2B%3D%20coeff%20%2A%20body.force.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20%24%7Bpattern%28%22var%20v%7Bvar%7D%20%3D%20body.velocity.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%20%20var%20v%20%3D%20Math.sqrt%28%24%7Bpattern%28%22v%7Bvar%7D%20%2A%20v%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%20%2B%20%22%20%7D%29%7D%29%3B%0A%0A%20%20%20%20if%20%28v%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%2F%2F%20We%20normalize%20it%20so%20that%20we%20move%20within%20timeStep%20range.%20%0A%20%20%20%20%20%20%2F%2F%20for%20the%20case%20when%20v%20%3C%3D%201%20-%20we%20let%20velocity%20to%20fade%20out.%0A%20%20%20%20%20%20%24%7Bpattern%28%22body.velocity.%7Bvar%7D%20%3D%20v%7Bvar%7D%20%2F%20v%3B%22%2C%20%7B%20indent%3A%206%20%7D%29%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24%7Bpattern%28%22d%7Bvar%7D%20%3D%20timeStep%20%2A%20body.velocity.%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%0A%20%20%20%20%24%7Bpattern%28%22body.pos.%7Bvar%7D%20%2B%3D%20d%7Bvar%7D%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%0A%20%20%20%20%24%7Bpattern%28%22t%7Bvar%7D%20%2B%3D%20Math.abs%28d%7Bvar%7D%29%3B%22%2C%20%7B%20indent%3A%204%20%7D%29%7D%0A%20%20%7D%0A%0A%20%20return%20%28%24%7Bpattern%28%22t%7Bvar%7D%20%2A%20t%7Bvar%7D%22%2C%20%7B%20join%3A%20%22%20%2B%20%22%20%7D%29%7D%29%2Flength%3B%0A%60%3B%0A%20%20%20%20%20%20return%20code%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2Fspring.js%0Avar%20require_spring%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2Fspring.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20module.exports%20%3D%20Spring%3B%0A%20%20%20%20function%20Spring%28fromBody%2C%20toBody%2C%20length2%2C%20springCoefficient%29%20%7B%0A%20%20%20%20%20%20this.from%20%3D%20fromBody%3B%0A%20%20%20%20%20%20this.to%20%3D%20toBody%3B%0A%20%20%20%20%20%20this.length%20%3D%20length2%3B%0A%20%20%20%20%20%20this.coefficient%20%3D%20springCoefficient%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.merge%2Findex.js%0Avar%20require_ngraph3%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.merge%2Findex.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20module.exports%20%3D%20merge%3B%0A%20%20%20%20function%20merge%28target%2C%20options%29%20%7B%0A%20%20%20%20%20%20var%20key%3B%0A%20%20%20%20%20%20if%20%28%21target%29%20%7B%0A%20%20%20%20%20%20%20%20target%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28options%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28key%20in%20options%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28options.hasOwnProperty%28key%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20targetHasIt%20%3D%20target.hasOwnProperty%28key%29%2C%20optionsValueType%20%3D%20typeof%20options%5Bkey%5D%2C%20shouldReplace%20%3D%20%21targetHasIt%20%7C%7C%20typeof%20target%5Bkey%5D%20%21%3D%3D%20optionsValueType%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28shouldReplace%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20target%5Bkey%5D%20%3D%20options%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28optionsValueType%20%3D%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20target%5Bkey%5D%20%3D%20merge%28target%5Bkey%5D%2C%20options%5Bkey%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20target%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.random%2Findex.js%0Avar%20require_ngraph4%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.random%2Findex.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20module.exports%20%3D%20random%3B%0A%20%20%20%20module.exports.random%20%3D%20random%2C%20module.exports.randomIterator%20%3D%20randomIterator%3B%0A%20%20%20%20function%20random%28inputSeed%29%20%7B%0A%20%20%20%20%20%20var%20seed%20%3D%20typeof%20inputSeed%20%3D%3D%3D%20%22number%22%20%3F%20inputSeed%20%3A%20%2B%2F%2A%20%40__PURE__%20%2A%2F%20new%20Date%28%29%3B%0A%20%20%20%20%20%20return%20new%20Generator%28seed%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20Generator%28seed%29%20%7B%0A%20%20%20%20%20%20this.seed%20%3D%20seed%3B%0A%20%20%20%20%7D%0A%20%20%20%20Generator.prototype.next%20%3D%20next%3B%0A%20%20%20%20Generator.prototype.nextDouble%20%3D%20nextDouble%3B%0A%20%20%20%20Generator.prototype.uniform%20%3D%20nextDouble%3B%0A%20%20%20%20Generator.prototype.gaussian%20%3D%20gaussian%3B%0A%20%20%20%20function%20gaussian%28%29%20%7B%0A%20%20%20%20%20%20var%20r%2C%20x2%2C%20y2%3B%0A%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20x2%20%3D%20this.nextDouble%28%29%20%2A%202%20-%201%3B%0A%20%20%20%20%20%20%20%20y2%20%3D%20this.nextDouble%28%29%20%2A%202%20-%201%3B%0A%20%20%20%20%20%20%20%20r%20%3D%20x2%20%2A%20x2%20%2B%20y2%20%2A%20y2%3B%0A%20%20%20%20%20%20%7D%20while%20%28r%20%3E%3D%201%20%7C%7C%20r%20%3D%3D%3D%200%29%3B%0A%20%20%20%20%20%20return%20x2%20%2A%20Math.sqrt%28-2%20%2A%20Math.log%28r%29%20%2F%20r%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20Generator.prototype.levy%20%3D%20levy%3B%0A%20%20%20%20function%20levy%28%29%20%7B%0A%20%20%20%20%20%20var%20beta%20%3D%203%20%2F%202%3B%0A%20%20%20%20%20%20var%20sigma%20%3D%20Math.pow%28%0A%20%20%20%20%20%20%20%20gamma%281%20%2B%20beta%29%20%2A%20Math.sin%28Math.PI%20%2A%20beta%20%2F%202%29%20%2F%20%28gamma%28%281%20%2B%20beta%29%20%2F%202%29%20%2A%20beta%20%2A%20Math.pow%282%2C%20%28beta%20-%201%29%20%2F%202%29%29%2C%0A%20%20%20%20%20%20%20%201%20%2F%20beta%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20return%20this.gaussian%28%29%20%2A%20sigma%20%2F%20Math.pow%28Math.abs%28this.gaussian%28%29%29%2C%201%20%2F%20beta%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20gamma%28z2%29%20%7B%0A%20%20%20%20%20%20return%20Math.sqrt%282%20%2A%20Math.PI%20%2F%20z2%29%20%2A%20Math.pow%281%20%2F%20Math.E%20%2A%20%28z2%20%2B%201%20%2F%20%2812%20%2A%20z2%20-%201%20%2F%20%2810%20%2A%20z2%29%29%29%2C%20z2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20nextDouble%28%29%20%7B%0A%20%20%20%20%20%20var%20seed%20%3D%20this.seed%3B%0A%20%20%20%20%20%20seed%20%3D%20seed%20%2B%202127912214%20%2B%20%28seed%20%3C%3C%2012%29%20%26%204294967295%3B%0A%20%20%20%20%20%20seed%20%3D%20%28seed%20%5E%203345072700%20%5E%20seed%20%3E%3E%3E%2019%29%20%26%204294967295%3B%0A%20%20%20%20%20%20seed%20%3D%20seed%20%2B%20374761393%20%2B%20%28seed%20%3C%3C%205%29%20%26%204294967295%3B%0A%20%20%20%20%20%20seed%20%3D%20%28seed%20%2B%203550635116%20%5E%20seed%20%3C%3C%209%29%20%26%204294967295%3B%0A%20%20%20%20%20%20seed%20%3D%20seed%20%2B%204251993797%20%2B%20%28seed%20%3C%3C%203%29%20%26%204294967295%3B%0A%20%20%20%20%20%20seed%20%3D%20%28seed%20%5E%203042594569%20%5E%20seed%20%3E%3E%3E%2016%29%20%26%204294967295%3B%0A%20%20%20%20%20%20this.seed%20%3D%20seed%3B%0A%20%20%20%20%20%20return%20%28seed%20%26%20268435455%29%20%2F%20268435456%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20next%28maxValue%29%20%7B%0A%20%20%20%20%20%20return%20Math.floor%28this.nextDouble%28%29%20%2A%20maxValue%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20randomIterator%28array%2C%20customRandom%29%20%7B%0A%20%20%20%20%20%20var%20localRandom%20%3D%20customRandom%20%7C%7C%20random%28%29%3B%0A%20%20%20%20%20%20if%20%28typeof%20localRandom.next%20%21%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22customRandom%20does%20not%20match%20expected%20API%3A%20next%28%29%20function%20is%20missing%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20forEach%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Shuffles%20array%20randomly%2C%20in%20place.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20shuffle%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20function%20shuffle%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20i%2C%20j%2C%20t%3B%0A%20%20%20%20%20%20%20%20for%20%28i%20%3D%20array.length%20-%201%3B%20i%20%3E%200%3B%20--i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20j%20%3D%20localRandom.next%28i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20t%20%3D%20array%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20array%5Bj%5D%20%3D%20array%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20array%5Bi%5D%20%3D%20t%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20array%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20forEach%28callback%29%20%7B%0A%20%20%20%20%20%20%20%20var%20i%2C%20j%2C%20t%3B%0A%20%20%20%20%20%20%20%20for%20%28i%20%3D%20array.length%20-%201%3B%20i%20%3E%200%3B%20--i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20j%20%3D%20localRandom.next%28i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20t%20%3D%20array%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20array%5Bj%5D%20%3D%20array%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20array%5Bi%5D%20%3D%20t%3B%0A%20%20%20%20%20%20%20%20%20%20callback%28t%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28array.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20callback%28array%5B0%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcreatePhysicsSimulator.js%0Avar%20require_createPhysicsSimulator%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Flib%2FcreatePhysicsSimulator.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20module.exports%20%3D%20createPhysicsSimulator%3B%0A%20%20%20%20var%20generateCreateBodyFunction%20%3D%20require_generateCreateBody%28%29%3B%0A%20%20%20%20var%20generateQuadTreeFunction%20%3D%20require_generateQuadTree%28%29%3B%0A%20%20%20%20var%20generateBoundsFunction%20%3D%20require_generateBounds%28%29%3B%0A%20%20%20%20var%20generateCreateDragForceFunction%20%3D%20require_generateCreateDragForce%28%29%3B%0A%20%20%20%20var%20generateCreateSpringForceFunction%20%3D%20require_generateCreateSpringForce%28%29%3B%0A%20%20%20%20var%20generateIntegratorFunction%20%3D%20require_generateIntegrator%28%29%3B%0A%20%20%20%20var%20dimensionalCache%20%3D%20%7B%7D%3B%0A%20%20%20%20function%20createPhysicsSimulator%28settings%29%20%7B%0A%20%20%20%20%20%20var%20Spring%20%3D%20require_spring%28%29%3B%0A%20%20%20%20%20%20var%20merge%20%3D%20require_ngraph3%28%29%3B%0A%20%20%20%20%20%20var%20eventify%20%3D%20require_ngraph%28%29%3B%0A%20%20%20%20%20%20if%20%28settings%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28settings.springCoeff%20%21%3D%3D%20void%200%29%20throw%20new%20Error%28%22springCoeff%20was%20renamed%20to%20springCoefficient%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28settings.dragCoeff%20%21%3D%3D%20void%200%29%20throw%20new%20Error%28%22dragCoeff%20was%20renamed%20to%20dragCoefficient%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20settings%20%3D%20merge%28settings%2C%20%7B%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Ideal%20length%20for%20links%20%28springs%20in%20physical%20model%29.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20springLength%3A%2010%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Hook%27s%20law%20coefficient.%201%20-%20solid%20spring.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20springCoefficient%3A%200.8%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Coulomb%27s%20law%20coefficient.%20It%27s%20used%20to%20repel%20nodes%20thus%20should%20be%20negative%0A%20%20%20%20%20%20%20%20%20%2A%20if%20you%20make%20it%20positive%20nodes%20start%20attract%20each%20other%20%3A%29.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20gravity%3A%20-12%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Theta%20coefficient%20from%20Barnes%20Hut%20simulation.%20Ranged%20between%20%280%2C%201%29.%0A%20%20%20%20%20%20%20%20%20%2A%20The%20closer%20it%27s%20to%201%20the%20more%20nodes%20algorithm%20will%20have%20to%20go%20through.%0A%20%20%20%20%20%20%20%20%20%2A%20Setting%20it%20to%20one%20makes%20Barnes%20Hut%20simulation%20no%20different%20from%0A%20%20%20%20%20%20%20%20%20%2A%20brute-force%20forces%20calculation%20%28each%20node%20is%20considered%29.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20theta%3A%200.8%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Drag%20force%20coefficient.%20Used%20to%20slow%20down%20system%2C%20thus%20should%20be%20less%20than%201.%0A%20%20%20%20%20%20%20%20%20%2A%20The%20closer%20it%20is%20to%200%20the%20less%20tight%20system%20will%20be.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20dragCoefficient%3A%200.9%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20TODO%3A%20Need%20to%20rename%20this%20to%20something%20better.%20E.g.%20%60dragCoefficient%60%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Default%20time%20step%20%28dt%29%20for%20forces%20integration%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20timeStep%3A%200.5%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Adaptive%20time%20step%20uses%20average%20spring%20length%20to%20compute%20actual%20time%20step%3A%0A%20%20%20%20%20%20%20%20%20%2A%20See%3A%20https%3A%2F%2Ftwitter.com%2Fanvaka%2Fstatus%2F1293067160755957760%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20adaptiveTimeStepWeight%3A%200%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20This%20parameter%20defines%20number%20of%20dimensions%20of%20the%20space%20where%20simulation%0A%20%20%20%20%20%20%20%20%20%2A%20is%20performed.%20%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20dimensions%3A%202%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20In%20debug%20mode%20more%20checks%20are%20performed%2C%20this%20will%20help%20you%20catch%20errors%0A%20%20%20%20%20%20%20%20%20%2A%20quickly%2C%20however%20for%20production%20build%20it%20is%20recommended%20to%20turn%20off%20this%20flag%0A%20%20%20%20%20%20%20%20%20%2A%20to%20speed%20up%20computation.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20debug%3A%20false%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20var%20factory%20%3D%20dimensionalCache%5Bsettings.dimensions%5D%3B%0A%20%20%20%20%20%20if%20%28%21factory%29%20%7B%0A%20%20%20%20%20%20%20%20var%20dimensions%20%3D%20settings.dimensions%3B%0A%20%20%20%20%20%20%20%20factory%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20Body%3A%20generateCreateBodyFunction%28dimensions%2C%20settings.debug%29%2C%0A%20%20%20%20%20%20%20%20%20%20createQuadTree%3A%20generateQuadTreeFunction%28dimensions%29%2C%0A%20%20%20%20%20%20%20%20%20%20createBounds%3A%20generateBoundsFunction%28dimensions%29%2C%0A%20%20%20%20%20%20%20%20%20%20createDragForce%3A%20generateCreateDragForceFunction%28dimensions%29%2C%0A%20%20%20%20%20%20%20%20%20%20createSpringForce%3A%20generateCreateSpringForceFunction%28dimensions%29%2C%0A%20%20%20%20%20%20%20%20%20%20integrate%3A%20generateIntegratorFunction%28dimensions%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20dimensionalCache%5Bdimensions%5D%20%3D%20factory%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20Body%20%3D%20factory.Body%3B%0A%20%20%20%20%20%20var%20createQuadTree%20%3D%20factory.createQuadTree%3B%0A%20%20%20%20%20%20var%20createBounds%20%3D%20factory.createBounds%3B%0A%20%20%20%20%20%20var%20createDragForce%20%3D%20factory.createDragForce%3B%0A%20%20%20%20%20%20var%20createSpringForce%20%3D%20factory.createSpringForce%3B%0A%20%20%20%20%20%20var%20integrate%20%3D%20factory.integrate%3B%0A%20%20%20%20%20%20var%20createBody%20%3D%20%28pos%29%20%3D%3E%20new%20Body%28pos%29%3B%0A%20%20%20%20%20%20var%20random%20%3D%20require_ngraph4%28%29.random%2842%29%3B%0A%20%20%20%20%20%20var%20bodies%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20var%20springs%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20var%20quadTree%20%3D%20createQuadTree%28settings%2C%20random%29%3B%0A%20%20%20%20%20%20var%20bounds%20%3D%20createBounds%28bodies%2C%20settings%2C%20random%29%3B%0A%20%20%20%20%20%20var%20springForce%20%3D%20createSpringForce%28settings%2C%20random%29%3B%0A%20%20%20%20%20%20var%20dragForce%20%3D%20createDragForce%28settings%29%3B%0A%20%20%20%20%20%20var%20totalMovement%20%3D%200%3B%0A%20%20%20%20%20%20var%20forces%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20var%20forceMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20%20%20var%20iterationNumber%20%3D%200%3B%0A%20%20%20%20%20%20addForce%28%22nbody%22%2C%20nbodyForce%29%3B%0A%20%20%20%20%20%20addForce%28%22spring%22%2C%20updateSpringForce%29%3B%0A%20%20%20%20%20%20var%20publicApi%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Array%20of%20bodies%2C%20registered%20with%20current%20simulator%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Note%3A%20To%20add%20new%20body%2C%20use%20addBody%28%29%20method.%20This%20property%20is%20only%0A%20%20%20%20%20%20%20%20%20%2A%20exposed%20for%20testing%2Fperformance%20purposes.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20bodies%2C%0A%20%20%20%20%20%20%20%20quadTree%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Array%20of%20springs%2C%20registered%20with%20current%20simulator%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Note%3A%20To%20add%20new%20spring%2C%20use%20addSpring%28%29%20method.%20This%20property%20is%20only%0A%20%20%20%20%20%20%20%20%20%2A%20exposed%20for%20testing%2Fperformance%20purposes.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20springs%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Returns%20settings%20with%20which%20current%20simulator%20was%20initialized%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20settings%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Adds%20a%20new%20force%20to%20simulation%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20addForce%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Removes%20a%20force%20from%20the%20simulation.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20removeForce%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Returns%20a%20map%20of%20all%20registered%20forces.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getForces%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Performs%20one%20step%20of%20force%20simulation.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7Bboolean%7D%20true%20if%20system%20is%20considered%20stable%3B%20False%20otherwise.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20step%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20forces.length%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20forces%5Bi%5D%28iterationNumber%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20movement%20%3D%20integrate%28bodies%2C%20settings.timeStep%2C%20settings.adaptiveTimeStepWeight%29%3B%0A%20%20%20%20%20%20%20%20%20%20iterationNumber%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20return%20movement%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Adds%20body%20to%20the%20system%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bngraph.physics.primitives.Body%7D%20body%20physical%20body%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7Bngraph.physics.primitives.Body%7D%20added%20body%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20addBody%3A%20function%28body%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21body%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Body%20is%20required%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20bodies.push%28body%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20body%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Adds%20body%20to%20the%20system%20at%20given%20position%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7BObject%7D%20pos%20position%20of%20a%20body%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7Bngraph.physics.primitives.Body%7D%20added%20body%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20addBodyAt%3A%20function%28pos%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21pos%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Body%20position%20is%20required%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20body%20%3D%20createBody%28pos%29%3B%0A%20%20%20%20%20%20%20%20%20%20bodies.push%28body%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20body%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Removes%20body%20from%20the%20system%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bngraph.physics.primitives.Body%7D%20body%20to%20remove%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7BBoolean%7D%20true%20if%20body%20found%20and%20removed.%20falsy%20otherwise%3B%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20removeBody%3A%20function%28body%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21body%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20idx%20%3D%20bodies.indexOf%28body%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28idx%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20bodies.splice%28idx%2C%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28bodies.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20bounds.reset%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Adds%20a%20spring%20to%20this%20simulation.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7BObject%7D%20-%20a%20handle%20for%20a%20spring.%20If%20you%20want%20to%20later%20remove%0A%20%20%20%20%20%20%20%20%20%2A%20spring%20pass%20it%20to%20removeSpring%28%29%20method.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20addSpring%3A%20function%28body1%2C%20body2%2C%20springLength%2C%20springCoefficient%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21body1%20%7C%7C%20%21body2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Cannot%20add%20null%20spring%20to%20force%20simulator%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20springLength%20%21%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20springLength%20%3D%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20spring%20%3D%20new%20Spring%28body1%2C%20body2%2C%20springLength%2C%20springCoefficient%20%3E%3D%200%20%3F%20springCoefficient%20%3A%20-1%29%3B%0A%20%20%20%20%20%20%20%20%20%20springs.push%28spring%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20spring%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Returns%20amount%20of%20movement%20performed%20on%20last%20step%28%29%20call%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getTotalMovement%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20totalMovement%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Removes%20spring%20from%20the%20system%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7BObject%7D%20spring%20to%20remove.%20Spring%20is%20an%20object%20returned%20by%20addSpring%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7BBoolean%7D%20true%20if%20spring%20found%20and%20removed.%20falsy%20otherwise%3B%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20removeSpring%3A%20function%28spring%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21spring%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20idx%20%3D%20springs.indexOf%28spring%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28idx%20%3E%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20springs.splice%28idx%2C%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20getBestNewBodyPosition%3A%20function%28neighbors%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20bounds.getBestNewPosition%28neighbors%29%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Returns%20bounding%20box%20which%20covers%20all%20bodies%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getBBox%3A%20getBoundingBox%2C%0A%20%20%20%20%20%20%20%20getBoundingBox%2C%0A%20%20%20%20%20%20%20%20invalidateBBox%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22invalidateBBox%28%29%20is%20deprecated%2C%20bounds%20always%20recomputed%20on%20%60getBBox%28%29%60%20call%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20TODO%3A%20Move%20the%20force%20specific%20stuff%20to%20force%0A%20%20%20%20%20%20%20%20gravity%3A%20function%28value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20settings.gravity%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20quadTree.options%28%7B%20gravity%3A%20value%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20settings.gravity%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20theta%3A%20function%28value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20settings.theta%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20quadTree.options%28%7B%20theta%3A%20value%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20settings.theta%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Returns%20pseudo-random%20number%20generator%20instance.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20random%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20expose%28settings%2C%20publicApi%29%3B%0A%20%20%20%20%20%20eventify%28publicApi%29%3B%0A%20%20%20%20%20%20return%20publicApi%3B%0A%20%20%20%20%20%20function%20getBoundingBox%28%29%20%7B%0A%20%20%20%20%20%20%20%20bounds.update%28%29%3B%0A%20%20%20%20%20%20%20%20return%20bounds.box%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20addForce%28forceName%2C%20forceFunction%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28forceMap.has%28forceName%29%29%20throw%20new%20Error%28%22Force%20%22%20%2B%20forceName%20%2B%20%22%20is%20already%20added%22%29%3B%0A%20%20%20%20%20%20%20%20forceMap.set%28forceName%2C%20forceFunction%29%3B%0A%20%20%20%20%20%20%20%20forces.push%28forceFunction%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20removeForce%28forceName%29%20%7B%0A%20%20%20%20%20%20%20%20var%20forceIndex%20%3D%20forces.indexOf%28forceMap.get%28forceName%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28forceIndex%20%3C%200%29%20return%3B%0A%20%20%20%20%20%20%20%20forces.splice%28forceIndex%2C%201%29%3B%0A%20%20%20%20%20%20%20%20forceMap.delete%28forceName%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getForces%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20forceMap%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20nbodyForce%28%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28bodies.length%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20%20%20%20%20quadTree.insertBodies%28bodies%29%3B%0A%20%20%20%20%20%20%20%20var%20i%20%3D%20bodies.length%3B%0A%20%20%20%20%20%20%20%20while%20%28i--%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20body%20%3D%20bodies%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21body.isPinned%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20body.reset%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20quadTree.updateBodyForce%28body%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20dragForce.update%28body%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20updateSpringForce%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20i%20%3D%20springs.length%3B%0A%20%20%20%20%20%20%20%20while%20%28i--%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20springForce.update%28springs%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20expose%28settings%2C%20target%29%20%7B%0A%20%20%20%20%20%20for%20%28var%20key%20in%20settings%29%20%7B%0A%20%20%20%20%20%20%20%20augment%28settings%2C%20target%2C%20key%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20augment%28source%2C%20target%2C%20key%29%20%7B%0A%20%20%20%20%20%20if%20%28%21source.hasOwnProperty%28key%29%29%20return%3B%0A%20%20%20%20%20%20if%20%28typeof%20target%5Bkey%5D%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20sourceIsNumber%20%3D%20Number.isFinite%28source%5Bkey%5D%29%3B%0A%20%20%20%20%20%20if%20%28sourceIsNumber%29%20%7B%0A%20%20%20%20%20%20%20%20target%5Bkey%5D%20%3D%20function%28value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21Number.isFinite%28value%29%29%20throw%20new%20Error%28%22Value%20of%20%22%20%2B%20key%20%2B%20%22%20should%20be%20a%20valid%20number.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20source%5Bkey%5D%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20target%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20source%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20target%5Bkey%5D%20%3D%20function%28value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20source%5Bkey%5D%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20target%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20source%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Findex.js%0Avar%20require_ngraph5%20%3D%20__commonJS%28%7B%0A%20%20%22..%2F..%2Fnode_modules%2Fngraph.forcelayout%2Findex.js%22%28exports%2C%20module%29%20%7B%0A%20%20%20%20module.exports%20%3D%20createLayout%3B%0A%20%20%20%20module.exports.simulator%20%3D%20require_createPhysicsSimulator%28%29%3B%0A%20%20%20%20var%20eventify%20%3D%20require_ngraph%28%29%3B%0A%20%20%20%20function%20createLayout%28graph2%2C%20physicsSettings%29%20%7B%0A%20%20%20%20%20%20if%20%28%21graph2%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Graph%20structure%20cannot%20be%20undefined%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20createSimulator%20%3D%20physicsSettings%20%26%26%20physicsSettings.createSimulator%20%7C%7C%20require_createPhysicsSimulator%28%29%3B%0A%20%20%20%20%20%20var%20physicsSimulator%20%3D%20createSimulator%28physicsSettings%29%3B%0A%20%20%20%20%20%20if%20%28Array.isArray%28physicsSettings%29%29%20throw%20new%20Error%28%22Physics%20settings%20is%20expected%20to%20be%20an%20object%22%29%3B%0A%20%20%20%20%20%20var%20nodeMass%20%3D%20graph2.version%20%3E%2019%20%3F%20defaultSetNodeMass%20%3A%20defaultArrayNodeMass%3B%0A%20%20%20%20%20%20if%20%28physicsSettings%20%26%26%20typeof%20physicsSettings.nodeMass%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20nodeMass%20%3D%20physicsSettings.nodeMass%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20nodeBodies%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20%20%20var%20springs%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20var%20bodiesCount%20%3D%200%3B%0A%20%20%20%20%20%20var%20springTransform%20%3D%20physicsSimulator.settings.springTransform%20%7C%7C%20noop2%3B%0A%20%20%20%20%20%20initPhysics%28%29%3B%0A%20%20%20%20%20%20listenToEvents%28%29%3B%0A%20%20%20%20%20%20var%20wasStable%20%3D%20false%3B%0A%20%20%20%20%20%20var%20api%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Performs%20one%20step%20of%20iterative%20layout%20algorithm%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7Bboolean%7D%20true%20if%20the%20system%20should%20be%20considered%20stable%3B%20False%20otherwise.%0A%20%20%20%20%20%20%20%20%20%2A%20The%20system%20is%20stable%20if%20no%20further%20call%20to%20%60step%28%29%60%20can%20improve%20the%20layout.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20step%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28bodiesCount%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20updateStableStatus%28true%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20lastMove%20%3D%20physicsSimulator.step%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20api.lastMove%20%3D%20lastMove%3B%0A%20%20%20%20%20%20%20%20%20%20api.fire%28%22step%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20ratio%20%3D%20lastMove%20%2F%20bodiesCount%3B%0A%20%20%20%20%20%20%20%20%20%20var%20isStableNow%20%3D%20ratio%20%3C%3D%200.01%3B%0A%20%20%20%20%20%20%20%20%20%20updateStableStatus%28isStableNow%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20isStableNow%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20For%20a%20given%20%60nodeId%60%20returns%20position%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getNodePosition%3A%20function%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20getInitializedBody%28nodeId%29.pos%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Sets%20position%20of%20a%20node%20to%20a%20given%20coordinates%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bstring%7D%20nodeId%20node%20identifier%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bnumber%7D%20x%20position%20of%20a%20node%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bnumber%7D%20y%20position%20of%20a%20node%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bnumber%3D%7D%20z%20position%20of%20node%20%28only%20if%20applicable%20to%20body%29%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20setNodePosition%3A%20function%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20body%20%3D%20getInitializedBody%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20%20%20body.setPosition.apply%28body%2C%20Array.prototype.slice.call%28arguments%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7BObject%7D%20Link%20position%20by%20link%20id%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7BObject.from%7D%20%7Bx%2C%20y%7D%20coordinates%20of%20link%20start%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7BObject.to%7D%20%7Bx%2C%20y%7D%20coordinates%20of%20link%20end%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getLinkPosition%3A%20function%28linkId%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20spring%20%3D%20springs%5BlinkId%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28spring%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20from%3A%20spring.from.pos%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20to%3A%20spring.to.pos%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40returns%20%7BObject%7D%20area%20required%20to%20fit%20in%20the%20graph.%20Object%20contains%0A%20%20%20%20%20%20%20%20%20%2A%20%60x1%60%2C%20%60y1%60%20-%20top%20left%20coordinates%0A%20%20%20%20%20%20%20%20%20%2A%20%60x2%60%2C%20%60y2%60%20-%20bottom%20right%20coordinates%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getGraphRect%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20physicsSimulator.getBBox%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Iterates%20over%20each%20body%20in%20the%20layout%20simulator%20and%20performs%20a%20callback%28body%2C%20nodeId%29%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20forEachBody%2C%0A%20%20%20%20%20%20%20%20%2F%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Requests%20layout%20algorithm%20to%20pin%2Funpin%20node%20to%20its%20current%20position%0A%20%20%20%20%20%20%20%20%20%2A%20Pinned%20nodes%20should%20not%20be%20affected%20by%20layout%20algorithm%20and%20always%0A%20%20%20%20%20%20%20%20%20%2A%20remain%20at%20their%20position%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20pinNode%3A%20function%28node%2C%20isPinned%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20body%20%3D%20getInitializedBody%28node.id%29%3B%0A%20%20%20%20%20%20%20%20%20%20body.isPinned%20%3D%20%21%21isPinned%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Checks%20whether%20given%20graph%27s%20node%20is%20currently%20pinned%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20isNodePinned%3A%20function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20getInitializedBody%28node.id%29.isPinned%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Request%20to%20release%20all%20resources%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20dispose%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20graph2.off%28%22changed%22%2C%20onGraphChanged%29%3B%0A%20%20%20%20%20%20%20%20%20%20api.fire%28%22disposed%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20physical%20body%20for%20a%20given%20node%20id.%20If%20node%20is%20not%20found%20undefined%0A%20%20%20%20%20%20%20%20%20%2A%20value%20is%20returned.%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getBody%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20spring%20for%20a%20given%20edge.%0A%20%20%20%20%20%20%20%20%20%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bstring%7D%20linkId%20link%20identifer.%20If%20two%20arguments%20are%20passed%20then%0A%20%20%20%20%20%20%20%20%20%2A%20this%20argument%20is%20treated%20as%20formNodeId%0A%20%20%20%20%20%20%20%20%20%2A%20%40param%20%7Bstring%3D%7D%20toId%20when%20defined%20this%20parameter%20denotes%20head%20of%20the%20link%0A%20%20%20%20%20%20%20%20%20%2A%20and%20first%20argument%20is%20treated%20as%20tail%20of%20the%20link%20%28fromId%29%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getSpring%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Returns%20length%20of%20cumulative%20force%20vector.%20The%20closer%20this%20to%20zero%20-%20the%20more%20stable%20the%20system%20is%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20getForceVectorLength%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20%5BRead%20only%5D%20Gets%20current%20physics%20simulator%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20simulator%3A%20physicsSimulator%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20the%20graph%20that%20was%20used%20for%20layout%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20graph%3A%20graph2%2C%0A%20%20%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%20%20%2A%20Gets%20amount%20of%20movement%20performed%20during%20last%20step%20operation%0A%20%20%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20%20%20lastMove%3A%200%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20eventify%28api%29%3B%0A%20%20%20%20%20%20return%20api%3B%0A%20%20%20%20%20%20function%20updateStableStatus%28isStableNow%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28wasStable%20%21%3D%3D%20isStableNow%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20wasStable%20%3D%20isStableNow%3B%0A%20%20%20%20%20%20%20%20%20%20onStableChanged%28isStableNow%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20forEachBody%28cb%29%20%7B%0A%20%20%20%20%20%20%20%20nodeBodies.forEach%28cb%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getForceVectorLength%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20fx%20%3D%200%2C%20fy%20%3D%200%3B%0A%20%20%20%20%20%20%20%20forEachBody%28function%28body%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20fx%20%2B%3D%20Math.abs%28body.force.x%29%3B%0A%20%20%20%20%20%20%20%20%20%20fy%20%2B%3D%20Math.abs%28body.force.y%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20return%20Math.sqrt%28fx%20%2A%20fx%20%2B%20fy%20%2A%20fy%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getSpring%28fromId%2C%20toId%29%20%7B%0A%20%20%20%20%20%20%20%20var%20linkId%3B%0A%20%20%20%20%20%20%20%20if%20%28toId%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20fromId%20%21%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20linkId%20%3D%20fromId%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20linkId%20%3D%20fromId.id%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20link%20%3D%20graph2.hasLink%28fromId%2C%20toId%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21link%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20linkId%20%3D%20link.id%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20springs%5BlinkId%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getBody%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20return%20nodeBodies.get%28nodeId%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20listenToEvents%28%29%20%7B%0A%20%20%20%20%20%20%20%20graph2.on%28%22changed%22%2C%20onGraphChanged%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20onStableChanged%28isStable%29%20%7B%0A%20%20%20%20%20%20%20%20api.fire%28%22stable%22%2C%20isStable%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20onGraphChanged%28changes%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20changes.length%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20change%20%3D%20changes%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28change.changeType%20%3D%3D%3D%20%22add%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28change.node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20initBody%28change.node.id%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28change.link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20initLink%28change.link%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28change.changeType%20%3D%3D%3D%20%22remove%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28change.node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20releaseNode%28change.node%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28change.link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20releaseLink%28change.link%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20bodiesCount%20%3D%20graph2.getNodesCount%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20initPhysics%28%29%20%7B%0A%20%20%20%20%20%20%20%20bodiesCount%20%3D%200%3B%0A%20%20%20%20%20%20%20%20graph2.forEachNode%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20initBody%28node.id%29%3B%0A%20%20%20%20%20%20%20%20%20%20bodiesCount%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20graph2.forEachLink%28initLink%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20initBody%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20var%20body%20%3D%20nodeBodies.get%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%21body%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20node%20%3D%20graph2.getNode%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22initBody%28%29%20was%20called%20with%20unknown%20node%20id%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20pos%20%3D%20node.position%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21pos%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20neighbors%20%3D%20getNeighborBodies%28node%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20pos%20%3D%20physicsSimulator.getBestNewBodyPosition%28neighbors%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20body%20%3D%20physicsSimulator.addBodyAt%28pos%29%3B%0A%20%20%20%20%20%20%20%20%20%20body.id%20%3D%20nodeId%3B%0A%20%20%20%20%20%20%20%20%20%20nodeBodies.set%28nodeId%2C%20body%29%3B%0A%20%20%20%20%20%20%20%20%20%20updateBodyMass%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28isNodeOriginallyPinned%28node%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20body.isPinned%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20releaseNode%28node%29%20%7B%0A%20%20%20%20%20%20%20%20var%20nodeId%20%3D%20node.id%3B%0A%20%20%20%20%20%20%20%20var%20body%20%3D%20nodeBodies.get%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28body%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20nodeBodies.delete%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20%20%20physicsSimulator.removeBody%28body%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20initLink%28link%29%20%7B%0A%20%20%20%20%20%20%20%20updateBodyMass%28link.fromId%29%3B%0A%20%20%20%20%20%20%20%20updateBodyMass%28link.toId%29%3B%0A%20%20%20%20%20%20%20%20var%20fromBody%20%3D%20nodeBodies.get%28link.fromId%29%2C%20toBody%20%3D%20nodeBodies.get%28link.toId%29%2C%20spring%20%3D%20physicsSimulator.addSpring%28fromBody%2C%20toBody%2C%20link.length%29%3B%0A%20%20%20%20%20%20%20%20springTransform%28link%2C%20spring%29%3B%0A%20%20%20%20%20%20%20%20springs%5Blink.id%5D%20%3D%20spring%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20releaseLink%28link%29%20%7B%0A%20%20%20%20%20%20%20%20var%20spring%20%3D%20springs%5Blink.id%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28spring%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20from%20%3D%20graph2.getNode%28link.fromId%29%2C%20to%20%3D%20graph2.getNode%28link.toId%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28from%29%20updateBodyMass%28from.id%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28to%29%20updateBodyMass%28to.id%29%3B%0A%20%20%20%20%20%20%20%20%20%20delete%20springs%5Blink.id%5D%3B%0A%20%20%20%20%20%20%20%20%20%20physicsSimulator.removeSpring%28spring%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getNeighborBodies%28node%29%20%7B%0A%20%20%20%20%20%20%20%20var%20neighbors%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28%21node.links%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20neighbors%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20maxNeighbors%20%3D%20Math.min%28node.links.length%2C%202%29%3B%0A%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20maxNeighbors%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20link%20%3D%20node.links%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20otherBody%20%3D%20link.fromId%20%21%3D%3D%20node.id%20%3F%20nodeBodies.get%28link.fromId%29%20%3A%20nodeBodies.get%28link.toId%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28otherBody%20%26%26%20otherBody.pos%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20neighbors.push%28otherBody%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20neighbors%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20updateBodyMass%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20var%20body%20%3D%20nodeBodies.get%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20body.mass%20%3D%20nodeMass%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Number.isNaN%28body.mass%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Node%20mass%20should%20be%20a%20number%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20isNodeOriginallyPinned%28node%29%20%7B%0A%20%20%20%20%20%20%20%20return%20node%20%26%26%20%28node.isPinned%20%7C%7C%20node.data%20%26%26%20node.data.isPinned%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getInitializedBody%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20var%20body%20%3D%20nodeBodies.get%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%21body%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20initBody%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20%20%20body%20%3D%20nodeBodies.get%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20body%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20defaultArrayNodeMass%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20var%20links%20%3D%20graph2.getLinks%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%21links%29%20return%201%3B%0A%20%20%20%20%20%20%20%20return%201%20%2B%20links.length%20%2F%203%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20defaultSetNodeMass%28nodeId%29%20%7B%0A%20%20%20%20%20%20%20%20var%20links%20%3D%20graph2.getLinks%28nodeId%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%21links%29%20return%201%3B%0A%20%20%20%20%20%20%20%20return%201%20%2B%20links.size%20%2F%203%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20noop2%28%29%20%7B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fbuild%2Fthree.module.js%0Avar%20REVISION%20%3D%20%22170%22%3B%0Avar%20MOUSE%20%3D%20%7B%20LEFT%3A%200%2C%20MIDDLE%3A%201%2C%20RIGHT%3A%202%2C%20ROTATE%3A%200%2C%20DOLLY%3A%201%2C%20PAN%3A%202%20%7D%3B%0Avar%20TOUCH%20%3D%20%7B%20ROTATE%3A%200%2C%20PAN%3A%201%2C%20DOLLY_PAN%3A%202%2C%20DOLLY_ROTATE%3A%203%20%7D%3B%0Avar%20CullFaceNone%20%3D%200%3B%0Avar%20CullFaceBack%20%3D%201%3B%0Avar%20CullFaceFront%20%3D%202%3B%0Avar%20PCFShadowMap%20%3D%201%3B%0Avar%20PCFSoftShadowMap%20%3D%202%3B%0Avar%20VSMShadowMap%20%3D%203%3B%0Avar%20FrontSide%20%3D%200%3B%0Avar%20BackSide%20%3D%201%3B%0Avar%20DoubleSide%20%3D%202%3B%0Avar%20NoBlending%20%3D%200%3B%0Avar%20NormalBlending%20%3D%201%3B%0Avar%20AdditiveBlending%20%3D%202%3B%0Avar%20SubtractiveBlending%20%3D%203%3B%0Avar%20MultiplyBlending%20%3D%204%3B%0Avar%20CustomBlending%20%3D%205%3B%0Avar%20AddEquation%20%3D%20100%3B%0Avar%20SubtractEquation%20%3D%20101%3B%0Avar%20ReverseSubtractEquation%20%3D%20102%3B%0Avar%20MinEquation%20%3D%20103%3B%0Avar%20MaxEquation%20%3D%20104%3B%0Avar%20ZeroFactor%20%3D%20200%3B%0Avar%20OneFactor%20%3D%20201%3B%0Avar%20SrcColorFactor%20%3D%20202%3B%0Avar%20OneMinusSrcColorFactor%20%3D%20203%3B%0Avar%20SrcAlphaFactor%20%3D%20204%3B%0Avar%20OneMinusSrcAlphaFactor%20%3D%20205%3B%0Avar%20DstAlphaFactor%20%3D%20206%3B%0Avar%20OneMinusDstAlphaFactor%20%3D%20207%3B%0Avar%20DstColorFactor%20%3D%20208%3B%0Avar%20OneMinusDstColorFactor%20%3D%20209%3B%0Avar%20SrcAlphaSaturateFactor%20%3D%20210%3B%0Avar%20ConstantColorFactor%20%3D%20211%3B%0Avar%20OneMinusConstantColorFactor%20%3D%20212%3B%0Avar%20ConstantAlphaFactor%20%3D%20213%3B%0Avar%20OneMinusConstantAlphaFactor%20%3D%20214%3B%0Avar%20NeverDepth%20%3D%200%3B%0Avar%20AlwaysDepth%20%3D%201%3B%0Avar%20LessDepth%20%3D%202%3B%0Avar%20LessEqualDepth%20%3D%203%3B%0Avar%20EqualDepth%20%3D%204%3B%0Avar%20GreaterEqualDepth%20%3D%205%3B%0Avar%20GreaterDepth%20%3D%206%3B%0Avar%20NotEqualDepth%20%3D%207%3B%0Avar%20MultiplyOperation%20%3D%200%3B%0Avar%20MixOperation%20%3D%201%3B%0Avar%20AddOperation%20%3D%202%3B%0Avar%20NoToneMapping%20%3D%200%3B%0Avar%20LinearToneMapping%20%3D%201%3B%0Avar%20ReinhardToneMapping%20%3D%202%3B%0Avar%20CineonToneMapping%20%3D%203%3B%0Avar%20ACESFilmicToneMapping%20%3D%204%3B%0Avar%20CustomToneMapping%20%3D%205%3B%0Avar%20AgXToneMapping%20%3D%206%3B%0Avar%20NeutralToneMapping%20%3D%207%3B%0Avar%20UVMapping%20%3D%20300%3B%0Avar%20CubeReflectionMapping%20%3D%20301%3B%0Avar%20CubeRefractionMapping%20%3D%20302%3B%0Avar%20EquirectangularReflectionMapping%20%3D%20303%3B%0Avar%20EquirectangularRefractionMapping%20%3D%20304%3B%0Avar%20CubeUVReflectionMapping%20%3D%20306%3B%0Avar%20RepeatWrapping%20%3D%201e3%3B%0Avar%20ClampToEdgeWrapping%20%3D%201001%3B%0Avar%20MirroredRepeatWrapping%20%3D%201002%3B%0Avar%20NearestFilter%20%3D%201003%3B%0Avar%20NearestMipmapNearestFilter%20%3D%201004%3B%0Avar%20NearestMipmapLinearFilter%20%3D%201005%3B%0Avar%20LinearFilter%20%3D%201006%3B%0Avar%20LinearMipmapNearestFilter%20%3D%201007%3B%0Avar%20LinearMipmapLinearFilter%20%3D%201008%3B%0Avar%20UnsignedByteType%20%3D%201009%3B%0Avar%20ByteType%20%3D%201010%3B%0Avar%20ShortType%20%3D%201011%3B%0Avar%20UnsignedShortType%20%3D%201012%3B%0Avar%20IntType%20%3D%201013%3B%0Avar%20UnsignedIntType%20%3D%201014%3B%0Avar%20FloatType%20%3D%201015%3B%0Avar%20HalfFloatType%20%3D%201016%3B%0Avar%20UnsignedShort4444Type%20%3D%201017%3B%0Avar%20UnsignedShort5551Type%20%3D%201018%3B%0Avar%20UnsignedInt248Type%20%3D%201020%3B%0Avar%20UnsignedInt5999Type%20%3D%2035902%3B%0Avar%20AlphaFormat%20%3D%201021%3B%0Avar%20RGBFormat%20%3D%201022%3B%0Avar%20RGBAFormat%20%3D%201023%3B%0Avar%20LuminanceFormat%20%3D%201024%3B%0Avar%20LuminanceAlphaFormat%20%3D%201025%3B%0Avar%20DepthFormat%20%3D%201026%3B%0Avar%20DepthStencilFormat%20%3D%201027%3B%0Avar%20RedFormat%20%3D%201028%3B%0Avar%20RedIntegerFormat%20%3D%201029%3B%0Avar%20RGFormat%20%3D%201030%3B%0Avar%20RGIntegerFormat%20%3D%201031%3B%0Avar%20RGBAIntegerFormat%20%3D%201033%3B%0Avar%20RGB_S3TC_DXT1_Format%20%3D%2033776%3B%0Avar%20RGBA_S3TC_DXT1_Format%20%3D%2033777%3B%0Avar%20RGBA_S3TC_DXT3_Format%20%3D%2033778%3B%0Avar%20RGBA_S3TC_DXT5_Format%20%3D%2033779%3B%0Avar%20RGB_PVRTC_4BPPV1_Format%20%3D%2035840%3B%0Avar%20RGB_PVRTC_2BPPV1_Format%20%3D%2035841%3B%0Avar%20RGBA_PVRTC_4BPPV1_Format%20%3D%2035842%3B%0Avar%20RGBA_PVRTC_2BPPV1_Format%20%3D%2035843%3B%0Avar%20RGB_ETC1_Format%20%3D%2036196%3B%0Avar%20RGB_ETC2_Format%20%3D%2037492%3B%0Avar%20RGBA_ETC2_EAC_Format%20%3D%2037496%3B%0Avar%20RGBA_ASTC_4x4_Format%20%3D%2037808%3B%0Avar%20RGBA_ASTC_5x4_Format%20%3D%2037809%3B%0Avar%20RGBA_ASTC_5x5_Format%20%3D%2037810%3B%0Avar%20RGBA_ASTC_6x5_Format%20%3D%2037811%3B%0Avar%20RGBA_ASTC_6x6_Format%20%3D%2037812%3B%0Avar%20RGBA_ASTC_8x5_Format%20%3D%2037813%3B%0Avar%20RGBA_ASTC_8x6_Format%20%3D%2037814%3B%0Avar%20RGBA_ASTC_8x8_Format%20%3D%2037815%3B%0Avar%20RGBA_ASTC_10x5_Format%20%3D%2037816%3B%0Avar%20RGBA_ASTC_10x6_Format%20%3D%2037817%3B%0Avar%20RGBA_ASTC_10x8_Format%20%3D%2037818%3B%0Avar%20RGBA_ASTC_10x10_Format%20%3D%2037819%3B%0Avar%20RGBA_ASTC_12x10_Format%20%3D%2037820%3B%0Avar%20RGBA_ASTC_12x12_Format%20%3D%2037821%3B%0Avar%20RGBA_BPTC_Format%20%3D%2036492%3B%0Avar%20RGB_BPTC_SIGNED_Format%20%3D%2036494%3B%0Avar%20RGB_BPTC_UNSIGNED_Format%20%3D%2036495%3B%0Avar%20RED_RGTC1_Format%20%3D%2036283%3B%0Avar%20SIGNED_RED_RGTC1_Format%20%3D%2036284%3B%0Avar%20RED_GREEN_RGTC2_Format%20%3D%2036285%3B%0Avar%20SIGNED_RED_GREEN_RGTC2_Format%20%3D%2036286%3B%0Avar%20InterpolateDiscrete%20%3D%202300%3B%0Avar%20InterpolateLinear%20%3D%202301%3B%0Avar%20InterpolateSmooth%20%3D%202302%3B%0Avar%20ZeroCurvatureEnding%20%3D%202400%3B%0Avar%20ZeroSlopeEnding%20%3D%202401%3B%0Avar%20WrapAroundEnding%20%3D%202402%3B%0Avar%20BasicDepthPacking%20%3D%203200%3B%0Avar%20RGBADepthPacking%20%3D%203201%3B%0Avar%20TangentSpaceNormalMap%20%3D%200%3B%0Avar%20ObjectSpaceNormalMap%20%3D%201%3B%0Avar%20NoColorSpace%20%3D%20%22%22%3B%0Avar%20SRGBColorSpace%20%3D%20%22srgb%22%3B%0Avar%20LinearSRGBColorSpace%20%3D%20%22srgb-linear%22%3B%0Avar%20LinearTransfer%20%3D%20%22linear%22%3B%0Avar%20SRGBTransfer%20%3D%20%22srgb%22%3B%0Avar%20KeepStencilOp%20%3D%207680%3B%0Avar%20AlwaysStencilFunc%20%3D%20519%3B%0Avar%20NeverCompare%20%3D%20512%3B%0Avar%20LessCompare%20%3D%20513%3B%0Avar%20EqualCompare%20%3D%20514%3B%0Avar%20LessEqualCompare%20%3D%20515%3B%0Avar%20GreaterCompare%20%3D%20516%3B%0Avar%20NotEqualCompare%20%3D%20517%3B%0Avar%20GreaterEqualCompare%20%3D%20518%3B%0Avar%20AlwaysCompare%20%3D%20519%3B%0Avar%20StaticDrawUsage%20%3D%2035044%3B%0Avar%20GLSL3%20%3D%20%22300%20es%22%3B%0Avar%20WebGLCoordinateSystem%20%3D%202e3%3B%0Avar%20WebGPUCoordinateSystem%20%3D%202001%3B%0Avar%20EventDispatcher%20%3D%20class%20%7B%0A%20%20addEventListener%28type%2C%20listener%29%20%7B%0A%20%20%20%20if%20%28this._listeners%20%3D%3D%3D%20void%200%29%20this._listeners%20%3D%20%7B%7D%3B%0A%20%20%20%20const%20listeners%20%3D%20this._listeners%3B%0A%20%20%20%20if%20%28listeners%5Btype%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20listeners%5Btype%5D%20%3D%20%5B%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28listeners%5Btype%5D.indexOf%28listener%29%20%3D%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20listeners%5Btype%5D.push%28listener%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20hasEventListener%28type%2C%20listener%29%20%7B%0A%20%20%20%20if%20%28this._listeners%20%3D%3D%3D%20void%200%29%20return%20false%3B%0A%20%20%20%20const%20listeners%20%3D%20this._listeners%3B%0A%20%20%20%20return%20listeners%5Btype%5D%20%21%3D%3D%20void%200%20%26%26%20listeners%5Btype%5D.indexOf%28listener%29%20%21%3D%3D%20-1%3B%0A%20%20%7D%0A%20%20removeEventListener%28type%2C%20listener%29%20%7B%0A%20%20%20%20if%20%28this._listeners%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20const%20listeners%20%3D%20this._listeners%3B%0A%20%20%20%20const%20listenerArray%20%3D%20listeners%5Btype%5D%3B%0A%20%20%20%20if%20%28listenerArray%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20index5%20%3D%20listenerArray.indexOf%28listener%29%3B%0A%20%20%20%20%20%20if%20%28index5%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20listenerArray.splice%28index5%2C%201%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20dispatchEvent%28event%29%20%7B%0A%20%20%20%20if%20%28this._listeners%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20const%20listeners%20%3D%20this._listeners%3B%0A%20%20%20%20const%20listenerArray%20%3D%20listeners%5Bevent.type%5D%3B%0A%20%20%20%20if%20%28listenerArray%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20event.target%20%3D%20this%3B%0A%20%20%20%20%20%20const%20array%20%3D%20listenerArray.slice%280%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20array.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20array%5Bi%5D.call%28this%2C%20event%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20event.target%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20_lut%20%3D%20%5B%2200%22%2C%20%2201%22%2C%20%2202%22%2C%20%2203%22%2C%20%2204%22%2C%20%2205%22%2C%20%2206%22%2C%20%2207%22%2C%20%2208%22%2C%20%2209%22%2C%20%220a%22%2C%20%220b%22%2C%20%220c%22%2C%20%220d%22%2C%20%220e%22%2C%20%220f%22%2C%20%2210%22%2C%20%2211%22%2C%20%2212%22%2C%20%2213%22%2C%20%2214%22%2C%20%2215%22%2C%20%2216%22%2C%20%2217%22%2C%20%2218%22%2C%20%2219%22%2C%20%221a%22%2C%20%221b%22%2C%20%221c%22%2C%20%221d%22%2C%20%221e%22%2C%20%221f%22%2C%20%2220%22%2C%20%2221%22%2C%20%2222%22%2C%20%2223%22%2C%20%2224%22%2C%20%2225%22%2C%20%2226%22%2C%20%2227%22%2C%20%2228%22%2C%20%2229%22%2C%20%222a%22%2C%20%222b%22%2C%20%222c%22%2C%20%222d%22%2C%20%222e%22%2C%20%222f%22%2C%20%2230%22%2C%20%2231%22%2C%20%2232%22%2C%20%2233%22%2C%20%2234%22%2C%20%2235%22%2C%20%2236%22%2C%20%2237%22%2C%20%2238%22%2C%20%2239%22%2C%20%223a%22%2C%20%223b%22%2C%20%223c%22%2C%20%223d%22%2C%20%223e%22%2C%20%223f%22%2C%20%2240%22%2C%20%2241%22%2C%20%2242%22%2C%20%2243%22%2C%20%2244%22%2C%20%2245%22%2C%20%2246%22%2C%20%2247%22%2C%20%2248%22%2C%20%2249%22%2C%20%224a%22%2C%20%224b%22%2C%20%224c%22%2C%20%224d%22%2C%20%224e%22%2C%20%224f%22%2C%20%2250%22%2C%20%2251%22%2C%20%2252%22%2C%20%2253%22%2C%20%2254%22%2C%20%2255%22%2C%20%2256%22%2C%20%2257%22%2C%20%2258%22%2C%20%2259%22%2C%20%225a%22%2C%20%225b%22%2C%20%225c%22%2C%20%225d%22%2C%20%225e%22%2C%20%225f%22%2C%20%2260%22%2C%20%2261%22%2C%20%2262%22%2C%20%2263%22%2C%20%2264%22%2C%20%2265%22%2C%20%2266%22%2C%20%2267%22%2C%20%2268%22%2C%20%2269%22%2C%20%226a%22%2C%20%226b%22%2C%20%226c%22%2C%20%226d%22%2C%20%226e%22%2C%20%226f%22%2C%20%2270%22%2C%20%2271%22%2C%20%2272%22%2C%20%2273%22%2C%20%2274%22%2C%20%2275%22%2C%20%2276%22%2C%20%2277%22%2C%20%2278%22%2C%20%2279%22%2C%20%227a%22%2C%20%227b%22%2C%20%227c%22%2C%20%227d%22%2C%20%227e%22%2C%20%227f%22%2C%20%2280%22%2C%20%2281%22%2C%20%2282%22%2C%20%2283%22%2C%20%2284%22%2C%20%2285%22%2C%20%2286%22%2C%20%2287%22%2C%20%2288%22%2C%20%2289%22%2C%20%228a%22%2C%20%228b%22%2C%20%228c%22%2C%20%228d%22%2C%20%228e%22%2C%20%228f%22%2C%20%2290%22%2C%20%2291%22%2C%20%2292%22%2C%20%2293%22%2C%20%2294%22%2C%20%2295%22%2C%20%2296%22%2C%20%2297%22%2C%20%2298%22%2C%20%2299%22%2C%20%229a%22%2C%20%229b%22%2C%20%229c%22%2C%20%229d%22%2C%20%229e%22%2C%20%229f%22%2C%20%22a0%22%2C%20%22a1%22%2C%20%22a2%22%2C%20%22a3%22%2C%20%22a4%22%2C%20%22a5%22%2C%20%22a6%22%2C%20%22a7%22%2C%20%22a8%22%2C%20%22a9%22%2C%20%22aa%22%2C%20%22ab%22%2C%20%22ac%22%2C%20%22ad%22%2C%20%22ae%22%2C%20%22af%22%2C%20%22b0%22%2C%20%22b1%22%2C%20%22b2%22%2C%20%22b3%22%2C%20%22b4%22%2C%20%22b5%22%2C%20%22b6%22%2C%20%22b7%22%2C%20%22b8%22%2C%20%22b9%22%2C%20%22ba%22%2C%20%22bb%22%2C%20%22bc%22%2C%20%22bd%22%2C%20%22be%22%2C%20%22bf%22%2C%20%22c0%22%2C%20%22c1%22%2C%20%22c2%22%2C%20%22c3%22%2C%20%22c4%22%2C%20%22c5%22%2C%20%22c6%22%2C%20%22c7%22%2C%20%22c8%22%2C%20%22c9%22%2C%20%22ca%22%2C%20%22cb%22%2C%20%22cc%22%2C%20%22cd%22%2C%20%22ce%22%2C%20%22cf%22%2C%20%22d0%22%2C%20%22d1%22%2C%20%22d2%22%2C%20%22d3%22%2C%20%22d4%22%2C%20%22d5%22%2C%20%22d6%22%2C%20%22d7%22%2C%20%22d8%22%2C%20%22d9%22%2C%20%22da%22%2C%20%22db%22%2C%20%22dc%22%2C%20%22dd%22%2C%20%22de%22%2C%20%22df%22%2C%20%22e0%22%2C%20%22e1%22%2C%20%22e2%22%2C%20%22e3%22%2C%20%22e4%22%2C%20%22e5%22%2C%20%22e6%22%2C%20%22e7%22%2C%20%22e8%22%2C%20%22e9%22%2C%20%22ea%22%2C%20%22eb%22%2C%20%22ec%22%2C%20%22ed%22%2C%20%22ee%22%2C%20%22ef%22%2C%20%22f0%22%2C%20%22f1%22%2C%20%22f2%22%2C%20%22f3%22%2C%20%22f4%22%2C%20%22f5%22%2C%20%22f6%22%2C%20%22f7%22%2C%20%22f8%22%2C%20%22f9%22%2C%20%22fa%22%2C%20%22fb%22%2C%20%22fc%22%2C%20%22fd%22%2C%20%22fe%22%2C%20%22ff%22%5D%3B%0Avar%20_seed%20%3D%201234567%3B%0Avar%20DEG2RAD%20%3D%20Math.PI%20%2F%20180%3B%0Avar%20RAD2DEG%20%3D%20180%20%2F%20Math.PI%3B%0Afunction%20generateUUID%28%29%20%7B%0A%20%20const%20d0%20%3D%20Math.random%28%29%20%2A%204294967295%20%7C%200%3B%0A%20%20const%20d1%20%3D%20Math.random%28%29%20%2A%204294967295%20%7C%200%3B%0A%20%20const%20d2%20%3D%20Math.random%28%29%20%2A%204294967295%20%7C%200%3B%0A%20%20const%20d3%20%3D%20Math.random%28%29%20%2A%204294967295%20%7C%200%3B%0A%20%20const%20uuid%20%3D%20_lut%5Bd0%20%26%20255%5D%20%2B%20_lut%5Bd0%20%3E%3E%208%20%26%20255%5D%20%2B%20_lut%5Bd0%20%3E%3E%2016%20%26%20255%5D%20%2B%20_lut%5Bd0%20%3E%3E%2024%20%26%20255%5D%20%2B%20%22-%22%20%2B%20_lut%5Bd1%20%26%20255%5D%20%2B%20_lut%5Bd1%20%3E%3E%208%20%26%20255%5D%20%2B%20%22-%22%20%2B%20_lut%5Bd1%20%3E%3E%2016%20%26%2015%20%7C%2064%5D%20%2B%20_lut%5Bd1%20%3E%3E%2024%20%26%20255%5D%20%2B%20%22-%22%20%2B%20_lut%5Bd2%20%26%2063%20%7C%20128%5D%20%2B%20_lut%5Bd2%20%3E%3E%208%20%26%20255%5D%20%2B%20%22-%22%20%2B%20_lut%5Bd2%20%3E%3E%2016%20%26%20255%5D%20%2B%20_lut%5Bd2%20%3E%3E%2024%20%26%20255%5D%20%2B%20_lut%5Bd3%20%26%20255%5D%20%2B%20_lut%5Bd3%20%3E%3E%208%20%26%20255%5D%20%2B%20_lut%5Bd3%20%3E%3E%2016%20%26%20255%5D%20%2B%20_lut%5Bd3%20%3E%3E%2024%20%26%20255%5D%3B%0A%20%20return%20uuid.toLowerCase%28%29%3B%0A%7D%0Afunction%20clamp%28value%2C%20min2%2C%20max2%29%20%7B%0A%20%20return%20Math.max%28min2%2C%20Math.min%28max2%2C%20value%29%29%3B%0A%7D%0Afunction%20euclideanModulo%28n%2C%20m2%29%20%7B%0A%20%20return%20%28n%20%25%20m2%20%2B%20m2%29%20%25%20m2%3B%0A%7D%0Afunction%20mapLinear%28x2%2C%20a1%2C%20a2%2C%20b1%2C%20b2%29%20%7B%0A%20%20return%20b1%20%2B%20%28x2%20-%20a1%29%20%2A%20%28b2%20-%20b1%29%20%2F%20%28a2%20-%20a1%29%3B%0A%7D%0Afunction%20inverseLerp%28x2%2C%20y2%2C%20value%29%20%7B%0A%20%20if%20%28x2%20%21%3D%3D%20y2%29%20%7B%0A%20%20%20%20return%20%28value%20-%20x2%29%20%2F%20%28y2%20-%20x2%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%200%3B%0A%20%20%7D%0A%7D%0Afunction%20lerp%28x2%2C%20y2%2C%20t%29%20%7B%0A%20%20return%20%281%20-%20t%29%20%2A%20x2%20%2B%20t%20%2A%20y2%3B%0A%7D%0Afunction%20damp%28x2%2C%20y2%2C%20lambda%2C%20dt%29%20%7B%0A%20%20return%20lerp%28x2%2C%20y2%2C%201%20-%20Math.exp%28-lambda%20%2A%20dt%29%29%3B%0A%7D%0Afunction%20pingpong%28x2%2C%20length2%20%3D%201%29%20%7B%0A%20%20return%20length2%20-%20Math.abs%28euclideanModulo%28x2%2C%20length2%20%2A%202%29%20-%20length2%29%3B%0A%7D%0Afunction%20smoothstep%28x2%2C%20min2%2C%20max2%29%20%7B%0A%20%20if%20%28x2%20%3C%3D%20min2%29%20return%200%3B%0A%20%20if%20%28x2%20%3E%3D%20max2%29%20return%201%3B%0A%20%20x2%20%3D%20%28x2%20-%20min2%29%20%2F%20%28max2%20-%20min2%29%3B%0A%20%20return%20x2%20%2A%20x2%20%2A%20%283%20-%202%20%2A%20x2%29%3B%0A%7D%0Afunction%20smootherstep%28x2%2C%20min2%2C%20max2%29%20%7B%0A%20%20if%20%28x2%20%3C%3D%20min2%29%20return%200%3B%0A%20%20if%20%28x2%20%3E%3D%20max2%29%20return%201%3B%0A%20%20x2%20%3D%20%28x2%20-%20min2%29%20%2F%20%28max2%20-%20min2%29%3B%0A%20%20return%20x2%20%2A%20x2%20%2A%20x2%20%2A%20%28x2%20%2A%20%28x2%20%2A%206%20-%2015%29%20%2B%2010%29%3B%0A%7D%0Afunction%20randInt%28low%2C%20high%29%20%7B%0A%20%20return%20low%20%2B%20Math.floor%28Math.random%28%29%20%2A%20%28high%20-%20low%20%2B%201%29%29%3B%0A%7D%0Afunction%20randFloat%28low%2C%20high%29%20%7B%0A%20%20return%20low%20%2B%20Math.random%28%29%20%2A%20%28high%20-%20low%29%3B%0A%7D%0Afunction%20randFloatSpread%28range%29%20%7B%0A%20%20return%20range%20%2A%20%280.5%20-%20Math.random%28%29%29%3B%0A%7D%0Afunction%20seededRandom%28s%29%20%7B%0A%20%20if%20%28s%20%21%3D%3D%20void%200%29%20_seed%20%3D%20s%3B%0A%20%20let%20t%20%3D%20_seed%20%2B%3D%201831565813%3B%0A%20%20t%20%3D%20Math.imul%28t%20%5E%20t%20%3E%3E%3E%2015%2C%20t%20%7C%201%29%3B%0A%20%20t%20%5E%3D%20t%20%2B%20Math.imul%28t%20%5E%20t%20%3E%3E%3E%207%2C%20t%20%7C%2061%29%3B%0A%20%20return%20%28%28t%20%5E%20t%20%3E%3E%3E%2014%29%20%3E%3E%3E%200%29%20%2F%204294967296%3B%0A%7D%0Afunction%20degToRad%28degrees2%29%20%7B%0A%20%20return%20degrees2%20%2A%20DEG2RAD%3B%0A%7D%0Afunction%20radToDeg%28radians2%29%20%7B%0A%20%20return%20radians2%20%2A%20RAD2DEG%3B%0A%7D%0Afunction%20isPowerOfTwo%28value%29%20%7B%0A%20%20return%20%28value%20%26%20value%20-%201%29%20%3D%3D%3D%200%20%26%26%20value%20%21%3D%3D%200%3B%0A%7D%0Afunction%20ceilPowerOfTwo%28value%29%20%7B%0A%20%20return%20Math.pow%282%2C%20Math.ceil%28Math.log%28value%29%20%2F%20Math.LN2%29%29%3B%0A%7D%0Afunction%20floorPowerOfTwo%28value%29%20%7B%0A%20%20return%20Math.pow%282%2C%20Math.floor%28Math.log%28value%29%20%2F%20Math.LN2%29%29%3B%0A%7D%0Afunction%20setQuaternionFromProperEuler%28q%2C%20a2%2C%20b%2C%20c2%2C%20order%29%20%7B%0A%20%20const%20cos2%20%3D%20Math.cos%3B%0A%20%20const%20sin2%20%3D%20Math.sin%3B%0A%20%20const%20c22%20%3D%20cos2%28b%20%2F%202%29%3B%0A%20%20const%20s2%20%3D%20sin2%28b%20%2F%202%29%3B%0A%20%20const%20c13%20%3D%20cos2%28%28a2%20%2B%20c2%29%20%2F%202%29%3B%0A%20%20const%20s13%20%3D%20sin2%28%28a2%20%2B%20c2%29%20%2F%202%29%3B%0A%20%20const%20c1_3%20%3D%20cos2%28%28a2%20-%20c2%29%20%2F%202%29%3B%0A%20%20const%20s1_3%20%3D%20sin2%28%28a2%20-%20c2%29%20%2F%202%29%3B%0A%20%20const%20c3_1%20%3D%20cos2%28%28c2%20-%20a2%29%20%2F%202%29%3B%0A%20%20const%20s3_1%20%3D%20sin2%28%28c2%20-%20a2%29%20%2F%202%29%3B%0A%20%20switch%20%28order%29%20%7B%0A%20%20%20%20case%20%22XYX%22%3A%0A%20%20%20%20%20%20q.set%28c22%20%2A%20s13%2C%20s2%20%2A%20c1_3%2C%20s2%20%2A%20s1_3%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22YZY%22%3A%0A%20%20%20%20%20%20q.set%28s2%20%2A%20s1_3%2C%20c22%20%2A%20s13%2C%20s2%20%2A%20c1_3%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ZXZ%22%3A%0A%20%20%20%20%20%20q.set%28s2%20%2A%20c1_3%2C%20s2%20%2A%20s1_3%2C%20c22%20%2A%20s13%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22XZX%22%3A%0A%20%20%20%20%20%20q.set%28c22%20%2A%20s13%2C%20s2%20%2A%20s3_1%2C%20s2%20%2A%20c3_1%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22YXY%22%3A%0A%20%20%20%20%20%20q.set%28s2%20%2A%20c3_1%2C%20c22%20%2A%20s13%2C%20s2%20%2A%20s3_1%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ZYZ%22%3A%0A%20%20%20%20%20%20q.set%28s2%20%2A%20s3_1%2C%20s2%20%2A%20c3_1%2C%20c22%20%2A%20s13%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20console.warn%28%22THREE.MathUtils%3A%20.setQuaternionFromProperEuler%28%29%20encountered%20an%20unknown%20order%3A%20%22%20%2B%20order%29%3B%0A%20%20%7D%0A%7D%0Afunction%20denormalize%28value%2C%20array%29%20%7B%0A%20%20switch%20%28array.constructor%29%20%7B%0A%20%20%20%20case%20Float32Array%3A%0A%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20case%20Uint32Array%3A%0A%20%20%20%20%20%20return%20value%20%2F%204294967295%3B%0A%20%20%20%20case%20Uint16Array%3A%0A%20%20%20%20%20%20return%20value%20%2F%2065535%3B%0A%20%20%20%20case%20Uint8Array%3A%0A%20%20%20%20%20%20return%20value%20%2F%20255%3B%0A%20%20%20%20case%20Int32Array%3A%0A%20%20%20%20%20%20return%20Math.max%28value%20%2F%202147483647%2C%20-1%29%3B%0A%20%20%20%20case%20Int16Array%3A%0A%20%20%20%20%20%20return%20Math.max%28value%20%2F%2032767%2C%20-1%29%3B%0A%20%20%20%20case%20Int8Array%3A%0A%20%20%20%20%20%20return%20Math.max%28value%20%2F%20127%2C%20-1%29%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20throw%20new%20Error%28%22Invalid%20component%20type.%22%29%3B%0A%20%20%7D%0A%7D%0Afunction%20normalize%28value%2C%20array%29%20%7B%0A%20%20switch%20%28array.constructor%29%20%7B%0A%20%20%20%20case%20Float32Array%3A%0A%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20case%20Uint32Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%204294967295%29%3B%0A%20%20%20%20case%20Uint16Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%2065535%29%3B%0A%20%20%20%20case%20Uint8Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%20255%29%3B%0A%20%20%20%20case%20Int32Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%202147483647%29%3B%0A%20%20%20%20case%20Int16Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%2032767%29%3B%0A%20%20%20%20case%20Int8Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%20127%29%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20throw%20new%20Error%28%22Invalid%20component%20type.%22%29%3B%0A%20%20%7D%0A%7D%0Avar%20MathUtils%20%3D%20%7B%0A%20%20DEG2RAD%2C%0A%20%20RAD2DEG%2C%0A%20%20generateUUID%2C%0A%20%20clamp%2C%0A%20%20euclideanModulo%2C%0A%20%20mapLinear%2C%0A%20%20inverseLerp%2C%0A%20%20lerp%2C%0A%20%20damp%2C%0A%20%20pingpong%2C%0A%20%20smoothstep%2C%0A%20%20smootherstep%2C%0A%20%20randInt%2C%0A%20%20randFloat%2C%0A%20%20randFloatSpread%2C%0A%20%20seededRandom%2C%0A%20%20degToRad%2C%0A%20%20radToDeg%2C%0A%20%20isPowerOfTwo%2C%0A%20%20ceilPowerOfTwo%2C%0A%20%20floorPowerOfTwo%2C%0A%20%20setQuaternionFromProperEuler%2C%0A%20%20normalize%2C%0A%20%20denormalize%0A%7D%3B%0Avar%20Vector2%20%3D%20class%20_Vector2%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%29%20%7B%0A%20%20%20%20_Vector2.prototype.isVector2%20%3D%20true%3B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%7D%0A%20%20get%20width%28%29%20%7B%0A%20%20%20%20return%20this.x%3B%0A%20%20%7D%0A%20%20set%20width%28value%29%20%7B%0A%20%20%20%20this.x%20%3D%20value%3B%0A%20%20%7D%0A%20%20get%20height%28%29%20%7B%0A%20%20%20%20return%20this.y%3B%0A%20%20%7D%0A%20%20set%20height%28value%29%20%7B%0A%20%20%20%20this.y%20%3D%20value%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%3D%20scalar%3B%0A%20%20%20%20this.y%20%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setX%28x2%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setY%28y2%29%20%7B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setComponent%28index5%2C%20value%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20this.x%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20this.y%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getComponent%28index5%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20return%20this.x%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20return%20this.y%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.x%2C%20this.y%29%3B%0A%20%20%7D%0A%20%20copy%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20v.x%3B%0A%20%20%20%20this.y%20%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20add%28v%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScalar%28s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20%2B%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20%2B%20b.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScaledVector%28v%2C%20s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%20%2A%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%20%2A%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20sub%28v%29%20%7B%0A%20%20%20%20this.x%20-%3D%20v.x%3B%0A%20%20%20%20this.y%20-%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subScalar%28s%29%20%7B%0A%20%20%20%20this.x%20-%3D%20s%3B%0A%20%20%20%20this.y%20-%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20-%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20-%20b.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28v%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20v.x%3B%0A%20%20%20%20this.y%20%2A%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20scalar%3B%0A%20%20%20%20this.y%20%2A%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divide%28v%29%20%7B%0A%20%20%20%20this.x%20%2F%3D%20v.x%3B%0A%20%20%20%20this.y%20%2F%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divideScalar%28scalar%29%20%7B%0A%20%20%20%20return%20this.multiplyScalar%281%20%2F%20scalar%29%3B%0A%20%20%7D%0A%20%20applyMatrix3%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B0%5D%20%2A%20x2%20%2B%20e%5B3%5D%20%2A%20y2%20%2B%20e%5B6%5D%3B%0A%20%20%20%20this.y%20%3D%20e%5B1%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B7%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20min%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.min%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.min%28this.y%2C%20v.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20max%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28this.y%2C%20v.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clamp%28min2%2C%20max2%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28min2.x%2C%20Math.min%28max2.x%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28min2.y%2C%20Math.min%28max2.y%2C%20this.y%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampScalar%28minVal%2C%20maxVal%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.y%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampLength%28min2%2C%20max2%29%20%7B%0A%20%20%20%20const%20length2%20%3D%20this.length%28%29%3B%0A%20%20%20%20return%20this.divideScalar%28length2%20%7C%7C%201%29.multiplyScalar%28Math.max%28min2%2C%20Math.min%28max2%2C%20length2%29%29%29%3B%0A%20%20%7D%0A%20%20floor%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.floor%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.floor%28this.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20ceil%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.ceil%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.ceil%28this.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20round%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.round%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.round%28this.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20roundToZero%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.trunc%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.trunc%28this.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20negate%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20-this.x%3B%0A%20%20%20%20this.y%20%3D%20-this.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dot%28v%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20v.x%20%2B%20this.y%20%2A%20v.y%3B%0A%20%20%7D%0A%20%20cross%28v%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20v.y%20-%20this.y%20%2A%20v.x%3B%0A%20%20%7D%0A%20%20lengthSq%28%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%3B%0A%20%20%7D%0A%20%20length%28%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%29%3B%0A%20%20%7D%0A%20%20manhattanLength%28%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%29%20%2B%20Math.abs%28this.y%29%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20return%20this.divideScalar%28this.length%28%29%20%7C%7C%201%29%3B%0A%20%20%7D%0A%20%20angle%28%29%20%7B%0A%20%20%20%20const%20angle%20%3D%20Math.atan2%28-this.y%2C%20-this.x%29%20%2B%20Math.PI%3B%0A%20%20%20%20return%20angle%3B%0A%20%20%7D%0A%20%20angleTo%28v%29%20%7B%0A%20%20%20%20const%20denominator%20%3D%20Math.sqrt%28this.lengthSq%28%29%20%2A%20v.lengthSq%28%29%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20return%20Math.PI%20%2F%202%3B%0A%20%20%20%20const%20theta%20%3D%20this.dot%28v%29%20%2F%20denominator%3B%0A%20%20%20%20return%20Math.acos%28clamp%28theta%2C%20-1%2C%201%29%29%3B%0A%20%20%7D%0A%20%20distanceTo%28v%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.distanceToSquared%28v%29%29%3B%0A%20%20%7D%0A%20%20distanceToSquared%28v%29%20%7B%0A%20%20%20%20const%20dx%20%3D%20this.x%20-%20v.x%2C%20dy%20%3D%20this.y%20-%20v.y%3B%0A%20%20%20%20return%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%20%20%7D%0A%20%20manhattanDistanceTo%28v%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%20-%20v.x%29%20%2B%20Math.abs%28this.y%20-%20v.y%29%3B%0A%20%20%7D%0A%20%20setLength%28length2%29%20%7B%0A%20%20%20%20return%20this.normalize%28%29.multiplyScalar%28length2%29%3B%0A%20%20%7D%0A%20%20lerp%28v%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20%28v.x%20-%20this.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%2B%3D%20%28v.y%20-%20this.y%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpVectors%28v1%2C%20v2%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%3D%20v1.x%20%2B%20%28v2.x%20-%20v1.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%3D%20v1.y%20%2B%20%28v2.y%20-%20v1.y%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28v%29%20%7B%0A%20%20%20%20return%20v.x%20%3D%3D%3D%20this.x%20%26%26%20v.y%20%3D%3D%3D%20this.y%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.x%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this.y%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this.x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this.y%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this.x%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this.y%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateAround%28center%2C%20angle%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28angle%29%2C%20s%20%3D%20Math.sin%28angle%29%3B%0A%20%20%20%20const%20x2%20%3D%20this.x%20-%20center.x%3B%0A%20%20%20%20const%20y2%20%3D%20this.y%20-%20center.y%3B%0A%20%20%20%20this.x%20%3D%20x2%20%2A%20c2%20-%20y2%20%2A%20s%20%2B%20center.x%3B%0A%20%20%20%20this.y%20%3D%20x2%20%2A%20s%20%2B%20y2%20%2A%20c2%20%2B%20center.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20random%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.y%20%3D%20Math.random%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this.x%3B%0A%20%20%20%20yield%20this.y%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Matrix3%20%3D%20class%20_Matrix3%20%7B%0A%20%20constructor%28n11%2C%20n12%2C%20n13%2C%20n21%2C%20n22%2C%20n23%2C%20n31%2C%20n32%2C%20n33%29%20%7B%0A%20%20%20%20_Matrix3.prototype.isMatrix3%20%3D%20true%3B%0A%20%20%20%20this.elements%20%3D%20%5B%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%5D%3B%0A%20%20%20%20if%20%28n11%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.set%28n11%2C%20n12%2C%20n13%2C%20n21%2C%20n22%2C%20n23%2C%20n31%2C%20n32%2C%20n33%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20set%28n11%2C%20n12%2C%20n13%2C%20n21%2C%20n22%2C%20n23%2C%20n31%2C%20n32%2C%20n33%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20te%5B0%5D%20%3D%20n11%3B%0A%20%20%20%20te%5B1%5D%20%3D%20n21%3B%0A%20%20%20%20te%5B2%5D%20%3D%20n31%3B%0A%20%20%20%20te%5B3%5D%20%3D%20n12%3B%0A%20%20%20%20te%5B4%5D%20%3D%20n22%3B%0A%20%20%20%20te%5B5%5D%20%3D%20n32%3B%0A%20%20%20%20te%5B6%5D%20%3D%20n13%3B%0A%20%20%20%20te%5B7%5D%20%3D%20n23%3B%0A%20%20%20%20te%5B8%5D%20%3D%20n33%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20identity%28%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20te%5B0%5D%20%3D%20me%5B0%5D%3B%0A%20%20%20%20te%5B1%5D%20%3D%20me%5B1%5D%3B%0A%20%20%20%20te%5B2%5D%20%3D%20me%5B2%5D%3B%0A%20%20%20%20te%5B3%5D%20%3D%20me%5B3%5D%3B%0A%20%20%20%20te%5B4%5D%20%3D%20me%5B4%5D%3B%0A%20%20%20%20te%5B5%5D%20%3D%20me%5B5%5D%3B%0A%20%20%20%20te%5B6%5D%20%3D%20me%5B6%5D%3B%0A%20%20%20%20te%5B7%5D%20%3D%20me%5B7%5D%3B%0A%20%20%20%20te%5B8%5D%20%3D%20me%5B8%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20extractBasis%28xAxis%2C%20yAxis%2C%20zAxis%29%20%7B%0A%20%20%20%20xAxis.setFromMatrix3Column%28this%2C%200%29%3B%0A%20%20%20%20yAxis.setFromMatrix3Column%28this%2C%201%29%3B%0A%20%20%20%20zAxis.setFromMatrix3Column%28this%2C%202%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrix4%28m2%29%20%7B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20me%5B0%5D%2C%0A%20%20%20%20%20%20me%5B4%5D%2C%0A%20%20%20%20%20%20me%5B8%5D%2C%0A%20%20%20%20%20%20me%5B1%5D%2C%0A%20%20%20%20%20%20me%5B5%5D%2C%0A%20%20%20%20%20%20me%5B9%5D%2C%0A%20%20%20%20%20%20me%5B2%5D%2C%0A%20%20%20%20%20%20me%5B6%5D%2C%0A%20%20%20%20%20%20me%5B10%5D%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28m2%29%20%7B%0A%20%20%20%20return%20this.multiplyMatrices%28this%2C%20m2%29%3B%0A%20%20%7D%0A%20%20premultiply%28m2%29%20%7B%0A%20%20%20%20return%20this.multiplyMatrices%28m2%2C%20this%29%3B%0A%20%20%7D%0A%20%20multiplyMatrices%28a2%2C%20b%29%20%7B%0A%20%20%20%20const%20ae%20%3D%20a2.elements%3B%0A%20%20%20%20const%20be%20%3D%20b.elements%3B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20a11%20%3D%20ae%5B0%5D%2C%20a12%20%3D%20ae%5B3%5D%2C%20a13%20%3D%20ae%5B6%5D%3B%0A%20%20%20%20const%20a21%20%3D%20ae%5B1%5D%2C%20a22%20%3D%20ae%5B4%5D%2C%20a23%20%3D%20ae%5B7%5D%3B%0A%20%20%20%20const%20a31%20%3D%20ae%5B2%5D%2C%20a32%20%3D%20ae%5B5%5D%2C%20a33%20%3D%20ae%5B8%5D%3B%0A%20%20%20%20const%20b11%20%3D%20be%5B0%5D%2C%20b12%20%3D%20be%5B3%5D%2C%20b13%20%3D%20be%5B6%5D%3B%0A%20%20%20%20const%20b21%20%3D%20be%5B1%5D%2C%20b22%20%3D%20be%5B4%5D%2C%20b23%20%3D%20be%5B7%5D%3B%0A%20%20%20%20const%20b31%20%3D%20be%5B2%5D%2C%20b32%20%3D%20be%5B5%5D%2C%20b33%20%3D%20be%5B8%5D%3B%0A%20%20%20%20te%5B0%5D%20%3D%20a11%20%2A%20b11%20%2B%20a12%20%2A%20b21%20%2B%20a13%20%2A%20b31%3B%0A%20%20%20%20te%5B3%5D%20%3D%20a11%20%2A%20b12%20%2B%20a12%20%2A%20b22%20%2B%20a13%20%2A%20b32%3B%0A%20%20%20%20te%5B6%5D%20%3D%20a11%20%2A%20b13%20%2B%20a12%20%2A%20b23%20%2B%20a13%20%2A%20b33%3B%0A%20%20%20%20te%5B1%5D%20%3D%20a21%20%2A%20b11%20%2B%20a22%20%2A%20b21%20%2B%20a23%20%2A%20b31%3B%0A%20%20%20%20te%5B4%5D%20%3D%20a21%20%2A%20b12%20%2B%20a22%20%2A%20b22%20%2B%20a23%20%2A%20b32%3B%0A%20%20%20%20te%5B7%5D%20%3D%20a21%20%2A%20b13%20%2B%20a22%20%2A%20b23%20%2B%20a23%20%2A%20b33%3B%0A%20%20%20%20te%5B2%5D%20%3D%20a31%20%2A%20b11%20%2B%20a32%20%2A%20b21%20%2B%20a33%20%2A%20b31%3B%0A%20%20%20%20te%5B5%5D%20%3D%20a31%20%2A%20b12%20%2B%20a32%20%2A%20b22%20%2B%20a33%20%2A%20b32%3B%0A%20%20%20%20te%5B8%5D%20%3D%20a31%20%2A%20b13%20%2B%20a32%20%2A%20b23%20%2B%20a33%20%2A%20b33%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28s%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20te%5B0%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B3%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B6%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B1%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B4%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B7%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B2%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B5%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B8%5D%20%2A%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20determinant%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20a2%20%3D%20te%5B0%5D%2C%20b%20%3D%20te%5B1%5D%2C%20c2%20%3D%20te%5B2%5D%2C%20d%20%3D%20te%5B3%5D%2C%20e%20%3D%20te%5B4%5D%2C%20f%20%3D%20te%5B5%5D%2C%20g%20%3D%20te%5B6%5D%2C%20h%20%3D%20te%5B7%5D%2C%20i%20%3D%20te%5B8%5D%3B%0A%20%20%20%20return%20a2%20%2A%20e%20%2A%20i%20-%20a2%20%2A%20f%20%2A%20h%20-%20b%20%2A%20d%20%2A%20i%20%2B%20b%20%2A%20f%20%2A%20g%20%2B%20c2%20%2A%20d%20%2A%20h%20-%20c2%20%2A%20e%20%2A%20g%3B%0A%20%20%7D%0A%20%20invert%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%2C%20n11%20%3D%20te%5B0%5D%2C%20n21%20%3D%20te%5B1%5D%2C%20n31%20%3D%20te%5B2%5D%2C%20n12%20%3D%20te%5B3%5D%2C%20n22%20%3D%20te%5B4%5D%2C%20n32%20%3D%20te%5B5%5D%2C%20n13%20%3D%20te%5B6%5D%2C%20n23%20%3D%20te%5B7%5D%2C%20n33%20%3D%20te%5B8%5D%2C%20t11%20%3D%20n33%20%2A%20n22%20-%20n32%20%2A%20n23%2C%20t12%20%3D%20n32%20%2A%20n13%20-%20n33%20%2A%20n12%2C%20t13%20%3D%20n23%20%2A%20n12%20-%20n22%20%2A%20n13%2C%20det%20%3D%20n11%20%2A%20t11%20%2B%20n21%20%2A%20t12%20%2B%20n31%20%2A%20t13%3B%0A%20%20%20%20if%20%28det%20%3D%3D%3D%200%29%20return%20this.set%280%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20const%20detInv%20%3D%201%20%2F%20det%3B%0A%20%20%20%20te%5B0%5D%20%3D%20t11%20%2A%20detInv%3B%0A%20%20%20%20te%5B1%5D%20%3D%20%28n31%20%2A%20n23%20-%20n33%20%2A%20n21%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B2%5D%20%3D%20%28n32%20%2A%20n21%20-%20n31%20%2A%20n22%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B3%5D%20%3D%20t12%20%2A%20detInv%3B%0A%20%20%20%20te%5B4%5D%20%3D%20%28n33%20%2A%20n11%20-%20n31%20%2A%20n13%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B5%5D%20%3D%20%28n31%20%2A%20n12%20-%20n32%20%2A%20n11%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B6%5D%20%3D%20t13%20%2A%20detInv%3B%0A%20%20%20%20te%5B7%5D%20%3D%20%28n21%20%2A%20n13%20-%20n23%20%2A%20n11%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B8%5D%20%3D%20%28n22%20%2A%20n11%20-%20n21%20%2A%20n12%29%20%2A%20detInv%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20transpose%28%29%20%7B%0A%20%20%20%20let%20tmp2%3B%0A%20%20%20%20const%20m2%20%3D%20this.elements%3B%0A%20%20%20%20tmp2%20%3D%20m2%5B1%5D%3B%0A%20%20%20%20m2%5B1%5D%20%3D%20m2%5B3%5D%3B%0A%20%20%20%20m2%5B3%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20m2%5B2%5D%3B%0A%20%20%20%20m2%5B2%5D%20%3D%20m2%5B6%5D%3B%0A%20%20%20%20m2%5B6%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20m2%5B5%5D%3B%0A%20%20%20%20m2%5B5%5D%20%3D%20m2%5B7%5D%3B%0A%20%20%20%20m2%5B7%5D%20%3D%20tmp2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getNormalMatrix%28matrix4%29%20%7B%0A%20%20%20%20return%20this.setFromMatrix4%28matrix4%29.invert%28%29.transpose%28%29%3B%0A%20%20%7D%0A%20%20transposeIntoArray%28r%29%20%7B%0A%20%20%20%20const%20m2%20%3D%20this.elements%3B%0A%20%20%20%20r%5B0%5D%20%3D%20m2%5B0%5D%3B%0A%20%20%20%20r%5B1%5D%20%3D%20m2%5B3%5D%3B%0A%20%20%20%20r%5B2%5D%20%3D%20m2%5B6%5D%3B%0A%20%20%20%20r%5B3%5D%20%3D%20m2%5B1%5D%3B%0A%20%20%20%20r%5B4%5D%20%3D%20m2%5B4%5D%3B%0A%20%20%20%20r%5B5%5D%20%3D%20m2%5B7%5D%3B%0A%20%20%20%20r%5B6%5D%20%3D%20m2%5B2%5D%3B%0A%20%20%20%20r%5B7%5D%20%3D%20m2%5B5%5D%3B%0A%20%20%20%20r%5B8%5D%20%3D%20m2%5B8%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setUvTransform%28tx%2C%20ty%2C%20sx%2C%20sy%2C%20rotation%2C%20cx%2C%20cy%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28rotation%29%3B%0A%20%20%20%20const%20s%20%3D%20Math.sin%28rotation%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20sx%20%2A%20c2%2C%0A%20%20%20%20%20%20sx%20%2A%20s%2C%0A%20%20%20%20%20%20-sx%20%2A%20%28c2%20%2A%20cx%20%2B%20s%20%2A%20cy%29%20%2B%20cx%20%2B%20tx%2C%0A%20%20%20%20%20%20-sy%20%2A%20s%2C%0A%20%20%20%20%20%20sy%20%2A%20c2%2C%0A%20%20%20%20%20%20-sy%20%2A%20%28-s%20%2A%20cx%20%2B%20c2%20%2A%20cy%29%20%2B%20cy%20%2B%20ty%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%0A%20%20scale%28sx%2C%20sy%29%20%7B%0A%20%20%20%20this.premultiply%28_m3.makeScale%28sx%2C%20sy%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotate%28theta%29%20%7B%0A%20%20%20%20this.premultiply%28_m3.makeRotation%28-theta%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28tx%2C%20ty%29%20%7B%0A%20%20%20%20this.premultiply%28_m3.makeTranslation%28tx%2C%20ty%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20for%202D%20Transforms%0A%20%20makeTranslation%28x2%2C%20y2%29%20%7B%0A%20%20%20%20if%20%28x2.isVector2%29%20%7B%0A%20%20%20%20%20%20this.set%28%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2.x%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20x2.y%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.set%28%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotation%28theta%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28theta%29%3B%0A%20%20%20%20const%20s%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%20-s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20s%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeScale%28x2%2C%20y2%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%0A%20%20equals%28matrix%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20matrix.elements%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28te%5Bi%5D%20%21%3D%3D%20me%5Bi%5D%29%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.elements%5Bi%5D%20%3D%20array%5Bi%20%2B%20offset%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20array%5Boffset%5D%20%3D%20te%5B0%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20te%5B1%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20te%5B2%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20te%5B3%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%204%5D%20%3D%20te%5B4%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%205%5D%20%3D%20te%5B5%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%206%5D%20%3D%20te%5B6%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%207%5D%20%3D%20te%5B7%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%208%5D%20%3D%20te%5B8%5D%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.fromArray%28this.elements%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_m3%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%3B%0Afunction%20arrayNeedsUint32%28array%29%20%7B%0A%20%20for%20%28let%20i%20%3D%20array.length%20-%201%3B%20i%20%3E%3D%200%3B%20--i%29%20%7B%0A%20%20%20%20if%20%28array%5Bi%5D%20%3E%3D%2065535%29%20return%20true%3B%0A%20%20%7D%0A%20%20return%20false%3B%0A%7D%0Afunction%20createElementNS%28name%29%20%7B%0A%20%20return%20document.createElementNS%28%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%2C%20name%29%3B%0A%7D%0Afunction%20createCanvasElement%28%29%20%7B%0A%20%20const%20canvas%20%3D%20createElementNS%28%22canvas%22%29%3B%0A%20%20canvas.style.display%20%3D%20%22block%22%3B%0A%20%20return%20canvas%3B%0A%7D%0Avar%20_cache%20%3D%20%7B%7D%3B%0Afunction%20warnOnce%28message%29%20%7B%0A%20%20if%20%28message%20in%20_cache%29%20return%3B%0A%20%20_cache%5Bmessage%5D%20%3D%20true%3B%0A%20%20console.warn%28message%29%3B%0A%7D%0Afunction%20probeAsync%28gl%2C%20sync%2C%20interval2%29%20%7B%0A%20%20return%20new%20Promise%28function%28resolve%2C%20reject%29%20%7B%0A%20%20%20%20function%20probe%28%29%20%7B%0A%20%20%20%20%20%20switch%20%28gl.clientWaitSync%28sync%2C%20gl.SYNC_FLUSH_COMMANDS_BIT%2C%200%29%29%20%7B%0A%20%20%20%20%20%20%20%20case%20gl.WAIT_FAILED%3A%0A%20%20%20%20%20%20%20%20%20%20reject%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20gl.TIMEOUT_EXPIRED%3A%0A%20%20%20%20%20%20%20%20%20%20setTimeout%28probe%2C%20interval2%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20resolve%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20setTimeout%28probe%2C%20interval2%29%3B%0A%20%20%7D%29%3B%0A%7D%0Afunction%20toNormalizedProjectionMatrix%28projectionMatrix%29%20%7B%0A%20%20const%20m2%20%3D%20projectionMatrix.elements%3B%0A%20%20m2%5B2%5D%20%3D%200.5%20%2A%20m2%5B2%5D%20%2B%200.5%20%2A%20m2%5B3%5D%3B%0A%20%20m2%5B6%5D%20%3D%200.5%20%2A%20m2%5B6%5D%20%2B%200.5%20%2A%20m2%5B7%5D%3B%0A%20%20m2%5B10%5D%20%3D%200.5%20%2A%20m2%5B10%5D%20%2B%200.5%20%2A%20m2%5B11%5D%3B%0A%20%20m2%5B14%5D%20%3D%200.5%20%2A%20m2%5B14%5D%20%2B%200.5%20%2A%20m2%5B15%5D%3B%0A%7D%0Afunction%20toReversedProjectionMatrix%28projectionMatrix%29%20%7B%0A%20%20const%20m2%20%3D%20projectionMatrix.elements%3B%0A%20%20const%20isPerspectiveMatrix%20%3D%20m2%5B11%5D%20%3D%3D%3D%20-1%3B%0A%20%20if%20%28isPerspectiveMatrix%29%20%7B%0A%20%20%20%20m2%5B10%5D%20%3D%20-m2%5B10%5D%20-%201%3B%0A%20%20%20%20m2%5B14%5D%20%3D%20-m2%5B14%5D%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20m2%5B10%5D%20%3D%20-m2%5B10%5D%3B%0A%20%20%20%20m2%5B14%5D%20%3D%20-m2%5B14%5D%20%2B%201%3B%0A%20%20%7D%0A%7D%0Avar%20ColorManagement%20%3D%20%7B%0A%20%20enabled%3A%20true%2C%0A%20%20workingColorSpace%3A%20LinearSRGBColorSpace%2C%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Implementations%20of%20supported%20color%20spaces.%0A%20%20%20%2A%0A%20%20%20%2A%20Required%3A%0A%20%20%20%2A%09-%20primaries%3A%20chromaticity%20coordinates%20%5B%20rx%20ry%20gx%20gy%20bx%20by%20%5D%0A%20%20%20%2A%09-%20whitePoint%3A%20reference%20white%20%5B%20x%20y%20%5D%0A%20%20%20%2A%09-%20transfer%3A%20transfer%20function%20%28pre-defined%29%0A%20%20%20%2A%09-%20toXYZ%3A%20Matrix3%20RGB%20to%20XYZ%20transform%0A%20%20%20%2A%09-%20fromXYZ%3A%20Matrix3%20XYZ%20to%20RGB%20transform%0A%20%20%20%2A%09-%20luminanceCoefficients%3A%20RGB%20luminance%20coefficients%0A%20%20%20%2A%0A%20%20%20%2A%20Optional%3A%0A%20%20%20%2A%20%20-%20outputColorSpaceConfig%3A%20%7B%20drawingBufferColorSpace%3A%20ColorSpace%20%7D%0A%20%20%20%2A%20%20-%20workingColorSpaceConfig%3A%20%7B%20unpackColorSpace%3A%20ColorSpace%20%7D%0A%20%20%20%2A%0A%20%20%20%2A%20Reference%3A%0A%20%20%20%2A%20-%20https%3A%2F%2Fwww.russellcottrell.com%2Fphoto%2FmatrixCalculator.htm%0A%20%20%20%2A%2F%0A%20%20spaces%3A%20%7B%7D%2C%0A%20%20convert%3A%20function%28color2%2C%20sourceColorSpace%2C%20targetColorSpace%29%20%7B%0A%20%20%20%20if%20%28this.enabled%20%3D%3D%3D%20false%20%7C%7C%20sourceColorSpace%20%3D%3D%3D%20targetColorSpace%20%7C%7C%20%21sourceColorSpace%20%7C%7C%20%21targetColorSpace%29%20%7B%0A%20%20%20%20%20%20return%20color2%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.spaces%5BsourceColorSpace%5D.transfer%20%3D%3D%3D%20SRGBTransfer%29%20%7B%0A%20%20%20%20%20%20color2.r%20%3D%20SRGBToLinear%28color2.r%29%3B%0A%20%20%20%20%20%20color2.g%20%3D%20SRGBToLinear%28color2.g%29%3B%0A%20%20%20%20%20%20color2.b%20%3D%20SRGBToLinear%28color2.b%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.spaces%5BsourceColorSpace%5D.primaries%20%21%3D%3D%20this.spaces%5BtargetColorSpace%5D.primaries%29%20%7B%0A%20%20%20%20%20%20color2.applyMatrix3%28this.spaces%5BsourceColorSpace%5D.toXYZ%29%3B%0A%20%20%20%20%20%20color2.applyMatrix3%28this.spaces%5BtargetColorSpace%5D.fromXYZ%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.spaces%5BtargetColorSpace%5D.transfer%20%3D%3D%3D%20SRGBTransfer%29%20%7B%0A%20%20%20%20%20%20color2.r%20%3D%20LinearToSRGB%28color2.r%29%3B%0A%20%20%20%20%20%20color2.g%20%3D%20LinearToSRGB%28color2.g%29%3B%0A%20%20%20%20%20%20color2.b%20%3D%20LinearToSRGB%28color2.b%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20color2%3B%0A%20%20%7D%2C%0A%20%20fromWorkingColorSpace%3A%20function%28color2%2C%20targetColorSpace%29%20%7B%0A%20%20%20%20return%20this.convert%28color2%2C%20this.workingColorSpace%2C%20targetColorSpace%29%3B%0A%20%20%7D%2C%0A%20%20toWorkingColorSpace%3A%20function%28color2%2C%20sourceColorSpace%29%20%7B%0A%20%20%20%20return%20this.convert%28color2%2C%20sourceColorSpace%2C%20this.workingColorSpace%29%3B%0A%20%20%7D%2C%0A%20%20getPrimaries%3A%20function%28colorSpace%29%20%7B%0A%20%20%20%20return%20this.spaces%5BcolorSpace%5D.primaries%3B%0A%20%20%7D%2C%0A%20%20getTransfer%3A%20function%28colorSpace%29%20%7B%0A%20%20%20%20if%20%28colorSpace%20%3D%3D%3D%20NoColorSpace%29%20return%20LinearTransfer%3B%0A%20%20%20%20return%20this.spaces%5BcolorSpace%5D.transfer%3B%0A%20%20%7D%2C%0A%20%20getLuminanceCoefficients%3A%20function%28target%2C%20colorSpace%20%3D%20this.workingColorSpace%29%20%7B%0A%20%20%20%20return%20target.fromArray%28this.spaces%5BcolorSpace%5D.luminanceCoefficients%29%3B%0A%20%20%7D%2C%0A%20%20define%3A%20function%28colorSpaces%29%20%7B%0A%20%20%20%20Object.assign%28this.spaces%2C%20colorSpaces%29%3B%0A%20%20%7D%2C%0A%20%20%2F%2F%20Internal%20APIs%0A%20%20_getMatrix%3A%20function%28targetMatrix%2C%20sourceColorSpace%2C%20targetColorSpace%29%20%7B%0A%20%20%20%20return%20targetMatrix.copy%28this.spaces%5BsourceColorSpace%5D.toXYZ%29.multiply%28this.spaces%5BtargetColorSpace%5D.fromXYZ%29%3B%0A%20%20%7D%2C%0A%20%20_getDrawingBufferColorSpace%3A%20function%28colorSpace%29%20%7B%0A%20%20%20%20return%20this.spaces%5BcolorSpace%5D.outputColorSpaceConfig.drawingBufferColorSpace%3B%0A%20%20%7D%2C%0A%20%20_getUnpackColorSpace%3A%20function%28colorSpace%20%3D%20this.workingColorSpace%29%20%7B%0A%20%20%20%20return%20this.spaces%5BcolorSpace%5D.workingColorSpaceConfig.unpackColorSpace%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20SRGBToLinear%28c2%29%20%7B%0A%20%20return%20c2%20%3C%200.04045%20%3F%20c2%20%2A%200.0773993808%20%3A%20Math.pow%28c2%20%2A%200.9478672986%20%2B%200.0521327014%2C%202.4%29%3B%0A%7D%0Afunction%20LinearToSRGB%28c2%29%20%7B%0A%20%20return%20c2%20%3C%2031308e-7%20%3F%20c2%20%2A%2012.92%20%3A%201.055%20%2A%20Math.pow%28c2%2C%200.41666%29%20-%200.055%3B%0A%7D%0Avar%20REC709_PRIMARIES%20%3D%20%5B0.64%2C%200.33%2C%200.3%2C%200.6%2C%200.15%2C%200.06%5D%3B%0Avar%20REC709_LUMINANCE_COEFFICIENTS%20%3D%20%5B0.2126%2C%200.7152%2C%200.0722%5D%3B%0Avar%20D65%20%3D%20%5B0.3127%2C%200.329%5D%3B%0Avar%20LINEAR_REC709_TO_XYZ%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29.set%28%0A%20%200.4123908%2C%0A%20%200.3575843%2C%0A%20%200.1804808%2C%0A%20%200.212639%2C%0A%20%200.7151687%2C%0A%20%200.0721923%2C%0A%20%200.0193308%2C%0A%20%200.1191948%2C%0A%20%200.9505322%0A%29%3B%0Avar%20XYZ_TO_LINEAR_REC709%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29.set%28%0A%20%203.2409699%2C%0A%20%20-1.5373832%2C%0A%20%20-0.4986108%2C%0A%20%20-0.9692436%2C%0A%20%201.8759675%2C%0A%20%200.0415551%2C%0A%20%200.0556301%2C%0A%20%20-0.203977%2C%0A%20%201.0569715%0A%29%3B%0AColorManagement.define%28%7B%0A%20%20%5BLinearSRGBColorSpace%5D%3A%20%7B%0A%20%20%20%20primaries%3A%20REC709_PRIMARIES%2C%0A%20%20%20%20whitePoint%3A%20D65%2C%0A%20%20%20%20transfer%3A%20LinearTransfer%2C%0A%20%20%20%20toXYZ%3A%20LINEAR_REC709_TO_XYZ%2C%0A%20%20%20%20fromXYZ%3A%20XYZ_TO_LINEAR_REC709%2C%0A%20%20%20%20luminanceCoefficients%3A%20REC709_LUMINANCE_COEFFICIENTS%2C%0A%20%20%20%20workingColorSpaceConfig%3A%20%7B%20unpackColorSpace%3A%20SRGBColorSpace%20%7D%2C%0A%20%20%20%20outputColorSpaceConfig%3A%20%7B%20drawingBufferColorSpace%3A%20SRGBColorSpace%20%7D%0A%20%20%7D%2C%0A%20%20%5BSRGBColorSpace%5D%3A%20%7B%0A%20%20%20%20primaries%3A%20REC709_PRIMARIES%2C%0A%20%20%20%20whitePoint%3A%20D65%2C%0A%20%20%20%20transfer%3A%20SRGBTransfer%2C%0A%20%20%20%20toXYZ%3A%20LINEAR_REC709_TO_XYZ%2C%0A%20%20%20%20fromXYZ%3A%20XYZ_TO_LINEAR_REC709%2C%0A%20%20%20%20luminanceCoefficients%3A%20REC709_LUMINANCE_COEFFICIENTS%2C%0A%20%20%20%20outputColorSpaceConfig%3A%20%7B%20drawingBufferColorSpace%3A%20SRGBColorSpace%20%7D%0A%20%20%7D%0A%7D%29%3B%0Avar%20_canvas%3B%0Avar%20ImageUtils%20%3D%20class%20%7B%0A%20%20static%20getDataURL%28image%29%20%7B%0A%20%20%20%20if%20%28%2F%5Edata%3A%2Fi.test%28image.src%29%29%20%7B%0A%20%20%20%20%20%20return%20image.src%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28typeof%20HTMLCanvasElement%20%3D%3D%3D%20%22undefined%22%29%20%7B%0A%20%20%20%20%20%20return%20image.src%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20canvas%3B%0A%20%20%20%20if%20%28image%20instanceof%20HTMLCanvasElement%29%20%7B%0A%20%20%20%20%20%20canvas%20%3D%20image%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28_canvas%20%3D%3D%3D%20void%200%29%20_canvas%20%3D%20createElementNS%28%22canvas%22%29%3B%0A%20%20%20%20%20%20_canvas.width%20%3D%20image.width%3B%0A%20%20%20%20%20%20_canvas.height%20%3D%20image.height%3B%0A%20%20%20%20%20%20const%20context2%20%3D%20_canvas.getContext%28%222d%22%29%3B%0A%20%20%20%20%20%20if%20%28image%20instanceof%20ImageData%29%20%7B%0A%20%20%20%20%20%20%20%20context2.putImageData%28image%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20context2.drawImage%28image%2C%200%2C%200%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20canvas%20%3D%20_canvas%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28canvas.width%20%3E%202048%20%7C%7C%20canvas.height%20%3E%202048%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.ImageUtils.getDataURL%3A%20Image%20converted%20to%20jpg%20for%20performance%20reasons%22%2C%20image%29%3B%0A%20%20%20%20%20%20return%20canvas.toDataURL%28%22image%2Fjpeg%22%2C%200.6%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20canvas.toDataURL%28%22image%2Fpng%22%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20static%20sRGBToLinear%28image%29%20%7B%0A%20%20%20%20if%20%28typeof%20HTMLImageElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLImageElement%20%7C%7C%20typeof%20HTMLCanvasElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLCanvasElement%20%7C%7C%20typeof%20ImageBitmap%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20ImageBitmap%29%20%7B%0A%20%20%20%20%20%20const%20canvas%20%3D%20createElementNS%28%22canvas%22%29%3B%0A%20%20%20%20%20%20canvas.width%20%3D%20image.width%3B%0A%20%20%20%20%20%20canvas.height%20%3D%20image.height%3B%0A%20%20%20%20%20%20const%20context2%20%3D%20canvas.getContext%28%222d%22%29%3B%0A%20%20%20%20%20%20context2.drawImage%28image%2C%200%2C%200%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20const%20imageData%20%3D%20context2.getImageData%280%2C%200%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20const%20data%20%3D%20imageData.data%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20data.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20data%5Bi%5D%20%3D%20SRGBToLinear%28data%5Bi%5D%20%2F%20255%29%20%2A%20255%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20context2.putImageData%28imageData%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20return%20canvas%3B%0A%20%20%20%20%7D%20else%20if%20%28image.data%29%20%7B%0A%20%20%20%20%20%20const%20data%20%3D%20image.data.slice%280%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20data.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28data%20instanceof%20Uint8Array%20%7C%7C%20data%20instanceof%20Uint8ClampedArray%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20data%5Bi%5D%20%3D%20Math.floor%28SRGBToLinear%28data%5Bi%5D%20%2F%20255%29%20%2A%20255%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20data%5Bi%5D%20%3D%20SRGBToLinear%28data%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20data%2C%0A%20%20%20%20%20%20%20%20width%3A%20image.width%2C%0A%20%20%20%20%20%20%20%20height%3A%20image.height%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.ImageUtils.sRGBToLinear%28%29%3A%20Unsupported%20image%20type.%20No%20color%20space%20conversion%20applied.%22%29%3B%0A%20%20%20%20%20%20return%20image%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20_sourceId%20%3D%200%3B%0Avar%20Source%20%3D%20class%20%7B%0A%20%20constructor%28data%20%3D%20null%29%20%7B%0A%20%20%20%20this.isSource%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_sourceId%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID%28%29%3B%0A%20%20%20%20this.data%20%3D%20data%3B%0A%20%20%20%20this.dataReady%20%3D%20true%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20this.version%2B%2B%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20isRootObject%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20if%20%28%21isRootObject%20%26%26%20meta.images%5Bthis.uuid%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20return%20meta.images%5Bthis.uuid%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20output2%20%3D%20%7B%0A%20%20%20%20%20%20uuid%3A%20this.uuid%2C%0A%20%20%20%20%20%20url%3A%20%22%22%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20data%20%3D%20this.data%3B%0A%20%20%20%20if%20%28data%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20let%20url%3B%0A%20%20%20%20%20%20if%20%28Array.isArray%28data%29%29%20%7B%0A%20%20%20%20%20%20%20%20url%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20data.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28data%5Bi%5D.isDataTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20url.push%28serializeImage%28data%5Bi%5D.image%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20url.push%28serializeImage%28data%5Bi%5D%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20url%20%3D%20serializeImage%28data%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20output2.url%20%3D%20url%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%21isRootObject%29%20%7B%0A%20%20%20%20%20%20meta.images%5Bthis.uuid%5D%20%3D%20output2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20serializeImage%28image%29%20%7B%0A%20%20if%20%28typeof%20HTMLImageElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLImageElement%20%7C%7C%20typeof%20HTMLCanvasElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLCanvasElement%20%7C%7C%20typeof%20ImageBitmap%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20ImageBitmap%29%20%7B%0A%20%20%20%20return%20ImageUtils.getDataURL%28image%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28image.data%29%20%7B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20data%3A%20Array.from%28image.data%29%2C%0A%20%20%20%20%20%20%20%20width%3A%20image.width%2C%0A%20%20%20%20%20%20%20%20height%3A%20image.height%2C%0A%20%20%20%20%20%20%20%20type%3A%20image.data.constructor.name%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.Texture%3A%20Unable%20to%20serialize%20Texture.%22%29%3B%0A%20%20%20%20%20%20return%20%7B%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Avar%20_textureId%20%3D%200%3B%0Avar%20Texture%20%3D%20class%20_Texture%20extends%20EventDispatcher%20%7B%0A%20%20constructor%28image%20%3D%20_Texture.DEFAULT_IMAGE%2C%20mapping%20%3D%20_Texture.DEFAULT_MAPPING%2C%20wrapS%20%3D%20ClampToEdgeWrapping%2C%20wrapT%20%3D%20ClampToEdgeWrapping%2C%20magFilter%20%3D%20LinearFilter%2C%20minFilter%20%3D%20LinearMipmapLinearFilter%2C%20format2%20%3D%20RGBAFormat%2C%20type%20%3D%20UnsignedByteType%2C%20anisotropy2%20%3D%20_Texture.DEFAULT_ANISOTROPY%2C%20colorSpace%20%3D%20NoColorSpace%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isTexture%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_textureId%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID%28%29%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.source%20%3D%20new%20Source%28image%29%3B%0A%20%20%20%20this.mipmaps%20%3D%20%5B%5D%3B%0A%20%20%20%20this.mapping%20%3D%20mapping%3B%0A%20%20%20%20this.channel%20%3D%200%3B%0A%20%20%20%20this.wrapS%20%3D%20wrapS%3B%0A%20%20%20%20this.wrapT%20%3D%20wrapT%3B%0A%20%20%20%20this.magFilter%20%3D%20magFilter%3B%0A%20%20%20%20this.minFilter%20%3D%20minFilter%3B%0A%20%20%20%20this.anisotropy%20%3D%20anisotropy2%3B%0A%20%20%20%20this.format%20%3D%20format2%3B%0A%20%20%20%20this.internalFormat%20%3D%20null%3B%0A%20%20%20%20this.type%20%3D%20type%3B%0A%20%20%20%20this.offset%20%3D%20new%20Vector2%280%2C%200%29%3B%0A%20%20%20%20this.repeat%20%3D%20new%20Vector2%281%2C%201%29%3B%0A%20%20%20%20this.center%20%3D%20new%20Vector2%280%2C%200%29%3B%0A%20%20%20%20this.rotation%20%3D%200%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20true%3B%0A%20%20%20%20this.matrix%20%3D%20new%20Matrix3%28%29%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20true%3B%0A%20%20%20%20this.premultiplyAlpha%20%3D%20false%3B%0A%20%20%20%20this.flipY%20%3D%20true%3B%0A%20%20%20%20this.unpackAlignment%20%3D%204%3B%0A%20%20%20%20this.colorSpace%20%3D%20colorSpace%3B%0A%20%20%20%20this.userData%20%3D%20%7B%7D%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%20%20this.onUpdate%20%3D%20null%3B%0A%20%20%20%20this.isRenderTargetTexture%20%3D%20false%3B%0A%20%20%20%20this.pmremVersion%20%3D%200%3B%0A%20%20%7D%0A%20%20get%20image%28%29%20%7B%0A%20%20%20%20return%20this.source.data%3B%0A%20%20%7D%0A%20%20set%20image%28value%20%3D%20null%29%20%7B%0A%20%20%20%20this.source.data%20%3D%20value%3B%0A%20%20%7D%0A%20%20updateMatrix%28%29%20%7B%0A%20%20%20%20this.matrix.setUvTransform%28this.offset.x%2C%20this.offset.y%2C%20this.repeat.x%2C%20this.repeat.y%2C%20this.rotation%2C%20this.center.x%2C%20this.center.y%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20this.source%20%3D%20source.source%3B%0A%20%20%20%20this.mipmaps%20%3D%20source.mipmaps.slice%280%29%3B%0A%20%20%20%20this.mapping%20%3D%20source.mapping%3B%0A%20%20%20%20this.channel%20%3D%20source.channel%3B%0A%20%20%20%20this.wrapS%20%3D%20source.wrapS%3B%0A%20%20%20%20this.wrapT%20%3D%20source.wrapT%3B%0A%20%20%20%20this.magFilter%20%3D%20source.magFilter%3B%0A%20%20%20%20this.minFilter%20%3D%20source.minFilter%3B%0A%20%20%20%20this.anisotropy%20%3D%20source.anisotropy%3B%0A%20%20%20%20this.format%20%3D%20source.format%3B%0A%20%20%20%20this.internalFormat%20%3D%20source.internalFormat%3B%0A%20%20%20%20this.type%20%3D%20source.type%3B%0A%20%20%20%20this.offset.copy%28source.offset%29%3B%0A%20%20%20%20this.repeat.copy%28source.repeat%29%3B%0A%20%20%20%20this.center.copy%28source.center%29%3B%0A%20%20%20%20this.rotation%20%3D%20source.rotation%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20source.matrixAutoUpdate%3B%0A%20%20%20%20this.matrix.copy%28source.matrix%29%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20source.generateMipmaps%3B%0A%20%20%20%20this.premultiplyAlpha%20%3D%20source.premultiplyAlpha%3B%0A%20%20%20%20this.flipY%20%3D%20source.flipY%3B%0A%20%20%20%20this.unpackAlignment%20%3D%20source.unpackAlignment%3B%0A%20%20%20%20this.colorSpace%20%3D%20source.colorSpace%3B%0A%20%20%20%20this.userData%20%3D%20JSON.parse%28JSON.stringify%28source.userData%29%29%3B%0A%20%20%20%20this.needsUpdate%20%3D%20true%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20isRootObject%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20if%20%28%21isRootObject%20%26%26%20meta.textures%5Bthis.uuid%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20return%20meta.textures%5Bthis.uuid%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20output2%20%3D%20%7B%0A%20%20%20%20%20%20metadata%3A%20%7B%0A%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22Texture%22%2C%0A%20%20%20%20%20%20%20%20generator%3A%20%22Texture.toJSON%22%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20uuid%3A%20this.uuid%2C%0A%20%20%20%20%20%20name%3A%20this.name%2C%0A%20%20%20%20%20%20image%3A%20this.source.toJSON%28meta%29.uuid%2C%0A%20%20%20%20%20%20mapping%3A%20this.mapping%2C%0A%20%20%20%20%20%20channel%3A%20this.channel%2C%0A%20%20%20%20%20%20repeat%3A%20%5Bthis.repeat.x%2C%20this.repeat.y%5D%2C%0A%20%20%20%20%20%20offset%3A%20%5Bthis.offset.x%2C%20this.offset.y%5D%2C%0A%20%20%20%20%20%20center%3A%20%5Bthis.center.x%2C%20this.center.y%5D%2C%0A%20%20%20%20%20%20rotation%3A%20this.rotation%2C%0A%20%20%20%20%20%20wrap%3A%20%5Bthis.wrapS%2C%20this.wrapT%5D%2C%0A%20%20%20%20%20%20format%3A%20this.format%2C%0A%20%20%20%20%20%20internalFormat%3A%20this.internalFormat%2C%0A%20%20%20%20%20%20type%3A%20this.type%2C%0A%20%20%20%20%20%20colorSpace%3A%20this.colorSpace%2C%0A%20%20%20%20%20%20minFilter%3A%20this.minFilter%2C%0A%20%20%20%20%20%20magFilter%3A%20this.magFilter%2C%0A%20%20%20%20%20%20anisotropy%3A%20this.anisotropy%2C%0A%20%20%20%20%20%20flipY%3A%20this.flipY%2C%0A%20%20%20%20%20%20generateMipmaps%3A%20this.generateMipmaps%2C%0A%20%20%20%20%20%20premultiplyAlpha%3A%20this.premultiplyAlpha%2C%0A%20%20%20%20%20%20unpackAlignment%3A%20this.unpackAlignment%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28Object.keys%28this.userData%29.length%20%3E%200%29%20output2.userData%20%3D%20this.userData%3B%0A%20%20%20%20if%20%28%21isRootObject%29%20%7B%0A%20%20%20%20%20%20meta.textures%5Bthis.uuid%5D%20%3D%20output2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%20%20transformUv%28uv2%29%20%7B%0A%20%20%20%20if%20%28this.mapping%20%21%3D%3D%20UVMapping%29%20return%20uv2%3B%0A%20%20%20%20uv2.applyMatrix3%28this.matrix%29%3B%0A%20%20%20%20if%20%28uv2.x%20%3C%200%20%7C%7C%20uv2.x%20%3E%201%29%20%7B%0A%20%20%20%20%20%20switch%20%28this.wrapS%29%20%7B%0A%20%20%20%20%20%20%20%20case%20RepeatWrapping%3A%0A%20%20%20%20%20%20%20%20%20%20uv2.x%20%3D%20uv2.x%20-%20Math.floor%28uv2.x%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20ClampToEdgeWrapping%3A%0A%20%20%20%20%20%20%20%20%20%20uv2.x%20%3D%20uv2.x%20%3C%200%20%3F%200%20%3A%201%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20MirroredRepeatWrapping%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28Math.abs%28Math.floor%28uv2.x%29%20%25%202%29%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uv2.x%20%3D%20Math.ceil%28uv2.x%29%20-%20uv2.x%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uv2.x%20%3D%20uv2.x%20-%20Math.floor%28uv2.x%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28uv2.y%20%3C%200%20%7C%7C%20uv2.y%20%3E%201%29%20%7B%0A%20%20%20%20%20%20switch%20%28this.wrapT%29%20%7B%0A%20%20%20%20%20%20%20%20case%20RepeatWrapping%3A%0A%20%20%20%20%20%20%20%20%20%20uv2.y%20%3D%20uv2.y%20-%20Math.floor%28uv2.y%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20ClampToEdgeWrapping%3A%0A%20%20%20%20%20%20%20%20%20%20uv2.y%20%3D%20uv2.y%20%3C%200%20%3F%200%20%3A%201%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20MirroredRepeatWrapping%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28Math.abs%28Math.floor%28uv2.y%29%20%25%202%29%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uv2.y%20%3D%20Math.ceil%28uv2.y%29%20-%20uv2.y%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uv2.y%20%3D%20uv2.y%20-%20Math.floor%28uv2.y%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.flipY%29%20%7B%0A%20%20%20%20%20%20uv2.y%20%3D%201%20-%20uv2.y%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20uv2%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%20%20this.source.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20set%20needsPMREMUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.pmremVersion%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0ATexture.DEFAULT_IMAGE%20%3D%20null%3B%0ATexture.DEFAULT_MAPPING%20%3D%20UVMapping%3B%0ATexture.DEFAULT_ANISOTROPY%20%3D%201%3B%0Avar%20Vector4%20%3D%20class%20_Vector4%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%2C%20z2%20%3D%200%2C%20w%20%3D%201%29%20%7B%0A%20%20%20%20_Vector4.prototype.isVector4%20%3D%20true%3B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20this.w%20%3D%20w%3B%0A%20%20%7D%0A%20%20get%20width%28%29%20%7B%0A%20%20%20%20return%20this.z%3B%0A%20%20%7D%0A%20%20set%20width%28value%29%20%7B%0A%20%20%20%20this.z%20%3D%20value%3B%0A%20%20%7D%0A%20%20get%20height%28%29%20%7B%0A%20%20%20%20return%20this.w%3B%0A%20%20%7D%0A%20%20set%20height%28value%29%20%7B%0A%20%20%20%20this.w%20%3D%20value%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20this.w%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%3D%20scalar%3B%0A%20%20%20%20this.y%20%3D%20scalar%3B%0A%20%20%20%20this.z%20%3D%20scalar%3B%0A%20%20%20%20this.w%20%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setX%28x2%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setY%28y2%29%20%7B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setZ%28z2%29%20%7B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setW%28w%29%20%7B%0A%20%20%20%20this.w%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setComponent%28index5%2C%20value%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20this.x%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20this.y%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20this.z%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%203%3A%0A%20%20%20%20%20%20%20%20this.w%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getComponent%28index5%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20return%20this.x%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20return%20this.y%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20return%20this.z%3B%0A%20%20%20%20%20%20case%203%3A%0A%20%20%20%20%20%20%20%20return%20this.w%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.x%2C%20this.y%2C%20this.z%2C%20this.w%29%3B%0A%20%20%7D%0A%20%20copy%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20v.x%3B%0A%20%20%20%20this.y%20%3D%20v.y%3B%0A%20%20%20%20this.z%20%3D%20v.z%3B%0A%20%20%20%20this.w%20%3D%20v.w%20%21%3D%3D%20void%200%20%3F%20v.w%20%3A%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20add%28v%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%3B%0A%20%20%20%20this.z%20%2B%3D%20v.z%3B%0A%20%20%20%20this.w%20%2B%3D%20v.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScalar%28s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20s%3B%0A%20%20%20%20this.z%20%2B%3D%20s%3B%0A%20%20%20%20this.w%20%2B%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20%2B%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20%2B%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20%2B%20b.z%3B%0A%20%20%20%20this.w%20%3D%20a2.w%20%2B%20b.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScaledVector%28v%2C%20s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%20%2A%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%20%2A%20s%3B%0A%20%20%20%20this.z%20%2B%3D%20v.z%20%2A%20s%3B%0A%20%20%20%20this.w%20%2B%3D%20v.w%20%2A%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20sub%28v%29%20%7B%0A%20%20%20%20this.x%20-%3D%20v.x%3B%0A%20%20%20%20this.y%20-%3D%20v.y%3B%0A%20%20%20%20this.z%20-%3D%20v.z%3B%0A%20%20%20%20this.w%20-%3D%20v.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subScalar%28s%29%20%7B%0A%20%20%20%20this.x%20-%3D%20s%3B%0A%20%20%20%20this.y%20-%3D%20s%3B%0A%20%20%20%20this.z%20-%3D%20s%3B%0A%20%20%20%20this.w%20-%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20-%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20-%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20-%20b.z%3B%0A%20%20%20%20this.w%20%3D%20a2.w%20-%20b.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28v%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20v.x%3B%0A%20%20%20%20this.y%20%2A%3D%20v.y%3B%0A%20%20%20%20this.z%20%2A%3D%20v.z%3B%0A%20%20%20%20this.w%20%2A%3D%20v.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20scalar%3B%0A%20%20%20%20this.y%20%2A%3D%20scalar%3B%0A%20%20%20%20this.z%20%2A%3D%20scalar%3B%0A%20%20%20%20this.w%20%2A%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix4%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%2C%20z2%20%3D%20this.z%2C%20w%20%3D%20this.w%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B0%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B8%5D%20%2A%20z2%20%2B%20e%5B12%5D%20%2A%20w%3B%0A%20%20%20%20this.y%20%3D%20e%5B1%5D%20%2A%20x2%20%2B%20e%5B5%5D%20%2A%20y2%20%2B%20e%5B9%5D%20%2A%20z2%20%2B%20e%5B13%5D%20%2A%20w%3B%0A%20%20%20%20this.z%20%3D%20e%5B2%5D%20%2A%20x2%20%2B%20e%5B6%5D%20%2A%20y2%20%2B%20e%5B10%5D%20%2A%20z2%20%2B%20e%5B14%5D%20%2A%20w%3B%0A%20%20%20%20this.w%20%3D%20e%5B3%5D%20%2A%20x2%20%2B%20e%5B7%5D%20%2A%20y2%20%2B%20e%5B11%5D%20%2A%20z2%20%2B%20e%5B15%5D%20%2A%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divide%28v%29%20%7B%0A%20%20%20%20this.x%20%2F%3D%20v.x%3B%0A%20%20%20%20this.y%20%2F%3D%20v.y%3B%0A%20%20%20%20this.z%20%2F%3D%20v.z%3B%0A%20%20%20%20this.w%20%2F%3D%20v.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divideScalar%28scalar%29%20%7B%0A%20%20%20%20return%20this.multiplyScalar%281%20%2F%20scalar%29%3B%0A%20%20%7D%0A%20%20setAxisAngleFromQuaternion%28q%29%20%7B%0A%20%20%20%20this.w%20%3D%202%20%2A%20Math.acos%28q.w%29%3B%0A%20%20%20%20const%20s%20%3D%20Math.sqrt%281%20-%20q.w%20%2A%20q.w%29%3B%0A%20%20%20%20if%20%28s%20%3C%201e-4%29%20%7B%0A%20%20%20%20%20%20this.x%20%3D%201%3B%0A%20%20%20%20%20%20this.y%20%3D%200%3B%0A%20%20%20%20%20%20this.z%20%3D%200%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.x%20%3D%20q.x%20%2F%20s%3B%0A%20%20%20%20%20%20this.y%20%3D%20q.y%20%2F%20s%3B%0A%20%20%20%20%20%20this.z%20%3D%20q.z%20%2F%20s%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setAxisAngleFromRotationMatrix%28m2%29%20%7B%0A%20%20%20%20let%20angle%2C%20x2%2C%20y2%2C%20z2%3B%0A%20%20%20%20const%20epsilon%20%3D%200.01%2C%20epsilon2%20%3D%200.1%2C%20te%20%3D%20m2.elements%2C%20m11%20%3D%20te%5B0%5D%2C%20m12%20%3D%20te%5B4%5D%2C%20m13%20%3D%20te%5B8%5D%2C%20m21%20%3D%20te%5B1%5D%2C%20m22%20%3D%20te%5B5%5D%2C%20m23%20%3D%20te%5B9%5D%2C%20m31%20%3D%20te%5B2%5D%2C%20m32%20%3D%20te%5B6%5D%2C%20m33%20%3D%20te%5B10%5D%3B%0A%20%20%20%20if%20%28Math.abs%28m12%20-%20m21%29%20%3C%20epsilon%20%26%26%20Math.abs%28m13%20-%20m31%29%20%3C%20epsilon%20%26%26%20Math.abs%28m23%20-%20m32%29%20%3C%20epsilon%29%20%7B%0A%20%20%20%20%20%20if%20%28Math.abs%28m12%20%2B%20m21%29%20%3C%20epsilon2%20%26%26%20Math.abs%28m13%20%2B%20m31%29%20%3C%20epsilon2%20%26%26%20Math.abs%28m23%20%2B%20m32%29%20%3C%20epsilon2%20%26%26%20Math.abs%28m11%20%2B%20m22%20%2B%20m33%20-%203%29%20%3C%20epsilon2%29%20%7B%0A%20%20%20%20%20%20%20%20this.set%281%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20angle%20%3D%20Math.PI%3B%0A%20%20%20%20%20%20const%20xx%20%3D%20%28m11%20%2B%201%29%20%2F%202%3B%0A%20%20%20%20%20%20const%20yy%20%3D%20%28m22%20%2B%201%29%20%2F%202%3B%0A%20%20%20%20%20%20const%20zz%20%3D%20%28m33%20%2B%201%29%20%2F%202%3B%0A%20%20%20%20%20%20const%20xy%20%3D%20%28m12%20%2B%20m21%29%20%2F%204%3B%0A%20%20%20%20%20%20const%20xz%20%3D%20%28m13%20%2B%20m31%29%20%2F%204%3B%0A%20%20%20%20%20%20const%20yz%20%3D%20%28m23%20%2B%20m32%29%20%2F%204%3B%0A%20%20%20%20%20%20if%20%28xx%20%3E%20yy%20%26%26%20xx%20%3E%20zz%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28xx%20%3C%20epsilon%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%20Math.sqrt%28xx%29%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%20xy%20%2F%20x2%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%20xz%20%2F%20x2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28yy%20%3E%20zz%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28yy%20%3C%20epsilon%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%20Math.sqrt%28yy%29%3B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%20xy%20%2F%20y2%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%20yz%20%2F%20y2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28zz%20%3C%20epsilon%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%20Math.sqrt%28zz%29%3B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%20xz%20%2F%20z2%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%20yz%20%2F%20z2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.set%28x2%2C%20y2%2C%20z2%2C%20angle%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20s%20%3D%20Math.sqrt%28%28m32%20-%20m23%29%20%2A%20%28m32%20-%20m23%29%20%2B%20%28m13%20-%20m31%29%20%2A%20%28m13%20-%20m31%29%20%2B%20%28m21%20-%20m12%29%20%2A%20%28m21%20-%20m12%29%29%3B%0A%20%20%20%20if%20%28Math.abs%28s%29%20%3C%201e-3%29%20s%20%3D%201%3B%0A%20%20%20%20this.x%20%3D%20%28m32%20-%20m23%29%20%2F%20s%3B%0A%20%20%20%20this.y%20%3D%20%28m13%20-%20m31%29%20%2F%20s%3B%0A%20%20%20%20this.z%20%3D%20%28m21%20-%20m12%29%20%2F%20s%3B%0A%20%20%20%20this.w%20%3D%20Math.acos%28%28m11%20%2B%20m22%20%2B%20m33%20-%201%29%20%2F%202%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrixPosition%28m2%29%20%7B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B12%5D%3B%0A%20%20%20%20this.y%20%3D%20e%5B13%5D%3B%0A%20%20%20%20this.z%20%3D%20e%5B14%5D%3B%0A%20%20%20%20this.w%20%3D%20e%5B15%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20min%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.min%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.min%28this.y%2C%20v.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.min%28this.z%2C%20v.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.min%28this.w%2C%20v.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20max%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28this.y%2C%20v.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28this.z%2C%20v.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.max%28this.w%2C%20v.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clamp%28min2%2C%20max2%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28min2.x%2C%20Math.min%28max2.x%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28min2.y%2C%20Math.min%28max2.y%2C%20this.y%29%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28min2.z%2C%20Math.min%28max2.z%2C%20this.z%29%29%3B%0A%20%20%20%20this.w%20%3D%20Math.max%28min2.w%2C%20Math.min%28max2.w%2C%20this.w%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampScalar%28minVal%2C%20maxVal%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.y%29%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.z%29%29%3B%0A%20%20%20%20this.w%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.w%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampLength%28min2%2C%20max2%29%20%7B%0A%20%20%20%20const%20length2%20%3D%20this.length%28%29%3B%0A%20%20%20%20return%20this.divideScalar%28length2%20%7C%7C%201%29.multiplyScalar%28Math.max%28min2%2C%20Math.min%28max2%2C%20length2%29%29%29%3B%0A%20%20%7D%0A%20%20floor%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.floor%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.floor%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.floor%28this.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.floor%28this.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20ceil%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.ceil%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.ceil%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.ceil%28this.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.ceil%28this.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20round%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.round%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.round%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.round%28this.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.round%28this.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20roundToZero%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.trunc%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.trunc%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.trunc%28this.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.trunc%28this.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20negate%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20-this.x%3B%0A%20%20%20%20this.y%20%3D%20-this.y%3B%0A%20%20%20%20this.z%20%3D%20-this.z%3B%0A%20%20%20%20this.w%20%3D%20-this.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dot%28v%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20v.x%20%2B%20this.y%20%2A%20v.y%20%2B%20this.z%20%2A%20v.z%20%2B%20this.w%20%2A%20v.w%3B%0A%20%20%7D%0A%20%20lengthSq%28%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%20%2B%20this.z%20%2A%20this.z%20%2B%20this.w%20%2A%20this.w%3B%0A%20%20%7D%0A%20%20length%28%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%20%2B%20this.z%20%2A%20this.z%20%2B%20this.w%20%2A%20this.w%29%3B%0A%20%20%7D%0A%20%20manhattanLength%28%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%29%20%2B%20Math.abs%28this.y%29%20%2B%20Math.abs%28this.z%29%20%2B%20Math.abs%28this.w%29%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20return%20this.divideScalar%28this.length%28%29%20%7C%7C%201%29%3B%0A%20%20%7D%0A%20%20setLength%28length2%29%20%7B%0A%20%20%20%20return%20this.normalize%28%29.multiplyScalar%28length2%29%3B%0A%20%20%7D%0A%20%20lerp%28v%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20%28v.x%20-%20this.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%2B%3D%20%28v.y%20-%20this.y%29%20%2A%20alpha%3B%0A%20%20%20%20this.z%20%2B%3D%20%28v.z%20-%20this.z%29%20%2A%20alpha%3B%0A%20%20%20%20this.w%20%2B%3D%20%28v.w%20-%20this.w%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpVectors%28v1%2C%20v2%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%3D%20v1.x%20%2B%20%28v2.x%20-%20v1.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%3D%20v1.y%20%2B%20%28v2.y%20-%20v1.y%29%20%2A%20alpha%3B%0A%20%20%20%20this.z%20%3D%20v1.z%20%2B%20%28v2.z%20-%20v1.z%29%20%2A%20alpha%3B%0A%20%20%20%20this.w%20%3D%20v1.w%20%2B%20%28v2.w%20-%20v1.w%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28v%29%20%7B%0A%20%20%20%20return%20v.x%20%3D%3D%3D%20this.x%20%26%26%20v.y%20%3D%3D%3D%20this.y%20%26%26%20v.z%20%3D%3D%3D%20this.z%20%26%26%20v.w%20%3D%3D%3D%20this.w%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.x%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this.y%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20this.z%20%3D%20array%5Boffset%20%2B%202%5D%3B%0A%20%20%20%20this.w%20%3D%20array%5Boffset%20%2B%203%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this.x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this.y%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this.z%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20this.w%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this.x%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this.y%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20this.z%20%3D%20attribute2.getZ%28index5%29%3B%0A%20%20%20%20this.w%20%3D%20attribute2.getW%28index5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20random%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.y%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.z%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.w%20%3D%20Math.random%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this.x%3B%0A%20%20%20%20yield%20this.y%3B%0A%20%20%20%20yield%20this.z%3B%0A%20%20%20%20yield%20this.w%3B%0A%20%20%7D%0A%7D%3B%0Avar%20RenderTarget%20%3D%20class%20extends%20EventDispatcher%20%7B%0A%20%20constructor%28width%20%3D%201%2C%20height%20%3D%201%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isRenderTarget%20%3D%20true%3B%0A%20%20%20%20this.width%20%3D%20width%3B%0A%20%20%20%20this.height%20%3D%20height%3B%0A%20%20%20%20this.depth%20%3D%201%3B%0A%20%20%20%20this.scissor%20%3D%20new%20Vector4%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20this.scissorTest%20%3D%20false%3B%0A%20%20%20%20this.viewport%20%3D%20new%20Vector4%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20const%20image%20%3D%20%7B%20width%2C%20height%2C%20depth%3A%201%20%7D%3B%0A%20%20%20%20options%20%3D%20Object.assign%28%7B%0A%20%20%20%20%20%20generateMipmaps%3A%20false%2C%0A%20%20%20%20%20%20internalFormat%3A%20null%2C%0A%20%20%20%20%20%20minFilter%3A%20LinearFilter%2C%0A%20%20%20%20%20%20depthBuffer%3A%20true%2C%0A%20%20%20%20%20%20stencilBuffer%3A%20false%2C%0A%20%20%20%20%20%20resolveDepthBuffer%3A%20true%2C%0A%20%20%20%20%20%20resolveStencilBuffer%3A%20true%2C%0A%20%20%20%20%20%20depthTexture%3A%20null%2C%0A%20%20%20%20%20%20samples%3A%200%2C%0A%20%20%20%20%20%20count%3A%201%0A%20%20%20%20%7D%2C%20options%29%3B%0A%20%20%20%20const%20texture2%20%3D%20new%20Texture%28image%2C%20options.mapping%2C%20options.wrapS%2C%20options.wrapT%2C%20options.magFilter%2C%20options.minFilter%2C%20options.format%2C%20options.type%2C%20options.anisotropy%2C%20options.colorSpace%29%3B%0A%20%20%20%20texture2.flipY%20%3D%20false%3B%0A%20%20%20%20texture2.generateMipmaps%20%3D%20options.generateMipmaps%3B%0A%20%20%20%20texture2.internalFormat%20%3D%20options.internalFormat%3B%0A%20%20%20%20this.textures%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20count%20%3D%20options.count%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20count%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.textures%5Bi%5D%20%3D%20texture2.clone%28%29%3B%0A%20%20%20%20%20%20this.textures%5Bi%5D.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.depthBuffer%20%3D%20options.depthBuffer%3B%0A%20%20%20%20this.stencilBuffer%20%3D%20options.stencilBuffer%3B%0A%20%20%20%20this.resolveDepthBuffer%20%3D%20options.resolveDepthBuffer%3B%0A%20%20%20%20this.resolveStencilBuffer%20%3D%20options.resolveStencilBuffer%3B%0A%20%20%20%20this.depthTexture%20%3D%20options.depthTexture%3B%0A%20%20%20%20this.samples%20%3D%20options.samples%3B%0A%20%20%7D%0A%20%20get%20texture%28%29%20%7B%0A%20%20%20%20return%20this.textures%5B0%5D%3B%0A%20%20%7D%0A%20%20set%20texture%28value%29%20%7B%0A%20%20%20%20this.textures%5B0%5D%20%3D%20value%3B%0A%20%20%7D%0A%20%20setSize%28width%2C%20height%2C%20depth2%20%3D%201%29%20%7B%0A%20%20%20%20if%20%28this.width%20%21%3D%3D%20width%20%7C%7C%20this.height%20%21%3D%3D%20height%20%7C%7C%20this.depth%20%21%3D%3D%20depth2%29%20%7B%0A%20%20%20%20%20%20this.width%20%3D%20width%3B%0A%20%20%20%20%20%20this.height%20%3D%20height%3B%0A%20%20%20%20%20%20this.depth%20%3D%20depth2%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20this.textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this.textures%5Bi%5D.image.width%20%3D%20width%3B%0A%20%20%20%20%20%20%20%20this.textures%5Bi%5D.image.height%20%3D%20height%3B%0A%20%20%20%20%20%20%20%20this.textures%5Bi%5D.image.depth%20%3D%20depth2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.viewport.set%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20this.scissor.set%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.width%20%3D%20source.width%3B%0A%20%20%20%20this.height%20%3D%20source.height%3B%0A%20%20%20%20this.depth%20%3D%20source.depth%3B%0A%20%20%20%20this.scissor.copy%28source.scissor%29%3B%0A%20%20%20%20this.scissorTest%20%3D%20source.scissorTest%3B%0A%20%20%20%20this.viewport.copy%28source.viewport%29%3B%0A%20%20%20%20this.textures.length%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20source.textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.textures%5Bi%5D%20%3D%20source.textures%5Bi%5D.clone%28%29%3B%0A%20%20%20%20%20%20this.textures%5Bi%5D.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20image%20%3D%20Object.assign%28%7B%7D%2C%20source.texture.image%29%3B%0A%20%20%20%20this.texture.source%20%3D%20new%20Source%28image%29%3B%0A%20%20%20%20this.depthBuffer%20%3D%20source.depthBuffer%3B%0A%20%20%20%20this.stencilBuffer%20%3D%20source.stencilBuffer%3B%0A%20%20%20%20this.resolveDepthBuffer%20%3D%20source.resolveDepthBuffer%3B%0A%20%20%20%20this.resolveStencilBuffer%20%3D%20source.resolveStencilBuffer%3B%0A%20%20%20%20if%20%28source.depthTexture%20%21%3D%3D%20null%29%20this.depthTexture%20%3D%20source.depthTexture.clone%28%29%3B%0A%20%20%20%20this.samples%20%3D%20source.samples%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGLRenderTarget%20%3D%20class%20extends%20RenderTarget%20%7B%0A%20%20constructor%28width%20%3D%201%2C%20height%20%3D%201%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28width%2C%20height%2C%20options%29%3B%0A%20%20%20%20this.isWebGLRenderTarget%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DataArrayTexture%20%3D%20class%20extends%20Texture%20%7B%0A%20%20constructor%28data%20%3D%20null%2C%20width%20%3D%201%2C%20height%20%3D%201%2C%20depth2%20%3D%201%29%20%7B%0A%20%20%20%20super%28null%29%3B%0A%20%20%20%20this.isDataArrayTexture%20%3D%20true%3B%0A%20%20%20%20this.image%20%3D%20%7B%20data%2C%20width%2C%20height%2C%20depth%3A%20depth2%20%7D%3B%0A%20%20%20%20this.magFilter%20%3D%20NearestFilter%3B%0A%20%20%20%20this.minFilter%20%3D%20NearestFilter%3B%0A%20%20%20%20this.wrapR%20%3D%20ClampToEdgeWrapping%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20this.flipY%20%3D%20false%3B%0A%20%20%20%20this.unpackAlignment%20%3D%201%3B%0A%20%20%20%20this.layerUpdates%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%29%3B%0A%20%20%7D%0A%20%20addLayerUpdate%28layerIndex%29%20%7B%0A%20%20%20%20this.layerUpdates.add%28layerIndex%29%3B%0A%20%20%7D%0A%20%20clearLayerUpdates%28%29%20%7B%0A%20%20%20%20this.layerUpdates.clear%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Data3DTexture%20%3D%20class%20extends%20Texture%20%7B%0A%20%20constructor%28data%20%3D%20null%2C%20width%20%3D%201%2C%20height%20%3D%201%2C%20depth2%20%3D%201%29%20%7B%0A%20%20%20%20super%28null%29%3B%0A%20%20%20%20this.isData3DTexture%20%3D%20true%3B%0A%20%20%20%20this.image%20%3D%20%7B%20data%2C%20width%2C%20height%2C%20depth%3A%20depth2%20%7D%3B%0A%20%20%20%20this.magFilter%20%3D%20NearestFilter%3B%0A%20%20%20%20this.minFilter%20%3D%20NearestFilter%3B%0A%20%20%20%20this.wrapR%20%3D%20ClampToEdgeWrapping%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20this.flipY%20%3D%20false%3B%0A%20%20%20%20this.unpackAlignment%20%3D%201%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Quaternion%20%3D%20class%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%2C%20z2%20%3D%200%2C%20w%20%3D%201%29%20%7B%0A%20%20%20%20this.isQuaternion%20%3D%20true%3B%0A%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20this._w%20%3D%20w%3B%0A%20%20%7D%0A%20%20static%20slerpFlat%28dst%2C%20dstOffset%2C%20src0%2C%20srcOffset0%2C%20src1%2C%20srcOffset1%2C%20t%29%20%7B%0A%20%20%20%20let%20x0%20%3D%20src0%5BsrcOffset0%20%2B%200%5D%2C%20y0%20%3D%20src0%5BsrcOffset0%20%2B%201%5D%2C%20z0%20%3D%20src0%5BsrcOffset0%20%2B%202%5D%2C%20w02%20%3D%20src0%5BsrcOffset0%20%2B%203%5D%3B%0A%20%20%20%20const%20x1%20%3D%20src1%5BsrcOffset1%20%2B%200%5D%2C%20y1%20%3D%20src1%5BsrcOffset1%20%2B%201%5D%2C%20z1%20%3D%20src1%5BsrcOffset1%20%2B%202%5D%2C%20w12%20%3D%20src1%5BsrcOffset1%20%2B%203%5D%3B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%200%5D%20%3D%20x0%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%201%5D%20%3D%20y0%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%202%5D%20%3D%20z0%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%203%5D%20%3D%20w02%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28t%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%200%5D%20%3D%20x1%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%201%5D%20%3D%20y1%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%202%5D%20%3D%20z1%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%203%5D%20%3D%20w12%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28w02%20%21%3D%3D%20w12%20%7C%7C%20x0%20%21%3D%3D%20x1%20%7C%7C%20y0%20%21%3D%3D%20y1%20%7C%7C%20z0%20%21%3D%3D%20z1%29%20%7B%0A%20%20%20%20%20%20let%20s%20%3D%201%20-%20t%3B%0A%20%20%20%20%20%20const%20cos2%20%3D%20x0%20%2A%20x1%20%2B%20y0%20%2A%20y1%20%2B%20z0%20%2A%20z1%20%2B%20w02%20%2A%20w12%2C%20dir%20%3D%20cos2%20%3E%3D%200%20%3F%201%20%3A%20-1%2C%20sqrSin%20%3D%201%20-%20cos2%20%2A%20cos2%3B%0A%20%20%20%20%20%20if%20%28sqrSin%20%3E%20Number.EPSILON%29%20%7B%0A%20%20%20%20%20%20%20%20const%20sin2%20%3D%20Math.sqrt%28sqrSin%29%2C%20len%20%3D%20Math.atan2%28sin2%2C%20cos2%20%2A%20dir%29%3B%0A%20%20%20%20%20%20%20%20s%20%3D%20Math.sin%28s%20%2A%20len%29%20%2F%20sin2%3B%0A%20%20%20%20%20%20%20%20t%20%3D%20Math.sin%28t%20%2A%20len%29%20%2F%20sin2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20tDir%20%3D%20t%20%2A%20dir%3B%0A%20%20%20%20%20%20x0%20%3D%20x0%20%2A%20s%20%2B%20x1%20%2A%20tDir%3B%0A%20%20%20%20%20%20y0%20%3D%20y0%20%2A%20s%20%2B%20y1%20%2A%20tDir%3B%0A%20%20%20%20%20%20z0%20%3D%20z0%20%2A%20s%20%2B%20z1%20%2A%20tDir%3B%0A%20%20%20%20%20%20w02%20%3D%20w02%20%2A%20s%20%2B%20w12%20%2A%20tDir%3B%0A%20%20%20%20%20%20if%20%28s%20%3D%3D%3D%201%20-%20t%29%20%7B%0A%20%20%20%20%20%20%20%20const%20f%20%3D%201%20%2F%20Math.sqrt%28x0%20%2A%20x0%20%2B%20y0%20%2A%20y0%20%2B%20z0%20%2A%20z0%20%2B%20w02%20%2A%20w02%29%3B%0A%20%20%20%20%20%20%20%20x0%20%2A%3D%20f%3B%0A%20%20%20%20%20%20%20%20y0%20%2A%3D%20f%3B%0A%20%20%20%20%20%20%20%20z0%20%2A%3D%20f%3B%0A%20%20%20%20%20%20%20%20w02%20%2A%3D%20f%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20dst%5BdstOffset%5D%20%3D%20x0%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%201%5D%20%3D%20y0%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%202%5D%20%3D%20z0%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%203%5D%20%3D%20w02%3B%0A%20%20%7D%0A%20%20static%20multiplyQuaternionsFlat%28dst%2C%20dstOffset%2C%20src0%2C%20srcOffset0%2C%20src1%2C%20srcOffset1%29%20%7B%0A%20%20%20%20const%20x0%20%3D%20src0%5BsrcOffset0%5D%3B%0A%20%20%20%20const%20y0%20%3D%20src0%5BsrcOffset0%20%2B%201%5D%3B%0A%20%20%20%20const%20z0%20%3D%20src0%5BsrcOffset0%20%2B%202%5D%3B%0A%20%20%20%20const%20w02%20%3D%20src0%5BsrcOffset0%20%2B%203%5D%3B%0A%20%20%20%20const%20x1%20%3D%20src1%5BsrcOffset1%5D%3B%0A%20%20%20%20const%20y1%20%3D%20src1%5BsrcOffset1%20%2B%201%5D%3B%0A%20%20%20%20const%20z1%20%3D%20src1%5BsrcOffset1%20%2B%202%5D%3B%0A%20%20%20%20const%20w12%20%3D%20src1%5BsrcOffset1%20%2B%203%5D%3B%0A%20%20%20%20dst%5BdstOffset%5D%20%3D%20x0%20%2A%20w12%20%2B%20w02%20%2A%20x1%20%2B%20y0%20%2A%20z1%20-%20z0%20%2A%20y1%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%201%5D%20%3D%20y0%20%2A%20w12%20%2B%20w02%20%2A%20y1%20%2B%20z0%20%2A%20x1%20-%20x0%20%2A%20z1%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%202%5D%20%3D%20z0%20%2A%20w12%20%2B%20w02%20%2A%20z1%20%2B%20x0%20%2A%20y1%20-%20y0%20%2A%20x1%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%203%5D%20%3D%20w02%20%2A%20w12%20-%20x0%20%2A%20x1%20-%20y0%20%2A%20y1%20-%20z0%20%2A%20z1%3B%0A%20%20%20%20return%20dst%3B%0A%20%20%7D%0A%20%20get%20x%28%29%20%7B%0A%20%20%20%20return%20this._x%3B%0A%20%20%7D%0A%20%20set%20x%28value%29%20%7B%0A%20%20%20%20this._x%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20y%28%29%20%7B%0A%20%20%20%20return%20this._y%3B%0A%20%20%7D%0A%20%20set%20y%28value%29%20%7B%0A%20%20%20%20this._y%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20z%28%29%20%7B%0A%20%20%20%20return%20this._z%3B%0A%20%20%7D%0A%20%20set%20z%28value%29%20%7B%0A%20%20%20%20this._z%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20w%28%29%20%7B%0A%20%20%20%20return%20this._w%3B%0A%20%20%7D%0A%20%20set%20w%28value%29%20%7B%0A%20%20%20%20this._w%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20this._w%20%3D%20w%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this._x%2C%20this._y%2C%20this._z%2C%20this._w%29%3B%0A%20%20%7D%0A%20%20copy%28quaternion%29%20%7B%0A%20%20%20%20this._x%20%3D%20quaternion.x%3B%0A%20%20%20%20this._y%20%3D%20quaternion.y%3B%0A%20%20%20%20this._z%20%3D%20quaternion.z%3B%0A%20%20%20%20this._w%20%3D%20quaternion.w%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromEuler%28euler%2C%20update4%20%3D%20true%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20euler._x%2C%20y2%20%3D%20euler._y%2C%20z2%20%3D%20euler._z%2C%20order%20%3D%20euler._order%3B%0A%20%20%20%20const%20cos2%20%3D%20Math.cos%3B%0A%20%20%20%20const%20sin2%20%3D%20Math.sin%3B%0A%20%20%20%20const%20c1%20%3D%20cos2%28x2%20%2F%202%29%3B%0A%20%20%20%20const%20c2%20%3D%20cos2%28y2%20%2F%202%29%3B%0A%20%20%20%20const%20c3%20%3D%20cos2%28z2%20%2F%202%29%3B%0A%20%20%20%20const%20s1%20%3D%20sin2%28x2%20%2F%202%29%3B%0A%20%20%20%20const%20s2%20%3D%20sin2%28y2%20%2F%202%29%3B%0A%20%20%20%20const%20s3%20%3D%20sin2%28z2%20%2F%202%29%3B%0A%20%20%20%20switch%20%28order%29%20%7B%0A%20%20%20%20%20%20case%20%22XYZ%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20%2B%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20-%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20%2B%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20-%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22YXZ%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20%2B%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20-%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20-%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20%2B%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22ZXY%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20-%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20%2B%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20%2B%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20-%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22ZYX%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20-%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20%2B%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20-%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20%2B%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22YZX%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20%2B%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20%2B%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20-%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20-%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22XZY%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20-%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20-%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20%2B%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20%2B%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.Quaternion%3A%20.setFromEuler%28%29%20encountered%20an%20unknown%20order%3A%20%22%20%2B%20order%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28update4%20%3D%3D%3D%20true%29%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromAxisAngle%28axis%2C%20angle%29%20%7B%0A%20%20%20%20const%20halfAngle%20%3D%20angle%20%2F%202%2C%20s%20%3D%20Math.sin%28halfAngle%29%3B%0A%20%20%20%20this._x%20%3D%20axis.x%20%2A%20s%3B%0A%20%20%20%20this._y%20%3D%20axis.y%20%2A%20s%3B%0A%20%20%20%20this._z%20%3D%20axis.z%20%2A%20s%3B%0A%20%20%20%20this._w%20%3D%20Math.cos%28halfAngle%29%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromRotationMatrix%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20m2.elements%2C%20m11%20%3D%20te%5B0%5D%2C%20m12%20%3D%20te%5B4%5D%2C%20m13%20%3D%20te%5B8%5D%2C%20m21%20%3D%20te%5B1%5D%2C%20m22%20%3D%20te%5B5%5D%2C%20m23%20%3D%20te%5B9%5D%2C%20m31%20%3D%20te%5B2%5D%2C%20m32%20%3D%20te%5B6%5D%2C%20m33%20%3D%20te%5B10%5D%2C%20trace%20%3D%20m11%20%2B%20m22%20%2B%20m33%3B%0A%20%20%20%20if%20%28trace%20%3E%200%29%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%200.5%20%2F%20Math.sqrt%28trace%20%2B%201%29%3B%0A%20%20%20%20%20%20this._w%20%3D%200.25%20%2F%20s%3B%0A%20%20%20%20%20%20this._x%20%3D%20%28m32%20-%20m23%29%20%2A%20s%3B%0A%20%20%20%20%20%20this._y%20%3D%20%28m13%20-%20m31%29%20%2A%20s%3B%0A%20%20%20%20%20%20this._z%20%3D%20%28m21%20-%20m12%29%20%2A%20s%3B%0A%20%20%20%20%7D%20else%20if%20%28m11%20%3E%20m22%20%26%26%20m11%20%3E%20m33%29%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%202%20%2A%20Math.sqrt%281%20%2B%20m11%20-%20m22%20-%20m33%29%3B%0A%20%20%20%20%20%20this._w%20%3D%20%28m32%20-%20m23%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._x%20%3D%200.25%20%2A%20s%3B%0A%20%20%20%20%20%20this._y%20%3D%20%28m12%20%2B%20m21%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._z%20%3D%20%28m13%20%2B%20m31%29%20%2F%20s%3B%0A%20%20%20%20%7D%20else%20if%20%28m22%20%3E%20m33%29%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%202%20%2A%20Math.sqrt%281%20%2B%20m22%20-%20m11%20-%20m33%29%3B%0A%20%20%20%20%20%20this._w%20%3D%20%28m13%20-%20m31%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._x%20%3D%20%28m12%20%2B%20m21%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._y%20%3D%200.25%20%2A%20s%3B%0A%20%20%20%20%20%20this._z%20%3D%20%28m23%20%2B%20m32%29%20%2F%20s%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%202%20%2A%20Math.sqrt%281%20%2B%20m33%20-%20m11%20-%20m22%29%3B%0A%20%20%20%20%20%20this._w%20%3D%20%28m21%20-%20m12%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._x%20%3D%20%28m13%20%2B%20m31%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._y%20%3D%20%28m23%20%2B%20m32%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._z%20%3D%200.25%20%2A%20s%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromUnitVectors%28vFrom%2C%20vTo%29%20%7B%0A%20%20%20%20let%20r%20%3D%20vFrom.dot%28vTo%29%20%2B%201%3B%0A%20%20%20%20if%20%28r%20%3C%20Number.EPSILON%29%20%7B%0A%20%20%20%20%20%20r%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28Math.abs%28vFrom.x%29%20%3E%20Math.abs%28vFrom.z%29%29%20%7B%0A%20%20%20%20%20%20%20%20this._x%20%3D%20-vFrom.y%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20vFrom.x%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%200%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20r%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this._x%20%3D%200%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20-vFrom.z%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20vFrom.y%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20r%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._x%20%3D%20vFrom.y%20%2A%20vTo.z%20-%20vFrom.z%20%2A%20vTo.y%3B%0A%20%20%20%20%20%20this._y%20%3D%20vFrom.z%20%2A%20vTo.x%20-%20vFrom.x%20%2A%20vTo.z%3B%0A%20%20%20%20%20%20this._z%20%3D%20vFrom.x%20%2A%20vTo.y%20-%20vFrom.y%20%2A%20vTo.x%3B%0A%20%20%20%20%20%20this._w%20%3D%20r%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.normalize%28%29%3B%0A%20%20%7D%0A%20%20angleTo%28q%29%20%7B%0A%20%20%20%20return%202%20%2A%20Math.acos%28Math.abs%28clamp%28this.dot%28q%29%2C%20-1%2C%201%29%29%29%3B%0A%20%20%7D%0A%20%20rotateTowards%28q%2C%20step2%29%20%7B%0A%20%20%20%20const%20angle%20%3D%20this.angleTo%28q%29%3B%0A%20%20%20%20if%20%28angle%20%3D%3D%3D%200%29%20return%20this%3B%0A%20%20%20%20const%20t%20%3D%20Math.min%281%2C%20step2%20%2F%20angle%29%3B%0A%20%20%20%20this.slerp%28q%2C%20t%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20identity%28%29%20%7B%0A%20%20%20%20return%20this.set%280%2C%200%2C%200%2C%201%29%3B%0A%20%20%7D%0A%20%20invert%28%29%20%7B%0A%20%20%20%20return%20this.conjugate%28%29%3B%0A%20%20%7D%0A%20%20conjugate%28%29%20%7B%0A%20%20%20%20this._x%20%2A%3D%20-1%3B%0A%20%20%20%20this._y%20%2A%3D%20-1%3B%0A%20%20%20%20this._z%20%2A%3D%20-1%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dot%28v%29%20%7B%0A%20%20%20%20return%20this._x%20%2A%20v._x%20%2B%20this._y%20%2A%20v._y%20%2B%20this._z%20%2A%20v._z%20%2B%20this._w%20%2A%20v._w%3B%0A%20%20%7D%0A%20%20lengthSq%28%29%20%7B%0A%20%20%20%20return%20this._x%20%2A%20this._x%20%2B%20this._y%20%2A%20this._y%20%2B%20this._z%20%2A%20this._z%20%2B%20this._w%20%2A%20this._w%3B%0A%20%20%7D%0A%20%20length%28%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this._x%20%2A%20this._x%20%2B%20this._y%20%2A%20this._y%20%2B%20this._z%20%2A%20this._z%20%2B%20this._w%20%2A%20this._w%29%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20let%20l%20%3D%20this.length%28%29%3B%0A%20%20%20%20if%20%28l%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20this._x%20%3D%200%3B%0A%20%20%20%20%20%20this._y%20%3D%200%3B%0A%20%20%20%20%20%20this._z%20%3D%200%3B%0A%20%20%20%20%20%20this._w%20%3D%201%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20l%20%3D%201%20%2F%20l%3B%0A%20%20%20%20%20%20this._x%20%3D%20this._x%20%2A%20l%3B%0A%20%20%20%20%20%20this._y%20%3D%20this._y%20%2A%20l%3B%0A%20%20%20%20%20%20this._z%20%3D%20this._z%20%2A%20l%3B%0A%20%20%20%20%20%20this._w%20%3D%20this._w%20%2A%20l%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28q%29%20%7B%0A%20%20%20%20return%20this.multiplyQuaternions%28this%2C%20q%29%3B%0A%20%20%7D%0A%20%20premultiply%28q%29%20%7B%0A%20%20%20%20return%20this.multiplyQuaternions%28q%2C%20this%29%3B%0A%20%20%7D%0A%20%20multiplyQuaternions%28a2%2C%20b%29%20%7B%0A%20%20%20%20const%20qax%20%3D%20a2._x%2C%20qay%20%3D%20a2._y%2C%20qaz%20%3D%20a2._z%2C%20qaw%20%3D%20a2._w%3B%0A%20%20%20%20const%20qbx%20%3D%20b._x%2C%20qby%20%3D%20b._y%2C%20qbz%20%3D%20b._z%2C%20qbw%20%3D%20b._w%3B%0A%20%20%20%20this._x%20%3D%20qax%20%2A%20qbw%20%2B%20qaw%20%2A%20qbx%20%2B%20qay%20%2A%20qbz%20-%20qaz%20%2A%20qby%3B%0A%20%20%20%20this._y%20%3D%20qay%20%2A%20qbw%20%2B%20qaw%20%2A%20qby%20%2B%20qaz%20%2A%20qbx%20-%20qax%20%2A%20qbz%3B%0A%20%20%20%20this._z%20%3D%20qaz%20%2A%20qbw%20%2B%20qaw%20%2A%20qbz%20%2B%20qax%20%2A%20qby%20-%20qay%20%2A%20qbx%3B%0A%20%20%20%20this._w%20%3D%20qaw%20%2A%20qbw%20-%20qax%20%2A%20qbx%20-%20qay%20%2A%20qby%20-%20qaz%20%2A%20qbz%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20slerp%28qb%2C%20t%29%20%7B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%200%29%20return%20this%3B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%201%29%20return%20this.copy%28qb%29%3B%0A%20%20%20%20const%20x2%20%3D%20this._x%2C%20y2%20%3D%20this._y%2C%20z2%20%3D%20this._z%2C%20w%20%3D%20this._w%3B%0A%20%20%20%20let%20cosHalfTheta%20%3D%20w%20%2A%20qb._w%20%2B%20x2%20%2A%20qb._x%20%2B%20y2%20%2A%20qb._y%20%2B%20z2%20%2A%20qb._z%3B%0A%20%20%20%20if%20%28cosHalfTheta%20%3C%200%29%20%7B%0A%20%20%20%20%20%20this._w%20%3D%20-qb._w%3B%0A%20%20%20%20%20%20this._x%20%3D%20-qb._x%3B%0A%20%20%20%20%20%20this._y%20%3D%20-qb._y%3B%0A%20%20%20%20%20%20this._z%20%3D%20-qb._z%3B%0A%20%20%20%20%20%20cosHalfTheta%20%3D%20-cosHalfTheta%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.copy%28qb%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28cosHalfTheta%20%3E%3D%201%29%20%7B%0A%20%20%20%20%20%20this._w%20%3D%20w%3B%0A%20%20%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20sqrSinHalfTheta%20%3D%201%20-%20cosHalfTheta%20%2A%20cosHalfTheta%3B%0A%20%20%20%20if%20%28sqrSinHalfTheta%20%3C%3D%20Number.EPSILON%29%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%201%20-%20t%3B%0A%20%20%20%20%20%20this._w%20%3D%20s%20%2A%20w%20%2B%20t%20%2A%20this._w%3B%0A%20%20%20%20%20%20this._x%20%3D%20s%20%2A%20x2%20%2B%20t%20%2A%20this._x%3B%0A%20%20%20%20%20%20this._y%20%3D%20s%20%2A%20y2%20%2B%20t%20%2A%20this._y%3B%0A%20%20%20%20%20%20this._z%20%3D%20s%20%2A%20z2%20%2B%20t%20%2A%20this._z%3B%0A%20%20%20%20%20%20this.normalize%28%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20sinHalfTheta%20%3D%20Math.sqrt%28sqrSinHalfTheta%29%3B%0A%20%20%20%20const%20halfTheta%20%3D%20Math.atan2%28sinHalfTheta%2C%20cosHalfTheta%29%3B%0A%20%20%20%20const%20ratioA%20%3D%20Math.sin%28%281%20-%20t%29%20%2A%20halfTheta%29%20%2F%20sinHalfTheta%2C%20ratioB%20%3D%20Math.sin%28t%20%2A%20halfTheta%29%20%2F%20sinHalfTheta%3B%0A%20%20%20%20this._w%20%3D%20w%20%2A%20ratioA%20%2B%20this._w%20%2A%20ratioB%3B%0A%20%20%20%20this._x%20%3D%20x2%20%2A%20ratioA%20%2B%20this._x%20%2A%20ratioB%3B%0A%20%20%20%20this._y%20%3D%20y2%20%2A%20ratioA%20%2B%20this._y%20%2A%20ratioB%3B%0A%20%20%20%20this._z%20%3D%20z2%20%2A%20ratioA%20%2B%20this._z%20%2A%20ratioB%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20slerpQuaternions%28qa%2C%20qb%2C%20t%29%20%7B%0A%20%20%20%20return%20this.copy%28qa%29.slerp%28qb%2C%20t%29%3B%0A%20%20%7D%0A%20%20random%28%29%20%7B%0A%20%20%20%20const%20theta1%20%3D%202%20%2A%20Math.PI%20%2A%20Math.random%28%29%3B%0A%20%20%20%20const%20theta2%20%3D%202%20%2A%20Math.PI%20%2A%20Math.random%28%29%3B%0A%20%20%20%20const%20x0%20%3D%20Math.random%28%29%3B%0A%20%20%20%20const%20r1%20%3D%20Math.sqrt%281%20-%20x0%29%3B%0A%20%20%20%20const%20r2%20%3D%20Math.sqrt%28x0%29%3B%0A%20%20%20%20return%20this.set%28%0A%20%20%20%20%20%20r1%20%2A%20Math.sin%28theta1%29%2C%0A%20%20%20%20%20%20r1%20%2A%20Math.cos%28theta1%29%2C%0A%20%20%20%20%20%20r2%20%2A%20Math.sin%28theta2%29%2C%0A%20%20%20%20%20%20r2%20%2A%20Math.cos%28theta2%29%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20equals%28quaternion%29%20%7B%0A%20%20%20%20return%20quaternion._x%20%3D%3D%3D%20this._x%20%26%26%20quaternion._y%20%3D%3D%3D%20this._y%20%26%26%20quaternion._z%20%3D%3D%3D%20this._z%20%26%26%20quaternion._w%20%3D%3D%3D%20this._w%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this._x%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this._y%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20this._z%20%3D%20array%5Boffset%20%2B%202%5D%3B%0A%20%20%20%20this._w%20%3D%20array%5Boffset%20%2B%203%5D%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this._x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this._y%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this._z%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20this._w%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this._x%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this._y%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20this._z%20%3D%20attribute2.getZ%28index5%29%3B%0A%20%20%20%20this._w%20%3D%20attribute2.getW%28index5%29%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20return%20this.toArray%28%29%3B%0A%20%20%7D%0A%20%20_onChange%28callback%29%20%7B%0A%20%20%20%20this._onChangeCallback%20%3D%20callback%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20_onChangeCallback%28%29%20%7B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this._x%3B%0A%20%20%20%20yield%20this._y%3B%0A%20%20%20%20yield%20this._z%3B%0A%20%20%20%20yield%20this._w%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Vector3%20%3D%20class%20_Vector3%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%2C%20z2%20%3D%200%29%20%7B%0A%20%20%20%20_Vector3.prototype.isVector3%20%3D%20true%3B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28z2%20%3D%3D%3D%20void%200%29%20z2%20%3D%20this.z%3B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%3D%20scalar%3B%0A%20%20%20%20this.y%20%3D%20scalar%3B%0A%20%20%20%20this.z%20%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setX%28x2%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setY%28y2%29%20%7B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setZ%28z2%29%20%7B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setComponent%28index5%2C%20value%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20this.x%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20this.y%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20this.z%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getComponent%28index5%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20return%20this.x%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20return%20this.y%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20return%20this.z%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.x%2C%20this.y%2C%20this.z%29%3B%0A%20%20%7D%0A%20%20copy%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20v.x%3B%0A%20%20%20%20this.y%20%3D%20v.y%3B%0A%20%20%20%20this.z%20%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20add%28v%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%3B%0A%20%20%20%20this.z%20%2B%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScalar%28s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20s%3B%0A%20%20%20%20this.z%20%2B%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20%2B%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20%2B%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20%2B%20b.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScaledVector%28v%2C%20s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%20%2A%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%20%2A%20s%3B%0A%20%20%20%20this.z%20%2B%3D%20v.z%20%2A%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20sub%28v%29%20%7B%0A%20%20%20%20this.x%20-%3D%20v.x%3B%0A%20%20%20%20this.y%20-%3D%20v.y%3B%0A%20%20%20%20this.z%20-%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subScalar%28s%29%20%7B%0A%20%20%20%20this.x%20-%3D%20s%3B%0A%20%20%20%20this.y%20-%3D%20s%3B%0A%20%20%20%20this.z%20-%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20-%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20-%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20-%20b.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28v%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20v.x%3B%0A%20%20%20%20this.y%20%2A%3D%20v.y%3B%0A%20%20%20%20this.z%20%2A%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20scalar%3B%0A%20%20%20%20this.y%20%2A%3D%20scalar%3B%0A%20%20%20%20this.z%20%2A%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20%2A%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20%2A%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20%2A%20b.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyEuler%28euler%29%20%7B%0A%20%20%20%20return%20this.applyQuaternion%28_quaternion%244.setFromEuler%28euler%29%29%3B%0A%20%20%7D%0A%20%20applyAxisAngle%28axis%2C%20angle%29%20%7B%0A%20%20%20%20return%20this.applyQuaternion%28_quaternion%244.setFromAxisAngle%28axis%2C%20angle%29%29%3B%0A%20%20%7D%0A%20%20applyMatrix3%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%2C%20z2%20%3D%20this.z%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B0%5D%20%2A%20x2%20%2B%20e%5B3%5D%20%2A%20y2%20%2B%20e%5B6%5D%20%2A%20z2%3B%0A%20%20%20%20this.y%20%3D%20e%5B1%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B7%5D%20%2A%20z2%3B%0A%20%20%20%20this.z%20%3D%20e%5B2%5D%20%2A%20x2%20%2B%20e%5B5%5D%20%2A%20y2%20%2B%20e%5B8%5D%20%2A%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyNormalMatrix%28m2%29%20%7B%0A%20%20%20%20return%20this.applyMatrix3%28m2%29.normalize%28%29%3B%0A%20%20%7D%0A%20%20applyMatrix4%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%2C%20z2%20%3D%20this.z%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20const%20w%20%3D%201%20%2F%20%28e%5B3%5D%20%2A%20x2%20%2B%20e%5B7%5D%20%2A%20y2%20%2B%20e%5B11%5D%20%2A%20z2%20%2B%20e%5B15%5D%29%3B%0A%20%20%20%20this.x%20%3D%20%28e%5B0%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B8%5D%20%2A%20z2%20%2B%20e%5B12%5D%29%20%2A%20w%3B%0A%20%20%20%20this.y%20%3D%20%28e%5B1%5D%20%2A%20x2%20%2B%20e%5B5%5D%20%2A%20y2%20%2B%20e%5B9%5D%20%2A%20z2%20%2B%20e%5B13%5D%29%20%2A%20w%3B%0A%20%20%20%20this.z%20%3D%20%28e%5B2%5D%20%2A%20x2%20%2B%20e%5B6%5D%20%2A%20y2%20%2B%20e%5B10%5D%20%2A%20z2%20%2B%20e%5B14%5D%29%20%2A%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyQuaternion%28q%29%20%7B%0A%20%20%20%20const%20vx%20%3D%20this.x%2C%20vy%20%3D%20this.y%2C%20vz%20%3D%20this.z%3B%0A%20%20%20%20const%20qx%20%3D%20q.x%2C%20qy%20%3D%20q.y%2C%20qz%20%3D%20q.z%2C%20qw%20%3D%20q.w%3B%0A%20%20%20%20const%20tx%20%3D%202%20%2A%20%28qy%20%2A%20vz%20-%20qz%20%2A%20vy%29%3B%0A%20%20%20%20const%20ty%20%3D%202%20%2A%20%28qz%20%2A%20vx%20-%20qx%20%2A%20vz%29%3B%0A%20%20%20%20const%20tz%20%3D%202%20%2A%20%28qx%20%2A%20vy%20-%20qy%20%2A%20vx%29%3B%0A%20%20%20%20this.x%20%3D%20vx%20%2B%20qw%20%2A%20tx%20%2B%20qy%20%2A%20tz%20-%20qz%20%2A%20ty%3B%0A%20%20%20%20this.y%20%3D%20vy%20%2B%20qw%20%2A%20ty%20%2B%20qz%20%2A%20tx%20-%20qx%20%2A%20tz%3B%0A%20%20%20%20this.z%20%3D%20vz%20%2B%20qw%20%2A%20tz%20%2B%20qx%20%2A%20ty%20-%20qy%20%2A%20tx%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20project%28camera3%29%20%7B%0A%20%20%20%20return%20this.applyMatrix4%28camera3.matrixWorldInverse%29.applyMatrix4%28camera3.projectionMatrix%29%3B%0A%20%20%7D%0A%20%20unproject%28camera3%29%20%7B%0A%20%20%20%20return%20this.applyMatrix4%28camera3.projectionMatrixInverse%29.applyMatrix4%28camera3.matrixWorld%29%3B%0A%20%20%7D%0A%20%20transformDirection%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%2C%20z2%20%3D%20this.z%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B0%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B8%5D%20%2A%20z2%3B%0A%20%20%20%20this.y%20%3D%20e%5B1%5D%20%2A%20x2%20%2B%20e%5B5%5D%20%2A%20y2%20%2B%20e%5B9%5D%20%2A%20z2%3B%0A%20%20%20%20this.z%20%3D%20e%5B2%5D%20%2A%20x2%20%2B%20e%5B6%5D%20%2A%20y2%20%2B%20e%5B10%5D%20%2A%20z2%3B%0A%20%20%20%20return%20this.normalize%28%29%3B%0A%20%20%7D%0A%20%20divide%28v%29%20%7B%0A%20%20%20%20this.x%20%2F%3D%20v.x%3B%0A%20%20%20%20this.y%20%2F%3D%20v.y%3B%0A%20%20%20%20this.z%20%2F%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divideScalar%28scalar%29%20%7B%0A%20%20%20%20return%20this.multiplyScalar%281%20%2F%20scalar%29%3B%0A%20%20%7D%0A%20%20min%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.min%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.min%28this.y%2C%20v.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.min%28this.z%2C%20v.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20max%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28this.y%2C%20v.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28this.z%2C%20v.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clamp%28min2%2C%20max2%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28min2.x%2C%20Math.min%28max2.x%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28min2.y%2C%20Math.min%28max2.y%2C%20this.y%29%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28min2.z%2C%20Math.min%28max2.z%2C%20this.z%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampScalar%28minVal%2C%20maxVal%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.y%29%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.z%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampLength%28min2%2C%20max2%29%20%7B%0A%20%20%20%20const%20length2%20%3D%20this.length%28%29%3B%0A%20%20%20%20return%20this.divideScalar%28length2%20%7C%7C%201%29.multiplyScalar%28Math.max%28min2%2C%20Math.min%28max2%2C%20length2%29%29%29%3B%0A%20%20%7D%0A%20%20floor%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.floor%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.floor%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.floor%28this.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20ceil%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.ceil%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.ceil%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.ceil%28this.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20round%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.round%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.round%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.round%28this.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20roundToZero%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.trunc%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.trunc%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.trunc%28this.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20negate%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20-this.x%3B%0A%20%20%20%20this.y%20%3D%20-this.y%3B%0A%20%20%20%20this.z%20%3D%20-this.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dot%28v%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20v.x%20%2B%20this.y%20%2A%20v.y%20%2B%20this.z%20%2A%20v.z%3B%0A%20%20%7D%0A%20%20%2F%2F%20TODO%20lengthSquared%3F%0A%20%20lengthSq%28%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%20%2B%20this.z%20%2A%20this.z%3B%0A%20%20%7D%0A%20%20length%28%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%20%2B%20this.z%20%2A%20this.z%29%3B%0A%20%20%7D%0A%20%20manhattanLength%28%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%29%20%2B%20Math.abs%28this.y%29%20%2B%20Math.abs%28this.z%29%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20return%20this.divideScalar%28this.length%28%29%20%7C%7C%201%29%3B%0A%20%20%7D%0A%20%20setLength%28length2%29%20%7B%0A%20%20%20%20return%20this.normalize%28%29.multiplyScalar%28length2%29%3B%0A%20%20%7D%0A%20%20lerp%28v%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20%28v.x%20-%20this.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%2B%3D%20%28v.y%20-%20this.y%29%20%2A%20alpha%3B%0A%20%20%20%20this.z%20%2B%3D%20%28v.z%20-%20this.z%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpVectors%28v1%2C%20v2%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%3D%20v1.x%20%2B%20%28v2.x%20-%20v1.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%3D%20v1.y%20%2B%20%28v2.y%20-%20v1.y%29%20%2A%20alpha%3B%0A%20%20%20%20this.z%20%3D%20v1.z%20%2B%20%28v2.z%20-%20v1.z%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20cross%28v%29%20%7B%0A%20%20%20%20return%20this.crossVectors%28this%2C%20v%29%3B%0A%20%20%7D%0A%20%20crossVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20const%20ax%20%3D%20a2.x%2C%20ay%20%3D%20a2.y%2C%20az%20%3D%20a2.z%3B%0A%20%20%20%20const%20bx%20%3D%20b.x%2C%20by%20%3D%20b.y%2C%20bz%20%3D%20b.z%3B%0A%20%20%20%20this.x%20%3D%20ay%20%2A%20bz%20-%20az%20%2A%20by%3B%0A%20%20%20%20this.y%20%3D%20az%20%2A%20bx%20-%20ax%20%2A%20bz%3B%0A%20%20%20%20this.z%20%3D%20ax%20%2A%20by%20-%20ay%20%2A%20bx%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20projectOnVector%28v%29%20%7B%0A%20%20%20%20const%20denominator%20%3D%20v.lengthSq%28%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20return%20this.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20const%20scalar%20%3D%20v.dot%28this%29%20%2F%20denominator%3B%0A%20%20%20%20return%20this.copy%28v%29.multiplyScalar%28scalar%29%3B%0A%20%20%7D%0A%20%20projectOnPlane%28planeNormal%29%20%7B%0A%20%20%20%20_vector%24c.copy%28this%29.projectOnVector%28planeNormal%29%3B%0A%20%20%20%20return%20this.sub%28_vector%24c%29%3B%0A%20%20%7D%0A%20%20reflect%28normal2%29%20%7B%0A%20%20%20%20return%20this.sub%28_vector%24c.copy%28normal2%29.multiplyScalar%282%20%2A%20this.dot%28normal2%29%29%29%3B%0A%20%20%7D%0A%20%20angleTo%28v%29%20%7B%0A%20%20%20%20const%20denominator%20%3D%20Math.sqrt%28this.lengthSq%28%29%20%2A%20v.lengthSq%28%29%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20return%20Math.PI%20%2F%202%3B%0A%20%20%20%20const%20theta%20%3D%20this.dot%28v%29%20%2F%20denominator%3B%0A%20%20%20%20return%20Math.acos%28clamp%28theta%2C%20-1%2C%201%29%29%3B%0A%20%20%7D%0A%20%20distanceTo%28v%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.distanceToSquared%28v%29%29%3B%0A%20%20%7D%0A%20%20distanceToSquared%28v%29%20%7B%0A%20%20%20%20const%20dx%20%3D%20this.x%20-%20v.x%2C%20dy%20%3D%20this.y%20-%20v.y%2C%20dz%20%3D%20this.z%20-%20v.z%3B%0A%20%20%20%20return%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%20%2B%20dz%20%2A%20dz%3B%0A%20%20%7D%0A%20%20manhattanDistanceTo%28v%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%20-%20v.x%29%20%2B%20Math.abs%28this.y%20-%20v.y%29%20%2B%20Math.abs%28this.z%20-%20v.z%29%3B%0A%20%20%7D%0A%20%20setFromSpherical%28s%29%20%7B%0A%20%20%20%20return%20this.setFromSphericalCoords%28s.radius%2C%20s.phi%2C%20s.theta%29%3B%0A%20%20%7D%0A%20%20setFromSphericalCoords%28radius%2C%20phi%2C%20theta%29%20%7B%0A%20%20%20%20const%20sinPhiRadius%20%3D%20Math.sin%28phi%29%20%2A%20radius%3B%0A%20%20%20%20this.x%20%3D%20sinPhiRadius%20%2A%20Math.sin%28theta%29%3B%0A%20%20%20%20this.y%20%3D%20Math.cos%28phi%29%20%2A%20radius%3B%0A%20%20%20%20this.z%20%3D%20sinPhiRadius%20%2A%20Math.cos%28theta%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromCylindrical%28c2%29%20%7B%0A%20%20%20%20return%20this.setFromCylindricalCoords%28c2.radius%2C%20c2.theta%2C%20c2.y%29%3B%0A%20%20%7D%0A%20%20setFromCylindricalCoords%28radius%2C%20theta%2C%20y2%29%20%7B%0A%20%20%20%20this.x%20%3D%20radius%20%2A%20Math.sin%28theta%29%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20radius%20%2A%20Math.cos%28theta%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrixPosition%28m2%29%20%7B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B12%5D%3B%0A%20%20%20%20this.y%20%3D%20e%5B13%5D%3B%0A%20%20%20%20this.z%20%3D%20e%5B14%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrixScale%28m2%29%20%7B%0A%20%20%20%20const%20sx%20%3D%20this.setFromMatrixColumn%28m2%2C%200%29.length%28%29%3B%0A%20%20%20%20const%20sy%20%3D%20this.setFromMatrixColumn%28m2%2C%201%29.length%28%29%3B%0A%20%20%20%20const%20sz%20%3D%20this.setFromMatrixColumn%28m2%2C%202%29.length%28%29%3B%0A%20%20%20%20this.x%20%3D%20sx%3B%0A%20%20%20%20this.y%20%3D%20sy%3B%0A%20%20%20%20this.z%20%3D%20sz%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrixColumn%28m2%2C%20index5%29%20%7B%0A%20%20%20%20return%20this.fromArray%28m2.elements%2C%20index5%20%2A%204%29%3B%0A%20%20%7D%0A%20%20setFromMatrix3Column%28m2%2C%20index5%29%20%7B%0A%20%20%20%20return%20this.fromArray%28m2.elements%2C%20index5%20%2A%203%29%3B%0A%20%20%7D%0A%20%20setFromEuler%28e%29%20%7B%0A%20%20%20%20this.x%20%3D%20e._x%3B%0A%20%20%20%20this.y%20%3D%20e._y%3B%0A%20%20%20%20this.z%20%3D%20e._z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromColor%28c2%29%20%7B%0A%20%20%20%20this.x%20%3D%20c2.r%3B%0A%20%20%20%20this.y%20%3D%20c2.g%3B%0A%20%20%20%20this.z%20%3D%20c2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28v%29%20%7B%0A%20%20%20%20return%20v.x%20%3D%3D%3D%20this.x%20%26%26%20v.y%20%3D%3D%3D%20this.y%20%26%26%20v.z%20%3D%3D%3D%20this.z%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.x%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this.y%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20this.z%20%3D%20array%5Boffset%20%2B%202%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this.x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this.y%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this.z%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this.x%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this.y%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20this.z%20%3D%20attribute2.getZ%28index5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20random%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.y%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.z%20%3D%20Math.random%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20randomDirection%28%29%20%7B%0A%20%20%20%20const%20theta%20%3D%20Math.random%28%29%20%2A%20Math.PI%20%2A%202%3B%0A%20%20%20%20const%20u%20%3D%20Math.random%28%29%20%2A%202%20-%201%3B%0A%20%20%20%20const%20c2%20%3D%20Math.sqrt%281%20-%20u%20%2A%20u%29%3B%0A%20%20%20%20this.x%20%3D%20c2%20%2A%20Math.cos%28theta%29%3B%0A%20%20%20%20this.y%20%3D%20u%3B%0A%20%20%20%20this.z%20%3D%20c2%20%2A%20Math.sin%28theta%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this.x%3B%0A%20%20%20%20yield%20this.y%3B%0A%20%20%20%20yield%20this.z%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_vector%24c%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_quaternion%244%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Quaternion%28%29%3B%0Avar%20Box3%20%3D%20class%20%7B%0A%20%20constructor%28min2%20%3D%20new%20Vector3%28Infinity%2C%20Infinity%2C%20Infinity%29%2C%20max2%20%3D%20new%20Vector3%28-Infinity%2C%20-Infinity%2C%20-Infinity%29%29%20%7B%0A%20%20%20%20this.isBox3%20%3D%20true%3B%0A%20%20%20%20this.min%20%3D%20min2%3B%0A%20%20%20%20this.max%20%3D%20max2%3B%0A%20%20%7D%0A%20%20set%28min2%2C%20max2%29%20%7B%0A%20%20%20%20this.min.copy%28min2%29%3B%0A%20%20%20%20this.max.copy%28max2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromArray%28array%29%20%7B%0A%20%20%20%20this.makeEmpty%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20array.length%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20this.expandByPoint%28_vector%24b.fromArray%28array%2C%20i%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromBufferAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.makeEmpty%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20attribute2.count%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.expandByPoint%28_vector%24b.fromBufferAttribute%28attribute2%2C%20i%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromPoints%28points%29%20%7B%0A%20%20%20%20this.makeEmpty%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20points.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.expandByPoint%28points%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromCenterAndSize%28center%2C%20size%29%20%7B%0A%20%20%20%20const%20halfSize%20%3D%20_vector%24b.copy%28size%29.multiplyScalar%280.5%29%3B%0A%20%20%20%20this.min.copy%28center%29.sub%28halfSize%29%3B%0A%20%20%20%20this.max.copy%28center%29.add%28halfSize%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromObject%28object%2C%20precise%20%3D%20false%29%20%7B%0A%20%20%20%20this.makeEmpty%28%29%3B%0A%20%20%20%20return%20this.expandByObject%28object%2C%20precise%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28box%29%20%7B%0A%20%20%20%20this.min.copy%28box.min%29%3B%0A%20%20%20%20this.max.copy%28box.max%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeEmpty%28%29%20%7B%0A%20%20%20%20this.min.x%20%3D%20this.min.y%20%3D%20this.min.z%20%3D%20Infinity%3B%0A%20%20%20%20this.max.x%20%3D%20this.max.y%20%3D%20this.max.z%20%3D%20-Infinity%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20isEmpty%28%29%20%7B%0A%20%20%20%20return%20this.max.x%20%3C%20this.min.x%20%7C%7C%20this.max.y%20%3C%20this.min.y%20%7C%7C%20this.max.z%20%3C%20this.min.z%3B%0A%20%20%7D%0A%20%20getCenter%28target%29%20%7B%0A%20%20%20%20return%20this.isEmpty%28%29%20%3F%20target.set%280%2C%200%2C%200%29%20%3A%20target.addVectors%28this.min%2C%20this.max%29.multiplyScalar%280.5%29%3B%0A%20%20%7D%0A%20%20getSize%28target%29%20%7B%0A%20%20%20%20return%20this.isEmpty%28%29%20%3F%20target.set%280%2C%200%2C%200%29%20%3A%20target.subVectors%28this.max%2C%20this.min%29%3B%0A%20%20%7D%0A%20%20expandByPoint%28point%29%20%7B%0A%20%20%20%20this.min.min%28point%29%3B%0A%20%20%20%20this.max.max%28point%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20expandByVector%28vector%29%20%7B%0A%20%20%20%20this.min.sub%28vector%29%3B%0A%20%20%20%20this.max.add%28vector%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20expandByScalar%28scalar%29%20%7B%0A%20%20%20%20this.min.addScalar%28-scalar%29%3B%0A%20%20%20%20this.max.addScalar%28scalar%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20expandByObject%28object%2C%20precise%20%3D%20false%29%20%7B%0A%20%20%20%20object.updateWorldMatrix%28false%2C%20false%29%3B%0A%20%20%20%20const%20geometry%20%3D%20object.geometry%3B%0A%20%20%20%20if%20%28geometry%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20positionAttribute%20%3D%20geometry.getAttribute%28%22position%22%29%3B%0A%20%20%20%20%20%20if%20%28precise%20%3D%3D%3D%20true%20%26%26%20positionAttribute%20%21%3D%3D%20void%200%20%26%26%20object.isInstancedMesh%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20positionAttribute.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28object.isMesh%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20object.getVertexPosition%28i%2C%20_vector%24b%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%24b.fromBufferAttribute%28positionAttribute%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_vector%24b.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.expandByPoint%28_vector%24b%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28object.boundingBox%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28object.boundingBox%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20object.computeBoundingBox%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_box%244.copy%28object.boundingBox%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28geometry.boundingBox%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20geometry.computeBoundingBox%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_box%244.copy%28geometry.boundingBox%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20_box%244.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20this.union%28_box%244%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20children%20%3D%20object.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.expandByObject%28children%5Bi%5D%2C%20precise%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20containsPoint%28point%29%20%7B%0A%20%20%20%20return%20point.x%20%3E%3D%20this.min.x%20%26%26%20point.x%20%3C%3D%20this.max.x%20%26%26%20point.y%20%3E%3D%20this.min.y%20%26%26%20point.y%20%3C%3D%20this.max.y%20%26%26%20point.z%20%3E%3D%20this.min.z%20%26%26%20point.z%20%3C%3D%20this.max.z%3B%0A%20%20%7D%0A%20%20containsBox%28box%29%20%7B%0A%20%20%20%20return%20this.min.x%20%3C%3D%20box.min.x%20%26%26%20box.max.x%20%3C%3D%20this.max.x%20%26%26%20this.min.y%20%3C%3D%20box.min.y%20%26%26%20box.max.y%20%3C%3D%20this.max.y%20%26%26%20this.min.z%20%3C%3D%20box.min.z%20%26%26%20box.max.z%20%3C%3D%20this.max.z%3B%0A%20%20%7D%0A%20%20getParameter%28point%2C%20target%29%20%7B%0A%20%20%20%20return%20target.set%28%0A%20%20%20%20%20%20%28point.x%20-%20this.min.x%29%20%2F%20%28this.max.x%20-%20this.min.x%29%2C%0A%20%20%20%20%20%20%28point.y%20-%20this.min.y%29%20%2F%20%28this.max.y%20-%20this.min.y%29%2C%0A%20%20%20%20%20%20%28point.z%20-%20this.min.z%29%20%2F%20%28this.max.z%20-%20this.min.z%29%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20box.max.x%20%3E%3D%20this.min.x%20%26%26%20box.min.x%20%3C%3D%20this.max.x%20%26%26%20box.max.y%20%3E%3D%20this.min.y%20%26%26%20box.min.y%20%3C%3D%20this.max.y%20%26%26%20box.max.z%20%3E%3D%20this.min.z%20%26%26%20box.min.z%20%3C%3D%20this.max.z%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20this.clampPoint%28sphere.center%2C%20_vector%24b%29%3B%0A%20%20%20%20return%20_vector%24b.distanceToSquared%28sphere.center%29%20%3C%3D%20sphere.radius%20%2A%20sphere.radius%3B%0A%20%20%7D%0A%20%20intersectsPlane%28plane%29%20%7B%0A%20%20%20%20let%20min2%2C%20max2%3B%0A%20%20%20%20if%20%28plane.normal.x%20%3E%200%29%20%7B%0A%20%20%20%20%20%20min2%20%3D%20plane.normal.x%20%2A%20this.min.x%3B%0A%20%20%20%20%20%20max2%20%3D%20plane.normal.x%20%2A%20this.max.x%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20min2%20%3D%20plane.normal.x%20%2A%20this.max.x%3B%0A%20%20%20%20%20%20max2%20%3D%20plane.normal.x%20%2A%20this.min.x%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28plane.normal.y%20%3E%200%29%20%7B%0A%20%20%20%20%20%20min2%20%2B%3D%20plane.normal.y%20%2A%20this.min.y%3B%0A%20%20%20%20%20%20max2%20%2B%3D%20plane.normal.y%20%2A%20this.max.y%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20min2%20%2B%3D%20plane.normal.y%20%2A%20this.max.y%3B%0A%20%20%20%20%20%20max2%20%2B%3D%20plane.normal.y%20%2A%20this.min.y%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28plane.normal.z%20%3E%200%29%20%7B%0A%20%20%20%20%20%20min2%20%2B%3D%20plane.normal.z%20%2A%20this.min.z%3B%0A%20%20%20%20%20%20max2%20%2B%3D%20plane.normal.z%20%2A%20this.max.z%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20min2%20%2B%3D%20plane.normal.z%20%2A%20this.max.z%3B%0A%20%20%20%20%20%20max2%20%2B%3D%20plane.normal.z%20%2A%20this.min.z%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20min2%20%3C%3D%20-plane.constant%20%26%26%20max2%20%3E%3D%20-plane.constant%3B%0A%20%20%7D%0A%20%20intersectsTriangle%28triangle%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.getCenter%28_center%29%3B%0A%20%20%20%20_extents.subVectors%28this.max%2C%20_center%29%3B%0A%20%20%20%20_v0%243.subVectors%28triangle.a%2C%20_center%29%3B%0A%20%20%20%20_v1%247.subVectors%28triangle.b%2C%20_center%29%3B%0A%20%20%20%20_v2%244.subVectors%28triangle.c%2C%20_center%29%3B%0A%20%20%20%20_f0.subVectors%28_v1%247%2C%20_v0%243%29%3B%0A%20%20%20%20_f1.subVectors%28_v2%244%2C%20_v1%247%29%3B%0A%20%20%20%20_f2.subVectors%28_v0%243%2C%20_v2%244%29%3B%0A%20%20%20%20let%20axes%20%3D%20%5B%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f0.z%2C%0A%20%20%20%20%20%20_f0.y%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f1.z%2C%0A%20%20%20%20%20%20_f1.y%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f2.z%2C%0A%20%20%20%20%20%20_f2.y%2C%0A%20%20%20%20%20%20_f0.z%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f0.x%2C%0A%20%20%20%20%20%20_f1.z%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f1.x%2C%0A%20%20%20%20%20%20_f2.z%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f2.x%2C%0A%20%20%20%20%20%20-_f0.y%2C%0A%20%20%20%20%20%20_f0.x%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f1.y%2C%0A%20%20%20%20%20%20_f1.x%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f2.y%2C%0A%20%20%20%20%20%20_f2.x%2C%0A%20%20%20%20%20%200%0A%20%20%20%20%5D%3B%0A%20%20%20%20if%20%28%21satForAxes%28axes%2C%20_v0%243%2C%20_v1%247%2C%20_v2%244%2C%20_extents%29%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20axes%20%3D%20%5B1%2C%200%2C%200%2C%200%2C%201%2C%200%2C%200%2C%200%2C%201%5D%3B%0A%20%20%20%20if%20%28%21satForAxes%28axes%2C%20_v0%243%2C%20_v1%247%2C%20_v2%244%2C%20_extents%29%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20_triangleNormal.crossVectors%28_f0%2C%20_f1%29%3B%0A%20%20%20%20axes%20%3D%20%5B_triangleNormal.x%2C%20_triangleNormal.y%2C%20_triangleNormal.z%5D%3B%0A%20%20%20%20return%20satForAxes%28axes%2C%20_v0%243%2C%20_v1%247%2C%20_v2%244%2C%20_extents%29%3B%0A%20%20%7D%0A%20%20clampPoint%28point%2C%20target%29%20%7B%0A%20%20%20%20return%20target.copy%28point%29.clamp%28this.min%2C%20this.max%29%3B%0A%20%20%7D%0A%20%20distanceToPoint%28point%29%20%7B%0A%20%20%20%20return%20this.clampPoint%28point%2C%20_vector%24b%29.distanceTo%28point%29%3B%0A%20%20%7D%0A%20%20getBoundingSphere%28target%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20target.makeEmpty%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.getCenter%28target.center%29%3B%0A%20%20%20%20%20%20target.radius%20%3D%20this.getSize%28_vector%24b%29.length%28%29%20%2A%200.5%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20intersect%28box%29%20%7B%0A%20%20%20%20this.min.max%28box.min%29%3B%0A%20%20%20%20this.max.min%28box.max%29%3B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20this.makeEmpty%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20union%28box%29%20%7B%0A%20%20%20%20this.min.min%28box.min%29%3B%0A%20%20%20%20this.max.max%28box.max%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20return%20this%3B%0A%20%20%20%20_points%5B0%5D.set%28this.min.x%2C%20this.min.y%2C%20this.min.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points%5B1%5D.set%28this.min.x%2C%20this.min.y%2C%20this.max.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points%5B2%5D.set%28this.min.x%2C%20this.max.y%2C%20this.min.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points%5B3%5D.set%28this.min.x%2C%20this.max.y%2C%20this.max.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points%5B4%5D.set%28this.max.x%2C%20this.min.y%2C%20this.min.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points%5B5%5D.set%28this.max.x%2C%20this.min.y%2C%20this.max.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points%5B6%5D.set%28this.max.x%2C%20this.max.y%2C%20this.min.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points%5B7%5D.set%28this.max.x%2C%20this.max.y%2C%20this.max.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20this.setFromPoints%28_points%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28offset%29%20%7B%0A%20%20%20%20this.min.add%28offset%29%3B%0A%20%20%20%20this.max.add%28offset%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28box%29%20%7B%0A%20%20%20%20return%20box.min.equals%28this.min%29%20%26%26%20box.max.equals%28this.max%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_points%20%3D%20%5B%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%0A%5D%3B%0Avar%20_vector%24b%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_box%244%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Box3%28%29%3B%0Avar%20_v0%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_v1%247%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_v2%244%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_f0%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_f1%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_f2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_center%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_extents%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_triangleNormal%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_testAxis%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Afunction%20satForAxes%28axes%2C%20v0%2C%20v1%2C%20v2%2C%20extents%29%20%7B%0A%20%20for%20%28let%20i%20%3D%200%2C%20j%20%3D%20axes.length%20-%203%3B%20i%20%3C%3D%20j%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20_testAxis.fromArray%28axes%2C%20i%29%3B%0A%20%20%20%20const%20r%20%3D%20extents.x%20%2A%20Math.abs%28_testAxis.x%29%20%2B%20extents.y%20%2A%20Math.abs%28_testAxis.y%29%20%2B%20extents.z%20%2A%20Math.abs%28_testAxis.z%29%3B%0A%20%20%20%20const%20p0%20%3D%20v0.dot%28_testAxis%29%3B%0A%20%20%20%20const%20p1%20%3D%20v1.dot%28_testAxis%29%3B%0A%20%20%20%20const%20p2%20%3D%20v2.dot%28_testAxis%29%3B%0A%20%20%20%20if%20%28Math.max%28-Math.max%28p0%2C%20p1%2C%20p2%29%2C%20Math.min%28p0%2C%20p1%2C%20p2%29%29%20%3E%20r%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20true%3B%0A%7D%0Avar%20_box%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Box3%28%29%3B%0Avar%20_v1%246%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_v2%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20Sphere%20%3D%20class%20%7B%0A%20%20constructor%28center%20%3D%20new%20Vector3%28%29%2C%20radius%20%3D%20-1%29%20%7B%0A%20%20%20%20this.isSphere%20%3D%20true%3B%0A%20%20%20%20this.center%20%3D%20center%3B%0A%20%20%20%20this.radius%20%3D%20radius%3B%0A%20%20%7D%0A%20%20set%28center%2C%20radius%29%20%7B%0A%20%20%20%20this.center.copy%28center%29%3B%0A%20%20%20%20this.radius%20%3D%20radius%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromPoints%28points%2C%20optionalCenter%29%20%7B%0A%20%20%20%20const%20center%20%3D%20this.center%3B%0A%20%20%20%20if%20%28optionalCenter%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20center.copy%28optionalCenter%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_box%243.setFromPoints%28points%29.getCenter%28center%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20maxRadiusSq%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20points.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20maxRadiusSq%20%3D%20Math.max%28maxRadiusSq%2C%20center.distanceToSquared%28points%5Bi%5D%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.radius%20%3D%20Math.sqrt%28maxRadiusSq%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28sphere%29%20%7B%0A%20%20%20%20this.center.copy%28sphere.center%29%3B%0A%20%20%20%20this.radius%20%3D%20sphere.radius%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20isEmpty%28%29%20%7B%0A%20%20%20%20return%20this.radius%20%3C%200%3B%0A%20%20%7D%0A%20%20makeEmpty%28%29%20%7B%0A%20%20%20%20this.center.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20this.radius%20%3D%20-1%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20containsPoint%28point%29%20%7B%0A%20%20%20%20return%20point.distanceToSquared%28this.center%29%20%3C%3D%20this.radius%20%2A%20this.radius%3B%0A%20%20%7D%0A%20%20distanceToPoint%28point%29%20%7B%0A%20%20%20%20return%20point.distanceTo%28this.center%29%20-%20this.radius%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20const%20radiusSum%20%3D%20this.radius%20%2B%20sphere.radius%3B%0A%20%20%20%20return%20sphere.center.distanceToSquared%28this.center%29%20%3C%3D%20radiusSum%20%2A%20radiusSum%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20box.intersectsSphere%28this%29%3B%0A%20%20%7D%0A%20%20intersectsPlane%28plane%29%20%7B%0A%20%20%20%20return%20Math.abs%28plane.distanceToPoint%28this.center%29%29%20%3C%3D%20this.radius%3B%0A%20%20%7D%0A%20%20clampPoint%28point%2C%20target%29%20%7B%0A%20%20%20%20const%20deltaLengthSq%20%3D%20this.center.distanceToSquared%28point%29%3B%0A%20%20%20%20target.copy%28point%29%3B%0A%20%20%20%20if%20%28deltaLengthSq%20%3E%20this.radius%20%2A%20this.radius%29%20%7B%0A%20%20%20%20%20%20target.sub%28this.center%29.normalize%28%29%3B%0A%20%20%20%20%20%20target.multiplyScalar%28this.radius%29.add%28this.center%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getBoundingBox%28target%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20target.makeEmpty%28%29%3B%0A%20%20%20%20%20%20return%20target%3B%0A%20%20%20%20%7D%0A%20%20%20%20target.set%28this.center%2C%20this.center%29%3B%0A%20%20%20%20target.expandByScalar%28this.radius%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%29%20%7B%0A%20%20%20%20this.center.applyMatrix4%28matrix%29%3B%0A%20%20%20%20this.radius%20%3D%20this.radius%20%2A%20matrix.getMaxScaleOnAxis%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28offset%29%20%7B%0A%20%20%20%20this.center.add%28offset%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20expandByPoint%28point%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20this.center.copy%28point%29%3B%0A%20%20%20%20%20%20this.radius%20%3D%200%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20_v1%246.subVectors%28point%2C%20this.center%29%3B%0A%20%20%20%20const%20lengthSq2%20%3D%20_v1%246.lengthSq%28%29%3B%0A%20%20%20%20if%20%28lengthSq2%20%3E%20this.radius%20%2A%20this.radius%29%20%7B%0A%20%20%20%20%20%20const%20length2%20%3D%20Math.sqrt%28lengthSq2%29%3B%0A%20%20%20%20%20%20const%20delta%20%3D%20%28length2%20-%20this.radius%29%20%2A%200.5%3B%0A%20%20%20%20%20%20this.center.addScaledVector%28_v1%246%2C%20delta%20%2F%20length2%29%3B%0A%20%20%20%20%20%20this.radius%20%2B%3D%20delta%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20union%28sphere%29%20%7B%0A%20%20%20%20if%20%28sphere.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20this.copy%28sphere%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.center.equals%28sphere.center%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.radius%20%3D%20Math.max%28this.radius%2C%20sphere.radius%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_v2%243.subVectors%28sphere.center%2C%20this.center%29.setLength%28sphere.radius%29%3B%0A%20%20%20%20%20%20this.expandByPoint%28_v1%246.copy%28sphere.center%29.add%28_v2%243%29%29%3B%0A%20%20%20%20%20%20this.expandByPoint%28_v1%246.copy%28sphere.center%29.sub%28_v2%243%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28sphere%29%20%7B%0A%20%20%20%20return%20sphere.center.equals%28this.center%29%20%26%26%20sphere.radius%20%3D%3D%3D%20this.radius%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_vector%24a%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_segCenter%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_segDir%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_diff%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_edge1%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_edge2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_normal%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20Ray%20%3D%20class%20%7B%0A%20%20constructor%28origin%20%3D%20new%20Vector3%28%29%2C%20direction2%20%3D%20new%20Vector3%280%2C%200%2C%20-1%29%29%20%7B%0A%20%20%20%20this.origin%20%3D%20origin%3B%0A%20%20%20%20this.direction%20%3D%20direction2%3B%0A%20%20%7D%0A%20%20set%28origin%2C%20direction2%29%20%7B%0A%20%20%20%20this.origin.copy%28origin%29%3B%0A%20%20%20%20this.direction.copy%28direction2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28ray%29%20%7B%0A%20%20%20%20this.origin.copy%28ray.origin%29%3B%0A%20%20%20%20this.direction.copy%28ray.direction%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20at%28t%2C%20target%29%20%7B%0A%20%20%20%20return%20target.copy%28this.origin%29.addScaledVector%28this.direction%2C%20t%29%3B%0A%20%20%7D%0A%20%20lookAt%28v%29%20%7B%0A%20%20%20%20this.direction.copy%28v%29.sub%28this.origin%29.normalize%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20recast%28t%29%20%7B%0A%20%20%20%20this.origin.copy%28this.at%28t%2C%20_vector%24a%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20closestPointToPoint%28point%2C%20target%29%20%7B%0A%20%20%20%20target.subVectors%28point%2C%20this.origin%29%3B%0A%20%20%20%20const%20directionDistance%20%3D%20target.dot%28this.direction%29%3B%0A%20%20%20%20if%20%28directionDistance%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28this.origin%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target.copy%28this.origin%29.addScaledVector%28this.direction%2C%20directionDistance%29%3B%0A%20%20%7D%0A%20%20distanceToPoint%28point%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.distanceSqToPoint%28point%29%29%3B%0A%20%20%7D%0A%20%20distanceSqToPoint%28point%29%20%7B%0A%20%20%20%20const%20directionDistance%20%3D%20_vector%24a.subVectors%28point%2C%20this.origin%29.dot%28this.direction%29%3B%0A%20%20%20%20if%20%28directionDistance%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20this.origin.distanceToSquared%28point%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_vector%24a.copy%28this.origin%29.addScaledVector%28this.direction%2C%20directionDistance%29%3B%0A%20%20%20%20return%20_vector%24a.distanceToSquared%28point%29%3B%0A%20%20%7D%0A%20%20distanceSqToSegment%28v0%2C%20v1%2C%20optionalPointOnRay%2C%20optionalPointOnSegment%29%20%7B%0A%20%20%20%20_segCenter.copy%28v0%29.add%28v1%29.multiplyScalar%280.5%29%3B%0A%20%20%20%20_segDir.copy%28v1%29.sub%28v0%29.normalize%28%29%3B%0A%20%20%20%20_diff.copy%28this.origin%29.sub%28_segCenter%29%3B%0A%20%20%20%20const%20segExtent%20%3D%20v0.distanceTo%28v1%29%20%2A%200.5%3B%0A%20%20%20%20const%20a01%20%3D%20-this.direction.dot%28_segDir%29%3B%0A%20%20%20%20const%20b0%20%3D%20_diff.dot%28this.direction%29%3B%0A%20%20%20%20const%20b1%20%3D%20-_diff.dot%28_segDir%29%3B%0A%20%20%20%20const%20c2%20%3D%20_diff.lengthSq%28%29%3B%0A%20%20%20%20const%20det%20%3D%20Math.abs%281%20-%20a01%20%2A%20a01%29%3B%0A%20%20%20%20let%20s0%2C%20s1%2C%20sqrDist%2C%20extDet%3B%0A%20%20%20%20if%20%28det%20%3E%200%29%20%7B%0A%20%20%20%20%20%20s0%20%3D%20a01%20%2A%20b1%20-%20b0%3B%0A%20%20%20%20%20%20s1%20%3D%20a01%20%2A%20b0%20-%20b1%3B%0A%20%20%20%20%20%20extDet%20%3D%20segExtent%20%2A%20det%3B%0A%20%20%20%20%20%20if%20%28s0%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28s1%20%3E%3D%20-extDet%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28s1%20%3C%3D%20extDet%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20invDet%20%3D%201%20%2F%20det%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20s0%20%2A%3D%20invDet%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20s1%20%2A%3D%20invDet%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20s0%20%2A%20%28s0%20%2B%20a01%20%2A%20s1%20%2B%202%20%2A%20b0%29%20%2B%20s1%20%2A%20%28a01%20%2A%20s0%20%2B%20s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20s1%20%3D%20segExtent%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28a01%20%2A%20s1%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20s1%20%3D%20-segExtent%3B%0A%20%20%20%20%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28a01%20%2A%20s1%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28s1%20%3C%3D%20-extDet%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28-a01%20%2A%20segExtent%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20s1%20%3D%20s0%20%3E%200%20%3F%20-segExtent%20%3A%20Math.min%28Math.max%28-segExtent%2C%20-b1%29%2C%20segExtent%29%3B%0A%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28s1%20%3C%3D%20extDet%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20s0%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20s1%20%3D%20Math.min%28Math.max%28-segExtent%2C%20-b1%29%2C%20segExtent%29%3B%0A%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28a01%20%2A%20segExtent%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20s1%20%3D%20s0%20%3E%200%20%3F%20segExtent%20%3A%20Math.min%28Math.max%28-segExtent%2C%20-b1%29%2C%20segExtent%29%3B%0A%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20s1%20%3D%20a01%20%3E%200%20%3F%20-segExtent%20%3A%20segExtent%3B%0A%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28a01%20%2A%20s1%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28optionalPointOnRay%29%20%7B%0A%20%20%20%20%20%20optionalPointOnRay.copy%28this.origin%29.addScaledVector%28this.direction%2C%20s0%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28optionalPointOnSegment%29%20%7B%0A%20%20%20%20%20%20optionalPointOnSegment.copy%28_segCenter%29.addScaledVector%28_segDir%2C%20s1%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20sqrDist%3B%0A%20%20%7D%0A%20%20intersectSphere%28sphere%2C%20target%29%20%7B%0A%20%20%20%20_vector%24a.subVectors%28sphere.center%2C%20this.origin%29%3B%0A%20%20%20%20const%20tca%20%3D%20_vector%24a.dot%28this.direction%29%3B%0A%20%20%20%20const%20d2%20%3D%20_vector%24a.dot%28_vector%24a%29%20-%20tca%20%2A%20tca%3B%0A%20%20%20%20const%20radius2%20%3D%20sphere.radius%20%2A%20sphere.radius%3B%0A%20%20%20%20if%20%28d2%20%3E%20radius2%29%20return%20null%3B%0A%20%20%20%20const%20thc%20%3D%20Math.sqrt%28radius2%20-%20d2%29%3B%0A%20%20%20%20const%20t0%20%3D%20tca%20-%20thc%3B%0A%20%20%20%20const%20t1%20%3D%20tca%20%2B%20thc%3B%0A%20%20%20%20if%20%28t1%20%3C%200%29%20return%20null%3B%0A%20%20%20%20if%20%28t0%20%3C%200%29%20return%20this.at%28t1%2C%20target%29%3B%0A%20%20%20%20return%20this.at%28t0%2C%20target%29%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20return%20this.distanceSqToPoint%28sphere.center%29%20%3C%3D%20sphere.radius%20%2A%20sphere.radius%3B%0A%20%20%7D%0A%20%20distanceToPlane%28plane%29%20%7B%0A%20%20%20%20const%20denominator%20%3D%20plane.normal.dot%28this.direction%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28plane.distanceToPoint%28this.origin%29%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20t%20%3D%20-%28this.origin.dot%28plane.normal%29%20%2B%20plane.constant%29%20%2F%20denominator%3B%0A%20%20%20%20return%20t%20%3E%3D%200%20%3F%20t%20%3A%20null%3B%0A%20%20%7D%0A%20%20intersectPlane%28plane%2C%20target%29%20%7B%0A%20%20%20%20const%20t%20%3D%20this.distanceToPlane%28plane%29%3B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.at%28t%2C%20target%29%3B%0A%20%20%7D%0A%20%20intersectsPlane%28plane%29%20%7B%0A%20%20%20%20const%20distToPoint%20%3D%20plane.distanceToPoint%28this.origin%29%3B%0A%20%20%20%20if%20%28distToPoint%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20denominator%20%3D%20plane.normal.dot%28this.direction%29%3B%0A%20%20%20%20if%20%28denominator%20%2A%20distToPoint%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20intersectBox%28box%2C%20target%29%20%7B%0A%20%20%20%20let%20tmin%2C%20tmax%2C%20tymin%2C%20tymax%2C%20tzmin%2C%20tzmax%3B%0A%20%20%20%20const%20invdirx%20%3D%201%20%2F%20this.direction.x%2C%20invdiry%20%3D%201%20%2F%20this.direction.y%2C%20invdirz%20%3D%201%20%2F%20this.direction.z%3B%0A%20%20%20%20const%20origin%20%3D%20this.origin%3B%0A%20%20%20%20if%20%28invdirx%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20tmin%20%3D%20%28box.min.x%20-%20origin.x%29%20%2A%20invdirx%3B%0A%20%20%20%20%20%20tmax%20%3D%20%28box.max.x%20-%20origin.x%29%20%2A%20invdirx%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tmin%20%3D%20%28box.max.x%20-%20origin.x%29%20%2A%20invdirx%3B%0A%20%20%20%20%20%20tmax%20%3D%20%28box.min.x%20-%20origin.x%29%20%2A%20invdirx%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28invdiry%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20tymin%20%3D%20%28box.min.y%20-%20origin.y%29%20%2A%20invdiry%3B%0A%20%20%20%20%20%20tymax%20%3D%20%28box.max.y%20-%20origin.y%29%20%2A%20invdiry%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tymin%20%3D%20%28box.max.y%20-%20origin.y%29%20%2A%20invdiry%3B%0A%20%20%20%20%20%20tymax%20%3D%20%28box.min.y%20-%20origin.y%29%20%2A%20invdiry%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28tmin%20%3E%20tymax%20%7C%7C%20tymin%20%3E%20tmax%29%20return%20null%3B%0A%20%20%20%20if%20%28tymin%20%3E%20tmin%20%7C%7C%20isNaN%28tmin%29%29%20tmin%20%3D%20tymin%3B%0A%20%20%20%20if%20%28tymax%20%3C%20tmax%20%7C%7C%20isNaN%28tmax%29%29%20tmax%20%3D%20tymax%3B%0A%20%20%20%20if%20%28invdirz%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20tzmin%20%3D%20%28box.min.z%20-%20origin.z%29%20%2A%20invdirz%3B%0A%20%20%20%20%20%20tzmax%20%3D%20%28box.max.z%20-%20origin.z%29%20%2A%20invdirz%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tzmin%20%3D%20%28box.max.z%20-%20origin.z%29%20%2A%20invdirz%3B%0A%20%20%20%20%20%20tzmax%20%3D%20%28box.min.z%20-%20origin.z%29%20%2A%20invdirz%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28tmin%20%3E%20tzmax%20%7C%7C%20tzmin%20%3E%20tmax%29%20return%20null%3B%0A%20%20%20%20if%20%28tzmin%20%3E%20tmin%20%7C%7C%20tmin%20%21%3D%3D%20tmin%29%20tmin%20%3D%20tzmin%3B%0A%20%20%20%20if%20%28tzmax%20%3C%20tmax%20%7C%7C%20tmax%20%21%3D%3D%20tmax%29%20tmax%20%3D%20tzmax%3B%0A%20%20%20%20if%20%28tmax%20%3C%200%29%20return%20null%3B%0A%20%20%20%20return%20this.at%28tmin%20%3E%3D%200%20%3F%20tmin%20%3A%20tmax%2C%20target%29%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20this.intersectBox%28box%2C%20_vector%24a%29%20%21%3D%3D%20null%3B%0A%20%20%7D%0A%20%20intersectTriangle%28a2%2C%20b%2C%20c2%2C%20backfaceCulling%2C%20target%29%20%7B%0A%20%20%20%20_edge1.subVectors%28b%2C%20a2%29%3B%0A%20%20%20%20_edge2.subVectors%28c2%2C%20a2%29%3B%0A%20%20%20%20_normal%241.crossVectors%28_edge1%2C%20_edge2%29%3B%0A%20%20%20%20let%20DdN%20%3D%20this.direction.dot%28_normal%241%29%3B%0A%20%20%20%20let%20sign2%3B%0A%20%20%20%20if%20%28DdN%20%3E%200%29%20%7B%0A%20%20%20%20%20%20if%20%28backfaceCulling%29%20return%20null%3B%0A%20%20%20%20%20%20sign2%20%3D%201%3B%0A%20%20%20%20%7D%20else%20if%20%28DdN%20%3C%200%29%20%7B%0A%20%20%20%20%20%20sign2%20%3D%20-1%3B%0A%20%20%20%20%20%20DdN%20%3D%20-DdN%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20_diff.subVectors%28this.origin%2C%20a2%29%3B%0A%20%20%20%20const%20DdQxE2%20%3D%20sign2%20%2A%20this.direction.dot%28_edge2.crossVectors%28_diff%2C%20_edge2%29%29%3B%0A%20%20%20%20if%20%28DdQxE2%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20DdE1xQ%20%3D%20sign2%20%2A%20this.direction.dot%28_edge1.cross%28_diff%29%29%3B%0A%20%20%20%20if%20%28DdE1xQ%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28DdQxE2%20%2B%20DdE1xQ%20%3E%20DdN%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20QdN%20%3D%20-sign2%20%2A%20_diff.dot%28_normal%241%29%3B%0A%20%20%20%20if%20%28QdN%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.at%28QdN%20%2F%20DdN%2C%20target%29%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix4%29%20%7B%0A%20%20%20%20this.origin.applyMatrix4%28matrix4%29%3B%0A%20%20%20%20this.direction.transformDirection%28matrix4%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28ray%29%20%7B%0A%20%20%20%20return%20ray.origin.equals%28this.origin%29%20%26%26%20ray.direction.equals%28this.direction%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Matrix4%20%3D%20class%20_Matrix4%20%7B%0A%20%20constructor%28n11%2C%20n12%2C%20n13%2C%20n14%2C%20n21%2C%20n22%2C%20n23%2C%20n24%2C%20n31%2C%20n32%2C%20n33%2C%20n34%2C%20n41%2C%20n42%2C%20n43%2C%20n44%29%20%7B%0A%20%20%20%20_Matrix4.prototype.isMatrix4%20%3D%20true%3B%0A%20%20%20%20this.elements%20%3D%20%5B%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%5D%3B%0A%20%20%20%20if%20%28n11%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.set%28n11%2C%20n12%2C%20n13%2C%20n14%2C%20n21%2C%20n22%2C%20n23%2C%20n24%2C%20n31%2C%20n32%2C%20n33%2C%20n34%2C%20n41%2C%20n42%2C%20n43%2C%20n44%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20set%28n11%2C%20n12%2C%20n13%2C%20n14%2C%20n21%2C%20n22%2C%20n23%2C%20n24%2C%20n31%2C%20n32%2C%20n33%2C%20n34%2C%20n41%2C%20n42%2C%20n43%2C%20n44%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20te%5B0%5D%20%3D%20n11%3B%0A%20%20%20%20te%5B4%5D%20%3D%20n12%3B%0A%20%20%20%20te%5B8%5D%20%3D%20n13%3B%0A%20%20%20%20te%5B12%5D%20%3D%20n14%3B%0A%20%20%20%20te%5B1%5D%20%3D%20n21%3B%0A%20%20%20%20te%5B5%5D%20%3D%20n22%3B%0A%20%20%20%20te%5B9%5D%20%3D%20n23%3B%0A%20%20%20%20te%5B13%5D%20%3D%20n24%3B%0A%20%20%20%20te%5B2%5D%20%3D%20n31%3B%0A%20%20%20%20te%5B6%5D%20%3D%20n32%3B%0A%20%20%20%20te%5B10%5D%20%3D%20n33%3B%0A%20%20%20%20te%5B14%5D%20%3D%20n34%3B%0A%20%20%20%20te%5B3%5D%20%3D%20n41%3B%0A%20%20%20%20te%5B7%5D%20%3D%20n42%3B%0A%20%20%20%20te%5B11%5D%20%3D%20n43%3B%0A%20%20%20%20te%5B15%5D%20%3D%20n44%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20identity%28%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20_Matrix4%28%29.fromArray%28this.elements%29%3B%0A%20%20%7D%0A%20%20copy%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20te%5B0%5D%20%3D%20me%5B0%5D%3B%0A%20%20%20%20te%5B1%5D%20%3D%20me%5B1%5D%3B%0A%20%20%20%20te%5B2%5D%20%3D%20me%5B2%5D%3B%0A%20%20%20%20te%5B3%5D%20%3D%20me%5B3%5D%3B%0A%20%20%20%20te%5B4%5D%20%3D%20me%5B4%5D%3B%0A%20%20%20%20te%5B5%5D%20%3D%20me%5B5%5D%3B%0A%20%20%20%20te%5B6%5D%20%3D%20me%5B6%5D%3B%0A%20%20%20%20te%5B7%5D%20%3D%20me%5B7%5D%3B%0A%20%20%20%20te%5B8%5D%20%3D%20me%5B8%5D%3B%0A%20%20%20%20te%5B9%5D%20%3D%20me%5B9%5D%3B%0A%20%20%20%20te%5B10%5D%20%3D%20me%5B10%5D%3B%0A%20%20%20%20te%5B11%5D%20%3D%20me%5B11%5D%3B%0A%20%20%20%20te%5B12%5D%20%3D%20me%5B12%5D%3B%0A%20%20%20%20te%5B13%5D%20%3D%20me%5B13%5D%3B%0A%20%20%20%20te%5B14%5D%20%3D%20me%5B14%5D%3B%0A%20%20%20%20te%5B15%5D%20%3D%20me%5B15%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copyPosition%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%2C%20me%20%3D%20m2.elements%3B%0A%20%20%20%20te%5B12%5D%20%3D%20me%5B12%5D%3B%0A%20%20%20%20te%5B13%5D%20%3D%20me%5B13%5D%3B%0A%20%20%20%20te%5B14%5D%20%3D%20me%5B14%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrix3%28m2%29%20%7B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20me%5B0%5D%2C%0A%20%20%20%20%20%20me%5B3%5D%2C%0A%20%20%20%20%20%20me%5B6%5D%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20me%5B1%5D%2C%0A%20%20%20%20%20%20me%5B4%5D%2C%0A%20%20%20%20%20%20me%5B7%5D%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20me%5B2%5D%2C%0A%20%20%20%20%20%20me%5B5%5D%2C%0A%20%20%20%20%20%20me%5B8%5D%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20extractBasis%28xAxis%2C%20yAxis%2C%20zAxis%29%20%7B%0A%20%20%20%20xAxis.setFromMatrixColumn%28this%2C%200%29%3B%0A%20%20%20%20yAxis.setFromMatrixColumn%28this%2C%201%29%3B%0A%20%20%20%20zAxis.setFromMatrixColumn%28this%2C%202%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeBasis%28xAxis%2C%20yAxis%2C%20zAxis%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20xAxis.x%2C%0A%20%20%20%20%20%20yAxis.x%2C%0A%20%20%20%20%20%20zAxis.x%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20xAxis.y%2C%0A%20%20%20%20%20%20yAxis.y%2C%0A%20%20%20%20%20%20zAxis.y%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20xAxis.z%2C%0A%20%20%20%20%20%20yAxis.z%2C%0A%20%20%20%20%20%20zAxis.z%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20extractRotation%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20const%20scaleX%20%3D%201%20%2F%20_v1%245.setFromMatrixColumn%28m2%2C%200%29.length%28%29%3B%0A%20%20%20%20const%20scaleY%20%3D%201%20%2F%20_v1%245.setFromMatrixColumn%28m2%2C%201%29.length%28%29%3B%0A%20%20%20%20const%20scaleZ%20%3D%201%20%2F%20_v1%245.setFromMatrixColumn%28m2%2C%202%29.length%28%29%3B%0A%20%20%20%20te%5B0%5D%20%3D%20me%5B0%5D%20%2A%20scaleX%3B%0A%20%20%20%20te%5B1%5D%20%3D%20me%5B1%5D%20%2A%20scaleX%3B%0A%20%20%20%20te%5B2%5D%20%3D%20me%5B2%5D%20%2A%20scaleX%3B%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B4%5D%20%3D%20me%5B4%5D%20%2A%20scaleY%3B%0A%20%20%20%20te%5B5%5D%20%3D%20me%5B5%5D%20%2A%20scaleY%3B%0A%20%20%20%20te%5B6%5D%20%3D%20me%5B6%5D%20%2A%20scaleY%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B8%5D%20%3D%20me%5B8%5D%20%2A%20scaleZ%3B%0A%20%20%20%20te%5B9%5D%20%3D%20me%5B9%5D%20%2A%20scaleZ%3B%0A%20%20%20%20te%5B10%5D%20%3D%20me%5B10%5D%20%2A%20scaleZ%3B%0A%20%20%20%20te%5B11%5D%20%3D%200%3B%0A%20%20%20%20te%5B12%5D%20%3D%200%3B%0A%20%20%20%20te%5B13%5D%20%3D%200%3B%0A%20%20%20%20te%5B14%5D%20%3D%200%3B%0A%20%20%20%20te%5B15%5D%20%3D%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationFromEuler%28euler%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20x2%20%3D%20euler.x%2C%20y2%20%3D%20euler.y%2C%20z2%20%3D%20euler.z%3B%0A%20%20%20%20const%20a2%20%3D%20Math.cos%28x2%29%2C%20b%20%3D%20Math.sin%28x2%29%3B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28y2%29%2C%20d%20%3D%20Math.sin%28y2%29%3B%0A%20%20%20%20const%20e%20%3D%20Math.cos%28z2%29%2C%20f%20%3D%20Math.sin%28z2%29%3B%0A%20%20%20%20if%20%28euler.order%20%3D%3D%3D%20%22XYZ%22%29%20%7B%0A%20%20%20%20%20%20const%20ae%20%3D%20a2%20%2A%20e%2C%20af%20%3D%20a2%20%2A%20f%2C%20be%20%3D%20b%20%2A%20e%2C%20bf%20%3D%20b%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20c2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20-c2%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20d%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20af%20%2B%20be%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20ae%20-%20bf%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20-b%20%2A%20c2%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20bf%20-%20ae%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20be%20%2B%20af%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20a2%20%2A%20c2%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22YXZ%22%29%20%7B%0A%20%20%20%20%20%20const%20ce%20%3D%20c2%20%2A%20e%2C%20cf%20%3D%20c2%20%2A%20f%2C%20de%20%3D%20d%20%2A%20e%2C%20df%20%3D%20d%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20ce%20%2B%20df%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20de%20%2A%20b%20-%20cf%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20a2%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20a2%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20a2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20-b%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20cf%20%2A%20b%20-%20de%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20df%20%2B%20ce%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20a2%20%2A%20c2%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22ZXY%22%29%20%7B%0A%20%20%20%20%20%20const%20ce%20%3D%20c2%20%2A%20e%2C%20cf%20%3D%20c2%20%2A%20f%2C%20de%20%3D%20d%20%2A%20e%2C%20df%20%3D%20d%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20ce%20-%20df%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20-a2%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20de%20%2B%20cf%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20cf%20%2B%20de%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20a2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20df%20-%20ce%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20-a2%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20b%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20a2%20%2A%20c2%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22ZYX%22%29%20%7B%0A%20%20%20%20%20%20const%20ae%20%3D%20a2%20%2A%20e%2C%20af%20%3D%20a2%20%2A%20f%2C%20be%20%3D%20b%20%2A%20e%2C%20bf%20%3D%20b%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20c2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20be%20%2A%20d%20-%20af%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20ae%20%2A%20d%20%2B%20bf%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20c2%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20bf%20%2A%20d%20%2B%20ae%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20af%20%2A%20d%20-%20be%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20-d%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20b%20%2A%20c2%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20a2%20%2A%20c2%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22YZX%22%29%20%7B%0A%20%20%20%20%20%20const%20ac%20%3D%20a2%20%2A%20c2%2C%20ad%20%3D%20a2%20%2A%20d%2C%20bc%20%3D%20b%20%2A%20c2%2C%20bd%20%3D%20b%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20c2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20bd%20-%20ac%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20bc%20%2A%20f%20%2B%20ad%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20f%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20a2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20-b%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20-d%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20ad%20%2A%20f%20%2B%20bc%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20ac%20-%20bd%20%2A%20f%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22XZY%22%29%20%7B%0A%20%20%20%20%20%20const%20ac%20%3D%20a2%20%2A%20c2%2C%20ad%20%3D%20a2%20%2A%20d%2C%20bc%20%3D%20b%20%2A%20c2%2C%20bd%20%3D%20b%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20c2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20-f%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20d%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20ac%20%2A%20f%20%2B%20bd%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20a2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20ad%20%2A%20f%20-%20bc%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20bc%20%2A%20f%20-%20ad%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20b%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20bd%20%2A%20f%20%2B%20ac%3B%0A%20%20%20%20%7D%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B11%5D%20%3D%200%3B%0A%20%20%20%20te%5B12%5D%20%3D%200%3B%0A%20%20%20%20te%5B13%5D%20%3D%200%3B%0A%20%20%20%20te%5B14%5D%20%3D%200%3B%0A%20%20%20%20te%5B15%5D%20%3D%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationFromQuaternion%28q%29%20%7B%0A%20%20%20%20return%20this.compose%28_zero%2C%20q%2C%20_one%29%3B%0A%20%20%7D%0A%20%20lookAt%28eye%2C%20target%2C%20up%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20_z.subVectors%28eye%2C%20target%29%3B%0A%20%20%20%20if%20%28_z.lengthSq%28%29%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20_z.z%20%3D%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20_z.normalize%28%29%3B%0A%20%20%20%20_x.crossVectors%28up%2C%20_z%29%3B%0A%20%20%20%20if%20%28_x.lengthSq%28%29%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28Math.abs%28up.z%29%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20_z.x%20%2B%3D%201e-4%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_z.z%20%2B%3D%201e-4%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_z.normalize%28%29%3B%0A%20%20%20%20%20%20_x.crossVectors%28up%2C%20_z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_x.normalize%28%29%3B%0A%20%20%20%20_y.crossVectors%28_z%2C%20_x%29%3B%0A%20%20%20%20te%5B0%5D%20%3D%20_x.x%3B%0A%20%20%20%20te%5B4%5D%20%3D%20_y.x%3B%0A%20%20%20%20te%5B8%5D%20%3D%20_z.x%3B%0A%20%20%20%20te%5B1%5D%20%3D%20_x.y%3B%0A%20%20%20%20te%5B5%5D%20%3D%20_y.y%3B%0A%20%20%20%20te%5B9%5D%20%3D%20_z.y%3B%0A%20%20%20%20te%5B2%5D%20%3D%20_x.z%3B%0A%20%20%20%20te%5B6%5D%20%3D%20_y.z%3B%0A%20%20%20%20te%5B10%5D%20%3D%20_z.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28m2%29%20%7B%0A%20%20%20%20return%20this.multiplyMatrices%28this%2C%20m2%29%3B%0A%20%20%7D%0A%20%20premultiply%28m2%29%20%7B%0A%20%20%20%20return%20this.multiplyMatrices%28m2%2C%20this%29%3B%0A%20%20%7D%0A%20%20multiplyMatrices%28a2%2C%20b%29%20%7B%0A%20%20%20%20const%20ae%20%3D%20a2.elements%3B%0A%20%20%20%20const%20be%20%3D%20b.elements%3B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20a11%20%3D%20ae%5B0%5D%2C%20a12%20%3D%20ae%5B4%5D%2C%20a13%20%3D%20ae%5B8%5D%2C%20a14%20%3D%20ae%5B12%5D%3B%0A%20%20%20%20const%20a21%20%3D%20ae%5B1%5D%2C%20a22%20%3D%20ae%5B5%5D%2C%20a23%20%3D%20ae%5B9%5D%2C%20a24%20%3D%20ae%5B13%5D%3B%0A%20%20%20%20const%20a31%20%3D%20ae%5B2%5D%2C%20a32%20%3D%20ae%5B6%5D%2C%20a33%20%3D%20ae%5B10%5D%2C%20a34%20%3D%20ae%5B14%5D%3B%0A%20%20%20%20const%20a41%20%3D%20ae%5B3%5D%2C%20a42%20%3D%20ae%5B7%5D%2C%20a43%20%3D%20ae%5B11%5D%2C%20a44%20%3D%20ae%5B15%5D%3B%0A%20%20%20%20const%20b11%20%3D%20be%5B0%5D%2C%20b12%20%3D%20be%5B4%5D%2C%20b13%20%3D%20be%5B8%5D%2C%20b14%20%3D%20be%5B12%5D%3B%0A%20%20%20%20const%20b21%20%3D%20be%5B1%5D%2C%20b22%20%3D%20be%5B5%5D%2C%20b23%20%3D%20be%5B9%5D%2C%20b24%20%3D%20be%5B13%5D%3B%0A%20%20%20%20const%20b31%20%3D%20be%5B2%5D%2C%20b32%20%3D%20be%5B6%5D%2C%20b33%20%3D%20be%5B10%5D%2C%20b34%20%3D%20be%5B14%5D%3B%0A%20%20%20%20const%20b41%20%3D%20be%5B3%5D%2C%20b42%20%3D%20be%5B7%5D%2C%20b43%20%3D%20be%5B11%5D%2C%20b44%20%3D%20be%5B15%5D%3B%0A%20%20%20%20te%5B0%5D%20%3D%20a11%20%2A%20b11%20%2B%20a12%20%2A%20b21%20%2B%20a13%20%2A%20b31%20%2B%20a14%20%2A%20b41%3B%0A%20%20%20%20te%5B4%5D%20%3D%20a11%20%2A%20b12%20%2B%20a12%20%2A%20b22%20%2B%20a13%20%2A%20b32%20%2B%20a14%20%2A%20b42%3B%0A%20%20%20%20te%5B8%5D%20%3D%20a11%20%2A%20b13%20%2B%20a12%20%2A%20b23%20%2B%20a13%20%2A%20b33%20%2B%20a14%20%2A%20b43%3B%0A%20%20%20%20te%5B12%5D%20%3D%20a11%20%2A%20b14%20%2B%20a12%20%2A%20b24%20%2B%20a13%20%2A%20b34%20%2B%20a14%20%2A%20b44%3B%0A%20%20%20%20te%5B1%5D%20%3D%20a21%20%2A%20b11%20%2B%20a22%20%2A%20b21%20%2B%20a23%20%2A%20b31%20%2B%20a24%20%2A%20b41%3B%0A%20%20%20%20te%5B5%5D%20%3D%20a21%20%2A%20b12%20%2B%20a22%20%2A%20b22%20%2B%20a23%20%2A%20b32%20%2B%20a24%20%2A%20b42%3B%0A%20%20%20%20te%5B9%5D%20%3D%20a21%20%2A%20b13%20%2B%20a22%20%2A%20b23%20%2B%20a23%20%2A%20b33%20%2B%20a24%20%2A%20b43%3B%0A%20%20%20%20te%5B13%5D%20%3D%20a21%20%2A%20b14%20%2B%20a22%20%2A%20b24%20%2B%20a23%20%2A%20b34%20%2B%20a24%20%2A%20b44%3B%0A%20%20%20%20te%5B2%5D%20%3D%20a31%20%2A%20b11%20%2B%20a32%20%2A%20b21%20%2B%20a33%20%2A%20b31%20%2B%20a34%20%2A%20b41%3B%0A%20%20%20%20te%5B6%5D%20%3D%20a31%20%2A%20b12%20%2B%20a32%20%2A%20b22%20%2B%20a33%20%2A%20b32%20%2B%20a34%20%2A%20b42%3B%0A%20%20%20%20te%5B10%5D%20%3D%20a31%20%2A%20b13%20%2B%20a32%20%2A%20b23%20%2B%20a33%20%2A%20b33%20%2B%20a34%20%2A%20b43%3B%0A%20%20%20%20te%5B14%5D%20%3D%20a31%20%2A%20b14%20%2B%20a32%20%2A%20b24%20%2B%20a33%20%2A%20b34%20%2B%20a34%20%2A%20b44%3B%0A%20%20%20%20te%5B3%5D%20%3D%20a41%20%2A%20b11%20%2B%20a42%20%2A%20b21%20%2B%20a43%20%2A%20b31%20%2B%20a44%20%2A%20b41%3B%0A%20%20%20%20te%5B7%5D%20%3D%20a41%20%2A%20b12%20%2B%20a42%20%2A%20b22%20%2B%20a43%20%2A%20b32%20%2B%20a44%20%2A%20b42%3B%0A%20%20%20%20te%5B11%5D%20%3D%20a41%20%2A%20b13%20%2B%20a42%20%2A%20b23%20%2B%20a43%20%2A%20b33%20%2B%20a44%20%2A%20b43%3B%0A%20%20%20%20te%5B15%5D%20%3D%20a41%20%2A%20b14%20%2B%20a42%20%2A%20b24%20%2B%20a43%20%2A%20b34%20%2B%20a44%20%2A%20b44%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28s%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20te%5B0%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B4%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B8%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B12%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B1%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B5%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B9%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B13%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B2%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B6%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B10%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B14%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B3%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B7%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B11%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B15%5D%20%2A%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20determinant%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20n11%20%3D%20te%5B0%5D%2C%20n12%20%3D%20te%5B4%5D%2C%20n13%20%3D%20te%5B8%5D%2C%20n14%20%3D%20te%5B12%5D%3B%0A%20%20%20%20const%20n21%20%3D%20te%5B1%5D%2C%20n22%20%3D%20te%5B5%5D%2C%20n23%20%3D%20te%5B9%5D%2C%20n24%20%3D%20te%5B13%5D%3B%0A%20%20%20%20const%20n31%20%3D%20te%5B2%5D%2C%20n32%20%3D%20te%5B6%5D%2C%20n33%20%3D%20te%5B10%5D%2C%20n34%20%3D%20te%5B14%5D%3B%0A%20%20%20%20const%20n41%20%3D%20te%5B3%5D%2C%20n42%20%3D%20te%5B7%5D%2C%20n43%20%3D%20te%5B11%5D%2C%20n44%20%3D%20te%5B15%5D%3B%0A%20%20%20%20return%20n41%20%2A%20%28%2Bn14%20%2A%20n23%20%2A%20n32%20-%20n13%20%2A%20n24%20%2A%20n32%20-%20n14%20%2A%20n22%20%2A%20n33%20%2B%20n12%20%2A%20n24%20%2A%20n33%20%2B%20n13%20%2A%20n22%20%2A%20n34%20-%20n12%20%2A%20n23%20%2A%20n34%29%20%2B%20n42%20%2A%20%28%2Bn11%20%2A%20n23%20%2A%20n34%20-%20n11%20%2A%20n24%20%2A%20n33%20%2B%20n14%20%2A%20n21%20%2A%20n33%20-%20n13%20%2A%20n21%20%2A%20n34%20%2B%20n13%20%2A%20n24%20%2A%20n31%20-%20n14%20%2A%20n23%20%2A%20n31%29%20%2B%20n43%20%2A%20%28%2Bn11%20%2A%20n24%20%2A%20n32%20-%20n11%20%2A%20n22%20%2A%20n34%20-%20n14%20%2A%20n21%20%2A%20n32%20%2B%20n12%20%2A%20n21%20%2A%20n34%20%2B%20n14%20%2A%20n22%20%2A%20n31%20-%20n12%20%2A%20n24%20%2A%20n31%29%20%2B%20n44%20%2A%20%28-n13%20%2A%20n22%20%2A%20n31%20-%20n11%20%2A%20n23%20%2A%20n32%20%2B%20n11%20%2A%20n22%20%2A%20n33%20%2B%20n13%20%2A%20n21%20%2A%20n32%20-%20n12%20%2A%20n21%20%2A%20n33%20%2B%20n12%20%2A%20n23%20%2A%20n31%29%3B%0A%20%20%7D%0A%20%20transpose%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20let%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B1%5D%3B%0A%20%20%20%20te%5B1%5D%20%3D%20te%5B4%5D%3B%0A%20%20%20%20te%5B4%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B2%5D%3B%0A%20%20%20%20te%5B2%5D%20%3D%20te%5B8%5D%3B%0A%20%20%20%20te%5B8%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B6%5D%3B%0A%20%20%20%20te%5B6%5D%20%3D%20te%5B9%5D%3B%0A%20%20%20%20te%5B9%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B3%5D%3B%0A%20%20%20%20te%5B3%5D%20%3D%20te%5B12%5D%3B%0A%20%20%20%20te%5B12%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B7%5D%3B%0A%20%20%20%20te%5B7%5D%20%3D%20te%5B13%5D%3B%0A%20%20%20%20te%5B13%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B11%5D%3B%0A%20%20%20%20te%5B11%5D%20%3D%20te%5B14%5D%3B%0A%20%20%20%20te%5B14%5D%20%3D%20tmp2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setPosition%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20if%20%28x2.isVector3%29%20%7B%0A%20%20%20%20%20%20te%5B12%5D%20%3D%20x2.x%3B%0A%20%20%20%20%20%20te%5B13%5D%20%3D%20x2.y%3B%0A%20%20%20%20%20%20te%5B14%5D%20%3D%20x2.z%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20te%5B12%5D%20%3D%20x2%3B%0A%20%20%20%20%20%20te%5B13%5D%20%3D%20y2%3B%0A%20%20%20%20%20%20te%5B14%5D%20%3D%20z2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20invert%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%2C%20n11%20%3D%20te%5B0%5D%2C%20n21%20%3D%20te%5B1%5D%2C%20n31%20%3D%20te%5B2%5D%2C%20n41%20%3D%20te%5B3%5D%2C%20n12%20%3D%20te%5B4%5D%2C%20n22%20%3D%20te%5B5%5D%2C%20n32%20%3D%20te%5B6%5D%2C%20n42%20%3D%20te%5B7%5D%2C%20n13%20%3D%20te%5B8%5D%2C%20n23%20%3D%20te%5B9%5D%2C%20n33%20%3D%20te%5B10%5D%2C%20n43%20%3D%20te%5B11%5D%2C%20n14%20%3D%20te%5B12%5D%2C%20n24%20%3D%20te%5B13%5D%2C%20n34%20%3D%20te%5B14%5D%2C%20n44%20%3D%20te%5B15%5D%2C%20t11%20%3D%20n23%20%2A%20n34%20%2A%20n42%20-%20n24%20%2A%20n33%20%2A%20n42%20%2B%20n24%20%2A%20n32%20%2A%20n43%20-%20n22%20%2A%20n34%20%2A%20n43%20-%20n23%20%2A%20n32%20%2A%20n44%20%2B%20n22%20%2A%20n33%20%2A%20n44%2C%20t12%20%3D%20n14%20%2A%20n33%20%2A%20n42%20-%20n13%20%2A%20n34%20%2A%20n42%20-%20n14%20%2A%20n32%20%2A%20n43%20%2B%20n12%20%2A%20n34%20%2A%20n43%20%2B%20n13%20%2A%20n32%20%2A%20n44%20-%20n12%20%2A%20n33%20%2A%20n44%2C%20t13%20%3D%20n13%20%2A%20n24%20%2A%20n42%20-%20n14%20%2A%20n23%20%2A%20n42%20%2B%20n14%20%2A%20n22%20%2A%20n43%20-%20n12%20%2A%20n24%20%2A%20n43%20-%20n13%20%2A%20n22%20%2A%20n44%20%2B%20n12%20%2A%20n23%20%2A%20n44%2C%20t14%20%3D%20n14%20%2A%20n23%20%2A%20n32%20-%20n13%20%2A%20n24%20%2A%20n32%20-%20n14%20%2A%20n22%20%2A%20n33%20%2B%20n12%20%2A%20n24%20%2A%20n33%20%2B%20n13%20%2A%20n22%20%2A%20n34%20-%20n12%20%2A%20n23%20%2A%20n34%3B%0A%20%20%20%20const%20det%20%3D%20n11%20%2A%20t11%20%2B%20n21%20%2A%20t12%20%2B%20n31%20%2A%20t13%20%2B%20n41%20%2A%20t14%3B%0A%20%20%20%20if%20%28det%20%3D%3D%3D%200%29%20return%20this.set%280%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20const%20detInv%20%3D%201%20%2F%20det%3B%0A%20%20%20%20te%5B0%5D%20%3D%20t11%20%2A%20detInv%3B%0A%20%20%20%20te%5B1%5D%20%3D%20%28n24%20%2A%20n33%20%2A%20n41%20-%20n23%20%2A%20n34%20%2A%20n41%20-%20n24%20%2A%20n31%20%2A%20n43%20%2B%20n21%20%2A%20n34%20%2A%20n43%20%2B%20n23%20%2A%20n31%20%2A%20n44%20-%20n21%20%2A%20n33%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B2%5D%20%3D%20%28n22%20%2A%20n34%20%2A%20n41%20-%20n24%20%2A%20n32%20%2A%20n41%20%2B%20n24%20%2A%20n31%20%2A%20n42%20-%20n21%20%2A%20n34%20%2A%20n42%20-%20n22%20%2A%20n31%20%2A%20n44%20%2B%20n21%20%2A%20n32%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B3%5D%20%3D%20%28n23%20%2A%20n32%20%2A%20n41%20-%20n22%20%2A%20n33%20%2A%20n41%20-%20n23%20%2A%20n31%20%2A%20n42%20%2B%20n21%20%2A%20n33%20%2A%20n42%20%2B%20n22%20%2A%20n31%20%2A%20n43%20-%20n21%20%2A%20n32%20%2A%20n43%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B4%5D%20%3D%20t12%20%2A%20detInv%3B%0A%20%20%20%20te%5B5%5D%20%3D%20%28n13%20%2A%20n34%20%2A%20n41%20-%20n14%20%2A%20n33%20%2A%20n41%20%2B%20n14%20%2A%20n31%20%2A%20n43%20-%20n11%20%2A%20n34%20%2A%20n43%20-%20n13%20%2A%20n31%20%2A%20n44%20%2B%20n11%20%2A%20n33%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B6%5D%20%3D%20%28n14%20%2A%20n32%20%2A%20n41%20-%20n12%20%2A%20n34%20%2A%20n41%20-%20n14%20%2A%20n31%20%2A%20n42%20%2B%20n11%20%2A%20n34%20%2A%20n42%20%2B%20n12%20%2A%20n31%20%2A%20n44%20-%20n11%20%2A%20n32%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B7%5D%20%3D%20%28n12%20%2A%20n33%20%2A%20n41%20-%20n13%20%2A%20n32%20%2A%20n41%20%2B%20n13%20%2A%20n31%20%2A%20n42%20-%20n11%20%2A%20n33%20%2A%20n42%20-%20n12%20%2A%20n31%20%2A%20n43%20%2B%20n11%20%2A%20n32%20%2A%20n43%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B8%5D%20%3D%20t13%20%2A%20detInv%3B%0A%20%20%20%20te%5B9%5D%20%3D%20%28n14%20%2A%20n23%20%2A%20n41%20-%20n13%20%2A%20n24%20%2A%20n41%20-%20n14%20%2A%20n21%20%2A%20n43%20%2B%20n11%20%2A%20n24%20%2A%20n43%20%2B%20n13%20%2A%20n21%20%2A%20n44%20-%20n11%20%2A%20n23%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B10%5D%20%3D%20%28n12%20%2A%20n24%20%2A%20n41%20-%20n14%20%2A%20n22%20%2A%20n41%20%2B%20n14%20%2A%20n21%20%2A%20n42%20-%20n11%20%2A%20n24%20%2A%20n42%20-%20n12%20%2A%20n21%20%2A%20n44%20%2B%20n11%20%2A%20n22%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B11%5D%20%3D%20%28n13%20%2A%20n22%20%2A%20n41%20-%20n12%20%2A%20n23%20%2A%20n41%20-%20n13%20%2A%20n21%20%2A%20n42%20%2B%20n11%20%2A%20n23%20%2A%20n42%20%2B%20n12%20%2A%20n21%20%2A%20n43%20-%20n11%20%2A%20n22%20%2A%20n43%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B12%5D%20%3D%20t14%20%2A%20detInv%3B%0A%20%20%20%20te%5B13%5D%20%3D%20%28n13%20%2A%20n24%20%2A%20n31%20-%20n14%20%2A%20n23%20%2A%20n31%20%2B%20n14%20%2A%20n21%20%2A%20n33%20-%20n11%20%2A%20n24%20%2A%20n33%20-%20n13%20%2A%20n21%20%2A%20n34%20%2B%20n11%20%2A%20n23%20%2A%20n34%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B14%5D%20%3D%20%28n14%20%2A%20n22%20%2A%20n31%20-%20n12%20%2A%20n24%20%2A%20n31%20-%20n14%20%2A%20n21%20%2A%20n32%20%2B%20n11%20%2A%20n24%20%2A%20n32%20%2B%20n12%20%2A%20n21%20%2A%20n34%20-%20n11%20%2A%20n22%20%2A%20n34%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B15%5D%20%3D%20%28n12%20%2A%20n23%20%2A%20n31%20-%20n13%20%2A%20n22%20%2A%20n31%20%2B%20n13%20%2A%20n21%20%2A%20n32%20-%20n11%20%2A%20n23%20%2A%20n32%20-%20n12%20%2A%20n21%20%2A%20n33%20%2B%20n11%20%2A%20n22%20%2A%20n33%29%20%2A%20detInv%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20scale%28v%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20x2%20%3D%20v.x%2C%20y2%20%3D%20v.y%2C%20z2%20%3D%20v.z%3B%0A%20%20%20%20te%5B0%5D%20%2A%3D%20x2%3B%0A%20%20%20%20te%5B4%5D%20%2A%3D%20y2%3B%0A%20%20%20%20te%5B8%5D%20%2A%3D%20z2%3B%0A%20%20%20%20te%5B1%5D%20%2A%3D%20x2%3B%0A%20%20%20%20te%5B5%5D%20%2A%3D%20y2%3B%0A%20%20%20%20te%5B9%5D%20%2A%3D%20z2%3B%0A%20%20%20%20te%5B2%5D%20%2A%3D%20x2%3B%0A%20%20%20%20te%5B6%5D%20%2A%3D%20y2%3B%0A%20%20%20%20te%5B10%5D%20%2A%3D%20z2%3B%0A%20%20%20%20te%5B3%5D%20%2A%3D%20x2%3B%0A%20%20%20%20te%5B7%5D%20%2A%3D%20y2%3B%0A%20%20%20%20te%5B11%5D%20%2A%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getMaxScaleOnAxis%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20scaleXSq%20%3D%20te%5B0%5D%20%2A%20te%5B0%5D%20%2B%20te%5B1%5D%20%2A%20te%5B1%5D%20%2B%20te%5B2%5D%20%2A%20te%5B2%5D%3B%0A%20%20%20%20const%20scaleYSq%20%3D%20te%5B4%5D%20%2A%20te%5B4%5D%20%2B%20te%5B5%5D%20%2A%20te%5B5%5D%20%2B%20te%5B6%5D%20%2A%20te%5B6%5D%3B%0A%20%20%20%20const%20scaleZSq%20%3D%20te%5B8%5D%20%2A%20te%5B8%5D%20%2B%20te%5B9%5D%20%2A%20te%5B9%5D%20%2B%20te%5B10%5D%20%2A%20te%5B10%5D%3B%0A%20%20%20%20return%20Math.sqrt%28Math.max%28scaleXSq%2C%20scaleYSq%2C%20scaleZSq%29%29%3B%0A%20%20%7D%0A%20%20makeTranslation%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28x2.isVector3%29%20%7B%0A%20%20%20%20%20%20this.set%28%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2.x%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2.y%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20x2.z%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.set%28%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20z2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationX%28theta%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28theta%29%2C%20s%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%20-s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20s%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationY%28theta%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28theta%29%2C%20s%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationZ%28theta%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28theta%29%2C%20s%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%20-s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20s%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationAxis%28axis%2C%20angle%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28angle%29%3B%0A%20%20%20%20const%20s%20%3D%20Math.sin%28angle%29%3B%0A%20%20%20%20const%20t%20%3D%201%20-%20c2%3B%0A%20%20%20%20const%20x2%20%3D%20axis.x%2C%20y2%20%3D%20axis.y%2C%20z2%20%3D%20axis.z%3B%0A%20%20%20%20const%20tx%20%3D%20t%20%2A%20x2%2C%20ty%20%3D%20t%20%2A%20y2%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20tx%20%2A%20x2%20%2B%20c2%2C%0A%20%20%20%20%20%20tx%20%2A%20y2%20-%20s%20%2A%20z2%2C%0A%20%20%20%20%20%20tx%20%2A%20z2%20%2B%20s%20%2A%20y2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20tx%20%2A%20y2%20%2B%20s%20%2A%20z2%2C%0A%20%20%20%20%20%20ty%20%2A%20y2%20%2B%20c2%2C%0A%20%20%20%20%20%20ty%20%2A%20z2%20-%20s%20%2A%20x2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20tx%20%2A%20z2%20-%20s%20%2A%20y2%2C%0A%20%20%20%20%20%20ty%20%2A%20z2%20%2B%20s%20%2A%20x2%2C%0A%20%20%20%20%20%20t%20%2A%20z2%20%2A%20z2%20%2B%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeScale%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20z2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeShear%28xy%2C%20xz%2C%20yx%2C%20yz%2C%20zx%2C%20zy%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20yx%2C%0A%20%20%20%20%20%20zx%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20xy%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20zy%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20xz%2C%0A%20%20%20%20%20%20yz%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20compose%28position%2C%20quaternion%2C%20scale%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20x2%20%3D%20quaternion._x%2C%20y2%20%3D%20quaternion._y%2C%20z2%20%3D%20quaternion._z%2C%20w%20%3D%20quaternion._w%3B%0A%20%20%20%20const%20x22%20%3D%20x2%20%2B%20x2%2C%20y22%20%3D%20y2%20%2B%20y2%2C%20z22%20%3D%20z2%20%2B%20z2%3B%0A%20%20%20%20const%20xx%20%3D%20x2%20%2A%20x22%2C%20xy%20%3D%20x2%20%2A%20y22%2C%20xz%20%3D%20x2%20%2A%20z22%3B%0A%20%20%20%20const%20yy%20%3D%20y2%20%2A%20y22%2C%20yz%20%3D%20y2%20%2A%20z22%2C%20zz%20%3D%20z2%20%2A%20z22%3B%0A%20%20%20%20const%20wx%20%3D%20w%20%2A%20x22%2C%20wy%20%3D%20w%20%2A%20y22%2C%20wz%20%3D%20w%20%2A%20z22%3B%0A%20%20%20%20const%20sx%20%3D%20scale.x%2C%20sy%20%3D%20scale.y%2C%20sz%20%3D%20scale.z%3B%0A%20%20%20%20te%5B0%5D%20%3D%20%281%20-%20%28yy%20%2B%20zz%29%29%20%2A%20sx%3B%0A%20%20%20%20te%5B1%5D%20%3D%20%28xy%20%2B%20wz%29%20%2A%20sx%3B%0A%20%20%20%20te%5B2%5D%20%3D%20%28xz%20-%20wy%29%20%2A%20sx%3B%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B4%5D%20%3D%20%28xy%20-%20wz%29%20%2A%20sy%3B%0A%20%20%20%20te%5B5%5D%20%3D%20%281%20-%20%28xx%20%2B%20zz%29%29%20%2A%20sy%3B%0A%20%20%20%20te%5B6%5D%20%3D%20%28yz%20%2B%20wx%29%20%2A%20sy%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B8%5D%20%3D%20%28xz%20%2B%20wy%29%20%2A%20sz%3B%0A%20%20%20%20te%5B9%5D%20%3D%20%28yz%20-%20wx%29%20%2A%20sz%3B%0A%20%20%20%20te%5B10%5D%20%3D%20%281%20-%20%28xx%20%2B%20yy%29%29%20%2A%20sz%3B%0A%20%20%20%20te%5B11%5D%20%3D%200%3B%0A%20%20%20%20te%5B12%5D%20%3D%20position.x%3B%0A%20%20%20%20te%5B13%5D%20%3D%20position.y%3B%0A%20%20%20%20te%5B14%5D%20%3D%20position.z%3B%0A%20%20%20%20te%5B15%5D%20%3D%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20decompose%28position%2C%20quaternion%2C%20scale%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20let%20sx%20%3D%20_v1%245.set%28te%5B0%5D%2C%20te%5B1%5D%2C%20te%5B2%5D%29.length%28%29%3B%0A%20%20%20%20const%20sy%20%3D%20_v1%245.set%28te%5B4%5D%2C%20te%5B5%5D%2C%20te%5B6%5D%29.length%28%29%3B%0A%20%20%20%20const%20sz%20%3D%20_v1%245.set%28te%5B8%5D%2C%20te%5B9%5D%2C%20te%5B10%5D%29.length%28%29%3B%0A%20%20%20%20const%20det%20%3D%20this.determinant%28%29%3B%0A%20%20%20%20if%20%28det%20%3C%200%29%20sx%20%3D%20-sx%3B%0A%20%20%20%20position.x%20%3D%20te%5B12%5D%3B%0A%20%20%20%20position.y%20%3D%20te%5B13%5D%3B%0A%20%20%20%20position.z%20%3D%20te%5B14%5D%3B%0A%20%20%20%20_m1%244.copy%28this%29%3B%0A%20%20%20%20const%20invSX%20%3D%201%20%2F%20sx%3B%0A%20%20%20%20const%20invSY%20%3D%201%20%2F%20sy%3B%0A%20%20%20%20const%20invSZ%20%3D%201%20%2F%20sz%3B%0A%20%20%20%20_m1%244.elements%5B0%5D%20%2A%3D%20invSX%3B%0A%20%20%20%20_m1%244.elements%5B1%5D%20%2A%3D%20invSX%3B%0A%20%20%20%20_m1%244.elements%5B2%5D%20%2A%3D%20invSX%3B%0A%20%20%20%20_m1%244.elements%5B4%5D%20%2A%3D%20invSY%3B%0A%20%20%20%20_m1%244.elements%5B5%5D%20%2A%3D%20invSY%3B%0A%20%20%20%20_m1%244.elements%5B6%5D%20%2A%3D%20invSY%3B%0A%20%20%20%20_m1%244.elements%5B8%5D%20%2A%3D%20invSZ%3B%0A%20%20%20%20_m1%244.elements%5B9%5D%20%2A%3D%20invSZ%3B%0A%20%20%20%20_m1%244.elements%5B10%5D%20%2A%3D%20invSZ%3B%0A%20%20%20%20quaternion.setFromRotationMatrix%28_m1%244%29%3B%0A%20%20%20%20scale.x%20%3D%20sx%3B%0A%20%20%20%20scale.y%20%3D%20sy%3B%0A%20%20%20%20scale.z%20%3D%20sz%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makePerspective%28left%2C%20right%2C%20top%2C%20bottom%2C%20near%2C%20far%2C%20coordinateSystem%20%3D%20WebGLCoordinateSystem%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20x2%20%3D%202%20%2A%20near%20%2F%20%28right%20-%20left%29%3B%0A%20%20%20%20const%20y2%20%3D%202%20%2A%20near%20%2F%20%28top%20-%20bottom%29%3B%0A%20%20%20%20const%20a2%20%3D%20%28right%20%2B%20left%29%20%2F%20%28right%20-%20left%29%3B%0A%20%20%20%20const%20b%20%3D%20%28top%20%2B%20bottom%29%20%2F%20%28top%20-%20bottom%29%3B%0A%20%20%20%20let%20c2%2C%20d%3B%0A%20%20%20%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem%29%20%7B%0A%20%20%20%20%20%20c2%20%3D%20-%28far%20%2B%20near%29%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20%20%20d%20%3D%20-2%20%2A%20far%20%2A%20near%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20%7D%20else%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem%29%20%7B%0A%20%20%20%20%20%20c2%20%3D%20-far%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20%20%20d%20%3D%20-far%20%2A%20near%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.Matrix4.makePerspective%28%29%3A%20Invalid%20coordinate%20system%3A%20%22%20%2B%20coordinateSystem%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20te%5B0%5D%20%3D%20x2%3B%0A%20%20%20%20te%5B4%5D%20%3D%200%3B%0A%20%20%20%20te%5B8%5D%20%3D%20a2%3B%0A%20%20%20%20te%5B12%5D%20%3D%200%3B%0A%20%20%20%20te%5B1%5D%20%3D%200%3B%0A%20%20%20%20te%5B5%5D%20%3D%20y2%3B%0A%20%20%20%20te%5B9%5D%20%3D%20b%3B%0A%20%20%20%20te%5B13%5D%20%3D%200%3B%0A%20%20%20%20te%5B2%5D%20%3D%200%3B%0A%20%20%20%20te%5B6%5D%20%3D%200%3B%0A%20%20%20%20te%5B10%5D%20%3D%20c2%3B%0A%20%20%20%20te%5B14%5D%20%3D%20d%3B%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B11%5D%20%3D%20-1%3B%0A%20%20%20%20te%5B15%5D%20%3D%200%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeOrthographic%28left%2C%20right%2C%20top%2C%20bottom%2C%20near%2C%20far%2C%20coordinateSystem%20%3D%20WebGLCoordinateSystem%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20w%20%3D%201%20%2F%20%28right%20-%20left%29%3B%0A%20%20%20%20const%20h%20%3D%201%20%2F%20%28top%20-%20bottom%29%3B%0A%20%20%20%20const%20p%20%3D%201%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20const%20x2%20%3D%20%28right%20%2B%20left%29%20%2A%20w%3B%0A%20%20%20%20const%20y2%20%3D%20%28top%20%2B%20bottom%29%20%2A%20h%3B%0A%20%20%20%20let%20z2%2C%20zInv%3B%0A%20%20%20%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem%29%20%7B%0A%20%20%20%20%20%20z2%20%3D%20%28far%20%2B%20near%29%20%2A%20p%3B%0A%20%20%20%20%20%20zInv%20%3D%20-2%20%2A%20p%3B%0A%20%20%20%20%7D%20else%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem%29%20%7B%0A%20%20%20%20%20%20z2%20%3D%20near%20%2A%20p%3B%0A%20%20%20%20%20%20zInv%20%3D%20-1%20%2A%20p%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.Matrix4.makeOrthographic%28%29%3A%20Invalid%20coordinate%20system%3A%20%22%20%2B%20coordinateSystem%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20te%5B0%5D%20%3D%202%20%2A%20w%3B%0A%20%20%20%20te%5B4%5D%20%3D%200%3B%0A%20%20%20%20te%5B8%5D%20%3D%200%3B%0A%20%20%20%20te%5B12%5D%20%3D%20-x2%3B%0A%20%20%20%20te%5B1%5D%20%3D%200%3B%0A%20%20%20%20te%5B5%5D%20%3D%202%20%2A%20h%3B%0A%20%20%20%20te%5B9%5D%20%3D%200%3B%0A%20%20%20%20te%5B13%5D%20%3D%20-y2%3B%0A%20%20%20%20te%5B2%5D%20%3D%200%3B%0A%20%20%20%20te%5B6%5D%20%3D%200%3B%0A%20%20%20%20te%5B10%5D%20%3D%20zInv%3B%0A%20%20%20%20te%5B14%5D%20%3D%20-z2%3B%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B11%5D%20%3D%200%3B%0A%20%20%20%20te%5B15%5D%20%3D%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28matrix%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20matrix.elements%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%2016%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28te%5Bi%5D%20%21%3D%3D%20me%5Bi%5D%29%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%2016%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.elements%5Bi%5D%20%3D%20array%5Bi%20%2B%20offset%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20array%5Boffset%5D%20%3D%20te%5B0%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20te%5B1%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20te%5B2%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20te%5B3%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%204%5D%20%3D%20te%5B4%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%205%5D%20%3D%20te%5B5%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%206%5D%20%3D%20te%5B6%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%207%5D%20%3D%20te%5B7%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%208%5D%20%3D%20te%5B8%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%209%5D%20%3D%20te%5B9%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2010%5D%20%3D%20te%5B10%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2011%5D%20%3D%20te%5B11%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2012%5D%20%3D%20te%5B12%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2013%5D%20%3D%20te%5B13%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2014%5D%20%3D%20te%5B14%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2015%5D%20%3D%20te%5B15%5D%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_v1%245%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_m1%244%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Avar%20_zero%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%280%2C%200%2C%200%29%3B%0Avar%20_one%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%281%2C%201%2C%201%29%3B%0Avar%20_x%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_y%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_z%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_matrix%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Avar%20_quaternion%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Quaternion%28%29%3B%0Avar%20Euler%20%3D%20class%20_Euler%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%2C%20z2%20%3D%200%2C%20order%20%3D%20_Euler.DEFAULT_ORDER%29%20%7B%0A%20%20%20%20this.isEuler%20%3D%20true%3B%0A%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20this._order%20%3D%20order%3B%0A%20%20%7D%0A%20%20get%20x%28%29%20%7B%0A%20%20%20%20return%20this._x%3B%0A%20%20%7D%0A%20%20set%20x%28value%29%20%7B%0A%20%20%20%20this._x%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20y%28%29%20%7B%0A%20%20%20%20return%20this._y%3B%0A%20%20%7D%0A%20%20set%20y%28value%29%20%7B%0A%20%20%20%20this._y%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20z%28%29%20%7B%0A%20%20%20%20return%20this._z%3B%0A%20%20%7D%0A%20%20set%20z%28value%29%20%7B%0A%20%20%20%20this._z%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20order%28%29%20%7B%0A%20%20%20%20return%20this._order%3B%0A%20%20%7D%0A%20%20set%20order%28value%29%20%7B%0A%20%20%20%20this._order%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%2C%20z2%2C%20order%20%3D%20this._order%29%20%7B%0A%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20this._order%20%3D%20order%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this._x%2C%20this._y%2C%20this._z%2C%20this._order%29%3B%0A%20%20%7D%0A%20%20copy%28euler%29%20%7B%0A%20%20%20%20this._x%20%3D%20euler._x%3B%0A%20%20%20%20this._y%20%3D%20euler._y%3B%0A%20%20%20%20this._z%20%3D%20euler._z%3B%0A%20%20%20%20this._order%20%3D%20euler._order%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromRotationMatrix%28m2%2C%20order%20%3D%20this._order%2C%20update4%20%3D%20true%29%20%7B%0A%20%20%20%20const%20te%20%3D%20m2.elements%3B%0A%20%20%20%20const%20m11%20%3D%20te%5B0%5D%2C%20m12%20%3D%20te%5B4%5D%2C%20m13%20%3D%20te%5B8%5D%3B%0A%20%20%20%20const%20m21%20%3D%20te%5B1%5D%2C%20m22%20%3D%20te%5B5%5D%2C%20m23%20%3D%20te%5B9%5D%3B%0A%20%20%20%20const%20m31%20%3D%20te%5B2%5D%2C%20m32%20%3D%20te%5B6%5D%2C%20m33%20%3D%20te%5B10%5D%3B%0A%20%20%20%20switch%20%28order%29%20%7B%0A%20%20%20%20%20%20case%20%22XYZ%22%3A%0A%20%20%20%20%20%20%20%20this._y%20%3D%20Math.asin%28clamp%28m13%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m13%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28-m23%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28-m12%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28m32%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22YXZ%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20Math.asin%28-clamp%28m23%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m23%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28m13%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28m21%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28-m31%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22ZXY%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20Math.asin%28clamp%28m32%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m32%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28-m31%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28-m12%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28m21%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22ZYX%22%3A%0A%20%20%20%20%20%20%20%20this._y%20%3D%20Math.asin%28-clamp%28m31%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m31%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28m32%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28m21%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28-m12%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22YZX%22%3A%0A%20%20%20%20%20%20%20%20this._z%20%3D%20Math.asin%28clamp%28m21%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m21%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28-m23%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28-m31%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28m13%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22XZY%22%3A%0A%20%20%20%20%20%20%20%20this._z%20%3D%20Math.asin%28-clamp%28m12%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m12%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28m32%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28m13%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28-m23%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.Euler%3A%20.setFromRotationMatrix%28%29%20encountered%20an%20unknown%20order%3A%20%22%20%2B%20order%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._order%20%3D%20order%3B%0A%20%20%20%20if%20%28update4%20%3D%3D%3D%20true%29%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromQuaternion%28q%2C%20order%2C%20update4%29%20%7B%0A%20%20%20%20_matrix%242.makeRotationFromQuaternion%28q%29%3B%0A%20%20%20%20return%20this.setFromRotationMatrix%28_matrix%242%2C%20order%2C%20update4%29%3B%0A%20%20%7D%0A%20%20setFromVector3%28v%2C%20order%20%3D%20this._order%29%20%7B%0A%20%20%20%20return%20this.set%28v.x%2C%20v.y%2C%20v.z%2C%20order%29%3B%0A%20%20%7D%0A%20%20reorder%28newOrder%29%20%7B%0A%20%20%20%20_quaternion%243.setFromEuler%28this%29%3B%0A%20%20%20%20return%20this.setFromQuaternion%28_quaternion%243%2C%20newOrder%29%3B%0A%20%20%7D%0A%20%20equals%28euler%29%20%7B%0A%20%20%20%20return%20euler._x%20%3D%3D%3D%20this._x%20%26%26%20euler._y%20%3D%3D%3D%20this._y%20%26%26%20euler._z%20%3D%3D%3D%20this._z%20%26%26%20euler._order%20%3D%3D%3D%20this._order%3B%0A%20%20%7D%0A%20%20fromArray%28array%29%20%7B%0A%20%20%20%20this._x%20%3D%20array%5B0%5D%3B%0A%20%20%20%20this._y%20%3D%20array%5B1%5D%3B%0A%20%20%20%20this._z%20%3D%20array%5B2%5D%3B%0A%20%20%20%20if%20%28array%5B3%5D%20%21%3D%3D%20void%200%29%20this._order%20%3D%20array%5B3%5D%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this._x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this._y%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this._z%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20this._order%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20_onChange%28callback%29%20%7B%0A%20%20%20%20this._onChangeCallback%20%3D%20callback%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20_onChangeCallback%28%29%20%7B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this._x%3B%0A%20%20%20%20yield%20this._y%3B%0A%20%20%20%20yield%20this._z%3B%0A%20%20%20%20yield%20this._order%3B%0A%20%20%7D%0A%7D%3B%0AEuler.DEFAULT_ORDER%20%3D%20%22XYZ%22%3B%0Avar%20Layers%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.mask%20%3D%201%20%7C%200%3B%0A%20%20%7D%0A%20%20set%28channel%29%20%7B%0A%20%20%20%20this.mask%20%3D%20%281%20%3C%3C%20channel%20%7C%200%29%20%3E%3E%3E%200%3B%0A%20%20%7D%0A%20%20enable%28channel%29%20%7B%0A%20%20%20%20this.mask%20%7C%3D%201%20%3C%3C%20channel%20%7C%200%3B%0A%20%20%7D%0A%20%20enableAll%28%29%20%7B%0A%20%20%20%20this.mask%20%3D%204294967295%20%7C%200%3B%0A%20%20%7D%0A%20%20toggle%28channel%29%20%7B%0A%20%20%20%20this.mask%20%5E%3D%201%20%3C%3C%20channel%20%7C%200%3B%0A%20%20%7D%0A%20%20disable%28channel%29%20%7B%0A%20%20%20%20this.mask%20%26%3D%20~%281%20%3C%3C%20channel%20%7C%200%29%3B%0A%20%20%7D%0A%20%20disableAll%28%29%20%7B%0A%20%20%20%20this.mask%20%3D%200%3B%0A%20%20%7D%0A%20%20test%28layers%29%20%7B%0A%20%20%20%20return%20%28this.mask%20%26%20layers.mask%29%20%21%3D%3D%200%3B%0A%20%20%7D%0A%20%20isEnabled%28channel%29%20%7B%0A%20%20%20%20return%20%28this.mask%20%26%20%281%20%3C%3C%20channel%20%7C%200%29%29%20%21%3D%3D%200%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_object3DId%20%3D%200%3B%0Avar%20_v1%244%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_q1%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Quaternion%28%29%3B%0Avar%20_m1%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Avar%20_target%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_position%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_scale%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_quaternion%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Quaternion%28%29%3B%0Avar%20_xAxis%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%281%2C%200%2C%200%29%3B%0Avar%20_yAxis%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%280%2C%201%2C%200%29%3B%0Avar%20_zAxis%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%280%2C%200%2C%201%29%3B%0Avar%20_addedEvent%20%3D%20%7B%20type%3A%20%22added%22%20%7D%3B%0Avar%20_removedEvent%20%3D%20%7B%20type%3A%20%22removed%22%20%7D%3B%0Avar%20_childaddedEvent%20%3D%20%7B%20type%3A%20%22childadded%22%2C%20child%3A%20null%20%7D%3B%0Avar%20_childremovedEvent%20%3D%20%7B%20type%3A%20%22childremoved%22%2C%20child%3A%20null%20%7D%3B%0Avar%20Object3D%20%3D%20class%20_Object3D%20extends%20EventDispatcher%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isObject3D%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_object3DId%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID%28%29%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.type%20%3D%20%22Object3D%22%3B%0A%20%20%20%20this.parent%20%3D%20null%3B%0A%20%20%20%20this.children%20%3D%20%5B%5D%3B%0A%20%20%20%20this.up%20%3D%20_Object3D.DEFAULT_UP.clone%28%29%3B%0A%20%20%20%20const%20position%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20rotation%20%3D%20new%20Euler%28%29%3B%0A%20%20%20%20const%20quaternion%20%3D%20new%20Quaternion%28%29%3B%0A%20%20%20%20const%20scale%20%3D%20new%20Vector3%281%2C%201%2C%201%29%3B%0A%20%20%20%20function%20onRotationChange%28%29%20%7B%0A%20%20%20%20%20%20quaternion.setFromEuler%28rotation%2C%20false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20onQuaternionChange%28%29%20%7B%0A%20%20%20%20%20%20rotation.setFromQuaternion%28quaternion%2C%20void%200%2C%20false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20rotation._onChange%28onRotationChange%29%3B%0A%20%20%20%20quaternion._onChange%28onQuaternionChange%29%3B%0A%20%20%20%20Object.defineProperties%28this%2C%20%7B%0A%20%20%20%20%20%20position%3A%20%7B%0A%20%20%20%20%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20%20%20%20%20value%3A%20position%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20rotation%3A%20%7B%0A%20%20%20%20%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20%20%20%20%20value%3A%20rotation%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20quaternion%3A%20%7B%0A%20%20%20%20%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20%20%20%20%20value%3A%20quaternion%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20scale%3A%20%7B%0A%20%20%20%20%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20%20%20%20%20value%3A%20scale%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20modelViewMatrix%3A%20%7B%0A%20%20%20%20%20%20%20%20value%3A%20new%20Matrix4%28%29%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20normalMatrix%3A%20%7B%0A%20%20%20%20%20%20%20%20value%3A%20new%20Matrix3%28%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.matrix%20%3D%20new%20Matrix4%28%29%3B%0A%20%20%20%20this.matrixWorld%20%3D%20new%20Matrix4%28%29%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20_Object3D.DEFAULT_MATRIX_AUTO_UPDATE%3B%0A%20%20%20%20this.matrixWorldAutoUpdate%20%3D%20_Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE%3B%0A%20%20%20%20this.matrixWorldNeedsUpdate%20%3D%20false%3B%0A%20%20%20%20this.layers%20%3D%20new%20Layers%28%29%3B%0A%20%20%20%20this.visible%20%3D%20true%3B%0A%20%20%20%20this.castShadow%20%3D%20false%3B%0A%20%20%20%20this.receiveShadow%20%3D%20false%3B%0A%20%20%20%20this.frustumCulled%20%3D%20true%3B%0A%20%20%20%20this.renderOrder%20%3D%200%3B%0A%20%20%20%20this.animations%20%3D%20%5B%5D%3B%0A%20%20%20%20this.userData%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20onBeforeShadow%28%29%20%7B%0A%20%20%7D%0A%20%20onAfterShadow%28%29%20%7B%0A%20%20%7D%0A%20%20onBeforeRender%28%29%20%7B%0A%20%20%7D%0A%20%20onAfterRender%28%29%20%7B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%29%20%7B%0A%20%20%20%20if%20%28this.matrixAutoUpdate%29%20this.updateMatrix%28%29%3B%0A%20%20%20%20this.matrix.premultiply%28matrix%29%3B%0A%20%20%20%20this.matrix.decompose%28this.position%2C%20this.quaternion%2C%20this.scale%29%3B%0A%20%20%7D%0A%20%20applyQuaternion%28q%29%20%7B%0A%20%20%20%20this.quaternion.premultiply%28q%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setRotationFromAxisAngle%28axis%2C%20angle%29%20%7B%0A%20%20%20%20this.quaternion.setFromAxisAngle%28axis%2C%20angle%29%3B%0A%20%20%7D%0A%20%20setRotationFromEuler%28euler%29%20%7B%0A%20%20%20%20this.quaternion.setFromEuler%28euler%2C%20true%29%3B%0A%20%20%7D%0A%20%20setRotationFromMatrix%28m2%29%20%7B%0A%20%20%20%20this.quaternion.setFromRotationMatrix%28m2%29%3B%0A%20%20%7D%0A%20%20setRotationFromQuaternion%28q%29%20%7B%0A%20%20%20%20this.quaternion.copy%28q%29%3B%0A%20%20%7D%0A%20%20rotateOnAxis%28axis%2C%20angle%29%20%7B%0A%20%20%20%20_q1.setFromAxisAngle%28axis%2C%20angle%29%3B%0A%20%20%20%20this.quaternion.multiply%28_q1%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateOnWorldAxis%28axis%2C%20angle%29%20%7B%0A%20%20%20%20_q1.setFromAxisAngle%28axis%2C%20angle%29%3B%0A%20%20%20%20this.quaternion.premultiply%28_q1%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateX%28angle%29%20%7B%0A%20%20%20%20return%20this.rotateOnAxis%28_xAxis%2C%20angle%29%3B%0A%20%20%7D%0A%20%20rotateY%28angle%29%20%7B%0A%20%20%20%20return%20this.rotateOnAxis%28_yAxis%2C%20angle%29%3B%0A%20%20%7D%0A%20%20rotateZ%28angle%29%20%7B%0A%20%20%20%20return%20this.rotateOnAxis%28_zAxis%2C%20angle%29%3B%0A%20%20%7D%0A%20%20translateOnAxis%28axis%2C%20distance2%29%20%7B%0A%20%20%20%20_v1%244.copy%28axis%29.applyQuaternion%28this.quaternion%29%3B%0A%20%20%20%20this.position.add%28_v1%244.multiplyScalar%28distance2%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translateX%28distance2%29%20%7B%0A%20%20%20%20return%20this.translateOnAxis%28_xAxis%2C%20distance2%29%3B%0A%20%20%7D%0A%20%20translateY%28distance2%29%20%7B%0A%20%20%20%20return%20this.translateOnAxis%28_yAxis%2C%20distance2%29%3B%0A%20%20%7D%0A%20%20translateZ%28distance2%29%20%7B%0A%20%20%20%20return%20this.translateOnAxis%28_zAxis%2C%20distance2%29%3B%0A%20%20%7D%0A%20%20localToWorld%28vector%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20return%20vector.applyMatrix4%28this.matrixWorld%29%3B%0A%20%20%7D%0A%20%20worldToLocal%28vector%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20return%20vector.applyMatrix4%28_m1%243.copy%28this.matrixWorld%29.invert%28%29%29%3B%0A%20%20%7D%0A%20%20lookAt%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28x2.isVector3%29%20%7B%0A%20%20%20%20%20%20_target.copy%28x2%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_target.set%28x2%2C%20y2%2C%20z2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20parent%20%3D%20this.parent%3B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20_position%243.setFromMatrixPosition%28this.matrixWorld%29%3B%0A%20%20%20%20if%20%28this.isCamera%20%7C%7C%20this.isLight%29%20%7B%0A%20%20%20%20%20%20_m1%243.lookAt%28_position%243%2C%20_target%2C%20this.up%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_m1%243.lookAt%28_target%2C%20_position%243%2C%20this.up%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.quaternion.setFromRotationMatrix%28_m1%243%29%3B%0A%20%20%20%20if%20%28parent%29%20%7B%0A%20%20%20%20%20%20_m1%243.extractRotation%28parent.matrixWorld%29%3B%0A%20%20%20%20%20%20_q1.setFromRotationMatrix%28_m1%243%29%3B%0A%20%20%20%20%20%20this.quaternion.premultiply%28_q1.invert%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20add%28object%29%20%7B%0A%20%20%20%20if%20%28arguments.length%20%3E%201%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20arguments.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this.add%28arguments%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object%20%3D%3D%3D%20this%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.Object3D.add%3A%20object%20can%27t%20be%20added%20as%20a%20child%20of%20itself.%22%2C%20object%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object%20%26%26%20object.isObject3D%29%20%7B%0A%20%20%20%20%20%20object.removeFromParent%28%29%3B%0A%20%20%20%20%20%20object.parent%20%3D%20this%3B%0A%20%20%20%20%20%20this.children.push%28object%29%3B%0A%20%20%20%20%20%20object.dispatchEvent%28_addedEvent%29%3B%0A%20%20%20%20%20%20_childaddedEvent.child%20%3D%20object%3B%0A%20%20%20%20%20%20this.dispatchEvent%28_childaddedEvent%29%3B%0A%20%20%20%20%20%20_childaddedEvent.child%20%3D%20null%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.Object3D.add%3A%20object%20not%20an%20instance%20of%20THREE.Object3D.%22%2C%20object%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20remove%28object%29%20%7B%0A%20%20%20%20if%20%28arguments.length%20%3E%201%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20arguments.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this.remove%28arguments%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20index5%20%3D%20this.children.indexOf%28object%29%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20object.parent%20%3D%20null%3B%0A%20%20%20%20%20%20this.children.splice%28index5%2C%201%29%3B%0A%20%20%20%20%20%20object.dispatchEvent%28_removedEvent%29%3B%0A%20%20%20%20%20%20_childremovedEvent.child%20%3D%20object%3B%0A%20%20%20%20%20%20this.dispatchEvent%28_childremovedEvent%29%3B%0A%20%20%20%20%20%20_childremovedEvent.child%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20removeFromParent%28%29%20%7B%0A%20%20%20%20const%20parent%20%3D%20this.parent%3B%0A%20%20%20%20if%20%28parent%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20parent.remove%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clear%28%29%20%7B%0A%20%20%20%20return%20this.remove%28...this.children%29%3B%0A%20%20%7D%0A%20%20attach%28object%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20_m1%243.copy%28this.matrixWorld%29.invert%28%29%3B%0A%20%20%20%20if%20%28object.parent%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20object.parent.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20%20%20_m1%243.multiply%28object.parent.matrixWorld%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20object.applyMatrix4%28_m1%243%29%3B%0A%20%20%20%20object.removeFromParent%28%29%3B%0A%20%20%20%20object.parent%20%3D%20this%3B%0A%20%20%20%20this.children.push%28object%29%3B%0A%20%20%20%20object.updateWorldMatrix%28false%2C%20true%29%3B%0A%20%20%20%20object.dispatchEvent%28_addedEvent%29%3B%0A%20%20%20%20_childaddedEvent.child%20%3D%20object%3B%0A%20%20%20%20this.dispatchEvent%28_childaddedEvent%29%3B%0A%20%20%20%20_childaddedEvent.child%20%3D%20null%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getObjectById%28id2%29%20%7B%0A%20%20%20%20return%20this.getObjectByProperty%28%22id%22%2C%20id2%29%3B%0A%20%20%7D%0A%20%20getObjectByName%28name%29%20%7B%0A%20%20%20%20return%20this.getObjectByProperty%28%22name%22%2C%20name%29%3B%0A%20%20%7D%0A%20%20getObjectByProperty%28name%2C%20value%29%20%7B%0A%20%20%20%20if%20%28this%5Bname%5D%20%3D%3D%3D%20value%29%20return%20this%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20child%20%3D%20this.children%5Bi%5D%3B%0A%20%20%20%20%20%20const%20object%20%3D%20child.getObjectByProperty%28name%2C%20value%29%3B%0A%20%20%20%20%20%20if%20%28object%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20object%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20void%200%3B%0A%20%20%7D%0A%20%20getObjectsByProperty%28name%2C%20value%2C%20result%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20if%20%28this%5Bname%5D%20%3D%3D%3D%20value%29%20result.push%28this%29%3B%0A%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20children%5Bi%5D.getObjectsByProperty%28name%2C%20value%2C%20result%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20getWorldPosition%28target%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20return%20target.setFromMatrixPosition%28this.matrixWorld%29%3B%0A%20%20%7D%0A%20%20getWorldQuaternion%28target%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20this.matrixWorld.decompose%28_position%243%2C%20target%2C%20_scale%242%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getWorldScale%28target%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20this.matrixWorld.decompose%28_position%243%2C%20_quaternion%242%2C%20target%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getWorldDirection%28target%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20const%20e%20%3D%20this.matrixWorld.elements%3B%0A%20%20%20%20return%20target.set%28e%5B8%5D%2C%20e%5B9%5D%2C%20e%5B10%5D%29.normalize%28%29%3B%0A%20%20%7D%0A%20%20raycast%28%29%20%7B%0A%20%20%7D%0A%20%20traverse%28callback%29%20%7B%0A%20%20%20%20callback%28this%29%3B%0A%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20children%5Bi%5D.traverse%28callback%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20traverseVisible%28callback%29%20%7B%0A%20%20%20%20if%20%28this.visible%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20callback%28this%29%3B%0A%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20children%5Bi%5D.traverseVisible%28callback%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20traverseAncestors%28callback%29%20%7B%0A%20%20%20%20const%20parent%20%3D%20this.parent%3B%0A%20%20%20%20if%20%28parent%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20callback%28parent%29%3B%0A%20%20%20%20%20%20parent.traverseAncestors%28callback%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateMatrix%28%29%20%7B%0A%20%20%20%20this.matrix.compose%28this.position%2C%20this.quaternion%2C%20this.scale%29%3B%0A%20%20%20%20this.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20updateMatrixWorld%28force%29%20%7B%0A%20%20%20%20if%20%28this.matrixAutoUpdate%29%20this.updateMatrix%28%29%3B%0A%20%20%20%20if%20%28this.matrixWorldNeedsUpdate%20%7C%7C%20force%29%20%7B%0A%20%20%20%20%20%20if%20%28this.matrixWorldAutoUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.parent%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.matrixWorld.copy%28this.matrix%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.matrixWorld.multiplyMatrices%28this.parent.matrixWorld%2C%20this.matrix%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.matrixWorldNeedsUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20force%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20child%20%3D%20children%5Bi%5D%3B%0A%20%20%20%20%20%20child.updateMatrixWorld%28force%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateWorldMatrix%28updateParents%2C%20updateChildren%29%20%7B%0A%20%20%20%20const%20parent%20%3D%20this.parent%3B%0A%20%20%20%20if%20%28updateParents%20%3D%3D%3D%20true%20%26%26%20parent%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20parent.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.matrixAutoUpdate%29%20this.updateMatrix%28%29%3B%0A%20%20%20%20if%20%28this.matrixWorldAutoUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20if%20%28this.parent%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this.matrixWorld.copy%28this.matrix%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this.matrixWorld.multiplyMatrices%28this.parent.matrixWorld%2C%20this.matrix%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28updateChildren%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20child%20%3D%20children%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20child.updateWorldMatrix%28false%2C%20true%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20isRootObject%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20const%20output2%20%3D%20%7B%7D%3B%0A%20%20%20%20if%20%28isRootObject%29%20%7B%0A%20%20%20%20%20%20meta%20%3D%20%7B%0A%20%20%20%20%20%20%20%20geometries%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20materials%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20textures%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20images%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20shapes%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20skeletons%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20animations%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20nodes%3A%20%7B%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20output2.metadata%20%3D%20%7B%0A%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22Object%22%2C%0A%20%20%20%20%20%20%20%20generator%3A%20%22Object3D.toJSON%22%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20object%20%3D%20%7B%7D%3B%0A%20%20%20%20object.uuid%20%3D%20this.uuid%3B%0A%20%20%20%20object.type%20%3D%20this.type%3B%0A%20%20%20%20if%20%28this.name%20%21%3D%3D%20%22%22%29%20object.name%20%3D%20this.name%3B%0A%20%20%20%20if%20%28this.castShadow%20%3D%3D%3D%20true%29%20object.castShadow%20%3D%20true%3B%0A%20%20%20%20if%20%28this.receiveShadow%20%3D%3D%3D%20true%29%20object.receiveShadow%20%3D%20true%3B%0A%20%20%20%20if%20%28this.visible%20%3D%3D%3D%20false%29%20object.visible%20%3D%20false%3B%0A%20%20%20%20if%20%28this.frustumCulled%20%3D%3D%3D%20false%29%20object.frustumCulled%20%3D%20false%3B%0A%20%20%20%20if%20%28this.renderOrder%20%21%3D%3D%200%29%20object.renderOrder%20%3D%20this.renderOrder%3B%0A%20%20%20%20if%20%28Object.keys%28this.userData%29.length%20%3E%200%29%20object.userData%20%3D%20this.userData%3B%0A%20%20%20%20object.layers%20%3D%20this.layers.mask%3B%0A%20%20%20%20object.matrix%20%3D%20this.matrix.toArray%28%29%3B%0A%20%20%20%20object.up%20%3D%20this.up.toArray%28%29%3B%0A%20%20%20%20if%20%28this.matrixAutoUpdate%20%3D%3D%3D%20false%29%20object.matrixAutoUpdate%20%3D%20false%3B%0A%20%20%20%20if%20%28this.isInstancedMesh%29%20%7B%0A%20%20%20%20%20%20object.type%20%3D%20%22InstancedMesh%22%3B%0A%20%20%20%20%20%20object.count%20%3D%20this.count%3B%0A%20%20%20%20%20%20object.instanceMatrix%20%3D%20this.instanceMatrix.toJSON%28%29%3B%0A%20%20%20%20%20%20if%20%28this.instanceColor%20%21%3D%3D%20null%29%20object.instanceColor%20%3D%20this.instanceColor.toJSON%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.isBatchedMesh%29%20%7B%0A%20%20%20%20%20%20object.type%20%3D%20%22BatchedMesh%22%3B%0A%20%20%20%20%20%20object.perObjectFrustumCulled%20%3D%20this.perObjectFrustumCulled%3B%0A%20%20%20%20%20%20object.sortObjects%20%3D%20this.sortObjects%3B%0A%20%20%20%20%20%20object.drawRanges%20%3D%20this._drawRanges%3B%0A%20%20%20%20%20%20object.reservedRanges%20%3D%20this._reservedRanges%3B%0A%20%20%20%20%20%20object.visibility%20%3D%20this._visibility%3B%0A%20%20%20%20%20%20object.active%20%3D%20this._active%3B%0A%20%20%20%20%20%20object.bounds%20%3D%20this._bounds.map%28%28bound%29%20%3D%3E%20%28%7B%0A%20%20%20%20%20%20%20%20boxInitialized%3A%20bound.boxInitialized%2C%0A%20%20%20%20%20%20%20%20boxMin%3A%20bound.box.min.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20boxMax%3A%20bound.box.max.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20sphereInitialized%3A%20bound.sphereInitialized%2C%0A%20%20%20%20%20%20%20%20sphereRadius%3A%20bound.sphere.radius%2C%0A%20%20%20%20%20%20%20%20sphereCenter%3A%20bound.sphere.center.toArray%28%29%0A%20%20%20%20%20%20%7D%29%29%3B%0A%20%20%20%20%20%20object.maxInstanceCount%20%3D%20this._maxInstanceCount%3B%0A%20%20%20%20%20%20object.maxVertexCount%20%3D%20this._maxVertexCount%3B%0A%20%20%20%20%20%20object.maxIndexCount%20%3D%20this._maxIndexCount%3B%0A%20%20%20%20%20%20object.geometryInitialized%20%3D%20this._geometryInitialized%3B%0A%20%20%20%20%20%20object.geometryCount%20%3D%20this._geometryCount%3B%0A%20%20%20%20%20%20object.matricesTexture%20%3D%20this._matricesTexture.toJSON%28meta%29%3B%0A%20%20%20%20%20%20if%20%28this._colorsTexture%20%21%3D%3D%20null%29%20object.colorsTexture%20%3D%20this._colorsTexture.toJSON%28meta%29%3B%0A%20%20%20%20%20%20if%20%28this.boundingSphere%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20object.boundingSphere%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20center%3A%20object.boundingSphere.center.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20radius%3A%20object.boundingSphere.radius%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this.boundingBox%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20object.boundingBox%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20min%3A%20object.boundingBox.min.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20max%3A%20object.boundingBox.max.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20serialize%28library%2C%20element2%29%20%7B%0A%20%20%20%20%20%20if%20%28library%5Belement2.uuid%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20library%5Belement2.uuid%5D%20%3D%20element2.toJSON%28meta%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20element2.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.isScene%29%20%7B%0A%20%20%20%20%20%20if%20%28this.background%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.background.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20object.background%20%3D%20this.background.toJSON%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28this.background.isTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20object.background%20%3D%20this.background.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this.environment%20%26%26%20this.environment.isTexture%20%26%26%20this.environment.isRenderTargetTexture%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20object.environment%20%3D%20this.environment.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28this.isMesh%20%7C%7C%20this.isLine%20%7C%7C%20this.isPoints%29%20%7B%0A%20%20%20%20%20%20object.geometry%20%3D%20serialize%28meta.geometries%2C%20this.geometry%29%3B%0A%20%20%20%20%20%20const%20parameters%20%3D%20this.geometry.parameters%3B%0A%20%20%20%20%20%20if%20%28parameters%20%21%3D%3D%20void%200%20%26%26%20parameters.shapes%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20shapes%20%3D%20parameters.shapes%3B%0A%20%20%20%20%20%20%20%20if%20%28Array.isArray%28shapes%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20shapes.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20shape%20%3D%20shapes%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20serialize%28meta.shapes%2C%20shape%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20serialize%28meta.shapes%2C%20shapes%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.isSkinnedMesh%29%20%7B%0A%20%20%20%20%20%20object.bindMode%20%3D%20this.bindMode%3B%0A%20%20%20%20%20%20object.bindMatrix%20%3D%20this.bindMatrix.toArray%28%29%3B%0A%20%20%20%20%20%20if%20%28this.skeleton%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20serialize%28meta.skeletons%2C%20this.skeleton%29%3B%0A%20%20%20%20%20%20%20%20object.skeleton%20%3D%20this.skeleton.uuid%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.material%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28Array.isArray%28this.material%29%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uuids%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.material.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20uuids.push%28serialize%28meta.materials%2C%20this.material%5Bi%5D%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20object.material%20%3D%20uuids%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20object.material%20%3D%20serialize%28meta.materials%2C%20this.material%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.children.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20object.children%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this.children.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20object.children.push%28this.children%5Bi%5D.toJSON%28meta%29.object%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.animations.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20object.animations%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this.animations.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20animation%20%3D%20this.animations%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20object.animations.push%28serialize%28meta.animations%2C%20animation%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isRootObject%29%20%7B%0A%20%20%20%20%20%20const%20geometries%20%3D%20extractFromCache%28meta.geometries%29%3B%0A%20%20%20%20%20%20const%20materials%20%3D%20extractFromCache%28meta.materials%29%3B%0A%20%20%20%20%20%20const%20textures%20%3D%20extractFromCache%28meta.textures%29%3B%0A%20%20%20%20%20%20const%20images%20%3D%20extractFromCache%28meta.images%29%3B%0A%20%20%20%20%20%20const%20shapes%20%3D%20extractFromCache%28meta.shapes%29%3B%0A%20%20%20%20%20%20const%20skeletons%20%3D%20extractFromCache%28meta.skeletons%29%3B%0A%20%20%20%20%20%20const%20animations%20%3D%20extractFromCache%28meta.animations%29%3B%0A%20%20%20%20%20%20const%20nodes%20%3D%20extractFromCache%28meta.nodes%29%3B%0A%20%20%20%20%20%20if%20%28geometries.length%20%3E%200%29%20output2.geometries%20%3D%20geometries%3B%0A%20%20%20%20%20%20if%20%28materials.length%20%3E%200%29%20output2.materials%20%3D%20materials%3B%0A%20%20%20%20%20%20if%20%28textures.length%20%3E%200%29%20output2.textures%20%3D%20textures%3B%0A%20%20%20%20%20%20if%20%28images.length%20%3E%200%29%20output2.images%20%3D%20images%3B%0A%20%20%20%20%20%20if%20%28shapes.length%20%3E%200%29%20output2.shapes%20%3D%20shapes%3B%0A%20%20%20%20%20%20if%20%28skeletons.length%20%3E%200%29%20output2.skeletons%20%3D%20skeletons%3B%0A%20%20%20%20%20%20if%20%28animations.length%20%3E%200%29%20output2.animations%20%3D%20animations%3B%0A%20%20%20%20%20%20if%20%28nodes.length%20%3E%200%29%20output2.nodes%20%3D%20nodes%3B%0A%20%20%20%20%7D%0A%20%20%20%20output2.object%20%3D%20object%3B%0A%20%20%20%20return%20output2%3B%0A%20%20%20%20function%20extractFromCache%28cache2%29%20%7B%0A%20%20%20%20%20%20const%20values%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28const%20key%20in%20cache2%29%20%7B%0A%20%20%20%20%20%20%20%20const%20data%20%3D%20cache2%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20delete%20data.metadata%3B%0A%20%20%20%20%20%20%20%20values.push%28data%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20values%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clone%28recursive%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%2C%20recursive%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%20%3D%20true%29%20%7B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20this.up.copy%28source.up%29%3B%0A%20%20%20%20this.position.copy%28source.position%29%3B%0A%20%20%20%20this.rotation.order%20%3D%20source.rotation.order%3B%0A%20%20%20%20this.quaternion.copy%28source.quaternion%29%3B%0A%20%20%20%20this.scale.copy%28source.scale%29%3B%0A%20%20%20%20this.matrix.copy%28source.matrix%29%3B%0A%20%20%20%20this.matrixWorld.copy%28source.matrixWorld%29%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20source.matrixAutoUpdate%3B%0A%20%20%20%20this.matrixWorldAutoUpdate%20%3D%20source.matrixWorldAutoUpdate%3B%0A%20%20%20%20this.matrixWorldNeedsUpdate%20%3D%20source.matrixWorldNeedsUpdate%3B%0A%20%20%20%20this.layers.mask%20%3D%20source.layers.mask%3B%0A%20%20%20%20this.visible%20%3D%20source.visible%3B%0A%20%20%20%20this.castShadow%20%3D%20source.castShadow%3B%0A%20%20%20%20this.receiveShadow%20%3D%20source.receiveShadow%3B%0A%20%20%20%20this.frustumCulled%20%3D%20source.frustumCulled%3B%0A%20%20%20%20this.renderOrder%20%3D%20source.renderOrder%3B%0A%20%20%20%20this.animations%20%3D%20source.animations.slice%28%29%3B%0A%20%20%20%20this.userData%20%3D%20JSON.parse%28JSON.stringify%28source.userData%29%29%3B%0A%20%20%20%20if%20%28recursive%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20source.children.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20child%20%3D%20source.children%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20this.add%28child.clone%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0AObject3D.DEFAULT_UP%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%280%2C%201%2C%200%29%3B%0AObject3D.DEFAULT_MATRIX_AUTO_UPDATE%20%3D%20true%3B%0AObject3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE%20%3D%20true%3B%0Avar%20_v0%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_v1%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_v2%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_v3%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vab%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vac%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vbc%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vbp%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vcp%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_v40%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector4%28%29%3B%0Avar%20_v41%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector4%28%29%3B%0Avar%20_v42%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector4%28%29%3B%0Avar%20Triangle%20%3D%20class%20_Triangle%20%7B%0A%20%20constructor%28a2%20%3D%20new%20Vector3%28%29%2C%20b%20%3D%20new%20Vector3%28%29%2C%20c2%20%3D%20new%20Vector3%28%29%29%20%7B%0A%20%20%20%20this.a%20%3D%20a2%3B%0A%20%20%20%20this.b%20%3D%20b%3B%0A%20%20%20%20this.c%20%3D%20c2%3B%0A%20%20%7D%0A%20%20static%20getNormal%28a2%2C%20b%2C%20c2%2C%20target%29%20%7B%0A%20%20%20%20target.subVectors%28c2%2C%20b%29%3B%0A%20%20%20%20_v0%242.subVectors%28a2%2C%20b%29%3B%0A%20%20%20%20target.cross%28_v0%242%29%3B%0A%20%20%20%20const%20targetLengthSq%20%3D%20target.lengthSq%28%29%3B%0A%20%20%20%20if%20%28targetLengthSq%20%3E%200%29%20%7B%0A%20%20%20%20%20%20return%20target.multiplyScalar%281%20%2F%20Math.sqrt%28targetLengthSq%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target.set%280%2C%200%2C%200%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20static%2Finstance%20method%20to%20calculate%20barycentric%20coordinates%0A%20%20%2F%2F%20based%20on%3A%20http%3A%2F%2Fwww.blackpawn.com%2Ftexts%2Fpointinpoly%2Fdefault.html%0A%20%20static%20getBarycoord%28point%2C%20a2%2C%20b%2C%20c2%2C%20target%29%20%7B%0A%20%20%20%20_v0%242.subVectors%28c2%2C%20a2%29%3B%0A%20%20%20%20_v1%243.subVectors%28b%2C%20a2%29%3B%0A%20%20%20%20_v2%242.subVectors%28point%2C%20a2%29%3B%0A%20%20%20%20const%20dot00%20%3D%20_v0%242.dot%28_v0%242%29%3B%0A%20%20%20%20const%20dot01%20%3D%20_v0%242.dot%28_v1%243%29%3B%0A%20%20%20%20const%20dot02%20%3D%20_v0%242.dot%28_v2%242%29%3B%0A%20%20%20%20const%20dot11%20%3D%20_v1%243.dot%28_v1%243%29%3B%0A%20%20%20%20const%20dot12%20%3D%20_v1%243.dot%28_v2%242%29%3B%0A%20%20%20%20const%20denom%20%3D%20dot00%20%2A%20dot11%20-%20dot01%20%2A%20dot01%3B%0A%20%20%20%20if%20%28denom%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20target.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20invDenom%20%3D%201%20%2F%20denom%3B%0A%20%20%20%20const%20u%20%3D%20%28dot11%20%2A%20dot02%20-%20dot01%20%2A%20dot12%29%20%2A%20invDenom%3B%0A%20%20%20%20const%20v%20%3D%20%28dot00%20%2A%20dot12%20-%20dot01%20%2A%20dot02%29%20%2A%20invDenom%3B%0A%20%20%20%20return%20target.set%281%20-%20u%20-%20v%2C%20v%2C%20u%29%3B%0A%20%20%7D%0A%20%20static%20containsPoint%28point%2C%20a2%2C%20b%2C%20c2%29%20%7B%0A%20%20%20%20if%20%28this.getBarycoord%28point%2C%20a2%2C%20b%2C%20c2%2C%20_v3%242%29%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20_v3%242.x%20%3E%3D%200%20%26%26%20_v3%242.y%20%3E%3D%200%20%26%26%20_v3%242.x%20%2B%20_v3%242.y%20%3C%3D%201%3B%0A%20%20%7D%0A%20%20static%20getInterpolation%28point%2C%20p1%2C%20p2%2C%20p3%2C%20v1%2C%20v2%2C%20v3%2C%20target%29%20%7B%0A%20%20%20%20if%20%28this.getBarycoord%28point%2C%20p1%2C%20p2%2C%20p3%2C%20_v3%242%29%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20target.x%20%3D%200%3B%0A%20%20%20%20%20%20target.y%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28%22z%22%20in%20target%29%20target.z%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28%22w%22%20in%20target%29%20target.w%20%3D%200%3B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20target.setScalar%280%29%3B%0A%20%20%20%20target.addScaledVector%28v1%2C%20_v3%242.x%29%3B%0A%20%20%20%20target.addScaledVector%28v2%2C%20_v3%242.y%29%3B%0A%20%20%20%20target.addScaledVector%28v3%2C%20_v3%242.z%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20static%20getInterpolatedAttribute%28attr%2C%20i1%2C%20i2%2C%20i3%2C%20barycoord%2C%20target%29%20%7B%0A%20%20%20%20_v40.setScalar%280%29%3B%0A%20%20%20%20_v41.setScalar%280%29%3B%0A%20%20%20%20_v42.setScalar%280%29%3B%0A%20%20%20%20_v40.fromBufferAttribute%28attr%2C%20i1%29%3B%0A%20%20%20%20_v41.fromBufferAttribute%28attr%2C%20i2%29%3B%0A%20%20%20%20_v42.fromBufferAttribute%28attr%2C%20i3%29%3B%0A%20%20%20%20target.setScalar%280%29%3B%0A%20%20%20%20target.addScaledVector%28_v40%2C%20barycoord.x%29%3B%0A%20%20%20%20target.addScaledVector%28_v41%2C%20barycoord.y%29%3B%0A%20%20%20%20target.addScaledVector%28_v42%2C%20barycoord.z%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20static%20isFrontFacing%28a2%2C%20b%2C%20c2%2C%20direction2%29%20%7B%0A%20%20%20%20_v0%242.subVectors%28c2%2C%20b%29%3B%0A%20%20%20%20_v1%243.subVectors%28a2%2C%20b%29%3B%0A%20%20%20%20return%20_v0%242.cross%28_v1%243%29.dot%28direction2%29%20%3C%200%20%3F%20true%20%3A%20false%3B%0A%20%20%7D%0A%20%20set%28a2%2C%20b%2C%20c2%29%20%7B%0A%20%20%20%20this.a.copy%28a2%29%3B%0A%20%20%20%20this.b.copy%28b%29%3B%0A%20%20%20%20this.c.copy%28c2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromPointsAndIndices%28points%2C%20i0%2C%20i1%2C%20i2%29%20%7B%0A%20%20%20%20this.a.copy%28points%5Bi0%5D%29%3B%0A%20%20%20%20this.b.copy%28points%5Bi1%5D%29%3B%0A%20%20%20%20this.c.copy%28points%5Bi2%5D%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromAttributeAndIndices%28attribute2%2C%20i0%2C%20i1%2C%20i2%29%20%7B%0A%20%20%20%20this.a.fromBufferAttribute%28attribute2%2C%20i0%29%3B%0A%20%20%20%20this.b.fromBufferAttribute%28attribute2%2C%20i1%29%3B%0A%20%20%20%20this.c.fromBufferAttribute%28attribute2%2C%20i2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28triangle%29%20%7B%0A%20%20%20%20this.a.copy%28triangle.a%29%3B%0A%20%20%20%20this.b.copy%28triangle.b%29%3B%0A%20%20%20%20this.c.copy%28triangle.c%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getArea%28%29%20%7B%0A%20%20%20%20_v0%242.subVectors%28this.c%2C%20this.b%29%3B%0A%20%20%20%20_v1%243.subVectors%28this.a%2C%20this.b%29%3B%0A%20%20%20%20return%20_v0%242.cross%28_v1%243%29.length%28%29%20%2A%200.5%3B%0A%20%20%7D%0A%20%20getMidpoint%28target%29%20%7B%0A%20%20%20%20return%20target.addVectors%28this.a%2C%20this.b%29.add%28this.c%29.multiplyScalar%281%20%2F%203%29%3B%0A%20%20%7D%0A%20%20getNormal%28target%29%20%7B%0A%20%20%20%20return%20_Triangle.getNormal%28this.a%2C%20this.b%2C%20this.c%2C%20target%29%3B%0A%20%20%7D%0A%20%20getPlane%28target%29%20%7B%0A%20%20%20%20return%20target.setFromCoplanarPoints%28this.a%2C%20this.b%2C%20this.c%29%3B%0A%20%20%7D%0A%20%20getBarycoord%28point%2C%20target%29%20%7B%0A%20%20%20%20return%20_Triangle.getBarycoord%28point%2C%20this.a%2C%20this.b%2C%20this.c%2C%20target%29%3B%0A%20%20%7D%0A%20%20getInterpolation%28point%2C%20v1%2C%20v2%2C%20v3%2C%20target%29%20%7B%0A%20%20%20%20return%20_Triangle.getInterpolation%28point%2C%20this.a%2C%20this.b%2C%20this.c%2C%20v1%2C%20v2%2C%20v3%2C%20target%29%3B%0A%20%20%7D%0A%20%20containsPoint%28point%29%20%7B%0A%20%20%20%20return%20_Triangle.containsPoint%28point%2C%20this.a%2C%20this.b%2C%20this.c%29%3B%0A%20%20%7D%0A%20%20isFrontFacing%28direction2%29%20%7B%0A%20%20%20%20return%20_Triangle.isFrontFacing%28this.a%2C%20this.b%2C%20this.c%2C%20direction2%29%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20box.intersectsTriangle%28this%29%3B%0A%20%20%7D%0A%20%20closestPointToPoint%28p%2C%20target%29%20%7B%0A%20%20%20%20const%20a2%20%3D%20this.a%2C%20b%20%3D%20this.b%2C%20c2%20%3D%20this.c%3B%0A%20%20%20%20let%20v%2C%20w%3B%0A%20%20%20%20_vab.subVectors%28b%2C%20a2%29%3B%0A%20%20%20%20_vac.subVectors%28c2%2C%20a2%29%3B%0A%20%20%20%20_vap.subVectors%28p%2C%20a2%29%3B%0A%20%20%20%20const%20d1%20%3D%20_vab.dot%28_vap%29%3B%0A%20%20%20%20const%20d2%20%3D%20_vac.dot%28_vap%29%3B%0A%20%20%20%20if%20%28d1%20%3C%3D%200%20%26%26%20d2%20%3C%3D%200%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28a2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_vbp.subVectors%28p%2C%20b%29%3B%0A%20%20%20%20const%20d3%20%3D%20_vab.dot%28_vbp%29%3B%0A%20%20%20%20const%20d4%20%3D%20_vac.dot%28_vbp%29%3B%0A%20%20%20%20if%20%28d3%20%3E%3D%200%20%26%26%20d4%20%3C%3D%20d3%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28b%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20vc%20%3D%20d1%20%2A%20d4%20-%20d3%20%2A%20d2%3B%0A%20%20%20%20if%20%28vc%20%3C%3D%200%20%26%26%20d1%20%3E%3D%200%20%26%26%20d3%20%3C%3D%200%29%20%7B%0A%20%20%20%20%20%20v%20%3D%20d1%20%2F%20%28d1%20-%20d3%29%3B%0A%20%20%20%20%20%20return%20target.copy%28a2%29.addScaledVector%28_vab%2C%20v%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_vcp.subVectors%28p%2C%20c2%29%3B%0A%20%20%20%20const%20d5%20%3D%20_vab.dot%28_vcp%29%3B%0A%20%20%20%20const%20d6%20%3D%20_vac.dot%28_vcp%29%3B%0A%20%20%20%20if%20%28d6%20%3E%3D%200%20%26%26%20d5%20%3C%3D%20d6%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28c2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20vb%20%3D%20d5%20%2A%20d2%20-%20d1%20%2A%20d6%3B%0A%20%20%20%20if%20%28vb%20%3C%3D%200%20%26%26%20d2%20%3E%3D%200%20%26%26%20d6%20%3C%3D%200%29%20%7B%0A%20%20%20%20%20%20w%20%3D%20d2%20%2F%20%28d2%20-%20d6%29%3B%0A%20%20%20%20%20%20return%20target.copy%28a2%29.addScaledVector%28_vac%2C%20w%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20va%20%3D%20d3%20%2A%20d6%20-%20d5%20%2A%20d4%3B%0A%20%20%20%20if%20%28va%20%3C%3D%200%20%26%26%20d4%20-%20d3%20%3E%3D%200%20%26%26%20d5%20-%20d6%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20_vbc.subVectors%28c2%2C%20b%29%3B%0A%20%20%20%20%20%20w%20%3D%20%28d4%20-%20d3%29%20%2F%20%28d4%20-%20d3%20%2B%20%28d5%20-%20d6%29%29%3B%0A%20%20%20%20%20%20return%20target.copy%28b%29.addScaledVector%28_vbc%2C%20w%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20denom%20%3D%201%20%2F%20%28va%20%2B%20vb%20%2B%20vc%29%3B%0A%20%20%20%20v%20%3D%20vb%20%2A%20denom%3B%0A%20%20%20%20w%20%3D%20vc%20%2A%20denom%3B%0A%20%20%20%20return%20target.copy%28a2%29.addScaledVector%28_vab%2C%20v%29.addScaledVector%28_vac%2C%20w%29%3B%0A%20%20%7D%0A%20%20equals%28triangle%29%20%7B%0A%20%20%20%20return%20triangle.a.equals%28this.a%29%20%26%26%20triangle.b.equals%28this.b%29%20%26%26%20triangle.c.equals%28this.c%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_colorKeywords%20%3D%20%7B%0A%20%20%22aliceblue%22%3A%2015792383%2C%0A%20%20%22antiquewhite%22%3A%2016444375%2C%0A%20%20%22aqua%22%3A%2065535%2C%0A%20%20%22aquamarine%22%3A%208388564%2C%0A%20%20%22azure%22%3A%2015794175%2C%0A%20%20%22beige%22%3A%2016119260%2C%0A%20%20%22bisque%22%3A%2016770244%2C%0A%20%20%22black%22%3A%200%2C%0A%20%20%22blanchedalmond%22%3A%2016772045%2C%0A%20%20%22blue%22%3A%20255%2C%0A%20%20%22blueviolet%22%3A%209055202%2C%0A%20%20%22brown%22%3A%2010824234%2C%0A%20%20%22burlywood%22%3A%2014596231%2C%0A%20%20%22cadetblue%22%3A%206266528%2C%0A%20%20%22chartreuse%22%3A%208388352%2C%0A%20%20%22chocolate%22%3A%2013789470%2C%0A%20%20%22coral%22%3A%2016744272%2C%0A%20%20%22cornflowerblue%22%3A%206591981%2C%0A%20%20%22cornsilk%22%3A%2016775388%2C%0A%20%20%22crimson%22%3A%2014423100%2C%0A%20%20%22cyan%22%3A%2065535%2C%0A%20%20%22darkblue%22%3A%20139%2C%0A%20%20%22darkcyan%22%3A%2035723%2C%0A%20%20%22darkgoldenrod%22%3A%2012092939%2C%0A%20%20%22darkgray%22%3A%2011119017%2C%0A%20%20%22darkgreen%22%3A%2025600%2C%0A%20%20%22darkgrey%22%3A%2011119017%2C%0A%20%20%22darkkhaki%22%3A%2012433259%2C%0A%20%20%22darkmagenta%22%3A%209109643%2C%0A%20%20%22darkolivegreen%22%3A%205597999%2C%0A%20%20%22darkorange%22%3A%2016747520%2C%0A%20%20%22darkorchid%22%3A%2010040012%2C%0A%20%20%22darkred%22%3A%209109504%2C%0A%20%20%22darksalmon%22%3A%2015308410%2C%0A%20%20%22darkseagreen%22%3A%209419919%2C%0A%20%20%22darkslateblue%22%3A%204734347%2C%0A%20%20%22darkslategray%22%3A%203100495%2C%0A%20%20%22darkslategrey%22%3A%203100495%2C%0A%20%20%22darkturquoise%22%3A%2052945%2C%0A%20%20%22darkviolet%22%3A%209699539%2C%0A%20%20%22deeppink%22%3A%2016716947%2C%0A%20%20%22deepskyblue%22%3A%2049151%2C%0A%20%20%22dimgray%22%3A%206908265%2C%0A%20%20%22dimgrey%22%3A%206908265%2C%0A%20%20%22dodgerblue%22%3A%202003199%2C%0A%20%20%22firebrick%22%3A%2011674146%2C%0A%20%20%22floralwhite%22%3A%2016775920%2C%0A%20%20%22forestgreen%22%3A%202263842%2C%0A%20%20%22fuchsia%22%3A%2016711935%2C%0A%20%20%22gainsboro%22%3A%2014474460%2C%0A%20%20%22ghostwhite%22%3A%2016316671%2C%0A%20%20%22gold%22%3A%2016766720%2C%0A%20%20%22goldenrod%22%3A%2014329120%2C%0A%20%20%22gray%22%3A%208421504%2C%0A%20%20%22green%22%3A%2032768%2C%0A%20%20%22greenyellow%22%3A%2011403055%2C%0A%20%20%22grey%22%3A%208421504%2C%0A%20%20%22honeydew%22%3A%2015794160%2C%0A%20%20%22hotpink%22%3A%2016738740%2C%0A%20%20%22indianred%22%3A%2013458524%2C%0A%20%20%22indigo%22%3A%204915330%2C%0A%20%20%22ivory%22%3A%2016777200%2C%0A%20%20%22khaki%22%3A%2015787660%2C%0A%20%20%22lavender%22%3A%2015132410%2C%0A%20%20%22lavenderblush%22%3A%2016773365%2C%0A%20%20%22lawngreen%22%3A%208190976%2C%0A%20%20%22lemonchiffon%22%3A%2016775885%2C%0A%20%20%22lightblue%22%3A%2011393254%2C%0A%20%20%22lightcoral%22%3A%2015761536%2C%0A%20%20%22lightcyan%22%3A%2014745599%2C%0A%20%20%22lightgoldenrodyellow%22%3A%2016448210%2C%0A%20%20%22lightgray%22%3A%2013882323%2C%0A%20%20%22lightgreen%22%3A%209498256%2C%0A%20%20%22lightgrey%22%3A%2013882323%2C%0A%20%20%22lightpink%22%3A%2016758465%2C%0A%20%20%22lightsalmon%22%3A%2016752762%2C%0A%20%20%22lightseagreen%22%3A%202142890%2C%0A%20%20%22lightskyblue%22%3A%208900346%2C%0A%20%20%22lightslategray%22%3A%207833753%2C%0A%20%20%22lightslategrey%22%3A%207833753%2C%0A%20%20%22lightsteelblue%22%3A%2011584734%2C%0A%20%20%22lightyellow%22%3A%2016777184%2C%0A%20%20%22lime%22%3A%2065280%2C%0A%20%20%22limegreen%22%3A%203329330%2C%0A%20%20%22linen%22%3A%2016445670%2C%0A%20%20%22magenta%22%3A%2016711935%2C%0A%20%20%22maroon%22%3A%208388608%2C%0A%20%20%22mediumaquamarine%22%3A%206737322%2C%0A%20%20%22mediumblue%22%3A%20205%2C%0A%20%20%22mediumorchid%22%3A%2012211667%2C%0A%20%20%22mediumpurple%22%3A%209662683%2C%0A%20%20%22mediumseagreen%22%3A%203978097%2C%0A%20%20%22mediumslateblue%22%3A%208087790%2C%0A%20%20%22mediumspringgreen%22%3A%2064154%2C%0A%20%20%22mediumturquoise%22%3A%204772300%2C%0A%20%20%22mediumvioletred%22%3A%2013047173%2C%0A%20%20%22midnightblue%22%3A%201644912%2C%0A%20%20%22mintcream%22%3A%2016121850%2C%0A%20%20%22mistyrose%22%3A%2016770273%2C%0A%20%20%22moccasin%22%3A%2016770229%2C%0A%20%20%22navajowhite%22%3A%2016768685%2C%0A%20%20%22navy%22%3A%20128%2C%0A%20%20%22oldlace%22%3A%2016643558%2C%0A%20%20%22olive%22%3A%208421376%2C%0A%20%20%22olivedrab%22%3A%207048739%2C%0A%20%20%22orange%22%3A%2016753920%2C%0A%20%20%22orangered%22%3A%2016729344%2C%0A%20%20%22orchid%22%3A%2014315734%2C%0A%20%20%22palegoldenrod%22%3A%2015657130%2C%0A%20%20%22palegreen%22%3A%2010025880%2C%0A%20%20%22paleturquoise%22%3A%2011529966%2C%0A%20%20%22palevioletred%22%3A%2014381203%2C%0A%20%20%22papayawhip%22%3A%2016773077%2C%0A%20%20%22peachpuff%22%3A%2016767673%2C%0A%20%20%22peru%22%3A%2013468991%2C%0A%20%20%22pink%22%3A%2016761035%2C%0A%20%20%22plum%22%3A%2014524637%2C%0A%20%20%22powderblue%22%3A%2011591910%2C%0A%20%20%22purple%22%3A%208388736%2C%0A%20%20%22rebeccapurple%22%3A%206697881%2C%0A%20%20%22red%22%3A%2016711680%2C%0A%20%20%22rosybrown%22%3A%2012357519%2C%0A%20%20%22royalblue%22%3A%204286945%2C%0A%20%20%22saddlebrown%22%3A%209127187%2C%0A%20%20%22salmon%22%3A%2016416882%2C%0A%20%20%22sandybrown%22%3A%2016032864%2C%0A%20%20%22seagreen%22%3A%203050327%2C%0A%20%20%22seashell%22%3A%2016774638%2C%0A%20%20%22sienna%22%3A%2010506797%2C%0A%20%20%22silver%22%3A%2012632256%2C%0A%20%20%22skyblue%22%3A%208900331%2C%0A%20%20%22slateblue%22%3A%206970061%2C%0A%20%20%22slategray%22%3A%207372944%2C%0A%20%20%22slategrey%22%3A%207372944%2C%0A%20%20%22snow%22%3A%2016775930%2C%0A%20%20%22springgreen%22%3A%2065407%2C%0A%20%20%22steelblue%22%3A%204620980%2C%0A%20%20%22tan%22%3A%2013808780%2C%0A%20%20%22teal%22%3A%2032896%2C%0A%20%20%22thistle%22%3A%2014204888%2C%0A%20%20%22tomato%22%3A%2016737095%2C%0A%20%20%22turquoise%22%3A%204251856%2C%0A%20%20%22violet%22%3A%2015631086%2C%0A%20%20%22wheat%22%3A%2016113331%2C%0A%20%20%22white%22%3A%2016777215%2C%0A%20%20%22whitesmoke%22%3A%2016119285%2C%0A%20%20%22yellow%22%3A%2016776960%2C%0A%20%20%22yellowgreen%22%3A%2010145074%0A%7D%3B%0Avar%20_hslA%20%3D%20%7B%20h%3A%200%2C%20s%3A%200%2C%20l%3A%200%20%7D%3B%0Avar%20_hslB%20%3D%20%7B%20h%3A%200%2C%20s%3A%200%2C%20l%3A%200%20%7D%3B%0Afunction%20hue2rgb%28p%2C%20q%2C%20t%29%20%7B%0A%20%20if%20%28t%20%3C%200%29%20t%20%2B%3D%201%3B%0A%20%20if%20%28t%20%3E%201%29%20t%20-%3D%201%3B%0A%20%20if%20%28t%20%3C%201%20%2F%206%29%20return%20p%20%2B%20%28q%20-%20p%29%20%2A%206%20%2A%20t%3B%0A%20%20if%20%28t%20%3C%201%20%2F%202%29%20return%20q%3B%0A%20%20if%20%28t%20%3C%202%20%2F%203%29%20return%20p%20%2B%20%28q%20-%20p%29%20%2A%206%20%2A%20%282%20%2F%203%20-%20t%29%3B%0A%20%20return%20p%3B%0A%7D%0Avar%20Color%20%3D%20class%20%7B%0A%20%20constructor%28r%2C%20g%2C%20b%29%20%7B%0A%20%20%20%20this.isColor%20%3D%20true%3B%0A%20%20%20%20this.r%20%3D%201%3B%0A%20%20%20%20this.g%20%3D%201%3B%0A%20%20%20%20this.b%20%3D%201%3B%0A%20%20%20%20return%20this.set%28r%2C%20g%2C%20b%29%3B%0A%20%20%7D%0A%20%20set%28r%2C%20g%2C%20b%29%20%7B%0A%20%20%20%20if%20%28g%20%3D%3D%3D%20void%200%20%26%26%20b%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20value%20%3D%20r%3B%0A%20%20%20%20%20%20if%20%28value%20%26%26%20value.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20this.copy%28value%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20value%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20%20%20%20%20this.setHex%28value%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20value%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20%20%20%20%20this.setStyle%28value%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.setRGB%28r%2C%20g%2C%20b%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setScalar%28scalar%29%20%7B%0A%20%20%20%20this.r%20%3D%20scalar%3B%0A%20%20%20%20this.g%20%3D%20scalar%3B%0A%20%20%20%20this.b%20%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setHex%28hex%2C%20colorSpace%20%3D%20SRGBColorSpace%29%20%7B%0A%20%20%20%20hex%20%3D%20Math.floor%28hex%29%3B%0A%20%20%20%20this.r%20%3D%20%28hex%20%3E%3E%2016%20%26%20255%29%20%2F%20255%3B%0A%20%20%20%20this.g%20%3D%20%28hex%20%3E%3E%208%20%26%20255%29%20%2F%20255%3B%0A%20%20%20%20this.b%20%3D%20%28hex%20%26%20255%29%20%2F%20255%3B%0A%20%20%20%20ColorManagement.toWorkingColorSpace%28this%2C%20colorSpace%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setRGB%28r%2C%20g%2C%20b%2C%20colorSpace%20%3D%20ColorManagement.workingColorSpace%29%20%7B%0A%20%20%20%20this.r%20%3D%20r%3B%0A%20%20%20%20this.g%20%3D%20g%3B%0A%20%20%20%20this.b%20%3D%20b%3B%0A%20%20%20%20ColorManagement.toWorkingColorSpace%28this%2C%20colorSpace%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setHSL%28h%2C%20s%2C%20l%2C%20colorSpace%20%3D%20ColorManagement.workingColorSpace%29%20%7B%0A%20%20%20%20h%20%3D%20euclideanModulo%28h%2C%201%29%3B%0A%20%20%20%20s%20%3D%20clamp%28s%2C%200%2C%201%29%3B%0A%20%20%20%20l%20%3D%20clamp%28l%2C%200%2C%201%29%3B%0A%20%20%20%20if%20%28s%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20this.r%20%3D%20this.g%20%3D%20this.b%20%3D%20l%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20p%20%3D%20l%20%3C%3D%200.5%20%3F%20l%20%2A%20%281%20%2B%20s%29%20%3A%20l%20%2B%20s%20-%20l%20%2A%20s%3B%0A%20%20%20%20%20%20const%20q%20%3D%202%20%2A%20l%20-%20p%3B%0A%20%20%20%20%20%20this.r%20%3D%20hue2rgb%28q%2C%20p%2C%20h%20%2B%201%20%2F%203%29%3B%0A%20%20%20%20%20%20this.g%20%3D%20hue2rgb%28q%2C%20p%2C%20h%29%3B%0A%20%20%20%20%20%20this.b%20%3D%20hue2rgb%28q%2C%20p%2C%20h%20-%201%20%2F%203%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20ColorManagement.toWorkingColorSpace%28this%2C%20colorSpace%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setStyle%28style%2C%20colorSpace%20%3D%20SRGBColorSpace%29%20%7B%0A%20%20%20%20function%20handleAlpha%28string%29%20%7B%0A%20%20%20%20%20%20if%20%28string%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20%20%20if%20%28parseFloat%28string%29%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.Color%3A%20Alpha%20component%20of%20%22%20%2B%20style%20%2B%20%22%20will%20be%20ignored.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20let%20m2%3B%0A%20%20%20%20if%20%28m2%20%3D%20%2F%5E%28%5Cw%2B%29%5C%28%28%5B%5E%5C%29%5D%2A%29%5C%29%2F.exec%28style%29%29%20%7B%0A%20%20%20%20%20%20let%20color2%3B%0A%20%20%20%20%20%20const%20name%20%3D%20m2%5B1%5D%3B%0A%20%20%20%20%20%20const%20components%20%3D%20m2%5B2%5D%3B%0A%20%20%20%20%20%20switch%20%28name%29%20%7B%0A%20%20%20%20%20%20%20%20case%20%22rgb%22%3A%0A%20%20%20%20%20%20%20%20case%20%22rgba%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28color2%20%3D%20%2F%5E%5Cs%2A%28%5Cd%2B%29%5Cs%2A%2C%5Cs%2A%28%5Cd%2B%29%5Cs%2A%2C%5Cs%2A%28%5Cd%2B%29%5Cs%2A%28%3F%3A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5Cs%2A%29%3F%24%2F.exec%28components%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20handleAlpha%28color2%5B4%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.setRGB%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28255%2C%20parseInt%28color2%5B1%5D%2C%2010%29%29%20%2F%20255%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28255%2C%20parseInt%28color2%5B2%5D%2C%2010%29%29%20%2F%20255%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28255%2C%20parseInt%28color2%5B3%5D%2C%2010%29%29%20%2F%20255%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorSpace%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28color2%20%3D%20%2F%5E%5Cs%2A%28%5Cd%2B%29%5C%25%5Cs%2A%2C%5Cs%2A%28%5Cd%2B%29%5C%25%5Cs%2A%2C%5Cs%2A%28%5Cd%2B%29%5C%25%5Cs%2A%28%3F%3A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5Cs%2A%29%3F%24%2F.exec%28components%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20handleAlpha%28color2%5B4%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.setRGB%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28100%2C%20parseInt%28color2%5B1%5D%2C%2010%29%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28100%2C%20parseInt%28color2%5B2%5D%2C%2010%29%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28100%2C%20parseInt%28color2%5B3%5D%2C%2010%29%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorSpace%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22hsl%22%3A%0A%20%20%20%20%20%20%20%20case%20%22hsla%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28color2%20%3D%20%2F%5E%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5Cs%2A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5C%25%5Cs%2A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5C%25%5Cs%2A%28%3F%3A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5Cs%2A%29%3F%24%2F.exec%28components%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20handleAlpha%28color2%5B4%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.setHSL%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20parseFloat%28color2%5B1%5D%29%20%2F%20360%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20parseFloat%28color2%5B2%5D%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20parseFloat%28color2%5B3%5D%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorSpace%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.Color%3A%20Unknown%20color%20model%20%22%20%2B%20style%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28m2%20%3D%20%2F%5E%5C%23%28%5BA-Fa-f%5Cd%5D%2B%29%24%2F.exec%28style%29%29%20%7B%0A%20%20%20%20%20%20const%20hex%20%3D%20m2%5B1%5D%3B%0A%20%20%20%20%20%20const%20size%20%3D%20hex.length%3B%0A%20%20%20%20%20%20if%20%28size%20%3D%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this.setRGB%28%0A%20%20%20%20%20%20%20%20%20%20parseInt%28hex.charAt%280%29%2C%2016%29%20%2F%2015%2C%0A%20%20%20%20%20%20%20%20%20%20parseInt%28hex.charAt%281%29%2C%2016%29%20%2F%2015%2C%0A%20%20%20%20%20%20%20%20%20%20parseInt%28hex.charAt%282%29%2C%2016%29%20%2F%2015%2C%0A%20%20%20%20%20%20%20%20%20%20colorSpace%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28size%20%3D%3D%3D%206%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this.setHex%28parseInt%28hex%2C%2016%29%2C%20colorSpace%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.Color%3A%20Invalid%20hex%20color%20%22%20%2B%20style%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28style%20%26%26%20style.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20return%20this.setColorName%28style%2C%20colorSpace%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setColorName%28style%2C%20colorSpace%20%3D%20SRGBColorSpace%29%20%7B%0A%20%20%20%20const%20hex%20%3D%20_colorKeywords%5Bstyle.toLowerCase%28%29%5D%3B%0A%20%20%20%20if%20%28hex%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.setHex%28hex%2C%20colorSpace%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.Color%3A%20Unknown%20color%20%22%20%2B%20style%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.r%2C%20this.g%2C%20this.b%29%3B%0A%20%20%7D%0A%20%20copy%28color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20color2.r%3B%0A%20%20%20%20this.g%20%3D%20color2.g%3B%0A%20%20%20%20this.b%20%3D%20color2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copySRGBToLinear%28color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20SRGBToLinear%28color2.r%29%3B%0A%20%20%20%20this.g%20%3D%20SRGBToLinear%28color2.g%29%3B%0A%20%20%20%20this.b%20%3D%20SRGBToLinear%28color2.b%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copyLinearToSRGB%28color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20LinearToSRGB%28color2.r%29%3B%0A%20%20%20%20this.g%20%3D%20LinearToSRGB%28color2.g%29%3B%0A%20%20%20%20this.b%20%3D%20LinearToSRGB%28color2.b%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20convertSRGBToLinear%28%29%20%7B%0A%20%20%20%20this.copySRGBToLinear%28this%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20convertLinearToSRGB%28%29%20%7B%0A%20%20%20%20this.copyLinearToSRGB%28this%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getHex%28colorSpace%20%3D%20SRGBColorSpace%29%20%7B%0A%20%20%20%20ColorManagement.fromWorkingColorSpace%28_color.copy%28this%29%2C%20colorSpace%29%3B%0A%20%20%20%20return%20Math.round%28clamp%28_color.r%20%2A%20255%2C%200%2C%20255%29%29%20%2A%2065536%20%2B%20Math.round%28clamp%28_color.g%20%2A%20255%2C%200%2C%20255%29%29%20%2A%20256%20%2B%20Math.round%28clamp%28_color.b%20%2A%20255%2C%200%2C%20255%29%29%3B%0A%20%20%7D%0A%20%20getHexString%28colorSpace%20%3D%20SRGBColorSpace%29%20%7B%0A%20%20%20%20return%20%28%22000000%22%20%2B%20this.getHex%28colorSpace%29.toString%2816%29%29.slice%28-6%29%3B%0A%20%20%7D%0A%20%20getHSL%28target%2C%20colorSpace%20%3D%20ColorManagement.workingColorSpace%29%20%7B%0A%20%20%20%20ColorManagement.fromWorkingColorSpace%28_color.copy%28this%29%2C%20colorSpace%29%3B%0A%20%20%20%20const%20r%20%3D%20_color.r%2C%20g%20%3D%20_color.g%2C%20b%20%3D%20_color.b%3B%0A%20%20%20%20const%20max2%20%3D%20Math.max%28r%2C%20g%2C%20b%29%3B%0A%20%20%20%20const%20min2%20%3D%20Math.min%28r%2C%20g%2C%20b%29%3B%0A%20%20%20%20let%20hue%2C%20saturation%3B%0A%20%20%20%20const%20lightness%20%3D%20%28min2%20%2B%20max2%29%20%2F%202%3B%0A%20%20%20%20if%20%28min2%20%3D%3D%3D%20max2%29%20%7B%0A%20%20%20%20%20%20hue%20%3D%200%3B%0A%20%20%20%20%20%20saturation%20%3D%200%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20delta%20%3D%20max2%20-%20min2%3B%0A%20%20%20%20%20%20saturation%20%3D%20lightness%20%3C%3D%200.5%20%3F%20delta%20%2F%20%28max2%20%2B%20min2%29%20%3A%20delta%20%2F%20%282%20-%20max2%20-%20min2%29%3B%0A%20%20%20%20%20%20switch%20%28max2%29%20%7B%0A%20%20%20%20%20%20%20%20case%20r%3A%0A%20%20%20%20%20%20%20%20%20%20hue%20%3D%20%28g%20-%20b%29%20%2F%20delta%20%2B%20%28g%20%3C%20b%20%3F%206%20%3A%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20g%3A%0A%20%20%20%20%20%20%20%20%20%20hue%20%3D%20%28b%20-%20r%29%20%2F%20delta%20%2B%202%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20b%3A%0A%20%20%20%20%20%20%20%20%20%20hue%20%3D%20%28r%20-%20g%29%20%2F%20delta%20%2B%204%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20hue%20%2F%3D%206%3B%0A%20%20%20%20%7D%0A%20%20%20%20target.h%20%3D%20hue%3B%0A%20%20%20%20target.s%20%3D%20saturation%3B%0A%20%20%20%20target.l%20%3D%20lightness%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getRGB%28target%2C%20colorSpace%20%3D%20ColorManagement.workingColorSpace%29%20%7B%0A%20%20%20%20ColorManagement.fromWorkingColorSpace%28_color.copy%28this%29%2C%20colorSpace%29%3B%0A%20%20%20%20target.r%20%3D%20_color.r%3B%0A%20%20%20%20target.g%20%3D%20_color.g%3B%0A%20%20%20%20target.b%20%3D%20_color.b%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getStyle%28colorSpace%20%3D%20SRGBColorSpace%29%20%7B%0A%20%20%20%20ColorManagement.fromWorkingColorSpace%28_color.copy%28this%29%2C%20colorSpace%29%3B%0A%20%20%20%20const%20r%20%3D%20_color.r%2C%20g%20%3D%20_color.g%2C%20b%20%3D%20_color.b%3B%0A%20%20%20%20if%20%28colorSpace%20%21%3D%3D%20SRGBColorSpace%29%20%7B%0A%20%20%20%20%20%20return%20%60color%28%24%7BcolorSpace%7D%20%24%7Br.toFixed%283%29%7D%20%24%7Bg.toFixed%283%29%7D%20%24%7Bb.toFixed%283%29%7D%29%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%60rgb%28%24%7BMath.round%28r%20%2A%20255%29%7D%2C%24%7BMath.round%28g%20%2A%20255%29%7D%2C%24%7BMath.round%28b%20%2A%20255%29%7D%29%60%3B%0A%20%20%7D%0A%20%20offsetHSL%28h%2C%20s%2C%20l%29%20%7B%0A%20%20%20%20this.getHSL%28_hslA%29%3B%0A%20%20%20%20return%20this.setHSL%28_hslA.h%20%2B%20h%2C%20_hslA.s%20%2B%20s%2C%20_hslA.l%20%2B%20l%29%3B%0A%20%20%7D%0A%20%20add%28color2%29%20%7B%0A%20%20%20%20this.r%20%2B%3D%20color2.r%3B%0A%20%20%20%20this.g%20%2B%3D%20color2.g%3B%0A%20%20%20%20this.b%20%2B%3D%20color2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addColors%28color1%2C%20color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20color1.r%20%2B%20color2.r%3B%0A%20%20%20%20this.g%20%3D%20color1.g%20%2B%20color2.g%3B%0A%20%20%20%20this.b%20%3D%20color1.b%20%2B%20color2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScalar%28s%29%20%7B%0A%20%20%20%20this.r%20%2B%3D%20s%3B%0A%20%20%20%20this.g%20%2B%3D%20s%3B%0A%20%20%20%20this.b%20%2B%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20sub%28color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20Math.max%280%2C%20this.r%20-%20color2.r%29%3B%0A%20%20%20%20this.g%20%3D%20Math.max%280%2C%20this.g%20-%20color2.g%29%3B%0A%20%20%20%20this.b%20%3D%20Math.max%280%2C%20this.b%20-%20color2.b%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28color2%29%20%7B%0A%20%20%20%20this.r%20%2A%3D%20color2.r%3B%0A%20%20%20%20this.g%20%2A%3D%20color2.g%3B%0A%20%20%20%20this.b%20%2A%3D%20color2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28s%29%20%7B%0A%20%20%20%20this.r%20%2A%3D%20s%3B%0A%20%20%20%20this.g%20%2A%3D%20s%3B%0A%20%20%20%20this.b%20%2A%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerp%28color2%2C%20alpha%29%20%7B%0A%20%20%20%20this.r%20%2B%3D%20%28color2.r%20-%20this.r%29%20%2A%20alpha%3B%0A%20%20%20%20this.g%20%2B%3D%20%28color2.g%20-%20this.g%29%20%2A%20alpha%3B%0A%20%20%20%20this.b%20%2B%3D%20%28color2.b%20-%20this.b%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpColors%28color1%2C%20color2%2C%20alpha%29%20%7B%0A%20%20%20%20this.r%20%3D%20color1.r%20%2B%20%28color2.r%20-%20color1.r%29%20%2A%20alpha%3B%0A%20%20%20%20this.g%20%3D%20color1.g%20%2B%20%28color2.g%20-%20color1.g%29%20%2A%20alpha%3B%0A%20%20%20%20this.b%20%3D%20color1.b%20%2B%20%28color2.b%20-%20color1.b%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpHSL%28color2%2C%20alpha%29%20%7B%0A%20%20%20%20this.getHSL%28_hslA%29%3B%0A%20%20%20%20color2.getHSL%28_hslB%29%3B%0A%20%20%20%20const%20h%20%3D%20lerp%28_hslA.h%2C%20_hslB.h%2C%20alpha%29%3B%0A%20%20%20%20const%20s%20%3D%20lerp%28_hslA.s%2C%20_hslB.s%2C%20alpha%29%3B%0A%20%20%20%20const%20l%20%3D%20lerp%28_hslA.l%2C%20_hslB.l%2C%20alpha%29%3B%0A%20%20%20%20this.setHSL%28h%2C%20s%2C%20l%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromVector3%28v%29%20%7B%0A%20%20%20%20this.r%20%3D%20v.x%3B%0A%20%20%20%20this.g%20%3D%20v.y%3B%0A%20%20%20%20this.b%20%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix3%28m2%29%20%7B%0A%20%20%20%20const%20r%20%3D%20this.r%2C%20g%20%3D%20this.g%2C%20b%20%3D%20this.b%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.r%20%3D%20e%5B0%5D%20%2A%20r%20%2B%20e%5B3%5D%20%2A%20g%20%2B%20e%5B6%5D%20%2A%20b%3B%0A%20%20%20%20this.g%20%3D%20e%5B1%5D%20%2A%20r%20%2B%20e%5B4%5D%20%2A%20g%20%2B%20e%5B7%5D%20%2A%20b%3B%0A%20%20%20%20this.b%20%3D%20e%5B2%5D%20%2A%20r%20%2B%20e%5B5%5D%20%2A%20g%20%2B%20e%5B8%5D%20%2A%20b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28c2%29%20%7B%0A%20%20%20%20return%20c2.r%20%3D%3D%3D%20this.r%20%26%26%20c2.g%20%3D%3D%3D%20this.g%20%26%26%20c2.b%20%3D%3D%3D%20this.b%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.r%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this.g%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20this.b%20%3D%20array%5Boffset%20%2B%202%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this.r%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this.g%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this.b%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this.r%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this.g%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20this.b%20%3D%20attribute2.getZ%28index5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20return%20this.getHex%28%29%3B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this.r%3B%0A%20%20%20%20yield%20this.g%3B%0A%20%20%20%20yield%20this.b%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_color%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%28%29%3B%0AColor.NAMES%20%3D%20_colorKeywords%3B%0Avar%20_materialId%20%3D%200%3B%0Avar%20Material%20%3D%20class%20extends%20EventDispatcher%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22Material%22%3B%0A%20%20%7D%0A%20%20get%20type%28%29%20%7B%0A%20%20%20%20return%20this.constructor.type%3B%0A%20%20%7D%0A%20%20set%20type%28_value%29%20%7B%0A%20%20%7D%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMaterial%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_materialId%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID%28%29%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.blending%20%3D%20NormalBlending%3B%0A%20%20%20%20this.side%20%3D%20FrontSide%3B%0A%20%20%20%20this.vertexColors%20%3D%20false%3B%0A%20%20%20%20this.opacity%20%3D%201%3B%0A%20%20%20%20this.transparent%20%3D%20false%3B%0A%20%20%20%20this.alphaHash%20%3D%20false%3B%0A%20%20%20%20this.blendSrc%20%3D%20SrcAlphaFactor%3B%0A%20%20%20%20this.blendDst%20%3D%20OneMinusSrcAlphaFactor%3B%0A%20%20%20%20this.blendEquation%20%3D%20AddEquation%3B%0A%20%20%20%20this.blendSrcAlpha%20%3D%20null%3B%0A%20%20%20%20this.blendDstAlpha%20%3D%20null%3B%0A%20%20%20%20this.blendEquationAlpha%20%3D%20null%3B%0A%20%20%20%20this.blendColor%20%3D%20new%20Color%280%2C%200%2C%200%29%3B%0A%20%20%20%20this.blendAlpha%20%3D%200%3B%0A%20%20%20%20this.depthFunc%20%3D%20LessEqualDepth%3B%0A%20%20%20%20this.depthTest%20%3D%20true%3B%0A%20%20%20%20this.depthWrite%20%3D%20true%3B%0A%20%20%20%20this.stencilWriteMask%20%3D%20255%3B%0A%20%20%20%20this.stencilFunc%20%3D%20AlwaysStencilFunc%3B%0A%20%20%20%20this.stencilRef%20%3D%200%3B%0A%20%20%20%20this.stencilFuncMask%20%3D%20255%3B%0A%20%20%20%20this.stencilFail%20%3D%20KeepStencilOp%3B%0A%20%20%20%20this.stencilZFail%20%3D%20KeepStencilOp%3B%0A%20%20%20%20this.stencilZPass%20%3D%20KeepStencilOp%3B%0A%20%20%20%20this.stencilWrite%20%3D%20false%3B%0A%20%20%20%20this.clippingPlanes%20%3D%20null%3B%0A%20%20%20%20this.clipIntersection%20%3D%20false%3B%0A%20%20%20%20this.clipShadows%20%3D%20false%3B%0A%20%20%20%20this.shadowSide%20%3D%20null%3B%0A%20%20%20%20this.colorWrite%20%3D%20true%3B%0A%20%20%20%20this.precision%20%3D%20null%3B%0A%20%20%20%20this.polygonOffset%20%3D%20false%3B%0A%20%20%20%20this.polygonOffsetFactor%20%3D%200%3B%0A%20%20%20%20this.polygonOffsetUnits%20%3D%200%3B%0A%20%20%20%20this.dithering%20%3D%20false%3B%0A%20%20%20%20this.alphaToCoverage%20%3D%20false%3B%0A%20%20%20%20this.premultipliedAlpha%20%3D%20false%3B%0A%20%20%20%20this.forceSinglePass%20%3D%20false%3B%0A%20%20%20%20this.visible%20%3D%20true%3B%0A%20%20%20%20this.toneMapped%20%3D%20true%3B%0A%20%20%20%20this.userData%20%3D%20%7B%7D%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%20%20this._alphaTest%20%3D%200%3B%0A%20%20%7D%0A%20%20get%20alphaTest%28%29%20%7B%0A%20%20%20%20return%20this._alphaTest%3B%0A%20%20%7D%0A%20%20set%20alphaTest%28value%29%20%7B%0A%20%20%20%20if%20%28this._alphaTest%20%3E%200%20%21%3D%3D%20value%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._alphaTest%20%3D%20value%3B%0A%20%20%7D%0A%20%20%2F%2F%20onBeforeRender%20and%20onBeforeCompile%20only%20supported%20in%20WebGLRenderer%0A%20%20onBeforeRender%28%29%20%7B%0A%20%20%7D%0A%20%20onBeforeCompile%28%29%20%7B%0A%20%20%7D%0A%20%20customProgramCacheKey%28%29%20%7B%0A%20%20%20%20return%20this.onBeforeCompile.toString%28%29%3B%0A%20%20%7D%0A%20%20setValues%28values%29%20%7B%0A%20%20%20%20if%20%28values%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20for%20%28const%20key%20in%20values%29%20%7B%0A%20%20%20%20%20%20const%20newValue%20%3D%20values%5Bkey%5D%3B%0A%20%20%20%20%20%20if%20%28newValue%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%60THREE.Material%3A%20parameter%20%27%24%7Bkey%7D%27%20has%20value%20of%20undefined.%60%29%3B%0A%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20currentValue%20%3D%20this%5Bkey%5D%3B%0A%20%20%20%20%20%20if%20%28currentValue%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%60THREE.Material%3A%20%27%24%7Bkey%7D%27%20is%20not%20a%20property%20of%20THREE.%24%7Bthis.type%7D.%60%29%3B%0A%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28currentValue%20%26%26%20currentValue.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20currentValue.set%28newValue%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28currentValue%20%26%26%20currentValue.isVector3%20%26%26%20%28newValue%20%26%26%20newValue.isVector3%29%29%20%7B%0A%20%20%20%20%20%20%20%20currentValue.copy%28newValue%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this%5Bkey%5D%20%3D%20newValue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20isRootObject%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20if%20%28isRootObject%29%20%7B%0A%20%20%20%20%20%20meta%20%3D%20%7B%0A%20%20%20%20%20%20%20%20textures%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20images%3A%20%7B%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20data%20%3D%20%7B%0A%20%20%20%20%20%20metadata%3A%20%7B%0A%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22Material%22%2C%0A%20%20%20%20%20%20%20%20generator%3A%20%22Material.toJSON%22%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20data.uuid%20%3D%20this.uuid%3B%0A%20%20%20%20data.type%20%3D%20this.type%3B%0A%20%20%20%20if%20%28this.name%20%21%3D%3D%20%22%22%29%20data.name%20%3D%20this.name%3B%0A%20%20%20%20if%20%28this.color%20%26%26%20this.color.isColor%29%20data.color%20%3D%20this.color.getHex%28%29%3B%0A%20%20%20%20if%20%28this.roughness%20%21%3D%3D%20void%200%29%20data.roughness%20%3D%20this.roughness%3B%0A%20%20%20%20if%20%28this.metalness%20%21%3D%3D%20void%200%29%20data.metalness%20%3D%20this.metalness%3B%0A%20%20%20%20if%20%28this.sheen%20%21%3D%3D%20void%200%29%20data.sheen%20%3D%20this.sheen%3B%0A%20%20%20%20if%20%28this.sheenColor%20%26%26%20this.sheenColor.isColor%29%20data.sheenColor%20%3D%20this.sheenColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.sheenRoughness%20%21%3D%3D%20void%200%29%20data.sheenRoughness%20%3D%20this.sheenRoughness%3B%0A%20%20%20%20if%20%28this.emissive%20%26%26%20this.emissive.isColor%29%20data.emissive%20%3D%20this.emissive.getHex%28%29%3B%0A%20%20%20%20if%20%28this.emissiveIntensity%20%21%3D%3D%20void%200%20%26%26%20this.emissiveIntensity%20%21%3D%3D%201%29%20data.emissiveIntensity%20%3D%20this.emissiveIntensity%3B%0A%20%20%20%20if%20%28this.specular%20%26%26%20this.specular.isColor%29%20data.specular%20%3D%20this.specular.getHex%28%29%3B%0A%20%20%20%20if%20%28this.specularIntensity%20%21%3D%3D%20void%200%29%20data.specularIntensity%20%3D%20this.specularIntensity%3B%0A%20%20%20%20if%20%28this.specularColor%20%26%26%20this.specularColor.isColor%29%20data.specularColor%20%3D%20this.specularColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.shininess%20%21%3D%3D%20void%200%29%20data.shininess%20%3D%20this.shininess%3B%0A%20%20%20%20if%20%28this.clearcoat%20%21%3D%3D%20void%200%29%20data.clearcoat%20%3D%20this.clearcoat%3B%0A%20%20%20%20if%20%28this.clearcoatRoughness%20%21%3D%3D%20void%200%29%20data.clearcoatRoughness%20%3D%20this.clearcoatRoughness%3B%0A%20%20%20%20if%20%28this.clearcoatMap%20%26%26%20this.clearcoatMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.clearcoatMap%20%3D%20this.clearcoatMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearcoatRoughnessMap%20%26%26%20this.clearcoatRoughnessMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.clearcoatRoughnessMap%20%3D%20this.clearcoatRoughnessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearcoatNormalMap%20%26%26%20this.clearcoatNormalMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.clearcoatNormalMap%20%3D%20this.clearcoatNormalMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.clearcoatNormalScale%20%3D%20this.clearcoatNormalScale.toArray%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.dispersion%20%21%3D%3D%20void%200%29%20data.dispersion%20%3D%20this.dispersion%3B%0A%20%20%20%20if%20%28this.iridescence%20%21%3D%3D%20void%200%29%20data.iridescence%20%3D%20this.iridescence%3B%0A%20%20%20%20if%20%28this.iridescenceIOR%20%21%3D%3D%20void%200%29%20data.iridescenceIOR%20%3D%20this.iridescenceIOR%3B%0A%20%20%20%20if%20%28this.iridescenceThicknessRange%20%21%3D%3D%20void%200%29%20data.iridescenceThicknessRange%20%3D%20this.iridescenceThicknessRange%3B%0A%20%20%20%20if%20%28this.iridescenceMap%20%26%26%20this.iridescenceMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.iridescenceMap%20%3D%20this.iridescenceMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.iridescenceThicknessMap%20%26%26%20this.iridescenceThicknessMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.iridescenceThicknessMap%20%3D%20this.iridescenceThicknessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.anisotropy%20%21%3D%3D%20void%200%29%20data.anisotropy%20%3D%20this.anisotropy%3B%0A%20%20%20%20if%20%28this.anisotropyRotation%20%21%3D%3D%20void%200%29%20data.anisotropyRotation%20%3D%20this.anisotropyRotation%3B%0A%20%20%20%20if%20%28this.anisotropyMap%20%26%26%20this.anisotropyMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.anisotropyMap%20%3D%20this.anisotropyMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.map%20%26%26%20this.map.isTexture%29%20data.map%20%3D%20this.map.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.matcap%20%26%26%20this.matcap.isTexture%29%20data.matcap%20%3D%20this.matcap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.alphaMap%20%26%26%20this.alphaMap.isTexture%29%20data.alphaMap%20%3D%20this.alphaMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.lightMap%20%26%26%20this.lightMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.lightMap%20%3D%20this.lightMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.lightMapIntensity%20%3D%20this.lightMapIntensity%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.aoMap%20%26%26%20this.aoMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.aoMap%20%3D%20this.aoMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.aoMapIntensity%20%3D%20this.aoMapIntensity%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.bumpMap%20%26%26%20this.bumpMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.bumpMap%20%3D%20this.bumpMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.bumpScale%20%3D%20this.bumpScale%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.normalMap%20%26%26%20this.normalMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.normalMap%20%3D%20this.normalMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.normalMapType%20%3D%20this.normalMapType%3B%0A%20%20%20%20%20%20data.normalScale%20%3D%20this.normalScale.toArray%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.displacementMap%20%26%26%20this.displacementMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.displacementMap%20%3D%20this.displacementMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.displacementScale%20%3D%20this.displacementScale%3B%0A%20%20%20%20%20%20data.displacementBias%20%3D%20this.displacementBias%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.roughnessMap%20%26%26%20this.roughnessMap.isTexture%29%20data.roughnessMap%20%3D%20this.roughnessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.metalnessMap%20%26%26%20this.metalnessMap.isTexture%29%20data.metalnessMap%20%3D%20this.metalnessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.emissiveMap%20%26%26%20this.emissiveMap.isTexture%29%20data.emissiveMap%20%3D%20this.emissiveMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.specularMap%20%26%26%20this.specularMap.isTexture%29%20data.specularMap%20%3D%20this.specularMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.specularIntensityMap%20%26%26%20this.specularIntensityMap.isTexture%29%20data.specularIntensityMap%20%3D%20this.specularIntensityMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.specularColorMap%20%26%26%20this.specularColorMap.isTexture%29%20data.specularColorMap%20%3D%20this.specularColorMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.envMap%20%26%26%20this.envMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.envMap%20%3D%20this.envMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20if%20%28this.combine%20%21%3D%3D%20void%200%29%20data.combine%20%3D%20this.combine%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.envMapRotation%20%21%3D%3D%20void%200%29%20data.envMapRotation%20%3D%20this.envMapRotation.toArray%28%29%3B%0A%20%20%20%20if%20%28this.envMapIntensity%20%21%3D%3D%20void%200%29%20data.envMapIntensity%20%3D%20this.envMapIntensity%3B%0A%20%20%20%20if%20%28this.reflectivity%20%21%3D%3D%20void%200%29%20data.reflectivity%20%3D%20this.reflectivity%3B%0A%20%20%20%20if%20%28this.refractionRatio%20%21%3D%3D%20void%200%29%20data.refractionRatio%20%3D%20this.refractionRatio%3B%0A%20%20%20%20if%20%28this.gradientMap%20%26%26%20this.gradientMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.gradientMap%20%3D%20this.gradientMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.transmission%20%21%3D%3D%20void%200%29%20data.transmission%20%3D%20this.transmission%3B%0A%20%20%20%20if%20%28this.transmissionMap%20%26%26%20this.transmissionMap.isTexture%29%20data.transmissionMap%20%3D%20this.transmissionMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.thickness%20%21%3D%3D%20void%200%29%20data.thickness%20%3D%20this.thickness%3B%0A%20%20%20%20if%20%28this.thicknessMap%20%26%26%20this.thicknessMap.isTexture%29%20data.thicknessMap%20%3D%20this.thicknessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.attenuationDistance%20%21%3D%3D%20void%200%20%26%26%20this.attenuationDistance%20%21%3D%3D%20Infinity%29%20data.attenuationDistance%20%3D%20this.attenuationDistance%3B%0A%20%20%20%20if%20%28this.attenuationColor%20%21%3D%3D%20void%200%29%20data.attenuationColor%20%3D%20this.attenuationColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.size%20%21%3D%3D%20void%200%29%20data.size%20%3D%20this.size%3B%0A%20%20%20%20if%20%28this.shadowSide%20%21%3D%3D%20null%29%20data.shadowSide%20%3D%20this.shadowSide%3B%0A%20%20%20%20if%20%28this.sizeAttenuation%20%21%3D%3D%20void%200%29%20data.sizeAttenuation%20%3D%20this.sizeAttenuation%3B%0A%20%20%20%20if%20%28this.blending%20%21%3D%3D%20NormalBlending%29%20data.blending%20%3D%20this.blending%3B%0A%20%20%20%20if%20%28this.side%20%21%3D%3D%20FrontSide%29%20data.side%20%3D%20this.side%3B%0A%20%20%20%20if%20%28this.vertexColors%20%3D%3D%3D%20true%29%20data.vertexColors%20%3D%20true%3B%0A%20%20%20%20if%20%28this.opacity%20%3C%201%29%20data.opacity%20%3D%20this.opacity%3B%0A%20%20%20%20if%20%28this.transparent%20%3D%3D%3D%20true%29%20data.transparent%20%3D%20true%3B%0A%20%20%20%20if%20%28this.blendSrc%20%21%3D%3D%20SrcAlphaFactor%29%20data.blendSrc%20%3D%20this.blendSrc%3B%0A%20%20%20%20if%20%28this.blendDst%20%21%3D%3D%20OneMinusSrcAlphaFactor%29%20data.blendDst%20%3D%20this.blendDst%3B%0A%20%20%20%20if%20%28this.blendEquation%20%21%3D%3D%20AddEquation%29%20data.blendEquation%20%3D%20this.blendEquation%3B%0A%20%20%20%20if%20%28this.blendSrcAlpha%20%21%3D%3D%20null%29%20data.blendSrcAlpha%20%3D%20this.blendSrcAlpha%3B%0A%20%20%20%20if%20%28this.blendDstAlpha%20%21%3D%3D%20null%29%20data.blendDstAlpha%20%3D%20this.blendDstAlpha%3B%0A%20%20%20%20if%20%28this.blendEquationAlpha%20%21%3D%3D%20null%29%20data.blendEquationAlpha%20%3D%20this.blendEquationAlpha%3B%0A%20%20%20%20if%20%28this.blendColor%20%26%26%20this.blendColor.isColor%29%20data.blendColor%20%3D%20this.blendColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.blendAlpha%20%21%3D%3D%200%29%20data.blendAlpha%20%3D%20this.blendAlpha%3B%0A%20%20%20%20if%20%28this.depthFunc%20%21%3D%3D%20LessEqualDepth%29%20data.depthFunc%20%3D%20this.depthFunc%3B%0A%20%20%20%20if%20%28this.depthTest%20%3D%3D%3D%20false%29%20data.depthTest%20%3D%20this.depthTest%3B%0A%20%20%20%20if%20%28this.depthWrite%20%3D%3D%3D%20false%29%20data.depthWrite%20%3D%20this.depthWrite%3B%0A%20%20%20%20if%20%28this.colorWrite%20%3D%3D%3D%20false%29%20data.colorWrite%20%3D%20this.colorWrite%3B%0A%20%20%20%20if%20%28this.stencilWriteMask%20%21%3D%3D%20255%29%20data.stencilWriteMask%20%3D%20this.stencilWriteMask%3B%0A%20%20%20%20if%20%28this.stencilFunc%20%21%3D%3D%20AlwaysStencilFunc%29%20data.stencilFunc%20%3D%20this.stencilFunc%3B%0A%20%20%20%20if%20%28this.stencilRef%20%21%3D%3D%200%29%20data.stencilRef%20%3D%20this.stencilRef%3B%0A%20%20%20%20if%20%28this.stencilFuncMask%20%21%3D%3D%20255%29%20data.stencilFuncMask%20%3D%20this.stencilFuncMask%3B%0A%20%20%20%20if%20%28this.stencilFail%20%21%3D%3D%20KeepStencilOp%29%20data.stencilFail%20%3D%20this.stencilFail%3B%0A%20%20%20%20if%20%28this.stencilZFail%20%21%3D%3D%20KeepStencilOp%29%20data.stencilZFail%20%3D%20this.stencilZFail%3B%0A%20%20%20%20if%20%28this.stencilZPass%20%21%3D%3D%20KeepStencilOp%29%20data.stencilZPass%20%3D%20this.stencilZPass%3B%0A%20%20%20%20if%20%28this.stencilWrite%20%3D%3D%3D%20true%29%20data.stencilWrite%20%3D%20this.stencilWrite%3B%0A%20%20%20%20if%20%28this.rotation%20%21%3D%3D%20void%200%20%26%26%20this.rotation%20%21%3D%3D%200%29%20data.rotation%20%3D%20this.rotation%3B%0A%20%20%20%20if%20%28this.polygonOffset%20%3D%3D%3D%20true%29%20data.polygonOffset%20%3D%20true%3B%0A%20%20%20%20if%20%28this.polygonOffsetFactor%20%21%3D%3D%200%29%20data.polygonOffsetFactor%20%3D%20this.polygonOffsetFactor%3B%0A%20%20%20%20if%20%28this.polygonOffsetUnits%20%21%3D%3D%200%29%20data.polygonOffsetUnits%20%3D%20this.polygonOffsetUnits%3B%0A%20%20%20%20if%20%28this.linewidth%20%21%3D%3D%20void%200%20%26%26%20this.linewidth%20%21%3D%3D%201%29%20data.linewidth%20%3D%20this.linewidth%3B%0A%20%20%20%20if%20%28this.dashSize%20%21%3D%3D%20void%200%29%20data.dashSize%20%3D%20this.dashSize%3B%0A%20%20%20%20if%20%28this.gapSize%20%21%3D%3D%20void%200%29%20data.gapSize%20%3D%20this.gapSize%3B%0A%20%20%20%20if%20%28this.scale%20%21%3D%3D%20void%200%29%20data.scale%20%3D%20this.scale%3B%0A%20%20%20%20if%20%28this.dithering%20%3D%3D%3D%20true%29%20data.dithering%20%3D%20true%3B%0A%20%20%20%20if%20%28this.alphaTest%20%3E%200%29%20data.alphaTest%20%3D%20this.alphaTest%3B%0A%20%20%20%20if%20%28this.alphaHash%20%3D%3D%3D%20true%29%20data.alphaHash%20%3D%20true%3B%0A%20%20%20%20if%20%28this.alphaToCoverage%20%3D%3D%3D%20true%29%20data.alphaToCoverage%20%3D%20true%3B%0A%20%20%20%20if%20%28this.premultipliedAlpha%20%3D%3D%3D%20true%29%20data.premultipliedAlpha%20%3D%20true%3B%0A%20%20%20%20if%20%28this.forceSinglePass%20%3D%3D%3D%20true%29%20data.forceSinglePass%20%3D%20true%3B%0A%20%20%20%20if%20%28this.wireframe%20%3D%3D%3D%20true%29%20data.wireframe%20%3D%20true%3B%0A%20%20%20%20if%20%28this.wireframeLinewidth%20%3E%201%29%20data.wireframeLinewidth%20%3D%20this.wireframeLinewidth%3B%0A%20%20%20%20if%20%28this.wireframeLinecap%20%21%3D%3D%20%22round%22%29%20data.wireframeLinecap%20%3D%20this.wireframeLinecap%3B%0A%20%20%20%20if%20%28this.wireframeLinejoin%20%21%3D%3D%20%22round%22%29%20data.wireframeLinejoin%20%3D%20this.wireframeLinejoin%3B%0A%20%20%20%20if%20%28this.flatShading%20%3D%3D%3D%20true%29%20data.flatShading%20%3D%20true%3B%0A%20%20%20%20if%20%28this.visible%20%3D%3D%3D%20false%29%20data.visible%20%3D%20false%3B%0A%20%20%20%20if%20%28this.toneMapped%20%3D%3D%3D%20false%29%20data.toneMapped%20%3D%20false%3B%0A%20%20%20%20if%20%28this.fog%20%3D%3D%3D%20false%29%20data.fog%20%3D%20false%3B%0A%20%20%20%20if%20%28Object.keys%28this.userData%29.length%20%3E%200%29%20data.userData%20%3D%20this.userData%3B%0A%20%20%20%20function%20extractFromCache%28cache2%29%20%7B%0A%20%20%20%20%20%20const%20values%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28const%20key%20in%20cache2%29%20%7B%0A%20%20%20%20%20%20%20%20const%20data2%20%3D%20cache2%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20delete%20data2.metadata%3B%0A%20%20%20%20%20%20%20%20values.push%28data2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20values%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isRootObject%29%20%7B%0A%20%20%20%20%20%20const%20textures%20%3D%20extractFromCache%28meta.textures%29%3B%0A%20%20%20%20%20%20const%20images%20%3D%20extractFromCache%28meta.images%29%3B%0A%20%20%20%20%20%20if%20%28textures.length%20%3E%200%29%20data.textures%20%3D%20textures%3B%0A%20%20%20%20%20%20if%20%28images.length%20%3E%200%29%20data.images%20%3D%20images%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20this.blending%20%3D%20source.blending%3B%0A%20%20%20%20this.side%20%3D%20source.side%3B%0A%20%20%20%20this.vertexColors%20%3D%20source.vertexColors%3B%0A%20%20%20%20this.opacity%20%3D%20source.opacity%3B%0A%20%20%20%20this.transparent%20%3D%20source.transparent%3B%0A%20%20%20%20this.blendSrc%20%3D%20source.blendSrc%3B%0A%20%20%20%20this.blendDst%20%3D%20source.blendDst%3B%0A%20%20%20%20this.blendEquation%20%3D%20source.blendEquation%3B%0A%20%20%20%20this.blendSrcAlpha%20%3D%20source.blendSrcAlpha%3B%0A%20%20%20%20this.blendDstAlpha%20%3D%20source.blendDstAlpha%3B%0A%20%20%20%20this.blendEquationAlpha%20%3D%20source.blendEquationAlpha%3B%0A%20%20%20%20this.blendColor.copy%28source.blendColor%29%3B%0A%20%20%20%20this.blendAlpha%20%3D%20source.blendAlpha%3B%0A%20%20%20%20this.depthFunc%20%3D%20source.depthFunc%3B%0A%20%20%20%20this.depthTest%20%3D%20source.depthTest%3B%0A%20%20%20%20this.depthWrite%20%3D%20source.depthWrite%3B%0A%20%20%20%20this.stencilWriteMask%20%3D%20source.stencilWriteMask%3B%0A%20%20%20%20this.stencilFunc%20%3D%20source.stencilFunc%3B%0A%20%20%20%20this.stencilRef%20%3D%20source.stencilRef%3B%0A%20%20%20%20this.stencilFuncMask%20%3D%20source.stencilFuncMask%3B%0A%20%20%20%20this.stencilFail%20%3D%20source.stencilFail%3B%0A%20%20%20%20this.stencilZFail%20%3D%20source.stencilZFail%3B%0A%20%20%20%20this.stencilZPass%20%3D%20source.stencilZPass%3B%0A%20%20%20%20this.stencilWrite%20%3D%20source.stencilWrite%3B%0A%20%20%20%20const%20srcPlanes%20%3D%20source.clippingPlanes%3B%0A%20%20%20%20let%20dstPlanes%20%3D%20null%3B%0A%20%20%20%20if%20%28srcPlanes%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20n%20%3D%20srcPlanes.length%3B%0A%20%20%20%20%20%20dstPlanes%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20dstPlanes%5Bi%5D%20%3D%20srcPlanes%5Bi%5D.clone%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.clippingPlanes%20%3D%20dstPlanes%3B%0A%20%20%20%20this.clipIntersection%20%3D%20source.clipIntersection%3B%0A%20%20%20%20this.clipShadows%20%3D%20source.clipShadows%3B%0A%20%20%20%20this.shadowSide%20%3D%20source.shadowSide%3B%0A%20%20%20%20this.colorWrite%20%3D%20source.colorWrite%3B%0A%20%20%20%20this.precision%20%3D%20source.precision%3B%0A%20%20%20%20this.polygonOffset%20%3D%20source.polygonOffset%3B%0A%20%20%20%20this.polygonOffsetFactor%20%3D%20source.polygonOffsetFactor%3B%0A%20%20%20%20this.polygonOffsetUnits%20%3D%20source.polygonOffsetUnits%3B%0A%20%20%20%20this.dithering%20%3D%20source.dithering%3B%0A%20%20%20%20this.alphaTest%20%3D%20source.alphaTest%3B%0A%20%20%20%20this.alphaHash%20%3D%20source.alphaHash%3B%0A%20%20%20%20this.alphaToCoverage%20%3D%20source.alphaToCoverage%3B%0A%20%20%20%20this.premultipliedAlpha%20%3D%20source.premultipliedAlpha%3B%0A%20%20%20%20this.forceSinglePass%20%3D%20source.forceSinglePass%3B%0A%20%20%20%20this.visible%20%3D%20source.visible%3B%0A%20%20%20%20this.toneMapped%20%3D%20source.toneMapped%3B%0A%20%20%20%20this.userData%20%3D%20JSON.parse%28JSON.stringify%28source.userData%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20this.version%2B%2B%3B%0A%20%20%7D%0A%20%20onBuild%28%29%20%7B%0A%20%20%20%20console.warn%28%22Material%3A%20onBuild%28%29%20has%20been%20removed.%22%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshBasicMaterial%20%3D%20class%20extends%20Material%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshBasicMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshBasicMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color%2816777215%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.lightMap%20%3D%20null%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%201%3B%0A%20%20%20%20this.aoMap%20%3D%20null%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%201%3B%0A%20%20%20%20this.specularMap%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.envMap%20%3D%20null%3B%0A%20%20%20%20this.envMapRotation%20%3D%20new%20Euler%28%29%3B%0A%20%20%20%20this.combine%20%3D%20MultiplyOperation%3B%0A%20%20%20%20this.reflectivity%20%3D%201%3B%0A%20%20%20%20this.refractionRatio%20%3D%200.98%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20%22round%22%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20%22round%22%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.lightMap%20%3D%20source.lightMap%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%20source.lightMapIntensity%3B%0A%20%20%20%20this.aoMap%20%3D%20source.aoMap%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%20source.aoMapIntensity%3B%0A%20%20%20%20this.specularMap%20%3D%20source.specularMap%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.envMap%20%3D%20source.envMap%3B%0A%20%20%20%20this.envMapRotation.copy%28source.envMapRotation%29%3B%0A%20%20%20%20this.combine%20%3D%20source.combine%3B%0A%20%20%20%20this.reflectivity%20%3D%20source.reflectivity%3B%0A%20%20%20%20this.refractionRatio%20%3D%20source.refractionRatio%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20source.wireframeLinecap%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20source.wireframeLinejoin%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_vector%249%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vector2%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector2%28%29%3B%0Avar%20BufferAttribute%20%3D%20class%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%20%3D%20false%29%20%7B%0A%20%20%20%20if%20%28Array.isArray%28array%29%29%20%7B%0A%20%20%20%20%20%20throw%20new%20TypeError%28%22THREE.BufferAttribute%3A%20array%20should%20be%20a%20Typed%20Array.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.isBufferAttribute%20%3D%20true%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.array%20%3D%20array%3B%0A%20%20%20%20this.itemSize%20%3D%20itemSize%3B%0A%20%20%20%20this.count%20%3D%20array%20%21%3D%3D%20void%200%20%3F%20array.length%20%2F%20itemSize%20%3A%200%3B%0A%20%20%20%20this.normalized%20%3D%20normalized%3B%0A%20%20%20%20this.usage%20%3D%20StaticDrawUsage%3B%0A%20%20%20%20this.updateRanges%20%3D%20%5B%5D%3B%0A%20%20%20%20this.gpuType%20%3D%20FloatType%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%7D%0A%20%20onUploadCallback%28%29%20%7B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20this.version%2B%2B%3B%0A%20%20%7D%0A%20%20setUsage%28value%29%20%7B%0A%20%20%20%20this.usage%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addUpdateRange%28start%2C%20count%29%20%7B%0A%20%20%20%20this.updateRanges.push%28%7B%20start%2C%20count%20%7D%29%3B%0A%20%20%7D%0A%20%20clearUpdateRanges%28%29%20%7B%0A%20%20%20%20this.updateRanges.length%20%3D%200%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20this.array%20%3D%20new%20source.array.constructor%28source.array%29%3B%0A%20%20%20%20this.itemSize%20%3D%20source.itemSize%3B%0A%20%20%20%20this.count%20%3D%20source.count%3B%0A%20%20%20%20this.normalized%20%3D%20source.normalized%3B%0A%20%20%20%20this.usage%20%3D%20source.usage%3B%0A%20%20%20%20this.gpuType%20%3D%20source.gpuType%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copyAt%28index1%2C%20attribute2%2C%20index22%29%20%7B%0A%20%20%20%20index1%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20index22%20%2A%3D%20attribute2.itemSize%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.itemSize%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.array%5Bindex1%20%2B%20i%5D%20%3D%20attribute2.array%5Bindex22%20%2B%20i%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copyArray%28array%29%20%7B%0A%20%20%20%20this.array.set%28array%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix3%28m2%29%20%7B%0A%20%20%20%20if%20%28this.itemSize%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20_vector2%241.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20_vector2%241.applyMatrix3%28m2%29%3B%0A%20%20%20%20%20%20%20%20this.setXY%28i%2C%20_vector2%241.x%2C%20_vector2%241.y%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28this.itemSize%20%3D%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20_vector%249.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20_vector%249.applyMatrix3%28m2%29%3B%0A%20%20%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%249.x%2C%20_vector%249.y%2C%20_vector%249.z%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix4%28m2%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%249.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%249.applyMatrix4%28m2%29%3B%0A%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%249.x%2C%20_vector%249.y%2C%20_vector%249.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyNormalMatrix%28m2%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%249.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%249.applyNormalMatrix%28m2%29%3B%0A%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%249.x%2C%20_vector%249.y%2C%20_vector%249.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20transformDirection%28m2%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%249.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%249.transformDirection%28m2%29%3B%0A%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%249.x%2C%20_vector%249.y%2C%20_vector%249.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20set%28value%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.array.set%28value%2C%20offset%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getComponent%28index5%2C%20component%29%20%7B%0A%20%20%20%20let%20value%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%20component%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20value%20%3D%20denormalize%28value%2C%20this.array%29%3B%0A%20%20%20%20return%20value%3B%0A%20%20%7D%0A%20%20setComponent%28index5%2C%20component%2C%20value%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20value%20%3D%20normalize%28value%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%20component%5D%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getX%28index5%29%20%7B%0A%20%20%20%20let%20x2%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20x2%20%3D%20denormalize%28x2%2C%20this.array%29%3B%0A%20%20%20%20return%20x2%3B%0A%20%20%7D%0A%20%20setX%28index5%2C%20x2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20x2%20%3D%20normalize%28x2%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%5D%20%3D%20x2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getY%28index5%29%20%7B%0A%20%20%20%20let%20y2%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%201%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20y2%20%3D%20denormalize%28y2%2C%20this.array%29%3B%0A%20%20%20%20return%20y2%3B%0A%20%20%7D%0A%20%20setY%28index5%2C%20y2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20y2%20%3D%20normalize%28y2%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getZ%28index5%29%20%7B%0A%20%20%20%20let%20z2%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%202%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20z2%20%3D%20denormalize%28z2%2C%20this.array%29%3B%0A%20%20%20%20return%20z2%3B%0A%20%20%7D%0A%20%20setZ%28index5%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20z2%20%3D%20normalize%28z2%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%202%5D%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getW%28index5%29%20%7B%0A%20%20%20%20let%20w%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%203%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20w%20%3D%20denormalize%28w%2C%20this.array%29%3B%0A%20%20%20%20return%20w%3B%0A%20%20%7D%0A%20%20setW%28index5%2C%20w%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20w%20%3D%20normalize%28w%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%203%5D%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXY%28index5%2C%20x2%2C%20y2%29%20%7B%0A%20%20%20%20index5%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%28y2%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.array%5Bindex5%20%2B%200%5D%20%3D%20x2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXYZ%28index5%2C%20x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20index5%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%28y2%2C%20this.array%29%3B%0A%20%20%20%20%20%20z2%20%3D%20normalize%28z2%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.array%5Bindex5%20%2B%200%5D%20%3D%20x2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%202%5D%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXYZW%28index5%2C%20x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20index5%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%28y2%2C%20this.array%29%3B%0A%20%20%20%20%20%20z2%20%3D%20normalize%28z2%2C%20this.array%29%3B%0A%20%20%20%20%20%20w%20%3D%20normalize%28w%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.array%5Bindex5%20%2B%200%5D%20%3D%20x2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%202%5D%20%3D%20z2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%203%5D%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20onUpload%28callback%29%20%7B%0A%20%20%20%20this.onUploadCallback%20%3D%20callback%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.array%2C%20this.itemSize%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20%7B%0A%20%20%20%20%20%20itemSize%3A%20this.itemSize%2C%0A%20%20%20%20%20%20type%3A%20this.array.constructor.name%2C%0A%20%20%20%20%20%20array%3A%20Array.from%28this.array%29%2C%0A%20%20%20%20%20%20normalized%3A%20this.normalized%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28this.name%20%21%3D%3D%20%22%22%29%20data.name%20%3D%20this.name%3B%0A%20%20%20%20if%20%28this.usage%20%21%3D%3D%20StaticDrawUsage%29%20data.usage%20%3D%20this.usage%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Uint16BufferAttribute%20%3D%20class%20extends%20BufferAttribute%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%29%20%7B%0A%20%20%20%20super%28new%20Uint16Array%28array%29%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Uint32BufferAttribute%20%3D%20class%20extends%20BufferAttribute%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%29%20%7B%0A%20%20%20%20super%28new%20Uint32Array%28array%29%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Float32BufferAttribute%20%3D%20class%20extends%20BufferAttribute%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%29%20%7B%0A%20%20%20%20super%28new%20Float32Array%28array%29%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_id%242%20%3D%200%3B%0Avar%20_m1%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Avar%20_obj%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Object3D%28%29%3B%0Avar%20_offset%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_box%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Box3%28%29%3B%0Avar%20_boxMorphTargets%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Box3%28%29%3B%0Avar%20_vector%248%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20BufferGeometry%20%3D%20class%20_BufferGeometry%20extends%20EventDispatcher%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isBufferGeometry%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_id%242%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID%28%29%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.type%20%3D%20%22BufferGeometry%22%3B%0A%20%20%20%20this.index%20%3D%20null%3B%0A%20%20%20%20this.indirect%20%3D%20null%3B%0A%20%20%20%20this.attributes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.morphAttributes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.morphTargetsRelative%20%3D%20false%3B%0A%20%20%20%20this.groups%20%3D%20%5B%5D%3B%0A%20%20%20%20this.boundingBox%20%3D%20null%3B%0A%20%20%20%20this.boundingSphere%20%3D%20null%3B%0A%20%20%20%20this.drawRange%20%3D%20%7B%20start%3A%200%2C%20count%3A%20Infinity%20%7D%3B%0A%20%20%20%20this.userData%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20getIndex%28%29%20%7B%0A%20%20%20%20return%20this.index%3B%0A%20%20%7D%0A%20%20setIndex%28index5%29%20%7B%0A%20%20%20%20if%20%28Array.isArray%28index5%29%29%20%7B%0A%20%20%20%20%20%20this.index%20%3D%20new%20%28arrayNeedsUint32%28index5%29%20%3F%20Uint32BufferAttribute%20%3A%20Uint16BufferAttribute%29%28index5%2C%201%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.index%20%3D%20index5%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setIndirect%28indirect%29%20%7B%0A%20%20%20%20this.indirect%20%3D%20indirect%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getIndirect%28%29%20%7B%0A%20%20%20%20return%20this.indirect%3B%0A%20%20%7D%0A%20%20getAttribute%28name%29%20%7B%0A%20%20%20%20return%20this.attributes%5Bname%5D%3B%0A%20%20%7D%0A%20%20setAttribute%28name%2C%20attribute2%29%20%7B%0A%20%20%20%20this.attributes%5Bname%5D%20%3D%20attribute2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20deleteAttribute%28name%29%20%7B%0A%20%20%20%20delete%20this.attributes%5Bname%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20hasAttribute%28name%29%20%7B%0A%20%20%20%20return%20this.attributes%5Bname%5D%20%21%3D%3D%20void%200%3B%0A%20%20%7D%0A%20%20addGroup%28start%2C%20count%2C%20materialIndex%20%3D%200%29%20%7B%0A%20%20%20%20this.groups.push%28%7B%0A%20%20%20%20%20%20start%2C%0A%20%20%20%20%20%20count%2C%0A%20%20%20%20%20%20materialIndex%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20clearGroups%28%29%20%7B%0A%20%20%20%20this.groups%20%3D%20%5B%5D%3B%0A%20%20%7D%0A%20%20setDrawRange%28start%2C%20count%29%20%7B%0A%20%20%20%20this.drawRange.start%20%3D%20start%3B%0A%20%20%20%20this.drawRange.count%20%3D%20count%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%29%20%7B%0A%20%20%20%20const%20position%20%3D%20this.attributes.position%3B%0A%20%20%20%20if%20%28position%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20position.applyMatrix4%28matrix%29%3B%0A%20%20%20%20%20%20position.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20normal2%20%3D%20this.attributes.normal%3B%0A%20%20%20%20if%20%28normal2%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20normalMatrix%20%3D%20new%20Matrix3%28%29.getNormalMatrix%28matrix%29%3B%0A%20%20%20%20%20%20normal2.applyNormalMatrix%28normalMatrix%29%3B%0A%20%20%20%20%20%20normal2.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20tangent%20%3D%20this.attributes.tangent%3B%0A%20%20%20%20if%20%28tangent%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20tangent.transformDirection%28matrix%29%3B%0A%20%20%20%20%20%20tangent.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.boundingBox%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.computeBoundingBox%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.boundingSphere%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.computeBoundingSphere%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyQuaternion%28q%29%20%7B%0A%20%20%20%20_m1%242.makeRotationFromQuaternion%28q%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%242%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateX%28angle%29%20%7B%0A%20%20%20%20_m1%242.makeRotationX%28angle%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%242%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateY%28angle%29%20%7B%0A%20%20%20%20_m1%242.makeRotationY%28angle%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%242%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateZ%28angle%29%20%7B%0A%20%20%20%20_m1%242.makeRotationZ%28angle%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%242%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20_m1%242.makeTranslation%28x2%2C%20y2%2C%20z2%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%242%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20scale%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20_m1%242.makeScale%28x2%2C%20y2%2C%20z2%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%242%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lookAt%28vector%29%20%7B%0A%20%20%20%20_obj.lookAt%28vector%29%3B%0A%20%20%20%20_obj.updateMatrix%28%29%3B%0A%20%20%20%20this.applyMatrix4%28_obj.matrix%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20center%28%29%20%7B%0A%20%20%20%20this.computeBoundingBox%28%29%3B%0A%20%20%20%20this.boundingBox.getCenter%28_offset%29.negate%28%29%3B%0A%20%20%20%20this.translate%28_offset.x%2C%20_offset.y%2C%20_offset.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromPoints%28points%29%20%7B%0A%20%20%20%20const%20positionAttribute%20%3D%20this.getAttribute%28%22position%22%29%3B%0A%20%20%20%20if%20%28positionAttribute%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20position%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20points.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20point%20%3D%20points%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20position.push%28point.x%2C%20point.y%2C%20point.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute%28position%2C%203%29%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20positionAttribute.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20point%20%3D%20points%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20positionAttribute.setXYZ%28i%2C%20point.x%2C%20point.y%2C%20point.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28points.length%20%3E%20positionAttribute.count%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.BufferGeometry%3A%20Buffer%20size%20too%20small%20for%20points%20data.%20Use%20.dispose%28%29%20and%20create%20a%20new%20geometry.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20positionAttribute.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20computeBoundingBox%28%29%20%7B%0A%20%20%20%20if%20%28this.boundingBox%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.boundingBox%20%3D%20new%20Box3%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20position%20%3D%20this.attributes.position%3B%0A%20%20%20%20const%20morphAttributesPosition%20%3D%20this.morphAttributes.position%3B%0A%20%20%20%20if%20%28position%20%26%26%20position.isGLBufferAttribute%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.BufferGeometry.computeBoundingBox%28%29%3A%20GLBufferAttribute%20requires%20a%20manual%20bounding%20box.%22%2C%20this%29%3B%0A%20%20%20%20%20%20this.boundingBox.set%28%0A%20%20%20%20%20%20%20%20new%20Vector3%28-Infinity%2C%20-Infinity%2C%20-Infinity%29%2C%0A%20%20%20%20%20%20%20%20new%20Vector3%28Infinity%2C%20Infinity%2C%20Infinity%29%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28position%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.boundingBox.setFromBufferAttribute%28position%29%3B%0A%20%20%20%20%20%20if%20%28morphAttributesPosition%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphAttributesPosition.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributesPosition%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20_box%242.setFromBufferAttribute%28morphAttribute%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.morphTargetsRelative%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%248.addVectors%28this.boundingBox.min%2C%20_box%242.min%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.boundingBox.expandByPoint%28_vector%248%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%248.addVectors%28this.boundingBox.max%2C%20_box%242.max%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.boundingBox.expandByPoint%28_vector%248%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.boundingBox.expandByPoint%28_box%242.min%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.boundingBox.expandByPoint%28_box%242.max%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.boundingBox.makeEmpty%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isNaN%28this.boundingBox.min.x%29%20%7C%7C%20isNaN%28this.boundingBox.min.y%29%20%7C%7C%20isNaN%28this.boundingBox.min.z%29%29%20%7B%0A%20%20%20%20%20%20console.error%28%27THREE.BufferGeometry.computeBoundingBox%28%29%3A%20Computed%20min%2Fmax%20have%20NaN%20values.%20The%20%22position%22%20attribute%20is%20likely%20to%20have%20NaN%20values.%27%2C%20this%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20computeBoundingSphere%28%29%20%7B%0A%20%20%20%20if%20%28this.boundingSphere%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.boundingSphere%20%3D%20new%20Sphere%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20position%20%3D%20this.attributes.position%3B%0A%20%20%20%20const%20morphAttributesPosition%20%3D%20this.morphAttributes.position%3B%0A%20%20%20%20if%20%28position%20%26%26%20position.isGLBufferAttribute%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.BufferGeometry.computeBoundingSphere%28%29%3A%20GLBufferAttribute%20requires%20a%20manual%20bounding%20sphere.%22%2C%20this%29%3B%0A%20%20%20%20%20%20this.boundingSphere.set%28new%20Vector3%28%29%2C%20Infinity%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28position%29%20%7B%0A%20%20%20%20%20%20const%20center%20%3D%20this.boundingSphere.center%3B%0A%20%20%20%20%20%20_box%242.setFromBufferAttribute%28position%29%3B%0A%20%20%20%20%20%20if%20%28morphAttributesPosition%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphAttributesPosition.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributesPosition%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20_boxMorphTargets.setFromBufferAttribute%28morphAttribute%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.morphTargetsRelative%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%248.addVectors%28_box%242.min%2C%20_boxMorphTargets.min%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_box%242.expandByPoint%28_vector%248%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%248.addVectors%28_box%242.max%2C%20_boxMorphTargets.max%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_box%242.expandByPoint%28_vector%248%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_box%242.expandByPoint%28_boxMorphTargets.min%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_box%242.expandByPoint%28_boxMorphTargets.max%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_box%242.getCenter%28center%29%3B%0A%20%20%20%20%20%20let%20maxRadiusSq%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20position.count%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20_vector%248.fromBufferAttribute%28position%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20maxRadiusSq%20%3D%20Math.max%28maxRadiusSq%2C%20center.distanceToSquared%28_vector%248%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28morphAttributesPosition%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphAttributesPosition.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributesPosition%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20morphTargetsRelative%20%3D%20this.morphTargetsRelative%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%2C%20jl%20%3D%20morphAttribute.count%3B%20j%20%3C%20jl%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%248.fromBufferAttribute%28morphAttribute%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28morphTargetsRelative%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_offset.fromBufferAttribute%28position%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_vector%248.add%28_offset%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20maxRadiusSq%20%3D%20Math.max%28maxRadiusSq%2C%20center.distanceToSquared%28_vector%248%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.boundingSphere.radius%20%3D%20Math.sqrt%28maxRadiusSq%29%3B%0A%20%20%20%20%20%20if%20%28isNaN%28this.boundingSphere.radius%29%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%27THREE.BufferGeometry.computeBoundingSphere%28%29%3A%20Computed%20radius%20is%20NaN.%20The%20%22position%22%20attribute%20is%20likely%20to%20have%20NaN%20values.%27%2C%20this%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20computeTangents%28%29%20%7B%0A%20%20%20%20const%20index5%20%3D%20this.index%3B%0A%20%20%20%20const%20attributes%20%3D%20this.attributes%3B%0A%20%20%20%20if%20%28index5%20%3D%3D%3D%20null%20%7C%7C%20attributes.position%20%3D%3D%3D%20void%200%20%7C%7C%20attributes.normal%20%3D%3D%3D%20void%200%20%7C%7C%20attributes.uv%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.BufferGeometry%3A%20.computeTangents%28%29%20failed.%20Missing%20required%20attributes%20%28index%2C%20position%2C%20normal%20or%20uv%29%22%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20positionAttribute%20%3D%20attributes.position%3B%0A%20%20%20%20const%20normalAttribute%20%3D%20attributes.normal%3B%0A%20%20%20%20const%20uvAttribute%20%3D%20attributes.uv%3B%0A%20%20%20%20if%20%28this.hasAttribute%28%22tangent%22%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this.setAttribute%28%22tangent%22%2C%20new%20BufferAttribute%28new%20Float32Array%284%20%2A%20positionAttribute.count%29%2C%204%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20tangentAttribute%20%3D%20this.getAttribute%28%22tangent%22%29%3B%0A%20%20%20%20const%20tan1%20%3D%20%5B%5D%2C%20tan2%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20positionAttribute.count%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20tan1%5Bi%5D%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20tan2%5Bi%5D%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20vA%20%3D%20new%20Vector3%28%29%2C%20vB%20%3D%20new%20Vector3%28%29%2C%20vC%20%3D%20new%20Vector3%28%29%2C%20uvA%20%3D%20new%20Vector2%28%29%2C%20uvB%20%3D%20new%20Vector2%28%29%2C%20uvC%20%3D%20new%20Vector2%28%29%2C%20sdir%20%3D%20new%20Vector3%28%29%2C%20tdir%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20function%20handleTriangle%28a2%2C%20b%2C%20c2%29%20%7B%0A%20%20%20%20%20%20vA.fromBufferAttribute%28positionAttribute%2C%20a2%29%3B%0A%20%20%20%20%20%20vB.fromBufferAttribute%28positionAttribute%2C%20b%29%3B%0A%20%20%20%20%20%20vC.fromBufferAttribute%28positionAttribute%2C%20c2%29%3B%0A%20%20%20%20%20%20uvA.fromBufferAttribute%28uvAttribute%2C%20a2%29%3B%0A%20%20%20%20%20%20uvB.fromBufferAttribute%28uvAttribute%2C%20b%29%3B%0A%20%20%20%20%20%20uvC.fromBufferAttribute%28uvAttribute%2C%20c2%29%3B%0A%20%20%20%20%20%20vB.sub%28vA%29%3B%0A%20%20%20%20%20%20vC.sub%28vA%29%3B%0A%20%20%20%20%20%20uvB.sub%28uvA%29%3B%0A%20%20%20%20%20%20uvC.sub%28uvA%29%3B%0A%20%20%20%20%20%20const%20r%20%3D%201%20%2F%20%28uvB.x%20%2A%20uvC.y%20-%20uvC.x%20%2A%20uvB.y%29%3B%0A%20%20%20%20%20%20if%20%28%21isFinite%28r%29%29%20return%3B%0A%20%20%20%20%20%20sdir.copy%28vB%29.multiplyScalar%28uvC.y%29.addScaledVector%28vC%2C%20-uvB.y%29.multiplyScalar%28r%29%3B%0A%20%20%20%20%20%20tdir.copy%28vC%29.multiplyScalar%28uvB.x%29.addScaledVector%28vB%2C%20-uvC.x%29.multiplyScalar%28r%29%3B%0A%20%20%20%20%20%20tan1%5Ba2%5D.add%28sdir%29%3B%0A%20%20%20%20%20%20tan1%5Bb%5D.add%28sdir%29%3B%0A%20%20%20%20%20%20tan1%5Bc2%5D.add%28sdir%29%3B%0A%20%20%20%20%20%20tan2%5Ba2%5D.add%28tdir%29%3B%0A%20%20%20%20%20%20tan2%5Bb%5D.add%28tdir%29%3B%0A%20%20%20%20%20%20tan2%5Bc2%5D.add%28tdir%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20groups%20%3D%20this.groups%3B%0A%20%20%20%20if%20%28groups.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20groups%20%3D%20%5B%7B%0A%20%20%20%20%20%20%20%20start%3A%200%2C%0A%20%20%20%20%20%20%20%20count%3A%20index5.count%0A%20%20%20%20%20%20%7D%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20groups.length%3B%20i%20%3C%20il%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20const%20start%20%3D%20group.start%3B%0A%20%20%20%20%20%20const%20count%20%3D%20group.count%3B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%20start%2C%20jl%20%3D%20start%20%2B%20count%3B%20j%20%3C%20jl%3B%20j%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20handleTriangle%28%0A%20%20%20%20%20%20%20%20%20%20index5.getX%28j%20%2B%200%29%2C%0A%20%20%20%20%20%20%20%20%20%20index5.getX%28j%20%2B%201%29%2C%0A%20%20%20%20%20%20%20%20%20%20index5.getX%28j%20%2B%202%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20tmp2%20%3D%20new%20Vector3%28%29%2C%20tmp22%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20n%20%3D%20new%20Vector3%28%29%2C%20n2%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20function%20handleVertex%28v%29%20%7B%0A%20%20%20%20%20%20n.fromBufferAttribute%28normalAttribute%2C%20v%29%3B%0A%20%20%20%20%20%20n2.copy%28n%29%3B%0A%20%20%20%20%20%20const%20t%20%3D%20tan1%5Bv%5D%3B%0A%20%20%20%20%20%20tmp2.copy%28t%29%3B%0A%20%20%20%20%20%20tmp2.sub%28n.multiplyScalar%28n.dot%28t%29%29%29.normalize%28%29%3B%0A%20%20%20%20%20%20tmp22.crossVectors%28n2%2C%20t%29%3B%0A%20%20%20%20%20%20const%20test%20%3D%20tmp22.dot%28tan2%5Bv%5D%29%3B%0A%20%20%20%20%20%20const%20w%20%3D%20test%20%3C%200%20%3F%20-1%20%3A%201%3B%0A%20%20%20%20%20%20tangentAttribute.setXYZW%28v%2C%20tmp2.x%2C%20tmp2.y%2C%20tmp2.z%2C%20w%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20groups.length%3B%20i%20%3C%20il%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20const%20start%20%3D%20group.start%3B%0A%20%20%20%20%20%20const%20count%20%3D%20group.count%3B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%20start%2C%20jl%20%3D%20start%20%2B%20count%3B%20j%20%3C%20jl%3B%20j%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20handleVertex%28index5.getX%28j%20%2B%200%29%29%3B%0A%20%20%20%20%20%20%20%20handleVertex%28index5.getX%28j%20%2B%201%29%29%3B%0A%20%20%20%20%20%20%20%20handleVertex%28index5.getX%28j%20%2B%202%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20computeVertexNormals%28%29%20%7B%0A%20%20%20%20const%20index5%20%3D%20this.index%3B%0A%20%20%20%20const%20positionAttribute%20%3D%20this.getAttribute%28%22position%22%29%3B%0A%20%20%20%20if%20%28positionAttribute%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20let%20normalAttribute%20%3D%20this.getAttribute%28%22normal%22%29%3B%0A%20%20%20%20%20%20if%20%28normalAttribute%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20normalAttribute%20%3D%20new%20BufferAttribute%28new%20Float32Array%28positionAttribute.count%20%2A%203%29%2C%203%29%3B%0A%20%20%20%20%20%20%20%20this.setAttribute%28%22normal%22%2C%20normalAttribute%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20normalAttribute.count%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28i%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20pA%20%3D%20new%20Vector3%28%29%2C%20pB%20%3D%20new%20Vector3%28%29%2C%20pC%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20const%20nA%20%3D%20new%20Vector3%28%29%2C%20nB%20%3D%20new%20Vector3%28%29%2C%20nC%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20const%20cb%20%3D%20new%20Vector3%28%29%2C%20ab%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20if%20%28index5%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20index5.count%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20vA%20%3D%20index5.getX%28i%20%2B%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20vB%20%3D%20index5.getX%28i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20vC%20%3D%20index5.getX%28i%20%2B%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20pA.fromBufferAttribute%28positionAttribute%2C%20vA%29%3B%0A%20%20%20%20%20%20%20%20%20%20pB.fromBufferAttribute%28positionAttribute%2C%20vB%29%3B%0A%20%20%20%20%20%20%20%20%20%20pC.fromBufferAttribute%28positionAttribute%2C%20vC%29%3B%0A%20%20%20%20%20%20%20%20%20%20cb.subVectors%28pC%2C%20pB%29%3B%0A%20%20%20%20%20%20%20%20%20%20ab.subVectors%28pA%2C%20pB%29%3B%0A%20%20%20%20%20%20%20%20%20%20cb.cross%28ab%29%3B%0A%20%20%20%20%20%20%20%20%20%20nA.fromBufferAttribute%28normalAttribute%2C%20vA%29%3B%0A%20%20%20%20%20%20%20%20%20%20nB.fromBufferAttribute%28normalAttribute%2C%20vB%29%3B%0A%20%20%20%20%20%20%20%20%20%20nC.fromBufferAttribute%28normalAttribute%2C%20vC%29%3B%0A%20%20%20%20%20%20%20%20%20%20nA.add%28cb%29%3B%0A%20%20%20%20%20%20%20%20%20%20nB.add%28cb%29%3B%0A%20%20%20%20%20%20%20%20%20%20nC.add%28cb%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28vA%2C%20nA.x%2C%20nA.y%2C%20nA.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28vB%2C%20nB.x%2C%20nB.y%2C%20nB.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28vC%2C%20nC.x%2C%20nC.y%2C%20nC.z%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20positionAttribute.count%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20pA.fromBufferAttribute%28positionAttribute%2C%20i%20%2B%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20pB.fromBufferAttribute%28positionAttribute%2C%20i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20pC.fromBufferAttribute%28positionAttribute%2C%20i%20%2B%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20cb.subVectors%28pC%2C%20pB%29%3B%0A%20%20%20%20%20%20%20%20%20%20ab.subVectors%28pA%2C%20pB%29%3B%0A%20%20%20%20%20%20%20%20%20%20cb.cross%28ab%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28i%20%2B%200%2C%20cb.x%2C%20cb.y%2C%20cb.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28i%20%2B%201%2C%20cb.x%2C%20cb.y%2C%20cb.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28i%20%2B%202%2C%20cb.x%2C%20cb.y%2C%20cb.z%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.normalizeNormals%28%29%3B%0A%20%20%20%20%20%20normalAttribute.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20normalizeNormals%28%29%20%7B%0A%20%20%20%20const%20normals%20%3D%20this.attributes.normal%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20normals.count%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%248.fromBufferAttribute%28normals%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%248.normalize%28%29%3B%0A%20%20%20%20%20%20normals.setXYZ%28i%2C%20_vector%248.x%2C%20_vector%248.y%2C%20_vector%248.z%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20toNonIndexed%28%29%20%7B%0A%20%20%20%20function%20convertBufferAttribute%28attribute2%2C%20indices2%29%20%7B%0A%20%20%20%20%20%20const%20array%20%3D%20attribute2.array%3B%0A%20%20%20%20%20%20const%20itemSize%20%3D%20attribute2.itemSize%3B%0A%20%20%20%20%20%20const%20normalized%20%3D%20attribute2.normalized%3B%0A%20%20%20%20%20%20const%20array2%20%3D%20new%20array.constructor%28indices2.length%20%2A%20itemSize%29%3B%0A%20%20%20%20%20%20let%20index5%20%3D%200%2C%20index22%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20indices2.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20index5%20%3D%20indices2%5Bi%5D%20%2A%20attribute2.data.stride%20%2B%20attribute2.offset%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20index5%20%3D%20indices2%5Bi%5D%20%2A%20itemSize%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20itemSize%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20array2%5Bindex22%2B%2B%5D%20%3D%20array%5Bindex5%2B%2B%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20new%20BufferAttribute%28array2%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.index%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.BufferGeometry.toNonIndexed%28%29%3A%20BufferGeometry%20is%20already%20non-indexed.%22%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20geometry2%20%3D%20new%20_BufferGeometry%28%29%3B%0A%20%20%20%20const%20indices%20%3D%20this.index.array%3B%0A%20%20%20%20const%20attributes%20%3D%20this.attributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20attributes%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bname%5D%3B%0A%20%20%20%20%20%20const%20newAttribute%20%3D%20convertBufferAttribute%28attribute2%2C%20indices%29%3B%0A%20%20%20%20%20%20geometry2.setAttribute%28name%2C%20newAttribute%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20morphAttributes%20%3D%20this.morphAttributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20morphAttributes%29%20%7B%0A%20%20%20%20%20%20const%20morphArray%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphAttribute.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20attribute2%20%3D%20morphAttribute%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20newAttribute%20%3D%20convertBufferAttribute%28attribute2%2C%20indices%29%3B%0A%20%20%20%20%20%20%20%20morphArray.push%28newAttribute%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20geometry2.morphAttributes%5Bname%5D%20%3D%20morphArray%3B%0A%20%20%20%20%7D%0A%20%20%20%20geometry2.morphTargetsRelative%20%3D%20this.morphTargetsRelative%3B%0A%20%20%20%20const%20groups%20%3D%20this.groups%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20groups.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20geometry2.addGroup%28group.start%2C%20group.count%2C%20group.materialIndex%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20geometry2%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20%7B%0A%20%20%20%20%20%20metadata%3A%20%7B%0A%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22BufferGeometry%22%2C%0A%20%20%20%20%20%20%20%20generator%3A%20%22BufferGeometry.toJSON%22%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20data.uuid%20%3D%20this.uuid%3B%0A%20%20%20%20data.type%20%3D%20this.type%3B%0A%20%20%20%20if%20%28this.name%20%21%3D%3D%20%22%22%29%20data.name%20%3D%20this.name%3B%0A%20%20%20%20if%20%28Object.keys%28this.userData%29.length%20%3E%200%29%20data.userData%20%3D%20this.userData%3B%0A%20%20%20%20if%20%28this.parameters%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20parameters%20%3D%20this.parameters%3B%0A%20%20%20%20%20%20for%20%28const%20key%20in%20parameters%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28parameters%5Bkey%5D%20%21%3D%3D%20void%200%29%20data%5Bkey%5D%20%3D%20parameters%5Bkey%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20data%3B%0A%20%20%20%20%7D%0A%20%20%20%20data.data%20%3D%20%7B%20attributes%3A%20%7B%7D%20%7D%3B%0A%20%20%20%20const%20index5%20%3D%20this.index%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20data.data.index%20%3D%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20index5.array.constructor.name%2C%0A%20%20%20%20%20%20%20%20array%3A%20Array.prototype.slice.call%28index5.array%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20attributes%20%3D%20this.attributes%3B%0A%20%20%20%20for%20%28const%20key%20in%20attributes%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bkey%5D%3B%0A%20%20%20%20%20%20data.data.attributes%5Bkey%5D%20%3D%20attribute2.toJSON%28data.data%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20morphAttributes%20%3D%20%7B%7D%3B%0A%20%20%20%20let%20hasMorphAttributes%20%3D%20false%3B%0A%20%20%20%20for%20%28const%20key%20in%20this.morphAttributes%29%20%7B%0A%20%20%20%20%20%20const%20attributeArray%20%3D%20this.morphAttributes%5Bkey%5D%3B%0A%20%20%20%20%20%20const%20array%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20attributeArray.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20attribute2%20%3D%20attributeArray%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20array.push%28attribute2.toJSON%28data.data%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28array.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20morphAttributes%5Bkey%5D%20%3D%20array%3B%0A%20%20%20%20%20%20%20%20hasMorphAttributes%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28hasMorphAttributes%29%20%7B%0A%20%20%20%20%20%20data.data.morphAttributes%20%3D%20morphAttributes%3B%0A%20%20%20%20%20%20data.data.morphTargetsRelative%20%3D%20this.morphTargetsRelative%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20groups%20%3D%20this.groups%3B%0A%20%20%20%20if%20%28groups.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20data.data.groups%20%3D%20JSON.parse%28JSON.stringify%28groups%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20boundingSphere%20%3D%20this.boundingSphere%3B%0A%20%20%20%20if%20%28boundingSphere%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20data.data.boundingSphere%20%3D%20%7B%0A%20%20%20%20%20%20%20%20center%3A%20boundingSphere.center.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20radius%3A%20boundingSphere.radius%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.index%20%3D%20null%3B%0A%20%20%20%20this.attributes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.morphAttributes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.groups%20%3D%20%5B%5D%3B%0A%20%20%20%20this.boundingBox%20%3D%20null%3B%0A%20%20%20%20this.boundingSphere%20%3D%20null%3B%0A%20%20%20%20const%20data%20%3D%20%7B%7D%3B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20const%20index5%20%3D%20source.index%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.setIndex%28index5.clone%28data%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20attributes%20%3D%20source.attributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20attributes%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bname%5D%3B%0A%20%20%20%20%20%20this.setAttribute%28name%2C%20attribute2.clone%28data%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20morphAttributes%20%3D%20source.morphAttributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20morphAttributes%29%20%7B%0A%20%20%20%20%20%20const%20array%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20morphAttribute.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20array.push%28morphAttribute%5Bi%5D.clone%28data%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.morphAttributes%5Bname%5D%20%3D%20array%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.morphTargetsRelative%20%3D%20source.morphTargetsRelative%3B%0A%20%20%20%20const%20groups%20%3D%20source.groups%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20groups.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20this.addGroup%28group.start%2C%20group.count%2C%20group.materialIndex%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20boundingBox%20%3D%20source.boundingBox%3B%0A%20%20%20%20if%20%28boundingBox%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.boundingBox%20%3D%20boundingBox.clone%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20boundingSphere%20%3D%20source.boundingSphere%3B%0A%20%20%20%20if%20%28boundingSphere%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.boundingSphere%20%3D%20boundingSphere.clone%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.drawRange.start%20%3D%20source.drawRange.start%3B%0A%20%20%20%20this.drawRange.count%20%3D%20source.drawRange.count%3B%0A%20%20%20%20this.userData%20%3D%20source.userData%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_inverseMatrix%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Avar%20_ray%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Ray%28%29%3B%0Avar%20_sphere%246%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Sphere%28%29%3B%0Avar%20_sphereHitAt%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vA%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vB%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vC%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_tempA%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_morphA%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_intersectionPoint%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_intersectionPointWorld%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20Mesh%20%3D%20class%20extends%20Object3D%20%7B%0A%20%20constructor%28geometry%20%3D%20new%20BufferGeometry%28%29%2C%20material%20%3D%20new%20MeshBasicMaterial%28%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMesh%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Mesh%22%3B%0A%20%20%20%20this.geometry%20%3D%20geometry%3B%0A%20%20%20%20this.material%20%3D%20material%3B%0A%20%20%20%20this.updateMorphTargets%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20if%20%28source.morphTargetInfluences%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.morphTargetInfluences%20%3D%20source.morphTargetInfluences.slice%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28source.morphTargetDictionary%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.morphTargetDictionary%20%3D%20Object.assign%28%7B%7D%2C%20source.morphTargetDictionary%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.material%20%3D%20Array.isArray%28source.material%29%20%3F%20source.material.slice%28%29%20%3A%20source.material%3B%0A%20%20%20%20this.geometry%20%3D%20source.geometry%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20updateMorphTargets%28%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20morphAttributes%20%3D%20geometry.morphAttributes%3B%0A%20%20%20%20const%20keys%20%3D%20Object.keys%28morphAttributes%29%3B%0A%20%20%20%20if%20%28keys.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributes%5Bkeys%5B0%5D%5D%3B%0A%20%20%20%20%20%20if%20%28morphAttribute%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this.morphTargetInfluences%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20this.morphTargetDictionary%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20m2%20%3D%200%2C%20ml%20%3D%20morphAttribute.length%3B%20m2%20%3C%20ml%3B%20m2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20name%20%3D%20morphAttribute%5Bm2%5D.name%20%7C%7C%20String%28m2%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.morphTargetInfluences.push%280%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.morphTargetDictionary%5Bname%5D%20%3D%20m2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getVertexPosition%28index5%2C%20target%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20position%20%3D%20geometry.attributes.position%3B%0A%20%20%20%20const%20morphPosition%20%3D%20geometry.morphAttributes.position%3B%0A%20%20%20%20const%20morphTargetsRelative%20%3D%20geometry.morphTargetsRelative%3B%0A%20%20%20%20target.fromBufferAttribute%28position%2C%20index5%29%3B%0A%20%20%20%20const%20morphInfluences%20%3D%20this.morphTargetInfluences%3B%0A%20%20%20%20if%20%28morphPosition%20%26%26%20morphInfluences%29%20%7B%0A%20%20%20%20%20%20_morphA.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphPosition.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20influence%20%3D%20morphInfluences%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphPosition%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28influence%20%3D%3D%3D%200%29%20continue%3B%0A%20%20%20%20%20%20%20%20_tempA.fromBufferAttribute%28morphAttribute%2C%20index5%29%3B%0A%20%20%20%20%20%20%20%20if%20%28morphTargetsRelative%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_morphA.addScaledVector%28_tempA%2C%20influence%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20_morphA.addScaledVector%28_tempA.sub%28target%29%2C%20influence%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20target.add%28_morphA%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20raycast%28raycaster%2C%20intersects%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20material%20%3D%20this.material%3B%0A%20%20%20%20const%20matrixWorld%20%3D%20this.matrixWorld%3B%0A%20%20%20%20if%20%28material%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20if%20%28geometry.boundingSphere%20%3D%3D%3D%20null%29%20geometry.computeBoundingSphere%28%29%3B%0A%20%20%20%20_sphere%246.copy%28geometry.boundingSphere%29%3B%0A%20%20%20%20_sphere%246.applyMatrix4%28matrixWorld%29%3B%0A%20%20%20%20_ray%243.copy%28raycaster.ray%29.recast%28raycaster.near%29%3B%0A%20%20%20%20if%20%28_sphere%246.containsPoint%28_ray%243.origin%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20if%20%28_ray%243.intersectSphere%28_sphere%246%2C%20_sphereHitAt%29%20%3D%3D%3D%20null%29%20return%3B%0A%20%20%20%20%20%20if%20%28_ray%243.origin.distanceToSquared%28_sphereHitAt%29%20%3E%20%28raycaster.far%20-%20raycaster.near%29%20%2A%2A%202%29%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20_inverseMatrix%243.copy%28matrixWorld%29.invert%28%29%3B%0A%20%20%20%20_ray%243.copy%28raycaster.ray%29.applyMatrix4%28_inverseMatrix%243%29%3B%0A%20%20%20%20if%20%28geometry.boundingBox%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28_ray%243.intersectsBox%28geometry.boundingBox%29%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._computeIntersections%28raycaster%2C%20intersects%2C%20_ray%243%29%3B%0A%20%20%7D%0A%20%20_computeIntersections%28raycaster%2C%20intersects%2C%20rayLocalSpace%29%20%7B%0A%20%20%20%20let%20intersection%3B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20material%20%3D%20this.material%3B%0A%20%20%20%20const%20index5%20%3D%20geometry.index%3B%0A%20%20%20%20const%20position%20%3D%20geometry.attributes.position%3B%0A%20%20%20%20const%20uv2%20%3D%20geometry.attributes.uv%3B%0A%20%20%20%20const%20uv1%20%3D%20geometry.attributes.uv1%3B%0A%20%20%20%20const%20normal2%20%3D%20geometry.attributes.normal%3B%0A%20%20%20%20const%20groups%20%3D%20geometry.groups%3B%0A%20%20%20%20const%20drawRange%20%3D%20geometry.drawRange%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28Array.isArray%28material%29%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20groups.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20groupMaterial%20%3D%20material%5Bgroup.materialIndex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20start%20%3D%20Math.max%28group.start%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20end%20%3D%20Math.min%28index5.count%2C%20Math.min%28group.start%20%2B%20group.count%2C%20drawRange.start%20%2B%20drawRange.count%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%20start%2C%20jl%20%3D%20end%3B%20j%20%3C%20jl%3B%20j%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20index5.getX%28j%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20index5.getX%28j%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20index5.getX%28j%20%2B%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersection%20%3D%20checkGeometryIntersection%28this%2C%20groupMaterial%2C%20raycaster%2C%20rayLocalSpace%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersection.faceIndex%20%3D%20Math.floor%28j%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersection.face.materialIndex%20%3D%20group.materialIndex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersects.push%28intersection%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20start%20%3D%20Math.max%280%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20%20%20const%20end%20%3D%20Math.min%28index5.count%2C%20drawRange.start%20%2B%20drawRange.count%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%20start%2C%20il%20%3D%20end%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20index5.getX%28i%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20index5.getX%28i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20index5.getX%28i%20%2B%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20intersection%20%3D%20checkGeometryIntersection%28this%2C%20material%2C%20raycaster%2C%20rayLocalSpace%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersection.faceIndex%20%3D%20Math.floor%28i%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersects.push%28intersection%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28position%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28Array.isArray%28material%29%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20groups.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20groupMaterial%20%3D%20material%5Bgroup.materialIndex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20start%20%3D%20Math.max%28group.start%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20end%20%3D%20Math.min%28position.count%2C%20Math.min%28group.start%20%2B%20group.count%2C%20drawRange.start%20%2B%20drawRange.count%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%20start%2C%20jl%20%3D%20end%3B%20j%20%3C%20jl%3B%20j%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20j%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20j%20%2B%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20j%20%2B%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersection%20%3D%20checkGeometryIntersection%28this%2C%20groupMaterial%2C%20raycaster%2C%20rayLocalSpace%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersection.faceIndex%20%3D%20Math.floor%28j%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersection.face.materialIndex%20%3D%20group.materialIndex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersects.push%28intersection%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20start%20%3D%20Math.max%280%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20%20%20const%20end%20%3D%20Math.min%28position.count%2C%20drawRange.start%20%2B%20drawRange.count%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%20start%2C%20il%20%3D%20end%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20i%3B%0A%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20i%20%2B%201%3B%0A%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20i%20%2B%202%3B%0A%20%20%20%20%20%20%20%20%20%20intersection%20%3D%20checkGeometryIntersection%28this%2C%20material%2C%20raycaster%2C%20rayLocalSpace%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersection.faceIndex%20%3D%20Math.floor%28i%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersects.push%28intersection%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Afunction%20checkIntersection%241%28object%2C%20material%2C%20raycaster%2C%20ray%2C%20pA%2C%20pB%2C%20pC%2C%20point%29%20%7B%0A%20%20let%20intersect2%3B%0A%20%20if%20%28material.side%20%3D%3D%3D%20BackSide%29%20%7B%0A%20%20%20%20intersect2%20%3D%20ray.intersectTriangle%28pC%2C%20pB%2C%20pA%2C%20true%2C%20point%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20intersect2%20%3D%20ray.intersectTriangle%28pA%2C%20pB%2C%20pC%2C%20material.side%20%3D%3D%3D%20FrontSide%2C%20point%29%3B%0A%20%20%7D%0A%20%20if%20%28intersect2%20%3D%3D%3D%20null%29%20return%20null%3B%0A%20%20_intersectionPointWorld.copy%28point%29%3B%0A%20%20_intersectionPointWorld.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20const%20distance2%20%3D%20raycaster.ray.origin.distanceTo%28_intersectionPointWorld%29%3B%0A%20%20if%20%28distance2%20%3C%20raycaster.near%20%7C%7C%20distance2%20%3E%20raycaster.far%29%20return%20null%3B%0A%20%20return%20%7B%0A%20%20%20%20distance%3A%20distance2%2C%0A%20%20%20%20point%3A%20_intersectionPointWorld.clone%28%29%2C%0A%20%20%20%20object%0A%20%20%7D%3B%0A%7D%0Afunction%20checkGeometryIntersection%28object%2C%20material%2C%20raycaster%2C%20ray%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%20%7B%0A%20%20object.getVertexPosition%28a2%2C%20_vA%241%29%3B%0A%20%20object.getVertexPosition%28b%2C%20_vB%241%29%3B%0A%20%20object.getVertexPosition%28c2%2C%20_vC%241%29%3B%0A%20%20const%20intersection%20%3D%20checkIntersection%241%28object%2C%20material%2C%20raycaster%2C%20ray%2C%20_vA%241%2C%20_vB%241%2C%20_vC%241%2C%20_intersectionPoint%29%3B%0A%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20const%20barycoord%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20Triangle.getBarycoord%28_intersectionPoint%2C%20_vA%241%2C%20_vB%241%2C%20_vC%241%2C%20barycoord%29%3B%0A%20%20%20%20if%20%28uv2%29%20%7B%0A%20%20%20%20%20%20intersection.uv%20%3D%20Triangle.getInterpolatedAttribute%28uv2%2C%20a2%2C%20b%2C%20c2%2C%20barycoord%2C%20new%20Vector2%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28uv1%29%20%7B%0A%20%20%20%20%20%20intersection.uv1%20%3D%20Triangle.getInterpolatedAttribute%28uv1%2C%20a2%2C%20b%2C%20c2%2C%20barycoord%2C%20new%20Vector2%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28normal2%29%20%7B%0A%20%20%20%20%20%20intersection.normal%20%3D%20Triangle.getInterpolatedAttribute%28normal2%2C%20a2%2C%20b%2C%20c2%2C%20barycoord%2C%20new%20Vector3%28%29%29%3B%0A%20%20%20%20%20%20if%20%28intersection.normal.dot%28ray.direction%29%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20intersection.normal.multiplyScalar%28-1%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20face%20%3D%20%7B%0A%20%20%20%20%20%20a%3A%20a2%2C%0A%20%20%20%20%20%20b%2C%0A%20%20%20%20%20%20c%3A%20c2%2C%0A%20%20%20%20%20%20normal%3A%20new%20Vector3%28%29%2C%0A%20%20%20%20%20%20materialIndex%3A%200%0A%20%20%20%20%7D%3B%0A%20%20%20%20Triangle.getNormal%28_vA%241%2C%20_vB%241%2C%20_vC%241%2C%20face.normal%29%3B%0A%20%20%20%20intersection.face%20%3D%20face%3B%0A%20%20%20%20intersection.barycoord%20%3D%20barycoord%3B%0A%20%20%7D%0A%20%20return%20intersection%3B%0A%7D%0Avar%20BoxGeometry%20%3D%20class%20_BoxGeometry%20extends%20BufferGeometry%20%7B%0A%20%20constructor%28width%20%3D%201%2C%20height%20%3D%201%2C%20depth2%20%3D%201%2C%20widthSegments%20%3D%201%2C%20heightSegments%20%3D%201%2C%20depthSegments%20%3D%201%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.type%20%3D%20%22BoxGeometry%22%3B%0A%20%20%20%20this.parameters%20%3D%20%7B%0A%20%20%20%20%20%20width%2C%0A%20%20%20%20%20%20height%2C%0A%20%20%20%20%20%20depth%3A%20depth2%2C%0A%20%20%20%20%20%20widthSegments%2C%0A%20%20%20%20%20%20heightSegments%2C%0A%20%20%20%20%20%20depthSegments%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20scope%20%3D%20this%3B%0A%20%20%20%20widthSegments%20%3D%20Math.floor%28widthSegments%29%3B%0A%20%20%20%20heightSegments%20%3D%20Math.floor%28heightSegments%29%3B%0A%20%20%20%20depthSegments%20%3D%20Math.floor%28depthSegments%29%3B%0A%20%20%20%20const%20indices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vertices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20normals%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20uvs%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20numberOfVertices%20%3D%200%3B%0A%20%20%20%20let%20groupStart%20%3D%200%3B%0A%20%20%20%20buildPlane%28%22z%22%2C%20%22y%22%2C%20%22x%22%2C%20-1%2C%20-1%2C%20depth2%2C%20height%2C%20width%2C%20depthSegments%2C%20heightSegments%2C%200%29%3B%0A%20%20%20%20buildPlane%28%22z%22%2C%20%22y%22%2C%20%22x%22%2C%201%2C%20-1%2C%20depth2%2C%20height%2C%20-width%2C%20depthSegments%2C%20heightSegments%2C%201%29%3B%0A%20%20%20%20buildPlane%28%22x%22%2C%20%22z%22%2C%20%22y%22%2C%201%2C%201%2C%20width%2C%20depth2%2C%20height%2C%20widthSegments%2C%20depthSegments%2C%202%29%3B%0A%20%20%20%20buildPlane%28%22x%22%2C%20%22z%22%2C%20%22y%22%2C%201%2C%20-1%2C%20width%2C%20depth2%2C%20-height%2C%20widthSegments%2C%20depthSegments%2C%203%29%3B%0A%20%20%20%20buildPlane%28%22x%22%2C%20%22y%22%2C%20%22z%22%2C%201%2C%20-1%2C%20width%2C%20height%2C%20depth2%2C%20widthSegments%2C%20heightSegments%2C%204%29%3B%0A%20%20%20%20buildPlane%28%22x%22%2C%20%22y%22%2C%20%22z%22%2C%20-1%2C%20-1%2C%20width%2C%20height%2C%20-depth2%2C%20widthSegments%2C%20heightSegments%2C%205%29%3B%0A%20%20%20%20this.setIndex%28indices%29%3B%0A%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute%28vertices%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22normal%22%2C%20new%20Float32BufferAttribute%28normals%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22uv%22%2C%20new%20Float32BufferAttribute%28uvs%2C%202%29%29%3B%0A%20%20%20%20function%20buildPlane%28u%2C%20v%2C%20w%2C%20udir%2C%20vdir%2C%20width2%2C%20height2%2C%20depth3%2C%20gridX%2C%20gridY%2C%20materialIndex%29%20%7B%0A%20%20%20%20%20%20const%20segmentWidth%20%3D%20width2%20%2F%20gridX%3B%0A%20%20%20%20%20%20const%20segmentHeight%20%3D%20height2%20%2F%20gridY%3B%0A%20%20%20%20%20%20const%20widthHalf%20%3D%20width2%20%2F%202%3B%0A%20%20%20%20%20%20const%20heightHalf%20%3D%20height2%20%2F%202%3B%0A%20%20%20%20%20%20const%20depthHalf%20%3D%20depth3%20%2F%202%3B%0A%20%20%20%20%20%20const%20gridX1%20%3D%20gridX%20%2B%201%3B%0A%20%20%20%20%20%20const%20gridY1%20%3D%20gridY%20%2B%201%3B%0A%20%20%20%20%20%20let%20vertexCounter%20%3D%200%3B%0A%20%20%20%20%20%20let%20groupCount%20%3D%200%3B%0A%20%20%20%20%20%20const%20vector%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%20gridY1%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20y2%20%3D%20iy%20%2A%20segmentHeight%20-%20heightHalf%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%20gridX1%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20x2%20%3D%20ix%20%2A%20segmentWidth%20-%20widthHalf%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bu%5D%20%3D%20x2%20%2A%20udir%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bv%5D%20%3D%20y2%20%2A%20vdir%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bw%5D%20%3D%20depthHalf%3B%0A%20%20%20%20%20%20%20%20%20%20vertices.push%28vector.x%2C%20vector.y%2C%20vector.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bu%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bv%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bw%5D%20%3D%20depth3%20%3E%200%20%3F%201%20%3A%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20normals.push%28vector.x%2C%20vector.y%2C%20vector.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20uvs.push%28ix%20%2F%20gridX%29%3B%0A%20%20%20%20%20%20%20%20%20%20uvs.push%281%20-%20iy%20%2F%20gridY%29%3B%0A%20%20%20%20%20%20%20%20%20%20vertexCounter%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%20gridY%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%20gridX%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20numberOfVertices%20%2B%20ix%20%2B%20gridX1%20%2A%20iy%3B%0A%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20numberOfVertices%20%2B%20ix%20%2B%20gridX1%20%2A%20%28iy%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20numberOfVertices%20%2B%20%28ix%20%2B%201%29%20%2B%20gridX1%20%2A%20%28iy%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20d%20%3D%20numberOfVertices%20%2B%20%28ix%20%2B%201%29%20%2B%20gridX1%20%2A%20iy%3B%0A%20%20%20%20%20%20%20%20%20%20indices.push%28a2%2C%20b%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20%20%20indices.push%28b%2C%20c2%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20%20%20groupCount%20%2B%3D%206%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20scope.addGroup%28groupStart%2C%20groupCount%2C%20materialIndex%29%3B%0A%20%20%20%20%20%20groupStart%20%2B%3D%20groupCount%3B%0A%20%20%20%20%20%20numberOfVertices%20%2B%3D%20vertexCounter%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.parameters%20%3D%20Object.assign%28%7B%7D%2C%20source.parameters%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20static%20fromJSON%28data%29%20%7B%0A%20%20%20%20return%20new%20_BoxGeometry%28data.width%2C%20data.height%2C%20data.depth%2C%20data.widthSegments%2C%20data.heightSegments%2C%20data.depthSegments%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20cloneUniforms%28src%29%20%7B%0A%20%20const%20dst%20%3D%20%7B%7D%3B%0A%20%20for%20%28const%20u%20in%20src%29%20%7B%0A%20%20%20%20dst%5Bu%5D%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20p%20in%20src%5Bu%5D%29%20%7B%0A%20%20%20%20%20%20const%20property2%20%3D%20src%5Bu%5D%5Bp%5D%3B%0A%20%20%20%20%20%20if%20%28property2%20%26%26%20%28property2.isColor%20%7C%7C%20property2.isMatrix3%20%7C%7C%20property2.isMatrix4%20%7C%7C%20property2.isVector2%20%7C%7C%20property2.isVector3%20%7C%7C%20property2.isVector4%20%7C%7C%20property2.isTexture%20%7C%7C%20property2.isQuaternion%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28property2.isRenderTargetTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22UniformsUtils%3A%20Textures%20of%20render%20targets%20cannot%20be%20cloned%20via%20cloneUniforms%28%29%20or%20mergeUniforms%28%29.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20dst%5Bu%5D%5Bp%5D%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20dst%5Bu%5D%5Bp%5D%20%3D%20property2.clone%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28Array.isArray%28property2%29%29%20%7B%0A%20%20%20%20%20%20%20%20dst%5Bu%5D%5Bp%5D%20%3D%20property2.slice%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20dst%5Bu%5D%5Bp%5D%20%3D%20property2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20dst%3B%0A%7D%0Afunction%20mergeUniforms%28uniforms%29%20%7B%0A%20%20const%20merged%20%3D%20%7B%7D%3B%0A%20%20for%20%28let%20u%20%3D%200%3B%20u%20%3C%20uniforms.length%3B%20u%2B%2B%29%20%7B%0A%20%20%20%20const%20tmp2%20%3D%20cloneUniforms%28uniforms%5Bu%5D%29%3B%0A%20%20%20%20for%20%28const%20p%20in%20tmp2%29%20%7B%0A%20%20%20%20%20%20merged%5Bp%5D%20%3D%20tmp2%5Bp%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20merged%3B%0A%7D%0Afunction%20cloneUniformsGroups%28src%29%20%7B%0A%20%20const%20dst%20%3D%20%5B%5D%3B%0A%20%20for%20%28let%20u%20%3D%200%3B%20u%20%3C%20src.length%3B%20u%2B%2B%29%20%7B%0A%20%20%20%20dst.push%28src%5Bu%5D.clone%28%29%29%3B%0A%20%20%7D%0A%20%20return%20dst%3B%0A%7D%0Afunction%20getUnlitUniformColorSpace%28renderer3%29%20%7B%0A%20%20const%20currentRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20if%20%28currentRenderTarget%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20return%20renderer3.outputColorSpace%3B%0A%20%20%7D%0A%20%20if%20%28currentRenderTarget.isXRRenderTarget%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20return%20currentRenderTarget.texture.colorSpace%3B%0A%20%20%7D%0A%20%20return%20ColorManagement.workingColorSpace%3B%0A%7D%0Avar%20UniformsUtils%20%3D%20%7B%20clone%3A%20cloneUniforms%2C%20merge%3A%20mergeUniforms%20%7D%3B%0Avar%20default_vertex%20%3D%20%22void%20main%28%29%20%7B%5Cn%09gl_Position%20%3D%20projectionMatrix%20%2A%20modelViewMatrix%20%2A%20vec4%28%20position%2C%201.0%20%29%3B%5Cn%7D%22%3B%0Avar%20default_fragment%20%3D%20%22void%20main%28%29%20%7B%5Cn%09gl_FragColor%20%3D%20vec4%28%201.0%2C%200.0%2C%200.0%2C%201.0%20%29%3B%5Cn%7D%22%3B%0Avar%20ShaderMaterial%20%3D%20class%20extends%20Material%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ShaderMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isShaderMaterial%20%3D%20true%3B%0A%20%20%20%20this.defines%20%3D%20%7B%7D%3B%0A%20%20%20%20this.uniforms%20%3D%20%7B%7D%3B%0A%20%20%20%20this.uniformsGroups%20%3D%20%5B%5D%3B%0A%20%20%20%20this.vertexShader%20%3D%20default_vertex%3B%0A%20%20%20%20this.fragmentShader%20%3D%20default_fragment%3B%0A%20%20%20%20this.linewidth%20%3D%201%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.fog%20%3D%20false%3B%0A%20%20%20%20this.lights%20%3D%20false%3B%0A%20%20%20%20this.clipping%20%3D%20false%3B%0A%20%20%20%20this.forceSinglePass%20%3D%20true%3B%0A%20%20%20%20this.extensions%20%3D%20%7B%0A%20%20%20%20%20%20clipCullDistance%3A%20false%2C%0A%20%20%20%20%20%20%2F%2F%20set%20to%20use%20vertex%20shader%20clipping%0A%20%20%20%20%20%20multiDraw%3A%20false%0A%20%20%20%20%20%20%2F%2F%20set%20to%20use%20vertex%20shader%20multi_draw%20%2F%20enable%20gl_DrawID%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.defaultAttributeValues%20%3D%20%7B%0A%20%20%20%20%20%20%22color%22%3A%20%5B1%2C%201%2C%201%5D%2C%0A%20%20%20%20%20%20%22uv%22%3A%20%5B0%2C%200%5D%2C%0A%20%20%20%20%20%20%22uv1%22%3A%20%5B0%2C%200%5D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.index0AttributeName%20%3D%20void%200%3B%0A%20%20%20%20this.uniformsNeedUpdate%20%3D%20false%3B%0A%20%20%20%20this.glslVersion%20%3D%20null%3B%0A%20%20%20%20if%20%28parameters%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.fragmentShader%20%3D%20source.fragmentShader%3B%0A%20%20%20%20this.vertexShader%20%3D%20source.vertexShader%3B%0A%20%20%20%20this.uniforms%20%3D%20cloneUniforms%28source.uniforms%29%3B%0A%20%20%20%20this.uniformsGroups%20%3D%20cloneUniformsGroups%28source.uniformsGroups%29%3B%0A%20%20%20%20this.defines%20%3D%20Object.assign%28%7B%7D%2C%20source.defines%29%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20this.lights%20%3D%20source.lights%3B%0A%20%20%20%20this.clipping%20%3D%20source.clipping%3B%0A%20%20%20%20this.extensions%20%3D%20Object.assign%28%7B%7D%2C%20source.extensions%29%3B%0A%20%20%20%20this.glslVersion%20%3D%20source.glslVersion%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.glslVersion%20%3D%20this.glslVersion%3B%0A%20%20%20%20data.uniforms%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20name%20in%20this.uniforms%29%20%7B%0A%20%20%20%20%20%20const%20uniform2%20%3D%20this.uniforms%5Bname%5D%3B%0A%20%20%20%20%20%20const%20value%20%3D%20uniform2.value%3B%0A%20%20%20%20%20%20if%20%28value%20%26%26%20value.isTexture%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22t%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toJSON%28meta%29.uuid%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22c%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.getHex%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isVector2%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22v2%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isVector3%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22v3%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isVector4%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22v4%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isMatrix3%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22m3%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isMatrix4%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22m4%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20value%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28Object.keys%28this.defines%29.length%20%3E%200%29%20data.defines%20%3D%20this.defines%3B%0A%20%20%20%20data.vertexShader%20%3D%20this.vertexShader%3B%0A%20%20%20%20data.fragmentShader%20%3D%20this.fragmentShader%3B%0A%20%20%20%20data.lights%20%3D%20this.lights%3B%0A%20%20%20%20data.clipping%20%3D%20this.clipping%3B%0A%20%20%20%20const%20extensions%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20key%20in%20this.extensions%29%20%7B%0A%20%20%20%20%20%20if%20%28this.extensions%5Bkey%5D%20%3D%3D%3D%20true%29%20extensions%5Bkey%5D%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28Object.keys%28extensions%29.length%20%3E%200%29%20data.extensions%20%3D%20extensions%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Camera%20%3D%20class%20extends%20Object3D%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isCamera%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Camera%22%3B%0A%20%20%20%20this.matrixWorldInverse%20%3D%20new%20Matrix4%28%29%3B%0A%20%20%20%20this.projectionMatrix%20%3D%20new%20Matrix4%28%29%3B%0A%20%20%20%20this.projectionMatrixInverse%20%3D%20new%20Matrix4%28%29%3B%0A%20%20%20%20this.coordinateSystem%20%3D%20WebGLCoordinateSystem%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.matrixWorldInverse.copy%28source.matrixWorldInverse%29%3B%0A%20%20%20%20this.projectionMatrix.copy%28source.projectionMatrix%29%3B%0A%20%20%20%20this.projectionMatrixInverse.copy%28source.projectionMatrixInverse%29%3B%0A%20%20%20%20this.coordinateSystem%20%3D%20source.coordinateSystem%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getWorldDirection%28target%29%20%7B%0A%20%20%20%20return%20super.getWorldDirection%28target%29.negate%28%29%3B%0A%20%20%7D%0A%20%20updateMatrixWorld%28force%29%20%7B%0A%20%20%20%20super.updateMatrixWorld%28force%29%3B%0A%20%20%20%20this.matrixWorldInverse.copy%28this.matrixWorld%29.invert%28%29%3B%0A%20%20%7D%0A%20%20updateWorldMatrix%28updateParents%2C%20updateChildren%29%20%7B%0A%20%20%20%20super.updateWorldMatrix%28updateParents%2C%20updateChildren%29%3B%0A%20%20%20%20this.matrixWorldInverse.copy%28this.matrixWorld%29.invert%28%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_v3%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_minTarget%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector2%28%29%3B%0Avar%20_maxTarget%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector2%28%29%3B%0Avar%20PerspectiveCamera%20%3D%20class%20extends%20Camera%20%7B%0A%20%20constructor%28fov3%20%3D%2050%2C%20aspect3%20%3D%201%2C%20near%20%3D%200.1%2C%20far%20%3D%202e3%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isPerspectiveCamera%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22PerspectiveCamera%22%3B%0A%20%20%20%20this.fov%20%3D%20fov3%3B%0A%20%20%20%20this.zoom%20%3D%201%3B%0A%20%20%20%20this.near%20%3D%20near%3B%0A%20%20%20%20this.far%20%3D%20far%3B%0A%20%20%20%20this.focus%20%3D%2010%3B%0A%20%20%20%20this.aspect%20%3D%20aspect3%3B%0A%20%20%20%20this.view%20%3D%20null%3B%0A%20%20%20%20this.filmGauge%20%3D%2035%3B%0A%20%20%20%20this.filmOffset%20%3D%200%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.fov%20%3D%20source.fov%3B%0A%20%20%20%20this.zoom%20%3D%20source.zoom%3B%0A%20%20%20%20this.near%20%3D%20source.near%3B%0A%20%20%20%20this.far%20%3D%20source.far%3B%0A%20%20%20%20this.focus%20%3D%20source.focus%3B%0A%20%20%20%20this.aspect%20%3D%20source.aspect%3B%0A%20%20%20%20this.view%20%3D%20source.view%20%3D%3D%3D%20null%20%3F%20null%20%3A%20Object.assign%28%7B%7D%2C%20source.view%29%3B%0A%20%20%20%20this.filmGauge%20%3D%20source.filmGauge%3B%0A%20%20%20%20this.filmOffset%20%3D%20source.filmOffset%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Sets%20the%20FOV%20by%20focal%20length%20in%20respect%20to%20the%20current%20.filmGauge.%0A%20%20%20%2A%0A%20%20%20%2A%20The%20default%20film%20gauge%20is%2035%2C%20so%20that%20the%20focal%20length%20can%20be%20specified%20for%0A%20%20%20%2A%20a%2035mm%20%28full%20frame%29%20camera.%0A%20%20%20%2A%0A%20%20%20%2A%20Values%20for%20focal%20length%20and%20film%20gauge%20must%20have%20the%20same%20unit.%0A%20%20%20%2A%2F%0A%20%20setFocalLength%28focalLength%29%20%7B%0A%20%20%20%20const%20vExtentSlope%20%3D%200.5%20%2A%20this.getFilmHeight%28%29%20%2F%20focalLength%3B%0A%20%20%20%20this.fov%20%3D%20RAD2DEG%20%2A%202%20%2A%20Math.atan%28vExtentSlope%29%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Calculates%20the%20focal%20length%20from%20the%20current%20.fov%20and%20.filmGauge.%0A%20%20%20%2A%2F%0A%20%20getFocalLength%28%29%20%7B%0A%20%20%20%20const%20vExtentSlope%20%3D%20Math.tan%28DEG2RAD%20%2A%200.5%20%2A%20this.fov%29%3B%0A%20%20%20%20return%200.5%20%2A%20this.getFilmHeight%28%29%20%2F%20vExtentSlope%3B%0A%20%20%7D%0A%20%20getEffectiveFOV%28%29%20%7B%0A%20%20%20%20return%20RAD2DEG%20%2A%202%20%2A%20Math.atan%28%0A%20%20%20%20%20%20Math.tan%28DEG2RAD%20%2A%200.5%20%2A%20this.fov%29%20%2F%20this.zoom%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20getFilmWidth%28%29%20%7B%0A%20%20%20%20return%20this.filmGauge%20%2A%20Math.min%28this.aspect%2C%201%29%3B%0A%20%20%7D%0A%20%20getFilmHeight%28%29%20%7B%0A%20%20%20%20return%20this.filmGauge%20%2F%20Math.max%28this.aspect%2C%201%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Computes%20the%202D%20bounds%20of%20the%20camera%27s%20viewable%20rectangle%20at%20a%20given%20distance%20along%20the%20viewing%20direction.%0A%20%20%20%2A%20Sets%20minTarget%20and%20maxTarget%20to%20the%20coordinates%20of%20the%20lower-left%20and%20upper-right%20corners%20of%20the%20view%20rectangle.%0A%20%20%20%2A%2F%0A%20%20getViewBounds%28distance2%2C%20minTarget%2C%20maxTarget%29%20%7B%0A%20%20%20%20_v3%241.set%28-1%2C%20-1%2C%200.5%29.applyMatrix4%28this.projectionMatrixInverse%29%3B%0A%20%20%20%20minTarget.set%28_v3%241.x%2C%20_v3%241.y%29.multiplyScalar%28-distance2%20%2F%20_v3%241.z%29%3B%0A%20%20%20%20_v3%241.set%281%2C%201%2C%200.5%29.applyMatrix4%28this.projectionMatrixInverse%29%3B%0A%20%20%20%20maxTarget.set%28_v3%241.x%2C%20_v3%241.y%29.multiplyScalar%28-distance2%20%2F%20_v3%241.z%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Computes%20the%20width%20and%20height%20of%20the%20camera%27s%20viewable%20rectangle%20at%20a%20given%20distance%20along%20the%20viewing%20direction.%0A%20%20%20%2A%20Copies%20the%20result%20into%20the%20target%20Vector2%2C%20where%20x%20is%20width%20and%20y%20is%20height.%0A%20%20%20%2A%2F%0A%20%20getViewSize%28distance2%2C%20target%29%20%7B%0A%20%20%20%20this.getViewBounds%28distance2%2C%20_minTarget%2C%20_maxTarget%29%3B%0A%20%20%20%20return%20target.subVectors%28_maxTarget%2C%20_minTarget%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Sets%20an%20offset%20in%20a%20larger%20frustum.%20This%20is%20useful%20for%20multi-window%20or%0A%20%20%20%2A%20multi-monitor%2Fmulti-machine%20setups.%0A%20%20%20%2A%0A%20%20%20%2A%20For%20example%2C%20if%20you%20have%203x2%20monitors%20and%20each%20monitor%20is%201920x1080%20and%0A%20%20%20%2A%20the%20monitors%20are%20in%20grid%20like%20this%0A%20%20%20%2A%0A%20%20%20%2A%20%20%20%2B---%2B---%2B---%2B%0A%20%20%20%2A%20%20%20%7C%20A%20%7C%20B%20%7C%20C%20%7C%0A%20%20%20%2A%20%20%20%2B---%2B---%2B---%2B%0A%20%20%20%2A%20%20%20%7C%20D%20%7C%20E%20%7C%20F%20%7C%0A%20%20%20%2A%20%20%20%2B---%2B---%2B---%2B%0A%20%20%20%2A%0A%20%20%20%2A%20then%20for%20each%20monitor%20you%20would%20call%20it%20like%20this%0A%20%20%20%2A%0A%20%20%20%2A%20%20%20const%20w%20%3D%201920%3B%0A%20%20%20%2A%20%20%20const%20h%20%3D%201080%3B%0A%20%20%20%2A%20%20%20const%20fullWidth%20%3D%20w%20%2A%203%3B%0A%20%20%20%2A%20%20%20const%20fullHeight%20%3D%20h%20%2A%202%3B%0A%20%20%20%2A%0A%20%20%20%2A%20%20%20--A--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%200%2C%20h%20%2A%200%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--B--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%201%2C%20h%20%2A%200%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--C--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%202%2C%20h%20%2A%200%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--D--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%200%2C%20h%20%2A%201%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--E--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%201%2C%20h%20%2A%201%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--F--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%202%2C%20h%20%2A%201%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%0A%20%20%20%2A%20%20%20Note%20there%20is%20no%20reason%20monitors%20have%20to%20be%20the%20same%20size%20or%20in%20a%20grid.%0A%20%20%20%2A%2F%0A%20%20setViewOffset%28fullWidth%2C%20fullHeight%2C%20x2%2C%20y2%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20this.aspect%20%3D%20fullWidth%20%2F%20fullHeight%3B%0A%20%20%20%20if%20%28this.view%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.view%20%3D%20%7B%0A%20%20%20%20%20%20%20%20enabled%3A%20true%2C%0A%20%20%20%20%20%20%20%20fullWidth%3A%201%2C%0A%20%20%20%20%20%20%20%20fullHeight%3A%201%2C%0A%20%20%20%20%20%20%20%20offsetX%3A%200%2C%0A%20%20%20%20%20%20%20%20offsetY%3A%200%2C%0A%20%20%20%20%20%20%20%20width%3A%201%2C%0A%20%20%20%20%20%20%20%20height%3A%201%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.view.enabled%20%3D%20true%3B%0A%20%20%20%20this.view.fullWidth%20%3D%20fullWidth%3B%0A%20%20%20%20this.view.fullHeight%20%3D%20fullHeight%3B%0A%20%20%20%20this.view.offsetX%20%3D%20x2%3B%0A%20%20%20%20this.view.offsetY%20%3D%20y2%3B%0A%20%20%20%20this.view.width%20%3D%20width%3B%0A%20%20%20%20this.view.height%20%3D%20height%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20clearViewOffset%28%29%20%7B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.view.enabled%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20updateProjectionMatrix%28%29%20%7B%0A%20%20%20%20const%20near%20%3D%20this.near%3B%0A%20%20%20%20let%20top%20%3D%20near%20%2A%20Math.tan%28DEG2RAD%20%2A%200.5%20%2A%20this.fov%29%20%2F%20this.zoom%3B%0A%20%20%20%20let%20height%20%3D%202%20%2A%20top%3B%0A%20%20%20%20let%20width%20%3D%20this.aspect%20%2A%20height%3B%0A%20%20%20%20let%20left%20%3D%20-0.5%20%2A%20width%3B%0A%20%20%20%20const%20view%20%3D%20this.view%3B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%20%26%26%20this.view.enabled%29%20%7B%0A%20%20%20%20%20%20const%20fullWidth%20%3D%20view.fullWidth%2C%20fullHeight%20%3D%20view.fullHeight%3B%0A%20%20%20%20%20%20left%20%2B%3D%20view.offsetX%20%2A%20width%20%2F%20fullWidth%3B%0A%20%20%20%20%20%20top%20-%3D%20view.offsetY%20%2A%20height%20%2F%20fullHeight%3B%0A%20%20%20%20%20%20width%20%2A%3D%20view.width%20%2F%20fullWidth%3B%0A%20%20%20%20%20%20height%20%2A%3D%20view.height%20%2F%20fullHeight%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20skew%20%3D%20this.filmOffset%3B%0A%20%20%20%20if%20%28skew%20%21%3D%3D%200%29%20left%20%2B%3D%20near%20%2A%20skew%20%2F%20this.getFilmWidth%28%29%3B%0A%20%20%20%20this.projectionMatrix.makePerspective%28left%2C%20left%20%2B%20width%2C%20top%2C%20top%20-%20height%2C%20near%2C%20this.far%2C%20this.coordinateSystem%29%3B%0A%20%20%20%20this.projectionMatrixInverse.copy%28this.projectionMatrix%29.invert%28%29%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.object.fov%20%3D%20this.fov%3B%0A%20%20%20%20data.object.zoom%20%3D%20this.zoom%3B%0A%20%20%20%20data.object.near%20%3D%20this.near%3B%0A%20%20%20%20data.object.far%20%3D%20this.far%3B%0A%20%20%20%20data.object.focus%20%3D%20this.focus%3B%0A%20%20%20%20data.object.aspect%20%3D%20this.aspect%3B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%29%20data.object.view%20%3D%20Object.assign%28%7B%7D%2C%20this.view%29%3B%0A%20%20%20%20data.object.filmGauge%20%3D%20this.filmGauge%3B%0A%20%20%20%20data.object.filmOffset%20%3D%20this.filmOffset%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20fov%20%3D%20-90%3B%0Avar%20aspect%20%3D%201%3B%0Avar%20CubeCamera%20%3D%20class%20extends%20Object3D%20%7B%0A%20%20constructor%28near%2C%20far%2C%20renderTarget%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.type%20%3D%20%22CubeCamera%22%3B%0A%20%20%20%20this.renderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20this.coordinateSystem%20%3D%20null%3B%0A%20%20%20%20this.activeMipmapLevel%20%3D%200%3B%0A%20%20%20%20const%20cameraPX%20%3D%20new%20PerspectiveCamera%28fov%2C%20aspect%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraPX.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraPX%29%3B%0A%20%20%20%20const%20cameraNX%20%3D%20new%20PerspectiveCamera%28fov%2C%20aspect%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraNX.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraNX%29%3B%0A%20%20%20%20const%20cameraPY%20%3D%20new%20PerspectiveCamera%28fov%2C%20aspect%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraPY.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraPY%29%3B%0A%20%20%20%20const%20cameraNY%20%3D%20new%20PerspectiveCamera%28fov%2C%20aspect%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraNY.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraNY%29%3B%0A%20%20%20%20const%20cameraPZ%20%3D%20new%20PerspectiveCamera%28fov%2C%20aspect%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraPZ.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraPZ%29%3B%0A%20%20%20%20const%20cameraNZ%20%3D%20new%20PerspectiveCamera%28fov%2C%20aspect%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraNZ.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraNZ%29%3B%0A%20%20%7D%0A%20%20updateCoordinateSystem%28%29%20%7B%0A%20%20%20%20const%20coordinateSystem%20%3D%20this.coordinateSystem%3B%0A%20%20%20%20const%20cameras%20%3D%20this.children.concat%28%29%3B%0A%20%20%20%20const%20%5BcameraPX%2C%20cameraNX%2C%20cameraPY%2C%20cameraNY%2C%20cameraPZ%2C%20cameraNZ%5D%20%3D%20cameras%3B%0A%20%20%20%20for%20%28const%20camera3%20of%20cameras%29%20this.remove%28camera3%29%3B%0A%20%20%20%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem%29%20%7B%0A%20%20%20%20%20%20cameraPX.up.set%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraPX.lookAt%281%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20cameraNX.up.set%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraNX.lookAt%28-1%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20cameraPY.up.set%280%2C%200%2C%20-1%29%3B%0A%20%20%20%20%20%20cameraPY.lookAt%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraNY.up.set%280%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20cameraNY.lookAt%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraPZ.up.set%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraPZ.lookAt%280%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20cameraNZ.up.set%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraNZ.lookAt%280%2C%200%2C%20-1%29%3B%0A%20%20%20%20%7D%20else%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem%29%20%7B%0A%20%20%20%20%20%20cameraPX.up.set%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraPX.lookAt%28-1%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20cameraNX.up.set%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraNX.lookAt%281%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20cameraPY.up.set%280%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20cameraPY.lookAt%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraNY.up.set%280%2C%200%2C%20-1%29%3B%0A%20%20%20%20%20%20cameraNY.lookAt%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraPZ.up.set%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraPZ.lookAt%280%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20cameraNZ.up.set%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraNZ.lookAt%280%2C%200%2C%20-1%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.CubeCamera.updateCoordinateSystem%28%29%3A%20Invalid%20coordinate%20system%3A%20%22%20%2B%20coordinateSystem%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28const%20camera3%20of%20cameras%29%20%7B%0A%20%20%20%20%20%20this.add%28camera3%29%3B%0A%20%20%20%20%20%20camera3.updateMatrixWorld%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%28renderer3%2C%20scene3%29%20%7B%0A%20%20%20%20if%20%28this.parent%20%3D%3D%3D%20null%29%20this.updateMatrixWorld%28%29%3B%0A%20%20%20%20const%20%7B%20renderTarget%2C%20activeMipmapLevel%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28this.coordinateSystem%20%21%3D%3D%20renderer3.coordinateSystem%29%20%7B%0A%20%20%20%20%20%20this.coordinateSystem%20%3D%20renderer3.coordinateSystem%3B%0A%20%20%20%20%20%20this.updateCoordinateSystem%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20%5BcameraPX%2C%20cameraNX%2C%20cameraPY%2C%20cameraNY%2C%20cameraPZ%2C%20cameraNZ%5D%20%3D%20this.children%3B%0A%20%20%20%20const%20currentRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20const%20currentActiveCubeFace%20%3D%20renderer3.getActiveCubeFace%28%29%3B%0A%20%20%20%20const%20currentActiveMipmapLevel%20%3D%20renderer3.getActiveMipmapLevel%28%29%3B%0A%20%20%20%20const%20currentXrEnabled%20%3D%20renderer3.xr.enabled%3B%0A%20%20%20%20renderer3.xr.enabled%20%3D%20false%3B%0A%20%20%20%20const%20generateMipmaps%20%3D%20renderTarget.texture.generateMipmaps%3B%0A%20%20%20%20renderTarget.texture.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%200%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraPX%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%201%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraNX%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%202%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraPY%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%203%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraNY%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%204%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraPZ%29%3B%0A%20%20%20%20renderTarget.texture.generateMipmaps%20%3D%20generateMipmaps%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%205%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraNZ%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28currentRenderTarget%2C%20currentActiveCubeFace%2C%20currentActiveMipmapLevel%29%3B%0A%20%20%20%20renderer3.xr.enabled%20%3D%20currentXrEnabled%3B%0A%20%20%20%20renderTarget.texture.needsPMREMUpdate%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20CubeTexture%20%3D%20class%20extends%20Texture%20%7B%0A%20%20constructor%28images%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%2C%20minFilter%2C%20format2%2C%20type%2C%20anisotropy2%2C%20colorSpace%29%20%7B%0A%20%20%20%20images%20%3D%20images%20%21%3D%3D%20void%200%20%3F%20images%20%3A%20%5B%5D%3B%0A%20%20%20%20mapping%20%3D%20mapping%20%21%3D%3D%20void%200%20%3F%20mapping%20%3A%20CubeReflectionMapping%3B%0A%20%20%20%20super%28images%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%2C%20minFilter%2C%20format2%2C%20type%2C%20anisotropy2%2C%20colorSpace%29%3B%0A%20%20%20%20this.isCubeTexture%20%3D%20true%3B%0A%20%20%20%20this.flipY%20%3D%20false%3B%0A%20%20%7D%0A%20%20get%20images%28%29%20%7B%0A%20%20%20%20return%20this.image%3B%0A%20%20%7D%0A%20%20set%20images%28value%29%20%7B%0A%20%20%20%20this.image%20%3D%20value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGLCubeRenderTarget%20%3D%20class%20extends%20WebGLRenderTarget%20%7B%0A%20%20constructor%28size%20%3D%201%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28size%2C%20size%2C%20options%29%3B%0A%20%20%20%20this.isWebGLCubeRenderTarget%20%3D%20true%3B%0A%20%20%20%20const%20image%20%3D%20%7B%20width%3A%20size%2C%20height%3A%20size%2C%20depth%3A%201%20%7D%3B%0A%20%20%20%20const%20images%20%3D%20%5Bimage%2C%20image%2C%20image%2C%20image%2C%20image%2C%20image%5D%3B%0A%20%20%20%20this.texture%20%3D%20new%20CubeTexture%28images%2C%20options.mapping%2C%20options.wrapS%2C%20options.wrapT%2C%20options.magFilter%2C%20options.minFilter%2C%20options.format%2C%20options.type%2C%20options.anisotropy%2C%20options.colorSpace%29%3B%0A%20%20%20%20this.texture.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20this.texture.generateMipmaps%20%3D%20options.generateMipmaps%20%21%3D%3D%20void%200%20%3F%20options.generateMipmaps%20%3A%20false%3B%0A%20%20%20%20this.texture.minFilter%20%3D%20options.minFilter%20%21%3D%3D%20void%200%20%3F%20options.minFilter%20%3A%20LinearFilter%3B%0A%20%20%7D%0A%20%20fromEquirectangularTexture%28renderer3%2C%20texture2%29%20%7B%0A%20%20%20%20this.texture.type%20%3D%20texture2.type%3B%0A%20%20%20%20this.texture.colorSpace%20%3D%20texture2.colorSpace%3B%0A%20%20%20%20this.texture.generateMipmaps%20%3D%20texture2.generateMipmaps%3B%0A%20%20%20%20this.texture.minFilter%20%3D%20texture2.minFilter%3B%0A%20%20%20%20this.texture.magFilter%20%3D%20texture2.magFilter%3B%0A%20%20%20%20const%20shader%20%3D%20%7B%0A%20%20%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20%20%20tEquirect%3A%20%7B%20value%3A%20null%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20vertexShader%3A%20%28%0A%20%20%20%20%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%20%20%20%20%60%0A%0A%09%09%09%09varying%20vec3%20vWorldDirection%3B%0A%0A%09%09%09%09vec3%20transformDirection%28%20in%20vec3%20dir%2C%20in%20mat4%20matrix%20%29%20%7B%0A%0A%09%09%09%09%09return%20normalize%28%20%28%20matrix%20%2A%20vec4%28%20dir%2C%200.0%20%29%20%29.xyz%20%29%3B%0A%0A%09%09%09%09%7D%0A%0A%09%09%09%09void%20main%28%29%20%7B%0A%0A%09%09%09%09%09vWorldDirection%20%3D%20transformDirection%28%20position%2C%20modelMatrix%20%29%3B%0A%0A%09%09%09%09%09%23include%20%3Cbegin_vertex%3E%0A%09%09%09%09%09%23include%20%3Cproject_vertex%3E%0A%0A%09%09%09%09%7D%0A%09%09%09%60%0A%20%20%20%20%20%20%29%2C%0A%20%20%20%20%20%20fragmentShader%3A%20%28%0A%20%20%20%20%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%20%20%20%20%60%0A%0A%09%09%09%09uniform%20sampler2D%20tEquirect%3B%0A%0A%09%09%09%09varying%20vec3%20vWorldDirection%3B%0A%0A%09%09%09%09%23include%20%3Ccommon%3E%0A%0A%09%09%09%09void%20main%28%29%20%7B%0A%0A%09%09%09%09%09vec3%20direction%20%3D%20normalize%28%20vWorldDirection%20%29%3B%0A%0A%09%09%09%09%09vec2%20sampleUV%20%3D%20equirectUv%28%20direction%20%29%3B%0A%0A%09%09%09%09%09gl_FragColor%20%3D%20texture2D%28%20tEquirect%2C%20sampleUV%20%29%3B%0A%0A%09%09%09%09%7D%0A%09%09%09%60%0A%20%20%20%20%20%20%29%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20geometry%20%3D%20new%20BoxGeometry%285%2C%205%2C%205%29%3B%0A%20%20%20%20const%20material%20%3D%20new%20ShaderMaterial%28%7B%0A%20%20%20%20%20%20name%3A%20%22CubemapFromEquirect%22%2C%0A%20%20%20%20%20%20uniforms%3A%20cloneUniforms%28shader.uniforms%29%2C%0A%20%20%20%20%20%20vertexShader%3A%20shader.vertexShader%2C%0A%20%20%20%20%20%20fragmentShader%3A%20shader.fragmentShader%2C%0A%20%20%20%20%20%20side%3A%20BackSide%2C%0A%20%20%20%20%20%20blending%3A%20NoBlending%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20material.uniforms.tEquirect.value%20%3D%20texture2%3B%0A%20%20%20%20const%20mesh%20%3D%20new%20Mesh%28geometry%2C%20material%29%3B%0A%20%20%20%20const%20currentMinFilter%20%3D%20texture2.minFilter%3B%0A%20%20%20%20if%20%28texture2.minFilter%20%3D%3D%3D%20LinearMipmapLinearFilter%29%20texture2.minFilter%20%3D%20LinearFilter%3B%0A%20%20%20%20const%20camera3%20%3D%20new%20CubeCamera%281%2C%2010%2C%20this%29%3B%0A%20%20%20%20camera3.update%28renderer3%2C%20mesh%29%3B%0A%20%20%20%20texture2.minFilter%20%3D%20currentMinFilter%3B%0A%20%20%20%20mesh.geometry.dispose%28%29%3B%0A%20%20%20%20mesh.material.dispose%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clear%28renderer3%2C%20color2%2C%20depth2%2C%20stencil%29%20%7B%0A%20%20%20%20const%20currentRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20renderer3.setRenderTarget%28this%2C%20i%29%3B%0A%20%20%20%20%20%20renderer3.clear%28color2%2C%20depth2%2C%20stencil%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.setRenderTarget%28currentRenderTarget%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_vector1%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vector2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_normalMatrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%3B%0Avar%20Plane%20%3D%20class%20%7B%0A%20%20constructor%28normal2%20%3D%20new%20Vector3%281%2C%200%2C%200%29%2C%20constant%20%3D%200%29%20%7B%0A%20%20%20%20this.isPlane%20%3D%20true%3B%0A%20%20%20%20this.normal%20%3D%20normal2%3B%0A%20%20%20%20this.constant%20%3D%20constant%3B%0A%20%20%7D%0A%20%20set%28normal2%2C%20constant%29%20%7B%0A%20%20%20%20this.normal.copy%28normal2%29%3B%0A%20%20%20%20this.constant%20%3D%20constant%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setComponents%28x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20this.normal.set%28x2%2C%20y2%2C%20z2%29%3B%0A%20%20%20%20this.constant%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromNormalAndCoplanarPoint%28normal2%2C%20point%29%20%7B%0A%20%20%20%20this.normal.copy%28normal2%29%3B%0A%20%20%20%20this.constant%20%3D%20-point.dot%28this.normal%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromCoplanarPoints%28a2%2C%20b%2C%20c2%29%20%7B%0A%20%20%20%20const%20normal2%20%3D%20_vector1.subVectors%28c2%2C%20b%29.cross%28_vector2.subVectors%28a2%2C%20b%29%29.normalize%28%29%3B%0A%20%20%20%20this.setFromNormalAndCoplanarPoint%28normal2%2C%20a2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28plane%29%20%7B%0A%20%20%20%20this.normal.copy%28plane.normal%29%3B%0A%20%20%20%20this.constant%20%3D%20plane.constant%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20const%20inverseNormalLength%20%3D%201%20%2F%20this.normal.length%28%29%3B%0A%20%20%20%20this.normal.multiplyScalar%28inverseNormalLength%29%3B%0A%20%20%20%20this.constant%20%2A%3D%20inverseNormalLength%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20negate%28%29%20%7B%0A%20%20%20%20this.constant%20%2A%3D%20-1%3B%0A%20%20%20%20this.normal.negate%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20distanceToPoint%28point%29%20%7B%0A%20%20%20%20return%20this.normal.dot%28point%29%20%2B%20this.constant%3B%0A%20%20%7D%0A%20%20distanceToSphere%28sphere%29%20%7B%0A%20%20%20%20return%20this.distanceToPoint%28sphere.center%29%20-%20sphere.radius%3B%0A%20%20%7D%0A%20%20projectPoint%28point%2C%20target%29%20%7B%0A%20%20%20%20return%20target.copy%28point%29.addScaledVector%28this.normal%2C%20-this.distanceToPoint%28point%29%29%3B%0A%20%20%7D%0A%20%20intersectLine%28line%2C%20target%29%20%7B%0A%20%20%20%20const%20direction2%20%3D%20line.delta%28_vector1%29%3B%0A%20%20%20%20const%20denominator%20%3D%20this.normal.dot%28direction2%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28this.distanceToPoint%28line.start%29%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20target.copy%28line.start%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20t%20%3D%20-%28line.start.dot%28this.normal%29%20%2B%20this.constant%29%20%2F%20denominator%3B%0A%20%20%20%20if%20%28t%20%3C%200%20%7C%7C%20t%20%3E%201%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target.copy%28line.start%29.addScaledVector%28direction2%2C%20t%29%3B%0A%20%20%7D%0A%20%20intersectsLine%28line%29%20%7B%0A%20%20%20%20const%20startSign%20%3D%20this.distanceToPoint%28line.start%29%3B%0A%20%20%20%20const%20endSign%20%3D%20this.distanceToPoint%28line.end%29%3B%0A%20%20%20%20return%20startSign%20%3C%200%20%26%26%20endSign%20%3E%200%20%7C%7C%20endSign%20%3C%200%20%26%26%20startSign%20%3E%200%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20box.intersectsPlane%28this%29%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20return%20sphere.intersectsPlane%28this%29%3B%0A%20%20%7D%0A%20%20coplanarPoint%28target%29%20%7B%0A%20%20%20%20return%20target.copy%28this.normal%29.multiplyScalar%28-this.constant%29%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%2C%20optionalNormalMatrix%29%20%7B%0A%20%20%20%20const%20normalMatrix%20%3D%20optionalNormalMatrix%20%7C%7C%20_normalMatrix.getNormalMatrix%28matrix%29%3B%0A%20%20%20%20const%20referencePoint%20%3D%20this.coplanarPoint%28_vector1%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20const%20normal2%20%3D%20this.normal.applyMatrix3%28normalMatrix%29.normalize%28%29%3B%0A%20%20%20%20this.constant%20%3D%20-referencePoint.dot%28normal2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28offset%29%20%7B%0A%20%20%20%20this.constant%20-%3D%20offset.dot%28this.normal%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28plane%29%20%7B%0A%20%20%20%20return%20plane.normal.equals%28this.normal%29%20%26%26%20plane.constant%20%3D%3D%3D%20this.constant%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_sphere%245%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Sphere%28%29%3B%0Avar%20_vector%247%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20Frustum%20%3D%20class%20%7B%0A%20%20constructor%28p0%20%3D%20new%20Plane%28%29%2C%20p1%20%3D%20new%20Plane%28%29%2C%20p2%20%3D%20new%20Plane%28%29%2C%20p3%20%3D%20new%20Plane%28%29%2C%20p4%20%3D%20new%20Plane%28%29%2C%20p5%20%3D%20new%20Plane%28%29%29%20%7B%0A%20%20%20%20this.planes%20%3D%20%5Bp0%2C%20p1%2C%20p2%2C%20p3%2C%20p4%2C%20p5%5D%3B%0A%20%20%7D%0A%20%20set%28p0%2C%20p1%2C%20p2%2C%20p3%2C%20p4%2C%20p5%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20planes%5B0%5D.copy%28p0%29%3B%0A%20%20%20%20planes%5B1%5D.copy%28p1%29%3B%0A%20%20%20%20planes%5B2%5D.copy%28p2%29%3B%0A%20%20%20%20planes%5B3%5D.copy%28p3%29%3B%0A%20%20%20%20planes%5B4%5D.copy%28p4%29%3B%0A%20%20%20%20planes%5B5%5D.copy%28p5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28frustum%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20planes%5Bi%5D.copy%28frustum.planes%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromProjectionMatrix%28m2%2C%20coordinateSystem%20%3D%20WebGLCoordinateSystem%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20const%20me0%20%3D%20me%5B0%5D%2C%20me1%20%3D%20me%5B1%5D%2C%20me2%20%3D%20me%5B2%5D%2C%20me3%20%3D%20me%5B3%5D%3B%0A%20%20%20%20const%20me4%20%3D%20me%5B4%5D%2C%20me5%20%3D%20me%5B5%5D%2C%20me6%20%3D%20me%5B6%5D%2C%20me7%20%3D%20me%5B7%5D%3B%0A%20%20%20%20const%20me8%20%3D%20me%5B8%5D%2C%20me9%20%3D%20me%5B9%5D%2C%20me10%20%3D%20me%5B10%5D%2C%20me11%20%3D%20me%5B11%5D%3B%0A%20%20%20%20const%20me12%20%3D%20me%5B12%5D%2C%20me13%20%3D%20me%5B13%5D%2C%20me14%20%3D%20me%5B14%5D%2C%20me15%20%3D%20me%5B15%5D%3B%0A%20%20%20%20planes%5B0%5D.setComponents%28me3%20-%20me0%2C%20me7%20-%20me4%2C%20me11%20-%20me8%2C%20me15%20-%20me12%29.normalize%28%29%3B%0A%20%20%20%20planes%5B1%5D.setComponents%28me3%20%2B%20me0%2C%20me7%20%2B%20me4%2C%20me11%20%2B%20me8%2C%20me15%20%2B%20me12%29.normalize%28%29%3B%0A%20%20%20%20planes%5B2%5D.setComponents%28me3%20%2B%20me1%2C%20me7%20%2B%20me5%2C%20me11%20%2B%20me9%2C%20me15%20%2B%20me13%29.normalize%28%29%3B%0A%20%20%20%20planes%5B3%5D.setComponents%28me3%20-%20me1%2C%20me7%20-%20me5%2C%20me11%20-%20me9%2C%20me15%20-%20me13%29.normalize%28%29%3B%0A%20%20%20%20planes%5B4%5D.setComponents%28me3%20-%20me2%2C%20me7%20-%20me6%2C%20me11%20-%20me10%2C%20me15%20-%20me14%29.normalize%28%29%3B%0A%20%20%20%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem%29%20%7B%0A%20%20%20%20%20%20planes%5B5%5D.setComponents%28me3%20%2B%20me2%2C%20me7%20%2B%20me6%2C%20me11%20%2B%20me10%2C%20me15%20%2B%20me14%29.normalize%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem%29%20%7B%0A%20%20%20%20%20%20planes%5B5%5D.setComponents%28me2%2C%20me6%2C%20me10%2C%20me14%29.normalize%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.Frustum.setFromProjectionMatrix%28%29%3A%20Invalid%20coordinate%20system%3A%20%22%20%2B%20coordinateSystem%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20intersectsObject%28object%29%20%7B%0A%20%20%20%20if%20%28object.boundingSphere%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28object.boundingSphere%20%3D%3D%3D%20null%29%20object.computeBoundingSphere%28%29%3B%0A%20%20%20%20%20%20_sphere%245.copy%28object.boundingSphere%29.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20geometry%20%3D%20object.geometry%3B%0A%20%20%20%20%20%20if%20%28geometry.boundingSphere%20%3D%3D%3D%20null%29%20geometry.computeBoundingSphere%28%29%3B%0A%20%20%20%20%20%20_sphere%245.copy%28geometry.boundingSphere%29.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.intersectsSphere%28_sphere%245%29%3B%0A%20%20%7D%0A%20%20intersectsSprite%28sprite%29%20%7B%0A%20%20%20%20_sphere%245.center.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20_sphere%245.radius%20%3D%200.7071067811865476%3B%0A%20%20%20%20_sphere%245.applyMatrix4%28sprite.matrixWorld%29%3B%0A%20%20%20%20return%20this.intersectsSphere%28_sphere%245%29%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20const%20center%20%3D%20sphere.center%3B%0A%20%20%20%20const%20negRadius%20%3D%20-sphere.radius%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20distance2%20%3D%20planes%5Bi%5D.distanceToPoint%28center%29%3B%0A%20%20%20%20%20%20if%20%28distance2%20%3C%20negRadius%29%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20plane%20%3D%20planes%5Bi%5D%3B%0A%20%20%20%20%20%20_vector%247.x%20%3D%20plane.normal.x%20%3E%200%20%3F%20box.max.x%20%3A%20box.min.x%3B%0A%20%20%20%20%20%20_vector%247.y%20%3D%20plane.normal.y%20%3E%200%20%3F%20box.max.y%20%3A%20box.min.y%3B%0A%20%20%20%20%20%20_vector%247.z%20%3D%20plane.normal.z%20%3E%200%20%3F%20box.max.z%20%3A%20box.min.z%3B%0A%20%20%20%20%20%20if%20%28plane.distanceToPoint%28_vector%247%29%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20containsPoint%28point%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28planes%5Bi%5D.distanceToPoint%28point%29%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20WebGLAnimation%28%29%20%7B%0A%20%20let%20context2%20%3D%20null%3B%0A%20%20let%20isAnimating%20%3D%20false%3B%0A%20%20let%20animationLoop%20%3D%20null%3B%0A%20%20let%20requestId%20%3D%20null%3B%0A%20%20function%20onAnimationFrame%28time%2C%20frame2%29%20%7B%0A%20%20%20%20animationLoop%28time%2C%20frame2%29%3B%0A%20%20%20%20requestId%20%3D%20context2.requestAnimationFrame%28onAnimationFrame%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20start%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28isAnimating%20%3D%3D%3D%20true%29%20return%3B%0A%20%20%20%20%20%20if%20%28animationLoop%20%3D%3D%3D%20null%29%20return%3B%0A%20%20%20%20%20%20requestId%20%3D%20context2.requestAnimationFrame%28onAnimationFrame%29%3B%0A%20%20%20%20%20%20isAnimating%20%3D%20true%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20stop%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20context2.cancelAnimationFrame%28requestId%29%3B%0A%20%20%20%20%20%20isAnimating%20%3D%20false%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20setAnimationLoop%3A%20function%28callback%29%20%7B%0A%20%20%20%20%20%20animationLoop%20%3D%20callback%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20setContext%3A%20function%28value%29%20%7B%0A%20%20%20%20%20%20context2%20%3D%20value%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLAttributes%28gl%29%20%7B%0A%20%20const%20buffers%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20function%20createBuffer%28attribute2%2C%20bufferType%29%20%7B%0A%20%20%20%20const%20array%20%3D%20attribute2.array%3B%0A%20%20%20%20const%20usage%20%3D%20attribute2.usage%3B%0A%20%20%20%20const%20size%20%3D%20array.byteLength%3B%0A%20%20%20%20const%20buffer2%20%3D%20gl.createBuffer%28%29%3B%0A%20%20%20%20gl.bindBuffer%28bufferType%2C%20buffer2%29%3B%0A%20%20%20%20gl.bufferData%28bufferType%2C%20array%2C%20usage%29%3B%0A%20%20%20%20attribute2.onUploadCallback%28%29%3B%0A%20%20%20%20let%20type%3B%0A%20%20%20%20if%20%28array%20instanceof%20Float32Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.FLOAT%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Uint16Array%29%20%7B%0A%20%20%20%20%20%20if%20%28attribute2.isFloat16BufferAttribute%29%20%7B%0A%20%20%20%20%20%20%20%20type%20%3D%20gl.HALF_FLOAT%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20type%20%3D%20gl.UNSIGNED_SHORT%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Int16Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.SHORT%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Uint32Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.UNSIGNED_INT%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Int32Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.INT%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Int8Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.BYTE%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Uint8Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.UNSIGNED_BYTE%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Uint8ClampedArray%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.UNSIGNED_BYTE%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGLAttributes%3A%20Unsupported%20buffer%20data%20format%3A%20%22%20%2B%20array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20buffer%3A%20buffer2%2C%0A%20%20%20%20%20%20type%2C%0A%20%20%20%20%20%20bytesPerElement%3A%20array.BYTES_PER_ELEMENT%2C%0A%20%20%20%20%20%20version%3A%20attribute2.version%2C%0A%20%20%20%20%20%20size%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20function%20updateBuffer%28buffer2%2C%20attribute2%2C%20bufferType%29%20%7B%0A%20%20%20%20const%20array%20%3D%20attribute2.array%3B%0A%20%20%20%20const%20updateRanges%20%3D%20attribute2.updateRanges%3B%0A%20%20%20%20gl.bindBuffer%28bufferType%2C%20buffer2%29%3B%0A%20%20%20%20if%20%28updateRanges.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20gl.bufferSubData%28bufferType%2C%200%2C%20array%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20updateRanges.sort%28%28a2%2C%20b%29%20%3D%3E%20a2.start%20-%20b.start%29%3B%0A%20%20%20%20%20%20let%20mergeIndex%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%20updateRanges.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20previousRange%20%3D%20updateRanges%5BmergeIndex%5D%3B%0A%20%20%20%20%20%20%20%20const%20range%20%3D%20updateRanges%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28range.start%20%3C%3D%20previousRange.start%20%2B%20previousRange.count%20%2B%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20previousRange.count%20%3D%20Math.max%28%0A%20%20%20%20%20%20%20%20%20%20%20%20previousRange.count%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20range.start%20%2B%20range.count%20-%20previousRange.start%0A%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2B%2BmergeIndex%3B%0A%20%20%20%20%20%20%20%20%20%20updateRanges%5BmergeIndex%5D%20%3D%20range%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20updateRanges.length%20%3D%20mergeIndex%20%2B%201%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20updateRanges.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20range%20%3D%20updateRanges%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20gl.bufferSubData%28%0A%20%20%20%20%20%20%20%20%20%20bufferType%2C%0A%20%20%20%20%20%20%20%20%20%20range.start%20%2A%20array.BYTES_PER_ELEMENT%2C%0A%20%20%20%20%20%20%20%20%20%20array%2C%0A%20%20%20%20%20%20%20%20%20%20range.start%2C%0A%20%20%20%20%20%20%20%20%20%20range.count%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20attribute2.clearUpdateRanges%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20attribute2.onUploadCallback%28%29%3B%0A%20%20%7D%0A%20%20function%20get2%28attribute2%29%20%7B%0A%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20attribute2%20%3D%20attribute2.data%3B%0A%20%20%20%20return%20buffers.get%28attribute2%29%3B%0A%20%20%7D%0A%20%20function%20remove2%28attribute2%29%20%7B%0A%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20attribute2%20%3D%20attribute2.data%3B%0A%20%20%20%20const%20data%20%3D%20buffers.get%28attribute2%29%3B%0A%20%20%20%20if%20%28data%29%20%7B%0A%20%20%20%20%20%20gl.deleteBuffer%28data.buffer%29%3B%0A%20%20%20%20%20%20buffers.delete%28attribute2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20update4%28attribute2%2C%20bufferType%29%20%7B%0A%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20attribute2%20%3D%20attribute2.data%3B%0A%20%20%20%20if%20%28attribute2.isGLBufferAttribute%29%20%7B%0A%20%20%20%20%20%20const%20cached%20%3D%20buffers.get%28attribute2%29%3B%0A%20%20%20%20%20%20if%20%28%21cached%20%7C%7C%20cached.version%20%3C%20attribute2.version%29%20%7B%0A%20%20%20%20%20%20%20%20buffers.set%28attribute2%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20buffer%3A%20attribute2.buffer%2C%0A%20%20%20%20%20%20%20%20%20%20type%3A%20attribute2.type%2C%0A%20%20%20%20%20%20%20%20%20%20bytesPerElement%3A%20attribute2.elementSize%2C%0A%20%20%20%20%20%20%20%20%20%20version%3A%20attribute2.version%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20data%20%3D%20buffers.get%28attribute2%29%3B%0A%20%20%20%20if%20%28data%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20buffers.set%28attribute2%2C%20createBuffer%28attribute2%2C%20bufferType%29%29%3B%0A%20%20%20%20%7D%20else%20if%20%28data.version%20%3C%20attribute2.version%29%20%7B%0A%20%20%20%20%20%20if%20%28data.size%20%21%3D%3D%20attribute2.array.byteLength%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGLAttributes%3A%20The%20size%20of%20the%20buffer%20attribute%27s%20array%20buffer%20does%20not%20match%20the%20original%20size.%20Resizing%20buffer%20attributes%20is%20not%20supported.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20updateBuffer%28data.buffer%2C%20attribute2%2C%20bufferType%29%3B%0A%20%20%20%20%20%20data.version%20%3D%20attribute2.version%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20get%3A%20get2%2C%0A%20%20%20%20remove%3A%20remove2%2C%0A%20%20%20%20update%3A%20update4%0A%20%20%7D%3B%0A%7D%0Avar%20PlaneGeometry%20%3D%20class%20_PlaneGeometry%20extends%20BufferGeometry%20%7B%0A%20%20constructor%28width%20%3D%201%2C%20height%20%3D%201%2C%20widthSegments%20%3D%201%2C%20heightSegments%20%3D%201%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.type%20%3D%20%22PlaneGeometry%22%3B%0A%20%20%20%20this.parameters%20%3D%20%7B%0A%20%20%20%20%20%20width%2C%0A%20%20%20%20%20%20height%2C%0A%20%20%20%20%20%20widthSegments%2C%0A%20%20%20%20%20%20heightSegments%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20width_half%20%3D%20width%20%2F%202%3B%0A%20%20%20%20const%20height_half%20%3D%20height%20%2F%202%3B%0A%20%20%20%20const%20gridX%20%3D%20Math.floor%28widthSegments%29%3B%0A%20%20%20%20const%20gridY%20%3D%20Math.floor%28heightSegments%29%3B%0A%20%20%20%20const%20gridX1%20%3D%20gridX%20%2B%201%3B%0A%20%20%20%20const%20gridY1%20%3D%20gridY%20%2B%201%3B%0A%20%20%20%20const%20segment_width%20%3D%20width%20%2F%20gridX%3B%0A%20%20%20%20const%20segment_height%20%3D%20height%20%2F%20gridY%3B%0A%20%20%20%20const%20indices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vertices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20normals%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20uvs%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%20gridY1%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20y2%20%3D%20iy%20%2A%20segment_height%20-%20height_half%3B%0A%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%20gridX1%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20x2%20%3D%20ix%20%2A%20segment_width%20-%20width_half%3B%0A%20%20%20%20%20%20%20%20vertices.push%28x2%2C%20-y2%2C%200%29%3B%0A%20%20%20%20%20%20%20%20normals.push%280%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20%20%20uvs.push%28ix%20%2F%20gridX%29%3B%0A%20%20%20%20%20%20%20%20uvs.push%281%20-%20iy%20%2F%20gridY%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%20gridY%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%20gridX%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20a2%20%3D%20ix%20%2B%20gridX1%20%2A%20iy%3B%0A%20%20%20%20%20%20%20%20const%20b%20%3D%20ix%20%2B%20gridX1%20%2A%20%28iy%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20const%20c2%20%3D%20ix%20%2B%201%20%2B%20gridX1%20%2A%20%28iy%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20const%20d%20%3D%20ix%20%2B%201%20%2B%20gridX1%20%2A%20iy%3B%0A%20%20%20%20%20%20%20%20indices.push%28a2%2C%20b%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20indices.push%28b%2C%20c2%2C%20d%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.setIndex%28indices%29%3B%0A%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute%28vertices%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22normal%22%2C%20new%20Float32BufferAttribute%28normals%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22uv%22%2C%20new%20Float32BufferAttribute%28uvs%2C%202%29%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.parameters%20%3D%20Object.assign%28%7B%7D%2C%20source.parameters%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20static%20fromJSON%28data%29%20%7B%0A%20%20%20%20return%20new%20_PlaneGeometry%28data.width%2C%20data.height%2C%20data.widthSegments%2C%20data.heightSegments%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20alphahash_fragment%20%3D%20%22%23ifdef%20USE_ALPHAHASH%5Cn%09if%20%28%20diffuseColor.a%20%3C%20getAlphaHashThreshold%28%20vPosition%20%29%20%29%20discard%3B%5Cn%23endif%22%3B%0Avar%20alphahash_pars_fragment%20%3D%20%22%23ifdef%20USE_ALPHAHASH%5Cn%09const%20float%20ALPHA_HASH_SCALE%20%3D%200.05%3B%5Cn%09float%20hash2D%28%20vec2%20value%20%29%20%7B%5Cn%09%09return%20fract%28%201.0e4%20%2A%20sin%28%2017.0%20%2A%20value.x%20%2B%200.1%20%2A%20value.y%20%29%20%2A%20%28%200.1%20%2B%20abs%28%20sin%28%2013.0%20%2A%20value.y%20%2B%20value.x%20%29%20%29%20%29%20%29%3B%5Cn%09%7D%5Cn%09float%20hash3D%28%20vec3%20value%20%29%20%7B%5Cn%09%09return%20hash2D%28%20vec2%28%20hash2D%28%20value.xy%20%29%2C%20value.z%20%29%20%29%3B%5Cn%09%7D%5Cn%09float%20getAlphaHashThreshold%28%20vec3%20position%20%29%20%7B%5Cn%09%09float%20maxDeriv%20%3D%20max%28%5Cn%09%09%09length%28%20dFdx%28%20position.xyz%20%29%20%29%2C%5Cn%09%09%09length%28%20dFdy%28%20position.xyz%20%29%20%29%5Cn%09%09%29%3B%5Cn%09%09float%20pixScale%20%3D%201.0%20%2F%20%28%20ALPHA_HASH_SCALE%20%2A%20maxDeriv%20%29%3B%5Cn%09%09vec2%20pixScales%20%3D%20vec2%28%5Cn%09%09%09exp2%28%20floor%28%20log2%28%20pixScale%20%29%20%29%20%29%2C%5Cn%09%09%09exp2%28%20ceil%28%20log2%28%20pixScale%20%29%20%29%20%29%5Cn%09%09%29%3B%5Cn%09%09vec2%20alpha%20%3D%20vec2%28%5Cn%09%09%09hash3D%28%20floor%28%20pixScales.x%20%2A%20position.xyz%20%29%20%29%2C%5Cn%09%09%09hash3D%28%20floor%28%20pixScales.y%20%2A%20position.xyz%20%29%20%29%5Cn%09%09%29%3B%5Cn%09%09float%20lerpFactor%20%3D%20fract%28%20log2%28%20pixScale%20%29%20%29%3B%5Cn%09%09float%20x%20%3D%20%28%201.0%20-%20lerpFactor%20%29%20%2A%20alpha.x%20%2B%20lerpFactor%20%2A%20alpha.y%3B%5Cn%09%09float%20a%20%3D%20min%28%20lerpFactor%2C%201.0%20-%20lerpFactor%20%29%3B%5Cn%09%09vec3%20cases%20%3D%20vec3%28%5Cn%09%09%09x%20%2A%20x%20%2F%20%28%202.0%20%2A%20a%20%2A%20%28%201.0%20-%20a%20%29%20%29%2C%5Cn%09%09%09%28%20x%20-%200.5%20%2A%20a%20%29%20%2F%20%28%201.0%20-%20a%20%29%2C%5Cn%09%09%091.0%20-%20%28%20%28%201.0%20-%20x%20%29%20%2A%20%28%201.0%20-%20x%20%29%20%2F%20%28%202.0%20%2A%20a%20%2A%20%28%201.0%20-%20a%20%29%20%29%20%29%5Cn%09%09%29%3B%5Cn%09%09float%20threshold%20%3D%20%28%20x%20%3C%20%28%201.0%20-%20a%20%29%20%29%5Cn%09%09%09%3F%20%28%20%28%20x%20%3C%20a%20%29%20%3F%20cases.x%20%3A%20cases.y%20%29%5Cn%09%09%09%3A%20cases.z%3B%5Cn%09%09return%20clamp%28%20threshold%20%2C%201.0e-6%2C%201.0%20%29%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20alphamap_fragment%20%3D%20%22%23ifdef%20USE_ALPHAMAP%5Cn%09diffuseColor.a%20%2A%3D%20texture2D%28%20alphaMap%2C%20vAlphaMapUv%20%29.g%3B%5Cn%23endif%22%3B%0Avar%20alphamap_pars_fragment%20%3D%20%22%23ifdef%20USE_ALPHAMAP%5Cn%09uniform%20sampler2D%20alphaMap%3B%5Cn%23endif%22%3B%0Avar%20alphatest_fragment%20%3D%20%22%23ifdef%20USE_ALPHATEST%5Cn%09%23ifdef%20ALPHA_TO_COVERAGE%5Cn%09diffuseColor.a%20%3D%20smoothstep%28%20alphaTest%2C%20alphaTest%20%2B%20fwidth%28%20diffuseColor.a%20%29%2C%20diffuseColor.a%20%29%3B%5Cn%09if%20%28%20diffuseColor.a%20%3D%3D%200.0%20%29%20discard%3B%5Cn%09%23else%5Cn%09if%20%28%20diffuseColor.a%20%3C%20alphaTest%20%29%20discard%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20alphatest_pars_fragment%20%3D%20%22%23ifdef%20USE_ALPHATEST%5Cn%09uniform%20float%20alphaTest%3B%5Cn%23endif%22%3B%0Avar%20aomap_fragment%20%3D%20%22%23ifdef%20USE_AOMAP%5Cn%09float%20ambientOcclusion%20%3D%20%28%20texture2D%28%20aoMap%2C%20vAoMapUv%20%29.r%20-%201.0%20%29%20%2A%20aoMapIntensity%20%2B%201.0%3B%5Cn%09reflectedLight.indirectDiffuse%20%2A%3D%20ambientOcclusion%3B%5Cn%09%23if%20defined%28%20USE_CLEARCOAT%20%29%20%5Cn%09%09clearcoatSpecularIndirect%20%2A%3D%20ambientOcclusion%3B%5Cn%09%23endif%5Cn%09%23if%20defined%28%20USE_SHEEN%20%29%20%5Cn%09%09sheenSpecularIndirect%20%2A%3D%20ambientOcclusion%3B%5Cn%09%23endif%5Cn%09%23if%20defined%28%20USE_ENVMAP%20%29%20%26%26%20defined%28%20STANDARD%20%29%5Cn%09%09float%20dotNV%20%3D%20saturate%28%20dot%28%20geometryNormal%2C%20geometryViewDir%20%29%20%29%3B%5Cn%09%09reflectedLight.indirectSpecular%20%2A%3D%20computeSpecularOcclusion%28%20dotNV%2C%20ambientOcclusion%2C%20material.roughness%20%29%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20aomap_pars_fragment%20%3D%20%22%23ifdef%20USE_AOMAP%5Cn%09uniform%20sampler2D%20aoMap%3B%5Cn%09uniform%20float%20aoMapIntensity%3B%5Cn%23endif%22%3B%0Avar%20batching_pars_vertex%20%3D%20%22%23ifdef%20USE_BATCHING%5Cn%09%23if%20%21%20defined%28%20GL_ANGLE_multi_draw%20%29%5Cn%09%23define%20gl_DrawID%20_gl_DrawID%5Cn%09uniform%20int%20_gl_DrawID%3B%5Cn%09%23endif%5Cn%09uniform%20highp%20sampler2D%20batchingTexture%3B%5Cn%09uniform%20highp%20usampler2D%20batchingIdTexture%3B%5Cn%09mat4%20getBatchingMatrix%28%20const%20in%20float%20i%20%29%20%7B%5Cn%09%09int%20size%20%3D%20textureSize%28%20batchingTexture%2C%200%20%29.x%3B%5Cn%09%09int%20j%20%3D%20int%28%20i%20%29%20%2A%204%3B%5Cn%09%09int%20x%20%3D%20j%20%25%20size%3B%5Cn%09%09int%20y%20%3D%20j%20%2F%20size%3B%5Cn%09%09vec4%20v1%20%3D%20texelFetch%28%20batchingTexture%2C%20ivec2%28%20x%2C%20y%20%29%2C%200%20%29%3B%5Cn%09%09vec4%20v2%20%3D%20texelFetch%28%20batchingTexture%2C%20ivec2%28%20x%20%2B%201%2C%20y%20%29%2C%200%20%29%3B%5Cn%09%09vec4%20v3%20%3D%20texelFetch%28%20batchingTexture%2C%20ivec2%28%20x%20%2B%202%2C%20y%20%29%2C%200%20%29%3B%5Cn%09%09vec4%20v4%20%3D%20texelFetch%28%20batchingTexture%2C%20ivec2%28%20x%20%2B%203%2C%20y%20%29%2C%200%20%29%3B%5Cn%09%09return%20mat4%28%20v1%2C%20v2%2C%20v3%2C%20v4%20%29%3B%5Cn%09%7D%5Cn%09float%20getIndirectIndex%28%20const%20in%20int%20i%20%29%20%7B%5Cn%09%09int%20size%20%3D%20textureSize%28%20batchingIdTexture%2C%200%20%29.x%3B%5Cn%09%09int%20x%20%3D%20i%20%25%20size%3B%5Cn%09%09int%20y%20%3D%20i%20%2F%20size%3B%5Cn%09%09return%20float%28%20texelFetch%28%20batchingIdTexture%2C%20ivec2%28%20x%2C%20y%20%29%2C%200%20%29.r%20%29%3B%5Cn%09%7D%5Cn%23endif%5Cn%23ifdef%20USE_BATCHING_COLOR%5Cn%09uniform%20sampler2D%20batchingColorTexture%3B%5Cn%09vec3%20getBatchingColor%28%20const%20in%20float%20i%20%29%20%7B%5Cn%09%09int%20size%20%3D%20textureSize%28%20batchingColorTexture%2C%200%20%29.x%3B%5Cn%09%09int%20j%20%3D%20int%28%20i%20%29%3B%5Cn%09%09int%20x%20%3D%20j%20%25%20size%3B%5Cn%09%09int%20y%20%3D%20j%20%2F%20size%3B%5Cn%09%09return%20texelFetch%28%20batchingColorTexture%2C%20ivec2%28%20x%2C%20y%20%29%2C%200%20%29.rgb%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20batching_vertex%20%3D%20%22%23ifdef%20USE_BATCHING%5Cn%09mat4%20batchingMatrix%20%3D%20getBatchingMatrix%28%20getIndirectIndex%28%20gl_DrawID%20%29%20%29%3B%5Cn%23endif%22%3B%0Avar%20begin_vertex%20%3D%20%22vec3%20transformed%20%3D%20vec3%28%20position%20%29%3B%5Cn%23ifdef%20USE_ALPHAHASH%5Cn%09vPosition%20%3D%20vec3%28%20position%20%29%3B%5Cn%23endif%22%3B%0Avar%20beginnormal_vertex%20%3D%20%22vec3%20objectNormal%20%3D%20vec3%28%20normal%20%29%3B%5Cn%23ifdef%20USE_TANGENT%5Cn%09vec3%20objectTangent%20%3D%20vec3%28%20tangent.xyz%20%29%3B%5Cn%23endif%22%3B%0Avar%20bsdfs%20%3D%20%22float%20G_BlinnPhong_Implicit%28%20%29%20%7B%5Cn%09return%200.25%3B%5Cn%7D%5Cnfloat%20D_BlinnPhong%28%20const%20in%20float%20shininess%2C%20const%20in%20float%20dotNH%20%29%20%7B%5Cn%09return%20RECIPROCAL_PI%20%2A%20%28%20shininess%20%2A%200.5%20%2B%201.0%20%29%20%2A%20pow%28%20dotNH%2C%20shininess%20%29%3B%5Cn%7D%5Cnvec3%20BRDF_BlinnPhong%28%20const%20in%20vec3%20lightDir%2C%20const%20in%20vec3%20viewDir%2C%20const%20in%20vec3%20normal%2C%20const%20in%20vec3%20specularColor%2C%20const%20in%20float%20shininess%20%29%20%7B%5Cn%09vec3%20halfDir%20%3D%20normalize%28%20lightDir%20%2B%20viewDir%20%29%3B%5Cn%09float%20dotNH%20%3D%20saturate%28%20dot%28%20normal%2C%20halfDir%20%29%20%29%3B%5Cn%09float%20dotVH%20%3D%20saturate%28%20dot%28%20viewDir%2C%20halfDir%20%29%20%29%3B%5Cn%09vec3%20F%20%3D%20F_Schlick%28%20specularColor%2C%201.0%2C%20dotVH%20%29%3B%5Cn%09float%20G%20%3D%20G_BlinnPhong_Implicit%28%20%29%3B%5Cn%09float%20D%20%3D%20D_BlinnPhong%28%20shininess%2C%20dotNH%20%29%3B%5Cn%09return%20F%20%2A%20%28%20G%20%2A%20D%20%29%3B%5Cn%7D%20%2F%2F%20validated%22%3B%0Avar%20iridescence_fragment%20%3D%20%22%23ifdef%20USE_IRIDESCENCE%5Cn%09const%20mat3%20XYZ_TO_REC709%20%3D%20mat3%28%5Cn%09%09%203.2404542%2C%20-0.9692660%2C%20%200.0556434%2C%5Cn%09%09-1.5371385%2C%20%201.8760108%2C%20-0.2040259%2C%5Cn%09%09-0.4985314%2C%20%200.0415560%2C%20%201.0572252%5Cn%09%29%3B%5Cn%09vec3%20Fresnel0ToIor%28%20vec3%20fresnel0%20%29%20%7B%5Cn%09%09vec3%20sqrtF0%20%3D%20sqrt%28%20fresnel0%20%29%3B%5Cn%09%09return%20%28%20vec3%28%201.0%20%29%20%2B%20sqrtF0%20%29%20%2F%20%28%20vec3%28%201.0%20%29%20-%20sqrtF0%20%29%3B%5Cn%09%7D%5Cn%09vec3%20IorToFresnel0%28%20vec3%20transmittedIor%2C%20float%20incidentIor%20%29%20%7B%5Cn%09%09return%20pow2%28%20%28%20transmittedIor%20-%20vec3%28%20incidentIor%20%29%20%29%20%2F%20%28%20transmittedIor%20%2B%20vec3%28%20incidentIor%20%29%20%29%20%29%3B%5Cn%09%7D%5Cn%09float%20IorToFresnel0%28%20float%20transmittedIor%2C%20float%20incidentIor%20%29%20%7B%5Cn%09%09return%20pow2%28%20%28%20transmittedIor%20-%20incidentIor%20%29%20%2F%20%28%20transmittedIor%20%2B%20incidentIor%20%29%29%3B%5Cn%09%7D%5Cn%09vec3%20evalSensitivity%28%20float%20OPD%2C%20vec3%20shift%20%29%20%7B%5Cn%09%09float%20phase%20%3D%202.0%20%2A%20PI%20%2A%20OPD%20%2A%201.0e-9%3B%5Cn%09%09vec3%20val%20%3D%20vec3%28%205.4856e-13%2C%204.4201e-13%2C%205.2481e-13%20%29%3B%5Cn%09%09vec3%20pos%20%3D%20vec3%28%201.6810e%2B06%2C%201.7953e%2B06%2C%202.2084e%2B06%20%29%3B%5Cn%09%09vec3%20var%20%3D%20vec3%28%204.3278e%2B09%2C%209.3046e%2B09%2C%206.6121e%2B09%20%29%3B%5Cn%09%09vec3%20xyz%20%3D%20val%20%2A%20sqrt%28%202.0%20%2A%20PI%20%2A%20var%20%29%20%2A%20cos%28%20pos%20%2A%20phase%20%2B%20shift%20%29%20%2A%20exp%28%20-%20pow2%28%20phase%20%29%20%2A%20var%20%29%3B%5Cn%09%09xyz.x%20%2B%3D%209.7470e-14%20%2A%20sqrt%28%202.0%20%2A%20PI%20%2A%204.5282e%2B09%20%29%20%2A%20cos%28%202.2399e%2B06%20%2A%20phase%20%2B%20shift%5B%200%20%5D%20%29%20%2A%20exp%28%20-%204.5282e%2B09%20%2A%20pow2%28%20phase%20%29%20%29%3B%5Cn%09%09xyz%20%2F%3D%201.0685e-7%3B%5Cn%09%09vec3%20rgb%20%3D%20XYZ_TO_REC709%20%2A%20xyz%3B%5Cn%09%09return%20rgb%3B%5Cn%09%7D%5Cn%09vec3%20evalIridescence%28%20float%20outsideIOR%2C%20float%20eta2%2C%20float%20cosTheta1%2C%20float%20thinFilmThickness%2C%20vec3%20baseF0%20%29%20%7B%5Cn%09%09vec3%20I%3B%5Cn%09%09float%20iridescenceIOR%20%3D%20mix%28%20outsideIOR%2C%20eta2%2C%20smoothstep%28%200.0%2C%200.03%2C%20thinFilmThickness%20%29%20%29%3B%5Cn%09%09float%20sinTheta2Sq%20%3D%20pow2%28%20outsideIOR%20%2F%20iridescenceIOR%20%29%20%2A%20%28%201.0%20-%20pow2%28%20cosTheta1%20%29%20%29%3B%5Cn%09%09float%20cosTheta2Sq%20%3D%201.0%20-%20sinTheta2Sq%3B%5Cn%09%09if%20%28%20cosTheta2Sq%20%3C%200.0%20%29%20%7B%5Cn%09%09%09return%20vec3%28%201.0%20%29%3B%5Cn%09%09%7D%5Cn%09%09float%20cosTheta2%20%3D%20sqrt%28%20cosTheta2Sq%20%29%3B%5Cn%09%09float%20R0%20%3D%20IorToFresnel0%28%20iridescenceIOR%2C%20outsideIOR%20%29%3B%5Cn%09%09float%20R12%20%3D%20F_Schlick%28%20R0%2C%201.0%2C%20cosTheta1%20%29%3B%5Cn%09%09float%20T121%20%3D%201.0%20-%20R12%3B%5Cn%09%09float%20phi12%20%3D%200.0%3B%5Cn%09%09if%20%28%20iridescenceIOR%20%3C%20outsideIOR%20%29%20phi12%20%3D%20PI%3B%5Cn%09%09float%20phi21%20%3D%20PI%20-%20phi12%3B%5Cn%09%09vec3%20baseIOR%20%3D%20Fresnel0ToIor%28%20clamp%28%20baseF0%2C%200.0%2C%200.9999%20%29%20%29%3B%09%09vec3%20R1%20%3D%20IorToFresnel0%28%20baseIOR%2C%20iridescenceIOR%20%29%3B%5Cn%09%09vec3%20R23%20%3D%20F_Schlick%28%20R1%2C%201.0%2C%20cosTheta2%20%29%3B%5Cn%09%09vec3%20phi23%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09%09if%20%28%20baseIOR%5B%200%20%5D%20%3C%20iridescenceIOR%20%29%20phi23%5B%200%20%5D%20%3D%20PI%3B%5Cn%09%09if%20%28%20baseIOR%5B%201%20%5D%20%3C%20iridescenceIOR%20%29%20phi23%5B%201%20%5D%20%3D%20PI%3B%5Cn%09%09if%20%28%20baseIOR%5B%202%20%5D%20%3C%20iridescenceIOR%20%29%20phi23%5B%202%20%5D%20%3D%20PI%3B%5Cn%09%09float%20OPD%20%3D%202.0%20%2A%20iridescenceIOR%20%2A%20thinFilmThickness%20%2A%20cosTheta2%3B%5Cn%09%09vec3%20phi%20%3D%20vec3%28%20phi21%20%29%20%2B%20phi23%3B%5Cn%09%09vec3%20R123%20%3D%20clamp%28%20R12%20%2A%20R23%2C%201e-5%2C%200.9999%20%29%3B%5Cn%09%09vec3%20r123%20%3D%20sqrt%28%20R123%20%29%3B%5Cn%09%09vec3%20Rs%20%3D%20pow2%28%20T121%20%29%20%2A%20R23%20%2F%20%28%20vec3%28%201.0%20%29%20-%20R123%20%29%3B%5Cn%09%09vec3%20C0%20%3D%20R12%20%2B%20Rs%3B%5Cn%09%09I%20%3D%20C0%3B%5Cn%09%09vec3%20Cm%20%3D%20Rs%20-%20T121%3B%5Cn%09%09for%20%28%20int%20m%20%3D%201%3B%20m%20%3C%3D%202%3B%20%2B%2B%20m%20%29%20%7B%5Cn%09%09%09Cm%20%2A%3D%20r123%3B%5Cn%09%09%09vec3%20Sm%20%3D%202.0%20%2A%20evalSensitivity%28%20float%28%20m%20%29%20%2A%20OPD%2C%20float%28%20m%20%29%20%2A%20phi%20%29%3B%5Cn%09%09%09I%20%2B%3D%20Cm%20%2A%20Sm%3B%5Cn%09%09%7D%5Cn%09%09return%20max%28%20I%2C%20vec3%28%200.0%20%29%20%29%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20bumpmap_pars_fragment%20%3D%20%22%23ifdef%20USE_BUMPMAP%5Cn%09uniform%20sampler2D%20bumpMap%3B%5Cn%09uniform%20float%20bumpScale%3B%5Cn%09vec2%20dHdxy_fwd%28%29%20%7B%5Cn%09%09vec2%20dSTdx%20%3D%20dFdx%28%20vBumpMapUv%20%29%3B%5Cn%09%09vec2%20dSTdy%20%3D%20dFdy%28%20vBumpMapUv%20%29%3B%5Cn%09%09float%20Hll%20%3D%20bumpScale%20%2A%20texture2D%28%20bumpMap%2C%20vBumpMapUv%20%29.x%3B%5Cn%09%09float%20dBx%20%3D%20bumpScale%20%2A%20texture2D%28%20bumpMap%2C%20vBumpMapUv%20%2B%20dSTdx%20%29.x%20-%20Hll%3B%5Cn%09%09float%20dBy%20%3D%20bumpScale%20%2A%20texture2D%28%20bumpMap%2C%20vBumpMapUv%20%2B%20dSTdy%20%29.x%20-%20Hll%3B%5Cn%09%09return%20vec2%28%20dBx%2C%20dBy%20%29%3B%5Cn%09%7D%5Cn%09vec3%20perturbNormalArb%28%20vec3%20surf_pos%2C%20vec3%20surf_norm%2C%20vec2%20dHdxy%2C%20float%20faceDirection%20%29%20%7B%5Cn%09%09vec3%20vSigmaX%20%3D%20normalize%28%20dFdx%28%20surf_pos.xyz%20%29%20%29%3B%5Cn%09%09vec3%20vSigmaY%20%3D%20normalize%28%20dFdy%28%20surf_pos.xyz%20%29%20%29%3B%5Cn%09%09vec3%20vN%20%3D%20surf_norm%3B%5Cn%09%09vec3%20R1%20%3D%20cross%28%20vSigmaY%2C%20vN%20%29%3B%5Cn%09%09vec3%20R2%20%3D%20cross%28%20vN%2C%20vSigmaX%20%29%3B%5Cn%09%09float%20fDet%20%3D%20dot%28%20vSigmaX%2C%20R1%20%29%20%2A%20faceDirection%3B%5Cn%09%09vec3%20vGrad%20%3D%20sign%28%20fDet%20%29%20%2A%20%28%20dHdxy.x%20%2A%20R1%20%2B%20dHdxy.y%20%2A%20R2%20%29%3B%5Cn%09%09return%20normalize%28%20abs%28%20fDet%20%29%20%2A%20surf_norm%20-%20vGrad%20%29%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20clipping_planes_fragment%20%3D%20%22%23if%20NUM_CLIPPING_PLANES%20%3E%200%5Cn%09vec4%20plane%3B%5Cn%09%23ifdef%20ALPHA_TO_COVERAGE%5Cn%09%09float%20distanceToPlane%2C%20distanceGradient%3B%5Cn%09%09float%20clipOpacity%20%3D%201.0%3B%5Cn%09%09%23pragma%20unroll_loop_start%5Cn%09%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20UNION_CLIPPING_PLANES%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09%09plane%20%3D%20clippingPlanes%5B%20i%20%5D%3B%5Cn%09%09%09distanceToPlane%20%3D%20-%20dot%28%20vClipPosition%2C%20plane.xyz%20%29%20%2B%20plane.w%3B%5Cn%09%09%09distanceGradient%20%3D%20fwidth%28%20distanceToPlane%20%29%20%2F%202.0%3B%5Cn%09%09%09clipOpacity%20%2A%3D%20smoothstep%28%20-%20distanceGradient%2C%20distanceGradient%2C%20distanceToPlane%20%29%3B%5Cn%09%09%09if%20%28%20clipOpacity%20%3D%3D%200.0%20%29%20discard%3B%5Cn%09%09%7D%5Cn%09%09%23pragma%20unroll_loop_end%5Cn%09%09%23if%20UNION_CLIPPING_PLANES%20%3C%20NUM_CLIPPING_PLANES%5Cn%09%09%09float%20unionClipOpacity%20%3D%201.0%3B%5Cn%09%09%09%23pragma%20unroll_loop_start%5Cn%09%09%09for%20%28%20int%20i%20%3D%20UNION_CLIPPING_PLANES%3B%20i%20%3C%20NUM_CLIPPING_PLANES%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09%09%09plane%20%3D%20clippingPlanes%5B%20i%20%5D%3B%5Cn%09%09%09%09distanceToPlane%20%3D%20-%20dot%28%20vClipPosition%2C%20plane.xyz%20%29%20%2B%20plane.w%3B%5Cn%09%09%09%09distanceGradient%20%3D%20fwidth%28%20distanceToPlane%20%29%20%2F%202.0%3B%5Cn%09%09%09%09unionClipOpacity%20%2A%3D%201.0%20-%20smoothstep%28%20-%20distanceGradient%2C%20distanceGradient%2C%20distanceToPlane%20%29%3B%5Cn%09%09%09%7D%5Cn%09%09%09%23pragma%20unroll_loop_end%5Cn%09%09%09clipOpacity%20%2A%3D%201.0%20-%20unionClipOpacity%3B%5Cn%09%09%23endif%5Cn%09%09diffuseColor.a%20%2A%3D%20clipOpacity%3B%5Cn%09%09if%20%28%20diffuseColor.a%20%3D%3D%200.0%20%29%20discard%3B%5Cn%09%23else%5Cn%09%09%23pragma%20unroll_loop_start%5Cn%09%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20UNION_CLIPPING_PLANES%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09%09plane%20%3D%20clippingPlanes%5B%20i%20%5D%3B%5Cn%09%09%09if%20%28%20dot%28%20vClipPosition%2C%20plane.xyz%20%29%20%3E%20plane.w%20%29%20discard%3B%5Cn%09%09%7D%5Cn%09%09%23pragma%20unroll_loop_end%5Cn%09%09%23if%20UNION_CLIPPING_PLANES%20%3C%20NUM_CLIPPING_PLANES%5Cn%09%09%09bool%20clipped%20%3D%20true%3B%5Cn%09%09%09%23pragma%20unroll_loop_start%5Cn%09%09%09for%20%28%20int%20i%20%3D%20UNION_CLIPPING_PLANES%3B%20i%20%3C%20NUM_CLIPPING_PLANES%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09%09%09plane%20%3D%20clippingPlanes%5B%20i%20%5D%3B%5Cn%09%09%09%09clipped%20%3D%20%28%20dot%28%20vClipPosition%2C%20plane.xyz%20%29%20%3E%20plane.w%20%29%20%26%26%20clipped%3B%5Cn%09%09%09%7D%5Cn%09%09%09%23pragma%20unroll_loop_end%5Cn%09%09%09if%20%28%20clipped%20%29%20discard%3B%5Cn%09%09%23endif%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20clipping_planes_pars_fragment%20%3D%20%22%23if%20NUM_CLIPPING_PLANES%20%3E%200%5Cn%09varying%20vec3%20vClipPosition%3B%5Cn%09uniform%20vec4%20clippingPlanes%5B%20NUM_CLIPPING_PLANES%20%5D%3B%5Cn%23endif%22%3B%0Avar%20clipping_planes_pars_vertex%20%3D%20%22%23if%20NUM_CLIPPING_PLANES%20%3E%200%5Cn%09varying%20vec3%20vClipPosition%3B%5Cn%23endif%22%3B%0Avar%20clipping_planes_vertex%20%3D%20%22%23if%20NUM_CLIPPING_PLANES%20%3E%200%5Cn%09vClipPosition%20%3D%20-%20mvPosition.xyz%3B%5Cn%23endif%22%3B%0Avar%20color_fragment%20%3D%20%22%23if%20defined%28%20USE_COLOR_ALPHA%20%29%5Cn%09diffuseColor%20%2A%3D%20vColor%3B%5Cn%23elif%20defined%28%20USE_COLOR%20%29%5Cn%09diffuseColor.rgb%20%2A%3D%20vColor%3B%5Cn%23endif%22%3B%0Avar%20color_pars_fragment%20%3D%20%22%23if%20defined%28%20USE_COLOR_ALPHA%20%29%5Cn%09varying%20vec4%20vColor%3B%5Cn%23elif%20defined%28%20USE_COLOR%20%29%5Cn%09varying%20vec3%20vColor%3B%5Cn%23endif%22%3B%0Avar%20color_pars_vertex%20%3D%20%22%23if%20defined%28%20USE_COLOR_ALPHA%20%29%5Cn%09varying%20vec4%20vColor%3B%5Cn%23elif%20defined%28%20USE_COLOR%20%29%20%7C%7C%20defined%28%20USE_INSTANCING_COLOR%20%29%20%7C%7C%20defined%28%20USE_BATCHING_COLOR%20%29%5Cn%09varying%20vec3%20vColor%3B%5Cn%23endif%22%3B%0Avar%20color_vertex%20%3D%20%22%23if%20defined%28%20USE_COLOR_ALPHA%20%29%5Cn%09vColor%20%3D%20vec4%28%201.0%20%29%3B%5Cn%23elif%20defined%28%20USE_COLOR%20%29%20%7C%7C%20defined%28%20USE_INSTANCING_COLOR%20%29%20%7C%7C%20defined%28%20USE_BATCHING_COLOR%20%29%5Cn%09vColor%20%3D%20vec3%28%201.0%20%29%3B%5Cn%23endif%5Cn%23ifdef%20USE_COLOR%5Cn%09vColor%20%2A%3D%20color%3B%5Cn%23endif%5Cn%23ifdef%20USE_INSTANCING_COLOR%5Cn%09vColor.xyz%20%2A%3D%20instanceColor.xyz%3B%5Cn%23endif%5Cn%23ifdef%20USE_BATCHING_COLOR%5Cn%09vec3%20batchingColor%20%3D%20getBatchingColor%28%20getIndirectIndex%28%20gl_DrawID%20%29%20%29%3B%5Cn%09vColor.xyz%20%2A%3D%20batchingColor.xyz%3B%5Cn%23endif%22%3B%0Avar%20common%20%3D%20%22%23define%20PI%203.141592653589793%5Cn%23define%20PI2%206.283185307179586%5Cn%23define%20PI_HALF%201.5707963267948966%5Cn%23define%20RECIPROCAL_PI%200.3183098861837907%5Cn%23define%20RECIPROCAL_PI2%200.15915494309189535%5Cn%23define%20EPSILON%201e-6%5Cn%23ifndef%20saturate%5Cn%23define%20saturate%28%20a%20%29%20clamp%28%20a%2C%200.0%2C%201.0%20%29%5Cn%23endif%5Cn%23define%20whiteComplement%28%20a%20%29%20%28%201.0%20-%20saturate%28%20a%20%29%20%29%5Cnfloat%20pow2%28%20const%20in%20float%20x%20%29%20%7B%20return%20x%2Ax%3B%20%7D%5Cnvec3%20pow2%28%20const%20in%20vec3%20x%20%29%20%7B%20return%20x%2Ax%3B%20%7D%5Cnfloat%20pow3%28%20const%20in%20float%20x%20%29%20%7B%20return%20x%2Ax%2Ax%3B%20%7D%5Cnfloat%20pow4%28%20const%20in%20float%20x%20%29%20%7B%20float%20x2%20%3D%20x%2Ax%3B%20return%20x2%2Ax2%3B%20%7D%5Cnfloat%20max3%28%20const%20in%20vec3%20v%20%29%20%7B%20return%20max%28%20max%28%20v.x%2C%20v.y%20%29%2C%20v.z%20%29%3B%20%7D%5Cnfloat%20average%28%20const%20in%20vec3%20v%20%29%20%7B%20return%20dot%28%20v%2C%20vec3%28%200.3333333%20%29%20%29%3B%20%7D%5Cnhighp%20float%20rand%28%20const%20in%20vec2%20uv%20%29%20%7B%5Cn%09const%20highp%20float%20a%20%3D%2012.9898%2C%20b%20%3D%2078.233%2C%20c%20%3D%2043758.5453%3B%5Cn%09highp%20float%20dt%20%3D%20dot%28%20uv.xy%2C%20vec2%28%20a%2Cb%20%29%20%29%2C%20sn%20%3D%20mod%28%20dt%2C%20PI%20%29%3B%5Cn%09return%20fract%28%20sin%28%20sn%20%29%20%2A%20c%20%29%3B%5Cn%7D%5Cn%23ifdef%20HIGH_PRECISION%5Cn%09float%20precisionSafeLength%28%20vec3%20v%20%29%20%7B%20return%20length%28%20v%20%29%3B%20%7D%5Cn%23else%5Cn%09float%20precisionSafeLength%28%20vec3%20v%20%29%20%7B%5Cn%09%09float%20maxComponent%20%3D%20max3%28%20abs%28%20v%20%29%20%29%3B%5Cn%09%09return%20length%28%20v%20%2F%20maxComponent%20%29%20%2A%20maxComponent%3B%5Cn%09%7D%5Cn%23endif%5Cnstruct%20IncidentLight%20%7B%5Cn%09vec3%20color%3B%5Cn%09vec3%20direction%3B%5Cn%09bool%20visible%3B%5Cn%7D%3B%5Cnstruct%20ReflectedLight%20%7B%5Cn%09vec3%20directDiffuse%3B%5Cn%09vec3%20directSpecular%3B%5Cn%09vec3%20indirectDiffuse%3B%5Cn%09vec3%20indirectSpecular%3B%5Cn%7D%3B%5Cn%23ifdef%20USE_ALPHAHASH%5Cn%09varying%20vec3%20vPosition%3B%5Cn%23endif%5Cnvec3%20transformDirection%28%20in%20vec3%20dir%2C%20in%20mat4%20matrix%20%29%20%7B%5Cn%09return%20normalize%28%20%28%20matrix%20%2A%20vec4%28%20dir%2C%200.0%20%29%20%29.xyz%20%29%3B%5Cn%7D%5Cnvec3%20inverseTransformDirection%28%20in%20vec3%20dir%2C%20in%20mat4%20matrix%20%29%20%7B%5Cn%09return%20normalize%28%20%28%20vec4%28%20dir%2C%200.0%20%29%20%2A%20matrix%20%29.xyz%20%29%3B%5Cn%7D%5Cnmat3%20transposeMat3%28%20const%20in%20mat3%20m%20%29%20%7B%5Cn%09mat3%20tmp%3B%5Cn%09tmp%5B%200%20%5D%20%3D%20vec3%28%20m%5B%200%20%5D.x%2C%20m%5B%201%20%5D.x%2C%20m%5B%202%20%5D.x%20%29%3B%5Cn%09tmp%5B%201%20%5D%20%3D%20vec3%28%20m%5B%200%20%5D.y%2C%20m%5B%201%20%5D.y%2C%20m%5B%202%20%5D.y%20%29%3B%5Cn%09tmp%5B%202%20%5D%20%3D%20vec3%28%20m%5B%200%20%5D.z%2C%20m%5B%201%20%5D.z%2C%20m%5B%202%20%5D.z%20%29%3B%5Cn%09return%20tmp%3B%5Cn%7D%5Cnbool%20isPerspectiveMatrix%28%20mat4%20m%20%29%20%7B%5Cn%09return%20m%5B%202%20%5D%5B%203%20%5D%20%3D%3D%20-%201.0%3B%5Cn%7D%5Cnvec2%20equirectUv%28%20in%20vec3%20dir%20%29%20%7B%5Cn%09float%20u%20%3D%20atan%28%20dir.z%2C%20dir.x%20%29%20%2A%20RECIPROCAL_PI2%20%2B%200.5%3B%5Cn%09float%20v%20%3D%20asin%28%20clamp%28%20dir.y%2C%20-%201.0%2C%201.0%20%29%20%29%20%2A%20RECIPROCAL_PI%20%2B%200.5%3B%5Cn%09return%20vec2%28%20u%2C%20v%20%29%3B%5Cn%7D%5Cnvec3%20BRDF_Lambert%28%20const%20in%20vec3%20diffuseColor%20%29%20%7B%5Cn%09return%20RECIPROCAL_PI%20%2A%20diffuseColor%3B%5Cn%7D%5Cnvec3%20F_Schlick%28%20const%20in%20vec3%20f0%2C%20const%20in%20float%20f90%2C%20const%20in%20float%20dotVH%20%29%20%7B%5Cn%09float%20fresnel%20%3D%20exp2%28%20%28%20-%205.55473%20%2A%20dotVH%20-%206.98316%20%29%20%2A%20dotVH%20%29%3B%5Cn%09return%20f0%20%2A%20%28%201.0%20-%20fresnel%20%29%20%2B%20%28%20f90%20%2A%20fresnel%20%29%3B%5Cn%7D%5Cnfloat%20F_Schlick%28%20const%20in%20float%20f0%2C%20const%20in%20float%20f90%2C%20const%20in%20float%20dotVH%20%29%20%7B%5Cn%09float%20fresnel%20%3D%20exp2%28%20%28%20-%205.55473%20%2A%20dotVH%20-%206.98316%20%29%20%2A%20dotVH%20%29%3B%5Cn%09return%20f0%20%2A%20%28%201.0%20-%20fresnel%20%29%20%2B%20%28%20f90%20%2A%20fresnel%20%29%3B%5Cn%7D%20%2F%2F%20validated%22%3B%0Avar%20cube_uv_reflection_fragment%20%3D%20%22%23ifdef%20ENVMAP_TYPE_CUBE_UV%5Cn%09%23define%20cubeUV_minMipLevel%204.0%5Cn%09%23define%20cubeUV_minTileSize%2016.0%5Cn%09float%20getFace%28%20vec3%20direction%20%29%20%7B%5Cn%09%09vec3%20absDirection%20%3D%20abs%28%20direction%20%29%3B%5Cn%09%09float%20face%20%3D%20-%201.0%3B%5Cn%09%09if%20%28%20absDirection.x%20%3E%20absDirection.z%20%29%20%7B%5Cn%09%09%09if%20%28%20absDirection.x%20%3E%20absDirection.y%20%29%5Cn%09%09%09%09face%20%3D%20direction.x%20%3E%200.0%20%3F%200.0%20%3A%203.0%3B%5Cn%09%09%09else%5Cn%09%09%09%09face%20%3D%20direction.y%20%3E%200.0%20%3F%201.0%20%3A%204.0%3B%5Cn%09%09%7D%20else%20%7B%5Cn%09%09%09if%20%28%20absDirection.z%20%3E%20absDirection.y%20%29%5Cn%09%09%09%09face%20%3D%20direction.z%20%3E%200.0%20%3F%202.0%20%3A%205.0%3B%5Cn%09%09%09else%5Cn%09%09%09%09face%20%3D%20direction.y%20%3E%200.0%20%3F%201.0%20%3A%204.0%3B%5Cn%09%09%7D%5Cn%09%09return%20face%3B%5Cn%09%7D%5Cn%09vec2%20getUV%28%20vec3%20direction%2C%20float%20face%20%29%20%7B%5Cn%09%09vec2%20uv%3B%5Cn%09%09if%20%28%20face%20%3D%3D%200.0%20%29%20%7B%5Cn%09%09%09uv%20%3D%20vec2%28%20direction.z%2C%20direction.y%20%29%20%2F%20abs%28%20direction.x%20%29%3B%5Cn%09%09%7D%20else%20if%20%28%20face%20%3D%3D%201.0%20%29%20%7B%5Cn%09%09%09uv%20%3D%20vec2%28%20-%20direction.x%2C%20-%20direction.z%20%29%20%2F%20abs%28%20direction.y%20%29%3B%5Cn%09%09%7D%20else%20if%20%28%20face%20%3D%3D%202.0%20%29%20%7B%5Cn%09%09%09uv%20%3D%20vec2%28%20-%20direction.x%2C%20direction.y%20%29%20%2F%20abs%28%20direction.z%20%29%3B%5Cn%09%09%7D%20else%20if%20%28%20face%20%3D%3D%203.0%20%29%20%7B%5Cn%09%09%09uv%20%3D%20vec2%28%20-%20direction.z%2C%20direction.y%20%29%20%2F%20abs%28%20direction.x%20%29%3B%5Cn%09%09%7D%20else%20if%20%28%20face%20%3D%3D%204.0%20%29%20%7B%5Cn%09%09%09uv%20%3D%20vec2%28%20-%20direction.x%2C%20direction.z%20%29%20%2F%20abs%28%20direction.y%20%29%3B%5Cn%09%09%7D%20else%20%7B%5Cn%09%09%09uv%20%3D%20vec2%28%20direction.x%2C%20direction.y%20%29%20%2F%20abs%28%20direction.z%20%29%3B%5Cn%09%09%7D%5Cn%09%09return%200.5%20%2A%20%28%20uv%20%2B%201.0%20%29%3B%5Cn%09%7D%5Cn%09vec3%20bilinearCubeUV%28%20sampler2D%20envMap%2C%20vec3%20direction%2C%20float%20mipInt%20%29%20%7B%5Cn%09%09float%20face%20%3D%20getFace%28%20direction%20%29%3B%5Cn%09%09float%20filterInt%20%3D%20max%28%20cubeUV_minMipLevel%20-%20mipInt%2C%200.0%20%29%3B%5Cn%09%09mipInt%20%3D%20max%28%20mipInt%2C%20cubeUV_minMipLevel%20%29%3B%5Cn%09%09float%20faceSize%20%3D%20exp2%28%20mipInt%20%29%3B%5Cn%09%09highp%20vec2%20uv%20%3D%20getUV%28%20direction%2C%20face%20%29%20%2A%20%28%20faceSize%20-%202.0%20%29%20%2B%201.0%3B%5Cn%09%09if%20%28%20face%20%3E%202.0%20%29%20%7B%5Cn%09%09%09uv.y%20%2B%3D%20faceSize%3B%5Cn%09%09%09face%20-%3D%203.0%3B%5Cn%09%09%7D%5Cn%09%09uv.x%20%2B%3D%20face%20%2A%20faceSize%3B%5Cn%09%09uv.x%20%2B%3D%20filterInt%20%2A%203.0%20%2A%20cubeUV_minTileSize%3B%5Cn%09%09uv.y%20%2B%3D%204.0%20%2A%20%28%20exp2%28%20CUBEUV_MAX_MIP%20%29%20-%20faceSize%20%29%3B%5Cn%09%09uv.x%20%2A%3D%20CUBEUV_TEXEL_WIDTH%3B%5Cn%09%09uv.y%20%2A%3D%20CUBEUV_TEXEL_HEIGHT%3B%5Cn%09%09%23ifdef%20texture2DGradEXT%5Cn%09%09%09return%20texture2DGradEXT%28%20envMap%2C%20uv%2C%20vec2%28%200.0%20%29%2C%20vec2%28%200.0%20%29%20%29.rgb%3B%5Cn%09%09%23else%5Cn%09%09%09return%20texture2D%28%20envMap%2C%20uv%20%29.rgb%3B%5Cn%09%09%23endif%5Cn%09%7D%5Cn%09%23define%20cubeUV_r0%201.0%5Cn%09%23define%20cubeUV_m0%20-%202.0%5Cn%09%23define%20cubeUV_r1%200.8%5Cn%09%23define%20cubeUV_m1%20-%201.0%5Cn%09%23define%20cubeUV_r4%200.4%5Cn%09%23define%20cubeUV_m4%202.0%5Cn%09%23define%20cubeUV_r5%200.305%5Cn%09%23define%20cubeUV_m5%203.0%5Cn%09%23define%20cubeUV_r6%200.21%5Cn%09%23define%20cubeUV_m6%204.0%5Cn%09float%20roughnessToMip%28%20float%20roughness%20%29%20%7B%5Cn%09%09float%20mip%20%3D%200.0%3B%5Cn%09%09if%20%28%20roughness%20%3E%3D%20cubeUV_r1%20%29%20%7B%5Cn%09%09%09mip%20%3D%20%28%20cubeUV_r0%20-%20roughness%20%29%20%2A%20%28%20cubeUV_m1%20-%20cubeUV_m0%20%29%20%2F%20%28%20cubeUV_r0%20-%20cubeUV_r1%20%29%20%2B%20cubeUV_m0%3B%5Cn%09%09%7D%20else%20if%20%28%20roughness%20%3E%3D%20cubeUV_r4%20%29%20%7B%5Cn%09%09%09mip%20%3D%20%28%20cubeUV_r1%20-%20roughness%20%29%20%2A%20%28%20cubeUV_m4%20-%20cubeUV_m1%20%29%20%2F%20%28%20cubeUV_r1%20-%20cubeUV_r4%20%29%20%2B%20cubeUV_m1%3B%5Cn%09%09%7D%20else%20if%20%28%20roughness%20%3E%3D%20cubeUV_r5%20%29%20%7B%5Cn%09%09%09mip%20%3D%20%28%20cubeUV_r4%20-%20roughness%20%29%20%2A%20%28%20cubeUV_m5%20-%20cubeUV_m4%20%29%20%2F%20%28%20cubeUV_r4%20-%20cubeUV_r5%20%29%20%2B%20cubeUV_m4%3B%5Cn%09%09%7D%20else%20if%20%28%20roughness%20%3E%3D%20cubeUV_r6%20%29%20%7B%5Cn%09%09%09mip%20%3D%20%28%20cubeUV_r5%20-%20roughness%20%29%20%2A%20%28%20cubeUV_m6%20-%20cubeUV_m5%20%29%20%2F%20%28%20cubeUV_r5%20-%20cubeUV_r6%20%29%20%2B%20cubeUV_m5%3B%5Cn%09%09%7D%20else%20%7B%5Cn%09%09%09mip%20%3D%20-%202.0%20%2A%20log2%28%201.16%20%2A%20roughness%20%29%3B%09%09%7D%5Cn%09%09return%20mip%3B%5Cn%09%7D%5Cn%09vec4%20textureCubeUV%28%20sampler2D%20envMap%2C%20vec3%20sampleDir%2C%20float%20roughness%20%29%20%7B%5Cn%09%09float%20mip%20%3D%20clamp%28%20roughnessToMip%28%20roughness%20%29%2C%20cubeUV_m0%2C%20CUBEUV_MAX_MIP%20%29%3B%5Cn%09%09float%20mipF%20%3D%20fract%28%20mip%20%29%3B%5Cn%09%09float%20mipInt%20%3D%20floor%28%20mip%20%29%3B%5Cn%09%09vec3%20color0%20%3D%20bilinearCubeUV%28%20envMap%2C%20sampleDir%2C%20mipInt%20%29%3B%5Cn%09%09if%20%28%20mipF%20%3D%3D%200.0%20%29%20%7B%5Cn%09%09%09return%20vec4%28%20color0%2C%201.0%20%29%3B%5Cn%09%09%7D%20else%20%7B%5Cn%09%09%09vec3%20color1%20%3D%20bilinearCubeUV%28%20envMap%2C%20sampleDir%2C%20mipInt%20%2B%201.0%20%29%3B%5Cn%09%09%09return%20vec4%28%20mix%28%20color0%2C%20color1%2C%20mipF%20%29%2C%201.0%20%29%3B%5Cn%09%09%7D%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20defaultnormal_vertex%20%3D%20%22vec3%20transformedNormal%20%3D%20objectNormal%3B%5Cn%23ifdef%20USE_TANGENT%5Cn%09vec3%20transformedTangent%20%3D%20objectTangent%3B%5Cn%23endif%5Cn%23ifdef%20USE_BATCHING%5Cn%09mat3%20bm%20%3D%20mat3%28%20batchingMatrix%20%29%3B%5Cn%09transformedNormal%20%2F%3D%20vec3%28%20dot%28%20bm%5B%200%20%5D%2C%20bm%5B%200%20%5D%20%29%2C%20dot%28%20bm%5B%201%20%5D%2C%20bm%5B%201%20%5D%20%29%2C%20dot%28%20bm%5B%202%20%5D%2C%20bm%5B%202%20%5D%20%29%20%29%3B%5Cn%09transformedNormal%20%3D%20bm%20%2A%20transformedNormal%3B%5Cn%09%23ifdef%20USE_TANGENT%5Cn%09%09transformedTangent%20%3D%20bm%20%2A%20transformedTangent%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23ifdef%20USE_INSTANCING%5Cn%09mat3%20im%20%3D%20mat3%28%20instanceMatrix%20%29%3B%5Cn%09transformedNormal%20%2F%3D%20vec3%28%20dot%28%20im%5B%200%20%5D%2C%20im%5B%200%20%5D%20%29%2C%20dot%28%20im%5B%201%20%5D%2C%20im%5B%201%20%5D%20%29%2C%20dot%28%20im%5B%202%20%5D%2C%20im%5B%202%20%5D%20%29%20%29%3B%5Cn%09transformedNormal%20%3D%20im%20%2A%20transformedNormal%3B%5Cn%09%23ifdef%20USE_TANGENT%5Cn%09%09transformedTangent%20%3D%20im%20%2A%20transformedTangent%3B%5Cn%09%23endif%5Cn%23endif%5CntransformedNormal%20%3D%20normalMatrix%20%2A%20transformedNormal%3B%5Cn%23ifdef%20FLIP_SIDED%5Cn%09transformedNormal%20%3D%20-%20transformedNormal%3B%5Cn%23endif%5Cn%23ifdef%20USE_TANGENT%5Cn%09transformedTangent%20%3D%20%28%20modelViewMatrix%20%2A%20vec4%28%20transformedTangent%2C%200.0%20%29%20%29.xyz%3B%5Cn%09%23ifdef%20FLIP_SIDED%5Cn%09%09transformedTangent%20%3D%20-%20transformedTangent%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20displacementmap_pars_vertex%20%3D%20%22%23ifdef%20USE_DISPLACEMENTMAP%5Cn%09uniform%20sampler2D%20displacementMap%3B%5Cn%09uniform%20float%20displacementScale%3B%5Cn%09uniform%20float%20displacementBias%3B%5Cn%23endif%22%3B%0Avar%20displacementmap_vertex%20%3D%20%22%23ifdef%20USE_DISPLACEMENTMAP%5Cn%09transformed%20%2B%3D%20normalize%28%20objectNormal%20%29%20%2A%20%28%20texture2D%28%20displacementMap%2C%20vDisplacementMapUv%20%29.x%20%2A%20displacementScale%20%2B%20displacementBias%20%29%3B%5Cn%23endif%22%3B%0Avar%20emissivemap_fragment%20%3D%20%22%23ifdef%20USE_EMISSIVEMAP%5Cn%09vec4%20emissiveColor%20%3D%20texture2D%28%20emissiveMap%2C%20vEmissiveMapUv%20%29%3B%5Cn%09%23ifdef%20DECODE_VIDEO_TEXTURE_EMISSIVE%5Cn%09%09emissiveColor%20%3D%20sRGBTransferEOTF%28%20emissiveColor%20%29%3B%5Cn%09%23endif%5Cn%09totalEmissiveRadiance%20%2A%3D%20emissiveColor.rgb%3B%5Cn%23endif%22%3B%0Avar%20emissivemap_pars_fragment%20%3D%20%22%23ifdef%20USE_EMISSIVEMAP%5Cn%09uniform%20sampler2D%20emissiveMap%3B%5Cn%23endif%22%3B%0Avar%20colorspace_fragment%20%3D%20%22gl_FragColor%20%3D%20linearToOutputTexel%28%20gl_FragColor%20%29%3B%22%3B%0Avar%20colorspace_pars_fragment%20%3D%20%22vec4%20LinearTransferOETF%28%20in%20vec4%20value%20%29%20%7B%5Cn%09return%20value%3B%5Cn%7D%5Cnvec4%20sRGBTransferEOTF%28%20in%20vec4%20value%20%29%20%7B%5Cn%09return%20vec4%28%20mix%28%20pow%28%20value.rgb%20%2A%200.9478672986%20%2B%20vec3%28%200.0521327014%20%29%2C%20vec3%28%202.4%20%29%20%29%2C%20value.rgb%20%2A%200.0773993808%2C%20vec3%28%20lessThanEqual%28%20value.rgb%2C%20vec3%28%200.04045%20%29%20%29%20%29%20%29%2C%20value.a%20%29%3B%5Cn%7D%5Cnvec4%20sRGBTransferOETF%28%20in%20vec4%20value%20%29%20%7B%5Cn%09return%20vec4%28%20mix%28%20pow%28%20value.rgb%2C%20vec3%28%200.41666%20%29%20%29%20%2A%201.055%20-%20vec3%28%200.055%20%29%2C%20value.rgb%20%2A%2012.92%2C%20vec3%28%20lessThanEqual%28%20value.rgb%2C%20vec3%28%200.0031308%20%29%20%29%20%29%20%29%2C%20value.a%20%29%3B%5Cn%7D%22%3B%0Avar%20envmap_fragment%20%3D%20%22%23ifdef%20USE_ENVMAP%5Cn%09%23ifdef%20ENV_WORLDPOS%5Cn%09%09vec3%20cameraToFrag%3B%5Cn%09%09if%20%28%20isOrthographic%20%29%20%7B%5Cn%09%09%09cameraToFrag%20%3D%20normalize%28%20vec3%28%20-%20viewMatrix%5B%200%20%5D%5B%202%20%5D%2C%20-%20viewMatrix%5B%201%20%5D%5B%202%20%5D%2C%20-%20viewMatrix%5B%202%20%5D%5B%202%20%5D%20%29%20%29%3B%5Cn%09%09%7D%20else%20%7B%5Cn%09%09%09cameraToFrag%20%3D%20normalize%28%20vWorldPosition%20-%20cameraPosition%20%29%3B%5Cn%09%09%7D%5Cn%09%09vec3%20worldNormal%20%3D%20inverseTransformDirection%28%20normal%2C%20viewMatrix%20%29%3B%5Cn%09%09%23ifdef%20ENVMAP_MODE_REFLECTION%5Cn%09%09%09vec3%20reflectVec%20%3D%20reflect%28%20cameraToFrag%2C%20worldNormal%20%29%3B%5Cn%09%09%23else%5Cn%09%09%09vec3%20reflectVec%20%3D%20refract%28%20cameraToFrag%2C%20worldNormal%2C%20refractionRatio%20%29%3B%5Cn%09%09%23endif%5Cn%09%23else%5Cn%09%09vec3%20reflectVec%20%3D%20vReflect%3B%5Cn%09%23endif%5Cn%09%23ifdef%20ENVMAP_TYPE_CUBE%5Cn%09%09vec4%20envColor%20%3D%20textureCube%28%20envMap%2C%20envMapRotation%20%2A%20vec3%28%20flipEnvMap%20%2A%20reflectVec.x%2C%20reflectVec.yz%20%29%20%29%3B%5Cn%09%23else%5Cn%09%09vec4%20envColor%20%3D%20vec4%28%200.0%20%29%3B%5Cn%09%23endif%5Cn%09%23ifdef%20ENVMAP_BLENDING_MULTIPLY%5Cn%09%09outgoingLight%20%3D%20mix%28%20outgoingLight%2C%20outgoingLight%20%2A%20envColor.xyz%2C%20specularStrength%20%2A%20reflectivity%20%29%3B%5Cn%09%23elif%20defined%28%20ENVMAP_BLENDING_MIX%20%29%5Cn%09%09outgoingLight%20%3D%20mix%28%20outgoingLight%2C%20envColor.xyz%2C%20specularStrength%20%2A%20reflectivity%20%29%3B%5Cn%09%23elif%20defined%28%20ENVMAP_BLENDING_ADD%20%29%5Cn%09%09outgoingLight%20%2B%3D%20envColor.xyz%20%2A%20specularStrength%20%2A%20reflectivity%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20envmap_common_pars_fragment%20%3D%20%22%23ifdef%20USE_ENVMAP%5Cn%09uniform%20float%20envMapIntensity%3B%5Cn%09uniform%20float%20flipEnvMap%3B%5Cn%09uniform%20mat3%20envMapRotation%3B%5Cn%09%23ifdef%20ENVMAP_TYPE_CUBE%5Cn%09%09uniform%20samplerCube%20envMap%3B%5Cn%09%23else%5Cn%09%09uniform%20sampler2D%20envMap%3B%5Cn%09%23endif%5Cn%09%5Cn%23endif%22%3B%0Avar%20envmap_pars_fragment%20%3D%20%22%23ifdef%20USE_ENVMAP%5Cn%09uniform%20float%20reflectivity%3B%5Cn%09%23if%20defined%28%20USE_BUMPMAP%20%29%20%7C%7C%20defined%28%20USE_NORMALMAP%20%29%20%7C%7C%20defined%28%20PHONG%20%29%20%7C%7C%20defined%28%20LAMBERT%20%29%5Cn%09%09%23define%20ENV_WORLDPOS%5Cn%09%23endif%5Cn%09%23ifdef%20ENV_WORLDPOS%5Cn%09%09varying%20vec3%20vWorldPosition%3B%5Cn%09%09uniform%20float%20refractionRatio%3B%5Cn%09%23else%5Cn%09%09varying%20vec3%20vReflect%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20envmap_pars_vertex%20%3D%20%22%23ifdef%20USE_ENVMAP%5Cn%09%23if%20defined%28%20USE_BUMPMAP%20%29%20%7C%7C%20defined%28%20USE_NORMALMAP%20%29%20%7C%7C%20defined%28%20PHONG%20%29%20%7C%7C%20defined%28%20LAMBERT%20%29%5Cn%09%09%23define%20ENV_WORLDPOS%5Cn%09%23endif%5Cn%09%23ifdef%20ENV_WORLDPOS%5Cn%09%09%5Cn%09%09varying%20vec3%20vWorldPosition%3B%5Cn%09%23else%5Cn%09%09varying%20vec3%20vReflect%3B%5Cn%09%09uniform%20float%20refractionRatio%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20envmap_vertex%20%3D%20%22%23ifdef%20USE_ENVMAP%5Cn%09%23ifdef%20ENV_WORLDPOS%5Cn%09%09vWorldPosition%20%3D%20worldPosition.xyz%3B%5Cn%09%23else%5Cn%09%09vec3%20cameraToVertex%3B%5Cn%09%09if%20%28%20isOrthographic%20%29%20%7B%5Cn%09%09%09cameraToVertex%20%3D%20normalize%28%20vec3%28%20-%20viewMatrix%5B%200%20%5D%5B%202%20%5D%2C%20-%20viewMatrix%5B%201%20%5D%5B%202%20%5D%2C%20-%20viewMatrix%5B%202%20%5D%5B%202%20%5D%20%29%20%29%3B%5Cn%09%09%7D%20else%20%7B%5Cn%09%09%09cameraToVertex%20%3D%20normalize%28%20worldPosition.xyz%20-%20cameraPosition%20%29%3B%5Cn%09%09%7D%5Cn%09%09vec3%20worldNormal%20%3D%20inverseTransformDirection%28%20transformedNormal%2C%20viewMatrix%20%29%3B%5Cn%09%09%23ifdef%20ENVMAP_MODE_REFLECTION%5Cn%09%09%09vReflect%20%3D%20reflect%28%20cameraToVertex%2C%20worldNormal%20%29%3B%5Cn%09%09%23else%5Cn%09%09%09vReflect%20%3D%20refract%28%20cameraToVertex%2C%20worldNormal%2C%20refractionRatio%20%29%3B%5Cn%09%09%23endif%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20fog_vertex%20%3D%20%22%23ifdef%20USE_FOG%5Cn%09vFogDepth%20%3D%20-%20mvPosition.z%3B%5Cn%23endif%22%3B%0Avar%20fog_pars_vertex%20%3D%20%22%23ifdef%20USE_FOG%5Cn%09varying%20float%20vFogDepth%3B%5Cn%23endif%22%3B%0Avar%20fog_fragment%20%3D%20%22%23ifdef%20USE_FOG%5Cn%09%23ifdef%20FOG_EXP2%5Cn%09%09float%20fogFactor%20%3D%201.0%20-%20exp%28%20-%20fogDensity%20%2A%20fogDensity%20%2A%20vFogDepth%20%2A%20vFogDepth%20%29%3B%5Cn%09%23else%5Cn%09%09float%20fogFactor%20%3D%20smoothstep%28%20fogNear%2C%20fogFar%2C%20vFogDepth%20%29%3B%5Cn%09%23endif%5Cn%09gl_FragColor.rgb%20%3D%20mix%28%20gl_FragColor.rgb%2C%20fogColor%2C%20fogFactor%20%29%3B%5Cn%23endif%22%3B%0Avar%20fog_pars_fragment%20%3D%20%22%23ifdef%20USE_FOG%5Cn%09uniform%20vec3%20fogColor%3B%5Cn%09varying%20float%20vFogDepth%3B%5Cn%09%23ifdef%20FOG_EXP2%5Cn%09%09uniform%20float%20fogDensity%3B%5Cn%09%23else%5Cn%09%09uniform%20float%20fogNear%3B%5Cn%09%09uniform%20float%20fogFar%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20gradientmap_pars_fragment%20%3D%20%22%23ifdef%20USE_GRADIENTMAP%5Cn%09uniform%20sampler2D%20gradientMap%3B%5Cn%23endif%5Cnvec3%20getGradientIrradiance%28%20vec3%20normal%2C%20vec3%20lightDirection%20%29%20%7B%5Cn%09float%20dotNL%20%3D%20dot%28%20normal%2C%20lightDirection%20%29%3B%5Cn%09vec2%20coord%20%3D%20vec2%28%20dotNL%20%2A%200.5%20%2B%200.5%2C%200.0%20%29%3B%5Cn%09%23ifdef%20USE_GRADIENTMAP%5Cn%09%09return%20vec3%28%20texture2D%28%20gradientMap%2C%20coord%20%29.r%20%29%3B%5Cn%09%23else%5Cn%09%09vec2%20fw%20%3D%20fwidth%28%20coord%20%29%20%2A%200.5%3B%5Cn%09%09return%20mix%28%20vec3%28%200.7%20%29%2C%20vec3%28%201.0%20%29%2C%20smoothstep%28%200.7%20-%20fw.x%2C%200.7%20%2B%20fw.x%2C%20coord.x%20%29%20%29%3B%5Cn%09%23endif%5Cn%7D%22%3B%0Avar%20lightmap_pars_fragment%20%3D%20%22%23ifdef%20USE_LIGHTMAP%5Cn%09uniform%20sampler2D%20lightMap%3B%5Cn%09uniform%20float%20lightMapIntensity%3B%5Cn%23endif%22%3B%0Avar%20lights_lambert_fragment%20%3D%20%22LambertMaterial%20material%3B%5Cnmaterial.diffuseColor%20%3D%20diffuseColor.rgb%3B%5Cnmaterial.specularStrength%20%3D%20specularStrength%3B%22%3B%0Avar%20lights_lambert_pars_fragment%20%3D%20%22varying%20vec3%20vViewPosition%3B%5Cnstruct%20LambertMaterial%20%7B%5Cn%09vec3%20diffuseColor%3B%5Cn%09float%20specularStrength%3B%5Cn%7D%3B%5Cnvoid%20RE_Direct_Lambert%28%20const%20in%20IncidentLight%20directLight%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20LambertMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%20%29%20%7B%5Cn%09float%20dotNL%20%3D%20saturate%28%20dot%28%20geometryNormal%2C%20directLight.direction%20%29%20%29%3B%5Cn%09vec3%20irradiance%20%3D%20dotNL%20%2A%20directLight.color%3B%5Cn%09reflectedLight.directDiffuse%20%2B%3D%20irradiance%20%2A%20BRDF_Lambert%28%20material.diffuseColor%20%29%3B%5Cn%7D%5Cnvoid%20RE_IndirectDiffuse_Lambert%28%20const%20in%20vec3%20irradiance%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20LambertMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%20%29%20%7B%5Cn%09reflectedLight.indirectDiffuse%20%2B%3D%20irradiance%20%2A%20BRDF_Lambert%28%20material.diffuseColor%20%29%3B%5Cn%7D%5Cn%23define%20RE_Direct%09%09%09%09RE_Direct_Lambert%5Cn%23define%20RE_IndirectDiffuse%09%09RE_IndirectDiffuse_Lambert%22%3B%0Avar%20lights_pars_begin%20%3D%20%22uniform%20bool%20receiveShadow%3B%5Cnuniform%20vec3%20ambientLightColor%3B%5Cn%23if%20defined%28%20USE_LIGHT_PROBES%20%29%5Cn%09uniform%20vec3%20lightProbe%5B%209%20%5D%3B%5Cn%23endif%5Cnvec3%20shGetIrradianceAt%28%20in%20vec3%20normal%2C%20in%20vec3%20shCoefficients%5B%209%20%5D%20%29%20%7B%5Cn%09float%20x%20%3D%20normal.x%2C%20y%20%3D%20normal.y%2C%20z%20%3D%20normal.z%3B%5Cn%09vec3%20result%20%3D%20shCoefficients%5B%200%20%5D%20%2A%200.886227%3B%5Cn%09result%20%2B%3D%20shCoefficients%5B%201%20%5D%20%2A%202.0%20%2A%200.511664%20%2A%20y%3B%5Cn%09result%20%2B%3D%20shCoefficients%5B%202%20%5D%20%2A%202.0%20%2A%200.511664%20%2A%20z%3B%5Cn%09result%20%2B%3D%20shCoefficients%5B%203%20%5D%20%2A%202.0%20%2A%200.511664%20%2A%20x%3B%5Cn%09result%20%2B%3D%20shCoefficients%5B%204%20%5D%20%2A%202.0%20%2A%200.429043%20%2A%20x%20%2A%20y%3B%5Cn%09result%20%2B%3D%20shCoefficients%5B%205%20%5D%20%2A%202.0%20%2A%200.429043%20%2A%20y%20%2A%20z%3B%5Cn%09result%20%2B%3D%20shCoefficients%5B%206%20%5D%20%2A%20%28%200.743125%20%2A%20z%20%2A%20z%20-%200.247708%20%29%3B%5Cn%09result%20%2B%3D%20shCoefficients%5B%207%20%5D%20%2A%202.0%20%2A%200.429043%20%2A%20x%20%2A%20z%3B%5Cn%09result%20%2B%3D%20shCoefficients%5B%208%20%5D%20%2A%200.429043%20%2A%20%28%20x%20%2A%20x%20-%20y%20%2A%20y%20%29%3B%5Cn%09return%20result%3B%5Cn%7D%5Cnvec3%20getLightProbeIrradiance%28%20const%20in%20vec3%20lightProbe%5B%209%20%5D%2C%20const%20in%20vec3%20normal%20%29%20%7B%5Cn%09vec3%20worldNormal%20%3D%20inverseTransformDirection%28%20normal%2C%20viewMatrix%20%29%3B%5Cn%09vec3%20irradiance%20%3D%20shGetIrradianceAt%28%20worldNormal%2C%20lightProbe%20%29%3B%5Cn%09return%20irradiance%3B%5Cn%7D%5Cnvec3%20getAmbientLightIrradiance%28%20const%20in%20vec3%20ambientLightColor%20%29%20%7B%5Cn%09vec3%20irradiance%20%3D%20ambientLightColor%3B%5Cn%09return%20irradiance%3B%5Cn%7D%5Cnfloat%20getDistanceAttenuation%28%20const%20in%20float%20lightDistance%2C%20const%20in%20float%20cutoffDistance%2C%20const%20in%20float%20decayExponent%20%29%20%7B%5Cn%09float%20distanceFalloff%20%3D%201.0%20%2F%20max%28%20pow%28%20lightDistance%2C%20decayExponent%20%29%2C%200.01%20%29%3B%5Cn%09if%20%28%20cutoffDistance%20%3E%200.0%20%29%20%7B%5Cn%09%09distanceFalloff%20%2A%3D%20pow2%28%20saturate%28%201.0%20-%20pow4%28%20lightDistance%20%2F%20cutoffDistance%20%29%20%29%20%29%3B%5Cn%09%7D%5Cn%09return%20distanceFalloff%3B%5Cn%7D%5Cnfloat%20getSpotAttenuation%28%20const%20in%20float%20coneCosine%2C%20const%20in%20float%20penumbraCosine%2C%20const%20in%20float%20angleCosine%20%29%20%7B%5Cn%09return%20smoothstep%28%20coneCosine%2C%20penumbraCosine%2C%20angleCosine%20%29%3B%5Cn%7D%5Cn%23if%20NUM_DIR_LIGHTS%20%3E%200%5Cn%09struct%20DirectionalLight%20%7B%5Cn%09%09vec3%20direction%3B%5Cn%09%09vec3%20color%3B%5Cn%09%7D%3B%5Cn%09uniform%20DirectionalLight%20directionalLights%5B%20NUM_DIR_LIGHTS%20%5D%3B%5Cn%09void%20getDirectionalLightInfo%28%20const%20in%20DirectionalLight%20directionalLight%2C%20out%20IncidentLight%20light%20%29%20%7B%5Cn%09%09light.color%20%3D%20directionalLight.color%3B%5Cn%09%09light.direction%20%3D%20directionalLight.direction%3B%5Cn%09%09light.visible%20%3D%20true%3B%5Cn%09%7D%5Cn%23endif%5Cn%23if%20NUM_POINT_LIGHTS%20%3E%200%5Cn%09struct%20PointLight%20%7B%5Cn%09%09vec3%20position%3B%5Cn%09%09vec3%20color%3B%5Cn%09%09float%20distance%3B%5Cn%09%09float%20decay%3B%5Cn%09%7D%3B%5Cn%09uniform%20PointLight%20pointLights%5B%20NUM_POINT_LIGHTS%20%5D%3B%5Cn%09void%20getPointLightInfo%28%20const%20in%20PointLight%20pointLight%2C%20const%20in%20vec3%20geometryPosition%2C%20out%20IncidentLight%20light%20%29%20%7B%5Cn%09%09vec3%20lVector%20%3D%20pointLight.position%20-%20geometryPosition%3B%5Cn%09%09light.direction%20%3D%20normalize%28%20lVector%20%29%3B%5Cn%09%09float%20lightDistance%20%3D%20length%28%20lVector%20%29%3B%5Cn%09%09light.color%20%3D%20pointLight.color%3B%5Cn%09%09light.color%20%2A%3D%20getDistanceAttenuation%28%20lightDistance%2C%20pointLight.distance%2C%20pointLight.decay%20%29%3B%5Cn%09%09light.visible%20%3D%20%28%20light.color%20%21%3D%20vec3%28%200.0%20%29%20%29%3B%5Cn%09%7D%5Cn%23endif%5Cn%23if%20NUM_SPOT_LIGHTS%20%3E%200%5Cn%09struct%20SpotLight%20%7B%5Cn%09%09vec3%20position%3B%5Cn%09%09vec3%20direction%3B%5Cn%09%09vec3%20color%3B%5Cn%09%09float%20distance%3B%5Cn%09%09float%20decay%3B%5Cn%09%09float%20coneCos%3B%5Cn%09%09float%20penumbraCos%3B%5Cn%09%7D%3B%5Cn%09uniform%20SpotLight%20spotLights%5B%20NUM_SPOT_LIGHTS%20%5D%3B%5Cn%09void%20getSpotLightInfo%28%20const%20in%20SpotLight%20spotLight%2C%20const%20in%20vec3%20geometryPosition%2C%20out%20IncidentLight%20light%20%29%20%7B%5Cn%09%09vec3%20lVector%20%3D%20spotLight.position%20-%20geometryPosition%3B%5Cn%09%09light.direction%20%3D%20normalize%28%20lVector%20%29%3B%5Cn%09%09float%20angleCos%20%3D%20dot%28%20light.direction%2C%20spotLight.direction%20%29%3B%5Cn%09%09float%20spotAttenuation%20%3D%20getSpotAttenuation%28%20spotLight.coneCos%2C%20spotLight.penumbraCos%2C%20angleCos%20%29%3B%5Cn%09%09if%20%28%20spotAttenuation%20%3E%200.0%20%29%20%7B%5Cn%09%09%09float%20lightDistance%20%3D%20length%28%20lVector%20%29%3B%5Cn%09%09%09light.color%20%3D%20spotLight.color%20%2A%20spotAttenuation%3B%5Cn%09%09%09light.color%20%2A%3D%20getDistanceAttenuation%28%20lightDistance%2C%20spotLight.distance%2C%20spotLight.decay%20%29%3B%5Cn%09%09%09light.visible%20%3D%20%28%20light.color%20%21%3D%20vec3%28%200.0%20%29%20%29%3B%5Cn%09%09%7D%20else%20%7B%5Cn%09%09%09light.color%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09%09%09light.visible%20%3D%20false%3B%5Cn%09%09%7D%5Cn%09%7D%5Cn%23endif%5Cn%23if%20NUM_RECT_AREA_LIGHTS%20%3E%200%5Cn%09struct%20RectAreaLight%20%7B%5Cn%09%09vec3%20color%3B%5Cn%09%09vec3%20position%3B%5Cn%09%09vec3%20halfWidth%3B%5Cn%09%09vec3%20halfHeight%3B%5Cn%09%7D%3B%5Cn%09uniform%20sampler2D%20ltc_1%3B%09uniform%20sampler2D%20ltc_2%3B%5Cn%09uniform%20RectAreaLight%20rectAreaLights%5B%20NUM_RECT_AREA_LIGHTS%20%5D%3B%5Cn%23endif%5Cn%23if%20NUM_HEMI_LIGHTS%20%3E%200%5Cn%09struct%20HemisphereLight%20%7B%5Cn%09%09vec3%20direction%3B%5Cn%09%09vec3%20skyColor%3B%5Cn%09%09vec3%20groundColor%3B%5Cn%09%7D%3B%5Cn%09uniform%20HemisphereLight%20hemisphereLights%5B%20NUM_HEMI_LIGHTS%20%5D%3B%5Cn%09vec3%20getHemisphereLightIrradiance%28%20const%20in%20HemisphereLight%20hemiLight%2C%20const%20in%20vec3%20normal%20%29%20%7B%5Cn%09%09float%20dotNL%20%3D%20dot%28%20normal%2C%20hemiLight.direction%20%29%3B%5Cn%09%09float%20hemiDiffuseWeight%20%3D%200.5%20%2A%20dotNL%20%2B%200.5%3B%5Cn%09%09vec3%20irradiance%20%3D%20mix%28%20hemiLight.groundColor%2C%20hemiLight.skyColor%2C%20hemiDiffuseWeight%20%29%3B%5Cn%09%09return%20irradiance%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20envmap_physical_pars_fragment%20%3D%20%22%23ifdef%20USE_ENVMAP%5Cn%09vec3%20getIBLIrradiance%28%20const%20in%20vec3%20normal%20%29%20%7B%5Cn%09%09%23ifdef%20ENVMAP_TYPE_CUBE_UV%5Cn%09%09%09vec3%20worldNormal%20%3D%20inverseTransformDirection%28%20normal%2C%20viewMatrix%20%29%3B%5Cn%09%09%09vec4%20envMapColor%20%3D%20textureCubeUV%28%20envMap%2C%20envMapRotation%20%2A%20worldNormal%2C%201.0%20%29%3B%5Cn%09%09%09return%20PI%20%2A%20envMapColor.rgb%20%2A%20envMapIntensity%3B%5Cn%09%09%23else%5Cn%09%09%09return%20vec3%28%200.0%20%29%3B%5Cn%09%09%23endif%5Cn%09%7D%5Cn%09vec3%20getIBLRadiance%28%20const%20in%20vec3%20viewDir%2C%20const%20in%20vec3%20normal%2C%20const%20in%20float%20roughness%20%29%20%7B%5Cn%09%09%23ifdef%20ENVMAP_TYPE_CUBE_UV%5Cn%09%09%09vec3%20reflectVec%20%3D%20reflect%28%20-%20viewDir%2C%20normal%20%29%3B%5Cn%09%09%09reflectVec%20%3D%20normalize%28%20mix%28%20reflectVec%2C%20normal%2C%20roughness%20%2A%20roughness%29%20%29%3B%5Cn%09%09%09reflectVec%20%3D%20inverseTransformDirection%28%20reflectVec%2C%20viewMatrix%20%29%3B%5Cn%09%09%09vec4%20envMapColor%20%3D%20textureCubeUV%28%20envMap%2C%20envMapRotation%20%2A%20reflectVec%2C%20roughness%20%29%3B%5Cn%09%09%09return%20envMapColor.rgb%20%2A%20envMapIntensity%3B%5Cn%09%09%23else%5Cn%09%09%09return%20vec3%28%200.0%20%29%3B%5Cn%09%09%23endif%5Cn%09%7D%5Cn%09%23ifdef%20USE_ANISOTROPY%5Cn%09%09vec3%20getIBLAnisotropyRadiance%28%20const%20in%20vec3%20viewDir%2C%20const%20in%20vec3%20normal%2C%20const%20in%20float%20roughness%2C%20const%20in%20vec3%20bitangent%2C%20const%20in%20float%20anisotropy%20%29%20%7B%5Cn%09%09%09%23ifdef%20ENVMAP_TYPE_CUBE_UV%5Cn%09%09%09%09vec3%20bentNormal%20%3D%20cross%28%20bitangent%2C%20viewDir%20%29%3B%5Cn%09%09%09%09bentNormal%20%3D%20normalize%28%20cross%28%20bentNormal%2C%20bitangent%20%29%20%29%3B%5Cn%09%09%09%09bentNormal%20%3D%20normalize%28%20mix%28%20bentNormal%2C%20normal%2C%20pow2%28%20pow2%28%201.0%20-%20anisotropy%20%2A%20%28%201.0%20-%20roughness%20%29%20%29%20%29%20%29%20%29%3B%5Cn%09%09%09%09return%20getIBLRadiance%28%20viewDir%2C%20bentNormal%2C%20roughness%20%29%3B%5Cn%09%09%09%23else%5Cn%09%09%09%09return%20vec3%28%200.0%20%29%3B%5Cn%09%09%09%23endif%5Cn%09%09%7D%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20lights_toon_fragment%20%3D%20%22ToonMaterial%20material%3B%5Cnmaterial.diffuseColor%20%3D%20diffuseColor.rgb%3B%22%3B%0Avar%20lights_toon_pars_fragment%20%3D%20%22varying%20vec3%20vViewPosition%3B%5Cnstruct%20ToonMaterial%20%7B%5Cn%09vec3%20diffuseColor%3B%5Cn%7D%3B%5Cnvoid%20RE_Direct_Toon%28%20const%20in%20IncidentLight%20directLight%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20ToonMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%20%29%20%7B%5Cn%09vec3%20irradiance%20%3D%20getGradientIrradiance%28%20geometryNormal%2C%20directLight.direction%20%29%20%2A%20directLight.color%3B%5Cn%09reflectedLight.directDiffuse%20%2B%3D%20irradiance%20%2A%20BRDF_Lambert%28%20material.diffuseColor%20%29%3B%5Cn%7D%5Cnvoid%20RE_IndirectDiffuse_Toon%28%20const%20in%20vec3%20irradiance%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20ToonMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%20%29%20%7B%5Cn%09reflectedLight.indirectDiffuse%20%2B%3D%20irradiance%20%2A%20BRDF_Lambert%28%20material.diffuseColor%20%29%3B%5Cn%7D%5Cn%23define%20RE_Direct%09%09%09%09RE_Direct_Toon%5Cn%23define%20RE_IndirectDiffuse%09%09RE_IndirectDiffuse_Toon%22%3B%0Avar%20lights_phong_fragment%20%3D%20%22BlinnPhongMaterial%20material%3B%5Cnmaterial.diffuseColor%20%3D%20diffuseColor.rgb%3B%5Cnmaterial.specularColor%20%3D%20specular%3B%5Cnmaterial.specularShininess%20%3D%20shininess%3B%5Cnmaterial.specularStrength%20%3D%20specularStrength%3B%22%3B%0Avar%20lights_phong_pars_fragment%20%3D%20%22varying%20vec3%20vViewPosition%3B%5Cnstruct%20BlinnPhongMaterial%20%7B%5Cn%09vec3%20diffuseColor%3B%5Cn%09vec3%20specularColor%3B%5Cn%09float%20specularShininess%3B%5Cn%09float%20specularStrength%3B%5Cn%7D%3B%5Cnvoid%20RE_Direct_BlinnPhong%28%20const%20in%20IncidentLight%20directLight%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20BlinnPhongMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%20%29%20%7B%5Cn%09float%20dotNL%20%3D%20saturate%28%20dot%28%20geometryNormal%2C%20directLight.direction%20%29%20%29%3B%5Cn%09vec3%20irradiance%20%3D%20dotNL%20%2A%20directLight.color%3B%5Cn%09reflectedLight.directDiffuse%20%2B%3D%20irradiance%20%2A%20BRDF_Lambert%28%20material.diffuseColor%20%29%3B%5Cn%09reflectedLight.directSpecular%20%2B%3D%20irradiance%20%2A%20BRDF_BlinnPhong%28%20directLight.direction%2C%20geometryViewDir%2C%20geometryNormal%2C%20material.specularColor%2C%20material.specularShininess%20%29%20%2A%20material.specularStrength%3B%5Cn%7D%5Cnvoid%20RE_IndirectDiffuse_BlinnPhong%28%20const%20in%20vec3%20irradiance%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20BlinnPhongMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%20%29%20%7B%5Cn%09reflectedLight.indirectDiffuse%20%2B%3D%20irradiance%20%2A%20BRDF_Lambert%28%20material.diffuseColor%20%29%3B%5Cn%7D%5Cn%23define%20RE_Direct%09%09%09%09RE_Direct_BlinnPhong%5Cn%23define%20RE_IndirectDiffuse%09%09RE_IndirectDiffuse_BlinnPhong%22%3B%0Avar%20lights_physical_fragment%20%3D%20%22PhysicalMaterial%20material%3B%5Cnmaterial.diffuseColor%20%3D%20diffuseColor.rgb%20%2A%20%28%201.0%20-%20metalnessFactor%20%29%3B%5Cnvec3%20dxy%20%3D%20max%28%20abs%28%20dFdx%28%20nonPerturbedNormal%20%29%20%29%2C%20abs%28%20dFdy%28%20nonPerturbedNormal%20%29%20%29%20%29%3B%5Cnfloat%20geometryRoughness%20%3D%20max%28%20max%28%20dxy.x%2C%20dxy.y%20%29%2C%20dxy.z%20%29%3B%5Cnmaterial.roughness%20%3D%20max%28%20roughnessFactor%2C%200.0525%20%29%3Bmaterial.roughness%20%2B%3D%20geometryRoughness%3B%5Cnmaterial.roughness%20%3D%20min%28%20material.roughness%2C%201.0%20%29%3B%5Cn%23ifdef%20IOR%5Cn%09material.ior%20%3D%20ior%3B%5Cn%09%23ifdef%20USE_SPECULAR%5Cn%09%09float%20specularIntensityFactor%20%3D%20specularIntensity%3B%5Cn%09%09vec3%20specularColorFactor%20%3D%20specularColor%3B%5Cn%09%09%23ifdef%20USE_SPECULAR_COLORMAP%5Cn%09%09%09specularColorFactor%20%2A%3D%20texture2D%28%20specularColorMap%2C%20vSpecularColorMapUv%20%29.rgb%3B%5Cn%09%09%23endif%5Cn%09%09%23ifdef%20USE_SPECULAR_INTENSITYMAP%5Cn%09%09%09specularIntensityFactor%20%2A%3D%20texture2D%28%20specularIntensityMap%2C%20vSpecularIntensityMapUv%20%29.a%3B%5Cn%09%09%23endif%5Cn%09%09material.specularF90%20%3D%20mix%28%20specularIntensityFactor%2C%201.0%2C%20metalnessFactor%20%29%3B%5Cn%09%23else%5Cn%09%09float%20specularIntensityFactor%20%3D%201.0%3B%5Cn%09%09vec3%20specularColorFactor%20%3D%20vec3%28%201.0%20%29%3B%5Cn%09%09material.specularF90%20%3D%201.0%3B%5Cn%09%23endif%5Cn%09material.specularColor%20%3D%20mix%28%20min%28%20pow2%28%20%28%20material.ior%20-%201.0%20%29%20%2F%20%28%20material.ior%20%2B%201.0%20%29%20%29%20%2A%20specularColorFactor%2C%20vec3%28%201.0%20%29%20%29%20%2A%20specularIntensityFactor%2C%20diffuseColor.rgb%2C%20metalnessFactor%20%29%3B%5Cn%23else%5Cn%09material.specularColor%20%3D%20mix%28%20vec3%28%200.04%20%29%2C%20diffuseColor.rgb%2C%20metalnessFactor%20%29%3B%5Cn%09material.specularF90%20%3D%201.0%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT%5Cn%09material.clearcoat%20%3D%20clearcoat%3B%5Cn%09material.clearcoatRoughness%20%3D%20clearcoatRoughness%3B%5Cn%09material.clearcoatF0%20%3D%20vec3%28%200.04%20%29%3B%5Cn%09material.clearcoatF90%20%3D%201.0%3B%5Cn%09%23ifdef%20USE_CLEARCOATMAP%5Cn%09%09material.clearcoat%20%2A%3D%20texture2D%28%20clearcoatMap%2C%20vClearcoatMapUv%20%29.x%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_CLEARCOAT_ROUGHNESSMAP%5Cn%09%09material.clearcoatRoughness%20%2A%3D%20texture2D%28%20clearcoatRoughnessMap%2C%20vClearcoatRoughnessMapUv%20%29.y%3B%5Cn%09%23endif%5Cn%09material.clearcoat%20%3D%20saturate%28%20material.clearcoat%20%29%3B%09material.clearcoatRoughness%20%3D%20max%28%20material.clearcoatRoughness%2C%200.0525%20%29%3B%5Cn%09material.clearcoatRoughness%20%2B%3D%20geometryRoughness%3B%5Cn%09material.clearcoatRoughness%20%3D%20min%28%20material.clearcoatRoughness%2C%201.0%20%29%3B%5Cn%23endif%5Cn%23ifdef%20USE_DISPERSION%5Cn%09material.dispersion%20%3D%20dispersion%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCE%5Cn%09material.iridescence%20%3D%20iridescence%3B%5Cn%09material.iridescenceIOR%20%3D%20iridescenceIOR%3B%5Cn%09%23ifdef%20USE_IRIDESCENCEMAP%5Cn%09%09material.iridescence%20%2A%3D%20texture2D%28%20iridescenceMap%2C%20vIridescenceMapUv%20%29.r%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_IRIDESCENCE_THICKNESSMAP%5Cn%09%09material.iridescenceThickness%20%3D%20%28iridescenceThicknessMaximum%20-%20iridescenceThicknessMinimum%29%20%2A%20texture2D%28%20iridescenceThicknessMap%2C%20vIridescenceThicknessMapUv%20%29.g%20%2B%20iridescenceThicknessMinimum%3B%5Cn%09%23else%5Cn%09%09material.iridescenceThickness%20%3D%20iridescenceThicknessMaximum%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23ifdef%20USE_SHEEN%5Cn%09material.sheenColor%20%3D%20sheenColor%3B%5Cn%09%23ifdef%20USE_SHEEN_COLORMAP%5Cn%09%09material.sheenColor%20%2A%3D%20texture2D%28%20sheenColorMap%2C%20vSheenColorMapUv%20%29.rgb%3B%5Cn%09%23endif%5Cn%09material.sheenRoughness%20%3D%20clamp%28%20sheenRoughness%2C%200.07%2C%201.0%20%29%3B%5Cn%09%23ifdef%20USE_SHEEN_ROUGHNESSMAP%5Cn%09%09material.sheenRoughness%20%2A%3D%20texture2D%28%20sheenRoughnessMap%2C%20vSheenRoughnessMapUv%20%29.a%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23ifdef%20USE_ANISOTROPY%5Cn%09%23ifdef%20USE_ANISOTROPYMAP%5Cn%09%09mat2%20anisotropyMat%20%3D%20mat2%28%20anisotropyVector.x%2C%20anisotropyVector.y%2C%20-%20anisotropyVector.y%2C%20anisotropyVector.x%20%29%3B%5Cn%09%09vec3%20anisotropyPolar%20%3D%20texture2D%28%20anisotropyMap%2C%20vAnisotropyMapUv%20%29.rgb%3B%5Cn%09%09vec2%20anisotropyV%20%3D%20anisotropyMat%20%2A%20normalize%28%202.0%20%2A%20anisotropyPolar.rg%20-%20vec2%28%201.0%20%29%20%29%20%2A%20anisotropyPolar.b%3B%5Cn%09%23else%5Cn%09%09vec2%20anisotropyV%20%3D%20anisotropyVector%3B%5Cn%09%23endif%5Cn%09material.anisotropy%20%3D%20length%28%20anisotropyV%20%29%3B%5Cn%09if%28%20material.anisotropy%20%3D%3D%200.0%20%29%20%7B%5Cn%09%09anisotropyV%20%3D%20vec2%28%201.0%2C%200.0%20%29%3B%5Cn%09%7D%20else%20%7B%5Cn%09%09anisotropyV%20%2F%3D%20material.anisotropy%3B%5Cn%09%09material.anisotropy%20%3D%20saturate%28%20material.anisotropy%20%29%3B%5Cn%09%7D%5Cn%09material.alphaT%20%3D%20mix%28%20pow2%28%20material.roughness%20%29%2C%201.0%2C%20pow2%28%20material.anisotropy%20%29%20%29%3B%5Cn%09material.anisotropyT%20%3D%20tbn%5B%200%20%5D%20%2A%20anisotropyV.x%20%2B%20tbn%5B%201%20%5D%20%2A%20anisotropyV.y%3B%5Cn%09material.anisotropyB%20%3D%20tbn%5B%201%20%5D%20%2A%20anisotropyV.x%20-%20tbn%5B%200%20%5D%20%2A%20anisotropyV.y%3B%5Cn%23endif%22%3B%0Avar%20lights_physical_pars_fragment%20%3D%20%22struct%20PhysicalMaterial%20%7B%5Cn%09vec3%20diffuseColor%3B%5Cn%09float%20roughness%3B%5Cn%09vec3%20specularColor%3B%5Cn%09float%20specularF90%3B%5Cn%09float%20dispersion%3B%5Cn%09%23ifdef%20USE_CLEARCOAT%5Cn%09%09float%20clearcoat%3B%5Cn%09%09float%20clearcoatRoughness%3B%5Cn%09%09vec3%20clearcoatF0%3B%5Cn%09%09float%20clearcoatF90%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_IRIDESCENCE%5Cn%09%09float%20iridescence%3B%5Cn%09%09float%20iridescenceIOR%3B%5Cn%09%09float%20iridescenceThickness%3B%5Cn%09%09vec3%20iridescenceFresnel%3B%5Cn%09%09vec3%20iridescenceF0%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_SHEEN%5Cn%09%09vec3%20sheenColor%3B%5Cn%09%09float%20sheenRoughness%3B%5Cn%09%23endif%5Cn%09%23ifdef%20IOR%5Cn%09%09float%20ior%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_TRANSMISSION%5Cn%09%09float%20transmission%3B%5Cn%09%09float%20transmissionAlpha%3B%5Cn%09%09float%20thickness%3B%5Cn%09%09float%20attenuationDistance%3B%5Cn%09%09vec3%20attenuationColor%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_ANISOTROPY%5Cn%09%09float%20anisotropy%3B%5Cn%09%09float%20alphaT%3B%5Cn%09%09vec3%20anisotropyT%3B%5Cn%09%09vec3%20anisotropyB%3B%5Cn%09%23endif%5Cn%7D%3B%5Cnvec3%20clearcoatSpecularDirect%20%3D%20vec3%28%200.0%20%29%3B%5Cnvec3%20clearcoatSpecularIndirect%20%3D%20vec3%28%200.0%20%29%3B%5Cnvec3%20sheenSpecularDirect%20%3D%20vec3%28%200.0%20%29%3B%5Cnvec3%20sheenSpecularIndirect%20%3D%20vec3%280.0%20%29%3B%5Cnvec3%20Schlick_to_F0%28%20const%20in%20vec3%20f%2C%20const%20in%20float%20f90%2C%20const%20in%20float%20dotVH%20%29%20%7B%5Cn%20%20%20%20float%20x%20%3D%20clamp%28%201.0%20-%20dotVH%2C%200.0%2C%201.0%20%29%3B%5Cn%20%20%20%20float%20x2%20%3D%20x%20%2A%20x%3B%5Cn%20%20%20%20float%20x5%20%3D%20clamp%28%20x%20%2A%20x2%20%2A%20x2%2C%200.0%2C%200.9999%20%29%3B%5Cn%20%20%20%20return%20%28%20f%20-%20vec3%28%20f90%20%29%20%2A%20x5%20%29%20%2F%20%28%201.0%20-%20x5%20%29%3B%5Cn%7D%5Cnfloat%20V_GGX_SmithCorrelated%28%20const%20in%20float%20alpha%2C%20const%20in%20float%20dotNL%2C%20const%20in%20float%20dotNV%20%29%20%7B%5Cn%09float%20a2%20%3D%20pow2%28%20alpha%20%29%3B%5Cn%09float%20gv%20%3D%20dotNL%20%2A%20sqrt%28%20a2%20%2B%20%28%201.0%20-%20a2%20%29%20%2A%20pow2%28%20dotNV%20%29%20%29%3B%5Cn%09float%20gl%20%3D%20dotNV%20%2A%20sqrt%28%20a2%20%2B%20%28%201.0%20-%20a2%20%29%20%2A%20pow2%28%20dotNL%20%29%20%29%3B%5Cn%09return%200.5%20%2F%20max%28%20gv%20%2B%20gl%2C%20EPSILON%20%29%3B%5Cn%7D%5Cnfloat%20D_GGX%28%20const%20in%20float%20alpha%2C%20const%20in%20float%20dotNH%20%29%20%7B%5Cn%09float%20a2%20%3D%20pow2%28%20alpha%20%29%3B%5Cn%09float%20denom%20%3D%20pow2%28%20dotNH%20%29%20%2A%20%28%20a2%20-%201.0%20%29%20%2B%201.0%3B%5Cn%09return%20RECIPROCAL_PI%20%2A%20a2%20%2F%20pow2%28%20denom%20%29%3B%5Cn%7D%5Cn%23ifdef%20USE_ANISOTROPY%5Cn%09float%20V_GGX_SmithCorrelated_Anisotropic%28%20const%20in%20float%20alphaT%2C%20const%20in%20float%20alphaB%2C%20const%20in%20float%20dotTV%2C%20const%20in%20float%20dotBV%2C%20const%20in%20float%20dotTL%2C%20const%20in%20float%20dotBL%2C%20const%20in%20float%20dotNV%2C%20const%20in%20float%20dotNL%20%29%20%7B%5Cn%09%09float%20gv%20%3D%20dotNL%20%2A%20length%28%20vec3%28%20alphaT%20%2A%20dotTV%2C%20alphaB%20%2A%20dotBV%2C%20dotNV%20%29%20%29%3B%5Cn%09%09float%20gl%20%3D%20dotNV%20%2A%20length%28%20vec3%28%20alphaT%20%2A%20dotTL%2C%20alphaB%20%2A%20dotBL%2C%20dotNL%20%29%20%29%3B%5Cn%09%09float%20v%20%3D%200.5%20%2F%20%28%20gv%20%2B%20gl%20%29%3B%5Cn%09%09return%20saturate%28v%29%3B%5Cn%09%7D%5Cn%09float%20D_GGX_Anisotropic%28%20const%20in%20float%20alphaT%2C%20const%20in%20float%20alphaB%2C%20const%20in%20float%20dotNH%2C%20const%20in%20float%20dotTH%2C%20const%20in%20float%20dotBH%20%29%20%7B%5Cn%09%09float%20a2%20%3D%20alphaT%20%2A%20alphaB%3B%5Cn%09%09highp%20vec3%20v%20%3D%20vec3%28%20alphaB%20%2A%20dotTH%2C%20alphaT%20%2A%20dotBH%2C%20a2%20%2A%20dotNH%20%29%3B%5Cn%09%09highp%20float%20v2%20%3D%20dot%28%20v%2C%20v%20%29%3B%5Cn%09%09float%20w2%20%3D%20a2%20%2F%20v2%3B%5Cn%09%09return%20RECIPROCAL_PI%20%2A%20a2%20%2A%20pow2%20%28%20w2%20%29%3B%5Cn%09%7D%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT%5Cn%09vec3%20BRDF_GGX_Clearcoat%28%20const%20in%20vec3%20lightDir%2C%20const%20in%20vec3%20viewDir%2C%20const%20in%20vec3%20normal%2C%20const%20in%20PhysicalMaterial%20material%29%20%7B%5Cn%09%09vec3%20f0%20%3D%20material.clearcoatF0%3B%5Cn%09%09float%20f90%20%3D%20material.clearcoatF90%3B%5Cn%09%09float%20roughness%20%3D%20material.clearcoatRoughness%3B%5Cn%09%09float%20alpha%20%3D%20pow2%28%20roughness%20%29%3B%5Cn%09%09vec3%20halfDir%20%3D%20normalize%28%20lightDir%20%2B%20viewDir%20%29%3B%5Cn%09%09float%20dotNL%20%3D%20saturate%28%20dot%28%20normal%2C%20lightDir%20%29%20%29%3B%5Cn%09%09float%20dotNV%20%3D%20saturate%28%20dot%28%20normal%2C%20viewDir%20%29%20%29%3B%5Cn%09%09float%20dotNH%20%3D%20saturate%28%20dot%28%20normal%2C%20halfDir%20%29%20%29%3B%5Cn%09%09float%20dotVH%20%3D%20saturate%28%20dot%28%20viewDir%2C%20halfDir%20%29%20%29%3B%5Cn%09%09vec3%20F%20%3D%20F_Schlick%28%20f0%2C%20f90%2C%20dotVH%20%29%3B%5Cn%09%09float%20V%20%3D%20V_GGX_SmithCorrelated%28%20alpha%2C%20dotNL%2C%20dotNV%20%29%3B%5Cn%09%09float%20D%20%3D%20D_GGX%28%20alpha%2C%20dotNH%20%29%3B%5Cn%09%09return%20F%20%2A%20%28%20V%20%2A%20D%20%29%3B%5Cn%09%7D%5Cn%23endif%5Cnvec3%20BRDF_GGX%28%20const%20in%20vec3%20lightDir%2C%20const%20in%20vec3%20viewDir%2C%20const%20in%20vec3%20normal%2C%20const%20in%20PhysicalMaterial%20material%20%29%20%7B%5Cn%09vec3%20f0%20%3D%20material.specularColor%3B%5Cn%09float%20f90%20%3D%20material.specularF90%3B%5Cn%09float%20roughness%20%3D%20material.roughness%3B%5Cn%09float%20alpha%20%3D%20pow2%28%20roughness%20%29%3B%5Cn%09vec3%20halfDir%20%3D%20normalize%28%20lightDir%20%2B%20viewDir%20%29%3B%5Cn%09float%20dotNL%20%3D%20saturate%28%20dot%28%20normal%2C%20lightDir%20%29%20%29%3B%5Cn%09float%20dotNV%20%3D%20saturate%28%20dot%28%20normal%2C%20viewDir%20%29%20%29%3B%5Cn%09float%20dotNH%20%3D%20saturate%28%20dot%28%20normal%2C%20halfDir%20%29%20%29%3B%5Cn%09float%20dotVH%20%3D%20saturate%28%20dot%28%20viewDir%2C%20halfDir%20%29%20%29%3B%5Cn%09vec3%20F%20%3D%20F_Schlick%28%20f0%2C%20f90%2C%20dotVH%20%29%3B%5Cn%09%23ifdef%20USE_IRIDESCENCE%5Cn%09%09F%20%3D%20mix%28%20F%2C%20material.iridescenceFresnel%2C%20material.iridescence%20%29%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_ANISOTROPY%5Cn%09%09float%20dotTL%20%3D%20dot%28%20material.anisotropyT%2C%20lightDir%20%29%3B%5Cn%09%09float%20dotTV%20%3D%20dot%28%20material.anisotropyT%2C%20viewDir%20%29%3B%5Cn%09%09float%20dotTH%20%3D%20dot%28%20material.anisotropyT%2C%20halfDir%20%29%3B%5Cn%09%09float%20dotBL%20%3D%20dot%28%20material.anisotropyB%2C%20lightDir%20%29%3B%5Cn%09%09float%20dotBV%20%3D%20dot%28%20material.anisotropyB%2C%20viewDir%20%29%3B%5Cn%09%09float%20dotBH%20%3D%20dot%28%20material.anisotropyB%2C%20halfDir%20%29%3B%5Cn%09%09float%20V%20%3D%20V_GGX_SmithCorrelated_Anisotropic%28%20material.alphaT%2C%20alpha%2C%20dotTV%2C%20dotBV%2C%20dotTL%2C%20dotBL%2C%20dotNV%2C%20dotNL%20%29%3B%5Cn%09%09float%20D%20%3D%20D_GGX_Anisotropic%28%20material.alphaT%2C%20alpha%2C%20dotNH%2C%20dotTH%2C%20dotBH%20%29%3B%5Cn%09%23else%5Cn%09%09float%20V%20%3D%20V_GGX_SmithCorrelated%28%20alpha%2C%20dotNL%2C%20dotNV%20%29%3B%5Cn%09%09float%20D%20%3D%20D_GGX%28%20alpha%2C%20dotNH%20%29%3B%5Cn%09%23endif%5Cn%09return%20F%20%2A%20%28%20V%20%2A%20D%20%29%3B%5Cn%7D%5Cnvec2%20LTC_Uv%28%20const%20in%20vec3%20N%2C%20const%20in%20vec3%20V%2C%20const%20in%20float%20roughness%20%29%20%7B%5Cn%09const%20float%20LUT_SIZE%20%3D%2064.0%3B%5Cn%09const%20float%20LUT_SCALE%20%3D%20%28%20LUT_SIZE%20-%201.0%20%29%20%2F%20LUT_SIZE%3B%5Cn%09const%20float%20LUT_BIAS%20%3D%200.5%20%2F%20LUT_SIZE%3B%5Cn%09float%20dotNV%20%3D%20saturate%28%20dot%28%20N%2C%20V%20%29%20%29%3B%5Cn%09vec2%20uv%20%3D%20vec2%28%20roughness%2C%20sqrt%28%201.0%20-%20dotNV%20%29%20%29%3B%5Cn%09uv%20%3D%20uv%20%2A%20LUT_SCALE%20%2B%20LUT_BIAS%3B%5Cn%09return%20uv%3B%5Cn%7D%5Cnfloat%20LTC_ClippedSphereFormFactor%28%20const%20in%20vec3%20f%20%29%20%7B%5Cn%09float%20l%20%3D%20length%28%20f%20%29%3B%5Cn%09return%20max%28%20%28%20l%20%2A%20l%20%2B%20f.z%20%29%20%2F%20%28%20l%20%2B%201.0%20%29%2C%200.0%20%29%3B%5Cn%7D%5Cnvec3%20LTC_EdgeVectorFormFactor%28%20const%20in%20vec3%20v1%2C%20const%20in%20vec3%20v2%20%29%20%7B%5Cn%09float%20x%20%3D%20dot%28%20v1%2C%20v2%20%29%3B%5Cn%09float%20y%20%3D%20abs%28%20x%20%29%3B%5Cn%09float%20a%20%3D%200.8543985%20%2B%20%28%200.4965155%20%2B%200.0145206%20%2A%20y%20%29%20%2A%20y%3B%5Cn%09float%20b%20%3D%203.4175940%20%2B%20%28%204.1616724%20%2B%20y%20%29%20%2A%20y%3B%5Cn%09float%20v%20%3D%20a%20%2F%20b%3B%5Cn%09float%20theta_sintheta%20%3D%20%28%20x%20%3E%200.0%20%29%20%3F%20v%20%3A%200.5%20%2A%20inversesqrt%28%20max%28%201.0%20-%20x%20%2A%20x%2C%201e-7%20%29%20%29%20-%20v%3B%5Cn%09return%20cross%28%20v1%2C%20v2%20%29%20%2A%20theta_sintheta%3B%5Cn%7D%5Cnvec3%20LTC_Evaluate%28%20const%20in%20vec3%20N%2C%20const%20in%20vec3%20V%2C%20const%20in%20vec3%20P%2C%20const%20in%20mat3%20mInv%2C%20const%20in%20vec3%20rectCoords%5B%204%20%5D%20%29%20%7B%5Cn%09vec3%20v1%20%3D%20rectCoords%5B%201%20%5D%20-%20rectCoords%5B%200%20%5D%3B%5Cn%09vec3%20v2%20%3D%20rectCoords%5B%203%20%5D%20-%20rectCoords%5B%200%20%5D%3B%5Cn%09vec3%20lightNormal%20%3D%20cross%28%20v1%2C%20v2%20%29%3B%5Cn%09if%28%20dot%28%20lightNormal%2C%20P%20-%20rectCoords%5B%200%20%5D%20%29%20%3C%200.0%20%29%20return%20vec3%28%200.0%20%29%3B%5Cn%09vec3%20T1%2C%20T2%3B%5Cn%09T1%20%3D%20normalize%28%20V%20-%20N%20%2A%20dot%28%20V%2C%20N%20%29%20%29%3B%5Cn%09T2%20%3D%20-%20cross%28%20N%2C%20T1%20%29%3B%5Cn%09mat3%20mat%20%3D%20mInv%20%2A%20transposeMat3%28%20mat3%28%20T1%2C%20T2%2C%20N%20%29%20%29%3B%5Cn%09vec3%20coords%5B%204%20%5D%3B%5Cn%09coords%5B%200%20%5D%20%3D%20mat%20%2A%20%28%20rectCoords%5B%200%20%5D%20-%20P%20%29%3B%5Cn%09coords%5B%201%20%5D%20%3D%20mat%20%2A%20%28%20rectCoords%5B%201%20%5D%20-%20P%20%29%3B%5Cn%09coords%5B%202%20%5D%20%3D%20mat%20%2A%20%28%20rectCoords%5B%202%20%5D%20-%20P%20%29%3B%5Cn%09coords%5B%203%20%5D%20%3D%20mat%20%2A%20%28%20rectCoords%5B%203%20%5D%20-%20P%20%29%3B%5Cn%09coords%5B%200%20%5D%20%3D%20normalize%28%20coords%5B%200%20%5D%20%29%3B%5Cn%09coords%5B%201%20%5D%20%3D%20normalize%28%20coords%5B%201%20%5D%20%29%3B%5Cn%09coords%5B%202%20%5D%20%3D%20normalize%28%20coords%5B%202%20%5D%20%29%3B%5Cn%09coords%5B%203%20%5D%20%3D%20normalize%28%20coords%5B%203%20%5D%20%29%3B%5Cn%09vec3%20vectorFormFactor%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09vectorFormFactor%20%2B%3D%20LTC_EdgeVectorFormFactor%28%20coords%5B%200%20%5D%2C%20coords%5B%201%20%5D%20%29%3B%5Cn%09vectorFormFactor%20%2B%3D%20LTC_EdgeVectorFormFactor%28%20coords%5B%201%20%5D%2C%20coords%5B%202%20%5D%20%29%3B%5Cn%09vectorFormFactor%20%2B%3D%20LTC_EdgeVectorFormFactor%28%20coords%5B%202%20%5D%2C%20coords%5B%203%20%5D%20%29%3B%5Cn%09vectorFormFactor%20%2B%3D%20LTC_EdgeVectorFormFactor%28%20coords%5B%203%20%5D%2C%20coords%5B%200%20%5D%20%29%3B%5Cn%09float%20result%20%3D%20LTC_ClippedSphereFormFactor%28%20vectorFormFactor%20%29%3B%5Cn%09return%20vec3%28%20result%20%29%3B%5Cn%7D%5Cn%23if%20defined%28%20USE_SHEEN%20%29%5Cnfloat%20D_Charlie%28%20float%20roughness%2C%20float%20dotNH%20%29%20%7B%5Cn%09float%20alpha%20%3D%20pow2%28%20roughness%20%29%3B%5Cn%09float%20invAlpha%20%3D%201.0%20%2F%20alpha%3B%5Cn%09float%20cos2h%20%3D%20dotNH%20%2A%20dotNH%3B%5Cn%09float%20sin2h%20%3D%20max%28%201.0%20-%20cos2h%2C%200.0078125%20%29%3B%5Cn%09return%20%28%202.0%20%2B%20invAlpha%20%29%20%2A%20pow%28%20sin2h%2C%20invAlpha%20%2A%200.5%20%29%20%2F%20%28%202.0%20%2A%20PI%20%29%3B%5Cn%7D%5Cnfloat%20V_Neubelt%28%20float%20dotNV%2C%20float%20dotNL%20%29%20%7B%5Cn%09return%20saturate%28%201.0%20%2F%20%28%204.0%20%2A%20%28%20dotNL%20%2B%20dotNV%20-%20dotNL%20%2A%20dotNV%20%29%20%29%20%29%3B%5Cn%7D%5Cnvec3%20BRDF_Sheen%28%20const%20in%20vec3%20lightDir%2C%20const%20in%20vec3%20viewDir%2C%20const%20in%20vec3%20normal%2C%20vec3%20sheenColor%2C%20const%20in%20float%20sheenRoughness%20%29%20%7B%5Cn%09vec3%20halfDir%20%3D%20normalize%28%20lightDir%20%2B%20viewDir%20%29%3B%5Cn%09float%20dotNL%20%3D%20saturate%28%20dot%28%20normal%2C%20lightDir%20%29%20%29%3B%5Cn%09float%20dotNV%20%3D%20saturate%28%20dot%28%20normal%2C%20viewDir%20%29%20%29%3B%5Cn%09float%20dotNH%20%3D%20saturate%28%20dot%28%20normal%2C%20halfDir%20%29%20%29%3B%5Cn%09float%20D%20%3D%20D_Charlie%28%20sheenRoughness%2C%20dotNH%20%29%3B%5Cn%09float%20V%20%3D%20V_Neubelt%28%20dotNV%2C%20dotNL%20%29%3B%5Cn%09return%20sheenColor%20%2A%20%28%20D%20%2A%20V%20%29%3B%5Cn%7D%5Cn%23endif%5Cnfloat%20IBLSheenBRDF%28%20const%20in%20vec3%20normal%2C%20const%20in%20vec3%20viewDir%2C%20const%20in%20float%20roughness%20%29%20%7B%5Cn%09float%20dotNV%20%3D%20saturate%28%20dot%28%20normal%2C%20viewDir%20%29%20%29%3B%5Cn%09float%20r2%20%3D%20roughness%20%2A%20roughness%3B%5Cn%09float%20a%20%3D%20roughness%20%3C%200.25%20%3F%20-339.2%20%2A%20r2%20%2B%20161.4%20%2A%20roughness%20-%2025.9%20%3A%20-8.48%20%2A%20r2%20%2B%2014.3%20%2A%20roughness%20-%209.95%3B%5Cn%09float%20b%20%3D%20roughness%20%3C%200.25%20%3F%2044.0%20%2A%20r2%20-%2023.7%20%2A%20roughness%20%2B%203.26%20%3A%201.97%20%2A%20r2%20-%203.27%20%2A%20roughness%20%2B%200.72%3B%5Cn%09float%20DG%20%3D%20exp%28%20a%20%2A%20dotNV%20%2B%20b%20%29%20%2B%20%28%20roughness%20%3C%200.25%20%3F%200.0%20%3A%200.1%20%2A%20%28%20roughness%20-%200.25%20%29%20%29%3B%5Cn%09return%20saturate%28%20DG%20%2A%20RECIPROCAL_PI%20%29%3B%5Cn%7D%5Cnvec2%20DFGApprox%28%20const%20in%20vec3%20normal%2C%20const%20in%20vec3%20viewDir%2C%20const%20in%20float%20roughness%20%29%20%7B%5Cn%09float%20dotNV%20%3D%20saturate%28%20dot%28%20normal%2C%20viewDir%20%29%20%29%3B%5Cn%09const%20vec4%20c0%20%3D%20vec4%28%20-%201%2C%20-%200.0275%2C%20-%200.572%2C%200.022%20%29%3B%5Cn%09const%20vec4%20c1%20%3D%20vec4%28%201%2C%200.0425%2C%201.04%2C%20-%200.04%20%29%3B%5Cn%09vec4%20r%20%3D%20roughness%20%2A%20c0%20%2B%20c1%3B%5Cn%09float%20a004%20%3D%20min%28%20r.x%20%2A%20r.x%2C%20exp2%28%20-%209.28%20%2A%20dotNV%20%29%20%29%20%2A%20r.x%20%2B%20r.y%3B%5Cn%09vec2%20fab%20%3D%20vec2%28%20-%201.04%2C%201.04%20%29%20%2A%20a004%20%2B%20r.zw%3B%5Cn%09return%20fab%3B%5Cn%7D%5Cnvec3%20EnvironmentBRDF%28%20const%20in%20vec3%20normal%2C%20const%20in%20vec3%20viewDir%2C%20const%20in%20vec3%20specularColor%2C%20const%20in%20float%20specularF90%2C%20const%20in%20float%20roughness%20%29%20%7B%5Cn%09vec2%20fab%20%3D%20DFGApprox%28%20normal%2C%20viewDir%2C%20roughness%20%29%3B%5Cn%09return%20specularColor%20%2A%20fab.x%20%2B%20specularF90%20%2A%20fab.y%3B%5Cn%7D%5Cn%23ifdef%20USE_IRIDESCENCE%5Cnvoid%20computeMultiscatteringIridescence%28%20const%20in%20vec3%20normal%2C%20const%20in%20vec3%20viewDir%2C%20const%20in%20vec3%20specularColor%2C%20const%20in%20float%20specularF90%2C%20const%20in%20float%20iridescence%2C%20const%20in%20vec3%20iridescenceF0%2C%20const%20in%20float%20roughness%2C%20inout%20vec3%20singleScatter%2C%20inout%20vec3%20multiScatter%20%29%20%7B%5Cn%23else%5Cnvoid%20computeMultiscattering%28%20const%20in%20vec3%20normal%2C%20const%20in%20vec3%20viewDir%2C%20const%20in%20vec3%20specularColor%2C%20const%20in%20float%20specularF90%2C%20const%20in%20float%20roughness%2C%20inout%20vec3%20singleScatter%2C%20inout%20vec3%20multiScatter%20%29%20%7B%5Cn%23endif%5Cn%09vec2%20fab%20%3D%20DFGApprox%28%20normal%2C%20viewDir%2C%20roughness%20%29%3B%5Cn%09%23ifdef%20USE_IRIDESCENCE%5Cn%09%09vec3%20Fr%20%3D%20mix%28%20specularColor%2C%20iridescenceF0%2C%20iridescence%20%29%3B%5Cn%09%23else%5Cn%09%09vec3%20Fr%20%3D%20specularColor%3B%5Cn%09%23endif%5Cn%09vec3%20FssEss%20%3D%20Fr%20%2A%20fab.x%20%2B%20specularF90%20%2A%20fab.y%3B%5Cn%09float%20Ess%20%3D%20fab.x%20%2B%20fab.y%3B%5Cn%09float%20Ems%20%3D%201.0%20-%20Ess%3B%5Cn%09vec3%20Favg%20%3D%20Fr%20%2B%20%28%201.0%20-%20Fr%20%29%20%2A%200.047619%3B%09vec3%20Fms%20%3D%20FssEss%20%2A%20Favg%20%2F%20%28%201.0%20-%20Ems%20%2A%20Favg%20%29%3B%5Cn%09singleScatter%20%2B%3D%20FssEss%3B%5Cn%09multiScatter%20%2B%3D%20Fms%20%2A%20Ems%3B%5Cn%7D%5Cn%23if%20NUM_RECT_AREA_LIGHTS%20%3E%200%5Cn%09void%20RE_Direct_RectArea_Physical%28%20const%20in%20RectAreaLight%20rectAreaLight%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20PhysicalMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%20%29%20%7B%5Cn%09%09vec3%20normal%20%3D%20geometryNormal%3B%5Cn%09%09vec3%20viewDir%20%3D%20geometryViewDir%3B%5Cn%09%09vec3%20position%20%3D%20geometryPosition%3B%5Cn%09%09vec3%20lightPos%20%3D%20rectAreaLight.position%3B%5Cn%09%09vec3%20halfWidth%20%3D%20rectAreaLight.halfWidth%3B%5Cn%09%09vec3%20halfHeight%20%3D%20rectAreaLight.halfHeight%3B%5Cn%09%09vec3%20lightColor%20%3D%20rectAreaLight.color%3B%5Cn%09%09float%20roughness%20%3D%20material.roughness%3B%5Cn%09%09vec3%20rectCoords%5B%204%20%5D%3B%5Cn%09%09rectCoords%5B%200%20%5D%20%3D%20lightPos%20%2B%20halfWidth%20-%20halfHeight%3B%09%09rectCoords%5B%201%20%5D%20%3D%20lightPos%20-%20halfWidth%20-%20halfHeight%3B%5Cn%09%09rectCoords%5B%202%20%5D%20%3D%20lightPos%20-%20halfWidth%20%2B%20halfHeight%3B%5Cn%09%09rectCoords%5B%203%20%5D%20%3D%20lightPos%20%2B%20halfWidth%20%2B%20halfHeight%3B%5Cn%09%09vec2%20uv%20%3D%20LTC_Uv%28%20normal%2C%20viewDir%2C%20roughness%20%29%3B%5Cn%09%09vec4%20t1%20%3D%20texture2D%28%20ltc_1%2C%20uv%20%29%3B%5Cn%09%09vec4%20t2%20%3D%20texture2D%28%20ltc_2%2C%20uv%20%29%3B%5Cn%09%09mat3%20mInv%20%3D%20mat3%28%5Cn%09%09%09vec3%28%20t1.x%2C%200%2C%20t1.y%20%29%2C%5Cn%09%09%09vec3%28%20%20%20%200%2C%201%2C%20%20%20%200%20%29%2C%5Cn%09%09%09vec3%28%20t1.z%2C%200%2C%20t1.w%20%29%5Cn%09%09%29%3B%5Cn%09%09vec3%20fresnel%20%3D%20%28%20material.specularColor%20%2A%20t2.x%20%2B%20%28%20vec3%28%201.0%20%29%20-%20material.specularColor%20%29%20%2A%20t2.y%20%29%3B%5Cn%09%09reflectedLight.directSpecular%20%2B%3D%20lightColor%20%2A%20fresnel%20%2A%20LTC_Evaluate%28%20normal%2C%20viewDir%2C%20position%2C%20mInv%2C%20rectCoords%20%29%3B%5Cn%09%09reflectedLight.directDiffuse%20%2B%3D%20lightColor%20%2A%20material.diffuseColor%20%2A%20LTC_Evaluate%28%20normal%2C%20viewDir%2C%20position%2C%20mat3%28%201.0%20%29%2C%20rectCoords%20%29%3B%5Cn%09%7D%5Cn%23endif%5Cnvoid%20RE_Direct_Physical%28%20const%20in%20IncidentLight%20directLight%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20PhysicalMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%20%29%20%7B%5Cn%09float%20dotNL%20%3D%20saturate%28%20dot%28%20geometryNormal%2C%20directLight.direction%20%29%20%29%3B%5Cn%09vec3%20irradiance%20%3D%20dotNL%20%2A%20directLight.color%3B%5Cn%09%23ifdef%20USE_CLEARCOAT%5Cn%09%09float%20dotNLcc%20%3D%20saturate%28%20dot%28%20geometryClearcoatNormal%2C%20directLight.direction%20%29%20%29%3B%5Cn%09%09vec3%20ccIrradiance%20%3D%20dotNLcc%20%2A%20directLight.color%3B%5Cn%09%09clearcoatSpecularDirect%20%2B%3D%20ccIrradiance%20%2A%20BRDF_GGX_Clearcoat%28%20directLight.direction%2C%20geometryViewDir%2C%20geometryClearcoatNormal%2C%20material%20%29%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_SHEEN%5Cn%09%09sheenSpecularDirect%20%2B%3D%20irradiance%20%2A%20BRDF_Sheen%28%20directLight.direction%2C%20geometryViewDir%2C%20geometryNormal%2C%20material.sheenColor%2C%20material.sheenRoughness%20%29%3B%5Cn%09%23endif%5Cn%09reflectedLight.directSpecular%20%2B%3D%20irradiance%20%2A%20BRDF_GGX%28%20directLight.direction%2C%20geometryViewDir%2C%20geometryNormal%2C%20material%20%29%3B%5Cn%09reflectedLight.directDiffuse%20%2B%3D%20irradiance%20%2A%20BRDF_Lambert%28%20material.diffuseColor%20%29%3B%5Cn%7D%5Cnvoid%20RE_IndirectDiffuse_Physical%28%20const%20in%20vec3%20irradiance%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20PhysicalMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%20%29%20%7B%5Cn%09reflectedLight.indirectDiffuse%20%2B%3D%20irradiance%20%2A%20BRDF_Lambert%28%20material.diffuseColor%20%29%3B%5Cn%7D%5Cnvoid%20RE_IndirectSpecular_Physical%28%20const%20in%20vec3%20radiance%2C%20const%20in%20vec3%20irradiance%2C%20const%20in%20vec3%20clearcoatRadiance%2C%20const%20in%20vec3%20geometryPosition%2C%20const%20in%20vec3%20geometryNormal%2C%20const%20in%20vec3%20geometryViewDir%2C%20const%20in%20vec3%20geometryClearcoatNormal%2C%20const%20in%20PhysicalMaterial%20material%2C%20inout%20ReflectedLight%20reflectedLight%29%20%7B%5Cn%09%23ifdef%20USE_CLEARCOAT%5Cn%09%09clearcoatSpecularIndirect%20%2B%3D%20clearcoatRadiance%20%2A%20EnvironmentBRDF%28%20geometryClearcoatNormal%2C%20geometryViewDir%2C%20material.clearcoatF0%2C%20material.clearcoatF90%2C%20material.clearcoatRoughness%20%29%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_SHEEN%5Cn%09%09sheenSpecularIndirect%20%2B%3D%20irradiance%20%2A%20material.sheenColor%20%2A%20IBLSheenBRDF%28%20geometryNormal%2C%20geometryViewDir%2C%20material.sheenRoughness%20%29%3B%5Cn%09%23endif%5Cn%09vec3%20singleScattering%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09vec3%20multiScattering%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09vec3%20cosineWeightedIrradiance%20%3D%20irradiance%20%2A%20RECIPROCAL_PI%3B%5Cn%09%23ifdef%20USE_IRIDESCENCE%5Cn%09%09computeMultiscatteringIridescence%28%20geometryNormal%2C%20geometryViewDir%2C%20material.specularColor%2C%20material.specularF90%2C%20material.iridescence%2C%20material.iridescenceFresnel%2C%20material.roughness%2C%20singleScattering%2C%20multiScattering%20%29%3B%5Cn%09%23else%5Cn%09%09computeMultiscattering%28%20geometryNormal%2C%20geometryViewDir%2C%20material.specularColor%2C%20material.specularF90%2C%20material.roughness%2C%20singleScattering%2C%20multiScattering%20%29%3B%5Cn%09%23endif%5Cn%09vec3%20totalScattering%20%3D%20singleScattering%20%2B%20multiScattering%3B%5Cn%09vec3%20diffuse%20%3D%20material.diffuseColor%20%2A%20%28%201.0%20-%20max%28%20max%28%20totalScattering.r%2C%20totalScattering.g%20%29%2C%20totalScattering.b%20%29%20%29%3B%5Cn%09reflectedLight.indirectSpecular%20%2B%3D%20radiance%20%2A%20singleScattering%3B%5Cn%09reflectedLight.indirectSpecular%20%2B%3D%20multiScattering%20%2A%20cosineWeightedIrradiance%3B%5Cn%09reflectedLight.indirectDiffuse%20%2B%3D%20diffuse%20%2A%20cosineWeightedIrradiance%3B%5Cn%7D%5Cn%23define%20RE_Direct%09%09%09%09RE_Direct_Physical%5Cn%23define%20RE_Direct_RectArea%09%09RE_Direct_RectArea_Physical%5Cn%23define%20RE_IndirectDiffuse%09%09RE_IndirectDiffuse_Physical%5Cn%23define%20RE_IndirectSpecular%09%09RE_IndirectSpecular_Physical%5Cnfloat%20computeSpecularOcclusion%28%20const%20in%20float%20dotNV%2C%20const%20in%20float%20ambientOcclusion%2C%20const%20in%20float%20roughness%20%29%20%7B%5Cn%09return%20saturate%28%20pow%28%20dotNV%20%2B%20ambientOcclusion%2C%20exp2%28%20-%2016.0%20%2A%20roughness%20-%201.0%20%29%20%29%20-%201.0%20%2B%20ambientOcclusion%20%29%3B%5Cn%7D%22%3B%0Avar%20lights_fragment_begin%20%3D%20%22%5Cnvec3%20geometryPosition%20%3D%20-%20vViewPosition%3B%5Cnvec3%20geometryNormal%20%3D%20normal%3B%5Cnvec3%20geometryViewDir%20%3D%20%28%20isOrthographic%20%29%20%3F%20vec3%28%200%2C%200%2C%201%20%29%20%3A%20normalize%28%20vViewPosition%20%29%3B%5Cnvec3%20geometryClearcoatNormal%20%3D%20vec3%28%200.0%20%29%3B%5Cn%23ifdef%20USE_CLEARCOAT%5Cn%09geometryClearcoatNormal%20%3D%20clearcoatNormal%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCE%5Cn%09float%20dotNVi%20%3D%20saturate%28%20dot%28%20normal%2C%20geometryViewDir%20%29%20%29%3B%5Cn%09if%20%28%20material.iridescenceThickness%20%3D%3D%200.0%20%29%20%7B%5Cn%09%09material.iridescence%20%3D%200.0%3B%5Cn%09%7D%20else%20%7B%5Cn%09%09material.iridescence%20%3D%20saturate%28%20material.iridescence%20%29%3B%5Cn%09%7D%5Cn%09if%20%28%20material.iridescence%20%3E%200.0%20%29%20%7B%5Cn%09%09material.iridescenceFresnel%20%3D%20evalIridescence%28%201.0%2C%20material.iridescenceIOR%2C%20dotNVi%2C%20material.iridescenceThickness%2C%20material.specularColor%20%29%3B%5Cn%09%09material.iridescenceF0%20%3D%20Schlick_to_F0%28%20material.iridescenceFresnel%2C%201.0%2C%20dotNVi%20%29%3B%5Cn%09%7D%5Cn%23endif%5CnIncidentLight%20directLight%3B%5Cn%23if%20%28%20NUM_POINT_LIGHTS%20%3E%200%20%29%20%26%26%20defined%28%20RE_Direct%20%29%5Cn%09PointLight%20pointLight%3B%5Cn%09%23if%20defined%28%20USE_SHADOWMAP%20%29%20%26%26%20NUM_POINT_LIGHT_SHADOWS%20%3E%200%5Cn%09PointLightShadow%20pointLightShadow%3B%5Cn%09%23endif%5Cn%09%23pragma%20unroll_loop_start%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_POINT_LIGHTS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09pointLight%20%3D%20pointLights%5B%20i%20%5D%3B%5Cn%09%09getPointLightInfo%28%20pointLight%2C%20geometryPosition%2C%20directLight%20%29%3B%5Cn%09%09%23if%20defined%28%20USE_SHADOWMAP%20%29%20%26%26%20%28%20UNROLLED_LOOP_INDEX%20%3C%20NUM_POINT_LIGHT_SHADOWS%20%29%5Cn%09%09pointLightShadow%20%3D%20pointLightShadows%5B%20i%20%5D%3B%5Cn%09%09directLight.color%20%2A%3D%20%28%20directLight.visible%20%26%26%20receiveShadow%20%29%20%3F%20getPointShadow%28%20pointShadowMap%5B%20i%20%5D%2C%20pointLightShadow.shadowMapSize%2C%20pointLightShadow.shadowIntensity%2C%20pointLightShadow.shadowBias%2C%20pointLightShadow.shadowRadius%2C%20vPointShadowCoord%5B%20i%20%5D%2C%20pointLightShadow.shadowCameraNear%2C%20pointLightShadow.shadowCameraFar%20%29%20%3A%201.0%3B%5Cn%09%09%23endif%5Cn%09%09RE_Direct%28%20directLight%2C%20geometryPosition%2C%20geometryNormal%2C%20geometryViewDir%2C%20geometryClearcoatNormal%2C%20material%2C%20reflectedLight%20%29%3B%5Cn%09%7D%5Cn%09%23pragma%20unroll_loop_end%5Cn%23endif%5Cn%23if%20%28%20NUM_SPOT_LIGHTS%20%3E%200%20%29%20%26%26%20defined%28%20RE_Direct%20%29%5Cn%09SpotLight%20spotLight%3B%5Cn%09vec4%20spotColor%3B%5Cn%09vec3%20spotLightCoord%3B%5Cn%09bool%20inSpotLightMap%3B%5Cn%09%23if%20defined%28%20USE_SHADOWMAP%20%29%20%26%26%20NUM_SPOT_LIGHT_SHADOWS%20%3E%200%5Cn%09SpotLightShadow%20spotLightShadow%3B%5Cn%09%23endif%5Cn%09%23pragma%20unroll_loop_start%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_SPOT_LIGHTS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09spotLight%20%3D%20spotLights%5B%20i%20%5D%3B%5Cn%09%09getSpotLightInfo%28%20spotLight%2C%20geometryPosition%2C%20directLight%20%29%3B%5Cn%09%09%23if%20%28%20UNROLLED_LOOP_INDEX%20%3C%20NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS%20%29%5Cn%09%09%23define%20SPOT_LIGHT_MAP_INDEX%20UNROLLED_LOOP_INDEX%5Cn%09%09%23elif%20%28%20UNROLLED_LOOP_INDEX%20%3C%20NUM_SPOT_LIGHT_SHADOWS%20%29%5Cn%09%09%23define%20SPOT_LIGHT_MAP_INDEX%20NUM_SPOT_LIGHT_MAPS%5Cn%09%09%23else%5Cn%09%09%23define%20SPOT_LIGHT_MAP_INDEX%20%28%20UNROLLED_LOOP_INDEX%20-%20NUM_SPOT_LIGHT_SHADOWS%20%2B%20NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS%20%29%5Cn%09%09%23endif%5Cn%09%09%23if%20%28%20SPOT_LIGHT_MAP_INDEX%20%3C%20NUM_SPOT_LIGHT_MAPS%20%29%5Cn%09%09%09spotLightCoord%20%3D%20vSpotLightCoord%5B%20i%20%5D.xyz%20%2F%20vSpotLightCoord%5B%20i%20%5D.w%3B%5Cn%09%09%09inSpotLightMap%20%3D%20all%28%20lessThan%28%20abs%28%20spotLightCoord%20%2A%202.%20-%201.%20%29%2C%20vec3%28%201.0%20%29%20%29%20%29%3B%5Cn%09%09%09spotColor%20%3D%20texture2D%28%20spotLightMap%5B%20SPOT_LIGHT_MAP_INDEX%20%5D%2C%20spotLightCoord.xy%20%29%3B%5Cn%09%09%09directLight.color%20%3D%20inSpotLightMap%20%3F%20directLight.color%20%2A%20spotColor.rgb%20%3A%20directLight.color%3B%5Cn%09%09%23endif%5Cn%09%09%23undef%20SPOT_LIGHT_MAP_INDEX%5Cn%09%09%23if%20defined%28%20USE_SHADOWMAP%20%29%20%26%26%20%28%20UNROLLED_LOOP_INDEX%20%3C%20NUM_SPOT_LIGHT_SHADOWS%20%29%5Cn%09%09spotLightShadow%20%3D%20spotLightShadows%5B%20i%20%5D%3B%5Cn%09%09directLight.color%20%2A%3D%20%28%20directLight.visible%20%26%26%20receiveShadow%20%29%20%3F%20getShadow%28%20spotShadowMap%5B%20i%20%5D%2C%20spotLightShadow.shadowMapSize%2C%20spotLightShadow.shadowIntensity%2C%20spotLightShadow.shadowBias%2C%20spotLightShadow.shadowRadius%2C%20vSpotLightCoord%5B%20i%20%5D%20%29%20%3A%201.0%3B%5Cn%09%09%23endif%5Cn%09%09RE_Direct%28%20directLight%2C%20geometryPosition%2C%20geometryNormal%2C%20geometryViewDir%2C%20geometryClearcoatNormal%2C%20material%2C%20reflectedLight%20%29%3B%5Cn%09%7D%5Cn%09%23pragma%20unroll_loop_end%5Cn%23endif%5Cn%23if%20%28%20NUM_DIR_LIGHTS%20%3E%200%20%29%20%26%26%20defined%28%20RE_Direct%20%29%5Cn%09DirectionalLight%20directionalLight%3B%5Cn%09%23if%20defined%28%20USE_SHADOWMAP%20%29%20%26%26%20NUM_DIR_LIGHT_SHADOWS%20%3E%200%5Cn%09DirectionalLightShadow%20directionalLightShadow%3B%5Cn%09%23endif%5Cn%09%23pragma%20unroll_loop_start%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_DIR_LIGHTS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09directionalLight%20%3D%20directionalLights%5B%20i%20%5D%3B%5Cn%09%09getDirectionalLightInfo%28%20directionalLight%2C%20directLight%20%29%3B%5Cn%09%09%23if%20defined%28%20USE_SHADOWMAP%20%29%20%26%26%20%28%20UNROLLED_LOOP_INDEX%20%3C%20NUM_DIR_LIGHT_SHADOWS%20%29%5Cn%09%09directionalLightShadow%20%3D%20directionalLightShadows%5B%20i%20%5D%3B%5Cn%09%09directLight.color%20%2A%3D%20%28%20directLight.visible%20%26%26%20receiveShadow%20%29%20%3F%20getShadow%28%20directionalShadowMap%5B%20i%20%5D%2C%20directionalLightShadow.shadowMapSize%2C%20directionalLightShadow.shadowIntensity%2C%20directionalLightShadow.shadowBias%2C%20directionalLightShadow.shadowRadius%2C%20vDirectionalShadowCoord%5B%20i%20%5D%20%29%20%3A%201.0%3B%5Cn%09%09%23endif%5Cn%09%09RE_Direct%28%20directLight%2C%20geometryPosition%2C%20geometryNormal%2C%20geometryViewDir%2C%20geometryClearcoatNormal%2C%20material%2C%20reflectedLight%20%29%3B%5Cn%09%7D%5Cn%09%23pragma%20unroll_loop_end%5Cn%23endif%5Cn%23if%20%28%20NUM_RECT_AREA_LIGHTS%20%3E%200%20%29%20%26%26%20defined%28%20RE_Direct_RectArea%20%29%5Cn%09RectAreaLight%20rectAreaLight%3B%5Cn%09%23pragma%20unroll_loop_start%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_RECT_AREA_LIGHTS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09rectAreaLight%20%3D%20rectAreaLights%5B%20i%20%5D%3B%5Cn%09%09RE_Direct_RectArea%28%20rectAreaLight%2C%20geometryPosition%2C%20geometryNormal%2C%20geometryViewDir%2C%20geometryClearcoatNormal%2C%20material%2C%20reflectedLight%20%29%3B%5Cn%09%7D%5Cn%09%23pragma%20unroll_loop_end%5Cn%23endif%5Cn%23if%20defined%28%20RE_IndirectDiffuse%20%29%5Cn%09vec3%20iblIrradiance%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09vec3%20irradiance%20%3D%20getAmbientLightIrradiance%28%20ambientLightColor%20%29%3B%5Cn%09%23if%20defined%28%20USE_LIGHT_PROBES%20%29%5Cn%09%09irradiance%20%2B%3D%20getLightProbeIrradiance%28%20lightProbe%2C%20geometryNormal%20%29%3B%5Cn%09%23endif%5Cn%09%23if%20%28%20NUM_HEMI_LIGHTS%20%3E%200%20%29%5Cn%09%09%23pragma%20unroll_loop_start%5Cn%09%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_HEMI_LIGHTS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09%09irradiance%20%2B%3D%20getHemisphereLightIrradiance%28%20hemisphereLights%5B%20i%20%5D%2C%20geometryNormal%20%29%3B%5Cn%09%09%7D%5Cn%09%09%23pragma%20unroll_loop_end%5Cn%09%23endif%5Cn%23endif%5Cn%23if%20defined%28%20RE_IndirectSpecular%20%29%5Cn%09vec3%20radiance%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09vec3%20clearcoatRadiance%20%3D%20vec3%28%200.0%20%29%3B%5Cn%23endif%22%3B%0Avar%20lights_fragment_maps%20%3D%20%22%23if%20defined%28%20RE_IndirectDiffuse%20%29%5Cn%09%23ifdef%20USE_LIGHTMAP%5Cn%09%09vec4%20lightMapTexel%20%3D%20texture2D%28%20lightMap%2C%20vLightMapUv%20%29%3B%5Cn%09%09vec3%20lightMapIrradiance%20%3D%20lightMapTexel.rgb%20%2A%20lightMapIntensity%3B%5Cn%09%09irradiance%20%2B%3D%20lightMapIrradiance%3B%5Cn%09%23endif%5Cn%09%23if%20defined%28%20USE_ENVMAP%20%29%20%26%26%20defined%28%20STANDARD%20%29%20%26%26%20defined%28%20ENVMAP_TYPE_CUBE_UV%20%29%5Cn%09%09iblIrradiance%20%2B%3D%20getIBLIrradiance%28%20geometryNormal%20%29%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23if%20defined%28%20USE_ENVMAP%20%29%20%26%26%20defined%28%20RE_IndirectSpecular%20%29%5Cn%09%23ifdef%20USE_ANISOTROPY%5Cn%09%09radiance%20%2B%3D%20getIBLAnisotropyRadiance%28%20geometryViewDir%2C%20geometryNormal%2C%20material.roughness%2C%20material.anisotropyB%2C%20material.anisotropy%20%29%3B%5Cn%09%23else%5Cn%09%09radiance%20%2B%3D%20getIBLRadiance%28%20geometryViewDir%2C%20geometryNormal%2C%20material.roughness%20%29%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_CLEARCOAT%5Cn%09%09clearcoatRadiance%20%2B%3D%20getIBLRadiance%28%20geometryViewDir%2C%20geometryClearcoatNormal%2C%20material.clearcoatRoughness%20%29%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20lights_fragment_end%20%3D%20%22%23if%20defined%28%20RE_IndirectDiffuse%20%29%5Cn%09RE_IndirectDiffuse%28%20irradiance%2C%20geometryPosition%2C%20geometryNormal%2C%20geometryViewDir%2C%20geometryClearcoatNormal%2C%20material%2C%20reflectedLight%20%29%3B%5Cn%23endif%5Cn%23if%20defined%28%20RE_IndirectSpecular%20%29%5Cn%09RE_IndirectSpecular%28%20radiance%2C%20iblIrradiance%2C%20clearcoatRadiance%2C%20geometryPosition%2C%20geometryNormal%2C%20geometryViewDir%2C%20geometryClearcoatNormal%2C%20material%2C%20reflectedLight%20%29%3B%5Cn%23endif%22%3B%0Avar%20logdepthbuf_fragment%20%3D%20%22%23if%20defined%28%20USE_LOGDEPTHBUF%20%29%5Cn%09gl_FragDepth%20%3D%20vIsPerspective%20%3D%3D%200.0%20%3F%20gl_FragCoord.z%20%3A%20log2%28%20vFragDepth%20%29%20%2A%20logDepthBufFC%20%2A%200.5%3B%5Cn%23endif%22%3B%0Avar%20logdepthbuf_pars_fragment%20%3D%20%22%23if%20defined%28%20USE_LOGDEPTHBUF%20%29%5Cn%09uniform%20float%20logDepthBufFC%3B%5Cn%09varying%20float%20vFragDepth%3B%5Cn%09varying%20float%20vIsPerspective%3B%5Cn%23endif%22%3B%0Avar%20logdepthbuf_pars_vertex%20%3D%20%22%23ifdef%20USE_LOGDEPTHBUF%5Cn%09varying%20float%20vFragDepth%3B%5Cn%09varying%20float%20vIsPerspective%3B%5Cn%23endif%22%3B%0Avar%20logdepthbuf_vertex%20%3D%20%22%23ifdef%20USE_LOGDEPTHBUF%5Cn%09vFragDepth%20%3D%201.0%20%2B%20gl_Position.w%3B%5Cn%09vIsPerspective%20%3D%20float%28%20isPerspectiveMatrix%28%20projectionMatrix%20%29%20%29%3B%5Cn%23endif%22%3B%0Avar%20map_fragment%20%3D%20%22%23ifdef%20USE_MAP%5Cn%09vec4%20sampledDiffuseColor%20%3D%20texture2D%28%20map%2C%20vMapUv%20%29%3B%5Cn%09%23ifdef%20DECODE_VIDEO_TEXTURE%5Cn%09%09sampledDiffuseColor%20%3D%20sRGBTransferEOTF%28%20sampledDiffuseColor%20%29%3B%5Cn%09%23endif%5Cn%09diffuseColor%20%2A%3D%20sampledDiffuseColor%3B%5Cn%23endif%22%3B%0Avar%20map_pars_fragment%20%3D%20%22%23ifdef%20USE_MAP%5Cn%09uniform%20sampler2D%20map%3B%5Cn%23endif%22%3B%0Avar%20map_particle_fragment%20%3D%20%22%23if%20defined%28%20USE_MAP%20%29%20%7C%7C%20defined%28%20USE_ALPHAMAP%20%29%5Cn%09%23if%20defined%28%20USE_POINTS_UV%20%29%5Cn%09%09vec2%20uv%20%3D%20vUv%3B%5Cn%09%23else%5Cn%09%09vec2%20uv%20%3D%20%28%20uvTransform%20%2A%20vec3%28%20gl_PointCoord.x%2C%201.0%20-%20gl_PointCoord.y%2C%201%20%29%20%29.xy%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23ifdef%20USE_MAP%5Cn%09diffuseColor%20%2A%3D%20texture2D%28%20map%2C%20uv%20%29%3B%5Cn%23endif%5Cn%23ifdef%20USE_ALPHAMAP%5Cn%09diffuseColor.a%20%2A%3D%20texture2D%28%20alphaMap%2C%20uv%20%29.g%3B%5Cn%23endif%22%3B%0Avar%20map_particle_pars_fragment%20%3D%20%22%23if%20defined%28%20USE_POINTS_UV%20%29%5Cn%09varying%20vec2%20vUv%3B%5Cn%23else%5Cn%09%23if%20defined%28%20USE_MAP%20%29%20%7C%7C%20defined%28%20USE_ALPHAMAP%20%29%5Cn%09%09uniform%20mat3%20uvTransform%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23ifdef%20USE_MAP%5Cn%09uniform%20sampler2D%20map%3B%5Cn%23endif%5Cn%23ifdef%20USE_ALPHAMAP%5Cn%09uniform%20sampler2D%20alphaMap%3B%5Cn%23endif%22%3B%0Avar%20metalnessmap_fragment%20%3D%20%22float%20metalnessFactor%20%3D%20metalness%3B%5Cn%23ifdef%20USE_METALNESSMAP%5Cn%09vec4%20texelMetalness%20%3D%20texture2D%28%20metalnessMap%2C%20vMetalnessMapUv%20%29%3B%5Cn%09metalnessFactor%20%2A%3D%20texelMetalness.b%3B%5Cn%23endif%22%3B%0Avar%20metalnessmap_pars_fragment%20%3D%20%22%23ifdef%20USE_METALNESSMAP%5Cn%09uniform%20sampler2D%20metalnessMap%3B%5Cn%23endif%22%3B%0Avar%20morphinstance_vertex%20%3D%20%22%23ifdef%20USE_INSTANCING_MORPH%5Cn%09float%20morphTargetInfluences%5B%20MORPHTARGETS_COUNT%20%5D%3B%5Cn%09float%20morphTargetBaseInfluence%20%3D%20texelFetch%28%20morphTexture%2C%20ivec2%28%200%2C%20gl_InstanceID%20%29%2C%200%20%29.r%3B%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20MORPHTARGETS_COUNT%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09morphTargetInfluences%5Bi%5D%20%3D%20%20texelFetch%28%20morphTexture%2C%20ivec2%28%20i%20%2B%201%2C%20gl_InstanceID%20%29%2C%200%20%29.r%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20morphcolor_vertex%20%3D%20%22%23if%20defined%28%20USE_MORPHCOLORS%20%29%5Cn%09vColor%20%2A%3D%20morphTargetBaseInfluence%3B%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20MORPHTARGETS_COUNT%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09%23if%20defined%28%20USE_COLOR_ALPHA%20%29%5Cn%09%09%09if%20%28%20morphTargetInfluences%5B%20i%20%5D%20%21%3D%200.0%20%29%20vColor%20%2B%3D%20getMorph%28%20gl_VertexID%2C%20i%2C%202%20%29%20%2A%20morphTargetInfluences%5B%20i%20%5D%3B%5Cn%09%09%23elif%20defined%28%20USE_COLOR%20%29%5Cn%09%09%09if%20%28%20morphTargetInfluences%5B%20i%20%5D%20%21%3D%200.0%20%29%20vColor%20%2B%3D%20getMorph%28%20gl_VertexID%2C%20i%2C%202%20%29.rgb%20%2A%20morphTargetInfluences%5B%20i%20%5D%3B%5Cn%09%09%23endif%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20morphnormal_vertex%20%3D%20%22%23ifdef%20USE_MORPHNORMALS%5Cn%09objectNormal%20%2A%3D%20morphTargetBaseInfluence%3B%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20MORPHTARGETS_COUNT%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09if%20%28%20morphTargetInfluences%5B%20i%20%5D%20%21%3D%200.0%20%29%20objectNormal%20%2B%3D%20getMorph%28%20gl_VertexID%2C%20i%2C%201%20%29.xyz%20%2A%20morphTargetInfluences%5B%20i%20%5D%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20morphtarget_pars_vertex%20%3D%20%22%23ifdef%20USE_MORPHTARGETS%5Cn%09%23ifndef%20USE_INSTANCING_MORPH%5Cn%09%09uniform%20float%20morphTargetBaseInfluence%3B%5Cn%09%09uniform%20float%20morphTargetInfluences%5B%20MORPHTARGETS_COUNT%20%5D%3B%5Cn%09%23endif%5Cn%09uniform%20sampler2DArray%20morphTargetsTexture%3B%5Cn%09uniform%20ivec2%20morphTargetsTextureSize%3B%5Cn%09vec4%20getMorph%28%20const%20in%20int%20vertexIndex%2C%20const%20in%20int%20morphTargetIndex%2C%20const%20in%20int%20offset%20%29%20%7B%5Cn%09%09int%20texelIndex%20%3D%20vertexIndex%20%2A%20MORPHTARGETS_TEXTURE_STRIDE%20%2B%20offset%3B%5Cn%09%09int%20y%20%3D%20texelIndex%20%2F%20morphTargetsTextureSize.x%3B%5Cn%09%09int%20x%20%3D%20texelIndex%20-%20y%20%2A%20morphTargetsTextureSize.x%3B%5Cn%09%09ivec3%20morphUV%20%3D%20ivec3%28%20x%2C%20y%2C%20morphTargetIndex%20%29%3B%5Cn%09%09return%20texelFetch%28%20morphTargetsTexture%2C%20morphUV%2C%200%20%29%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20morphtarget_vertex%20%3D%20%22%23ifdef%20USE_MORPHTARGETS%5Cn%09transformed%20%2A%3D%20morphTargetBaseInfluence%3B%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20MORPHTARGETS_COUNT%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09if%20%28%20morphTargetInfluences%5B%20i%20%5D%20%21%3D%200.0%20%29%20transformed%20%2B%3D%20getMorph%28%20gl_VertexID%2C%20i%2C%200%20%29.xyz%20%2A%20morphTargetInfluences%5B%20i%20%5D%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20normal_fragment_begin%20%3D%20%22float%20faceDirection%20%3D%20gl_FrontFacing%20%3F%201.0%20%3A%20-%201.0%3B%5Cn%23ifdef%20FLAT_SHADED%5Cn%09vec3%20fdx%20%3D%20dFdx%28%20vViewPosition%20%29%3B%5Cn%09vec3%20fdy%20%3D%20dFdy%28%20vViewPosition%20%29%3B%5Cn%09vec3%20normal%20%3D%20normalize%28%20cross%28%20fdx%2C%20fdy%20%29%20%29%3B%5Cn%23else%5Cn%09vec3%20normal%20%3D%20normalize%28%20vNormal%20%29%3B%5Cn%09%23ifdef%20DOUBLE_SIDED%5Cn%09%09normal%20%2A%3D%20faceDirection%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23if%20defined%28%20USE_NORMALMAP_TANGENTSPACE%20%29%20%7C%7C%20defined%28%20USE_CLEARCOAT_NORMALMAP%20%29%20%7C%7C%20defined%28%20USE_ANISOTROPY%20%29%5Cn%09%23ifdef%20USE_TANGENT%5Cn%09%09mat3%20tbn%20%3D%20mat3%28%20normalize%28%20vTangent%20%29%2C%20normalize%28%20vBitangent%20%29%2C%20normal%20%29%3B%5Cn%09%23else%5Cn%09%09mat3%20tbn%20%3D%20getTangentFrame%28%20-%20vViewPosition%2C%20normal%2C%5Cn%09%09%23if%20defined%28%20USE_NORMALMAP%20%29%5Cn%09%09%09vNormalMapUv%5Cn%09%09%23elif%20defined%28%20USE_CLEARCOAT_NORMALMAP%20%29%5Cn%09%09%09vClearcoatNormalMapUv%5Cn%09%09%23else%5Cn%09%09%09vUv%5Cn%09%09%23endif%5Cn%09%09%29%3B%5Cn%09%23endif%5Cn%09%23if%20defined%28%20DOUBLE_SIDED%20%29%20%26%26%20%21%20defined%28%20FLAT_SHADED%20%29%5Cn%09%09tbn%5B0%5D%20%2A%3D%20faceDirection%3B%5Cn%09%09tbn%5B1%5D%20%2A%3D%20faceDirection%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT_NORMALMAP%5Cn%09%23ifdef%20USE_TANGENT%5Cn%09%09mat3%20tbn2%20%3D%20mat3%28%20normalize%28%20vTangent%20%29%2C%20normalize%28%20vBitangent%20%29%2C%20normal%20%29%3B%5Cn%09%23else%5Cn%09%09mat3%20tbn2%20%3D%20getTangentFrame%28%20-%20vViewPosition%2C%20normal%2C%20vClearcoatNormalMapUv%20%29%3B%5Cn%09%23endif%5Cn%09%23if%20defined%28%20DOUBLE_SIDED%20%29%20%26%26%20%21%20defined%28%20FLAT_SHADED%20%29%5Cn%09%09tbn2%5B0%5D%20%2A%3D%20faceDirection%3B%5Cn%09%09tbn2%5B1%5D%20%2A%3D%20faceDirection%3B%5Cn%09%23endif%5Cn%23endif%5Cnvec3%20nonPerturbedNormal%20%3D%20normal%3B%22%3B%0Avar%20normal_fragment_maps%20%3D%20%22%23ifdef%20USE_NORMALMAP_OBJECTSPACE%5Cn%09normal%20%3D%20texture2D%28%20normalMap%2C%20vNormalMapUv%20%29.xyz%20%2A%202.0%20-%201.0%3B%5Cn%09%23ifdef%20FLIP_SIDED%5Cn%09%09normal%20%3D%20-%20normal%3B%5Cn%09%23endif%5Cn%09%23ifdef%20DOUBLE_SIDED%5Cn%09%09normal%20%3D%20normal%20%2A%20faceDirection%3B%5Cn%09%23endif%5Cn%09normal%20%3D%20normalize%28%20normalMatrix%20%2A%20normal%20%29%3B%5Cn%23elif%20defined%28%20USE_NORMALMAP_TANGENTSPACE%20%29%5Cn%09vec3%20mapN%20%3D%20texture2D%28%20normalMap%2C%20vNormalMapUv%20%29.xyz%20%2A%202.0%20-%201.0%3B%5Cn%09mapN.xy%20%2A%3D%20normalScale%3B%5Cn%09normal%20%3D%20normalize%28%20tbn%20%2A%20mapN%20%29%3B%5Cn%23elif%20defined%28%20USE_BUMPMAP%20%29%5Cn%09normal%20%3D%20perturbNormalArb%28%20-%20vViewPosition%2C%20normal%2C%20dHdxy_fwd%28%29%2C%20faceDirection%20%29%3B%5Cn%23endif%22%3B%0Avar%20normal_pars_fragment%20%3D%20%22%23ifndef%20FLAT_SHADED%5Cn%09varying%20vec3%20vNormal%3B%5Cn%09%23ifdef%20USE_TANGENT%5Cn%09%09varying%20vec3%20vTangent%3B%5Cn%09%09varying%20vec3%20vBitangent%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20normal_pars_vertex%20%3D%20%22%23ifndef%20FLAT_SHADED%5Cn%09varying%20vec3%20vNormal%3B%5Cn%09%23ifdef%20USE_TANGENT%5Cn%09%09varying%20vec3%20vTangent%3B%5Cn%09%09varying%20vec3%20vBitangent%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20normal_vertex%20%3D%20%22%23ifndef%20FLAT_SHADED%5Cn%09vNormal%20%3D%20normalize%28%20transformedNormal%20%29%3B%5Cn%09%23ifdef%20USE_TANGENT%5Cn%09%09vTangent%20%3D%20normalize%28%20transformedTangent%20%29%3B%5Cn%09%09vBitangent%20%3D%20normalize%28%20cross%28%20vNormal%2C%20vTangent%20%29%20%2A%20tangent.w%20%29%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20normalmap_pars_fragment%20%3D%20%22%23ifdef%20USE_NORMALMAP%5Cn%09uniform%20sampler2D%20normalMap%3B%5Cn%09uniform%20vec2%20normalScale%3B%5Cn%23endif%5Cn%23ifdef%20USE_NORMALMAP_OBJECTSPACE%5Cn%09uniform%20mat3%20normalMatrix%3B%5Cn%23endif%5Cn%23if%20%21%20defined%20%28%20USE_TANGENT%20%29%20%26%26%20%28%20defined%20%28%20USE_NORMALMAP_TANGENTSPACE%20%29%20%7C%7C%20defined%20%28%20USE_CLEARCOAT_NORMALMAP%20%29%20%7C%7C%20defined%28%20USE_ANISOTROPY%20%29%20%29%5Cn%09mat3%20getTangentFrame%28%20vec3%20eye_pos%2C%20vec3%20surf_norm%2C%20vec2%20uv%20%29%20%7B%5Cn%09%09vec3%20q0%20%3D%20dFdx%28%20eye_pos.xyz%20%29%3B%5Cn%09%09vec3%20q1%20%3D%20dFdy%28%20eye_pos.xyz%20%29%3B%5Cn%09%09vec2%20st0%20%3D%20dFdx%28%20uv.st%20%29%3B%5Cn%09%09vec2%20st1%20%3D%20dFdy%28%20uv.st%20%29%3B%5Cn%09%09vec3%20N%20%3D%20surf_norm%3B%5Cn%09%09vec3%20q1perp%20%3D%20cross%28%20q1%2C%20N%20%29%3B%5Cn%09%09vec3%20q0perp%20%3D%20cross%28%20N%2C%20q0%20%29%3B%5Cn%09%09vec3%20T%20%3D%20q1perp%20%2A%20st0.x%20%2B%20q0perp%20%2A%20st1.x%3B%5Cn%09%09vec3%20B%20%3D%20q1perp%20%2A%20st0.y%20%2B%20q0perp%20%2A%20st1.y%3B%5Cn%09%09float%20det%20%3D%20max%28%20dot%28%20T%2C%20T%20%29%2C%20dot%28%20B%2C%20B%20%29%20%29%3B%5Cn%09%09float%20scale%20%3D%20%28%20det%20%3D%3D%200.0%20%29%20%3F%200.0%20%3A%20inversesqrt%28%20det%20%29%3B%5Cn%09%09return%20mat3%28%20T%20%2A%20scale%2C%20B%20%2A%20scale%2C%20N%20%29%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20clearcoat_normal_fragment_begin%20%3D%20%22%23ifdef%20USE_CLEARCOAT%5Cn%09vec3%20clearcoatNormal%20%3D%20nonPerturbedNormal%3B%5Cn%23endif%22%3B%0Avar%20clearcoat_normal_fragment_maps%20%3D%20%22%23ifdef%20USE_CLEARCOAT_NORMALMAP%5Cn%09vec3%20clearcoatMapN%20%3D%20texture2D%28%20clearcoatNormalMap%2C%20vClearcoatNormalMapUv%20%29.xyz%20%2A%202.0%20-%201.0%3B%5Cn%09clearcoatMapN.xy%20%2A%3D%20clearcoatNormalScale%3B%5Cn%09clearcoatNormal%20%3D%20normalize%28%20tbn2%20%2A%20clearcoatMapN%20%29%3B%5Cn%23endif%22%3B%0Avar%20clearcoat_pars_fragment%20%3D%20%22%23ifdef%20USE_CLEARCOATMAP%5Cn%09uniform%20sampler2D%20clearcoatMap%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT_NORMALMAP%5Cn%09uniform%20sampler2D%20clearcoatNormalMap%3B%5Cn%09uniform%20vec2%20clearcoatNormalScale%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT_ROUGHNESSMAP%5Cn%09uniform%20sampler2D%20clearcoatRoughnessMap%3B%5Cn%23endif%22%3B%0Avar%20iridescence_pars_fragment%20%3D%20%22%23ifdef%20USE_IRIDESCENCEMAP%5Cn%09uniform%20sampler2D%20iridescenceMap%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCE_THICKNESSMAP%5Cn%09uniform%20sampler2D%20iridescenceThicknessMap%3B%5Cn%23endif%22%3B%0Avar%20opaque_fragment%20%3D%20%22%23ifdef%20OPAQUE%5CndiffuseColor.a%20%3D%201.0%3B%5Cn%23endif%5Cn%23ifdef%20USE_TRANSMISSION%5CndiffuseColor.a%20%2A%3D%20material.transmissionAlpha%3B%5Cn%23endif%5Cngl_FragColor%20%3D%20vec4%28%20outgoingLight%2C%20diffuseColor.a%20%29%3B%22%3B%0Avar%20packing%20%3D%20%22vec3%20packNormalToRGB%28%20const%20in%20vec3%20normal%20%29%20%7B%5Cn%09return%20normalize%28%20normal%20%29%20%2A%200.5%20%2B%200.5%3B%5Cn%7D%5Cnvec3%20unpackRGBToNormal%28%20const%20in%20vec3%20rgb%20%29%20%7B%5Cn%09return%202.0%20%2A%20rgb.xyz%20-%201.0%3B%5Cn%7D%5Cnconst%20float%20PackUpscale%20%3D%20256.%20%2F%20255.%3Bconst%20float%20UnpackDownscale%20%3D%20255.%20%2F%20256.%3Bconst%20float%20ShiftRight8%20%3D%201.%20%2F%20256.%3B%5Cnconst%20float%20Inv255%20%3D%201.%20%2F%20255.%3B%5Cnconst%20vec4%20PackFactors%20%3D%20vec4%28%201.0%2C%20256.0%2C%20256.0%20%2A%20256.0%2C%20256.0%20%2A%20256.0%20%2A%20256.0%20%29%3B%5Cnconst%20vec2%20UnpackFactors2%20%3D%20vec2%28%20UnpackDownscale%2C%201.0%20%2F%20PackFactors.g%20%29%3B%5Cnconst%20vec3%20UnpackFactors3%20%3D%20vec3%28%20UnpackDownscale%20%2F%20PackFactors.rg%2C%201.0%20%2F%20PackFactors.b%20%29%3B%5Cnconst%20vec4%20UnpackFactors4%20%3D%20vec4%28%20UnpackDownscale%20%2F%20PackFactors.rgb%2C%201.0%20%2F%20PackFactors.a%20%29%3B%5Cnvec4%20packDepthToRGBA%28%20const%20in%20float%20v%20%29%20%7B%5Cn%09if%28%20v%20%3C%3D%200.0%20%29%5Cn%09%09return%20vec4%28%200.%2C%200.%2C%200.%2C%200.%20%29%3B%5Cn%09if%28%20v%20%3E%3D%201.0%20%29%5Cn%09%09return%20vec4%28%201.%2C%201.%2C%201.%2C%201.%20%29%3B%5Cn%09float%20vuf%3B%5Cn%09float%20af%20%3D%20modf%28%20v%20%2A%20PackFactors.a%2C%20vuf%20%29%3B%5Cn%09float%20bf%20%3D%20modf%28%20vuf%20%2A%20ShiftRight8%2C%20vuf%20%29%3B%5Cn%09float%20gf%20%3D%20modf%28%20vuf%20%2A%20ShiftRight8%2C%20vuf%20%29%3B%5Cn%09return%20vec4%28%20vuf%20%2A%20Inv255%2C%20gf%20%2A%20PackUpscale%2C%20bf%20%2A%20PackUpscale%2C%20af%20%29%3B%5Cn%7D%5Cnvec3%20packDepthToRGB%28%20const%20in%20float%20v%20%29%20%7B%5Cn%09if%28%20v%20%3C%3D%200.0%20%29%5Cn%09%09return%20vec3%28%200.%2C%200.%2C%200.%20%29%3B%5Cn%09if%28%20v%20%3E%3D%201.0%20%29%5Cn%09%09return%20vec3%28%201.%2C%201.%2C%201.%20%29%3B%5Cn%09float%20vuf%3B%5Cn%09float%20bf%20%3D%20modf%28%20v%20%2A%20PackFactors.b%2C%20vuf%20%29%3B%5Cn%09float%20gf%20%3D%20modf%28%20vuf%20%2A%20ShiftRight8%2C%20vuf%20%29%3B%5Cn%09return%20vec3%28%20vuf%20%2A%20Inv255%2C%20gf%20%2A%20PackUpscale%2C%20bf%20%29%3B%5Cn%7D%5Cnvec2%20packDepthToRG%28%20const%20in%20float%20v%20%29%20%7B%5Cn%09if%28%20v%20%3C%3D%200.0%20%29%5Cn%09%09return%20vec2%28%200.%2C%200.%20%29%3B%5Cn%09if%28%20v%20%3E%3D%201.0%20%29%5Cn%09%09return%20vec2%28%201.%2C%201.%20%29%3B%5Cn%09float%20vuf%3B%5Cn%09float%20gf%20%3D%20modf%28%20v%20%2A%20256.%2C%20vuf%20%29%3B%5Cn%09return%20vec2%28%20vuf%20%2A%20Inv255%2C%20gf%20%29%3B%5Cn%7D%5Cnfloat%20unpackRGBAToDepth%28%20const%20in%20vec4%20v%20%29%20%7B%5Cn%09return%20dot%28%20v%2C%20UnpackFactors4%20%29%3B%5Cn%7D%5Cnfloat%20unpackRGBToDepth%28%20const%20in%20vec3%20v%20%29%20%7B%5Cn%09return%20dot%28%20v%2C%20UnpackFactors3%20%29%3B%5Cn%7D%5Cnfloat%20unpackRGToDepth%28%20const%20in%20vec2%20v%20%29%20%7B%5Cn%09return%20v.r%20%2A%20UnpackFactors2.r%20%2B%20v.g%20%2A%20UnpackFactors2.g%3B%5Cn%7D%5Cnvec4%20pack2HalfToRGBA%28%20const%20in%20vec2%20v%20%29%20%7B%5Cn%09vec4%20r%20%3D%20vec4%28%20v.x%2C%20fract%28%20v.x%20%2A%20255.0%20%29%2C%20v.y%2C%20fract%28%20v.y%20%2A%20255.0%20%29%20%29%3B%5Cn%09return%20vec4%28%20r.x%20-%20r.y%20%2F%20255.0%2C%20r.y%2C%20r.z%20-%20r.w%20%2F%20255.0%2C%20r.w%20%29%3B%5Cn%7D%5Cnvec2%20unpackRGBATo2Half%28%20const%20in%20vec4%20v%20%29%20%7B%5Cn%09return%20vec2%28%20v.x%20%2B%20%28%20v.y%20%2F%20255.0%20%29%2C%20v.z%20%2B%20%28%20v.w%20%2F%20255.0%20%29%20%29%3B%5Cn%7D%5Cnfloat%20viewZToOrthographicDepth%28%20const%20in%20float%20viewZ%2C%20const%20in%20float%20near%2C%20const%20in%20float%20far%20%29%20%7B%5Cn%09return%20%28%20viewZ%20%2B%20near%20%29%20%2F%20%28%20near%20-%20far%20%29%3B%5Cn%7D%5Cnfloat%20orthographicDepthToViewZ%28%20const%20in%20float%20depth%2C%20const%20in%20float%20near%2C%20const%20in%20float%20far%20%29%20%7B%5Cn%09return%20depth%20%2A%20%28%20near%20-%20far%20%29%20-%20near%3B%5Cn%7D%5Cnfloat%20viewZToPerspectiveDepth%28%20const%20in%20float%20viewZ%2C%20const%20in%20float%20near%2C%20const%20in%20float%20far%20%29%20%7B%5Cn%09return%20%28%20%28%20near%20%2B%20viewZ%20%29%20%2A%20far%20%29%20%2F%20%28%20%28%20far%20-%20near%20%29%20%2A%20viewZ%20%29%3B%5Cn%7D%5Cnfloat%20perspectiveDepthToViewZ%28%20const%20in%20float%20depth%2C%20const%20in%20float%20near%2C%20const%20in%20float%20far%20%29%20%7B%5Cn%09return%20%28%20near%20%2A%20far%20%29%20%2F%20%28%20%28%20far%20-%20near%20%29%20%2A%20depth%20-%20far%20%29%3B%5Cn%7D%22%3B%0Avar%20premultiplied_alpha_fragment%20%3D%20%22%23ifdef%20PREMULTIPLIED_ALPHA%5Cn%09gl_FragColor.rgb%20%2A%3D%20gl_FragColor.a%3B%5Cn%23endif%22%3B%0Avar%20project_vertex%20%3D%20%22vec4%20mvPosition%20%3D%20vec4%28%20transformed%2C%201.0%20%29%3B%5Cn%23ifdef%20USE_BATCHING%5Cn%09mvPosition%20%3D%20batchingMatrix%20%2A%20mvPosition%3B%5Cn%23endif%5Cn%23ifdef%20USE_INSTANCING%5Cn%09mvPosition%20%3D%20instanceMatrix%20%2A%20mvPosition%3B%5Cn%23endif%5CnmvPosition%20%3D%20modelViewMatrix%20%2A%20mvPosition%3B%5Cngl_Position%20%3D%20projectionMatrix%20%2A%20mvPosition%3B%22%3B%0Avar%20dithering_fragment%20%3D%20%22%23ifdef%20DITHERING%5Cn%09gl_FragColor.rgb%20%3D%20dithering%28%20gl_FragColor.rgb%20%29%3B%5Cn%23endif%22%3B%0Avar%20dithering_pars_fragment%20%3D%20%22%23ifdef%20DITHERING%5Cn%09vec3%20dithering%28%20vec3%20color%20%29%20%7B%5Cn%09%09float%20grid_position%20%3D%20rand%28%20gl_FragCoord.xy%20%29%3B%5Cn%09%09vec3%20dither_shift_RGB%20%3D%20vec3%28%200.25%20%2F%20255.0%2C%20-0.25%20%2F%20255.0%2C%200.25%20%2F%20255.0%20%29%3B%5Cn%09%09dither_shift_RGB%20%3D%20mix%28%202.0%20%2A%20dither_shift_RGB%2C%20-2.0%20%2A%20dither_shift_RGB%2C%20grid_position%20%29%3B%5Cn%09%09return%20color%20%2B%20dither_shift_RGB%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20roughnessmap_fragment%20%3D%20%22float%20roughnessFactor%20%3D%20roughness%3B%5Cn%23ifdef%20USE_ROUGHNESSMAP%5Cn%09vec4%20texelRoughness%20%3D%20texture2D%28%20roughnessMap%2C%20vRoughnessMapUv%20%29%3B%5Cn%09roughnessFactor%20%2A%3D%20texelRoughness.g%3B%5Cn%23endif%22%3B%0Avar%20roughnessmap_pars_fragment%20%3D%20%22%23ifdef%20USE_ROUGHNESSMAP%5Cn%09uniform%20sampler2D%20roughnessMap%3B%5Cn%23endif%22%3B%0Avar%20shadowmap_pars_fragment%20%3D%20%22%23if%20NUM_SPOT_LIGHT_COORDS%20%3E%200%5Cn%09varying%20vec4%20vSpotLightCoord%5B%20NUM_SPOT_LIGHT_COORDS%20%5D%3B%5Cn%23endif%5Cn%23if%20NUM_SPOT_LIGHT_MAPS%20%3E%200%5Cn%09uniform%20sampler2D%20spotLightMap%5B%20NUM_SPOT_LIGHT_MAPS%20%5D%3B%5Cn%23endif%5Cn%23ifdef%20USE_SHADOWMAP%5Cn%09%23if%20NUM_DIR_LIGHT_SHADOWS%20%3E%200%5Cn%09%09uniform%20sampler2D%20directionalShadowMap%5B%20NUM_DIR_LIGHT_SHADOWS%20%5D%3B%5Cn%09%09varying%20vec4%20vDirectionalShadowCoord%5B%20NUM_DIR_LIGHT_SHADOWS%20%5D%3B%5Cn%09%09struct%20DirectionalLightShadow%20%7B%5Cn%09%09%09float%20shadowIntensity%3B%5Cn%09%09%09float%20shadowBias%3B%5Cn%09%09%09float%20shadowNormalBias%3B%5Cn%09%09%09float%20shadowRadius%3B%5Cn%09%09%09vec2%20shadowMapSize%3B%5Cn%09%09%7D%3B%5Cn%09%09uniform%20DirectionalLightShadow%20directionalLightShadows%5B%20NUM_DIR_LIGHT_SHADOWS%20%5D%3B%5Cn%09%23endif%5Cn%09%23if%20NUM_SPOT_LIGHT_SHADOWS%20%3E%200%5Cn%09%09uniform%20sampler2D%20spotShadowMap%5B%20NUM_SPOT_LIGHT_SHADOWS%20%5D%3B%5Cn%09%09struct%20SpotLightShadow%20%7B%5Cn%09%09%09float%20shadowIntensity%3B%5Cn%09%09%09float%20shadowBias%3B%5Cn%09%09%09float%20shadowNormalBias%3B%5Cn%09%09%09float%20shadowRadius%3B%5Cn%09%09%09vec2%20shadowMapSize%3B%5Cn%09%09%7D%3B%5Cn%09%09uniform%20SpotLightShadow%20spotLightShadows%5B%20NUM_SPOT_LIGHT_SHADOWS%20%5D%3B%5Cn%09%23endif%5Cn%09%23if%20NUM_POINT_LIGHT_SHADOWS%20%3E%200%5Cn%09%09uniform%20sampler2D%20pointShadowMap%5B%20NUM_POINT_LIGHT_SHADOWS%20%5D%3B%5Cn%09%09varying%20vec4%20vPointShadowCoord%5B%20NUM_POINT_LIGHT_SHADOWS%20%5D%3B%5Cn%09%09struct%20PointLightShadow%20%7B%5Cn%09%09%09float%20shadowIntensity%3B%5Cn%09%09%09float%20shadowBias%3B%5Cn%09%09%09float%20shadowNormalBias%3B%5Cn%09%09%09float%20shadowRadius%3B%5Cn%09%09%09vec2%20shadowMapSize%3B%5Cn%09%09%09float%20shadowCameraNear%3B%5Cn%09%09%09float%20shadowCameraFar%3B%5Cn%09%09%7D%3B%5Cn%09%09uniform%20PointLightShadow%20pointLightShadows%5B%20NUM_POINT_LIGHT_SHADOWS%20%5D%3B%5Cn%09%23endif%5Cn%09float%20texture2DCompare%28%20sampler2D%20depths%2C%20vec2%20uv%2C%20float%20compare%20%29%20%7B%5Cn%09%09return%20step%28%20compare%2C%20unpackRGBAToDepth%28%20texture2D%28%20depths%2C%20uv%20%29%20%29%20%29%3B%5Cn%09%7D%5Cn%09vec2%20texture2DDistribution%28%20sampler2D%20shadow%2C%20vec2%20uv%20%29%20%7B%5Cn%09%09return%20unpackRGBATo2Half%28%20texture2D%28%20shadow%2C%20uv%20%29%20%29%3B%5Cn%09%7D%5Cn%09float%20VSMShadow%20%28sampler2D%20shadow%2C%20vec2%20uv%2C%20float%20compare%20%29%7B%5Cn%09%09float%20occlusion%20%3D%201.0%3B%5Cn%09%09vec2%20distribution%20%3D%20texture2DDistribution%28%20shadow%2C%20uv%20%29%3B%5Cn%09%09float%20hard_shadow%20%3D%20step%28%20compare%20%2C%20distribution.x%20%29%3B%5Cn%09%09if%20%28hard_shadow%20%21%3D%201.0%20%29%20%7B%5Cn%09%09%09float%20distance%20%3D%20compare%20-%20distribution.x%20%3B%5Cn%09%09%09float%20variance%20%3D%20max%28%200.00000%2C%20distribution.y%20%2A%20distribution.y%20%29%3B%5Cn%09%09%09float%20softness_probability%20%3D%20variance%20%2F%20%28variance%20%2B%20distance%20%2A%20distance%20%29%3B%09%09%09softness_probability%20%3D%20clamp%28%20%28%20softness_probability%20-%200.3%20%29%20%2F%20%28%200.95%20-%200.3%20%29%2C%200.0%2C%201.0%20%29%3B%09%09%09occlusion%20%3D%20clamp%28%20max%28%20hard_shadow%2C%20softness_probability%20%29%2C%200.0%2C%201.0%20%29%3B%5Cn%09%09%7D%5Cn%09%09return%20occlusion%3B%5Cn%09%7D%5Cn%09float%20getShadow%28%20sampler2D%20shadowMap%2C%20vec2%20shadowMapSize%2C%20float%20shadowIntensity%2C%20float%20shadowBias%2C%20float%20shadowRadius%2C%20vec4%20shadowCoord%20%29%20%7B%5Cn%09%09float%20shadow%20%3D%201.0%3B%5Cn%09%09shadowCoord.xyz%20%2F%3D%20shadowCoord.w%3B%5Cn%09%09shadowCoord.z%20%2B%3D%20shadowBias%3B%5Cn%09%09bool%20inFrustum%20%3D%20shadowCoord.x%20%3E%3D%200.0%20%26%26%20shadowCoord.x%20%3C%3D%201.0%20%26%26%20shadowCoord.y%20%3E%3D%200.0%20%26%26%20shadowCoord.y%20%3C%3D%201.0%3B%5Cn%09%09bool%20frustumTest%20%3D%20inFrustum%20%26%26%20shadowCoord.z%20%3C%3D%201.0%3B%5Cn%09%09if%20%28%20frustumTest%20%29%20%7B%5Cn%09%09%23if%20defined%28%20SHADOWMAP_TYPE_PCF%20%29%5Cn%09%09%09vec2%20texelSize%20%3D%20vec2%28%201.0%20%29%20%2F%20shadowMapSize%3B%5Cn%09%09%09float%20dx0%20%3D%20-%20texelSize.x%20%2A%20shadowRadius%3B%5Cn%09%09%09float%20dy0%20%3D%20-%20texelSize.y%20%2A%20shadowRadius%3B%5Cn%09%09%09float%20dx1%20%3D%20%2B%20texelSize.x%20%2A%20shadowRadius%3B%5Cn%09%09%09float%20dy1%20%3D%20%2B%20texelSize.y%20%2A%20shadowRadius%3B%5Cn%09%09%09float%20dx2%20%3D%20dx0%20%2F%202.0%3B%5Cn%09%09%09float%20dy2%20%3D%20dy0%20%2F%202.0%3B%5Cn%09%09%09float%20dx3%20%3D%20dx1%20%2F%202.0%3B%5Cn%09%09%09float%20dy3%20%3D%20dy1%20%2F%202.0%3B%5Cn%09%09%09shadow%20%3D%20%28%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx0%2C%20dy0%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%200.0%2C%20dy0%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx1%2C%20dy0%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx2%2C%20dy2%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%200.0%2C%20dy2%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx3%2C%20dy2%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx0%2C%200.0%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx2%2C%200.0%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx3%2C%200.0%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx1%2C%200.0%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx2%2C%20dy3%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%200.0%2C%20dy3%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx3%2C%20dy3%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx0%2C%20dy1%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%200.0%2C%20dy1%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%20%2B%20vec2%28%20dx1%2C%20dy1%20%29%2C%20shadowCoord.z%20%29%5Cn%09%09%09%29%20%2A%20%28%201.0%20%2F%2017.0%20%29%3B%5Cn%09%09%23elif%20defined%28%20SHADOWMAP_TYPE_PCF_SOFT%20%29%5Cn%09%09%09vec2%20texelSize%20%3D%20vec2%28%201.0%20%29%20%2F%20shadowMapSize%3B%5Cn%09%09%09float%20dx%20%3D%20texelSize.x%3B%5Cn%09%09%09float%20dy%20%3D%20texelSize.y%3B%5Cn%09%09%09vec2%20uv%20%3D%20shadowCoord.xy%3B%5Cn%09%09%09vec2%20f%20%3D%20fract%28%20uv%20%2A%20shadowMapSize%20%2B%200.5%20%29%3B%5Cn%09%09%09uv%20-%3D%20f%20%2A%20texelSize%3B%5Cn%09%09%09shadow%20%3D%20%28%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20uv%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%20dx%2C%200.0%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%200.0%2C%20dy%20%29%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20texelSize%2C%20shadowCoord.z%20%29%20%2B%5Cn%09%09%09%09mix%28%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%20-dx%2C%200.0%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%202.0%20%2A%20dx%2C%200.0%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%20f.x%20%29%20%2B%5Cn%09%09%09%09mix%28%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%20-dx%2C%20dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%202.0%20%2A%20dx%2C%20dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%20f.x%20%29%20%2B%5Cn%09%09%09%09mix%28%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%200.0%2C%20-dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%200.0%2C%202.0%20%2A%20dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%20f.y%20%29%20%2B%5Cn%09%09%09%09mix%28%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%20dx%2C%20-dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%20dx%2C%202.0%20%2A%20dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%20f.y%20%29%20%2B%5Cn%09%09%09%09mix%28%20mix%28%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%20-dx%2C%20-dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%09%20%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%202.0%20%2A%20dx%2C%20-dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%09%20%20f.x%20%29%2C%5Cn%09%09%09%09%09%20mix%28%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%20-dx%2C%202.0%20%2A%20dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%09%20%20texture2DCompare%28%20shadowMap%2C%20uv%20%2B%20vec2%28%202.0%20%2A%20dx%2C%202.0%20%2A%20dy%20%29%2C%20shadowCoord.z%20%29%2C%5Cn%09%09%09%09%09%09%20%20f.x%20%29%2C%5Cn%09%09%09%09%09%20f.y%20%29%5Cn%09%09%09%29%20%2A%20%28%201.0%20%2F%209.0%20%29%3B%5Cn%09%09%23elif%20defined%28%20SHADOWMAP_TYPE_VSM%20%29%5Cn%09%09%09shadow%20%3D%20VSMShadow%28%20shadowMap%2C%20shadowCoord.xy%2C%20shadowCoord.z%20%29%3B%5Cn%09%09%23else%5Cn%09%09%09shadow%20%3D%20texture2DCompare%28%20shadowMap%2C%20shadowCoord.xy%2C%20shadowCoord.z%20%29%3B%5Cn%09%09%23endif%5Cn%09%09%7D%5Cn%09%09return%20mix%28%201.0%2C%20shadow%2C%20shadowIntensity%20%29%3B%5Cn%09%7D%5Cn%09vec2%20cubeToUV%28%20vec3%20v%2C%20float%20texelSizeY%20%29%20%7B%5Cn%09%09vec3%20absV%20%3D%20abs%28%20v%20%29%3B%5Cn%09%09float%20scaleToCube%20%3D%201.0%20%2F%20max%28%20absV.x%2C%20max%28%20absV.y%2C%20absV.z%20%29%20%29%3B%5Cn%09%09absV%20%2A%3D%20scaleToCube%3B%5Cn%09%09v%20%2A%3D%20scaleToCube%20%2A%20%28%201.0%20-%202.0%20%2A%20texelSizeY%20%29%3B%5Cn%09%09vec2%20planar%20%3D%20v.xy%3B%5Cn%09%09float%20almostATexel%20%3D%201.5%20%2A%20texelSizeY%3B%5Cn%09%09float%20almostOne%20%3D%201.0%20-%20almostATexel%3B%5Cn%09%09if%20%28%20absV.z%20%3E%3D%20almostOne%20%29%20%7B%5Cn%09%09%09if%20%28%20v.z%20%3E%200.0%20%29%5Cn%09%09%09%09planar.x%20%3D%204.0%20-%20v.x%3B%5Cn%09%09%7D%20else%20if%20%28%20absV.x%20%3E%3D%20almostOne%20%29%20%7B%5Cn%09%09%09float%20signX%20%3D%20sign%28%20v.x%20%29%3B%5Cn%09%09%09planar.x%20%3D%20v.z%20%2A%20signX%20%2B%202.0%20%2A%20signX%3B%5Cn%09%09%7D%20else%20if%20%28%20absV.y%20%3E%3D%20almostOne%20%29%20%7B%5Cn%09%09%09float%20signY%20%3D%20sign%28%20v.y%20%29%3B%5Cn%09%09%09planar.x%20%3D%20v.x%20%2B%202.0%20%2A%20signY%20%2B%202.0%3B%5Cn%09%09%09planar.y%20%3D%20v.z%20%2A%20signY%20-%202.0%3B%5Cn%09%09%7D%5Cn%09%09return%20vec2%28%200.125%2C%200.25%20%29%20%2A%20planar%20%2B%20vec2%28%200.375%2C%200.75%20%29%3B%5Cn%09%7D%5Cn%09float%20getPointShadow%28%20sampler2D%20shadowMap%2C%20vec2%20shadowMapSize%2C%20float%20shadowIntensity%2C%20float%20shadowBias%2C%20float%20shadowRadius%2C%20vec4%20shadowCoord%2C%20float%20shadowCameraNear%2C%20float%20shadowCameraFar%20%29%20%7B%5Cn%09%09float%20shadow%20%3D%201.0%3B%5Cn%09%09vec3%20lightToPosition%20%3D%20shadowCoord.xyz%3B%5Cn%09%09%5Cn%09%09float%20lightToPositionLength%20%3D%20length%28%20lightToPosition%20%29%3B%5Cn%09%09if%20%28%20lightToPositionLength%20-%20shadowCameraFar%20%3C%3D%200.0%20%26%26%20lightToPositionLength%20-%20shadowCameraNear%20%3E%3D%200.0%20%29%20%7B%5Cn%09%09%09float%20dp%20%3D%20%28%20lightToPositionLength%20-%20shadowCameraNear%20%29%20%2F%20%28%20shadowCameraFar%20-%20shadowCameraNear%20%29%3B%09%09%09dp%20%2B%3D%20shadowBias%3B%5Cn%09%09%09vec3%20bd3D%20%3D%20normalize%28%20lightToPosition%20%29%3B%5Cn%09%09%09vec2%20texelSize%20%3D%20vec2%28%201.0%20%29%20%2F%20%28%20shadowMapSize%20%2A%20vec2%28%204.0%2C%202.0%20%29%20%29%3B%5Cn%09%09%09%23if%20defined%28%20SHADOWMAP_TYPE_PCF%20%29%20%7C%7C%20defined%28%20SHADOWMAP_TYPE_PCF_SOFT%20%29%20%7C%7C%20defined%28%20SHADOWMAP_TYPE_VSM%20%29%5Cn%09%09%09%09vec2%20offset%20%3D%20vec2%28%20-%201%2C%201%20%29%20%2A%20shadowRadius%20%2A%20texelSize.y%3B%5Cn%09%09%09%09shadow%20%3D%20%28%5Cn%09%09%09%09%09texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%20%2B%20offset.xyy%2C%20texelSize.y%20%29%2C%20dp%20%29%20%2B%5Cn%09%09%09%09%09texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%20%2B%20offset.yyy%2C%20texelSize.y%20%29%2C%20dp%20%29%20%2B%5Cn%09%09%09%09%09texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%20%2B%20offset.xyx%2C%20texelSize.y%20%29%2C%20dp%20%29%20%2B%5Cn%09%09%09%09%09texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%20%2B%20offset.yyx%2C%20texelSize.y%20%29%2C%20dp%20%29%20%2B%5Cn%09%09%09%09%09texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%2C%20texelSize.y%20%29%2C%20dp%20%29%20%2B%5Cn%09%09%09%09%09texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%20%2B%20offset.xxy%2C%20texelSize.y%20%29%2C%20dp%20%29%20%2B%5Cn%09%09%09%09%09texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%20%2B%20offset.yxy%2C%20texelSize.y%20%29%2C%20dp%20%29%20%2B%5Cn%09%09%09%09%09texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%20%2B%20offset.xxx%2C%20texelSize.y%20%29%2C%20dp%20%29%20%2B%5Cn%09%09%09%09%09texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%20%2B%20offset.yxx%2C%20texelSize.y%20%29%2C%20dp%20%29%5Cn%09%09%09%09%29%20%2A%20%28%201.0%20%2F%209.0%20%29%3B%5Cn%09%09%09%23else%5Cn%09%09%09%09shadow%20%3D%20texture2DCompare%28%20shadowMap%2C%20cubeToUV%28%20bd3D%2C%20texelSize.y%20%29%2C%20dp%20%29%3B%5Cn%09%09%09%23endif%5Cn%09%09%7D%5Cn%09%09return%20mix%28%201.0%2C%20shadow%2C%20shadowIntensity%20%29%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20shadowmap_pars_vertex%20%3D%20%22%23if%20NUM_SPOT_LIGHT_COORDS%20%3E%200%5Cn%09uniform%20mat4%20spotLightMatrix%5B%20NUM_SPOT_LIGHT_COORDS%20%5D%3B%5Cn%09varying%20vec4%20vSpotLightCoord%5B%20NUM_SPOT_LIGHT_COORDS%20%5D%3B%5Cn%23endif%5Cn%23ifdef%20USE_SHADOWMAP%5Cn%09%23if%20NUM_DIR_LIGHT_SHADOWS%20%3E%200%5Cn%09%09uniform%20mat4%20directionalShadowMatrix%5B%20NUM_DIR_LIGHT_SHADOWS%20%5D%3B%5Cn%09%09varying%20vec4%20vDirectionalShadowCoord%5B%20NUM_DIR_LIGHT_SHADOWS%20%5D%3B%5Cn%09%09struct%20DirectionalLightShadow%20%7B%5Cn%09%09%09float%20shadowIntensity%3B%5Cn%09%09%09float%20shadowBias%3B%5Cn%09%09%09float%20shadowNormalBias%3B%5Cn%09%09%09float%20shadowRadius%3B%5Cn%09%09%09vec2%20shadowMapSize%3B%5Cn%09%09%7D%3B%5Cn%09%09uniform%20DirectionalLightShadow%20directionalLightShadows%5B%20NUM_DIR_LIGHT_SHADOWS%20%5D%3B%5Cn%09%23endif%5Cn%09%23if%20NUM_SPOT_LIGHT_SHADOWS%20%3E%200%5Cn%09%09struct%20SpotLightShadow%20%7B%5Cn%09%09%09float%20shadowIntensity%3B%5Cn%09%09%09float%20shadowBias%3B%5Cn%09%09%09float%20shadowNormalBias%3B%5Cn%09%09%09float%20shadowRadius%3B%5Cn%09%09%09vec2%20shadowMapSize%3B%5Cn%09%09%7D%3B%5Cn%09%09uniform%20SpotLightShadow%20spotLightShadows%5B%20NUM_SPOT_LIGHT_SHADOWS%20%5D%3B%5Cn%09%23endif%5Cn%09%23if%20NUM_POINT_LIGHT_SHADOWS%20%3E%200%5Cn%09%09uniform%20mat4%20pointShadowMatrix%5B%20NUM_POINT_LIGHT_SHADOWS%20%5D%3B%5Cn%09%09varying%20vec4%20vPointShadowCoord%5B%20NUM_POINT_LIGHT_SHADOWS%20%5D%3B%5Cn%09%09struct%20PointLightShadow%20%7B%5Cn%09%09%09float%20shadowIntensity%3B%5Cn%09%09%09float%20shadowBias%3B%5Cn%09%09%09float%20shadowNormalBias%3B%5Cn%09%09%09float%20shadowRadius%3B%5Cn%09%09%09vec2%20shadowMapSize%3B%5Cn%09%09%09float%20shadowCameraNear%3B%5Cn%09%09%09float%20shadowCameraFar%3B%5Cn%09%09%7D%3B%5Cn%09%09uniform%20PointLightShadow%20pointLightShadows%5B%20NUM_POINT_LIGHT_SHADOWS%20%5D%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20shadowmap_vertex%20%3D%20%22%23if%20%28%20defined%28%20USE_SHADOWMAP%20%29%20%26%26%20%28%20NUM_DIR_LIGHT_SHADOWS%20%3E%200%20%7C%7C%20NUM_POINT_LIGHT_SHADOWS%20%3E%200%20%29%20%29%20%7C%7C%20%28%20NUM_SPOT_LIGHT_COORDS%20%3E%200%20%29%5Cn%09vec3%20shadowWorldNormal%20%3D%20inverseTransformDirection%28%20transformedNormal%2C%20viewMatrix%20%29%3B%5Cn%09vec4%20shadowWorldPosition%3B%5Cn%23endif%5Cn%23if%20defined%28%20USE_SHADOWMAP%20%29%5Cn%09%23if%20NUM_DIR_LIGHT_SHADOWS%20%3E%200%5Cn%09%09%23pragma%20unroll_loop_start%5Cn%09%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_DIR_LIGHT_SHADOWS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09%09shadowWorldPosition%20%3D%20worldPosition%20%2B%20vec4%28%20shadowWorldNormal%20%2A%20directionalLightShadows%5B%20i%20%5D.shadowNormalBias%2C%200%20%29%3B%5Cn%09%09%09vDirectionalShadowCoord%5B%20i%20%5D%20%3D%20directionalShadowMatrix%5B%20i%20%5D%20%2A%20shadowWorldPosition%3B%5Cn%09%09%7D%5Cn%09%09%23pragma%20unroll_loop_end%5Cn%09%23endif%5Cn%09%23if%20NUM_POINT_LIGHT_SHADOWS%20%3E%200%5Cn%09%09%23pragma%20unroll_loop_start%5Cn%09%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_POINT_LIGHT_SHADOWS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09%09shadowWorldPosition%20%3D%20worldPosition%20%2B%20vec4%28%20shadowWorldNormal%20%2A%20pointLightShadows%5B%20i%20%5D.shadowNormalBias%2C%200%20%29%3B%5Cn%09%09%09vPointShadowCoord%5B%20i%20%5D%20%3D%20pointShadowMatrix%5B%20i%20%5D%20%2A%20shadowWorldPosition%3B%5Cn%09%09%7D%5Cn%09%09%23pragma%20unroll_loop_end%5Cn%09%23endif%5Cn%23endif%5Cn%23if%20NUM_SPOT_LIGHT_COORDS%20%3E%200%5Cn%09%23pragma%20unroll_loop_start%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_SPOT_LIGHT_COORDS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09shadowWorldPosition%20%3D%20worldPosition%3B%5Cn%09%09%23if%20%28%20defined%28%20USE_SHADOWMAP%20%29%20%26%26%20UNROLLED_LOOP_INDEX%20%3C%20NUM_SPOT_LIGHT_SHADOWS%20%29%5Cn%09%09%09shadowWorldPosition.xyz%20%2B%3D%20shadowWorldNormal%20%2A%20spotLightShadows%5B%20i%20%5D.shadowNormalBias%3B%5Cn%09%09%23endif%5Cn%09%09vSpotLightCoord%5B%20i%20%5D%20%3D%20spotLightMatrix%5B%20i%20%5D%20%2A%20shadowWorldPosition%3B%5Cn%09%7D%5Cn%09%23pragma%20unroll_loop_end%5Cn%23endif%22%3B%0Avar%20shadowmask_pars_fragment%20%3D%20%22float%20getShadowMask%28%29%20%7B%5Cn%09float%20shadow%20%3D%201.0%3B%5Cn%09%23ifdef%20USE_SHADOWMAP%5Cn%09%23if%20NUM_DIR_LIGHT_SHADOWS%20%3E%200%5Cn%09DirectionalLightShadow%20directionalLight%3B%5Cn%09%23pragma%20unroll_loop_start%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_DIR_LIGHT_SHADOWS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09directionalLight%20%3D%20directionalLightShadows%5B%20i%20%5D%3B%5Cn%09%09shadow%20%2A%3D%20receiveShadow%20%3F%20getShadow%28%20directionalShadowMap%5B%20i%20%5D%2C%20directionalLight.shadowMapSize%2C%20directionalLight.shadowIntensity%2C%20directionalLight.shadowBias%2C%20directionalLight.shadowRadius%2C%20vDirectionalShadowCoord%5B%20i%20%5D%20%29%20%3A%201.0%3B%5Cn%09%7D%5Cn%09%23pragma%20unroll_loop_end%5Cn%09%23endif%5Cn%09%23if%20NUM_SPOT_LIGHT_SHADOWS%20%3E%200%5Cn%09SpotLightShadow%20spotLight%3B%5Cn%09%23pragma%20unroll_loop_start%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_SPOT_LIGHT_SHADOWS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09spotLight%20%3D%20spotLightShadows%5B%20i%20%5D%3B%5Cn%09%09shadow%20%2A%3D%20receiveShadow%20%3F%20getShadow%28%20spotShadowMap%5B%20i%20%5D%2C%20spotLight.shadowMapSize%2C%20spotLight.shadowIntensity%2C%20spotLight.shadowBias%2C%20spotLight.shadowRadius%2C%20vSpotLightCoord%5B%20i%20%5D%20%29%20%3A%201.0%3B%5Cn%09%7D%5Cn%09%23pragma%20unroll_loop_end%5Cn%09%23endif%5Cn%09%23if%20NUM_POINT_LIGHT_SHADOWS%20%3E%200%5Cn%09PointLightShadow%20pointLight%3B%5Cn%09%23pragma%20unroll_loop_start%5Cn%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%20NUM_POINT_LIGHT_SHADOWS%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09pointLight%20%3D%20pointLightShadows%5B%20i%20%5D%3B%5Cn%09%09shadow%20%2A%3D%20receiveShadow%20%3F%20getPointShadow%28%20pointShadowMap%5B%20i%20%5D%2C%20pointLight.shadowMapSize%2C%20pointLight.shadowIntensity%2C%20pointLight.shadowBias%2C%20pointLight.shadowRadius%2C%20vPointShadowCoord%5B%20i%20%5D%2C%20pointLight.shadowCameraNear%2C%20pointLight.shadowCameraFar%20%29%20%3A%201.0%3B%5Cn%09%7D%5Cn%09%23pragma%20unroll_loop_end%5Cn%09%23endif%5Cn%09%23endif%5Cn%09return%20shadow%3B%5Cn%7D%22%3B%0Avar%20skinbase_vertex%20%3D%20%22%23ifdef%20USE_SKINNING%5Cn%09mat4%20boneMatX%20%3D%20getBoneMatrix%28%20skinIndex.x%20%29%3B%5Cn%09mat4%20boneMatY%20%3D%20getBoneMatrix%28%20skinIndex.y%20%29%3B%5Cn%09mat4%20boneMatZ%20%3D%20getBoneMatrix%28%20skinIndex.z%20%29%3B%5Cn%09mat4%20boneMatW%20%3D%20getBoneMatrix%28%20skinIndex.w%20%29%3B%5Cn%23endif%22%3B%0Avar%20skinning_pars_vertex%20%3D%20%22%23ifdef%20USE_SKINNING%5Cn%09uniform%20mat4%20bindMatrix%3B%5Cn%09uniform%20mat4%20bindMatrixInverse%3B%5Cn%09uniform%20highp%20sampler2D%20boneTexture%3B%5Cn%09mat4%20getBoneMatrix%28%20const%20in%20float%20i%20%29%20%7B%5Cn%09%09int%20size%20%3D%20textureSize%28%20boneTexture%2C%200%20%29.x%3B%5Cn%09%09int%20j%20%3D%20int%28%20i%20%29%20%2A%204%3B%5Cn%09%09int%20x%20%3D%20j%20%25%20size%3B%5Cn%09%09int%20y%20%3D%20j%20%2F%20size%3B%5Cn%09%09vec4%20v1%20%3D%20texelFetch%28%20boneTexture%2C%20ivec2%28%20x%2C%20y%20%29%2C%200%20%29%3B%5Cn%09%09vec4%20v2%20%3D%20texelFetch%28%20boneTexture%2C%20ivec2%28%20x%20%2B%201%2C%20y%20%29%2C%200%20%29%3B%5Cn%09%09vec4%20v3%20%3D%20texelFetch%28%20boneTexture%2C%20ivec2%28%20x%20%2B%202%2C%20y%20%29%2C%200%20%29%3B%5Cn%09%09vec4%20v4%20%3D%20texelFetch%28%20boneTexture%2C%20ivec2%28%20x%20%2B%203%2C%20y%20%29%2C%200%20%29%3B%5Cn%09%09return%20mat4%28%20v1%2C%20v2%2C%20v3%2C%20v4%20%29%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20skinning_vertex%20%3D%20%22%23ifdef%20USE_SKINNING%5Cn%09vec4%20skinVertex%20%3D%20bindMatrix%20%2A%20vec4%28%20transformed%2C%201.0%20%29%3B%5Cn%09vec4%20skinned%20%3D%20vec4%28%200.0%20%29%3B%5Cn%09skinned%20%2B%3D%20boneMatX%20%2A%20skinVertex%20%2A%20skinWeight.x%3B%5Cn%09skinned%20%2B%3D%20boneMatY%20%2A%20skinVertex%20%2A%20skinWeight.y%3B%5Cn%09skinned%20%2B%3D%20boneMatZ%20%2A%20skinVertex%20%2A%20skinWeight.z%3B%5Cn%09skinned%20%2B%3D%20boneMatW%20%2A%20skinVertex%20%2A%20skinWeight.w%3B%5Cn%09transformed%20%3D%20%28%20bindMatrixInverse%20%2A%20skinned%20%29.xyz%3B%5Cn%23endif%22%3B%0Avar%20skinnormal_vertex%20%3D%20%22%23ifdef%20USE_SKINNING%5Cn%09mat4%20skinMatrix%20%3D%20mat4%28%200.0%20%29%3B%5Cn%09skinMatrix%20%2B%3D%20skinWeight.x%20%2A%20boneMatX%3B%5Cn%09skinMatrix%20%2B%3D%20skinWeight.y%20%2A%20boneMatY%3B%5Cn%09skinMatrix%20%2B%3D%20skinWeight.z%20%2A%20boneMatZ%3B%5Cn%09skinMatrix%20%2B%3D%20skinWeight.w%20%2A%20boneMatW%3B%5Cn%09skinMatrix%20%3D%20bindMatrixInverse%20%2A%20skinMatrix%20%2A%20bindMatrix%3B%5Cn%09objectNormal%20%3D%20vec4%28%20skinMatrix%20%2A%20vec4%28%20objectNormal%2C%200.0%20%29%20%29.xyz%3B%5Cn%09%23ifdef%20USE_TANGENT%5Cn%09%09objectTangent%20%3D%20vec4%28%20skinMatrix%20%2A%20vec4%28%20objectTangent%2C%200.0%20%29%20%29.xyz%3B%5Cn%09%23endif%5Cn%23endif%22%3B%0Avar%20specularmap_fragment%20%3D%20%22float%20specularStrength%3B%5Cn%23ifdef%20USE_SPECULARMAP%5Cn%09vec4%20texelSpecular%20%3D%20texture2D%28%20specularMap%2C%20vSpecularMapUv%20%29%3B%5Cn%09specularStrength%20%3D%20texelSpecular.r%3B%5Cn%23else%5Cn%09specularStrength%20%3D%201.0%3B%5Cn%23endif%22%3B%0Avar%20specularmap_pars_fragment%20%3D%20%22%23ifdef%20USE_SPECULARMAP%5Cn%09uniform%20sampler2D%20specularMap%3B%5Cn%23endif%22%3B%0Avar%20tonemapping_fragment%20%3D%20%22%23if%20defined%28%20TONE_MAPPING%20%29%5Cn%09gl_FragColor.rgb%20%3D%20toneMapping%28%20gl_FragColor.rgb%20%29%3B%5Cn%23endif%22%3B%0Avar%20tonemapping_pars_fragment%20%3D%20%22%23ifndef%20saturate%5Cn%23define%20saturate%28%20a%20%29%20clamp%28%20a%2C%200.0%2C%201.0%20%29%5Cn%23endif%5Cnuniform%20float%20toneMappingExposure%3B%5Cnvec3%20LinearToneMapping%28%20vec3%20color%20%29%20%7B%5Cn%09return%20saturate%28%20toneMappingExposure%20%2A%20color%20%29%3B%5Cn%7D%5Cnvec3%20ReinhardToneMapping%28%20vec3%20color%20%29%20%7B%5Cn%09color%20%2A%3D%20toneMappingExposure%3B%5Cn%09return%20saturate%28%20color%20%2F%20%28%20vec3%28%201.0%20%29%20%2B%20color%20%29%20%29%3B%5Cn%7D%5Cnvec3%20CineonToneMapping%28%20vec3%20color%20%29%20%7B%5Cn%09color%20%2A%3D%20toneMappingExposure%3B%5Cn%09color%20%3D%20max%28%20vec3%28%200.0%20%29%2C%20color%20-%200.004%20%29%3B%5Cn%09return%20pow%28%20%28%20color%20%2A%20%28%206.2%20%2A%20color%20%2B%200.5%20%29%20%29%20%2F%20%28%20color%20%2A%20%28%206.2%20%2A%20color%20%2B%201.7%20%29%20%2B%200.06%20%29%2C%20vec3%28%202.2%20%29%20%29%3B%5Cn%7D%5Cnvec3%20RRTAndODTFit%28%20vec3%20v%20%29%20%7B%5Cn%09vec3%20a%20%3D%20v%20%2A%20%28%20v%20%2B%200.0245786%20%29%20-%200.000090537%3B%5Cn%09vec3%20b%20%3D%20v%20%2A%20%28%200.983729%20%2A%20v%20%2B%200.4329510%20%29%20%2B%200.238081%3B%5Cn%09return%20a%20%2F%20b%3B%5Cn%7D%5Cnvec3%20ACESFilmicToneMapping%28%20vec3%20color%20%29%20%7B%5Cn%09const%20mat3%20ACESInputMat%20%3D%20mat3%28%5Cn%09%09vec3%28%200.59719%2C%200.07600%2C%200.02840%20%29%2C%09%09vec3%28%200.35458%2C%200.90834%2C%200.13383%20%29%2C%5Cn%09%09vec3%28%200.04823%2C%200.01566%2C%200.83777%20%29%5Cn%09%29%3B%5Cn%09const%20mat3%20ACESOutputMat%20%3D%20mat3%28%5Cn%09%09vec3%28%20%201.60475%2C%20-0.10208%2C%20-0.00327%20%29%2C%09%09vec3%28%20-0.53108%2C%20%201.10813%2C%20-0.07276%20%29%2C%5Cn%09%09vec3%28%20-0.07367%2C%20-0.00605%2C%20%201.07602%20%29%5Cn%09%29%3B%5Cn%09color%20%2A%3D%20toneMappingExposure%20%2F%200.6%3B%5Cn%09color%20%3D%20ACESInputMat%20%2A%20color%3B%5Cn%09color%20%3D%20RRTAndODTFit%28%20color%20%29%3B%5Cn%09color%20%3D%20ACESOutputMat%20%2A%20color%3B%5Cn%09return%20saturate%28%20color%20%29%3B%5Cn%7D%5Cnconst%20mat3%20LINEAR_REC2020_TO_LINEAR_SRGB%20%3D%20mat3%28%5Cn%09vec3%28%201.6605%2C%20-%200.1246%2C%20-%200.0182%20%29%2C%5Cn%09vec3%28%20-%200.5876%2C%201.1329%2C%20-%200.1006%20%29%2C%5Cn%09vec3%28%20-%200.0728%2C%20-%200.0083%2C%201.1187%20%29%5Cn%29%3B%5Cnconst%20mat3%20LINEAR_SRGB_TO_LINEAR_REC2020%20%3D%20mat3%28%5Cn%09vec3%28%200.6274%2C%200.0691%2C%200.0164%20%29%2C%5Cn%09vec3%28%200.3293%2C%200.9195%2C%200.0880%20%29%2C%5Cn%09vec3%28%200.0433%2C%200.0113%2C%200.8956%20%29%5Cn%29%3B%5Cnvec3%20agxDefaultContrastApprox%28%20vec3%20x%20%29%20%7B%5Cn%09vec3%20x2%20%3D%20x%20%2A%20x%3B%5Cn%09vec3%20x4%20%3D%20x2%20%2A%20x2%3B%5Cn%09return%20%2B%2015.5%20%2A%20x4%20%2A%20x2%5Cn%09%09-%2040.14%20%2A%20x4%20%2A%20x%5Cn%09%09%2B%2031.96%20%2A%20x4%5Cn%09%09-%206.868%20%2A%20x2%20%2A%20x%5Cn%09%09%2B%200.4298%20%2A%20x2%5Cn%09%09%2B%200.1191%20%2A%20x%5Cn%09%09-%200.00232%3B%5Cn%7D%5Cnvec3%20AgXToneMapping%28%20vec3%20color%20%29%20%7B%5Cn%09const%20mat3%20AgXInsetMatrix%20%3D%20mat3%28%5Cn%09%09vec3%28%200.856627153315983%2C%200.137318972929847%2C%200.11189821299995%20%29%2C%5Cn%09%09vec3%28%200.0951212405381588%2C%200.761241990602591%2C%200.0767994186031903%20%29%2C%5Cn%09%09vec3%28%200.0482516061458583%2C%200.101439036467562%2C%200.811302368396859%20%29%5Cn%09%29%3B%5Cn%09const%20mat3%20AgXOutsetMatrix%20%3D%20mat3%28%5Cn%09%09vec3%28%201.1271005818144368%2C%20-%200.1413297634984383%2C%20-%200.14132976349843826%20%29%2C%5Cn%09%09vec3%28%20-%200.11060664309660323%2C%201.157823702216272%2C%20-%200.11060664309660294%20%29%2C%5Cn%09%09vec3%28%20-%200.016493938717834573%2C%20-%200.016493938717834257%2C%201.2519364065950405%20%29%5Cn%09%29%3B%5Cn%09const%20float%20AgxMinEv%20%3D%20-%2012.47393%3B%09const%20float%20AgxMaxEv%20%3D%204.026069%3B%5Cn%09color%20%2A%3D%20toneMappingExposure%3B%5Cn%09color%20%3D%20LINEAR_SRGB_TO_LINEAR_REC2020%20%2A%20color%3B%5Cn%09color%20%3D%20AgXInsetMatrix%20%2A%20color%3B%5Cn%09color%20%3D%20max%28%20color%2C%201e-10%20%29%3B%09color%20%3D%20log2%28%20color%20%29%3B%5Cn%09color%20%3D%20%28%20color%20-%20AgxMinEv%20%29%20%2F%20%28%20AgxMaxEv%20-%20AgxMinEv%20%29%3B%5Cn%09color%20%3D%20clamp%28%20color%2C%200.0%2C%201.0%20%29%3B%5Cn%09color%20%3D%20agxDefaultContrastApprox%28%20color%20%29%3B%5Cn%09color%20%3D%20AgXOutsetMatrix%20%2A%20color%3B%5Cn%09color%20%3D%20pow%28%20max%28%20vec3%28%200.0%20%29%2C%20color%20%29%2C%20vec3%28%202.2%20%29%20%29%3B%5Cn%09color%20%3D%20LINEAR_REC2020_TO_LINEAR_SRGB%20%2A%20color%3B%5Cn%09color%20%3D%20clamp%28%20color%2C%200.0%2C%201.0%20%29%3B%5Cn%09return%20color%3B%5Cn%7D%5Cnvec3%20NeutralToneMapping%28%20vec3%20color%20%29%20%7B%5Cn%09const%20float%20StartCompression%20%3D%200.8%20-%200.04%3B%5Cn%09const%20float%20Desaturation%20%3D%200.15%3B%5Cn%09color%20%2A%3D%20toneMappingExposure%3B%5Cn%09float%20x%20%3D%20min%28%20color.r%2C%20min%28%20color.g%2C%20color.b%20%29%20%29%3B%5Cn%09float%20offset%20%3D%20x%20%3C%200.08%20%3F%20x%20-%206.25%20%2A%20x%20%2A%20x%20%3A%200.04%3B%5Cn%09color%20-%3D%20offset%3B%5Cn%09float%20peak%20%3D%20max%28%20color.r%2C%20max%28%20color.g%2C%20color.b%20%29%20%29%3B%5Cn%09if%20%28%20peak%20%3C%20StartCompression%20%29%20return%20color%3B%5Cn%09float%20d%20%3D%201.%20-%20StartCompression%3B%5Cn%09float%20newPeak%20%3D%201.%20-%20d%20%2A%20d%20%2F%20%28%20peak%20%2B%20d%20-%20StartCompression%20%29%3B%5Cn%09color%20%2A%3D%20newPeak%20%2F%20peak%3B%5Cn%09float%20g%20%3D%201.%20-%201.%20%2F%20%28%20Desaturation%20%2A%20%28%20peak%20-%20newPeak%20%29%20%2B%201.%20%29%3B%5Cn%09return%20mix%28%20color%2C%20vec3%28%20newPeak%20%29%2C%20g%20%29%3B%5Cn%7D%5Cnvec3%20CustomToneMapping%28%20vec3%20color%20%29%20%7B%20return%20color%3B%20%7D%22%3B%0Avar%20transmission_fragment%20%3D%20%22%23ifdef%20USE_TRANSMISSION%5Cn%09material.transmission%20%3D%20transmission%3B%5Cn%09material.transmissionAlpha%20%3D%201.0%3B%5Cn%09material.thickness%20%3D%20thickness%3B%5Cn%09material.attenuationDistance%20%3D%20attenuationDistance%3B%5Cn%09material.attenuationColor%20%3D%20attenuationColor%3B%5Cn%09%23ifdef%20USE_TRANSMISSIONMAP%5Cn%09%09material.transmission%20%2A%3D%20texture2D%28%20transmissionMap%2C%20vTransmissionMapUv%20%29.r%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_THICKNESSMAP%5Cn%09%09material.thickness%20%2A%3D%20texture2D%28%20thicknessMap%2C%20vThicknessMapUv%20%29.g%3B%5Cn%09%23endif%5Cn%09vec3%20pos%20%3D%20vWorldPosition%3B%5Cn%09vec3%20v%20%3D%20normalize%28%20cameraPosition%20-%20pos%20%29%3B%5Cn%09vec3%20n%20%3D%20inverseTransformDirection%28%20normal%2C%20viewMatrix%20%29%3B%5Cn%09vec4%20transmitted%20%3D%20getIBLVolumeRefraction%28%5Cn%09%09n%2C%20v%2C%20material.roughness%2C%20material.diffuseColor%2C%20material.specularColor%2C%20material.specularF90%2C%5Cn%09%09pos%2C%20modelMatrix%2C%20viewMatrix%2C%20projectionMatrix%2C%20material.dispersion%2C%20material.ior%2C%20material.thickness%2C%5Cn%09%09material.attenuationColor%2C%20material.attenuationDistance%20%29%3B%5Cn%09material.transmissionAlpha%20%3D%20mix%28%20material.transmissionAlpha%2C%20transmitted.a%2C%20material.transmission%20%29%3B%5Cn%09totalDiffuse%20%3D%20mix%28%20totalDiffuse%2C%20transmitted.rgb%2C%20material.transmission%20%29%3B%5Cn%23endif%22%3B%0Avar%20transmission_pars_fragment%20%3D%20%22%23ifdef%20USE_TRANSMISSION%5Cn%09uniform%20float%20transmission%3B%5Cn%09uniform%20float%20thickness%3B%5Cn%09uniform%20float%20attenuationDistance%3B%5Cn%09uniform%20vec3%20attenuationColor%3B%5Cn%09%23ifdef%20USE_TRANSMISSIONMAP%5Cn%09%09uniform%20sampler2D%20transmissionMap%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_THICKNESSMAP%5Cn%09%09uniform%20sampler2D%20thicknessMap%3B%5Cn%09%23endif%5Cn%09uniform%20vec2%20transmissionSamplerSize%3B%5Cn%09uniform%20sampler2D%20transmissionSamplerMap%3B%5Cn%09uniform%20mat4%20modelMatrix%3B%5Cn%09uniform%20mat4%20projectionMatrix%3B%5Cn%09varying%20vec3%20vWorldPosition%3B%5Cn%09float%20w0%28%20float%20a%20%29%20%7B%5Cn%09%09return%20%28%201.0%20%2F%206.0%20%29%20%2A%20%28%20a%20%2A%20%28%20a%20%2A%20%28%20-%20a%20%2B%203.0%20%29%20-%203.0%20%29%20%2B%201.0%20%29%3B%5Cn%09%7D%5Cn%09float%20w1%28%20float%20a%20%29%20%7B%5Cn%09%09return%20%28%201.0%20%2F%206.0%20%29%20%2A%20%28%20a%20%2A%20%20a%20%2A%20%28%203.0%20%2A%20a%20-%206.0%20%29%20%2B%204.0%20%29%3B%5Cn%09%7D%5Cn%09float%20w2%28%20float%20a%20%29%7B%5Cn%09%09return%20%28%201.0%20%2F%206.0%20%29%20%2A%20%28%20a%20%2A%20%28%20a%20%2A%20%28%20-%203.0%20%2A%20a%20%2B%203.0%20%29%20%2B%203.0%20%29%20%2B%201.0%20%29%3B%5Cn%09%7D%5Cn%09float%20w3%28%20float%20a%20%29%20%7B%5Cn%09%09return%20%28%201.0%20%2F%206.0%20%29%20%2A%20%28%20a%20%2A%20a%20%2A%20a%20%29%3B%5Cn%09%7D%5Cn%09float%20g0%28%20float%20a%20%29%20%7B%5Cn%09%09return%20w0%28%20a%20%29%20%2B%20w1%28%20a%20%29%3B%5Cn%09%7D%5Cn%09float%20g1%28%20float%20a%20%29%20%7B%5Cn%09%09return%20w2%28%20a%20%29%20%2B%20w3%28%20a%20%29%3B%5Cn%09%7D%5Cn%09float%20h0%28%20float%20a%20%29%20%7B%5Cn%09%09return%20-%201.0%20%2B%20w1%28%20a%20%29%20%2F%20%28%20w0%28%20a%20%29%20%2B%20w1%28%20a%20%29%20%29%3B%5Cn%09%7D%5Cn%09float%20h1%28%20float%20a%20%29%20%7B%5Cn%09%09return%201.0%20%2B%20w3%28%20a%20%29%20%2F%20%28%20w2%28%20a%20%29%20%2B%20w3%28%20a%20%29%20%29%3B%5Cn%09%7D%5Cn%09vec4%20bicubic%28%20sampler2D%20tex%2C%20vec2%20uv%2C%20vec4%20texelSize%2C%20float%20lod%20%29%20%7B%5Cn%09%09uv%20%3D%20uv%20%2A%20texelSize.zw%20%2B%200.5%3B%5Cn%09%09vec2%20iuv%20%3D%20floor%28%20uv%20%29%3B%5Cn%09%09vec2%20fuv%20%3D%20fract%28%20uv%20%29%3B%5Cn%09%09float%20g0x%20%3D%20g0%28%20fuv.x%20%29%3B%5Cn%09%09float%20g1x%20%3D%20g1%28%20fuv.x%20%29%3B%5Cn%09%09float%20h0x%20%3D%20h0%28%20fuv.x%20%29%3B%5Cn%09%09float%20h1x%20%3D%20h1%28%20fuv.x%20%29%3B%5Cn%09%09float%20h0y%20%3D%20h0%28%20fuv.y%20%29%3B%5Cn%09%09float%20h1y%20%3D%20h1%28%20fuv.y%20%29%3B%5Cn%09%09vec2%20p0%20%3D%20%28%20vec2%28%20iuv.x%20%2B%20h0x%2C%20iuv.y%20%2B%20h0y%20%29%20-%200.5%20%29%20%2A%20texelSize.xy%3B%5Cn%09%09vec2%20p1%20%3D%20%28%20vec2%28%20iuv.x%20%2B%20h1x%2C%20iuv.y%20%2B%20h0y%20%29%20-%200.5%20%29%20%2A%20texelSize.xy%3B%5Cn%09%09vec2%20p2%20%3D%20%28%20vec2%28%20iuv.x%20%2B%20h0x%2C%20iuv.y%20%2B%20h1y%20%29%20-%200.5%20%29%20%2A%20texelSize.xy%3B%5Cn%09%09vec2%20p3%20%3D%20%28%20vec2%28%20iuv.x%20%2B%20h1x%2C%20iuv.y%20%2B%20h1y%20%29%20-%200.5%20%29%20%2A%20texelSize.xy%3B%5Cn%09%09return%20g0%28%20fuv.y%20%29%20%2A%20%28%20g0x%20%2A%20textureLod%28%20tex%2C%20p0%2C%20lod%20%29%20%2B%20g1x%20%2A%20textureLod%28%20tex%2C%20p1%2C%20lod%20%29%20%29%20%2B%5Cn%09%09%09g1%28%20fuv.y%20%29%20%2A%20%28%20g0x%20%2A%20textureLod%28%20tex%2C%20p2%2C%20lod%20%29%20%2B%20g1x%20%2A%20textureLod%28%20tex%2C%20p3%2C%20lod%20%29%20%29%3B%5Cn%09%7D%5Cn%09vec4%20textureBicubic%28%20sampler2D%20sampler%2C%20vec2%20uv%2C%20float%20lod%20%29%20%7B%5Cn%09%09vec2%20fLodSize%20%3D%20vec2%28%20textureSize%28%20sampler%2C%20int%28%20lod%20%29%20%29%20%29%3B%5Cn%09%09vec2%20cLodSize%20%3D%20vec2%28%20textureSize%28%20sampler%2C%20int%28%20lod%20%2B%201.0%20%29%20%29%20%29%3B%5Cn%09%09vec2%20fLodSizeInv%20%3D%201.0%20%2F%20fLodSize%3B%5Cn%09%09vec2%20cLodSizeInv%20%3D%201.0%20%2F%20cLodSize%3B%5Cn%09%09vec4%20fSample%20%3D%20bicubic%28%20sampler%2C%20uv%2C%20vec4%28%20fLodSizeInv%2C%20fLodSize%20%29%2C%20floor%28%20lod%20%29%20%29%3B%5Cn%09%09vec4%20cSample%20%3D%20bicubic%28%20sampler%2C%20uv%2C%20vec4%28%20cLodSizeInv%2C%20cLodSize%20%29%2C%20ceil%28%20lod%20%29%20%29%3B%5Cn%09%09return%20mix%28%20fSample%2C%20cSample%2C%20fract%28%20lod%20%29%20%29%3B%5Cn%09%7D%5Cn%09vec3%20getVolumeTransmissionRay%28%20const%20in%20vec3%20n%2C%20const%20in%20vec3%20v%2C%20const%20in%20float%20thickness%2C%20const%20in%20float%20ior%2C%20const%20in%20mat4%20modelMatrix%20%29%20%7B%5Cn%09%09vec3%20refractionVector%20%3D%20refract%28%20-%20v%2C%20normalize%28%20n%20%29%2C%201.0%20%2F%20ior%20%29%3B%5Cn%09%09vec3%20modelScale%3B%5Cn%09%09modelScale.x%20%3D%20length%28%20vec3%28%20modelMatrix%5B%200%20%5D.xyz%20%29%20%29%3B%5Cn%09%09modelScale.y%20%3D%20length%28%20vec3%28%20modelMatrix%5B%201%20%5D.xyz%20%29%20%29%3B%5Cn%09%09modelScale.z%20%3D%20length%28%20vec3%28%20modelMatrix%5B%202%20%5D.xyz%20%29%20%29%3B%5Cn%09%09return%20normalize%28%20refractionVector%20%29%20%2A%20thickness%20%2A%20modelScale%3B%5Cn%09%7D%5Cn%09float%20applyIorToRoughness%28%20const%20in%20float%20roughness%2C%20const%20in%20float%20ior%20%29%20%7B%5Cn%09%09return%20roughness%20%2A%20clamp%28%20ior%20%2A%202.0%20-%202.0%2C%200.0%2C%201.0%20%29%3B%5Cn%09%7D%5Cn%09vec4%20getTransmissionSample%28%20const%20in%20vec2%20fragCoord%2C%20const%20in%20float%20roughness%2C%20const%20in%20float%20ior%20%29%20%7B%5Cn%09%09float%20lod%20%3D%20log2%28%20transmissionSamplerSize.x%20%29%20%2A%20applyIorToRoughness%28%20roughness%2C%20ior%20%29%3B%5Cn%09%09return%20textureBicubic%28%20transmissionSamplerMap%2C%20fragCoord.xy%2C%20lod%20%29%3B%5Cn%09%7D%5Cn%09vec3%20volumeAttenuation%28%20const%20in%20float%20transmissionDistance%2C%20const%20in%20vec3%20attenuationColor%2C%20const%20in%20float%20attenuationDistance%20%29%20%7B%5Cn%09%09if%20%28%20isinf%28%20attenuationDistance%20%29%20%29%20%7B%5Cn%09%09%09return%20vec3%28%201.0%20%29%3B%5Cn%09%09%7D%20else%20%7B%5Cn%09%09%09vec3%20attenuationCoefficient%20%3D%20-log%28%20attenuationColor%20%29%20%2F%20attenuationDistance%3B%5Cn%09%09%09vec3%20transmittance%20%3D%20exp%28%20-%20attenuationCoefficient%20%2A%20transmissionDistance%20%29%3B%09%09%09return%20transmittance%3B%5Cn%09%09%7D%5Cn%09%7D%5Cn%09vec4%20getIBLVolumeRefraction%28%20const%20in%20vec3%20n%2C%20const%20in%20vec3%20v%2C%20const%20in%20float%20roughness%2C%20const%20in%20vec3%20diffuseColor%2C%5Cn%09%09const%20in%20vec3%20specularColor%2C%20const%20in%20float%20specularF90%2C%20const%20in%20vec3%20position%2C%20const%20in%20mat4%20modelMatrix%2C%5Cn%09%09const%20in%20mat4%20viewMatrix%2C%20const%20in%20mat4%20projMatrix%2C%20const%20in%20float%20dispersion%2C%20const%20in%20float%20ior%2C%20const%20in%20float%20thickness%2C%5Cn%09%09const%20in%20vec3%20attenuationColor%2C%20const%20in%20float%20attenuationDistance%20%29%20%7B%5Cn%09%09vec4%20transmittedLight%3B%5Cn%09%09vec3%20transmittance%3B%5Cn%09%09%23ifdef%20USE_DISPERSION%5Cn%09%09%09float%20halfSpread%20%3D%20%28%20ior%20-%201.0%20%29%20%2A%200.025%20%2A%20dispersion%3B%5Cn%09%09%09vec3%20iors%20%3D%20vec3%28%20ior%20-%20halfSpread%2C%20ior%2C%20ior%20%2B%20halfSpread%20%29%3B%5Cn%09%09%09for%20%28%20int%20i%20%3D%200%3B%20i%20%3C%203%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09%09%09vec3%20transmissionRay%20%3D%20getVolumeTransmissionRay%28%20n%2C%20v%2C%20thickness%2C%20iors%5B%20i%20%5D%2C%20modelMatrix%20%29%3B%5Cn%09%09%09%09vec3%20refractedRayExit%20%3D%20position%20%2B%20transmissionRay%3B%5Cn%09%09%5Cn%09%09%09%09vec4%20ndcPos%20%3D%20projMatrix%20%2A%20viewMatrix%20%2A%20vec4%28%20refractedRayExit%2C%201.0%20%29%3B%5Cn%09%09%09%09vec2%20refractionCoords%20%3D%20ndcPos.xy%20%2F%20ndcPos.w%3B%5Cn%09%09%09%09refractionCoords%20%2B%3D%201.0%3B%5Cn%09%09%09%09refractionCoords%20%2F%3D%202.0%3B%5Cn%09%09%5Cn%09%09%09%09vec4%20transmissionSample%20%3D%20getTransmissionSample%28%20refractionCoords%2C%20roughness%2C%20iors%5B%20i%20%5D%20%29%3B%5Cn%09%09%09%09transmittedLight%5B%20i%20%5D%20%3D%20transmissionSample%5B%20i%20%5D%3B%5Cn%09%09%09%09transmittedLight.a%20%2B%3D%20transmissionSample.a%3B%5Cn%09%09%09%09transmittance%5B%20i%20%5D%20%3D%20diffuseColor%5B%20i%20%5D%20%2A%20volumeAttenuation%28%20length%28%20transmissionRay%20%29%2C%20attenuationColor%2C%20attenuationDistance%20%29%5B%20i%20%5D%3B%5Cn%09%09%09%7D%5Cn%09%09%09transmittedLight.a%20%2F%3D%203.0%3B%5Cn%09%09%5Cn%09%09%23else%5Cn%09%09%5Cn%09%09%09vec3%20transmissionRay%20%3D%20getVolumeTransmissionRay%28%20n%2C%20v%2C%20thickness%2C%20ior%2C%20modelMatrix%20%29%3B%5Cn%09%09%09vec3%20refractedRayExit%20%3D%20position%20%2B%20transmissionRay%3B%5Cn%09%09%09vec4%20ndcPos%20%3D%20projMatrix%20%2A%20viewMatrix%20%2A%20vec4%28%20refractedRayExit%2C%201.0%20%29%3B%5Cn%09%09%09vec2%20refractionCoords%20%3D%20ndcPos.xy%20%2F%20ndcPos.w%3B%5Cn%09%09%09refractionCoords%20%2B%3D%201.0%3B%5Cn%09%09%09refractionCoords%20%2F%3D%202.0%3B%5Cn%09%09%09transmittedLight%20%3D%20getTransmissionSample%28%20refractionCoords%2C%20roughness%2C%20ior%20%29%3B%5Cn%09%09%09transmittance%20%3D%20diffuseColor%20%2A%20volumeAttenuation%28%20length%28%20transmissionRay%20%29%2C%20attenuationColor%2C%20attenuationDistance%20%29%3B%5Cn%09%09%5Cn%09%09%23endif%5Cn%09%09vec3%20attenuatedColor%20%3D%20transmittance%20%2A%20transmittedLight.rgb%3B%5Cn%09%09vec3%20F%20%3D%20EnvironmentBRDF%28%20n%2C%20v%2C%20specularColor%2C%20specularF90%2C%20roughness%20%29%3B%5Cn%09%09float%20transmittanceFactor%20%3D%20%28%20transmittance.r%20%2B%20transmittance.g%20%2B%20transmittance.b%20%29%20%2F%203.0%3B%5Cn%09%09return%20vec4%28%20%28%201.0%20-%20F%20%29%20%2A%20attenuatedColor%2C%201.0%20-%20%28%201.0%20-%20transmittedLight.a%20%29%20%2A%20transmittanceFactor%20%29%3B%5Cn%09%7D%5Cn%23endif%22%3B%0Avar%20uv_pars_fragment%20%3D%20%22%23if%20defined%28%20USE_UV%20%29%20%7C%7C%20defined%28%20USE_ANISOTROPY%20%29%5Cn%09varying%20vec2%20vUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_MAP%5Cn%09varying%20vec2%20vMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_ALPHAMAP%5Cn%09varying%20vec2%20vAlphaMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_LIGHTMAP%5Cn%09varying%20vec2%20vLightMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_AOMAP%5Cn%09varying%20vec2%20vAoMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_BUMPMAP%5Cn%09varying%20vec2%20vBumpMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_NORMALMAP%5Cn%09varying%20vec2%20vNormalMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_EMISSIVEMAP%5Cn%09varying%20vec2%20vEmissiveMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_METALNESSMAP%5Cn%09varying%20vec2%20vMetalnessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_ROUGHNESSMAP%5Cn%09varying%20vec2%20vRoughnessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_ANISOTROPYMAP%5Cn%09varying%20vec2%20vAnisotropyMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOATMAP%5Cn%09varying%20vec2%20vClearcoatMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT_NORMALMAP%5Cn%09varying%20vec2%20vClearcoatNormalMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT_ROUGHNESSMAP%5Cn%09varying%20vec2%20vClearcoatRoughnessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCEMAP%5Cn%09varying%20vec2%20vIridescenceMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCE_THICKNESSMAP%5Cn%09varying%20vec2%20vIridescenceThicknessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SHEEN_COLORMAP%5Cn%09varying%20vec2%20vSheenColorMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SHEEN_ROUGHNESSMAP%5Cn%09varying%20vec2%20vSheenRoughnessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULARMAP%5Cn%09varying%20vec2%20vSpecularMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULAR_COLORMAP%5Cn%09varying%20vec2%20vSpecularColorMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULAR_INTENSITYMAP%5Cn%09varying%20vec2%20vSpecularIntensityMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_TRANSMISSIONMAP%5Cn%09uniform%20mat3%20transmissionMapTransform%3B%5Cn%09varying%20vec2%20vTransmissionMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_THICKNESSMAP%5Cn%09uniform%20mat3%20thicknessMapTransform%3B%5Cn%09varying%20vec2%20vThicknessMapUv%3B%5Cn%23endif%22%3B%0Avar%20uv_pars_vertex%20%3D%20%22%23if%20defined%28%20USE_UV%20%29%20%7C%7C%20defined%28%20USE_ANISOTROPY%20%29%5Cn%09varying%20vec2%20vUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_MAP%5Cn%09uniform%20mat3%20mapTransform%3B%5Cn%09varying%20vec2%20vMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_ALPHAMAP%5Cn%09uniform%20mat3%20alphaMapTransform%3B%5Cn%09varying%20vec2%20vAlphaMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_LIGHTMAP%5Cn%09uniform%20mat3%20lightMapTransform%3B%5Cn%09varying%20vec2%20vLightMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_AOMAP%5Cn%09uniform%20mat3%20aoMapTransform%3B%5Cn%09varying%20vec2%20vAoMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_BUMPMAP%5Cn%09uniform%20mat3%20bumpMapTransform%3B%5Cn%09varying%20vec2%20vBumpMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_NORMALMAP%5Cn%09uniform%20mat3%20normalMapTransform%3B%5Cn%09varying%20vec2%20vNormalMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_DISPLACEMENTMAP%5Cn%09uniform%20mat3%20displacementMapTransform%3B%5Cn%09varying%20vec2%20vDisplacementMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_EMISSIVEMAP%5Cn%09uniform%20mat3%20emissiveMapTransform%3B%5Cn%09varying%20vec2%20vEmissiveMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_METALNESSMAP%5Cn%09uniform%20mat3%20metalnessMapTransform%3B%5Cn%09varying%20vec2%20vMetalnessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_ROUGHNESSMAP%5Cn%09uniform%20mat3%20roughnessMapTransform%3B%5Cn%09varying%20vec2%20vRoughnessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_ANISOTROPYMAP%5Cn%09uniform%20mat3%20anisotropyMapTransform%3B%5Cn%09varying%20vec2%20vAnisotropyMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOATMAP%5Cn%09uniform%20mat3%20clearcoatMapTransform%3B%5Cn%09varying%20vec2%20vClearcoatMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT_NORMALMAP%5Cn%09uniform%20mat3%20clearcoatNormalMapTransform%3B%5Cn%09varying%20vec2%20vClearcoatNormalMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT_ROUGHNESSMAP%5Cn%09uniform%20mat3%20clearcoatRoughnessMapTransform%3B%5Cn%09varying%20vec2%20vClearcoatRoughnessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SHEEN_COLORMAP%5Cn%09uniform%20mat3%20sheenColorMapTransform%3B%5Cn%09varying%20vec2%20vSheenColorMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SHEEN_ROUGHNESSMAP%5Cn%09uniform%20mat3%20sheenRoughnessMapTransform%3B%5Cn%09varying%20vec2%20vSheenRoughnessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCEMAP%5Cn%09uniform%20mat3%20iridescenceMapTransform%3B%5Cn%09varying%20vec2%20vIridescenceMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCE_THICKNESSMAP%5Cn%09uniform%20mat3%20iridescenceThicknessMapTransform%3B%5Cn%09varying%20vec2%20vIridescenceThicknessMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULARMAP%5Cn%09uniform%20mat3%20specularMapTransform%3B%5Cn%09varying%20vec2%20vSpecularMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULAR_COLORMAP%5Cn%09uniform%20mat3%20specularColorMapTransform%3B%5Cn%09varying%20vec2%20vSpecularColorMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULAR_INTENSITYMAP%5Cn%09uniform%20mat3%20specularIntensityMapTransform%3B%5Cn%09varying%20vec2%20vSpecularIntensityMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_TRANSMISSIONMAP%5Cn%09uniform%20mat3%20transmissionMapTransform%3B%5Cn%09varying%20vec2%20vTransmissionMapUv%3B%5Cn%23endif%5Cn%23ifdef%20USE_THICKNESSMAP%5Cn%09uniform%20mat3%20thicknessMapTransform%3B%5Cn%09varying%20vec2%20vThicknessMapUv%3B%5Cn%23endif%22%3B%0Avar%20uv_vertex%20%3D%20%22%23if%20defined%28%20USE_UV%20%29%20%7C%7C%20defined%28%20USE_ANISOTROPY%20%29%5Cn%09vUv%20%3D%20vec3%28%20uv%2C%201%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_MAP%5Cn%09vMapUv%20%3D%20%28%20mapTransform%20%2A%20vec3%28%20MAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_ALPHAMAP%5Cn%09vAlphaMapUv%20%3D%20%28%20alphaMapTransform%20%2A%20vec3%28%20ALPHAMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_LIGHTMAP%5Cn%09vLightMapUv%20%3D%20%28%20lightMapTransform%20%2A%20vec3%28%20LIGHTMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_AOMAP%5Cn%09vAoMapUv%20%3D%20%28%20aoMapTransform%20%2A%20vec3%28%20AOMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_BUMPMAP%5Cn%09vBumpMapUv%20%3D%20%28%20bumpMapTransform%20%2A%20vec3%28%20BUMPMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_NORMALMAP%5Cn%09vNormalMapUv%20%3D%20%28%20normalMapTransform%20%2A%20vec3%28%20NORMALMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_DISPLACEMENTMAP%5Cn%09vDisplacementMapUv%20%3D%20%28%20displacementMapTransform%20%2A%20vec3%28%20DISPLACEMENTMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_EMISSIVEMAP%5Cn%09vEmissiveMapUv%20%3D%20%28%20emissiveMapTransform%20%2A%20vec3%28%20EMISSIVEMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_METALNESSMAP%5Cn%09vMetalnessMapUv%20%3D%20%28%20metalnessMapTransform%20%2A%20vec3%28%20METALNESSMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_ROUGHNESSMAP%5Cn%09vRoughnessMapUv%20%3D%20%28%20roughnessMapTransform%20%2A%20vec3%28%20ROUGHNESSMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_ANISOTROPYMAP%5Cn%09vAnisotropyMapUv%20%3D%20%28%20anisotropyMapTransform%20%2A%20vec3%28%20ANISOTROPYMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOATMAP%5Cn%09vClearcoatMapUv%20%3D%20%28%20clearcoatMapTransform%20%2A%20vec3%28%20CLEARCOATMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT_NORMALMAP%5Cn%09vClearcoatNormalMapUv%20%3D%20%28%20clearcoatNormalMapTransform%20%2A%20vec3%28%20CLEARCOAT_NORMALMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT_ROUGHNESSMAP%5Cn%09vClearcoatRoughnessMapUv%20%3D%20%28%20clearcoatRoughnessMapTransform%20%2A%20vec3%28%20CLEARCOAT_ROUGHNESSMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCEMAP%5Cn%09vIridescenceMapUv%20%3D%20%28%20iridescenceMapTransform%20%2A%20vec3%28%20IRIDESCENCEMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCE_THICKNESSMAP%5Cn%09vIridescenceThicknessMapUv%20%3D%20%28%20iridescenceThicknessMapTransform%20%2A%20vec3%28%20IRIDESCENCE_THICKNESSMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_SHEEN_COLORMAP%5Cn%09vSheenColorMapUv%20%3D%20%28%20sheenColorMapTransform%20%2A%20vec3%28%20SHEEN_COLORMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_SHEEN_ROUGHNESSMAP%5Cn%09vSheenRoughnessMapUv%20%3D%20%28%20sheenRoughnessMapTransform%20%2A%20vec3%28%20SHEEN_ROUGHNESSMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULARMAP%5Cn%09vSpecularMapUv%20%3D%20%28%20specularMapTransform%20%2A%20vec3%28%20SPECULARMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULAR_COLORMAP%5Cn%09vSpecularColorMapUv%20%3D%20%28%20specularColorMapTransform%20%2A%20vec3%28%20SPECULAR_COLORMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULAR_INTENSITYMAP%5Cn%09vSpecularIntensityMapUv%20%3D%20%28%20specularIntensityMapTransform%20%2A%20vec3%28%20SPECULAR_INTENSITYMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_TRANSMISSIONMAP%5Cn%09vTransmissionMapUv%20%3D%20%28%20transmissionMapTransform%20%2A%20vec3%28%20TRANSMISSIONMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%5Cn%23ifdef%20USE_THICKNESSMAP%5Cn%09vThicknessMapUv%20%3D%20%28%20thicknessMapTransform%20%2A%20vec3%28%20THICKNESSMAP_UV%2C%201%20%29%20%29.xy%3B%5Cn%23endif%22%3B%0Avar%20worldpos_vertex%20%3D%20%22%23if%20defined%28%20USE_ENVMAP%20%29%20%7C%7C%20defined%28%20DISTANCE%20%29%20%7C%7C%20defined%20%28%20USE_SHADOWMAP%20%29%20%7C%7C%20defined%20%28%20USE_TRANSMISSION%20%29%20%7C%7C%20NUM_SPOT_LIGHT_COORDS%20%3E%200%5Cn%09vec4%20worldPosition%20%3D%20vec4%28%20transformed%2C%201.0%20%29%3B%5Cn%09%23ifdef%20USE_BATCHING%5Cn%09%09worldPosition%20%3D%20batchingMatrix%20%2A%20worldPosition%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_INSTANCING%5Cn%09%09worldPosition%20%3D%20instanceMatrix%20%2A%20worldPosition%3B%5Cn%09%23endif%5Cn%09worldPosition%20%3D%20modelMatrix%20%2A%20worldPosition%3B%5Cn%23endif%22%3B%0Avar%20vertex%24h%20%3D%20%22varying%20vec2%20vUv%3B%5Cnuniform%20mat3%20uvTransform%3B%5Cnvoid%20main%28%29%20%7B%5Cn%09vUv%20%3D%20%28%20uvTransform%20%2A%20vec3%28%20uv%2C%201%20%29%20%29.xy%3B%5Cn%09gl_Position%20%3D%20vec4%28%20position.xy%2C%201.0%2C%201.0%20%29%3B%5Cn%7D%22%3B%0Avar%20fragment%24h%20%3D%20%22uniform%20sampler2D%20t2D%3B%5Cnuniform%20float%20backgroundIntensity%3B%5Cnvarying%20vec2%20vUv%3B%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20texColor%20%3D%20texture2D%28%20t2D%2C%20vUv%20%29%3B%5Cn%09%23ifdef%20DECODE_VIDEO_TEXTURE%5Cn%09%09texColor%20%3D%20vec4%28%20mix%28%20pow%28%20texColor.rgb%20%2A%200.9478672986%20%2B%20vec3%28%200.0521327014%20%29%2C%20vec3%28%202.4%20%29%20%29%2C%20texColor.rgb%20%2A%200.0773993808%2C%20vec3%28%20lessThanEqual%28%20texColor.rgb%2C%20vec3%28%200.04045%20%29%20%29%20%29%20%29%2C%20texColor.w%20%29%3B%5Cn%09%23endif%5Cn%09texColor.rgb%20%2A%3D%20backgroundIntensity%3B%5Cn%09gl_FragColor%20%3D%20texColor%3B%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%24g%20%3D%20%22varying%20vec3%20vWorldDirection%3B%5Cn%23include%20%3Ccommon%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vWorldDirection%20%3D%20transformDirection%28%20position%2C%20modelMatrix%20%29%3B%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09gl_Position.z%20%3D%20gl_Position.w%3B%5Cn%7D%22%3B%0Avar%20fragment%24g%20%3D%20%22%23ifdef%20ENVMAP_TYPE_CUBE%5Cn%09uniform%20samplerCube%20envMap%3B%5Cn%23elif%20defined%28%20ENVMAP_TYPE_CUBE_UV%20%29%5Cn%09uniform%20sampler2D%20envMap%3B%5Cn%23endif%5Cnuniform%20float%20flipEnvMap%3B%5Cnuniform%20float%20backgroundBlurriness%3B%5Cnuniform%20float%20backgroundIntensity%3B%5Cnuniform%20mat3%20backgroundRotation%3B%5Cnvarying%20vec3%20vWorldDirection%3B%5Cn%23include%20%3Ccube_uv_reflection_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23ifdef%20ENVMAP_TYPE_CUBE%5Cn%09%09vec4%20texColor%20%3D%20textureCube%28%20envMap%2C%20backgroundRotation%20%2A%20vec3%28%20flipEnvMap%20%2A%20vWorldDirection.x%2C%20vWorldDirection.yz%20%29%20%29%3B%5Cn%09%23elif%20defined%28%20ENVMAP_TYPE_CUBE_UV%20%29%5Cn%09%09vec4%20texColor%20%3D%20textureCubeUV%28%20envMap%2C%20backgroundRotation%20%2A%20vWorldDirection%2C%20backgroundBlurriness%20%29%3B%5Cn%09%23else%5Cn%09%09vec4%20texColor%20%3D%20vec4%28%200.0%2C%200.0%2C%200.0%2C%201.0%20%29%3B%5Cn%09%23endif%5Cn%09texColor.rgb%20%2A%3D%20backgroundIntensity%3B%5Cn%09gl_FragColor%20%3D%20texColor%3B%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%24f%20%3D%20%22varying%20vec3%20vWorldDirection%3B%5Cn%23include%20%3Ccommon%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vWorldDirection%20%3D%20transformDirection%28%20position%2C%20modelMatrix%20%29%3B%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09gl_Position.z%20%3D%20gl_Position.w%3B%5Cn%7D%22%3B%0Avar%20fragment%24f%20%3D%20%22uniform%20samplerCube%20tCube%3B%5Cnuniform%20float%20tFlip%3B%5Cnuniform%20float%20opacity%3B%5Cnvarying%20vec3%20vWorldDirection%3B%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20texColor%20%3D%20textureCube%28%20tCube%2C%20vec3%28%20tFlip%20%2A%20vWorldDirection.x%2C%20vWorldDirection.yz%20%29%20%29%3B%5Cn%09gl_FragColor%20%3D%20texColor%3B%5Cn%09gl_FragColor.a%20%2A%3D%20opacity%3B%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%24e%20%3D%20%22%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Cdisplacementmap_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvarying%20vec2%20vHighPrecisionZW%3B%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23ifdef%20USE_DISPLACEMENTMAP%5Cn%09%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%23endif%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cdisplacementmap_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09vHighPrecisionZW%20%3D%20gl_Position.zw%3B%5Cn%7D%22%3B%0Avar%20fragment%24e%20%3D%20%22%23if%20DEPTH_PACKING%20%3D%3D%203200%5Cn%09uniform%20float%20opacity%3B%5Cn%23endif%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cpacking%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Calphamap_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvarying%20vec2%20vHighPrecisionZW%3B%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%201.0%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09%23if%20DEPTH_PACKING%20%3D%3D%203200%5Cn%09%09diffuseColor.a%20%3D%20opacity%3B%5Cn%09%23endif%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Calphamap_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09float%20fragCoordZ%20%3D%200.5%20%2A%20vHighPrecisionZW%5B0%5D%20%2F%20vHighPrecisionZW%5B1%5D%20%2B%200.5%3B%5Cn%09%23if%20DEPTH_PACKING%20%3D%3D%203200%5Cn%09%09gl_FragColor%20%3D%20vec4%28%20vec3%28%201.0%20-%20fragCoordZ%20%29%2C%20opacity%20%29%3B%5Cn%09%23elif%20DEPTH_PACKING%20%3D%3D%203201%5Cn%09%09gl_FragColor%20%3D%20packDepthToRGBA%28%20fragCoordZ%20%29%3B%5Cn%09%23elif%20DEPTH_PACKING%20%3D%3D%203202%5Cn%09%09gl_FragColor%20%3D%20vec4%28%20packDepthToRGB%28%20fragCoordZ%20%29%2C%201.0%20%29%3B%5Cn%09%23elif%20DEPTH_PACKING%20%3D%3D%203203%5Cn%09%09gl_FragColor%20%3D%20vec4%28%20packDepthToRG%28%20fragCoordZ%20%29%2C%200.0%2C%201.0%20%29%3B%5Cn%09%23endif%5Cn%7D%22%3B%0Avar%20vertex%24d%20%3D%20%22%23define%20DISTANCE%5Cnvarying%20vec3%20vWorldPosition%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Cdisplacementmap_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23ifdef%20USE_DISPLACEMENTMAP%5Cn%09%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%23endif%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cdisplacementmap_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Cworldpos_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09vWorldPosition%20%3D%20worldPosition.xyz%3B%5Cn%7D%22%3B%0Avar%20fragment%24d%20%3D%20%22%23define%20DISTANCE%5Cnuniform%20vec3%20referencePosition%3B%5Cnuniform%20float%20nearDistance%3B%5Cnuniform%20float%20farDistance%3B%5Cnvarying%20vec3%20vWorldPosition%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cpacking%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Calphamap_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%20%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%201.0%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Calphamap_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09float%20dist%20%3D%20length%28%20vWorldPosition%20-%20referencePosition%20%29%3B%5Cn%09dist%20%3D%20%28%20dist%20-%20nearDistance%20%29%20%2F%20%28%20farDistance%20-%20nearDistance%20%29%3B%5Cn%09dist%20%3D%20saturate%28%20dist%20%29%3B%5Cn%09gl_FragColor%20%3D%20packDepthToRGBA%28%20dist%20%29%3B%5Cn%7D%22%3B%0Avar%20vertex%24c%20%3D%20%22varying%20vec3%20vWorldDirection%3B%5Cn%23include%20%3Ccommon%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vWorldDirection%20%3D%20transformDirection%28%20position%2C%20modelMatrix%20%29%3B%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%7D%22%3B%0Avar%20fragment%24c%20%3D%20%22uniform%20sampler2D%20tEquirect%3B%5Cnvarying%20vec3%20vWorldDirection%3B%5Cn%23include%20%3Ccommon%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec3%20direction%20%3D%20normalize%28%20vWorldDirection%20%29%3B%5Cn%09vec2%20sampleUV%20%3D%20equirectUv%28%20direction%20%29%3B%5Cn%09gl_FragColor%20%3D%20texture2D%28%20tEquirect%2C%20sampleUV%20%29%3B%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%24b%20%3D%20%22uniform%20float%20scale%3B%5Cnattribute%20float%20lineDistance%3B%5Cnvarying%20float%20vLineDistance%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Ccolor_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vLineDistance%20%3D%20scale%20%2A%20lineDistance%3B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Ccolor_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphcolor_vertex%3E%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%7D%22%3B%0Avar%20fragment%24b%20%3D%20%22uniform%20vec3%20diffuse%3B%5Cnuniform%20float%20opacity%3B%5Cnuniform%20float%20dashSize%3B%5Cnuniform%20float%20totalSize%3B%5Cnvarying%20float%20vLineDistance%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Ccolor_pars_fragment%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%20diffuse%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09if%20%28%20mod%28%20vLineDistance%2C%20totalSize%20%29%20%3E%20dashSize%20%29%20%7B%5Cn%09%09discard%3B%5Cn%09%7D%5Cn%09vec3%20outgoingLight%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Ccolor_fragment%3E%5Cn%09outgoingLight%20%3D%20diffuseColor.rgb%3B%5Cn%09%23include%20%3Copaque_fragment%3E%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%09%23include%20%3Cpremultiplied_alpha_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%24a%20%3D%20%22%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Cenvmap_pars_vertex%3E%5Cn%23include%20%3Ccolor_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Ccolor_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphcolor_vertex%3E%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23if%20defined%20%28%20USE_ENVMAP%20%29%20%7C%7C%20defined%20%28%20USE_SKINNING%20%29%5Cn%09%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%09%23include%20%3Cdefaultnormal_vertex%3E%5Cn%09%23endif%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09%23include%20%3Cworldpos_vertex%3E%5Cn%09%23include%20%3Cenvmap_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%7D%22%3B%0Avar%20fragment%24a%20%3D%20%22uniform%20vec3%20diffuse%3B%5Cnuniform%20float%20opacity%3B%5Cn%23ifndef%20FLAT_SHADED%5Cn%09varying%20vec3%20vNormal%3B%5Cn%23endif%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cdithering_pars_fragment%3E%5Cn%23include%20%3Ccolor_pars_fragment%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Calphamap_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Caomap_pars_fragment%3E%5Cn%23include%20%3Clightmap_pars_fragment%3E%5Cn%23include%20%3Cenvmap_common_pars_fragment%3E%5Cn%23include%20%3Cenvmap_pars_fragment%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Cspecularmap_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%20diffuse%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Ccolor_fragment%3E%5Cn%09%23include%20%3Calphamap_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09%23include%20%3Cspecularmap_fragment%3E%5Cn%09ReflectedLight%20reflectedLight%20%3D%20ReflectedLight%28%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%20%29%3B%5Cn%09%23ifdef%20USE_LIGHTMAP%5Cn%09%09vec4%20lightMapTexel%20%3D%20texture2D%28%20lightMap%2C%20vLightMapUv%20%29%3B%5Cn%09%09reflectedLight.indirectDiffuse%20%2B%3D%20lightMapTexel.rgb%20%2A%20lightMapIntensity%20%2A%20RECIPROCAL_PI%3B%5Cn%09%23else%5Cn%09%09reflectedLight.indirectDiffuse%20%2B%3D%20vec3%28%201.0%20%29%3B%5Cn%09%23endif%5Cn%09%23include%20%3Caomap_fragment%3E%5Cn%09reflectedLight.indirectDiffuse%20%2A%3D%20diffuseColor.rgb%3B%5Cn%09vec3%20outgoingLight%20%3D%20reflectedLight.indirectDiffuse%3B%5Cn%09%23include%20%3Cenvmap_fragment%3E%5Cn%09%23include%20%3Copaque_fragment%3E%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%09%23include%20%3Cpremultiplied_alpha_fragment%3E%5Cn%09%23include%20%3Cdithering_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%249%20%3D%20%22%23define%20LAMBERT%5Cnvarying%20vec3%20vViewPosition%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Cdisplacementmap_pars_vertex%3E%5Cn%23include%20%3Cenvmap_pars_vertex%3E%5Cn%23include%20%3Ccolor_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Cnormal_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Cshadowmap_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Ccolor_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphcolor_vertex%3E%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%23include%20%3Cdefaultnormal_vertex%3E%5Cn%09%23include%20%3Cnormal_vertex%3E%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cdisplacementmap_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09vViewPosition%20%3D%20-%20mvPosition.xyz%3B%5Cn%09%23include%20%3Cworldpos_vertex%3E%5Cn%09%23include%20%3Cenvmap_vertex%3E%5Cn%09%23include%20%3Cshadowmap_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%7D%22%3B%0Avar%20fragment%249%20%3D%20%22%23define%20LAMBERT%5Cnuniform%20vec3%20diffuse%3B%5Cnuniform%20vec3%20emissive%3B%5Cnuniform%20float%20opacity%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cpacking%3E%5Cn%23include%20%3Cdithering_pars_fragment%3E%5Cn%23include%20%3Ccolor_pars_fragment%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Calphamap_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Caomap_pars_fragment%3E%5Cn%23include%20%3Clightmap_pars_fragment%3E%5Cn%23include%20%3Cemissivemap_pars_fragment%3E%5Cn%23include%20%3Cenvmap_common_pars_fragment%3E%5Cn%23include%20%3Cenvmap_pars_fragment%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Cbsdfs%3E%5Cn%23include%20%3Clights_pars_begin%3E%5Cn%23include%20%3Cnormal_pars_fragment%3E%5Cn%23include%20%3Clights_lambert_pars_fragment%3E%5Cn%23include%20%3Cshadowmap_pars_fragment%3E%5Cn%23include%20%3Cbumpmap_pars_fragment%3E%5Cn%23include%20%3Cnormalmap_pars_fragment%3E%5Cn%23include%20%3Cspecularmap_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%20diffuse%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09ReflectedLight%20reflectedLight%20%3D%20ReflectedLight%28%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%20%29%3B%5Cn%09vec3%20totalEmissiveRadiance%20%3D%20emissive%3B%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Ccolor_fragment%3E%5Cn%09%23include%20%3Calphamap_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09%23include%20%3Cspecularmap_fragment%3E%5Cn%09%23include%20%3Cnormal_fragment_begin%3E%5Cn%09%23include%20%3Cnormal_fragment_maps%3E%5Cn%09%23include%20%3Cemissivemap_fragment%3E%5Cn%09%23include%20%3Clights_lambert_fragment%3E%5Cn%09%23include%20%3Clights_fragment_begin%3E%5Cn%09%23include%20%3Clights_fragment_maps%3E%5Cn%09%23include%20%3Clights_fragment_end%3E%5Cn%09%23include%20%3Caomap_fragment%3E%5Cn%09vec3%20outgoingLight%20%3D%20reflectedLight.directDiffuse%20%2B%20reflectedLight.indirectDiffuse%20%2B%20totalEmissiveRadiance%3B%5Cn%09%23include%20%3Cenvmap_fragment%3E%5Cn%09%23include%20%3Copaque_fragment%3E%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%09%23include%20%3Cpremultiplied_alpha_fragment%3E%5Cn%09%23include%20%3Cdithering_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%248%20%3D%20%22%23define%20MATCAP%5Cnvarying%20vec3%20vViewPosition%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Ccolor_pars_vertex%3E%5Cn%23include%20%3Cdisplacementmap_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Cnormal_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Ccolor_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphcolor_vertex%3E%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%23include%20%3Cdefaultnormal_vertex%3E%5Cn%09%23include%20%3Cnormal_vertex%3E%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cdisplacementmap_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%09vViewPosition%20%3D%20-%20mvPosition.xyz%3B%5Cn%7D%22%3B%0Avar%20fragment%248%20%3D%20%22%23define%20MATCAP%5Cnuniform%20vec3%20diffuse%3B%5Cnuniform%20float%20opacity%3B%5Cnuniform%20sampler2D%20matcap%3B%5Cnvarying%20vec3%20vViewPosition%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cdithering_pars_fragment%3E%5Cn%23include%20%3Ccolor_pars_fragment%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Calphamap_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Cnormal_pars_fragment%3E%5Cn%23include%20%3Cbumpmap_pars_fragment%3E%5Cn%23include%20%3Cnormalmap_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%20diffuse%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Ccolor_fragment%3E%5Cn%09%23include%20%3Calphamap_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09%23include%20%3Cnormal_fragment_begin%3E%5Cn%09%23include%20%3Cnormal_fragment_maps%3E%5Cn%09vec3%20viewDir%20%3D%20normalize%28%20vViewPosition%20%29%3B%5Cn%09vec3%20x%20%3D%20normalize%28%20vec3%28%20viewDir.z%2C%200.0%2C%20-%20viewDir.x%20%29%20%29%3B%5Cn%09vec3%20y%20%3D%20cross%28%20viewDir%2C%20x%20%29%3B%5Cn%09vec2%20uv%20%3D%20vec2%28%20dot%28%20x%2C%20normal%20%29%2C%20dot%28%20y%2C%20normal%20%29%20%29%20%2A%200.495%20%2B%200.5%3B%5Cn%09%23ifdef%20USE_MATCAP%5Cn%09%09vec4%20matcapColor%20%3D%20texture2D%28%20matcap%2C%20uv%20%29%3B%5Cn%09%23else%5Cn%09%09vec4%20matcapColor%20%3D%20vec4%28%20vec3%28%20mix%28%200.2%2C%200.8%2C%20uv.y%20%29%20%29%2C%201.0%20%29%3B%5Cn%09%23endif%5Cn%09vec3%20outgoingLight%20%3D%20diffuseColor.rgb%20%2A%20matcapColor.rgb%3B%5Cn%09%23include%20%3Copaque_fragment%3E%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%09%23include%20%3Cpremultiplied_alpha_fragment%3E%5Cn%09%23include%20%3Cdithering_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%247%20%3D%20%22%23define%20NORMAL%5Cn%23if%20defined%28%20FLAT_SHADED%20%29%20%7C%7C%20defined%28%20USE_BUMPMAP%20%29%20%7C%7C%20defined%28%20USE_NORMALMAP_TANGENTSPACE%20%29%5Cn%09varying%20vec3%20vViewPosition%3B%5Cn%23endif%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Cdisplacementmap_pars_vertex%3E%5Cn%23include%20%3Cnormal_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%23include%20%3Cdefaultnormal_vertex%3E%5Cn%09%23include%20%3Cnormal_vertex%3E%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cdisplacementmap_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%23if%20defined%28%20FLAT_SHADED%20%29%20%7C%7C%20defined%28%20USE_BUMPMAP%20%29%20%7C%7C%20defined%28%20USE_NORMALMAP_TANGENTSPACE%20%29%5Cn%09vViewPosition%20%3D%20-%20mvPosition.xyz%3B%5Cn%23endif%5Cn%7D%22%3B%0Avar%20fragment%247%20%3D%20%22%23define%20NORMAL%5Cnuniform%20float%20opacity%3B%5Cn%23if%20defined%28%20FLAT_SHADED%20%29%20%7C%7C%20defined%28%20USE_BUMPMAP%20%29%20%7C%7C%20defined%28%20USE_NORMALMAP_TANGENTSPACE%20%29%5Cn%09varying%20vec3%20vViewPosition%3B%5Cn%23endif%5Cn%23include%20%3Cpacking%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cnormal_pars_fragment%3E%5Cn%23include%20%3Cbumpmap_pars_fragment%3E%5Cn%23include%20%3Cnormalmap_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%200.0%2C%200.0%2C%200.0%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cnormal_fragment_begin%3E%5Cn%09%23include%20%3Cnormal_fragment_maps%3E%5Cn%09gl_FragColor%20%3D%20vec4%28%20packNormalToRGB%28%20normal%20%29%2C%20diffuseColor.a%20%29%3B%5Cn%09%23ifdef%20OPAQUE%5Cn%09%09gl_FragColor.a%20%3D%201.0%3B%5Cn%09%23endif%5Cn%7D%22%3B%0Avar%20vertex%246%20%3D%20%22%23define%20PHONG%5Cnvarying%20vec3%20vViewPosition%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Cdisplacementmap_pars_vertex%3E%5Cn%23include%20%3Cenvmap_pars_vertex%3E%5Cn%23include%20%3Ccolor_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Cnormal_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Cshadowmap_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Ccolor_vertex%3E%5Cn%09%23include%20%3Cmorphcolor_vertex%3E%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%23include%20%3Cdefaultnormal_vertex%3E%5Cn%09%23include%20%3Cnormal_vertex%3E%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cdisplacementmap_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09vViewPosition%20%3D%20-%20mvPosition.xyz%3B%5Cn%09%23include%20%3Cworldpos_vertex%3E%5Cn%09%23include%20%3Cenvmap_vertex%3E%5Cn%09%23include%20%3Cshadowmap_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%7D%22%3B%0Avar%20fragment%246%20%3D%20%22%23define%20PHONG%5Cnuniform%20vec3%20diffuse%3B%5Cnuniform%20vec3%20emissive%3B%5Cnuniform%20vec3%20specular%3B%5Cnuniform%20float%20shininess%3B%5Cnuniform%20float%20opacity%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cpacking%3E%5Cn%23include%20%3Cdithering_pars_fragment%3E%5Cn%23include%20%3Ccolor_pars_fragment%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Calphamap_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Caomap_pars_fragment%3E%5Cn%23include%20%3Clightmap_pars_fragment%3E%5Cn%23include%20%3Cemissivemap_pars_fragment%3E%5Cn%23include%20%3Cenvmap_common_pars_fragment%3E%5Cn%23include%20%3Cenvmap_pars_fragment%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Cbsdfs%3E%5Cn%23include%20%3Clights_pars_begin%3E%5Cn%23include%20%3Cnormal_pars_fragment%3E%5Cn%23include%20%3Clights_phong_pars_fragment%3E%5Cn%23include%20%3Cshadowmap_pars_fragment%3E%5Cn%23include%20%3Cbumpmap_pars_fragment%3E%5Cn%23include%20%3Cnormalmap_pars_fragment%3E%5Cn%23include%20%3Cspecularmap_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%20diffuse%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09ReflectedLight%20reflectedLight%20%3D%20ReflectedLight%28%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%20%29%3B%5Cn%09vec3%20totalEmissiveRadiance%20%3D%20emissive%3B%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Ccolor_fragment%3E%5Cn%09%23include%20%3Calphamap_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09%23include%20%3Cspecularmap_fragment%3E%5Cn%09%23include%20%3Cnormal_fragment_begin%3E%5Cn%09%23include%20%3Cnormal_fragment_maps%3E%5Cn%09%23include%20%3Cemissivemap_fragment%3E%5Cn%09%23include%20%3Clights_phong_fragment%3E%5Cn%09%23include%20%3Clights_fragment_begin%3E%5Cn%09%23include%20%3Clights_fragment_maps%3E%5Cn%09%23include%20%3Clights_fragment_end%3E%5Cn%09%23include%20%3Caomap_fragment%3E%5Cn%09vec3%20outgoingLight%20%3D%20reflectedLight.directDiffuse%20%2B%20reflectedLight.indirectDiffuse%20%2B%20reflectedLight.directSpecular%20%2B%20reflectedLight.indirectSpecular%20%2B%20totalEmissiveRadiance%3B%5Cn%09%23include%20%3Cenvmap_fragment%3E%5Cn%09%23include%20%3Copaque_fragment%3E%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%09%23include%20%3Cpremultiplied_alpha_fragment%3E%5Cn%09%23include%20%3Cdithering_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%245%20%3D%20%22%23define%20STANDARD%5Cnvarying%20vec3%20vViewPosition%3B%5Cn%23ifdef%20USE_TRANSMISSION%5Cn%09varying%20vec3%20vWorldPosition%3B%5Cn%23endif%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Cdisplacementmap_pars_vertex%3E%5Cn%23include%20%3Ccolor_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Cnormal_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Cshadowmap_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Ccolor_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphcolor_vertex%3E%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%23include%20%3Cdefaultnormal_vertex%3E%5Cn%09%23include%20%3Cnormal_vertex%3E%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cdisplacementmap_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09vViewPosition%20%3D%20-%20mvPosition.xyz%3B%5Cn%09%23include%20%3Cworldpos_vertex%3E%5Cn%09%23include%20%3Cshadowmap_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%23ifdef%20USE_TRANSMISSION%5Cn%09vWorldPosition%20%3D%20worldPosition.xyz%3B%5Cn%23endif%5Cn%7D%22%3B%0Avar%20fragment%245%20%3D%20%22%23define%20STANDARD%5Cn%23ifdef%20PHYSICAL%5Cn%09%23define%20IOR%5Cn%09%23define%20USE_SPECULAR%5Cn%23endif%5Cnuniform%20vec3%20diffuse%3B%5Cnuniform%20vec3%20emissive%3B%5Cnuniform%20float%20roughness%3B%5Cnuniform%20float%20metalness%3B%5Cnuniform%20float%20opacity%3B%5Cn%23ifdef%20IOR%5Cn%09uniform%20float%20ior%3B%5Cn%23endif%5Cn%23ifdef%20USE_SPECULAR%5Cn%09uniform%20float%20specularIntensity%3B%5Cn%09uniform%20vec3%20specularColor%3B%5Cn%09%23ifdef%20USE_SPECULAR_COLORMAP%5Cn%09%09uniform%20sampler2D%20specularColorMap%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_SPECULAR_INTENSITYMAP%5Cn%09%09uniform%20sampler2D%20specularIntensityMap%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23ifdef%20USE_CLEARCOAT%5Cn%09uniform%20float%20clearcoat%3B%5Cn%09uniform%20float%20clearcoatRoughness%3B%5Cn%23endif%5Cn%23ifdef%20USE_DISPERSION%5Cn%09uniform%20float%20dispersion%3B%5Cn%23endif%5Cn%23ifdef%20USE_IRIDESCENCE%5Cn%09uniform%20float%20iridescence%3B%5Cn%09uniform%20float%20iridescenceIOR%3B%5Cn%09uniform%20float%20iridescenceThicknessMinimum%3B%5Cn%09uniform%20float%20iridescenceThicknessMaximum%3B%5Cn%23endif%5Cn%23ifdef%20USE_SHEEN%5Cn%09uniform%20vec3%20sheenColor%3B%5Cn%09uniform%20float%20sheenRoughness%3B%5Cn%09%23ifdef%20USE_SHEEN_COLORMAP%5Cn%09%09uniform%20sampler2D%20sheenColorMap%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_SHEEN_ROUGHNESSMAP%5Cn%09%09uniform%20sampler2D%20sheenRoughnessMap%3B%5Cn%09%23endif%5Cn%23endif%5Cn%23ifdef%20USE_ANISOTROPY%5Cn%09uniform%20vec2%20anisotropyVector%3B%5Cn%09%23ifdef%20USE_ANISOTROPYMAP%5Cn%09%09uniform%20sampler2D%20anisotropyMap%3B%5Cn%09%23endif%5Cn%23endif%5Cnvarying%20vec3%20vViewPosition%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cpacking%3E%5Cn%23include%20%3Cdithering_pars_fragment%3E%5Cn%23include%20%3Ccolor_pars_fragment%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Calphamap_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Caomap_pars_fragment%3E%5Cn%23include%20%3Clightmap_pars_fragment%3E%5Cn%23include%20%3Cemissivemap_pars_fragment%3E%5Cn%23include%20%3Ciridescence_fragment%3E%5Cn%23include%20%3Ccube_uv_reflection_fragment%3E%5Cn%23include%20%3Cenvmap_common_pars_fragment%3E%5Cn%23include%20%3Cenvmap_physical_pars_fragment%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Clights_pars_begin%3E%5Cn%23include%20%3Cnormal_pars_fragment%3E%5Cn%23include%20%3Clights_physical_pars_fragment%3E%5Cn%23include%20%3Ctransmission_pars_fragment%3E%5Cn%23include%20%3Cshadowmap_pars_fragment%3E%5Cn%23include%20%3Cbumpmap_pars_fragment%3E%5Cn%23include%20%3Cnormalmap_pars_fragment%3E%5Cn%23include%20%3Cclearcoat_pars_fragment%3E%5Cn%23include%20%3Ciridescence_pars_fragment%3E%5Cn%23include%20%3Croughnessmap_pars_fragment%3E%5Cn%23include%20%3Cmetalnessmap_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%20diffuse%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09ReflectedLight%20reflectedLight%20%3D%20ReflectedLight%28%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%20%29%3B%5Cn%09vec3%20totalEmissiveRadiance%20%3D%20emissive%3B%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Ccolor_fragment%3E%5Cn%09%23include%20%3Calphamap_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09%23include%20%3Croughnessmap_fragment%3E%5Cn%09%23include%20%3Cmetalnessmap_fragment%3E%5Cn%09%23include%20%3Cnormal_fragment_begin%3E%5Cn%09%23include%20%3Cnormal_fragment_maps%3E%5Cn%09%23include%20%3Cclearcoat_normal_fragment_begin%3E%5Cn%09%23include%20%3Cclearcoat_normal_fragment_maps%3E%5Cn%09%23include%20%3Cemissivemap_fragment%3E%5Cn%09%23include%20%3Clights_physical_fragment%3E%5Cn%09%23include%20%3Clights_fragment_begin%3E%5Cn%09%23include%20%3Clights_fragment_maps%3E%5Cn%09%23include%20%3Clights_fragment_end%3E%5Cn%09%23include%20%3Caomap_fragment%3E%5Cn%09vec3%20totalDiffuse%20%3D%20reflectedLight.directDiffuse%20%2B%20reflectedLight.indirectDiffuse%3B%5Cn%09vec3%20totalSpecular%20%3D%20reflectedLight.directSpecular%20%2B%20reflectedLight.indirectSpecular%3B%5Cn%09%23include%20%3Ctransmission_fragment%3E%5Cn%09vec3%20outgoingLight%20%3D%20totalDiffuse%20%2B%20totalSpecular%20%2B%20totalEmissiveRadiance%3B%5Cn%09%23ifdef%20USE_SHEEN%5Cn%09%09float%20sheenEnergyComp%20%3D%201.0%20-%200.157%20%2A%20max3%28%20material.sheenColor%20%29%3B%5Cn%09%09outgoingLight%20%3D%20outgoingLight%20%2A%20sheenEnergyComp%20%2B%20sheenSpecularDirect%20%2B%20sheenSpecularIndirect%3B%5Cn%09%23endif%5Cn%09%23ifdef%20USE_CLEARCOAT%5Cn%09%09float%20dotNVcc%20%3D%20saturate%28%20dot%28%20geometryClearcoatNormal%2C%20geometryViewDir%20%29%20%29%3B%5Cn%09%09vec3%20Fcc%20%3D%20F_Schlick%28%20material.clearcoatF0%2C%20material.clearcoatF90%2C%20dotNVcc%20%29%3B%5Cn%09%09outgoingLight%20%3D%20outgoingLight%20%2A%20%28%201.0%20-%20material.clearcoat%20%2A%20Fcc%20%29%20%2B%20%28%20clearcoatSpecularDirect%20%2B%20clearcoatSpecularIndirect%20%29%20%2A%20material.clearcoat%3B%5Cn%09%23endif%5Cn%09%23include%20%3Copaque_fragment%3E%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%09%23include%20%3Cpremultiplied_alpha_fragment%3E%5Cn%09%23include%20%3Cdithering_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%244%20%3D%20%22%23define%20TOON%5Cnvarying%20vec3%20vViewPosition%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Cdisplacementmap_pars_vertex%3E%5Cn%23include%20%3Ccolor_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Cnormal_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Cshadowmap_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09%23include%20%3Ccolor_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphcolor_vertex%3E%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%23include%20%3Cdefaultnormal_vertex%3E%5Cn%09%23include%20%3Cnormal_vertex%3E%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cdisplacementmap_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09vViewPosition%20%3D%20-%20mvPosition.xyz%3B%5Cn%09%23include%20%3Cworldpos_vertex%3E%5Cn%09%23include%20%3Cshadowmap_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%7D%22%3B%0Avar%20fragment%244%20%3D%20%22%23define%20TOON%5Cnuniform%20vec3%20diffuse%3B%5Cnuniform%20vec3%20emissive%3B%5Cnuniform%20float%20opacity%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cpacking%3E%5Cn%23include%20%3Cdithering_pars_fragment%3E%5Cn%23include%20%3Ccolor_pars_fragment%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Calphamap_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Caomap_pars_fragment%3E%5Cn%23include%20%3Clightmap_pars_fragment%3E%5Cn%23include%20%3Cemissivemap_pars_fragment%3E%5Cn%23include%20%3Cgradientmap_pars_fragment%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Cbsdfs%3E%5Cn%23include%20%3Clights_pars_begin%3E%5Cn%23include%20%3Cnormal_pars_fragment%3E%5Cn%23include%20%3Clights_toon_pars_fragment%3E%5Cn%23include%20%3Cshadowmap_pars_fragment%3E%5Cn%23include%20%3Cbumpmap_pars_fragment%3E%5Cn%23include%20%3Cnormalmap_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%20diffuse%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09ReflectedLight%20reflectedLight%20%3D%20ReflectedLight%28%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%2C%20vec3%28%200.0%20%29%20%29%3B%5Cn%09vec3%20totalEmissiveRadiance%20%3D%20emissive%3B%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Ccolor_fragment%3E%5Cn%09%23include%20%3Calphamap_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09%23include%20%3Cnormal_fragment_begin%3E%5Cn%09%23include%20%3Cnormal_fragment_maps%3E%5Cn%09%23include%20%3Cemissivemap_fragment%3E%5Cn%09%23include%20%3Clights_toon_fragment%3E%5Cn%09%23include%20%3Clights_fragment_begin%3E%5Cn%09%23include%20%3Clights_fragment_maps%3E%5Cn%09%23include%20%3Clights_fragment_end%3E%5Cn%09%23include%20%3Caomap_fragment%3E%5Cn%09vec3%20outgoingLight%20%3D%20reflectedLight.directDiffuse%20%2B%20reflectedLight.indirectDiffuse%20%2B%20totalEmissiveRadiance%3B%5Cn%09%23include%20%3Copaque_fragment%3E%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%09%23include%20%3Cpremultiplied_alpha_fragment%3E%5Cn%09%23include%20%3Cdithering_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%243%20%3D%20%22uniform%20float%20size%3B%5Cnuniform%20float%20scale%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Ccolor_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cn%23ifdef%20USE_POINTS_UV%5Cn%09varying%20vec2%20vUv%3B%5Cn%09uniform%20mat3%20uvTransform%3B%5Cn%23endif%5Cnvoid%20main%28%29%20%7B%5Cn%09%23ifdef%20USE_POINTS_UV%5Cn%09%09vUv%20%3D%20%28%20uvTransform%20%2A%20vec3%28%20uv%2C%201%20%29%20%29.xy%3B%5Cn%09%23endif%5Cn%09%23include%20%3Ccolor_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphcolor_vertex%3E%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09gl_PointSize%20%3D%20size%3B%5Cn%09%23ifdef%20USE_SIZEATTENUATION%5Cn%09%09bool%20isPerspective%20%3D%20isPerspectiveMatrix%28%20projectionMatrix%20%29%3B%5Cn%09%09if%20%28%20isPerspective%20%29%20gl_PointSize%20%2A%3D%20%28%20scale%20%2F%20-%20mvPosition.z%20%29%3B%5Cn%09%23endif%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09%23include%20%3Cworldpos_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%7D%22%3B%0Avar%20fragment%243%20%3D%20%22uniform%20vec3%20diffuse%3B%5Cnuniform%20float%20opacity%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Ccolor_pars_fragment%3E%5Cn%23include%20%3Cmap_particle_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%20diffuse%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09vec3%20outgoingLight%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cmap_particle_fragment%3E%5Cn%09%23include%20%3Ccolor_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09outgoingLight%20%3D%20diffuseColor.rgb%3B%5Cn%09%23include%20%3Copaque_fragment%3E%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%09%23include%20%3Cpremultiplied_alpha_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%242%20%3D%20%22%23include%20%3Ccommon%3E%5Cn%23include%20%3Cbatching_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Cmorphtarget_pars_vertex%3E%5Cn%23include%20%3Cskinning_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cshadowmap_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cbatching_vertex%3E%5Cn%09%23include%20%3Cbeginnormal_vertex%3E%5Cn%09%23include%20%3Cmorphinstance_vertex%3E%5Cn%09%23include%20%3Cmorphnormal_vertex%3E%5Cn%09%23include%20%3Cskinbase_vertex%3E%5Cn%09%23include%20%3Cskinnormal_vertex%3E%5Cn%09%23include%20%3Cdefaultnormal_vertex%3E%5Cn%09%23include%20%3Cbegin_vertex%3E%5Cn%09%23include%20%3Cmorphtarget_vertex%3E%5Cn%09%23include%20%3Cskinning_vertex%3E%5Cn%09%23include%20%3Cproject_vertex%3E%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cworldpos_vertex%3E%5Cn%09%23include%20%3Cshadowmap_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%7D%22%3B%0Avar%20fragment%242%20%3D%20%22uniform%20vec3%20color%3B%5Cnuniform%20float%20opacity%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cpacking%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Cbsdfs%3E%5Cn%23include%20%3Clights_pars_begin%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cshadowmap_pars_fragment%3E%5Cn%23include%20%3Cshadowmask_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09gl_FragColor%20%3D%20vec4%28%20color%2C%20opacity%20%2A%20%28%201.0%20-%20getShadowMask%28%29%20%29%20%29%3B%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%7D%22%3B%0Avar%20vertex%241%20%3D%20%22uniform%20float%20rotation%3B%5Cnuniform%20vec2%20center%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cuv_pars_vertex%3E%5Cn%23include%20%3Cfog_pars_vertex%3E%5Cn%23include%20%3Clogdepthbuf_pars_vertex%3E%5Cn%23include%20%3Cclipping_planes_pars_vertex%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09%23include%20%3Cuv_vertex%3E%5Cn%09vec4%20mvPosition%20%3D%20modelViewMatrix%5B%203%20%5D%3B%5Cn%09vec2%20scale%20%3D%20vec2%28%20length%28%20modelMatrix%5B%200%20%5D.xyz%20%29%2C%20length%28%20modelMatrix%5B%201%20%5D.xyz%20%29%20%29%3B%5Cn%09%23ifndef%20USE_SIZEATTENUATION%5Cn%09%09bool%20isPerspective%20%3D%20isPerspectiveMatrix%28%20projectionMatrix%20%29%3B%5Cn%09%09if%20%28%20isPerspective%20%29%20scale%20%2A%3D%20-%20mvPosition.z%3B%5Cn%09%23endif%5Cn%09vec2%20alignedPosition%20%3D%20%28%20position.xy%20-%20%28%20center%20-%20vec2%28%200.5%20%29%20%29%20%29%20%2A%20scale%3B%5Cn%09vec2%20rotatedPosition%3B%5Cn%09rotatedPosition.x%20%3D%20cos%28%20rotation%20%29%20%2A%20alignedPosition.x%20-%20sin%28%20rotation%20%29%20%2A%20alignedPosition.y%3B%5Cn%09rotatedPosition.y%20%3D%20sin%28%20rotation%20%29%20%2A%20alignedPosition.x%20%2B%20cos%28%20rotation%20%29%20%2A%20alignedPosition.y%3B%5Cn%09mvPosition.xy%20%2B%3D%20rotatedPosition%3B%5Cn%09gl_Position%20%3D%20projectionMatrix%20%2A%20mvPosition%3B%5Cn%09%23include%20%3Clogdepthbuf_vertex%3E%5Cn%09%23include%20%3Cclipping_planes_vertex%3E%5Cn%09%23include%20%3Cfog_vertex%3E%5Cn%7D%22%3B%0Avar%20fragment%241%20%3D%20%22uniform%20vec3%20diffuse%3B%5Cnuniform%20float%20opacity%3B%5Cn%23include%20%3Ccommon%3E%5Cn%23include%20%3Cuv_pars_fragment%3E%5Cn%23include%20%3Cmap_pars_fragment%3E%5Cn%23include%20%3Calphamap_pars_fragment%3E%5Cn%23include%20%3Calphatest_pars_fragment%3E%5Cn%23include%20%3Calphahash_pars_fragment%3E%5Cn%23include%20%3Cfog_pars_fragment%3E%5Cn%23include%20%3Clogdepthbuf_pars_fragment%3E%5Cn%23include%20%3Cclipping_planes_pars_fragment%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09vec4%20diffuseColor%20%3D%20vec4%28%20diffuse%2C%20opacity%20%29%3B%5Cn%09%23include%20%3Cclipping_planes_fragment%3E%5Cn%09vec3%20outgoingLight%20%3D%20vec3%28%200.0%20%29%3B%5Cn%09%23include%20%3Clogdepthbuf_fragment%3E%5Cn%09%23include%20%3Cmap_fragment%3E%5Cn%09%23include%20%3Calphamap_fragment%3E%5Cn%09%23include%20%3Calphatest_fragment%3E%5Cn%09%23include%20%3Calphahash_fragment%3E%5Cn%09outgoingLight%20%3D%20diffuseColor.rgb%3B%5Cn%09%23include%20%3Copaque_fragment%3E%5Cn%09%23include%20%3Ctonemapping_fragment%3E%5Cn%09%23include%20%3Ccolorspace_fragment%3E%5Cn%09%23include%20%3Cfog_fragment%3E%5Cn%7D%22%3B%0Avar%20ShaderChunk%20%3D%20%7B%0A%20%20alphahash_fragment%2C%0A%20%20alphahash_pars_fragment%2C%0A%20%20alphamap_fragment%2C%0A%20%20alphamap_pars_fragment%2C%0A%20%20alphatest_fragment%2C%0A%20%20alphatest_pars_fragment%2C%0A%20%20aomap_fragment%2C%0A%20%20aomap_pars_fragment%2C%0A%20%20batching_pars_vertex%2C%0A%20%20batching_vertex%2C%0A%20%20begin_vertex%2C%0A%20%20beginnormal_vertex%2C%0A%20%20bsdfs%2C%0A%20%20iridescence_fragment%2C%0A%20%20bumpmap_pars_fragment%2C%0A%20%20clipping_planes_fragment%2C%0A%20%20clipping_planes_pars_fragment%2C%0A%20%20clipping_planes_pars_vertex%2C%0A%20%20clipping_planes_vertex%2C%0A%20%20color_fragment%2C%0A%20%20color_pars_fragment%2C%0A%20%20color_pars_vertex%2C%0A%20%20color_vertex%2C%0A%20%20common%2C%0A%20%20cube_uv_reflection_fragment%2C%0A%20%20defaultnormal_vertex%2C%0A%20%20displacementmap_pars_vertex%2C%0A%20%20displacementmap_vertex%2C%0A%20%20emissivemap_fragment%2C%0A%20%20emissivemap_pars_fragment%2C%0A%20%20colorspace_fragment%2C%0A%20%20colorspace_pars_fragment%2C%0A%20%20envmap_fragment%2C%0A%20%20envmap_common_pars_fragment%2C%0A%20%20envmap_pars_fragment%2C%0A%20%20envmap_pars_vertex%2C%0A%20%20envmap_physical_pars_fragment%2C%0A%20%20envmap_vertex%2C%0A%20%20fog_vertex%2C%0A%20%20fog_pars_vertex%2C%0A%20%20fog_fragment%2C%0A%20%20fog_pars_fragment%2C%0A%20%20gradientmap_pars_fragment%2C%0A%20%20lightmap_pars_fragment%2C%0A%20%20lights_lambert_fragment%2C%0A%20%20lights_lambert_pars_fragment%2C%0A%20%20lights_pars_begin%2C%0A%20%20lights_toon_fragment%2C%0A%20%20lights_toon_pars_fragment%2C%0A%20%20lights_phong_fragment%2C%0A%20%20lights_phong_pars_fragment%2C%0A%20%20lights_physical_fragment%2C%0A%20%20lights_physical_pars_fragment%2C%0A%20%20lights_fragment_begin%2C%0A%20%20lights_fragment_maps%2C%0A%20%20lights_fragment_end%2C%0A%20%20logdepthbuf_fragment%2C%0A%20%20logdepthbuf_pars_fragment%2C%0A%20%20logdepthbuf_pars_vertex%2C%0A%20%20logdepthbuf_vertex%2C%0A%20%20map_fragment%2C%0A%20%20map_pars_fragment%2C%0A%20%20map_particle_fragment%2C%0A%20%20map_particle_pars_fragment%2C%0A%20%20metalnessmap_fragment%2C%0A%20%20metalnessmap_pars_fragment%2C%0A%20%20morphinstance_vertex%2C%0A%20%20morphcolor_vertex%2C%0A%20%20morphnormal_vertex%2C%0A%20%20morphtarget_pars_vertex%2C%0A%20%20morphtarget_vertex%2C%0A%20%20normal_fragment_begin%2C%0A%20%20normal_fragment_maps%2C%0A%20%20normal_pars_fragment%2C%0A%20%20normal_pars_vertex%2C%0A%20%20normal_vertex%2C%0A%20%20normalmap_pars_fragment%2C%0A%20%20clearcoat_normal_fragment_begin%2C%0A%20%20clearcoat_normal_fragment_maps%2C%0A%20%20clearcoat_pars_fragment%2C%0A%20%20iridescence_pars_fragment%2C%0A%20%20opaque_fragment%2C%0A%20%20packing%2C%0A%20%20premultiplied_alpha_fragment%2C%0A%20%20project_vertex%2C%0A%20%20dithering_fragment%2C%0A%20%20dithering_pars_fragment%2C%0A%20%20roughnessmap_fragment%2C%0A%20%20roughnessmap_pars_fragment%2C%0A%20%20shadowmap_pars_fragment%2C%0A%20%20shadowmap_pars_vertex%2C%0A%20%20shadowmap_vertex%2C%0A%20%20shadowmask_pars_fragment%2C%0A%20%20skinbase_vertex%2C%0A%20%20skinning_pars_vertex%2C%0A%20%20skinning_vertex%2C%0A%20%20skinnormal_vertex%2C%0A%20%20specularmap_fragment%2C%0A%20%20specularmap_pars_fragment%2C%0A%20%20tonemapping_fragment%2C%0A%20%20tonemapping_pars_fragment%2C%0A%20%20transmission_fragment%2C%0A%20%20transmission_pars_fragment%2C%0A%20%20uv_pars_fragment%2C%0A%20%20uv_pars_vertex%2C%0A%20%20uv_vertex%2C%0A%20%20worldpos_vertex%2C%0A%20%20background_vert%3A%20vertex%24h%2C%0A%20%20background_frag%3A%20fragment%24h%2C%0A%20%20backgroundCube_vert%3A%20vertex%24g%2C%0A%20%20backgroundCube_frag%3A%20fragment%24g%2C%0A%20%20cube_vert%3A%20vertex%24f%2C%0A%20%20cube_frag%3A%20fragment%24f%2C%0A%20%20depth_vert%3A%20vertex%24e%2C%0A%20%20depth_frag%3A%20fragment%24e%2C%0A%20%20distanceRGBA_vert%3A%20vertex%24d%2C%0A%20%20distanceRGBA_frag%3A%20fragment%24d%2C%0A%20%20equirect_vert%3A%20vertex%24c%2C%0A%20%20equirect_frag%3A%20fragment%24c%2C%0A%20%20linedashed_vert%3A%20vertex%24b%2C%0A%20%20linedashed_frag%3A%20fragment%24b%2C%0A%20%20meshbasic_vert%3A%20vertex%24a%2C%0A%20%20meshbasic_frag%3A%20fragment%24a%2C%0A%20%20meshlambert_vert%3A%20vertex%249%2C%0A%20%20meshlambert_frag%3A%20fragment%249%2C%0A%20%20meshmatcap_vert%3A%20vertex%248%2C%0A%20%20meshmatcap_frag%3A%20fragment%248%2C%0A%20%20meshnormal_vert%3A%20vertex%247%2C%0A%20%20meshnormal_frag%3A%20fragment%247%2C%0A%20%20meshphong_vert%3A%20vertex%246%2C%0A%20%20meshphong_frag%3A%20fragment%246%2C%0A%20%20meshphysical_vert%3A%20vertex%245%2C%0A%20%20meshphysical_frag%3A%20fragment%245%2C%0A%20%20meshtoon_vert%3A%20vertex%244%2C%0A%20%20meshtoon_frag%3A%20fragment%244%2C%0A%20%20points_vert%3A%20vertex%243%2C%0A%20%20points_frag%3A%20fragment%243%2C%0A%20%20shadow_vert%3A%20vertex%242%2C%0A%20%20shadow_frag%3A%20fragment%242%2C%0A%20%20sprite_vert%3A%20vertex%241%2C%0A%20%20sprite_frag%3A%20fragment%241%0A%7D%3B%0Avar%20UniformsLib%20%3D%20%7B%0A%20%20common%3A%20%7B%0A%20%20%20%20diffuse%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%2816777215%29%20%7D%2C%0A%20%20%20%20opacity%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20map%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20mapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20alphaMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20alphaMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20alphaTest%3A%20%7B%20value%3A%200%20%7D%0A%20%20%7D%2C%0A%20%20specularmap%3A%20%7B%0A%20%20%20%20specularMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20specularMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%0A%20%20%7D%2C%0A%20%20envmap%3A%20%7B%0A%20%20%20%20envMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20envMapRotation%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20flipEnvMap%3A%20%7B%20value%3A%20-1%20%7D%2C%0A%20%20%20%20reflectivity%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20%2F%2F%20basic%2C%20lambert%2C%20phong%0A%20%20%20%20ior%3A%20%7B%20value%3A%201.5%20%7D%2C%0A%20%20%20%20%2F%2F%20physical%0A%20%20%20%20refractionRatio%3A%20%7B%20value%3A%200.98%20%7D%0A%20%20%20%20%2F%2F%20basic%2C%20lambert%2C%20phong%0A%20%20%7D%2C%0A%20%20aomap%3A%20%7B%0A%20%20%20%20aoMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20aoMapIntensity%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20aoMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%0A%20%20%7D%2C%0A%20%20lightmap%3A%20%7B%0A%20%20%20%20lightMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20lightMapIntensity%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20lightMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%0A%20%20%7D%2C%0A%20%20bumpmap%3A%20%7B%0A%20%20%20%20bumpMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20bumpMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20bumpScale%3A%20%7B%20value%3A%201%20%7D%0A%20%20%7D%2C%0A%20%20normalmap%3A%20%7B%0A%20%20%20%20normalMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20normalMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20normalScale%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector2%281%2C%201%29%20%7D%0A%20%20%7D%2C%0A%20%20displacementmap%3A%20%7B%0A%20%20%20%20displacementMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20displacementMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20displacementScale%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20displacementBias%3A%20%7B%20value%3A%200%20%7D%0A%20%20%7D%2C%0A%20%20emissivemap%3A%20%7B%0A%20%20%20%20emissiveMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20emissiveMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%0A%20%20%7D%2C%0A%20%20metalnessmap%3A%20%7B%0A%20%20%20%20metalnessMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20metalnessMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%0A%20%20%7D%2C%0A%20%20roughnessmap%3A%20%7B%0A%20%20%20%20roughnessMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20roughnessMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%0A%20%20%7D%2C%0A%20%20gradientmap%3A%20%7B%0A%20%20%20%20gradientMap%3A%20%7B%20value%3A%20null%20%7D%0A%20%20%7D%2C%0A%20%20fog%3A%20%7B%0A%20%20%20%20fogDensity%3A%20%7B%20value%3A%2025e-5%20%7D%2C%0A%20%20%20%20fogNear%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20fogFar%3A%20%7B%20value%3A%202e3%20%7D%2C%0A%20%20%20%20fogColor%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%2816777215%29%20%7D%0A%20%20%7D%2C%0A%20%20lights%3A%20%7B%0A%20%20%20%20ambientLightColor%3A%20%7B%20value%3A%20%5B%5D%20%7D%2C%0A%20%20%20%20lightProbe%3A%20%7B%20value%3A%20%5B%5D%20%7D%2C%0A%20%20%20%20directionalLights%3A%20%7B%20value%3A%20%5B%5D%2C%20properties%3A%20%7B%0A%20%20%20%20%20%20direction%3A%20%7B%7D%2C%0A%20%20%20%20%20%20color%3A%20%7B%7D%0A%20%20%20%20%7D%20%7D%2C%0A%20%20%20%20directionalLightShadows%3A%20%7B%20value%3A%20%5B%5D%2C%20properties%3A%20%7B%0A%20%20%20%20%20%20shadowIntensity%3A%201%2C%0A%20%20%20%20%20%20shadowBias%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowNormalBias%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowRadius%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowMapSize%3A%20%7B%7D%0A%20%20%20%20%7D%20%7D%2C%0A%20%20%20%20directionalShadowMap%3A%20%7B%20value%3A%20%5B%5D%20%7D%2C%0A%20%20%20%20directionalShadowMatrix%3A%20%7B%20value%3A%20%5B%5D%20%7D%2C%0A%20%20%20%20spotLights%3A%20%7B%20value%3A%20%5B%5D%2C%20properties%3A%20%7B%0A%20%20%20%20%20%20color%3A%20%7B%7D%2C%0A%20%20%20%20%20%20position%3A%20%7B%7D%2C%0A%20%20%20%20%20%20direction%3A%20%7B%7D%2C%0A%20%20%20%20%20%20distance%3A%20%7B%7D%2C%0A%20%20%20%20%20%20coneCos%3A%20%7B%7D%2C%0A%20%20%20%20%20%20penumbraCos%3A%20%7B%7D%2C%0A%20%20%20%20%20%20decay%3A%20%7B%7D%0A%20%20%20%20%7D%20%7D%2C%0A%20%20%20%20spotLightShadows%3A%20%7B%20value%3A%20%5B%5D%2C%20properties%3A%20%7B%0A%20%20%20%20%20%20shadowIntensity%3A%201%2C%0A%20%20%20%20%20%20shadowBias%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowNormalBias%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowRadius%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowMapSize%3A%20%7B%7D%0A%20%20%20%20%7D%20%7D%2C%0A%20%20%20%20spotLightMap%3A%20%7B%20value%3A%20%5B%5D%20%7D%2C%0A%20%20%20%20spotShadowMap%3A%20%7B%20value%3A%20%5B%5D%20%7D%2C%0A%20%20%20%20spotLightMatrix%3A%20%7B%20value%3A%20%5B%5D%20%7D%2C%0A%20%20%20%20pointLights%3A%20%7B%20value%3A%20%5B%5D%2C%20properties%3A%20%7B%0A%20%20%20%20%20%20color%3A%20%7B%7D%2C%0A%20%20%20%20%20%20position%3A%20%7B%7D%2C%0A%20%20%20%20%20%20decay%3A%20%7B%7D%2C%0A%20%20%20%20%20%20distance%3A%20%7B%7D%0A%20%20%20%20%7D%20%7D%2C%0A%20%20%20%20pointLightShadows%3A%20%7B%20value%3A%20%5B%5D%2C%20properties%3A%20%7B%0A%20%20%20%20%20%20shadowIntensity%3A%201%2C%0A%20%20%20%20%20%20shadowBias%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowNormalBias%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowRadius%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowMapSize%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowCameraNear%3A%20%7B%7D%2C%0A%20%20%20%20%20%20shadowCameraFar%3A%20%7B%7D%0A%20%20%20%20%7D%20%7D%2C%0A%20%20%20%20pointShadowMap%3A%20%7B%20value%3A%20%5B%5D%20%7D%2C%0A%20%20%20%20pointShadowMatrix%3A%20%7B%20value%3A%20%5B%5D%20%7D%2C%0A%20%20%20%20hemisphereLights%3A%20%7B%20value%3A%20%5B%5D%2C%20properties%3A%20%7B%0A%20%20%20%20%20%20direction%3A%20%7B%7D%2C%0A%20%20%20%20%20%20skyColor%3A%20%7B%7D%2C%0A%20%20%20%20%20%20groundColor%3A%20%7B%7D%0A%20%20%20%20%7D%20%7D%2C%0A%20%20%20%20%2F%2F%20TODO%20%28abelnation%29%3A%20RectAreaLight%20BRDF%20data%20needs%20to%20be%20moved%20from%20example%20to%20main%20src%0A%20%20%20%20rectAreaLights%3A%20%7B%20value%3A%20%5B%5D%2C%20properties%3A%20%7B%0A%20%20%20%20%20%20color%3A%20%7B%7D%2C%0A%20%20%20%20%20%20position%3A%20%7B%7D%2C%0A%20%20%20%20%20%20width%3A%20%7B%7D%2C%0A%20%20%20%20%20%20height%3A%20%7B%7D%0A%20%20%20%20%7D%20%7D%2C%0A%20%20%20%20ltc_1%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20ltc_2%3A%20%7B%20value%3A%20null%20%7D%0A%20%20%7D%2C%0A%20%20points%3A%20%7B%0A%20%20%20%20diffuse%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%2816777215%29%20%7D%2C%0A%20%20%20%20opacity%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20size%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20scale%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20map%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20alphaMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20alphaMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20alphaTest%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20uvTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%0A%20%20%7D%2C%0A%20%20sprite%3A%20%7B%0A%20%20%20%20diffuse%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%2816777215%29%20%7D%2C%0A%20%20%20%20opacity%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20center%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector2%280.5%2C%200.5%29%20%7D%2C%0A%20%20%20%20rotation%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20map%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20mapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20alphaMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20alphaMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20alphaTest%3A%20%7B%20value%3A%200%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20ShaderLib%20%3D%20%7B%0A%20%20basic%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.specularmap%2C%0A%20%20%20%20%20%20UniformsLib.envmap%2C%0A%20%20%20%20%20%20UniformsLib.aomap%2C%0A%20%20%20%20%20%20UniformsLib.lightmap%2C%0A%20%20%20%20%20%20UniformsLib.fog%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.meshbasic_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.meshbasic_frag%0A%20%20%7D%2C%0A%20%20lambert%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.specularmap%2C%0A%20%20%20%20%20%20UniformsLib.envmap%2C%0A%20%20%20%20%20%20UniformsLib.aomap%2C%0A%20%20%20%20%20%20UniformsLib.lightmap%2C%0A%20%20%20%20%20%20UniformsLib.emissivemap%2C%0A%20%20%20%20%20%20UniformsLib.bumpmap%2C%0A%20%20%20%20%20%20UniformsLib.normalmap%2C%0A%20%20%20%20%20%20UniformsLib.displacementmap%2C%0A%20%20%20%20%20%20UniformsLib.fog%2C%0A%20%20%20%20%20%20UniformsLib.lights%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20emissive%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%280%29%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.meshlambert_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.meshlambert_frag%0A%20%20%7D%2C%0A%20%20phong%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.specularmap%2C%0A%20%20%20%20%20%20UniformsLib.envmap%2C%0A%20%20%20%20%20%20UniformsLib.aomap%2C%0A%20%20%20%20%20%20UniformsLib.lightmap%2C%0A%20%20%20%20%20%20UniformsLib.emissivemap%2C%0A%20%20%20%20%20%20UniformsLib.bumpmap%2C%0A%20%20%20%20%20%20UniformsLib.normalmap%2C%0A%20%20%20%20%20%20UniformsLib.displacementmap%2C%0A%20%20%20%20%20%20UniformsLib.fog%2C%0A%20%20%20%20%20%20UniformsLib.lights%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20emissive%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%280%29%20%7D%2C%0A%20%20%20%20%20%20%20%20specular%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%281118481%29%20%7D%2C%0A%20%20%20%20%20%20%20%20shininess%3A%20%7B%20value%3A%2030%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.meshphong_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.meshphong_frag%0A%20%20%7D%2C%0A%20%20standard%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.envmap%2C%0A%20%20%20%20%20%20UniformsLib.aomap%2C%0A%20%20%20%20%20%20UniformsLib.lightmap%2C%0A%20%20%20%20%20%20UniformsLib.emissivemap%2C%0A%20%20%20%20%20%20UniformsLib.bumpmap%2C%0A%20%20%20%20%20%20UniformsLib.normalmap%2C%0A%20%20%20%20%20%20UniformsLib.displacementmap%2C%0A%20%20%20%20%20%20UniformsLib.roughnessmap%2C%0A%20%20%20%20%20%20UniformsLib.metalnessmap%2C%0A%20%20%20%20%20%20UniformsLib.fog%2C%0A%20%20%20%20%20%20UniformsLib.lights%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20emissive%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%280%29%20%7D%2C%0A%20%20%20%20%20%20%20%20roughness%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20%20%20metalness%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20%20%20envMapIntensity%3A%20%7B%20value%3A%201%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.meshphysical_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.meshphysical_frag%0A%20%20%7D%2C%0A%20%20toon%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.aomap%2C%0A%20%20%20%20%20%20UniformsLib.lightmap%2C%0A%20%20%20%20%20%20UniformsLib.emissivemap%2C%0A%20%20%20%20%20%20UniformsLib.bumpmap%2C%0A%20%20%20%20%20%20UniformsLib.normalmap%2C%0A%20%20%20%20%20%20UniformsLib.displacementmap%2C%0A%20%20%20%20%20%20UniformsLib.gradientmap%2C%0A%20%20%20%20%20%20UniformsLib.fog%2C%0A%20%20%20%20%20%20UniformsLib.lights%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20emissive%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%280%29%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.meshtoon_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.meshtoon_frag%0A%20%20%7D%2C%0A%20%20matcap%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.bumpmap%2C%0A%20%20%20%20%20%20UniformsLib.normalmap%2C%0A%20%20%20%20%20%20UniformsLib.displacementmap%2C%0A%20%20%20%20%20%20UniformsLib.fog%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20matcap%3A%20%7B%20value%3A%20null%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.meshmatcap_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.meshmatcap_frag%0A%20%20%7D%2C%0A%20%20points%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.points%2C%0A%20%20%20%20%20%20UniformsLib.fog%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.points_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.points_frag%0A%20%20%7D%2C%0A%20%20dashed%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.fog%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20scale%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20%20%20dashSize%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20%20%20totalSize%3A%20%7B%20value%3A%202%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.linedashed_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.linedashed_frag%0A%20%20%7D%2C%0A%20%20depth%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.displacementmap%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.depth_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.depth_frag%0A%20%20%7D%2C%0A%20%20normal%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.bumpmap%2C%0A%20%20%20%20%20%20UniformsLib.normalmap%2C%0A%20%20%20%20%20%20UniformsLib.displacementmap%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20opacity%3A%20%7B%20value%3A%201%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.meshnormal_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.meshnormal_frag%0A%20%20%7D%2C%0A%20%20sprite%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.sprite%2C%0A%20%20%20%20%20%20UniformsLib.fog%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.sprite_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.sprite_frag%0A%20%20%7D%2C%0A%20%20background%3A%20%7B%0A%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20uvTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20t2D%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20backgroundIntensity%3A%20%7B%20value%3A%201%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.background_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.background_frag%0A%20%20%7D%2C%0A%20%20backgroundCube%3A%20%7B%0A%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20envMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20flipEnvMap%3A%20%7B%20value%3A%20-1%20%7D%2C%0A%20%20%20%20%20%20backgroundBlurriness%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20backgroundIntensity%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20backgroundRotation%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.backgroundCube_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.backgroundCube_frag%0A%20%20%7D%2C%0A%20%20cube%3A%20%7B%0A%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20tCube%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20tFlip%3A%20%7B%20value%3A%20-1%20%7D%2C%0A%20%20%20%20%20%20opacity%3A%20%7B%20value%3A%201%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.cube_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.cube_frag%0A%20%20%7D%2C%0A%20%20equirect%3A%20%7B%0A%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20tEquirect%3A%20%7B%20value%3A%20null%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.equirect_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.equirect_frag%0A%20%20%7D%2C%0A%20%20distanceRGBA%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.common%2C%0A%20%20%20%20%20%20UniformsLib.displacementmap%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20referencePosition%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%20%7D%2C%0A%20%20%20%20%20%20%20%20nearDistance%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20%20%20farDistance%3A%20%7B%20value%3A%201e3%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.distanceRGBA_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.distanceRGBA_frag%0A%20%20%7D%2C%0A%20%20shadow%3A%20%7B%0A%20%20%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20%20%20UniformsLib.lights%2C%0A%20%20%20%20%20%20UniformsLib.fog%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20color%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%280%29%20%7D%2C%0A%20%20%20%20%20%20%20%20opacity%3A%20%7B%20value%3A%201%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%29%2C%0A%20%20%20%20vertexShader%3A%20ShaderChunk.shadow_vert%2C%0A%20%20%20%20fragmentShader%3A%20ShaderChunk.shadow_frag%0A%20%20%7D%0A%7D%3B%0AShaderLib.physical%20%3D%20%7B%0A%20%20uniforms%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20mergeUniforms%28%5B%0A%20%20%20%20ShaderLib.standard.uniforms%2C%0A%20%20%20%20%7B%0A%20%20%20%20%20%20clearcoat%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20clearcoatMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20clearcoatMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20clearcoatNormalMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20clearcoatNormalMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20clearcoatNormalScale%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector2%281%2C%201%29%20%7D%2C%0A%20%20%20%20%20%20clearcoatRoughness%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20clearcoatRoughnessMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20clearcoatRoughnessMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20dispersion%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20iridescence%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20iridescenceMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20iridescenceMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20iridescenceIOR%3A%20%7B%20value%3A%201.3%20%7D%2C%0A%20%20%20%20%20%20iridescenceThicknessMinimum%3A%20%7B%20value%3A%20100%20%7D%2C%0A%20%20%20%20%20%20iridescenceThicknessMaximum%3A%20%7B%20value%3A%20400%20%7D%2C%0A%20%20%20%20%20%20iridescenceThicknessMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20iridescenceThicknessMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20sheen%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20sheenColor%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%280%29%20%7D%2C%0A%20%20%20%20%20%20sheenColorMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20sheenColorMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20sheenRoughness%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20sheenRoughnessMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20sheenRoughnessMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20transmission%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20transmissionMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20transmissionMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20transmissionSamplerSize%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector2%28%29%20%7D%2C%0A%20%20%20%20%20%20transmissionSamplerMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20thickness%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20thicknessMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20thicknessMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20attenuationDistance%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20attenuationColor%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%280%29%20%7D%2C%0A%20%20%20%20%20%20specularColor%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%281%2C%201%2C%201%29%20%7D%2C%0A%20%20%20%20%20%20specularColorMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20specularColorMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20specularIntensity%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20specularIntensityMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20specularIntensityMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%2C%0A%20%20%20%20%20%20anisotropyVector%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector2%28%29%20%7D%2C%0A%20%20%20%20%20%20anisotropyMap%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20anisotropyMapTransform%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%20%7D%0A%20%20%20%20%7D%0A%20%20%5D%29%2C%0A%20%20vertexShader%3A%20ShaderChunk.meshphysical_vert%2C%0A%20%20fragmentShader%3A%20ShaderChunk.meshphysical_frag%0A%7D%3B%0Avar%20_rgb%20%3D%20%7B%20r%3A%200%2C%20b%3A%200%2C%20g%3A%200%20%7D%3B%0Avar%20_e1%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Euler%28%29%3B%0Avar%20_m1%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Afunction%20WebGLBackground%28renderer3%2C%20cubemaps%2C%20cubeuvmaps%2C%20state%2C%20objects%2C%20alpha%2C%20premultipliedAlpha%29%20%7B%0A%20%20const%20clearColor%20%3D%20new%20Color%280%29%3B%0A%20%20let%20clearAlpha%20%3D%20alpha%20%3D%3D%3D%20true%20%3F%200%20%3A%201%3B%0A%20%20let%20planeMesh%3B%0A%20%20let%20boxMesh%3B%0A%20%20let%20currentBackground%20%3D%20null%3B%0A%20%20let%20currentBackgroundVersion%20%3D%200%3B%0A%20%20let%20currentTonemapping%20%3D%20null%3B%0A%20%20function%20getBackground%28scene3%29%20%7B%0A%20%20%20%20let%20background%20%3D%20scene3.isScene%20%3D%3D%3D%20true%20%3F%20scene3.background%20%3A%20null%3B%0A%20%20%20%20if%20%28background%20%26%26%20background.isTexture%29%20%7B%0A%20%20%20%20%20%20const%20usePMREM%20%3D%20scene3.backgroundBlurriness%20%3E%200%3B%0A%20%20%20%20%20%20background%20%3D%20%28usePMREM%20%3F%20cubeuvmaps%20%3A%20cubemaps%29.get%28background%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20background%3B%0A%20%20%7D%0A%20%20function%20render%28scene3%29%20%7B%0A%20%20%20%20let%20forceClear%20%3D%20false%3B%0A%20%20%20%20const%20background%20%3D%20getBackground%28scene3%29%3B%0A%20%20%20%20if%20%28background%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20setClear%28clearColor%2C%20clearAlpha%29%3B%0A%20%20%20%20%7D%20else%20if%20%28background%20%26%26%20background.isColor%29%20%7B%0A%20%20%20%20%20%20setClear%28background%2C%201%29%3B%0A%20%20%20%20%20%20forceClear%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20environmentBlendMode%20%3D%20renderer3.xr.getEnvironmentBlendMode%28%29%3B%0A%20%20%20%20if%20%28environmentBlendMode%20%3D%3D%3D%20%22additive%22%29%20%7B%0A%20%20%20%20%20%20state.buffers.color.setClear%280%2C%200%2C%200%2C%201%2C%20premultipliedAlpha%29%3B%0A%20%20%20%20%7D%20else%20if%20%28environmentBlendMode%20%3D%3D%3D%20%22alpha-blend%22%29%20%7B%0A%20%20%20%20%20%20state.buffers.color.setClear%280%2C%200%2C%200%2C%200%2C%20premultipliedAlpha%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderer3.autoClear%20%7C%7C%20forceClear%29%20%7B%0A%20%20%20%20%20%20state.buffers.depth.setTest%28true%29%3B%0A%20%20%20%20%20%20state.buffers.depth.setMask%28true%29%3B%0A%20%20%20%20%20%20state.buffers.color.setMask%28true%29%3B%0A%20%20%20%20%20%20renderer3.clear%28renderer3.autoClearColor%2C%20renderer3.autoClearDepth%2C%20renderer3.autoClearStencil%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20addToRenderList%28renderList%2C%20scene3%29%20%7B%0A%20%20%20%20const%20background%20%3D%20getBackground%28scene3%29%3B%0A%20%20%20%20if%20%28background%20%26%26%20%28background.isCubeTexture%20%7C%7C%20background.mapping%20%3D%3D%3D%20CubeUVReflectionMapping%29%29%20%7B%0A%20%20%20%20%20%20if%20%28boxMesh%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20boxMesh%20%3D%20new%20Mesh%28%0A%20%20%20%20%20%20%20%20%20%20new%20BoxGeometry%281%2C%201%2C%201%29%2C%0A%20%20%20%20%20%20%20%20%20%20new%20ShaderMaterial%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20name%3A%20%22BackgroundCubeMaterial%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20uniforms%3A%20cloneUniforms%28ShaderLib.backgroundCube.uniforms%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20vertexShader%3A%20ShaderLib.backgroundCube.vertexShader%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fragmentShader%3A%20ShaderLib.backgroundCube.fragmentShader%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20side%3A%20BackSide%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20depthTest%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20depthWrite%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fog%3A%20false%0A%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20boxMesh.geometry.deleteAttribute%28%22normal%22%29%3B%0A%20%20%20%20%20%20%20%20boxMesh.geometry.deleteAttribute%28%22uv%22%29%3B%0A%20%20%20%20%20%20%20%20boxMesh.onBeforeRender%20%3D%20function%28renderer4%2C%20scene4%2C%20camera3%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.matrixWorld.copyPosition%28camera3.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20Object.defineProperty%28boxMesh.material%2C%20%22envMap%22%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20get%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.envMap.value%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20objects.update%28boxMesh%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_e1%241.copy%28scene3.backgroundRotation%29%3B%0A%20%20%20%20%20%20_e1%241.x%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20_e1%241.y%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20_e1%241.z%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20if%20%28background.isCubeTexture%20%26%26%20background.isRenderTargetTexture%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20_e1%241.y%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20%20%20_e1%241.z%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20boxMesh.material.uniforms.envMap.value%20%3D%20background%3B%0A%20%20%20%20%20%20boxMesh.material.uniforms.flipEnvMap.value%20%3D%20background.isCubeTexture%20%26%26%20background.isRenderTargetTexture%20%3D%3D%3D%20false%20%3F%20-1%20%3A%201%3B%0A%20%20%20%20%20%20boxMesh.material.uniforms.backgroundBlurriness.value%20%3D%20scene3.backgroundBlurriness%3B%0A%20%20%20%20%20%20boxMesh.material.uniforms.backgroundIntensity.value%20%3D%20scene3.backgroundIntensity%3B%0A%20%20%20%20%20%20boxMesh.material.uniforms.backgroundRotation.value.setFromMatrix4%28_m1%241.makeRotationFromEuler%28_e1%241%29%29%3B%0A%20%20%20%20%20%20boxMesh.material.toneMapped%20%3D%20ColorManagement.getTransfer%28background.colorSpace%29%20%21%3D%3D%20SRGBTransfer%3B%0A%20%20%20%20%20%20if%20%28currentBackground%20%21%3D%3D%20background%20%7C%7C%20currentBackgroundVersion%20%21%3D%3D%20background.version%20%7C%7C%20currentTonemapping%20%21%3D%3D%20renderer3.toneMapping%29%20%7B%0A%20%20%20%20%20%20%20%20boxMesh.material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20currentBackground%20%3D%20background%3B%0A%20%20%20%20%20%20%20%20currentBackgroundVersion%20%3D%20background.version%3B%0A%20%20%20%20%20%20%20%20currentTonemapping%20%3D%20renderer3.toneMapping%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20boxMesh.layers.enableAll%28%29%3B%0A%20%20%20%20%20%20renderList.unshift%28boxMesh%2C%20boxMesh.geometry%2C%20boxMesh.material%2C%200%2C%200%2C%20null%29%3B%0A%20%20%20%20%7D%20else%20if%20%28background%20%26%26%20background.isTexture%29%20%7B%0A%20%20%20%20%20%20if%20%28planeMesh%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20planeMesh%20%3D%20new%20Mesh%28%0A%20%20%20%20%20%20%20%20%20%20new%20PlaneGeometry%282%2C%202%29%2C%0A%20%20%20%20%20%20%20%20%20%20new%20ShaderMaterial%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20name%3A%20%22BackgroundMaterial%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20uniforms%3A%20cloneUniforms%28ShaderLib.background.uniforms%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20vertexShader%3A%20ShaderLib.background.vertexShader%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fragmentShader%3A%20ShaderLib.background.fragmentShader%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20side%3A%20FrontSide%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20depthTest%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20depthWrite%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fog%3A%20false%0A%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20planeMesh.geometry.deleteAttribute%28%22normal%22%29%3B%0A%20%20%20%20%20%20%20%20Object.defineProperty%28planeMesh.material%2C%20%22map%22%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20get%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.uniforms.t2D.value%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20objects.update%28planeMesh%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20planeMesh.material.uniforms.t2D.value%20%3D%20background%3B%0A%20%20%20%20%20%20planeMesh.material.uniforms.backgroundIntensity.value%20%3D%20scene3.backgroundIntensity%3B%0A%20%20%20%20%20%20planeMesh.material.toneMapped%20%3D%20ColorManagement.getTransfer%28background.colorSpace%29%20%21%3D%3D%20SRGBTransfer%3B%0A%20%20%20%20%20%20if%20%28background.matrixAutoUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20background.updateMatrix%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20planeMesh.material.uniforms.uvTransform.value.copy%28background.matrix%29%3B%0A%20%20%20%20%20%20if%20%28currentBackground%20%21%3D%3D%20background%20%7C%7C%20currentBackgroundVersion%20%21%3D%3D%20background.version%20%7C%7C%20currentTonemapping%20%21%3D%3D%20renderer3.toneMapping%29%20%7B%0A%20%20%20%20%20%20%20%20planeMesh.material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20currentBackground%20%3D%20background%3B%0A%20%20%20%20%20%20%20%20currentBackgroundVersion%20%3D%20background.version%3B%0A%20%20%20%20%20%20%20%20currentTonemapping%20%3D%20renderer3.toneMapping%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20planeMesh.layers.enableAll%28%29%3B%0A%20%20%20%20%20%20renderList.unshift%28planeMesh%2C%20planeMesh.geometry%2C%20planeMesh.material%2C%200%2C%200%2C%20null%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20setClear%28color2%2C%20alpha2%29%20%7B%0A%20%20%20%20color2.getRGB%28_rgb%2C%20getUnlitUniformColorSpace%28renderer3%29%29%3B%0A%20%20%20%20state.buffers.color.setClear%28_rgb.r%2C%20_rgb.g%2C%20_rgb.b%2C%20alpha2%2C%20premultipliedAlpha%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20getClearColor%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20clearColor%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20setClearColor%3A%20function%28color2%2C%20alpha2%20%3D%201%29%20%7B%0A%20%20%20%20%20%20clearColor.set%28color2%29%3B%0A%20%20%20%20%20%20clearAlpha%20%3D%20alpha2%3B%0A%20%20%20%20%20%20setClear%28clearColor%2C%20clearAlpha%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20getClearAlpha%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20clearAlpha%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20setClearAlpha%3A%20function%28alpha2%29%20%7B%0A%20%20%20%20%20%20clearAlpha%20%3D%20alpha2%3B%0A%20%20%20%20%20%20setClear%28clearColor%2C%20clearAlpha%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20render%2C%0A%20%20%20%20addToRenderList%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLBindingStates%28gl%2C%20attributes%29%20%7B%0A%20%20const%20maxVertexAttributes%20%3D%20gl.getParameter%28gl.MAX_VERTEX_ATTRIBS%29%3B%0A%20%20const%20bindingStates%20%3D%20%7B%7D%3B%0A%20%20const%20defaultState%20%3D%20createBindingState%28null%29%3B%0A%20%20let%20currentState%20%3D%20defaultState%3B%0A%20%20let%20forceUpdate%20%3D%20false%3B%0A%20%20function%20setup%28object%2C%20material%2C%20program%2C%20geometry%2C%20index5%29%20%7B%0A%20%20%20%20let%20updateBuffers%20%3D%20false%3B%0A%20%20%20%20const%20state%20%3D%20getBindingState%28geometry%2C%20program%2C%20material%29%3B%0A%20%20%20%20if%20%28currentState%20%21%3D%3D%20state%29%20%7B%0A%20%20%20%20%20%20currentState%20%3D%20state%3B%0A%20%20%20%20%20%20bindVertexArrayObject%28currentState.object%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20updateBuffers%20%3D%20needsUpdate%28object%2C%20geometry%2C%20program%2C%20index5%29%3B%0A%20%20%20%20if%20%28updateBuffers%29%20saveCache%28object%2C%20geometry%2C%20program%2C%20index5%29%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20attributes.update%28index5%2C%20gl.ELEMENT_ARRAY_BUFFER%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28updateBuffers%20%7C%7C%20forceUpdate%29%20%7B%0A%20%20%20%20%20%20forceUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20setupVertexAttributes%28object%2C%20material%2C%20program%2C%20geometry%29%3B%0A%20%20%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20gl.bindBuffer%28gl.ELEMENT_ARRAY_BUFFER%2C%20attributes.get%28index5%29.buffer%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20createVertexArrayObject%28%29%20%7B%0A%20%20%20%20return%20gl.createVertexArray%28%29%3B%0A%20%20%7D%0A%20%20function%20bindVertexArrayObject%28vao%29%20%7B%0A%20%20%20%20return%20gl.bindVertexArray%28vao%29%3B%0A%20%20%7D%0A%20%20function%20deleteVertexArrayObject%28vao%29%20%7B%0A%20%20%20%20return%20gl.deleteVertexArray%28vao%29%3B%0A%20%20%7D%0A%20%20function%20getBindingState%28geometry%2C%20program%2C%20material%29%20%7B%0A%20%20%20%20const%20wireframe%20%3D%20material.wireframe%20%3D%3D%3D%20true%3B%0A%20%20%20%20let%20programMap%20%3D%20bindingStates%5Bgeometry.id%5D%3B%0A%20%20%20%20if%20%28programMap%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20programMap%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20bindingStates%5Bgeometry.id%5D%20%3D%20programMap%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20stateMap%20%3D%20programMap%5Bprogram.id%5D%3B%0A%20%20%20%20if%20%28stateMap%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20stateMap%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20programMap%5Bprogram.id%5D%20%3D%20stateMap%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20state%20%3D%20stateMap%5Bwireframe%5D%3B%0A%20%20%20%20if%20%28state%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20state%20%3D%20createBindingState%28createVertexArrayObject%28%29%29%3B%0A%20%20%20%20%20%20stateMap%5Bwireframe%5D%20%3D%20state%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20state%3B%0A%20%20%7D%0A%20%20function%20createBindingState%28vao%29%20%7B%0A%20%20%20%20const%20newAttributes%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20enabledAttributes%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20attributeDivisors%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20maxVertexAttributes%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20newAttributes%5Bi%5D%20%3D%200%3B%0A%20%20%20%20%20%20enabledAttributes%5Bi%5D%20%3D%200%3B%0A%20%20%20%20%20%20attributeDivisors%5Bi%5D%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%2F%2F%20for%20backward%20compatibility%20on%20non-VAO%20support%20browser%0A%20%20%20%20%20%20geometry%3A%20null%2C%0A%20%20%20%20%20%20program%3A%20null%2C%0A%20%20%20%20%20%20wireframe%3A%20false%2C%0A%20%20%20%20%20%20newAttributes%2C%0A%20%20%20%20%20%20enabledAttributes%2C%0A%20%20%20%20%20%20attributeDivisors%2C%0A%20%20%20%20%20%20object%3A%20vao%2C%0A%20%20%20%20%20%20attributes%3A%20%7B%7D%2C%0A%20%20%20%20%20%20index%3A%20null%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20function%20needsUpdate%28object%2C%20geometry%2C%20program%2C%20index5%29%20%7B%0A%20%20%20%20const%20cachedAttributes%20%3D%20currentState.attributes%3B%0A%20%20%20%20const%20geometryAttributes%20%3D%20geometry.attributes%3B%0A%20%20%20%20let%20attributesNum%20%3D%200%3B%0A%20%20%20%20const%20programAttributes%20%3D%20program.getAttributes%28%29%3B%0A%20%20%20%20for%20%28const%20name%20in%20programAttributes%29%20%7B%0A%20%20%20%20%20%20const%20programAttribute%20%3D%20programAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20if%20%28programAttribute.location%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20cachedAttribute%20%3D%20cachedAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20%20%20let%20geometryAttribute%20%3D%20geometryAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28geometryAttribute%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20%22instanceMatrix%22%20%26%26%20object.instanceMatrix%29%20geometryAttribute%20%3D%20object.instanceMatrix%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20%22instanceColor%22%20%26%26%20object.instanceColor%29%20geometryAttribute%20%3D%20object.instanceColor%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28cachedAttribute%20%3D%3D%3D%20void%200%29%20return%20true%3B%0A%20%20%20%20%20%20%20%20if%20%28cachedAttribute.attribute%20%21%3D%3D%20geometryAttribute%29%20return%20true%3B%0A%20%20%20%20%20%20%20%20if%20%28geometryAttribute%20%26%26%20cachedAttribute.data%20%21%3D%3D%20geometryAttribute.data%29%20return%20true%3B%0A%20%20%20%20%20%20%20%20attributesNum%2B%2B%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28currentState.attributesNum%20%21%3D%3D%20attributesNum%29%20return%20true%3B%0A%20%20%20%20if%20%28currentState.index%20%21%3D%3D%20index5%29%20return%20true%3B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20function%20saveCache%28object%2C%20geometry%2C%20program%2C%20index5%29%20%7B%0A%20%20%20%20const%20cache2%20%3D%20%7B%7D%3B%0A%20%20%20%20const%20attributes2%20%3D%20geometry.attributes%3B%0A%20%20%20%20let%20attributesNum%20%3D%200%3B%0A%20%20%20%20const%20programAttributes%20%3D%20program.getAttributes%28%29%3B%0A%20%20%20%20for%20%28const%20name%20in%20programAttributes%29%20%7B%0A%20%20%20%20%20%20const%20programAttribute%20%3D%20programAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20if%20%28programAttribute.location%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20let%20attribute2%20%3D%20attributes2%5Bname%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28attribute2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20%22instanceMatrix%22%20%26%26%20object.instanceMatrix%29%20attribute2%20%3D%20object.instanceMatrix%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20%22instanceColor%22%20%26%26%20object.instanceColor%29%20attribute2%20%3D%20object.instanceColor%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20data%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20data.attribute%20%3D%20attribute2%3B%0A%20%20%20%20%20%20%20%20if%20%28attribute2%20%26%26%20attribute2.data%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20data.data%20%3D%20attribute2.data%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20cache2%5Bname%5D%20%3D%20data%3B%0A%20%20%20%20%20%20%20%20attributesNum%2B%2B%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20currentState.attributes%20%3D%20cache2%3B%0A%20%20%20%20currentState.attributesNum%20%3D%20attributesNum%3B%0A%20%20%20%20currentState.index%20%3D%20index5%3B%0A%20%20%7D%0A%20%20function%20initAttributes%28%29%20%7B%0A%20%20%20%20const%20newAttributes%20%3D%20currentState.newAttributes%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20newAttributes.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20newAttributes%5Bi%5D%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20enableAttribute%28attribute2%29%20%7B%0A%20%20%20%20enableAttributeAndDivisor%28attribute2%2C%200%29%3B%0A%20%20%7D%0A%20%20function%20enableAttributeAndDivisor%28attribute2%2C%20meshPerAttribute%29%20%7B%0A%20%20%20%20const%20newAttributes%20%3D%20currentState.newAttributes%3B%0A%20%20%20%20const%20enabledAttributes%20%3D%20currentState.enabledAttributes%3B%0A%20%20%20%20const%20attributeDivisors%20%3D%20currentState.attributeDivisors%3B%0A%20%20%20%20newAttributes%5Battribute2%5D%20%3D%201%3B%0A%20%20%20%20if%20%28enabledAttributes%5Battribute2%5D%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20gl.enableVertexAttribArray%28attribute2%29%3B%0A%20%20%20%20%20%20enabledAttributes%5Battribute2%5D%20%3D%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28attributeDivisors%5Battribute2%5D%20%21%3D%3D%20meshPerAttribute%29%20%7B%0A%20%20%20%20%20%20gl.vertexAttribDivisor%28attribute2%2C%20meshPerAttribute%29%3B%0A%20%20%20%20%20%20attributeDivisors%5Battribute2%5D%20%3D%20meshPerAttribute%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20disableUnusedAttributes%28%29%20%7B%0A%20%20%20%20const%20newAttributes%20%3D%20currentState.newAttributes%3B%0A%20%20%20%20const%20enabledAttributes%20%3D%20currentState.enabledAttributes%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20enabledAttributes.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28enabledAttributes%5Bi%5D%20%21%3D%3D%20newAttributes%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20gl.disableVertexAttribArray%28i%29%3B%0A%20%20%20%20%20%20%20%20enabledAttributes%5Bi%5D%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20vertexAttribPointer%28index5%2C%20size%2C%20type%2C%20normalized%2C%20stride%2C%20offset%2C%20integer%29%20%7B%0A%20%20%20%20if%20%28integer%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20gl.vertexAttribIPointer%28index5%2C%20size%2C%20type%2C%20stride%2C%20offset%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20gl.vertexAttribPointer%28index5%2C%20size%2C%20type%2C%20normalized%2C%20stride%2C%20offset%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20setupVertexAttributes%28object%2C%20material%2C%20program%2C%20geometry%29%20%7B%0A%20%20%20%20initAttributes%28%29%3B%0A%20%20%20%20const%20geometryAttributes%20%3D%20geometry.attributes%3B%0A%20%20%20%20const%20programAttributes%20%3D%20program.getAttributes%28%29%3B%0A%20%20%20%20const%20materialDefaultAttributeValues%20%3D%20material.defaultAttributeValues%3B%0A%20%20%20%20for%20%28const%20name%20in%20programAttributes%29%20%7B%0A%20%20%20%20%20%20const%20programAttribute%20%3D%20programAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20if%20%28programAttribute.location%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20let%20geometryAttribute%20%3D%20geometryAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28geometryAttribute%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20%22instanceMatrix%22%20%26%26%20object.instanceMatrix%29%20geometryAttribute%20%3D%20object.instanceMatrix%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20%22instanceColor%22%20%26%26%20object.instanceColor%29%20geometryAttribute%20%3D%20object.instanceColor%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28geometryAttribute%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20normalized%20%3D%20geometryAttribute.normalized%3B%0A%20%20%20%20%20%20%20%20%20%20const%20size%20%3D%20geometryAttribute.itemSize%3B%0A%20%20%20%20%20%20%20%20%20%20const%20attribute2%20%3D%20attributes.get%28geometryAttribute%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28attribute2%20%3D%3D%3D%20void%200%29%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20const%20buffer2%20%3D%20attribute2.buffer%3B%0A%20%20%20%20%20%20%20%20%20%20const%20type%20%3D%20attribute2.type%3B%0A%20%20%20%20%20%20%20%20%20%20const%20bytesPerElement%20%3D%20attribute2.bytesPerElement%3B%0A%20%20%20%20%20%20%20%20%20%20const%20integer%20%3D%20type%20%3D%3D%3D%20gl.INT%20%7C%7C%20type%20%3D%3D%3D%20gl.UNSIGNED_INT%20%7C%7C%20geometryAttribute.gpuType%20%3D%3D%3D%20IntType%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28geometryAttribute.isInterleavedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20data%20%3D%20geometryAttribute.data%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20stride%20%3D%20data.stride%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20offset%20%3D%20geometryAttribute.offset%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28data.isInstancedInterleavedBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20programAttribute.locationSize%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20enableAttributeAndDivisor%28programAttribute.location%20%2B%20i%2C%20data.meshPerAttribute%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28object.isInstancedMesh%20%21%3D%3D%20true%20%26%26%20geometry._maxInstanceCount%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20geometry._maxInstanceCount%20%3D%20data.meshPerAttribute%20%2A%20data.count%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20programAttribute.locationSize%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20enableAttribute%28programAttribute.location%20%2B%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.bindBuffer%28gl.ARRAY_BUFFER%2C%20buffer2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20programAttribute.locationSize%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20vertexAttribPointer%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20programAttribute.location%20%2B%20i%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size%20%2F%20programAttribute.locationSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20normalized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stride%20%2A%20bytesPerElement%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%28offset%20%2B%20size%20%2F%20programAttribute.locationSize%20%2A%20i%29%20%2A%20bytesPerElement%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20integer%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28geometryAttribute.isInstancedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20programAttribute.locationSize%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20enableAttributeAndDivisor%28programAttribute.location%20%2B%20i%2C%20geometryAttribute.meshPerAttribute%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28object.isInstancedMesh%20%21%3D%3D%20true%20%26%26%20geometry._maxInstanceCount%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20geometry._maxInstanceCount%20%3D%20geometryAttribute.meshPerAttribute%20%2A%20geometryAttribute.count%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20programAttribute.locationSize%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20enableAttribute%28programAttribute.location%20%2B%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.bindBuffer%28gl.ARRAY_BUFFER%2C%20buffer2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20programAttribute.locationSize%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20vertexAttribPointer%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20programAttribute.location%20%2B%20i%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size%20%2F%20programAttribute.locationSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20normalized%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size%20%2A%20bytesPerElement%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20size%20%2F%20programAttribute.locationSize%20%2A%20i%20%2A%20bytesPerElement%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20integer%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialDefaultAttributeValues%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20value%20%3D%20materialDefaultAttributeValues%5Bname%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20switch%20%28value.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.vertexAttrib2fv%28programAttribute.location%2C%20value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.vertexAttrib3fv%28programAttribute.location%2C%20value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%204%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.vertexAttrib4fv%28programAttribute.location%2C%20value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.vertexAttrib1fv%28programAttribute.location%2C%20value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20disableUnusedAttributes%28%29%3B%0A%20%20%7D%0A%20%20function%20dispose%28%29%20%7B%0A%20%20%20%20reset%28%29%3B%0A%20%20%20%20for%20%28const%20geometryId%20in%20bindingStates%29%20%7B%0A%20%20%20%20%20%20const%20programMap%20%3D%20bindingStates%5BgeometryId%5D%3B%0A%20%20%20%20%20%20for%20%28const%20programId%20in%20programMap%29%20%7B%0A%20%20%20%20%20%20%20%20const%20stateMap%20%3D%20programMap%5BprogramId%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28const%20wireframe%20in%20stateMap%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20deleteVertexArrayObject%28stateMap%5Bwireframe%5D.object%29%3B%0A%20%20%20%20%20%20%20%20%20%20delete%20stateMap%5Bwireframe%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20delete%20programMap%5BprogramId%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20delete%20bindingStates%5BgeometryId%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20releaseStatesOfGeometry%28geometry%29%20%7B%0A%20%20%20%20if%20%28bindingStates%5Bgeometry.id%5D%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20const%20programMap%20%3D%20bindingStates%5Bgeometry.id%5D%3B%0A%20%20%20%20for%20%28const%20programId%20in%20programMap%29%20%7B%0A%20%20%20%20%20%20const%20stateMap%20%3D%20programMap%5BprogramId%5D%3B%0A%20%20%20%20%20%20for%20%28const%20wireframe%20in%20stateMap%29%20%7B%0A%20%20%20%20%20%20%20%20deleteVertexArrayObject%28stateMap%5Bwireframe%5D.object%29%3B%0A%20%20%20%20%20%20%20%20delete%20stateMap%5Bwireframe%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20delete%20programMap%5BprogramId%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20delete%20bindingStates%5Bgeometry.id%5D%3B%0A%20%20%7D%0A%20%20function%20releaseStatesOfProgram%28program%29%20%7B%0A%20%20%20%20for%20%28const%20geometryId%20in%20bindingStates%29%20%7B%0A%20%20%20%20%20%20const%20programMap%20%3D%20bindingStates%5BgeometryId%5D%3B%0A%20%20%20%20%20%20if%20%28programMap%5Bprogram.id%5D%20%3D%3D%3D%20void%200%29%20continue%3B%0A%20%20%20%20%20%20const%20stateMap%20%3D%20programMap%5Bprogram.id%5D%3B%0A%20%20%20%20%20%20for%20%28const%20wireframe%20in%20stateMap%29%20%7B%0A%20%20%20%20%20%20%20%20deleteVertexArrayObject%28stateMap%5Bwireframe%5D.object%29%3B%0A%20%20%20%20%20%20%20%20delete%20stateMap%5Bwireframe%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20delete%20programMap%5Bprogram.id%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20reset%28%29%20%7B%0A%20%20%20%20resetDefaultState%28%29%3B%0A%20%20%20%20forceUpdate%20%3D%20true%3B%0A%20%20%20%20if%20%28currentState%20%3D%3D%3D%20defaultState%29%20return%3B%0A%20%20%20%20currentState%20%3D%20defaultState%3B%0A%20%20%20%20bindVertexArrayObject%28currentState.object%29%3B%0A%20%20%7D%0A%20%20function%20resetDefaultState%28%29%20%7B%0A%20%20%20%20defaultState.geometry%20%3D%20null%3B%0A%20%20%20%20defaultState.program%20%3D%20null%3B%0A%20%20%20%20defaultState.wireframe%20%3D%20false%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20setup%2C%0A%20%20%20%20reset%2C%0A%20%20%20%20resetDefaultState%2C%0A%20%20%20%20dispose%2C%0A%20%20%20%20releaseStatesOfGeometry%2C%0A%20%20%20%20releaseStatesOfProgram%2C%0A%20%20%20%20initAttributes%2C%0A%20%20%20%20enableAttribute%2C%0A%20%20%20%20disableUnusedAttributes%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLBufferRenderer%28gl%2C%20extensions%2C%20info%29%20%7B%0A%20%20let%20mode%3B%0A%20%20function%20setMode%28value%29%20%7B%0A%20%20%20%20mode%20%3D%20value%3B%0A%20%20%7D%0A%20%20function%20render%28start%2C%20count%29%20%7B%0A%20%20%20%20gl.drawArrays%28mode%2C%20start%2C%20count%29%3B%0A%20%20%20%20info.update%28count%2C%20mode%2C%201%29%3B%0A%20%20%7D%0A%20%20function%20renderInstances%28start%2C%20count%2C%20primcount%29%20%7B%0A%20%20%20%20if%20%28primcount%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20gl.drawArraysInstanced%28mode%2C%20start%2C%20count%2C%20primcount%29%3B%0A%20%20%20%20info.update%28count%2C%20mode%2C%20primcount%29%3B%0A%20%20%7D%0A%20%20function%20renderMultiDraw%28starts%2C%20counts%2C%20drawCount%29%20%7B%0A%20%20%20%20if%20%28drawCount%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20const%20extension%20%3D%20extensions.get%28%22WEBGL_multi_draw%22%29%3B%0A%20%20%20%20extension.multiDrawArraysWEBGL%28mode%2C%20starts%2C%200%2C%20counts%2C%200%2C%20drawCount%29%3B%0A%20%20%20%20let%20elementCount%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20elementCount%20%2B%3D%20counts%5Bi%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20info.update%28elementCount%2C%20mode%2C%201%29%3B%0A%20%20%7D%0A%20%20function%20renderMultiDrawInstances%28starts%2C%20counts%2C%20drawCount%2C%20primcount%29%20%7B%0A%20%20%20%20if%20%28drawCount%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20const%20extension%20%3D%20extensions.get%28%22WEBGL_multi_draw%22%29%3B%0A%20%20%20%20if%20%28extension%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20starts.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20renderInstances%28starts%5Bi%5D%2C%20counts%5Bi%5D%2C%20primcount%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20extension.multiDrawArraysInstancedWEBGL%28mode%2C%20starts%2C%200%2C%20counts%2C%200%2C%20primcount%2C%200%2C%20drawCount%29%3B%0A%20%20%20%20%20%20let%20elementCount%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20elementCount%20%2B%3D%20counts%5Bi%5D%20%2A%20primcount%5Bi%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20info.update%28elementCount%2C%20mode%2C%201%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20this.setMode%20%3D%20setMode%3B%0A%20%20this.render%20%3D%20render%3B%0A%20%20this.renderInstances%20%3D%20renderInstances%3B%0A%20%20this.renderMultiDraw%20%3D%20renderMultiDraw%3B%0A%20%20this.renderMultiDrawInstances%20%3D%20renderMultiDrawInstances%3B%0A%7D%0Afunction%20WebGLCapabilities%28gl%2C%20extensions%2C%20parameters%2C%20utils%29%20%7B%0A%20%20let%20maxAnisotropy%3B%0A%20%20function%20getMaxAnisotropy%28%29%20%7B%0A%20%20%20%20if%20%28maxAnisotropy%20%21%3D%3D%20void%200%29%20return%20maxAnisotropy%3B%0A%20%20%20%20if%20%28extensions.has%28%22EXT_texture_filter_anisotropic%22%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20extension%20%3D%20extensions.get%28%22EXT_texture_filter_anisotropic%22%29%3B%0A%20%20%20%20%20%20maxAnisotropy%20%3D%20gl.getParameter%28extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20maxAnisotropy%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20maxAnisotropy%3B%0A%20%20%7D%0A%20%20function%20textureFormatReadable%28textureFormat%29%20%7B%0A%20%20%20%20if%20%28textureFormat%20%21%3D%3D%20RGBAFormat%20%26%26%20utils.convert%28textureFormat%29%20%21%3D%3D%20gl.getParameter%28gl.IMPLEMENTATION_COLOR_READ_FORMAT%29%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20function%20textureTypeReadable%28textureType%29%20%7B%0A%20%20%20%20const%20halfFloatSupportedByExt%20%3D%20textureType%20%3D%3D%3D%20HalfFloatType%20%26%26%20%28extensions.has%28%22EXT_color_buffer_half_float%22%29%20%7C%7C%20extensions.has%28%22EXT_color_buffer_float%22%29%29%3B%0A%20%20%20%20if%20%28textureType%20%21%3D%3D%20UnsignedByteType%20%26%26%20utils.convert%28textureType%29%20%21%3D%3D%20gl.getParameter%28gl.IMPLEMENTATION_COLOR_READ_TYPE%29%20%26%26%20%2F%2F%20Edge%20and%20Chrome%20Mac%20%3C%2052%20%28%239513%29%0A%20%20%20%20textureType%20%21%3D%3D%20FloatType%20%26%26%20%21halfFloatSupportedByExt%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20function%20getMaxPrecision%28precision2%29%20%7B%0A%20%20%20%20if%20%28precision2%20%3D%3D%3D%20%22highp%22%29%20%7B%0A%20%20%20%20%20%20if%20%28gl.getShaderPrecisionFormat%28gl.VERTEX_SHADER%2C%20gl.HIGH_FLOAT%29.precision%20%3E%200%20%26%26%20gl.getShaderPrecisionFormat%28gl.FRAGMENT_SHADER%2C%20gl.HIGH_FLOAT%29.precision%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%22highp%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20precision2%20%3D%20%22mediump%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28precision2%20%3D%3D%3D%20%22mediump%22%29%20%7B%0A%20%20%20%20%20%20if%20%28gl.getShaderPrecisionFormat%28gl.VERTEX_SHADER%2C%20gl.MEDIUM_FLOAT%29.precision%20%3E%200%20%26%26%20gl.getShaderPrecisionFormat%28gl.FRAGMENT_SHADER%2C%20gl.MEDIUM_FLOAT%29.precision%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%22mediump%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20%22lowp%22%3B%0A%20%20%7D%0A%20%20let%20precision%20%3D%20parameters.precision%20%21%3D%3D%20void%200%20%3F%20parameters.precision%20%3A%20%22highp%22%3B%0A%20%20const%20maxPrecision%20%3D%20getMaxPrecision%28precision%29%3B%0A%20%20if%20%28maxPrecision%20%21%3D%3D%20precision%29%20%7B%0A%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%22%2C%20precision%2C%20%22not%20supported%2C%20using%22%2C%20maxPrecision%2C%20%22instead.%22%29%3B%0A%20%20%20%20precision%20%3D%20maxPrecision%3B%0A%20%20%7D%0A%20%20const%20logarithmicDepthBuffer%20%3D%20parameters.logarithmicDepthBuffer%20%3D%3D%3D%20true%3B%0A%20%20const%20reverseDepthBuffer%20%3D%20parameters.reverseDepthBuffer%20%3D%3D%3D%20true%20%26%26%20extensions.has%28%22EXT_clip_control%22%29%3B%0A%20%20const%20maxTextures%20%3D%20gl.getParameter%28gl.MAX_TEXTURE_IMAGE_UNITS%29%3B%0A%20%20const%20maxVertexTextures%20%3D%20gl.getParameter%28gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS%29%3B%0A%20%20const%20maxTextureSize%20%3D%20gl.getParameter%28gl.MAX_TEXTURE_SIZE%29%3B%0A%20%20const%20maxCubemapSize%20%3D%20gl.getParameter%28gl.MAX_CUBE_MAP_TEXTURE_SIZE%29%3B%0A%20%20const%20maxAttributes%20%3D%20gl.getParameter%28gl.MAX_VERTEX_ATTRIBS%29%3B%0A%20%20const%20maxVertexUniforms%20%3D%20gl.getParameter%28gl.MAX_VERTEX_UNIFORM_VECTORS%29%3B%0A%20%20const%20maxVaryings%20%3D%20gl.getParameter%28gl.MAX_VARYING_VECTORS%29%3B%0A%20%20const%20maxFragmentUniforms%20%3D%20gl.getParameter%28gl.MAX_FRAGMENT_UNIFORM_VECTORS%29%3B%0A%20%20const%20vertexTextures%20%3D%20maxVertexTextures%20%3E%200%3B%0A%20%20const%20maxSamples%20%3D%20gl.getParameter%28gl.MAX_SAMPLES%29%3B%0A%20%20return%20%7B%0A%20%20%20%20isWebGL2%3A%20true%2C%0A%20%20%20%20%2F%2F%20keeping%20this%20for%20backwards%20compatibility%0A%20%20%20%20getMaxAnisotropy%2C%0A%20%20%20%20getMaxPrecision%2C%0A%20%20%20%20textureFormatReadable%2C%0A%20%20%20%20textureTypeReadable%2C%0A%20%20%20%20precision%2C%0A%20%20%20%20logarithmicDepthBuffer%2C%0A%20%20%20%20reverseDepthBuffer%2C%0A%20%20%20%20maxTextures%2C%0A%20%20%20%20maxVertexTextures%2C%0A%20%20%20%20maxTextureSize%2C%0A%20%20%20%20maxCubemapSize%2C%0A%20%20%20%20maxAttributes%2C%0A%20%20%20%20maxVertexUniforms%2C%0A%20%20%20%20maxVaryings%2C%0A%20%20%20%20maxFragmentUniforms%2C%0A%20%20%20%20vertexTextures%2C%0A%20%20%20%20maxSamples%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLClipping%28properties%29%20%7B%0A%20%20const%20scope%20%3D%20this%3B%0A%20%20let%20globalState%20%3D%20null%2C%20numGlobalPlanes%20%3D%200%2C%20localClippingEnabled%20%3D%20false%2C%20renderingShadows%20%3D%20false%3B%0A%20%20const%20plane%20%3D%20new%20Plane%28%29%2C%20viewNormalMatrix%20%3D%20new%20Matrix3%28%29%2C%20uniform2%20%3D%20%7B%20value%3A%20null%2C%20needsUpdate%3A%20false%20%7D%3B%0A%20%20this.uniform%20%3D%20uniform2%3B%0A%20%20this.numPlanes%20%3D%200%3B%0A%20%20this.numIntersection%20%3D%200%3B%0A%20%20this.init%20%3D%20function%28planes%2C%20enableLocalClipping%29%20%7B%0A%20%20%20%20const%20enabled%20%3D%20planes.length%20%21%3D%3D%200%20%7C%7C%20enableLocalClipping%20%7C%7C%20%2F%2F%20enable%20state%20of%20previous%20frame%20-%20the%20clipping%20code%20has%20to%0A%20%20%20%20%2F%2F%20run%20another%20frame%20in%20order%20to%20reset%20the%20state%3A%0A%20%20%20%20numGlobalPlanes%20%21%3D%3D%200%20%7C%7C%20localClippingEnabled%3B%0A%20%20%20%20localClippingEnabled%20%3D%20enableLocalClipping%3B%0A%20%20%20%20numGlobalPlanes%20%3D%20planes.length%3B%0A%20%20%20%20return%20enabled%3B%0A%20%20%7D%3B%0A%20%20this.beginShadows%20%3D%20function%28%29%20%7B%0A%20%20%20%20renderingShadows%20%3D%20true%3B%0A%20%20%20%20projectPlanes%28null%29%3B%0A%20%20%7D%3B%0A%20%20this.endShadows%20%3D%20function%28%29%20%7B%0A%20%20%20%20renderingShadows%20%3D%20false%3B%0A%20%20%7D%3B%0A%20%20this.setGlobalState%20%3D%20function%28planes%2C%20camera3%29%20%7B%0A%20%20%20%20globalState%20%3D%20projectPlanes%28planes%2C%20camera3%2C%200%29%3B%0A%20%20%7D%3B%0A%20%20this.setState%20%3D%20function%28material%2C%20camera3%2C%20useCache%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20material.clippingPlanes%2C%20clipIntersection%20%3D%20material.clipIntersection%2C%20clipShadows%20%3D%20material.clipShadows%3B%0A%20%20%20%20const%20materialProperties%20%3D%20properties.get%28material%29%3B%0A%20%20%20%20if%20%28%21localClippingEnabled%20%7C%7C%20planes%20%3D%3D%3D%20null%20%7C%7C%20planes.length%20%3D%3D%3D%200%20%7C%7C%20renderingShadows%20%26%26%20%21clipShadows%29%20%7B%0A%20%20%20%20%20%20if%20%28renderingShadows%29%20%7B%0A%20%20%20%20%20%20%20%20projectPlanes%28null%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20resetGlobalState%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20nGlobal%20%3D%20renderingShadows%20%3F%200%20%3A%20numGlobalPlanes%2C%20lGlobal%20%3D%20nGlobal%20%2A%204%3B%0A%20%20%20%20%20%20let%20dstArray%20%3D%20materialProperties.clippingState%20%7C%7C%20null%3B%0A%20%20%20%20%20%20uniform2.value%20%3D%20dstArray%3B%0A%20%20%20%20%20%20dstArray%20%3D%20projectPlanes%28planes%2C%20camera3%2C%20lGlobal%2C%20useCache%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20lGlobal%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20dstArray%5Bi%5D%20%3D%20globalState%5Bi%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20materialProperties.clippingState%20%3D%20dstArray%3B%0A%20%20%20%20%20%20this.numIntersection%20%3D%20clipIntersection%20%3F%20this.numPlanes%20%3A%200%3B%0A%20%20%20%20%20%20this.numPlanes%20%2B%3D%20nGlobal%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%20%20function%20resetGlobalState%28%29%20%7B%0A%20%20%20%20if%20%28uniform2.value%20%21%3D%3D%20globalState%29%20%7B%0A%20%20%20%20%20%20uniform2.value%20%3D%20globalState%3B%0A%20%20%20%20%20%20uniform2.needsUpdate%20%3D%20numGlobalPlanes%20%3E%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20scope.numPlanes%20%3D%20numGlobalPlanes%3B%0A%20%20%20%20scope.numIntersection%20%3D%200%3B%0A%20%20%7D%0A%20%20function%20projectPlanes%28planes%2C%20camera3%2C%20dstOffset%2C%20skipTransform%29%20%7B%0A%20%20%20%20const%20nPlanes%20%3D%20planes%20%21%3D%3D%20null%20%3F%20planes.length%20%3A%200%3B%0A%20%20%20%20let%20dstArray%20%3D%20null%3B%0A%20%20%20%20if%20%28nPlanes%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20dstArray%20%3D%20uniform2.value%3B%0A%20%20%20%20%20%20if%20%28skipTransform%20%21%3D%3D%20true%20%7C%7C%20dstArray%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20const%20flatSize%20%3D%20dstOffset%20%2B%20nPlanes%20%2A%204%2C%20viewMatrix%20%3D%20camera3.matrixWorldInverse%3B%0A%20%20%20%20%20%20%20%20viewNormalMatrix.getNormalMatrix%28viewMatrix%29%3B%0A%20%20%20%20%20%20%20%20if%20%28dstArray%20%3D%3D%3D%20null%20%7C%7C%20dstArray.length%20%3C%20flatSize%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20dstArray%20%3D%20new%20Float32Array%28flatSize%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20i4%20%3D%20dstOffset%3B%20i%20%21%3D%3D%20nPlanes%3B%20%2B%2Bi%2C%20i4%20%2B%3D%204%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20plane.copy%28planes%5Bi%5D%29.applyMatrix4%28viewMatrix%2C%20viewNormalMatrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20plane.normal.toArray%28dstArray%2C%20i4%29%3B%0A%20%20%20%20%20%20%20%20%20%20dstArray%5Bi4%20%2B%203%5D%20%3D%20plane.constant%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20uniform2.value%20%3D%20dstArray%3B%0A%20%20%20%20%20%20uniform2.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20scope.numPlanes%20%3D%20nPlanes%3B%0A%20%20%20%20scope.numIntersection%20%3D%200%3B%0A%20%20%20%20return%20dstArray%3B%0A%20%20%7D%0A%7D%0Afunction%20WebGLCubeMaps%28renderer3%29%20%7B%0A%20%20let%20cubemaps%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20function%20mapTextureMapping2%28texture2%2C%20mapping%29%20%7B%0A%20%20%20%20if%20%28mapping%20%3D%3D%3D%20EquirectangularReflectionMapping%29%20%7B%0A%20%20%20%20%20%20texture2.mapping%20%3D%20CubeReflectionMapping%3B%0A%20%20%20%20%7D%20else%20if%20%28mapping%20%3D%3D%3D%20EquirectangularRefractionMapping%29%20%7B%0A%20%20%20%20%20%20texture2.mapping%20%3D%20CubeRefractionMapping%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20texture2%3B%0A%20%20%7D%0A%20%20function%20get2%28texture2%29%20%7B%0A%20%20%20%20if%20%28texture2%20%26%26%20texture2.isTexture%29%20%7B%0A%20%20%20%20%20%20const%20mapping%20%3D%20texture2.mapping%3B%0A%20%20%20%20%20%20if%20%28mapping%20%3D%3D%3D%20EquirectangularReflectionMapping%20%7C%7C%20mapping%20%3D%3D%3D%20EquirectangularRefractionMapping%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28cubemaps.has%28texture2%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20cubemap%20%3D%20cubemaps.get%28texture2%29.texture%3B%0A%20%20%20%20%20%20%20%20%20%20return%20mapTextureMapping2%28cubemap%2C%20texture2.mapping%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20image%20%3D%20texture2.image%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28image%20%26%26%20image.height%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20renderTarget%20%3D%20new%20WebGLCubeRenderTarget%28image.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderTarget.fromEquirectangularTexture%28renderer3%2C%20texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cubemaps.set%28texture2%2C%20renderTarget%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20texture2.addEventListener%28%22dispose%22%2C%20onTextureDispose2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20mapTextureMapping2%28renderTarget.texture%2C%20texture2.mapping%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20texture2%3B%0A%20%20%7D%0A%20%20function%20onTextureDispose2%28event%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20event.target%3B%0A%20%20%20%20texture2.removeEventListener%28%22dispose%22%2C%20onTextureDispose2%29%3B%0A%20%20%20%20const%20cubemap%20%3D%20cubemaps.get%28texture2%29%3B%0A%20%20%20%20if%20%28cubemap%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20cubemaps.delete%28texture2%29%3B%0A%20%20%20%20%20%20cubemap.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20dispose%28%29%20%7B%0A%20%20%20%20cubemaps%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20get%3A%20get2%2C%0A%20%20%20%20dispose%0A%20%20%7D%3B%0A%7D%0Avar%20OrthographicCamera%20%3D%20class%20extends%20Camera%20%7B%0A%20%20constructor%28left%20%3D%20-1%2C%20right%20%3D%201%2C%20top%20%3D%201%2C%20bottom%20%3D%20-1%2C%20near%20%3D%200.1%2C%20far%20%3D%202e3%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isOrthographicCamera%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22OrthographicCamera%22%3B%0A%20%20%20%20this.zoom%20%3D%201%3B%0A%20%20%20%20this.view%20%3D%20null%3B%0A%20%20%20%20this.left%20%3D%20left%3B%0A%20%20%20%20this.right%20%3D%20right%3B%0A%20%20%20%20this.top%20%3D%20top%3B%0A%20%20%20%20this.bottom%20%3D%20bottom%3B%0A%20%20%20%20this.near%20%3D%20near%3B%0A%20%20%20%20this.far%20%3D%20far%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.left%20%3D%20source.left%3B%0A%20%20%20%20this.right%20%3D%20source.right%3B%0A%20%20%20%20this.top%20%3D%20source.top%3B%0A%20%20%20%20this.bottom%20%3D%20source.bottom%3B%0A%20%20%20%20this.near%20%3D%20source.near%3B%0A%20%20%20%20this.far%20%3D%20source.far%3B%0A%20%20%20%20this.zoom%20%3D%20source.zoom%3B%0A%20%20%20%20this.view%20%3D%20source.view%20%3D%3D%3D%20null%20%3F%20null%20%3A%20Object.assign%28%7B%7D%2C%20source.view%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setViewOffset%28fullWidth%2C%20fullHeight%2C%20x2%2C%20y2%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20if%20%28this.view%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.view%20%3D%20%7B%0A%20%20%20%20%20%20%20%20enabled%3A%20true%2C%0A%20%20%20%20%20%20%20%20fullWidth%3A%201%2C%0A%20%20%20%20%20%20%20%20fullHeight%3A%201%2C%0A%20%20%20%20%20%20%20%20offsetX%3A%200%2C%0A%20%20%20%20%20%20%20%20offsetY%3A%200%2C%0A%20%20%20%20%20%20%20%20width%3A%201%2C%0A%20%20%20%20%20%20%20%20height%3A%201%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.view.enabled%20%3D%20true%3B%0A%20%20%20%20this.view.fullWidth%20%3D%20fullWidth%3B%0A%20%20%20%20this.view.fullHeight%20%3D%20fullHeight%3B%0A%20%20%20%20this.view.offsetX%20%3D%20x2%3B%0A%20%20%20%20this.view.offsetY%20%3D%20y2%3B%0A%20%20%20%20this.view.width%20%3D%20width%3B%0A%20%20%20%20this.view.height%20%3D%20height%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20clearViewOffset%28%29%20%7B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.view.enabled%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20updateProjectionMatrix%28%29%20%7B%0A%20%20%20%20const%20dx%20%3D%20%28this.right%20-%20this.left%29%20%2F%20%282%20%2A%20this.zoom%29%3B%0A%20%20%20%20const%20dy%20%3D%20%28this.top%20-%20this.bottom%29%20%2F%20%282%20%2A%20this.zoom%29%3B%0A%20%20%20%20const%20cx%20%3D%20%28this.right%20%2B%20this.left%29%20%2F%202%3B%0A%20%20%20%20const%20cy%20%3D%20%28this.top%20%2B%20this.bottom%29%20%2F%202%3B%0A%20%20%20%20let%20left%20%3D%20cx%20-%20dx%3B%0A%20%20%20%20let%20right%20%3D%20cx%20%2B%20dx%3B%0A%20%20%20%20let%20top%20%3D%20cy%20%2B%20dy%3B%0A%20%20%20%20let%20bottom%20%3D%20cy%20-%20dy%3B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%20%26%26%20this.view.enabled%29%20%7B%0A%20%20%20%20%20%20const%20scaleW%20%3D%20%28this.right%20-%20this.left%29%20%2F%20this.view.fullWidth%20%2F%20this.zoom%3B%0A%20%20%20%20%20%20const%20scaleH%20%3D%20%28this.top%20-%20this.bottom%29%20%2F%20this.view.fullHeight%20%2F%20this.zoom%3B%0A%20%20%20%20%20%20left%20%2B%3D%20scaleW%20%2A%20this.view.offsetX%3B%0A%20%20%20%20%20%20right%20%3D%20left%20%2B%20scaleW%20%2A%20this.view.width%3B%0A%20%20%20%20%20%20top%20-%3D%20scaleH%20%2A%20this.view.offsetY%3B%0A%20%20%20%20%20%20bottom%20%3D%20top%20-%20scaleH%20%2A%20this.view.height%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.projectionMatrix.makeOrthographic%28left%2C%20right%2C%20top%2C%20bottom%2C%20this.near%2C%20this.far%2C%20this.coordinateSystem%29%3B%0A%20%20%20%20this.projectionMatrixInverse.copy%28this.projectionMatrix%29.invert%28%29%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.object.zoom%20%3D%20this.zoom%3B%0A%20%20%20%20data.object.left%20%3D%20this.left%3B%0A%20%20%20%20data.object.right%20%3D%20this.right%3B%0A%20%20%20%20data.object.top%20%3D%20this.top%3B%0A%20%20%20%20data.object.bottom%20%3D%20this.bottom%3B%0A%20%20%20%20data.object.near%20%3D%20this.near%3B%0A%20%20%20%20data.object.far%20%3D%20this.far%3B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%29%20data.object.view%20%3D%20Object.assign%28%7B%7D%2C%20this.view%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LOD_MIN%20%3D%204%3B%0Avar%20EXTRA_LOD_SIGMA%20%3D%20%5B0.125%2C%200.215%2C%200.35%2C%200.446%2C%200.526%2C%200.582%5D%3B%0Avar%20MAX_SAMPLES%20%3D%2020%3B%0Avar%20_flatCamera%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20OrthographicCamera%28%29%3B%0Avar%20_clearColor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color%28%29%3B%0Avar%20_oldTarget%20%3D%20null%3B%0Avar%20_oldActiveCubeFace%20%3D%200%3B%0Avar%20_oldActiveMipmapLevel%20%3D%200%3B%0Avar%20_oldXrEnabled%20%3D%20false%3B%0Avar%20PHI%20%3D%20%281%20%2B%20Math.sqrt%285%29%29%20%2F%202%3B%0Avar%20INV_PHI%20%3D%201%20%2F%20PHI%3B%0Avar%20_axisDirections%20%3D%20%5B%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28-PHI%2C%20INV_PHI%2C%200%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28PHI%2C%20INV_PHI%2C%200%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28-INV_PHI%2C%200%2C%20PHI%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28INV_PHI%2C%200%2C%20PHI%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%280%2C%20PHI%2C%20-INV_PHI%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%280%2C%20PHI%2C%20INV_PHI%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28-1%2C%201%2C%20-1%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%281%2C%201%2C%20-1%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28-1%2C%201%2C%201%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%281%2C%201%2C%201%29%0A%5D%3B%0Avar%20PMREMGenerator%20%3D%20class%20%7B%0A%20%20constructor%28renderer3%29%20%7B%0A%20%20%20%20this._renderer%20%3D%20renderer3%3B%0A%20%20%20%20this._pingPongRenderTarget%20%3D%20null%3B%0A%20%20%20%20this._lodMax%20%3D%200%3B%0A%20%20%20%20this._cubeSize%20%3D%200%3B%0A%20%20%20%20this._lodPlanes%20%3D%20%5B%5D%3B%0A%20%20%20%20this._sizeLods%20%3D%20%5B%5D%3B%0A%20%20%20%20this._sigmas%20%3D%20%5B%5D%3B%0A%20%20%20%20this._blurMaterial%20%3D%20null%3B%0A%20%20%20%20this._cubemapMaterial%20%3D%20null%3B%0A%20%20%20%20this._equirectMaterial%20%3D%20null%3B%0A%20%20%20%20this._compileMaterial%28this._blurMaterial%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Generates%20a%20PMREM%20from%20a%20supplied%20Scene%2C%20which%20can%20be%20faster%20than%20using%20an%0A%20%20%20%2A%20image%20if%20networking%20bandwidth%20is%20low.%20Optional%20sigma%20specifies%20a%20blur%20radius%0A%20%20%20%2A%20in%20radians%20to%20be%20applied%20to%20the%20scene%20before%20PMREM%20generation.%20Optional%20near%0A%20%20%20%2A%20and%20far%20planes%20ensure%20the%20scene%20is%20rendered%20in%20its%20entirety%20%28the%20cubeCamera%0A%20%20%20%2A%20is%20placed%20at%20the%20origin%29.%0A%20%20%20%2A%2F%0A%20%20fromScene%28scene3%2C%20sigma%20%3D%200%2C%20near%20%3D%200.1%2C%20far%20%3D%20100%29%20%7B%0A%20%20%20%20_oldTarget%20%3D%20this._renderer.getRenderTarget%28%29%3B%0A%20%20%20%20_oldActiveCubeFace%20%3D%20this._renderer.getActiveCubeFace%28%29%3B%0A%20%20%20%20_oldActiveMipmapLevel%20%3D%20this._renderer.getActiveMipmapLevel%28%29%3B%0A%20%20%20%20_oldXrEnabled%20%3D%20this._renderer.xr.enabled%3B%0A%20%20%20%20this._renderer.xr.enabled%20%3D%20false%3B%0A%20%20%20%20this._setSize%28256%29%3B%0A%20%20%20%20const%20cubeUVRenderTarget%20%3D%20this._allocateTargets%28%29%3B%0A%20%20%20%20cubeUVRenderTarget.depthBuffer%20%3D%20true%3B%0A%20%20%20%20this._sceneToCubeUV%28scene3%2C%20near%2C%20far%2C%20cubeUVRenderTarget%29%3B%0A%20%20%20%20if%20%28sigma%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this._blur%28cubeUVRenderTarget%2C%200%2C%200%2C%20sigma%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._applyPMREM%28cubeUVRenderTarget%29%3B%0A%20%20%20%20this._cleanup%28cubeUVRenderTarget%29%3B%0A%20%20%20%20return%20cubeUVRenderTarget%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Generates%20a%20PMREM%20from%20an%20equirectangular%20texture%2C%20which%20can%20be%20either%20LDR%0A%20%20%20%2A%20or%20HDR.%20The%20ideal%20input%20image%20size%20is%201k%20%281024%20x%20512%29%2C%0A%20%20%20%2A%20as%20this%20matches%20best%20with%20the%20256%20x%20256%20cubemap%20output.%0A%20%20%20%2A%20The%20smallest%20supported%20equirectangular%20image%20size%20is%2064%20x%2032.%0A%20%20%20%2A%2F%0A%20%20fromEquirectangular%28equirectangular%2C%20renderTarget%20%3D%20null%29%20%7B%0A%20%20%20%20return%20this._fromTexture%28equirectangular%2C%20renderTarget%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Generates%20a%20PMREM%20from%20an%20cubemap%20texture%2C%20which%20can%20be%20either%20LDR%0A%20%20%20%2A%20or%20HDR.%20The%20ideal%20input%20cube%20size%20is%20256%20x%20256%2C%0A%20%20%20%2A%20as%20this%20matches%20best%20with%20the%20256%20x%20256%20cubemap%20output.%0A%20%20%20%2A%20The%20smallest%20supported%20cube%20size%20is%2016%20x%2016.%0A%20%20%20%2A%2F%0A%20%20fromCubemap%28cubemap%2C%20renderTarget%20%3D%20null%29%20%7B%0A%20%20%20%20return%20this._fromTexture%28cubemap%2C%20renderTarget%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Pre-compiles%20the%20cubemap%20shader.%20You%20can%20get%20faster%20start-up%20by%20invoking%20this%20method%20during%0A%20%20%20%2A%20your%20texture%27s%20network%20fetch%20for%20increased%20concurrency.%0A%20%20%20%2A%2F%0A%20%20compileCubemapShader%28%29%20%7B%0A%20%20%20%20if%20%28this._cubemapMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._cubemapMaterial%20%3D%20_getCubemapMaterial%28%29%3B%0A%20%20%20%20%20%20this._compileMaterial%28this._cubemapMaterial%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Pre-compiles%20the%20equirectangular%20shader.%20You%20can%20get%20faster%20start-up%20by%20invoking%20this%20method%20during%0A%20%20%20%2A%20your%20texture%27s%20network%20fetch%20for%20increased%20concurrency.%0A%20%20%20%2A%2F%0A%20%20compileEquirectangularShader%28%29%20%7B%0A%20%20%20%20if%20%28this._equirectMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._equirectMaterial%20%3D%20_getEquirectMaterial%28%29%3B%0A%20%20%20%20%20%20this._compileMaterial%28this._equirectMaterial%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Disposes%20of%20the%20PMREMGenerator%27s%20internal%20memory.%20Note%20that%20PMREMGenerator%20is%20a%20static%20class%2C%0A%20%20%20%2A%20so%20you%20should%20not%20need%20more%20than%20one%20PMREMGenerator%20object.%20If%20you%20do%2C%20calling%20dispose%28%29%20on%0A%20%20%20%2A%20one%20of%20them%20will%20cause%20any%20others%20to%20also%20become%20unusable.%0A%20%20%20%2A%2F%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this._dispose%28%29%3B%0A%20%20%20%20if%20%28this._cubemapMaterial%20%21%3D%3D%20null%29%20this._cubemapMaterial.dispose%28%29%3B%0A%20%20%20%20if%20%28this._equirectMaterial%20%21%3D%3D%20null%29%20this._equirectMaterial.dispose%28%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20private%20interface%0A%20%20_setSize%28cubeSize%29%20%7B%0A%20%20%20%20this._lodMax%20%3D%20Math.floor%28Math.log2%28cubeSize%29%29%3B%0A%20%20%20%20this._cubeSize%20%3D%20Math.pow%282%2C%20this._lodMax%29%3B%0A%20%20%7D%0A%20%20_dispose%28%29%20%7B%0A%20%20%20%20if%20%28this._blurMaterial%20%21%3D%3D%20null%29%20this._blurMaterial.dispose%28%29%3B%0A%20%20%20%20if%20%28this._pingPongRenderTarget%20%21%3D%3D%20null%29%20this._pingPongRenderTarget.dispose%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this._lodPlanes.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this._lodPlanes%5Bi%5D.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_cleanup%28outputTarget%29%20%7B%0A%20%20%20%20this._renderer.setRenderTarget%28_oldTarget%2C%20_oldActiveCubeFace%2C%20_oldActiveMipmapLevel%29%3B%0A%20%20%20%20this._renderer.xr.enabled%20%3D%20_oldXrEnabled%3B%0A%20%20%20%20outputTarget.scissorTest%20%3D%20false%3B%0A%20%20%20%20_setViewport%28outputTarget%2C%200%2C%200%2C%20outputTarget.width%2C%20outputTarget.height%29%3B%0A%20%20%7D%0A%20%20_fromTexture%28texture2%2C%20renderTarget%29%20%7B%0A%20%20%20%20if%20%28texture2.mapping%20%3D%3D%3D%20CubeReflectionMapping%20%7C%7C%20texture2.mapping%20%3D%3D%3D%20CubeRefractionMapping%29%20%7B%0A%20%20%20%20%20%20this._setSize%28texture2.image.length%20%3D%3D%3D%200%20%3F%2016%20%3A%20texture2.image%5B0%5D.width%20%7C%7C%20texture2.image%5B0%5D.image.width%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._setSize%28texture2.image.width%20%2F%204%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_oldTarget%20%3D%20this._renderer.getRenderTarget%28%29%3B%0A%20%20%20%20_oldActiveCubeFace%20%3D%20this._renderer.getActiveCubeFace%28%29%3B%0A%20%20%20%20_oldActiveMipmapLevel%20%3D%20this._renderer.getActiveMipmapLevel%28%29%3B%0A%20%20%20%20_oldXrEnabled%20%3D%20this._renderer.xr.enabled%3B%0A%20%20%20%20this._renderer.xr.enabled%20%3D%20false%3B%0A%20%20%20%20const%20cubeUVRenderTarget%20%3D%20renderTarget%20%7C%7C%20this._allocateTargets%28%29%3B%0A%20%20%20%20this._textureToCubeUV%28texture2%2C%20cubeUVRenderTarget%29%3B%0A%20%20%20%20this._applyPMREM%28cubeUVRenderTarget%29%3B%0A%20%20%20%20this._cleanup%28cubeUVRenderTarget%29%3B%0A%20%20%20%20return%20cubeUVRenderTarget%3B%0A%20%20%7D%0A%20%20_allocateTargets%28%29%20%7B%0A%20%20%20%20const%20width%20%3D%203%20%2A%20Math.max%28this._cubeSize%2C%2016%20%2A%207%29%3B%0A%20%20%20%20const%20height%20%3D%204%20%2A%20this._cubeSize%3B%0A%20%20%20%20const%20params%20%3D%20%7B%0A%20%20%20%20%20%20magFilter%3A%20LinearFilter%2C%0A%20%20%20%20%20%20minFilter%3A%20LinearFilter%2C%0A%20%20%20%20%20%20generateMipmaps%3A%20false%2C%0A%20%20%20%20%20%20type%3A%20HalfFloatType%2C%0A%20%20%20%20%20%20format%3A%20RGBAFormat%2C%0A%20%20%20%20%20%20colorSpace%3A%20LinearSRGBColorSpace%2C%0A%20%20%20%20%20%20depthBuffer%3A%20false%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20cubeUVRenderTarget%20%3D%20_createRenderTarget%28width%2C%20height%2C%20params%29%3B%0A%20%20%20%20if%20%28this._pingPongRenderTarget%20%3D%3D%3D%20null%20%7C%7C%20this._pingPongRenderTarget.width%20%21%3D%3D%20width%20%7C%7C%20this._pingPongRenderTarget.height%20%21%3D%3D%20height%29%20%7B%0A%20%20%20%20%20%20if%20%28this._pingPongRenderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this._dispose%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._pingPongRenderTarget%20%3D%20_createRenderTarget%28width%2C%20height%2C%20params%29%3B%0A%20%20%20%20%20%20const%20%7B%20_lodMax%20%7D%20%3D%20this%3B%0A%20%20%20%20%20%20%28%7B%20sizeLods%3A%20this._sizeLods%2C%20lodPlanes%3A%20this._lodPlanes%2C%20sigmas%3A%20this._sigmas%20%7D%20%3D%20_createPlanes%28_lodMax%29%29%3B%0A%20%20%20%20%20%20this._blurMaterial%20%3D%20_getBlurShader%28_lodMax%2C%20width%2C%20height%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20cubeUVRenderTarget%3B%0A%20%20%7D%0A%20%20_compileMaterial%28material%29%20%7B%0A%20%20%20%20const%20tmpMesh%20%3D%20new%20Mesh%28this._lodPlanes%5B0%5D%2C%20material%29%3B%0A%20%20%20%20this._renderer.compile%28tmpMesh%2C%20_flatCamera%29%3B%0A%20%20%7D%0A%20%20_sceneToCubeUV%28scene3%2C%20near%2C%20far%2C%20cubeUVRenderTarget%29%20%7B%0A%20%20%20%20const%20fov3%20%3D%2090%3B%0A%20%20%20%20const%20aspect3%20%3D%201%3B%0A%20%20%20%20const%20cubeCamera%20%3D%20new%20PerspectiveCamera%28fov3%2C%20aspect3%2C%20near%2C%20far%29%3B%0A%20%20%20%20const%20upSign%20%3D%20%5B1%2C%20-1%2C%201%2C%201%2C%201%2C%201%5D%3B%0A%20%20%20%20const%20forwardSign%20%3D%20%5B1%2C%201%2C%201%2C%20-1%2C%20-1%2C%20-1%5D%3B%0A%20%20%20%20const%20renderer3%20%3D%20this._renderer%3B%0A%20%20%20%20const%20originalAutoClear%20%3D%20renderer3.autoClear%3B%0A%20%20%20%20const%20toneMapping2%20%3D%20renderer3.toneMapping%3B%0A%20%20%20%20renderer3.getClearColor%28_clearColor%29%3B%0A%20%20%20%20renderer3.toneMapping%20%3D%20NoToneMapping%3B%0A%20%20%20%20renderer3.autoClear%20%3D%20false%3B%0A%20%20%20%20const%20backgroundMaterial%20%3D%20new%20MeshBasicMaterial%28%7B%0A%20%20%20%20%20%20name%3A%20%22PMREM.Background%22%2C%0A%20%20%20%20%20%20side%3A%20BackSide%2C%0A%20%20%20%20%20%20depthWrite%3A%20false%2C%0A%20%20%20%20%20%20depthTest%3A%20false%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20backgroundBox%20%3D%20new%20Mesh%28new%20BoxGeometry%28%29%2C%20backgroundMaterial%29%3B%0A%20%20%20%20let%20useSolidColor%20%3D%20false%3B%0A%20%20%20%20const%20background%20%3D%20scene3.background%3B%0A%20%20%20%20if%20%28background%29%20%7B%0A%20%20%20%20%20%20if%20%28background.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20backgroundMaterial.color.copy%28background%29%3B%0A%20%20%20%20%20%20%20%20scene3.background%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20useSolidColor%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20backgroundMaterial.color.copy%28_clearColor%29%3B%0A%20%20%20%20%20%20useSolidColor%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20col%20%3D%20i%20%25%203%3B%0A%20%20%20%20%20%20if%20%28col%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20cubeCamera.up.set%280%2C%20upSign%5Bi%5D%2C%200%29%3B%0A%20%20%20%20%20%20%20%20cubeCamera.lookAt%28forwardSign%5Bi%5D%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28col%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20cubeCamera.up.set%280%2C%200%2C%20upSign%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20cubeCamera.lookAt%280%2C%20forwardSign%5Bi%5D%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20cubeCamera.up.set%280%2C%20upSign%5Bi%5D%2C%200%29%3B%0A%20%20%20%20%20%20%20%20cubeCamera.lookAt%280%2C%200%2C%20forwardSign%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20size%20%3D%20this._cubeSize%3B%0A%20%20%20%20%20%20_setViewport%28cubeUVRenderTarget%2C%20col%20%2A%20size%2C%20i%20%3E%202%20%3F%20size%20%3A%200%2C%20size%2C%20size%29%3B%0A%20%20%20%20%20%20renderer3.setRenderTarget%28cubeUVRenderTarget%29%3B%0A%20%20%20%20%20%20if%20%28useSolidColor%29%20%7B%0A%20%20%20%20%20%20%20%20renderer3.render%28backgroundBox%2C%20cubeCamera%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20renderer3.render%28scene3%2C%20cubeCamera%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20backgroundBox.geometry.dispose%28%29%3B%0A%20%20%20%20backgroundBox.material.dispose%28%29%3B%0A%20%20%20%20renderer3.toneMapping%20%3D%20toneMapping2%3B%0A%20%20%20%20renderer3.autoClear%20%3D%20originalAutoClear%3B%0A%20%20%20%20scene3.background%20%3D%20background%3B%0A%20%20%7D%0A%20%20_textureToCubeUV%28texture2%2C%20cubeUVRenderTarget%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this._renderer%3B%0A%20%20%20%20const%20isCubeTexture%20%3D%20texture2.mapping%20%3D%3D%3D%20CubeReflectionMapping%20%7C%7C%20texture2.mapping%20%3D%3D%3D%20CubeRefractionMapping%3B%0A%20%20%20%20if%20%28isCubeTexture%29%20%7B%0A%20%20%20%20%20%20if%20%28this._cubemapMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this._cubemapMaterial%20%3D%20_getCubemapMaterial%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._cubemapMaterial.uniforms.flipEnvMap.value%20%3D%20texture2.isRenderTargetTexture%20%3D%3D%3D%20false%20%3F%20-1%20%3A%201%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28this._equirectMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this._equirectMaterial%20%3D%20_getEquirectMaterial%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20material%20%3D%20isCubeTexture%20%3F%20this._cubemapMaterial%20%3A%20this._equirectMaterial%3B%0A%20%20%20%20const%20mesh%20%3D%20new%20Mesh%28this._lodPlanes%5B0%5D%2C%20material%29%3B%0A%20%20%20%20const%20uniforms%20%3D%20material.uniforms%3B%0A%20%20%20%20uniforms%5B%22envMap%22%5D.value%20%3D%20texture2%3B%0A%20%20%20%20const%20size%20%3D%20this._cubeSize%3B%0A%20%20%20%20_setViewport%28cubeUVRenderTarget%2C%200%2C%200%2C%203%20%2A%20size%2C%202%20%2A%20size%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28cubeUVRenderTarget%29%3B%0A%20%20%20%20renderer3.render%28mesh%2C%20_flatCamera%29%3B%0A%20%20%7D%0A%20%20_applyPMREM%28cubeUVRenderTarget%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this._renderer%3B%0A%20%20%20%20const%20autoClear%20%3D%20renderer3.autoClear%3B%0A%20%20%20%20renderer3.autoClear%20%3D%20false%3B%0A%20%20%20%20const%20n%20%3D%20this._lodPlanes.length%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%20n%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20sigma%20%3D%20Math.sqrt%28this._sigmas%5Bi%5D%20%2A%20this._sigmas%5Bi%5D%20-%20this._sigmas%5Bi%20-%201%5D%20%2A%20this._sigmas%5Bi%20-%201%5D%29%3B%0A%20%20%20%20%20%20const%20poleAxis%20%3D%20_axisDirections%5B%28n%20-%20i%20-%201%29%20%25%20_axisDirections.length%5D%3B%0A%20%20%20%20%20%20this._blur%28cubeUVRenderTarget%2C%20i%20-%201%2C%20i%2C%20sigma%2C%20poleAxis%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.autoClear%20%3D%20autoClear%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20This%20is%20a%20two-pass%20Gaussian%20blur%20for%20a%20cubemap.%20Normally%20this%20is%20done%0A%20%20%20%2A%20vertically%20and%20horizontally%2C%20but%20this%20breaks%20down%20on%20a%20cube.%20Here%20we%20apply%0A%20%20%20%2A%20the%20blur%20latitudinally%20%28around%20the%20poles%29%2C%20and%20then%20longitudinally%20%28towards%0A%20%20%20%2A%20the%20poles%29%20to%20approximate%20the%20orthogonally-separable%20blur.%20It%20is%20least%0A%20%20%20%2A%20accurate%20at%20the%20poles%2C%20but%20still%20does%20a%20decent%20job.%0A%20%20%20%2A%2F%0A%20%20_blur%28cubeUVRenderTarget%2C%20lodIn%2C%20lodOut%2C%20sigma%2C%20poleAxis%29%20%7B%0A%20%20%20%20const%20pingPongRenderTarget%20%3D%20this._pingPongRenderTarget%3B%0A%20%20%20%20this._halfBlur%28%0A%20%20%20%20%20%20cubeUVRenderTarget%2C%0A%20%20%20%20%20%20pingPongRenderTarget%2C%0A%20%20%20%20%20%20lodIn%2C%0A%20%20%20%20%20%20lodOut%2C%0A%20%20%20%20%20%20sigma%2C%0A%20%20%20%20%20%20%22latitudinal%22%2C%0A%20%20%20%20%20%20poleAxis%0A%20%20%20%20%29%3B%0A%20%20%20%20this._halfBlur%28%0A%20%20%20%20%20%20pingPongRenderTarget%2C%0A%20%20%20%20%20%20cubeUVRenderTarget%2C%0A%20%20%20%20%20%20lodOut%2C%0A%20%20%20%20%20%20lodOut%2C%0A%20%20%20%20%20%20sigma%2C%0A%20%20%20%20%20%20%22longitudinal%22%2C%0A%20%20%20%20%20%20poleAxis%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20_halfBlur%28targetIn%2C%20targetOut%2C%20lodIn%2C%20lodOut%2C%20sigmaRadians%2C%20direction2%2C%20poleAxis%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this._renderer%3B%0A%20%20%20%20const%20blurMaterial%20%3D%20this._blurMaterial%3B%0A%20%20%20%20if%20%28direction2%20%21%3D%3D%20%22latitudinal%22%20%26%26%20direction2%20%21%3D%3D%20%22longitudinal%22%29%20%7B%0A%20%20%20%20%20%20console.error%28%0A%20%20%20%20%20%20%20%20%22blur%20direction%20must%20be%20either%20latitudinal%20or%20longitudinal%21%22%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20STANDARD_DEVIATIONS%20%3D%203%3B%0A%20%20%20%20const%20blurMesh%20%3D%20new%20Mesh%28this._lodPlanes%5BlodOut%5D%2C%20blurMaterial%29%3B%0A%20%20%20%20const%20blurUniforms%20%3D%20blurMaterial.uniforms%3B%0A%20%20%20%20const%20pixels%20%3D%20this._sizeLods%5BlodIn%5D%20-%201%3B%0A%20%20%20%20const%20radiansPerPixel%20%3D%20isFinite%28sigmaRadians%29%20%3F%20Math.PI%20%2F%20%282%20%2A%20pixels%29%20%3A%202%20%2A%20Math.PI%20%2F%20%282%20%2A%20MAX_SAMPLES%20-%201%29%3B%0A%20%20%20%20const%20sigmaPixels%20%3D%20sigmaRadians%20%2F%20radiansPerPixel%3B%0A%20%20%20%20const%20samples%20%3D%20isFinite%28sigmaRadians%29%20%3F%201%20%2B%20Math.floor%28STANDARD_DEVIATIONS%20%2A%20sigmaPixels%29%20%3A%20MAX_SAMPLES%3B%0A%20%20%20%20if%20%28samples%20%3E%20MAX_SAMPLES%29%20%7B%0A%20%20%20%20%20%20console.warn%28%60sigmaRadians%2C%20%24%7BsigmaRadians%7D%2C%20is%20too%20large%20and%20will%20clip%2C%20as%20it%20requested%20%24%7Bsamples%7D%20samples%20when%20the%20maximum%20is%20set%20to%20%24%7BMAX_SAMPLES%7D%60%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20weights%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20sum%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20MAX_SAMPLES%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20x3%20%3D%20i%20%2F%20sigmaPixels%3B%0A%20%20%20%20%20%20const%20weight%20%3D%20Math.exp%28-x3%20%2A%20x3%20%2F%202%29%3B%0A%20%20%20%20%20%20weights.push%28weight%29%3B%0A%20%20%20%20%20%20if%20%28i%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20sum%20%2B%3D%20weight%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28i%20%3C%20samples%29%20%7B%0A%20%20%20%20%20%20%20%20sum%20%2B%3D%202%20%2A%20weight%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20weights.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20weights%5Bi%5D%20%3D%20weights%5Bi%5D%20%2F%20sum%3B%0A%20%20%20%20%7D%0A%20%20%20%20blurUniforms%5B%22envMap%22%5D.value%20%3D%20targetIn.texture%3B%0A%20%20%20%20blurUniforms%5B%22samples%22%5D.value%20%3D%20samples%3B%0A%20%20%20%20blurUniforms%5B%22weights%22%5D.value%20%3D%20weights%3B%0A%20%20%20%20blurUniforms%5B%22latitudinal%22%5D.value%20%3D%20direction2%20%3D%3D%3D%20%22latitudinal%22%3B%0A%20%20%20%20if%20%28poleAxis%29%20%7B%0A%20%20%20%20%20%20blurUniforms%5B%22poleAxis%22%5D.value%20%3D%20poleAxis%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20%7B%20_lodMax%20%7D%20%3D%20this%3B%0A%20%20%20%20blurUniforms%5B%22dTheta%22%5D.value%20%3D%20radiansPerPixel%3B%0A%20%20%20%20blurUniforms%5B%22mipInt%22%5D.value%20%3D%20_lodMax%20-%20lodIn%3B%0A%20%20%20%20const%20outputSize%20%3D%20this._sizeLods%5BlodOut%5D%3B%0A%20%20%20%20const%20x2%20%3D%203%20%2A%20outputSize%20%2A%20%28lodOut%20%3E%20_lodMax%20-%20LOD_MIN%20%3F%20lodOut%20-%20_lodMax%20%2B%20LOD_MIN%20%3A%200%29%3B%0A%20%20%20%20const%20y2%20%3D%204%20%2A%20%28this._cubeSize%20-%20outputSize%29%3B%0A%20%20%20%20_setViewport%28targetOut%2C%20x2%2C%20y2%2C%203%20%2A%20outputSize%2C%202%20%2A%20outputSize%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28targetOut%29%3B%0A%20%20%20%20renderer3.render%28blurMesh%2C%20_flatCamera%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20_createPlanes%28lodMax%29%20%7B%0A%20%20const%20lodPlanes%20%3D%20%5B%5D%3B%0A%20%20const%20sizeLods%20%3D%20%5B%5D%3B%0A%20%20const%20sigmas%20%3D%20%5B%5D%3B%0A%20%20let%20lod%20%3D%20lodMax%3B%0A%20%20const%20totalLods%20%3D%20lodMax%20-%20LOD_MIN%20%2B%201%20%2B%20EXTRA_LOD_SIGMA.length%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20totalLods%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20const%20sizeLod%20%3D%20Math.pow%282%2C%20lod%29%3B%0A%20%20%20%20sizeLods.push%28sizeLod%29%3B%0A%20%20%20%20let%20sigma%20%3D%201%20%2F%20sizeLod%3B%0A%20%20%20%20if%20%28i%20%3E%20lodMax%20-%20LOD_MIN%29%20%7B%0A%20%20%20%20%20%20sigma%20%3D%20EXTRA_LOD_SIGMA%5Bi%20-%20lodMax%20%2B%20LOD_MIN%20-%201%5D%3B%0A%20%20%20%20%7D%20else%20if%20%28i%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20sigma%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20sigmas.push%28sigma%29%3B%0A%20%20%20%20const%20texelSize%20%3D%201%20%2F%20%28sizeLod%20-%202%29%3B%0A%20%20%20%20const%20min2%20%3D%20-texelSize%3B%0A%20%20%20%20const%20max2%20%3D%201%20%2B%20texelSize%3B%0A%20%20%20%20const%20uv1%20%3D%20%5Bmin2%2C%20min2%2C%20max2%2C%20min2%2C%20max2%2C%20max2%2C%20min2%2C%20min2%2C%20max2%2C%20max2%2C%20min2%2C%20max2%5D%3B%0A%20%20%20%20const%20cubeFaces%20%3D%206%3B%0A%20%20%20%20const%20vertices%20%3D%206%3B%0A%20%20%20%20const%20positionSize%20%3D%203%3B%0A%20%20%20%20const%20uvSize%20%3D%202%3B%0A%20%20%20%20const%20faceIndexSize%20%3D%201%3B%0A%20%20%20%20const%20position%20%3D%20new%20Float32Array%28positionSize%20%2A%20vertices%20%2A%20cubeFaces%29%3B%0A%20%20%20%20const%20uv2%20%3D%20new%20Float32Array%28uvSize%20%2A%20vertices%20%2A%20cubeFaces%29%3B%0A%20%20%20%20const%20faceIndex%20%3D%20new%20Float32Array%28faceIndexSize%20%2A%20vertices%20%2A%20cubeFaces%29%3B%0A%20%20%20%20for%20%28let%20face%20%3D%200%3B%20face%20%3C%20cubeFaces%3B%20face%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20x2%20%3D%20face%20%25%203%20%2A%202%20%2F%203%20-%201%3B%0A%20%20%20%20%20%20const%20y2%20%3D%20face%20%3E%202%20%3F%200%20%3A%20-1%3B%0A%20%20%20%20%20%20const%20coordinates%20%3D%20%5B%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%20%2B%202%20%2F%203%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%20%2B%202%20%2F%203%2C%0A%20%20%20%20%20%20%20%20y2%20%2B%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%20%2B%202%20%2F%203%2C%0A%20%20%20%20%20%20%20%20y2%20%2B%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%20y2%20%2B%201%2C%0A%20%20%20%20%20%20%20%200%0A%20%20%20%20%20%20%5D%3B%0A%20%20%20%20%20%20position.set%28coordinates%2C%20positionSize%20%2A%20vertices%20%2A%20face%29%3B%0A%20%20%20%20%20%20uv2.set%28uv1%2C%20uvSize%20%2A%20vertices%20%2A%20face%29%3B%0A%20%20%20%20%20%20const%20fill%20%3D%20%5Bface%2C%20face%2C%20face%2C%20face%2C%20face%2C%20face%5D%3B%0A%20%20%20%20%20%20faceIndex.set%28fill%2C%20faceIndexSize%20%2A%20vertices%20%2A%20face%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20planes%20%3D%20new%20BufferGeometry%28%29%3B%0A%20%20%20%20planes.setAttribute%28%22position%22%2C%20new%20BufferAttribute%28position%2C%20positionSize%29%29%3B%0A%20%20%20%20planes.setAttribute%28%22uv%22%2C%20new%20BufferAttribute%28uv2%2C%20uvSize%29%29%3B%0A%20%20%20%20planes.setAttribute%28%22faceIndex%22%2C%20new%20BufferAttribute%28faceIndex%2C%20faceIndexSize%29%29%3B%0A%20%20%20%20lodPlanes.push%28planes%29%3B%0A%20%20%20%20if%20%28lod%20%3E%20LOD_MIN%29%20%7B%0A%20%20%20%20%20%20lod--%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20%7B%20lodPlanes%2C%20sizeLods%2C%20sigmas%20%7D%3B%0A%7D%0Afunction%20_createRenderTarget%28width%2C%20height%2C%20params%29%20%7B%0A%20%20const%20cubeUVRenderTarget%20%3D%20new%20WebGLRenderTarget%28width%2C%20height%2C%20params%29%3B%0A%20%20cubeUVRenderTarget.texture.mapping%20%3D%20CubeUVReflectionMapping%3B%0A%20%20cubeUVRenderTarget.texture.name%20%3D%20%22PMREM.cubeUv%22%3B%0A%20%20cubeUVRenderTarget.scissorTest%20%3D%20true%3B%0A%20%20return%20cubeUVRenderTarget%3B%0A%7D%0Afunction%20_setViewport%28target%2C%20x2%2C%20y2%2C%20width%2C%20height%29%20%7B%0A%20%20target.viewport.set%28x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%20%20target.scissor.set%28x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%7D%0Afunction%20_getBlurShader%28lodMax%2C%20width%2C%20height%29%20%7B%0A%20%20const%20weights%20%3D%20new%20Float32Array%28MAX_SAMPLES%29%3B%0A%20%20const%20poleAxis%20%3D%20new%20Vector3%280%2C%201%2C%200%29%3B%0A%20%20const%20shaderMaterial%20%3D%20new%20ShaderMaterial%28%7B%0A%20%20%20%20name%3A%20%22SphericalGaussianBlur%22%2C%0A%20%20%20%20defines%3A%20%7B%0A%20%20%20%20%20%20%22n%22%3A%20MAX_SAMPLES%2C%0A%20%20%20%20%20%20%22CUBEUV_TEXEL_WIDTH%22%3A%201%20%2F%20width%2C%0A%20%20%20%20%20%20%22CUBEUV_TEXEL_HEIGHT%22%3A%201%20%2F%20height%2C%0A%20%20%20%20%20%20%22CUBEUV_MAX_MIP%22%3A%20%60%24%7BlodMax%7D.0%60%0A%20%20%20%20%7D%2C%0A%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20%22envMap%22%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20%22samples%22%3A%20%7B%20value%3A%201%20%7D%2C%0A%20%20%20%20%20%20%22weights%22%3A%20%7B%20value%3A%20weights%20%7D%2C%0A%20%20%20%20%20%20%22latitudinal%22%3A%20%7B%20value%3A%20false%20%7D%2C%0A%20%20%20%20%20%20%22dTheta%22%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20%22mipInt%22%3A%20%7B%20value%3A%200%20%7D%2C%0A%20%20%20%20%20%20%22poleAxis%22%3A%20%7B%20value%3A%20poleAxis%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20vertexShader%3A%20_getCommonVertexShader%28%29%2C%0A%20%20%20%20fragmentShader%3A%20%28%0A%20%20%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%20%20%60%0A%0A%09%09%09precision%20mediump%20float%3B%0A%09%09%09precision%20mediump%20int%3B%0A%0A%09%09%09varying%20vec3%20vOutputDirection%3B%0A%0A%09%09%09uniform%20sampler2D%20envMap%3B%0A%09%09%09uniform%20int%20samples%3B%0A%09%09%09uniform%20float%20weights%5B%20n%20%5D%3B%0A%09%09%09uniform%20bool%20latitudinal%3B%0A%09%09%09uniform%20float%20dTheta%3B%0A%09%09%09uniform%20float%20mipInt%3B%0A%09%09%09uniform%20vec3%20poleAxis%3B%0A%0A%09%09%09%23define%20ENVMAP_TYPE_CUBE_UV%0A%09%09%09%23include%20%3Ccube_uv_reflection_fragment%3E%0A%0A%09%09%09vec3%20getSample%28%20float%20theta%2C%20vec3%20axis%20%29%20%7B%0A%0A%09%09%09%09float%20cosTheta%20%3D%20cos%28%20theta%20%29%3B%0A%09%09%09%09%2F%2F%20Rodrigues%27%20axis-angle%20rotation%0A%09%09%09%09vec3%20sampleDirection%20%3D%20vOutputDirection%20%2A%20cosTheta%0A%09%09%09%09%09%2B%20cross%28%20axis%2C%20vOutputDirection%20%29%20%2A%20sin%28%20theta%20%29%0A%09%09%09%09%09%2B%20axis%20%2A%20dot%28%20axis%2C%20vOutputDirection%20%29%20%2A%20%28%201.0%20-%20cosTheta%20%29%3B%0A%0A%09%09%09%09return%20bilinearCubeUV%28%20envMap%2C%20sampleDirection%2C%20mipInt%20%29%3B%0A%0A%09%09%09%7D%0A%0A%09%09%09void%20main%28%29%20%7B%0A%0A%09%09%09%09vec3%20axis%20%3D%20latitudinal%20%3F%20poleAxis%20%3A%20cross%28%20poleAxis%2C%20vOutputDirection%20%29%3B%0A%0A%09%09%09%09if%20%28%20all%28%20equal%28%20axis%2C%20vec3%28%200.0%20%29%20%29%20%29%20%29%20%7B%0A%0A%09%09%09%09%09axis%20%3D%20vec3%28%20vOutputDirection.z%2C%200.0%2C%20-%20vOutputDirection.x%20%29%3B%0A%0A%09%09%09%09%7D%0A%0A%09%09%09%09axis%20%3D%20normalize%28%20axis%20%29%3B%0A%0A%09%09%09%09gl_FragColor%20%3D%20vec4%28%200.0%2C%200.0%2C%200.0%2C%201.0%20%29%3B%0A%09%09%09%09gl_FragColor.rgb%20%2B%3D%20weights%5B%200%20%5D%20%2A%20getSample%28%200.0%2C%20axis%20%29%3B%0A%0A%09%09%09%09for%20%28%20int%20i%20%3D%201%3B%20i%20%3C%20n%3B%20i%2B%2B%20%29%20%7B%0A%0A%09%09%09%09%09if%20%28%20i%20%3E%3D%20samples%20%29%20%7B%0A%0A%09%09%09%09%09%09break%3B%0A%0A%09%09%09%09%09%7D%0A%0A%09%09%09%09%09float%20theta%20%3D%20dTheta%20%2A%20float%28%20i%20%29%3B%0A%09%09%09%09%09gl_FragColor.rgb%20%2B%3D%20weights%5B%20i%20%5D%20%2A%20getSample%28%20-1.0%20%2A%20theta%2C%20axis%20%29%3B%0A%09%09%09%09%09gl_FragColor.rgb%20%2B%3D%20weights%5B%20i%20%5D%20%2A%20getSample%28%20theta%2C%20axis%20%29%3B%0A%0A%09%09%09%09%7D%0A%0A%09%09%09%7D%0A%09%09%60%0A%20%20%20%20%29%2C%0A%20%20%20%20blending%3A%20NoBlending%2C%0A%20%20%20%20depthTest%3A%20false%2C%0A%20%20%20%20depthWrite%3A%20false%0A%20%20%7D%29%3B%0A%20%20return%20shaderMaterial%3B%0A%7D%0Afunction%20_getEquirectMaterial%28%29%20%7B%0A%20%20return%20new%20ShaderMaterial%28%7B%0A%20%20%20%20name%3A%20%22EquirectangularToCubeUV%22%2C%0A%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20%22envMap%22%3A%20%7B%20value%3A%20null%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20vertexShader%3A%20_getCommonVertexShader%28%29%2C%0A%20%20%20%20fragmentShader%3A%20%28%0A%20%20%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%20%20%60%0A%0A%09%09%09precision%20mediump%20float%3B%0A%09%09%09precision%20mediump%20int%3B%0A%0A%09%09%09varying%20vec3%20vOutputDirection%3B%0A%0A%09%09%09uniform%20sampler2D%20envMap%3B%0A%0A%09%09%09%23include%20%3Ccommon%3E%0A%0A%09%09%09void%20main%28%29%20%7B%0A%0A%09%09%09%09vec3%20outputDirection%20%3D%20normalize%28%20vOutputDirection%20%29%3B%0A%09%09%09%09vec2%20uv%20%3D%20equirectUv%28%20outputDirection%20%29%3B%0A%0A%09%09%09%09gl_FragColor%20%3D%20vec4%28%20texture2D%20%28%20envMap%2C%20uv%20%29.rgb%2C%201.0%20%29%3B%0A%0A%09%09%09%7D%0A%09%09%60%0A%20%20%20%20%29%2C%0A%20%20%20%20blending%3A%20NoBlending%2C%0A%20%20%20%20depthTest%3A%20false%2C%0A%20%20%20%20depthWrite%3A%20false%0A%20%20%7D%29%3B%0A%7D%0Afunction%20_getCubemapMaterial%28%29%20%7B%0A%20%20return%20new%20ShaderMaterial%28%7B%0A%20%20%20%20name%3A%20%22CubemapToCubeUV%22%2C%0A%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20%22envMap%22%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20%22flipEnvMap%22%3A%20%7B%20value%3A%20-1%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20vertexShader%3A%20_getCommonVertexShader%28%29%2C%0A%20%20%20%20fragmentShader%3A%20%28%0A%20%20%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%20%20%60%0A%0A%09%09%09precision%20mediump%20float%3B%0A%09%09%09precision%20mediump%20int%3B%0A%0A%09%09%09uniform%20float%20flipEnvMap%3B%0A%0A%09%09%09varying%20vec3%20vOutputDirection%3B%0A%0A%09%09%09uniform%20samplerCube%20envMap%3B%0A%0A%09%09%09void%20main%28%29%20%7B%0A%0A%09%09%09%09gl_FragColor%20%3D%20textureCube%28%20envMap%2C%20vec3%28%20flipEnvMap%20%2A%20vOutputDirection.x%2C%20vOutputDirection.yz%20%29%20%29%3B%0A%0A%09%09%09%7D%0A%09%09%60%0A%20%20%20%20%29%2C%0A%20%20%20%20blending%3A%20NoBlending%2C%0A%20%20%20%20depthTest%3A%20false%2C%0A%20%20%20%20depthWrite%3A%20false%0A%20%20%7D%29%3B%0A%7D%0Afunction%20_getCommonVertexShader%28%29%20%7B%0A%20%20return%20%28%0A%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%60%0A%0A%09%09precision%20mediump%20float%3B%0A%09%09precision%20mediump%20int%3B%0A%0A%09%09attribute%20float%20faceIndex%3B%0A%0A%09%09varying%20vec3%20vOutputDirection%3B%0A%0A%09%09%2F%2F%20RH%20coordinate%20system%3B%20PMREM%20face-indexing%20convention%0A%09%09vec3%20getDirection%28%20vec2%20uv%2C%20float%20face%20%29%20%7B%0A%0A%09%09%09uv%20%3D%202.0%20%2A%20uv%20-%201.0%3B%0A%0A%09%09%09vec3%20direction%20%3D%20vec3%28%20uv%2C%201.0%20%29%3B%0A%0A%09%09%09if%20%28%20face%20%3D%3D%200.0%20%29%20%7B%0A%0A%09%09%09%09direction%20%3D%20direction.zyx%3B%20%2F%2F%20%28%201%2C%20v%2C%20u%20%29%20pos%20x%0A%0A%09%09%09%7D%20else%20if%20%28%20face%20%3D%3D%201.0%20%29%20%7B%0A%0A%09%09%09%09direction%20%3D%20direction.xzy%3B%0A%09%09%09%09direction.xz%20%2A%3D%20-1.0%3B%20%2F%2F%20%28%20-u%2C%201%2C%20-v%20%29%20pos%20y%0A%0A%09%09%09%7D%20else%20if%20%28%20face%20%3D%3D%202.0%20%29%20%7B%0A%0A%09%09%09%09direction.x%20%2A%3D%20-1.0%3B%20%2F%2F%20%28%20-u%2C%20v%2C%201%20%29%20pos%20z%0A%0A%09%09%09%7D%20else%20if%20%28%20face%20%3D%3D%203.0%20%29%20%7B%0A%0A%09%09%09%09direction%20%3D%20direction.zyx%3B%0A%09%09%09%09direction.xz%20%2A%3D%20-1.0%3B%20%2F%2F%20%28%20-1%2C%20v%2C%20-u%20%29%20neg%20x%0A%0A%09%09%09%7D%20else%20if%20%28%20face%20%3D%3D%204.0%20%29%20%7B%0A%0A%09%09%09%09direction%20%3D%20direction.xzy%3B%0A%09%09%09%09direction.xy%20%2A%3D%20-1.0%3B%20%2F%2F%20%28%20-u%2C%20-1%2C%20v%20%29%20neg%20y%0A%0A%09%09%09%7D%20else%20if%20%28%20face%20%3D%3D%205.0%20%29%20%7B%0A%0A%09%09%09%09direction.z%20%2A%3D%20-1.0%3B%20%2F%2F%20%28%20u%2C%20v%2C%20-1%20%29%20neg%20z%0A%0A%09%09%09%7D%0A%0A%09%09%09return%20direction%3B%0A%0A%09%09%7D%0A%0A%09%09void%20main%28%29%20%7B%0A%0A%09%09%09vOutputDirection%20%3D%20getDirection%28%20uv%2C%20faceIndex%20%29%3B%0A%09%09%09gl_Position%20%3D%20vec4%28%20position%2C%201.0%20%29%3B%0A%0A%09%09%7D%0A%09%60%0A%20%20%29%3B%0A%7D%0Afunction%20WebGLCubeUVMaps%28renderer3%29%20%7B%0A%20%20let%20cubeUVmaps%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20let%20pmremGenerator%20%3D%20null%3B%0A%20%20function%20get2%28texture2%29%20%7B%0A%20%20%20%20if%20%28texture2%20%26%26%20texture2.isTexture%29%20%7B%0A%20%20%20%20%20%20const%20mapping%20%3D%20texture2.mapping%3B%0A%20%20%20%20%20%20const%20isEquirectMap%20%3D%20mapping%20%3D%3D%3D%20EquirectangularReflectionMapping%20%7C%7C%20mapping%20%3D%3D%3D%20EquirectangularRefractionMapping%3B%0A%20%20%20%20%20%20const%20isCubeMap%20%3D%20mapping%20%3D%3D%3D%20CubeReflectionMapping%20%7C%7C%20mapping%20%3D%3D%3D%20CubeRefractionMapping%3B%0A%20%20%20%20%20%20if%20%28isEquirectMap%20%7C%7C%20isCubeMap%29%20%7B%0A%20%20%20%20%20%20%20%20let%20renderTarget%20%3D%20cubeUVmaps.get%28texture2%29%3B%0A%20%20%20%20%20%20%20%20const%20currentPMREMVersion%20%3D%20renderTarget%20%21%3D%3D%20void%200%20%3F%20renderTarget.texture.pmremVersion%20%3A%200%3B%0A%20%20%20%20%20%20%20%20if%20%28texture2.isRenderTargetTexture%20%26%26%20texture2.pmremVersion%20%21%3D%3D%20currentPMREMVersion%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28pmremGenerator%20%3D%3D%3D%20null%29%20pmremGenerator%20%3D%20new%20PMREMGenerator%28renderer3%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderTarget%20%3D%20isEquirectMap%20%3F%20pmremGenerator.fromEquirectangular%28texture2%2C%20renderTarget%29%20%3A%20pmremGenerator.fromCubemap%28texture2%2C%20renderTarget%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderTarget.texture.pmremVersion%20%3D%20texture2.pmremVersion%3B%0A%20%20%20%20%20%20%20%20%20%20cubeUVmaps.set%28texture2%2C%20renderTarget%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20renderTarget.texture%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20renderTarget.texture%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20image%20%3D%20texture2.image%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28isEquirectMap%20%26%26%20image%20%26%26%20image.height%20%3E%200%20%7C%7C%20isCubeMap%20%26%26%20image%20%26%26%20isCubeTextureComplete%28image%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28pmremGenerator%20%3D%3D%3D%20null%29%20pmremGenerator%20%3D%20new%20PMREMGenerator%28renderer3%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20renderTarget%20%3D%20isEquirectMap%20%3F%20pmremGenerator.fromEquirectangular%28texture2%29%20%3A%20pmremGenerator.fromCubemap%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20renderTarget.texture.pmremVersion%20%3D%20texture2.pmremVersion%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20cubeUVmaps.set%28texture2%2C%20renderTarget%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture2.addEventListener%28%22dispose%22%2C%20onTextureDispose2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20renderTarget.texture%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20texture2%3B%0A%20%20%7D%0A%20%20function%20isCubeTextureComplete%28image%29%20%7B%0A%20%20%20%20let%20count%20%3D%200%3B%0A%20%20%20%20const%20length2%20%3D%206%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20length2%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28image%5Bi%5D%20%21%3D%3D%20void%200%29%20count%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20count%20%3D%3D%3D%20length2%3B%0A%20%20%7D%0A%20%20function%20onTextureDispose2%28event%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20event.target%3B%0A%20%20%20%20texture2.removeEventListener%28%22dispose%22%2C%20onTextureDispose2%29%3B%0A%20%20%20%20const%20cubemapUV%20%3D%20cubeUVmaps.get%28texture2%29%3B%0A%20%20%20%20if%20%28cubemapUV%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20cubeUVmaps.delete%28texture2%29%3B%0A%20%20%20%20%20%20cubemapUV.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20dispose%28%29%20%7B%0A%20%20%20%20cubeUVmaps%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20if%20%28pmremGenerator%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20pmremGenerator.dispose%28%29%3B%0A%20%20%20%20%20%20pmremGenerator%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20get%3A%20get2%2C%0A%20%20%20%20dispose%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLExtensions%28gl%29%20%7B%0A%20%20const%20extensions%20%3D%20%7B%7D%3B%0A%20%20function%20getExtension%28name%29%20%7B%0A%20%20%20%20if%20%28extensions%5Bname%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20return%20extensions%5Bname%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20extension%3B%0A%20%20%20%20switch%20%28name%29%20%7B%0A%20%20%20%20%20%20case%20%22WEBGL_depth_texture%22%3A%0A%20%20%20%20%20%20%20%20extension%20%3D%20gl.getExtension%28%22WEBGL_depth_texture%22%29%20%7C%7C%20gl.getExtension%28%22MOZ_WEBGL_depth_texture%22%29%20%7C%7C%20gl.getExtension%28%22WEBKIT_WEBGL_depth_texture%22%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22EXT_texture_filter_anisotropic%22%3A%0A%20%20%20%20%20%20%20%20extension%20%3D%20gl.getExtension%28%22EXT_texture_filter_anisotropic%22%29%20%7C%7C%20gl.getExtension%28%22MOZ_EXT_texture_filter_anisotropic%22%29%20%7C%7C%20gl.getExtension%28%22WEBKIT_EXT_texture_filter_anisotropic%22%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22WEBGL_compressed_texture_s3tc%22%3A%0A%20%20%20%20%20%20%20%20extension%20%3D%20gl.getExtension%28%22WEBGL_compressed_texture_s3tc%22%29%20%7C%7C%20gl.getExtension%28%22MOZ_WEBGL_compressed_texture_s3tc%22%29%20%7C%7C%20gl.getExtension%28%22WEBKIT_WEBGL_compressed_texture_s3tc%22%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22WEBGL_compressed_texture_pvrtc%22%3A%0A%20%20%20%20%20%20%20%20extension%20%3D%20gl.getExtension%28%22WEBGL_compressed_texture_pvrtc%22%29%20%7C%7C%20gl.getExtension%28%22WEBKIT_WEBGL_compressed_texture_pvrtc%22%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20extension%20%3D%20gl.getExtension%28name%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20extensions%5Bname%5D%20%3D%20extension%3B%0A%20%20%20%20return%20extension%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20has%3A%20function%28name%29%20%7B%0A%20%20%20%20%20%20return%20getExtension%28name%29%20%21%3D%3D%20null%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20init%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20getExtension%28%22EXT_color_buffer_float%22%29%3B%0A%20%20%20%20%20%20getExtension%28%22WEBGL_clip_cull_distance%22%29%3B%0A%20%20%20%20%20%20getExtension%28%22OES_texture_float_linear%22%29%3B%0A%20%20%20%20%20%20getExtension%28%22EXT_color_buffer_half_float%22%29%3B%0A%20%20%20%20%20%20getExtension%28%22WEBGL_multisampled_render_to_texture%22%29%3B%0A%20%20%20%20%20%20getExtension%28%22WEBGL_render_shared_exponent%22%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20get%3A%20function%28name%29%20%7B%0A%20%20%20%20%20%20const%20extension%20%3D%20getExtension%28name%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20warnOnce%28%22THREE.WebGLRenderer%3A%20%22%20%2B%20name%20%2B%20%22%20extension%20not%20supported.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20extension%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLGeometries%28gl%2C%20attributes%2C%20info%2C%20bindingStates%29%20%7B%0A%20%20const%20geometries%20%3D%20%7B%7D%3B%0A%20%20const%20wireframeAttributes%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20function%20onGeometryDispose%28event%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20event.target%3B%0A%20%20%20%20if%20%28geometry.index%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20attributes.remove%28geometry.index%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28const%20name%20in%20geometry.attributes%29%20%7B%0A%20%20%20%20%20%20attributes.remove%28geometry.attributes%5Bname%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28const%20name%20in%20geometry.morphAttributes%29%20%7B%0A%20%20%20%20%20%20const%20array%20%3D%20geometry.morphAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20array.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20attributes.remove%28array%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20geometry.removeEventListener%28%22dispose%22%2C%20onGeometryDispose%29%3B%0A%20%20%20%20delete%20geometries%5Bgeometry.id%5D%3B%0A%20%20%20%20const%20attribute2%20%3D%20wireframeAttributes.get%28geometry%29%3B%0A%20%20%20%20if%20%28attribute2%29%20%7B%0A%20%20%20%20%20%20attributes.remove%28attribute2%29%3B%0A%20%20%20%20%20%20wireframeAttributes.delete%28geometry%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20bindingStates.releaseStatesOfGeometry%28geometry%29%3B%0A%20%20%20%20if%20%28geometry.isInstancedBufferGeometry%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20delete%20geometry._maxInstanceCount%3B%0A%20%20%20%20%7D%0A%20%20%20%20info.memory.geometries--%3B%0A%20%20%7D%0A%20%20function%20get2%28object%2C%20geometry%29%20%7B%0A%20%20%20%20if%20%28geometries%5Bgeometry.id%5D%20%3D%3D%3D%20true%29%20return%20geometry%3B%0A%20%20%20%20geometry.addEventListener%28%22dispose%22%2C%20onGeometryDispose%29%3B%0A%20%20%20%20geometries%5Bgeometry.id%5D%20%3D%20true%3B%0A%20%20%20%20info.memory.geometries%2B%2B%3B%0A%20%20%20%20return%20geometry%3B%0A%20%20%7D%0A%20%20function%20update4%28geometry%29%20%7B%0A%20%20%20%20const%20geometryAttributes%20%3D%20geometry.attributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20geometryAttributes%29%20%7B%0A%20%20%20%20%20%20attributes.update%28geometryAttributes%5Bname%5D%2C%20gl.ARRAY_BUFFER%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20morphAttributes%20%3D%20geometry.morphAttributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20morphAttributes%29%20%7B%0A%20%20%20%20%20%20const%20array%20%3D%20morphAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20array.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20attributes.update%28array%5Bi%5D%2C%20gl.ARRAY_BUFFER%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20updateWireframeAttribute%28geometry%29%20%7B%0A%20%20%20%20const%20indices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20geometryIndex%20%3D%20geometry.index%3B%0A%20%20%20%20const%20geometryPosition%20%3D%20geometry.attributes.position%3B%0A%20%20%20%20let%20version%20%3D%200%3B%0A%20%20%20%20if%20%28geometryIndex%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20array%20%3D%20geometryIndex.array%3B%0A%20%20%20%20%20%20version%20%3D%20geometryIndex.version%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20array.length%3B%20i%20%3C%20l%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20const%20a2%20%3D%20array%5Bi%20%2B%200%5D%3B%0A%20%20%20%20%20%20%20%20const%20b%20%3D%20array%5Bi%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20const%20c2%20%3D%20array%5Bi%20%2B%202%5D%3B%0A%20%20%20%20%20%20%20%20indices.push%28a2%2C%20b%2C%20b%2C%20c2%2C%20c2%2C%20a2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28geometryPosition%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20array%20%3D%20geometryPosition.array%3B%0A%20%20%20%20%20%20version%20%3D%20geometryPosition.version%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20array.length%20%2F%203%20-%201%3B%20i%20%3C%20l%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20const%20a2%20%3D%20i%20%2B%200%3B%0A%20%20%20%20%20%20%20%20const%20b%20%3D%20i%20%2B%201%3B%0A%20%20%20%20%20%20%20%20const%20c2%20%3D%20i%20%2B%202%3B%0A%20%20%20%20%20%20%20%20indices.push%28a2%2C%20b%2C%20b%2C%20c2%2C%20c2%2C%20a2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20attribute2%20%3D%20new%20%28arrayNeedsUint32%28indices%29%20%3F%20Uint32BufferAttribute%20%3A%20Uint16BufferAttribute%29%28indices%2C%201%29%3B%0A%20%20%20%20attribute2.version%20%3D%20version%3B%0A%20%20%20%20const%20previousAttribute%20%3D%20wireframeAttributes.get%28geometry%29%3B%0A%20%20%20%20if%20%28previousAttribute%29%20attributes.remove%28previousAttribute%29%3B%0A%20%20%20%20wireframeAttributes.set%28geometry%2C%20attribute2%29%3B%0A%20%20%7D%0A%20%20function%20getWireframeAttribute%28geometry%29%20%7B%0A%20%20%20%20const%20currentAttribute%20%3D%20wireframeAttributes.get%28geometry%29%3B%0A%20%20%20%20if%20%28currentAttribute%29%20%7B%0A%20%20%20%20%20%20const%20geometryIndex%20%3D%20geometry.index%3B%0A%20%20%20%20%20%20if%20%28geometryIndex%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28currentAttribute.version%20%3C%20geometryIndex.version%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20updateWireframeAttribute%28geometry%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20updateWireframeAttribute%28geometry%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20wireframeAttributes.get%28geometry%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20get%3A%20get2%2C%0A%20%20%20%20update%3A%20update4%2C%0A%20%20%20%20getWireframeAttribute%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLIndexedBufferRenderer%28gl%2C%20extensions%2C%20info%29%20%7B%0A%20%20let%20mode%3B%0A%20%20function%20setMode%28value%29%20%7B%0A%20%20%20%20mode%20%3D%20value%3B%0A%20%20%7D%0A%20%20let%20type%2C%20bytesPerElement%3B%0A%20%20function%20setIndex%28value%29%20%7B%0A%20%20%20%20type%20%3D%20value.type%3B%0A%20%20%20%20bytesPerElement%20%3D%20value.bytesPerElement%3B%0A%20%20%7D%0A%20%20function%20render%28start%2C%20count%29%20%7B%0A%20%20%20%20gl.drawElements%28mode%2C%20count%2C%20type%2C%20start%20%2A%20bytesPerElement%29%3B%0A%20%20%20%20info.update%28count%2C%20mode%2C%201%29%3B%0A%20%20%7D%0A%20%20function%20renderInstances%28start%2C%20count%2C%20primcount%29%20%7B%0A%20%20%20%20if%20%28primcount%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20gl.drawElementsInstanced%28mode%2C%20count%2C%20type%2C%20start%20%2A%20bytesPerElement%2C%20primcount%29%3B%0A%20%20%20%20info.update%28count%2C%20mode%2C%20primcount%29%3B%0A%20%20%7D%0A%20%20function%20renderMultiDraw%28starts%2C%20counts%2C%20drawCount%29%20%7B%0A%20%20%20%20if%20%28drawCount%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20const%20extension%20%3D%20extensions.get%28%22WEBGL_multi_draw%22%29%3B%0A%20%20%20%20extension.multiDrawElementsWEBGL%28mode%2C%20counts%2C%200%2C%20type%2C%20starts%2C%200%2C%20drawCount%29%3B%0A%20%20%20%20let%20elementCount%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20elementCount%20%2B%3D%20counts%5Bi%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20info.update%28elementCount%2C%20mode%2C%201%29%3B%0A%20%20%7D%0A%20%20function%20renderMultiDrawInstances%28starts%2C%20counts%2C%20drawCount%2C%20primcount%29%20%7B%0A%20%20%20%20if%20%28drawCount%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20const%20extension%20%3D%20extensions.get%28%22WEBGL_multi_draw%22%29%3B%0A%20%20%20%20if%20%28extension%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20starts.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20renderInstances%28starts%5Bi%5D%20%2F%20bytesPerElement%2C%20counts%5Bi%5D%2C%20primcount%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20extension.multiDrawElementsInstancedWEBGL%28mode%2C%20counts%2C%200%2C%20type%2C%20starts%2C%200%2C%20primcount%2C%200%2C%20drawCount%29%3B%0A%20%20%20%20%20%20let%20elementCount%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20elementCount%20%2B%3D%20counts%5Bi%5D%20%2A%20primcount%5Bi%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20info.update%28elementCount%2C%20mode%2C%201%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20this.setMode%20%3D%20setMode%3B%0A%20%20this.setIndex%20%3D%20setIndex%3B%0A%20%20this.render%20%3D%20render%3B%0A%20%20this.renderInstances%20%3D%20renderInstances%3B%0A%20%20this.renderMultiDraw%20%3D%20renderMultiDraw%3B%0A%20%20this.renderMultiDrawInstances%20%3D%20renderMultiDrawInstances%3B%0A%7D%0Afunction%20WebGLInfo%28gl%29%20%7B%0A%20%20const%20memory%20%3D%20%7B%0A%20%20%20%20geometries%3A%200%2C%0A%20%20%20%20textures%3A%200%0A%20%20%7D%3B%0A%20%20const%20render%20%3D%20%7B%0A%20%20%20%20frame%3A%200%2C%0A%20%20%20%20calls%3A%200%2C%0A%20%20%20%20triangles%3A%200%2C%0A%20%20%20%20points%3A%200%2C%0A%20%20%20%20lines%3A%200%0A%20%20%7D%3B%0A%20%20function%20update4%28count%2C%20mode%2C%20instanceCount%29%20%7B%0A%20%20%20%20render.calls%2B%2B%3B%0A%20%20%20%20switch%20%28mode%29%20%7B%0A%20%20%20%20%20%20case%20gl.TRIANGLES%3A%0A%20%20%20%20%20%20%20%20render.triangles%20%2B%3D%20instanceCount%20%2A%20%28count%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20gl.LINES%3A%0A%20%20%20%20%20%20%20%20render.lines%20%2B%3D%20instanceCount%20%2A%20%28count%20%2F%202%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20gl.LINE_STRIP%3A%0A%20%20%20%20%20%20%20%20render.lines%20%2B%3D%20instanceCount%20%2A%20%28count%20-%201%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20gl.LINE_LOOP%3A%0A%20%20%20%20%20%20%20%20render.lines%20%2B%3D%20instanceCount%20%2A%20count%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20gl.POINTS%3A%0A%20%20%20%20%20%20%20%20render.points%20%2B%3D%20instanceCount%20%2A%20count%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLInfo%3A%20Unknown%20draw%20mode%3A%22%2C%20mode%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20reset%28%29%20%7B%0A%20%20%20%20render.calls%20%3D%200%3B%0A%20%20%20%20render.triangles%20%3D%200%3B%0A%20%20%20%20render.points%20%3D%200%3B%0A%20%20%20%20render.lines%20%3D%200%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20memory%2C%0A%20%20%20%20render%2C%0A%20%20%20%20programs%3A%20null%2C%0A%20%20%20%20autoReset%3A%20true%2C%0A%20%20%20%20reset%2C%0A%20%20%20%20update%3A%20update4%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLMorphtargets%28gl%2C%20capabilities%2C%20textures%29%20%7B%0A%20%20const%20morphTextures%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20const%20morph%20%3D%20new%20Vector4%28%29%3B%0A%20%20function%20update4%28object%2C%20geometry%2C%20program%29%20%7B%0A%20%20%20%20const%20objectInfluences%20%3D%20object.morphTargetInfluences%3B%0A%20%20%20%20const%20morphAttribute%20%3D%20geometry.morphAttributes.position%20%7C%7C%20geometry.morphAttributes.normal%20%7C%7C%20geometry.morphAttributes.color%3B%0A%20%20%20%20const%20morphTargetsCount%20%3D%20morphAttribute%20%21%3D%3D%20void%200%20%3F%20morphAttribute.length%20%3A%200%3B%0A%20%20%20%20let%20entry%20%3D%20morphTextures.get%28geometry%29%3B%0A%20%20%20%20if%20%28entry%20%3D%3D%3D%20void%200%20%7C%7C%20entry.count%20%21%3D%3D%20morphTargetsCount%29%20%7B%0A%20%20%20%20%20%20let%20disposeTexture%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20texture2.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20morphTextures.delete%28geometry%29%3B%0A%20%20%20%20%20%20%20%20geometry.removeEventListener%28%22dispose%22%2C%20disposeTexture%29%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20if%20%28entry%20%21%3D%3D%20void%200%29%20entry.texture.dispose%28%29%3B%0A%20%20%20%20%20%20const%20hasMorphPosition%20%3D%20geometry.morphAttributes.position%20%21%3D%3D%20void%200%3B%0A%20%20%20%20%20%20const%20hasMorphNormals%20%3D%20geometry.morphAttributes.normal%20%21%3D%3D%20void%200%3B%0A%20%20%20%20%20%20const%20hasMorphColors%20%3D%20geometry.morphAttributes.color%20%21%3D%3D%20void%200%3B%0A%20%20%20%20%20%20const%20morphTargets%20%3D%20geometry.morphAttributes.position%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20const%20morphNormals%20%3D%20geometry.morphAttributes.normal%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20const%20morphColors%20%3D%20geometry.morphAttributes.color%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20let%20vertexDataCount%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28hasMorphPosition%20%3D%3D%3D%20true%29%20vertexDataCount%20%3D%201%3B%0A%20%20%20%20%20%20if%20%28hasMorphNormals%20%3D%3D%3D%20true%29%20vertexDataCount%20%3D%202%3B%0A%20%20%20%20%20%20if%20%28hasMorphColors%20%3D%3D%3D%20true%29%20vertexDataCount%20%3D%203%3B%0A%20%20%20%20%20%20let%20width%20%3D%20geometry.attributes.position.count%20%2A%20vertexDataCount%3B%0A%20%20%20%20%20%20let%20height%20%3D%201%3B%0A%20%20%20%20%20%20if%20%28width%20%3E%20capabilities.maxTextureSize%29%20%7B%0A%20%20%20%20%20%20%20%20height%20%3D%20Math.ceil%28width%20%2F%20capabilities.maxTextureSize%29%3B%0A%20%20%20%20%20%20%20%20width%20%3D%20capabilities.maxTextureSize%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20buffer2%20%3D%20new%20Float32Array%28width%20%2A%20height%20%2A%204%20%2A%20morphTargetsCount%29%3B%0A%20%20%20%20%20%20const%20texture2%20%3D%20new%20DataArrayTexture%28buffer2%2C%20width%2C%20height%2C%20morphTargetsCount%29%3B%0A%20%20%20%20%20%20texture2.type%20%3D%20FloatType%3B%0A%20%20%20%20%20%20texture2.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20const%20vertexDataStride%20%3D%20vertexDataCount%20%2A%204%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20morphTargetsCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20morphTarget%20%3D%20morphTargets%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20morphNormal%20%3D%20morphNormals%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20morphColor%20%3D%20morphColors%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20offset%20%3D%20width%20%2A%20height%20%2A%204%20%2A%20i%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20morphTarget.count%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20stride%20%3D%20j%20%2A%20vertexDataStride%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28hasMorphPosition%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20morph.fromBufferAttribute%28morphTarget%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%200%5D%20%3D%20morph.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%201%5D%20%3D%20morph.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%202%5D%20%3D%20morph.z%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%203%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28hasMorphNormals%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20morph.fromBufferAttribute%28morphNormal%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%204%5D%20%3D%20morph.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%205%5D%20%3D%20morph.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%206%5D%20%3D%20morph.z%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%207%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28hasMorphColors%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20morph.fromBufferAttribute%28morphColor%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%208%5D%20%3D%20morph.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%209%5D%20%3D%20morph.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%2010%5D%20%3D%20morph.z%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%2011%5D%20%3D%20morphColor.itemSize%20%3D%3D%3D%204%20%3F%20morph.w%20%3A%201%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20entry%20%3D%20%7B%0A%20%20%20%20%20%20%20%20count%3A%20morphTargetsCount%2C%0A%20%20%20%20%20%20%20%20texture%3A%20texture2%2C%0A%20%20%20%20%20%20%20%20size%3A%20new%20Vector2%28width%2C%20height%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20morphTextures.set%28geometry%2C%20entry%29%3B%0A%20%20%20%20%20%20geometry.addEventListener%28%22dispose%22%2C%20disposeTexture%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isInstancedMesh%20%3D%3D%3D%20true%20%26%26%20object.morphTexture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20program.getUniforms%28%29.setValue%28gl%2C%20%22morphTexture%22%2C%20object.morphTexture%2C%20textures%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20let%20morphInfluencesSum%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20objectInfluences.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20morphInfluencesSum%20%2B%3D%20objectInfluences%5Bi%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20morphBaseInfluence%20%3D%20geometry.morphTargetsRelative%20%3F%201%20%3A%201%20-%20morphInfluencesSum%3B%0A%20%20%20%20%20%20program.getUniforms%28%29.setValue%28gl%2C%20%22morphTargetBaseInfluence%22%2C%20morphBaseInfluence%29%3B%0A%20%20%20%20%20%20program.getUniforms%28%29.setValue%28gl%2C%20%22morphTargetInfluences%22%2C%20objectInfluences%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20program.getUniforms%28%29.setValue%28gl%2C%20%22morphTargetsTexture%22%2C%20entry.texture%2C%20textures%29%3B%0A%20%20%20%20program.getUniforms%28%29.setValue%28gl%2C%20%22morphTargetsTextureSize%22%2C%20entry.size%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20update%3A%20update4%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLObjects%28gl%2C%20geometries%2C%20attributes%2C%20info%29%20%7B%0A%20%20let%20updateMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20function%20update4%28object%29%20%7B%0A%20%20%20%20const%20frame2%20%3D%20info.render.frame%3B%0A%20%20%20%20const%20geometry%20%3D%20object.geometry%3B%0A%20%20%20%20const%20buffergeometry%20%3D%20geometries.get%28object%2C%20geometry%29%3B%0A%20%20%20%20if%20%28updateMap.get%28buffergeometry%29%20%21%3D%3D%20frame2%29%20%7B%0A%20%20%20%20%20%20geometries.update%28buffergeometry%29%3B%0A%20%20%20%20%20%20updateMap.set%28buffergeometry%2C%20frame2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isInstancedMesh%29%20%7B%0A%20%20%20%20%20%20if%20%28object.hasEventListener%28%22dispose%22%2C%20onInstancedMeshDispose%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20object.addEventListener%28%22dispose%22%2C%20onInstancedMeshDispose%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28updateMap.get%28object%29%20%21%3D%3D%20frame2%29%20%7B%0A%20%20%20%20%20%20%20%20attributes.update%28object.instanceMatrix%2C%20gl.ARRAY_BUFFER%29%3B%0A%20%20%20%20%20%20%20%20if%20%28object.instanceColor%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20attributes.update%28object.instanceColor%2C%20gl.ARRAY_BUFFER%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20updateMap.set%28object%2C%20frame2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isSkinnedMesh%29%20%7B%0A%20%20%20%20%20%20const%20skeleton%20%3D%20object.skeleton%3B%0A%20%20%20%20%20%20if%20%28updateMap.get%28skeleton%29%20%21%3D%3D%20frame2%29%20%7B%0A%20%20%20%20%20%20%20%20skeleton.update%28%29%3B%0A%20%20%20%20%20%20%20%20updateMap.set%28skeleton%2C%20frame2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20buffergeometry%3B%0A%20%20%7D%0A%20%20function%20dispose%28%29%20%7B%0A%20%20%20%20updateMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%20%20function%20onInstancedMeshDispose%28event%29%20%7B%0A%20%20%20%20const%20instancedMesh%20%3D%20event.target%3B%0A%20%20%20%20instancedMesh.removeEventListener%28%22dispose%22%2C%20onInstancedMeshDispose%29%3B%0A%20%20%20%20attributes.remove%28instancedMesh.instanceMatrix%29%3B%0A%20%20%20%20if%20%28instancedMesh.instanceColor%20%21%3D%3D%20null%29%20attributes.remove%28instancedMesh.instanceColor%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20update%3A%20update4%2C%0A%20%20%20%20dispose%0A%20%20%7D%3B%0A%7D%0Avar%20DepthTexture%20%3D%20class%20extends%20Texture%20%7B%0A%20%20constructor%28width%2C%20height%2C%20type%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%2C%20minFilter%2C%20anisotropy2%2C%20format2%20%3D%20DepthFormat%29%20%7B%0A%20%20%20%20if%20%28format2%20%21%3D%3D%20DepthFormat%20%26%26%20format2%20%21%3D%3D%20DepthStencilFormat%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22DepthTexture%20format%20must%20be%20either%20THREE.DepthFormat%20or%20THREE.DepthStencilFormat%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20void%200%20%26%26%20format2%20%3D%3D%3D%20DepthFormat%29%20type%20%3D%20UnsignedIntType%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20void%200%20%26%26%20format2%20%3D%3D%3D%20DepthStencilFormat%29%20type%20%3D%20UnsignedInt248Type%3B%0A%20%20%20%20super%28null%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%2C%20minFilter%2C%20format2%2C%20type%2C%20anisotropy2%29%3B%0A%20%20%20%20this.isDepthTexture%20%3D%20true%3B%0A%20%20%20%20this.image%20%3D%20%7B%20width%2C%20height%20%7D%3B%0A%20%20%20%20this.magFilter%20%3D%20magFilter%20%21%3D%3D%20void%200%20%3F%20magFilter%20%3A%20NearestFilter%3B%0A%20%20%20%20this.minFilter%20%3D%20minFilter%20%21%3D%3D%20void%200%20%3F%20minFilter%20%3A%20NearestFilter%3B%0A%20%20%20%20this.flipY%20%3D%20false%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20this.compareFunction%20%3D%20null%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.compareFunction%20%3D%20source.compareFunction%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20if%20%28this.compareFunction%20%21%3D%3D%20null%29%20data.compareFunction%20%3D%20this.compareFunction%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20emptyTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Texture%28%29%3B%0Avar%20emptyShadowTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20DepthTexture%281%2C%201%29%3B%0Avar%20emptyArrayTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20DataArrayTexture%28%29%3B%0Avar%20empty3dTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Data3DTexture%28%29%3B%0Avar%20emptyCubeTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20CubeTexture%28%29%3B%0Avar%20arrayCacheF32%20%3D%20%5B%5D%3B%0Avar%20arrayCacheI32%20%3D%20%5B%5D%3B%0Avar%20mat4array%20%3D%20new%20Float32Array%2816%29%3B%0Avar%20mat3array%20%3D%20new%20Float32Array%289%29%3B%0Avar%20mat2array%20%3D%20new%20Float32Array%284%29%3B%0Afunction%20flatten%28array%2C%20nBlocks%2C%20blockSize%29%20%7B%0A%20%20const%20firstElem%20%3D%20array%5B0%5D%3B%0A%20%20if%20%28firstElem%20%3C%3D%200%20%7C%7C%20firstElem%20%3E%200%29%20return%20array%3B%0A%20%20const%20n%20%3D%20nBlocks%20%2A%20blockSize%3B%0A%20%20let%20r%20%3D%20arrayCacheF32%5Bn%5D%3B%0A%20%20if%20%28r%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20r%20%3D%20new%20Float32Array%28n%29%3B%0A%20%20%20%20arrayCacheF32%5Bn%5D%20%3D%20r%3B%0A%20%20%7D%0A%20%20if%20%28nBlocks%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20firstElem.toArray%28r%2C%200%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%2C%20offset%20%3D%200%3B%20i%20%21%3D%3D%20nBlocks%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20offset%20%2B%3D%20blockSize%3B%0A%20%20%20%20%20%20array%5Bi%5D.toArray%28r%2C%20offset%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20r%3B%0A%7D%0Afunction%20arraysEqual%28a2%2C%20b%29%20%7B%0A%20%20if%20%28a2.length%20%21%3D%3D%20b.length%29%20return%20false%3B%0A%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20a2.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20if%20%28a2%5Bi%5D%20%21%3D%3D%20b%5Bi%5D%29%20return%20false%3B%0A%20%20%7D%0A%20%20return%20true%3B%0A%7D%0Afunction%20copyArray%28a2%2C%20b%29%20%7B%0A%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20b.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20a2%5Bi%5D%20%3D%20b%5Bi%5D%3B%0A%20%20%7D%0A%7D%0Afunction%20allocTexUnits%28textures%2C%20n%29%20%7B%0A%20%20let%20r%20%3D%20arrayCacheI32%5Bn%5D%3B%0A%20%20if%20%28r%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20r%20%3D%20new%20Int32Array%28n%29%3B%0A%20%20%20%20arrayCacheI32%5Bn%5D%20%3D%20r%3B%0A%20%20%7D%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20r%5Bi%5D%20%3D%20textures.allocateTextureUnit%28%29%3B%0A%20%20%7D%0A%20%20return%20r%3B%0A%7D%0Afunction%20setValueV1f%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28cache2%5B0%5D%20%3D%3D%3D%20v%29%20return%3B%0A%20%20gl.uniform1f%28this.addr%2C%20v%29%3B%0A%20%20cache2%5B0%5D%20%3D%20v%3B%0A%7D%0Afunction%20setValueV2f%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28v.x%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.x%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.y%29%20%7B%0A%20%20%20%20%20%20gl.uniform2f%28this.addr%2C%20v.x%2C%20v.y%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.y%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniform2fv%28this.addr%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueV3f%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28v.x%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.x%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.y%20%7C%7C%20cache2%5B2%5D%20%21%3D%3D%20v.z%29%20%7B%0A%20%20%20%20%20%20gl.uniform3f%28this.addr%2C%20v.x%2C%20v.y%2C%20v.z%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.y%3B%0A%20%20%20%20%20%20cache2%5B2%5D%20%3D%20v.z%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20if%20%28v.r%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.r%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.g%20%7C%7C%20cache2%5B2%5D%20%21%3D%3D%20v.b%29%20%7B%0A%20%20%20%20%20%20gl.uniform3f%28this.addr%2C%20v.r%2C%20v.g%2C%20v.b%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.r%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.g%3B%0A%20%20%20%20%20%20cache2%5B2%5D%20%3D%20v.b%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniform3fv%28this.addr%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueV4f%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28v.x%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.x%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.y%20%7C%7C%20cache2%5B2%5D%20%21%3D%3D%20v.z%20%7C%7C%20cache2%5B3%5D%20%21%3D%3D%20v.w%29%20%7B%0A%20%20%20%20%20%20gl.uniform4f%28this.addr%2C%20v.x%2C%20v.y%2C%20v.z%2C%20v.w%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.y%3B%0A%20%20%20%20%20%20cache2%5B2%5D%20%3D%20v.z%3B%0A%20%20%20%20%20%20cache2%5B3%5D%20%3D%20v.w%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniform4fv%28this.addr%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueM2%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20elements%20%3D%20v.elements%3B%0A%20%20if%20%28elements%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniformMatrix2fv%28this.addr%2C%20false%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20elements%29%29%20return%3B%0A%20%20%20%20mat2array.set%28elements%29%3B%0A%20%20%20%20gl.uniformMatrix2fv%28this.addr%2C%20false%2C%20mat2array%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20elements%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueM3%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20elements%20%3D%20v.elements%3B%0A%20%20if%20%28elements%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniformMatrix3fv%28this.addr%2C%20false%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20elements%29%29%20return%3B%0A%20%20%20%20mat3array.set%28elements%29%3B%0A%20%20%20%20gl.uniformMatrix3fv%28this.addr%2C%20false%2C%20mat3array%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20elements%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueM4%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20elements%20%3D%20v.elements%3B%0A%20%20if%20%28elements%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniformMatrix4fv%28this.addr%2C%20false%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20elements%29%29%20return%3B%0A%20%20%20%20mat4array.set%28elements%29%3B%0A%20%20%20%20gl.uniformMatrix4fv%28this.addr%2C%20false%2C%20mat4array%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20elements%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueV1i%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28cache2%5B0%5D%20%3D%3D%3D%20v%29%20return%3B%0A%20%20gl.uniform1i%28this.addr%2C%20v%29%3B%0A%20%20cache2%5B0%5D%20%3D%20v%3B%0A%7D%0Afunction%20setValueV2i%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28v.x%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.x%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.y%29%20%7B%0A%20%20%20%20%20%20gl.uniform2i%28this.addr%2C%20v.x%2C%20v.y%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.y%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniform2iv%28this.addr%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueV3i%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28v.x%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.x%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.y%20%7C%7C%20cache2%5B2%5D%20%21%3D%3D%20v.z%29%20%7B%0A%20%20%20%20%20%20gl.uniform3i%28this.addr%2C%20v.x%2C%20v.y%2C%20v.z%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.y%3B%0A%20%20%20%20%20%20cache2%5B2%5D%20%3D%20v.z%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniform3iv%28this.addr%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueV4i%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28v.x%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.x%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.y%20%7C%7C%20cache2%5B2%5D%20%21%3D%3D%20v.z%20%7C%7C%20cache2%5B3%5D%20%21%3D%3D%20v.w%29%20%7B%0A%20%20%20%20%20%20gl.uniform4i%28this.addr%2C%20v.x%2C%20v.y%2C%20v.z%2C%20v.w%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.y%3B%0A%20%20%20%20%20%20cache2%5B2%5D%20%3D%20v.z%3B%0A%20%20%20%20%20%20cache2%5B3%5D%20%3D%20v.w%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniform4iv%28this.addr%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueV1ui%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28cache2%5B0%5D%20%3D%3D%3D%20v%29%20return%3B%0A%20%20gl.uniform1ui%28this.addr%2C%20v%29%3B%0A%20%20cache2%5B0%5D%20%3D%20v%3B%0A%7D%0Afunction%20setValueV2ui%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28v.x%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.x%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.y%29%20%7B%0A%20%20%20%20%20%20gl.uniform2ui%28this.addr%2C%20v.x%2C%20v.y%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.y%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniform2uiv%28this.addr%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueV3ui%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28v.x%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.x%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.y%20%7C%7C%20cache2%5B2%5D%20%21%3D%3D%20v.z%29%20%7B%0A%20%20%20%20%20%20gl.uniform3ui%28this.addr%2C%20v.x%2C%20v.y%2C%20v.z%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.y%3B%0A%20%20%20%20%20%20cache2%5B2%5D%20%3D%20v.z%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniform3uiv%28this.addr%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueV4ui%28gl%2C%20v%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20if%20%28v.x%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20v.x%20%7C%7C%20cache2%5B1%5D%20%21%3D%3D%20v.y%20%7C%7C%20cache2%5B2%5D%20%21%3D%3D%20v.z%20%7C%7C%20cache2%5B3%5D%20%21%3D%3D%20v.w%29%20%7B%0A%20%20%20%20%20%20gl.uniform4ui%28this.addr%2C%20v.x%2C%20v.y%2C%20v.z%2C%20v.w%29%3B%0A%20%20%20%20%20%20cache2%5B0%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20cache2%5B1%5D%20%3D%20v.y%3B%0A%20%20%20%20%20%20cache2%5B2%5D%20%3D%20v.z%3B%0A%20%20%20%20%20%20cache2%5B3%5D%20%3D%20v.w%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28arraysEqual%28cache2%2C%20v%29%29%20return%3B%0A%20%20%20%20gl.uniform4uiv%28this.addr%2C%20v%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20v%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueT1%28gl%2C%20v%2C%20textures%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20unit%20%3D%20textures.allocateTextureUnit%28%29%3B%0A%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20unit%29%20%7B%0A%20%20%20%20gl.uniform1i%28this.addr%2C%20unit%29%3B%0A%20%20%20%20cache2%5B0%5D%20%3D%20unit%3B%0A%20%20%7D%0A%20%20let%20emptyTexture2D%3B%0A%20%20if%20%28this.type%20%3D%3D%3D%20gl.SAMPLER_2D_SHADOW%29%20%7B%0A%20%20%20%20emptyShadowTexture.compareFunction%20%3D%20LessEqualCompare%3B%0A%20%20%20%20emptyTexture2D%20%3D%20emptyShadowTexture%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20emptyTexture2D%20%3D%20emptyTexture%3B%0A%20%20%7D%0A%20%20textures.setTexture2D%28v%20%7C%7C%20emptyTexture2D%2C%20unit%29%3B%0A%7D%0Afunction%20setValueT3D1%28gl%2C%20v%2C%20textures%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20unit%20%3D%20textures.allocateTextureUnit%28%29%3B%0A%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20unit%29%20%7B%0A%20%20%20%20gl.uniform1i%28this.addr%2C%20unit%29%3B%0A%20%20%20%20cache2%5B0%5D%20%3D%20unit%3B%0A%20%20%7D%0A%20%20textures.setTexture3D%28v%20%7C%7C%20empty3dTexture%2C%20unit%29%3B%0A%7D%0Afunction%20setValueT6%28gl%2C%20v%2C%20textures%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20unit%20%3D%20textures.allocateTextureUnit%28%29%3B%0A%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20unit%29%20%7B%0A%20%20%20%20gl.uniform1i%28this.addr%2C%20unit%29%3B%0A%20%20%20%20cache2%5B0%5D%20%3D%20unit%3B%0A%20%20%7D%0A%20%20textures.setTextureCube%28v%20%7C%7C%20emptyCubeTexture%2C%20unit%29%3B%0A%7D%0Afunction%20setValueT2DArray1%28gl%2C%20v%2C%20textures%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20unit%20%3D%20textures.allocateTextureUnit%28%29%3B%0A%20%20if%20%28cache2%5B0%5D%20%21%3D%3D%20unit%29%20%7B%0A%20%20%20%20gl.uniform1i%28this.addr%2C%20unit%29%3B%0A%20%20%20%20cache2%5B0%5D%20%3D%20unit%3B%0A%20%20%7D%0A%20%20textures.setTexture2DArray%28v%20%7C%7C%20emptyArrayTexture%2C%20unit%29%3B%0A%7D%0Afunction%20getSingularSetter%28type%29%20%7B%0A%20%20switch%20%28type%29%20%7B%0A%20%20%20%20case%205126%3A%0A%20%20%20%20%20%20return%20setValueV1f%3B%0A%20%20%20%20%2F%2F%20FLOAT%0A%20%20%20%20case%2035664%3A%0A%20%20%20%20%20%20return%20setValueV2f%3B%0A%20%20%20%20%2F%2F%20_VEC2%0A%20%20%20%20case%2035665%3A%0A%20%20%20%20%20%20return%20setValueV3f%3B%0A%20%20%20%20%2F%2F%20_VEC3%0A%20%20%20%20case%2035666%3A%0A%20%20%20%20%20%20return%20setValueV4f%3B%0A%20%20%20%20%2F%2F%20_VEC4%0A%20%20%20%20case%2035674%3A%0A%20%20%20%20%20%20return%20setValueM2%3B%0A%20%20%20%20%2F%2F%20_MAT2%0A%20%20%20%20case%2035675%3A%0A%20%20%20%20%20%20return%20setValueM3%3B%0A%20%20%20%20%2F%2F%20_MAT3%0A%20%20%20%20case%2035676%3A%0A%20%20%20%20%20%20return%20setValueM4%3B%0A%20%20%20%20%2F%2F%20_MAT4%0A%20%20%20%20case%205124%3A%0A%20%20%20%20case%2035670%3A%0A%20%20%20%20%20%20return%20setValueV1i%3B%0A%20%20%20%20%2F%2F%20INT%2C%20BOOL%0A%20%20%20%20case%2035667%3A%0A%20%20%20%20case%2035671%3A%0A%20%20%20%20%20%20return%20setValueV2i%3B%0A%20%20%20%20%2F%2F%20_VEC2%0A%20%20%20%20case%2035668%3A%0A%20%20%20%20case%2035672%3A%0A%20%20%20%20%20%20return%20setValueV3i%3B%0A%20%20%20%20%2F%2F%20_VEC3%0A%20%20%20%20case%2035669%3A%0A%20%20%20%20case%2035673%3A%0A%20%20%20%20%20%20return%20setValueV4i%3B%0A%20%20%20%20%2F%2F%20_VEC4%0A%20%20%20%20case%205125%3A%0A%20%20%20%20%20%20return%20setValueV1ui%3B%0A%20%20%20%20%2F%2F%20UINT%0A%20%20%20%20case%2036294%3A%0A%20%20%20%20%20%20return%20setValueV2ui%3B%0A%20%20%20%20%2F%2F%20_VEC2%0A%20%20%20%20case%2036295%3A%0A%20%20%20%20%20%20return%20setValueV3ui%3B%0A%20%20%20%20%2F%2F%20_VEC3%0A%20%20%20%20case%2036296%3A%0A%20%20%20%20%20%20return%20setValueV4ui%3B%0A%20%20%20%20%2F%2F%20_VEC4%0A%20%20%20%20case%2035678%3A%0A%20%20%20%20%2F%2F%20SAMPLER_2D%0A%20%20%20%20case%2036198%3A%0A%20%20%20%20%2F%2F%20SAMPLER_EXTERNAL_OES%0A%20%20%20%20case%2036298%3A%0A%20%20%20%20%2F%2F%20INT_SAMPLER_2D%0A%20%20%20%20case%2036306%3A%0A%20%20%20%20%2F%2F%20UNSIGNED_INT_SAMPLER_2D%0A%20%20%20%20case%2035682%3A%0A%20%20%20%20%20%20return%20setValueT1%3B%0A%20%20%20%20case%2035679%3A%0A%20%20%20%20%2F%2F%20SAMPLER_3D%0A%20%20%20%20case%2036299%3A%0A%20%20%20%20%2F%2F%20INT_SAMPLER_3D%0A%20%20%20%20case%2036307%3A%0A%20%20%20%20%20%20return%20setValueT3D1%3B%0A%20%20%20%20case%2035680%3A%0A%20%20%20%20%2F%2F%20SAMPLER_CUBE%0A%20%20%20%20case%2036300%3A%0A%20%20%20%20%2F%2F%20INT_SAMPLER_CUBE%0A%20%20%20%20case%2036308%3A%0A%20%20%20%20%2F%2F%20UNSIGNED_INT_SAMPLER_CUBE%0A%20%20%20%20case%2036293%3A%0A%20%20%20%20%20%20return%20setValueT6%3B%0A%20%20%20%20case%2036289%3A%0A%20%20%20%20%2F%2F%20SAMPLER_2D_ARRAY%0A%20%20%20%20case%2036303%3A%0A%20%20%20%20%2F%2F%20INT_SAMPLER_2D_ARRAY%0A%20%20%20%20case%2036311%3A%0A%20%20%20%20%2F%2F%20UNSIGNED_INT_SAMPLER_2D_ARRAY%0A%20%20%20%20case%2036292%3A%0A%20%20%20%20%20%20return%20setValueT2DArray1%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueV1fArray%28gl%2C%20v%29%20%7B%0A%20%20gl.uniform1fv%28this.addr%2C%20v%29%3B%0A%7D%0Afunction%20setValueV2fArray%28gl%2C%20v%29%20%7B%0A%20%20const%20data%20%3D%20flatten%28v%2C%20this.size%2C%202%29%3B%0A%20%20gl.uniform2fv%28this.addr%2C%20data%29%3B%0A%7D%0Afunction%20setValueV3fArray%28gl%2C%20v%29%20%7B%0A%20%20const%20data%20%3D%20flatten%28v%2C%20this.size%2C%203%29%3B%0A%20%20gl.uniform3fv%28this.addr%2C%20data%29%3B%0A%7D%0Afunction%20setValueV4fArray%28gl%2C%20v%29%20%7B%0A%20%20const%20data%20%3D%20flatten%28v%2C%20this.size%2C%204%29%3B%0A%20%20gl.uniform4fv%28this.addr%2C%20data%29%3B%0A%7D%0Afunction%20setValueM2Array%28gl%2C%20v%29%20%7B%0A%20%20const%20data%20%3D%20flatten%28v%2C%20this.size%2C%204%29%3B%0A%20%20gl.uniformMatrix2fv%28this.addr%2C%20false%2C%20data%29%3B%0A%7D%0Afunction%20setValueM3Array%28gl%2C%20v%29%20%7B%0A%20%20const%20data%20%3D%20flatten%28v%2C%20this.size%2C%209%29%3B%0A%20%20gl.uniformMatrix3fv%28this.addr%2C%20false%2C%20data%29%3B%0A%7D%0Afunction%20setValueM4Array%28gl%2C%20v%29%20%7B%0A%20%20const%20data%20%3D%20flatten%28v%2C%20this.size%2C%2016%29%3B%0A%20%20gl.uniformMatrix4fv%28this.addr%2C%20false%2C%20data%29%3B%0A%7D%0Afunction%20setValueV1iArray%28gl%2C%20v%29%20%7B%0A%20%20gl.uniform1iv%28this.addr%2C%20v%29%3B%0A%7D%0Afunction%20setValueV2iArray%28gl%2C%20v%29%20%7B%0A%20%20gl.uniform2iv%28this.addr%2C%20v%29%3B%0A%7D%0Afunction%20setValueV3iArray%28gl%2C%20v%29%20%7B%0A%20%20gl.uniform3iv%28this.addr%2C%20v%29%3B%0A%7D%0Afunction%20setValueV4iArray%28gl%2C%20v%29%20%7B%0A%20%20gl.uniform4iv%28this.addr%2C%20v%29%3B%0A%7D%0Afunction%20setValueV1uiArray%28gl%2C%20v%29%20%7B%0A%20%20gl.uniform1uiv%28this.addr%2C%20v%29%3B%0A%7D%0Afunction%20setValueV2uiArray%28gl%2C%20v%29%20%7B%0A%20%20gl.uniform2uiv%28this.addr%2C%20v%29%3B%0A%7D%0Afunction%20setValueV3uiArray%28gl%2C%20v%29%20%7B%0A%20%20gl.uniform3uiv%28this.addr%2C%20v%29%3B%0A%7D%0Afunction%20setValueV4uiArray%28gl%2C%20v%29%20%7B%0A%20%20gl.uniform4uiv%28this.addr%2C%20v%29%3B%0A%7D%0Afunction%20setValueT1Array%28gl%2C%20v%2C%20textures%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20n%20%3D%20v.length%3B%0A%20%20const%20units%20%3D%20allocTexUnits%28textures%2C%20n%29%3B%0A%20%20if%20%28%21arraysEqual%28cache2%2C%20units%29%29%20%7B%0A%20%20%20%20gl.uniform1iv%28this.addr%2C%20units%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20units%29%3B%0A%20%20%7D%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20textures.setTexture2D%28v%5Bi%5D%20%7C%7C%20emptyTexture%2C%20units%5Bi%5D%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueT3DArray%28gl%2C%20v%2C%20textures%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20n%20%3D%20v.length%3B%0A%20%20const%20units%20%3D%20allocTexUnits%28textures%2C%20n%29%3B%0A%20%20if%20%28%21arraysEqual%28cache2%2C%20units%29%29%20%7B%0A%20%20%20%20gl.uniform1iv%28this.addr%2C%20units%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20units%29%3B%0A%20%20%7D%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20textures.setTexture3D%28v%5Bi%5D%20%7C%7C%20empty3dTexture%2C%20units%5Bi%5D%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueT6Array%28gl%2C%20v%2C%20textures%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20n%20%3D%20v.length%3B%0A%20%20const%20units%20%3D%20allocTexUnits%28textures%2C%20n%29%3B%0A%20%20if%20%28%21arraysEqual%28cache2%2C%20units%29%29%20%7B%0A%20%20%20%20gl.uniform1iv%28this.addr%2C%20units%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20units%29%3B%0A%20%20%7D%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20textures.setTextureCube%28v%5Bi%5D%20%7C%7C%20emptyCubeTexture%2C%20units%5Bi%5D%29%3B%0A%20%20%7D%0A%7D%0Afunction%20setValueT2DArrayArray%28gl%2C%20v%2C%20textures%29%20%7B%0A%20%20const%20cache2%20%3D%20this.cache%3B%0A%20%20const%20n%20%3D%20v.length%3B%0A%20%20const%20units%20%3D%20allocTexUnits%28textures%2C%20n%29%3B%0A%20%20if%20%28%21arraysEqual%28cache2%2C%20units%29%29%20%7B%0A%20%20%20%20gl.uniform1iv%28this.addr%2C%20units%29%3B%0A%20%20%20%20copyArray%28cache2%2C%20units%29%3B%0A%20%20%7D%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20textures.setTexture2DArray%28v%5Bi%5D%20%7C%7C%20emptyArrayTexture%2C%20units%5Bi%5D%29%3B%0A%20%20%7D%0A%7D%0Afunction%20getPureArraySetter%28type%29%20%7B%0A%20%20switch%20%28type%29%20%7B%0A%20%20%20%20case%205126%3A%0A%20%20%20%20%20%20return%20setValueV1fArray%3B%0A%20%20%20%20%2F%2F%20FLOAT%0A%20%20%20%20case%2035664%3A%0A%20%20%20%20%20%20return%20setValueV2fArray%3B%0A%20%20%20%20%2F%2F%20_VEC2%0A%20%20%20%20case%2035665%3A%0A%20%20%20%20%20%20return%20setValueV3fArray%3B%0A%20%20%20%20%2F%2F%20_VEC3%0A%20%20%20%20case%2035666%3A%0A%20%20%20%20%20%20return%20setValueV4fArray%3B%0A%20%20%20%20%2F%2F%20_VEC4%0A%20%20%20%20case%2035674%3A%0A%20%20%20%20%20%20return%20setValueM2Array%3B%0A%20%20%20%20%2F%2F%20_MAT2%0A%20%20%20%20case%2035675%3A%0A%20%20%20%20%20%20return%20setValueM3Array%3B%0A%20%20%20%20%2F%2F%20_MAT3%0A%20%20%20%20case%2035676%3A%0A%20%20%20%20%20%20return%20setValueM4Array%3B%0A%20%20%20%20%2F%2F%20_MAT4%0A%20%20%20%20case%205124%3A%0A%20%20%20%20case%2035670%3A%0A%20%20%20%20%20%20return%20setValueV1iArray%3B%0A%20%20%20%20%2F%2F%20INT%2C%20BOOL%0A%20%20%20%20case%2035667%3A%0A%20%20%20%20case%2035671%3A%0A%20%20%20%20%20%20return%20setValueV2iArray%3B%0A%20%20%20%20%2F%2F%20_VEC2%0A%20%20%20%20case%2035668%3A%0A%20%20%20%20case%2035672%3A%0A%20%20%20%20%20%20return%20setValueV3iArray%3B%0A%20%20%20%20%2F%2F%20_VEC3%0A%20%20%20%20case%2035669%3A%0A%20%20%20%20case%2035673%3A%0A%20%20%20%20%20%20return%20setValueV4iArray%3B%0A%20%20%20%20%2F%2F%20_VEC4%0A%20%20%20%20case%205125%3A%0A%20%20%20%20%20%20return%20setValueV1uiArray%3B%0A%20%20%20%20%2F%2F%20UINT%0A%20%20%20%20case%2036294%3A%0A%20%20%20%20%20%20return%20setValueV2uiArray%3B%0A%20%20%20%20%2F%2F%20_VEC2%0A%20%20%20%20case%2036295%3A%0A%20%20%20%20%20%20return%20setValueV3uiArray%3B%0A%20%20%20%20%2F%2F%20_VEC3%0A%20%20%20%20case%2036296%3A%0A%20%20%20%20%20%20return%20setValueV4uiArray%3B%0A%20%20%20%20%2F%2F%20_VEC4%0A%20%20%20%20case%2035678%3A%0A%20%20%20%20%2F%2F%20SAMPLER_2D%0A%20%20%20%20case%2036198%3A%0A%20%20%20%20%2F%2F%20SAMPLER_EXTERNAL_OES%0A%20%20%20%20case%2036298%3A%0A%20%20%20%20%2F%2F%20INT_SAMPLER_2D%0A%20%20%20%20case%2036306%3A%0A%20%20%20%20%2F%2F%20UNSIGNED_INT_SAMPLER_2D%0A%20%20%20%20case%2035682%3A%0A%20%20%20%20%20%20return%20setValueT1Array%3B%0A%20%20%20%20case%2035679%3A%0A%20%20%20%20%2F%2F%20SAMPLER_3D%0A%20%20%20%20case%2036299%3A%0A%20%20%20%20%2F%2F%20INT_SAMPLER_3D%0A%20%20%20%20case%2036307%3A%0A%20%20%20%20%20%20return%20setValueT3DArray%3B%0A%20%20%20%20case%2035680%3A%0A%20%20%20%20%2F%2F%20SAMPLER_CUBE%0A%20%20%20%20case%2036300%3A%0A%20%20%20%20%2F%2F%20INT_SAMPLER_CUBE%0A%20%20%20%20case%2036308%3A%0A%20%20%20%20%2F%2F%20UNSIGNED_INT_SAMPLER_CUBE%0A%20%20%20%20case%2036293%3A%0A%20%20%20%20%20%20return%20setValueT6Array%3B%0A%20%20%20%20case%2036289%3A%0A%20%20%20%20%2F%2F%20SAMPLER_2D_ARRAY%0A%20%20%20%20case%2036303%3A%0A%20%20%20%20%2F%2F%20INT_SAMPLER_2D_ARRAY%0A%20%20%20%20case%2036311%3A%0A%20%20%20%20%2F%2F%20UNSIGNED_INT_SAMPLER_2D_ARRAY%0A%20%20%20%20case%2036292%3A%0A%20%20%20%20%20%20return%20setValueT2DArrayArray%3B%0A%20%20%7D%0A%7D%0Avar%20SingleUniform%20%3D%20class%20%7B%0A%20%20constructor%28id2%2C%20activeInfo%2C%20addr%29%20%7B%0A%20%20%20%20this.id%20%3D%20id2%3B%0A%20%20%20%20this.addr%20%3D%20addr%3B%0A%20%20%20%20this.cache%20%3D%20%5B%5D%3B%0A%20%20%20%20this.type%20%3D%20activeInfo.type%3B%0A%20%20%20%20this.setValue%20%3D%20getSingularSetter%28activeInfo.type%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20PureArrayUniform%20%3D%20class%20%7B%0A%20%20constructor%28id2%2C%20activeInfo%2C%20addr%29%20%7B%0A%20%20%20%20this.id%20%3D%20id2%3B%0A%20%20%20%20this.addr%20%3D%20addr%3B%0A%20%20%20%20this.cache%20%3D%20%5B%5D%3B%0A%20%20%20%20this.type%20%3D%20activeInfo.type%3B%0A%20%20%20%20this.size%20%3D%20activeInfo.size%3B%0A%20%20%20%20this.setValue%20%3D%20getPureArraySetter%28activeInfo.type%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20StructuredUniform%20%3D%20class%20%7B%0A%20%20constructor%28id2%29%20%7B%0A%20%20%20%20this.id%20%3D%20id2%3B%0A%20%20%20%20this.seq%20%3D%20%5B%5D%3B%0A%20%20%20%20this.map%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20setValue%28gl%2C%20value%2C%20textures%29%20%7B%0A%20%20%20%20const%20seq%20%3D%20this.seq%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20seq.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20u%20%3D%20seq%5Bi%5D%3B%0A%20%20%20%20%20%20u.setValue%28gl%2C%20value%5Bu.id%5D%2C%20textures%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20RePathPart%20%3D%20%2F%28%5Cw%2B%29%28%5C%5D%29%3F%28%5C%5B%7C%5C.%29%3F%2Fg%3B%0Afunction%20addUniform%28container%2C%20uniformObject%29%20%7B%0A%20%20container.seq.push%28uniformObject%29%3B%0A%20%20container.map%5BuniformObject.id%5D%20%3D%20uniformObject%3B%0A%7D%0Afunction%20parseUniform%28activeInfo%2C%20addr%2C%20container%29%20%7B%0A%20%20const%20path%20%3D%20activeInfo.name%2C%20pathLength%20%3D%20path.length%3B%0A%20%20RePathPart.lastIndex%20%3D%200%3B%0A%20%20while%20%28true%29%20%7B%0A%20%20%20%20const%20match%20%3D%20RePathPart.exec%28path%29%2C%20matchEnd%20%3D%20RePathPart.lastIndex%3B%0A%20%20%20%20let%20id2%20%3D%20match%5B1%5D%3B%0A%20%20%20%20const%20idIsIndex%20%3D%20match%5B2%5D%20%3D%3D%3D%20%22%5D%22%2C%20subscript%20%3D%20match%5B3%5D%3B%0A%20%20%20%20if%20%28idIsIndex%29%20id2%20%3D%20id2%20%7C%200%3B%0A%20%20%20%20if%20%28subscript%20%3D%3D%3D%20void%200%20%7C%7C%20subscript%20%3D%3D%3D%20%22%5B%22%20%26%26%20matchEnd%20%2B%202%20%3D%3D%3D%20pathLength%29%20%7B%0A%20%20%20%20%20%20addUniform%28container%2C%20subscript%20%3D%3D%3D%20void%200%20%3F%20new%20SingleUniform%28id2%2C%20activeInfo%2C%20addr%29%20%3A%20new%20PureArrayUniform%28id2%2C%20activeInfo%2C%20addr%29%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20map%20%3D%20container.map%3B%0A%20%20%20%20%20%20let%20next%20%3D%20map%5Bid2%5D%3B%0A%20%20%20%20%20%20if%20%28next%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20next%20%3D%20new%20StructuredUniform%28id2%29%3B%0A%20%20%20%20%20%20%20%20addUniform%28container%2C%20next%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20container%20%3D%20next%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Avar%20WebGLUniforms%20%3D%20class%20%7B%0A%20%20constructor%28gl%2C%20program%29%20%7B%0A%20%20%20%20this.seq%20%3D%20%5B%5D%3B%0A%20%20%20%20this.map%20%3D%20%7B%7D%3B%0A%20%20%20%20const%20n%20%3D%20gl.getProgramParameter%28program%2C%20gl.ACTIVE_UNIFORMS%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20info%20%3D%20gl.getActiveUniform%28program%2C%20i%29%2C%20addr%20%3D%20gl.getUniformLocation%28program%2C%20info.name%29%3B%0A%20%20%20%20%20%20parseUniform%28info%2C%20addr%2C%20this%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setValue%28gl%2C%20name%2C%20value%2C%20textures%29%20%7B%0A%20%20%20%20const%20u%20%3D%20this.map%5Bname%5D%3B%0A%20%20%20%20if%20%28u%20%21%3D%3D%20void%200%29%20u.setValue%28gl%2C%20value%2C%20textures%29%3B%0A%20%20%7D%0A%20%20setOptional%28gl%2C%20object%2C%20name%29%20%7B%0A%20%20%20%20const%20v%20%3D%20object%5Bname%5D%3B%0A%20%20%20%20if%20%28v%20%21%3D%3D%20void%200%29%20this.setValue%28gl%2C%20name%2C%20v%29%3B%0A%20%20%7D%0A%20%20static%20upload%28gl%2C%20seq%2C%20values%2C%20textures%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20seq.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20u%20%3D%20seq%5Bi%5D%2C%20v%20%3D%20values%5Bu.id%5D%3B%0A%20%20%20%20%20%20if%20%28v.needsUpdate%20%21%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20u.setValue%28gl%2C%20v.value%2C%20textures%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20static%20seqWithValue%28seq%2C%20values%29%20%7B%0A%20%20%20%20const%20r%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20seq.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20u%20%3D%20seq%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28u.id%20in%20values%29%20r.push%28u%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20r%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20WebGLShader%28gl%2C%20type%2C%20string%29%20%7B%0A%20%20const%20shader%20%3D%20gl.createShader%28type%29%3B%0A%20%20gl.shaderSource%28shader%2C%20string%29%3B%0A%20%20gl.compileShader%28shader%29%3B%0A%20%20return%20shader%3B%0A%7D%0Avar%20COMPLETION_STATUS_KHR%20%3D%2037297%3B%0Avar%20programIdCount%20%3D%200%3B%0Afunction%20handleSource%28string%2C%20errorLine%29%20%7B%0A%20%20const%20lines%20%3D%20string.split%28%22%5Cn%22%29%3B%0A%20%20const%20lines2%20%3D%20%5B%5D%3B%0A%20%20const%20from%20%3D%20Math.max%28errorLine%20-%206%2C%200%29%3B%0A%20%20const%20to%20%3D%20Math.min%28errorLine%20%2B%206%2C%20lines.length%29%3B%0A%20%20for%20%28let%20i%20%3D%20from%3B%20i%20%3C%20to%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20const%20line%20%3D%20i%20%2B%201%3B%0A%20%20%20%20lines2.push%28%60%24%7Bline%20%3D%3D%3D%20errorLine%20%3F%20%22%3E%22%20%3A%20%22%20%22%7D%20%24%7Bline%7D%3A%20%24%7Blines%5Bi%5D%7D%60%29%3B%0A%20%20%7D%0A%20%20return%20lines2.join%28%22%5Cn%22%29%3B%0A%7D%0Avar%20_m0%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix3%28%29%3B%0Afunction%20getEncodingComponents%28colorSpace%29%20%7B%0A%20%20ColorManagement._getMatrix%28_m0%2C%20ColorManagement.workingColorSpace%2C%20colorSpace%29%3B%0A%20%20const%20encodingMatrix%20%3D%20%60mat3%28%20%24%7B_m0.elements.map%28%28v%29%20%3D%3E%20v.toFixed%284%29%29%7D%20%29%60%3B%0A%20%20switch%20%28ColorManagement.getTransfer%28colorSpace%29%29%20%7B%0A%20%20%20%20case%20LinearTransfer%3A%0A%20%20%20%20%20%20return%20%5BencodingMatrix%2C%20%22LinearTransferOETF%22%5D%3B%0A%20%20%20%20case%20SRGBTransfer%3A%0A%20%20%20%20%20%20return%20%5BencodingMatrix%2C%20%22sRGBTransferOETF%22%5D%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20console.warn%28%22THREE.WebGLProgram%3A%20Unsupported%20color%20space%3A%20%22%2C%20colorSpace%29%3B%0A%20%20%20%20%20%20return%20%5BencodingMatrix%2C%20%22LinearTransferOETF%22%5D%3B%0A%20%20%7D%0A%7D%0Afunction%20getShaderErrors%28gl%2C%20shader%2C%20type%29%20%7B%0A%20%20const%20status%20%3D%20gl.getShaderParameter%28shader%2C%20gl.COMPILE_STATUS%29%3B%0A%20%20const%20errors%20%3D%20gl.getShaderInfoLog%28shader%29.trim%28%29%3B%0A%20%20if%20%28status%20%26%26%20errors%20%3D%3D%3D%20%22%22%29%20return%20%22%22%3B%0A%20%20const%20errorMatches%20%3D%20%2FERROR%3A%200%3A%28%5Cd%2B%29%2F.exec%28errors%29%3B%0A%20%20if%20%28errorMatches%29%20%7B%0A%20%20%20%20const%20errorLine%20%3D%20parseInt%28errorMatches%5B1%5D%29%3B%0A%20%20%20%20return%20type.toUpperCase%28%29%20%2B%20%22%5Cn%5Cn%22%20%2B%20errors%20%2B%20%22%5Cn%5Cn%22%20%2B%20handleSource%28gl.getShaderSource%28shader%29%2C%20errorLine%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20errors%3B%0A%20%20%7D%0A%7D%0Afunction%20getTexelEncodingFunction%28functionName%2C%20colorSpace%29%20%7B%0A%20%20const%20components%20%3D%20getEncodingComponents%28colorSpace%29%3B%0A%20%20return%20%5B%0A%20%20%20%20%60vec4%20%24%7BfunctionName%7D%28%20vec4%20value%20%29%20%7B%60%2C%0A%20%20%20%20%60%09return%20%24%7Bcomponents%5B1%5D%7D%28%20vec4%28%20value.rgb%20%2A%20%24%7Bcomponents%5B0%5D%7D%2C%20value.a%20%29%20%29%3B%60%2C%0A%20%20%20%20%22%7D%22%0A%20%20%5D.join%28%22%5Cn%22%29%3B%0A%7D%0Afunction%20getToneMappingFunction%28functionName%2C%20toneMapping2%29%20%7B%0A%20%20let%20toneMappingName%3B%0A%20%20switch%20%28toneMapping2%29%20%7B%0A%20%20%20%20case%20LinearToneMapping%3A%0A%20%20%20%20%20%20toneMappingName%20%3D%20%22Linear%22%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20ReinhardToneMapping%3A%0A%20%20%20%20%20%20toneMappingName%20%3D%20%22Reinhard%22%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20CineonToneMapping%3A%0A%20%20%20%20%20%20toneMappingName%20%3D%20%22Cineon%22%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20ACESFilmicToneMapping%3A%0A%20%20%20%20%20%20toneMappingName%20%3D%20%22ACESFilmic%22%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20AgXToneMapping%3A%0A%20%20%20%20%20%20toneMappingName%20%3D%20%22AgX%22%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20NeutralToneMapping%3A%0A%20%20%20%20%20%20toneMappingName%20%3D%20%22Neutral%22%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20CustomToneMapping%3A%0A%20%20%20%20%20%20toneMappingName%20%3D%20%22Custom%22%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20console.warn%28%22THREE.WebGLProgram%3A%20Unsupported%20toneMapping%3A%22%2C%20toneMapping2%29%3B%0A%20%20%20%20%20%20toneMappingName%20%3D%20%22Linear%22%3B%0A%20%20%7D%0A%20%20return%20%22vec3%20%22%20%2B%20functionName%20%2B%20%22%28%20vec3%20color%20%29%20%7B%20return%20%22%20%2B%20toneMappingName%20%2B%20%22ToneMapping%28%20color%20%29%3B%20%7D%22%3B%0A%7D%0Avar%20_v0%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Afunction%20getLuminanceFunction%28%29%20%7B%0A%20%20ColorManagement.getLuminanceCoefficients%28_v0%241%29%3B%0A%20%20const%20r%20%3D%20_v0%241.x.toFixed%284%29%3B%0A%20%20const%20g%20%3D%20_v0%241.y.toFixed%284%29%3B%0A%20%20const%20b%20%3D%20_v0%241.z.toFixed%284%29%3B%0A%20%20return%20%5B%0A%20%20%20%20%22float%20luminance%28%20const%20in%20vec3%20rgb%20%29%20%7B%22%2C%0A%20%20%20%20%60%09const%20vec3%20weights%20%3D%20vec3%28%20%24%7Br%7D%2C%20%24%7Bg%7D%2C%20%24%7Bb%7D%20%29%3B%60%2C%0A%20%20%20%20%22%09return%20dot%28%20weights%2C%20rgb%20%29%3B%22%2C%0A%20%20%20%20%22%7D%22%0A%20%20%5D.join%28%22%5Cn%22%29%3B%0A%7D%0Afunction%20generateVertexExtensions%28parameters%29%20%7B%0A%20%20const%20chunks%20%3D%20%5B%0A%20%20%20%20parameters.extensionClipCullDistance%20%3F%20%22%23extension%20GL_ANGLE_clip_cull_distance%20%3A%20require%22%20%3A%20%22%22%2C%0A%20%20%20%20parameters.extensionMultiDraw%20%3F%20%22%23extension%20GL_ANGLE_multi_draw%20%3A%20require%22%20%3A%20%22%22%0A%20%20%5D%3B%0A%20%20return%20chunks.filter%28filterEmptyLine%29.join%28%22%5Cn%22%29%3B%0A%7D%0Afunction%20generateDefines%28defines%29%20%7B%0A%20%20const%20chunks%20%3D%20%5B%5D%3B%0A%20%20for%20%28const%20name%20in%20defines%29%20%7B%0A%20%20%20%20const%20value%20%3D%20defines%5Bname%5D%3B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20false%29%20continue%3B%0A%20%20%20%20chunks.push%28%22%23define%20%22%20%2B%20name%20%2B%20%22%20%22%20%2B%20value%29%3B%0A%20%20%7D%0A%20%20return%20chunks.join%28%22%5Cn%22%29%3B%0A%7D%0Afunction%20fetchAttributeLocations%28gl%2C%20program%29%20%7B%0A%20%20const%20attributes%20%3D%20%7B%7D%3B%0A%20%20const%20n%20%3D%20gl.getProgramParameter%28program%2C%20gl.ACTIVE_ATTRIBUTES%29%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20n%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20const%20info%20%3D%20gl.getActiveAttrib%28program%2C%20i%29%3B%0A%20%20%20%20const%20name%20%3D%20info.name%3B%0A%20%20%20%20let%20locationSize%20%3D%201%3B%0A%20%20%20%20if%20%28info.type%20%3D%3D%3D%20gl.FLOAT_MAT2%29%20locationSize%20%3D%202%3B%0A%20%20%20%20if%20%28info.type%20%3D%3D%3D%20gl.FLOAT_MAT3%29%20locationSize%20%3D%203%3B%0A%20%20%20%20if%20%28info.type%20%3D%3D%3D%20gl.FLOAT_MAT4%29%20locationSize%20%3D%204%3B%0A%20%20%20%20attributes%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20type%3A%20info.type%2C%0A%20%20%20%20%20%20location%3A%20gl.getAttribLocation%28program%2C%20name%29%2C%0A%20%20%20%20%20%20locationSize%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20return%20attributes%3B%0A%7D%0Afunction%20filterEmptyLine%28string%29%20%7B%0A%20%20return%20string%20%21%3D%3D%20%22%22%3B%0A%7D%0Afunction%20replaceLightNums%28string%2C%20parameters%29%20%7B%0A%20%20const%20numSpotLightCoords%20%3D%20parameters.numSpotLightShadows%20%2B%20parameters.numSpotLightMaps%20-%20parameters.numSpotLightShadowsWithMaps%3B%0A%20%20return%20string.replace%28%2FNUM_DIR_LIGHTS%2Fg%2C%20parameters.numDirLights%29.replace%28%2FNUM_SPOT_LIGHTS%2Fg%2C%20parameters.numSpotLights%29.replace%28%2FNUM_SPOT_LIGHT_MAPS%2Fg%2C%20parameters.numSpotLightMaps%29.replace%28%2FNUM_SPOT_LIGHT_COORDS%2Fg%2C%20numSpotLightCoords%29.replace%28%2FNUM_RECT_AREA_LIGHTS%2Fg%2C%20parameters.numRectAreaLights%29.replace%28%2FNUM_POINT_LIGHTS%2Fg%2C%20parameters.numPointLights%29.replace%28%2FNUM_HEMI_LIGHTS%2Fg%2C%20parameters.numHemiLights%29.replace%28%2FNUM_DIR_LIGHT_SHADOWS%2Fg%2C%20parameters.numDirLightShadows%29.replace%28%2FNUM_SPOT_LIGHT_SHADOWS_WITH_MAPS%2Fg%2C%20parameters.numSpotLightShadowsWithMaps%29.replace%28%2FNUM_SPOT_LIGHT_SHADOWS%2Fg%2C%20parameters.numSpotLightShadows%29.replace%28%2FNUM_POINT_LIGHT_SHADOWS%2Fg%2C%20parameters.numPointLightShadows%29%3B%0A%7D%0Afunction%20replaceClippingPlaneNums%28string%2C%20parameters%29%20%7B%0A%20%20return%20string.replace%28%2FNUM_CLIPPING_PLANES%2Fg%2C%20parameters.numClippingPlanes%29.replace%28%2FUNION_CLIPPING_PLANES%2Fg%2C%20parameters.numClippingPlanes%20-%20parameters.numClipIntersection%29%3B%0A%7D%0Avar%20includePattern%20%3D%20%2F%5E%5B%20%5Ct%5D%2A%23include%20%2B%3C%28%5B%5Cw%5Cd.%2F%5D%2B%29%3E%2Fgm%3B%0Afunction%20resolveIncludes%28string%29%20%7B%0A%20%20return%20string.replace%28includePattern%2C%20includeReplacer%29%3B%0A%7D%0Avar%20shaderChunkMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0Afunction%20includeReplacer%28match%2C%20include%29%20%7B%0A%20%20let%20string%20%3D%20ShaderChunk%5Binclude%5D%3B%0A%20%20if%20%28string%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20const%20newInclude%20%3D%20shaderChunkMap.get%28include%29%3B%0A%20%20%20%20if%20%28newInclude%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20string%20%3D%20ShaderChunk%5BnewInclude%5D%3B%0A%20%20%20%20%20%20console.warn%28%27THREE.WebGLRenderer%3A%20Shader%20chunk%20%22%25s%22%20has%20been%20deprecated.%20Use%20%22%25s%22%20instead.%27%2C%20include%2C%20newInclude%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22Can%20not%20resolve%20%23include%20%3C%22%20%2B%20include%20%2B%20%22%3E%22%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20resolveIncludes%28string%29%3B%0A%7D%0Avar%20unrollLoopPattern%20%3D%20%2F%23pragma%20unroll_loop_start%5Cs%2Bfor%5Cs%2A%5C%28%5Cs%2Aint%5Cs%2Bi%5Cs%2A%3D%5Cs%2A%28%5Cd%2B%29%5Cs%2A%3B%5Cs%2Ai%5Cs%2A%3C%5Cs%2A%28%5Cd%2B%29%5Cs%2A%3B%5Cs%2Ai%5Cs%2A%5C%2B%5C%2B%5Cs%2A%5C%29%5Cs%2A%7B%28%5B%5Cs%5CS%5D%2B%3F%29%7D%5Cs%2B%23pragma%20unroll_loop_end%2Fg%3B%0Afunction%20unrollLoops%28string%29%20%7B%0A%20%20return%20string.replace%28unrollLoopPattern%2C%20loopReplacer%29%3B%0A%7D%0Afunction%20loopReplacer%28match%2C%20start%2C%20end%2C%20snippet%29%20%7B%0A%20%20let%20string%20%3D%20%22%22%3B%0A%20%20for%20%28let%20i%20%3D%20parseInt%28start%29%3B%20i%20%3C%20parseInt%28end%29%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20string%20%2B%3D%20snippet.replace%28%2F%5C%5B%5Cs%2Ai%5Cs%2A%5C%5D%2Fg%2C%20%22%5B%20%22%20%2B%20i%20%2B%20%22%20%5D%22%29.replace%28%2FUNROLLED_LOOP_INDEX%2Fg%2C%20i%29%3B%0A%20%20%7D%0A%20%20return%20string%3B%0A%7D%0Afunction%20generatePrecision%28parameters%29%20%7B%0A%20%20let%20precisionstring%20%3D%20%60precision%20%24%7Bparameters.precision%7D%20float%3B%0A%09precision%20%24%7Bparameters.precision%7D%20int%3B%0A%09precision%20%24%7Bparameters.precision%7D%20sampler2D%3B%0A%09precision%20%24%7Bparameters.precision%7D%20samplerCube%3B%0A%09precision%20%24%7Bparameters.precision%7D%20sampler3D%3B%0A%09precision%20%24%7Bparameters.precision%7D%20sampler2DArray%3B%0A%09precision%20%24%7Bparameters.precision%7D%20sampler2DShadow%3B%0A%09precision%20%24%7Bparameters.precision%7D%20samplerCubeShadow%3B%0A%09precision%20%24%7Bparameters.precision%7D%20sampler2DArrayShadow%3B%0A%09precision%20%24%7Bparameters.precision%7D%20isampler2D%3B%0A%09precision%20%24%7Bparameters.precision%7D%20isampler3D%3B%0A%09precision%20%24%7Bparameters.precision%7D%20isamplerCube%3B%0A%09precision%20%24%7Bparameters.precision%7D%20isampler2DArray%3B%0A%09precision%20%24%7Bparameters.precision%7D%20usampler2D%3B%0A%09precision%20%24%7Bparameters.precision%7D%20usampler3D%3B%0A%09precision%20%24%7Bparameters.precision%7D%20usamplerCube%3B%0A%09precision%20%24%7Bparameters.precision%7D%20usampler2DArray%3B%0A%09%60%3B%0A%20%20if%20%28parameters.precision%20%3D%3D%3D%20%22highp%22%29%20%7B%0A%20%20%20%20precisionstring%20%2B%3D%20%22%5Cn%23define%20HIGH_PRECISION%22%3B%0A%20%20%7D%20else%20if%20%28parameters.precision%20%3D%3D%3D%20%22mediump%22%29%20%7B%0A%20%20%20%20precisionstring%20%2B%3D%20%22%5Cn%23define%20MEDIUM_PRECISION%22%3B%0A%20%20%7D%20else%20if%20%28parameters.precision%20%3D%3D%3D%20%22lowp%22%29%20%7B%0A%20%20%20%20precisionstring%20%2B%3D%20%22%5Cn%23define%20LOW_PRECISION%22%3B%0A%20%20%7D%0A%20%20return%20precisionstring%3B%0A%7D%0Afunction%20generateShadowMapTypeDefine%28parameters%29%20%7B%0A%20%20let%20shadowMapTypeDefine%20%3D%20%22SHADOWMAP_TYPE_BASIC%22%3B%0A%20%20if%20%28parameters.shadowMapType%20%3D%3D%3D%20PCFShadowMap%29%20%7B%0A%20%20%20%20shadowMapTypeDefine%20%3D%20%22SHADOWMAP_TYPE_PCF%22%3B%0A%20%20%7D%20else%20if%20%28parameters.shadowMapType%20%3D%3D%3D%20PCFSoftShadowMap%29%20%7B%0A%20%20%20%20shadowMapTypeDefine%20%3D%20%22SHADOWMAP_TYPE_PCF_SOFT%22%3B%0A%20%20%7D%20else%20if%20%28parameters.shadowMapType%20%3D%3D%3D%20VSMShadowMap%29%20%7B%0A%20%20%20%20shadowMapTypeDefine%20%3D%20%22SHADOWMAP_TYPE_VSM%22%3B%0A%20%20%7D%0A%20%20return%20shadowMapTypeDefine%3B%0A%7D%0Afunction%20generateEnvMapTypeDefine%28parameters%29%20%7B%0A%20%20let%20envMapTypeDefine%20%3D%20%22ENVMAP_TYPE_CUBE%22%3B%0A%20%20if%20%28parameters.envMap%29%20%7B%0A%20%20%20%20switch%20%28parameters.envMapMode%29%20%7B%0A%20%20%20%20%20%20case%20CubeReflectionMapping%3A%0A%20%20%20%20%20%20case%20CubeRefractionMapping%3A%0A%20%20%20%20%20%20%20%20envMapTypeDefine%20%3D%20%22ENVMAP_TYPE_CUBE%22%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20CubeUVReflectionMapping%3A%0A%20%20%20%20%20%20%20%20envMapTypeDefine%20%3D%20%22ENVMAP_TYPE_CUBE_UV%22%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20envMapTypeDefine%3B%0A%7D%0Afunction%20generateEnvMapModeDefine%28parameters%29%20%7B%0A%20%20let%20envMapModeDefine%20%3D%20%22ENVMAP_MODE_REFLECTION%22%3B%0A%20%20if%20%28parameters.envMap%29%20%7B%0A%20%20%20%20switch%20%28parameters.envMapMode%29%20%7B%0A%20%20%20%20%20%20case%20CubeRefractionMapping%3A%0A%20%20%20%20%20%20%20%20envMapModeDefine%20%3D%20%22ENVMAP_MODE_REFRACTION%22%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20envMapModeDefine%3B%0A%7D%0Afunction%20generateEnvMapBlendingDefine%28parameters%29%20%7B%0A%20%20let%20envMapBlendingDefine%20%3D%20%22ENVMAP_BLENDING_NONE%22%3B%0A%20%20if%20%28parameters.envMap%29%20%7B%0A%20%20%20%20switch%20%28parameters.combine%29%20%7B%0A%20%20%20%20%20%20case%20MultiplyOperation%3A%0A%20%20%20%20%20%20%20%20envMapBlendingDefine%20%3D%20%22ENVMAP_BLENDING_MULTIPLY%22%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20MixOperation%3A%0A%20%20%20%20%20%20%20%20envMapBlendingDefine%20%3D%20%22ENVMAP_BLENDING_MIX%22%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20AddOperation%3A%0A%20%20%20%20%20%20%20%20envMapBlendingDefine%20%3D%20%22ENVMAP_BLENDING_ADD%22%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20envMapBlendingDefine%3B%0A%7D%0Afunction%20generateCubeUVSize%28parameters%29%20%7B%0A%20%20const%20imageHeight%20%3D%20parameters.envMapCubeUVHeight%3B%0A%20%20if%20%28imageHeight%20%3D%3D%3D%20null%29%20return%20null%3B%0A%20%20const%20maxMip%20%3D%20Math.log2%28imageHeight%29%20-%202%3B%0A%20%20const%20texelHeight%20%3D%201%20%2F%20imageHeight%3B%0A%20%20const%20texelWidth%20%3D%201%20%2F%20%283%20%2A%20Math.max%28Math.pow%282%2C%20maxMip%29%2C%207%20%2A%2016%29%29%3B%0A%20%20return%20%7B%20texelWidth%2C%20texelHeight%2C%20maxMip%20%7D%3B%0A%7D%0Afunction%20WebGLProgram%28renderer3%2C%20cacheKey%2C%20parameters%2C%20bindingStates%29%20%7B%0A%20%20const%20gl%20%3D%20renderer3.getContext%28%29%3B%0A%20%20const%20defines%20%3D%20parameters.defines%3B%0A%20%20let%20vertexShader%20%3D%20parameters.vertexShader%3B%0A%20%20let%20fragmentShader%20%3D%20parameters.fragmentShader%3B%0A%20%20const%20shadowMapTypeDefine%20%3D%20generateShadowMapTypeDefine%28parameters%29%3B%0A%20%20const%20envMapTypeDefine%20%3D%20generateEnvMapTypeDefine%28parameters%29%3B%0A%20%20const%20envMapModeDefine%20%3D%20generateEnvMapModeDefine%28parameters%29%3B%0A%20%20const%20envMapBlendingDefine%20%3D%20generateEnvMapBlendingDefine%28parameters%29%3B%0A%20%20const%20envMapCubeUVSize%20%3D%20generateCubeUVSize%28parameters%29%3B%0A%20%20const%20customVertexExtensions%20%3D%20generateVertexExtensions%28parameters%29%3B%0A%20%20const%20customDefines%20%3D%20generateDefines%28defines%29%3B%0A%20%20const%20program%20%3D%20gl.createProgram%28%29%3B%0A%20%20let%20prefixVertex%2C%20prefixFragment%3B%0A%20%20let%20versionString%20%3D%20parameters.glslVersion%20%3F%20%22%23version%20%22%20%2B%20parameters.glslVersion%20%2B%20%22%5Cn%22%20%3A%20%22%22%3B%0A%20%20if%20%28parameters.isRawShaderMaterial%29%20%7B%0A%20%20%20%20prefixVertex%20%3D%20%5B%0A%20%20%20%20%20%20%22%23define%20SHADER_TYPE%20%22%20%2B%20parameters.shaderType%2C%0A%20%20%20%20%20%20%22%23define%20SHADER_NAME%20%22%20%2B%20parameters.shaderName%2C%0A%20%20%20%20%20%20customDefines%0A%20%20%20%20%5D.filter%28filterEmptyLine%29.join%28%22%5Cn%22%29%3B%0A%20%20%20%20if%20%28prefixVertex.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20prefixVertex%20%2B%3D%20%22%5Cn%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20prefixFragment%20%3D%20%5B%0A%20%20%20%20%20%20%22%23define%20SHADER_TYPE%20%22%20%2B%20parameters.shaderType%2C%0A%20%20%20%20%20%20%22%23define%20SHADER_NAME%20%22%20%2B%20parameters.shaderName%2C%0A%20%20%20%20%20%20customDefines%0A%20%20%20%20%5D.filter%28filterEmptyLine%29.join%28%22%5Cn%22%29%3B%0A%20%20%20%20if%20%28prefixFragment.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20prefixFragment%20%2B%3D%20%22%5Cn%22%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20prefixVertex%20%3D%20%5B%0A%20%20%20%20%20%20generatePrecision%28parameters%29%2C%0A%20%20%20%20%20%20%22%23define%20SHADER_TYPE%20%22%20%2B%20parameters.shaderType%2C%0A%20%20%20%20%20%20%22%23define%20SHADER_NAME%20%22%20%2B%20parameters.shaderName%2C%0A%20%20%20%20%20%20customDefines%2C%0A%20%20%20%20%20%20parameters.extensionClipCullDistance%20%3F%20%22%23define%20USE_CLIP_DISTANCE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.batching%20%3F%20%22%23define%20USE_BATCHING%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.batchingColor%20%3F%20%22%23define%20USE_BATCHING_COLOR%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.instancing%20%3F%20%22%23define%20USE_INSTANCING%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.instancingColor%20%3F%20%22%23define%20USE_INSTANCING_COLOR%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.instancingMorph%20%3F%20%22%23define%20USE_INSTANCING_MORPH%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.useFog%20%26%26%20parameters.fog%20%3F%20%22%23define%20USE_FOG%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.useFog%20%26%26%20parameters.fogExp2%20%3F%20%22%23define%20FOG_EXP2%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.map%20%3F%20%22%23define%20USE_MAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.envMap%20%3F%20%22%23define%20USE_ENVMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.envMap%20%3F%20%22%23define%20%22%20%2B%20envMapModeDefine%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.lightMap%20%3F%20%22%23define%20USE_LIGHTMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.aoMap%20%3F%20%22%23define%20USE_AOMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.bumpMap%20%3F%20%22%23define%20USE_BUMPMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.normalMap%20%3F%20%22%23define%20USE_NORMALMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.normalMapObjectSpace%20%3F%20%22%23define%20USE_NORMALMAP_OBJECTSPACE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.normalMapTangentSpace%20%3F%20%22%23define%20USE_NORMALMAP_TANGENTSPACE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.displacementMap%20%3F%20%22%23define%20USE_DISPLACEMENTMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.emissiveMap%20%3F%20%22%23define%20USE_EMISSIVEMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.anisotropy%20%3F%20%22%23define%20USE_ANISOTROPY%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.anisotropyMap%20%3F%20%22%23define%20USE_ANISOTROPYMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoatMap%20%3F%20%22%23define%20USE_CLEARCOATMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoatRoughnessMap%20%3F%20%22%23define%20USE_CLEARCOAT_ROUGHNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoatNormalMap%20%3F%20%22%23define%20USE_CLEARCOAT_NORMALMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.iridescenceMap%20%3F%20%22%23define%20USE_IRIDESCENCEMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.iridescenceThicknessMap%20%3F%20%22%23define%20USE_IRIDESCENCE_THICKNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.specularMap%20%3F%20%22%23define%20USE_SPECULARMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.specularColorMap%20%3F%20%22%23define%20USE_SPECULAR_COLORMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.specularIntensityMap%20%3F%20%22%23define%20USE_SPECULAR_INTENSITYMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.roughnessMap%20%3F%20%22%23define%20USE_ROUGHNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.metalnessMap%20%3F%20%22%23define%20USE_METALNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.alphaMap%20%3F%20%22%23define%20USE_ALPHAMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.alphaHash%20%3F%20%22%23define%20USE_ALPHAHASH%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.transmission%20%3F%20%22%23define%20USE_TRANSMISSION%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.transmissionMap%20%3F%20%22%23define%20USE_TRANSMISSIONMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.thicknessMap%20%3F%20%22%23define%20USE_THICKNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.sheenColorMap%20%3F%20%22%23define%20USE_SHEEN_COLORMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.sheenRoughnessMap%20%3F%20%22%23define%20USE_SHEEN_ROUGHNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20%2F%2F%0A%20%20%20%20%20%20parameters.mapUv%20%3F%20%22%23define%20MAP_UV%20%22%20%2B%20parameters.mapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.alphaMapUv%20%3F%20%22%23define%20ALPHAMAP_UV%20%22%20%2B%20parameters.alphaMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.lightMapUv%20%3F%20%22%23define%20LIGHTMAP_UV%20%22%20%2B%20parameters.lightMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.aoMapUv%20%3F%20%22%23define%20AOMAP_UV%20%22%20%2B%20parameters.aoMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.emissiveMapUv%20%3F%20%22%23define%20EMISSIVEMAP_UV%20%22%20%2B%20parameters.emissiveMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.bumpMapUv%20%3F%20%22%23define%20BUMPMAP_UV%20%22%20%2B%20parameters.bumpMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.normalMapUv%20%3F%20%22%23define%20NORMALMAP_UV%20%22%20%2B%20parameters.normalMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.displacementMapUv%20%3F%20%22%23define%20DISPLACEMENTMAP_UV%20%22%20%2B%20parameters.displacementMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.metalnessMapUv%20%3F%20%22%23define%20METALNESSMAP_UV%20%22%20%2B%20parameters.metalnessMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.roughnessMapUv%20%3F%20%22%23define%20ROUGHNESSMAP_UV%20%22%20%2B%20parameters.roughnessMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.anisotropyMapUv%20%3F%20%22%23define%20ANISOTROPYMAP_UV%20%22%20%2B%20parameters.anisotropyMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoatMapUv%20%3F%20%22%23define%20CLEARCOATMAP_UV%20%22%20%2B%20parameters.clearcoatMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoatNormalMapUv%20%3F%20%22%23define%20CLEARCOAT_NORMALMAP_UV%20%22%20%2B%20parameters.clearcoatNormalMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoatRoughnessMapUv%20%3F%20%22%23define%20CLEARCOAT_ROUGHNESSMAP_UV%20%22%20%2B%20parameters.clearcoatRoughnessMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.iridescenceMapUv%20%3F%20%22%23define%20IRIDESCENCEMAP_UV%20%22%20%2B%20parameters.iridescenceMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.iridescenceThicknessMapUv%20%3F%20%22%23define%20IRIDESCENCE_THICKNESSMAP_UV%20%22%20%2B%20parameters.iridescenceThicknessMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.sheenColorMapUv%20%3F%20%22%23define%20SHEEN_COLORMAP_UV%20%22%20%2B%20parameters.sheenColorMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.sheenRoughnessMapUv%20%3F%20%22%23define%20SHEEN_ROUGHNESSMAP_UV%20%22%20%2B%20parameters.sheenRoughnessMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.specularMapUv%20%3F%20%22%23define%20SPECULARMAP_UV%20%22%20%2B%20parameters.specularMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.specularColorMapUv%20%3F%20%22%23define%20SPECULAR_COLORMAP_UV%20%22%20%2B%20parameters.specularColorMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.specularIntensityMapUv%20%3F%20%22%23define%20SPECULAR_INTENSITYMAP_UV%20%22%20%2B%20parameters.specularIntensityMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.transmissionMapUv%20%3F%20%22%23define%20TRANSMISSIONMAP_UV%20%22%20%2B%20parameters.transmissionMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.thicknessMapUv%20%3F%20%22%23define%20THICKNESSMAP_UV%20%22%20%2B%20parameters.thicknessMapUv%20%3A%20%22%22%2C%0A%20%20%20%20%20%20%2F%2F%0A%20%20%20%20%20%20parameters.vertexTangents%20%26%26%20parameters.flatShading%20%3D%3D%3D%20false%20%3F%20%22%23define%20USE_TANGENT%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexColors%20%3F%20%22%23define%20USE_COLOR%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexAlphas%20%3F%20%22%23define%20USE_COLOR_ALPHA%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexUv1s%20%3F%20%22%23define%20USE_UV1%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexUv2s%20%3F%20%22%23define%20USE_UV2%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexUv3s%20%3F%20%22%23define%20USE_UV3%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.pointsUvs%20%3F%20%22%23define%20USE_POINTS_UV%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.flatShading%20%3F%20%22%23define%20FLAT_SHADED%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.skinning%20%3F%20%22%23define%20USE_SKINNING%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.morphTargets%20%3F%20%22%23define%20USE_MORPHTARGETS%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.morphNormals%20%26%26%20parameters.flatShading%20%3D%3D%3D%20false%20%3F%20%22%23define%20USE_MORPHNORMALS%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.morphColors%20%3F%20%22%23define%20USE_MORPHCOLORS%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.morphTargetsCount%20%3E%200%20%3F%20%22%23define%20MORPHTARGETS_TEXTURE_STRIDE%20%22%20%2B%20parameters.morphTextureStride%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.morphTargetsCount%20%3E%200%20%3F%20%22%23define%20MORPHTARGETS_COUNT%20%22%20%2B%20parameters.morphTargetsCount%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.doubleSided%20%3F%20%22%23define%20DOUBLE_SIDED%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.flipSided%20%3F%20%22%23define%20FLIP_SIDED%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.shadowMapEnabled%20%3F%20%22%23define%20USE_SHADOWMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.shadowMapEnabled%20%3F%20%22%23define%20%22%20%2B%20shadowMapTypeDefine%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.sizeAttenuation%20%3F%20%22%23define%20USE_SIZEATTENUATION%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.numLightProbes%20%3E%200%20%3F%20%22%23define%20USE_LIGHT_PROBES%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.logarithmicDepthBuffer%20%3F%20%22%23define%20USE_LOGDEPTHBUF%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.reverseDepthBuffer%20%3F%20%22%23define%20USE_REVERSEDEPTHBUF%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20%22uniform%20mat4%20modelMatrix%3B%22%2C%0A%20%20%20%20%20%20%22uniform%20mat4%20modelViewMatrix%3B%22%2C%0A%20%20%20%20%20%20%22uniform%20mat4%20projectionMatrix%3B%22%2C%0A%20%20%20%20%20%20%22uniform%20mat4%20viewMatrix%3B%22%2C%0A%20%20%20%20%20%20%22uniform%20mat3%20normalMatrix%3B%22%2C%0A%20%20%20%20%20%20%22uniform%20vec3%20cameraPosition%3B%22%2C%0A%20%20%20%20%20%20%22uniform%20bool%20isOrthographic%3B%22%2C%0A%20%20%20%20%20%20%22%23ifdef%20USE_INSTANCING%22%2C%0A%20%20%20%20%20%20%22%09attribute%20mat4%20instanceMatrix%3B%22%2C%0A%20%20%20%20%20%20%22%23endif%22%2C%0A%20%20%20%20%20%20%22%23ifdef%20USE_INSTANCING_COLOR%22%2C%0A%20%20%20%20%20%20%22%09attribute%20vec3%20instanceColor%3B%22%2C%0A%20%20%20%20%20%20%22%23endif%22%2C%0A%20%20%20%20%20%20%22%23ifdef%20USE_INSTANCING_MORPH%22%2C%0A%20%20%20%20%20%20%22%09uniform%20sampler2D%20morphTexture%3B%22%2C%0A%20%20%20%20%20%20%22%23endif%22%2C%0A%20%20%20%20%20%20%22attribute%20vec3%20position%3B%22%2C%0A%20%20%20%20%20%20%22attribute%20vec3%20normal%3B%22%2C%0A%20%20%20%20%20%20%22attribute%20vec2%20uv%3B%22%2C%0A%20%20%20%20%20%20%22%23ifdef%20USE_UV1%22%2C%0A%20%20%20%20%20%20%22%09attribute%20vec2%20uv1%3B%22%2C%0A%20%20%20%20%20%20%22%23endif%22%2C%0A%20%20%20%20%20%20%22%23ifdef%20USE_UV2%22%2C%0A%20%20%20%20%20%20%22%09attribute%20vec2%20uv2%3B%22%2C%0A%20%20%20%20%20%20%22%23endif%22%2C%0A%20%20%20%20%20%20%22%23ifdef%20USE_UV3%22%2C%0A%20%20%20%20%20%20%22%09attribute%20vec2%20uv3%3B%22%2C%0A%20%20%20%20%20%20%22%23endif%22%2C%0A%20%20%20%20%20%20%22%23ifdef%20USE_TANGENT%22%2C%0A%20%20%20%20%20%20%22%09attribute%20vec4%20tangent%3B%22%2C%0A%20%20%20%20%20%20%22%23endif%22%2C%0A%20%20%20%20%20%20%22%23if%20defined%28%20USE_COLOR_ALPHA%20%29%22%2C%0A%20%20%20%20%20%20%22%09attribute%20vec4%20color%3B%22%2C%0A%20%20%20%20%20%20%22%23elif%20defined%28%20USE_COLOR%20%29%22%2C%0A%20%20%20%20%20%20%22%09attribute%20vec3%20color%3B%22%2C%0A%20%20%20%20%20%20%22%23endif%22%2C%0A%20%20%20%20%20%20%22%23ifdef%20USE_SKINNING%22%2C%0A%20%20%20%20%20%20%22%09attribute%20vec4%20skinIndex%3B%22%2C%0A%20%20%20%20%20%20%22%09attribute%20vec4%20skinWeight%3B%22%2C%0A%20%20%20%20%20%20%22%23endif%22%2C%0A%20%20%20%20%20%20%22%5Cn%22%0A%20%20%20%20%5D.filter%28filterEmptyLine%29.join%28%22%5Cn%22%29%3B%0A%20%20%20%20prefixFragment%20%3D%20%5B%0A%20%20%20%20%20%20generatePrecision%28parameters%29%2C%0A%20%20%20%20%20%20%22%23define%20SHADER_TYPE%20%22%20%2B%20parameters.shaderType%2C%0A%20%20%20%20%20%20%22%23define%20SHADER_NAME%20%22%20%2B%20parameters.shaderName%2C%0A%20%20%20%20%20%20customDefines%2C%0A%20%20%20%20%20%20parameters.useFog%20%26%26%20parameters.fog%20%3F%20%22%23define%20USE_FOG%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.useFog%20%26%26%20parameters.fogExp2%20%3F%20%22%23define%20FOG_EXP2%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.alphaToCoverage%20%3F%20%22%23define%20ALPHA_TO_COVERAGE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.map%20%3F%20%22%23define%20USE_MAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.matcap%20%3F%20%22%23define%20USE_MATCAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.envMap%20%3F%20%22%23define%20USE_ENVMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.envMap%20%3F%20%22%23define%20%22%20%2B%20envMapTypeDefine%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.envMap%20%3F%20%22%23define%20%22%20%2B%20envMapModeDefine%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.envMap%20%3F%20%22%23define%20%22%20%2B%20envMapBlendingDefine%20%3A%20%22%22%2C%0A%20%20%20%20%20%20envMapCubeUVSize%20%3F%20%22%23define%20CUBEUV_TEXEL_WIDTH%20%22%20%2B%20envMapCubeUVSize.texelWidth%20%3A%20%22%22%2C%0A%20%20%20%20%20%20envMapCubeUVSize%20%3F%20%22%23define%20CUBEUV_TEXEL_HEIGHT%20%22%20%2B%20envMapCubeUVSize.texelHeight%20%3A%20%22%22%2C%0A%20%20%20%20%20%20envMapCubeUVSize%20%3F%20%22%23define%20CUBEUV_MAX_MIP%20%22%20%2B%20envMapCubeUVSize.maxMip%20%2B%20%22.0%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.lightMap%20%3F%20%22%23define%20USE_LIGHTMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.aoMap%20%3F%20%22%23define%20USE_AOMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.bumpMap%20%3F%20%22%23define%20USE_BUMPMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.normalMap%20%3F%20%22%23define%20USE_NORMALMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.normalMapObjectSpace%20%3F%20%22%23define%20USE_NORMALMAP_OBJECTSPACE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.normalMapTangentSpace%20%3F%20%22%23define%20USE_NORMALMAP_TANGENTSPACE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.emissiveMap%20%3F%20%22%23define%20USE_EMISSIVEMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.anisotropy%20%3F%20%22%23define%20USE_ANISOTROPY%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.anisotropyMap%20%3F%20%22%23define%20USE_ANISOTROPYMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoat%20%3F%20%22%23define%20USE_CLEARCOAT%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoatMap%20%3F%20%22%23define%20USE_CLEARCOATMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoatRoughnessMap%20%3F%20%22%23define%20USE_CLEARCOAT_ROUGHNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.clearcoatNormalMap%20%3F%20%22%23define%20USE_CLEARCOAT_NORMALMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.dispersion%20%3F%20%22%23define%20USE_DISPERSION%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.iridescence%20%3F%20%22%23define%20USE_IRIDESCENCE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.iridescenceMap%20%3F%20%22%23define%20USE_IRIDESCENCEMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.iridescenceThicknessMap%20%3F%20%22%23define%20USE_IRIDESCENCE_THICKNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.specularMap%20%3F%20%22%23define%20USE_SPECULARMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.specularColorMap%20%3F%20%22%23define%20USE_SPECULAR_COLORMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.specularIntensityMap%20%3F%20%22%23define%20USE_SPECULAR_INTENSITYMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.roughnessMap%20%3F%20%22%23define%20USE_ROUGHNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.metalnessMap%20%3F%20%22%23define%20USE_METALNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.alphaMap%20%3F%20%22%23define%20USE_ALPHAMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.alphaTest%20%3F%20%22%23define%20USE_ALPHATEST%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.alphaHash%20%3F%20%22%23define%20USE_ALPHAHASH%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.sheen%20%3F%20%22%23define%20USE_SHEEN%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.sheenColorMap%20%3F%20%22%23define%20USE_SHEEN_COLORMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.sheenRoughnessMap%20%3F%20%22%23define%20USE_SHEEN_ROUGHNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.transmission%20%3F%20%22%23define%20USE_TRANSMISSION%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.transmissionMap%20%3F%20%22%23define%20USE_TRANSMISSIONMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.thicknessMap%20%3F%20%22%23define%20USE_THICKNESSMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexTangents%20%26%26%20parameters.flatShading%20%3D%3D%3D%20false%20%3F%20%22%23define%20USE_TANGENT%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexColors%20%7C%7C%20parameters.instancingColor%20%7C%7C%20parameters.batchingColor%20%3F%20%22%23define%20USE_COLOR%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexAlphas%20%3F%20%22%23define%20USE_COLOR_ALPHA%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexUv1s%20%3F%20%22%23define%20USE_UV1%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexUv2s%20%3F%20%22%23define%20USE_UV2%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.vertexUv3s%20%3F%20%22%23define%20USE_UV3%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.pointsUvs%20%3F%20%22%23define%20USE_POINTS_UV%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.gradientMap%20%3F%20%22%23define%20USE_GRADIENTMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.flatShading%20%3F%20%22%23define%20FLAT_SHADED%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.doubleSided%20%3F%20%22%23define%20DOUBLE_SIDED%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.flipSided%20%3F%20%22%23define%20FLIP_SIDED%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.shadowMapEnabled%20%3F%20%22%23define%20USE_SHADOWMAP%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.shadowMapEnabled%20%3F%20%22%23define%20%22%20%2B%20shadowMapTypeDefine%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.premultipliedAlpha%20%3F%20%22%23define%20PREMULTIPLIED_ALPHA%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.numLightProbes%20%3E%200%20%3F%20%22%23define%20USE_LIGHT_PROBES%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.decodeVideoTexture%20%3F%20%22%23define%20DECODE_VIDEO_TEXTURE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.decodeVideoTextureEmissive%20%3F%20%22%23define%20DECODE_VIDEO_TEXTURE_EMISSIVE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.logarithmicDepthBuffer%20%3F%20%22%23define%20USE_LOGDEPTHBUF%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.reverseDepthBuffer%20%3F%20%22%23define%20USE_REVERSEDEPTHBUF%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20%22uniform%20mat4%20viewMatrix%3B%22%2C%0A%20%20%20%20%20%20%22uniform%20vec3%20cameraPosition%3B%22%2C%0A%20%20%20%20%20%20%22uniform%20bool%20isOrthographic%3B%22%2C%0A%20%20%20%20%20%20parameters.toneMapping%20%21%3D%3D%20NoToneMapping%20%3F%20%22%23define%20TONE_MAPPING%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.toneMapping%20%21%3D%3D%20NoToneMapping%20%3F%20ShaderChunk%5B%22tonemapping_pars_fragment%22%5D%20%3A%20%22%22%2C%0A%20%20%20%20%20%20%2F%2F%20this%20code%20is%20required%20here%20because%20it%20is%20used%20by%20the%20toneMapping%28%29%20function%20defined%20below%0A%20%20%20%20%20%20parameters.toneMapping%20%21%3D%3D%20NoToneMapping%20%3F%20getToneMappingFunction%28%22toneMapping%22%2C%20parameters.toneMapping%29%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.dithering%20%3F%20%22%23define%20DITHERING%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20parameters.opaque%20%3F%20%22%23define%20OPAQUE%22%20%3A%20%22%22%2C%0A%20%20%20%20%20%20ShaderChunk%5B%22colorspace_pars_fragment%22%5D%2C%0A%20%20%20%20%20%20%2F%2F%20this%20code%20is%20required%20here%20because%20it%20is%20used%20by%20the%20various%20encoding%2Fdecoding%20function%20defined%20below%0A%20%20%20%20%20%20getTexelEncodingFunction%28%22linearToOutputTexel%22%2C%20parameters.outputColorSpace%29%2C%0A%20%20%20%20%20%20getLuminanceFunction%28%29%2C%0A%20%20%20%20%20%20parameters.useDepthPacking%20%3F%20%22%23define%20DEPTH_PACKING%20%22%20%2B%20parameters.depthPacking%20%3A%20%22%22%2C%0A%20%20%20%20%20%20%22%5Cn%22%0A%20%20%20%20%5D.filter%28filterEmptyLine%29.join%28%22%5Cn%22%29%3B%0A%20%20%7D%0A%20%20vertexShader%20%3D%20resolveIncludes%28vertexShader%29%3B%0A%20%20vertexShader%20%3D%20replaceLightNums%28vertexShader%2C%20parameters%29%3B%0A%20%20vertexShader%20%3D%20replaceClippingPlaneNums%28vertexShader%2C%20parameters%29%3B%0A%20%20fragmentShader%20%3D%20resolveIncludes%28fragmentShader%29%3B%0A%20%20fragmentShader%20%3D%20replaceLightNums%28fragmentShader%2C%20parameters%29%3B%0A%20%20fragmentShader%20%3D%20replaceClippingPlaneNums%28fragmentShader%2C%20parameters%29%3B%0A%20%20vertexShader%20%3D%20unrollLoops%28vertexShader%29%3B%0A%20%20fragmentShader%20%3D%20unrollLoops%28fragmentShader%29%3B%0A%20%20if%20%28parameters.isRawShaderMaterial%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20versionString%20%3D%20%22%23version%20300%20es%5Cn%22%3B%0A%20%20%20%20prefixVertex%20%3D%20%5B%0A%20%20%20%20%20%20customVertexExtensions%2C%0A%20%20%20%20%20%20%22%23define%20attribute%20in%22%2C%0A%20%20%20%20%20%20%22%23define%20varying%20out%22%2C%0A%20%20%20%20%20%20%22%23define%20texture2D%20texture%22%0A%20%20%20%20%5D.join%28%22%5Cn%22%29%20%2B%20%22%5Cn%22%20%2B%20prefixVertex%3B%0A%20%20%20%20prefixFragment%20%3D%20%5B%0A%20%20%20%20%20%20%22%23define%20varying%20in%22%2C%0A%20%20%20%20%20%20parameters.glslVersion%20%3D%3D%3D%20GLSL3%20%3F%20%22%22%20%3A%20%22layout%28location%20%3D%200%29%20out%20highp%20vec4%20pc_fragColor%3B%22%2C%0A%20%20%20%20%20%20parameters.glslVersion%20%3D%3D%3D%20GLSL3%20%3F%20%22%22%20%3A%20%22%23define%20gl_FragColor%20pc_fragColor%22%2C%0A%20%20%20%20%20%20%22%23define%20gl_FragDepthEXT%20gl_FragDepth%22%2C%0A%20%20%20%20%20%20%22%23define%20texture2D%20texture%22%2C%0A%20%20%20%20%20%20%22%23define%20textureCube%20texture%22%2C%0A%20%20%20%20%20%20%22%23define%20texture2DProj%20textureProj%22%2C%0A%20%20%20%20%20%20%22%23define%20texture2DLodEXT%20textureLod%22%2C%0A%20%20%20%20%20%20%22%23define%20texture2DProjLodEXT%20textureProjLod%22%2C%0A%20%20%20%20%20%20%22%23define%20textureCubeLodEXT%20textureLod%22%2C%0A%20%20%20%20%20%20%22%23define%20texture2DGradEXT%20textureGrad%22%2C%0A%20%20%20%20%20%20%22%23define%20texture2DProjGradEXT%20textureProjGrad%22%2C%0A%20%20%20%20%20%20%22%23define%20textureCubeGradEXT%20textureGrad%22%0A%20%20%20%20%5D.join%28%22%5Cn%22%29%20%2B%20%22%5Cn%22%20%2B%20prefixFragment%3B%0A%20%20%7D%0A%20%20const%20vertexGlsl%20%3D%20versionString%20%2B%20prefixVertex%20%2B%20vertexShader%3B%0A%20%20const%20fragmentGlsl%20%3D%20versionString%20%2B%20prefixFragment%20%2B%20fragmentShader%3B%0A%20%20const%20glVertexShader%20%3D%20WebGLShader%28gl%2C%20gl.VERTEX_SHADER%2C%20vertexGlsl%29%3B%0A%20%20const%20glFragmentShader%20%3D%20WebGLShader%28gl%2C%20gl.FRAGMENT_SHADER%2C%20fragmentGlsl%29%3B%0A%20%20gl.attachShader%28program%2C%20glVertexShader%29%3B%0A%20%20gl.attachShader%28program%2C%20glFragmentShader%29%3B%0A%20%20if%20%28parameters.index0AttributeName%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20gl.bindAttribLocation%28program%2C%200%2C%20parameters.index0AttributeName%29%3B%0A%20%20%7D%20else%20if%20%28parameters.morphTargets%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20gl.bindAttribLocation%28program%2C%200%2C%20%22position%22%29%3B%0A%20%20%7D%0A%20%20gl.linkProgram%28program%29%3B%0A%20%20function%20onFirstUse%28self2%29%20%7B%0A%20%20%20%20if%20%28renderer3.debug.checkShaderErrors%29%20%7B%0A%20%20%20%20%20%20const%20programLog%20%3D%20gl.getProgramInfoLog%28program%29.trim%28%29%3B%0A%20%20%20%20%20%20const%20vertexLog%20%3D%20gl.getShaderInfoLog%28glVertexShader%29.trim%28%29%3B%0A%20%20%20%20%20%20const%20fragmentLog%20%3D%20gl.getShaderInfoLog%28glFragmentShader%29.trim%28%29%3B%0A%20%20%20%20%20%20let%20runnable%20%3D%20true%3B%0A%20%20%20%20%20%20let%20haveDiagnostics%20%3D%20true%3B%0A%20%20%20%20%20%20if%20%28gl.getProgramParameter%28program%2C%20gl.LINK_STATUS%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20runnable%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20if%20%28typeof%20renderer3.debug.onShaderError%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderer3.debug.onShaderError%28gl%2C%20program%2C%20glVertexShader%2C%20glFragmentShader%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20vertexErrors%20%3D%20getShaderErrors%28gl%2C%20glVertexShader%2C%20%22vertex%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20fragmentErrors%20%3D%20getShaderErrors%28gl%2C%20glFragmentShader%2C%20%22fragment%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%22THREE.WebGLProgram%3A%20Shader%20Error%20%22%20%2B%20gl.getError%28%29%20%2B%20%22%20-%20VALIDATE_STATUS%20%22%20%2B%20gl.getProgramParameter%28program%2C%20gl.VALIDATE_STATUS%29%20%2B%20%22%5Cn%5CnMaterial%20Name%3A%20%22%20%2B%20self2.name%20%2B%20%22%5CnMaterial%20Type%3A%20%22%20%2B%20self2.type%20%2B%20%22%5Cn%5CnProgram%20Info%20Log%3A%20%22%20%2B%20programLog%20%2B%20%22%5Cn%22%20%2B%20vertexErrors%20%2B%20%22%5Cn%22%20%2B%20fragmentErrors%0A%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28programLog%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLProgram%3A%20Program%20Info%20Log%3A%22%2C%20programLog%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28vertexLog%20%3D%3D%3D%20%22%22%20%7C%7C%20fragmentLog%20%3D%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20%20%20haveDiagnostics%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28haveDiagnostics%29%20%7B%0A%20%20%20%20%20%20%20%20self2.diagnostics%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20runnable%2C%0A%20%20%20%20%20%20%20%20%20%20programLog%2C%0A%20%20%20%20%20%20%20%20%20%20vertexShader%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20log%3A%20vertexLog%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20prefix%3A%20prefixVertex%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20fragmentShader%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20log%3A%20fragmentLog%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20prefix%3A%20prefixFragment%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20gl.deleteShader%28glVertexShader%29%3B%0A%20%20%20%20gl.deleteShader%28glFragmentShader%29%3B%0A%20%20%20%20cachedUniforms%20%3D%20new%20WebGLUniforms%28gl%2C%20program%29%3B%0A%20%20%20%20cachedAttributes%20%3D%20fetchAttributeLocations%28gl%2C%20program%29%3B%0A%20%20%7D%0A%20%20let%20cachedUniforms%3B%0A%20%20this.getUniforms%20%3D%20function%28%29%20%7B%0A%20%20%20%20if%20%28cachedUniforms%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20onFirstUse%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20cachedUniforms%3B%0A%20%20%7D%3B%0A%20%20let%20cachedAttributes%3B%0A%20%20this.getAttributes%20%3D%20function%28%29%20%7B%0A%20%20%20%20if%20%28cachedAttributes%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20onFirstUse%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20cachedAttributes%3B%0A%20%20%7D%3B%0A%20%20let%20programReady%20%3D%20parameters.rendererExtensionParallelShaderCompile%20%3D%3D%3D%20false%3B%0A%20%20this.isReady%20%3D%20function%28%29%20%7B%0A%20%20%20%20if%20%28programReady%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20programReady%20%3D%20gl.getProgramParameter%28program%2C%20COMPLETION_STATUS_KHR%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20programReady%3B%0A%20%20%7D%3B%0A%20%20this.destroy%20%3D%20function%28%29%20%7B%0A%20%20%20%20bindingStates.releaseStatesOfProgram%28this%29%3B%0A%20%20%20%20gl.deleteProgram%28program%29%3B%0A%20%20%20%20this.program%20%3D%20void%200%3B%0A%20%20%7D%3B%0A%20%20this.type%20%3D%20parameters.shaderType%3B%0A%20%20this.name%20%3D%20parameters.shaderName%3B%0A%20%20this.id%20%3D%20programIdCount%2B%2B%3B%0A%20%20this.cacheKey%20%3D%20cacheKey%3B%0A%20%20this.usedTimes%20%3D%201%3B%0A%20%20this.program%20%3D%20program%3B%0A%20%20this.vertexShader%20%3D%20glVertexShader%3B%0A%20%20this.fragmentShader%20%3D%20glFragmentShader%3B%0A%20%20return%20this%3B%0A%7D%0Avar%20_id%241%20%3D%200%3B%0Avar%20WebGLShaderCache%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.shaderCache%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20this.materialCache%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%7D%0A%20%20update%28material%29%20%7B%0A%20%20%20%20const%20vertexShader%20%3D%20material.vertexShader%3B%0A%20%20%20%20const%20fragmentShader%20%3D%20material.fragmentShader%3B%0A%20%20%20%20const%20vertexShaderStage%20%3D%20this._getShaderStage%28vertexShader%29%3B%0A%20%20%20%20const%20fragmentShaderStage%20%3D%20this._getShaderStage%28fragmentShader%29%3B%0A%20%20%20%20const%20materialShaders%20%3D%20this._getShaderCacheForMaterial%28material%29%3B%0A%20%20%20%20if%20%28materialShaders.has%28vertexShaderStage%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20materialShaders.add%28vertexShaderStage%29%3B%0A%20%20%20%20%20%20vertexShaderStage.usedTimes%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28materialShaders.has%28fragmentShaderStage%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20materialShaders.add%28fragmentShaderStage%29%3B%0A%20%20%20%20%20%20fragmentShaderStage.usedTimes%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20remove%28material%29%20%7B%0A%20%20%20%20const%20materialShaders%20%3D%20this.materialCache.get%28material%29%3B%0A%20%20%20%20for%20%28const%20shaderStage%20of%20materialShaders%29%20%7B%0A%20%20%20%20%20%20shaderStage.usedTimes--%3B%0A%20%20%20%20%20%20if%20%28shaderStage.usedTimes%20%3D%3D%3D%200%29%20this.shaderCache.delete%28shaderStage.code%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.materialCache.delete%28material%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getVertexShaderID%28material%29%20%7B%0A%20%20%20%20return%20this._getShaderStage%28material.vertexShader%29.id%3B%0A%20%20%7D%0A%20%20getFragmentShaderID%28material%29%20%7B%0A%20%20%20%20return%20this._getShaderStage%28material.fragmentShader%29.id%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.shaderCache.clear%28%29%3B%0A%20%20%20%20this.materialCache.clear%28%29%3B%0A%20%20%7D%0A%20%20_getShaderCacheForMaterial%28material%29%20%7B%0A%20%20%20%20const%20cache2%20%3D%20this.materialCache%3B%0A%20%20%20%20let%20set2%20%3D%20cache2.get%28material%29%3B%0A%20%20%20%20if%20%28set2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20set2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%29%3B%0A%20%20%20%20%20%20cache2.set%28material%2C%20set2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20set2%3B%0A%20%20%7D%0A%20%20_getShaderStage%28code%29%20%7B%0A%20%20%20%20const%20cache2%20%3D%20this.shaderCache%3B%0A%20%20%20%20let%20stage%20%3D%20cache2.get%28code%29%3B%0A%20%20%20%20if%20%28stage%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20stage%20%3D%20new%20WebGLShaderStage%28code%29%3B%0A%20%20%20%20%20%20cache2.set%28code%2C%20stage%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20stage%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGLShaderStage%20%3D%20class%20%7B%0A%20%20constructor%28code%29%20%7B%0A%20%20%20%20this.id%20%3D%20_id%241%2B%2B%3B%0A%20%20%20%20this.code%20%3D%20code%3B%0A%20%20%20%20this.usedTimes%20%3D%200%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20WebGLPrograms%28renderer3%2C%20cubemaps%2C%20cubeuvmaps%2C%20extensions%2C%20capabilities%2C%20bindingStates%2C%20clipping2%29%20%7B%0A%20%20const%20_programLayers%20%3D%20new%20Layers%28%29%3B%0A%20%20const%20_customShaders%20%3D%20new%20WebGLShaderCache%28%29%3B%0A%20%20const%20_activeChannels%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%29%3B%0A%20%20const%20programs%20%3D%20%5B%5D%3B%0A%20%20const%20logarithmicDepthBuffer%20%3D%20capabilities.logarithmicDepthBuffer%3B%0A%20%20const%20SUPPORTS_VERTEX_TEXTURES%20%3D%20capabilities.vertexTextures%3B%0A%20%20let%20precision%20%3D%20capabilities.precision%3B%0A%20%20const%20shaderIDs%20%3D%20%7B%0A%20%20%20%20MeshDepthMaterial%3A%20%22depth%22%2C%0A%20%20%20%20MeshDistanceMaterial%3A%20%22distanceRGBA%22%2C%0A%20%20%20%20MeshNormalMaterial%3A%20%22normal%22%2C%0A%20%20%20%20MeshBasicMaterial%3A%20%22basic%22%2C%0A%20%20%20%20MeshLambertMaterial%3A%20%22lambert%22%2C%0A%20%20%20%20MeshPhongMaterial%3A%20%22phong%22%2C%0A%20%20%20%20MeshToonMaterial%3A%20%22toon%22%2C%0A%20%20%20%20MeshStandardMaterial%3A%20%22physical%22%2C%0A%20%20%20%20MeshPhysicalMaterial%3A%20%22physical%22%2C%0A%20%20%20%20MeshMatcapMaterial%3A%20%22matcap%22%2C%0A%20%20%20%20LineBasicMaterial%3A%20%22basic%22%2C%0A%20%20%20%20LineDashedMaterial%3A%20%22dashed%22%2C%0A%20%20%20%20PointsMaterial%3A%20%22points%22%2C%0A%20%20%20%20ShadowMaterial%3A%20%22shadow%22%2C%0A%20%20%20%20SpriteMaterial%3A%20%22sprite%22%0A%20%20%7D%3B%0A%20%20function%20getChannel%28value%29%20%7B%0A%20%20%20%20_activeChannels.add%28value%29%3B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%200%29%20return%20%22uv%22%3B%0A%20%20%20%20return%20%60uv%24%7Bvalue%7D%60%3B%0A%20%20%7D%0A%20%20function%20getParameters%28material%2C%20lights%2C%20shadows%2C%20scene3%2C%20object%29%20%7B%0A%20%20%20%20const%20fog%20%3D%20scene3.fog%3B%0A%20%20%20%20const%20geometry%20%3D%20object.geometry%3B%0A%20%20%20%20const%20environment%20%3D%20material.isMeshStandardMaterial%20%3F%20scene3.environment%20%3A%20null%3B%0A%20%20%20%20const%20envMap%20%3D%20%28material.isMeshStandardMaterial%20%3F%20cubeuvmaps%20%3A%20cubemaps%29.get%28material.envMap%20%7C%7C%20environment%29%3B%0A%20%20%20%20const%20envMapCubeUVHeight%20%3D%20%21%21envMap%20%26%26%20envMap.mapping%20%3D%3D%3D%20CubeUVReflectionMapping%20%3F%20envMap.image.height%20%3A%20null%3B%0A%20%20%20%20const%20shaderID%20%3D%20shaderIDs%5Bmaterial.type%5D%3B%0A%20%20%20%20if%20%28material.precision%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20precision%20%3D%20capabilities.getMaxPrecision%28material.precision%29%3B%0A%20%20%20%20%20%20if%20%28precision%20%21%3D%3D%20material.precision%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLProgram.getParameters%3A%22%2C%20material.precision%2C%20%22not%20supported%2C%20using%22%2C%20precision%2C%20%22instead.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20morphAttribute%20%3D%20geometry.morphAttributes.position%20%7C%7C%20geometry.morphAttributes.normal%20%7C%7C%20geometry.morphAttributes.color%3B%0A%20%20%20%20const%20morphTargetsCount%20%3D%20morphAttribute%20%21%3D%3D%20void%200%20%3F%20morphAttribute.length%20%3A%200%3B%0A%20%20%20%20let%20morphTextureStride%20%3D%200%3B%0A%20%20%20%20if%20%28geometry.morphAttributes.position%20%21%3D%3D%20void%200%29%20morphTextureStride%20%3D%201%3B%0A%20%20%20%20if%20%28geometry.morphAttributes.normal%20%21%3D%3D%20void%200%29%20morphTextureStride%20%3D%202%3B%0A%20%20%20%20if%20%28geometry.morphAttributes.color%20%21%3D%3D%20void%200%29%20morphTextureStride%20%3D%203%3B%0A%20%20%20%20let%20vertexShader%2C%20fragmentShader%3B%0A%20%20%20%20let%20customVertexShaderID%2C%20customFragmentShaderID%3B%0A%20%20%20%20if%20%28shaderID%29%20%7B%0A%20%20%20%20%20%20const%20shader%20%3D%20ShaderLib%5BshaderID%5D%3B%0A%20%20%20%20%20%20vertexShader%20%3D%20shader.vertexShader%3B%0A%20%20%20%20%20%20fragmentShader%20%3D%20shader.fragmentShader%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20vertexShader%20%3D%20material.vertexShader%3B%0A%20%20%20%20%20%20fragmentShader%20%3D%20material.fragmentShader%3B%0A%20%20%20%20%20%20_customShaders.update%28material%29%3B%0A%20%20%20%20%20%20customVertexShaderID%20%3D%20_customShaders.getVertexShaderID%28material%29%3B%0A%20%20%20%20%20%20customFragmentShaderID%20%3D%20_customShaders.getFragmentShaderID%28material%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20currentRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20const%20reverseDepthBuffer%20%3D%20renderer3.state.buffers.depth.getReversed%28%29%3B%0A%20%20%20%20const%20IS_INSTANCEDMESH%20%3D%20object.isInstancedMesh%20%3D%3D%3D%20true%3B%0A%20%20%20%20const%20IS_BATCHEDMESH%20%3D%20object.isBatchedMesh%20%3D%3D%3D%20true%3B%0A%20%20%20%20const%20HAS_MAP%20%3D%20%21%21material.map%3B%0A%20%20%20%20const%20HAS_MATCAP%20%3D%20%21%21material.matcap%3B%0A%20%20%20%20const%20HAS_ENVMAP%20%3D%20%21%21envMap%3B%0A%20%20%20%20const%20HAS_AOMAP%20%3D%20%21%21material.aoMap%3B%0A%20%20%20%20const%20HAS_LIGHTMAP%20%3D%20%21%21material.lightMap%3B%0A%20%20%20%20const%20HAS_BUMPMAP%20%3D%20%21%21material.bumpMap%3B%0A%20%20%20%20const%20HAS_NORMALMAP%20%3D%20%21%21material.normalMap%3B%0A%20%20%20%20const%20HAS_DISPLACEMENTMAP%20%3D%20%21%21material.displacementMap%3B%0A%20%20%20%20const%20HAS_EMISSIVEMAP%20%3D%20%21%21material.emissiveMap%3B%0A%20%20%20%20const%20HAS_METALNESSMAP%20%3D%20%21%21material.metalnessMap%3B%0A%20%20%20%20const%20HAS_ROUGHNESSMAP%20%3D%20%21%21material.roughnessMap%3B%0A%20%20%20%20const%20HAS_ANISOTROPY%20%3D%20material.anisotropy%20%3E%200%3B%0A%20%20%20%20const%20HAS_CLEARCOAT%20%3D%20material.clearcoat%20%3E%200%3B%0A%20%20%20%20const%20HAS_DISPERSION%20%3D%20material.dispersion%20%3E%200%3B%0A%20%20%20%20const%20HAS_IRIDESCENCE%20%3D%20material.iridescence%20%3E%200%3B%0A%20%20%20%20const%20HAS_SHEEN%20%3D%20material.sheen%20%3E%200%3B%0A%20%20%20%20const%20HAS_TRANSMISSION%20%3D%20material.transmission%20%3E%200%3B%0A%20%20%20%20const%20HAS_ANISOTROPYMAP%20%3D%20HAS_ANISOTROPY%20%26%26%20%21%21material.anisotropyMap%3B%0A%20%20%20%20const%20HAS_CLEARCOATMAP%20%3D%20HAS_CLEARCOAT%20%26%26%20%21%21material.clearcoatMap%3B%0A%20%20%20%20const%20HAS_CLEARCOAT_NORMALMAP%20%3D%20HAS_CLEARCOAT%20%26%26%20%21%21material.clearcoatNormalMap%3B%0A%20%20%20%20const%20HAS_CLEARCOAT_ROUGHNESSMAP%20%3D%20HAS_CLEARCOAT%20%26%26%20%21%21material.clearcoatRoughnessMap%3B%0A%20%20%20%20const%20HAS_IRIDESCENCEMAP%20%3D%20HAS_IRIDESCENCE%20%26%26%20%21%21material.iridescenceMap%3B%0A%20%20%20%20const%20HAS_IRIDESCENCE_THICKNESSMAP%20%3D%20HAS_IRIDESCENCE%20%26%26%20%21%21material.iridescenceThicknessMap%3B%0A%20%20%20%20const%20HAS_SHEEN_COLORMAP%20%3D%20HAS_SHEEN%20%26%26%20%21%21material.sheenColorMap%3B%0A%20%20%20%20const%20HAS_SHEEN_ROUGHNESSMAP%20%3D%20HAS_SHEEN%20%26%26%20%21%21material.sheenRoughnessMap%3B%0A%20%20%20%20const%20HAS_SPECULARMAP%20%3D%20%21%21material.specularMap%3B%0A%20%20%20%20const%20HAS_SPECULAR_COLORMAP%20%3D%20%21%21material.specularColorMap%3B%0A%20%20%20%20const%20HAS_SPECULAR_INTENSITYMAP%20%3D%20%21%21material.specularIntensityMap%3B%0A%20%20%20%20const%20HAS_TRANSMISSIONMAP%20%3D%20HAS_TRANSMISSION%20%26%26%20%21%21material.transmissionMap%3B%0A%20%20%20%20const%20HAS_THICKNESSMAP%20%3D%20HAS_TRANSMISSION%20%26%26%20%21%21material.thicknessMap%3B%0A%20%20%20%20const%20HAS_GRADIENTMAP%20%3D%20%21%21material.gradientMap%3B%0A%20%20%20%20const%20HAS_ALPHAMAP%20%3D%20%21%21material.alphaMap%3B%0A%20%20%20%20const%20HAS_ALPHATEST%20%3D%20material.alphaTest%20%3E%200%3B%0A%20%20%20%20const%20HAS_ALPHAHASH%20%3D%20%21%21material.alphaHash%3B%0A%20%20%20%20const%20HAS_EXTENSIONS%20%3D%20%21%21material.extensions%3B%0A%20%20%20%20let%20toneMapping2%20%3D%20NoToneMapping%3B%0A%20%20%20%20if%20%28material.toneMapped%29%20%7B%0A%20%20%20%20%20%20if%20%28currentRenderTarget%20%3D%3D%3D%20null%20%7C%7C%20currentRenderTarget.isXRRenderTarget%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20toneMapping2%20%3D%20renderer3.toneMapping%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20parameters%20%3D%20%7B%0A%20%20%20%20%20%20shaderID%2C%0A%20%20%20%20%20%20shaderType%3A%20material.type%2C%0A%20%20%20%20%20%20shaderName%3A%20material.name%2C%0A%20%20%20%20%20%20vertexShader%2C%0A%20%20%20%20%20%20fragmentShader%2C%0A%20%20%20%20%20%20defines%3A%20material.defines%2C%0A%20%20%20%20%20%20customVertexShaderID%2C%0A%20%20%20%20%20%20customFragmentShaderID%2C%0A%20%20%20%20%20%20isRawShaderMaterial%3A%20material.isRawShaderMaterial%20%3D%3D%3D%20true%2C%0A%20%20%20%20%20%20glslVersion%3A%20material.glslVersion%2C%0A%20%20%20%20%20%20precision%2C%0A%20%20%20%20%20%20batching%3A%20IS_BATCHEDMESH%2C%0A%20%20%20%20%20%20batchingColor%3A%20IS_BATCHEDMESH%20%26%26%20object._colorsTexture%20%21%3D%3D%20null%2C%0A%20%20%20%20%20%20instancing%3A%20IS_INSTANCEDMESH%2C%0A%20%20%20%20%20%20instancingColor%3A%20IS_INSTANCEDMESH%20%26%26%20object.instanceColor%20%21%3D%3D%20null%2C%0A%20%20%20%20%20%20instancingMorph%3A%20IS_INSTANCEDMESH%20%26%26%20object.morphTexture%20%21%3D%3D%20null%2C%0A%20%20%20%20%20%20supportsVertexTextures%3A%20SUPPORTS_VERTEX_TEXTURES%2C%0A%20%20%20%20%20%20outputColorSpace%3A%20currentRenderTarget%20%3D%3D%3D%20null%20%3F%20renderer3.outputColorSpace%20%3A%20currentRenderTarget.isXRRenderTarget%20%3D%3D%3D%20true%20%3F%20currentRenderTarget.texture.colorSpace%20%3A%20LinearSRGBColorSpace%2C%0A%20%20%20%20%20%20alphaToCoverage%3A%20%21%21material.alphaToCoverage%2C%0A%20%20%20%20%20%20map%3A%20HAS_MAP%2C%0A%20%20%20%20%20%20matcap%3A%20HAS_MATCAP%2C%0A%20%20%20%20%20%20envMap%3A%20HAS_ENVMAP%2C%0A%20%20%20%20%20%20envMapMode%3A%20HAS_ENVMAP%20%26%26%20envMap.mapping%2C%0A%20%20%20%20%20%20envMapCubeUVHeight%2C%0A%20%20%20%20%20%20aoMap%3A%20HAS_AOMAP%2C%0A%20%20%20%20%20%20lightMap%3A%20HAS_LIGHTMAP%2C%0A%20%20%20%20%20%20bumpMap%3A%20HAS_BUMPMAP%2C%0A%20%20%20%20%20%20normalMap%3A%20HAS_NORMALMAP%2C%0A%20%20%20%20%20%20displacementMap%3A%20SUPPORTS_VERTEX_TEXTURES%20%26%26%20HAS_DISPLACEMENTMAP%2C%0A%20%20%20%20%20%20emissiveMap%3A%20HAS_EMISSIVEMAP%2C%0A%20%20%20%20%20%20normalMapObjectSpace%3A%20HAS_NORMALMAP%20%26%26%20material.normalMapType%20%3D%3D%3D%20ObjectSpaceNormalMap%2C%0A%20%20%20%20%20%20normalMapTangentSpace%3A%20HAS_NORMALMAP%20%26%26%20material.normalMapType%20%3D%3D%3D%20TangentSpaceNormalMap%2C%0A%20%20%20%20%20%20metalnessMap%3A%20HAS_METALNESSMAP%2C%0A%20%20%20%20%20%20roughnessMap%3A%20HAS_ROUGHNESSMAP%2C%0A%20%20%20%20%20%20anisotropy%3A%20HAS_ANISOTROPY%2C%0A%20%20%20%20%20%20anisotropyMap%3A%20HAS_ANISOTROPYMAP%2C%0A%20%20%20%20%20%20clearcoat%3A%20HAS_CLEARCOAT%2C%0A%20%20%20%20%20%20clearcoatMap%3A%20HAS_CLEARCOATMAP%2C%0A%20%20%20%20%20%20clearcoatNormalMap%3A%20HAS_CLEARCOAT_NORMALMAP%2C%0A%20%20%20%20%20%20clearcoatRoughnessMap%3A%20HAS_CLEARCOAT_ROUGHNESSMAP%2C%0A%20%20%20%20%20%20dispersion%3A%20HAS_DISPERSION%2C%0A%20%20%20%20%20%20iridescence%3A%20HAS_IRIDESCENCE%2C%0A%20%20%20%20%20%20iridescenceMap%3A%20HAS_IRIDESCENCEMAP%2C%0A%20%20%20%20%20%20iridescenceThicknessMap%3A%20HAS_IRIDESCENCE_THICKNESSMAP%2C%0A%20%20%20%20%20%20sheen%3A%20HAS_SHEEN%2C%0A%20%20%20%20%20%20sheenColorMap%3A%20HAS_SHEEN_COLORMAP%2C%0A%20%20%20%20%20%20sheenRoughnessMap%3A%20HAS_SHEEN_ROUGHNESSMAP%2C%0A%20%20%20%20%20%20specularMap%3A%20HAS_SPECULARMAP%2C%0A%20%20%20%20%20%20specularColorMap%3A%20HAS_SPECULAR_COLORMAP%2C%0A%20%20%20%20%20%20specularIntensityMap%3A%20HAS_SPECULAR_INTENSITYMAP%2C%0A%20%20%20%20%20%20transmission%3A%20HAS_TRANSMISSION%2C%0A%20%20%20%20%20%20transmissionMap%3A%20HAS_TRANSMISSIONMAP%2C%0A%20%20%20%20%20%20thicknessMap%3A%20HAS_THICKNESSMAP%2C%0A%20%20%20%20%20%20gradientMap%3A%20HAS_GRADIENTMAP%2C%0A%20%20%20%20%20%20opaque%3A%20material.transparent%20%3D%3D%3D%20false%20%26%26%20material.blending%20%3D%3D%3D%20NormalBlending%20%26%26%20material.alphaToCoverage%20%3D%3D%3D%20false%2C%0A%20%20%20%20%20%20alphaMap%3A%20HAS_ALPHAMAP%2C%0A%20%20%20%20%20%20alphaTest%3A%20HAS_ALPHATEST%2C%0A%20%20%20%20%20%20alphaHash%3A%20HAS_ALPHAHASH%2C%0A%20%20%20%20%20%20combine%3A%20material.combine%2C%0A%20%20%20%20%20%20%2F%2F%0A%20%20%20%20%20%20mapUv%3A%20HAS_MAP%20%26%26%20getChannel%28material.map.channel%29%2C%0A%20%20%20%20%20%20aoMapUv%3A%20HAS_AOMAP%20%26%26%20getChannel%28material.aoMap.channel%29%2C%0A%20%20%20%20%20%20lightMapUv%3A%20HAS_LIGHTMAP%20%26%26%20getChannel%28material.lightMap.channel%29%2C%0A%20%20%20%20%20%20bumpMapUv%3A%20HAS_BUMPMAP%20%26%26%20getChannel%28material.bumpMap.channel%29%2C%0A%20%20%20%20%20%20normalMapUv%3A%20HAS_NORMALMAP%20%26%26%20getChannel%28material.normalMap.channel%29%2C%0A%20%20%20%20%20%20displacementMapUv%3A%20HAS_DISPLACEMENTMAP%20%26%26%20getChannel%28material.displacementMap.channel%29%2C%0A%20%20%20%20%20%20emissiveMapUv%3A%20HAS_EMISSIVEMAP%20%26%26%20getChannel%28material.emissiveMap.channel%29%2C%0A%20%20%20%20%20%20metalnessMapUv%3A%20HAS_METALNESSMAP%20%26%26%20getChannel%28material.metalnessMap.channel%29%2C%0A%20%20%20%20%20%20roughnessMapUv%3A%20HAS_ROUGHNESSMAP%20%26%26%20getChannel%28material.roughnessMap.channel%29%2C%0A%20%20%20%20%20%20anisotropyMapUv%3A%20HAS_ANISOTROPYMAP%20%26%26%20getChannel%28material.anisotropyMap.channel%29%2C%0A%20%20%20%20%20%20clearcoatMapUv%3A%20HAS_CLEARCOATMAP%20%26%26%20getChannel%28material.clearcoatMap.channel%29%2C%0A%20%20%20%20%20%20clearcoatNormalMapUv%3A%20HAS_CLEARCOAT_NORMALMAP%20%26%26%20getChannel%28material.clearcoatNormalMap.channel%29%2C%0A%20%20%20%20%20%20clearcoatRoughnessMapUv%3A%20HAS_CLEARCOAT_ROUGHNESSMAP%20%26%26%20getChannel%28material.clearcoatRoughnessMap.channel%29%2C%0A%20%20%20%20%20%20iridescenceMapUv%3A%20HAS_IRIDESCENCEMAP%20%26%26%20getChannel%28material.iridescenceMap.channel%29%2C%0A%20%20%20%20%20%20iridescenceThicknessMapUv%3A%20HAS_IRIDESCENCE_THICKNESSMAP%20%26%26%20getChannel%28material.iridescenceThicknessMap.channel%29%2C%0A%20%20%20%20%20%20sheenColorMapUv%3A%20HAS_SHEEN_COLORMAP%20%26%26%20getChannel%28material.sheenColorMap.channel%29%2C%0A%20%20%20%20%20%20sheenRoughnessMapUv%3A%20HAS_SHEEN_ROUGHNESSMAP%20%26%26%20getChannel%28material.sheenRoughnessMap.channel%29%2C%0A%20%20%20%20%20%20specularMapUv%3A%20HAS_SPECULARMAP%20%26%26%20getChannel%28material.specularMap.channel%29%2C%0A%20%20%20%20%20%20specularColorMapUv%3A%20HAS_SPECULAR_COLORMAP%20%26%26%20getChannel%28material.specularColorMap.channel%29%2C%0A%20%20%20%20%20%20specularIntensityMapUv%3A%20HAS_SPECULAR_INTENSITYMAP%20%26%26%20getChannel%28material.specularIntensityMap.channel%29%2C%0A%20%20%20%20%20%20transmissionMapUv%3A%20HAS_TRANSMISSIONMAP%20%26%26%20getChannel%28material.transmissionMap.channel%29%2C%0A%20%20%20%20%20%20thicknessMapUv%3A%20HAS_THICKNESSMAP%20%26%26%20getChannel%28material.thicknessMap.channel%29%2C%0A%20%20%20%20%20%20alphaMapUv%3A%20HAS_ALPHAMAP%20%26%26%20getChannel%28material.alphaMap.channel%29%2C%0A%20%20%20%20%20%20%2F%2F%0A%20%20%20%20%20%20vertexTangents%3A%20%21%21geometry.attributes.tangent%20%26%26%20%28HAS_NORMALMAP%20%7C%7C%20HAS_ANISOTROPY%29%2C%0A%20%20%20%20%20%20vertexColors%3A%20material.vertexColors%2C%0A%20%20%20%20%20%20vertexAlphas%3A%20material.vertexColors%20%3D%3D%3D%20true%20%26%26%20%21%21geometry.attributes.color%20%26%26%20geometry.attributes.color.itemSize%20%3D%3D%3D%204%2C%0A%20%20%20%20%20%20pointsUvs%3A%20object.isPoints%20%3D%3D%3D%20true%20%26%26%20%21%21geometry.attributes.uv%20%26%26%20%28HAS_MAP%20%7C%7C%20HAS_ALPHAMAP%29%2C%0A%20%20%20%20%20%20fog%3A%20%21%21fog%2C%0A%20%20%20%20%20%20useFog%3A%20material.fog%20%3D%3D%3D%20true%2C%0A%20%20%20%20%20%20fogExp2%3A%20%21%21fog%20%26%26%20fog.isFogExp2%2C%0A%20%20%20%20%20%20flatShading%3A%20material.flatShading%20%3D%3D%3D%20true%2C%0A%20%20%20%20%20%20sizeAttenuation%3A%20material.sizeAttenuation%20%3D%3D%3D%20true%2C%0A%20%20%20%20%20%20logarithmicDepthBuffer%2C%0A%20%20%20%20%20%20reverseDepthBuffer%2C%0A%20%20%20%20%20%20skinning%3A%20object.isSkinnedMesh%20%3D%3D%3D%20true%2C%0A%20%20%20%20%20%20morphTargets%3A%20geometry.morphAttributes.position%20%21%3D%3D%20void%200%2C%0A%20%20%20%20%20%20morphNormals%3A%20geometry.morphAttributes.normal%20%21%3D%3D%20void%200%2C%0A%20%20%20%20%20%20morphColors%3A%20geometry.morphAttributes.color%20%21%3D%3D%20void%200%2C%0A%20%20%20%20%20%20morphTargetsCount%2C%0A%20%20%20%20%20%20morphTextureStride%2C%0A%20%20%20%20%20%20numDirLights%3A%20lights.directional.length%2C%0A%20%20%20%20%20%20numPointLights%3A%20lights.point.length%2C%0A%20%20%20%20%20%20numSpotLights%3A%20lights.spot.length%2C%0A%20%20%20%20%20%20numSpotLightMaps%3A%20lights.spotLightMap.length%2C%0A%20%20%20%20%20%20numRectAreaLights%3A%20lights.rectArea.length%2C%0A%20%20%20%20%20%20numHemiLights%3A%20lights.hemi.length%2C%0A%20%20%20%20%20%20numDirLightShadows%3A%20lights.directionalShadowMap.length%2C%0A%20%20%20%20%20%20numPointLightShadows%3A%20lights.pointShadowMap.length%2C%0A%20%20%20%20%20%20numSpotLightShadows%3A%20lights.spotShadowMap.length%2C%0A%20%20%20%20%20%20numSpotLightShadowsWithMaps%3A%20lights.numSpotLightShadowsWithMaps%2C%0A%20%20%20%20%20%20numLightProbes%3A%20lights.numLightProbes%2C%0A%20%20%20%20%20%20numClippingPlanes%3A%20clipping2.numPlanes%2C%0A%20%20%20%20%20%20numClipIntersection%3A%20clipping2.numIntersection%2C%0A%20%20%20%20%20%20dithering%3A%20material.dithering%2C%0A%20%20%20%20%20%20shadowMapEnabled%3A%20renderer3.shadowMap.enabled%20%26%26%20shadows.length%20%3E%200%2C%0A%20%20%20%20%20%20shadowMapType%3A%20renderer3.shadowMap.type%2C%0A%20%20%20%20%20%20toneMapping%3A%20toneMapping2%2C%0A%20%20%20%20%20%20decodeVideoTexture%3A%20HAS_MAP%20%26%26%20material.map.isVideoTexture%20%3D%3D%3D%20true%20%26%26%20ColorManagement.getTransfer%28material.map.colorSpace%29%20%3D%3D%3D%20SRGBTransfer%2C%0A%20%20%20%20%20%20decodeVideoTextureEmissive%3A%20HAS_EMISSIVEMAP%20%26%26%20material.emissiveMap.isVideoTexture%20%3D%3D%3D%20true%20%26%26%20ColorManagement.getTransfer%28material.emissiveMap.colorSpace%29%20%3D%3D%3D%20SRGBTransfer%2C%0A%20%20%20%20%20%20premultipliedAlpha%3A%20material.premultipliedAlpha%2C%0A%20%20%20%20%20%20doubleSided%3A%20material.side%20%3D%3D%3D%20DoubleSide%2C%0A%20%20%20%20%20%20flipSided%3A%20material.side%20%3D%3D%3D%20BackSide%2C%0A%20%20%20%20%20%20useDepthPacking%3A%20material.depthPacking%20%3E%3D%200%2C%0A%20%20%20%20%20%20depthPacking%3A%20material.depthPacking%20%7C%7C%200%2C%0A%20%20%20%20%20%20index0AttributeName%3A%20material.index0AttributeName%2C%0A%20%20%20%20%20%20extensionClipCullDistance%3A%20HAS_EXTENSIONS%20%26%26%20material.extensions.clipCullDistance%20%3D%3D%3D%20true%20%26%26%20extensions.has%28%22WEBGL_clip_cull_distance%22%29%2C%0A%20%20%20%20%20%20extensionMultiDraw%3A%20%28HAS_EXTENSIONS%20%26%26%20material.extensions.multiDraw%20%3D%3D%3D%20true%20%7C%7C%20IS_BATCHEDMESH%29%20%26%26%20extensions.has%28%22WEBGL_multi_draw%22%29%2C%0A%20%20%20%20%20%20rendererExtensionParallelShaderCompile%3A%20extensions.has%28%22KHR_parallel_shader_compile%22%29%2C%0A%20%20%20%20%20%20customProgramCacheKey%3A%20material.customProgramCacheKey%28%29%0A%20%20%20%20%7D%3B%0A%20%20%20%20parameters.vertexUv1s%20%3D%20_activeChannels.has%281%29%3B%0A%20%20%20%20parameters.vertexUv2s%20%3D%20_activeChannels.has%282%29%3B%0A%20%20%20%20parameters.vertexUv3s%20%3D%20_activeChannels.has%283%29%3B%0A%20%20%20%20_activeChannels.clear%28%29%3B%0A%20%20%20%20return%20parameters%3B%0A%20%20%7D%0A%20%20function%20getProgramCacheKey%28parameters%29%20%7B%0A%20%20%20%20const%20array%20%3D%20%5B%5D%3B%0A%20%20%20%20if%20%28parameters.shaderID%29%20%7B%0A%20%20%20%20%20%20array.push%28parameters.shaderID%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20array.push%28parameters.customVertexShaderID%29%3B%0A%20%20%20%20%20%20array.push%28parameters.customFragmentShaderID%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28parameters.defines%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20name%20in%20parameters.defines%29%20%7B%0A%20%20%20%20%20%20%20%20array.push%28name%29%3B%0A%20%20%20%20%20%20%20%20array.push%28parameters.defines%5Bname%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28parameters.isRawShaderMaterial%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20getProgramCacheKeyParameters%28array%2C%20parameters%29%3B%0A%20%20%20%20%20%20getProgramCacheKeyBooleans%28array%2C%20parameters%29%3B%0A%20%20%20%20%20%20array.push%28renderer3.outputColorSpace%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20array.push%28parameters.customProgramCacheKey%29%3B%0A%20%20%20%20return%20array.join%28%29%3B%0A%20%20%7D%0A%20%20function%20getProgramCacheKeyParameters%28array%2C%20parameters%29%20%7B%0A%20%20%20%20array.push%28parameters.precision%29%3B%0A%20%20%20%20array.push%28parameters.outputColorSpace%29%3B%0A%20%20%20%20array.push%28parameters.envMapMode%29%3B%0A%20%20%20%20array.push%28parameters.envMapCubeUVHeight%29%3B%0A%20%20%20%20array.push%28parameters.mapUv%29%3B%0A%20%20%20%20array.push%28parameters.alphaMapUv%29%3B%0A%20%20%20%20array.push%28parameters.lightMapUv%29%3B%0A%20%20%20%20array.push%28parameters.aoMapUv%29%3B%0A%20%20%20%20array.push%28parameters.bumpMapUv%29%3B%0A%20%20%20%20array.push%28parameters.normalMapUv%29%3B%0A%20%20%20%20array.push%28parameters.displacementMapUv%29%3B%0A%20%20%20%20array.push%28parameters.emissiveMapUv%29%3B%0A%20%20%20%20array.push%28parameters.metalnessMapUv%29%3B%0A%20%20%20%20array.push%28parameters.roughnessMapUv%29%3B%0A%20%20%20%20array.push%28parameters.anisotropyMapUv%29%3B%0A%20%20%20%20array.push%28parameters.clearcoatMapUv%29%3B%0A%20%20%20%20array.push%28parameters.clearcoatNormalMapUv%29%3B%0A%20%20%20%20array.push%28parameters.clearcoatRoughnessMapUv%29%3B%0A%20%20%20%20array.push%28parameters.iridescenceMapUv%29%3B%0A%20%20%20%20array.push%28parameters.iridescenceThicknessMapUv%29%3B%0A%20%20%20%20array.push%28parameters.sheenColorMapUv%29%3B%0A%20%20%20%20array.push%28parameters.sheenRoughnessMapUv%29%3B%0A%20%20%20%20array.push%28parameters.specularMapUv%29%3B%0A%20%20%20%20array.push%28parameters.specularColorMapUv%29%3B%0A%20%20%20%20array.push%28parameters.specularIntensityMapUv%29%3B%0A%20%20%20%20array.push%28parameters.transmissionMapUv%29%3B%0A%20%20%20%20array.push%28parameters.thicknessMapUv%29%3B%0A%20%20%20%20array.push%28parameters.combine%29%3B%0A%20%20%20%20array.push%28parameters.fogExp2%29%3B%0A%20%20%20%20array.push%28parameters.sizeAttenuation%29%3B%0A%20%20%20%20array.push%28parameters.morphTargetsCount%29%3B%0A%20%20%20%20array.push%28parameters.morphAttributeCount%29%3B%0A%20%20%20%20array.push%28parameters.numDirLights%29%3B%0A%20%20%20%20array.push%28parameters.numPointLights%29%3B%0A%20%20%20%20array.push%28parameters.numSpotLights%29%3B%0A%20%20%20%20array.push%28parameters.numSpotLightMaps%29%3B%0A%20%20%20%20array.push%28parameters.numHemiLights%29%3B%0A%20%20%20%20array.push%28parameters.numRectAreaLights%29%3B%0A%20%20%20%20array.push%28parameters.numDirLightShadows%29%3B%0A%20%20%20%20array.push%28parameters.numPointLightShadows%29%3B%0A%20%20%20%20array.push%28parameters.numSpotLightShadows%29%3B%0A%20%20%20%20array.push%28parameters.numSpotLightShadowsWithMaps%29%3B%0A%20%20%20%20array.push%28parameters.numLightProbes%29%3B%0A%20%20%20%20array.push%28parameters.shadowMapType%29%3B%0A%20%20%20%20array.push%28parameters.toneMapping%29%3B%0A%20%20%20%20array.push%28parameters.numClippingPlanes%29%3B%0A%20%20%20%20array.push%28parameters.numClipIntersection%29%3B%0A%20%20%20%20array.push%28parameters.depthPacking%29%3B%0A%20%20%7D%0A%20%20function%20getProgramCacheKeyBooleans%28array%2C%20parameters%29%20%7B%0A%20%20%20%20_programLayers.disableAll%28%29%3B%0A%20%20%20%20if%20%28parameters.supportsVertexTextures%29%0A%20%20%20%20%20%20_programLayers.enable%280%29%3B%0A%20%20%20%20if%20%28parameters.instancing%29%0A%20%20%20%20%20%20_programLayers.enable%281%29%3B%0A%20%20%20%20if%20%28parameters.instancingColor%29%0A%20%20%20%20%20%20_programLayers.enable%282%29%3B%0A%20%20%20%20if%20%28parameters.instancingMorph%29%0A%20%20%20%20%20%20_programLayers.enable%283%29%3B%0A%20%20%20%20if%20%28parameters.matcap%29%0A%20%20%20%20%20%20_programLayers.enable%284%29%3B%0A%20%20%20%20if%20%28parameters.envMap%29%0A%20%20%20%20%20%20_programLayers.enable%285%29%3B%0A%20%20%20%20if%20%28parameters.normalMapObjectSpace%29%0A%20%20%20%20%20%20_programLayers.enable%286%29%3B%0A%20%20%20%20if%20%28parameters.normalMapTangentSpace%29%0A%20%20%20%20%20%20_programLayers.enable%287%29%3B%0A%20%20%20%20if%20%28parameters.clearcoat%29%0A%20%20%20%20%20%20_programLayers.enable%288%29%3B%0A%20%20%20%20if%20%28parameters.iridescence%29%0A%20%20%20%20%20%20_programLayers.enable%289%29%3B%0A%20%20%20%20if%20%28parameters.alphaTest%29%0A%20%20%20%20%20%20_programLayers.enable%2810%29%3B%0A%20%20%20%20if%20%28parameters.vertexColors%29%0A%20%20%20%20%20%20_programLayers.enable%2811%29%3B%0A%20%20%20%20if%20%28parameters.vertexAlphas%29%0A%20%20%20%20%20%20_programLayers.enable%2812%29%3B%0A%20%20%20%20if%20%28parameters.vertexUv1s%29%0A%20%20%20%20%20%20_programLayers.enable%2813%29%3B%0A%20%20%20%20if%20%28parameters.vertexUv2s%29%0A%20%20%20%20%20%20_programLayers.enable%2814%29%3B%0A%20%20%20%20if%20%28parameters.vertexUv3s%29%0A%20%20%20%20%20%20_programLayers.enable%2815%29%3B%0A%20%20%20%20if%20%28parameters.vertexTangents%29%0A%20%20%20%20%20%20_programLayers.enable%2816%29%3B%0A%20%20%20%20if%20%28parameters.anisotropy%29%0A%20%20%20%20%20%20_programLayers.enable%2817%29%3B%0A%20%20%20%20if%20%28parameters.alphaHash%29%0A%20%20%20%20%20%20_programLayers.enable%2818%29%3B%0A%20%20%20%20if%20%28parameters.batching%29%0A%20%20%20%20%20%20_programLayers.enable%2819%29%3B%0A%20%20%20%20if%20%28parameters.dispersion%29%0A%20%20%20%20%20%20_programLayers.enable%2820%29%3B%0A%20%20%20%20if%20%28parameters.batchingColor%29%0A%20%20%20%20%20%20_programLayers.enable%2821%29%3B%0A%20%20%20%20array.push%28_programLayers.mask%29%3B%0A%20%20%20%20_programLayers.disableAll%28%29%3B%0A%20%20%20%20if%20%28parameters.fog%29%0A%20%20%20%20%20%20_programLayers.enable%280%29%3B%0A%20%20%20%20if%20%28parameters.useFog%29%0A%20%20%20%20%20%20_programLayers.enable%281%29%3B%0A%20%20%20%20if%20%28parameters.flatShading%29%0A%20%20%20%20%20%20_programLayers.enable%282%29%3B%0A%20%20%20%20if%20%28parameters.logarithmicDepthBuffer%29%0A%20%20%20%20%20%20_programLayers.enable%283%29%3B%0A%20%20%20%20if%20%28parameters.reverseDepthBuffer%29%0A%20%20%20%20%20%20_programLayers.enable%284%29%3B%0A%20%20%20%20if%20%28parameters.skinning%29%0A%20%20%20%20%20%20_programLayers.enable%285%29%3B%0A%20%20%20%20if%20%28parameters.morphTargets%29%0A%20%20%20%20%20%20_programLayers.enable%286%29%3B%0A%20%20%20%20if%20%28parameters.morphNormals%29%0A%20%20%20%20%20%20_programLayers.enable%287%29%3B%0A%20%20%20%20if%20%28parameters.morphColors%29%0A%20%20%20%20%20%20_programLayers.enable%288%29%3B%0A%20%20%20%20if%20%28parameters.premultipliedAlpha%29%0A%20%20%20%20%20%20_programLayers.enable%289%29%3B%0A%20%20%20%20if%20%28parameters.shadowMapEnabled%29%0A%20%20%20%20%20%20_programLayers.enable%2810%29%3B%0A%20%20%20%20if%20%28parameters.doubleSided%29%0A%20%20%20%20%20%20_programLayers.enable%2811%29%3B%0A%20%20%20%20if%20%28parameters.flipSided%29%0A%20%20%20%20%20%20_programLayers.enable%2812%29%3B%0A%20%20%20%20if%20%28parameters.useDepthPacking%29%0A%20%20%20%20%20%20_programLayers.enable%2813%29%3B%0A%20%20%20%20if%20%28parameters.dithering%29%0A%20%20%20%20%20%20_programLayers.enable%2814%29%3B%0A%20%20%20%20if%20%28parameters.transmission%29%0A%20%20%20%20%20%20_programLayers.enable%2815%29%3B%0A%20%20%20%20if%20%28parameters.sheen%29%0A%20%20%20%20%20%20_programLayers.enable%2816%29%3B%0A%20%20%20%20if%20%28parameters.opaque%29%0A%20%20%20%20%20%20_programLayers.enable%2817%29%3B%0A%20%20%20%20if%20%28parameters.pointsUvs%29%0A%20%20%20%20%20%20_programLayers.enable%2818%29%3B%0A%20%20%20%20if%20%28parameters.decodeVideoTexture%29%0A%20%20%20%20%20%20_programLayers.enable%2819%29%3B%0A%20%20%20%20if%20%28parameters.decodeVideoTextureEmissive%29%0A%20%20%20%20%20%20_programLayers.enable%2820%29%3B%0A%20%20%20%20if%20%28parameters.alphaToCoverage%29%0A%20%20%20%20%20%20_programLayers.enable%2821%29%3B%0A%20%20%20%20array.push%28_programLayers.mask%29%3B%0A%20%20%7D%0A%20%20function%20getUniforms%28material%29%20%7B%0A%20%20%20%20const%20shaderID%20%3D%20shaderIDs%5Bmaterial.type%5D%3B%0A%20%20%20%20let%20uniforms%3B%0A%20%20%20%20if%20%28shaderID%29%20%7B%0A%20%20%20%20%20%20const%20shader%20%3D%20ShaderLib%5BshaderID%5D%3B%0A%20%20%20%20%20%20uniforms%20%3D%20UniformsUtils.clone%28shader.uniforms%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20uniforms%20%3D%20material.uniforms%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20uniforms%3B%0A%20%20%7D%0A%20%20function%20acquireProgram%28parameters%2C%20cacheKey%29%20%7B%0A%20%20%20%20let%20program%3B%0A%20%20%20%20for%20%28let%20p%20%3D%200%2C%20pl%20%3D%20programs.length%3B%20p%20%3C%20pl%3B%20p%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20preexistingProgram%20%3D%20programs%5Bp%5D%3B%0A%20%20%20%20%20%20if%20%28preexistingProgram.cacheKey%20%3D%3D%3D%20cacheKey%29%20%7B%0A%20%20%20%20%20%20%20%20program%20%3D%20preexistingProgram%3B%0A%20%20%20%20%20%20%20%20%2B%2Bprogram.usedTimes%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28program%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20program%20%3D%20new%20WebGLProgram%28renderer3%2C%20cacheKey%2C%20parameters%2C%20bindingStates%29%3B%0A%20%20%20%20%20%20programs.push%28program%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20program%3B%0A%20%20%7D%0A%20%20function%20releaseProgram%28program%29%20%7B%0A%20%20%20%20if%20%28--program.usedTimes%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20const%20i%20%3D%20programs.indexOf%28program%29%3B%0A%20%20%20%20%20%20programs%5Bi%5D%20%3D%20programs%5Bprograms.length%20-%201%5D%3B%0A%20%20%20%20%20%20programs.pop%28%29%3B%0A%20%20%20%20%20%20program.destroy%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20releaseShaderCache%28material%29%20%7B%0A%20%20%20%20_customShaders.remove%28material%29%3B%0A%20%20%7D%0A%20%20function%20dispose%28%29%20%7B%0A%20%20%20%20_customShaders.dispose%28%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20getParameters%2C%0A%20%20%20%20getProgramCacheKey%2C%0A%20%20%20%20getUniforms%2C%0A%20%20%20%20acquireProgram%2C%0A%20%20%20%20releaseProgram%2C%0A%20%20%20%20releaseShaderCache%2C%0A%20%20%20%20%2F%2F%20Exposed%20for%20resource%20monitoring%20%26%20error%20feedback%20via%20renderer.info%3A%0A%20%20%20%20programs%2C%0A%20%20%20%20dispose%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLProperties%28%29%20%7B%0A%20%20let%20properties%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20function%20has%28object%29%20%7B%0A%20%20%20%20return%20properties.has%28object%29%3B%0A%20%20%7D%0A%20%20function%20get2%28object%29%20%7B%0A%20%20%20%20let%20map%20%3D%20properties.get%28object%29%3B%0A%20%20%20%20if%20%28map%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20map%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20properties.set%28object%2C%20map%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20map%3B%0A%20%20%7D%0A%20%20function%20remove2%28object%29%20%7B%0A%20%20%20%20properties.delete%28object%29%3B%0A%20%20%7D%0A%20%20function%20update4%28object%2C%20key%2C%20value%29%20%7B%0A%20%20%20%20properties.get%28object%29%5Bkey%5D%20%3D%20value%3B%0A%20%20%7D%0A%20%20function%20dispose%28%29%20%7B%0A%20%20%20%20properties%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20has%2C%0A%20%20%20%20get%3A%20get2%2C%0A%20%20%20%20remove%3A%20remove2%2C%0A%20%20%20%20update%3A%20update4%2C%0A%20%20%20%20dispose%0A%20%20%7D%3B%0A%7D%0Afunction%20painterSortStable%28a2%2C%20b%29%20%7B%0A%20%20if%20%28a2.groupOrder%20%21%3D%3D%20b.groupOrder%29%20%7B%0A%20%20%20%20return%20a2.groupOrder%20-%20b.groupOrder%3B%0A%20%20%7D%20else%20if%20%28a2.renderOrder%20%21%3D%3D%20b.renderOrder%29%20%7B%0A%20%20%20%20return%20a2.renderOrder%20-%20b.renderOrder%3B%0A%20%20%7D%20else%20if%20%28a2.material.id%20%21%3D%3D%20b.material.id%29%20%7B%0A%20%20%20%20return%20a2.material.id%20-%20b.material.id%3B%0A%20%20%7D%20else%20if%20%28a2.z%20%21%3D%3D%20b.z%29%20%7B%0A%20%20%20%20return%20a2.z%20-%20b.z%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20a2.id%20-%20b.id%3B%0A%20%20%7D%0A%7D%0Afunction%20reversePainterSortStable%28a2%2C%20b%29%20%7B%0A%20%20if%20%28a2.groupOrder%20%21%3D%3D%20b.groupOrder%29%20%7B%0A%20%20%20%20return%20a2.groupOrder%20-%20b.groupOrder%3B%0A%20%20%7D%20else%20if%20%28a2.renderOrder%20%21%3D%3D%20b.renderOrder%29%20%7B%0A%20%20%20%20return%20a2.renderOrder%20-%20b.renderOrder%3B%0A%20%20%7D%20else%20if%20%28a2.z%20%21%3D%3D%20b.z%29%20%7B%0A%20%20%20%20return%20b.z%20-%20a2.z%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20a2.id%20-%20b.id%3B%0A%20%20%7D%0A%7D%0Afunction%20WebGLRenderList%28%29%20%7B%0A%20%20const%20renderItems%20%3D%20%5B%5D%3B%0A%20%20let%20renderItemsIndex%20%3D%200%3B%0A%20%20const%20opaque%20%3D%20%5B%5D%3B%0A%20%20const%20transmissive%20%3D%20%5B%5D%3B%0A%20%20const%20transparent%20%3D%20%5B%5D%3B%0A%20%20function%20init4%28%29%20%7B%0A%20%20%20%20renderItemsIndex%20%3D%200%3B%0A%20%20%20%20opaque.length%20%3D%200%3B%0A%20%20%20%20transmissive.length%20%3D%200%3B%0A%20%20%20%20transparent.length%20%3D%200%3B%0A%20%20%7D%0A%20%20function%20getNextRenderItem%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%20%7B%0A%20%20%20%20let%20renderItem%20%3D%20renderItems%5BrenderItemsIndex%5D%3B%0A%20%20%20%20if%20%28renderItem%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20renderItem%20%3D%20%7B%0A%20%20%20%20%20%20%20%20id%3A%20object.id%2C%0A%20%20%20%20%20%20%20%20object%2C%0A%20%20%20%20%20%20%20%20geometry%2C%0A%20%20%20%20%20%20%20%20material%2C%0A%20%20%20%20%20%20%20%20groupOrder%2C%0A%20%20%20%20%20%20%20%20renderOrder%3A%20object.renderOrder%2C%0A%20%20%20%20%20%20%20%20z%3A%20z2%2C%0A%20%20%20%20%20%20%20%20group%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20renderItems%5BrenderItemsIndex%5D%20%3D%20renderItem%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderItem.id%20%3D%20object.id%3B%0A%20%20%20%20%20%20renderItem.object%20%3D%20object%3B%0A%20%20%20%20%20%20renderItem.geometry%20%3D%20geometry%3B%0A%20%20%20%20%20%20renderItem.material%20%3D%20material%3B%0A%20%20%20%20%20%20renderItem.groupOrder%20%3D%20groupOrder%3B%0A%20%20%20%20%20%20renderItem.renderOrder%20%3D%20object.renderOrder%3B%0A%20%20%20%20%20%20renderItem.z%20%3D%20z2%3B%0A%20%20%20%20%20%20renderItem.group%20%3D%20group%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderItemsIndex%2B%2B%3B%0A%20%20%20%20return%20renderItem%3B%0A%20%20%7D%0A%20%20function%20push%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%20%7B%0A%20%20%20%20const%20renderItem%20%3D%20getNextRenderItem%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%3B%0A%20%20%20%20if%20%28material.transmission%20%3E%200%29%20%7B%0A%20%20%20%20%20%20transmissive.push%28renderItem%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.transparent%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20transparent.push%28renderItem%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20opaque.push%28renderItem%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20unshift%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%20%7B%0A%20%20%20%20const%20renderItem%20%3D%20getNextRenderItem%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%3B%0A%20%20%20%20if%20%28material.transmission%20%3E%200%29%20%7B%0A%20%20%20%20%20%20transmissive.unshift%28renderItem%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.transparent%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20transparent.unshift%28renderItem%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20opaque.unshift%28renderItem%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20sort%28customOpaqueSort%2C%20customTransparentSort%29%20%7B%0A%20%20%20%20if%20%28opaque.length%20%3E%201%29%20opaque.sort%28customOpaqueSort%20%7C%7C%20painterSortStable%29%3B%0A%20%20%20%20if%20%28transmissive.length%20%3E%201%29%20transmissive.sort%28customTransparentSort%20%7C%7C%20reversePainterSortStable%29%3B%0A%20%20%20%20if%20%28transparent.length%20%3E%201%29%20transparent.sort%28customTransparentSort%20%7C%7C%20reversePainterSortStable%29%3B%0A%20%20%7D%0A%20%20function%20finish%28%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%20renderItemsIndex%2C%20il%20%3D%20renderItems.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20renderItem%20%3D%20renderItems%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28renderItem.id%20%3D%3D%3D%20null%29%20break%3B%0A%20%20%20%20%20%20renderItem.id%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.object%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.geometry%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.material%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.group%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20opaque%2C%0A%20%20%20%20transmissive%2C%0A%20%20%20%20transparent%2C%0A%20%20%20%20init%3A%20init4%2C%0A%20%20%20%20push%2C%0A%20%20%20%20unshift%2C%0A%20%20%20%20finish%2C%0A%20%20%20%20sort%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLRenderLists%28%29%20%7B%0A%20%20let%20lists%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20function%20get2%28scene3%2C%20renderCallDepth%29%20%7B%0A%20%20%20%20const%20listArray%20%3D%20lists.get%28scene3%29%3B%0A%20%20%20%20let%20list%3B%0A%20%20%20%20if%20%28listArray%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20list%20%3D%20new%20WebGLRenderList%28%29%3B%0A%20%20%20%20%20%20lists.set%28scene3%2C%20%5Blist%5D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28renderCallDepth%20%3E%3D%20listArray.length%29%20%7B%0A%20%20%20%20%20%20%20%20list%20%3D%20new%20WebGLRenderList%28%29%3B%0A%20%20%20%20%20%20%20%20listArray.push%28list%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20list%20%3D%20listArray%5BrenderCallDepth%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20list%3B%0A%20%20%7D%0A%20%20function%20dispose%28%29%20%7B%0A%20%20%20%20lists%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20get%3A%20get2%2C%0A%20%20%20%20dispose%0A%20%20%7D%3B%0A%7D%0Afunction%20UniformsCache%28%29%20%7B%0A%20%20const%20lights%20%3D%20%7B%7D%3B%0A%20%20return%20%7B%0A%20%20%20%20get%3A%20function%28light%29%20%7B%0A%20%20%20%20%20%20if%20%28lights%5Blight.id%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20lights%5Blight.id%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20uniforms%3B%0A%20%20%20%20%20%20switch%20%28light.type%29%20%7B%0A%20%20%20%20%20%20%20%20case%20%22DirectionalLight%22%3A%0A%20%20%20%20%20%20%20%20%20%20uniforms%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20direction%3A%20new%20Vector3%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20new%20Color%28%29%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22SpotLight%22%3A%0A%20%20%20%20%20%20%20%20%20%20uniforms%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20new%20Vector3%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20direction%3A%20new%20Vector3%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20new%20Color%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20distance%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20coneCos%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20penumbraCos%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20decay%3A%200%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22PointLight%22%3A%0A%20%20%20%20%20%20%20%20%20%20uniforms%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20new%20Vector3%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20new%20Color%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20distance%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20decay%3A%200%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22HemisphereLight%22%3A%0A%20%20%20%20%20%20%20%20%20%20uniforms%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20direction%3A%20new%20Vector3%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20skyColor%3A%20new%20Color%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20groundColor%3A%20new%20Color%28%29%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22RectAreaLight%22%3A%0A%20%20%20%20%20%20%20%20%20%20uniforms%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20new%20Color%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20new%20Vector3%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20halfWidth%3A%20new%20Vector3%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20halfHeight%3A%20new%20Vector3%28%29%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20lights%5Blight.id%5D%20%3D%20uniforms%3B%0A%20%20%20%20%20%20return%20uniforms%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0Afunction%20ShadowUniformsCache%28%29%20%7B%0A%20%20const%20lights%20%3D%20%7B%7D%3B%0A%20%20return%20%7B%0A%20%20%20%20get%3A%20function%28light%29%20%7B%0A%20%20%20%20%20%20if%20%28lights%5Blight.id%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20lights%5Blight.id%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20uniforms%3B%0A%20%20%20%20%20%20switch%20%28light.type%29%20%7B%0A%20%20%20%20%20%20%20%20case%20%22DirectionalLight%22%3A%0A%20%20%20%20%20%20%20%20%20%20uniforms%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowIntensity%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowBias%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowNormalBias%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowRadius%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowMapSize%3A%20new%20Vector2%28%29%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22SpotLight%22%3A%0A%20%20%20%20%20%20%20%20%20%20uniforms%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowIntensity%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowBias%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowNormalBias%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowRadius%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowMapSize%3A%20new%20Vector2%28%29%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22PointLight%22%3A%0A%20%20%20%20%20%20%20%20%20%20uniforms%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowIntensity%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowBias%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowNormalBias%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowRadius%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowMapSize%3A%20new%20Vector2%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowCameraNear%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shadowCameraFar%3A%201e3%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20lights%5Blight.id%5D%20%3D%20uniforms%3B%0A%20%20%20%20%20%20return%20uniforms%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0Avar%20nextVersion%20%3D%200%3B%0Afunction%20shadowCastingAndTexturingLightsFirst%28lightA%2C%20lightB%29%20%7B%0A%20%20return%20%28lightB.castShadow%20%3F%202%20%3A%200%29%20-%20%28lightA.castShadow%20%3F%202%20%3A%200%29%20%2B%20%28lightB.map%20%3F%201%20%3A%200%29%20-%20%28lightA.map%20%3F%201%20%3A%200%29%3B%0A%7D%0Afunction%20WebGLLights%28extensions%29%20%7B%0A%20%20const%20cache2%20%3D%20new%20UniformsCache%28%29%3B%0A%20%20const%20shadowCache%20%3D%20ShadowUniformsCache%28%29%3B%0A%20%20const%20state%20%3D%20%7B%0A%20%20%20%20version%3A%200%2C%0A%20%20%20%20hash%3A%20%7B%0A%20%20%20%20%20%20directionalLength%3A%20-1%2C%0A%20%20%20%20%20%20pointLength%3A%20-1%2C%0A%20%20%20%20%20%20spotLength%3A%20-1%2C%0A%20%20%20%20%20%20rectAreaLength%3A%20-1%2C%0A%20%20%20%20%20%20hemiLength%3A%20-1%2C%0A%20%20%20%20%20%20numDirectionalShadows%3A%20-1%2C%0A%20%20%20%20%20%20numPointShadows%3A%20-1%2C%0A%20%20%20%20%20%20numSpotShadows%3A%20-1%2C%0A%20%20%20%20%20%20numSpotMaps%3A%20-1%2C%0A%20%20%20%20%20%20numLightProbes%3A%20-1%0A%20%20%20%20%7D%2C%0A%20%20%20%20ambient%3A%20%5B0%2C%200%2C%200%5D%2C%0A%20%20%20%20probe%3A%20%5B%5D%2C%0A%20%20%20%20directional%3A%20%5B%5D%2C%0A%20%20%20%20directionalShadow%3A%20%5B%5D%2C%0A%20%20%20%20directionalShadowMap%3A%20%5B%5D%2C%0A%20%20%20%20directionalShadowMatrix%3A%20%5B%5D%2C%0A%20%20%20%20spot%3A%20%5B%5D%2C%0A%20%20%20%20spotLightMap%3A%20%5B%5D%2C%0A%20%20%20%20spotShadow%3A%20%5B%5D%2C%0A%20%20%20%20spotShadowMap%3A%20%5B%5D%2C%0A%20%20%20%20spotLightMatrix%3A%20%5B%5D%2C%0A%20%20%20%20rectArea%3A%20%5B%5D%2C%0A%20%20%20%20rectAreaLTC1%3A%20null%2C%0A%20%20%20%20rectAreaLTC2%3A%20null%2C%0A%20%20%20%20point%3A%20%5B%5D%2C%0A%20%20%20%20pointShadow%3A%20%5B%5D%2C%0A%20%20%20%20pointShadowMap%3A%20%5B%5D%2C%0A%20%20%20%20pointShadowMatrix%3A%20%5B%5D%2C%0A%20%20%20%20hemi%3A%20%5B%5D%2C%0A%20%20%20%20numSpotLightShadowsWithMaps%3A%200%2C%0A%20%20%20%20numLightProbes%3A%200%0A%20%20%7D%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20state.probe.push%28new%20Vector3%28%29%29%3B%0A%20%20const%20vector3%20%3D%20new%20Vector3%28%29%3B%0A%20%20const%20matrix4%20%3D%20new%20Matrix4%28%29%3B%0A%20%20const%20matrix42%20%3D%20new%20Matrix4%28%29%3B%0A%20%20function%20setup%28lights%29%20%7B%0A%20%20%20%20let%20r%20%3D%200%2C%20g%20%3D%200%2C%20b%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20state.probe%5Bi%5D.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20let%20directionalLength%20%3D%200%3B%0A%20%20%20%20let%20pointLength%20%3D%200%3B%0A%20%20%20%20let%20spotLength%20%3D%200%3B%0A%20%20%20%20let%20rectAreaLength%20%3D%200%3B%0A%20%20%20%20let%20hemiLength%20%3D%200%3B%0A%20%20%20%20let%20numDirectionalShadows%20%3D%200%3B%0A%20%20%20%20let%20numPointShadows%20%3D%200%3B%0A%20%20%20%20let%20numSpotShadows%20%3D%200%3B%0A%20%20%20%20let%20numSpotMaps%20%3D%200%3B%0A%20%20%20%20let%20numSpotShadowsWithMaps%20%3D%200%3B%0A%20%20%20%20let%20numLightProbes%20%3D%200%3B%0A%20%20%20%20lights.sort%28shadowCastingAndTexturingLightsFirst%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20lights.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20light%20%3D%20lights%5Bi%5D%3B%0A%20%20%20%20%20%20const%20color2%20%3D%20light.color%3B%0A%20%20%20%20%20%20const%20intensity%20%3D%20light.intensity%3B%0A%20%20%20%20%20%20const%20distance2%20%3D%20light.distance%3B%0A%20%20%20%20%20%20const%20shadowMap%20%3D%20light.shadow%20%26%26%20light.shadow.map%20%3F%20light.shadow.map.texture%20%3A%20null%3B%0A%20%20%20%20%20%20if%20%28light.isAmbientLight%29%20%7B%0A%20%20%20%20%20%20%20%20r%20%2B%3D%20color2.r%20%2A%20intensity%3B%0A%20%20%20%20%20%20%20%20g%20%2B%3D%20color2.g%20%2A%20intensity%3B%0A%20%20%20%20%20%20%20%20b%20%2B%3D%20color2.b%20%2A%20intensity%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isLightProbe%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%209%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.probe%5Bj%5D.addScaledVector%28light.sh.coefficients%5Bj%5D%2C%20intensity%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20numLightProbes%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isDirectionalLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20cache2.get%28light%29%3B%0A%20%20%20%20%20%20%20%20uniforms.color.copy%28light.color%29.multiplyScalar%28light.intensity%29%3B%0A%20%20%20%20%20%20%20%20if%20%28light.castShadow%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20shadow2%20%3D%20light.shadow%3B%0A%20%20%20%20%20%20%20%20%20%20const%20shadowUniforms%20%3D%20shadowCache.get%28light%29%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowIntensity%20%3D%20shadow2.intensity%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowBias%20%3D%20shadow2.bias%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowNormalBias%20%3D%20shadow2.normalBias%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowRadius%20%3D%20shadow2.radius%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowMapSize%20%3D%20shadow2.mapSize%3B%0A%20%20%20%20%20%20%20%20%20%20state.directionalShadow%5BdirectionalLength%5D%20%3D%20shadowUniforms%3B%0A%20%20%20%20%20%20%20%20%20%20state.directionalShadowMap%5BdirectionalLength%5D%20%3D%20shadowMap%3B%0A%20%20%20%20%20%20%20%20%20%20state.directionalShadowMatrix%5BdirectionalLength%5D%20%3D%20light.shadow.matrix%3B%0A%20%20%20%20%20%20%20%20%20%20numDirectionalShadows%2B%2B%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.directional%5BdirectionalLength%5D%20%3D%20uniforms%3B%0A%20%20%20%20%20%20%20%20directionalLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isSpotLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20cache2.get%28light%29%3B%0A%20%20%20%20%20%20%20%20uniforms.position.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20uniforms.color.copy%28color2%29.multiplyScalar%28intensity%29%3B%0A%20%20%20%20%20%20%20%20uniforms.distance%20%3D%20distance2%3B%0A%20%20%20%20%20%20%20%20uniforms.coneCos%20%3D%20Math.cos%28light.angle%29%3B%0A%20%20%20%20%20%20%20%20uniforms.penumbraCos%20%3D%20Math.cos%28light.angle%20%2A%20%281%20-%20light.penumbra%29%29%3B%0A%20%20%20%20%20%20%20%20uniforms.decay%20%3D%20light.decay%3B%0A%20%20%20%20%20%20%20%20state.spot%5BspotLength%5D%20%3D%20uniforms%3B%0A%20%20%20%20%20%20%20%20const%20shadow2%20%3D%20light.shadow%3B%0A%20%20%20%20%20%20%20%20if%20%28light.map%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.spotLightMap%5BnumSpotMaps%5D%20%3D%20light.map%3B%0A%20%20%20%20%20%20%20%20%20%20numSpotMaps%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20shadow2.updateMatrices%28light%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28light.castShadow%29%20numSpotShadowsWithMaps%2B%2B%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.spotLightMatrix%5BspotLength%5D%20%3D%20shadow2.matrix%3B%0A%20%20%20%20%20%20%20%20if%20%28light.castShadow%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20shadowUniforms%20%3D%20shadowCache.get%28light%29%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowIntensity%20%3D%20shadow2.intensity%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowBias%20%3D%20shadow2.bias%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowNormalBias%20%3D%20shadow2.normalBias%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowRadius%20%3D%20shadow2.radius%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowMapSize%20%3D%20shadow2.mapSize%3B%0A%20%20%20%20%20%20%20%20%20%20state.spotShadow%5BspotLength%5D%20%3D%20shadowUniforms%3B%0A%20%20%20%20%20%20%20%20%20%20state.spotShadowMap%5BspotLength%5D%20%3D%20shadowMap%3B%0A%20%20%20%20%20%20%20%20%20%20numSpotShadows%2B%2B%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20spotLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isRectAreaLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20cache2.get%28light%29%3B%0A%20%20%20%20%20%20%20%20uniforms.color.copy%28color2%29.multiplyScalar%28intensity%29%3B%0A%20%20%20%20%20%20%20%20uniforms.halfWidth.set%28light.width%20%2A%200.5%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20uniforms.halfHeight.set%280%2C%20light.height%20%2A%200.5%2C%200%29%3B%0A%20%20%20%20%20%20%20%20state.rectArea%5BrectAreaLength%5D%20%3D%20uniforms%3B%0A%20%20%20%20%20%20%20%20rectAreaLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isPointLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20cache2.get%28light%29%3B%0A%20%20%20%20%20%20%20%20uniforms.color.copy%28light.color%29.multiplyScalar%28light.intensity%29%3B%0A%20%20%20%20%20%20%20%20uniforms.distance%20%3D%20light.distance%3B%0A%20%20%20%20%20%20%20%20uniforms.decay%20%3D%20light.decay%3B%0A%20%20%20%20%20%20%20%20if%20%28light.castShadow%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20shadow2%20%3D%20light.shadow%3B%0A%20%20%20%20%20%20%20%20%20%20const%20shadowUniforms%20%3D%20shadowCache.get%28light%29%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowIntensity%20%3D%20shadow2.intensity%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowBias%20%3D%20shadow2.bias%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowNormalBias%20%3D%20shadow2.normalBias%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowRadius%20%3D%20shadow2.radius%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowMapSize%20%3D%20shadow2.mapSize%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowCameraNear%20%3D%20shadow2.camera.near%3B%0A%20%20%20%20%20%20%20%20%20%20shadowUniforms.shadowCameraFar%20%3D%20shadow2.camera.far%3B%0A%20%20%20%20%20%20%20%20%20%20state.pointShadow%5BpointLength%5D%20%3D%20shadowUniforms%3B%0A%20%20%20%20%20%20%20%20%20%20state.pointShadowMap%5BpointLength%5D%20%3D%20shadowMap%3B%0A%20%20%20%20%20%20%20%20%20%20state.pointShadowMatrix%5BpointLength%5D%20%3D%20light.shadow.matrix%3B%0A%20%20%20%20%20%20%20%20%20%20numPointShadows%2B%2B%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.point%5BpointLength%5D%20%3D%20uniforms%3B%0A%20%20%20%20%20%20%20%20pointLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isHemisphereLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20cache2.get%28light%29%3B%0A%20%20%20%20%20%20%20%20uniforms.skyColor.copy%28light.color%29.multiplyScalar%28intensity%29%3B%0A%20%20%20%20%20%20%20%20uniforms.groundColor.copy%28light.groundColor%29.multiplyScalar%28intensity%29%3B%0A%20%20%20%20%20%20%20%20state.hemi%5BhemiLength%5D%20%3D%20uniforms%3B%0A%20%20%20%20%20%20%20%20hemiLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28rectAreaLength%20%3E%200%29%20%7B%0A%20%20%20%20%20%20if%20%28extensions.has%28%22OES_texture_float_linear%22%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20state.rectAreaLTC1%20%3D%20UniformsLib.LTC_FLOAT_1%3B%0A%20%20%20%20%20%20%20%20state.rectAreaLTC2%20%3D%20UniformsLib.LTC_FLOAT_2%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20state.rectAreaLTC1%20%3D%20UniformsLib.LTC_HALF_1%3B%0A%20%20%20%20%20%20%20%20state.rectAreaLTC2%20%3D%20UniformsLib.LTC_HALF_2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20state.ambient%5B0%5D%20%3D%20r%3B%0A%20%20%20%20state.ambient%5B1%5D%20%3D%20g%3B%0A%20%20%20%20state.ambient%5B2%5D%20%3D%20b%3B%0A%20%20%20%20const%20hash%20%3D%20state.hash%3B%0A%20%20%20%20if%20%28hash.directionalLength%20%21%3D%3D%20directionalLength%20%7C%7C%20hash.pointLength%20%21%3D%3D%20pointLength%20%7C%7C%20hash.spotLength%20%21%3D%3D%20spotLength%20%7C%7C%20hash.rectAreaLength%20%21%3D%3D%20rectAreaLength%20%7C%7C%20hash.hemiLength%20%21%3D%3D%20hemiLength%20%7C%7C%20hash.numDirectionalShadows%20%21%3D%3D%20numDirectionalShadows%20%7C%7C%20hash.numPointShadows%20%21%3D%3D%20numPointShadows%20%7C%7C%20hash.numSpotShadows%20%21%3D%3D%20numSpotShadows%20%7C%7C%20hash.numSpotMaps%20%21%3D%3D%20numSpotMaps%20%7C%7C%20hash.numLightProbes%20%21%3D%3D%20numLightProbes%29%20%7B%0A%20%20%20%20%20%20state.directional.length%20%3D%20directionalLength%3B%0A%20%20%20%20%20%20state.spot.length%20%3D%20spotLength%3B%0A%20%20%20%20%20%20state.rectArea.length%20%3D%20rectAreaLength%3B%0A%20%20%20%20%20%20state.point.length%20%3D%20pointLength%3B%0A%20%20%20%20%20%20state.hemi.length%20%3D%20hemiLength%3B%0A%20%20%20%20%20%20state.directionalShadow.length%20%3D%20numDirectionalShadows%3B%0A%20%20%20%20%20%20state.directionalShadowMap.length%20%3D%20numDirectionalShadows%3B%0A%20%20%20%20%20%20state.pointShadow.length%20%3D%20numPointShadows%3B%0A%20%20%20%20%20%20state.pointShadowMap.length%20%3D%20numPointShadows%3B%0A%20%20%20%20%20%20state.spotShadow.length%20%3D%20numSpotShadows%3B%0A%20%20%20%20%20%20state.spotShadowMap.length%20%3D%20numSpotShadows%3B%0A%20%20%20%20%20%20state.directionalShadowMatrix.length%20%3D%20numDirectionalShadows%3B%0A%20%20%20%20%20%20state.pointShadowMatrix.length%20%3D%20numPointShadows%3B%0A%20%20%20%20%20%20state.spotLightMatrix.length%20%3D%20numSpotShadows%20%2B%20numSpotMaps%20-%20numSpotShadowsWithMaps%3B%0A%20%20%20%20%20%20state.spotLightMap.length%20%3D%20numSpotMaps%3B%0A%20%20%20%20%20%20state.numSpotLightShadowsWithMaps%20%3D%20numSpotShadowsWithMaps%3B%0A%20%20%20%20%20%20state.numLightProbes%20%3D%20numLightProbes%3B%0A%20%20%20%20%20%20hash.directionalLength%20%3D%20directionalLength%3B%0A%20%20%20%20%20%20hash.pointLength%20%3D%20pointLength%3B%0A%20%20%20%20%20%20hash.spotLength%20%3D%20spotLength%3B%0A%20%20%20%20%20%20hash.rectAreaLength%20%3D%20rectAreaLength%3B%0A%20%20%20%20%20%20hash.hemiLength%20%3D%20hemiLength%3B%0A%20%20%20%20%20%20hash.numDirectionalShadows%20%3D%20numDirectionalShadows%3B%0A%20%20%20%20%20%20hash.numPointShadows%20%3D%20numPointShadows%3B%0A%20%20%20%20%20%20hash.numSpotShadows%20%3D%20numSpotShadows%3B%0A%20%20%20%20%20%20hash.numSpotMaps%20%3D%20numSpotMaps%3B%0A%20%20%20%20%20%20hash.numLightProbes%20%3D%20numLightProbes%3B%0A%20%20%20%20%20%20state.version%20%3D%20nextVersion%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20setupView%28lights%2C%20camera3%29%20%7B%0A%20%20%20%20let%20directionalLength%20%3D%200%3B%0A%20%20%20%20let%20pointLength%20%3D%200%3B%0A%20%20%20%20let%20spotLength%20%3D%200%3B%0A%20%20%20%20let%20rectAreaLength%20%3D%200%3B%0A%20%20%20%20let%20hemiLength%20%3D%200%3B%0A%20%20%20%20const%20viewMatrix%20%3D%20camera3.matrixWorldInverse%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20lights.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20light%20%3D%20lights%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28light.isDirectionalLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20state.directional%5BdirectionalLength%5D%3B%0A%20%20%20%20%20%20%20%20uniforms.direction.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20vector3.setFromMatrixPosition%28light.target.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20uniforms.direction.sub%28vector3%29%3B%0A%20%20%20%20%20%20%20%20uniforms.direction.transformDirection%28viewMatrix%29%3B%0A%20%20%20%20%20%20%20%20directionalLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isSpotLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20state.spot%5BspotLength%5D%3B%0A%20%20%20%20%20%20%20%20uniforms.position.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20uniforms.position.applyMatrix4%28viewMatrix%29%3B%0A%20%20%20%20%20%20%20%20uniforms.direction.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20vector3.setFromMatrixPosition%28light.target.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20uniforms.direction.sub%28vector3%29%3B%0A%20%20%20%20%20%20%20%20uniforms.direction.transformDirection%28viewMatrix%29%3B%0A%20%20%20%20%20%20%20%20spotLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isRectAreaLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20state.rectArea%5BrectAreaLength%5D%3B%0A%20%20%20%20%20%20%20%20uniforms.position.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20uniforms.position.applyMatrix4%28viewMatrix%29%3B%0A%20%20%20%20%20%20%20%20matrix42.identity%28%29%3B%0A%20%20%20%20%20%20%20%20matrix4.copy%28light.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20matrix4.premultiply%28viewMatrix%29%3B%0A%20%20%20%20%20%20%20%20matrix42.extractRotation%28matrix4%29%3B%0A%20%20%20%20%20%20%20%20uniforms.halfWidth.set%28light.width%20%2A%200.5%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20uniforms.halfHeight.set%280%2C%20light.height%20%2A%200.5%2C%200%29%3B%0A%20%20%20%20%20%20%20%20uniforms.halfWidth.applyMatrix4%28matrix42%29%3B%0A%20%20%20%20%20%20%20%20uniforms.halfHeight.applyMatrix4%28matrix42%29%3B%0A%20%20%20%20%20%20%20%20rectAreaLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isPointLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20state.point%5BpointLength%5D%3B%0A%20%20%20%20%20%20%20%20uniforms.position.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20uniforms.position.applyMatrix4%28viewMatrix%29%3B%0A%20%20%20%20%20%20%20%20pointLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28light.isHemisphereLight%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20state.hemi%5BhemiLength%5D%3B%0A%20%20%20%20%20%20%20%20uniforms.direction.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20uniforms.direction.transformDirection%28viewMatrix%29%3B%0A%20%20%20%20%20%20%20%20hemiLength%2B%2B%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20setup%2C%0A%20%20%20%20setupView%2C%0A%20%20%20%20state%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLRenderState%28extensions%29%20%7B%0A%20%20const%20lights%20%3D%20new%20WebGLLights%28extensions%29%3B%0A%20%20const%20lightsArray%20%3D%20%5B%5D%3B%0A%20%20const%20shadowsArray%20%3D%20%5B%5D%3B%0A%20%20function%20init4%28camera3%29%20%7B%0A%20%20%20%20state.camera%20%3D%20camera3%3B%0A%20%20%20%20lightsArray.length%20%3D%200%3B%0A%20%20%20%20shadowsArray.length%20%3D%200%3B%0A%20%20%7D%0A%20%20function%20pushLight%28light%29%20%7B%0A%20%20%20%20lightsArray.push%28light%29%3B%0A%20%20%7D%0A%20%20function%20pushShadow%28shadowLight%29%20%7B%0A%20%20%20%20shadowsArray.push%28shadowLight%29%3B%0A%20%20%7D%0A%20%20function%20setupLights%28%29%20%7B%0A%20%20%20%20lights.setup%28lightsArray%29%3B%0A%20%20%7D%0A%20%20function%20setupLightsView%28camera3%29%20%7B%0A%20%20%20%20lights.setupView%28lightsArray%2C%20camera3%29%3B%0A%20%20%7D%0A%20%20const%20state%20%3D%20%7B%0A%20%20%20%20lightsArray%2C%0A%20%20%20%20shadowsArray%2C%0A%20%20%20%20camera%3A%20null%2C%0A%20%20%20%20lights%2C%0A%20%20%20%20transmissionRenderTarget%3A%20%7B%7D%0A%20%20%7D%3B%0A%20%20return%20%7B%0A%20%20%20%20init%3A%20init4%2C%0A%20%20%20%20state%2C%0A%20%20%20%20setupLights%2C%0A%20%20%20%20setupLightsView%2C%0A%20%20%20%20pushLight%2C%0A%20%20%20%20pushShadow%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLRenderStates%28extensions%29%20%7B%0A%20%20let%20renderStates%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20function%20get2%28scene3%2C%20renderCallDepth%20%3D%200%29%20%7B%0A%20%20%20%20const%20renderStateArray%20%3D%20renderStates.get%28scene3%29%3B%0A%20%20%20%20let%20renderState%3B%0A%20%20%20%20if%20%28renderStateArray%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20renderState%20%3D%20new%20WebGLRenderState%28extensions%29%3B%0A%20%20%20%20%20%20renderStates.set%28scene3%2C%20%5BrenderState%5D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28renderCallDepth%20%3E%3D%20renderStateArray.length%29%20%7B%0A%20%20%20%20%20%20%20%20renderState%20%3D%20new%20WebGLRenderState%28extensions%29%3B%0A%20%20%20%20%20%20%20%20renderStateArray.push%28renderState%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20renderState%20%3D%20renderStateArray%5BrenderCallDepth%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20renderState%3B%0A%20%20%7D%0A%20%20function%20dispose%28%29%20%7B%0A%20%20%20%20renderStates%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20get%3A%20get2%2C%0A%20%20%20%20dispose%0A%20%20%7D%3B%0A%7D%0Avar%20MeshDepthMaterial%20%3D%20class%20extends%20Material%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshDepthMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshDepthMaterial%20%3D%20true%3B%0A%20%20%20%20this.depthPacking%20%3D%20BasicDepthPacking%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.displacementMap%20%3D%20null%3B%0A%20%20%20%20this.displacementScale%20%3D%201%3B%0A%20%20%20%20this.displacementBias%20%3D%200%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.depthPacking%20%3D%20source.depthPacking%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.displacementMap%20%3D%20source.displacementMap%3B%0A%20%20%20%20this.displacementScale%20%3D%20source.displacementScale%3B%0A%20%20%20%20this.displacementBias%20%3D%20source.displacementBias%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshDistanceMaterial%20%3D%20class%20extends%20Material%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshDistanceMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshDistanceMaterial%20%3D%20true%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.displacementMap%20%3D%20null%3B%0A%20%20%20%20this.displacementScale%20%3D%201%3B%0A%20%20%20%20this.displacementBias%20%3D%200%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.displacementMap%20%3D%20source.displacementMap%3B%0A%20%20%20%20this.displacementScale%20%3D%20source.displacementScale%3B%0A%20%20%20%20this.displacementBias%20%3D%20source.displacementBias%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20vertex%20%3D%20%22void%20main%28%29%20%7B%5Cn%09gl_Position%20%3D%20vec4%28%20position%2C%201.0%20%29%3B%5Cn%7D%22%3B%0Avar%20fragment%20%3D%20%22uniform%20sampler2D%20shadow_pass%3B%5Cnuniform%20vec2%20resolution%3B%5Cnuniform%20float%20radius%3B%5Cn%23include%20%3Cpacking%3E%5Cnvoid%20main%28%29%20%7B%5Cn%09const%20float%20samples%20%3D%20float%28%20VSM_SAMPLES%20%29%3B%5Cn%09float%20mean%20%3D%200.0%3B%5Cn%09float%20squared_mean%20%3D%200.0%3B%5Cn%09float%20uvStride%20%3D%20samples%20%3C%3D%201.0%20%3F%200.0%20%3A%202.0%20%2F%20%28%20samples%20-%201.0%20%29%3B%5Cn%09float%20uvStart%20%3D%20samples%20%3C%3D%201.0%20%3F%200.0%20%3A%20-%201.0%3B%5Cn%09for%20%28%20float%20i%20%3D%200.0%3B%20i%20%3C%20samples%3B%20i%20%2B%2B%20%29%20%7B%5Cn%09%09float%20uvOffset%20%3D%20uvStart%20%2B%20i%20%2A%20uvStride%3B%5Cn%09%09%23ifdef%20HORIZONTAL_PASS%5Cn%09%09%09vec2%20distribution%20%3D%20unpackRGBATo2Half%28%20texture2D%28%20shadow_pass%2C%20%28%20gl_FragCoord.xy%20%2B%20vec2%28%20uvOffset%2C%200.0%20%29%20%2A%20radius%20%29%20%2F%20resolution%20%29%20%29%3B%5Cn%09%09%09mean%20%2B%3D%20distribution.x%3B%5Cn%09%09%09squared_mean%20%2B%3D%20distribution.y%20%2A%20distribution.y%20%2B%20distribution.x%20%2A%20distribution.x%3B%5Cn%09%09%23else%5Cn%09%09%09float%20depth%20%3D%20unpackRGBAToDepth%28%20texture2D%28%20shadow_pass%2C%20%28%20gl_FragCoord.xy%20%2B%20vec2%28%200.0%2C%20uvOffset%20%29%20%2A%20radius%20%29%20%2F%20resolution%20%29%20%29%3B%5Cn%09%09%09mean%20%2B%3D%20depth%3B%5Cn%09%09%09squared_mean%20%2B%3D%20depth%20%2A%20depth%3B%5Cn%09%09%23endif%5Cn%09%7D%5Cn%09mean%20%3D%20mean%20%2F%20samples%3B%5Cn%09squared_mean%20%3D%20squared_mean%20%2F%20samples%3B%5Cn%09float%20std_dev%20%3D%20sqrt%28%20squared_mean%20-%20mean%20%2A%20mean%20%29%3B%5Cn%09gl_FragColor%20%3D%20pack2HalfToRGBA%28%20vec2%28%20mean%2C%20std_dev%20%29%20%29%3B%5Cn%7D%22%3B%0Afunction%20WebGLShadowMap%28renderer3%2C%20objects%2C%20capabilities%29%20%7B%0A%20%20let%20_frustum2%20%3D%20new%20Frustum%28%29%3B%0A%20%20const%20_shadowMapSize%20%3D%20new%20Vector2%28%29%2C%20_viewportSize%20%3D%20new%20Vector2%28%29%2C%20_viewport%20%3D%20new%20Vector4%28%29%2C%20_depthMaterial%20%3D%20new%20MeshDepthMaterial%28%7B%20depthPacking%3A%20RGBADepthPacking%20%7D%29%2C%20_distanceMaterial%20%3D%20new%20MeshDistanceMaterial%28%29%2C%20_materialCache%20%3D%20%7B%7D%2C%20_maxTextureSize%20%3D%20capabilities.maxTextureSize%3B%0A%20%20const%20shadowSide%20%3D%20%7B%20%5BFrontSide%5D%3A%20BackSide%2C%20%5BBackSide%5D%3A%20FrontSide%2C%20%5BDoubleSide%5D%3A%20DoubleSide%20%7D%3B%0A%20%20const%20shadowMaterialVertical%20%3D%20new%20ShaderMaterial%28%7B%0A%20%20%20%20defines%3A%20%7B%0A%20%20%20%20%20%20VSM_SAMPLES%3A%208%0A%20%20%20%20%7D%2C%0A%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20shadow_pass%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%20%20resolution%3A%20%7B%20value%3A%20new%20Vector2%28%29%20%7D%2C%0A%20%20%20%20%20%20radius%3A%20%7B%20value%3A%204%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20vertexShader%3A%20vertex%2C%0A%20%20%20%20fragmentShader%3A%20fragment%0A%20%20%7D%29%3B%0A%20%20const%20shadowMaterialHorizontal%20%3D%20shadowMaterialVertical.clone%28%29%3B%0A%20%20shadowMaterialHorizontal.defines.HORIZONTAL_PASS%20%3D%201%3B%0A%20%20const%20fullScreenTri%20%3D%20new%20BufferGeometry%28%29%3B%0A%20%20fullScreenTri.setAttribute%28%0A%20%20%20%20%22position%22%2C%0A%20%20%20%20new%20BufferAttribute%28%0A%20%20%20%20%20%20new%20Float32Array%28%5B-1%2C%20-1%2C%200.5%2C%203%2C%20-1%2C%200.5%2C%20-1%2C%203%2C%200.5%5D%29%2C%0A%20%20%20%20%20%203%0A%20%20%20%20%29%0A%20%20%29%3B%0A%20%20const%20fullScreenMesh%20%3D%20new%20Mesh%28fullScreenTri%2C%20shadowMaterialVertical%29%3B%0A%20%20const%20scope%20%3D%20this%3B%0A%20%20this.enabled%20%3D%20false%3B%0A%20%20this.autoUpdate%20%3D%20true%3B%0A%20%20this.needsUpdate%20%3D%20false%3B%0A%20%20this.type%20%3D%20PCFShadowMap%3B%0A%20%20let%20_previousType%20%3D%20this.type%3B%0A%20%20this.render%20%3D%20function%28lights%2C%20scene3%2C%20camera3%29%20%7B%0A%20%20%20%20if%20%28scope.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20if%20%28scope.autoUpdate%20%3D%3D%3D%20false%20%26%26%20scope.needsUpdate%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20if%20%28lights.length%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20const%20currentRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20const%20activeCubeFace%20%3D%20renderer3.getActiveCubeFace%28%29%3B%0A%20%20%20%20const%20activeMipmapLevel%20%3D%20renderer3.getActiveMipmapLevel%28%29%3B%0A%20%20%20%20const%20_state%20%3D%20renderer3.state%3B%0A%20%20%20%20_state.setBlending%28NoBlending%29%3B%0A%20%20%20%20_state.buffers.color.setClear%281%2C%201%2C%201%2C%201%29%3B%0A%20%20%20%20_state.buffers.depth.setTest%28true%29%3B%0A%20%20%20%20_state.setScissorTest%28false%29%3B%0A%20%20%20%20const%20toVSM%20%3D%20_previousType%20%21%3D%3D%20VSMShadowMap%20%26%26%20this.type%20%3D%3D%3D%20VSMShadowMap%3B%0A%20%20%20%20const%20fromVSM%20%3D%20_previousType%20%3D%3D%3D%20VSMShadowMap%20%26%26%20this.type%20%21%3D%3D%20VSMShadowMap%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20lights.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20light%20%3D%20lights%5Bi%5D%3B%0A%20%20%20%20%20%20const%20shadow2%20%3D%20light.shadow%3B%0A%20%20%20%20%20%20if%20%28shadow2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLShadowMap%3A%22%2C%20light%2C%20%22has%20no%20shadow.%22%29%3B%0A%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28shadow2.autoUpdate%20%3D%3D%3D%20false%20%26%26%20shadow2.needsUpdate%20%3D%3D%3D%20false%29%20continue%3B%0A%20%20%20%20%20%20_shadowMapSize.copy%28shadow2.mapSize%29%3B%0A%20%20%20%20%20%20const%20shadowFrameExtents%20%3D%20shadow2.getFrameExtents%28%29%3B%0A%20%20%20%20%20%20_shadowMapSize.multiply%28shadowFrameExtents%29%3B%0A%20%20%20%20%20%20_viewportSize.copy%28shadow2.mapSize%29%3B%0A%20%20%20%20%20%20if%20%28_shadowMapSize.x%20%3E%20_maxTextureSize%20%7C%7C%20_shadowMapSize.y%20%3E%20_maxTextureSize%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28_shadowMapSize.x%20%3E%20_maxTextureSize%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_viewportSize.x%20%3D%20Math.floor%28_maxTextureSize%20%2F%20shadowFrameExtents.x%29%3B%0A%20%20%20%20%20%20%20%20%20%20_shadowMapSize.x%20%3D%20_viewportSize.x%20%2A%20shadowFrameExtents.x%3B%0A%20%20%20%20%20%20%20%20%20%20shadow2.mapSize.x%20%3D%20_viewportSize.x%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28_shadowMapSize.y%20%3E%20_maxTextureSize%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_viewportSize.y%20%3D%20Math.floor%28_maxTextureSize%20%2F%20shadowFrameExtents.y%29%3B%0A%20%20%20%20%20%20%20%20%20%20_shadowMapSize.y%20%3D%20_viewportSize.y%20%2A%20shadowFrameExtents.y%3B%0A%20%20%20%20%20%20%20%20%20%20shadow2.mapSize.y%20%3D%20_viewportSize.y%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28shadow2.map%20%3D%3D%3D%20null%20%7C%7C%20toVSM%20%3D%3D%3D%20true%20%7C%7C%20fromVSM%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20const%20pars%20%3D%20this.type%20%21%3D%3D%20VSMShadowMap%20%3F%20%7B%20minFilter%3A%20NearestFilter%2C%20magFilter%3A%20NearestFilter%20%7D%20%3A%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20%28shadow2.map%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20shadow2.map.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20shadow2.map%20%3D%20new%20WebGLRenderTarget%28_shadowMapSize.x%2C%20_shadowMapSize.y%2C%20pars%29%3B%0A%20%20%20%20%20%20%20%20shadow2.map.texture.name%20%3D%20light.name%20%2B%20%22.shadowMap%22%3B%0A%20%20%20%20%20%20%20%20shadow2.camera.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20renderer3.setRenderTarget%28shadow2.map%29%3B%0A%20%20%20%20%20%20renderer3.clear%28%29%3B%0A%20%20%20%20%20%20const%20viewportCount%20%3D%20shadow2.getViewportCount%28%29%3B%0A%20%20%20%20%20%20for%20%28let%20vp%20%3D%200%3B%20vp%20%3C%20viewportCount%3B%20vp%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20viewport2%20%3D%20shadow2.getViewport%28vp%29%3B%0A%20%20%20%20%20%20%20%20_viewport.set%28%0A%20%20%20%20%20%20%20%20%20%20_viewportSize.x%20%2A%20viewport2.x%2C%0A%20%20%20%20%20%20%20%20%20%20_viewportSize.y%20%2A%20viewport2.y%2C%0A%20%20%20%20%20%20%20%20%20%20_viewportSize.x%20%2A%20viewport2.z%2C%0A%20%20%20%20%20%20%20%20%20%20_viewportSize.y%20%2A%20viewport2.w%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20_state.viewport%28_viewport%29%3B%0A%20%20%20%20%20%20%20%20shadow2.updateMatrices%28light%2C%20vp%29%3B%0A%20%20%20%20%20%20%20%20_frustum2%20%3D%20shadow2.getFrustum%28%29%3B%0A%20%20%20%20%20%20%20%20renderObject%28scene3%2C%20camera3%2C%20shadow2.camera%2C%20light%2C%20this.type%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28shadow2.isPointLightShadow%20%21%3D%3D%20true%20%26%26%20this.type%20%3D%3D%3D%20VSMShadowMap%29%20%7B%0A%20%20%20%20%20%20%20%20VSMPass%28shadow2%2C%20camera3%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20shadow2.needsUpdate%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20_previousType%20%3D%20this.type%3B%0A%20%20%20%20scope.needsUpdate%20%3D%20false%3B%0A%20%20%20%20renderer3.setRenderTarget%28currentRenderTarget%2C%20activeCubeFace%2C%20activeMipmapLevel%29%3B%0A%20%20%7D%3B%0A%20%20function%20VSMPass%28shadow2%2C%20camera3%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20objects.update%28fullScreenMesh%29%3B%0A%20%20%20%20if%20%28shadowMaterialVertical.defines.VSM_SAMPLES%20%21%3D%3D%20shadow2.blurSamples%29%20%7B%0A%20%20%20%20%20%20shadowMaterialVertical.defines.VSM_SAMPLES%20%3D%20shadow2.blurSamples%3B%0A%20%20%20%20%20%20shadowMaterialHorizontal.defines.VSM_SAMPLES%20%3D%20shadow2.blurSamples%3B%0A%20%20%20%20%20%20shadowMaterialVertical.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20shadowMaterialHorizontal.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28shadow2.mapPass%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20shadow2.mapPass%20%3D%20new%20WebGLRenderTarget%28_shadowMapSize.x%2C%20_shadowMapSize.y%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20shadowMaterialVertical.uniforms.shadow_pass.value%20%3D%20shadow2.map.texture%3B%0A%20%20%20%20shadowMaterialVertical.uniforms.resolution.value%20%3D%20shadow2.mapSize%3B%0A%20%20%20%20shadowMaterialVertical.uniforms.radius.value%20%3D%20shadow2.radius%3B%0A%20%20%20%20renderer3.setRenderTarget%28shadow2.mapPass%29%3B%0A%20%20%20%20renderer3.clear%28%29%3B%0A%20%20%20%20renderer3.renderBufferDirect%28camera3%2C%20null%2C%20geometry%2C%20shadowMaterialVertical%2C%20fullScreenMesh%2C%20null%29%3B%0A%20%20%20%20shadowMaterialHorizontal.uniforms.shadow_pass.value%20%3D%20shadow2.mapPass.texture%3B%0A%20%20%20%20shadowMaterialHorizontal.uniforms.resolution.value%20%3D%20shadow2.mapSize%3B%0A%20%20%20%20shadowMaterialHorizontal.uniforms.radius.value%20%3D%20shadow2.radius%3B%0A%20%20%20%20renderer3.setRenderTarget%28shadow2.map%29%3B%0A%20%20%20%20renderer3.clear%28%29%3B%0A%20%20%20%20renderer3.renderBufferDirect%28camera3%2C%20null%2C%20geometry%2C%20shadowMaterialHorizontal%2C%20fullScreenMesh%2C%20null%29%3B%0A%20%20%7D%0A%20%20function%20getDepthMaterial%28object%2C%20material%2C%20light%2C%20type%29%20%7B%0A%20%20%20%20let%20result%20%3D%20null%3B%0A%20%20%20%20const%20customMaterial%20%3D%20light.isPointLight%20%3D%3D%3D%20true%20%3F%20object.customDistanceMaterial%20%3A%20object.customDepthMaterial%3B%0A%20%20%20%20if%20%28customMaterial%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20result%20%3D%20customMaterial%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20result%20%3D%20light.isPointLight%20%3D%3D%3D%20true%20%3F%20_distanceMaterial%20%3A%20_depthMaterial%3B%0A%20%20%20%20%20%20if%20%28renderer3.localClippingEnabled%20%26%26%20material.clipShadows%20%3D%3D%3D%20true%20%26%26%20Array.isArray%28material.clippingPlanes%29%20%26%26%20material.clippingPlanes.length%20%21%3D%3D%200%20%7C%7C%20material.displacementMap%20%26%26%20material.displacementScale%20%21%3D%3D%200%20%7C%7C%20material.alphaMap%20%26%26%20material.alphaTest%20%3E%200%20%7C%7C%20material.map%20%26%26%20material.alphaTest%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20keyA%20%3D%20result.uuid%2C%20keyB%20%3D%20material.uuid%3B%0A%20%20%20%20%20%20%20%20let%20materialsForVariant%20%3D%20_materialCache%5BkeyA%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28materialsForVariant%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20materialsForVariant%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20_materialCache%5BkeyA%5D%20%3D%20materialsForVariant%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20let%20cachedMaterial%20%3D%20materialsForVariant%5BkeyB%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28cachedMaterial%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20cachedMaterial%20%3D%20result.clone%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20materialsForVariant%5BkeyB%5D%20%3D%20cachedMaterial%3B%0A%20%20%20%20%20%20%20%20%20%20material.addEventListener%28%22dispose%22%2C%20onMaterialDispose%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20result%20%3D%20cachedMaterial%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20result.visible%20%3D%20material.visible%3B%0A%20%20%20%20result.wireframe%20%3D%20material.wireframe%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20VSMShadowMap%29%20%7B%0A%20%20%20%20%20%20result.side%20%3D%20material.shadowSide%20%21%3D%3D%20null%20%3F%20material.shadowSide%20%3A%20material.side%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20result.side%20%3D%20material.shadowSide%20%21%3D%3D%20null%20%3F%20material.shadowSide%20%3A%20shadowSide%5Bmaterial.side%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20result.alphaMap%20%3D%20material.alphaMap%3B%0A%20%20%20%20result.alphaTest%20%3D%20material.alphaTest%3B%0A%20%20%20%20result.map%20%3D%20material.map%3B%0A%20%20%20%20result.clipShadows%20%3D%20material.clipShadows%3B%0A%20%20%20%20result.clippingPlanes%20%3D%20material.clippingPlanes%3B%0A%20%20%20%20result.clipIntersection%20%3D%20material.clipIntersection%3B%0A%20%20%20%20result.displacementMap%20%3D%20material.displacementMap%3B%0A%20%20%20%20result.displacementScale%20%3D%20material.displacementScale%3B%0A%20%20%20%20result.displacementBias%20%3D%20material.displacementBias%3B%0A%20%20%20%20result.wireframeLinewidth%20%3D%20material.wireframeLinewidth%3B%0A%20%20%20%20result.linewidth%20%3D%20material.linewidth%3B%0A%20%20%20%20if%20%28light.isPointLight%20%3D%3D%3D%20true%20%26%26%20result.isMeshDistanceMaterial%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20materialProperties%20%3D%20renderer3.properties.get%28result%29%3B%0A%20%20%20%20%20%20materialProperties.light%20%3D%20light%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20function%20renderObject%28object%2C%20camera3%2C%20shadowCamera%2C%20light%2C%20type%29%20%7B%0A%20%20%20%20if%20%28object.visible%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20const%20visible%20%3D%20object.layers.test%28camera3.layers%29%3B%0A%20%20%20%20if%20%28visible%20%26%26%20%28object.isMesh%20%7C%7C%20object.isLine%20%7C%7C%20object.isPoints%29%29%20%7B%0A%20%20%20%20%20%20if%20%28%28object.castShadow%20%7C%7C%20object.receiveShadow%20%26%26%20type%20%3D%3D%3D%20VSMShadowMap%29%20%26%26%20%28%21object.frustumCulled%20%7C%7C%20_frustum2.intersectsObject%28object%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20object.modelViewMatrix.multiplyMatrices%28shadowCamera.matrixWorldInverse%2C%20object.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20const%20geometry%20%3D%20objects.update%28object%29%3B%0A%20%20%20%20%20%20%20%20const%20material%20%3D%20object.material%3B%0A%20%20%20%20%20%20%20%20if%20%28Array.isArray%28material%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20groups%20%3D%20geometry.groups%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20k%20%3D%200%2C%20kl%20%3D%20groups.length%3B%20k%20%3C%20kl%3B%20k%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20group%20%3D%20groups%5Bk%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20groupMaterial%20%3D%20material%5Bgroup.materialIndex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28groupMaterial%20%26%26%20groupMaterial.visible%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20depthMaterial%20%3D%20getDepthMaterial%28object%2C%20groupMaterial%2C%20light%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20object.onBeforeShadow%28renderer3%2C%20object%2C%20camera3%2C%20shadowCamera%2C%20geometry%2C%20depthMaterial%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20renderer3.renderBufferDirect%28shadowCamera%2C%20null%2C%20geometry%2C%20depthMaterial%2C%20object%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20object.onAfterShadow%28renderer3%2C%20object%2C%20camera3%2C%20shadowCamera%2C%20geometry%2C%20depthMaterial%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28material.visible%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20depthMaterial%20%3D%20getDepthMaterial%28object%2C%20material%2C%20light%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%20%20object.onBeforeShadow%28renderer3%2C%20object%2C%20camera3%2C%20shadowCamera%2C%20geometry%2C%20depthMaterial%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderer3.renderBufferDirect%28shadowCamera%2C%20null%2C%20geometry%2C%20depthMaterial%2C%20object%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20object.onAfterShadow%28renderer3%2C%20object%2C%20camera3%2C%20shadowCamera%2C%20geometry%2C%20depthMaterial%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20children%20%3D%20object.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20renderObject%28children%5Bi%5D%2C%20camera3%2C%20shadowCamera%2C%20light%2C%20type%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20onMaterialDispose%28event%29%20%7B%0A%20%20%20%20const%20material%20%3D%20event.target%3B%0A%20%20%20%20material.removeEventListener%28%22dispose%22%2C%20onMaterialDispose%29%3B%0A%20%20%20%20for%20%28const%20id2%20in%20_materialCache%29%20%7B%0A%20%20%20%20%20%20const%20cache2%20%3D%20_materialCache%5Bid2%5D%3B%0A%20%20%20%20%20%20const%20uuid%20%3D%20event.target.uuid%3B%0A%20%20%20%20%20%20if%20%28uuid%20in%20cache2%29%20%7B%0A%20%20%20%20%20%20%20%20const%20shadowMaterial%20%3D%20cache2%5Buuid%5D%3B%0A%20%20%20%20%20%20%20%20shadowMaterial.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20delete%20cache2%5Buuid%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Avar%20reversedFuncs%20%3D%20%7B%0A%20%20%5BNeverDepth%5D%3A%20AlwaysDepth%2C%0A%20%20%5BLessDepth%5D%3A%20GreaterDepth%2C%0A%20%20%5BEqualDepth%5D%3A%20NotEqualDepth%2C%0A%20%20%5BLessEqualDepth%5D%3A%20GreaterEqualDepth%2C%0A%20%20%5BAlwaysDepth%5D%3A%20NeverDepth%2C%0A%20%20%5BGreaterDepth%5D%3A%20LessDepth%2C%0A%20%20%5BNotEqualDepth%5D%3A%20EqualDepth%2C%0A%20%20%5BGreaterEqualDepth%5D%3A%20LessEqualDepth%0A%7D%3B%0Afunction%20WebGLState%28gl%2C%20extensions%29%20%7B%0A%20%20function%20ColorBuffer%28%29%20%7B%0A%20%20%20%20let%20locked%20%3D%20false%3B%0A%20%20%20%20const%20color2%20%3D%20new%20Vector4%28%29%3B%0A%20%20%20%20let%20currentColorMask%20%3D%20null%3B%0A%20%20%20%20const%20currentColorClear%20%3D%20new%20Vector4%280%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20setMask%3A%20function%28colorMask%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28currentColorMask%20%21%3D%3D%20colorMask%20%26%26%20%21locked%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.colorMask%28colorMask%2C%20colorMask%2C%20colorMask%2C%20colorMask%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentColorMask%20%3D%20colorMask%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setLocked%3A%20function%28lock%29%20%7B%0A%20%20%20%20%20%20%20%20locked%20%3D%20lock%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setClear%3A%20function%28r%2C%20g%2C%20b%2C%20a2%2C%20premultipliedAlpha%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28premultipliedAlpha%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20r%20%2A%3D%20a2%3B%0A%20%20%20%20%20%20%20%20%20%20g%20%2A%3D%20a2%3B%0A%20%20%20%20%20%20%20%20%20%20b%20%2A%3D%20a2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20color2.set%28r%2C%20g%2C%20b%2C%20a2%29%3B%0A%20%20%20%20%20%20%20%20if%20%28currentColorClear.equals%28color2%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.clearColor%28r%2C%20g%2C%20b%2C%20a2%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentColorClear.copy%28color2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20reset%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20locked%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20currentColorMask%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentColorClear.set%28-1%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20function%20DepthBuffer%28%29%20%7B%0A%20%20%20%20let%20locked%20%3D%20false%3B%0A%20%20%20%20let%20reversed%20%3D%20false%3B%0A%20%20%20%20let%20currentDepthMask%20%3D%20null%3B%0A%20%20%20%20let%20currentDepthFunc%20%3D%20null%3B%0A%20%20%20%20let%20currentDepthClear%20%3D%20null%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20setReversed%3A%20function%28value%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28reversed%20%21%3D%3D%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20ext%20%3D%20extensions.get%28%22EXT_clip_control%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28reversed%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20ext.clipControlEXT%28ext.LOWER_LEFT_EXT%2C%20ext.ZERO_TO_ONE_EXT%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20ext.clipControlEXT%28ext.LOWER_LEFT_EXT%2C%20ext.NEGATIVE_ONE_TO_ONE_EXT%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20const%20oldDepth%20%3D%20currentDepthClear%3B%0A%20%20%20%20%20%20%20%20%20%20currentDepthClear%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20this.setClear%28oldDepth%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20reversed%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20getReversed%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20reversed%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setTest%3A%20function%28depthTest%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28depthTest%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20enable%28gl.DEPTH_TEST%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20disable%28gl.DEPTH_TEST%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setMask%3A%20function%28depthMask%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28currentDepthMask%20%21%3D%3D%20depthMask%20%26%26%20%21locked%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.depthMask%28depthMask%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentDepthMask%20%3D%20depthMask%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setFunc%3A%20function%28depthFunc%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28reversed%29%20depthFunc%20%3D%20reversedFuncs%5BdepthFunc%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28currentDepthFunc%20%21%3D%3D%20depthFunc%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20switch%20%28depthFunc%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20NeverDepth%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.NEVER%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20AlwaysDepth%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.ALWAYS%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20LessDepth%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.LESS%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20LessEqualDepth%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.LEQUAL%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20EqualDepth%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.EQUAL%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20GreaterEqualDepth%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.GEQUAL%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20GreaterDepth%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.GREATER%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20NotEqualDepth%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.NOTEQUAL%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.LEQUAL%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20currentDepthFunc%20%3D%20depthFunc%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setLocked%3A%20function%28lock%29%20%7B%0A%20%20%20%20%20%20%20%20locked%20%3D%20lock%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setClear%3A%20function%28depth2%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28currentDepthClear%20%21%3D%3D%20depth2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28reversed%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20depth2%20%3D%201%20-%20depth2%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20gl.clearDepth%28depth2%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentDepthClear%20%3D%20depth2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20reset%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20locked%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20currentDepthMask%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentDepthFunc%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentDepthClear%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20reversed%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20function%20StencilBuffer%28%29%20%7B%0A%20%20%20%20let%20locked%20%3D%20false%3B%0A%20%20%20%20let%20currentStencilMask%20%3D%20null%3B%0A%20%20%20%20let%20currentStencilFunc%20%3D%20null%3B%0A%20%20%20%20let%20currentStencilRef%20%3D%20null%3B%0A%20%20%20%20let%20currentStencilFuncMask%20%3D%20null%3B%0A%20%20%20%20let%20currentStencilFail%20%3D%20null%3B%0A%20%20%20%20let%20currentStencilZFail%20%3D%20null%3B%0A%20%20%20%20let%20currentStencilZPass%20%3D%20null%3B%0A%20%20%20%20let%20currentStencilClear%20%3D%20null%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20setTest%3A%20function%28stencilTest%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21locked%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28stencilTest%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20enable%28gl.STENCIL_TEST%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20disable%28gl.STENCIL_TEST%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setMask%3A%20function%28stencilMask%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28currentStencilMask%20%21%3D%3D%20stencilMask%20%26%26%20%21locked%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.stencilMask%28stencilMask%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentStencilMask%20%3D%20stencilMask%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setFunc%3A%20function%28stencilFunc%2C%20stencilRef%2C%20stencilMask%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28currentStencilFunc%20%21%3D%3D%20stencilFunc%20%7C%7C%20currentStencilRef%20%21%3D%3D%20stencilRef%20%7C%7C%20currentStencilFuncMask%20%21%3D%3D%20stencilMask%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.stencilFunc%28stencilFunc%2C%20stencilRef%2C%20stencilMask%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentStencilFunc%20%3D%20stencilFunc%3B%0A%20%20%20%20%20%20%20%20%20%20currentStencilRef%20%3D%20stencilRef%3B%0A%20%20%20%20%20%20%20%20%20%20currentStencilFuncMask%20%3D%20stencilMask%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setOp%3A%20function%28stencilFail%2C%20stencilZFail%2C%20stencilZPass%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28currentStencilFail%20%21%3D%3D%20stencilFail%20%7C%7C%20currentStencilZFail%20%21%3D%3D%20stencilZFail%20%7C%7C%20currentStencilZPass%20%21%3D%3D%20stencilZPass%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.stencilOp%28stencilFail%2C%20stencilZFail%2C%20stencilZPass%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentStencilFail%20%3D%20stencilFail%3B%0A%20%20%20%20%20%20%20%20%20%20currentStencilZFail%20%3D%20stencilZFail%3B%0A%20%20%20%20%20%20%20%20%20%20currentStencilZPass%20%3D%20stencilZPass%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setLocked%3A%20function%28lock%29%20%7B%0A%20%20%20%20%20%20%20%20locked%20%3D%20lock%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20setClear%3A%20function%28stencil%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28currentStencilClear%20%21%3D%3D%20stencil%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.clearStencil%28stencil%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentStencilClear%20%3D%20stencil%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20reset%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20locked%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20currentStencilMask%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentStencilFunc%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentStencilRef%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentStencilFuncMask%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentStencilFail%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentStencilZFail%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentStencilZPass%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentStencilClear%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20const%20colorBuffer%20%3D%20new%20ColorBuffer%28%29%3B%0A%20%20const%20depthBuffer%20%3D%20new%20DepthBuffer%28%29%3B%0A%20%20const%20stencilBuffer%20%3D%20new%20StencilBuffer%28%29%3B%0A%20%20const%20uboBindings%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20const%20uboProgramMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20let%20enabledCapabilities%20%3D%20%7B%7D%3B%0A%20%20let%20currentBoundFramebuffers%20%3D%20%7B%7D%3B%0A%20%20let%20currentDrawbuffers%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20let%20defaultDrawbuffers%20%3D%20%5B%5D%3B%0A%20%20let%20currentProgram%20%3D%20null%3B%0A%20%20let%20currentBlendingEnabled%20%3D%20false%3B%0A%20%20let%20currentBlending%20%3D%20null%3B%0A%20%20let%20currentBlendEquation%20%3D%20null%3B%0A%20%20let%20currentBlendSrc%20%3D%20null%3B%0A%20%20let%20currentBlendDst%20%3D%20null%3B%0A%20%20let%20currentBlendEquationAlpha%20%3D%20null%3B%0A%20%20let%20currentBlendSrcAlpha%20%3D%20null%3B%0A%20%20let%20currentBlendDstAlpha%20%3D%20null%3B%0A%20%20let%20currentBlendColor%20%3D%20new%20Color%280%2C%200%2C%200%29%3B%0A%20%20let%20currentBlendAlpha%20%3D%200%3B%0A%20%20let%20currentPremultipledAlpha%20%3D%20false%3B%0A%20%20let%20currentFlipSided%20%3D%20null%3B%0A%20%20let%20currentCullFace%20%3D%20null%3B%0A%20%20let%20currentLineWidth%20%3D%20null%3B%0A%20%20let%20currentPolygonOffsetFactor%20%3D%20null%3B%0A%20%20let%20currentPolygonOffsetUnits%20%3D%20null%3B%0A%20%20const%20maxTextures%20%3D%20gl.getParameter%28gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS%29%3B%0A%20%20let%20lineWidthAvailable%20%3D%20false%3B%0A%20%20let%20version%20%3D%200%3B%0A%20%20const%20glVersion%20%3D%20gl.getParameter%28gl.VERSION%29%3B%0A%20%20if%20%28glVersion.indexOf%28%22WebGL%22%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20version%20%3D%20parseFloat%28%2F%5EWebGL%20%28%5Cd%29%2F.exec%28glVersion%29%5B1%5D%29%3B%0A%20%20%20%20lineWidthAvailable%20%3D%20version%20%3E%3D%201%3B%0A%20%20%7D%20else%20if%20%28glVersion.indexOf%28%22OpenGL%20ES%22%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20version%20%3D%20parseFloat%28%2F%5EOpenGL%20ES%20%28%5Cd%29%2F.exec%28glVersion%29%5B1%5D%29%3B%0A%20%20%20%20lineWidthAvailable%20%3D%20version%20%3E%3D%202%3B%0A%20%20%7D%0A%20%20let%20currentTextureSlot%20%3D%20null%3B%0A%20%20let%20currentBoundTextures%20%3D%20%7B%7D%3B%0A%20%20const%20scissorParam%20%3D%20gl.getParameter%28gl.SCISSOR_BOX%29%3B%0A%20%20const%20viewportParam%20%3D%20gl.getParameter%28gl.VIEWPORT%29%3B%0A%20%20const%20currentScissor%20%3D%20new%20Vector4%28%29.fromArray%28scissorParam%29%3B%0A%20%20const%20currentViewport%20%3D%20new%20Vector4%28%29.fromArray%28viewportParam%29%3B%0A%20%20function%20createTexture%28type%2C%20target%2C%20count%2C%20dimensions%29%20%7B%0A%20%20%20%20const%20data%20%3D%20new%20Uint8Array%284%29%3B%0A%20%20%20%20const%20texture2%20%3D%20gl.createTexture%28%29%3B%0A%20%20%20%20gl.bindTexture%28type%2C%20texture2%29%3B%0A%20%20%20%20gl.texParameteri%28type%2C%20gl.TEXTURE_MIN_FILTER%2C%20gl.NEAREST%29%3B%0A%20%20%20%20gl.texParameteri%28type%2C%20gl.TEXTURE_MAG_FILTER%2C%20gl.NEAREST%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20count%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20gl.TEXTURE_3D%20%7C%7C%20type%20%3D%3D%3D%20gl.TEXTURE_2D_ARRAY%29%20%7B%0A%20%20%20%20%20%20%20%20gl.texImage3D%28target%2C%200%2C%20gl.RGBA%2C%201%2C%201%2C%20dimensions%2C%200%2C%20gl.RGBA%2C%20gl.UNSIGNED_BYTE%2C%20data%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20gl.texImage2D%28target%20%2B%20i%2C%200%2C%20gl.RGBA%2C%201%2C%201%2C%200%2C%20gl.RGBA%2C%20gl.UNSIGNED_BYTE%2C%20data%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20texture2%3B%0A%20%20%7D%0A%20%20const%20emptyTextures%20%3D%20%7B%7D%3B%0A%20%20emptyTextures%5Bgl.TEXTURE_2D%5D%20%3D%20createTexture%28gl.TEXTURE_2D%2C%20gl.TEXTURE_2D%2C%201%29%3B%0A%20%20emptyTextures%5Bgl.TEXTURE_CUBE_MAP%5D%20%3D%20createTexture%28gl.TEXTURE_CUBE_MAP%2C%20gl.TEXTURE_CUBE_MAP_POSITIVE_X%2C%206%29%3B%0A%20%20emptyTextures%5Bgl.TEXTURE_2D_ARRAY%5D%20%3D%20createTexture%28gl.TEXTURE_2D_ARRAY%2C%20gl.TEXTURE_2D_ARRAY%2C%201%2C%201%29%3B%0A%20%20emptyTextures%5Bgl.TEXTURE_3D%5D%20%3D%20createTexture%28gl.TEXTURE_3D%2C%20gl.TEXTURE_3D%2C%201%2C%201%29%3B%0A%20%20colorBuffer.setClear%280%2C%200%2C%200%2C%201%29%3B%0A%20%20depthBuffer.setClear%281%29%3B%0A%20%20stencilBuffer.setClear%280%29%3B%0A%20%20enable%28gl.DEPTH_TEST%29%3B%0A%20%20depthBuffer.setFunc%28LessEqualDepth%29%3B%0A%20%20setFlipSided%28false%29%3B%0A%20%20setCullFace%28CullFaceBack%29%3B%0A%20%20enable%28gl.CULL_FACE%29%3B%0A%20%20setBlending%28NoBlending%29%3B%0A%20%20function%20enable%28id2%29%20%7B%0A%20%20%20%20if%20%28enabledCapabilities%5Bid2%5D%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20gl.enable%28id2%29%3B%0A%20%20%20%20%20%20enabledCapabilities%5Bid2%5D%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20disable%28id2%29%20%7B%0A%20%20%20%20if%20%28enabledCapabilities%5Bid2%5D%20%21%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20gl.disable%28id2%29%3B%0A%20%20%20%20%20%20enabledCapabilities%5Bid2%5D%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20bindFramebuffer%28target%2C%20framebuffer%29%20%7B%0A%20%20%20%20if%20%28currentBoundFramebuffers%5Btarget%5D%20%21%3D%3D%20framebuffer%29%20%7B%0A%20%20%20%20%20%20gl.bindFramebuffer%28target%2C%20framebuffer%29%3B%0A%20%20%20%20%20%20currentBoundFramebuffers%5Btarget%5D%20%3D%20framebuffer%3B%0A%20%20%20%20%20%20if%20%28target%20%3D%3D%3D%20gl.DRAW_FRAMEBUFFER%29%20%7B%0A%20%20%20%20%20%20%20%20currentBoundFramebuffers%5Bgl.FRAMEBUFFER%5D%20%3D%20framebuffer%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28target%20%3D%3D%3D%20gl.FRAMEBUFFER%29%20%7B%0A%20%20%20%20%20%20%20%20currentBoundFramebuffers%5Bgl.DRAW_FRAMEBUFFER%5D%20%3D%20framebuffer%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20function%20drawBuffers%28renderTarget%2C%20framebuffer%29%20%7B%0A%20%20%20%20let%20drawBuffers2%20%3D%20defaultDrawbuffers%3B%0A%20%20%20%20let%20needsUpdate%20%3D%20false%3B%0A%20%20%20%20if%20%28renderTarget%29%20%7B%0A%20%20%20%20%20%20drawBuffers2%20%3D%20currentDrawbuffers.get%28framebuffer%29%3B%0A%20%20%20%20%20%20if%20%28drawBuffers2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20drawBuffers2%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20currentDrawbuffers.set%28framebuffer%2C%20drawBuffers2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20textures%20%3D%20renderTarget.textures%3B%0A%20%20%20%20%20%20if%20%28drawBuffers2.length%20%21%3D%3D%20textures.length%20%7C%7C%20drawBuffers2%5B0%5D%20%21%3D%3D%20gl.COLOR_ATTACHMENT0%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20drawBuffers2%5Bi%5D%20%3D%20gl.COLOR_ATTACHMENT0%20%2B%20i%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20drawBuffers2.length%20%3D%20textures.length%3B%0A%20%20%20%20%20%20%20%20needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28drawBuffers2%5B0%5D%20%21%3D%3D%20gl.BACK%29%20%7B%0A%20%20%20%20%20%20%20%20drawBuffers2%5B0%5D%20%3D%20gl.BACK%3B%0A%20%20%20%20%20%20%20%20needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28needsUpdate%29%20%7B%0A%20%20%20%20%20%20gl.drawBuffers%28drawBuffers2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20useProgram%28program%29%20%7B%0A%20%20%20%20if%20%28currentProgram%20%21%3D%3D%20program%29%20%7B%0A%20%20%20%20%20%20gl.useProgram%28program%29%3B%0A%20%20%20%20%20%20currentProgram%20%3D%20program%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20const%20equationToGL2%20%3D%20%7B%0A%20%20%20%20%5BAddEquation%5D%3A%20gl.FUNC_ADD%2C%0A%20%20%20%20%5BSubtractEquation%5D%3A%20gl.FUNC_SUBTRACT%2C%0A%20%20%20%20%5BReverseSubtractEquation%5D%3A%20gl.FUNC_REVERSE_SUBTRACT%0A%20%20%7D%3B%0A%20%20equationToGL2%5BMinEquation%5D%20%3D%20gl.MIN%3B%0A%20%20equationToGL2%5BMaxEquation%5D%20%3D%20gl.MAX%3B%0A%20%20const%20factorToGL2%20%3D%20%7B%0A%20%20%20%20%5BZeroFactor%5D%3A%20gl.ZERO%2C%0A%20%20%20%20%5BOneFactor%5D%3A%20gl.ONE%2C%0A%20%20%20%20%5BSrcColorFactor%5D%3A%20gl.SRC_COLOR%2C%0A%20%20%20%20%5BSrcAlphaFactor%5D%3A%20gl.SRC_ALPHA%2C%0A%20%20%20%20%5BSrcAlphaSaturateFactor%5D%3A%20gl.SRC_ALPHA_SATURATE%2C%0A%20%20%20%20%5BDstColorFactor%5D%3A%20gl.DST_COLOR%2C%0A%20%20%20%20%5BDstAlphaFactor%5D%3A%20gl.DST_ALPHA%2C%0A%20%20%20%20%5BOneMinusSrcColorFactor%5D%3A%20gl.ONE_MINUS_SRC_COLOR%2C%0A%20%20%20%20%5BOneMinusSrcAlphaFactor%5D%3A%20gl.ONE_MINUS_SRC_ALPHA%2C%0A%20%20%20%20%5BOneMinusDstColorFactor%5D%3A%20gl.ONE_MINUS_DST_COLOR%2C%0A%20%20%20%20%5BOneMinusDstAlphaFactor%5D%3A%20gl.ONE_MINUS_DST_ALPHA%2C%0A%20%20%20%20%5BConstantColorFactor%5D%3A%20gl.CONSTANT_COLOR%2C%0A%20%20%20%20%5BOneMinusConstantColorFactor%5D%3A%20gl.ONE_MINUS_CONSTANT_COLOR%2C%0A%20%20%20%20%5BConstantAlphaFactor%5D%3A%20gl.CONSTANT_ALPHA%2C%0A%20%20%20%20%5BOneMinusConstantAlphaFactor%5D%3A%20gl.ONE_MINUS_CONSTANT_ALPHA%0A%20%20%7D%3B%0A%20%20function%20setBlending%28blending%2C%20blendEquation%2C%20blendSrc%2C%20blendDst%2C%20blendEquationAlpha%2C%20blendSrcAlpha%2C%20blendDstAlpha%2C%20blendColor%2C%20blendAlpha%2C%20premultipliedAlpha%29%20%7B%0A%20%20%20%20if%20%28blending%20%3D%3D%3D%20NoBlending%29%20%7B%0A%20%20%20%20%20%20if%20%28currentBlendingEnabled%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20disable%28gl.BLEND%29%3B%0A%20%20%20%20%20%20%20%20currentBlendingEnabled%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28currentBlendingEnabled%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20enable%28gl.BLEND%29%3B%0A%20%20%20%20%20%20currentBlendingEnabled%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28blending%20%21%3D%3D%20CustomBlending%29%20%7B%0A%20%20%20%20%20%20if%20%28blending%20%21%3D%3D%20currentBlending%20%7C%7C%20premultipliedAlpha%20%21%3D%3D%20currentPremultipledAlpha%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28currentBlendEquation%20%21%3D%3D%20AddEquation%20%7C%7C%20currentBlendEquationAlpha%20%21%3D%3D%20AddEquation%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.blendEquation%28gl.FUNC_ADD%29%3B%0A%20%20%20%20%20%20%20%20%20%20currentBlendEquation%20%3D%20AddEquation%3B%0A%20%20%20%20%20%20%20%20%20%20currentBlendEquationAlpha%20%3D%20AddEquation%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28premultipliedAlpha%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20switch%20%28blending%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20NormalBlending%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.ONE%2C%20gl.ONE_MINUS_SRC_ALPHA%2C%20gl.ONE%2C%20gl.ONE_MINUS_SRC_ALPHA%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20AdditiveBlending%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFunc%28gl.ONE%2C%20gl.ONE%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20SubtractiveBlending%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.ZERO%2C%20gl.ONE_MINUS_SRC_COLOR%2C%20gl.ZERO%2C%20gl.ONE%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20MultiplyBlending%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.ZERO%2C%20gl.SRC_COLOR%2C%20gl.ZERO%2C%20gl.SRC_ALPHA%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%20Invalid%20blending%3A%20%22%2C%20blending%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20switch%20%28blending%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20NormalBlending%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.SRC_ALPHA%2C%20gl.ONE_MINUS_SRC_ALPHA%2C%20gl.ONE%2C%20gl.ONE_MINUS_SRC_ALPHA%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20AdditiveBlending%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFunc%28gl.SRC_ALPHA%2C%20gl.ONE%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20SubtractiveBlending%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.ZERO%2C%20gl.ONE_MINUS_SRC_COLOR%2C%20gl.ZERO%2C%20gl.ONE%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20MultiplyBlending%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFunc%28gl.ZERO%2C%20gl.SRC_COLOR%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%20Invalid%20blending%3A%20%22%2C%20blending%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20currentBlendSrc%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentBlendDst%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentBlendSrcAlpha%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentBlendDstAlpha%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20currentBlendColor.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20currentBlendAlpha%20%3D%200%3B%0A%20%20%20%20%20%20%20%20currentBlending%20%3D%20blending%3B%0A%20%20%20%20%20%20%20%20currentPremultipledAlpha%20%3D%20premultipliedAlpha%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20blendEquationAlpha%20%3D%20blendEquationAlpha%20%7C%7C%20blendEquation%3B%0A%20%20%20%20blendSrcAlpha%20%3D%20blendSrcAlpha%20%7C%7C%20blendSrc%3B%0A%20%20%20%20blendDstAlpha%20%3D%20blendDstAlpha%20%7C%7C%20blendDst%3B%0A%20%20%20%20if%20%28blendEquation%20%21%3D%3D%20currentBlendEquation%20%7C%7C%20blendEquationAlpha%20%21%3D%3D%20currentBlendEquationAlpha%29%20%7B%0A%20%20%20%20%20%20gl.blendEquationSeparate%28equationToGL2%5BblendEquation%5D%2C%20equationToGL2%5BblendEquationAlpha%5D%29%3B%0A%20%20%20%20%20%20currentBlendEquation%20%3D%20blendEquation%3B%0A%20%20%20%20%20%20currentBlendEquationAlpha%20%3D%20blendEquationAlpha%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28blendSrc%20%21%3D%3D%20currentBlendSrc%20%7C%7C%20blendDst%20%21%3D%3D%20currentBlendDst%20%7C%7C%20blendSrcAlpha%20%21%3D%3D%20currentBlendSrcAlpha%20%7C%7C%20blendDstAlpha%20%21%3D%3D%20currentBlendDstAlpha%29%20%7B%0A%20%20%20%20%20%20gl.blendFuncSeparate%28factorToGL2%5BblendSrc%5D%2C%20factorToGL2%5BblendDst%5D%2C%20factorToGL2%5BblendSrcAlpha%5D%2C%20factorToGL2%5BblendDstAlpha%5D%29%3B%0A%20%20%20%20%20%20currentBlendSrc%20%3D%20blendSrc%3B%0A%20%20%20%20%20%20currentBlendDst%20%3D%20blendDst%3B%0A%20%20%20%20%20%20currentBlendSrcAlpha%20%3D%20blendSrcAlpha%3B%0A%20%20%20%20%20%20currentBlendDstAlpha%20%3D%20blendDstAlpha%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28blendColor.equals%28currentBlendColor%29%20%3D%3D%3D%20false%20%7C%7C%20blendAlpha%20%21%3D%3D%20currentBlendAlpha%29%20%7B%0A%20%20%20%20%20%20gl.blendColor%28blendColor.r%2C%20blendColor.g%2C%20blendColor.b%2C%20blendAlpha%29%3B%0A%20%20%20%20%20%20currentBlendColor.copy%28blendColor%29%3B%0A%20%20%20%20%20%20currentBlendAlpha%20%3D%20blendAlpha%3B%0A%20%20%20%20%7D%0A%20%20%20%20currentBlending%20%3D%20blending%3B%0A%20%20%20%20currentPremultipledAlpha%20%3D%20false%3B%0A%20%20%7D%0A%20%20function%20setMaterial%28material%2C%20frontFaceCW%29%20%7B%0A%20%20%20%20material.side%20%3D%3D%3D%20DoubleSide%20%3F%20disable%28gl.CULL_FACE%29%20%3A%20enable%28gl.CULL_FACE%29%3B%0A%20%20%20%20let%20flipSided%20%3D%20material.side%20%3D%3D%3D%20BackSide%3B%0A%20%20%20%20if%20%28frontFaceCW%29%20flipSided%20%3D%20%21flipSided%3B%0A%20%20%20%20setFlipSided%28flipSided%29%3B%0A%20%20%20%20material.blending%20%3D%3D%3D%20NormalBlending%20%26%26%20material.transparent%20%3D%3D%3D%20false%20%3F%20setBlending%28NoBlending%29%20%3A%20setBlending%28material.blending%2C%20material.blendEquation%2C%20material.blendSrc%2C%20material.blendDst%2C%20material.blendEquationAlpha%2C%20material.blendSrcAlpha%2C%20material.blendDstAlpha%2C%20material.blendColor%2C%20material.blendAlpha%2C%20material.premultipliedAlpha%29%3B%0A%20%20%20%20depthBuffer.setFunc%28material.depthFunc%29%3B%0A%20%20%20%20depthBuffer.setTest%28material.depthTest%29%3B%0A%20%20%20%20depthBuffer.setMask%28material.depthWrite%29%3B%0A%20%20%20%20colorBuffer.setMask%28material.colorWrite%29%3B%0A%20%20%20%20const%20stencilWrite%20%3D%20material.stencilWrite%3B%0A%20%20%20%20stencilBuffer.setTest%28stencilWrite%29%3B%0A%20%20%20%20if%20%28stencilWrite%29%20%7B%0A%20%20%20%20%20%20stencilBuffer.setMask%28material.stencilWriteMask%29%3B%0A%20%20%20%20%20%20stencilBuffer.setFunc%28material.stencilFunc%2C%20material.stencilRef%2C%20material.stencilFuncMask%29%3B%0A%20%20%20%20%20%20stencilBuffer.setOp%28material.stencilFail%2C%20material.stencilZFail%2C%20material.stencilZPass%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20setPolygonOffset%28material.polygonOffset%2C%20material.polygonOffsetFactor%2C%20material.polygonOffsetUnits%29%3B%0A%20%20%20%20material.alphaToCoverage%20%3D%3D%3D%20true%20%3F%20enable%28gl.SAMPLE_ALPHA_TO_COVERAGE%29%20%3A%20disable%28gl.SAMPLE_ALPHA_TO_COVERAGE%29%3B%0A%20%20%7D%0A%20%20function%20setFlipSided%28flipSided%29%20%7B%0A%20%20%20%20if%20%28currentFlipSided%20%21%3D%3D%20flipSided%29%20%7B%0A%20%20%20%20%20%20if%20%28flipSided%29%20%7B%0A%20%20%20%20%20%20%20%20gl.frontFace%28gl.CW%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20gl.frontFace%28gl.CCW%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20currentFlipSided%20%3D%20flipSided%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20setCullFace%28cullFace%29%20%7B%0A%20%20%20%20if%20%28cullFace%20%21%3D%3D%20CullFaceNone%29%20%7B%0A%20%20%20%20%20%20enable%28gl.CULL_FACE%29%3B%0A%20%20%20%20%20%20if%20%28cullFace%20%21%3D%3D%20currentCullFace%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28cullFace%20%3D%3D%3D%20CullFaceBack%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.cullFace%28gl.BACK%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28cullFace%20%3D%3D%3D%20CullFaceFront%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.cullFace%28gl.FRONT%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.cullFace%28gl.FRONT_AND_BACK%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20disable%28gl.CULL_FACE%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20currentCullFace%20%3D%20cullFace%3B%0A%20%20%7D%0A%20%20function%20setLineWidth%28width%29%20%7B%0A%20%20%20%20if%20%28width%20%21%3D%3D%20currentLineWidth%29%20%7B%0A%20%20%20%20%20%20if%20%28lineWidthAvailable%29%20gl.lineWidth%28width%29%3B%0A%20%20%20%20%20%20currentLineWidth%20%3D%20width%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20setPolygonOffset%28polygonOffset%2C%20factor%2C%20units%29%20%7B%0A%20%20%20%20if%20%28polygonOffset%29%20%7B%0A%20%20%20%20%20%20enable%28gl.POLYGON_OFFSET_FILL%29%3B%0A%20%20%20%20%20%20if%20%28currentPolygonOffsetFactor%20%21%3D%3D%20factor%20%7C%7C%20currentPolygonOffsetUnits%20%21%3D%3D%20units%29%20%7B%0A%20%20%20%20%20%20%20%20gl.polygonOffset%28factor%2C%20units%29%3B%0A%20%20%20%20%20%20%20%20currentPolygonOffsetFactor%20%3D%20factor%3B%0A%20%20%20%20%20%20%20%20currentPolygonOffsetUnits%20%3D%20units%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20disable%28gl.POLYGON_OFFSET_FILL%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20setScissorTest%28scissorTest%29%20%7B%0A%20%20%20%20if%20%28scissorTest%29%20%7B%0A%20%20%20%20%20%20enable%28gl.SCISSOR_TEST%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20disable%28gl.SCISSOR_TEST%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20activeTexture%28webglSlot%29%20%7B%0A%20%20%20%20if%20%28webglSlot%20%3D%3D%3D%20void%200%29%20webglSlot%20%3D%20gl.TEXTURE0%20%2B%20maxTextures%20-%201%3B%0A%20%20%20%20if%20%28currentTextureSlot%20%21%3D%3D%20webglSlot%29%20%7B%0A%20%20%20%20%20%20gl.activeTexture%28webglSlot%29%3B%0A%20%20%20%20%20%20currentTextureSlot%20%3D%20webglSlot%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20bindTexture%28webglType%2C%20webglTexture%2C%20webglSlot%29%20%7B%0A%20%20%20%20if%20%28webglSlot%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28currentTextureSlot%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20webglSlot%20%3D%20gl.TEXTURE0%20%2B%20maxTextures%20-%201%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20webglSlot%20%3D%20currentTextureSlot%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20let%20boundTexture%20%3D%20currentBoundTextures%5BwebglSlot%5D%3B%0A%20%20%20%20if%20%28boundTexture%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20boundTexture%20%3D%20%7B%20type%3A%20void%200%2C%20texture%3A%20void%200%20%7D%3B%0A%20%20%20%20%20%20currentBoundTextures%5BwebglSlot%5D%20%3D%20boundTexture%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28boundTexture.type%20%21%3D%3D%20webglType%20%7C%7C%20boundTexture.texture%20%21%3D%3D%20webglTexture%29%20%7B%0A%20%20%20%20%20%20if%20%28currentTextureSlot%20%21%3D%3D%20webglSlot%29%20%7B%0A%20%20%20%20%20%20%20%20gl.activeTexture%28webglSlot%29%3B%0A%20%20%20%20%20%20%20%20currentTextureSlot%20%3D%20webglSlot%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20gl.bindTexture%28webglType%2C%20webglTexture%20%7C%7C%20emptyTextures%5BwebglType%5D%29%3B%0A%20%20%20%20%20%20boundTexture.type%20%3D%20webglType%3B%0A%20%20%20%20%20%20boundTexture.texture%20%3D%20webglTexture%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20unbindTexture%28%29%20%7B%0A%20%20%20%20const%20boundTexture%20%3D%20currentBoundTextures%5BcurrentTextureSlot%5D%3B%0A%20%20%20%20if%20%28boundTexture%20%21%3D%3D%20void%200%20%26%26%20boundTexture.type%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20gl.bindTexture%28boundTexture.type%2C%20null%29%3B%0A%20%20%20%20%20%20boundTexture.type%20%3D%20void%200%3B%0A%20%20%20%20%20%20boundTexture.texture%20%3D%20void%200%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20compressedTexImage2D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.compressedTexImage2D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20compressedTexImage3D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.compressedTexImage3D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20texSubImage2D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.texSubImage2D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20texSubImage3D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.texSubImage3D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20compressedTexSubImage2D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.compressedTexSubImage2D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20compressedTexSubImage3D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.compressedTexSubImage3D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20texStorage2D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.texStorage2D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20texStorage3D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.texStorage3D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20texImage2D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.texImage2D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20texImage3D%28%29%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20gl.texImage3D.apply%28gl%2C%20arguments%29%3B%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%22%2C%20error%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20scissor%28scissor2%29%20%7B%0A%20%20%20%20if%20%28currentScissor.equals%28scissor2%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20gl.scissor%28scissor2.x%2C%20scissor2.y%2C%20scissor2.z%2C%20scissor2.w%29%3B%0A%20%20%20%20%20%20currentScissor.copy%28scissor2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20viewport2%28viewport3%29%20%7B%0A%20%20%20%20if%20%28currentViewport.equals%28viewport3%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20gl.viewport%28viewport3.x%2C%20viewport3.y%2C%20viewport3.z%2C%20viewport3.w%29%3B%0A%20%20%20%20%20%20currentViewport.copy%28viewport3%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20updateUBOMapping%28uniformsGroup%2C%20program%29%20%7B%0A%20%20%20%20let%20mapping%20%3D%20uboProgramMap.get%28program%29%3B%0A%20%20%20%20if%20%28mapping%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20mapping%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20%20%20uboProgramMap.set%28program%2C%20mapping%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20blockIndex%20%3D%20mapping.get%28uniformsGroup%29%3B%0A%20%20%20%20if%20%28blockIndex%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20blockIndex%20%3D%20gl.getUniformBlockIndex%28program%2C%20uniformsGroup.name%29%3B%0A%20%20%20%20%20%20mapping.set%28uniformsGroup%2C%20blockIndex%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20uniformBlockBinding%28uniformsGroup%2C%20program%29%20%7B%0A%20%20%20%20const%20mapping%20%3D%20uboProgramMap.get%28program%29%3B%0A%20%20%20%20const%20blockIndex%20%3D%20mapping.get%28uniformsGroup%29%3B%0A%20%20%20%20if%20%28uboBindings.get%28program%29%20%21%3D%3D%20blockIndex%29%20%7B%0A%20%20%20%20%20%20gl.uniformBlockBinding%28program%2C%20blockIndex%2C%20uniformsGroup.__bindingPointIndex%29%3B%0A%20%20%20%20%20%20uboBindings.set%28program%2C%20blockIndex%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20reset%28%29%20%7B%0A%20%20%20%20gl.disable%28gl.BLEND%29%3B%0A%20%20%20%20gl.disable%28gl.CULL_FACE%29%3B%0A%20%20%20%20gl.disable%28gl.DEPTH_TEST%29%3B%0A%20%20%20%20gl.disable%28gl.POLYGON_OFFSET_FILL%29%3B%0A%20%20%20%20gl.disable%28gl.SCISSOR_TEST%29%3B%0A%20%20%20%20gl.disable%28gl.STENCIL_TEST%29%3B%0A%20%20%20%20gl.disable%28gl.SAMPLE_ALPHA_TO_COVERAGE%29%3B%0A%20%20%20%20gl.blendEquation%28gl.FUNC_ADD%29%3B%0A%20%20%20%20gl.blendFunc%28gl.ONE%2C%20gl.ZERO%29%3B%0A%20%20%20%20gl.blendFuncSeparate%28gl.ONE%2C%20gl.ZERO%2C%20gl.ONE%2C%20gl.ZERO%29%3B%0A%20%20%20%20gl.blendColor%280%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20gl.colorMask%28true%2C%20true%2C%20true%2C%20true%29%3B%0A%20%20%20%20gl.clearColor%280%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20gl.depthMask%28true%29%3B%0A%20%20%20%20gl.depthFunc%28gl.LESS%29%3B%0A%20%20%20%20depthBuffer.setReversed%28false%29%3B%0A%20%20%20%20gl.clearDepth%281%29%3B%0A%20%20%20%20gl.stencilMask%284294967295%29%3B%0A%20%20%20%20gl.stencilFunc%28gl.ALWAYS%2C%200%2C%204294967295%29%3B%0A%20%20%20%20gl.stencilOp%28gl.KEEP%2C%20gl.KEEP%2C%20gl.KEEP%29%3B%0A%20%20%20%20gl.clearStencil%280%29%3B%0A%20%20%20%20gl.cullFace%28gl.BACK%29%3B%0A%20%20%20%20gl.frontFace%28gl.CCW%29%3B%0A%20%20%20%20gl.polygonOffset%280%2C%200%29%3B%0A%20%20%20%20gl.activeTexture%28gl.TEXTURE0%29%3B%0A%20%20%20%20gl.bindFramebuffer%28gl.FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20gl.bindFramebuffer%28gl.DRAW_FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20gl.bindFramebuffer%28gl.READ_FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20gl.useProgram%28null%29%3B%0A%20%20%20%20gl.lineWidth%281%29%3B%0A%20%20%20%20gl.scissor%280%2C%200%2C%20gl.canvas.width%2C%20gl.canvas.height%29%3B%0A%20%20%20%20gl.viewport%280%2C%200%2C%20gl.canvas.width%2C%20gl.canvas.height%29%3B%0A%20%20%20%20enabledCapabilities%20%3D%20%7B%7D%3B%0A%20%20%20%20currentTextureSlot%20%3D%20null%3B%0A%20%20%20%20currentBoundTextures%20%3D%20%7B%7D%3B%0A%20%20%20%20currentBoundFramebuffers%20%3D%20%7B%7D%3B%0A%20%20%20%20currentDrawbuffers%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20defaultDrawbuffers%20%3D%20%5B%5D%3B%0A%20%20%20%20currentProgram%20%3D%20null%3B%0A%20%20%20%20currentBlendingEnabled%20%3D%20false%3B%0A%20%20%20%20currentBlending%20%3D%20null%3B%0A%20%20%20%20currentBlendEquation%20%3D%20null%3B%0A%20%20%20%20currentBlendSrc%20%3D%20null%3B%0A%20%20%20%20currentBlendDst%20%3D%20null%3B%0A%20%20%20%20currentBlendEquationAlpha%20%3D%20null%3B%0A%20%20%20%20currentBlendSrcAlpha%20%3D%20null%3B%0A%20%20%20%20currentBlendDstAlpha%20%3D%20null%3B%0A%20%20%20%20currentBlendColor%20%3D%20new%20Color%280%2C%200%2C%200%29%3B%0A%20%20%20%20currentBlendAlpha%20%3D%200%3B%0A%20%20%20%20currentPremultipledAlpha%20%3D%20false%3B%0A%20%20%20%20currentFlipSided%20%3D%20null%3B%0A%20%20%20%20currentCullFace%20%3D%20null%3B%0A%20%20%20%20currentLineWidth%20%3D%20null%3B%0A%20%20%20%20currentPolygonOffsetFactor%20%3D%20null%3B%0A%20%20%20%20currentPolygonOffsetUnits%20%3D%20null%3B%0A%20%20%20%20currentScissor.set%280%2C%200%2C%20gl.canvas.width%2C%20gl.canvas.height%29%3B%0A%20%20%20%20currentViewport.set%280%2C%200%2C%20gl.canvas.width%2C%20gl.canvas.height%29%3B%0A%20%20%20%20colorBuffer.reset%28%29%3B%0A%20%20%20%20depthBuffer.reset%28%29%3B%0A%20%20%20%20stencilBuffer.reset%28%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20buffers%3A%20%7B%0A%20%20%20%20%20%20color%3A%20colorBuffer%2C%0A%20%20%20%20%20%20depth%3A%20depthBuffer%2C%0A%20%20%20%20%20%20stencil%3A%20stencilBuffer%0A%20%20%20%20%7D%2C%0A%20%20%20%20enable%2C%0A%20%20%20%20disable%2C%0A%20%20%20%20bindFramebuffer%2C%0A%20%20%20%20drawBuffers%2C%0A%20%20%20%20useProgram%2C%0A%20%20%20%20setBlending%2C%0A%20%20%20%20setMaterial%2C%0A%20%20%20%20setFlipSided%2C%0A%20%20%20%20setCullFace%2C%0A%20%20%20%20setLineWidth%2C%0A%20%20%20%20setPolygonOffset%2C%0A%20%20%20%20setScissorTest%2C%0A%20%20%20%20activeTexture%2C%0A%20%20%20%20bindTexture%2C%0A%20%20%20%20unbindTexture%2C%0A%20%20%20%20compressedTexImage2D%2C%0A%20%20%20%20compressedTexImage3D%2C%0A%20%20%20%20texImage2D%2C%0A%20%20%20%20texImage3D%2C%0A%20%20%20%20updateUBOMapping%2C%0A%20%20%20%20uniformBlockBinding%2C%0A%20%20%20%20texStorage2D%2C%0A%20%20%20%20texStorage3D%2C%0A%20%20%20%20texSubImage2D%2C%0A%20%20%20%20texSubImage3D%2C%0A%20%20%20%20compressedTexSubImage2D%2C%0A%20%20%20%20compressedTexSubImage3D%2C%0A%20%20%20%20scissor%2C%0A%20%20%20%20viewport%3A%20viewport2%2C%0A%20%20%20%20reset%0A%20%20%7D%3B%0A%7D%0Afunction%20getByteLength%28width%2C%20height%2C%20format2%2C%20type%29%20%7B%0A%20%20const%20typeByteLength%20%3D%20getTextureTypeByteLength%28type%29%3B%0A%20%20switch%20%28format2%29%20%7B%0A%20%20%20%20%2F%2F%20https%3A%2F%2Fregistry.khronos.org%2FOpenGL-Refpages%2Fes3.0%2Fhtml%2FglTexImage2D.xhtml%0A%20%20%20%20case%20AlphaFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%3B%0A%20%20%20%20case%20LuminanceFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%3B%0A%20%20%20%20case%20LuminanceAlphaFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%20%2A%202%3B%0A%20%20%20%20case%20RedFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%20%2F%20typeByteLength.components%20%2A%20typeByteLength.byteLength%3B%0A%20%20%20%20case%20RedIntegerFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%20%2F%20typeByteLength.components%20%2A%20typeByteLength.byteLength%3B%0A%20%20%20%20case%20RGFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%20%2A%202%20%2F%20typeByteLength.components%20%2A%20typeByteLength.byteLength%3B%0A%20%20%20%20case%20RGIntegerFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%20%2A%202%20%2F%20typeByteLength.components%20%2A%20typeByteLength.byteLength%3B%0A%20%20%20%20case%20RGBFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%20%2A%203%20%2F%20typeByteLength.components%20%2A%20typeByteLength.byteLength%3B%0A%20%20%20%20case%20RGBAFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%20%2A%204%20%2F%20typeByteLength.components%20%2A%20typeByteLength.byteLength%3B%0A%20%20%20%20case%20RGBAIntegerFormat%3A%0A%20%20%20%20%20%20return%20width%20%2A%20height%20%2A%204%20%2F%20typeByteLength.components%20%2A%20typeByteLength.byteLength%3B%0A%20%20%20%20%2F%2F%20https%3A%2F%2Fregistry.khronos.org%2Fwebgl%2Fextensions%2FWEBGL_compressed_texture_s3tc_srgb%2F%0A%20%20%20%20case%20RGB_S3TC_DXT1_Format%3A%0A%20%20%20%20case%20RGBA_S3TC_DXT1_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%203%29%20%2F%204%29%20%2A%20Math.floor%28%28height%20%2B%203%29%20%2F%204%29%20%2A%208%3B%0A%20%20%20%20case%20RGBA_S3TC_DXT3_Format%3A%0A%20%20%20%20case%20RGBA_S3TC_DXT5_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%203%29%20%2F%204%29%20%2A%20Math.floor%28%28height%20%2B%203%29%20%2F%204%29%20%2A%2016%3B%0A%20%20%20%20%2F%2F%20https%3A%2F%2Fregistry.khronos.org%2Fwebgl%2Fextensions%2FWEBGL_compressed_texture_pvrtc%2F%0A%20%20%20%20case%20RGB_PVRTC_2BPPV1_Format%3A%0A%20%20%20%20case%20RGBA_PVRTC_2BPPV1_Format%3A%0A%20%20%20%20%20%20return%20Math.max%28width%2C%2016%29%20%2A%20Math.max%28height%2C%208%29%20%2F%204%3B%0A%20%20%20%20case%20RGB_PVRTC_4BPPV1_Format%3A%0A%20%20%20%20case%20RGBA_PVRTC_4BPPV1_Format%3A%0A%20%20%20%20%20%20return%20Math.max%28width%2C%208%29%20%2A%20Math.max%28height%2C%208%29%20%2F%202%3B%0A%20%20%20%20%2F%2F%20https%3A%2F%2Fregistry.khronos.org%2Fwebgl%2Fextensions%2FWEBGL_compressed_texture_etc%2F%0A%20%20%20%20case%20RGB_ETC1_Format%3A%0A%20%20%20%20case%20RGB_ETC2_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%203%29%20%2F%204%29%20%2A%20Math.floor%28%28height%20%2B%203%29%20%2F%204%29%20%2A%208%3B%0A%20%20%20%20case%20RGBA_ETC2_EAC_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%203%29%20%2F%204%29%20%2A%20Math.floor%28%28height%20%2B%203%29%20%2F%204%29%20%2A%2016%3B%0A%20%20%20%20%2F%2F%20https%3A%2F%2Fregistry.khronos.org%2Fwebgl%2Fextensions%2FWEBGL_compressed_texture_astc%2F%0A%20%20%20%20case%20RGBA_ASTC_4x4_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%203%29%20%2F%204%29%20%2A%20Math.floor%28%28height%20%2B%203%29%20%2F%204%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_5x4_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%204%29%20%2F%205%29%20%2A%20Math.floor%28%28height%20%2B%203%29%20%2F%204%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_5x5_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%204%29%20%2F%205%29%20%2A%20Math.floor%28%28height%20%2B%204%29%20%2F%205%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_6x5_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%205%29%20%2F%206%29%20%2A%20Math.floor%28%28height%20%2B%204%29%20%2F%205%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_6x6_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%205%29%20%2F%206%29%20%2A%20Math.floor%28%28height%20%2B%205%29%20%2F%206%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_8x5_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%207%29%20%2F%208%29%20%2A%20Math.floor%28%28height%20%2B%204%29%20%2F%205%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_8x6_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%207%29%20%2F%208%29%20%2A%20Math.floor%28%28height%20%2B%205%29%20%2F%206%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_8x8_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%207%29%20%2F%208%29%20%2A%20Math.floor%28%28height%20%2B%207%29%20%2F%208%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_10x5_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%209%29%20%2F%2010%29%20%2A%20Math.floor%28%28height%20%2B%204%29%20%2F%205%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_10x6_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%209%29%20%2F%2010%29%20%2A%20Math.floor%28%28height%20%2B%205%29%20%2F%206%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_10x8_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%209%29%20%2F%2010%29%20%2A%20Math.floor%28%28height%20%2B%207%29%20%2F%208%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_10x10_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%209%29%20%2F%2010%29%20%2A%20Math.floor%28%28height%20%2B%209%29%20%2F%2010%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_12x10_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%2011%29%20%2F%2012%29%20%2A%20Math.floor%28%28height%20%2B%209%29%20%2F%2010%29%20%2A%2016%3B%0A%20%20%20%20case%20RGBA_ASTC_12x12_Format%3A%0A%20%20%20%20%20%20return%20Math.floor%28%28width%20%2B%2011%29%20%2F%2012%29%20%2A%20Math.floor%28%28height%20%2B%2011%29%20%2F%2012%29%20%2A%2016%3B%0A%20%20%20%20%2F%2F%20https%3A%2F%2Fregistry.khronos.org%2Fwebgl%2Fextensions%2FEXT_texture_compression_bptc%2F%0A%20%20%20%20case%20RGBA_BPTC_Format%3A%0A%20%20%20%20case%20RGB_BPTC_SIGNED_Format%3A%0A%20%20%20%20case%20RGB_BPTC_UNSIGNED_Format%3A%0A%20%20%20%20%20%20return%20Math.ceil%28width%20%2F%204%29%20%2A%20Math.ceil%28height%20%2F%204%29%20%2A%2016%3B%0A%20%20%20%20%2F%2F%20https%3A%2F%2Fregistry.khronos.org%2Fwebgl%2Fextensions%2FEXT_texture_compression_rgtc%2F%0A%20%20%20%20case%20RED_RGTC1_Format%3A%0A%20%20%20%20case%20SIGNED_RED_RGTC1_Format%3A%0A%20%20%20%20%20%20return%20Math.ceil%28width%20%2F%204%29%20%2A%20Math.ceil%28height%20%2F%204%29%20%2A%208%3B%0A%20%20%20%20case%20RED_GREEN_RGTC2_Format%3A%0A%20%20%20%20case%20SIGNED_RED_GREEN_RGTC2_Format%3A%0A%20%20%20%20%20%20return%20Math.ceil%28width%20%2F%204%29%20%2A%20Math.ceil%28height%20%2F%204%29%20%2A%2016%3B%0A%20%20%7D%0A%20%20throw%20new%20Error%28%0A%20%20%20%20%60Unable%20to%20determine%20texture%20byte%20length%20for%20%24%7Bformat2%7D%20format.%60%0A%20%20%29%3B%0A%7D%0Afunction%20getTextureTypeByteLength%28type%29%20%7B%0A%20%20switch%20%28type%29%20%7B%0A%20%20%20%20case%20UnsignedByteType%3A%0A%20%20%20%20case%20ByteType%3A%0A%20%20%20%20%20%20return%20%7B%20byteLength%3A%201%2C%20components%3A%201%20%7D%3B%0A%20%20%20%20case%20UnsignedShortType%3A%0A%20%20%20%20case%20ShortType%3A%0A%20%20%20%20case%20HalfFloatType%3A%0A%20%20%20%20%20%20return%20%7B%20byteLength%3A%202%2C%20components%3A%201%20%7D%3B%0A%20%20%20%20case%20UnsignedShort4444Type%3A%0A%20%20%20%20case%20UnsignedShort5551Type%3A%0A%20%20%20%20%20%20return%20%7B%20byteLength%3A%202%2C%20components%3A%204%20%7D%3B%0A%20%20%20%20case%20UnsignedIntType%3A%0A%20%20%20%20case%20IntType%3A%0A%20%20%20%20case%20FloatType%3A%0A%20%20%20%20%20%20return%20%7B%20byteLength%3A%204%2C%20components%3A%201%20%7D%3B%0A%20%20%20%20case%20UnsignedInt5999Type%3A%0A%20%20%20%20%20%20return%20%7B%20byteLength%3A%204%2C%20components%3A%203%20%7D%3B%0A%20%20%7D%0A%20%20throw%20new%20Error%28%60Unknown%20texture%20type%20%24%7Btype%7D.%60%29%3B%0A%7D%0Afunction%20WebGLTextures%28_gl%2C%20extensions%2C%20state%2C%20properties%2C%20capabilities%2C%20utils%2C%20info%29%20%7B%0A%20%20const%20multisampledRTTExt%20%3D%20extensions.has%28%22WEBGL_multisampled_render_to_texture%22%29%20%3F%20extensions.get%28%22WEBGL_multisampled_render_to_texture%22%29%20%3A%20null%3B%0A%20%20const%20supportsInvalidateFramebuffer%20%3D%20typeof%20navigator%20%3D%3D%3D%20%22undefined%22%20%3F%20false%20%3A%20%2FOculusBrowser%2Fg.test%28navigator.userAgent%29%3B%0A%20%20const%20_imageDimensions%20%3D%20new%20Vector2%28%29%3B%0A%20%20const%20_videoTextures%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20let%20_canvas3%3B%0A%20%20const%20_sources%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20let%20useOffscreenCanvas%20%3D%20false%3B%0A%20%20try%20%7B%0A%20%20%20%20useOffscreenCanvas%20%3D%20typeof%20OffscreenCanvas%20%21%3D%3D%20%22undefined%22%20%26%26%20new%20OffscreenCanvas%281%2C%201%29.getContext%28%222d%22%29%20%21%3D%3D%20null%3B%0A%20%20%7D%20catch%20%28err%29%20%7B%0A%20%20%7D%0A%20%20function%20createCanvas%28width%2C%20height%29%20%7B%0A%20%20%20%20return%20useOffscreenCanvas%20%3F%20%28%0A%20%20%20%20%20%20%2F%2F%20eslint-disable-next-line%20compat%2Fcompat%0A%20%20%20%20%20%20new%20OffscreenCanvas%28width%2C%20height%29%0A%20%20%20%20%29%20%3A%20createElementNS%28%22canvas%22%29%3B%0A%20%20%7D%0A%20%20function%20resizeImage%28image%2C%20needsNewCanvas%2C%20maxSize%29%20%7B%0A%20%20%20%20let%20scale%20%3D%201%3B%0A%20%20%20%20const%20dimensions%20%3D%20getDimensions%28image%29%3B%0A%20%20%20%20if%20%28dimensions.width%20%3E%20maxSize%20%7C%7C%20dimensions.height%20%3E%20maxSize%29%20%7B%0A%20%20%20%20%20%20scale%20%3D%20maxSize%20%2F%20Math.max%28dimensions.width%2C%20dimensions.height%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28scale%20%3C%201%29%20%7B%0A%20%20%20%20%20%20if%20%28typeof%20HTMLImageElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLImageElement%20%7C%7C%20typeof%20HTMLCanvasElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLCanvasElement%20%7C%7C%20typeof%20ImageBitmap%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20ImageBitmap%20%7C%7C%20typeof%20VideoFrame%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20VideoFrame%29%20%7B%0A%20%20%20%20%20%20%20%20const%20width%20%3D%20Math.floor%28scale%20%2A%20dimensions.width%29%3B%0A%20%20%20%20%20%20%20%20const%20height%20%3D%20Math.floor%28scale%20%2A%20dimensions.height%29%3B%0A%20%20%20%20%20%20%20%20if%20%28_canvas3%20%3D%3D%3D%20void%200%29%20_canvas3%20%3D%20createCanvas%28width%2C%20height%29%3B%0A%20%20%20%20%20%20%20%20const%20canvas%20%3D%20needsNewCanvas%20%3F%20createCanvas%28width%2C%20height%29%20%3A%20_canvas3%3B%0A%20%20%20%20%20%20%20%20canvas.width%20%3D%20width%3B%0A%20%20%20%20%20%20%20%20canvas.height%20%3D%20height%3B%0A%20%20%20%20%20%20%20%20const%20context2%20%3D%20canvas.getContext%28%222d%22%29%3B%0A%20%20%20%20%20%20%20%20context2.drawImage%28image%2C%200%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Texture%20has%20been%20resized%20from%20%28%22%20%2B%20dimensions.width%20%2B%20%22x%22%20%2B%20dimensions.height%20%2B%20%22%29%20to%20%28%22%20%2B%20width%20%2B%20%22x%22%20%2B%20height%20%2B%20%22%29.%22%29%3B%0A%20%20%20%20%20%20%20%20return%20canvas%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%22data%22%20in%20image%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Image%20in%20DataTexture%20is%20too%20big%20%28%22%20%2B%20dimensions.width%20%2B%20%22x%22%20%2B%20dimensions.height%20%2B%20%22%29.%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20image%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20image%3B%0A%20%20%7D%0A%20%20function%20textureNeedsGenerateMipmaps%28texture2%29%20%7B%0A%20%20%20%20return%20texture2.generateMipmaps%3B%0A%20%20%7D%0A%20%20function%20generateMipmap%28target%29%20%7B%0A%20%20%20%20_gl.generateMipmap%28target%29%3B%0A%20%20%7D%0A%20%20function%20getTargetType%28texture2%29%20%7B%0A%20%20%20%20if%20%28texture2.isWebGLCubeRenderTarget%29%20return%20_gl.TEXTURE_CUBE_MAP%3B%0A%20%20%20%20if%20%28texture2.isWebGL3DRenderTarget%29%20return%20_gl.TEXTURE_3D%3B%0A%20%20%20%20if%20%28texture2.isWebGLArrayRenderTarget%20%7C%7C%20texture2.isCompressedArrayTexture%29%20return%20_gl.TEXTURE_2D_ARRAY%3B%0A%20%20%20%20return%20_gl.TEXTURE_2D%3B%0A%20%20%7D%0A%20%20function%20getInternalFormat%28internalFormatName%2C%20glFormat%2C%20glType%2C%20colorSpace%2C%20forceLinearTransfer%20%3D%20false%29%20%7B%0A%20%20%20%20if%20%28internalFormatName%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28_gl%5BinternalFormatName%5D%20%21%3D%3D%20void%200%29%20return%20_gl%5BinternalFormatName%5D%3B%0A%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Attempt%20to%20use%20non-existing%20WebGL%20internal%20format%20%27%22%20%2B%20internalFormatName%20%2B%20%22%27%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20internalFormat%20%3D%20glFormat%3B%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20_gl.RED%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.FLOAT%29%20internalFormat%20%3D%20_gl.R32F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.HALF_FLOAT%29%20internalFormat%20%3D%20_gl.R16F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20_gl.R8%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20_gl.RED_INTEGER%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20_gl.R8UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20_gl.R16UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_INT%29%20internalFormat%20%3D%20_gl.R32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.BYTE%29%20internalFormat%20%3D%20_gl.R8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.SHORT%29%20internalFormat%20%3D%20_gl.R16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.INT%29%20internalFormat%20%3D%20_gl.R32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20_gl.RG%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.FLOAT%29%20internalFormat%20%3D%20_gl.RG32F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.HALF_FLOAT%29%20internalFormat%20%3D%20_gl.RG16F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20_gl.RG8%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20_gl.RG_INTEGER%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20_gl.RG8UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20_gl.RG16UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_INT%29%20internalFormat%20%3D%20_gl.RG32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.BYTE%29%20internalFormat%20%3D%20_gl.RG8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.SHORT%29%20internalFormat%20%3D%20_gl.RG16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.INT%29%20internalFormat%20%3D%20_gl.RG32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20_gl.RGB_INTEGER%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20_gl.RGB8UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20_gl.RGB16UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_INT%29%20internalFormat%20%3D%20_gl.RGB32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.BYTE%29%20internalFormat%20%3D%20_gl.RGB8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.SHORT%29%20internalFormat%20%3D%20_gl.RGB16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.INT%29%20internalFormat%20%3D%20_gl.RGB32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20_gl.RGBA_INTEGER%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20_gl.RGBA8UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20_gl.RGBA16UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_INT%29%20internalFormat%20%3D%20_gl.RGBA32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.BYTE%29%20internalFormat%20%3D%20_gl.RGBA8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.SHORT%29%20internalFormat%20%3D%20_gl.RGBA16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.INT%29%20internalFormat%20%3D%20_gl.RGBA32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20_gl.RGB%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_INT_5_9_9_9_REV%29%20internalFormat%20%3D%20_gl.RGB9_E5%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20_gl.RGBA%29%20%7B%0A%20%20%20%20%20%20const%20transfer%20%3D%20forceLinearTransfer%20%3F%20LinearTransfer%20%3A%20ColorManagement.getTransfer%28colorSpace%29%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.FLOAT%29%20internalFormat%20%3D%20_gl.RGBA32F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.HALF_FLOAT%29%20internalFormat%20%3D%20_gl.RGBA16F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20_gl.SRGB8_ALPHA8%20%3A%20_gl.RGBA8%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_SHORT_4_4_4_4%29%20internalFormat%20%3D%20_gl.RGBA4%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20_gl.UNSIGNED_SHORT_5_5_5_1%29%20internalFormat%20%3D%20_gl.RGB5_A1%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28internalFormat%20%3D%3D%3D%20_gl.R16F%20%7C%7C%20internalFormat%20%3D%3D%3D%20_gl.R32F%20%7C%7C%20internalFormat%20%3D%3D%3D%20_gl.RG16F%20%7C%7C%20internalFormat%20%3D%3D%3D%20_gl.RG32F%20%7C%7C%20internalFormat%20%3D%3D%3D%20_gl.RGBA16F%20%7C%7C%20internalFormat%20%3D%3D%3D%20_gl.RGBA32F%29%20%7B%0A%20%20%20%20%20%20extensions.get%28%22EXT_color_buffer_float%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20internalFormat%3B%0A%20%20%7D%0A%20%20function%20getInternalDepthFormat%28useStencil%2C%20depthType%29%20%7B%0A%20%20%20%20let%20glInternalFormat%3B%0A%20%20%20%20if%20%28useStencil%29%20%7B%0A%20%20%20%20%20%20if%20%28depthType%20%3D%3D%3D%20null%20%7C%7C%20depthType%20%3D%3D%3D%20UnsignedIntType%20%7C%7C%20depthType%20%3D%3D%3D%20UnsignedInt248Type%29%20%7B%0A%20%20%20%20%20%20%20%20glInternalFormat%20%3D%20_gl.DEPTH24_STENCIL8%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28depthType%20%3D%3D%3D%20FloatType%29%20%7B%0A%20%20%20%20%20%20%20%20glInternalFormat%20%3D%20_gl.DEPTH32F_STENCIL8%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28depthType%20%3D%3D%3D%20UnsignedShortType%29%20%7B%0A%20%20%20%20%20%20%20%20glInternalFormat%20%3D%20_gl.DEPTH24_STENCIL8%3B%0A%20%20%20%20%20%20%20%20console.warn%28%22DepthTexture%3A%2016%20bit%20depth%20attachment%20is%20not%20supported%20with%20stencil.%20Using%2024-bit%20attachment.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28depthType%20%3D%3D%3D%20null%20%7C%7C%20depthType%20%3D%3D%3D%20UnsignedIntType%20%7C%7C%20depthType%20%3D%3D%3D%20UnsignedInt248Type%29%20%7B%0A%20%20%20%20%20%20%20%20glInternalFormat%20%3D%20_gl.DEPTH_COMPONENT24%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28depthType%20%3D%3D%3D%20FloatType%29%20%7B%0A%20%20%20%20%20%20%20%20glInternalFormat%20%3D%20_gl.DEPTH_COMPONENT32F%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28depthType%20%3D%3D%3D%20UnsignedShortType%29%20%7B%0A%20%20%20%20%20%20%20%20glInternalFormat%20%3D%20_gl.DEPTH_COMPONENT16%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20glInternalFormat%3B%0A%20%20%7D%0A%20%20function%20getMipLevels%28texture2%2C%20image%29%20%7B%0A%20%20%20%20if%20%28textureNeedsGenerateMipmaps%28texture2%29%20%3D%3D%3D%20true%20%7C%7C%20texture2.isFramebufferTexture%20%26%26%20texture2.minFilter%20%21%3D%3D%20NearestFilter%20%26%26%20texture2.minFilter%20%21%3D%3D%20LinearFilter%29%20%7B%0A%20%20%20%20%20%20return%20Math.log2%28Math.max%28image.width%2C%20image.height%29%29%20%2B%201%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.mipmaps%20%21%3D%3D%20void%200%20%26%26%20texture2.mipmaps.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20return%20texture2.mipmaps.length%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isCompressedTexture%20%26%26%20Array.isArray%28texture2.image%29%29%20%7B%0A%20%20%20%20%20%20return%20image.mipmaps.length%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20onTextureDispose2%28event%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20event.target%3B%0A%20%20%20%20texture2.removeEventListener%28%22dispose%22%2C%20onTextureDispose2%29%3B%0A%20%20%20%20deallocateTexture%28texture2%29%3B%0A%20%20%20%20if%20%28texture2.isVideoTexture%29%20%7B%0A%20%20%20%20%20%20_videoTextures.delete%28texture2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20onRenderTargetDispose%28event%29%20%7B%0A%20%20%20%20const%20renderTarget%20%3D%20event.target%3B%0A%20%20%20%20renderTarget.removeEventListener%28%22dispose%22%2C%20onRenderTargetDispose%29%3B%0A%20%20%20%20deallocateRenderTarget%28renderTarget%29%3B%0A%20%20%7D%0A%20%20function%20deallocateTexture%28texture2%29%20%7B%0A%20%20%20%20const%20textureProperties%20%3D%20properties.get%28texture2%29%3B%0A%20%20%20%20if%20%28textureProperties.__webglInit%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20const%20source%20%3D%20texture2.source%3B%0A%20%20%20%20const%20webglTextures%20%3D%20_sources.get%28source%29%3B%0A%20%20%20%20if%20%28webglTextures%29%20%7B%0A%20%20%20%20%20%20const%20webglTexture%20%3D%20webglTextures%5BtextureProperties.__cacheKey%5D%3B%0A%20%20%20%20%20%20webglTexture.usedTimes--%3B%0A%20%20%20%20%20%20if%20%28webglTexture.usedTimes%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20deleteTexture%28texture2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28Object.keys%28webglTextures%29.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20_sources.delete%28source%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20properties.remove%28texture2%29%3B%0A%20%20%7D%0A%20%20function%20deleteTexture%28texture2%29%20%7B%0A%20%20%20%20const%20textureProperties%20%3D%20properties.get%28texture2%29%3B%0A%20%20%20%20_gl.deleteTexture%28textureProperties.__webglTexture%29%3B%0A%20%20%20%20const%20source%20%3D%20texture2.source%3B%0A%20%20%20%20const%20webglTextures%20%3D%20_sources.get%28source%29%3B%0A%20%20%20%20delete%20webglTextures%5BtextureProperties.__cacheKey%5D%3B%0A%20%20%20%20info.memory.textures--%3B%0A%20%20%7D%0A%20%20function%20deallocateRenderTarget%28renderTarget%29%20%7B%0A%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20if%20%28renderTarget.depthTexture%29%20%7B%0A%20%20%20%20%20%20renderTarget.depthTexture.dispose%28%29%3B%0A%20%20%20%20%20%20properties.remove%28renderTarget.depthTexture%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderTarget.isWebGLCubeRenderTarget%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28Array.isArray%28renderTargetProperties.__webglFramebuffer%5Bi%5D%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20level%20%3D%200%3B%20level%20%3C%20renderTargetProperties.__webglFramebuffer%5Bi%5D.length%3B%20level%2B%2B%29%20_gl.deleteFramebuffer%28renderTargetProperties.__webglFramebuffer%5Bi%5D%5Blevel%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20_gl.deleteFramebuffer%28renderTargetProperties.__webglFramebuffer%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28renderTargetProperties.__webglDepthbuffer%29%20_gl.deleteRenderbuffer%28renderTargetProperties.__webglDepthbuffer%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28Array.isArray%28renderTargetProperties.__webglFramebuffer%29%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20level%20%3D%200%3B%20level%20%3C%20renderTargetProperties.__webglFramebuffer.length%3B%20level%2B%2B%29%20_gl.deleteFramebuffer%28renderTargetProperties.__webglFramebuffer%5Blevel%5D%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_gl.deleteFramebuffer%28renderTargetProperties.__webglFramebuffer%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderTargetProperties.__webglDepthbuffer%29%20_gl.deleteRenderbuffer%28renderTargetProperties.__webglDepthbuffer%29%3B%0A%20%20%20%20%20%20if%20%28renderTargetProperties.__webglMultisampledFramebuffer%29%20_gl.deleteFramebuffer%28renderTargetProperties.__webglMultisampledFramebuffer%29%3B%0A%20%20%20%20%20%20if%20%28renderTargetProperties.__webglColorRenderbuffer%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20renderTargetProperties.__webglColorRenderbuffer.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28renderTargetProperties.__webglColorRenderbuffer%5Bi%5D%29%20_gl.deleteRenderbuffer%28renderTargetProperties.__webglColorRenderbuffer%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderTargetProperties.__webglDepthRenderbuffer%29%20_gl.deleteRenderbuffer%28renderTargetProperties.__webglDepthRenderbuffer%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20textures%20%3D%20renderTarget.textures%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20attachmentProperties%20%3D%20properties.get%28textures%5Bi%5D%29%3B%0A%20%20%20%20%20%20if%20%28attachmentProperties.__webglTexture%29%20%7B%0A%20%20%20%20%20%20%20%20_gl.deleteTexture%28attachmentProperties.__webglTexture%29%3B%0A%20%20%20%20%20%20%20%20info.memory.textures--%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20properties.remove%28textures%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20properties.remove%28renderTarget%29%3B%0A%20%20%7D%0A%20%20let%20textureUnits%20%3D%200%3B%0A%20%20function%20resetTextureUnits%28%29%20%7B%0A%20%20%20%20textureUnits%20%3D%200%3B%0A%20%20%7D%0A%20%20function%20allocateTextureUnit%28%29%20%7B%0A%20%20%20%20const%20textureUnit%20%3D%20textureUnits%3B%0A%20%20%20%20if%20%28textureUnit%20%3E%3D%20capabilities.maxTextures%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.WebGLTextures%3A%20Trying%20to%20use%20%22%20%2B%20textureUnit%20%2B%20%22%20texture%20units%20while%20this%20GPU%20supports%20only%20%22%20%2B%20capabilities.maxTextures%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20textureUnits%20%2B%3D%201%3B%0A%20%20%20%20return%20textureUnit%3B%0A%20%20%7D%0A%20%20function%20getTextureCacheKey%28texture2%29%20%7B%0A%20%20%20%20const%20array%20%3D%20%5B%5D%3B%0A%20%20%20%20array.push%28texture2.wrapS%29%3B%0A%20%20%20%20array.push%28texture2.wrapT%29%3B%0A%20%20%20%20array.push%28texture2.wrapR%20%7C%7C%200%29%3B%0A%20%20%20%20array.push%28texture2.magFilter%29%3B%0A%20%20%20%20array.push%28texture2.minFilter%29%3B%0A%20%20%20%20array.push%28texture2.anisotropy%29%3B%0A%20%20%20%20array.push%28texture2.internalFormat%29%3B%0A%20%20%20%20array.push%28texture2.format%29%3B%0A%20%20%20%20array.push%28texture2.type%29%3B%0A%20%20%20%20array.push%28texture2.generateMipmaps%29%3B%0A%20%20%20%20array.push%28texture2.premultiplyAlpha%29%3B%0A%20%20%20%20array.push%28texture2.flipY%29%3B%0A%20%20%20%20array.push%28texture2.unpackAlignment%29%3B%0A%20%20%20%20array.push%28texture2.colorSpace%29%3B%0A%20%20%20%20return%20array.join%28%29%3B%0A%20%20%7D%0A%20%20function%20setTexture2D%28texture2%2C%20slot%29%20%7B%0A%20%20%20%20const%20textureProperties%20%3D%20properties.get%28texture2%29%3B%0A%20%20%20%20if%20%28texture2.isVideoTexture%29%20updateVideoTexture%28texture2%29%3B%0A%20%20%20%20if%20%28texture2.isRenderTargetTexture%20%3D%3D%3D%20false%20%26%26%20texture2.version%20%3E%200%20%26%26%20textureProperties.__version%20%21%3D%3D%20texture2.version%29%20%7B%0A%20%20%20%20%20%20const%20image%20%3D%20texture2.image%3B%0A%20%20%20%20%20%20if%20%28image%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Texture%20marked%20for%20update%20but%20no%20image%20data%20found.%22%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28image.complete%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Texture%20marked%20for%20update%20but%20image%20is%20incomplete%22%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20uploadTexture%28textureProperties%2C%20texture2%2C%20slot%29%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20state.bindTexture%28_gl.TEXTURE_2D%2C%20textureProperties.__webglTexture%2C%20_gl.TEXTURE0%20%2B%20slot%29%3B%0A%20%20%7D%0A%20%20function%20setTexture2DArray%28texture2%2C%20slot%29%20%7B%0A%20%20%20%20const%20textureProperties%20%3D%20properties.get%28texture2%29%3B%0A%20%20%20%20if%20%28texture2.version%20%3E%200%20%26%26%20textureProperties.__version%20%21%3D%3D%20texture2.version%29%20%7B%0A%20%20%20%20%20%20uploadTexture%28textureProperties%2C%20texture2%2C%20slot%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.bindTexture%28_gl.TEXTURE_2D_ARRAY%2C%20textureProperties.__webglTexture%2C%20_gl.TEXTURE0%20%2B%20slot%29%3B%0A%20%20%7D%0A%20%20function%20setTexture3D%28texture2%2C%20slot%29%20%7B%0A%20%20%20%20const%20textureProperties%20%3D%20properties.get%28texture2%29%3B%0A%20%20%20%20if%20%28texture2.version%20%3E%200%20%26%26%20textureProperties.__version%20%21%3D%3D%20texture2.version%29%20%7B%0A%20%20%20%20%20%20uploadTexture%28textureProperties%2C%20texture2%2C%20slot%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.bindTexture%28_gl.TEXTURE_3D%2C%20textureProperties.__webglTexture%2C%20_gl.TEXTURE0%20%2B%20slot%29%3B%0A%20%20%7D%0A%20%20function%20setTextureCube%28texture2%2C%20slot%29%20%7B%0A%20%20%20%20const%20textureProperties%20%3D%20properties.get%28texture2%29%3B%0A%20%20%20%20if%20%28texture2.version%20%3E%200%20%26%26%20textureProperties.__version%20%21%3D%3D%20texture2.version%29%20%7B%0A%20%20%20%20%20%20uploadCubeTexture%28textureProperties%2C%20texture2%2C%20slot%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.bindTexture%28_gl.TEXTURE_CUBE_MAP%2C%20textureProperties.__webglTexture%2C%20_gl.TEXTURE0%20%2B%20slot%29%3B%0A%20%20%7D%0A%20%20const%20wrappingToGL2%20%3D%20%7B%0A%20%20%20%20%5BRepeatWrapping%5D%3A%20_gl.REPEAT%2C%0A%20%20%20%20%5BClampToEdgeWrapping%5D%3A%20_gl.CLAMP_TO_EDGE%2C%0A%20%20%20%20%5BMirroredRepeatWrapping%5D%3A%20_gl.MIRRORED_REPEAT%0A%20%20%7D%3B%0A%20%20const%20filterToGL2%20%3D%20%7B%0A%20%20%20%20%5BNearestFilter%5D%3A%20_gl.NEAREST%2C%0A%20%20%20%20%5BNearestMipmapNearestFilter%5D%3A%20_gl.NEAREST_MIPMAP_NEAREST%2C%0A%20%20%20%20%5BNearestMipmapLinearFilter%5D%3A%20_gl.NEAREST_MIPMAP_LINEAR%2C%0A%20%20%20%20%5BLinearFilter%5D%3A%20_gl.LINEAR%2C%0A%20%20%20%20%5BLinearMipmapNearestFilter%5D%3A%20_gl.LINEAR_MIPMAP_NEAREST%2C%0A%20%20%20%20%5BLinearMipmapLinearFilter%5D%3A%20_gl.LINEAR_MIPMAP_LINEAR%0A%20%20%7D%3B%0A%20%20const%20compareToGL2%20%3D%20%7B%0A%20%20%20%20%5BNeverCompare%5D%3A%20_gl.NEVER%2C%0A%20%20%20%20%5BAlwaysCompare%5D%3A%20_gl.ALWAYS%2C%0A%20%20%20%20%5BLessCompare%5D%3A%20_gl.LESS%2C%0A%20%20%20%20%5BLessEqualCompare%5D%3A%20_gl.LEQUAL%2C%0A%20%20%20%20%5BEqualCompare%5D%3A%20_gl.EQUAL%2C%0A%20%20%20%20%5BGreaterEqualCompare%5D%3A%20_gl.GEQUAL%2C%0A%20%20%20%20%5BGreaterCompare%5D%3A%20_gl.GREATER%2C%0A%20%20%20%20%5BNotEqualCompare%5D%3A%20_gl.NOTEQUAL%0A%20%20%7D%3B%0A%20%20function%20setTextureParameters%28textureType%2C%20texture2%29%20%7B%0A%20%20%20%20if%20%28texture2.type%20%3D%3D%3D%20FloatType%20%26%26%20extensions.has%28%22OES_texture_float_linear%22%29%20%3D%3D%3D%20false%20%26%26%20%28texture2.magFilter%20%3D%3D%3D%20LinearFilter%20%7C%7C%20texture2.magFilter%20%3D%3D%3D%20LinearMipmapNearestFilter%20%7C%7C%20texture2.magFilter%20%3D%3D%3D%20NearestMipmapLinearFilter%20%7C%7C%20texture2.magFilter%20%3D%3D%3D%20LinearMipmapLinearFilter%20%7C%7C%20texture2.minFilter%20%3D%3D%3D%20LinearFilter%20%7C%7C%20texture2.minFilter%20%3D%3D%3D%20LinearMipmapNearestFilter%20%7C%7C%20texture2.minFilter%20%3D%3D%3D%20NearestMipmapLinearFilter%20%7C%7C%20texture2.minFilter%20%3D%3D%3D%20LinearMipmapLinearFilter%29%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Unable%20to%20use%20linear%20filtering%20with%20floating%20point%20textures.%20OES_texture_float_linear%20not%20supported%20on%20this%20device.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_gl.texParameteri%28textureType%2C%20_gl.TEXTURE_WRAP_S%2C%20wrappingToGL2%5Btexture2.wrapS%5D%29%3B%0A%20%20%20%20_gl.texParameteri%28textureType%2C%20_gl.TEXTURE_WRAP_T%2C%20wrappingToGL2%5Btexture2.wrapT%5D%29%3B%0A%20%20%20%20if%20%28textureType%20%3D%3D%3D%20_gl.TEXTURE_3D%20%7C%7C%20textureType%20%3D%3D%3D%20_gl.TEXTURE_2D_ARRAY%29%20%7B%0A%20%20%20%20%20%20_gl.texParameteri%28textureType%2C%20_gl.TEXTURE_WRAP_R%2C%20wrappingToGL2%5Btexture2.wrapR%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_gl.texParameteri%28textureType%2C%20_gl.TEXTURE_MAG_FILTER%2C%20filterToGL2%5Btexture2.magFilter%5D%29%3B%0A%20%20%20%20_gl.texParameteri%28textureType%2C%20_gl.TEXTURE_MIN_FILTER%2C%20filterToGL2%5Btexture2.minFilter%5D%29%3B%0A%20%20%20%20if%20%28texture2.compareFunction%29%20%7B%0A%20%20%20%20%20%20_gl.texParameteri%28textureType%2C%20_gl.TEXTURE_COMPARE_MODE%2C%20_gl.COMPARE_REF_TO_TEXTURE%29%3B%0A%20%20%20%20%20%20_gl.texParameteri%28textureType%2C%20_gl.TEXTURE_COMPARE_FUNC%2C%20compareToGL2%5Btexture2.compareFunction%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28extensions.has%28%22EXT_texture_filter_anisotropic%22%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20if%20%28texture2.magFilter%20%3D%3D%3D%20NearestFilter%29%20return%3B%0A%20%20%20%20%20%20if%20%28texture2.minFilter%20%21%3D%3D%20NearestMipmapLinearFilter%20%26%26%20texture2.minFilter%20%21%3D%3D%20LinearMipmapLinearFilter%29%20return%3B%0A%20%20%20%20%20%20if%20%28texture2.type%20%3D%3D%3D%20FloatType%20%26%26%20extensions.has%28%22OES_texture_float_linear%22%29%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20if%20%28texture2.anisotropy%20%3E%201%20%7C%7C%20properties.get%28texture2%29.__currentAnisotropy%29%20%7B%0A%20%20%20%20%20%20%20%20const%20extension%20%3D%20extensions.get%28%22EXT_texture_filter_anisotropic%22%29%3B%0A%20%20%20%20%20%20%20%20_gl.texParameterf%28textureType%2C%20extension.TEXTURE_MAX_ANISOTROPY_EXT%2C%20Math.min%28texture2.anisotropy%2C%20capabilities.getMaxAnisotropy%28%29%29%29%3B%0A%20%20%20%20%20%20%20%20properties.get%28texture2%29.__currentAnisotropy%20%3D%20texture2.anisotropy%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20initTexture%28textureProperties%2C%20texture2%29%20%7B%0A%20%20%20%20let%20forceUpload%20%3D%20false%3B%0A%20%20%20%20if%20%28textureProperties.__webglInit%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20textureProperties.__webglInit%20%3D%20true%3B%0A%20%20%20%20%20%20texture2.addEventListener%28%22dispose%22%2C%20onTextureDispose2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20source%20%3D%20texture2.source%3B%0A%20%20%20%20let%20webglTextures%20%3D%20_sources.get%28source%29%3B%0A%20%20%20%20if%20%28webglTextures%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20webglTextures%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20_sources.set%28source%2C%20webglTextures%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20textureCacheKey%20%3D%20getTextureCacheKey%28texture2%29%3B%0A%20%20%20%20if%20%28textureCacheKey%20%21%3D%3D%20textureProperties.__cacheKey%29%20%7B%0A%20%20%20%20%20%20if%20%28webglTextures%5BtextureCacheKey%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20webglTextures%5BtextureCacheKey%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture%3A%20_gl.createTexture%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20usedTimes%3A%200%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20info.memory.textures%2B%2B%3B%0A%20%20%20%20%20%20%20%20forceUpload%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20webglTextures%5BtextureCacheKey%5D.usedTimes%2B%2B%3B%0A%20%20%20%20%20%20const%20webglTexture%20%3D%20webglTextures%5BtextureProperties.__cacheKey%5D%3B%0A%20%20%20%20%20%20if%20%28webglTexture%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20webglTextures%5BtextureProperties.__cacheKey%5D.usedTimes--%3B%0A%20%20%20%20%20%20%20%20if%20%28webglTexture.usedTimes%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20deleteTexture%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20textureProperties.__cacheKey%20%3D%20textureCacheKey%3B%0A%20%20%20%20%20%20textureProperties.__webglTexture%20%3D%20webglTextures%5BtextureCacheKey%5D.texture%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20forceUpload%3B%0A%20%20%7D%0A%20%20function%20uploadTexture%28textureProperties%2C%20texture2%2C%20slot%29%20%7B%0A%20%20%20%20let%20textureType%20%3D%20_gl.TEXTURE_2D%3B%0A%20%20%20%20if%20%28texture2.isDataArrayTexture%20%7C%7C%20texture2.isCompressedArrayTexture%29%20textureType%20%3D%20_gl.TEXTURE_2D_ARRAY%3B%0A%20%20%20%20if%20%28texture2.isData3DTexture%29%20textureType%20%3D%20_gl.TEXTURE_3D%3B%0A%20%20%20%20const%20forceUpload%20%3D%20initTexture%28textureProperties%2C%20texture2%29%3B%0A%20%20%20%20const%20source%20%3D%20texture2.source%3B%0A%20%20%20%20state.bindTexture%28textureType%2C%20textureProperties.__webglTexture%2C%20_gl.TEXTURE0%20%2B%20slot%29%3B%0A%20%20%20%20const%20sourceProperties%20%3D%20properties.get%28source%29%3B%0A%20%20%20%20if%20%28source.version%20%21%3D%3D%20sourceProperties.__version%20%7C%7C%20forceUpload%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20state.activeTexture%28_gl.TEXTURE0%20%2B%20slot%29%3B%0A%20%20%20%20%20%20const%20workingPrimaries%20%3D%20ColorManagement.getPrimaries%28ColorManagement.workingColorSpace%29%3B%0A%20%20%20%20%20%20const%20texturePrimaries%20%3D%20texture2.colorSpace%20%3D%3D%3D%20NoColorSpace%20%3F%20null%20%3A%20ColorManagement.getPrimaries%28texture2.colorSpace%29%3B%0A%20%20%20%20%20%20const%20unpackConversion%20%3D%20texture2.colorSpace%20%3D%3D%3D%20NoColorSpace%20%7C%7C%20workingPrimaries%20%3D%3D%3D%20texturePrimaries%20%3F%20_gl.NONE%20%3A%20_gl.BROWSER_DEFAULT_WEBGL%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_FLIP_Y_WEBGL%2C%20texture2.flipY%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL%2C%20texture2.premultiplyAlpha%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_ALIGNMENT%2C%20texture2.unpackAlignment%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_COLORSPACE_CONVERSION_WEBGL%2C%20unpackConversion%29%3B%0A%20%20%20%20%20%20let%20image%20%3D%20resizeImage%28texture2.image%2C%20false%2C%20capabilities.maxTextureSize%29%3B%0A%20%20%20%20%20%20image%20%3D%20verifyColorSpace%28texture2%2C%20image%29%3B%0A%20%20%20%20%20%20const%20glFormat%20%3D%20utils.convert%28texture2.format%2C%20texture2.colorSpace%29%3B%0A%20%20%20%20%20%20const%20glType%20%3D%20utils.convert%28texture2.type%29%3B%0A%20%20%20%20%20%20let%20glInternalFormat%20%3D%20getInternalFormat%28texture2.internalFormat%2C%20glFormat%2C%20glType%2C%20texture2.colorSpace%2C%20texture2.isVideoTexture%29%3B%0A%20%20%20%20%20%20setTextureParameters%28textureType%2C%20texture2%29%3B%0A%20%20%20%20%20%20let%20mipmap%3B%0A%20%20%20%20%20%20const%20mipmaps%20%3D%20texture2.mipmaps%3B%0A%20%20%20%20%20%20const%20useTexStorage%20%3D%20texture2.isVideoTexture%20%21%3D%3D%20true%3B%0A%20%20%20%20%20%20const%20allocateMemory%20%3D%20sourceProperties.__version%20%3D%3D%3D%20void%200%20%7C%7C%20forceUpload%20%3D%3D%3D%20true%3B%0A%20%20%20%20%20%20const%20dataReady%20%3D%20source.dataReady%3B%0A%20%20%20%20%20%20const%20levels%20%3D%20getMipLevels%28texture2%2C%20image%29%3B%0A%20%20%20%20%20%20if%20%28texture2.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20glInternalFormat%20%3D%20getInternalDepthFormat%28texture2.format%20%3D%3D%3D%20DepthStencilFormat%2C%20texture2.type%29%3B%0A%20%20%20%20%20%20%20%20if%20%28allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage2D%28_gl.TEXTURE_2D%2C%201%2C%20glInternalFormat%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_2D%2C%200%2C%20glInternalFormat%2C%20image.width%2C%20image.height%2C%200%2C%20glFormat%2C%20glType%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isDataTexture%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28mipmaps.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%20%26%26%20allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage2D%28_gl.TEXTURE_2D%2C%20levels%2C%20glInternalFormat%2C%20mipmaps%5B0%5D.width%2C%20mipmaps%5B0%5D.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20mipmaps.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20mipmap%20%3D%20mipmaps%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_2D%2C%20i%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20glFormat%2C%20glType%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_2D%2C%20i%2C%20glInternalFormat%2C%20mipmap.width%2C%20mipmap.height%2C%200%2C%20glFormat%2C%20glType%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20texture2.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage2D%28_gl.TEXTURE_2D%2C%20levels%2C%20glInternalFormat%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_2D%2C%200%2C%200%2C%200%2C%20image.width%2C%20image.height%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_2D%2C%200%2C%20glInternalFormat%2C%20image.width%2C%20image.height%2C%200%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isCompressedTexture%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28texture2.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%20%26%26%20allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage3D%28_gl.TEXTURE_2D_ARRAY%2C%20levels%2C%20glInternalFormat%2C%20mipmaps%5B0%5D.width%2C%20mipmaps%5B0%5D.height%2C%20image.depth%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20mipmaps.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20mipmap%20%3D%20mipmaps%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28texture2.format%20%21%3D%3D%20RGBAFormat%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28glFormat%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28texture2.layerUpdates.size%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20layerByteLength%20%3D%20getByteLength%28mipmap.width%2C%20mipmap.height%2C%20texture2.format%2C%20texture2.type%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20%28const%20layerIndex%20of%20texture2.layerUpdates%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20layerData%20%3D%20mipmap.data.subarray%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layerIndex%20%2A%20layerByteLength%20%2F%20mipmap.data.BYTES_PER_ELEMENT%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%28layerIndex%20%2B%201%29%20%2A%20layerByteLength%20%2F%20mipmap.data.BYTES_PER_ELEMENT%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.compressedTexSubImage3D%28_gl.TEXTURE_2D_ARRAY%2C%20i%2C%200%2C%200%2C%20layerIndex%2C%20mipmap.width%2C%20mipmap.height%2C%201%2C%20glFormat%2C%20layerData%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture2.clearLayerUpdates%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.compressedTexSubImage3D%28_gl.TEXTURE_2D_ARRAY%2C%20i%2C%200%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20image.depth%2C%20glFormat%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.compressedTexImage3D%28_gl.TEXTURE_2D_ARRAY%2C%20i%2C%20glInternalFormat%2C%20mipmap.width%2C%20mipmap.height%2C%20image.depth%2C%200%2C%20mipmap.data%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Attempt%20to%20load%20unsupported%20compressed%20texture%20format%20in%20.uploadTexture%28%29%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage3D%28_gl.TEXTURE_2D_ARRAY%2C%20i%2C%200%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20image.depth%2C%20glFormat%2C%20glType%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage3D%28_gl.TEXTURE_2D_ARRAY%2C%20i%2C%20glInternalFormat%2C%20mipmap.width%2C%20mipmap.height%2C%20image.depth%2C%200%2C%20glFormat%2C%20glType%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%20%26%26%20allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage2D%28_gl.TEXTURE_2D%2C%20levels%2C%20glInternalFormat%2C%20mipmaps%5B0%5D.width%2C%20mipmaps%5B0%5D.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20mipmaps.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20mipmap%20%3D%20mipmaps%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28texture2.format%20%21%3D%3D%20RGBAFormat%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28glFormat%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.compressedTexSubImage2D%28_gl.TEXTURE_2D%2C%20i%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20glFormat%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.compressedTexImage2D%28_gl.TEXTURE_2D%2C%20i%2C%20glInternalFormat%2C%20mipmap.width%2C%20mipmap.height%2C%200%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Attempt%20to%20load%20unsupported%20compressed%20texture%20format%20in%20.uploadTexture%28%29%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_2D%2C%20i%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20glFormat%2C%20glType%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_2D%2C%20i%2C%20glInternalFormat%2C%20mipmap.width%2C%20mipmap.height%2C%200%2C%20glFormat%2C%20glType%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isDataArrayTexture%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage3D%28_gl.TEXTURE_2D_ARRAY%2C%20levels%2C%20glInternalFormat%2C%20image.width%2C%20image.height%2C%20image.depth%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28texture2.layerUpdates.size%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20layerByteLength%20%3D%20getByteLength%28image.width%2C%20image.height%2C%20texture2.format%2C%20texture2.type%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20%28const%20layerIndex%20of%20texture2.layerUpdates%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20layerData%20%3D%20image.data.subarray%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layerIndex%20%2A%20layerByteLength%20%2F%20image.data.BYTES_PER_ELEMENT%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%28layerIndex%20%2B%201%29%20%2A%20layerByteLength%20%2F%20image.data.BYTES_PER_ELEMENT%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage3D%28_gl.TEXTURE_2D_ARRAY%2C%200%2C%200%2C%200%2C%20layerIndex%2C%20image.width%2C%20image.height%2C%201%2C%20glFormat%2C%20glType%2C%20layerData%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture2.clearLayerUpdates%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage3D%28_gl.TEXTURE_2D_ARRAY%2C%200%2C%200%2C%200%2C%200%2C%20image.width%2C%20image.height%2C%20image.depth%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.texImage3D%28_gl.TEXTURE_2D_ARRAY%2C%200%2C%20glInternalFormat%2C%20image.width%2C%20image.height%2C%20image.depth%2C%200%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isData3DTexture%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage3D%28_gl.TEXTURE_3D%2C%20levels%2C%20glInternalFormat%2C%20image.width%2C%20image.height%2C%20image.depth%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage3D%28_gl.TEXTURE_3D%2C%200%2C%200%2C%200%2C%200%2C%20image.width%2C%20image.height%2C%20image.depth%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.texImage3D%28_gl.TEXTURE_3D%2C%200%2C%20glInternalFormat%2C%20image.width%2C%20image.height%2C%20image.depth%2C%200%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isFramebufferTexture%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage2D%28_gl.TEXTURE_2D%2C%20levels%2C%20glInternalFormat%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20width%20%3D%20image.width%2C%20height%20%3D%20image.height%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20levels%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_2D%2C%20i%2C%20glInternalFormat%2C%20width%2C%20height%2C%200%2C%20glFormat%2C%20glType%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%20%3E%3E%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%20%3E%3E%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28mipmaps.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%20%26%26%20allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20dimensions%20%3D%20getDimensions%28mipmaps%5B0%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage2D%28_gl.TEXTURE_2D%2C%20levels%2C%20glInternalFormat%2C%20dimensions.width%2C%20dimensions.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20mipmaps.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20mipmap%20%3D%20mipmaps%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_2D%2C%20i%2C%200%2C%200%2C%20glFormat%2C%20glType%2C%20mipmap%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_2D%2C%20i%2C%20glInternalFormat%2C%20glFormat%2C%20glType%2C%20mipmap%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20texture2.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20dimensions%20%3D%20getDimensions%28image%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texStorage2D%28_gl.TEXTURE_2D%2C%20levels%2C%20glInternalFormat%2C%20dimensions.width%2C%20dimensions.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_2D%2C%200%2C%200%2C%200%2C%20glFormat%2C%20glType%2C%20image%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_2D%2C%200%2C%20glInternalFormat%2C%20glFormat%2C%20glType%2C%20image%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28textureNeedsGenerateMipmaps%28texture2%29%29%20%7B%0A%20%20%20%20%20%20%20%20generateMipmap%28textureType%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20sourceProperties.__version%20%3D%20source.version%3B%0A%20%20%20%20%20%20if%20%28texture2.onUpdate%29%20texture2.onUpdate%28texture2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20textureProperties.__version%20%3D%20texture2.version%3B%0A%20%20%7D%0A%20%20function%20uploadCubeTexture%28textureProperties%2C%20texture2%2C%20slot%29%20%7B%0A%20%20%20%20if%20%28texture2.image.length%20%21%3D%3D%206%29%20return%3B%0A%20%20%20%20const%20forceUpload%20%3D%20initTexture%28textureProperties%2C%20texture2%29%3B%0A%20%20%20%20const%20source%20%3D%20texture2.source%3B%0A%20%20%20%20state.bindTexture%28_gl.TEXTURE_CUBE_MAP%2C%20textureProperties.__webglTexture%2C%20_gl.TEXTURE0%20%2B%20slot%29%3B%0A%20%20%20%20const%20sourceProperties%20%3D%20properties.get%28source%29%3B%0A%20%20%20%20if%20%28source.version%20%21%3D%3D%20sourceProperties.__version%20%7C%7C%20forceUpload%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20state.activeTexture%28_gl.TEXTURE0%20%2B%20slot%29%3B%0A%20%20%20%20%20%20const%20workingPrimaries%20%3D%20ColorManagement.getPrimaries%28ColorManagement.workingColorSpace%29%3B%0A%20%20%20%20%20%20const%20texturePrimaries%20%3D%20texture2.colorSpace%20%3D%3D%3D%20NoColorSpace%20%3F%20null%20%3A%20ColorManagement.getPrimaries%28texture2.colorSpace%29%3B%0A%20%20%20%20%20%20const%20unpackConversion%20%3D%20texture2.colorSpace%20%3D%3D%3D%20NoColorSpace%20%7C%7C%20workingPrimaries%20%3D%3D%3D%20texturePrimaries%20%3F%20_gl.NONE%20%3A%20_gl.BROWSER_DEFAULT_WEBGL%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_FLIP_Y_WEBGL%2C%20texture2.flipY%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL%2C%20texture2.premultiplyAlpha%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_ALIGNMENT%2C%20texture2.unpackAlignment%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_COLORSPACE_CONVERSION_WEBGL%2C%20unpackConversion%29%3B%0A%20%20%20%20%20%20const%20isCompressed%20%3D%20texture2.isCompressedTexture%20%7C%7C%20texture2.image%5B0%5D.isCompressedTexture%3B%0A%20%20%20%20%20%20const%20isDataTexture%20%3D%20texture2.image%5B0%5D%20%26%26%20texture2.image%5B0%5D.isDataTexture%3B%0A%20%20%20%20%20%20const%20cubeImage%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21isCompressed%20%26%26%20%21isDataTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20cubeImage%5Bi%5D%20%3D%20resizeImage%28texture2.image%5Bi%5D%2C%20true%2C%20capabilities.maxCubemapSize%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20cubeImage%5Bi%5D%20%3D%20isDataTexture%20%3F%20texture2.image%5Bi%5D.image%20%3A%20texture2.image%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20cubeImage%5Bi%5D%20%3D%20verifyColorSpace%28texture2%2C%20cubeImage%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20image%20%3D%20cubeImage%5B0%5D%2C%20glFormat%20%3D%20utils.convert%28texture2.format%2C%20texture2.colorSpace%29%2C%20glType%20%3D%20utils.convert%28texture2.type%29%2C%20glInternalFormat%20%3D%20getInternalFormat%28texture2.internalFormat%2C%20glFormat%2C%20glType%2C%20texture2.colorSpace%29%3B%0A%20%20%20%20%20%20const%20useTexStorage%20%3D%20texture2.isVideoTexture%20%21%3D%3D%20true%3B%0A%20%20%20%20%20%20const%20allocateMemory%20%3D%20sourceProperties.__version%20%3D%3D%3D%20void%200%20%7C%7C%20forceUpload%20%3D%3D%3D%20true%3B%0A%20%20%20%20%20%20const%20dataReady%20%3D%20source.dataReady%3B%0A%20%20%20%20%20%20let%20levels%20%3D%20getMipLevels%28texture2%2C%20image%29%3B%0A%20%20%20%20%20%20setTextureParameters%28_gl.TEXTURE_CUBE_MAP%2C%20texture2%29%3B%0A%20%20%20%20%20%20let%20mipmaps%3B%0A%20%20%20%20%20%20if%20%28isCompressed%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28useTexStorage%20%26%26%20allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.texStorage2D%28_gl.TEXTURE_CUBE_MAP%2C%20levels%2C%20glInternalFormat%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20mipmaps%20%3D%20cubeImage%5Bi%5D.mipmaps%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20mipmaps.length%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20mipmap%20%3D%20mipmaps%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28texture2.format%20%21%3D%3D%20RGBAFormat%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28glFormat%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.compressedTexSubImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%20j%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20glFormat%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.compressedTexImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%20j%2C%20glInternalFormat%2C%20mipmap.width%2C%20mipmap.height%2C%200%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Attempt%20to%20load%20unsupported%20compressed%20texture%20format%20in%20.setTextureCube%28%29%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%20j%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20glFormat%2C%20glType%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%20j%2C%20glInternalFormat%2C%20mipmap.width%2C%20mipmap.height%2C%200%2C%20glFormat%2C%20glType%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20mipmaps%20%3D%20texture2.mipmaps%3B%0A%20%20%20%20%20%20%20%20if%20%28useTexStorage%20%26%26%20allocateMemory%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28mipmaps.length%20%3E%200%29%20levels%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20const%20dimensions%20%3D%20getDimensions%28cubeImage%5B0%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.texStorage2D%28_gl.TEXTURE_CUBE_MAP%2C%20levels%2C%20glInternalFormat%2C%20dimensions.width%2C%20dimensions.height%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28isDataTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%200%2C%200%2C%200%2C%20cubeImage%5Bi%5D.width%2C%20cubeImage%5Bi%5D.height%2C%20glFormat%2C%20glType%2C%20cubeImage%5Bi%5D.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%200%2C%20glInternalFormat%2C%20cubeImage%5Bi%5D.width%2C%20cubeImage%5Bi%5D.height%2C%200%2C%20glFormat%2C%20glType%2C%20cubeImage%5Bi%5D.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20mipmaps.length%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20mipmap%20%3D%20mipmaps%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20mipmapImage%20%3D%20mipmap.image%5Bi%5D.image%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%20j%20%2B%201%2C%200%2C%200%2C%20mipmapImage.width%2C%20mipmapImage.height%2C%20glFormat%2C%20glType%2C%20mipmapImage.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%20j%20%2B%201%2C%20glInternalFormat%2C%20mipmapImage.width%2C%20mipmapImage.height%2C%200%2C%20glFormat%2C%20glType%2C%20mipmapImage.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%200%2C%200%2C%200%2C%20glFormat%2C%20glType%2C%20cubeImage%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%200%2C%20glInternalFormat%2C%20glFormat%2C%20glType%2C%20cubeImage%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20mipmaps.length%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20mipmap%20%3D%20mipmaps%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useTexStorage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28dataReady%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texSubImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%20j%20%2B%201%2C%200%2C%200%2C%20glFormat%2C%20glType%2C%20mipmap.image%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.texImage2D%28_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%20j%20%2B%201%2C%20glInternalFormat%2C%20glFormat%2C%20glType%2C%20mipmap.image%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28textureNeedsGenerateMipmaps%28texture2%29%29%20%7B%0A%20%20%20%20%20%20%20%20generateMipmap%28_gl.TEXTURE_CUBE_MAP%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20sourceProperties.__version%20%3D%20source.version%3B%0A%20%20%20%20%20%20if%20%28texture2.onUpdate%29%20texture2.onUpdate%28texture2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20textureProperties.__version%20%3D%20texture2.version%3B%0A%20%20%7D%0A%20%20function%20setupFrameBufferTexture%28framebuffer%2C%20renderTarget%2C%20texture2%2C%20attachment%2C%20textureTarget%2C%20level%29%20%7B%0A%20%20%20%20const%20glFormat%20%3D%20utils.convert%28texture2.format%2C%20texture2.colorSpace%29%3B%0A%20%20%20%20const%20glType%20%3D%20utils.convert%28texture2.type%29%3B%0A%20%20%20%20const%20glInternalFormat%20%3D%20getInternalFormat%28texture2.internalFormat%2C%20glFormat%2C%20glType%2C%20texture2.colorSpace%29%3B%0A%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20const%20textureProperties%20%3D%20properties.get%28texture2%29%3B%0A%20%20%20%20textureProperties.__renderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20if%20%28%21renderTargetProperties.__hasExternalTextures%29%20%7B%0A%20%20%20%20%20%20const%20width%20%3D%20Math.max%281%2C%20renderTarget.width%20%3E%3E%20level%29%3B%0A%20%20%20%20%20%20const%20height%20%3D%20Math.max%281%2C%20renderTarget.height%20%3E%3E%20level%29%3B%0A%20%20%20%20%20%20if%20%28textureTarget%20%3D%3D%3D%20_gl.TEXTURE_3D%20%7C%7C%20textureTarget%20%3D%3D%3D%20_gl.TEXTURE_2D_ARRAY%29%20%7B%0A%20%20%20%20%20%20%20%20state.texImage3D%28textureTarget%2C%20level%2C%20glInternalFormat%2C%20width%2C%20height%2C%20renderTarget.depth%2C%200%2C%20glFormat%2C%20glType%2C%20null%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20state.texImage2D%28textureTarget%2C%20level%2C%20glInternalFormat%2C%20width%2C%20height%2C%200%2C%20glFormat%2C%20glType%2C%20null%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20framebuffer%29%3B%0A%20%20%20%20if%20%28useMultisampledRTT%28renderTarget%29%29%20%7B%0A%20%20%20%20%20%20multisampledRTTExt.framebufferTexture2DMultisampleEXT%28_gl.FRAMEBUFFER%2C%20attachment%2C%20textureTarget%2C%20textureProperties.__webglTexture%2C%200%2C%20getRenderTargetSamples%28renderTarget%29%29%3B%0A%20%20%20%20%7D%20else%20if%20%28textureTarget%20%3D%3D%3D%20_gl.TEXTURE_2D%20%7C%7C%20textureTarget%20%3E%3D%20_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%26%26%20textureTarget%20%3C%3D%20_gl.TEXTURE_CUBE_MAP_NEGATIVE_Z%29%20%7B%0A%20%20%20%20%20%20_gl.framebufferTexture2D%28_gl.FRAMEBUFFER%2C%20attachment%2C%20textureTarget%2C%20textureProperties.__webglTexture%2C%20level%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20null%29%3B%0A%20%20%7D%0A%20%20function%20setupRenderBufferStorage%28renderbuffer%2C%20renderTarget%2C%20isMultisample%29%20%7B%0A%20%20%20%20_gl.bindRenderbuffer%28_gl.RENDERBUFFER%2C%20renderbuffer%29%3B%0A%20%20%20%20if%20%28renderTarget.depthBuffer%29%20%7B%0A%20%20%20%20%20%20const%20depthTexture%20%3D%20renderTarget.depthTexture%3B%0A%20%20%20%20%20%20const%20depthType%20%3D%20depthTexture%20%26%26%20depthTexture.isDepthTexture%20%3F%20depthTexture.type%20%3A%20null%3B%0A%20%20%20%20%20%20const%20glInternalFormat%20%3D%20getInternalDepthFormat%28renderTarget.stencilBuffer%2C%20depthType%29%3B%0A%20%20%20%20%20%20const%20glAttachmentType%20%3D%20renderTarget.stencilBuffer%20%3F%20_gl.DEPTH_STENCIL_ATTACHMENT%20%3A%20_gl.DEPTH_ATTACHMENT%3B%0A%20%20%20%20%20%20const%20samples%20%3D%20getRenderTargetSamples%28renderTarget%29%3B%0A%20%20%20%20%20%20const%20isUseMultisampledRTT%20%3D%20useMultisampledRTT%28renderTarget%29%3B%0A%20%20%20%20%20%20if%20%28isUseMultisampledRTT%29%20%7B%0A%20%20%20%20%20%20%20%20multisampledRTTExt.renderbufferStorageMultisampleEXT%28_gl.RENDERBUFFER%2C%20samples%2C%20glInternalFormat%2C%20renderTarget.width%2C%20renderTarget.height%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28isMultisample%29%20%7B%0A%20%20%20%20%20%20%20%20_gl.renderbufferStorageMultisample%28_gl.RENDERBUFFER%2C%20samples%2C%20glInternalFormat%2C%20renderTarget.width%2C%20renderTarget.height%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_gl.renderbufferStorage%28_gl.RENDERBUFFER%2C%20glInternalFormat%2C%20renderTarget.width%2C%20renderTarget.height%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_gl.framebufferRenderbuffer%28_gl.FRAMEBUFFER%2C%20glAttachmentType%2C%20_gl.RENDERBUFFER%2C%20renderbuffer%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20textures%20%3D%20renderTarget.textures%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20texture2%20%3D%20textures%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20glFormat%20%3D%20utils.convert%28texture2.format%2C%20texture2.colorSpace%29%3B%0A%20%20%20%20%20%20%20%20const%20glType%20%3D%20utils.convert%28texture2.type%29%3B%0A%20%20%20%20%20%20%20%20const%20glInternalFormat%20%3D%20getInternalFormat%28texture2.internalFormat%2C%20glFormat%2C%20glType%2C%20texture2.colorSpace%29%3B%0A%20%20%20%20%20%20%20%20const%20samples%20%3D%20getRenderTargetSamples%28renderTarget%29%3B%0A%20%20%20%20%20%20%20%20if%20%28isMultisample%20%26%26%20useMultisampledRTT%28renderTarget%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_gl.renderbufferStorageMultisample%28_gl.RENDERBUFFER%2C%20samples%2C%20glInternalFormat%2C%20renderTarget.width%2C%20renderTarget.height%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28useMultisampledRTT%28renderTarget%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20multisampledRTTExt.renderbufferStorageMultisampleEXT%28_gl.RENDERBUFFER%2C%20samples%2C%20glInternalFormat%2C%20renderTarget.width%2C%20renderTarget.height%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20_gl.renderbufferStorage%28_gl.RENDERBUFFER%2C%20glInternalFormat%2C%20renderTarget.width%2C%20renderTarget.height%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20_gl.bindRenderbuffer%28_gl.RENDERBUFFER%2C%20null%29%3B%0A%20%20%7D%0A%20%20function%20setupDepthTexture%28framebuffer%2C%20renderTarget%29%20%7B%0A%20%20%20%20const%20isCube%20%3D%20renderTarget%20%26%26%20renderTarget.isWebGLCubeRenderTarget%3B%0A%20%20%20%20if%20%28isCube%29%20throw%20new%20Error%28%22Depth%20Texture%20with%20cube%20render%20targets%20is%20not%20supported%22%29%3B%0A%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20framebuffer%29%3B%0A%20%20%20%20if%20%28%21%28renderTarget.depthTexture%20%26%26%20renderTarget.depthTexture.isDepthTexture%29%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22renderTarget.depthTexture%20must%20be%20an%20instance%20of%20THREE.DepthTexture%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20textureProperties%20%3D%20properties.get%28renderTarget.depthTexture%29%3B%0A%20%20%20%20textureProperties.__renderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20if%20%28%21textureProperties.__webglTexture%20%7C%7C%20renderTarget.depthTexture.image.width%20%21%3D%3D%20renderTarget.width%20%7C%7C%20renderTarget.depthTexture.image.height%20%21%3D%3D%20renderTarget.height%29%20%7B%0A%20%20%20%20%20%20renderTarget.depthTexture.image.width%20%3D%20renderTarget.width%3B%0A%20%20%20%20%20%20renderTarget.depthTexture.image.height%20%3D%20renderTarget.height%3B%0A%20%20%20%20%20%20renderTarget.depthTexture.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20setTexture2D%28renderTarget.depthTexture%2C%200%29%3B%0A%20%20%20%20const%20webglDepthTexture%20%3D%20textureProperties.__webglTexture%3B%0A%20%20%20%20const%20samples%20%3D%20getRenderTargetSamples%28renderTarget%29%3B%0A%20%20%20%20if%20%28renderTarget.depthTexture.format%20%3D%3D%3D%20DepthFormat%29%20%7B%0A%20%20%20%20%20%20if%20%28useMultisampledRTT%28renderTarget%29%29%20%7B%0A%20%20%20%20%20%20%20%20multisampledRTTExt.framebufferTexture2DMultisampleEXT%28_gl.FRAMEBUFFER%2C%20_gl.DEPTH_ATTACHMENT%2C%20_gl.TEXTURE_2D%2C%20webglDepthTexture%2C%200%2C%20samples%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_gl.framebufferTexture2D%28_gl.FRAMEBUFFER%2C%20_gl.DEPTH_ATTACHMENT%2C%20_gl.TEXTURE_2D%2C%20webglDepthTexture%2C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28renderTarget.depthTexture.format%20%3D%3D%3D%20DepthStencilFormat%29%20%7B%0A%20%20%20%20%20%20if%20%28useMultisampledRTT%28renderTarget%29%29%20%7B%0A%20%20%20%20%20%20%20%20multisampledRTTExt.framebufferTexture2DMultisampleEXT%28_gl.FRAMEBUFFER%2C%20_gl.DEPTH_STENCIL_ATTACHMENT%2C%20_gl.TEXTURE_2D%2C%20webglDepthTexture%2C%200%2C%20samples%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_gl.framebufferTexture2D%28_gl.FRAMEBUFFER%2C%20_gl.DEPTH_STENCIL_ATTACHMENT%2C%20_gl.TEXTURE_2D%2C%20webglDepthTexture%2C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22Unknown%20depthTexture%20format%22%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20setupDepthRenderbuffer%28renderTarget%29%20%7B%0A%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20const%20isCube%20%3D%20renderTarget.isWebGLCubeRenderTarget%20%3D%3D%3D%20true%3B%0A%20%20%20%20if%20%28renderTargetProperties.__boundDepthTexture%20%21%3D%3D%20renderTarget.depthTexture%29%20%7B%0A%20%20%20%20%20%20const%20depthTexture%20%3D%20renderTarget.depthTexture%3B%0A%20%20%20%20%20%20if%20%28renderTargetProperties.__depthDisposeCallback%29%20%7B%0A%20%20%20%20%20%20%20%20renderTargetProperties.__depthDisposeCallback%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28depthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20const%20disposeEvent%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20delete%20renderTargetProperties.__boundDepthTexture%3B%0A%20%20%20%20%20%20%20%20%20%20delete%20renderTargetProperties.__depthDisposeCallback%3B%0A%20%20%20%20%20%20%20%20%20%20depthTexture.removeEventListener%28%22dispose%22%2C%20disposeEvent%29%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20depthTexture.addEventListener%28%22dispose%22%2C%20disposeEvent%29%3B%0A%20%20%20%20%20%20%20%20renderTargetProperties.__depthDisposeCallback%20%3D%20disposeEvent%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20renderTargetProperties.__boundDepthTexture%20%3D%20depthTexture%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderTarget.depthTexture%20%26%26%20%21renderTargetProperties.__autoAllocateDepthBuffer%29%20%7B%0A%20%20%20%20%20%20if%20%28isCube%29%20throw%20new%20Error%28%22target.depthTexture%20not%20supported%20in%20Cube%20render%20targets%22%29%3B%0A%20%20%20%20%20%20setupDepthTexture%28renderTargetProperties.__webglFramebuffer%2C%20renderTarget%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28isCube%29%20%7B%0A%20%20%20%20%20%20%20%20renderTargetProperties.__webglDepthbuffer%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20renderTargetProperties.__webglFramebuffer%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28renderTargetProperties.__webglDepthbuffer%5Bi%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderTargetProperties.__webglDepthbuffer%5Bi%5D%20%3D%20_gl.createRenderbuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20setupRenderBufferStorage%28renderTargetProperties.__webglDepthbuffer%5Bi%5D%2C%20renderTarget%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20glAttachmentType%20%3D%20renderTarget.stencilBuffer%20%3F%20_gl.DEPTH_STENCIL_ATTACHMENT%20%3A%20_gl.DEPTH_ATTACHMENT%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20renderbuffer%20%3D%20renderTargetProperties.__webglDepthbuffer%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.bindRenderbuffer%28_gl.RENDERBUFFER%2C%20renderbuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.framebufferRenderbuffer%28_gl.FRAMEBUFFER%2C%20glAttachmentType%2C%20_gl.RENDERBUFFER%2C%20renderbuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20renderTargetProperties.__webglFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20if%20%28renderTargetProperties.__webglDepthbuffer%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderTargetProperties.__webglDepthbuffer%20%3D%20_gl.createRenderbuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20setupRenderBufferStorage%28renderTargetProperties.__webglDepthbuffer%2C%20renderTarget%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20glAttachmentType%20%3D%20renderTarget.stencilBuffer%20%3F%20_gl.DEPTH_STENCIL_ATTACHMENT%20%3A%20_gl.DEPTH_ATTACHMENT%3B%0A%20%20%20%20%20%20%20%20%20%20const%20renderbuffer%20%3D%20renderTargetProperties.__webglDepthbuffer%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.bindRenderbuffer%28_gl.RENDERBUFFER%2C%20renderbuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.framebufferRenderbuffer%28_gl.FRAMEBUFFER%2C%20glAttachmentType%2C%20_gl.RENDERBUFFER%2C%20renderbuffer%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20null%29%3B%0A%20%20%7D%0A%20%20function%20rebindTextures%28renderTarget%2C%20colorTexture%2C%20depthTexture%29%20%7B%0A%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20if%20%28colorTexture%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20setupFrameBufferTexture%28renderTargetProperties.__webglFramebuffer%2C%20renderTarget%2C%20renderTarget.texture%2C%20_gl.COLOR_ATTACHMENT0%2C%20_gl.TEXTURE_2D%2C%200%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28depthTexture%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20setupDepthRenderbuffer%28renderTarget%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20setupRenderTarget%28renderTarget%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20renderTarget.texture%3B%0A%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20const%20textureProperties%20%3D%20properties.get%28texture2%29%3B%0A%20%20%20%20renderTarget.addEventListener%28%22dispose%22%2C%20onRenderTargetDispose%29%3B%0A%20%20%20%20const%20textures%20%3D%20renderTarget.textures%3B%0A%20%20%20%20const%20isCube%20%3D%20renderTarget.isWebGLCubeRenderTarget%20%3D%3D%3D%20true%3B%0A%20%20%20%20const%20isMultipleRenderTargets%20%3D%20textures.length%20%3E%201%3B%0A%20%20%20%20if%20%28%21isMultipleRenderTargets%29%20%7B%0A%20%20%20%20%20%20if%20%28textureProperties.__webglTexture%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20textureProperties.__webglTexture%20%3D%20_gl.createTexture%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20textureProperties.__version%20%3D%20texture2.version%3B%0A%20%20%20%20%20%20info.memory.textures%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isCube%29%20%7B%0A%20%20%20%20%20%20renderTargetProperties.__webglFramebuffer%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28texture2.mipmaps%20%26%26%20texture2.mipmaps.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderTargetProperties.__webglFramebuffer%5Bi%5D%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20level%20%3D%200%3B%20level%20%3C%20texture2.mipmaps.length%3B%20level%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderTargetProperties.__webglFramebuffer%5Bi%5D%5Blevel%5D%20%3D%20_gl.createFramebuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderTargetProperties.__webglFramebuffer%5Bi%5D%20%3D%20_gl.createFramebuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28texture2.mipmaps%20%26%26%20texture2.mipmaps.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20renderTargetProperties.__webglFramebuffer%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20level%20%3D%200%3B%20level%20%3C%20texture2.mipmaps.length%3B%20level%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderTargetProperties.__webglFramebuffer%5Blevel%5D%20%3D%20_gl.createFramebuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20renderTargetProperties.__webglFramebuffer%20%3D%20_gl.createFramebuffer%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28isMultipleRenderTargets%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20attachmentProperties%20%3D%20properties.get%28textures%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28attachmentProperties.__webglTexture%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20attachmentProperties.__webglTexture%20%3D%20_gl.createTexture%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20info.memory.textures%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderTarget.samples%20%3E%200%20%26%26%20useMultisampledRTT%28renderTarget%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20renderTargetProperties.__webglMultisampledFramebuffer%20%3D%20_gl.createFramebuffer%28%29%3B%0A%20%20%20%20%20%20%20%20renderTargetProperties.__webglColorRenderbuffer%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20renderTargetProperties.__webglMultisampledFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20texture3%20%3D%20textures%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20renderTargetProperties.__webglColorRenderbuffer%5Bi%5D%20%3D%20_gl.createRenderbuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.bindRenderbuffer%28_gl.RENDERBUFFER%2C%20renderTargetProperties.__webglColorRenderbuffer%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20glFormat%20%3D%20utils.convert%28texture3.format%2C%20texture3.colorSpace%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20glType%20%3D%20utils.convert%28texture3.type%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20glInternalFormat%20%3D%20getInternalFormat%28texture3.internalFormat%2C%20glFormat%2C%20glType%2C%20texture3.colorSpace%2C%20renderTarget.isXRRenderTarget%20%3D%3D%3D%20true%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20samples%20%3D%20getRenderTargetSamples%28renderTarget%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.renderbufferStorageMultisample%28_gl.RENDERBUFFER%2C%20samples%2C%20glInternalFormat%2C%20renderTarget.width%2C%20renderTarget.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.framebufferRenderbuffer%28_gl.FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%20%2B%20i%2C%20_gl.RENDERBUFFER%2C%20renderTargetProperties.__webglColorRenderbuffer%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20_gl.bindRenderbuffer%28_gl.RENDERBUFFER%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20if%20%28renderTarget.depthBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderTargetProperties.__webglDepthRenderbuffer%20%3D%20_gl.createRenderbuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20setupRenderBufferStorage%28renderTargetProperties.__webglDepthRenderbuffer%2C%20renderTarget%2C%20true%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isCube%29%20%7B%0A%20%20%20%20%20%20state.bindTexture%28_gl.TEXTURE_CUBE_MAP%2C%20textureProperties.__webglTexture%29%3B%0A%20%20%20%20%20%20setTextureParameters%28_gl.TEXTURE_CUBE_MAP%2C%20texture2%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28texture2.mipmaps%20%26%26%20texture2.mipmaps.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20level%20%3D%200%3B%20level%20%3C%20texture2.mipmaps.length%3B%20level%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20setupFrameBufferTexture%28renderTargetProperties.__webglFramebuffer%5Bi%5D%5Blevel%5D%2C%20renderTarget%2C%20texture2%2C%20_gl.COLOR_ATTACHMENT0%2C%20_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%20level%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20setupFrameBufferTexture%28renderTargetProperties.__webglFramebuffer%5Bi%5D%2C%20renderTarget%2C%20texture2%2C%20_gl.COLOR_ATTACHMENT0%2C%20_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28textureNeedsGenerateMipmaps%28texture2%29%29%20%7B%0A%20%20%20%20%20%20%20%20generateMipmap%28_gl.TEXTURE_CUBE_MAP%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28isMultipleRenderTargets%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20attachment%20%3D%20textures%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20attachmentProperties%20%3D%20properties.get%28attachment%29%3B%0A%20%20%20%20%20%20%20%20state.bindTexture%28_gl.TEXTURE_2D%2C%20attachmentProperties.__webglTexture%29%3B%0A%20%20%20%20%20%20%20%20setTextureParameters%28_gl.TEXTURE_2D%2C%20attachment%29%3B%0A%20%20%20%20%20%20%20%20setupFrameBufferTexture%28renderTargetProperties.__webglFramebuffer%2C%20renderTarget%2C%20attachment%2C%20_gl.COLOR_ATTACHMENT0%20%2B%20i%2C%20_gl.TEXTURE_2D%2C%200%29%3B%0A%20%20%20%20%20%20%20%20if%20%28textureNeedsGenerateMipmaps%28attachment%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20generateMipmap%28_gl.TEXTURE_2D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20let%20glTextureType%20%3D%20_gl.TEXTURE_2D%3B%0A%20%20%20%20%20%20if%20%28renderTarget.isWebGL3DRenderTarget%20%7C%7C%20renderTarget.isWebGLArrayRenderTarget%29%20%7B%0A%20%20%20%20%20%20%20%20glTextureType%20%3D%20renderTarget.isWebGL3DRenderTarget%20%3F%20_gl.TEXTURE_3D%20%3A%20_gl.TEXTURE_2D_ARRAY%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.bindTexture%28glTextureType%2C%20textureProperties.__webglTexture%29%3B%0A%20%20%20%20%20%20setTextureParameters%28glTextureType%2C%20texture2%29%3B%0A%20%20%20%20%20%20if%20%28texture2.mipmaps%20%26%26%20texture2.mipmaps.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20level%20%3D%200%3B%20level%20%3C%20texture2.mipmaps.length%3B%20level%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20setupFrameBufferTexture%28renderTargetProperties.__webglFramebuffer%5Blevel%5D%2C%20renderTarget%2C%20texture2%2C%20_gl.COLOR_ATTACHMENT0%2C%20glTextureType%2C%20level%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20setupFrameBufferTexture%28renderTargetProperties.__webglFramebuffer%2C%20renderTarget%2C%20texture2%2C%20_gl.COLOR_ATTACHMENT0%2C%20glTextureType%2C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28textureNeedsGenerateMipmaps%28texture2%29%29%20%7B%0A%20%20%20%20%20%20%20%20generateMipmap%28glTextureType%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderTarget.depthBuffer%29%20%7B%0A%20%20%20%20%20%20setupDepthRenderbuffer%28renderTarget%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20updateRenderTargetMipmap%28renderTarget%29%20%7B%0A%20%20%20%20const%20textures%20%3D%20renderTarget.textures%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20texture2%20%3D%20textures%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28textureNeedsGenerateMipmaps%28texture2%29%29%20%7B%0A%20%20%20%20%20%20%20%20const%20targetType%20%3D%20getTargetType%28renderTarget%29%3B%0A%20%20%20%20%20%20%20%20const%20webglTexture%20%3D%20properties.get%28texture2%29.__webglTexture%3B%0A%20%20%20%20%20%20%20%20state.bindTexture%28targetType%2C%20webglTexture%29%3B%0A%20%20%20%20%20%20%20%20generateMipmap%28targetType%29%3B%0A%20%20%20%20%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20const%20invalidationArrayRead%20%3D%20%5B%5D%3B%0A%20%20const%20invalidationArrayDraw%20%3D%20%5B%5D%3B%0A%20%20function%20updateMultisampleRenderTarget%28renderTarget%29%20%7B%0A%20%20%20%20if%20%28renderTarget.samples%20%3E%200%29%20%7B%0A%20%20%20%20%20%20if%20%28useMultisampledRTT%28renderTarget%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20const%20textures%20%3D%20renderTarget.textures%3B%0A%20%20%20%20%20%20%20%20const%20width%20%3D%20renderTarget.width%3B%0A%20%20%20%20%20%20%20%20const%20height%20%3D%20renderTarget.height%3B%0A%20%20%20%20%20%20%20%20let%20mask%20%3D%20_gl.COLOR_BUFFER_BIT%3B%0A%20%20%20%20%20%20%20%20const%20depthStyle%20%3D%20renderTarget.stencilBuffer%20%3F%20_gl.DEPTH_STENCIL_ATTACHMENT%20%3A%20_gl.DEPTH_ATTACHMENT%3B%0A%20%20%20%20%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20%20%20%20%20const%20isMultipleRenderTargets%20%3D%20textures.length%20%3E%201%3B%0A%20%20%20%20%20%20%20%20if%20%28isMultipleRenderTargets%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20renderTargetProperties.__webglMultisampledFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.framebufferRenderbuffer%28_gl.FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%20%2B%20i%2C%20_gl.RENDERBUFFER%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20renderTargetProperties.__webglFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.framebufferTexture2D%28_gl.DRAW_FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%20%2B%20i%2C%20_gl.TEXTURE_2D%2C%20null%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.READ_FRAMEBUFFER%2C%20renderTargetProperties.__webglMultisampledFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.DRAW_FRAMEBUFFER%2C%20renderTargetProperties.__webglFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28renderTarget.resolveDepthBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28renderTarget.depthBuffer%29%20mask%20%7C%3D%20_gl.DEPTH_BUFFER_BIT%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28renderTarget.stencilBuffer%20%26%26%20renderTarget.resolveStencilBuffer%29%20mask%20%7C%3D%20_gl.STENCIL_BUFFER_BIT%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28isMultipleRenderTargets%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.framebufferRenderbuffer%28_gl.READ_FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%2C%20_gl.RENDERBUFFER%2C%20renderTargetProperties.__webglColorRenderbuffer%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20webglTexture%20%3D%20properties.get%28textures%5Bi%5D%29.__webglTexture%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.framebufferTexture2D%28_gl.DRAW_FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%2C%20_gl.TEXTURE_2D%2C%20webglTexture%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_gl.blitFramebuffer%280%2C%200%2C%20width%2C%20height%2C%200%2C%200%2C%20width%2C%20height%2C%20mask%2C%20_gl.NEAREST%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28supportsInvalidateFramebuffer%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20invalidationArrayRead.length%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20invalidationArrayDraw.length%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20invalidationArrayRead.push%28_gl.COLOR_ATTACHMENT0%20%2B%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28renderTarget.depthBuffer%20%26%26%20renderTarget.resolveDepthBuffer%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20invalidationArrayRead.push%28depthStyle%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20invalidationArrayDraw.push%28depthStyle%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_gl.invalidateFramebuffer%28_gl.DRAW_FRAMEBUFFER%2C%20invalidationArrayDraw%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.invalidateFramebuffer%28_gl.READ_FRAMEBUFFER%2C%20invalidationArrayRead%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.READ_FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.DRAW_FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20if%20%28isMultipleRenderTargets%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20renderTargetProperties.__webglMultisampledFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.framebufferRenderbuffer%28_gl.FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%20%2B%20i%2C%20_gl.RENDERBUFFER%2C%20renderTargetProperties.__webglColorRenderbuffer%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20webglTexture%20%3D%20properties.get%28textures%5Bi%5D%29.__webglTexture%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20renderTargetProperties.__webglFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.framebufferTexture2D%28_gl.DRAW_FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%20%2B%20i%2C%20_gl.TEXTURE_2D%2C%20webglTexture%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.DRAW_FRAMEBUFFER%2C%20renderTargetProperties.__webglMultisampledFramebuffer%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28renderTarget.depthBuffer%20%26%26%20renderTarget.resolveDepthBuffer%20%3D%3D%3D%20false%20%26%26%20supportsInvalidateFramebuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20depthStyle%20%3D%20renderTarget.stencilBuffer%20%3F%20_gl.DEPTH_STENCIL_ATTACHMENT%20%3A%20_gl.DEPTH_ATTACHMENT%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.invalidateFramebuffer%28_gl.DRAW_FRAMEBUFFER%2C%20%5BdepthStyle%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20getRenderTargetSamples%28renderTarget%29%20%7B%0A%20%20%20%20return%20Math.min%28capabilities.maxSamples%2C%20renderTarget.samples%29%3B%0A%20%20%7D%0A%20%20function%20useMultisampledRTT%28renderTarget%29%20%7B%0A%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20return%20renderTarget.samples%20%3E%200%20%26%26%20extensions.has%28%22WEBGL_multisampled_render_to_texture%22%29%20%3D%3D%3D%20true%20%26%26%20renderTargetProperties.__useRenderToTexture%20%21%3D%3D%20false%3B%0A%20%20%7D%0A%20%20function%20updateVideoTexture%28texture2%29%20%7B%0A%20%20%20%20const%20frame2%20%3D%20info.render.frame%3B%0A%20%20%20%20if%20%28_videoTextures.get%28texture2%29%20%21%3D%3D%20frame2%29%20%7B%0A%20%20%20%20%20%20_videoTextures.set%28texture2%2C%20frame2%29%3B%0A%20%20%20%20%20%20texture2.update%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20verifyColorSpace%28texture2%2C%20image%29%20%7B%0A%20%20%20%20const%20colorSpace%20%3D%20texture2.colorSpace%3B%0A%20%20%20%20const%20format2%20%3D%20texture2.format%3B%0A%20%20%20%20const%20type%20%3D%20texture2.type%3B%0A%20%20%20%20if%20%28texture2.isCompressedTexture%20%3D%3D%3D%20true%20%7C%7C%20texture2.isVideoTexture%20%3D%3D%3D%20true%29%20return%20image%3B%0A%20%20%20%20if%20%28colorSpace%20%21%3D%3D%20LinearSRGBColorSpace%20%26%26%20colorSpace%20%21%3D%3D%20NoColorSpace%29%20%7B%0A%20%20%20%20%20%20if%20%28ColorManagement.getTransfer%28colorSpace%29%20%3D%3D%3D%20SRGBTransfer%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28format2%20%21%3D%3D%20RGBAFormat%20%7C%7C%20type%20%21%3D%3D%20UnsignedByteType%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLTextures%3A%20sRGB%20encoded%20textures%20have%20to%20use%20RGBAFormat%20and%20UnsignedByteType.%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLTextures%3A%20Unsupported%20texture%20color%20space%3A%22%2C%20colorSpace%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20image%3B%0A%20%20%7D%0A%20%20function%20getDimensions%28image%29%20%7B%0A%20%20%20%20if%20%28typeof%20HTMLImageElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLImageElement%29%20%7B%0A%20%20%20%20%20%20_imageDimensions.width%20%3D%20image.naturalWidth%20%7C%7C%20image.width%3B%0A%20%20%20%20%20%20_imageDimensions.height%20%3D%20image.naturalHeight%20%7C%7C%20image.height%3B%0A%20%20%20%20%7D%20else%20if%20%28typeof%20VideoFrame%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20VideoFrame%29%20%7B%0A%20%20%20%20%20%20_imageDimensions.width%20%3D%20image.displayWidth%3B%0A%20%20%20%20%20%20_imageDimensions.height%20%3D%20image.displayHeight%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_imageDimensions.width%20%3D%20image.width%3B%0A%20%20%20%20%20%20_imageDimensions.height%20%3D%20image.height%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20_imageDimensions%3B%0A%20%20%7D%0A%20%20this.allocateTextureUnit%20%3D%20allocateTextureUnit%3B%0A%20%20this.resetTextureUnits%20%3D%20resetTextureUnits%3B%0A%20%20this.setTexture2D%20%3D%20setTexture2D%3B%0A%20%20this.setTexture2DArray%20%3D%20setTexture2DArray%3B%0A%20%20this.setTexture3D%20%3D%20setTexture3D%3B%0A%20%20this.setTextureCube%20%3D%20setTextureCube%3B%0A%20%20this.rebindTextures%20%3D%20rebindTextures%3B%0A%20%20this.setupRenderTarget%20%3D%20setupRenderTarget%3B%0A%20%20this.updateRenderTargetMipmap%20%3D%20updateRenderTargetMipmap%3B%0A%20%20this.updateMultisampleRenderTarget%20%3D%20updateMultisampleRenderTarget%3B%0A%20%20this.setupDepthRenderbuffer%20%3D%20setupDepthRenderbuffer%3B%0A%20%20this.setupFrameBufferTexture%20%3D%20setupFrameBufferTexture%3B%0A%20%20this.useMultisampledRTT%20%3D%20useMultisampledRTT%3B%0A%7D%0Afunction%20WebGLUtils%28gl%2C%20extensions%29%20%7B%0A%20%20function%20convert2%28p%2C%20colorSpace%20%3D%20NoColorSpace%29%20%7B%0A%20%20%20%20let%20extension%3B%0A%20%20%20%20const%20transfer%20%3D%20ColorManagement.getTransfer%28colorSpace%29%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedByteType%29%20return%20gl.UNSIGNED_BYTE%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedShort4444Type%29%20return%20gl.UNSIGNED_SHORT_4_4_4_4%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedShort5551Type%29%20return%20gl.UNSIGNED_SHORT_5_5_5_1%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedInt5999Type%29%20return%20gl.UNSIGNED_INT_5_9_9_9_REV%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20ByteType%29%20return%20gl.BYTE%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20ShortType%29%20return%20gl.SHORT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedShortType%29%20return%20gl.UNSIGNED_SHORT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20IntType%29%20return%20gl.INT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedIntType%29%20return%20gl.UNSIGNED_INT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20FloatType%29%20return%20gl.FLOAT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20HalfFloatType%29%20return%20gl.HALF_FLOAT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20AlphaFormat%29%20return%20gl.ALPHA%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBFormat%29%20return%20gl.RGB%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBAFormat%29%20return%20gl.RGBA%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20LuminanceFormat%29%20return%20gl.LUMINANCE%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20LuminanceAlphaFormat%29%20return%20gl.LUMINANCE_ALPHA%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20DepthFormat%29%20return%20gl.DEPTH_COMPONENT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20DepthStencilFormat%29%20return%20gl.DEPTH_STENCIL%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RedFormat%29%20return%20gl.RED%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RedIntegerFormat%29%20return%20gl.RED_INTEGER%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGFormat%29%20return%20gl.RG%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGIntegerFormat%29%20return%20gl.RG_INTEGER%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBAIntegerFormat%29%20return%20gl.RGBA_INTEGER%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_S3TC_DXT1_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_S3TC_DXT1_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_S3TC_DXT3_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_S3TC_DXT5_Format%29%20%7B%0A%20%20%20%20%20%20if%20%28transfer%20%3D%3D%3D%20SRGBTransfer%29%20%7B%0A%20%20%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_s3tc_srgb%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_S3TC_DXT1_Format%29%20return%20extension.COMPRESSED_SRGB_S3TC_DXT1_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT1_Format%29%20return%20extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT3_Format%29%20return%20extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT5_Format%29%20return%20extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_s3tc%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_S3TC_DXT1_Format%29%20return%20extension.COMPRESSED_RGB_S3TC_DXT1_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT1_Format%29%20return%20extension.COMPRESSED_RGBA_S3TC_DXT1_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT3_Format%29%20return%20extension.COMPRESSED_RGBA_S3TC_DXT3_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT5_Format%29%20return%20extension.COMPRESSED_RGBA_S3TC_DXT5_EXT%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_PVRTC_4BPPV1_Format%20%7C%7C%20p%20%3D%3D%3D%20RGB_PVRTC_2BPPV1_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_PVRTC_4BPPV1_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_PVRTC_2BPPV1_Format%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_pvrtc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_PVRTC_4BPPV1_Format%29%20return%20extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_PVRTC_2BPPV1_Format%29%20return%20extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_PVRTC_4BPPV1_Format%29%20return%20extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_PVRTC_2BPPV1_Format%29%20return%20extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_ETC1_Format%20%7C%7C%20p%20%3D%3D%3D%20RGB_ETC2_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ETC2_EAC_Format%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_etc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_ETC1_Format%20%7C%7C%20p%20%3D%3D%3D%20RGB_ETC2_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ETC2%20%3A%20extension.COMPRESSED_RGB8_ETC2%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ETC2_EAC_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC%20%3A%20extension.COMPRESSED_RGBA8_ETC2_EAC%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_4x4_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_5x4_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_5x5_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_6x5_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_6x6_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_8x5_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_8x6_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_8x8_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_10x5_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_10x6_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_10x8_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_10x10_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_12x10_Format%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_12x12_Format%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_astc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_4x4_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_4x4_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_5x4_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_5x4_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_5x5_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_5x5_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_6x5_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_6x5_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_6x6_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_6x6_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_8x5_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_8x5_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_8x6_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_8x6_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_8x8_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_8x8_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_10x5_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_10x5_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_10x6_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_10x6_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_10x8_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_10x8_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_10x10_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_10x10_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_12x10_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_12x10_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_12x12_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_12x12_KHR%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_BPTC_Format%20%7C%7C%20p%20%3D%3D%3D%20RGB_BPTC_SIGNED_Format%20%7C%7C%20p%20%3D%3D%3D%20RGB_BPTC_UNSIGNED_Format%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22EXT_texture_compression_bptc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_BPTC_Format%29%20return%20transfer%20%3D%3D%3D%20SRGBTransfer%20%3F%20extension.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT%20%3A%20extension.COMPRESSED_RGBA_BPTC_UNORM_EXT%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_BPTC_SIGNED_Format%29%20return%20extension.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_BPTC_UNSIGNED_Format%29%20return%20extension.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RED_RGTC1_Format%20%7C%7C%20p%20%3D%3D%3D%20SIGNED_RED_RGTC1_Format%20%7C%7C%20p%20%3D%3D%3D%20RED_GREEN_RGTC2_Format%20%7C%7C%20p%20%3D%3D%3D%20SIGNED_RED_GREEN_RGTC2_Format%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22EXT_texture_compression_rgtc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_BPTC_Format%29%20return%20extension.COMPRESSED_RED_RGTC1_EXT%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20SIGNED_RED_RGTC1_Format%29%20return%20extension.COMPRESSED_SIGNED_RED_RGTC1_EXT%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RED_GREEN_RGTC2_Format%29%20return%20extension.COMPRESSED_RED_GREEN_RGTC2_EXT%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20SIGNED_RED_GREEN_RGTC2_Format%29%20return%20extension.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedInt248Type%29%20return%20gl.UNSIGNED_INT_24_8%3B%0A%20%20%20%20return%20gl%5Bp%5D%20%21%3D%3D%20void%200%20%3F%20gl%5Bp%5D%20%3A%20null%3B%0A%20%20%7D%0A%20%20return%20%7B%20convert%3A%20convert2%20%7D%3B%0A%7D%0Avar%20ArrayCamera%20%3D%20class%20extends%20PerspectiveCamera%20%7B%0A%20%20constructor%28array%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isArrayCamera%20%3D%20true%3B%0A%20%20%20%20this.cameras%20%3D%20array%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Group%20%3D%20class%20extends%20Object3D%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isGroup%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Group%22%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_moveEvent%20%3D%20%7B%20type%3A%20%22move%22%20%7D%3B%0Avar%20WebXRController%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this._targetRay%20%3D%20null%3B%0A%20%20%20%20this._grip%20%3D%20null%3B%0A%20%20%20%20this._hand%20%3D%20null%3B%0A%20%20%7D%0A%20%20getHandSpace%28%29%20%7B%0A%20%20%20%20if%20%28this._hand%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._hand%20%3D%20new%20Group%28%29%3B%0A%20%20%20%20%20%20this._hand.matrixAutoUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20this._hand.visible%20%3D%20false%3B%0A%20%20%20%20%20%20this._hand.joints%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20this._hand.inputState%20%3D%20%7B%20pinching%3A%20false%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this._hand%3B%0A%20%20%7D%0A%20%20getTargetRaySpace%28%29%20%7B%0A%20%20%20%20if%20%28this._targetRay%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._targetRay%20%3D%20new%20Group%28%29%3B%0A%20%20%20%20%20%20this._targetRay.matrixAutoUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20this._targetRay.visible%20%3D%20false%3B%0A%20%20%20%20%20%20this._targetRay.hasLinearVelocity%20%3D%20false%3B%0A%20%20%20%20%20%20this._targetRay.linearVelocity%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20this._targetRay.hasAngularVelocity%20%3D%20false%3B%0A%20%20%20%20%20%20this._targetRay.angularVelocity%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this._targetRay%3B%0A%20%20%7D%0A%20%20getGripSpace%28%29%20%7B%0A%20%20%20%20if%20%28this._grip%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._grip%20%3D%20new%20Group%28%29%3B%0A%20%20%20%20%20%20this._grip.matrixAutoUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20this._grip.visible%20%3D%20false%3B%0A%20%20%20%20%20%20this._grip.hasLinearVelocity%20%3D%20false%3B%0A%20%20%20%20%20%20this._grip.linearVelocity%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20this._grip.hasAngularVelocity%20%3D%20false%3B%0A%20%20%20%20%20%20this._grip.angularVelocity%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this._grip%3B%0A%20%20%7D%0A%20%20dispatchEvent%28event%29%20%7B%0A%20%20%20%20if%20%28this._targetRay%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._targetRay.dispatchEvent%28event%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this._grip%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._grip.dispatchEvent%28event%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this._hand%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._hand.dispatchEvent%28event%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20connect%28inputSource%29%20%7B%0A%20%20%20%20if%20%28inputSource%20%26%26%20inputSource.hand%29%20%7B%0A%20%20%20%20%20%20const%20hand%20%3D%20this._hand%3B%0A%20%20%20%20%20%20if%20%28hand%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28const%20inputjoint%20of%20inputSource.hand.values%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._getHandJoint%28hand%2C%20inputjoint%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22connected%22%2C%20data%3A%20inputSource%20%7D%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20disconnect%28inputSource%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22disconnected%22%2C%20data%3A%20inputSource%20%7D%29%3B%0A%20%20%20%20if%20%28this._targetRay%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._targetRay.visible%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this._grip%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._grip.visible%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this._hand%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._hand.visible%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20update%28inputSource%2C%20frame2%2C%20referenceSpace%29%20%7B%0A%20%20%20%20let%20inputPose%20%3D%20null%3B%0A%20%20%20%20let%20gripPose%20%3D%20null%3B%0A%20%20%20%20let%20handPose%20%3D%20null%3B%0A%20%20%20%20const%20targetRay%20%3D%20this._targetRay%3B%0A%20%20%20%20const%20grip%20%3D%20this._grip%3B%0A%20%20%20%20const%20hand%20%3D%20this._hand%3B%0A%20%20%20%20if%20%28inputSource%20%26%26%20frame2.session.visibilityState%20%21%3D%3D%20%22visible-blurred%22%29%20%7B%0A%20%20%20%20%20%20if%20%28hand%20%26%26%20inputSource.hand%29%20%7B%0A%20%20%20%20%20%20%20%20handPose%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20for%20%28const%20inputjoint%20of%20inputSource.hand.values%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20jointPose%20%3D%20frame2.getJointPose%28inputjoint%2C%20referenceSpace%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20joint%20%3D%20this._getHandJoint%28hand%2C%20inputjoint%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28jointPose%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20joint.matrix.fromArray%28jointPose.transform.matrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20joint.matrix.decompose%28joint.position%2C%20joint.rotation%2C%20joint.scale%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20joint.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20joint.jointRadius%20%3D%20jointPose.radius%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20joint.visible%20%3D%20jointPose%20%21%3D%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20indexTip%20%3D%20hand.joints%5B%22index-finger-tip%22%5D%3B%0A%20%20%20%20%20%20%20%20const%20thumbTip%20%3D%20hand.joints%5B%22thumb-tip%22%5D%3B%0A%20%20%20%20%20%20%20%20const%20distance2%20%3D%20indexTip.position.distanceTo%28thumbTip.position%29%3B%0A%20%20%20%20%20%20%20%20const%20distanceToPinch%20%3D%200.02%3B%0A%20%20%20%20%20%20%20%20const%20threshold%20%3D%205e-3%3B%0A%20%20%20%20%20%20%20%20if%20%28hand.inputState.pinching%20%26%26%20distance2%20%3E%20distanceToPinch%20%2B%20threshold%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20hand.inputState.pinching%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20this.dispatchEvent%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20type%3A%20%22pinchend%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20handedness%3A%20inputSource.handedness%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20target%3A%20this%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28%21hand.inputState.pinching%20%26%26%20distance2%20%3C%3D%20distanceToPinch%20-%20threshold%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20hand.inputState.pinching%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20this.dispatchEvent%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20type%3A%20%22pinchstart%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20handedness%3A%20inputSource.handedness%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20target%3A%20this%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28grip%20%21%3D%3D%20null%20%26%26%20inputSource.gripSpace%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gripPose%20%3D%20frame2.getPose%28inputSource.gripSpace%2C%20referenceSpace%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28gripPose%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20grip.matrix.fromArray%28gripPose.transform.matrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20grip.matrix.decompose%28grip.position%2C%20grip.rotation%2C%20grip.scale%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20grip.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28gripPose.linearVelocity%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20grip.hasLinearVelocity%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20grip.linearVelocity.copy%28gripPose.linearVelocity%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20grip.hasLinearVelocity%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28gripPose.angularVelocity%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20grip.hasAngularVelocity%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20grip.angularVelocity.copy%28gripPose.angularVelocity%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20grip.hasAngularVelocity%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28targetRay%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20inputPose%20%3D%20frame2.getPose%28inputSource.targetRaySpace%2C%20referenceSpace%29%3B%0A%20%20%20%20%20%20%20%20if%20%28inputPose%20%3D%3D%3D%20null%20%26%26%20gripPose%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20inputPose%20%3D%20gripPose%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28inputPose%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20targetRay.matrix.fromArray%28inputPose.transform.matrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20targetRay.matrix.decompose%28targetRay.position%2C%20targetRay.rotation%2C%20targetRay.scale%29%3B%0A%20%20%20%20%20%20%20%20%20%20targetRay.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28inputPose.linearVelocity%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20targetRay.hasLinearVelocity%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20targetRay.linearVelocity.copy%28inputPose.linearVelocity%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20targetRay.hasLinearVelocity%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28inputPose.angularVelocity%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20targetRay.hasAngularVelocity%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20targetRay.angularVelocity.copy%28inputPose.angularVelocity%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20targetRay.hasAngularVelocity%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20this.dispatchEvent%28_moveEvent%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28targetRay%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20targetRay.visible%20%3D%20inputPose%20%21%3D%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28grip%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20grip.visible%20%3D%20gripPose%20%21%3D%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28hand%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20hand.visible%20%3D%20handPose%20%21%3D%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20private%20method%0A%20%20_getHandJoint%28hand%2C%20inputjoint%29%20%7B%0A%20%20%20%20if%20%28hand.joints%5Binputjoint.jointName%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20joint%20%3D%20new%20Group%28%29%3B%0A%20%20%20%20%20%20joint.matrixAutoUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20joint.visible%20%3D%20false%3B%0A%20%20%20%20%20%20hand.joints%5Binputjoint.jointName%5D%20%3D%20joint%3B%0A%20%20%20%20%20%20hand.add%28joint%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20hand.joints%5Binputjoint.jointName%5D%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_occlusion_vertex%20%3D%20%60%0Avoid%20main%28%29%20%7B%0A%0A%09gl_Position%20%3D%20vec4%28%20position%2C%201.0%20%29%3B%0A%0A%7D%60%3B%0Avar%20_occlusion_fragment%20%3D%20%60%0Auniform%20sampler2DArray%20depthColor%3B%0Auniform%20float%20depthWidth%3B%0Auniform%20float%20depthHeight%3B%0A%0Avoid%20main%28%29%20%7B%0A%0A%09vec2%20coord%20%3D%20vec2%28%20gl_FragCoord.x%20%2F%20depthWidth%2C%20gl_FragCoord.y%20%2F%20depthHeight%20%29%3B%0A%0A%09if%20%28%20coord.x%20%3E%3D%201.0%20%29%20%7B%0A%0A%09%09gl_FragDepth%20%3D%20texture%28%20depthColor%2C%20vec3%28%20coord.x%20-%201.0%2C%20coord.y%2C%201%20%29%20%29.r%3B%0A%0A%09%7D%20else%20%7B%0A%0A%09%09gl_FragDepth%20%3D%20texture%28%20depthColor%2C%20vec3%28%20coord.x%2C%20coord.y%2C%200%20%29%20%29.r%3B%0A%0A%09%7D%0A%0A%7D%60%3B%0Avar%20WebXRDepthSensing%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.texture%20%3D%20null%3B%0A%20%20%20%20this.mesh%20%3D%20null%3B%0A%20%20%20%20this.depthNear%20%3D%200%3B%0A%20%20%20%20this.depthFar%20%3D%200%3B%0A%20%20%7D%0A%20%20init%28renderer3%2C%20depthData%2C%20renderState%29%20%7B%0A%20%20%20%20if%20%28this.texture%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20texture2%20%3D%20new%20Texture%28%29%3B%0A%20%20%20%20%20%20const%20texProps%20%3D%20renderer3.properties.get%28texture2%29%3B%0A%20%20%20%20%20%20texProps.__webglTexture%20%3D%20depthData.texture%3B%0A%20%20%20%20%20%20if%20%28depthData.depthNear%20%21%3D%20renderState.depthNear%20%7C%7C%20depthData.depthFar%20%21%3D%20renderState.depthFar%29%20%7B%0A%20%20%20%20%20%20%20%20this.depthNear%20%3D%20depthData.depthNear%3B%0A%20%20%20%20%20%20%20%20this.depthFar%20%3D%20depthData.depthFar%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.texture%20%3D%20texture2%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getMesh%28cameraXR%29%20%7B%0A%20%20%20%20if%20%28this.texture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28this.mesh%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20const%20viewport2%20%3D%20cameraXR.cameras%5B0%5D.viewport%3B%0A%20%20%20%20%20%20%20%20const%20material%20%3D%20new%20ShaderMaterial%28%7B%0A%20%20%20%20%20%20%20%20%20%20vertexShader%3A%20_occlusion_vertex%2C%0A%20%20%20%20%20%20%20%20%20%20fragmentShader%3A%20_occlusion_fragment%2C%0A%20%20%20%20%20%20%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20depthColor%3A%20%7B%20value%3A%20this.texture%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20depthWidth%3A%20%7B%20value%3A%20viewport2.z%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20depthHeight%3A%20%7B%20value%3A%20viewport2.w%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20this.mesh%20%3D%20new%20Mesh%28new%20PlaneGeometry%2820%2C%2020%29%2C%20material%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.mesh%3B%0A%20%20%7D%0A%20%20reset%28%29%20%7B%0A%20%20%20%20this.texture%20%3D%20null%3B%0A%20%20%20%20this.mesh%20%3D%20null%3B%0A%20%20%7D%0A%20%20getDepthTexture%28%29%20%7B%0A%20%20%20%20return%20this.texture%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebXRManager%20%3D%20class%20extends%20EventDispatcher%20%7B%0A%20%20constructor%28renderer3%2C%20gl%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20const%20scope%20%3D%20this%3B%0A%20%20%20%20let%20session%20%3D%20null%3B%0A%20%20%20%20let%20framebufferScaleFactor%20%3D%201%3B%0A%20%20%20%20let%20referenceSpace%20%3D%20null%3B%0A%20%20%20%20let%20referenceSpaceType%20%3D%20%22local-floor%22%3B%0A%20%20%20%20let%20foveation%20%3D%201%3B%0A%20%20%20%20let%20customReferenceSpace%20%3D%20null%3B%0A%20%20%20%20let%20pose%20%3D%20null%3B%0A%20%20%20%20let%20glBinding%20%3D%20null%3B%0A%20%20%20%20let%20glProjLayer%20%3D%20null%3B%0A%20%20%20%20let%20glBaseLayer%20%3D%20null%3B%0A%20%20%20%20let%20xrFrame%20%3D%20null%3B%0A%20%20%20%20const%20depthSensing%20%3D%20new%20WebXRDepthSensing%28%29%3B%0A%20%20%20%20const%20attributes%20%3D%20gl.getContextAttributes%28%29%3B%0A%20%20%20%20let%20initialRenderTarget%20%3D%20null%3B%0A%20%20%20%20let%20newRenderTarget%20%3D%20null%3B%0A%20%20%20%20const%20controllers%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20controllerInputSources%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20currentSize%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20let%20currentPixelRatio%20%3D%20null%3B%0A%20%20%20%20const%20cameraL%20%3D%20new%20PerspectiveCamera%28%29%3B%0A%20%20%20%20cameraL.viewport%20%3D%20new%20Vector4%28%29%3B%0A%20%20%20%20const%20cameraR%20%3D%20new%20PerspectiveCamera%28%29%3B%0A%20%20%20%20cameraR.viewport%20%3D%20new%20Vector4%28%29%3B%0A%20%20%20%20const%20cameras%20%3D%20%5BcameraL%2C%20cameraR%5D%3B%0A%20%20%20%20const%20cameraXR%20%3D%20new%20ArrayCamera%28%29%3B%0A%20%20%20%20let%20_currentDepthNear%20%3D%20null%3B%0A%20%20%20%20let%20_currentDepthFar%20%3D%20null%3B%0A%20%20%20%20this.cameraAutoUpdate%20%3D%20true%3B%0A%20%20%20%20this.enabled%20%3D%20false%3B%0A%20%20%20%20this.isPresenting%20%3D%20false%3B%0A%20%20%20%20this.getController%20%3D%20function%28index5%29%20%7B%0A%20%20%20%20%20%20let%20controller%20%3D%20controllers%5Bindex5%5D%3B%0A%20%20%20%20%20%20if%20%28controller%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20controller%20%3D%20new%20WebXRController%28%29%3B%0A%20%20%20%20%20%20%20%20controllers%5Bindex5%5D%20%3D%20controller%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20controller.getTargetRaySpace%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getControllerGrip%20%3D%20function%28index5%29%20%7B%0A%20%20%20%20%20%20let%20controller%20%3D%20controllers%5Bindex5%5D%3B%0A%20%20%20%20%20%20if%20%28controller%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20controller%20%3D%20new%20WebXRController%28%29%3B%0A%20%20%20%20%20%20%20%20controllers%5Bindex5%5D%20%3D%20controller%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20controller.getGripSpace%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getHand%20%3D%20function%28index5%29%20%7B%0A%20%20%20%20%20%20let%20controller%20%3D%20controllers%5Bindex5%5D%3B%0A%20%20%20%20%20%20if%20%28controller%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20controller%20%3D%20new%20WebXRController%28%29%3B%0A%20%20%20%20%20%20%20%20controllers%5Bindex5%5D%20%3D%20controller%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20controller.getHandSpace%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20function%20onSessionEvent%28event%29%20%7B%0A%20%20%20%20%20%20const%20controllerIndex%20%3D%20controllerInputSources.indexOf%28event.inputSource%29%3B%0A%20%20%20%20%20%20if%20%28controllerIndex%20%3D%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20controller%20%3D%20controllers%5BcontrollerIndex%5D%3B%0A%20%20%20%20%20%20if%20%28controller%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20controller.update%28event.inputSource%2C%20event.frame%2C%20customReferenceSpace%20%7C%7C%20referenceSpace%29%3B%0A%20%20%20%20%20%20%20%20controller.dispatchEvent%28%7B%20type%3A%20event.type%2C%20data%3A%20event.inputSource%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20onSessionEnd%28%29%20%7B%0A%20%20%20%20%20%20session.removeEventListener%28%22select%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20session.removeEventListener%28%22selectstart%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20session.removeEventListener%28%22selectend%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20session.removeEventListener%28%22squeeze%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20session.removeEventListener%28%22squeezestart%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20session.removeEventListener%28%22squeezeend%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20session.removeEventListener%28%22end%22%2C%20onSessionEnd%29%3B%0A%20%20%20%20%20%20session.removeEventListener%28%22inputsourceschange%22%2C%20onInputSourcesChange%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20controllers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20inputSource%20%3D%20controllerInputSources%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28inputSource%20%3D%3D%3D%20null%29%20continue%3B%0A%20%20%20%20%20%20%20%20controllerInputSources%5Bi%5D%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20controllers%5Bi%5D.disconnect%28inputSource%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_currentDepthNear%20%3D%20null%3B%0A%20%20%20%20%20%20_currentDepthFar%20%3D%20null%3B%0A%20%20%20%20%20%20depthSensing.reset%28%29%3B%0A%20%20%20%20%20%20renderer3.setRenderTarget%28initialRenderTarget%29%3B%0A%20%20%20%20%20%20glBaseLayer%20%3D%20null%3B%0A%20%20%20%20%20%20glProjLayer%20%3D%20null%3B%0A%20%20%20%20%20%20glBinding%20%3D%20null%3B%0A%20%20%20%20%20%20session%20%3D%20null%3B%0A%20%20%20%20%20%20newRenderTarget%20%3D%20null%3B%0A%20%20%20%20%20%20animation.stop%28%29%3B%0A%20%20%20%20%20%20scope.isPresenting%20%3D%20false%3B%0A%20%20%20%20%20%20renderer3.setPixelRatio%28currentPixelRatio%29%3B%0A%20%20%20%20%20%20renderer3.setSize%28currentSize.width%2C%20currentSize.height%2C%20false%29%3B%0A%20%20%20%20%20%20scope.dispatchEvent%28%7B%20type%3A%20%22sessionend%22%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.setFramebufferScaleFactor%20%3D%20function%28value%29%20%7B%0A%20%20%20%20%20%20framebufferScaleFactor%20%3D%20value%3B%0A%20%20%20%20%20%20if%20%28scope.isPresenting%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebXRManager%3A%20Cannot%20change%20framebuffer%20scale%20while%20presenting.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setReferenceSpaceType%20%3D%20function%28value%29%20%7B%0A%20%20%20%20%20%20referenceSpaceType%20%3D%20value%3B%0A%20%20%20%20%20%20if%20%28scope.isPresenting%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebXRManager%3A%20Cannot%20change%20reference%20space%20type%20while%20presenting.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getReferenceSpace%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20customReferenceSpace%20%7C%7C%20referenceSpace%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setReferenceSpace%20%3D%20function%28space%29%20%7B%0A%20%20%20%20%20%20customReferenceSpace%20%3D%20space%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getBaseLayer%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20glProjLayer%20%21%3D%3D%20null%20%3F%20glProjLayer%20%3A%20glBaseLayer%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getBinding%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20glBinding%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getFrame%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20xrFrame%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getSession%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20session%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setSession%20%3D%20async%20function%28value%29%20%7B%0A%20%20%20%20%20%20session%20%3D%20value%3B%0A%20%20%20%20%20%20if%20%28session%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20initialRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20%20%20%20%20session.addEventListener%28%22select%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20%20%20session.addEventListener%28%22selectstart%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20%20%20session.addEventListener%28%22selectend%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20%20%20session.addEventListener%28%22squeeze%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20%20%20session.addEventListener%28%22squeezestart%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20%20%20session.addEventListener%28%22squeezeend%22%2C%20onSessionEvent%29%3B%0A%20%20%20%20%20%20%20%20session.addEventListener%28%22end%22%2C%20onSessionEnd%29%3B%0A%20%20%20%20%20%20%20%20session.addEventListener%28%22inputsourceschange%22%2C%20onInputSourcesChange%29%3B%0A%20%20%20%20%20%20%20%20if%20%28attributes.xrCompatible%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20await%20gl.makeXRCompatible%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20currentPixelRatio%20%3D%20renderer3.getPixelRatio%28%29%3B%0A%20%20%20%20%20%20%20%20renderer3.getSize%28currentSize%29%3B%0A%20%20%20%20%20%20%20%20if%20%28session.renderState.layers%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20layerInit%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20antialias%3A%20attributes.antialias%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20depth%3A%20attributes.depth%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20stencil%3A%20attributes.stencil%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20framebufferScaleFactor%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20glBaseLayer%20%3D%20new%20XRWebGLLayer%28session%2C%20gl%2C%20layerInit%29%3B%0A%20%20%20%20%20%20%20%20%20%20session.updateRenderState%28%7B%20baseLayer%3A%20glBaseLayer%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setPixelRatio%281%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setSize%28glBaseLayer.framebufferWidth%2C%20glBaseLayer.framebufferHeight%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20newRenderTarget%20%3D%20new%20WebGLRenderTarget%28%0A%20%20%20%20%20%20%20%20%20%20%20%20glBaseLayer.framebufferWidth%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20glBaseLayer.framebufferHeight%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20format%3A%20RGBAFormat%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3A%20UnsignedByteType%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorSpace%3A%20renderer3.outputColorSpace%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stencilBuffer%3A%20attributes.stencil%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20let%20depthFormat%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20let%20depthType%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20let%20glDepthFormat%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28attributes.depth%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20glDepthFormat%20%3D%20attributes.stencil%20%3F%20gl.DEPTH24_STENCIL8%20%3A%20gl.DEPTH_COMPONENT24%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20depthFormat%20%3D%20attributes.stencil%20%3F%20DepthStencilFormat%20%3A%20DepthFormat%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20depthType%20%3D%20attributes.stencil%20%3F%20UnsignedInt248Type%20%3A%20UnsignedIntType%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20const%20projectionlayerInit%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20colorFormat%3A%20gl.RGBA8%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20depthFormat%3A%20glDepthFormat%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scaleFactor%3A%20framebufferScaleFactor%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20glBinding%20%3D%20new%20XRWebGLBinding%28session%2C%20gl%29%3B%0A%20%20%20%20%20%20%20%20%20%20glProjLayer%20%3D%20glBinding.createProjectionLayer%28projectionlayerInit%29%3B%0A%20%20%20%20%20%20%20%20%20%20session.updateRenderState%28%7B%20layers%3A%20%5BglProjLayer%5D%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setPixelRatio%281%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setSize%28glProjLayer.textureWidth%2C%20glProjLayer.textureHeight%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20newRenderTarget%20%3D%20new%20WebGLRenderTarget%28%0A%20%20%20%20%20%20%20%20%20%20%20%20glProjLayer.textureWidth%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20glProjLayer.textureHeight%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20format%3A%20RGBAFormat%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20type%3A%20UnsignedByteType%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20depthTexture%3A%20new%20DepthTexture%28glProjLayer.textureWidth%2C%20glProjLayer.textureHeight%2C%20depthType%2C%20void%200%2C%20void%200%2C%20void%200%2C%20void%200%2C%20void%200%2C%20void%200%2C%20depthFormat%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stencilBuffer%3A%20attributes.stencil%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorSpace%3A%20renderer3.outputColorSpace%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20samples%3A%20attributes.antialias%20%3F%204%20%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20resolveDepthBuffer%3A%20glProjLayer.ignoreDepthValues%20%3D%3D%3D%20false%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20newRenderTarget.isXRRenderTarget%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20this.setFoveation%28foveation%29%3B%0A%20%20%20%20%20%20%20%20customReferenceSpace%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20referenceSpace%20%3D%20await%20session.requestReferenceSpace%28referenceSpaceType%29%3B%0A%20%20%20%20%20%20%20%20animation.setContext%28session%29%3B%0A%20%20%20%20%20%20%20%20animation.start%28%29%3B%0A%20%20%20%20%20%20%20%20scope.isPresenting%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20scope.dispatchEvent%28%7B%20type%3A%20%22sessionstart%22%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getEnvironmentBlendMode%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28session%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20return%20session.environmentBlendMode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getDepthTexture%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20depthSensing.getDepthTexture%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20function%20onInputSourcesChange%28event%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20event.removed.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20inputSource%20%3D%20event.removed%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20index5%20%3D%20controllerInputSources.indexOf%28inputSource%29%3B%0A%20%20%20%20%20%20%20%20if%20%28index5%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20controllerInputSources%5Bindex5%5D%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20controllers%5Bindex5%5D.disconnect%28inputSource%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20event.added.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20inputSource%20%3D%20event.added%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20let%20controllerIndex%20%3D%20controllerInputSources.indexOf%28inputSource%29%3B%0A%20%20%20%20%20%20%20%20if%20%28controllerIndex%20%3D%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i2%20%3D%200%3B%20i2%20%3C%20controllers.length%3B%20i2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28i2%20%3E%3D%20controllerInputSources.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20controllerInputSources.push%28inputSource%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20controllerIndex%20%3D%20i2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28controllerInputSources%5Bi2%5D%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20controllerInputSources%5Bi2%5D%20%3D%20inputSource%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20controllerIndex%20%3D%20i2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28controllerIndex%20%3D%3D%3D%20-1%29%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20controller%20%3D%20controllers%5BcontrollerIndex%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28controller%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20controller.connect%28inputSource%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20cameraLPos%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20cameraRPos%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20function%20setProjectionFromUnion%28camera3%2C%20cameraL2%2C%20cameraR2%29%20%7B%0A%20%20%20%20%20%20cameraLPos.setFromMatrixPosition%28cameraL2.matrixWorld%29%3B%0A%20%20%20%20%20%20cameraRPos.setFromMatrixPosition%28cameraR2.matrixWorld%29%3B%0A%20%20%20%20%20%20const%20ipd%20%3D%20cameraLPos.distanceTo%28cameraRPos%29%3B%0A%20%20%20%20%20%20const%20projL%20%3D%20cameraL2.projectionMatrix.elements%3B%0A%20%20%20%20%20%20const%20projR%20%3D%20cameraR2.projectionMatrix.elements%3B%0A%20%20%20%20%20%20const%20near%20%3D%20projL%5B14%5D%20%2F%20%28projL%5B10%5D%20-%201%29%3B%0A%20%20%20%20%20%20const%20far%20%3D%20projL%5B14%5D%20%2F%20%28projL%5B10%5D%20%2B%201%29%3B%0A%20%20%20%20%20%20const%20topFov%20%3D%20%28projL%5B9%5D%20%2B%201%29%20%2F%20projL%5B5%5D%3B%0A%20%20%20%20%20%20const%20bottomFov%20%3D%20%28projL%5B9%5D%20-%201%29%20%2F%20projL%5B5%5D%3B%0A%20%20%20%20%20%20const%20leftFov%20%3D%20%28projL%5B8%5D%20-%201%29%20%2F%20projL%5B0%5D%3B%0A%20%20%20%20%20%20const%20rightFov%20%3D%20%28projR%5B8%5D%20%2B%201%29%20%2F%20projR%5B0%5D%3B%0A%20%20%20%20%20%20const%20left%20%3D%20near%20%2A%20leftFov%3B%0A%20%20%20%20%20%20const%20right%20%3D%20near%20%2A%20rightFov%3B%0A%20%20%20%20%20%20const%20zOffset%20%3D%20ipd%20%2F%20%28-leftFov%20%2B%20rightFov%29%3B%0A%20%20%20%20%20%20const%20xOffset%20%3D%20zOffset%20%2A%20-leftFov%3B%0A%20%20%20%20%20%20cameraL2.matrixWorld.decompose%28camera3.position%2C%20camera3.quaternion%2C%20camera3.scale%29%3B%0A%20%20%20%20%20%20camera3.translateX%28xOffset%29%3B%0A%20%20%20%20%20%20camera3.translateZ%28zOffset%29%3B%0A%20%20%20%20%20%20camera3.matrixWorld.compose%28camera3.position%2C%20camera3.quaternion%2C%20camera3.scale%29%3B%0A%20%20%20%20%20%20camera3.matrixWorldInverse.copy%28camera3.matrixWorld%29.invert%28%29%3B%0A%20%20%20%20%20%20if%20%28projL%5B10%5D%20%3D%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20camera3.projectionMatrix.copy%28cameraL2.projectionMatrix%29%3B%0A%20%20%20%20%20%20%20%20camera3.projectionMatrixInverse.copy%28cameraL2.projectionMatrixInverse%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20near2%20%3D%20near%20%2B%20zOffset%3B%0A%20%20%20%20%20%20%20%20const%20far2%20%3D%20far%20%2B%20zOffset%3B%0A%20%20%20%20%20%20%20%20const%20left2%20%3D%20left%20-%20xOffset%3B%0A%20%20%20%20%20%20%20%20const%20right2%20%3D%20right%20%2B%20%28ipd%20-%20xOffset%29%3B%0A%20%20%20%20%20%20%20%20const%20top2%20%3D%20topFov%20%2A%20far%20%2F%20far2%20%2A%20near2%3B%0A%20%20%20%20%20%20%20%20const%20bottom2%20%3D%20bottomFov%20%2A%20far%20%2F%20far2%20%2A%20near2%3B%0A%20%20%20%20%20%20%20%20camera3.projectionMatrix.makePerspective%28left2%2C%20right2%2C%20top2%2C%20bottom2%2C%20near2%2C%20far2%29%3B%0A%20%20%20%20%20%20%20%20camera3.projectionMatrixInverse.copy%28camera3.projectionMatrix%29.invert%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20updateCamera%28camera3%2C%20parent%29%20%7B%0A%20%20%20%20%20%20if%20%28parent%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20camera3.matrixWorld.copy%28camera3.matrix%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20camera3.matrixWorld.multiplyMatrices%28parent.matrixWorld%2C%20camera3.matrix%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20camera3.matrixWorldInverse.copy%28camera3.matrixWorld%29.invert%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.updateCamera%20%3D%20function%28camera3%29%20%7B%0A%20%20%20%20%20%20if%20%28session%20%3D%3D%3D%20null%29%20return%3B%0A%20%20%20%20%20%20let%20depthNear%20%3D%20camera3.near%3B%0A%20%20%20%20%20%20let%20depthFar%20%3D%20camera3.far%3B%0A%20%20%20%20%20%20if%20%28depthSensing.texture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28depthSensing.depthNear%20%3E%200%29%20depthNear%20%3D%20depthSensing.depthNear%3B%0A%20%20%20%20%20%20%20%20if%20%28depthSensing.depthFar%20%3E%200%29%20depthFar%20%3D%20depthSensing.depthFar%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20cameraXR.near%20%3D%20cameraR.near%20%3D%20cameraL.near%20%3D%20depthNear%3B%0A%20%20%20%20%20%20cameraXR.far%20%3D%20cameraR.far%20%3D%20cameraL.far%20%3D%20depthFar%3B%0A%20%20%20%20%20%20if%20%28_currentDepthNear%20%21%3D%3D%20cameraXR.near%20%7C%7C%20_currentDepthFar%20%21%3D%3D%20cameraXR.far%29%20%7B%0A%20%20%20%20%20%20%20%20session.updateRenderState%28%7B%0A%20%20%20%20%20%20%20%20%20%20depthNear%3A%20cameraXR.near%2C%0A%20%20%20%20%20%20%20%20%20%20depthFar%3A%20cameraXR.far%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20_currentDepthNear%20%3D%20cameraXR.near%3B%0A%20%20%20%20%20%20%20%20_currentDepthFar%20%3D%20cameraXR.far%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20cameraL.layers.mask%20%3D%20camera3.layers.mask%20%7C%202%3B%0A%20%20%20%20%20%20cameraR.layers.mask%20%3D%20camera3.layers.mask%20%7C%204%3B%0A%20%20%20%20%20%20cameraXR.layers.mask%20%3D%20cameraL.layers.mask%20%7C%20cameraR.layers.mask%3B%0A%20%20%20%20%20%20const%20parent%20%3D%20camera3.parent%3B%0A%20%20%20%20%20%20const%20cameras2%20%3D%20cameraXR.cameras%3B%0A%20%20%20%20%20%20updateCamera%28cameraXR%2C%20parent%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20cameras2.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20updateCamera%28cameras2%5Bi%5D%2C%20parent%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28cameras2.length%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20%20%20setProjectionFromUnion%28cameraXR%2C%20cameraL%2C%20cameraR%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20cameraXR.projectionMatrix.copy%28cameraL.projectionMatrix%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20updateUserCamera%28camera3%2C%20cameraXR%2C%20parent%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20function%20updateUserCamera%28camera3%2C%20cameraXR2%2C%20parent%29%20%7B%0A%20%20%20%20%20%20if%20%28parent%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20camera3.matrix.copy%28cameraXR2.matrixWorld%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20camera3.matrix.copy%28parent.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20camera3.matrix.invert%28%29%3B%0A%20%20%20%20%20%20%20%20camera3.matrix.multiply%28cameraXR2.matrixWorld%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20camera3.matrix.decompose%28camera3.position%2C%20camera3.quaternion%2C%20camera3.scale%29%3B%0A%20%20%20%20%20%20camera3.updateMatrixWorld%28true%29%3B%0A%20%20%20%20%20%20camera3.projectionMatrix.copy%28cameraXR2.projectionMatrix%29%3B%0A%20%20%20%20%20%20camera3.projectionMatrixInverse.copy%28cameraXR2.projectionMatrixInverse%29%3B%0A%20%20%20%20%20%20if%20%28camera3.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20%20%20camera3.fov%20%3D%20RAD2DEG%20%2A%202%20%2A%20Math.atan%281%20%2F%20camera3.projectionMatrix.elements%5B5%5D%29%3B%0A%20%20%20%20%20%20%20%20camera3.zoom%20%3D%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.getCamera%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20cameraXR%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getFoveation%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28glProjLayer%20%3D%3D%3D%20null%20%26%26%20glBaseLayer%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20return%20void%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20foveation%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setFoveation%20%3D%20function%28value%29%20%7B%0A%20%20%20%20%20%20foveation%20%3D%20value%3B%0A%20%20%20%20%20%20if%20%28glProjLayer%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20glProjLayer.fixedFoveation%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28glBaseLayer%20%21%3D%3D%20null%20%26%26%20glBaseLayer.fixedFoveation%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20glBaseLayer.fixedFoveation%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.hasDepthSensing%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20depthSensing.texture%20%21%3D%3D%20null%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getDepthSensingMesh%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20depthSensing.getMesh%28cameraXR%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20let%20onAnimationFrameCallback%20%3D%20null%3B%0A%20%20%20%20function%20onAnimationFrame%28time%2C%20frame2%29%20%7B%0A%20%20%20%20%20%20pose%20%3D%20frame2.getViewerPose%28customReferenceSpace%20%7C%7C%20referenceSpace%29%3B%0A%20%20%20%20%20%20xrFrame%20%3D%20frame2%3B%0A%20%20%20%20%20%20if%20%28pose%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20const%20views%20%3D%20pose.views%3B%0A%20%20%20%20%20%20%20%20if%20%28glBaseLayer%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setRenderTargetFramebuffer%28newRenderTarget%2C%20glBaseLayer.framebuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setRenderTarget%28newRenderTarget%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20let%20cameraXRNeedsUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20if%20%28views.length%20%21%3D%3D%20cameraXR.cameras.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20cameraXR.cameras.length%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20cameraXRNeedsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20views.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20view%20%3D%20views%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20let%20viewport2%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28glBaseLayer%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20viewport2%20%3D%20glBaseLayer.getViewport%28view%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20glSubImage%20%3D%20glBinding.getViewSubImage%28glProjLayer%2C%20view%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20viewport2%20%3D%20glSubImage.viewport%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28i%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20renderer3.setRenderTargetTextures%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newRenderTarget%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20glSubImage.colorTexture%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20glProjLayer.ignoreDepthValues%20%3F%20void%200%20%3A%20glSubImage.depthStencilTexture%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20renderer3.setRenderTarget%28newRenderTarget%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20let%20camera3%20%3D%20cameras%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28camera3%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20camera3%20%3D%20new%20PerspectiveCamera%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20camera3.layers.enable%28i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20camera3.viewport%20%3D%20new%20Vector4%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cameras%5Bi%5D%20%3D%20camera3%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20camera3.matrix.fromArray%28view.transform.matrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20camera3.matrix.decompose%28camera3.position%2C%20camera3.quaternion%2C%20camera3.scale%29%3B%0A%20%20%20%20%20%20%20%20%20%20camera3.projectionMatrix.fromArray%28view.projectionMatrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20camera3.projectionMatrixInverse.copy%28camera3.projectionMatrix%29.invert%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20camera3.viewport.set%28viewport2.x%2C%20viewport2.y%2C%20viewport2.width%2C%20viewport2.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28i%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20cameraXR.matrix.copy%28camera3.matrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20cameraXR.matrix.decompose%28cameraXR.position%2C%20cameraXR.quaternion%2C%20cameraXR.scale%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28cameraXRNeedsUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20cameraXR.cameras.push%28camera3%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20enabledFeatures%20%3D%20session.enabledFeatures%3B%0A%20%20%20%20%20%20%20%20if%20%28enabledFeatures%20%26%26%20enabledFeatures.includes%28%22depth-sensing%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20depthData%20%3D%20glBinding.getDepthInformation%28views%5B0%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28depthData%20%26%26%20depthData.isValid%20%26%26%20depthData.texture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20depthSensing.init%28renderer3%2C%20depthData%2C%20session.renderState%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20controllers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20inputSource%20%3D%20controllerInputSources%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20controller%20%3D%20controllers%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28inputSource%20%21%3D%3D%20null%20%26%26%20controller%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20controller.update%28inputSource%2C%20frame2%2C%20customReferenceSpace%20%7C%7C%20referenceSpace%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28onAnimationFrameCallback%29%20onAnimationFrameCallback%28time%2C%20frame2%29%3B%0A%20%20%20%20%20%20if%20%28frame2.detectedPlanes%29%20%7B%0A%20%20%20%20%20%20%20%20scope.dispatchEvent%28%7B%20type%3A%20%22planesdetected%22%2C%20data%3A%20frame2%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20xrFrame%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20animation%20%3D%20new%20WebGLAnimation%28%29%3B%0A%20%20%20%20animation.setAnimationLoop%28onAnimationFrame%29%3B%0A%20%20%20%20this.setAnimationLoop%20%3D%20function%28callback%29%20%7B%0A%20%20%20%20%20%20onAnimationFrameCallback%20%3D%20callback%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.dispose%20%3D%20function%28%29%20%7B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_e1%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Euler%28%29%3B%0Avar%20_m1%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Afunction%20WebGLMaterials%28renderer3%2C%20properties%29%20%7B%0A%20%20function%20refreshTransformUniform%28map%2C%20uniform2%29%20%7B%0A%20%20%20%20if%20%28map.matrixAutoUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20map.updateMatrix%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20uniform2.value.copy%28map.matrix%29%3B%0A%20%20%7D%0A%20%20function%20refreshFogUniforms%28uniforms%2C%20fog%29%20%7B%0A%20%20%20%20fog.color.getRGB%28uniforms.fogColor.value%2C%20getUnlitUniformColorSpace%28renderer3%29%29%3B%0A%20%20%20%20if%20%28fog.isFog%29%20%7B%0A%20%20%20%20%20%20uniforms.fogNear.value%20%3D%20fog.near%3B%0A%20%20%20%20%20%20uniforms.fogFar.value%20%3D%20fog.far%3B%0A%20%20%20%20%7D%20else%20if%20%28fog.isFogExp2%29%20%7B%0A%20%20%20%20%20%20uniforms.fogDensity.value%20%3D%20fog.density%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshMaterialUniforms%28uniforms%2C%20material%2C%20pixelRatio%2C%20height%2C%20transmissionRenderTarget%29%20%7B%0A%20%20%20%20if%20%28material.isMeshBasicMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsCommon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isMeshLambertMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsCommon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isMeshToonMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsCommon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%20%20refreshUniformsToon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isMeshPhongMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsCommon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%20%20refreshUniformsPhong%28uniforms%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isMeshStandardMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsCommon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%20%20refreshUniformsStandard%28uniforms%2C%20material%29%3B%0A%20%20%20%20%20%20if%20%28material.isMeshPhysicalMaterial%29%20%7B%0A%20%20%20%20%20%20%20%20refreshUniformsPhysical%28uniforms%2C%20material%2C%20transmissionRenderTarget%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28material.isMeshMatcapMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsCommon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%20%20refreshUniformsMatcap%28uniforms%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isMeshDepthMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsCommon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isMeshDistanceMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsCommon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%20%20refreshUniformsDistance%28uniforms%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isMeshNormalMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsCommon%28uniforms%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isLineBasicMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsLine%28uniforms%2C%20material%29%3B%0A%20%20%20%20%20%20if%20%28material.isLineDashedMaterial%29%20%7B%0A%20%20%20%20%20%20%20%20refreshUniformsDash%28uniforms%2C%20material%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28material.isPointsMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsPoints%28uniforms%2C%20material%2C%20pixelRatio%2C%20height%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isSpriteMaterial%29%20%7B%0A%20%20%20%20%20%20refreshUniformsSprites%28uniforms%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isShadowMaterial%29%20%7B%0A%20%20%20%20%20%20uniforms.color.value.copy%28material.color%29%3B%0A%20%20%20%20%20%20uniforms.opacity.value%20%3D%20material.opacity%3B%0A%20%20%20%20%7D%20else%20if%20%28material.isShaderMaterial%29%20%7B%0A%20%20%20%20%20%20material.uniformsNeedUpdate%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshUniformsCommon%28uniforms%2C%20material%29%20%7B%0A%20%20%20%20uniforms.opacity.value%20%3D%20material.opacity%3B%0A%20%20%20%20if%20%28material.color%29%20%7B%0A%20%20%20%20%20%20uniforms.diffuse.value.copy%28material.color%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.emissive%29%20%7B%0A%20%20%20%20%20%20uniforms.emissive.value.copy%28material.emissive%29.multiplyScalar%28material.emissiveIntensity%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.map%29%20%7B%0A%20%20%20%20%20%20uniforms.map.value%20%3D%20material.map%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.map%2C%20uniforms.mapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.alphaMap%29%20%7B%0A%20%20%20%20%20%20uniforms.alphaMap.value%20%3D%20material.alphaMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.alphaMap%2C%20uniforms.alphaMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.bumpMap%29%20%7B%0A%20%20%20%20%20%20uniforms.bumpMap.value%20%3D%20material.bumpMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.bumpMap%2C%20uniforms.bumpMapTransform%29%3B%0A%20%20%20%20%20%20uniforms.bumpScale.value%20%3D%20material.bumpScale%3B%0A%20%20%20%20%20%20if%20%28material.side%20%3D%3D%3D%20BackSide%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.bumpScale.value%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.normalMap%29%20%7B%0A%20%20%20%20%20%20uniforms.normalMap.value%20%3D%20material.normalMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.normalMap%2C%20uniforms.normalMapTransform%29%3B%0A%20%20%20%20%20%20uniforms.normalScale.value.copy%28material.normalScale%29%3B%0A%20%20%20%20%20%20if%20%28material.side%20%3D%3D%3D%20BackSide%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.normalScale.value.negate%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.displacementMap%29%20%7B%0A%20%20%20%20%20%20uniforms.displacementMap.value%20%3D%20material.displacementMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.displacementMap%2C%20uniforms.displacementMapTransform%29%3B%0A%20%20%20%20%20%20uniforms.displacementScale.value%20%3D%20material.displacementScale%3B%0A%20%20%20%20%20%20uniforms.displacementBias.value%20%3D%20material.displacementBias%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.emissiveMap%29%20%7B%0A%20%20%20%20%20%20uniforms.emissiveMap.value%20%3D%20material.emissiveMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.emissiveMap%2C%20uniforms.emissiveMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.specularMap%29%20%7B%0A%20%20%20%20%20%20uniforms.specularMap.value%20%3D%20material.specularMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.specularMap%2C%20uniforms.specularMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.alphaTest%20%3E%200%29%20%7B%0A%20%20%20%20%20%20uniforms.alphaTest.value%20%3D%20material.alphaTest%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20materialProperties%20%3D%20properties.get%28material%29%3B%0A%20%20%20%20const%20envMap%20%3D%20materialProperties.envMap%3B%0A%20%20%20%20const%20envMapRotation%20%3D%20materialProperties.envMapRotation%3B%0A%20%20%20%20if%20%28envMap%29%20%7B%0A%20%20%20%20%20%20uniforms.envMap.value%20%3D%20envMap%3B%0A%20%20%20%20%20%20_e1.copy%28envMapRotation%29%3B%0A%20%20%20%20%20%20_e1.x%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20_e1.y%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20_e1.z%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20if%20%28envMap.isCubeTexture%20%26%26%20envMap.isRenderTargetTexture%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20_e1.y%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20%20%20_e1.z%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20uniforms.envMapRotation.value.setFromMatrix4%28_m1.makeRotationFromEuler%28_e1%29%29%3B%0A%20%20%20%20%20%20uniforms.flipEnvMap.value%20%3D%20envMap.isCubeTexture%20%26%26%20envMap.isRenderTargetTexture%20%3D%3D%3D%20false%20%3F%20-1%20%3A%201%3B%0A%20%20%20%20%20%20uniforms.reflectivity.value%20%3D%20material.reflectivity%3B%0A%20%20%20%20%20%20uniforms.ior.value%20%3D%20material.ior%3B%0A%20%20%20%20%20%20uniforms.refractionRatio.value%20%3D%20material.refractionRatio%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.lightMap%29%20%7B%0A%20%20%20%20%20%20uniforms.lightMap.value%20%3D%20material.lightMap%3B%0A%20%20%20%20%20%20uniforms.lightMapIntensity.value%20%3D%20material.lightMapIntensity%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.lightMap%2C%20uniforms.lightMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.aoMap%29%20%7B%0A%20%20%20%20%20%20uniforms.aoMap.value%20%3D%20material.aoMap%3B%0A%20%20%20%20%20%20uniforms.aoMapIntensity.value%20%3D%20material.aoMapIntensity%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.aoMap%2C%20uniforms.aoMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshUniformsLine%28uniforms%2C%20material%29%20%7B%0A%20%20%20%20uniforms.diffuse.value.copy%28material.color%29%3B%0A%20%20%20%20uniforms.opacity.value%20%3D%20material.opacity%3B%0A%20%20%20%20if%20%28material.map%29%20%7B%0A%20%20%20%20%20%20uniforms.map.value%20%3D%20material.map%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.map%2C%20uniforms.mapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshUniformsDash%28uniforms%2C%20material%29%20%7B%0A%20%20%20%20uniforms.dashSize.value%20%3D%20material.dashSize%3B%0A%20%20%20%20uniforms.totalSize.value%20%3D%20material.dashSize%20%2B%20material.gapSize%3B%0A%20%20%20%20uniforms.scale.value%20%3D%20material.scale%3B%0A%20%20%7D%0A%20%20function%20refreshUniformsPoints%28uniforms%2C%20material%2C%20pixelRatio%2C%20height%29%20%7B%0A%20%20%20%20uniforms.diffuse.value.copy%28material.color%29%3B%0A%20%20%20%20uniforms.opacity.value%20%3D%20material.opacity%3B%0A%20%20%20%20uniforms.size.value%20%3D%20material.size%20%2A%20pixelRatio%3B%0A%20%20%20%20uniforms.scale.value%20%3D%20height%20%2A%200.5%3B%0A%20%20%20%20if%20%28material.map%29%20%7B%0A%20%20%20%20%20%20uniforms.map.value%20%3D%20material.map%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.map%2C%20uniforms.uvTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.alphaMap%29%20%7B%0A%20%20%20%20%20%20uniforms.alphaMap.value%20%3D%20material.alphaMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.alphaMap%2C%20uniforms.alphaMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.alphaTest%20%3E%200%29%20%7B%0A%20%20%20%20%20%20uniforms.alphaTest.value%20%3D%20material.alphaTest%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshUniformsSprites%28uniforms%2C%20material%29%20%7B%0A%20%20%20%20uniforms.diffuse.value.copy%28material.color%29%3B%0A%20%20%20%20uniforms.opacity.value%20%3D%20material.opacity%3B%0A%20%20%20%20uniforms.rotation.value%20%3D%20material.rotation%3B%0A%20%20%20%20if%20%28material.map%29%20%7B%0A%20%20%20%20%20%20uniforms.map.value%20%3D%20material.map%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.map%2C%20uniforms.mapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.alphaMap%29%20%7B%0A%20%20%20%20%20%20uniforms.alphaMap.value%20%3D%20material.alphaMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.alphaMap%2C%20uniforms.alphaMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.alphaTest%20%3E%200%29%20%7B%0A%20%20%20%20%20%20uniforms.alphaTest.value%20%3D%20material.alphaTest%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshUniformsPhong%28uniforms%2C%20material%29%20%7B%0A%20%20%20%20uniforms.specular.value.copy%28material.specular%29%3B%0A%20%20%20%20uniforms.shininess.value%20%3D%20Math.max%28material.shininess%2C%201e-4%29%3B%0A%20%20%7D%0A%20%20function%20refreshUniformsToon%28uniforms%2C%20material%29%20%7B%0A%20%20%20%20if%20%28material.gradientMap%29%20%7B%0A%20%20%20%20%20%20uniforms.gradientMap.value%20%3D%20material.gradientMap%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshUniformsStandard%28uniforms%2C%20material%29%20%7B%0A%20%20%20%20uniforms.metalness.value%20%3D%20material.metalness%3B%0A%20%20%20%20if%20%28material.metalnessMap%29%20%7B%0A%20%20%20%20%20%20uniforms.metalnessMap.value%20%3D%20material.metalnessMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.metalnessMap%2C%20uniforms.metalnessMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20uniforms.roughness.value%20%3D%20material.roughness%3B%0A%20%20%20%20if%20%28material.roughnessMap%29%20%7B%0A%20%20%20%20%20%20uniforms.roughnessMap.value%20%3D%20material.roughnessMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.roughnessMap%2C%20uniforms.roughnessMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.envMap%29%20%7B%0A%20%20%20%20%20%20uniforms.envMapIntensity.value%20%3D%20material.envMapIntensity%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshUniformsPhysical%28uniforms%2C%20material%2C%20transmissionRenderTarget%29%20%7B%0A%20%20%20%20uniforms.ior.value%20%3D%20material.ior%3B%0A%20%20%20%20if%20%28material.sheen%20%3E%200%29%20%7B%0A%20%20%20%20%20%20uniforms.sheenColor.value.copy%28material.sheenColor%29.multiplyScalar%28material.sheen%29%3B%0A%20%20%20%20%20%20uniforms.sheenRoughness.value%20%3D%20material.sheenRoughness%3B%0A%20%20%20%20%20%20if%20%28material.sheenColorMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.sheenColorMap.value%20%3D%20material.sheenColorMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.sheenColorMap%2C%20uniforms.sheenColorMapTransform%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28material.sheenRoughnessMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.sheenRoughnessMap.value%20%3D%20material.sheenRoughnessMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.sheenRoughnessMap%2C%20uniforms.sheenRoughnessMapTransform%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.clearcoat%20%3E%200%29%20%7B%0A%20%20%20%20%20%20uniforms.clearcoat.value%20%3D%20material.clearcoat%3B%0A%20%20%20%20%20%20uniforms.clearcoatRoughness.value%20%3D%20material.clearcoatRoughness%3B%0A%20%20%20%20%20%20if%20%28material.clearcoatMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.clearcoatMap.value%20%3D%20material.clearcoatMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.clearcoatMap%2C%20uniforms.clearcoatMapTransform%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28material.clearcoatRoughnessMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.clearcoatRoughnessMap.value%20%3D%20material.clearcoatRoughnessMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.clearcoatRoughnessMap%2C%20uniforms.clearcoatRoughnessMapTransform%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28material.clearcoatNormalMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.clearcoatNormalMap.value%20%3D%20material.clearcoatNormalMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.clearcoatNormalMap%2C%20uniforms.clearcoatNormalMapTransform%29%3B%0A%20%20%20%20%20%20%20%20uniforms.clearcoatNormalScale.value.copy%28material.clearcoatNormalScale%29%3B%0A%20%20%20%20%20%20%20%20if%20%28material.side%20%3D%3D%3D%20BackSide%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20uniforms.clearcoatNormalScale.value.negate%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.dispersion%20%3E%200%29%20%7B%0A%20%20%20%20%20%20uniforms.dispersion.value%20%3D%20material.dispersion%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.iridescence%20%3E%200%29%20%7B%0A%20%20%20%20%20%20uniforms.iridescence.value%20%3D%20material.iridescence%3B%0A%20%20%20%20%20%20uniforms.iridescenceIOR.value%20%3D%20material.iridescenceIOR%3B%0A%20%20%20%20%20%20uniforms.iridescenceThicknessMinimum.value%20%3D%20material.iridescenceThicknessRange%5B0%5D%3B%0A%20%20%20%20%20%20uniforms.iridescenceThicknessMaximum.value%20%3D%20material.iridescenceThicknessRange%5B1%5D%3B%0A%20%20%20%20%20%20if%20%28material.iridescenceMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.iridescenceMap.value%20%3D%20material.iridescenceMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.iridescenceMap%2C%20uniforms.iridescenceMapTransform%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28material.iridescenceThicknessMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.iridescenceThicknessMap.value%20%3D%20material.iridescenceThicknessMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.iridescenceThicknessMap%2C%20uniforms.iridescenceThicknessMapTransform%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.transmission%20%3E%200%29%20%7B%0A%20%20%20%20%20%20uniforms.transmission.value%20%3D%20material.transmission%3B%0A%20%20%20%20%20%20uniforms.transmissionSamplerMap.value%20%3D%20transmissionRenderTarget.texture%3B%0A%20%20%20%20%20%20uniforms.transmissionSamplerSize.value.set%28transmissionRenderTarget.width%2C%20transmissionRenderTarget.height%29%3B%0A%20%20%20%20%20%20if%20%28material.transmissionMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.transmissionMap.value%20%3D%20material.transmissionMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.transmissionMap%2C%20uniforms.transmissionMapTransform%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20uniforms.thickness.value%20%3D%20material.thickness%3B%0A%20%20%20%20%20%20if%20%28material.thicknessMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.thicknessMap.value%20%3D%20material.thicknessMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.thicknessMap%2C%20uniforms.thicknessMapTransform%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20uniforms.attenuationDistance.value%20%3D%20material.attenuationDistance%3B%0A%20%20%20%20%20%20uniforms.attenuationColor.value.copy%28material.attenuationColor%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.anisotropy%20%3E%200%29%20%7B%0A%20%20%20%20%20%20uniforms.anisotropyVector.value.set%28material.anisotropy%20%2A%20Math.cos%28material.anisotropyRotation%29%2C%20material.anisotropy%20%2A%20Math.sin%28material.anisotropyRotation%29%29%3B%0A%20%20%20%20%20%20if%20%28material.anisotropyMap%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.anisotropyMap.value%20%3D%20material.anisotropyMap%3B%0A%20%20%20%20%20%20%20%20refreshTransformUniform%28material.anisotropyMap%2C%20uniforms.anisotropyMapTransform%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20uniforms.specularIntensity.value%20%3D%20material.specularIntensity%3B%0A%20%20%20%20uniforms.specularColor.value.copy%28material.specularColor%29%3B%0A%20%20%20%20if%20%28material.specularColorMap%29%20%7B%0A%20%20%20%20%20%20uniforms.specularColorMap.value%20%3D%20material.specularColorMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.specularColorMap%2C%20uniforms.specularColorMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.specularIntensityMap%29%20%7B%0A%20%20%20%20%20%20uniforms.specularIntensityMap.value%20%3D%20material.specularIntensityMap%3B%0A%20%20%20%20%20%20refreshTransformUniform%28material.specularIntensityMap%2C%20uniforms.specularIntensityMapTransform%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshUniformsMatcap%28uniforms%2C%20material%29%20%7B%0A%20%20%20%20if%20%28material.matcap%29%20%7B%0A%20%20%20%20%20%20uniforms.matcap.value%20%3D%20material.matcap%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20refreshUniformsDistance%28uniforms%2C%20material%29%20%7B%0A%20%20%20%20const%20light%20%3D%20properties.get%28material%29.light%3B%0A%20%20%20%20uniforms.referencePosition.value.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20uniforms.nearDistance.value%20%3D%20light.shadow.camera.near%3B%0A%20%20%20%20uniforms.farDistance.value%20%3D%20light.shadow.camera.far%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20refreshFogUniforms%2C%0A%20%20%20%20refreshMaterialUniforms%0A%20%20%7D%3B%0A%7D%0Afunction%20WebGLUniformsGroups%28gl%2C%20info%2C%20capabilities%2C%20state%29%20%7B%0A%20%20let%20buffers%20%3D%20%7B%7D%3B%0A%20%20let%20updateList%20%3D%20%7B%7D%3B%0A%20%20let%20allocatedBindingPoints%20%3D%20%5B%5D%3B%0A%20%20const%20maxBindingPoints%20%3D%20gl.getParameter%28gl.MAX_UNIFORM_BUFFER_BINDINGS%29%3B%0A%20%20function%20bind%28uniformsGroup%2C%20program%29%20%7B%0A%20%20%20%20const%20webglProgram%20%3D%20program.program%3B%0A%20%20%20%20state.uniformBlockBinding%28uniformsGroup%2C%20webglProgram%29%3B%0A%20%20%7D%0A%20%20function%20update4%28uniformsGroup%2C%20program%29%20%7B%0A%20%20%20%20let%20buffer2%20%3D%20buffers%5BuniformsGroup.id%5D%3B%0A%20%20%20%20if%20%28buffer2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20prepareUniformsGroup%28uniformsGroup%29%3B%0A%20%20%20%20%20%20buffer2%20%3D%20createBuffer%28uniformsGroup%29%3B%0A%20%20%20%20%20%20buffers%5BuniformsGroup.id%5D%20%3D%20buffer2%3B%0A%20%20%20%20%20%20uniformsGroup.addEventListener%28%22dispose%22%2C%20onUniformsGroupsDispose%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20webglProgram%20%3D%20program.program%3B%0A%20%20%20%20state.updateUBOMapping%28uniformsGroup%2C%20webglProgram%29%3B%0A%20%20%20%20const%20frame2%20%3D%20info.render.frame%3B%0A%20%20%20%20if%20%28updateList%5BuniformsGroup.id%5D%20%21%3D%3D%20frame2%29%20%7B%0A%20%20%20%20%20%20updateBufferData%28uniformsGroup%29%3B%0A%20%20%20%20%20%20updateList%5BuniformsGroup.id%5D%20%3D%20frame2%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20createBuffer%28uniformsGroup%29%20%7B%0A%20%20%20%20const%20bindingPointIndex%20%3D%20allocateBindingPointIndex%28%29%3B%0A%20%20%20%20uniformsGroup.__bindingPointIndex%20%3D%20bindingPointIndex%3B%0A%20%20%20%20const%20buffer2%20%3D%20gl.createBuffer%28%29%3B%0A%20%20%20%20const%20size%20%3D%20uniformsGroup.__size%3B%0A%20%20%20%20const%20usage%20%3D%20uniformsGroup.usage%3B%0A%20%20%20%20gl.bindBuffer%28gl.UNIFORM_BUFFER%2C%20buffer2%29%3B%0A%20%20%20%20gl.bufferData%28gl.UNIFORM_BUFFER%2C%20size%2C%20usage%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.UNIFORM_BUFFER%2C%20null%29%3B%0A%20%20%20%20gl.bindBufferBase%28gl.UNIFORM_BUFFER%2C%20bindingPointIndex%2C%20buffer2%29%3B%0A%20%20%20%20return%20buffer2%3B%0A%20%20%7D%0A%20%20function%20allocateBindingPointIndex%28%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20maxBindingPoints%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28allocatedBindingPoints.indexOf%28i%29%20%3D%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20allocatedBindingPoints.push%28i%29%3B%0A%20%20%20%20%20%20%20%20return%20i%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20console.error%28%22THREE.WebGLRenderer%3A%20Maximum%20number%20of%20simultaneously%20usable%20uniforms%20groups%20reached.%22%29%3B%0A%20%20%20%20return%200%3B%0A%20%20%7D%0A%20%20function%20updateBufferData%28uniformsGroup%29%20%7B%0A%20%20%20%20const%20buffer2%20%3D%20buffers%5BuniformsGroup.id%5D%3B%0A%20%20%20%20const%20uniforms%20%3D%20uniformsGroup.uniforms%3B%0A%20%20%20%20const%20cache2%20%3D%20uniformsGroup.__cache%3B%0A%20%20%20%20gl.bindBuffer%28gl.UNIFORM_BUFFER%2C%20buffer2%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20uniforms.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20uniformArray2%20%3D%20Array.isArray%28uniforms%5Bi%5D%29%20%3F%20uniforms%5Bi%5D%20%3A%20%5Buniforms%5Bi%5D%5D%3B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%200%2C%20jl%20%3D%20uniformArray2.length%3B%20j%20%3C%20jl%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniform2%20%3D%20uniformArray2%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28hasUniformChanged%28uniform2%2C%20i%2C%20j%2C%20cache2%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20offset%20%3D%20uniform2.__offset%3B%0A%20%20%20%20%20%20%20%20%20%20const%20values%20%3D%20Array.isArray%28uniform2.value%29%20%3F%20uniform2.value%20%3A%20%5Buniform2.value%5D%3B%0A%20%20%20%20%20%20%20%20%20%20let%20arrayOffset%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20k%20%3D%200%3B%20k%20%3C%20values.length%3B%20k%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20value%20%3D%20values%5Bk%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20info2%20%3D%20getUniformSize%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%22number%22%20%7C%7C%20typeof%20value%20%3D%3D%3D%20%22boolean%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B0%5D%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.bufferSubData%28gl.UNIFORM_BUFFER%2C%20offset%20%2B%20arrayOffset%2C%20uniform2.__data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28value.isMatrix3%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B0%5D%20%3D%20value.elements%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B1%5D%20%3D%20value.elements%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B2%5D%20%3D%20value.elements%5B2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B3%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B4%5D%20%3D%20value.elements%5B3%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B5%5D%20%3D%20value.elements%5B4%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B6%5D%20%3D%20value.elements%5B5%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B7%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B8%5D%20%3D%20value.elements%5B6%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B9%5D%20%3D%20value.elements%5B7%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B10%5D%20%3D%20value.elements%5B8%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniform2.__data%5B11%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20value.toArray%28uniform2.__data%2C%20arrayOffset%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrayOffset%20%2B%3D%20info2.storage%20%2F%20Float32Array.BYTES_PER_ELEMENT%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20gl.bufferSubData%28gl.UNIFORM_BUFFER%2C%20offset%2C%20uniform2.__data%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20gl.bindBuffer%28gl.UNIFORM_BUFFER%2C%20null%29%3B%0A%20%20%7D%0A%20%20function%20hasUniformChanged%28uniform2%2C%20index5%2C%20indexArray%2C%20cache2%29%20%7B%0A%20%20%20%20const%20value%20%3D%20uniform2.value%3B%0A%20%20%20%20const%20indexString%20%3D%20index5%20%2B%20%22_%22%20%2B%20indexArray%3B%0A%20%20%20%20if%20%28cache2%5BindexString%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%22number%22%20%7C%7C%20typeof%20value%20%3D%3D%3D%20%22boolean%22%29%20%7B%0A%20%20%20%20%20%20%20%20cache2%5BindexString%5D%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20cache2%5BindexString%5D%20%3D%20value.clone%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20cachedObject%20%3D%20cache2%5BindexString%5D%3B%0A%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%22number%22%20%7C%7C%20typeof%20value%20%3D%3D%3D%20%22boolean%22%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28cachedObject%20%21%3D%3D%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20cache2%5BindexString%5D%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28cachedObject.equals%28value%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20cachedObject.copy%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20function%20prepareUniformsGroup%28uniformsGroup%29%20%7B%0A%20%20%20%20const%20uniforms%20%3D%20uniformsGroup.uniforms%3B%0A%20%20%20%20let%20offset%20%3D%200%3B%0A%20%20%20%20const%20chunkSize%20%3D%2016%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20uniforms.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20uniformArray2%20%3D%20Array.isArray%28uniforms%5Bi%5D%29%20%3F%20uniforms%5Bi%5D%20%3A%20%5Buniforms%5Bi%5D%5D%3B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%200%2C%20jl%20%3D%20uniformArray2.length%3B%20j%20%3C%20jl%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uniform2%20%3D%20uniformArray2%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20const%20values%20%3D%20Array.isArray%28uniform2.value%29%20%3F%20uniform2.value%20%3A%20%5Buniform2.value%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20k%20%3D%200%2C%20kl%20%3D%20values.length%3B%20k%20%3C%20kl%3B%20k%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20value%20%3D%20values%5Bk%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20info2%20%3D%20getUniformSize%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20chunkOffset2%20%3D%20offset%20%25%20chunkSize%3B%0A%20%20%20%20%20%20%20%20%20%20const%20chunkPadding%20%3D%20chunkOffset2%20%25%20info2.boundary%3B%0A%20%20%20%20%20%20%20%20%20%20const%20chunkStart%20%3D%20chunkOffset2%20%2B%20chunkPadding%3B%0A%20%20%20%20%20%20%20%20%20%20offset%20%2B%3D%20chunkPadding%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28chunkStart%20%21%3D%3D%200%20%26%26%20chunkSize%20-%20chunkStart%20%3C%20info2.storage%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%20%2B%3D%20chunkSize%20-%20chunkStart%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20uniform2.__data%20%3D%20new%20Float32Array%28info2.storage%20%2F%20Float32Array.BYTES_PER_ELEMENT%29%3B%0A%20%20%20%20%20%20%20%20%20%20uniform2.__offset%20%3D%20offset%3B%0A%20%20%20%20%20%20%20%20%20%20offset%20%2B%3D%20info2.storage%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20chunkOffset%20%3D%20offset%20%25%20chunkSize%3B%0A%20%20%20%20if%20%28chunkOffset%20%3E%200%29%20offset%20%2B%3D%20chunkSize%20-%20chunkOffset%3B%0A%20%20%20%20uniformsGroup.__size%20%3D%20offset%3B%0A%20%20%20%20uniformsGroup.__cache%20%3D%20%7B%7D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20function%20getUniformSize%28value%29%20%7B%0A%20%20%20%20const%20info2%20%3D%20%7B%0A%20%20%20%20%20%20boundary%3A%200%2C%0A%20%20%20%20%20%20%2F%2F%20bytes%0A%20%20%20%20%20%20storage%3A%200%0A%20%20%20%20%20%20%2F%2F%20bytes%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%22number%22%20%7C%7C%20typeof%20value%20%3D%3D%3D%20%22boolean%22%29%20%7B%0A%20%20%20%20%20%20info2.boundary%20%3D%204%3B%0A%20%20%20%20%20%20info2.storage%20%3D%204%3B%0A%20%20%20%20%7D%20else%20if%20%28value.isVector2%29%20%7B%0A%20%20%20%20%20%20info2.boundary%20%3D%208%3B%0A%20%20%20%20%20%20info2.storage%20%3D%208%3B%0A%20%20%20%20%7D%20else%20if%20%28value.isVector3%20%7C%7C%20value.isColor%29%20%7B%0A%20%20%20%20%20%20info2.boundary%20%3D%2016%3B%0A%20%20%20%20%20%20info2.storage%20%3D%2012%3B%0A%20%20%20%20%7D%20else%20if%20%28value.isVector4%29%20%7B%0A%20%20%20%20%20%20info2.boundary%20%3D%2016%3B%0A%20%20%20%20%20%20info2.storage%20%3D%2016%3B%0A%20%20%20%20%7D%20else%20if%20%28value.isMatrix3%29%20%7B%0A%20%20%20%20%20%20info2.boundary%20%3D%2048%3B%0A%20%20%20%20%20%20info2.storage%20%3D%2048%3B%0A%20%20%20%20%7D%20else%20if%20%28value.isMatrix4%29%20%7B%0A%20%20%20%20%20%20info2.boundary%20%3D%2064%3B%0A%20%20%20%20%20%20info2.storage%20%3D%2064%3B%0A%20%20%20%20%7D%20else%20if%20%28value.isTexture%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Texture%20samplers%20can%20not%20be%20part%20of%20an%20uniforms%20group.%22%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Unsupported%20uniform%20value%20type.%22%2C%20value%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20info2%3B%0A%20%20%7D%0A%20%20function%20onUniformsGroupsDispose%28event%29%20%7B%0A%20%20%20%20const%20uniformsGroup%20%3D%20event.target%3B%0A%20%20%20%20uniformsGroup.removeEventListener%28%22dispose%22%2C%20onUniformsGroupsDispose%29%3B%0A%20%20%20%20const%20index5%20%3D%20allocatedBindingPoints.indexOf%28uniformsGroup.__bindingPointIndex%29%3B%0A%20%20%20%20allocatedBindingPoints.splice%28index5%2C%201%29%3B%0A%20%20%20%20gl.deleteBuffer%28buffers%5BuniformsGroup.id%5D%29%3B%0A%20%20%20%20delete%20buffers%5BuniformsGroup.id%5D%3B%0A%20%20%20%20delete%20updateList%5BuniformsGroup.id%5D%3B%0A%20%20%7D%0A%20%20function%20dispose%28%29%20%7B%0A%20%20%20%20for%20%28const%20id2%20in%20buffers%29%20%7B%0A%20%20%20%20%20%20gl.deleteBuffer%28buffers%5Bid2%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20allocatedBindingPoints%20%3D%20%5B%5D%3B%0A%20%20%20%20buffers%20%3D%20%7B%7D%3B%0A%20%20%20%20updateList%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20bind%2C%0A%20%20%20%20update%3A%20update4%2C%0A%20%20%20%20dispose%0A%20%20%7D%3B%0A%7D%0Avar%20WebGLRenderer%20%3D%20class%20%7B%0A%20%20constructor%28parameters%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20const%20%7B%0A%20%20%20%20%20%20canvas%20%3D%20createCanvasElement%28%29%2C%0A%20%20%20%20%20%20context%3A%20context2%20%3D%20null%2C%0A%20%20%20%20%20%20depth%3A%20depth2%20%3D%20true%2C%0A%20%20%20%20%20%20stencil%20%3D%20false%2C%0A%20%20%20%20%20%20alpha%20%3D%20false%2C%0A%20%20%20%20%20%20antialias%20%3D%20false%2C%0A%20%20%20%20%20%20premultipliedAlpha%20%3D%20true%2C%0A%20%20%20%20%20%20preserveDrawingBuffer%20%3D%20false%2C%0A%20%20%20%20%20%20powerPreference%20%3D%20%22default%22%2C%0A%20%20%20%20%20%20failIfMajorPerformanceCaveat%20%3D%20false%2C%0A%20%20%20%20%20%20reverseDepthBuffer%20%3D%20false%0A%20%20%20%20%7D%20%3D%20parameters%3B%0A%20%20%20%20this.isWebGLRenderer%20%3D%20true%3B%0A%20%20%20%20let%20_alpha%3B%0A%20%20%20%20if%20%28context2%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28typeof%20WebGLRenderingContext%20%21%3D%3D%20%22undefined%22%20%26%26%20context2%20instanceof%20WebGLRenderingContext%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGLRenderer%3A%20WebGL%201%20is%20not%20supported%20since%20r163.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_alpha%20%3D%20context2.getContextAttributes%28%29.alpha%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_alpha%20%3D%20alpha%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20uintClearColor%20%3D%20new%20Uint32Array%284%29%3B%0A%20%20%20%20const%20intClearColor%20%3D%20new%20Int32Array%284%29%3B%0A%20%20%20%20let%20currentRenderList%20%3D%20null%3B%0A%20%20%20%20let%20currentRenderState%20%3D%20null%3B%0A%20%20%20%20const%20renderListStack%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20renderStateStack%20%3D%20%5B%5D%3B%0A%20%20%20%20this.domElement%20%3D%20canvas%3B%0A%20%20%20%20this.debug%20%3D%20%7B%0A%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%2A%20Enables%20error%20checking%20and%20reporting%20when%20shader%20programs%20are%20being%20compiled%0A%20%20%20%20%20%20%20%2A%20%40type%20%7Bboolean%7D%0A%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20checkShaderErrors%3A%20true%2C%0A%20%20%20%20%20%20%2F%2A%2A%0A%20%20%20%20%20%20%20%2A%20Callback%20for%20custom%20error%20reporting.%0A%20%20%20%20%20%20%20%2A%20%40type%20%7B%3FFunction%7D%0A%20%20%20%20%20%20%20%2A%2F%0A%20%20%20%20%20%20onShaderError%3A%20null%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.autoClear%20%3D%20true%3B%0A%20%20%20%20this.autoClearColor%20%3D%20true%3B%0A%20%20%20%20this.autoClearDepth%20%3D%20true%3B%0A%20%20%20%20this.autoClearStencil%20%3D%20true%3B%0A%20%20%20%20this.sortObjects%20%3D%20true%3B%0A%20%20%20%20this.clippingPlanes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.localClippingEnabled%20%3D%20false%3B%0A%20%20%20%20this._outputColorSpace%20%3D%20SRGBColorSpace%3B%0A%20%20%20%20this.toneMapping%20%3D%20NoToneMapping%3B%0A%20%20%20%20this.toneMappingExposure%20%3D%201%3B%0A%20%20%20%20const%20_this%20%3D%20this%3B%0A%20%20%20%20let%20_isContextLost%20%3D%20false%3B%0A%20%20%20%20let%20_currentActiveCubeFace%20%3D%200%3B%0A%20%20%20%20let%20_currentActiveMipmapLevel%20%3D%200%3B%0A%20%20%20%20let%20_currentRenderTarget%20%3D%20null%3B%0A%20%20%20%20let%20_currentMaterialId%20%3D%20-1%3B%0A%20%20%20%20let%20_currentCamera%20%3D%20null%3B%0A%20%20%20%20const%20_currentViewport%20%3D%20new%20Vector4%28%29%3B%0A%20%20%20%20const%20_currentScissor%20%3D%20new%20Vector4%28%29%3B%0A%20%20%20%20let%20_currentScissorTest%20%3D%20null%3B%0A%20%20%20%20const%20_currentClearColor%20%3D%20new%20Color%280%29%3B%0A%20%20%20%20let%20_currentClearAlpha%20%3D%200%3B%0A%20%20%20%20let%20_width%20%3D%20canvas.width%3B%0A%20%20%20%20let%20_height%20%3D%20canvas.height%3B%0A%20%20%20%20let%20_pixelRatio%20%3D%201%3B%0A%20%20%20%20let%20_opaqueSort%20%3D%20null%3B%0A%20%20%20%20let%20_transparentSort%20%3D%20null%3B%0A%20%20%20%20const%20_viewport%20%3D%20new%20Vector4%280%2C%200%2C%20_width%2C%20_height%29%3B%0A%20%20%20%20const%20_scissor%20%3D%20new%20Vector4%280%2C%200%2C%20_width%2C%20_height%29%3B%0A%20%20%20%20let%20_scissorTest%20%3D%20false%3B%0A%20%20%20%20const%20_frustum2%20%3D%20new%20Frustum%28%29%3B%0A%20%20%20%20let%20_clippingEnabled%20%3D%20false%3B%0A%20%20%20%20let%20_localClippingEnabled%20%3D%20false%3B%0A%20%20%20%20const%20_currentProjectionMatrix%20%3D%20new%20Matrix4%28%29%3B%0A%20%20%20%20const%20_projScreenMatrix2%20%3D%20new%20Matrix4%28%29%3B%0A%20%20%20%20const%20_vector3%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20_vector42%20%3D%20new%20Vector4%28%29%3B%0A%20%20%20%20const%20_emptyScene%20%3D%20%7B%20background%3A%20null%2C%20fog%3A%20null%2C%20environment%3A%20null%2C%20overrideMaterial%3A%20null%2C%20isScene%3A%20true%20%7D%3B%0A%20%20%20%20let%20_renderBackground%20%3D%20false%3B%0A%20%20%20%20function%20getTargetPixelRatio%28%29%20%7B%0A%20%20%20%20%20%20return%20_currentRenderTarget%20%3D%3D%3D%20null%20%3F%20_pixelRatio%20%3A%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20_gl%20%3D%20context2%3B%0A%20%20%20%20function%20getContext%28contextName%2C%20contextAttributes%29%20%7B%0A%20%20%20%20%20%20return%20canvas.getContext%28contextName%2C%20contextAttributes%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20const%20contextAttributes%20%3D%20%7B%0A%20%20%20%20%20%20%20%20alpha%3A%20true%2C%0A%20%20%20%20%20%20%20%20depth%3A%20depth2%2C%0A%20%20%20%20%20%20%20%20stencil%2C%0A%20%20%20%20%20%20%20%20antialias%2C%0A%20%20%20%20%20%20%20%20premultipliedAlpha%2C%0A%20%20%20%20%20%20%20%20preserveDrawingBuffer%2C%0A%20%20%20%20%20%20%20%20powerPreference%2C%0A%20%20%20%20%20%20%20%20failIfMajorPerformanceCaveat%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20if%20%28%22setAttribute%22%20in%20canvas%29%20canvas.setAttribute%28%22data-engine%22%2C%20%60three.js%20r%24%7BREVISION%7D%60%29%3B%0A%20%20%20%20%20%20canvas.addEventListener%28%22webglcontextlost%22%2C%20onContextLost%2C%20false%29%3B%0A%20%20%20%20%20%20canvas.addEventListener%28%22webglcontextrestored%22%2C%20onContextRestore%2C%20false%29%3B%0A%20%20%20%20%20%20canvas.addEventListener%28%22webglcontextcreationerror%22%2C%20onContextCreationError%2C%20false%29%3B%0A%20%20%20%20%20%20if%20%28_gl%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20const%20contextName%20%3D%20%22webgl2%22%3B%0A%20%20%20%20%20%20%20%20_gl%20%3D%20getContext%28contextName%2C%20contextAttributes%29%3B%0A%20%20%20%20%20%20%20%20if%20%28_gl%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28getContext%28contextName%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Error%20creating%20WebGL%20context%20with%20your%20selected%20attributes.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Error%20creating%20WebGL%20context.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLRenderer%3A%20%22%20%2B%20error.message%29%3B%0A%20%20%20%20%20%20throw%20error%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20extensions%2C%20capabilities%2C%20state%2C%20info%3B%0A%20%20%20%20let%20properties%2C%20textures%2C%20cubemaps%2C%20cubeuvmaps%2C%20attributes%2C%20geometries%2C%20objects%3B%0A%20%20%20%20let%20programCache%2C%20materials%2C%20renderLists%2C%20renderStates%2C%20clipping2%2C%20shadowMap%3B%0A%20%20%20%20let%20background%2C%20morphtargets%2C%20bufferRenderer%2C%20indexedBufferRenderer%3B%0A%20%20%20%20let%20utils%2C%20bindingStates%2C%20uniformsGroups%3B%0A%20%20%20%20function%20initGLContext%28%29%20%7B%0A%20%20%20%20%20%20extensions%20%3D%20new%20WebGLExtensions%28_gl%29%3B%0A%20%20%20%20%20%20extensions.init%28%29%3B%0A%20%20%20%20%20%20utils%20%3D%20new%20WebGLUtils%28_gl%2C%20extensions%29%3B%0A%20%20%20%20%20%20capabilities%20%3D%20new%20WebGLCapabilities%28_gl%2C%20extensions%2C%20parameters%2C%20utils%29%3B%0A%20%20%20%20%20%20state%20%3D%20new%20WebGLState%28_gl%2C%20extensions%29%3B%0A%20%20%20%20%20%20if%20%28capabilities.reverseDepthBuffer%20%26%26%20reverseDepthBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20state.buffers.depth.setReversed%28true%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20info%20%3D%20new%20WebGLInfo%28_gl%29%3B%0A%20%20%20%20%20%20properties%20%3D%20new%20WebGLProperties%28%29%3B%0A%20%20%20%20%20%20textures%20%3D%20new%20WebGLTextures%28_gl%2C%20extensions%2C%20state%2C%20properties%2C%20capabilities%2C%20utils%2C%20info%29%3B%0A%20%20%20%20%20%20cubemaps%20%3D%20new%20WebGLCubeMaps%28_this%29%3B%0A%20%20%20%20%20%20cubeuvmaps%20%3D%20new%20WebGLCubeUVMaps%28_this%29%3B%0A%20%20%20%20%20%20attributes%20%3D%20new%20WebGLAttributes%28_gl%29%3B%0A%20%20%20%20%20%20bindingStates%20%3D%20new%20WebGLBindingStates%28_gl%2C%20attributes%29%3B%0A%20%20%20%20%20%20geometries%20%3D%20new%20WebGLGeometries%28_gl%2C%20attributes%2C%20info%2C%20bindingStates%29%3B%0A%20%20%20%20%20%20objects%20%3D%20new%20WebGLObjects%28_gl%2C%20geometries%2C%20attributes%2C%20info%29%3B%0A%20%20%20%20%20%20morphtargets%20%3D%20new%20WebGLMorphtargets%28_gl%2C%20capabilities%2C%20textures%29%3B%0A%20%20%20%20%20%20clipping2%20%3D%20new%20WebGLClipping%28properties%29%3B%0A%20%20%20%20%20%20programCache%20%3D%20new%20WebGLPrograms%28_this%2C%20cubemaps%2C%20cubeuvmaps%2C%20extensions%2C%20capabilities%2C%20bindingStates%2C%20clipping2%29%3B%0A%20%20%20%20%20%20materials%20%3D%20new%20WebGLMaterials%28_this%2C%20properties%29%3B%0A%20%20%20%20%20%20renderLists%20%3D%20new%20WebGLRenderLists%28%29%3B%0A%20%20%20%20%20%20renderStates%20%3D%20new%20WebGLRenderStates%28extensions%29%3B%0A%20%20%20%20%20%20background%20%3D%20new%20WebGLBackground%28_this%2C%20cubemaps%2C%20cubeuvmaps%2C%20state%2C%20objects%2C%20_alpha%2C%20premultipliedAlpha%29%3B%0A%20%20%20%20%20%20shadowMap%20%3D%20new%20WebGLShadowMap%28_this%2C%20objects%2C%20capabilities%29%3B%0A%20%20%20%20%20%20uniformsGroups%20%3D%20new%20WebGLUniformsGroups%28_gl%2C%20info%2C%20capabilities%2C%20state%29%3B%0A%20%20%20%20%20%20bufferRenderer%20%3D%20new%20WebGLBufferRenderer%28_gl%2C%20extensions%2C%20info%29%3B%0A%20%20%20%20%20%20indexedBufferRenderer%20%3D%20new%20WebGLIndexedBufferRenderer%28_gl%2C%20extensions%2C%20info%29%3B%0A%20%20%20%20%20%20info.programs%20%3D%20programCache.programs%3B%0A%20%20%20%20%20%20_this.capabilities%20%3D%20capabilities%3B%0A%20%20%20%20%20%20_this.extensions%20%3D%20extensions%3B%0A%20%20%20%20%20%20_this.properties%20%3D%20properties%3B%0A%20%20%20%20%20%20_this.renderLists%20%3D%20renderLists%3B%0A%20%20%20%20%20%20_this.shadowMap%20%3D%20shadowMap%3B%0A%20%20%20%20%20%20_this.state%20%3D%20state%3B%0A%20%20%20%20%20%20_this.info%20%3D%20info%3B%0A%20%20%20%20%7D%0A%20%20%20%20initGLContext%28%29%3B%0A%20%20%20%20const%20xr%20%3D%20new%20WebXRManager%28_this%2C%20_gl%29%3B%0A%20%20%20%20this.xr%20%3D%20xr%3B%0A%20%20%20%20this.getContext%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20_gl%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getContextAttributes%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20_gl.getContextAttributes%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.forceContextLoss%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20const%20extension%20%3D%20extensions.get%28%22WEBGL_lose_context%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%29%20extension.loseContext%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.forceContextRestore%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20const%20extension%20%3D%20extensions.get%28%22WEBGL_lose_context%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%29%20extension.restoreContext%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getPixelRatio%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20_pixelRatio%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setPixelRatio%20%3D%20function%28value%29%20%7B%0A%20%20%20%20%20%20if%20%28value%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20%20%20_pixelRatio%20%3D%20value%3B%0A%20%20%20%20%20%20this.setSize%28_width%2C%20_height%2C%20false%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getSize%20%3D%20function%28target%29%20%7B%0A%20%20%20%20%20%20return%20target.set%28_width%2C%20_height%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setSize%20%3D%20function%28width%2C%20height%2C%20updateStyle%20%3D%20true%29%20%7B%0A%20%20%20%20%20%20if%20%28xr.isPresenting%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Can%27t%20change%20size%20while%20VR%20device%20is%20presenting.%22%29%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_width%20%3D%20width%3B%0A%20%20%20%20%20%20_height%20%3D%20height%3B%0A%20%20%20%20%20%20canvas.width%20%3D%20Math.floor%28width%20%2A%20_pixelRatio%29%3B%0A%20%20%20%20%20%20canvas.height%20%3D%20Math.floor%28height%20%2A%20_pixelRatio%29%3B%0A%20%20%20%20%20%20if%20%28updateStyle%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20canvas.style.width%20%3D%20width%20%2B%20%22px%22%3B%0A%20%20%20%20%20%20%20%20canvas.style.height%20%3D%20height%20%2B%20%22px%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.setViewport%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getDrawingBufferSize%20%3D%20function%28target%29%20%7B%0A%20%20%20%20%20%20return%20target.set%28_width%20%2A%20_pixelRatio%2C%20_height%20%2A%20_pixelRatio%29.floor%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setDrawingBufferSize%20%3D%20function%28width%2C%20height%2C%20pixelRatio%29%20%7B%0A%20%20%20%20%20%20_width%20%3D%20width%3B%0A%20%20%20%20%20%20_height%20%3D%20height%3B%0A%20%20%20%20%20%20_pixelRatio%20%3D%20pixelRatio%3B%0A%20%20%20%20%20%20canvas.width%20%3D%20Math.floor%28width%20%2A%20pixelRatio%29%3B%0A%20%20%20%20%20%20canvas.height%20%3D%20Math.floor%28height%20%2A%20pixelRatio%29%3B%0A%20%20%20%20%20%20this.setViewport%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getCurrentViewport%20%3D%20function%28target%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28_currentViewport%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getViewport%20%3D%20function%28target%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28_viewport%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setViewport%20%3D%20function%28x2%2C%20y2%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20%20%20if%20%28x2.isVector4%29%20%7B%0A%20%20%20%20%20%20%20%20_viewport.set%28x2.x%2C%20x2.y%2C%20x2.z%2C%20x2.w%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_viewport.set%28x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.viewport%28_currentViewport.copy%28_viewport%29.multiplyScalar%28_pixelRatio%29.round%28%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getScissor%20%3D%20function%28target%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28_scissor%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setScissor%20%3D%20function%28x2%2C%20y2%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20%20%20if%20%28x2.isVector4%29%20%7B%0A%20%20%20%20%20%20%20%20_scissor.set%28x2.x%2C%20x2.y%2C%20x2.z%2C%20x2.w%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_scissor.set%28x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.scissor%28_currentScissor.copy%28_scissor%29.multiplyScalar%28_pixelRatio%29.round%28%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getScissorTest%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20_scissorTest%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setScissorTest%20%3D%20function%28boolean%29%20%7B%0A%20%20%20%20%20%20state.setScissorTest%28_scissorTest%20%3D%20boolean%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setOpaqueSort%20%3D%20function%28method%29%20%7B%0A%20%20%20%20%20%20_opaqueSort%20%3D%20method%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setTransparentSort%20%3D%20function%28method%29%20%7B%0A%20%20%20%20%20%20_transparentSort%20%3D%20method%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getClearColor%20%3D%20function%28target%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28background.getClearColor%28%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setClearColor%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20background.setClearColor.apply%28background%2C%20arguments%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getClearAlpha%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20background.getClearAlpha%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setClearAlpha%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20background.setClearAlpha.apply%28background%2C%20arguments%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.clear%20%3D%20function%28color2%20%3D%20true%2C%20depth3%20%3D%20true%2C%20stencil2%20%3D%20true%29%20%7B%0A%20%20%20%20%20%20let%20bits%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28color2%29%20%7B%0A%20%20%20%20%20%20%20%20let%20isIntegerFormat%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20if%20%28_currentRenderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20targetFormat%20%3D%20_currentRenderTarget.texture.format%3B%0A%20%20%20%20%20%20%20%20%20%20isIntegerFormat%20%3D%20targetFormat%20%3D%3D%3D%20RGBAIntegerFormat%20%7C%7C%20targetFormat%20%3D%3D%3D%20RGIntegerFormat%20%7C%7C%20targetFormat%20%3D%3D%3D%20RedIntegerFormat%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28isIntegerFormat%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20targetType%20%3D%20_currentRenderTarget.texture.type%3B%0A%20%20%20%20%20%20%20%20%20%20const%20isUnsignedType%20%3D%20targetType%20%3D%3D%3D%20UnsignedByteType%20%7C%7C%20targetType%20%3D%3D%3D%20UnsignedIntType%20%7C%7C%20targetType%20%3D%3D%3D%20UnsignedShortType%20%7C%7C%20targetType%20%3D%3D%3D%20UnsignedInt248Type%20%7C%7C%20targetType%20%3D%3D%3D%20UnsignedShort4444Type%20%7C%7C%20targetType%20%3D%3D%3D%20UnsignedShort5551Type%3B%0A%20%20%20%20%20%20%20%20%20%20const%20clearColor%20%3D%20background.getClearColor%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20background.getClearAlpha%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20r%20%3D%20clearColor.r%3B%0A%20%20%20%20%20%20%20%20%20%20const%20g%20%3D%20clearColor.g%3B%0A%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20clearColor.b%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28isUnsignedType%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uintClearColor%5B0%5D%20%3D%20r%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20uintClearColor%5B1%5D%20%3D%20g%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20uintClearColor%5B2%5D%20%3D%20b%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20uintClearColor%5B3%5D%20%3D%20a2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.clearBufferuiv%28_gl.COLOR%2C%200%2C%20uintClearColor%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20intClearColor%5B0%5D%20%3D%20r%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intClearColor%5B1%5D%20%3D%20g%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intClearColor%5B2%5D%20%3D%20b%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intClearColor%5B3%5D%20%3D%20a2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.clearBufferiv%28_gl.COLOR%2C%200%2C%20intClearColor%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20bits%20%7C%3D%20_gl.COLOR_BUFFER_BIT%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28depth3%29%20%7B%0A%20%20%20%20%20%20%20%20bits%20%7C%3D%20_gl.DEPTH_BUFFER_BIT%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28stencil2%29%20%7B%0A%20%20%20%20%20%20%20%20bits%20%7C%3D%20_gl.STENCIL_BUFFER_BIT%3B%0A%20%20%20%20%20%20%20%20this.state.buffers.stencil.setMask%284294967295%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_gl.clear%28bits%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.clearColor%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20this.clear%28true%2C%20false%2C%20false%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.clearDepth%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20this.clear%28false%2C%20true%2C%20false%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.clearStencil%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20this.clear%28false%2C%20false%2C%20true%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.dispose%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20canvas.removeEventListener%28%22webglcontextlost%22%2C%20onContextLost%2C%20false%29%3B%0A%20%20%20%20%20%20canvas.removeEventListener%28%22webglcontextrestored%22%2C%20onContextRestore%2C%20false%29%3B%0A%20%20%20%20%20%20canvas.removeEventListener%28%22webglcontextcreationerror%22%2C%20onContextCreationError%2C%20false%29%3B%0A%20%20%20%20%20%20renderLists.dispose%28%29%3B%0A%20%20%20%20%20%20renderStates.dispose%28%29%3B%0A%20%20%20%20%20%20properties.dispose%28%29%3B%0A%20%20%20%20%20%20cubemaps.dispose%28%29%3B%0A%20%20%20%20%20%20cubeuvmaps.dispose%28%29%3B%0A%20%20%20%20%20%20objects.dispose%28%29%3B%0A%20%20%20%20%20%20bindingStates.dispose%28%29%3B%0A%20%20%20%20%20%20uniformsGroups.dispose%28%29%3B%0A%20%20%20%20%20%20programCache.dispose%28%29%3B%0A%20%20%20%20%20%20xr.dispose%28%29%3B%0A%20%20%20%20%20%20xr.removeEventListener%28%22sessionstart%22%2C%20onXRSessionStart%29%3B%0A%20%20%20%20%20%20xr.removeEventListener%28%22sessionend%22%2C%20onXRSessionEnd%29%3B%0A%20%20%20%20%20%20animation.stop%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20function%20onContextLost%28event%29%20%7B%0A%20%20%20%20%20%20event.preventDefault%28%29%3B%0A%20%20%20%20%20%20console.log%28%22THREE.WebGLRenderer%3A%20Context%20Lost.%22%29%3B%0A%20%20%20%20%20%20_isContextLost%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20onContextRestore%28%29%20%7B%0A%20%20%20%20%20%20console.log%28%22THREE.WebGLRenderer%3A%20Context%20Restored.%22%29%3B%0A%20%20%20%20%20%20_isContextLost%20%3D%20false%3B%0A%20%20%20%20%20%20const%20infoAutoReset%20%3D%20info.autoReset%3B%0A%20%20%20%20%20%20const%20shadowMapEnabled%20%3D%20shadowMap.enabled%3B%0A%20%20%20%20%20%20const%20shadowMapAutoUpdate%20%3D%20shadowMap.autoUpdate%3B%0A%20%20%20%20%20%20const%20shadowMapNeedsUpdate%20%3D%20shadowMap.needsUpdate%3B%0A%20%20%20%20%20%20const%20shadowMapType%20%3D%20shadowMap.type%3B%0A%20%20%20%20%20%20initGLContext%28%29%3B%0A%20%20%20%20%20%20info.autoReset%20%3D%20infoAutoReset%3B%0A%20%20%20%20%20%20shadowMap.enabled%20%3D%20shadowMapEnabled%3B%0A%20%20%20%20%20%20shadowMap.autoUpdate%20%3D%20shadowMapAutoUpdate%3B%0A%20%20%20%20%20%20shadowMap.needsUpdate%20%3D%20shadowMapNeedsUpdate%3B%0A%20%20%20%20%20%20shadowMap.type%20%3D%20shadowMapType%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20onContextCreationError%28event%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGLRenderer%3A%20A%20WebGL%20context%20could%20not%20be%20created.%20Reason%3A%20%22%2C%20event.statusMessage%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20onMaterialDispose%28event%29%20%7B%0A%20%20%20%20%20%20const%20material%20%3D%20event.target%3B%0A%20%20%20%20%20%20material.removeEventListener%28%22dispose%22%2C%20onMaterialDispose%29%3B%0A%20%20%20%20%20%20deallocateMaterial%28material%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20deallocateMaterial%28material%29%20%7B%0A%20%20%20%20%20%20releaseMaterialProgramReferences%28material%29%3B%0A%20%20%20%20%20%20properties.remove%28material%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20releaseMaterialProgramReferences%28material%29%20%7B%0A%20%20%20%20%20%20const%20programs%20%3D%20properties.get%28material%29.programs%3B%0A%20%20%20%20%20%20if%20%28programs%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20programs.forEach%28function%28program%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20programCache.releaseProgram%28program%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20if%20%28material.isShaderMaterial%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20programCache.releaseShaderCache%28material%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.renderBufferDirect%20%3D%20function%28camera3%2C%20scene3%2C%20geometry%2C%20material%2C%20object%2C%20group%29%20%7B%0A%20%20%20%20%20%20if%20%28scene3%20%3D%3D%3D%20null%29%20scene3%20%3D%20_emptyScene%3B%0A%20%20%20%20%20%20const%20frontFaceCW%20%3D%20object.isMesh%20%26%26%20object.matrixWorld.determinant%28%29%20%3C%200%3B%0A%20%20%20%20%20%20const%20program%20%3D%20setProgram%28camera3%2C%20scene3%2C%20geometry%2C%20material%2C%20object%29%3B%0A%20%20%20%20%20%20state.setMaterial%28material%2C%20frontFaceCW%29%3B%0A%20%20%20%20%20%20let%20index5%20%3D%20geometry.index%3B%0A%20%20%20%20%20%20let%20rangeFactor%20%3D%201%3B%0A%20%20%20%20%20%20if%20%28material.wireframe%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20index5%20%3D%20geometries.getWireframeAttribute%28geometry%29%3B%0A%20%20%20%20%20%20%20%20if%20%28index5%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20%20%20%20%20rangeFactor%20%3D%202%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20drawRange%20%3D%20geometry.drawRange%3B%0A%20%20%20%20%20%20const%20position%20%3D%20geometry.attributes.position%3B%0A%20%20%20%20%20%20let%20drawStart%20%3D%20drawRange.start%20%2A%20rangeFactor%3B%0A%20%20%20%20%20%20let%20drawEnd%20%3D%20%28drawRange.start%20%2B%20drawRange.count%29%20%2A%20rangeFactor%3B%0A%20%20%20%20%20%20if%20%28group%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20drawStart%20%3D%20Math.max%28drawStart%2C%20group.start%20%2A%20rangeFactor%29%3B%0A%20%20%20%20%20%20%20%20drawEnd%20%3D%20Math.min%28drawEnd%2C%20%28group.start%20%2B%20group.count%29%20%2A%20rangeFactor%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20drawStart%20%3D%20Math.max%28drawStart%2C%200%29%3B%0A%20%20%20%20%20%20%20%20drawEnd%20%3D%20Math.min%28drawEnd%2C%20index5.count%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28position%20%21%3D%3D%20void%200%20%26%26%20position%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20drawStart%20%3D%20Math.max%28drawStart%2C%200%29%3B%0A%20%20%20%20%20%20%20%20drawEnd%20%3D%20Math.min%28drawEnd%2C%20position.count%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20drawCount%20%3D%20drawEnd%20-%20drawStart%3B%0A%20%20%20%20%20%20if%20%28drawCount%20%3C%200%20%7C%7C%20drawCount%20%3D%3D%3D%20Infinity%29%20return%3B%0A%20%20%20%20%20%20bindingStates.setup%28object%2C%20material%2C%20program%2C%20geometry%2C%20index5%29%3B%0A%20%20%20%20%20%20let%20attribute2%3B%0A%20%20%20%20%20%20let%20renderer3%20%3D%20bufferRenderer%3B%0A%20%20%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20attribute2%20%3D%20attributes.get%28index5%29%3B%0A%20%20%20%20%20%20%20%20renderer3%20%3D%20indexedBufferRenderer%3B%0A%20%20%20%20%20%20%20%20renderer3.setIndex%28attribute2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28object.isMesh%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28material.wireframe%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.setLineWidth%28material.wireframeLinewidth%20%2A%20getTargetPixelRatio%28%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setMode%28_gl.LINES%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setMode%28_gl.TRIANGLES%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28object.isLine%29%20%7B%0A%20%20%20%20%20%20%20%20let%20lineWidth%20%3D%20material.linewidth%3B%0A%20%20%20%20%20%20%20%20if%20%28lineWidth%20%3D%3D%3D%20void%200%29%20lineWidth%20%3D%201%3B%0A%20%20%20%20%20%20%20%20state.setLineWidth%28lineWidth%20%2A%20getTargetPixelRatio%28%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28object.isLineSegments%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setMode%28_gl.LINES%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isLineLoop%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setMode%28_gl.LINE_LOOP%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderer3.setMode%28_gl.LINE_STRIP%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28object.isPoints%29%20%7B%0A%20%20%20%20%20%20%20%20renderer3.setMode%28_gl.POINTS%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28object.isSprite%29%20%7B%0A%20%20%20%20%20%20%20%20renderer3.setMode%28_gl.TRIANGLES%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28object.isBatchedMesh%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28object._multiDrawInstances%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderer3.renderMultiDrawInstances%28object._multiDrawStarts%2C%20object._multiDrawCounts%2C%20object._multiDrawCount%2C%20object._multiDrawInstances%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21extensions.get%28%22WEBGL_multi_draw%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20starts%20%3D%20object._multiDrawStarts%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20counts%20%3D%20object._multiDrawCounts%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20drawCount2%20%3D%20object._multiDrawCount%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20bytesPerElement%20%3D%20index5%20%3F%20attributes.get%28index5%29.bytesPerElement%20%3A%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20properties.get%28material%29.currentProgram.getUniforms%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount2%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20uniforms.setValue%28_gl%2C%20%22_gl_DrawID%22%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20renderer3.render%28starts%5Bi%5D%20%2F%20bytesPerElement%2C%20counts%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderer3.renderMultiDraw%28object._multiDrawStarts%2C%20object._multiDrawCounts%2C%20object._multiDrawCount%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28object.isInstancedMesh%29%20%7B%0A%20%20%20%20%20%20%20%20renderer3.renderInstances%28drawStart%2C%20drawCount%2C%20object.count%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28geometry.isInstancedBufferGeometry%29%20%7B%0A%20%20%20%20%20%20%20%20const%20maxInstanceCount%20%3D%20geometry._maxInstanceCount%20%21%3D%3D%20void%200%20%3F%20geometry._maxInstanceCount%20%3A%20Infinity%3B%0A%20%20%20%20%20%20%20%20const%20instanceCount%20%3D%20Math.min%28geometry.instanceCount%2C%20maxInstanceCount%29%3B%0A%20%20%20%20%20%20%20%20renderer3.renderInstances%28drawStart%2C%20drawCount%2C%20instanceCount%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20renderer3.render%28drawStart%2C%20drawCount%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20function%20prepareMaterial%28material%2C%20scene3%2C%20object%29%20%7B%0A%20%20%20%20%20%20if%20%28material.transparent%20%3D%3D%3D%20true%20%26%26%20material.side%20%3D%3D%3D%20DoubleSide%20%26%26%20material.forceSinglePass%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20material.side%20%3D%20BackSide%3B%0A%20%20%20%20%20%20%20%20material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20getProgram%28material%2C%20scene3%2C%20object%29%3B%0A%20%20%20%20%20%20%20%20material.side%20%3D%20FrontSide%3B%0A%20%20%20%20%20%20%20%20material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20getProgram%28material%2C%20scene3%2C%20object%29%3B%0A%20%20%20%20%20%20%20%20material.side%20%3D%20DoubleSide%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20getProgram%28material%2C%20scene3%2C%20object%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.compile%20%3D%20function%28scene3%2C%20camera3%2C%20targetScene%20%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28targetScene%20%3D%3D%3D%20null%29%20targetScene%20%3D%20scene3%3B%0A%20%20%20%20%20%20currentRenderState%20%3D%20renderStates.get%28targetScene%29%3B%0A%20%20%20%20%20%20currentRenderState.init%28camera3%29%3B%0A%20%20%20%20%20%20renderStateStack.push%28currentRenderState%29%3B%0A%20%20%20%20%20%20targetScene.traverseVisible%28function%28object%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28object.isLight%20%26%26%20object.layers.test%28camera3.layers%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20currentRenderState.pushLight%28object%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28object.castShadow%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20currentRenderState.pushShadow%28object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20if%20%28scene3%20%21%3D%3D%20targetScene%29%20%7B%0A%20%20%20%20%20%20%20%20scene3.traverseVisible%28function%28object%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28object.isLight%20%26%26%20object.layers.test%28camera3.layers%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20currentRenderState.pushLight%28object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28object.castShadow%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20currentRenderState.pushShadow%28object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20currentRenderState.setupLights%28%29%3B%0A%20%20%20%20%20%20const%20materials2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%29%3B%0A%20%20%20%20%20%20scene3.traverse%28function%28object%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21%28object.isMesh%20%7C%7C%20object.isPoints%20%7C%7C%20object.isLine%20%7C%7C%20object.isSprite%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20material%20%3D%20object.material%3B%0A%20%20%20%20%20%20%20%20if%20%28material%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28Array.isArray%28material%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20material.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20material2%20%3D%20material%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20prepareMaterial%28material2%2C%20targetScene%2C%20object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20materials2.add%28material2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20prepareMaterial%28material%2C%20targetScene%2C%20object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20materials2.add%28material%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20renderStateStack.pop%28%29%3B%0A%20%20%20%20%20%20currentRenderState%20%3D%20null%3B%0A%20%20%20%20%20%20return%20materials2%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.compileAsync%20%3D%20function%28scene3%2C%20camera3%2C%20targetScene%20%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20materials2%20%3D%20this.compile%28scene3%2C%20camera3%2C%20targetScene%29%3B%0A%20%20%20%20%20%20return%20new%20Promise%28%28resolve%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20function%20checkMaterialsReady%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20materials2.forEach%28function%28material%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20materialProperties%20%3D%20properties.get%28material%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20program%20%3D%20materialProperties.currentProgram%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28program.isReady%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20materials2.delete%28material%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28materials2.size%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20resolve%28scene3%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20setTimeout%28checkMaterialsReady%2C%2010%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28extensions.get%28%22KHR_parallel_shader_compile%22%29%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20checkMaterialsReady%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20setTimeout%28checkMaterialsReady%2C%2010%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20let%20onAnimationFrameCallback%20%3D%20null%3B%0A%20%20%20%20function%20onAnimationFrame%28time%29%20%7B%0A%20%20%20%20%20%20if%20%28onAnimationFrameCallback%29%20onAnimationFrameCallback%28time%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20onXRSessionStart%28%29%20%7B%0A%20%20%20%20%20%20animation.stop%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20onXRSessionEnd%28%29%20%7B%0A%20%20%20%20%20%20animation.start%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20animation%20%3D%20new%20WebGLAnimation%28%29%3B%0A%20%20%20%20animation.setAnimationLoop%28onAnimationFrame%29%3B%0A%20%20%20%20if%20%28typeof%20self%20%21%3D%3D%20%22undefined%22%29%20animation.setContext%28self%29%3B%0A%20%20%20%20this.setAnimationLoop%20%3D%20function%28callback%29%20%7B%0A%20%20%20%20%20%20onAnimationFrameCallback%20%3D%20callback%3B%0A%20%20%20%20%20%20xr.setAnimationLoop%28callback%29%3B%0A%20%20%20%20%20%20callback%20%3D%3D%3D%20null%20%3F%20animation.stop%28%29%20%3A%20animation.start%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20xr.addEventListener%28%22sessionstart%22%2C%20onXRSessionStart%29%3B%0A%20%20%20%20xr.addEventListener%28%22sessionend%22%2C%20onXRSessionEnd%29%3B%0A%20%20%20%20this.render%20%3D%20function%28scene3%2C%20camera3%29%20%7B%0A%20%20%20%20%20%20if%20%28camera3%20%21%3D%3D%20void%200%20%26%26%20camera3.isCamera%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLRenderer.render%3A%20camera%20is%20not%20an%20instance%20of%20THREE.Camera.%22%29%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28_isContextLost%20%3D%3D%3D%20true%29%20return%3B%0A%20%20%20%20%20%20if%20%28scene3.matrixWorldAutoUpdate%20%3D%3D%3D%20true%29%20scene3.updateMatrixWorld%28%29%3B%0A%20%20%20%20%20%20if%20%28camera3.parent%20%3D%3D%3D%20null%20%26%26%20camera3.matrixWorldAutoUpdate%20%3D%3D%3D%20true%29%20camera3.updateMatrixWorld%28%29%3B%0A%20%20%20%20%20%20if%20%28xr.enabled%20%3D%3D%3D%20true%20%26%26%20xr.isPresenting%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28xr.cameraAutoUpdate%20%3D%3D%3D%20true%29%20xr.updateCamera%28camera3%29%3B%0A%20%20%20%20%20%20%20%20camera3%20%3D%20xr.getCamera%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28scene3.isScene%20%3D%3D%3D%20true%29%20scene3.onBeforeRender%28_this%2C%20scene3%2C%20camera3%2C%20_currentRenderTarget%29%3B%0A%20%20%20%20%20%20currentRenderState%20%3D%20renderStates.get%28scene3%2C%20renderStateStack.length%29%3B%0A%20%20%20%20%20%20currentRenderState.init%28camera3%29%3B%0A%20%20%20%20%20%20renderStateStack.push%28currentRenderState%29%3B%0A%20%20%20%20%20%20_projScreenMatrix2.multiplyMatrices%28camera3.projectionMatrix%2C%20camera3.matrixWorldInverse%29%3B%0A%20%20%20%20%20%20_frustum2.setFromProjectionMatrix%28_projScreenMatrix2%29%3B%0A%20%20%20%20%20%20_localClippingEnabled%20%3D%20this.localClippingEnabled%3B%0A%20%20%20%20%20%20_clippingEnabled%20%3D%20clipping2.init%28this.clippingPlanes%2C%20_localClippingEnabled%29%3B%0A%20%20%20%20%20%20currentRenderList%20%3D%20renderLists.get%28scene3%2C%20renderListStack.length%29%3B%0A%20%20%20%20%20%20currentRenderList.init%28%29%3B%0A%20%20%20%20%20%20renderListStack.push%28currentRenderList%29%3B%0A%20%20%20%20%20%20if%20%28xr.enabled%20%3D%3D%3D%20true%20%26%26%20xr.isPresenting%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20const%20depthSensingMesh%20%3D%20_this.xr.getDepthSensingMesh%28%29%3B%0A%20%20%20%20%20%20%20%20if%20%28depthSensingMesh%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20projectObject%28depthSensingMesh%2C%20camera3%2C%20-Infinity%2C%20_this.sortObjects%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20projectObject%28scene3%2C%20camera3%2C%200%2C%20_this.sortObjects%29%3B%0A%20%20%20%20%20%20currentRenderList.finish%28%29%3B%0A%20%20%20%20%20%20if%20%28_this.sortObjects%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20currentRenderList.sort%28_opaqueSort%2C%20_transparentSort%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_renderBackground%20%3D%20xr.enabled%20%3D%3D%3D%20false%20%7C%7C%20xr.isPresenting%20%3D%3D%3D%20false%20%7C%7C%20xr.hasDepthSensing%28%29%20%3D%3D%3D%20false%3B%0A%20%20%20%20%20%20if%20%28_renderBackground%29%20%7B%0A%20%20%20%20%20%20%20%20background.addToRenderList%28currentRenderList%2C%20scene3%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.info.render.frame%2B%2B%3B%0A%20%20%20%20%20%20if%20%28_clippingEnabled%20%3D%3D%3D%20true%29%20clipping2.beginShadows%28%29%3B%0A%20%20%20%20%20%20const%20shadowsArray%20%3D%20currentRenderState.state.shadowsArray%3B%0A%20%20%20%20%20%20shadowMap.render%28shadowsArray%2C%20scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20if%20%28_clippingEnabled%20%3D%3D%3D%20true%29%20clipping2.endShadows%28%29%3B%0A%20%20%20%20%20%20if%20%28this.info.autoReset%20%3D%3D%3D%20true%29%20this.info.reset%28%29%3B%0A%20%20%20%20%20%20const%20opaqueObjects%20%3D%20currentRenderList.opaque%3B%0A%20%20%20%20%20%20const%20transmissiveObjects%20%3D%20currentRenderList.transmissive%3B%0A%20%20%20%20%20%20currentRenderState.setupLights%28%29%3B%0A%20%20%20%20%20%20if%20%28camera3.isArrayCamera%29%20%7B%0A%20%20%20%20%20%20%20%20const%20cameras%20%3D%20camera3.cameras%3B%0A%20%20%20%20%20%20%20%20if%20%28transmissiveObjects.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20cameras.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20camera22%20%3D%20cameras%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderTransmissionPass%28opaqueObjects%2C%20transmissiveObjects%2C%20scene3%2C%20camera22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28_renderBackground%29%20background.render%28scene3%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20cameras.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20camera22%20%3D%20cameras%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20renderScene%28currentRenderList%2C%20scene3%2C%20camera22%2C%20camera22.viewport%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28transmissiveObjects.length%20%3E%200%29%20renderTransmissionPass%28opaqueObjects%2C%20transmissiveObjects%2C%20scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20%20%20if%20%28_renderBackground%29%20background.render%28scene3%29%3B%0A%20%20%20%20%20%20%20%20renderScene%28currentRenderList%2C%20scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28_currentRenderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20textures.updateMultisampleRenderTarget%28_currentRenderTarget%29%3B%0A%20%20%20%20%20%20%20%20textures.updateRenderTargetMipmap%28_currentRenderTarget%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28scene3.isScene%20%3D%3D%3D%20true%29%20scene3.onAfterRender%28_this%2C%20scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20bindingStates.resetDefaultState%28%29%3B%0A%20%20%20%20%20%20_currentMaterialId%20%3D%20-1%3B%0A%20%20%20%20%20%20_currentCamera%20%3D%20null%3B%0A%20%20%20%20%20%20renderStateStack.pop%28%29%3B%0A%20%20%20%20%20%20if%20%28renderStateStack.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20currentRenderState%20%3D%20renderStateStack%5BrenderStateStack.length%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28_clippingEnabled%20%3D%3D%3D%20true%29%20clipping2.setGlobalState%28_this.clippingPlanes%2C%20currentRenderState.state.camera%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20currentRenderState%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20renderListStack.pop%28%29%3B%0A%20%20%20%20%20%20if%20%28renderListStack.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20currentRenderList%20%3D%20renderListStack%5BrenderListStack.length%20-%201%5D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20currentRenderList%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20function%20projectObject%28object%2C%20camera3%2C%20groupOrder%2C%20sortObjects%29%20%7B%0A%20%20%20%20%20%20if%20%28object.visible%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20const%20visible%20%3D%20object.layers.test%28camera3.layers%29%3B%0A%20%20%20%20%20%20if%20%28visible%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28object.isGroup%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20groupOrder%20%3D%20object.renderOrder%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isLOD%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28object.autoUpdate%20%3D%3D%3D%20true%29%20object.update%28camera3%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isLight%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20currentRenderState.pushLight%28object%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28object.castShadow%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20currentRenderState.pushShadow%28object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isSprite%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21object.frustumCulled%20%7C%7C%20_frustum2.intersectsSprite%28object%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28sortObjects%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_vector42.setFromMatrixPosition%28object.matrixWorld%29.applyMatrix4%28_projScreenMatrix2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20geometry%20%3D%20objects.update%28object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20material%20%3D%20object.material%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28material.visible%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20currentRenderList.push%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20_vector42.z%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isMesh%20%7C%7C%20object.isLine%20%7C%7C%20object.isPoints%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21object.frustumCulled%20%7C%7C%20_frustum2.intersectsObject%28object%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20geometry%20%3D%20objects.update%28object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20material%20%3D%20object.material%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28sortObjects%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28object.boundingSphere%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28object.boundingSphere%20%3D%3D%3D%20null%29%20object.computeBoundingSphere%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_vector42.copy%28object.boundingSphere.center%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28geometry.boundingSphere%20%3D%3D%3D%20null%29%20geometry.computeBoundingSphere%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_vector42.copy%28geometry.boundingSphere.center%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_vector42.applyMatrix4%28object.matrixWorld%29.applyMatrix4%28_projScreenMatrix2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28Array.isArray%28material%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20groups%20%3D%20geometry.groups%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20groups.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20groupMaterial%20%3D%20material%5Bgroup.materialIndex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28groupMaterial%20%26%26%20groupMaterial.visible%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20currentRenderList.push%28object%2C%20geometry%2C%20groupMaterial%2C%20groupOrder%2C%20_vector42.z%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28material.visible%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20currentRenderList.push%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20_vector42.z%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20children%20%3D%20object.children%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20projectObject%28children%5Bi%5D%2C%20camera3%2C%20groupOrder%2C%20sortObjects%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20renderScene%28currentRenderList2%2C%20scene3%2C%20camera3%2C%20viewport2%29%20%7B%0A%20%20%20%20%20%20const%20opaqueObjects%20%3D%20currentRenderList2.opaque%3B%0A%20%20%20%20%20%20const%20transmissiveObjects%20%3D%20currentRenderList2.transmissive%3B%0A%20%20%20%20%20%20const%20transparentObjects%20%3D%20currentRenderList2.transparent%3B%0A%20%20%20%20%20%20currentRenderState.setupLightsView%28camera3%29%3B%0A%20%20%20%20%20%20if%20%28_clippingEnabled%20%3D%3D%3D%20true%29%20clipping2.setGlobalState%28_this.clippingPlanes%2C%20camera3%29%3B%0A%20%20%20%20%20%20if%20%28viewport2%29%20state.viewport%28_currentViewport.copy%28viewport2%29%29%3B%0A%20%20%20%20%20%20if%20%28opaqueObjects.length%20%3E%200%29%20renderObjects%28opaqueObjects%2C%20scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20if%20%28transmissiveObjects.length%20%3E%200%29%20renderObjects%28transmissiveObjects%2C%20scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20if%20%28transparentObjects.length%20%3E%200%29%20renderObjects%28transparentObjects%2C%20scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20state.buffers.depth.setTest%28true%29%3B%0A%20%20%20%20%20%20state.buffers.depth.setMask%28true%29%3B%0A%20%20%20%20%20%20state.buffers.color.setMask%28true%29%3B%0A%20%20%20%20%20%20state.setPolygonOffset%28false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20renderTransmissionPass%28opaqueObjects%2C%20transmissiveObjects%2C%20scene3%2C%20camera3%29%20%7B%0A%20%20%20%20%20%20const%20overrideMaterial%20%3D%20scene3.isScene%20%3D%3D%3D%20true%20%3F%20scene3.overrideMaterial%20%3A%20null%3B%0A%20%20%20%20%20%20if%20%28overrideMaterial%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28currentRenderState.state.transmissionRenderTarget%5Bcamera3.id%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20currentRenderState.state.transmissionRenderTarget%5Bcamera3.id%5D%20%3D%20new%20WebGLRenderTarget%281%2C%201%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20generateMipmaps%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20type%3A%20extensions.has%28%22EXT_color_buffer_half_float%22%29%20%7C%7C%20extensions.has%28%22EXT_color_buffer_float%22%29%20%3F%20HalfFloatType%20%3A%20UnsignedByteType%2C%0A%20%20%20%20%20%20%20%20%20%20minFilter%3A%20LinearMipmapLinearFilter%2C%0A%20%20%20%20%20%20%20%20%20%20samples%3A%204%2C%0A%20%20%20%20%20%20%20%20%20%20stencilBuffer%3A%20stencil%2C%0A%20%20%20%20%20%20%20%20%20%20resolveDepthBuffer%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20resolveStencilBuffer%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20colorSpace%3A%20ColorManagement.workingColorSpace%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20transmissionRenderTarget%20%3D%20currentRenderState.state.transmissionRenderTarget%5Bcamera3.id%5D%3B%0A%20%20%20%20%20%20const%20activeViewport%20%3D%20camera3.viewport%20%7C%7C%20_currentViewport%3B%0A%20%20%20%20%20%20transmissionRenderTarget.setSize%28activeViewport.z%2C%20activeViewport.w%29%3B%0A%20%20%20%20%20%20const%20currentRenderTarget%20%3D%20_this.getRenderTarget%28%29%3B%0A%20%20%20%20%20%20_this.setRenderTarget%28transmissionRenderTarget%29%3B%0A%20%20%20%20%20%20_this.getClearColor%28_currentClearColor%29%3B%0A%20%20%20%20%20%20_currentClearAlpha%20%3D%20_this.getClearAlpha%28%29%3B%0A%20%20%20%20%20%20if%20%28_currentClearAlpha%20%3C%201%29%20_this.setClearColor%2816777215%2C%200.5%29%3B%0A%20%20%20%20%20%20_this.clear%28%29%3B%0A%20%20%20%20%20%20if%20%28_renderBackground%29%20background.render%28scene3%29%3B%0A%20%20%20%20%20%20const%20currentToneMapping%20%3D%20_this.toneMapping%3B%0A%20%20%20%20%20%20_this.toneMapping%20%3D%20NoToneMapping%3B%0A%20%20%20%20%20%20const%20currentCameraViewport%20%3D%20camera3.viewport%3B%0A%20%20%20%20%20%20if%20%28camera3.viewport%20%21%3D%3D%20void%200%29%20camera3.viewport%20%3D%20void%200%3B%0A%20%20%20%20%20%20currentRenderState.setupLightsView%28camera3%29%3B%0A%20%20%20%20%20%20if%20%28_clippingEnabled%20%3D%3D%3D%20true%29%20clipping2.setGlobalState%28_this.clippingPlanes%2C%20camera3%29%3B%0A%20%20%20%20%20%20renderObjects%28opaqueObjects%2C%20scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20textures.updateMultisampleRenderTarget%28transmissionRenderTarget%29%3B%0A%20%20%20%20%20%20textures.updateRenderTargetMipmap%28transmissionRenderTarget%29%3B%0A%20%20%20%20%20%20if%20%28extensions.has%28%22WEBGL_multisampled_render_to_texture%22%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20let%20renderTargetNeedsUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20transmissiveObjects.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20renderItem%20%3D%20transmissiveObjects%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20object%20%3D%20renderItem.object%3B%0A%20%20%20%20%20%20%20%20%20%20const%20geometry%20%3D%20renderItem.geometry%3B%0A%20%20%20%20%20%20%20%20%20%20const%20material%20%3D%20renderItem.material%3B%0A%20%20%20%20%20%20%20%20%20%20const%20group%20%3D%20renderItem.group%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28material.side%20%3D%3D%3D%20DoubleSide%20%26%26%20object.layers.test%28camera3.layers%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20currentSide%20%3D%20material.side%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20material.side%20%3D%20BackSide%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderObject%28object%2C%20scene3%2C%20camera3%2C%20geometry%2C%20material%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20material.side%20%3D%20currentSide%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderTargetNeedsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28renderTargetNeedsUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20textures.updateMultisampleRenderTarget%28transmissionRenderTarget%29%3B%0A%20%20%20%20%20%20%20%20%20%20textures.updateRenderTargetMipmap%28transmissionRenderTarget%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_this.setRenderTarget%28currentRenderTarget%29%3B%0A%20%20%20%20%20%20_this.setClearColor%28_currentClearColor%2C%20_currentClearAlpha%29%3B%0A%20%20%20%20%20%20if%20%28currentCameraViewport%20%21%3D%3D%20void%200%29%20camera3.viewport%20%3D%20currentCameraViewport%3B%0A%20%20%20%20%20%20_this.toneMapping%20%3D%20currentToneMapping%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20renderObjects%28renderList%2C%20scene3%2C%20camera3%29%20%7B%0A%20%20%20%20%20%20const%20overrideMaterial%20%3D%20scene3.isScene%20%3D%3D%3D%20true%20%3F%20scene3.overrideMaterial%20%3A%20null%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20renderList.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20renderItem%20%3D%20renderList%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20object%20%3D%20renderItem.object%3B%0A%20%20%20%20%20%20%20%20const%20geometry%20%3D%20renderItem.geometry%3B%0A%20%20%20%20%20%20%20%20const%20material%20%3D%20overrideMaterial%20%3D%3D%3D%20null%20%3F%20renderItem.material%20%3A%20overrideMaterial%3B%0A%20%20%20%20%20%20%20%20const%20group%20%3D%20renderItem.group%3B%0A%20%20%20%20%20%20%20%20if%20%28object.layers.test%28camera3.layers%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderObject%28object%2C%20scene3%2C%20camera3%2C%20geometry%2C%20material%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20renderObject%28object%2C%20scene3%2C%20camera3%2C%20geometry%2C%20material%2C%20group%29%20%7B%0A%20%20%20%20%20%20object.onBeforeRender%28_this%2C%20scene3%2C%20camera3%2C%20geometry%2C%20material%2C%20group%29%3B%0A%20%20%20%20%20%20object.modelViewMatrix.multiplyMatrices%28camera3.matrixWorldInverse%2C%20object.matrixWorld%29%3B%0A%20%20%20%20%20%20object.normalMatrix.getNormalMatrix%28object.modelViewMatrix%29%3B%0A%20%20%20%20%20%20material.onBeforeRender%28_this%2C%20scene3%2C%20camera3%2C%20geometry%2C%20object%2C%20group%29%3B%0A%20%20%20%20%20%20if%20%28material.transparent%20%3D%3D%3D%20true%20%26%26%20material.side%20%3D%3D%3D%20DoubleSide%20%26%26%20material.forceSinglePass%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20material.side%20%3D%20BackSide%3B%0A%20%20%20%20%20%20%20%20material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20_this.renderBufferDirect%28camera3%2C%20scene3%2C%20geometry%2C%20material%2C%20object%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20material.side%20%3D%20FrontSide%3B%0A%20%20%20%20%20%20%20%20material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20_this.renderBufferDirect%28camera3%2C%20scene3%2C%20geometry%2C%20material%2C%20object%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20material.side%20%3D%20DoubleSide%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_this.renderBufferDirect%28camera3%2C%20scene3%2C%20geometry%2C%20material%2C%20object%2C%20group%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20object.onAfterRender%28_this%2C%20scene3%2C%20camera3%2C%20geometry%2C%20material%2C%20group%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20getProgram%28material%2C%20scene3%2C%20object%29%20%7B%0A%20%20%20%20%20%20if%20%28scene3.isScene%20%21%3D%3D%20true%29%20scene3%20%3D%20_emptyScene%3B%0A%20%20%20%20%20%20const%20materialProperties%20%3D%20properties.get%28material%29%3B%0A%20%20%20%20%20%20const%20lights%20%3D%20currentRenderState.state.lights%3B%0A%20%20%20%20%20%20const%20shadowsArray%20%3D%20currentRenderState.state.shadowsArray%3B%0A%20%20%20%20%20%20const%20lightsStateVersion%20%3D%20lights.state.version%3B%0A%20%20%20%20%20%20const%20parameters2%20%3D%20programCache.getParameters%28material%2C%20lights.state%2C%20shadowsArray%2C%20scene3%2C%20object%29%3B%0A%20%20%20%20%20%20const%20programCacheKey%20%3D%20programCache.getProgramCacheKey%28parameters2%29%3B%0A%20%20%20%20%20%20let%20programs%20%3D%20materialProperties.programs%3B%0A%20%20%20%20%20%20materialProperties.environment%20%3D%20material.isMeshStandardMaterial%20%3F%20scene3.environment%20%3A%20null%3B%0A%20%20%20%20%20%20materialProperties.fog%20%3D%20scene3.fog%3B%0A%20%20%20%20%20%20materialProperties.envMap%20%3D%20%28material.isMeshStandardMaterial%20%3F%20cubeuvmaps%20%3A%20cubemaps%29.get%28material.envMap%20%7C%7C%20materialProperties.environment%29%3B%0A%20%20%20%20%20%20materialProperties.envMapRotation%20%3D%20materialProperties.environment%20%21%3D%3D%20null%20%26%26%20material.envMap%20%3D%3D%3D%20null%20%3F%20scene3.environmentRotation%20%3A%20material.envMapRotation%3B%0A%20%20%20%20%20%20if%20%28programs%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20material.addEventListener%28%22dispose%22%2C%20onMaterialDispose%29%3B%0A%20%20%20%20%20%20%20%20programs%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20%20%20%20%20materialProperties.programs%20%3D%20programs%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20program%20%3D%20programs.get%28programCacheKey%29%3B%0A%20%20%20%20%20%20if%20%28program%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28materialProperties.currentProgram%20%3D%3D%3D%20program%20%26%26%20materialProperties.lightsStateVersion%20%3D%3D%3D%20lightsStateVersion%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20updateCommonMaterialProperties%28material%2C%20parameters2%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20program%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20parameters2.uniforms%20%3D%20programCache.getUniforms%28material%29%3B%0A%20%20%20%20%20%20%20%20material.onBeforeCompile%28parameters2%2C%20_this%29%3B%0A%20%20%20%20%20%20%20%20program%20%3D%20programCache.acquireProgram%28parameters2%2C%20programCacheKey%29%3B%0A%20%20%20%20%20%20%20%20programs.set%28programCacheKey%2C%20program%29%3B%0A%20%20%20%20%20%20%20%20materialProperties.uniforms%20%3D%20parameters2.uniforms%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20uniforms%20%3D%20materialProperties.uniforms%3B%0A%20%20%20%20%20%20if%20%28%21material.isShaderMaterial%20%26%26%20%21material.isRawShaderMaterial%20%7C%7C%20material.clipping%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.clippingPlanes%20%3D%20clipping2.uniform%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20updateCommonMaterialProperties%28material%2C%20parameters2%29%3B%0A%20%20%20%20%20%20materialProperties.needsLights%20%3D%20materialNeedsLights%28material%29%3B%0A%20%20%20%20%20%20materialProperties.lightsStateVersion%20%3D%20lightsStateVersion%3B%0A%20%20%20%20%20%20if%20%28materialProperties.needsLights%29%20%7B%0A%20%20%20%20%20%20%20%20uniforms.ambientLightColor.value%20%3D%20lights.state.ambient%3B%0A%20%20%20%20%20%20%20%20uniforms.lightProbe.value%20%3D%20lights.state.probe%3B%0A%20%20%20%20%20%20%20%20uniforms.directionalLights.value%20%3D%20lights.state.directional%3B%0A%20%20%20%20%20%20%20%20uniforms.directionalLightShadows.value%20%3D%20lights.state.directionalShadow%3B%0A%20%20%20%20%20%20%20%20uniforms.spotLights.value%20%3D%20lights.state.spot%3B%0A%20%20%20%20%20%20%20%20uniforms.spotLightShadows.value%20%3D%20lights.state.spotShadow%3B%0A%20%20%20%20%20%20%20%20uniforms.rectAreaLights.value%20%3D%20lights.state.rectArea%3B%0A%20%20%20%20%20%20%20%20uniforms.ltc_1.value%20%3D%20lights.state.rectAreaLTC1%3B%0A%20%20%20%20%20%20%20%20uniforms.ltc_2.value%20%3D%20lights.state.rectAreaLTC2%3B%0A%20%20%20%20%20%20%20%20uniforms.pointLights.value%20%3D%20lights.state.point%3B%0A%20%20%20%20%20%20%20%20uniforms.pointLightShadows.value%20%3D%20lights.state.pointShadow%3B%0A%20%20%20%20%20%20%20%20uniforms.hemisphereLights.value%20%3D%20lights.state.hemi%3B%0A%20%20%20%20%20%20%20%20uniforms.directionalShadowMap.value%20%3D%20lights.state.directionalShadowMap%3B%0A%20%20%20%20%20%20%20%20uniforms.directionalShadowMatrix.value%20%3D%20lights.state.directionalShadowMatrix%3B%0A%20%20%20%20%20%20%20%20uniforms.spotShadowMap.value%20%3D%20lights.state.spotShadowMap%3B%0A%20%20%20%20%20%20%20%20uniforms.spotLightMatrix.value%20%3D%20lights.state.spotLightMatrix%3B%0A%20%20%20%20%20%20%20%20uniforms.spotLightMap.value%20%3D%20lights.state.spotLightMap%3B%0A%20%20%20%20%20%20%20%20uniforms.pointShadowMap.value%20%3D%20lights.state.pointShadowMap%3B%0A%20%20%20%20%20%20%20%20uniforms.pointShadowMatrix.value%20%3D%20lights.state.pointShadowMatrix%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20materialProperties.currentProgram%20%3D%20program%3B%0A%20%20%20%20%20%20materialProperties.uniformsList%20%3D%20null%3B%0A%20%20%20%20%20%20return%20program%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20getUniformList%28materialProperties%29%20%7B%0A%20%20%20%20%20%20if%20%28materialProperties.uniformsList%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20const%20progUniforms%20%3D%20materialProperties.currentProgram.getUniforms%28%29%3B%0A%20%20%20%20%20%20%20%20materialProperties.uniformsList%20%3D%20WebGLUniforms.seqWithValue%28progUniforms.seq%2C%20materialProperties.uniforms%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20materialProperties.uniformsList%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20updateCommonMaterialProperties%28material%2C%20parameters2%29%20%7B%0A%20%20%20%20%20%20const%20materialProperties%20%3D%20properties.get%28material%29%3B%0A%20%20%20%20%20%20materialProperties.outputColorSpace%20%3D%20parameters2.outputColorSpace%3B%0A%20%20%20%20%20%20materialProperties.batching%20%3D%20parameters2.batching%3B%0A%20%20%20%20%20%20materialProperties.batchingColor%20%3D%20parameters2.batchingColor%3B%0A%20%20%20%20%20%20materialProperties.instancing%20%3D%20parameters2.instancing%3B%0A%20%20%20%20%20%20materialProperties.instancingColor%20%3D%20parameters2.instancingColor%3B%0A%20%20%20%20%20%20materialProperties.instancingMorph%20%3D%20parameters2.instancingMorph%3B%0A%20%20%20%20%20%20materialProperties.skinning%20%3D%20parameters2.skinning%3B%0A%20%20%20%20%20%20materialProperties.morphTargets%20%3D%20parameters2.morphTargets%3B%0A%20%20%20%20%20%20materialProperties.morphNormals%20%3D%20parameters2.morphNormals%3B%0A%20%20%20%20%20%20materialProperties.morphColors%20%3D%20parameters2.morphColors%3B%0A%20%20%20%20%20%20materialProperties.morphTargetsCount%20%3D%20parameters2.morphTargetsCount%3B%0A%20%20%20%20%20%20materialProperties.numClippingPlanes%20%3D%20parameters2.numClippingPlanes%3B%0A%20%20%20%20%20%20materialProperties.numIntersection%20%3D%20parameters2.numClipIntersection%3B%0A%20%20%20%20%20%20materialProperties.vertexAlphas%20%3D%20parameters2.vertexAlphas%3B%0A%20%20%20%20%20%20materialProperties.vertexTangents%20%3D%20parameters2.vertexTangents%3B%0A%20%20%20%20%20%20materialProperties.toneMapping%20%3D%20parameters2.toneMapping%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20setProgram%28camera3%2C%20scene3%2C%20geometry%2C%20material%2C%20object%29%20%7B%0A%20%20%20%20%20%20if%20%28scene3.isScene%20%21%3D%3D%20true%29%20scene3%20%3D%20_emptyScene%3B%0A%20%20%20%20%20%20textures.resetTextureUnits%28%29%3B%0A%20%20%20%20%20%20const%20fog%20%3D%20scene3.fog%3B%0A%20%20%20%20%20%20const%20environment%20%3D%20material.isMeshStandardMaterial%20%3F%20scene3.environment%20%3A%20null%3B%0A%20%20%20%20%20%20const%20colorSpace%20%3D%20_currentRenderTarget%20%3D%3D%3D%20null%20%3F%20_this.outputColorSpace%20%3A%20_currentRenderTarget.isXRRenderTarget%20%3D%3D%3D%20true%20%3F%20_currentRenderTarget.texture.colorSpace%20%3A%20LinearSRGBColorSpace%3B%0A%20%20%20%20%20%20const%20envMap%20%3D%20%28material.isMeshStandardMaterial%20%3F%20cubeuvmaps%20%3A%20cubemaps%29.get%28material.envMap%20%7C%7C%20environment%29%3B%0A%20%20%20%20%20%20const%20vertexAlphas%20%3D%20material.vertexColors%20%3D%3D%3D%20true%20%26%26%20%21%21geometry.attributes.color%20%26%26%20geometry.attributes.color.itemSize%20%3D%3D%3D%204%3B%0A%20%20%20%20%20%20const%20vertexTangents%20%3D%20%21%21geometry.attributes.tangent%20%26%26%20%28%21%21material.normalMap%20%7C%7C%20material.anisotropy%20%3E%200%29%3B%0A%20%20%20%20%20%20const%20morphTargets%20%3D%20%21%21geometry.morphAttributes.position%3B%0A%20%20%20%20%20%20const%20morphNormals%20%3D%20%21%21geometry.morphAttributes.normal%3B%0A%20%20%20%20%20%20const%20morphColors%20%3D%20%21%21geometry.morphAttributes.color%3B%0A%20%20%20%20%20%20let%20toneMapping2%20%3D%20NoToneMapping%3B%0A%20%20%20%20%20%20if%20%28material.toneMapped%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28_currentRenderTarget%20%3D%3D%3D%20null%20%7C%7C%20_currentRenderTarget.isXRRenderTarget%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20toneMapping2%20%3D%20_this.toneMapping%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20morphAttribute%20%3D%20geometry.morphAttributes.position%20%7C%7C%20geometry.morphAttributes.normal%20%7C%7C%20geometry.morphAttributes.color%3B%0A%20%20%20%20%20%20const%20morphTargetsCount%20%3D%20morphAttribute%20%21%3D%3D%20void%200%20%3F%20morphAttribute.length%20%3A%200%3B%0A%20%20%20%20%20%20const%20materialProperties%20%3D%20properties.get%28material%29%3B%0A%20%20%20%20%20%20const%20lights%20%3D%20currentRenderState.state.lights%3B%0A%20%20%20%20%20%20if%20%28_clippingEnabled%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28_localClippingEnabled%20%3D%3D%3D%20true%20%7C%7C%20camera3%20%21%3D%3D%20_currentCamera%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20useCache%20%3D%20camera3%20%3D%3D%3D%20_currentCamera%20%26%26%20material.id%20%3D%3D%3D%20_currentMaterialId%3B%0A%20%20%20%20%20%20%20%20%20%20clipping2.setState%28material%2C%20camera3%2C%20useCache%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20needsProgramChange%20%3D%20false%3B%0A%20%20%20%20%20%20if%20%28material.version%20%3D%3D%3D%20materialProperties.__version%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28materialProperties.needsLights%20%26%26%20materialProperties.lightsStateVersion%20%21%3D%3D%20lights.state.version%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.outputColorSpace%20%21%3D%3D%20colorSpace%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isBatchedMesh%20%26%26%20materialProperties.batching%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28%21object.isBatchedMesh%20%26%26%20materialProperties.batching%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isBatchedMesh%20%26%26%20materialProperties.batchingColor%20%3D%3D%3D%20true%20%26%26%20object.colorTexture%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isBatchedMesh%20%26%26%20materialProperties.batchingColor%20%3D%3D%3D%20false%20%26%26%20object.colorTexture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isInstancedMesh%20%26%26%20materialProperties.instancing%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28%21object.isInstancedMesh%20%26%26%20materialProperties.instancing%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isSkinnedMesh%20%26%26%20materialProperties.skinning%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28%21object.isSkinnedMesh%20%26%26%20materialProperties.skinning%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isInstancedMesh%20%26%26%20materialProperties.instancingColor%20%3D%3D%3D%20true%20%26%26%20object.instanceColor%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isInstancedMesh%20%26%26%20materialProperties.instancingColor%20%3D%3D%3D%20false%20%26%26%20object.instanceColor%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isInstancedMesh%20%26%26%20materialProperties.instancingMorph%20%3D%3D%3D%20true%20%26%26%20object.morphTexture%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28object.isInstancedMesh%20%26%26%20materialProperties.instancingMorph%20%3D%3D%3D%20false%20%26%26%20object.morphTexture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.envMap%20%21%3D%3D%20envMap%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28material.fog%20%3D%3D%3D%20true%20%26%26%20materialProperties.fog%20%21%3D%3D%20fog%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.numClippingPlanes%20%21%3D%3D%20void%200%20%26%26%20%28materialProperties.numClippingPlanes%20%21%3D%3D%20clipping2.numPlanes%20%7C%7C%20materialProperties.numIntersection%20%21%3D%3D%20clipping2.numIntersection%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.vertexAlphas%20%21%3D%3D%20vertexAlphas%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.vertexTangents%20%21%3D%3D%20vertexTangents%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.morphTargets%20%21%3D%3D%20morphTargets%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.morphNormals%20%21%3D%3D%20morphNormals%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.morphColors%20%21%3D%3D%20morphColors%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.toneMapping%20%21%3D%3D%20toneMapping2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialProperties.morphTargetsCount%20%21%3D%3D%20morphTargetsCount%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20needsProgramChange%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20materialProperties.__version%20%3D%20material.version%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20program%20%3D%20materialProperties.currentProgram%3B%0A%20%20%20%20%20%20if%20%28needsProgramChange%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20program%20%3D%20getProgram%28material%2C%20scene3%2C%20object%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20refreshProgram%20%3D%20false%3B%0A%20%20%20%20%20%20let%20refreshMaterial%20%3D%20false%3B%0A%20%20%20%20%20%20let%20refreshLights%20%3D%20false%3B%0A%20%20%20%20%20%20const%20p_uniforms%20%3D%20program.getUniforms%28%29%2C%20m_uniforms%20%3D%20materialProperties.uniforms%3B%0A%20%20%20%20%20%20if%20%28state.useProgram%28program.program%29%29%20%7B%0A%20%20%20%20%20%20%20%20refreshProgram%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20refreshMaterial%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20refreshLights%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28material.id%20%21%3D%3D%20_currentMaterialId%29%20%7B%0A%20%20%20%20%20%20%20%20_currentMaterialId%20%3D%20material.id%3B%0A%20%20%20%20%20%20%20%20refreshMaterial%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28refreshProgram%20%7C%7C%20_currentCamera%20%21%3D%3D%20camera3%29%20%7B%0A%20%20%20%20%20%20%20%20const%20reverseDepthBuffer2%20%3D%20state.buffers.depth.getReversed%28%29%3B%0A%20%20%20%20%20%20%20%20if%20%28reverseDepthBuffer2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_currentProjectionMatrix.copy%28camera3.projectionMatrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20toNormalizedProjectionMatrix%28_currentProjectionMatrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20toReversedProjectionMatrix%28_currentProjectionMatrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22projectionMatrix%22%2C%20_currentProjectionMatrix%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22projectionMatrix%22%2C%20camera3.projectionMatrix%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22viewMatrix%22%2C%20camera3.matrixWorldInverse%29%3B%0A%20%20%20%20%20%20%20%20const%20uCamPos%20%3D%20p_uniforms.map.cameraPosition%3B%0A%20%20%20%20%20%20%20%20if%20%28uCamPos%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20uCamPos.setValue%28_gl%2C%20_vector3.setFromMatrixPosition%28camera3.matrixWorld%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28capabilities.logarithmicDepthBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20p_uniforms.setValue%28%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22logDepthBufFC%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%202%20%2F%20%28Math.log%28camera3.far%20%2B%201%29%20%2F%20Math.LN2%29%0A%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28material.isMeshPhongMaterial%20%7C%7C%20material.isMeshToonMaterial%20%7C%7C%20material.isMeshLambertMaterial%20%7C%7C%20material.isMeshBasicMaterial%20%7C%7C%20material.isMeshStandardMaterial%20%7C%7C%20material.isShaderMaterial%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22isOrthographic%22%2C%20camera3.isOrthographicCamera%20%3D%3D%3D%20true%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28_currentCamera%20%21%3D%3D%20camera3%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_currentCamera%20%3D%20camera3%3B%0A%20%20%20%20%20%20%20%20%20%20refreshMaterial%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20refreshLights%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28object.isSkinnedMesh%29%20%7B%0A%20%20%20%20%20%20%20%20p_uniforms.setOptional%28_gl%2C%20object%2C%20%22bindMatrix%22%29%3B%0A%20%20%20%20%20%20%20%20p_uniforms.setOptional%28_gl%2C%20object%2C%20%22bindMatrixInverse%22%29%3B%0A%20%20%20%20%20%20%20%20const%20skeleton%20%3D%20object.skeleton%3B%0A%20%20%20%20%20%20%20%20if%20%28skeleton%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28skeleton.boneTexture%20%3D%3D%3D%20null%29%20skeleton.computeBoneTexture%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22boneTexture%22%2C%20skeleton.boneTexture%2C%20textures%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28object.isBatchedMesh%29%20%7B%0A%20%20%20%20%20%20%20%20p_uniforms.setOptional%28_gl%2C%20object%2C%20%22batchingTexture%22%29%3B%0A%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22batchingTexture%22%2C%20object._matricesTexture%2C%20textures%29%3B%0A%20%20%20%20%20%20%20%20p_uniforms.setOptional%28_gl%2C%20object%2C%20%22batchingIdTexture%22%29%3B%0A%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22batchingIdTexture%22%2C%20object._indirectTexture%2C%20textures%29%3B%0A%20%20%20%20%20%20%20%20p_uniforms.setOptional%28_gl%2C%20object%2C%20%22batchingColorTexture%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28object._colorsTexture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22batchingColorTexture%22%2C%20object._colorsTexture%2C%20textures%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20morphAttributes%20%3D%20geometry.morphAttributes%3B%0A%20%20%20%20%20%20if%20%28morphAttributes.position%20%21%3D%3D%20void%200%20%7C%7C%20morphAttributes.normal%20%21%3D%3D%20void%200%20%7C%7C%20morphAttributes.color%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20morphtargets.update%28object%2C%20geometry%2C%20program%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28refreshMaterial%20%7C%7C%20materialProperties.receiveShadow%20%21%3D%3D%20object.receiveShadow%29%20%7B%0A%20%20%20%20%20%20%20%20materialProperties.receiveShadow%20%3D%20object.receiveShadow%3B%0A%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22receiveShadow%22%2C%20object.receiveShadow%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28material.isMeshGouraudMaterial%20%26%26%20material.envMap%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20m_uniforms.envMap.value%20%3D%20envMap%3B%0A%20%20%20%20%20%20%20%20m_uniforms.flipEnvMap.value%20%3D%20envMap.isCubeTexture%20%26%26%20envMap.isRenderTargetTexture%20%3D%3D%3D%20false%20%3F%20-1%20%3A%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28material.isMeshStandardMaterial%20%26%26%20material.envMap%20%3D%3D%3D%20null%20%26%26%20scene3.environment%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20m_uniforms.envMapIntensity.value%20%3D%20scene3.environmentIntensity%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28refreshMaterial%29%20%7B%0A%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22toneMappingExposure%22%2C%20_this.toneMappingExposure%29%3B%0A%20%20%20%20%20%20%20%20if%20%28materialProperties.needsLights%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20markUniformsLightsNeedsUpdate%28m_uniforms%2C%20refreshLights%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28fog%20%26%26%20material.fog%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20materials.refreshFogUniforms%28m_uniforms%2C%20fog%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20materials.refreshMaterialUniforms%28m_uniforms%2C%20material%2C%20_pixelRatio%2C%20_height%2C%20currentRenderState.state.transmissionRenderTarget%5Bcamera3.id%5D%29%3B%0A%20%20%20%20%20%20%20%20WebGLUniforms.upload%28_gl%2C%20getUniformList%28materialProperties%29%2C%20m_uniforms%2C%20textures%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28material.isShaderMaterial%20%26%26%20material.uniformsNeedUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20WebGLUniforms.upload%28_gl%2C%20getUniformList%28materialProperties%29%2C%20m_uniforms%2C%20textures%29%3B%0A%20%20%20%20%20%20%20%20material.uniformsNeedUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28material.isSpriteMaterial%29%20%7B%0A%20%20%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22center%22%2C%20object.center%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22modelViewMatrix%22%2C%20object.modelViewMatrix%29%3B%0A%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22normalMatrix%22%2C%20object.normalMatrix%29%3B%0A%20%20%20%20%20%20p_uniforms.setValue%28_gl%2C%20%22modelMatrix%22%2C%20object.matrixWorld%29%3B%0A%20%20%20%20%20%20if%20%28material.isShaderMaterial%20%7C%7C%20material.isRawShaderMaterial%29%20%7B%0A%20%20%20%20%20%20%20%20const%20groups%20%3D%20material.uniformsGroups%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20groups.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20uniformsGroups.update%28group%2C%20program%29%3B%0A%20%20%20%20%20%20%20%20%20%20uniformsGroups.bind%28group%2C%20program%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20program%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20markUniformsLightsNeedsUpdate%28uniforms%2C%20value%29%20%7B%0A%20%20%20%20%20%20uniforms.ambientLightColor.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%20%20uniforms.lightProbe.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%20%20uniforms.directionalLights.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%20%20uniforms.directionalLightShadows.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%20%20uniforms.pointLights.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%20%20uniforms.pointLightShadows.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%20%20uniforms.spotLights.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%20%20uniforms.spotLightShadows.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%20%20uniforms.rectAreaLights.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%20%20uniforms.hemisphereLights.needsUpdate%20%3D%20value%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20materialNeedsLights%28material%29%20%7B%0A%20%20%20%20%20%20return%20material.isMeshLambertMaterial%20%7C%7C%20material.isMeshToonMaterial%20%7C%7C%20material.isMeshPhongMaterial%20%7C%7C%20material.isMeshStandardMaterial%20%7C%7C%20material.isShadowMaterial%20%7C%7C%20material.isShaderMaterial%20%26%26%20material.lights%20%3D%3D%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.getActiveCubeFace%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20_currentActiveCubeFace%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getActiveMipmapLevel%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20_currentActiveMipmapLevel%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getRenderTarget%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20_currentRenderTarget%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setRenderTargetTextures%20%3D%20function%28renderTarget%2C%20colorTexture%2C%20depthTexture%29%20%7B%0A%20%20%20%20%20%20properties.get%28renderTarget.texture%29.__webglTexture%20%3D%20colorTexture%3B%0A%20%20%20%20%20%20properties.get%28renderTarget.depthTexture%29.__webglTexture%20%3D%20depthTexture%3B%0A%20%20%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20%20%20renderTargetProperties.__hasExternalTextures%20%3D%20true%3B%0A%20%20%20%20%20%20renderTargetProperties.__autoAllocateDepthBuffer%20%3D%20depthTexture%20%3D%3D%3D%20void%200%3B%0A%20%20%20%20%20%20if%20%28%21renderTargetProperties.__autoAllocateDepthBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28extensions.has%28%22WEBGL_multisampled_render_to_texture%22%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Render-to-texture%20extension%20was%20disabled%20because%20an%20external%20texture%20was%20provided%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderTargetProperties.__useRenderToTexture%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setRenderTargetFramebuffer%20%3D%20function%28renderTarget%2C%20defaultFramebuffer%29%20%7B%0A%20%20%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20%20%20renderTargetProperties.__webglFramebuffer%20%3D%20defaultFramebuffer%3B%0A%20%20%20%20%20%20renderTargetProperties.__useDefaultFramebuffer%20%3D%20defaultFramebuffer%20%3D%3D%3D%20void%200%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setRenderTarget%20%3D%20function%28renderTarget%2C%20activeCubeFace%20%3D%200%2C%20activeMipmapLevel%20%3D%200%29%20%7B%0A%20%20%20%20%20%20_currentRenderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20%20%20_currentActiveCubeFace%20%3D%20activeCubeFace%3B%0A%20%20%20%20%20%20_currentActiveMipmapLevel%20%3D%20activeMipmapLevel%3B%0A%20%20%20%20%20%20let%20useDefaultFramebuffer%20%3D%20true%3B%0A%20%20%20%20%20%20let%20framebuffer%20%3D%20null%3B%0A%20%20%20%20%20%20let%20isCube%20%3D%20false%3B%0A%20%20%20%20%20%20let%20isRenderTarget3D%20%3D%20false%3B%0A%20%20%20%20%20%20if%20%28renderTarget%29%20%7B%0A%20%20%20%20%20%20%20%20const%20renderTargetProperties%20%3D%20properties.get%28renderTarget%29%3B%0A%20%20%20%20%20%20%20%20if%20%28renderTargetProperties.__useDefaultFramebuffer%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20useDefaultFramebuffer%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28renderTargetProperties.__webglFramebuffer%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20textures.setupRenderTarget%28renderTarget%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28renderTargetProperties.__hasExternalTextures%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20textures.rebindTextures%28renderTarget%2C%20properties.get%28renderTarget.texture%29.__webglTexture%2C%20properties.get%28renderTarget.depthTexture%29.__webglTexture%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28renderTarget.depthBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20depthTexture%20%3D%20renderTarget.depthTexture%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28renderTargetProperties.__boundDepthTexture%20%21%3D%3D%20depthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28depthTexture%20%21%3D%3D%20null%20%26%26%20properties.has%28depthTexture%29%20%26%26%20%28renderTarget.width%20%21%3D%3D%20depthTexture.image.width%20%7C%7C%20renderTarget.height%20%21%3D%3D%20depthTexture.image.height%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22WebGLRenderTarget%3A%20Attached%20DepthTexture%20is%20initialized%20to%20the%20incorrect%20size.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20textures.setupDepthRenderbuffer%28renderTarget%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20texture2%20%3D%20renderTarget.texture%3B%0A%20%20%20%20%20%20%20%20if%20%28texture2.isData3DTexture%20%7C%7C%20texture2.isDataArrayTexture%20%7C%7C%20texture2.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20isRenderTarget3D%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20__webglFramebuffer%20%3D%20properties.get%28renderTarget%29.__webglFramebuffer%3B%0A%20%20%20%20%20%20%20%20if%20%28renderTarget.isWebGLCubeRenderTarget%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28Array.isArray%28__webglFramebuffer%5BactiveCubeFace%5D%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20framebuffer%20%3D%20__webglFramebuffer%5BactiveCubeFace%5D%5BactiveMipmapLevel%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20framebuffer%20%3D%20__webglFramebuffer%5BactiveCubeFace%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20isCube%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28renderTarget.samples%20%3E%200%20%26%26%20textures.useMultisampledRTT%28renderTarget%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20framebuffer%20%3D%20properties.get%28renderTarget%29.__webglMultisampledFramebuffer%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28Array.isArray%28__webglFramebuffer%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20framebuffer%20%3D%20__webglFramebuffer%5BactiveMipmapLevel%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20framebuffer%20%3D%20__webglFramebuffer%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20_currentViewport.copy%28renderTarget.viewport%29%3B%0A%20%20%20%20%20%20%20%20_currentScissor.copy%28renderTarget.scissor%29%3B%0A%20%20%20%20%20%20%20%20_currentScissorTest%20%3D%20renderTarget.scissorTest%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_currentViewport.copy%28_viewport%29.multiplyScalar%28_pixelRatio%29.floor%28%29%3B%0A%20%20%20%20%20%20%20%20_currentScissor.copy%28_scissor%29.multiplyScalar%28_pixelRatio%29.floor%28%29%3B%0A%20%20%20%20%20%20%20%20_currentScissorTest%20%3D%20_scissorTest%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20framebufferBound%20%3D%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20framebuffer%29%3B%0A%20%20%20%20%20%20if%20%28framebufferBound%20%26%26%20useDefaultFramebuffer%29%20%7B%0A%20%20%20%20%20%20%20%20state.drawBuffers%28renderTarget%2C%20framebuffer%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.viewport%28_currentViewport%29%3B%0A%20%20%20%20%20%20state.scissor%28_currentScissor%29%3B%0A%20%20%20%20%20%20state.setScissorTest%28_currentScissorTest%29%3B%0A%20%20%20%20%20%20if%20%28isCube%29%20%7B%0A%20%20%20%20%20%20%20%20const%20textureProperties%20%3D%20properties.get%28renderTarget.texture%29%3B%0A%20%20%20%20%20%20%20%20_gl.framebufferTexture2D%28_gl.FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%2C%20_gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20activeCubeFace%2C%20textureProperties.__webglTexture%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28isRenderTarget3D%29%20%7B%0A%20%20%20%20%20%20%20%20const%20textureProperties%20%3D%20properties.get%28renderTarget.texture%29%3B%0A%20%20%20%20%20%20%20%20const%20layer%20%3D%20activeCubeFace%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20_gl.framebufferTextureLayer%28_gl.FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%2C%20textureProperties.__webglTexture%2C%20activeMipmapLevel%20%7C%7C%200%2C%20layer%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_currentMaterialId%20%3D%20-1%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.readRenderTargetPixels%20%3D%20function%28renderTarget%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20buffer2%2C%20activeCubeFaceIndex%29%20%7B%0A%20%20%20%20%20%20if%20%28%21%28renderTarget%20%26%26%20renderTarget.isWebGLRenderTarget%29%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLRenderer.readRenderTargetPixels%3A%20renderTarget%20is%20not%20THREE.WebGLRenderTarget.%22%29%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20framebuffer%20%3D%20properties.get%28renderTarget%29.__webglFramebuffer%3B%0A%20%20%20%20%20%20if%20%28renderTarget.isWebGLCubeRenderTarget%20%26%26%20activeCubeFaceIndex%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20framebuffer%20%3D%20framebuffer%5BactiveCubeFaceIndex%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28framebuffer%29%20%7B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20framebuffer%29%3B%0A%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20texture2%20%3D%20renderTarget.texture%3B%0A%20%20%20%20%20%20%20%20%20%20const%20textureFormat%20%3D%20texture2.format%3B%0A%20%20%20%20%20%20%20%20%20%20const%20textureType%20%3D%20texture2.type%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21capabilities.textureFormatReadable%28textureFormat%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLRenderer.readRenderTargetPixels%3A%20renderTarget%20is%20not%20in%20RGBA%20or%20implementation%20defined%20format.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21capabilities.textureTypeReadable%28textureType%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLRenderer.readRenderTargetPixels%3A%20renderTarget%20is%20not%20in%20UnsignedByteType%20or%20implementation%20defined%20type.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28x2%20%3E%3D%200%20%26%26%20x2%20%3C%3D%20renderTarget.width%20-%20width%20%26%26%20%28y2%20%3E%3D%200%20%26%26%20y2%20%3C%3D%20renderTarget.height%20-%20height%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.readPixels%28x2%2C%20y2%2C%20width%2C%20height%2C%20utils.convert%28textureFormat%29%2C%20utils.convert%28textureType%29%2C%20buffer2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20framebuffer2%20%3D%20_currentRenderTarget%20%21%3D%3D%20null%20%3F%20properties.get%28_currentRenderTarget%29.__webglFramebuffer%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20framebuffer2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.readRenderTargetPixelsAsync%20%3D%20async%20function%28renderTarget%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20buffer2%2C%20activeCubeFaceIndex%29%20%7B%0A%20%20%20%20%20%20if%20%28%21%28renderTarget%20%26%26%20renderTarget.isWebGLRenderTarget%29%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGLRenderer.readRenderTargetPixels%3A%20renderTarget%20is%20not%20THREE.WebGLRenderTarget.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20framebuffer%20%3D%20properties.get%28renderTarget%29.__webglFramebuffer%3B%0A%20%20%20%20%20%20if%20%28renderTarget.isWebGLCubeRenderTarget%20%26%26%20activeCubeFaceIndex%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20framebuffer%20%3D%20framebuffer%5BactiveCubeFaceIndex%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28framebuffer%29%20%7B%0A%20%20%20%20%20%20%20%20const%20texture2%20%3D%20renderTarget.texture%3B%0A%20%20%20%20%20%20%20%20const%20textureFormat%20%3D%20texture2.format%3B%0A%20%20%20%20%20%20%20%20const%20textureType%20%3D%20texture2.type%3B%0A%20%20%20%20%20%20%20%20if%20%28%21capabilities.textureFormatReadable%28textureFormat%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGLRenderer.readRenderTargetPixelsAsync%3A%20renderTarget%20is%20not%20in%20RGBA%20or%20implementation%20defined%20format.%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%21capabilities.textureTypeReadable%28textureType%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGLRenderer.readRenderTargetPixelsAsync%3A%20renderTarget%20is%20not%20in%20UnsignedByteType%20or%20implementation%20defined%20type.%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28x2%20%3E%3D%200%20%26%26%20x2%20%3C%3D%20renderTarget.width%20-%20width%20%26%26%20%28y2%20%3E%3D%200%20%26%26%20y2%20%3C%3D%20renderTarget.height%20-%20height%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20framebuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20glBuffer%20%3D%20_gl.createBuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.bindBuffer%28_gl.PIXEL_PACK_BUFFER%2C%20glBuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.bufferData%28_gl.PIXEL_PACK_BUFFER%2C%20buffer2.byteLength%2C%20_gl.STREAM_READ%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.readPixels%28x2%2C%20y2%2C%20width%2C%20height%2C%20utils.convert%28textureFormat%29%2C%20utils.convert%28textureType%29%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20currFramebuffer%20%3D%20_currentRenderTarget%20%21%3D%3D%20null%20%3F%20properties.get%28_currentRenderTarget%29.__webglFramebuffer%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.FRAMEBUFFER%2C%20currFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20sync%20%3D%20_gl.fenceSync%28_gl.SYNC_GPU_COMMANDS_COMPLETE%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.flush%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20await%20probeAsync%28_gl%2C%20sync%2C%204%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.bindBuffer%28_gl.PIXEL_PACK_BUFFER%2C%20glBuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.getBufferSubData%28_gl.PIXEL_PACK_BUFFER%2C%200%2C%20buffer2%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.deleteBuffer%28glBuffer%29%3B%0A%20%20%20%20%20%20%20%20%20%20_gl.deleteSync%28sync%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20buffer2%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGLRenderer.readRenderTargetPixelsAsync%3A%20requested%20read%20bounds%20are%20out%20of%20range.%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.copyFramebufferToTexture%20%3D%20function%28texture2%2C%20position%20%3D%20null%2C%20level%20%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28texture2.isTexture%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20warnOnce%28%22WebGLRenderer%3A%20copyFramebufferToTexture%20function%20signature%20has%20changed.%22%29%3B%0A%20%20%20%20%20%20%20%20position%20%3D%20arguments%5B0%5D%20%7C%7C%20null%3B%0A%20%20%20%20%20%20%20%20texture2%20%3D%20arguments%5B1%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20levelScale%20%3D%20Math.pow%282%2C%20-level%29%3B%0A%20%20%20%20%20%20const%20width%20%3D%20Math.floor%28texture2.image.width%20%2A%20levelScale%29%3B%0A%20%20%20%20%20%20const%20height%20%3D%20Math.floor%28texture2.image.height%20%2A%20levelScale%29%3B%0A%20%20%20%20%20%20const%20x2%20%3D%20position%20%21%3D%3D%20null%20%3F%20position.x%20%3A%200%3B%0A%20%20%20%20%20%20const%20y2%20%3D%20position%20%21%3D%3D%20null%20%3F%20position.y%20%3A%200%3B%0A%20%20%20%20%20%20textures.setTexture2D%28texture2%2C%200%29%3B%0A%20%20%20%20%20%20_gl.copyTexSubImage2D%28_gl.TEXTURE_2D%2C%20level%2C%200%2C%200%2C%20x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.copyTextureToTexture%20%3D%20function%28srcTexture%2C%20dstTexture%2C%20srcRegion%20%3D%20null%2C%20dstPosition%20%3D%20null%2C%20level%20%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28srcTexture.isTexture%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20warnOnce%28%22WebGLRenderer%3A%20copyTextureToTexture%20function%20signature%20has%20changed.%22%29%3B%0A%20%20%20%20%20%20%20%20dstPosition%20%3D%20arguments%5B0%5D%20%7C%7C%20null%3B%0A%20%20%20%20%20%20%20%20srcTexture%20%3D%20arguments%5B1%5D%3B%0A%20%20%20%20%20%20%20%20dstTexture%20%3D%20arguments%5B2%5D%3B%0A%20%20%20%20%20%20%20%20level%20%3D%20arguments%5B3%5D%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20srcRegion%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20width%2C%20height%2C%20depth3%2C%20minX%2C%20minY%2C%20minZ%3B%0A%20%20%20%20%20%20let%20dstX%2C%20dstY%2C%20dstZ%3B%0A%20%20%20%20%20%20const%20image%20%3D%20srcTexture.isCompressedTexture%20%3F%20srcTexture.mipmaps%5Blevel%5D%20%3A%20srcTexture.image%3B%0A%20%20%20%20%20%20if%20%28srcRegion%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20width%20%3D%20srcRegion.max.x%20-%20srcRegion.min.x%3B%0A%20%20%20%20%20%20%20%20height%20%3D%20srcRegion.max.y%20-%20srcRegion.min.y%3B%0A%20%20%20%20%20%20%20%20depth3%20%3D%20srcRegion.isBox3%20%3F%20srcRegion.max.z%20-%20srcRegion.min.z%20%3A%201%3B%0A%20%20%20%20%20%20%20%20minX%20%3D%20srcRegion.min.x%3B%0A%20%20%20%20%20%20%20%20minY%20%3D%20srcRegion.min.y%3B%0A%20%20%20%20%20%20%20%20minZ%20%3D%20srcRegion.isBox3%20%3F%20srcRegion.min.z%20%3A%200%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20width%20%3D%20image.width%3B%0A%20%20%20%20%20%20%20%20height%20%3D%20image.height%3B%0A%20%20%20%20%20%20%20%20depth3%20%3D%20image.depth%20%7C%7C%201%3B%0A%20%20%20%20%20%20%20%20minX%20%3D%200%3B%0A%20%20%20%20%20%20%20%20minY%20%3D%200%3B%0A%20%20%20%20%20%20%20%20minZ%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28dstPosition%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20dstX%20%3D%20dstPosition.x%3B%0A%20%20%20%20%20%20%20%20dstY%20%3D%20dstPosition.y%3B%0A%20%20%20%20%20%20%20%20dstZ%20%3D%20dstPosition.z%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20dstX%20%3D%200%3B%0A%20%20%20%20%20%20%20%20dstY%20%3D%200%3B%0A%20%20%20%20%20%20%20%20dstZ%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20glFormat%20%3D%20utils.convert%28dstTexture.format%29%3B%0A%20%20%20%20%20%20const%20glType%20%3D%20utils.convert%28dstTexture.type%29%3B%0A%20%20%20%20%20%20let%20glTarget%3B%0A%20%20%20%20%20%20if%20%28dstTexture.isData3DTexture%29%20%7B%0A%20%20%20%20%20%20%20%20textures.setTexture3D%28dstTexture%2C%200%29%3B%0A%20%20%20%20%20%20%20%20glTarget%20%3D%20_gl.TEXTURE_3D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28dstTexture.isDataArrayTexture%20%7C%7C%20dstTexture.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20%20%20textures.setTexture2DArray%28dstTexture%2C%200%29%3B%0A%20%20%20%20%20%20%20%20glTarget%20%3D%20_gl.TEXTURE_2D_ARRAY%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20textures.setTexture2D%28dstTexture%2C%200%29%3B%0A%20%20%20%20%20%20%20%20glTarget%20%3D%20_gl.TEXTURE_2D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_FLIP_Y_WEBGL%2C%20dstTexture.flipY%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL%2C%20dstTexture.premultiplyAlpha%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_ALIGNMENT%2C%20dstTexture.unpackAlignment%29%3B%0A%20%20%20%20%20%20const%20currentUnpackRowLen%20%3D%20_gl.getParameter%28_gl.UNPACK_ROW_LENGTH%29%3B%0A%20%20%20%20%20%20const%20currentUnpackImageHeight%20%3D%20_gl.getParameter%28_gl.UNPACK_IMAGE_HEIGHT%29%3B%0A%20%20%20%20%20%20const%20currentUnpackSkipPixels%20%3D%20_gl.getParameter%28_gl.UNPACK_SKIP_PIXELS%29%3B%0A%20%20%20%20%20%20const%20currentUnpackSkipRows%20%3D%20_gl.getParameter%28_gl.UNPACK_SKIP_ROWS%29%3B%0A%20%20%20%20%20%20const%20currentUnpackSkipImages%20%3D%20_gl.getParameter%28_gl.UNPACK_SKIP_IMAGES%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_ROW_LENGTH%2C%20image.width%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_IMAGE_HEIGHT%2C%20image.height%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_SKIP_PIXELS%2C%20minX%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_SKIP_ROWS%2C%20minY%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_SKIP_IMAGES%2C%20minZ%29%3B%0A%20%20%20%20%20%20const%20isSrc3D%20%3D%20srcTexture.isDataArrayTexture%20%7C%7C%20srcTexture.isData3DTexture%3B%0A%20%20%20%20%20%20const%20isDst3D%20%3D%20dstTexture.isDataArrayTexture%20%7C%7C%20dstTexture.isData3DTexture%3B%0A%20%20%20%20%20%20if%20%28srcTexture.isRenderTargetTexture%20%7C%7C%20srcTexture.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20const%20srcTextureProperties%20%3D%20properties.get%28srcTexture%29%3B%0A%20%20%20%20%20%20%20%20const%20dstTextureProperties%20%3D%20properties.get%28dstTexture%29%3B%0A%20%20%20%20%20%20%20%20const%20srcRenderTargetProperties%20%3D%20properties.get%28srcTextureProperties.__renderTarget%29%3B%0A%20%20%20%20%20%20%20%20const%20dstRenderTargetProperties%20%3D%20properties.get%28dstTextureProperties.__renderTarget%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.READ_FRAMEBUFFER%2C%20srcRenderTargetProperties.__webglFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.DRAW_FRAMEBUFFER%2C%20dstRenderTargetProperties.__webglFramebuffer%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20depth3%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28isSrc3D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.framebufferTextureLayer%28_gl.READ_FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%2C%20properties.get%28srcTexture%29.__webglTexture%2C%20level%2C%20minZ%20%2B%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28srcTexture.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28isDst3D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_gl.framebufferTextureLayer%28_gl.DRAW_FRAMEBUFFER%2C%20_gl.COLOR_ATTACHMENT0%2C%20properties.get%28dstTexture%29.__webglTexture%2C%20level%2C%20dstZ%20%2B%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.blitFramebuffer%28minX%2C%20minY%2C%20width%2C%20height%2C%20dstX%2C%20dstY%2C%20width%2C%20height%2C%20_gl.DEPTH_BUFFER_BIT%2C%20_gl.NEAREST%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28isDst3D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.copyTexSubImage3D%28glTarget%2C%20level%2C%20dstX%2C%20dstY%2C%20dstZ%20%2B%20i%2C%20minX%2C%20minY%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.copyTexSubImage2D%28glTarget%2C%20level%2C%20dstX%2C%20dstY%2C%20dstZ%20%2B%20i%2C%20minX%2C%20minY%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.READ_FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28_gl.DRAW_FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28isDst3D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28srcTexture.isDataTexture%20%7C%7C%20srcTexture.isData3DTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.texSubImage3D%28glTarget%2C%20level%2C%20dstX%2C%20dstY%2C%20dstZ%2C%20width%2C%20height%2C%20depth3%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28dstTexture.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.compressedTexSubImage3D%28glTarget%2C%20level%2C%20dstX%2C%20dstY%2C%20dstZ%2C%20width%2C%20height%2C%20depth3%2C%20glFormat%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.texSubImage3D%28glTarget%2C%20level%2C%20dstX%2C%20dstY%2C%20dstZ%2C%20width%2C%20height%2C%20depth3%2C%20glFormat%2C%20glType%2C%20image%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28srcTexture.isDataTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.texSubImage2D%28_gl.TEXTURE_2D%2C%20level%2C%20dstX%2C%20dstY%2C%20width%2C%20height%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28srcTexture.isCompressedTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.compressedTexSubImage2D%28_gl.TEXTURE_2D%2C%20level%2C%20dstX%2C%20dstY%2C%20image.width%2C%20image.height%2C%20glFormat%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_gl.texSubImage2D%28_gl.TEXTURE_2D%2C%20level%2C%20dstX%2C%20dstY%2C%20width%2C%20height%2C%20glFormat%2C%20glType%2C%20image%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_ROW_LENGTH%2C%20currentUnpackRowLen%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_IMAGE_HEIGHT%2C%20currentUnpackImageHeight%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_SKIP_PIXELS%2C%20currentUnpackSkipPixels%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_SKIP_ROWS%2C%20currentUnpackSkipRows%29%3B%0A%20%20%20%20%20%20_gl.pixelStorei%28_gl.UNPACK_SKIP_IMAGES%2C%20currentUnpackSkipImages%29%3B%0A%20%20%20%20%20%20if%20%28level%20%3D%3D%3D%200%20%26%26%20dstTexture.generateMipmaps%29%20%7B%0A%20%20%20%20%20%20%20%20_gl.generateMipmap%28glTarget%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.copyTextureToTexture3D%20%3D%20function%28srcTexture%2C%20dstTexture%2C%20srcRegion%20%3D%20null%2C%20dstPosition%20%3D%20null%2C%20level%20%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28srcTexture.isTexture%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20warnOnce%28%22WebGLRenderer%3A%20copyTextureToTexture3D%20function%20signature%20has%20changed.%22%29%3B%0A%20%20%20%20%20%20%20%20srcRegion%20%3D%20arguments%5B0%5D%20%7C%7C%20null%3B%0A%20%20%20%20%20%20%20%20dstPosition%20%3D%20arguments%5B1%5D%20%7C%7C%20null%3B%0A%20%20%20%20%20%20%20%20srcTexture%20%3D%20arguments%5B2%5D%3B%0A%20%20%20%20%20%20%20%20dstTexture%20%3D%20arguments%5B3%5D%3B%0A%20%20%20%20%20%20%20%20level%20%3D%20arguments%5B4%5D%20%7C%7C%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20warnOnce%28%27WebGLRenderer%3A%20copyTextureToTexture3D%20function%20has%20been%20deprecated.%20Use%20%22copyTextureToTexture%22%20instead.%27%29%3B%0A%20%20%20%20%20%20return%20this.copyTextureToTexture%28srcTexture%2C%20dstTexture%2C%20srcRegion%2C%20dstPosition%2C%20level%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.initRenderTarget%20%3D%20function%28target%29%20%7B%0A%20%20%20%20%20%20if%20%28properties.get%28target%29.__webglFramebuffer%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20textures.setupRenderTarget%28target%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.initTexture%20%3D%20function%28texture2%29%20%7B%0A%20%20%20%20%20%20if%20%28texture2.isCubeTexture%29%20%7B%0A%20%20%20%20%20%20%20%20textures.setTextureCube%28texture2%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isData3DTexture%29%20%7B%0A%20%20%20%20%20%20%20%20textures.setTexture3D%28texture2%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isDataArrayTexture%20%7C%7C%20texture2.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20%20%20textures.setTexture2DArray%28texture2%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20textures.setTexture2D%28texture2%2C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.resetState%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20_currentActiveCubeFace%20%3D%200%3B%0A%20%20%20%20%20%20_currentActiveMipmapLevel%20%3D%200%3B%0A%20%20%20%20%20%20_currentRenderTarget%20%3D%20null%3B%0A%20%20%20%20%20%20state.reset%28%29%3B%0A%20%20%20%20%20%20bindingStates.reset%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28typeof%20__THREE_DEVTOOLS__%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20%20%20%20%20__THREE_DEVTOOLS__.dispatchEvent%28new%20CustomEvent%28%22observe%22%2C%20%7B%20detail%3A%20this%20%7D%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20get%20coordinateSystem%28%29%20%7B%0A%20%20%20%20return%20WebGLCoordinateSystem%3B%0A%20%20%7D%0A%20%20get%20outputColorSpace%28%29%20%7B%0A%20%20%20%20return%20this._outputColorSpace%3B%0A%20%20%7D%0A%20%20set%20outputColorSpace%28colorSpace%29%20%7B%0A%20%20%20%20this._outputColorSpace%20%3D%20colorSpace%3B%0A%20%20%20%20const%20gl%20%3D%20this.getContext%28%29%3B%0A%20%20%20%20gl.drawingBufferColorspace%20%3D%20ColorManagement._getDrawingBufferColorSpace%28colorSpace%29%3B%0A%20%20%20%20gl.unpackColorSpace%20%3D%20ColorManagement._getUnpackColorSpace%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Scene%20%3D%20class%20extends%20Object3D%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isScene%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Scene%22%3B%0A%20%20%20%20this.background%20%3D%20null%3B%0A%20%20%20%20this.environment%20%3D%20null%3B%0A%20%20%20%20this.fog%20%3D%20null%3B%0A%20%20%20%20this.backgroundBlurriness%20%3D%200%3B%0A%20%20%20%20this.backgroundIntensity%20%3D%201%3B%0A%20%20%20%20this.backgroundRotation%20%3D%20new%20Euler%28%29%3B%0A%20%20%20%20this.environmentIntensity%20%3D%201%3B%0A%20%20%20%20this.environmentRotation%20%3D%20new%20Euler%28%29%3B%0A%20%20%20%20this.overrideMaterial%20%3D%20null%3B%0A%20%20%20%20if%20%28typeof%20__THREE_DEVTOOLS__%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20%20%20%20%20__THREE_DEVTOOLS__.dispatchEvent%28new%20CustomEvent%28%22observe%22%2C%20%7B%20detail%3A%20this%20%7D%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20if%20%28source.background%20%21%3D%3D%20null%29%20this.background%20%3D%20source.background.clone%28%29%3B%0A%20%20%20%20if%20%28source.environment%20%21%3D%3D%20null%29%20this.environment%20%3D%20source.environment.clone%28%29%3B%0A%20%20%20%20if%20%28source.fog%20%21%3D%3D%20null%29%20this.fog%20%3D%20source.fog.clone%28%29%3B%0A%20%20%20%20this.backgroundBlurriness%20%3D%20source.backgroundBlurriness%3B%0A%20%20%20%20this.backgroundIntensity%20%3D%20source.backgroundIntensity%3B%0A%20%20%20%20this.backgroundRotation.copy%28source.backgroundRotation%29%3B%0A%20%20%20%20this.environmentIntensity%20%3D%20source.environmentIntensity%3B%0A%20%20%20%20this.environmentRotation.copy%28source.environmentRotation%29%3B%0A%20%20%20%20if%20%28source.overrideMaterial%20%21%3D%3D%20null%29%20this.overrideMaterial%20%3D%20source.overrideMaterial.clone%28%29%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20source.matrixAutoUpdate%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20if%20%28this.fog%20%21%3D%3D%20null%29%20data.object.fog%20%3D%20this.fog.toJSON%28%29%3B%0A%20%20%20%20if%20%28this.backgroundBlurriness%20%3E%200%29%20data.object.backgroundBlurriness%20%3D%20this.backgroundBlurriness%3B%0A%20%20%20%20if%20%28this.backgroundIntensity%20%21%3D%3D%201%29%20data.object.backgroundIntensity%20%3D%20this.backgroundIntensity%3B%0A%20%20%20%20data.object.backgroundRotation%20%3D%20this.backgroundRotation.toArray%28%29%3B%0A%20%20%20%20if%20%28this.environmentIntensity%20%21%3D%3D%201%29%20data.object.environmentIntensity%20%3D%20this.environmentIntensity%3B%0A%20%20%20%20data.object.environmentRotation%20%3D%20this.environmentRotation.toArray%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LineBasicMaterial%20%3D%20class%20extends%20Material%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LineBasicMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLineBasicMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color%2816777215%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.linewidth%20%3D%201%3B%0A%20%20%20%20this.linecap%20%3D%20%22round%22%3B%0A%20%20%20%20this.linejoin%20%3D%20%22round%22%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.linewidth%20%3D%20source.linewidth%3B%0A%20%20%20%20this.linecap%20%3D%20source.linecap%3B%0A%20%20%20%20this.linejoin%20%3D%20source.linejoin%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_vStart%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_vEnd%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_inverseMatrix%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Avar%20_ray%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Ray%28%29%3B%0Avar%20_sphere%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Sphere%28%29%3B%0Avar%20_intersectPointOnRay%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_intersectPointOnSegment%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20Line%20%3D%20class%20extends%20Object3D%20%7B%0A%20%20constructor%28geometry%20%3D%20new%20BufferGeometry%28%29%2C%20material%20%3D%20new%20LineBasicMaterial%28%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLine%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Line%22%3B%0A%20%20%20%20this.geometry%20%3D%20geometry%3B%0A%20%20%20%20this.material%20%3D%20material%3B%0A%20%20%20%20this.updateMorphTargets%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.material%20%3D%20Array.isArray%28source.material%29%20%3F%20source.material.slice%28%29%20%3A%20source.material%3B%0A%20%20%20%20this.geometry%20%3D%20source.geometry%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20computeLineDistances%28%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20if%20%28geometry.index%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20positionAttribute%20%3D%20geometry.attributes.position%3B%0A%20%20%20%20%20%20const%20lineDistances%20%3D%20%5B0%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%201%2C%20l%20%3D%20positionAttribute.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20_vStart.fromBufferAttribute%28positionAttribute%2C%20i%20-%201%29%3B%0A%20%20%20%20%20%20%20%20_vEnd.fromBufferAttribute%28positionAttribute%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20lineDistances%5Bi%5D%20%3D%20lineDistances%5Bi%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20lineDistances%5Bi%5D%20%2B%3D%20_vStart.distanceTo%28_vEnd%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20geometry.setAttribute%28%22lineDistance%22%2C%20new%20Float32BufferAttribute%28lineDistances%2C%201%29%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.Line.computeLineDistances%28%29%3A%20Computation%20only%20possible%20with%20non-indexed%20BufferGeometry.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20raycast%28raycaster%2C%20intersects%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20matrixWorld%20%3D%20this.matrixWorld%3B%0A%20%20%20%20const%20threshold%20%3D%20raycaster.params.Line.threshold%3B%0A%20%20%20%20const%20drawRange%20%3D%20geometry.drawRange%3B%0A%20%20%20%20if%20%28geometry.boundingSphere%20%3D%3D%3D%20null%29%20geometry.computeBoundingSphere%28%29%3B%0A%20%20%20%20_sphere%241.copy%28geometry.boundingSphere%29%3B%0A%20%20%20%20_sphere%241.applyMatrix4%28matrixWorld%29%3B%0A%20%20%20%20_sphere%241.radius%20%2B%3D%20threshold%3B%0A%20%20%20%20if%20%28raycaster.ray.intersectsSphere%28_sphere%241%29%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20_inverseMatrix%241.copy%28matrixWorld%29.invert%28%29%3B%0A%20%20%20%20_ray%241.copy%28raycaster.ray%29.applyMatrix4%28_inverseMatrix%241%29%3B%0A%20%20%20%20const%20localThreshold%20%3D%20threshold%20%2F%20%28%28this.scale.x%20%2B%20this.scale.y%20%2B%20this.scale.z%29%20%2F%203%29%3B%0A%20%20%20%20const%20localThresholdSq%20%3D%20localThreshold%20%2A%20localThreshold%3B%0A%20%20%20%20const%20step2%20%3D%20this.isLineSegments%20%3F%202%20%3A%201%3B%0A%20%20%20%20const%20index5%20%3D%20geometry.index%3B%0A%20%20%20%20const%20attributes%20%3D%20geometry.attributes%3B%0A%20%20%20%20const%20positionAttribute%20%3D%20attributes.position%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20start%20%3D%20Math.max%280%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20const%20end%20%3D%20Math.min%28index5.count%2C%20drawRange.start%20%2B%20drawRange.count%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%20start%2C%20l%20%3D%20end%20-%201%3B%20i%20%3C%20l%3B%20i%20%2B%3D%20step2%29%20%7B%0A%20%20%20%20%20%20%20%20const%20a2%20%3D%20index5.getX%28i%29%3B%0A%20%20%20%20%20%20%20%20const%20b%20%3D%20index5.getX%28i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20const%20intersect2%20%3D%20checkIntersection%28this%2C%20raycaster%2C%20_ray%241%2C%20localThresholdSq%2C%20a2%2C%20b%29%3B%0A%20%20%20%20%20%20%20%20if%20%28intersect2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20intersects.push%28intersect2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this.isLineLoop%29%20%7B%0A%20%20%20%20%20%20%20%20const%20a2%20%3D%20index5.getX%28end%20-%201%29%3B%0A%20%20%20%20%20%20%20%20const%20b%20%3D%20index5.getX%28start%29%3B%0A%20%20%20%20%20%20%20%20const%20intersect2%20%3D%20checkIntersection%28this%2C%20raycaster%2C%20_ray%241%2C%20localThresholdSq%2C%20a2%2C%20b%29%3B%0A%20%20%20%20%20%20%20%20if%20%28intersect2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20intersects.push%28intersect2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20start%20%3D%20Math.max%280%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20const%20end%20%3D%20Math.min%28positionAttribute.count%2C%20drawRange.start%20%2B%20drawRange.count%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%20start%2C%20l%20%3D%20end%20-%201%3B%20i%20%3C%20l%3B%20i%20%2B%3D%20step2%29%20%7B%0A%20%20%20%20%20%20%20%20const%20intersect2%20%3D%20checkIntersection%28this%2C%20raycaster%2C%20_ray%241%2C%20localThresholdSq%2C%20i%2C%20i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20if%20%28intersect2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20intersects.push%28intersect2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this.isLineLoop%29%20%7B%0A%20%20%20%20%20%20%20%20const%20intersect2%20%3D%20checkIntersection%28this%2C%20raycaster%2C%20_ray%241%2C%20localThresholdSq%2C%20end%20-%201%2C%20start%29%3B%0A%20%20%20%20%20%20%20%20if%20%28intersect2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20intersects.push%28intersect2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateMorphTargets%28%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20morphAttributes%20%3D%20geometry.morphAttributes%3B%0A%20%20%20%20const%20keys%20%3D%20Object.keys%28morphAttributes%29%3B%0A%20%20%20%20if%20%28keys.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributes%5Bkeys%5B0%5D%5D%3B%0A%20%20%20%20%20%20if%20%28morphAttribute%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this.morphTargetInfluences%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20this.morphTargetDictionary%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20m2%20%3D%200%2C%20ml%20%3D%20morphAttribute.length%3B%20m2%20%3C%20ml%3B%20m2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20name%20%3D%20morphAttribute%5Bm2%5D.name%20%7C%7C%20String%28m2%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.morphTargetInfluences.push%280%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.morphTargetDictionary%5Bname%5D%20%3D%20m2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Afunction%20checkIntersection%28object%2C%20raycaster%2C%20ray%2C%20thresholdSq%2C%20a2%2C%20b%29%20%7B%0A%20%20const%20positionAttribute%20%3D%20object.geometry.attributes.position%3B%0A%20%20_vStart.fromBufferAttribute%28positionAttribute%2C%20a2%29%3B%0A%20%20_vEnd.fromBufferAttribute%28positionAttribute%2C%20b%29%3B%0A%20%20const%20distSq%20%3D%20ray.distanceSqToSegment%28_vStart%2C%20_vEnd%2C%20_intersectPointOnRay%2C%20_intersectPointOnSegment%29%3B%0A%20%20if%20%28distSq%20%3E%20thresholdSq%29%20return%3B%0A%20%20_intersectPointOnRay.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20const%20distance2%20%3D%20raycaster.ray.origin.distanceTo%28_intersectPointOnRay%29%3B%0A%20%20if%20%28distance2%20%3C%20raycaster.near%20%7C%7C%20distance2%20%3E%20raycaster.far%29%20return%3B%0A%20%20return%20%7B%0A%20%20%20%20distance%3A%20distance2%2C%0A%20%20%20%20%2F%2F%20What%20do%20we%20want%3F%20intersection%20point%20on%20the%20ray%20or%20on%20the%20segment%3F%3F%0A%20%20%20%20%2F%2F%20point%3A%20raycaster.ray.at%28%20distance%20%29%2C%0A%20%20%20%20point%3A%20_intersectPointOnSegment.clone%28%29.applyMatrix4%28object.matrixWorld%29%2C%0A%20%20%20%20index%3A%20a2%2C%0A%20%20%20%20face%3A%20null%2C%0A%20%20%20%20faceIndex%3A%20null%2C%0A%20%20%20%20barycoord%3A%20null%2C%0A%20%20%20%20object%0A%20%20%7D%3B%0A%7D%0Avar%20Curve%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.type%20%3D%20%22Curve%22%3B%0A%20%20%20%20this.arcLengthDivisions%20%3D%20200%3B%0A%20%20%7D%0A%20%20%2F%2F%20Virtual%20base%20class%20method%20to%20overwrite%20and%20implement%20in%20subclasses%0A%20%20%2F%2F%09-%20t%20%5B0%20..%201%5D%0A%20%20getPoint%28%29%20%7B%0A%20%20%20%20console.warn%28%22THREE.Curve%3A%20.getPoint%28%29%20not%20implemented.%22%29%3B%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%20%20%2F%2F%20Get%20point%20at%20relative%20position%20in%20curve%20according%20to%20arc%20length%0A%20%20%2F%2F%20-%20u%20%5B0%20..%201%5D%0A%20%20getPointAt%28u%2C%20optionalTarget%29%20%7B%0A%20%20%20%20const%20t%20%3D%20this.getUtoTmapping%28u%29%3B%0A%20%20%20%20return%20this.getPoint%28t%2C%20optionalTarget%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20Get%20sequence%20of%20points%20using%20getPoint%28%20t%20%29%0A%20%20getPoints%28divisions%20%3D%205%29%20%7B%0A%20%20%20%20const%20points%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20d%20%3D%200%3B%20d%20%3C%3D%20divisions%3B%20d%2B%2B%29%20%7B%0A%20%20%20%20%20%20points.push%28this.getPoint%28d%20%2F%20divisions%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20points%3B%0A%20%20%7D%0A%20%20%2F%2F%20Get%20sequence%20of%20points%20using%20getPointAt%28%20u%20%29%0A%20%20getSpacedPoints%28divisions%20%3D%205%29%20%7B%0A%20%20%20%20const%20points%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20d%20%3D%200%3B%20d%20%3C%3D%20divisions%3B%20d%2B%2B%29%20%7B%0A%20%20%20%20%20%20points.push%28this.getPointAt%28d%20%2F%20divisions%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20points%3B%0A%20%20%7D%0A%20%20%2F%2F%20Get%20total%20curve%20arc%20length%0A%20%20getLength%28%29%20%7B%0A%20%20%20%20const%20lengths%20%3D%20this.getLengths%28%29%3B%0A%20%20%20%20return%20lengths%5Blengths.length%20-%201%5D%3B%0A%20%20%7D%0A%20%20%2F%2F%20Get%20list%20of%20cumulative%20segment%20lengths%0A%20%20getLengths%28divisions%20%3D%20this.arcLengthDivisions%29%20%7B%0A%20%20%20%20if%20%28this.cacheArcLengths%20%26%26%20this.cacheArcLengths.length%20%3D%3D%3D%20divisions%20%2B%201%20%26%26%20%21this.needsUpdate%29%20%7B%0A%20%20%20%20%20%20return%20this.cacheArcLengths%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.needsUpdate%20%3D%20false%3B%0A%20%20%20%20const%20cache2%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20current%2C%20last%20%3D%20this.getPoint%280%29%3B%0A%20%20%20%20let%20sum%20%3D%200%3B%0A%20%20%20%20cache2.push%280%29%3B%0A%20%20%20%20for%20%28let%20p%20%3D%201%3B%20p%20%3C%3D%20divisions%3B%20p%2B%2B%29%20%7B%0A%20%20%20%20%20%20current%20%3D%20this.getPoint%28p%20%2F%20divisions%29%3B%0A%20%20%20%20%20%20sum%20%2B%3D%20current.distanceTo%28last%29%3B%0A%20%20%20%20%20%20cache2.push%28sum%29%3B%0A%20%20%20%20%20%20last%20%3D%20current%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.cacheArcLengths%20%3D%20cache2%3B%0A%20%20%20%20return%20cache2%3B%0A%20%20%7D%0A%20%20updateArcLengths%28%29%20%7B%0A%20%20%20%20this.needsUpdate%20%3D%20true%3B%0A%20%20%20%20this.getLengths%28%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20Given%20u%20%28%200%20..%201%20%29%2C%20get%20a%20t%20to%20find%20p.%20This%20gives%20you%20points%20which%20are%20equidistant%0A%20%20getUtoTmapping%28u%2C%20distance2%29%20%7B%0A%20%20%20%20const%20arcLengths%20%3D%20this.getLengths%28%29%3B%0A%20%20%20%20let%20i%20%3D%200%3B%0A%20%20%20%20const%20il%20%3D%20arcLengths.length%3B%0A%20%20%20%20let%20targetArcLength%3B%0A%20%20%20%20if%20%28distance2%29%20%7B%0A%20%20%20%20%20%20targetArcLength%20%3D%20distance2%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20targetArcLength%20%3D%20u%20%2A%20arcLengths%5Bil%20-%201%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20low%20%3D%200%2C%20high%20%3D%20il%20-%201%2C%20comparison%3B%0A%20%20%20%20while%20%28low%20%3C%3D%20high%29%20%7B%0A%20%20%20%20%20%20i%20%3D%20Math.floor%28low%20%2B%20%28high%20-%20low%29%20%2F%202%29%3B%0A%20%20%20%20%20%20comparison%20%3D%20arcLengths%5Bi%5D%20-%20targetArcLength%3B%0A%20%20%20%20%20%20if%20%28comparison%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20low%20%3D%20i%20%2B%201%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28comparison%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20high%20%3D%20i%20-%201%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20high%20%3D%20i%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20i%20%3D%20high%3B%0A%20%20%20%20if%20%28arcLengths%5Bi%5D%20%3D%3D%3D%20targetArcLength%29%20%7B%0A%20%20%20%20%20%20return%20i%20%2F%20%28il%20-%201%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20lengthBefore%20%3D%20arcLengths%5Bi%5D%3B%0A%20%20%20%20const%20lengthAfter%20%3D%20arcLengths%5Bi%20%2B%201%5D%3B%0A%20%20%20%20const%20segmentLength%20%3D%20lengthAfter%20-%20lengthBefore%3B%0A%20%20%20%20const%20segmentFraction%20%3D%20%28targetArcLength%20-%20lengthBefore%29%20%2F%20segmentLength%3B%0A%20%20%20%20const%20t%20%3D%20%28i%20%2B%20segmentFraction%29%20%2F%20%28il%20-%201%29%3B%0A%20%20%20%20return%20t%3B%0A%20%20%7D%0A%20%20%2F%2F%20Returns%20a%20unit%20vector%20tangent%20at%20t%0A%20%20%2F%2F%20In%20case%20any%20sub%20curve%20does%20not%20implement%20its%20tangent%20derivation%2C%0A%20%20%2F%2F%202%20points%20a%20small%20delta%20apart%20will%20be%20used%20to%20find%20its%20gradient%0A%20%20%2F%2F%20which%20seems%20to%20give%20a%20reasonable%20approximation%0A%20%20getTangent%28t%2C%20optionalTarget%29%20%7B%0A%20%20%20%20const%20delta%20%3D%201e-4%3B%0A%20%20%20%20let%20t1%20%3D%20t%20-%20delta%3B%0A%20%20%20%20let%20t2%20%3D%20t%20%2B%20delta%3B%0A%20%20%20%20if%20%28t1%20%3C%200%29%20t1%20%3D%200%3B%0A%20%20%20%20if%20%28t2%20%3E%201%29%20t2%20%3D%201%3B%0A%20%20%20%20const%20pt1%20%3D%20this.getPoint%28t1%29%3B%0A%20%20%20%20const%20pt2%20%3D%20this.getPoint%28t2%29%3B%0A%20%20%20%20const%20tangent%20%3D%20optionalTarget%20%7C%7C%20%28pt1.isVector2%20%3F%20new%20Vector2%28%29%20%3A%20new%20Vector3%28%29%29%3B%0A%20%20%20%20tangent.copy%28pt2%29.sub%28pt1%29.normalize%28%29%3B%0A%20%20%20%20return%20tangent%3B%0A%20%20%7D%0A%20%20getTangentAt%28u%2C%20optionalTarget%29%20%7B%0A%20%20%20%20const%20t%20%3D%20this.getUtoTmapping%28u%29%3B%0A%20%20%20%20return%20this.getTangent%28t%2C%20optionalTarget%29%3B%0A%20%20%7D%0A%20%20computeFrenetFrames%28segments%2C%20closed%29%20%7B%0A%20%20%20%20const%20normal2%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20tangents%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20normals%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20binormals%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vec%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20mat%20%3D%20new%20Matrix4%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%3D%20segments%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20u%20%3D%20i%20%2F%20segments%3B%0A%20%20%20%20%20%20tangents%5Bi%5D%20%3D%20this.getTangentAt%28u%2C%20new%20Vector3%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20normals%5B0%5D%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20binormals%5B0%5D%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20let%20min2%20%3D%20Number.MAX_VALUE%3B%0A%20%20%20%20const%20tx%20%3D%20Math.abs%28tangents%5B0%5D.x%29%3B%0A%20%20%20%20const%20ty%20%3D%20Math.abs%28tangents%5B0%5D.y%29%3B%0A%20%20%20%20const%20tz%20%3D%20Math.abs%28tangents%5B0%5D.z%29%3B%0A%20%20%20%20if%20%28tx%20%3C%3D%20min2%29%20%7B%0A%20%20%20%20%20%20min2%20%3D%20tx%3B%0A%20%20%20%20%20%20normal2.set%281%2C%200%2C%200%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28ty%20%3C%3D%20min2%29%20%7B%0A%20%20%20%20%20%20min2%20%3D%20ty%3B%0A%20%20%20%20%20%20normal2.set%280%2C%201%2C%200%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28tz%20%3C%3D%20min2%29%20%7B%0A%20%20%20%20%20%20normal2.set%280%2C%200%2C%201%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20vec.crossVectors%28tangents%5B0%5D%2C%20normal2%29.normalize%28%29%3B%0A%20%20%20%20normals%5B0%5D.crossVectors%28tangents%5B0%5D%2C%20vec%29%3B%0A%20%20%20%20binormals%5B0%5D.crossVectors%28tangents%5B0%5D%2C%20normals%5B0%5D%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%3D%20segments%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20normals%5Bi%5D%20%3D%20normals%5Bi%20-%201%5D.clone%28%29%3B%0A%20%20%20%20%20%20binormals%5Bi%5D%20%3D%20binormals%5Bi%20-%201%5D.clone%28%29%3B%0A%20%20%20%20%20%20vec.crossVectors%28tangents%5Bi%20-%201%5D%2C%20tangents%5Bi%5D%29%3B%0A%20%20%20%20%20%20if%20%28vec.length%28%29%20%3E%20Number.EPSILON%29%20%7B%0A%20%20%20%20%20%20%20%20vec.normalize%28%29%3B%0A%20%20%20%20%20%20%20%20const%20theta%20%3D%20Math.acos%28clamp%28tangents%5Bi%20-%201%5D.dot%28tangents%5Bi%5D%29%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20normals%5Bi%5D.applyMatrix4%28mat.makeRotationAxis%28vec%2C%20theta%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20binormals%5Bi%5D.crossVectors%28tangents%5Bi%5D%2C%20normals%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28closed%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20let%20theta%20%3D%20Math.acos%28clamp%28normals%5B0%5D.dot%28normals%5Bsegments%5D%29%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20theta%20%2F%3D%20segments%3B%0A%20%20%20%20%20%20if%20%28tangents%5B0%5D.dot%28vec.crossVectors%28normals%5B0%5D%2C%20normals%5Bsegments%5D%29%29%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20theta%20%3D%20-theta%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%3D%20segments%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20normals%5Bi%5D.applyMatrix4%28mat.makeRotationAxis%28tangents%5Bi%5D%2C%20theta%20%2A%20i%29%29%3B%0A%20%20%20%20%20%20%20%20binormals%5Bi%5D.crossVectors%28tangents%5Bi%5D%2C%20normals%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20tangents%2C%0A%20%20%20%20%20%20normals%2C%0A%20%20%20%20%20%20binormals%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.arcLengthDivisions%20%3D%20source.arcLengthDivisions%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20%7B%0A%20%20%20%20%20%20metadata%3A%20%7B%0A%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22Curve%22%2C%0A%20%20%20%20%20%20%20%20generator%3A%20%22Curve.toJSON%22%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20data.arcLengthDivisions%20%3D%20this.arcLengthDivisions%3B%0A%20%20%20%20data.type%20%3D%20this.type%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20this.arcLengthDivisions%20%3D%20json.arcLengthDivisions%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20EllipseCurve%20%3D%20class%20extends%20Curve%20%7B%0A%20%20constructor%28aX%20%3D%200%2C%20aY%20%3D%200%2C%20xRadius%20%3D%201%2C%20yRadius%20%3D%201%2C%20aStartAngle%20%3D%200%2C%20aEndAngle%20%3D%20Math.PI%20%2A%202%2C%20aClockwise%20%3D%20false%2C%20aRotation%20%3D%200%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isEllipseCurve%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22EllipseCurve%22%3B%0A%20%20%20%20this.aX%20%3D%20aX%3B%0A%20%20%20%20this.aY%20%3D%20aY%3B%0A%20%20%20%20this.xRadius%20%3D%20xRadius%3B%0A%20%20%20%20this.yRadius%20%3D%20yRadius%3B%0A%20%20%20%20this.aStartAngle%20%3D%20aStartAngle%3B%0A%20%20%20%20this.aEndAngle%20%3D%20aEndAngle%3B%0A%20%20%20%20this.aClockwise%20%3D%20aClockwise%3B%0A%20%20%20%20this.aRotation%20%3D%20aRotation%3B%0A%20%20%7D%0A%20%20getPoint%28t%2C%20optionalTarget%20%3D%20new%20Vector2%28%29%29%20%7B%0A%20%20%20%20const%20point%20%3D%20optionalTarget%3B%0A%20%20%20%20const%20twoPi%20%3D%20Math.PI%20%2A%202%3B%0A%20%20%20%20let%20deltaAngle%20%3D%20this.aEndAngle%20-%20this.aStartAngle%3B%0A%20%20%20%20const%20samePoints%20%3D%20Math.abs%28deltaAngle%29%20%3C%20Number.EPSILON%3B%0A%20%20%20%20while%20%28deltaAngle%20%3C%200%29%20deltaAngle%20%2B%3D%20twoPi%3B%0A%20%20%20%20while%20%28deltaAngle%20%3E%20twoPi%29%20deltaAngle%20-%3D%20twoPi%3B%0A%20%20%20%20if%20%28deltaAngle%20%3C%20Number.EPSILON%29%20%7B%0A%20%20%20%20%20%20if%20%28samePoints%29%20%7B%0A%20%20%20%20%20%20%20%20deltaAngle%20%3D%200%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20deltaAngle%20%3D%20twoPi%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.aClockwise%20%3D%3D%3D%20true%20%26%26%20%21samePoints%29%20%7B%0A%20%20%20%20%20%20if%20%28deltaAngle%20%3D%3D%3D%20twoPi%29%20%7B%0A%20%20%20%20%20%20%20%20deltaAngle%20%3D%20-twoPi%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20deltaAngle%20%3D%20deltaAngle%20-%20twoPi%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20angle%20%3D%20this.aStartAngle%20%2B%20t%20%2A%20deltaAngle%3B%0A%20%20%20%20let%20x2%20%3D%20this.aX%20%2B%20this.xRadius%20%2A%20Math.cos%28angle%29%3B%0A%20%20%20%20let%20y2%20%3D%20this.aY%20%2B%20this.yRadius%20%2A%20Math.sin%28angle%29%3B%0A%20%20%20%20if%20%28this.aRotation%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20const%20cos2%20%3D%20Math.cos%28this.aRotation%29%3B%0A%20%20%20%20%20%20const%20sin2%20%3D%20Math.sin%28this.aRotation%29%3B%0A%20%20%20%20%20%20const%20tx%20%3D%20x2%20-%20this.aX%3B%0A%20%20%20%20%20%20const%20ty%20%3D%20y2%20-%20this.aY%3B%0A%20%20%20%20%20%20x2%20%3D%20tx%20%2A%20cos2%20-%20ty%20%2A%20sin2%20%2B%20this.aX%3B%0A%20%20%20%20%20%20y2%20%3D%20tx%20%2A%20sin2%20%2B%20ty%20%2A%20cos2%20%2B%20this.aY%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20point.set%28x2%2C%20y2%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.aX%20%3D%20source.aX%3B%0A%20%20%20%20this.aY%20%3D%20source.aY%3B%0A%20%20%20%20this.xRadius%20%3D%20source.xRadius%3B%0A%20%20%20%20this.yRadius%20%3D%20source.yRadius%3B%0A%20%20%20%20this.aStartAngle%20%3D%20source.aStartAngle%3B%0A%20%20%20%20this.aEndAngle%20%3D%20source.aEndAngle%3B%0A%20%20%20%20this.aClockwise%20%3D%20source.aClockwise%3B%0A%20%20%20%20this.aRotation%20%3D%20source.aRotation%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.aX%20%3D%20this.aX%3B%0A%20%20%20%20data.aY%20%3D%20this.aY%3B%0A%20%20%20%20data.xRadius%20%3D%20this.xRadius%3B%0A%20%20%20%20data.yRadius%20%3D%20this.yRadius%3B%0A%20%20%20%20data.aStartAngle%20%3D%20this.aStartAngle%3B%0A%20%20%20%20data.aEndAngle%20%3D%20this.aEndAngle%3B%0A%20%20%20%20data.aClockwise%20%3D%20this.aClockwise%3B%0A%20%20%20%20data.aRotation%20%3D%20this.aRotation%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20super.fromJSON%28json%29%3B%0A%20%20%20%20this.aX%20%3D%20json.aX%3B%0A%20%20%20%20this.aY%20%3D%20json.aY%3B%0A%20%20%20%20this.xRadius%20%3D%20json.xRadius%3B%0A%20%20%20%20this.yRadius%20%3D%20json.yRadius%3B%0A%20%20%20%20this.aStartAngle%20%3D%20json.aStartAngle%3B%0A%20%20%20%20this.aEndAngle%20%3D%20json.aEndAngle%3B%0A%20%20%20%20this.aClockwise%20%3D%20json.aClockwise%3B%0A%20%20%20%20this.aRotation%20%3D%20json.aRotation%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ArcCurve%20%3D%20class%20extends%20EllipseCurve%20%7B%0A%20%20constructor%28aX%2C%20aY%2C%20aRadius%2C%20aStartAngle%2C%20aEndAngle%2C%20aClockwise%29%20%7B%0A%20%20%20%20super%28aX%2C%20aY%2C%20aRadius%2C%20aRadius%2C%20aStartAngle%2C%20aEndAngle%2C%20aClockwise%29%3B%0A%20%20%20%20this.isArcCurve%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22ArcCurve%22%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20CubicPoly%28%29%20%7B%0A%20%20let%20c0%20%3D%200%2C%20c1%20%3D%200%2C%20c2%20%3D%200%2C%20c3%20%3D%200%3B%0A%20%20function%20init4%28x0%2C%20x1%2C%20t0%2C%20t1%29%20%7B%0A%20%20%20%20c0%20%3D%20x0%3B%0A%20%20%20%20c1%20%3D%20t0%3B%0A%20%20%20%20c2%20%3D%20-3%20%2A%20x0%20%2B%203%20%2A%20x1%20-%202%20%2A%20t0%20-%20t1%3B%0A%20%20%20%20c3%20%3D%202%20%2A%20x0%20-%202%20%2A%20x1%20%2B%20t0%20%2B%20t1%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20initCatmullRom%3A%20function%28x0%2C%20x1%2C%20x2%2C%20x3%2C%20tension%29%20%7B%0A%20%20%20%20%20%20init4%28x1%2C%20x2%2C%20tension%20%2A%20%28x2%20-%20x0%29%2C%20tension%20%2A%20%28x3%20-%20x1%29%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20initNonuniformCatmullRom%3A%20function%28x0%2C%20x1%2C%20x2%2C%20x3%2C%20dt0%2C%20dt1%2C%20dt2%29%20%7B%0A%20%20%20%20%20%20let%20t1%20%3D%20%28x1%20-%20x0%29%20%2F%20dt0%20-%20%28x2%20-%20x0%29%20%2F%20%28dt0%20%2B%20dt1%29%20%2B%20%28x2%20-%20x1%29%20%2F%20dt1%3B%0A%20%20%20%20%20%20let%20t2%20%3D%20%28x2%20-%20x1%29%20%2F%20dt1%20-%20%28x3%20-%20x1%29%20%2F%20%28dt1%20%2B%20dt2%29%20%2B%20%28x3%20-%20x2%29%20%2F%20dt2%3B%0A%20%20%20%20%20%20t1%20%2A%3D%20dt1%3B%0A%20%20%20%20%20%20t2%20%2A%3D%20dt1%3B%0A%20%20%20%20%20%20init4%28x1%2C%20x2%2C%20t1%2C%20t2%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20calc%3A%20function%28t%29%20%7B%0A%20%20%20%20%20%20const%20t2%20%3D%20t%20%2A%20t%3B%0A%20%20%20%20%20%20const%20t3%20%3D%20t2%20%2A%20t%3B%0A%20%20%20%20%20%20return%20c0%20%2B%20c1%20%2A%20t%20%2B%20c2%20%2A%20t2%20%2B%20c3%20%2A%20t3%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0Avar%20tmp%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20px%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20CubicPoly%28%29%3B%0Avar%20py%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20CubicPoly%28%29%3B%0Avar%20pz%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20CubicPoly%28%29%3B%0Avar%20CatmullRomCurve3%20%3D%20class%20extends%20Curve%20%7B%0A%20%20constructor%28points%20%3D%20%5B%5D%2C%20closed%20%3D%20false%2C%20curveType%20%3D%20%22centripetal%22%2C%20tension%20%3D%200.5%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isCatmullRomCurve3%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22CatmullRomCurve3%22%3B%0A%20%20%20%20this.points%20%3D%20points%3B%0A%20%20%20%20this.closed%20%3D%20closed%3B%0A%20%20%20%20this.curveType%20%3D%20curveType%3B%0A%20%20%20%20this.tension%20%3D%20tension%3B%0A%20%20%7D%0A%20%20getPoint%28t%2C%20optionalTarget%20%3D%20new%20Vector3%28%29%29%20%7B%0A%20%20%20%20const%20point%20%3D%20optionalTarget%3B%0A%20%20%20%20const%20points%20%3D%20this.points%3B%0A%20%20%20%20const%20l%20%3D%20points.length%3B%0A%20%20%20%20const%20p%20%3D%20%28l%20-%20%28this.closed%20%3F%200%20%3A%201%29%29%20%2A%20t%3B%0A%20%20%20%20let%20intPoint%20%3D%20Math.floor%28p%29%3B%0A%20%20%20%20let%20weight%20%3D%20p%20-%20intPoint%3B%0A%20%20%20%20if%20%28this.closed%29%20%7B%0A%20%20%20%20%20%20intPoint%20%2B%3D%20intPoint%20%3E%200%20%3F%200%20%3A%20%28Math.floor%28Math.abs%28intPoint%29%20%2F%20l%29%20%2B%201%29%20%2A%20l%3B%0A%20%20%20%20%7D%20else%20if%20%28weight%20%3D%3D%3D%200%20%26%26%20intPoint%20%3D%3D%3D%20l%20-%201%29%20%7B%0A%20%20%20%20%20%20intPoint%20%3D%20l%20-%202%3B%0A%20%20%20%20%20%20weight%20%3D%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20p0%2C%20p3%3B%0A%20%20%20%20if%20%28this.closed%20%7C%7C%20intPoint%20%3E%200%29%20%7B%0A%20%20%20%20%20%20p0%20%3D%20points%5B%28intPoint%20-%201%29%20%25%20l%5D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tmp.subVectors%28points%5B0%5D%2C%20points%5B1%5D%29.add%28points%5B0%5D%29%3B%0A%20%20%20%20%20%20p0%20%3D%20tmp%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20p1%20%3D%20points%5BintPoint%20%25%20l%5D%3B%0A%20%20%20%20const%20p2%20%3D%20points%5B%28intPoint%20%2B%201%29%20%25%20l%5D%3B%0A%20%20%20%20if%20%28this.closed%20%7C%7C%20intPoint%20%2B%202%20%3C%20l%29%20%7B%0A%20%20%20%20%20%20p3%20%3D%20points%5B%28intPoint%20%2B%202%29%20%25%20l%5D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tmp.subVectors%28points%5Bl%20-%201%5D%2C%20points%5Bl%20-%202%5D%29.add%28points%5Bl%20-%201%5D%29%3B%0A%20%20%20%20%20%20p3%20%3D%20tmp%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.curveType%20%3D%3D%3D%20%22centripetal%22%20%7C%7C%20this.curveType%20%3D%3D%3D%20%22chordal%22%29%20%7B%0A%20%20%20%20%20%20const%20pow5%20%3D%20this.curveType%20%3D%3D%3D%20%22chordal%22%20%3F%200.5%20%3A%200.25%3B%0A%20%20%20%20%20%20let%20dt0%20%3D%20Math.pow%28p0.distanceToSquared%28p1%29%2C%20pow5%29%3B%0A%20%20%20%20%20%20let%20dt1%20%3D%20Math.pow%28p1.distanceToSquared%28p2%29%2C%20pow5%29%3B%0A%20%20%20%20%20%20let%20dt2%20%3D%20Math.pow%28p2.distanceToSquared%28p3%29%2C%20pow5%29%3B%0A%20%20%20%20%20%20if%20%28dt1%20%3C%201e-4%29%20dt1%20%3D%201%3B%0A%20%20%20%20%20%20if%20%28dt0%20%3C%201e-4%29%20dt0%20%3D%20dt1%3B%0A%20%20%20%20%20%20if%20%28dt2%20%3C%201e-4%29%20dt2%20%3D%20dt1%3B%0A%20%20%20%20%20%20px.initNonuniformCatmullRom%28p0.x%2C%20p1.x%2C%20p2.x%2C%20p3.x%2C%20dt0%2C%20dt1%2C%20dt2%29%3B%0A%20%20%20%20%20%20py.initNonuniformCatmullRom%28p0.y%2C%20p1.y%2C%20p2.y%2C%20p3.y%2C%20dt0%2C%20dt1%2C%20dt2%29%3B%0A%20%20%20%20%20%20pz.initNonuniformCatmullRom%28p0.z%2C%20p1.z%2C%20p2.z%2C%20p3.z%2C%20dt0%2C%20dt1%2C%20dt2%29%3B%0A%20%20%20%20%7D%20else%20if%20%28this.curveType%20%3D%3D%3D%20%22catmullrom%22%29%20%7B%0A%20%20%20%20%20%20px.initCatmullRom%28p0.x%2C%20p1.x%2C%20p2.x%2C%20p3.x%2C%20this.tension%29%3B%0A%20%20%20%20%20%20py.initCatmullRom%28p0.y%2C%20p1.y%2C%20p2.y%2C%20p3.y%2C%20this.tension%29%3B%0A%20%20%20%20%20%20pz.initCatmullRom%28p0.z%2C%20p1.z%2C%20p2.z%2C%20p3.z%2C%20this.tension%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20point.set%28%0A%20%20%20%20%20%20px.calc%28weight%29%2C%0A%20%20%20%20%20%20py.calc%28weight%29%2C%0A%20%20%20%20%20%20pz.calc%28weight%29%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20point%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.points%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20source.points.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20point%20%3D%20source.points%5Bi%5D%3B%0A%20%20%20%20%20%20this.points.push%28point.clone%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.closed%20%3D%20source.closed%3B%0A%20%20%20%20this.curveType%20%3D%20source.curveType%3B%0A%20%20%20%20this.tension%20%3D%20source.tension%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.points%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.points.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20point%20%3D%20this.points%5Bi%5D%3B%0A%20%20%20%20%20%20data.points.push%28point.toArray%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20data.closed%20%3D%20this.closed%3B%0A%20%20%20%20data.curveType%20%3D%20this.curveType%3B%0A%20%20%20%20data.tension%20%3D%20this.tension%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20super.fromJSON%28json%29%3B%0A%20%20%20%20this.points%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20json.points.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20point%20%3D%20json.points%5Bi%5D%3B%0A%20%20%20%20%20%20this.points.push%28new%20Vector3%28%29.fromArray%28point%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.closed%20%3D%20json.closed%3B%0A%20%20%20%20this.curveType%20%3D%20json.curveType%3B%0A%20%20%20%20this.tension%20%3D%20json.tension%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20CatmullRom%28t%2C%20p0%2C%20p1%2C%20p2%2C%20p3%29%20%7B%0A%20%20const%20v0%20%3D%20%28p2%20-%20p0%29%20%2A%200.5%3B%0A%20%20const%20v1%20%3D%20%28p3%20-%20p1%29%20%2A%200.5%3B%0A%20%20const%20t2%20%3D%20t%20%2A%20t%3B%0A%20%20const%20t3%20%3D%20t%20%2A%20t2%3B%0A%20%20return%20%282%20%2A%20p1%20-%202%20%2A%20p2%20%2B%20v0%20%2B%20v1%29%20%2A%20t3%20%2B%20%28-3%20%2A%20p1%20%2B%203%20%2A%20p2%20-%202%20%2A%20v0%20-%20v1%29%20%2A%20t2%20%2B%20v0%20%2A%20t%20%2B%20p1%3B%0A%7D%0Afunction%20QuadraticBezierP0%28t%2C%20p%29%20%7B%0A%20%20const%20k%20%3D%201%20-%20t%3B%0A%20%20return%20k%20%2A%20k%20%2A%20p%3B%0A%7D%0Afunction%20QuadraticBezierP1%28t%2C%20p%29%20%7B%0A%20%20return%202%20%2A%20%281%20-%20t%29%20%2A%20t%20%2A%20p%3B%0A%7D%0Afunction%20QuadraticBezierP2%28t%2C%20p%29%20%7B%0A%20%20return%20t%20%2A%20t%20%2A%20p%3B%0A%7D%0Afunction%20QuadraticBezier%28t%2C%20p0%2C%20p1%2C%20p2%29%20%7B%0A%20%20return%20QuadraticBezierP0%28t%2C%20p0%29%20%2B%20QuadraticBezierP1%28t%2C%20p1%29%20%2B%20QuadraticBezierP2%28t%2C%20p2%29%3B%0A%7D%0Afunction%20CubicBezierP0%28t%2C%20p%29%20%7B%0A%20%20const%20k%20%3D%201%20-%20t%3B%0A%20%20return%20k%20%2A%20k%20%2A%20k%20%2A%20p%3B%0A%7D%0Afunction%20CubicBezierP1%28t%2C%20p%29%20%7B%0A%20%20const%20k%20%3D%201%20-%20t%3B%0A%20%20return%203%20%2A%20k%20%2A%20k%20%2A%20t%20%2A%20p%3B%0A%7D%0Afunction%20CubicBezierP2%28t%2C%20p%29%20%7B%0A%20%20return%203%20%2A%20%281%20-%20t%29%20%2A%20t%20%2A%20t%20%2A%20p%3B%0A%7D%0Afunction%20CubicBezierP3%28t%2C%20p%29%20%7B%0A%20%20return%20t%20%2A%20t%20%2A%20t%20%2A%20p%3B%0A%7D%0Afunction%20CubicBezier%28t%2C%20p0%2C%20p1%2C%20p2%2C%20p3%29%20%7B%0A%20%20return%20CubicBezierP0%28t%2C%20p0%29%20%2B%20CubicBezierP1%28t%2C%20p1%29%20%2B%20CubicBezierP2%28t%2C%20p2%29%20%2B%20CubicBezierP3%28t%2C%20p3%29%3B%0A%7D%0Avar%20CubicBezierCurve%20%3D%20class%20extends%20Curve%20%7B%0A%20%20constructor%28v0%20%3D%20new%20Vector2%28%29%2C%20v1%20%3D%20new%20Vector2%28%29%2C%20v2%20%3D%20new%20Vector2%28%29%2C%20v3%20%3D%20new%20Vector2%28%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isCubicBezierCurve%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22CubicBezierCurve%22%3B%0A%20%20%20%20this.v0%20%3D%20v0%3B%0A%20%20%20%20this.v1%20%3D%20v1%3B%0A%20%20%20%20this.v2%20%3D%20v2%3B%0A%20%20%20%20this.v3%20%3D%20v3%3B%0A%20%20%7D%0A%20%20getPoint%28t%2C%20optionalTarget%20%3D%20new%20Vector2%28%29%29%20%7B%0A%20%20%20%20const%20point%20%3D%20optionalTarget%3B%0A%20%20%20%20const%20v0%20%3D%20this.v0%2C%20v1%20%3D%20this.v1%2C%20v2%20%3D%20this.v2%2C%20v3%20%3D%20this.v3%3B%0A%20%20%20%20point.set%28%0A%20%20%20%20%20%20CubicBezier%28t%2C%20v0.x%2C%20v1.x%2C%20v2.x%2C%20v3.x%29%2C%0A%20%20%20%20%20%20CubicBezier%28t%2C%20v0.y%2C%20v1.y%2C%20v2.y%2C%20v3.y%29%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20point%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.v0.copy%28source.v0%29%3B%0A%20%20%20%20this.v1.copy%28source.v1%29%3B%0A%20%20%20%20this.v2.copy%28source.v2%29%3B%0A%20%20%20%20this.v3.copy%28source.v3%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.v0%20%3D%20this.v0.toArray%28%29%3B%0A%20%20%20%20data.v1%20%3D%20this.v1.toArray%28%29%3B%0A%20%20%20%20data.v2%20%3D%20this.v2.toArray%28%29%3B%0A%20%20%20%20data.v3%20%3D%20this.v3.toArray%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20super.fromJSON%28json%29%3B%0A%20%20%20%20this.v0.fromArray%28json.v0%29%3B%0A%20%20%20%20this.v1.fromArray%28json.v1%29%3B%0A%20%20%20%20this.v2.fromArray%28json.v2%29%3B%0A%20%20%20%20this.v3.fromArray%28json.v3%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20CubicBezierCurve3%20%3D%20class%20extends%20Curve%20%7B%0A%20%20constructor%28v0%20%3D%20new%20Vector3%28%29%2C%20v1%20%3D%20new%20Vector3%28%29%2C%20v2%20%3D%20new%20Vector3%28%29%2C%20v3%20%3D%20new%20Vector3%28%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isCubicBezierCurve3%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22CubicBezierCurve3%22%3B%0A%20%20%20%20this.v0%20%3D%20v0%3B%0A%20%20%20%20this.v1%20%3D%20v1%3B%0A%20%20%20%20this.v2%20%3D%20v2%3B%0A%20%20%20%20this.v3%20%3D%20v3%3B%0A%20%20%7D%0A%20%20getPoint%28t%2C%20optionalTarget%20%3D%20new%20Vector3%28%29%29%20%7B%0A%20%20%20%20const%20point%20%3D%20optionalTarget%3B%0A%20%20%20%20const%20v0%20%3D%20this.v0%2C%20v1%20%3D%20this.v1%2C%20v2%20%3D%20this.v2%2C%20v3%20%3D%20this.v3%3B%0A%20%20%20%20point.set%28%0A%20%20%20%20%20%20CubicBezier%28t%2C%20v0.x%2C%20v1.x%2C%20v2.x%2C%20v3.x%29%2C%0A%20%20%20%20%20%20CubicBezier%28t%2C%20v0.y%2C%20v1.y%2C%20v2.y%2C%20v3.y%29%2C%0A%20%20%20%20%20%20CubicBezier%28t%2C%20v0.z%2C%20v1.z%2C%20v2.z%2C%20v3.z%29%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20point%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.v0.copy%28source.v0%29%3B%0A%20%20%20%20this.v1.copy%28source.v1%29%3B%0A%20%20%20%20this.v2.copy%28source.v2%29%3B%0A%20%20%20%20this.v3.copy%28source.v3%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.v0%20%3D%20this.v0.toArray%28%29%3B%0A%20%20%20%20data.v1%20%3D%20this.v1.toArray%28%29%3B%0A%20%20%20%20data.v2%20%3D%20this.v2.toArray%28%29%3B%0A%20%20%20%20data.v3%20%3D%20this.v3.toArray%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20super.fromJSON%28json%29%3B%0A%20%20%20%20this.v0.fromArray%28json.v0%29%3B%0A%20%20%20%20this.v1.fromArray%28json.v1%29%3B%0A%20%20%20%20this.v2.fromArray%28json.v2%29%3B%0A%20%20%20%20this.v3.fromArray%28json.v3%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LineCurve%20%3D%20class%20extends%20Curve%20%7B%0A%20%20constructor%28v1%20%3D%20new%20Vector2%28%29%2C%20v2%20%3D%20new%20Vector2%28%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLineCurve%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22LineCurve%22%3B%0A%20%20%20%20this.v1%20%3D%20v1%3B%0A%20%20%20%20this.v2%20%3D%20v2%3B%0A%20%20%7D%0A%20%20getPoint%28t%2C%20optionalTarget%20%3D%20new%20Vector2%28%29%29%20%7B%0A%20%20%20%20const%20point%20%3D%20optionalTarget%3B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20point.copy%28this.v2%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20point.copy%28this.v2%29.sub%28this.v1%29%3B%0A%20%20%20%20%20%20point.multiplyScalar%28t%29.add%28this.v1%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20point%3B%0A%20%20%7D%0A%20%20%2F%2F%20Line%20curve%20is%20linear%2C%20so%20we%20can%20overwrite%20default%20getPointAt%0A%20%20getPointAt%28u%2C%20optionalTarget%29%20%7B%0A%20%20%20%20return%20this.getPoint%28u%2C%20optionalTarget%29%3B%0A%20%20%7D%0A%20%20getTangent%28t%2C%20optionalTarget%20%3D%20new%20Vector2%28%29%29%20%7B%0A%20%20%20%20return%20optionalTarget.subVectors%28this.v2%2C%20this.v1%29.normalize%28%29%3B%0A%20%20%7D%0A%20%20getTangentAt%28u%2C%20optionalTarget%29%20%7B%0A%20%20%20%20return%20this.getTangent%28u%2C%20optionalTarget%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.v1.copy%28source.v1%29%3B%0A%20%20%20%20this.v2.copy%28source.v2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.v1%20%3D%20this.v1.toArray%28%29%3B%0A%20%20%20%20data.v2%20%3D%20this.v2.toArray%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20super.fromJSON%28json%29%3B%0A%20%20%20%20this.v1.fromArray%28json.v1%29%3B%0A%20%20%20%20this.v2.fromArray%28json.v2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LineCurve3%20%3D%20class%20extends%20Curve%20%7B%0A%20%20constructor%28v1%20%3D%20new%20Vector3%28%29%2C%20v2%20%3D%20new%20Vector3%28%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLineCurve3%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22LineCurve3%22%3B%0A%20%20%20%20this.v1%20%3D%20v1%3B%0A%20%20%20%20this.v2%20%3D%20v2%3B%0A%20%20%7D%0A%20%20getPoint%28t%2C%20optionalTarget%20%3D%20new%20Vector3%28%29%29%20%7B%0A%20%20%20%20const%20point%20%3D%20optionalTarget%3B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20point.copy%28this.v2%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20point.copy%28this.v2%29.sub%28this.v1%29%3B%0A%20%20%20%20%20%20point.multiplyScalar%28t%29.add%28this.v1%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20point%3B%0A%20%20%7D%0A%20%20%2F%2F%20Line%20curve%20is%20linear%2C%20so%20we%20can%20overwrite%20default%20getPointAt%0A%20%20getPointAt%28u%2C%20optionalTarget%29%20%7B%0A%20%20%20%20return%20this.getPoint%28u%2C%20optionalTarget%29%3B%0A%20%20%7D%0A%20%20getTangent%28t%2C%20optionalTarget%20%3D%20new%20Vector3%28%29%29%20%7B%0A%20%20%20%20return%20optionalTarget.subVectors%28this.v2%2C%20this.v1%29.normalize%28%29%3B%0A%20%20%7D%0A%20%20getTangentAt%28u%2C%20optionalTarget%29%20%7B%0A%20%20%20%20return%20this.getTangent%28u%2C%20optionalTarget%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.v1.copy%28source.v1%29%3B%0A%20%20%20%20this.v2.copy%28source.v2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.v1%20%3D%20this.v1.toArray%28%29%3B%0A%20%20%20%20data.v2%20%3D%20this.v2.toArray%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20super.fromJSON%28json%29%3B%0A%20%20%20%20this.v1.fromArray%28json.v1%29%3B%0A%20%20%20%20this.v2.fromArray%28json.v2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20QuadraticBezierCurve%20%3D%20class%20extends%20Curve%20%7B%0A%20%20constructor%28v0%20%3D%20new%20Vector2%28%29%2C%20v1%20%3D%20new%20Vector2%28%29%2C%20v2%20%3D%20new%20Vector2%28%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isQuadraticBezierCurve%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22QuadraticBezierCurve%22%3B%0A%20%20%20%20this.v0%20%3D%20v0%3B%0A%20%20%20%20this.v1%20%3D%20v1%3B%0A%20%20%20%20this.v2%20%3D%20v2%3B%0A%20%20%7D%0A%20%20getPoint%28t%2C%20optionalTarget%20%3D%20new%20Vector2%28%29%29%20%7B%0A%20%20%20%20const%20point%20%3D%20optionalTarget%3B%0A%20%20%20%20const%20v0%20%3D%20this.v0%2C%20v1%20%3D%20this.v1%2C%20v2%20%3D%20this.v2%3B%0A%20%20%20%20point.set%28%0A%20%20%20%20%20%20QuadraticBezier%28t%2C%20v0.x%2C%20v1.x%2C%20v2.x%29%2C%0A%20%20%20%20%20%20QuadraticBezier%28t%2C%20v0.y%2C%20v1.y%2C%20v2.y%29%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20point%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.v0.copy%28source.v0%29%3B%0A%20%20%20%20this.v1.copy%28source.v1%29%3B%0A%20%20%20%20this.v2.copy%28source.v2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.v0%20%3D%20this.v0.toArray%28%29%3B%0A%20%20%20%20data.v1%20%3D%20this.v1.toArray%28%29%3B%0A%20%20%20%20data.v2%20%3D%20this.v2.toArray%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20super.fromJSON%28json%29%3B%0A%20%20%20%20this.v0.fromArray%28json.v0%29%3B%0A%20%20%20%20this.v1.fromArray%28json.v1%29%3B%0A%20%20%20%20this.v2.fromArray%28json.v2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20QuadraticBezierCurve3%20%3D%20class%20extends%20Curve%20%7B%0A%20%20constructor%28v0%20%3D%20new%20Vector3%28%29%2C%20v1%20%3D%20new%20Vector3%28%29%2C%20v2%20%3D%20new%20Vector3%28%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isQuadraticBezierCurve3%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22QuadraticBezierCurve3%22%3B%0A%20%20%20%20this.v0%20%3D%20v0%3B%0A%20%20%20%20this.v1%20%3D%20v1%3B%0A%20%20%20%20this.v2%20%3D%20v2%3B%0A%20%20%7D%0A%20%20getPoint%28t%2C%20optionalTarget%20%3D%20new%20Vector3%28%29%29%20%7B%0A%20%20%20%20const%20point%20%3D%20optionalTarget%3B%0A%20%20%20%20const%20v0%20%3D%20this.v0%2C%20v1%20%3D%20this.v1%2C%20v2%20%3D%20this.v2%3B%0A%20%20%20%20point.set%28%0A%20%20%20%20%20%20QuadraticBezier%28t%2C%20v0.x%2C%20v1.x%2C%20v2.x%29%2C%0A%20%20%20%20%20%20QuadraticBezier%28t%2C%20v0.y%2C%20v1.y%2C%20v2.y%29%2C%0A%20%20%20%20%20%20QuadraticBezier%28t%2C%20v0.z%2C%20v1.z%2C%20v2.z%29%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20point%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.v0.copy%28source.v0%29%3B%0A%20%20%20%20this.v1.copy%28source.v1%29%3B%0A%20%20%20%20this.v2.copy%28source.v2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.v0%20%3D%20this.v0.toArray%28%29%3B%0A%20%20%20%20data.v1%20%3D%20this.v1.toArray%28%29%3B%0A%20%20%20%20data.v2%20%3D%20this.v2.toArray%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20super.fromJSON%28json%29%3B%0A%20%20%20%20this.v0.fromArray%28json.v0%29%3B%0A%20%20%20%20this.v1.fromArray%28json.v1%29%3B%0A%20%20%20%20this.v2.fromArray%28json.v2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20SplineCurve%20%3D%20class%20extends%20Curve%20%7B%0A%20%20constructor%28points%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isSplineCurve%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22SplineCurve%22%3B%0A%20%20%20%20this.points%20%3D%20points%3B%0A%20%20%7D%0A%20%20getPoint%28t%2C%20optionalTarget%20%3D%20new%20Vector2%28%29%29%20%7B%0A%20%20%20%20const%20point%20%3D%20optionalTarget%3B%0A%20%20%20%20const%20points%20%3D%20this.points%3B%0A%20%20%20%20const%20p%20%3D%20%28points.length%20-%201%29%20%2A%20t%3B%0A%20%20%20%20const%20intPoint%20%3D%20Math.floor%28p%29%3B%0A%20%20%20%20const%20weight%20%3D%20p%20-%20intPoint%3B%0A%20%20%20%20const%20p0%20%3D%20points%5BintPoint%20%3D%3D%3D%200%20%3F%20intPoint%20%3A%20intPoint%20-%201%5D%3B%0A%20%20%20%20const%20p1%20%3D%20points%5BintPoint%5D%3B%0A%20%20%20%20const%20p2%20%3D%20points%5BintPoint%20%3E%20points.length%20-%202%20%3F%20points.length%20-%201%20%3A%20intPoint%20%2B%201%5D%3B%0A%20%20%20%20const%20p3%20%3D%20points%5BintPoint%20%3E%20points.length%20-%203%20%3F%20points.length%20-%201%20%3A%20intPoint%20%2B%202%5D%3B%0A%20%20%20%20point.set%28%0A%20%20%20%20%20%20CatmullRom%28weight%2C%20p0.x%2C%20p1.x%2C%20p2.x%2C%20p3.x%29%2C%0A%20%20%20%20%20%20CatmullRom%28weight%2C%20p0.y%2C%20p1.y%2C%20p2.y%2C%20p3.y%29%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20point%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.points%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20source.points.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20point%20%3D%20source.points%5Bi%5D%3B%0A%20%20%20%20%20%20this.points.push%28point.clone%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.points%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.points.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20point%20%3D%20this.points%5Bi%5D%3B%0A%20%20%20%20%20%20data.points.push%28point.toArray%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20super.fromJSON%28json%29%3B%0A%20%20%20%20this.points%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20json.points.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20point%20%3D%20json.points%5Bi%5D%3B%0A%20%20%20%20%20%20this.points.push%28new%20Vector2%28%29.fromArray%28point%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Curves%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Object.freeze%28%7B%0A%20%20__proto__%3A%20null%2C%0A%20%20ArcCurve%2C%0A%20%20CatmullRomCurve3%2C%0A%20%20CubicBezierCurve%2C%0A%20%20CubicBezierCurve3%2C%0A%20%20EllipseCurve%2C%0A%20%20LineCurve%2C%0A%20%20LineCurve3%2C%0A%20%20QuadraticBezierCurve%2C%0A%20%20QuadraticBezierCurve3%2C%0A%20%20SplineCurve%0A%7D%29%3B%0Avar%20CylinderGeometry%20%3D%20class%20_CylinderGeometry%20extends%20BufferGeometry%20%7B%0A%20%20constructor%28radiusTop%20%3D%201%2C%20radiusBottom%20%3D%201%2C%20height%20%3D%201%2C%20radialSegments%20%3D%2032%2C%20heightSegments%20%3D%201%2C%20openEnded%20%3D%20false%2C%20thetaStart%20%3D%200%2C%20thetaLength%20%3D%20Math.PI%20%2A%202%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.type%20%3D%20%22CylinderGeometry%22%3B%0A%20%20%20%20this.parameters%20%3D%20%7B%0A%20%20%20%20%20%20radiusTop%2C%0A%20%20%20%20%20%20radiusBottom%2C%0A%20%20%20%20%20%20height%2C%0A%20%20%20%20%20%20radialSegments%2C%0A%20%20%20%20%20%20heightSegments%2C%0A%20%20%20%20%20%20openEnded%2C%0A%20%20%20%20%20%20thetaStart%2C%0A%20%20%20%20%20%20thetaLength%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20scope%20%3D%20this%3B%0A%20%20%20%20radialSegments%20%3D%20Math.floor%28radialSegments%29%3B%0A%20%20%20%20heightSegments%20%3D%20Math.floor%28heightSegments%29%3B%0A%20%20%20%20const%20indices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vertices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20normals%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20uvs%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20index5%20%3D%200%3B%0A%20%20%20%20const%20indexArray%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20halfHeight%20%3D%20height%20%2F%202%3B%0A%20%20%20%20let%20groupStart%20%3D%200%3B%0A%20%20%20%20generateTorso%28%29%3B%0A%20%20%20%20if%20%28openEnded%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20if%20%28radiusTop%20%3E%200%29%20generateCap%28true%29%3B%0A%20%20%20%20%20%20if%20%28radiusBottom%20%3E%200%29%20generateCap%28false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.setIndex%28indices%29%3B%0A%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute%28vertices%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22normal%22%2C%20new%20Float32BufferAttribute%28normals%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22uv%22%2C%20new%20Float32BufferAttribute%28uvs%2C%202%29%29%3B%0A%20%20%20%20function%20generateTorso%28%29%20%7B%0A%20%20%20%20%20%20const%20normal2%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20const%20vertex2%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20let%20groupCount%20%3D%200%3B%0A%20%20%20%20%20%20const%20slope%20%3D%20%28radiusBottom%20-%20radiusTop%29%20%2F%20height%3B%0A%20%20%20%20%20%20for%20%28let%20y2%20%3D%200%3B%20y2%20%3C%3D%20heightSegments%3B%20y2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20indexRow%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20const%20v%20%3D%20y2%20%2F%20heightSegments%3B%0A%20%20%20%20%20%20%20%20const%20radius%20%3D%20v%20%2A%20%28radiusBottom%20-%20radiusTop%29%20%2B%20radiusTop%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20x2%20%3D%200%3B%20x2%20%3C%3D%20radialSegments%3B%20x2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20u%20%3D%20x2%20%2F%20radialSegments%3B%0A%20%20%20%20%20%20%20%20%20%20const%20theta%20%3D%20u%20%2A%20thetaLength%20%2B%20thetaStart%3B%0A%20%20%20%20%20%20%20%20%20%20const%20sinTheta%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20cosTheta%20%3D%20Math.cos%28theta%29%3B%0A%20%20%20%20%20%20%20%20%20%20vertex2.x%20%3D%20radius%20%2A%20sinTheta%3B%0A%20%20%20%20%20%20%20%20%20%20vertex2.y%20%3D%20-v%20%2A%20height%20%2B%20halfHeight%3B%0A%20%20%20%20%20%20%20%20%20%20vertex2.z%20%3D%20radius%20%2A%20cosTheta%3B%0A%20%20%20%20%20%20%20%20%20%20vertices.push%28vertex2.x%2C%20vertex2.y%2C%20vertex2.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20normal2.set%28sinTheta%2C%20slope%2C%20cosTheta%29.normalize%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20normals.push%28normal2.x%2C%20normal2.y%2C%20normal2.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20uvs.push%28u%2C%201%20-%20v%29%3B%0A%20%20%20%20%20%20%20%20%20%20indexRow.push%28index5%2B%2B%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20indexArray.push%28indexRow%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28let%20x2%20%3D%200%3B%20x2%20%3C%20radialSegments%3B%20x2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20y2%20%3D%200%3B%20y2%20%3C%20heightSegments%3B%20y2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20indexArray%5By2%5D%5Bx2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20indexArray%5By2%20%2B%201%5D%5Bx2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20indexArray%5By2%20%2B%201%5D%5Bx2%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20d%20%3D%20indexArray%5By2%5D%5Bx2%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28radiusTop%20%3E%200%20%7C%7C%20y2%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20indices.push%28a2%2C%20b%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20groupCount%20%2B%3D%203%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28radiusBottom%20%3E%200%20%7C%7C%20y2%20%21%3D%3D%20heightSegments%20-%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20indices.push%28b%2C%20c2%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20groupCount%20%2B%3D%203%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20scope.addGroup%28groupStart%2C%20groupCount%2C%200%29%3B%0A%20%20%20%20%20%20groupStart%20%2B%3D%20groupCount%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateCap%28top%29%20%7B%0A%20%20%20%20%20%20const%20centerIndexStart%20%3D%20index5%3B%0A%20%20%20%20%20%20const%20uv2%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20%20%20const%20vertex2%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20%20%20let%20groupCount%20%3D%200%3B%0A%20%20%20%20%20%20const%20radius%20%3D%20top%20%3D%3D%3D%20true%20%3F%20radiusTop%20%3A%20radiusBottom%3B%0A%20%20%20%20%20%20const%20sign2%20%3D%20top%20%3D%3D%3D%20true%20%3F%201%20%3A%20-1%3B%0A%20%20%20%20%20%20for%20%28let%20x2%20%3D%201%3B%20x2%20%3C%3D%20radialSegments%3B%20x2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20vertices.push%280%2C%20halfHeight%20%2A%20sign2%2C%200%29%3B%0A%20%20%20%20%20%20%20%20normals.push%280%2C%20sign2%2C%200%29%3B%0A%20%20%20%20%20%20%20%20uvs.push%280.5%2C%200.5%29%3B%0A%20%20%20%20%20%20%20%20index5%2B%2B%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20centerIndexEnd%20%3D%20index5%3B%0A%20%20%20%20%20%20for%20%28let%20x2%20%3D%200%3B%20x2%20%3C%3D%20radialSegments%3B%20x2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20u%20%3D%20x2%20%2F%20radialSegments%3B%0A%20%20%20%20%20%20%20%20const%20theta%20%3D%20u%20%2A%20thetaLength%20%2B%20thetaStart%3B%0A%20%20%20%20%20%20%20%20const%20cosTheta%20%3D%20Math.cos%28theta%29%3B%0A%20%20%20%20%20%20%20%20const%20sinTheta%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20%20%20%20%20vertex2.x%20%3D%20radius%20%2A%20sinTheta%3B%0A%20%20%20%20%20%20%20%20vertex2.y%20%3D%20halfHeight%20%2A%20sign2%3B%0A%20%20%20%20%20%20%20%20vertex2.z%20%3D%20radius%20%2A%20cosTheta%3B%0A%20%20%20%20%20%20%20%20vertices.push%28vertex2.x%2C%20vertex2.y%2C%20vertex2.z%29%3B%0A%20%20%20%20%20%20%20%20normals.push%280%2C%20sign2%2C%200%29%3B%0A%20%20%20%20%20%20%20%20uv2.x%20%3D%20cosTheta%20%2A%200.5%20%2B%200.5%3B%0A%20%20%20%20%20%20%20%20uv2.y%20%3D%20sinTheta%20%2A%200.5%20%2A%20sign2%20%2B%200.5%3B%0A%20%20%20%20%20%20%20%20uvs.push%28uv2.x%2C%20uv2.y%29%3B%0A%20%20%20%20%20%20%20%20index5%2B%2B%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28let%20x2%20%3D%200%3B%20x2%20%3C%20radialSegments%3B%20x2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20c2%20%3D%20centerIndexStart%20%2B%20x2%3B%0A%20%20%20%20%20%20%20%20const%20i%20%3D%20centerIndexEnd%20%2B%20x2%3B%0A%20%20%20%20%20%20%20%20if%20%28top%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20indices.push%28i%2C%20i%20%2B%201%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20indices.push%28i%20%2B%201%2C%20i%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20groupCount%20%2B%3D%203%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20scope.addGroup%28groupStart%2C%20groupCount%2C%20top%20%3D%3D%3D%20true%20%3F%201%20%3A%202%29%3B%0A%20%20%20%20%20%20groupStart%20%2B%3D%20groupCount%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.parameters%20%3D%20Object.assign%28%7B%7D%2C%20source.parameters%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20static%20fromJSON%28data%29%20%7B%0A%20%20%20%20return%20new%20_CylinderGeometry%28data.radiusTop%2C%20data.radiusBottom%2C%20data.height%2C%20data.radialSegments%2C%20data.heightSegments%2C%20data.openEnded%2C%20data.thetaStart%2C%20data.thetaLength%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ConeGeometry%20%3D%20class%20_ConeGeometry%20extends%20CylinderGeometry%20%7B%0A%20%20constructor%28radius%20%3D%201%2C%20height%20%3D%201%2C%20radialSegments%20%3D%2032%2C%20heightSegments%20%3D%201%2C%20openEnded%20%3D%20false%2C%20thetaStart%20%3D%200%2C%20thetaLength%20%3D%20Math.PI%20%2A%202%29%20%7B%0A%20%20%20%20super%280%2C%20radius%2C%20height%2C%20radialSegments%2C%20heightSegments%2C%20openEnded%2C%20thetaStart%2C%20thetaLength%29%3B%0A%20%20%20%20this.type%20%3D%20%22ConeGeometry%22%3B%0A%20%20%20%20this.parameters%20%3D%20%7B%0A%20%20%20%20%20%20radius%2C%0A%20%20%20%20%20%20height%2C%0A%20%20%20%20%20%20radialSegments%2C%0A%20%20%20%20%20%20heightSegments%2C%0A%20%20%20%20%20%20openEnded%2C%0A%20%20%20%20%20%20thetaStart%2C%0A%20%20%20%20%20%20thetaLength%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20static%20fromJSON%28data%29%20%7B%0A%20%20%20%20return%20new%20_ConeGeometry%28data.radius%2C%20data.height%2C%20data.radialSegments%2C%20data.heightSegments%2C%20data.openEnded%2C%20data.thetaStart%2C%20data.thetaLength%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20SphereGeometry%20%3D%20class%20_SphereGeometry%20extends%20BufferGeometry%20%7B%0A%20%20constructor%28radius%20%3D%201%2C%20widthSegments%20%3D%2032%2C%20heightSegments%20%3D%2016%2C%20phiStart%20%3D%200%2C%20phiLength%20%3D%20Math.PI%20%2A%202%2C%20thetaStart%20%3D%200%2C%20thetaLength%20%3D%20Math.PI%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.type%20%3D%20%22SphereGeometry%22%3B%0A%20%20%20%20this.parameters%20%3D%20%7B%0A%20%20%20%20%20%20radius%2C%0A%20%20%20%20%20%20widthSegments%2C%0A%20%20%20%20%20%20heightSegments%2C%0A%20%20%20%20%20%20phiStart%2C%0A%20%20%20%20%20%20phiLength%2C%0A%20%20%20%20%20%20thetaStart%2C%0A%20%20%20%20%20%20thetaLength%0A%20%20%20%20%7D%3B%0A%20%20%20%20widthSegments%20%3D%20Math.max%283%2C%20Math.floor%28widthSegments%29%29%3B%0A%20%20%20%20heightSegments%20%3D%20Math.max%282%2C%20Math.floor%28heightSegments%29%29%3B%0A%20%20%20%20const%20thetaEnd%20%3D%20Math.min%28thetaStart%20%2B%20thetaLength%2C%20Math.PI%29%3B%0A%20%20%20%20let%20index5%20%3D%200%3B%0A%20%20%20%20const%20grid%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vertex2%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20normal2%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20indices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vertices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20normals%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20uvs%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%3D%20heightSegments%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20verticesRow%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20const%20v%20%3D%20iy%20%2F%20heightSegments%3B%0A%20%20%20%20%20%20let%20uOffset%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28iy%20%3D%3D%3D%200%20%26%26%20thetaStart%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20uOffset%20%3D%200.5%20%2F%20widthSegments%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28iy%20%3D%3D%3D%20heightSegments%20%26%26%20thetaEnd%20%3D%3D%3D%20Math.PI%29%20%7B%0A%20%20%20%20%20%20%20%20uOffset%20%3D%20-0.5%20%2F%20widthSegments%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%3D%20widthSegments%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20u%20%3D%20ix%20%2F%20widthSegments%3B%0A%20%20%20%20%20%20%20%20vertex2.x%20%3D%20-radius%20%2A%20Math.cos%28phiStart%20%2B%20u%20%2A%20phiLength%29%20%2A%20Math.sin%28thetaStart%20%2B%20v%20%2A%20thetaLength%29%3B%0A%20%20%20%20%20%20%20%20vertex2.y%20%3D%20radius%20%2A%20Math.cos%28thetaStart%20%2B%20v%20%2A%20thetaLength%29%3B%0A%20%20%20%20%20%20%20%20vertex2.z%20%3D%20radius%20%2A%20Math.sin%28phiStart%20%2B%20u%20%2A%20phiLength%29%20%2A%20Math.sin%28thetaStart%20%2B%20v%20%2A%20thetaLength%29%3B%0A%20%20%20%20%20%20%20%20vertices.push%28vertex2.x%2C%20vertex2.y%2C%20vertex2.z%29%3B%0A%20%20%20%20%20%20%20%20normal2.copy%28vertex2%29.normalize%28%29%3B%0A%20%20%20%20%20%20%20%20normals.push%28normal2.x%2C%20normal2.y%2C%20normal2.z%29%3B%0A%20%20%20%20%20%20%20%20uvs.push%28u%20%2B%20uOffset%2C%201%20-%20v%29%3B%0A%20%20%20%20%20%20%20%20verticesRow.push%28index5%2B%2B%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20grid.push%28verticesRow%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%20heightSegments%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%20widthSegments%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20a2%20%3D%20grid%5Biy%5D%5Bix%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20const%20b%20%3D%20grid%5Biy%5D%5Bix%5D%3B%0A%20%20%20%20%20%20%20%20const%20c2%20%3D%20grid%5Biy%20%2B%201%5D%5Bix%5D%3B%0A%20%20%20%20%20%20%20%20const%20d%20%3D%20grid%5Biy%20%2B%201%5D%5Bix%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28iy%20%21%3D%3D%200%20%7C%7C%20thetaStart%20%3E%200%29%20indices.push%28a2%2C%20b%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20if%20%28iy%20%21%3D%3D%20heightSegments%20-%201%20%7C%7C%20thetaEnd%20%3C%20Math.PI%29%20indices.push%28b%2C%20c2%2C%20d%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.setIndex%28indices%29%3B%0A%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute%28vertices%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22normal%22%2C%20new%20Float32BufferAttribute%28normals%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22uv%22%2C%20new%20Float32BufferAttribute%28uvs%2C%202%29%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.parameters%20%3D%20Object.assign%28%7B%7D%2C%20source.parameters%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20static%20fromJSON%28data%29%20%7B%0A%20%20%20%20return%20new%20_SphereGeometry%28data.radius%2C%20data.widthSegments%2C%20data.heightSegments%2C%20data.phiStart%2C%20data.phiLength%2C%20data.thetaStart%2C%20data.thetaLength%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20TubeGeometry%20%3D%20class%20_TubeGeometry%20extends%20BufferGeometry%20%7B%0A%20%20constructor%28path%20%3D%20new%20QuadraticBezierCurve3%28new%20Vector3%28-1%2C%20-1%2C%200%29%2C%20new%20Vector3%28-1%2C%201%2C%200%29%2C%20new%20Vector3%281%2C%201%2C%200%29%29%2C%20tubularSegments%20%3D%2064%2C%20radius%20%3D%201%2C%20radialSegments%20%3D%208%2C%20closed%20%3D%20false%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.type%20%3D%20%22TubeGeometry%22%3B%0A%20%20%20%20this.parameters%20%3D%20%7B%0A%20%20%20%20%20%20path%2C%0A%20%20%20%20%20%20tubularSegments%2C%0A%20%20%20%20%20%20radius%2C%0A%20%20%20%20%20%20radialSegments%2C%0A%20%20%20%20%20%20closed%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20frames%20%3D%20path.computeFrenetFrames%28tubularSegments%2C%20closed%29%3B%0A%20%20%20%20this.tangents%20%3D%20frames.tangents%3B%0A%20%20%20%20this.normals%20%3D%20frames.normals%3B%0A%20%20%20%20this.binormals%20%3D%20frames.binormals%3B%0A%20%20%20%20const%20vertex2%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20normal2%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20uv2%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20let%20P%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20const%20vertices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20normals%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20uvs%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20indices%20%3D%20%5B%5D%3B%0A%20%20%20%20generateBufferData%28%29%3B%0A%20%20%20%20this.setIndex%28indices%29%3B%0A%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute%28vertices%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22normal%22%2C%20new%20Float32BufferAttribute%28normals%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22uv%22%2C%20new%20Float32BufferAttribute%28uvs%2C%202%29%29%3B%0A%20%20%20%20function%20generateBufferData%28%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20tubularSegments%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20generateSegment%28i%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20generateSegment%28closed%20%3D%3D%3D%20false%20%3F%20tubularSegments%20%3A%200%29%3B%0A%20%20%20%20%20%20generateUVs%28%29%3B%0A%20%20%20%20%20%20generateIndices%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateSegment%28i%29%20%7B%0A%20%20%20%20%20%20P%20%3D%20path.getPointAt%28i%20%2F%20tubularSegments%2C%20P%29%3B%0A%20%20%20%20%20%20const%20N%20%3D%20frames.normals%5Bi%5D%3B%0A%20%20%20%20%20%20const%20B%20%3D%20frames.binormals%5Bi%5D%3B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%3D%20radialSegments%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20v%20%3D%20j%20%2F%20radialSegments%20%2A%20Math.PI%20%2A%202%3B%0A%20%20%20%20%20%20%20%20const%20sin2%20%3D%20Math.sin%28v%29%3B%0A%20%20%20%20%20%20%20%20const%20cos2%20%3D%20-Math.cos%28v%29%3B%0A%20%20%20%20%20%20%20%20normal2.x%20%3D%20cos2%20%2A%20N.x%20%2B%20sin2%20%2A%20B.x%3B%0A%20%20%20%20%20%20%20%20normal2.y%20%3D%20cos2%20%2A%20N.y%20%2B%20sin2%20%2A%20B.y%3B%0A%20%20%20%20%20%20%20%20normal2.z%20%3D%20cos2%20%2A%20N.z%20%2B%20sin2%20%2A%20B.z%3B%0A%20%20%20%20%20%20%20%20normal2.normalize%28%29%3B%0A%20%20%20%20%20%20%20%20normals.push%28normal2.x%2C%20normal2.y%2C%20normal2.z%29%3B%0A%20%20%20%20%20%20%20%20vertex2.x%20%3D%20P.x%20%2B%20radius%20%2A%20normal2.x%3B%0A%20%20%20%20%20%20%20%20vertex2.y%20%3D%20P.y%20%2B%20radius%20%2A%20normal2.y%3B%0A%20%20%20%20%20%20%20%20vertex2.z%20%3D%20P.z%20%2B%20radius%20%2A%20normal2.z%3B%0A%20%20%20%20%20%20%20%20vertices.push%28vertex2.x%2C%20vertex2.y%2C%20vertex2.z%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateIndices%28%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%201%3B%20j%20%3C%3D%20tubularSegments%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%3D%20radialSegments%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20%28radialSegments%20%2B%201%29%20%2A%20%28j%20-%201%29%20%2B%20%28i%20-%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20%28radialSegments%20%2B%201%29%20%2A%20j%20%2B%20%28i%20-%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20%28radialSegments%20%2B%201%29%20%2A%20j%20%2B%20i%3B%0A%20%20%20%20%20%20%20%20%20%20const%20d%20%3D%20%28radialSegments%20%2B%201%29%20%2A%20%28j%20-%201%29%20%2B%20i%3B%0A%20%20%20%20%20%20%20%20%20%20indices.push%28a2%2C%20b%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20%20%20indices.push%28b%2C%20c2%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20generateUVs%28%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%3D%20tubularSegments%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%3D%20radialSegments%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20uv2.x%20%3D%20i%20%2F%20tubularSegments%3B%0A%20%20%20%20%20%20%20%20%20%20uv2.y%20%3D%20j%20%2F%20radialSegments%3B%0A%20%20%20%20%20%20%20%20%20%20uvs.push%28uv2.x%2C%20uv2.y%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.parameters%20%3D%20Object.assign%28%7B%7D%2C%20source.parameters%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.path%20%3D%20this.parameters.path.toJSON%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20static%20fromJSON%28data%29%20%7B%0A%20%20%20%20return%20new%20_TubeGeometry%28%0A%20%20%20%20%20%20new%20Curves%5Bdata.path.type%5D%28%29.fromJSON%28data.path%29%2C%0A%20%20%20%20%20%20data.tubularSegments%2C%0A%20%20%20%20%20%20data.radius%2C%0A%20%20%20%20%20%20data.radialSegments%2C%0A%20%20%20%20%20%20data.closed%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshLambertMaterial%20%3D%20class%20extends%20Material%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshLambertMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshLambertMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color%2816777215%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.lightMap%20%3D%20null%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%201%3B%0A%20%20%20%20this.aoMap%20%3D%20null%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%201%3B%0A%20%20%20%20this.emissive%20%3D%20new%20Color%280%29%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%201%3B%0A%20%20%20%20this.emissiveMap%20%3D%20null%3B%0A%20%20%20%20this.bumpMap%20%3D%20null%3B%0A%20%20%20%20this.bumpScale%20%3D%201%3B%0A%20%20%20%20this.normalMap%20%3D%20null%3B%0A%20%20%20%20this.normalMapType%20%3D%20TangentSpaceNormalMap%3B%0A%20%20%20%20this.normalScale%20%3D%20new%20Vector2%281%2C%201%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20null%3B%0A%20%20%20%20this.displacementScale%20%3D%201%3B%0A%20%20%20%20this.displacementBias%20%3D%200%3B%0A%20%20%20%20this.specularMap%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.envMap%20%3D%20null%3B%0A%20%20%20%20this.envMapRotation%20%3D%20new%20Euler%28%29%3B%0A%20%20%20%20this.combine%20%3D%20MultiplyOperation%3B%0A%20%20%20%20this.reflectivity%20%3D%201%3B%0A%20%20%20%20this.refractionRatio%20%3D%200.98%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20%22round%22%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20%22round%22%3B%0A%20%20%20%20this.flatShading%20%3D%20false%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.lightMap%20%3D%20source.lightMap%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%20source.lightMapIntensity%3B%0A%20%20%20%20this.aoMap%20%3D%20source.aoMap%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%20source.aoMapIntensity%3B%0A%20%20%20%20this.emissive.copy%28source.emissive%29%3B%0A%20%20%20%20this.emissiveMap%20%3D%20source.emissiveMap%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%20source.emissiveIntensity%3B%0A%20%20%20%20this.bumpMap%20%3D%20source.bumpMap%3B%0A%20%20%20%20this.bumpScale%20%3D%20source.bumpScale%3B%0A%20%20%20%20this.normalMap%20%3D%20source.normalMap%3B%0A%20%20%20%20this.normalMapType%20%3D%20source.normalMapType%3B%0A%20%20%20%20this.normalScale.copy%28source.normalScale%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20source.displacementMap%3B%0A%20%20%20%20this.displacementScale%20%3D%20source.displacementScale%3B%0A%20%20%20%20this.displacementBias%20%3D%20source.displacementBias%3B%0A%20%20%20%20this.specularMap%20%3D%20source.specularMap%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.envMap%20%3D%20source.envMap%3B%0A%20%20%20%20this.envMapRotation.copy%28source.envMapRotation%29%3B%0A%20%20%20%20this.combine%20%3D%20source.combine%3B%0A%20%20%20%20this.reflectivity%20%3D%20source.reflectivity%3B%0A%20%20%20%20this.refractionRatio%20%3D%20source.refractionRatio%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20source.wireframeLinecap%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20source.wireframeLinejoin%3B%0A%20%20%20%20this.flatShading%20%3D%20source.flatShading%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20convertArray%28array%2C%20type%2C%20forceClone%29%20%7B%0A%20%20if%20%28%21array%20%7C%7C%20%2F%2F%20let%20%27undefined%27%20and%20%27null%27%20pass%0A%20%20%21forceClone%20%26%26%20array.constructor%20%3D%3D%3D%20type%29%20return%20array%3B%0A%20%20if%20%28typeof%20type.BYTES_PER_ELEMENT%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20return%20new%20type%28array%29%3B%0A%20%20%7D%0A%20%20return%20Array.prototype.slice.call%28array%29%3B%0A%7D%0Afunction%20isTypedArray%28object%29%20%7B%0A%20%20return%20ArrayBuffer.isView%28object%29%20%26%26%20%21%28object%20instanceof%20DataView%29%3B%0A%7D%0Avar%20Interpolant%20%3D%20class%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20this.parameterPositions%20%3D%20parameterPositions%3B%0A%20%20%20%20this._cachedIndex%20%3D%200%3B%0A%20%20%20%20this.resultBuffer%20%3D%20resultBuffer%20%21%3D%3D%20void%200%20%3F%20resultBuffer%20%3A%20new%20sampleValues.constructor%28sampleSize%29%3B%0A%20%20%20%20this.sampleValues%20%3D%20sampleValues%3B%0A%20%20%20%20this.valueSize%20%3D%20sampleSize%3B%0A%20%20%20%20this.settings%20%3D%20null%3B%0A%20%20%20%20this.DefaultSettings_%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20evaluate%28t%29%20%7B%0A%20%20%20%20const%20pp%20%3D%20this.parameterPositions%3B%0A%20%20%20%20let%20i1%20%3D%20this._cachedIndex%2C%20t1%20%3D%20pp%5Bi1%5D%2C%20t0%20%3D%20pp%5Bi1%20-%201%5D%3B%0A%20%20%20%20validate_interval%3A%20%7B%0A%20%20%20%20%20%20seek%3A%20%7B%0A%20%20%20%20%20%20%20%20let%20right%3B%0A%20%20%20%20%20%20%20%20linear_scan%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20forward_scan%3A%20if%20%28%21%28t%20%3C%20t1%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20giveUpAt%20%3D%20i1%20%2B%202%3B%20%3B%20%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t1%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20t0%29%20break%20forward_scan%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i1%20%3D%20pp.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._cachedIndex%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20this.copySampleValue_%28i1%20-%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28i1%20%3D%3D%3D%20giveUpAt%29%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t0%20%3D%20t1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t1%20%3D%20pp%5B%2B%2Bi1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20t1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%20seek%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20right%20%3D%20pp.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%20linear_scan%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21%28t%20%3E%3D%20t0%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20t1global%20%3D%20pp%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20t1global%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20i1%20%3D%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t0%20%3D%20t1global%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20giveUpAt%20%3D%20i1%20-%202%3B%20%3B%20%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t0%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._cachedIndex%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20this.copySampleValue_%280%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28i1%20%3D%3D%3D%20giveUpAt%29%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t1%20%3D%20t0%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t0%20%3D%20pp%5B--i1%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3E%3D%20t0%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%20seek%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20right%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20i1%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%20linear_scan%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%20validate_interval%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20while%20%28i1%20%3C%20right%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20mid%20%3D%20i1%20%2B%20right%20%3E%3E%3E%201%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20pp%5Bmid%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20right%20%3D%20mid%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20i1%20%3D%20mid%20%2B%201%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20t1%20%3D%20pp%5Bi1%5D%3B%0A%20%20%20%20%20%20%20%20t0%20%3D%20pp%5Bi1%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28t0%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._cachedIndex%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20return%20this.copySampleValue_%280%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28t1%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20i1%20%3D%20pp.length%3B%0A%20%20%20%20%20%20%20%20%20%20this._cachedIndex%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20return%20this.copySampleValue_%28i1%20-%201%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._cachedIndex%20%3D%20i1%3B%0A%20%20%20%20%20%20this.intervalChanged_%28i1%2C%20t0%2C%20t1%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.interpolate_%28i1%2C%20t0%2C%20t%2C%20t1%29%3B%0A%20%20%7D%0A%20%20getSettings_%28%29%20%7B%0A%20%20%20%20return%20this.settings%20%7C%7C%20this.DefaultSettings_%3B%0A%20%20%7D%0A%20%20copySampleValue_%28index5%29%20%7B%0A%20%20%20%20const%20result%20%3D%20this.resultBuffer%2C%20values%20%3D%20this.sampleValues%2C%20stride%20%3D%20this.valueSize%2C%20offset%20%3D%20index5%20%2A%20stride%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20stride%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20result%5Bi%5D%20%3D%20values%5Boffset%20%2B%20i%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20%2F%2F%20Template%20methods%20for%20derived%20classes%3A%0A%20%20interpolate_%28%29%20%7B%0A%20%20%20%20throw%20new%20Error%28%22call%20to%20abstract%20method%22%29%3B%0A%20%20%7D%0A%20%20intervalChanged_%28%29%20%7B%0A%20%20%7D%0A%7D%3B%0Avar%20CubicInterpolant%20%3D%20class%20extends%20Interpolant%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20super%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%3B%0A%20%20%20%20this._weightPrev%20%3D%20-0%3B%0A%20%20%20%20this._offsetPrev%20%3D%20-0%3B%0A%20%20%20%20this._weightNext%20%3D%20-0%3B%0A%20%20%20%20this._offsetNext%20%3D%20-0%3B%0A%20%20%20%20this.DefaultSettings_%20%3D%20%7B%0A%20%20%20%20%20%20endingStart%3A%20ZeroCurvatureEnding%2C%0A%20%20%20%20%20%20endingEnd%3A%20ZeroCurvatureEnding%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20intervalChanged_%28i1%2C%20t0%2C%20t1%29%20%7B%0A%20%20%20%20const%20pp%20%3D%20this.parameterPositions%3B%0A%20%20%20%20let%20iPrev%20%3D%20i1%20-%202%2C%20iNext%20%3D%20i1%20%2B%201%2C%20tPrev%20%3D%20pp%5BiPrev%5D%2C%20tNext%20%3D%20pp%5BiNext%5D%3B%0A%20%20%20%20if%20%28tPrev%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20switch%20%28this.getSettings_%28%29.endingStart%29%20%7B%0A%20%20%20%20%20%20%20%20case%20ZeroSlopeEnding%3A%0A%20%20%20%20%20%20%20%20%20%20iPrev%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20tPrev%20%3D%202%20%2A%20t0%20-%20t1%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20WrapAroundEnding%3A%0A%20%20%20%20%20%20%20%20%20%20iPrev%20%3D%20pp.length%20-%202%3B%0A%20%20%20%20%20%20%20%20%20%20tPrev%20%3D%20t0%20%2B%20pp%5BiPrev%5D%20-%20pp%5BiPrev%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20iPrev%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20tPrev%20%3D%20t1%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28tNext%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20switch%20%28this.getSettings_%28%29.endingEnd%29%20%7B%0A%20%20%20%20%20%20%20%20case%20ZeroSlopeEnding%3A%0A%20%20%20%20%20%20%20%20%20%20iNext%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20tNext%20%3D%202%20%2A%20t1%20-%20t0%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20WrapAroundEnding%3A%0A%20%20%20%20%20%20%20%20%20%20iNext%20%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20tNext%20%3D%20t1%20%2B%20pp%5B1%5D%20-%20pp%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20iNext%20%3D%20i1%20-%201%3B%0A%20%20%20%20%20%20%20%20%20%20tNext%20%3D%20t0%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20halfDt%20%3D%20%28t1%20-%20t0%29%20%2A%200.5%2C%20stride%20%3D%20this.valueSize%3B%0A%20%20%20%20this._weightPrev%20%3D%20halfDt%20%2F%20%28t0%20-%20tPrev%29%3B%0A%20%20%20%20this._weightNext%20%3D%20halfDt%20%2F%20%28tNext%20-%20t1%29%3B%0A%20%20%20%20this._offsetPrev%20%3D%20iPrev%20%2A%20stride%3B%0A%20%20%20%20this._offsetNext%20%3D%20iNext%20%2A%20stride%3B%0A%20%20%7D%0A%20%20interpolate_%28i1%2C%20t0%2C%20t%2C%20t1%29%20%7B%0A%20%20%20%20const%20result%20%3D%20this.resultBuffer%2C%20values%20%3D%20this.sampleValues%2C%20stride%20%3D%20this.valueSize%2C%20o1%20%3D%20i1%20%2A%20stride%2C%20o0%20%3D%20o1%20-%20stride%2C%20oP%20%3D%20this._offsetPrev%2C%20oN%20%3D%20this._offsetNext%2C%20wP%20%3D%20this._weightPrev%2C%20wN%20%3D%20this._weightNext%2C%20p%20%3D%20%28t%20-%20t0%29%20%2F%20%28t1%20-%20t0%29%2C%20pp%20%3D%20p%20%2A%20p%2C%20ppp%20%3D%20pp%20%2A%20p%3B%0A%20%20%20%20const%20sP%20%3D%20-wP%20%2A%20ppp%20%2B%202%20%2A%20wP%20%2A%20pp%20-%20wP%20%2A%20p%3B%0A%20%20%20%20const%20s0%20%3D%20%281%20%2B%20wP%29%20%2A%20ppp%20%2B%20%28-1.5%20-%202%20%2A%20wP%29%20%2A%20pp%20%2B%20%28-0.5%20%2B%20wP%29%20%2A%20p%20%2B%201%3B%0A%20%20%20%20const%20s1%20%3D%20%28-1%20-%20wN%29%20%2A%20ppp%20%2B%20%281.5%20%2B%20wN%29%20%2A%20pp%20%2B%200.5%20%2A%20p%3B%0A%20%20%20%20const%20sN%20%3D%20wN%20%2A%20ppp%20-%20wN%20%2A%20pp%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20stride%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20result%5Bi%5D%20%3D%20sP%20%2A%20values%5BoP%20%2B%20i%5D%20%2B%20s0%20%2A%20values%5Bo0%20%2B%20i%5D%20%2B%20s1%20%2A%20values%5Bo1%20%2B%20i%5D%20%2B%20sN%20%2A%20values%5BoN%20%2B%20i%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LinearInterpolant%20%3D%20class%20extends%20Interpolant%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20super%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%3B%0A%20%20%7D%0A%20%20interpolate_%28i1%2C%20t0%2C%20t%2C%20t1%29%20%7B%0A%20%20%20%20const%20result%20%3D%20this.resultBuffer%2C%20values%20%3D%20this.sampleValues%2C%20stride%20%3D%20this.valueSize%2C%20offset1%20%3D%20i1%20%2A%20stride%2C%20offset0%20%3D%20offset1%20-%20stride%2C%20weight1%20%3D%20%28t%20-%20t0%29%20%2F%20%28t1%20-%20t0%29%2C%20weight0%20%3D%201%20-%20weight1%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20stride%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20result%5Bi%5D%20%3D%20values%5Boffset0%20%2B%20i%5D%20%2A%20weight0%20%2B%20values%5Boffset1%20%2B%20i%5D%20%2A%20weight1%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DiscreteInterpolant%20%3D%20class%20extends%20Interpolant%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20super%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%3B%0A%20%20%7D%0A%20%20interpolate_%28i1%29%20%7B%0A%20%20%20%20return%20this.copySampleValue_%28i1%20-%201%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20KeyframeTrack%20%3D%20class%20%7B%0A%20%20constructor%28name%2C%20times%2C%20values%2C%20interpolation%29%20%7B%0A%20%20%20%20if%20%28name%20%3D%3D%3D%20void%200%29%20throw%20new%20Error%28%22THREE.KeyframeTrack%3A%20track%20name%20is%20undefined%22%29%3B%0A%20%20%20%20if%20%28times%20%3D%3D%3D%20void%200%20%7C%7C%20times.length%20%3D%3D%3D%200%29%20throw%20new%20Error%28%22THREE.KeyframeTrack%3A%20no%20keyframes%20in%20track%20named%20%22%20%2B%20name%29%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.times%20%3D%20convertArray%28times%2C%20this.TimeBufferType%29%3B%0A%20%20%20%20this.values%20%3D%20convertArray%28values%2C%20this.ValueBufferType%29%3B%0A%20%20%20%20this.setInterpolation%28interpolation%20%7C%7C%20this.DefaultInterpolation%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20Serialization%20%28in%20static%20context%2C%20because%20of%20constructor%20invocation%0A%20%20%2F%2F%20and%20automatic%20invocation%20of%20.toJSON%29%3A%0A%20%20static%20toJSON%28track%29%20%7B%0A%20%20%20%20const%20trackType%20%3D%20track.constructor%3B%0A%20%20%20%20let%20json%3B%0A%20%20%20%20if%20%28trackType.toJSON%20%21%3D%3D%20this.toJSON%29%20%7B%0A%20%20%20%20%20%20json%20%3D%20trackType.toJSON%28track%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20json%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22name%22%3A%20track.name%2C%0A%20%20%20%20%20%20%20%20%22times%22%3A%20convertArray%28track.times%2C%20Array%29%2C%0A%20%20%20%20%20%20%20%20%22values%22%3A%20convertArray%28track.values%2C%20Array%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20const%20interpolation%20%3D%20track.getInterpolation%28%29%3B%0A%20%20%20%20%20%20if%20%28interpolation%20%21%3D%3D%20track.DefaultInterpolation%29%20%7B%0A%20%20%20%20%20%20%20%20json.interpolation%20%3D%20interpolation%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20json.type%20%3D%20track.ValueTypeName%3B%0A%20%20%20%20return%20json%3B%0A%20%20%7D%0A%20%20InterpolantFactoryMethodDiscrete%28result%29%20%7B%0A%20%20%20%20return%20new%20DiscreteInterpolant%28this.times%2C%20this.values%2C%20this.getValueSize%28%29%2C%20result%29%3B%0A%20%20%7D%0A%20%20InterpolantFactoryMethodLinear%28result%29%20%7B%0A%20%20%20%20return%20new%20LinearInterpolant%28this.times%2C%20this.values%2C%20this.getValueSize%28%29%2C%20result%29%3B%0A%20%20%7D%0A%20%20InterpolantFactoryMethodSmooth%28result%29%20%7B%0A%20%20%20%20return%20new%20CubicInterpolant%28this.times%2C%20this.values%2C%20this.getValueSize%28%29%2C%20result%29%3B%0A%20%20%7D%0A%20%20setInterpolation%28interpolation%29%20%7B%0A%20%20%20%20let%20factoryMethod%3B%0A%20%20%20%20switch%20%28interpolation%29%20%7B%0A%20%20%20%20%20%20case%20InterpolateDiscrete%3A%0A%20%20%20%20%20%20%20%20factoryMethod%20%3D%20this.InterpolantFactoryMethodDiscrete%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20InterpolateLinear%3A%0A%20%20%20%20%20%20%20%20factoryMethod%20%3D%20this.InterpolantFactoryMethodLinear%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20InterpolateSmooth%3A%0A%20%20%20%20%20%20%20%20factoryMethod%20%3D%20this.InterpolantFactoryMethodSmooth%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28factoryMethod%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20message%20%3D%20%22unsupported%20interpolation%20for%20%22%20%2B%20this.ValueTypeName%20%2B%20%22%20keyframe%20track%20named%20%22%20%2B%20this.name%3B%0A%20%20%20%20%20%20if%20%28this.createInterpolant%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28interpolation%20%21%3D%3D%20this.DefaultInterpolation%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.setInterpolation%28this.DefaultInterpolation%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28message%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20console.warn%28%22THREE.KeyframeTrack%3A%22%2C%20message%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.createInterpolant%20%3D%20factoryMethod%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getInterpolation%28%29%20%7B%0A%20%20%20%20switch%20%28this.createInterpolant%29%20%7B%0A%20%20%20%20%20%20case%20this.InterpolantFactoryMethodDiscrete%3A%0A%20%20%20%20%20%20%20%20return%20InterpolateDiscrete%3B%0A%20%20%20%20%20%20case%20this.InterpolantFactoryMethodLinear%3A%0A%20%20%20%20%20%20%20%20return%20InterpolateLinear%3B%0A%20%20%20%20%20%20case%20this.InterpolantFactoryMethodSmooth%3A%0A%20%20%20%20%20%20%20%20return%20InterpolateSmooth%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getValueSize%28%29%20%7B%0A%20%20%20%20return%20this.values.length%20%2F%20this.times.length%3B%0A%20%20%7D%0A%20%20%2F%2F%20move%20all%20keyframes%20either%20forwards%20or%20backwards%20in%20time%0A%20%20shift%28timeOffset%29%20%7B%0A%20%20%20%20if%20%28timeOffset%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20const%20times%20%3D%20this.times%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20times.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20times%5Bi%5D%20%2B%3D%20timeOffset%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20scale%20all%20keyframe%20times%20by%20a%20factor%20%28useful%20for%20frame%20%3C-%3E%20seconds%20conversions%29%0A%20%20scale%28timeScale%29%20%7B%0A%20%20%20%20if%20%28timeScale%20%21%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20const%20times%20%3D%20this.times%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20times.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20times%5Bi%5D%20%2A%3D%20timeScale%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20removes%20keyframes%20before%20and%20after%20animation%20without%20changing%20any%20values%20within%20the%20range%20%5BstartTime%2C%20endTime%5D.%0A%20%20%2F%2F%20IMPORTANT%3A%20We%20do%20not%20shift%20around%20keys%20to%20the%20start%20of%20the%20track%20time%2C%20because%20for%20interpolated%20keys%20this%20will%20change%20their%20values%0A%20%20trim%28startTime%2C%20endTime%29%20%7B%0A%20%20%20%20const%20times%20%3D%20this.times%2C%20nKeys%20%3D%20times.length%3B%0A%20%20%20%20let%20from%20%3D%200%2C%20to%20%3D%20nKeys%20-%201%3B%0A%20%20%20%20while%20%28from%20%21%3D%3D%20nKeys%20%26%26%20times%5Bfrom%5D%20%3C%20startTime%29%20%7B%0A%20%20%20%20%20%20%2B%2Bfrom%3B%0A%20%20%20%20%7D%0A%20%20%20%20while%20%28to%20%21%3D%3D%20-1%20%26%26%20times%5Bto%5D%20%3E%20endTime%29%20%7B%0A%20%20%20%20%20%20--to%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2B%2Bto%3B%0A%20%20%20%20if%20%28from%20%21%3D%3D%200%20%7C%7C%20to%20%21%3D%3D%20nKeys%29%20%7B%0A%20%20%20%20%20%20if%20%28from%20%3E%3D%20to%29%20%7B%0A%20%20%20%20%20%20%20%20to%20%3D%20Math.max%28to%2C%201%29%3B%0A%20%20%20%20%20%20%20%20from%20%3D%20to%20-%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20stride%20%3D%20this.getValueSize%28%29%3B%0A%20%20%20%20%20%20this.times%20%3D%20times.slice%28from%2C%20to%29%3B%0A%20%20%20%20%20%20this.values%20%3D%20this.values.slice%28from%20%2A%20stride%2C%20to%20%2A%20stride%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20ensure%20we%20do%20not%20get%20a%20GarbageInGarbageOut%20situation%2C%20make%20sure%20tracks%20are%20at%20least%20minimally%20viable%0A%20%20validate%28%29%20%7B%0A%20%20%20%20let%20valid%20%3D%20true%3B%0A%20%20%20%20const%20valueSize%20%3D%20this.getValueSize%28%29%3B%0A%20%20%20%20if%20%28valueSize%20-%20Math.floor%28valueSize%29%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Invalid%20value%20size%20in%20track.%22%2C%20this%29%3B%0A%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20times%20%3D%20this.times%2C%20values%20%3D%20this.values%2C%20nKeys%20%3D%20times.length%3B%0A%20%20%20%20if%20%28nKeys%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Track%20is%20empty.%22%2C%20this%29%3B%0A%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20prevTime%20%3D%20null%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20nKeys%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20currTime%20%3D%20times%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28typeof%20currTime%20%3D%3D%3D%20%22number%22%20%26%26%20isNaN%28currTime%29%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Time%20is%20not%20a%20valid%20number.%22%2C%20this%2C%20i%2C%20currTime%29%3B%0A%20%20%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28prevTime%20%21%3D%3D%20null%20%26%26%20prevTime%20%3E%20currTime%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Out%20of%20order%20keys.%22%2C%20this%2C%20i%2C%20currTime%2C%20prevTime%29%3B%0A%20%20%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20prevTime%20%3D%20currTime%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28values%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28isTypedArray%28values%29%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20values.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20value%20%3D%20values%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28isNaN%28value%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Value%20is%20not%20a%20valid%20number.%22%2C%20this%2C%20i%2C%20value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20valid%3B%0A%20%20%7D%0A%20%20%2F%2F%20removes%20equivalent%20sequential%20keys%20as%20common%20in%20morph%20target%20sequences%0A%20%20%2F%2F%20%280%2C0%2C0%2C0%2C1%2C1%2C1%2C0%2C0%2C0%2C0%2C0%2C0%2C0%29%20--%3E%20%280%2C0%2C1%2C1%2C0%2C0%29%0A%20%20optimize%28%29%20%7B%0A%20%20%20%20const%20times%20%3D%20this.times.slice%28%29%2C%20values%20%3D%20this.values.slice%28%29%2C%20stride%20%3D%20this.getValueSize%28%29%2C%20smoothInterpolation%20%3D%20this.getInterpolation%28%29%20%3D%3D%3D%20InterpolateSmooth%2C%20lastIndex%20%3D%20times.length%20-%201%3B%0A%20%20%20%20let%20writeIndex%20%3D%201%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%20lastIndex%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20let%20keep%20%3D%20false%3B%0A%20%20%20%20%20%20const%20time%20%3D%20times%5Bi%5D%3B%0A%20%20%20%20%20%20const%20timeNext%20%3D%20times%5Bi%20%2B%201%5D%3B%0A%20%20%20%20%20%20if%20%28time%20%21%3D%3D%20timeNext%20%26%26%20%28i%20%21%3D%3D%201%20%7C%7C%20time%20%21%3D%3D%20times%5B0%5D%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21smoothInterpolation%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20offset%20%3D%20i%20%2A%20stride%2C%20offsetP%20%3D%20offset%20-%20stride%2C%20offsetN%20%3D%20offset%20%2B%20stride%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%21%3D%3D%20stride%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20value%20%3D%20values%5Boffset%20%2B%20j%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20values%5BoffsetP%20%2B%20j%5D%20%7C%7C%20value%20%21%3D%3D%20values%5BoffsetN%20%2B%20j%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20keep%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20keep%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28keep%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28i%20%21%3D%3D%20writeIndex%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20times%5BwriteIndex%5D%20%3D%20times%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20readOffset%20%3D%20i%20%2A%20stride%2C%20writeOffset%20%3D%20writeIndex%20%2A%20stride%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%21%3D%3D%20stride%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20values%5BwriteOffset%20%2B%20j%5D%20%3D%20values%5BreadOffset%20%2B%20j%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2B%2BwriteIndex%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28lastIndex%20%3E%200%29%20%7B%0A%20%20%20%20%20%20times%5BwriteIndex%5D%20%3D%20times%5BlastIndex%5D%3B%0A%20%20%20%20%20%20for%20%28let%20readOffset%20%3D%20lastIndex%20%2A%20stride%2C%20writeOffset%20%3D%20writeIndex%20%2A%20stride%2C%20j%20%3D%200%3B%20j%20%21%3D%3D%20stride%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20%20%20values%5BwriteOffset%20%2B%20j%5D%20%3D%20values%5BreadOffset%20%2B%20j%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%2B%2BwriteIndex%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28writeIndex%20%21%3D%3D%20times.length%29%20%7B%0A%20%20%20%20%20%20this.times%20%3D%20times.slice%280%2C%20writeIndex%29%3B%0A%20%20%20%20%20%20this.values%20%3D%20values.slice%280%2C%20writeIndex%20%2A%20stride%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.times%20%3D%20times%3B%0A%20%20%20%20%20%20this.values%20%3D%20values%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20const%20times%20%3D%20this.times.slice%28%29%3B%0A%20%20%20%20const%20values%20%3D%20this.values.slice%28%29%3B%0A%20%20%20%20const%20TypedKeyframeTrack%20%3D%20this.constructor%3B%0A%20%20%20%20const%20track%20%3D%20new%20TypedKeyframeTrack%28this.name%2C%20times%2C%20values%29%3B%0A%20%20%20%20track.createInterpolant%20%3D%20this.createInterpolant%3B%0A%20%20%20%20return%20track%3B%0A%20%20%7D%0A%7D%3B%0AKeyframeTrack.prototype.TimeBufferType%20%3D%20Float32Array%3B%0AKeyframeTrack.prototype.ValueBufferType%20%3D%20Float32Array%3B%0AKeyframeTrack.prototype.DefaultInterpolation%20%3D%20InterpolateLinear%3B%0Avar%20BooleanKeyframeTrack%20%3D%20class%20extends%20KeyframeTrack%20%7B%0A%20%20%2F%2F%20No%20interpolation%20parameter%20because%20only%20InterpolateDiscrete%20is%20valid.%0A%20%20constructor%28name%2C%20times%2C%20values%29%20%7B%0A%20%20%20%20super%28name%2C%20times%2C%20values%29%3B%0A%20%20%7D%0A%7D%3B%0ABooleanKeyframeTrack.prototype.ValueTypeName%20%3D%20%22bool%22%3B%0ABooleanKeyframeTrack.prototype.ValueBufferType%20%3D%20Array%3B%0ABooleanKeyframeTrack.prototype.DefaultInterpolation%20%3D%20InterpolateDiscrete%3B%0ABooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear%20%3D%20void%200%3B%0ABooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth%20%3D%20void%200%3B%0Avar%20ColorKeyframeTrack%20%3D%20class%20extends%20KeyframeTrack%20%7B%0A%7D%3B%0AColorKeyframeTrack.prototype.ValueTypeName%20%3D%20%22color%22%3B%0Avar%20NumberKeyframeTrack%20%3D%20class%20extends%20KeyframeTrack%20%7B%0A%7D%3B%0ANumberKeyframeTrack.prototype.ValueTypeName%20%3D%20%22number%22%3B%0Avar%20QuaternionLinearInterpolant%20%3D%20class%20extends%20Interpolant%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20super%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%3B%0A%20%20%7D%0A%20%20interpolate_%28i1%2C%20t0%2C%20t%2C%20t1%29%20%7B%0A%20%20%20%20const%20result%20%3D%20this.resultBuffer%2C%20values%20%3D%20this.sampleValues%2C%20stride%20%3D%20this.valueSize%2C%20alpha%20%3D%20%28t%20-%20t0%29%20%2F%20%28t1%20-%20t0%29%3B%0A%20%20%20%20let%20offset%20%3D%20i1%20%2A%20stride%3B%0A%20%20%20%20for%20%28let%20end%20%3D%20offset%20%2B%20stride%3B%20offset%20%21%3D%3D%20end%3B%20offset%20%2B%3D%204%29%20%7B%0A%20%20%20%20%20%20Quaternion.slerpFlat%28result%2C%200%2C%20values%2C%20offset%20-%20stride%2C%20values%2C%20offset%2C%20alpha%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%7D%3B%0Avar%20QuaternionKeyframeTrack%20%3D%20class%20extends%20KeyframeTrack%20%7B%0A%20%20InterpolantFactoryMethodLinear%28result%29%20%7B%0A%20%20%20%20return%20new%20QuaternionLinearInterpolant%28this.times%2C%20this.values%2C%20this.getValueSize%28%29%2C%20result%29%3B%0A%20%20%7D%0A%7D%3B%0AQuaternionKeyframeTrack.prototype.ValueTypeName%20%3D%20%22quaternion%22%3B%0AQuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth%20%3D%20void%200%3B%0Avar%20StringKeyframeTrack%20%3D%20class%20extends%20KeyframeTrack%20%7B%0A%20%20%2F%2F%20No%20interpolation%20parameter%20because%20only%20InterpolateDiscrete%20is%20valid.%0A%20%20constructor%28name%2C%20times%2C%20values%29%20%7B%0A%20%20%20%20super%28name%2C%20times%2C%20values%29%3B%0A%20%20%7D%0A%7D%3B%0AStringKeyframeTrack.prototype.ValueTypeName%20%3D%20%22string%22%3B%0AStringKeyframeTrack.prototype.ValueBufferType%20%3D%20Array%3B%0AStringKeyframeTrack.prototype.DefaultInterpolation%20%3D%20InterpolateDiscrete%3B%0AStringKeyframeTrack.prototype.InterpolantFactoryMethodLinear%20%3D%20void%200%3B%0AStringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth%20%3D%20void%200%3B%0Avar%20VectorKeyframeTrack%20%3D%20class%20extends%20KeyframeTrack%20%7B%0A%7D%3B%0AVectorKeyframeTrack.prototype.ValueTypeName%20%3D%20%22vector%22%3B%0Avar%20Cache%20%3D%20%7B%0A%20%20enabled%3A%20false%2C%0A%20%20files%3A%20%7B%7D%2C%0A%20%20add%3A%20function%28key%2C%20file%29%20%7B%0A%20%20%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20this.files%5Bkey%5D%20%3D%20file%3B%0A%20%20%7D%2C%0A%20%20get%3A%20function%28key%29%20%7B%0A%20%20%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20return%20this.files%5Bkey%5D%3B%0A%20%20%7D%2C%0A%20%20remove%3A%20function%28key%29%20%7B%0A%20%20%20%20delete%20this.files%5Bkey%5D%3B%0A%20%20%7D%2C%0A%20%20clear%3A%20function%28%29%20%7B%0A%20%20%20%20this.files%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LoadingManager%20%3D%20class%20%7B%0A%20%20constructor%28onLoad%2C%20onProgress%2C%20onError%29%20%7B%0A%20%20%20%20const%20scope%20%3D%20this%3B%0A%20%20%20%20let%20isLoading%20%3D%20false%3B%0A%20%20%20%20let%20itemsLoaded%20%3D%200%3B%0A%20%20%20%20let%20itemsTotal%20%3D%200%3B%0A%20%20%20%20let%20urlModifier%20%3D%20void%200%3B%0A%20%20%20%20const%20handlers%20%3D%20%5B%5D%3B%0A%20%20%20%20this.onStart%20%3D%20void%200%3B%0A%20%20%20%20this.onLoad%20%3D%20onLoad%3B%0A%20%20%20%20this.onProgress%20%3D%20onProgress%3B%0A%20%20%20%20this.onError%20%3D%20onError%3B%0A%20%20%20%20this.itemStart%20%3D%20function%28url%29%20%7B%0A%20%20%20%20%20%20itemsTotal%2B%2B%3B%0A%20%20%20%20%20%20if%20%28isLoading%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28scope.onStart%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20scope.onStart%28url%2C%20itemsLoaded%2C%20itemsTotal%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20isLoading%20%3D%20true%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.itemEnd%20%3D%20function%28url%29%20%7B%0A%20%20%20%20%20%20itemsLoaded%2B%2B%3B%0A%20%20%20%20%20%20if%20%28scope.onProgress%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20scope.onProgress%28url%2C%20itemsLoaded%2C%20itemsTotal%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28itemsLoaded%20%3D%3D%3D%20itemsTotal%29%20%7B%0A%20%20%20%20%20%20%20%20isLoading%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20if%20%28scope.onLoad%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20scope.onLoad%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.itemError%20%3D%20function%28url%29%20%7B%0A%20%20%20%20%20%20if%20%28scope.onError%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20scope.onError%28url%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.resolveURL%20%3D%20function%28url%29%20%7B%0A%20%20%20%20%20%20if%20%28urlModifier%29%20%7B%0A%20%20%20%20%20%20%20%20return%20urlModifier%28url%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20url%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setURLModifier%20%3D%20function%28transform%29%20%7B%0A%20%20%20%20%20%20urlModifier%20%3D%20transform%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.addHandler%20%3D%20function%28regex%2C%20loader%29%20%7B%0A%20%20%20%20%20%20handlers.push%28regex%2C%20loader%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.removeHandler%20%3D%20function%28regex%29%20%7B%0A%20%20%20%20%20%20const%20index5%20%3D%20handlers.indexOf%28regex%29%3B%0A%20%20%20%20%20%20if%20%28index5%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20handlers.splice%28index5%2C%202%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getHandler%20%3D%20function%28file%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20handlers.length%3B%20i%20%3C%20l%3B%20i%20%2B%3D%202%29%20%7B%0A%20%20%20%20%20%20%20%20const%20regex%20%3D%20handlers%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20loader%20%3D%20handlers%5Bi%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28regex.global%29%20regex.lastIndex%20%3D%200%3B%0A%20%20%20%20%20%20%20%20if%20%28regex.test%28file%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20loader%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DefaultLoadingManager%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20LoadingManager%28%29%3B%0Avar%20Loader%20%3D%20class%20%7B%0A%20%20constructor%28manager%29%20%7B%0A%20%20%20%20this.manager%20%3D%20manager%20%21%3D%3D%20void%200%20%3F%20manager%20%3A%20DefaultLoadingManager%3B%0A%20%20%20%20this.crossOrigin%20%3D%20%22anonymous%22%3B%0A%20%20%20%20this.withCredentials%20%3D%20false%3B%0A%20%20%20%20this.path%20%3D%20%22%22%3B%0A%20%20%20%20this.resourcePath%20%3D%20%22%22%3B%0A%20%20%20%20this.requestHeader%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20load%28%29%20%7B%0A%20%20%7D%0A%20%20loadAsync%28url%2C%20onProgress%29%20%7B%0A%20%20%20%20const%20scope%20%3D%20this%3B%0A%20%20%20%20return%20new%20Promise%28function%28resolve%2C%20reject%29%20%7B%0A%20%20%20%20%20%20scope.load%28url%2C%20resolve%2C%20onProgress%2C%20reject%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20parse%28%29%20%7B%0A%20%20%7D%0A%20%20setCrossOrigin%28crossOrigin%29%20%7B%0A%20%20%20%20this.crossOrigin%20%3D%20crossOrigin%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setWithCredentials%28value%29%20%7B%0A%20%20%20%20this.withCredentials%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setPath%28path%29%20%7B%0A%20%20%20%20this.path%20%3D%20path%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setResourcePath%28resourcePath%29%20%7B%0A%20%20%20%20this.resourcePath%20%3D%20resourcePath%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setRequestHeader%28requestHeader%29%20%7B%0A%20%20%20%20this.requestHeader%20%3D%20requestHeader%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0ALoader.DEFAULT_MATERIAL_NAME%20%3D%20%22__DEFAULT%22%3B%0Avar%20ImageLoader%20%3D%20class%20extends%20Loader%20%7B%0A%20%20constructor%28manager%29%20%7B%0A%20%20%20%20super%28manager%29%3B%0A%20%20%7D%0A%20%20load%28url%2C%20onLoad%2C%20onProgress%2C%20onError%29%20%7B%0A%20%20%20%20if%20%28this.path%20%21%3D%3D%20void%200%29%20url%20%3D%20this.path%20%2B%20url%3B%0A%20%20%20%20url%20%3D%20this.manager.resolveURL%28url%29%3B%0A%20%20%20%20const%20scope%20%3D%20this%3B%0A%20%20%20%20const%20cached%20%3D%20Cache.get%28url%29%3B%0A%20%20%20%20if%20%28cached%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20scope.manager.itemStart%28url%29%3B%0A%20%20%20%20%20%20setTimeout%28function%28%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28onLoad%29%20onLoad%28cached%29%3B%0A%20%20%20%20%20%20%20%20scope.manager.itemEnd%28url%29%3B%0A%20%20%20%20%20%20%7D%2C%200%29%3B%0A%20%20%20%20%20%20return%20cached%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20image%20%3D%20createElementNS%28%22img%22%29%3B%0A%20%20%20%20function%20onImageLoad%28%29%20%7B%0A%20%20%20%20%20%20removeEventListeners%28%29%3B%0A%20%20%20%20%20%20Cache.add%28url%2C%20this%29%3B%0A%20%20%20%20%20%20if%20%28onLoad%29%20onLoad%28this%29%3B%0A%20%20%20%20%20%20scope.manager.itemEnd%28url%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20onImageError%28event%29%20%7B%0A%20%20%20%20%20%20removeEventListeners%28%29%3B%0A%20%20%20%20%20%20if%20%28onError%29%20onError%28event%29%3B%0A%20%20%20%20%20%20scope.manager.itemError%28url%29%3B%0A%20%20%20%20%20%20scope.manager.itemEnd%28url%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20removeEventListeners%28%29%20%7B%0A%20%20%20%20%20%20image.removeEventListener%28%22load%22%2C%20onImageLoad%2C%20false%29%3B%0A%20%20%20%20%20%20image.removeEventListener%28%22error%22%2C%20onImageError%2C%20false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20image.addEventListener%28%22load%22%2C%20onImageLoad%2C%20false%29%3B%0A%20%20%20%20image.addEventListener%28%22error%22%2C%20onImageError%2C%20false%29%3B%0A%20%20%20%20if%20%28url.slice%280%2C%205%29%20%21%3D%3D%20%22data%3A%22%29%20%7B%0A%20%20%20%20%20%20if%20%28this.crossOrigin%20%21%3D%3D%20void%200%29%20image.crossOrigin%20%3D%20this.crossOrigin%3B%0A%20%20%20%20%7D%0A%20%20%20%20scope.manager.itemStart%28url%29%3B%0A%20%20%20%20image.src%20%3D%20url%3B%0A%20%20%20%20return%20image%3B%0A%20%20%7D%0A%7D%3B%0Avar%20TextureLoader%20%3D%20class%20extends%20Loader%20%7B%0A%20%20constructor%28manager%29%20%7B%0A%20%20%20%20super%28manager%29%3B%0A%20%20%7D%0A%20%20load%28url%2C%20onLoad%2C%20onProgress%2C%20onError%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20new%20Texture%28%29%3B%0A%20%20%20%20const%20loader%20%3D%20new%20ImageLoader%28this.manager%29%3B%0A%20%20%20%20loader.setCrossOrigin%28this.crossOrigin%29%3B%0A%20%20%20%20loader.setPath%28this.path%29%3B%0A%20%20%20%20loader.load%28url%2C%20function%28image%29%20%7B%0A%20%20%20%20%20%20texture2.image%20%3D%20image%3B%0A%20%20%20%20%20%20texture2.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20if%20%28onLoad%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20onLoad%28texture2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%20onProgress%2C%20onError%29%3B%0A%20%20%20%20return%20texture2%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Light%20%3D%20class%20extends%20Object3D%20%7B%0A%20%20constructor%28color2%2C%20intensity%20%3D%201%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Light%22%3B%0A%20%20%20%20this.color%20%3D%20new%20Color%28color2%29%3B%0A%20%20%20%20this.intensity%20%3D%20intensity%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.intensity%20%3D%20source.intensity%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.object.color%20%3D%20this.color.getHex%28%29%3B%0A%20%20%20%20data.object.intensity%20%3D%20this.intensity%3B%0A%20%20%20%20if%20%28this.groundColor%20%21%3D%3D%20void%200%29%20data.object.groundColor%20%3D%20this.groundColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.distance%20%21%3D%3D%20void%200%29%20data.object.distance%20%3D%20this.distance%3B%0A%20%20%20%20if%20%28this.angle%20%21%3D%3D%20void%200%29%20data.object.angle%20%3D%20this.angle%3B%0A%20%20%20%20if%20%28this.decay%20%21%3D%3D%20void%200%29%20data.object.decay%20%3D%20this.decay%3B%0A%20%20%20%20if%20%28this.penumbra%20%21%3D%3D%20void%200%29%20data.object.penumbra%20%3D%20this.penumbra%3B%0A%20%20%20%20if%20%28this.shadow%20%21%3D%3D%20void%200%29%20data.object.shadow%20%3D%20this.shadow.toJSON%28%29%3B%0A%20%20%20%20if%20%28this.target%20%21%3D%3D%20void%200%29%20data.object.target%20%3D%20this.target.uuid%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_projScreenMatrix%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Avar%20_lightPositionWorld%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20_lookTarget%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector3%28%29%3B%0Avar%20LightShadow%20%3D%20class%20%7B%0A%20%20constructor%28camera3%29%20%7B%0A%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%20%20this.intensity%20%3D%201%3B%0A%20%20%20%20this.bias%20%3D%200%3B%0A%20%20%20%20this.normalBias%20%3D%200%3B%0A%20%20%20%20this.radius%20%3D%201%3B%0A%20%20%20%20this.blurSamples%20%3D%208%3B%0A%20%20%20%20this.mapSize%20%3D%20new%20Vector2%28512%2C%20512%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.mapPass%20%3D%20null%3B%0A%20%20%20%20this.matrix%20%3D%20new%20Matrix4%28%29%3B%0A%20%20%20%20this.autoUpdate%20%3D%20true%3B%0A%20%20%20%20this.needsUpdate%20%3D%20false%3B%0A%20%20%20%20this._frustum%20%3D%20new%20Frustum%28%29%3B%0A%20%20%20%20this._frameExtents%20%3D%20new%20Vector2%281%2C%201%29%3B%0A%20%20%20%20this._viewportCount%20%3D%201%3B%0A%20%20%20%20this._viewports%20%3D%20%5B%0A%20%20%20%20%20%20new%20Vector4%280%2C%200%2C%201%2C%201%29%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%20%20getViewportCount%28%29%20%7B%0A%20%20%20%20return%20this._viewportCount%3B%0A%20%20%7D%0A%20%20getFrustum%28%29%20%7B%0A%20%20%20%20return%20this._frustum%3B%0A%20%20%7D%0A%20%20updateMatrices%28light%29%20%7B%0A%20%20%20%20const%20shadowCamera%20%3D%20this.camera%3B%0A%20%20%20%20const%20shadowMatrix%20%3D%20this.matrix%3B%0A%20%20%20%20_lightPositionWorld%241.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20shadowCamera.position.copy%28_lightPositionWorld%241%29%3B%0A%20%20%20%20_lookTarget%241.setFromMatrixPosition%28light.target.matrixWorld%29%3B%0A%20%20%20%20shadowCamera.lookAt%28_lookTarget%241%29%3B%0A%20%20%20%20shadowCamera.updateMatrixWorld%28%29%3B%0A%20%20%20%20_projScreenMatrix%241.multiplyMatrices%28shadowCamera.projectionMatrix%2C%20shadowCamera.matrixWorldInverse%29%3B%0A%20%20%20%20this._frustum.setFromProjectionMatrix%28_projScreenMatrix%241%29%3B%0A%20%20%20%20shadowMatrix.set%28%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20shadowMatrix.multiply%28_projScreenMatrix%241%29%3B%0A%20%20%7D%0A%20%20getViewport%28viewportIndex%29%20%7B%0A%20%20%20%20return%20this._viewports%5BviewportIndex%5D%3B%0A%20%20%7D%0A%20%20getFrameExtents%28%29%20%7B%0A%20%20%20%20return%20this._frameExtents%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20if%20%28this.map%29%20%7B%0A%20%20%20%20%20%20this.map.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.mapPass%29%20%7B%0A%20%20%20%20%20%20this.mapPass.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.camera%20%3D%20source.camera.clone%28%29%3B%0A%20%20%20%20this.intensity%20%3D%20source.intensity%3B%0A%20%20%20%20this.bias%20%3D%20source.bias%3B%0A%20%20%20%20this.radius%20%3D%20source.radius%3B%0A%20%20%20%20this.mapSize.copy%28source.mapSize%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20object%20%3D%20%7B%7D%3B%0A%20%20%20%20if%20%28this.intensity%20%21%3D%3D%201%29%20object.intensity%20%3D%20this.intensity%3B%0A%20%20%20%20if%20%28this.bias%20%21%3D%3D%200%29%20object.bias%20%3D%20this.bias%3B%0A%20%20%20%20if%20%28this.normalBias%20%21%3D%3D%200%29%20object.normalBias%20%3D%20this.normalBias%3B%0A%20%20%20%20if%20%28this.radius%20%21%3D%3D%201%29%20object.radius%20%3D%20this.radius%3B%0A%20%20%20%20if%20%28this.mapSize.x%20%21%3D%3D%20512%20%7C%7C%20this.mapSize.y%20%21%3D%3D%20512%29%20object.mapSize%20%3D%20this.mapSize.toArray%28%29%3B%0A%20%20%20%20object.camera%20%3D%20this.camera.toJSON%28false%29.object%3B%0A%20%20%20%20delete%20object.camera.matrix%3B%0A%20%20%20%20return%20object%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DirectionalLightShadow%20%3D%20class%20extends%20LightShadow%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28new%20OrthographicCamera%28-5%2C%205%2C%205%2C%20-5%2C%200.5%2C%20500%29%29%3B%0A%20%20%20%20this.isDirectionalLightShadow%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DirectionalLight%20%3D%20class%20extends%20Light%20%7B%0A%20%20constructor%28color2%2C%20intensity%29%20%7B%0A%20%20%20%20super%28color2%2C%20intensity%29%3B%0A%20%20%20%20this.isDirectionalLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22DirectionalLight%22%3B%0A%20%20%20%20this.position.copy%28Object3D.DEFAULT_UP%29%3B%0A%20%20%20%20this.updateMatrix%28%29%3B%0A%20%20%20%20this.target%20%3D%20new%20Object3D%28%29%3B%0A%20%20%20%20this.shadow%20%3D%20new%20DirectionalLightShadow%28%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.shadow.dispose%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.target%20%3D%20source.target.clone%28%29%3B%0A%20%20%20%20this.shadow%20%3D%20source.shadow.clone%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20AmbientLight%20%3D%20class%20extends%20Light%20%7B%0A%20%20constructor%28color2%2C%20intensity%29%20%7B%0A%20%20%20%20super%28color2%2C%20intensity%29%3B%0A%20%20%20%20this.isAmbientLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22AmbientLight%22%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Clock%20%3D%20class%20%7B%0A%20%20constructor%28autoStart%20%3D%20true%29%20%7B%0A%20%20%20%20this.autoStart%20%3D%20autoStart%3B%0A%20%20%20%20this.startTime%20%3D%200%3B%0A%20%20%20%20this.oldTime%20%3D%200%3B%0A%20%20%20%20this.elapsedTime%20%3D%200%3B%0A%20%20%20%20this.running%20%3D%20false%3B%0A%20%20%7D%0A%20%20start%28%29%20%7B%0A%20%20%20%20this.startTime%20%3D%20now%28%29%3B%0A%20%20%20%20this.oldTime%20%3D%20this.startTime%3B%0A%20%20%20%20this.elapsedTime%20%3D%200%3B%0A%20%20%20%20this.running%20%3D%20true%3B%0A%20%20%7D%0A%20%20stop%28%29%20%7B%0A%20%20%20%20this.getElapsedTime%28%29%3B%0A%20%20%20%20this.running%20%3D%20false%3B%0A%20%20%20%20this.autoStart%20%3D%20false%3B%0A%20%20%7D%0A%20%20getElapsedTime%28%29%20%7B%0A%20%20%20%20this.getDelta%28%29%3B%0A%20%20%20%20return%20this.elapsedTime%3B%0A%20%20%7D%0A%20%20getDelta%28%29%20%7B%0A%20%20%20%20let%20diff%20%3D%200%3B%0A%20%20%20%20if%20%28this.autoStart%20%26%26%20%21this.running%29%20%7B%0A%20%20%20%20%20%20this.start%28%29%3B%0A%20%20%20%20%20%20return%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.running%29%20%7B%0A%20%20%20%20%20%20const%20newTime%20%3D%20now%28%29%3B%0A%20%20%20%20%20%20diff%20%3D%20%28newTime%20-%20this.oldTime%29%20%2F%201e3%3B%0A%20%20%20%20%20%20this.oldTime%20%3D%20newTime%3B%0A%20%20%20%20%20%20this.elapsedTime%20%2B%3D%20diff%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20diff%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20now%28%29%20%7B%0A%20%20return%20performance.now%28%29%3B%0A%7D%0Avar%20_RESERVED_CHARS_RE%20%3D%20%22%5C%5C%5B%5C%5C%5D%5C%5C.%3A%5C%5C%2F%22%3B%0Avar%20_reservedRe%20%3D%20new%20RegExp%28%22%5B%22%20%2B%20_RESERVED_CHARS_RE%20%2B%20%22%5D%22%2C%20%22g%22%29%3B%0Avar%20_wordChar%20%3D%20%22%5B%5E%22%20%2B%20_RESERVED_CHARS_RE%20%2B%20%22%5D%22%3B%0Avar%20_wordCharOrDot%20%3D%20%22%5B%5E%22%20%2B%20_RESERVED_CHARS_RE.replace%28%22%5C%5C.%22%2C%20%22%22%29%20%2B%20%22%5D%22%3B%0Avar%20_directoryRe%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20%2F%28%28%3F%3AWC%2B%5B%5C%2F%3A%5D%29%2A%29%2F.source.replace%28%22WC%22%2C%20_wordChar%29%3B%0Avar%20_nodeRe%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20%2F%28WCOD%2B%29%3F%2F.source.replace%28%22WCOD%22%2C%20_wordCharOrDot%29%3B%0Avar%20_objectRe%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20%2F%28%3F%3A%5C.%28WC%2B%29%28%3F%3A%5C%5B%28.%2B%29%5C%5D%29%3F%29%3F%2F.source.replace%28%22WC%22%2C%20_wordChar%29%3B%0Avar%20_propertyRe%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20%2F%5C.%28WC%2B%29%28%3F%3A%5C%5B%28.%2B%29%5C%5D%29%3F%2F.source.replace%28%22WC%22%2C%20_wordChar%29%3B%0Avar%20_trackRe%20%3D%20new%20RegExp%28%0A%20%20%22%5E%22%20%2B%20_directoryRe%20%2B%20_nodeRe%20%2B%20_objectRe%20%2B%20_propertyRe%20%2B%20%22%24%22%0A%29%3B%0Avar%20_supportedObjectNames%20%3D%20%5B%22material%22%2C%20%22materials%22%2C%20%22bones%22%2C%20%22map%22%5D%3B%0Avar%20Composite%20%3D%20class%20%7B%0A%20%20constructor%28targetGroup%2C%20path%2C%20optionalParsedPath%29%20%7B%0A%20%20%20%20const%20parsedPath%20%3D%20optionalParsedPath%20%7C%7C%20PropertyBinding.parseTrackName%28path%29%3B%0A%20%20%20%20this._targetGroup%20%3D%20targetGroup%3B%0A%20%20%20%20this._bindings%20%3D%20targetGroup.subscribe_%28path%2C%20parsedPath%29%3B%0A%20%20%7D%0A%20%20getValue%28array%2C%20offset%29%20%7B%0A%20%20%20%20this.bind%28%29%3B%0A%20%20%20%20const%20firstValidIndex%20%3D%20this._targetGroup.nCachedObjects_%2C%20binding%20%3D%20this._bindings%5BfirstValidIndex%5D%3B%0A%20%20%20%20if%20%28binding%20%21%3D%3D%20void%200%29%20binding.getValue%28array%2C%20offset%29%3B%0A%20%20%7D%0A%20%20setValue%28array%2C%20offset%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20this._bindings%3B%0A%20%20%20%20for%20%28let%20i%20%3D%20this._targetGroup.nCachedObjects_%2C%20n%20%3D%20bindings.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20bindings%5Bi%5D.setValue%28array%2C%20offset%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20bind%28%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20this._bindings%3B%0A%20%20%20%20for%20%28let%20i%20%3D%20this._targetGroup.nCachedObjects_%2C%20n%20%3D%20bindings.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20bindings%5Bi%5D.bind%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20unbind%28%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20this._bindings%3B%0A%20%20%20%20for%20%28let%20i%20%3D%20this._targetGroup.nCachedObjects_%2C%20n%20%3D%20bindings.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20bindings%5Bi%5D.unbind%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20PropertyBinding%20%3D%20class%20_PropertyBinding%20%7B%0A%20%20constructor%28rootNode%2C%20path%2C%20parsedPath%29%20%7B%0A%20%20%20%20this.path%20%3D%20path%3B%0A%20%20%20%20this.parsedPath%20%3D%20parsedPath%20%7C%7C%20_PropertyBinding.parseTrackName%28path%29%3B%0A%20%20%20%20this.node%20%3D%20_PropertyBinding.findNode%28rootNode%2C%20this.parsedPath.nodeName%29%3B%0A%20%20%20%20this.rootNode%20%3D%20rootNode%3B%0A%20%20%20%20this.getValue%20%3D%20this._getValue_unbound%3B%0A%20%20%20%20this.setValue%20%3D%20this._setValue_unbound%3B%0A%20%20%7D%0A%20%20static%20create%28root2%2C%20path%2C%20parsedPath%29%20%7B%0A%20%20%20%20if%20%28%21%28root2%20%26%26%20root2.isAnimationObjectGroup%29%29%20%7B%0A%20%20%20%20%20%20return%20new%20_PropertyBinding%28root2%2C%20path%2C%20parsedPath%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20new%20_PropertyBinding.Composite%28root2%2C%20path%2C%20parsedPath%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Replaces%20spaces%20with%20underscores%20and%20removes%20unsupported%20characters%20from%0A%20%20%20%2A%20node%20names%2C%20to%20ensure%20compatibility%20with%20parseTrackName%28%29.%0A%20%20%20%2A%0A%20%20%20%2A%20%40param%20%7Bstring%7D%20name%20Node%20name%20to%20be%20sanitized.%0A%20%20%20%2A%20%40return%20%7Bstring%7D%0A%20%20%20%2A%2F%0A%20%20static%20sanitizeNodeName%28name%29%20%7B%0A%20%20%20%20return%20name.replace%28%2F%5Cs%2Fg%2C%20%22_%22%29.replace%28_reservedRe%2C%20%22%22%29%3B%0A%20%20%7D%0A%20%20static%20parseTrackName%28trackName%29%20%7B%0A%20%20%20%20const%20matches%20%3D%20_trackRe.exec%28trackName%29%3B%0A%20%20%20%20if%20%28matches%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22PropertyBinding%3A%20Cannot%20parse%20trackName%3A%20%22%20%2B%20trackName%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20results%20%3D%20%7B%0A%20%20%20%20%20%20%2F%2F%20directoryName%3A%20matches%5B%201%20%5D%2C%20%2F%2F%20%28tschw%29%20currently%20unused%0A%20%20%20%20%20%20nodeName%3A%20matches%5B2%5D%2C%0A%20%20%20%20%20%20objectName%3A%20matches%5B3%5D%2C%0A%20%20%20%20%20%20objectIndex%3A%20matches%5B4%5D%2C%0A%20%20%20%20%20%20propertyName%3A%20matches%5B5%5D%2C%0A%20%20%20%20%20%20%2F%2F%20required%0A%20%20%20%20%20%20propertyIndex%3A%20matches%5B6%5D%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20lastDot%20%3D%20results.nodeName%20%26%26%20results.nodeName.lastIndexOf%28%22.%22%29%3B%0A%20%20%20%20if%20%28lastDot%20%21%3D%3D%20void%200%20%26%26%20lastDot%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20const%20objectName%20%3D%20results.nodeName.substring%28lastDot%20%2B%201%29%3B%0A%20%20%20%20%20%20if%20%28_supportedObjectNames.indexOf%28objectName%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20results.nodeName%20%3D%20results.nodeName.substring%280%2C%20lastDot%29%3B%0A%20%20%20%20%20%20%20%20results.objectName%20%3D%20objectName%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28results.propertyName%20%3D%3D%3D%20null%20%7C%7C%20results.propertyName.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22PropertyBinding%3A%20can%20not%20parse%20propertyName%20from%20trackName%3A%20%22%20%2B%20trackName%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20results%3B%0A%20%20%7D%0A%20%20static%20findNode%28root2%2C%20nodeName%29%20%7B%0A%20%20%20%20if%20%28nodeName%20%3D%3D%3D%20void%200%20%7C%7C%20nodeName%20%3D%3D%3D%20%22%22%20%7C%7C%20nodeName%20%3D%3D%3D%20%22.%22%20%7C%7C%20nodeName%20%3D%3D%3D%20-1%20%7C%7C%20nodeName%20%3D%3D%3D%20root2.name%20%7C%7C%20nodeName%20%3D%3D%3D%20root2.uuid%29%20%7B%0A%20%20%20%20%20%20return%20root2%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28root2.skeleton%29%20%7B%0A%20%20%20%20%20%20const%20bone%20%3D%20root2.skeleton.getBoneByName%28nodeName%29%3B%0A%20%20%20%20%20%20if%20%28bone%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20bone%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28root2.children%29%20%7B%0A%20%20%20%20%20%20const%20searchNodeSubtree%20%3D%20function%28children%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20children.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20childNode%20%3D%20children%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28childNode.name%20%3D%3D%3D%20nodeName%20%7C%7C%20childNode.uuid%20%3D%3D%3D%20nodeName%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20childNode%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20const%20result%20%3D%20searchNodeSubtree%28childNode.children%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28result%29%20return%20result%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20const%20subTreeNode%20%3D%20searchNodeSubtree%28root2.children%29%3B%0A%20%20%20%20%20%20if%20%28subTreeNode%29%20%7B%0A%20%20%20%20%20%20%20%20return%20subTreeNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%20%20%2F%2F%20these%20are%20used%20to%20%22bind%22%20a%20nonexistent%20property%0A%20%20_getValue_unavailable%28%29%20%7B%0A%20%20%7D%0A%20%20_setValue_unavailable%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20Getters%0A%20%20_getValue_direct%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20buffer2%5Boffset%5D%20%3D%20this.targetObject%5Bthis.propertyName%5D%3B%0A%20%20%7D%0A%20%20_getValue_array%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20const%20source%20%3D%20this.resolvedProperty%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20source.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20buffer2%5Boffset%2B%2B%5D%20%3D%20source%5Bi%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_getValue_arrayElement%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20buffer2%5Boffset%5D%20%3D%20this.resolvedProperty%5Bthis.propertyIndex%5D%3B%0A%20%20%7D%0A%20%20_getValue_toArray%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty.toArray%28buffer2%2C%20offset%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20Direct%0A%20%20_setValue_direct%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.targetObject%5Bthis.propertyName%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%7D%0A%20%20_setValue_direct_setNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.targetObject%5Bthis.propertyName%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%20%20this.targetObject.needsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_setValue_direct_setMatrixWorldNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.targetObject%5Bthis.propertyName%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%20%20this.targetObject.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20%2F%2F%20EntireArray%0A%20%20_setValue_array%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20const%20dest%20%3D%20this.resolvedProperty%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20dest.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20dest%5Bi%5D%20%3D%20buffer2%5Boffset%2B%2B%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_setValue_array_setNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20const%20dest%20%3D%20this.resolvedProperty%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20dest.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20dest%5Bi%5D%20%3D%20buffer2%5Boffset%2B%2B%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.targetObject.needsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_setValue_array_setMatrixWorldNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20const%20dest%20%3D%20this.resolvedProperty%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20dest.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20dest%5Bi%5D%20%3D%20buffer2%5Boffset%2B%2B%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.targetObject.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20%2F%2F%20ArrayElement%0A%20%20_setValue_arrayElement%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty%5Bthis.propertyIndex%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%7D%0A%20%20_setValue_arrayElement_setNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty%5Bthis.propertyIndex%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%20%20this.targetObject.needsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_setValue_arrayElement_setMatrixWorldNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty%5Bthis.propertyIndex%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%20%20this.targetObject.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20%2F%2F%20HasToFromArray%0A%20%20_setValue_fromArray%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty.fromArray%28buffer2%2C%20offset%29%3B%0A%20%20%7D%0A%20%20_setValue_fromArray_setNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty.fromArray%28buffer2%2C%20offset%29%3B%0A%20%20%20%20this.targetObject.needsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_setValue_fromArray_setMatrixWorldNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty.fromArray%28buffer2%2C%20offset%29%3B%0A%20%20%20%20this.targetObject.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_getValue_unbound%28targetArray%2C%20offset%29%20%7B%0A%20%20%20%20this.bind%28%29%3B%0A%20%20%20%20this.getValue%28targetArray%2C%20offset%29%3B%0A%20%20%7D%0A%20%20_setValue_unbound%28sourceArray%2C%20offset%29%20%7B%0A%20%20%20%20this.bind%28%29%3B%0A%20%20%20%20this.setValue%28sourceArray%2C%20offset%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20create%20getter%20%2F%20setter%20pair%20for%20a%20property%20in%20the%20scene%20graph%0A%20%20bind%28%29%20%7B%0A%20%20%20%20let%20targetObject%20%3D%20this.node%3B%0A%20%20%20%20const%20parsedPath%20%3D%20this.parsedPath%3B%0A%20%20%20%20const%20objectName%20%3D%20parsedPath.objectName%3B%0A%20%20%20%20const%20propertyName%20%3D%20parsedPath.propertyName%3B%0A%20%20%20%20let%20propertyIndex%20%3D%20parsedPath.propertyIndex%3B%0A%20%20%20%20if%20%28%21targetObject%29%20%7B%0A%20%20%20%20%20%20targetObject%20%3D%20_PropertyBinding.findNode%28this.rootNode%2C%20parsedPath.nodeName%29%3B%0A%20%20%20%20%20%20this.node%20%3D%20targetObject%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.getValue%20%3D%20this._getValue_unavailable%3B%0A%20%20%20%20this.setValue%20%3D%20this._setValue_unavailable%3B%0A%20%20%20%20if%20%28%21targetObject%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.PropertyBinding%3A%20No%20target%20node%20found%20for%20track%3A%20%22%20%2B%20this.path%20%2B%20%22.%22%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28objectName%29%20%7B%0A%20%20%20%20%20%20let%20objectIndex%20%3D%20parsedPath.objectIndex%3B%0A%20%20%20%20%20%20switch%20%28objectName%29%20%7B%0A%20%20%20%20%20%20%20%20case%20%22materials%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.material%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20material%20as%20node%20does%20not%20have%20a%20material.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.material.materials%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20material.materials%20as%20node.material%20does%20not%20have%20a%20materials%20array.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject.material.materials%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22bones%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.skeleton%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20bones%20as%20node%20does%20not%20have%20a%20skeleton.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject.skeleton.bones%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20targetObject.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28targetObject%5Bi%5D.name%20%3D%3D%3D%20objectIndex%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20objectIndex%20%3D%20i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22map%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28%22map%22%20in%20targetObject%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject.map%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.material%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20material%20as%20node%20does%20not%20have%20a%20material.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.material.map%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20material.map%20as%20node.material%20does%20not%20have%20a%20map.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject.material.map%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28targetObject%5BobjectName%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20objectName%20of%20node%20undefined.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject%5BobjectName%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28objectIndex%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28targetObject%5BobjectIndex%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Trying%20to%20bind%20to%20objectIndex%20of%20objectName%2C%20but%20is%20undefined.%22%2C%20this%2C%20targetObject%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject%5BobjectIndex%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20nodeProperty%20%3D%20targetObject%5BpropertyName%5D%3B%0A%20%20%20%20if%20%28nodeProperty%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20nodeName%20%3D%20parsedPath.nodeName%3B%0A%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Trying%20to%20update%20property%20for%20track%3A%20%22%20%2B%20nodeName%20%2B%20%22.%22%20%2B%20propertyName%20%2B%20%22%20but%20it%20wasn%27t%20found.%22%2C%20targetObject%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20versioning%20%3D%20this.Versioning.None%3B%0A%20%20%20%20this.targetObject%20%3D%20targetObject%3B%0A%20%20%20%20if%20%28targetObject.needsUpdate%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20versioning%20%3D%20this.Versioning.NeedsUpdate%3B%0A%20%20%20%20%7D%20else%20if%20%28targetObject.matrixWorldNeedsUpdate%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20versioning%20%3D%20this.Versioning.MatrixWorldNeedsUpdate%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20bindingType%20%3D%20this.BindingType.Direct%3B%0A%20%20%20%20if%20%28propertyIndex%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28propertyName%20%3D%3D%3D%20%22morphTargetInfluences%22%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21targetObject.geometry%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20morphTargetInfluences%20because%20node%20does%20not%20have%20a%20geometry.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%21targetObject.geometry.morphAttributes%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20morphTargetInfluences%20because%20node%20does%20not%20have%20a%20geometry.morphAttributes.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28targetObject.morphTargetDictionary%5BpropertyIndex%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20propertyIndex%20%3D%20targetObject.morphTargetDictionary%5BpropertyIndex%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20bindingType%20%3D%20this.BindingType.ArrayElement%3B%0A%20%20%20%20%20%20this.resolvedProperty%20%3D%20nodeProperty%3B%0A%20%20%20%20%20%20this.propertyIndex%20%3D%20propertyIndex%3B%0A%20%20%20%20%7D%20else%20if%20%28nodeProperty.fromArray%20%21%3D%3D%20void%200%20%26%26%20nodeProperty.toArray%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20bindingType%20%3D%20this.BindingType.HasFromToArray%3B%0A%20%20%20%20%20%20this.resolvedProperty%20%3D%20nodeProperty%3B%0A%20%20%20%20%7D%20else%20if%20%28Array.isArray%28nodeProperty%29%29%20%7B%0A%20%20%20%20%20%20bindingType%20%3D%20this.BindingType.EntireArray%3B%0A%20%20%20%20%20%20this.resolvedProperty%20%3D%20nodeProperty%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.propertyName%20%3D%20propertyName%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.getValue%20%3D%20this.GetterByBindingType%5BbindingType%5D%3B%0A%20%20%20%20this.setValue%20%3D%20this.SetterByBindingTypeAndVersioning%5BbindingType%5D%5Bversioning%5D%3B%0A%20%20%7D%0A%20%20unbind%28%29%20%7B%0A%20%20%20%20this.node%20%3D%20null%3B%0A%20%20%20%20this.getValue%20%3D%20this._getValue_unbound%3B%0A%20%20%20%20this.setValue%20%3D%20this._setValue_unbound%3B%0A%20%20%7D%0A%7D%3B%0APropertyBinding.Composite%20%3D%20Composite%3B%0APropertyBinding.prototype.BindingType%20%3D%20%7B%0A%20%20Direct%3A%200%2C%0A%20%20EntireArray%3A%201%2C%0A%20%20ArrayElement%3A%202%2C%0A%20%20HasFromToArray%3A%203%0A%7D%3B%0APropertyBinding.prototype.Versioning%20%3D%20%7B%0A%20%20None%3A%200%2C%0A%20%20NeedsUpdate%3A%201%2C%0A%20%20MatrixWorldNeedsUpdate%3A%202%0A%7D%3B%0APropertyBinding.prototype.GetterByBindingType%20%3D%20%5B%0A%20%20PropertyBinding.prototype._getValue_direct%2C%0A%20%20PropertyBinding.prototype._getValue_array%2C%0A%20%20PropertyBinding.prototype._getValue_arrayElement%2C%0A%20%20PropertyBinding.prototype._getValue_toArray%0A%5D%3B%0APropertyBinding.prototype.SetterByBindingTypeAndVersioning%20%3D%20%5B%0A%20%20%5B%0A%20%20%20%20%2F%2F%20Direct%0A%20%20%20%20PropertyBinding.prototype._setValue_direct%2C%0A%20%20%20%20PropertyBinding.prototype._setValue_direct_setNeedsUpdate%2C%0A%20%20%20%20PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate%0A%20%20%5D%2C%0A%20%20%5B%0A%20%20%20%20%2F%2F%20EntireArray%0A%20%20%20%20PropertyBinding.prototype._setValue_array%2C%0A%20%20%20%20PropertyBinding.prototype._setValue_array_setNeedsUpdate%2C%0A%20%20%20%20PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate%0A%20%20%5D%2C%0A%20%20%5B%0A%20%20%20%20%2F%2F%20ArrayElement%0A%20%20%20%20PropertyBinding.prototype._setValue_arrayElement%2C%0A%20%20%20%20PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate%2C%0A%20%20%20%20PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate%0A%20%20%5D%2C%0A%20%20%5B%0A%20%20%20%20%2F%2F%20HasToFromArray%0A%20%20%20%20PropertyBinding.prototype._setValue_fromArray%2C%0A%20%20%20%20PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate%2C%0A%20%20%20%20PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate%0A%20%20%5D%0A%5D%3B%0Avar%20_controlInterpolantsResultBuffer%20%3D%20new%20Float32Array%281%29%3B%0Avar%20_matrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix4%28%29%3B%0Avar%20Raycaster%20%3D%20class%20%7B%0A%20%20constructor%28origin%2C%20direction2%2C%20near%20%3D%200%2C%20far%20%3D%20Infinity%29%20%7B%0A%20%20%20%20this.ray%20%3D%20new%20Ray%28origin%2C%20direction2%29%3B%0A%20%20%20%20this.near%20%3D%20near%3B%0A%20%20%20%20this.far%20%3D%20far%3B%0A%20%20%20%20this.camera%20%3D%20null%3B%0A%20%20%20%20this.layers%20%3D%20new%20Layers%28%29%3B%0A%20%20%20%20this.params%20%3D%20%7B%0A%20%20%20%20%20%20Mesh%3A%20%7B%7D%2C%0A%20%20%20%20%20%20Line%3A%20%7B%20threshold%3A%201%20%7D%2C%0A%20%20%20%20%20%20LOD%3A%20%7B%7D%2C%0A%20%20%20%20%20%20Points%3A%20%7B%20threshold%3A%201%20%7D%2C%0A%20%20%20%20%20%20Sprite%3A%20%7B%7D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20set%28origin%2C%20direction2%29%20%7B%0A%20%20%20%20this.ray.set%28origin%2C%20direction2%29%3B%0A%20%20%7D%0A%20%20setFromCamera%28coords%2C%20camera3%29%20%7B%0A%20%20%20%20if%20%28camera3.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20this.ray.origin.setFromMatrixPosition%28camera3.matrixWorld%29%3B%0A%20%20%20%20%20%20this.ray.direction.set%28coords.x%2C%20coords.y%2C%200.5%29.unproject%28camera3%29.sub%28this.ray.origin%29.normalize%28%29%3B%0A%20%20%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%20%20%7D%20else%20if%20%28camera3.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20this.ray.origin.set%28coords.x%2C%20coords.y%2C%20%28camera3.near%20%2B%20camera3.far%29%20%2F%20%28camera3.near%20-%20camera3.far%29%29.unproject%28camera3%29%3B%0A%20%20%20%20%20%20this.ray.direction.set%280%2C%200%2C%20-1%29.transformDirection%28camera3.matrixWorld%29%3B%0A%20%20%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.Raycaster%3A%20Unsupported%20camera%20type%3A%20%22%20%2B%20camera3.type%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setFromXRController%28controller%29%20%7B%0A%20%20%20%20_matrix.identity%28%29.extractRotation%28controller.matrixWorld%29%3B%0A%20%20%20%20this.ray.origin.setFromMatrixPosition%28controller.matrixWorld%29%3B%0A%20%20%20%20this.ray.direction.set%280%2C%200%2C%20-1%29.applyMatrix4%28_matrix%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20intersectObject%28object%2C%20recursive%20%3D%20true%2C%20intersects%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20intersect%28object%2C%20this%2C%20intersects%2C%20recursive%29%3B%0A%20%20%20%20intersects.sort%28ascSort%29%3B%0A%20%20%20%20return%20intersects%3B%0A%20%20%7D%0A%20%20intersectObjects%28objects%2C%20recursive%20%3D%20true%2C%20intersects%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20objects.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20intersect%28objects%5Bi%5D%2C%20this%2C%20intersects%2C%20recursive%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20intersects.sort%28ascSort%29%3B%0A%20%20%20%20return%20intersects%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20ascSort%28a2%2C%20b%29%20%7B%0A%20%20return%20a2.distance%20-%20b.distance%3B%0A%7D%0Afunction%20intersect%28object%2C%20raycaster%2C%20intersects%2C%20recursive%29%20%7B%0A%20%20let%20propagate%20%3D%20true%3B%0A%20%20if%20%28object.layers.test%28raycaster.layers%29%29%20%7B%0A%20%20%20%20const%20result%20%3D%20object.raycast%28raycaster%2C%20intersects%29%3B%0A%20%20%20%20if%20%28result%20%3D%3D%3D%20false%29%20propagate%20%3D%20false%3B%0A%20%20%7D%0A%20%20if%20%28propagate%20%3D%3D%3D%20true%20%26%26%20recursive%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20const%20children%20%3D%20object.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20intersect%28children%5Bi%5D%2C%20raycaster%2C%20intersects%2C%20true%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Avar%20Spherical%20%3D%20class%20%7B%0A%20%20constructor%28radius%20%3D%201%2C%20phi%20%3D%200%2C%20theta%20%3D%200%29%20%7B%0A%20%20%20%20this.radius%20%3D%20radius%3B%0A%20%20%20%20this.phi%20%3D%20phi%3B%0A%20%20%20%20this.theta%20%3D%20theta%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20set%28radius%2C%20phi%2C%20theta%29%20%7B%0A%20%20%20%20this.radius%20%3D%20radius%3B%0A%20%20%20%20this.phi%20%3D%20phi%3B%0A%20%20%20%20this.theta%20%3D%20theta%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28other%29%20%7B%0A%20%20%20%20this.radius%20%3D%20other.radius%3B%0A%20%20%20%20this.phi%20%3D%20other.phi%3B%0A%20%20%20%20this.theta%20%3D%20other.theta%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20restrict%20phi%20to%20be%20between%20EPS%20and%20PI-EPS%0A%20%20makeSafe%28%29%20%7B%0A%20%20%20%20const%20EPS%20%3D%201e-6%3B%0A%20%20%20%20this.phi%20%3D%20Math.max%28EPS%2C%20Math.min%28Math.PI%20-%20EPS%2C%20this.phi%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromVector3%28v%29%20%7B%0A%20%20%20%20return%20this.setFromCartesianCoords%28v.x%2C%20v.y%2C%20v.z%29%3B%0A%20%20%7D%0A%20%20setFromCartesianCoords%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20this.radius%20%3D%20Math.sqrt%28x2%20%2A%20x2%20%2B%20y2%20%2A%20y2%20%2B%20z2%20%2A%20z2%29%3B%0A%20%20%20%20if%20%28this.radius%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20this.theta%20%3D%200%3B%0A%20%20%20%20%20%20this.phi%20%3D%200%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.theta%20%3D%20Math.atan2%28x2%2C%20z2%29%3B%0A%20%20%20%20%20%20this.phi%20%3D%20Math.acos%28clamp%28y2%20%2F%20this.radius%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Controls%20%3D%20class%20extends%20EventDispatcher%20%7B%0A%20%20constructor%28object%2C%20domElement%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.object%20%3D%20object%3B%0A%20%20%20%20this.domElement%20%3D%20domElement%3B%0A%20%20%20%20this.enabled%20%3D%20true%3B%0A%20%20%20%20this.state%20%3D%20-1%3B%0A%20%20%20%20this.keys%20%3D%20%7B%7D%3B%0A%20%20%20%20this.mouseButtons%20%3D%20%7B%20LEFT%3A%20null%2C%20MIDDLE%3A%20null%2C%20RIGHT%3A%20null%20%7D%3B%0A%20%20%20%20this.touches%20%3D%20%7B%20ONE%3A%20null%2C%20TWO%3A%20null%20%7D%3B%0A%20%20%7D%0A%20%20connect%28%29%20%7B%0A%20%20%7D%0A%20%20disconnect%28%29%20%7B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%7D%0A%7D%3B%0Aif%20%28typeof%20__THREE_DEVTOOLS__%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20__THREE_DEVTOOLS__.dispatchEvent%28new%20CustomEvent%28%22register%22%2C%20%7B%20detail%3A%20%7B%0A%20%20%20%20revision%3A%20REVISION%0A%20%20%7D%20%7D%29%29%3B%0A%7D%0Aif%20%28typeof%20window%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20if%20%28window.__THREE__%29%20%7B%0A%20%20%20%20console.warn%28%22WARNING%3A%20Multiple%20instances%20of%20Three.js%20being%20imported.%22%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20window.__THREE__%20%3D%20REVISION%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fcontrols%2FDragControls.js%0Avar%20_plane%20%3D%20new%20Plane%28%29%3B%0Avar%20_pointer%20%3D%20new%20Vector2%28%29%3B%0Avar%20_offset2%20%3D%20new%20Vector3%28%29%3B%0Avar%20_diff2%20%3D%20new%20Vector2%28%29%3B%0Avar%20_previousPointer%20%3D%20new%20Vector2%28%29%3B%0Avar%20_intersection%20%3D%20new%20Vector3%28%29%3B%0Avar%20_worldPosition%20%3D%20new%20Vector3%28%29%3B%0Avar%20_inverseMatrix%20%3D%20new%20Matrix4%28%29%3B%0Avar%20_up%20%3D%20new%20Vector3%28%29%3B%0Avar%20_right%20%3D%20new%20Vector3%28%29%3B%0Avar%20_selected%20%3D%20null%3B%0Avar%20_hovered%20%3D%20null%3B%0Avar%20_intersections%20%3D%20%5B%5D%3B%0Avar%20STATE%20%3D%20%7B%0A%20%20NONE%3A%20-1%2C%0A%20%20PAN%3A%200%2C%0A%20%20ROTATE%3A%201%0A%7D%3B%0Avar%20DragControls%20%3D%20class%20extends%20Controls%20%7B%0A%20%20constructor%28objects%2C%20camera3%2C%20domElement%20%3D%20null%29%20%7B%0A%20%20%20%20super%28camera3%2C%20domElement%29%3B%0A%20%20%20%20this.objects%20%3D%20objects%3B%0A%20%20%20%20this.recursive%20%3D%20true%3B%0A%20%20%20%20this.transformGroup%20%3D%20false%3B%0A%20%20%20%20this.rotateSpeed%20%3D%201%3B%0A%20%20%20%20this.raycaster%20%3D%20new%20Raycaster%28%29%3B%0A%20%20%20%20this.mouseButtons%20%3D%20%7B%20LEFT%3A%20MOUSE.PAN%2C%20MIDDLE%3A%20MOUSE.PAN%2C%20RIGHT%3A%20MOUSE.ROTATE%20%7D%3B%0A%20%20%20%20this.touches%20%3D%20%7B%20ONE%3A%20TOUCH.PAN%20%7D%3B%0A%20%20%20%20this._onPointerMove%20%3D%20onPointerMove.bind%28this%29%3B%0A%20%20%20%20this._onPointerDown%20%3D%20onPointerDown.bind%28this%29%3B%0A%20%20%20%20this._onPointerCancel%20%3D%20onPointerCancel.bind%28this%29%3B%0A%20%20%20%20this._onContextMenu%20%3D%20onContextMenu.bind%28this%29%3B%0A%20%20%20%20if%20%28domElement%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.connect%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20connect%28%29%20%7B%0A%20%20%20%20this.domElement.addEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointerdown%22%2C%20this._onPointerDown%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointerup%22%2C%20this._onPointerCancel%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointerleave%22%2C%20this._onPointerCancel%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22contextmenu%22%2C%20this._onContextMenu%29%3B%0A%20%20%20%20this.domElement.style.touchAction%20%3D%20%22none%22%3B%0A%20%20%7D%0A%20%20disconnect%28%29%20%7B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerdown%22%2C%20this._onPointerDown%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerup%22%2C%20this._onPointerCancel%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerleave%22%2C%20this._onPointerCancel%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22contextmenu%22%2C%20this._onContextMenu%29%3B%0A%20%20%20%20this.domElement.style.touchAction%20%3D%20%22auto%22%3B%0A%20%20%20%20this.domElement.style.cursor%20%3D%20%22%22%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.disconnect%28%29%3B%0A%20%20%7D%0A%20%20_updatePointer%28event%29%20%7B%0A%20%20%20%20const%20rect%20%3D%20this.domElement.getBoundingClientRect%28%29%3B%0A%20%20%20%20_pointer.x%20%3D%20%28event.clientX%20-%20rect.left%29%20%2F%20rect.width%20%2A%202%20-%201%3B%0A%20%20%20%20_pointer.y%20%3D%20-%28event.clientY%20-%20rect.top%29%20%2F%20rect.height%20%2A%202%20%2B%201%3B%0A%20%20%7D%0A%20%20_updateState%28event%29%20%7B%0A%20%20%20%20let%20action%3B%0A%20%20%20%20if%20%28event.pointerType%20%3D%3D%3D%20%22touch%22%29%20%7B%0A%20%20%20%20%20%20action%20%3D%20this.touches.ONE%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20switch%20%28event.button%29%20%7B%0A%20%20%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20%20%20action%20%3D%20this.mouseButtons.LEFT%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20%20%20action%20%3D%20this.mouseButtons.MIDDLE%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20%20%20action%20%3D%20this.mouseButtons.RIGHT%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20action%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20switch%20%28action%29%20%7B%0A%20%20%20%20%20%20case%20MOUSE.PAN%3A%0A%20%20%20%20%20%20case%20TOUCH.PAN%3A%0A%20%20%20%20%20%20%20%20this.state%20%3D%20STATE.PAN%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20MOUSE.ROTATE%3A%0A%20%20%20%20%20%20case%20TOUCH.ROTATE%3A%0A%20%20%20%20%20%20%20%20this.state%20%3D%20STATE.ROTATE%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20this.state%20%3D%20STATE.NONE%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getRaycaster%28%29%20%7B%0A%20%20%20%20console.warn%28%22THREE.DragControls%3A%20getRaycaster%28%29%20has%20been%20deprecated.%20Use%20controls.raycaster%20instead.%22%29%3B%0A%20%20%20%20return%20this.raycaster%3B%0A%20%20%7D%0A%20%20setObjects%28objects%29%20%7B%0A%20%20%20%20console.warn%28%22THREE.DragControls%3A%20setObjects%28%29%20has%20been%20deprecated.%20Use%20controls.objects%20instead.%22%29%3B%0A%20%20%20%20this.objects%20%3D%20objects%3B%0A%20%20%7D%0A%20%20getObjects%28%29%20%7B%0A%20%20%20%20console.warn%28%22THREE.DragControls%3A%20getObjects%28%29%20has%20been%20deprecated.%20Use%20controls.objects%20instead.%22%29%3B%0A%20%20%20%20return%20this.objects%3B%0A%20%20%7D%0A%20%20activate%28%29%20%7B%0A%20%20%20%20console.warn%28%22THREE.DragControls%3A%20activate%28%29%20has%20been%20renamed%20to%20connect%28%29.%22%29%3B%0A%20%20%20%20this.connect%28%29%3B%0A%20%20%7D%0A%20%20deactivate%28%29%20%7B%0A%20%20%20%20console.warn%28%22THREE.DragControls%3A%20deactivate%28%29%20has%20been%20renamed%20to%20disconnect%28%29.%22%29%3B%0A%20%20%20%20this.disconnect%28%29%3B%0A%20%20%7D%0A%20%20set%20mode%28value%29%20%7B%0A%20%20%20%20console.warn%28%22THREE.DragControls%3A%20The%20.mode%20property%20has%20been%20removed.%20Define%20the%20type%20of%20transformation%20via%20the%20.mouseButtons%20or%20.touches%20properties.%22%29%3B%0A%20%20%7D%0A%20%20get%20mode%28%29%20%7B%0A%20%20%20%20console.warn%28%22THREE.DragControls%3A%20The%20.mode%20property%20has%20been%20removed.%20Define%20the%20type%20of%20transformation%20via%20the%20.mouseButtons%20or%20.touches%20properties.%22%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20onPointerMove%28event%29%20%7B%0A%20%20const%20camera3%20%3D%20this.object%3B%0A%20%20const%20domElement%20%3D%20this.domElement%3B%0A%20%20const%20raycaster%20%3D%20this.raycaster%3B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20this._updatePointer%28event%29%3B%0A%20%20raycaster.setFromCamera%28_pointer%2C%20camera3%29%3B%0A%20%20if%20%28_selected%29%20%7B%0A%20%20%20%20if%20%28this.state%20%3D%3D%3D%20STATE.PAN%29%20%7B%0A%20%20%20%20%20%20if%20%28raycaster.ray.intersectPlane%28_plane%2C%20_intersection%29%29%20%7B%0A%20%20%20%20%20%20%20%20_selected.position.copy%28_intersection.sub%28_offset2%29.applyMatrix4%28_inverseMatrix%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28this.state%20%3D%3D%3D%20STATE.ROTATE%29%20%7B%0A%20%20%20%20%20%20_diff2.subVectors%28_pointer%2C%20_previousPointer%29.multiplyScalar%28this.rotateSpeed%29%3B%0A%20%20%20%20%20%20_selected.rotateOnWorldAxis%28_up%2C%20_diff2.x%29%3B%0A%20%20%20%20%20%20_selected.rotateOnWorldAxis%28_right.normalize%28%29%2C%20-_diff2.y%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22drag%22%2C%20object%3A%20_selected%20%7D%29%3B%0A%20%20%20%20_previousPointer.copy%28_pointer%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28event.pointerType%20%3D%3D%3D%20%22mouse%22%20%7C%7C%20event.pointerType%20%3D%3D%3D%20%22pen%22%29%20%7B%0A%20%20%20%20%20%20_intersections.length%20%3D%200%3B%0A%20%20%20%20%20%20raycaster.setFromCamera%28_pointer%2C%20camera3%29%3B%0A%20%20%20%20%20%20raycaster.intersectObjects%28this.objects%2C%20this.recursive%2C%20_intersections%29%3B%0A%20%20%20%20%20%20if%20%28_intersections.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20object%20%3D%20_intersections%5B0%5D.object%3B%0A%20%20%20%20%20%20%20%20_plane.setFromNormalAndCoplanarPoint%28camera3.getWorldDirection%28_plane.normal%29%2C%20_worldPosition.setFromMatrixPosition%28object.matrixWorld%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28_hovered%20%21%3D%3D%20object%20%26%26%20_hovered%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22hoveroff%22%2C%20object%3A%20_hovered%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20domElement.style.cursor%20%3D%20%22auto%22%3B%0A%20%20%20%20%20%20%20%20%20%20_hovered%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28_hovered%20%21%3D%3D%20object%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22hoveron%22%2C%20object%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20domElement.style.cursor%20%3D%20%22pointer%22%3B%0A%20%20%20%20%20%20%20%20%20%20_hovered%20%3D%20object%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28_hovered%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22hoveroff%22%2C%20object%3A%20_hovered%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20domElement.style.cursor%20%3D%20%22auto%22%3B%0A%20%20%20%20%20%20%20%20%20%20_hovered%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_previousPointer.copy%28_pointer%29%3B%0A%7D%0Afunction%20onPointerDown%28event%29%20%7B%0A%20%20const%20camera3%20%3D%20this.object%3B%0A%20%20const%20domElement%20%3D%20this.domElement%3B%0A%20%20const%20raycaster%20%3D%20this.raycaster%3B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20this._updatePointer%28event%29%3B%0A%20%20this._updateState%28event%29%3B%0A%20%20_intersections.length%20%3D%200%3B%0A%20%20raycaster.setFromCamera%28_pointer%2C%20camera3%29%3B%0A%20%20raycaster.intersectObjects%28this.objects%2C%20this.recursive%2C%20_intersections%29%3B%0A%20%20if%20%28_intersections.length%20%3E%200%29%20%7B%0A%20%20%20%20if%20%28this.transformGroup%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20_selected%20%3D%20findGroup%28_intersections%5B0%5D.object%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_selected%20%3D%20_intersections%5B0%5D.object%3B%0A%20%20%20%20%7D%0A%20%20%20%20_plane.setFromNormalAndCoplanarPoint%28camera3.getWorldDirection%28_plane.normal%29%2C%20_worldPosition.setFromMatrixPosition%28_selected.matrixWorld%29%29%3B%0A%20%20%20%20if%20%28raycaster.ray.intersectPlane%28_plane%2C%20_intersection%29%29%20%7B%0A%20%20%20%20%20%20if%20%28this.state%20%3D%3D%3D%20STATE.PAN%29%20%7B%0A%20%20%20%20%20%20%20%20_inverseMatrix.copy%28_selected.parent.matrixWorld%29.invert%28%29%3B%0A%20%20%20%20%20%20%20%20_offset2.copy%28_intersection%29.sub%28_worldPosition.setFromMatrixPosition%28_selected.matrixWorld%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28this.state%20%3D%3D%3D%20STATE.ROTATE%29%20%7B%0A%20%20%20%20%20%20%20%20_up.set%280%2C%201%2C%200%29.applyQuaternion%28camera3.quaternion%29.normalize%28%29%3B%0A%20%20%20%20%20%20%20%20_right.set%281%2C%200%2C%200%29.applyQuaternion%28camera3.quaternion%29.normalize%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20domElement.style.cursor%20%3D%20%22move%22%3B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dragstart%22%2C%20object%3A%20_selected%20%7D%29%3B%0A%20%20%7D%0A%20%20_previousPointer.copy%28_pointer%29%3B%0A%7D%0Afunction%20onPointerCancel%28%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28_selected%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dragend%22%2C%20object%3A%20_selected%20%7D%29%3B%0A%20%20%20%20_selected%20%3D%20null%3B%0A%20%20%7D%0A%20%20this.domElement.style.cursor%20%3D%20_hovered%20%3F%20%22pointer%22%20%3A%20%22auto%22%3B%0A%20%20this.state%20%3D%20STATE.NONE%3B%0A%7D%0Afunction%20onContextMenu%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20event.preventDefault%28%29%3B%0A%7D%0Afunction%20findGroup%28obj%2C%20group%20%3D%20null%29%20%7B%0A%20%20if%20%28obj.isGroup%29%20group%20%3D%20obj%3B%0A%20%20if%20%28obj.parent%20%3D%3D%3D%20null%29%20return%20group%3B%0A%20%20return%20findGroup%28obj.parent%2C%20group%29%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-force-3d%2Fsrc%2Fcenter.js%0Afunction%20center_default%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20var%20nodes%2C%20strength%20%3D%201%3B%0A%20%20if%20%28x2%20%3D%3D%20null%29%20x2%20%3D%200%3B%0A%20%20if%20%28y2%20%3D%3D%20null%29%20y2%20%3D%200%3B%0A%20%20if%20%28z2%20%3D%3D%20null%29%20z2%20%3D%200%3B%0A%20%20function%20force%28%29%20%7B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes.length%2C%20node%2C%20sx%20%3D%200%2C%20sy%20%3D%200%2C%20sz%20%3D%200%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20sx%20%2B%3D%20node.x%20%7C%7C%200%2C%20sy%20%2B%3D%20node.y%20%7C%7C%200%2C%20sz%20%2B%3D%20node.z%20%7C%7C%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28sx%20%3D%20%28sx%20%2F%20n%20-%20x2%29%20%2A%20strength%2C%20sy%20%3D%20%28sy%20%2F%20n%20-%20y2%29%20%2A%20strength%2C%20sz%20%3D%20%28sz%20%2F%20n%20-%20z2%29%20%2A%20strength%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28sx%29%20%7B%0A%20%20%20%20%20%20%20%20node.x%20-%3D%20sx%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28sy%29%20%7B%0A%20%20%20%20%20%20%20%20node.y%20-%3D%20sy%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28sz%29%20%7B%0A%20%20%20%20%20%20%20%20node.z%20-%3D%20sz%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20force.initialize%20%3D%20function%28_%29%20%7B%0A%20%20%20%20nodes%20%3D%20_%3B%0A%20%20%7D%3B%0A%20%20force.x%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28x2%20%3D%20%2B_%2C%20force%29%20%3A%20x2%3B%0A%20%20%7D%3B%0A%20%20force.y%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28y2%20%3D%20%2B_%2C%20force%29%20%3A%20y2%3B%0A%20%20%7D%3B%0A%20%20force.z%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28z2%20%3D%20%2B_%2C%20force%29%20%3A%20z2%3B%0A%20%20%7D%3B%0A%20%20force.strength%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28strength%20%3D%20%2B_%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%20%20return%20force%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fadd.js%0Afunction%20add_default%28d%29%20%7B%0A%20%20const%20x2%20%3D%20%2Bthis._x.call%28null%2C%20d%29%3B%0A%20%20return%20add%28this.cover%28x2%29%2C%20x2%2C%20d%29%3B%0A%7D%0Afunction%20add%28tree%2C%20x2%2C%20d%29%20%7B%0A%20%20if%20%28isNaN%28x2%29%29%20return%20tree%3B%0A%20%20var%20parent%2C%20node%20%3D%20tree._root%2C%20leaf%20%3D%20%7B%20data%3A%20d%20%7D%2C%20x0%20%3D%20tree._x0%2C%20x1%20%3D%20tree._x1%2C%20xm%2C%20xp%2C%20right%2C%20i%2C%20j%3B%0A%20%20if%20%28%21node%29%20return%20tree._root%20%3D%20leaf%2C%20tree%3B%0A%20%20while%20%28node.length%29%20%7B%0A%20%20%20%20if%20%28right%20%3D%20x2%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%0A%20%20%20%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28parent%20%3D%20node%2C%20%21%28node%20%3D%20node%5Bi%20%3D%20%2Bright%5D%29%29%20return%20parent%5Bi%5D%20%3D%20leaf%2C%20tree%3B%0A%20%20%7D%0A%20%20xp%20%3D%20%2Btree._x.call%28null%2C%20node.data%29%3B%0A%20%20if%20%28x2%20%3D%3D%3D%20xp%29%20return%20leaf.next%20%3D%20node%2C%20parent%20%3F%20parent%5Bi%5D%20%3D%20leaf%20%3A%20tree._root%20%3D%20leaf%2C%20tree%3B%0A%20%20do%20%7B%0A%20%20%20%20parent%20%3D%20parent%20%3F%20parent%5Bi%5D%20%3D%20new%20Array%282%29%20%3A%20tree._root%20%3D%20new%20Array%282%29%3B%0A%20%20%20%20if%20%28right%20%3D%20x2%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%0A%20%20%20%20else%20x1%20%3D%20xm%3B%0A%20%20%7D%20while%20%28%28i%20%3D%20%2Bright%29%20%3D%3D%3D%20%28j%20%3D%20%2B%28xp%20%3E%3D%20xm%29%29%29%3B%0A%20%20return%20parent%5Bj%5D%20%3D%20node%2C%20parent%5Bi%5D%20%3D%20leaf%2C%20tree%3B%0A%7D%0Afunction%20addAll%28data%29%20%7B%0A%20%20if%20%28%21Array.isArray%28data%29%29%20data%20%3D%20Array.from%28data%29%3B%0A%20%20const%20n%20%3D%20data.length%3B%0A%20%20const%20xz%20%3D%20new%20Float64Array%28n%29%3B%0A%20%20let%20x0%20%3D%20Infinity%2C%20x1%20%3D%20-Infinity%3B%0A%20%20for%20%28let%20i%20%3D%200%2C%20x2%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28isNaN%28x2%20%3D%20%2Bthis._x.call%28null%2C%20data%5Bi%5D%29%29%29%20continue%3B%0A%20%20%20%20xz%5Bi%5D%20%3D%20x2%3B%0A%20%20%20%20if%20%28x2%20%3C%20x0%29%20x0%20%3D%20x2%3B%0A%20%20%20%20if%20%28x2%20%3E%20x1%29%20x1%20%3D%20x2%3B%0A%20%20%7D%0A%20%20if%20%28x0%20%3E%20x1%29%20return%20this%3B%0A%20%20this.cover%28x0%29.cover%28x1%29%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20add%28this%2C%20xz%5Bi%5D%2C%20data%5Bi%5D%29%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fcover.js%0Afunction%20cover_default%28x2%29%20%7B%0A%20%20if%20%28isNaN%28x2%20%3D%20%2Bx2%29%29%20return%20this%3B%0A%20%20var%20x0%20%3D%20this._x0%2C%20x1%20%3D%20this._x1%3B%0A%20%20if%20%28isNaN%28x0%29%29%20%7B%0A%20%20%20%20x1%20%3D%20%28x0%20%3D%20Math.floor%28x2%29%29%20%2B%201%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20z2%20%3D%20x1%20-%20x0%20%7C%7C%201%2C%20node%20%3D%20this._root%2C%20parent%2C%20i%3B%0A%20%20%20%20while%20%28x0%20%3E%20x2%20%7C%7C%20x2%20%3E%3D%20x1%29%20%7B%0A%20%20%20%20%20%20i%20%3D%20%2B%28x2%20%3C%20x0%29%3B%0A%20%20%20%20%20%20parent%20%3D%20new%20Array%282%29%2C%20parent%5Bi%5D%20%3D%20node%2C%20node%20%3D%20parent%2C%20z2%20%2A%3D%202%3B%0A%20%20%20%20%20%20switch%20%28i%29%20%7B%0A%20%20%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20%20%20x1%20%3D%20x0%20%2B%20z2%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20%20%20x0%20%3D%20x1%20-%20z2%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this._root%20%26%26%20this._root.length%29%20this._root%20%3D%20node%3B%0A%20%20%7D%0A%20%20this._x0%20%3D%20x0%3B%0A%20%20this._x1%20%3D%20x1%3B%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fdata.js%0Afunction%20data_default%28%29%20%7B%0A%20%20var%20data%20%3D%20%5B%5D%3B%0A%20%20this.visit%28function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node.length%29%20do%0A%20%20%20%20%20%20data.push%28node.data%29%3B%0A%20%20%20%20while%20%28node%20%3D%20node.next%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20data%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fextent.js%0Afunction%20extent_default%28_%29%20%7B%0A%20%20return%20arguments.length%20%3F%20this.cover%28%2B_%5B0%5D%5B0%5D%29.cover%28%2B_%5B1%5D%5B0%5D%29%20%3A%20isNaN%28this._x0%29%20%3F%20void%200%20%3A%20%5B%5Bthis._x0%5D%2C%20%5Bthis._x1%5D%5D%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fhalf.js%0Afunction%20half_default%28node%2C%20x0%2C%20x1%29%20%7B%0A%20%20this.node%20%3D%20node%3B%0A%20%20this.x0%20%3D%20x0%3B%0A%20%20this.x1%20%3D%20x1%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Ffind.js%0Afunction%20find_default%28x2%2C%20radius%29%20%7B%0A%20%20var%20data%2C%20x0%20%3D%20this._x0%2C%20x1%2C%20x22%2C%20x3%20%3D%20this._x1%2C%20halves%20%3D%20%5B%5D%2C%20node%20%3D%20this._root%2C%20q%2C%20i%3B%0A%20%20if%20%28node%29%20halves.push%28new%20half_default%28node%2C%20x0%2C%20x3%29%29%3B%0A%20%20if%20%28radius%20%3D%3D%20null%29%20radius%20%3D%20Infinity%3B%0A%20%20else%20%7B%0A%20%20%20%20x0%20%3D%20x2%20-%20radius%3B%0A%20%20%20%20x3%20%3D%20x2%20%2B%20radius%3B%0A%20%20%7D%0A%20%20while%20%28q%20%3D%20halves.pop%28%29%29%20%7B%0A%20%20%20%20if%20%28%21%28node%20%3D%20q.node%29%20%7C%7C%20%28x1%20%3D%20q.x0%29%20%3E%20x3%20%7C%7C%20%28x22%20%3D%20q.x1%29%20%3C%20x0%29%20continue%3B%0A%20%20%20%20if%20%28node.length%29%20%7B%0A%20%20%20%20%20%20var%20xm%20%3D%20%28x1%20%2B%20x22%29%20%2F%202%3B%0A%20%20%20%20%20%20halves.push%28%0A%20%20%20%20%20%20%20%20new%20half_default%28node%5B1%5D%2C%20xm%2C%20x22%29%2C%0A%20%20%20%20%20%20%20%20new%20half_default%28node%5B0%5D%2C%20x1%2C%20xm%29%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20if%20%28i%20%3D%20%2B%28x2%20%3E%3D%20xm%29%29%20%7B%0A%20%20%20%20%20%20%20%20q%20%3D%20halves%5Bhalves.length%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20halves%5Bhalves.length%20-%201%5D%20%3D%20halves%5Bhalves.length%20-%201%20-%20i%5D%3B%0A%20%20%20%20%20%20%20%20halves%5Bhalves.length%20-%201%20-%20i%5D%20%3D%20q%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20var%20d%20%3D%20Math.abs%28x2%20-%20%2Bthis._x.call%28null%2C%20node.data%29%29%3B%0A%20%20%20%20%20%20if%20%28d%20%3C%20radius%29%20%7B%0A%20%20%20%20%20%20%20%20radius%20%3D%20d%3B%0A%20%20%20%20%20%20%20%20x0%20%3D%20x2%20-%20d%3B%0A%20%20%20%20%20%20%20%20x3%20%3D%20x2%20%2B%20d%3B%0A%20%20%20%20%20%20%20%20data%20%3D%20node.data%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20data%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fremove.js%0Afunction%20remove_default%28d%29%20%7B%0A%20%20if%20%28isNaN%28x2%20%3D%20%2Bthis._x.call%28null%2C%20d%29%29%29%20return%20this%3B%0A%20%20var%20parent%2C%20node%20%3D%20this._root%2C%20retainer%2C%20previous%2C%20next%2C%20x0%20%3D%20this._x0%2C%20x1%20%3D%20this._x1%2C%20x2%2C%20xm%2C%20right%2C%20i%2C%20j%3B%0A%20%20if%20%28%21node%29%20return%20this%3B%0A%20%20if%20%28node.length%29%20while%20%28true%29%20%7B%0A%20%20%20%20if%20%28right%20%3D%20x2%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%0A%20%20%20%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28%21%28parent%20%3D%20node%2C%20node%20%3D%20node%5Bi%20%3D%20%2Bright%5D%29%29%20return%20this%3B%0A%20%20%20%20if%20%28%21node.length%29%20break%3B%0A%20%20%20%20if%20%28parent%5Bi%20%2B%201%20%26%201%5D%29%20retainer%20%3D%20parent%2C%20j%20%3D%20i%3B%0A%20%20%7D%0A%20%20while%20%28node.data%20%21%3D%3D%20d%29%20if%20%28%21%28previous%20%3D%20node%2C%20node%20%3D%20node.next%29%29%20return%20this%3B%0A%20%20if%20%28next%20%3D%20node.next%29%20delete%20node.next%3B%0A%20%20if%20%28previous%29%20return%20next%20%3F%20previous.next%20%3D%20next%20%3A%20delete%20previous.next%2C%20this%3B%0A%20%20if%20%28%21parent%29%20return%20this._root%20%3D%20next%2C%20this%3B%0A%20%20next%20%3F%20parent%5Bi%5D%20%3D%20next%20%3A%20delete%20parent%5Bi%5D%3B%0A%20%20if%20%28%28node%20%3D%20parent%5B0%5D%20%7C%7C%20parent%5B1%5D%29%20%26%26%20node%20%3D%3D%3D%20%28parent%5B1%5D%20%7C%7C%20parent%5B0%5D%29%20%26%26%20%21node.length%29%20%7B%0A%20%20%20%20if%20%28retainer%29%20retainer%5Bj%5D%20%3D%20node%3B%0A%20%20%20%20else%20this._root%20%3D%20node%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0Afunction%20removeAll%28data%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20data.length%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20this.remove%28data%5Bi%5D%29%3B%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Froot.js%0Afunction%20root_default%28%29%20%7B%0A%20%20return%20this._root%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fsize.js%0Afunction%20size_default%28%29%20%7B%0A%20%20var%20size%20%3D%200%3B%0A%20%20this.visit%28function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node.length%29%20do%0A%20%20%20%20%20%20%2B%2Bsize%3B%0A%20%20%20%20while%20%28node%20%3D%20node.next%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20size%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fvisit.js%0Afunction%20visit_default%28callback%29%20%7B%0A%20%20var%20halves%20%3D%20%5B%5D%2C%20q%2C%20node%20%3D%20this._root%2C%20child%2C%20x0%2C%20x1%3B%0A%20%20if%20%28node%29%20halves.push%28new%20half_default%28node%2C%20this._x0%2C%20this._x1%29%29%3B%0A%20%20while%20%28q%20%3D%20halves.pop%28%29%29%20%7B%0A%20%20%20%20if%20%28%21callback%28node%20%3D%20q.node%2C%20x0%20%3D%20q.x0%2C%20x1%20%3D%20q.x1%29%20%26%26%20node.length%29%20%7B%0A%20%20%20%20%20%20var%20xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B1%5D%29%20halves.push%28new%20half_default%28child%2C%20xm%2C%20x1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B0%5D%29%20halves.push%28new%20half_default%28child%2C%20x0%2C%20xm%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2FvisitAfter.js%0Afunction%20visitAfter_default%28callback%29%20%7B%0A%20%20var%20halves%20%3D%20%5B%5D%2C%20next%20%3D%20%5B%5D%2C%20q%3B%0A%20%20if%20%28this._root%29%20halves.push%28new%20half_default%28this._root%2C%20this._x0%2C%20this._x1%29%29%3B%0A%20%20while%20%28q%20%3D%20halves.pop%28%29%29%20%7B%0A%20%20%20%20var%20node%20%3D%20q.node%3B%0A%20%20%20%20if%20%28node.length%29%20%7B%0A%20%20%20%20%20%20var%20child%2C%20x0%20%3D%20q.x0%2C%20x1%20%3D%20q.x1%2C%20xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B0%5D%29%20halves.push%28new%20half_default%28child%2C%20x0%2C%20xm%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B1%5D%29%20halves.push%28new%20half_default%28child%2C%20xm%2C%20x1%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20next.push%28q%29%3B%0A%20%20%7D%0A%20%20while%20%28q%20%3D%20next.pop%28%29%29%20%7B%0A%20%20%20%20callback%28q.node%2C%20q.x0%2C%20q.x1%29%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fx.js%0Afunction%20defaultX%28d%29%20%7B%0A%20%20return%20d%5B0%5D%3B%0A%7D%0Afunction%20x_default%28_%29%20%7B%0A%20%20return%20arguments.length%20%3F%20%28this._x%20%3D%20_%2C%20this%29%20%3A%20this._x%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-binarytree%2Fsrc%2Fbinarytree.js%0Afunction%20binarytree%28nodes%2C%20x2%29%20%7B%0A%20%20var%20tree%20%3D%20new%20Binarytree%28x2%20%3D%3D%20null%20%3F%20defaultX%20%3A%20x2%2C%20NaN%2C%20NaN%29%3B%0A%20%20return%20nodes%20%3D%3D%20null%20%3F%20tree%20%3A%20tree.addAll%28nodes%29%3B%0A%7D%0Afunction%20Binarytree%28x2%2C%20x0%2C%20x1%29%20%7B%0A%20%20this._x%20%3D%20x2%3B%0A%20%20this._x0%20%3D%20x0%3B%0A%20%20this._x1%20%3D%20x1%3B%0A%20%20this._root%20%3D%20void%200%3B%0A%7D%0Afunction%20leaf_copy%28leaf%29%20%7B%0A%20%20var%20copy%20%3D%20%7B%20data%3A%20leaf.data%20%7D%2C%20next%20%3D%20copy%3B%0A%20%20while%20%28leaf%20%3D%20leaf.next%29%20next%20%3D%20next.next%20%3D%20%7B%20data%3A%20leaf.data%20%7D%3B%0A%20%20return%20copy%3B%0A%7D%0Avar%20treeProto%20%3D%20binarytree.prototype%20%3D%20Binarytree.prototype%3B%0AtreeProto.copy%20%3D%20function%28%29%20%7B%0A%20%20var%20copy%20%3D%20new%20Binarytree%28this._x%2C%20this._x0%2C%20this._x1%29%2C%20node%20%3D%20this._root%2C%20nodes%2C%20child%3B%0A%20%20if%20%28%21node%29%20return%20copy%3B%0A%20%20if%20%28%21node.length%29%20return%20copy._root%20%3D%20leaf_copy%28node%29%2C%20copy%3B%0A%20%20nodes%20%3D%20%5B%7B%20source%3A%20node%2C%20target%3A%20copy._root%20%3D%20new%20Array%282%29%20%7D%5D%3B%0A%20%20while%20%28node%20%3D%20nodes.pop%28%29%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%202%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node.source%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28child.length%29%20nodes.push%28%7B%20source%3A%20child%2C%20target%3A%20node.target%5Bi%5D%20%3D%20new%20Array%282%29%20%7D%29%3B%0A%20%20%20%20%20%20%20%20else%20node.target%5Bi%5D%20%3D%20leaf_copy%28child%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20copy%3B%0A%7D%3B%0AtreeProto.add%20%3D%20add_default%3B%0AtreeProto.addAll%20%3D%20addAll%3B%0AtreeProto.cover%20%3D%20cover_default%3B%0AtreeProto.data%20%3D%20data_default%3B%0AtreeProto.extent%20%3D%20extent_default%3B%0AtreeProto.find%20%3D%20find_default%3B%0AtreeProto.remove%20%3D%20remove_default%3B%0AtreeProto.removeAll%20%3D%20removeAll%3B%0AtreeProto.root%20%3D%20root_default%3B%0AtreeProto.size%20%3D%20size_default%3B%0AtreeProto.visit%20%3D%20visit_default%3B%0AtreeProto.visitAfter%20%3D%20visitAfter_default%3B%0AtreeProto.x%20%3D%20x_default%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fadd.js%0Afunction%20add_default2%28d%29%20%7B%0A%20%20const%20x2%20%3D%20%2Bthis._x.call%28null%2C%20d%29%2C%20y2%20%3D%20%2Bthis._y.call%28null%2C%20d%29%3B%0A%20%20return%20add2%28this.cover%28x2%2C%20y2%29%2C%20x2%2C%20y2%2C%20d%29%3B%0A%7D%0Afunction%20add2%28tree%2C%20x2%2C%20y2%2C%20d%29%20%7B%0A%20%20if%20%28isNaN%28x2%29%20%7C%7C%20isNaN%28y2%29%29%20return%20tree%3B%0A%20%20var%20parent%2C%20node%20%3D%20tree._root%2C%20leaf%20%3D%20%7B%20data%3A%20d%20%7D%2C%20x0%20%3D%20tree._x0%2C%20y0%20%3D%20tree._y0%2C%20x1%20%3D%20tree._x1%2C%20y1%20%3D%20tree._y1%2C%20xm%2C%20ym%2C%20xp%2C%20yp%2C%20right%2C%20bottom%2C%20i%2C%20j%3B%0A%20%20if%20%28%21node%29%20return%20tree._root%20%3D%20leaf%2C%20tree%3B%0A%20%20while%20%28node.length%29%20%7B%0A%20%20%20%20if%20%28right%20%3D%20x2%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%0A%20%20%20%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28bottom%20%3D%20y2%20%3E%3D%20%28ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%29%20y0%20%3D%20ym%3B%0A%20%20%20%20else%20y1%20%3D%20ym%3B%0A%20%20%20%20if%20%28parent%20%3D%20node%2C%20%21%28node%20%3D%20node%5Bi%20%3D%20bottom%20%3C%3C%201%20%7C%20right%5D%29%29%20return%20parent%5Bi%5D%20%3D%20leaf%2C%20tree%3B%0A%20%20%7D%0A%20%20xp%20%3D%20%2Btree._x.call%28null%2C%20node.data%29%3B%0A%20%20yp%20%3D%20%2Btree._y.call%28null%2C%20node.data%29%3B%0A%20%20if%20%28x2%20%3D%3D%3D%20xp%20%26%26%20y2%20%3D%3D%3D%20yp%29%20return%20leaf.next%20%3D%20node%2C%20parent%20%3F%20parent%5Bi%5D%20%3D%20leaf%20%3A%20tree._root%20%3D%20leaf%2C%20tree%3B%0A%20%20do%20%7B%0A%20%20%20%20parent%20%3D%20parent%20%3F%20parent%5Bi%5D%20%3D%20new%20Array%284%29%20%3A%20tree._root%20%3D%20new%20Array%284%29%3B%0A%20%20%20%20if%20%28right%20%3D%20x2%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%0A%20%20%20%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28bottom%20%3D%20y2%20%3E%3D%20%28ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%29%20y0%20%3D%20ym%3B%0A%20%20%20%20else%20y1%20%3D%20ym%3B%0A%20%20%7D%20while%20%28%28i%20%3D%20bottom%20%3C%3C%201%20%7C%20right%29%20%3D%3D%3D%20%28j%20%3D%20%28yp%20%3E%3D%20ym%29%20%3C%3C%201%20%7C%20xp%20%3E%3D%20xm%29%29%3B%0A%20%20return%20parent%5Bj%5D%20%3D%20node%2C%20parent%5Bi%5D%20%3D%20leaf%2C%20tree%3B%0A%7D%0Afunction%20addAll2%28data%29%20%7B%0A%20%20var%20d%2C%20i%2C%20n%20%3D%20data.length%2C%20x2%2C%20y2%2C%20xz%20%3D%20new%20Array%28n%29%2C%20yz%20%3D%20new%20Array%28n%29%2C%20x0%20%3D%20Infinity%2C%20y0%20%3D%20Infinity%2C%20x1%20%3D%20-Infinity%2C%20y1%20%3D%20-Infinity%3B%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28isNaN%28x2%20%3D%20%2Bthis._x.call%28null%2C%20d%20%3D%20data%5Bi%5D%29%29%20%7C%7C%20isNaN%28y2%20%3D%20%2Bthis._y.call%28null%2C%20d%29%29%29%20continue%3B%0A%20%20%20%20xz%5Bi%5D%20%3D%20x2%3B%0A%20%20%20%20yz%5Bi%5D%20%3D%20y2%3B%0A%20%20%20%20if%20%28x2%20%3C%20x0%29%20x0%20%3D%20x2%3B%0A%20%20%20%20if%20%28x2%20%3E%20x1%29%20x1%20%3D%20x2%3B%0A%20%20%20%20if%20%28y2%20%3C%20y0%29%20y0%20%3D%20y2%3B%0A%20%20%20%20if%20%28y2%20%3E%20y1%29%20y1%20%3D%20y2%3B%0A%20%20%7D%0A%20%20if%20%28x0%20%3E%20x1%20%7C%7C%20y0%20%3E%20y1%29%20return%20this%3B%0A%20%20this.cover%28x0%2C%20y0%29.cover%28x1%2C%20y1%29%3B%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20add2%28this%2C%20xz%5Bi%5D%2C%20yz%5Bi%5D%2C%20data%5Bi%5D%29%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fcover.js%0Afunction%20cover_default2%28x2%2C%20y2%29%20%7B%0A%20%20if%20%28isNaN%28x2%20%3D%20%2Bx2%29%20%7C%7C%20isNaN%28y2%20%3D%20%2By2%29%29%20return%20this%3B%0A%20%20var%20x0%20%3D%20this._x0%2C%20y0%20%3D%20this._y0%2C%20x1%20%3D%20this._x1%2C%20y1%20%3D%20this._y1%3B%0A%20%20if%20%28isNaN%28x0%29%29%20%7B%0A%20%20%20%20x1%20%3D%20%28x0%20%3D%20Math.floor%28x2%29%29%20%2B%201%3B%0A%20%20%20%20y1%20%3D%20%28y0%20%3D%20Math.floor%28y2%29%29%20%2B%201%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20z2%20%3D%20x1%20-%20x0%20%7C%7C%201%2C%20node%20%3D%20this._root%2C%20parent%2C%20i%3B%0A%20%20%20%20while%20%28x0%20%3E%20x2%20%7C%7C%20x2%20%3E%3D%20x1%20%7C%7C%20y0%20%3E%20y2%20%7C%7C%20y2%20%3E%3D%20y1%29%20%7B%0A%20%20%20%20%20%20i%20%3D%20%28y2%20%3C%20y0%29%20%3C%3C%201%20%7C%20x2%20%3C%20x0%3B%0A%20%20%20%20%20%20parent%20%3D%20new%20Array%284%29%2C%20parent%5Bi%5D%20%3D%20node%2C%20node%20%3D%20parent%2C%20z2%20%2A%3D%202%3B%0A%20%20%20%20%20%20switch%20%28i%29%20%7B%0A%20%20%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20%20%20x1%20%3D%20x0%20%2B%20z2%2C%20y1%20%3D%20y0%20%2B%20z2%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20%20%20x0%20%3D%20x1%20-%20z2%2C%20y1%20%3D%20y0%20%2B%20z2%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20%20%20x1%20%3D%20x0%20%2B%20z2%2C%20y0%20%3D%20y1%20-%20z2%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%203%3A%0A%20%20%20%20%20%20%20%20%20%20x0%20%3D%20x1%20-%20z2%2C%20y0%20%3D%20y1%20-%20z2%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this._root%20%26%26%20this._root.length%29%20this._root%20%3D%20node%3B%0A%20%20%7D%0A%20%20this._x0%20%3D%20x0%3B%0A%20%20this._y0%20%3D%20y0%3B%0A%20%20this._x1%20%3D%20x1%3B%0A%20%20this._y1%20%3D%20y1%3B%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fdata.js%0Afunction%20data_default2%28%29%20%7B%0A%20%20var%20data%20%3D%20%5B%5D%3B%0A%20%20this.visit%28function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node.length%29%20do%0A%20%20%20%20%20%20data.push%28node.data%29%3B%0A%20%20%20%20while%20%28node%20%3D%20node.next%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20data%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fextent.js%0Afunction%20extent_default2%28_%29%20%7B%0A%20%20return%20arguments.length%20%3F%20this.cover%28%2B_%5B0%5D%5B0%5D%2C%20%2B_%5B0%5D%5B1%5D%29.cover%28%2B_%5B1%5D%5B0%5D%2C%20%2B_%5B1%5D%5B1%5D%29%20%3A%20isNaN%28this._x0%29%20%3F%20void%200%20%3A%20%5B%5Bthis._x0%2C%20this._y0%5D%2C%20%5Bthis._x1%2C%20this._y1%5D%5D%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fquad.js%0Afunction%20quad_default%28node%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20this.node%20%3D%20node%3B%0A%20%20this.x0%20%3D%20x0%3B%0A%20%20this.y0%20%3D%20y0%3B%0A%20%20this.x1%20%3D%20x1%3B%0A%20%20this.y1%20%3D%20y1%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Ffind.js%0Afunction%20find_default2%28x2%2C%20y2%2C%20radius%29%20%7B%0A%20%20var%20data%2C%20x0%20%3D%20this._x0%2C%20y0%20%3D%20this._y0%2C%20x1%2C%20y1%2C%20x22%2C%20y22%2C%20x3%20%3D%20this._x1%2C%20y3%20%3D%20this._y1%2C%20quads%20%3D%20%5B%5D%2C%20node%20%3D%20this._root%2C%20q%2C%20i%3B%0A%20%20if%20%28node%29%20quads.push%28new%20quad_default%28node%2C%20x0%2C%20y0%2C%20x3%2C%20y3%29%29%3B%0A%20%20if%20%28radius%20%3D%3D%20null%29%20radius%20%3D%20Infinity%3B%0A%20%20else%20%7B%0A%20%20%20%20x0%20%3D%20x2%20-%20radius%2C%20y0%20%3D%20y2%20-%20radius%3B%0A%20%20%20%20x3%20%3D%20x2%20%2B%20radius%2C%20y3%20%3D%20y2%20%2B%20radius%3B%0A%20%20%20%20radius%20%2A%3D%20radius%3B%0A%20%20%7D%0A%20%20while%20%28q%20%3D%20quads.pop%28%29%29%20%7B%0A%20%20%20%20if%20%28%21%28node%20%3D%20q.node%29%20%7C%7C%20%28x1%20%3D%20q.x0%29%20%3E%20x3%20%7C%7C%20%28y1%20%3D%20q.y0%29%20%3E%20y3%20%7C%7C%20%28x22%20%3D%20q.x1%29%20%3C%20x0%20%7C%7C%20%28y22%20%3D%20q.y1%29%20%3C%20y0%29%20continue%3B%0A%20%20%20%20if%20%28node.length%29%20%7B%0A%20%20%20%20%20%20var%20xm%20%3D%20%28x1%20%2B%20x22%29%20%2F%202%2C%20ym%20%3D%20%28y1%20%2B%20y22%29%20%2F%202%3B%0A%20%20%20%20%20%20quads.push%28%0A%20%20%20%20%20%20%20%20new%20quad_default%28node%5B3%5D%2C%20xm%2C%20ym%2C%20x22%2C%20y22%29%2C%0A%20%20%20%20%20%20%20%20new%20quad_default%28node%5B2%5D%2C%20x1%2C%20ym%2C%20xm%2C%20y22%29%2C%0A%20%20%20%20%20%20%20%20new%20quad_default%28node%5B1%5D%2C%20xm%2C%20y1%2C%20x22%2C%20ym%29%2C%0A%20%20%20%20%20%20%20%20new%20quad_default%28node%5B0%5D%2C%20x1%2C%20y1%2C%20xm%2C%20ym%29%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20if%20%28i%20%3D%20%28y2%20%3E%3D%20ym%29%20%3C%3C%201%20%7C%20x2%20%3E%3D%20xm%29%20%7B%0A%20%20%20%20%20%20%20%20q%20%3D%20quads%5Bquads.length%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20quads%5Bquads.length%20-%201%5D%20%3D%20quads%5Bquads.length%20-%201%20-%20i%5D%3B%0A%20%20%20%20%20%20%20%20quads%5Bquads.length%20-%201%20-%20i%5D%20%3D%20q%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20var%20dx%20%3D%20x2%20-%20%2Bthis._x.call%28null%2C%20node.data%29%2C%20dy%20%3D%20y2%20-%20%2Bthis._y.call%28null%2C%20node.data%29%2C%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%20%20%20%20%20%20if%20%28d2%20%3C%20radius%29%20%7B%0A%20%20%20%20%20%20%20%20var%20d%20%3D%20Math.sqrt%28radius%20%3D%20d2%29%3B%0A%20%20%20%20%20%20%20%20x0%20%3D%20x2%20-%20d%2C%20y0%20%3D%20y2%20-%20d%3B%0A%20%20%20%20%20%20%20%20x3%20%3D%20x2%20%2B%20d%2C%20y3%20%3D%20y2%20%2B%20d%3B%0A%20%20%20%20%20%20%20%20data%20%3D%20node.data%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20data%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fremove.js%0Afunction%20remove_default2%28d%29%20%7B%0A%20%20if%20%28isNaN%28x2%20%3D%20%2Bthis._x.call%28null%2C%20d%29%29%20%7C%7C%20isNaN%28y2%20%3D%20%2Bthis._y.call%28null%2C%20d%29%29%29%20return%20this%3B%0A%20%20var%20parent%2C%20node%20%3D%20this._root%2C%20retainer%2C%20previous%2C%20next%2C%20x0%20%3D%20this._x0%2C%20y0%20%3D%20this._y0%2C%20x1%20%3D%20this._x1%2C%20y1%20%3D%20this._y1%2C%20x2%2C%20y2%2C%20xm%2C%20ym%2C%20right%2C%20bottom%2C%20i%2C%20j%3B%0A%20%20if%20%28%21node%29%20return%20this%3B%0A%20%20if%20%28node.length%29%20while%20%28true%29%20%7B%0A%20%20%20%20if%20%28right%20%3D%20x2%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%0A%20%20%20%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28bottom%20%3D%20y2%20%3E%3D%20%28ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%29%20y0%20%3D%20ym%3B%0A%20%20%20%20else%20y1%20%3D%20ym%3B%0A%20%20%20%20if%20%28%21%28parent%20%3D%20node%2C%20node%20%3D%20node%5Bi%20%3D%20bottom%20%3C%3C%201%20%7C%20right%5D%29%29%20return%20this%3B%0A%20%20%20%20if%20%28%21node.length%29%20break%3B%0A%20%20%20%20if%20%28parent%5Bi%20%2B%201%20%26%203%5D%20%7C%7C%20parent%5Bi%20%2B%202%20%26%203%5D%20%7C%7C%20parent%5Bi%20%2B%203%20%26%203%5D%29%20retainer%20%3D%20parent%2C%20j%20%3D%20i%3B%0A%20%20%7D%0A%20%20while%20%28node.data%20%21%3D%3D%20d%29%20if%20%28%21%28previous%20%3D%20node%2C%20node%20%3D%20node.next%29%29%20return%20this%3B%0A%20%20if%20%28next%20%3D%20node.next%29%20delete%20node.next%3B%0A%20%20if%20%28previous%29%20return%20next%20%3F%20previous.next%20%3D%20next%20%3A%20delete%20previous.next%2C%20this%3B%0A%20%20if%20%28%21parent%29%20return%20this._root%20%3D%20next%2C%20this%3B%0A%20%20next%20%3F%20parent%5Bi%5D%20%3D%20next%20%3A%20delete%20parent%5Bi%5D%3B%0A%20%20if%20%28%28node%20%3D%20parent%5B0%5D%20%7C%7C%20parent%5B1%5D%20%7C%7C%20parent%5B2%5D%20%7C%7C%20parent%5B3%5D%29%20%26%26%20node%20%3D%3D%3D%20%28parent%5B3%5D%20%7C%7C%20parent%5B2%5D%20%7C%7C%20parent%5B1%5D%20%7C%7C%20parent%5B0%5D%29%20%26%26%20%21node.length%29%20%7B%0A%20%20%20%20if%20%28retainer%29%20retainer%5Bj%5D%20%3D%20node%3B%0A%20%20%20%20else%20this._root%20%3D%20node%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0Afunction%20removeAll2%28data%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20data.length%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20this.remove%28data%5Bi%5D%29%3B%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Froot.js%0Afunction%20root_default2%28%29%20%7B%0A%20%20return%20this._root%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fsize.js%0Afunction%20size_default2%28%29%20%7B%0A%20%20var%20size%20%3D%200%3B%0A%20%20this.visit%28function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node.length%29%20do%0A%20%20%20%20%20%20%2B%2Bsize%3B%0A%20%20%20%20while%20%28node%20%3D%20node.next%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20size%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fvisit.js%0Afunction%20visit_default2%28callback%29%20%7B%0A%20%20var%20quads%20%3D%20%5B%5D%2C%20q%2C%20node%20%3D%20this._root%2C%20child%2C%20x0%2C%20y0%2C%20x1%2C%20y1%3B%0A%20%20if%20%28node%29%20quads.push%28new%20quad_default%28node%2C%20this._x0%2C%20this._y0%2C%20this._x1%2C%20this._y1%29%29%3B%0A%20%20while%20%28q%20%3D%20quads.pop%28%29%29%20%7B%0A%20%20%20%20if%20%28%21callback%28node%20%3D%20q.node%2C%20x0%20%3D%20q.x0%2C%20y0%20%3D%20q.y0%2C%20x1%20%3D%20q.x1%2C%20y1%20%3D%20q.y1%29%20%26%26%20node.length%29%20%7B%0A%20%20%20%20%20%20var%20xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%2C%20ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B3%5D%29%20quads.push%28new%20quad_default%28child%2C%20xm%2C%20ym%2C%20x1%2C%20y1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B2%5D%29%20quads.push%28new%20quad_default%28child%2C%20x0%2C%20ym%2C%20xm%2C%20y1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B1%5D%29%20quads.push%28new%20quad_default%28child%2C%20xm%2C%20y0%2C%20x1%2C%20ym%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B0%5D%29%20quads.push%28new%20quad_default%28child%2C%20x0%2C%20y0%2C%20xm%2C%20ym%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2FvisitAfter.js%0Afunction%20visitAfter_default2%28callback%29%20%7B%0A%20%20var%20quads%20%3D%20%5B%5D%2C%20next%20%3D%20%5B%5D%2C%20q%3B%0A%20%20if%20%28this._root%29%20quads.push%28new%20quad_default%28this._root%2C%20this._x0%2C%20this._y0%2C%20this._x1%2C%20this._y1%29%29%3B%0A%20%20while%20%28q%20%3D%20quads.pop%28%29%29%20%7B%0A%20%20%20%20var%20node%20%3D%20q.node%3B%0A%20%20%20%20if%20%28node.length%29%20%7B%0A%20%20%20%20%20%20var%20child%2C%20x0%20%3D%20q.x0%2C%20y0%20%3D%20q.y0%2C%20x1%20%3D%20q.x1%2C%20y1%20%3D%20q.y1%2C%20xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%2C%20ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B0%5D%29%20quads.push%28new%20quad_default%28child%2C%20x0%2C%20y0%2C%20xm%2C%20ym%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B1%5D%29%20quads.push%28new%20quad_default%28child%2C%20xm%2C%20y0%2C%20x1%2C%20ym%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B2%5D%29%20quads.push%28new%20quad_default%28child%2C%20x0%2C%20ym%2C%20xm%2C%20y1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B3%5D%29%20quads.push%28new%20quad_default%28child%2C%20xm%2C%20ym%2C%20x1%2C%20y1%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20next.push%28q%29%3B%0A%20%20%7D%0A%20%20while%20%28q%20%3D%20next.pop%28%29%29%20%7B%0A%20%20%20%20callback%28q.node%2C%20q.x0%2C%20q.y0%2C%20q.x1%2C%20q.y1%29%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fx.js%0Afunction%20defaultX2%28d%29%20%7B%0A%20%20return%20d%5B0%5D%3B%0A%7D%0Afunction%20x_default2%28_%29%20%7B%0A%20%20return%20arguments.length%20%3F%20%28this._x%20%3D%20_%2C%20this%29%20%3A%20this._x%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fy.js%0Afunction%20defaultY%28d%29%20%7B%0A%20%20return%20d%5B1%5D%3B%0A%7D%0Afunction%20y_default%28_%29%20%7B%0A%20%20return%20arguments.length%20%3F%20%28this._y%20%3D%20_%2C%20this%29%20%3A%20this._y%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-quadtree%2Fsrc%2Fquadtree.js%0Afunction%20quadtree%28nodes%2C%20x2%2C%20y2%29%20%7B%0A%20%20var%20tree%20%3D%20new%20Quadtree%28x2%20%3D%3D%20null%20%3F%20defaultX2%20%3A%20x2%2C%20y2%20%3D%3D%20null%20%3F%20defaultY%20%3A%20y2%2C%20NaN%2C%20NaN%2C%20NaN%2C%20NaN%29%3B%0A%20%20return%20nodes%20%3D%3D%20null%20%3F%20tree%20%3A%20tree.addAll%28nodes%29%3B%0A%7D%0Afunction%20Quadtree%28x2%2C%20y2%2C%20x0%2C%20y0%2C%20x1%2C%20y1%29%20%7B%0A%20%20this._x%20%3D%20x2%3B%0A%20%20this._y%20%3D%20y2%3B%0A%20%20this._x0%20%3D%20x0%3B%0A%20%20this._y0%20%3D%20y0%3B%0A%20%20this._x1%20%3D%20x1%3B%0A%20%20this._y1%20%3D%20y1%3B%0A%20%20this._root%20%3D%20void%200%3B%0A%7D%0Afunction%20leaf_copy2%28leaf%29%20%7B%0A%20%20var%20copy%20%3D%20%7B%20data%3A%20leaf.data%20%7D%2C%20next%20%3D%20copy%3B%0A%20%20while%20%28leaf%20%3D%20leaf.next%29%20next%20%3D%20next.next%20%3D%20%7B%20data%3A%20leaf.data%20%7D%3B%0A%20%20return%20copy%3B%0A%7D%0Avar%20treeProto2%20%3D%20quadtree.prototype%20%3D%20Quadtree.prototype%3B%0AtreeProto2.copy%20%3D%20function%28%29%20%7B%0A%20%20var%20copy%20%3D%20new%20Quadtree%28this._x%2C%20this._y%2C%20this._x0%2C%20this._y0%2C%20this._x1%2C%20this._y1%29%2C%20node%20%3D%20this._root%2C%20nodes%2C%20child%3B%0A%20%20if%20%28%21node%29%20return%20copy%3B%0A%20%20if%20%28%21node.length%29%20return%20copy._root%20%3D%20leaf_copy2%28node%29%2C%20copy%3B%0A%20%20nodes%20%3D%20%5B%7B%20source%3A%20node%2C%20target%3A%20copy._root%20%3D%20new%20Array%284%29%20%7D%5D%3B%0A%20%20while%20%28node%20%3D%20nodes.pop%28%29%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%204%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node.source%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28child.length%29%20nodes.push%28%7B%20source%3A%20child%2C%20target%3A%20node.target%5Bi%5D%20%3D%20new%20Array%284%29%20%7D%29%3B%0A%20%20%20%20%20%20%20%20else%20node.target%5Bi%5D%20%3D%20leaf_copy2%28child%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20copy%3B%0A%7D%3B%0AtreeProto2.add%20%3D%20add_default2%3B%0AtreeProto2.addAll%20%3D%20addAll2%3B%0AtreeProto2.cover%20%3D%20cover_default2%3B%0AtreeProto2.data%20%3D%20data_default2%3B%0AtreeProto2.extent%20%3D%20extent_default2%3B%0AtreeProto2.find%20%3D%20find_default2%3B%0AtreeProto2.remove%20%3D%20remove_default2%3B%0AtreeProto2.removeAll%20%3D%20removeAll2%3B%0AtreeProto2.root%20%3D%20root_default2%3B%0AtreeProto2.size%20%3D%20size_default2%3B%0AtreeProto2.visit%20%3D%20visit_default2%3B%0AtreeProto2.visitAfter%20%3D%20visitAfter_default2%3B%0AtreeProto2.x%20%3D%20x_default2%3B%0AtreeProto2.y%20%3D%20y_default%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fadd.js%0Afunction%20add_default3%28d%29%20%7B%0A%20%20const%20x2%20%3D%20%2Bthis._x.call%28null%2C%20d%29%2C%20y2%20%3D%20%2Bthis._y.call%28null%2C%20d%29%2C%20z2%20%3D%20%2Bthis._z.call%28null%2C%20d%29%3B%0A%20%20return%20add3%28this.cover%28x2%2C%20y2%2C%20z2%29%2C%20x2%2C%20y2%2C%20z2%2C%20d%29%3B%0A%7D%0Afunction%20add3%28tree%2C%20x2%2C%20y2%2C%20z2%2C%20d%29%20%7B%0A%20%20if%20%28isNaN%28x2%29%20%7C%7C%20isNaN%28y2%29%20%7C%7C%20isNaN%28z2%29%29%20return%20tree%3B%0A%20%20var%20parent%2C%20node%20%3D%20tree._root%2C%20leaf%20%3D%20%7B%20data%3A%20d%20%7D%2C%20x0%20%3D%20tree._x0%2C%20y0%20%3D%20tree._y0%2C%20z0%20%3D%20tree._z0%2C%20x1%20%3D%20tree._x1%2C%20y1%20%3D%20tree._y1%2C%20z1%20%3D%20tree._z1%2C%20xm%2C%20ym%2C%20zm%2C%20xp%2C%20yp%2C%20zp%2C%20right%2C%20bottom%2C%20deep%2C%20i%2C%20j%3B%0A%20%20if%20%28%21node%29%20return%20tree._root%20%3D%20leaf%2C%20tree%3B%0A%20%20while%20%28node.length%29%20%7B%0A%20%20%20%20if%20%28right%20%3D%20x2%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%0A%20%20%20%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28bottom%20%3D%20y2%20%3E%3D%20%28ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%29%20y0%20%3D%20ym%3B%0A%20%20%20%20else%20y1%20%3D%20ym%3B%0A%20%20%20%20if%20%28deep%20%3D%20z2%20%3E%3D%20%28zm%20%3D%20%28z0%20%2B%20z1%29%20%2F%202%29%29%20z0%20%3D%20zm%3B%0A%20%20%20%20else%20z1%20%3D%20zm%3B%0A%20%20%20%20if%20%28parent%20%3D%20node%2C%20%21%28node%20%3D%20node%5Bi%20%3D%20deep%20%3C%3C%202%20%7C%20bottom%20%3C%3C%201%20%7C%20right%5D%29%29%20return%20parent%5Bi%5D%20%3D%20leaf%2C%20tree%3B%0A%20%20%7D%0A%20%20xp%20%3D%20%2Btree._x.call%28null%2C%20node.data%29%3B%0A%20%20yp%20%3D%20%2Btree._y.call%28null%2C%20node.data%29%3B%0A%20%20zp%20%3D%20%2Btree._z.call%28null%2C%20node.data%29%3B%0A%20%20if%20%28x2%20%3D%3D%3D%20xp%20%26%26%20y2%20%3D%3D%3D%20yp%20%26%26%20z2%20%3D%3D%3D%20zp%29%20return%20leaf.next%20%3D%20node%2C%20parent%20%3F%20parent%5Bi%5D%20%3D%20leaf%20%3A%20tree._root%20%3D%20leaf%2C%20tree%3B%0A%20%20do%20%7B%0A%20%20%20%20parent%20%3D%20parent%20%3F%20parent%5Bi%5D%20%3D%20new%20Array%288%29%20%3A%20tree._root%20%3D%20new%20Array%288%29%3B%0A%20%20%20%20if%20%28right%20%3D%20x2%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%0A%20%20%20%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28bottom%20%3D%20y2%20%3E%3D%20%28ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%29%20y0%20%3D%20ym%3B%0A%20%20%20%20else%20y1%20%3D%20ym%3B%0A%20%20%20%20if%20%28deep%20%3D%20z2%20%3E%3D%20%28zm%20%3D%20%28z0%20%2B%20z1%29%20%2F%202%29%29%20z0%20%3D%20zm%3B%0A%20%20%20%20else%20z1%20%3D%20zm%3B%0A%20%20%7D%20while%20%28%28i%20%3D%20deep%20%3C%3C%202%20%7C%20bottom%20%3C%3C%201%20%7C%20right%29%20%3D%3D%3D%20%28j%20%3D%20%28zp%20%3E%3D%20zm%29%20%3C%3C%202%20%7C%20%28yp%20%3E%3D%20ym%29%20%3C%3C%201%20%7C%20xp%20%3E%3D%20xm%29%29%3B%0A%20%20return%20parent%5Bj%5D%20%3D%20node%2C%20parent%5Bi%5D%20%3D%20leaf%2C%20tree%3B%0A%7D%0Afunction%20addAll3%28data%29%20%7B%0A%20%20if%20%28%21Array.isArray%28data%29%29%20data%20%3D%20Array.from%28data%29%3B%0A%20%20const%20n%20%3D%20data.length%3B%0A%20%20const%20xz%20%3D%20new%20Float64Array%28n%29%3B%0A%20%20const%20yz%20%3D%20new%20Float64Array%28n%29%3B%0A%20%20const%20zz%20%3D%20new%20Float64Array%28n%29%3B%0A%20%20let%20x0%20%3D%20Infinity%2C%20y0%20%3D%20Infinity%2C%20z0%20%3D%20Infinity%2C%20x1%20%3D%20-Infinity%2C%20y1%20%3D%20-Infinity%2C%20z1%20%3D%20-Infinity%3B%0A%20%20for%20%28let%20i%20%3D%200%2C%20d%2C%20x2%2C%20y2%2C%20z2%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28isNaN%28x2%20%3D%20%2Bthis._x.call%28null%2C%20d%20%3D%20data%5Bi%5D%29%29%20%7C%7C%20isNaN%28y2%20%3D%20%2Bthis._y.call%28null%2C%20d%29%29%20%7C%7C%20isNaN%28z2%20%3D%20%2Bthis._z.call%28null%2C%20d%29%29%29%20continue%3B%0A%20%20%20%20xz%5Bi%5D%20%3D%20x2%3B%0A%20%20%20%20yz%5Bi%5D%20%3D%20y2%3B%0A%20%20%20%20zz%5Bi%5D%20%3D%20z2%3B%0A%20%20%20%20if%20%28x2%20%3C%20x0%29%20x0%20%3D%20x2%3B%0A%20%20%20%20if%20%28x2%20%3E%20x1%29%20x1%20%3D%20x2%3B%0A%20%20%20%20if%20%28y2%20%3C%20y0%29%20y0%20%3D%20y2%3B%0A%20%20%20%20if%20%28y2%20%3E%20y1%29%20y1%20%3D%20y2%3B%0A%20%20%20%20if%20%28z2%20%3C%20z0%29%20z0%20%3D%20z2%3B%0A%20%20%20%20if%20%28z2%20%3E%20z1%29%20z1%20%3D%20z2%3B%0A%20%20%7D%0A%20%20if%20%28x0%20%3E%20x1%20%7C%7C%20y0%20%3E%20y1%20%7C%7C%20z0%20%3E%20z1%29%20return%20this%3B%0A%20%20this.cover%28x0%2C%20y0%2C%20z0%29.cover%28x1%2C%20y1%2C%20z1%29%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20add3%28this%2C%20xz%5Bi%5D%2C%20yz%5Bi%5D%2C%20zz%5Bi%5D%2C%20data%5Bi%5D%29%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fcover.js%0Afunction%20cover_default3%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20if%20%28isNaN%28x2%20%3D%20%2Bx2%29%20%7C%7C%20isNaN%28y2%20%3D%20%2By2%29%20%7C%7C%20isNaN%28z2%20%3D%20%2Bz2%29%29%20return%20this%3B%0A%20%20var%20x0%20%3D%20this._x0%2C%20y0%20%3D%20this._y0%2C%20z0%20%3D%20this._z0%2C%20x1%20%3D%20this._x1%2C%20y1%20%3D%20this._y1%2C%20z1%20%3D%20this._z1%3B%0A%20%20if%20%28isNaN%28x0%29%29%20%7B%0A%20%20%20%20x1%20%3D%20%28x0%20%3D%20Math.floor%28x2%29%29%20%2B%201%3B%0A%20%20%20%20y1%20%3D%20%28y0%20%3D%20Math.floor%28y2%29%29%20%2B%201%3B%0A%20%20%20%20z1%20%3D%20%28z0%20%3D%20Math.floor%28z2%29%29%20%2B%201%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20t%20%3D%20x1%20-%20x0%20%7C%7C%201%2C%20node%20%3D%20this._root%2C%20parent%2C%20i%3B%0A%20%20%20%20while%20%28x0%20%3E%20x2%20%7C%7C%20x2%20%3E%3D%20x1%20%7C%7C%20y0%20%3E%20y2%20%7C%7C%20y2%20%3E%3D%20y1%20%7C%7C%20z0%20%3E%20z2%20%7C%7C%20z2%20%3E%3D%20z1%29%20%7B%0A%20%20%20%20%20%20i%20%3D%20%28z2%20%3C%20z0%29%20%3C%3C%202%20%7C%20%28y2%20%3C%20y0%29%20%3C%3C%201%20%7C%20x2%20%3C%20x0%3B%0A%20%20%20%20%20%20parent%20%3D%20new%20Array%288%29%2C%20parent%5Bi%5D%20%3D%20node%2C%20node%20%3D%20parent%2C%20t%20%2A%3D%202%3B%0A%20%20%20%20%20%20switch%20%28i%29%20%7B%0A%20%20%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20%20%20x1%20%3D%20x0%20%2B%20t%2C%20y1%20%3D%20y0%20%2B%20t%2C%20z1%20%3D%20z0%20%2B%20t%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20%20%20x0%20%3D%20x1%20-%20t%2C%20y1%20%3D%20y0%20%2B%20t%2C%20z1%20%3D%20z0%20%2B%20t%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20%20%20x1%20%3D%20x0%20%2B%20t%2C%20y0%20%3D%20y1%20-%20t%2C%20z1%20%3D%20z0%20%2B%20t%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%203%3A%0A%20%20%20%20%20%20%20%20%20%20x0%20%3D%20x1%20-%20t%2C%20y0%20%3D%20y1%20-%20t%2C%20z1%20%3D%20z0%20%2B%20t%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%204%3A%0A%20%20%20%20%20%20%20%20%20%20x1%20%3D%20x0%20%2B%20t%2C%20y1%20%3D%20y0%20%2B%20t%2C%20z0%20%3D%20z1%20-%20t%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%205%3A%0A%20%20%20%20%20%20%20%20%20%20x0%20%3D%20x1%20-%20t%2C%20y1%20%3D%20y0%20%2B%20t%2C%20z0%20%3D%20z1%20-%20t%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%206%3A%0A%20%20%20%20%20%20%20%20%20%20x1%20%3D%20x0%20%2B%20t%2C%20y0%20%3D%20y1%20-%20t%2C%20z0%20%3D%20z1%20-%20t%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%207%3A%0A%20%20%20%20%20%20%20%20%20%20x0%20%3D%20x1%20-%20t%2C%20y0%20%3D%20y1%20-%20t%2C%20z0%20%3D%20z1%20-%20t%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this._root%20%26%26%20this._root.length%29%20this._root%20%3D%20node%3B%0A%20%20%7D%0A%20%20this._x0%20%3D%20x0%3B%0A%20%20this._y0%20%3D%20y0%3B%0A%20%20this._z0%20%3D%20z0%3B%0A%20%20this._x1%20%3D%20x1%3B%0A%20%20this._y1%20%3D%20y1%3B%0A%20%20this._z1%20%3D%20z1%3B%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fdata.js%0Afunction%20data_default3%28%29%20%7B%0A%20%20var%20data%20%3D%20%5B%5D%3B%0A%20%20this.visit%28function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node.length%29%20do%0A%20%20%20%20%20%20data.push%28node.data%29%3B%0A%20%20%20%20while%20%28node%20%3D%20node.next%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20data%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fextent.js%0Afunction%20extent_default3%28_%29%20%7B%0A%20%20return%20arguments.length%20%3F%20this.cover%28%2B_%5B0%5D%5B0%5D%2C%20%2B_%5B0%5D%5B1%5D%2C%20%2B_%5B0%5D%5B2%5D%29.cover%28%2B_%5B1%5D%5B0%5D%2C%20%2B_%5B1%5D%5B1%5D%2C%20%2B_%5B1%5D%5B2%5D%29%20%3A%20isNaN%28this._x0%29%20%3F%20void%200%20%3A%20%5B%5Bthis._x0%2C%20this._y0%2C%20this._z0%5D%2C%20%5Bthis._x1%2C%20this._y1%2C%20this._z1%5D%5D%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Foctant.js%0Afunction%20octant_default%28node%2C%20x0%2C%20y0%2C%20z0%2C%20x1%2C%20y1%2C%20z1%29%20%7B%0A%20%20this.node%20%3D%20node%3B%0A%20%20this.x0%20%3D%20x0%3B%0A%20%20this.y0%20%3D%20y0%3B%0A%20%20this.z0%20%3D%20z0%3B%0A%20%20this.x1%20%3D%20x1%3B%0A%20%20this.y1%20%3D%20y1%3B%0A%20%20this.z1%20%3D%20z1%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Ffind.js%0Afunction%20find_default3%28x2%2C%20y2%2C%20z2%2C%20radius%29%20%7B%0A%20%20var%20data%2C%20x0%20%3D%20this._x0%2C%20y0%20%3D%20this._y0%2C%20z0%20%3D%20this._z0%2C%20x1%2C%20y1%2C%20z1%2C%20x22%2C%20y22%2C%20z22%2C%20x3%20%3D%20this._x1%2C%20y3%20%3D%20this._y1%2C%20z3%20%3D%20this._z1%2C%20octs%20%3D%20%5B%5D%2C%20node%20%3D%20this._root%2C%20q%2C%20i%3B%0A%20%20if%20%28node%29%20octs.push%28new%20octant_default%28node%2C%20x0%2C%20y0%2C%20z0%2C%20x3%2C%20y3%2C%20z3%29%29%3B%0A%20%20if%20%28radius%20%3D%3D%20null%29%20radius%20%3D%20Infinity%3B%0A%20%20else%20%7B%0A%20%20%20%20x0%20%3D%20x2%20-%20radius%2C%20y0%20%3D%20y2%20-%20radius%2C%20z0%20%3D%20z2%20-%20radius%3B%0A%20%20%20%20x3%20%3D%20x2%20%2B%20radius%2C%20y3%20%3D%20y2%20%2B%20radius%2C%20z3%20%3D%20z2%20%2B%20radius%3B%0A%20%20%20%20radius%20%2A%3D%20radius%3B%0A%20%20%7D%0A%20%20while%20%28q%20%3D%20octs.pop%28%29%29%20%7B%0A%20%20%20%20if%20%28%21%28node%20%3D%20q.node%29%20%7C%7C%20%28x1%20%3D%20q.x0%29%20%3E%20x3%20%7C%7C%20%28y1%20%3D%20q.y0%29%20%3E%20y3%20%7C%7C%20%28z1%20%3D%20q.z0%29%20%3E%20z3%20%7C%7C%20%28x22%20%3D%20q.x1%29%20%3C%20x0%20%7C%7C%20%28y22%20%3D%20q.y1%29%20%3C%20y0%20%7C%7C%20%28z22%20%3D%20q.z1%29%20%3C%20z0%29%20continue%3B%0A%20%20%20%20if%20%28node.length%29%20%7B%0A%20%20%20%20%20%20var%20xm%20%3D%20%28x1%20%2B%20x22%29%20%2F%202%2C%20ym%20%3D%20%28y1%20%2B%20y22%29%20%2F%202%2C%20zm%20%3D%20%28z1%20%2B%20z22%29%20%2F%202%3B%0A%20%20%20%20%20%20octs.push%28%0A%20%20%20%20%20%20%20%20new%20octant_default%28node%5B7%5D%2C%20xm%2C%20ym%2C%20zm%2C%20x22%2C%20y22%2C%20z22%29%2C%0A%20%20%20%20%20%20%20%20new%20octant_default%28node%5B6%5D%2C%20x1%2C%20ym%2C%20zm%2C%20xm%2C%20y22%2C%20z22%29%2C%0A%20%20%20%20%20%20%20%20new%20octant_default%28node%5B5%5D%2C%20xm%2C%20y1%2C%20zm%2C%20x22%2C%20ym%2C%20z22%29%2C%0A%20%20%20%20%20%20%20%20new%20octant_default%28node%5B4%5D%2C%20x1%2C%20y1%2C%20zm%2C%20xm%2C%20ym%2C%20z22%29%2C%0A%20%20%20%20%20%20%20%20new%20octant_default%28node%5B3%5D%2C%20xm%2C%20ym%2C%20z1%2C%20x22%2C%20y22%2C%20zm%29%2C%0A%20%20%20%20%20%20%20%20new%20octant_default%28node%5B2%5D%2C%20x1%2C%20ym%2C%20z1%2C%20xm%2C%20y22%2C%20zm%29%2C%0A%20%20%20%20%20%20%20%20new%20octant_default%28node%5B1%5D%2C%20xm%2C%20y1%2C%20z1%2C%20x22%2C%20ym%2C%20zm%29%2C%0A%20%20%20%20%20%20%20%20new%20octant_default%28node%5B0%5D%2C%20x1%2C%20y1%2C%20z1%2C%20xm%2C%20ym%2C%20zm%29%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20if%20%28i%20%3D%20%28z2%20%3E%3D%20zm%29%20%3C%3C%202%20%7C%20%28y2%20%3E%3D%20ym%29%20%3C%3C%201%20%7C%20x2%20%3E%3D%20xm%29%20%7B%0A%20%20%20%20%20%20%20%20q%20%3D%20octs%5Bocts.length%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20octs%5Bocts.length%20-%201%5D%20%3D%20octs%5Bocts.length%20-%201%20-%20i%5D%3B%0A%20%20%20%20%20%20%20%20octs%5Bocts.length%20-%201%20-%20i%5D%20%3D%20q%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20var%20dx%20%3D%20x2%20-%20%2Bthis._x.call%28null%2C%20node.data%29%2C%20dy%20%3D%20y2%20-%20%2Bthis._y.call%28null%2C%20node.data%29%2C%20dz%20%3D%20z2%20-%20%2Bthis._z.call%28null%2C%20node.data%29%2C%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%20%2B%20dz%20%2A%20dz%3B%0A%20%20%20%20%20%20if%20%28d2%20%3C%20radius%29%20%7B%0A%20%20%20%20%20%20%20%20var%20d%20%3D%20Math.sqrt%28radius%20%3D%20d2%29%3B%0A%20%20%20%20%20%20%20%20x0%20%3D%20x2%20-%20d%2C%20y0%20%3D%20y2%20-%20d%2C%20z0%20%3D%20z2%20-%20d%3B%0A%20%20%20%20%20%20%20%20x3%20%3D%20x2%20%2B%20d%2C%20y3%20%3D%20y2%20%2B%20d%2C%20z3%20%3D%20z2%20%2B%20d%3B%0A%20%20%20%20%20%20%20%20data%20%3D%20node.data%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20data%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fremove.js%0Afunction%20remove_default3%28d%29%20%7B%0A%20%20if%20%28isNaN%28x2%20%3D%20%2Bthis._x.call%28null%2C%20d%29%29%20%7C%7C%20isNaN%28y2%20%3D%20%2Bthis._y.call%28null%2C%20d%29%29%20%7C%7C%20isNaN%28z2%20%3D%20%2Bthis._z.call%28null%2C%20d%29%29%29%20return%20this%3B%0A%20%20var%20parent%2C%20node%20%3D%20this._root%2C%20retainer%2C%20previous%2C%20next%2C%20x0%20%3D%20this._x0%2C%20y0%20%3D%20this._y0%2C%20z0%20%3D%20this._z0%2C%20x1%20%3D%20this._x1%2C%20y1%20%3D%20this._y1%2C%20z1%20%3D%20this._z1%2C%20x2%2C%20y2%2C%20z2%2C%20xm%2C%20ym%2C%20zm%2C%20right%2C%20bottom%2C%20deep%2C%20i%2C%20j%3B%0A%20%20if%20%28%21node%29%20return%20this%3B%0A%20%20if%20%28node.length%29%20while%20%28true%29%20%7B%0A%20%20%20%20if%20%28right%20%3D%20x2%20%3E%3D%20%28xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%29%29%20x0%20%3D%20xm%3B%0A%20%20%20%20else%20x1%20%3D%20xm%3B%0A%20%20%20%20if%20%28bottom%20%3D%20y2%20%3E%3D%20%28ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%29%29%20y0%20%3D%20ym%3B%0A%20%20%20%20else%20y1%20%3D%20ym%3B%0A%20%20%20%20if%20%28deep%20%3D%20z2%20%3E%3D%20%28zm%20%3D%20%28z0%20%2B%20z1%29%20%2F%202%29%29%20z0%20%3D%20zm%3B%0A%20%20%20%20else%20z1%20%3D%20zm%3B%0A%20%20%20%20if%20%28%21%28parent%20%3D%20node%2C%20node%20%3D%20node%5Bi%20%3D%20deep%20%3C%3C%202%20%7C%20bottom%20%3C%3C%201%20%7C%20right%5D%29%29%20return%20this%3B%0A%20%20%20%20if%20%28%21node.length%29%20break%3B%0A%20%20%20%20if%20%28parent%5Bi%20%2B%201%20%26%207%5D%20%7C%7C%20parent%5Bi%20%2B%202%20%26%207%5D%20%7C%7C%20parent%5Bi%20%2B%203%20%26%207%5D%20%7C%7C%20parent%5Bi%20%2B%204%20%26%207%5D%20%7C%7C%20parent%5Bi%20%2B%205%20%26%207%5D%20%7C%7C%20parent%5Bi%20%2B%206%20%26%207%5D%20%7C%7C%20parent%5Bi%20%2B%207%20%26%207%5D%29%20retainer%20%3D%20parent%2C%20j%20%3D%20i%3B%0A%20%20%7D%0A%20%20while%20%28node.data%20%21%3D%3D%20d%29%20if%20%28%21%28previous%20%3D%20node%2C%20node%20%3D%20node.next%29%29%20return%20this%3B%0A%20%20if%20%28next%20%3D%20node.next%29%20delete%20node.next%3B%0A%20%20if%20%28previous%29%20return%20next%20%3F%20previous.next%20%3D%20next%20%3A%20delete%20previous.next%2C%20this%3B%0A%20%20if%20%28%21parent%29%20return%20this._root%20%3D%20next%2C%20this%3B%0A%20%20next%20%3F%20parent%5Bi%5D%20%3D%20next%20%3A%20delete%20parent%5Bi%5D%3B%0A%20%20if%20%28%28node%20%3D%20parent%5B0%5D%20%7C%7C%20parent%5B1%5D%20%7C%7C%20parent%5B2%5D%20%7C%7C%20parent%5B3%5D%20%7C%7C%20parent%5B4%5D%20%7C%7C%20parent%5B5%5D%20%7C%7C%20parent%5B6%5D%20%7C%7C%20parent%5B7%5D%29%20%26%26%20node%20%3D%3D%3D%20%28parent%5B7%5D%20%7C%7C%20parent%5B6%5D%20%7C%7C%20parent%5B5%5D%20%7C%7C%20parent%5B4%5D%20%7C%7C%20parent%5B3%5D%20%7C%7C%20parent%5B2%5D%20%7C%7C%20parent%5B1%5D%20%7C%7C%20parent%5B0%5D%29%20%26%26%20%21node.length%29%20%7B%0A%20%20%20%20if%20%28retainer%29%20retainer%5Bj%5D%20%3D%20node%3B%0A%20%20%20%20else%20this._root%20%3D%20node%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0Afunction%20removeAll3%28data%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20data.length%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20this.remove%28data%5Bi%5D%29%3B%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Froot.js%0Afunction%20root_default3%28%29%20%7B%0A%20%20return%20this._root%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fsize.js%0Afunction%20size_default3%28%29%20%7B%0A%20%20var%20size%20%3D%200%3B%0A%20%20this.visit%28function%28node%29%20%7B%0A%20%20%20%20if%20%28%21node.length%29%20do%0A%20%20%20%20%20%20%2B%2Bsize%3B%0A%20%20%20%20while%20%28node%20%3D%20node.next%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20size%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fvisit.js%0Afunction%20visit_default3%28callback%29%20%7B%0A%20%20var%20octs%20%3D%20%5B%5D%2C%20q%2C%20node%20%3D%20this._root%2C%20child%2C%20x0%2C%20y0%2C%20z0%2C%20x1%2C%20y1%2C%20z1%3B%0A%20%20if%20%28node%29%20octs.push%28new%20octant_default%28node%2C%20this._x0%2C%20this._y0%2C%20this._z0%2C%20this._x1%2C%20this._y1%2C%20this._z1%29%29%3B%0A%20%20while%20%28q%20%3D%20octs.pop%28%29%29%20%7B%0A%20%20%20%20if%20%28%21callback%28node%20%3D%20q.node%2C%20x0%20%3D%20q.x0%2C%20y0%20%3D%20q.y0%2C%20z0%20%3D%20q.z0%2C%20x1%20%3D%20q.x1%2C%20y1%20%3D%20q.y1%2C%20z1%20%3D%20q.z1%29%20%26%26%20node.length%29%20%7B%0A%20%20%20%20%20%20var%20xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%2C%20ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%2C%20zm%20%3D%20%28z0%20%2B%20z1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B7%5D%29%20octs.push%28new%20octant_default%28child%2C%20xm%2C%20ym%2C%20zm%2C%20x1%2C%20y1%2C%20z1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B6%5D%29%20octs.push%28new%20octant_default%28child%2C%20x0%2C%20ym%2C%20zm%2C%20xm%2C%20y1%2C%20z1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B5%5D%29%20octs.push%28new%20octant_default%28child%2C%20xm%2C%20y0%2C%20zm%2C%20x1%2C%20ym%2C%20z1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B4%5D%29%20octs.push%28new%20octant_default%28child%2C%20x0%2C%20y0%2C%20zm%2C%20xm%2C%20ym%2C%20z1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B3%5D%29%20octs.push%28new%20octant_default%28child%2C%20xm%2C%20ym%2C%20z0%2C%20x1%2C%20y1%2C%20zm%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B2%5D%29%20octs.push%28new%20octant_default%28child%2C%20x0%2C%20ym%2C%20z0%2C%20xm%2C%20y1%2C%20zm%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B1%5D%29%20octs.push%28new%20octant_default%28child%2C%20xm%2C%20y0%2C%20z0%2C%20x1%2C%20ym%2C%20zm%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B0%5D%29%20octs.push%28new%20octant_default%28child%2C%20x0%2C%20y0%2C%20z0%2C%20xm%2C%20ym%2C%20zm%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2FvisitAfter.js%0Afunction%20visitAfter_default3%28callback%29%20%7B%0A%20%20var%20octs%20%3D%20%5B%5D%2C%20next%20%3D%20%5B%5D%2C%20q%3B%0A%20%20if%20%28this._root%29%20octs.push%28new%20octant_default%28this._root%2C%20this._x0%2C%20this._y0%2C%20this._z0%2C%20this._x1%2C%20this._y1%2C%20this._z1%29%29%3B%0A%20%20while%20%28q%20%3D%20octs.pop%28%29%29%20%7B%0A%20%20%20%20var%20node%20%3D%20q.node%3B%0A%20%20%20%20if%20%28node.length%29%20%7B%0A%20%20%20%20%20%20var%20child%2C%20x0%20%3D%20q.x0%2C%20y0%20%3D%20q.y0%2C%20z0%20%3D%20q.z0%2C%20x1%20%3D%20q.x1%2C%20y1%20%3D%20q.y1%2C%20z1%20%3D%20q.z1%2C%20xm%20%3D%20%28x0%20%2B%20x1%29%20%2F%202%2C%20ym%20%3D%20%28y0%20%2B%20y1%29%20%2F%202%2C%20zm%20%3D%20%28z0%20%2B%20z1%29%20%2F%202%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B0%5D%29%20octs.push%28new%20octant_default%28child%2C%20x0%2C%20y0%2C%20z0%2C%20xm%2C%20ym%2C%20zm%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B1%5D%29%20octs.push%28new%20octant_default%28child%2C%20xm%2C%20y0%2C%20z0%2C%20x1%2C%20ym%2C%20zm%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B2%5D%29%20octs.push%28new%20octant_default%28child%2C%20x0%2C%20ym%2C%20z0%2C%20xm%2C%20y1%2C%20zm%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B3%5D%29%20octs.push%28new%20octant_default%28child%2C%20xm%2C%20ym%2C%20z0%2C%20x1%2C%20y1%2C%20zm%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B4%5D%29%20octs.push%28new%20octant_default%28child%2C%20x0%2C%20y0%2C%20zm%2C%20xm%2C%20ym%2C%20z1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B5%5D%29%20octs.push%28new%20octant_default%28child%2C%20xm%2C%20y0%2C%20zm%2C%20x1%2C%20ym%2C%20z1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B6%5D%29%20octs.push%28new%20octant_default%28child%2C%20x0%2C%20ym%2C%20zm%2C%20xm%2C%20y1%2C%20z1%29%29%3B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node%5B7%5D%29%20octs.push%28new%20octant_default%28child%2C%20xm%2C%20ym%2C%20zm%2C%20x1%2C%20y1%2C%20z1%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20next.push%28q%29%3B%0A%20%20%7D%0A%20%20while%20%28q%20%3D%20next.pop%28%29%29%20%7B%0A%20%20%20%20callback%28q.node%2C%20q.x0%2C%20q.y0%2C%20q.z0%2C%20q.x1%2C%20q.y1%2C%20q.z1%29%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fx.js%0Afunction%20defaultX3%28d%29%20%7B%0A%20%20return%20d%5B0%5D%3B%0A%7D%0Afunction%20x_default3%28_%29%20%7B%0A%20%20return%20arguments.length%20%3F%20%28this._x%20%3D%20_%2C%20this%29%20%3A%20this._x%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fy.js%0Afunction%20defaultY2%28d%29%20%7B%0A%20%20return%20d%5B1%5D%3B%0A%7D%0Afunction%20y_default2%28_%29%20%7B%0A%20%20return%20arguments.length%20%3F%20%28this._y%20%3D%20_%2C%20this%29%20%3A%20this._y%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Fz.js%0Afunction%20defaultZ%28d%29%20%7B%0A%20%20return%20d%5B2%5D%3B%0A%7D%0Afunction%20z_default%28_%29%20%7B%0A%20%20return%20arguments.length%20%3F%20%28this._z%20%3D%20_%2C%20this%29%20%3A%20this._z%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-octree%2Fsrc%2Foctree.js%0Afunction%20octree%28nodes%2C%20x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20var%20tree%20%3D%20new%20Octree%28x2%20%3D%3D%20null%20%3F%20defaultX3%20%3A%20x2%2C%20y2%20%3D%3D%20null%20%3F%20defaultY2%20%3A%20y2%2C%20z2%20%3D%3D%20null%20%3F%20defaultZ%20%3A%20z2%2C%20NaN%2C%20NaN%2C%20NaN%2C%20NaN%2C%20NaN%2C%20NaN%29%3B%0A%20%20return%20nodes%20%3D%3D%20null%20%3F%20tree%20%3A%20tree.addAll%28nodes%29%3B%0A%7D%0Afunction%20Octree%28x2%2C%20y2%2C%20z2%2C%20x0%2C%20y0%2C%20z0%2C%20x1%2C%20y1%2C%20z1%29%20%7B%0A%20%20this._x%20%3D%20x2%3B%0A%20%20this._y%20%3D%20y2%3B%0A%20%20this._z%20%3D%20z2%3B%0A%20%20this._x0%20%3D%20x0%3B%0A%20%20this._y0%20%3D%20y0%3B%0A%20%20this._z0%20%3D%20z0%3B%0A%20%20this._x1%20%3D%20x1%3B%0A%20%20this._y1%20%3D%20y1%3B%0A%20%20this._z1%20%3D%20z1%3B%0A%20%20this._root%20%3D%20void%200%3B%0A%7D%0Afunction%20leaf_copy3%28leaf%29%20%7B%0A%20%20var%20copy%20%3D%20%7B%20data%3A%20leaf.data%20%7D%2C%20next%20%3D%20copy%3B%0A%20%20while%20%28leaf%20%3D%20leaf.next%29%20next%20%3D%20next.next%20%3D%20%7B%20data%3A%20leaf.data%20%7D%3B%0A%20%20return%20copy%3B%0A%7D%0Avar%20treeProto3%20%3D%20octree.prototype%20%3D%20Octree.prototype%3B%0AtreeProto3.copy%20%3D%20function%28%29%20%7B%0A%20%20var%20copy%20%3D%20new%20Octree%28this._x%2C%20this._y%2C%20this._z%2C%20this._x0%2C%20this._y0%2C%20this._z0%2C%20this._x1%2C%20this._y1%2C%20this._z1%29%2C%20node%20%3D%20this._root%2C%20nodes%2C%20child%3B%0A%20%20if%20%28%21node%29%20return%20copy%3B%0A%20%20if%20%28%21node.length%29%20return%20copy._root%20%3D%20leaf_copy3%28node%29%2C%20copy%3B%0A%20%20nodes%20%3D%20%5B%7B%20source%3A%20node%2C%20target%3A%20copy._root%20%3D%20new%20Array%288%29%20%7D%5D%3B%0A%20%20while%20%28node%20%3D%20nodes.pop%28%29%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%208%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20if%20%28child%20%3D%20node.source%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28child.length%29%20nodes.push%28%7B%20source%3A%20child%2C%20target%3A%20node.target%5Bi%5D%20%3D%20new%20Array%288%29%20%7D%29%3B%0A%20%20%20%20%20%20%20%20else%20node.target%5Bi%5D%20%3D%20leaf_copy3%28child%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20copy%3B%0A%7D%3B%0AtreeProto3.add%20%3D%20add_default3%3B%0AtreeProto3.addAll%20%3D%20addAll3%3B%0AtreeProto3.cover%20%3D%20cover_default3%3B%0AtreeProto3.data%20%3D%20data_default3%3B%0AtreeProto3.extent%20%3D%20extent_default3%3B%0AtreeProto3.find%20%3D%20find_default3%3B%0AtreeProto3.remove%20%3D%20remove_default3%3B%0AtreeProto3.removeAll%20%3D%20removeAll3%3B%0AtreeProto3.root%20%3D%20root_default3%3B%0AtreeProto3.size%20%3D%20size_default3%3B%0AtreeProto3.visit%20%3D%20visit_default3%3B%0AtreeProto3.visitAfter%20%3D%20visitAfter_default3%3B%0AtreeProto3.x%20%3D%20x_default3%3B%0AtreeProto3.y%20%3D%20y_default2%3B%0AtreeProto3.z%20%3D%20z_default%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-force-3d%2Fsrc%2Fconstant.js%0Afunction%20constant_default%28x2%29%20%7B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20return%20x2%3B%0A%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-force-3d%2Fsrc%2Fjiggle.js%0Afunction%20jiggle_default%28random%29%20%7B%0A%20%20return%20%28random%28%29%20-%200.5%29%20%2A%201e-6%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-force-3d%2Fsrc%2Flink.js%0Afunction%20index%28d%29%20%7B%0A%20%20return%20d.index%3B%0A%7D%0Afunction%20find%28nodeById%2C%20nodeId%29%20%7B%0A%20%20var%20node%20%3D%20nodeById.get%28nodeId%29%3B%0A%20%20if%20%28%21node%29%20throw%20new%20Error%28%22node%20not%20found%3A%20%22%20%2B%20nodeId%29%3B%0A%20%20return%20node%3B%0A%7D%0Afunction%20link_default%28links%29%20%7B%0A%20%20var%20id2%20%3D%20index%2C%20strength%20%3D%20defaultStrength%2C%20strengths%2C%20distance2%20%3D%20constant_default%2830%29%2C%20distances%2C%20nodes%2C%20nDim%2C%20count%2C%20bias%2C%20random%2C%20iterations%20%3D%201%3B%0A%20%20if%20%28links%20%3D%3D%20null%29%20links%20%3D%20%5B%5D%3B%0A%20%20function%20defaultStrength%28link%29%20%7B%0A%20%20%20%20return%201%20%2F%20Math.min%28count%5Blink.source.index%5D%2C%20count%5Blink.target.index%5D%29%3B%0A%20%20%7D%0A%20%20function%20force%28alpha%29%20%7B%0A%20%20%20%20for%20%28var%20k%20%3D%200%2C%20n%20%3D%20links.length%3B%20k%20%3C%20iterations%3B%20%2B%2Bk%29%20%7B%0A%20%20%20%20%20%20for%20%28var%20i%20%3D%200%2C%20link%2C%20source%2C%20target%2C%20x2%20%3D%200%2C%20y2%20%3D%200%2C%20z2%20%3D%200%2C%20l%2C%20b%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20link%20%3D%20links%5Bi%5D%2C%20source%20%3D%20link.source%2C%20target%20%3D%20link.target%3B%0A%20%20%20%20%20%20%20%20x2%20%3D%20target.x%20%2B%20target.vx%20-%20source.x%20-%20source.vx%20%7C%7C%20jiggle_default%28random%29%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%20target.y%20%2B%20target.vy%20-%20source.y%20-%20source.vy%20%7C%7C%20jiggle_default%28random%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%20target.z%20%2B%20target.vz%20-%20source.z%20-%20source.vz%20%7C%7C%20jiggle_default%28random%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20l%20%3D%20Math.sqrt%28x2%20%2A%20x2%20%2B%20y2%20%2A%20y2%20%2B%20z2%20%2A%20z2%29%3B%0A%20%20%20%20%20%20%20%20l%20%3D%20%28l%20-%20distances%5Bi%5D%29%20%2F%20l%20%2A%20alpha%20%2A%20strengths%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20x2%20%2A%3D%20l%2C%20y2%20%2A%3D%20l%2C%20z2%20%2A%3D%20l%3B%0A%20%20%20%20%20%20%20%20target.vx%20-%3D%20x2%20%2A%20%28b%20%3D%20bias%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20target.vy%20-%3D%20y2%20%2A%20b%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20target.vz%20-%3D%20z2%20%2A%20b%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20source.vx%20%2B%3D%20x2%20%2A%20%28b%20%3D%201%20-%20b%29%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20source.vy%20%2B%3D%20y2%20%2A%20b%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20source.vz%20%2B%3D%20z2%20%2A%20b%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes.length%2C%20m2%20%3D%20links.length%2C%20nodeById%20%3D%20new%20Map%28nodes.map%28%28d%2C%20i2%29%20%3D%3E%20%5Bid2%28d%2C%20i2%2C%20nodes%29%2C%20d%5D%29%29%2C%20link%3B%0A%20%20%20%20for%20%28i%20%3D%200%2C%20count%20%3D%20new%20Array%28n%29%3B%20i%20%3C%20m2%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20link%20%3D%20links%5Bi%5D%2C%20link.index%20%3D%20i%3B%0A%20%20%20%20%20%20if%20%28typeof%20link.source%20%21%3D%3D%20%22object%22%29%20link.source%20%3D%20find%28nodeById%2C%20link.source%29%3B%0A%20%20%20%20%20%20if%20%28typeof%20link.target%20%21%3D%3D%20%22object%22%29%20link.target%20%3D%20find%28nodeById%2C%20link.target%29%3B%0A%20%20%20%20%20%20count%5Blink.source.index%5D%20%3D%20%28count%5Blink.source.index%5D%20%7C%7C%200%29%20%2B%201%3B%0A%20%20%20%20%20%20count%5Blink.target.index%5D%20%3D%20%28count%5Blink.target.index%5D%20%7C%7C%200%29%20%2B%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28i%20%3D%200%2C%20bias%20%3D%20new%20Array%28m2%29%3B%20i%20%3C%20m2%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20link%20%3D%20links%5Bi%5D%2C%20bias%5Bi%5D%20%3D%20count%5Blink.source.index%5D%20%2F%20%28count%5Blink.source.index%5D%20%2B%20count%5Blink.target.index%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20strengths%20%3D%20new%20Array%28m2%29%2C%20initializeStrength%28%29%3B%0A%20%20%20%20distances%20%3D%20new%20Array%28m2%29%2C%20initializeDistance%28%29%3B%0A%20%20%7D%0A%20%20function%20initializeStrength%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20links.length%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20strengths%5Bi%5D%20%3D%20%2Bstrength%28links%5Bi%5D%2C%20i%2C%20links%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20initializeDistance%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20links.length%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20distances%5Bi%5D%20%3D%20%2Bdistance2%28links%5Bi%5D%2C%20i%2C%20links%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20force.initialize%20%3D%20function%28_nodes%2C%20...args%29%20%7B%0A%20%20%20%20nodes%20%3D%20_nodes%3B%0A%20%20%20%20random%20%3D%20args.find%28%28arg%29%20%3D%3E%20typeof%20arg%20%3D%3D%3D%20%22function%22%29%20%7C%7C%20Math.random%3B%0A%20%20%20%20nDim%20%3D%20args.find%28%28arg%29%20%3D%3E%20%5B1%2C%202%2C%203%5D.includes%28arg%29%29%20%7C%7C%202%3B%0A%20%20%20%20initialize%28%29%3B%0A%20%20%7D%3B%0A%20%20force.links%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28links%20%3D%20_%2C%20initialize%28%29%2C%20force%29%20%3A%20links%3B%0A%20%20%7D%3B%0A%20%20force.id%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28id2%20%3D%20_%2C%20force%29%20%3A%20id2%3B%0A%20%20%7D%3B%0A%20%20force.iterations%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28iterations%20%3D%20%2B_%2C%20force%29%20%3A%20iterations%3B%0A%20%20%7D%3B%0A%20%20force.strength%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28strength%20%3D%20typeof%20_%20%3D%3D%3D%20%22function%22%20%3F%20_%20%3A%20constant_default%28%2B_%29%2C%20initializeStrength%28%29%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%20%20force.distance%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28distance2%20%3D%20typeof%20_%20%3D%3D%3D%20%22function%22%20%3F%20_%20%3A%20constant_default%28%2B_%29%2C%20initializeDistance%28%29%2C%20force%29%20%3A%20distance2%3B%0A%20%20%7D%3B%0A%20%20return%20force%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-dispatch%2Fsrc%2Fdispatch.js%0Avar%20noop%20%3D%20%7B%20value%3A%20%28%29%20%3D%3E%20%7B%0A%7D%20%7D%3B%0Afunction%20dispatch%28%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20arguments.length%2C%20_%20%3D%20%7B%7D%2C%20t%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28%21%28t%20%3D%20arguments%5Bi%5D%20%2B%20%22%22%29%20%7C%7C%20t%20in%20_%20%7C%7C%20%2F%5B%5Cs.%5D%2F.test%28t%29%29%20throw%20new%20Error%28%22illegal%20type%3A%20%22%20%2B%20t%29%3B%0A%20%20%20%20_%5Bt%5D%20%3D%20%5B%5D%3B%0A%20%20%7D%0A%20%20return%20new%20Dispatch%28_%29%3B%0A%7D%0Afunction%20Dispatch%28_%29%20%7B%0A%20%20this._%20%3D%20_%3B%0A%7D%0Afunction%20parseTypenames%28typenames%2C%20types%29%20%7B%0A%20%20return%20typenames.trim%28%29.split%28%2F%5E%7C%5Cs%2B%2F%29.map%28function%28t%29%20%7B%0A%20%20%20%20var%20name%20%3D%20%22%22%2C%20i%20%3D%20t.indexOf%28%22.%22%29%3B%0A%20%20%20%20if%20%28i%20%3E%3D%200%29%20name%20%3D%20t.slice%28i%20%2B%201%29%2C%20t%20%3D%20t.slice%280%2C%20i%29%3B%0A%20%20%20%20if%20%28t%20%26%26%20%21types.hasOwnProperty%28t%29%29%20throw%20new%20Error%28%22unknown%20type%3A%20%22%20%2B%20t%29%3B%0A%20%20%20%20return%20%7B%20type%3A%20t%2C%20name%20%7D%3B%0A%20%20%7D%29%3B%0A%7D%0ADispatch.prototype%20%3D%20dispatch.prototype%20%3D%20%7B%0A%20%20constructor%3A%20Dispatch%2C%0A%20%20on%3A%20function%28typename%2C%20callback%29%20%7B%0A%20%20%20%20var%20_%20%3D%20this._%2C%20T%20%3D%20parseTypenames%28typename%20%2B%20%22%22%2C%20_%29%2C%20t%2C%20i%20%3D%20-1%2C%20n%20%3D%20T.length%3B%0A%20%20%20%20if%20%28arguments.length%20%3C%202%29%20%7B%0A%20%20%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20if%20%28%28t%20%3D%20%28typename%20%3D%20T%5Bi%5D%29.type%29%20%26%26%20%28t%20%3D%20get%28_%5Bt%5D%2C%20typename.name%29%29%29%20return%20t%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28callback%20%21%3D%20null%20%26%26%20typeof%20callback%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%28%22invalid%20callback%3A%20%22%20%2B%20callback%29%3B%0A%20%20%20%20while%20%28%2B%2Bi%20%3C%20n%29%20%7B%0A%20%20%20%20%20%20if%20%28t%20%3D%20%28typename%20%3D%20T%5Bi%5D%29.type%29%20_%5Bt%5D%20%3D%20set%28_%5Bt%5D%2C%20typename.name%2C%20callback%29%3B%0A%20%20%20%20%20%20else%20if%20%28callback%20%3D%3D%20null%29%20for%20%28t%20in%20_%29%20_%5Bt%5D%20%3D%20set%28_%5Bt%5D%2C%20typename.name%2C%20null%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%2C%0A%20%20copy%3A%20function%28%29%20%7B%0A%20%20%20%20var%20copy%20%3D%20%7B%7D%2C%20_%20%3D%20this._%3B%0A%20%20%20%20for%20%28var%20t%20in%20_%29%20copy%5Bt%5D%20%3D%20_%5Bt%5D.slice%28%29%3B%0A%20%20%20%20return%20new%20Dispatch%28copy%29%3B%0A%20%20%7D%2C%0A%20%20call%3A%20function%28type%2C%20that%29%20%7B%0A%20%20%20%20if%20%28%28n%20%3D%20arguments.length%20-%202%29%20%3E%200%29%20for%20%28var%20args%20%3D%20new%20Array%28n%29%2C%20i%20%3D%200%2C%20n%2C%20t%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20args%5Bi%5D%20%3D%20arguments%5Bi%20%2B%202%5D%3B%0A%20%20%20%20if%20%28%21this._.hasOwnProperty%28type%29%29%20throw%20new%20Error%28%22unknown%20type%3A%20%22%20%2B%20type%29%3B%0A%20%20%20%20for%20%28t%20%3D%20this._%5Btype%5D%2C%20i%20%3D%200%2C%20n%20%3D%20t.length%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20t%5Bi%5D.value.apply%28that%2C%20args%29%3B%0A%20%20%7D%2C%0A%20%20apply%3A%20function%28type%2C%20that%2C%20args%29%20%7B%0A%20%20%20%20if%20%28%21this._.hasOwnProperty%28type%29%29%20throw%20new%20Error%28%22unknown%20type%3A%20%22%20%2B%20type%29%3B%0A%20%20%20%20for%20%28var%20t%20%3D%20this._%5Btype%5D%2C%20i%20%3D%200%2C%20n%20%3D%20t.length%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20t%5Bi%5D.value.apply%28that%2C%20args%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20get%28type%2C%20name%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20type.length%2C%20c2%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28%28c2%20%3D%20type%5Bi%5D%29.name%20%3D%3D%3D%20name%29%20%7B%0A%20%20%20%20%20%20return%20c2.value%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Afunction%20set%28type%2C%20name%2C%20callback%29%20%7B%0A%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20type.length%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28type%5Bi%5D.name%20%3D%3D%3D%20name%29%20%7B%0A%20%20%20%20%20%20type%5Bi%5D%20%3D%20noop%2C%20type%20%3D%20type.slice%280%2C%20i%29.concat%28type.slice%28i%20%2B%201%29%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20%28callback%20%21%3D%20null%29%20type.push%28%7B%20name%2C%20value%3A%20callback%20%7D%29%3B%0A%20%20return%20type%3B%0A%7D%0Avar%20dispatch_default%20%3D%20dispatch%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-timer%2Fsrc%2Ftimer.js%0Avar%20frame%20%3D%200%3B%0Avar%20timeout%20%3D%200%3B%0Avar%20interval%20%3D%200%3B%0Avar%20pokeDelay%20%3D%201e3%3B%0Avar%20taskHead%3B%0Avar%20taskTail%3B%0Avar%20clockLast%20%3D%200%3B%0Avar%20clockNow%20%3D%200%3B%0Avar%20clockSkew%20%3D%200%3B%0Avar%20clock%20%3D%20typeof%20performance%20%3D%3D%3D%20%22object%22%20%26%26%20performance.now%20%3F%20performance%20%3A%20Date%3B%0Avar%20setFrame%20%3D%20typeof%20window%20%3D%3D%3D%20%22object%22%20%26%26%20window.requestAnimationFrame%20%3F%20window.requestAnimationFrame.bind%28window%29%20%3A%20function%28f%29%20%7B%0A%20%20setTimeout%28f%2C%2017%29%3B%0A%7D%3B%0Afunction%20now2%28%29%20%7B%0A%20%20return%20clockNow%20%7C%7C%20%28setFrame%28clearNow%29%2C%20clockNow%20%3D%20clock.now%28%29%20%2B%20clockSkew%29%3B%0A%7D%0Afunction%20clearNow%28%29%20%7B%0A%20%20clockNow%20%3D%200%3B%0A%7D%0Afunction%20Timer%28%29%20%7B%0A%20%20this._call%20%3D%20this._time%20%3D%20this._next%20%3D%20null%3B%0A%7D%0ATimer.prototype%20%3D%20timer.prototype%20%3D%20%7B%0A%20%20constructor%3A%20Timer%2C%0A%20%20restart%3A%20function%28callback%2C%20delay%2C%20time%29%20%7B%0A%20%20%20%20if%20%28typeof%20callback%20%21%3D%3D%20%22function%22%29%20throw%20new%20TypeError%28%22callback%20is%20not%20a%20function%22%29%3B%0A%20%20%20%20time%20%3D%20%28time%20%3D%3D%20null%20%3F%20now2%28%29%20%3A%20%2Btime%29%20%2B%20%28delay%20%3D%3D%20null%20%3F%200%20%3A%20%2Bdelay%29%3B%0A%20%20%20%20if%20%28%21this._next%20%26%26%20taskTail%20%21%3D%3D%20this%29%20%7B%0A%20%20%20%20%20%20if%20%28taskTail%29%20taskTail._next%20%3D%20this%3B%0A%20%20%20%20%20%20else%20taskHead%20%3D%20this%3B%0A%20%20%20%20%20%20taskTail%20%3D%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._call%20%3D%20callback%3B%0A%20%20%20%20this._time%20%3D%20time%3B%0A%20%20%20%20sleep%28%29%3B%0A%20%20%7D%2C%0A%20%20stop%3A%20function%28%29%20%7B%0A%20%20%20%20if%20%28this._call%29%20%7B%0A%20%20%20%20%20%20this._call%20%3D%20null%3B%0A%20%20%20%20%20%20this._time%20%3D%20Infinity%3B%0A%20%20%20%20%20%20sleep%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Afunction%20timer%28callback%2C%20delay%2C%20time%29%20%7B%0A%20%20var%20t%20%3D%20new%20Timer%28%29%3B%0A%20%20t.restart%28callback%2C%20delay%2C%20time%29%3B%0A%20%20return%20t%3B%0A%7D%0Afunction%20timerFlush%28%29%20%7B%0A%20%20now2%28%29%3B%0A%20%20%2B%2Bframe%3B%0A%20%20var%20t%20%3D%20taskHead%2C%20e%3B%0A%20%20while%20%28t%29%20%7B%0A%20%20%20%20if%20%28%28e%20%3D%20clockNow%20-%20t._time%29%20%3E%3D%200%29%20t._call.call%28void%200%2C%20e%29%3B%0A%20%20%20%20t%20%3D%20t._next%3B%0A%20%20%7D%0A%20%20--frame%3B%0A%7D%0Afunction%20wake%28%29%20%7B%0A%20%20clockNow%20%3D%20%28clockLast%20%3D%20clock.now%28%29%29%20%2B%20clockSkew%3B%0A%20%20frame%20%3D%20timeout%20%3D%200%3B%0A%20%20try%20%7B%0A%20%20%20%20timerFlush%28%29%3B%0A%20%20%7D%20finally%20%7B%0A%20%20%20%20frame%20%3D%200%3B%0A%20%20%20%20nap%28%29%3B%0A%20%20%20%20clockNow%20%3D%200%3B%0A%20%20%7D%0A%7D%0Afunction%20poke%28%29%20%7B%0A%20%20var%20now5%20%3D%20clock.now%28%29%2C%20delay%20%3D%20now5%20-%20clockLast%3B%0A%20%20if%20%28delay%20%3E%20pokeDelay%29%20clockSkew%20-%3D%20delay%2C%20clockLast%20%3D%20now5%3B%0A%7D%0Afunction%20nap%28%29%20%7B%0A%20%20var%20t0%2C%20t1%20%3D%20taskHead%2C%20t2%2C%20time%20%3D%20Infinity%3B%0A%20%20while%20%28t1%29%20%7B%0A%20%20%20%20if%20%28t1._call%29%20%7B%0A%20%20%20%20%20%20if%20%28time%20%3E%20t1._time%29%20time%20%3D%20t1._time%3B%0A%20%20%20%20%20%20t0%20%3D%20t1%2C%20t1%20%3D%20t1._next%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20t2%20%3D%20t1._next%2C%20t1._next%20%3D%20null%3B%0A%20%20%20%20%20%20t1%20%3D%20t0%20%3F%20t0._next%20%3D%20t2%20%3A%20taskHead%20%3D%20t2%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20taskTail%20%3D%20t0%3B%0A%20%20sleep%28time%29%3B%0A%7D%0Afunction%20sleep%28time%29%20%7B%0A%20%20if%20%28frame%29%20return%3B%0A%20%20if%20%28timeout%29%20timeout%20%3D%20clearTimeout%28timeout%29%3B%0A%20%20var%20delay%20%3D%20time%20-%20clockNow%3B%0A%20%20if%20%28delay%20%3E%2024%29%20%7B%0A%20%20%20%20if%20%28time%20%3C%20Infinity%29%20timeout%20%3D%20setTimeout%28wake%2C%20time%20-%20clock.now%28%29%20-%20clockSkew%29%3B%0A%20%20%20%20if%20%28interval%29%20interval%20%3D%20clearInterval%28interval%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28%21interval%29%20clockLast%20%3D%20clock.now%28%29%2C%20interval%20%3D%20setInterval%28poke%2C%20pokeDelay%29%3B%0A%20%20%20%20frame%20%3D%201%2C%20setFrame%28wake%29%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-force-3d%2Fsrc%2Flcg.js%0Avar%20a%20%3D%201664525%3B%0Avar%20c%20%3D%201013904223%3B%0Avar%20m%20%3D%204294967296%3B%0Afunction%20lcg_default%28%29%20%7B%0A%20%20let%20s%20%3D%201%3B%0A%20%20return%20%28%29%20%3D%3E%20%28s%20%3D%20%28a%20%2A%20s%20%2B%20c%29%20%25%20m%29%20%2F%20m%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-force-3d%2Fsrc%2Fsimulation.js%0Avar%20MAX_DIMENSIONS%20%3D%203%3B%0Afunction%20x%28d%29%20%7B%0A%20%20return%20d.x%3B%0A%7D%0Afunction%20y%28d%29%20%7B%0A%20%20return%20d.y%3B%0A%7D%0Afunction%20z%28d%29%20%7B%0A%20%20return%20d.z%3B%0A%7D%0Avar%20initialRadius%20%3D%2010%3B%0Avar%20initialAngleRoll%20%3D%20Math.PI%20%2A%20%283%20-%20Math.sqrt%285%29%29%3B%0Avar%20initialAngleYaw%20%3D%20Math.PI%20%2A%2020%20%2F%20%289%20%2B%20Math.sqrt%28221%29%29%3B%0Afunction%20simulation_default%28nodes%2C%20numDimensions%29%20%7B%0A%20%20numDimensions%20%3D%20numDimensions%20%7C%7C%202%3B%0A%20%20var%20nDim%20%3D%20Math.min%28MAX_DIMENSIONS%2C%20Math.max%281%2C%20Math.round%28numDimensions%29%29%29%2C%20simulation%2C%20alpha%20%3D%201%2C%20alphaMin%20%3D%201e-3%2C%20alphaDecay%20%3D%201%20-%20Math.pow%28alphaMin%2C%201%20%2F%20300%29%2C%20alphaTarget%20%3D%200%2C%20velocityDecay%20%3D%200.6%2C%20forces%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%2C%20stepper%20%3D%20timer%28step2%29%2C%20event%20%3D%20dispatch_default%28%22tick%22%2C%20%22end%22%29%2C%20random%20%3D%20lcg_default%28%29%3B%0A%20%20if%20%28nodes%20%3D%3D%20null%29%20nodes%20%3D%20%5B%5D%3B%0A%20%20function%20step2%28%29%20%7B%0A%20%20%20%20tick2%28%29%3B%0A%20%20%20%20event.call%28%22tick%22%2C%20simulation%29%3B%0A%20%20%20%20if%20%28alpha%20%3C%20alphaMin%29%20%7B%0A%20%20%20%20%20%20stepper.stop%28%29%3B%0A%20%20%20%20%20%20event.call%28%22end%22%2C%20simulation%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20tick2%28iterations%29%20%7B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes.length%2C%20node%3B%0A%20%20%20%20if%20%28iterations%20%3D%3D%3D%20void%200%29%20iterations%20%3D%201%3B%0A%20%20%20%20for%20%28var%20k%20%3D%200%3B%20k%20%3C%20iterations%3B%20%2B%2Bk%29%20%7B%0A%20%20%20%20%20%20alpha%20%2B%3D%20%28alphaTarget%20-%20alpha%29%20%2A%20alphaDecay%3B%0A%20%20%20%20%20%20forces.forEach%28function%28force%29%20%7B%0A%20%20%20%20%20%20%20%20force%28alpha%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28node.fx%20%3D%3D%20null%29%20node.x%20%2B%3D%20node.vx%20%2A%3D%20velocityDecay%3B%0A%20%20%20%20%20%20%20%20else%20node.x%20%3D%20node.fx%2C%20node.vx%20%3D%200%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28node.fy%20%3D%3D%20null%29%20node.y%20%2B%3D%20node.vy%20%2A%3D%20velocityDecay%3B%0A%20%20%20%20%20%20%20%20%20%20else%20node.y%20%3D%20node.fy%2C%20node.vy%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28node.fz%20%3D%3D%20null%29%20node.z%20%2B%3D%20node.vz%20%2A%3D%20velocityDecay%3B%0A%20%20%20%20%20%20%20%20%20%20else%20node.z%20%3D%20node.fz%2C%20node.vz%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20simulation%3B%0A%20%20%7D%0A%20%20function%20initializeNodes%28%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20nodes.length%2C%20node%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%2C%20node.index%20%3D%20i%3B%0A%20%20%20%20%20%20if%20%28node.fx%20%21%3D%20null%29%20node.x%20%3D%20node.fx%3B%0A%20%20%20%20%20%20if%20%28node.fy%20%21%3D%20null%29%20node.y%20%3D%20node.fy%3B%0A%20%20%20%20%20%20if%20%28node.fz%20%21%3D%20null%29%20node.z%20%3D%20node.fz%3B%0A%20%20%20%20%20%20if%20%28isNaN%28node.x%29%20%7C%7C%20nDim%20%3E%201%20%26%26%20isNaN%28node.y%29%20%7C%7C%20nDim%20%3E%202%20%26%26%20isNaN%28node.z%29%29%20%7B%0A%20%20%20%20%20%20%20%20var%20radius%20%3D%20initialRadius%20%2A%20%28nDim%20%3E%202%20%3F%20Math.cbrt%280.5%20%2B%20i%29%20%3A%20nDim%20%3E%201%20%3F%20Math.sqrt%280.5%20%2B%20i%29%20%3A%20i%29%2C%20rollAngle%20%3D%20i%20%2A%20initialAngleRoll%2C%20yawAngle%20%3D%20i%20%2A%20initialAngleYaw%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.x%20%3D%20radius%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28nDim%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.x%20%3D%20radius%20%2A%20Math.cos%28rollAngle%29%3B%0A%20%20%20%20%20%20%20%20%20%20node.y%20%3D%20radius%20%2A%20Math.sin%28rollAngle%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.x%20%3D%20radius%20%2A%20Math.sin%28rollAngle%29%20%2A%20Math.cos%28yawAngle%29%3B%0A%20%20%20%20%20%20%20%20%20%20node.y%20%3D%20radius%20%2A%20Math.cos%28rollAngle%29%3B%0A%20%20%20%20%20%20%20%20%20%20node.z%20%3D%20radius%20%2A%20Math.sin%28rollAngle%29%20%2A%20Math.sin%28yawAngle%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28isNaN%28node.vx%29%20%7C%7C%20nDim%20%3E%201%20%26%26%20isNaN%28node.vy%29%20%7C%7C%20nDim%20%3E%202%20%26%26%20isNaN%28node.vz%29%29%20%7B%0A%20%20%20%20%20%20%20%20node.vx%20%3D%200%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.vy%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.vz%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20initializeForce%28force%29%20%7B%0A%20%20%20%20if%20%28force.initialize%29%20force.initialize%28nodes%2C%20random%2C%20nDim%29%3B%0A%20%20%20%20return%20force%3B%0A%20%20%7D%0A%20%20initializeNodes%28%29%3B%0A%20%20return%20simulation%20%3D%20%7B%0A%20%20%20%20tick%3A%20tick2%2C%0A%20%20%20%20restart%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20stepper.restart%28step2%29%2C%20simulation%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20stop%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20stepper.stop%28%29%2C%20simulation%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20numDimensions%3A%20function%28_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3F%20%28nDim%20%3D%20Math.min%28MAX_DIMENSIONS%2C%20Math.max%281%2C%20Math.round%28_%29%29%29%2C%20forces.forEach%28initializeForce%29%2C%20simulation%29%20%3A%20nDim%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20nodes%3A%20function%28_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3F%20%28nodes%20%3D%20_%2C%20initializeNodes%28%29%2C%20forces.forEach%28initializeForce%29%2C%20simulation%29%20%3A%20nodes%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20alpha%3A%20function%28_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3F%20%28alpha%20%3D%20%2B_%2C%20simulation%29%20%3A%20alpha%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20alphaMin%3A%20function%28_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3F%20%28alphaMin%20%3D%20%2B_%2C%20simulation%29%20%3A%20alphaMin%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20alphaDecay%3A%20function%28_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3F%20%28alphaDecay%20%3D%20%2B_%2C%20simulation%29%20%3A%20%2BalphaDecay%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20alphaTarget%3A%20function%28_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3F%20%28alphaTarget%20%3D%20%2B_%2C%20simulation%29%20%3A%20alphaTarget%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20velocityDecay%3A%20function%28_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3F%20%28velocityDecay%20%3D%201%20-%20_%2C%20simulation%29%20%3A%201%20-%20velocityDecay%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20randomSource%3A%20function%28_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3F%20%28random%20%3D%20_%2C%20forces.forEach%28initializeForce%29%2C%20simulation%29%20%3A%20random%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20force%3A%20function%28name%2C%20_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3E%201%20%3F%20%28_%20%3D%3D%20null%20%3F%20forces.delete%28name%29%20%3A%20forces.set%28name%2C%20initializeForce%28_%29%29%2C%20simulation%29%20%3A%20forces.get%28name%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20find%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20args%20%3D%20Array.prototype.slice.call%28arguments%29%3B%0A%20%20%20%20%20%20var%20x2%20%3D%20args.shift%28%29%20%7C%7C%200%2C%20y2%20%3D%20%28nDim%20%3E%201%20%3F%20args.shift%28%29%20%3A%20null%29%20%7C%7C%200%2C%20z2%20%3D%20%28nDim%20%3E%202%20%3F%20args.shift%28%29%20%3A%20null%29%20%7C%7C%200%2C%20radius%20%3D%20args.shift%28%29%20%7C%7C%20Infinity%3B%0A%20%20%20%20%20%20var%20i%20%3D%200%2C%20n%20%3D%20nodes.length%2C%20dx%2C%20dy%2C%20dz%2C%20d2%2C%20node%2C%20closest%3B%0A%20%20%20%20%20%20radius%20%2A%3D%20radius%3B%0A%20%20%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20nodes%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20dx%20%3D%20x2%20-%20node.x%3B%0A%20%20%20%20%20%20%20%20dy%20%3D%20y2%20-%20%28node.y%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%20%20dz%20%3D%20z2%20-%20%28node.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%20%20d2%20%3D%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%20%2B%20dz%20%2A%20dz%3B%0A%20%20%20%20%20%20%20%20if%20%28d2%20%3C%20radius%29%20closest%20%3D%20node%2C%20radius%20%3D%20d2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20closest%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20on%3A%20function%28name%2C%20_%29%20%7B%0A%20%20%20%20%20%20return%20arguments.length%20%3E%201%20%3F%20%28event.on%28name%2C%20_%29%2C%20simulation%29%20%3A%20event.on%28name%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-force-3d%2Fsrc%2FmanyBody.js%0Afunction%20manyBody_default%28%29%20%7B%0A%20%20var%20nodes%2C%20nDim%2C%20node%2C%20random%2C%20alpha%2C%20strength%20%3D%20constant_default%28-30%29%2C%20strengths%2C%20distanceMin2%20%3D%201%2C%20distanceMax2%20%3D%20Infinity%2C%20theta2%20%3D%200.81%3B%0A%20%20function%20force%28_%29%20%7B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes.length%2C%20tree%20%3D%20%28nDim%20%3D%3D%3D%201%20%3F%20binarytree%28nodes%2C%20x%29%20%3A%20nDim%20%3D%3D%3D%202%20%3F%20quadtree%28nodes%2C%20x%2C%20y%29%20%3A%20nDim%20%3D%3D%3D%203%20%3F%20octree%28nodes%2C%20x%2C%20y%2C%20z%29%20%3A%20null%29.visitAfter%28accumulate%29%3B%0A%20%20%20%20for%20%28alpha%20%3D%20_%2C%20i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20node%20%3D%20nodes%5Bi%5D%2C%20tree.visit%28apply%29%3B%0A%20%20%7D%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes.length%2C%20node2%3B%0A%20%20%20%20strengths%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20node2%20%3D%20nodes%5Bi%5D%2C%20strengths%5Bnode2.index%5D%20%3D%20%2Bstrength%28node2%2C%20i%2C%20nodes%29%3B%0A%20%20%7D%0A%20%20function%20accumulate%28treeNode%29%20%7B%0A%20%20%20%20var%20strength2%20%3D%200%2C%20q%2C%20c2%2C%20weight%20%3D%200%2C%20x2%2C%20y2%2C%20z2%2C%20i%3B%0A%20%20%20%20var%20numChildren%20%3D%20treeNode.length%3B%0A%20%20%20%20if%20%28numChildren%29%20%7B%0A%20%20%20%20%20%20for%20%28x2%20%3D%20y2%20%3D%20z2%20%3D%20i%20%3D%200%3B%20i%20%3C%20numChildren%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%28q%20%3D%20treeNode%5Bi%5D%29%20%26%26%20%28c2%20%3D%20Math.abs%28q.value%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20strength2%20%2B%3D%20q.value%2C%20weight%20%2B%3D%20c2%2C%20x2%20%2B%3D%20c2%20%2A%20%28q.x%20%7C%7C%200%29%2C%20y2%20%2B%3D%20c2%20%2A%20%28q.y%20%7C%7C%200%29%2C%20z2%20%2B%3D%20c2%20%2A%20%28q.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20strength2%20%2A%3D%20Math.sqrt%284%20%2F%20numChildren%29%3B%0A%20%20%20%20%20%20treeNode.x%20%3D%20x2%20%2F%20weight%3B%0A%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20treeNode.y%20%3D%20y2%20%2F%20weight%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20treeNode.z%20%3D%20z2%20%2F%20weight%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20q%20%3D%20treeNode%3B%0A%20%20%20%20%20%20q.x%20%3D%20q.data.x%3B%0A%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20q.y%20%3D%20q.data.y%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20q.z%20%3D%20q.data.z%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20do%0A%20%20%20%20%20%20%20%20strength2%20%2B%3D%20strengths%5Bq.data.index%5D%3B%0A%20%20%20%20%20%20while%20%28q%20%3D%20q.next%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20treeNode.value%20%3D%20strength2%3B%0A%20%20%7D%0A%20%20function%20apply%28treeNode%2C%20x1%2C%20arg1%2C%20arg2%2C%20arg3%29%20%7B%0A%20%20%20%20if%20%28%21treeNode.value%29%20return%20true%3B%0A%20%20%20%20var%20x2%20%3D%20%5Barg1%2C%20arg2%2C%20arg3%5D%5BnDim%20-%201%5D%3B%0A%20%20%20%20var%20x3%20%3D%20treeNode.x%20-%20node.x%2C%20y2%20%3D%20nDim%20%3E%201%20%3F%20treeNode.y%20-%20node.y%20%3A%200%2C%20z2%20%3D%20nDim%20%3E%202%20%3F%20treeNode.z%20-%20node.z%20%3A%200%2C%20w%20%3D%20x2%20-%20x1%2C%20l%20%3D%20x3%20%2A%20x3%20%2B%20y2%20%2A%20y2%20%2B%20z2%20%2A%20z2%3B%0A%20%20%20%20if%20%28w%20%2A%20w%20%2F%20theta2%20%3C%20l%29%20%7B%0A%20%20%20%20%20%20if%20%28l%20%3C%20distanceMax2%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28x3%20%3D%3D%3D%200%29%20x3%20%3D%20jiggle_default%28random%29%2C%20l%20%2B%3D%20x3%20%2A%20x3%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%201%20%26%26%20y2%20%3D%3D%3D%200%29%20y2%20%3D%20jiggle_default%28random%29%2C%20l%20%2B%3D%20y2%20%2A%20y2%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%202%20%26%26%20z2%20%3D%3D%3D%200%29%20z2%20%3D%20jiggle_default%28random%29%2C%20l%20%2B%3D%20z2%20%2A%20z2%3B%0A%20%20%20%20%20%20%20%20if%20%28l%20%3C%20distanceMin2%29%20l%20%3D%20Math.sqrt%28distanceMin2%20%2A%20l%29%3B%0A%20%20%20%20%20%20%20%20node.vx%20%2B%3D%20x3%20%2A%20treeNode.value%20%2A%20alpha%20%2F%20l%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.vy%20%2B%3D%20y2%20%2A%20treeNode.value%20%2A%20alpha%20%2F%20l%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.vz%20%2B%3D%20z2%20%2A%20treeNode.value%20%2A%20alpha%20%2F%20l%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%20else%20if%20%28treeNode.length%20%7C%7C%20l%20%3E%3D%20distanceMax2%29%20return%3B%0A%20%20%20%20if%20%28treeNode.data%20%21%3D%3D%20node%20%7C%7C%20treeNode.next%29%20%7B%0A%20%20%20%20%20%20if%20%28x3%20%3D%3D%3D%200%29%20x3%20%3D%20jiggle_default%28random%29%2C%20l%20%2B%3D%20x3%20%2A%20x3%3B%0A%20%20%20%20%20%20if%20%28nDim%20%3E%201%20%26%26%20y2%20%3D%3D%3D%200%29%20y2%20%3D%20jiggle_default%28random%29%2C%20l%20%2B%3D%20y2%20%2A%20y2%3B%0A%20%20%20%20%20%20if%20%28nDim%20%3E%202%20%26%26%20z2%20%3D%3D%3D%200%29%20z2%20%3D%20jiggle_default%28random%29%2C%20l%20%2B%3D%20z2%20%2A%20z2%3B%0A%20%20%20%20%20%20if%20%28l%20%3C%20distanceMin2%29%20l%20%3D%20Math.sqrt%28distanceMin2%20%2A%20l%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20do%0A%20%20%20%20%20%20if%20%28treeNode.data%20%21%3D%3D%20node%29%20%7B%0A%20%20%20%20%20%20%20%20w%20%3D%20strengths%5BtreeNode.data.index%5D%20%2A%20alpha%20%2F%20l%3B%0A%20%20%20%20%20%20%20%20node.vx%20%2B%3D%20x3%20%2A%20w%3B%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.vy%20%2B%3D%20y2%20%2A%20w%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20node.vz%20%2B%3D%20z2%20%2A%20w%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20while%20%28treeNode%20%3D%20treeNode.next%29%3B%0A%20%20%7D%0A%20%20force.initialize%20%3D%20function%28_nodes%2C%20...args%29%20%7B%0A%20%20%20%20nodes%20%3D%20_nodes%3B%0A%20%20%20%20random%20%3D%20args.find%28%28arg%29%20%3D%3E%20typeof%20arg%20%3D%3D%3D%20%22function%22%29%20%7C%7C%20Math.random%3B%0A%20%20%20%20nDim%20%3D%20args.find%28%28arg%29%20%3D%3E%20%5B1%2C%202%2C%203%5D.includes%28arg%29%29%20%7C%7C%202%3B%0A%20%20%20%20initialize%28%29%3B%0A%20%20%7D%3B%0A%20%20force.strength%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28strength%20%3D%20typeof%20_%20%3D%3D%3D%20%22function%22%20%3F%20_%20%3A%20constant_default%28%2B_%29%2C%20initialize%28%29%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%20%20force.distanceMin%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28distanceMin2%20%3D%20_%20%2A%20_%2C%20force%29%20%3A%20Math.sqrt%28distanceMin2%29%3B%0A%20%20%7D%3B%0A%20%20force.distanceMax%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28distanceMax2%20%3D%20_%20%2A%20_%2C%20force%29%20%3A%20Math.sqrt%28distanceMax2%29%3B%0A%20%20%7D%3B%0A%20%20force.theta%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28theta2%20%3D%20_%20%2A%20_%2C%20force%29%20%3A%20Math.sqrt%28theta2%29%3B%0A%20%20%7D%3B%0A%20%20return%20force%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-force-3d%2Fsrc%2Fradial.js%0Afunction%20radial_default%28radius%2C%20x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20var%20nodes%2C%20nDim%2C%20strength%20%3D%20constant_default%280.1%29%2C%20strengths%2C%20radiuses%3B%0A%20%20if%20%28typeof%20radius%20%21%3D%3D%20%22function%22%29%20radius%20%3D%20constant_default%28%2Bradius%29%3B%0A%20%20if%20%28x2%20%3D%3D%20null%29%20x2%20%3D%200%3B%0A%20%20if%20%28y2%20%3D%3D%20null%29%20y2%20%3D%200%3B%0A%20%20if%20%28z2%20%3D%3D%20null%29%20z2%20%3D%200%3B%0A%20%20function%20force%28alpha%29%20%7B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20n%20%3D%20nodes.length%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20var%20node%20%3D%20nodes%5Bi%5D%2C%20dx%20%3D%20node.x%20-%20x2%20%7C%7C%201e-6%2C%20dy%20%3D%20%28node.y%20%7C%7C%200%29%20-%20y2%20%7C%7C%201e-6%2C%20dz%20%3D%20%28node.z%20%7C%7C%200%29%20-%20z2%20%7C%7C%201e-6%2C%20r%20%3D%20Math.sqrt%28dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%20%2B%20dz%20%2A%20dz%29%2C%20k%20%3D%20%28radiuses%5Bi%5D%20-%20r%29%20%2A%20strengths%5Bi%5D%20%2A%20alpha%20%2F%20r%3B%0A%20%20%20%20%20%20node.vx%20%2B%3D%20dx%20%2A%20k%3B%0A%20%20%20%20%20%20if%20%28nDim%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20node.vy%20%2B%3D%20dy%20%2A%20k%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28nDim%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20node.vz%20%2B%3D%20dz%20%2A%20k%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20initialize%28%29%20%7B%0A%20%20%20%20if%20%28%21nodes%29%20return%3B%0A%20%20%20%20var%20i%2C%20n%20%3D%20nodes.length%3B%0A%20%20%20%20strengths%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20radiuses%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20radiuses%5Bi%5D%20%3D%20%2Bradius%28nodes%5Bi%5D%2C%20i%2C%20nodes%29%3B%0A%20%20%20%20%20%20strengths%5Bi%5D%20%3D%20isNaN%28radiuses%5Bi%5D%29%20%3F%200%20%3A%20%2Bstrength%28nodes%5Bi%5D%2C%20i%2C%20nodes%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20force.initialize%20%3D%20function%28initNodes%2C%20...args%29%20%7B%0A%20%20%20%20nodes%20%3D%20initNodes%3B%0A%20%20%20%20nDim%20%3D%20args.find%28%28arg%29%20%3D%3E%20%5B1%2C%202%2C%203%5D.includes%28arg%29%29%20%7C%7C%202%3B%0A%20%20%20%20initialize%28%29%3B%0A%20%20%7D%3B%0A%20%20force.strength%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28strength%20%3D%20typeof%20_%20%3D%3D%3D%20%22function%22%20%3F%20_%20%3A%20constant_default%28%2B_%29%2C%20initialize%28%29%2C%20force%29%20%3A%20strength%3B%0A%20%20%7D%3B%0A%20%20force.radius%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28radius%20%3D%20typeof%20_%20%3D%3D%3D%20%22function%22%20%3F%20_%20%3A%20constant_default%28%2B_%29%2C%20initialize%28%29%2C%20force%29%20%3A%20radius%3B%0A%20%20%7D%3B%0A%20%20force.x%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28x2%20%3D%20%2B_%2C%20force%29%20%3A%20x2%3B%0A%20%20%7D%3B%0A%20%20force.y%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28y2%20%3D%20%2B_%2C%20force%29%20%3A%20y2%3B%0A%20%20%7D%3B%0A%20%20force.z%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28z2%20%3D%20%2B_%2C%20force%29%20%3A%20z2%3B%0A%20%20%7D%3B%0A%20%20return%20force%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree-forcegraph%2Fdist%2Fthree-forcegraph.mjs%0Avar%20import_ngraph%20%3D%20__toESM%28require_ngraph2%28%29%2C%201%29%3B%0Avar%20import_ngraph2%20%3D%20__toESM%28require_ngraph5%28%29%2C%201%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2FisObject.js%0Afunction%20isObject%28value%29%20%7B%0A%20%20var%20type%20%3D%20typeof%20value%3B%0A%20%20return%20value%20%21%3D%20null%20%26%26%20%28type%20%3D%3D%20%22object%22%20%7C%7C%20type%20%3D%3D%20%22function%22%29%3B%0A%7D%0Avar%20isObject_default%20%3D%20isObject%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2F_freeGlobal.js%0Avar%20freeGlobal%20%3D%20typeof%20global%20%3D%3D%20%22object%22%20%26%26%20global%20%26%26%20global.Object%20%3D%3D%3D%20Object%20%26%26%20global%3B%0Avar%20freeGlobal_default%20%3D%20freeGlobal%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2F_root.js%0Avar%20freeSelf%20%3D%20typeof%20self%20%3D%3D%20%22object%22%20%26%26%20self%20%26%26%20self.Object%20%3D%3D%3D%20Object%20%26%26%20self%3B%0Avar%20root%20%3D%20freeGlobal_default%20%7C%7C%20freeSelf%20%7C%7C%20Function%28%22return%20this%22%29%28%29%3B%0Avar%20root_default4%20%3D%20root%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2Fnow.js%0Avar%20now3%20%3D%20function%28%29%20%7B%0A%20%20return%20root_default4.Date.now%28%29%3B%0A%7D%3B%0Avar%20now_default%20%3D%20now3%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2F_trimmedEndIndex.js%0Avar%20reWhitespace%20%3D%20%2F%5Cs%2F%3B%0Afunction%20trimmedEndIndex%28string%29%20%7B%0A%20%20var%20index5%20%3D%20string.length%3B%0A%20%20while%20%28index5--%20%26%26%20reWhitespace.test%28string.charAt%28index5%29%29%29%20%7B%0A%20%20%7D%0A%20%20return%20index5%3B%0A%7D%0Avar%20trimmedEndIndex_default%20%3D%20trimmedEndIndex%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2F_baseTrim.js%0Avar%20reTrimStart%20%3D%20%2F%5E%5Cs%2B%2F%3B%0Afunction%20baseTrim%28string%29%20%7B%0A%20%20return%20string%20%3F%20string.slice%280%2C%20trimmedEndIndex_default%28string%29%20%2B%201%29.replace%28reTrimStart%2C%20%22%22%29%20%3A%20string%3B%0A%7D%0Avar%20baseTrim_default%20%3D%20baseTrim%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2F_Symbol.js%0Avar%20Symbol2%20%3D%20root_default4.Symbol%3B%0Avar%20Symbol_default%20%3D%20Symbol2%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2F_getRawTag.js%0Avar%20objectProto%20%3D%20Object.prototype%3B%0Avar%20hasOwnProperty%20%3D%20objectProto.hasOwnProperty%3B%0Avar%20nativeObjectToString%20%3D%20objectProto.toString%3B%0Avar%20symToStringTag%20%3D%20Symbol_default%20%3F%20Symbol_default.toStringTag%20%3A%20void%200%3B%0Afunction%20getRawTag%28value%29%20%7B%0A%20%20var%20isOwn%20%3D%20hasOwnProperty.call%28value%2C%20symToStringTag%29%2C%20tag%20%3D%20value%5BsymToStringTag%5D%3B%0A%20%20try%20%7B%0A%20%20%20%20value%5BsymToStringTag%5D%20%3D%20void%200%3B%0A%20%20%20%20var%20unmasked%20%3D%20true%3B%0A%20%20%7D%20catch%20%28e%29%20%7B%0A%20%20%7D%0A%20%20var%20result%20%3D%20nativeObjectToString.call%28value%29%3B%0A%20%20if%20%28unmasked%29%20%7B%0A%20%20%20%20if%20%28isOwn%29%20%7B%0A%20%20%20%20%20%20value%5BsymToStringTag%5D%20%3D%20tag%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20delete%20value%5BsymToStringTag%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20result%3B%0A%7D%0Avar%20getRawTag_default%20%3D%20getRawTag%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2F_objectToString.js%0Avar%20objectProto2%20%3D%20Object.prototype%3B%0Avar%20nativeObjectToString2%20%3D%20objectProto2.toString%3B%0Afunction%20objectToString%28value%29%20%7B%0A%20%20return%20nativeObjectToString2.call%28value%29%3B%0A%7D%0Avar%20objectToString_default%20%3D%20objectToString%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2F_baseGetTag.js%0Avar%20nullTag%20%3D%20%22%5Bobject%20Null%5D%22%3B%0Avar%20undefinedTag%20%3D%20%22%5Bobject%20Undefined%5D%22%3B%0Avar%20symToStringTag2%20%3D%20Symbol_default%20%3F%20Symbol_default.toStringTag%20%3A%20void%200%3B%0Afunction%20baseGetTag%28value%29%20%7B%0A%20%20if%20%28value%20%3D%3D%20null%29%20%7B%0A%20%20%20%20return%20value%20%3D%3D%3D%20void%200%20%3F%20undefinedTag%20%3A%20nullTag%3B%0A%20%20%7D%0A%20%20return%20symToStringTag2%20%26%26%20symToStringTag2%20in%20Object%28value%29%20%3F%20getRawTag_default%28value%29%20%3A%20objectToString_default%28value%29%3B%0A%7D%0Avar%20baseGetTag_default%20%3D%20baseGetTag%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2FisObjectLike.js%0Afunction%20isObjectLike%28value%29%20%7B%0A%20%20return%20value%20%21%3D%20null%20%26%26%20typeof%20value%20%3D%3D%20%22object%22%3B%0A%7D%0Avar%20isObjectLike_default%20%3D%20isObjectLike%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2FisSymbol.js%0Avar%20symbolTag%20%3D%20%22%5Bobject%20Symbol%5D%22%3B%0Afunction%20isSymbol%28value%29%20%7B%0A%20%20return%20typeof%20value%20%3D%3D%20%22symbol%22%20%7C%7C%20isObjectLike_default%28value%29%20%26%26%20baseGetTag_default%28value%29%20%3D%3D%20symbolTag%3B%0A%7D%0Avar%20isSymbol_default%20%3D%20isSymbol%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2FtoNumber.js%0Avar%20NAN%20%3D%200%20%2F%200%3B%0Avar%20reIsBadHex%20%3D%20%2F%5E%5B-%2B%5D0x%5B0-9a-f%5D%2B%24%2Fi%3B%0Avar%20reIsBinary%20%3D%20%2F%5E0b%5B01%5D%2B%24%2Fi%3B%0Avar%20reIsOctal%20%3D%20%2F%5E0o%5B0-7%5D%2B%24%2Fi%3B%0Avar%20freeParseInt%20%3D%20parseInt%3B%0Afunction%20toNumber%28value%29%20%7B%0A%20%20if%20%28typeof%20value%20%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20return%20value%3B%0A%20%20%7D%0A%20%20if%20%28isSymbol_default%28value%29%29%20%7B%0A%20%20%20%20return%20NAN%3B%0A%20%20%7D%0A%20%20if%20%28isObject_default%28value%29%29%20%7B%0A%20%20%20%20var%20other%20%3D%20typeof%20value.valueOf%20%3D%3D%20%22function%22%20%3F%20value.valueOf%28%29%20%3A%20value%3B%0A%20%20%20%20value%20%3D%20isObject_default%28other%29%20%3F%20other%20%2B%20%22%22%20%3A%20other%3B%0A%20%20%7D%0A%20%20if%20%28typeof%20value%20%21%3D%20%22string%22%29%20%7B%0A%20%20%20%20return%20value%20%3D%3D%3D%200%20%3F%20value%20%3A%20%2Bvalue%3B%0A%20%20%7D%0A%20%20value%20%3D%20baseTrim_default%28value%29%3B%0A%20%20var%20isBinary%20%3D%20reIsBinary.test%28value%29%3B%0A%20%20return%20isBinary%20%7C%7C%20reIsOctal.test%28value%29%20%3F%20freeParseInt%28value.slice%282%29%2C%20isBinary%20%3F%202%20%3A%208%29%20%3A%20reIsBadHex.test%28value%29%20%3F%20NAN%20%3A%20%2Bvalue%3B%0A%7D%0Avar%20toNumber_default%20%3D%20toNumber%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Flodash-es%2Fdebounce.js%0Avar%20FUNC_ERROR_TEXT%20%3D%20%22Expected%20a%20function%22%3B%0Avar%20nativeMax%20%3D%20Math.max%3B%0Avar%20nativeMin%20%3D%20Math.min%3B%0Afunction%20debounce%28func%2C%20wait%2C%20options%29%20%7B%0A%20%20var%20lastArgs%2C%20lastThis%2C%20maxWait%2C%20result%2C%20timerId%2C%20lastCallTime%2C%20lastInvokeTime%20%3D%200%2C%20leading%20%3D%20false%2C%20maxing%20%3D%20false%2C%20trailing%20%3D%20true%3B%0A%20%20if%20%28typeof%20func%20%21%3D%20%22function%22%29%20%7B%0A%20%20%20%20throw%20new%20TypeError%28FUNC_ERROR_TEXT%29%3B%0A%20%20%7D%0A%20%20wait%20%3D%20toNumber_default%28wait%29%20%7C%7C%200%3B%0A%20%20if%20%28isObject_default%28options%29%29%20%7B%0A%20%20%20%20leading%20%3D%20%21%21options.leading%3B%0A%20%20%20%20maxing%20%3D%20%22maxWait%22%20in%20options%3B%0A%20%20%20%20maxWait%20%3D%20maxing%20%3F%20nativeMax%28toNumber_default%28options.maxWait%29%20%7C%7C%200%2C%20wait%29%20%3A%20maxWait%3B%0A%20%20%20%20trailing%20%3D%20%22trailing%22%20in%20options%20%3F%20%21%21options.trailing%20%3A%20trailing%3B%0A%20%20%7D%0A%20%20function%20invokeFunc%28time%29%20%7B%0A%20%20%20%20var%20args%20%3D%20lastArgs%2C%20thisArg%20%3D%20lastThis%3B%0A%20%20%20%20lastArgs%20%3D%20lastThis%20%3D%20void%200%3B%0A%20%20%20%20lastInvokeTime%20%3D%20time%3B%0A%20%20%20%20result%20%3D%20func.apply%28thisArg%2C%20args%29%3B%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20function%20leadingEdge%28time%29%20%7B%0A%20%20%20%20lastInvokeTime%20%3D%20time%3B%0A%20%20%20%20timerId%20%3D%20setTimeout%28timerExpired%2C%20wait%29%3B%0A%20%20%20%20return%20leading%20%3F%20invokeFunc%28time%29%20%3A%20result%3B%0A%20%20%7D%0A%20%20function%20remainingWait%28time%29%20%7B%0A%20%20%20%20var%20timeSinceLastCall%20%3D%20time%20-%20lastCallTime%2C%20timeSinceLastInvoke%20%3D%20time%20-%20lastInvokeTime%2C%20timeWaiting%20%3D%20wait%20-%20timeSinceLastCall%3B%0A%20%20%20%20return%20maxing%20%3F%20nativeMin%28timeWaiting%2C%20maxWait%20-%20timeSinceLastInvoke%29%20%3A%20timeWaiting%3B%0A%20%20%7D%0A%20%20function%20shouldInvoke%28time%29%20%7B%0A%20%20%20%20var%20timeSinceLastCall%20%3D%20time%20-%20lastCallTime%2C%20timeSinceLastInvoke%20%3D%20time%20-%20lastInvokeTime%3B%0A%20%20%20%20return%20lastCallTime%20%3D%3D%3D%20void%200%20%7C%7C%20timeSinceLastCall%20%3E%3D%20wait%20%7C%7C%20timeSinceLastCall%20%3C%200%20%7C%7C%20maxing%20%26%26%20timeSinceLastInvoke%20%3E%3D%20maxWait%3B%0A%20%20%7D%0A%20%20function%20timerExpired%28%29%20%7B%0A%20%20%20%20var%20time%20%3D%20now_default%28%29%3B%0A%20%20%20%20if%20%28shouldInvoke%28time%29%29%20%7B%0A%20%20%20%20%20%20return%20trailingEdge%28time%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20timerId%20%3D%20setTimeout%28timerExpired%2C%20remainingWait%28time%29%29%3B%0A%20%20%7D%0A%20%20function%20trailingEdge%28time%29%20%7B%0A%20%20%20%20timerId%20%3D%20void%200%3B%0A%20%20%20%20if%20%28trailing%20%26%26%20lastArgs%29%20%7B%0A%20%20%20%20%20%20return%20invokeFunc%28time%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20lastArgs%20%3D%20lastThis%20%3D%20void%200%3B%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20function%20cancel%28%29%20%7B%0A%20%20%20%20if%20%28timerId%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20clearTimeout%28timerId%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20lastInvokeTime%20%3D%200%3B%0A%20%20%20%20lastArgs%20%3D%20lastCallTime%20%3D%20lastThis%20%3D%20timerId%20%3D%20void%200%3B%0A%20%20%7D%0A%20%20function%20flush%28%29%20%7B%0A%20%20%20%20return%20timerId%20%3D%3D%3D%20void%200%20%3F%20result%20%3A%20trailingEdge%28now_default%28%29%29%3B%0A%20%20%7D%0A%20%20function%20debounced%28%29%20%7B%0A%20%20%20%20var%20time%20%3D%20now_default%28%29%2C%20isInvoking%20%3D%20shouldInvoke%28time%29%3B%0A%20%20%20%20lastArgs%20%3D%20arguments%3B%0A%20%20%20%20lastThis%20%3D%20this%3B%0A%20%20%20%20lastCallTime%20%3D%20time%3B%0A%20%20%20%20if%20%28isInvoking%29%20%7B%0A%20%20%20%20%20%20if%20%28timerId%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20leadingEdge%28lastCallTime%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28maxing%29%20%7B%0A%20%20%20%20%20%20%20%20clearTimeout%28timerId%29%3B%0A%20%20%20%20%20%20%20%20timerId%20%3D%20setTimeout%28timerExpired%2C%20wait%29%3B%0A%20%20%20%20%20%20%20%20return%20invokeFunc%28lastCallTime%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28timerId%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20timerId%20%3D%20setTimeout%28timerExpired%2C%20wait%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20debounced.cancel%20%3D%20cancel%3B%0A%20%20debounced.flush%20%3D%20flush%3B%0A%20%20return%20debounced%3B%0A%7D%0Avar%20debounce_default%20%3D%20debounce%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fkapsule%2Fdist%2Fkapsule.mjs%0Afunction%20_arrayLikeToArray%28r%2C%20a2%29%20%7B%0A%20%20%28null%20%3D%3D%20a2%20%7C%7C%20a2%20%3E%20r.length%29%20%26%26%20%28a2%20%3D%20r.length%29%3B%0A%20%20for%20%28var%20e%20%3D%200%2C%20n%20%3D%20Array%28a2%29%3B%20e%20%3C%20a2%3B%20e%2B%2B%29%20n%5Be%5D%20%3D%20r%5Be%5D%3B%0A%20%20return%20n%3B%0A%7D%0Afunction%20_arrayWithHoles%28r%29%20%7B%0A%20%20if%20%28Array.isArray%28r%29%29%20return%20r%3B%0A%7D%0Afunction%20_classCallCheck%28a2%2C%20n%29%20%7B%0A%20%20if%20%28%21%28a2%20instanceof%20n%29%29%20throw%20new%20TypeError%28%22Cannot%20call%20a%20class%20as%20a%20function%22%29%3B%0A%7D%0Afunction%20_createClass%28e%2C%20r%2C%20t%29%20%7B%0A%20%20return%20Object.defineProperty%28e%2C%20%22prototype%22%2C%20%7B%0A%20%20%20%20writable%3A%20false%0A%20%20%7D%29%2C%20e%3B%0A%7D%0Afunction%20_iterableToArrayLimit%28r%2C%20l%29%20%7B%0A%20%20var%20t%20%3D%20null%20%3D%3D%20r%20%3F%20null%20%3A%20%22undefined%22%20%21%3D%20typeof%20Symbol%20%26%26%20r%5BSymbol.iterator%5D%20%7C%7C%20r%5B%22%40%40iterator%22%5D%3B%0A%20%20if%20%28null%20%21%3D%20t%29%20%7B%0A%20%20%20%20var%20e%2C%20n%2C%20i%2C%20u%2C%20a2%20%3D%20%5B%5D%2C%20f%20%3D%20true%2C%20o%20%3D%20false%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20if%20%28i%20%3D%20%28t%20%3D%20t.call%28r%29%29.next%2C%200%20%3D%3D%3D%20l%29%20%3B%0A%20%20%20%20%20%20else%20for%20%28%3B%20%21%28f%20%3D%20%28e%20%3D%20i.call%28t%29%29.done%29%20%26%26%20%28a2.push%28e.value%29%2C%20a2.length%20%21%3D%3D%20l%29%3B%20f%20%3D%20true%29%20%3B%0A%20%20%20%20%7D%20catch%20%28r2%29%20%7B%0A%20%20%20%20%20%20o%20%3D%20true%2C%20n%20%3D%20r2%3B%0A%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21f%20%26%26%20null%20%21%3D%20t.return%20%26%26%20%28u%20%3D%20t.return%28%29%2C%20Object%28u%29%20%21%3D%3D%20u%29%29%20return%3B%0A%20%20%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20%20%20if%20%28o%29%20throw%20n%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20a2%3B%0A%20%20%7D%0A%7D%0Afunction%20_nonIterableRest%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20destructure%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20_slicedToArray%28r%2C%20e%29%20%7B%0A%20%20return%20_arrayWithHoles%28r%29%20%7C%7C%20_iterableToArrayLimit%28r%2C%20e%29%20%7C%7C%20_unsupportedIterableToArray%28r%2C%20e%29%20%7C%7C%20_nonIterableRest%28%29%3B%0A%7D%0Afunction%20_unsupportedIterableToArray%28r%2C%20a2%29%20%7B%0A%20%20if%20%28r%29%20%7B%0A%20%20%20%20if%20%28%22string%22%20%3D%3D%20typeof%20r%29%20return%20_arrayLikeToArray%28r%2C%20a2%29%3B%0A%20%20%20%20var%20t%20%3D%20%7B%7D.toString.call%28r%29.slice%288%2C%20-1%29%3B%0A%20%20%20%20return%20%22Object%22%20%3D%3D%3D%20t%20%26%26%20r.constructor%20%26%26%20%28t%20%3D%20r.constructor.name%29%2C%20%22Map%22%20%3D%3D%3D%20t%20%7C%7C%20%22Set%22%20%3D%3D%3D%20t%20%3F%20Array.from%28r%29%20%3A%20%22Arguments%22%20%3D%3D%3D%20t%20%7C%7C%20%2F%5E%28%3F%3AUi%7CI%29nt%28%3F%3A8%7C16%7C32%29%28%3F%3AClamped%29%3FArray%24%2F.test%28t%29%20%3F%20_arrayLikeToArray%28r%2C%20a2%29%20%3A%20void%200%3B%0A%20%20%7D%0A%7D%0Avar%20Prop%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20_createClass%28function%20Prop2%28name%2C%20_ref%29%20%7B%0A%20%20var%20_ref%24default%20%3D%20_ref%5B%22default%22%5D%2C%20defaultVal%20%3D%20_ref%24default%20%3D%3D%3D%20void%200%20%3F%20null%20%3A%20_ref%24default%2C%20_ref%24triggerUpdate%20%3D%20_ref.triggerUpdate%2C%20triggerUpdate%20%3D%20_ref%24triggerUpdate%20%3D%3D%3D%20void%200%20%3F%20true%20%3A%20_ref%24triggerUpdate%2C%20_ref%24onChange%20%3D%20_ref.onChange%2C%20onChange13%20%3D%20_ref%24onChange%20%3D%3D%3D%20void%200%20%3F%20function%28newVal%2C%20state%29%20%7B%0A%20%20%7D%20%3A%20_ref%24onChange%3B%0A%20%20_classCallCheck%28this%2C%20Prop2%29%3B%0A%20%20this.name%20%3D%20name%3B%0A%20%20this.defaultVal%20%3D%20defaultVal%3B%0A%20%20this.triggerUpdate%20%3D%20triggerUpdate%3B%0A%20%20this.onChange%20%3D%20onChange13%3B%0A%7D%29%3B%0Afunction%20index2%28_ref2%29%20%7B%0A%20%20var%20_ref2%24stateInit%20%3D%20_ref2.stateInit%2C%20stateInit4%20%3D%20_ref2%24stateInit%20%3D%3D%3D%20void%200%20%3F%20function%28%29%20%7B%0A%20%20%20%20return%20%7B%7D%3B%0A%20%20%7D%20%3A%20_ref2%24stateInit%2C%20_ref2%24props%20%3D%20_ref2.props%2C%20rawProps%20%3D%20_ref2%24props%20%3D%3D%3D%20void%200%20%3F%20%7B%7D%20%3A%20_ref2%24props%2C%20_ref2%24methods%20%3D%20_ref2.methods%2C%20methods%20%3D%20_ref2%24methods%20%3D%3D%3D%20void%200%20%3F%20%7B%7D%20%3A%20_ref2%24methods%2C%20_ref2%24aliases%20%3D%20_ref2.aliases%2C%20aliases%20%3D%20_ref2%24aliases%20%3D%3D%3D%20void%200%20%3F%20%7B%7D%20%3A%20_ref2%24aliases%2C%20_ref2%24init%20%3D%20_ref2.init%2C%20initFn%20%3D%20_ref2%24init%20%3D%3D%3D%20void%200%20%3F%20function%28%29%20%7B%0A%20%20%7D%20%3A%20_ref2%24init%2C%20_ref2%24update%20%3D%20_ref2.update%2C%20updateFn%20%3D%20_ref2%24update%20%3D%3D%3D%20void%200%20%3F%20function%28%29%20%7B%0A%20%20%7D%20%3A%20_ref2%24update%3B%0A%20%20var%20props%20%3D%20Object.keys%28rawProps%29.map%28function%28propName%29%20%7B%0A%20%20%20%20return%20new%20Prop%28propName%2C%20rawProps%5BpropName%5D%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20function%28%29%20%7B%0A%20%20%20%20var%20options%20%3D%20arguments.length%20%3E%200%20%26%26%20arguments%5B0%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B0%5D%20%3A%20%7B%7D%3B%0A%20%20%20%20var%20state%20%3D%20Object.assign%28%0A%20%20%20%20%20%20%7B%7D%2C%0A%20%20%20%20%20%20stateInit4%20instanceof%20Function%20%3F%20stateInit4%28options%29%20%3A%20stateInit4%2C%0A%20%20%20%20%20%20%2F%2F%20Support%20plain%20objects%20for%20backwards%20compatibility%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20initialised%3A%20false%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%29%3B%0A%20%20%20%20var%20changedProps%20%3D%20%7B%7D%3B%0A%20%20%20%20function%20comp%28nodeElement%29%20%7B%0A%20%20%20%20%20%20initStatic%28nodeElement%2C%20options%29%3B%0A%20%20%20%20%20%20digest%28%29%3B%0A%20%20%20%20%20%20return%20comp%3B%0A%20%20%20%20%7D%0A%20%20%20%20var%20initStatic%20%3D%20function%20initStatic2%28nodeElement%2C%20options2%29%20%7B%0A%20%20%20%20%20%20initFn.call%28comp%2C%20nodeElement%2C%20state%2C%20options2%29%3B%0A%20%20%20%20%20%20state.initialised%20%3D%20true%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20var%20digest%20%3D%20debounce_default%28function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28%21state.initialised%29%20%7B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20updateFn.call%28comp%2C%20state%2C%20changedProps%29%3B%0A%20%20%20%20%20%20changedProps%20%3D%20%7B%7D%3B%0A%20%20%20%20%7D%2C%201%29%3B%0A%20%20%20%20props.forEach%28function%28prop%29%20%7B%0A%20%20%20%20%20%20comp%5Bprop.name%5D%20%3D%20getSetProp%28prop%29%3B%0A%20%20%20%20%20%20function%20getSetProp%28_ref3%29%20%7B%0A%20%20%20%20%20%20%20%20var%20prop2%20%3D%20_ref3.name%2C%20_ref3%24triggerUpdate%20%3D%20_ref3.triggerUpdate%2C%20redigest%20%3D%20_ref3%24triggerUpdate%20%3D%3D%3D%20void%200%20%3F%20false%20%3A%20_ref3%24triggerUpdate%2C%20_ref3%24onChange%20%3D%20_ref3.onChange%2C%20onChange13%20%3D%20_ref3%24onChange%20%3D%3D%3D%20void%200%20%3F%20function%28newVal%2C%20state2%29%20%7B%0A%20%20%20%20%20%20%20%20%7D%20%3A%20_ref3%24onChange%2C%20_ref3%24defaultVal%20%3D%20_ref3.defaultVal%2C%20defaultVal%20%3D%20_ref3%24defaultVal%20%3D%3D%3D%20void%200%20%3F%20null%20%3A%20_ref3%24defaultVal%3B%0A%20%20%20%20%20%20%20%20return%20function%28_%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20curVal%20%3D%20state%5Bprop2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21arguments.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20curVal%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20val%20%3D%20_%20%3D%3D%3D%20void%200%20%3F%20defaultVal%20%3A%20_%3B%0A%20%20%20%20%20%20%20%20%20%20state%5Bprop2%5D%20%3D%20val%3B%0A%20%20%20%20%20%20%20%20%20%20onChange13.call%28comp%2C%20val%2C%20state%2C%20curVal%29%3B%0A%20%20%20%20%20%20%20%20%20%20%21changedProps.hasOwnProperty%28prop2%29%20%26%26%20%28changedProps%5Bprop2%5D%20%3D%20curVal%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28redigest%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20digest%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20return%20comp%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20Object.keys%28methods%29.forEach%28function%28methodName%29%20%7B%0A%20%20%20%20%20%20comp%5BmethodName%5D%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20_methods%24methodName%3B%0A%20%20%20%20%20%20%20%20for%20%28var%20_len%20%3D%20arguments.length%2C%20args%20%3D%20new%20Array%28_len%29%2C%20_key%20%3D%200%3B%20_key%20%3C%20_len%3B%20_key%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20args%5B_key%5D%20%3D%20arguments%5B_key%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%28_methods%24methodName%20%3D%20methods%5BmethodName%5D%29.call.apply%28_methods%24methodName%2C%20%5Bcomp%2C%20state%5D.concat%28args%29%29%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20Object.entries%28aliases%29.forEach%28function%28_ref4%29%20%7B%0A%20%20%20%20%20%20var%20_ref5%20%3D%20_slicedToArray%28_ref4%2C%202%29%2C%20alias%20%3D%20_ref5%5B0%5D%2C%20target%20%3D%20_ref5%5B1%5D%3B%0A%20%20%20%20%20%20return%20comp%5Balias%5D%20%3D%20comp%5Btarget%5D%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20comp.resetProps%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20props.forEach%28function%28prop%29%20%7B%0A%20%20%20%20%20%20%20%20comp%5Bprop.name%5D%28prop.defaultVal%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20return%20comp%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20comp.resetProps%28%29%3B%0A%20%20%20%20state._rerender%20%3D%20digest%3B%0A%20%20%20%20return%20comp%3B%0A%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Faccessor-fn%2Fdist%2Faccessor-fn.mjs%0Avar%20index3%20%3D%20function%28p%29%20%7B%0A%20%20return%20typeof%20p%20%3D%3D%3D%20%22function%22%20%3F%20p%20%3A%20typeof%20p%20%3D%3D%3D%20%22string%22%20%3F%20function%28obj%29%20%7B%0A%20%20%20%20return%20obj%5Bp%5D%3B%0A%20%20%7D%20%3A%20function%28obj%29%20%7B%0A%20%20%20%20return%20p%3B%0A%20%20%7D%3B%0A%7D%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Finternmap%2Fsrc%2Findex.js%0Avar%20InternMap%20%3D%20class%20extends%20Map%20%7B%0A%20%20constructor%28entries%2C%20key%20%3D%20keyof%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20Object.defineProperties%28this%2C%20%7B%20_intern%3A%20%7B%20value%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%20%7D%2C%20_key%3A%20%7B%20value%3A%20key%20%7D%20%7D%29%3B%0A%20%20%20%20if%20%28entries%20%21%3D%20null%29%20for%20%28const%20%5Bkey2%2C%20value%5D%20of%20entries%29%20this.set%28key2%2C%20value%29%3B%0A%20%20%7D%0A%20%20get%28key%29%20%7B%0A%20%20%20%20return%20super.get%28intern_get%28this%2C%20key%29%29%3B%0A%20%20%7D%0A%20%20has%28key%29%20%7B%0A%20%20%20%20return%20super.has%28intern_get%28this%2C%20key%29%29%3B%0A%20%20%7D%0A%20%20set%28key%2C%20value%29%20%7B%0A%20%20%20%20return%20super.set%28intern_set%28this%2C%20key%29%2C%20value%29%3B%0A%20%20%7D%0A%20%20delete%28key%29%20%7B%0A%20%20%20%20return%20super.delete%28intern_delete%28this%2C%20key%29%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20intern_get%28%7B%20_intern%2C%20_key%20%7D%2C%20value%29%20%7B%0A%20%20const%20key%20%3D%20_key%28value%29%3B%0A%20%20return%20_intern.has%28key%29%20%3F%20_intern.get%28key%29%20%3A%20value%3B%0A%7D%0Afunction%20intern_set%28%7B%20_intern%2C%20_key%20%7D%2C%20value%29%20%7B%0A%20%20const%20key%20%3D%20_key%28value%29%3B%0A%20%20if%20%28_intern.has%28key%29%29%20return%20_intern.get%28key%29%3B%0A%20%20_intern.set%28key%2C%20value%29%3B%0A%20%20return%20value%3B%0A%7D%0Afunction%20intern_delete%28%7B%20_intern%2C%20_key%20%7D%2C%20value%29%20%7B%0A%20%20const%20key%20%3D%20_key%28value%29%3B%0A%20%20if%20%28_intern.has%28key%29%29%20%7B%0A%20%20%20%20value%20%3D%20_intern.get%28key%29%3B%0A%20%20%20%20_intern.delete%28key%29%3B%0A%20%20%7D%0A%20%20return%20value%3B%0A%7D%0Afunction%20keyof%28value%29%20%7B%0A%20%20return%20value%20%21%3D%3D%20null%20%26%26%20typeof%20value%20%3D%3D%3D%20%22object%22%20%3F%20value.valueOf%28%29%20%3A%20value%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-array%2Fsrc%2Fmax.js%0Afunction%20max%28values%2C%20valueof%29%20%7B%0A%20%20let%20max2%3B%0A%20%20if%20%28valueof%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20for%20%28const%20value%20of%20values%29%20%7B%0A%20%20%20%20%20%20if%20%28value%20%21%3D%20null%20%26%26%20%28max2%20%3C%20value%20%7C%7C%20max2%20%3D%3D%3D%20void%200%20%26%26%20value%20%3E%3D%20value%29%29%20%7B%0A%20%20%20%20%20%20%20%20max2%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20let%20index5%20%3D%20-1%3B%0A%20%20%20%20for%20%28let%20value%20of%20values%29%20%7B%0A%20%20%20%20%20%20if%20%28%28value%20%3D%20valueof%28value%2C%20%2B%2Bindex5%2C%20values%29%29%20%21%3D%20null%20%26%26%20%28max2%20%3C%20value%20%7C%7C%20max2%20%3D%3D%3D%20void%200%20%26%26%20value%20%3E%3D%20value%29%29%20%7B%0A%20%20%20%20%20%20%20%20max2%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20max2%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-array%2Fsrc%2Fmin.js%0Afunction%20min%28values%2C%20valueof%29%20%7B%0A%20%20let%20min2%3B%0A%20%20if%20%28valueof%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20for%20%28const%20value%20of%20values%29%20%7B%0A%20%20%20%20%20%20if%20%28value%20%21%3D%20null%20%26%26%20%28min2%20%3E%20value%20%7C%7C%20min2%20%3D%3D%3D%20void%200%20%26%26%20value%20%3E%3D%20value%29%29%20%7B%0A%20%20%20%20%20%20%20%20min2%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20let%20index5%20%3D%20-1%3B%0A%20%20%20%20for%20%28let%20value%20of%20values%29%20%7B%0A%20%20%20%20%20%20if%20%28%28value%20%3D%20valueof%28value%2C%20%2B%2Bindex5%2C%20values%29%29%20%21%3D%20null%20%26%26%20%28min2%20%3E%20value%20%7C%7C%20min2%20%3D%3D%3D%20void%200%20%26%26%20value%20%3E%3D%20value%29%29%20%7B%0A%20%20%20%20%20%20%20%20min2%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20min2%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Findex-array-by%2Fdist%2Findex-array-by.mjs%0Afunction%20_arrayLikeToArray2%28r%2C%20a2%29%20%7B%0A%20%20%28null%20%3D%3D%20a2%20%7C%7C%20a2%20%3E%20r.length%29%20%26%26%20%28a2%20%3D%20r.length%29%3B%0A%20%20for%20%28var%20e%20%3D%200%2C%20n%20%3D%20Array%28a2%29%3B%20e%20%3C%20a2%3B%20e%2B%2B%29%20n%5Be%5D%20%3D%20r%5Be%5D%3B%0A%20%20return%20n%3B%0A%7D%0Afunction%20_arrayWithHoles2%28r%29%20%7B%0A%20%20if%20%28Array.isArray%28r%29%29%20return%20r%3B%0A%7D%0Afunction%20_arrayWithoutHoles%28r%29%20%7B%0A%20%20if%20%28Array.isArray%28r%29%29%20return%20_arrayLikeToArray2%28r%29%3B%0A%7D%0Afunction%20_iterableToArray%28r%29%20%7B%0A%20%20if%20%28%22undefined%22%20%21%3D%20typeof%20Symbol%20%26%26%20null%20%21%3D%20r%5BSymbol.iterator%5D%20%7C%7C%20null%20%21%3D%20r%5B%22%40%40iterator%22%5D%29%20return%20Array.from%28r%29%3B%0A%7D%0Afunction%20_iterableToArrayLimit2%28r%2C%20l%29%20%7B%0A%20%20var%20t%20%3D%20null%20%3D%3D%20r%20%3F%20null%20%3A%20%22undefined%22%20%21%3D%20typeof%20Symbol%20%26%26%20r%5BSymbol.iterator%5D%20%7C%7C%20r%5B%22%40%40iterator%22%5D%3B%0A%20%20if%20%28null%20%21%3D%20t%29%20%7B%0A%20%20%20%20var%20e%2C%20n%2C%20i%2C%20u%2C%20a2%20%3D%20%5B%5D%2C%20f%20%3D%20true%2C%20o%20%3D%20false%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20if%20%28i%20%3D%20%28t%20%3D%20t.call%28r%29%29.next%2C%200%20%3D%3D%3D%20l%29%20%3B%0A%20%20%20%20%20%20else%20for%20%28%3B%20%21%28f%20%3D%20%28e%20%3D%20i.call%28t%29%29.done%29%20%26%26%20%28a2.push%28e.value%29%2C%20a2.length%20%21%3D%3D%20l%29%3B%20f%20%3D%20true%29%20%3B%0A%20%20%20%20%7D%20catch%20%28r2%29%20%7B%0A%20%20%20%20%20%20o%20%3D%20true%2C%20n%20%3D%20r2%3B%0A%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21f%20%26%26%20null%20%21%3D%20t.return%20%26%26%20%28u%20%3D%20t.return%28%29%2C%20Object%28u%29%20%21%3D%3D%20u%29%29%20return%3B%0A%20%20%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20%20%20if%20%28o%29%20throw%20n%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20a2%3B%0A%20%20%7D%0A%7D%0Afunction%20_nonIterableRest2%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20destructure%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20_nonIterableSpread%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20spread%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20_objectWithoutProperties%28e%2C%20t%29%20%7B%0A%20%20if%20%28null%20%3D%3D%20e%29%20return%20%7B%7D%3B%0A%20%20var%20o%2C%20r%2C%20i%20%3D%20_objectWithoutPropertiesLoose%28e%2C%20t%29%3B%0A%20%20if%20%28Object.getOwnPropertySymbols%29%20%7B%0A%20%20%20%20var%20s%20%3D%20Object.getOwnPropertySymbols%28e%29%3B%0A%20%20%20%20for%20%28r%20%3D%200%3B%20r%20%3C%20s.length%3B%20r%2B%2B%29%20o%20%3D%20s%5Br%5D%2C%20t.includes%28o%29%20%7C%7C%20%7B%7D.propertyIsEnumerable.call%28e%2C%20o%29%20%26%26%20%28i%5Bo%5D%20%3D%20e%5Bo%5D%29%3B%0A%20%20%7D%0A%20%20return%20i%3B%0A%7D%0Afunction%20_objectWithoutPropertiesLoose%28r%2C%20e%29%20%7B%0A%20%20if%20%28null%20%3D%3D%20r%29%20return%20%7B%7D%3B%0A%20%20var%20t%20%3D%20%7B%7D%3B%0A%20%20for%20%28var%20n%20in%20r%29%20if%20%28%7B%7D.hasOwnProperty.call%28r%2C%20n%29%29%20%7B%0A%20%20%20%20if%20%28e.includes%28n%29%29%20continue%3B%0A%20%20%20%20t%5Bn%5D%20%3D%20r%5Bn%5D%3B%0A%20%20%7D%0A%20%20return%20t%3B%0A%7D%0Afunction%20_slicedToArray2%28r%2C%20e%29%20%7B%0A%20%20return%20_arrayWithHoles2%28r%29%20%7C%7C%20_iterableToArrayLimit2%28r%2C%20e%29%20%7C%7C%20_unsupportedIterableToArray2%28r%2C%20e%29%20%7C%7C%20_nonIterableRest2%28%29%3B%0A%7D%0Afunction%20_toConsumableArray%28r%29%20%7B%0A%20%20return%20_arrayWithoutHoles%28r%29%20%7C%7C%20_iterableToArray%28r%29%20%7C%7C%20_unsupportedIterableToArray2%28r%29%20%7C%7C%20_nonIterableSpread%28%29%3B%0A%7D%0Afunction%20_toPrimitive%28t%2C%20r%29%20%7B%0A%20%20if%20%28%22object%22%20%21%3D%20typeof%20t%20%7C%7C%20%21t%29%20return%20t%3B%0A%20%20var%20e%20%3D%20t%5BSymbol.toPrimitive%5D%3B%0A%20%20if%20%28void%200%20%21%3D%3D%20e%29%20%7B%0A%20%20%20%20var%20i%20%3D%20e.call%28t%2C%20r%29%3B%0A%20%20%20%20if%20%28%22object%22%20%21%3D%20typeof%20i%29%20return%20i%3B%0A%20%20%20%20throw%20new%20TypeError%28%22%40%40toPrimitive%20must%20return%20a%20primitive%20value.%22%29%3B%0A%20%20%7D%0A%20%20return%20String%28t%29%3B%0A%7D%0Afunction%20_toPropertyKey%28t%29%20%7B%0A%20%20var%20i%20%3D%20_toPrimitive%28t%2C%20%22string%22%29%3B%0A%20%20return%20%22symbol%22%20%3D%3D%20typeof%20i%20%3F%20i%20%3A%20i%20%2B%20%22%22%3B%0A%7D%0Afunction%20_unsupportedIterableToArray2%28r%2C%20a2%29%20%7B%0A%20%20if%20%28r%29%20%7B%0A%20%20%20%20if%20%28%22string%22%20%3D%3D%20typeof%20r%29%20return%20_arrayLikeToArray2%28r%2C%20a2%29%3B%0A%20%20%20%20var%20t%20%3D%20%7B%7D.toString.call%28r%29.slice%288%2C%20-1%29%3B%0A%20%20%20%20return%20%22Object%22%20%3D%3D%3D%20t%20%26%26%20r.constructor%20%26%26%20%28t%20%3D%20r.constructor.name%29%2C%20%22Map%22%20%3D%3D%3D%20t%20%7C%7C%20%22Set%22%20%3D%3D%3D%20t%20%3F%20Array.from%28r%29%20%3A%20%22Arguments%22%20%3D%3D%3D%20t%20%7C%7C%20%2F%5E%28%3F%3AUi%7CI%29nt%28%3F%3A8%7C16%7C32%29%28%3F%3AClamped%29%3FArray%24%2F.test%28t%29%20%3F%20_arrayLikeToArray2%28r%2C%20a2%29%20%3A%20void%200%3B%0A%20%20%7D%0A%7D%0Avar%20index4%20%3D%20function%28%29%20%7B%0A%20%20var%20list%20%3D%20arguments.length%20%3E%200%20%26%26%20arguments%5B0%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B0%5D%20%3A%20%5B%5D%3B%0A%20%20var%20keyAccessors%20%3D%20arguments.length%20%3E%201%20%26%26%20arguments%5B1%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B1%5D%20%3A%20%5B%5D%3B%0A%20%20var%20multiItem%20%3D%20arguments.length%20%3E%202%20%26%26%20arguments%5B2%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B2%5D%20%3A%20true%3B%0A%20%20var%20flattenKeys%20%3D%20arguments.length%20%3E%203%20%26%26%20arguments%5B3%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B3%5D%20%3A%20false%3B%0A%20%20var%20keys%20%3D%20%28keyAccessors%20instanceof%20Array%20%3F%20keyAccessors.length%20%3F%20keyAccessors%20%3A%20%5Bvoid%200%5D%20%3A%20%5BkeyAccessors%5D%29.map%28function%28key%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20keyAccessor%3A%20key%2C%0A%20%20%20%20%20%20isProp%3A%20%21%28key%20instanceof%20Function%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%29%3B%0A%20%20var%20indexedResult%20%3D%20list.reduce%28function%28res%2C%20item%29%20%7B%0A%20%20%20%20var%20iterObj%20%3D%20res%3B%0A%20%20%20%20var%20itemVal%20%3D%20item%3B%0A%20%20%20%20keys.forEach%28function%28_ref%2C%20idx%29%20%7B%0A%20%20%20%20%20%20var%20keyAccessor%20%3D%20_ref.keyAccessor%2C%20isProp%20%3D%20_ref.isProp%3B%0A%20%20%20%20%20%20var%20key%3B%0A%20%20%20%20%20%20if%20%28isProp%29%20%7B%0A%20%20%20%20%20%20%20%20var%20_itemVal%20%3D%20itemVal%2C%20propVal%20%3D%20_itemVal%5BkeyAccessor%5D%2C%20rest%20%3D%20_objectWithoutProperties%28_itemVal%2C%20%5BkeyAccessor%5D.map%28_toPropertyKey%29%29%3B%0A%20%20%20%20%20%20%20%20key%20%3D%20propVal%3B%0A%20%20%20%20%20%20%20%20itemVal%20%3D%20rest%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20key%20%3D%20keyAccessor%28itemVal%2C%20idx%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28idx%20%2B%201%20%3C%20keys.length%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21iterObj.hasOwnProperty%28key%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20iterObj%5Bkey%5D%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20iterObj%20%3D%20iterObj%5Bkey%5D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28multiItem%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21iterObj.hasOwnProperty%28key%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20iterObj%5Bkey%5D%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20iterObj%5Bkey%5D.push%28itemVal%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20iterObj%5Bkey%5D%20%3D%20itemVal%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20return%20res%3B%0A%20%20%7D%2C%20%7B%7D%29%3B%0A%20%20if%20%28multiItem%20instanceof%20Function%29%20%7B%0A%20%20%20%20%28function%20reduce%28node%29%20%7B%0A%20%20%20%20%20%20var%20level%20%3D%20arguments.length%20%3E%201%20%26%26%20arguments%5B1%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B1%5D%20%3A%201%3B%0A%20%20%20%20%20%20if%20%28level%20%3D%3D%3D%20keys.length%29%20%7B%0A%20%20%20%20%20%20%20%20Object.keys%28node%29.forEach%28function%28k%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20node%5Bk%5D%20%3D%20multiItem%28node%5Bk%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20Object.values%28node%29.forEach%28function%28child%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20reduce%28child%2C%20level%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%28indexedResult%29%3B%0A%20%20%7D%0A%20%20var%20result%20%3D%20indexedResult%3B%0A%20%20if%20%28flattenKeys%29%20%7B%0A%20%20%20%20result%20%3D%20%5B%5D%3B%0A%20%20%20%20%28function%20flatten2%28node%29%20%7B%0A%20%20%20%20%20%20var%20accKeys%20%3D%20arguments.length%20%3E%201%20%26%26%20arguments%5B1%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B1%5D%20%3A%20%5B%5D%3B%0A%20%20%20%20%20%20if%20%28accKeys.length%20%3D%3D%3D%20keys.length%29%20%7B%0A%20%20%20%20%20%20%20%20result.push%28%7B%0A%20%20%20%20%20%20%20%20%20%20keys%3A%20accKeys%2C%0A%20%20%20%20%20%20%20%20%20%20vals%3A%20node%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20Object.entries%28node%29.forEach%28function%28_ref2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20_ref3%20%3D%20_slicedToArray2%28_ref2%2C%202%29%2C%20key%20%3D%20_ref3%5B0%5D%2C%20val%20%3D%20_ref3%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20return%20flatten2%28val%2C%20%5B%5D.concat%28_toConsumableArray%28accKeys%29%2C%20%5Bkey%5D%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%28indexedResult%29%3B%0A%20%20%20%20if%20%28keyAccessors%20instanceof%20Array%20%26%26%20keyAccessors.length%20%3D%3D%3D%200%20%26%26%20result.length%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20result%5B0%5D.keys%20%3D%20%5B%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20result%3B%0A%7D%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fdata-joint%2Fdist%2Fdata-joint.mjs%0Afunction%20_iterableToArrayLimit3%28arr%2C%20i%29%20%7B%0A%20%20var%20_i%20%3D%20null%20%3D%3D%20arr%20%3F%20null%20%3A%20%22undefined%22%20%21%3D%20typeof%20Symbol%20%26%26%20arr%5BSymbol.iterator%5D%20%7C%7C%20arr%5B%22%40%40iterator%22%5D%3B%0A%20%20if%20%28null%20%21%3D%20_i%29%20%7B%0A%20%20%20%20var%20_s%2C%20_e%2C%20_x3%2C%20_r%2C%20_arr%20%3D%20%5B%5D%2C%20_n%20%3D%20true%2C%20_d%20%3D%20false%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20if%20%28_x3%20%3D%20%28_i%20%3D%20_i.call%28arr%29%29.next%2C%200%20%3D%3D%3D%20i%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28Object%28_i%29%20%21%3D%3D%20_i%29%20return%3B%0A%20%20%20%20%20%20%20%20_n%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%20else%20for%20%28%3B%20%21%28_n%20%3D%20%28_s%20%3D%20_x3.call%28_i%29%29.done%29%20%26%26%20%28_arr.push%28_s.value%29%2C%20_arr.length%20%21%3D%3D%20i%29%3B%20_n%20%3D%20true%29%20%3B%0A%20%20%20%20%7D%20catch%20%28err%29%20%7B%0A%20%20%20%20%20%20_d%20%3D%20true%2C%20_e%20%3D%20err%3B%0A%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21_n%20%26%26%20null%20%21%3D%20_i.return%20%26%26%20%28_r%20%3D%20_i.return%28%29%2C%20Object%28_r%29%20%21%3D%3D%20_r%29%29%20return%3B%0A%20%20%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20%20%20if%20%28_d%29%20throw%20_e%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20_arr%3B%0A%20%20%7D%0A%7D%0Afunction%20ownKeys%28object%2C%20enumerableOnly%29%20%7B%0A%20%20var%20keys%20%3D%20Object.keys%28object%29%3B%0A%20%20if%20%28Object.getOwnPropertySymbols%29%20%7B%0A%20%20%20%20var%20symbols%20%3D%20Object.getOwnPropertySymbols%28object%29%3B%0A%20%20%20%20enumerableOnly%20%26%26%20%28symbols%20%3D%20symbols.filter%28function%28sym%29%20%7B%0A%20%20%20%20%20%20return%20Object.getOwnPropertyDescriptor%28object%2C%20sym%29.enumerable%3B%0A%20%20%20%20%7D%29%29%2C%20keys.push.apply%28keys%2C%20symbols%29%3B%0A%20%20%7D%0A%20%20return%20keys%3B%0A%7D%0Afunction%20_objectSpread2%28target%29%20%7B%0A%20%20for%20%28var%20i%20%3D%201%3B%20i%20%3C%20arguments.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20var%20source%20%3D%20null%20%21%3D%20arguments%5Bi%5D%20%3F%20arguments%5Bi%5D%20%3A%20%7B%7D%3B%0A%20%20%20%20i%20%25%202%20%3F%20ownKeys%28Object%28source%29%2C%20true%29.forEach%28function%28key%29%20%7B%0A%20%20%20%20%20%20_defineProperty%28target%2C%20key%2C%20source%5Bkey%5D%29%3B%0A%20%20%20%20%7D%29%20%3A%20Object.getOwnPropertyDescriptors%20%3F%20Object.defineProperties%28target%2C%20Object.getOwnPropertyDescriptors%28source%29%29%20%3A%20ownKeys%28Object%28source%29%29.forEach%28function%28key%29%20%7B%0A%20%20%20%20%20%20Object.defineProperty%28target%2C%20key%2C%20Object.getOwnPropertyDescriptor%28source%2C%20key%29%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20return%20target%3B%0A%7D%0Afunction%20_defineProperty%28obj%2C%20key%2C%20value%29%20%7B%0A%20%20key%20%3D%20_toPropertyKey2%28key%29%3B%0A%20%20if%20%28key%20in%20obj%29%20%7B%0A%20%20%20%20Object.defineProperty%28obj%2C%20key%2C%20%7B%0A%20%20%20%20%20%20value%2C%0A%20%20%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20%20%20writable%3A%20true%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20obj%5Bkey%5D%20%3D%20value%3B%0A%20%20%7D%0A%20%20return%20obj%3B%0A%7D%0Afunction%20_objectWithoutPropertiesLoose2%28source%2C%20excluded%29%20%7B%0A%20%20if%20%28source%20%3D%3D%20null%29%20return%20%7B%7D%3B%0A%20%20var%20target%20%3D%20%7B%7D%3B%0A%20%20var%20sourceKeys%20%3D%20Object.keys%28source%29%3B%0A%20%20var%20key%2C%20i%3B%0A%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20sourceKeys.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20key%20%3D%20sourceKeys%5Bi%5D%3B%0A%20%20%20%20if%20%28excluded.indexOf%28key%29%20%3E%3D%200%29%20continue%3B%0A%20%20%20%20target%5Bkey%5D%20%3D%20source%5Bkey%5D%3B%0A%20%20%7D%0A%20%20return%20target%3B%0A%7D%0Afunction%20_objectWithoutProperties2%28source%2C%20excluded%29%20%7B%0A%20%20if%20%28source%20%3D%3D%20null%29%20return%20%7B%7D%3B%0A%20%20var%20target%20%3D%20_objectWithoutPropertiesLoose2%28source%2C%20excluded%29%3B%0A%20%20var%20key%2C%20i%3B%0A%20%20if%20%28Object.getOwnPropertySymbols%29%20%7B%0A%20%20%20%20var%20sourceSymbolKeys%20%3D%20Object.getOwnPropertySymbols%28source%29%3B%0A%20%20%20%20for%20%28i%20%3D%200%3B%20i%20%3C%20sourceSymbolKeys.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20key%20%3D%20sourceSymbolKeys%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28excluded.indexOf%28key%29%20%3E%3D%200%29%20continue%3B%0A%20%20%20%20%20%20if%20%28%21Object.prototype.propertyIsEnumerable.call%28source%2C%20key%29%29%20continue%3B%0A%20%20%20%20%20%20target%5Bkey%5D%20%3D%20source%5Bkey%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20target%3B%0A%7D%0Afunction%20_slicedToArray3%28arr%2C%20i%29%20%7B%0A%20%20return%20_arrayWithHoles3%28arr%29%20%7C%7C%20_iterableToArrayLimit3%28arr%2C%20i%29%20%7C%7C%20_unsupportedIterableToArray3%28arr%2C%20i%29%20%7C%7C%20_nonIterableRest3%28%29%3B%0A%7D%0Afunction%20_toConsumableArray2%28arr%29%20%7B%0A%20%20return%20_arrayWithoutHoles2%28arr%29%20%7C%7C%20_iterableToArray2%28arr%29%20%7C%7C%20_unsupportedIterableToArray3%28arr%29%20%7C%7C%20_nonIterableSpread2%28%29%3B%0A%7D%0Afunction%20_arrayWithoutHoles2%28arr%29%20%7B%0A%20%20if%20%28Array.isArray%28arr%29%29%20return%20_arrayLikeToArray3%28arr%29%3B%0A%7D%0Afunction%20_arrayWithHoles3%28arr%29%20%7B%0A%20%20if%20%28Array.isArray%28arr%29%29%20return%20arr%3B%0A%7D%0Afunction%20_iterableToArray2%28iter%29%20%7B%0A%20%20if%20%28typeof%20Symbol%20%21%3D%3D%20%22undefined%22%20%26%26%20iter%5BSymbol.iterator%5D%20%21%3D%20null%20%7C%7C%20iter%5B%22%40%40iterator%22%5D%20%21%3D%20null%29%20return%20Array.from%28iter%29%3B%0A%7D%0Afunction%20_unsupportedIterableToArray3%28o%2C%20minLen%29%20%7B%0A%20%20if%20%28%21o%29%20return%3B%0A%20%20if%20%28typeof%20o%20%3D%3D%3D%20%22string%22%29%20return%20_arrayLikeToArray3%28o%2C%20minLen%29%3B%0A%20%20var%20n%20%3D%20Object.prototype.toString.call%28o%29.slice%288%2C%20-1%29%3B%0A%20%20if%20%28n%20%3D%3D%3D%20%22Object%22%20%26%26%20o.constructor%29%20n%20%3D%20o.constructor.name%3B%0A%20%20if%20%28n%20%3D%3D%3D%20%22Map%22%20%7C%7C%20n%20%3D%3D%3D%20%22Set%22%29%20return%20Array.from%28o%29%3B%0A%20%20if%20%28n%20%3D%3D%3D%20%22Arguments%22%20%7C%7C%20%2F%5E%28%3F%3AUi%7CI%29nt%28%3F%3A8%7C16%7C32%29%28%3F%3AClamped%29%3FArray%24%2F.test%28n%29%29%20return%20_arrayLikeToArray3%28o%2C%20minLen%29%3B%0A%7D%0Afunction%20_arrayLikeToArray3%28arr%2C%20len%29%20%7B%0A%20%20if%20%28len%20%3D%3D%20null%20%7C%7C%20len%20%3E%20arr.length%29%20len%20%3D%20arr.length%3B%0A%20%20for%20%28var%20i%20%3D%200%2C%20arr2%20%3D%20new%20Array%28len%29%3B%20i%20%3C%20len%3B%20i%2B%2B%29%20arr2%5Bi%5D%20%3D%20arr%5Bi%5D%3B%0A%20%20return%20arr2%3B%0A%7D%0Afunction%20_nonIterableSpread2%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20spread%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20_nonIterableRest3%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20destructure%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20_toPrimitive2%28input%2C%20hint%29%20%7B%0A%20%20if%20%28typeof%20input%20%21%3D%3D%20%22object%22%20%7C%7C%20input%20%3D%3D%3D%20null%29%20return%20input%3B%0A%20%20var%20prim%20%3D%20input%5BSymbol.toPrimitive%5D%3B%0A%20%20if%20%28prim%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20var%20res%20%3D%20prim.call%28input%2C%20hint%20%7C%7C%20%22default%22%29%3B%0A%20%20%20%20if%20%28typeof%20res%20%21%3D%3D%20%22object%22%29%20return%20res%3B%0A%20%20%20%20throw%20new%20TypeError%28%22%40%40toPrimitive%20must%20return%20a%20primitive%20value.%22%29%3B%0A%20%20%7D%0A%20%20return%20%28hint%20%3D%3D%3D%20%22string%22%20%3F%20String%20%3A%20Number%29%28input%29%3B%0A%7D%0Afunction%20_toPropertyKey2%28arg%29%20%7B%0A%20%20var%20key%20%3D%20_toPrimitive2%28arg%2C%20%22string%22%29%3B%0A%20%20return%20typeof%20key%20%3D%3D%3D%20%22symbol%22%20%3F%20key%20%3A%20String%28key%29%3B%0A%7D%0Avar%20_excluded%20%3D%20%5B%22createObj%22%2C%20%22updateObj%22%2C%20%22exitObj%22%2C%20%22objBindAttr%22%2C%20%22dataBindAttr%22%5D%3B%0Afunction%20diffArrays%28prev%2C%20next%2C%20idAccessor%29%20%7B%0A%20%20var%20result%20%3D%20%7B%0A%20%20%20%20enter%3A%20%5B%5D%2C%0A%20%20%20%20update%3A%20%5B%5D%2C%0A%20%20%20%20exit%3A%20%5B%5D%0A%20%20%7D%3B%0A%20%20if%20%28%21idAccessor%29%20%7B%0A%20%20%20%20var%20prevSet%20%3D%20new%20Set%28prev%29%3B%0A%20%20%20%20var%20nextSet%20%3D%20new%20Set%28next%29%3B%0A%20%20%20%20new%20Set%28%5B%5D.concat%28_toConsumableArray2%28prevSet%29%2C%20_toConsumableArray2%28nextSet%29%29%29.forEach%28function%28item%29%20%7B%0A%20%20%20%20%20%20var%20type%20%3D%20%21prevSet.has%28item%29%20%3F%20%22enter%22%20%3A%20%21nextSet.has%28item%29%20%3F%20%22exit%22%20%3A%20%22update%22%3B%0A%20%20%20%20%20%20result%5Btype%5D.push%28type%20%3D%3D%3D%20%22update%22%20%3F%20%5Bitem%2C%20item%5D%20%3A%20item%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20prevById%20%3D%20index4%28prev%2C%20idAccessor%2C%20false%29%3B%0A%20%20%20%20var%20nextById%20%3D%20index4%28next%2C%20idAccessor%2C%20false%29%3B%0A%20%20%20%20var%20byId%20%3D%20Object.assign%28%7B%7D%2C%20prevById%2C%20nextById%29%3B%0A%20%20%20%20Object.entries%28byId%29.forEach%28function%28_ref%29%20%7B%0A%20%20%20%20%20%20var%20_ref2%20%3D%20_slicedToArray3%28_ref%2C%202%29%2C%20id2%20%3D%20_ref2%5B0%5D%2C%20item%20%3D%20_ref2%5B1%5D%3B%0A%20%20%20%20%20%20var%20type%20%3D%20%21prevById.hasOwnProperty%28id2%29%20%3F%20%22enter%22%20%3A%20%21nextById.hasOwnProperty%28id2%29%20%3F%20%22exit%22%20%3A%20%22update%22%3B%0A%20%20%20%20%20%20result%5Btype%5D.push%28type%20%3D%3D%3D%20%22update%22%20%3F%20%5BprevById%5Bid2%5D%2C%20nextById%5Bid2%5D%5D%20%3A%20item%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20return%20result%3B%0A%7D%0Afunction%20dataBindDiff%28data%2C%20existingObjs%2C%20_ref3%29%20%7B%0A%20%20var%20_ref3%24objBindAttr%20%3D%20_ref3.objBindAttr%2C%20objBindAttr%20%3D%20_ref3%24objBindAttr%20%3D%3D%3D%20void%200%20%3F%20%22__obj%22%20%3A%20_ref3%24objBindAttr%2C%20_ref3%24dataBindAttr%20%3D%20_ref3.dataBindAttr%2C%20dataBindAttr%20%3D%20_ref3%24dataBindAttr%20%3D%3D%3D%20void%200%20%3F%20%22__data%22%20%3A%20_ref3%24dataBindAttr%2C%20idAccessor%20%3D%20_ref3.idAccessor%2C%20_ref3%24purge%20%3D%20_ref3.purge%2C%20purge%20%3D%20_ref3%24purge%20%3D%3D%3D%20void%200%20%3F%20false%20%3A%20_ref3%24purge%3B%0A%20%20var%20isObjValid%20%3D%20function%20isObjValid2%28obj%29%20%7B%0A%20%20%20%20return%20obj.hasOwnProperty%28dataBindAttr%29%3B%0A%20%20%7D%3B%0A%20%20var%20removeObjs%20%3D%20existingObjs.filter%28function%28obj%29%20%7B%0A%20%20%20%20return%20%21isObjValid%28obj%29%3B%0A%20%20%7D%29%3B%0A%20%20var%20prevD%20%3D%20existingObjs.filter%28isObjValid%29.map%28function%28obj%29%20%7B%0A%20%20%20%20return%20obj%5BdataBindAttr%5D%3B%0A%20%20%7D%29%3B%0A%20%20var%20nextD%20%3D%20data%3B%0A%20%20var%20diff%20%3D%20purge%20%3F%20%7B%0A%20%20%20%20enter%3A%20nextD%2C%0A%20%20%20%20exit%3A%20prevD%2C%0A%20%20%20%20update%3A%20%5B%5D%0A%20%20%7D%20%3A%20diffArrays%28prevD%2C%20nextD%2C%20idAccessor%29%3B%0A%20%20diff.update%20%3D%20diff.update.map%28function%28_ref4%29%20%7B%0A%20%20%20%20var%20_ref5%20%3D%20_slicedToArray3%28_ref4%2C%202%29%2C%20prevD2%20%3D%20_ref5%5B0%5D%2C%20nextD2%20%3D%20_ref5%5B1%5D%3B%0A%20%20%20%20if%20%28prevD2%20%21%3D%3D%20nextD2%29%20%7B%0A%20%20%20%20%20%20nextD2%5BobjBindAttr%5D%20%3D%20prevD2%5BobjBindAttr%5D%3B%0A%20%20%20%20%20%20nextD2%5BobjBindAttr%5D%5BdataBindAttr%5D%20%3D%20nextD2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nextD2%3B%0A%20%20%7D%29%3B%0A%20%20diff.exit%20%3D%20diff.exit.concat%28removeObjs.map%28function%28obj%29%20%7B%0A%20%20%20%20return%20_defineProperty%28%7B%7D%2C%20objBindAttr%2C%20obj%29%3B%0A%20%20%7D%29%29%3B%0A%20%20return%20diff%3B%0A%7D%0Afunction%20viewDigest%28data%2C%20existingObjs%2C%20appendObj%2C%20removeObj%2C%20_ref7%29%20%7B%0A%20%20var%20_ref7%24createObj%20%3D%20_ref7.createObj%2C%20createObj%20%3D%20_ref7%24createObj%20%3D%3D%3D%20void%200%20%3F%20function%28d%29%20%7B%0A%20%20%20%20return%20%7B%7D%3B%0A%20%20%7D%20%3A%20_ref7%24createObj%2C%20_ref7%24updateObj%20%3D%20_ref7.updateObj%2C%20updateObj%20%3D%20_ref7%24updateObj%20%3D%3D%3D%20void%200%20%3F%20function%28obj%2C%20d%29%20%7B%0A%20%20%7D%20%3A%20_ref7%24updateObj%2C%20_ref7%24exitObj%20%3D%20_ref7.exitObj%2C%20exitObj%20%3D%20_ref7%24exitObj%20%3D%3D%3D%20void%200%20%3F%20function%28obj%29%20%7B%0A%20%20%7D%20%3A%20_ref7%24exitObj%2C%20_ref7%24objBindAttr%20%3D%20_ref7.objBindAttr%2C%20objBindAttr%20%3D%20_ref7%24objBindAttr%20%3D%3D%3D%20void%200%20%3F%20%22__obj%22%20%3A%20_ref7%24objBindAttr%2C%20_ref7%24dataBindAttr%20%3D%20_ref7.dataBindAttr%2C%20dataBindAttr%20%3D%20_ref7%24dataBindAttr%20%3D%3D%3D%20void%200%20%3F%20%22__data%22%20%3A%20_ref7%24dataBindAttr%2C%20dataDiffOptions%20%3D%20_objectWithoutProperties2%28_ref7%2C%20_excluded%29%3B%0A%20%20var%20_dataBindDiff%20%3D%20dataBindDiff%28data%2C%20existingObjs%2C%20_objectSpread2%28%7B%0A%20%20%20%20objBindAttr%2C%0A%20%20%20%20dataBindAttr%0A%20%20%7D%2C%20dataDiffOptions%29%29%2C%20enter%20%3D%20_dataBindDiff.enter%2C%20update4%20%3D%20_dataBindDiff.update%2C%20exit%20%3D%20_dataBindDiff.exit%3B%0A%20%20exit.forEach%28function%28d%29%20%7B%0A%20%20%20%20var%20obj%20%3D%20d%5BobjBindAttr%5D%3B%0A%20%20%20%20delete%20d%5BobjBindAttr%5D%3B%0A%20%20%20%20exitObj%28obj%29%3B%0A%20%20%20%20removeObj%28obj%29%3B%0A%20%20%7D%29%3B%0A%20%20var%20newObjs%20%3D%20createObjs%28enter%29%3B%0A%20%20var%20pointsData%20%3D%20%5B%5D.concat%28_toConsumableArray2%28enter%29%2C%20_toConsumableArray2%28update4%29%29%3B%0A%20%20updateObjs%28pointsData%29%3B%0A%20%20newObjs.forEach%28appendObj%29%3B%0A%20%20function%20createObjs%28data2%29%20%7B%0A%20%20%20%20var%20newObjs2%20%3D%20%5B%5D%3B%0A%20%20%20%20data2.forEach%28function%28d%29%20%7B%0A%20%20%20%20%20%20var%20obj%20%3D%20createObj%28d%29%3B%0A%20%20%20%20%20%20if%20%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20obj%5BdataBindAttr%5D%20%3D%20d%3B%0A%20%20%20%20%20%20%20%20d%5BobjBindAttr%5D%20%3D%20obj%3B%0A%20%20%20%20%20%20%20%20newObjs2.push%28obj%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20return%20newObjs2%3B%0A%20%20%7D%0A%20%20function%20updateObjs%28data2%29%20%7B%0A%20%20%20%20data2.forEach%28function%28d%29%20%7B%0A%20%20%20%20%20%20var%20obj%20%3D%20d%5BobjBindAttr%5D%3B%0A%20%20%20%20%20%20if%20%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20obj%5BdataBindAttr%5D%20%3D%20d%3B%0A%20%20%20%20%20%20%20%20updateObj%28obj%2C%20d%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-scale%2Fsrc%2Finit.js%0Afunction%20initRange%28domain%2C%20range%29%20%7B%0A%20%20switch%20%28arguments.length%29%20%7B%0A%20%20%20%20case%200%3A%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%201%3A%0A%20%20%20%20%20%20this.range%28domain%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20this.range%28range%29.domain%28domain%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%20%20return%20this%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-scale%2Fsrc%2Fordinal.js%0Avar%20implicit%20%3D%20Symbol%28%22implicit%22%29%3B%0Afunction%20ordinal%28%29%20%7B%0A%20%20var%20index5%20%3D%20new%20InternMap%28%29%2C%20domain%20%3D%20%5B%5D%2C%20range%20%3D%20%5B%5D%2C%20unknown%20%3D%20implicit%3B%0A%20%20function%20scale%28d%29%20%7B%0A%20%20%20%20let%20i%20%3D%20index5.get%28d%29%3B%0A%20%20%20%20if%20%28i%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28unknown%20%21%3D%3D%20implicit%29%20return%20unknown%3B%0A%20%20%20%20%20%20index5.set%28d%2C%20i%20%3D%20domain.push%28d%29%20-%201%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20range%5Bi%20%25%20range.length%5D%3B%0A%20%20%7D%0A%20%20scale.domain%20%3D%20function%28_%29%20%7B%0A%20%20%20%20if%20%28%21arguments.length%29%20return%20domain.slice%28%29%3B%0A%20%20%20%20domain%20%3D%20%5B%5D%2C%20index5%20%3D%20new%20InternMap%28%29%3B%0A%20%20%20%20for%20%28const%20value%20of%20_%29%20%7B%0A%20%20%20%20%20%20if%20%28index5.has%28value%29%29%20continue%3B%0A%20%20%20%20%20%20index5.set%28value%2C%20domain.push%28value%29%20-%201%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20scale%3B%0A%20%20%7D%3B%0A%20%20scale.range%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28range%20%3D%20Array.from%28_%29%2C%20scale%29%20%3A%20range.slice%28%29%3B%0A%20%20%7D%3B%0A%20%20scale.unknown%20%3D%20function%28_%29%20%7B%0A%20%20%20%20return%20arguments.length%20%3F%20%28unknown%20%3D%20_%2C%20scale%29%20%3A%20unknown%3B%0A%20%20%7D%3B%0A%20%20scale.copy%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20ordinal%28domain%2C%20range%29.unknown%28unknown%29%3B%0A%20%20%7D%3B%0A%20%20initRange.apply%28scale%2C%20arguments%29%3B%0A%20%20return%20scale%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-scale-chromatic%2Fsrc%2Fcolors.js%0Afunction%20colors_default%28specifier%29%20%7B%0A%20%20var%20n%20%3D%20specifier.length%20%2F%206%20%7C%200%2C%20colors%20%3D%20new%20Array%28n%29%2C%20i%20%3D%200%3B%0A%20%20while%20%28i%20%3C%20n%29%20colors%5Bi%5D%20%3D%20%22%23%22%20%2B%20specifier.slice%28i%20%2A%206%2C%20%2B%2Bi%20%2A%206%29%3B%0A%20%20return%20colors%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fd3-scale-chromatic%2Fsrc%2Fcategorical%2FPaired.js%0Avar%20Paired_default%20%3D%20colors_default%28%22a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928%22%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Ftinycolor2%2Fesm%2Ftinycolor.js%0Afunction%20_typeof%28obj%29%20%7B%0A%20%20%22%40babel%2Fhelpers%20-%20typeof%22%3B%0A%20%20return%20_typeof%20%3D%20%22function%22%20%3D%3D%20typeof%20Symbol%20%26%26%20%22symbol%22%20%3D%3D%20typeof%20Symbol.iterator%20%3F%20function%28obj2%29%20%7B%0A%20%20%20%20return%20typeof%20obj2%3B%0A%20%20%7D%20%3A%20function%28obj2%29%20%7B%0A%20%20%20%20return%20obj2%20%26%26%20%22function%22%20%3D%3D%20typeof%20Symbol%20%26%26%20obj2.constructor%20%3D%3D%3D%20Symbol%20%26%26%20obj2%20%21%3D%3D%20Symbol.prototype%20%3F%20%22symbol%22%20%3A%20typeof%20obj2%3B%0A%20%20%7D%2C%20_typeof%28obj%29%3B%0A%7D%0Avar%20trimLeft%20%3D%20%2F%5E%5Cs%2B%2F%3B%0Avar%20trimRight%20%3D%20%2F%5Cs%2B%24%2F%3B%0Afunction%20tinycolor%28color2%2C%20opts%29%20%7B%0A%20%20color2%20%3D%20color2%20%3F%20color2%20%3A%20%22%22%3B%0A%20%20opts%20%3D%20opts%20%7C%7C%20%7B%7D%3B%0A%20%20if%20%28color2%20instanceof%20tinycolor%29%20%7B%0A%20%20%20%20return%20color2%3B%0A%20%20%7D%0A%20%20if%20%28%21%28this%20instanceof%20tinycolor%29%29%20%7B%0A%20%20%20%20return%20new%20tinycolor%28color2%2C%20opts%29%3B%0A%20%20%7D%0A%20%20var%20rgb2%20%3D%20inputToRGB%28color2%29%3B%0A%20%20this._originalInput%20%3D%20color2%2C%20this._r%20%3D%20rgb2.r%2C%20this._g%20%3D%20rgb2.g%2C%20this._b%20%3D%20rgb2.b%2C%20this._a%20%3D%20rgb2.a%2C%20this._roundA%20%3D%20Math.round%28100%20%2A%20this._a%29%20%2F%20100%2C%20this._format%20%3D%20opts.format%20%7C%7C%20rgb2.format%3B%0A%20%20this._gradientType%20%3D%20opts.gradientType%3B%0A%20%20if%20%28this._r%20%3C%201%29%20this._r%20%3D%20Math.round%28this._r%29%3B%0A%20%20if%20%28this._g%20%3C%201%29%20this._g%20%3D%20Math.round%28this._g%29%3B%0A%20%20if%20%28this._b%20%3C%201%29%20this._b%20%3D%20Math.round%28this._b%29%3B%0A%20%20this._ok%20%3D%20rgb2.ok%3B%0A%7D%0Atinycolor.prototype%20%3D%20%7B%0A%20%20isDark%3A%20function%20isDark%28%29%20%7B%0A%20%20%20%20return%20this.getBrightness%28%29%20%3C%20128%3B%0A%20%20%7D%2C%0A%20%20isLight%3A%20function%20isLight%28%29%20%7B%0A%20%20%20%20return%20%21this.isDark%28%29%3B%0A%20%20%7D%2C%0A%20%20isValid%3A%20function%20isValid%28%29%20%7B%0A%20%20%20%20return%20this._ok%3B%0A%20%20%7D%2C%0A%20%20getOriginalInput%3A%20function%20getOriginalInput%28%29%20%7B%0A%20%20%20%20return%20this._originalInput%3B%0A%20%20%7D%2C%0A%20%20getFormat%3A%20function%20getFormat%28%29%20%7B%0A%20%20%20%20return%20this._format%3B%0A%20%20%7D%2C%0A%20%20getAlpha%3A%20function%20getAlpha%28%29%20%7B%0A%20%20%20%20return%20this._a%3B%0A%20%20%7D%2C%0A%20%20getBrightness%3A%20function%20getBrightness%28%29%20%7B%0A%20%20%20%20var%20rgb2%20%3D%20this.toRgb%28%29%3B%0A%20%20%20%20return%20%28rgb2.r%20%2A%20299%20%2B%20rgb2.g%20%2A%20587%20%2B%20rgb2.b%20%2A%20114%29%20%2F%201e3%3B%0A%20%20%7D%2C%0A%20%20getLuminance%3A%20function%20getLuminance%28%29%20%7B%0A%20%20%20%20var%20rgb2%20%3D%20this.toRgb%28%29%3B%0A%20%20%20%20var%20RsRGB%2C%20GsRGB%2C%20BsRGB%2C%20R%2C%20G%2C%20B%3B%0A%20%20%20%20RsRGB%20%3D%20rgb2.r%20%2F%20255%3B%0A%20%20%20%20GsRGB%20%3D%20rgb2.g%20%2F%20255%3B%0A%20%20%20%20BsRGB%20%3D%20rgb2.b%20%2F%20255%3B%0A%20%20%20%20if%20%28RsRGB%20%3C%3D%200.03928%29%20R%20%3D%20RsRGB%20%2F%2012.92%3B%0A%20%20%20%20else%20R%20%3D%20Math.pow%28%28RsRGB%20%2B%200.055%29%20%2F%201.055%2C%202.4%29%3B%0A%20%20%20%20if%20%28GsRGB%20%3C%3D%200.03928%29%20G%20%3D%20GsRGB%20%2F%2012.92%3B%0A%20%20%20%20else%20G%20%3D%20Math.pow%28%28GsRGB%20%2B%200.055%29%20%2F%201.055%2C%202.4%29%3B%0A%20%20%20%20if%20%28BsRGB%20%3C%3D%200.03928%29%20B%20%3D%20BsRGB%20%2F%2012.92%3B%0A%20%20%20%20else%20B%20%3D%20Math.pow%28%28BsRGB%20%2B%200.055%29%20%2F%201.055%2C%202.4%29%3B%0A%20%20%20%20return%200.2126%20%2A%20R%20%2B%200.7152%20%2A%20G%20%2B%200.0722%20%2A%20B%3B%0A%20%20%7D%2C%0A%20%20setAlpha%3A%20function%20setAlpha%28value%29%20%7B%0A%20%20%20%20this._a%20%3D%20boundAlpha%28value%29%3B%0A%20%20%20%20this._roundA%20%3D%20Math.round%28100%20%2A%20this._a%29%20%2F%20100%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%2C%0A%20%20toHsv%3A%20function%20toHsv%28%29%20%7B%0A%20%20%20%20var%20hsv%20%3D%20rgbToHsv%28this._r%2C%20this._g%2C%20this._b%29%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20h%3A%20hsv.h%20%2A%20360%2C%0A%20%20%20%20%20%20s%3A%20hsv.s%2C%0A%20%20%20%20%20%20v%3A%20hsv.v%2C%0A%20%20%20%20%20%20a%3A%20this._a%0A%20%20%20%20%7D%3B%0A%20%20%7D%2C%0A%20%20toHsvString%3A%20function%20toHsvString%28%29%20%7B%0A%20%20%20%20var%20hsv%20%3D%20rgbToHsv%28this._r%2C%20this._g%2C%20this._b%29%3B%0A%20%20%20%20var%20h%20%3D%20Math.round%28hsv.h%20%2A%20360%29%2C%20s%20%3D%20Math.round%28hsv.s%20%2A%20100%29%2C%20v%20%3D%20Math.round%28hsv.v%20%2A%20100%29%3B%0A%20%20%20%20return%20this._a%20%3D%3D%201%20%3F%20%22hsv%28%22%20%2B%20h%20%2B%20%22%2C%20%22%20%2B%20s%20%2B%20%22%25%2C%20%22%20%2B%20v%20%2B%20%22%25%29%22%20%3A%20%22hsva%28%22%20%2B%20h%20%2B%20%22%2C%20%22%20%2B%20s%20%2B%20%22%25%2C%20%22%20%2B%20v%20%2B%20%22%25%2C%20%22%20%2B%20this._roundA%20%2B%20%22%29%22%3B%0A%20%20%7D%2C%0A%20%20toHsl%3A%20function%20toHsl%28%29%20%7B%0A%20%20%20%20var%20hsl2%20%3D%20rgbToHsl%28this._r%2C%20this._g%2C%20this._b%29%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20h%3A%20hsl2.h%20%2A%20360%2C%0A%20%20%20%20%20%20s%3A%20hsl2.s%2C%0A%20%20%20%20%20%20l%3A%20hsl2.l%2C%0A%20%20%20%20%20%20a%3A%20this._a%0A%20%20%20%20%7D%3B%0A%20%20%7D%2C%0A%20%20toHslString%3A%20function%20toHslString%28%29%20%7B%0A%20%20%20%20var%20hsl2%20%3D%20rgbToHsl%28this._r%2C%20this._g%2C%20this._b%29%3B%0A%20%20%20%20var%20h%20%3D%20Math.round%28hsl2.h%20%2A%20360%29%2C%20s%20%3D%20Math.round%28hsl2.s%20%2A%20100%29%2C%20l%20%3D%20Math.round%28hsl2.l%20%2A%20100%29%3B%0A%20%20%20%20return%20this._a%20%3D%3D%201%20%3F%20%22hsl%28%22%20%2B%20h%20%2B%20%22%2C%20%22%20%2B%20s%20%2B%20%22%25%2C%20%22%20%2B%20l%20%2B%20%22%25%29%22%20%3A%20%22hsla%28%22%20%2B%20h%20%2B%20%22%2C%20%22%20%2B%20s%20%2B%20%22%25%2C%20%22%20%2B%20l%20%2B%20%22%25%2C%20%22%20%2B%20this._roundA%20%2B%20%22%29%22%3B%0A%20%20%7D%2C%0A%20%20toHex%3A%20function%20toHex%28allow3Char%29%20%7B%0A%20%20%20%20return%20rgbToHex%28this._r%2C%20this._g%2C%20this._b%2C%20allow3Char%29%3B%0A%20%20%7D%2C%0A%20%20toHexString%3A%20function%20toHexString%28allow3Char%29%20%7B%0A%20%20%20%20return%20%22%23%22%20%2B%20this.toHex%28allow3Char%29%3B%0A%20%20%7D%2C%0A%20%20toHex8%3A%20function%20toHex8%28allow4Char%29%20%7B%0A%20%20%20%20return%20rgbaToHex%28this._r%2C%20this._g%2C%20this._b%2C%20this._a%2C%20allow4Char%29%3B%0A%20%20%7D%2C%0A%20%20toHex8String%3A%20function%20toHex8String%28allow4Char%29%20%7B%0A%20%20%20%20return%20%22%23%22%20%2B%20this.toHex8%28allow4Char%29%3B%0A%20%20%7D%2C%0A%20%20toRgb%3A%20function%20toRgb%28%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20r%3A%20Math.round%28this._r%29%2C%0A%20%20%20%20%20%20g%3A%20Math.round%28this._g%29%2C%0A%20%20%20%20%20%20b%3A%20Math.round%28this._b%29%2C%0A%20%20%20%20%20%20a%3A%20this._a%0A%20%20%20%20%7D%3B%0A%20%20%7D%2C%0A%20%20toRgbString%3A%20function%20toRgbString%28%29%20%7B%0A%20%20%20%20return%20this._a%20%3D%3D%201%20%3F%20%22rgb%28%22%20%2B%20Math.round%28this._r%29%20%2B%20%22%2C%20%22%20%2B%20Math.round%28this._g%29%20%2B%20%22%2C%20%22%20%2B%20Math.round%28this._b%29%20%2B%20%22%29%22%20%3A%20%22rgba%28%22%20%2B%20Math.round%28this._r%29%20%2B%20%22%2C%20%22%20%2B%20Math.round%28this._g%29%20%2B%20%22%2C%20%22%20%2B%20Math.round%28this._b%29%20%2B%20%22%2C%20%22%20%2B%20this._roundA%20%2B%20%22%29%22%3B%0A%20%20%7D%2C%0A%20%20toPercentageRgb%3A%20function%20toPercentageRgb%28%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20r%3A%20Math.round%28bound01%28this._r%2C%20255%29%20%2A%20100%29%20%2B%20%22%25%22%2C%0A%20%20%20%20%20%20g%3A%20Math.round%28bound01%28this._g%2C%20255%29%20%2A%20100%29%20%2B%20%22%25%22%2C%0A%20%20%20%20%20%20b%3A%20Math.round%28bound01%28this._b%2C%20255%29%20%2A%20100%29%20%2B%20%22%25%22%2C%0A%20%20%20%20%20%20a%3A%20this._a%0A%20%20%20%20%7D%3B%0A%20%20%7D%2C%0A%20%20toPercentageRgbString%3A%20function%20toPercentageRgbString%28%29%20%7B%0A%20%20%20%20return%20this._a%20%3D%3D%201%20%3F%20%22rgb%28%22%20%2B%20Math.round%28bound01%28this._r%2C%20255%29%20%2A%20100%29%20%2B%20%22%25%2C%20%22%20%2B%20Math.round%28bound01%28this._g%2C%20255%29%20%2A%20100%29%20%2B%20%22%25%2C%20%22%20%2B%20Math.round%28bound01%28this._b%2C%20255%29%20%2A%20100%29%20%2B%20%22%25%29%22%20%3A%20%22rgba%28%22%20%2B%20Math.round%28bound01%28this._r%2C%20255%29%20%2A%20100%29%20%2B%20%22%25%2C%20%22%20%2B%20Math.round%28bound01%28this._g%2C%20255%29%20%2A%20100%29%20%2B%20%22%25%2C%20%22%20%2B%20Math.round%28bound01%28this._b%2C%20255%29%20%2A%20100%29%20%2B%20%22%25%2C%20%22%20%2B%20this._roundA%20%2B%20%22%29%22%3B%0A%20%20%7D%2C%0A%20%20toName%3A%20function%20toName%28%29%20%7B%0A%20%20%20%20if%20%28this._a%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20return%20%22transparent%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this._a%20%3C%201%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20hexNames%5BrgbToHex%28this._r%2C%20this._g%2C%20this._b%2C%20true%29%5D%20%7C%7C%20false%3B%0A%20%20%7D%2C%0A%20%20toFilter%3A%20function%20toFilter%28secondColor%29%20%7B%0A%20%20%20%20var%20hex8String%20%3D%20%22%23%22%20%2B%20rgbaToArgbHex%28this._r%2C%20this._g%2C%20this._b%2C%20this._a%29%3B%0A%20%20%20%20var%20secondHex8String%20%3D%20hex8String%3B%0A%20%20%20%20var%20gradientType%20%3D%20this._gradientType%20%3F%20%22GradientType%20%3D%201%2C%20%22%20%3A%20%22%22%3B%0A%20%20%20%20if%20%28secondColor%29%20%7B%0A%20%20%20%20%20%20var%20s%20%3D%20tinycolor%28secondColor%29%3B%0A%20%20%20%20%20%20secondHex8String%20%3D%20%22%23%22%20%2B%20rgbaToArgbHex%28s._r%2C%20s._g%2C%20s._b%2C%20s._a%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%22progid%3ADXImageTransform.Microsoft.gradient%28%22%20%2B%20gradientType%20%2B%20%22startColorstr%3D%22%20%2B%20hex8String%20%2B%20%22%2CendColorstr%3D%22%20%2B%20secondHex8String%20%2B%20%22%29%22%3B%0A%20%20%7D%2C%0A%20%20toString%3A%20function%20toString%28format2%29%20%7B%0A%20%20%20%20var%20formatSet%20%3D%20%21%21format2%3B%0A%20%20%20%20format2%20%3D%20format2%20%7C%7C%20this._format%3B%0A%20%20%20%20var%20formattedString%20%3D%20false%3B%0A%20%20%20%20var%20hasAlpha%20%3D%20this._a%20%3C%201%20%26%26%20this._a%20%3E%3D%200%3B%0A%20%20%20%20var%20needsAlphaFormat%20%3D%20%21formatSet%20%26%26%20hasAlpha%20%26%26%20%28format2%20%3D%3D%3D%20%22hex%22%20%7C%7C%20format2%20%3D%3D%3D%20%22hex6%22%20%7C%7C%20format2%20%3D%3D%3D%20%22hex3%22%20%7C%7C%20format2%20%3D%3D%3D%20%22hex4%22%20%7C%7C%20format2%20%3D%3D%3D%20%22hex8%22%20%7C%7C%20format2%20%3D%3D%3D%20%22name%22%29%3B%0A%20%20%20%20if%20%28needsAlphaFormat%29%20%7B%0A%20%20%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22name%22%20%26%26%20this._a%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this.toName%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this.toRgbString%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22rgb%22%29%20%7B%0A%20%20%20%20%20%20formattedString%20%3D%20this.toRgbString%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22prgb%22%29%20%7B%0A%20%20%20%20%20%20formattedString%20%3D%20this.toPercentageRgbString%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22hex%22%20%7C%7C%20format2%20%3D%3D%3D%20%22hex6%22%29%20%7B%0A%20%20%20%20%20%20formattedString%20%3D%20this.toHexString%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22hex3%22%29%20%7B%0A%20%20%20%20%20%20formattedString%20%3D%20this.toHexString%28true%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22hex4%22%29%20%7B%0A%20%20%20%20%20%20formattedString%20%3D%20this.toHex8String%28true%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22hex8%22%29%20%7B%0A%20%20%20%20%20%20formattedString%20%3D%20this.toHex8String%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22name%22%29%20%7B%0A%20%20%20%20%20%20formattedString%20%3D%20this.toName%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22hsl%22%29%20%7B%0A%20%20%20%20%20%20formattedString%20%3D%20this.toHslString%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20%22hsv%22%29%20%7B%0A%20%20%20%20%20%20formattedString%20%3D%20this.toHsvString%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20formattedString%20%7C%7C%20this.toHexString%28%29%3B%0A%20%20%7D%2C%0A%20%20clone%3A%20function%20clone%28%29%20%7B%0A%20%20%20%20return%20tinycolor%28this.toString%28%29%29%3B%0A%20%20%7D%2C%0A%20%20_applyModification%3A%20function%20_applyModification%28fn%2C%20args%29%20%7B%0A%20%20%20%20var%20color2%20%3D%20fn.apply%28null%2C%20%5Bthis%5D.concat%28%5B%5D.slice.call%28args%29%29%29%3B%0A%20%20%20%20this._r%20%3D%20color2._r%3B%0A%20%20%20%20this._g%20%3D%20color2._g%3B%0A%20%20%20%20this._b%20%3D%20color2._b%3B%0A%20%20%20%20this.setAlpha%28color2._a%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%2C%0A%20%20lighten%3A%20function%20lighten%28%29%20%7B%0A%20%20%20%20return%20this._applyModification%28_lighten%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20brighten%3A%20function%20brighten%28%29%20%7B%0A%20%20%20%20return%20this._applyModification%28_brighten%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20darken%3A%20function%20darken%28%29%20%7B%0A%20%20%20%20return%20this._applyModification%28_darken%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20desaturate%3A%20function%20desaturate%28%29%20%7B%0A%20%20%20%20return%20this._applyModification%28_desaturate%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20saturate%3A%20function%20saturate%28%29%20%7B%0A%20%20%20%20return%20this._applyModification%28_saturate%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20greyscale%3A%20function%20greyscale%28%29%20%7B%0A%20%20%20%20return%20this._applyModification%28_greyscale%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20spin%3A%20function%20spin%28%29%20%7B%0A%20%20%20%20return%20this._applyModification%28_spin%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20_applyCombination%3A%20function%20_applyCombination%28fn%2C%20args%29%20%7B%0A%20%20%20%20return%20fn.apply%28null%2C%20%5Bthis%5D.concat%28%5B%5D.slice.call%28args%29%29%29%3B%0A%20%20%7D%2C%0A%20%20analogous%3A%20function%20analogous%28%29%20%7B%0A%20%20%20%20return%20this._applyCombination%28_analogous%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20complement%3A%20function%20complement%28%29%20%7B%0A%20%20%20%20return%20this._applyCombination%28_complement%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20monochromatic%3A%20function%20monochromatic%28%29%20%7B%0A%20%20%20%20return%20this._applyCombination%28_monochromatic%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20splitcomplement%3A%20function%20splitcomplement%28%29%20%7B%0A%20%20%20%20return%20this._applyCombination%28_splitcomplement%2C%20arguments%29%3B%0A%20%20%7D%2C%0A%20%20%2F%2F%20Disabled%20until%20https%3A%2F%2Fgithub.com%2Fbgrins%2FTinyColor%2Fissues%2F254%0A%20%20%2F%2F%20polyad%3A%20function%20%28number%29%20%7B%0A%20%20%2F%2F%20%20%20return%20this._applyCombination%28polyad%2C%20%5Bnumber%5D%29%3B%0A%20%20%2F%2F%20%7D%2C%0A%20%20triad%3A%20function%20triad%28%29%20%7B%0A%20%20%20%20return%20this._applyCombination%28polyad%2C%20%5B3%5D%29%3B%0A%20%20%7D%2C%0A%20%20tetrad%3A%20function%20tetrad%28%29%20%7B%0A%20%20%20%20return%20this._applyCombination%28polyad%2C%20%5B4%5D%29%3B%0A%20%20%7D%0A%7D%3B%0Atinycolor.fromRatio%20%3D%20function%28color2%2C%20opts%29%20%7B%0A%20%20if%20%28_typeof%28color2%29%20%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20var%20newColor%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28var%20i%20in%20color2%29%20%7B%0A%20%20%20%20%20%20if%20%28color2.hasOwnProperty%28i%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28i%20%3D%3D%3D%20%22a%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20newColor%5Bi%5D%20%3D%20color2%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20newColor%5Bi%5D%20%3D%20convertToPercentage%28color2%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20color2%20%3D%20newColor%3B%0A%20%20%7D%0A%20%20return%20tinycolor%28color2%2C%20opts%29%3B%0A%7D%3B%0Afunction%20inputToRGB%28color2%29%20%7B%0A%20%20var%20rgb2%20%3D%20%7B%0A%20%20%20%20r%3A%200%2C%0A%20%20%20%20g%3A%200%2C%0A%20%20%20%20b%3A%200%0A%20%20%7D%3B%0A%20%20var%20a2%20%3D%201%3B%0A%20%20var%20s%20%3D%20null%3B%0A%20%20var%20v%20%3D%20null%3B%0A%20%20var%20l%20%3D%20null%3B%0A%20%20var%20ok%20%3D%20false%3B%0A%20%20var%20format2%20%3D%20false%3B%0A%20%20if%20%28typeof%20color2%20%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20color2%20%3D%20stringInputToObject%28color2%29%3B%0A%20%20%7D%0A%20%20if%20%28_typeof%28color2%29%20%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20if%20%28isValidCSSUnit%28color2.r%29%20%26%26%20isValidCSSUnit%28color2.g%29%20%26%26%20isValidCSSUnit%28color2.b%29%29%20%7B%0A%20%20%20%20%20%20rgb2%20%3D%20rgbToRgb%28color2.r%2C%20color2.g%2C%20color2.b%29%3B%0A%20%20%20%20%20%20ok%20%3D%20true%3B%0A%20%20%20%20%20%20format2%20%3D%20String%28color2.r%29.substr%28-1%29%20%3D%3D%3D%20%22%25%22%20%3F%20%22prgb%22%20%3A%20%22rgb%22%3B%0A%20%20%20%20%7D%20else%20if%20%28isValidCSSUnit%28color2.h%29%20%26%26%20isValidCSSUnit%28color2.s%29%20%26%26%20isValidCSSUnit%28color2.v%29%29%20%7B%0A%20%20%20%20%20%20s%20%3D%20convertToPercentage%28color2.s%29%3B%0A%20%20%20%20%20%20v%20%3D%20convertToPercentage%28color2.v%29%3B%0A%20%20%20%20%20%20rgb2%20%3D%20hsvToRgb%28color2.h%2C%20s%2C%20v%29%3B%0A%20%20%20%20%20%20ok%20%3D%20true%3B%0A%20%20%20%20%20%20format2%20%3D%20%22hsv%22%3B%0A%20%20%20%20%7D%20else%20if%20%28isValidCSSUnit%28color2.h%29%20%26%26%20isValidCSSUnit%28color2.s%29%20%26%26%20isValidCSSUnit%28color2.l%29%29%20%7B%0A%20%20%20%20%20%20s%20%3D%20convertToPercentage%28color2.s%29%3B%0A%20%20%20%20%20%20l%20%3D%20convertToPercentage%28color2.l%29%3B%0A%20%20%20%20%20%20rgb2%20%3D%20hslToRgb%28color2.h%2C%20s%2C%20l%29%3B%0A%20%20%20%20%20%20ok%20%3D%20true%3B%0A%20%20%20%20%20%20format2%20%3D%20%22hsl%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28color2.hasOwnProperty%28%22a%22%29%29%20%7B%0A%20%20%20%20%20%20a2%20%3D%20color2.a%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20a2%20%3D%20boundAlpha%28a2%29%3B%0A%20%20return%20%7B%0A%20%20%20%20ok%2C%0A%20%20%20%20format%3A%20color2.format%20%7C%7C%20format2%2C%0A%20%20%20%20r%3A%20Math.min%28255%2C%20Math.max%28rgb2.r%2C%200%29%29%2C%0A%20%20%20%20g%3A%20Math.min%28255%2C%20Math.max%28rgb2.g%2C%200%29%29%2C%0A%20%20%20%20b%3A%20Math.min%28255%2C%20Math.max%28rgb2.b%2C%200%29%29%2C%0A%20%20%20%20a%3A%20a2%0A%20%20%7D%3B%0A%7D%0Afunction%20rgbToRgb%28r%2C%20g%2C%20b%29%20%7B%0A%20%20return%20%7B%0A%20%20%20%20r%3A%20bound01%28r%2C%20255%29%20%2A%20255%2C%0A%20%20%20%20g%3A%20bound01%28g%2C%20255%29%20%2A%20255%2C%0A%20%20%20%20b%3A%20bound01%28b%2C%20255%29%20%2A%20255%0A%20%20%7D%3B%0A%7D%0Afunction%20rgbToHsl%28r%2C%20g%2C%20b%29%20%7B%0A%20%20r%20%3D%20bound01%28r%2C%20255%29%3B%0A%20%20g%20%3D%20bound01%28g%2C%20255%29%3B%0A%20%20b%20%3D%20bound01%28b%2C%20255%29%3B%0A%20%20var%20max2%20%3D%20Math.max%28r%2C%20g%2C%20b%29%2C%20min2%20%3D%20Math.min%28r%2C%20g%2C%20b%29%3B%0A%20%20var%20h%2C%20s%2C%20l%20%3D%20%28max2%20%2B%20min2%29%20%2F%202%3B%0A%20%20if%20%28max2%20%3D%3D%20min2%29%20%7B%0A%20%20%20%20h%20%3D%20s%20%3D%200%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20d%20%3D%20max2%20-%20min2%3B%0A%20%20%20%20s%20%3D%20l%20%3E%200.5%20%3F%20d%20%2F%20%282%20-%20max2%20-%20min2%29%20%3A%20d%20%2F%20%28max2%20%2B%20min2%29%3B%0A%20%20%20%20switch%20%28max2%29%20%7B%0A%20%20%20%20%20%20case%20r%3A%0A%20%20%20%20%20%20%20%20h%20%3D%20%28g%20-%20b%29%20%2F%20d%20%2B%20%28g%20%3C%20b%20%3F%206%20%3A%200%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20g%3A%0A%20%20%20%20%20%20%20%20h%20%3D%20%28b%20-%20r%29%20%2F%20d%20%2B%202%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20b%3A%0A%20%20%20%20%20%20%20%20h%20%3D%20%28r%20-%20g%29%20%2F%20d%20%2B%204%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20h%20%2F%3D%206%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20h%2C%0A%20%20%20%20s%2C%0A%20%20%20%20l%0A%20%20%7D%3B%0A%7D%0Afunction%20hslToRgb%28h%2C%20s%2C%20l%29%20%7B%0A%20%20var%20r%2C%20g%2C%20b%3B%0A%20%20h%20%3D%20bound01%28h%2C%20360%29%3B%0A%20%20s%20%3D%20bound01%28s%2C%20100%29%3B%0A%20%20l%20%3D%20bound01%28l%2C%20100%29%3B%0A%20%20function%20hue2rgb3%28p2%2C%20q2%2C%20t%29%20%7B%0A%20%20%20%20if%20%28t%20%3C%200%29%20t%20%2B%3D%201%3B%0A%20%20%20%20if%20%28t%20%3E%201%29%20t%20-%3D%201%3B%0A%20%20%20%20if%20%28t%20%3C%201%20%2F%206%29%20return%20p2%20%2B%20%28q2%20-%20p2%29%20%2A%206%20%2A%20t%3B%0A%20%20%20%20if%20%28t%20%3C%201%20%2F%202%29%20return%20q2%3B%0A%20%20%20%20if%20%28t%20%3C%202%20%2F%203%29%20return%20p2%20%2B%20%28q2%20-%20p2%29%20%2A%20%282%20%2F%203%20-%20t%29%20%2A%206%3B%0A%20%20%20%20return%20p2%3B%0A%20%20%7D%0A%20%20if%20%28s%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20r%20%3D%20g%20%3D%20b%20%3D%20l%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20var%20q%20%3D%20l%20%3C%200.5%20%3F%20l%20%2A%20%281%20%2B%20s%29%20%3A%20l%20%2B%20s%20-%20l%20%2A%20s%3B%0A%20%20%20%20var%20p%20%3D%202%20%2A%20l%20-%20q%3B%0A%20%20%20%20r%20%3D%20hue2rgb3%28p%2C%20q%2C%20h%20%2B%201%20%2F%203%29%3B%0A%20%20%20%20g%20%3D%20hue2rgb3%28p%2C%20q%2C%20h%29%3B%0A%20%20%20%20b%20%3D%20hue2rgb3%28p%2C%20q%2C%20h%20-%201%20%2F%203%29%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20r%3A%20r%20%2A%20255%2C%0A%20%20%20%20g%3A%20g%20%2A%20255%2C%0A%20%20%20%20b%3A%20b%20%2A%20255%0A%20%20%7D%3B%0A%7D%0Afunction%20rgbToHsv%28r%2C%20g%2C%20b%29%20%7B%0A%20%20r%20%3D%20bound01%28r%2C%20255%29%3B%0A%20%20g%20%3D%20bound01%28g%2C%20255%29%3B%0A%20%20b%20%3D%20bound01%28b%2C%20255%29%3B%0A%20%20var%20max2%20%3D%20Math.max%28r%2C%20g%2C%20b%29%2C%20min2%20%3D%20Math.min%28r%2C%20g%2C%20b%29%3B%0A%20%20var%20h%2C%20s%2C%20v%20%3D%20max2%3B%0A%20%20var%20d%20%3D%20max2%20-%20min2%3B%0A%20%20s%20%3D%20max2%20%3D%3D%3D%200%20%3F%200%20%3A%20d%20%2F%20max2%3B%0A%20%20if%20%28max2%20%3D%3D%20min2%29%20%7B%0A%20%20%20%20h%20%3D%200%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20switch%20%28max2%29%20%7B%0A%20%20%20%20%20%20case%20r%3A%0A%20%20%20%20%20%20%20%20h%20%3D%20%28g%20-%20b%29%20%2F%20d%20%2B%20%28g%20%3C%20b%20%3F%206%20%3A%200%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20g%3A%0A%20%20%20%20%20%20%20%20h%20%3D%20%28b%20-%20r%29%20%2F%20d%20%2B%202%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20b%3A%0A%20%20%20%20%20%20%20%20h%20%3D%20%28r%20-%20g%29%20%2F%20d%20%2B%204%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20h%20%2F%3D%206%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20h%2C%0A%20%20%20%20s%2C%0A%20%20%20%20v%0A%20%20%7D%3B%0A%7D%0Afunction%20hsvToRgb%28h%2C%20s%2C%20v%29%20%7B%0A%20%20h%20%3D%20bound01%28h%2C%20360%29%20%2A%206%3B%0A%20%20s%20%3D%20bound01%28s%2C%20100%29%3B%0A%20%20v%20%3D%20bound01%28v%2C%20100%29%3B%0A%20%20var%20i%20%3D%20Math.floor%28h%29%2C%20f%20%3D%20h%20-%20i%2C%20p%20%3D%20v%20%2A%20%281%20-%20s%29%2C%20q%20%3D%20v%20%2A%20%281%20-%20f%20%2A%20s%29%2C%20t%20%3D%20v%20%2A%20%281%20-%20%281%20-%20f%29%20%2A%20s%29%2C%20mod2%20%3D%20i%20%25%206%2C%20r%20%3D%20%5Bv%2C%20q%2C%20p%2C%20p%2C%20t%2C%20v%5D%5Bmod2%5D%2C%20g%20%3D%20%5Bt%2C%20v%2C%20v%2C%20q%2C%20p%2C%20p%5D%5Bmod2%5D%2C%20b%20%3D%20%5Bp%2C%20p%2C%20t%2C%20v%2C%20v%2C%20q%5D%5Bmod2%5D%3B%0A%20%20return%20%7B%0A%20%20%20%20r%3A%20r%20%2A%20255%2C%0A%20%20%20%20g%3A%20g%20%2A%20255%2C%0A%20%20%20%20b%3A%20b%20%2A%20255%0A%20%20%7D%3B%0A%7D%0Afunction%20rgbToHex%28r%2C%20g%2C%20b%2C%20allow3Char%29%20%7B%0A%20%20var%20hex%20%3D%20%5Bpad2%28Math.round%28r%29.toString%2816%29%29%2C%20pad2%28Math.round%28g%29.toString%2816%29%29%2C%20pad2%28Math.round%28b%29.toString%2816%29%29%5D%3B%0A%20%20if%20%28allow3Char%20%26%26%20hex%5B0%5D.charAt%280%29%20%3D%3D%20hex%5B0%5D.charAt%281%29%20%26%26%20hex%5B1%5D.charAt%280%29%20%3D%3D%20hex%5B1%5D.charAt%281%29%20%26%26%20hex%5B2%5D.charAt%280%29%20%3D%3D%20hex%5B2%5D.charAt%281%29%29%20%7B%0A%20%20%20%20return%20hex%5B0%5D.charAt%280%29%20%2B%20hex%5B1%5D.charAt%280%29%20%2B%20hex%5B2%5D.charAt%280%29%3B%0A%20%20%7D%0A%20%20return%20hex.join%28%22%22%29%3B%0A%7D%0Afunction%20rgbaToHex%28r%2C%20g%2C%20b%2C%20a2%2C%20allow4Char%29%20%7B%0A%20%20var%20hex%20%3D%20%5Bpad2%28Math.round%28r%29.toString%2816%29%29%2C%20pad2%28Math.round%28g%29.toString%2816%29%29%2C%20pad2%28Math.round%28b%29.toString%2816%29%29%2C%20pad2%28convertDecimalToHex%28a2%29%29%5D%3B%0A%20%20if%20%28allow4Char%20%26%26%20hex%5B0%5D.charAt%280%29%20%3D%3D%20hex%5B0%5D.charAt%281%29%20%26%26%20hex%5B1%5D.charAt%280%29%20%3D%3D%20hex%5B1%5D.charAt%281%29%20%26%26%20hex%5B2%5D.charAt%280%29%20%3D%3D%20hex%5B2%5D.charAt%281%29%20%26%26%20hex%5B3%5D.charAt%280%29%20%3D%3D%20hex%5B3%5D.charAt%281%29%29%20%7B%0A%20%20%20%20return%20hex%5B0%5D.charAt%280%29%20%2B%20hex%5B1%5D.charAt%280%29%20%2B%20hex%5B2%5D.charAt%280%29%20%2B%20hex%5B3%5D.charAt%280%29%3B%0A%20%20%7D%0A%20%20return%20hex.join%28%22%22%29%3B%0A%7D%0Afunction%20rgbaToArgbHex%28r%2C%20g%2C%20b%2C%20a2%29%20%7B%0A%20%20var%20hex%20%3D%20%5Bpad2%28convertDecimalToHex%28a2%29%29%2C%20pad2%28Math.round%28r%29.toString%2816%29%29%2C%20pad2%28Math.round%28g%29.toString%2816%29%29%2C%20pad2%28Math.round%28b%29.toString%2816%29%29%5D%3B%0A%20%20return%20hex.join%28%22%22%29%3B%0A%7D%0Atinycolor.equals%20%3D%20function%28color1%2C%20color2%29%20%7B%0A%20%20if%20%28%21color1%20%7C%7C%20%21color2%29%20return%20false%3B%0A%20%20return%20tinycolor%28color1%29.toRgbString%28%29%20%3D%3D%20tinycolor%28color2%29.toRgbString%28%29%3B%0A%7D%3B%0Atinycolor.random%20%3D%20function%28%29%20%7B%0A%20%20return%20tinycolor.fromRatio%28%7B%0A%20%20%20%20r%3A%20Math.random%28%29%2C%0A%20%20%20%20g%3A%20Math.random%28%29%2C%0A%20%20%20%20b%3A%20Math.random%28%29%0A%20%20%7D%29%3B%0A%7D%3B%0Afunction%20_desaturate%28color2%2C%20amount%29%20%7B%0A%20%20amount%20%3D%20amount%20%3D%3D%3D%200%20%3F%200%20%3A%20amount%20%7C%7C%2010%3B%0A%20%20var%20hsl2%20%3D%20tinycolor%28color2%29.toHsl%28%29%3B%0A%20%20hsl2.s%20-%3D%20amount%20%2F%20100%3B%0A%20%20hsl2.s%20%3D%20clamp01%28hsl2.s%29%3B%0A%20%20return%20tinycolor%28hsl2%29%3B%0A%7D%0Afunction%20_saturate%28color2%2C%20amount%29%20%7B%0A%20%20amount%20%3D%20amount%20%3D%3D%3D%200%20%3F%200%20%3A%20amount%20%7C%7C%2010%3B%0A%20%20var%20hsl2%20%3D%20tinycolor%28color2%29.toHsl%28%29%3B%0A%20%20hsl2.s%20%2B%3D%20amount%20%2F%20100%3B%0A%20%20hsl2.s%20%3D%20clamp01%28hsl2.s%29%3B%0A%20%20return%20tinycolor%28hsl2%29%3B%0A%7D%0Afunction%20_greyscale%28color2%29%20%7B%0A%20%20return%20tinycolor%28color2%29.desaturate%28100%29%3B%0A%7D%0Afunction%20_lighten%28color2%2C%20amount%29%20%7B%0A%20%20amount%20%3D%20amount%20%3D%3D%3D%200%20%3F%200%20%3A%20amount%20%7C%7C%2010%3B%0A%20%20var%20hsl2%20%3D%20tinycolor%28color2%29.toHsl%28%29%3B%0A%20%20hsl2.l%20%2B%3D%20amount%20%2F%20100%3B%0A%20%20hsl2.l%20%3D%20clamp01%28hsl2.l%29%3B%0A%20%20return%20tinycolor%28hsl2%29%3B%0A%7D%0Afunction%20_brighten%28color2%2C%20amount%29%20%7B%0A%20%20amount%20%3D%20amount%20%3D%3D%3D%200%20%3F%200%20%3A%20amount%20%7C%7C%2010%3B%0A%20%20var%20rgb2%20%3D%20tinycolor%28color2%29.toRgb%28%29%3B%0A%20%20rgb2.r%20%3D%20Math.max%280%2C%20Math.min%28255%2C%20rgb2.r%20-%20Math.round%28255%20%2A%20-%28amount%20%2F%20100%29%29%29%29%3B%0A%20%20rgb2.g%20%3D%20Math.max%280%2C%20Math.min%28255%2C%20rgb2.g%20-%20Math.round%28255%20%2A%20-%28amount%20%2F%20100%29%29%29%29%3B%0A%20%20rgb2.b%20%3D%20Math.max%280%2C%20Math.min%28255%2C%20rgb2.b%20-%20Math.round%28255%20%2A%20-%28amount%20%2F%20100%29%29%29%29%3B%0A%20%20return%20tinycolor%28rgb2%29%3B%0A%7D%0Afunction%20_darken%28color2%2C%20amount%29%20%7B%0A%20%20amount%20%3D%20amount%20%3D%3D%3D%200%20%3F%200%20%3A%20amount%20%7C%7C%2010%3B%0A%20%20var%20hsl2%20%3D%20tinycolor%28color2%29.toHsl%28%29%3B%0A%20%20hsl2.l%20-%3D%20amount%20%2F%20100%3B%0A%20%20hsl2.l%20%3D%20clamp01%28hsl2.l%29%3B%0A%20%20return%20tinycolor%28hsl2%29%3B%0A%7D%0Afunction%20_spin%28color2%2C%20amount%29%20%7B%0A%20%20var%20hsl2%20%3D%20tinycolor%28color2%29.toHsl%28%29%3B%0A%20%20var%20hue%20%3D%20%28hsl2.h%20%2B%20amount%29%20%25%20360%3B%0A%20%20hsl2.h%20%3D%20hue%20%3C%200%20%3F%20360%20%2B%20hue%20%3A%20hue%3B%0A%20%20return%20tinycolor%28hsl2%29%3B%0A%7D%0Afunction%20_complement%28color2%29%20%7B%0A%20%20var%20hsl2%20%3D%20tinycolor%28color2%29.toHsl%28%29%3B%0A%20%20hsl2.h%20%3D%20%28hsl2.h%20%2B%20180%29%20%25%20360%3B%0A%20%20return%20tinycolor%28hsl2%29%3B%0A%7D%0Afunction%20polyad%28color2%2C%20number%29%20%7B%0A%20%20if%20%28isNaN%28number%29%20%7C%7C%20number%20%3C%3D%200%29%20%7B%0A%20%20%20%20throw%20new%20Error%28%22Argument%20to%20polyad%20must%20be%20a%20positive%20number%22%29%3B%0A%20%20%7D%0A%20%20var%20hsl2%20%3D%20tinycolor%28color2%29.toHsl%28%29%3B%0A%20%20var%20result%20%3D%20%5Btinycolor%28color2%29%5D%3B%0A%20%20var%20step2%20%3D%20360%20%2F%20number%3B%0A%20%20for%20%28var%20i%20%3D%201%3B%20i%20%3C%20number%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20result.push%28tinycolor%28%7B%0A%20%20%20%20%20%20h%3A%20%28hsl2.h%20%2B%20i%20%2A%20step2%29%20%25%20360%2C%0A%20%20%20%20%20%20s%3A%20hsl2.s%2C%0A%20%20%20%20%20%20l%3A%20hsl2.l%0A%20%20%20%20%7D%29%29%3B%0A%20%20%7D%0A%20%20return%20result%3B%0A%7D%0Afunction%20_splitcomplement%28color2%29%20%7B%0A%20%20var%20hsl2%20%3D%20tinycolor%28color2%29.toHsl%28%29%3B%0A%20%20var%20h%20%3D%20hsl2.h%3B%0A%20%20return%20%5Btinycolor%28color2%29%2C%20tinycolor%28%7B%0A%20%20%20%20h%3A%20%28h%20%2B%2072%29%20%25%20360%2C%0A%20%20%20%20s%3A%20hsl2.s%2C%0A%20%20%20%20l%3A%20hsl2.l%0A%20%20%7D%29%2C%20tinycolor%28%7B%0A%20%20%20%20h%3A%20%28h%20%2B%20216%29%20%25%20360%2C%0A%20%20%20%20s%3A%20hsl2.s%2C%0A%20%20%20%20l%3A%20hsl2.l%0A%20%20%7D%29%5D%3B%0A%7D%0Afunction%20_analogous%28color2%2C%20results%2C%20slices%29%20%7B%0A%20%20results%20%3D%20results%20%7C%7C%206%3B%0A%20%20slices%20%3D%20slices%20%7C%7C%2030%3B%0A%20%20var%20hsl2%20%3D%20tinycolor%28color2%29.toHsl%28%29%3B%0A%20%20var%20part%20%3D%20360%20%2F%20slices%3B%0A%20%20var%20ret%20%3D%20%5Btinycolor%28color2%29%5D%3B%0A%20%20for%20%28hsl2.h%20%3D%20%28hsl2.h%20-%20%28part%20%2A%20results%20%3E%3E%201%29%20%2B%20720%29%20%25%20360%3B%20--results%3B%20%29%20%7B%0A%20%20%20%20hsl2.h%20%3D%20%28hsl2.h%20%2B%20part%29%20%25%20360%3B%0A%20%20%20%20ret.push%28tinycolor%28hsl2%29%29%3B%0A%20%20%7D%0A%20%20return%20ret%3B%0A%7D%0Afunction%20_monochromatic%28color2%2C%20results%29%20%7B%0A%20%20results%20%3D%20results%20%7C%7C%206%3B%0A%20%20var%20hsv%20%3D%20tinycolor%28color2%29.toHsv%28%29%3B%0A%20%20var%20h%20%3D%20hsv.h%2C%20s%20%3D%20hsv.s%2C%20v%20%3D%20hsv.v%3B%0A%20%20var%20ret%20%3D%20%5B%5D%3B%0A%20%20var%20modification%20%3D%201%20%2F%20results%3B%0A%20%20while%20%28results--%29%20%7B%0A%20%20%20%20ret.push%28tinycolor%28%7B%0A%20%20%20%20%20%20h%2C%0A%20%20%20%20%20%20s%2C%0A%20%20%20%20%20%20v%0A%20%20%20%20%7D%29%29%3B%0A%20%20%20%20v%20%3D%20%28v%20%2B%20modification%29%20%25%201%3B%0A%20%20%7D%0A%20%20return%20ret%3B%0A%7D%0Atinycolor.mix%20%3D%20function%28color1%2C%20color2%2C%20amount%29%20%7B%0A%20%20amount%20%3D%20amount%20%3D%3D%3D%200%20%3F%200%20%3A%20amount%20%7C%7C%2050%3B%0A%20%20var%20rgb1%20%3D%20tinycolor%28color1%29.toRgb%28%29%3B%0A%20%20var%20rgb2%20%3D%20tinycolor%28color2%29.toRgb%28%29%3B%0A%20%20var%20p%20%3D%20amount%20%2F%20100%3B%0A%20%20var%20rgba2%20%3D%20%7B%0A%20%20%20%20r%3A%20%28rgb2.r%20-%20rgb1.r%29%20%2A%20p%20%2B%20rgb1.r%2C%0A%20%20%20%20g%3A%20%28rgb2.g%20-%20rgb1.g%29%20%2A%20p%20%2B%20rgb1.g%2C%0A%20%20%20%20b%3A%20%28rgb2.b%20-%20rgb1.b%29%20%2A%20p%20%2B%20rgb1.b%2C%0A%20%20%20%20a%3A%20%28rgb2.a%20-%20rgb1.a%29%20%2A%20p%20%2B%20rgb1.a%0A%20%20%7D%3B%0A%20%20return%20tinycolor%28rgba2%29%3B%0A%7D%3B%0Atinycolor.readability%20%3D%20function%28color1%2C%20color2%29%20%7B%0A%20%20var%20c1%20%3D%20tinycolor%28color1%29%3B%0A%20%20var%20c2%20%3D%20tinycolor%28color2%29%3B%0A%20%20return%20%28Math.max%28c1.getLuminance%28%29%2C%20c2.getLuminance%28%29%29%20%2B%200.05%29%20%2F%20%28Math.min%28c1.getLuminance%28%29%2C%20c2.getLuminance%28%29%29%20%2B%200.05%29%3B%0A%7D%3B%0Atinycolor.isReadable%20%3D%20function%28color1%2C%20color2%2C%20wcag2%29%20%7B%0A%20%20var%20readability%20%3D%20tinycolor.readability%28color1%2C%20color2%29%3B%0A%20%20var%20wcag2Parms%2C%20out%3B%0A%20%20out%20%3D%20false%3B%0A%20%20wcag2Parms%20%3D%20validateWCAG2Parms%28wcag2%29%3B%0A%20%20switch%20%28wcag2Parms.level%20%2B%20wcag2Parms.size%29%20%7B%0A%20%20%20%20case%20%22AAsmall%22%3A%0A%20%20%20%20case%20%22AAAlarge%22%3A%0A%20%20%20%20%20%20out%20%3D%20readability%20%3E%3D%204.5%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22AAlarge%22%3A%0A%20%20%20%20%20%20out%20%3D%20readability%20%3E%3D%203%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22AAAsmall%22%3A%0A%20%20%20%20%20%20out%20%3D%20readability%20%3E%3D%207%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%20%20return%20out%3B%0A%7D%3B%0Atinycolor.mostReadable%20%3D%20function%28baseColor%2C%20colorList%2C%20args%29%20%7B%0A%20%20var%20bestColor%20%3D%20null%3B%0A%20%20var%20bestScore%20%3D%200%3B%0A%20%20var%20readability%3B%0A%20%20var%20includeFallbackColors%2C%20level%2C%20size%3B%0A%20%20args%20%3D%20args%20%7C%7C%20%7B%7D%3B%0A%20%20includeFallbackColors%20%3D%20args.includeFallbackColors%3B%0A%20%20level%20%3D%20args.level%3B%0A%20%20size%20%3D%20args.size%3B%0A%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20colorList.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20readability%20%3D%20tinycolor.readability%28baseColor%2C%20colorList%5Bi%5D%29%3B%0A%20%20%20%20if%20%28readability%20%3E%20bestScore%29%20%7B%0A%20%20%20%20%20%20bestScore%20%3D%20readability%3B%0A%20%20%20%20%20%20bestColor%20%3D%20tinycolor%28colorList%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20%28tinycolor.isReadable%28baseColor%2C%20bestColor%2C%20%7B%0A%20%20%20%20level%2C%0A%20%20%20%20size%0A%20%20%7D%29%20%7C%7C%20%21includeFallbackColors%29%20%7B%0A%20%20%20%20return%20bestColor%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20args.includeFallbackColors%20%3D%20false%3B%0A%20%20%20%20return%20tinycolor.mostReadable%28baseColor%2C%20%5B%22%23fff%22%2C%20%22%23000%22%5D%2C%20args%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20names%20%3D%20tinycolor.names%20%3D%20%7B%0A%20%20aliceblue%3A%20%22f0f8ff%22%2C%0A%20%20antiquewhite%3A%20%22faebd7%22%2C%0A%20%20aqua%3A%20%220ff%22%2C%0A%20%20aquamarine%3A%20%227fffd4%22%2C%0A%20%20azure%3A%20%22f0ffff%22%2C%0A%20%20beige%3A%20%22f5f5dc%22%2C%0A%20%20bisque%3A%20%22ffe4c4%22%2C%0A%20%20black%3A%20%22000%22%2C%0A%20%20blanchedalmond%3A%20%22ffebcd%22%2C%0A%20%20blue%3A%20%2200f%22%2C%0A%20%20blueviolet%3A%20%228a2be2%22%2C%0A%20%20brown%3A%20%22a52a2a%22%2C%0A%20%20burlywood%3A%20%22deb887%22%2C%0A%20%20burntsienna%3A%20%22ea7e5d%22%2C%0A%20%20cadetblue%3A%20%225f9ea0%22%2C%0A%20%20chartreuse%3A%20%227fff00%22%2C%0A%20%20chocolate%3A%20%22d2691e%22%2C%0A%20%20coral%3A%20%22ff7f50%22%2C%0A%20%20cornflowerblue%3A%20%226495ed%22%2C%0A%20%20cornsilk%3A%20%22fff8dc%22%2C%0A%20%20crimson%3A%20%22dc143c%22%2C%0A%20%20cyan%3A%20%220ff%22%2C%0A%20%20darkblue%3A%20%2200008b%22%2C%0A%20%20darkcyan%3A%20%22008b8b%22%2C%0A%20%20darkgoldenrod%3A%20%22b8860b%22%2C%0A%20%20darkgray%3A%20%22a9a9a9%22%2C%0A%20%20darkgreen%3A%20%22006400%22%2C%0A%20%20darkgrey%3A%20%22a9a9a9%22%2C%0A%20%20darkkhaki%3A%20%22bdb76b%22%2C%0A%20%20darkmagenta%3A%20%228b008b%22%2C%0A%20%20darkolivegreen%3A%20%22556b2f%22%2C%0A%20%20darkorange%3A%20%22ff8c00%22%2C%0A%20%20darkorchid%3A%20%229932cc%22%2C%0A%20%20darkred%3A%20%228b0000%22%2C%0A%20%20darksalmon%3A%20%22e9967a%22%2C%0A%20%20darkseagreen%3A%20%228fbc8f%22%2C%0A%20%20darkslateblue%3A%20%22483d8b%22%2C%0A%20%20darkslategray%3A%20%222f4f4f%22%2C%0A%20%20darkslategrey%3A%20%222f4f4f%22%2C%0A%20%20darkturquoise%3A%20%2200ced1%22%2C%0A%20%20darkviolet%3A%20%229400d3%22%2C%0A%20%20deeppink%3A%20%22ff1493%22%2C%0A%20%20deepskyblue%3A%20%2200bfff%22%2C%0A%20%20dimgray%3A%20%22696969%22%2C%0A%20%20dimgrey%3A%20%22696969%22%2C%0A%20%20dodgerblue%3A%20%221e90ff%22%2C%0A%20%20firebrick%3A%20%22b22222%22%2C%0A%20%20floralwhite%3A%20%22fffaf0%22%2C%0A%20%20forestgreen%3A%20%22228b22%22%2C%0A%20%20fuchsia%3A%20%22f0f%22%2C%0A%20%20gainsboro%3A%20%22dcdcdc%22%2C%0A%20%20ghostwhite%3A%20%22f8f8ff%22%2C%0A%20%20gold%3A%20%22ffd700%22%2C%0A%20%20goldenrod%3A%20%22daa520%22%2C%0A%20%20gray%3A%20%22808080%22%2C%0A%20%20green%3A%20%22008000%22%2C%0A%20%20greenyellow%3A%20%22adff2f%22%2C%0A%20%20grey%3A%20%22808080%22%2C%0A%20%20honeydew%3A%20%22f0fff0%22%2C%0A%20%20hotpink%3A%20%22ff69b4%22%2C%0A%20%20indianred%3A%20%22cd5c5c%22%2C%0A%20%20indigo%3A%20%224b0082%22%2C%0A%20%20ivory%3A%20%22fffff0%22%2C%0A%20%20khaki%3A%20%22f0e68c%22%2C%0A%20%20lavender%3A%20%22e6e6fa%22%2C%0A%20%20lavenderblush%3A%20%22fff0f5%22%2C%0A%20%20lawngreen%3A%20%227cfc00%22%2C%0A%20%20lemonchiffon%3A%20%22fffacd%22%2C%0A%20%20lightblue%3A%20%22add8e6%22%2C%0A%20%20lightcoral%3A%20%22f08080%22%2C%0A%20%20lightcyan%3A%20%22e0ffff%22%2C%0A%20%20lightgoldenrodyellow%3A%20%22fafad2%22%2C%0A%20%20lightgray%3A%20%22d3d3d3%22%2C%0A%20%20lightgreen%3A%20%2290ee90%22%2C%0A%20%20lightgrey%3A%20%22d3d3d3%22%2C%0A%20%20lightpink%3A%20%22ffb6c1%22%2C%0A%20%20lightsalmon%3A%20%22ffa07a%22%2C%0A%20%20lightseagreen%3A%20%2220b2aa%22%2C%0A%20%20lightskyblue%3A%20%2287cefa%22%2C%0A%20%20lightslategray%3A%20%22789%22%2C%0A%20%20lightslategrey%3A%20%22789%22%2C%0A%20%20lightsteelblue%3A%20%22b0c4de%22%2C%0A%20%20lightyellow%3A%20%22ffffe0%22%2C%0A%20%20lime%3A%20%220f0%22%2C%0A%20%20limegreen%3A%20%2232cd32%22%2C%0A%20%20linen%3A%20%22faf0e6%22%2C%0A%20%20magenta%3A%20%22f0f%22%2C%0A%20%20maroon%3A%20%22800000%22%2C%0A%20%20mediumaquamarine%3A%20%2266cdaa%22%2C%0A%20%20mediumblue%3A%20%220000cd%22%2C%0A%20%20mediumorchid%3A%20%22ba55d3%22%2C%0A%20%20mediumpurple%3A%20%229370db%22%2C%0A%20%20mediumseagreen%3A%20%223cb371%22%2C%0A%20%20mediumslateblue%3A%20%227b68ee%22%2C%0A%20%20mediumspringgreen%3A%20%2200fa9a%22%2C%0A%20%20mediumturquoise%3A%20%2248d1cc%22%2C%0A%20%20mediumvioletred%3A%20%22c71585%22%2C%0A%20%20midnightblue%3A%20%22191970%22%2C%0A%20%20mintcream%3A%20%22f5fffa%22%2C%0A%20%20mistyrose%3A%20%22ffe4e1%22%2C%0A%20%20moccasin%3A%20%22ffe4b5%22%2C%0A%20%20navajowhite%3A%20%22ffdead%22%2C%0A%20%20navy%3A%20%22000080%22%2C%0A%20%20oldlace%3A%20%22fdf5e6%22%2C%0A%20%20olive%3A%20%22808000%22%2C%0A%20%20olivedrab%3A%20%226b8e23%22%2C%0A%20%20orange%3A%20%22ffa500%22%2C%0A%20%20orangered%3A%20%22ff4500%22%2C%0A%20%20orchid%3A%20%22da70d6%22%2C%0A%20%20palegoldenrod%3A%20%22eee8aa%22%2C%0A%20%20palegreen%3A%20%2298fb98%22%2C%0A%20%20paleturquoise%3A%20%22afeeee%22%2C%0A%20%20palevioletred%3A%20%22db7093%22%2C%0A%20%20papayawhip%3A%20%22ffefd5%22%2C%0A%20%20peachpuff%3A%20%22ffdab9%22%2C%0A%20%20peru%3A%20%22cd853f%22%2C%0A%20%20pink%3A%20%22ffc0cb%22%2C%0A%20%20plum%3A%20%22dda0dd%22%2C%0A%20%20powderblue%3A%20%22b0e0e6%22%2C%0A%20%20purple%3A%20%22800080%22%2C%0A%20%20rebeccapurple%3A%20%22663399%22%2C%0A%20%20red%3A%20%22f00%22%2C%0A%20%20rosybrown%3A%20%22bc8f8f%22%2C%0A%20%20royalblue%3A%20%224169e1%22%2C%0A%20%20saddlebrown%3A%20%228b4513%22%2C%0A%20%20salmon%3A%20%22fa8072%22%2C%0A%20%20sandybrown%3A%20%22f4a460%22%2C%0A%20%20seagreen%3A%20%222e8b57%22%2C%0A%20%20seashell%3A%20%22fff5ee%22%2C%0A%20%20sienna%3A%20%22a0522d%22%2C%0A%20%20silver%3A%20%22c0c0c0%22%2C%0A%20%20skyblue%3A%20%2287ceeb%22%2C%0A%20%20slateblue%3A%20%226a5acd%22%2C%0A%20%20slategray%3A%20%22708090%22%2C%0A%20%20slategrey%3A%20%22708090%22%2C%0A%20%20snow%3A%20%22fffafa%22%2C%0A%20%20springgreen%3A%20%2200ff7f%22%2C%0A%20%20steelblue%3A%20%224682b4%22%2C%0A%20%20tan%3A%20%22d2b48c%22%2C%0A%20%20teal%3A%20%22008080%22%2C%0A%20%20thistle%3A%20%22d8bfd8%22%2C%0A%20%20tomato%3A%20%22ff6347%22%2C%0A%20%20turquoise%3A%20%2240e0d0%22%2C%0A%20%20violet%3A%20%22ee82ee%22%2C%0A%20%20wheat%3A%20%22f5deb3%22%2C%0A%20%20white%3A%20%22fff%22%2C%0A%20%20whitesmoke%3A%20%22f5f5f5%22%2C%0A%20%20yellow%3A%20%22ff0%22%2C%0A%20%20yellowgreen%3A%20%229acd32%22%0A%7D%3B%0Avar%20hexNames%20%3D%20tinycolor.hexNames%20%3D%20flip%28names%29%3B%0Afunction%20flip%28o%29%20%7B%0A%20%20var%20flipped%20%3D%20%7B%7D%3B%0A%20%20for%20%28var%20i%20in%20o%29%20%7B%0A%20%20%20%20if%20%28o.hasOwnProperty%28i%29%29%20%7B%0A%20%20%20%20%20%20flipped%5Bo%5Bi%5D%5D%20%3D%20i%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20flipped%3B%0A%7D%0Afunction%20boundAlpha%28a2%29%20%7B%0A%20%20a2%20%3D%20parseFloat%28a2%29%3B%0A%20%20if%20%28isNaN%28a2%29%20%7C%7C%20a2%20%3C%200%20%7C%7C%20a2%20%3E%201%29%20%7B%0A%20%20%20%20a2%20%3D%201%3B%0A%20%20%7D%0A%20%20return%20a2%3B%0A%7D%0Afunction%20bound01%28n%2C%20max2%29%20%7B%0A%20%20if%20%28isOnePointZero%28n%29%29%20n%20%3D%20%22100%25%22%3B%0A%20%20var%20processPercent%20%3D%20isPercentage%28n%29%3B%0A%20%20n%20%3D%20Math.min%28max2%2C%20Math.max%280%2C%20parseFloat%28n%29%29%29%3B%0A%20%20if%20%28processPercent%29%20%7B%0A%20%20%20%20n%20%3D%20parseInt%28n%20%2A%20max2%2C%2010%29%20%2F%20100%3B%0A%20%20%7D%0A%20%20if%20%28Math.abs%28n%20-%20max2%29%20%3C%201e-6%29%20%7B%0A%20%20%20%20return%201%3B%0A%20%20%7D%0A%20%20return%20n%20%25%20max2%20%2F%20parseFloat%28max2%29%3B%0A%7D%0Afunction%20clamp01%28val%29%20%7B%0A%20%20return%20Math.min%281%2C%20Math.max%280%2C%20val%29%29%3B%0A%7D%0Afunction%20parseIntFromHex%28val%29%20%7B%0A%20%20return%20parseInt%28val%2C%2016%29%3B%0A%7D%0Afunction%20isOnePointZero%28n%29%20%7B%0A%20%20return%20typeof%20n%20%3D%3D%20%22string%22%20%26%26%20n.indexOf%28%22.%22%29%20%21%3D%20-1%20%26%26%20parseFloat%28n%29%20%3D%3D%3D%201%3B%0A%7D%0Afunction%20isPercentage%28n%29%20%7B%0A%20%20return%20typeof%20n%20%3D%3D%3D%20%22string%22%20%26%26%20n.indexOf%28%22%25%22%29%20%21%3D%20-1%3B%0A%7D%0Afunction%20pad2%28c2%29%20%7B%0A%20%20return%20c2.length%20%3D%3D%201%20%3F%20%220%22%20%2B%20c2%20%3A%20%22%22%20%2B%20c2%3B%0A%7D%0Afunction%20convertToPercentage%28n%29%20%7B%0A%20%20if%20%28n%20%3C%3D%201%29%20%7B%0A%20%20%20%20n%20%3D%20n%20%2A%20100%20%2B%20%22%25%22%3B%0A%20%20%7D%0A%20%20return%20n%3B%0A%7D%0Afunction%20convertDecimalToHex%28d%29%20%7B%0A%20%20return%20Math.round%28parseFloat%28d%29%20%2A%20255%29.toString%2816%29%3B%0A%7D%0Afunction%20convertHexToDecimal%28h%29%20%7B%0A%20%20return%20parseIntFromHex%28h%29%20%2F%20255%3B%0A%7D%0Avar%20matchers%20%3D%20function%28%29%20%7B%0A%20%20var%20CSS_INTEGER%20%3D%20%22%5B-%5C%5C%2B%5D%3F%5C%5Cd%2B%25%3F%22%3B%0A%20%20var%20CSS_NUMBER%20%3D%20%22%5B-%5C%5C%2B%5D%3F%5C%5Cd%2A%5C%5C.%5C%5Cd%2B%25%3F%22%3B%0A%20%20var%20CSS_UNIT%20%3D%20%22%28%3F%3A%22%20%2B%20CSS_NUMBER%20%2B%20%22%29%7C%28%3F%3A%22%20%2B%20CSS_INTEGER%20%2B%20%22%29%22%3B%0A%20%20var%20PERMISSIVE_MATCH3%20%3D%20%22%5B%5C%5Cs%7C%5C%5C%28%5D%2B%28%22%20%2B%20CSS_UNIT%20%2B%20%22%29%5B%2C%7C%5C%5Cs%5D%2B%28%22%20%2B%20CSS_UNIT%20%2B%20%22%29%5B%2C%7C%5C%5Cs%5D%2B%28%22%20%2B%20CSS_UNIT%20%2B%20%22%29%5C%5Cs%2A%5C%5C%29%3F%22%3B%0A%20%20var%20PERMISSIVE_MATCH4%20%3D%20%22%5B%5C%5Cs%7C%5C%5C%28%5D%2B%28%22%20%2B%20CSS_UNIT%20%2B%20%22%29%5B%2C%7C%5C%5Cs%5D%2B%28%22%20%2B%20CSS_UNIT%20%2B%20%22%29%5B%2C%7C%5C%5Cs%5D%2B%28%22%20%2B%20CSS_UNIT%20%2B%20%22%29%5B%2C%7C%5C%5Cs%5D%2B%28%22%20%2B%20CSS_UNIT%20%2B%20%22%29%5C%5Cs%2A%5C%5C%29%3F%22%3B%0A%20%20return%20%7B%0A%20%20%20%20CSS_UNIT%3A%20new%20RegExp%28CSS_UNIT%29%2C%0A%20%20%20%20rgb%3A%20new%20RegExp%28%22rgb%22%20%2B%20PERMISSIVE_MATCH3%29%2C%0A%20%20%20%20rgba%3A%20new%20RegExp%28%22rgba%22%20%2B%20PERMISSIVE_MATCH4%29%2C%0A%20%20%20%20hsl%3A%20new%20RegExp%28%22hsl%22%20%2B%20PERMISSIVE_MATCH3%29%2C%0A%20%20%20%20hsla%3A%20new%20RegExp%28%22hsla%22%20%2B%20PERMISSIVE_MATCH4%29%2C%0A%20%20%20%20hsv%3A%20new%20RegExp%28%22hsv%22%20%2B%20PERMISSIVE_MATCH3%29%2C%0A%20%20%20%20hsva%3A%20new%20RegExp%28%22hsva%22%20%2B%20PERMISSIVE_MATCH4%29%2C%0A%20%20%20%20hex3%3A%20%2F%5E%23%3F%28%5B0-9a-fA-F%5D%7B1%7D%29%28%5B0-9a-fA-F%5D%7B1%7D%29%28%5B0-9a-fA-F%5D%7B1%7D%29%24%2F%2C%0A%20%20%20%20hex6%3A%20%2F%5E%23%3F%28%5B0-9a-fA-F%5D%7B2%7D%29%28%5B0-9a-fA-F%5D%7B2%7D%29%28%5B0-9a-fA-F%5D%7B2%7D%29%24%2F%2C%0A%20%20%20%20hex4%3A%20%2F%5E%23%3F%28%5B0-9a-fA-F%5D%7B1%7D%29%28%5B0-9a-fA-F%5D%7B1%7D%29%28%5B0-9a-fA-F%5D%7B1%7D%29%28%5B0-9a-fA-F%5D%7B1%7D%29%24%2F%2C%0A%20%20%20%20hex8%3A%20%2F%5E%23%3F%28%5B0-9a-fA-F%5D%7B2%7D%29%28%5B0-9a-fA-F%5D%7B2%7D%29%28%5B0-9a-fA-F%5D%7B2%7D%29%28%5B0-9a-fA-F%5D%7B2%7D%29%24%2F%0A%20%20%7D%3B%0A%7D%28%29%3B%0Afunction%20isValidCSSUnit%28color2%29%20%7B%0A%20%20return%20%21%21matchers.CSS_UNIT.exec%28color2%29%3B%0A%7D%0Afunction%20stringInputToObject%28color2%29%20%7B%0A%20%20color2%20%3D%20color2.replace%28trimLeft%2C%20%22%22%29.replace%28trimRight%2C%20%22%22%29.toLowerCase%28%29%3B%0A%20%20var%20named%20%3D%20false%3B%0A%20%20if%20%28names%5Bcolor2%5D%29%20%7B%0A%20%20%20%20color2%20%3D%20names%5Bcolor2%5D%3B%0A%20%20%20%20named%20%3D%20true%3B%0A%20%20%7D%20else%20if%20%28color2%20%3D%3D%20%22transparent%22%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20r%3A%200%2C%0A%20%20%20%20%20%20g%3A%200%2C%0A%20%20%20%20%20%20b%3A%200%2C%0A%20%20%20%20%20%20a%3A%200%2C%0A%20%20%20%20%20%20format%3A%20%22name%22%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20var%20match%3B%0A%20%20if%20%28match%20%3D%20matchers.rgb.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20r%3A%20match%5B1%5D%2C%0A%20%20%20%20%20%20g%3A%20match%5B2%5D%2C%0A%20%20%20%20%20%20b%3A%20match%5B3%5D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28match%20%3D%20matchers.rgba.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20r%3A%20match%5B1%5D%2C%0A%20%20%20%20%20%20g%3A%20match%5B2%5D%2C%0A%20%20%20%20%20%20b%3A%20match%5B3%5D%2C%0A%20%20%20%20%20%20a%3A%20match%5B4%5D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28match%20%3D%20matchers.hsl.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20h%3A%20match%5B1%5D%2C%0A%20%20%20%20%20%20s%3A%20match%5B2%5D%2C%0A%20%20%20%20%20%20l%3A%20match%5B3%5D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28match%20%3D%20matchers.hsla.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20h%3A%20match%5B1%5D%2C%0A%20%20%20%20%20%20s%3A%20match%5B2%5D%2C%0A%20%20%20%20%20%20l%3A%20match%5B3%5D%2C%0A%20%20%20%20%20%20a%3A%20match%5B4%5D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28match%20%3D%20matchers.hsv.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20h%3A%20match%5B1%5D%2C%0A%20%20%20%20%20%20s%3A%20match%5B2%5D%2C%0A%20%20%20%20%20%20v%3A%20match%5B3%5D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28match%20%3D%20matchers.hsva.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20h%3A%20match%5B1%5D%2C%0A%20%20%20%20%20%20s%3A%20match%5B2%5D%2C%0A%20%20%20%20%20%20v%3A%20match%5B3%5D%2C%0A%20%20%20%20%20%20a%3A%20match%5B4%5D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28match%20%3D%20matchers.hex8.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20r%3A%20parseIntFromHex%28match%5B1%5D%29%2C%0A%20%20%20%20%20%20g%3A%20parseIntFromHex%28match%5B2%5D%29%2C%0A%20%20%20%20%20%20b%3A%20parseIntFromHex%28match%5B3%5D%29%2C%0A%20%20%20%20%20%20a%3A%20convertHexToDecimal%28match%5B4%5D%29%2C%0A%20%20%20%20%20%20format%3A%20named%20%3F%20%22name%22%20%3A%20%22hex8%22%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28match%20%3D%20matchers.hex6.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20r%3A%20parseIntFromHex%28match%5B1%5D%29%2C%0A%20%20%20%20%20%20g%3A%20parseIntFromHex%28match%5B2%5D%29%2C%0A%20%20%20%20%20%20b%3A%20parseIntFromHex%28match%5B3%5D%29%2C%0A%20%20%20%20%20%20format%3A%20named%20%3F%20%22name%22%20%3A%20%22hex%22%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28match%20%3D%20matchers.hex4.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20r%3A%20parseIntFromHex%28match%5B1%5D%20%2B%20%22%22%20%2B%20match%5B1%5D%29%2C%0A%20%20%20%20%20%20g%3A%20parseIntFromHex%28match%5B2%5D%20%2B%20%22%22%20%2B%20match%5B2%5D%29%2C%0A%20%20%20%20%20%20b%3A%20parseIntFromHex%28match%5B3%5D%20%2B%20%22%22%20%2B%20match%5B3%5D%29%2C%0A%20%20%20%20%20%20a%3A%20convertHexToDecimal%28match%5B4%5D%20%2B%20%22%22%20%2B%20match%5B4%5D%29%2C%0A%20%20%20%20%20%20format%3A%20named%20%3F%20%22name%22%20%3A%20%22hex8%22%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28match%20%3D%20matchers.hex3.exec%28color2%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20r%3A%20parseIntFromHex%28match%5B1%5D%20%2B%20%22%22%20%2B%20match%5B1%5D%29%2C%0A%20%20%20%20%20%20g%3A%20parseIntFromHex%28match%5B2%5D%20%2B%20%22%22%20%2B%20match%5B2%5D%29%2C%0A%20%20%20%20%20%20b%3A%20parseIntFromHex%28match%5B3%5D%20%2B%20%22%22%20%2B%20match%5B3%5D%29%2C%0A%20%20%20%20%20%20format%3A%20named%20%3F%20%22name%22%20%3A%20%22hex%22%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20return%20false%3B%0A%7D%0Afunction%20validateWCAG2Parms%28parms%29%20%7B%0A%20%20var%20level%2C%20size%3B%0A%20%20parms%20%3D%20parms%20%7C%7C%20%7B%0A%20%20%20%20level%3A%20%22AA%22%2C%0A%20%20%20%20size%3A%20%22small%22%0A%20%20%7D%3B%0A%20%20level%20%3D%20%28parms.level%20%7C%7C%20%22AA%22%29.toUpperCase%28%29%3B%0A%20%20size%20%3D%20%28parms.size%20%7C%7C%20%22small%22%29.toLowerCase%28%29%3B%0A%20%20if%20%28level%20%21%3D%3D%20%22AA%22%20%26%26%20level%20%21%3D%3D%20%22AAA%22%29%20%7B%0A%20%20%20%20level%20%3D%20%22AA%22%3B%0A%20%20%7D%0A%20%20if%20%28size%20%21%3D%3D%20%22small%22%20%26%26%20size%20%21%3D%3D%20%22large%22%29%20%7B%0A%20%20%20%20size%20%3D%20%22small%22%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20level%2C%0A%20%20%20%20size%0A%20%20%7D%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree-forcegraph%2Fdist%2Fthree-forcegraph.mjs%0Afunction%20_arrayLikeToArray4%28r%2C%20a2%29%20%7B%0A%20%20%28null%20%3D%3D%20a2%20%7C%7C%20a2%20%3E%20r.length%29%20%26%26%20%28a2%20%3D%20r.length%29%3B%0A%20%20for%20%28var%20e%20%3D%200%2C%20n%20%3D%20Array%28a2%29%3B%20e%20%3C%20a2%3B%20e%2B%2B%29%20n%5Be%5D%20%3D%20r%5Be%5D%3B%0A%20%20return%20n%3B%0A%7D%0Afunction%20_arrayWithHoles4%28r%29%20%7B%0A%20%20if%20%28Array.isArray%28r%29%29%20return%20r%3B%0A%7D%0Afunction%20_arrayWithoutHoles3%28r%29%20%7B%0A%20%20if%20%28Array.isArray%28r%29%29%20return%20_arrayLikeToArray4%28r%29%3B%0A%7D%0Afunction%20_assertThisInitialized%28e%29%20%7B%0A%20%20if%20%28void%200%20%3D%3D%3D%20e%29%20throw%20new%20ReferenceError%28%22this%20hasn%27t%20been%20initialised%20-%20super%28%29%20hasn%27t%20been%20called%22%29%3B%0A%20%20return%20e%3B%0A%7D%0Afunction%20_callSuper%28t%2C%20o%2C%20e%29%20%7B%0A%20%20return%20o%20%3D%20_getPrototypeOf%28o%29%2C%20_possibleConstructorReturn%28t%2C%20_isNativeReflectConstruct%28%29%20%3F%20Reflect.construct%28o%2C%20e%20%7C%7C%20%5B%5D%2C%20_getPrototypeOf%28t%29.constructor%29%20%3A%20o.apply%28t%2C%20e%29%29%3B%0A%7D%0Afunction%20_classCallCheck2%28a2%2C%20n%29%20%7B%0A%20%20if%20%28%21%28a2%20instanceof%20n%29%29%20throw%20new%20TypeError%28%22Cannot%20call%20a%20class%20as%20a%20function%22%29%3B%0A%7D%0Afunction%20_construct%28t%2C%20e%2C%20r%29%20%7B%0A%20%20if%20%28_isNativeReflectConstruct%28%29%29%20return%20Reflect.construct.apply%28null%2C%20arguments%29%3B%0A%20%20var%20o%20%3D%20%5Bnull%5D%3B%0A%20%20o.push.apply%28o%2C%20e%29%3B%0A%20%20var%20p%20%3D%20new%20%28t.bind.apply%28t%2C%20o%29%29%28%29%3B%0A%20%20return%20p%3B%0A%7D%0Afunction%20_createClass2%28e%2C%20r%2C%20t%29%20%7B%0A%20%20return%20Object.defineProperty%28e%2C%20%22prototype%22%2C%20%7B%0A%20%20%20%20writable%3A%20false%0A%20%20%7D%29%2C%20e%3B%0A%7D%0Afunction%20_defineProperty2%28e%2C%20r%2C%20t%29%20%7B%0A%20%20return%20%28r%20%3D%20_toPropertyKey3%28r%29%29%20in%20e%20%3F%20Object.defineProperty%28e%2C%20r%2C%20%7B%0A%20%20%20%20value%3A%20t%2C%0A%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20writable%3A%20true%0A%20%20%7D%29%20%3A%20e%5Br%5D%20%3D%20t%2C%20e%3B%0A%7D%0Afunction%20_getPrototypeOf%28t%29%20%7B%0A%20%20return%20_getPrototypeOf%20%3D%20Object.setPrototypeOf%20%3F%20Object.getPrototypeOf.bind%28%29%20%3A%20function%28t2%29%20%7B%0A%20%20%20%20return%20t2.__proto__%20%7C%7C%20Object.getPrototypeOf%28t2%29%3B%0A%20%20%7D%2C%20_getPrototypeOf%28t%29%3B%0A%7D%0Afunction%20_inherits%28t%2C%20e%29%20%7B%0A%20%20if%20%28%22function%22%20%21%3D%20typeof%20e%20%26%26%20null%20%21%3D%3D%20e%29%20throw%20new%20TypeError%28%22Super%20expression%20must%20either%20be%20null%20or%20a%20function%22%29%3B%0A%20%20t.prototype%20%3D%20Object.create%28e%20%26%26%20e.prototype%2C%20%7B%0A%20%20%20%20constructor%3A%20%7B%0A%20%20%20%20%20%20value%3A%20t%2C%0A%20%20%20%20%20%20writable%3A%20true%2C%0A%20%20%20%20%20%20configurable%3A%20true%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%20Object.defineProperty%28t%2C%20%22prototype%22%2C%20%7B%0A%20%20%20%20writable%3A%20false%0A%20%20%7D%29%2C%20e%20%26%26%20_setPrototypeOf%28t%2C%20e%29%3B%0A%7D%0Afunction%20_isNativeReflectConstruct%28%29%20%7B%0A%20%20try%20%7B%0A%20%20%20%20var%20t%20%3D%20%21Boolean.prototype.valueOf.call%28Reflect.construct%28Boolean%2C%20%5B%5D%2C%20function%28%29%20%7B%0A%20%20%20%20%7D%29%29%3B%0A%20%20%7D%20catch%20%28t2%29%20%7B%0A%20%20%7D%0A%20%20return%20%28_isNativeReflectConstruct%20%3D%20function%28%29%20%7B%0A%20%20%20%20return%20%21%21t%3B%0A%20%20%7D%29%28%29%3B%0A%7D%0Afunction%20_iterableToArray3%28r%29%20%7B%0A%20%20if%20%28%22undefined%22%20%21%3D%20typeof%20Symbol%20%26%26%20null%20%21%3D%20r%5BSymbol.iterator%5D%20%7C%7C%20null%20%21%3D%20r%5B%22%40%40iterator%22%5D%29%20return%20Array.from%28r%29%3B%0A%7D%0Afunction%20_iterableToArrayLimit4%28r%2C%20l%29%20%7B%0A%20%20var%20t%20%3D%20null%20%3D%3D%20r%20%3F%20null%20%3A%20%22undefined%22%20%21%3D%20typeof%20Symbol%20%26%26%20r%5BSymbol.iterator%5D%20%7C%7C%20r%5B%22%40%40iterator%22%5D%3B%0A%20%20if%20%28null%20%21%3D%20t%29%20%7B%0A%20%20%20%20var%20e%2C%20n%2C%20i%2C%20u%2C%20a2%20%3D%20%5B%5D%2C%20f%20%3D%20true%2C%20o%20%3D%20false%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20if%20%28i%20%3D%20%28t%20%3D%20t.call%28r%29%29.next%2C%200%20%3D%3D%3D%20l%29%20%3B%0A%20%20%20%20%20%20else%20for%20%28%3B%20%21%28f%20%3D%20%28e%20%3D%20i.call%28t%29%29.done%29%20%26%26%20%28a2.push%28e.value%29%2C%20a2.length%20%21%3D%3D%20l%29%3B%20f%20%3D%20true%29%20%3B%0A%20%20%20%20%7D%20catch%20%28r2%29%20%7B%0A%20%20%20%20%20%20o%20%3D%20true%2C%20n%20%3D%20r2%3B%0A%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21f%20%26%26%20null%20%21%3D%20t.return%20%26%26%20%28u%20%3D%20t.return%28%29%2C%20Object%28u%29%20%21%3D%3D%20u%29%29%20return%3B%0A%20%20%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20%20%20if%20%28o%29%20throw%20n%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20a2%3B%0A%20%20%7D%0A%7D%0Afunction%20_nonIterableRest4%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20destructure%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20_nonIterableSpread3%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20spread%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20ownKeys2%28e%2C%20r%29%20%7B%0A%20%20var%20t%20%3D%20Object.keys%28e%29%3B%0A%20%20if%20%28Object.getOwnPropertySymbols%29%20%7B%0A%20%20%20%20var%20o%20%3D%20Object.getOwnPropertySymbols%28e%29%3B%0A%20%20%20%20r%20%26%26%20%28o%20%3D%20o.filter%28function%28r2%29%20%7B%0A%20%20%20%20%20%20return%20Object.getOwnPropertyDescriptor%28e%2C%20r2%29.enumerable%3B%0A%20%20%20%20%7D%29%29%2C%20t.push.apply%28t%2C%20o%29%3B%0A%20%20%7D%0A%20%20return%20t%3B%0A%7D%0Afunction%20_objectSpread22%28e%29%20%7B%0A%20%20for%20%28var%20r%20%3D%201%3B%20r%20%3C%20arguments.length%3B%20r%2B%2B%29%20%7B%0A%20%20%20%20var%20t%20%3D%20null%20%21%3D%20arguments%5Br%5D%20%3F%20arguments%5Br%5D%20%3A%20%7B%7D%3B%0A%20%20%20%20r%20%25%202%20%3F%20ownKeys2%28Object%28t%29%2C%20true%29.forEach%28function%28r2%29%20%7B%0A%20%20%20%20%20%20_defineProperty2%28e%2C%20r2%2C%20t%5Br2%5D%29%3B%0A%20%20%20%20%7D%29%20%3A%20Object.getOwnPropertyDescriptors%20%3F%20Object.defineProperties%28e%2C%20Object.getOwnPropertyDescriptors%28t%29%29%20%3A%20ownKeys2%28Object%28t%29%29.forEach%28function%28r2%29%20%7B%0A%20%20%20%20%20%20Object.defineProperty%28e%2C%20r2%2C%20Object.getOwnPropertyDescriptor%28t%2C%20r2%29%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20return%20e%3B%0A%7D%0Afunction%20_objectWithoutProperties3%28e%2C%20t%29%20%7B%0A%20%20if%20%28null%20%3D%3D%20e%29%20return%20%7B%7D%3B%0A%20%20var%20o%2C%20r%2C%20i%20%3D%20_objectWithoutPropertiesLoose3%28e%2C%20t%29%3B%0A%20%20if%20%28Object.getOwnPropertySymbols%29%20%7B%0A%20%20%20%20var%20s%20%3D%20Object.getOwnPropertySymbols%28e%29%3B%0A%20%20%20%20for%20%28r%20%3D%200%3B%20r%20%3C%20s.length%3B%20r%2B%2B%29%20o%20%3D%20s%5Br%5D%2C%20t.includes%28o%29%20%7C%7C%20%7B%7D.propertyIsEnumerable.call%28e%2C%20o%29%20%26%26%20%28i%5Bo%5D%20%3D%20e%5Bo%5D%29%3B%0A%20%20%7D%0A%20%20return%20i%3B%0A%7D%0Afunction%20_objectWithoutPropertiesLoose3%28r%2C%20e%29%20%7B%0A%20%20if%20%28null%20%3D%3D%20r%29%20return%20%7B%7D%3B%0A%20%20var%20t%20%3D%20%7B%7D%3B%0A%20%20for%20%28var%20n%20in%20r%29%20if%20%28%7B%7D.hasOwnProperty.call%28r%2C%20n%29%29%20%7B%0A%20%20%20%20if%20%28e.includes%28n%29%29%20continue%3B%0A%20%20%20%20t%5Bn%5D%20%3D%20r%5Bn%5D%3B%0A%20%20%7D%0A%20%20return%20t%3B%0A%7D%0Afunction%20_possibleConstructorReturn%28t%2C%20e%29%20%7B%0A%20%20if%20%28e%20%26%26%20%28%22object%22%20%3D%3D%20typeof%20e%20%7C%7C%20%22function%22%20%3D%3D%20typeof%20e%29%29%20return%20e%3B%0A%20%20if%20%28void%200%20%21%3D%3D%20e%29%20throw%20new%20TypeError%28%22Derived%20constructors%20may%20only%20return%20object%20or%20undefined%22%29%3B%0A%20%20return%20_assertThisInitialized%28t%29%3B%0A%7D%0Afunction%20_setPrototypeOf%28t%2C%20e%29%20%7B%0A%20%20return%20_setPrototypeOf%20%3D%20Object.setPrototypeOf%20%3F%20Object.setPrototypeOf.bind%28%29%20%3A%20function%28t2%2C%20e2%29%20%7B%0A%20%20%20%20return%20t2.__proto__%20%3D%20e2%2C%20t2%3B%0A%20%20%7D%2C%20_setPrototypeOf%28t%2C%20e%29%3B%0A%7D%0Afunction%20_slicedToArray4%28r%2C%20e%29%20%7B%0A%20%20return%20_arrayWithHoles4%28r%29%20%7C%7C%20_iterableToArrayLimit4%28r%2C%20e%29%20%7C%7C%20_unsupportedIterableToArray4%28r%2C%20e%29%20%7C%7C%20_nonIterableRest4%28%29%3B%0A%7D%0Afunction%20_toConsumableArray3%28r%29%20%7B%0A%20%20return%20_arrayWithoutHoles3%28r%29%20%7C%7C%20_iterableToArray3%28r%29%20%7C%7C%20_unsupportedIterableToArray4%28r%29%20%7C%7C%20_nonIterableSpread3%28%29%3B%0A%7D%0Afunction%20_toPrimitive3%28t%2C%20r%29%20%7B%0A%20%20if%20%28%22object%22%20%21%3D%20typeof%20t%20%7C%7C%20%21t%29%20return%20t%3B%0A%20%20var%20e%20%3D%20t%5BSymbol.toPrimitive%5D%3B%0A%20%20if%20%28void%200%20%21%3D%3D%20e%29%20%7B%0A%20%20%20%20var%20i%20%3D%20e.call%28t%2C%20r%20%7C%7C%20%22default%22%29%3B%0A%20%20%20%20if%20%28%22object%22%20%21%3D%20typeof%20i%29%20return%20i%3B%0A%20%20%20%20throw%20new%20TypeError%28%22%40%40toPrimitive%20must%20return%20a%20primitive%20value.%22%29%3B%0A%20%20%7D%0A%20%20return%20%28%22string%22%20%3D%3D%3D%20r%20%3F%20String%20%3A%20Number%29%28t%29%3B%0A%7D%0Afunction%20_toPropertyKey3%28t%29%20%7B%0A%20%20var%20i%20%3D%20_toPrimitive3%28t%2C%20%22string%22%29%3B%0A%20%20return%20%22symbol%22%20%3D%3D%20typeof%20i%20%3F%20i%20%3A%20i%20%2B%20%22%22%3B%0A%7D%0Afunction%20_typeof2%28o%29%20%7B%0A%20%20%22%40babel%2Fhelpers%20-%20typeof%22%3B%0A%20%20return%20_typeof2%20%3D%20%22function%22%20%3D%3D%20typeof%20Symbol%20%26%26%20%22symbol%22%20%3D%3D%20typeof%20Symbol.iterator%20%3F%20function%28o2%29%20%7B%0A%20%20%20%20return%20typeof%20o2%3B%0A%20%20%7D%20%3A%20function%28o2%29%20%7B%0A%20%20%20%20return%20o2%20%26%26%20%22function%22%20%3D%3D%20typeof%20Symbol%20%26%26%20o2.constructor%20%3D%3D%3D%20Symbol%20%26%26%20o2%20%21%3D%3D%20Symbol.prototype%20%3F%20%22symbol%22%20%3A%20typeof%20o2%3B%0A%20%20%7D%2C%20_typeof2%28o%29%3B%0A%7D%0Afunction%20_unsupportedIterableToArray4%28r%2C%20a2%29%20%7B%0A%20%20if%20%28r%29%20%7B%0A%20%20%20%20if%20%28%22string%22%20%3D%3D%20typeof%20r%29%20return%20_arrayLikeToArray4%28r%2C%20a2%29%3B%0A%20%20%20%20var%20t%20%3D%20%7B%7D.toString.call%28r%29.slice%288%2C%20-1%29%3B%0A%20%20%20%20return%20%22Object%22%20%3D%3D%3D%20t%20%26%26%20r.constructor%20%26%26%20%28t%20%3D%20r.constructor.name%29%2C%20%22Map%22%20%3D%3D%3D%20t%20%7C%7C%20%22Set%22%20%3D%3D%3D%20t%20%3F%20Array.from%28r%29%20%3A%20%22Arguments%22%20%3D%3D%3D%20t%20%7C%7C%20%2F%5E%28%3F%3AUi%7CI%29nt%28%3F%3A8%7C16%7C32%29%28%3F%3AClamped%29%3FArray%24%2F.test%28t%29%20%3F%20_arrayLikeToArray4%28r%2C%20a2%29%20%3A%20void%200%3B%0A%20%20%7D%0A%7D%0Avar%20_materialDispose%20%3D%20function%20materialDispose%28material%29%20%7B%0A%20%20if%20%28material%20instanceof%20Array%29%20%7B%0A%20%20%20%20material.forEach%28_materialDispose%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28material.map%29%20%7B%0A%20%20%20%20%20%20material.map.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20material.dispose%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_deallocate%20%3D%20function%20deallocate%28obj%29%20%7B%0A%20%20if%20%28obj.geometry%29%20%7B%0A%20%20%20%20obj.geometry.dispose%28%29%3B%0A%20%20%7D%0A%20%20if%20%28obj.material%29%20%7B%0A%20%20%20%20_materialDispose%28obj.material%29%3B%0A%20%20%7D%0A%20%20if%20%28obj.texture%29%20%7B%0A%20%20%20%20obj.texture.dispose%28%29%3B%0A%20%20%7D%0A%20%20if%20%28obj.children%29%20%7B%0A%20%20%20%20obj.children.forEach%28_deallocate%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20emptyObject%20%3D%20function%20emptyObject2%28obj%29%20%7B%0A%20%20while%20%28obj.children.length%29%20%7B%0A%20%20%20%20var%20childObj%20%3D%20obj.children%5B0%5D%3B%0A%20%20%20%20obj.remove%28childObj%29%3B%0A%20%20%20%20_deallocate%28childObj%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_excluded2%20%3D%20%5B%22objFilter%22%5D%3B%0Afunction%20threeDigest%28data%2C%20scene3%29%20%7B%0A%20%20var%20_ref%20%3D%20arguments.length%20%3E%202%20%26%26%20arguments%5B2%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B2%5D%20%3A%20%7B%7D%2C%20_ref%24objFilter%20%3D%20_ref.objFilter%2C%20objFilter%20%3D%20_ref%24objFilter%20%3D%3D%3D%20void%200%20%3F%20function%28%29%20%7B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%20%3A%20_ref%24objFilter%2C%20options%20%3D%20_objectWithoutProperties3%28_ref%2C%20_excluded2%29%3B%0A%20%20return%20viewDigest%28data%2C%20scene3.children.filter%28objFilter%29%2C%20function%28obj%29%20%7B%0A%20%20%20%20return%20scene3.add%28obj%29%3B%0A%20%20%7D%2C%20function%28obj%29%20%7B%0A%20%20%20%20scene3.remove%28obj%29%3B%0A%20%20%20%20emptyObject%28obj%29%3B%0A%20%20%7D%2C%20_objectSpread22%28%7B%0A%20%20%20%20objBindAttr%3A%20%22__threeObj%22%0A%20%20%7D%2C%20options%29%29%3B%0A%7D%0Avar%20colorStr2Hex%20%3D%20function%20colorStr2Hex2%28str%29%20%7B%0A%20%20return%20isNaN%28str%29%20%3F%20parseInt%28tinycolor%28str%29.toHex%28%29%2C%2016%29%20%3A%20str%3B%0A%7D%3B%0Avar%20colorAlpha%20%3D%20function%20colorAlpha2%28str%29%20%7B%0A%20%20return%20isNaN%28str%29%20%3F%20tinycolor%28str%29.getAlpha%28%29%20%3A%201%3B%0A%7D%3B%0Avar%20autoColorScale%20%3D%20ordinal%28Paired_default%29%3B%0Afunction%20autoColorObjects%28objects%2C%20colorByAccessor%2C%20colorField%29%20%7B%0A%20%20if%20%28%21colorByAccessor%20%7C%7C%20typeof%20colorField%20%21%3D%3D%20%22string%22%29%20return%3B%0A%20%20objects.filter%28function%28obj%29%20%7B%0A%20%20%20%20return%20%21obj%5BcolorField%5D%3B%0A%20%20%7D%29.forEach%28function%28obj%29%20%7B%0A%20%20%20%20obj%5BcolorField%5D%20%3D%20autoColorScale%28colorByAccessor%28obj%29%29%3B%0A%20%20%7D%29%3B%0A%7D%0Afunction%20getDagDepths%28_ref%2C%20idAccessor%29%20%7B%0A%20%20var%20nodes%20%3D%20_ref.nodes%2C%20links%20%3D%20_ref.links%3B%0A%20%20var%20_ref2%20%3D%20arguments.length%20%3E%202%20%26%26%20arguments%5B2%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B2%5D%20%3A%20%7B%7D%2C%20_ref2%24nodeFilter%20%3D%20_ref2.nodeFilter%2C%20nodeFilter%20%3D%20_ref2%24nodeFilter%20%3D%3D%3D%20void%200%20%3F%20function%28%29%20%7B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%20%3A%20_ref2%24nodeFilter%2C%20_ref2%24onLoopError%20%3D%20_ref2.onLoopError%2C%20onLoopError%20%3D%20_ref2%24onLoopError%20%3D%3D%3D%20void%200%20%3F%20function%28loopIds%29%20%7B%0A%20%20%20%20throw%20%22Invalid%20DAG%20structure%21%20Found%20cycle%20in%20node%20path%3A%20%22.concat%28loopIds.join%28%22%20-%3E%20%22%29%2C%20%22.%22%29%3B%0A%20%20%7D%20%3A%20_ref2%24onLoopError%3B%0A%20%20var%20graph2%20%3D%20%7B%7D%3B%0A%20%20nodes.forEach%28function%28node%29%20%7B%0A%20%20%20%20return%20graph2%5BidAccessor%28node%29%5D%20%3D%20%7B%0A%20%20%20%20%20%20data%3A%20node%2C%0A%20%20%20%20%20%20out%3A%20%5B%5D%2C%0A%20%20%20%20%20%20depth%3A%20-1%2C%0A%20%20%20%20%20%20skip%3A%20%21nodeFilter%28node%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%29%3B%0A%20%20links.forEach%28function%28_ref3%29%20%7B%0A%20%20%20%20var%20source%20%3D%20_ref3.source%2C%20target%20%3D%20_ref3.target%3B%0A%20%20%20%20var%20sourceId%20%3D%20getNodeId%28source%29%3B%0A%20%20%20%20var%20targetId%20%3D%20getNodeId%28target%29%3B%0A%20%20%20%20if%20%28%21graph2.hasOwnProperty%28sourceId%29%29%20throw%20%22Missing%20source%20node%20with%20id%3A%20%22.concat%28sourceId%29%3B%0A%20%20%20%20if%20%28%21graph2.hasOwnProperty%28targetId%29%29%20throw%20%22Missing%20target%20node%20with%20id%3A%20%22.concat%28targetId%29%3B%0A%20%20%20%20var%20sourceNode%20%3D%20graph2%5BsourceId%5D%3B%0A%20%20%20%20var%20targetNode%20%3D%20graph2%5BtargetId%5D%3B%0A%20%20%20%20sourceNode.out.push%28targetNode%29%3B%0A%20%20%20%20function%20getNodeId%28node%29%20%7B%0A%20%20%20%20%20%20return%20_typeof2%28node%29%20%3D%3D%3D%20%22object%22%20%3F%20idAccessor%28node%29%20%3A%20node%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%3B%0A%20%20var%20foundLoops%20%3D%20%5B%5D%3B%0A%20%20traverse%28Object.values%28graph2%29%29%3B%0A%20%20var%20nodeDepths%20%3D%20Object.assign.apply%28Object%2C%20%5B%7B%7D%5D.concat%28_toConsumableArray3%28Object.entries%28graph2%29.filter%28function%28_ref4%29%20%7B%0A%20%20%20%20var%20_ref5%20%3D%20_slicedToArray4%28_ref4%2C%202%29%2C%20node%20%3D%20_ref5%5B1%5D%3B%0A%20%20%20%20return%20%21node.skip%3B%0A%20%20%7D%29.map%28function%28_ref6%29%20%7B%0A%20%20%20%20var%20_ref7%20%3D%20_slicedToArray4%28_ref6%2C%202%29%2C%20id2%20%3D%20_ref7%5B0%5D%2C%20node%20%3D%20_ref7%5B1%5D%3B%0A%20%20%20%20return%20_defineProperty2%28%7B%7D%2C%20id2%2C%20node.depth%29%3B%0A%20%20%7D%29%29%29%29%3B%0A%20%20return%20nodeDepths%3B%0A%20%20function%20traverse%28nodes2%29%20%7B%0A%20%20%20%20var%20nodeStack%20%3D%20arguments.length%20%3E%201%20%26%26%20arguments%5B1%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B1%5D%20%3A%20%5B%5D%3B%0A%20%20%20%20var%20currentDepth%20%3D%20arguments.length%20%3E%202%20%26%26%20arguments%5B2%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B2%5D%20%3A%200%3B%0A%20%20%20%20var%20_loop%20%3D%20function%20_loop2%28%29%20%7B%0A%20%20%20%20%20%20var%20node%20%3D%20nodes2%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28nodeStack.indexOf%28node%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20var%20loop%20%3D%20%5B%5D.concat%28_toConsumableArray3%28nodeStack.slice%28nodeStack.indexOf%28node%29%29%29%2C%20%5Bnode%5D%29.map%28function%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20idAccessor%28d.data%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%21foundLoops.some%28function%28foundLoop%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20foundLoop.length%20%3D%3D%3D%20loop.length%20%26%26%20foundLoop.every%28function%28id2%2C%20idx%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20id2%20%3D%3D%3D%20loop%5Bidx%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20foundLoops.push%28loop%29%3B%0A%20%20%20%20%20%20%20%20%20%20onLoopError%28loop%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28currentDepth%20%3E%20node.depth%29%20%7B%0A%20%20%20%20%20%20%20%20node.depth%20%3D%20currentDepth%3B%0A%20%20%20%20%20%20%20%20traverse%28node.out%2C%20%5B%5D.concat%28_toConsumableArray3%28nodeStack%29%2C%20%5Bnode%5D%29%2C%20currentDepth%20%2B%20%28node.skip%20%3F%200%20%3A%201%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20for%20%28var%20i%20%3D%200%2C%20l%20%3D%20nodes2.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28_loop%28%29%29%20continue%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Avar%20three%241%20%3D%20window.THREE%20%3F%20window.THREE%20%3A%20%7B%0A%20%20Group%2C%0A%20%20Mesh%2C%0A%20%20MeshLambertMaterial%2C%0A%20%20Color%2C%0A%20%20BufferGeometry%2C%0A%20%20BufferAttribute%2C%0A%20%20Matrix4%2C%0A%20%20Vector3%2C%0A%20%20SphereGeometry%2C%0A%20%20CylinderGeometry%2C%0A%20%20TubeGeometry%2C%0A%20%20ConeGeometry%2C%0A%20%20Line%2C%0A%20%20LineBasicMaterial%2C%0A%20%20QuadraticBezierCurve3%2C%0A%20%20CubicBezierCurve3%2C%0A%20%20Box3%0A%7D%3B%0Avar%20ngraph%20%3D%20%7B%0A%20%20graph%3A%20import_ngraph.default%2C%0A%20%20forcelayout%3A%20import_ngraph2.default%0A%7D%3B%0Avar%20DAG_LEVEL_NODE_RATIO%20%3D%202%3B%0Avar%20setAttributeFn%20%3D%20new%20three%241.BufferGeometry%28%29.setAttribute%20%3F%20%22setAttribute%22%20%3A%20%22addAttribute%22%3B%0Avar%20applyMatrix4Fn%20%3D%20new%20three%241.BufferGeometry%28%29.applyMatrix4%20%3F%20%22applyMatrix4%22%20%3A%20%22applyMatrix%22%3B%0Avar%20ForceGraph%20%3D%20index2%28%7B%0A%20%20props%3A%20%7B%0A%20%20%20%20jsonUrl%3A%20%7B%0A%20%20%20%20%20%20onChange%3A%20function%20onChange%28jsonUrl%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20var%20_this%20%3D%20this%3B%0A%20%20%20%20%20%20%20%20if%20%28jsonUrl%20%26%26%20%21state.fetchingJson%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.fetchingJson%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20state.onLoading%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20fetch%28jsonUrl%29.then%28function%28r%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20r.json%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29.then%28function%28json%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.fetchingJson%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.onFinishLoading%28json%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_this.graphData%28json%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20graphData%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%7B%0A%20%20%20%20%20%20%20%20nodes%3A%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20links%3A%20%5B%5D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange2%28graphData%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20state.engineRunning%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20numDimensions%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%203%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange3%28numDim%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20var%20chargeForce%20%3D%20state.d3ForceLayout.force%28%22charge%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28chargeForce%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20chargeForce.strength%28numDim%20%3E%202%20%3F%20-60%20%3A%20-30%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28numDim%20%3C%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20eraseDimension%28state.graphData.nodes%2C%20%22z%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28numDim%20%3C%202%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20eraseDimension%28state.graphData.nodes%2C%20%22y%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20eraseDimension%28nodes%2C%20dim%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20nodes.forEach%28function%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20delete%20d%5Bdim%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20delete%20d%5B%22v%22.concat%28dim%29%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20dagMode%3A%20%7B%0A%20%20%20%20%20%20onChange%3A%20function%20onChange4%28dagMode%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20%21dagMode%20%26%26%20state.forceEngine%20%3D%3D%3D%20%22d3%22%20%26%26%20%28state.graphData.nodes%20%7C%7C%20%5B%5D%29.forEach%28function%28n%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20n.fx%20%3D%20n.fy%20%3D%20n.fz%20%3D%20void%200%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20dagLevelDistance%3A%20%7B%7D%2C%0A%20%20%20%20dagNodeFilter%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default%28node%29%20%7B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20onDagError%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20nodeRelSize%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%204%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20volume%20per%20val%20unit%0A%20%20%20%20nodeId%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22id%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20nodeVal%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22val%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20nodeResolution%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%208%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20how%20many%20slice%20segments%20in%20the%20sphere%27s%20circumference%0A%20%20%20%20nodeColor%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22color%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20nodeAutoColorBy%3A%20%7B%7D%2C%0A%20%20%20%20nodeOpacity%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200.75%0A%20%20%20%20%7D%2C%0A%20%20%20%20nodeVisibility%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20true%0A%20%20%20%20%7D%2C%0A%20%20%20%20nodeThreeObject%3A%20%7B%7D%2C%0A%20%20%20%20nodeThreeObjectExtend%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20nodePositionUpdate%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20custom%20function%20to%20call%20for%20updating%20the%20node%27s%20position.%20Signature%3A%20%28threeObj%2C%20%7B%20x%2C%20y%2C%20z%7D%2C%20node%29.%20If%20the%20function%20returns%20a%20truthy%20value%2C%20the%20regular%20node%20position%20update%20will%20not%20run.%0A%20%20%20%20linkSource%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22source%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkTarget%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22target%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkVisibility%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20true%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkColor%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22color%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkAutoColorBy%3A%20%7B%7D%2C%0A%20%20%20%20linkOpacity%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200.2%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkWidth%3A%20%7B%7D%2C%0A%20%20%20%20%2F%2F%20Rounded%20to%20nearest%20decimal.%20For%20falsy%20values%20use%20dimensionless%20line%20with%201px%20regardless%20of%20distance.%0A%20%20%20%20linkResolution%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%206%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20how%20many%20radial%20segments%20in%20each%20line%20tube%27s%20geometry%0A%20%20%20%20linkCurvature%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20line%20curvature%20radius%20%280%3A%20straight%2C%201%3A%20semi-circle%29%0A%20%20%20%20linkCurveRotation%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20line%20curve%20rotation%20along%20the%20line%20axis%20%280%3A%20interection%20with%20XY%20plane%2C%20PI%3A%20upside%20down%29%0A%20%20%20%20linkMaterial%3A%20%7B%7D%2C%0A%20%20%20%20linkThreeObject%3A%20%7B%7D%2C%0A%20%20%20%20linkThreeObjectExtend%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkPositionUpdate%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20custom%20function%20to%20call%20for%20updating%20the%20link%27s%20position.%20Signature%3A%20%28threeObj%2C%20%7B%20start%3A%20%7B%20x%2C%20y%2C%20z%7D%2C%20%20end%3A%20%7B%20x%2C%20y%2C%20z%20%7D%7D%2C%20link%29.%20If%20the%20function%20returns%20a%20truthy%20value%2C%20the%20regular%20link%20position%20update%20will%20not%20run.%0A%20%20%20%20linkDirectionalArrowLength%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkDirectionalArrowColor%3A%20%7B%7D%2C%0A%20%20%20%20linkDirectionalArrowRelPos%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200.5%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20value%20between%200%3C%3E1%20indicating%20the%20relative%20pos%20along%20the%20%28exposed%29%20line%0A%20%20%20%20linkDirectionalArrowResolution%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%208%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20how%20many%20slice%20segments%20in%20the%20arrow%27s%20conic%20circumference%0A%20%20%20%20linkDirectionalParticles%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20animate%20photons%20travelling%20in%20the%20link%20direction%0A%20%20%20%20linkDirectionalParticleSpeed%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200.01%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20in%20link%20length%20ratio%20per%20frame%0A%20%20%20%20linkDirectionalParticleWidth%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200.5%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkDirectionalParticleColor%3A%20%7B%7D%2C%0A%20%20%20%20linkDirectionalParticleResolution%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%204%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20how%20many%20slice%20segments%20in%20the%20particle%20sphere%27s%20circumference%0A%20%20%20%20forceEngine%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22d3%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20d3%20or%20ngraph%0A%20%20%20%20d3AlphaMin%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200%0A%20%20%20%20%7D%2C%0A%20%20%20%20d3AlphaDecay%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200.0228%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange5%28alphaDecay%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20state.d3ForceLayout.alphaDecay%28alphaDecay%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20d3AlphaTarget%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange6%28alphaTarget%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20state.d3ForceLayout.alphaTarget%28alphaTarget%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20d3VelocityDecay%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200.4%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange7%28velocityDecay%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20state.d3ForceLayout.velocityDecay%28velocityDecay%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20ngraphPhysics%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20defaults%20from%20https%3A%2F%2Fgithub.com%2Fanvaka%2Fngraph.physics.simulator%2Fblob%2Fmaster%2Findex.js%0A%20%20%20%20%20%20%20%20timeStep%3A%2020%2C%0A%20%20%20%20%20%20%20%20gravity%3A%20-1.2%2C%0A%20%20%20%20%20%20%20%20theta%3A%200.8%2C%0A%20%20%20%20%20%20%20%20springLength%3A%2030%2C%0A%20%20%20%20%20%20%20%20springCoefficient%3A%208e-4%2C%0A%20%20%20%20%20%20%20%20dragCoefficient%3A%200.02%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20warmupTicks%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%200%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20how%20many%20times%20to%20tick%20the%20force%20engine%20at%20init%20before%20starting%20to%20render%0A%20%20%20%20cooldownTicks%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20Infinity%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20cooldownTime%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%2015e3%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20ms%0A%20%20%20%20onLoading%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default2%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onFinishLoading%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default3%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onUpdate%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default4%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onFinishUpdate%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default5%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onEngineTick%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default6%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onEngineStop%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default7%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20methods%3A%20%7B%0A%20%20%20%20refresh%3A%20function%20refresh%28state%29%20%7B%0A%20%20%20%20%20%20state._flushObjects%20%3D%20true%3B%0A%20%20%20%20%20%20state._rerender%28%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20Expose%20d3%20forces%20for%20external%20manipulation%0A%20%20%20%20d3Force%3A%20function%20d3Force%28state%2C%20forceName%2C%20forceFn%29%20%7B%0A%20%20%20%20%20%20if%20%28forceFn%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20state.d3ForceLayout.force%28forceName%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.d3ForceLayout.force%28forceName%2C%20forceFn%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20d3ReheatSimulation%3A%20function%20d3ReheatSimulation%28state%29%20%7B%0A%20%20%20%20%20%20state.d3ForceLayout.alpha%281%29%3B%0A%20%20%20%20%20%20this.resetCountdown%28%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20reset%20cooldown%20state%0A%20%20%20%20resetCountdown%3A%20function%20resetCountdown%28state%29%20%7B%0A%20%20%20%20%20%20state.cntTicks%20%3D%200%3B%0A%20%20%20%20%20%20state.startTickTime%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Date%28%29%3B%0A%20%20%20%20%20%20state.engineRunning%20%3D%20true%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20tickFrame%3A%20function%20tickFrame%28state%29%20%7B%0A%20%20%20%20%20%20var%20isD3Sim%20%3D%20state.forceEngine%20%21%3D%3D%20%22ngraph%22%3B%0A%20%20%20%20%20%20if%20%28state.engineRunning%29%20%7B%0A%20%20%20%20%20%20%20%20layoutTick%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20updateArrows%28%29%3B%0A%20%20%20%20%20%20updatePhotons%28%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20function%20layoutTick%28%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%2B%2Bstate.cntTicks%20%3E%20state.cooldownTicks%20%7C%7C%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Date%28%29%20-%20state.startTickTime%20%3E%20state.cooldownTime%20%7C%7C%20isD3Sim%20%26%26%20state.d3AlphaMin%20%3E%200%20%26%26%20state.d3ForceLayout.alpha%28%29%20%3C%20state.d3AlphaMin%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.engineRunning%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20state.onEngineStop%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.layout%5BisD3Sim%20%3F%20%22tick%22%20%3A%20%22step%22%5D%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.onEngineTick%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20nodeThreeObjectExtendAccessor%20%3D%20index3%28state.nodeThreeObjectExtend%29%3B%0A%20%20%20%20%20%20%20%20state.graphData.nodes.forEach%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20obj%20%3D%20node.__threeObj%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21obj%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20var%20pos%20%3D%20isD3Sim%20%3F%20node%20%3A%20state.layout.getNodePosition%28node%5Bstate.nodeId%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20extendedObj%20%3D%20nodeThreeObjectExtendAccessor%28node%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21state.nodePositionUpdate%20%7C%7C%20%21state.nodePositionUpdate%28extendedObj%20%3F%20obj.children%5B0%5D%20%3A%20obj%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20pos.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20pos.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20z%3A%20pos.z%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%20node%29%20%7C%7C%20extendedObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj.position.x%20%3D%20pos.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj.position.y%20%3D%20pos.y%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj.position.z%20%3D%20pos.z%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20var%20linkWidthAccessor%20%3D%20index3%28state.linkWidth%29%3B%0A%20%20%20%20%20%20%20%20var%20linkCurvatureAccessor%20%3D%20index3%28state.linkCurvature%29%3B%0A%20%20%20%20%20%20%20%20var%20linkCurveRotationAccessor%20%3D%20index3%28state.linkCurveRotation%29%3B%0A%20%20%20%20%20%20%20%20var%20linkThreeObjectExtendAccessor%20%3D%20index3%28state.linkThreeObjectExtend%29%3B%0A%20%20%20%20%20%20%20%20state.graphData.links.forEach%28function%28link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20lineObj%20%3D%20link.__lineObj%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21lineObj%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20var%20pos%20%3D%20isD3Sim%20%3F%20link%20%3A%20state.layout.getLinkPosition%28state.layout.graph.getLink%28link.source%2C%20link.target%29.id%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20start%20%3D%20pos%5BisD3Sim%20%3F%20%22source%22%20%3A%20%22from%22%5D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20end%20%3D%20pos%5BisD3Sim%20%3F%20%22target%22%20%3A%20%22to%22%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21start%20%7C%7C%20%21end%20%7C%7C%20%21start.hasOwnProperty%28%22x%22%29%20%7C%7C%20%21end.hasOwnProperty%28%22x%22%29%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20calcLinkCurve%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20extendedObj%20%3D%20linkThreeObjectExtendAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28state.linkPositionUpdate%20%26%26%20state.linkPositionUpdate%28%0A%20%20%20%20%20%20%20%20%20%20%20%20extendedObj%20%3F%20lineObj.children%5B1%5D%20%3A%20lineObj%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20pass%20child%20custom%20object%20if%20extending%20the%20default%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20start%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20start.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20start.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3A%20start.z%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20end%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20end.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20end.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3A%20end.z%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20link%0A%20%20%20%20%20%20%20%20%20%20%29%20%26%26%20%21extendedObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20curveResolution%20%3D%2030%3B%0A%20%20%20%20%20%20%20%20%20%20var%20curve%20%3D%20link.__curve%3B%0A%20%20%20%20%20%20%20%20%20%20var%20line%20%3D%20lineObj.children.length%20%3F%20lineObj.children%5B0%5D%20%3A%20lineObj%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28line.type%20%3D%3D%3D%20%22Line%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21curve%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20linePos%20%3D%20line.geometry.getAttribute%28%22position%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21linePos%20%7C%7C%20%21linePos.array%20%7C%7C%20linePos.array.length%20%21%3D%3D%206%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.geometry%5BsetAttributeFn%5D%28%22position%22%2C%20linePos%20%3D%20new%20three%241.BufferAttribute%28new%20Float32Array%282%20%2A%203%29%2C%203%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20linePos.array%5B0%5D%20%3D%20start.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20linePos.array%5B1%5D%20%3D%20start.y%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20linePos.array%5B2%5D%20%3D%20start.z%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20linePos.array%5B3%5D%20%3D%20end.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20linePos.array%5B4%5D%20%3D%20end.y%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20linePos.array%5B5%5D%20%3D%20end.z%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20linePos.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20curvePnts%20%3D%20curve.getPoints%28curveResolution%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28line.geometry.getAttribute%28%22position%22%29.array.length%20%21%3D%3D%20curvePnts.length%20%2A%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.geometry%5BsetAttributeFn%5D%28%22position%22%2C%20new%20three%241.BufferAttribute%28new%20Float32Array%28curvePnts.length%20%2A%203%29%2C%203%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.geometry.setFromPoints%28curvePnts%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20line.geometry.computeBoundingSphere%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28line.type%20%3D%3D%3D%20%22Mesh%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21curve%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21line.geometry.type.match%28%2F%5ECylinder%28Buffer%29%3FGeometry%24%2F%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20linkWidth%20%3D%20Math.ceil%28linkWidthAccessor%28link%29%20%2A%2010%29%20%2F%2010%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20r%20%3D%20linkWidth%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20geometry%20%3D%20new%20three%241.CylinderGeometry%28r%2C%20r%2C%201%2C%20state.linkResolution%2C%201%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20geometry%5BapplyMatrix4Fn%5D%28new%20three%241.Matrix4%28%29.makeTranslation%280%2C%201%20%2F%202%2C%200%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20geometry%5BapplyMatrix4Fn%5D%28new%20three%241.Matrix4%28%29.makeRotationX%28Math.PI%20%2F%202%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.geometry.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.geometry%20%3D%20geometry%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vStart%20%3D%20new%20three%241.Vector3%28start.x%2C%20start.y%20%7C%7C%200%2C%20start.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vEnd%20%3D%20new%20three%241.Vector3%28end.x%2C%20end.y%20%7C%7C%200%2C%20end.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20distance2%20%3D%20vStart.distanceTo%28vEnd%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.position.x%20%3D%20vStart.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.position.y%20%3D%20vStart.y%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.position.z%20%3D%20vStart.z%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.scale.z%20%3D%20distance2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.parent.localToWorld%28vEnd%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.lookAt%28vEnd%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21line.geometry.type.match%28%2F%5ETube%28Buffer%29%3FGeometry%24%2F%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.position.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.rotation.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.scale.set%281%2C%201%2C%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20_linkWidth%20%3D%20Math.ceil%28linkWidthAccessor%28link%29%20%2A%2010%29%20%2F%2010%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20_r%20%3D%20_linkWidth%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20_geometry3%20%3D%20new%20three%241.TubeGeometry%28curve%2C%20curveResolution%2C%20_r%2C%20state.linkResolution%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.geometry.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20line.geometry%20%3D%20_geometry3%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20function%20calcLinkCurve%28link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20pos%20%3D%20isD3Sim%20%3F%20link%20%3A%20state.layout.getLinkPosition%28state.layout.graph.getLink%28link.source%2C%20link.target%29.id%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20start%20%3D%20pos%5BisD3Sim%20%3F%20%22source%22%20%3A%20%22from%22%5D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20end%20%3D%20pos%5BisD3Sim%20%3F%20%22target%22%20%3A%20%22to%22%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21start%20%7C%7C%20%21end%20%7C%7C%20%21start.hasOwnProperty%28%22x%22%29%20%7C%7C%20%21end.hasOwnProperty%28%22x%22%29%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20var%20curvature%20%3D%20linkCurvatureAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21curvature%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20link.__curve%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20vStart%20%3D%20new%20three%241.Vector3%28start.x%2C%20start.y%20%7C%7C%200%2C%20start.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20vEnd%20%3D%20new%20three%241.Vector3%28end.x%2C%20end.y%20%7C%7C%200%2C%20end.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20l%20%3D%20vStart.distanceTo%28vEnd%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20curve%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20curveRotation%20%3D%20linkCurveRotationAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28l%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20dx%20%3D%20end.x%20-%20start.x%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20dy%20%3D%20end.y%20-%20start.y%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20vLine%20%3D%20new%20three%241.Vector3%28%29.subVectors%28vEnd%2C%20vStart%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20cp%20%3D%20vLine.clone%28%29.multiplyScalar%28curvature%29.cross%28dx%20%21%3D%3D%200%20%7C%7C%20dy%20%21%3D%3D%200%20%3F%20new%20three%241.Vector3%280%2C%200%2C%201%29%20%3A%20new%20three%241.Vector3%280%2C%201%2C%200%29%29.applyAxisAngle%28vLine.normalize%28%29%2C%20curveRotation%29.add%28new%20three%241.Vector3%28%29.addVectors%28vStart%2C%20vEnd%29.divideScalar%282%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20curve%20%3D%20new%20three%241.QuadraticBezierCurve3%28vStart%2C%20cp%2C%20vEnd%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20d%20%3D%20curvature%20%2A%2070%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20endAngle%20%3D%20-curveRotation%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20startAngle%20%3D%20endAngle%20%2B%20Math.PI%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20curve%20%3D%20new%20three%241.CubicBezierCurve3%28vStart%2C%20new%20three%241.Vector3%28d%20%2A%20Math.cos%28startAngle%29%2C%20d%20%2A%20Math.sin%28startAngle%29%2C%200%29.add%28vStart%29%2C%20new%20three%241.Vector3%28d%20%2A%20Math.cos%28endAngle%29%2C%20d%20%2A%20Math.sin%28endAngle%29%2C%200%29.add%28vStart%29%2C%20vEnd%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20link.__curve%20%3D%20curve%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20updateArrows%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20arrowRelPosAccessor%20%3D%20index3%28state.linkDirectionalArrowRelPos%29%3B%0A%20%20%20%20%20%20%20%20var%20arrowLengthAccessor%20%3D%20index3%28state.linkDirectionalArrowLength%29%3B%0A%20%20%20%20%20%20%20%20var%20nodeValAccessor%20%3D%20index3%28state.nodeVal%29%3B%0A%20%20%20%20%20%20%20%20state.graphData.links.forEach%28function%28link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20arrowObj%20%3D%20link.__arrowObj%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21arrowObj%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20var%20pos%20%3D%20isD3Sim%20%3F%20link%20%3A%20state.layout.getLinkPosition%28state.layout.graph.getLink%28link.source%2C%20link.target%29.id%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20start%20%3D%20pos%5BisD3Sim%20%3F%20%22source%22%20%3A%20%22from%22%5D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20end%20%3D%20pos%5BisD3Sim%20%3F%20%22target%22%20%3A%20%22to%22%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21start%20%7C%7C%20%21end%20%7C%7C%20%21start.hasOwnProperty%28%22x%22%29%20%7C%7C%20%21end.hasOwnProperty%28%22x%22%29%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20var%20startR%20%3D%20Math.cbrt%28Math.max%280%2C%20nodeValAccessor%28start%29%20%7C%7C%201%29%29%20%2A%20state.nodeRelSize%3B%0A%20%20%20%20%20%20%20%20%20%20var%20endR%20%3D%20Math.cbrt%28Math.max%280%2C%20nodeValAccessor%28end%29%20%7C%7C%201%29%29%20%2A%20state.nodeRelSize%3B%0A%20%20%20%20%20%20%20%20%20%20var%20arrowLength%20%3D%20arrowLengthAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20arrowRelPos%20%3D%20arrowRelPosAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20getPosAlongLine%20%3D%20link.__curve%20%3F%20function%28t%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20link.__curve.getPoint%28t%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20%3A%20function%28t%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20iplt%20%3D%20function%20iplt2%28dim%2C%20start2%2C%20end2%2C%20t2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20start2%5Bdim%5D%20%2B%20%28end2%5Bdim%5D%20-%20start2%5Bdim%5D%29%20%2A%20t2%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20iplt%28%22x%22%2C%20start%2C%20end%2C%20t%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20iplt%28%22y%22%2C%20start%2C%20end%2C%20t%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3A%20iplt%28%22z%22%2C%20start%2C%20end%2C%20t%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20lineLen%20%3D%20link.__curve%20%3F%20link.__curve.getLength%28%29%20%3A%20Math.sqrt%28%5B%22x%22%2C%20%22y%22%2C%20%22z%22%5D.map%28function%28dim%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20Math.pow%28%28end%5Bdim%5D%20%7C%7C%200%29%20-%20%28start%5Bdim%5D%20%7C%7C%200%29%2C%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29.reduce%28function%28acc%2C%20v%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20acc%20%2B%20v%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%200%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20posAlongLine%20%3D%20startR%20%2B%20arrowLength%20%2B%20%28lineLen%20-%20startR%20-%20endR%20-%20arrowLength%29%20%2A%20arrowRelPos%3B%0A%20%20%20%20%20%20%20%20%20%20var%20arrowHead%20%3D%20getPosAlongLine%28posAlongLine%20%2F%20lineLen%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20arrowTail%20%3D%20getPosAlongLine%28%28posAlongLine%20-%20arrowLength%29%20%2F%20lineLen%29%3B%0A%20%20%20%20%20%20%20%20%20%20%5B%22x%22%2C%20%22y%22%2C%20%22z%22%5D.forEach%28function%28dim%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20arrowObj.position%5Bdim%5D%20%3D%20arrowTail%5Bdim%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20headVec%20%3D%20_construct%28three%241.Vector3%2C%20_toConsumableArray3%28%5B%22x%22%2C%20%22y%22%2C%20%22z%22%5D.map%28function%28c2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20arrowHead%5Bc2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20arrowObj.parent.localToWorld%28headVec%29%3B%0A%20%20%20%20%20%20%20%20%20%20arrowObj.lookAt%28headVec%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20updatePhotons%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20particleSpeedAccessor%20%3D%20index3%28state.linkDirectionalParticleSpeed%29%3B%0A%20%20%20%20%20%20%20%20state.graphData.links.forEach%28function%28link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20cyclePhotons%20%3D%20link.__photonsObj%20%26%26%20link.__photonsObj.children%3B%0A%20%20%20%20%20%20%20%20%20%20var%20singleHopPhotons%20%3D%20link.__singleHopPhotonsObj%20%26%26%20link.__singleHopPhotonsObj.children%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%28%21singleHopPhotons%20%7C%7C%20%21singleHopPhotons.length%29%20%26%26%20%28%21cyclePhotons%20%7C%7C%20%21cyclePhotons.length%29%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20var%20pos%20%3D%20isD3Sim%20%3F%20link%20%3A%20state.layout.getLinkPosition%28state.layout.graph.getLink%28link.source%2C%20link.target%29.id%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20start%20%3D%20pos%5BisD3Sim%20%3F%20%22source%22%20%3A%20%22from%22%5D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20end%20%3D%20pos%5BisD3Sim%20%3F%20%22target%22%20%3A%20%22to%22%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21start%20%7C%7C%20%21end%20%7C%7C%20%21start.hasOwnProperty%28%22x%22%29%20%7C%7C%20%21end.hasOwnProperty%28%22x%22%29%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20var%20particleSpeed%20%3D%20particleSpeedAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20getPhotonPos%20%3D%20link.__curve%20%3F%20function%28t%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20link.__curve.getPoint%28t%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20%3A%20function%28t%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20iplt%20%3D%20function%20iplt2%28dim%2C%20start2%2C%20end2%2C%20t2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20start2%5Bdim%5D%20%2B%20%28end2%5Bdim%5D%20-%20start2%5Bdim%5D%29%20%2A%20t2%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20iplt%28%22x%22%2C%20start%2C%20end%2C%20t%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20iplt%28%22y%22%2C%20start%2C%20end%2C%20t%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3A%20iplt%28%22z%22%2C%20start%2C%20end%2C%20t%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20photons%20%3D%20%5B%5D.concat%28_toConsumableArray3%28cyclePhotons%20%7C%7C%20%5B%5D%29%2C%20_toConsumableArray3%28singleHopPhotons%20%7C%7C%20%5B%5D%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20photons.forEach%28function%28photon%2C%20idx%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20singleHop%20%3D%20photon.parent.__linkThreeObjType%20%3D%3D%3D%20%22singleHopPhotons%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21photon.hasOwnProperty%28%22__progressRatio%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20photon.__progressRatio%20%3D%20singleHop%20%3F%200%20%3A%20idx%20%2F%20cyclePhotons.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20photon.__progressRatio%20%2B%3D%20particleSpeed%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28photon.__progressRatio%20%3E%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21singleHop%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20photon.__progressRatio%20%3D%20photon.__progressRatio%20%25%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20photon.parent.remove%28photon%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20emptyObject%28photon%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20photonPosRatio%20%3D%20photon.__progressRatio%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20pos2%20%3D%20getPhotonPos%28photonPosRatio%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%22x%22%2C%20%22y%22%2C%20%22z%22%5D.forEach%28function%28dim%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20photon.position%5Bdim%5D%20%3D%20pos2%5Bdim%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20emitParticle%3A%20function%20emitParticle%28state%2C%20link%29%20%7B%0A%20%20%20%20%20%20if%20%28link%20%26%26%20state.graphData.links.includes%28link%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21link.__singleHopPhotonsObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20obj%20%3D%20new%20three%241.Group%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20obj.__linkThreeObjType%20%3D%20%22singleHopPhotons%22%3B%0A%20%20%20%20%20%20%20%20%20%20link.__singleHopPhotonsObj%20%3D%20obj%3B%0A%20%20%20%20%20%20%20%20%20%20state.graphScene.add%28obj%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20particleWidthAccessor%20%3D%20index3%28state.linkDirectionalParticleWidth%29%3B%0A%20%20%20%20%20%20%20%20var%20photonR%20%3D%20Math.ceil%28particleWidthAccessor%28link%29%20%2A%2010%29%20%2F%2010%20%2F%202%3B%0A%20%20%20%20%20%20%20%20var%20numSegments%20%3D%20state.linkDirectionalParticleResolution%3B%0A%20%20%20%20%20%20%20%20var%20particleGeometry%20%3D%20new%20three%241.SphereGeometry%28photonR%2C%20numSegments%2C%20numSegments%29%3B%0A%20%20%20%20%20%20%20%20var%20linkColorAccessor%20%3D%20index3%28state.linkColor%29%3B%0A%20%20%20%20%20%20%20%20var%20particleColorAccessor%20%3D%20index3%28state.linkDirectionalParticleColor%29%3B%0A%20%20%20%20%20%20%20%20var%20photonColor%20%3D%20particleColorAccessor%28link%29%20%7C%7C%20linkColorAccessor%28link%29%20%7C%7C%20%22%23f0f0f0%22%3B%0A%20%20%20%20%20%20%20%20var%20materialColor2%20%3D%20new%20three%241.Color%28colorStr2Hex%28photonColor%29%29%3B%0A%20%20%20%20%20%20%20%20var%20opacity%20%3D%20state.linkOpacity%20%2A%203%3B%0A%20%20%20%20%20%20%20%20var%20particleMaterial%20%3D%20new%20three%241.MeshLambertMaterial%28%7B%0A%20%20%20%20%20%20%20%20%20%20color%3A%20materialColor2%2C%0A%20%20%20%20%20%20%20%20%20%20transparent%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20opacity%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20link.__singleHopPhotonsObj.add%28new%20three%241.Mesh%28particleGeometry%2C%20particleMaterial%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20getGraphBbox%3A%20function%20getGraphBbox%28state%29%20%7B%0A%20%20%20%20%20%20var%20nodeFilter%20%3D%20arguments.length%20%3E%201%20%26%26%20arguments%5B1%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B1%5D%20%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20if%20%28%21state.initialised%29%20return%20null%3B%0A%20%20%20%20%20%20var%20bboxes%20%3D%20function%20getBboxes%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20var%20bboxes2%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28obj.geometry%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20obj.geometry.computeBoundingBox%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20box%20%3D%20new%20three%241.Box3%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20box.copy%28obj.geometry.boundingBox%29.applyMatrix4%28obj.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20%20%20bboxes2.push%28box%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20bboxes2.concat.apply%28bboxes2%2C%20_toConsumableArray3%28%28obj.children%20%7C%7C%20%5B%5D%29.filter%28%0A%20%20%20%20%20%20%20%20%20%20function%28obj2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%21obj2.hasOwnProperty%28%22__graphObjType%22%29%20%7C%7C%20obj2.__graphObjType%20%3D%3D%3D%20%22node%22%20%26%26%20nodeFilter%28obj2.__data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20exclude%20filtered%20out%20nodes%0A%20%20%20%20%20%20%20%20%29.map%28getBboxes%29%29%29%3B%0A%20%20%20%20%20%20%7D%28state.graphScene%29%3B%0A%20%20%20%20%20%20if%20%28%21bboxes.length%29%20return%20null%3B%0A%20%20%20%20%20%20return%20Object.assign.apply%28Object%2C%20_toConsumableArray3%28%5B%22x%22%2C%20%22y%22%2C%20%22z%22%5D.map%28function%28c2%29%20%7B%0A%20%20%20%20%20%20%20%20return%20_defineProperty2%28%7B%7D%2C%20c2%2C%20%5Bmin%28bboxes%2C%20function%28bb%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20bb.min%5Bc2%5D%3B%0A%20%20%20%20%20%20%20%20%7D%29%2C%20max%28bboxes%2C%20function%28bb%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20bb.max%5Bc2%5D%3B%0A%20%20%20%20%20%20%20%20%7D%29%5D%29%3B%0A%20%20%20%20%20%20%7D%29%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20stateInit%3A%20function%20stateInit%28%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20d3ForceLayout%3A%20simulation_default%28%29.force%28%22link%22%2C%20link_default%28%29%29.force%28%22charge%22%2C%20manyBody_default%28%29%29.force%28%22center%22%2C%20center_default%28%29%29.force%28%22dagRadial%22%2C%20null%29.stop%28%29%2C%0A%20%20%20%20%20%20engineRunning%3A%20false%0A%20%20%20%20%7D%3B%0A%20%20%7D%2C%0A%20%20init%3A%20function%20init%28threeObj%2C%20state%29%20%7B%0A%20%20%20%20state.graphScene%20%3D%20threeObj%3B%0A%20%20%7D%2C%0A%20%20update%3A%20function%20update%28state%2C%20changedProps%29%20%7B%0A%20%20%20%20var%20hasAnyPropChanged%20%3D%20function%20hasAnyPropChanged2%28propList%29%20%7B%0A%20%20%20%20%20%20return%20propList.some%28function%28p%29%20%7B%0A%20%20%20%20%20%20%20%20return%20changedProps.hasOwnProperty%28p%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20state.engineRunning%20%3D%20false%3B%0A%20%20%20%20state.onUpdate%28%29%3B%0A%20%20%20%20if%20%28state.nodeAutoColorBy%20%21%3D%3D%20null%20%26%26%20hasAnyPropChanged%28%5B%22nodeAutoColorBy%22%2C%20%22graphData%22%2C%20%22nodeColor%22%5D%29%29%20%7B%0A%20%20%20%20%20%20autoColorObjects%28state.graphData.nodes%2C%20index3%28state.nodeAutoColorBy%29%2C%20state.nodeColor%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28state.linkAutoColorBy%20%21%3D%3D%20null%20%26%26%20hasAnyPropChanged%28%5B%22linkAutoColorBy%22%2C%20%22graphData%22%2C%20%22linkColor%22%5D%29%29%20%7B%0A%20%20%20%20%20%20autoColorObjects%28state.graphData.links%2C%20index3%28state.linkAutoColorBy%29%2C%20state.linkColor%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28state._flushObjects%20%7C%7C%20hasAnyPropChanged%28%5B%22graphData%22%2C%20%22nodeThreeObject%22%2C%20%22nodeThreeObjectExtend%22%2C%20%22nodeVal%22%2C%20%22nodeColor%22%2C%20%22nodeVisibility%22%2C%20%22nodeRelSize%22%2C%20%22nodeResolution%22%2C%20%22nodeOpacity%22%5D%29%29%20%7B%0A%20%20%20%20%20%20var%20customObjectAccessor%20%3D%20index3%28state.nodeThreeObject%29%3B%0A%20%20%20%20%20%20var%20customObjectExtendAccessor%20%3D%20index3%28state.nodeThreeObjectExtend%29%3B%0A%20%20%20%20%20%20var%20valAccessor%20%3D%20index3%28state.nodeVal%29%3B%0A%20%20%20%20%20%20var%20colorAccessor%20%3D%20index3%28state.nodeColor%29%3B%0A%20%20%20%20%20%20var%20visibilityAccessor%20%3D%20index3%28state.nodeVisibility%29%3B%0A%20%20%20%20%20%20var%20sphereGeometries%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20var%20sphereMaterials%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20threeDigest%28state.graphData.nodes.filter%28visibilityAccessor%29%2C%20state.graphScene%2C%20%7B%0A%20%20%20%20%20%20%20%20purge%3A%20state._flushObjects%20%7C%7C%20hasAnyPropChanged%28%5B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20recreate%20objects%20if%20any%20of%20these%20props%20have%20changed%0A%20%20%20%20%20%20%20%20%20%20%22nodeThreeObject%22%2C%0A%20%20%20%20%20%20%20%20%20%20%22nodeThreeObjectExtend%22%0A%20%20%20%20%20%20%20%20%5D%29%2C%0A%20%20%20%20%20%20%20%20objFilter%3A%20function%20objFilter%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20obj.__graphObjType%20%3D%3D%3D%20%22node%22%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20createObj%3A%20function%20createObj%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20customObj%20%3D%20customObjectAccessor%28node%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20extendObj%20%3D%20customObjectExtendAccessor%28node%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28customObj%20%26%26%20state.nodeThreeObject%20%3D%3D%3D%20customObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20customObj%20%3D%20customObj.clone%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20obj%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28customObj%20%26%26%20%21extendObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj%20%3D%20customObj%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj%20%3D%20new%20three%241.Mesh%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj.__graphDefaultObj%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28customObj%20%26%26%20extendObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.add%28customObj%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20obj.__graphObjType%20%3D%20%22node%22%3B%0A%20%20%20%20%20%20%20%20%20%20return%20obj%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20updateObj%3A%20function%20updateObj%28obj%2C%20node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28obj.__graphDefaultObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20val%20%3D%20valAccessor%28node%29%20%7C%7C%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20radius%20%3D%20Math.cbrt%28val%29%20%2A%20state.nodeRelSize%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20numSegments%20%3D%20state.nodeResolution%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21obj.geometry.type.match%28%2F%5ESphere%28Buffer%29%3FGeometry%24%2F%29%20%7C%7C%20obj.geometry.parameters.radius%20%21%3D%3D%20radius%20%7C%7C%20obj.geometry.parameters.widthSegments%20%21%3D%3D%20numSegments%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21sphereGeometries.hasOwnProperty%28val%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sphereGeometries%5Bval%5D%20%3D%20new%20three%241.SphereGeometry%28radius%2C%20numSegments%2C%20numSegments%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.geometry.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.geometry%20%3D%20sphereGeometries%5Bval%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20color2%20%3D%20colorAccessor%28node%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20materialColor2%20%3D%20new%20three%241.Color%28colorStr2Hex%28color2%20%7C%7C%20%22%23ffffaa%22%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20opacity%20%3D%20state.nodeOpacity%20%2A%20colorAlpha%28color2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28obj.material.type%20%21%3D%3D%20%22MeshLambertMaterial%22%20%7C%7C%20%21obj.material.color.equals%28materialColor2%29%20%7C%7C%20obj.material.opacity%20%21%3D%3D%20opacity%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21sphereMaterials.hasOwnProperty%28color2%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sphereMaterials%5Bcolor2%5D%20%3D%20new%20three%241.MeshLambertMaterial%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20materialColor2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transparent%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.material.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.material%20%3D%20sphereMaterials%5Bcolor2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28state._flushObjects%20%7C%7C%20hasAnyPropChanged%28%5B%22graphData%22%2C%20%22linkThreeObject%22%2C%20%22linkThreeObjectExtend%22%2C%20%22linkMaterial%22%2C%20%22linkColor%22%2C%20%22linkWidth%22%2C%20%22linkVisibility%22%2C%20%22linkResolution%22%2C%20%22linkOpacity%22%2C%20%22linkDirectionalArrowLength%22%2C%20%22linkDirectionalArrowColor%22%2C%20%22linkDirectionalArrowResolution%22%2C%20%22linkDirectionalParticles%22%2C%20%22linkDirectionalParticleWidth%22%2C%20%22linkDirectionalParticleColor%22%2C%20%22linkDirectionalParticleResolution%22%5D%29%29%20%7B%0A%20%20%20%20%20%20var%20_customObjectAccessor%20%3D%20index3%28state.linkThreeObject%29%3B%0A%20%20%20%20%20%20var%20_customObjectExtendAccessor%20%3D%20index3%28state.linkThreeObjectExtend%29%3B%0A%20%20%20%20%20%20var%20customMaterialAccessor%20%3D%20index3%28state.linkMaterial%29%3B%0A%20%20%20%20%20%20var%20_visibilityAccessor%20%3D%20index3%28state.linkVisibility%29%3B%0A%20%20%20%20%20%20var%20_colorAccessor%20%3D%20index3%28state.linkColor%29%3B%0A%20%20%20%20%20%20var%20widthAccessor%20%3D%20index3%28state.linkWidth%29%3B%0A%20%20%20%20%20%20var%20cylinderGeometries%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20var%20lambertLineMaterials%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20var%20basicLineMaterials%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20var%20visibleLinks%20%3D%20state.graphData.links.filter%28_visibilityAccessor%29%3B%0A%20%20%20%20%20%20threeDigest%28visibleLinks%2C%20state.graphScene%2C%20%7B%0A%20%20%20%20%20%20%20%20objBindAttr%3A%20%22__lineObj%22%2C%0A%20%20%20%20%20%20%20%20purge%3A%20state._flushObjects%20%7C%7C%20hasAnyPropChanged%28%5B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20recreate%20objects%20if%20any%20of%20these%20props%20have%20changed%0A%20%20%20%20%20%20%20%20%20%20%22linkThreeObject%22%2C%0A%20%20%20%20%20%20%20%20%20%20%22linkThreeObjectExtend%22%2C%0A%20%20%20%20%20%20%20%20%20%20%22linkWidth%22%0A%20%20%20%20%20%20%20%20%5D%29%2C%0A%20%20%20%20%20%20%20%20objFilter%3A%20function%20objFilter%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20obj.__graphObjType%20%3D%3D%3D%20%22link%22%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20exitObj%3A%20function%20exitObj%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20singlePhotonsObj%20%3D%20obj.__data%20%26%26%20obj.__data.__singleHopPhotonsObj%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28singlePhotonsObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20singlePhotonsObj.parent.remove%28singlePhotonsObj%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20emptyObject%28singlePhotonsObj%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20delete%20obj.__data.__singleHopPhotonsObj%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20createObj%3A%20function%20createObj%28link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20customObj%20%3D%20_customObjectAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20extendObj%20%3D%20_customObjectExtendAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28customObj%20%26%26%20state.linkThreeObject%20%3D%3D%3D%20customObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20customObj%20%3D%20customObj.clone%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20defaultObj%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21customObj%20%7C%7C%20extendObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20useCylinder%20%3D%20%21%21widthAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useCylinder%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20defaultObj%20%3D%20new%20three%241.Mesh%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20lineGeometry%20%3D%20new%20three%241.BufferGeometry%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20lineGeometry%5BsetAttributeFn%5D%28%22position%22%2C%20new%20three%241.BufferAttribute%28new%20Float32Array%282%20%2A%203%29%2C%203%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20defaultObj%20%3D%20new%20three%241.Line%28lineGeometry%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20obj%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21customObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj%20%3D%20defaultObj%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj.__graphDefaultObj%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21extendObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj%20%3D%20customObj%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj%20%3D%20new%20three%241.Group%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.__graphDefaultObj%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.add%28defaultObj%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.add%28customObj%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20obj.renderOrder%20%3D%2010%3B%0A%20%20%20%20%20%20%20%20%20%20obj.__graphObjType%20%3D%20%22link%22%3B%0A%20%20%20%20%20%20%20%20%20%20return%20obj%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20updateObj%3A%20function%20updateObj%28updObj%2C%20link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28updObj.__graphDefaultObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20obj%20%3D%20updObj.children.length%20%3F%20updObj.children%5B0%5D%20%3A%20updObj%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20linkWidth%20%3D%20Math.ceil%28widthAccessor%28link%29%20%2A%2010%29%20%2F%2010%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20useCylinder%20%3D%20%21%21linkWidth%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28useCylinder%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20r%20%3D%20linkWidth%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20numSegments%20%3D%20state.linkResolution%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21obj.geometry.type.match%28%2F%5ECylinder%28Buffer%29%3FGeometry%24%2F%29%20%7C%7C%20obj.geometry.parameters.radiusTop%20%21%3D%3D%20r%20%7C%7C%20obj.geometry.parameters.radialSegments%20%21%3D%3D%20numSegments%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21cylinderGeometries.hasOwnProperty%28linkWidth%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20geometry%20%3D%20new%20three%241.CylinderGeometry%28r%2C%20r%2C%201%2C%20numSegments%2C%201%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20geometry%5BapplyMatrix4Fn%5D%28new%20three%241.Matrix4%28%29.makeTranslation%280%2C%201%20%2F%202%2C%200%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20geometry%5BapplyMatrix4Fn%5D%28new%20three%241.Matrix4%28%29.makeRotationX%28Math.PI%20%2F%202%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cylinderGeometries%5BlinkWidth%5D%20%3D%20geometry%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.geometry.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.geometry%20%3D%20cylinderGeometries%5BlinkWidth%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20customMaterial%20%3D%20customMaterialAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28customMaterial%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.material%20%3D%20customMaterial%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20color2%20%3D%20_colorAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20materialColor2%20%3D%20new%20three%241.Color%28colorStr2Hex%28color2%20%7C%7C%20%22%23f0f0f0%22%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20opacity%20%3D%20state.linkOpacity%20%2A%20colorAlpha%28color2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20materialType%20%3D%20useCylinder%20%3F%20%22MeshLambertMaterial%22%20%3A%20%22LineBasicMaterial%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28obj.material.type%20%21%3D%3D%20materialType%20%7C%7C%20%21obj.material.color.equals%28materialColor2%29%20%7C%7C%20obj.material.opacity%20%21%3D%3D%20opacity%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20lineMaterials%20%3D%20useCylinder%20%3F%20lambertLineMaterials%20%3A%20basicLineMaterials%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21lineMaterials.hasOwnProperty%28color2%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lineMaterials%5Bcolor2%5D%20%3D%20new%20three%241%5BmaterialType%5D%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20materialColor2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transparent%3A%20opacity%20%3C%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20depthWrite%3A%20opacity%20%3E%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Prevent%20transparency%20issues%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.material.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.material%20%3D%20lineMaterials%5Bcolor2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20if%20%28state.linkDirectionalArrowLength%20%7C%7C%20changedProps.hasOwnProperty%28%22linkDirectionalArrowLength%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20var%20arrowLengthAccessor%20%3D%20index3%28state.linkDirectionalArrowLength%29%3B%0A%20%20%20%20%20%20%20%20var%20arrowColorAccessor%20%3D%20index3%28state.linkDirectionalArrowColor%29%3B%0A%20%20%20%20%20%20%20%20threeDigest%28visibleLinks.filter%28arrowLengthAccessor%29%2C%20state.graphScene%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20objBindAttr%3A%20%22__arrowObj%22%2C%0A%20%20%20%20%20%20%20%20%20%20objFilter%3A%20function%20objFilter%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20obj.__linkThreeObjType%20%3D%3D%3D%20%22arrow%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20createObj%3A%20function%20createObj%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20obj%20%3D%20new%20three%241.Mesh%28void%200%2C%20new%20three%241.MeshLambertMaterial%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20transparent%3A%20true%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj.__linkThreeObjType%20%3D%20%22arrow%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20obj%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20updateObj%3A%20function%20updateObj%28obj%2C%20link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20arrowLength%20%3D%20arrowLengthAccessor%28link%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20numSegments%20%3D%20state.linkDirectionalArrowResolution%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21obj.geometry.type.match%28%2F%5ECone%28Buffer%29%3FGeometry%24%2F%29%20%7C%7C%20obj.geometry.parameters.height%20%21%3D%3D%20arrowLength%20%7C%7C%20obj.geometry.parameters.radialSegments%20%21%3D%3D%20numSegments%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20coneGeometry%20%3D%20new%20three%241.ConeGeometry%28arrowLength%20%2A%200.25%2C%20arrowLength%2C%20numSegments%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20coneGeometry.translate%280%2C%20arrowLength%20%2F%202%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20coneGeometry.rotateX%28Math.PI%20%2F%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.geometry.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.geometry%20%3D%20coneGeometry%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20arrowColor%20%3D%20arrowColorAccessor%28link%29%20%7C%7C%20_colorAccessor%28link%29%20%7C%7C%20%22%23f0f0f0%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj.material.color%20%3D%20new%20three%241.Color%28colorStr2Hex%28arrowColor%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj.material.opacity%20%3D%20state.linkOpacity%20%2A%203%20%2A%20colorAlpha%28arrowColor%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28state.linkDirectionalParticles%20%7C%7C%20changedProps.hasOwnProperty%28%22linkDirectionalParticles%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20var%20particlesAccessor%20%3D%20index3%28state.linkDirectionalParticles%29%3B%0A%20%20%20%20%20%20%20%20var%20particleWidthAccessor%20%3D%20index3%28state.linkDirectionalParticleWidth%29%3B%0A%20%20%20%20%20%20%20%20var%20particleColorAccessor%20%3D%20index3%28state.linkDirectionalParticleColor%29%3B%0A%20%20%20%20%20%20%20%20var%20particleMaterials%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20var%20particleGeometries%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20threeDigest%28visibleLinks.filter%28particlesAccessor%29%2C%20state.graphScene%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20objBindAttr%3A%20%22__photonsObj%22%2C%0A%20%20%20%20%20%20%20%20%20%20objFilter%3A%20function%20objFilter%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20obj.__linkThreeObjType%20%3D%3D%3D%20%22photons%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20createObj%3A%20function%20createObj%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20obj%20%3D%20new%20three%241.Group%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20obj.__linkThreeObjType%20%3D%20%22photons%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20obj%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20updateObj%3A%20function%20updateObj%28obj%2C%20link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20numPhotons%20%3D%20Math.round%28Math.abs%28particlesAccessor%28link%29%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20curPhoton%20%3D%20%21%21obj.children.length%20%26%26%20obj.children%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20photonR%20%3D%20Math.ceil%28particleWidthAccessor%28link%29%20%2A%2010%29%20%2F%2010%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20numSegments%20%3D%20state.linkDirectionalParticleResolution%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20particleGeometry%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28curPhoton%20%26%26%20curPhoton.geometry.parameters.radius%20%3D%3D%3D%20photonR%20%26%26%20curPhoton.geometry.parameters.widthSegments%20%3D%3D%3D%20numSegments%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20particleGeometry%20%3D%20curPhoton.geometry%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21particleGeometries.hasOwnProperty%28photonR%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20particleGeometries%5BphotonR%5D%20%3D%20new%20three%241.SphereGeometry%28photonR%2C%20numSegments%2C%20numSegments%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20particleGeometry%20%3D%20particleGeometries%5BphotonR%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20curPhoton%20%26%26%20curPhoton.geometry.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20photonColor%20%3D%20particleColorAccessor%28link%29%20%7C%7C%20_colorAccessor%28link%29%20%7C%7C%20%22%23f0f0f0%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20materialColor2%20%3D%20new%20three%241.Color%28colorStr2Hex%28photonColor%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20opacity%20%3D%20state.linkOpacity%20%2A%203%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20particleMaterial%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28curPhoton%20%26%26%20curPhoton.material.color.equals%28materialColor2%29%20%26%26%20curPhoton.material.opacity%20%3D%3D%3D%20opacity%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20particleMaterial%20%3D%20curPhoton.material%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21particleMaterials.hasOwnProperty%28photonColor%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20particleMaterials%5BphotonColor%5D%20%3D%20new%20three%241.MeshLambertMaterial%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20materialColor2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20transparent%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20particleMaterial%20%3D%20particleMaterials%5BphotonColor%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20curPhoton%20%26%26%20curPhoton.material.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20threeDigest%28_toConsumableArray3%28new%20Array%28numPhotons%29%29.map%28function%28_%2C%20idx%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20idx%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%2C%20obj%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20idAccessor%3A%20function%20idAccessor%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20d.idx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20createObj%3A%20function%20createObj%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20new%20three%241.Mesh%28particleGeometry%2C%20particleMaterial%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20updateObj%3A%20function%20updateObj2%28obj2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj2.geometry%20%3D%20particleGeometry%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj2.material%20%3D%20particleMaterial%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20state._flushObjects%20%3D%20false%3B%0A%20%20%20%20if%20%28hasAnyPropChanged%28%5B%22graphData%22%2C%20%22nodeId%22%2C%20%22linkSource%22%2C%20%22linkTarget%22%2C%20%22numDimensions%22%2C%20%22forceEngine%22%2C%20%22dagMode%22%2C%20%22dagNodeFilter%22%2C%20%22dagLevelDistance%22%5D%29%29%20%7B%0A%20%20%20%20%20%20state.engineRunning%20%3D%20false%3B%0A%20%20%20%20%20%20state.graphData.links.forEach%28function%28link%29%20%7B%0A%20%20%20%20%20%20%20%20link.source%20%3D%20link%5Bstate.linkSource%5D%3B%0A%20%20%20%20%20%20%20%20link.target%20%3D%20link%5Bstate.linkTarget%5D%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20var%20isD3Sim%20%3D%20state.forceEngine%20%21%3D%3D%20%22ngraph%22%3B%0A%20%20%20%20%20%20var%20layout%3B%0A%20%20%20%20%20%20if%20%28isD3Sim%29%20%7B%0A%20%20%20%20%20%20%20%20%28layout%20%3D%20state.d3ForceLayout%29.stop%28%29.alpha%281%29.numDimensions%28state.numDimensions%29.nodes%28state.graphData.nodes%29%3B%0A%20%20%20%20%20%20%20%20var%20linkForce%20%3D%20state.d3ForceLayout.force%28%22link%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28linkForce%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20linkForce.id%28function%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20d%5Bstate.nodeId%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29.links%28state.graphData.links%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20nodeDepths%20%3D%20state.dagMode%20%26%26%20getDagDepths%28state.graphData%2C%20function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20node%5Bstate.nodeId%5D%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20nodeFilter%3A%20state.dagNodeFilter%2C%0A%20%20%20%20%20%20%20%20%20%20onLoopError%3A%20state.onDagError%20%7C%7C%20void%200%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20var%20maxDepth%20%3D%20Math.max.apply%28Math%2C%20_toConsumableArray3%28Object.values%28nodeDepths%20%7C%7C%20%5B%5D%29%29%29%3B%0A%20%20%20%20%20%20%20%20var%20dagLevelDistance%20%3D%20state.dagLevelDistance%20%7C%7C%20state.graphData.nodes.length%20%2F%20%28maxDepth%20%7C%7C%201%29%20%2A%20DAG_LEVEL_NODE_RATIO%20%2A%20%28%5B%22radialin%22%2C%20%22radialout%22%5D.indexOf%28state.dagMode%29%20%21%3D%3D%20-1%20%3F%200.7%20%3A%201%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%5B%22lr%22%2C%20%22rl%22%2C%20%22td%22%2C%20%22bu%22%2C%20%22zin%22%2C%20%22zout%22%5D.includes%28changedProps.dagMode%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20resetProp%20%3D%20%5B%22lr%22%2C%20%22rl%22%5D.includes%28changedProps.dagMode%29%20%3F%20%22fx%22%20%3A%20%5B%22td%22%2C%20%22bu%22%5D.includes%28changedProps.dagMode%29%20%3F%20%22fy%22%20%3A%20%22fz%22%3B%0A%20%20%20%20%20%20%20%20%20%20state.graphData.nodes.filter%28state.dagNodeFilter%29.forEach%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20delete%20node%5BresetProp%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%5B%22lr%22%2C%20%22rl%22%2C%20%22td%22%2C%20%22bu%22%2C%20%22zin%22%2C%20%22zout%22%5D.includes%28state.dagMode%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20invert%20%3D%20%5B%22rl%22%2C%20%22td%22%2C%20%22zout%22%5D.includes%28state.dagMode%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20fixFn%20%3D%20function%20fixFn2%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%28nodeDepths%5Bnode%5Bstate.nodeId%5D%5D%20-%20maxDepth%20%2F%202%29%20%2A%20dagLevelDistance%20%2A%20%28invert%20%3F%20-1%20%3A%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20_resetProp%20%3D%20%5B%22lr%22%2C%20%22rl%22%5D.includes%28state.dagMode%29%20%3F%20%22fx%22%20%3A%20%5B%22td%22%2C%20%22bu%22%5D.includes%28state.dagMode%29%20%3F%20%22fy%22%20%3A%20%22fz%22%3B%0A%20%20%20%20%20%20%20%20%20%20state.graphData.nodes.filter%28state.dagNodeFilter%29.forEach%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20node%5B_resetProp%5D%20%3D%20fixFn%28node%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.d3ForceLayout.force%28%22dagRadial%22%2C%20%5B%22radialin%22%2C%20%22radialout%22%5D.indexOf%28state.dagMode%29%20%21%3D%3D%20-1%20%3F%20radial_default%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20nodeDepth%20%3D%20nodeDepths%5Bnode%5Bstate.nodeId%5D%5D%20%7C%7C%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20return%20%28state.dagMode%20%3D%3D%3D%20%22radialin%22%20%3F%20maxDepth%20-%20nodeDepth%20%3A%20nodeDepth%29%20%2A%20dagLevelDistance%3B%0A%20%20%20%20%20%20%20%20%7D%29.strength%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20state.dagNodeFilter%28node%29%20%3F%201%20%3A%200%3B%0A%20%20%20%20%20%20%20%20%7D%29%20%3A%20null%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20var%20_graph%20%3D%20ngraph.graph%28%29%3B%0A%20%20%20%20%20%20%20%20state.graphData.nodes.forEach%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_graph.addNode%28node%5Bstate.nodeId%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20state.graphData.links.forEach%28function%28link%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_graph.addLink%28link.source%2C%20link.target%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20layout%20%3D%20ngraph.forcelayout%28_graph%2C%20_objectSpread22%28%7B%0A%20%20%20%20%20%20%20%20%20%20dimensions%3A%20state.numDimensions%0A%20%20%20%20%20%20%20%20%7D%2C%20state.ngraphPhysics%29%29%3B%0A%20%20%20%20%20%20%20%20layout.graph%20%3D%20_graph%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20state.warmupTicks%20%26%26%20%21%28isD3Sim%20%26%26%20state.d3AlphaMin%20%3E%200%20%26%26%20state.d3ForceLayout.alpha%28%29%20%3C%20state.d3AlphaMin%29%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20layout%5BisD3Sim%20%3F%20%22tick%22%20%3A%20%22step%22%5D%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.layout%20%3D%20layout%3B%0A%20%20%20%20%20%20this.resetCountdown%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.engineRunning%20%3D%20true%3B%0A%20%20%20%20state.onFinishUpdate%28%29%3B%0A%20%20%7D%0A%7D%29%3B%0Afunction%20fromKapsule%28kapsule%29%20%7B%0A%20%20var%20baseClass%20%3D%20arguments.length%20%3E%201%20%26%26%20arguments%5B1%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B1%5D%20%3A%20Object%3B%0A%20%20var%20initKapsuleWithSelf%20%3D%20arguments.length%20%3E%202%20%26%26%20arguments%5B2%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B2%5D%20%3A%20false%3B%0A%20%20var%20FromKapsule%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20function%28_baseClass%29%20%7B%0A%20%20%20%20function%20FromKapsule2%28%29%20%7B%0A%20%20%20%20%20%20var%20_this%3B%0A%20%20%20%20%20%20_classCallCheck2%28this%2C%20FromKapsule2%29%3B%0A%20%20%20%20%20%20for%20%28var%20_len%20%3D%20arguments.length%2C%20args%20%3D%20new%20Array%28_len%29%2C%20_key%20%3D%200%3B%20_key%20%3C%20_len%3B%20_key%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20args%5B_key%5D%20%3D%20arguments%5B_key%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_this%20%3D%20_callSuper%28this%2C%20FromKapsule2%2C%20%5B%5D.concat%28args%29%29%3B%0A%20%20%20%20%20%20_this.__kapsuleInstance%20%3D%20kapsule%28%29.apply%28void%200%2C%20%5B%5D.concat%28_toConsumableArray3%28initKapsuleWithSelf%20%3F%20%5B_this%5D%20%3A%20%5B%5D%29%2C%20args%29%29%3B%0A%20%20%20%20%20%20return%20_this%3B%0A%20%20%20%20%7D%0A%20%20%20%20_inherits%28FromKapsule2%2C%20_baseClass%29%3B%0A%20%20%20%20return%20_createClass2%28FromKapsule2%29%3B%0A%20%20%7D%28baseClass%29%3B%0A%20%20Object.keys%28kapsule%28%29%29.forEach%28function%28m2%29%20%7B%0A%20%20%20%20return%20FromKapsule.prototype%5Bm2%5D%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20_this%24__kapsuleInstan%3B%0A%20%20%20%20%20%20var%20returnVal%20%3D%20%28_this%24__kapsuleInstan%20%3D%20this.__kapsuleInstance%29%5Bm2%5D.apply%28_this%24__kapsuleInstan%2C%20arguments%29%3B%0A%20%20%20%20%20%20return%20returnVal%20%3D%3D%3D%20this.__kapsuleInstance%20%3F%20this%20%3A%20returnVal%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%29%3B%0A%20%20return%20FromKapsule%3B%0A%7D%0Avar%20three%20%3D%20window.THREE%20%3F%20window.THREE%20%3A%20%7B%0A%20%20Group%0A%7D%3B%0Avar%20threeForcegraph%20%3D%20fromKapsule%28ForceGraph%2C%20three.Group%2C%20true%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fbuild%2Fthree.webgpu.js%0Avar%20REVISION2%20%3D%20%22170%22%3B%0Avar%20CullFaceNone2%20%3D%200%3B%0Avar%20CullFaceBack2%20%3D%201%3B%0Avar%20CullFaceFront2%20%3D%202%3B%0Avar%20PCFShadowMap%241%20%3D%201%3B%0Avar%20VSMShadowMap2%20%3D%203%3B%0Avar%20FrontSide2%20%3D%200%3B%0Avar%20BackSide2%20%3D%201%3B%0Avar%20DoubleSide2%20%3D%202%3B%0Avar%20NoBlending2%20%3D%200%3B%0Avar%20NormalBlending2%20%3D%201%3B%0Avar%20AdditiveBlending2%20%3D%202%3B%0Avar%20SubtractiveBlending2%20%3D%203%3B%0Avar%20MultiplyBlending2%20%3D%204%3B%0Avar%20CustomBlending2%20%3D%205%3B%0Avar%20AddEquation2%20%3D%20100%3B%0Avar%20SubtractEquation2%20%3D%20101%3B%0Avar%20ReverseSubtractEquation2%20%3D%20102%3B%0Avar%20MinEquation2%20%3D%20103%3B%0Avar%20MaxEquation2%20%3D%20104%3B%0Avar%20ZeroFactor2%20%3D%20200%3B%0Avar%20OneFactor2%20%3D%20201%3B%0Avar%20SrcColorFactor2%20%3D%20202%3B%0Avar%20OneMinusSrcColorFactor2%20%3D%20203%3B%0Avar%20SrcAlphaFactor2%20%3D%20204%3B%0Avar%20OneMinusSrcAlphaFactor2%20%3D%20205%3B%0Avar%20DstAlphaFactor2%20%3D%20206%3B%0Avar%20OneMinusDstAlphaFactor2%20%3D%20207%3B%0Avar%20DstColorFactor2%20%3D%20208%3B%0Avar%20OneMinusDstColorFactor2%20%3D%20209%3B%0Avar%20SrcAlphaSaturateFactor2%20%3D%20210%3B%0Avar%20NeverDepth2%20%3D%200%3B%0Avar%20AlwaysDepth2%20%3D%201%3B%0Avar%20LessDepth2%20%3D%202%3B%0Avar%20LessEqualDepth2%20%3D%203%3B%0Avar%20EqualDepth2%20%3D%204%3B%0Avar%20GreaterEqualDepth2%20%3D%205%3B%0Avar%20GreaterDepth2%20%3D%206%3B%0Avar%20NotEqualDepth2%20%3D%207%3B%0Avar%20MultiplyOperation2%20%3D%200%3B%0Avar%20MixOperation2%20%3D%201%3B%0Avar%20AddOperation2%20%3D%202%3B%0Avar%20NoToneMapping2%20%3D%200%3B%0Avar%20LinearToneMapping2%20%3D%201%3B%0Avar%20ReinhardToneMapping2%20%3D%202%3B%0Avar%20CineonToneMapping2%20%3D%203%3B%0Avar%20ACESFilmicToneMapping2%20%3D%204%3B%0Avar%20AgXToneMapping2%20%3D%206%3B%0Avar%20NeutralToneMapping2%20%3D%207%3B%0Avar%20UVMapping2%20%3D%20300%3B%0Avar%20CubeReflectionMapping2%20%3D%20301%3B%0Avar%20CubeRefractionMapping2%20%3D%20302%3B%0Avar%20EquirectangularReflectionMapping2%20%3D%20303%3B%0Avar%20EquirectangularRefractionMapping2%20%3D%20304%3B%0Avar%20CubeUVReflectionMapping2%20%3D%20306%3B%0Avar%20RepeatWrapping2%20%3D%201e3%3B%0Avar%20ClampToEdgeWrapping2%20%3D%201001%3B%0Avar%20MirroredRepeatWrapping2%20%3D%201002%3B%0Avar%20NearestFilter2%20%3D%201003%3B%0Avar%20NearestMipmapNearestFilter2%20%3D%201004%3B%0Avar%20NearestMipmapLinearFilter2%20%3D%201005%3B%0Avar%20LinearFilter2%20%3D%201006%3B%0Avar%20LinearMipmapNearestFilter2%20%3D%201007%3B%0Avar%20LinearMipmapLinearFilter2%20%3D%201008%3B%0Avar%20UnsignedByteType2%20%3D%201009%3B%0Avar%20ByteType2%20%3D%201010%3B%0Avar%20ShortType2%20%3D%201011%3B%0Avar%20UnsignedShortType2%20%3D%201012%3B%0Avar%20IntType2%20%3D%201013%3B%0Avar%20UnsignedIntType2%20%3D%201014%3B%0Avar%20FloatType2%20%3D%201015%3B%0Avar%20HalfFloatType2%20%3D%201016%3B%0Avar%20UnsignedShort4444Type2%20%3D%201017%3B%0Avar%20UnsignedShort5551Type2%20%3D%201018%3B%0Avar%20UnsignedInt248Type2%20%3D%201020%3B%0Avar%20UnsignedInt5999Type2%20%3D%2035902%3B%0Avar%20AlphaFormat2%20%3D%201021%3B%0Avar%20RGBFormat2%20%3D%201022%3B%0Avar%20RGBAFormat2%20%3D%201023%3B%0Avar%20LuminanceFormat2%20%3D%201024%3B%0Avar%20LuminanceAlphaFormat2%20%3D%201025%3B%0Avar%20DepthFormat2%20%3D%201026%3B%0Avar%20DepthStencilFormat2%20%3D%201027%3B%0Avar%20RedFormat2%20%3D%201028%3B%0Avar%20RedIntegerFormat2%20%3D%201029%3B%0Avar%20RGFormat2%20%3D%201030%3B%0Avar%20RGIntegerFormat2%20%3D%201031%3B%0Avar%20RGBIntegerFormat%20%3D%201032%3B%0Avar%20RGBAIntegerFormat2%20%3D%201033%3B%0Avar%20RGB_S3TC_DXT1_Format2%20%3D%2033776%3B%0Avar%20RGBA_S3TC_DXT1_Format2%20%3D%2033777%3B%0Avar%20RGBA_S3TC_DXT3_Format2%20%3D%2033778%3B%0Avar%20RGBA_S3TC_DXT5_Format2%20%3D%2033779%3B%0Avar%20RGB_PVRTC_4BPPV1_Format2%20%3D%2035840%3B%0Avar%20RGB_PVRTC_2BPPV1_Format2%20%3D%2035841%3B%0Avar%20RGBA_PVRTC_4BPPV1_Format2%20%3D%2035842%3B%0Avar%20RGBA_PVRTC_2BPPV1_Format2%20%3D%2035843%3B%0Avar%20RGB_ETC1_Format2%20%3D%2036196%3B%0Avar%20RGB_ETC2_Format2%20%3D%2037492%3B%0Avar%20RGBA_ETC2_EAC_Format2%20%3D%2037496%3B%0Avar%20RGBA_ASTC_4x4_Format2%20%3D%2037808%3B%0Avar%20RGBA_ASTC_5x4_Format2%20%3D%2037809%3B%0Avar%20RGBA_ASTC_5x5_Format2%20%3D%2037810%3B%0Avar%20RGBA_ASTC_6x5_Format2%20%3D%2037811%3B%0Avar%20RGBA_ASTC_6x6_Format2%20%3D%2037812%3B%0Avar%20RGBA_ASTC_8x5_Format2%20%3D%2037813%3B%0Avar%20RGBA_ASTC_8x6_Format2%20%3D%2037814%3B%0Avar%20RGBA_ASTC_8x8_Format2%20%3D%2037815%3B%0Avar%20RGBA_ASTC_10x5_Format2%20%3D%2037816%3B%0Avar%20RGBA_ASTC_10x6_Format2%20%3D%2037817%3B%0Avar%20RGBA_ASTC_10x8_Format2%20%3D%2037818%3B%0Avar%20RGBA_ASTC_10x10_Format2%20%3D%2037819%3B%0Avar%20RGBA_ASTC_12x10_Format2%20%3D%2037820%3B%0Avar%20RGBA_ASTC_12x12_Format2%20%3D%2037821%3B%0Avar%20RGBA_BPTC_Format2%20%3D%2036492%3B%0Avar%20RED_RGTC1_Format2%20%3D%2036283%3B%0Avar%20SIGNED_RED_RGTC1_Format2%20%3D%2036284%3B%0Avar%20RED_GREEN_RGTC2_Format2%20%3D%2036285%3B%0Avar%20SIGNED_RED_GREEN_RGTC2_Format2%20%3D%2036286%3B%0Avar%20InterpolateDiscrete2%20%3D%202300%3B%0Avar%20InterpolateLinear2%20%3D%202301%3B%0Avar%20InterpolateSmooth2%20%3D%202302%3B%0Avar%20ZeroCurvatureEnding2%20%3D%202400%3B%0Avar%20ZeroSlopeEnding2%20%3D%202401%3B%0Avar%20WrapAroundEnding2%20%3D%202402%3B%0Avar%20TangentSpaceNormalMap2%20%3D%200%3B%0Avar%20ObjectSpaceNormalMap2%20%3D%201%3B%0Avar%20NoColorSpace2%20%3D%20%22%22%3B%0Avar%20SRGBColorSpace2%20%3D%20%22srgb%22%3B%0Avar%20LinearSRGBColorSpace2%20%3D%20%22srgb-linear%22%3B%0Avar%20LinearTransfer2%20%3D%20%22linear%22%3B%0Avar%20SRGBTransfer2%20%3D%20%22srgb%22%3B%0Avar%20ZeroStencilOp%20%3D%200%3B%0Avar%20KeepStencilOp2%20%3D%207680%3B%0Avar%20ReplaceStencilOp%20%3D%207681%3B%0Avar%20IncrementStencilOp%20%3D%207682%3B%0Avar%20DecrementStencilOp%20%3D%207683%3B%0Avar%20IncrementWrapStencilOp%20%3D%2034055%3B%0Avar%20DecrementWrapStencilOp%20%3D%2034056%3B%0Avar%20InvertStencilOp%20%3D%205386%3B%0Avar%20NeverStencilFunc%20%3D%20512%3B%0Avar%20LessStencilFunc%20%3D%20513%3B%0Avar%20EqualStencilFunc%20%3D%20514%3B%0Avar%20LessEqualStencilFunc%20%3D%20515%3B%0Avar%20GreaterStencilFunc%20%3D%20516%3B%0Avar%20NotEqualStencilFunc%20%3D%20517%3B%0Avar%20GreaterEqualStencilFunc%20%3D%20518%3B%0Avar%20AlwaysStencilFunc2%20%3D%20519%3B%0Avar%20NeverCompare2%20%3D%20512%3B%0Avar%20LessCompare2%20%3D%20513%3B%0Avar%20EqualCompare2%20%3D%20514%3B%0Avar%20LessEqualCompare2%20%3D%20515%3B%0Avar%20GreaterCompare2%20%3D%20516%3B%0Avar%20NotEqualCompare2%20%3D%20517%3B%0Avar%20GreaterEqualCompare2%20%3D%20518%3B%0Avar%20AlwaysCompare2%20%3D%20519%3B%0Avar%20StaticDrawUsage2%20%3D%2035044%3B%0Avar%20DynamicDrawUsage%20%3D%2035048%3B%0Avar%20WebGLCoordinateSystem2%20%3D%202e3%3B%0Avar%20WebGPUCoordinateSystem2%20%3D%202001%3B%0Avar%20EventDispatcher2%20%3D%20class%20%7B%0A%20%20addEventListener%28type%2C%20listener%29%20%7B%0A%20%20%20%20if%20%28this._listeners%20%3D%3D%3D%20void%200%29%20this._listeners%20%3D%20%7B%7D%3B%0A%20%20%20%20const%20listeners%20%3D%20this._listeners%3B%0A%20%20%20%20if%20%28listeners%5Btype%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20listeners%5Btype%5D%20%3D%20%5B%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28listeners%5Btype%5D.indexOf%28listener%29%20%3D%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20listeners%5Btype%5D.push%28listener%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20hasEventListener%28type%2C%20listener%29%20%7B%0A%20%20%20%20if%20%28this._listeners%20%3D%3D%3D%20void%200%29%20return%20false%3B%0A%20%20%20%20const%20listeners%20%3D%20this._listeners%3B%0A%20%20%20%20return%20listeners%5Btype%5D%20%21%3D%3D%20void%200%20%26%26%20listeners%5Btype%5D.indexOf%28listener%29%20%21%3D%3D%20-1%3B%0A%20%20%7D%0A%20%20removeEventListener%28type%2C%20listener%29%20%7B%0A%20%20%20%20if%20%28this._listeners%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20const%20listeners%20%3D%20this._listeners%3B%0A%20%20%20%20const%20listenerArray%20%3D%20listeners%5Btype%5D%3B%0A%20%20%20%20if%20%28listenerArray%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20index5%20%3D%20listenerArray.indexOf%28listener%29%3B%0A%20%20%20%20%20%20if%20%28index5%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20listenerArray.splice%28index5%2C%201%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20dispatchEvent%28event%29%20%7B%0A%20%20%20%20if%20%28this._listeners%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20const%20listeners%20%3D%20this._listeners%3B%0A%20%20%20%20const%20listenerArray%20%3D%20listeners%5Bevent.type%5D%3B%0A%20%20%20%20if%20%28listenerArray%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20event.target%20%3D%20this%3B%0A%20%20%20%20%20%20const%20array%20%3D%20listenerArray.slice%280%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20array.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20array%5Bi%5D.call%28this%2C%20event%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20event.target%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20_lut2%20%3D%20%5B%2200%22%2C%20%2201%22%2C%20%2202%22%2C%20%2203%22%2C%20%2204%22%2C%20%2205%22%2C%20%2206%22%2C%20%2207%22%2C%20%2208%22%2C%20%2209%22%2C%20%220a%22%2C%20%220b%22%2C%20%220c%22%2C%20%220d%22%2C%20%220e%22%2C%20%220f%22%2C%20%2210%22%2C%20%2211%22%2C%20%2212%22%2C%20%2213%22%2C%20%2214%22%2C%20%2215%22%2C%20%2216%22%2C%20%2217%22%2C%20%2218%22%2C%20%2219%22%2C%20%221a%22%2C%20%221b%22%2C%20%221c%22%2C%20%221d%22%2C%20%221e%22%2C%20%221f%22%2C%20%2220%22%2C%20%2221%22%2C%20%2222%22%2C%20%2223%22%2C%20%2224%22%2C%20%2225%22%2C%20%2226%22%2C%20%2227%22%2C%20%2228%22%2C%20%2229%22%2C%20%222a%22%2C%20%222b%22%2C%20%222c%22%2C%20%222d%22%2C%20%222e%22%2C%20%222f%22%2C%20%2230%22%2C%20%2231%22%2C%20%2232%22%2C%20%2233%22%2C%20%2234%22%2C%20%2235%22%2C%20%2236%22%2C%20%2237%22%2C%20%2238%22%2C%20%2239%22%2C%20%223a%22%2C%20%223b%22%2C%20%223c%22%2C%20%223d%22%2C%20%223e%22%2C%20%223f%22%2C%20%2240%22%2C%20%2241%22%2C%20%2242%22%2C%20%2243%22%2C%20%2244%22%2C%20%2245%22%2C%20%2246%22%2C%20%2247%22%2C%20%2248%22%2C%20%2249%22%2C%20%224a%22%2C%20%224b%22%2C%20%224c%22%2C%20%224d%22%2C%20%224e%22%2C%20%224f%22%2C%20%2250%22%2C%20%2251%22%2C%20%2252%22%2C%20%2253%22%2C%20%2254%22%2C%20%2255%22%2C%20%2256%22%2C%20%2257%22%2C%20%2258%22%2C%20%2259%22%2C%20%225a%22%2C%20%225b%22%2C%20%225c%22%2C%20%225d%22%2C%20%225e%22%2C%20%225f%22%2C%20%2260%22%2C%20%2261%22%2C%20%2262%22%2C%20%2263%22%2C%20%2264%22%2C%20%2265%22%2C%20%2266%22%2C%20%2267%22%2C%20%2268%22%2C%20%2269%22%2C%20%226a%22%2C%20%226b%22%2C%20%226c%22%2C%20%226d%22%2C%20%226e%22%2C%20%226f%22%2C%20%2270%22%2C%20%2271%22%2C%20%2272%22%2C%20%2273%22%2C%20%2274%22%2C%20%2275%22%2C%20%2276%22%2C%20%2277%22%2C%20%2278%22%2C%20%2279%22%2C%20%227a%22%2C%20%227b%22%2C%20%227c%22%2C%20%227d%22%2C%20%227e%22%2C%20%227f%22%2C%20%2280%22%2C%20%2281%22%2C%20%2282%22%2C%20%2283%22%2C%20%2284%22%2C%20%2285%22%2C%20%2286%22%2C%20%2287%22%2C%20%2288%22%2C%20%2289%22%2C%20%228a%22%2C%20%228b%22%2C%20%228c%22%2C%20%228d%22%2C%20%228e%22%2C%20%228f%22%2C%20%2290%22%2C%20%2291%22%2C%20%2292%22%2C%20%2293%22%2C%20%2294%22%2C%20%2295%22%2C%20%2296%22%2C%20%2297%22%2C%20%2298%22%2C%20%2299%22%2C%20%229a%22%2C%20%229b%22%2C%20%229c%22%2C%20%229d%22%2C%20%229e%22%2C%20%229f%22%2C%20%22a0%22%2C%20%22a1%22%2C%20%22a2%22%2C%20%22a3%22%2C%20%22a4%22%2C%20%22a5%22%2C%20%22a6%22%2C%20%22a7%22%2C%20%22a8%22%2C%20%22a9%22%2C%20%22aa%22%2C%20%22ab%22%2C%20%22ac%22%2C%20%22ad%22%2C%20%22ae%22%2C%20%22af%22%2C%20%22b0%22%2C%20%22b1%22%2C%20%22b2%22%2C%20%22b3%22%2C%20%22b4%22%2C%20%22b5%22%2C%20%22b6%22%2C%20%22b7%22%2C%20%22b8%22%2C%20%22b9%22%2C%20%22ba%22%2C%20%22bb%22%2C%20%22bc%22%2C%20%22bd%22%2C%20%22be%22%2C%20%22bf%22%2C%20%22c0%22%2C%20%22c1%22%2C%20%22c2%22%2C%20%22c3%22%2C%20%22c4%22%2C%20%22c5%22%2C%20%22c6%22%2C%20%22c7%22%2C%20%22c8%22%2C%20%22c9%22%2C%20%22ca%22%2C%20%22cb%22%2C%20%22cc%22%2C%20%22cd%22%2C%20%22ce%22%2C%20%22cf%22%2C%20%22d0%22%2C%20%22d1%22%2C%20%22d2%22%2C%20%22d3%22%2C%20%22d4%22%2C%20%22d5%22%2C%20%22d6%22%2C%20%22d7%22%2C%20%22d8%22%2C%20%22d9%22%2C%20%22da%22%2C%20%22db%22%2C%20%22dc%22%2C%20%22dd%22%2C%20%22de%22%2C%20%22df%22%2C%20%22e0%22%2C%20%22e1%22%2C%20%22e2%22%2C%20%22e3%22%2C%20%22e4%22%2C%20%22e5%22%2C%20%22e6%22%2C%20%22e7%22%2C%20%22e8%22%2C%20%22e9%22%2C%20%22ea%22%2C%20%22eb%22%2C%20%22ec%22%2C%20%22ed%22%2C%20%22ee%22%2C%20%22ef%22%2C%20%22f0%22%2C%20%22f1%22%2C%20%22f2%22%2C%20%22f3%22%2C%20%22f4%22%2C%20%22f5%22%2C%20%22f6%22%2C%20%22f7%22%2C%20%22f8%22%2C%20%22f9%22%2C%20%22fa%22%2C%20%22fb%22%2C%20%22fc%22%2C%20%22fd%22%2C%20%22fe%22%2C%20%22ff%22%5D%3B%0Avar%20_seed2%20%3D%201234567%3B%0Avar%20DEG2RAD2%20%3D%20Math.PI%20%2F%20180%3B%0Avar%20RAD2DEG2%20%3D%20180%20%2F%20Math.PI%3B%0Afunction%20generateUUID2%28%29%20%7B%0A%20%20const%20d0%20%3D%20Math.random%28%29%20%2A%204294967295%20%7C%200%3B%0A%20%20const%20d1%20%3D%20Math.random%28%29%20%2A%204294967295%20%7C%200%3B%0A%20%20const%20d2%20%3D%20Math.random%28%29%20%2A%204294967295%20%7C%200%3B%0A%20%20const%20d3%20%3D%20Math.random%28%29%20%2A%204294967295%20%7C%200%3B%0A%20%20const%20uuid%20%3D%20_lut2%5Bd0%20%26%20255%5D%20%2B%20_lut2%5Bd0%20%3E%3E%208%20%26%20255%5D%20%2B%20_lut2%5Bd0%20%3E%3E%2016%20%26%20255%5D%20%2B%20_lut2%5Bd0%20%3E%3E%2024%20%26%20255%5D%20%2B%20%22-%22%20%2B%20_lut2%5Bd1%20%26%20255%5D%20%2B%20_lut2%5Bd1%20%3E%3E%208%20%26%20255%5D%20%2B%20%22-%22%20%2B%20_lut2%5Bd1%20%3E%3E%2016%20%26%2015%20%7C%2064%5D%20%2B%20_lut2%5Bd1%20%3E%3E%2024%20%26%20255%5D%20%2B%20%22-%22%20%2B%20_lut2%5Bd2%20%26%2063%20%7C%20128%5D%20%2B%20_lut2%5Bd2%20%3E%3E%208%20%26%20255%5D%20%2B%20%22-%22%20%2B%20_lut2%5Bd2%20%3E%3E%2016%20%26%20255%5D%20%2B%20_lut2%5Bd2%20%3E%3E%2024%20%26%20255%5D%20%2B%20_lut2%5Bd3%20%26%20255%5D%20%2B%20_lut2%5Bd3%20%3E%3E%208%20%26%20255%5D%20%2B%20_lut2%5Bd3%20%3E%3E%2016%20%26%20255%5D%20%2B%20_lut2%5Bd3%20%3E%3E%2024%20%26%20255%5D%3B%0A%20%20return%20uuid.toLowerCase%28%29%3B%0A%7D%0Afunction%20clamp%241%28value%2C%20min2%2C%20max2%29%20%7B%0A%20%20return%20Math.max%28min2%2C%20Math.min%28max2%2C%20value%29%29%3B%0A%7D%0Afunction%20euclideanModulo2%28n%2C%20m2%29%20%7B%0A%20%20return%20%28n%20%25%20m2%20%2B%20m2%29%20%25%20m2%3B%0A%7D%0Afunction%20mapLinear2%28x2%2C%20a1%2C%20a2%2C%20b1%2C%20b2%29%20%7B%0A%20%20return%20b1%20%2B%20%28x2%20-%20a1%29%20%2A%20%28b2%20-%20b1%29%20%2F%20%28a2%20-%20a1%29%3B%0A%7D%0Afunction%20inverseLerp2%28x2%2C%20y2%2C%20value%29%20%7B%0A%20%20if%20%28x2%20%21%3D%3D%20y2%29%20%7B%0A%20%20%20%20return%20%28value%20-%20x2%29%20%2F%20%28y2%20-%20x2%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%200%3B%0A%20%20%7D%0A%7D%0Afunction%20lerp2%28x2%2C%20y2%2C%20t%29%20%7B%0A%20%20return%20%281%20-%20t%29%20%2A%20x2%20%2B%20t%20%2A%20y2%3B%0A%7D%0Afunction%20damp2%28x2%2C%20y2%2C%20lambda%2C%20dt%29%20%7B%0A%20%20return%20lerp2%28x2%2C%20y2%2C%201%20-%20Math.exp%28-lambda%20%2A%20dt%29%29%3B%0A%7D%0Afunction%20pingpong2%28x2%2C%20length2%20%3D%201%29%20%7B%0A%20%20return%20length2%20-%20Math.abs%28euclideanModulo2%28x2%2C%20length2%20%2A%202%29%20-%20length2%29%3B%0A%7D%0Afunction%20smoothstep%241%28x2%2C%20min2%2C%20max2%29%20%7B%0A%20%20if%20%28x2%20%3C%3D%20min2%29%20return%200%3B%0A%20%20if%20%28x2%20%3E%3D%20max2%29%20return%201%3B%0A%20%20x2%20%3D%20%28x2%20-%20min2%29%20%2F%20%28max2%20-%20min2%29%3B%0A%20%20return%20x2%20%2A%20x2%20%2A%20%283%20-%202%20%2A%20x2%29%3B%0A%7D%0Afunction%20smootherstep2%28x2%2C%20min2%2C%20max2%29%20%7B%0A%20%20if%20%28x2%20%3C%3D%20min2%29%20return%200%3B%0A%20%20if%20%28x2%20%3E%3D%20max2%29%20return%201%3B%0A%20%20x2%20%3D%20%28x2%20-%20min2%29%20%2F%20%28max2%20-%20min2%29%3B%0A%20%20return%20x2%20%2A%20x2%20%2A%20x2%20%2A%20%28x2%20%2A%20%28x2%20%2A%206%20-%2015%29%20%2B%2010%29%3B%0A%7D%0Afunction%20randInt2%28low%2C%20high%29%20%7B%0A%20%20return%20low%20%2B%20Math.floor%28Math.random%28%29%20%2A%20%28high%20-%20low%20%2B%201%29%29%3B%0A%7D%0Afunction%20randFloat2%28low%2C%20high%29%20%7B%0A%20%20return%20low%20%2B%20Math.random%28%29%20%2A%20%28high%20-%20low%29%3B%0A%7D%0Afunction%20randFloatSpread2%28range%29%20%7B%0A%20%20return%20range%20%2A%20%280.5%20-%20Math.random%28%29%29%3B%0A%7D%0Afunction%20seededRandom2%28s%29%20%7B%0A%20%20if%20%28s%20%21%3D%3D%20void%200%29%20_seed2%20%3D%20s%3B%0A%20%20let%20t%20%3D%20_seed2%20%2B%3D%201831565813%3B%0A%20%20t%20%3D%20Math.imul%28t%20%5E%20t%20%3E%3E%3E%2015%2C%20t%20%7C%201%29%3B%0A%20%20t%20%5E%3D%20t%20%2B%20Math.imul%28t%20%5E%20t%20%3E%3E%3E%207%2C%20t%20%7C%2061%29%3B%0A%20%20return%20%28%28t%20%5E%20t%20%3E%3E%3E%2014%29%20%3E%3E%3E%200%29%20%2F%204294967296%3B%0A%7D%0Afunction%20degToRad2%28degrees2%29%20%7B%0A%20%20return%20degrees2%20%2A%20DEG2RAD2%3B%0A%7D%0Afunction%20radToDeg2%28radians2%29%20%7B%0A%20%20return%20radians2%20%2A%20RAD2DEG2%3B%0A%7D%0Afunction%20isPowerOfTwo2%28value%29%20%7B%0A%20%20return%20%28value%20%26%20value%20-%201%29%20%3D%3D%3D%200%20%26%26%20value%20%21%3D%3D%200%3B%0A%7D%0Afunction%20ceilPowerOfTwo2%28value%29%20%7B%0A%20%20return%20Math.pow%282%2C%20Math.ceil%28Math.log%28value%29%20%2F%20Math.LN2%29%29%3B%0A%7D%0Afunction%20floorPowerOfTwo2%28value%29%20%7B%0A%20%20return%20Math.pow%282%2C%20Math.floor%28Math.log%28value%29%20%2F%20Math.LN2%29%29%3B%0A%7D%0Afunction%20setQuaternionFromProperEuler2%28q%2C%20a2%2C%20b%2C%20c2%2C%20order%29%20%7B%0A%20%20const%20cos2%20%3D%20Math.cos%3B%0A%20%20const%20sin2%20%3D%20Math.sin%3B%0A%20%20const%20c22%20%3D%20cos2%28b%20%2F%202%29%3B%0A%20%20const%20s2%20%3D%20sin2%28b%20%2F%202%29%3B%0A%20%20const%20c13%20%3D%20cos2%28%28a2%20%2B%20c2%29%20%2F%202%29%3B%0A%20%20const%20s13%20%3D%20sin2%28%28a2%20%2B%20c2%29%20%2F%202%29%3B%0A%20%20const%20c1_3%20%3D%20cos2%28%28a2%20-%20c2%29%20%2F%202%29%3B%0A%20%20const%20s1_3%20%3D%20sin2%28%28a2%20-%20c2%29%20%2F%202%29%3B%0A%20%20const%20c3_1%20%3D%20cos2%28%28c2%20-%20a2%29%20%2F%202%29%3B%0A%20%20const%20s3_1%20%3D%20sin2%28%28c2%20-%20a2%29%20%2F%202%29%3B%0A%20%20switch%20%28order%29%20%7B%0A%20%20%20%20case%20%22XYX%22%3A%0A%20%20%20%20%20%20q.set%28c22%20%2A%20s13%2C%20s2%20%2A%20c1_3%2C%20s2%20%2A%20s1_3%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22YZY%22%3A%0A%20%20%20%20%20%20q.set%28s2%20%2A%20s1_3%2C%20c22%20%2A%20s13%2C%20s2%20%2A%20c1_3%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ZXZ%22%3A%0A%20%20%20%20%20%20q.set%28s2%20%2A%20c1_3%2C%20s2%20%2A%20s1_3%2C%20c22%20%2A%20s13%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22XZX%22%3A%0A%20%20%20%20%20%20q.set%28c22%20%2A%20s13%2C%20s2%20%2A%20s3_1%2C%20s2%20%2A%20c3_1%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22YXY%22%3A%0A%20%20%20%20%20%20q.set%28s2%20%2A%20c3_1%2C%20c22%20%2A%20s13%2C%20s2%20%2A%20s3_1%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ZYZ%22%3A%0A%20%20%20%20%20%20q.set%28s2%20%2A%20s3_1%2C%20s2%20%2A%20c3_1%2C%20c22%20%2A%20s13%2C%20c22%20%2A%20c13%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20console.warn%28%22THREE.MathUtils%3A%20.setQuaternionFromProperEuler%28%29%20encountered%20an%20unknown%20order%3A%20%22%20%2B%20order%29%3B%0A%20%20%7D%0A%7D%0Afunction%20denormalize2%28value%2C%20array%29%20%7B%0A%20%20switch%20%28array.constructor%29%20%7B%0A%20%20%20%20case%20Float32Array%3A%0A%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20case%20Uint32Array%3A%0A%20%20%20%20%20%20return%20value%20%2F%204294967295%3B%0A%20%20%20%20case%20Uint16Array%3A%0A%20%20%20%20%20%20return%20value%20%2F%2065535%3B%0A%20%20%20%20case%20Uint8Array%3A%0A%20%20%20%20%20%20return%20value%20%2F%20255%3B%0A%20%20%20%20case%20Int32Array%3A%0A%20%20%20%20%20%20return%20Math.max%28value%20%2F%202147483647%2C%20-1%29%3B%0A%20%20%20%20case%20Int16Array%3A%0A%20%20%20%20%20%20return%20Math.max%28value%20%2F%2032767%2C%20-1%29%3B%0A%20%20%20%20case%20Int8Array%3A%0A%20%20%20%20%20%20return%20Math.max%28value%20%2F%20127%2C%20-1%29%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20throw%20new%20Error%28%22Invalid%20component%20type.%22%29%3B%0A%20%20%7D%0A%7D%0Afunction%20normalize%241%28value%2C%20array%29%20%7B%0A%20%20switch%20%28array.constructor%29%20%7B%0A%20%20%20%20case%20Float32Array%3A%0A%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20case%20Uint32Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%204294967295%29%3B%0A%20%20%20%20case%20Uint16Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%2065535%29%3B%0A%20%20%20%20case%20Uint8Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%20255%29%3B%0A%20%20%20%20case%20Int32Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%202147483647%29%3B%0A%20%20%20%20case%20Int16Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%2032767%29%3B%0A%20%20%20%20case%20Int8Array%3A%0A%20%20%20%20%20%20return%20Math.round%28value%20%2A%20127%29%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20throw%20new%20Error%28%22Invalid%20component%20type.%22%29%3B%0A%20%20%7D%0A%7D%0Avar%20MathUtils2%20%3D%20%7B%0A%20%20DEG2RAD%3A%20DEG2RAD2%2C%0A%20%20RAD2DEG%3A%20RAD2DEG2%2C%0A%20%20generateUUID%3A%20generateUUID2%2C%0A%20%20clamp%3A%20clamp%241%2C%0A%20%20euclideanModulo%3A%20euclideanModulo2%2C%0A%20%20mapLinear%3A%20mapLinear2%2C%0A%20%20inverseLerp%3A%20inverseLerp2%2C%0A%20%20lerp%3A%20lerp2%2C%0A%20%20damp%3A%20damp2%2C%0A%20%20pingpong%3A%20pingpong2%2C%0A%20%20smoothstep%3A%20smoothstep%241%2C%0A%20%20smootherstep%3A%20smootherstep2%2C%0A%20%20randInt%3A%20randInt2%2C%0A%20%20randFloat%3A%20randFloat2%2C%0A%20%20randFloatSpread%3A%20randFloatSpread2%2C%0A%20%20seededRandom%3A%20seededRandom2%2C%0A%20%20degToRad%3A%20degToRad2%2C%0A%20%20radToDeg%3A%20radToDeg2%2C%0A%20%20isPowerOfTwo%3A%20isPowerOfTwo2%2C%0A%20%20ceilPowerOfTwo%3A%20ceilPowerOfTwo2%2C%0A%20%20floorPowerOfTwo%3A%20floorPowerOfTwo2%2C%0A%20%20setQuaternionFromProperEuler%3A%20setQuaternionFromProperEuler2%2C%0A%20%20normalize%3A%20normalize%241%2C%0A%20%20denormalize%3A%20denormalize2%0A%7D%3B%0Avar%20Vector22%20%3D%20class%20_Vector2%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%29%20%7B%0A%20%20%20%20_Vector2.prototype.isVector2%20%3D%20true%3B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%7D%0A%20%20get%20width%28%29%20%7B%0A%20%20%20%20return%20this.x%3B%0A%20%20%7D%0A%20%20set%20width%28value%29%20%7B%0A%20%20%20%20this.x%20%3D%20value%3B%0A%20%20%7D%0A%20%20get%20height%28%29%20%7B%0A%20%20%20%20return%20this.y%3B%0A%20%20%7D%0A%20%20set%20height%28value%29%20%7B%0A%20%20%20%20this.y%20%3D%20value%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%3D%20scalar%3B%0A%20%20%20%20this.y%20%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setX%28x2%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setY%28y2%29%20%7B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setComponent%28index5%2C%20value%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20this.x%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20this.y%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getComponent%28index5%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20return%20this.x%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20return%20this.y%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.x%2C%20this.y%29%3B%0A%20%20%7D%0A%20%20copy%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20v.x%3B%0A%20%20%20%20this.y%20%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20add%28v%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScalar%28s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20%2B%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20%2B%20b.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScaledVector%28v%2C%20s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%20%2A%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%20%2A%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20sub%28v%29%20%7B%0A%20%20%20%20this.x%20-%3D%20v.x%3B%0A%20%20%20%20this.y%20-%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subScalar%28s%29%20%7B%0A%20%20%20%20this.x%20-%3D%20s%3B%0A%20%20%20%20this.y%20-%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20-%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20-%20b.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28v%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20v.x%3B%0A%20%20%20%20this.y%20%2A%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20scalar%3B%0A%20%20%20%20this.y%20%2A%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divide%28v%29%20%7B%0A%20%20%20%20this.x%20%2F%3D%20v.x%3B%0A%20%20%20%20this.y%20%2F%3D%20v.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divideScalar%28scalar%29%20%7B%0A%20%20%20%20return%20this.multiplyScalar%281%20%2F%20scalar%29%3B%0A%20%20%7D%0A%20%20applyMatrix3%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B0%5D%20%2A%20x2%20%2B%20e%5B3%5D%20%2A%20y2%20%2B%20e%5B6%5D%3B%0A%20%20%20%20this.y%20%3D%20e%5B1%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B7%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20min%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.min%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.min%28this.y%2C%20v.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20max%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28this.y%2C%20v.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clamp%28min2%2C%20max2%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28min2.x%2C%20Math.min%28max2.x%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28min2.y%2C%20Math.min%28max2.y%2C%20this.y%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampScalar%28minVal%2C%20maxVal%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.y%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampLength%28min2%2C%20max2%29%20%7B%0A%20%20%20%20const%20length2%20%3D%20this.length%28%29%3B%0A%20%20%20%20return%20this.divideScalar%28length2%20%7C%7C%201%29.multiplyScalar%28Math.max%28min2%2C%20Math.min%28max2%2C%20length2%29%29%29%3B%0A%20%20%7D%0A%20%20floor%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.floor%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.floor%28this.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20ceil%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.ceil%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.ceil%28this.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20round%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.round%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.round%28this.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20roundToZero%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.trunc%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.trunc%28this.y%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20negate%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20-this.x%3B%0A%20%20%20%20this.y%20%3D%20-this.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dot%28v%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20v.x%20%2B%20this.y%20%2A%20v.y%3B%0A%20%20%7D%0A%20%20cross%28v%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20v.y%20-%20this.y%20%2A%20v.x%3B%0A%20%20%7D%0A%20%20lengthSq%28%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%3B%0A%20%20%7D%0A%20%20length%28%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%29%3B%0A%20%20%7D%0A%20%20manhattanLength%28%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%29%20%2B%20Math.abs%28this.y%29%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20return%20this.divideScalar%28this.length%28%29%20%7C%7C%201%29%3B%0A%20%20%7D%0A%20%20angle%28%29%20%7B%0A%20%20%20%20const%20angle%20%3D%20Math.atan2%28-this.y%2C%20-this.x%29%20%2B%20Math.PI%3B%0A%20%20%20%20return%20angle%3B%0A%20%20%7D%0A%20%20angleTo%28v%29%20%7B%0A%20%20%20%20const%20denominator%20%3D%20Math.sqrt%28this.lengthSq%28%29%20%2A%20v.lengthSq%28%29%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20return%20Math.PI%20%2F%202%3B%0A%20%20%20%20const%20theta%20%3D%20this.dot%28v%29%20%2F%20denominator%3B%0A%20%20%20%20return%20Math.acos%28clamp%241%28theta%2C%20-1%2C%201%29%29%3B%0A%20%20%7D%0A%20%20distanceTo%28v%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.distanceToSquared%28v%29%29%3B%0A%20%20%7D%0A%20%20distanceToSquared%28v%29%20%7B%0A%20%20%20%20const%20dx%20%3D%20this.x%20-%20v.x%2C%20dy%20%3D%20this.y%20-%20v.y%3B%0A%20%20%20%20return%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%3B%0A%20%20%7D%0A%20%20manhattanDistanceTo%28v%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%20-%20v.x%29%20%2B%20Math.abs%28this.y%20-%20v.y%29%3B%0A%20%20%7D%0A%20%20setLength%28length2%29%20%7B%0A%20%20%20%20return%20this.normalize%28%29.multiplyScalar%28length2%29%3B%0A%20%20%7D%0A%20%20lerp%28v%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20%28v.x%20-%20this.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%2B%3D%20%28v.y%20-%20this.y%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpVectors%28v1%2C%20v2%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%3D%20v1.x%20%2B%20%28v2.x%20-%20v1.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%3D%20v1.y%20%2B%20%28v2.y%20-%20v1.y%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28v%29%20%7B%0A%20%20%20%20return%20v.x%20%3D%3D%3D%20this.x%20%26%26%20v.y%20%3D%3D%3D%20this.y%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.x%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this.y%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this.x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this.y%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this.x%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this.y%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateAround%28center%2C%20angle%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28angle%29%2C%20s%20%3D%20Math.sin%28angle%29%3B%0A%20%20%20%20const%20x2%20%3D%20this.x%20-%20center.x%3B%0A%20%20%20%20const%20y2%20%3D%20this.y%20-%20center.y%3B%0A%20%20%20%20this.x%20%3D%20x2%20%2A%20c2%20-%20y2%20%2A%20s%20%2B%20center.x%3B%0A%20%20%20%20this.y%20%3D%20x2%20%2A%20s%20%2B%20y2%20%2A%20c2%20%2B%20center.y%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20random%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.y%20%3D%20Math.random%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this.x%3B%0A%20%20%20%20yield%20this.y%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Matrix32%20%3D%20class%20_Matrix3%20%7B%0A%20%20constructor%28n11%2C%20n12%2C%20n13%2C%20n21%2C%20n22%2C%20n23%2C%20n31%2C%20n32%2C%20n33%29%20%7B%0A%20%20%20%20_Matrix3.prototype.isMatrix3%20%3D%20true%3B%0A%20%20%20%20this.elements%20%3D%20%5B%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%5D%3B%0A%20%20%20%20if%20%28n11%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.set%28n11%2C%20n12%2C%20n13%2C%20n21%2C%20n22%2C%20n23%2C%20n31%2C%20n32%2C%20n33%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20set%28n11%2C%20n12%2C%20n13%2C%20n21%2C%20n22%2C%20n23%2C%20n31%2C%20n32%2C%20n33%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20te%5B0%5D%20%3D%20n11%3B%0A%20%20%20%20te%5B1%5D%20%3D%20n21%3B%0A%20%20%20%20te%5B2%5D%20%3D%20n31%3B%0A%20%20%20%20te%5B3%5D%20%3D%20n12%3B%0A%20%20%20%20te%5B4%5D%20%3D%20n22%3B%0A%20%20%20%20te%5B5%5D%20%3D%20n32%3B%0A%20%20%20%20te%5B6%5D%20%3D%20n13%3B%0A%20%20%20%20te%5B7%5D%20%3D%20n23%3B%0A%20%20%20%20te%5B8%5D%20%3D%20n33%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20identity%28%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20te%5B0%5D%20%3D%20me%5B0%5D%3B%0A%20%20%20%20te%5B1%5D%20%3D%20me%5B1%5D%3B%0A%20%20%20%20te%5B2%5D%20%3D%20me%5B2%5D%3B%0A%20%20%20%20te%5B3%5D%20%3D%20me%5B3%5D%3B%0A%20%20%20%20te%5B4%5D%20%3D%20me%5B4%5D%3B%0A%20%20%20%20te%5B5%5D%20%3D%20me%5B5%5D%3B%0A%20%20%20%20te%5B6%5D%20%3D%20me%5B6%5D%3B%0A%20%20%20%20te%5B7%5D%20%3D%20me%5B7%5D%3B%0A%20%20%20%20te%5B8%5D%20%3D%20me%5B8%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20extractBasis%28xAxis%2C%20yAxis%2C%20zAxis%29%20%7B%0A%20%20%20%20xAxis.setFromMatrix3Column%28this%2C%200%29%3B%0A%20%20%20%20yAxis.setFromMatrix3Column%28this%2C%201%29%3B%0A%20%20%20%20zAxis.setFromMatrix3Column%28this%2C%202%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrix4%28m2%29%20%7B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20me%5B0%5D%2C%0A%20%20%20%20%20%20me%5B4%5D%2C%0A%20%20%20%20%20%20me%5B8%5D%2C%0A%20%20%20%20%20%20me%5B1%5D%2C%0A%20%20%20%20%20%20me%5B5%5D%2C%0A%20%20%20%20%20%20me%5B9%5D%2C%0A%20%20%20%20%20%20me%5B2%5D%2C%0A%20%20%20%20%20%20me%5B6%5D%2C%0A%20%20%20%20%20%20me%5B10%5D%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28m2%29%20%7B%0A%20%20%20%20return%20this.multiplyMatrices%28this%2C%20m2%29%3B%0A%20%20%7D%0A%20%20premultiply%28m2%29%20%7B%0A%20%20%20%20return%20this.multiplyMatrices%28m2%2C%20this%29%3B%0A%20%20%7D%0A%20%20multiplyMatrices%28a2%2C%20b%29%20%7B%0A%20%20%20%20const%20ae%20%3D%20a2.elements%3B%0A%20%20%20%20const%20be%20%3D%20b.elements%3B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20a11%20%3D%20ae%5B0%5D%2C%20a12%20%3D%20ae%5B3%5D%2C%20a13%20%3D%20ae%5B6%5D%3B%0A%20%20%20%20const%20a21%20%3D%20ae%5B1%5D%2C%20a22%20%3D%20ae%5B4%5D%2C%20a23%20%3D%20ae%5B7%5D%3B%0A%20%20%20%20const%20a31%20%3D%20ae%5B2%5D%2C%20a32%20%3D%20ae%5B5%5D%2C%20a33%20%3D%20ae%5B8%5D%3B%0A%20%20%20%20const%20b11%20%3D%20be%5B0%5D%2C%20b12%20%3D%20be%5B3%5D%2C%20b13%20%3D%20be%5B6%5D%3B%0A%20%20%20%20const%20b21%20%3D%20be%5B1%5D%2C%20b22%20%3D%20be%5B4%5D%2C%20b23%20%3D%20be%5B7%5D%3B%0A%20%20%20%20const%20b31%20%3D%20be%5B2%5D%2C%20b32%20%3D%20be%5B5%5D%2C%20b33%20%3D%20be%5B8%5D%3B%0A%20%20%20%20te%5B0%5D%20%3D%20a11%20%2A%20b11%20%2B%20a12%20%2A%20b21%20%2B%20a13%20%2A%20b31%3B%0A%20%20%20%20te%5B3%5D%20%3D%20a11%20%2A%20b12%20%2B%20a12%20%2A%20b22%20%2B%20a13%20%2A%20b32%3B%0A%20%20%20%20te%5B6%5D%20%3D%20a11%20%2A%20b13%20%2B%20a12%20%2A%20b23%20%2B%20a13%20%2A%20b33%3B%0A%20%20%20%20te%5B1%5D%20%3D%20a21%20%2A%20b11%20%2B%20a22%20%2A%20b21%20%2B%20a23%20%2A%20b31%3B%0A%20%20%20%20te%5B4%5D%20%3D%20a21%20%2A%20b12%20%2B%20a22%20%2A%20b22%20%2B%20a23%20%2A%20b32%3B%0A%20%20%20%20te%5B7%5D%20%3D%20a21%20%2A%20b13%20%2B%20a22%20%2A%20b23%20%2B%20a23%20%2A%20b33%3B%0A%20%20%20%20te%5B2%5D%20%3D%20a31%20%2A%20b11%20%2B%20a32%20%2A%20b21%20%2B%20a33%20%2A%20b31%3B%0A%20%20%20%20te%5B5%5D%20%3D%20a31%20%2A%20b12%20%2B%20a32%20%2A%20b22%20%2B%20a33%20%2A%20b32%3B%0A%20%20%20%20te%5B8%5D%20%3D%20a31%20%2A%20b13%20%2B%20a32%20%2A%20b23%20%2B%20a33%20%2A%20b33%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28s%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20te%5B0%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B3%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B6%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B1%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B4%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B7%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B2%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B5%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B8%5D%20%2A%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20determinant%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20a2%20%3D%20te%5B0%5D%2C%20b%20%3D%20te%5B1%5D%2C%20c2%20%3D%20te%5B2%5D%2C%20d%20%3D%20te%5B3%5D%2C%20e%20%3D%20te%5B4%5D%2C%20f%20%3D%20te%5B5%5D%2C%20g%20%3D%20te%5B6%5D%2C%20h%20%3D%20te%5B7%5D%2C%20i%20%3D%20te%5B8%5D%3B%0A%20%20%20%20return%20a2%20%2A%20e%20%2A%20i%20-%20a2%20%2A%20f%20%2A%20h%20-%20b%20%2A%20d%20%2A%20i%20%2B%20b%20%2A%20f%20%2A%20g%20%2B%20c2%20%2A%20d%20%2A%20h%20-%20c2%20%2A%20e%20%2A%20g%3B%0A%20%20%7D%0A%20%20invert%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%2C%20n11%20%3D%20te%5B0%5D%2C%20n21%20%3D%20te%5B1%5D%2C%20n31%20%3D%20te%5B2%5D%2C%20n12%20%3D%20te%5B3%5D%2C%20n22%20%3D%20te%5B4%5D%2C%20n32%20%3D%20te%5B5%5D%2C%20n13%20%3D%20te%5B6%5D%2C%20n23%20%3D%20te%5B7%5D%2C%20n33%20%3D%20te%5B8%5D%2C%20t11%20%3D%20n33%20%2A%20n22%20-%20n32%20%2A%20n23%2C%20t12%20%3D%20n32%20%2A%20n13%20-%20n33%20%2A%20n12%2C%20t13%20%3D%20n23%20%2A%20n12%20-%20n22%20%2A%20n13%2C%20det%20%3D%20n11%20%2A%20t11%20%2B%20n21%20%2A%20t12%20%2B%20n31%20%2A%20t13%3B%0A%20%20%20%20if%20%28det%20%3D%3D%3D%200%29%20return%20this.set%280%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20const%20detInv%20%3D%201%20%2F%20det%3B%0A%20%20%20%20te%5B0%5D%20%3D%20t11%20%2A%20detInv%3B%0A%20%20%20%20te%5B1%5D%20%3D%20%28n31%20%2A%20n23%20-%20n33%20%2A%20n21%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B2%5D%20%3D%20%28n32%20%2A%20n21%20-%20n31%20%2A%20n22%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B3%5D%20%3D%20t12%20%2A%20detInv%3B%0A%20%20%20%20te%5B4%5D%20%3D%20%28n33%20%2A%20n11%20-%20n31%20%2A%20n13%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B5%5D%20%3D%20%28n31%20%2A%20n12%20-%20n32%20%2A%20n11%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B6%5D%20%3D%20t13%20%2A%20detInv%3B%0A%20%20%20%20te%5B7%5D%20%3D%20%28n21%20%2A%20n13%20-%20n23%20%2A%20n11%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B8%5D%20%3D%20%28n22%20%2A%20n11%20-%20n21%20%2A%20n12%29%20%2A%20detInv%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20transpose%28%29%20%7B%0A%20%20%20%20let%20tmp2%3B%0A%20%20%20%20const%20m2%20%3D%20this.elements%3B%0A%20%20%20%20tmp2%20%3D%20m2%5B1%5D%3B%0A%20%20%20%20m2%5B1%5D%20%3D%20m2%5B3%5D%3B%0A%20%20%20%20m2%5B3%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20m2%5B2%5D%3B%0A%20%20%20%20m2%5B2%5D%20%3D%20m2%5B6%5D%3B%0A%20%20%20%20m2%5B6%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20m2%5B5%5D%3B%0A%20%20%20%20m2%5B5%5D%20%3D%20m2%5B7%5D%3B%0A%20%20%20%20m2%5B7%5D%20%3D%20tmp2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getNormalMatrix%28matrix4%29%20%7B%0A%20%20%20%20return%20this.setFromMatrix4%28matrix4%29.invert%28%29.transpose%28%29%3B%0A%20%20%7D%0A%20%20transposeIntoArray%28r%29%20%7B%0A%20%20%20%20const%20m2%20%3D%20this.elements%3B%0A%20%20%20%20r%5B0%5D%20%3D%20m2%5B0%5D%3B%0A%20%20%20%20r%5B1%5D%20%3D%20m2%5B3%5D%3B%0A%20%20%20%20r%5B2%5D%20%3D%20m2%5B6%5D%3B%0A%20%20%20%20r%5B3%5D%20%3D%20m2%5B1%5D%3B%0A%20%20%20%20r%5B4%5D%20%3D%20m2%5B4%5D%3B%0A%20%20%20%20r%5B5%5D%20%3D%20m2%5B7%5D%3B%0A%20%20%20%20r%5B6%5D%20%3D%20m2%5B2%5D%3B%0A%20%20%20%20r%5B7%5D%20%3D%20m2%5B5%5D%3B%0A%20%20%20%20r%5B8%5D%20%3D%20m2%5B8%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setUvTransform%28tx%2C%20ty%2C%20sx%2C%20sy%2C%20rotation%2C%20cx%2C%20cy%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28rotation%29%3B%0A%20%20%20%20const%20s%20%3D%20Math.sin%28rotation%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20sx%20%2A%20c2%2C%0A%20%20%20%20%20%20sx%20%2A%20s%2C%0A%20%20%20%20%20%20-sx%20%2A%20%28c2%20%2A%20cx%20%2B%20s%20%2A%20cy%29%20%2B%20cx%20%2B%20tx%2C%0A%20%20%20%20%20%20-sy%20%2A%20s%2C%0A%20%20%20%20%20%20sy%20%2A%20c2%2C%0A%20%20%20%20%20%20-sy%20%2A%20%28-s%20%2A%20cx%20%2B%20c2%20%2A%20cy%29%20%2B%20cy%20%2B%20ty%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%0A%20%20scale%28sx%2C%20sy%29%20%7B%0A%20%20%20%20this.premultiply%28_m32.makeScale%28sx%2C%20sy%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotate%28theta%29%20%7B%0A%20%20%20%20this.premultiply%28_m32.makeRotation%28-theta%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28tx%2C%20ty%29%20%7B%0A%20%20%20%20this.premultiply%28_m32.makeTranslation%28tx%2C%20ty%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20for%202D%20Transforms%0A%20%20makeTranslation%28x2%2C%20y2%29%20%7B%0A%20%20%20%20if%20%28x2.isVector2%29%20%7B%0A%20%20%20%20%20%20this.set%28%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2.x%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20x2.y%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.set%28%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotation%28theta%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28theta%29%3B%0A%20%20%20%20const%20s%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%20-s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20s%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeScale%28x2%2C%20y2%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%0A%20%20equals%28matrix%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20matrix.elements%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28te%5Bi%5D%20%21%3D%3D%20me%5Bi%5D%29%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.elements%5Bi%5D%20%3D%20array%5Bi%20%2B%20offset%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20array%5Boffset%5D%20%3D%20te%5B0%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20te%5B1%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20te%5B2%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20te%5B3%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%204%5D%20%3D%20te%5B4%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%205%5D%20%3D%20te%5B5%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%206%5D%20%3D%20te%5B6%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%207%5D%20%3D%20te%5B7%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%208%5D%20%3D%20te%5B8%5D%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.fromArray%28this.elements%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_m32%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix32%28%29%3B%0Afunction%20arrayNeedsUint32%241%28array%29%20%7B%0A%20%20for%20%28let%20i%20%3D%20array.length%20-%201%3B%20i%20%3E%3D%200%3B%20--i%29%20%7B%0A%20%20%20%20if%20%28array%5Bi%5D%20%3E%3D%2065535%29%20return%20true%3B%0A%20%20%7D%0A%20%20return%20false%3B%0A%7D%0Afunction%20createElementNS2%28name%29%20%7B%0A%20%20return%20document.createElementNS%28%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%2C%20name%29%3B%0A%7D%0Afunction%20createCanvasElement2%28%29%20%7B%0A%20%20const%20canvas%20%3D%20createElementNS2%28%22canvas%22%29%3B%0A%20%20canvas.style.display%20%3D%20%22block%22%3B%0A%20%20return%20canvas%3B%0A%7D%0Avar%20_cache%242%20%3D%20%7B%7D%3B%0Afunction%20warnOnce2%28message%29%20%7B%0A%20%20if%20%28message%20in%20_cache%242%29%20return%3B%0A%20%20_cache%242%5Bmessage%5D%20%3D%20true%3B%0A%20%20console.warn%28message%29%3B%0A%7D%0Avar%20ColorManagement2%20%3D%20%7B%0A%20%20enabled%3A%20true%2C%0A%20%20workingColorSpace%3A%20LinearSRGBColorSpace2%2C%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Implementations%20of%20supported%20color%20spaces.%0A%20%20%20%2A%0A%20%20%20%2A%20Required%3A%0A%20%20%20%2A%09-%20primaries%3A%20chromaticity%20coordinates%20%5B%20rx%20ry%20gx%20gy%20bx%20by%20%5D%0A%20%20%20%2A%09-%20whitePoint%3A%20reference%20white%20%5B%20x%20y%20%5D%0A%20%20%20%2A%09-%20transfer%3A%20transfer%20function%20%28pre-defined%29%0A%20%20%20%2A%09-%20toXYZ%3A%20Matrix3%20RGB%20to%20XYZ%20transform%0A%20%20%20%2A%09-%20fromXYZ%3A%20Matrix3%20XYZ%20to%20RGB%20transform%0A%20%20%20%2A%09-%20luminanceCoefficients%3A%20RGB%20luminance%20coefficients%0A%20%20%20%2A%0A%20%20%20%2A%20Optional%3A%0A%20%20%20%2A%20%20-%20outputColorSpaceConfig%3A%20%7B%20drawingBufferColorSpace%3A%20ColorSpace%20%7D%0A%20%20%20%2A%20%20-%20workingColorSpaceConfig%3A%20%7B%20unpackColorSpace%3A%20ColorSpace%20%7D%0A%20%20%20%2A%0A%20%20%20%2A%20Reference%3A%0A%20%20%20%2A%20-%20https%3A%2F%2Fwww.russellcottrell.com%2Fphoto%2FmatrixCalculator.htm%0A%20%20%20%2A%2F%0A%20%20spaces%3A%20%7B%7D%2C%0A%20%20convert%3A%20function%28color2%2C%20sourceColorSpace%2C%20targetColorSpace%29%20%7B%0A%20%20%20%20if%20%28this.enabled%20%3D%3D%3D%20false%20%7C%7C%20sourceColorSpace%20%3D%3D%3D%20targetColorSpace%20%7C%7C%20%21sourceColorSpace%20%7C%7C%20%21targetColorSpace%29%20%7B%0A%20%20%20%20%20%20return%20color2%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.spaces%5BsourceColorSpace%5D.transfer%20%3D%3D%3D%20SRGBTransfer2%29%20%7B%0A%20%20%20%20%20%20color2.r%20%3D%20SRGBToLinear2%28color2.r%29%3B%0A%20%20%20%20%20%20color2.g%20%3D%20SRGBToLinear2%28color2.g%29%3B%0A%20%20%20%20%20%20color2.b%20%3D%20SRGBToLinear2%28color2.b%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.spaces%5BsourceColorSpace%5D.primaries%20%21%3D%3D%20this.spaces%5BtargetColorSpace%5D.primaries%29%20%7B%0A%20%20%20%20%20%20color2.applyMatrix3%28this.spaces%5BsourceColorSpace%5D.toXYZ%29%3B%0A%20%20%20%20%20%20color2.applyMatrix3%28this.spaces%5BtargetColorSpace%5D.fromXYZ%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.spaces%5BtargetColorSpace%5D.transfer%20%3D%3D%3D%20SRGBTransfer2%29%20%7B%0A%20%20%20%20%20%20color2.r%20%3D%20LinearToSRGB2%28color2.r%29%3B%0A%20%20%20%20%20%20color2.g%20%3D%20LinearToSRGB2%28color2.g%29%3B%0A%20%20%20%20%20%20color2.b%20%3D%20LinearToSRGB2%28color2.b%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20color2%3B%0A%20%20%7D%2C%0A%20%20fromWorkingColorSpace%3A%20function%28color2%2C%20targetColorSpace%29%20%7B%0A%20%20%20%20return%20this.convert%28color2%2C%20this.workingColorSpace%2C%20targetColorSpace%29%3B%0A%20%20%7D%2C%0A%20%20toWorkingColorSpace%3A%20function%28color2%2C%20sourceColorSpace%29%20%7B%0A%20%20%20%20return%20this.convert%28color2%2C%20sourceColorSpace%2C%20this.workingColorSpace%29%3B%0A%20%20%7D%2C%0A%20%20getPrimaries%3A%20function%28colorSpace%29%20%7B%0A%20%20%20%20return%20this.spaces%5BcolorSpace%5D.primaries%3B%0A%20%20%7D%2C%0A%20%20getTransfer%3A%20function%28colorSpace%29%20%7B%0A%20%20%20%20if%20%28colorSpace%20%3D%3D%3D%20NoColorSpace2%29%20return%20LinearTransfer2%3B%0A%20%20%20%20return%20this.spaces%5BcolorSpace%5D.transfer%3B%0A%20%20%7D%2C%0A%20%20getLuminanceCoefficients%3A%20function%28target%2C%20colorSpace%20%3D%20this.workingColorSpace%29%20%7B%0A%20%20%20%20return%20target.fromArray%28this.spaces%5BcolorSpace%5D.luminanceCoefficients%29%3B%0A%20%20%7D%2C%0A%20%20define%3A%20function%28colorSpaces%29%20%7B%0A%20%20%20%20Object.assign%28this.spaces%2C%20colorSpaces%29%3B%0A%20%20%7D%2C%0A%20%20%2F%2F%20Internal%20APIs%0A%20%20_getMatrix%3A%20function%28targetMatrix%2C%20sourceColorSpace%2C%20targetColorSpace%29%20%7B%0A%20%20%20%20return%20targetMatrix.copy%28this.spaces%5BsourceColorSpace%5D.toXYZ%29.multiply%28this.spaces%5BtargetColorSpace%5D.fromXYZ%29%3B%0A%20%20%7D%2C%0A%20%20_getDrawingBufferColorSpace%3A%20function%28colorSpace%29%20%7B%0A%20%20%20%20return%20this.spaces%5BcolorSpace%5D.outputColorSpaceConfig.drawingBufferColorSpace%3B%0A%20%20%7D%2C%0A%20%20_getUnpackColorSpace%3A%20function%28colorSpace%20%3D%20this.workingColorSpace%29%20%7B%0A%20%20%20%20return%20this.spaces%5BcolorSpace%5D.workingColorSpaceConfig.unpackColorSpace%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20SRGBToLinear2%28c2%29%20%7B%0A%20%20return%20c2%20%3C%200.04045%20%3F%20c2%20%2A%200.0773993808%20%3A%20Math.pow%28c2%20%2A%200.9478672986%20%2B%200.0521327014%2C%202.4%29%3B%0A%7D%0Afunction%20LinearToSRGB2%28c2%29%20%7B%0A%20%20return%20c2%20%3C%2031308e-7%20%3F%20c2%20%2A%2012.92%20%3A%201.055%20%2A%20Math.pow%28c2%2C%200.41666%29%20-%200.055%3B%0A%7D%0Avar%20REC709_PRIMARIES2%20%3D%20%5B0.64%2C%200.33%2C%200.3%2C%200.6%2C%200.15%2C%200.06%5D%3B%0Avar%20REC709_LUMINANCE_COEFFICIENTS2%20%3D%20%5B0.2126%2C%200.7152%2C%200.0722%5D%3B%0Avar%20D652%20%3D%20%5B0.3127%2C%200.329%5D%3B%0Avar%20LINEAR_REC709_TO_XYZ2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix32%28%29.set%28%0A%20%200.4123908%2C%0A%20%200.3575843%2C%0A%20%200.1804808%2C%0A%20%200.212639%2C%0A%20%200.7151687%2C%0A%20%200.0721923%2C%0A%20%200.0193308%2C%0A%20%200.1191948%2C%0A%20%200.9505322%0A%29%3B%0Avar%20XYZ_TO_LINEAR_REC7092%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix32%28%29.set%28%0A%20%203.2409699%2C%0A%20%20-1.5373832%2C%0A%20%20-0.4986108%2C%0A%20%20-0.9692436%2C%0A%20%201.8759675%2C%0A%20%200.0415551%2C%0A%20%200.0556301%2C%0A%20%20-0.203977%2C%0A%20%201.0569715%0A%29%3B%0AColorManagement2.define%28%7B%0A%20%20%5BLinearSRGBColorSpace2%5D%3A%20%7B%0A%20%20%20%20primaries%3A%20REC709_PRIMARIES2%2C%0A%20%20%20%20whitePoint%3A%20D652%2C%0A%20%20%20%20transfer%3A%20LinearTransfer2%2C%0A%20%20%20%20toXYZ%3A%20LINEAR_REC709_TO_XYZ2%2C%0A%20%20%20%20fromXYZ%3A%20XYZ_TO_LINEAR_REC7092%2C%0A%20%20%20%20luminanceCoefficients%3A%20REC709_LUMINANCE_COEFFICIENTS2%2C%0A%20%20%20%20workingColorSpaceConfig%3A%20%7B%20unpackColorSpace%3A%20SRGBColorSpace2%20%7D%2C%0A%20%20%20%20outputColorSpaceConfig%3A%20%7B%20drawingBufferColorSpace%3A%20SRGBColorSpace2%20%7D%0A%20%20%7D%2C%0A%20%20%5BSRGBColorSpace2%5D%3A%20%7B%0A%20%20%20%20primaries%3A%20REC709_PRIMARIES2%2C%0A%20%20%20%20whitePoint%3A%20D652%2C%0A%20%20%20%20transfer%3A%20SRGBTransfer2%2C%0A%20%20%20%20toXYZ%3A%20LINEAR_REC709_TO_XYZ2%2C%0A%20%20%20%20fromXYZ%3A%20XYZ_TO_LINEAR_REC7092%2C%0A%20%20%20%20luminanceCoefficients%3A%20REC709_LUMINANCE_COEFFICIENTS2%2C%0A%20%20%20%20outputColorSpaceConfig%3A%20%7B%20drawingBufferColorSpace%3A%20SRGBColorSpace2%20%7D%0A%20%20%7D%0A%7D%29%3B%0Avar%20_canvas2%3B%0Avar%20ImageUtils2%20%3D%20class%20%7B%0A%20%20static%20getDataURL%28image%29%20%7B%0A%20%20%20%20if%20%28%2F%5Edata%3A%2Fi.test%28image.src%29%29%20%7B%0A%20%20%20%20%20%20return%20image.src%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28typeof%20HTMLCanvasElement%20%3D%3D%3D%20%22undefined%22%29%20%7B%0A%20%20%20%20%20%20return%20image.src%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20canvas%3B%0A%20%20%20%20if%20%28image%20instanceof%20HTMLCanvasElement%29%20%7B%0A%20%20%20%20%20%20canvas%20%3D%20image%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28_canvas2%20%3D%3D%3D%20void%200%29%20_canvas2%20%3D%20createElementNS2%28%22canvas%22%29%3B%0A%20%20%20%20%20%20_canvas2.width%20%3D%20image.width%3B%0A%20%20%20%20%20%20_canvas2.height%20%3D%20image.height%3B%0A%20%20%20%20%20%20const%20context2%20%3D%20_canvas2.getContext%28%222d%22%29%3B%0A%20%20%20%20%20%20if%20%28image%20instanceof%20ImageData%29%20%7B%0A%20%20%20%20%20%20%20%20context2.putImageData%28image%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20context2.drawImage%28image%2C%200%2C%200%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20canvas%20%3D%20_canvas2%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28canvas.width%20%3E%202048%20%7C%7C%20canvas.height%20%3E%202048%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.ImageUtils.getDataURL%3A%20Image%20converted%20to%20jpg%20for%20performance%20reasons%22%2C%20image%29%3B%0A%20%20%20%20%20%20return%20canvas.toDataURL%28%22image%2Fjpeg%22%2C%200.6%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20canvas.toDataURL%28%22image%2Fpng%22%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20static%20sRGBToLinear%28image%29%20%7B%0A%20%20%20%20if%20%28typeof%20HTMLImageElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLImageElement%20%7C%7C%20typeof%20HTMLCanvasElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLCanvasElement%20%7C%7C%20typeof%20ImageBitmap%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20ImageBitmap%29%20%7B%0A%20%20%20%20%20%20const%20canvas%20%3D%20createElementNS2%28%22canvas%22%29%3B%0A%20%20%20%20%20%20canvas.width%20%3D%20image.width%3B%0A%20%20%20%20%20%20canvas.height%20%3D%20image.height%3B%0A%20%20%20%20%20%20const%20context2%20%3D%20canvas.getContext%28%222d%22%29%3B%0A%20%20%20%20%20%20context2.drawImage%28image%2C%200%2C%200%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20const%20imageData%20%3D%20context2.getImageData%280%2C%200%2C%20image.width%2C%20image.height%29%3B%0A%20%20%20%20%20%20const%20data%20%3D%20imageData.data%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20data.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20data%5Bi%5D%20%3D%20SRGBToLinear2%28data%5Bi%5D%20%2F%20255%29%20%2A%20255%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20context2.putImageData%28imageData%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20return%20canvas%3B%0A%20%20%20%20%7D%20else%20if%20%28image.data%29%20%7B%0A%20%20%20%20%20%20const%20data%20%3D%20image.data.slice%280%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20data.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28data%20instanceof%20Uint8Array%20%7C%7C%20data%20instanceof%20Uint8ClampedArray%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20data%5Bi%5D%20%3D%20Math.floor%28SRGBToLinear2%28data%5Bi%5D%20%2F%20255%29%20%2A%20255%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20data%5Bi%5D%20%3D%20SRGBToLinear2%28data%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20data%2C%0A%20%20%20%20%20%20%20%20width%3A%20image.width%2C%0A%20%20%20%20%20%20%20%20height%3A%20image.height%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.ImageUtils.sRGBToLinear%28%29%3A%20Unsupported%20image%20type.%20No%20color%20space%20conversion%20applied.%22%29%3B%0A%20%20%20%20%20%20return%20image%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20_sourceId2%20%3D%200%3B%0Avar%20Source2%20%3D%20class%20%7B%0A%20%20constructor%28data%20%3D%20null%29%20%7B%0A%20%20%20%20this.isSource%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_sourceId2%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID2%28%29%3B%0A%20%20%20%20this.data%20%3D%20data%3B%0A%20%20%20%20this.dataReady%20%3D%20true%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20this.version%2B%2B%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20isRootObject%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20if%20%28%21isRootObject%20%26%26%20meta.images%5Bthis.uuid%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20return%20meta.images%5Bthis.uuid%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20output2%20%3D%20%7B%0A%20%20%20%20%20%20uuid%3A%20this.uuid%2C%0A%20%20%20%20%20%20url%3A%20%22%22%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20data%20%3D%20this.data%3B%0A%20%20%20%20if%20%28data%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20let%20url%3B%0A%20%20%20%20%20%20if%20%28Array.isArray%28data%29%29%20%7B%0A%20%20%20%20%20%20%20%20url%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20data.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28data%5Bi%5D.isDataTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20url.push%28serializeImage2%28data%5Bi%5D.image%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20url.push%28serializeImage2%28data%5Bi%5D%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20url%20%3D%20serializeImage2%28data%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20output2.url%20%3D%20url%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%21isRootObject%29%20%7B%0A%20%20%20%20%20%20meta.images%5Bthis.uuid%5D%20%3D%20output2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20serializeImage2%28image%29%20%7B%0A%20%20if%20%28typeof%20HTMLImageElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLImageElement%20%7C%7C%20typeof%20HTMLCanvasElement%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20HTMLCanvasElement%20%7C%7C%20typeof%20ImageBitmap%20%21%3D%3D%20%22undefined%22%20%26%26%20image%20instanceof%20ImageBitmap%29%20%7B%0A%20%20%20%20return%20ImageUtils2.getDataURL%28image%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28image.data%29%20%7B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20data%3A%20Array.from%28image.data%29%2C%0A%20%20%20%20%20%20%20%20width%3A%20image.width%2C%0A%20%20%20%20%20%20%20%20height%3A%20image.height%2C%0A%20%20%20%20%20%20%20%20type%3A%20image.data.constructor.name%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.Texture%3A%20Unable%20to%20serialize%20Texture.%22%29%3B%0A%20%20%20%20%20%20return%20%7B%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Avar%20_textureId2%20%3D%200%3B%0Avar%20Texture2%20%3D%20class%20_Texture%20extends%20EventDispatcher2%20%7B%0A%20%20constructor%28image%20%3D%20_Texture.DEFAULT_IMAGE%2C%20mapping%20%3D%20_Texture.DEFAULT_MAPPING%2C%20wrapS%20%3D%20ClampToEdgeWrapping2%2C%20wrapT%20%3D%20ClampToEdgeWrapping2%2C%20magFilter%20%3D%20LinearFilter2%2C%20minFilter%20%3D%20LinearMipmapLinearFilter2%2C%20format2%20%3D%20RGBAFormat2%2C%20type%20%3D%20UnsignedByteType2%2C%20anisotropy2%20%3D%20_Texture.DEFAULT_ANISOTROPY%2C%20colorSpace%20%3D%20NoColorSpace2%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isTexture%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_textureId2%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID2%28%29%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.source%20%3D%20new%20Source2%28image%29%3B%0A%20%20%20%20this.mipmaps%20%3D%20%5B%5D%3B%0A%20%20%20%20this.mapping%20%3D%20mapping%3B%0A%20%20%20%20this.channel%20%3D%200%3B%0A%20%20%20%20this.wrapS%20%3D%20wrapS%3B%0A%20%20%20%20this.wrapT%20%3D%20wrapT%3B%0A%20%20%20%20this.magFilter%20%3D%20magFilter%3B%0A%20%20%20%20this.minFilter%20%3D%20minFilter%3B%0A%20%20%20%20this.anisotropy%20%3D%20anisotropy2%3B%0A%20%20%20%20this.format%20%3D%20format2%3B%0A%20%20%20%20this.internalFormat%20%3D%20null%3B%0A%20%20%20%20this.type%20%3D%20type%3B%0A%20%20%20%20this.offset%20%3D%20new%20Vector22%280%2C%200%29%3B%0A%20%20%20%20this.repeat%20%3D%20new%20Vector22%281%2C%201%29%3B%0A%20%20%20%20this.center%20%3D%20new%20Vector22%280%2C%200%29%3B%0A%20%20%20%20this.rotation%20%3D%200%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20true%3B%0A%20%20%20%20this.matrix%20%3D%20new%20Matrix32%28%29%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20true%3B%0A%20%20%20%20this.premultiplyAlpha%20%3D%20false%3B%0A%20%20%20%20this.flipY%20%3D%20true%3B%0A%20%20%20%20this.unpackAlignment%20%3D%204%3B%0A%20%20%20%20this.colorSpace%20%3D%20colorSpace%3B%0A%20%20%20%20this.userData%20%3D%20%7B%7D%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%20%20this.onUpdate%20%3D%20null%3B%0A%20%20%20%20this.isRenderTargetTexture%20%3D%20false%3B%0A%20%20%20%20this.pmremVersion%20%3D%200%3B%0A%20%20%7D%0A%20%20get%20image%28%29%20%7B%0A%20%20%20%20return%20this.source.data%3B%0A%20%20%7D%0A%20%20set%20image%28value%20%3D%20null%29%20%7B%0A%20%20%20%20this.source.data%20%3D%20value%3B%0A%20%20%7D%0A%20%20updateMatrix%28%29%20%7B%0A%20%20%20%20this.matrix.setUvTransform%28this.offset.x%2C%20this.offset.y%2C%20this.repeat.x%2C%20this.repeat.y%2C%20this.rotation%2C%20this.center.x%2C%20this.center.y%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20this.source%20%3D%20source.source%3B%0A%20%20%20%20this.mipmaps%20%3D%20source.mipmaps.slice%280%29%3B%0A%20%20%20%20this.mapping%20%3D%20source.mapping%3B%0A%20%20%20%20this.channel%20%3D%20source.channel%3B%0A%20%20%20%20this.wrapS%20%3D%20source.wrapS%3B%0A%20%20%20%20this.wrapT%20%3D%20source.wrapT%3B%0A%20%20%20%20this.magFilter%20%3D%20source.magFilter%3B%0A%20%20%20%20this.minFilter%20%3D%20source.minFilter%3B%0A%20%20%20%20this.anisotropy%20%3D%20source.anisotropy%3B%0A%20%20%20%20this.format%20%3D%20source.format%3B%0A%20%20%20%20this.internalFormat%20%3D%20source.internalFormat%3B%0A%20%20%20%20this.type%20%3D%20source.type%3B%0A%20%20%20%20this.offset.copy%28source.offset%29%3B%0A%20%20%20%20this.repeat.copy%28source.repeat%29%3B%0A%20%20%20%20this.center.copy%28source.center%29%3B%0A%20%20%20%20this.rotation%20%3D%20source.rotation%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20source.matrixAutoUpdate%3B%0A%20%20%20%20this.matrix.copy%28source.matrix%29%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20source.generateMipmaps%3B%0A%20%20%20%20this.premultiplyAlpha%20%3D%20source.premultiplyAlpha%3B%0A%20%20%20%20this.flipY%20%3D%20source.flipY%3B%0A%20%20%20%20this.unpackAlignment%20%3D%20source.unpackAlignment%3B%0A%20%20%20%20this.colorSpace%20%3D%20source.colorSpace%3B%0A%20%20%20%20this.userData%20%3D%20JSON.parse%28JSON.stringify%28source.userData%29%29%3B%0A%20%20%20%20this.needsUpdate%20%3D%20true%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20isRootObject%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20if%20%28%21isRootObject%20%26%26%20meta.textures%5Bthis.uuid%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20return%20meta.textures%5Bthis.uuid%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20output2%20%3D%20%7B%0A%20%20%20%20%20%20metadata%3A%20%7B%0A%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22Texture%22%2C%0A%20%20%20%20%20%20%20%20generator%3A%20%22Texture.toJSON%22%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20uuid%3A%20this.uuid%2C%0A%20%20%20%20%20%20name%3A%20this.name%2C%0A%20%20%20%20%20%20image%3A%20this.source.toJSON%28meta%29.uuid%2C%0A%20%20%20%20%20%20mapping%3A%20this.mapping%2C%0A%20%20%20%20%20%20channel%3A%20this.channel%2C%0A%20%20%20%20%20%20repeat%3A%20%5Bthis.repeat.x%2C%20this.repeat.y%5D%2C%0A%20%20%20%20%20%20offset%3A%20%5Bthis.offset.x%2C%20this.offset.y%5D%2C%0A%20%20%20%20%20%20center%3A%20%5Bthis.center.x%2C%20this.center.y%5D%2C%0A%20%20%20%20%20%20rotation%3A%20this.rotation%2C%0A%20%20%20%20%20%20wrap%3A%20%5Bthis.wrapS%2C%20this.wrapT%5D%2C%0A%20%20%20%20%20%20format%3A%20this.format%2C%0A%20%20%20%20%20%20internalFormat%3A%20this.internalFormat%2C%0A%20%20%20%20%20%20type%3A%20this.type%2C%0A%20%20%20%20%20%20colorSpace%3A%20this.colorSpace%2C%0A%20%20%20%20%20%20minFilter%3A%20this.minFilter%2C%0A%20%20%20%20%20%20magFilter%3A%20this.magFilter%2C%0A%20%20%20%20%20%20anisotropy%3A%20this.anisotropy%2C%0A%20%20%20%20%20%20flipY%3A%20this.flipY%2C%0A%20%20%20%20%20%20generateMipmaps%3A%20this.generateMipmaps%2C%0A%20%20%20%20%20%20premultiplyAlpha%3A%20this.premultiplyAlpha%2C%0A%20%20%20%20%20%20unpackAlignment%3A%20this.unpackAlignment%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28Object.keys%28this.userData%29.length%20%3E%200%29%20output2.userData%20%3D%20this.userData%3B%0A%20%20%20%20if%20%28%21isRootObject%29%20%7B%0A%20%20%20%20%20%20meta.textures%5Bthis.uuid%5D%20%3D%20output2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%20%20transformUv%28uv2%29%20%7B%0A%20%20%20%20if%20%28this.mapping%20%21%3D%3D%20UVMapping2%29%20return%20uv2%3B%0A%20%20%20%20uv2.applyMatrix3%28this.matrix%29%3B%0A%20%20%20%20if%20%28uv2.x%20%3C%200%20%7C%7C%20uv2.x%20%3E%201%29%20%7B%0A%20%20%20%20%20%20switch%20%28this.wrapS%29%20%7B%0A%20%20%20%20%20%20%20%20case%20RepeatWrapping2%3A%0A%20%20%20%20%20%20%20%20%20%20uv2.x%20%3D%20uv2.x%20-%20Math.floor%28uv2.x%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20ClampToEdgeWrapping2%3A%0A%20%20%20%20%20%20%20%20%20%20uv2.x%20%3D%20uv2.x%20%3C%200%20%3F%200%20%3A%201%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20MirroredRepeatWrapping2%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28Math.abs%28Math.floor%28uv2.x%29%20%25%202%29%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uv2.x%20%3D%20Math.ceil%28uv2.x%29%20-%20uv2.x%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uv2.x%20%3D%20uv2.x%20-%20Math.floor%28uv2.x%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28uv2.y%20%3C%200%20%7C%7C%20uv2.y%20%3E%201%29%20%7B%0A%20%20%20%20%20%20switch%20%28this.wrapT%29%20%7B%0A%20%20%20%20%20%20%20%20case%20RepeatWrapping2%3A%0A%20%20%20%20%20%20%20%20%20%20uv2.y%20%3D%20uv2.y%20-%20Math.floor%28uv2.y%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20ClampToEdgeWrapping2%3A%0A%20%20%20%20%20%20%20%20%20%20uv2.y%20%3D%20uv2.y%20%3C%200%20%3F%200%20%3A%201%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20MirroredRepeatWrapping2%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28Math.abs%28Math.floor%28uv2.y%29%20%25%202%29%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uv2.y%20%3D%20Math.ceil%28uv2.y%29%20-%20uv2.y%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20uv2.y%20%3D%20uv2.y%20-%20Math.floor%28uv2.y%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.flipY%29%20%7B%0A%20%20%20%20%20%20uv2.y%20%3D%201%20-%20uv2.y%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20uv2%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%20%20this.source.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20set%20needsPMREMUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.pmremVersion%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0ATexture2.DEFAULT_IMAGE%20%3D%20null%3B%0ATexture2.DEFAULT_MAPPING%20%3D%20UVMapping2%3B%0ATexture2.DEFAULT_ANISOTROPY%20%3D%201%3B%0Avar%20Vector42%20%3D%20class%20_Vector4%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%2C%20z2%20%3D%200%2C%20w%20%3D%201%29%20%7B%0A%20%20%20%20_Vector4.prototype.isVector4%20%3D%20true%3B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20this.w%20%3D%20w%3B%0A%20%20%7D%0A%20%20get%20width%28%29%20%7B%0A%20%20%20%20return%20this.z%3B%0A%20%20%7D%0A%20%20set%20width%28value%29%20%7B%0A%20%20%20%20this.z%20%3D%20value%3B%0A%20%20%7D%0A%20%20get%20height%28%29%20%7B%0A%20%20%20%20return%20this.w%3B%0A%20%20%7D%0A%20%20set%20height%28value%29%20%7B%0A%20%20%20%20this.w%20%3D%20value%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20this.w%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%3D%20scalar%3B%0A%20%20%20%20this.y%20%3D%20scalar%3B%0A%20%20%20%20this.z%20%3D%20scalar%3B%0A%20%20%20%20this.w%20%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setX%28x2%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setY%28y2%29%20%7B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setZ%28z2%29%20%7B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setW%28w%29%20%7B%0A%20%20%20%20this.w%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setComponent%28index5%2C%20value%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20this.x%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20this.y%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20this.z%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%203%3A%0A%20%20%20%20%20%20%20%20this.w%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getComponent%28index5%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20return%20this.x%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20return%20this.y%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20return%20this.z%3B%0A%20%20%20%20%20%20case%203%3A%0A%20%20%20%20%20%20%20%20return%20this.w%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.x%2C%20this.y%2C%20this.z%2C%20this.w%29%3B%0A%20%20%7D%0A%20%20copy%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20v.x%3B%0A%20%20%20%20this.y%20%3D%20v.y%3B%0A%20%20%20%20this.z%20%3D%20v.z%3B%0A%20%20%20%20this.w%20%3D%20v.w%20%21%3D%3D%20void%200%20%3F%20v.w%20%3A%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20add%28v%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%3B%0A%20%20%20%20this.z%20%2B%3D%20v.z%3B%0A%20%20%20%20this.w%20%2B%3D%20v.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScalar%28s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20s%3B%0A%20%20%20%20this.z%20%2B%3D%20s%3B%0A%20%20%20%20this.w%20%2B%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20%2B%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20%2B%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20%2B%20b.z%3B%0A%20%20%20%20this.w%20%3D%20a2.w%20%2B%20b.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScaledVector%28v%2C%20s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%20%2A%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%20%2A%20s%3B%0A%20%20%20%20this.z%20%2B%3D%20v.z%20%2A%20s%3B%0A%20%20%20%20this.w%20%2B%3D%20v.w%20%2A%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20sub%28v%29%20%7B%0A%20%20%20%20this.x%20-%3D%20v.x%3B%0A%20%20%20%20this.y%20-%3D%20v.y%3B%0A%20%20%20%20this.z%20-%3D%20v.z%3B%0A%20%20%20%20this.w%20-%3D%20v.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subScalar%28s%29%20%7B%0A%20%20%20%20this.x%20-%3D%20s%3B%0A%20%20%20%20this.y%20-%3D%20s%3B%0A%20%20%20%20this.z%20-%3D%20s%3B%0A%20%20%20%20this.w%20-%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20-%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20-%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20-%20b.z%3B%0A%20%20%20%20this.w%20%3D%20a2.w%20-%20b.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28v%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20v.x%3B%0A%20%20%20%20this.y%20%2A%3D%20v.y%3B%0A%20%20%20%20this.z%20%2A%3D%20v.z%3B%0A%20%20%20%20this.w%20%2A%3D%20v.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20scalar%3B%0A%20%20%20%20this.y%20%2A%3D%20scalar%3B%0A%20%20%20%20this.z%20%2A%3D%20scalar%3B%0A%20%20%20%20this.w%20%2A%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix4%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%2C%20z2%20%3D%20this.z%2C%20w%20%3D%20this.w%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B0%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B8%5D%20%2A%20z2%20%2B%20e%5B12%5D%20%2A%20w%3B%0A%20%20%20%20this.y%20%3D%20e%5B1%5D%20%2A%20x2%20%2B%20e%5B5%5D%20%2A%20y2%20%2B%20e%5B9%5D%20%2A%20z2%20%2B%20e%5B13%5D%20%2A%20w%3B%0A%20%20%20%20this.z%20%3D%20e%5B2%5D%20%2A%20x2%20%2B%20e%5B6%5D%20%2A%20y2%20%2B%20e%5B10%5D%20%2A%20z2%20%2B%20e%5B14%5D%20%2A%20w%3B%0A%20%20%20%20this.w%20%3D%20e%5B3%5D%20%2A%20x2%20%2B%20e%5B7%5D%20%2A%20y2%20%2B%20e%5B11%5D%20%2A%20z2%20%2B%20e%5B15%5D%20%2A%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divide%28v%29%20%7B%0A%20%20%20%20this.x%20%2F%3D%20v.x%3B%0A%20%20%20%20this.y%20%2F%3D%20v.y%3B%0A%20%20%20%20this.z%20%2F%3D%20v.z%3B%0A%20%20%20%20this.w%20%2F%3D%20v.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divideScalar%28scalar%29%20%7B%0A%20%20%20%20return%20this.multiplyScalar%281%20%2F%20scalar%29%3B%0A%20%20%7D%0A%20%20setAxisAngleFromQuaternion%28q%29%20%7B%0A%20%20%20%20this.w%20%3D%202%20%2A%20Math.acos%28q.w%29%3B%0A%20%20%20%20const%20s%20%3D%20Math.sqrt%281%20-%20q.w%20%2A%20q.w%29%3B%0A%20%20%20%20if%20%28s%20%3C%201e-4%29%20%7B%0A%20%20%20%20%20%20this.x%20%3D%201%3B%0A%20%20%20%20%20%20this.y%20%3D%200%3B%0A%20%20%20%20%20%20this.z%20%3D%200%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.x%20%3D%20q.x%20%2F%20s%3B%0A%20%20%20%20%20%20this.y%20%3D%20q.y%20%2F%20s%3B%0A%20%20%20%20%20%20this.z%20%3D%20q.z%20%2F%20s%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setAxisAngleFromRotationMatrix%28m2%29%20%7B%0A%20%20%20%20let%20angle%2C%20x2%2C%20y2%2C%20z2%3B%0A%20%20%20%20const%20epsilon%20%3D%200.01%2C%20epsilon2%20%3D%200.1%2C%20te%20%3D%20m2.elements%2C%20m11%20%3D%20te%5B0%5D%2C%20m12%20%3D%20te%5B4%5D%2C%20m13%20%3D%20te%5B8%5D%2C%20m21%20%3D%20te%5B1%5D%2C%20m22%20%3D%20te%5B5%5D%2C%20m23%20%3D%20te%5B9%5D%2C%20m31%20%3D%20te%5B2%5D%2C%20m32%20%3D%20te%5B6%5D%2C%20m33%20%3D%20te%5B10%5D%3B%0A%20%20%20%20if%20%28Math.abs%28m12%20-%20m21%29%20%3C%20epsilon%20%26%26%20Math.abs%28m13%20-%20m31%29%20%3C%20epsilon%20%26%26%20Math.abs%28m23%20-%20m32%29%20%3C%20epsilon%29%20%7B%0A%20%20%20%20%20%20if%20%28Math.abs%28m12%20%2B%20m21%29%20%3C%20epsilon2%20%26%26%20Math.abs%28m13%20%2B%20m31%29%20%3C%20epsilon2%20%26%26%20Math.abs%28m23%20%2B%20m32%29%20%3C%20epsilon2%20%26%26%20Math.abs%28m11%20%2B%20m22%20%2B%20m33%20-%203%29%20%3C%20epsilon2%29%20%7B%0A%20%20%20%20%20%20%20%20this.set%281%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20angle%20%3D%20Math.PI%3B%0A%20%20%20%20%20%20const%20xx%20%3D%20%28m11%20%2B%201%29%20%2F%202%3B%0A%20%20%20%20%20%20const%20yy%20%3D%20%28m22%20%2B%201%29%20%2F%202%3B%0A%20%20%20%20%20%20const%20zz%20%3D%20%28m33%20%2B%201%29%20%2F%202%3B%0A%20%20%20%20%20%20const%20xy%20%3D%20%28m12%20%2B%20m21%29%20%2F%204%3B%0A%20%20%20%20%20%20const%20xz%20%3D%20%28m13%20%2B%20m31%29%20%2F%204%3B%0A%20%20%20%20%20%20const%20yz%20%3D%20%28m23%20%2B%20m32%29%20%2F%204%3B%0A%20%20%20%20%20%20if%20%28xx%20%3E%20yy%20%26%26%20xx%20%3E%20zz%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28xx%20%3C%20epsilon%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%20Math.sqrt%28xx%29%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%20xy%20%2F%20x2%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%20xz%20%2F%20x2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28yy%20%3E%20zz%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28yy%20%3C%20epsilon%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%20Math.sqrt%28yy%29%3B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%20xy%20%2F%20y2%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%20yz%20%2F%20y2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28zz%20%3C%20epsilon%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%200.707106781%3B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20z2%20%3D%20Math.sqrt%28zz%29%3B%0A%20%20%20%20%20%20%20%20%20%20x2%20%3D%20xz%20%2F%20z2%3B%0A%20%20%20%20%20%20%20%20%20%20y2%20%3D%20yz%20%2F%20z2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.set%28x2%2C%20y2%2C%20z2%2C%20angle%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20s%20%3D%20Math.sqrt%28%28m32%20-%20m23%29%20%2A%20%28m32%20-%20m23%29%20%2B%20%28m13%20-%20m31%29%20%2A%20%28m13%20-%20m31%29%20%2B%20%28m21%20-%20m12%29%20%2A%20%28m21%20-%20m12%29%29%3B%0A%20%20%20%20if%20%28Math.abs%28s%29%20%3C%201e-3%29%20s%20%3D%201%3B%0A%20%20%20%20this.x%20%3D%20%28m32%20-%20m23%29%20%2F%20s%3B%0A%20%20%20%20this.y%20%3D%20%28m13%20-%20m31%29%20%2F%20s%3B%0A%20%20%20%20this.z%20%3D%20%28m21%20-%20m12%29%20%2F%20s%3B%0A%20%20%20%20this.w%20%3D%20Math.acos%28%28m11%20%2B%20m22%20%2B%20m33%20-%201%29%20%2F%202%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrixPosition%28m2%29%20%7B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B12%5D%3B%0A%20%20%20%20this.y%20%3D%20e%5B13%5D%3B%0A%20%20%20%20this.z%20%3D%20e%5B14%5D%3B%0A%20%20%20%20this.w%20%3D%20e%5B15%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20min%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.min%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.min%28this.y%2C%20v.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.min%28this.z%2C%20v.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.min%28this.w%2C%20v.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20max%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28this.y%2C%20v.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28this.z%2C%20v.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.max%28this.w%2C%20v.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clamp%28min2%2C%20max2%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28min2.x%2C%20Math.min%28max2.x%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28min2.y%2C%20Math.min%28max2.y%2C%20this.y%29%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28min2.z%2C%20Math.min%28max2.z%2C%20this.z%29%29%3B%0A%20%20%20%20this.w%20%3D%20Math.max%28min2.w%2C%20Math.min%28max2.w%2C%20this.w%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampScalar%28minVal%2C%20maxVal%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.y%29%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.z%29%29%3B%0A%20%20%20%20this.w%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.w%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampLength%28min2%2C%20max2%29%20%7B%0A%20%20%20%20const%20length2%20%3D%20this.length%28%29%3B%0A%20%20%20%20return%20this.divideScalar%28length2%20%7C%7C%201%29.multiplyScalar%28Math.max%28min2%2C%20Math.min%28max2%2C%20length2%29%29%29%3B%0A%20%20%7D%0A%20%20floor%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.floor%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.floor%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.floor%28this.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.floor%28this.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20ceil%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.ceil%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.ceil%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.ceil%28this.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.ceil%28this.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20round%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.round%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.round%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.round%28this.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.round%28this.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20roundToZero%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.trunc%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.trunc%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.trunc%28this.z%29%3B%0A%20%20%20%20this.w%20%3D%20Math.trunc%28this.w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20negate%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20-this.x%3B%0A%20%20%20%20this.y%20%3D%20-this.y%3B%0A%20%20%20%20this.z%20%3D%20-this.z%3B%0A%20%20%20%20this.w%20%3D%20-this.w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dot%28v%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20v.x%20%2B%20this.y%20%2A%20v.y%20%2B%20this.z%20%2A%20v.z%20%2B%20this.w%20%2A%20v.w%3B%0A%20%20%7D%0A%20%20lengthSq%28%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%20%2B%20this.z%20%2A%20this.z%20%2B%20this.w%20%2A%20this.w%3B%0A%20%20%7D%0A%20%20length%28%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%20%2B%20this.z%20%2A%20this.z%20%2B%20this.w%20%2A%20this.w%29%3B%0A%20%20%7D%0A%20%20manhattanLength%28%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%29%20%2B%20Math.abs%28this.y%29%20%2B%20Math.abs%28this.z%29%20%2B%20Math.abs%28this.w%29%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20return%20this.divideScalar%28this.length%28%29%20%7C%7C%201%29%3B%0A%20%20%7D%0A%20%20setLength%28length2%29%20%7B%0A%20%20%20%20return%20this.normalize%28%29.multiplyScalar%28length2%29%3B%0A%20%20%7D%0A%20%20lerp%28v%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20%28v.x%20-%20this.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%2B%3D%20%28v.y%20-%20this.y%29%20%2A%20alpha%3B%0A%20%20%20%20this.z%20%2B%3D%20%28v.z%20-%20this.z%29%20%2A%20alpha%3B%0A%20%20%20%20this.w%20%2B%3D%20%28v.w%20-%20this.w%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpVectors%28v1%2C%20v2%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%3D%20v1.x%20%2B%20%28v2.x%20-%20v1.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%3D%20v1.y%20%2B%20%28v2.y%20-%20v1.y%29%20%2A%20alpha%3B%0A%20%20%20%20this.z%20%3D%20v1.z%20%2B%20%28v2.z%20-%20v1.z%29%20%2A%20alpha%3B%0A%20%20%20%20this.w%20%3D%20v1.w%20%2B%20%28v2.w%20-%20v1.w%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28v%29%20%7B%0A%20%20%20%20return%20v.x%20%3D%3D%3D%20this.x%20%26%26%20v.y%20%3D%3D%3D%20this.y%20%26%26%20v.z%20%3D%3D%3D%20this.z%20%26%26%20v.w%20%3D%3D%3D%20this.w%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.x%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this.y%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20this.z%20%3D%20array%5Boffset%20%2B%202%5D%3B%0A%20%20%20%20this.w%20%3D%20array%5Boffset%20%2B%203%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this.x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this.y%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this.z%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20this.w%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this.x%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this.y%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20this.z%20%3D%20attribute2.getZ%28index5%29%3B%0A%20%20%20%20this.w%20%3D%20attribute2.getW%28index5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20random%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.y%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.z%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.w%20%3D%20Math.random%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this.x%3B%0A%20%20%20%20yield%20this.y%3B%0A%20%20%20%20yield%20this.z%3B%0A%20%20%20%20yield%20this.w%3B%0A%20%20%7D%0A%7D%3B%0Avar%20RenderTarget2%20%3D%20class%20extends%20EventDispatcher2%20%7B%0A%20%20constructor%28width%20%3D%201%2C%20height%20%3D%201%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isRenderTarget%20%3D%20true%3B%0A%20%20%20%20this.width%20%3D%20width%3B%0A%20%20%20%20this.height%20%3D%20height%3B%0A%20%20%20%20this.depth%20%3D%201%3B%0A%20%20%20%20this.scissor%20%3D%20new%20Vector42%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20this.scissorTest%20%3D%20false%3B%0A%20%20%20%20this.viewport%20%3D%20new%20Vector42%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20const%20image%20%3D%20%7B%20width%2C%20height%2C%20depth%3A%201%20%7D%3B%0A%20%20%20%20options%20%3D%20Object.assign%28%7B%0A%20%20%20%20%20%20generateMipmaps%3A%20false%2C%0A%20%20%20%20%20%20internalFormat%3A%20null%2C%0A%20%20%20%20%20%20minFilter%3A%20LinearFilter2%2C%0A%20%20%20%20%20%20depthBuffer%3A%20true%2C%0A%20%20%20%20%20%20stencilBuffer%3A%20false%2C%0A%20%20%20%20%20%20resolveDepthBuffer%3A%20true%2C%0A%20%20%20%20%20%20resolveStencilBuffer%3A%20true%2C%0A%20%20%20%20%20%20depthTexture%3A%20null%2C%0A%20%20%20%20%20%20samples%3A%200%2C%0A%20%20%20%20%20%20count%3A%201%0A%20%20%20%20%7D%2C%20options%29%3B%0A%20%20%20%20const%20texture2%20%3D%20new%20Texture2%28image%2C%20options.mapping%2C%20options.wrapS%2C%20options.wrapT%2C%20options.magFilter%2C%20options.minFilter%2C%20options.format%2C%20options.type%2C%20options.anisotropy%2C%20options.colorSpace%29%3B%0A%20%20%20%20texture2.flipY%20%3D%20false%3B%0A%20%20%20%20texture2.generateMipmaps%20%3D%20options.generateMipmaps%3B%0A%20%20%20%20texture2.internalFormat%20%3D%20options.internalFormat%3B%0A%20%20%20%20this.textures%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20count%20%3D%20options.count%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20count%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.textures%5Bi%5D%20%3D%20texture2.clone%28%29%3B%0A%20%20%20%20%20%20this.textures%5Bi%5D.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.depthBuffer%20%3D%20options.depthBuffer%3B%0A%20%20%20%20this.stencilBuffer%20%3D%20options.stencilBuffer%3B%0A%20%20%20%20this.resolveDepthBuffer%20%3D%20options.resolveDepthBuffer%3B%0A%20%20%20%20this.resolveStencilBuffer%20%3D%20options.resolveStencilBuffer%3B%0A%20%20%20%20this.depthTexture%20%3D%20options.depthTexture%3B%0A%20%20%20%20this.samples%20%3D%20options.samples%3B%0A%20%20%7D%0A%20%20get%20texture%28%29%20%7B%0A%20%20%20%20return%20this.textures%5B0%5D%3B%0A%20%20%7D%0A%20%20set%20texture%28value%29%20%7B%0A%20%20%20%20this.textures%5B0%5D%20%3D%20value%3B%0A%20%20%7D%0A%20%20setSize%28width%2C%20height%2C%20depth2%20%3D%201%29%20%7B%0A%20%20%20%20if%20%28this.width%20%21%3D%3D%20width%20%7C%7C%20this.height%20%21%3D%3D%20height%20%7C%7C%20this.depth%20%21%3D%3D%20depth2%29%20%7B%0A%20%20%20%20%20%20this.width%20%3D%20width%3B%0A%20%20%20%20%20%20this.height%20%3D%20height%3B%0A%20%20%20%20%20%20this.depth%20%3D%20depth2%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20this.textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this.textures%5Bi%5D.image.width%20%3D%20width%3B%0A%20%20%20%20%20%20%20%20this.textures%5Bi%5D.image.height%20%3D%20height%3B%0A%20%20%20%20%20%20%20%20this.textures%5Bi%5D.image.depth%20%3D%20depth2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.viewport.set%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20this.scissor.set%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.width%20%3D%20source.width%3B%0A%20%20%20%20this.height%20%3D%20source.height%3B%0A%20%20%20%20this.depth%20%3D%20source.depth%3B%0A%20%20%20%20this.scissor.copy%28source.scissor%29%3B%0A%20%20%20%20this.scissorTest%20%3D%20source.scissorTest%3B%0A%20%20%20%20this.viewport.copy%28source.viewport%29%3B%0A%20%20%20%20this.textures.length%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20source.textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.textures%5Bi%5D%20%3D%20source.textures%5Bi%5D.clone%28%29%3B%0A%20%20%20%20%20%20this.textures%5Bi%5D.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20image%20%3D%20Object.assign%28%7B%7D%2C%20source.texture.image%29%3B%0A%20%20%20%20this.texture.source%20%3D%20new%20Source2%28image%29%3B%0A%20%20%20%20this.depthBuffer%20%3D%20source.depthBuffer%3B%0A%20%20%20%20this.stencilBuffer%20%3D%20source.stencilBuffer%3B%0A%20%20%20%20this.resolveDepthBuffer%20%3D%20source.resolveDepthBuffer%3B%0A%20%20%20%20this.resolveStencilBuffer%20%3D%20source.resolveStencilBuffer%3B%0A%20%20%20%20if%20%28source.depthTexture%20%21%3D%3D%20null%29%20this.depthTexture%20%3D%20source.depthTexture.clone%28%29%3B%0A%20%20%20%20this.samples%20%3D%20source.samples%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGLRenderTarget2%20%3D%20class%20extends%20RenderTarget2%20%7B%0A%20%20constructor%28width%20%3D%201%2C%20height%20%3D%201%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28width%2C%20height%2C%20options%29%3B%0A%20%20%20%20this.isWebGLRenderTarget%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DataArrayTexture2%20%3D%20class%20extends%20Texture2%20%7B%0A%20%20constructor%28data%20%3D%20null%2C%20width%20%3D%201%2C%20height%20%3D%201%2C%20depth2%20%3D%201%29%20%7B%0A%20%20%20%20super%28null%29%3B%0A%20%20%20%20this.isDataArrayTexture%20%3D%20true%3B%0A%20%20%20%20this.image%20%3D%20%7B%20data%2C%20width%2C%20height%2C%20depth%3A%20depth2%20%7D%3B%0A%20%20%20%20this.magFilter%20%3D%20NearestFilter2%3B%0A%20%20%20%20this.minFilter%20%3D%20NearestFilter2%3B%0A%20%20%20%20this.wrapR%20%3D%20ClampToEdgeWrapping2%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20this.flipY%20%3D%20false%3B%0A%20%20%20%20this.unpackAlignment%20%3D%201%3B%0A%20%20%20%20this.layerUpdates%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%29%3B%0A%20%20%7D%0A%20%20addLayerUpdate%28layerIndex%29%20%7B%0A%20%20%20%20this.layerUpdates.add%28layerIndex%29%3B%0A%20%20%7D%0A%20%20clearLayerUpdates%28%29%20%7B%0A%20%20%20%20this.layerUpdates.clear%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Quaternion2%20%3D%20class%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%2C%20z2%20%3D%200%2C%20w%20%3D%201%29%20%7B%0A%20%20%20%20this.isQuaternion%20%3D%20true%3B%0A%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20this._w%20%3D%20w%3B%0A%20%20%7D%0A%20%20static%20slerpFlat%28dst%2C%20dstOffset%2C%20src0%2C%20srcOffset0%2C%20src1%2C%20srcOffset1%2C%20t%29%20%7B%0A%20%20%20%20let%20x0%20%3D%20src0%5BsrcOffset0%20%2B%200%5D%2C%20y0%20%3D%20src0%5BsrcOffset0%20%2B%201%5D%2C%20z0%20%3D%20src0%5BsrcOffset0%20%2B%202%5D%2C%20w02%20%3D%20src0%5BsrcOffset0%20%2B%203%5D%3B%0A%20%20%20%20const%20x1%20%3D%20src1%5BsrcOffset1%20%2B%200%5D%2C%20y1%20%3D%20src1%5BsrcOffset1%20%2B%201%5D%2C%20z1%20%3D%20src1%5BsrcOffset1%20%2B%202%5D%2C%20w12%20%3D%20src1%5BsrcOffset1%20%2B%203%5D%3B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%200%5D%20%3D%20x0%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%201%5D%20%3D%20y0%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%202%5D%20%3D%20z0%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%203%5D%20%3D%20w02%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28t%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%200%5D%20%3D%20x1%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%201%5D%20%3D%20y1%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%202%5D%20%3D%20z1%3B%0A%20%20%20%20%20%20dst%5BdstOffset%20%2B%203%5D%20%3D%20w12%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28w02%20%21%3D%3D%20w12%20%7C%7C%20x0%20%21%3D%3D%20x1%20%7C%7C%20y0%20%21%3D%3D%20y1%20%7C%7C%20z0%20%21%3D%3D%20z1%29%20%7B%0A%20%20%20%20%20%20let%20s%20%3D%201%20-%20t%3B%0A%20%20%20%20%20%20const%20cos2%20%3D%20x0%20%2A%20x1%20%2B%20y0%20%2A%20y1%20%2B%20z0%20%2A%20z1%20%2B%20w02%20%2A%20w12%2C%20dir%20%3D%20cos2%20%3E%3D%200%20%3F%201%20%3A%20-1%2C%20sqrSin%20%3D%201%20-%20cos2%20%2A%20cos2%3B%0A%20%20%20%20%20%20if%20%28sqrSin%20%3E%20Number.EPSILON%29%20%7B%0A%20%20%20%20%20%20%20%20const%20sin2%20%3D%20Math.sqrt%28sqrSin%29%2C%20len%20%3D%20Math.atan2%28sin2%2C%20cos2%20%2A%20dir%29%3B%0A%20%20%20%20%20%20%20%20s%20%3D%20Math.sin%28s%20%2A%20len%29%20%2F%20sin2%3B%0A%20%20%20%20%20%20%20%20t%20%3D%20Math.sin%28t%20%2A%20len%29%20%2F%20sin2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20tDir%20%3D%20t%20%2A%20dir%3B%0A%20%20%20%20%20%20x0%20%3D%20x0%20%2A%20s%20%2B%20x1%20%2A%20tDir%3B%0A%20%20%20%20%20%20y0%20%3D%20y0%20%2A%20s%20%2B%20y1%20%2A%20tDir%3B%0A%20%20%20%20%20%20z0%20%3D%20z0%20%2A%20s%20%2B%20z1%20%2A%20tDir%3B%0A%20%20%20%20%20%20w02%20%3D%20w02%20%2A%20s%20%2B%20w12%20%2A%20tDir%3B%0A%20%20%20%20%20%20if%20%28s%20%3D%3D%3D%201%20-%20t%29%20%7B%0A%20%20%20%20%20%20%20%20const%20f%20%3D%201%20%2F%20Math.sqrt%28x0%20%2A%20x0%20%2B%20y0%20%2A%20y0%20%2B%20z0%20%2A%20z0%20%2B%20w02%20%2A%20w02%29%3B%0A%20%20%20%20%20%20%20%20x0%20%2A%3D%20f%3B%0A%20%20%20%20%20%20%20%20y0%20%2A%3D%20f%3B%0A%20%20%20%20%20%20%20%20z0%20%2A%3D%20f%3B%0A%20%20%20%20%20%20%20%20w02%20%2A%3D%20f%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20dst%5BdstOffset%5D%20%3D%20x0%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%201%5D%20%3D%20y0%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%202%5D%20%3D%20z0%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%203%5D%20%3D%20w02%3B%0A%20%20%7D%0A%20%20static%20multiplyQuaternionsFlat%28dst%2C%20dstOffset%2C%20src0%2C%20srcOffset0%2C%20src1%2C%20srcOffset1%29%20%7B%0A%20%20%20%20const%20x0%20%3D%20src0%5BsrcOffset0%5D%3B%0A%20%20%20%20const%20y0%20%3D%20src0%5BsrcOffset0%20%2B%201%5D%3B%0A%20%20%20%20const%20z0%20%3D%20src0%5BsrcOffset0%20%2B%202%5D%3B%0A%20%20%20%20const%20w02%20%3D%20src0%5BsrcOffset0%20%2B%203%5D%3B%0A%20%20%20%20const%20x1%20%3D%20src1%5BsrcOffset1%5D%3B%0A%20%20%20%20const%20y1%20%3D%20src1%5BsrcOffset1%20%2B%201%5D%3B%0A%20%20%20%20const%20z1%20%3D%20src1%5BsrcOffset1%20%2B%202%5D%3B%0A%20%20%20%20const%20w12%20%3D%20src1%5BsrcOffset1%20%2B%203%5D%3B%0A%20%20%20%20dst%5BdstOffset%5D%20%3D%20x0%20%2A%20w12%20%2B%20w02%20%2A%20x1%20%2B%20y0%20%2A%20z1%20-%20z0%20%2A%20y1%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%201%5D%20%3D%20y0%20%2A%20w12%20%2B%20w02%20%2A%20y1%20%2B%20z0%20%2A%20x1%20-%20x0%20%2A%20z1%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%202%5D%20%3D%20z0%20%2A%20w12%20%2B%20w02%20%2A%20z1%20%2B%20x0%20%2A%20y1%20-%20y0%20%2A%20x1%3B%0A%20%20%20%20dst%5BdstOffset%20%2B%203%5D%20%3D%20w02%20%2A%20w12%20-%20x0%20%2A%20x1%20-%20y0%20%2A%20y1%20-%20z0%20%2A%20z1%3B%0A%20%20%20%20return%20dst%3B%0A%20%20%7D%0A%20%20get%20x%28%29%20%7B%0A%20%20%20%20return%20this._x%3B%0A%20%20%7D%0A%20%20set%20x%28value%29%20%7B%0A%20%20%20%20this._x%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20y%28%29%20%7B%0A%20%20%20%20return%20this._y%3B%0A%20%20%7D%0A%20%20set%20y%28value%29%20%7B%0A%20%20%20%20this._y%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20z%28%29%20%7B%0A%20%20%20%20return%20this._z%3B%0A%20%20%7D%0A%20%20set%20z%28value%29%20%7B%0A%20%20%20%20this._z%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20w%28%29%20%7B%0A%20%20%20%20return%20this._w%3B%0A%20%20%7D%0A%20%20set%20w%28value%29%20%7B%0A%20%20%20%20this._w%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20this._w%20%3D%20w%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this._x%2C%20this._y%2C%20this._z%2C%20this._w%29%3B%0A%20%20%7D%0A%20%20copy%28quaternion%29%20%7B%0A%20%20%20%20this._x%20%3D%20quaternion.x%3B%0A%20%20%20%20this._y%20%3D%20quaternion.y%3B%0A%20%20%20%20this._z%20%3D%20quaternion.z%3B%0A%20%20%20%20this._w%20%3D%20quaternion.w%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromEuler%28euler%2C%20update4%20%3D%20true%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20euler._x%2C%20y2%20%3D%20euler._y%2C%20z2%20%3D%20euler._z%2C%20order%20%3D%20euler._order%3B%0A%20%20%20%20const%20cos2%20%3D%20Math.cos%3B%0A%20%20%20%20const%20sin2%20%3D%20Math.sin%3B%0A%20%20%20%20const%20c1%20%3D%20cos2%28x2%20%2F%202%29%3B%0A%20%20%20%20const%20c2%20%3D%20cos2%28y2%20%2F%202%29%3B%0A%20%20%20%20const%20c3%20%3D%20cos2%28z2%20%2F%202%29%3B%0A%20%20%20%20const%20s1%20%3D%20sin2%28x2%20%2F%202%29%3B%0A%20%20%20%20const%20s2%20%3D%20sin2%28y2%20%2F%202%29%3B%0A%20%20%20%20const%20s3%20%3D%20sin2%28z2%20%2F%202%29%3B%0A%20%20%20%20switch%20%28order%29%20%7B%0A%20%20%20%20%20%20case%20%22XYZ%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20%2B%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20-%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20%2B%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20-%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22YXZ%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20%2B%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20-%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20-%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20%2B%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22ZXY%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20-%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20%2B%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20%2B%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20-%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22ZYX%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20-%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20%2B%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20-%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20%2B%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22YZX%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20%2B%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20%2B%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20-%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20-%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22XZY%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20s1%20%2A%20c2%20%2A%20c3%20-%20c1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20c1%20%2A%20s2%20%2A%20c3%20-%20s1%20%2A%20c2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20c1%20%2A%20c2%20%2A%20s3%20%2B%20s1%20%2A%20s2%20%2A%20c3%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20c1%20%2A%20c2%20%2A%20c3%20%2B%20s1%20%2A%20s2%20%2A%20s3%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.Quaternion%3A%20.setFromEuler%28%29%20encountered%20an%20unknown%20order%3A%20%22%20%2B%20order%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28update4%20%3D%3D%3D%20true%29%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromAxisAngle%28axis%2C%20angle%29%20%7B%0A%20%20%20%20const%20halfAngle%20%3D%20angle%20%2F%202%2C%20s%20%3D%20Math.sin%28halfAngle%29%3B%0A%20%20%20%20this._x%20%3D%20axis.x%20%2A%20s%3B%0A%20%20%20%20this._y%20%3D%20axis.y%20%2A%20s%3B%0A%20%20%20%20this._z%20%3D%20axis.z%20%2A%20s%3B%0A%20%20%20%20this._w%20%3D%20Math.cos%28halfAngle%29%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromRotationMatrix%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20m2.elements%2C%20m11%20%3D%20te%5B0%5D%2C%20m12%20%3D%20te%5B4%5D%2C%20m13%20%3D%20te%5B8%5D%2C%20m21%20%3D%20te%5B1%5D%2C%20m22%20%3D%20te%5B5%5D%2C%20m23%20%3D%20te%5B9%5D%2C%20m31%20%3D%20te%5B2%5D%2C%20m32%20%3D%20te%5B6%5D%2C%20m33%20%3D%20te%5B10%5D%2C%20trace%20%3D%20m11%20%2B%20m22%20%2B%20m33%3B%0A%20%20%20%20if%20%28trace%20%3E%200%29%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%200.5%20%2F%20Math.sqrt%28trace%20%2B%201%29%3B%0A%20%20%20%20%20%20this._w%20%3D%200.25%20%2F%20s%3B%0A%20%20%20%20%20%20this._x%20%3D%20%28m32%20-%20m23%29%20%2A%20s%3B%0A%20%20%20%20%20%20this._y%20%3D%20%28m13%20-%20m31%29%20%2A%20s%3B%0A%20%20%20%20%20%20this._z%20%3D%20%28m21%20-%20m12%29%20%2A%20s%3B%0A%20%20%20%20%7D%20else%20if%20%28m11%20%3E%20m22%20%26%26%20m11%20%3E%20m33%29%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%202%20%2A%20Math.sqrt%281%20%2B%20m11%20-%20m22%20-%20m33%29%3B%0A%20%20%20%20%20%20this._w%20%3D%20%28m32%20-%20m23%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._x%20%3D%200.25%20%2A%20s%3B%0A%20%20%20%20%20%20this._y%20%3D%20%28m12%20%2B%20m21%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._z%20%3D%20%28m13%20%2B%20m31%29%20%2F%20s%3B%0A%20%20%20%20%7D%20else%20if%20%28m22%20%3E%20m33%29%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%202%20%2A%20Math.sqrt%281%20%2B%20m22%20-%20m11%20-%20m33%29%3B%0A%20%20%20%20%20%20this._w%20%3D%20%28m13%20-%20m31%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._x%20%3D%20%28m12%20%2B%20m21%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._y%20%3D%200.25%20%2A%20s%3B%0A%20%20%20%20%20%20this._z%20%3D%20%28m23%20%2B%20m32%29%20%2F%20s%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%202%20%2A%20Math.sqrt%281%20%2B%20m33%20-%20m11%20-%20m22%29%3B%0A%20%20%20%20%20%20this._w%20%3D%20%28m21%20-%20m12%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._x%20%3D%20%28m13%20%2B%20m31%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._y%20%3D%20%28m23%20%2B%20m32%29%20%2F%20s%3B%0A%20%20%20%20%20%20this._z%20%3D%200.25%20%2A%20s%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromUnitVectors%28vFrom%2C%20vTo%29%20%7B%0A%20%20%20%20let%20r%20%3D%20vFrom.dot%28vTo%29%20%2B%201%3B%0A%20%20%20%20if%20%28r%20%3C%20Number.EPSILON%29%20%7B%0A%20%20%20%20%20%20r%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28Math.abs%28vFrom.x%29%20%3E%20Math.abs%28vFrom.z%29%29%20%7B%0A%20%20%20%20%20%20%20%20this._x%20%3D%20-vFrom.y%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20vFrom.x%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%200%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20r%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this._x%20%3D%200%3B%0A%20%20%20%20%20%20%20%20this._y%20%3D%20-vFrom.z%3B%0A%20%20%20%20%20%20%20%20this._z%20%3D%20vFrom.y%3B%0A%20%20%20%20%20%20%20%20this._w%20%3D%20r%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._x%20%3D%20vFrom.y%20%2A%20vTo.z%20-%20vFrom.z%20%2A%20vTo.y%3B%0A%20%20%20%20%20%20this._y%20%3D%20vFrom.z%20%2A%20vTo.x%20-%20vFrom.x%20%2A%20vTo.z%3B%0A%20%20%20%20%20%20this._z%20%3D%20vFrom.x%20%2A%20vTo.y%20-%20vFrom.y%20%2A%20vTo.x%3B%0A%20%20%20%20%20%20this._w%20%3D%20r%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.normalize%28%29%3B%0A%20%20%7D%0A%20%20angleTo%28q%29%20%7B%0A%20%20%20%20return%202%20%2A%20Math.acos%28Math.abs%28clamp%241%28this.dot%28q%29%2C%20-1%2C%201%29%29%29%3B%0A%20%20%7D%0A%20%20rotateTowards%28q%2C%20step2%29%20%7B%0A%20%20%20%20const%20angle%20%3D%20this.angleTo%28q%29%3B%0A%20%20%20%20if%20%28angle%20%3D%3D%3D%200%29%20return%20this%3B%0A%20%20%20%20const%20t%20%3D%20Math.min%281%2C%20step2%20%2F%20angle%29%3B%0A%20%20%20%20this.slerp%28q%2C%20t%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20identity%28%29%20%7B%0A%20%20%20%20return%20this.set%280%2C%200%2C%200%2C%201%29%3B%0A%20%20%7D%0A%20%20invert%28%29%20%7B%0A%20%20%20%20return%20this.conjugate%28%29%3B%0A%20%20%7D%0A%20%20conjugate%28%29%20%7B%0A%20%20%20%20this._x%20%2A%3D%20-1%3B%0A%20%20%20%20this._y%20%2A%3D%20-1%3B%0A%20%20%20%20this._z%20%2A%3D%20-1%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dot%28v%29%20%7B%0A%20%20%20%20return%20this._x%20%2A%20v._x%20%2B%20this._y%20%2A%20v._y%20%2B%20this._z%20%2A%20v._z%20%2B%20this._w%20%2A%20v._w%3B%0A%20%20%7D%0A%20%20lengthSq%28%29%20%7B%0A%20%20%20%20return%20this._x%20%2A%20this._x%20%2B%20this._y%20%2A%20this._y%20%2B%20this._z%20%2A%20this._z%20%2B%20this._w%20%2A%20this._w%3B%0A%20%20%7D%0A%20%20length%28%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this._x%20%2A%20this._x%20%2B%20this._y%20%2A%20this._y%20%2B%20this._z%20%2A%20this._z%20%2B%20this._w%20%2A%20this._w%29%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20let%20l%20%3D%20this.length%28%29%3B%0A%20%20%20%20if%20%28l%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20this._x%20%3D%200%3B%0A%20%20%20%20%20%20this._y%20%3D%200%3B%0A%20%20%20%20%20%20this._z%20%3D%200%3B%0A%20%20%20%20%20%20this._w%20%3D%201%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20l%20%3D%201%20%2F%20l%3B%0A%20%20%20%20%20%20this._x%20%3D%20this._x%20%2A%20l%3B%0A%20%20%20%20%20%20this._y%20%3D%20this._y%20%2A%20l%3B%0A%20%20%20%20%20%20this._z%20%3D%20this._z%20%2A%20l%3B%0A%20%20%20%20%20%20this._w%20%3D%20this._w%20%2A%20l%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28q%29%20%7B%0A%20%20%20%20return%20this.multiplyQuaternions%28this%2C%20q%29%3B%0A%20%20%7D%0A%20%20premultiply%28q%29%20%7B%0A%20%20%20%20return%20this.multiplyQuaternions%28q%2C%20this%29%3B%0A%20%20%7D%0A%20%20multiplyQuaternions%28a2%2C%20b%29%20%7B%0A%20%20%20%20const%20qax%20%3D%20a2._x%2C%20qay%20%3D%20a2._y%2C%20qaz%20%3D%20a2._z%2C%20qaw%20%3D%20a2._w%3B%0A%20%20%20%20const%20qbx%20%3D%20b._x%2C%20qby%20%3D%20b._y%2C%20qbz%20%3D%20b._z%2C%20qbw%20%3D%20b._w%3B%0A%20%20%20%20this._x%20%3D%20qax%20%2A%20qbw%20%2B%20qaw%20%2A%20qbx%20%2B%20qay%20%2A%20qbz%20-%20qaz%20%2A%20qby%3B%0A%20%20%20%20this._y%20%3D%20qay%20%2A%20qbw%20%2B%20qaw%20%2A%20qby%20%2B%20qaz%20%2A%20qbx%20-%20qax%20%2A%20qbz%3B%0A%20%20%20%20this._z%20%3D%20qaz%20%2A%20qbw%20%2B%20qaw%20%2A%20qbz%20%2B%20qax%20%2A%20qby%20-%20qay%20%2A%20qbx%3B%0A%20%20%20%20this._w%20%3D%20qaw%20%2A%20qbw%20-%20qax%20%2A%20qbx%20-%20qay%20%2A%20qby%20-%20qaz%20%2A%20qbz%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20slerp%28qb%2C%20t%29%20%7B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%200%29%20return%20this%3B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%201%29%20return%20this.copy%28qb%29%3B%0A%20%20%20%20const%20x2%20%3D%20this._x%2C%20y2%20%3D%20this._y%2C%20z2%20%3D%20this._z%2C%20w%20%3D%20this._w%3B%0A%20%20%20%20let%20cosHalfTheta%20%3D%20w%20%2A%20qb._w%20%2B%20x2%20%2A%20qb._x%20%2B%20y2%20%2A%20qb._y%20%2B%20z2%20%2A%20qb._z%3B%0A%20%20%20%20if%20%28cosHalfTheta%20%3C%200%29%20%7B%0A%20%20%20%20%20%20this._w%20%3D%20-qb._w%3B%0A%20%20%20%20%20%20this._x%20%3D%20-qb._x%3B%0A%20%20%20%20%20%20this._y%20%3D%20-qb._y%3B%0A%20%20%20%20%20%20this._z%20%3D%20-qb._z%3B%0A%20%20%20%20%20%20cosHalfTheta%20%3D%20-cosHalfTheta%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.copy%28qb%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28cosHalfTheta%20%3E%3D%201%29%20%7B%0A%20%20%20%20%20%20this._w%20%3D%20w%3B%0A%20%20%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20sqrSinHalfTheta%20%3D%201%20-%20cosHalfTheta%20%2A%20cosHalfTheta%3B%0A%20%20%20%20if%20%28sqrSinHalfTheta%20%3C%3D%20Number.EPSILON%29%20%7B%0A%20%20%20%20%20%20const%20s%20%3D%201%20-%20t%3B%0A%20%20%20%20%20%20this._w%20%3D%20s%20%2A%20w%20%2B%20t%20%2A%20this._w%3B%0A%20%20%20%20%20%20this._x%20%3D%20s%20%2A%20x2%20%2B%20t%20%2A%20this._x%3B%0A%20%20%20%20%20%20this._y%20%3D%20s%20%2A%20y2%20%2B%20t%20%2A%20this._y%3B%0A%20%20%20%20%20%20this._z%20%3D%20s%20%2A%20z2%20%2B%20t%20%2A%20this._z%3B%0A%20%20%20%20%20%20this.normalize%28%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20sinHalfTheta%20%3D%20Math.sqrt%28sqrSinHalfTheta%29%3B%0A%20%20%20%20const%20halfTheta%20%3D%20Math.atan2%28sinHalfTheta%2C%20cosHalfTheta%29%3B%0A%20%20%20%20const%20ratioA%20%3D%20Math.sin%28%281%20-%20t%29%20%2A%20halfTheta%29%20%2F%20sinHalfTheta%2C%20ratioB%20%3D%20Math.sin%28t%20%2A%20halfTheta%29%20%2F%20sinHalfTheta%3B%0A%20%20%20%20this._w%20%3D%20w%20%2A%20ratioA%20%2B%20this._w%20%2A%20ratioB%3B%0A%20%20%20%20this._x%20%3D%20x2%20%2A%20ratioA%20%2B%20this._x%20%2A%20ratioB%3B%0A%20%20%20%20this._y%20%3D%20y2%20%2A%20ratioA%20%2B%20this._y%20%2A%20ratioB%3B%0A%20%20%20%20this._z%20%3D%20z2%20%2A%20ratioA%20%2B%20this._z%20%2A%20ratioB%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20slerpQuaternions%28qa%2C%20qb%2C%20t%29%20%7B%0A%20%20%20%20return%20this.copy%28qa%29.slerp%28qb%2C%20t%29%3B%0A%20%20%7D%0A%20%20random%28%29%20%7B%0A%20%20%20%20const%20theta1%20%3D%202%20%2A%20Math.PI%20%2A%20Math.random%28%29%3B%0A%20%20%20%20const%20theta2%20%3D%202%20%2A%20Math.PI%20%2A%20Math.random%28%29%3B%0A%20%20%20%20const%20x0%20%3D%20Math.random%28%29%3B%0A%20%20%20%20const%20r1%20%3D%20Math.sqrt%281%20-%20x0%29%3B%0A%20%20%20%20const%20r2%20%3D%20Math.sqrt%28x0%29%3B%0A%20%20%20%20return%20this.set%28%0A%20%20%20%20%20%20r1%20%2A%20Math.sin%28theta1%29%2C%0A%20%20%20%20%20%20r1%20%2A%20Math.cos%28theta1%29%2C%0A%20%20%20%20%20%20r2%20%2A%20Math.sin%28theta2%29%2C%0A%20%20%20%20%20%20r2%20%2A%20Math.cos%28theta2%29%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20equals%28quaternion%29%20%7B%0A%20%20%20%20return%20quaternion._x%20%3D%3D%3D%20this._x%20%26%26%20quaternion._y%20%3D%3D%3D%20this._y%20%26%26%20quaternion._z%20%3D%3D%3D%20this._z%20%26%26%20quaternion._w%20%3D%3D%3D%20this._w%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this._x%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this._y%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20this._z%20%3D%20array%5Boffset%20%2B%202%5D%3B%0A%20%20%20%20this._w%20%3D%20array%5Boffset%20%2B%203%5D%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this._x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this._y%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this._z%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20this._w%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this._x%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this._y%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20this._z%20%3D%20attribute2.getZ%28index5%29%3B%0A%20%20%20%20this._w%20%3D%20attribute2.getW%28index5%29%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20return%20this.toArray%28%29%3B%0A%20%20%7D%0A%20%20_onChange%28callback%29%20%7B%0A%20%20%20%20this._onChangeCallback%20%3D%20callback%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20_onChangeCallback%28%29%20%7B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this._x%3B%0A%20%20%20%20yield%20this._y%3B%0A%20%20%20%20yield%20this._z%3B%0A%20%20%20%20yield%20this._w%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Vector32%20%3D%20class%20_Vector3%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%2C%20z2%20%3D%200%29%20%7B%0A%20%20%20%20_Vector3.prototype.isVector3%20%3D%20true%3B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28z2%20%3D%3D%3D%20void%200%29%20z2%20%3D%20this.z%3B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%3D%20scalar%3B%0A%20%20%20%20this.y%20%3D%20scalar%3B%0A%20%20%20%20this.z%20%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setX%28x2%29%20%7B%0A%20%20%20%20this.x%20%3D%20x2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setY%28y2%29%20%7B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setZ%28z2%29%20%7B%0A%20%20%20%20this.z%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setComponent%28index5%2C%20value%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20this.x%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20this.y%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20this.z%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getComponent%28index5%29%20%7B%0A%20%20%20%20switch%20%28index5%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20return%20this.x%3B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20return%20this.y%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20return%20this.z%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22index%20is%20out%20of%20range%3A%20%22%20%2B%20index5%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.x%2C%20this.y%2C%20this.z%29%3B%0A%20%20%7D%0A%20%20copy%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20v.x%3B%0A%20%20%20%20this.y%20%3D%20v.y%3B%0A%20%20%20%20this.z%20%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20add%28v%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%3B%0A%20%20%20%20this.z%20%2B%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScalar%28s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20s%3B%0A%20%20%20%20this.z%20%2B%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20%2B%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20%2B%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20%2B%20b.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScaledVector%28v%2C%20s%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20v.x%20%2A%20s%3B%0A%20%20%20%20this.y%20%2B%3D%20v.y%20%2A%20s%3B%0A%20%20%20%20this.z%20%2B%3D%20v.z%20%2A%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20sub%28v%29%20%7B%0A%20%20%20%20this.x%20-%3D%20v.x%3B%0A%20%20%20%20this.y%20-%3D%20v.y%3B%0A%20%20%20%20this.z%20-%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subScalar%28s%29%20%7B%0A%20%20%20%20this.x%20-%3D%20s%3B%0A%20%20%20%20this.y%20-%3D%20s%3B%0A%20%20%20%20this.z%20-%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20subVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20-%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20-%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20-%20b.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28v%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20v.x%3B%0A%20%20%20%20this.y%20%2A%3D%20v.y%3B%0A%20%20%20%20this.z%20%2A%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28scalar%29%20%7B%0A%20%20%20%20this.x%20%2A%3D%20scalar%3B%0A%20%20%20%20this.y%20%2A%3D%20scalar%3B%0A%20%20%20%20this.z%20%2A%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20this.x%20%3D%20a2.x%20%2A%20b.x%3B%0A%20%20%20%20this.y%20%3D%20a2.y%20%2A%20b.y%3B%0A%20%20%20%20this.z%20%3D%20a2.z%20%2A%20b.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyEuler%28euler%29%20%7B%0A%20%20%20%20return%20this.applyQuaternion%28_quaternion%2442.setFromEuler%28euler%29%29%3B%0A%20%20%7D%0A%20%20applyAxisAngle%28axis%2C%20angle%29%20%7B%0A%20%20%20%20return%20this.applyQuaternion%28_quaternion%2442.setFromAxisAngle%28axis%2C%20angle%29%29%3B%0A%20%20%7D%0A%20%20applyMatrix3%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%2C%20z2%20%3D%20this.z%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B0%5D%20%2A%20x2%20%2B%20e%5B3%5D%20%2A%20y2%20%2B%20e%5B6%5D%20%2A%20z2%3B%0A%20%20%20%20this.y%20%3D%20e%5B1%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B7%5D%20%2A%20z2%3B%0A%20%20%20%20this.z%20%3D%20e%5B2%5D%20%2A%20x2%20%2B%20e%5B5%5D%20%2A%20y2%20%2B%20e%5B8%5D%20%2A%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyNormalMatrix%28m2%29%20%7B%0A%20%20%20%20return%20this.applyMatrix3%28m2%29.normalize%28%29%3B%0A%20%20%7D%0A%20%20applyMatrix4%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%2C%20z2%20%3D%20this.z%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20const%20w%20%3D%201%20%2F%20%28e%5B3%5D%20%2A%20x2%20%2B%20e%5B7%5D%20%2A%20y2%20%2B%20e%5B11%5D%20%2A%20z2%20%2B%20e%5B15%5D%29%3B%0A%20%20%20%20this.x%20%3D%20%28e%5B0%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B8%5D%20%2A%20z2%20%2B%20e%5B12%5D%29%20%2A%20w%3B%0A%20%20%20%20this.y%20%3D%20%28e%5B1%5D%20%2A%20x2%20%2B%20e%5B5%5D%20%2A%20y2%20%2B%20e%5B9%5D%20%2A%20z2%20%2B%20e%5B13%5D%29%20%2A%20w%3B%0A%20%20%20%20this.z%20%3D%20%28e%5B2%5D%20%2A%20x2%20%2B%20e%5B6%5D%20%2A%20y2%20%2B%20e%5B10%5D%20%2A%20z2%20%2B%20e%5B14%5D%29%20%2A%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyQuaternion%28q%29%20%7B%0A%20%20%20%20const%20vx%20%3D%20this.x%2C%20vy%20%3D%20this.y%2C%20vz%20%3D%20this.z%3B%0A%20%20%20%20const%20qx%20%3D%20q.x%2C%20qy%20%3D%20q.y%2C%20qz%20%3D%20q.z%2C%20qw%20%3D%20q.w%3B%0A%20%20%20%20const%20tx%20%3D%202%20%2A%20%28qy%20%2A%20vz%20-%20qz%20%2A%20vy%29%3B%0A%20%20%20%20const%20ty%20%3D%202%20%2A%20%28qz%20%2A%20vx%20-%20qx%20%2A%20vz%29%3B%0A%20%20%20%20const%20tz%20%3D%202%20%2A%20%28qx%20%2A%20vy%20-%20qy%20%2A%20vx%29%3B%0A%20%20%20%20this.x%20%3D%20vx%20%2B%20qw%20%2A%20tx%20%2B%20qy%20%2A%20tz%20-%20qz%20%2A%20ty%3B%0A%20%20%20%20this.y%20%3D%20vy%20%2B%20qw%20%2A%20ty%20%2B%20qz%20%2A%20tx%20-%20qx%20%2A%20tz%3B%0A%20%20%20%20this.z%20%3D%20vz%20%2B%20qw%20%2A%20tz%20%2B%20qx%20%2A%20ty%20-%20qy%20%2A%20tx%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20project%28camera3%29%20%7B%0A%20%20%20%20return%20this.applyMatrix4%28camera3.matrixWorldInverse%29.applyMatrix4%28camera3.projectionMatrix%29%3B%0A%20%20%7D%0A%20%20unproject%28camera3%29%20%7B%0A%20%20%20%20return%20this.applyMatrix4%28camera3.projectionMatrixInverse%29.applyMatrix4%28camera3.matrixWorld%29%3B%0A%20%20%7D%0A%20%20transformDirection%28m2%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20this.x%2C%20y2%20%3D%20this.y%2C%20z2%20%3D%20this.z%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B0%5D%20%2A%20x2%20%2B%20e%5B4%5D%20%2A%20y2%20%2B%20e%5B8%5D%20%2A%20z2%3B%0A%20%20%20%20this.y%20%3D%20e%5B1%5D%20%2A%20x2%20%2B%20e%5B5%5D%20%2A%20y2%20%2B%20e%5B9%5D%20%2A%20z2%3B%0A%20%20%20%20this.z%20%3D%20e%5B2%5D%20%2A%20x2%20%2B%20e%5B6%5D%20%2A%20y2%20%2B%20e%5B10%5D%20%2A%20z2%3B%0A%20%20%20%20return%20this.normalize%28%29%3B%0A%20%20%7D%0A%20%20divide%28v%29%20%7B%0A%20%20%20%20this.x%20%2F%3D%20v.x%3B%0A%20%20%20%20this.y%20%2F%3D%20v.y%3B%0A%20%20%20%20this.z%20%2F%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20divideScalar%28scalar%29%20%7B%0A%20%20%20%20return%20this.multiplyScalar%281%20%2F%20scalar%29%3B%0A%20%20%7D%0A%20%20min%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.min%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.min%28this.y%2C%20v.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.min%28this.z%2C%20v.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20max%28v%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28this.x%2C%20v.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28this.y%2C%20v.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28this.z%2C%20v.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clamp%28min2%2C%20max2%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28min2.x%2C%20Math.min%28max2.x%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28min2.y%2C%20Math.min%28max2.y%2C%20this.y%29%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28min2.z%2C%20Math.min%28max2.z%2C%20this.z%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampScalar%28minVal%2C%20maxVal%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.x%29%29%3B%0A%20%20%20%20this.y%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.y%29%29%3B%0A%20%20%20%20this.z%20%3D%20Math.max%28minVal%2C%20Math.min%28maxVal%2C%20this.z%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clampLength%28min2%2C%20max2%29%20%7B%0A%20%20%20%20const%20length2%20%3D%20this.length%28%29%3B%0A%20%20%20%20return%20this.divideScalar%28length2%20%7C%7C%201%29.multiplyScalar%28Math.max%28min2%2C%20Math.min%28max2%2C%20length2%29%29%29%3B%0A%20%20%7D%0A%20%20floor%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.floor%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.floor%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.floor%28this.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20ceil%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.ceil%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.ceil%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.ceil%28this.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20round%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.round%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.round%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.round%28this.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20roundToZero%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.trunc%28this.x%29%3B%0A%20%20%20%20this.y%20%3D%20Math.trunc%28this.y%29%3B%0A%20%20%20%20this.z%20%3D%20Math.trunc%28this.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20negate%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20-this.x%3B%0A%20%20%20%20this.y%20%3D%20-this.y%3B%0A%20%20%20%20this.z%20%3D%20-this.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dot%28v%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20v.x%20%2B%20this.y%20%2A%20v.y%20%2B%20this.z%20%2A%20v.z%3B%0A%20%20%7D%0A%20%20%2F%2F%20TODO%20lengthSquared%3F%0A%20%20lengthSq%28%29%20%7B%0A%20%20%20%20return%20this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%20%2B%20this.z%20%2A%20this.z%3B%0A%20%20%7D%0A%20%20length%28%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.x%20%2A%20this.x%20%2B%20this.y%20%2A%20this.y%20%2B%20this.z%20%2A%20this.z%29%3B%0A%20%20%7D%0A%20%20manhattanLength%28%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%29%20%2B%20Math.abs%28this.y%29%20%2B%20Math.abs%28this.z%29%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20return%20this.divideScalar%28this.length%28%29%20%7C%7C%201%29%3B%0A%20%20%7D%0A%20%20setLength%28length2%29%20%7B%0A%20%20%20%20return%20this.normalize%28%29.multiplyScalar%28length2%29%3B%0A%20%20%7D%0A%20%20lerp%28v%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%2B%3D%20%28v.x%20-%20this.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%2B%3D%20%28v.y%20-%20this.y%29%20%2A%20alpha%3B%0A%20%20%20%20this.z%20%2B%3D%20%28v.z%20-%20this.z%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpVectors%28v1%2C%20v2%2C%20alpha%29%20%7B%0A%20%20%20%20this.x%20%3D%20v1.x%20%2B%20%28v2.x%20-%20v1.x%29%20%2A%20alpha%3B%0A%20%20%20%20this.y%20%3D%20v1.y%20%2B%20%28v2.y%20-%20v1.y%29%20%2A%20alpha%3B%0A%20%20%20%20this.z%20%3D%20v1.z%20%2B%20%28v2.z%20-%20v1.z%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20cross%28v%29%20%7B%0A%20%20%20%20return%20this.crossVectors%28this%2C%20v%29%3B%0A%20%20%7D%0A%20%20crossVectors%28a2%2C%20b%29%20%7B%0A%20%20%20%20const%20ax%20%3D%20a2.x%2C%20ay%20%3D%20a2.y%2C%20az%20%3D%20a2.z%3B%0A%20%20%20%20const%20bx%20%3D%20b.x%2C%20by%20%3D%20b.y%2C%20bz%20%3D%20b.z%3B%0A%20%20%20%20this.x%20%3D%20ay%20%2A%20bz%20-%20az%20%2A%20by%3B%0A%20%20%20%20this.y%20%3D%20az%20%2A%20bx%20-%20ax%20%2A%20bz%3B%0A%20%20%20%20this.z%20%3D%20ax%20%2A%20by%20-%20ay%20%2A%20bx%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20projectOnVector%28v%29%20%7B%0A%20%20%20%20const%20denominator%20%3D%20v.lengthSq%28%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20return%20this.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20const%20scalar%20%3D%20v.dot%28this%29%20%2F%20denominator%3B%0A%20%20%20%20return%20this.copy%28v%29.multiplyScalar%28scalar%29%3B%0A%20%20%7D%0A%20%20projectOnPlane%28planeNormal%29%20%7B%0A%20%20%20%20_vector%24c2.copy%28this%29.projectOnVector%28planeNormal%29%3B%0A%20%20%20%20return%20this.sub%28_vector%24c2%29%3B%0A%20%20%7D%0A%20%20reflect%28normal2%29%20%7B%0A%20%20%20%20return%20this.sub%28_vector%24c2.copy%28normal2%29.multiplyScalar%282%20%2A%20this.dot%28normal2%29%29%29%3B%0A%20%20%7D%0A%20%20angleTo%28v%29%20%7B%0A%20%20%20%20const%20denominator%20%3D%20Math.sqrt%28this.lengthSq%28%29%20%2A%20v.lengthSq%28%29%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20return%20Math.PI%20%2F%202%3B%0A%20%20%20%20const%20theta%20%3D%20this.dot%28v%29%20%2F%20denominator%3B%0A%20%20%20%20return%20Math.acos%28clamp%241%28theta%2C%20-1%2C%201%29%29%3B%0A%20%20%7D%0A%20%20distanceTo%28v%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.distanceToSquared%28v%29%29%3B%0A%20%20%7D%0A%20%20distanceToSquared%28v%29%20%7B%0A%20%20%20%20const%20dx%20%3D%20this.x%20-%20v.x%2C%20dy%20%3D%20this.y%20-%20v.y%2C%20dz%20%3D%20this.z%20-%20v.z%3B%0A%20%20%20%20return%20dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%20%2B%20dz%20%2A%20dz%3B%0A%20%20%7D%0A%20%20manhattanDistanceTo%28v%29%20%7B%0A%20%20%20%20return%20Math.abs%28this.x%20-%20v.x%29%20%2B%20Math.abs%28this.y%20-%20v.y%29%20%2B%20Math.abs%28this.z%20-%20v.z%29%3B%0A%20%20%7D%0A%20%20setFromSpherical%28s%29%20%7B%0A%20%20%20%20return%20this.setFromSphericalCoords%28s.radius%2C%20s.phi%2C%20s.theta%29%3B%0A%20%20%7D%0A%20%20setFromSphericalCoords%28radius%2C%20phi%2C%20theta%29%20%7B%0A%20%20%20%20const%20sinPhiRadius%20%3D%20Math.sin%28phi%29%20%2A%20radius%3B%0A%20%20%20%20this.x%20%3D%20sinPhiRadius%20%2A%20Math.sin%28theta%29%3B%0A%20%20%20%20this.y%20%3D%20Math.cos%28phi%29%20%2A%20radius%3B%0A%20%20%20%20this.z%20%3D%20sinPhiRadius%20%2A%20Math.cos%28theta%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromCylindrical%28c2%29%20%7B%0A%20%20%20%20return%20this.setFromCylindricalCoords%28c2.radius%2C%20c2.theta%2C%20c2.y%29%3B%0A%20%20%7D%0A%20%20setFromCylindricalCoords%28radius%2C%20theta%2C%20y2%29%20%7B%0A%20%20%20%20this.x%20%3D%20radius%20%2A%20Math.sin%28theta%29%3B%0A%20%20%20%20this.y%20%3D%20y2%3B%0A%20%20%20%20this.z%20%3D%20radius%20%2A%20Math.cos%28theta%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrixPosition%28m2%29%20%7B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.x%20%3D%20e%5B12%5D%3B%0A%20%20%20%20this.y%20%3D%20e%5B13%5D%3B%0A%20%20%20%20this.z%20%3D%20e%5B14%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrixScale%28m2%29%20%7B%0A%20%20%20%20const%20sx%20%3D%20this.setFromMatrixColumn%28m2%2C%200%29.length%28%29%3B%0A%20%20%20%20const%20sy%20%3D%20this.setFromMatrixColumn%28m2%2C%201%29.length%28%29%3B%0A%20%20%20%20const%20sz%20%3D%20this.setFromMatrixColumn%28m2%2C%202%29.length%28%29%3B%0A%20%20%20%20this.x%20%3D%20sx%3B%0A%20%20%20%20this.y%20%3D%20sy%3B%0A%20%20%20%20this.z%20%3D%20sz%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrixColumn%28m2%2C%20index5%29%20%7B%0A%20%20%20%20return%20this.fromArray%28m2.elements%2C%20index5%20%2A%204%29%3B%0A%20%20%7D%0A%20%20setFromMatrix3Column%28m2%2C%20index5%29%20%7B%0A%20%20%20%20return%20this.fromArray%28m2.elements%2C%20index5%20%2A%203%29%3B%0A%20%20%7D%0A%20%20setFromEuler%28e%29%20%7B%0A%20%20%20%20this.x%20%3D%20e._x%3B%0A%20%20%20%20this.y%20%3D%20e._y%3B%0A%20%20%20%20this.z%20%3D%20e._z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromColor%28c2%29%20%7B%0A%20%20%20%20this.x%20%3D%20c2.r%3B%0A%20%20%20%20this.y%20%3D%20c2.g%3B%0A%20%20%20%20this.z%20%3D%20c2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28v%29%20%7B%0A%20%20%20%20return%20v.x%20%3D%3D%3D%20this.x%20%26%26%20v.y%20%3D%3D%3D%20this.y%20%26%26%20v.z%20%3D%3D%3D%20this.z%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.x%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this.y%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20this.z%20%3D%20array%5Boffset%20%2B%202%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this.x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this.y%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this.z%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this.x%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this.y%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20this.z%20%3D%20attribute2.getZ%28index5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20random%28%29%20%7B%0A%20%20%20%20this.x%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.y%20%3D%20Math.random%28%29%3B%0A%20%20%20%20this.z%20%3D%20Math.random%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20randomDirection%28%29%20%7B%0A%20%20%20%20const%20theta%20%3D%20Math.random%28%29%20%2A%20Math.PI%20%2A%202%3B%0A%20%20%20%20const%20u%20%3D%20Math.random%28%29%20%2A%202%20-%201%3B%0A%20%20%20%20const%20c2%20%3D%20Math.sqrt%281%20-%20u%20%2A%20u%29%3B%0A%20%20%20%20this.x%20%3D%20c2%20%2A%20Math.cos%28theta%29%3B%0A%20%20%20%20this.y%20%3D%20u%3B%0A%20%20%20%20this.z%20%3D%20c2%20%2A%20Math.sin%28theta%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this.x%3B%0A%20%20%20%20yield%20this.y%3B%0A%20%20%20%20yield%20this.z%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_vector%24c2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_quaternion%2442%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Quaternion2%28%29%3B%0Avar%20Box32%20%3D%20class%20%7B%0A%20%20constructor%28min2%20%3D%20new%20Vector32%28Infinity%2C%20Infinity%2C%20Infinity%29%2C%20max2%20%3D%20new%20Vector32%28-Infinity%2C%20-Infinity%2C%20-Infinity%29%29%20%7B%0A%20%20%20%20this.isBox3%20%3D%20true%3B%0A%20%20%20%20this.min%20%3D%20min2%3B%0A%20%20%20%20this.max%20%3D%20max2%3B%0A%20%20%7D%0A%20%20set%28min2%2C%20max2%29%20%7B%0A%20%20%20%20this.min.copy%28min2%29%3B%0A%20%20%20%20this.max.copy%28max2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromArray%28array%29%20%7B%0A%20%20%20%20this.makeEmpty%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20array.length%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20this.expandByPoint%28_vector%24b2.fromArray%28array%2C%20i%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromBufferAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.makeEmpty%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20attribute2.count%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.expandByPoint%28_vector%24b2.fromBufferAttribute%28attribute2%2C%20i%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromPoints%28points%29%20%7B%0A%20%20%20%20this.makeEmpty%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20points.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.expandByPoint%28points%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromCenterAndSize%28center%2C%20size%29%20%7B%0A%20%20%20%20const%20halfSize%20%3D%20_vector%24b2.copy%28size%29.multiplyScalar%280.5%29%3B%0A%20%20%20%20this.min.copy%28center%29.sub%28halfSize%29%3B%0A%20%20%20%20this.max.copy%28center%29.add%28halfSize%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromObject%28object%2C%20precise%20%3D%20false%29%20%7B%0A%20%20%20%20this.makeEmpty%28%29%3B%0A%20%20%20%20return%20this.expandByObject%28object%2C%20precise%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28box%29%20%7B%0A%20%20%20%20this.min.copy%28box.min%29%3B%0A%20%20%20%20this.max.copy%28box.max%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeEmpty%28%29%20%7B%0A%20%20%20%20this.min.x%20%3D%20this.min.y%20%3D%20this.min.z%20%3D%20Infinity%3B%0A%20%20%20%20this.max.x%20%3D%20this.max.y%20%3D%20this.max.z%20%3D%20-Infinity%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20isEmpty%28%29%20%7B%0A%20%20%20%20return%20this.max.x%20%3C%20this.min.x%20%7C%7C%20this.max.y%20%3C%20this.min.y%20%7C%7C%20this.max.z%20%3C%20this.min.z%3B%0A%20%20%7D%0A%20%20getCenter%28target%29%20%7B%0A%20%20%20%20return%20this.isEmpty%28%29%20%3F%20target.set%280%2C%200%2C%200%29%20%3A%20target.addVectors%28this.min%2C%20this.max%29.multiplyScalar%280.5%29%3B%0A%20%20%7D%0A%20%20getSize%28target%29%20%7B%0A%20%20%20%20return%20this.isEmpty%28%29%20%3F%20target.set%280%2C%200%2C%200%29%20%3A%20target.subVectors%28this.max%2C%20this.min%29%3B%0A%20%20%7D%0A%20%20expandByPoint%28point%29%20%7B%0A%20%20%20%20this.min.min%28point%29%3B%0A%20%20%20%20this.max.max%28point%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20expandByVector%28vector%29%20%7B%0A%20%20%20%20this.min.sub%28vector%29%3B%0A%20%20%20%20this.max.add%28vector%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20expandByScalar%28scalar%29%20%7B%0A%20%20%20%20this.min.addScalar%28-scalar%29%3B%0A%20%20%20%20this.max.addScalar%28scalar%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20expandByObject%28object%2C%20precise%20%3D%20false%29%20%7B%0A%20%20%20%20object.updateWorldMatrix%28false%2C%20false%29%3B%0A%20%20%20%20const%20geometry%20%3D%20object.geometry%3B%0A%20%20%20%20if%20%28geometry%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20positionAttribute%20%3D%20geometry.getAttribute%28%22position%22%29%3B%0A%20%20%20%20%20%20if%20%28precise%20%3D%3D%3D%20true%20%26%26%20positionAttribute%20%21%3D%3D%20void%200%20%26%26%20object.isInstancedMesh%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20positionAttribute.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28object.isMesh%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20object.getVertexPosition%28i%2C%20_vector%24b2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%24b2.fromBufferAttribute%28positionAttribute%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_vector%24b2.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.expandByPoint%28_vector%24b2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28object.boundingBox%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28object.boundingBox%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20object.computeBoundingBox%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_box%2442.copy%28object.boundingBox%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28geometry.boundingBox%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20geometry.computeBoundingBox%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_box%2442.copy%28geometry.boundingBox%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20_box%2442.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20this.union%28_box%2442%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20children%20%3D%20object.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.expandByObject%28children%5Bi%5D%2C%20precise%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20containsPoint%28point%29%20%7B%0A%20%20%20%20return%20point.x%20%3E%3D%20this.min.x%20%26%26%20point.x%20%3C%3D%20this.max.x%20%26%26%20point.y%20%3E%3D%20this.min.y%20%26%26%20point.y%20%3C%3D%20this.max.y%20%26%26%20point.z%20%3E%3D%20this.min.z%20%26%26%20point.z%20%3C%3D%20this.max.z%3B%0A%20%20%7D%0A%20%20containsBox%28box%29%20%7B%0A%20%20%20%20return%20this.min.x%20%3C%3D%20box.min.x%20%26%26%20box.max.x%20%3C%3D%20this.max.x%20%26%26%20this.min.y%20%3C%3D%20box.min.y%20%26%26%20box.max.y%20%3C%3D%20this.max.y%20%26%26%20this.min.z%20%3C%3D%20box.min.z%20%26%26%20box.max.z%20%3C%3D%20this.max.z%3B%0A%20%20%7D%0A%20%20getParameter%28point%2C%20target%29%20%7B%0A%20%20%20%20return%20target.set%28%0A%20%20%20%20%20%20%28point.x%20-%20this.min.x%29%20%2F%20%28this.max.x%20-%20this.min.x%29%2C%0A%20%20%20%20%20%20%28point.y%20-%20this.min.y%29%20%2F%20%28this.max.y%20-%20this.min.y%29%2C%0A%20%20%20%20%20%20%28point.z%20-%20this.min.z%29%20%2F%20%28this.max.z%20-%20this.min.z%29%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20box.max.x%20%3E%3D%20this.min.x%20%26%26%20box.min.x%20%3C%3D%20this.max.x%20%26%26%20box.max.y%20%3E%3D%20this.min.y%20%26%26%20box.min.y%20%3C%3D%20this.max.y%20%26%26%20box.max.z%20%3E%3D%20this.min.z%20%26%26%20box.min.z%20%3C%3D%20this.max.z%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20this.clampPoint%28sphere.center%2C%20_vector%24b2%29%3B%0A%20%20%20%20return%20_vector%24b2.distanceToSquared%28sphere.center%29%20%3C%3D%20sphere.radius%20%2A%20sphere.radius%3B%0A%20%20%7D%0A%20%20intersectsPlane%28plane%29%20%7B%0A%20%20%20%20let%20min2%2C%20max2%3B%0A%20%20%20%20if%20%28plane.normal.x%20%3E%200%29%20%7B%0A%20%20%20%20%20%20min2%20%3D%20plane.normal.x%20%2A%20this.min.x%3B%0A%20%20%20%20%20%20max2%20%3D%20plane.normal.x%20%2A%20this.max.x%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20min2%20%3D%20plane.normal.x%20%2A%20this.max.x%3B%0A%20%20%20%20%20%20max2%20%3D%20plane.normal.x%20%2A%20this.min.x%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28plane.normal.y%20%3E%200%29%20%7B%0A%20%20%20%20%20%20min2%20%2B%3D%20plane.normal.y%20%2A%20this.min.y%3B%0A%20%20%20%20%20%20max2%20%2B%3D%20plane.normal.y%20%2A%20this.max.y%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20min2%20%2B%3D%20plane.normal.y%20%2A%20this.max.y%3B%0A%20%20%20%20%20%20max2%20%2B%3D%20plane.normal.y%20%2A%20this.min.y%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28plane.normal.z%20%3E%200%29%20%7B%0A%20%20%20%20%20%20min2%20%2B%3D%20plane.normal.z%20%2A%20this.min.z%3B%0A%20%20%20%20%20%20max2%20%2B%3D%20plane.normal.z%20%2A%20this.max.z%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20min2%20%2B%3D%20plane.normal.z%20%2A%20this.max.z%3B%0A%20%20%20%20%20%20max2%20%2B%3D%20plane.normal.z%20%2A%20this.min.z%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20min2%20%3C%3D%20-plane.constant%20%26%26%20max2%20%3E%3D%20-plane.constant%3B%0A%20%20%7D%0A%20%20intersectsTriangle%28triangle%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.getCenter%28_center2%29%3B%0A%20%20%20%20_extents2.subVectors%28this.max%2C%20_center2%29%3B%0A%20%20%20%20_v0%2422.subVectors%28triangle.a%2C%20_center2%29%3B%0A%20%20%20%20_v1%2472.subVectors%28triangle.b%2C%20_center2%29%3B%0A%20%20%20%20_v2%2442.subVectors%28triangle.c%2C%20_center2%29%3B%0A%20%20%20%20_f02.subVectors%28_v1%2472%2C%20_v0%2422%29%3B%0A%20%20%20%20_f12.subVectors%28_v2%2442%2C%20_v1%2472%29%3B%0A%20%20%20%20_f22.subVectors%28_v0%2422%2C%20_v2%2442%29%3B%0A%20%20%20%20let%20axes%20%3D%20%5B%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f02.z%2C%0A%20%20%20%20%20%20_f02.y%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f12.z%2C%0A%20%20%20%20%20%20_f12.y%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f22.z%2C%0A%20%20%20%20%20%20_f22.y%2C%0A%20%20%20%20%20%20_f02.z%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f02.x%2C%0A%20%20%20%20%20%20_f12.z%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f12.x%2C%0A%20%20%20%20%20%20_f22.z%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f22.x%2C%0A%20%20%20%20%20%20-_f02.y%2C%0A%20%20%20%20%20%20_f02.x%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f12.y%2C%0A%20%20%20%20%20%20_f12.x%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-_f22.y%2C%0A%20%20%20%20%20%20_f22.x%2C%0A%20%20%20%20%20%200%0A%20%20%20%20%5D%3B%0A%20%20%20%20if%20%28%21satForAxes2%28axes%2C%20_v0%2422%2C%20_v1%2472%2C%20_v2%2442%2C%20_extents2%29%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20axes%20%3D%20%5B1%2C%200%2C%200%2C%200%2C%201%2C%200%2C%200%2C%200%2C%201%5D%3B%0A%20%20%20%20if%20%28%21satForAxes2%28axes%2C%20_v0%2422%2C%20_v1%2472%2C%20_v2%2442%2C%20_extents2%29%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20_triangleNormal2.crossVectors%28_f02%2C%20_f12%29%3B%0A%20%20%20%20axes%20%3D%20%5B_triangleNormal2.x%2C%20_triangleNormal2.y%2C%20_triangleNormal2.z%5D%3B%0A%20%20%20%20return%20satForAxes2%28axes%2C%20_v0%2422%2C%20_v1%2472%2C%20_v2%2442%2C%20_extents2%29%3B%0A%20%20%7D%0A%20%20clampPoint%28point%2C%20target%29%20%7B%0A%20%20%20%20return%20target.copy%28point%29.clamp%28this.min%2C%20this.max%29%3B%0A%20%20%7D%0A%20%20distanceToPoint%28point%29%20%7B%0A%20%20%20%20return%20this.clampPoint%28point%2C%20_vector%24b2%29.distanceTo%28point%29%3B%0A%20%20%7D%0A%20%20getBoundingSphere%28target%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20target.makeEmpty%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.getCenter%28target.center%29%3B%0A%20%20%20%20%20%20target.radius%20%3D%20this.getSize%28_vector%24b2%29.length%28%29%20%2A%200.5%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20intersect%28box%29%20%7B%0A%20%20%20%20this.min.max%28box.min%29%3B%0A%20%20%20%20this.max.min%28box.max%29%3B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20this.makeEmpty%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20union%28box%29%20%7B%0A%20%20%20%20this.min.min%28box.min%29%3B%0A%20%20%20%20this.max.max%28box.max%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20return%20this%3B%0A%20%20%20%20_points2%5B0%5D.set%28this.min.x%2C%20this.min.y%2C%20this.min.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points2%5B1%5D.set%28this.min.x%2C%20this.min.y%2C%20this.max.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points2%5B2%5D.set%28this.min.x%2C%20this.max.y%2C%20this.min.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points2%5B3%5D.set%28this.min.x%2C%20this.max.y%2C%20this.max.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points2%5B4%5D.set%28this.max.x%2C%20this.min.y%2C%20this.min.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points2%5B5%5D.set%28this.max.x%2C%20this.min.y%2C%20this.max.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points2%5B6%5D.set%28this.max.x%2C%20this.max.y%2C%20this.min.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20_points2%5B7%5D.set%28this.max.x%2C%20this.max.y%2C%20this.max.z%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20this.setFromPoints%28_points2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28offset%29%20%7B%0A%20%20%20%20this.min.add%28offset%29%3B%0A%20%20%20%20this.max.add%28offset%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28box%29%20%7B%0A%20%20%20%20return%20box.min.equals%28this.min%29%20%26%26%20box.max.equals%28this.max%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_points2%20%3D%20%5B%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%0A%5D%3B%0Avar%20_vector%24b2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_box%2442%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Box32%28%29%3B%0Avar%20_v0%2422%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_v1%2472%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_v2%2442%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_f02%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_f12%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_f22%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_center2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_extents2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_triangleNormal2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_testAxis2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Afunction%20satForAxes2%28axes%2C%20v0%2C%20v1%2C%20v2%2C%20extents%29%20%7B%0A%20%20for%20%28let%20i%20%3D%200%2C%20j%20%3D%20axes.length%20-%203%3B%20i%20%3C%3D%20j%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20_testAxis2.fromArray%28axes%2C%20i%29%3B%0A%20%20%20%20const%20r%20%3D%20extents.x%20%2A%20Math.abs%28_testAxis2.x%29%20%2B%20extents.y%20%2A%20Math.abs%28_testAxis2.y%29%20%2B%20extents.z%20%2A%20Math.abs%28_testAxis2.z%29%3B%0A%20%20%20%20const%20p0%20%3D%20v0.dot%28_testAxis2%29%3B%0A%20%20%20%20const%20p1%20%3D%20v1.dot%28_testAxis2%29%3B%0A%20%20%20%20const%20p2%20%3D%20v2.dot%28_testAxis2%29%3B%0A%20%20%20%20if%20%28Math.max%28-Math.max%28p0%2C%20p1%2C%20p2%29%2C%20Math.min%28p0%2C%20p1%2C%20p2%29%29%20%3E%20r%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20true%3B%0A%7D%0Avar%20_box%2432%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Box32%28%29%3B%0Avar%20_v1%2462%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_v2%2432%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20Sphere2%20%3D%20class%20%7B%0A%20%20constructor%28center%20%3D%20new%20Vector32%28%29%2C%20radius%20%3D%20-1%29%20%7B%0A%20%20%20%20this.isSphere%20%3D%20true%3B%0A%20%20%20%20this.center%20%3D%20center%3B%0A%20%20%20%20this.radius%20%3D%20radius%3B%0A%20%20%7D%0A%20%20set%28center%2C%20radius%29%20%7B%0A%20%20%20%20this.center.copy%28center%29%3B%0A%20%20%20%20this.radius%20%3D%20radius%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromPoints%28points%2C%20optionalCenter%29%20%7B%0A%20%20%20%20const%20center%20%3D%20this.center%3B%0A%20%20%20%20if%20%28optionalCenter%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20center.copy%28optionalCenter%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_box%2432.setFromPoints%28points%29.getCenter%28center%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20maxRadiusSq%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20points.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20maxRadiusSq%20%3D%20Math.max%28maxRadiusSq%2C%20center.distanceToSquared%28points%5Bi%5D%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.radius%20%3D%20Math.sqrt%28maxRadiusSq%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28sphere%29%20%7B%0A%20%20%20%20this.center.copy%28sphere.center%29%3B%0A%20%20%20%20this.radius%20%3D%20sphere.radius%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20isEmpty%28%29%20%7B%0A%20%20%20%20return%20this.radius%20%3C%200%3B%0A%20%20%7D%0A%20%20makeEmpty%28%29%20%7B%0A%20%20%20%20this.center.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20this.radius%20%3D%20-1%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20containsPoint%28point%29%20%7B%0A%20%20%20%20return%20point.distanceToSquared%28this.center%29%20%3C%3D%20this.radius%20%2A%20this.radius%3B%0A%20%20%7D%0A%20%20distanceToPoint%28point%29%20%7B%0A%20%20%20%20return%20point.distanceTo%28this.center%29%20-%20this.radius%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20const%20radiusSum%20%3D%20this.radius%20%2B%20sphere.radius%3B%0A%20%20%20%20return%20sphere.center.distanceToSquared%28this.center%29%20%3C%3D%20radiusSum%20%2A%20radiusSum%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20box.intersectsSphere%28this%29%3B%0A%20%20%7D%0A%20%20intersectsPlane%28plane%29%20%7B%0A%20%20%20%20return%20Math.abs%28plane.distanceToPoint%28this.center%29%29%20%3C%3D%20this.radius%3B%0A%20%20%7D%0A%20%20clampPoint%28point%2C%20target%29%20%7B%0A%20%20%20%20const%20deltaLengthSq%20%3D%20this.center.distanceToSquared%28point%29%3B%0A%20%20%20%20target.copy%28point%29%3B%0A%20%20%20%20if%20%28deltaLengthSq%20%3E%20this.radius%20%2A%20this.radius%29%20%7B%0A%20%20%20%20%20%20target.sub%28this.center%29.normalize%28%29%3B%0A%20%20%20%20%20%20target.multiplyScalar%28this.radius%29.add%28this.center%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getBoundingBox%28target%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20target.makeEmpty%28%29%3B%0A%20%20%20%20%20%20return%20target%3B%0A%20%20%20%20%7D%0A%20%20%20%20target.set%28this.center%2C%20this.center%29%3B%0A%20%20%20%20target.expandByScalar%28this.radius%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%29%20%7B%0A%20%20%20%20this.center.applyMatrix4%28matrix%29%3B%0A%20%20%20%20this.radius%20%3D%20this.radius%20%2A%20matrix.getMaxScaleOnAxis%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28offset%29%20%7B%0A%20%20%20%20this.center.add%28offset%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20expandByPoint%28point%29%20%7B%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20this.center.copy%28point%29%3B%0A%20%20%20%20%20%20this.radius%20%3D%200%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20_v1%2462.subVectors%28point%2C%20this.center%29%3B%0A%20%20%20%20const%20lengthSq2%20%3D%20_v1%2462.lengthSq%28%29%3B%0A%20%20%20%20if%20%28lengthSq2%20%3E%20this.radius%20%2A%20this.radius%29%20%7B%0A%20%20%20%20%20%20const%20length2%20%3D%20Math.sqrt%28lengthSq2%29%3B%0A%20%20%20%20%20%20const%20delta%20%3D%20%28length2%20-%20this.radius%29%20%2A%200.5%3B%0A%20%20%20%20%20%20this.center.addScaledVector%28_v1%2462%2C%20delta%20%2F%20length2%29%3B%0A%20%20%20%20%20%20this.radius%20%2B%3D%20delta%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20union%28sphere%29%20%7B%0A%20%20%20%20if%20%28sphere.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.isEmpty%28%29%29%20%7B%0A%20%20%20%20%20%20this.copy%28sphere%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.center.equals%28sphere.center%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.radius%20%3D%20Math.max%28this.radius%2C%20sphere.radius%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_v2%2432.subVectors%28sphere.center%2C%20this.center%29.setLength%28sphere.radius%29%3B%0A%20%20%20%20%20%20this.expandByPoint%28_v1%2462.copy%28sphere.center%29.add%28_v2%2432%29%29%3B%0A%20%20%20%20%20%20this.expandByPoint%28_v1%2462.copy%28sphere.center%29.sub%28_v2%2432%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28sphere%29%20%7B%0A%20%20%20%20return%20sphere.center.equals%28this.center%29%20%26%26%20sphere.radius%20%3D%3D%3D%20this.radius%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_vector%24a2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_segCenter2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_segDir2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_diff3%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_edge12%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_edge22%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_normal%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20Ray2%20%3D%20class%20%7B%0A%20%20constructor%28origin%20%3D%20new%20Vector32%28%29%2C%20direction2%20%3D%20new%20Vector32%280%2C%200%2C%20-1%29%29%20%7B%0A%20%20%20%20this.origin%20%3D%20origin%3B%0A%20%20%20%20this.direction%20%3D%20direction2%3B%0A%20%20%7D%0A%20%20set%28origin%2C%20direction2%29%20%7B%0A%20%20%20%20this.origin.copy%28origin%29%3B%0A%20%20%20%20this.direction.copy%28direction2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28ray%29%20%7B%0A%20%20%20%20this.origin.copy%28ray.origin%29%3B%0A%20%20%20%20this.direction.copy%28ray.direction%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20at%28t%2C%20target%29%20%7B%0A%20%20%20%20return%20target.copy%28this.origin%29.addScaledVector%28this.direction%2C%20t%29%3B%0A%20%20%7D%0A%20%20lookAt%28v%29%20%7B%0A%20%20%20%20this.direction.copy%28v%29.sub%28this.origin%29.normalize%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20recast%28t%29%20%7B%0A%20%20%20%20this.origin.copy%28this.at%28t%2C%20_vector%24a2%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20closestPointToPoint%28point%2C%20target%29%20%7B%0A%20%20%20%20target.subVectors%28point%2C%20this.origin%29%3B%0A%20%20%20%20const%20directionDistance%20%3D%20target.dot%28this.direction%29%3B%0A%20%20%20%20if%20%28directionDistance%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28this.origin%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target.copy%28this.origin%29.addScaledVector%28this.direction%2C%20directionDistance%29%3B%0A%20%20%7D%0A%20%20distanceToPoint%28point%29%20%7B%0A%20%20%20%20return%20Math.sqrt%28this.distanceSqToPoint%28point%29%29%3B%0A%20%20%7D%0A%20%20distanceSqToPoint%28point%29%20%7B%0A%20%20%20%20const%20directionDistance%20%3D%20_vector%24a2.subVectors%28point%2C%20this.origin%29.dot%28this.direction%29%3B%0A%20%20%20%20if%20%28directionDistance%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20this.origin.distanceToSquared%28point%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_vector%24a2.copy%28this.origin%29.addScaledVector%28this.direction%2C%20directionDistance%29%3B%0A%20%20%20%20return%20_vector%24a2.distanceToSquared%28point%29%3B%0A%20%20%7D%0A%20%20distanceSqToSegment%28v0%2C%20v1%2C%20optionalPointOnRay%2C%20optionalPointOnSegment%29%20%7B%0A%20%20%20%20_segCenter2.copy%28v0%29.add%28v1%29.multiplyScalar%280.5%29%3B%0A%20%20%20%20_segDir2.copy%28v1%29.sub%28v0%29.normalize%28%29%3B%0A%20%20%20%20_diff3.copy%28this.origin%29.sub%28_segCenter2%29%3B%0A%20%20%20%20const%20segExtent%20%3D%20v0.distanceTo%28v1%29%20%2A%200.5%3B%0A%20%20%20%20const%20a01%20%3D%20-this.direction.dot%28_segDir2%29%3B%0A%20%20%20%20const%20b0%20%3D%20_diff3.dot%28this.direction%29%3B%0A%20%20%20%20const%20b1%20%3D%20-_diff3.dot%28_segDir2%29%3B%0A%20%20%20%20const%20c2%20%3D%20_diff3.lengthSq%28%29%3B%0A%20%20%20%20const%20det%20%3D%20Math.abs%281%20-%20a01%20%2A%20a01%29%3B%0A%20%20%20%20let%20s0%2C%20s1%2C%20sqrDist%2C%20extDet%3B%0A%20%20%20%20if%20%28det%20%3E%200%29%20%7B%0A%20%20%20%20%20%20s0%20%3D%20a01%20%2A%20b1%20-%20b0%3B%0A%20%20%20%20%20%20s1%20%3D%20a01%20%2A%20b0%20-%20b1%3B%0A%20%20%20%20%20%20extDet%20%3D%20segExtent%20%2A%20det%3B%0A%20%20%20%20%20%20if%20%28s0%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28s1%20%3E%3D%20-extDet%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28s1%20%3C%3D%20extDet%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20invDet%20%3D%201%20%2F%20det%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20s0%20%2A%3D%20invDet%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20s1%20%2A%3D%20invDet%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20s0%20%2A%20%28s0%20%2B%20a01%20%2A%20s1%20%2B%202%20%2A%20b0%29%20%2B%20s1%20%2A%20%28a01%20%2A%20s0%20%2B%20s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20s1%20%3D%20segExtent%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28a01%20%2A%20s1%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20s1%20%3D%20-segExtent%3B%0A%20%20%20%20%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28a01%20%2A%20s1%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28s1%20%3C%3D%20-extDet%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28-a01%20%2A%20segExtent%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20s1%20%3D%20s0%20%3E%200%20%3F%20-segExtent%20%3A%20Math.min%28Math.max%28-segExtent%2C%20-b1%29%2C%20segExtent%29%3B%0A%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28s1%20%3C%3D%20extDet%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20s0%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20s1%20%3D%20Math.min%28Math.max%28-segExtent%2C%20-b1%29%2C%20segExtent%29%3B%0A%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28a01%20%2A%20segExtent%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20s1%20%3D%20s0%20%3E%200%20%3F%20segExtent%20%3A%20Math.min%28Math.max%28-segExtent%2C%20-b1%29%2C%20segExtent%29%3B%0A%20%20%20%20%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20s1%20%3D%20a01%20%3E%200%20%3F%20-segExtent%20%3A%20segExtent%3B%0A%20%20%20%20%20%20s0%20%3D%20Math.max%280%2C%20-%28a01%20%2A%20s1%20%2B%20b0%29%29%3B%0A%20%20%20%20%20%20sqrDist%20%3D%20-s0%20%2A%20s0%20%2B%20s1%20%2A%20%28s1%20%2B%202%20%2A%20b1%29%20%2B%20c2%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28optionalPointOnRay%29%20%7B%0A%20%20%20%20%20%20optionalPointOnRay.copy%28this.origin%29.addScaledVector%28this.direction%2C%20s0%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28optionalPointOnSegment%29%20%7B%0A%20%20%20%20%20%20optionalPointOnSegment.copy%28_segCenter2%29.addScaledVector%28_segDir2%2C%20s1%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20sqrDist%3B%0A%20%20%7D%0A%20%20intersectSphere%28sphere%2C%20target%29%20%7B%0A%20%20%20%20_vector%24a2.subVectors%28sphere.center%2C%20this.origin%29%3B%0A%20%20%20%20const%20tca%20%3D%20_vector%24a2.dot%28this.direction%29%3B%0A%20%20%20%20const%20d2%20%3D%20_vector%24a2.dot%28_vector%24a2%29%20-%20tca%20%2A%20tca%3B%0A%20%20%20%20const%20radius2%20%3D%20sphere.radius%20%2A%20sphere.radius%3B%0A%20%20%20%20if%20%28d2%20%3E%20radius2%29%20return%20null%3B%0A%20%20%20%20const%20thc%20%3D%20Math.sqrt%28radius2%20-%20d2%29%3B%0A%20%20%20%20const%20t0%20%3D%20tca%20-%20thc%3B%0A%20%20%20%20const%20t1%20%3D%20tca%20%2B%20thc%3B%0A%20%20%20%20if%20%28t1%20%3C%200%29%20return%20null%3B%0A%20%20%20%20if%20%28t0%20%3C%200%29%20return%20this.at%28t1%2C%20target%29%3B%0A%20%20%20%20return%20this.at%28t0%2C%20target%29%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20return%20this.distanceSqToPoint%28sphere.center%29%20%3C%3D%20sphere.radius%20%2A%20sphere.radius%3B%0A%20%20%7D%0A%20%20distanceToPlane%28plane%29%20%7B%0A%20%20%20%20const%20denominator%20%3D%20plane.normal.dot%28this.direction%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28plane.distanceToPoint%28this.origin%29%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20t%20%3D%20-%28this.origin.dot%28plane.normal%29%20%2B%20plane.constant%29%20%2F%20denominator%3B%0A%20%20%20%20return%20t%20%3E%3D%200%20%3F%20t%20%3A%20null%3B%0A%20%20%7D%0A%20%20intersectPlane%28plane%2C%20target%29%20%7B%0A%20%20%20%20const%20t%20%3D%20this.distanceToPlane%28plane%29%3B%0A%20%20%20%20if%20%28t%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.at%28t%2C%20target%29%3B%0A%20%20%7D%0A%20%20intersectsPlane%28plane%29%20%7B%0A%20%20%20%20const%20distToPoint%20%3D%20plane.distanceToPoint%28this.origin%29%3B%0A%20%20%20%20if%20%28distToPoint%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20denominator%20%3D%20plane.normal.dot%28this.direction%29%3B%0A%20%20%20%20if%20%28denominator%20%2A%20distToPoint%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20intersectBox%28box%2C%20target%29%20%7B%0A%20%20%20%20let%20tmin%2C%20tmax%2C%20tymin%2C%20tymax%2C%20tzmin%2C%20tzmax%3B%0A%20%20%20%20const%20invdirx%20%3D%201%20%2F%20this.direction.x%2C%20invdiry%20%3D%201%20%2F%20this.direction.y%2C%20invdirz%20%3D%201%20%2F%20this.direction.z%3B%0A%20%20%20%20const%20origin%20%3D%20this.origin%3B%0A%20%20%20%20if%20%28invdirx%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20tmin%20%3D%20%28box.min.x%20-%20origin.x%29%20%2A%20invdirx%3B%0A%20%20%20%20%20%20tmax%20%3D%20%28box.max.x%20-%20origin.x%29%20%2A%20invdirx%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tmin%20%3D%20%28box.max.x%20-%20origin.x%29%20%2A%20invdirx%3B%0A%20%20%20%20%20%20tmax%20%3D%20%28box.min.x%20-%20origin.x%29%20%2A%20invdirx%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28invdiry%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20tymin%20%3D%20%28box.min.y%20-%20origin.y%29%20%2A%20invdiry%3B%0A%20%20%20%20%20%20tymax%20%3D%20%28box.max.y%20-%20origin.y%29%20%2A%20invdiry%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tymin%20%3D%20%28box.max.y%20-%20origin.y%29%20%2A%20invdiry%3B%0A%20%20%20%20%20%20tymax%20%3D%20%28box.min.y%20-%20origin.y%29%20%2A%20invdiry%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28tmin%20%3E%20tymax%20%7C%7C%20tymin%20%3E%20tmax%29%20return%20null%3B%0A%20%20%20%20if%20%28tymin%20%3E%20tmin%20%7C%7C%20isNaN%28tmin%29%29%20tmin%20%3D%20tymin%3B%0A%20%20%20%20if%20%28tymax%20%3C%20tmax%20%7C%7C%20isNaN%28tmax%29%29%20tmax%20%3D%20tymax%3B%0A%20%20%20%20if%20%28invdirz%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20tzmin%20%3D%20%28box.min.z%20-%20origin.z%29%20%2A%20invdirz%3B%0A%20%20%20%20%20%20tzmax%20%3D%20%28box.max.z%20-%20origin.z%29%20%2A%20invdirz%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20tzmin%20%3D%20%28box.max.z%20-%20origin.z%29%20%2A%20invdirz%3B%0A%20%20%20%20%20%20tzmax%20%3D%20%28box.min.z%20-%20origin.z%29%20%2A%20invdirz%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28tmin%20%3E%20tzmax%20%7C%7C%20tzmin%20%3E%20tmax%29%20return%20null%3B%0A%20%20%20%20if%20%28tzmin%20%3E%20tmin%20%7C%7C%20tmin%20%21%3D%3D%20tmin%29%20tmin%20%3D%20tzmin%3B%0A%20%20%20%20if%20%28tzmax%20%3C%20tmax%20%7C%7C%20tmax%20%21%3D%3D%20tmax%29%20tmax%20%3D%20tzmax%3B%0A%20%20%20%20if%20%28tmax%20%3C%200%29%20return%20null%3B%0A%20%20%20%20return%20this.at%28tmin%20%3E%3D%200%20%3F%20tmin%20%3A%20tmax%2C%20target%29%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20this.intersectBox%28box%2C%20_vector%24a2%29%20%21%3D%3D%20null%3B%0A%20%20%7D%0A%20%20intersectTriangle%28a2%2C%20b%2C%20c2%2C%20backfaceCulling%2C%20target%29%20%7B%0A%20%20%20%20_edge12.subVectors%28b%2C%20a2%29%3B%0A%20%20%20%20_edge22.subVectors%28c2%2C%20a2%29%3B%0A%20%20%20%20_normal%242.crossVectors%28_edge12%2C%20_edge22%29%3B%0A%20%20%20%20let%20DdN%20%3D%20this.direction.dot%28_normal%242%29%3B%0A%20%20%20%20let%20sign2%3B%0A%20%20%20%20if%20%28DdN%20%3E%200%29%20%7B%0A%20%20%20%20%20%20if%20%28backfaceCulling%29%20return%20null%3B%0A%20%20%20%20%20%20sign2%20%3D%201%3B%0A%20%20%20%20%7D%20else%20if%20%28DdN%20%3C%200%29%20%7B%0A%20%20%20%20%20%20sign2%20%3D%20-1%3B%0A%20%20%20%20%20%20DdN%20%3D%20-DdN%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20_diff3.subVectors%28this.origin%2C%20a2%29%3B%0A%20%20%20%20const%20DdQxE2%20%3D%20sign2%20%2A%20this.direction.dot%28_edge22.crossVectors%28_diff3%2C%20_edge22%29%29%3B%0A%20%20%20%20if%20%28DdQxE2%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20DdE1xQ%20%3D%20sign2%20%2A%20this.direction.dot%28_edge12.cross%28_diff3%29%29%3B%0A%20%20%20%20if%20%28DdE1xQ%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28DdQxE2%20%2B%20DdE1xQ%20%3E%20DdN%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20QdN%20%3D%20-sign2%20%2A%20_diff3.dot%28_normal%242%29%3B%0A%20%20%20%20if%20%28QdN%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.at%28QdN%20%2F%20DdN%2C%20target%29%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix4%29%20%7B%0A%20%20%20%20this.origin.applyMatrix4%28matrix4%29%3B%0A%20%20%20%20this.direction.transformDirection%28matrix4%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28ray%29%20%7B%0A%20%20%20%20return%20ray.origin.equals%28this.origin%29%20%26%26%20ray.direction.equals%28this.direction%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Matrix42%20%3D%20class%20_Matrix4%20%7B%0A%20%20constructor%28n11%2C%20n12%2C%20n13%2C%20n14%2C%20n21%2C%20n22%2C%20n23%2C%20n24%2C%20n31%2C%20n32%2C%20n33%2C%20n34%2C%20n41%2C%20n42%2C%20n43%2C%20n44%29%20%7B%0A%20%20%20%20_Matrix4.prototype.isMatrix4%20%3D%20true%3B%0A%20%20%20%20this.elements%20%3D%20%5B%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%5D%3B%0A%20%20%20%20if%20%28n11%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.set%28n11%2C%20n12%2C%20n13%2C%20n14%2C%20n21%2C%20n22%2C%20n23%2C%20n24%2C%20n31%2C%20n32%2C%20n33%2C%20n34%2C%20n41%2C%20n42%2C%20n43%2C%20n44%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20set%28n11%2C%20n12%2C%20n13%2C%20n14%2C%20n21%2C%20n22%2C%20n23%2C%20n24%2C%20n31%2C%20n32%2C%20n33%2C%20n34%2C%20n41%2C%20n42%2C%20n43%2C%20n44%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20te%5B0%5D%20%3D%20n11%3B%0A%20%20%20%20te%5B4%5D%20%3D%20n12%3B%0A%20%20%20%20te%5B8%5D%20%3D%20n13%3B%0A%20%20%20%20te%5B12%5D%20%3D%20n14%3B%0A%20%20%20%20te%5B1%5D%20%3D%20n21%3B%0A%20%20%20%20te%5B5%5D%20%3D%20n22%3B%0A%20%20%20%20te%5B9%5D%20%3D%20n23%3B%0A%20%20%20%20te%5B13%5D%20%3D%20n24%3B%0A%20%20%20%20te%5B2%5D%20%3D%20n31%3B%0A%20%20%20%20te%5B6%5D%20%3D%20n32%3B%0A%20%20%20%20te%5B10%5D%20%3D%20n33%3B%0A%20%20%20%20te%5B14%5D%20%3D%20n34%3B%0A%20%20%20%20te%5B3%5D%20%3D%20n41%3B%0A%20%20%20%20te%5B7%5D%20%3D%20n42%3B%0A%20%20%20%20te%5B11%5D%20%3D%20n43%3B%0A%20%20%20%20te%5B15%5D%20%3D%20n44%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20identity%28%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20_Matrix4%28%29.fromArray%28this.elements%29%3B%0A%20%20%7D%0A%20%20copy%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20te%5B0%5D%20%3D%20me%5B0%5D%3B%0A%20%20%20%20te%5B1%5D%20%3D%20me%5B1%5D%3B%0A%20%20%20%20te%5B2%5D%20%3D%20me%5B2%5D%3B%0A%20%20%20%20te%5B3%5D%20%3D%20me%5B3%5D%3B%0A%20%20%20%20te%5B4%5D%20%3D%20me%5B4%5D%3B%0A%20%20%20%20te%5B5%5D%20%3D%20me%5B5%5D%3B%0A%20%20%20%20te%5B6%5D%20%3D%20me%5B6%5D%3B%0A%20%20%20%20te%5B7%5D%20%3D%20me%5B7%5D%3B%0A%20%20%20%20te%5B8%5D%20%3D%20me%5B8%5D%3B%0A%20%20%20%20te%5B9%5D%20%3D%20me%5B9%5D%3B%0A%20%20%20%20te%5B10%5D%20%3D%20me%5B10%5D%3B%0A%20%20%20%20te%5B11%5D%20%3D%20me%5B11%5D%3B%0A%20%20%20%20te%5B12%5D%20%3D%20me%5B12%5D%3B%0A%20%20%20%20te%5B13%5D%20%3D%20me%5B13%5D%3B%0A%20%20%20%20te%5B14%5D%20%3D%20me%5B14%5D%3B%0A%20%20%20%20te%5B15%5D%20%3D%20me%5B15%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copyPosition%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%2C%20me%20%3D%20m2.elements%3B%0A%20%20%20%20te%5B12%5D%20%3D%20me%5B12%5D%3B%0A%20%20%20%20te%5B13%5D%20%3D%20me%5B13%5D%3B%0A%20%20%20%20te%5B14%5D%20%3D%20me%5B14%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromMatrix3%28m2%29%20%7B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20me%5B0%5D%2C%0A%20%20%20%20%20%20me%5B3%5D%2C%0A%20%20%20%20%20%20me%5B6%5D%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20me%5B1%5D%2C%0A%20%20%20%20%20%20me%5B4%5D%2C%0A%20%20%20%20%20%20me%5B7%5D%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20me%5B2%5D%2C%0A%20%20%20%20%20%20me%5B5%5D%2C%0A%20%20%20%20%20%20me%5B8%5D%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20extractBasis%28xAxis%2C%20yAxis%2C%20zAxis%29%20%7B%0A%20%20%20%20xAxis.setFromMatrixColumn%28this%2C%200%29%3B%0A%20%20%20%20yAxis.setFromMatrixColumn%28this%2C%201%29%3B%0A%20%20%20%20zAxis.setFromMatrixColumn%28this%2C%202%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeBasis%28xAxis%2C%20yAxis%2C%20zAxis%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20xAxis.x%2C%0A%20%20%20%20%20%20yAxis.x%2C%0A%20%20%20%20%20%20zAxis.x%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20xAxis.y%2C%0A%20%20%20%20%20%20yAxis.y%2C%0A%20%20%20%20%20%20zAxis.y%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20xAxis.z%2C%0A%20%20%20%20%20%20yAxis.z%2C%0A%20%20%20%20%20%20zAxis.z%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20extractRotation%28m2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20const%20scaleX%20%3D%201%20%2F%20_v1%2452.setFromMatrixColumn%28m2%2C%200%29.length%28%29%3B%0A%20%20%20%20const%20scaleY%20%3D%201%20%2F%20_v1%2452.setFromMatrixColumn%28m2%2C%201%29.length%28%29%3B%0A%20%20%20%20const%20scaleZ%20%3D%201%20%2F%20_v1%2452.setFromMatrixColumn%28m2%2C%202%29.length%28%29%3B%0A%20%20%20%20te%5B0%5D%20%3D%20me%5B0%5D%20%2A%20scaleX%3B%0A%20%20%20%20te%5B1%5D%20%3D%20me%5B1%5D%20%2A%20scaleX%3B%0A%20%20%20%20te%5B2%5D%20%3D%20me%5B2%5D%20%2A%20scaleX%3B%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B4%5D%20%3D%20me%5B4%5D%20%2A%20scaleY%3B%0A%20%20%20%20te%5B5%5D%20%3D%20me%5B5%5D%20%2A%20scaleY%3B%0A%20%20%20%20te%5B6%5D%20%3D%20me%5B6%5D%20%2A%20scaleY%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B8%5D%20%3D%20me%5B8%5D%20%2A%20scaleZ%3B%0A%20%20%20%20te%5B9%5D%20%3D%20me%5B9%5D%20%2A%20scaleZ%3B%0A%20%20%20%20te%5B10%5D%20%3D%20me%5B10%5D%20%2A%20scaleZ%3B%0A%20%20%20%20te%5B11%5D%20%3D%200%3B%0A%20%20%20%20te%5B12%5D%20%3D%200%3B%0A%20%20%20%20te%5B13%5D%20%3D%200%3B%0A%20%20%20%20te%5B14%5D%20%3D%200%3B%0A%20%20%20%20te%5B15%5D%20%3D%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationFromEuler%28euler%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20x2%20%3D%20euler.x%2C%20y2%20%3D%20euler.y%2C%20z2%20%3D%20euler.z%3B%0A%20%20%20%20const%20a2%20%3D%20Math.cos%28x2%29%2C%20b%20%3D%20Math.sin%28x2%29%3B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28y2%29%2C%20d%20%3D%20Math.sin%28y2%29%3B%0A%20%20%20%20const%20e%20%3D%20Math.cos%28z2%29%2C%20f%20%3D%20Math.sin%28z2%29%3B%0A%20%20%20%20if%20%28euler.order%20%3D%3D%3D%20%22XYZ%22%29%20%7B%0A%20%20%20%20%20%20const%20ae%20%3D%20a2%20%2A%20e%2C%20af%20%3D%20a2%20%2A%20f%2C%20be%20%3D%20b%20%2A%20e%2C%20bf%20%3D%20b%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20c2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20-c2%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20d%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20af%20%2B%20be%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20ae%20-%20bf%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20-b%20%2A%20c2%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20bf%20-%20ae%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20be%20%2B%20af%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20a2%20%2A%20c2%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22YXZ%22%29%20%7B%0A%20%20%20%20%20%20const%20ce%20%3D%20c2%20%2A%20e%2C%20cf%20%3D%20c2%20%2A%20f%2C%20de%20%3D%20d%20%2A%20e%2C%20df%20%3D%20d%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20ce%20%2B%20df%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20de%20%2A%20b%20-%20cf%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20a2%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20a2%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20a2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20-b%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20cf%20%2A%20b%20-%20de%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20df%20%2B%20ce%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20a2%20%2A%20c2%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22ZXY%22%29%20%7B%0A%20%20%20%20%20%20const%20ce%20%3D%20c2%20%2A%20e%2C%20cf%20%3D%20c2%20%2A%20f%2C%20de%20%3D%20d%20%2A%20e%2C%20df%20%3D%20d%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20ce%20-%20df%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20-a2%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20de%20%2B%20cf%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20cf%20%2B%20de%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20a2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20df%20-%20ce%20%2A%20b%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20-a2%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20b%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20a2%20%2A%20c2%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22ZYX%22%29%20%7B%0A%20%20%20%20%20%20const%20ae%20%3D%20a2%20%2A%20e%2C%20af%20%3D%20a2%20%2A%20f%2C%20be%20%3D%20b%20%2A%20e%2C%20bf%20%3D%20b%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20c2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20be%20%2A%20d%20-%20af%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20ae%20%2A%20d%20%2B%20bf%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20c2%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20bf%20%2A%20d%20%2B%20ae%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20af%20%2A%20d%20-%20be%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20-d%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20b%20%2A%20c2%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20a2%20%2A%20c2%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22YZX%22%29%20%7B%0A%20%20%20%20%20%20const%20ac%20%3D%20a2%20%2A%20c2%2C%20ad%20%3D%20a2%20%2A%20d%2C%20bc%20%3D%20b%20%2A%20c2%2C%20bd%20%3D%20b%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20c2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20bd%20-%20ac%20%2A%20f%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20bc%20%2A%20f%20%2B%20ad%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20f%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20a2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20-b%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20-d%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20ad%20%2A%20f%20%2B%20bc%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20ac%20-%20bd%20%2A%20f%3B%0A%20%20%20%20%7D%20else%20if%20%28euler.order%20%3D%3D%3D%20%22XZY%22%29%20%7B%0A%20%20%20%20%20%20const%20ac%20%3D%20a2%20%2A%20c2%2C%20ad%20%3D%20a2%20%2A%20d%2C%20bc%20%3D%20b%20%2A%20c2%2C%20bd%20%3D%20b%20%2A%20d%3B%0A%20%20%20%20%20%20te%5B0%5D%20%3D%20c2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B4%5D%20%3D%20-f%3B%0A%20%20%20%20%20%20te%5B8%5D%20%3D%20d%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B1%5D%20%3D%20ac%20%2A%20f%20%2B%20bd%3B%0A%20%20%20%20%20%20te%5B5%5D%20%3D%20a2%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B9%5D%20%3D%20ad%20%2A%20f%20-%20bc%3B%0A%20%20%20%20%20%20te%5B2%5D%20%3D%20bc%20%2A%20f%20-%20ad%3B%0A%20%20%20%20%20%20te%5B6%5D%20%3D%20b%20%2A%20e%3B%0A%20%20%20%20%20%20te%5B10%5D%20%3D%20bd%20%2A%20f%20%2B%20ac%3B%0A%20%20%20%20%7D%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B11%5D%20%3D%200%3B%0A%20%20%20%20te%5B12%5D%20%3D%200%3B%0A%20%20%20%20te%5B13%5D%20%3D%200%3B%0A%20%20%20%20te%5B14%5D%20%3D%200%3B%0A%20%20%20%20te%5B15%5D%20%3D%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationFromQuaternion%28q%29%20%7B%0A%20%20%20%20return%20this.compose%28_zero2%2C%20q%2C%20_one2%29%3B%0A%20%20%7D%0A%20%20lookAt%28eye%2C%20target%2C%20up%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20_z2.subVectors%28eye%2C%20target%29%3B%0A%20%20%20%20if%20%28_z2.lengthSq%28%29%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20_z2.z%20%3D%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20_z2.normalize%28%29%3B%0A%20%20%20%20_x2.crossVectors%28up%2C%20_z2%29%3B%0A%20%20%20%20if%20%28_x2.lengthSq%28%29%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28Math.abs%28up.z%29%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20_z2.x%20%2B%3D%201e-4%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20_z2.z%20%2B%3D%201e-4%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_z2.normalize%28%29%3B%0A%20%20%20%20%20%20_x2.crossVectors%28up%2C%20_z2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_x2.normalize%28%29%3B%0A%20%20%20%20_y2.crossVectors%28_z2%2C%20_x2%29%3B%0A%20%20%20%20te%5B0%5D%20%3D%20_x2.x%3B%0A%20%20%20%20te%5B4%5D%20%3D%20_y2.x%3B%0A%20%20%20%20te%5B8%5D%20%3D%20_z2.x%3B%0A%20%20%20%20te%5B1%5D%20%3D%20_x2.y%3B%0A%20%20%20%20te%5B5%5D%20%3D%20_y2.y%3B%0A%20%20%20%20te%5B9%5D%20%3D%20_z2.y%3B%0A%20%20%20%20te%5B2%5D%20%3D%20_x2.z%3B%0A%20%20%20%20te%5B6%5D%20%3D%20_y2.z%3B%0A%20%20%20%20te%5B10%5D%20%3D%20_z2.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28m2%29%20%7B%0A%20%20%20%20return%20this.multiplyMatrices%28this%2C%20m2%29%3B%0A%20%20%7D%0A%20%20premultiply%28m2%29%20%7B%0A%20%20%20%20return%20this.multiplyMatrices%28m2%2C%20this%29%3B%0A%20%20%7D%0A%20%20multiplyMatrices%28a2%2C%20b%29%20%7B%0A%20%20%20%20const%20ae%20%3D%20a2.elements%3B%0A%20%20%20%20const%20be%20%3D%20b.elements%3B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20a11%20%3D%20ae%5B0%5D%2C%20a12%20%3D%20ae%5B4%5D%2C%20a13%20%3D%20ae%5B8%5D%2C%20a14%20%3D%20ae%5B12%5D%3B%0A%20%20%20%20const%20a21%20%3D%20ae%5B1%5D%2C%20a22%20%3D%20ae%5B5%5D%2C%20a23%20%3D%20ae%5B9%5D%2C%20a24%20%3D%20ae%5B13%5D%3B%0A%20%20%20%20const%20a31%20%3D%20ae%5B2%5D%2C%20a32%20%3D%20ae%5B6%5D%2C%20a33%20%3D%20ae%5B10%5D%2C%20a34%20%3D%20ae%5B14%5D%3B%0A%20%20%20%20const%20a41%20%3D%20ae%5B3%5D%2C%20a42%20%3D%20ae%5B7%5D%2C%20a43%20%3D%20ae%5B11%5D%2C%20a44%20%3D%20ae%5B15%5D%3B%0A%20%20%20%20const%20b11%20%3D%20be%5B0%5D%2C%20b12%20%3D%20be%5B4%5D%2C%20b13%20%3D%20be%5B8%5D%2C%20b14%20%3D%20be%5B12%5D%3B%0A%20%20%20%20const%20b21%20%3D%20be%5B1%5D%2C%20b22%20%3D%20be%5B5%5D%2C%20b23%20%3D%20be%5B9%5D%2C%20b24%20%3D%20be%5B13%5D%3B%0A%20%20%20%20const%20b31%20%3D%20be%5B2%5D%2C%20b32%20%3D%20be%5B6%5D%2C%20b33%20%3D%20be%5B10%5D%2C%20b34%20%3D%20be%5B14%5D%3B%0A%20%20%20%20const%20b41%20%3D%20be%5B3%5D%2C%20b42%20%3D%20be%5B7%5D%2C%20b43%20%3D%20be%5B11%5D%2C%20b44%20%3D%20be%5B15%5D%3B%0A%20%20%20%20te%5B0%5D%20%3D%20a11%20%2A%20b11%20%2B%20a12%20%2A%20b21%20%2B%20a13%20%2A%20b31%20%2B%20a14%20%2A%20b41%3B%0A%20%20%20%20te%5B4%5D%20%3D%20a11%20%2A%20b12%20%2B%20a12%20%2A%20b22%20%2B%20a13%20%2A%20b32%20%2B%20a14%20%2A%20b42%3B%0A%20%20%20%20te%5B8%5D%20%3D%20a11%20%2A%20b13%20%2B%20a12%20%2A%20b23%20%2B%20a13%20%2A%20b33%20%2B%20a14%20%2A%20b43%3B%0A%20%20%20%20te%5B12%5D%20%3D%20a11%20%2A%20b14%20%2B%20a12%20%2A%20b24%20%2B%20a13%20%2A%20b34%20%2B%20a14%20%2A%20b44%3B%0A%20%20%20%20te%5B1%5D%20%3D%20a21%20%2A%20b11%20%2B%20a22%20%2A%20b21%20%2B%20a23%20%2A%20b31%20%2B%20a24%20%2A%20b41%3B%0A%20%20%20%20te%5B5%5D%20%3D%20a21%20%2A%20b12%20%2B%20a22%20%2A%20b22%20%2B%20a23%20%2A%20b32%20%2B%20a24%20%2A%20b42%3B%0A%20%20%20%20te%5B9%5D%20%3D%20a21%20%2A%20b13%20%2B%20a22%20%2A%20b23%20%2B%20a23%20%2A%20b33%20%2B%20a24%20%2A%20b43%3B%0A%20%20%20%20te%5B13%5D%20%3D%20a21%20%2A%20b14%20%2B%20a22%20%2A%20b24%20%2B%20a23%20%2A%20b34%20%2B%20a24%20%2A%20b44%3B%0A%20%20%20%20te%5B2%5D%20%3D%20a31%20%2A%20b11%20%2B%20a32%20%2A%20b21%20%2B%20a33%20%2A%20b31%20%2B%20a34%20%2A%20b41%3B%0A%20%20%20%20te%5B6%5D%20%3D%20a31%20%2A%20b12%20%2B%20a32%20%2A%20b22%20%2B%20a33%20%2A%20b32%20%2B%20a34%20%2A%20b42%3B%0A%20%20%20%20te%5B10%5D%20%3D%20a31%20%2A%20b13%20%2B%20a32%20%2A%20b23%20%2B%20a33%20%2A%20b33%20%2B%20a34%20%2A%20b43%3B%0A%20%20%20%20te%5B14%5D%20%3D%20a31%20%2A%20b14%20%2B%20a32%20%2A%20b24%20%2B%20a33%20%2A%20b34%20%2B%20a34%20%2A%20b44%3B%0A%20%20%20%20te%5B3%5D%20%3D%20a41%20%2A%20b11%20%2B%20a42%20%2A%20b21%20%2B%20a43%20%2A%20b31%20%2B%20a44%20%2A%20b41%3B%0A%20%20%20%20te%5B7%5D%20%3D%20a41%20%2A%20b12%20%2B%20a42%20%2A%20b22%20%2B%20a43%20%2A%20b32%20%2B%20a44%20%2A%20b42%3B%0A%20%20%20%20te%5B11%5D%20%3D%20a41%20%2A%20b13%20%2B%20a42%20%2A%20b23%20%2B%20a43%20%2A%20b33%20%2B%20a44%20%2A%20b43%3B%0A%20%20%20%20te%5B15%5D%20%3D%20a41%20%2A%20b14%20%2B%20a42%20%2A%20b24%20%2B%20a43%20%2A%20b34%20%2B%20a44%20%2A%20b44%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28s%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20te%5B0%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B4%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B8%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B12%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B1%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B5%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B9%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B13%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B2%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B6%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B10%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B14%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B3%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B7%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B11%5D%20%2A%3D%20s%3B%0A%20%20%20%20te%5B15%5D%20%2A%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20determinant%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20n11%20%3D%20te%5B0%5D%2C%20n12%20%3D%20te%5B4%5D%2C%20n13%20%3D%20te%5B8%5D%2C%20n14%20%3D%20te%5B12%5D%3B%0A%20%20%20%20const%20n21%20%3D%20te%5B1%5D%2C%20n22%20%3D%20te%5B5%5D%2C%20n23%20%3D%20te%5B9%5D%2C%20n24%20%3D%20te%5B13%5D%3B%0A%20%20%20%20const%20n31%20%3D%20te%5B2%5D%2C%20n32%20%3D%20te%5B6%5D%2C%20n33%20%3D%20te%5B10%5D%2C%20n34%20%3D%20te%5B14%5D%3B%0A%20%20%20%20const%20n41%20%3D%20te%5B3%5D%2C%20n42%20%3D%20te%5B7%5D%2C%20n43%20%3D%20te%5B11%5D%2C%20n44%20%3D%20te%5B15%5D%3B%0A%20%20%20%20return%20n41%20%2A%20%28%2Bn14%20%2A%20n23%20%2A%20n32%20-%20n13%20%2A%20n24%20%2A%20n32%20-%20n14%20%2A%20n22%20%2A%20n33%20%2B%20n12%20%2A%20n24%20%2A%20n33%20%2B%20n13%20%2A%20n22%20%2A%20n34%20-%20n12%20%2A%20n23%20%2A%20n34%29%20%2B%20n42%20%2A%20%28%2Bn11%20%2A%20n23%20%2A%20n34%20-%20n11%20%2A%20n24%20%2A%20n33%20%2B%20n14%20%2A%20n21%20%2A%20n33%20-%20n13%20%2A%20n21%20%2A%20n34%20%2B%20n13%20%2A%20n24%20%2A%20n31%20-%20n14%20%2A%20n23%20%2A%20n31%29%20%2B%20n43%20%2A%20%28%2Bn11%20%2A%20n24%20%2A%20n32%20-%20n11%20%2A%20n22%20%2A%20n34%20-%20n14%20%2A%20n21%20%2A%20n32%20%2B%20n12%20%2A%20n21%20%2A%20n34%20%2B%20n14%20%2A%20n22%20%2A%20n31%20-%20n12%20%2A%20n24%20%2A%20n31%29%20%2B%20n44%20%2A%20%28-n13%20%2A%20n22%20%2A%20n31%20-%20n11%20%2A%20n23%20%2A%20n32%20%2B%20n11%20%2A%20n22%20%2A%20n33%20%2B%20n13%20%2A%20n21%20%2A%20n32%20-%20n12%20%2A%20n21%20%2A%20n33%20%2B%20n12%20%2A%20n23%20%2A%20n31%29%3B%0A%20%20%7D%0A%20%20transpose%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20let%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B1%5D%3B%0A%20%20%20%20te%5B1%5D%20%3D%20te%5B4%5D%3B%0A%20%20%20%20te%5B4%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B2%5D%3B%0A%20%20%20%20te%5B2%5D%20%3D%20te%5B8%5D%3B%0A%20%20%20%20te%5B8%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B6%5D%3B%0A%20%20%20%20te%5B6%5D%20%3D%20te%5B9%5D%3B%0A%20%20%20%20te%5B9%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B3%5D%3B%0A%20%20%20%20te%5B3%5D%20%3D%20te%5B12%5D%3B%0A%20%20%20%20te%5B12%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B7%5D%3B%0A%20%20%20%20te%5B7%5D%20%3D%20te%5B13%5D%3B%0A%20%20%20%20te%5B13%5D%20%3D%20tmp2%3B%0A%20%20%20%20tmp2%20%3D%20te%5B11%5D%3B%0A%20%20%20%20te%5B11%5D%20%3D%20te%5B14%5D%3B%0A%20%20%20%20te%5B14%5D%20%3D%20tmp2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setPosition%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20if%20%28x2.isVector3%29%20%7B%0A%20%20%20%20%20%20te%5B12%5D%20%3D%20x2.x%3B%0A%20%20%20%20%20%20te%5B13%5D%20%3D%20x2.y%3B%0A%20%20%20%20%20%20te%5B14%5D%20%3D%20x2.z%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20te%5B12%5D%20%3D%20x2%3B%0A%20%20%20%20%20%20te%5B13%5D%20%3D%20y2%3B%0A%20%20%20%20%20%20te%5B14%5D%20%3D%20z2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20invert%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%2C%20n11%20%3D%20te%5B0%5D%2C%20n21%20%3D%20te%5B1%5D%2C%20n31%20%3D%20te%5B2%5D%2C%20n41%20%3D%20te%5B3%5D%2C%20n12%20%3D%20te%5B4%5D%2C%20n22%20%3D%20te%5B5%5D%2C%20n32%20%3D%20te%5B6%5D%2C%20n42%20%3D%20te%5B7%5D%2C%20n13%20%3D%20te%5B8%5D%2C%20n23%20%3D%20te%5B9%5D%2C%20n33%20%3D%20te%5B10%5D%2C%20n43%20%3D%20te%5B11%5D%2C%20n14%20%3D%20te%5B12%5D%2C%20n24%20%3D%20te%5B13%5D%2C%20n34%20%3D%20te%5B14%5D%2C%20n44%20%3D%20te%5B15%5D%2C%20t11%20%3D%20n23%20%2A%20n34%20%2A%20n42%20-%20n24%20%2A%20n33%20%2A%20n42%20%2B%20n24%20%2A%20n32%20%2A%20n43%20-%20n22%20%2A%20n34%20%2A%20n43%20-%20n23%20%2A%20n32%20%2A%20n44%20%2B%20n22%20%2A%20n33%20%2A%20n44%2C%20t12%20%3D%20n14%20%2A%20n33%20%2A%20n42%20-%20n13%20%2A%20n34%20%2A%20n42%20-%20n14%20%2A%20n32%20%2A%20n43%20%2B%20n12%20%2A%20n34%20%2A%20n43%20%2B%20n13%20%2A%20n32%20%2A%20n44%20-%20n12%20%2A%20n33%20%2A%20n44%2C%20t13%20%3D%20n13%20%2A%20n24%20%2A%20n42%20-%20n14%20%2A%20n23%20%2A%20n42%20%2B%20n14%20%2A%20n22%20%2A%20n43%20-%20n12%20%2A%20n24%20%2A%20n43%20-%20n13%20%2A%20n22%20%2A%20n44%20%2B%20n12%20%2A%20n23%20%2A%20n44%2C%20t14%20%3D%20n14%20%2A%20n23%20%2A%20n32%20-%20n13%20%2A%20n24%20%2A%20n32%20-%20n14%20%2A%20n22%20%2A%20n33%20%2B%20n12%20%2A%20n24%20%2A%20n33%20%2B%20n13%20%2A%20n22%20%2A%20n34%20-%20n12%20%2A%20n23%20%2A%20n34%3B%0A%20%20%20%20const%20det%20%3D%20n11%20%2A%20t11%20%2B%20n21%20%2A%20t12%20%2B%20n31%20%2A%20t13%20%2B%20n41%20%2A%20t14%3B%0A%20%20%20%20if%20%28det%20%3D%3D%3D%200%29%20return%20this.set%280%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20const%20detInv%20%3D%201%20%2F%20det%3B%0A%20%20%20%20te%5B0%5D%20%3D%20t11%20%2A%20detInv%3B%0A%20%20%20%20te%5B1%5D%20%3D%20%28n24%20%2A%20n33%20%2A%20n41%20-%20n23%20%2A%20n34%20%2A%20n41%20-%20n24%20%2A%20n31%20%2A%20n43%20%2B%20n21%20%2A%20n34%20%2A%20n43%20%2B%20n23%20%2A%20n31%20%2A%20n44%20-%20n21%20%2A%20n33%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B2%5D%20%3D%20%28n22%20%2A%20n34%20%2A%20n41%20-%20n24%20%2A%20n32%20%2A%20n41%20%2B%20n24%20%2A%20n31%20%2A%20n42%20-%20n21%20%2A%20n34%20%2A%20n42%20-%20n22%20%2A%20n31%20%2A%20n44%20%2B%20n21%20%2A%20n32%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B3%5D%20%3D%20%28n23%20%2A%20n32%20%2A%20n41%20-%20n22%20%2A%20n33%20%2A%20n41%20-%20n23%20%2A%20n31%20%2A%20n42%20%2B%20n21%20%2A%20n33%20%2A%20n42%20%2B%20n22%20%2A%20n31%20%2A%20n43%20-%20n21%20%2A%20n32%20%2A%20n43%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B4%5D%20%3D%20t12%20%2A%20detInv%3B%0A%20%20%20%20te%5B5%5D%20%3D%20%28n13%20%2A%20n34%20%2A%20n41%20-%20n14%20%2A%20n33%20%2A%20n41%20%2B%20n14%20%2A%20n31%20%2A%20n43%20-%20n11%20%2A%20n34%20%2A%20n43%20-%20n13%20%2A%20n31%20%2A%20n44%20%2B%20n11%20%2A%20n33%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B6%5D%20%3D%20%28n14%20%2A%20n32%20%2A%20n41%20-%20n12%20%2A%20n34%20%2A%20n41%20-%20n14%20%2A%20n31%20%2A%20n42%20%2B%20n11%20%2A%20n34%20%2A%20n42%20%2B%20n12%20%2A%20n31%20%2A%20n44%20-%20n11%20%2A%20n32%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B7%5D%20%3D%20%28n12%20%2A%20n33%20%2A%20n41%20-%20n13%20%2A%20n32%20%2A%20n41%20%2B%20n13%20%2A%20n31%20%2A%20n42%20-%20n11%20%2A%20n33%20%2A%20n42%20-%20n12%20%2A%20n31%20%2A%20n43%20%2B%20n11%20%2A%20n32%20%2A%20n43%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B8%5D%20%3D%20t13%20%2A%20detInv%3B%0A%20%20%20%20te%5B9%5D%20%3D%20%28n14%20%2A%20n23%20%2A%20n41%20-%20n13%20%2A%20n24%20%2A%20n41%20-%20n14%20%2A%20n21%20%2A%20n43%20%2B%20n11%20%2A%20n24%20%2A%20n43%20%2B%20n13%20%2A%20n21%20%2A%20n44%20-%20n11%20%2A%20n23%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B10%5D%20%3D%20%28n12%20%2A%20n24%20%2A%20n41%20-%20n14%20%2A%20n22%20%2A%20n41%20%2B%20n14%20%2A%20n21%20%2A%20n42%20-%20n11%20%2A%20n24%20%2A%20n42%20-%20n12%20%2A%20n21%20%2A%20n44%20%2B%20n11%20%2A%20n22%20%2A%20n44%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B11%5D%20%3D%20%28n13%20%2A%20n22%20%2A%20n41%20-%20n12%20%2A%20n23%20%2A%20n41%20-%20n13%20%2A%20n21%20%2A%20n42%20%2B%20n11%20%2A%20n23%20%2A%20n42%20%2B%20n12%20%2A%20n21%20%2A%20n43%20-%20n11%20%2A%20n22%20%2A%20n43%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B12%5D%20%3D%20t14%20%2A%20detInv%3B%0A%20%20%20%20te%5B13%5D%20%3D%20%28n13%20%2A%20n24%20%2A%20n31%20-%20n14%20%2A%20n23%20%2A%20n31%20%2B%20n14%20%2A%20n21%20%2A%20n33%20-%20n11%20%2A%20n24%20%2A%20n33%20-%20n13%20%2A%20n21%20%2A%20n34%20%2B%20n11%20%2A%20n23%20%2A%20n34%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B14%5D%20%3D%20%28n14%20%2A%20n22%20%2A%20n31%20-%20n12%20%2A%20n24%20%2A%20n31%20-%20n14%20%2A%20n21%20%2A%20n32%20%2B%20n11%20%2A%20n24%20%2A%20n32%20%2B%20n12%20%2A%20n21%20%2A%20n34%20-%20n11%20%2A%20n22%20%2A%20n34%29%20%2A%20detInv%3B%0A%20%20%20%20te%5B15%5D%20%3D%20%28n12%20%2A%20n23%20%2A%20n31%20-%20n13%20%2A%20n22%20%2A%20n31%20%2B%20n13%20%2A%20n21%20%2A%20n32%20-%20n11%20%2A%20n23%20%2A%20n32%20-%20n12%20%2A%20n21%20%2A%20n33%20%2B%20n11%20%2A%20n22%20%2A%20n33%29%20%2A%20detInv%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20scale%28v%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20x2%20%3D%20v.x%2C%20y2%20%3D%20v.y%2C%20z2%20%3D%20v.z%3B%0A%20%20%20%20te%5B0%5D%20%2A%3D%20x2%3B%0A%20%20%20%20te%5B4%5D%20%2A%3D%20y2%3B%0A%20%20%20%20te%5B8%5D%20%2A%3D%20z2%3B%0A%20%20%20%20te%5B1%5D%20%2A%3D%20x2%3B%0A%20%20%20%20te%5B5%5D%20%2A%3D%20y2%3B%0A%20%20%20%20te%5B9%5D%20%2A%3D%20z2%3B%0A%20%20%20%20te%5B2%5D%20%2A%3D%20x2%3B%0A%20%20%20%20te%5B6%5D%20%2A%3D%20y2%3B%0A%20%20%20%20te%5B10%5D%20%2A%3D%20z2%3B%0A%20%20%20%20te%5B3%5D%20%2A%3D%20x2%3B%0A%20%20%20%20te%5B7%5D%20%2A%3D%20y2%3B%0A%20%20%20%20te%5B11%5D%20%2A%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getMaxScaleOnAxis%28%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20scaleXSq%20%3D%20te%5B0%5D%20%2A%20te%5B0%5D%20%2B%20te%5B1%5D%20%2A%20te%5B1%5D%20%2B%20te%5B2%5D%20%2A%20te%5B2%5D%3B%0A%20%20%20%20const%20scaleYSq%20%3D%20te%5B4%5D%20%2A%20te%5B4%5D%20%2B%20te%5B5%5D%20%2A%20te%5B5%5D%20%2B%20te%5B6%5D%20%2A%20te%5B6%5D%3B%0A%20%20%20%20const%20scaleZSq%20%3D%20te%5B8%5D%20%2A%20te%5B8%5D%20%2B%20te%5B9%5D%20%2A%20te%5B9%5D%20%2B%20te%5B10%5D%20%2A%20te%5B10%5D%3B%0A%20%20%20%20return%20Math.sqrt%28Math.max%28scaleXSq%2C%20scaleYSq%2C%20scaleZSq%29%29%3B%0A%20%20%7D%0A%20%20makeTranslation%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28x2.isVector3%29%20%7B%0A%20%20%20%20%20%20this.set%28%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2.x%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2.y%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20x2.z%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.set%28%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20z2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationX%28theta%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28theta%29%2C%20s%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%20-s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20s%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationY%28theta%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28theta%29%2C%20s%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20-s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationZ%28theta%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28theta%29%2C%20s%20%3D%20Math.sin%28theta%29%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%20-s%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20s%2C%0A%20%20%20%20%20%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeRotationAxis%28axis%2C%20angle%29%20%7B%0A%20%20%20%20const%20c2%20%3D%20Math.cos%28angle%29%3B%0A%20%20%20%20const%20s%20%3D%20Math.sin%28angle%29%3B%0A%20%20%20%20const%20t%20%3D%201%20-%20c2%3B%0A%20%20%20%20const%20x2%20%3D%20axis.x%2C%20y2%20%3D%20axis.y%2C%20z2%20%3D%20axis.z%3B%0A%20%20%20%20const%20tx%20%3D%20t%20%2A%20x2%2C%20ty%20%3D%20t%20%2A%20y2%3B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20tx%20%2A%20x2%20%2B%20c2%2C%0A%20%20%20%20%20%20tx%20%2A%20y2%20-%20s%20%2A%20z2%2C%0A%20%20%20%20%20%20tx%20%2A%20z2%20%2B%20s%20%2A%20y2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20tx%20%2A%20y2%20%2B%20s%20%2A%20z2%2C%0A%20%20%20%20%20%20ty%20%2A%20y2%20%2B%20c2%2C%0A%20%20%20%20%20%20ty%20%2A%20z2%20-%20s%20%2A%20x2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20tx%20%2A%20z2%20-%20s%20%2A%20y2%2C%0A%20%20%20%20%20%20ty%20%2A%20z2%20%2B%20s%20%2A%20x2%2C%0A%20%20%20%20%20%20t%20%2A%20z2%20%2A%20z2%20%2B%20c2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeScale%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20z2%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeShear%28xy%2C%20xz%2C%20yx%2C%20yz%2C%20zx%2C%20zy%29%20%7B%0A%20%20%20%20this.set%28%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20yx%2C%0A%20%20%20%20%20%20zx%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20xy%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20zy%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20xz%2C%0A%20%20%20%20%20%20yz%2C%0A%20%20%20%20%20%201%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20compose%28position%2C%20quaternion%2C%20scale%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20x2%20%3D%20quaternion._x%2C%20y2%20%3D%20quaternion._y%2C%20z2%20%3D%20quaternion._z%2C%20w%20%3D%20quaternion._w%3B%0A%20%20%20%20const%20x22%20%3D%20x2%20%2B%20x2%2C%20y22%20%3D%20y2%20%2B%20y2%2C%20z22%20%3D%20z2%20%2B%20z2%3B%0A%20%20%20%20const%20xx%20%3D%20x2%20%2A%20x22%2C%20xy%20%3D%20x2%20%2A%20y22%2C%20xz%20%3D%20x2%20%2A%20z22%3B%0A%20%20%20%20const%20yy%20%3D%20y2%20%2A%20y22%2C%20yz%20%3D%20y2%20%2A%20z22%2C%20zz%20%3D%20z2%20%2A%20z22%3B%0A%20%20%20%20const%20wx%20%3D%20w%20%2A%20x22%2C%20wy%20%3D%20w%20%2A%20y22%2C%20wz%20%3D%20w%20%2A%20z22%3B%0A%20%20%20%20const%20sx%20%3D%20scale.x%2C%20sy%20%3D%20scale.y%2C%20sz%20%3D%20scale.z%3B%0A%20%20%20%20te%5B0%5D%20%3D%20%281%20-%20%28yy%20%2B%20zz%29%29%20%2A%20sx%3B%0A%20%20%20%20te%5B1%5D%20%3D%20%28xy%20%2B%20wz%29%20%2A%20sx%3B%0A%20%20%20%20te%5B2%5D%20%3D%20%28xz%20-%20wy%29%20%2A%20sx%3B%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B4%5D%20%3D%20%28xy%20-%20wz%29%20%2A%20sy%3B%0A%20%20%20%20te%5B5%5D%20%3D%20%281%20-%20%28xx%20%2B%20zz%29%29%20%2A%20sy%3B%0A%20%20%20%20te%5B6%5D%20%3D%20%28yz%20%2B%20wx%29%20%2A%20sy%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B8%5D%20%3D%20%28xz%20%2B%20wy%29%20%2A%20sz%3B%0A%20%20%20%20te%5B9%5D%20%3D%20%28yz%20-%20wx%29%20%2A%20sz%3B%0A%20%20%20%20te%5B10%5D%20%3D%20%281%20-%20%28xx%20%2B%20yy%29%29%20%2A%20sz%3B%0A%20%20%20%20te%5B11%5D%20%3D%200%3B%0A%20%20%20%20te%5B12%5D%20%3D%20position.x%3B%0A%20%20%20%20te%5B13%5D%20%3D%20position.y%3B%0A%20%20%20%20te%5B14%5D%20%3D%20position.z%3B%0A%20%20%20%20te%5B15%5D%20%3D%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20decompose%28position%2C%20quaternion%2C%20scale%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20let%20sx%20%3D%20_v1%2452.set%28te%5B0%5D%2C%20te%5B1%5D%2C%20te%5B2%5D%29.length%28%29%3B%0A%20%20%20%20const%20sy%20%3D%20_v1%2452.set%28te%5B4%5D%2C%20te%5B5%5D%2C%20te%5B6%5D%29.length%28%29%3B%0A%20%20%20%20const%20sz%20%3D%20_v1%2452.set%28te%5B8%5D%2C%20te%5B9%5D%2C%20te%5B10%5D%29.length%28%29%3B%0A%20%20%20%20const%20det%20%3D%20this.determinant%28%29%3B%0A%20%20%20%20if%20%28det%20%3C%200%29%20sx%20%3D%20-sx%3B%0A%20%20%20%20position.x%20%3D%20te%5B12%5D%3B%0A%20%20%20%20position.y%20%3D%20te%5B13%5D%3B%0A%20%20%20%20position.z%20%3D%20te%5B14%5D%3B%0A%20%20%20%20_m1%2432.copy%28this%29%3B%0A%20%20%20%20const%20invSX%20%3D%201%20%2F%20sx%3B%0A%20%20%20%20const%20invSY%20%3D%201%20%2F%20sy%3B%0A%20%20%20%20const%20invSZ%20%3D%201%20%2F%20sz%3B%0A%20%20%20%20_m1%2432.elements%5B0%5D%20%2A%3D%20invSX%3B%0A%20%20%20%20_m1%2432.elements%5B1%5D%20%2A%3D%20invSX%3B%0A%20%20%20%20_m1%2432.elements%5B2%5D%20%2A%3D%20invSX%3B%0A%20%20%20%20_m1%2432.elements%5B4%5D%20%2A%3D%20invSY%3B%0A%20%20%20%20_m1%2432.elements%5B5%5D%20%2A%3D%20invSY%3B%0A%20%20%20%20_m1%2432.elements%5B6%5D%20%2A%3D%20invSY%3B%0A%20%20%20%20_m1%2432.elements%5B8%5D%20%2A%3D%20invSZ%3B%0A%20%20%20%20_m1%2432.elements%5B9%5D%20%2A%3D%20invSZ%3B%0A%20%20%20%20_m1%2432.elements%5B10%5D%20%2A%3D%20invSZ%3B%0A%20%20%20%20quaternion.setFromRotationMatrix%28_m1%2432%29%3B%0A%20%20%20%20scale.x%20%3D%20sx%3B%0A%20%20%20%20scale.y%20%3D%20sy%3B%0A%20%20%20%20scale.z%20%3D%20sz%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makePerspective%28left%2C%20right%2C%20top%2C%20bottom%2C%20near%2C%20far%2C%20coordinateSystem%20%3D%20WebGLCoordinateSystem2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20x2%20%3D%202%20%2A%20near%20%2F%20%28right%20-%20left%29%3B%0A%20%20%20%20const%20y2%20%3D%202%20%2A%20near%20%2F%20%28top%20-%20bottom%29%3B%0A%20%20%20%20const%20a2%20%3D%20%28right%20%2B%20left%29%20%2F%20%28right%20-%20left%29%3B%0A%20%20%20%20const%20b%20%3D%20%28top%20%2B%20bottom%29%20%2F%20%28top%20-%20bottom%29%3B%0A%20%20%20%20let%20c2%2C%20d%3B%0A%20%20%20%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20c2%20%3D%20-%28far%20%2B%20near%29%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20%20%20d%20%3D%20-2%20%2A%20far%20%2A%20near%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20%7D%20else%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20c2%20%3D%20-far%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20%20%20d%20%3D%20-far%20%2A%20near%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.Matrix4.makePerspective%28%29%3A%20Invalid%20coordinate%20system%3A%20%22%20%2B%20coordinateSystem%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20te%5B0%5D%20%3D%20x2%3B%0A%20%20%20%20te%5B4%5D%20%3D%200%3B%0A%20%20%20%20te%5B8%5D%20%3D%20a2%3B%0A%20%20%20%20te%5B12%5D%20%3D%200%3B%0A%20%20%20%20te%5B1%5D%20%3D%200%3B%0A%20%20%20%20te%5B5%5D%20%3D%20y2%3B%0A%20%20%20%20te%5B9%5D%20%3D%20b%3B%0A%20%20%20%20te%5B13%5D%20%3D%200%3B%0A%20%20%20%20te%5B2%5D%20%3D%200%3B%0A%20%20%20%20te%5B6%5D%20%3D%200%3B%0A%20%20%20%20te%5B10%5D%20%3D%20c2%3B%0A%20%20%20%20te%5B14%5D%20%3D%20d%3B%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B11%5D%20%3D%20-1%3B%0A%20%20%20%20te%5B15%5D%20%3D%200%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20makeOrthographic%28left%2C%20right%2C%20top%2C%20bottom%2C%20near%2C%20far%2C%20coordinateSystem%20%3D%20WebGLCoordinateSystem2%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20w%20%3D%201%20%2F%20%28right%20-%20left%29%3B%0A%20%20%20%20const%20h%20%3D%201%20%2F%20%28top%20-%20bottom%29%3B%0A%20%20%20%20const%20p%20%3D%201%20%2F%20%28far%20-%20near%29%3B%0A%20%20%20%20const%20x2%20%3D%20%28right%20%2B%20left%29%20%2A%20w%3B%0A%20%20%20%20const%20y2%20%3D%20%28top%20%2B%20bottom%29%20%2A%20h%3B%0A%20%20%20%20let%20z2%2C%20zInv%3B%0A%20%20%20%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20z2%20%3D%20%28far%20%2B%20near%29%20%2A%20p%3B%0A%20%20%20%20%20%20zInv%20%3D%20-2%20%2A%20p%3B%0A%20%20%20%20%7D%20else%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20z2%20%3D%20near%20%2A%20p%3B%0A%20%20%20%20%20%20zInv%20%3D%20-1%20%2A%20p%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.Matrix4.makeOrthographic%28%29%3A%20Invalid%20coordinate%20system%3A%20%22%20%2B%20coordinateSystem%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20te%5B0%5D%20%3D%202%20%2A%20w%3B%0A%20%20%20%20te%5B4%5D%20%3D%200%3B%0A%20%20%20%20te%5B8%5D%20%3D%200%3B%0A%20%20%20%20te%5B12%5D%20%3D%20-x2%3B%0A%20%20%20%20te%5B1%5D%20%3D%200%3B%0A%20%20%20%20te%5B5%5D%20%3D%202%20%2A%20h%3B%0A%20%20%20%20te%5B9%5D%20%3D%200%3B%0A%20%20%20%20te%5B13%5D%20%3D%20-y2%3B%0A%20%20%20%20te%5B2%5D%20%3D%200%3B%0A%20%20%20%20te%5B6%5D%20%3D%200%3B%0A%20%20%20%20te%5B10%5D%20%3D%20zInv%3B%0A%20%20%20%20te%5B14%5D%20%3D%20-z2%3B%0A%20%20%20%20te%5B3%5D%20%3D%200%3B%0A%20%20%20%20te%5B7%5D%20%3D%200%3B%0A%20%20%20%20te%5B11%5D%20%3D%200%3B%0A%20%20%20%20te%5B15%5D%20%3D%201%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28matrix%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20const%20me%20%3D%20matrix.elements%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%2016%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28te%5Bi%5D%20%21%3D%3D%20me%5Bi%5D%29%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%2016%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.elements%5Bi%5D%20%3D%20array%5Bi%20%2B%20offset%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20const%20te%20%3D%20this.elements%3B%0A%20%20%20%20array%5Boffset%5D%20%3D%20te%5B0%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20te%5B1%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20te%5B2%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20te%5B3%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%204%5D%20%3D%20te%5B4%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%205%5D%20%3D%20te%5B5%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%206%5D%20%3D%20te%5B6%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%207%5D%20%3D%20te%5B7%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%208%5D%20%3D%20te%5B8%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%209%5D%20%3D%20te%5B9%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2010%5D%20%3D%20te%5B10%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2011%5D%20%3D%20te%5B11%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2012%5D%20%3D%20te%5B12%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2013%5D%20%3D%20te%5B13%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2014%5D%20%3D%20te%5B14%5D%3B%0A%20%20%20%20array%5Boffset%20%2B%2015%5D%20%3D%20te%5B15%5D%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_v1%2452%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_m1%2432%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20_zero2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%280%2C%200%2C%200%29%3B%0Avar%20_one2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%281%2C%201%2C%201%29%3B%0Avar%20_x2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_y2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_z2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_matrix%2422%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20_quaternion%2432%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Quaternion2%28%29%3B%0Avar%20Euler2%20%3D%20class%20_Euler%20%7B%0A%20%20constructor%28x2%20%3D%200%2C%20y2%20%3D%200%2C%20z2%20%3D%200%2C%20order%20%3D%20_Euler.DEFAULT_ORDER%29%20%7B%0A%20%20%20%20this.isEuler%20%3D%20true%3B%0A%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20this._order%20%3D%20order%3B%0A%20%20%7D%0A%20%20get%20x%28%29%20%7B%0A%20%20%20%20return%20this._x%3B%0A%20%20%7D%0A%20%20set%20x%28value%29%20%7B%0A%20%20%20%20this._x%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20y%28%29%20%7B%0A%20%20%20%20return%20this._y%3B%0A%20%20%7D%0A%20%20set%20y%28value%29%20%7B%0A%20%20%20%20this._y%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20z%28%29%20%7B%0A%20%20%20%20return%20this._z%3B%0A%20%20%7D%0A%20%20set%20z%28value%29%20%7B%0A%20%20%20%20this._z%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20get%20order%28%29%20%7B%0A%20%20%20%20return%20this._order%3B%0A%20%20%7D%0A%20%20set%20order%28value%29%20%7B%0A%20%20%20%20this._order%20%3D%20value%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%7D%0A%20%20set%28x2%2C%20y2%2C%20z2%2C%20order%20%3D%20this._order%29%20%7B%0A%20%20%20%20this._x%20%3D%20x2%3B%0A%20%20%20%20this._y%20%3D%20y2%3B%0A%20%20%20%20this._z%20%3D%20z2%3B%0A%20%20%20%20this._order%20%3D%20order%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this._x%2C%20this._y%2C%20this._z%2C%20this._order%29%3B%0A%20%20%7D%0A%20%20copy%28euler%29%20%7B%0A%20%20%20%20this._x%20%3D%20euler._x%3B%0A%20%20%20%20this._y%20%3D%20euler._y%3B%0A%20%20%20%20this._z%20%3D%20euler._z%3B%0A%20%20%20%20this._order%20%3D%20euler._order%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromRotationMatrix%28m2%2C%20order%20%3D%20this._order%2C%20update4%20%3D%20true%29%20%7B%0A%20%20%20%20const%20te%20%3D%20m2.elements%3B%0A%20%20%20%20const%20m11%20%3D%20te%5B0%5D%2C%20m12%20%3D%20te%5B4%5D%2C%20m13%20%3D%20te%5B8%5D%3B%0A%20%20%20%20const%20m21%20%3D%20te%5B1%5D%2C%20m22%20%3D%20te%5B5%5D%2C%20m23%20%3D%20te%5B9%5D%3B%0A%20%20%20%20const%20m31%20%3D%20te%5B2%5D%2C%20m32%20%3D%20te%5B6%5D%2C%20m33%20%3D%20te%5B10%5D%3B%0A%20%20%20%20switch%20%28order%29%20%7B%0A%20%20%20%20%20%20case%20%22XYZ%22%3A%0A%20%20%20%20%20%20%20%20this._y%20%3D%20Math.asin%28clamp%241%28m13%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m13%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28-m23%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28-m12%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28m32%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22YXZ%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20Math.asin%28-clamp%241%28m23%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m23%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28m13%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28m21%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28-m31%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22ZXY%22%3A%0A%20%20%20%20%20%20%20%20this._x%20%3D%20Math.asin%28clamp%241%28m32%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m32%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28-m31%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28-m12%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28m21%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22ZYX%22%3A%0A%20%20%20%20%20%20%20%20this._y%20%3D%20Math.asin%28-clamp%241%28m31%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m31%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28m32%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28m21%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20this._z%20%3D%20Math.atan2%28-m12%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22YZX%22%3A%0A%20%20%20%20%20%20%20%20this._z%20%3D%20Math.asin%28clamp%241%28m21%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m21%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28-m23%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28-m31%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28m13%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20%22XZY%22%3A%0A%20%20%20%20%20%20%20%20this._z%20%3D%20Math.asin%28-clamp%241%28m12%2C%20-1%2C%201%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28Math.abs%28m12%29%20%3C%200.9999999%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28m32%2C%20m22%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%20Math.atan2%28m13%2C%20m11%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._x%20%3D%20Math.atan2%28-m23%2C%20m33%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._y%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.Euler%3A%20.setFromRotationMatrix%28%29%20encountered%20an%20unknown%20order%3A%20%22%20%2B%20order%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._order%20%3D%20order%3B%0A%20%20%20%20if%20%28update4%20%3D%3D%3D%20true%29%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromQuaternion%28q%2C%20order%2C%20update4%29%20%7B%0A%20%20%20%20_matrix%2422.makeRotationFromQuaternion%28q%29%3B%0A%20%20%20%20return%20this.setFromRotationMatrix%28_matrix%2422%2C%20order%2C%20update4%29%3B%0A%20%20%7D%0A%20%20setFromVector3%28v%2C%20order%20%3D%20this._order%29%20%7B%0A%20%20%20%20return%20this.set%28v.x%2C%20v.y%2C%20v.z%2C%20order%29%3B%0A%20%20%7D%0A%20%20reorder%28newOrder%29%20%7B%0A%20%20%20%20_quaternion%2432.setFromEuler%28this%29%3B%0A%20%20%20%20return%20this.setFromQuaternion%28_quaternion%2432%2C%20newOrder%29%3B%0A%20%20%7D%0A%20%20equals%28euler%29%20%7B%0A%20%20%20%20return%20euler._x%20%3D%3D%3D%20this._x%20%26%26%20euler._y%20%3D%3D%3D%20this._y%20%26%26%20euler._z%20%3D%3D%3D%20this._z%20%26%26%20euler._order%20%3D%3D%3D%20this._order%3B%0A%20%20%7D%0A%20%20fromArray%28array%29%20%7B%0A%20%20%20%20this._x%20%3D%20array%5B0%5D%3B%0A%20%20%20%20this._y%20%3D%20array%5B1%5D%3B%0A%20%20%20%20this._z%20%3D%20array%5B2%5D%3B%0A%20%20%20%20if%20%28array%5B3%5D%20%21%3D%3D%20void%200%29%20this._order%20%3D%20array%5B3%5D%3B%0A%20%20%20%20this._onChangeCallback%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this._x%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this._y%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this._z%3B%0A%20%20%20%20array%5Boffset%20%2B%203%5D%20%3D%20this._order%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20_onChange%28callback%29%20%7B%0A%20%20%20%20this._onChangeCallback%20%3D%20callback%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20_onChangeCallback%28%29%20%7B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this._x%3B%0A%20%20%20%20yield%20this._y%3B%0A%20%20%20%20yield%20this._z%3B%0A%20%20%20%20yield%20this._order%3B%0A%20%20%7D%0A%7D%3B%0AEuler2.DEFAULT_ORDER%20%3D%20%22XYZ%22%3B%0Avar%20Layers2%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.mask%20%3D%201%20%7C%200%3B%0A%20%20%7D%0A%20%20set%28channel%29%20%7B%0A%20%20%20%20this.mask%20%3D%20%281%20%3C%3C%20channel%20%7C%200%29%20%3E%3E%3E%200%3B%0A%20%20%7D%0A%20%20enable%28channel%29%20%7B%0A%20%20%20%20this.mask%20%7C%3D%201%20%3C%3C%20channel%20%7C%200%3B%0A%20%20%7D%0A%20%20enableAll%28%29%20%7B%0A%20%20%20%20this.mask%20%3D%204294967295%20%7C%200%3B%0A%20%20%7D%0A%20%20toggle%28channel%29%20%7B%0A%20%20%20%20this.mask%20%5E%3D%201%20%3C%3C%20channel%20%7C%200%3B%0A%20%20%7D%0A%20%20disable%28channel%29%20%7B%0A%20%20%20%20this.mask%20%26%3D%20~%281%20%3C%3C%20channel%20%7C%200%29%3B%0A%20%20%7D%0A%20%20disableAll%28%29%20%7B%0A%20%20%20%20this.mask%20%3D%200%3B%0A%20%20%7D%0A%20%20test%28layers%29%20%7B%0A%20%20%20%20return%20%28this.mask%20%26%20layers.mask%29%20%21%3D%3D%200%3B%0A%20%20%7D%0A%20%20isEnabled%28channel%29%20%7B%0A%20%20%20%20return%20%28this.mask%20%26%20%281%20%3C%3C%20channel%20%7C%200%29%29%20%21%3D%3D%200%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_object3DId2%20%3D%200%3B%0Avar%20_v1%2442%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_q12%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Quaternion2%28%29%3B%0Avar%20_m1%2422%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20_target%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_position%2432%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_scale%2422%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_quaternion%2422%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Quaternion2%28%29%3B%0Avar%20_xAxis2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%281%2C%200%2C%200%29%3B%0Avar%20_yAxis2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%280%2C%201%2C%200%29%3B%0Avar%20_zAxis2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%280%2C%200%2C%201%29%3B%0Avar%20_addedEvent2%20%3D%20%7B%20type%3A%20%22added%22%20%7D%3B%0Avar%20_removedEvent2%20%3D%20%7B%20type%3A%20%22removed%22%20%7D%3B%0Avar%20_childaddedEvent2%20%3D%20%7B%20type%3A%20%22childadded%22%2C%20child%3A%20null%20%7D%3B%0Avar%20_childremovedEvent2%20%3D%20%7B%20type%3A%20%22childremoved%22%2C%20child%3A%20null%20%7D%3B%0Avar%20Object3D2%20%3D%20class%20_Object3D%20extends%20EventDispatcher2%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isObject3D%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_object3DId2%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID2%28%29%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.type%20%3D%20%22Object3D%22%3B%0A%20%20%20%20this.parent%20%3D%20null%3B%0A%20%20%20%20this.children%20%3D%20%5B%5D%3B%0A%20%20%20%20this.up%20%3D%20_Object3D.DEFAULT_UP.clone%28%29%3B%0A%20%20%20%20const%20position%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20const%20rotation%20%3D%20new%20Euler2%28%29%3B%0A%20%20%20%20const%20quaternion%20%3D%20new%20Quaternion2%28%29%3B%0A%20%20%20%20const%20scale%20%3D%20new%20Vector32%281%2C%201%2C%201%29%3B%0A%20%20%20%20function%20onRotationChange%28%29%20%7B%0A%20%20%20%20%20%20quaternion.setFromEuler%28rotation%2C%20false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20onQuaternionChange%28%29%20%7B%0A%20%20%20%20%20%20rotation.setFromQuaternion%28quaternion%2C%20void%200%2C%20false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20rotation._onChange%28onRotationChange%29%3B%0A%20%20%20%20quaternion._onChange%28onQuaternionChange%29%3B%0A%20%20%20%20Object.defineProperties%28this%2C%20%7B%0A%20%20%20%20%20%20position%3A%20%7B%0A%20%20%20%20%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20%20%20%20%20value%3A%20position%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20rotation%3A%20%7B%0A%20%20%20%20%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20%20%20%20%20value%3A%20rotation%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20quaternion%3A%20%7B%0A%20%20%20%20%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20%20%20%20%20value%3A%20quaternion%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20scale%3A%20%7B%0A%20%20%20%20%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20%20%20%20%20value%3A%20scale%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20modelViewMatrix%3A%20%7B%0A%20%20%20%20%20%20%20%20value%3A%20new%20Matrix42%28%29%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20normalMatrix%3A%20%7B%0A%20%20%20%20%20%20%20%20value%3A%20new%20Matrix32%28%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.matrix%20%3D%20new%20Matrix42%28%29%3B%0A%20%20%20%20this.matrixWorld%20%3D%20new%20Matrix42%28%29%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20_Object3D.DEFAULT_MATRIX_AUTO_UPDATE%3B%0A%20%20%20%20this.matrixWorldAutoUpdate%20%3D%20_Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE%3B%0A%20%20%20%20this.matrixWorldNeedsUpdate%20%3D%20false%3B%0A%20%20%20%20this.layers%20%3D%20new%20Layers2%28%29%3B%0A%20%20%20%20this.visible%20%3D%20true%3B%0A%20%20%20%20this.castShadow%20%3D%20false%3B%0A%20%20%20%20this.receiveShadow%20%3D%20false%3B%0A%20%20%20%20this.frustumCulled%20%3D%20true%3B%0A%20%20%20%20this.renderOrder%20%3D%200%3B%0A%20%20%20%20this.animations%20%3D%20%5B%5D%3B%0A%20%20%20%20this.userData%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20onBeforeShadow%28%29%20%7B%0A%20%20%7D%0A%20%20onAfterShadow%28%29%20%7B%0A%20%20%7D%0A%20%20onBeforeRender%28%29%20%7B%0A%20%20%7D%0A%20%20onAfterRender%28%29%20%7B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%29%20%7B%0A%20%20%20%20if%20%28this.matrixAutoUpdate%29%20this.updateMatrix%28%29%3B%0A%20%20%20%20this.matrix.premultiply%28matrix%29%3B%0A%20%20%20%20this.matrix.decompose%28this.position%2C%20this.quaternion%2C%20this.scale%29%3B%0A%20%20%7D%0A%20%20applyQuaternion%28q%29%20%7B%0A%20%20%20%20this.quaternion.premultiply%28q%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setRotationFromAxisAngle%28axis%2C%20angle%29%20%7B%0A%20%20%20%20this.quaternion.setFromAxisAngle%28axis%2C%20angle%29%3B%0A%20%20%7D%0A%20%20setRotationFromEuler%28euler%29%20%7B%0A%20%20%20%20this.quaternion.setFromEuler%28euler%2C%20true%29%3B%0A%20%20%7D%0A%20%20setRotationFromMatrix%28m2%29%20%7B%0A%20%20%20%20this.quaternion.setFromRotationMatrix%28m2%29%3B%0A%20%20%7D%0A%20%20setRotationFromQuaternion%28q%29%20%7B%0A%20%20%20%20this.quaternion.copy%28q%29%3B%0A%20%20%7D%0A%20%20rotateOnAxis%28axis%2C%20angle%29%20%7B%0A%20%20%20%20_q12.setFromAxisAngle%28axis%2C%20angle%29%3B%0A%20%20%20%20this.quaternion.multiply%28_q12%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateOnWorldAxis%28axis%2C%20angle%29%20%7B%0A%20%20%20%20_q12.setFromAxisAngle%28axis%2C%20angle%29%3B%0A%20%20%20%20this.quaternion.premultiply%28_q12%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateX%28angle%29%20%7B%0A%20%20%20%20return%20this.rotateOnAxis%28_xAxis2%2C%20angle%29%3B%0A%20%20%7D%0A%20%20rotateY%28angle%29%20%7B%0A%20%20%20%20return%20this.rotateOnAxis%28_yAxis2%2C%20angle%29%3B%0A%20%20%7D%0A%20%20rotateZ%28angle%29%20%7B%0A%20%20%20%20return%20this.rotateOnAxis%28_zAxis2%2C%20angle%29%3B%0A%20%20%7D%0A%20%20translateOnAxis%28axis%2C%20distance2%29%20%7B%0A%20%20%20%20_v1%2442.copy%28axis%29.applyQuaternion%28this.quaternion%29%3B%0A%20%20%20%20this.position.add%28_v1%2442.multiplyScalar%28distance2%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translateX%28distance2%29%20%7B%0A%20%20%20%20return%20this.translateOnAxis%28_xAxis2%2C%20distance2%29%3B%0A%20%20%7D%0A%20%20translateY%28distance2%29%20%7B%0A%20%20%20%20return%20this.translateOnAxis%28_yAxis2%2C%20distance2%29%3B%0A%20%20%7D%0A%20%20translateZ%28distance2%29%20%7B%0A%20%20%20%20return%20this.translateOnAxis%28_zAxis2%2C%20distance2%29%3B%0A%20%20%7D%0A%20%20localToWorld%28vector%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20return%20vector.applyMatrix4%28this.matrixWorld%29%3B%0A%20%20%7D%0A%20%20worldToLocal%28vector%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20return%20vector.applyMatrix4%28_m1%2422.copy%28this.matrixWorld%29.invert%28%29%29%3B%0A%20%20%7D%0A%20%20lookAt%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28x2.isVector3%29%20%7B%0A%20%20%20%20%20%20_target%241.copy%28x2%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_target%241.set%28x2%2C%20y2%2C%20z2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20parent%20%3D%20this.parent%3B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20_position%2432.setFromMatrixPosition%28this.matrixWorld%29%3B%0A%20%20%20%20if%20%28this.isCamera%20%7C%7C%20this.isLight%29%20%7B%0A%20%20%20%20%20%20_m1%2422.lookAt%28_position%2432%2C%20_target%241%2C%20this.up%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_m1%2422.lookAt%28_target%241%2C%20_position%2432%2C%20this.up%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.quaternion.setFromRotationMatrix%28_m1%2422%29%3B%0A%20%20%20%20if%20%28parent%29%20%7B%0A%20%20%20%20%20%20_m1%2422.extractRotation%28parent.matrixWorld%29%3B%0A%20%20%20%20%20%20_q12.setFromRotationMatrix%28_m1%2422%29%3B%0A%20%20%20%20%20%20this.quaternion.premultiply%28_q12.invert%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20add%28object%29%20%7B%0A%20%20%20%20if%20%28arguments.length%20%3E%201%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20arguments.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this.add%28arguments%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object%20%3D%3D%3D%20this%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.Object3D.add%3A%20object%20can%27t%20be%20added%20as%20a%20child%20of%20itself.%22%2C%20object%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object%20%26%26%20object.isObject3D%29%20%7B%0A%20%20%20%20%20%20object.removeFromParent%28%29%3B%0A%20%20%20%20%20%20object.parent%20%3D%20this%3B%0A%20%20%20%20%20%20this.children.push%28object%29%3B%0A%20%20%20%20%20%20object.dispatchEvent%28_addedEvent2%29%3B%0A%20%20%20%20%20%20_childaddedEvent2.child%20%3D%20object%3B%0A%20%20%20%20%20%20this.dispatchEvent%28_childaddedEvent2%29%3B%0A%20%20%20%20%20%20_childaddedEvent2.child%20%3D%20null%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.Object3D.add%3A%20object%20not%20an%20instance%20of%20THREE.Object3D.%22%2C%20object%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20remove%28object%29%20%7B%0A%20%20%20%20if%20%28arguments.length%20%3E%201%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20arguments.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this.remove%28arguments%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20index5%20%3D%20this.children.indexOf%28object%29%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20object.parent%20%3D%20null%3B%0A%20%20%20%20%20%20this.children.splice%28index5%2C%201%29%3B%0A%20%20%20%20%20%20object.dispatchEvent%28_removedEvent2%29%3B%0A%20%20%20%20%20%20_childremovedEvent2.child%20%3D%20object%3B%0A%20%20%20%20%20%20this.dispatchEvent%28_childremovedEvent2%29%3B%0A%20%20%20%20%20%20_childremovedEvent2.child%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20removeFromParent%28%29%20%7B%0A%20%20%20%20const%20parent%20%3D%20this.parent%3B%0A%20%20%20%20if%20%28parent%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20parent.remove%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clear%28%29%20%7B%0A%20%20%20%20return%20this.remove%28...this.children%29%3B%0A%20%20%7D%0A%20%20attach%28object%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20_m1%2422.copy%28this.matrixWorld%29.invert%28%29%3B%0A%20%20%20%20if%20%28object.parent%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20object.parent.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20%20%20_m1%2422.multiply%28object.parent.matrixWorld%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20object.applyMatrix4%28_m1%2422%29%3B%0A%20%20%20%20object.removeFromParent%28%29%3B%0A%20%20%20%20object.parent%20%3D%20this%3B%0A%20%20%20%20this.children.push%28object%29%3B%0A%20%20%20%20object.updateWorldMatrix%28false%2C%20true%29%3B%0A%20%20%20%20object.dispatchEvent%28_addedEvent2%29%3B%0A%20%20%20%20_childaddedEvent2.child%20%3D%20object%3B%0A%20%20%20%20this.dispatchEvent%28_childaddedEvent2%29%3B%0A%20%20%20%20_childaddedEvent2.child%20%3D%20null%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getObjectById%28id2%29%20%7B%0A%20%20%20%20return%20this.getObjectByProperty%28%22id%22%2C%20id2%29%3B%0A%20%20%7D%0A%20%20getObjectByName%28name%29%20%7B%0A%20%20%20%20return%20this.getObjectByProperty%28%22name%22%2C%20name%29%3B%0A%20%20%7D%0A%20%20getObjectByProperty%28name%2C%20value%29%20%7B%0A%20%20%20%20if%20%28this%5Bname%5D%20%3D%3D%3D%20value%29%20return%20this%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20child%20%3D%20this.children%5Bi%5D%3B%0A%20%20%20%20%20%20const%20object%20%3D%20child.getObjectByProperty%28name%2C%20value%29%3B%0A%20%20%20%20%20%20if%20%28object%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20object%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20void%200%3B%0A%20%20%7D%0A%20%20getObjectsByProperty%28name%2C%20value%2C%20result%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20if%20%28this%5Bname%5D%20%3D%3D%3D%20value%29%20result.push%28this%29%3B%0A%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20children%5Bi%5D.getObjectsByProperty%28name%2C%20value%2C%20result%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20getWorldPosition%28target%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20return%20target.setFromMatrixPosition%28this.matrixWorld%29%3B%0A%20%20%7D%0A%20%20getWorldQuaternion%28target%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20this.matrixWorld.decompose%28_position%2432%2C%20target%2C%20_scale%2422%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getWorldScale%28target%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20this.matrixWorld.decompose%28_position%2432%2C%20_quaternion%2422%2C%20target%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getWorldDirection%28target%29%20%7B%0A%20%20%20%20this.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20const%20e%20%3D%20this.matrixWorld.elements%3B%0A%20%20%20%20return%20target.set%28e%5B8%5D%2C%20e%5B9%5D%2C%20e%5B10%5D%29.normalize%28%29%3B%0A%20%20%7D%0A%20%20raycast%28%29%20%7B%0A%20%20%7D%0A%20%20traverse%28callback%29%20%7B%0A%20%20%20%20callback%28this%29%3B%0A%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20children%5Bi%5D.traverse%28callback%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20traverseVisible%28callback%29%20%7B%0A%20%20%20%20if%20%28this.visible%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20callback%28this%29%3B%0A%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20children%5Bi%5D.traverseVisible%28callback%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20traverseAncestors%28callback%29%20%7B%0A%20%20%20%20const%20parent%20%3D%20this.parent%3B%0A%20%20%20%20if%20%28parent%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20callback%28parent%29%3B%0A%20%20%20%20%20%20parent.traverseAncestors%28callback%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateMatrix%28%29%20%7B%0A%20%20%20%20this.matrix.compose%28this.position%2C%20this.quaternion%2C%20this.scale%29%3B%0A%20%20%20%20this.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20updateMatrixWorld%28force%29%20%7B%0A%20%20%20%20if%20%28this.matrixAutoUpdate%29%20this.updateMatrix%28%29%3B%0A%20%20%20%20if%20%28this.matrixWorldNeedsUpdate%20%7C%7C%20force%29%20%7B%0A%20%20%20%20%20%20if%20%28this.matrixWorldAutoUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.parent%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.matrixWorld.copy%28this.matrix%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.matrixWorld.multiplyMatrices%28this.parent.matrixWorld%2C%20this.matrix%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.matrixWorldNeedsUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20force%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20child%20%3D%20children%5Bi%5D%3B%0A%20%20%20%20%20%20child.updateMatrixWorld%28force%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateWorldMatrix%28updateParents%2C%20updateChildren%29%20%7B%0A%20%20%20%20const%20parent%20%3D%20this.parent%3B%0A%20%20%20%20if%20%28updateParents%20%3D%3D%3D%20true%20%26%26%20parent%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20parent.updateWorldMatrix%28true%2C%20false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.matrixAutoUpdate%29%20this.updateMatrix%28%29%3B%0A%20%20%20%20if%20%28this.matrixWorldAutoUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20if%20%28this.parent%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this.matrixWorld.copy%28this.matrix%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this.matrixWorld.multiplyMatrices%28this.parent.matrixWorld%2C%20this.matrix%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28updateChildren%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20children%20%3D%20this.children%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20child%20%3D%20children%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20child.updateWorldMatrix%28false%2C%20true%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20isRootObject%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20const%20output2%20%3D%20%7B%7D%3B%0A%20%20%20%20if%20%28isRootObject%29%20%7B%0A%20%20%20%20%20%20meta%20%3D%20%7B%0A%20%20%20%20%20%20%20%20geometries%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20materials%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20textures%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20images%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20shapes%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20skeletons%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20animations%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20nodes%3A%20%7B%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20output2.metadata%20%3D%20%7B%0A%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22Object%22%2C%0A%20%20%20%20%20%20%20%20generator%3A%20%22Object3D.toJSON%22%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20object%20%3D%20%7B%7D%3B%0A%20%20%20%20object.uuid%20%3D%20this.uuid%3B%0A%20%20%20%20object.type%20%3D%20this.type%3B%0A%20%20%20%20if%20%28this.name%20%21%3D%3D%20%22%22%29%20object.name%20%3D%20this.name%3B%0A%20%20%20%20if%20%28this.castShadow%20%3D%3D%3D%20true%29%20object.castShadow%20%3D%20true%3B%0A%20%20%20%20if%20%28this.receiveShadow%20%3D%3D%3D%20true%29%20object.receiveShadow%20%3D%20true%3B%0A%20%20%20%20if%20%28this.visible%20%3D%3D%3D%20false%29%20object.visible%20%3D%20false%3B%0A%20%20%20%20if%20%28this.frustumCulled%20%3D%3D%3D%20false%29%20object.frustumCulled%20%3D%20false%3B%0A%20%20%20%20if%20%28this.renderOrder%20%21%3D%3D%200%29%20object.renderOrder%20%3D%20this.renderOrder%3B%0A%20%20%20%20if%20%28Object.keys%28this.userData%29.length%20%3E%200%29%20object.userData%20%3D%20this.userData%3B%0A%20%20%20%20object.layers%20%3D%20this.layers.mask%3B%0A%20%20%20%20object.matrix%20%3D%20this.matrix.toArray%28%29%3B%0A%20%20%20%20object.up%20%3D%20this.up.toArray%28%29%3B%0A%20%20%20%20if%20%28this.matrixAutoUpdate%20%3D%3D%3D%20false%29%20object.matrixAutoUpdate%20%3D%20false%3B%0A%20%20%20%20if%20%28this.isInstancedMesh%29%20%7B%0A%20%20%20%20%20%20object.type%20%3D%20%22InstancedMesh%22%3B%0A%20%20%20%20%20%20object.count%20%3D%20this.count%3B%0A%20%20%20%20%20%20object.instanceMatrix%20%3D%20this.instanceMatrix.toJSON%28%29%3B%0A%20%20%20%20%20%20if%20%28this.instanceColor%20%21%3D%3D%20null%29%20object.instanceColor%20%3D%20this.instanceColor.toJSON%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.isBatchedMesh%29%20%7B%0A%20%20%20%20%20%20object.type%20%3D%20%22BatchedMesh%22%3B%0A%20%20%20%20%20%20object.perObjectFrustumCulled%20%3D%20this.perObjectFrustumCulled%3B%0A%20%20%20%20%20%20object.sortObjects%20%3D%20this.sortObjects%3B%0A%20%20%20%20%20%20object.drawRanges%20%3D%20this._drawRanges%3B%0A%20%20%20%20%20%20object.reservedRanges%20%3D%20this._reservedRanges%3B%0A%20%20%20%20%20%20object.visibility%20%3D%20this._visibility%3B%0A%20%20%20%20%20%20object.active%20%3D%20this._active%3B%0A%20%20%20%20%20%20object.bounds%20%3D%20this._bounds.map%28%28bound%29%20%3D%3E%20%28%7B%0A%20%20%20%20%20%20%20%20boxInitialized%3A%20bound.boxInitialized%2C%0A%20%20%20%20%20%20%20%20boxMin%3A%20bound.box.min.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20boxMax%3A%20bound.box.max.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20sphereInitialized%3A%20bound.sphereInitialized%2C%0A%20%20%20%20%20%20%20%20sphereRadius%3A%20bound.sphere.radius%2C%0A%20%20%20%20%20%20%20%20sphereCenter%3A%20bound.sphere.center.toArray%28%29%0A%20%20%20%20%20%20%7D%29%29%3B%0A%20%20%20%20%20%20object.maxInstanceCount%20%3D%20this._maxInstanceCount%3B%0A%20%20%20%20%20%20object.maxVertexCount%20%3D%20this._maxVertexCount%3B%0A%20%20%20%20%20%20object.maxIndexCount%20%3D%20this._maxIndexCount%3B%0A%20%20%20%20%20%20object.geometryInitialized%20%3D%20this._geometryInitialized%3B%0A%20%20%20%20%20%20object.geometryCount%20%3D%20this._geometryCount%3B%0A%20%20%20%20%20%20object.matricesTexture%20%3D%20this._matricesTexture.toJSON%28meta%29%3B%0A%20%20%20%20%20%20if%20%28this._colorsTexture%20%21%3D%3D%20null%29%20object.colorsTexture%20%3D%20this._colorsTexture.toJSON%28meta%29%3B%0A%20%20%20%20%20%20if%20%28this.boundingSphere%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20object.boundingSphere%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20center%3A%20object.boundingSphere.center.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20radius%3A%20object.boundingSphere.radius%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this.boundingBox%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20object.boundingBox%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20min%3A%20object.boundingBox.min.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20max%3A%20object.boundingBox.max.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20serialize%28library%2C%20element2%29%20%7B%0A%20%20%20%20%20%20if%20%28library%5Belement2.uuid%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20library%5Belement2.uuid%5D%20%3D%20element2.toJSON%28meta%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20element2.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.isScene%29%20%7B%0A%20%20%20%20%20%20if%20%28this.background%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.background.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20object.background%20%3D%20this.background.toJSON%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28this.background.isTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20object.background%20%3D%20this.background.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this.environment%20%26%26%20this.environment.isTexture%20%26%26%20this.environment.isRenderTargetTexture%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20object.environment%20%3D%20this.environment.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28this.isMesh%20%7C%7C%20this.isLine%20%7C%7C%20this.isPoints%29%20%7B%0A%20%20%20%20%20%20object.geometry%20%3D%20serialize%28meta.geometries%2C%20this.geometry%29%3B%0A%20%20%20%20%20%20const%20parameters%20%3D%20this.geometry.parameters%3B%0A%20%20%20%20%20%20if%20%28parameters%20%21%3D%3D%20void%200%20%26%26%20parameters.shapes%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20shapes%20%3D%20parameters.shapes%3B%0A%20%20%20%20%20%20%20%20if%20%28Array.isArray%28shapes%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20shapes.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20shape%20%3D%20shapes%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20serialize%28meta.shapes%2C%20shape%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20serialize%28meta.shapes%2C%20shapes%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.isSkinnedMesh%29%20%7B%0A%20%20%20%20%20%20object.bindMode%20%3D%20this.bindMode%3B%0A%20%20%20%20%20%20object.bindMatrix%20%3D%20this.bindMatrix.toArray%28%29%3B%0A%20%20%20%20%20%20if%20%28this.skeleton%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20serialize%28meta.skeletons%2C%20this.skeleton%29%3B%0A%20%20%20%20%20%20%20%20object.skeleton%20%3D%20this.skeleton.uuid%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.material%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28Array.isArray%28this.material%29%29%20%7B%0A%20%20%20%20%20%20%20%20const%20uuids%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.material.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20uuids.push%28serialize%28meta.materials%2C%20this.material%5Bi%5D%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20object.material%20%3D%20uuids%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20object.material%20%3D%20serialize%28meta.materials%2C%20this.material%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.children.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20object.children%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this.children.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20object.children.push%28this.children%5Bi%5D.toJSON%28meta%29.object%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.animations.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20object.animations%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this.animations.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20animation%20%3D%20this.animations%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20object.animations.push%28serialize%28meta.animations%2C%20animation%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isRootObject%29%20%7B%0A%20%20%20%20%20%20const%20geometries%20%3D%20extractFromCache%28meta.geometries%29%3B%0A%20%20%20%20%20%20const%20materials%20%3D%20extractFromCache%28meta.materials%29%3B%0A%20%20%20%20%20%20const%20textures%20%3D%20extractFromCache%28meta.textures%29%3B%0A%20%20%20%20%20%20const%20images%20%3D%20extractFromCache%28meta.images%29%3B%0A%20%20%20%20%20%20const%20shapes%20%3D%20extractFromCache%28meta.shapes%29%3B%0A%20%20%20%20%20%20const%20skeletons%20%3D%20extractFromCache%28meta.skeletons%29%3B%0A%20%20%20%20%20%20const%20animations%20%3D%20extractFromCache%28meta.animations%29%3B%0A%20%20%20%20%20%20const%20nodes%20%3D%20extractFromCache%28meta.nodes%29%3B%0A%20%20%20%20%20%20if%20%28geometries.length%20%3E%200%29%20output2.geometries%20%3D%20geometries%3B%0A%20%20%20%20%20%20if%20%28materials.length%20%3E%200%29%20output2.materials%20%3D%20materials%3B%0A%20%20%20%20%20%20if%20%28textures.length%20%3E%200%29%20output2.textures%20%3D%20textures%3B%0A%20%20%20%20%20%20if%20%28images.length%20%3E%200%29%20output2.images%20%3D%20images%3B%0A%20%20%20%20%20%20if%20%28shapes.length%20%3E%200%29%20output2.shapes%20%3D%20shapes%3B%0A%20%20%20%20%20%20if%20%28skeletons.length%20%3E%200%29%20output2.skeletons%20%3D%20skeletons%3B%0A%20%20%20%20%20%20if%20%28animations.length%20%3E%200%29%20output2.animations%20%3D%20animations%3B%0A%20%20%20%20%20%20if%20%28nodes.length%20%3E%200%29%20output2.nodes%20%3D%20nodes%3B%0A%20%20%20%20%7D%0A%20%20%20%20output2.object%20%3D%20object%3B%0A%20%20%20%20return%20output2%3B%0A%20%20%20%20function%20extractFromCache%28cache2%29%20%7B%0A%20%20%20%20%20%20const%20values%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28const%20key%20in%20cache2%29%20%7B%0A%20%20%20%20%20%20%20%20const%20data%20%3D%20cache2%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20delete%20data.metadata%3B%0A%20%20%20%20%20%20%20%20values.push%28data%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20values%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clone%28recursive%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%2C%20recursive%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%20%3D%20true%29%20%7B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20this.up.copy%28source.up%29%3B%0A%20%20%20%20this.position.copy%28source.position%29%3B%0A%20%20%20%20this.rotation.order%20%3D%20source.rotation.order%3B%0A%20%20%20%20this.quaternion.copy%28source.quaternion%29%3B%0A%20%20%20%20this.scale.copy%28source.scale%29%3B%0A%20%20%20%20this.matrix.copy%28source.matrix%29%3B%0A%20%20%20%20this.matrixWorld.copy%28source.matrixWorld%29%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20source.matrixAutoUpdate%3B%0A%20%20%20%20this.matrixWorldAutoUpdate%20%3D%20source.matrixWorldAutoUpdate%3B%0A%20%20%20%20this.matrixWorldNeedsUpdate%20%3D%20source.matrixWorldNeedsUpdate%3B%0A%20%20%20%20this.layers.mask%20%3D%20source.layers.mask%3B%0A%20%20%20%20this.visible%20%3D%20source.visible%3B%0A%20%20%20%20this.castShadow%20%3D%20source.castShadow%3B%0A%20%20%20%20this.receiveShadow%20%3D%20source.receiveShadow%3B%0A%20%20%20%20this.frustumCulled%20%3D%20source.frustumCulled%3B%0A%20%20%20%20this.renderOrder%20%3D%20source.renderOrder%3B%0A%20%20%20%20this.animations%20%3D%20source.animations.slice%28%29%3B%0A%20%20%20%20this.userData%20%3D%20JSON.parse%28JSON.stringify%28source.userData%29%29%3B%0A%20%20%20%20if%20%28recursive%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20source.children.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20child%20%3D%20source.children%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20this.add%28child.clone%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0AObject3D2.DEFAULT_UP%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%280%2C%201%2C%200%29%3B%0AObject3D2.DEFAULT_MATRIX_AUTO_UPDATE%20%3D%20true%3B%0AObject3D2.DEFAULT_MATRIX_WORLD_AUTO_UPDATE%20%3D%20true%3B%0Avar%20_v0%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_v1%2432%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_v2%2422%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_v3%2422%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vab2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vac2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vbc2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vap2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vbp2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vcp2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_v402%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector42%28%29%3B%0Avar%20_v412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector42%28%29%3B%0Avar%20_v422%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector42%28%29%3B%0Avar%20Triangle2%20%3D%20class%20_Triangle%20%7B%0A%20%20constructor%28a2%20%3D%20new%20Vector32%28%29%2C%20b%20%3D%20new%20Vector32%28%29%2C%20c2%20%3D%20new%20Vector32%28%29%29%20%7B%0A%20%20%20%20this.a%20%3D%20a2%3B%0A%20%20%20%20this.b%20%3D%20b%3B%0A%20%20%20%20this.c%20%3D%20c2%3B%0A%20%20%7D%0A%20%20static%20getNormal%28a2%2C%20b%2C%20c2%2C%20target%29%20%7B%0A%20%20%20%20target.subVectors%28c2%2C%20b%29%3B%0A%20%20%20%20_v0%2412.subVectors%28a2%2C%20b%29%3B%0A%20%20%20%20target.cross%28_v0%2412%29%3B%0A%20%20%20%20const%20targetLengthSq%20%3D%20target.lengthSq%28%29%3B%0A%20%20%20%20if%20%28targetLengthSq%20%3E%200%29%20%7B%0A%20%20%20%20%20%20return%20target.multiplyScalar%281%20%2F%20Math.sqrt%28targetLengthSq%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target.set%280%2C%200%2C%200%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20static%2Finstance%20method%20to%20calculate%20barycentric%20coordinates%0A%20%20%2F%2F%20based%20on%3A%20http%3A%2F%2Fwww.blackpawn.com%2Ftexts%2Fpointinpoly%2Fdefault.html%0A%20%20static%20getBarycoord%28point%2C%20a2%2C%20b%2C%20c2%2C%20target%29%20%7B%0A%20%20%20%20_v0%2412.subVectors%28c2%2C%20a2%29%3B%0A%20%20%20%20_v1%2432.subVectors%28b%2C%20a2%29%3B%0A%20%20%20%20_v2%2422.subVectors%28point%2C%20a2%29%3B%0A%20%20%20%20const%20dot00%20%3D%20_v0%2412.dot%28_v0%2412%29%3B%0A%20%20%20%20const%20dot01%20%3D%20_v0%2412.dot%28_v1%2432%29%3B%0A%20%20%20%20const%20dot02%20%3D%20_v0%2412.dot%28_v2%2422%29%3B%0A%20%20%20%20const%20dot11%20%3D%20_v1%2432.dot%28_v1%2432%29%3B%0A%20%20%20%20const%20dot12%20%3D%20_v1%2432.dot%28_v2%2422%29%3B%0A%20%20%20%20const%20denom%20%3D%20dot00%20%2A%20dot11%20-%20dot01%20%2A%20dot01%3B%0A%20%20%20%20if%20%28denom%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20target.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20invDenom%20%3D%201%20%2F%20denom%3B%0A%20%20%20%20const%20u%20%3D%20%28dot11%20%2A%20dot02%20-%20dot01%20%2A%20dot12%29%20%2A%20invDenom%3B%0A%20%20%20%20const%20v%20%3D%20%28dot00%20%2A%20dot12%20-%20dot01%20%2A%20dot02%29%20%2A%20invDenom%3B%0A%20%20%20%20return%20target.set%281%20-%20u%20-%20v%2C%20v%2C%20u%29%3B%0A%20%20%7D%0A%20%20static%20containsPoint%28point%2C%20a2%2C%20b%2C%20c2%29%20%7B%0A%20%20%20%20if%20%28this.getBarycoord%28point%2C%20a2%2C%20b%2C%20c2%2C%20_v3%2422%29%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20_v3%2422.x%20%3E%3D%200%20%26%26%20_v3%2422.y%20%3E%3D%200%20%26%26%20_v3%2422.x%20%2B%20_v3%2422.y%20%3C%3D%201%3B%0A%20%20%7D%0A%20%20static%20getInterpolation%28point%2C%20p1%2C%20p2%2C%20p3%2C%20v1%2C%20v2%2C%20v3%2C%20target%29%20%7B%0A%20%20%20%20if%20%28this.getBarycoord%28point%2C%20p1%2C%20p2%2C%20p3%2C%20_v3%2422%29%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20target.x%20%3D%200%3B%0A%20%20%20%20%20%20target.y%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28%22z%22%20in%20target%29%20target.z%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28%22w%22%20in%20target%29%20target.w%20%3D%200%3B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20target.setScalar%280%29%3B%0A%20%20%20%20target.addScaledVector%28v1%2C%20_v3%2422.x%29%3B%0A%20%20%20%20target.addScaledVector%28v2%2C%20_v3%2422.y%29%3B%0A%20%20%20%20target.addScaledVector%28v3%2C%20_v3%2422.z%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20static%20getInterpolatedAttribute%28attr%2C%20i1%2C%20i2%2C%20i3%2C%20barycoord%2C%20target%29%20%7B%0A%20%20%20%20_v402.setScalar%280%29%3B%0A%20%20%20%20_v412.setScalar%280%29%3B%0A%20%20%20%20_v422.setScalar%280%29%3B%0A%20%20%20%20_v402.fromBufferAttribute%28attr%2C%20i1%29%3B%0A%20%20%20%20_v412.fromBufferAttribute%28attr%2C%20i2%29%3B%0A%20%20%20%20_v422.fromBufferAttribute%28attr%2C%20i3%29%3B%0A%20%20%20%20target.setScalar%280%29%3B%0A%20%20%20%20target.addScaledVector%28_v402%2C%20barycoord.x%29%3B%0A%20%20%20%20target.addScaledVector%28_v412%2C%20barycoord.y%29%3B%0A%20%20%20%20target.addScaledVector%28_v422%2C%20barycoord.z%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20static%20isFrontFacing%28a2%2C%20b%2C%20c2%2C%20direction2%29%20%7B%0A%20%20%20%20_v0%2412.subVectors%28c2%2C%20b%29%3B%0A%20%20%20%20_v1%2432.subVectors%28a2%2C%20b%29%3B%0A%20%20%20%20return%20_v0%2412.cross%28_v1%2432%29.dot%28direction2%29%20%3C%200%20%3F%20true%20%3A%20false%3B%0A%20%20%7D%0A%20%20set%28a2%2C%20b%2C%20c2%29%20%7B%0A%20%20%20%20this.a.copy%28a2%29%3B%0A%20%20%20%20this.b.copy%28b%29%3B%0A%20%20%20%20this.c.copy%28c2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromPointsAndIndices%28points%2C%20i0%2C%20i1%2C%20i2%29%20%7B%0A%20%20%20%20this.a.copy%28points%5Bi0%5D%29%3B%0A%20%20%20%20this.b.copy%28points%5Bi1%5D%29%3B%0A%20%20%20%20this.c.copy%28points%5Bi2%5D%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromAttributeAndIndices%28attribute2%2C%20i0%2C%20i1%2C%20i2%29%20%7B%0A%20%20%20%20this.a.fromBufferAttribute%28attribute2%2C%20i0%29%3B%0A%20%20%20%20this.b.fromBufferAttribute%28attribute2%2C%20i1%29%3B%0A%20%20%20%20this.c.fromBufferAttribute%28attribute2%2C%20i2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28triangle%29%20%7B%0A%20%20%20%20this.a.copy%28triangle.a%29%3B%0A%20%20%20%20this.b.copy%28triangle.b%29%3B%0A%20%20%20%20this.c.copy%28triangle.c%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getArea%28%29%20%7B%0A%20%20%20%20_v0%2412.subVectors%28this.c%2C%20this.b%29%3B%0A%20%20%20%20_v1%2432.subVectors%28this.a%2C%20this.b%29%3B%0A%20%20%20%20return%20_v0%2412.cross%28_v1%2432%29.length%28%29%20%2A%200.5%3B%0A%20%20%7D%0A%20%20getMidpoint%28target%29%20%7B%0A%20%20%20%20return%20target.addVectors%28this.a%2C%20this.b%29.add%28this.c%29.multiplyScalar%281%20%2F%203%29%3B%0A%20%20%7D%0A%20%20getNormal%28target%29%20%7B%0A%20%20%20%20return%20_Triangle.getNormal%28this.a%2C%20this.b%2C%20this.c%2C%20target%29%3B%0A%20%20%7D%0A%20%20getPlane%28target%29%20%7B%0A%20%20%20%20return%20target.setFromCoplanarPoints%28this.a%2C%20this.b%2C%20this.c%29%3B%0A%20%20%7D%0A%20%20getBarycoord%28point%2C%20target%29%20%7B%0A%20%20%20%20return%20_Triangle.getBarycoord%28point%2C%20this.a%2C%20this.b%2C%20this.c%2C%20target%29%3B%0A%20%20%7D%0A%20%20getInterpolation%28point%2C%20v1%2C%20v2%2C%20v3%2C%20target%29%20%7B%0A%20%20%20%20return%20_Triangle.getInterpolation%28point%2C%20this.a%2C%20this.b%2C%20this.c%2C%20v1%2C%20v2%2C%20v3%2C%20target%29%3B%0A%20%20%7D%0A%20%20containsPoint%28point%29%20%7B%0A%20%20%20%20return%20_Triangle.containsPoint%28point%2C%20this.a%2C%20this.b%2C%20this.c%29%3B%0A%20%20%7D%0A%20%20isFrontFacing%28direction2%29%20%7B%0A%20%20%20%20return%20_Triangle.isFrontFacing%28this.a%2C%20this.b%2C%20this.c%2C%20direction2%29%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20box.intersectsTriangle%28this%29%3B%0A%20%20%7D%0A%20%20closestPointToPoint%28p%2C%20target%29%20%7B%0A%20%20%20%20const%20a2%20%3D%20this.a%2C%20b%20%3D%20this.b%2C%20c2%20%3D%20this.c%3B%0A%20%20%20%20let%20v%2C%20w%3B%0A%20%20%20%20_vab2.subVectors%28b%2C%20a2%29%3B%0A%20%20%20%20_vac2.subVectors%28c2%2C%20a2%29%3B%0A%20%20%20%20_vap2.subVectors%28p%2C%20a2%29%3B%0A%20%20%20%20const%20d1%20%3D%20_vab2.dot%28_vap2%29%3B%0A%20%20%20%20const%20d2%20%3D%20_vac2.dot%28_vap2%29%3B%0A%20%20%20%20if%20%28d1%20%3C%3D%200%20%26%26%20d2%20%3C%3D%200%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28a2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_vbp2.subVectors%28p%2C%20b%29%3B%0A%20%20%20%20const%20d3%20%3D%20_vab2.dot%28_vbp2%29%3B%0A%20%20%20%20const%20d4%20%3D%20_vac2.dot%28_vbp2%29%3B%0A%20%20%20%20if%20%28d3%20%3E%3D%200%20%26%26%20d4%20%3C%3D%20d3%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28b%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20vc%20%3D%20d1%20%2A%20d4%20-%20d3%20%2A%20d2%3B%0A%20%20%20%20if%20%28vc%20%3C%3D%200%20%26%26%20d1%20%3E%3D%200%20%26%26%20d3%20%3C%3D%200%29%20%7B%0A%20%20%20%20%20%20v%20%3D%20d1%20%2F%20%28d1%20-%20d3%29%3B%0A%20%20%20%20%20%20return%20target.copy%28a2%29.addScaledVector%28_vab2%2C%20v%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_vcp2.subVectors%28p%2C%20c2%29%3B%0A%20%20%20%20const%20d5%20%3D%20_vab2.dot%28_vcp2%29%3B%0A%20%20%20%20const%20d6%20%3D%20_vac2.dot%28_vcp2%29%3B%0A%20%20%20%20if%20%28d6%20%3E%3D%200%20%26%26%20d5%20%3C%3D%20d6%29%20%7B%0A%20%20%20%20%20%20return%20target.copy%28c2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20vb%20%3D%20d5%20%2A%20d2%20-%20d1%20%2A%20d6%3B%0A%20%20%20%20if%20%28vb%20%3C%3D%200%20%26%26%20d2%20%3E%3D%200%20%26%26%20d6%20%3C%3D%200%29%20%7B%0A%20%20%20%20%20%20w%20%3D%20d2%20%2F%20%28d2%20-%20d6%29%3B%0A%20%20%20%20%20%20return%20target.copy%28a2%29.addScaledVector%28_vac2%2C%20w%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20va%20%3D%20d3%20%2A%20d6%20-%20d5%20%2A%20d4%3B%0A%20%20%20%20if%20%28va%20%3C%3D%200%20%26%26%20d4%20-%20d3%20%3E%3D%200%20%26%26%20d5%20-%20d6%20%3E%3D%200%29%20%7B%0A%20%20%20%20%20%20_vbc2.subVectors%28c2%2C%20b%29%3B%0A%20%20%20%20%20%20w%20%3D%20%28d4%20-%20d3%29%20%2F%20%28d4%20-%20d3%20%2B%20%28d5%20-%20d6%29%29%3B%0A%20%20%20%20%20%20return%20target.copy%28b%29.addScaledVector%28_vbc2%2C%20w%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20denom%20%3D%201%20%2F%20%28va%20%2B%20vb%20%2B%20vc%29%3B%0A%20%20%20%20v%20%3D%20vb%20%2A%20denom%3B%0A%20%20%20%20w%20%3D%20vc%20%2A%20denom%3B%0A%20%20%20%20return%20target.copy%28a2%29.addScaledVector%28_vab2%2C%20v%29.addScaledVector%28_vac2%2C%20w%29%3B%0A%20%20%7D%0A%20%20equals%28triangle%29%20%7B%0A%20%20%20%20return%20triangle.a.equals%28this.a%29%20%26%26%20triangle.b.equals%28this.b%29%20%26%26%20triangle.c.equals%28this.c%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_colorKeywords2%20%3D%20%7B%0A%20%20%22aliceblue%22%3A%2015792383%2C%0A%20%20%22antiquewhite%22%3A%2016444375%2C%0A%20%20%22aqua%22%3A%2065535%2C%0A%20%20%22aquamarine%22%3A%208388564%2C%0A%20%20%22azure%22%3A%2015794175%2C%0A%20%20%22beige%22%3A%2016119260%2C%0A%20%20%22bisque%22%3A%2016770244%2C%0A%20%20%22black%22%3A%200%2C%0A%20%20%22blanchedalmond%22%3A%2016772045%2C%0A%20%20%22blue%22%3A%20255%2C%0A%20%20%22blueviolet%22%3A%209055202%2C%0A%20%20%22brown%22%3A%2010824234%2C%0A%20%20%22burlywood%22%3A%2014596231%2C%0A%20%20%22cadetblue%22%3A%206266528%2C%0A%20%20%22chartreuse%22%3A%208388352%2C%0A%20%20%22chocolate%22%3A%2013789470%2C%0A%20%20%22coral%22%3A%2016744272%2C%0A%20%20%22cornflowerblue%22%3A%206591981%2C%0A%20%20%22cornsilk%22%3A%2016775388%2C%0A%20%20%22crimson%22%3A%2014423100%2C%0A%20%20%22cyan%22%3A%2065535%2C%0A%20%20%22darkblue%22%3A%20139%2C%0A%20%20%22darkcyan%22%3A%2035723%2C%0A%20%20%22darkgoldenrod%22%3A%2012092939%2C%0A%20%20%22darkgray%22%3A%2011119017%2C%0A%20%20%22darkgreen%22%3A%2025600%2C%0A%20%20%22darkgrey%22%3A%2011119017%2C%0A%20%20%22darkkhaki%22%3A%2012433259%2C%0A%20%20%22darkmagenta%22%3A%209109643%2C%0A%20%20%22darkolivegreen%22%3A%205597999%2C%0A%20%20%22darkorange%22%3A%2016747520%2C%0A%20%20%22darkorchid%22%3A%2010040012%2C%0A%20%20%22darkred%22%3A%209109504%2C%0A%20%20%22darksalmon%22%3A%2015308410%2C%0A%20%20%22darkseagreen%22%3A%209419919%2C%0A%20%20%22darkslateblue%22%3A%204734347%2C%0A%20%20%22darkslategray%22%3A%203100495%2C%0A%20%20%22darkslategrey%22%3A%203100495%2C%0A%20%20%22darkturquoise%22%3A%2052945%2C%0A%20%20%22darkviolet%22%3A%209699539%2C%0A%20%20%22deeppink%22%3A%2016716947%2C%0A%20%20%22deepskyblue%22%3A%2049151%2C%0A%20%20%22dimgray%22%3A%206908265%2C%0A%20%20%22dimgrey%22%3A%206908265%2C%0A%20%20%22dodgerblue%22%3A%202003199%2C%0A%20%20%22firebrick%22%3A%2011674146%2C%0A%20%20%22floralwhite%22%3A%2016775920%2C%0A%20%20%22forestgreen%22%3A%202263842%2C%0A%20%20%22fuchsia%22%3A%2016711935%2C%0A%20%20%22gainsboro%22%3A%2014474460%2C%0A%20%20%22ghostwhite%22%3A%2016316671%2C%0A%20%20%22gold%22%3A%2016766720%2C%0A%20%20%22goldenrod%22%3A%2014329120%2C%0A%20%20%22gray%22%3A%208421504%2C%0A%20%20%22green%22%3A%2032768%2C%0A%20%20%22greenyellow%22%3A%2011403055%2C%0A%20%20%22grey%22%3A%208421504%2C%0A%20%20%22honeydew%22%3A%2015794160%2C%0A%20%20%22hotpink%22%3A%2016738740%2C%0A%20%20%22indianred%22%3A%2013458524%2C%0A%20%20%22indigo%22%3A%204915330%2C%0A%20%20%22ivory%22%3A%2016777200%2C%0A%20%20%22khaki%22%3A%2015787660%2C%0A%20%20%22lavender%22%3A%2015132410%2C%0A%20%20%22lavenderblush%22%3A%2016773365%2C%0A%20%20%22lawngreen%22%3A%208190976%2C%0A%20%20%22lemonchiffon%22%3A%2016775885%2C%0A%20%20%22lightblue%22%3A%2011393254%2C%0A%20%20%22lightcoral%22%3A%2015761536%2C%0A%20%20%22lightcyan%22%3A%2014745599%2C%0A%20%20%22lightgoldenrodyellow%22%3A%2016448210%2C%0A%20%20%22lightgray%22%3A%2013882323%2C%0A%20%20%22lightgreen%22%3A%209498256%2C%0A%20%20%22lightgrey%22%3A%2013882323%2C%0A%20%20%22lightpink%22%3A%2016758465%2C%0A%20%20%22lightsalmon%22%3A%2016752762%2C%0A%20%20%22lightseagreen%22%3A%202142890%2C%0A%20%20%22lightskyblue%22%3A%208900346%2C%0A%20%20%22lightslategray%22%3A%207833753%2C%0A%20%20%22lightslategrey%22%3A%207833753%2C%0A%20%20%22lightsteelblue%22%3A%2011584734%2C%0A%20%20%22lightyellow%22%3A%2016777184%2C%0A%20%20%22lime%22%3A%2065280%2C%0A%20%20%22limegreen%22%3A%203329330%2C%0A%20%20%22linen%22%3A%2016445670%2C%0A%20%20%22magenta%22%3A%2016711935%2C%0A%20%20%22maroon%22%3A%208388608%2C%0A%20%20%22mediumaquamarine%22%3A%206737322%2C%0A%20%20%22mediumblue%22%3A%20205%2C%0A%20%20%22mediumorchid%22%3A%2012211667%2C%0A%20%20%22mediumpurple%22%3A%209662683%2C%0A%20%20%22mediumseagreen%22%3A%203978097%2C%0A%20%20%22mediumslateblue%22%3A%208087790%2C%0A%20%20%22mediumspringgreen%22%3A%2064154%2C%0A%20%20%22mediumturquoise%22%3A%204772300%2C%0A%20%20%22mediumvioletred%22%3A%2013047173%2C%0A%20%20%22midnightblue%22%3A%201644912%2C%0A%20%20%22mintcream%22%3A%2016121850%2C%0A%20%20%22mistyrose%22%3A%2016770273%2C%0A%20%20%22moccasin%22%3A%2016770229%2C%0A%20%20%22navajowhite%22%3A%2016768685%2C%0A%20%20%22navy%22%3A%20128%2C%0A%20%20%22oldlace%22%3A%2016643558%2C%0A%20%20%22olive%22%3A%208421376%2C%0A%20%20%22olivedrab%22%3A%207048739%2C%0A%20%20%22orange%22%3A%2016753920%2C%0A%20%20%22orangered%22%3A%2016729344%2C%0A%20%20%22orchid%22%3A%2014315734%2C%0A%20%20%22palegoldenrod%22%3A%2015657130%2C%0A%20%20%22palegreen%22%3A%2010025880%2C%0A%20%20%22paleturquoise%22%3A%2011529966%2C%0A%20%20%22palevioletred%22%3A%2014381203%2C%0A%20%20%22papayawhip%22%3A%2016773077%2C%0A%20%20%22peachpuff%22%3A%2016767673%2C%0A%20%20%22peru%22%3A%2013468991%2C%0A%20%20%22pink%22%3A%2016761035%2C%0A%20%20%22plum%22%3A%2014524637%2C%0A%20%20%22powderblue%22%3A%2011591910%2C%0A%20%20%22purple%22%3A%208388736%2C%0A%20%20%22rebeccapurple%22%3A%206697881%2C%0A%20%20%22red%22%3A%2016711680%2C%0A%20%20%22rosybrown%22%3A%2012357519%2C%0A%20%20%22royalblue%22%3A%204286945%2C%0A%20%20%22saddlebrown%22%3A%209127187%2C%0A%20%20%22salmon%22%3A%2016416882%2C%0A%20%20%22sandybrown%22%3A%2016032864%2C%0A%20%20%22seagreen%22%3A%203050327%2C%0A%20%20%22seashell%22%3A%2016774638%2C%0A%20%20%22sienna%22%3A%2010506797%2C%0A%20%20%22silver%22%3A%2012632256%2C%0A%20%20%22skyblue%22%3A%208900331%2C%0A%20%20%22slateblue%22%3A%206970061%2C%0A%20%20%22slategray%22%3A%207372944%2C%0A%20%20%22slategrey%22%3A%207372944%2C%0A%20%20%22snow%22%3A%2016775930%2C%0A%20%20%22springgreen%22%3A%2065407%2C%0A%20%20%22steelblue%22%3A%204620980%2C%0A%20%20%22tan%22%3A%2013808780%2C%0A%20%20%22teal%22%3A%2032896%2C%0A%20%20%22thistle%22%3A%2014204888%2C%0A%20%20%22tomato%22%3A%2016737095%2C%0A%20%20%22turquoise%22%3A%204251856%2C%0A%20%20%22violet%22%3A%2015631086%2C%0A%20%20%22wheat%22%3A%2016113331%2C%0A%20%20%22white%22%3A%2016777215%2C%0A%20%20%22whitesmoke%22%3A%2016119285%2C%0A%20%20%22yellow%22%3A%2016776960%2C%0A%20%20%22yellowgreen%22%3A%2010145074%0A%7D%3B%0Avar%20_hslA2%20%3D%20%7B%20h%3A%200%2C%20s%3A%200%2C%20l%3A%200%20%7D%3B%0Avar%20_hslB2%20%3D%20%7B%20h%3A%200%2C%20s%3A%200%2C%20l%3A%200%20%7D%3B%0Afunction%20hue2rgb2%28p%2C%20q%2C%20t%29%20%7B%0A%20%20if%20%28t%20%3C%200%29%20t%20%2B%3D%201%3B%0A%20%20if%20%28t%20%3E%201%29%20t%20-%3D%201%3B%0A%20%20if%20%28t%20%3C%201%20%2F%206%29%20return%20p%20%2B%20%28q%20-%20p%29%20%2A%206%20%2A%20t%3B%0A%20%20if%20%28t%20%3C%201%20%2F%202%29%20return%20q%3B%0A%20%20if%20%28t%20%3C%202%20%2F%203%29%20return%20p%20%2B%20%28q%20-%20p%29%20%2A%206%20%2A%20%282%20%2F%203%20-%20t%29%3B%0A%20%20return%20p%3B%0A%7D%0Avar%20Color2%20%3D%20class%20%7B%0A%20%20constructor%28r%2C%20g%2C%20b%29%20%7B%0A%20%20%20%20this.isColor%20%3D%20true%3B%0A%20%20%20%20this.r%20%3D%201%3B%0A%20%20%20%20this.g%20%3D%201%3B%0A%20%20%20%20this.b%20%3D%201%3B%0A%20%20%20%20return%20this.set%28r%2C%20g%2C%20b%29%3B%0A%20%20%7D%0A%20%20set%28r%2C%20g%2C%20b%29%20%7B%0A%20%20%20%20if%20%28g%20%3D%3D%3D%20void%200%20%26%26%20b%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20value%20%3D%20r%3B%0A%20%20%20%20%20%20if%20%28value%20%26%26%20value.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20this.copy%28value%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20value%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20%20%20%20%20this.setHex%28value%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20value%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20%20%20%20%20this.setStyle%28value%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.setRGB%28r%2C%20g%2C%20b%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setScalar%28scalar%29%20%7B%0A%20%20%20%20this.r%20%3D%20scalar%3B%0A%20%20%20%20this.g%20%3D%20scalar%3B%0A%20%20%20%20this.b%20%3D%20scalar%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setHex%28hex%2C%20colorSpace%20%3D%20SRGBColorSpace2%29%20%7B%0A%20%20%20%20hex%20%3D%20Math.floor%28hex%29%3B%0A%20%20%20%20this.r%20%3D%20%28hex%20%3E%3E%2016%20%26%20255%29%20%2F%20255%3B%0A%20%20%20%20this.g%20%3D%20%28hex%20%3E%3E%208%20%26%20255%29%20%2F%20255%3B%0A%20%20%20%20this.b%20%3D%20%28hex%20%26%20255%29%20%2F%20255%3B%0A%20%20%20%20ColorManagement2.toWorkingColorSpace%28this%2C%20colorSpace%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setRGB%28r%2C%20g%2C%20b%2C%20colorSpace%20%3D%20ColorManagement2.workingColorSpace%29%20%7B%0A%20%20%20%20this.r%20%3D%20r%3B%0A%20%20%20%20this.g%20%3D%20g%3B%0A%20%20%20%20this.b%20%3D%20b%3B%0A%20%20%20%20ColorManagement2.toWorkingColorSpace%28this%2C%20colorSpace%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setHSL%28h%2C%20s%2C%20l%2C%20colorSpace%20%3D%20ColorManagement2.workingColorSpace%29%20%7B%0A%20%20%20%20h%20%3D%20euclideanModulo2%28h%2C%201%29%3B%0A%20%20%20%20s%20%3D%20clamp%241%28s%2C%200%2C%201%29%3B%0A%20%20%20%20l%20%3D%20clamp%241%28l%2C%200%2C%201%29%3B%0A%20%20%20%20if%20%28s%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20this.r%20%3D%20this.g%20%3D%20this.b%20%3D%20l%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20p%20%3D%20l%20%3C%3D%200.5%20%3F%20l%20%2A%20%281%20%2B%20s%29%20%3A%20l%20%2B%20s%20-%20l%20%2A%20s%3B%0A%20%20%20%20%20%20const%20q%20%3D%202%20%2A%20l%20-%20p%3B%0A%20%20%20%20%20%20this.r%20%3D%20hue2rgb2%28q%2C%20p%2C%20h%20%2B%201%20%2F%203%29%3B%0A%20%20%20%20%20%20this.g%20%3D%20hue2rgb2%28q%2C%20p%2C%20h%29%3B%0A%20%20%20%20%20%20this.b%20%3D%20hue2rgb2%28q%2C%20p%2C%20h%20-%201%20%2F%203%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20ColorManagement2.toWorkingColorSpace%28this%2C%20colorSpace%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setStyle%28style%2C%20colorSpace%20%3D%20SRGBColorSpace2%29%20%7B%0A%20%20%20%20function%20handleAlpha%28string%29%20%7B%0A%20%20%20%20%20%20if%20%28string%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20%20%20if%20%28parseFloat%28string%29%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.Color%3A%20Alpha%20component%20of%20%22%20%2B%20style%20%2B%20%22%20will%20be%20ignored.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20let%20m2%3B%0A%20%20%20%20if%20%28m2%20%3D%20%2F%5E%28%5Cw%2B%29%5C%28%28%5B%5E%5C%29%5D%2A%29%5C%29%2F.exec%28style%29%29%20%7B%0A%20%20%20%20%20%20let%20color2%3B%0A%20%20%20%20%20%20const%20name%20%3D%20m2%5B1%5D%3B%0A%20%20%20%20%20%20const%20components%20%3D%20m2%5B2%5D%3B%0A%20%20%20%20%20%20switch%20%28name%29%20%7B%0A%20%20%20%20%20%20%20%20case%20%22rgb%22%3A%0A%20%20%20%20%20%20%20%20case%20%22rgba%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28color2%20%3D%20%2F%5E%5Cs%2A%28%5Cd%2B%29%5Cs%2A%2C%5Cs%2A%28%5Cd%2B%29%5Cs%2A%2C%5Cs%2A%28%5Cd%2B%29%5Cs%2A%28%3F%3A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5Cs%2A%29%3F%24%2F.exec%28components%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20handleAlpha%28color2%5B4%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.setRGB%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28255%2C%20parseInt%28color2%5B1%5D%2C%2010%29%29%20%2F%20255%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28255%2C%20parseInt%28color2%5B2%5D%2C%2010%29%29%20%2F%20255%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28255%2C%20parseInt%28color2%5B3%5D%2C%2010%29%29%20%2F%20255%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorSpace%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28color2%20%3D%20%2F%5E%5Cs%2A%28%5Cd%2B%29%5C%25%5Cs%2A%2C%5Cs%2A%28%5Cd%2B%29%5C%25%5Cs%2A%2C%5Cs%2A%28%5Cd%2B%29%5C%25%5Cs%2A%28%3F%3A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5Cs%2A%29%3F%24%2F.exec%28components%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20handleAlpha%28color2%5B4%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.setRGB%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28100%2C%20parseInt%28color2%5B1%5D%2C%2010%29%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28100%2C%20parseInt%28color2%5B2%5D%2C%2010%29%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Math.min%28100%2C%20parseInt%28color2%5B3%5D%2C%2010%29%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorSpace%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22hsl%22%3A%0A%20%20%20%20%20%20%20%20case%20%22hsla%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28color2%20%3D%20%2F%5E%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5Cs%2A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5C%25%5Cs%2A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5C%25%5Cs%2A%28%3F%3A%2C%5Cs%2A%28%5Cd%2A%5C.%3F%5Cd%2B%29%5Cs%2A%29%3F%24%2F.exec%28components%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20handleAlpha%28color2%5B4%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20this.setHSL%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20parseFloat%28color2%5B1%5D%29%20%2F%20360%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20parseFloat%28color2%5B2%5D%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20parseFloat%28color2%5B3%5D%29%20%2F%20100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorSpace%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.Color%3A%20Unknown%20color%20model%20%22%20%2B%20style%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28m2%20%3D%20%2F%5E%5C%23%28%5BA-Fa-f%5Cd%5D%2B%29%24%2F.exec%28style%29%29%20%7B%0A%20%20%20%20%20%20const%20hex%20%3D%20m2%5B1%5D%3B%0A%20%20%20%20%20%20const%20size%20%3D%20hex.length%3B%0A%20%20%20%20%20%20if%20%28size%20%3D%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this.setRGB%28%0A%20%20%20%20%20%20%20%20%20%20parseInt%28hex.charAt%280%29%2C%2016%29%20%2F%2015%2C%0A%20%20%20%20%20%20%20%20%20%20parseInt%28hex.charAt%281%29%2C%2016%29%20%2F%2015%2C%0A%20%20%20%20%20%20%20%20%20%20parseInt%28hex.charAt%282%29%2C%2016%29%20%2F%2015%2C%0A%20%20%20%20%20%20%20%20%20%20colorSpace%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28size%20%3D%3D%3D%206%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this.setHex%28parseInt%28hex%2C%2016%29%2C%20colorSpace%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.Color%3A%20Invalid%20hex%20color%20%22%20%2B%20style%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28style%20%26%26%20style.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20return%20this.setColorName%28style%2C%20colorSpace%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setColorName%28style%2C%20colorSpace%20%3D%20SRGBColorSpace2%29%20%7B%0A%20%20%20%20const%20hex%20%3D%20_colorKeywords2%5Bstyle.toLowerCase%28%29%5D%3B%0A%20%20%20%20if%20%28hex%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.setHex%28hex%2C%20colorSpace%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.Color%3A%20Unknown%20color%20%22%20%2B%20style%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.r%2C%20this.g%2C%20this.b%29%3B%0A%20%20%7D%0A%20%20copy%28color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20color2.r%3B%0A%20%20%20%20this.g%20%3D%20color2.g%3B%0A%20%20%20%20this.b%20%3D%20color2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copySRGBToLinear%28color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20SRGBToLinear2%28color2.r%29%3B%0A%20%20%20%20this.g%20%3D%20SRGBToLinear2%28color2.g%29%3B%0A%20%20%20%20this.b%20%3D%20SRGBToLinear2%28color2.b%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copyLinearToSRGB%28color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20LinearToSRGB2%28color2.r%29%3B%0A%20%20%20%20this.g%20%3D%20LinearToSRGB2%28color2.g%29%3B%0A%20%20%20%20this.b%20%3D%20LinearToSRGB2%28color2.b%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20convertSRGBToLinear%28%29%20%7B%0A%20%20%20%20this.copySRGBToLinear%28this%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20convertLinearToSRGB%28%29%20%7B%0A%20%20%20%20this.copyLinearToSRGB%28this%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getHex%28colorSpace%20%3D%20SRGBColorSpace2%29%20%7B%0A%20%20%20%20ColorManagement2.fromWorkingColorSpace%28_color2.copy%28this%29%2C%20colorSpace%29%3B%0A%20%20%20%20return%20Math.round%28clamp%241%28_color2.r%20%2A%20255%2C%200%2C%20255%29%29%20%2A%2065536%20%2B%20Math.round%28clamp%241%28_color2.g%20%2A%20255%2C%200%2C%20255%29%29%20%2A%20256%20%2B%20Math.round%28clamp%241%28_color2.b%20%2A%20255%2C%200%2C%20255%29%29%3B%0A%20%20%7D%0A%20%20getHexString%28colorSpace%20%3D%20SRGBColorSpace2%29%20%7B%0A%20%20%20%20return%20%28%22000000%22%20%2B%20this.getHex%28colorSpace%29.toString%2816%29%29.slice%28-6%29%3B%0A%20%20%7D%0A%20%20getHSL%28target%2C%20colorSpace%20%3D%20ColorManagement2.workingColorSpace%29%20%7B%0A%20%20%20%20ColorManagement2.fromWorkingColorSpace%28_color2.copy%28this%29%2C%20colorSpace%29%3B%0A%20%20%20%20const%20r%20%3D%20_color2.r%2C%20g%20%3D%20_color2.g%2C%20b%20%3D%20_color2.b%3B%0A%20%20%20%20const%20max2%20%3D%20Math.max%28r%2C%20g%2C%20b%29%3B%0A%20%20%20%20const%20min2%20%3D%20Math.min%28r%2C%20g%2C%20b%29%3B%0A%20%20%20%20let%20hue%2C%20saturation%3B%0A%20%20%20%20const%20lightness%20%3D%20%28min2%20%2B%20max2%29%20%2F%202%3B%0A%20%20%20%20if%20%28min2%20%3D%3D%3D%20max2%29%20%7B%0A%20%20%20%20%20%20hue%20%3D%200%3B%0A%20%20%20%20%20%20saturation%20%3D%200%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20delta%20%3D%20max2%20-%20min2%3B%0A%20%20%20%20%20%20saturation%20%3D%20lightness%20%3C%3D%200.5%20%3F%20delta%20%2F%20%28max2%20%2B%20min2%29%20%3A%20delta%20%2F%20%282%20-%20max2%20-%20min2%29%3B%0A%20%20%20%20%20%20switch%20%28max2%29%20%7B%0A%20%20%20%20%20%20%20%20case%20r%3A%0A%20%20%20%20%20%20%20%20%20%20hue%20%3D%20%28g%20-%20b%29%20%2F%20delta%20%2B%20%28g%20%3C%20b%20%3F%206%20%3A%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20g%3A%0A%20%20%20%20%20%20%20%20%20%20hue%20%3D%20%28b%20-%20r%29%20%2F%20delta%20%2B%202%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20b%3A%0A%20%20%20%20%20%20%20%20%20%20hue%20%3D%20%28r%20-%20g%29%20%2F%20delta%20%2B%204%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20hue%20%2F%3D%206%3B%0A%20%20%20%20%7D%0A%20%20%20%20target.h%20%3D%20hue%3B%0A%20%20%20%20target.s%20%3D%20saturation%3B%0A%20%20%20%20target.l%20%3D%20lightness%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getRGB%28target%2C%20colorSpace%20%3D%20ColorManagement2.workingColorSpace%29%20%7B%0A%20%20%20%20ColorManagement2.fromWorkingColorSpace%28_color2.copy%28this%29%2C%20colorSpace%29%3B%0A%20%20%20%20target.r%20%3D%20_color2.r%3B%0A%20%20%20%20target.g%20%3D%20_color2.g%3B%0A%20%20%20%20target.b%20%3D%20_color2.b%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getStyle%28colorSpace%20%3D%20SRGBColorSpace2%29%20%7B%0A%20%20%20%20ColorManagement2.fromWorkingColorSpace%28_color2.copy%28this%29%2C%20colorSpace%29%3B%0A%20%20%20%20const%20r%20%3D%20_color2.r%2C%20g%20%3D%20_color2.g%2C%20b%20%3D%20_color2.b%3B%0A%20%20%20%20if%20%28colorSpace%20%21%3D%3D%20SRGBColorSpace2%29%20%7B%0A%20%20%20%20%20%20return%20%60color%28%24%7BcolorSpace%7D%20%24%7Br.toFixed%283%29%7D%20%24%7Bg.toFixed%283%29%7D%20%24%7Bb.toFixed%283%29%7D%29%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%60rgb%28%24%7BMath.round%28r%20%2A%20255%29%7D%2C%24%7BMath.round%28g%20%2A%20255%29%7D%2C%24%7BMath.round%28b%20%2A%20255%29%7D%29%60%3B%0A%20%20%7D%0A%20%20offsetHSL%28h%2C%20s%2C%20l%29%20%7B%0A%20%20%20%20this.getHSL%28_hslA2%29%3B%0A%20%20%20%20return%20this.setHSL%28_hslA2.h%20%2B%20h%2C%20_hslA2.s%20%2B%20s%2C%20_hslA2.l%20%2B%20l%29%3B%0A%20%20%7D%0A%20%20add%28color2%29%20%7B%0A%20%20%20%20this.r%20%2B%3D%20color2.r%3B%0A%20%20%20%20this.g%20%2B%3D%20color2.g%3B%0A%20%20%20%20this.b%20%2B%3D%20color2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addColors%28color1%2C%20color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20color1.r%20%2B%20color2.r%3B%0A%20%20%20%20this.g%20%3D%20color1.g%20%2B%20color2.g%3B%0A%20%20%20%20this.b%20%3D%20color1.b%20%2B%20color2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScalar%28s%29%20%7B%0A%20%20%20%20this.r%20%2B%3D%20s%3B%0A%20%20%20%20this.g%20%2B%3D%20s%3B%0A%20%20%20%20this.b%20%2B%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20sub%28color2%29%20%7B%0A%20%20%20%20this.r%20%3D%20Math.max%280%2C%20this.r%20-%20color2.r%29%3B%0A%20%20%20%20this.g%20%3D%20Math.max%280%2C%20this.g%20-%20color2.g%29%3B%0A%20%20%20%20this.b%20%3D%20Math.max%280%2C%20this.b%20-%20color2.b%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiply%28color2%29%20%7B%0A%20%20%20%20this.r%20%2A%3D%20color2.r%3B%0A%20%20%20%20this.g%20%2A%3D%20color2.g%3B%0A%20%20%20%20this.b%20%2A%3D%20color2.b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20multiplyScalar%28s%29%20%7B%0A%20%20%20%20this.r%20%2A%3D%20s%3B%0A%20%20%20%20this.g%20%2A%3D%20s%3B%0A%20%20%20%20this.b%20%2A%3D%20s%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerp%28color2%2C%20alpha%29%20%7B%0A%20%20%20%20this.r%20%2B%3D%20%28color2.r%20-%20this.r%29%20%2A%20alpha%3B%0A%20%20%20%20this.g%20%2B%3D%20%28color2.g%20-%20this.g%29%20%2A%20alpha%3B%0A%20%20%20%20this.b%20%2B%3D%20%28color2.b%20-%20this.b%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpColors%28color1%2C%20color2%2C%20alpha%29%20%7B%0A%20%20%20%20this.r%20%3D%20color1.r%20%2B%20%28color2.r%20-%20color1.r%29%20%2A%20alpha%3B%0A%20%20%20%20this.g%20%3D%20color1.g%20%2B%20%28color2.g%20-%20color1.g%29%20%2A%20alpha%3B%0A%20%20%20%20this.b%20%3D%20color1.b%20%2B%20%28color2.b%20-%20color1.b%29%20%2A%20alpha%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerpHSL%28color2%2C%20alpha%29%20%7B%0A%20%20%20%20this.getHSL%28_hslA2%29%3B%0A%20%20%20%20color2.getHSL%28_hslB2%29%3B%0A%20%20%20%20const%20h%20%3D%20lerp2%28_hslA2.h%2C%20_hslB2.h%2C%20alpha%29%3B%0A%20%20%20%20const%20s%20%3D%20lerp2%28_hslA2.s%2C%20_hslB2.s%2C%20alpha%29%3B%0A%20%20%20%20const%20l%20%3D%20lerp2%28_hslA2.l%2C%20_hslB2.l%2C%20alpha%29%3B%0A%20%20%20%20this.setHSL%28h%2C%20s%2C%20l%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromVector3%28v%29%20%7B%0A%20%20%20%20this.r%20%3D%20v.x%3B%0A%20%20%20%20this.g%20%3D%20v.y%3B%0A%20%20%20%20this.b%20%3D%20v.z%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix3%28m2%29%20%7B%0A%20%20%20%20const%20r%20%3D%20this.r%2C%20g%20%3D%20this.g%2C%20b%20%3D%20this.b%3B%0A%20%20%20%20const%20e%20%3D%20m2.elements%3B%0A%20%20%20%20this.r%20%3D%20e%5B0%5D%20%2A%20r%20%2B%20e%5B3%5D%20%2A%20g%20%2B%20e%5B6%5D%20%2A%20b%3B%0A%20%20%20%20this.g%20%3D%20e%5B1%5D%20%2A%20r%20%2B%20e%5B4%5D%20%2A%20g%20%2B%20e%5B7%5D%20%2A%20b%3B%0A%20%20%20%20this.b%20%3D%20e%5B2%5D%20%2A%20r%20%2B%20e%5B5%5D%20%2A%20g%20%2B%20e%5B8%5D%20%2A%20b%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28c2%29%20%7B%0A%20%20%20%20return%20c2.r%20%3D%3D%3D%20this.r%20%26%26%20c2.g%20%3D%3D%3D%20this.g%20%26%26%20c2.b%20%3D%3D%3D%20this.b%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.r%20%3D%20array%5Boffset%5D%3B%0A%20%20%20%20this.g%20%3D%20array%5Boffset%20%2B%201%5D%3B%0A%20%20%20%20this.b%20%3D%20array%5Boffset%20%2B%202%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20array%5Boffset%5D%20%3D%20this.r%3B%0A%20%20%20%20array%5Boffset%20%2B%201%5D%20%3D%20this.g%3B%0A%20%20%20%20array%5Boffset%20%2B%202%5D%20%3D%20this.b%3B%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20fromBufferAttribute%28attribute2%2C%20index5%29%20%7B%0A%20%20%20%20this.r%20%3D%20attribute2.getX%28index5%29%3B%0A%20%20%20%20this.g%20%3D%20attribute2.getY%28index5%29%3B%0A%20%20%20%20this.b%20%3D%20attribute2.getZ%28index5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20return%20this.getHex%28%29%3B%0A%20%20%7D%0A%20%20%2A%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20yield%20this.r%3B%0A%20%20%20%20yield%20this.g%3B%0A%20%20%20%20yield%20this.b%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_color2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color2%28%29%3B%0AColor2.NAMES%20%3D%20_colorKeywords2%3B%0Avar%20_materialId2%20%3D%200%3B%0Avar%20Material2%20%3D%20class%20extends%20EventDispatcher2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22Material%22%3B%0A%20%20%7D%0A%20%20get%20type%28%29%20%7B%0A%20%20%20%20return%20this.constructor.type%3B%0A%20%20%7D%0A%20%20set%20type%28_value%29%20%7B%0A%20%20%7D%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMaterial%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_materialId2%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID2%28%29%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.blending%20%3D%20NormalBlending2%3B%0A%20%20%20%20this.side%20%3D%20FrontSide2%3B%0A%20%20%20%20this.vertexColors%20%3D%20false%3B%0A%20%20%20%20this.opacity%20%3D%201%3B%0A%20%20%20%20this.transparent%20%3D%20false%3B%0A%20%20%20%20this.alphaHash%20%3D%20false%3B%0A%20%20%20%20this.blendSrc%20%3D%20SrcAlphaFactor2%3B%0A%20%20%20%20this.blendDst%20%3D%20OneMinusSrcAlphaFactor2%3B%0A%20%20%20%20this.blendEquation%20%3D%20AddEquation2%3B%0A%20%20%20%20this.blendSrcAlpha%20%3D%20null%3B%0A%20%20%20%20this.blendDstAlpha%20%3D%20null%3B%0A%20%20%20%20this.blendEquationAlpha%20%3D%20null%3B%0A%20%20%20%20this.blendColor%20%3D%20new%20Color2%280%2C%200%2C%200%29%3B%0A%20%20%20%20this.blendAlpha%20%3D%200%3B%0A%20%20%20%20this.depthFunc%20%3D%20LessEqualDepth2%3B%0A%20%20%20%20this.depthTest%20%3D%20true%3B%0A%20%20%20%20this.depthWrite%20%3D%20true%3B%0A%20%20%20%20this.stencilWriteMask%20%3D%20255%3B%0A%20%20%20%20this.stencilFunc%20%3D%20AlwaysStencilFunc2%3B%0A%20%20%20%20this.stencilRef%20%3D%200%3B%0A%20%20%20%20this.stencilFuncMask%20%3D%20255%3B%0A%20%20%20%20this.stencilFail%20%3D%20KeepStencilOp2%3B%0A%20%20%20%20this.stencilZFail%20%3D%20KeepStencilOp2%3B%0A%20%20%20%20this.stencilZPass%20%3D%20KeepStencilOp2%3B%0A%20%20%20%20this.stencilWrite%20%3D%20false%3B%0A%20%20%20%20this.clippingPlanes%20%3D%20null%3B%0A%20%20%20%20this.clipIntersection%20%3D%20false%3B%0A%20%20%20%20this.clipShadows%20%3D%20false%3B%0A%20%20%20%20this.shadowSide%20%3D%20null%3B%0A%20%20%20%20this.colorWrite%20%3D%20true%3B%0A%20%20%20%20this.precision%20%3D%20null%3B%0A%20%20%20%20this.polygonOffset%20%3D%20false%3B%0A%20%20%20%20this.polygonOffsetFactor%20%3D%200%3B%0A%20%20%20%20this.polygonOffsetUnits%20%3D%200%3B%0A%20%20%20%20this.dithering%20%3D%20false%3B%0A%20%20%20%20this.alphaToCoverage%20%3D%20false%3B%0A%20%20%20%20this.premultipliedAlpha%20%3D%20false%3B%0A%20%20%20%20this.forceSinglePass%20%3D%20false%3B%0A%20%20%20%20this.visible%20%3D%20true%3B%0A%20%20%20%20this.toneMapped%20%3D%20true%3B%0A%20%20%20%20this.userData%20%3D%20%7B%7D%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%20%20this._alphaTest%20%3D%200%3B%0A%20%20%7D%0A%20%20get%20alphaTest%28%29%20%7B%0A%20%20%20%20return%20this._alphaTest%3B%0A%20%20%7D%0A%20%20set%20alphaTest%28value%29%20%7B%0A%20%20%20%20if%20%28this._alphaTest%20%3E%200%20%21%3D%3D%20value%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._alphaTest%20%3D%20value%3B%0A%20%20%7D%0A%20%20%2F%2F%20onBeforeRender%20and%20onBeforeCompile%20only%20supported%20in%20WebGLRenderer%0A%20%20onBeforeRender%28%29%20%7B%0A%20%20%7D%0A%20%20onBeforeCompile%28%29%20%7B%0A%20%20%7D%0A%20%20customProgramCacheKey%28%29%20%7B%0A%20%20%20%20return%20this.onBeforeCompile.toString%28%29%3B%0A%20%20%7D%0A%20%20setValues%28values%29%20%7B%0A%20%20%20%20if%20%28values%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20for%20%28const%20key%20in%20values%29%20%7B%0A%20%20%20%20%20%20const%20newValue%20%3D%20values%5Bkey%5D%3B%0A%20%20%20%20%20%20if%20%28newValue%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%60THREE.Material%3A%20parameter%20%27%24%7Bkey%7D%27%20has%20value%20of%20undefined.%60%29%3B%0A%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20currentValue%20%3D%20this%5Bkey%5D%3B%0A%20%20%20%20%20%20if%20%28currentValue%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%60THREE.Material%3A%20%27%24%7Bkey%7D%27%20is%20not%20a%20property%20of%20THREE.%24%7Bthis.type%7D.%60%29%3B%0A%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28currentValue%20%26%26%20currentValue.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20currentValue.set%28newValue%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28currentValue%20%26%26%20currentValue.isVector3%20%26%26%20%28newValue%20%26%26%20newValue.isVector3%29%29%20%7B%0A%20%20%20%20%20%20%20%20currentValue.copy%28newValue%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this%5Bkey%5D%20%3D%20newValue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20isRootObject%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20if%20%28isRootObject%29%20%7B%0A%20%20%20%20%20%20meta%20%3D%20%7B%0A%20%20%20%20%20%20%20%20textures%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20images%3A%20%7B%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20data%20%3D%20%7B%0A%20%20%20%20%20%20metadata%3A%20%7B%0A%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22Material%22%2C%0A%20%20%20%20%20%20%20%20generator%3A%20%22Material.toJSON%22%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20data.uuid%20%3D%20this.uuid%3B%0A%20%20%20%20data.type%20%3D%20this.type%3B%0A%20%20%20%20if%20%28this.name%20%21%3D%3D%20%22%22%29%20data.name%20%3D%20this.name%3B%0A%20%20%20%20if%20%28this.color%20%26%26%20this.color.isColor%29%20data.color%20%3D%20this.color.getHex%28%29%3B%0A%20%20%20%20if%20%28this.roughness%20%21%3D%3D%20void%200%29%20data.roughness%20%3D%20this.roughness%3B%0A%20%20%20%20if%20%28this.metalness%20%21%3D%3D%20void%200%29%20data.metalness%20%3D%20this.metalness%3B%0A%20%20%20%20if%20%28this.sheen%20%21%3D%3D%20void%200%29%20data.sheen%20%3D%20this.sheen%3B%0A%20%20%20%20if%20%28this.sheenColor%20%26%26%20this.sheenColor.isColor%29%20data.sheenColor%20%3D%20this.sheenColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.sheenRoughness%20%21%3D%3D%20void%200%29%20data.sheenRoughness%20%3D%20this.sheenRoughness%3B%0A%20%20%20%20if%20%28this.emissive%20%26%26%20this.emissive.isColor%29%20data.emissive%20%3D%20this.emissive.getHex%28%29%3B%0A%20%20%20%20if%20%28this.emissiveIntensity%20%21%3D%3D%20void%200%20%26%26%20this.emissiveIntensity%20%21%3D%3D%201%29%20data.emissiveIntensity%20%3D%20this.emissiveIntensity%3B%0A%20%20%20%20if%20%28this.specular%20%26%26%20this.specular.isColor%29%20data.specular%20%3D%20this.specular.getHex%28%29%3B%0A%20%20%20%20if%20%28this.specularIntensity%20%21%3D%3D%20void%200%29%20data.specularIntensity%20%3D%20this.specularIntensity%3B%0A%20%20%20%20if%20%28this.specularColor%20%26%26%20this.specularColor.isColor%29%20data.specularColor%20%3D%20this.specularColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.shininess%20%21%3D%3D%20void%200%29%20data.shininess%20%3D%20this.shininess%3B%0A%20%20%20%20if%20%28this.clearcoat%20%21%3D%3D%20void%200%29%20data.clearcoat%20%3D%20this.clearcoat%3B%0A%20%20%20%20if%20%28this.clearcoatRoughness%20%21%3D%3D%20void%200%29%20data.clearcoatRoughness%20%3D%20this.clearcoatRoughness%3B%0A%20%20%20%20if%20%28this.clearcoatMap%20%26%26%20this.clearcoatMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.clearcoatMap%20%3D%20this.clearcoatMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearcoatRoughnessMap%20%26%26%20this.clearcoatRoughnessMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.clearcoatRoughnessMap%20%3D%20this.clearcoatRoughnessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearcoatNormalMap%20%26%26%20this.clearcoatNormalMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.clearcoatNormalMap%20%3D%20this.clearcoatNormalMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.clearcoatNormalScale%20%3D%20this.clearcoatNormalScale.toArray%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.dispersion%20%21%3D%3D%20void%200%29%20data.dispersion%20%3D%20this.dispersion%3B%0A%20%20%20%20if%20%28this.iridescence%20%21%3D%3D%20void%200%29%20data.iridescence%20%3D%20this.iridescence%3B%0A%20%20%20%20if%20%28this.iridescenceIOR%20%21%3D%3D%20void%200%29%20data.iridescenceIOR%20%3D%20this.iridescenceIOR%3B%0A%20%20%20%20if%20%28this.iridescenceThicknessRange%20%21%3D%3D%20void%200%29%20data.iridescenceThicknessRange%20%3D%20this.iridescenceThicknessRange%3B%0A%20%20%20%20if%20%28this.iridescenceMap%20%26%26%20this.iridescenceMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.iridescenceMap%20%3D%20this.iridescenceMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.iridescenceThicknessMap%20%26%26%20this.iridescenceThicknessMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.iridescenceThicknessMap%20%3D%20this.iridescenceThicknessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.anisotropy%20%21%3D%3D%20void%200%29%20data.anisotropy%20%3D%20this.anisotropy%3B%0A%20%20%20%20if%20%28this.anisotropyRotation%20%21%3D%3D%20void%200%29%20data.anisotropyRotation%20%3D%20this.anisotropyRotation%3B%0A%20%20%20%20if%20%28this.anisotropyMap%20%26%26%20this.anisotropyMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.anisotropyMap%20%3D%20this.anisotropyMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.map%20%26%26%20this.map.isTexture%29%20data.map%20%3D%20this.map.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.matcap%20%26%26%20this.matcap.isTexture%29%20data.matcap%20%3D%20this.matcap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.alphaMap%20%26%26%20this.alphaMap.isTexture%29%20data.alphaMap%20%3D%20this.alphaMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.lightMap%20%26%26%20this.lightMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.lightMap%20%3D%20this.lightMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.lightMapIntensity%20%3D%20this.lightMapIntensity%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.aoMap%20%26%26%20this.aoMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.aoMap%20%3D%20this.aoMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.aoMapIntensity%20%3D%20this.aoMapIntensity%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.bumpMap%20%26%26%20this.bumpMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.bumpMap%20%3D%20this.bumpMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.bumpScale%20%3D%20this.bumpScale%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.normalMap%20%26%26%20this.normalMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.normalMap%20%3D%20this.normalMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.normalMapType%20%3D%20this.normalMapType%3B%0A%20%20%20%20%20%20data.normalScale%20%3D%20this.normalScale.toArray%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.displacementMap%20%26%26%20this.displacementMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.displacementMap%20%3D%20this.displacementMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20data.displacementScale%20%3D%20this.displacementScale%3B%0A%20%20%20%20%20%20data.displacementBias%20%3D%20this.displacementBias%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.roughnessMap%20%26%26%20this.roughnessMap.isTexture%29%20data.roughnessMap%20%3D%20this.roughnessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.metalnessMap%20%26%26%20this.metalnessMap.isTexture%29%20data.metalnessMap%20%3D%20this.metalnessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.emissiveMap%20%26%26%20this.emissiveMap.isTexture%29%20data.emissiveMap%20%3D%20this.emissiveMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.specularMap%20%26%26%20this.specularMap.isTexture%29%20data.specularMap%20%3D%20this.specularMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.specularIntensityMap%20%26%26%20this.specularIntensityMap.isTexture%29%20data.specularIntensityMap%20%3D%20this.specularIntensityMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.specularColorMap%20%26%26%20this.specularColorMap.isTexture%29%20data.specularColorMap%20%3D%20this.specularColorMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.envMap%20%26%26%20this.envMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.envMap%20%3D%20this.envMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%20%20if%20%28this.combine%20%21%3D%3D%20void%200%29%20data.combine%20%3D%20this.combine%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.envMapRotation%20%21%3D%3D%20void%200%29%20data.envMapRotation%20%3D%20this.envMapRotation.toArray%28%29%3B%0A%20%20%20%20if%20%28this.envMapIntensity%20%21%3D%3D%20void%200%29%20data.envMapIntensity%20%3D%20this.envMapIntensity%3B%0A%20%20%20%20if%20%28this.reflectivity%20%21%3D%3D%20void%200%29%20data.reflectivity%20%3D%20this.reflectivity%3B%0A%20%20%20%20if%20%28this.refractionRatio%20%21%3D%3D%20void%200%29%20data.refractionRatio%20%3D%20this.refractionRatio%3B%0A%20%20%20%20if%20%28this.gradientMap%20%26%26%20this.gradientMap.isTexture%29%20%7B%0A%20%20%20%20%20%20data.gradientMap%20%3D%20this.gradientMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.transmission%20%21%3D%3D%20void%200%29%20data.transmission%20%3D%20this.transmission%3B%0A%20%20%20%20if%20%28this.transmissionMap%20%26%26%20this.transmissionMap.isTexture%29%20data.transmissionMap%20%3D%20this.transmissionMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.thickness%20%21%3D%3D%20void%200%29%20data.thickness%20%3D%20this.thickness%3B%0A%20%20%20%20if%20%28this.thicknessMap%20%26%26%20this.thicknessMap.isTexture%29%20data.thicknessMap%20%3D%20this.thicknessMap.toJSON%28meta%29.uuid%3B%0A%20%20%20%20if%20%28this.attenuationDistance%20%21%3D%3D%20void%200%20%26%26%20this.attenuationDistance%20%21%3D%3D%20Infinity%29%20data.attenuationDistance%20%3D%20this.attenuationDistance%3B%0A%20%20%20%20if%20%28this.attenuationColor%20%21%3D%3D%20void%200%29%20data.attenuationColor%20%3D%20this.attenuationColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.size%20%21%3D%3D%20void%200%29%20data.size%20%3D%20this.size%3B%0A%20%20%20%20if%20%28this.shadowSide%20%21%3D%3D%20null%29%20data.shadowSide%20%3D%20this.shadowSide%3B%0A%20%20%20%20if%20%28this.sizeAttenuation%20%21%3D%3D%20void%200%29%20data.sizeAttenuation%20%3D%20this.sizeAttenuation%3B%0A%20%20%20%20if%20%28this.blending%20%21%3D%3D%20NormalBlending2%29%20data.blending%20%3D%20this.blending%3B%0A%20%20%20%20if%20%28this.side%20%21%3D%3D%20FrontSide2%29%20data.side%20%3D%20this.side%3B%0A%20%20%20%20if%20%28this.vertexColors%20%3D%3D%3D%20true%29%20data.vertexColors%20%3D%20true%3B%0A%20%20%20%20if%20%28this.opacity%20%3C%201%29%20data.opacity%20%3D%20this.opacity%3B%0A%20%20%20%20if%20%28this.transparent%20%3D%3D%3D%20true%29%20data.transparent%20%3D%20true%3B%0A%20%20%20%20if%20%28this.blendSrc%20%21%3D%3D%20SrcAlphaFactor2%29%20data.blendSrc%20%3D%20this.blendSrc%3B%0A%20%20%20%20if%20%28this.blendDst%20%21%3D%3D%20OneMinusSrcAlphaFactor2%29%20data.blendDst%20%3D%20this.blendDst%3B%0A%20%20%20%20if%20%28this.blendEquation%20%21%3D%3D%20AddEquation2%29%20data.blendEquation%20%3D%20this.blendEquation%3B%0A%20%20%20%20if%20%28this.blendSrcAlpha%20%21%3D%3D%20null%29%20data.blendSrcAlpha%20%3D%20this.blendSrcAlpha%3B%0A%20%20%20%20if%20%28this.blendDstAlpha%20%21%3D%3D%20null%29%20data.blendDstAlpha%20%3D%20this.blendDstAlpha%3B%0A%20%20%20%20if%20%28this.blendEquationAlpha%20%21%3D%3D%20null%29%20data.blendEquationAlpha%20%3D%20this.blendEquationAlpha%3B%0A%20%20%20%20if%20%28this.blendColor%20%26%26%20this.blendColor.isColor%29%20data.blendColor%20%3D%20this.blendColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.blendAlpha%20%21%3D%3D%200%29%20data.blendAlpha%20%3D%20this.blendAlpha%3B%0A%20%20%20%20if%20%28this.depthFunc%20%21%3D%3D%20LessEqualDepth2%29%20data.depthFunc%20%3D%20this.depthFunc%3B%0A%20%20%20%20if%20%28this.depthTest%20%3D%3D%3D%20false%29%20data.depthTest%20%3D%20this.depthTest%3B%0A%20%20%20%20if%20%28this.depthWrite%20%3D%3D%3D%20false%29%20data.depthWrite%20%3D%20this.depthWrite%3B%0A%20%20%20%20if%20%28this.colorWrite%20%3D%3D%3D%20false%29%20data.colorWrite%20%3D%20this.colorWrite%3B%0A%20%20%20%20if%20%28this.stencilWriteMask%20%21%3D%3D%20255%29%20data.stencilWriteMask%20%3D%20this.stencilWriteMask%3B%0A%20%20%20%20if%20%28this.stencilFunc%20%21%3D%3D%20AlwaysStencilFunc2%29%20data.stencilFunc%20%3D%20this.stencilFunc%3B%0A%20%20%20%20if%20%28this.stencilRef%20%21%3D%3D%200%29%20data.stencilRef%20%3D%20this.stencilRef%3B%0A%20%20%20%20if%20%28this.stencilFuncMask%20%21%3D%3D%20255%29%20data.stencilFuncMask%20%3D%20this.stencilFuncMask%3B%0A%20%20%20%20if%20%28this.stencilFail%20%21%3D%3D%20KeepStencilOp2%29%20data.stencilFail%20%3D%20this.stencilFail%3B%0A%20%20%20%20if%20%28this.stencilZFail%20%21%3D%3D%20KeepStencilOp2%29%20data.stencilZFail%20%3D%20this.stencilZFail%3B%0A%20%20%20%20if%20%28this.stencilZPass%20%21%3D%3D%20KeepStencilOp2%29%20data.stencilZPass%20%3D%20this.stencilZPass%3B%0A%20%20%20%20if%20%28this.stencilWrite%20%3D%3D%3D%20true%29%20data.stencilWrite%20%3D%20this.stencilWrite%3B%0A%20%20%20%20if%20%28this.rotation%20%21%3D%3D%20void%200%20%26%26%20this.rotation%20%21%3D%3D%200%29%20data.rotation%20%3D%20this.rotation%3B%0A%20%20%20%20if%20%28this.polygonOffset%20%3D%3D%3D%20true%29%20data.polygonOffset%20%3D%20true%3B%0A%20%20%20%20if%20%28this.polygonOffsetFactor%20%21%3D%3D%200%29%20data.polygonOffsetFactor%20%3D%20this.polygonOffsetFactor%3B%0A%20%20%20%20if%20%28this.polygonOffsetUnits%20%21%3D%3D%200%29%20data.polygonOffsetUnits%20%3D%20this.polygonOffsetUnits%3B%0A%20%20%20%20if%20%28this.linewidth%20%21%3D%3D%20void%200%20%26%26%20this.linewidth%20%21%3D%3D%201%29%20data.linewidth%20%3D%20this.linewidth%3B%0A%20%20%20%20if%20%28this.dashSize%20%21%3D%3D%20void%200%29%20data.dashSize%20%3D%20this.dashSize%3B%0A%20%20%20%20if%20%28this.gapSize%20%21%3D%3D%20void%200%29%20data.gapSize%20%3D%20this.gapSize%3B%0A%20%20%20%20if%20%28this.scale%20%21%3D%3D%20void%200%29%20data.scale%20%3D%20this.scale%3B%0A%20%20%20%20if%20%28this.dithering%20%3D%3D%3D%20true%29%20data.dithering%20%3D%20true%3B%0A%20%20%20%20if%20%28this.alphaTest%20%3E%200%29%20data.alphaTest%20%3D%20this.alphaTest%3B%0A%20%20%20%20if%20%28this.alphaHash%20%3D%3D%3D%20true%29%20data.alphaHash%20%3D%20true%3B%0A%20%20%20%20if%20%28this.alphaToCoverage%20%3D%3D%3D%20true%29%20data.alphaToCoverage%20%3D%20true%3B%0A%20%20%20%20if%20%28this.premultipliedAlpha%20%3D%3D%3D%20true%29%20data.premultipliedAlpha%20%3D%20true%3B%0A%20%20%20%20if%20%28this.forceSinglePass%20%3D%3D%3D%20true%29%20data.forceSinglePass%20%3D%20true%3B%0A%20%20%20%20if%20%28this.wireframe%20%3D%3D%3D%20true%29%20data.wireframe%20%3D%20true%3B%0A%20%20%20%20if%20%28this.wireframeLinewidth%20%3E%201%29%20data.wireframeLinewidth%20%3D%20this.wireframeLinewidth%3B%0A%20%20%20%20if%20%28this.wireframeLinecap%20%21%3D%3D%20%22round%22%29%20data.wireframeLinecap%20%3D%20this.wireframeLinecap%3B%0A%20%20%20%20if%20%28this.wireframeLinejoin%20%21%3D%3D%20%22round%22%29%20data.wireframeLinejoin%20%3D%20this.wireframeLinejoin%3B%0A%20%20%20%20if%20%28this.flatShading%20%3D%3D%3D%20true%29%20data.flatShading%20%3D%20true%3B%0A%20%20%20%20if%20%28this.visible%20%3D%3D%3D%20false%29%20data.visible%20%3D%20false%3B%0A%20%20%20%20if%20%28this.toneMapped%20%3D%3D%3D%20false%29%20data.toneMapped%20%3D%20false%3B%0A%20%20%20%20if%20%28this.fog%20%3D%3D%3D%20false%29%20data.fog%20%3D%20false%3B%0A%20%20%20%20if%20%28Object.keys%28this.userData%29.length%20%3E%200%29%20data.userData%20%3D%20this.userData%3B%0A%20%20%20%20function%20extractFromCache%28cache2%29%20%7B%0A%20%20%20%20%20%20const%20values%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28const%20key%20in%20cache2%29%20%7B%0A%20%20%20%20%20%20%20%20const%20data2%20%3D%20cache2%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20delete%20data2.metadata%3B%0A%20%20%20%20%20%20%20%20values.push%28data2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20values%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isRootObject%29%20%7B%0A%20%20%20%20%20%20const%20textures%20%3D%20extractFromCache%28meta.textures%29%3B%0A%20%20%20%20%20%20const%20images%20%3D%20extractFromCache%28meta.images%29%3B%0A%20%20%20%20%20%20if%20%28textures.length%20%3E%200%29%20data.textures%20%3D%20textures%3B%0A%20%20%20%20%20%20if%20%28images.length%20%3E%200%29%20data.images%20%3D%20images%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20this.blending%20%3D%20source.blending%3B%0A%20%20%20%20this.side%20%3D%20source.side%3B%0A%20%20%20%20this.vertexColors%20%3D%20source.vertexColors%3B%0A%20%20%20%20this.opacity%20%3D%20source.opacity%3B%0A%20%20%20%20this.transparent%20%3D%20source.transparent%3B%0A%20%20%20%20this.blendSrc%20%3D%20source.blendSrc%3B%0A%20%20%20%20this.blendDst%20%3D%20source.blendDst%3B%0A%20%20%20%20this.blendEquation%20%3D%20source.blendEquation%3B%0A%20%20%20%20this.blendSrcAlpha%20%3D%20source.blendSrcAlpha%3B%0A%20%20%20%20this.blendDstAlpha%20%3D%20source.blendDstAlpha%3B%0A%20%20%20%20this.blendEquationAlpha%20%3D%20source.blendEquationAlpha%3B%0A%20%20%20%20this.blendColor.copy%28source.blendColor%29%3B%0A%20%20%20%20this.blendAlpha%20%3D%20source.blendAlpha%3B%0A%20%20%20%20this.depthFunc%20%3D%20source.depthFunc%3B%0A%20%20%20%20this.depthTest%20%3D%20source.depthTest%3B%0A%20%20%20%20this.depthWrite%20%3D%20source.depthWrite%3B%0A%20%20%20%20this.stencilWriteMask%20%3D%20source.stencilWriteMask%3B%0A%20%20%20%20this.stencilFunc%20%3D%20source.stencilFunc%3B%0A%20%20%20%20this.stencilRef%20%3D%20source.stencilRef%3B%0A%20%20%20%20this.stencilFuncMask%20%3D%20source.stencilFuncMask%3B%0A%20%20%20%20this.stencilFail%20%3D%20source.stencilFail%3B%0A%20%20%20%20this.stencilZFail%20%3D%20source.stencilZFail%3B%0A%20%20%20%20this.stencilZPass%20%3D%20source.stencilZPass%3B%0A%20%20%20%20this.stencilWrite%20%3D%20source.stencilWrite%3B%0A%20%20%20%20const%20srcPlanes%20%3D%20source.clippingPlanes%3B%0A%20%20%20%20let%20dstPlanes%20%3D%20null%3B%0A%20%20%20%20if%20%28srcPlanes%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20n%20%3D%20srcPlanes.length%3B%0A%20%20%20%20%20%20dstPlanes%20%3D%20new%20Array%28n%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20dstPlanes%5Bi%5D%20%3D%20srcPlanes%5Bi%5D.clone%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.clippingPlanes%20%3D%20dstPlanes%3B%0A%20%20%20%20this.clipIntersection%20%3D%20source.clipIntersection%3B%0A%20%20%20%20this.clipShadows%20%3D%20source.clipShadows%3B%0A%20%20%20%20this.shadowSide%20%3D%20source.shadowSide%3B%0A%20%20%20%20this.colorWrite%20%3D%20source.colorWrite%3B%0A%20%20%20%20this.precision%20%3D%20source.precision%3B%0A%20%20%20%20this.polygonOffset%20%3D%20source.polygonOffset%3B%0A%20%20%20%20this.polygonOffsetFactor%20%3D%20source.polygonOffsetFactor%3B%0A%20%20%20%20this.polygonOffsetUnits%20%3D%20source.polygonOffsetUnits%3B%0A%20%20%20%20this.dithering%20%3D%20source.dithering%3B%0A%20%20%20%20this.alphaTest%20%3D%20source.alphaTest%3B%0A%20%20%20%20this.alphaHash%20%3D%20source.alphaHash%3B%0A%20%20%20%20this.alphaToCoverage%20%3D%20source.alphaToCoverage%3B%0A%20%20%20%20this.premultipliedAlpha%20%3D%20source.premultipliedAlpha%3B%0A%20%20%20%20this.forceSinglePass%20%3D%20source.forceSinglePass%3B%0A%20%20%20%20this.visible%20%3D%20source.visible%3B%0A%20%20%20%20this.toneMapped%20%3D%20source.toneMapped%3B%0A%20%20%20%20this.userData%20%3D%20JSON.parse%28JSON.stringify%28source.userData%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20this.version%2B%2B%3B%0A%20%20%7D%0A%20%20onBuild%28%29%20%7B%0A%20%20%20%20console.warn%28%22Material%3A%20onBuild%28%29%20has%20been%20removed.%22%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshBasicMaterial2%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshBasicMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshBasicMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%2816777215%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.lightMap%20%3D%20null%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%201%3B%0A%20%20%20%20this.aoMap%20%3D%20null%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%201%3B%0A%20%20%20%20this.specularMap%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.envMap%20%3D%20null%3B%0A%20%20%20%20this.envMapRotation%20%3D%20new%20Euler2%28%29%3B%0A%20%20%20%20this.combine%20%3D%20MultiplyOperation2%3B%0A%20%20%20%20this.reflectivity%20%3D%201%3B%0A%20%20%20%20this.refractionRatio%20%3D%200.98%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20%22round%22%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20%22round%22%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.lightMap%20%3D%20source.lightMap%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%20source.lightMapIntensity%3B%0A%20%20%20%20this.aoMap%20%3D%20source.aoMap%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%20source.aoMapIntensity%3B%0A%20%20%20%20this.specularMap%20%3D%20source.specularMap%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.envMap%20%3D%20source.envMap%3B%0A%20%20%20%20this.envMapRotation.copy%28source.envMapRotation%29%3B%0A%20%20%20%20this.combine%20%3D%20source.combine%3B%0A%20%20%20%20this.reflectivity%20%3D%20source.reflectivity%3B%0A%20%20%20%20this.refractionRatio%20%3D%20source.refractionRatio%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20source.wireframeLinecap%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20source.wireframeLinejoin%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_tables%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20_generateTables%28%29%3B%0Afunction%20_generateTables%28%29%20%7B%0A%20%20const%20buffer2%20%3D%20new%20ArrayBuffer%284%29%3B%0A%20%20const%20floatView%20%3D%20new%20Float32Array%28buffer2%29%3B%0A%20%20const%20uint32View%20%3D%20new%20Uint32Array%28buffer2%29%3B%0A%20%20const%20baseTable%20%3D%20new%20Uint32Array%28512%29%3B%0A%20%20const%20shiftTable%20%3D%20new%20Uint32Array%28512%29%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20256%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20const%20e%20%3D%20i%20-%20127%3B%0A%20%20%20%20if%20%28e%20%3C%20-27%29%20%7B%0A%20%20%20%20%20%20baseTable%5Bi%5D%20%3D%200%3B%0A%20%20%20%20%20%20baseTable%5Bi%20%7C%20256%5D%20%3D%2032768%3B%0A%20%20%20%20%20%20shiftTable%5Bi%5D%20%3D%2024%3B%0A%20%20%20%20%20%20shiftTable%5Bi%20%7C%20256%5D%20%3D%2024%3B%0A%20%20%20%20%7D%20else%20if%20%28e%20%3C%20-14%29%20%7B%0A%20%20%20%20%20%20baseTable%5Bi%5D%20%3D%201024%20%3E%3E%20-e%20-%2014%3B%0A%20%20%20%20%20%20baseTable%5Bi%20%7C%20256%5D%20%3D%201024%20%3E%3E%20-e%20-%2014%20%7C%2032768%3B%0A%20%20%20%20%20%20shiftTable%5Bi%5D%20%3D%20-e%20-%201%3B%0A%20%20%20%20%20%20shiftTable%5Bi%20%7C%20256%5D%20%3D%20-e%20-%201%3B%0A%20%20%20%20%7D%20else%20if%20%28e%20%3C%3D%2015%29%20%7B%0A%20%20%20%20%20%20baseTable%5Bi%5D%20%3D%20e%20%2B%2015%20%3C%3C%2010%3B%0A%20%20%20%20%20%20baseTable%5Bi%20%7C%20256%5D%20%3D%20e%20%2B%2015%20%3C%3C%2010%20%7C%2032768%3B%0A%20%20%20%20%20%20shiftTable%5Bi%5D%20%3D%2013%3B%0A%20%20%20%20%20%20shiftTable%5Bi%20%7C%20256%5D%20%3D%2013%3B%0A%20%20%20%20%7D%20else%20if%20%28e%20%3C%20128%29%20%7B%0A%20%20%20%20%20%20baseTable%5Bi%5D%20%3D%2031744%3B%0A%20%20%20%20%20%20baseTable%5Bi%20%7C%20256%5D%20%3D%2064512%3B%0A%20%20%20%20%20%20shiftTable%5Bi%5D%20%3D%2024%3B%0A%20%20%20%20%20%20shiftTable%5Bi%20%7C%20256%5D%20%3D%2024%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20baseTable%5Bi%5D%20%3D%2031744%3B%0A%20%20%20%20%20%20baseTable%5Bi%20%7C%20256%5D%20%3D%2064512%3B%0A%20%20%20%20%20%20shiftTable%5Bi%5D%20%3D%2013%3B%0A%20%20%20%20%20%20shiftTable%5Bi%20%7C%20256%5D%20%3D%2013%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20const%20mantissaTable%20%3D%20new%20Uint32Array%282048%29%3B%0A%20%20const%20exponentTable%20%3D%20new%20Uint32Array%2864%29%3B%0A%20%20const%20offsetTable%20%3D%20new%20Uint32Array%2864%29%3B%0A%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%201024%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20let%20m2%20%3D%20i%20%3C%3C%2013%3B%0A%20%20%20%20let%20e%20%3D%200%3B%0A%20%20%20%20while%20%28%28m2%20%26%208388608%29%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20m2%20%3C%3C%3D%201%3B%0A%20%20%20%20%20%20e%20-%3D%208388608%3B%0A%20%20%20%20%7D%0A%20%20%20%20m2%20%26%3D%20~8388608%3B%0A%20%20%20%20e%20%2B%3D%20947912704%3B%0A%20%20%20%20mantissaTable%5Bi%5D%20%3D%20m2%20%7C%20e%3B%0A%20%20%7D%0A%20%20for%20%28let%20i%20%3D%201024%3B%20i%20%3C%202048%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20mantissaTable%5Bi%5D%20%3D%20939524096%20%2B%20%28i%20-%201024%20%3C%3C%2013%29%3B%0A%20%20%7D%0A%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%2031%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20exponentTable%5Bi%5D%20%3D%20i%20%3C%3C%2023%3B%0A%20%20%7D%0A%20%20exponentTable%5B31%5D%20%3D%201199570944%3B%0A%20%20exponentTable%5B32%5D%20%3D%202147483648%3B%0A%20%20for%20%28let%20i%20%3D%2033%3B%20i%20%3C%2063%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20exponentTable%5Bi%5D%20%3D%202147483648%20%2B%20%28i%20-%2032%20%3C%3C%2023%29%3B%0A%20%20%7D%0A%20%20exponentTable%5B63%5D%20%3D%203347054592%3B%0A%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%2064%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20if%20%28i%20%21%3D%3D%2032%29%20%7B%0A%20%20%20%20%20%20offsetTable%5Bi%5D%20%3D%201024%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20floatView%2C%0A%20%20%20%20uint32View%2C%0A%20%20%20%20baseTable%2C%0A%20%20%20%20shiftTable%2C%0A%20%20%20%20mantissaTable%2C%0A%20%20%20%20exponentTable%2C%0A%20%20%20%20offsetTable%0A%20%20%7D%3B%0A%7D%0Afunction%20toHalfFloat%28val%29%20%7B%0A%20%20if%20%28Math.abs%28val%29%20%3E%2065504%29%20console.warn%28%22THREE.DataUtils.toHalfFloat%28%29%3A%20Value%20out%20of%20range.%22%29%3B%0A%20%20val%20%3D%20clamp%241%28val%2C%20-65504%2C%2065504%29%3B%0A%20%20_tables.floatView%5B0%5D%20%3D%20val%3B%0A%20%20const%20f%20%3D%20_tables.uint32View%5B0%5D%3B%0A%20%20const%20e%20%3D%20f%20%3E%3E%2023%20%26%20511%3B%0A%20%20return%20_tables.baseTable%5Be%5D%20%2B%20%28%28f%20%26%208388607%29%20%3E%3E%20_tables.shiftTable%5Be%5D%29%3B%0A%7D%0Afunction%20fromHalfFloat%28val%29%20%7B%0A%20%20const%20m2%20%3D%20val%20%3E%3E%2010%3B%0A%20%20_tables.uint32View%5B0%5D%20%3D%20_tables.mantissaTable%5B_tables.offsetTable%5Bm2%5D%20%2B%20%28val%20%26%201023%29%5D%20%2B%20_tables.exponentTable%5Bm2%5D%3B%0A%20%20return%20_tables.floatView%5B0%5D%3B%0A%7D%0Avar%20_vector%2492%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vector2%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector22%28%29%3B%0Avar%20BufferAttribute2%20%3D%20class%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%20%3D%20false%29%20%7B%0A%20%20%20%20if%20%28Array.isArray%28array%29%29%20%7B%0A%20%20%20%20%20%20throw%20new%20TypeError%28%22THREE.BufferAttribute%3A%20array%20should%20be%20a%20Typed%20Array.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.isBufferAttribute%20%3D%20true%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.array%20%3D%20array%3B%0A%20%20%20%20this.itemSize%20%3D%20itemSize%3B%0A%20%20%20%20this.count%20%3D%20array%20%21%3D%3D%20void%200%20%3F%20array.length%20%2F%20itemSize%20%3A%200%3B%0A%20%20%20%20this.normalized%20%3D%20normalized%3B%0A%20%20%20%20this.usage%20%3D%20StaticDrawUsage2%3B%0A%20%20%20%20this.updateRanges%20%3D%20%5B%5D%3B%0A%20%20%20%20this.gpuType%20%3D%20FloatType2%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%7D%0A%20%20onUploadCallback%28%29%20%7B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20this.version%2B%2B%3B%0A%20%20%7D%0A%20%20setUsage%28value%29%20%7B%0A%20%20%20%20this.usage%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addUpdateRange%28start%2C%20count%29%20%7B%0A%20%20%20%20this.updateRanges.push%28%7B%20start%2C%20count%20%7D%29%3B%0A%20%20%7D%0A%20%20clearUpdateRanges%28%29%20%7B%0A%20%20%20%20this.updateRanges.length%20%3D%200%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20this.array%20%3D%20new%20source.array.constructor%28source.array%29%3B%0A%20%20%20%20this.itemSize%20%3D%20source.itemSize%3B%0A%20%20%20%20this.count%20%3D%20source.count%3B%0A%20%20%20%20this.normalized%20%3D%20source.normalized%3B%0A%20%20%20%20this.usage%20%3D%20source.usage%3B%0A%20%20%20%20this.gpuType%20%3D%20source.gpuType%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copyAt%28index1%2C%20attribute2%2C%20index22%29%20%7B%0A%20%20%20%20index1%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20index22%20%2A%3D%20attribute2.itemSize%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.itemSize%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.array%5Bindex1%20%2B%20i%5D%20%3D%20attribute2.array%5Bindex22%20%2B%20i%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copyArray%28array%29%20%7B%0A%20%20%20%20this.array.set%28array%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix3%28m2%29%20%7B%0A%20%20%20%20if%20%28this.itemSize%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20_vector2%2412.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20_vector2%2412.applyMatrix3%28m2%29%3B%0A%20%20%20%20%20%20%20%20this.setXY%28i%2C%20_vector2%2412.x%2C%20_vector2%2412.y%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28this.itemSize%20%3D%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20_vector%2492.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20_vector%2492.applyMatrix3%28m2%29%3B%0A%20%20%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%2492.x%2C%20_vector%2492.y%2C%20_vector%2492.z%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyMatrix4%28m2%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%2492.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%2492.applyMatrix4%28m2%29%3B%0A%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%2492.x%2C%20_vector%2492.y%2C%20_vector%2492.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyNormalMatrix%28m2%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%2492.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%2492.applyNormalMatrix%28m2%29%3B%0A%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%2492.x%2C%20_vector%2492.y%2C%20_vector%2492.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20transformDirection%28m2%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%2492.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%2492.transformDirection%28m2%29%3B%0A%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%2492.x%2C%20_vector%2492.y%2C%20_vector%2492.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20set%28value%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.array.set%28value%2C%20offset%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getComponent%28index5%2C%20component%29%20%7B%0A%20%20%20%20let%20value%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%20component%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20value%20%3D%20denormalize2%28value%2C%20this.array%29%3B%0A%20%20%20%20return%20value%3B%0A%20%20%7D%0A%20%20setComponent%28index5%2C%20component%2C%20value%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20value%20%3D%20normalize%241%28value%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%20component%5D%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getX%28index5%29%20%7B%0A%20%20%20%20let%20x2%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20x2%20%3D%20denormalize2%28x2%2C%20this.array%29%3B%0A%20%20%20%20return%20x2%3B%0A%20%20%7D%0A%20%20setX%28index5%2C%20x2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%5D%20%3D%20x2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getY%28index5%29%20%7B%0A%20%20%20%20let%20y2%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%201%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20y2%20%3D%20denormalize2%28y2%2C%20this.array%29%3B%0A%20%20%20%20return%20y2%3B%0A%20%20%7D%0A%20%20setY%28index5%2C%20y2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getZ%28index5%29%20%7B%0A%20%20%20%20let%20z2%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%202%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20z2%20%3D%20denormalize2%28z2%2C%20this.array%29%3B%0A%20%20%20%20return%20z2%3B%0A%20%20%7D%0A%20%20setZ%28index5%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20z2%20%3D%20normalize%241%28z2%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%202%5D%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getW%28index5%29%20%7B%0A%20%20%20%20let%20w%20%3D%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%203%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20w%20%3D%20denormalize2%28w%2C%20this.array%29%3B%0A%20%20%20%20return%20w%3B%0A%20%20%7D%0A%20%20setW%28index5%2C%20w%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20w%20%3D%20normalize%241%28w%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%203%5D%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXY%28index5%2C%20x2%2C%20y2%29%20%7B%0A%20%20%20%20index5%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.array%5Bindex5%20%2B%200%5D%20%3D%20x2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXYZ%28index5%2C%20x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20index5%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20%20%20z2%20%3D%20normalize%241%28z2%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.array%5Bindex5%20%2B%200%5D%20%3D%20x2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%202%5D%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXYZW%28index5%2C%20x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20index5%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20%20%20z2%20%3D%20normalize%241%28z2%2C%20this.array%29%3B%0A%20%20%20%20%20%20w%20%3D%20normalize%241%28w%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.array%5Bindex5%20%2B%200%5D%20%3D%20x2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%202%5D%20%3D%20z2%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%203%5D%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20onUpload%28callback%29%20%7B%0A%20%20%20%20this.onUploadCallback%20%3D%20callback%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.array%2C%20this.itemSize%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20%7B%0A%20%20%20%20%20%20itemSize%3A%20this.itemSize%2C%0A%20%20%20%20%20%20type%3A%20this.array.constructor.name%2C%0A%20%20%20%20%20%20array%3A%20Array.from%28this.array%29%2C%0A%20%20%20%20%20%20normalized%3A%20this.normalized%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28this.name%20%21%3D%3D%20%22%22%29%20data.name%20%3D%20this.name%3B%0A%20%20%20%20if%20%28this.usage%20%21%3D%3D%20StaticDrawUsage2%29%20data.usage%20%3D%20this.usage%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Uint16BufferAttribute2%20%3D%20class%20extends%20BufferAttribute2%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%29%20%7B%0A%20%20%20%20super%28new%20Uint16Array%28array%29%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Uint32BufferAttribute2%20%3D%20class%20extends%20BufferAttribute2%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%29%20%7B%0A%20%20%20%20super%28new%20Uint32Array%28array%29%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Float16BufferAttribute%20%3D%20class%20extends%20BufferAttribute2%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%29%20%7B%0A%20%20%20%20super%28new%20Uint16Array%28array%29%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%20%20this.isFloat16BufferAttribute%20%3D%20true%3B%0A%20%20%7D%0A%20%20getX%28index5%29%20%7B%0A%20%20%20%20let%20x2%20%3D%20fromHalfFloat%28this.array%5Bindex5%20%2A%20this.itemSize%5D%29%3B%0A%20%20%20%20if%20%28this.normalized%29%20x2%20%3D%20denormalize2%28x2%2C%20this.array%29%3B%0A%20%20%20%20return%20x2%3B%0A%20%20%7D%0A%20%20setX%28index5%2C%20x2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%5D%20%3D%20toHalfFloat%28x2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getY%28index5%29%20%7B%0A%20%20%20%20let%20y2%20%3D%20fromHalfFloat%28this.array%5Bindex5%20%2A%20this.itemSize%20%2B%201%5D%29%3B%0A%20%20%20%20if%20%28this.normalized%29%20y2%20%3D%20denormalize2%28y2%2C%20this.array%29%3B%0A%20%20%20%20return%20y2%3B%0A%20%20%7D%0A%20%20setY%28index5%2C%20y2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%201%5D%20%3D%20toHalfFloat%28y2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getZ%28index5%29%20%7B%0A%20%20%20%20let%20z2%20%3D%20fromHalfFloat%28this.array%5Bindex5%20%2A%20this.itemSize%20%2B%202%5D%29%3B%0A%20%20%20%20if%20%28this.normalized%29%20z2%20%3D%20denormalize2%28z2%2C%20this.array%29%3B%0A%20%20%20%20return%20z2%3B%0A%20%20%7D%0A%20%20setZ%28index5%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20z2%20%3D%20normalize%241%28z2%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%202%5D%20%3D%20toHalfFloat%28z2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getW%28index5%29%20%7B%0A%20%20%20%20let%20w%20%3D%20fromHalfFloat%28this.array%5Bindex5%20%2A%20this.itemSize%20%2B%203%5D%29%3B%0A%20%20%20%20if%20%28this.normalized%29%20w%20%3D%20denormalize2%28w%2C%20this.array%29%3B%0A%20%20%20%20return%20w%3B%0A%20%20%7D%0A%20%20setW%28index5%2C%20w%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20w%20%3D%20normalize%241%28w%2C%20this.array%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2A%20this.itemSize%20%2B%203%5D%20%3D%20toHalfFloat%28w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXY%28index5%2C%20x2%2C%20y2%29%20%7B%0A%20%20%20%20index5%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.array%5Bindex5%20%2B%200%5D%20%3D%20toHalfFloat%28x2%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%201%5D%20%3D%20toHalfFloat%28y2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXYZ%28index5%2C%20x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20index5%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20%20%20z2%20%3D%20normalize%241%28z2%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.array%5Bindex5%20%2B%200%5D%20%3D%20toHalfFloat%28x2%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%201%5D%20%3D%20toHalfFloat%28y2%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%202%5D%20%3D%20toHalfFloat%28z2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXYZW%28index5%2C%20x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20index5%20%2A%3D%20this.itemSize%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20%20%20z2%20%3D%20normalize%241%28z2%2C%20this.array%29%3B%0A%20%20%20%20%20%20w%20%3D%20normalize%241%28w%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.array%5Bindex5%20%2B%200%5D%20%3D%20toHalfFloat%28x2%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%201%5D%20%3D%20toHalfFloat%28y2%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%202%5D%20%3D%20toHalfFloat%28z2%29%3B%0A%20%20%20%20this.array%5Bindex5%20%2B%203%5D%20%3D%20toHalfFloat%28w%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Float32BufferAttribute2%20%3D%20class%20extends%20BufferAttribute2%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%29%20%7B%0A%20%20%20%20super%28new%20Float32Array%28array%29%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_id%249%20%3D%200%3B%0Avar%20_m1%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20_obj2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Object3D2%28%29%3B%0Avar%20_offset3%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_box%2422%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Box32%28%29%3B%0Avar%20_boxMorphTargets2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Box32%28%29%3B%0Avar%20_vector%2482%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20BufferGeometry2%20%3D%20class%20_BufferGeometry%20extends%20EventDispatcher2%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isBufferGeometry%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_id%249%2B%2B%20%7D%29%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID2%28%29%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.type%20%3D%20%22BufferGeometry%22%3B%0A%20%20%20%20this.index%20%3D%20null%3B%0A%20%20%20%20this.indirect%20%3D%20null%3B%0A%20%20%20%20this.attributes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.morphAttributes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.morphTargetsRelative%20%3D%20false%3B%0A%20%20%20%20this.groups%20%3D%20%5B%5D%3B%0A%20%20%20%20this.boundingBox%20%3D%20null%3B%0A%20%20%20%20this.boundingSphere%20%3D%20null%3B%0A%20%20%20%20this.drawRange%20%3D%20%7B%20start%3A%200%2C%20count%3A%20Infinity%20%7D%3B%0A%20%20%20%20this.userData%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20getIndex%28%29%20%7B%0A%20%20%20%20return%20this.index%3B%0A%20%20%7D%0A%20%20setIndex%28index5%29%20%7B%0A%20%20%20%20if%20%28Array.isArray%28index5%29%29%20%7B%0A%20%20%20%20%20%20this.index%20%3D%20new%20%28arrayNeedsUint32%241%28index5%29%20%3F%20Uint32BufferAttribute2%20%3A%20Uint16BufferAttribute2%29%28index5%2C%201%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.index%20%3D%20index5%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setIndirect%28indirect%29%20%7B%0A%20%20%20%20this.indirect%20%3D%20indirect%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getIndirect%28%29%20%7B%0A%20%20%20%20return%20this.indirect%3B%0A%20%20%7D%0A%20%20getAttribute%28name%29%20%7B%0A%20%20%20%20return%20this.attributes%5Bname%5D%3B%0A%20%20%7D%0A%20%20setAttribute%28name%2C%20attribute2%29%20%7B%0A%20%20%20%20this.attributes%5Bname%5D%20%3D%20attribute2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20deleteAttribute%28name%29%20%7B%0A%20%20%20%20delete%20this.attributes%5Bname%5D%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20hasAttribute%28name%29%20%7B%0A%20%20%20%20return%20this.attributes%5Bname%5D%20%21%3D%3D%20void%200%3B%0A%20%20%7D%0A%20%20addGroup%28start%2C%20count%2C%20materialIndex%20%3D%200%29%20%7B%0A%20%20%20%20this.groups.push%28%7B%0A%20%20%20%20%20%20start%2C%0A%20%20%20%20%20%20count%2C%0A%20%20%20%20%20%20materialIndex%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20clearGroups%28%29%20%7B%0A%20%20%20%20this.groups%20%3D%20%5B%5D%3B%0A%20%20%7D%0A%20%20setDrawRange%28start%2C%20count%29%20%7B%0A%20%20%20%20this.drawRange.start%20%3D%20start%3B%0A%20%20%20%20this.drawRange.count%20%3D%20count%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%29%20%7B%0A%20%20%20%20const%20position%20%3D%20this.attributes.position%3B%0A%20%20%20%20if%20%28position%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20position.applyMatrix4%28matrix%29%3B%0A%20%20%20%20%20%20position.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20normal2%20%3D%20this.attributes.normal%3B%0A%20%20%20%20if%20%28normal2%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20normalMatrix%20%3D%20new%20Matrix32%28%29.getNormalMatrix%28matrix%29%3B%0A%20%20%20%20%20%20normal2.applyNormalMatrix%28normalMatrix%29%3B%0A%20%20%20%20%20%20normal2.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20tangent%20%3D%20this.attributes.tangent%3B%0A%20%20%20%20if%20%28tangent%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20tangent.transformDirection%28matrix%29%3B%0A%20%20%20%20%20%20tangent.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.boundingBox%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.computeBoundingBox%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.boundingSphere%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.computeBoundingSphere%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyQuaternion%28q%29%20%7B%0A%20%20%20%20_m1%2412.makeRotationFromQuaternion%28q%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%2412%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateX%28angle%29%20%7B%0A%20%20%20%20_m1%2412.makeRotationX%28angle%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%2412%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateY%28angle%29%20%7B%0A%20%20%20%20_m1%2412.makeRotationY%28angle%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%2412%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20rotateZ%28angle%29%20%7B%0A%20%20%20%20_m1%2412.makeRotationZ%28angle%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%2412%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20_m1%2412.makeTranslation%28x2%2C%20y2%2C%20z2%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%2412%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20scale%28x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20_m1%2412.makeScale%28x2%2C%20y2%2C%20z2%29%3B%0A%20%20%20%20this.applyMatrix4%28_m1%2412%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lookAt%28vector%29%20%7B%0A%20%20%20%20_obj2.lookAt%28vector%29%3B%0A%20%20%20%20_obj2.updateMatrix%28%29%3B%0A%20%20%20%20this.applyMatrix4%28_obj2.matrix%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20center%28%29%20%7B%0A%20%20%20%20this.computeBoundingBox%28%29%3B%0A%20%20%20%20this.boundingBox.getCenter%28_offset3%29.negate%28%29%3B%0A%20%20%20%20this.translate%28_offset3.x%2C%20_offset3.y%2C%20_offset3.z%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromPoints%28points%29%20%7B%0A%20%20%20%20const%20positionAttribute%20%3D%20this.getAttribute%28%22position%22%29%3B%0A%20%20%20%20if%20%28positionAttribute%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20position%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20points.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20point%20%3D%20points%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20position.push%28point.x%2C%20point.y%2C%20point.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute2%28position%2C%203%29%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20positionAttribute.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20point%20%3D%20points%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20positionAttribute.setXYZ%28i%2C%20point.x%2C%20point.y%2C%20point.z%20%7C%7C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28points.length%20%3E%20positionAttribute.count%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.BufferGeometry%3A%20Buffer%20size%20too%20small%20for%20points%20data.%20Use%20.dispose%28%29%20and%20create%20a%20new%20geometry.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20positionAttribute.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20computeBoundingBox%28%29%20%7B%0A%20%20%20%20if%20%28this.boundingBox%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.boundingBox%20%3D%20new%20Box32%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20position%20%3D%20this.attributes.position%3B%0A%20%20%20%20const%20morphAttributesPosition%20%3D%20this.morphAttributes.position%3B%0A%20%20%20%20if%20%28position%20%26%26%20position.isGLBufferAttribute%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.BufferGeometry.computeBoundingBox%28%29%3A%20GLBufferAttribute%20requires%20a%20manual%20bounding%20box.%22%2C%20this%29%3B%0A%20%20%20%20%20%20this.boundingBox.set%28%0A%20%20%20%20%20%20%20%20new%20Vector32%28-Infinity%2C%20-Infinity%2C%20-Infinity%29%2C%0A%20%20%20%20%20%20%20%20new%20Vector32%28Infinity%2C%20Infinity%2C%20Infinity%29%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28position%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.boundingBox.setFromBufferAttribute%28position%29%3B%0A%20%20%20%20%20%20if%20%28morphAttributesPosition%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphAttributesPosition.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributesPosition%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20_box%2422.setFromBufferAttribute%28morphAttribute%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.morphTargetsRelative%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%2482.addVectors%28this.boundingBox.min%2C%20_box%2422.min%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.boundingBox.expandByPoint%28_vector%2482%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%2482.addVectors%28this.boundingBox.max%2C%20_box%2422.max%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.boundingBox.expandByPoint%28_vector%2482%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.boundingBox.expandByPoint%28_box%2422.min%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.boundingBox.expandByPoint%28_box%2422.max%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.boundingBox.makeEmpty%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isNaN%28this.boundingBox.min.x%29%20%7C%7C%20isNaN%28this.boundingBox.min.y%29%20%7C%7C%20isNaN%28this.boundingBox.min.z%29%29%20%7B%0A%20%20%20%20%20%20console.error%28%27THREE.BufferGeometry.computeBoundingBox%28%29%3A%20Computed%20min%2Fmax%20have%20NaN%20values.%20The%20%22position%22%20attribute%20is%20likely%20to%20have%20NaN%20values.%27%2C%20this%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20computeBoundingSphere%28%29%20%7B%0A%20%20%20%20if%20%28this.boundingSphere%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.boundingSphere%20%3D%20new%20Sphere2%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20position%20%3D%20this.attributes.position%3B%0A%20%20%20%20const%20morphAttributesPosition%20%3D%20this.morphAttributes.position%3B%0A%20%20%20%20if%20%28position%20%26%26%20position.isGLBufferAttribute%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.BufferGeometry.computeBoundingSphere%28%29%3A%20GLBufferAttribute%20requires%20a%20manual%20bounding%20sphere.%22%2C%20this%29%3B%0A%20%20%20%20%20%20this.boundingSphere.set%28new%20Vector32%28%29%2C%20Infinity%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28position%29%20%7B%0A%20%20%20%20%20%20const%20center%20%3D%20this.boundingSphere.center%3B%0A%20%20%20%20%20%20_box%2422.setFromBufferAttribute%28position%29%3B%0A%20%20%20%20%20%20if%20%28morphAttributesPosition%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphAttributesPosition.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributesPosition%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20_boxMorphTargets2.setFromBufferAttribute%28morphAttribute%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.morphTargetsRelative%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%2482.addVectors%28_box%2422.min%2C%20_boxMorphTargets2.min%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_box%2422.expandByPoint%28_vector%2482%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%2482.addVectors%28_box%2422.max%2C%20_boxMorphTargets2.max%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_box%2422.expandByPoint%28_vector%2482%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_box%2422.expandByPoint%28_boxMorphTargets2.min%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_box%2422.expandByPoint%28_boxMorphTargets2.max%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_box%2422.getCenter%28center%29%3B%0A%20%20%20%20%20%20let%20maxRadiusSq%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20position.count%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20_vector%2482.fromBufferAttribute%28position%2C%20i%29%3B%0A%20%20%20%20%20%20%20%20maxRadiusSq%20%3D%20Math.max%28maxRadiusSq%2C%20center.distanceToSquared%28_vector%2482%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28morphAttributesPosition%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphAttributesPosition.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributesPosition%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20morphTargetsRelative%20%3D%20this.morphTargetsRelative%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%2C%20jl%20%3D%20morphAttribute.count%3B%20j%20%3C%20jl%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector%2482.fromBufferAttribute%28morphAttribute%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28morphTargetsRelative%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_offset3.fromBufferAttribute%28position%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_vector%2482.add%28_offset3%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20maxRadiusSq%20%3D%20Math.max%28maxRadiusSq%2C%20center.distanceToSquared%28_vector%2482%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.boundingSphere.radius%20%3D%20Math.sqrt%28maxRadiusSq%29%3B%0A%20%20%20%20%20%20if%20%28isNaN%28this.boundingSphere.radius%29%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%27THREE.BufferGeometry.computeBoundingSphere%28%29%3A%20Computed%20radius%20is%20NaN.%20The%20%22position%22%20attribute%20is%20likely%20to%20have%20NaN%20values.%27%2C%20this%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20computeTangents%28%29%20%7B%0A%20%20%20%20const%20index5%20%3D%20this.index%3B%0A%20%20%20%20const%20attributes%20%3D%20this.attributes%3B%0A%20%20%20%20if%20%28index5%20%3D%3D%3D%20null%20%7C%7C%20attributes.position%20%3D%3D%3D%20void%200%20%7C%7C%20attributes.normal%20%3D%3D%3D%20void%200%20%7C%7C%20attributes.uv%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.BufferGeometry%3A%20.computeTangents%28%29%20failed.%20Missing%20required%20attributes%20%28index%2C%20position%2C%20normal%20or%20uv%29%22%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20positionAttribute%20%3D%20attributes.position%3B%0A%20%20%20%20const%20normalAttribute%20%3D%20attributes.normal%3B%0A%20%20%20%20const%20uvAttribute%20%3D%20attributes.uv%3B%0A%20%20%20%20if%20%28this.hasAttribute%28%22tangent%22%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this.setAttribute%28%22tangent%22%2C%20new%20BufferAttribute2%28new%20Float32Array%284%20%2A%20positionAttribute.count%29%2C%204%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20tangentAttribute%20%3D%20this.getAttribute%28%22tangent%22%29%3B%0A%20%20%20%20const%20tan1%20%3D%20%5B%5D%2C%20tan2%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20positionAttribute.count%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20tan1%5Bi%5D%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20tan2%5Bi%5D%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20vA%20%3D%20new%20Vector32%28%29%2C%20vB%20%3D%20new%20Vector32%28%29%2C%20vC%20%3D%20new%20Vector32%28%29%2C%20uvA%20%3D%20new%20Vector22%28%29%2C%20uvB%20%3D%20new%20Vector22%28%29%2C%20uvC%20%3D%20new%20Vector22%28%29%2C%20sdir%20%3D%20new%20Vector32%28%29%2C%20tdir%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20function%20handleTriangle%28a2%2C%20b%2C%20c2%29%20%7B%0A%20%20%20%20%20%20vA.fromBufferAttribute%28positionAttribute%2C%20a2%29%3B%0A%20%20%20%20%20%20vB.fromBufferAttribute%28positionAttribute%2C%20b%29%3B%0A%20%20%20%20%20%20vC.fromBufferAttribute%28positionAttribute%2C%20c2%29%3B%0A%20%20%20%20%20%20uvA.fromBufferAttribute%28uvAttribute%2C%20a2%29%3B%0A%20%20%20%20%20%20uvB.fromBufferAttribute%28uvAttribute%2C%20b%29%3B%0A%20%20%20%20%20%20uvC.fromBufferAttribute%28uvAttribute%2C%20c2%29%3B%0A%20%20%20%20%20%20vB.sub%28vA%29%3B%0A%20%20%20%20%20%20vC.sub%28vA%29%3B%0A%20%20%20%20%20%20uvB.sub%28uvA%29%3B%0A%20%20%20%20%20%20uvC.sub%28uvA%29%3B%0A%20%20%20%20%20%20const%20r%20%3D%201%20%2F%20%28uvB.x%20%2A%20uvC.y%20-%20uvC.x%20%2A%20uvB.y%29%3B%0A%20%20%20%20%20%20if%20%28%21isFinite%28r%29%29%20return%3B%0A%20%20%20%20%20%20sdir.copy%28vB%29.multiplyScalar%28uvC.y%29.addScaledVector%28vC%2C%20-uvB.y%29.multiplyScalar%28r%29%3B%0A%20%20%20%20%20%20tdir.copy%28vC%29.multiplyScalar%28uvB.x%29.addScaledVector%28vB%2C%20-uvC.x%29.multiplyScalar%28r%29%3B%0A%20%20%20%20%20%20tan1%5Ba2%5D.add%28sdir%29%3B%0A%20%20%20%20%20%20tan1%5Bb%5D.add%28sdir%29%3B%0A%20%20%20%20%20%20tan1%5Bc2%5D.add%28sdir%29%3B%0A%20%20%20%20%20%20tan2%5Ba2%5D.add%28tdir%29%3B%0A%20%20%20%20%20%20tan2%5Bb%5D.add%28tdir%29%3B%0A%20%20%20%20%20%20tan2%5Bc2%5D.add%28tdir%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20groups%20%3D%20this.groups%3B%0A%20%20%20%20if%20%28groups.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20groups%20%3D%20%5B%7B%0A%20%20%20%20%20%20%20%20start%3A%200%2C%0A%20%20%20%20%20%20%20%20count%3A%20index5.count%0A%20%20%20%20%20%20%7D%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20groups.length%3B%20i%20%3C%20il%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20const%20start%20%3D%20group.start%3B%0A%20%20%20%20%20%20const%20count%20%3D%20group.count%3B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%20start%2C%20jl%20%3D%20start%20%2B%20count%3B%20j%20%3C%20jl%3B%20j%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20handleTriangle%28%0A%20%20%20%20%20%20%20%20%20%20index5.getX%28j%20%2B%200%29%2C%0A%20%20%20%20%20%20%20%20%20%20index5.getX%28j%20%2B%201%29%2C%0A%20%20%20%20%20%20%20%20%20%20index5.getX%28j%20%2B%202%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20tmp2%20%3D%20new%20Vector32%28%29%2C%20tmp22%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20const%20n%20%3D%20new%20Vector32%28%29%2C%20n2%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20function%20handleVertex%28v%29%20%7B%0A%20%20%20%20%20%20n.fromBufferAttribute%28normalAttribute%2C%20v%29%3B%0A%20%20%20%20%20%20n2.copy%28n%29%3B%0A%20%20%20%20%20%20const%20t%20%3D%20tan1%5Bv%5D%3B%0A%20%20%20%20%20%20tmp2.copy%28t%29%3B%0A%20%20%20%20%20%20tmp2.sub%28n.multiplyScalar%28n.dot%28t%29%29%29.normalize%28%29%3B%0A%20%20%20%20%20%20tmp22.crossVectors%28n2%2C%20t%29%3B%0A%20%20%20%20%20%20const%20test%20%3D%20tmp22.dot%28tan2%5Bv%5D%29%3B%0A%20%20%20%20%20%20const%20w%20%3D%20test%20%3C%200%20%3F%20-1%20%3A%201%3B%0A%20%20%20%20%20%20tangentAttribute.setXYZW%28v%2C%20tmp2.x%2C%20tmp2.y%2C%20tmp2.z%2C%20w%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20groups.length%3B%20i%20%3C%20il%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20const%20start%20%3D%20group.start%3B%0A%20%20%20%20%20%20const%20count%20%3D%20group.count%3B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%20start%2C%20jl%20%3D%20start%20%2B%20count%3B%20j%20%3C%20jl%3B%20j%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20handleVertex%28index5.getX%28j%20%2B%200%29%29%3B%0A%20%20%20%20%20%20%20%20handleVertex%28index5.getX%28j%20%2B%201%29%29%3B%0A%20%20%20%20%20%20%20%20handleVertex%28index5.getX%28j%20%2B%202%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20computeVertexNormals%28%29%20%7B%0A%20%20%20%20const%20index5%20%3D%20this.index%3B%0A%20%20%20%20const%20positionAttribute%20%3D%20this.getAttribute%28%22position%22%29%3B%0A%20%20%20%20if%20%28positionAttribute%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20let%20normalAttribute%20%3D%20this.getAttribute%28%22normal%22%29%3B%0A%20%20%20%20%20%20if%20%28normalAttribute%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20normalAttribute%20%3D%20new%20BufferAttribute2%28new%20Float32Array%28positionAttribute.count%20%2A%203%29%2C%203%29%3B%0A%20%20%20%20%20%20%20%20this.setAttribute%28%22normal%22%2C%20normalAttribute%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20normalAttribute.count%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28i%2C%200%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20pA%20%3D%20new%20Vector32%28%29%2C%20pB%20%3D%20new%20Vector32%28%29%2C%20pC%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20const%20nA%20%3D%20new%20Vector32%28%29%2C%20nB%20%3D%20new%20Vector32%28%29%2C%20nC%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20const%20cb%20%3D%20new%20Vector32%28%29%2C%20ab%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20if%20%28index5%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20index5.count%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20vA%20%3D%20index5.getX%28i%20%2B%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20vB%20%3D%20index5.getX%28i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20vC%20%3D%20index5.getX%28i%20%2B%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20pA.fromBufferAttribute%28positionAttribute%2C%20vA%29%3B%0A%20%20%20%20%20%20%20%20%20%20pB.fromBufferAttribute%28positionAttribute%2C%20vB%29%3B%0A%20%20%20%20%20%20%20%20%20%20pC.fromBufferAttribute%28positionAttribute%2C%20vC%29%3B%0A%20%20%20%20%20%20%20%20%20%20cb.subVectors%28pC%2C%20pB%29%3B%0A%20%20%20%20%20%20%20%20%20%20ab.subVectors%28pA%2C%20pB%29%3B%0A%20%20%20%20%20%20%20%20%20%20cb.cross%28ab%29%3B%0A%20%20%20%20%20%20%20%20%20%20nA.fromBufferAttribute%28normalAttribute%2C%20vA%29%3B%0A%20%20%20%20%20%20%20%20%20%20nB.fromBufferAttribute%28normalAttribute%2C%20vB%29%3B%0A%20%20%20%20%20%20%20%20%20%20nC.fromBufferAttribute%28normalAttribute%2C%20vC%29%3B%0A%20%20%20%20%20%20%20%20%20%20nA.add%28cb%29%3B%0A%20%20%20%20%20%20%20%20%20%20nB.add%28cb%29%3B%0A%20%20%20%20%20%20%20%20%20%20nC.add%28cb%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28vA%2C%20nA.x%2C%20nA.y%2C%20nA.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28vB%2C%20nB.x%2C%20nB.y%2C%20nB.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28vC%2C%20nC.x%2C%20nC.y%2C%20nC.z%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20positionAttribute.count%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20pA.fromBufferAttribute%28positionAttribute%2C%20i%20%2B%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20pB.fromBufferAttribute%28positionAttribute%2C%20i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20pC.fromBufferAttribute%28positionAttribute%2C%20i%20%2B%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20cb.subVectors%28pC%2C%20pB%29%3B%0A%20%20%20%20%20%20%20%20%20%20ab.subVectors%28pA%2C%20pB%29%3B%0A%20%20%20%20%20%20%20%20%20%20cb.cross%28ab%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28i%20%2B%200%2C%20cb.x%2C%20cb.y%2C%20cb.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28i%20%2B%201%2C%20cb.x%2C%20cb.y%2C%20cb.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20normalAttribute.setXYZ%28i%20%2B%202%2C%20cb.x%2C%20cb.y%2C%20cb.z%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.normalizeNormals%28%29%3B%0A%20%20%20%20%20%20normalAttribute.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20normalizeNormals%28%29%20%7B%0A%20%20%20%20const%20normals%20%3D%20this.attributes.normal%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20normals.count%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%2482.fromBufferAttribute%28normals%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%2482.normalize%28%29%3B%0A%20%20%20%20%20%20normals.setXYZ%28i%2C%20_vector%2482.x%2C%20_vector%2482.y%2C%20_vector%2482.z%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20toNonIndexed%28%29%20%7B%0A%20%20%20%20function%20convertBufferAttribute%28attribute2%2C%20indices2%29%20%7B%0A%20%20%20%20%20%20const%20array%20%3D%20attribute2.array%3B%0A%20%20%20%20%20%20const%20itemSize%20%3D%20attribute2.itemSize%3B%0A%20%20%20%20%20%20const%20normalized%20%3D%20attribute2.normalized%3B%0A%20%20%20%20%20%20const%20array2%20%3D%20new%20array.constructor%28indices2.length%20%2A%20itemSize%29%3B%0A%20%20%20%20%20%20let%20index5%20%3D%200%2C%20index22%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20indices2.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20index5%20%3D%20indices2%5Bi%5D%20%2A%20attribute2.data.stride%20%2B%20attribute2.offset%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20index5%20%3D%20indices2%5Bi%5D%20%2A%20itemSize%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20itemSize%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20array2%5Bindex22%2B%2B%5D%20%3D%20array%5Bindex5%2B%2B%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20new%20BufferAttribute2%28array2%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.index%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.BufferGeometry.toNonIndexed%28%29%3A%20BufferGeometry%20is%20already%20non-indexed.%22%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20geometry2%20%3D%20new%20_BufferGeometry%28%29%3B%0A%20%20%20%20const%20indices%20%3D%20this.index.array%3B%0A%20%20%20%20const%20attributes%20%3D%20this.attributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20attributes%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bname%5D%3B%0A%20%20%20%20%20%20const%20newAttribute%20%3D%20convertBufferAttribute%28attribute2%2C%20indices%29%3B%0A%20%20%20%20%20%20geometry2.setAttribute%28name%2C%20newAttribute%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20morphAttributes%20%3D%20this.morphAttributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20morphAttributes%29%20%7B%0A%20%20%20%20%20%20const%20morphArray%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphAttribute.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20attribute2%20%3D%20morphAttribute%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20newAttribute%20%3D%20convertBufferAttribute%28attribute2%2C%20indices%29%3B%0A%20%20%20%20%20%20%20%20morphArray.push%28newAttribute%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20geometry2.morphAttributes%5Bname%5D%20%3D%20morphArray%3B%0A%20%20%20%20%7D%0A%20%20%20%20geometry2.morphTargetsRelative%20%3D%20this.morphTargetsRelative%3B%0A%20%20%20%20const%20groups%20%3D%20this.groups%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20groups.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20geometry2.addGroup%28group.start%2C%20group.count%2C%20group.materialIndex%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20geometry2%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20%7B%0A%20%20%20%20%20%20metadata%3A%20%7B%0A%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22BufferGeometry%22%2C%0A%20%20%20%20%20%20%20%20generator%3A%20%22BufferGeometry.toJSON%22%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20data.uuid%20%3D%20this.uuid%3B%0A%20%20%20%20data.type%20%3D%20this.type%3B%0A%20%20%20%20if%20%28this.name%20%21%3D%3D%20%22%22%29%20data.name%20%3D%20this.name%3B%0A%20%20%20%20if%20%28Object.keys%28this.userData%29.length%20%3E%200%29%20data.userData%20%3D%20this.userData%3B%0A%20%20%20%20if%20%28this.parameters%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20parameters%20%3D%20this.parameters%3B%0A%20%20%20%20%20%20for%20%28const%20key%20in%20parameters%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28parameters%5Bkey%5D%20%21%3D%3D%20void%200%29%20data%5Bkey%5D%20%3D%20parameters%5Bkey%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20data%3B%0A%20%20%20%20%7D%0A%20%20%20%20data.data%20%3D%20%7B%20attributes%3A%20%7B%7D%20%7D%3B%0A%20%20%20%20const%20index5%20%3D%20this.index%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20data.data.index%20%3D%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20index5.array.constructor.name%2C%0A%20%20%20%20%20%20%20%20array%3A%20Array.prototype.slice.call%28index5.array%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20attributes%20%3D%20this.attributes%3B%0A%20%20%20%20for%20%28const%20key%20in%20attributes%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bkey%5D%3B%0A%20%20%20%20%20%20data.data.attributes%5Bkey%5D%20%3D%20attribute2.toJSON%28data.data%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20morphAttributes%20%3D%20%7B%7D%3B%0A%20%20%20%20let%20hasMorphAttributes%20%3D%20false%3B%0A%20%20%20%20for%20%28const%20key%20in%20this.morphAttributes%29%20%7B%0A%20%20%20%20%20%20const%20attributeArray%20%3D%20this.morphAttributes%5Bkey%5D%3B%0A%20%20%20%20%20%20const%20array%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20attributeArray.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20attribute2%20%3D%20attributeArray%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20array.push%28attribute2.toJSON%28data.data%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28array.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20morphAttributes%5Bkey%5D%20%3D%20array%3B%0A%20%20%20%20%20%20%20%20hasMorphAttributes%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28hasMorphAttributes%29%20%7B%0A%20%20%20%20%20%20data.data.morphAttributes%20%3D%20morphAttributes%3B%0A%20%20%20%20%20%20data.data.morphTargetsRelative%20%3D%20this.morphTargetsRelative%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20groups%20%3D%20this.groups%3B%0A%20%20%20%20if%20%28groups.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20data.data.groups%20%3D%20JSON.parse%28JSON.stringify%28groups%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20boundingSphere%20%3D%20this.boundingSphere%3B%0A%20%20%20%20if%20%28boundingSphere%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20data.data.boundingSphere%20%3D%20%7B%0A%20%20%20%20%20%20%20%20center%3A%20boundingSphere.center.toArray%28%29%2C%0A%20%20%20%20%20%20%20%20radius%3A%20boundingSphere.radius%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.index%20%3D%20null%3B%0A%20%20%20%20this.attributes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.morphAttributes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.groups%20%3D%20%5B%5D%3B%0A%20%20%20%20this.boundingBox%20%3D%20null%3B%0A%20%20%20%20this.boundingSphere%20%3D%20null%3B%0A%20%20%20%20const%20data%20%3D%20%7B%7D%3B%0A%20%20%20%20this.name%20%3D%20source.name%3B%0A%20%20%20%20const%20index5%20%3D%20source.index%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.setIndex%28index5.clone%28data%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20attributes%20%3D%20source.attributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20attributes%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bname%5D%3B%0A%20%20%20%20%20%20this.setAttribute%28name%2C%20attribute2.clone%28data%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20morphAttributes%20%3D%20source.morphAttributes%3B%0A%20%20%20%20for%20%28const%20name%20in%20morphAttributes%29%20%7B%0A%20%20%20%20%20%20const%20array%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20morphAttribute.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20array.push%28morphAttribute%5Bi%5D.clone%28data%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.morphAttributes%5Bname%5D%20%3D%20array%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.morphTargetsRelative%20%3D%20source.morphTargetsRelative%3B%0A%20%20%20%20const%20groups%20%3D%20source.groups%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20groups.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20this.addGroup%28group.start%2C%20group.count%2C%20group.materialIndex%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20boundingBox%20%3D%20source.boundingBox%3B%0A%20%20%20%20if%20%28boundingBox%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.boundingBox%20%3D%20boundingBox.clone%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20boundingSphere%20%3D%20source.boundingSphere%3B%0A%20%20%20%20if%20%28boundingSphere%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.boundingSphere%20%3D%20boundingSphere.clone%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.drawRange.start%20%3D%20source.drawRange.start%3B%0A%20%20%20%20this.drawRange.count%20%3D%20source.drawRange.count%3B%0A%20%20%20%20this.userData%20%3D%20source.userData%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_inverseMatrix%2432%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20_ray%2432%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Ray2%28%29%3B%0Avar%20_sphere%2462%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Sphere2%28%29%3B%0Avar%20_sphereHitAt2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vA%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vB%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vC%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_tempA2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_morphA2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_intersectionPoint2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_intersectionPointWorld2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20Mesh2%20%3D%20class%20extends%20Object3D2%20%7B%0A%20%20constructor%28geometry%20%3D%20new%20BufferGeometry2%28%29%2C%20material%20%3D%20new%20MeshBasicMaterial2%28%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMesh%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Mesh%22%3B%0A%20%20%20%20this.geometry%20%3D%20geometry%3B%0A%20%20%20%20this.material%20%3D%20material%3B%0A%20%20%20%20this.updateMorphTargets%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20if%20%28source.morphTargetInfluences%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.morphTargetInfluences%20%3D%20source.morphTargetInfluences.slice%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28source.morphTargetDictionary%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.morphTargetDictionary%20%3D%20Object.assign%28%7B%7D%2C%20source.morphTargetDictionary%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.material%20%3D%20Array.isArray%28source.material%29%20%3F%20source.material.slice%28%29%20%3A%20source.material%3B%0A%20%20%20%20this.geometry%20%3D%20source.geometry%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20updateMorphTargets%28%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20morphAttributes%20%3D%20geometry.morphAttributes%3B%0A%20%20%20%20const%20keys%20%3D%20Object.keys%28morphAttributes%29%3B%0A%20%20%20%20if%20%28keys.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphAttributes%5Bkeys%5B0%5D%5D%3B%0A%20%20%20%20%20%20if%20%28morphAttribute%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this.morphTargetInfluences%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20this.morphTargetDictionary%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20m2%20%3D%200%2C%20ml%20%3D%20morphAttribute.length%3B%20m2%20%3C%20ml%3B%20m2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20name%20%3D%20morphAttribute%5Bm2%5D.name%20%7C%7C%20String%28m2%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.morphTargetInfluences.push%280%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.morphTargetDictionary%5Bname%5D%20%3D%20m2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getVertexPosition%28index5%2C%20target%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20position%20%3D%20geometry.attributes.position%3B%0A%20%20%20%20const%20morphPosition%20%3D%20geometry.morphAttributes.position%3B%0A%20%20%20%20const%20morphTargetsRelative%20%3D%20geometry.morphTargetsRelative%3B%0A%20%20%20%20target.fromBufferAttribute%28position%2C%20index5%29%3B%0A%20%20%20%20const%20morphInfluences%20%3D%20this.morphTargetInfluences%3B%0A%20%20%20%20if%20%28morphPosition%20%26%26%20morphInfluences%29%20%7B%0A%20%20%20%20%20%20_morphA2.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20morphPosition.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20influence%20%3D%20morphInfluences%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20morphAttribute%20%3D%20morphPosition%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28influence%20%3D%3D%3D%200%29%20continue%3B%0A%20%20%20%20%20%20%20%20_tempA2.fromBufferAttribute%28morphAttribute%2C%20index5%29%3B%0A%20%20%20%20%20%20%20%20if%20%28morphTargetsRelative%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_morphA2.addScaledVector%28_tempA2%2C%20influence%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20_morphA2.addScaledVector%28_tempA2.sub%28target%29%2C%20influence%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20target.add%28_morphA2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20raycast%28raycaster%2C%20intersects%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20material%20%3D%20this.material%3B%0A%20%20%20%20const%20matrixWorld%20%3D%20this.matrixWorld%3B%0A%20%20%20%20if%20%28material%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20if%20%28geometry.boundingSphere%20%3D%3D%3D%20null%29%20geometry.computeBoundingSphere%28%29%3B%0A%20%20%20%20_sphere%2462.copy%28geometry.boundingSphere%29%3B%0A%20%20%20%20_sphere%2462.applyMatrix4%28matrixWorld%29%3B%0A%20%20%20%20_ray%2432.copy%28raycaster.ray%29.recast%28raycaster.near%29%3B%0A%20%20%20%20if%20%28_sphere%2462.containsPoint%28_ray%2432.origin%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20if%20%28_ray%2432.intersectSphere%28_sphere%2462%2C%20_sphereHitAt2%29%20%3D%3D%3D%20null%29%20return%3B%0A%20%20%20%20%20%20if%20%28_ray%2432.origin.distanceToSquared%28_sphereHitAt2%29%20%3E%20%28raycaster.far%20-%20raycaster.near%29%20%2A%2A%202%29%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20_inverseMatrix%2432.copy%28matrixWorld%29.invert%28%29%3B%0A%20%20%20%20_ray%2432.copy%28raycaster.ray%29.applyMatrix4%28_inverseMatrix%2432%29%3B%0A%20%20%20%20if%20%28geometry.boundingBox%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28_ray%2432.intersectsBox%28geometry.boundingBox%29%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._computeIntersections%28raycaster%2C%20intersects%2C%20_ray%2432%29%3B%0A%20%20%7D%0A%20%20_computeIntersections%28raycaster%2C%20intersects%2C%20rayLocalSpace%29%20%7B%0A%20%20%20%20let%20intersection%3B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20material%20%3D%20this.material%3B%0A%20%20%20%20const%20index5%20%3D%20geometry.index%3B%0A%20%20%20%20const%20position%20%3D%20geometry.attributes.position%3B%0A%20%20%20%20const%20uv2%20%3D%20geometry.attributes.uv%3B%0A%20%20%20%20const%20uv1%20%3D%20geometry.attributes.uv1%3B%0A%20%20%20%20const%20normal2%20%3D%20geometry.attributes.normal%3B%0A%20%20%20%20const%20groups%20%3D%20geometry.groups%3B%0A%20%20%20%20const%20drawRange%20%3D%20geometry.drawRange%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28Array.isArray%28material%29%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20groups.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20groupMaterial%20%3D%20material%5Bgroup.materialIndex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20start%20%3D%20Math.max%28group.start%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20end%20%3D%20Math.min%28index5.count%2C%20Math.min%28group.start%20%2B%20group.count%2C%20drawRange.start%20%2B%20drawRange.count%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%20start%2C%20jl%20%3D%20end%3B%20j%20%3C%20jl%3B%20j%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20index5.getX%28j%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20index5.getX%28j%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20index5.getX%28j%20%2B%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersection%20%3D%20checkGeometryIntersection2%28this%2C%20groupMaterial%2C%20raycaster%2C%20rayLocalSpace%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersection.faceIndex%20%3D%20Math.floor%28j%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersection.face.materialIndex%20%3D%20group.materialIndex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersects.push%28intersection%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20start%20%3D%20Math.max%280%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20%20%20const%20end%20%3D%20Math.min%28index5.count%2C%20drawRange.start%20%2B%20drawRange.count%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%20start%2C%20il%20%3D%20end%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20index5.getX%28i%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20index5.getX%28i%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20index5.getX%28i%20%2B%202%29%3B%0A%20%20%20%20%20%20%20%20%20%20intersection%20%3D%20checkGeometryIntersection2%28this%2C%20material%2C%20raycaster%2C%20rayLocalSpace%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersection.faceIndex%20%3D%20Math.floor%28i%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersects.push%28intersection%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28position%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28Array.isArray%28material%29%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20groups.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20groupMaterial%20%3D%20material%5Bgroup.materialIndex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20start%20%3D%20Math.max%28group.start%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20end%20%3D%20Math.min%28position.count%2C%20Math.min%28group.start%20%2B%20group.count%2C%20drawRange.start%20%2B%20drawRange.count%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%20start%2C%20jl%20%3D%20end%3B%20j%20%3C%20jl%3B%20j%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20j%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20j%20%2B%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20j%20%2B%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersection%20%3D%20checkGeometryIntersection2%28this%2C%20groupMaterial%2C%20raycaster%2C%20rayLocalSpace%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersection.faceIndex%20%3D%20Math.floor%28j%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersection.face.materialIndex%20%3D%20group.materialIndex%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20intersects.push%28intersection%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20start%20%3D%20Math.max%280%2C%20drawRange.start%29%3B%0A%20%20%20%20%20%20%20%20const%20end%20%3D%20Math.min%28position.count%2C%20drawRange.start%20%2B%20drawRange.count%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%20start%2C%20il%20%3D%20end%3B%20i%20%3C%20il%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20i%3B%0A%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20i%20%2B%201%3B%0A%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20i%20%2B%202%3B%0A%20%20%20%20%20%20%20%20%20%20intersection%20%3D%20checkGeometryIntersection2%28this%2C%20material%2C%20raycaster%2C%20rayLocalSpace%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersection.faceIndex%20%3D%20Math.floor%28i%20%2F%203%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20intersects.push%28intersection%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Afunction%20checkIntersection%2412%28object%2C%20material%2C%20raycaster%2C%20ray%2C%20pA%2C%20pB%2C%20pC%2C%20point%29%20%7B%0A%20%20let%20intersect2%3B%0A%20%20if%20%28material.side%20%3D%3D%3D%20BackSide2%29%20%7B%0A%20%20%20%20intersect2%20%3D%20ray.intersectTriangle%28pC%2C%20pB%2C%20pA%2C%20true%2C%20point%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20intersect2%20%3D%20ray.intersectTriangle%28pA%2C%20pB%2C%20pC%2C%20material.side%20%3D%3D%3D%20FrontSide2%2C%20point%29%3B%0A%20%20%7D%0A%20%20if%20%28intersect2%20%3D%3D%3D%20null%29%20return%20null%3B%0A%20%20_intersectionPointWorld2.copy%28point%29%3B%0A%20%20_intersectionPointWorld2.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20const%20distance2%20%3D%20raycaster.ray.origin.distanceTo%28_intersectionPointWorld2%29%3B%0A%20%20if%20%28distance2%20%3C%20raycaster.near%20%7C%7C%20distance2%20%3E%20raycaster.far%29%20return%20null%3B%0A%20%20return%20%7B%0A%20%20%20%20distance%3A%20distance2%2C%0A%20%20%20%20point%3A%20_intersectionPointWorld2.clone%28%29%2C%0A%20%20%20%20object%0A%20%20%7D%3B%0A%7D%0Afunction%20checkGeometryIntersection2%28object%2C%20material%2C%20raycaster%2C%20ray%2C%20uv2%2C%20uv1%2C%20normal2%2C%20a2%2C%20b%2C%20c2%29%20%7B%0A%20%20object.getVertexPosition%28a2%2C%20_vA%2412%29%3B%0A%20%20object.getVertexPosition%28b%2C%20_vB%2412%29%3B%0A%20%20object.getVertexPosition%28c2%2C%20_vC%2412%29%3B%0A%20%20const%20intersection%20%3D%20checkIntersection%2412%28object%2C%20material%2C%20raycaster%2C%20ray%2C%20_vA%2412%2C%20_vB%2412%2C%20_vC%2412%2C%20_intersectionPoint2%29%3B%0A%20%20if%20%28intersection%29%20%7B%0A%20%20%20%20const%20barycoord%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20Triangle2.getBarycoord%28_intersectionPoint2%2C%20_vA%2412%2C%20_vB%2412%2C%20_vC%2412%2C%20barycoord%29%3B%0A%20%20%20%20if%20%28uv2%29%20%7B%0A%20%20%20%20%20%20intersection.uv%20%3D%20Triangle2.getInterpolatedAttribute%28uv2%2C%20a2%2C%20b%2C%20c2%2C%20barycoord%2C%20new%20Vector22%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28uv1%29%20%7B%0A%20%20%20%20%20%20intersection.uv1%20%3D%20Triangle2.getInterpolatedAttribute%28uv1%2C%20a2%2C%20b%2C%20c2%2C%20barycoord%2C%20new%20Vector22%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28normal2%29%20%7B%0A%20%20%20%20%20%20intersection.normal%20%3D%20Triangle2.getInterpolatedAttribute%28normal2%2C%20a2%2C%20b%2C%20c2%2C%20barycoord%2C%20new%20Vector32%28%29%29%3B%0A%20%20%20%20%20%20if%20%28intersection.normal.dot%28ray.direction%29%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20intersection.normal.multiplyScalar%28-1%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20face%20%3D%20%7B%0A%20%20%20%20%20%20a%3A%20a2%2C%0A%20%20%20%20%20%20b%2C%0A%20%20%20%20%20%20c%3A%20c2%2C%0A%20%20%20%20%20%20normal%3A%20new%20Vector32%28%29%2C%0A%20%20%20%20%20%20materialIndex%3A%200%0A%20%20%20%20%7D%3B%0A%20%20%20%20Triangle2.getNormal%28_vA%2412%2C%20_vB%2412%2C%20_vC%2412%2C%20face.normal%29%3B%0A%20%20%20%20intersection.face%20%3D%20face%3B%0A%20%20%20%20intersection.barycoord%20%3D%20barycoord%3B%0A%20%20%7D%0A%20%20return%20intersection%3B%0A%7D%0Avar%20BoxGeometry2%20%3D%20class%20_BoxGeometry%20extends%20BufferGeometry2%20%7B%0A%20%20constructor%28width%20%3D%201%2C%20height%20%3D%201%2C%20depth2%20%3D%201%2C%20widthSegments%20%3D%201%2C%20heightSegments%20%3D%201%2C%20depthSegments%20%3D%201%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.type%20%3D%20%22BoxGeometry%22%3B%0A%20%20%20%20this.parameters%20%3D%20%7B%0A%20%20%20%20%20%20width%2C%0A%20%20%20%20%20%20height%2C%0A%20%20%20%20%20%20depth%3A%20depth2%2C%0A%20%20%20%20%20%20widthSegments%2C%0A%20%20%20%20%20%20heightSegments%2C%0A%20%20%20%20%20%20depthSegments%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20scope%20%3D%20this%3B%0A%20%20%20%20widthSegments%20%3D%20Math.floor%28widthSegments%29%3B%0A%20%20%20%20heightSegments%20%3D%20Math.floor%28heightSegments%29%3B%0A%20%20%20%20depthSegments%20%3D%20Math.floor%28depthSegments%29%3B%0A%20%20%20%20const%20indices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vertices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20normals%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20uvs%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20numberOfVertices%20%3D%200%3B%0A%20%20%20%20let%20groupStart%20%3D%200%3B%0A%20%20%20%20buildPlane%28%22z%22%2C%20%22y%22%2C%20%22x%22%2C%20-1%2C%20-1%2C%20depth2%2C%20height%2C%20width%2C%20depthSegments%2C%20heightSegments%2C%200%29%3B%0A%20%20%20%20buildPlane%28%22z%22%2C%20%22y%22%2C%20%22x%22%2C%201%2C%20-1%2C%20depth2%2C%20height%2C%20-width%2C%20depthSegments%2C%20heightSegments%2C%201%29%3B%0A%20%20%20%20buildPlane%28%22x%22%2C%20%22z%22%2C%20%22y%22%2C%201%2C%201%2C%20width%2C%20depth2%2C%20height%2C%20widthSegments%2C%20depthSegments%2C%202%29%3B%0A%20%20%20%20buildPlane%28%22x%22%2C%20%22z%22%2C%20%22y%22%2C%201%2C%20-1%2C%20width%2C%20depth2%2C%20-height%2C%20widthSegments%2C%20depthSegments%2C%203%29%3B%0A%20%20%20%20buildPlane%28%22x%22%2C%20%22y%22%2C%20%22z%22%2C%201%2C%20-1%2C%20width%2C%20height%2C%20depth2%2C%20widthSegments%2C%20heightSegments%2C%204%29%3B%0A%20%20%20%20buildPlane%28%22x%22%2C%20%22y%22%2C%20%22z%22%2C%20-1%2C%20-1%2C%20width%2C%20height%2C%20-depth2%2C%20widthSegments%2C%20heightSegments%2C%205%29%3B%0A%20%20%20%20this.setIndex%28indices%29%3B%0A%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute2%28vertices%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22normal%22%2C%20new%20Float32BufferAttribute2%28normals%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22uv%22%2C%20new%20Float32BufferAttribute2%28uvs%2C%202%29%29%3B%0A%20%20%20%20function%20buildPlane%28u%2C%20v%2C%20w%2C%20udir%2C%20vdir%2C%20width2%2C%20height2%2C%20depth3%2C%20gridX%2C%20gridY%2C%20materialIndex%29%20%7B%0A%20%20%20%20%20%20const%20segmentWidth%20%3D%20width2%20%2F%20gridX%3B%0A%20%20%20%20%20%20const%20segmentHeight%20%3D%20height2%20%2F%20gridY%3B%0A%20%20%20%20%20%20const%20widthHalf%20%3D%20width2%20%2F%202%3B%0A%20%20%20%20%20%20const%20heightHalf%20%3D%20height2%20%2F%202%3B%0A%20%20%20%20%20%20const%20depthHalf%20%3D%20depth3%20%2F%202%3B%0A%20%20%20%20%20%20const%20gridX1%20%3D%20gridX%20%2B%201%3B%0A%20%20%20%20%20%20const%20gridY1%20%3D%20gridY%20%2B%201%3B%0A%20%20%20%20%20%20let%20vertexCounter%20%3D%200%3B%0A%20%20%20%20%20%20let%20groupCount%20%3D%200%3B%0A%20%20%20%20%20%20const%20vector%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%20gridY1%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20y2%20%3D%20iy%20%2A%20segmentHeight%20-%20heightHalf%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%20gridX1%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20x2%20%3D%20ix%20%2A%20segmentWidth%20-%20widthHalf%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bu%5D%20%3D%20x2%20%2A%20udir%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bv%5D%20%3D%20y2%20%2A%20vdir%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bw%5D%20%3D%20depthHalf%3B%0A%20%20%20%20%20%20%20%20%20%20vertices.push%28vector.x%2C%20vector.y%2C%20vector.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bu%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bv%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20vector%5Bw%5D%20%3D%20depth3%20%3E%200%20%3F%201%20%3A%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20normals.push%28vector.x%2C%20vector.y%2C%20vector.z%29%3B%0A%20%20%20%20%20%20%20%20%20%20uvs.push%28ix%20%2F%20gridX%29%3B%0A%20%20%20%20%20%20%20%20%20%20uvs.push%281%20-%20iy%20%2F%20gridY%29%3B%0A%20%20%20%20%20%20%20%20%20%20vertexCounter%20%2B%3D%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%20gridY%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%20gridX%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20a2%20%3D%20numberOfVertices%20%2B%20ix%20%2B%20gridX1%20%2A%20iy%3B%0A%20%20%20%20%20%20%20%20%20%20const%20b%20%3D%20numberOfVertices%20%2B%20ix%20%2B%20gridX1%20%2A%20%28iy%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20c2%20%3D%20numberOfVertices%20%2B%20%28ix%20%2B%201%29%20%2B%20gridX1%20%2A%20%28iy%20%2B%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20d%20%3D%20numberOfVertices%20%2B%20%28ix%20%2B%201%29%20%2B%20gridX1%20%2A%20iy%3B%0A%20%20%20%20%20%20%20%20%20%20indices.push%28a2%2C%20b%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20%20%20indices.push%28b%2C%20c2%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20%20%20groupCount%20%2B%3D%206%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20scope.addGroup%28groupStart%2C%20groupCount%2C%20materialIndex%29%3B%0A%20%20%20%20%20%20groupStart%20%2B%3D%20groupCount%3B%0A%20%20%20%20%20%20numberOfVertices%20%2B%3D%20vertexCounter%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.parameters%20%3D%20Object.assign%28%7B%7D%2C%20source.parameters%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20static%20fromJSON%28data%29%20%7B%0A%20%20%20%20return%20new%20_BoxGeometry%28data.width%2C%20data.height%2C%20data.depth%2C%20data.widthSegments%2C%20data.heightSegments%2C%20data.depthSegments%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20cloneUniforms2%28src%29%20%7B%0A%20%20const%20dst%20%3D%20%7B%7D%3B%0A%20%20for%20%28const%20u%20in%20src%29%20%7B%0A%20%20%20%20dst%5Bu%5D%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20p%20in%20src%5Bu%5D%29%20%7B%0A%20%20%20%20%20%20const%20property2%20%3D%20src%5Bu%5D%5Bp%5D%3B%0A%20%20%20%20%20%20if%20%28property2%20%26%26%20%28property2.isColor%20%7C%7C%20property2.isMatrix3%20%7C%7C%20property2.isMatrix4%20%7C%7C%20property2.isVector2%20%7C%7C%20property2.isVector3%20%7C%7C%20property2.isVector4%20%7C%7C%20property2.isTexture%20%7C%7C%20property2.isQuaternion%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28property2.isRenderTargetTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22UniformsUtils%3A%20Textures%20of%20render%20targets%20cannot%20be%20cloned%20via%20cloneUniforms%28%29%20or%20mergeUniforms%28%29.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20dst%5Bu%5D%5Bp%5D%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20dst%5Bu%5D%5Bp%5D%20%3D%20property2.clone%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28Array.isArray%28property2%29%29%20%7B%0A%20%20%20%20%20%20%20%20dst%5Bu%5D%5Bp%5D%20%3D%20property2.slice%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20dst%5Bu%5D%5Bp%5D%20%3D%20property2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20dst%3B%0A%7D%0Afunction%20cloneUniformsGroups2%28src%29%20%7B%0A%20%20const%20dst%20%3D%20%5B%5D%3B%0A%20%20for%20%28let%20u%20%3D%200%3B%20u%20%3C%20src.length%3B%20u%2B%2B%29%20%7B%0A%20%20%20%20dst.push%28src%5Bu%5D.clone%28%29%29%3B%0A%20%20%7D%0A%20%20return%20dst%3B%0A%7D%0Avar%20default_vertex2%20%3D%20%28%0A%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%60%0Avoid%20main%28%29%20%7B%0A%09gl_Position%20%3D%20projectionMatrix%20%2A%20modelViewMatrix%20%2A%20vec4%28%20position%2C%201.0%20%29%3B%0A%7D%0A%60%0A%29%3B%0Avar%20default_fragment2%20%3D%20%28%0A%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%60%0Avoid%20main%28%29%20%7B%0A%09gl_FragColor%20%3D%20vec4%28%201.0%2C%200.0%2C%200.0%2C%201.0%20%29%3B%0A%7D%0A%60%0A%29%3B%0Avar%20ShaderMaterial2%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ShaderMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isShaderMaterial%20%3D%20true%3B%0A%20%20%20%20this.defines%20%3D%20%7B%7D%3B%0A%20%20%20%20this.uniforms%20%3D%20%7B%7D%3B%0A%20%20%20%20this.uniformsGroups%20%3D%20%5B%5D%3B%0A%20%20%20%20this.vertexShader%20%3D%20default_vertex2%3B%0A%20%20%20%20this.fragmentShader%20%3D%20default_fragment2%3B%0A%20%20%20%20this.linewidth%20%3D%201%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.fog%20%3D%20false%3B%0A%20%20%20%20this.lights%20%3D%20false%3B%0A%20%20%20%20this.clipping%20%3D%20false%3B%0A%20%20%20%20this.forceSinglePass%20%3D%20true%3B%0A%20%20%20%20this.extensions%20%3D%20%7B%0A%20%20%20%20%20%20clipCullDistance%3A%20false%2C%0A%20%20%20%20%20%20%2F%2F%20set%20to%20use%20vertex%20shader%20clipping%0A%20%20%20%20%20%20multiDraw%3A%20false%0A%20%20%20%20%20%20%2F%2F%20set%20to%20use%20vertex%20shader%20multi_draw%20%2F%20enable%20gl_DrawID%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.defaultAttributeValues%20%3D%20%7B%0A%20%20%20%20%20%20%22color%22%3A%20%5B1%2C%201%2C%201%5D%2C%0A%20%20%20%20%20%20%22uv%22%3A%20%5B0%2C%200%5D%2C%0A%20%20%20%20%20%20%22uv1%22%3A%20%5B0%2C%200%5D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.index0AttributeName%20%3D%20void%200%3B%0A%20%20%20%20this.uniformsNeedUpdate%20%3D%20false%3B%0A%20%20%20%20this.glslVersion%20%3D%20null%3B%0A%20%20%20%20if%20%28parameters%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.fragmentShader%20%3D%20source.fragmentShader%3B%0A%20%20%20%20this.vertexShader%20%3D%20source.vertexShader%3B%0A%20%20%20%20this.uniforms%20%3D%20cloneUniforms2%28source.uniforms%29%3B%0A%20%20%20%20this.uniformsGroups%20%3D%20cloneUniformsGroups2%28source.uniformsGroups%29%3B%0A%20%20%20%20this.defines%20%3D%20Object.assign%28%7B%7D%2C%20source.defines%29%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20this.lights%20%3D%20source.lights%3B%0A%20%20%20%20this.clipping%20%3D%20source.clipping%3B%0A%20%20%20%20this.extensions%20%3D%20Object.assign%28%7B%7D%2C%20source.extensions%29%3B%0A%20%20%20%20this.glslVersion%20%3D%20source.glslVersion%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.glslVersion%20%3D%20this.glslVersion%3B%0A%20%20%20%20data.uniforms%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20name%20in%20this.uniforms%29%20%7B%0A%20%20%20%20%20%20const%20uniform2%20%3D%20this.uniforms%5Bname%5D%3B%0A%20%20%20%20%20%20const%20value%20%3D%20uniform2.value%3B%0A%20%20%20%20%20%20if%20%28value%20%26%26%20value.isTexture%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22t%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toJSON%28meta%29.uuid%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22c%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.getHex%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isVector2%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22v2%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isVector3%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22v3%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isVector4%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22v4%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isMatrix3%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22m3%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%26%26%20value.isMatrix4%29%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22m4%22%2C%0A%20%20%20%20%20%20%20%20%20%20value%3A%20value.toArray%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20data.uniforms%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20value%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28Object.keys%28this.defines%29.length%20%3E%200%29%20data.defines%20%3D%20this.defines%3B%0A%20%20%20%20data.vertexShader%20%3D%20this.vertexShader%3B%0A%20%20%20%20data.fragmentShader%20%3D%20this.fragmentShader%3B%0A%20%20%20%20data.lights%20%3D%20this.lights%3B%0A%20%20%20%20data.clipping%20%3D%20this.clipping%3B%0A%20%20%20%20const%20extensions%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20key%20in%20this.extensions%29%20%7B%0A%20%20%20%20%20%20if%20%28this.extensions%5Bkey%5D%20%3D%3D%3D%20true%29%20extensions%5Bkey%5D%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28Object.keys%28extensions%29.length%20%3E%200%29%20data.extensions%20%3D%20extensions%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Camera2%20%3D%20class%20extends%20Object3D2%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isCamera%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Camera%22%3B%0A%20%20%20%20this.matrixWorldInverse%20%3D%20new%20Matrix42%28%29%3B%0A%20%20%20%20this.projectionMatrix%20%3D%20new%20Matrix42%28%29%3B%0A%20%20%20%20this.projectionMatrixInverse%20%3D%20new%20Matrix42%28%29%3B%0A%20%20%20%20this.coordinateSystem%20%3D%20WebGLCoordinateSystem2%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.matrixWorldInverse.copy%28source.matrixWorldInverse%29%3B%0A%20%20%20%20this.projectionMatrix.copy%28source.projectionMatrix%29%3B%0A%20%20%20%20this.projectionMatrixInverse.copy%28source.projectionMatrixInverse%29%3B%0A%20%20%20%20this.coordinateSystem%20%3D%20source.coordinateSystem%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getWorldDirection%28target%29%20%7B%0A%20%20%20%20return%20super.getWorldDirection%28target%29.negate%28%29%3B%0A%20%20%7D%0A%20%20updateMatrixWorld%28force%29%20%7B%0A%20%20%20%20super.updateMatrixWorld%28force%29%3B%0A%20%20%20%20this.matrixWorldInverse.copy%28this.matrixWorld%29.invert%28%29%3B%0A%20%20%7D%0A%20%20updateWorldMatrix%28updateParents%2C%20updateChildren%29%20%7B%0A%20%20%20%20super.updateWorldMatrix%28updateParents%2C%20updateChildren%29%3B%0A%20%20%20%20this.matrixWorldInverse.copy%28this.matrixWorld%29.invert%28%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_v3%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_minTarget2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector22%28%29%3B%0Avar%20_maxTarget2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector22%28%29%3B%0Avar%20PerspectiveCamera2%20%3D%20class%20extends%20Camera2%20%7B%0A%20%20constructor%28fov3%20%3D%2050%2C%20aspect3%20%3D%201%2C%20near%20%3D%200.1%2C%20far%20%3D%202e3%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isPerspectiveCamera%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22PerspectiveCamera%22%3B%0A%20%20%20%20this.fov%20%3D%20fov3%3B%0A%20%20%20%20this.zoom%20%3D%201%3B%0A%20%20%20%20this.near%20%3D%20near%3B%0A%20%20%20%20this.far%20%3D%20far%3B%0A%20%20%20%20this.focus%20%3D%2010%3B%0A%20%20%20%20this.aspect%20%3D%20aspect3%3B%0A%20%20%20%20this.view%20%3D%20null%3B%0A%20%20%20%20this.filmGauge%20%3D%2035%3B%0A%20%20%20%20this.filmOffset%20%3D%200%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.fov%20%3D%20source.fov%3B%0A%20%20%20%20this.zoom%20%3D%20source.zoom%3B%0A%20%20%20%20this.near%20%3D%20source.near%3B%0A%20%20%20%20this.far%20%3D%20source.far%3B%0A%20%20%20%20this.focus%20%3D%20source.focus%3B%0A%20%20%20%20this.aspect%20%3D%20source.aspect%3B%0A%20%20%20%20this.view%20%3D%20source.view%20%3D%3D%3D%20null%20%3F%20null%20%3A%20Object.assign%28%7B%7D%2C%20source.view%29%3B%0A%20%20%20%20this.filmGauge%20%3D%20source.filmGauge%3B%0A%20%20%20%20this.filmOffset%20%3D%20source.filmOffset%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Sets%20the%20FOV%20by%20focal%20length%20in%20respect%20to%20the%20current%20.filmGauge.%0A%20%20%20%2A%0A%20%20%20%2A%20The%20default%20film%20gauge%20is%2035%2C%20so%20that%20the%20focal%20length%20can%20be%20specified%20for%0A%20%20%20%2A%20a%2035mm%20%28full%20frame%29%20camera.%0A%20%20%20%2A%0A%20%20%20%2A%20Values%20for%20focal%20length%20and%20film%20gauge%20must%20have%20the%20same%20unit.%0A%20%20%20%2A%2F%0A%20%20setFocalLength%28focalLength%29%20%7B%0A%20%20%20%20const%20vExtentSlope%20%3D%200.5%20%2A%20this.getFilmHeight%28%29%20%2F%20focalLength%3B%0A%20%20%20%20this.fov%20%3D%20RAD2DEG2%20%2A%202%20%2A%20Math.atan%28vExtentSlope%29%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Calculates%20the%20focal%20length%20from%20the%20current%20.fov%20and%20.filmGauge.%0A%20%20%20%2A%2F%0A%20%20getFocalLength%28%29%20%7B%0A%20%20%20%20const%20vExtentSlope%20%3D%20Math.tan%28DEG2RAD2%20%2A%200.5%20%2A%20this.fov%29%3B%0A%20%20%20%20return%200.5%20%2A%20this.getFilmHeight%28%29%20%2F%20vExtentSlope%3B%0A%20%20%7D%0A%20%20getEffectiveFOV%28%29%20%7B%0A%20%20%20%20return%20RAD2DEG2%20%2A%202%20%2A%20Math.atan%28%0A%20%20%20%20%20%20Math.tan%28DEG2RAD2%20%2A%200.5%20%2A%20this.fov%29%20%2F%20this.zoom%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20getFilmWidth%28%29%20%7B%0A%20%20%20%20return%20this.filmGauge%20%2A%20Math.min%28this.aspect%2C%201%29%3B%0A%20%20%7D%0A%20%20getFilmHeight%28%29%20%7B%0A%20%20%20%20return%20this.filmGauge%20%2F%20Math.max%28this.aspect%2C%201%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Computes%20the%202D%20bounds%20of%20the%20camera%27s%20viewable%20rectangle%20at%20a%20given%20distance%20along%20the%20viewing%20direction.%0A%20%20%20%2A%20Sets%20minTarget%20and%20maxTarget%20to%20the%20coordinates%20of%20the%20lower-left%20and%20upper-right%20corners%20of%20the%20view%20rectangle.%0A%20%20%20%2A%2F%0A%20%20getViewBounds%28distance2%2C%20minTarget%2C%20maxTarget%29%20%7B%0A%20%20%20%20_v3%2412.set%28-1%2C%20-1%2C%200.5%29.applyMatrix4%28this.projectionMatrixInverse%29%3B%0A%20%20%20%20minTarget.set%28_v3%2412.x%2C%20_v3%2412.y%29.multiplyScalar%28-distance2%20%2F%20_v3%2412.z%29%3B%0A%20%20%20%20_v3%2412.set%281%2C%201%2C%200.5%29.applyMatrix4%28this.projectionMatrixInverse%29%3B%0A%20%20%20%20maxTarget.set%28_v3%2412.x%2C%20_v3%2412.y%29.multiplyScalar%28-distance2%20%2F%20_v3%2412.z%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Computes%20the%20width%20and%20height%20of%20the%20camera%27s%20viewable%20rectangle%20at%20a%20given%20distance%20along%20the%20viewing%20direction.%0A%20%20%20%2A%20Copies%20the%20result%20into%20the%20target%20Vector2%2C%20where%20x%20is%20width%20and%20y%20is%20height.%0A%20%20%20%2A%2F%0A%20%20getViewSize%28distance2%2C%20target%29%20%7B%0A%20%20%20%20this.getViewBounds%28distance2%2C%20_minTarget2%2C%20_maxTarget2%29%3B%0A%20%20%20%20return%20target.subVectors%28_maxTarget2%2C%20_minTarget2%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Sets%20an%20offset%20in%20a%20larger%20frustum.%20This%20is%20useful%20for%20multi-window%20or%0A%20%20%20%2A%20multi-monitor%2Fmulti-machine%20setups.%0A%20%20%20%2A%0A%20%20%20%2A%20For%20example%2C%20if%20you%20have%203x2%20monitors%20and%20each%20monitor%20is%201920x1080%20and%0A%20%20%20%2A%20the%20monitors%20are%20in%20grid%20like%20this%0A%20%20%20%2A%0A%20%20%20%2A%20%20%20%2B---%2B---%2B---%2B%0A%20%20%20%2A%20%20%20%7C%20A%20%7C%20B%20%7C%20C%20%7C%0A%20%20%20%2A%20%20%20%2B---%2B---%2B---%2B%0A%20%20%20%2A%20%20%20%7C%20D%20%7C%20E%20%7C%20F%20%7C%0A%20%20%20%2A%20%20%20%2B---%2B---%2B---%2B%0A%20%20%20%2A%0A%20%20%20%2A%20then%20for%20each%20monitor%20you%20would%20call%20it%20like%20this%0A%20%20%20%2A%0A%20%20%20%2A%20%20%20const%20w%20%3D%201920%3B%0A%20%20%20%2A%20%20%20const%20h%20%3D%201080%3B%0A%20%20%20%2A%20%20%20const%20fullWidth%20%3D%20w%20%2A%203%3B%0A%20%20%20%2A%20%20%20const%20fullHeight%20%3D%20h%20%2A%202%3B%0A%20%20%20%2A%0A%20%20%20%2A%20%20%20--A--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%200%2C%20h%20%2A%200%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--B--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%201%2C%20h%20%2A%200%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--C--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%202%2C%20h%20%2A%200%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--D--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%200%2C%20h%20%2A%201%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--E--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%201%2C%20h%20%2A%201%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%20%20%20--F--%0A%20%20%20%2A%20%20%20camera.setViewOffset%28%20fullWidth%2C%20fullHeight%2C%20w%20%2A%202%2C%20h%20%2A%201%2C%20w%2C%20h%20%29%3B%0A%20%20%20%2A%0A%20%20%20%2A%20%20%20Note%20there%20is%20no%20reason%20monitors%20have%20to%20be%20the%20same%20size%20or%20in%20a%20grid.%0A%20%20%20%2A%2F%0A%20%20setViewOffset%28fullWidth%2C%20fullHeight%2C%20x2%2C%20y2%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20this.aspect%20%3D%20fullWidth%20%2F%20fullHeight%3B%0A%20%20%20%20if%20%28this.view%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.view%20%3D%20%7B%0A%20%20%20%20%20%20%20%20enabled%3A%20true%2C%0A%20%20%20%20%20%20%20%20fullWidth%3A%201%2C%0A%20%20%20%20%20%20%20%20fullHeight%3A%201%2C%0A%20%20%20%20%20%20%20%20offsetX%3A%200%2C%0A%20%20%20%20%20%20%20%20offsetY%3A%200%2C%0A%20%20%20%20%20%20%20%20width%3A%201%2C%0A%20%20%20%20%20%20%20%20height%3A%201%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.view.enabled%20%3D%20true%3B%0A%20%20%20%20this.view.fullWidth%20%3D%20fullWidth%3B%0A%20%20%20%20this.view.fullHeight%20%3D%20fullHeight%3B%0A%20%20%20%20this.view.offsetX%20%3D%20x2%3B%0A%20%20%20%20this.view.offsetY%20%3D%20y2%3B%0A%20%20%20%20this.view.width%20%3D%20width%3B%0A%20%20%20%20this.view.height%20%3D%20height%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20clearViewOffset%28%29%20%7B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.view.enabled%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20updateProjectionMatrix%28%29%20%7B%0A%20%20%20%20const%20near%20%3D%20this.near%3B%0A%20%20%20%20let%20top%20%3D%20near%20%2A%20Math.tan%28DEG2RAD2%20%2A%200.5%20%2A%20this.fov%29%20%2F%20this.zoom%3B%0A%20%20%20%20let%20height%20%3D%202%20%2A%20top%3B%0A%20%20%20%20let%20width%20%3D%20this.aspect%20%2A%20height%3B%0A%20%20%20%20let%20left%20%3D%20-0.5%20%2A%20width%3B%0A%20%20%20%20const%20view%20%3D%20this.view%3B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%20%26%26%20this.view.enabled%29%20%7B%0A%20%20%20%20%20%20const%20fullWidth%20%3D%20view.fullWidth%2C%20fullHeight%20%3D%20view.fullHeight%3B%0A%20%20%20%20%20%20left%20%2B%3D%20view.offsetX%20%2A%20width%20%2F%20fullWidth%3B%0A%20%20%20%20%20%20top%20-%3D%20view.offsetY%20%2A%20height%20%2F%20fullHeight%3B%0A%20%20%20%20%20%20width%20%2A%3D%20view.width%20%2F%20fullWidth%3B%0A%20%20%20%20%20%20height%20%2A%3D%20view.height%20%2F%20fullHeight%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20skew%20%3D%20this.filmOffset%3B%0A%20%20%20%20if%20%28skew%20%21%3D%3D%200%29%20left%20%2B%3D%20near%20%2A%20skew%20%2F%20this.getFilmWidth%28%29%3B%0A%20%20%20%20this.projectionMatrix.makePerspective%28left%2C%20left%20%2B%20width%2C%20top%2C%20top%20-%20height%2C%20near%2C%20this.far%2C%20this.coordinateSystem%29%3B%0A%20%20%20%20this.projectionMatrixInverse.copy%28this.projectionMatrix%29.invert%28%29%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.object.fov%20%3D%20this.fov%3B%0A%20%20%20%20data.object.zoom%20%3D%20this.zoom%3B%0A%20%20%20%20data.object.near%20%3D%20this.near%3B%0A%20%20%20%20data.object.far%20%3D%20this.far%3B%0A%20%20%20%20data.object.focus%20%3D%20this.focus%3B%0A%20%20%20%20data.object.aspect%20%3D%20this.aspect%3B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%29%20data.object.view%20%3D%20Object.assign%28%7B%7D%2C%20this.view%29%3B%0A%20%20%20%20data.object.filmGauge%20%3D%20this.filmGauge%3B%0A%20%20%20%20data.object.filmOffset%20%3D%20this.filmOffset%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20fov2%20%3D%20-90%3B%0Avar%20aspect2%20%3D%201%3B%0Avar%20CubeCamera2%20%3D%20class%20extends%20Object3D2%20%7B%0A%20%20constructor%28near%2C%20far%2C%20renderTarget%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.type%20%3D%20%22CubeCamera%22%3B%0A%20%20%20%20this.renderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20this.coordinateSystem%20%3D%20null%3B%0A%20%20%20%20this.activeMipmapLevel%20%3D%200%3B%0A%20%20%20%20const%20cameraPX%20%3D%20new%20PerspectiveCamera2%28fov2%2C%20aspect2%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraPX.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraPX%29%3B%0A%20%20%20%20const%20cameraNX%20%3D%20new%20PerspectiveCamera2%28fov2%2C%20aspect2%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraNX.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraNX%29%3B%0A%20%20%20%20const%20cameraPY%20%3D%20new%20PerspectiveCamera2%28fov2%2C%20aspect2%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraPY.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraPY%29%3B%0A%20%20%20%20const%20cameraNY%20%3D%20new%20PerspectiveCamera2%28fov2%2C%20aspect2%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraNY.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraNY%29%3B%0A%20%20%20%20const%20cameraPZ%20%3D%20new%20PerspectiveCamera2%28fov2%2C%20aspect2%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraPZ.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraPZ%29%3B%0A%20%20%20%20const%20cameraNZ%20%3D%20new%20PerspectiveCamera2%28fov2%2C%20aspect2%2C%20near%2C%20far%29%3B%0A%20%20%20%20cameraNZ.layers%20%3D%20this.layers%3B%0A%20%20%20%20this.add%28cameraNZ%29%3B%0A%20%20%7D%0A%20%20updateCoordinateSystem%28%29%20%7B%0A%20%20%20%20const%20coordinateSystem%20%3D%20this.coordinateSystem%3B%0A%20%20%20%20const%20cameras%20%3D%20this.children.concat%28%29%3B%0A%20%20%20%20const%20%5BcameraPX%2C%20cameraNX%2C%20cameraPY%2C%20cameraNY%2C%20cameraPZ%2C%20cameraNZ%5D%20%3D%20cameras%3B%0A%20%20%20%20for%20%28const%20camera3%20of%20cameras%29%20this.remove%28camera3%29%3B%0A%20%20%20%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20cameraPX.up.set%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraPX.lookAt%281%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20cameraNX.up.set%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraNX.lookAt%28-1%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20cameraPY.up.set%280%2C%200%2C%20-1%29%3B%0A%20%20%20%20%20%20cameraPY.lookAt%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraNY.up.set%280%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20cameraNY.lookAt%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraPZ.up.set%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraPZ.lookAt%280%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20cameraNZ.up.set%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraNZ.lookAt%280%2C%200%2C%20-1%29%3B%0A%20%20%20%20%7D%20else%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20cameraPX.up.set%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraPX.lookAt%28-1%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20cameraNX.up.set%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraNX.lookAt%281%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20cameraPY.up.set%280%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20cameraPY.lookAt%280%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20cameraNY.up.set%280%2C%200%2C%20-1%29%3B%0A%20%20%20%20%20%20cameraNY.lookAt%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraPZ.up.set%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraPZ.lookAt%280%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20cameraNZ.up.set%280%2C%20-1%2C%200%29%3B%0A%20%20%20%20%20%20cameraNZ.lookAt%280%2C%200%2C%20-1%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.CubeCamera.updateCoordinateSystem%28%29%3A%20Invalid%20coordinate%20system%3A%20%22%20%2B%20coordinateSystem%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28const%20camera3%20of%20cameras%29%20%7B%0A%20%20%20%20%20%20this.add%28camera3%29%3B%0A%20%20%20%20%20%20camera3.updateMatrixWorld%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%28renderer3%2C%20scene3%29%20%7B%0A%20%20%20%20if%20%28this.parent%20%3D%3D%3D%20null%29%20this.updateMatrixWorld%28%29%3B%0A%20%20%20%20const%20%7B%20renderTarget%2C%20activeMipmapLevel%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28this.coordinateSystem%20%21%3D%3D%20renderer3.coordinateSystem%29%20%7B%0A%20%20%20%20%20%20this.coordinateSystem%20%3D%20renderer3.coordinateSystem%3B%0A%20%20%20%20%20%20this.updateCoordinateSystem%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20%5BcameraPX%2C%20cameraNX%2C%20cameraPY%2C%20cameraNY%2C%20cameraPZ%2C%20cameraNZ%5D%20%3D%20this.children%3B%0A%20%20%20%20const%20currentRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20const%20currentActiveCubeFace%20%3D%20renderer3.getActiveCubeFace%28%29%3B%0A%20%20%20%20const%20currentActiveMipmapLevel%20%3D%20renderer3.getActiveMipmapLevel%28%29%3B%0A%20%20%20%20const%20currentXrEnabled%20%3D%20renderer3.xr.enabled%3B%0A%20%20%20%20renderer3.xr.enabled%20%3D%20false%3B%0A%20%20%20%20const%20generateMipmaps%20%3D%20renderTarget.texture.generateMipmaps%3B%0A%20%20%20%20renderTarget.texture.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%200%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraPX%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%201%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraNX%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%202%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraPY%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%203%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraNY%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%204%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraPZ%29%3B%0A%20%20%20%20renderTarget.texture.generateMipmaps%20%3D%20generateMipmaps%3B%0A%20%20%20%20renderer3.setRenderTarget%28renderTarget%2C%205%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20cameraNZ%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28currentRenderTarget%2C%20currentActiveCubeFace%2C%20currentActiveMipmapLevel%29%3B%0A%20%20%20%20renderer3.xr.enabled%20%3D%20currentXrEnabled%3B%0A%20%20%20%20renderTarget.texture.needsPMREMUpdate%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20CubeTexture2%20%3D%20class%20extends%20Texture2%20%7B%0A%20%20constructor%28images%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%2C%20minFilter%2C%20format2%2C%20type%2C%20anisotropy2%2C%20colorSpace%29%20%7B%0A%20%20%20%20images%20%3D%20images%20%21%3D%3D%20void%200%20%3F%20images%20%3A%20%5B%5D%3B%0A%20%20%20%20mapping%20%3D%20mapping%20%21%3D%3D%20void%200%20%3F%20mapping%20%3A%20CubeReflectionMapping2%3B%0A%20%20%20%20super%28images%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%2C%20minFilter%2C%20format2%2C%20type%2C%20anisotropy2%2C%20colorSpace%29%3B%0A%20%20%20%20this.isCubeTexture%20%3D%20true%3B%0A%20%20%20%20this.flipY%20%3D%20false%3B%0A%20%20%7D%0A%20%20get%20images%28%29%20%7B%0A%20%20%20%20return%20this.image%3B%0A%20%20%7D%0A%20%20set%20images%28value%29%20%7B%0A%20%20%20%20this.image%20%3D%20value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGLCubeRenderTarget2%20%3D%20class%20extends%20WebGLRenderTarget2%20%7B%0A%20%20constructor%28size%20%3D%201%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28size%2C%20size%2C%20options%29%3B%0A%20%20%20%20this.isWebGLCubeRenderTarget%20%3D%20true%3B%0A%20%20%20%20const%20image%20%3D%20%7B%20width%3A%20size%2C%20height%3A%20size%2C%20depth%3A%201%20%7D%3B%0A%20%20%20%20const%20images%20%3D%20%5Bimage%2C%20image%2C%20image%2C%20image%2C%20image%2C%20image%5D%3B%0A%20%20%20%20this.texture%20%3D%20new%20CubeTexture2%28images%2C%20options.mapping%2C%20options.wrapS%2C%20options.wrapT%2C%20options.magFilter%2C%20options.minFilter%2C%20options.format%2C%20options.type%2C%20options.anisotropy%2C%20options.colorSpace%29%3B%0A%20%20%20%20this.texture.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20this.texture.generateMipmaps%20%3D%20options.generateMipmaps%20%21%3D%3D%20void%200%20%3F%20options.generateMipmaps%20%3A%20false%3B%0A%20%20%20%20this.texture.minFilter%20%3D%20options.minFilter%20%21%3D%3D%20void%200%20%3F%20options.minFilter%20%3A%20LinearFilter2%3B%0A%20%20%7D%0A%20%20fromEquirectangularTexture%28renderer3%2C%20texture2%29%20%7B%0A%20%20%20%20this.texture.type%20%3D%20texture2.type%3B%0A%20%20%20%20this.texture.colorSpace%20%3D%20texture2.colorSpace%3B%0A%20%20%20%20this.texture.generateMipmaps%20%3D%20texture2.generateMipmaps%3B%0A%20%20%20%20this.texture.minFilter%20%3D%20texture2.minFilter%3B%0A%20%20%20%20this.texture.magFilter%20%3D%20texture2.magFilter%3B%0A%20%20%20%20const%20shader%20%3D%20%7B%0A%20%20%20%20%20%20uniforms%3A%20%7B%0A%20%20%20%20%20%20%20%20tEquirect%3A%20%7B%20value%3A%20null%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20vertexShader%3A%20%28%0A%20%20%20%20%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%20%20%20%20%60%0A%0A%09%09%09%09varying%20vec3%20vWorldDirection%3B%0A%0A%09%09%09%09vec3%20transformDirection%28%20in%20vec3%20dir%2C%20in%20mat4%20matrix%20%29%20%7B%0A%0A%09%09%09%09%09return%20normalize%28%20%28%20matrix%20%2A%20vec4%28%20dir%2C%200.0%20%29%20%29.xyz%20%29%3B%0A%0A%09%09%09%09%7D%0A%0A%09%09%09%09void%20main%28%29%20%7B%0A%0A%09%09%09%09%09vWorldDirection%20%3D%20transformDirection%28%20position%2C%20modelMatrix%20%29%3B%0A%0A%09%09%09%09%09%23include%20%3Cbegin_vertex%3E%0A%09%09%09%09%09%23include%20%3Cproject_vertex%3E%0A%0A%09%09%09%09%7D%0A%09%09%09%60%0A%20%20%20%20%20%20%29%2C%0A%20%20%20%20%20%20fragmentShader%3A%20%28%0A%20%20%20%20%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%20%20%20%20%60%0A%0A%09%09%09%09uniform%20sampler2D%20tEquirect%3B%0A%0A%09%09%09%09varying%20vec3%20vWorldDirection%3B%0A%0A%09%09%09%09%23include%20%3Ccommon%3E%0A%0A%09%09%09%09void%20main%28%29%20%7B%0A%0A%09%09%09%09%09vec3%20direction%20%3D%20normalize%28%20vWorldDirection%20%29%3B%0A%0A%09%09%09%09%09vec2%20sampleUV%20%3D%20equirectUv%28%20direction%20%29%3B%0A%0A%09%09%09%09%09gl_FragColor%20%3D%20texture2D%28%20tEquirect%2C%20sampleUV%20%29%3B%0A%0A%09%09%09%09%7D%0A%09%09%09%60%0A%20%20%20%20%20%20%29%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20geometry%20%3D%20new%20BoxGeometry2%285%2C%205%2C%205%29%3B%0A%20%20%20%20const%20material%20%3D%20new%20ShaderMaterial2%28%7B%0A%20%20%20%20%20%20name%3A%20%22CubemapFromEquirect%22%2C%0A%20%20%20%20%20%20uniforms%3A%20cloneUniforms2%28shader.uniforms%29%2C%0A%20%20%20%20%20%20vertexShader%3A%20shader.vertexShader%2C%0A%20%20%20%20%20%20fragmentShader%3A%20shader.fragmentShader%2C%0A%20%20%20%20%20%20side%3A%20BackSide2%2C%0A%20%20%20%20%20%20blending%3A%20NoBlending2%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20material.uniforms.tEquirect.value%20%3D%20texture2%3B%0A%20%20%20%20const%20mesh%20%3D%20new%20Mesh2%28geometry%2C%20material%29%3B%0A%20%20%20%20const%20currentMinFilter%20%3D%20texture2.minFilter%3B%0A%20%20%20%20if%20%28texture2.minFilter%20%3D%3D%3D%20LinearMipmapLinearFilter2%29%20texture2.minFilter%20%3D%20LinearFilter2%3B%0A%20%20%20%20const%20camera3%20%3D%20new%20CubeCamera2%281%2C%2010%2C%20this%29%3B%0A%20%20%20%20camera3.update%28renderer3%2C%20mesh%29%3B%0A%20%20%20%20texture2.minFilter%20%3D%20currentMinFilter%3B%0A%20%20%20%20mesh.geometry.dispose%28%29%3B%0A%20%20%20%20mesh.material.dispose%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clear%28renderer3%2C%20color2%2C%20depth2%2C%20stencil%29%20%7B%0A%20%20%20%20const%20currentRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20renderer3.setRenderTarget%28this%2C%20i%29%3B%0A%20%20%20%20%20%20renderer3.clear%28color2%2C%20depth2%2C%20stencil%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.setRenderTarget%28currentRenderTarget%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Scene2%20%3D%20class%20extends%20Object3D2%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isScene%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Scene%22%3B%0A%20%20%20%20this.background%20%3D%20null%3B%0A%20%20%20%20this.environment%20%3D%20null%3B%0A%20%20%20%20this.fog%20%3D%20null%3B%0A%20%20%20%20this.backgroundBlurriness%20%3D%200%3B%0A%20%20%20%20this.backgroundIntensity%20%3D%201%3B%0A%20%20%20%20this.backgroundRotation%20%3D%20new%20Euler2%28%29%3B%0A%20%20%20%20this.environmentIntensity%20%3D%201%3B%0A%20%20%20%20this.environmentRotation%20%3D%20new%20Euler2%28%29%3B%0A%20%20%20%20this.overrideMaterial%20%3D%20null%3B%0A%20%20%20%20if%20%28typeof%20__THREE_DEVTOOLS__%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20%20%20%20%20__THREE_DEVTOOLS__.dispatchEvent%28new%20CustomEvent%28%22observe%22%2C%20%7B%20detail%3A%20this%20%7D%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20if%20%28source.background%20%21%3D%3D%20null%29%20this.background%20%3D%20source.background.clone%28%29%3B%0A%20%20%20%20if%20%28source.environment%20%21%3D%3D%20null%29%20this.environment%20%3D%20source.environment.clone%28%29%3B%0A%20%20%20%20if%20%28source.fog%20%21%3D%3D%20null%29%20this.fog%20%3D%20source.fog.clone%28%29%3B%0A%20%20%20%20this.backgroundBlurriness%20%3D%20source.backgroundBlurriness%3B%0A%20%20%20%20this.backgroundIntensity%20%3D%20source.backgroundIntensity%3B%0A%20%20%20%20this.backgroundRotation.copy%28source.backgroundRotation%29%3B%0A%20%20%20%20this.environmentIntensity%20%3D%20source.environmentIntensity%3B%0A%20%20%20%20this.environmentRotation.copy%28source.environmentRotation%29%3B%0A%20%20%20%20if%20%28source.overrideMaterial%20%21%3D%3D%20null%29%20this.overrideMaterial%20%3D%20source.overrideMaterial.clone%28%29%3B%0A%20%20%20%20this.matrixAutoUpdate%20%3D%20source.matrixAutoUpdate%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20if%20%28this.fog%20%21%3D%3D%20null%29%20data.object.fog%20%3D%20this.fog.toJSON%28%29%3B%0A%20%20%20%20if%20%28this.backgroundBlurriness%20%3E%200%29%20data.object.backgroundBlurriness%20%3D%20this.backgroundBlurriness%3B%0A%20%20%20%20if%20%28this.backgroundIntensity%20%21%3D%3D%201%29%20data.object.backgroundIntensity%20%3D%20this.backgroundIntensity%3B%0A%20%20%20%20data.object.backgroundRotation%20%3D%20this.backgroundRotation.toArray%28%29%3B%0A%20%20%20%20if%20%28this.environmentIntensity%20%21%3D%3D%201%29%20data.object.environmentIntensity%20%3D%20this.environmentIntensity%3B%0A%20%20%20%20data.object.environmentRotation%20%3D%20this.environmentRotation.toArray%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20InterleavedBuffer%20%3D%20class%20%7B%0A%20%20constructor%28array%2C%20stride%29%20%7B%0A%20%20%20%20this.isInterleavedBuffer%20%3D%20true%3B%0A%20%20%20%20this.array%20%3D%20array%3B%0A%20%20%20%20this.stride%20%3D%20stride%3B%0A%20%20%20%20this.count%20%3D%20array%20%21%3D%3D%20void%200%20%3F%20array.length%20%2F%20stride%20%3A%200%3B%0A%20%20%20%20this.usage%20%3D%20StaticDrawUsage2%3B%0A%20%20%20%20this.updateRanges%20%3D%20%5B%5D%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%20%20this.uuid%20%3D%20generateUUID2%28%29%3B%0A%20%20%7D%0A%20%20onUploadCallback%28%29%20%7B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20this.version%2B%2B%3B%0A%20%20%7D%0A%20%20setUsage%28value%29%20%7B%0A%20%20%20%20this.usage%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addUpdateRange%28start%2C%20count%29%20%7B%0A%20%20%20%20this.updateRanges.push%28%7B%20start%2C%20count%20%7D%29%3B%0A%20%20%7D%0A%20%20clearUpdateRanges%28%29%20%7B%0A%20%20%20%20this.updateRanges.length%20%3D%200%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.array%20%3D%20new%20source.array.constructor%28source.array%29%3B%0A%20%20%20%20this.count%20%3D%20source.count%3B%0A%20%20%20%20this.stride%20%3D%20source.stride%3B%0A%20%20%20%20this.usage%20%3D%20source.usage%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copyAt%28index1%2C%20attribute2%2C%20index22%29%20%7B%0A%20%20%20%20index1%20%2A%3D%20this.stride%3B%0A%20%20%20%20index22%20%2A%3D%20attribute2.stride%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.stride%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.array%5Bindex1%20%2B%20i%5D%20%3D%20attribute2.array%5Bindex22%20%2B%20i%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20set%28value%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20this.array.set%28value%2C%20offset%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28data%29%20%7B%0A%20%20%20%20if%20%28data.arrayBuffers%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20data.arrayBuffers%20%3D%20%7B%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.array.buffer._uuid%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.array.buffer._uuid%20%3D%20generateUUID2%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28data.arrayBuffers%5Bthis.array.buffer._uuid%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20data.arrayBuffers%5Bthis.array.buffer._uuid%5D%20%3D%20this.array.slice%280%29.buffer%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20array%20%3D%20new%20this.array.constructor%28data.arrayBuffers%5Bthis.array.buffer._uuid%5D%29%3B%0A%20%20%20%20const%20ib%20%3D%20new%20this.constructor%28array%2C%20this.stride%29%3B%0A%20%20%20%20ib.setUsage%28this.usage%29%3B%0A%20%20%20%20return%20ib%3B%0A%20%20%7D%0A%20%20onUpload%28callback%29%20%7B%0A%20%20%20%20this.onUploadCallback%20%3D%20callback%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28data%29%20%7B%0A%20%20%20%20if%20%28data.arrayBuffers%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20data.arrayBuffers%20%3D%20%7B%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.array.buffer._uuid%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.array.buffer._uuid%20%3D%20generateUUID2%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28data.arrayBuffers%5Bthis.array.buffer._uuid%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20data.arrayBuffers%5Bthis.array.buffer._uuid%5D%20%3D%20Array.from%28new%20Uint32Array%28this.array.buffer%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20uuid%3A%20this.uuid%2C%0A%20%20%20%20%20%20buffer%3A%20this.array.buffer._uuid%2C%0A%20%20%20%20%20%20type%3A%20this.array.constructor.name%2C%0A%20%20%20%20%20%20stride%3A%20this.stride%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_vector%2472%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20InterleavedBufferAttribute%20%3D%20class%20_InterleavedBufferAttribute%20%7B%0A%20%20constructor%28interleavedBuffer%2C%20itemSize%2C%20offset%2C%20normalized%20%3D%20false%29%20%7B%0A%20%20%20%20this.isInterleavedBufferAttribute%20%3D%20true%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.data%20%3D%20interleavedBuffer%3B%0A%20%20%20%20this.itemSize%20%3D%20itemSize%3B%0A%20%20%20%20this.offset%20%3D%20offset%3B%0A%20%20%20%20this.normalized%20%3D%20normalized%3B%0A%20%20%7D%0A%20%20get%20count%28%29%20%7B%0A%20%20%20%20return%20this.data.count%3B%0A%20%20%7D%0A%20%20get%20array%28%29%20%7B%0A%20%20%20%20return%20this.data.array%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20this.data.needsUpdate%20%3D%20value%3B%0A%20%20%7D%0A%20%20applyMatrix4%28m2%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.data.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%2472.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%2472.applyMatrix4%28m2%29%3B%0A%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%2472.x%2C%20_vector%2472.y%2C%20_vector%2472.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20applyNormalMatrix%28m2%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%2472.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%2472.applyNormalMatrix%28m2%29%3B%0A%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%2472.x%2C%20_vector%2472.y%2C%20_vector%2472.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20transformDirection%28m2%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.count%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_vector%2472.fromBufferAttribute%28this%2C%20i%29%3B%0A%20%20%20%20%20%20_vector%2472.transformDirection%28m2%29%3B%0A%20%20%20%20%20%20this.setXYZ%28i%2C%20_vector%2472.x%2C%20_vector%2472.y%2C%20_vector%2472.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getComponent%28index5%2C%20component%29%20%7B%0A%20%20%20%20let%20value%20%3D%20this.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%20%2B%20component%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20value%20%3D%20denormalize2%28value%2C%20this.array%29%3B%0A%20%20%20%20return%20value%3B%0A%20%20%7D%0A%20%20setComponent%28index5%2C%20component%2C%20value%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20value%20%3D%20normalize%241%28value%2C%20this.array%29%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%20%2B%20component%5D%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setX%28index5%2C%20x2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%5D%20%3D%20x2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setY%28index5%2C%20y2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setZ%28index5%2C%20z2%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20z2%20%3D%20normalize%241%28z2%2C%20this.array%29%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%20%2B%202%5D%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setW%28index5%2C%20w%29%20%7B%0A%20%20%20%20if%20%28this.normalized%29%20w%20%3D%20normalize%241%28w%2C%20this.array%29%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%20%2B%203%5D%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getX%28index5%29%20%7B%0A%20%20%20%20let%20x2%20%3D%20this.data.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20x2%20%3D%20denormalize2%28x2%2C%20this.array%29%3B%0A%20%20%20%20return%20x2%3B%0A%20%20%7D%0A%20%20getY%28index5%29%20%7B%0A%20%20%20%20let%20y2%20%3D%20this.data.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%20%2B%201%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20y2%20%3D%20denormalize2%28y2%2C%20this.array%29%3B%0A%20%20%20%20return%20y2%3B%0A%20%20%7D%0A%20%20getZ%28index5%29%20%7B%0A%20%20%20%20let%20z2%20%3D%20this.data.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%20%2B%202%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20z2%20%3D%20denormalize2%28z2%2C%20this.array%29%3B%0A%20%20%20%20return%20z2%3B%0A%20%20%7D%0A%20%20getW%28index5%29%20%7B%0A%20%20%20%20let%20w%20%3D%20this.data.array%5Bindex5%20%2A%20this.data.stride%20%2B%20this.offset%20%2B%203%5D%3B%0A%20%20%20%20if%20%28this.normalized%29%20w%20%3D%20denormalize2%28w%2C%20this.array%29%3B%0A%20%20%20%20return%20w%3B%0A%20%20%7D%0A%20%20setXY%28index5%2C%20x2%2C%20y2%29%20%7B%0A%20%20%20%20index5%20%3D%20index5%20%2A%20this.data.stride%20%2B%20this.offset%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.data.array%5Bindex5%20%2B%200%5D%20%3D%20x2%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXYZ%28index5%2C%20x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20index5%20%3D%20index5%20%2A%20this.data.stride%20%2B%20this.offset%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20%20%20z2%20%3D%20normalize%241%28z2%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.data.array%5Bindex5%20%2B%200%5D%20%3D%20x2%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2B%202%5D%20%3D%20z2%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setXYZW%28index5%2C%20x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20index5%20%3D%20index5%20%2A%20this.data.stride%20%2B%20this.offset%3B%0A%20%20%20%20if%20%28this.normalized%29%20%7B%0A%20%20%20%20%20%20x2%20%3D%20normalize%241%28x2%2C%20this.array%29%3B%0A%20%20%20%20%20%20y2%20%3D%20normalize%241%28y2%2C%20this.array%29%3B%0A%20%20%20%20%20%20z2%20%3D%20normalize%241%28z2%2C%20this.array%29%3B%0A%20%20%20%20%20%20w%20%3D%20normalize%241%28w%2C%20this.array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.data.array%5Bindex5%20%2B%200%5D%20%3D%20x2%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2B%201%5D%20%3D%20y2%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2B%202%5D%20%3D%20z2%3B%0A%20%20%20%20this.data.array%5Bindex5%20%2B%203%5D%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28data%29%20%7B%0A%20%20%20%20if%20%28data%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20console.log%28%22THREE.InterleavedBufferAttribute.clone%28%29%3A%20Cloning%20an%20interleaved%20buffer%20attribute%20will%20de-interleave%20buffer%20data.%22%29%3B%0A%20%20%20%20%20%20const%20array%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this.count%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20index5%20%3D%20i%20%2A%20this.data.stride%20%2B%20this.offset%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20this.itemSize%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20array.push%28this.data.array%5Bindex5%20%2B%20j%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20new%20BufferAttribute2%28new%20this.array.constructor%28array%29%2C%20this.itemSize%2C%20this.normalized%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28data.interleavedBuffers%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20data.interleavedBuffers%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28data.interleavedBuffers%5Bthis.data.uuid%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20data.interleavedBuffers%5Bthis.data.uuid%5D%20%3D%20this.data.clone%28data%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20new%20_InterleavedBufferAttribute%28data.interleavedBuffers%5Bthis.data.uuid%5D%2C%20this.itemSize%2C%20this.offset%2C%20this.normalized%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20toJSON%28data%29%20%7B%0A%20%20%20%20if%20%28data%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20console.log%28%22THREE.InterleavedBufferAttribute.toJSON%28%29%3A%20Serializing%20an%20interleaved%20buffer%20attribute%20will%20de-interleave%20buffer%20data.%22%29%3B%0A%20%20%20%20%20%20const%20array%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this.count%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20index5%20%3D%20i%20%2A%20this.data.stride%20%2B%20this.offset%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20this.itemSize%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20array.push%28this.data.array%5Bindex5%20%2B%20j%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20itemSize%3A%20this.itemSize%2C%0A%20%20%20%20%20%20%20%20type%3A%20this.array.constructor.name%2C%0A%20%20%20%20%20%20%20%20array%2C%0A%20%20%20%20%20%20%20%20normalized%3A%20this.normalized%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28data.interleavedBuffers%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20data.interleavedBuffers%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28data.interleavedBuffers%5Bthis.data.uuid%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20data.interleavedBuffers%5Bthis.data.uuid%5D%20%3D%20this.data.toJSON%28data%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20isInterleavedBufferAttribute%3A%20true%2C%0A%20%20%20%20%20%20%20%20itemSize%3A%20this.itemSize%2C%0A%20%20%20%20%20%20%20%20data%3A%20this.data.uuid%2C%0A%20%20%20%20%20%20%20%20offset%3A%20this.offset%2C%0A%20%20%20%20%20%20%20%20normalized%3A%20this.normalized%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20SpriteMaterial%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22SpriteMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isSpriteMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%2816777215%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.rotation%20%3D%200%3B%0A%20%20%20%20this.sizeAttenuation%20%3D%20true%3B%0A%20%20%20%20this.transparent%20%3D%20true%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.rotation%20%3D%20source.rotation%3B%0A%20%20%20%20this.sizeAttenuation%20%3D%20source.sizeAttenuation%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DataTexture%20%3D%20class%20extends%20Texture2%20%7B%0A%20%20constructor%28data%20%3D%20null%2C%20width%20%3D%201%2C%20height%20%3D%201%2C%20format2%2C%20type%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%20%3D%20NearestFilter2%2C%20minFilter%20%3D%20NearestFilter2%2C%20anisotropy2%2C%20colorSpace%29%20%7B%0A%20%20%20%20super%28null%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%2C%20minFilter%2C%20format2%2C%20type%2C%20anisotropy2%2C%20colorSpace%29%3B%0A%20%20%20%20this.isDataTexture%20%3D%20true%3B%0A%20%20%20%20this.image%20%3D%20%7B%20data%2C%20width%2C%20height%20%7D%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20this.flipY%20%3D%20false%3B%0A%20%20%20%20this.unpackAlignment%20%3D%201%3B%0A%20%20%7D%0A%7D%3B%0Avar%20InstancedBufferAttribute%20%3D%20class%20extends%20BufferAttribute2%20%7B%0A%20%20constructor%28array%2C%20itemSize%2C%20normalized%2C%20meshPerAttribute%20%3D%201%29%20%7B%0A%20%20%20%20super%28array%2C%20itemSize%2C%20normalized%29%3B%0A%20%20%20%20this.isInstancedBufferAttribute%20%3D%20true%3B%0A%20%20%20%20this.meshPerAttribute%20%3D%20meshPerAttribute%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.meshPerAttribute%20%3D%20source.meshPerAttribute%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28%29%3B%0A%20%20%20%20data.meshPerAttribute%20%3D%20this.meshPerAttribute%3B%0A%20%20%20%20data.isInstancedBufferAttribute%20%3D%20true%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_vector12%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_vector22%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_normalMatrix2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix32%28%29%3B%0Avar%20Plane2%20%3D%20class%20%7B%0A%20%20constructor%28normal2%20%3D%20new%20Vector32%281%2C%200%2C%200%29%2C%20constant%20%3D%200%29%20%7B%0A%20%20%20%20this.isPlane%20%3D%20true%3B%0A%20%20%20%20this.normal%20%3D%20normal2%3B%0A%20%20%20%20this.constant%20%3D%20constant%3B%0A%20%20%7D%0A%20%20set%28normal2%2C%20constant%29%20%7B%0A%20%20%20%20this.normal.copy%28normal2%29%3B%0A%20%20%20%20this.constant%20%3D%20constant%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setComponents%28x2%2C%20y2%2C%20z2%2C%20w%29%20%7B%0A%20%20%20%20this.normal.set%28x2%2C%20y2%2C%20z2%29%3B%0A%20%20%20%20this.constant%20%3D%20w%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromNormalAndCoplanarPoint%28normal2%2C%20point%29%20%7B%0A%20%20%20%20this.normal.copy%28normal2%29%3B%0A%20%20%20%20this.constant%20%3D%20-point.dot%28this.normal%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromCoplanarPoints%28a2%2C%20b%2C%20c2%29%20%7B%0A%20%20%20%20const%20normal2%20%3D%20_vector12.subVectors%28c2%2C%20b%29.cross%28_vector22.subVectors%28a2%2C%20b%29%29.normalize%28%29%3B%0A%20%20%20%20this.setFromNormalAndCoplanarPoint%28normal2%2C%20a2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28plane%29%20%7B%0A%20%20%20%20this.normal.copy%28plane.normal%29%3B%0A%20%20%20%20this.constant%20%3D%20plane.constant%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20normalize%28%29%20%7B%0A%20%20%20%20const%20inverseNormalLength%20%3D%201%20%2F%20this.normal.length%28%29%3B%0A%20%20%20%20this.normal.multiplyScalar%28inverseNormalLength%29%3B%0A%20%20%20%20this.constant%20%2A%3D%20inverseNormalLength%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20negate%28%29%20%7B%0A%20%20%20%20this.constant%20%2A%3D%20-1%3B%0A%20%20%20%20this.normal.negate%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20distanceToPoint%28point%29%20%7B%0A%20%20%20%20return%20this.normal.dot%28point%29%20%2B%20this.constant%3B%0A%20%20%7D%0A%20%20distanceToSphere%28sphere%29%20%7B%0A%20%20%20%20return%20this.distanceToPoint%28sphere.center%29%20-%20sphere.radius%3B%0A%20%20%7D%0A%20%20projectPoint%28point%2C%20target%29%20%7B%0A%20%20%20%20return%20target.copy%28point%29.addScaledVector%28this.normal%2C%20-this.distanceToPoint%28point%29%29%3B%0A%20%20%7D%0A%20%20intersectLine%28line%2C%20target%29%20%7B%0A%20%20%20%20const%20direction2%20%3D%20line.delta%28_vector12%29%3B%0A%20%20%20%20const%20denominator%20%3D%20this.normal.dot%28direction2%29%3B%0A%20%20%20%20if%20%28denominator%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28this.distanceToPoint%28line.start%29%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20target.copy%28line.start%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20t%20%3D%20-%28line.start.dot%28this.normal%29%20%2B%20this.constant%29%20%2F%20denominator%3B%0A%20%20%20%20if%20%28t%20%3C%200%20%7C%7C%20t%20%3E%201%29%20%7B%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target.copy%28line.start%29.addScaledVector%28direction2%2C%20t%29%3B%0A%20%20%7D%0A%20%20intersectsLine%28line%29%20%7B%0A%20%20%20%20const%20startSign%20%3D%20this.distanceToPoint%28line.start%29%3B%0A%20%20%20%20const%20endSign%20%3D%20this.distanceToPoint%28line.end%29%3B%0A%20%20%20%20return%20startSign%20%3C%200%20%26%26%20endSign%20%3E%200%20%7C%7C%20endSign%20%3C%200%20%26%26%20startSign%20%3E%200%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20return%20box.intersectsPlane%28this%29%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20return%20sphere.intersectsPlane%28this%29%3B%0A%20%20%7D%0A%20%20coplanarPoint%28target%29%20%7B%0A%20%20%20%20return%20target.copy%28this.normal%29.multiplyScalar%28-this.constant%29%3B%0A%20%20%7D%0A%20%20applyMatrix4%28matrix%2C%20optionalNormalMatrix%29%20%7B%0A%20%20%20%20const%20normalMatrix%20%3D%20optionalNormalMatrix%20%7C%7C%20_normalMatrix2.getNormalMatrix%28matrix%29%3B%0A%20%20%20%20const%20referencePoint%20%3D%20this.coplanarPoint%28_vector12%29.applyMatrix4%28matrix%29%3B%0A%20%20%20%20const%20normal2%20%3D%20this.normal.applyMatrix3%28normalMatrix%29.normalize%28%29%3B%0A%20%20%20%20this.constant%20%3D%20-referencePoint.dot%28normal2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20translate%28offset%29%20%7B%0A%20%20%20%20this.constant%20-%3D%20offset.dot%28this.normal%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28plane%29%20%7B%0A%20%20%20%20return%20plane.normal.equals%28this.normal%29%20%26%26%20plane.constant%20%3D%3D%3D%20this.constant%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_sphere%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Sphere2%28%29%3B%0Avar%20_vector%246%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20Frustum2%20%3D%20class%20%7B%0A%20%20constructor%28p0%20%3D%20new%20Plane2%28%29%2C%20p1%20%3D%20new%20Plane2%28%29%2C%20p2%20%3D%20new%20Plane2%28%29%2C%20p3%20%3D%20new%20Plane2%28%29%2C%20p4%20%3D%20new%20Plane2%28%29%2C%20p5%20%3D%20new%20Plane2%28%29%29%20%7B%0A%20%20%20%20this.planes%20%3D%20%5Bp0%2C%20p1%2C%20p2%2C%20p3%2C%20p4%2C%20p5%5D%3B%0A%20%20%7D%0A%20%20set%28p0%2C%20p1%2C%20p2%2C%20p3%2C%20p4%2C%20p5%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20planes%5B0%5D.copy%28p0%29%3B%0A%20%20%20%20planes%5B1%5D.copy%28p1%29%3B%0A%20%20%20%20planes%5B2%5D.copy%28p2%29%3B%0A%20%20%20%20planes%5B3%5D.copy%28p3%29%3B%0A%20%20%20%20planes%5B4%5D.copy%28p4%29%3B%0A%20%20%20%20planes%5B5%5D.copy%28p5%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20copy%28frustum%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20planes%5Bi%5D.copy%28frustum.planes%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setFromProjectionMatrix%28m2%2C%20coordinateSystem%20%3D%20WebGLCoordinateSystem2%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20const%20me%20%3D%20m2.elements%3B%0A%20%20%20%20const%20me0%20%3D%20me%5B0%5D%2C%20me1%20%3D%20me%5B1%5D%2C%20me2%20%3D%20me%5B2%5D%2C%20me3%20%3D%20me%5B3%5D%3B%0A%20%20%20%20const%20me4%20%3D%20me%5B4%5D%2C%20me5%20%3D%20me%5B5%5D%2C%20me6%20%3D%20me%5B6%5D%2C%20me7%20%3D%20me%5B7%5D%3B%0A%20%20%20%20const%20me8%20%3D%20me%5B8%5D%2C%20me9%20%3D%20me%5B9%5D%2C%20me10%20%3D%20me%5B10%5D%2C%20me11%20%3D%20me%5B11%5D%3B%0A%20%20%20%20const%20me12%20%3D%20me%5B12%5D%2C%20me13%20%3D%20me%5B13%5D%2C%20me14%20%3D%20me%5B14%5D%2C%20me15%20%3D%20me%5B15%5D%3B%0A%20%20%20%20planes%5B0%5D.setComponents%28me3%20-%20me0%2C%20me7%20-%20me4%2C%20me11%20-%20me8%2C%20me15%20-%20me12%29.normalize%28%29%3B%0A%20%20%20%20planes%5B1%5D.setComponents%28me3%20%2B%20me0%2C%20me7%20%2B%20me4%2C%20me11%20%2B%20me8%2C%20me15%20%2B%20me12%29.normalize%28%29%3B%0A%20%20%20%20planes%5B2%5D.setComponents%28me3%20%2B%20me1%2C%20me7%20%2B%20me5%2C%20me11%20%2B%20me9%2C%20me15%20%2B%20me13%29.normalize%28%29%3B%0A%20%20%20%20planes%5B3%5D.setComponents%28me3%20-%20me1%2C%20me7%20-%20me5%2C%20me11%20-%20me9%2C%20me15%20-%20me13%29.normalize%28%29%3B%0A%20%20%20%20planes%5B4%5D.setComponents%28me3%20-%20me2%2C%20me7%20-%20me6%2C%20me11%20-%20me10%2C%20me15%20-%20me14%29.normalize%28%29%3B%0A%20%20%20%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20planes%5B5%5D.setComponents%28me3%20%2B%20me2%2C%20me7%20%2B%20me6%2C%20me11%20%2B%20me10%2C%20me15%20%2B%20me14%29.normalize%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20planes%5B5%5D.setComponents%28me2%2C%20me6%2C%20me10%2C%20me14%29.normalize%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.Frustum.setFromProjectionMatrix%28%29%3A%20Invalid%20coordinate%20system%3A%20%22%20%2B%20coordinateSystem%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20intersectsObject%28object%29%20%7B%0A%20%20%20%20if%20%28object.boundingSphere%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28object.boundingSphere%20%3D%3D%3D%20null%29%20object.computeBoundingSphere%28%29%3B%0A%20%20%20%20%20%20_sphere%243.copy%28object.boundingSphere%29.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20geometry%20%3D%20object.geometry%3B%0A%20%20%20%20%20%20if%20%28geometry.boundingSphere%20%3D%3D%3D%20null%29%20geometry.computeBoundingSphere%28%29%3B%0A%20%20%20%20%20%20_sphere%243.copy%28geometry.boundingSphere%29.applyMatrix4%28object.matrixWorld%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.intersectsSphere%28_sphere%243%29%3B%0A%20%20%7D%0A%20%20intersectsSprite%28sprite%29%20%7B%0A%20%20%20%20_sphere%243.center.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20_sphere%243.radius%20%3D%200.7071067811865476%3B%0A%20%20%20%20_sphere%243.applyMatrix4%28sprite.matrixWorld%29%3B%0A%20%20%20%20return%20this.intersectsSphere%28_sphere%243%29%3B%0A%20%20%7D%0A%20%20intersectsSphere%28sphere%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20const%20center%20%3D%20sphere.center%3B%0A%20%20%20%20const%20negRadius%20%3D%20-sphere.radius%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20distance2%20%3D%20planes%5Bi%5D.distanceToPoint%28center%29%3B%0A%20%20%20%20%20%20if%20%28distance2%20%3C%20negRadius%29%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20intersectsBox%28box%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20plane%20%3D%20planes%5Bi%5D%3B%0A%20%20%20%20%20%20_vector%246.x%20%3D%20plane.normal.x%20%3E%200%20%3F%20box.max.x%20%3A%20box.min.x%3B%0A%20%20%20%20%20%20_vector%246.y%20%3D%20plane.normal.y%20%3E%200%20%3F%20box.max.y%20%3A%20box.min.y%3B%0A%20%20%20%20%20%20_vector%246.z%20%3D%20plane.normal.z%20%3E%200%20%3F%20box.max.z%20%3A%20box.min.z%3B%0A%20%20%20%20%20%20if%20%28plane.distanceToPoint%28_vector%246%29%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20containsPoint%28point%29%20%7B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28planes%5Bi%5D.distanceToPoint%28point%29%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LineBasicMaterial2%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LineBasicMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLineBasicMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%2816777215%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.linewidth%20%3D%201%3B%0A%20%20%20%20this.linecap%20%3D%20%22round%22%3B%0A%20%20%20%20this.linejoin%20%3D%20%22round%22%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.linewidth%20%3D%20source.linewidth%3B%0A%20%20%20%20this.linecap%20%3D%20source.linecap%3B%0A%20%20%20%20this.linejoin%20%3D%20source.linejoin%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20PointsMaterial%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22PointsMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isPointsMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%2816777215%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.size%20%3D%201%3B%0A%20%20%20%20this.sizeAttenuation%20%3D%20true%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.size%20%3D%20source.size%3B%0A%20%20%20%20this.sizeAttenuation%20%3D%20source.sizeAttenuation%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20FramebufferTexture%20%3D%20class%20extends%20Texture2%20%7B%0A%20%20constructor%28width%2C%20height%29%20%7B%0A%20%20%20%20super%28%7B%20width%2C%20height%20%7D%29%3B%0A%20%20%20%20this.isFramebufferTexture%20%3D%20true%3B%0A%20%20%20%20this.magFilter%20%3D%20NearestFilter2%3B%0A%20%20%20%20this.minFilter%20%3D%20NearestFilter2%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20this.needsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DepthTexture2%20%3D%20class%20extends%20Texture2%20%7B%0A%20%20constructor%28width%2C%20height%2C%20type%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%2C%20minFilter%2C%20anisotropy2%2C%20format2%20%3D%20DepthFormat2%29%20%7B%0A%20%20%20%20if%20%28format2%20%21%3D%3D%20DepthFormat2%20%26%26%20format2%20%21%3D%3D%20DepthStencilFormat2%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22DepthTexture%20format%20must%20be%20either%20THREE.DepthFormat%20or%20THREE.DepthStencilFormat%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20void%200%20%26%26%20format2%20%3D%3D%3D%20DepthFormat2%29%20type%20%3D%20UnsignedIntType2%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20void%200%20%26%26%20format2%20%3D%3D%3D%20DepthStencilFormat2%29%20type%20%3D%20UnsignedInt248Type2%3B%0A%20%20%20%20super%28null%2C%20mapping%2C%20wrapS%2C%20wrapT%2C%20magFilter%2C%20minFilter%2C%20format2%2C%20type%2C%20anisotropy2%29%3B%0A%20%20%20%20this.isDepthTexture%20%3D%20true%3B%0A%20%20%20%20this.image%20%3D%20%7B%20width%2C%20height%20%7D%3B%0A%20%20%20%20this.magFilter%20%3D%20magFilter%20%21%3D%3D%20void%200%20%3F%20magFilter%20%3A%20NearestFilter2%3B%0A%20%20%20%20this.minFilter%20%3D%20minFilter%20%21%3D%3D%20void%200%20%3F%20minFilter%20%3A%20NearestFilter2%3B%0A%20%20%20%20this.flipY%20%3D%20false%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20this.compareFunction%20%3D%20null%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.compareFunction%20%3D%20source.compareFunction%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20if%20%28this.compareFunction%20%21%3D%3D%20null%29%20data.compareFunction%20%3D%20this.compareFunction%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20SphereGeometry2%20%3D%20class%20_SphereGeometry%20extends%20BufferGeometry2%20%7B%0A%20%20constructor%28radius%20%3D%201%2C%20widthSegments%20%3D%2032%2C%20heightSegments%20%3D%2016%2C%20phiStart%20%3D%200%2C%20phiLength%20%3D%20Math.PI%20%2A%202%2C%20thetaStart%20%3D%200%2C%20thetaLength%20%3D%20Math.PI%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.type%20%3D%20%22SphereGeometry%22%3B%0A%20%20%20%20this.parameters%20%3D%20%7B%0A%20%20%20%20%20%20radius%2C%0A%20%20%20%20%20%20widthSegments%2C%0A%20%20%20%20%20%20heightSegments%2C%0A%20%20%20%20%20%20phiStart%2C%0A%20%20%20%20%20%20phiLength%2C%0A%20%20%20%20%20%20thetaStart%2C%0A%20%20%20%20%20%20thetaLength%0A%20%20%20%20%7D%3B%0A%20%20%20%20widthSegments%20%3D%20Math.max%283%2C%20Math.floor%28widthSegments%29%29%3B%0A%20%20%20%20heightSegments%20%3D%20Math.max%282%2C%20Math.floor%28heightSegments%29%29%3B%0A%20%20%20%20const%20thetaEnd%20%3D%20Math.min%28thetaStart%20%2B%20thetaLength%2C%20Math.PI%29%3B%0A%20%20%20%20let%20index5%20%3D%200%3B%0A%20%20%20%20const%20grid%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vertex2%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20const%20normal2%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20const%20indices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vertices%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20normals%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20uvs%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%3D%20heightSegments%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20verticesRow%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20const%20v%20%3D%20iy%20%2F%20heightSegments%3B%0A%20%20%20%20%20%20let%20uOffset%20%3D%200%3B%0A%20%20%20%20%20%20if%20%28iy%20%3D%3D%3D%200%20%26%26%20thetaStart%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20uOffset%20%3D%200.5%20%2F%20widthSegments%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28iy%20%3D%3D%3D%20heightSegments%20%26%26%20thetaEnd%20%3D%3D%3D%20Math.PI%29%20%7B%0A%20%20%20%20%20%20%20%20uOffset%20%3D%20-0.5%20%2F%20widthSegments%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%3D%20widthSegments%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20u%20%3D%20ix%20%2F%20widthSegments%3B%0A%20%20%20%20%20%20%20%20vertex2.x%20%3D%20-radius%20%2A%20Math.cos%28phiStart%20%2B%20u%20%2A%20phiLength%29%20%2A%20Math.sin%28thetaStart%20%2B%20v%20%2A%20thetaLength%29%3B%0A%20%20%20%20%20%20%20%20vertex2.y%20%3D%20radius%20%2A%20Math.cos%28thetaStart%20%2B%20v%20%2A%20thetaLength%29%3B%0A%20%20%20%20%20%20%20%20vertex2.z%20%3D%20radius%20%2A%20Math.sin%28phiStart%20%2B%20u%20%2A%20phiLength%29%20%2A%20Math.sin%28thetaStart%20%2B%20v%20%2A%20thetaLength%29%3B%0A%20%20%20%20%20%20%20%20vertices.push%28vertex2.x%2C%20vertex2.y%2C%20vertex2.z%29%3B%0A%20%20%20%20%20%20%20%20normal2.copy%28vertex2%29.normalize%28%29%3B%0A%20%20%20%20%20%20%20%20normals.push%28normal2.x%2C%20normal2.y%2C%20normal2.z%29%3B%0A%20%20%20%20%20%20%20%20uvs.push%28u%20%2B%20uOffset%2C%201%20-%20v%29%3B%0A%20%20%20%20%20%20%20%20verticesRow.push%28index5%2B%2B%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20grid.push%28verticesRow%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20iy%20%3D%200%3B%20iy%20%3C%20heightSegments%3B%20iy%2B%2B%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20ix%20%3D%200%3B%20ix%20%3C%20widthSegments%3B%20ix%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20a2%20%3D%20grid%5Biy%5D%5Bix%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20const%20b%20%3D%20grid%5Biy%5D%5Bix%5D%3B%0A%20%20%20%20%20%20%20%20const%20c2%20%3D%20grid%5Biy%20%2B%201%5D%5Bix%5D%3B%0A%20%20%20%20%20%20%20%20const%20d%20%3D%20grid%5Biy%20%2B%201%5D%5Bix%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28iy%20%21%3D%3D%200%20%7C%7C%20thetaStart%20%3E%200%29%20indices.push%28a2%2C%20b%2C%20d%29%3B%0A%20%20%20%20%20%20%20%20if%20%28iy%20%21%3D%3D%20heightSegments%20-%201%20%7C%7C%20thetaEnd%20%3C%20Math.PI%29%20indices.push%28b%2C%20c2%2C%20d%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.setIndex%28indices%29%3B%0A%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute2%28vertices%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22normal%22%2C%20new%20Float32BufferAttribute2%28normals%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22uv%22%2C%20new%20Float32BufferAttribute2%28uvs%2C%202%29%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.parameters%20%3D%20Object.assign%28%7B%7D%2C%20source.parameters%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20static%20fromJSON%28data%29%20%7B%0A%20%20%20%20return%20new%20_SphereGeometry%28data.radius%2C%20data.widthSegments%2C%20data.heightSegments%2C%20data.phiStart%2C%20data.phiLength%2C%20data.thetaStart%2C%20data.thetaLength%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ShadowMaterial%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ShadowMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isShadowMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%280%29%3B%0A%20%20%20%20this.transparent%20%3D%20true%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshStandardMaterial%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshStandardMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshStandardMaterial%20%3D%20true%3B%0A%20%20%20%20this.defines%20%3D%20%7B%20%22STANDARD%22%3A%20%22%22%20%7D%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%2816777215%29%3B%0A%20%20%20%20this.roughness%20%3D%201%3B%0A%20%20%20%20this.metalness%20%3D%200%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.lightMap%20%3D%20null%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%201%3B%0A%20%20%20%20this.aoMap%20%3D%20null%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%201%3B%0A%20%20%20%20this.emissive%20%3D%20new%20Color2%280%29%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%201%3B%0A%20%20%20%20this.emissiveMap%20%3D%20null%3B%0A%20%20%20%20this.bumpMap%20%3D%20null%3B%0A%20%20%20%20this.bumpScale%20%3D%201%3B%0A%20%20%20%20this.normalMap%20%3D%20null%3B%0A%20%20%20%20this.normalMapType%20%3D%20TangentSpaceNormalMap2%3B%0A%20%20%20%20this.normalScale%20%3D%20new%20Vector22%281%2C%201%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20null%3B%0A%20%20%20%20this.displacementScale%20%3D%201%3B%0A%20%20%20%20this.displacementBias%20%3D%200%3B%0A%20%20%20%20this.roughnessMap%20%3D%20null%3B%0A%20%20%20%20this.metalnessMap%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.envMap%20%3D%20null%3B%0A%20%20%20%20this.envMapRotation%20%3D%20new%20Euler2%28%29%3B%0A%20%20%20%20this.envMapIntensity%20%3D%201%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20%22round%22%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20%22round%22%3B%0A%20%20%20%20this.flatShading%20%3D%20false%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.defines%20%3D%20%7B%20%22STANDARD%22%3A%20%22%22%20%7D%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.roughness%20%3D%20source.roughness%3B%0A%20%20%20%20this.metalness%20%3D%20source.metalness%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.lightMap%20%3D%20source.lightMap%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%20source.lightMapIntensity%3B%0A%20%20%20%20this.aoMap%20%3D%20source.aoMap%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%20source.aoMapIntensity%3B%0A%20%20%20%20this.emissive.copy%28source.emissive%29%3B%0A%20%20%20%20this.emissiveMap%20%3D%20source.emissiveMap%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%20source.emissiveIntensity%3B%0A%20%20%20%20this.bumpMap%20%3D%20source.bumpMap%3B%0A%20%20%20%20this.bumpScale%20%3D%20source.bumpScale%3B%0A%20%20%20%20this.normalMap%20%3D%20source.normalMap%3B%0A%20%20%20%20this.normalMapType%20%3D%20source.normalMapType%3B%0A%20%20%20%20this.normalScale.copy%28source.normalScale%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20source.displacementMap%3B%0A%20%20%20%20this.displacementScale%20%3D%20source.displacementScale%3B%0A%20%20%20%20this.displacementBias%20%3D%20source.displacementBias%3B%0A%20%20%20%20this.roughnessMap%20%3D%20source.roughnessMap%3B%0A%20%20%20%20this.metalnessMap%20%3D%20source.metalnessMap%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.envMap%20%3D%20source.envMap%3B%0A%20%20%20%20this.envMapRotation.copy%28source.envMapRotation%29%3B%0A%20%20%20%20this.envMapIntensity%20%3D%20source.envMapIntensity%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20source.wireframeLinecap%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20source.wireframeLinejoin%3B%0A%20%20%20%20this.flatShading%20%3D%20source.flatShading%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshPhysicalMaterial%20%3D%20class%20extends%20MeshStandardMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshPhysicalMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshPhysicalMaterial%20%3D%20true%3B%0A%20%20%20%20this.defines%20%3D%20%7B%0A%20%20%20%20%20%20%22STANDARD%22%3A%20%22%22%2C%0A%20%20%20%20%20%20%22PHYSICAL%22%3A%20%22%22%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.anisotropyRotation%20%3D%200%3B%0A%20%20%20%20this.anisotropyMap%20%3D%20null%3B%0A%20%20%20%20this.clearcoatMap%20%3D%20null%3B%0A%20%20%20%20this.clearcoatRoughness%20%3D%200%3B%0A%20%20%20%20this.clearcoatRoughnessMap%20%3D%20null%3B%0A%20%20%20%20this.clearcoatNormalScale%20%3D%20new%20Vector22%281%2C%201%29%3B%0A%20%20%20%20this.clearcoatNormalMap%20%3D%20null%3B%0A%20%20%20%20this.ior%20%3D%201.5%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22reflectivity%22%2C%20%7B%0A%20%20%20%20%20%20get%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20clamp%241%282.5%20%2A%20%28this.ior%20-%201%29%20%2F%20%28this.ior%20%2B%201%29%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20set%3A%20function%28reflectivity%29%20%7B%0A%20%20%20%20%20%20%20%20this.ior%20%3D%20%281%20%2B%200.4%20%2A%20reflectivity%29%20%2F%20%281%20-%200.4%20%2A%20reflectivity%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.iridescenceMap%20%3D%20null%3B%0A%20%20%20%20this.iridescenceIOR%20%3D%201.3%3B%0A%20%20%20%20this.iridescenceThicknessRange%20%3D%20%5B100%2C%20400%5D%3B%0A%20%20%20%20this.iridescenceThicknessMap%20%3D%20null%3B%0A%20%20%20%20this.sheenColor%20%3D%20new%20Color2%280%29%3B%0A%20%20%20%20this.sheenColorMap%20%3D%20null%3B%0A%20%20%20%20this.sheenRoughness%20%3D%201%3B%0A%20%20%20%20this.sheenRoughnessMap%20%3D%20null%3B%0A%20%20%20%20this.transmissionMap%20%3D%20null%3B%0A%20%20%20%20this.thickness%20%3D%200%3B%0A%20%20%20%20this.thicknessMap%20%3D%20null%3B%0A%20%20%20%20this.attenuationDistance%20%3D%20Infinity%3B%0A%20%20%20%20this.attenuationColor%20%3D%20new%20Color2%281%2C%201%2C%201%29%3B%0A%20%20%20%20this.specularIntensity%20%3D%201%3B%0A%20%20%20%20this.specularIntensityMap%20%3D%20null%3B%0A%20%20%20%20this.specularColor%20%3D%20new%20Color2%281%2C%201%2C%201%29%3B%0A%20%20%20%20this.specularColorMap%20%3D%20null%3B%0A%20%20%20%20this._anisotropy%20%3D%200%3B%0A%20%20%20%20this._clearcoat%20%3D%200%3B%0A%20%20%20%20this._dispersion%20%3D%200%3B%0A%20%20%20%20this._iridescence%20%3D%200%3B%0A%20%20%20%20this._sheen%20%3D%200%3B%0A%20%20%20%20this._transmission%20%3D%200%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20get%20anisotropy%28%29%20%7B%0A%20%20%20%20return%20this._anisotropy%3B%0A%20%20%7D%0A%20%20set%20anisotropy%28value%29%20%7B%0A%20%20%20%20if%20%28this._anisotropy%20%3E%200%20%21%3D%3D%20value%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._anisotropy%20%3D%20value%3B%0A%20%20%7D%0A%20%20get%20clearcoat%28%29%20%7B%0A%20%20%20%20return%20this._clearcoat%3B%0A%20%20%7D%0A%20%20set%20clearcoat%28value%29%20%7B%0A%20%20%20%20if%20%28this._clearcoat%20%3E%200%20%21%3D%3D%20value%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._clearcoat%20%3D%20value%3B%0A%20%20%7D%0A%20%20get%20iridescence%28%29%20%7B%0A%20%20%20%20return%20this._iridescence%3B%0A%20%20%7D%0A%20%20set%20iridescence%28value%29%20%7B%0A%20%20%20%20if%20%28this._iridescence%20%3E%200%20%21%3D%3D%20value%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._iridescence%20%3D%20value%3B%0A%20%20%7D%0A%20%20get%20dispersion%28%29%20%7B%0A%20%20%20%20return%20this._dispersion%3B%0A%20%20%7D%0A%20%20set%20dispersion%28value%29%20%7B%0A%20%20%20%20if%20%28this._dispersion%20%3E%200%20%21%3D%3D%20value%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._dispersion%20%3D%20value%3B%0A%20%20%7D%0A%20%20get%20sheen%28%29%20%7B%0A%20%20%20%20return%20this._sheen%3B%0A%20%20%7D%0A%20%20set%20sheen%28value%29%20%7B%0A%20%20%20%20if%20%28this._sheen%20%3E%200%20%21%3D%3D%20value%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._sheen%20%3D%20value%3B%0A%20%20%7D%0A%20%20get%20transmission%28%29%20%7B%0A%20%20%20%20return%20this._transmission%3B%0A%20%20%7D%0A%20%20set%20transmission%28value%29%20%7B%0A%20%20%20%20if%20%28this._transmission%20%3E%200%20%21%3D%3D%20value%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._transmission%20%3D%20value%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.defines%20%3D%20%7B%0A%20%20%20%20%20%20%22STANDARD%22%3A%20%22%22%2C%0A%20%20%20%20%20%20%22PHYSICAL%22%3A%20%22%22%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.anisotropy%20%3D%20source.anisotropy%3B%0A%20%20%20%20this.anisotropyRotation%20%3D%20source.anisotropyRotation%3B%0A%20%20%20%20this.anisotropyMap%20%3D%20source.anisotropyMap%3B%0A%20%20%20%20this.clearcoat%20%3D%20source.clearcoat%3B%0A%20%20%20%20this.clearcoatMap%20%3D%20source.clearcoatMap%3B%0A%20%20%20%20this.clearcoatRoughness%20%3D%20source.clearcoatRoughness%3B%0A%20%20%20%20this.clearcoatRoughnessMap%20%3D%20source.clearcoatRoughnessMap%3B%0A%20%20%20%20this.clearcoatNormalMap%20%3D%20source.clearcoatNormalMap%3B%0A%20%20%20%20this.clearcoatNormalScale.copy%28source.clearcoatNormalScale%29%3B%0A%20%20%20%20this.dispersion%20%3D%20source.dispersion%3B%0A%20%20%20%20this.ior%20%3D%20source.ior%3B%0A%20%20%20%20this.iridescence%20%3D%20source.iridescence%3B%0A%20%20%20%20this.iridescenceMap%20%3D%20source.iridescenceMap%3B%0A%20%20%20%20this.iridescenceIOR%20%3D%20source.iridescenceIOR%3B%0A%20%20%20%20this.iridescenceThicknessRange%20%3D%20%5B...source.iridescenceThicknessRange%5D%3B%0A%20%20%20%20this.iridescenceThicknessMap%20%3D%20source.iridescenceThicknessMap%3B%0A%20%20%20%20this.sheen%20%3D%20source.sheen%3B%0A%20%20%20%20this.sheenColor.copy%28source.sheenColor%29%3B%0A%20%20%20%20this.sheenColorMap%20%3D%20source.sheenColorMap%3B%0A%20%20%20%20this.sheenRoughness%20%3D%20source.sheenRoughness%3B%0A%20%20%20%20this.sheenRoughnessMap%20%3D%20source.sheenRoughnessMap%3B%0A%20%20%20%20this.transmission%20%3D%20source.transmission%3B%0A%20%20%20%20this.transmissionMap%20%3D%20source.transmissionMap%3B%0A%20%20%20%20this.thickness%20%3D%20source.thickness%3B%0A%20%20%20%20this.thicknessMap%20%3D%20source.thicknessMap%3B%0A%20%20%20%20this.attenuationDistance%20%3D%20source.attenuationDistance%3B%0A%20%20%20%20this.attenuationColor.copy%28source.attenuationColor%29%3B%0A%20%20%20%20this.specularIntensity%20%3D%20source.specularIntensity%3B%0A%20%20%20%20this.specularIntensityMap%20%3D%20source.specularIntensityMap%3B%0A%20%20%20%20this.specularColor.copy%28source.specularColor%29%3B%0A%20%20%20%20this.specularColorMap%20%3D%20source.specularColorMap%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshPhongMaterial%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshPhongMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshPhongMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%2816777215%29%3B%0A%20%20%20%20this.specular%20%3D%20new%20Color2%281118481%29%3B%0A%20%20%20%20this.shininess%20%3D%2030%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.lightMap%20%3D%20null%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%201%3B%0A%20%20%20%20this.aoMap%20%3D%20null%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%201%3B%0A%20%20%20%20this.emissive%20%3D%20new%20Color2%280%29%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%201%3B%0A%20%20%20%20this.emissiveMap%20%3D%20null%3B%0A%20%20%20%20this.bumpMap%20%3D%20null%3B%0A%20%20%20%20this.bumpScale%20%3D%201%3B%0A%20%20%20%20this.normalMap%20%3D%20null%3B%0A%20%20%20%20this.normalMapType%20%3D%20TangentSpaceNormalMap2%3B%0A%20%20%20%20this.normalScale%20%3D%20new%20Vector22%281%2C%201%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20null%3B%0A%20%20%20%20this.displacementScale%20%3D%201%3B%0A%20%20%20%20this.displacementBias%20%3D%200%3B%0A%20%20%20%20this.specularMap%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.envMap%20%3D%20null%3B%0A%20%20%20%20this.envMapRotation%20%3D%20new%20Euler2%28%29%3B%0A%20%20%20%20this.combine%20%3D%20MultiplyOperation2%3B%0A%20%20%20%20this.reflectivity%20%3D%201%3B%0A%20%20%20%20this.refractionRatio%20%3D%200.98%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20%22round%22%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20%22round%22%3B%0A%20%20%20%20this.flatShading%20%3D%20false%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.specular.copy%28source.specular%29%3B%0A%20%20%20%20this.shininess%20%3D%20source.shininess%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.lightMap%20%3D%20source.lightMap%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%20source.lightMapIntensity%3B%0A%20%20%20%20this.aoMap%20%3D%20source.aoMap%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%20source.aoMapIntensity%3B%0A%20%20%20%20this.emissive.copy%28source.emissive%29%3B%0A%20%20%20%20this.emissiveMap%20%3D%20source.emissiveMap%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%20source.emissiveIntensity%3B%0A%20%20%20%20this.bumpMap%20%3D%20source.bumpMap%3B%0A%20%20%20%20this.bumpScale%20%3D%20source.bumpScale%3B%0A%20%20%20%20this.normalMap%20%3D%20source.normalMap%3B%0A%20%20%20%20this.normalMapType%20%3D%20source.normalMapType%3B%0A%20%20%20%20this.normalScale.copy%28source.normalScale%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20source.displacementMap%3B%0A%20%20%20%20this.displacementScale%20%3D%20source.displacementScale%3B%0A%20%20%20%20this.displacementBias%20%3D%20source.displacementBias%3B%0A%20%20%20%20this.specularMap%20%3D%20source.specularMap%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.envMap%20%3D%20source.envMap%3B%0A%20%20%20%20this.envMapRotation.copy%28source.envMapRotation%29%3B%0A%20%20%20%20this.combine%20%3D%20source.combine%3B%0A%20%20%20%20this.reflectivity%20%3D%20source.reflectivity%3B%0A%20%20%20%20this.refractionRatio%20%3D%20source.refractionRatio%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20source.wireframeLinecap%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20source.wireframeLinejoin%3B%0A%20%20%20%20this.flatShading%20%3D%20source.flatShading%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshToonMaterial%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshToonMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshToonMaterial%20%3D%20true%3B%0A%20%20%20%20this.defines%20%3D%20%7B%20%22TOON%22%3A%20%22%22%20%7D%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%2816777215%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.gradientMap%20%3D%20null%3B%0A%20%20%20%20this.lightMap%20%3D%20null%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%201%3B%0A%20%20%20%20this.aoMap%20%3D%20null%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%201%3B%0A%20%20%20%20this.emissive%20%3D%20new%20Color2%280%29%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%201%3B%0A%20%20%20%20this.emissiveMap%20%3D%20null%3B%0A%20%20%20%20this.bumpMap%20%3D%20null%3B%0A%20%20%20%20this.bumpScale%20%3D%201%3B%0A%20%20%20%20this.normalMap%20%3D%20null%3B%0A%20%20%20%20this.normalMapType%20%3D%20TangentSpaceNormalMap2%3B%0A%20%20%20%20this.normalScale%20%3D%20new%20Vector22%281%2C%201%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20null%3B%0A%20%20%20%20this.displacementScale%20%3D%201%3B%0A%20%20%20%20this.displacementBias%20%3D%200%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20%22round%22%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20%22round%22%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.gradientMap%20%3D%20source.gradientMap%3B%0A%20%20%20%20this.lightMap%20%3D%20source.lightMap%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%20source.lightMapIntensity%3B%0A%20%20%20%20this.aoMap%20%3D%20source.aoMap%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%20source.aoMapIntensity%3B%0A%20%20%20%20this.emissive.copy%28source.emissive%29%3B%0A%20%20%20%20this.emissiveMap%20%3D%20source.emissiveMap%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%20source.emissiveIntensity%3B%0A%20%20%20%20this.bumpMap%20%3D%20source.bumpMap%3B%0A%20%20%20%20this.bumpScale%20%3D%20source.bumpScale%3B%0A%20%20%20%20this.normalMap%20%3D%20source.normalMap%3B%0A%20%20%20%20this.normalMapType%20%3D%20source.normalMapType%3B%0A%20%20%20%20this.normalScale.copy%28source.normalScale%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20source.displacementMap%3B%0A%20%20%20%20this.displacementScale%20%3D%20source.displacementScale%3B%0A%20%20%20%20this.displacementBias%20%3D%20source.displacementBias%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20source.wireframeLinecap%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20source.wireframeLinejoin%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshNormalMaterial%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshNormalMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshNormalMaterial%20%3D%20true%3B%0A%20%20%20%20this.bumpMap%20%3D%20null%3B%0A%20%20%20%20this.bumpScale%20%3D%201%3B%0A%20%20%20%20this.normalMap%20%3D%20null%3B%0A%20%20%20%20this.normalMapType%20%3D%20TangentSpaceNormalMap2%3B%0A%20%20%20%20this.normalScale%20%3D%20new%20Vector22%281%2C%201%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20null%3B%0A%20%20%20%20this.displacementScale%20%3D%201%3B%0A%20%20%20%20this.displacementBias%20%3D%200%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.flatShading%20%3D%20false%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.bumpMap%20%3D%20source.bumpMap%3B%0A%20%20%20%20this.bumpScale%20%3D%20source.bumpScale%3B%0A%20%20%20%20this.normalMap%20%3D%20source.normalMap%3B%0A%20%20%20%20this.normalMapType%20%3D%20source.normalMapType%3B%0A%20%20%20%20this.normalScale.copy%28source.normalScale%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20source.displacementMap%3B%0A%20%20%20%20this.displacementScale%20%3D%20source.displacementScale%3B%0A%20%20%20%20this.displacementBias%20%3D%20source.displacementBias%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.flatShading%20%3D%20source.flatShading%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshLambertMaterial2%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshLambertMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshLambertMaterial%20%3D%20true%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%2816777215%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.lightMap%20%3D%20null%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%201%3B%0A%20%20%20%20this.aoMap%20%3D%20null%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%201%3B%0A%20%20%20%20this.emissive%20%3D%20new%20Color2%280%29%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%201%3B%0A%20%20%20%20this.emissiveMap%20%3D%20null%3B%0A%20%20%20%20this.bumpMap%20%3D%20null%3B%0A%20%20%20%20this.bumpScale%20%3D%201%3B%0A%20%20%20%20this.normalMap%20%3D%20null%3B%0A%20%20%20%20this.normalMapType%20%3D%20TangentSpaceNormalMap2%3B%0A%20%20%20%20this.normalScale%20%3D%20new%20Vector22%281%2C%201%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20null%3B%0A%20%20%20%20this.displacementScale%20%3D%201%3B%0A%20%20%20%20this.displacementBias%20%3D%200%3B%0A%20%20%20%20this.specularMap%20%3D%20null%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.envMap%20%3D%20null%3B%0A%20%20%20%20this.envMapRotation%20%3D%20new%20Euler2%28%29%3B%0A%20%20%20%20this.combine%20%3D%20MultiplyOperation2%3B%0A%20%20%20%20this.reflectivity%20%3D%201%3B%0A%20%20%20%20this.refractionRatio%20%3D%200.98%3B%0A%20%20%20%20this.wireframe%20%3D%20false%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%201%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20%22round%22%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20%22round%22%3B%0A%20%20%20%20this.flatShading%20%3D%20false%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.lightMap%20%3D%20source.lightMap%3B%0A%20%20%20%20this.lightMapIntensity%20%3D%20source.lightMapIntensity%3B%0A%20%20%20%20this.aoMap%20%3D%20source.aoMap%3B%0A%20%20%20%20this.aoMapIntensity%20%3D%20source.aoMapIntensity%3B%0A%20%20%20%20this.emissive.copy%28source.emissive%29%3B%0A%20%20%20%20this.emissiveMap%20%3D%20source.emissiveMap%3B%0A%20%20%20%20this.emissiveIntensity%20%3D%20source.emissiveIntensity%3B%0A%20%20%20%20this.bumpMap%20%3D%20source.bumpMap%3B%0A%20%20%20%20this.bumpScale%20%3D%20source.bumpScale%3B%0A%20%20%20%20this.normalMap%20%3D%20source.normalMap%3B%0A%20%20%20%20this.normalMapType%20%3D%20source.normalMapType%3B%0A%20%20%20%20this.normalScale.copy%28source.normalScale%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20source.displacementMap%3B%0A%20%20%20%20this.displacementScale%20%3D%20source.displacementScale%3B%0A%20%20%20%20this.displacementBias%20%3D%20source.displacementBias%3B%0A%20%20%20%20this.specularMap%20%3D%20source.specularMap%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.envMap%20%3D%20source.envMap%3B%0A%20%20%20%20this.envMapRotation.copy%28source.envMapRotation%29%3B%0A%20%20%20%20this.combine%20%3D%20source.combine%3B%0A%20%20%20%20this.reflectivity%20%3D%20source.reflectivity%3B%0A%20%20%20%20this.refractionRatio%20%3D%20source.refractionRatio%3B%0A%20%20%20%20this.wireframe%20%3D%20source.wireframe%3B%0A%20%20%20%20this.wireframeLinewidth%20%3D%20source.wireframeLinewidth%3B%0A%20%20%20%20this.wireframeLinecap%20%3D%20source.wireframeLinecap%3B%0A%20%20%20%20this.wireframeLinejoin%20%3D%20source.wireframeLinejoin%3B%0A%20%20%20%20this.flatShading%20%3D%20source.flatShading%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MeshMatcapMaterial%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshMatcapMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshMatcapMaterial%20%3D%20true%3B%0A%20%20%20%20this.defines%20%3D%20%7B%20%22MATCAP%22%3A%20%22%22%20%7D%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%2816777215%29%3B%0A%20%20%20%20this.matcap%20%3D%20null%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.bumpMap%20%3D%20null%3B%0A%20%20%20%20this.bumpScale%20%3D%201%3B%0A%20%20%20%20this.normalMap%20%3D%20null%3B%0A%20%20%20%20this.normalMapType%20%3D%20TangentSpaceNormalMap2%3B%0A%20%20%20%20this.normalScale%20%3D%20new%20Vector22%281%2C%201%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20null%3B%0A%20%20%20%20this.displacementScale%20%3D%201%3B%0A%20%20%20%20this.displacementBias%20%3D%200%3B%0A%20%20%20%20this.alphaMap%20%3D%20null%3B%0A%20%20%20%20this.flatShading%20%3D%20false%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.defines%20%3D%20%7B%20%22MATCAP%22%3A%20%22%22%20%7D%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.matcap%20%3D%20source.matcap%3B%0A%20%20%20%20this.map%20%3D%20source.map%3B%0A%20%20%20%20this.bumpMap%20%3D%20source.bumpMap%3B%0A%20%20%20%20this.bumpScale%20%3D%20source.bumpScale%3B%0A%20%20%20%20this.normalMap%20%3D%20source.normalMap%3B%0A%20%20%20%20this.normalMapType%20%3D%20source.normalMapType%3B%0A%20%20%20%20this.normalScale.copy%28source.normalScale%29%3B%0A%20%20%20%20this.displacementMap%20%3D%20source.displacementMap%3B%0A%20%20%20%20this.displacementScale%20%3D%20source.displacementScale%3B%0A%20%20%20%20this.displacementBias%20%3D%20source.displacementBias%3B%0A%20%20%20%20this.alphaMap%20%3D%20source.alphaMap%3B%0A%20%20%20%20this.flatShading%20%3D%20source.flatShading%3B%0A%20%20%20%20this.fog%20%3D%20source.fog%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LineDashedMaterial%20%3D%20class%20extends%20LineBasicMaterial2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LineDashedMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLineDashedMaterial%20%3D%20true%3B%0A%20%20%20%20this.scale%20%3D%201%3B%0A%20%20%20%20this.dashSize%20%3D%203%3B%0A%20%20%20%20this.gapSize%20%3D%201%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.scale%20%3D%20source.scale%3B%0A%20%20%20%20this.dashSize%20%3D%20source.dashSize%3B%0A%20%20%20%20this.gapSize%20%3D%20source.gapSize%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20convertArray2%28array%2C%20type%2C%20forceClone%29%20%7B%0A%20%20if%20%28%21array%20%7C%7C%20%2F%2F%20let%20%27undefined%27%20and%20%27null%27%20pass%0A%20%20%21forceClone%20%26%26%20array.constructor%20%3D%3D%3D%20type%29%20return%20array%3B%0A%20%20if%20%28typeof%20type.BYTES_PER_ELEMENT%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20return%20new%20type%28array%29%3B%0A%20%20%7D%0A%20%20return%20Array.prototype.slice.call%28array%29%3B%0A%7D%0Afunction%20isTypedArray2%28object%29%20%7B%0A%20%20return%20ArrayBuffer.isView%28object%29%20%26%26%20%21%28object%20instanceof%20DataView%29%3B%0A%7D%0Avar%20Interpolant2%20%3D%20class%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20this.parameterPositions%20%3D%20parameterPositions%3B%0A%20%20%20%20this._cachedIndex%20%3D%200%3B%0A%20%20%20%20this.resultBuffer%20%3D%20resultBuffer%20%21%3D%3D%20void%200%20%3F%20resultBuffer%20%3A%20new%20sampleValues.constructor%28sampleSize%29%3B%0A%20%20%20%20this.sampleValues%20%3D%20sampleValues%3B%0A%20%20%20%20this.valueSize%20%3D%20sampleSize%3B%0A%20%20%20%20this.settings%20%3D%20null%3B%0A%20%20%20%20this.DefaultSettings_%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20evaluate%28t%29%20%7B%0A%20%20%20%20const%20pp%20%3D%20this.parameterPositions%3B%0A%20%20%20%20let%20i1%20%3D%20this._cachedIndex%2C%20t1%20%3D%20pp%5Bi1%5D%2C%20t0%20%3D%20pp%5Bi1%20-%201%5D%3B%0A%20%20%20%20validate_interval%3A%20%7B%0A%20%20%20%20%20%20seek%3A%20%7B%0A%20%20%20%20%20%20%20%20let%20right%3B%0A%20%20%20%20%20%20%20%20linear_scan%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20forward_scan%3A%20if%20%28%21%28t%20%3C%20t1%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20giveUpAt%20%3D%20i1%20%2B%202%3B%20%3B%20%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t1%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20t0%29%20break%20forward_scan%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20i1%20%3D%20pp.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._cachedIndex%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20this.copySampleValue_%28i1%20-%201%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28i1%20%3D%3D%3D%20giveUpAt%29%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t0%20%3D%20t1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t1%20%3D%20pp%5B%2B%2Bi1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20t1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%20seek%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20right%20%3D%20pp.length%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%20linear_scan%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21%28t%20%3E%3D%20t0%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20t1global%20%3D%20pp%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20t1global%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20i1%20%3D%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t0%20%3D%20t1global%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20giveUpAt%20%3D%20i1%20-%202%3B%20%3B%20%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t0%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._cachedIndex%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20this.copySampleValue_%280%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28i1%20%3D%3D%3D%20giveUpAt%29%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t1%20%3D%20t0%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20t0%20%3D%20pp%5B--i1%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3E%3D%20t0%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%20seek%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20right%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20i1%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%20linear_scan%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%20validate_interval%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20while%20%28i1%20%3C%20right%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20mid%20%3D%20i1%20%2B%20right%20%3E%3E%3E%201%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%20pp%5Bmid%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20right%20%3D%20mid%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20i1%20%3D%20mid%20%2B%201%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20t1%20%3D%20pp%5Bi1%5D%3B%0A%20%20%20%20%20%20%20%20t0%20%3D%20pp%5Bi1%20-%201%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28t0%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._cachedIndex%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20return%20this.copySampleValue_%280%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28t1%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20i1%20%3D%20pp.length%3B%0A%20%20%20%20%20%20%20%20%20%20this._cachedIndex%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20return%20this.copySampleValue_%28i1%20-%201%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._cachedIndex%20%3D%20i1%3B%0A%20%20%20%20%20%20this.intervalChanged_%28i1%2C%20t0%2C%20t1%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.interpolate_%28i1%2C%20t0%2C%20t%2C%20t1%29%3B%0A%20%20%7D%0A%20%20getSettings_%28%29%20%7B%0A%20%20%20%20return%20this.settings%20%7C%7C%20this.DefaultSettings_%3B%0A%20%20%7D%0A%20%20copySampleValue_%28index5%29%20%7B%0A%20%20%20%20const%20result%20%3D%20this.resultBuffer%2C%20values%20%3D%20this.sampleValues%2C%20stride%20%3D%20this.valueSize%2C%20offset%20%3D%20index5%20%2A%20stride%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20stride%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20result%5Bi%5D%20%3D%20values%5Boffset%20%2B%20i%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20%2F%2F%20Template%20methods%20for%20derived%20classes%3A%0A%20%20interpolate_%28%29%20%7B%0A%20%20%20%20throw%20new%20Error%28%22call%20to%20abstract%20method%22%29%3B%0A%20%20%7D%0A%20%20intervalChanged_%28%29%20%7B%0A%20%20%7D%0A%7D%3B%0Avar%20CubicInterpolant2%20%3D%20class%20extends%20Interpolant2%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20super%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%3B%0A%20%20%20%20this._weightPrev%20%3D%20-0%3B%0A%20%20%20%20this._offsetPrev%20%3D%20-0%3B%0A%20%20%20%20this._weightNext%20%3D%20-0%3B%0A%20%20%20%20this._offsetNext%20%3D%20-0%3B%0A%20%20%20%20this.DefaultSettings_%20%3D%20%7B%0A%20%20%20%20%20%20endingStart%3A%20ZeroCurvatureEnding2%2C%0A%20%20%20%20%20%20endingEnd%3A%20ZeroCurvatureEnding2%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20intervalChanged_%28i1%2C%20t0%2C%20t1%29%20%7B%0A%20%20%20%20const%20pp%20%3D%20this.parameterPositions%3B%0A%20%20%20%20let%20iPrev%20%3D%20i1%20-%202%2C%20iNext%20%3D%20i1%20%2B%201%2C%20tPrev%20%3D%20pp%5BiPrev%5D%2C%20tNext%20%3D%20pp%5BiNext%5D%3B%0A%20%20%20%20if%20%28tPrev%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20switch%20%28this.getSettings_%28%29.endingStart%29%20%7B%0A%20%20%20%20%20%20%20%20case%20ZeroSlopeEnding2%3A%0A%20%20%20%20%20%20%20%20%20%20iPrev%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20tPrev%20%3D%202%20%2A%20t0%20-%20t1%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20WrapAroundEnding2%3A%0A%20%20%20%20%20%20%20%20%20%20iPrev%20%3D%20pp.length%20-%202%3B%0A%20%20%20%20%20%20%20%20%20%20tPrev%20%3D%20t0%20%2B%20pp%5BiPrev%5D%20-%20pp%5BiPrev%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20iPrev%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20tPrev%20%3D%20t1%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28tNext%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20switch%20%28this.getSettings_%28%29.endingEnd%29%20%7B%0A%20%20%20%20%20%20%20%20case%20ZeroSlopeEnding2%3A%0A%20%20%20%20%20%20%20%20%20%20iNext%20%3D%20i1%3B%0A%20%20%20%20%20%20%20%20%20%20tNext%20%3D%202%20%2A%20t1%20-%20t0%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20WrapAroundEnding2%3A%0A%20%20%20%20%20%20%20%20%20%20iNext%20%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20tNext%20%3D%20t1%20%2B%20pp%5B1%5D%20-%20pp%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20iNext%20%3D%20i1%20-%201%3B%0A%20%20%20%20%20%20%20%20%20%20tNext%20%3D%20t0%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20halfDt%20%3D%20%28t1%20-%20t0%29%20%2A%200.5%2C%20stride%20%3D%20this.valueSize%3B%0A%20%20%20%20this._weightPrev%20%3D%20halfDt%20%2F%20%28t0%20-%20tPrev%29%3B%0A%20%20%20%20this._weightNext%20%3D%20halfDt%20%2F%20%28tNext%20-%20t1%29%3B%0A%20%20%20%20this._offsetPrev%20%3D%20iPrev%20%2A%20stride%3B%0A%20%20%20%20this._offsetNext%20%3D%20iNext%20%2A%20stride%3B%0A%20%20%7D%0A%20%20interpolate_%28i1%2C%20t0%2C%20t%2C%20t1%29%20%7B%0A%20%20%20%20const%20result%20%3D%20this.resultBuffer%2C%20values%20%3D%20this.sampleValues%2C%20stride%20%3D%20this.valueSize%2C%20o1%20%3D%20i1%20%2A%20stride%2C%20o0%20%3D%20o1%20-%20stride%2C%20oP%20%3D%20this._offsetPrev%2C%20oN%20%3D%20this._offsetNext%2C%20wP%20%3D%20this._weightPrev%2C%20wN%20%3D%20this._weightNext%2C%20p%20%3D%20%28t%20-%20t0%29%20%2F%20%28t1%20-%20t0%29%2C%20pp%20%3D%20p%20%2A%20p%2C%20ppp%20%3D%20pp%20%2A%20p%3B%0A%20%20%20%20const%20sP%20%3D%20-wP%20%2A%20ppp%20%2B%202%20%2A%20wP%20%2A%20pp%20-%20wP%20%2A%20p%3B%0A%20%20%20%20const%20s0%20%3D%20%281%20%2B%20wP%29%20%2A%20ppp%20%2B%20%28-1.5%20-%202%20%2A%20wP%29%20%2A%20pp%20%2B%20%28-0.5%20%2B%20wP%29%20%2A%20p%20%2B%201%3B%0A%20%20%20%20const%20s1%20%3D%20%28-1%20-%20wN%29%20%2A%20ppp%20%2B%20%281.5%20%2B%20wN%29%20%2A%20pp%20%2B%200.5%20%2A%20p%3B%0A%20%20%20%20const%20sN%20%3D%20wN%20%2A%20ppp%20-%20wN%20%2A%20pp%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20stride%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20result%5Bi%5D%20%3D%20sP%20%2A%20values%5BoP%20%2B%20i%5D%20%2B%20s0%20%2A%20values%5Bo0%20%2B%20i%5D%20%2B%20s1%20%2A%20values%5Bo1%20%2B%20i%5D%20%2B%20sN%20%2A%20values%5BoN%20%2B%20i%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LinearInterpolant2%20%3D%20class%20extends%20Interpolant2%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20super%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%3B%0A%20%20%7D%0A%20%20interpolate_%28i1%2C%20t0%2C%20t%2C%20t1%29%20%7B%0A%20%20%20%20const%20result%20%3D%20this.resultBuffer%2C%20values%20%3D%20this.sampleValues%2C%20stride%20%3D%20this.valueSize%2C%20offset1%20%3D%20i1%20%2A%20stride%2C%20offset0%20%3D%20offset1%20-%20stride%2C%20weight1%20%3D%20%28t%20-%20t0%29%20%2F%20%28t1%20-%20t0%29%2C%20weight0%20%3D%201%20-%20weight1%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20stride%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20result%5Bi%5D%20%3D%20values%5Boffset0%20%2B%20i%5D%20%2A%20weight0%20%2B%20values%5Boffset1%20%2B%20i%5D%20%2A%20weight1%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DiscreteInterpolant2%20%3D%20class%20extends%20Interpolant2%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20super%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%3B%0A%20%20%7D%0A%20%20interpolate_%28i1%29%20%7B%0A%20%20%20%20return%20this.copySampleValue_%28i1%20-%201%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20KeyframeTrack2%20%3D%20class%20%7B%0A%20%20constructor%28name%2C%20times%2C%20values%2C%20interpolation%29%20%7B%0A%20%20%20%20if%20%28name%20%3D%3D%3D%20void%200%29%20throw%20new%20Error%28%22THREE.KeyframeTrack%3A%20track%20name%20is%20undefined%22%29%3B%0A%20%20%20%20if%20%28times%20%3D%3D%3D%20void%200%20%7C%7C%20times.length%20%3D%3D%3D%200%29%20throw%20new%20Error%28%22THREE.KeyframeTrack%3A%20no%20keyframes%20in%20track%20named%20%22%20%2B%20name%29%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.times%20%3D%20convertArray2%28times%2C%20this.TimeBufferType%29%3B%0A%20%20%20%20this.values%20%3D%20convertArray2%28values%2C%20this.ValueBufferType%29%3B%0A%20%20%20%20this.setInterpolation%28interpolation%20%7C%7C%20this.DefaultInterpolation%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20Serialization%20%28in%20static%20context%2C%20because%20of%20constructor%20invocation%0A%20%20%2F%2F%20and%20automatic%20invocation%20of%20.toJSON%29%3A%0A%20%20static%20toJSON%28track%29%20%7B%0A%20%20%20%20const%20trackType%20%3D%20track.constructor%3B%0A%20%20%20%20let%20json%3B%0A%20%20%20%20if%20%28trackType.toJSON%20%21%3D%3D%20this.toJSON%29%20%7B%0A%20%20%20%20%20%20json%20%3D%20trackType.toJSON%28track%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20json%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22name%22%3A%20track.name%2C%0A%20%20%20%20%20%20%20%20%22times%22%3A%20convertArray2%28track.times%2C%20Array%29%2C%0A%20%20%20%20%20%20%20%20%22values%22%3A%20convertArray2%28track.values%2C%20Array%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20const%20interpolation%20%3D%20track.getInterpolation%28%29%3B%0A%20%20%20%20%20%20if%20%28interpolation%20%21%3D%3D%20track.DefaultInterpolation%29%20%7B%0A%20%20%20%20%20%20%20%20json.interpolation%20%3D%20interpolation%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20json.type%20%3D%20track.ValueTypeName%3B%0A%20%20%20%20return%20json%3B%0A%20%20%7D%0A%20%20InterpolantFactoryMethodDiscrete%28result%29%20%7B%0A%20%20%20%20return%20new%20DiscreteInterpolant2%28this.times%2C%20this.values%2C%20this.getValueSize%28%29%2C%20result%29%3B%0A%20%20%7D%0A%20%20InterpolantFactoryMethodLinear%28result%29%20%7B%0A%20%20%20%20return%20new%20LinearInterpolant2%28this.times%2C%20this.values%2C%20this.getValueSize%28%29%2C%20result%29%3B%0A%20%20%7D%0A%20%20InterpolantFactoryMethodSmooth%28result%29%20%7B%0A%20%20%20%20return%20new%20CubicInterpolant2%28this.times%2C%20this.values%2C%20this.getValueSize%28%29%2C%20result%29%3B%0A%20%20%7D%0A%20%20setInterpolation%28interpolation%29%20%7B%0A%20%20%20%20let%20factoryMethod%3B%0A%20%20%20%20switch%20%28interpolation%29%20%7B%0A%20%20%20%20%20%20case%20InterpolateDiscrete2%3A%0A%20%20%20%20%20%20%20%20factoryMethod%20%3D%20this.InterpolantFactoryMethodDiscrete%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20InterpolateLinear2%3A%0A%20%20%20%20%20%20%20%20factoryMethod%20%3D%20this.InterpolantFactoryMethodLinear%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20InterpolateSmooth2%3A%0A%20%20%20%20%20%20%20%20factoryMethod%20%3D%20this.InterpolantFactoryMethodSmooth%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28factoryMethod%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20message%20%3D%20%22unsupported%20interpolation%20for%20%22%20%2B%20this.ValueTypeName%20%2B%20%22%20keyframe%20track%20named%20%22%20%2B%20this.name%3B%0A%20%20%20%20%20%20if%20%28this.createInterpolant%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28interpolation%20%21%3D%3D%20this.DefaultInterpolation%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.setInterpolation%28this.DefaultInterpolation%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28message%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20console.warn%28%22THREE.KeyframeTrack%3A%22%2C%20message%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.createInterpolant%20%3D%20factoryMethod%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getInterpolation%28%29%20%7B%0A%20%20%20%20switch%20%28this.createInterpolant%29%20%7B%0A%20%20%20%20%20%20case%20this.InterpolantFactoryMethodDiscrete%3A%0A%20%20%20%20%20%20%20%20return%20InterpolateDiscrete2%3B%0A%20%20%20%20%20%20case%20this.InterpolantFactoryMethodLinear%3A%0A%20%20%20%20%20%20%20%20return%20InterpolateLinear2%3B%0A%20%20%20%20%20%20case%20this.InterpolantFactoryMethodSmooth%3A%0A%20%20%20%20%20%20%20%20return%20InterpolateSmooth2%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getValueSize%28%29%20%7B%0A%20%20%20%20return%20this.values.length%20%2F%20this.times.length%3B%0A%20%20%7D%0A%20%20%2F%2F%20move%20all%20keyframes%20either%20forwards%20or%20backwards%20in%20time%0A%20%20shift%28timeOffset%29%20%7B%0A%20%20%20%20if%20%28timeOffset%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20const%20times%20%3D%20this.times%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20times.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20times%5Bi%5D%20%2B%3D%20timeOffset%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20scale%20all%20keyframe%20times%20by%20a%20factor%20%28useful%20for%20frame%20%3C-%3E%20seconds%20conversions%29%0A%20%20scale%28timeScale%29%20%7B%0A%20%20%20%20if%20%28timeScale%20%21%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20const%20times%20%3D%20this.times%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20times.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20times%5Bi%5D%20%2A%3D%20timeScale%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20removes%20keyframes%20before%20and%20after%20animation%20without%20changing%20any%20values%20within%20the%20range%20%5BstartTime%2C%20endTime%5D.%0A%20%20%2F%2F%20IMPORTANT%3A%20We%20do%20not%20shift%20around%20keys%20to%20the%20start%20of%20the%20track%20time%2C%20because%20for%20interpolated%20keys%20this%20will%20change%20their%20values%0A%20%20trim%28startTime%2C%20endTime%29%20%7B%0A%20%20%20%20const%20times%20%3D%20this.times%2C%20nKeys%20%3D%20times.length%3B%0A%20%20%20%20let%20from%20%3D%200%2C%20to%20%3D%20nKeys%20-%201%3B%0A%20%20%20%20while%20%28from%20%21%3D%3D%20nKeys%20%26%26%20times%5Bfrom%5D%20%3C%20startTime%29%20%7B%0A%20%20%20%20%20%20%2B%2Bfrom%3B%0A%20%20%20%20%7D%0A%20%20%20%20while%20%28to%20%21%3D%3D%20-1%20%26%26%20times%5Bto%5D%20%3E%20endTime%29%20%7B%0A%20%20%20%20%20%20--to%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2B%2Bto%3B%0A%20%20%20%20if%20%28from%20%21%3D%3D%200%20%7C%7C%20to%20%21%3D%3D%20nKeys%29%20%7B%0A%20%20%20%20%20%20if%20%28from%20%3E%3D%20to%29%20%7B%0A%20%20%20%20%20%20%20%20to%20%3D%20Math.max%28to%2C%201%29%3B%0A%20%20%20%20%20%20%20%20from%20%3D%20to%20-%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20stride%20%3D%20this.getValueSize%28%29%3B%0A%20%20%20%20%20%20this.times%20%3D%20times.slice%28from%2C%20to%29%3B%0A%20%20%20%20%20%20this.values%20%3D%20this.values.slice%28from%20%2A%20stride%2C%20to%20%2A%20stride%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20ensure%20we%20do%20not%20get%20a%20GarbageInGarbageOut%20situation%2C%20make%20sure%20tracks%20are%20at%20least%20minimally%20viable%0A%20%20validate%28%29%20%7B%0A%20%20%20%20let%20valid%20%3D%20true%3B%0A%20%20%20%20const%20valueSize%20%3D%20this.getValueSize%28%29%3B%0A%20%20%20%20if%20%28valueSize%20-%20Math.floor%28valueSize%29%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Invalid%20value%20size%20in%20track.%22%2C%20this%29%3B%0A%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20times%20%3D%20this.times%2C%20values%20%3D%20this.values%2C%20nKeys%20%3D%20times.length%3B%0A%20%20%20%20if%20%28nKeys%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Track%20is%20empty.%22%2C%20this%29%3B%0A%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20prevTime%20%3D%20null%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%21%3D%3D%20nKeys%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20currTime%20%3D%20times%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28typeof%20currTime%20%3D%3D%3D%20%22number%22%20%26%26%20isNaN%28currTime%29%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Time%20is%20not%20a%20valid%20number.%22%2C%20this%2C%20i%2C%20currTime%29%3B%0A%20%20%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28prevTime%20%21%3D%3D%20null%20%26%26%20prevTime%20%3E%20currTime%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Out%20of%20order%20keys.%22%2C%20this%2C%20i%2C%20currTime%2C%20prevTime%29%3B%0A%20%20%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20prevTime%20%3D%20currTime%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28values%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28isTypedArray2%28values%29%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20values.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20value%20%3D%20values%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28isNaN%28value%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.KeyframeTrack%3A%20Value%20is%20not%20a%20valid%20number.%22%2C%20this%2C%20i%2C%20value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20valid%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20valid%3B%0A%20%20%7D%0A%20%20%2F%2F%20removes%20equivalent%20sequential%20keys%20as%20common%20in%20morph%20target%20sequences%0A%20%20%2F%2F%20%280%2C0%2C0%2C0%2C1%2C1%2C1%2C0%2C0%2C0%2C0%2C0%2C0%2C0%29%20--%3E%20%280%2C0%2C1%2C1%2C0%2C0%29%0A%20%20optimize%28%29%20%7B%0A%20%20%20%20const%20times%20%3D%20this.times.slice%28%29%2C%20values%20%3D%20this.values.slice%28%29%2C%20stride%20%3D%20this.getValueSize%28%29%2C%20smoothInterpolation%20%3D%20this.getInterpolation%28%29%20%3D%3D%3D%20InterpolateSmooth2%2C%20lastIndex%20%3D%20times.length%20-%201%3B%0A%20%20%20%20let%20writeIndex%20%3D%201%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%20lastIndex%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20let%20keep%20%3D%20false%3B%0A%20%20%20%20%20%20const%20time%20%3D%20times%5Bi%5D%3B%0A%20%20%20%20%20%20const%20timeNext%20%3D%20times%5Bi%20%2B%201%5D%3B%0A%20%20%20%20%20%20if%20%28time%20%21%3D%3D%20timeNext%20%26%26%20%28i%20%21%3D%3D%201%20%7C%7C%20time%20%21%3D%3D%20times%5B0%5D%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21smoothInterpolation%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20offset%20%3D%20i%20%2A%20stride%2C%20offsetP%20%3D%20offset%20-%20stride%2C%20offsetN%20%3D%20offset%20%2B%20stride%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%21%3D%3D%20stride%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20value%20%3D%20values%5Boffset%20%2B%20j%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20values%5BoffsetP%20%2B%20j%5D%20%7C%7C%20value%20%21%3D%3D%20values%5BoffsetN%20%2B%20j%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20keep%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20keep%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28keep%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28i%20%21%3D%3D%20writeIndex%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20times%5BwriteIndex%5D%20%3D%20times%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20readOffset%20%3D%20i%20%2A%20stride%2C%20writeOffset%20%3D%20writeIndex%20%2A%20stride%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%21%3D%3D%20stride%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20values%5BwriteOffset%20%2B%20j%5D%20%3D%20values%5BreadOffset%20%2B%20j%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2B%2BwriteIndex%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28lastIndex%20%3E%200%29%20%7B%0A%20%20%20%20%20%20times%5BwriteIndex%5D%20%3D%20times%5BlastIndex%5D%3B%0A%20%20%20%20%20%20for%20%28let%20readOffset%20%3D%20lastIndex%20%2A%20stride%2C%20writeOffset%20%3D%20writeIndex%20%2A%20stride%2C%20j%20%3D%200%3B%20j%20%21%3D%3D%20stride%3B%20%2B%2Bj%29%20%7B%0A%20%20%20%20%20%20%20%20values%5BwriteOffset%20%2B%20j%5D%20%3D%20values%5BreadOffset%20%2B%20j%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%2B%2BwriteIndex%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28writeIndex%20%21%3D%3D%20times.length%29%20%7B%0A%20%20%20%20%20%20this.times%20%3D%20times.slice%280%2C%20writeIndex%29%3B%0A%20%20%20%20%20%20this.values%20%3D%20values.slice%280%2C%20writeIndex%20%2A%20stride%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.times%20%3D%20times%3B%0A%20%20%20%20%20%20this.values%20%3D%20values%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20const%20times%20%3D%20this.times.slice%28%29%3B%0A%20%20%20%20const%20values%20%3D%20this.values.slice%28%29%3B%0A%20%20%20%20const%20TypedKeyframeTrack%20%3D%20this.constructor%3B%0A%20%20%20%20const%20track%20%3D%20new%20TypedKeyframeTrack%28this.name%2C%20times%2C%20values%29%3B%0A%20%20%20%20track.createInterpolant%20%3D%20this.createInterpolant%3B%0A%20%20%20%20return%20track%3B%0A%20%20%7D%0A%7D%3B%0AKeyframeTrack2.prototype.TimeBufferType%20%3D%20Float32Array%3B%0AKeyframeTrack2.prototype.ValueBufferType%20%3D%20Float32Array%3B%0AKeyframeTrack2.prototype.DefaultInterpolation%20%3D%20InterpolateLinear2%3B%0Avar%20BooleanKeyframeTrack2%20%3D%20class%20extends%20KeyframeTrack2%20%7B%0A%20%20%2F%2F%20No%20interpolation%20parameter%20because%20only%20InterpolateDiscrete%20is%20valid.%0A%20%20constructor%28name%2C%20times%2C%20values%29%20%7B%0A%20%20%20%20super%28name%2C%20times%2C%20values%29%3B%0A%20%20%7D%0A%7D%3B%0ABooleanKeyframeTrack2.prototype.ValueTypeName%20%3D%20%22bool%22%3B%0ABooleanKeyframeTrack2.prototype.ValueBufferType%20%3D%20Array%3B%0ABooleanKeyframeTrack2.prototype.DefaultInterpolation%20%3D%20InterpolateDiscrete2%3B%0ABooleanKeyframeTrack2.prototype.InterpolantFactoryMethodLinear%20%3D%20void%200%3B%0ABooleanKeyframeTrack2.prototype.InterpolantFactoryMethodSmooth%20%3D%20void%200%3B%0Avar%20ColorKeyframeTrack2%20%3D%20class%20extends%20KeyframeTrack2%20%7B%0A%7D%3B%0AColorKeyframeTrack2.prototype.ValueTypeName%20%3D%20%22color%22%3B%0Avar%20NumberKeyframeTrack2%20%3D%20class%20extends%20KeyframeTrack2%20%7B%0A%7D%3B%0ANumberKeyframeTrack2.prototype.ValueTypeName%20%3D%20%22number%22%3B%0Avar%20QuaternionLinearInterpolant2%20%3D%20class%20extends%20Interpolant2%20%7B%0A%20%20constructor%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%20%7B%0A%20%20%20%20super%28parameterPositions%2C%20sampleValues%2C%20sampleSize%2C%20resultBuffer%29%3B%0A%20%20%7D%0A%20%20interpolate_%28i1%2C%20t0%2C%20t%2C%20t1%29%20%7B%0A%20%20%20%20const%20result%20%3D%20this.resultBuffer%2C%20values%20%3D%20this.sampleValues%2C%20stride%20%3D%20this.valueSize%2C%20alpha%20%3D%20%28t%20-%20t0%29%20%2F%20%28t1%20-%20t0%29%3B%0A%20%20%20%20let%20offset%20%3D%20i1%20%2A%20stride%3B%0A%20%20%20%20for%20%28let%20end%20%3D%20offset%20%2B%20stride%3B%20offset%20%21%3D%3D%20end%3B%20offset%20%2B%3D%204%29%20%7B%0A%20%20%20%20%20%20Quaternion2.slerpFlat%28result%2C%200%2C%20values%2C%20offset%20-%20stride%2C%20values%2C%20offset%2C%20alpha%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%7D%3B%0Avar%20QuaternionKeyframeTrack2%20%3D%20class%20extends%20KeyframeTrack2%20%7B%0A%20%20InterpolantFactoryMethodLinear%28result%29%20%7B%0A%20%20%20%20return%20new%20QuaternionLinearInterpolant2%28this.times%2C%20this.values%2C%20this.getValueSize%28%29%2C%20result%29%3B%0A%20%20%7D%0A%7D%3B%0AQuaternionKeyframeTrack2.prototype.ValueTypeName%20%3D%20%22quaternion%22%3B%0AQuaternionKeyframeTrack2.prototype.InterpolantFactoryMethodSmooth%20%3D%20void%200%3B%0Avar%20StringKeyframeTrack2%20%3D%20class%20extends%20KeyframeTrack2%20%7B%0A%20%20%2F%2F%20No%20interpolation%20parameter%20because%20only%20InterpolateDiscrete%20is%20valid.%0A%20%20constructor%28name%2C%20times%2C%20values%29%20%7B%0A%20%20%20%20super%28name%2C%20times%2C%20values%29%3B%0A%20%20%7D%0A%7D%3B%0AStringKeyframeTrack2.prototype.ValueTypeName%20%3D%20%22string%22%3B%0AStringKeyframeTrack2.prototype.ValueBufferType%20%3D%20Array%3B%0AStringKeyframeTrack2.prototype.DefaultInterpolation%20%3D%20InterpolateDiscrete2%3B%0AStringKeyframeTrack2.prototype.InterpolantFactoryMethodLinear%20%3D%20void%200%3B%0AStringKeyframeTrack2.prototype.InterpolantFactoryMethodSmooth%20%3D%20void%200%3B%0Avar%20VectorKeyframeTrack2%20%3D%20class%20extends%20KeyframeTrack2%20%7B%0A%7D%3B%0AVectorKeyframeTrack2.prototype.ValueTypeName%20%3D%20%22vector%22%3B%0Avar%20LoadingManager2%20%3D%20class%20%7B%0A%20%20constructor%28onLoad%2C%20onProgress%2C%20onError%29%20%7B%0A%20%20%20%20const%20scope%20%3D%20this%3B%0A%20%20%20%20let%20isLoading%20%3D%20false%3B%0A%20%20%20%20let%20itemsLoaded%20%3D%200%3B%0A%20%20%20%20let%20itemsTotal%20%3D%200%3B%0A%20%20%20%20let%20urlModifier%20%3D%20void%200%3B%0A%20%20%20%20const%20handlers%20%3D%20%5B%5D%3B%0A%20%20%20%20this.onStart%20%3D%20void%200%3B%0A%20%20%20%20this.onLoad%20%3D%20onLoad%3B%0A%20%20%20%20this.onProgress%20%3D%20onProgress%3B%0A%20%20%20%20this.onError%20%3D%20onError%3B%0A%20%20%20%20this.itemStart%20%3D%20function%28url%29%20%7B%0A%20%20%20%20%20%20itemsTotal%2B%2B%3B%0A%20%20%20%20%20%20if%20%28isLoading%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28scope.onStart%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20scope.onStart%28url%2C%20itemsLoaded%2C%20itemsTotal%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20isLoading%20%3D%20true%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.itemEnd%20%3D%20function%28url%29%20%7B%0A%20%20%20%20%20%20itemsLoaded%2B%2B%3B%0A%20%20%20%20%20%20if%20%28scope.onProgress%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20scope.onProgress%28url%2C%20itemsLoaded%2C%20itemsTotal%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28itemsLoaded%20%3D%3D%3D%20itemsTotal%29%20%7B%0A%20%20%20%20%20%20%20%20isLoading%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20if%20%28scope.onLoad%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20scope.onLoad%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.itemError%20%3D%20function%28url%29%20%7B%0A%20%20%20%20%20%20if%20%28scope.onError%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20scope.onError%28url%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.resolveURL%20%3D%20function%28url%29%20%7B%0A%20%20%20%20%20%20if%20%28urlModifier%29%20%7B%0A%20%20%20%20%20%20%20%20return%20urlModifier%28url%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20url%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.setURLModifier%20%3D%20function%28transform%29%20%7B%0A%20%20%20%20%20%20urlModifier%20%3D%20transform%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.addHandler%20%3D%20function%28regex%2C%20loader%29%20%7B%0A%20%20%20%20%20%20handlers.push%28regex%2C%20loader%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.removeHandler%20%3D%20function%28regex%29%20%7B%0A%20%20%20%20%20%20const%20index5%20%3D%20handlers.indexOf%28regex%29%3B%0A%20%20%20%20%20%20if%20%28index5%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20handlers.splice%28index5%2C%202%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.getHandler%20%3D%20function%28file%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20handlers.length%3B%20i%20%3C%20l%3B%20i%20%2B%3D%202%29%20%7B%0A%20%20%20%20%20%20%20%20const%20regex%20%3D%20handlers%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20const%20loader%20%3D%20handlers%5Bi%20%2B%201%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28regex.global%29%20regex.lastIndex%20%3D%200%3B%0A%20%20%20%20%20%20%20%20if%20%28regex.test%28file%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20loader%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DefaultLoadingManager2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20LoadingManager2%28%29%3B%0Avar%20Loader2%20%3D%20class%20%7B%0A%20%20constructor%28manager%29%20%7B%0A%20%20%20%20this.manager%20%3D%20manager%20%21%3D%3D%20void%200%20%3F%20manager%20%3A%20DefaultLoadingManager2%3B%0A%20%20%20%20this.crossOrigin%20%3D%20%22anonymous%22%3B%0A%20%20%20%20this.withCredentials%20%3D%20false%3B%0A%20%20%20%20this.path%20%3D%20%22%22%3B%0A%20%20%20%20this.resourcePath%20%3D%20%22%22%3B%0A%20%20%20%20this.requestHeader%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20load%28%29%20%7B%0A%20%20%7D%0A%20%20loadAsync%28url%2C%20onProgress%29%20%7B%0A%20%20%20%20const%20scope%20%3D%20this%3B%0A%20%20%20%20return%20new%20Promise%28function%28resolve%2C%20reject%29%20%7B%0A%20%20%20%20%20%20scope.load%28url%2C%20resolve%2C%20onProgress%2C%20reject%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20parse%28%29%20%7B%0A%20%20%7D%0A%20%20setCrossOrigin%28crossOrigin%29%20%7B%0A%20%20%20%20this.crossOrigin%20%3D%20crossOrigin%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setWithCredentials%28value%29%20%7B%0A%20%20%20%20this.withCredentials%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setPath%28path%29%20%7B%0A%20%20%20%20this.path%20%3D%20path%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setResourcePath%28resourcePath%29%20%7B%0A%20%20%20%20this.resourcePath%20%3D%20resourcePath%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setRequestHeader%28requestHeader%29%20%7B%0A%20%20%20%20this.requestHeader%20%3D%20requestHeader%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0ALoader2.DEFAULT_MATERIAL_NAME%20%3D%20%22__DEFAULT%22%3B%0Avar%20Light2%20%3D%20class%20extends%20Object3D2%20%7B%0A%20%20constructor%28color2%2C%20intensity%20%3D%201%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22Light%22%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%28color2%29%3B%0A%20%20%20%20this.intensity%20%3D%20intensity%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.color.copy%28source.color%29%3B%0A%20%20%20%20this.intensity%20%3D%20source.intensity%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.object.color%20%3D%20this.color.getHex%28%29%3B%0A%20%20%20%20data.object.intensity%20%3D%20this.intensity%3B%0A%20%20%20%20if%20%28this.groundColor%20%21%3D%3D%20void%200%29%20data.object.groundColor%20%3D%20this.groundColor.getHex%28%29%3B%0A%20%20%20%20if%20%28this.distance%20%21%3D%3D%20void%200%29%20data.object.distance%20%3D%20this.distance%3B%0A%20%20%20%20if%20%28this.angle%20%21%3D%3D%20void%200%29%20data.object.angle%20%3D%20this.angle%3B%0A%20%20%20%20if%20%28this.decay%20%21%3D%3D%20void%200%29%20data.object.decay%20%3D%20this.decay%3B%0A%20%20%20%20if%20%28this.penumbra%20%21%3D%3D%20void%200%29%20data.object.penumbra%20%3D%20this.penumbra%3B%0A%20%20%20%20if%20%28this.shadow%20%21%3D%3D%20void%200%29%20data.object.shadow%20%3D%20this.shadow.toJSON%28%29%3B%0A%20%20%20%20if%20%28this.target%20%21%3D%3D%20void%200%29%20data.object.target%20%3D%20this.target.uuid%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20HemisphereLight%20%3D%20class%20extends%20Light2%20%7B%0A%20%20constructor%28skyColor%2C%20groundColor%2C%20intensity%29%20%7B%0A%20%20%20%20super%28skyColor%2C%20intensity%29%3B%0A%20%20%20%20this.isHemisphereLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22HemisphereLight%22%3B%0A%20%20%20%20this.position.copy%28Object3D2.DEFAULT_UP%29%3B%0A%20%20%20%20this.updateMatrix%28%29%3B%0A%20%20%20%20this.groundColor%20%3D%20new%20Color2%28groundColor%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.groundColor.copy%28source.groundColor%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_projScreenMatrix%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20_lightPositionWorld%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_lookTarget%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20LightShadow2%20%3D%20class%20%7B%0A%20%20constructor%28camera3%29%20%7B%0A%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%20%20this.intensity%20%3D%201%3B%0A%20%20%20%20this.bias%20%3D%200%3B%0A%20%20%20%20this.normalBias%20%3D%200%3B%0A%20%20%20%20this.radius%20%3D%201%3B%0A%20%20%20%20this.blurSamples%20%3D%208%3B%0A%20%20%20%20this.mapSize%20%3D%20new%20Vector22%28512%2C%20512%29%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.mapPass%20%3D%20null%3B%0A%20%20%20%20this.matrix%20%3D%20new%20Matrix42%28%29%3B%0A%20%20%20%20this.autoUpdate%20%3D%20true%3B%0A%20%20%20%20this.needsUpdate%20%3D%20false%3B%0A%20%20%20%20this._frustum%20%3D%20new%20Frustum2%28%29%3B%0A%20%20%20%20this._frameExtents%20%3D%20new%20Vector22%281%2C%201%29%3B%0A%20%20%20%20this._viewportCount%20%3D%201%3B%0A%20%20%20%20this._viewports%20%3D%20%5B%0A%20%20%20%20%20%20new%20Vector42%280%2C%200%2C%201%2C%201%29%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%20%20getViewportCount%28%29%20%7B%0A%20%20%20%20return%20this._viewportCount%3B%0A%20%20%7D%0A%20%20getFrustum%28%29%20%7B%0A%20%20%20%20return%20this._frustum%3B%0A%20%20%7D%0A%20%20updateMatrices%28light%29%20%7B%0A%20%20%20%20const%20shadowCamera%20%3D%20this.camera%3B%0A%20%20%20%20const%20shadowMatrix%20%3D%20this.matrix%3B%0A%20%20%20%20_lightPositionWorld%2412.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20shadowCamera.position.copy%28_lightPositionWorld%2412%29%3B%0A%20%20%20%20_lookTarget%2412.setFromMatrixPosition%28light.target.matrixWorld%29%3B%0A%20%20%20%20shadowCamera.lookAt%28_lookTarget%2412%29%3B%0A%20%20%20%20shadowCamera.updateMatrixWorld%28%29%3B%0A%20%20%20%20_projScreenMatrix%242.multiplyMatrices%28shadowCamera.projectionMatrix%2C%20shadowCamera.matrixWorldInverse%29%3B%0A%20%20%20%20this._frustum.setFromProjectionMatrix%28_projScreenMatrix%242%29%3B%0A%20%20%20%20shadowMatrix.set%28%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200.5%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%201%0A%20%20%20%20%29%3B%0A%20%20%20%20shadowMatrix.multiply%28_projScreenMatrix%242%29%3B%0A%20%20%7D%0A%20%20getViewport%28viewportIndex%29%20%7B%0A%20%20%20%20return%20this._viewports%5BviewportIndex%5D%3B%0A%20%20%7D%0A%20%20getFrameExtents%28%29%20%7B%0A%20%20%20%20return%20this._frameExtents%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20if%20%28this.map%29%20%7B%0A%20%20%20%20%20%20this.map.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.mapPass%29%20%7B%0A%20%20%20%20%20%20this.mapPass.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.camera%20%3D%20source.camera.clone%28%29%3B%0A%20%20%20%20this.intensity%20%3D%20source.intensity%3B%0A%20%20%20%20this.bias%20%3D%20source.bias%3B%0A%20%20%20%20this.radius%20%3D%20source.radius%3B%0A%20%20%20%20this.mapSize.copy%28source.mapSize%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20toJSON%28%29%20%7B%0A%20%20%20%20const%20object%20%3D%20%7B%7D%3B%0A%20%20%20%20if%20%28this.intensity%20%21%3D%3D%201%29%20object.intensity%20%3D%20this.intensity%3B%0A%20%20%20%20if%20%28this.bias%20%21%3D%3D%200%29%20object.bias%20%3D%20this.bias%3B%0A%20%20%20%20if%20%28this.normalBias%20%21%3D%3D%200%29%20object.normalBias%20%3D%20this.normalBias%3B%0A%20%20%20%20if%20%28this.radius%20%21%3D%3D%201%29%20object.radius%20%3D%20this.radius%3B%0A%20%20%20%20if%20%28this.mapSize.x%20%21%3D%3D%20512%20%7C%7C%20this.mapSize.y%20%21%3D%3D%20512%29%20object.mapSize%20%3D%20this.mapSize.toArray%28%29%3B%0A%20%20%20%20object.camera%20%3D%20this.camera.toJSON%28false%29.object%3B%0A%20%20%20%20delete%20object.camera.matrix%3B%0A%20%20%20%20return%20object%3B%0A%20%20%7D%0A%7D%3B%0Avar%20SpotLightShadow%20%3D%20class%20extends%20LightShadow2%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28new%20PerspectiveCamera2%2850%2C%201%2C%200.5%2C%20500%29%29%3B%0A%20%20%20%20this.isSpotLightShadow%20%3D%20true%3B%0A%20%20%20%20this.focus%20%3D%201%3B%0A%20%20%7D%0A%20%20updateMatrices%28light%29%20%7B%0A%20%20%20%20const%20camera3%20%3D%20this.camera%3B%0A%20%20%20%20const%20fov3%20%3D%20RAD2DEG2%20%2A%202%20%2A%20light.angle%20%2A%20this.focus%3B%0A%20%20%20%20const%20aspect3%20%3D%20this.mapSize.width%20%2F%20this.mapSize.height%3B%0A%20%20%20%20const%20far%20%3D%20light.distance%20%7C%7C%20camera3.far%3B%0A%20%20%20%20if%20%28fov3%20%21%3D%3D%20camera3.fov%20%7C%7C%20aspect3%20%21%3D%3D%20camera3.aspect%20%7C%7C%20far%20%21%3D%3D%20camera3.far%29%20%7B%0A%20%20%20%20%20%20camera3.fov%20%3D%20fov3%3B%0A%20%20%20%20%20%20camera3.aspect%20%3D%20aspect3%3B%0A%20%20%20%20%20%20camera3.far%20%3D%20far%3B%0A%20%20%20%20%20%20camera3.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20super.updateMatrices%28light%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.focus%20%3D%20source.focus%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20SpotLight%20%3D%20class%20extends%20Light2%20%7B%0A%20%20constructor%28color2%2C%20intensity%2C%20distance2%20%3D%200%2C%20angle%20%3D%20Math.PI%20%2F%203%2C%20penumbra%20%3D%200%2C%20decay%20%3D%202%29%20%7B%0A%20%20%20%20super%28color2%2C%20intensity%29%3B%0A%20%20%20%20this.isSpotLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22SpotLight%22%3B%0A%20%20%20%20this.position.copy%28Object3D2.DEFAULT_UP%29%3B%0A%20%20%20%20this.updateMatrix%28%29%3B%0A%20%20%20%20this.target%20%3D%20new%20Object3D2%28%29%3B%0A%20%20%20%20this.distance%20%3D%20distance2%3B%0A%20%20%20%20this.angle%20%3D%20angle%3B%0A%20%20%20%20this.penumbra%20%3D%20penumbra%3B%0A%20%20%20%20this.decay%20%3D%20decay%3B%0A%20%20%20%20this.map%20%3D%20null%3B%0A%20%20%20%20this.shadow%20%3D%20new%20SpotLightShadow%28%29%3B%0A%20%20%7D%0A%20%20get%20power%28%29%20%7B%0A%20%20%20%20return%20this.intensity%20%2A%20Math.PI%3B%0A%20%20%7D%0A%20%20set%20power%28power%29%20%7B%0A%20%20%20%20this.intensity%20%3D%20power%20%2F%20Math.PI%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.shadow.dispose%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.distance%20%3D%20source.distance%3B%0A%20%20%20%20this.angle%20%3D%20source.angle%3B%0A%20%20%20%20this.penumbra%20%3D%20source.penumbra%3B%0A%20%20%20%20this.decay%20%3D%20source.decay%3B%0A%20%20%20%20this.target%20%3D%20source.target.clone%28%29%3B%0A%20%20%20%20this.shadow%20%3D%20source.shadow.clone%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_projScreenMatrix%2412%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20_lightPositionWorld%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20_lookTarget%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20PointLightShadow%20%3D%20class%20extends%20LightShadow2%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28new%20PerspectiveCamera2%2890%2C%201%2C%200.5%2C%20500%29%29%3B%0A%20%20%20%20this.isPointLightShadow%20%3D%20true%3B%0A%20%20%20%20this._frameExtents%20%3D%20new%20Vector22%284%2C%202%29%3B%0A%20%20%20%20this._viewportCount%20%3D%206%3B%0A%20%20%20%20this._viewports%20%3D%20%5B%0A%20%20%20%20%20%20%2F%2F%20These%20viewports%20map%20a%20cube-map%20onto%20a%202D%20texture%20with%20the%0A%20%20%20%20%20%20%2F%2F%20following%20orientation%3A%0A%20%20%20%20%20%20%2F%2F%0A%20%20%20%20%20%20%2F%2F%20%20xzXZ%0A%20%20%20%20%20%20%2F%2F%20%20%20y%20Y%0A%20%20%20%20%20%20%2F%2F%0A%20%20%20%20%20%20%2F%2F%20X%20-%20Positive%20x%20direction%0A%20%20%20%20%20%20%2F%2F%20x%20-%20Negative%20x%20direction%0A%20%20%20%20%20%20%2F%2F%20Y%20-%20Positive%20y%20direction%0A%20%20%20%20%20%20%2F%2F%20y%20-%20Negative%20y%20direction%0A%20%20%20%20%20%20%2F%2F%20Z%20-%20Positive%20z%20direction%0A%20%20%20%20%20%20%2F%2F%20z%20-%20Negative%20z%20direction%0A%20%20%20%20%20%20%2F%2F%20positive%20X%0A%20%20%20%20%20%20new%20Vector42%282%2C%201%2C%201%2C%201%29%2C%0A%20%20%20%20%20%20%2F%2F%20negative%20X%0A%20%20%20%20%20%20new%20Vector42%280%2C%201%2C%201%2C%201%29%2C%0A%20%20%20%20%20%20%2F%2F%20positive%20Z%0A%20%20%20%20%20%20new%20Vector42%283%2C%201%2C%201%2C%201%29%2C%0A%20%20%20%20%20%20%2F%2F%20negative%20Z%0A%20%20%20%20%20%20new%20Vector42%281%2C%201%2C%201%2C%201%29%2C%0A%20%20%20%20%20%20%2F%2F%20positive%20Y%0A%20%20%20%20%20%20new%20Vector42%283%2C%200%2C%201%2C%201%29%2C%0A%20%20%20%20%20%20%2F%2F%20negative%20Y%0A%20%20%20%20%20%20new%20Vector42%281%2C%200%2C%201%2C%201%29%0A%20%20%20%20%5D%3B%0A%20%20%20%20this._cubeDirections%20%3D%20%5B%0A%20%20%20%20%20%20new%20Vector32%281%2C%200%2C%200%29%2C%0A%20%20%20%20%20%20new%20Vector32%28-1%2C%200%2C%200%29%2C%0A%20%20%20%20%20%20new%20Vector32%280%2C%200%2C%201%29%2C%0A%20%20%20%20%20%20new%20Vector32%280%2C%200%2C%20-1%29%2C%0A%20%20%20%20%20%20new%20Vector32%280%2C%201%2C%200%29%2C%0A%20%20%20%20%20%20new%20Vector32%280%2C%20-1%2C%200%29%0A%20%20%20%20%5D%3B%0A%20%20%20%20this._cubeUps%20%3D%20%5B%0A%20%20%20%20%20%20new%20Vector32%280%2C%201%2C%200%29%2C%0A%20%20%20%20%20%20new%20Vector32%280%2C%201%2C%200%29%2C%0A%20%20%20%20%20%20new%20Vector32%280%2C%201%2C%200%29%2C%0A%20%20%20%20%20%20new%20Vector32%280%2C%201%2C%200%29%2C%0A%20%20%20%20%20%20new%20Vector32%280%2C%200%2C%201%29%2C%0A%20%20%20%20%20%20new%20Vector32%280%2C%200%2C%20-1%29%0A%20%20%20%20%5D%3B%0A%20%20%7D%0A%20%20updateMatrices%28light%2C%20viewportIndex%20%3D%200%29%20%7B%0A%20%20%20%20const%20camera3%20%3D%20this.camera%3B%0A%20%20%20%20const%20shadowMatrix%20%3D%20this.matrix%3B%0A%20%20%20%20const%20far%20%3D%20light.distance%20%7C%7C%20camera3.far%3B%0A%20%20%20%20if%20%28far%20%21%3D%3D%20camera3.far%29%20%7B%0A%20%20%20%20%20%20camera3.far%20%3D%20far%3B%0A%20%20%20%20%20%20camera3.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_lightPositionWorld.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20camera3.position.copy%28_lightPositionWorld%29%3B%0A%20%20%20%20_lookTarget.copy%28camera3.position%29%3B%0A%20%20%20%20_lookTarget.add%28this._cubeDirections%5BviewportIndex%5D%29%3B%0A%20%20%20%20camera3.up.copy%28this._cubeUps%5BviewportIndex%5D%29%3B%0A%20%20%20%20camera3.lookAt%28_lookTarget%29%3B%0A%20%20%20%20camera3.updateMatrixWorld%28%29%3B%0A%20%20%20%20shadowMatrix.makeTranslation%28-_lightPositionWorld.x%2C%20-_lightPositionWorld.y%2C%20-_lightPositionWorld.z%29%3B%0A%20%20%20%20_projScreenMatrix%2412.multiplyMatrices%28camera3.projectionMatrix%2C%20camera3.matrixWorldInverse%29%3B%0A%20%20%20%20this._frustum.setFromProjectionMatrix%28_projScreenMatrix%2412%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20PointLight%20%3D%20class%20extends%20Light2%20%7B%0A%20%20constructor%28color2%2C%20intensity%2C%20distance2%20%3D%200%2C%20decay%20%3D%202%29%20%7B%0A%20%20%20%20super%28color2%2C%20intensity%29%3B%0A%20%20%20%20this.isPointLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22PointLight%22%3B%0A%20%20%20%20this.distance%20%3D%20distance2%3B%0A%20%20%20%20this.decay%20%3D%20decay%3B%0A%20%20%20%20this.shadow%20%3D%20new%20PointLightShadow%28%29%3B%0A%20%20%7D%0A%20%20get%20power%28%29%20%7B%0A%20%20%20%20return%20this.intensity%20%2A%204%20%2A%20Math.PI%3B%0A%20%20%7D%0A%20%20set%20power%28power%29%20%7B%0A%20%20%20%20this.intensity%20%3D%20power%20%2F%20%284%20%2A%20Math.PI%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.shadow.dispose%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.distance%20%3D%20source.distance%3B%0A%20%20%20%20this.decay%20%3D%20source.decay%3B%0A%20%20%20%20this.shadow%20%3D%20source.shadow.clone%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20OrthographicCamera2%20%3D%20class%20extends%20Camera2%20%7B%0A%20%20constructor%28left%20%3D%20-1%2C%20right%20%3D%201%2C%20top%20%3D%201%2C%20bottom%20%3D%20-1%2C%20near%20%3D%200.1%2C%20far%20%3D%202e3%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isOrthographicCamera%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22OrthographicCamera%22%3B%0A%20%20%20%20this.zoom%20%3D%201%3B%0A%20%20%20%20this.view%20%3D%20null%3B%0A%20%20%20%20this.left%20%3D%20left%3B%0A%20%20%20%20this.right%20%3D%20right%3B%0A%20%20%20%20this.top%20%3D%20top%3B%0A%20%20%20%20this.bottom%20%3D%20bottom%3B%0A%20%20%20%20this.near%20%3D%20near%3B%0A%20%20%20%20this.far%20%3D%20far%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.left%20%3D%20source.left%3B%0A%20%20%20%20this.right%20%3D%20source.right%3B%0A%20%20%20%20this.top%20%3D%20source.top%3B%0A%20%20%20%20this.bottom%20%3D%20source.bottom%3B%0A%20%20%20%20this.near%20%3D%20source.near%3B%0A%20%20%20%20this.far%20%3D%20source.far%3B%0A%20%20%20%20this.zoom%20%3D%20source.zoom%3B%0A%20%20%20%20this.view%20%3D%20source.view%20%3D%3D%3D%20null%20%3F%20null%20%3A%20Object.assign%28%7B%7D%2C%20source.view%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setViewOffset%28fullWidth%2C%20fullHeight%2C%20x2%2C%20y2%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20if%20%28this.view%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.view%20%3D%20%7B%0A%20%20%20%20%20%20%20%20enabled%3A%20true%2C%0A%20%20%20%20%20%20%20%20fullWidth%3A%201%2C%0A%20%20%20%20%20%20%20%20fullHeight%3A%201%2C%0A%20%20%20%20%20%20%20%20offsetX%3A%200%2C%0A%20%20%20%20%20%20%20%20offsetY%3A%200%2C%0A%20%20%20%20%20%20%20%20width%3A%201%2C%0A%20%20%20%20%20%20%20%20height%3A%201%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.view.enabled%20%3D%20true%3B%0A%20%20%20%20this.view.fullWidth%20%3D%20fullWidth%3B%0A%20%20%20%20this.view.fullHeight%20%3D%20fullHeight%3B%0A%20%20%20%20this.view.offsetX%20%3D%20x2%3B%0A%20%20%20%20this.view.offsetY%20%3D%20y2%3B%0A%20%20%20%20this.view.width%20%3D%20width%3B%0A%20%20%20%20this.view.height%20%3D%20height%3B%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20clearViewOffset%28%29%20%7B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.view.enabled%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.updateProjectionMatrix%28%29%3B%0A%20%20%7D%0A%20%20updateProjectionMatrix%28%29%20%7B%0A%20%20%20%20const%20dx%20%3D%20%28this.right%20-%20this.left%29%20%2F%20%282%20%2A%20this.zoom%29%3B%0A%20%20%20%20const%20dy%20%3D%20%28this.top%20-%20this.bottom%29%20%2F%20%282%20%2A%20this.zoom%29%3B%0A%20%20%20%20const%20cx%20%3D%20%28this.right%20%2B%20this.left%29%20%2F%202%3B%0A%20%20%20%20const%20cy%20%3D%20%28this.top%20%2B%20this.bottom%29%20%2F%202%3B%0A%20%20%20%20let%20left%20%3D%20cx%20-%20dx%3B%0A%20%20%20%20let%20right%20%3D%20cx%20%2B%20dx%3B%0A%20%20%20%20let%20top%20%3D%20cy%20%2B%20dy%3B%0A%20%20%20%20let%20bottom%20%3D%20cy%20-%20dy%3B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%20%26%26%20this.view.enabled%29%20%7B%0A%20%20%20%20%20%20const%20scaleW%20%3D%20%28this.right%20-%20this.left%29%20%2F%20this.view.fullWidth%20%2F%20this.zoom%3B%0A%20%20%20%20%20%20const%20scaleH%20%3D%20%28this.top%20-%20this.bottom%29%20%2F%20this.view.fullHeight%20%2F%20this.zoom%3B%0A%20%20%20%20%20%20left%20%2B%3D%20scaleW%20%2A%20this.view.offsetX%3B%0A%20%20%20%20%20%20right%20%3D%20left%20%2B%20scaleW%20%2A%20this.view.width%3B%0A%20%20%20%20%20%20top%20-%3D%20scaleH%20%2A%20this.view.offsetY%3B%0A%20%20%20%20%20%20bottom%20%3D%20top%20-%20scaleH%20%2A%20this.view.height%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.projectionMatrix.makeOrthographic%28left%2C%20right%2C%20top%2C%20bottom%2C%20this.near%2C%20this.far%2C%20this.coordinateSystem%29%3B%0A%20%20%20%20this.projectionMatrixInverse.copy%28this.projectionMatrix%29.invert%28%29%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.object.zoom%20%3D%20this.zoom%3B%0A%20%20%20%20data.object.left%20%3D%20this.left%3B%0A%20%20%20%20data.object.right%20%3D%20this.right%3B%0A%20%20%20%20data.object.top%20%3D%20this.top%3B%0A%20%20%20%20data.object.bottom%20%3D%20this.bottom%3B%0A%20%20%20%20data.object.near%20%3D%20this.near%3B%0A%20%20%20%20data.object.far%20%3D%20this.far%3B%0A%20%20%20%20if%20%28this.view%20%21%3D%3D%20null%29%20data.object.view%20%3D%20Object.assign%28%7B%7D%2C%20this.view%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DirectionalLightShadow2%20%3D%20class%20extends%20LightShadow2%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28new%20OrthographicCamera2%28-5%2C%205%2C%205%2C%20-5%2C%200.5%2C%20500%29%29%3B%0A%20%20%20%20this.isDirectionalLightShadow%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DirectionalLight2%20%3D%20class%20extends%20Light2%20%7B%0A%20%20constructor%28color2%2C%20intensity%29%20%7B%0A%20%20%20%20super%28color2%2C%20intensity%29%3B%0A%20%20%20%20this.isDirectionalLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22DirectionalLight%22%3B%0A%20%20%20%20this.position.copy%28Object3D2.DEFAULT_UP%29%3B%0A%20%20%20%20this.updateMatrix%28%29%3B%0A%20%20%20%20this.target%20%3D%20new%20Object3D2%28%29%3B%0A%20%20%20%20this.shadow%20%3D%20new%20DirectionalLightShadow2%28%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.shadow.dispose%28%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.target%20%3D%20source.target.clone%28%29%3B%0A%20%20%20%20this.shadow%20%3D%20source.shadow.clone%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20AmbientLight2%20%3D%20class%20extends%20Light2%20%7B%0A%20%20constructor%28color2%2C%20intensity%29%20%7B%0A%20%20%20%20super%28color2%2C%20intensity%29%3B%0A%20%20%20%20this.isAmbientLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22AmbientLight%22%3B%0A%20%20%7D%0A%7D%3B%0Avar%20RectAreaLight%20%3D%20class%20extends%20Light2%20%7B%0A%20%20constructor%28color2%2C%20intensity%2C%20width%20%3D%2010%2C%20height%20%3D%2010%29%20%7B%0A%20%20%20%20super%28color2%2C%20intensity%29%3B%0A%20%20%20%20this.isRectAreaLight%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20%22RectAreaLight%22%3B%0A%20%20%20%20this.width%20%3D%20width%3B%0A%20%20%20%20this.height%20%3D%20height%3B%0A%20%20%7D%0A%20%20get%20power%28%29%20%7B%0A%20%20%20%20return%20this.intensity%20%2A%20this.width%20%2A%20this.height%20%2A%20Math.PI%3B%0A%20%20%7D%0A%20%20set%20power%28power%29%20%7B%0A%20%20%20%20this.intensity%20%3D%20power%20%2F%20%28this.width%20%2A%20this.height%20%2A%20Math.PI%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.width%20%3D%20source.width%3B%0A%20%20%20%20this.height%20%3D%20source.height%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.object.width%20%3D%20this.width%3B%0A%20%20%20%20data.object.height%20%3D%20this.height%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20SphericalHarmonics3%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.isSphericalHarmonics3%20%3D%20true%3B%0A%20%20%20%20this.coefficients%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.coefficients.push%28new%20Vector32%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20set%28coefficients%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.coefficients%5Bi%5D.copy%28coefficients%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20zero%28%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.coefficients%5Bi%5D.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20%2F%2F%20get%20the%20radiance%20in%20the%20direction%20of%20the%20normal%0A%20%20%2F%2F%20target%20is%20a%20Vector3%0A%20%20getAt%28normal2%2C%20target%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20normal2.x%2C%20y2%20%3D%20normal2.y%2C%20z2%20%3D%20normal2.z%3B%0A%20%20%20%20const%20coeff%20%3D%20this.coefficients%3B%0A%20%20%20%20target.copy%28coeff%5B0%5D%29.multiplyScalar%280.282095%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B1%5D%2C%200.488603%20%2A%20y2%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B2%5D%2C%200.488603%20%2A%20z2%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B3%5D%2C%200.488603%20%2A%20x2%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B4%5D%2C%201.092548%20%2A%20%28x2%20%2A%20y2%29%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B5%5D%2C%201.092548%20%2A%20%28y2%20%2A%20z2%29%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B6%5D%2C%200.315392%20%2A%20%283%20%2A%20z2%20%2A%20z2%20-%201%29%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B7%5D%2C%201.092548%20%2A%20%28x2%20%2A%20z2%29%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B8%5D%2C%200.546274%20%2A%20%28x2%20%2A%20x2%20-%20y2%20%2A%20y2%29%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20%2F%2F%20get%20the%20irradiance%20%28radiance%20convolved%20with%20cosine%20lobe%29%20in%20the%20direction%20of%20the%20normal%0A%20%20%2F%2F%20target%20is%20a%20Vector3%0A%20%20%2F%2F%20https%3A%2F%2Fgraphics.stanford.edu%2Fpapers%2Fenvmap%2Fenvmap.pdf%0A%20%20getIrradianceAt%28normal2%2C%20target%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20normal2.x%2C%20y2%20%3D%20normal2.y%2C%20z2%20%3D%20normal2.z%3B%0A%20%20%20%20const%20coeff%20%3D%20this.coefficients%3B%0A%20%20%20%20target.copy%28coeff%5B0%5D%29.multiplyScalar%280.886227%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B1%5D%2C%202%20%2A%200.511664%20%2A%20y2%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B2%5D%2C%202%20%2A%200.511664%20%2A%20z2%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B3%5D%2C%202%20%2A%200.511664%20%2A%20x2%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B4%5D%2C%202%20%2A%200.429043%20%2A%20x2%20%2A%20y2%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B5%5D%2C%202%20%2A%200.429043%20%2A%20y2%20%2A%20z2%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B6%5D%2C%200.743125%20%2A%20z2%20%2A%20z2%20-%200.247708%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B7%5D%2C%202%20%2A%200.429043%20%2A%20x2%20%2A%20z2%29%3B%0A%20%20%20%20target.addScaledVector%28coeff%5B8%5D%2C%200.429043%20%2A%20%28x2%20%2A%20x2%20-%20y2%20%2A%20y2%29%29%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20add%28sh%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.coefficients%5Bi%5D.add%28sh.coefficients%5Bi%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addScaledSH%28sh%2C%20s%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.coefficients%5Bi%5D.addScaledVector%28sh.coefficients%5Bi%5D%2C%20s%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20scale%28s%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.coefficients%5Bi%5D.multiplyScalar%28s%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20lerp%28sh%2C%20alpha%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.coefficients%5Bi%5D.lerp%28sh.coefficients%5Bi%5D%2C%20alpha%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20equals%28sh%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28%21this.coefficients%5Bi%5D.equals%28sh.coefficients%5Bi%5D%29%29%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20copy%28sh%29%20%7B%0A%20%20%20%20return%20this.set%28sh.coefficients%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28%29.copy%28this%29%3B%0A%20%20%7D%0A%20%20fromArray%28array%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20const%20coefficients%20%3D%20this.coefficients%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20coefficients%5Bi%5D.fromArray%28array%2C%20offset%20%2B%20i%20%2A%203%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toArray%28array%20%3D%20%5B%5D%2C%20offset%20%3D%200%29%20%7B%0A%20%20%20%20const%20coefficients%20%3D%20this.coefficients%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20coefficients%5Bi%5D.toArray%28array%2C%20offset%20%2B%20i%20%2A%203%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20array%3B%0A%20%20%7D%0A%20%20%2F%2F%20evaluate%20the%20basis%20functions%0A%20%20%2F%2F%20shBasis%20is%20an%20Array%5B%209%20%5D%0A%20%20static%20getBasisAt%28normal2%2C%20shBasis%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20normal2.x%2C%20y2%20%3D%20normal2.y%2C%20z2%20%3D%20normal2.z%3B%0A%20%20%20%20shBasis%5B0%5D%20%3D%200.282095%3B%0A%20%20%20%20shBasis%5B1%5D%20%3D%200.488603%20%2A%20y2%3B%0A%20%20%20%20shBasis%5B2%5D%20%3D%200.488603%20%2A%20z2%3B%0A%20%20%20%20shBasis%5B3%5D%20%3D%200.488603%20%2A%20x2%3B%0A%20%20%20%20shBasis%5B4%5D%20%3D%201.092548%20%2A%20x2%20%2A%20y2%3B%0A%20%20%20%20shBasis%5B5%5D%20%3D%201.092548%20%2A%20y2%20%2A%20z2%3B%0A%20%20%20%20shBasis%5B6%5D%20%3D%200.315392%20%2A%20%283%20%2A%20z2%20%2A%20z2%20-%201%29%3B%0A%20%20%20%20shBasis%5B7%5D%20%3D%201.092548%20%2A%20x2%20%2A%20z2%3B%0A%20%20%20%20shBasis%5B8%5D%20%3D%200.546274%20%2A%20%28x2%20%2A%20x2%20-%20y2%20%2A%20y2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LightProbe%20%3D%20class%20extends%20Light2%20%7B%0A%20%20constructor%28sh%20%3D%20new%20SphericalHarmonics3%28%29%2C%20intensity%20%3D%201%29%20%7B%0A%20%20%20%20super%28void%200%2C%20intensity%29%3B%0A%20%20%20%20this.isLightProbe%20%3D%20true%3B%0A%20%20%20%20this.sh%20%3D%20sh%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.sh.copy%28source.sh%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20fromJSON%28json%29%20%7B%0A%20%20%20%20this.intensity%20%3D%20json.intensity%3B%0A%20%20%20%20this.sh.fromArray%28json.sh%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20data%20%3D%20super.toJSON%28meta%29%3B%0A%20%20%20%20data.object.sh%20%3D%20this.sh.toArray%28%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_RESERVED_CHARS_RE2%20%3D%20%22%5C%5C%5B%5C%5C%5D%5C%5C.%3A%5C%5C%2F%22%3B%0Avar%20_reservedRe2%20%3D%20new%20RegExp%28%22%5B%22%20%2B%20_RESERVED_CHARS_RE2%20%2B%20%22%5D%22%2C%20%22g%22%29%3B%0Avar%20_wordChar2%20%3D%20%22%5B%5E%22%20%2B%20_RESERVED_CHARS_RE2%20%2B%20%22%5D%22%3B%0Avar%20_wordCharOrDot2%20%3D%20%22%5B%5E%22%20%2B%20_RESERVED_CHARS_RE2.replace%28%22%5C%5C.%22%2C%20%22%22%29%20%2B%20%22%5D%22%3B%0Avar%20_directoryRe2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20%2F%28%28%3F%3AWC%2B%5B%5C%2F%3A%5D%29%2A%29%2F.source.replace%28%22WC%22%2C%20_wordChar2%29%3B%0Avar%20_nodeRe2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20%2F%28WCOD%2B%29%3F%2F.source.replace%28%22WCOD%22%2C%20_wordCharOrDot2%29%3B%0Avar%20_objectRe2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20%2F%28%3F%3A%5C.%28WC%2B%29%28%3F%3A%5C%5B%28.%2B%29%5C%5D%29%3F%29%3F%2F.source.replace%28%22WC%22%2C%20_wordChar2%29%3B%0Avar%20_propertyRe2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20%2F%5C.%28WC%2B%29%28%3F%3A%5C%5B%28.%2B%29%5C%5D%29%3F%2F.source.replace%28%22WC%22%2C%20_wordChar2%29%3B%0Avar%20_trackRe2%20%3D%20new%20RegExp%28%0A%20%20%22%5E%22%20%2B%20_directoryRe2%20%2B%20_nodeRe2%20%2B%20_objectRe2%20%2B%20_propertyRe2%20%2B%20%22%24%22%0A%29%3B%0Avar%20_supportedObjectNames2%20%3D%20%5B%22material%22%2C%20%22materials%22%2C%20%22bones%22%2C%20%22map%22%5D%3B%0Avar%20Composite2%20%3D%20class%20%7B%0A%20%20constructor%28targetGroup%2C%20path%2C%20optionalParsedPath%29%20%7B%0A%20%20%20%20const%20parsedPath%20%3D%20optionalParsedPath%20%7C%7C%20PropertyBinding2.parseTrackName%28path%29%3B%0A%20%20%20%20this._targetGroup%20%3D%20targetGroup%3B%0A%20%20%20%20this._bindings%20%3D%20targetGroup.subscribe_%28path%2C%20parsedPath%29%3B%0A%20%20%7D%0A%20%20getValue%28array%2C%20offset%29%20%7B%0A%20%20%20%20this.bind%28%29%3B%0A%20%20%20%20const%20firstValidIndex%20%3D%20this._targetGroup.nCachedObjects_%2C%20binding%20%3D%20this._bindings%5BfirstValidIndex%5D%3B%0A%20%20%20%20if%20%28binding%20%21%3D%3D%20void%200%29%20binding.getValue%28array%2C%20offset%29%3B%0A%20%20%7D%0A%20%20setValue%28array%2C%20offset%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20this._bindings%3B%0A%20%20%20%20for%20%28let%20i%20%3D%20this._targetGroup.nCachedObjects_%2C%20n%20%3D%20bindings.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20bindings%5Bi%5D.setValue%28array%2C%20offset%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20bind%28%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20this._bindings%3B%0A%20%20%20%20for%20%28let%20i%20%3D%20this._targetGroup.nCachedObjects_%2C%20n%20%3D%20bindings.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20bindings%5Bi%5D.bind%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20unbind%28%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20this._bindings%3B%0A%20%20%20%20for%20%28let%20i%20%3D%20this._targetGroup.nCachedObjects_%2C%20n%20%3D%20bindings.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20bindings%5Bi%5D.unbind%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20PropertyBinding2%20%3D%20class%20_PropertyBinding%20%7B%0A%20%20constructor%28rootNode%2C%20path%2C%20parsedPath%29%20%7B%0A%20%20%20%20this.path%20%3D%20path%3B%0A%20%20%20%20this.parsedPath%20%3D%20parsedPath%20%7C%7C%20_PropertyBinding.parseTrackName%28path%29%3B%0A%20%20%20%20this.node%20%3D%20_PropertyBinding.findNode%28rootNode%2C%20this.parsedPath.nodeName%29%3B%0A%20%20%20%20this.rootNode%20%3D%20rootNode%3B%0A%20%20%20%20this.getValue%20%3D%20this._getValue_unbound%3B%0A%20%20%20%20this.setValue%20%3D%20this._setValue_unbound%3B%0A%20%20%7D%0A%20%20static%20create%28root2%2C%20path%2C%20parsedPath%29%20%7B%0A%20%20%20%20if%20%28%21%28root2%20%26%26%20root2.isAnimationObjectGroup%29%29%20%7B%0A%20%20%20%20%20%20return%20new%20_PropertyBinding%28root2%2C%20path%2C%20parsedPath%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20new%20_PropertyBinding.Composite%28root2%2C%20path%2C%20parsedPath%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Replaces%20spaces%20with%20underscores%20and%20removes%20unsupported%20characters%20from%0A%20%20%20%2A%20node%20names%2C%20to%20ensure%20compatibility%20with%20parseTrackName%28%29.%0A%20%20%20%2A%0A%20%20%20%2A%20%40param%20%7Bstring%7D%20name%20Node%20name%20to%20be%20sanitized.%0A%20%20%20%2A%20%40return%20%7Bstring%7D%0A%20%20%20%2A%2F%0A%20%20static%20sanitizeNodeName%28name%29%20%7B%0A%20%20%20%20return%20name.replace%28%2F%5Cs%2Fg%2C%20%22_%22%29.replace%28_reservedRe2%2C%20%22%22%29%3B%0A%20%20%7D%0A%20%20static%20parseTrackName%28trackName%29%20%7B%0A%20%20%20%20const%20matches%20%3D%20_trackRe2.exec%28trackName%29%3B%0A%20%20%20%20if%20%28matches%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22PropertyBinding%3A%20Cannot%20parse%20trackName%3A%20%22%20%2B%20trackName%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20results%20%3D%20%7B%0A%20%20%20%20%20%20%2F%2F%20directoryName%3A%20matches%5B%201%20%5D%2C%20%2F%2F%20%28tschw%29%20currently%20unused%0A%20%20%20%20%20%20nodeName%3A%20matches%5B2%5D%2C%0A%20%20%20%20%20%20objectName%3A%20matches%5B3%5D%2C%0A%20%20%20%20%20%20objectIndex%3A%20matches%5B4%5D%2C%0A%20%20%20%20%20%20propertyName%3A%20matches%5B5%5D%2C%0A%20%20%20%20%20%20%2F%2F%20required%0A%20%20%20%20%20%20propertyIndex%3A%20matches%5B6%5D%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20lastDot%20%3D%20results.nodeName%20%26%26%20results.nodeName.lastIndexOf%28%22.%22%29%3B%0A%20%20%20%20if%20%28lastDot%20%21%3D%3D%20void%200%20%26%26%20lastDot%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20const%20objectName%20%3D%20results.nodeName.substring%28lastDot%20%2B%201%29%3B%0A%20%20%20%20%20%20if%20%28_supportedObjectNames2.indexOf%28objectName%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20results.nodeName%20%3D%20results.nodeName.substring%280%2C%20lastDot%29%3B%0A%20%20%20%20%20%20%20%20results.objectName%20%3D%20objectName%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28results.propertyName%20%3D%3D%3D%20null%20%7C%7C%20results.propertyName.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22PropertyBinding%3A%20can%20not%20parse%20propertyName%20from%20trackName%3A%20%22%20%2B%20trackName%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20results%3B%0A%20%20%7D%0A%20%20static%20findNode%28root2%2C%20nodeName%29%20%7B%0A%20%20%20%20if%20%28nodeName%20%3D%3D%3D%20void%200%20%7C%7C%20nodeName%20%3D%3D%3D%20%22%22%20%7C%7C%20nodeName%20%3D%3D%3D%20%22.%22%20%7C%7C%20nodeName%20%3D%3D%3D%20-1%20%7C%7C%20nodeName%20%3D%3D%3D%20root2.name%20%7C%7C%20nodeName%20%3D%3D%3D%20root2.uuid%29%20%7B%0A%20%20%20%20%20%20return%20root2%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28root2.skeleton%29%20%7B%0A%20%20%20%20%20%20const%20bone%20%3D%20root2.skeleton.getBoneByName%28nodeName%29%3B%0A%20%20%20%20%20%20if%20%28bone%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20bone%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28root2.children%29%20%7B%0A%20%20%20%20%20%20const%20searchNodeSubtree%20%3D%20function%28children%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20children.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20childNode%20%3D%20children%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28childNode.name%20%3D%3D%3D%20nodeName%20%7C%7C%20childNode.uuid%20%3D%3D%3D%20nodeName%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20childNode%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20const%20result%20%3D%20searchNodeSubtree%28childNode.children%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28result%29%20return%20result%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20const%20subTreeNode%20%3D%20searchNodeSubtree%28root2.children%29%3B%0A%20%20%20%20%20%20if%20%28subTreeNode%29%20%7B%0A%20%20%20%20%20%20%20%20return%20subTreeNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%20%20%2F%2F%20these%20are%20used%20to%20%22bind%22%20a%20nonexistent%20property%0A%20%20_getValue_unavailable%28%29%20%7B%0A%20%20%7D%0A%20%20_setValue_unavailable%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20Getters%0A%20%20_getValue_direct%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20buffer2%5Boffset%5D%20%3D%20this.targetObject%5Bthis.propertyName%5D%3B%0A%20%20%7D%0A%20%20_getValue_array%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20const%20source%20%3D%20this.resolvedProperty%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20source.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20buffer2%5Boffset%2B%2B%5D%20%3D%20source%5Bi%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_getValue_arrayElement%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20buffer2%5Boffset%5D%20%3D%20this.resolvedProperty%5Bthis.propertyIndex%5D%3B%0A%20%20%7D%0A%20%20_getValue_toArray%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty.toArray%28buffer2%2C%20offset%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20Direct%0A%20%20_setValue_direct%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.targetObject%5Bthis.propertyName%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%7D%0A%20%20_setValue_direct_setNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.targetObject%5Bthis.propertyName%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%20%20this.targetObject.needsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_setValue_direct_setMatrixWorldNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.targetObject%5Bthis.propertyName%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%20%20this.targetObject.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20%2F%2F%20EntireArray%0A%20%20_setValue_array%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20const%20dest%20%3D%20this.resolvedProperty%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20dest.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20dest%5Bi%5D%20%3D%20buffer2%5Boffset%2B%2B%5D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_setValue_array_setNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20const%20dest%20%3D%20this.resolvedProperty%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20dest.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20dest%5Bi%5D%20%3D%20buffer2%5Boffset%2B%2B%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.targetObject.needsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_setValue_array_setMatrixWorldNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20const%20dest%20%3D%20this.resolvedProperty%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20n%20%3D%20dest.length%3B%20i%20%21%3D%3D%20n%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20dest%5Bi%5D%20%3D%20buffer2%5Boffset%2B%2B%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.targetObject.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20%2F%2F%20ArrayElement%0A%20%20_setValue_arrayElement%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty%5Bthis.propertyIndex%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%7D%0A%20%20_setValue_arrayElement_setNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty%5Bthis.propertyIndex%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%20%20this.targetObject.needsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_setValue_arrayElement_setMatrixWorldNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty%5Bthis.propertyIndex%5D%20%3D%20buffer2%5Boffset%5D%3B%0A%20%20%20%20this.targetObject.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20%2F%2F%20HasToFromArray%0A%20%20_setValue_fromArray%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty.fromArray%28buffer2%2C%20offset%29%3B%0A%20%20%7D%0A%20%20_setValue_fromArray_setNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty.fromArray%28buffer2%2C%20offset%29%3B%0A%20%20%20%20this.targetObject.needsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_setValue_fromArray_setMatrixWorldNeedsUpdate%28buffer2%2C%20offset%29%20%7B%0A%20%20%20%20this.resolvedProperty.fromArray%28buffer2%2C%20offset%29%3B%0A%20%20%20%20this.targetObject.matrixWorldNeedsUpdate%20%3D%20true%3B%0A%20%20%7D%0A%20%20_getValue_unbound%28targetArray%2C%20offset%29%20%7B%0A%20%20%20%20this.bind%28%29%3B%0A%20%20%20%20this.getValue%28targetArray%2C%20offset%29%3B%0A%20%20%7D%0A%20%20_setValue_unbound%28sourceArray%2C%20offset%29%20%7B%0A%20%20%20%20this.bind%28%29%3B%0A%20%20%20%20this.setValue%28sourceArray%2C%20offset%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20create%20getter%20%2F%20setter%20pair%20for%20a%20property%20in%20the%20scene%20graph%0A%20%20bind%28%29%20%7B%0A%20%20%20%20let%20targetObject%20%3D%20this.node%3B%0A%20%20%20%20const%20parsedPath%20%3D%20this.parsedPath%3B%0A%20%20%20%20const%20objectName%20%3D%20parsedPath.objectName%3B%0A%20%20%20%20const%20propertyName%20%3D%20parsedPath.propertyName%3B%0A%20%20%20%20let%20propertyIndex%20%3D%20parsedPath.propertyIndex%3B%0A%20%20%20%20if%20%28%21targetObject%29%20%7B%0A%20%20%20%20%20%20targetObject%20%3D%20_PropertyBinding.findNode%28this.rootNode%2C%20parsedPath.nodeName%29%3B%0A%20%20%20%20%20%20this.node%20%3D%20targetObject%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.getValue%20%3D%20this._getValue_unavailable%3B%0A%20%20%20%20this.setValue%20%3D%20this._setValue_unavailable%3B%0A%20%20%20%20if%20%28%21targetObject%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.PropertyBinding%3A%20No%20target%20node%20found%20for%20track%3A%20%22%20%2B%20this.path%20%2B%20%22.%22%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28objectName%29%20%7B%0A%20%20%20%20%20%20let%20objectIndex%20%3D%20parsedPath.objectIndex%3B%0A%20%20%20%20%20%20switch%20%28objectName%29%20%7B%0A%20%20%20%20%20%20%20%20case%20%22materials%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.material%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20material%20as%20node%20does%20not%20have%20a%20material.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.material.materials%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20material.materials%20as%20node.material%20does%20not%20have%20a%20materials%20array.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject.material.materials%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22bones%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.skeleton%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20bones%20as%20node%20does%20not%20have%20a%20skeleton.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject.skeleton.bones%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20targetObject.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28targetObject%5Bi%5D.name%20%3D%3D%3D%20objectIndex%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20objectIndex%20%3D%20i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20%22map%22%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28%22map%22%20in%20targetObject%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject.map%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.material%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20material%20as%20node%20does%20not%20have%20a%20material.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21targetObject.material.map%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20material.map%20as%20node.material%20does%20not%20have%20a%20map.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject.material.map%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28targetObject%5BobjectName%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20objectName%20of%20node%20undefined.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject%5BobjectName%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28objectIndex%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28targetObject%5BobjectIndex%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Trying%20to%20bind%20to%20objectIndex%20of%20objectName%2C%20but%20is%20undefined.%22%2C%20this%2C%20targetObject%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20targetObject%20%3D%20targetObject%5BobjectIndex%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20nodeProperty%20%3D%20targetObject%5BpropertyName%5D%3B%0A%20%20%20%20if%20%28nodeProperty%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20nodeName%20%3D%20parsedPath.nodeName%3B%0A%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Trying%20to%20update%20property%20for%20track%3A%20%22%20%2B%20nodeName%20%2B%20%22.%22%20%2B%20propertyName%20%2B%20%22%20but%20it%20wasn%27t%20found.%22%2C%20targetObject%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20versioning%20%3D%20this.Versioning.None%3B%0A%20%20%20%20this.targetObject%20%3D%20targetObject%3B%0A%20%20%20%20if%20%28targetObject.needsUpdate%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20versioning%20%3D%20this.Versioning.NeedsUpdate%3B%0A%20%20%20%20%7D%20else%20if%20%28targetObject.matrixWorldNeedsUpdate%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20versioning%20%3D%20this.Versioning.MatrixWorldNeedsUpdate%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20bindingType%20%3D%20this.BindingType.Direct%3B%0A%20%20%20%20if%20%28propertyIndex%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28propertyName%20%3D%3D%3D%20%22morphTargetInfluences%22%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21targetObject.geometry%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20morphTargetInfluences%20because%20node%20does%20not%20have%20a%20geometry.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%21targetObject.geometry.morphAttributes%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.PropertyBinding%3A%20Can%20not%20bind%20to%20morphTargetInfluences%20because%20node%20does%20not%20have%20a%20geometry.morphAttributes.%22%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28targetObject.morphTargetDictionary%5BpropertyIndex%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20propertyIndex%20%3D%20targetObject.morphTargetDictionary%5BpropertyIndex%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20bindingType%20%3D%20this.BindingType.ArrayElement%3B%0A%20%20%20%20%20%20this.resolvedProperty%20%3D%20nodeProperty%3B%0A%20%20%20%20%20%20this.propertyIndex%20%3D%20propertyIndex%3B%0A%20%20%20%20%7D%20else%20if%20%28nodeProperty.fromArray%20%21%3D%3D%20void%200%20%26%26%20nodeProperty.toArray%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20bindingType%20%3D%20this.BindingType.HasFromToArray%3B%0A%20%20%20%20%20%20this.resolvedProperty%20%3D%20nodeProperty%3B%0A%20%20%20%20%7D%20else%20if%20%28Array.isArray%28nodeProperty%29%29%20%7B%0A%20%20%20%20%20%20bindingType%20%3D%20this.BindingType.EntireArray%3B%0A%20%20%20%20%20%20this.resolvedProperty%20%3D%20nodeProperty%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.propertyName%20%3D%20propertyName%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.getValue%20%3D%20this.GetterByBindingType%5BbindingType%5D%3B%0A%20%20%20%20this.setValue%20%3D%20this.SetterByBindingTypeAndVersioning%5BbindingType%5D%5Bversioning%5D%3B%0A%20%20%7D%0A%20%20unbind%28%29%20%7B%0A%20%20%20%20this.node%20%3D%20null%3B%0A%20%20%20%20this.getValue%20%3D%20this._getValue_unbound%3B%0A%20%20%20%20this.setValue%20%3D%20this._setValue_unbound%3B%0A%20%20%7D%0A%7D%3B%0APropertyBinding2.Composite%20%3D%20Composite2%3B%0APropertyBinding2.prototype.BindingType%20%3D%20%7B%0A%20%20Direct%3A%200%2C%0A%20%20EntireArray%3A%201%2C%0A%20%20ArrayElement%3A%202%2C%0A%20%20HasFromToArray%3A%203%0A%7D%3B%0APropertyBinding2.prototype.Versioning%20%3D%20%7B%0A%20%20None%3A%200%2C%0A%20%20NeedsUpdate%3A%201%2C%0A%20%20MatrixWorldNeedsUpdate%3A%202%0A%7D%3B%0APropertyBinding2.prototype.GetterByBindingType%20%3D%20%5B%0A%20%20PropertyBinding2.prototype._getValue_direct%2C%0A%20%20PropertyBinding2.prototype._getValue_array%2C%0A%20%20PropertyBinding2.prototype._getValue_arrayElement%2C%0A%20%20PropertyBinding2.prototype._getValue_toArray%0A%5D%3B%0APropertyBinding2.prototype.SetterByBindingTypeAndVersioning%20%3D%20%5B%0A%20%20%5B%0A%20%20%20%20%2F%2F%20Direct%0A%20%20%20%20PropertyBinding2.prototype._setValue_direct%2C%0A%20%20%20%20PropertyBinding2.prototype._setValue_direct_setNeedsUpdate%2C%0A%20%20%20%20PropertyBinding2.prototype._setValue_direct_setMatrixWorldNeedsUpdate%0A%20%20%5D%2C%0A%20%20%5B%0A%20%20%20%20%2F%2F%20EntireArray%0A%20%20%20%20PropertyBinding2.prototype._setValue_array%2C%0A%20%20%20%20PropertyBinding2.prototype._setValue_array_setNeedsUpdate%2C%0A%20%20%20%20PropertyBinding2.prototype._setValue_array_setMatrixWorldNeedsUpdate%0A%20%20%5D%2C%0A%20%20%5B%0A%20%20%20%20%2F%2F%20ArrayElement%0A%20%20%20%20PropertyBinding2.prototype._setValue_arrayElement%2C%0A%20%20%20%20PropertyBinding2.prototype._setValue_arrayElement_setNeedsUpdate%2C%0A%20%20%20%20PropertyBinding2.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate%0A%20%20%5D%2C%0A%20%20%5B%0A%20%20%20%20%2F%2F%20HasToFromArray%0A%20%20%20%20PropertyBinding2.prototype._setValue_fromArray%2C%0A%20%20%20%20PropertyBinding2.prototype._setValue_fromArray_setNeedsUpdate%2C%0A%20%20%20%20PropertyBinding2.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate%0A%20%20%5D%0A%5D%3B%0Avar%20_controlInterpolantsResultBuffer2%20%3D%20new%20Float32Array%281%29%3B%0Avar%20InstancedInterleavedBuffer%20%3D%20class%20extends%20InterleavedBuffer%20%7B%0A%20%20constructor%28array%2C%20stride%2C%20meshPerAttribute%20%3D%201%29%20%7B%0A%20%20%20%20super%28array%2C%20stride%29%3B%0A%20%20%20%20this.isInstancedInterleavedBuffer%20%3D%20true%3B%0A%20%20%20%20this.meshPerAttribute%20%3D%20meshPerAttribute%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20super.copy%28source%29%3B%0A%20%20%20%20this.meshPerAttribute%20%3D%20source.meshPerAttribute%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20clone%28data%29%20%7B%0A%20%20%20%20const%20ib%20%3D%20super.clone%28data%29%3B%0A%20%20%20%20ib.meshPerAttribute%20%3D%20this.meshPerAttribute%3B%0A%20%20%20%20return%20ib%3B%0A%20%20%7D%0A%20%20toJSON%28data%29%20%7B%0A%20%20%20%20const%20json%20%3D%20super.toJSON%28data%29%3B%0A%20%20%20%20json.isInstancedInterleavedBuffer%20%3D%20true%3B%0A%20%20%20%20json.meshPerAttribute%20%3D%20this.meshPerAttribute%3B%0A%20%20%20%20return%20json%3B%0A%20%20%7D%0A%7D%3B%0Avar%20refreshUniforms%20%3D%20%5B%0A%20%20%22alphaMap%22%2C%0A%20%20%22alphaTest%22%2C%0A%20%20%22anisotropy%22%2C%0A%20%20%22anisotropyMap%22%2C%0A%20%20%22anisotropyRotation%22%2C%0A%20%20%22aoMap%22%2C%0A%20%20%22attenuationColor%22%2C%0A%20%20%22attenuationDistance%22%2C%0A%20%20%22bumpMap%22%2C%0A%20%20%22clearcoat%22%2C%0A%20%20%22clearcoatMap%22%2C%0A%20%20%22clearcoatNormalMap%22%2C%0A%20%20%22clearcoatNormalScale%22%2C%0A%20%20%22clearcoatRoughness%22%2C%0A%20%20%22color%22%2C%0A%20%20%22dispersion%22%2C%0A%20%20%22displacementMap%22%2C%0A%20%20%22emissive%22%2C%0A%20%20%22emissiveMap%22%2C%0A%20%20%22envMap%22%2C%0A%20%20%22gradientMap%22%2C%0A%20%20%22ior%22%2C%0A%20%20%22iridescence%22%2C%0A%20%20%22iridescenceIOR%22%2C%0A%20%20%22iridescenceMap%22%2C%0A%20%20%22iridescenceThicknessMap%22%2C%0A%20%20%22lightMap%22%2C%0A%20%20%22map%22%2C%0A%20%20%22matcap%22%2C%0A%20%20%22metalness%22%2C%0A%20%20%22metalnessMap%22%2C%0A%20%20%22normalMap%22%2C%0A%20%20%22normalScale%22%2C%0A%20%20%22opacity%22%2C%0A%20%20%22roughness%22%2C%0A%20%20%22roughnessMap%22%2C%0A%20%20%22sheen%22%2C%0A%20%20%22sheenColor%22%2C%0A%20%20%22sheenColorMap%22%2C%0A%20%20%22sheenRoughnessMap%22%2C%0A%20%20%22shininess%22%2C%0A%20%20%22specular%22%2C%0A%20%20%22specularColor%22%2C%0A%20%20%22specularColorMap%22%2C%0A%20%20%22specularIntensity%22%2C%0A%20%20%22specularIntensityMap%22%2C%0A%20%20%22specularMap%22%2C%0A%20%20%22thickness%22%2C%0A%20%20%22transmission%22%2C%0A%20%20%22transmissionMap%22%0A%5D%3B%0Avar%20NodeMaterialObserver%20%3D%20class%20%7B%0A%20%20constructor%28builder%29%20%7B%0A%20%20%20%20this.renderObjects%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.hasNode%20%3D%20this.containsNode%28builder%29%3B%0A%20%20%20%20this.hasAnimation%20%3D%20builder.object.isSkinnedMesh%20%3D%3D%3D%20true%3B%0A%20%20%20%20this.refreshUniforms%20%3D%20refreshUniforms%3B%0A%20%20%20%20this.renderId%20%3D%200%3B%0A%20%20%7D%0A%20%20firstInitialization%28renderObject%29%20%7B%0A%20%20%20%20const%20hasInitialized%20%3D%20this.renderObjects.has%28renderObject%29%3B%0A%20%20%20%20if%20%28hasInitialized%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this.getRenderObjectData%28renderObject%29%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20getRenderObjectData%28renderObject%29%20%7B%0A%20%20%20%20let%20data%20%3D%20this.renderObjects.get%28renderObject%29%3B%0A%20%20%20%20if%20%28data%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20geometry%2C%20material%20%7D%20%3D%20renderObject%3B%0A%20%20%20%20%20%20data%20%3D%20%7B%0A%20%20%20%20%20%20%20%20material%3A%20this.getMaterialData%28material%29%2C%0A%20%20%20%20%20%20%20%20geometry%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20attributes%3A%20this.getAttributesData%28geometry.attributes%29%2C%0A%20%20%20%20%20%20%20%20%20%20indexVersion%3A%20geometry.index%20%3F%20geometry.index.version%20%3A%20null%2C%0A%20%20%20%20%20%20%20%20%20%20drawRange%3A%20%7B%20start%3A%20geometry.drawRange.start%2C%20count%3A%20geometry.drawRange.count%20%7D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20worldMatrix%3A%20renderObject.object.matrixWorld.clone%28%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20if%20%28renderObject.object.center%29%20%7B%0A%20%20%20%20%20%20%20%20data.center%20%3D%20renderObject.object.center.clone%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderObject.object.morphTargetInfluences%29%20%7B%0A%20%20%20%20%20%20%20%20data.morphTargetInfluences%20%3D%20renderObject.object.morphTargetInfluences.slice%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderObject.bundle%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20data.version%20%3D%20renderObject.bundle.version%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28data.material.transmission%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20%7B%20width%2C%20height%20%7D%20%3D%20renderObject.context%3B%0A%20%20%20%20%20%20%20%20data.bufferWidth%20%3D%20width%3B%0A%20%20%20%20%20%20%20%20data.bufferHeight%20%3D%20height%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.renderObjects.set%28renderObject%2C%20data%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20getAttributesData%28attributes%29%20%7B%0A%20%20%20%20const%20attributesData%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20name%20in%20attributes%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bname%5D%3B%0A%20%20%20%20%20%20attributesData%5Bname%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20version%3A%20attribute2.version%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20attributesData%3B%0A%20%20%7D%0A%20%20containsNode%28builder%29%20%7B%0A%20%20%20%20const%20material%20%3D%20builder.material%3B%0A%20%20%20%20for%20%28const%20property2%20in%20material%29%20%7B%0A%20%20%20%20%20%20if%20%28material%5Bproperty2%5D%20%26%26%20material%5Bproperty2%5D.isNode%29%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28builder.renderer.nodes.modelViewMatrix%20%21%3D%3D%20null%20%7C%7C%20builder.renderer.nodes.modelNormalViewMatrix%20%21%3D%3D%20null%29%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20getMaterialData%28material%29%20%7B%0A%20%20%20%20const%20data%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20property2%20of%20this.refreshUniforms%29%20%7B%0A%20%20%20%20%20%20const%20value%20%3D%20material%5Bproperty2%5D%3B%0A%20%20%20%20%20%20if%20%28value%20%3D%3D%3D%20null%20%7C%7C%20value%20%3D%3D%3D%20void%200%29%20continue%3B%0A%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%22object%22%20%26%26%20value.clone%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28value.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20data%5Bproperty2%5D%20%3D%20%7B%20id%3A%20value.id%2C%20version%3A%20value.version%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20data%5Bproperty2%5D%20%3D%20value.clone%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20data%5Bproperty2%5D%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20equals%28renderObject%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20material%2C%20geometry%20%7D%20%3D%20renderObject%3B%0A%20%20%20%20const%20renderObjectData%20%3D%20this.getRenderObjectData%28renderObject%29%3B%0A%20%20%20%20if%20%28renderObjectData.worldMatrix.equals%28object.matrixWorld%29%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20renderObjectData.worldMatrix.copy%28object.matrixWorld%29%3B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20materialData%20%3D%20renderObjectData.material%3B%0A%20%20%20%20for%20%28const%20property2%20in%20materialData%29%20%7B%0A%20%20%20%20%20%20const%20value%20%3D%20materialData%5Bproperty2%5D%3B%0A%20%20%20%20%20%20const%20mtlValue%20%3D%20material%5Bproperty2%5D%3B%0A%20%20%20%20%20%20if%20%28value.equals%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28value.equals%28mtlValue%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20value.copy%28mtlValue%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28mtlValue.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28value.id%20%21%3D%3D%20mtlValue.id%20%7C%7C%20value.version%20%21%3D%3D%20mtlValue.version%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20value.id%20%3D%20mtlValue.id%3B%0A%20%20%20%20%20%20%20%20%20%20value.version%20%3D%20mtlValue.version%3B%0A%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28value%20%21%3D%3D%20mtlValue%29%20%7B%0A%20%20%20%20%20%20%20%20materialData%5Bproperty2%5D%20%3D%20mtlValue%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28materialData.transmission%20%3E%200%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20width%2C%20height%20%7D%20%3D%20renderObject.context%3B%0A%20%20%20%20%20%20if%20%28renderObjectData.bufferWidth%20%21%3D%3D%20width%20%7C%7C%20renderObjectData.bufferHeight%20%21%3D%3D%20height%29%20%7B%0A%20%20%20%20%20%20%20%20renderObjectData.bufferWidth%20%3D%20width%3B%0A%20%20%20%20%20%20%20%20renderObjectData.bufferHeight%20%3D%20height%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20storedGeometryData%20%3D%20renderObjectData.geometry%3B%0A%20%20%20%20const%20attributes%20%3D%20geometry.attributes%3B%0A%20%20%20%20const%20storedAttributes%20%3D%20storedGeometryData.attributes%3B%0A%20%20%20%20const%20storedAttributeNames%20%3D%20Object.keys%28storedAttributes%29%3B%0A%20%20%20%20const%20currentAttributeNames%20%3D%20Object.keys%28attributes%29%3B%0A%20%20%20%20if%20%28storedAttributeNames.length%20%21%3D%3D%20currentAttributeNames.length%29%20%7B%0A%20%20%20%20%20%20renderObjectData.geometry.attributes%20%3D%20this.getAttributesData%28attributes%29%3B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28const%20name%20of%20storedAttributeNames%29%20%7B%0A%20%20%20%20%20%20const%20storedAttributeData%20%3D%20storedAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bname%5D%3B%0A%20%20%20%20%20%20if%20%28attribute2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20delete%20storedAttributes%5Bname%5D%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28storedAttributeData.version%20%21%3D%3D%20attribute2.version%29%20%7B%0A%20%20%20%20%20%20%20%20storedAttributeData.version%20%3D%20attribute2.version%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20index5%20%3D%20geometry.index%3B%0A%20%20%20%20const%20storedIndexVersion%20%3D%20storedGeometryData.indexVersion%3B%0A%20%20%20%20const%20currentIndexVersion%20%3D%20index5%20%3F%20index5.version%20%3A%20null%3B%0A%20%20%20%20if%20%28storedIndexVersion%20%21%3D%3D%20currentIndexVersion%29%20%7B%0A%20%20%20%20%20%20storedGeometryData.indexVersion%20%3D%20currentIndexVersion%3B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28storedGeometryData.drawRange.start%20%21%3D%3D%20geometry.drawRange.start%20%7C%7C%20storedGeometryData.drawRange.count%20%21%3D%3D%20geometry.drawRange.count%29%20%7B%0A%20%20%20%20%20%20storedGeometryData.drawRange.start%20%3D%20geometry.drawRange.start%3B%0A%20%20%20%20%20%20storedGeometryData.drawRange.count%20%3D%20geometry.drawRange.count%3B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderObjectData.morphTargetInfluences%29%20%7B%0A%20%20%20%20%20%20let%20morphChanged%20%3D%20false%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20renderObjectData.morphTargetInfluences.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28renderObjectData.morphTargetInfluences%5Bi%5D%20%21%3D%3D%20object.morphTargetInfluences%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20morphChanged%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28morphChanged%29%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderObjectData.center%29%20%7B%0A%20%20%20%20%20%20if%20%28renderObjectData.center.equals%28object.center%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20renderObjectData.center.copy%28object.center%29%3B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderObject.bundle%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20renderObjectData.version%20%3D%20renderObject.bundle.version%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20needsRefresh%28renderObject%2C%20nodeFrame%29%20%7B%0A%20%20%20%20if%20%28this.hasNode%20%7C%7C%20this.hasAnimation%20%7C%7C%20this.firstInitialization%28renderObject%29%29%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20const%20%7B%20renderId%20%7D%20%3D%20nodeFrame%3B%0A%20%20%20%20if%20%28this.renderId%20%21%3D%3D%20renderId%29%20%7B%0A%20%20%20%20%20%20this.renderId%20%3D%20renderId%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20isStatic%20%3D%20renderObject.object.static%20%3D%3D%3D%20true%3B%0A%20%20%20%20const%20isBundle%20%3D%20renderObject.bundle%20%21%3D%3D%20null%20%26%26%20renderObject.bundle.static%20%3D%3D%3D%20true%20%26%26%20this.getRenderObjectData%28renderObject%29.version%20%3D%3D%3D%20renderObject.bundle.version%3B%0A%20%20%20%20if%20%28isStatic%20%7C%7C%20isBundle%29%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20const%20notEqual2%20%3D%20this.equals%28renderObject%29%20%21%3D%3D%20true%3B%0A%20%20%20%20return%20notEqual2%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20cyrb53%28value%2C%20seed%20%3D%200%29%20%7B%0A%20%20let%20h12%20%3D%203735928559%20%5E%20seed%2C%20h2%20%3D%201103547991%20%5E%20seed%3B%0A%20%20if%20%28value%20instanceof%20Array%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20val%3B%20i%20%3C%20value.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20val%20%3D%20value%5Bi%5D%3B%0A%20%20%20%20%20%20h12%20%3D%20Math.imul%28h12%20%5E%20val%2C%202654435761%29%3B%0A%20%20%20%20%20%20h2%20%3D%20Math.imul%28h2%20%5E%20val%2C%201597334677%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20ch%3B%20i%20%3C%20value.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20ch%20%3D%20value.charCodeAt%28i%29%3B%0A%20%20%20%20%20%20h12%20%3D%20Math.imul%28h12%20%5E%20ch%2C%202654435761%29%3B%0A%20%20%20%20%20%20h2%20%3D%20Math.imul%28h2%20%5E%20ch%2C%201597334677%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20h12%20%3D%20Math.imul%28h12%20%5E%20h12%20%3E%3E%3E%2016%2C%202246822507%29%3B%0A%20%20h12%20%5E%3D%20Math.imul%28h2%20%5E%20h2%20%3E%3E%3E%2013%2C%203266489909%29%3B%0A%20%20h2%20%3D%20Math.imul%28h2%20%5E%20h2%20%3E%3E%3E%2016%2C%202246822507%29%3B%0A%20%20h2%20%5E%3D%20Math.imul%28h12%20%5E%20h12%20%3E%3E%3E%2013%2C%203266489909%29%3B%0A%20%20return%204294967296%20%2A%20%282097151%20%26%20h2%29%20%2B%20%28h12%20%3E%3E%3E%200%29%3B%0A%7D%0Avar%20hashString%20%3D%20%28str%29%20%3D%3E%20cyrb53%28str%29%3B%0Avar%20hashArray%20%3D%20%28array%29%20%3D%3E%20cyrb53%28array%29%3B%0Avar%20hash%241%20%3D%20%28...params%29%20%3D%3E%20cyrb53%28params%29%3B%0Afunction%20getCacheKey%241%28object%2C%20force%20%3D%20false%29%20%7B%0A%20%20const%20values%20%3D%20%5B%5D%3B%0A%20%20if%20%28object.isNode%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20values.push%28object.id%29%3B%0A%20%20%20%20object%20%3D%20object.getSelf%28%29%3B%0A%20%20%7D%0A%20%20for%20%28const%20%7B%20property%3A%20property2%2C%20childNode%20%7D%20of%20getNodeChildren%28object%29%29%20%7B%0A%20%20%20%20values.push%28values%2C%20cyrb53%28property2.slice%280%2C%20-4%29%29%2C%20childNode.getCacheKey%28force%29%29%3B%0A%20%20%7D%0A%20%20return%20cyrb53%28values%29%3B%0A%7D%0Afunction%2A%20getNodeChildren%28node%2C%20toJSON%20%3D%20false%29%20%7B%0A%20%20for%20%28const%20property2%20in%20node%29%20%7B%0A%20%20%20%20if%20%28property2.startsWith%28%22_%22%29%20%3D%3D%3D%20true%29%20continue%3B%0A%20%20%20%20const%20object%20%3D%20node%5Bproperty2%5D%3B%0A%20%20%20%20if%20%28Array.isArray%28object%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20object.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20child%20%3D%20object%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28child%20%26%26%20%28child.isNode%20%3D%3D%3D%20true%20%7C%7C%20toJSON%20%26%26%20typeof%20child.toJSON%20%3D%3D%3D%20%22function%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20yield%20%7B%20property%3A%20property2%2C%20index%3A%20i%2C%20childNode%3A%20child%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28object%20%26%26%20object.isNode%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20yield%20%7B%20property%3A%20property2%2C%20childNode%3A%20object%20%7D%3B%0A%20%20%20%20%7D%20else%20if%20%28typeof%20object%20%3D%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20subProperty%20in%20object%29%20%7B%0A%20%20%20%20%20%20%20%20const%20child%20%3D%20object%5BsubProperty%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28child%20%26%26%20%28child.isNode%20%3D%3D%3D%20true%20%7C%7C%20toJSON%20%26%26%20typeof%20child.toJSON%20%3D%3D%3D%20%22function%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20yield%20%7B%20property%3A%20property2%2C%20index%3A%20subProperty%2C%20childNode%3A%20child%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0Afunction%20getValueType%28value%29%20%7B%0A%20%20if%20%28value%20%3D%3D%3D%20void%200%20%7C%7C%20value%20%3D%3D%3D%20null%29%20return%20null%3B%0A%20%20const%20typeOf%20%3D%20typeof%20value%3B%0A%20%20if%20%28value.isNode%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20return%20%22node%22%3B%0A%20%20%7D%20else%20if%20%28typeOf%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20return%20%22float%22%3B%0A%20%20%7D%20else%20if%20%28typeOf%20%3D%3D%3D%20%22boolean%22%29%20%7B%0A%20%20%20%20return%20%22bool%22%3B%0A%20%20%7D%20else%20if%20%28typeOf%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20return%20%22string%22%3B%0A%20%20%7D%20else%20if%20%28typeOf%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20return%20%22shader%22%3B%0A%20%20%7D%20else%20if%20%28value.isVector2%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20return%20%22vec2%22%3B%0A%20%20%7D%20else%20if%20%28value.isVector3%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20return%20%22vec3%22%3B%0A%20%20%7D%20else%20if%20%28value.isVector4%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20return%20%22vec4%22%3B%0A%20%20%7D%20else%20if%20%28value.isMatrix3%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20return%20%22mat3%22%3B%0A%20%20%7D%20else%20if%20%28value.isMatrix4%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20return%20%22mat4%22%3B%0A%20%20%7D%20else%20if%20%28value.isColor%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20return%20%22color%22%3B%0A%20%20%7D%20else%20if%20%28value%20instanceof%20ArrayBuffer%29%20%7B%0A%20%20%20%20return%20%22ArrayBuffer%22%3B%0A%20%20%7D%0A%20%20return%20null%3B%0A%7D%0Afunction%20getValueFromType%28type%2C%20...params%29%20%7B%0A%20%20const%20last4%20%3D%20type%20%3F%20type.slice%28-4%29%20%3A%20void%200%3B%0A%20%20if%20%28params.length%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20if%20%28last4%20%3D%3D%3D%20%22vec2%22%29%20params%20%3D%20%5Bparams%5B0%5D%2C%20params%5B0%5D%5D%3B%0A%20%20%20%20else%20if%20%28last4%20%3D%3D%3D%20%22vec3%22%29%20params%20%3D%20%5Bparams%5B0%5D%2C%20params%5B0%5D%2C%20params%5B0%5D%5D%3B%0A%20%20%20%20else%20if%20%28last4%20%3D%3D%3D%20%22vec4%22%29%20params%20%3D%20%5Bparams%5B0%5D%2C%20params%5B0%5D%2C%20params%5B0%5D%2C%20params%5B0%5D%5D%3B%0A%20%20%7D%0A%20%20if%20%28type%20%3D%3D%3D%20%22color%22%29%20%7B%0A%20%20%20%20return%20new%20Color2%28...params%29%3B%0A%20%20%7D%20else%20if%20%28last4%20%3D%3D%3D%20%22vec2%22%29%20%7B%0A%20%20%20%20return%20new%20Vector22%28...params%29%3B%0A%20%20%7D%20else%20if%20%28last4%20%3D%3D%3D%20%22vec3%22%29%20%7B%0A%20%20%20%20return%20new%20Vector32%28...params%29%3B%0A%20%20%7D%20else%20if%20%28last4%20%3D%3D%3D%20%22vec4%22%29%20%7B%0A%20%20%20%20return%20new%20Vector42%28...params%29%3B%0A%20%20%7D%20else%20if%20%28last4%20%3D%3D%3D%20%22mat3%22%29%20%7B%0A%20%20%20%20return%20new%20Matrix32%28...params%29%3B%0A%20%20%7D%20else%20if%20%28last4%20%3D%3D%3D%20%22mat4%22%29%20%7B%0A%20%20%20%20return%20new%20Matrix42%28...params%29%3B%0A%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22bool%22%29%20%7B%0A%20%20%20%20return%20params%5B0%5D%20%7C%7C%20false%3B%0A%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22float%22%20%7C%7C%20type%20%3D%3D%3D%20%22int%22%20%7C%7C%20type%20%3D%3D%3D%20%22uint%22%29%20%7B%0A%20%20%20%20return%20params%5B0%5D%20%7C%7C%200%3B%0A%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20return%20params%5B0%5D%20%7C%7C%20%22%22%3B%0A%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22ArrayBuffer%22%29%20%7B%0A%20%20%20%20return%20base64ToArrayBuffer%28params%5B0%5D%29%3B%0A%20%20%7D%0A%20%20return%20null%3B%0A%7D%0Afunction%20arrayBufferToBase64%28arrayBuffer%29%20%7B%0A%20%20let%20chars%20%3D%20%22%22%3B%0A%20%20const%20array%20%3D%20new%20Uint8Array%28arrayBuffer%29%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20array.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20chars%20%2B%3D%20String.fromCharCode%28array%5Bi%5D%29%3B%0A%20%20%7D%0A%20%20return%20btoa%28chars%29%3B%0A%7D%0Afunction%20base64ToArrayBuffer%28base64%29%20%7B%0A%20%20return%20Uint8Array.from%28atob%28base64%29%2C%20%28c2%29%20%3D%3E%20c2.charCodeAt%280%29%29.buffer%3B%0A%7D%0Avar%20NodeShaderStage%20%3D%20%7B%0A%20%20VERTEX%3A%20%22vertex%22%2C%0A%20%20FRAGMENT%3A%20%22fragment%22%0A%7D%3B%0Avar%20NodeUpdateType%20%3D%20%7B%0A%20%20NONE%3A%20%22none%22%2C%0A%20%20FRAME%3A%20%22frame%22%2C%0A%20%20RENDER%3A%20%22render%22%2C%0A%20%20OBJECT%3A%20%22object%22%0A%7D%3B%0Avar%20defaultShaderStages%20%3D%20%5B%22fragment%22%2C%20%22vertex%22%5D%3B%0Avar%20defaultBuildStages%20%3D%20%5B%22setup%22%2C%20%22analyze%22%2C%20%22generate%22%5D%3B%0Avar%20shaderStages%20%3D%20%5B...defaultShaderStages%2C%20%22compute%22%5D%3B%0Avar%20vectorComponents%20%3D%20%5B%22x%22%2C%20%22y%22%2C%20%22z%22%2C%20%22w%22%5D%3B%0Avar%20_nodeId%20%3D%200%3B%0Avar%20Node%20%3D%20class%20extends%20EventDispatcher2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22Node%22%3B%0A%20%20%7D%0A%20%20constructor%28nodeType%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.nodeType%20%3D%20nodeType%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.NONE%3B%0A%20%20%20%20this.updateBeforeType%20%3D%20NodeUpdateType.NONE%3B%0A%20%20%20%20this.updateAfterType%20%3D%20NodeUpdateType.NONE%3B%0A%20%20%20%20this.uuid%20%3D%20MathUtils2.generateUUID%28%29%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%20%20this._cacheKey%20%3D%20null%3B%0A%20%20%20%20this._cacheKeyVersion%20%3D%200%3B%0A%20%20%20%20this.global%20%3D%20false%3B%0A%20%20%20%20this.isNode%20%3D%20true%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22id%22%2C%20%7B%20value%3A%20_nodeId%2B%2B%20%7D%29%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20get%20type%28%29%20%7B%0A%20%20%20%20return%20this.constructor.type%3B%0A%20%20%7D%0A%20%20onUpdate%28callback%2C%20updateType%29%20%7B%0A%20%20%20%20this.updateType%20%3D%20updateType%3B%0A%20%20%20%20this.update%20%3D%20callback.bind%28this.getSelf%28%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20onFrameUpdate%28callback%29%20%7B%0A%20%20%20%20return%20this.onUpdate%28callback%2C%20NodeUpdateType.FRAME%29%3B%0A%20%20%7D%0A%20%20onRenderUpdate%28callback%29%20%7B%0A%20%20%20%20return%20this.onUpdate%28callback%2C%20NodeUpdateType.RENDER%29%3B%0A%20%20%7D%0A%20%20onObjectUpdate%28callback%29%20%7B%0A%20%20%20%20return%20this.onUpdate%28callback%2C%20NodeUpdateType.OBJECT%29%3B%0A%20%20%7D%0A%20%20onReference%28callback%29%20%7B%0A%20%20%20%20this.updateReference%20%3D%20callback.bind%28this.getSelf%28%29%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getSelf%28%29%20%7B%0A%20%20%20%20return%20this.self%20%7C%7C%20this%3B%0A%20%20%7D%0A%20%20updateReference%28%29%20%7B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20isGlobal%28%29%20%7B%0A%20%20%20%20return%20this.global%3B%0A%20%20%7D%0A%20%20%2AgetChildren%28%29%20%7B%0A%20%20%20%20for%20%28const%20%7B%20childNode%20%7D%20of%20getNodeChildren%28this%29%29%20%7B%0A%20%20%20%20%20%20yield%20childNode%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%20%20traverse%28callback%29%20%7B%0A%20%20%20%20callback%28this%29%3B%0A%20%20%20%20for%20%28const%20childNode%20of%20this.getChildren%28%29%29%20%7B%0A%20%20%20%20%20%20childNode.traverse%28callback%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getCacheKey%28force%20%3D%20false%29%20%7B%0A%20%20%20%20force%20%3D%20force%20%7C%7C%20this.version%20%21%3D%3D%20this._cacheKeyVersion%3B%0A%20%20%20%20if%20%28force%20%3D%3D%3D%20true%20%7C%7C%20this._cacheKey%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._cacheKey%20%3D%20getCacheKey%241%28this%2C%20force%29%3B%0A%20%20%20%20%20%20this._cacheKeyVersion%20%3D%20this.version%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this._cacheKey%3B%0A%20%20%7D%0A%20%20getScope%28%29%20%7B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getHash%28%29%20%7B%0A%20%20%20%20return%20this.uuid%3B%0A%20%20%7D%0A%20%20getUpdateType%28%29%20%7B%0A%20%20%20%20return%20this.updateType%3B%0A%20%20%7D%0A%20%20getUpdateBeforeType%28%29%20%7B%0A%20%20%20%20return%20this.updateBeforeType%3B%0A%20%20%7D%0A%20%20getUpdateAfterType%28%29%20%7B%0A%20%20%20%20return%20this.updateAfterType%3B%0A%20%20%7D%0A%20%20getElementType%28builder%29%20%7B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20elementType%20%3D%20builder.getElementType%28type%29%3B%0A%20%20%20%20return%20elementType%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20const%20nodeProperties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20if%20%28nodeProperties.outputNode%29%20%7B%0A%20%20%20%20%20%20return%20nodeProperties.outputNode.getNodeType%28builder%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.nodeType%3B%0A%20%20%7D%0A%20%20getShared%28builder%29%20%7B%0A%20%20%20%20const%20hash%20%3D%20this.getHash%28builder%29%3B%0A%20%20%20%20const%20nodeFromHash%20%3D%20builder.getNodeFromHash%28hash%29%3B%0A%20%20%20%20return%20nodeFromHash%20%7C%7C%20this%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20nodeProperties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20let%20index5%20%3D%200%3B%0A%20%20%20%20for%20%28const%20childNode%20of%20this.getChildren%28%29%29%20%7B%0A%20%20%20%20%20%20nodeProperties%5B%22node%22%20%2B%20index5%2B%2B%5D%20%3D%20childNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%20%20analyze%28builder%29%20%7B%0A%20%20%20%20const%20usageCount%20%3D%20builder.increaseUsage%28this%29%3B%0A%20%20%20%20if%20%28usageCount%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20const%20nodeProperties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20%20%20for%20%28const%20childNode%20of%20Object.values%28nodeProperties%29%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28childNode%20%26%26%20childNode.isNode%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20childNode.build%28builder%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20%7B%20outputNode%20%7D%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20if%20%28outputNode%20%26%26%20outputNode.isNode%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20return%20outputNode.build%28builder%2C%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateBefore%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20updateAfter%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20build%28builder%2C%20output2%20%3D%20null%29%20%7B%0A%20%20%20%20const%20refNode%20%3D%20this.getShared%28builder%29%3B%0A%20%20%20%20if%20%28this%20%21%3D%3D%20refNode%29%20%7B%0A%20%20%20%20%20%20return%20refNode.build%28builder%2C%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20builder.addNode%28this%29%3B%0A%20%20%20%20builder.addChain%28this%29%3B%0A%20%20%20%20let%20result%20%3D%20null%3B%0A%20%20%20%20const%20buildStage%20%3D%20builder.getBuildStage%28%29%3B%0A%20%20%20%20if%20%28buildStage%20%3D%3D%3D%20%22setup%22%29%20%7B%0A%20%20%20%20%20%20this.updateReference%28builder%29%3B%0A%20%20%20%20%20%20const%20properties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20%20%20if%20%28properties.initialized%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20const%20stackNodesBeforeSetup%20%3D%20builder.stack.nodes.length%3B%0A%20%20%20%20%20%20%20%20properties.initialized%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20properties.outputNode%20%3D%20this.setup%28builder%29%3B%0A%20%20%20%20%20%20%20%20if%20%28properties.outputNode%20%21%3D%3D%20null%20%26%26%20builder.stack.nodes.length%20%21%3D%3D%20stackNodesBeforeSetup%29%20%3B%0A%20%20%20%20%20%20%20%20for%20%28const%20childNode%20of%20Object.values%28properties%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28childNode%20%26%26%20childNode.isNode%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20childNode.build%28builder%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28buildStage%20%3D%3D%3D%20%22analyze%22%29%20%7B%0A%20%20%20%20%20%20this.analyze%28builder%29%3B%0A%20%20%20%20%7D%20else%20if%20%28buildStage%20%3D%3D%3D%20%22generate%22%29%20%7B%0A%20%20%20%20%20%20const%20isGenerateOnce%20%3D%20this.generate.length%20%3D%3D%3D%201%3B%0A%20%20%20%20%20%20if%20%28isGenerateOnce%29%20%7B%0A%20%20%20%20%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20%20%20%20%20const%20nodeData%20%3D%20builder.getDataFromNode%28this%29%3B%0A%20%20%20%20%20%20%20%20result%20%3D%20nodeData.snippet%3B%0A%20%20%20%20%20%20%20%20if%20%28result%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20result%20%3D%20this.generate%28builder%29%20%7C%7C%20%22%22%3B%0A%20%20%20%20%20%20%20%20%20%20nodeData.snippet%20%3D%20result%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28nodeData.flowCodes%20%21%3D%3D%20void%200%20%26%26%20builder.context.nodeBlock%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20builder.addFlowCodeHierarchy%28this%2C%20builder.context.nodeBlock%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20result%20%3D%20builder.format%28result%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20result%20%3D%20this.generate%28builder%2C%20output2%29%20%7C%7C%20%22%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20builder.removeChain%28this%29%3B%0A%20%20%20%20builder.addSequentialNode%28this%29%3B%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20getSerializeChildren%28%29%20%7B%0A%20%20%20%20return%20getNodeChildren%28this%29%3B%0A%20%20%7D%0A%20%20serialize%28json%29%20%7B%0A%20%20%20%20const%20nodeChildren%20%3D%20this.getSerializeChildren%28%29%3B%0A%20%20%20%20const%20inputNodes%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20%7B%20property%3A%20property2%2C%20index%3A%20index5%2C%20childNode%20%7D%20of%20nodeChildren%29%20%7B%0A%20%20%20%20%20%20if%20%28index5%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28inputNodes%5Bproperty2%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20inputNodes%5Bproperty2%5D%20%3D%20Number.isInteger%28index5%29%20%3F%20%5B%5D%20%3A%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20inputNodes%5Bproperty2%5D%5Bindex5%5D%20%3D%20childNode.toJSON%28json.meta%29.uuid%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20inputNodes%5Bproperty2%5D%20%3D%20childNode.toJSON%28json.meta%29.uuid%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28Object.keys%28inputNodes%29.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20json.inputNodes%20%3D%20inputNodes%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20deserialize%28json%29%20%7B%0A%20%20%20%20if%20%28json.inputNodes%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20nodes%20%3D%20json.meta.nodes%3B%0A%20%20%20%20%20%20for%20%28const%20property2%20in%20json.inputNodes%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28Array.isArray%28json.inputNodes%5Bproperty2%5D%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20inputArray%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28const%20uuid%20of%20json.inputNodes%5Bproperty2%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20inputArray.push%28nodes%5Buuid%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20this%5Bproperty2%5D%20%3D%20inputArray%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20json.inputNodes%5Bproperty2%5D%20%3D%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20inputObject%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28const%20subProperty%20in%20json.inputNodes%5Bproperty2%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20uuid%20%3D%20json.inputNodes%5Bproperty2%5D%5BsubProperty%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20inputObject%5BsubProperty%5D%20%3D%20nodes%5Buuid%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20this%5Bproperty2%5D%20%3D%20inputObject%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20uuid%20%3D%20json.inputNodes%5Bproperty2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20this%5Bproperty2%5D%20%3D%20nodes%5Buuid%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20%7B%20uuid%2C%20type%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20isRoot%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20if%20%28isRoot%29%20%7B%0A%20%20%20%20%20%20meta%20%3D%20%7B%0A%20%20%20%20%20%20%20%20textures%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20images%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20nodes%3A%20%7B%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20data%20%3D%20meta.nodes%5Buuid%5D%3B%0A%20%20%20%20if%20%28data%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20data%20%3D%20%7B%0A%20%20%20%20%20%20%20%20uuid%2C%0A%20%20%20%20%20%20%20%20type%2C%0A%20%20%20%20%20%20%20%20meta%2C%0A%20%20%20%20%20%20%20%20metadata%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20version%3A%204.6%2C%0A%20%20%20%20%20%20%20%20%20%20type%3A%20%22Node%22%2C%0A%20%20%20%20%20%20%20%20%20%20generator%3A%20%22Node.toJSON%22%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20if%20%28isRoot%20%21%3D%3D%20true%29%20meta.nodes%5Bdata.uuid%5D%20%3D%20data%3B%0A%20%20%20%20%20%20this.serialize%28data%29%3B%0A%20%20%20%20%20%20delete%20data.meta%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20extractFromCache%28cache2%29%20%7B%0A%20%20%20%20%20%20const%20values%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28const%20key%20in%20cache2%29%20%7B%0A%20%20%20%20%20%20%20%20const%20data2%20%3D%20cache2%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20delete%20data2.metadata%3B%0A%20%20%20%20%20%20%20%20values.push%28data2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20values%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isRoot%29%20%7B%0A%20%20%20%20%20%20const%20textures%20%3D%20extractFromCache%28meta.textures%29%3B%0A%20%20%20%20%20%20const%20images%20%3D%20extractFromCache%28meta.images%29%3B%0A%20%20%20%20%20%20const%20nodes%20%3D%20extractFromCache%28meta.nodes%29%3B%0A%20%20%20%20%20%20if%20%28textures.length%20%3E%200%29%20data.textures%20%3D%20textures%3B%0A%20%20%20%20%20%20if%20%28images.length%20%3E%200%29%20data.images%20%3D%20images%3B%0A%20%20%20%20%20%20if%20%28nodes.length%20%3E%200%29%20data.nodes%20%3D%20nodes%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ArrayElementNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ArrayElementNode%22%3B%0A%20%20%7D%0A%20%20%2F%2F%20%40TODO%3A%20If%20extending%20from%20TempNode%20it%20breaks%20webgpu_compute%0A%20%20constructor%28node%2C%20indexNode%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%20%20this.indexNode%20%3D%20indexNode%3B%0A%20%20%20%20this.isArrayElementNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.node.getElementType%28builder%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20nodeSnippet%20%3D%20this.node.build%28builder%29%3B%0A%20%20%20%20const%20indexSnippet%20%3D%20this.indexNode.build%28builder%2C%20%22uint%22%29%3B%0A%20%20%20%20return%20%60%24%7BnodeSnippet%7D%5B%20%24%7BindexSnippet%7D%20%5D%60%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ConvertNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ConvertNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%2C%20convertTo%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%20%20this.convertTo%20%3D%20convertTo%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20const%20requestType%20%3D%20this.node.getNodeType%28builder%29%3B%0A%20%20%20%20let%20convertTo%20%3D%20null%3B%0A%20%20%20%20for%20%28const%20overloadingType%20of%20this.convertTo.split%28%22%7C%22%29%29%20%7B%0A%20%20%20%20%20%20if%20%28convertTo%20%3D%3D%3D%20null%20%7C%7C%20builder.getTypeLength%28requestType%29%20%3D%3D%3D%20builder.getTypeLength%28overloadingType%29%29%20%7B%0A%20%20%20%20%20%20%20%20convertTo%20%3D%20overloadingType%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20convertTo%3B%0A%20%20%7D%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.convertTo%20%3D%20this.convertTo%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.convertTo%20%3D%20data.convertTo%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20node%20%3D%20this.node%3B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20snippet%20%3D%20node.build%28builder%2C%20type%29%3B%0A%20%20%20%20return%20builder.format%28snippet%2C%20type%2C%20output2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20TempNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22TempNode%22%3B%0A%20%20%7D%0A%20%20constructor%28type%29%20%7B%0A%20%20%20%20super%28type%29%3B%0A%20%20%20%20this.isTempNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20hasDependencies%28builder%29%20%7B%0A%20%20%20%20return%20builder.getDataFromNode%28this%29.usageCount%20%3E%201%3B%0A%20%20%7D%0A%20%20build%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20buildStage%20%3D%20builder.getBuildStage%28%29%3B%0A%20%20%20%20if%20%28buildStage%20%3D%3D%3D%20%22generate%22%29%20%7B%0A%20%20%20%20%20%20const%20type%20%3D%20builder.getVectorType%28this.getNodeType%28builder%2C%20output2%29%29%3B%0A%20%20%20%20%20%20const%20nodeData%20%3D%20builder.getDataFromNode%28this%29%3B%0A%20%20%20%20%20%20if%20%28nodeData.propertyName%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20builder.format%28nodeData.propertyName%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28type%20%21%3D%3D%20%22void%22%20%26%26%20output2%20%21%3D%3D%20%22void%22%20%26%26%20this.hasDependencies%28builder%29%29%20%7B%0A%20%20%20%20%20%20%20%20const%20snippet%20%3D%20super.build%28builder%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20const%20nodeVar%20%3D%20builder.getVarFromNode%28this%2C%20null%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20const%20propertyName%20%3D%20builder.getPropertyName%28nodeVar%29%3B%0A%20%20%20%20%20%20%20%20builder.addLineFlowCode%28%60%24%7BpropertyName%7D%20%3D%20%24%7Bsnippet%7D%60%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20nodeData.snippet%20%3D%20snippet%3B%0A%20%20%20%20%20%20%20%20nodeData.propertyName%20%3D%20propertyName%3B%0A%20%20%20%20%20%20%20%20return%20builder.format%28nodeData.propertyName%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20super.build%28builder%2C%20output2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20JoinNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22JoinNode%22%3B%0A%20%20%7D%0A%20%20constructor%28nodes%20%3D%20%5B%5D%2C%20nodeType%20%3D%20null%29%20%7B%0A%20%20%20%20super%28nodeType%29%3B%0A%20%20%20%20this.nodes%20%3D%20nodes%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20if%20%28this.nodeType%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20builder.getVectorType%28this.nodeType%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20builder.getTypeFromLength%28this.nodes.reduce%28%28count%2C%20cur%29%20%3D%3E%20count%20%2B%20builder.getTypeLength%28cur.getNodeType%28builder%29%29%2C%200%29%29%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20nodes%20%3D%20this.nodes%3B%0A%20%20%20%20const%20primitiveType%20%3D%20builder.getComponentType%28type%29%3B%0A%20%20%20%20const%20snippetValues%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28const%20input%20of%20nodes%29%20%7B%0A%20%20%20%20%20%20let%20inputSnippet%20%3D%20input.build%28builder%29%3B%0A%20%20%20%20%20%20const%20inputPrimitiveType%20%3D%20builder.getComponentType%28input.getNodeType%28builder%29%29%3B%0A%20%20%20%20%20%20if%20%28inputPrimitiveType%20%21%3D%3D%20primitiveType%29%20%7B%0A%20%20%20%20%20%20%20%20inputSnippet%20%3D%20builder.format%28inputSnippet%2C%20inputPrimitiveType%2C%20primitiveType%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20snippetValues.push%28inputSnippet%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20snippet%20%3D%20%60%24%7Bbuilder.getType%28type%29%7D%28%20%24%7BsnippetValues.join%28%22%2C%20%22%29%7D%20%29%60%3B%0A%20%20%20%20return%20builder.format%28snippet%2C%20type%2C%20output2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20stringVectorComponents%20%3D%20vectorComponents.join%28%22%22%29%3B%0Avar%20SplitNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22SplitNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%2C%20components%20%3D%20%22x%22%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%20%20this.components%20%3D%20components%3B%0A%20%20%20%20this.isSplitNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getVectorLength%28%29%20%7B%0A%20%20%20%20let%20vectorLength%20%3D%20this.components.length%3B%0A%20%20%20%20for%20%28const%20c2%20of%20this.components%29%20%7B%0A%20%20%20%20%20%20vectorLength%20%3D%20Math.max%28vectorComponents.indexOf%28c2%29%20%2B%201%2C%20vectorLength%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20vectorLength%3B%0A%20%20%7D%0A%20%20getComponentType%28builder%29%20%7B%0A%20%20%20%20return%20builder.getComponentType%28this.node.getNodeType%28builder%29%29%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20builder.getTypeFromLength%28this.components.length%2C%20this.getComponentType%28builder%29%29%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20node%20%3D%20this.node%3B%0A%20%20%20%20const%20nodeTypeLength%20%3D%20builder.getTypeLength%28node.getNodeType%28builder%29%29%3B%0A%20%20%20%20let%20snippet%20%3D%20null%3B%0A%20%20%20%20if%20%28nodeTypeLength%20%3E%201%29%20%7B%0A%20%20%20%20%20%20let%20type%20%3D%20null%3B%0A%20%20%20%20%20%20const%20componentsLength%20%3D%20this.getVectorLength%28%29%3B%0A%20%20%20%20%20%20if%20%28componentsLength%20%3E%3D%20nodeTypeLength%29%20%7B%0A%20%20%20%20%20%20%20%20type%20%3D%20builder.getTypeFromLength%28this.getVectorLength%28%29%2C%20this.getComponentType%28builder%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20nodeSnippet%20%3D%20node.build%28builder%2C%20type%29%3B%0A%20%20%20%20%20%20if%20%28this.components.length%20%3D%3D%3D%20nodeTypeLength%20%26%26%20this.components%20%3D%3D%3D%20stringVectorComponents.slice%280%2C%20this.components.length%29%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20builder.format%28nodeSnippet%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20builder.format%28%60%24%7BnodeSnippet%7D.%24%7Bthis.components%7D%60%2C%20this.getNodeType%28builder%29%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20node.build%28builder%2C%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippet%3B%0A%20%20%7D%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.components%20%3D%20this.components%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.components%20%3D%20data.components%3B%0A%20%20%7D%0A%7D%3B%0Avar%20SetNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22SetNode%22%3B%0A%20%20%7D%0A%20%20constructor%28sourceNode%2C%20components%2C%20targetNode%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.sourceNode%20%3D%20sourceNode%3B%0A%20%20%20%20this.components%20%3D%20components%3B%0A%20%20%20%20this.targetNode%20%3D%20targetNode%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.sourceNode.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20sourceNode%2C%20components%2C%20targetNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20sourceType%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20targetType%20%3D%20builder.getTypeFromLength%28components.length%2C%20targetNode.getNodeType%28builder%29%29%3B%0A%20%20%20%20const%20targetSnippet%20%3D%20targetNode.build%28builder%2C%20targetType%29%3B%0A%20%20%20%20const%20sourceSnippet%20%3D%20sourceNode.build%28builder%2C%20sourceType%29%3B%0A%20%20%20%20const%20length2%20%3D%20builder.getTypeLength%28sourceType%29%3B%0A%20%20%20%20const%20snippetValues%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20length2%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20component%20%3D%20vectorComponents%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28component%20%3D%3D%3D%20components%5B0%5D%29%20%7B%0A%20%20%20%20%20%20%20%20snippetValues.push%28targetSnippet%29%3B%0A%20%20%20%20%20%20%20%20i%20%2B%3D%20components.length%20-%201%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20snippetValues.push%28sourceSnippet%20%2B%20%22.%22%20%2B%20component%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20%60%24%7Bbuilder.getType%28sourceType%29%7D%28%20%24%7BsnippetValues.join%28%22%2C%20%22%29%7D%20%29%60%3B%0A%20%20%7D%0A%7D%3B%0Avar%20FlipNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22FlipNode%22%3B%0A%20%20%7D%0A%20%20constructor%28sourceNode%2C%20components%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.sourceNode%20%3D%20sourceNode%3B%0A%20%20%20%20this.components%20%3D%20components%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.sourceNode.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20components%2C%20sourceNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20sourceType%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20sourceSnippet%20%3D%20sourceNode.build%28builder%29%3B%0A%20%20%20%20const%20sourceCache%20%3D%20builder.getVarFromNode%28this%29%3B%0A%20%20%20%20const%20sourceProperty%20%3D%20builder.getPropertyName%28sourceCache%29%3B%0A%20%20%20%20builder.addLineFlowCode%28sourceProperty%20%2B%20%22%20%3D%20%22%20%2B%20sourceSnippet%2C%20this%29%3B%0A%20%20%20%20const%20length2%20%3D%20builder.getTypeLength%28sourceType%29%3B%0A%20%20%20%20const%20snippetValues%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20componentIndex%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20length2%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20component%20%3D%20vectorComponents%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28component%20%3D%3D%3D%20components%5BcomponentIndex%5D%29%20%7B%0A%20%20%20%20%20%20%20%20snippetValues.push%28%221.0%20-%20%22%20%2B%20%28sourceProperty%20%2B%20%22.%22%20%2B%20component%29%29%3B%0A%20%20%20%20%20%20%20%20componentIndex%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20snippetValues.push%28sourceProperty%20%2B%20%22.%22%20%2B%20component%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20%60%24%7Bbuilder.getType%28sourceType%29%7D%28%20%24%7BsnippetValues.join%28%22%2C%20%22%29%7D%20%29%60%3B%0A%20%20%7D%0A%7D%3B%0Avar%20InputNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22InputNode%22%3B%0A%20%20%7D%0A%20%20constructor%28value%2C%20nodeType%20%3D%20null%29%20%7B%0A%20%20%20%20super%28nodeType%29%3B%0A%20%20%20%20this.isInputNode%20%3D%20true%3B%0A%20%20%20%20this.value%20%3D%20value%3B%0A%20%20%20%20this.precision%20%3D%20null%3B%0A%20%20%7D%0A%20%20getNodeType%28%29%20%7B%0A%20%20%20%20if%20%28this.nodeType%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20getValueType%28this.value%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.nodeType%3B%0A%20%20%7D%0A%20%20getInputType%28builder%29%20%7B%0A%20%20%20%20return%20this.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20setPrecision%28precision%29%20%7B%0A%20%20%20%20this.precision%20%3D%20precision%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.value%20%3D%20this.value%3B%0A%20%20%20%20if%20%28this.value%20%26%26%20this.value.toArray%29%20data.value%20%3D%20this.value.toArray%28%29%3B%0A%20%20%20%20data.valueType%20%3D%20getValueType%28this.value%29%3B%0A%20%20%20%20data.nodeType%20%3D%20this.nodeType%3B%0A%20%20%20%20if%20%28data.valueType%20%3D%3D%3D%20%22ArrayBuffer%22%29%20data.value%20%3D%20arrayBufferToBase64%28data.value%29%3B%0A%20%20%20%20data.precision%20%3D%20this.precision%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.nodeType%20%3D%20data.nodeType%3B%0A%20%20%20%20this.value%20%3D%20Array.isArray%28data.value%29%20%3F%20getValueFromType%28data.valueType%2C%20...data.value%29%20%3A%20data.value%3B%0A%20%20%20%20this.precision%20%3D%20data.precision%20%7C%7C%20null%3B%0A%20%20%20%20if%20%28this.value%20%26%26%20this.value.fromArray%29%20this.value%20%3D%20this.value.fromArray%28data.value%29%3B%0A%20%20%7D%0A%20%20generate%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ConstNode%20%3D%20class%20extends%20InputNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ConstNode%22%3B%0A%20%20%7D%0A%20%20constructor%28value%2C%20nodeType%20%3D%20null%29%20%7B%0A%20%20%20%20super%28value%2C%20nodeType%29%3B%0A%20%20%20%20this.isConstNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20generateConst%28builder%29%20%7B%0A%20%20%20%20return%20builder.generateConst%28this.getNodeType%28builder%29%2C%20this.value%29%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20return%20builder.format%28this.generateConst%28builder%29%2C%20type%2C%20output2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20currentStack%20%3D%20null%3B%0Avar%20NodeElements%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0Afunction%20addMethodChaining%28name%2C%20nodeElement%29%20%7B%0A%20%20if%20%28NodeElements.has%28name%29%29%20%7B%0A%20%20%20%20console.warn%28%60Redefinition%20of%20method%20chaining%20%24%7Bname%7D%60%29%3B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%20%20if%20%28typeof%20nodeElement%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%28%60Node%20element%20%24%7Bname%7D%20is%20not%20a%20function%60%29%3B%0A%20%20NodeElements.set%28name%2C%20nodeElement%29%3B%0A%7D%0Avar%20parseSwizzle%20%3D%20%28props%29%20%3D%3E%20props.replace%28%2Fr%7Cs%2Fg%2C%20%22x%22%29.replace%28%2Fg%7Ct%2Fg%2C%20%22y%22%29.replace%28%2Fb%7Cp%2Fg%2C%20%22z%22%29.replace%28%2Fa%7Cq%2Fg%2C%20%22w%22%29%3B%0Avar%20parseSwizzleAndSort%20%3D%20%28props%29%20%3D%3E%20parseSwizzle%28props%29.split%28%22%22%29.sort%28%29.join%28%22%22%29%3B%0Avar%20shaderNodeHandler%20%3D%20%7B%0A%20%20setup%28NodeClosure%2C%20params%29%20%7B%0A%20%20%20%20const%20inputs%20%3D%20params.shift%28%29%3B%0A%20%20%20%20return%20NodeClosure%28nodeObjects%28inputs%29%2C%20...params%29%3B%0A%20%20%7D%2C%0A%20%20get%28node%2C%20prop%2C%20nodeObj%29%20%7B%0A%20%20%20%20if%20%28typeof%20prop%20%3D%3D%3D%20%22string%22%20%26%26%20node%5Bprop%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28node.isStackNode%20%21%3D%3D%20true%20%26%26%20prop%20%3D%3D%3D%20%22assign%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%28...params%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20currentStack.assign%28nodeObj%2C%20...params%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%20nodeObj%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28NodeElements.has%28prop%29%29%20%7B%0A%20%20%20%20%20%20%20%20const%20nodeElement%20%3D%20NodeElements.get%28prop%29%3B%0A%20%20%20%20%20%20%20%20return%20node.isStackNode%20%3F%20%28...params%29%20%3D%3E%20nodeObj.add%28nodeElement%28...params%29%29%20%3A%20%28...params%29%20%3D%3E%20nodeElement%28nodeObj%2C%20...params%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28prop%20%3D%3D%3D%20%22self%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%20node%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28prop.endsWith%28%22Assign%22%29%20%26%26%20NodeElements.has%28prop.slice%280%2C%20prop.length%20-%20%22Assign%22.length%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20const%20nodeElement%20%3D%20NodeElements.get%28prop.slice%280%2C%20prop.length%20-%20%22Assign%22.length%29%29%3B%0A%20%20%20%20%20%20%20%20return%20node.isStackNode%20%3F%20%28...params%29%20%3D%3E%20nodeObj.assign%28params%5B0%5D%2C%20nodeElement%28...params%29%29%20%3A%20%28...params%29%20%3D%3E%20nodeObj.assign%28nodeElement%28nodeObj%2C%20...params%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28%2F%5E%5Bxyzwrgbastpq%5D%7B1%2C4%7D%24%2F.test%28prop%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20prop%20%3D%20parseSwizzle%28prop%29%3B%0A%20%20%20%20%20%20%20%20return%20nodeObject%28new%20SplitNode%28nodeObj%2C%20prop%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28%2F%5Eset%5BXYZWRGBASTPQ%5D%7B1%2C4%7D%24%2F.test%28prop%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20prop%20%3D%20parseSwizzleAndSort%28prop.slice%283%29.toLowerCase%28%29%29%3B%0A%20%20%20%20%20%20%20%20return%20%28value%29%20%3D%3E%20nodeObject%28new%20SetNode%28node%2C%20prop%2C%20value%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28%2F%5Eflip%5BXYZWRGBASTPQ%5D%7B1%2C4%7D%24%2F.test%28prop%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20prop%20%3D%20parseSwizzleAndSort%28prop.slice%284%29.toLowerCase%28%29%29%3B%0A%20%20%20%20%20%20%20%20return%20%28%29%20%3D%3E%20nodeObject%28new%20FlipNode%28nodeObject%28node%29%2C%20prop%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28prop%20%3D%3D%3D%20%22width%22%20%7C%7C%20prop%20%3D%3D%3D%20%22height%22%20%7C%7C%20prop%20%3D%3D%3D%20%22depth%22%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28prop%20%3D%3D%3D%20%22width%22%29%20prop%20%3D%20%22x%22%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28prop%20%3D%3D%3D%20%22height%22%29%20prop%20%3D%20%22y%22%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28prop%20%3D%3D%3D%20%22depth%22%29%20prop%20%3D%20%22z%22%3B%0A%20%20%20%20%20%20%20%20return%20nodeObject%28new%20SplitNode%28node%2C%20prop%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28%2F%5E%5Cd%2B%24%2F.test%28prop%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20return%20nodeObject%28new%20ArrayElementNode%28nodeObj%2C%20new%20ConstNode%28Number%28prop%29%2C%20%22uint%22%29%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20Reflect.get%28node%2C%20prop%2C%20nodeObj%29%3B%0A%20%20%7D%2C%0A%20%20set%28node%2C%20prop%2C%20value%2C%20nodeObj%29%20%7B%0A%20%20%20%20if%20%28typeof%20prop%20%3D%3D%3D%20%22string%22%20%26%26%20node%5Bprop%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28%2F%5E%5Bxyzwrgbastpq%5D%7B1%2C4%7D%24%2F.test%28prop%29%20%3D%3D%3D%20true%20%7C%7C%20prop%20%3D%3D%3D%20%22width%22%20%7C%7C%20prop%20%3D%3D%3D%20%22height%22%20%7C%7C%20prop%20%3D%3D%3D%20%22depth%22%20%7C%7C%20%2F%5E%5Cd%2B%24%2F.test%28prop%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20nodeObj%5Bprop%5D.assign%28value%29%3B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20Reflect.set%28node%2C%20prop%2C%20value%2C%20nodeObj%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20nodeObjectsCacheMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Avar%20nodeBuilderFunctionsCacheMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Avar%20ShaderNodeObject%20%3D%20function%28obj%2C%20altType%20%3D%20null%29%20%7B%0A%20%20const%20type%20%3D%20getValueType%28obj%29%3B%0A%20%20if%20%28type%20%3D%3D%3D%20%22node%22%29%20%7B%0A%20%20%20%20let%20nodeObject2%20%3D%20nodeObjectsCacheMap.get%28obj%29%3B%0A%20%20%20%20if%20%28nodeObject2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20nodeObject2%20%3D%20new%20Proxy%28obj%2C%20shaderNodeHandler%29%3B%0A%20%20%20%20%20%20nodeObjectsCacheMap.set%28obj%2C%20nodeObject2%29%3B%0A%20%20%20%20%20%20nodeObjectsCacheMap.set%28nodeObject2%2C%20nodeObject2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeObject2%3B%0A%20%20%7D%20else%20if%20%28altType%20%3D%3D%3D%20null%20%26%26%20%28type%20%3D%3D%3D%20%22float%22%20%7C%7C%20type%20%3D%3D%3D%20%22boolean%22%29%20%7C%7C%20type%20%26%26%20type%20%21%3D%3D%20%22shader%22%20%26%26%20type%20%21%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20return%20nodeObject%28getConstNode%28obj%2C%20altType%29%29%3B%0A%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22shader%22%29%20%7B%0A%20%20%20%20return%20Fn%28obj%29%3B%0A%20%20%7D%0A%20%20return%20obj%3B%0A%7D%3B%0Avar%20ShaderNodeObjects%20%3D%20function%28objects%2C%20altType%20%3D%20null%29%20%7B%0A%20%20for%20%28const%20name%20in%20objects%29%20%7B%0A%20%20%20%20objects%5Bname%5D%20%3D%20nodeObject%28objects%5Bname%5D%2C%20altType%29%3B%0A%20%20%7D%0A%20%20return%20objects%3B%0A%7D%3B%0Avar%20ShaderNodeArray%20%3D%20function%28array%2C%20altType%20%3D%20null%29%20%7B%0A%20%20const%20len%20%3D%20array.length%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20len%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20array%5Bi%5D%20%3D%20nodeObject%28array%5Bi%5D%2C%20altType%29%3B%0A%20%20%7D%0A%20%20return%20array%3B%0A%7D%3B%0Avar%20ShaderNodeProxy%20%3D%20function%28NodeClass%2C%20scope%20%3D%20null%2C%20factor%20%3D%20null%2C%20settings%20%3D%20null%29%20%7B%0A%20%20const%20assignNode%20%3D%20%28node%29%20%3D%3E%20nodeObject%28settings%20%21%3D%3D%20null%20%3F%20Object.assign%28node%2C%20settings%29%20%3A%20node%29%3B%0A%20%20if%20%28scope%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20return%20%28...params%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20return%20assignNode%28new%20NodeClass%28...nodeArray%28params%29%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%20else%20if%20%28factor%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20factor%20%3D%20nodeObject%28factor%29%3B%0A%20%20%20%20return%20%28...params%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20return%20assignNode%28new%20NodeClass%28scope%2C%20...nodeArray%28params%29%2C%20factor%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20%28...params%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20return%20assignNode%28new%20NodeClass%28scope%2C%20...nodeArray%28params%29%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ShaderNodeImmutable%20%3D%20function%28NodeClass%2C%20...params%29%20%7B%0A%20%20return%20nodeObject%28new%20NodeClass%28...nodeArray%28params%29%29%29%3B%0A%7D%3B%0Avar%20ShaderCallNodeInternal%20%3D%20class%20extends%20Node%20%7B%0A%20%20constructor%28shaderNode%2C%20inputNodes%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.shaderNode%20%3D%20shaderNode%3B%0A%20%20%20%20this.inputNodes%20%3D%20inputNodes%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.shaderNode.nodeType%20%7C%7C%20this.getOutputNode%28builder%29.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20call%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20shaderNode%2C%20inputNodes%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20properties%20%3D%20builder.getNodeProperties%28shaderNode%29%3B%0A%20%20%20%20if%20%28properties.onceOutput%29%20return%20properties.onceOutput%3B%0A%20%20%20%20let%20result%20%3D%20null%3B%0A%20%20%20%20if%20%28shaderNode.layout%29%20%7B%0A%20%20%20%20%20%20let%20functionNodesCacheMap%20%3D%20nodeBuilderFunctionsCacheMap.get%28builder.constructor%29%3B%0A%20%20%20%20%20%20if%20%28functionNodesCacheMap%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20functionNodesCacheMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20%20%20%20%20nodeBuilderFunctionsCacheMap.set%28builder.constructor%2C%20functionNodesCacheMap%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20functionNode%20%3D%20functionNodesCacheMap.get%28shaderNode%29%3B%0A%20%20%20%20%20%20if%20%28functionNode%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20functionNode%20%3D%20nodeObject%28builder.buildFunctionNode%28shaderNode%29%29%3B%0A%20%20%20%20%20%20%20%20functionNodesCacheMap.set%28shaderNode%2C%20functionNode%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28builder.currentFunctionNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20builder.currentFunctionNode.includes.push%28functionNode%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20result%20%3D%20nodeObject%28functionNode.call%28inputNodes%29%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20jsFunc%20%3D%20shaderNode.jsFunc%3B%0A%20%20%20%20%20%20const%20outputNode%20%3D%20inputNodes%20%21%3D%3D%20null%20%3F%20jsFunc%28inputNodes%2C%20builder%29%20%3A%20jsFunc%28builder%29%3B%0A%20%20%20%20%20%20result%20%3D%20nodeObject%28outputNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28shaderNode.once%29%20%7B%0A%20%20%20%20%20%20properties.onceOutput%20%3D%20result%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20getOutputNode%28builder%29%20%7B%0A%20%20%20%20const%20properties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20if%20%28properties.outputNode%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20properties.outputNode%20%3D%20this.setupOutput%28builder%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20properties.outputNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20return%20this.getOutputNode%28builder%29%3B%0A%20%20%7D%0A%20%20setupOutput%28builder%29%20%7B%0A%20%20%20%20builder.addStack%28%29%3B%0A%20%20%20%20builder.stack.outputNode%20%3D%20this.call%28builder%29%3B%0A%20%20%20%20return%20builder.removeStack%28%29%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20outputNode%20%3D%20this.getOutputNode%28builder%29%3B%0A%20%20%20%20return%20outputNode.build%28builder%2C%20output2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ShaderNodeInternal%20%3D%20class%20extends%20Node%20%7B%0A%20%20constructor%28jsFunc%2C%20nodeType%29%20%7B%0A%20%20%20%20super%28nodeType%29%3B%0A%20%20%20%20this.jsFunc%20%3D%20jsFunc%3B%0A%20%20%20%20this.layout%20%3D%20null%3B%0A%20%20%20%20this.global%20%3D%20true%3B%0A%20%20%20%20this.once%20%3D%20false%3B%0A%20%20%7D%0A%20%20setLayout%28layout%29%20%7B%0A%20%20%20%20this.layout%20%3D%20layout%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20call%28inputs%20%3D%20null%29%20%7B%0A%20%20%20%20nodeObjects%28inputs%29%3B%0A%20%20%20%20return%20nodeObject%28new%20ShaderCallNodeInternal%28this%2C%20inputs%29%29%3B%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20return%20this.call%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20bools%20%3D%20%5Bfalse%2C%20true%5D%3B%0Avar%20uints%20%3D%20%5B0%2C%201%2C%202%2C%203%5D%3B%0Avar%20ints%20%3D%20%5B-1%2C%20-2%5D%3B%0Avar%20floats%20%3D%20%5B0.5%2C%201.5%2C%201%20%2F%203%2C%201e-6%2C%201e6%2C%20Math.PI%2C%20Math.PI%20%2A%202%2C%201%20%2F%20Math.PI%2C%202%20%2F%20Math.PI%2C%201%20%2F%20%28Math.PI%20%2A%202%29%2C%20Math.PI%20%2F%202%5D%3B%0Avar%20boolsCacheMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0Afor%20%28const%20bool2%20of%20bools%29%20boolsCacheMap.set%28bool2%2C%20new%20ConstNode%28bool2%29%29%3B%0Avar%20uintsCacheMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0Afor%20%28const%20uint2%20of%20uints%29%20uintsCacheMap.set%28uint2%2C%20new%20ConstNode%28uint2%2C%20%22uint%22%29%29%3B%0Avar%20intsCacheMap%20%3D%20new%20Map%28%5B...uintsCacheMap%5D.map%28%28el%29%20%3D%3E%20new%20ConstNode%28el.value%2C%20%22int%22%29%29%29%3B%0Afor%20%28const%20int2%20of%20ints%29%20intsCacheMap.set%28int2%2C%20new%20ConstNode%28int2%2C%20%22int%22%29%29%3B%0Avar%20floatsCacheMap%20%3D%20new%20Map%28%5B...intsCacheMap%5D.map%28%28el%29%20%3D%3E%20new%20ConstNode%28el.value%29%29%29%3B%0Afor%20%28const%20float2%20of%20floats%29%20floatsCacheMap.set%28float2%2C%20new%20ConstNode%28float2%29%29%3B%0Afor%20%28const%20float2%20of%20floats%29%20floatsCacheMap.set%28-float2%2C%20new%20ConstNode%28-float2%29%29%3B%0Avar%20cacheMaps%20%3D%20%7B%20bool%3A%20boolsCacheMap%2C%20uint%3A%20uintsCacheMap%2C%20ints%3A%20intsCacheMap%2C%20float%3A%20floatsCacheMap%20%7D%3B%0Avar%20constNodesCacheMap%20%3D%20new%20Map%28%5B...boolsCacheMap%2C%20...floatsCacheMap%5D%29%3B%0Avar%20getConstNode%20%3D%20%28value%2C%20type%29%20%3D%3E%20%7B%0A%20%20if%20%28constNodesCacheMap.has%28value%29%29%20%7B%0A%20%20%20%20return%20constNodesCacheMap.get%28value%29%3B%0A%20%20%7D%20else%20if%20%28value.isNode%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20return%20value%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20new%20ConstNode%28value%2C%20type%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20safeGetNodeType%20%3D%20%28node%29%20%3D%3E%20%7B%0A%20%20try%20%7B%0A%20%20%20%20return%20node.getNodeType%28%29%3B%0A%20%20%7D%20catch%20%28_%29%20%7B%0A%20%20%20%20return%20void%200%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ConvertType%20%3D%20function%28type%2C%20cacheMap%20%3D%20null%29%20%7B%0A%20%20return%20%28...params%29%20%3D%3E%20%7B%0A%20%20%20%20if%20%28params.length%20%3D%3D%3D%200%20%7C%7C%20%21%5B%22bool%22%2C%20%22float%22%2C%20%22int%22%2C%20%22uint%22%5D.includes%28type%29%20%26%26%20params.every%28%28param%29%20%3D%3E%20typeof%20param%20%21%3D%3D%20%22object%22%29%29%20%7B%0A%20%20%20%20%20%20params%20%3D%20%5BgetValueFromType%28type%2C%20...params%29%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28params.length%20%3D%3D%3D%201%20%26%26%20cacheMap%20%21%3D%3D%20null%20%26%26%20cacheMap.has%28params%5B0%5D%29%29%20%7B%0A%20%20%20%20%20%20return%20nodeObject%28cacheMap.get%28params%5B0%5D%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28params.length%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20const%20node%20%3D%20getConstNode%28params%5B0%5D%2C%20type%29%3B%0A%20%20%20%20%20%20if%20%28safeGetNodeType%28node%29%20%3D%3D%3D%20type%29%20return%20nodeObject%28node%29%3B%0A%20%20%20%20%20%20return%20nodeObject%28new%20ConvertNode%28node%2C%20type%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20nodes%20%3D%20params.map%28%28param%29%20%3D%3E%20getConstNode%28param%29%29%3B%0A%20%20%20%20return%20nodeObject%28new%20JoinNode%28nodes%2C%20type%29%29%3B%0A%20%20%7D%3B%0A%7D%3B%0Avar%20defined%20%3D%20%28v%29%20%3D%3E%20typeof%20v%20%3D%3D%3D%20%22object%22%20%26%26%20v%20%21%3D%3D%20null%20%3F%20v.value%20%3A%20v%3B%0Avar%20getConstNodeType%20%3D%20%28value%29%20%3D%3E%20value%20%21%3D%3D%20void%200%20%26%26%20value%20%21%3D%3D%20null%20%3F%20value.nodeType%20%7C%7C%20value.convertTo%20%7C%7C%20%28typeof%20value%20%3D%3D%3D%20%22string%22%20%3F%20value%20%3A%20null%29%20%3A%20null%3B%0Afunction%20ShaderNode%28jsFunc%2C%20nodeType%29%20%7B%0A%20%20return%20new%20Proxy%28new%20ShaderNodeInternal%28jsFunc%2C%20nodeType%29%2C%20shaderNodeHandler%29%3B%0A%7D%0Avar%20nodeObject%20%3D%20%28val%2C%20altType%20%3D%20null%29%20%3D%3E%20%28%0A%20%20%2F%2A%20new%20%2A%2F%0A%20%20ShaderNodeObject%28val%2C%20altType%29%0A%29%3B%0Avar%20nodeObjects%20%3D%20%28val%2C%20altType%20%3D%20null%29%20%3D%3E%20new%20ShaderNodeObjects%28val%2C%20altType%29%3B%0Avar%20nodeArray%20%3D%20%28val%2C%20altType%20%3D%20null%29%20%3D%3E%20new%20ShaderNodeArray%28val%2C%20altType%29%3B%0Avar%20nodeProxy%20%3D%20%28...params%29%20%3D%3E%20new%20ShaderNodeProxy%28...params%29%3B%0Avar%20nodeImmutable%20%3D%20%28...params%29%20%3D%3E%20new%20ShaderNodeImmutable%28...params%29%3B%0Avar%20Fn%20%3D%20%28jsFunc%2C%20nodeType%29%20%3D%3E%20%7B%0A%20%20const%20shaderNode%20%3D%20new%20ShaderNode%28jsFunc%2C%20nodeType%29%3B%0A%20%20const%20fn%20%3D%20%28...params%29%20%3D%3E%20%7B%0A%20%20%20%20let%20inputs%3B%0A%20%20%20%20nodeObjects%28params%29%3B%0A%20%20%20%20if%20%28params%5B0%5D%20%26%26%20params%5B0%5D.isNode%29%20%7B%0A%20%20%20%20%20%20inputs%20%3D%20%5B...params%5D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20inputs%20%3D%20params%5B0%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20shaderNode.call%28inputs%29%3B%0A%20%20%7D%3B%0A%20%20fn.shaderNode%20%3D%20shaderNode%3B%0A%20%20fn.setLayout%20%3D%20%28layout%29%20%3D%3E%20%7B%0A%20%20%20%20shaderNode.setLayout%28layout%29%3B%0A%20%20%20%20return%20fn%3B%0A%20%20%7D%3B%0A%20%20fn.once%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20shaderNode.once%20%3D%20true%3B%0A%20%20%20%20return%20fn%3B%0A%20%20%7D%3B%0A%20%20return%20fn%3B%0A%7D%3B%0AaddMethodChaining%28%22toGlobal%22%2C%20%28node%29%20%3D%3E%20%7B%0A%20%20node.global%20%3D%20true%3B%0A%20%20return%20node%3B%0A%7D%29%3B%0Avar%20setCurrentStack%20%3D%20%28stack2%29%20%3D%3E%20%7B%0A%20%20currentStack%20%3D%20stack2%3B%0A%7D%3B%0Avar%20getCurrentStack%20%3D%20%28%29%20%3D%3E%20currentStack%3B%0Avar%20If%20%3D%20%28...params%29%20%3D%3E%20currentStack.If%28...params%29%3B%0Afunction%20append%28node%29%20%7B%0A%20%20if%20%28currentStack%29%20currentStack.add%28node%29%3B%0A%20%20return%20node%3B%0A%7D%0AaddMethodChaining%28%22append%22%2C%20append%29%3B%0Avar%20color%20%3D%20new%20ConvertType%28%22color%22%29%3B%0Avar%20float%20%3D%20new%20ConvertType%28%22float%22%2C%20cacheMaps.float%29%3B%0Avar%20int%20%3D%20new%20ConvertType%28%22int%22%2C%20cacheMaps.ints%29%3B%0Avar%20uint%20%3D%20new%20ConvertType%28%22uint%22%2C%20cacheMaps.uint%29%3B%0Avar%20bool%20%3D%20new%20ConvertType%28%22bool%22%2C%20cacheMaps.bool%29%3B%0Avar%20vec2%20%3D%20new%20ConvertType%28%22vec2%22%29%3B%0Avar%20ivec2%20%3D%20new%20ConvertType%28%22ivec2%22%29%3B%0Avar%20uvec2%20%3D%20new%20ConvertType%28%22uvec2%22%29%3B%0Avar%20bvec2%20%3D%20new%20ConvertType%28%22bvec2%22%29%3B%0Avar%20vec3%20%3D%20new%20ConvertType%28%22vec3%22%29%3B%0Avar%20ivec3%20%3D%20new%20ConvertType%28%22ivec3%22%29%3B%0Avar%20uvec3%20%3D%20new%20ConvertType%28%22uvec3%22%29%3B%0Avar%20bvec3%20%3D%20new%20ConvertType%28%22bvec3%22%29%3B%0Avar%20vec4%20%3D%20new%20ConvertType%28%22vec4%22%29%3B%0Avar%20ivec4%20%3D%20new%20ConvertType%28%22ivec4%22%29%3B%0Avar%20uvec4%20%3D%20new%20ConvertType%28%22uvec4%22%29%3B%0Avar%20bvec4%20%3D%20new%20ConvertType%28%22bvec4%22%29%3B%0Avar%20mat2%20%3D%20new%20ConvertType%28%22mat2%22%29%3B%0Avar%20mat3%20%3D%20new%20ConvertType%28%22mat3%22%29%3B%0Avar%20mat4%20%3D%20new%20ConvertType%28%22mat4%22%29%3B%0AaddMethodChaining%28%22toColor%22%2C%20color%29%3B%0AaddMethodChaining%28%22toFloat%22%2C%20float%29%3B%0AaddMethodChaining%28%22toInt%22%2C%20int%29%3B%0AaddMethodChaining%28%22toUint%22%2C%20uint%29%3B%0AaddMethodChaining%28%22toBool%22%2C%20bool%29%3B%0AaddMethodChaining%28%22toVec2%22%2C%20vec2%29%3B%0AaddMethodChaining%28%22toIVec2%22%2C%20ivec2%29%3B%0AaddMethodChaining%28%22toUVec2%22%2C%20uvec2%29%3B%0AaddMethodChaining%28%22toBVec2%22%2C%20bvec2%29%3B%0AaddMethodChaining%28%22toVec3%22%2C%20vec3%29%3B%0AaddMethodChaining%28%22toIVec3%22%2C%20ivec3%29%3B%0AaddMethodChaining%28%22toUVec3%22%2C%20uvec3%29%3B%0AaddMethodChaining%28%22toBVec3%22%2C%20bvec3%29%3B%0AaddMethodChaining%28%22toVec4%22%2C%20vec4%29%3B%0AaddMethodChaining%28%22toIVec4%22%2C%20ivec4%29%3B%0AaddMethodChaining%28%22toUVec4%22%2C%20uvec4%29%3B%0AaddMethodChaining%28%22toBVec4%22%2C%20bvec4%29%3B%0AaddMethodChaining%28%22toMat2%22%2C%20mat2%29%3B%0AaddMethodChaining%28%22toMat3%22%2C%20mat3%29%3B%0AaddMethodChaining%28%22toMat4%22%2C%20mat4%29%3B%0Avar%20element%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28ArrayElementNode%29%3B%0Avar%20convert%20%3D%20%28node%2C%20types%29%20%3D%3E%20nodeObject%28new%20ConvertNode%28nodeObject%28node%29%2C%20types%29%29%3B%0AaddMethodChaining%28%22element%22%2C%20element%29%3B%0AaddMethodChaining%28%22convert%22%2C%20convert%29%3B%0Avar%20UniformGroupNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22UniformGroupNode%22%3B%0A%20%20%7D%0A%20%20constructor%28name%2C%20shared%20%3D%20false%2C%20order%20%3D%201%29%20%7B%0A%20%20%20%20super%28%22string%22%29%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%20%20this.shared%20%3D%20shared%3B%0A%20%20%20%20this.order%20%3D%20order%3B%0A%20%20%20%20this.isUniformGroup%20%3D%20true%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20this.version%2B%2B%3B%0A%20%20%7D%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.name%20%3D%20this.name%3B%0A%20%20%20%20data.version%20%3D%20this.version%3B%0A%20%20%20%20data.shared%20%3D%20this.shared%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.name%20%3D%20data.name%3B%0A%20%20%20%20this.version%20%3D%20data.version%3B%0A%20%20%20%20this.shared%20%3D%20data.shared%3B%0A%20%20%7D%0A%7D%3B%0Avar%20uniformGroup%20%3D%20%28name%29%20%3D%3E%20new%20UniformGroupNode%28name%29%3B%0Avar%20sharedUniformGroup%20%3D%20%28name%2C%20order%20%3D%200%29%20%3D%3E%20new%20UniformGroupNode%28name%2C%20true%2C%20order%29%3B%0Avar%20frameGroup%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20sharedUniformGroup%28%22frame%22%29%3B%0Avar%20renderGroup%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20sharedUniformGroup%28%22render%22%29%3B%0Avar%20objectGroup%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20uniformGroup%28%22object%22%29%3B%0Avar%20UniformNode%20%3D%20class%20extends%20InputNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22UniformNode%22%3B%0A%20%20%7D%0A%20%20constructor%28value%2C%20nodeType%20%3D%20null%29%20%7B%0A%20%20%20%20super%28value%2C%20nodeType%29%3B%0A%20%20%20%20this.isUniformNode%20%3D%20true%3B%0A%20%20%20%20this.name%20%3D%20%22%22%3B%0A%20%20%20%20this.groupNode%20%3D%20objectGroup%3B%0A%20%20%7D%0A%20%20label%28name%29%20%7B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setGroup%28group%29%20%7B%0A%20%20%20%20this.groupNode%20%3D%20group%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getGroup%28%29%20%7B%0A%20%20%20%20return%20this.groupNode%3B%0A%20%20%7D%0A%20%20getUniformHash%28builder%29%20%7B%0A%20%20%20%20return%20this.getHash%28builder%29%3B%0A%20%20%7D%0A%20%20onUpdate%28callback%2C%20updateType%29%20%7B%0A%20%20%20%20const%20self2%20%3D%20this.getSelf%28%29%3B%0A%20%20%20%20callback%20%3D%20callback.bind%28self2%29%3B%0A%20%20%20%20return%20super.onUpdate%28%28frame2%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20value%20%3D%20callback%28frame2%2C%20self2%29%3B%0A%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this.value%20%3D%20value%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%20updateType%29%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20hash%20%3D%20this.getUniformHash%28builder%29%3B%0A%20%20%20%20let%20sharedNode%20%3D%20builder.getNodeFromHash%28hash%29%3B%0A%20%20%20%20if%20%28sharedNode%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20builder.setHashNode%28this%2C%20hash%29%3B%0A%20%20%20%20%20%20sharedNode%20%3D%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20sharedNodeType%20%3D%20sharedNode.getInputType%28builder%29%3B%0A%20%20%20%20const%20nodeUniform%20%3D%20builder.getUniformFromNode%28sharedNode%2C%20sharedNodeType%2C%20builder.shaderStage%2C%20this.name%20%7C%7C%20builder.context.label%29%3B%0A%20%20%20%20const%20propertyName%20%3D%20builder.getPropertyName%28nodeUniform%29%3B%0A%20%20%20%20if%20%28builder.context.label%20%21%3D%3D%20void%200%29%20delete%20builder.context.label%3B%0A%20%20%20%20return%20builder.format%28propertyName%2C%20type%2C%20output2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20uniform%20%3D%20%28arg1%2C%20arg2%29%20%3D%3E%20%7B%0A%20%20const%20nodeType%20%3D%20getConstNodeType%28arg2%20%7C%7C%20arg1%29%3B%0A%20%20const%20value%20%3D%20arg1%20%26%26%20arg1.isNode%20%3D%3D%3D%20true%20%3F%20arg1.node%20%26%26%20arg1.node.value%20%7C%7C%20arg1.value%20%3A%20arg1%3B%0A%20%20return%20nodeObject%28new%20UniformNode%28value%2C%20nodeType%29%29%3B%0A%7D%3B%0Avar%20PropertyNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22PropertyNode%22%3B%0A%20%20%7D%0A%20%20constructor%28nodeType%2C%20name%20%3D%20null%2C%20varying2%20%3D%20false%29%20%7B%0A%20%20%20%20super%28nodeType%29%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.varying%20%3D%20varying2%3B%0A%20%20%20%20this.isPropertyNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getHash%28builder%29%20%7B%0A%20%20%20%20return%20this.name%20%7C%7C%20super.getHash%28builder%29%3B%0A%20%20%7D%0A%20%20isGlobal%28%29%20%7B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20let%20nodeVar%3B%0A%20%20%20%20if%20%28this.varying%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20nodeVar%20%3D%20builder.getVaryingFromNode%28this%2C%20this.name%29%3B%0A%20%20%20%20%20%20nodeVar.needsInterpolation%20%3D%20true%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20nodeVar%20%3D%20builder.getVarFromNode%28this%2C%20this.name%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20builder.getPropertyName%28nodeVar%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20property%20%3D%20%28type%2C%20name%29%20%3D%3E%20nodeObject%28new%20PropertyNode%28type%2C%20name%29%29%3B%0Avar%20varyingProperty%20%3D%20%28type%2C%20name%29%20%3D%3E%20nodeObject%28new%20PropertyNode%28type%2C%20name%2C%20true%29%29%3B%0Avar%20diffuseColor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22vec4%22%2C%20%22DiffuseColor%22%29%3B%0Avar%20emissive%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22vec3%22%2C%20%22EmissiveColor%22%29%3B%0Avar%20roughness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22Roughness%22%29%3B%0Avar%20metalness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22Metalness%22%29%3B%0Avar%20clearcoat%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22Clearcoat%22%29%3B%0Avar%20clearcoatRoughness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22ClearcoatRoughness%22%29%3B%0Avar%20sheen%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22vec3%22%2C%20%22Sheen%22%29%3B%0Avar%20sheenRoughness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22SheenRoughness%22%29%3B%0Avar%20iridescence%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22Iridescence%22%29%3B%0Avar%20iridescenceIOR%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22IridescenceIOR%22%29%3B%0Avar%20iridescenceThickness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22IridescenceThickness%22%29%3B%0Avar%20alphaT%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22AlphaT%22%29%3B%0Avar%20anisotropy%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22Anisotropy%22%29%3B%0Avar%20anisotropyT%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22vec3%22%2C%20%22AnisotropyT%22%29%3B%0Avar%20anisotropyB%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22vec3%22%2C%20%22AnisotropyB%22%29%3B%0Avar%20specularColor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22color%22%2C%20%22SpecularColor%22%29%3B%0Avar%20specularF90%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22SpecularF90%22%29%3B%0Avar%20shininess%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22Shininess%22%29%3B%0Avar%20output%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22vec4%22%2C%20%22Output%22%29%3B%0Avar%20dashSize%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22dashSize%22%29%3B%0Avar%20gapSize%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22gapSize%22%29%3B%0Avar%20ior%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22IOR%22%29%3B%0Avar%20transmission%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22Transmission%22%29%3B%0Avar%20thickness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22Thickness%22%29%3B%0Avar%20attenuationDistance%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22AttenuationDistance%22%29%3B%0Avar%20attenuationColor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22color%22%2C%20%22AttenuationColor%22%29%3B%0Avar%20dispersion%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28PropertyNode%2C%20%22float%22%2C%20%22Dispersion%22%29%3B%0Avar%20AssignNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22AssignNode%22%3B%0A%20%20%7D%0A%20%20constructor%28targetNode%2C%20sourceNode%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.targetNode%20%3D%20targetNode%3B%0A%20%20%20%20this.sourceNode%20%3D%20sourceNode%3B%0A%20%20%7D%0A%20%20hasDependencies%28%29%20%7B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%2C%20output2%29%20%7B%0A%20%20%20%20return%20output2%20%21%3D%3D%20%22void%22%20%3F%20this.targetNode.getNodeType%28builder%29%20%3A%20%22void%22%3B%0A%20%20%7D%0A%20%20needsSplitAssign%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20targetNode%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28builder.isAvailable%28%22swizzleAssign%22%29%20%3D%3D%3D%20false%20%26%26%20targetNode.isSplitNode%20%26%26%20targetNode.components.length%20%3E%201%29%20%7B%0A%20%20%20%20%20%20const%20targetLength%20%3D%20builder.getTypeLength%28targetNode.node.getNodeType%28builder%29%29%3B%0A%20%20%20%20%20%20const%20assignDiferentVector%20%3D%20vectorComponents.join%28%22%22%29.slice%280%2C%20targetLength%29%20%21%3D%3D%20targetNode.components%3B%0A%20%20%20%20%20%20return%20assignDiferentVector%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20%7B%20targetNode%2C%20sourceNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20needsSplitAssign%20%3D%20this.needsSplitAssign%28builder%29%3B%0A%20%20%20%20const%20targetType%20%3D%20targetNode.getNodeType%28builder%29%3B%0A%20%20%20%20const%20target%20%3D%20targetNode.context%28%7B%20assign%3A%20true%20%7D%29.build%28builder%29%3B%0A%20%20%20%20const%20source%20%3D%20sourceNode.build%28builder%2C%20targetType%29%3B%0A%20%20%20%20const%20sourceType%20%3D%20sourceNode.getNodeType%28builder%29%3B%0A%20%20%20%20const%20nodeData%20%3D%20builder.getDataFromNode%28this%29%3B%0A%20%20%20%20let%20snippet%3B%0A%20%20%20%20if%20%28nodeData.initialized%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20if%20%28output2%20%21%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20target%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28needsSplitAssign%29%20%7B%0A%20%20%20%20%20%20const%20sourceVar%20%3D%20builder.getVarFromNode%28this%2C%20null%2C%20targetType%29%3B%0A%20%20%20%20%20%20const%20sourceProperty%20%3D%20builder.getPropertyName%28sourceVar%29%3B%0A%20%20%20%20%20%20builder.addLineFlowCode%28%60%24%7BsourceProperty%7D%20%3D%20%24%7Bsource%7D%60%2C%20this%29%3B%0A%20%20%20%20%20%20const%20targetRoot%20%3D%20targetNode.node.context%28%7B%20assign%3A%20true%20%7D%29.build%28builder%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20targetNode.components.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20component%20%3D%20targetNode.components%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20builder.addLineFlowCode%28%60%24%7BtargetRoot%7D.%24%7Bcomponent%7D%20%3D%20%24%7BsourceProperty%7D%5B%20%24%7Bi%7D%20%5D%60%2C%20this%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28output2%20%21%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20target%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20%60%24%7Btarget%7D%20%3D%20%24%7Bsource%7D%60%3B%0A%20%20%20%20%20%20if%20%28output2%20%3D%3D%3D%20%22void%22%20%7C%7C%20sourceType%20%3D%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20%20%20builder.addLineFlowCode%28snippet%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20if%20%28output2%20%21%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20snippet%20%3D%20target%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20nodeData.initialized%20%3D%20true%3B%0A%20%20%20%20return%20builder.format%28snippet%2C%20targetType%2C%20output2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20assign%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28AssignNode%29%3B%0AaddMethodChaining%28%22assign%22%2C%20assign%29%3B%0Avar%20FunctionCallNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22FunctionCallNode%22%3B%0A%20%20%7D%0A%20%20constructor%28functionNode%20%3D%20null%2C%20parameters%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.functionNode%20%3D%20functionNode%3B%0A%20%20%20%20this.parameters%20%3D%20parameters%3B%0A%20%20%7D%0A%20%20setParameters%28parameters%29%20%7B%0A%20%20%20%20this.parameters%20%3D%20parameters%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getParameters%28%29%20%7B%0A%20%20%20%20return%20this.parameters%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.functionNode.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20params%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20functionNode%20%3D%20this.functionNode%3B%0A%20%20%20%20const%20inputs%20%3D%20functionNode.getInputs%28builder%29%3B%0A%20%20%20%20const%20parameters%20%3D%20this.parameters%3B%0A%20%20%20%20const%20generateInput%20%3D%20%28node%2C%20inputNode%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20type%20%3D%20inputNode.type%3B%0A%20%20%20%20%20%20const%20pointer%20%3D%20type%20%3D%3D%3D%20%22pointer%22%3B%0A%20%20%20%20%20%20let%20output2%3B%0A%20%20%20%20%20%20if%20%28pointer%29%20output2%20%3D%20%22%26%22%20%2B%20node.build%28builder%29%3B%0A%20%20%20%20%20%20else%20output2%20%3D%20node.build%28builder%2C%20type%29%3B%0A%20%20%20%20%20%20return%20output2%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28Array.isArray%28parameters%29%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20parameters.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20params.push%28generateInput%28parameters%5Bi%5D%2C%20inputs%5Bi%5D%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20%28const%20inputNode%20of%20inputs%29%20%7B%0A%20%20%20%20%20%20%20%20const%20node%20%3D%20parameters%5BinputNode.name%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28node%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20params.push%28generateInput%28node%2C%20inputNode%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%60FunctionCallNode%3A%20Input%20%27%24%7BinputNode.name%7D%27%20not%20found%20in%20FunctionNode.%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20functionName%20%3D%20functionNode.build%28builder%2C%20%22property%22%29%3B%0A%20%20%20%20return%20%60%24%7BfunctionName%7D%28%20%24%7Bparams.join%28%22%2C%20%22%29%7D%20%29%60%3B%0A%20%20%7D%0A%7D%3B%0Avar%20call%20%3D%20%28func%2C%20...params%29%20%3D%3E%20%7B%0A%20%20params%20%3D%20params.length%20%3E%201%20%7C%7C%20params%5B0%5D%20%26%26%20params%5B0%5D.isNode%20%3D%3D%3D%20true%20%3F%20nodeArray%28params%29%20%3A%20nodeObjects%28params%5B0%5D%29%3B%0A%20%20return%20nodeObject%28new%20FunctionCallNode%28nodeObject%28func%29%2C%20params%29%29%3B%0A%7D%3B%0AaddMethodChaining%28%22call%22%2C%20call%29%3B%0Avar%20OperatorNode%20%3D%20class%20_OperatorNode%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22OperatorNode%22%3B%0A%20%20%7D%0A%20%20constructor%28op%2C%20aNode%2C%20bNode%2C%20...params%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20if%20%28params.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20let%20finalOp%20%3D%20new%20_OperatorNode%28op%2C%20aNode%2C%20bNode%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20params.length%20-%201%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20finalOp%20%3D%20new%20_OperatorNode%28op%2C%20finalOp%2C%20params%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20aNode%20%3D%20finalOp%3B%0A%20%20%20%20%20%20bNode%20%3D%20params%5Bparams.length%20-%201%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.op%20%3D%20op%3B%0A%20%20%20%20this.aNode%20%3D%20aNode%3B%0A%20%20%20%20this.bNode%20%3D%20bNode%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20op%20%3D%20this.op%3B%0A%20%20%20%20const%20aNode%20%3D%20this.aNode%3B%0A%20%20%20%20const%20bNode%20%3D%20this.bNode%3B%0A%20%20%20%20const%20typeA%20%3D%20aNode.getNodeType%28builder%29%3B%0A%20%20%20%20const%20typeB%20%3D%20typeof%20bNode%20%21%3D%3D%20%22undefined%22%20%3F%20bNode.getNodeType%28builder%29%20%3A%20null%3B%0A%20%20%20%20if%20%28typeA%20%3D%3D%3D%20%22void%22%20%7C%7C%20typeB%20%3D%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20return%20%22void%22%3B%0A%20%20%20%20%7D%20else%20if%20%28op%20%3D%3D%3D%20%22%25%22%29%20%7B%0A%20%20%20%20%20%20return%20typeA%3B%0A%20%20%20%20%7D%20else%20if%20%28op%20%3D%3D%3D%20%22~%22%20%7C%7C%20op%20%3D%3D%3D%20%22%26%22%20%7C%7C%20op%20%3D%3D%3D%20%22%7C%22%20%7C%7C%20op%20%3D%3D%3D%20%22%5E%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3E%3E%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3C%3C%22%29%20%7B%0A%20%20%20%20%20%20return%20builder.getIntegerType%28typeA%29%3B%0A%20%20%20%20%7D%20else%20if%20%28op%20%3D%3D%3D%20%22%21%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3D%3D%22%20%7C%7C%20op%20%3D%3D%3D%20%22%26%26%22%20%7C%7C%20op%20%3D%3D%3D%20%22%7C%7C%22%20%7C%7C%20op%20%3D%3D%3D%20%22%5E%5E%22%29%20%7B%0A%20%20%20%20%20%20return%20%22bool%22%3B%0A%20%20%20%20%7D%20else%20if%20%28op%20%3D%3D%3D%20%22%3C%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3E%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3C%3D%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3E%3D%22%29%20%7B%0A%20%20%20%20%20%20const%20typeLength%20%3D%20output2%20%3F%20builder.getTypeLength%28output2%29%20%3A%20Math.max%28builder.getTypeLength%28typeA%29%2C%20builder.getTypeLength%28typeB%29%29%3B%0A%20%20%20%20%20%20return%20typeLength%20%3E%201%20%3F%20%60bvec%24%7BtypeLength%7D%60%20%3A%20%22bool%22%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28typeA%20%3D%3D%3D%20%22float%22%20%26%26%20builder.isMatrix%28typeB%29%29%20%7B%0A%20%20%20%20%20%20%20%20return%20typeB%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28builder.isMatrix%28typeA%29%20%26%26%20builder.isVector%28typeB%29%29%20%7B%0A%20%20%20%20%20%20%20%20return%20builder.getVectorFromMatrix%28typeA%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28builder.isVector%28typeA%29%20%26%26%20builder.isMatrix%28typeB%29%29%20%7B%0A%20%20%20%20%20%20%20%20return%20builder.getVectorFromMatrix%28typeB%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28builder.getTypeLength%28typeB%29%20%3E%20builder.getTypeLength%28typeA%29%29%20%7B%0A%20%20%20%20%20%20%20%20return%20typeB%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20typeA%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20op%20%3D%20this.op%3B%0A%20%20%20%20const%20aNode%20%3D%20this.aNode%3B%0A%20%20%20%20const%20bNode%20%3D%20this.bNode%3B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%2C%20output2%29%3B%0A%20%20%20%20let%20typeA%20%3D%20null%3B%0A%20%20%20%20let%20typeB%20%3D%20null%3B%0A%20%20%20%20if%20%28type%20%21%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20typeA%20%3D%20aNode.getNodeType%28builder%29%3B%0A%20%20%20%20%20%20typeB%20%3D%20typeof%20bNode%20%21%3D%3D%20%22undefined%22%20%3F%20bNode.getNodeType%28builder%29%20%3A%20null%3B%0A%20%20%20%20%20%20if%20%28op%20%3D%3D%3D%20%22%3C%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3E%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3C%3D%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3E%3D%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3D%3D%22%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28builder.isVector%28typeA%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20typeB%20%3D%20typeA%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeA%20%21%3D%3D%20typeB%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20typeA%20%3D%20typeB%20%3D%20%22float%22%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28op%20%3D%3D%3D%20%22%3E%3E%22%20%7C%7C%20op%20%3D%3D%3D%20%22%3C%3C%22%29%20%7B%0A%20%20%20%20%20%20%20%20typeA%20%3D%20type%3B%0A%20%20%20%20%20%20%20%20typeB%20%3D%20builder.changeComponentType%28typeB%2C%20%22uint%22%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28builder.isMatrix%28typeA%29%20%26%26%20builder.isVector%28typeB%29%29%20%7B%0A%20%20%20%20%20%20%20%20typeB%20%3D%20builder.getVectorFromMatrix%28typeA%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28builder.isVector%28typeA%29%20%26%26%20builder.isMatrix%28typeB%29%29%20%7B%0A%20%20%20%20%20%20%20%20typeA%20%3D%20builder.getVectorFromMatrix%28typeB%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20typeA%20%3D%20typeB%20%3D%20type%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20typeA%20%3D%20typeB%20%3D%20type%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20a2%20%3D%20aNode.build%28builder%2C%20typeA%29%3B%0A%20%20%20%20const%20b%20%3D%20typeof%20bNode%20%21%3D%3D%20%22undefined%22%20%3F%20bNode.build%28builder%2C%20typeB%29%20%3A%20null%3B%0A%20%20%20%20const%20outputLength%20%3D%20builder.getTypeLength%28output2%29%3B%0A%20%20%20%20const%20fnOpSnippet%20%3D%20builder.getFunctionOperator%28op%29%3B%0A%20%20%20%20if%20%28output2%20%21%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20if%20%28op%20%3D%3D%3D%20%22%3C%22%20%26%26%20outputLength%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28builder.useComparisonMethod%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20builder.format%28%60%24%7Bbuilder.getMethod%28%22lessThan%22%2C%20output2%29%7D%28%20%24%7Ba2%7D%2C%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20builder.format%28%60%28%20%24%7Ba2%7D%20%3C%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28op%20%3D%3D%3D%20%22%3C%3D%22%20%26%26%20outputLength%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28builder.useComparisonMethod%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20builder.format%28%60%24%7Bbuilder.getMethod%28%22lessThanEqual%22%2C%20output2%29%7D%28%20%24%7Ba2%7D%2C%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20builder.format%28%60%28%20%24%7Ba2%7D%20%3C%3D%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28op%20%3D%3D%3D%20%22%3E%22%20%26%26%20outputLength%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28builder.useComparisonMethod%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20builder.format%28%60%24%7Bbuilder.getMethod%28%22greaterThan%22%2C%20output2%29%7D%28%20%24%7Ba2%7D%2C%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20builder.format%28%60%28%20%24%7Ba2%7D%20%3E%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28op%20%3D%3D%3D%20%22%3E%3D%22%20%26%26%20outputLength%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28builder.useComparisonMethod%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20builder.format%28%60%24%7Bbuilder.getMethod%28%22greaterThanEqual%22%2C%20output2%29%7D%28%20%24%7Ba2%7D%2C%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20builder.format%28%60%28%20%24%7Ba2%7D%20%3E%3D%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28op%20%3D%3D%3D%20%22%21%22%20%7C%7C%20op%20%3D%3D%3D%20%22~%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%20builder.format%28%60%28%24%7Bop%7D%24%7Ba2%7D%29%60%2C%20typeA%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28fnOpSnippet%29%20%7B%0A%20%20%20%20%20%20%20%20return%20builder.format%28%60%24%7BfnOpSnippet%7D%28%20%24%7Ba2%7D%2C%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20builder.format%28%60%28%20%24%7Ba2%7D%20%24%7Bop%7D%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28typeA%20%21%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20if%20%28fnOpSnippet%29%20%7B%0A%20%20%20%20%20%20%20%20return%20builder.format%28%60%24%7BfnOpSnippet%7D%28%20%24%7Ba2%7D%2C%20%24%7Bb%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20builder.format%28%60%24%7Ba2%7D%20%24%7Bop%7D%20%24%7Bb%7D%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.op%20%3D%20this.op%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.op%20%3D%20data.op%3B%0A%20%20%7D%0A%7D%3B%0Avar%20add4%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%2B%22%29%3B%0Avar%20sub%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22-%22%29%3B%0Avar%20mul%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%2A%22%29%3B%0Avar%20div%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%2F%22%29%3B%0Avar%20modInt%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%25%22%29%3B%0Avar%20equal%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%3D%3D%22%29%3B%0Avar%20notEqual%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%21%3D%22%29%3B%0Avar%20lessThan%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%3C%22%29%3B%0Avar%20greaterThan%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%3E%22%29%3B%0Avar%20lessThanEqual%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%3C%3D%22%29%3B%0Avar%20greaterThanEqual%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%3E%3D%22%29%3B%0Avar%20and%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%26%26%22%29%3B%0Avar%20or%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%7C%7C%22%29%3B%0Avar%20not%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%21%22%29%3B%0Avar%20xor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%5E%5E%22%29%3B%0Avar%20bitAnd%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%26%22%29%3B%0Avar%20bitNot%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22~%22%29%3B%0Avar%20bitOr%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%7C%22%29%3B%0Avar%20bitXor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%5E%22%29%3B%0Avar%20shiftLeft%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%3C%3C%22%29%3B%0Avar%20shiftRight%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28OperatorNode%2C%20%22%3E%3E%22%29%3B%0AaddMethodChaining%28%22add%22%2C%20add4%29%3B%0AaddMethodChaining%28%22sub%22%2C%20sub%29%3B%0AaddMethodChaining%28%22mul%22%2C%20mul%29%3B%0AaddMethodChaining%28%22div%22%2C%20div%29%3B%0AaddMethodChaining%28%22modInt%22%2C%20modInt%29%3B%0AaddMethodChaining%28%22equal%22%2C%20equal%29%3B%0AaddMethodChaining%28%22notEqual%22%2C%20notEqual%29%3B%0AaddMethodChaining%28%22lessThan%22%2C%20lessThan%29%3B%0AaddMethodChaining%28%22greaterThan%22%2C%20greaterThan%29%3B%0AaddMethodChaining%28%22lessThanEqual%22%2C%20lessThanEqual%29%3B%0AaddMethodChaining%28%22greaterThanEqual%22%2C%20greaterThanEqual%29%3B%0AaddMethodChaining%28%22and%22%2C%20and%29%3B%0AaddMethodChaining%28%22or%22%2C%20or%29%3B%0AaddMethodChaining%28%22not%22%2C%20not%29%3B%0AaddMethodChaining%28%22xor%22%2C%20xor%29%3B%0AaddMethodChaining%28%22bitAnd%22%2C%20bitAnd%29%3B%0AaddMethodChaining%28%22bitNot%22%2C%20bitNot%29%3B%0AaddMethodChaining%28%22bitOr%22%2C%20bitOr%29%3B%0AaddMethodChaining%28%22bitXor%22%2C%20bitXor%29%3B%0AaddMethodChaining%28%22shiftLeft%22%2C%20shiftLeft%29%3B%0AaddMethodChaining%28%22shiftRight%22%2C%20shiftRight%29%3B%0Avar%20remainder%20%3D%20%28...params%29%20%3D%3E%20%7B%0A%20%20console.warn%28%22TSL.OperatorNode%3A%20.remainder%28%29%20has%20been%20renamed%20to%20.modInt%28%29.%22%29%3B%0A%20%20return%20modInt%28...params%29%3B%0A%7D%3B%0AaddMethodChaining%28%22remainder%22%2C%20remainder%29%3B%0Avar%20MathNode%20%3D%20class%20_MathNode%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MathNode%22%3B%0A%20%20%7D%0A%20%20constructor%28method%2C%20aNode%2C%20bNode%20%3D%20null%2C%20cNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.method%20%3D%20method%3B%0A%20%20%20%20this.aNode%20%3D%20aNode%3B%0A%20%20%20%20this.bNode%20%3D%20bNode%3B%0A%20%20%20%20this.cNode%20%3D%20cNode%3B%0A%20%20%7D%0A%20%20getInputType%28builder%29%20%7B%0A%20%20%20%20const%20aType%20%3D%20this.aNode.getNodeType%28builder%29%3B%0A%20%20%20%20const%20bType%20%3D%20this.bNode%20%3F%20this.bNode.getNodeType%28builder%29%20%3A%20null%3B%0A%20%20%20%20const%20cType%20%3D%20this.cNode%20%3F%20this.cNode.getNodeType%28builder%29%20%3A%20null%3B%0A%20%20%20%20const%20aLen%20%3D%20builder.isMatrix%28aType%29%20%3F%200%20%3A%20builder.getTypeLength%28aType%29%3B%0A%20%20%20%20const%20bLen%20%3D%20builder.isMatrix%28bType%29%20%3F%200%20%3A%20builder.getTypeLength%28bType%29%3B%0A%20%20%20%20const%20cLen%20%3D%20builder.isMatrix%28cType%29%20%3F%200%20%3A%20builder.getTypeLength%28cType%29%3B%0A%20%20%20%20if%20%28aLen%20%3E%20bLen%20%26%26%20aLen%20%3E%20cLen%29%20%7B%0A%20%20%20%20%20%20return%20aType%3B%0A%20%20%20%20%7D%20else%20if%20%28bLen%20%3E%20cLen%29%20%7B%0A%20%20%20%20%20%20return%20bType%3B%0A%20%20%20%20%7D%20else%20if%20%28cLen%20%3E%20aLen%29%20%7B%0A%20%20%20%20%20%20return%20cType%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20aType%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20const%20method%20%3D%20this.method%3B%0A%20%20%20%20if%20%28method%20%3D%3D%3D%20_MathNode.LENGTH%20%7C%7C%20method%20%3D%3D%3D%20_MathNode.DISTANCE%20%7C%7C%20method%20%3D%3D%3D%20_MathNode.DOT%29%20%7B%0A%20%20%20%20%20%20return%20%22float%22%3B%0A%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.CROSS%29%20%7B%0A%20%20%20%20%20%20return%20%22vec3%22%3B%0A%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.ALL%29%20%7B%0A%20%20%20%20%20%20return%20%22bool%22%3B%0A%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.EQUALS%29%20%7B%0A%20%20%20%20%20%20return%20builder.changeComponentType%28this.aNode.getNodeType%28builder%29%2C%20%22bool%22%29%3B%0A%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.MOD%29%20%7B%0A%20%20%20%20%20%20return%20this.aNode.getNodeType%28builder%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20this.getInputType%28builder%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20method%20%3D%20this.method%3B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20inputType%20%3D%20this.getInputType%28builder%29%3B%0A%20%20%20%20const%20a2%20%3D%20this.aNode%3B%0A%20%20%20%20const%20b%20%3D%20this.bNode%3B%0A%20%20%20%20const%20c2%20%3D%20this.cNode%3B%0A%20%20%20%20const%20isWebGL%20%3D%20builder.renderer.isWebGLRenderer%20%3D%3D%3D%20true%3B%0A%20%20%20%20if%20%28method%20%3D%3D%3D%20_MathNode.TRANSFORM_DIRECTION%29%20%7B%0A%20%20%20%20%20%20let%20tA%20%3D%20a2%3B%0A%20%20%20%20%20%20let%20tB%20%3D%20b%3B%0A%20%20%20%20%20%20if%20%28builder.isMatrix%28tA.getNodeType%28builder%29%29%29%20%7B%0A%20%20%20%20%20%20%20%20tB%20%3D%20vec4%28vec3%28tB%29%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20tA%20%3D%20vec4%28vec3%28tA%29%2C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20mulNode%20%3D%20mul%28tA%2C%20tB%29.xyz%3B%0A%20%20%20%20%20%20return%20normalize2%28mulNode%29.build%28builder%2C%20output2%29%3B%0A%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.NEGATE%29%20%7B%0A%20%20%20%20%20%20return%20builder.format%28%22%28%20-%20%22%20%2B%20a2.build%28builder%2C%20inputType%29%20%2B%20%22%20%29%22%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.ONE_MINUS%29%20%7B%0A%20%20%20%20%20%20return%20sub%281%2C%20a2%29.build%28builder%2C%20output2%29%3B%0A%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.RECIPROCAL%29%20%7B%0A%20%20%20%20%20%20return%20div%281%2C%20a2%29.build%28builder%2C%20output2%29%3B%0A%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.DIFFERENCE%29%20%7B%0A%20%20%20%20%20%20return%20abs%28sub%28a2%2C%20b%29%29.build%28builder%2C%20output2%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20params%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20if%20%28method%20%3D%3D%3D%20_MathNode.CROSS%20%7C%7C%20method%20%3D%3D%3D%20_MathNode.MOD%29%20%7B%0A%20%20%20%20%20%20%20%20params.push%28%0A%20%20%20%20%20%20%20%20%20%20a2.build%28builder%2C%20type%29%2C%0A%20%20%20%20%20%20%20%20%20%20b.build%28builder%2C%20type%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28isWebGL%20%26%26%20method%20%3D%3D%3D%20_MathNode.STEP%29%20%7B%0A%20%20%20%20%20%20%20%20params.push%28%0A%20%20%20%20%20%20%20%20%20%20a2.build%28builder%2C%20builder.getTypeLength%28a2.getNodeType%28builder%29%29%20%3D%3D%3D%201%20%3F%20%22float%22%20%3A%20inputType%29%2C%0A%20%20%20%20%20%20%20%20%20%20b.build%28builder%2C%20inputType%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28isWebGL%20%26%26%20%28method%20%3D%3D%3D%20_MathNode.MIN%20%7C%7C%20method%20%3D%3D%3D%20_MathNode.MAX%29%20%7C%7C%20method%20%3D%3D%3D%20_MathNode.MOD%29%20%7B%0A%20%20%20%20%20%20%20%20params.push%28%0A%20%20%20%20%20%20%20%20%20%20a2.build%28builder%2C%20inputType%29%2C%0A%20%20%20%20%20%20%20%20%20%20b.build%28builder%2C%20builder.getTypeLength%28b.getNodeType%28builder%29%29%20%3D%3D%3D%201%20%3F%20%22float%22%20%3A%20inputType%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.REFRACT%29%20%7B%0A%20%20%20%20%20%20%20%20params.push%28%0A%20%20%20%20%20%20%20%20%20%20a2.build%28builder%2C%20inputType%29%2C%0A%20%20%20%20%20%20%20%20%20%20b.build%28builder%2C%20inputType%29%2C%0A%20%20%20%20%20%20%20%20%20%20c2.build%28builder%2C%20%22float%22%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28method%20%3D%3D%3D%20_MathNode.MIX%29%20%7B%0A%20%20%20%20%20%20%20%20params.push%28%0A%20%20%20%20%20%20%20%20%20%20a2.build%28builder%2C%20inputType%29%2C%0A%20%20%20%20%20%20%20%20%20%20b.build%28builder%2C%20inputType%29%2C%0A%20%20%20%20%20%20%20%20%20%20c2.build%28builder%2C%20builder.getTypeLength%28c2.getNodeType%28builder%29%29%20%3D%3D%3D%201%20%3F%20%22float%22%20%3A%20inputType%29%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20params.push%28a2.build%28builder%2C%20inputType%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28b%20%21%3D%3D%20null%29%20params.push%28b.build%28builder%2C%20inputType%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28c2%20%21%3D%3D%20null%29%20params.push%28c2.build%28builder%2C%20inputType%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20builder.format%28%60%24%7Bbuilder.getMethod%28method%2C%20type%29%7D%28%20%24%7Bparams.join%28%22%2C%20%22%29%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.method%20%3D%20this.method%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.method%20%3D%20data.method%3B%0A%20%20%7D%0A%7D%3B%0AMathNode.ALL%20%3D%20%22all%22%3B%0AMathNode.ANY%20%3D%20%22any%22%3B%0AMathNode.EQUALS%20%3D%20%22equals%22%3B%0AMathNode.RADIANS%20%3D%20%22radians%22%3B%0AMathNode.DEGREES%20%3D%20%22degrees%22%3B%0AMathNode.EXP%20%3D%20%22exp%22%3B%0AMathNode.EXP2%20%3D%20%22exp2%22%3B%0AMathNode.LOG%20%3D%20%22log%22%3B%0AMathNode.LOG2%20%3D%20%22log2%22%3B%0AMathNode.SQRT%20%3D%20%22sqrt%22%3B%0AMathNode.INVERSE_SQRT%20%3D%20%22inversesqrt%22%3B%0AMathNode.FLOOR%20%3D%20%22floor%22%3B%0AMathNode.CEIL%20%3D%20%22ceil%22%3B%0AMathNode.NORMALIZE%20%3D%20%22normalize%22%3B%0AMathNode.FRACT%20%3D%20%22fract%22%3B%0AMathNode.SIN%20%3D%20%22sin%22%3B%0AMathNode.COS%20%3D%20%22cos%22%3B%0AMathNode.TAN%20%3D%20%22tan%22%3B%0AMathNode.ASIN%20%3D%20%22asin%22%3B%0AMathNode.ACOS%20%3D%20%22acos%22%3B%0AMathNode.ATAN%20%3D%20%22atan%22%3B%0AMathNode.ABS%20%3D%20%22abs%22%3B%0AMathNode.SIGN%20%3D%20%22sign%22%3B%0AMathNode.LENGTH%20%3D%20%22length%22%3B%0AMathNode.NEGATE%20%3D%20%22negate%22%3B%0AMathNode.ONE_MINUS%20%3D%20%22oneMinus%22%3B%0AMathNode.DFDX%20%3D%20%22dFdx%22%3B%0AMathNode.DFDY%20%3D%20%22dFdy%22%3B%0AMathNode.ROUND%20%3D%20%22round%22%3B%0AMathNode.RECIPROCAL%20%3D%20%22reciprocal%22%3B%0AMathNode.TRUNC%20%3D%20%22trunc%22%3B%0AMathNode.FWIDTH%20%3D%20%22fwidth%22%3B%0AMathNode.BITCAST%20%3D%20%22bitcast%22%3B%0AMathNode.TRANSPOSE%20%3D%20%22transpose%22%3B%0AMathNode.ATAN2%20%3D%20%22atan2%22%3B%0AMathNode.MIN%20%3D%20%22min%22%3B%0AMathNode.MAX%20%3D%20%22max%22%3B%0AMathNode.MOD%20%3D%20%22mod%22%3B%0AMathNode.STEP%20%3D%20%22step%22%3B%0AMathNode.REFLECT%20%3D%20%22reflect%22%3B%0AMathNode.DISTANCE%20%3D%20%22distance%22%3B%0AMathNode.DIFFERENCE%20%3D%20%22difference%22%3B%0AMathNode.DOT%20%3D%20%22dot%22%3B%0AMathNode.CROSS%20%3D%20%22cross%22%3B%0AMathNode.POW%20%3D%20%22pow%22%3B%0AMathNode.TRANSFORM_DIRECTION%20%3D%20%22transformDirection%22%3B%0AMathNode.MIX%20%3D%20%22mix%22%3B%0AMathNode.CLAMP%20%3D%20%22clamp%22%3B%0AMathNode.REFRACT%20%3D%20%22refract%22%3B%0AMathNode.SMOOTHSTEP%20%3D%20%22smoothstep%22%3B%0AMathNode.FACEFORWARD%20%3D%20%22faceforward%22%3B%0Avar%20EPSILON%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%281e-6%29%3B%0Avar%20PI%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%28Math.PI%29%3B%0Avar%20PI2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%28Math.PI%20%2A%202%29%3B%0Avar%20all%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.ALL%29%3B%0Avar%20any%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.ANY%29%3B%0Avar%20equals%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.EQUALS%29%3B%0Avar%20radians%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.RADIANS%29%3B%0Avar%20degrees%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.DEGREES%29%3B%0Avar%20exp%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.EXP%29%3B%0Avar%20exp2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.EXP2%29%3B%0Avar%20log%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.LOG%29%3B%0Avar%20log2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.LOG2%29%3B%0Avar%20sqrt%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.SQRT%29%3B%0Avar%20inverseSqrt%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.INVERSE_SQRT%29%3B%0Avar%20floor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.FLOOR%29%3B%0Avar%20ceil%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.CEIL%29%3B%0Avar%20normalize2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.NORMALIZE%29%3B%0Avar%20fract%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.FRACT%29%3B%0Avar%20sin%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.SIN%29%3B%0Avar%20cos%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.COS%29%3B%0Avar%20tan%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.TAN%29%3B%0Avar%20asin%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.ASIN%29%3B%0Avar%20acos%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.ACOS%29%3B%0Avar%20atan%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.ATAN%29%3B%0Avar%20abs%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.ABS%29%3B%0Avar%20sign%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.SIGN%29%3B%0Avar%20length%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.LENGTH%29%3B%0Avar%20negate%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.NEGATE%29%3B%0Avar%20oneMinus%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.ONE_MINUS%29%3B%0Avar%20dFdx%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.DFDX%29%3B%0Avar%20dFdy%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.DFDY%29%3B%0Avar%20round%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.ROUND%29%3B%0Avar%20reciprocal%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.RECIPROCAL%29%3B%0Avar%20trunc%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.TRUNC%29%3B%0Avar%20fwidth%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.FWIDTH%29%3B%0Avar%20bitcast%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.BITCAST%29%3B%0Avar%20transpose%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.TRANSPOSE%29%3B%0Avar%20atan2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.ATAN2%29%3B%0Avar%20min%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.MIN%29%3B%0Avar%20max%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.MAX%29%3B%0Avar%20mod%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.MOD%29%3B%0Avar%20step%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.STEP%29%3B%0Avar%20reflect%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.REFLECT%29%3B%0Avar%20distance%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.DISTANCE%29%3B%0Avar%20difference%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.DIFFERENCE%29%3B%0Avar%20dot%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.DOT%29%3B%0Avar%20cross%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.CROSS%29%3B%0Avar%20pow%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.POW%29%3B%0Avar%20pow2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.POW%2C%202%29%3B%0Avar%20pow3%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.POW%2C%203%29%3B%0Avar%20pow4%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.POW%2C%204%29%3B%0Avar%20transformDirection%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.TRANSFORM_DIRECTION%29%3B%0Avar%20cbrt%20%3D%20%28a2%29%20%3D%3E%20mul%28sign%28a2%29%2C%20pow%28abs%28a2%29%2C%201%20%2F%203%29%29%3B%0Avar%20lengthSq%20%3D%20%28a2%29%20%3D%3E%20dot%28a2%2C%20a2%29%3B%0Avar%20mix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.MIX%29%3B%0Avar%20clamp2%20%3D%20%28value%2C%20low%20%3D%200%2C%20high%20%3D%201%29%20%3D%3E%20nodeObject%28new%20MathNode%28MathNode.CLAMP%2C%20nodeObject%28value%29%2C%20nodeObject%28low%29%2C%20nodeObject%28high%29%29%29%3B%0Avar%20saturate2%20%3D%20%28value%29%20%3D%3E%20clamp2%28value%29%3B%0Avar%20refract%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.REFRACT%29%3B%0Avar%20smoothstep2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.SMOOTHSTEP%29%3B%0Avar%20faceForward%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MathNode%2C%20MathNode.FACEFORWARD%29%3B%0Avar%20rand%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Buv2%5D%29%20%3D%3E%20%7B%0A%20%20const%20a2%20%3D%2012.9898%2C%20b%20%3D%2078.233%2C%20c2%20%3D%2043758.5453%3B%0A%20%20const%20dt%20%3D%20dot%28uv2.xy%2C%20vec2%28a2%2C%20b%29%29%2C%20sn%20%3D%20mod%28dt%2C%20PI%29%3B%0A%20%20return%20fract%28sin%28sn%29.mul%28c2%29%29%3B%0A%7D%29%3B%0Avar%20mixElement%20%3D%20%28t%2C%20e1%2C%20e2%29%20%3D%3E%20mix%28e1%2C%20e2%2C%20t%29%3B%0Avar%20smoothstepElement%20%3D%20%28x2%2C%20low%2C%20high%29%20%3D%3E%20smoothstep2%28low%2C%20high%2C%20x2%29%3B%0AaddMethodChaining%28%22all%22%2C%20all%29%3B%0AaddMethodChaining%28%22any%22%2C%20any%29%3B%0AaddMethodChaining%28%22equals%22%2C%20equals%29%3B%0AaddMethodChaining%28%22radians%22%2C%20radians%29%3B%0AaddMethodChaining%28%22degrees%22%2C%20degrees%29%3B%0AaddMethodChaining%28%22exp%22%2C%20exp%29%3B%0AaddMethodChaining%28%22exp2%22%2C%20exp2%29%3B%0AaddMethodChaining%28%22log%22%2C%20log%29%3B%0AaddMethodChaining%28%22log2%22%2C%20log2%29%3B%0AaddMethodChaining%28%22sqrt%22%2C%20sqrt%29%3B%0AaddMethodChaining%28%22inverseSqrt%22%2C%20inverseSqrt%29%3B%0AaddMethodChaining%28%22floor%22%2C%20floor%29%3B%0AaddMethodChaining%28%22ceil%22%2C%20ceil%29%3B%0AaddMethodChaining%28%22normalize%22%2C%20normalize2%29%3B%0AaddMethodChaining%28%22fract%22%2C%20fract%29%3B%0AaddMethodChaining%28%22sin%22%2C%20sin%29%3B%0AaddMethodChaining%28%22cos%22%2C%20cos%29%3B%0AaddMethodChaining%28%22tan%22%2C%20tan%29%3B%0AaddMethodChaining%28%22asin%22%2C%20asin%29%3B%0AaddMethodChaining%28%22acos%22%2C%20acos%29%3B%0AaddMethodChaining%28%22atan%22%2C%20atan%29%3B%0AaddMethodChaining%28%22abs%22%2C%20abs%29%3B%0AaddMethodChaining%28%22sign%22%2C%20sign%29%3B%0AaddMethodChaining%28%22length%22%2C%20length%29%3B%0AaddMethodChaining%28%22lengthSq%22%2C%20lengthSq%29%3B%0AaddMethodChaining%28%22negate%22%2C%20negate%29%3B%0AaddMethodChaining%28%22oneMinus%22%2C%20oneMinus%29%3B%0AaddMethodChaining%28%22dFdx%22%2C%20dFdx%29%3B%0AaddMethodChaining%28%22dFdy%22%2C%20dFdy%29%3B%0AaddMethodChaining%28%22round%22%2C%20round%29%3B%0AaddMethodChaining%28%22reciprocal%22%2C%20reciprocal%29%3B%0AaddMethodChaining%28%22trunc%22%2C%20trunc%29%3B%0AaddMethodChaining%28%22fwidth%22%2C%20fwidth%29%3B%0AaddMethodChaining%28%22atan2%22%2C%20atan2%29%3B%0AaddMethodChaining%28%22min%22%2C%20min%241%29%3B%0AaddMethodChaining%28%22max%22%2C%20max%241%29%3B%0AaddMethodChaining%28%22mod%22%2C%20mod%29%3B%0AaddMethodChaining%28%22step%22%2C%20step%29%3B%0AaddMethodChaining%28%22reflect%22%2C%20reflect%29%3B%0AaddMethodChaining%28%22distance%22%2C%20distance%29%3B%0AaddMethodChaining%28%22dot%22%2C%20dot%29%3B%0AaddMethodChaining%28%22cross%22%2C%20cross%29%3B%0AaddMethodChaining%28%22pow%22%2C%20pow%29%3B%0AaddMethodChaining%28%22pow2%22%2C%20pow2%29%3B%0AaddMethodChaining%28%22pow3%22%2C%20pow3%29%3B%0AaddMethodChaining%28%22pow4%22%2C%20pow4%29%3B%0AaddMethodChaining%28%22transformDirection%22%2C%20transformDirection%29%3B%0AaddMethodChaining%28%22mix%22%2C%20mixElement%29%3B%0AaddMethodChaining%28%22clamp%22%2C%20clamp2%29%3B%0AaddMethodChaining%28%22refract%22%2C%20refract%29%3B%0AaddMethodChaining%28%22smoothstep%22%2C%20smoothstepElement%29%3B%0AaddMethodChaining%28%22faceForward%22%2C%20faceForward%29%3B%0AaddMethodChaining%28%22difference%22%2C%20difference%29%3B%0AaddMethodChaining%28%22saturate%22%2C%20saturate2%29%3B%0AaddMethodChaining%28%22cbrt%22%2C%20cbrt%29%3B%0AaddMethodChaining%28%22transpose%22%2C%20transpose%29%3B%0AaddMethodChaining%28%22rand%22%2C%20rand%29%3B%0Avar%20ConditionalNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ConditionalNode%22%3B%0A%20%20%7D%0A%20%20constructor%28condNode%2C%20ifNode%2C%20elseNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.condNode%20%3D%20condNode%3B%0A%20%20%20%20this.ifNode%20%3D%20ifNode%3B%0A%20%20%20%20this.elseNode%20%3D%20elseNode%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20const%20ifType%20%3D%20this.ifNode.getNodeType%28builder%29%3B%0A%20%20%20%20if%20%28this.elseNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20elseType%20%3D%20this.elseNode.getNodeType%28builder%29%3B%0A%20%20%20%20%20%20if%20%28builder.getTypeLength%28elseType%29%20%3E%20builder.getTypeLength%28ifType%29%29%20%7B%0A%20%20%20%20%20%20%20%20return%20elseType%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20ifType%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20condNode%20%3D%20this.condNode.cache%28%29%3B%0A%20%20%20%20const%20ifNode%20%3D%20this.ifNode.cache%28%29%3B%0A%20%20%20%20const%20elseNode%20%3D%20this.elseNode%20%3F%20this.elseNode.cache%28%29%20%3A%20null%3B%0A%20%20%20%20const%20currentNodeBlock%20%3D%20builder.context.nodeBlock%3B%0A%20%20%20%20builder.getDataFromNode%28ifNode%29.parentNodeBlock%20%3D%20currentNodeBlock%3B%0A%20%20%20%20if%20%28elseNode%20%21%3D%3D%20null%29%20builder.getDataFromNode%28elseNode%29.parentNodeBlock%20%3D%20currentNodeBlock%3B%0A%20%20%20%20const%20properties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20properties.condNode%20%3D%20condNode%3B%0A%20%20%20%20properties.ifNode%20%3D%20ifNode.context%28%7B%20nodeBlock%3A%20ifNode%20%7D%29%3B%0A%20%20%20%20properties.elseNode%20%3D%20elseNode%20%3F%20elseNode.context%28%7B%20nodeBlock%3A%20elseNode%20%7D%29%20%3A%20null%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20nodeData%20%3D%20builder.getDataFromNode%28this%29%3B%0A%20%20%20%20if%20%28nodeData.nodeProperty%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20return%20nodeData.nodeProperty%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20%7B%20condNode%2C%20ifNode%2C%20elseNode%20%7D%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20const%20needsOutput%20%3D%20output2%20%21%3D%3D%20%22void%22%3B%0A%20%20%20%20const%20nodeProperty%20%3D%20needsOutput%20%3F%20property%28type%29.build%28builder%29%20%3A%20%22%22%3B%0A%20%20%20%20nodeData.nodeProperty%20%3D%20nodeProperty%3B%0A%20%20%20%20const%20nodeSnippet%20%3D%20condNode.build%28builder%2C%20%22bool%22%29%3B%0A%20%20%20%20builder.addFlowCode%28%60%0A%24%7Bbuilder.tab%7Dif%20%28%20%24%7BnodeSnippet%7D%20%29%20%7B%0A%0A%60%29.addFlowTab%28%29%3B%0A%20%20%20%20let%20ifSnippet%20%3D%20ifNode.build%28builder%2C%20type%29%3B%0A%20%20%20%20if%20%28ifSnippet%29%20%7B%0A%20%20%20%20%20%20if%20%28needsOutput%29%20%7B%0A%20%20%20%20%20%20%20%20ifSnippet%20%3D%20nodeProperty%20%2B%20%22%20%3D%20%22%20%2B%20ifSnippet%20%2B%20%22%3B%22%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20ifSnippet%20%3D%20%22return%20%22%20%2B%20ifSnippet%20%2B%20%22%3B%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20builder.removeFlowTab%28%29.addFlowCode%28builder.tab%20%2B%20%22%09%22%20%2B%20ifSnippet%20%2B%20%22%5Cn%5Cn%22%20%2B%20builder.tab%20%2B%20%22%7D%22%29%3B%0A%20%20%20%20if%20%28elseNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20builder.addFlowCode%28%22%20else%20%7B%5Cn%5Cn%22%29.addFlowTab%28%29%3B%0A%20%20%20%20%20%20let%20elseSnippet%20%3D%20elseNode.build%28builder%2C%20type%29%3B%0A%20%20%20%20%20%20if%20%28elseSnippet%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28needsOutput%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20elseSnippet%20%3D%20nodeProperty%20%2B%20%22%20%3D%20%22%20%2B%20elseSnippet%20%2B%20%22%3B%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20elseSnippet%20%3D%20%22return%20%22%20%2B%20elseSnippet%20%2B%20%22%3B%22%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20builder.removeFlowTab%28%29.addFlowCode%28builder.tab%20%2B%20%22%09%22%20%2B%20elseSnippet%20%2B%20%22%5Cn%5Cn%22%20%2B%20builder.tab%20%2B%20%22%7D%5Cn%5Cn%22%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20builder.addFlowCode%28%22%5Cn%5Cn%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20builder.format%28nodeProperty%2C%20type%2C%20output2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20select%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28ConditionalNode%29%3B%0AaddMethodChaining%28%22select%22%2C%20select%29%3B%0Avar%20cond%20%3D%20%28...params%29%20%3D%3E%20%7B%0A%20%20console.warn%28%22TSL.ConditionalNode%3A%20cond%28%29%20has%20been%20renamed%20to%20select%28%29.%22%29%3B%0A%20%20return%20select%28...params%29%3B%0A%7D%3B%0AaddMethodChaining%28%22cond%22%2C%20cond%29%3B%0Avar%20ContextNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ContextNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%2C%20value%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isContextNode%20%3D%20true%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%20%20this.value%20%3D%20value%3B%0A%20%20%7D%0A%20%20getScope%28%29%20%7B%0A%20%20%20%20return%20this.node.getScope%28%29%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.node.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20analyze%28builder%29%20%7B%0A%20%20%20%20this.node.build%28builder%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20previousContext%20%3D%20builder.getContext%28%29%3B%0A%20%20%20%20builder.setContext%28%7B%20...builder.context%2C%20...this.value%20%7D%29%3B%0A%20%20%20%20const%20node%20%3D%20this.node.build%28builder%29%3B%0A%20%20%20%20builder.setContext%28previousContext%29%3B%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20previousContext%20%3D%20builder.getContext%28%29%3B%0A%20%20%20%20builder.setContext%28%7B%20...builder.context%2C%20...this.value%20%7D%29%3B%0A%20%20%20%20const%20snippet%20%3D%20this.node.build%28builder%2C%20output2%29%3B%0A%20%20%20%20builder.setContext%28previousContext%29%3B%0A%20%20%20%20return%20snippet%3B%0A%20%20%7D%0A%7D%3B%0Avar%20context%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28ContextNode%29%3B%0Avar%20label%20%3D%20%28node%2C%20name%29%20%3D%3E%20context%28node%2C%20%7B%20label%3A%20name%20%7D%29%3B%0AaddMethodChaining%28%22context%22%2C%20context%29%3B%0AaddMethodChaining%28%22label%22%2C%20label%29%3B%0Avar%20VarNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22VarNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%2C%20name%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.global%20%3D%20true%3B%0A%20%20%20%20this.isVarNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getHash%28builder%29%20%7B%0A%20%20%20%20return%20this.name%20%7C%7C%20super.getHash%28builder%29%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.node.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20node%2C%20name%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20nodeVar%20%3D%20builder.getVarFromNode%28this%2C%20name%2C%20builder.getVectorType%28this.getNodeType%28builder%29%29%29%3B%0A%20%20%20%20const%20propertyName%20%3D%20builder.getPropertyName%28nodeVar%29%3B%0A%20%20%20%20const%20snippet%20%3D%20node.build%28builder%2C%20nodeVar.type%29%3B%0A%20%20%20%20builder.addLineFlowCode%28%60%24%7BpropertyName%7D%20%3D%20%24%7Bsnippet%7D%60%2C%20this%29%3B%0A%20%20%20%20return%20propertyName%3B%0A%20%20%7D%0A%7D%3B%0Avar%20createVar%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28VarNode%29%3B%0AaddMethodChaining%28%22toVar%22%2C%20%28...params%29%20%3D%3E%20createVar%28...params%29.append%28%29%29%3B%0Avar%20temp%20%3D%20%28node%29%20%3D%3E%20%7B%0A%20%20console.warn%28%27TSL%3A%20%22temp%22%20is%20deprecated.%20Use%20%22.toVar%28%29%22%20instead.%27%29%3B%0A%20%20return%20createVar%28node%29%3B%0A%7D%3B%0AaddMethodChaining%28%22temp%22%2C%20temp%29%3B%0Avar%20VaryingNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22VaryingNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%2C%20name%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.isVaryingNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20isGlobal%28%29%20%7B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20getHash%28builder%29%20%7B%0A%20%20%20%20return%20this.name%20%7C%7C%20super.getHash%28builder%29%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.node.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20setupVarying%28builder%29%20%7B%0A%20%20%20%20const%20properties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20let%20varying2%20%3D%20properties.varying%3B%0A%20%20%20%20if%20%28varying2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20name%20%3D%20this.name%3B%0A%20%20%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20%20%20properties.varying%20%3D%20varying2%20%3D%20builder.getVaryingFromNode%28this%2C%20name%2C%20type%29%3B%0A%20%20%20%20%20%20properties.node%20%3D%20this.node%3B%0A%20%20%20%20%7D%0A%20%20%20%20varying2.needsInterpolation%20%7C%7C%20%28varying2.needsInterpolation%20%3D%20builder.shaderStage%20%3D%3D%3D%20%22fragment%22%29%3B%0A%20%20%20%20return%20varying2%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20this.setupVarying%28builder%29%3B%0A%20%20%7D%0A%20%20analyze%28builder%29%20%7B%0A%20%20%20%20this.setupVarying%28builder%29%3B%0A%20%20%20%20return%20this.node.analyze%28builder%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20properties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20const%20varying2%20%3D%20this.setupVarying%28builder%29%3B%0A%20%20%20%20if%20%28properties.propertyName%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20%20%20const%20propertyName%20%3D%20builder.getPropertyName%28varying2%2C%20NodeShaderStage.VERTEX%29%3B%0A%20%20%20%20%20%20builder.flowNodeFromShaderStage%28NodeShaderStage.VERTEX%2C%20this.node%2C%20type%2C%20propertyName%29%3B%0A%20%20%20%20%20%20properties.propertyName%20%3D%20propertyName%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20builder.getPropertyName%28varying2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20varying%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28VaryingNode%29%3B%0AaddMethodChaining%28%22varying%22%2C%20varying%29%3B%0Avar%20sRGBTransferEOTF%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bcolor2%5D%29%20%3D%3E%20%7B%0A%20%20const%20a2%20%3D%20color2.mul%280.9478672986%29.add%280.0521327014%29.pow%282.4%29%3B%0A%20%20const%20b%20%3D%20color2.mul%280.0773993808%29%3B%0A%20%20const%20factor%20%3D%20color2.lessThanEqual%280.04045%29%3B%0A%20%20const%20rgbResult%20%3D%20mix%28a2%2C%20b%2C%20factor%29%3B%0A%20%20return%20rgbResult%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22sRGBTransferEOTF%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22color%22%2C%20type%3A%20%22vec3%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20sRGBTransferOETF%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bcolor2%5D%29%20%3D%3E%20%7B%0A%20%20const%20a2%20%3D%20color2.pow%280.41666%29.mul%281.055%29.sub%280.055%29%3B%0A%20%20const%20b%20%3D%20color2.mul%2812.92%29%3B%0A%20%20const%20factor%20%3D%20color2.lessThanEqual%2831308e-7%29%3B%0A%20%20const%20rgbResult%20%3D%20mix%28a2%2C%20b%2C%20factor%29%3B%0A%20%20return%20rgbResult%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22sRGBTransferOETF%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22color%22%2C%20type%3A%20%22vec3%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20WORKING_COLOR_SPACE%20%3D%20%22WorkingColorSpace%22%3B%0Avar%20OUTPUT_COLOR_SPACE%20%3D%20%22OutputColorSpace%22%3B%0Avar%20ColorSpaceNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ColorSpaceNode%22%3B%0A%20%20%7D%0A%20%20constructor%28colorNode%2C%20source%2C%20target%29%20%7B%0A%20%20%20%20super%28%22vec4%22%29%3B%0A%20%20%20%20this.colorNode%20%3D%20colorNode%3B%0A%20%20%20%20this.source%20%3D%20source%3B%0A%20%20%20%20this.target%20%3D%20target%3B%0A%20%20%7D%0A%20%20resolveColorSpace%28builder%2C%20colorSpace%29%20%7B%0A%20%20%20%20if%20%28colorSpace%20%3D%3D%3D%20WORKING_COLOR_SPACE%29%20%7B%0A%20%20%20%20%20%20return%20ColorManagement2.workingColorSpace%3B%0A%20%20%20%20%7D%20else%20if%20%28colorSpace%20%3D%3D%3D%20OUTPUT_COLOR_SPACE%29%20%7B%0A%20%20%20%20%20%20return%20builder.context.outputColorSpace%20%7C%7C%20builder.renderer.outputColorSpace%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20colorSpace%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20colorNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20source%20%3D%20this.resolveColorSpace%28builder%2C%20this.source%29%3B%0A%20%20%20%20const%20target%20%3D%20this.resolveColorSpace%28builder%2C%20this.target%29%3B%0A%20%20%20%20let%20outputNode%20%3D%20colorNode%3B%0A%20%20%20%20if%20%28ColorManagement2.enabled%20%3D%3D%3D%20false%20%7C%7C%20source%20%3D%3D%3D%20target%20%7C%7C%20%21source%20%7C%7C%20%21target%29%20%7B%0A%20%20%20%20%20%20return%20outputNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28ColorManagement2.getTransfer%28source%29%20%3D%3D%3D%20SRGBTransfer2%29%20%7B%0A%20%20%20%20%20%20outputNode%20%3D%20vec4%28sRGBTransferEOTF%28outputNode.rgb%29%2C%20outputNode.a%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28ColorManagement2.getPrimaries%28source%29%20%21%3D%3D%20ColorManagement2.getPrimaries%28target%29%29%20%7B%0A%20%20%20%20%20%20outputNode%20%3D%20vec4%28%0A%20%20%20%20%20%20%20%20mat3%28ColorManagement2._getMatrix%28new%20Matrix32%28%29%2C%20source%2C%20target%29%29.mul%28outputNode.rgb%29%2C%0A%20%20%20%20%20%20%20%20outputNode.a%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28ColorManagement2.getTransfer%28target%29%20%3D%3D%3D%20SRGBTransfer2%29%20%7B%0A%20%20%20%20%20%20outputNode%20%3D%20vec4%28sRGBTransferOETF%28outputNode.rgb%29%2C%20outputNode.a%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20outputNode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20toOutputColorSpace%20%3D%20%28node%29%20%3D%3E%20nodeObject%28new%20ColorSpaceNode%28nodeObject%28node%29%2C%20WORKING_COLOR_SPACE%2C%20OUTPUT_COLOR_SPACE%29%29%3B%0Avar%20toWorkingColorSpace%20%3D%20%28node%29%20%3D%3E%20nodeObject%28new%20ColorSpaceNode%28nodeObject%28node%29%2C%20OUTPUT_COLOR_SPACE%2C%20WORKING_COLOR_SPACE%29%29%3B%0Avar%20workingToColorSpace%20%3D%20%28node%2C%20colorSpace%29%20%3D%3E%20nodeObject%28new%20ColorSpaceNode%28nodeObject%28node%29%2C%20WORKING_COLOR_SPACE%2C%20colorSpace%29%29%3B%0Avar%20colorSpaceToWorking%20%3D%20%28node%2C%20colorSpace%29%20%3D%3E%20nodeObject%28new%20ColorSpaceNode%28nodeObject%28node%29%2C%20colorSpace%2C%20WORKING_COLOR_SPACE%29%29%3B%0AaddMethodChaining%28%22toOutputColorSpace%22%2C%20toOutputColorSpace%29%3B%0AaddMethodChaining%28%22toWorkingColorSpace%22%2C%20toWorkingColorSpace%29%3B%0AaddMethodChaining%28%22workingToColorSpace%22%2C%20workingToColorSpace%29%3B%0AaddMethodChaining%28%22colorSpaceToWorking%22%2C%20colorSpaceToWorking%29%3B%0Avar%20ReferenceElementNode%241%20%3D%20class%20ReferenceElementNode%20extends%20ArrayElementNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ReferenceElementNode%22%3B%0A%20%20%7D%0A%20%20constructor%28referenceNode%2C%20indexNode%29%20%7B%0A%20%20%20%20super%28referenceNode%2C%20indexNode%29%3B%0A%20%20%20%20this.referenceNode%20%3D%20referenceNode%3B%0A%20%20%20%20this.isReferenceElementNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getNodeType%28%29%20%7B%0A%20%20%20%20return%20this.referenceNode.uniformType%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20snippet%20%3D%20super.generate%28builder%29%3B%0A%20%20%20%20const%20arrayType%20%3D%20this.referenceNode.getNodeType%28%29%3B%0A%20%20%20%20const%20elementType%20%3D%20this.getNodeType%28%29%3B%0A%20%20%20%20return%20builder.format%28snippet%2C%20arrayType%2C%20elementType%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ReferenceBaseNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ReferenceBaseNode%22%3B%0A%20%20%7D%0A%20%20constructor%28property2%2C%20uniformType%2C%20object%20%3D%20null%2C%20count%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.property%20%3D%20property2%3B%0A%20%20%20%20this.uniformType%20%3D%20uniformType%3B%0A%20%20%20%20this.object%20%3D%20object%3B%0A%20%20%20%20this.count%20%3D%20count%3B%0A%20%20%20%20this.properties%20%3D%20property2.split%28%22.%22%29%3B%0A%20%20%20%20this.reference%20%3D%20object%3B%0A%20%20%20%20this.node%20%3D%20null%3B%0A%20%20%20%20this.group%20%3D%20null%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.OBJECT%3B%0A%20%20%7D%0A%20%20setGroup%28group%29%20%7B%0A%20%20%20%20this.group%20%3D%20group%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20element%28indexNode%29%20%7B%0A%20%20%20%20return%20nodeObject%28new%20ReferenceElementNode%241%28this%2C%20nodeObject%28indexNode%29%29%29%3B%0A%20%20%7D%0A%20%20setNodeType%28uniformType%29%20%7B%0A%20%20%20%20const%20node%20%3D%20uniform%28null%2C%20uniformType%29.getSelf%28%29%3B%0A%20%20%20%20if%20%28this.group%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20node.setGroup%28this.group%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20if%20%28this.node%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.updateReference%28builder%29%3B%0A%20%20%20%20%20%20this.updateValue%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.node.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20getValueFromReference%28object%20%3D%20this.reference%29%20%7B%0A%20%20%20%20const%20%7B%20properties%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20value%20%3D%20object%5Bproperties%5B0%5D%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%20properties.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20value%20%3D%20value%5Bproperties%5Bi%5D%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20value%3B%0A%20%20%7D%0A%20%20updateReference%28state%29%20%7B%0A%20%20%20%20this.reference%20%3D%20this.object%20%21%3D%3D%20null%20%3F%20this.object%20%3A%20state.object%3B%0A%20%20%20%20return%20this.reference%3B%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20this.updateValue%28%29%3B%0A%20%20%20%20return%20this.node%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20this.updateValue%28%29%3B%0A%20%20%7D%0A%20%20updateValue%28%29%20%7B%0A%20%20%20%20if%20%28this.node%20%3D%3D%3D%20null%29%20this.setNodeType%28this.uniformType%29%3B%0A%20%20%20%20const%20value%20%3D%20this.getValueFromReference%28%29%3B%0A%20%20%20%20if%20%28Array.isArray%28value%29%29%20%7B%0A%20%20%20%20%20%20this.node.array%20%3D%20value%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.node.value%20%3D%20value%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20reference%241%20%3D%20%28name%2C%20type%2C%20object%29%20%3D%3E%20nodeObject%28new%20ReferenceBaseNode%28name%2C%20type%2C%20object%29%29%3B%0Avar%20RendererReferenceNode%20%3D%20class%20extends%20ReferenceBaseNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22RendererReferenceNode%22%3B%0A%20%20%7D%0A%20%20constructor%28property2%2C%20inputType%2C%20renderer3%20%3D%20null%29%20%7B%0A%20%20%20%20super%28property2%2C%20inputType%2C%20renderer3%29%3B%0A%20%20%20%20this.renderer%20%3D%20renderer3%3B%0A%20%20%20%20this.setGroup%28renderGroup%29%3B%0A%20%20%7D%0A%20%20updateReference%28state%29%20%7B%0A%20%20%20%20this.reference%20%3D%20this.renderer%20%21%3D%3D%20null%20%3F%20this.renderer%20%3A%20state.renderer%3B%0A%20%20%20%20return%20this.reference%3B%0A%20%20%7D%0A%7D%3B%0Avar%20rendererReference%20%3D%20%28name%2C%20type%2C%20renderer3%29%20%3D%3E%20nodeObject%28new%20RendererReferenceNode%28name%2C%20type%2C%20renderer3%29%29%3B%0Avar%20ToneMappingNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ToneMappingNode%22%3B%0A%20%20%7D%0A%20%20constructor%28toneMapping2%2C%20exposureNode%20%3D%20toneMappingExposure%2C%20colorNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%22vec3%22%29%3B%0A%20%20%20%20this.toneMapping%20%3D%20toneMapping2%3B%0A%20%20%20%20this.exposureNode%20%3D%20exposureNode%3B%0A%20%20%20%20this.colorNode%20%3D%20colorNode%3B%0A%20%20%7D%0A%20%20getCacheKey%28%29%20%7B%0A%20%20%20%20return%20hash%241%28super.getCacheKey%28%29%2C%20this.toneMapping%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20colorNode%20%3D%20this.colorNode%20%7C%7C%20builder.context.color%3B%0A%20%20%20%20const%20toneMapping2%20%3D%20this.toneMapping%3B%0A%20%20%20%20if%20%28toneMapping2%20%3D%3D%3D%20NoToneMapping2%29%20return%20colorNode%3B%0A%20%20%20%20let%20outputNode%20%3D%20null%3B%0A%20%20%20%20const%20toneMappingFn%20%3D%20builder.renderer.library.getToneMappingFunction%28toneMapping2%29%3B%0A%20%20%20%20if%20%28toneMappingFn%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20outputNode%20%3D%20vec4%28toneMappingFn%28colorNode.rgb%2C%20this.exposureNode%29%2C%20colorNode.a%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%22ToneMappingNode%3A%20Unsupported%20Tone%20Mapping%20configuration.%22%2C%20toneMapping2%29%3B%0A%20%20%20%20%20%20outputNode%20%3D%20colorNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20outputNode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20toneMapping%20%3D%20%28mapping%2C%20exposure%2C%20color2%29%20%3D%3E%20nodeObject%28new%20ToneMappingNode%28mapping%2C%20nodeObject%28exposure%29%2C%20nodeObject%28color2%29%29%29%3B%0Avar%20toneMappingExposure%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20rendererReference%28%22toneMappingExposure%22%2C%20%22float%22%29%3B%0AaddMethodChaining%28%22toneMapping%22%2C%20%28color2%2C%20mapping%2C%20exposure%29%20%3D%3E%20toneMapping%28mapping%2C%20exposure%2C%20color2%29%29%3B%0Avar%20BufferAttributeNode%20%3D%20class%20extends%20InputNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22BufferAttributeNode%22%3B%0A%20%20%7D%0A%20%20constructor%28value%2C%20bufferType%20%3D%20null%2C%20bufferStride%20%3D%200%2C%20bufferOffset%20%3D%200%29%20%7B%0A%20%20%20%20super%28value%2C%20bufferType%29%3B%0A%20%20%20%20this.isBufferNode%20%3D%20true%3B%0A%20%20%20%20this.bufferType%20%3D%20bufferType%3B%0A%20%20%20%20this.bufferStride%20%3D%20bufferStride%3B%0A%20%20%20%20this.bufferOffset%20%3D%20bufferOffset%3B%0A%20%20%20%20this.usage%20%3D%20StaticDrawUsage2%3B%0A%20%20%20%20this.instanced%20%3D%20false%3B%0A%20%20%20%20this.attribute%20%3D%20null%3B%0A%20%20%20%20this.global%20%3D%20true%3B%0A%20%20%20%20if%20%28value%20%26%26%20value.isBufferAttribute%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.attribute%20%3D%20value%3B%0A%20%20%20%20%20%20this.usage%20%3D%20value.usage%3B%0A%20%20%20%20%20%20this.instanced%20%3D%20value.isInstancedBufferAttribute%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getHash%28builder%29%20%7B%0A%20%20%20%20if%20%28this.bufferStride%20%3D%3D%3D%200%20%26%26%20this.bufferOffset%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20let%20bufferData%20%3D%20builder.globalCache.getData%28this.value%29%3B%0A%20%20%20%20%20%20if%20%28bufferData%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20bufferData%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20node%3A%20this%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20builder.globalCache.setData%28this.value%2C%20bufferData%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20bufferData.node.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.uuid%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20if%20%28this.bufferType%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.bufferType%20%3D%20builder.getTypeFromAttribute%28this.attribute%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.bufferType%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20if%20%28this.attribute%20%21%3D%3D%20null%29%20return%3B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20array%20%3D%20this.value%3B%0A%20%20%20%20const%20itemSize%20%3D%20builder.getTypeLength%28type%29%3B%0A%20%20%20%20const%20stride%20%3D%20this.bufferStride%20%7C%7C%20itemSize%3B%0A%20%20%20%20const%20offset%20%3D%20this.bufferOffset%3B%0A%20%20%20%20const%20buffer2%20%3D%20array.isInterleavedBuffer%20%3D%3D%3D%20true%20%3F%20array%20%3A%20new%20InterleavedBuffer%28array%2C%20stride%29%3B%0A%20%20%20%20const%20bufferAttribute2%20%3D%20new%20InterleavedBufferAttribute%28buffer2%2C%20itemSize%2C%20offset%29%3B%0A%20%20%20%20buffer2.setUsage%28this.usage%29%3B%0A%20%20%20%20this.attribute%20%3D%20bufferAttribute2%3B%0A%20%20%20%20this.attribute.isInstancedBufferAttribute%20%3D%20this.instanced%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20nodeType%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20nodeAttribute%20%3D%20builder.getBufferAttributeFromNode%28this%2C%20nodeType%29%3B%0A%20%20%20%20const%20propertyName%20%3D%20builder.getPropertyName%28nodeAttribute%29%3B%0A%20%20%20%20let%20output2%20%3D%20null%3B%0A%20%20%20%20if%20%28builder.shaderStage%20%3D%3D%3D%20%22vertex%22%20%7C%7C%20builder.shaderStage%20%3D%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20this.name%20%3D%20propertyName%3B%0A%20%20%20%20%20%20output2%20%3D%20propertyName%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20nodeVarying%20%3D%20varying%28this%29%3B%0A%20%20%20%20%20%20output2%20%3D%20nodeVarying.build%28builder%2C%20nodeType%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%20%20getInputType%28%29%20%7B%0A%20%20%20%20return%20%22bufferAttribute%22%3B%0A%20%20%7D%0A%20%20setUsage%28value%29%20%7B%0A%20%20%20%20this.usage%20%3D%20value%3B%0A%20%20%20%20if%20%28this.attribute%20%26%26%20this.attribute.isBufferAttribute%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.attribute.usage%20%3D%20value%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setInstanced%28value%29%20%7B%0A%20%20%20%20this.instanced%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20bufferAttribute%20%3D%20%28array%2C%20type%2C%20stride%2C%20offset%29%20%3D%3E%20nodeObject%28new%20BufferAttributeNode%28array%2C%20type%2C%20stride%2C%20offset%29%29%3B%0Avar%20dynamicBufferAttribute%20%3D%20%28array%2C%20type%2C%20stride%2C%20offset%29%20%3D%3E%20bufferAttribute%28array%2C%20type%2C%20stride%2C%20offset%29.setUsage%28DynamicDrawUsage%29%3B%0Avar%20instancedBufferAttribute%20%3D%20%28array%2C%20type%2C%20stride%2C%20offset%29%20%3D%3E%20bufferAttribute%28array%2C%20type%2C%20stride%2C%20offset%29.setInstanced%28true%29%3B%0Avar%20instancedDynamicBufferAttribute%20%3D%20%28array%2C%20type%2C%20stride%2C%20offset%29%20%3D%3E%20dynamicBufferAttribute%28array%2C%20type%2C%20stride%2C%20offset%29.setInstanced%28true%29%3B%0AaddMethodChaining%28%22toAttribute%22%2C%20%28bufferNode%29%20%3D%3E%20bufferAttribute%28bufferNode.value%29%29%3B%0Avar%20ComputeNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ComputeNode%22%3B%0A%20%20%7D%0A%20%20constructor%28computeNode%2C%20count%2C%20workgroupSize%20%3D%20%5B64%5D%29%20%7B%0A%20%20%20%20super%28%22void%22%29%3B%0A%20%20%20%20this.isComputeNode%20%3D%20true%3B%0A%20%20%20%20this.computeNode%20%3D%20computeNode%3B%0A%20%20%20%20this.count%20%3D%20count%3B%0A%20%20%20%20this.workgroupSize%20%3D%20workgroupSize%3B%0A%20%20%20%20this.dispatchCount%20%3D%200%3B%0A%20%20%20%20this.version%20%3D%201%3B%0A%20%20%20%20this.updateBeforeType%20%3D%20NodeUpdateType.OBJECT%3B%0A%20%20%20%20this.onInitFunction%20%3D%20null%3B%0A%20%20%20%20this.updateDispatchCount%28%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.dispatchEvent%28%7B%20type%3A%20%22dispose%22%20%7D%29%3B%0A%20%20%7D%0A%20%20set%20needsUpdate%28value%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20true%29%20this.version%2B%2B%3B%0A%20%20%7D%0A%20%20updateDispatchCount%28%29%20%7B%0A%20%20%20%20const%20%7B%20count%2C%20workgroupSize%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20size%20%3D%20workgroupSize%5B0%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%20workgroupSize.length%3B%20i%2B%2B%29%0A%20%20%20%20%20%20size%20%2A%3D%20workgroupSize%5Bi%5D%3B%0A%20%20%20%20this.dispatchCount%20%3D%20Math.ceil%28count%20%2F%20size%29%3B%0A%20%20%7D%0A%20%20onInit%28callback%29%20%7B%0A%20%20%20%20this.onInitFunction%20%3D%20callback%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20updateBefore%28%7B%20renderer%3A%20renderer3%20%7D%29%20%7B%0A%20%20%20%20renderer3.compute%28this%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20shaderStage%20%7D%20%3D%20builder%3B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20const%20snippet%20%3D%20this.computeNode.build%28builder%2C%20%22void%22%29%3B%0A%20%20%20%20%20%20if%20%28snippet%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20%20%20builder.addLineFlowCode%28snippet%2C%20this%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20compute%20%3D%20%28node%2C%20count%2C%20workgroupSize%29%20%3D%3E%20nodeObject%28new%20ComputeNode%28nodeObject%28node%29%2C%20count%2C%20workgroupSize%29%29%3B%0AaddMethodChaining%28%22compute%22%2C%20compute%29%3B%0Avar%20CacheNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22CacheNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%2C%20parent%20%3D%20true%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%20%20this.parent%20%3D%20parent%3B%0A%20%20%20%20this.isCacheNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.node.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20build%28builder%2C%20...params%29%20%7B%0A%20%20%20%20const%20previousCache%20%3D%20builder.getCache%28%29%3B%0A%20%20%20%20const%20cache2%20%3D%20builder.getCacheFromNode%28this%2C%20this.parent%29%3B%0A%20%20%20%20builder.setCache%28cache2%29%3B%0A%20%20%20%20const%20data%20%3D%20this.node.build%28builder%2C%20...params%29%3B%0A%20%20%20%20builder.setCache%28previousCache%29%3B%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%7D%3B%0Avar%20cache%20%3D%20%28node%2C%20...params%29%20%3D%3E%20nodeObject%28new%20CacheNode%28nodeObject%28node%29%2C%20...params%29%29%3B%0AaddMethodChaining%28%22cache%22%2C%20cache%29%3B%0Avar%20BypassNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22BypassNode%22%3B%0A%20%20%7D%0A%20%20constructor%28returnNode%2C%20callNode%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isBypassNode%20%3D%20true%3B%0A%20%20%20%20this.outputNode%20%3D%20returnNode%3B%0A%20%20%20%20this.callNode%20%3D%20callNode%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.outputNode.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20snippet%20%3D%20this.callNode.build%28builder%2C%20%22void%22%29%3B%0A%20%20%20%20if%20%28snippet%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20builder.addLineFlowCode%28snippet%2C%20this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.outputNode.build%28builder%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20bypass%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28BypassNode%29%3B%0AaddMethodChaining%28%22bypass%22%2C%20bypass%29%3B%0Avar%20RemapNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22RemapNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%2C%20inLowNode%2C%20inHighNode%2C%20outLowNode%20%3D%20float%280%29%2C%20outHighNode%20%3D%20float%281%29%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%20%20this.inLowNode%20%3D%20inLowNode%3B%0A%20%20%20%20this.inHighNode%20%3D%20inHighNode%3B%0A%20%20%20%20this.outLowNode%20%3D%20outLowNode%3B%0A%20%20%20%20this.outHighNode%20%3D%20outHighNode%3B%0A%20%20%20%20this.doClamp%20%3D%20true%3B%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20const%20%7B%20node%2C%20inLowNode%2C%20inHighNode%2C%20outLowNode%2C%20outHighNode%2C%20doClamp%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20t%20%3D%20node.sub%28inLowNode%29.div%28inHighNode.sub%28inLowNode%29%29%3B%0A%20%20%20%20if%20%28doClamp%20%3D%3D%3D%20true%29%20t%20%3D%20t.clamp%28%29%3B%0A%20%20%20%20return%20t.mul%28outHighNode.sub%28outLowNode%29%29.add%28outLowNode%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20remap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28RemapNode%2C%20null%2C%20null%2C%20%7B%20doClamp%3A%20false%20%7D%29%3B%0Avar%20remapClamp%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28RemapNode%29%3B%0AaddMethodChaining%28%22remap%22%2C%20remap%29%3B%0AaddMethodChaining%28%22remapClamp%22%2C%20remapClamp%29%3B%0Avar%20ExpressionNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ExpressionNode%22%3B%0A%20%20%7D%0A%20%20constructor%28snippet%20%3D%20%22%22%2C%20nodeType%20%3D%20%22void%22%29%20%7B%0A%20%20%20%20super%28nodeType%29%3B%0A%20%20%20%20this.snippet%20%3D%20snippet%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20snippet%20%3D%20this.snippet%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20builder.addLineFlowCode%28snippet%2C%20this%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20builder.format%28%60%28%20%24%7Bsnippet%7D%20%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20expression%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28ExpressionNode%29%3B%0Avar%20Discard%20%3D%20%28conditional%29%20%3D%3E%20%28conditional%20%3F%20select%28conditional%2C%20expression%28%22discard%22%29%29%20%3A%20expression%28%22discard%22%29%29.append%28%29%3B%0AaddMethodChaining%28%22discard%22%2C%20Discard%29%3B%0Avar%20RenderOutputNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22RenderOutputNode%22%3B%0A%20%20%7D%0A%20%20constructor%28colorNode%2C%20toneMapping2%2C%20outputColorSpace%29%20%7B%0A%20%20%20%20super%28%22vec4%22%29%3B%0A%20%20%20%20this.colorNode%20%3D%20colorNode%3B%0A%20%20%20%20this.toneMapping%20%3D%20toneMapping2%3B%0A%20%20%20%20this.outputColorSpace%20%3D%20outputColorSpace%3B%0A%20%20%20%20this.isRenderOutput%20%3D%20true%3B%0A%20%20%7D%0A%20%20setup%28%7B%20context%3A%20context2%20%7D%29%20%7B%0A%20%20%20%20let%20outputNode%20%3D%20this.colorNode%20%7C%7C%20context2.color%3B%0A%20%20%20%20const%20toneMapping2%20%3D%20%28this.toneMapping%20%21%3D%3D%20null%20%3F%20this.toneMapping%20%3A%20context2.toneMapping%29%20%7C%7C%20NoToneMapping2%3B%0A%20%20%20%20const%20outputColorSpace%20%3D%20%28this.outputColorSpace%20%21%3D%3D%20null%20%3F%20this.outputColorSpace%20%3A%20context2.outputColorSpace%29%20%7C%7C%20NoColorSpace2%3B%0A%20%20%20%20if%20%28toneMapping2%20%21%3D%3D%20NoToneMapping2%29%20%7B%0A%20%20%20%20%20%20outputNode%20%3D%20outputNode.toneMapping%28toneMapping2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28outputColorSpace%20%21%3D%3D%20NoColorSpace2%20%26%26%20outputColorSpace%20%21%3D%3D%20ColorManagement2.workingColorSpace%29%20%7B%0A%20%20%20%20%20%20outputNode%20%3D%20outputNode.workingToColorSpace%28outputColorSpace%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20outputNode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20renderOutput%20%3D%20%28color2%2C%20toneMapping2%20%3D%20null%2C%20outputColorSpace%20%3D%20null%29%20%3D%3E%20nodeObject%28new%20RenderOutputNode%28nodeObject%28color2%29%2C%20toneMapping2%2C%20outputColorSpace%29%29%3B%0AaddMethodChaining%28%22renderOutput%22%2C%20renderOutput%29%3B%0Avar%20AttributeNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22AttributeNode%22%3B%0A%20%20%7D%0A%20%20constructor%28attributeName%2C%20nodeType%20%3D%20null%29%20%7B%0A%20%20%20%20super%28nodeType%29%3B%0A%20%20%20%20this.global%20%3D%20true%3B%0A%20%20%20%20this._attributeName%20%3D%20attributeName%3B%0A%20%20%7D%0A%20%20getHash%28builder%29%20%7B%0A%20%20%20%20return%20this.getAttributeName%28builder%29%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20let%20nodeType%20%3D%20this.nodeType%3B%0A%20%20%20%20if%20%28nodeType%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20attributeName%20%3D%20this.getAttributeName%28builder%29%3B%0A%20%20%20%20%20%20if%20%28builder.hasGeometryAttribute%28attributeName%29%29%20%7B%0A%20%20%20%20%20%20%20%20const%20attribute2%20%3D%20builder.geometry.getAttribute%28attributeName%29%3B%0A%20%20%20%20%20%20%20%20nodeType%20%3D%20builder.getTypeFromAttribute%28attribute2%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20nodeType%20%3D%20%22float%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeType%3B%0A%20%20%7D%0A%20%20setAttributeName%28attributeName%29%20%7B%0A%20%20%20%20this._attributeName%20%3D%20attributeName%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getAttributeName%28%29%20%7B%0A%20%20%20%20return%20this._attributeName%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20attributeName%20%3D%20this.getAttributeName%28builder%29%3B%0A%20%20%20%20const%20nodeType%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20geometryAttribute%20%3D%20builder.hasGeometryAttribute%28attributeName%29%3B%0A%20%20%20%20if%20%28geometryAttribute%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20builder.geometry.getAttribute%28attributeName%29%3B%0A%20%20%20%20%20%20const%20attributeType%20%3D%20builder.getTypeFromAttribute%28attribute2%29%3B%0A%20%20%20%20%20%20const%20nodeAttribute%20%3D%20builder.getAttribute%28attributeName%2C%20attributeType%29%3B%0A%20%20%20%20%20%20if%20%28builder.shaderStage%20%3D%3D%3D%20%22vertex%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%20builder.format%28nodeAttribute.name%2C%20attributeType%2C%20nodeType%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20nodeVarying%20%3D%20varying%28this%29%3B%0A%20%20%20%20%20%20%20%20return%20nodeVarying.build%28builder%2C%20nodeType%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%60AttributeNode%3A%20Vertex%20attribute%20%22%24%7BattributeName%7D%22%20not%20found%20on%20geometry.%60%29%3B%0A%20%20%20%20%20%20return%20builder.generateConst%28nodeType%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.global%20%3D%20this.global%3B%0A%20%20%20%20data._attributeName%20%3D%20this._attributeName%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.global%20%3D%20data.global%3B%0A%20%20%20%20this._attributeName%20%3D%20data._attributeName%3B%0A%20%20%7D%0A%7D%3B%0Avar%20attribute%20%3D%20%28name%2C%20nodeType%29%20%3D%3E%20nodeObject%28new%20AttributeNode%28name%2C%20nodeType%29%29%3B%0Avar%20uv%20%3D%20%28index5%29%20%3D%3E%20attribute%28%22uv%22%20%2B%20%28index5%20%3E%200%20%3F%20index5%20%3A%20%22%22%29%2C%20%22vec2%22%29%3B%0Avar%20TextureSizeNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22TextureSizeNode%22%3B%0A%20%20%7D%0A%20%20constructor%28textureNode%2C%20levelNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%22uvec2%22%29%3B%0A%20%20%20%20this.isTextureSizeNode%20%3D%20true%3B%0A%20%20%20%20this.textureNode%20%3D%20textureNode%3B%0A%20%20%20%20this.levelNode%20%3D%20levelNode%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20textureProperty%20%3D%20this.textureNode.build%28builder%2C%20%22property%22%29%3B%0A%20%20%20%20const%20level%20%3D%20this.levelNode%20%3D%3D%3D%20null%20%3F%20%220%22%20%3A%20this.levelNode.build%28builder%2C%20%22int%22%29%3B%0A%20%20%20%20return%20builder.format%28%60%24%7Bbuilder.getMethod%28%22textureDimensions%22%29%7D%28%20%24%7BtextureProperty%7D%2C%20%24%7Blevel%7D%20%29%60%2C%20this.getNodeType%28builder%29%2C%20output2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20textureSize%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28TextureSizeNode%29%3B%0Avar%20MaxMipLevelNode%20%3D%20class%20extends%20UniformNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MaxMipLevelNode%22%3B%0A%20%20%7D%0A%20%20constructor%28textureNode%29%20%7B%0A%20%20%20%20super%280%29%3B%0A%20%20%20%20this._textureNode%20%3D%20textureNode%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.FRAME%3B%0A%20%20%7D%0A%20%20get%20textureNode%28%29%20%7B%0A%20%20%20%20return%20this._textureNode%3B%0A%20%20%7D%0A%20%20get%20texture%28%29%20%7B%0A%20%20%20%20return%20this._textureNode.value%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20this.texture%3B%0A%20%20%20%20const%20images%20%3D%20texture2.images%3B%0A%20%20%20%20const%20image%20%3D%20images%20%26%26%20images.length%20%3E%200%20%3F%20images%5B0%5D%20%26%26%20images%5B0%5D.image%20%7C%7C%20images%5B0%5D%20%3A%20texture2.image%3B%0A%20%20%20%20if%20%28image%20%26%26%20image.width%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20width%2C%20height%20%7D%20%3D%20image%3B%0A%20%20%20%20%20%20this.value%20%3D%20Math.log2%28Math.max%28width%2C%20height%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20maxMipLevel%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MaxMipLevelNode%29%3B%0Avar%20TextureNode%20%3D%20class%20extends%20UniformNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22TextureNode%22%3B%0A%20%20%7D%0A%20%20constructor%28value%2C%20uvNode%20%3D%20null%2C%20levelNode%20%3D%20null%2C%20biasNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28value%29%3B%0A%20%20%20%20this.isTextureNode%20%3D%20true%3B%0A%20%20%20%20this.uvNode%20%3D%20uvNode%3B%0A%20%20%20%20this.levelNode%20%3D%20levelNode%3B%0A%20%20%20%20this.biasNode%20%3D%20biasNode%3B%0A%20%20%20%20this.compareNode%20%3D%20null%3B%0A%20%20%20%20this.depthNode%20%3D%20null%3B%0A%20%20%20%20this.gradNode%20%3D%20null%3B%0A%20%20%20%20this.sampler%20%3D%20true%3B%0A%20%20%20%20this.updateMatrix%20%3D%20false%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.NONE%3B%0A%20%20%20%20this.referenceNode%20%3D%20null%3B%0A%20%20%20%20this._value%20%3D%20value%3B%0A%20%20%20%20this._matrixUniform%20%3D%20null%3B%0A%20%20%20%20this.setUpdateMatrix%28uvNode%20%3D%3D%3D%20null%29%3B%0A%20%20%7D%0A%20%20set%20value%28value%29%20%7B%0A%20%20%20%20if%20%28this.referenceNode%29%20%7B%0A%20%20%20%20%20%20this.referenceNode.value%20%3D%20value%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._value%20%3D%20value%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20get%20value%28%29%20%7B%0A%20%20%20%20return%20this.referenceNode%20%3F%20this.referenceNode.value%20%3A%20this._value%3B%0A%20%20%7D%0A%20%20getUniformHash%28%29%20%7B%0A%20%20%20%20return%20this.value.uuid%3B%0A%20%20%7D%0A%20%20getNodeType%28%29%20%7B%0A%20%20%20%20if%20%28this.value.isDepthTexture%20%3D%3D%3D%20true%29%20return%20%22float%22%3B%0A%20%20%20%20if%20%28this.value.type%20%3D%3D%3D%20UnsignedIntType2%29%20%7B%0A%20%20%20%20%20%20return%20%22uvec4%22%3B%0A%20%20%20%20%7D%20else%20if%20%28this.value.type%20%3D%3D%3D%20IntType2%29%20%7B%0A%20%20%20%20%20%20return%20%22ivec4%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%22vec4%22%3B%0A%20%20%7D%0A%20%20getInputType%28%29%20%7B%0A%20%20%20%20return%20%22texture%22%3B%0A%20%20%7D%0A%20%20getDefaultUV%28%29%20%7B%0A%20%20%20%20return%20uv%28this.value.channel%29%3B%0A%20%20%7D%0A%20%20updateReference%28%29%20%7B%0A%20%20%20%20return%20this.value%3B%0A%20%20%7D%0A%20%20getTransformedUV%28uvNode%29%20%7B%0A%20%20%20%20if%20%28this._matrixUniform%20%3D%3D%3D%20null%29%20this._matrixUniform%20%3D%20uniform%28this.value.matrix%29%3B%0A%20%20%20%20return%20this._matrixUniform.mul%28vec3%28uvNode%2C%201%29%29.xy%3B%0A%20%20%7D%0A%20%20setUpdateMatrix%28value%29%20%7B%0A%20%20%20%20this.updateMatrix%20%3D%20value%3B%0A%20%20%20%20this.updateType%20%3D%20value%20%3F%20NodeUpdateType.FRAME%20%3A%20NodeUpdateType.NONE%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setupUV%28builder%2C%20uvNode%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20this.value%3B%0A%20%20%20%20if%20%28builder.isFlipY%28%29%20%26%26%20%28texture2.isRenderTargetTexture%20%3D%3D%3D%20true%20%7C%7C%20texture2.isFramebufferTexture%20%3D%3D%3D%20true%20%7C%7C%20texture2.isDepthTexture%20%3D%3D%3D%20true%29%29%20%7B%0A%20%20%20%20%20%20if%20%28this.sampler%29%20%7B%0A%20%20%20%20%20%20%20%20uvNode%20%3D%20uvNode.flipY%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20uvNode%20%3D%20uvNode.setY%28int%28textureSize%28this%2C%20this.levelNode%29.y%29.sub%28uvNode.y%29.sub%281%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20uvNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20properties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20properties.referenceNode%20%3D%20this.referenceNode%3B%0A%20%20%20%20let%20uvNode%20%3D%20this.uvNode%3B%0A%20%20%20%20if%20%28%28uvNode%20%3D%3D%3D%20null%20%7C%7C%20builder.context.forceUVContext%20%3D%3D%3D%20true%29%20%26%26%20builder.context.getUV%29%20%7B%0A%20%20%20%20%20%20uvNode%20%3D%20builder.context.getUV%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%21uvNode%29%20uvNode%20%3D%20this.getDefaultUV%28%29%3B%0A%20%20%20%20if%20%28this.updateMatrix%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20uvNode%20%3D%20this.getTransformedUV%28uvNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20uvNode%20%3D%20this.setupUV%28builder%2C%20uvNode%29%3B%0A%20%20%20%20let%20levelNode%20%3D%20this.levelNode%3B%0A%20%20%20%20if%20%28levelNode%20%3D%3D%3D%20null%20%26%26%20builder.context.getTextureLevel%29%20%7B%0A%20%20%20%20%20%20levelNode%20%3D%20builder.context.getTextureLevel%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20properties.uvNode%20%3D%20uvNode%3B%0A%20%20%20%20properties.levelNode%20%3D%20levelNode%3B%0A%20%20%20%20properties.biasNode%20%3D%20this.biasNode%3B%0A%20%20%20%20properties.compareNode%20%3D%20this.compareNode%3B%0A%20%20%20%20properties.gradNode%20%3D%20this.gradNode%3B%0A%20%20%20%20properties.depthNode%20%3D%20this.depthNode%3B%0A%20%20%7D%0A%20%20generateUV%28builder%2C%20uvNode%29%20%7B%0A%20%20%20%20return%20uvNode.build%28builder%2C%20this.sampler%20%3D%3D%3D%20true%20%3F%20%22vec2%22%20%3A%20%22ivec2%22%29%3B%0A%20%20%7D%0A%20%20generateSnippet%28builder%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%2C%20biasSnippet%2C%20depthSnippet%2C%20compareSnippet%2C%20gradSnippet%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20this.value%3B%0A%20%20%20%20let%20snippet%3B%0A%20%20%20%20if%20%28levelSnippet%29%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20builder.generateTextureLevel%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%2C%20depthSnippet%29%3B%0A%20%20%20%20%7D%20else%20if%20%28biasSnippet%29%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20builder.generateTextureBias%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20biasSnippet%2C%20depthSnippet%29%3B%0A%20%20%20%20%7D%20else%20if%20%28gradSnippet%29%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20builder.generateTextureGrad%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20gradSnippet%2C%20depthSnippet%29%3B%0A%20%20%20%20%7D%20else%20if%20%28compareSnippet%29%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20builder.generateTextureCompare%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20compareSnippet%2C%20depthSnippet%29%3B%0A%20%20%20%20%7D%20else%20if%20%28this.sampler%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20builder.generateTextureLoad%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20depthSnippet%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20builder.generateTexture%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20depthSnippet%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippet%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20const%20properties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20const%20texture2%20%3D%20this.value%3B%0A%20%20%20%20if%20%28%21texture2%20%7C%7C%20texture2.isTexture%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22TextureNode%3A%20Need%20a%20three.js%20texture.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20textureProperty%20%3D%20super.generate%28builder%2C%20%22property%22%29%3B%0A%20%20%20%20if%20%28output2%20%3D%3D%3D%20%22sampler%22%29%20%7B%0A%20%20%20%20%20%20return%20textureProperty%20%2B%20%22_sampler%22%3B%0A%20%20%20%20%7D%20else%20if%20%28builder.isReference%28output2%29%29%20%7B%0A%20%20%20%20%20%20return%20textureProperty%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20nodeData%20%3D%20builder.getDataFromNode%28this%29%3B%0A%20%20%20%20%20%20let%20propertyName%20%3D%20nodeData.propertyName%3B%0A%20%20%20%20%20%20if%20%28propertyName%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20%7B%20uvNode%2C%20levelNode%2C%20biasNode%2C%20compareNode%2C%20depthNode%2C%20gradNode%20%7D%20%3D%20properties%3B%0A%20%20%20%20%20%20%20%20const%20uvSnippet%20%3D%20this.generateUV%28builder%2C%20uvNode%29%3B%0A%20%20%20%20%20%20%20%20const%20levelSnippet%20%3D%20levelNode%20%3F%20levelNode.build%28builder%2C%20%22float%22%29%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20const%20biasSnippet%20%3D%20biasNode%20%3F%20biasNode.build%28builder%2C%20%22float%22%29%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20const%20depthSnippet%20%3D%20depthNode%20%3F%20depthNode.build%28builder%2C%20%22int%22%29%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20const%20compareSnippet%20%3D%20compareNode%20%3F%20compareNode.build%28builder%2C%20%22float%22%29%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20const%20gradSnippet%20%3D%20gradNode%20%3F%20%5BgradNode%5B0%5D.build%28builder%2C%20%22vec2%22%29%2C%20gradNode%5B1%5D.build%28builder%2C%20%22vec2%22%29%5D%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20const%20nodeVar%20%3D%20builder.getVarFromNode%28this%29%3B%0A%20%20%20%20%20%20%20%20propertyName%20%3D%20builder.getPropertyName%28nodeVar%29%3B%0A%20%20%20%20%20%20%20%20const%20snippet2%20%3D%20this.generateSnippet%28builder%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%2C%20biasSnippet%2C%20depthSnippet%2C%20compareSnippet%2C%20gradSnippet%29%3B%0A%20%20%20%20%20%20%20%20builder.addLineFlowCode%28%60%24%7BpropertyName%7D%20%3D%20%24%7Bsnippet2%7D%60%2C%20this%29%3B%0A%20%20%20%20%20%20%20%20nodeData.snippet%20%3D%20snippet2%3B%0A%20%20%20%20%20%20%20%20nodeData.propertyName%20%3D%20propertyName%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20snippet%20%3D%20propertyName%3B%0A%20%20%20%20%20%20const%20nodeType%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20%20%20if%20%28builder.needsToWorkingColorSpace%28texture2%29%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20colorSpaceToWorking%28expression%28snippet%2C%20nodeType%29%2C%20texture2.colorSpace%29.setup%28builder%29.build%28builder%2C%20nodeType%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20builder.format%28snippet%2C%20nodeType%2C%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setSampler%28value%29%20%7B%0A%20%20%20%20this.sampler%20%3D%20value%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getSampler%28%29%20%7B%0A%20%20%20%20return%20this.sampler%3B%0A%20%20%7D%0A%20%20%2F%2F%20%40TODO%3A%20Move%20to%20TSL%0A%20%20uv%28uvNode%29%20%7B%0A%20%20%20%20const%20textureNode%20%3D%20this.clone%28%29%3B%0A%20%20%20%20textureNode.uvNode%20%3D%20nodeObject%28uvNode%29%3B%0A%20%20%20%20textureNode.referenceNode%20%3D%20this.getSelf%28%29%3B%0A%20%20%20%20return%20nodeObject%28textureNode%29%3B%0A%20%20%7D%0A%20%20blur%28amountNode%29%20%7B%0A%20%20%20%20const%20textureNode%20%3D%20this.clone%28%29%3B%0A%20%20%20%20textureNode.biasNode%20%3D%20nodeObject%28amountNode%29.mul%28maxMipLevel%28textureNode%29%29%3B%0A%20%20%20%20textureNode.referenceNode%20%3D%20this.getSelf%28%29%3B%0A%20%20%20%20return%20nodeObject%28textureNode%29%3B%0A%20%20%7D%0A%20%20level%28levelNode%29%20%7B%0A%20%20%20%20const%20textureNode%20%3D%20this.clone%28%29%3B%0A%20%20%20%20textureNode.levelNode%20%3D%20nodeObject%28levelNode%29%3B%0A%20%20%20%20textureNode.referenceNode%20%3D%20this.getSelf%28%29%3B%0A%20%20%20%20return%20nodeObject%28textureNode%29%3B%0A%20%20%7D%0A%20%20size%28levelNode%29%20%7B%0A%20%20%20%20return%20textureSize%28this%2C%20levelNode%29%3B%0A%20%20%7D%0A%20%20bias%28biasNode%29%20%7B%0A%20%20%20%20const%20textureNode%20%3D%20this.clone%28%29%3B%0A%20%20%20%20textureNode.biasNode%20%3D%20nodeObject%28biasNode%29%3B%0A%20%20%20%20textureNode.referenceNode%20%3D%20this.getSelf%28%29%3B%0A%20%20%20%20return%20nodeObject%28textureNode%29%3B%0A%20%20%7D%0A%20%20compare%28compareNode%29%20%7B%0A%20%20%20%20const%20textureNode%20%3D%20this.clone%28%29%3B%0A%20%20%20%20textureNode.compareNode%20%3D%20nodeObject%28compareNode%29%3B%0A%20%20%20%20textureNode.referenceNode%20%3D%20this.getSelf%28%29%3B%0A%20%20%20%20return%20nodeObject%28textureNode%29%3B%0A%20%20%7D%0A%20%20grad%28gradNodeX%2C%20gradNodeY%29%20%7B%0A%20%20%20%20const%20textureNode%20%3D%20this.clone%28%29%3B%0A%20%20%20%20textureNode.gradNode%20%3D%20%5BnodeObject%28gradNodeX%29%2C%20nodeObject%28gradNodeY%29%5D%3B%0A%20%20%20%20textureNode.referenceNode%20%3D%20this.getSelf%28%29%3B%0A%20%20%20%20return%20nodeObject%28textureNode%29%3B%0A%20%20%7D%0A%20%20depth%28depthNode%29%20%7B%0A%20%20%20%20const%20textureNode%20%3D%20this.clone%28%29%3B%0A%20%20%20%20textureNode.depthNode%20%3D%20nodeObject%28depthNode%29%3B%0A%20%20%20%20textureNode.referenceNode%20%3D%20this.getSelf%28%29%3B%0A%20%20%20%20return%20nodeObject%28textureNode%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20--%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.value%20%3D%20this.value.toJSON%28data.meta%29.uuid%3B%0A%20%20%20%20data.sampler%20%3D%20this.sampler%3B%0A%20%20%20%20data.updateMatrix%20%3D%20this.updateMatrix%3B%0A%20%20%20%20data.updateType%20%3D%20this.updateType%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.value%20%3D%20data.meta.textures%5Bdata.value%5D%3B%0A%20%20%20%20this.sampler%20%3D%20data.sampler%3B%0A%20%20%20%20this.updateMatrix%20%3D%20data.updateMatrix%3B%0A%20%20%20%20this.updateType%20%3D%20data.updateType%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20this.value%3B%0A%20%20%20%20const%20matrixUniform%20%3D%20this._matrixUniform%3B%0A%20%20%20%20if%20%28matrixUniform%20%21%3D%3D%20null%29%20matrixUniform.value%20%3D%20texture2.matrix%3B%0A%20%20%20%20if%20%28texture2.matrixAutoUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20texture2.updateMatrix%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20const%20newNode%20%3D%20new%20this.constructor%28this.value%2C%20this.uvNode%2C%20this.levelNode%2C%20this.biasNode%29%3B%0A%20%20%20%20newNode.sampler%20%3D%20this.sampler%3B%0A%20%20%20%20return%20newNode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20texture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28TextureNode%29%3B%0Avar%20textureLoad%20%3D%20%28...params%29%20%3D%3E%20texture%28...params%29.setSampler%28false%29%3B%0Avar%20cameraNear%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20uniform%28%22float%22%29.label%28%22cameraNear%22%29.setGroup%28renderGroup%29.onRenderUpdate%28%28%7B%20camera%3A%20camera3%20%7D%29%20%3D%3E%20camera3.near%29%3B%0Avar%20cameraFar%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20uniform%28%22float%22%29.label%28%22cameraFar%22%29.setGroup%28renderGroup%29.onRenderUpdate%28%28%7B%20camera%3A%20camera3%20%7D%29%20%3D%3E%20camera3.far%29%3B%0Avar%20cameraProjectionMatrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20uniform%28%22mat4%22%29.label%28%22cameraProjectionMatrix%22%29.setGroup%28renderGroup%29.onRenderUpdate%28%28%7B%20camera%3A%20camera3%20%7D%29%20%3D%3E%20camera3.projectionMatrix%29%3B%0Avar%20cameraViewMatrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20uniform%28%22mat4%22%29.label%28%22cameraViewMatrix%22%29.setGroup%28renderGroup%29.onRenderUpdate%28%28%7B%20camera%3A%20camera3%20%7D%29%20%3D%3E%20camera3.matrixWorldInverse%29%3B%0Avar%20cameraPosition%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20uniform%28new%20Vector32%28%29%29.label%28%22cameraPosition%22%29.setGroup%28renderGroup%29.onRenderUpdate%28%28%7B%20camera%3A%20camera3%20%7D%2C%20self2%29%20%3D%3E%20self2.value.setFromMatrixPosition%28camera3.matrixWorld%29%29%3B%0Avar%20Object3DNode%20%3D%20class%20_Object3DNode%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22Object3DNode%22%3B%0A%20%20%7D%0A%20%20constructor%28scope%2C%20object3d%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.scope%20%3D%20scope%3B%0A%20%20%20%20this.object3d%20%3D%20object3d%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.OBJECT%3B%0A%20%20%20%20this._uniformNode%20%3D%20new%20UniformNode%28null%29%3B%0A%20%20%7D%0A%20%20getNodeType%28%29%20%7B%0A%20%20%20%20const%20scope%20%3D%20this.scope%3B%0A%20%20%20%20if%20%28scope%20%3D%3D%3D%20_Object3DNode.WORLD_MATRIX%29%20%7B%0A%20%20%20%20%20%20return%20%22mat4%22%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_Object3DNode.POSITION%20%7C%7C%20scope%20%3D%3D%3D%20_Object3DNode.VIEW_POSITION%20%7C%7C%20scope%20%3D%3D%3D%20_Object3DNode.DIRECTION%20%7C%7C%20scope%20%3D%3D%3D%20_Object3DNode.SCALE%29%20%7B%0A%20%20%20%20%20%20return%20%22vec3%22%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%28frame2%29%20%7B%0A%20%20%20%20const%20object%20%3D%20this.object3d%3B%0A%20%20%20%20const%20uniformNode%20%3D%20this._uniformNode%3B%0A%20%20%20%20const%20scope%20%3D%20this.scope%3B%0A%20%20%20%20if%20%28scope%20%3D%3D%3D%20_Object3DNode.WORLD_MATRIX%29%20%7B%0A%20%20%20%20%20%20uniformNode.value%20%3D%20object.matrixWorld%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_Object3DNode.POSITION%29%20%7B%0A%20%20%20%20%20%20uniformNode.value%20%3D%20uniformNode.value%20%7C%7C%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20uniformNode.value.setFromMatrixPosition%28object.matrixWorld%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_Object3DNode.SCALE%29%20%7B%0A%20%20%20%20%20%20uniformNode.value%20%3D%20uniformNode.value%20%7C%7C%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20uniformNode.value.setFromMatrixScale%28object.matrixWorld%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_Object3DNode.DIRECTION%29%20%7B%0A%20%20%20%20%20%20uniformNode.value%20%3D%20uniformNode.value%20%7C%7C%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20object.getWorldDirection%28uniformNode.value%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_Object3DNode.VIEW_POSITION%29%20%7B%0A%20%20%20%20%20%20const%20camera3%20%3D%20frame2.camera%3B%0A%20%20%20%20%20%20uniformNode.value%20%3D%20uniformNode.value%20%7C%7C%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20uniformNode.value.setFromMatrixPosition%28object.matrixWorld%29%3B%0A%20%20%20%20%20%20uniformNode.value.applyMatrix4%28camera3.matrixWorldInverse%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20scope%20%3D%20this.scope%3B%0A%20%20%20%20if%20%28scope%20%3D%3D%3D%20_Object3DNode.WORLD_MATRIX%29%20%7B%0A%20%20%20%20%20%20this._uniformNode.nodeType%20%3D%20%22mat4%22%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_Object3DNode.POSITION%20%7C%7C%20scope%20%3D%3D%3D%20_Object3DNode.VIEW_POSITION%20%7C%7C%20scope%20%3D%3D%3D%20_Object3DNode.DIRECTION%20%7C%7C%20scope%20%3D%3D%3D%20_Object3DNode.SCALE%29%20%7B%0A%20%20%20%20%20%20this._uniformNode.nodeType%20%3D%20%22vec3%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this._uniformNode.build%28builder%29%3B%0A%20%20%7D%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.scope%20%3D%20this.scope%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.scope%20%3D%20data.scope%3B%0A%20%20%7D%0A%7D%3B%0AObject3DNode.WORLD_MATRIX%20%3D%20%22worldMatrix%22%3B%0AObject3DNode.POSITION%20%3D%20%22position%22%3B%0AObject3DNode.SCALE%20%3D%20%22scale%22%3B%0AObject3DNode.VIEW_POSITION%20%3D%20%22viewPosition%22%3B%0AObject3DNode.DIRECTION%20%3D%20%22direction%22%3B%0Avar%20objectDirection%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28Object3DNode%2C%20Object3DNode.DIRECTION%29%3B%0Avar%20objectWorldMatrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28Object3DNode%2C%20Object3DNode.WORLD_MATRIX%29%3B%0Avar%20objectPosition%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28Object3DNode%2C%20Object3DNode.POSITION%29%3B%0Avar%20objectScale%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28Object3DNode%2C%20Object3DNode.SCALE%29%3B%0Avar%20objectViewPosition%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28Object3DNode%2C%20Object3DNode.VIEW_POSITION%29%3B%0Avar%20ModelNode%20%3D%20class%20extends%20Object3DNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ModelNode%22%3B%0A%20%20%7D%0A%20%20constructor%28scope%29%20%7B%0A%20%20%20%20super%28scope%29%3B%0A%20%20%7D%0A%20%20update%28frame2%29%20%7B%0A%20%20%20%20this.object3d%20%3D%20frame2.object%3B%0A%20%20%20%20super.update%28frame2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20modelDirection%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ModelNode%2C%20ModelNode.DIRECTION%29%3B%0Avar%20modelWorldMatrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ModelNode%2C%20ModelNode.WORLD_MATRIX%29%3B%0Avar%20modelPosition%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ModelNode%2C%20ModelNode.POSITION%29%3B%0Avar%20modelScale%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ModelNode%2C%20ModelNode.SCALE%29%3B%0Avar%20modelViewPosition%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ModelNode%2C%20ModelNode.VIEW_POSITION%29%3B%0Avar%20modelNormalMatrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20uniform%28new%20Matrix32%28%29%29.onObjectUpdate%28%28%7B%20object%20%7D%2C%20self2%29%20%3D%3E%20self2.value.getNormalMatrix%28object.matrixWorld%29%29%3B%0Avar%20modelViewMatrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20cameraViewMatrix.mul%28modelWorldMatrix%29.toVar%28%22modelViewMatrix%22%29%3B%0Avar%20positionGeometry%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20attribute%28%22position%22%2C%20%22vec3%22%29%3B%0Avar%20positionLocal%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20positionGeometry.varying%28%22positionLocal%22%29%3B%0Avar%20positionPrevious%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20positionGeometry.varying%28%22positionPrevious%22%29%3B%0Avar%20positionWorld%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20modelWorldMatrix.mul%28positionLocal%29.xyz.varying%28%22v_positionWorld%22%29%3B%0Avar%20positionWorldDirection%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20positionLocal.transformDirection%28modelWorldMatrix%29.varying%28%22v_positionWorldDirection%22%29.normalize%28%29.toVar%28%22positionWorldDirection%22%29%3B%0Avar%20positionView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20modelViewMatrix.mul%28positionLocal%29.xyz.varying%28%22v_positionView%22%29%3B%0Avar%20positionViewDirection%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20positionView.negate%28%29.varying%28%22v_positionViewDirection%22%29.normalize%28%29.toVar%28%22positionViewDirection%22%29%3B%0Avar%20FrontFacingNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22FrontFacingNode%22%3B%0A%20%20%7D%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%22bool%22%29%3B%0A%20%20%20%20this.isFrontFacingNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20renderer%3A%20renderer3%2C%20material%20%7D%20%3D%20builder%3B%0A%20%20%20%20if%20%28renderer3.coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20if%20%28material.side%20%3D%3D%3D%20BackSide2%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%22false%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20builder.getFrontFacing%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20frontFacing%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28FrontFacingNode%29%3B%0Avar%20faceDirection%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%28frontFacing%29.mul%282%29.sub%281%29%3B%0Avar%20normalGeometry%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20attribute%28%22normal%22%2C%20%22vec3%22%29%3B%0Avar%20normalLocal%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28builder%29%20%3D%3E%20%7B%0A%20%20if%20%28builder.geometry.hasAttribute%28%22normal%22%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20console.warn%28%27TSL.NormalNode%3A%20Vertex%20attribute%20%22normal%22%20not%20found%20on%20geometry.%27%29%3B%0A%20%20%20%20return%20vec3%280%2C%201%2C%200%29%3B%0A%20%20%7D%0A%20%20return%20normalGeometry%3B%0A%7D%2C%20%22vec3%22%29.once%28%29%28%29.toVar%28%22normalLocal%22%29%3B%0Avar%20normalFlat%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20positionView.dFdx%28%29.cross%28positionView.dFdy%28%29%29.normalize%28%29.toVar%28%22normalFlat%22%29%3B%0Avar%20normalView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28builder%29%20%3D%3E%20%7B%0A%20%20let%20node%3B%0A%20%20if%20%28builder.material.flatShading%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20node%20%3D%20normalFlat%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20node%20%3D%20varying%28transformNormalToView%28normalLocal%29%2C%20%22v_normalView%22%29.normalize%28%29%3B%0A%20%20%7D%0A%20%20return%20node%3B%0A%7D%2C%20%22vec3%22%29.once%28%29%28%29.toVar%28%22normalView%22%29%3B%0Avar%20normalWorld%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20varying%28normalView.transformDirection%28cameraViewMatrix%29%2C%20%22v_normalWorld%22%29.normalize%28%29.toVar%28%22normalWorld%22%29%3B%0Avar%20transformedNormalView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28builder%29%20%3D%3E%20%7B%0A%20%20return%20builder.context.setupNormal%28%29%3B%0A%7D%2C%20%22vec3%22%29.once%28%29%28%29.mul%28faceDirection%29.toVar%28%22transformedNormalView%22%29%3B%0Avar%20transformedNormalWorld%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20transformedNormalView.transformDirection%28cameraViewMatrix%29.toVar%28%22transformedNormalWorld%22%29%3B%0Avar%20transformedClearcoatNormalView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28builder%29%20%3D%3E%20%7B%0A%20%20return%20builder.context.setupClearcoatNormal%28%29%3B%0A%7D%2C%20%22vec3%22%29.once%28%29%28%29.mul%28faceDirection%29.toVar%28%22transformedClearcoatNormalView%22%29%3B%0Avar%20transformNormal%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bnormal2%2C%20matrix%20%3D%20modelWorldMatrix%5D%29%20%3D%3E%20%7B%0A%20%20const%20m2%20%3D%20mat3%28matrix%29%3B%0A%20%20const%20transformedNormal%20%3D%20normal2.div%28vec3%28m2%5B0%5D.dot%28m2%5B0%5D%29%2C%20m2%5B1%5D.dot%28m2%5B1%5D%29%2C%20m2%5B2%5D.dot%28m2%5B2%5D%29%29%29%3B%0A%20%20return%20m2.mul%28transformedNormal%29.xyz%3B%0A%7D%29%3B%0Avar%20transformNormalToView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bnormal2%5D%2C%20builder%29%20%3D%3E%20%7B%0A%20%20const%20modelNormalViewMatrix%20%3D%20builder.renderer.nodes.modelNormalViewMatrix%3B%0A%20%20if%20%28modelNormalViewMatrix%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20return%20modelNormalViewMatrix.transformDirection%28normal2%29%3B%0A%20%20%7D%0A%20%20const%20transformedNormal%20%3D%20modelNormalMatrix.mul%28normal2%29%3B%0A%20%20return%20cameraViewMatrix.transformDirection%28transformedNormal%29%3B%0A%7D%29%3B%0Avar%20materialRefractionRatio%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20uniform%280%29.onReference%28%28%7B%20material%20%7D%29%20%3D%3E%20material%29.onRenderUpdate%28%28%7B%20material%20%7D%29%20%3D%3E%20material.refractionRatio%29%3B%0Avar%20reflectView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20positionViewDirection.negate%28%29.reflect%28transformedNormalView%29%3B%0Avar%20refractView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20positionViewDirection.negate%28%29.refract%28transformedNormalView%2C%20materialRefractionRatio%29%3B%0Avar%20reflectVector%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20reflectView.transformDirection%28cameraViewMatrix%29.toVar%28%22reflectVector%22%29%3B%0Avar%20refractVector%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20refractView.transformDirection%28cameraViewMatrix%29.toVar%28%22reflectVector%22%29%3B%0Avar%20CubeTextureNode%20%3D%20class%20extends%20TextureNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22CubeTextureNode%22%3B%0A%20%20%7D%0A%20%20constructor%28value%2C%20uvNode%20%3D%20null%2C%20levelNode%20%3D%20null%2C%20biasNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28value%2C%20uvNode%2C%20levelNode%2C%20biasNode%29%3B%0A%20%20%20%20this.isCubeTextureNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getInputType%28%29%20%7B%0A%20%20%20%20return%20%22cubeTexture%22%3B%0A%20%20%7D%0A%20%20getDefaultUV%28%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20this.value%3B%0A%20%20%20%20if%20%28texture2.mapping%20%3D%3D%3D%20CubeReflectionMapping2%29%20%7B%0A%20%20%20%20%20%20return%20reflectVector%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.mapping%20%3D%3D%3D%20CubeRefractionMapping2%29%20%7B%0A%20%20%20%20%20%20return%20refractVector%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%27THREE.CubeTextureNode%3A%20Mapping%20%22%25s%22%20not%20supported.%27%2C%20texture2.mapping%29%3B%0A%20%20%20%20%20%20return%20vec3%280%2C%200%2C%200%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setUpdateMatrix%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20Ignore%20.updateMatrix%20for%20CubeTextureNode%0A%20%20setupUV%28builder%2C%20uvNode%29%20%7B%0A%20%20%20%20const%20texture2%20%3D%20this.value%3B%0A%20%20%20%20if%20%28builder.renderer.coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem2%20%7C%7C%20%21texture2.isRenderTargetTexture%29%20%7B%0A%20%20%20%20%20%20return%20vec3%28uvNode.x.negate%28%29%2C%20uvNode.yz%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20uvNode%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generateUV%28builder%2C%20cubeUV%29%20%7B%0A%20%20%20%20return%20cubeUV.build%28builder%2C%20%22vec3%22%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20cubeTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28CubeTextureNode%29%3B%0Avar%20BufferNode%20%3D%20class%20extends%20UniformNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22BufferNode%22%3B%0A%20%20%7D%0A%20%20constructor%28value%2C%20bufferType%2C%20bufferCount%20%3D%200%29%20%7B%0A%20%20%20%20super%28value%2C%20bufferType%29%3B%0A%20%20%20%20this.isBufferNode%20%3D%20true%3B%0A%20%20%20%20this.bufferType%20%3D%20bufferType%3B%0A%20%20%20%20this.bufferCount%20%3D%20bufferCount%3B%0A%20%20%7D%0A%20%20getElementType%28builder%29%20%7B%0A%20%20%20%20return%20this.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20getInputType%28%29%20%7B%0A%20%20%20%20return%20%22buffer%22%3B%0A%20%20%7D%0A%7D%3B%0Avar%20buffer%20%3D%20%28value%2C%20type%2C%20count%29%20%3D%3E%20nodeObject%28new%20BufferNode%28value%2C%20type%2C%20count%29%29%3B%0Avar%20UniformArrayElementNode%20%3D%20class%20extends%20ArrayElementNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22UniformArrayElementNode%22%3B%0A%20%20%7D%0A%20%20constructor%28arrayBuffer%2C%20indexNode%29%20%7B%0A%20%20%20%20super%28arrayBuffer%2C%20indexNode%29%3B%0A%20%20%20%20this.isArrayBufferElementNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20snippet%20%3D%20super.generate%28builder%29%3B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28%29%3B%0A%20%20%20%20return%20builder.format%28snippet%2C%20%22vec4%22%2C%20type%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20UniformArrayNode%20%3D%20class%20extends%20BufferNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22UniformArrayNode%22%3B%0A%20%20%7D%0A%20%20constructor%28value%2C%20elementType%20%3D%20null%29%20%7B%0A%20%20%20%20super%28null%2C%20%22vec4%22%29%3B%0A%20%20%20%20this.array%20%3D%20value%3B%0A%20%20%20%20this.elementType%20%3D%20elementType%3B%0A%20%20%20%20this._elementType%20%3D%20null%3B%0A%20%20%20%20this._elementLength%20%3D%200%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.RENDER%3B%0A%20%20%20%20this.isArrayBufferNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getElementType%28%29%20%7B%0A%20%20%20%20return%20this.elementType%20%7C%7C%20this._elementType%3B%0A%20%20%7D%0A%20%20getElementLength%28%29%20%7B%0A%20%20%20%20return%20this._elementLength%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20const%20%7B%20array%2C%20value%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20elementLength%20%3D%20this.getElementLength%28%29%3B%0A%20%20%20%20const%20elementType%20%3D%20this.getElementType%28%29%3B%0A%20%20%20%20if%20%28elementLength%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20array.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20index5%20%3D%20i%20%2A%204%3B%0A%20%20%20%20%20%20%20%20value%5Bindex5%5D%20%3D%20array%5Bi%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28elementType%20%3D%3D%3D%20%22color%22%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20array.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20index5%20%3D%20i%20%2A%204%3B%0A%20%20%20%20%20%20%20%20const%20vector%20%3D%20array%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20value%5Bindex5%5D%20%3D%20vector.r%3B%0A%20%20%20%20%20%20%20%20value%5Bindex5%20%2B%201%5D%20%3D%20vector.g%3B%0A%20%20%20%20%20%20%20%20value%5Bindex5%20%2B%202%5D%20%3D%20vector.b%20%7C%7C%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20array.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20index5%20%3D%20i%20%2A%204%3B%0A%20%20%20%20%20%20%20%20const%20vector%20%3D%20array%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20value%5Bindex5%5D%20%3D%20vector.x%3B%0A%20%20%20%20%20%20%20%20value%5Bindex5%20%2B%201%5D%20%3D%20vector.y%3B%0A%20%20%20%20%20%20%20%20value%5Bindex5%20%2B%202%5D%20%3D%20vector.z%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20value%5Bindex5%20%2B%203%5D%20%3D%20vector.w%20%7C%7C%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20length2%20%3D%20this.array.length%3B%0A%20%20%20%20this._elementType%20%3D%20this.elementType%20%3D%3D%3D%20null%20%3F%20getValueType%28this.array%5B0%5D%29%20%3A%20this.elementType%3B%0A%20%20%20%20this._elementLength%20%3D%20builder.getTypeLength%28this._elementType%29%3B%0A%20%20%20%20let%20arrayType%20%3D%20Float32Array%3B%0A%20%20%20%20if%20%28this._elementType.charAt%280%29%20%3D%3D%3D%20%22i%22%29%20arrayType%20%3D%20Int32Array%3B%0A%20%20%20%20else%20if%20%28this._elementType.charAt%280%29%20%3D%3D%3D%20%22u%22%29%20arrayType%20%3D%20Uint32Array%3B%0A%20%20%20%20this.value%20%3D%20new%20arrayType%28length2%20%2A%204%29%3B%0A%20%20%20%20this.bufferCount%20%3D%20length2%3B%0A%20%20%20%20this.bufferType%20%3D%20builder.changeComponentType%28%22vec4%22%2C%20builder.getComponentType%28this._elementType%29%29%3B%0A%20%20%20%20return%20super.setup%28builder%29%3B%0A%20%20%7D%0A%20%20element%28indexNode%29%20%7B%0A%20%20%20%20return%20nodeObject%28new%20UniformArrayElementNode%28this%2C%20nodeObject%28indexNode%29%29%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20uniformArray%20%3D%20%28values%2C%20nodeType%29%20%3D%3E%20nodeObject%28new%20UniformArrayNode%28values%2C%20nodeType%29%29%3B%0Avar%20ReferenceElementNode2%20%3D%20class%20extends%20ArrayElementNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ReferenceElementNode%22%3B%0A%20%20%7D%0A%20%20constructor%28referenceNode%2C%20indexNode%29%20%7B%0A%20%20%20%20super%28referenceNode%2C%20indexNode%29%3B%0A%20%20%20%20this.referenceNode%20%3D%20referenceNode%3B%0A%20%20%20%20this.isReferenceElementNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getNodeType%28%29%20%7B%0A%20%20%20%20return%20this.referenceNode.uniformType%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20snippet%20%3D%20super.generate%28builder%29%3B%0A%20%20%20%20const%20arrayType%20%3D%20this.referenceNode.getNodeType%28%29%3B%0A%20%20%20%20const%20elementType%20%3D%20this.getNodeType%28%29%3B%0A%20%20%20%20return%20builder.format%28snippet%2C%20arrayType%2C%20elementType%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ReferenceNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ReferenceNode%22%3B%0A%20%20%7D%0A%20%20constructor%28property2%2C%20uniformType%2C%20object%20%3D%20null%2C%20count%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.property%20%3D%20property2%3B%0A%20%20%20%20this.uniformType%20%3D%20uniformType%3B%0A%20%20%20%20this.object%20%3D%20object%3B%0A%20%20%20%20this.count%20%3D%20count%3B%0A%20%20%20%20this.properties%20%3D%20property2.split%28%22.%22%29%3B%0A%20%20%20%20this.reference%20%3D%20object%3B%0A%20%20%20%20this.node%20%3D%20null%3B%0A%20%20%20%20this.group%20%3D%20null%3B%0A%20%20%20%20this.name%20%3D%20null%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.OBJECT%3B%0A%20%20%7D%0A%20%20element%28indexNode%29%20%7B%0A%20%20%20%20return%20nodeObject%28new%20ReferenceElementNode2%28this%2C%20nodeObject%28indexNode%29%29%29%3B%0A%20%20%7D%0A%20%20setGroup%28group%29%20%7B%0A%20%20%20%20this.group%20%3D%20group%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20label%28name%29%20%7B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20setNodeType%28uniformType%29%20%7B%0A%20%20%20%20let%20node%20%3D%20null%3B%0A%20%20%20%20if%20%28this.count%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20buffer%28null%2C%20uniformType%2C%20this.count%29%3B%0A%20%20%20%20%7D%20else%20if%20%28Array.isArray%28this.getValueFromReference%28%29%29%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20uniformArray%28null%2C%20uniformType%29%3B%0A%20%20%20%20%7D%20else%20if%20%28uniformType%20%3D%3D%3D%20%22texture%22%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20texture%28null%29%3B%0A%20%20%20%20%7D%20else%20if%20%28uniformType%20%3D%3D%3D%20%22cubeTexture%22%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20cubeTexture%28null%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20node%20%3D%20uniform%28null%2C%20uniformType%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.group%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20node.setGroup%28this.group%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.name%20%21%3D%3D%20null%29%20node.label%28this.name%29%3B%0A%20%20%20%20this.node%20%3D%20node.getSelf%28%29%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20if%20%28this.node%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.updateReference%28builder%29%3B%0A%20%20%20%20%20%20this.updateValue%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.node.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20getValueFromReference%28object%20%3D%20this.reference%29%20%7B%0A%20%20%20%20const%20%7B%20properties%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20value%20%3D%20object%5Bproperties%5B0%5D%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%20properties.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20value%20%3D%20value%5Bproperties%5Bi%5D%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20value%3B%0A%20%20%7D%0A%20%20updateReference%28state%29%20%7B%0A%20%20%20%20this.reference%20%3D%20this.object%20%21%3D%3D%20null%20%3F%20this.object%20%3A%20state.object%3B%0A%20%20%20%20return%20this.reference%3B%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20this.updateValue%28%29%3B%0A%20%20%20%20return%20this.node%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20this.updateValue%28%29%3B%0A%20%20%7D%0A%20%20updateValue%28%29%20%7B%0A%20%20%20%20if%20%28this.node%20%3D%3D%3D%20null%29%20this.setNodeType%28this.uniformType%29%3B%0A%20%20%20%20const%20value%20%3D%20this.getValueFromReference%28%29%3B%0A%20%20%20%20if%20%28Array.isArray%28value%29%29%20%7B%0A%20%20%20%20%20%20this.node.array%20%3D%20value%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.node.value%20%3D%20value%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20reference%20%3D%20%28name%2C%20type%2C%20object%29%20%3D%3E%20nodeObject%28new%20ReferenceNode%28name%2C%20type%2C%20object%29%29%3B%0Avar%20referenceBuffer%20%3D%20%28name%2C%20type%2C%20count%2C%20object%29%20%3D%3E%20nodeObject%28new%20ReferenceNode%28name%2C%20type%2C%20object%2C%20count%29%29%3B%0Avar%20MaterialReferenceNode%20%3D%20class%20extends%20ReferenceNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MaterialReferenceNode%22%3B%0A%20%20%7D%0A%20%20constructor%28property2%2C%20inputType%2C%20material%20%3D%20null%29%20%7B%0A%20%20%20%20super%28property2%2C%20inputType%2C%20material%29%3B%0A%20%20%20%20this.material%20%3D%20material%3B%0A%20%20%20%20this.isMaterialReferenceNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20%2F%2AsetNodeType%28%20node%20%29%20%7B%0A%20%20%0A%20%20%09%09super.setNodeType%28%20node%20%29%3B%0A%20%20%0A%20%20%09%09this.node.groupNode%20%3D%20renderGroup%3B%0A%20%20%0A%20%20%09%7D%2A%2F%0A%20%20updateReference%28state%29%20%7B%0A%20%20%20%20this.reference%20%3D%20this.material%20%21%3D%3D%20null%20%3F%20this.material%20%3A%20state.material%3B%0A%20%20%20%20return%20this.reference%3B%0A%20%20%7D%0A%7D%3B%0Avar%20materialReference%20%3D%20%28name%2C%20type%2C%20material%29%20%3D%3E%20nodeObject%28new%20MaterialReferenceNode%28name%2C%20type%2C%20material%29%29%3B%0Avar%20tangentGeometry%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28builder%29%20%3D%3E%20%7B%0A%20%20if%20%28builder.geometry.hasAttribute%28%22tangent%22%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20builder.geometry.computeTangents%28%29%3B%0A%20%20%7D%0A%20%20return%20attribute%28%22tangent%22%2C%20%22vec4%22%29%3B%0A%7D%29%28%29%3B%0Avar%20tangentLocal%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20tangentGeometry.xyz.toVar%28%22tangentLocal%22%29%3B%0Avar%20tangentView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20modelViewMatrix.mul%28vec4%28tangentLocal%2C%200%29%29.xyz.varying%28%22v_tangentView%22%29.normalize%28%29.toVar%28%22tangentView%22%29%3B%0Avar%20getBitangent%20%3D%20%28crossNormalTangent%29%20%3D%3E%20crossNormalTangent.mul%28tangentGeometry.w%29.xyz%3B%0Avar%20bitangentView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20varying%28getBitangent%28normalView.cross%28tangentView%29%29%2C%20%22v_bitangentView%22%29.normalize%28%29.toVar%28%22bitangentView%22%29%3B%0Avar%20TBNViewMatrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20mat3%28tangentView%2C%20bitangentView%2C%20normalView%29%3B%0Avar%20transformedBentNormalView%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20%28%28%29%20%3D%3E%20%7B%0A%20%20let%20bentNormal%20%3D%20anisotropyB.cross%28positionViewDirection%29%3B%0A%20%20bentNormal%20%3D%20bentNormal.cross%28anisotropyB%29.normalize%28%29%3B%0A%20%20bentNormal%20%3D%20mix%28bentNormal%2C%20transformedNormalView%2C%20anisotropy.mul%28roughness.oneMinus%28%29%29.oneMinus%28%29.pow2%28%29.pow2%28%29%29.normalize%28%29%3B%0A%20%20return%20bentNormal%3B%0A%7D%29%28%29%3B%0Avar%20perturbNormal2Arb%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28inputs%29%20%3D%3E%20%7B%0A%20%20const%20%7B%20eye_pos%2C%20surf_norm%2C%20mapN%2C%20uv%3A%20uv2%20%7D%20%3D%20inputs%3B%0A%20%20const%20q0%20%3D%20eye_pos.dFdx%28%29%3B%0A%20%20const%20q1%20%3D%20eye_pos.dFdy%28%29%3B%0A%20%20const%20st0%20%3D%20uv2.dFdx%28%29%3B%0A%20%20const%20st1%20%3D%20uv2.dFdy%28%29%3B%0A%20%20const%20N%20%3D%20surf_norm%3B%0A%20%20const%20q1perp%20%3D%20q1.cross%28N%29%3B%0A%20%20const%20q0perp%20%3D%20N.cross%28q0%29%3B%0A%20%20const%20T%20%3D%20q1perp.mul%28st0.x%29.add%28q0perp.mul%28st1.x%29%29%3B%0A%20%20const%20B%20%3D%20q1perp.mul%28st0.y%29.add%28q0perp.mul%28st1.y%29%29%3B%0A%20%20const%20det%20%3D%20T.dot%28T%29.max%28B.dot%28B%29%29%3B%0A%20%20const%20scale%20%3D%20faceDirection.mul%28det.inverseSqrt%28%29%29%3B%0A%20%20return%20add4%28T.mul%28mapN.x%2C%20scale%29%2C%20B.mul%28mapN.y%2C%20scale%29%2C%20N.mul%28mapN.z%29%29.normalize%28%29%3B%0A%7D%29%3B%0Avar%20NormalMapNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22NormalMapNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%2C%20scaleNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%22vec3%22%29%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%20%20this.scaleNode%20%3D%20scaleNode%3B%0A%20%20%20%20this.normalMapType%20%3D%20TangentSpaceNormalMap2%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20normalMapType%2C%20scaleNode%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20normalMap2%20%3D%20this.node.mul%282%29.sub%281%29%3B%0A%20%20%20%20if%20%28scaleNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20normalMap2%20%3D%20vec3%28normalMap2.xy.mul%28scaleNode%29%2C%20normalMap2.z%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20outputNode%20%3D%20null%3B%0A%20%20%20%20if%20%28normalMapType%20%3D%3D%3D%20ObjectSpaceNormalMap2%29%20%7B%0A%20%20%20%20%20%20outputNode%20%3D%20transformNormalToView%28normalMap2%29%3B%0A%20%20%20%20%7D%20else%20if%20%28normalMapType%20%3D%3D%3D%20TangentSpaceNormalMap2%29%20%7B%0A%20%20%20%20%20%20const%20tangent%20%3D%20builder.hasGeometryAttribute%28%22tangent%22%29%3B%0A%20%20%20%20%20%20if%20%28tangent%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20outputNode%20%3D%20TBNViewMatrix.mul%28normalMap2%29.normalize%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20outputNode%20%3D%20perturbNormal2Arb%28%7B%0A%20%20%20%20%20%20%20%20%20%20eye_pos%3A%20positionView%2C%0A%20%20%20%20%20%20%20%20%20%20surf_norm%3A%20normalView%2C%0A%20%20%20%20%20%20%20%20%20%20mapN%3A%20normalMap2%2C%0A%20%20%20%20%20%20%20%20%20%20uv%3A%20uv%28%29%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20outputNode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20normalMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28NormalMapNode%29%3B%0Avar%20dHdxy_fwd%20%3D%20Fn%28%28%7B%20textureNode%2C%20bumpScale%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20sampleTexture%20%3D%20%28callback%29%20%3D%3E%20textureNode.cache%28%29.context%28%7B%20getUV%3A%20%28texNode%29%20%3D%3E%20callback%28texNode.uvNode%20%7C%7C%20uv%28%29%29%2C%20forceUVContext%3A%20true%20%7D%29%3B%0A%20%20const%20Hll%20%3D%20float%28sampleTexture%28%28uvNode%29%20%3D%3E%20uvNode%29%29%3B%0A%20%20return%20vec2%28%0A%20%20%20%20float%28sampleTexture%28%28uvNode%29%20%3D%3E%20uvNode.add%28uvNode.dFdx%28%29%29%29%29.sub%28Hll%29%2C%0A%20%20%20%20float%28sampleTexture%28%28uvNode%29%20%3D%3E%20uvNode.add%28uvNode.dFdy%28%29%29%29%29.sub%28Hll%29%0A%20%20%29.mul%28bumpScale%29%3B%0A%7D%29%3B%0Avar%20perturbNormalArb%20%3D%20Fn%28%28inputs%29%20%3D%3E%20%7B%0A%20%20const%20%7B%20surf_pos%2C%20surf_norm%2C%20dHdxy%20%7D%20%3D%20inputs%3B%0A%20%20const%20vSigmaX%20%3D%20surf_pos.dFdx%28%29.normalize%28%29%3B%0A%20%20const%20vSigmaY%20%3D%20surf_pos.dFdy%28%29.normalize%28%29%3B%0A%20%20const%20vN%20%3D%20surf_norm%3B%0A%20%20const%20R1%20%3D%20vSigmaY.cross%28vN%29%3B%0A%20%20const%20R2%20%3D%20vN.cross%28vSigmaX%29%3B%0A%20%20const%20fDet%20%3D%20vSigmaX.dot%28R1%29.mul%28faceDirection%29%3B%0A%20%20const%20vGrad%20%3D%20fDet.sign%28%29.mul%28dHdxy.x.mul%28R1%29.add%28dHdxy.y.mul%28R2%29%29%29%3B%0A%20%20return%20fDet.abs%28%29.mul%28surf_norm%29.sub%28vGrad%29.normalize%28%29%3B%0A%7D%29%3B%0Avar%20BumpMapNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22BumpMapNode%22%3B%0A%20%20%7D%0A%20%20constructor%28textureNode%2C%20scaleNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%22vec3%22%29%3B%0A%20%20%20%20this.textureNode%20%3D%20textureNode%3B%0A%20%20%20%20this.scaleNode%20%3D%20scaleNode%3B%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20const%20bumpScale%20%3D%20this.scaleNode%20%21%3D%3D%20null%20%3F%20this.scaleNode%20%3A%201%3B%0A%20%20%20%20const%20dHdxy%20%3D%20dHdxy_fwd%28%7B%20textureNode%3A%20this.textureNode%2C%20bumpScale%20%7D%29%3B%0A%20%20%20%20return%20perturbNormalArb%28%7B%0A%20%20%20%20%20%20surf_pos%3A%20positionView%2C%0A%20%20%20%20%20%20surf_norm%3A%20normalView%2C%0A%20%20%20%20%20%20dHdxy%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20bumpMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28BumpMapNode%29%3B%0Avar%20_propertyCache%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0Avar%20MaterialNode%20%3D%20class%20_MaterialNode%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MaterialNode%22%3B%0A%20%20%7D%0A%20%20constructor%28scope%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.scope%20%3D%20scope%3B%0A%20%20%7D%0A%20%20getCache%28property2%2C%20type%29%20%7B%0A%20%20%20%20let%20node%20%3D%20_propertyCache.get%28property2%29%3B%0A%20%20%20%20if%20%28node%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20materialReference%28property2%2C%20type%29%3B%0A%20%20%20%20%20%20_propertyCache.set%28property2%2C%20node%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%20%20getFloat%28property2%29%20%7B%0A%20%20%20%20return%20this.getCache%28property2%2C%20%22float%22%29%3B%0A%20%20%7D%0A%20%20getColor%28property2%29%20%7B%0A%20%20%20%20return%20this.getCache%28property2%2C%20%22color%22%29%3B%0A%20%20%7D%0A%20%20getTexture%28property2%29%20%7B%0A%20%20%20%20return%20this.getCache%28property2%20%3D%3D%3D%20%22map%22%20%3F%20%22map%22%20%3A%20property2%20%2B%20%22Map%22%2C%20%22texture%22%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20material%20%3D%20builder.context.material%3B%0A%20%20%20%20const%20scope%20%3D%20this.scope%3B%0A%20%20%20%20let%20node%20%3D%20null%3B%0A%20%20%20%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.COLOR%29%20%7B%0A%20%20%20%20%20%20const%20colorNode%20%3D%20material.color%20%21%3D%3D%20void%200%20%3F%20this.getColor%28scope%29%20%3A%20vec3%28%29%3B%0A%20%20%20%20%20%20if%20%28material.map%20%26%26%20material.map.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20colorNode.mul%28this.getTexture%28%22map%22%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20colorNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.OPACITY%29%20%7B%0A%20%20%20%20%20%20const%20opacityNode%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.alphaMap%20%26%26%20material.alphaMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20opacityNode.mul%28this.getTexture%28%22alpha%22%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20opacityNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.SPECULAR_STRENGTH%29%20%7B%0A%20%20%20%20%20%20if%20%28material.specularMap%20%26%26%20material.specularMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20this.getTexture%28%22specular%22%29.r%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20float%281%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.SPECULAR_INTENSITY%29%20%7B%0A%20%20%20%20%20%20const%20specularIntensity%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.specularMap%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20specularIntensity.mul%28this.getTexture%28scope%29.a%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20specularIntensity%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.SPECULAR_COLOR%29%20%7B%0A%20%20%20%20%20%20const%20specularColorNode%20%3D%20this.getColor%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.specularColorMap%20%26%26%20material.specularColorMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20specularColorNode.mul%28this.getTexture%28scope%29.rgb%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20specularColorNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.ROUGHNESS%29%20%7B%0A%20%20%20%20%20%20const%20roughnessNode%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.roughnessMap%20%26%26%20material.roughnessMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20roughnessNode.mul%28this.getTexture%28scope%29.g%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20roughnessNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.METALNESS%29%20%7B%0A%20%20%20%20%20%20const%20metalnessNode%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.metalnessMap%20%26%26%20material.metalnessMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20metalnessNode.mul%28this.getTexture%28scope%29.b%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20metalnessNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.EMISSIVE%29%20%7B%0A%20%20%20%20%20%20const%20emissiveIntensityNode%20%3D%20this.getFloat%28%22emissiveIntensity%22%29%3B%0A%20%20%20%20%20%20const%20emissiveNode%20%3D%20this.getColor%28scope%29.mul%28emissiveIntensityNode%29%3B%0A%20%20%20%20%20%20if%20%28material.emissiveMap%20%26%26%20material.emissiveMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20emissiveNode.mul%28this.getTexture%28scope%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20emissiveNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.NORMAL%29%20%7B%0A%20%20%20%20%20%20if%20%28material.normalMap%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20normalMap%28this.getTexture%28%22normal%22%29%2C%20this.getCache%28%22normalScale%22%2C%20%22vec2%22%29%29%3B%0A%20%20%20%20%20%20%20%20node.normalMapType%20%3D%20material.normalMapType%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28material.bumpMap%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20bumpMap%28this.getTexture%28%22bump%22%29.r%2C%20this.getFloat%28%22bumpScale%22%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20normalView%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.CLEARCOAT%29%20%7B%0A%20%20%20%20%20%20const%20clearcoatNode%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.clearcoatMap%20%26%26%20material.clearcoatMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20clearcoatNode.mul%28this.getTexture%28scope%29.r%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20clearcoatNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.CLEARCOAT_ROUGHNESS%29%20%7B%0A%20%20%20%20%20%20const%20clearcoatRoughnessNode%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.clearcoatRoughnessMap%20%26%26%20material.clearcoatRoughnessMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20clearcoatRoughnessNode.mul%28this.getTexture%28scope%29.r%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20clearcoatRoughnessNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.CLEARCOAT_NORMAL%29%20%7B%0A%20%20%20%20%20%20if%20%28material.clearcoatNormalMap%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20normalMap%28this.getTexture%28scope%29%2C%20this.getCache%28scope%20%2B%20%22Scale%22%2C%20%22vec2%22%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20normalView%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.SHEEN%29%20%7B%0A%20%20%20%20%20%20const%20sheenNode%20%3D%20this.getColor%28%22sheenColor%22%29.mul%28this.getFloat%28%22sheen%22%29%29%3B%0A%20%20%20%20%20%20if%20%28material.sheenColorMap%20%26%26%20material.sheenColorMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20sheenNode.mul%28this.getTexture%28%22sheenColor%22%29.rgb%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20sheenNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.SHEEN_ROUGHNESS%29%20%7B%0A%20%20%20%20%20%20const%20sheenRoughnessNode%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.sheenRoughnessMap%20%26%26%20material.sheenRoughnessMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20sheenRoughnessNode.mul%28this.getTexture%28scope%29.a%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20sheenRoughnessNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20node%20%3D%20node.clamp%280.07%2C%201%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.ANISOTROPY%29%20%7B%0A%20%20%20%20%20%20if%20%28material.anisotropyMap%20%26%26%20material.anisotropyMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20const%20anisotropyPolar%20%3D%20this.getTexture%28scope%29%3B%0A%20%20%20%20%20%20%20%20const%20anisotropyMat%20%3D%20mat2%28materialAnisotropyVector.x%2C%20materialAnisotropyVector.y%2C%20materialAnisotropyVector.y.negate%28%29%2C%20materialAnisotropyVector.x%29%3B%0A%20%20%20%20%20%20%20%20node%20%3D%20anisotropyMat.mul%28anisotropyPolar.rg.mul%282%29.sub%28vec2%281%29%29.normalize%28%29.mul%28anisotropyPolar.b%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20materialAnisotropyVector%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.IRIDESCENCE_THICKNESS%29%20%7B%0A%20%20%20%20%20%20const%20iridescenceThicknessMaximum%20%3D%20reference%28%221%22%2C%20%22float%22%2C%20material.iridescenceThicknessRange%29%3B%0A%20%20%20%20%20%20if%20%28material.iridescenceThicknessMap%29%20%7B%0A%20%20%20%20%20%20%20%20const%20iridescenceThicknessMinimum%20%3D%20reference%28%220%22%2C%20%22float%22%2C%20material.iridescenceThicknessRange%29%3B%0A%20%20%20%20%20%20%20%20node%20%3D%20iridescenceThicknessMaximum.sub%28iridescenceThicknessMinimum%29.mul%28this.getTexture%28scope%29.g%29.add%28iridescenceThicknessMinimum%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20iridescenceThicknessMaximum%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.TRANSMISSION%29%20%7B%0A%20%20%20%20%20%20const%20transmissionNode%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.transmissionMap%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20transmissionNode.mul%28this.getTexture%28scope%29.r%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20transmissionNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.THICKNESS%29%20%7B%0A%20%20%20%20%20%20const%20thicknessNode%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%20%20if%20%28material.thicknessMap%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20thicknessNode.mul%28this.getTexture%28scope%29.g%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20thicknessNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.IOR%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20this.getFloat%28scope%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.LIGHT_MAP%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20this.getTexture%28scope%29.rgb.mul%28this.getFloat%28%22lightMapIntensity%22%29%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_MaterialNode.AO_MAP%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20this.getTexture%28scope%29.r.sub%281%29.mul%28this.getFloat%28%22aoMapIntensity%22%29%29.add%281%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20outputType%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20%20%20node%20%3D%20this.getCache%28scope%2C%20outputType%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%7D%3B%0AMaterialNode.ALPHA_TEST%20%3D%20%22alphaTest%22%3B%0AMaterialNode.COLOR%20%3D%20%22color%22%3B%0AMaterialNode.OPACITY%20%3D%20%22opacity%22%3B%0AMaterialNode.SHININESS%20%3D%20%22shininess%22%3B%0AMaterialNode.SPECULAR%20%3D%20%22specular%22%3B%0AMaterialNode.SPECULAR_STRENGTH%20%3D%20%22specularStrength%22%3B%0AMaterialNode.SPECULAR_INTENSITY%20%3D%20%22specularIntensity%22%3B%0AMaterialNode.SPECULAR_COLOR%20%3D%20%22specularColor%22%3B%0AMaterialNode.REFLECTIVITY%20%3D%20%22reflectivity%22%3B%0AMaterialNode.ROUGHNESS%20%3D%20%22roughness%22%3B%0AMaterialNode.METALNESS%20%3D%20%22metalness%22%3B%0AMaterialNode.NORMAL%20%3D%20%22normal%22%3B%0AMaterialNode.CLEARCOAT%20%3D%20%22clearcoat%22%3B%0AMaterialNode.CLEARCOAT_ROUGHNESS%20%3D%20%22clearcoatRoughness%22%3B%0AMaterialNode.CLEARCOAT_NORMAL%20%3D%20%22clearcoatNormal%22%3B%0AMaterialNode.EMISSIVE%20%3D%20%22emissive%22%3B%0AMaterialNode.ROTATION%20%3D%20%22rotation%22%3B%0AMaterialNode.SHEEN%20%3D%20%22sheen%22%3B%0AMaterialNode.SHEEN_ROUGHNESS%20%3D%20%22sheenRoughness%22%3B%0AMaterialNode.ANISOTROPY%20%3D%20%22anisotropy%22%3B%0AMaterialNode.IRIDESCENCE%20%3D%20%22iridescence%22%3B%0AMaterialNode.IRIDESCENCE_IOR%20%3D%20%22iridescenceIOR%22%3B%0AMaterialNode.IRIDESCENCE_THICKNESS%20%3D%20%22iridescenceThickness%22%3B%0AMaterialNode.IOR%20%3D%20%22ior%22%3B%0AMaterialNode.TRANSMISSION%20%3D%20%22transmission%22%3B%0AMaterialNode.THICKNESS%20%3D%20%22thickness%22%3B%0AMaterialNode.ATTENUATION_DISTANCE%20%3D%20%22attenuationDistance%22%3B%0AMaterialNode.ATTENUATION_COLOR%20%3D%20%22attenuationColor%22%3B%0AMaterialNode.LINE_SCALE%20%3D%20%22scale%22%3B%0AMaterialNode.LINE_DASH_SIZE%20%3D%20%22dashSize%22%3B%0AMaterialNode.LINE_GAP_SIZE%20%3D%20%22gapSize%22%3B%0AMaterialNode.LINE_WIDTH%20%3D%20%22linewidth%22%3B%0AMaterialNode.LINE_DASH_OFFSET%20%3D%20%22dashOffset%22%3B%0AMaterialNode.POINT_WIDTH%20%3D%20%22pointWidth%22%3B%0AMaterialNode.DISPERSION%20%3D%20%22dispersion%22%3B%0AMaterialNode.LIGHT_MAP%20%3D%20%22light%22%3B%0AMaterialNode.AO_MAP%20%3D%20%22ao%22%3B%0Avar%20materialAlphaTest%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.ALPHA_TEST%29%3B%0Avar%20materialColor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.COLOR%29%3B%0Avar%20materialShininess%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.SHININESS%29%3B%0Avar%20materialEmissive%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.EMISSIVE%29%3B%0Avar%20materialOpacity%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.OPACITY%29%3B%0Avar%20materialSpecular%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.SPECULAR%29%3B%0Avar%20materialSpecularIntensity%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.SPECULAR_INTENSITY%29%3B%0Avar%20materialSpecularColor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.SPECULAR_COLOR%29%3B%0Avar%20materialSpecularStrength%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.SPECULAR_STRENGTH%29%3B%0Avar%20materialReflectivity%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.REFLECTIVITY%29%3B%0Avar%20materialRoughness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.ROUGHNESS%29%3B%0Avar%20materialMetalness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.METALNESS%29%3B%0Avar%20materialNormal%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.NORMAL%29.context%28%7B%20getUV%3A%20null%20%7D%29%3B%0Avar%20materialClearcoat%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.CLEARCOAT%29%3B%0Avar%20materialClearcoatRoughness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.CLEARCOAT_ROUGHNESS%29%3B%0Avar%20materialClearcoatNormal%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.CLEARCOAT_NORMAL%29.context%28%7B%20getUV%3A%20null%20%7D%29%3B%0Avar%20materialRotation%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.ROTATION%29%3B%0Avar%20materialSheen%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.SHEEN%29%3B%0Avar%20materialSheenRoughness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.SHEEN_ROUGHNESS%29%3B%0Avar%20materialAnisotropy%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.ANISOTROPY%29%3B%0Avar%20materialIridescence%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.IRIDESCENCE%29%3B%0Avar%20materialIridescenceIOR%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.IRIDESCENCE_IOR%29%3B%0Avar%20materialIridescenceThickness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.IRIDESCENCE_THICKNESS%29%3B%0Avar%20materialTransmission%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.TRANSMISSION%29%3B%0Avar%20materialThickness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.THICKNESS%29%3B%0Avar%20materialIOR%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.IOR%29%3B%0Avar%20materialAttenuationDistance%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.ATTENUATION_DISTANCE%29%3B%0Avar%20materialAttenuationColor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.ATTENUATION_COLOR%29%3B%0Avar%20materialLineScale%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.LINE_SCALE%29%3B%0Avar%20materialLineDashSize%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.LINE_DASH_SIZE%29%3B%0Avar%20materialLineGapSize%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.LINE_GAP_SIZE%29%3B%0Avar%20materialLineWidth%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.LINE_WIDTH%29%3B%0Avar%20materialLineDashOffset%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.LINE_DASH_OFFSET%29%3B%0Avar%20materialPointWidth%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.POINT_WIDTH%29%3B%0Avar%20materialDispersion%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.DISPERSION%29%3B%0Avar%20materialLightMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.LIGHT_MAP%29%3B%0Avar%20materialAOMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MaterialNode%2C%20MaterialNode.AO_MAP%29%3B%0Avar%20materialAnisotropyVector%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20uniform%28new%20Vector22%28%29%29.onReference%28function%28frame2%29%20%7B%0A%20%20return%20frame2.material%3B%0A%7D%29.onRenderUpdate%28function%28%7B%20material%20%7D%29%20%7B%0A%20%20this.value.set%28material.anisotropy%20%2A%20Math.cos%28material.anisotropyRotation%29%2C%20material.anisotropy%20%2A%20Math.sin%28material.anisotropyRotation%29%29%3B%0A%7D%29%3B%0Avar%20ModelViewProjectionNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ModelViewProjectionNode%22%3B%0A%20%20%7D%0A%20%20constructor%28positionNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%22vec4%22%29%3B%0A%20%20%20%20this.positionNode%20%3D%20positionNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20if%20%28builder.shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20return%20varying%28builder.context.mvp%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20position%20%3D%20this.positionNode%20%7C%7C%20positionLocal%3B%0A%20%20%20%20const%20viewMatrix%20%3D%20builder.renderer.nodes.modelViewMatrix%20%7C%7C%20modelViewMatrix%3B%0A%20%20%20%20return%20cameraProjectionMatrix.mul%28viewMatrix%29.mul%28position%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20modelViewProjection%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28ModelViewProjectionNode%29%3B%0Avar%20IndexNode%20%3D%20class%20_IndexNode%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22IndexNode%22%3B%0A%20%20%7D%0A%20%20constructor%28scope%29%20%7B%0A%20%20%20%20super%28%22uint%22%29%3B%0A%20%20%20%20this.scope%20%3D%20scope%3B%0A%20%20%20%20this.isInstanceIndexNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20nodeType%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20scope%20%3D%20this.scope%3B%0A%20%20%20%20let%20propertyName%3B%0A%20%20%20%20if%20%28scope%20%3D%3D%3D%20_IndexNode.VERTEX%29%20%7B%0A%20%20%20%20%20%20propertyName%20%3D%20builder.getVertexIndex%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_IndexNode.INSTANCE%29%20%7B%0A%20%20%20%20%20%20propertyName%20%3D%20builder.getInstanceIndex%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_IndexNode.DRAW%29%20%7B%0A%20%20%20%20%20%20propertyName%20%3D%20builder.getDrawIndex%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_IndexNode.INVOCATION_LOCAL%29%20%7B%0A%20%20%20%20%20%20propertyName%20%3D%20builder.getInvocationLocalIndex%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_IndexNode.INVOCATION_SUBGROUP%29%20%7B%0A%20%20%20%20%20%20propertyName%20%3D%20builder.getInvocationSubgroupIndex%28%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_IndexNode.SUBGROUP%29%20%7B%0A%20%20%20%20%20%20propertyName%20%3D%20builder.getSubgroupIndex%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.IndexNode%3A%20Unknown%20scope%3A%20%22%20%2B%20scope%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20output2%3B%0A%20%20%20%20if%20%28builder.shaderStage%20%3D%3D%3D%20%22vertex%22%20%7C%7C%20builder.shaderStage%20%3D%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20output2%20%3D%20propertyName%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20nodeVarying%20%3D%20varying%28this%29%3B%0A%20%20%20%20%20%20output2%20%3D%20nodeVarying.build%28builder%2C%20nodeType%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%7D%3B%0AIndexNode.VERTEX%20%3D%20%22vertex%22%3B%0AIndexNode.INSTANCE%20%3D%20%22instance%22%3B%0AIndexNode.SUBGROUP%20%3D%20%22subgroup%22%3B%0AIndexNode.INVOCATION_LOCAL%20%3D%20%22invocationLocal%22%3B%0AIndexNode.INVOCATION_SUBGROUP%20%3D%20%22invocationSubgroup%22%3B%0AIndexNode.DRAW%20%3D%20%22draw%22%3B%0Avar%20vertexIndex%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28IndexNode%2C%20IndexNode.VERTEX%29%3B%0Avar%20instanceIndex%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28IndexNode%2C%20IndexNode.INSTANCE%29%3B%0Avar%20subgroupIndex%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28IndexNode%2C%20IndexNode.SUBGROUP%29%3B%0Avar%20invocationSubgroupIndex%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28IndexNode%2C%20IndexNode.INVOCATION_SUBGROUP%29%3B%0Avar%20invocationLocalIndex%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28IndexNode%2C%20IndexNode.INVOCATION_LOCAL%29%3B%0Avar%20drawIndex%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28IndexNode%2C%20IndexNode.DRAW%29%3B%0Avar%20InstanceNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22InstanceNode%22%3B%0A%20%20%7D%0A%20%20constructor%28instanceMesh%29%20%7B%0A%20%20%20%20super%28%22void%22%29%3B%0A%20%20%20%20this.instanceMesh%20%3D%20instanceMesh%3B%0A%20%20%20%20this.instanceMatrixNode%20%3D%20null%3B%0A%20%20%20%20this.instanceColorNode%20%3D%20null%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.FRAME%3B%0A%20%20%20%20this.buffer%20%3D%20null%3B%0A%20%20%20%20this.bufferColor%20%3D%20null%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20let%20instanceMatrixNode%20%3D%20this.instanceMatrixNode%3B%0A%20%20%20%20let%20instanceColorNode%20%3D%20this.instanceColorNode%3B%0A%20%20%20%20const%20instanceMesh%20%3D%20this.instanceMesh%3B%0A%20%20%20%20if%20%28instanceMatrixNode%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20instanceAttribute%20%3D%20instanceMesh.instanceMatrix%3B%0A%20%20%20%20%20%20if%20%28instanceMesh.count%20%3C%3D%201e3%29%20%7B%0A%20%20%20%20%20%20%20%20instanceMatrixNode%20%3D%20buffer%28instanceAttribute.array%2C%20%22mat4%22%2C%20Math.max%28instanceMesh.count%2C%201%29%29.element%28instanceIndex%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20buffer2%20%3D%20new%20InstancedInterleavedBuffer%28instanceAttribute.array%2C%2016%2C%201%29%3B%0A%20%20%20%20%20%20%20%20this.buffer%20%3D%20buffer2%3B%0A%20%20%20%20%20%20%20%20const%20bufferFn%20%3D%20instanceAttribute.usage%20%3D%3D%3D%20DynamicDrawUsage%20%3F%20instancedDynamicBufferAttribute%20%3A%20instancedBufferAttribute%3B%0A%20%20%20%20%20%20%20%20const%20instanceBuffers%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20F.Signature%20-%3E%20bufferAttribute%28%20array%2C%20type%2C%20stride%2C%20offset%20%29%0A%20%20%20%20%20%20%20%20%20%20bufferFn%28buffer2%2C%20%22vec4%22%2C%2016%2C%200%29%2C%0A%20%20%20%20%20%20%20%20%20%20bufferFn%28buffer2%2C%20%22vec4%22%2C%2016%2C%204%29%2C%0A%20%20%20%20%20%20%20%20%20%20bufferFn%28buffer2%2C%20%22vec4%22%2C%2016%2C%208%29%2C%0A%20%20%20%20%20%20%20%20%20%20bufferFn%28buffer2%2C%20%22vec4%22%2C%2016%2C%2012%29%0A%20%20%20%20%20%20%20%20%5D%3B%0A%20%20%20%20%20%20%20%20instanceMatrixNode%20%3D%20mat4%28...instanceBuffers%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.instanceMatrixNode%20%3D%20instanceMatrixNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20instanceColorAttribute%20%3D%20instanceMesh.instanceColor%3B%0A%20%20%20%20if%20%28instanceColorAttribute%20%26%26%20instanceColorNode%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20buffer2%20%3D%20new%20InstancedBufferAttribute%28instanceColorAttribute.array%2C%203%29%3B%0A%20%20%20%20%20%20const%20bufferFn%20%3D%20instanceColorAttribute.usage%20%3D%3D%3D%20DynamicDrawUsage%20%3F%20instancedDynamicBufferAttribute%20%3A%20instancedBufferAttribute%3B%0A%20%20%20%20%20%20this.bufferColor%20%3D%20buffer2%3B%0A%20%20%20%20%20%20instanceColorNode%20%3D%20vec3%28bufferFn%28buffer2%2C%20%22vec3%22%2C%203%2C%200%29%29%3B%0A%20%20%20%20%20%20this.instanceColorNode%20%3D%20instanceColorNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20instancePosition%20%3D%20instanceMatrixNode.mul%28positionLocal%29.xyz%3B%0A%20%20%20%20positionLocal.assign%28instancePosition%29%3B%0A%20%20%20%20if%20%28builder.hasGeometryAttribute%28%22normal%22%29%29%20%7B%0A%20%20%20%20%20%20const%20instanceNormal%20%3D%20transformNormal%28normalLocal%2C%20instanceMatrixNode%29%3B%0A%20%20%20%20%20%20normalLocal.assign%28instanceNormal%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.instanceColorNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20varyingProperty%28%22vec3%22%2C%20%22vInstanceColor%22%29.assign%28this.instanceColorNode%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20if%20%28this.instanceMesh.instanceMatrix.usage%20%21%3D%3D%20DynamicDrawUsage%20%26%26%20this.buffer%20%21%3D%20null%20%26%26%20this.instanceMesh.instanceMatrix.version%20%21%3D%3D%20this.buffer.version%29%20%7B%0A%20%20%20%20%20%20this.buffer.version%20%3D%20this.instanceMesh.instanceMatrix.version%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.instanceMesh.instanceColor%20%26%26%20this.instanceMesh.instanceColor.usage%20%21%3D%3D%20DynamicDrawUsage%20%26%26%20this.bufferColor%20%21%3D%20null%20%26%26%20this.instanceMesh.instanceColor.version%20%21%3D%3D%20this.bufferColor.version%29%20%7B%0A%20%20%20%20%20%20this.bufferColor.version%20%3D%20this.instanceMesh.instanceColor.version%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20instance%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28InstanceNode%29%3B%0Avar%20BatchNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22BatchNode%22%3B%0A%20%20%7D%0A%20%20constructor%28batchMesh%29%20%7B%0A%20%20%20%20super%28%22void%22%29%3B%0A%20%20%20%20this.batchMesh%20%3D%20batchMesh%3B%0A%20%20%20%20this.batchingIdNode%20%3D%20null%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20if%20%28this.batchingIdNode%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28builder.getDrawIndex%28%29%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this.batchingIdNode%20%3D%20instanceIndex%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this.batchingIdNode%20%3D%20drawIndex%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20getIndirectIndex%20%3D%20Fn%28%28%5Bid2%5D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20size2%20%3D%20textureSize%28textureLoad%28this.batchMesh._indirectTexture%29%2C%200%29%3B%0A%20%20%20%20%20%20const%20x3%20%3D%20int%28id2%29.modInt%28int%28size2%29%29%3B%0A%20%20%20%20%20%20const%20y3%20%3D%20int%28id2%29.div%28int%28size2%29%29%3B%0A%20%20%20%20%20%20return%20textureLoad%28this.batchMesh._indirectTexture%2C%20ivec2%28x3%2C%20y3%29%29.x%3B%0A%20%20%20%20%7D%29.setLayout%28%7B%0A%20%20%20%20%20%20name%3A%20%22getIndirectIndex%22%2C%0A%20%20%20%20%20%20type%3A%20%22uint%22%2C%0A%20%20%20%20%20%20inputs%3A%20%5B%0A%20%20%20%20%20%20%20%20%7B%20name%3A%20%22id%22%2C%20type%3A%20%22int%22%20%7D%0A%20%20%20%20%20%20%5D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20indirectId%20%3D%20getIndirectIndex%28int%28this.batchingIdNode%29%29%3B%0A%20%20%20%20const%20matricesTexture%20%3D%20this.batchMesh._matricesTexture%3B%0A%20%20%20%20const%20size%20%3D%20textureSize%28textureLoad%28matricesTexture%29%2C%200%29%3B%0A%20%20%20%20const%20j%20%3D%20float%28indirectId%29.mul%284%29.toInt%28%29.toVar%28%29%3B%0A%20%20%20%20const%20x2%20%3D%20j.modInt%28size%29%3B%0A%20%20%20%20const%20y2%20%3D%20j.div%28int%28size%29%29%3B%0A%20%20%20%20const%20batchingMatrix%20%3D%20mat4%28%0A%20%20%20%20%20%20textureLoad%28matricesTexture%2C%20ivec2%28x2%2C%20y2%29%29%2C%0A%20%20%20%20%20%20textureLoad%28matricesTexture%2C%20ivec2%28x2.add%281%29%2C%20y2%29%29%2C%0A%20%20%20%20%20%20textureLoad%28matricesTexture%2C%20ivec2%28x2.add%282%29%2C%20y2%29%29%2C%0A%20%20%20%20%20%20textureLoad%28matricesTexture%2C%20ivec2%28x2.add%283%29%2C%20y2%29%29%0A%20%20%20%20%29%3B%0A%20%20%20%20const%20colorsTexture%20%3D%20this.batchMesh._colorsTexture%3B%0A%20%20%20%20if%20%28colorsTexture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20getBatchingColor%20%3D%20Fn%28%28%5Bid2%5D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20size2%20%3D%20textureSize%28textureLoad%28colorsTexture%29%2C%200%29.x%3B%0A%20%20%20%20%20%20%20%20const%20j2%20%3D%20id2%3B%0A%20%20%20%20%20%20%20%20const%20x3%20%3D%20j2.modInt%28size2%29%3B%0A%20%20%20%20%20%20%20%20const%20y3%20%3D%20j2.div%28size2%29%3B%0A%20%20%20%20%20%20%20%20return%20textureLoad%28colorsTexture%2C%20ivec2%28x3%2C%20y3%29%29.rgb%3B%0A%20%20%20%20%20%20%7D%29.setLayout%28%7B%0A%20%20%20%20%20%20%20%20name%3A%20%22getBatchingColor%22%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22vec3%22%2C%0A%20%20%20%20%20%20%20%20inputs%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%7B%20name%3A%20%22id%22%2C%20type%3A%20%22int%22%20%7D%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20const%20color2%20%3D%20getBatchingColor%28indirectId%29%3B%0A%20%20%20%20%20%20varyingProperty%28%22vec3%22%2C%20%22vBatchColor%22%29.assign%28color2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20bm%20%3D%20mat3%28batchingMatrix%29%3B%0A%20%20%20%20positionLocal.assign%28batchingMatrix.mul%28positionLocal%29%29%3B%0A%20%20%20%20const%20transformedNormal%20%3D%20normalLocal.div%28vec3%28bm%5B0%5D.dot%28bm%5B0%5D%29%2C%20bm%5B1%5D.dot%28bm%5B1%5D%29%2C%20bm%5B2%5D.dot%28bm%5B2%5D%29%29%29%3B%0A%20%20%20%20const%20batchingNormal%20%3D%20bm.mul%28transformedNormal%29.xyz%3B%0A%20%20%20%20normalLocal.assign%28batchingNormal%29%3B%0A%20%20%20%20if%20%28builder.hasGeometryAttribute%28%22tangent%22%29%29%20%7B%0A%20%20%20%20%20%20tangentLocal.mulAssign%28bm%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20batch%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28BatchNode%29%3B%0Avar%20_frameId%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Avar%20SkinningNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22SkinningNode%22%3B%0A%20%20%7D%0A%20%20constructor%28skinnedMesh%2C%20useReference%20%3D%20false%29%20%7B%0A%20%20%20%20super%28%22void%22%29%3B%0A%20%20%20%20this.skinnedMesh%20%3D%20skinnedMesh%3B%0A%20%20%20%20this.useReference%20%3D%20useReference%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.OBJECT%3B%0A%20%20%20%20this.skinIndexNode%20%3D%20attribute%28%22skinIndex%22%2C%20%22uvec4%22%29%3B%0A%20%20%20%20this.skinWeightNode%20%3D%20attribute%28%22skinWeight%22%2C%20%22vec4%22%29%3B%0A%20%20%20%20let%20bindMatrixNode%2C%20bindMatrixInverseNode%2C%20boneMatricesNode%3B%0A%20%20%20%20if%20%28useReference%29%20%7B%0A%20%20%20%20%20%20bindMatrixNode%20%3D%20reference%28%22bindMatrix%22%2C%20%22mat4%22%29%3B%0A%20%20%20%20%20%20bindMatrixInverseNode%20%3D%20reference%28%22bindMatrixInverse%22%2C%20%22mat4%22%29%3B%0A%20%20%20%20%20%20boneMatricesNode%20%3D%20referenceBuffer%28%22skeleton.boneMatrices%22%2C%20%22mat4%22%2C%20skinnedMesh.skeleton.bones.length%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20bindMatrixNode%20%3D%20uniform%28skinnedMesh.bindMatrix%2C%20%22mat4%22%29%3B%0A%20%20%20%20%20%20bindMatrixInverseNode%20%3D%20uniform%28skinnedMesh.bindMatrixInverse%2C%20%22mat4%22%29%3B%0A%20%20%20%20%20%20boneMatricesNode%20%3D%20buffer%28skinnedMesh.skeleton.boneMatrices%2C%20%22mat4%22%2C%20skinnedMesh.skeleton.bones.length%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.bindMatrixNode%20%3D%20bindMatrixNode%3B%0A%20%20%20%20this.bindMatrixInverseNode%20%3D%20bindMatrixInverseNode%3B%0A%20%20%20%20this.boneMatricesNode%20%3D%20boneMatricesNode%3B%0A%20%20%20%20this.previousBoneMatricesNode%20%3D%20null%3B%0A%20%20%7D%0A%20%20getSkinnedPosition%28boneMatrices%20%3D%20this.boneMatricesNode%2C%20position%20%3D%20positionLocal%29%20%7B%0A%20%20%20%20const%20%7B%20skinIndexNode%2C%20skinWeightNode%2C%20bindMatrixNode%2C%20bindMatrixInverseNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20boneMatX%20%3D%20boneMatrices.element%28skinIndexNode.x%29%3B%0A%20%20%20%20const%20boneMatY%20%3D%20boneMatrices.element%28skinIndexNode.y%29%3B%0A%20%20%20%20const%20boneMatZ%20%3D%20boneMatrices.element%28skinIndexNode.z%29%3B%0A%20%20%20%20const%20boneMatW%20%3D%20boneMatrices.element%28skinIndexNode.w%29%3B%0A%20%20%20%20const%20skinVertex%20%3D%20bindMatrixNode.mul%28position%29%3B%0A%20%20%20%20const%20skinned%20%3D%20add4%28%0A%20%20%20%20%20%20boneMatX.mul%28skinWeightNode.x%29.mul%28skinVertex%29%2C%0A%20%20%20%20%20%20boneMatY.mul%28skinWeightNode.y%29.mul%28skinVertex%29%2C%0A%20%20%20%20%20%20boneMatZ.mul%28skinWeightNode.z%29.mul%28skinVertex%29%2C%0A%20%20%20%20%20%20boneMatW.mul%28skinWeightNode.w%29.mul%28skinVertex%29%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20bindMatrixInverseNode.mul%28skinned%29.xyz%3B%0A%20%20%7D%0A%20%20getSkinnedNormal%28boneMatrices%20%3D%20this.boneMatricesNode%2C%20normal2%20%3D%20normalLocal%29%20%7B%0A%20%20%20%20const%20%7B%20skinIndexNode%2C%20skinWeightNode%2C%20bindMatrixNode%2C%20bindMatrixInverseNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20boneMatX%20%3D%20boneMatrices.element%28skinIndexNode.x%29%3B%0A%20%20%20%20const%20boneMatY%20%3D%20boneMatrices.element%28skinIndexNode.y%29%3B%0A%20%20%20%20const%20boneMatZ%20%3D%20boneMatrices.element%28skinIndexNode.z%29%3B%0A%20%20%20%20const%20boneMatW%20%3D%20boneMatrices.element%28skinIndexNode.w%29%3B%0A%20%20%20%20let%20skinMatrix%20%3D%20add4%28%0A%20%20%20%20%20%20skinWeightNode.x.mul%28boneMatX%29%2C%0A%20%20%20%20%20%20skinWeightNode.y.mul%28boneMatY%29%2C%0A%20%20%20%20%20%20skinWeightNode.z.mul%28boneMatZ%29%2C%0A%20%20%20%20%20%20skinWeightNode.w.mul%28boneMatW%29%0A%20%20%20%20%29%3B%0A%20%20%20%20skinMatrix%20%3D%20bindMatrixInverseNode.mul%28skinMatrix%29.mul%28bindMatrixNode%29%3B%0A%20%20%20%20return%20skinMatrix.transformDirection%28normal2%29.xyz%3B%0A%20%20%7D%0A%20%20getPreviousSkinnedPosition%28builder%29%20%7B%0A%20%20%20%20const%20skinnedMesh%20%3D%20builder.object%3B%0A%20%20%20%20if%20%28this.previousBoneMatricesNode%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20skinnedMesh.skeleton.previousBoneMatrices%20%3D%20new%20Float32Array%28skinnedMesh.skeleton.boneMatrices%29%3B%0A%20%20%20%20%20%20this.previousBoneMatricesNode%20%3D%20referenceBuffer%28%22skeleton.previousBoneMatrices%22%2C%20%22mat4%22%2C%20skinnedMesh.skeleton.bones.length%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.getSkinnedPosition%28this.previousBoneMatricesNode%2C%20positionPrevious%29%3B%0A%20%20%7D%0A%20%20needsPreviousBoneMatrices%28builder%29%20%7B%0A%20%20%20%20const%20mrt%20%3D%20builder.renderer.getMRT%28%29%3B%0A%20%20%20%20return%20mrt%20%26%26%20mrt.has%28%22velocity%22%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20if%20%28this.needsPreviousBoneMatrices%28builder%29%29%20%7B%0A%20%20%20%20%20%20positionPrevious.assign%28this.getPreviousSkinnedPosition%28builder%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20skinPosition%20%3D%20this.getSkinnedPosition%28%29%3B%0A%20%20%20%20positionLocal.assign%28skinPosition%29%3B%0A%20%20%20%20if%20%28builder.hasGeometryAttribute%28%22normal%22%29%29%20%7B%0A%20%20%20%20%20%20const%20skinNormal%20%3D%20this.getSkinnedNormal%28%29%3B%0A%20%20%20%20%20%20normalLocal.assign%28skinNormal%29%3B%0A%20%20%20%20%20%20if%20%28builder.hasGeometryAttribute%28%22tangent%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20tangentLocal.assign%28skinNormal%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20if%20%28output2%20%21%3D%3D%20%22void%22%29%20%7B%0A%20%20%20%20%20%20return%20positionLocal.build%28builder%2C%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%28frame2%29%20%7B%0A%20%20%20%20const%20object%20%3D%20this.useReference%20%3F%20frame2.object%20%3A%20this.skinnedMesh%3B%0A%20%20%20%20const%20skeleton%20%3D%20object.skeleton%3B%0A%20%20%20%20if%20%28_frameId.get%28skeleton%29%20%3D%3D%3D%20frame2.frameId%29%20return%3B%0A%20%20%20%20_frameId.set%28skeleton%2C%20frame2.frameId%29%3B%0A%20%20%20%20if%20%28this.previousBoneMatricesNode%20%21%3D%3D%20null%29%20skeleton.previousBoneMatrices.set%28skeleton.boneMatrices%29%3B%0A%20%20%20%20skeleton.update%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20skinningReference%20%3D%20%28skinnedMesh%29%20%3D%3E%20nodeObject%28new%20SkinningNode%28skinnedMesh%2C%20true%29%29%3B%0Avar%20LoopNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LoopNode%22%3B%0A%20%20%7D%0A%20%20constructor%28params%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.params%20%3D%20params%3B%0A%20%20%7D%0A%20%20getVarName%28index5%29%20%7B%0A%20%20%20%20return%20String.fromCharCode%28%22i%22.charCodeAt%28%29%20%2B%20index5%29%3B%0A%20%20%7D%0A%20%20getProperties%28builder%29%20%7B%0A%20%20%20%20const%20properties%20%3D%20builder.getNodeProperties%28this%29%3B%0A%20%20%20%20if%20%28properties.stackNode%20%21%3D%3D%20void%200%29%20return%20properties%3B%0A%20%20%20%20const%20inputs%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.params.length%20-%201%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20param%20%3D%20this.params%5Bi%5D%3B%0A%20%20%20%20%20%20const%20name%20%3D%20param.isNode%20%21%3D%3D%20true%20%26%26%20param.name%20%7C%7C%20this.getVarName%28i%29%3B%0A%20%20%20%20%20%20const%20type%20%3D%20param.isNode%20%21%3D%3D%20true%20%26%26%20param.type%20%7C%7C%20%22int%22%3B%0A%20%20%20%20%20%20inputs%5Bname%5D%20%3D%20expression%28name%2C%20type%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20stack2%20%3D%20builder.addStack%28%29%3B%0A%20%20%20%20properties.returnsNode%20%3D%20this.params%5Bthis.params.length%20-%201%5D%28inputs%2C%20stack2%2C%20builder%29%3B%0A%20%20%20%20properties.stackNode%20%3D%20stack2%3B%0A%20%20%20%20builder.removeStack%28%29%3B%0A%20%20%20%20return%20properties%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20returnsNode%20%7D%20%3D%20this.getProperties%28builder%29%3B%0A%20%20%20%20return%20returnsNode%20%3F%20returnsNode.getNodeType%28builder%29%20%3A%20%22void%22%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20this.getProperties%28builder%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20properties%20%3D%20this.getProperties%28builder%29%3B%0A%20%20%20%20const%20params%20%3D%20this.params%3B%0A%20%20%20%20const%20stackNode%20%3D%20properties.stackNode%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20params.length%20-%201%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20param%20%3D%20params%5Bi%5D%3B%0A%20%20%20%20%20%20let%20start%20%3D%20null%2C%20end%20%3D%20null%2C%20name%20%3D%20null%2C%20type%20%3D%20null%2C%20condition%20%3D%20null%2C%20update4%20%3D%20null%3B%0A%20%20%20%20%20%20if%20%28param.isNode%29%20%7B%0A%20%20%20%20%20%20%20%20type%20%3D%20%22int%22%3B%0A%20%20%20%20%20%20%20%20name%20%3D%20this.getVarName%28i%29%3B%0A%20%20%20%20%20%20%20%20start%20%3D%20%220%22%3B%0A%20%20%20%20%20%20%20%20end%20%3D%20param.build%28builder%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20condition%20%3D%20%22%3C%22%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20type%20%3D%20param.type%20%7C%7C%20%22int%22%3B%0A%20%20%20%20%20%20%20%20name%20%3D%20param.name%20%7C%7C%20this.getVarName%28i%29%3B%0A%20%20%20%20%20%20%20%20start%20%3D%20param.start%3B%0A%20%20%20%20%20%20%20%20end%20%3D%20param.end%3B%0A%20%20%20%20%20%20%20%20condition%20%3D%20param.condition%3B%0A%20%20%20%20%20%20%20%20update4%20%3D%20param.update%3B%0A%20%20%20%20%20%20%20%20if%20%28typeof%20start%20%3D%3D%3D%20%22number%22%29%20start%20%3D%20builder.generateConst%28type%2C%20start%29%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28start%20%26%26%20start.isNode%29%20start%20%3D%20start.build%28builder%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20if%20%28typeof%20end%20%3D%3D%3D%20%22number%22%29%20end%20%3D%20builder.generateConst%28type%2C%20end%29%3B%0A%20%20%20%20%20%20%20%20else%20if%20%28end%20%26%26%20end.isNode%29%20end%20%3D%20end.build%28builder%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20if%20%28start%20%21%3D%3D%20void%200%20%26%26%20end%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20start%20%3D%20start%20%2B%20%22%20-%201%22%3B%0A%20%20%20%20%20%20%20%20%20%20end%20%3D%20%220%22%3B%0A%20%20%20%20%20%20%20%20%20%20condition%20%3D%20%22%3E%3D%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28end%20%21%3D%3D%20void%200%20%26%26%20start%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20start%20%3D%20%220%22%3B%0A%20%20%20%20%20%20%20%20%20%20condition%20%3D%20%22%3C%22%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28condition%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28Number%28start%29%20%3E%20Number%28end%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20condition%20%3D%20%22%3E%3D%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20condition%20%3D%20%22%3C%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20internalParam%20%3D%20%7B%20start%2C%20end%2C%20condition%20%7D%3B%0A%20%20%20%20%20%20const%20startSnippet%20%3D%20internalParam.start%3B%0A%20%20%20%20%20%20const%20endSnippet%20%3D%20internalParam.end%3B%0A%20%20%20%20%20%20let%20declarationSnippet%20%3D%20%22%22%3B%0A%20%20%20%20%20%20let%20conditionalSnippet%20%3D%20%22%22%3B%0A%20%20%20%20%20%20let%20updateSnippet%20%3D%20%22%22%3B%0A%20%20%20%20%20%20if%20%28%21update4%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20%22int%22%20%7C%7C%20type%20%3D%3D%3D%20%22uint%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28condition.includes%28%22%3C%22%29%29%20update4%20%3D%20%22%2B%2B%22%3B%0A%20%20%20%20%20%20%20%20%20%20else%20update4%20%3D%20%22--%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28condition.includes%28%22%3C%22%29%29%20update4%20%3D%20%22%2B%3D%201.%22%3B%0A%20%20%20%20%20%20%20%20%20%20else%20update4%20%3D%20%22-%3D%201.%22%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20declarationSnippet%20%2B%3D%20builder.getVar%28type%2C%20name%29%20%2B%20%22%20%3D%20%22%20%2B%20startSnippet%3B%0A%20%20%20%20%20%20conditionalSnippet%20%2B%3D%20name%20%2B%20%22%20%22%20%2B%20condition%20%2B%20%22%20%22%20%2B%20endSnippet%3B%0A%20%20%20%20%20%20updateSnippet%20%2B%3D%20name%20%2B%20%22%20%22%20%2B%20update4%3B%0A%20%20%20%20%20%20const%20forSnippet%20%3D%20%60for%20%28%20%24%7BdeclarationSnippet%7D%3B%20%24%7BconditionalSnippet%7D%3B%20%24%7BupdateSnippet%7D%20%29%60%3B%0A%20%20%20%20%20%20builder.addFlowCode%28%28i%20%3D%3D%3D%200%20%3F%20%22%5Cn%22%20%3A%20%22%22%29%20%2B%20builder.tab%20%2B%20forSnippet%20%2B%20%22%20%7B%5Cn%5Cn%22%29.addFlowTab%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20stackSnippet%20%3D%20stackNode.build%28builder%2C%20%22void%22%29%3B%0A%20%20%20%20const%20returnsSnippet%20%3D%20properties.returnsNode%20%3F%20properties.returnsNode.build%28builder%29%20%3A%20%22%22%3B%0A%20%20%20%20builder.removeFlowTab%28%29.addFlowCode%28%22%5Cn%22%20%2B%20builder.tab%20%2B%20stackSnippet%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.params.length%20-%201%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20builder.addFlowCode%28%28i%20%3D%3D%3D%200%20%3F%20%22%22%20%3A%20builder.tab%29%20%2B%20%22%7D%5Cn%5Cn%22%29.removeFlowTab%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20builder.addFlowTab%28%29%3B%0A%20%20%20%20return%20returnsSnippet%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Loop%20%3D%20%28...params%29%20%3D%3E%20nodeObject%28new%20LoopNode%28nodeArray%28params%2C%20%22int%22%29%29%29.append%28%29%3B%0Avar%20Break%20%3D%20%28%29%20%3D%3E%20expression%28%22break%22%29.append%28%29%3B%0Avar%20_morphTextures%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Avar%20_morphVec4%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector42%28%29%3B%0Avar%20getMorph%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20bufferMap%2C%20influence%2C%20stride%2C%20width%2C%20depth%3A%20depth2%2C%20offset%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20texelIndex%20%3D%20int%28vertexIndex%29.mul%28stride%29.add%28offset%29%3B%0A%20%20const%20y2%20%3D%20texelIndex.div%28width%29%3B%0A%20%20const%20x2%20%3D%20texelIndex.sub%28y2.mul%28width%29%29%3B%0A%20%20const%20bufferAttrib%20%3D%20textureLoad%28bufferMap%2C%20ivec2%28x2%2C%20y2%29%29.depth%28depth2%29%3B%0A%20%20return%20bufferAttrib.mul%28influence%29%3B%0A%7D%29%3B%0Afunction%20getEntry%28geometry%29%20%7B%0A%20%20const%20hasMorphPosition%20%3D%20geometry.morphAttributes.position%20%21%3D%3D%20void%200%3B%0A%20%20const%20hasMorphNormals%20%3D%20geometry.morphAttributes.normal%20%21%3D%3D%20void%200%3B%0A%20%20const%20hasMorphColors%20%3D%20geometry.morphAttributes.color%20%21%3D%3D%20void%200%3B%0A%20%20const%20morphAttribute%20%3D%20geometry.morphAttributes.position%20%7C%7C%20geometry.morphAttributes.normal%20%7C%7C%20geometry.morphAttributes.color%3B%0A%20%20const%20morphTargetsCount%20%3D%20morphAttribute%20%21%3D%3D%20void%200%20%3F%20morphAttribute.length%20%3A%200%3B%0A%20%20let%20entry%20%3D%20_morphTextures.get%28geometry%29%3B%0A%20%20if%20%28entry%20%3D%3D%3D%20void%200%20%7C%7C%20entry.count%20%21%3D%3D%20morphTargetsCount%29%20%7B%0A%20%20%20%20let%20disposeTexture%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20bufferTexture.dispose%28%29%3B%0A%20%20%20%20%20%20_morphTextures.delete%28geometry%29%3B%0A%20%20%20%20%20%20geometry.removeEventListener%28%22dispose%22%2C%20disposeTexture%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28entry%20%21%3D%3D%20void%200%29%20entry.texture.dispose%28%29%3B%0A%20%20%20%20const%20morphTargets%20%3D%20geometry.morphAttributes.position%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20const%20morphNormals%20%3D%20geometry.morphAttributes.normal%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20const%20morphColors%20%3D%20geometry.morphAttributes.color%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20let%20vertexDataCount%20%3D%200%3B%0A%20%20%20%20if%20%28hasMorphPosition%20%3D%3D%3D%20true%29%20vertexDataCount%20%3D%201%3B%0A%20%20%20%20if%20%28hasMorphNormals%20%3D%3D%3D%20true%29%20vertexDataCount%20%3D%202%3B%0A%20%20%20%20if%20%28hasMorphColors%20%3D%3D%3D%20true%29%20vertexDataCount%20%3D%203%3B%0A%20%20%20%20let%20width%20%3D%20geometry.attributes.position.count%20%2A%20vertexDataCount%3B%0A%20%20%20%20let%20height%20%3D%201%3B%0A%20%20%20%20const%20maxTextureSize%20%3D%204096%3B%0A%20%20%20%20if%20%28width%20%3E%20maxTextureSize%29%20%7B%0A%20%20%20%20%20%20height%20%3D%20Math.ceil%28width%20%2F%20maxTextureSize%29%3B%0A%20%20%20%20%20%20width%20%3D%20maxTextureSize%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20buffer2%20%3D%20new%20Float32Array%28width%20%2A%20height%20%2A%204%20%2A%20morphTargetsCount%29%3B%0A%20%20%20%20const%20bufferTexture%20%3D%20new%20DataArrayTexture2%28buffer2%2C%20width%2C%20height%2C%20morphTargetsCount%29%3B%0A%20%20%20%20bufferTexture.type%20%3D%20FloatType2%3B%0A%20%20%20%20bufferTexture.needsUpdate%20%3D%20true%3B%0A%20%20%20%20const%20vertexDataStride%20%3D%20vertexDataCount%20%2A%204%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20morphTargetsCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20morphTarget%20%3D%20morphTargets%5Bi%5D%3B%0A%20%20%20%20%20%20const%20morphNormal%20%3D%20morphNormals%5Bi%5D%3B%0A%20%20%20%20%20%20const%20morphColor%20%3D%20morphColors%5Bi%5D%3B%0A%20%20%20%20%20%20const%20offset%20%3D%20width%20%2A%20height%20%2A%204%20%2A%20i%3B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20morphTarget.count%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20stride%20%3D%20j%20%2A%20vertexDataStride%3B%0A%20%20%20%20%20%20%20%20if%20%28hasMorphPosition%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_morphVec4.fromBufferAttribute%28morphTarget%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%200%5D%20%3D%20_morphVec4.x%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%201%5D%20%3D%20_morphVec4.y%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%202%5D%20%3D%20_morphVec4.z%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%203%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28hasMorphNormals%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_morphVec4.fromBufferAttribute%28morphNormal%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%204%5D%20%3D%20_morphVec4.x%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%205%5D%20%3D%20_morphVec4.y%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%206%5D%20%3D%20_morphVec4.z%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%207%5D%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28hasMorphColors%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_morphVec4.fromBufferAttribute%28morphColor%2C%20j%29%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%208%5D%20%3D%20_morphVec4.x%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%209%5D%20%3D%20_morphVec4.y%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%2010%5D%20%3D%20_morphVec4.z%3B%0A%20%20%20%20%20%20%20%20%20%20buffer2%5Boffset%20%2B%20stride%20%2B%2011%5D%20%3D%20morphColor.itemSize%20%3D%3D%3D%204%20%3F%20_morphVec4.w%20%3A%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20entry%20%3D%20%7B%0A%20%20%20%20%20%20count%3A%20morphTargetsCount%2C%0A%20%20%20%20%20%20texture%3A%20bufferTexture%2C%0A%20%20%20%20%20%20stride%3A%20vertexDataCount%2C%0A%20%20%20%20%20%20size%3A%20new%20Vector22%28width%2C%20height%29%0A%20%20%20%20%7D%3B%0A%20%20%20%20_morphTextures.set%28geometry%2C%20entry%29%3B%0A%20%20%20%20geometry.addEventListener%28%22dispose%22%2C%20disposeTexture%29%3B%0A%20%20%7D%0A%20%20return%20entry%3B%0A%7D%0Avar%20MorphNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MorphNode%22%3B%0A%20%20%7D%0A%20%20constructor%28mesh%29%20%7B%0A%20%20%20%20super%28%22void%22%29%3B%0A%20%20%20%20this.mesh%20%3D%20mesh%3B%0A%20%20%20%20this.morphBaseInfluence%20%3D%20uniform%281%29%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.OBJECT%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20geometry%20%7D%20%3D%20builder%3B%0A%20%20%20%20const%20hasMorphPosition%20%3D%20geometry.morphAttributes.position%20%21%3D%3D%20void%200%3B%0A%20%20%20%20const%20hasMorphNormals%20%3D%20geometry.hasAttribute%28%22normal%22%29%20%26%26%20geometry.morphAttributes.normal%20%21%3D%3D%20void%200%3B%0A%20%20%20%20const%20morphAttribute%20%3D%20geometry.morphAttributes.position%20%7C%7C%20geometry.morphAttributes.normal%20%7C%7C%20geometry.morphAttributes.color%3B%0A%20%20%20%20const%20morphTargetsCount%20%3D%20morphAttribute%20%21%3D%3D%20void%200%20%3F%20morphAttribute.length%20%3A%200%3B%0A%20%20%20%20const%20%7B%20texture%3A%20bufferMap%2C%20stride%2C%20size%20%7D%20%3D%20getEntry%28geometry%29%3B%0A%20%20%20%20if%20%28hasMorphPosition%20%3D%3D%3D%20true%29%20positionLocal.mulAssign%28this.morphBaseInfluence%29%3B%0A%20%20%20%20if%20%28hasMorphNormals%20%3D%3D%3D%20true%29%20normalLocal.mulAssign%28this.morphBaseInfluence%29%3B%0A%20%20%20%20const%20width%20%3D%20int%28size.width%29%3B%0A%20%20%20%20Loop%28morphTargetsCount%2C%20%28%7B%20i%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20influence%20%3D%20float%280%29.toVar%28%29%3B%0A%20%20%20%20%20%20if%20%28this.mesh.count%20%3E%201%20%26%26%20%28this.mesh.morphTexture%20%21%3D%3D%20null%20%26%26%20this.mesh.morphTexture%20%21%3D%3D%20void%200%29%29%20%7B%0A%20%20%20%20%20%20%20%20influence.assign%28textureLoad%28this.mesh.morphTexture%2C%20ivec2%28int%28i%29.add%281%29%2C%20int%28instanceIndex%29%29%29.r%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20influence.assign%28reference%28%22morphTargetInfluences%22%2C%20%22float%22%29.element%28i%29.toVar%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28hasMorphPosition%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20positionLocal.addAssign%28getMorph%28%7B%0A%20%20%20%20%20%20%20%20%20%20bufferMap%2C%0A%20%20%20%20%20%20%20%20%20%20influence%2C%0A%20%20%20%20%20%20%20%20%20%20stride%2C%0A%20%20%20%20%20%20%20%20%20%20width%2C%0A%20%20%20%20%20%20%20%20%20%20depth%3A%20i%2C%0A%20%20%20%20%20%20%20%20%20%20offset%3A%20int%280%29%0A%20%20%20%20%20%20%20%20%7D%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28hasMorphNormals%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20normalLocal.addAssign%28getMorph%28%7B%0A%20%20%20%20%20%20%20%20%20%20bufferMap%2C%0A%20%20%20%20%20%20%20%20%20%20influence%2C%0A%20%20%20%20%20%20%20%20%20%20stride%2C%0A%20%20%20%20%20%20%20%20%20%20width%2C%0A%20%20%20%20%20%20%20%20%20%20depth%3A%20i%2C%0A%20%20%20%20%20%20%20%20%20%20offset%3A%20int%281%29%0A%20%20%20%20%20%20%20%20%7D%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20const%20morphBaseInfluence%20%3D%20this.morphBaseInfluence%3B%0A%20%20%20%20if%20%28this.mesh.geometry.morphTargetsRelative%29%20%7B%0A%20%20%20%20%20%20morphBaseInfluence.value%20%3D%201%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20morphBaseInfluence.value%20%3D%201%20-%20this.mesh.morphTargetInfluences.reduce%28%28a2%2C%20b%29%20%3D%3E%20a2%20%2B%20b%2C%200%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20morphReference%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28MorphNode%29%3B%0Avar%20LightingNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LightingNode%22%3B%0A%20%20%7D%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%22vec3%22%29%3B%0A%20%20%20%20this.isLightingNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20generate%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20AONode%20%3D%20class%20extends%20LightingNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22AONode%22%3B%0A%20%20%7D%0A%20%20constructor%28aoNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.aoNode%20%3D%20aoNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20builder.context.ambientOcclusion.mulAssign%28this.aoNode%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LightingContextNode%20%3D%20class%20extends%20ContextNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LightingContextNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%2C%20lightingModel%20%3D%20null%2C%20backdropNode%20%3D%20null%2C%20backdropAlphaNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28node%29%3B%0A%20%20%20%20this.lightingModel%20%3D%20lightingModel%3B%0A%20%20%20%20this.backdropNode%20%3D%20backdropNode%3B%0A%20%20%20%20this.backdropAlphaNode%20%3D%20backdropAlphaNode%3B%0A%20%20%20%20this._value%20%3D%20null%3B%0A%20%20%7D%0A%20%20getContext%28%29%20%7B%0A%20%20%20%20const%20%7B%20backdropNode%2C%20backdropAlphaNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20directDiffuse%20%3D%20vec3%28%29.toVar%28%22directDiffuse%22%29%2C%20directSpecular%20%3D%20vec3%28%29.toVar%28%22directSpecular%22%29%2C%20indirectDiffuse%20%3D%20vec3%28%29.toVar%28%22indirectDiffuse%22%29%2C%20indirectSpecular%20%3D%20vec3%28%29.toVar%28%22indirectSpecular%22%29%3B%0A%20%20%20%20const%20reflectedLight%20%3D%20%7B%0A%20%20%20%20%20%20directDiffuse%2C%0A%20%20%20%20%20%20directSpecular%2C%0A%20%20%20%20%20%20indirectDiffuse%2C%0A%20%20%20%20%20%20indirectSpecular%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20context2%20%3D%20%7B%0A%20%20%20%20%20%20radiance%3A%20vec3%28%29.toVar%28%22radiance%22%29%2C%0A%20%20%20%20%20%20irradiance%3A%20vec3%28%29.toVar%28%22irradiance%22%29%2C%0A%20%20%20%20%20%20iblIrradiance%3A%20vec3%28%29.toVar%28%22iblIrradiance%22%29%2C%0A%20%20%20%20%20%20ambientOcclusion%3A%20float%281%29.toVar%28%22ambientOcclusion%22%29%2C%0A%20%20%20%20%20%20reflectedLight%2C%0A%20%20%20%20%20%20backdrop%3A%20backdropNode%2C%0A%20%20%20%20%20%20backdropAlpha%3A%20backdropAlphaNode%0A%20%20%20%20%7D%3B%0A%20%20%20%20return%20context2%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20this.value%20%3D%20this._value%20%7C%7C%20%28this._value%20%3D%20this.getContext%28%29%29%3B%0A%20%20%20%20this.value.lightingModel%20%3D%20this.lightingModel%20%7C%7C%20builder.context.lightingModel%3B%0A%20%20%20%20return%20super.setup%28builder%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20lightingContext%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28LightingContextNode%29%3B%0Avar%20IrradianceNode%20%3D%20class%20extends%20LightingNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22IrradianceNode%22%3B%0A%20%20%7D%0A%20%20constructor%28node%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20builder.context.irradiance.addAssign%28this.node%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20screenSizeVec%3B%0Avar%20viewportVec%3B%0Avar%20ScreenNode%20%3D%20class%20_ScreenNode%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ScreenNode%22%3B%0A%20%20%7D%0A%20%20constructor%28scope%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.scope%20%3D%20scope%3B%0A%20%20%20%20this.isViewportNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getNodeType%28%29%20%7B%0A%20%20%20%20if%20%28this.scope%20%3D%3D%3D%20_ScreenNode.VIEWPORT%29%20return%20%22vec4%22%3B%0A%20%20%20%20else%20return%20%22vec2%22%3B%0A%20%20%7D%0A%20%20getUpdateType%28%29%20%7B%0A%20%20%20%20let%20updateType%20%3D%20NodeUpdateType.NONE%3B%0A%20%20%20%20if%20%28this.scope%20%3D%3D%3D%20_ScreenNode.SIZE%20%7C%7C%20this.scope%20%3D%3D%3D%20_ScreenNode.VIEWPORT%29%20%7B%0A%20%20%20%20%20%20updateType%20%3D%20NodeUpdateType.RENDER%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.updateType%20%3D%20updateType%3B%0A%20%20%20%20return%20updateType%3B%0A%20%20%7D%0A%20%20update%28%7B%20renderer%3A%20renderer3%20%7D%29%20%7B%0A%20%20%20%20const%20renderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20if%20%28this.scope%20%3D%3D%3D%20_ScreenNode.VIEWPORT%29%20%7B%0A%20%20%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20viewportVec.copy%28renderTarget.viewport%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20renderer3.getViewport%28viewportVec%29%3B%0A%20%20%20%20%20%20%20%20viewportVec.multiplyScalar%28renderer3.getPixelRatio%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20screenSizeVec.width%20%3D%20renderTarget.width%3B%0A%20%20%20%20%20%20%20%20screenSizeVec.height%20%3D%20renderTarget.height%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20renderer3.getDrawingBufferSize%28screenSizeVec%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20const%20scope%20%3D%20this.scope%3B%0A%20%20%20%20let%20output2%20%3D%20null%3B%0A%20%20%20%20if%20%28scope%20%3D%3D%3D%20_ScreenNode.SIZE%29%20%7B%0A%20%20%20%20%20%20output2%20%3D%20uniform%28screenSizeVec%20%7C%7C%20%28screenSizeVec%20%3D%20new%20Vector22%28%29%29%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_ScreenNode.VIEWPORT%29%20%7B%0A%20%20%20%20%20%20output2%20%3D%20uniform%28viewportVec%20%7C%7C%20%28viewportVec%20%3D%20new%20Vector42%28%29%29%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20output2%20%3D%20vec2%28screenCoordinate.div%28screenSize%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20if%20%28this.scope%20%3D%3D%3D%20_ScreenNode.COORDINATE%29%20%7B%0A%20%20%20%20%20%20let%20coord%20%3D%20builder.getFragCoord%28%29%3B%0A%20%20%20%20%20%20if%20%28builder.isFlipY%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20const%20size%20%3D%20builder.getNodeProperties%28screenSize%29.outputNode.build%28builder%29%3B%0A%20%20%20%20%20%20%20%20coord%20%3D%20%60%24%7Bbuilder.getType%28%22vec2%22%29%7D%28%20%24%7Bcoord%7D.x%2C%20%24%7Bsize%7D.y%20-%20%24%7Bcoord%7D.y%20%29%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20coord%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20super.generate%28builder%29%3B%0A%20%20%7D%0A%7D%3B%0AScreenNode.COORDINATE%20%3D%20%22coordinate%22%3B%0AScreenNode.VIEWPORT%20%3D%20%22viewport%22%3B%0AScreenNode.SIZE%20%3D%20%22size%22%3B%0AScreenNode.UV%20%3D%20%22uv%22%3B%0Avar%20screenUV%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ScreenNode%2C%20ScreenNode.UV%29%3B%0Avar%20screenSize%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ScreenNode%2C%20ScreenNode.SIZE%29%3B%0Avar%20screenCoordinate%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ScreenNode%2C%20ScreenNode.COORDINATE%29%3B%0Avar%20viewport%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ScreenNode%2C%20ScreenNode.VIEWPORT%29%3B%0Avar%20viewportSize%20%3D%20viewport.zw%3B%0Avar%20viewportCoordinate%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20screenCoordinate.sub%28viewport.xy%29%3B%0Avar%20_size%244%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector22%28%29%3B%0Avar%20ViewportTextureNode%20%3D%20class%20extends%20TextureNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ViewportTextureNode%22%3B%0A%20%20%7D%0A%20%20constructor%28uvNode%20%3D%20screenUV%2C%20levelNode%20%3D%20null%2C%20framebufferTexture%20%3D%20null%29%20%7B%0A%20%20%20%20if%20%28framebufferTexture%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20framebufferTexture%20%3D%20new%20FramebufferTexture%28%29%3B%0A%20%20%20%20%20%20framebufferTexture.minFilter%20%3D%20LinearMipmapLinearFilter2%3B%0A%20%20%20%20%7D%0A%20%20%20%20super%28framebufferTexture%2C%20uvNode%2C%20levelNode%29%3B%0A%20%20%20%20this.generateMipmaps%20%3D%20false%3B%0A%20%20%20%20this.isOutputTextureNode%20%3D%20true%3B%0A%20%20%20%20this.updateBeforeType%20%3D%20NodeUpdateType.FRAME%3B%0A%20%20%7D%0A%20%20updateBefore%28frame2%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20frame2.renderer%3B%0A%20%20%20%20renderer3.getDrawingBufferSize%28_size%244%29%3B%0A%20%20%20%20const%20framebufferTexture%20%3D%20this.value%3B%0A%20%20%20%20if%20%28framebufferTexture.image.width%20%21%3D%3D%20_size%244.width%20%7C%7C%20framebufferTexture.image.height%20%21%3D%3D%20_size%244.height%29%20%7B%0A%20%20%20%20%20%20framebufferTexture.image.width%20%3D%20_size%244.width%3B%0A%20%20%20%20%20%20framebufferTexture.image.height%20%3D%20_size%244.height%3B%0A%20%20%20%20%20%20framebufferTexture.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20currentGenerateMipmaps%20%3D%20framebufferTexture.generateMipmaps%3B%0A%20%20%20%20framebufferTexture.generateMipmaps%20%3D%20this.generateMipmaps%3B%0A%20%20%20%20renderer3.copyFramebufferToTexture%28framebufferTexture%29%3B%0A%20%20%20%20framebufferTexture.generateMipmaps%20%3D%20currentGenerateMipmaps%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20const%20viewportTextureNode%20%3D%20new%20this.constructor%28this.uvNode%2C%20this.levelNode%2C%20this.value%29%3B%0A%20%20%20%20viewportTextureNode.generateMipmaps%20%3D%20this.generateMipmaps%3B%0A%20%20%20%20return%20viewportTextureNode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20viewportMipTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28ViewportTextureNode%2C%20null%2C%20null%2C%20%7B%20generateMipmaps%3A%20true%20%7D%29%3B%0Avar%20sharedDepthbuffer%20%3D%20null%3B%0Avar%20ViewportDepthTextureNode%20%3D%20class%20extends%20ViewportTextureNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ViewportDepthTextureNode%22%3B%0A%20%20%7D%0A%20%20constructor%28uvNode%20%3D%20screenUV%2C%20levelNode%20%3D%20null%29%20%7B%0A%20%20%20%20if%20%28sharedDepthbuffer%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20sharedDepthbuffer%20%3D%20new%20DepthTexture2%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20super%28uvNode%2C%20levelNode%2C%20sharedDepthbuffer%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20viewportDepthTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28ViewportDepthTextureNode%29%3B%0Avar%20ViewportDepthNode%20%3D%20class%20_ViewportDepthNode%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ViewportDepthNode%22%3B%0A%20%20%7D%0A%20%20constructor%28scope%2C%20valueNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%22float%22%29%3B%0A%20%20%20%20this.scope%20%3D%20scope%3B%0A%20%20%20%20this.valueNode%20%3D%20valueNode%3B%0A%20%20%20%20this.isViewportDepthNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20scope%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28scope%20%3D%3D%3D%20_ViewportDepthNode.DEPTH_BASE%29%20%7B%0A%20%20%20%20%20%20return%20builder.getFragDepth%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20super.generate%28builder%29%3B%0A%20%20%7D%0A%20%20setup%28%7B%20camera%3A%20camera3%20%7D%29%20%7B%0A%20%20%20%20const%20%7B%20scope%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20value%20%3D%20this.valueNode%3B%0A%20%20%20%20let%20node%20%3D%20null%3B%0A%20%20%20%20if%20%28scope%20%3D%3D%3D%20_ViewportDepthNode.DEPTH_BASE%29%20%7B%0A%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20depthBase%28%29.assign%28value%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_ViewportDepthNode.DEPTH%29%20%7B%0A%20%20%20%20%20%20if%20%28camera3.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20viewZToPerspectiveDepth%28positionView.z%2C%20cameraNear%2C%20cameraFar%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20viewZToOrthographicDepth%28positionView.z%2C%20cameraNear%2C%20cameraFar%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_ViewportDepthNode.LINEAR_DEPTH%29%20%7B%0A%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28camera3.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20viewZ%20%3D%20perspectiveDepthToViewZ%28value%2C%20cameraNear%2C%20cameraFar%29%3B%0A%20%20%20%20%20%20%20%20%20%20node%20%3D%20viewZToOrthographicDepth%28viewZ%2C%20cameraNear%2C%20cameraFar%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20node%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20node%20%3D%20viewZToOrthographicDepth%28positionView.z%2C%20cameraNear%2C%20cameraFar%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%7D%3B%0AViewportDepthNode.DEPTH_BASE%20%3D%20%22depthBase%22%3B%0AViewportDepthNode.DEPTH%20%3D%20%22depth%22%3B%0AViewportDepthNode.LINEAR_DEPTH%20%3D%20%22linearDepth%22%3B%0Avar%20viewZToOrthographicDepth%20%3D%20%28viewZ%2C%20near%2C%20far%29%20%3D%3E%20viewZ.add%28near%29.div%28near.sub%28far%29%29%3B%0Avar%20viewZToPerspectiveDepth%20%3D%20%28viewZ%2C%20near%2C%20far%29%20%3D%3E%20near.add%28viewZ%29.mul%28far%29.div%28far.sub%28near%29.mul%28viewZ%29%29%3B%0Avar%20perspectiveDepthToViewZ%20%3D%20%28depth2%2C%20near%2C%20far%29%20%3D%3E%20near.mul%28far%29.div%28far.sub%28near%29.mul%28depth2%29.sub%28far%29%29%3B%0Avar%20perspectiveDepthToLogarithmicDepth%20%3D%20%28perspectiveW%2C%20near%2C%20far%29%20%3D%3E%20%7B%0A%20%20near%20%3D%20near.max%281e-6%29.toVar%28%29%3B%0A%20%20const%20numerator%20%3D%20log2%28perspectiveW.div%28near%29.add%281%29%29%3B%0A%20%20const%20denominator%20%3D%20log2%28far.div%28near%29.add%281%29%29%3B%0A%20%20return%20numerator.div%28denominator%29%3B%0A%7D%3B%0Avar%20depthBase%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28ViewportDepthNode%2C%20ViewportDepthNode.DEPTH_BASE%29%3B%0Avar%20depth%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28ViewportDepthNode%2C%20ViewportDepthNode.DEPTH%29%3B%0Avar%20linearDepth%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28ViewportDepthNode%2C%20ViewportDepthNode.LINEAR_DEPTH%29%3B%0Avar%20viewportLinearDepth%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20linearDepth%28viewportDepthTexture%28%29%29%3B%0Adepth.assign%20%3D%20%28value%29%20%3D%3E%20depthBase%28value%29%3B%0Avar%20ClippingNode%20%3D%20class%20_ClippingNode%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ClippingNode%22%3B%0A%20%20%7D%0A%20%20constructor%28scope%20%3D%20_ClippingNode.DEFAULT%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.scope%20%3D%20scope%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20super.setup%28builder%29%3B%0A%20%20%20%20const%20clippingContext%20%3D%20builder.clippingContext%3B%0A%20%20%20%20const%20%7B%20localClipIntersection%2C%20localClippingCount%2C%20globalClippingCount%20%7D%20%3D%20clippingContext%3B%0A%20%20%20%20const%20numClippingPlanes%20%3D%20globalClippingCount%20%2B%20localClippingCount%3B%0A%20%20%20%20const%20numUnionClippingPlanes%20%3D%20localClipIntersection%20%3F%20numClippingPlanes%20-%20localClippingCount%20%3A%20numClippingPlanes%3B%0A%20%20%20%20if%20%28this.scope%20%3D%3D%3D%20_ClippingNode.ALPHA_TO_COVERAGE%29%20%7B%0A%20%20%20%20%20%20return%20this.setupAlphaToCoverage%28clippingContext.planes%2C%20numClippingPlanes%2C%20numUnionClippingPlanes%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20this.setupDefault%28clippingContext.planes%2C%20numClippingPlanes%2C%20numUnionClippingPlanes%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setupAlphaToCoverage%28planes%2C%20numClippingPlanes%2C%20numUnionClippingPlanes%29%20%7B%0A%20%20%20%20return%20Fn%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20clippingPlanes%20%3D%20uniformArray%28planes%29%3B%0A%20%20%20%20%20%20const%20distanceToPlane%20%3D%20property%28%22float%22%2C%20%22distanceToPlane%22%29%3B%0A%20%20%20%20%20%20const%20distanceGradient%20%3D%20property%28%22float%22%2C%20%22distanceToGradient%22%29%3B%0A%20%20%20%20%20%20const%20clipOpacity%20%3D%20property%28%22float%22%2C%20%22clipOpacity%22%29%3B%0A%20%20%20%20%20%20clipOpacity.assign%281%29%3B%0A%20%20%20%20%20%20let%20plane%3B%0A%20%20%20%20%20%20Loop%28numUnionClippingPlanes%2C%20%28%7B%20i%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20plane%20%3D%20clippingPlanes.element%28i%29%3B%0A%20%20%20%20%20%20%20%20distanceToPlane.assign%28positionView.dot%28plane.xyz%29.negate%28%29.add%28plane.w%29%29%3B%0A%20%20%20%20%20%20%20%20distanceGradient.assign%28distanceToPlane.fwidth%28%29.div%282%29%29%3B%0A%20%20%20%20%20%20%20%20clipOpacity.mulAssign%28smoothstep2%28distanceGradient.negate%28%29%2C%20distanceGradient%2C%20distanceToPlane%29%29%3B%0A%20%20%20%20%20%20%20%20clipOpacity.equal%280%29.discard%28%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20if%20%28numUnionClippingPlanes%20%3C%20numClippingPlanes%29%20%7B%0A%20%20%20%20%20%20%20%20const%20unionClipOpacity%20%3D%20property%28%22float%22%2C%20%22unionclipOpacity%22%29%3B%0A%20%20%20%20%20%20%20%20unionClipOpacity.assign%281%29%3B%0A%20%20%20%20%20%20%20%20Loop%28%7B%20start%3A%20numUnionClippingPlanes%2C%20end%3A%20numClippingPlanes%20%7D%2C%20%28%7B%20i%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20plane%20%3D%20clippingPlanes.element%28i%29%3B%0A%20%20%20%20%20%20%20%20%20%20distanceToPlane.assign%28positionView.dot%28plane.xyz%29.negate%28%29.add%28plane.w%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20distanceGradient.assign%28distanceToPlane.fwidth%28%29.div%282%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20unionClipOpacity.mulAssign%28smoothstep2%28distanceGradient.negate%28%29%2C%20distanceGradient%2C%20distanceToPlane%29.oneMinus%28%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20clipOpacity.mulAssign%28unionClipOpacity.oneMinus%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20diffuseColor.a.mulAssign%28clipOpacity%29%3B%0A%20%20%20%20%20%20diffuseColor.a.equal%280%29.discard%28%29%3B%0A%20%20%20%20%7D%29%28%29%3B%0A%20%20%7D%0A%20%20setupDefault%28planes%2C%20numClippingPlanes%2C%20numUnionClippingPlanes%29%20%7B%0A%20%20%20%20return%20Fn%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20clippingPlanes%20%3D%20uniformArray%28planes%29%3B%0A%20%20%20%20%20%20let%20plane%3B%0A%20%20%20%20%20%20Loop%28numUnionClippingPlanes%2C%20%28%7B%20i%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20plane%20%3D%20clippingPlanes.element%28i%29%3B%0A%20%20%20%20%20%20%20%20positionView.dot%28plane.xyz%29.greaterThan%28plane.w%29.discard%28%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20if%20%28numUnionClippingPlanes%20%3C%20numClippingPlanes%29%20%7B%0A%20%20%20%20%20%20%20%20const%20clipped%20%3D%20property%28%22bool%22%2C%20%22clipped%22%29%3B%0A%20%20%20%20%20%20%20%20clipped.assign%28true%29%3B%0A%20%20%20%20%20%20%20%20Loop%28%7B%20start%3A%20numUnionClippingPlanes%2C%20end%3A%20numClippingPlanes%20%7D%2C%20%28%7B%20i%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20plane%20%3D%20clippingPlanes.element%28i%29%3B%0A%20%20%20%20%20%20%20%20%20%20clipped.assign%28positionView.dot%28plane.xyz%29.greaterThan%28plane.w%29.and%28clipped%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20clipped.discard%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%28%29%3B%0A%20%20%7D%0A%7D%3B%0AClippingNode.ALPHA_TO_COVERAGE%20%3D%20%22alphaToCoverage%22%3B%0AClippingNode.DEFAULT%20%3D%20%22default%22%3B%0Avar%20clipping%20%3D%20%28%29%20%3D%3E%20nodeObject%28new%20ClippingNode%28%29%29%3B%0Avar%20clippingAlpha%20%3D%20%28%29%20%3D%3E%20nodeObject%28new%20ClippingNode%28ClippingNode.ALPHA_TO_COVERAGE%29%29%3B%0Avar%20ALPHA_HASH_SCALE%20%3D%200.05%3B%0Avar%20hash2D%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bvalue%5D%29%20%3D%3E%20%7B%0A%20%20return%20fract%28mul%281e4%2C%20sin%28mul%2817%2C%20value.x%29.add%28mul%280.1%2C%20value.y%29%29%29%29.mul%28add4%280.1%2C%20abs%28sin%28mul%2813%2C%20value.y%29.add%28value.x%29%29%29%29%29%29%3B%0A%7D%29%3B%0Avar%20hash3D%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bvalue%5D%29%20%3D%3E%20%7B%0A%20%20return%20hash2D%28vec2%28hash2D%28value.xy%29%2C%20value.z%29%29%3B%0A%7D%29%3B%0Avar%20getAlphaHashThreshold%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bposition%5D%29%20%3D%3E%20%7B%0A%20%20const%20maxDeriv%20%3D%20max%241%28%0A%20%20%20%20length%28dFdx%28position.xyz%29%29%2C%0A%20%20%20%20length%28dFdy%28position.xyz%29%29%0A%20%20%29.toVar%28%22maxDeriv%22%29%3B%0A%20%20const%20pixScale%20%3D%20float%281%29.div%28float%28ALPHA_HASH_SCALE%29.mul%28maxDeriv%29%29.toVar%28%22pixScale%22%29%3B%0A%20%20const%20pixScales%20%3D%20vec2%28%0A%20%20%20%20exp2%28floor%28log2%28pixScale%29%29%29%2C%0A%20%20%20%20exp2%28ceil%28log2%28pixScale%29%29%29%0A%20%20%29.toVar%28%22pixScales%22%29%3B%0A%20%20const%20alpha%20%3D%20vec2%28%0A%20%20%20%20hash3D%28floor%28pixScales.x.mul%28position.xyz%29%29%29%2C%0A%20%20%20%20hash3D%28floor%28pixScales.y.mul%28position.xyz%29%29%29%0A%20%20%29.toVar%28%22alpha%22%29%3B%0A%20%20const%20lerpFactor%20%3D%20fract%28log2%28pixScale%29%29.toVar%28%22lerpFactor%22%29%3B%0A%20%20const%20x2%20%3D%20add4%28mul%28lerpFactor.oneMinus%28%29%2C%20alpha.x%29%2C%20mul%28lerpFactor%2C%20alpha.y%29%29.toVar%28%22x%22%29%3B%0A%20%20const%20a2%20%3D%20min%241%28lerpFactor%2C%20lerpFactor.oneMinus%28%29%29.toVar%28%22a%22%29%3B%0A%20%20const%20cases%20%3D%20vec3%28%0A%20%20%20%20x2.mul%28x2%29.div%28mul%282%2C%20a2%29.mul%28sub%281%2C%20a2%29%29%29%2C%0A%20%20%20%20x2.sub%28mul%280.5%2C%20a2%29%29.div%28sub%281%2C%20a2%29%29%2C%0A%20%20%20%20sub%281%2C%20sub%281%2C%20x2%29.mul%28sub%281%2C%20x2%29%29.div%28mul%282%2C%20a2%29.mul%28sub%281%2C%20a2%29%29%29%29%0A%20%20%29.toVar%28%22cases%22%29%3B%0A%20%20const%20threshold%20%3D%20x2.lessThan%28a2.oneMinus%28%29%29.select%28x2.lessThan%28a2%29.select%28cases.x%2C%20cases.y%29%2C%20cases.z%29%3B%0A%20%20return%20clamp2%28threshold%2C%201e-6%2C%201%29%3B%0A%7D%29%3B%0Avar%20NodeMaterial%20%3D%20class%20extends%20Material2%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22NodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.type%20%3D%20this.constructor.type%3B%0A%20%20%20%20this.forceSinglePass%20%3D%20false%3B%0A%20%20%20%20this.fog%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20false%3B%0A%20%20%20%20this.lightsNode%20%3D%20null%3B%0A%20%20%20%20this.envNode%20%3D%20null%3B%0A%20%20%20%20this.aoNode%20%3D%20null%3B%0A%20%20%20%20this.colorNode%20%3D%20null%3B%0A%20%20%20%20this.normalNode%20%3D%20null%3B%0A%20%20%20%20this.opacityNode%20%3D%20null%3B%0A%20%20%20%20this.backdropNode%20%3D%20null%3B%0A%20%20%20%20this.backdropAlphaNode%20%3D%20null%3B%0A%20%20%20%20this.alphaTestNode%20%3D%20null%3B%0A%20%20%20%20this.positionNode%20%3D%20null%3B%0A%20%20%20%20this.geometryNode%20%3D%20null%3B%0A%20%20%20%20this.depthNode%20%3D%20null%3B%0A%20%20%20%20this.shadowNode%20%3D%20null%3B%0A%20%20%20%20this.shadowPositionNode%20%3D%20null%3B%0A%20%20%20%20this.outputNode%20%3D%20null%3B%0A%20%20%20%20this.mrtNode%20%3D%20null%3B%0A%20%20%20%20this.fragmentNode%20%3D%20null%3B%0A%20%20%20%20this.vertexNode%20%3D%20null%3B%0A%20%20%7D%0A%20%20customProgramCacheKey%28%29%20%7B%0A%20%20%20%20return%20this.type%20%2B%20getCacheKey%241%28this%29%3B%0A%20%20%7D%0A%20%20build%28builder%29%20%7B%0A%20%20%20%20this.setup%28builder%29%3B%0A%20%20%7D%0A%20%20setupObserver%28builder%29%20%7B%0A%20%20%20%20return%20new%20NodeMaterialObserver%28builder%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20builder.context.setupNormal%20%3D%20%28%29%20%3D%3E%20this.setupNormal%28builder%29%3B%0A%20%20%20%20builder.addStack%28%29%3B%0A%20%20%20%20builder.stack.outputNode%20%3D%20this.vertexNode%20%7C%7C%20this.setupPosition%28builder%29%3B%0A%20%20%20%20if%20%28this.geometryNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20builder.stack.outputNode%20%3D%20builder.stack.outputNode.bypass%28this.geometryNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20builder.addFlow%28%22vertex%22%2C%20builder.removeStack%28%29%29%3B%0A%20%20%20%20builder.addStack%28%29%3B%0A%20%20%20%20let%20resultNode%3B%0A%20%20%20%20const%20clippingNode%20%3D%20this.setupClipping%28builder%29%3B%0A%20%20%20%20if%20%28this.depthWrite%20%3D%3D%3D%20true%29%20this.setupDepth%28builder%29%3B%0A%20%20%20%20if%20%28this.fragmentNode%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.setupDiffuseColor%28builder%29%3B%0A%20%20%20%20%20%20this.setupVariants%28builder%29%3B%0A%20%20%20%20%20%20const%20outgoingLightNode%20%3D%20this.setupLighting%28builder%29%3B%0A%20%20%20%20%20%20if%20%28clippingNode%20%21%3D%3D%20null%29%20builder.stack.add%28clippingNode%29%3B%0A%20%20%20%20%20%20const%20basicOutput%20%3D%20vec4%28outgoingLightNode%2C%20diffuseColor.a%29.max%280%29%3B%0A%20%20%20%20%20%20resultNode%20%3D%20this.setupOutput%28builder%2C%20basicOutput%29%3B%0A%20%20%20%20%20%20output.assign%28resultNode%29%3B%0A%20%20%20%20%20%20if%20%28this.outputNode%20%21%3D%3D%20null%29%20resultNode%20%3D%20this.outputNode%3B%0A%20%20%20%20%20%20const%20renderTarget%20%3D%20builder.renderer.getRenderTarget%28%29%3B%0A%20%20%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20const%20mrt%20%3D%20builder.renderer.getMRT%28%29%3B%0A%20%20%20%20%20%20%20%20const%20materialMRT%20%3D%20this.mrtNode%3B%0A%20%20%20%20%20%20%20%20if%20%28mrt%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20resultNode%20%3D%20mrt%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28materialMRT%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20resultNode%20%3D%20mrt.merge%28materialMRT%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28materialMRT%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20resultNode%20%3D%20materialMRT%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20let%20fragmentNode%20%3D%20this.fragmentNode%3B%0A%20%20%20%20%20%20if%20%28fragmentNode.isOutputStructNode%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20fragmentNode%20%3D%20vec4%28fragmentNode%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20resultNode%20%3D%20this.setupOutput%28builder%2C%20fragmentNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20builder.stack.outputNode%20%3D%20resultNode%3B%0A%20%20%20%20builder.addFlow%28%22fragment%22%2C%20builder.removeStack%28%29%29%3B%0A%20%20%20%20builder.monitor%20%3D%20this.setupObserver%28builder%29%3B%0A%20%20%7D%0A%20%20setupClipping%28builder%29%20%7B%0A%20%20%20%20if%20%28builder.clippingContext%20%3D%3D%3D%20null%29%20return%20null%3B%0A%20%20%20%20const%20%7B%20globalClippingCount%2C%20localClippingCount%20%7D%20%3D%20builder.clippingContext%3B%0A%20%20%20%20let%20result%20%3D%20null%3B%0A%20%20%20%20if%20%28globalClippingCount%20%7C%7C%20localClippingCount%29%20%7B%0A%20%20%20%20%20%20const%20samples%20%3D%20builder.renderer.samples%3B%0A%20%20%20%20%20%20if%20%28this.alphaToCoverage%20%26%26%20samples%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20result%20%3D%20clippingAlpha%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20builder.stack.add%28clipping%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20setupDepth%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20renderer%3A%20renderer3%2C%20camera%3A%20camera3%20%7D%20%3D%20builder%3B%0A%20%20%20%20let%20depthNode%20%3D%20this.depthNode%3B%0A%20%20%20%20if%20%28depthNode%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20mrt%20%3D%20renderer3.getMRT%28%29%3B%0A%20%20%20%20%20%20if%20%28mrt%20%26%26%20mrt.has%28%22depth%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20depthNode%20%3D%20mrt.get%28%22depth%22%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28renderer3.logarithmicDepthBuffer%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28camera3.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20depthNode%20%3D%20perspectiveDepthToLogarithmicDepth%28modelViewProjection%28%29.w%2C%20cameraNear%2C%20cameraFar%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20depthNode%20%3D%20viewZToOrthographicDepth%28positionView.z%2C%20cameraNear%2C%20cameraFar%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28depthNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20depth.assign%28depthNode%29.append%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setupPosition%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20object%20%7D%20%3D%20builder%3B%0A%20%20%20%20const%20geometry%20%3D%20object.geometry%3B%0A%20%20%20%20builder.addStack%28%29%3B%0A%20%20%20%20if%20%28geometry.morphAttributes.position%20%7C%7C%20geometry.morphAttributes.normal%20%7C%7C%20geometry.morphAttributes.color%29%20%7B%0A%20%20%20%20%20%20morphReference%28object%29.append%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isSkinnedMesh%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20skinningReference%28object%29.append%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.displacementMap%29%20%7B%0A%20%20%20%20%20%20const%20displacementMap%20%3D%20materialReference%28%22displacementMap%22%2C%20%22texture%22%29%3B%0A%20%20%20%20%20%20const%20displacementScale%20%3D%20materialReference%28%22displacementScale%22%2C%20%22float%22%29%3B%0A%20%20%20%20%20%20const%20displacementBias%20%3D%20materialReference%28%22displacementBias%22%2C%20%22float%22%29%3B%0A%20%20%20%20%20%20positionLocal.addAssign%28normalLocal.normalize%28%29.mul%28displacementMap.x.mul%28displacementScale%29.add%28displacementBias%29%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isBatchedMesh%29%20%7B%0A%20%20%20%20%20%20batch%28object%29.append%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.instanceMatrix%20%26%26%20object.instanceMatrix.isInstancedBufferAttribute%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20instance%28object%29.append%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.positionNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20positionLocal.assign%28this.positionNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20mvp%20%3D%20modelViewProjection%28%29%3B%0A%20%20%20%20builder.context.vertex%20%3D%20builder.removeStack%28%29%3B%0A%20%20%20%20builder.context.mvp%20%3D%20mvp%3B%0A%20%20%20%20return%20mvp%3B%0A%20%20%7D%0A%20%20setupDiffuseColor%28%7B%20object%2C%20geometry%20%7D%29%20%7B%0A%20%20%20%20let%20colorNode%20%3D%20this.colorNode%20%3F%20vec4%28this.colorNode%29%20%3A%20materialColor%3B%0A%20%20%20%20if%20%28this.vertexColors%20%3D%3D%3D%20true%20%26%26%20geometry.hasAttribute%28%22color%22%29%29%20%7B%0A%20%20%20%20%20%20colorNode%20%3D%20vec4%28colorNode.xyz.mul%28attribute%28%22color%22%2C%20%22vec3%22%29%29%2C%20colorNode.a%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.instanceColor%29%20%7B%0A%20%20%20%20%20%20const%20instanceColor%20%3D%20varyingProperty%28%22vec3%22%2C%20%22vInstanceColor%22%29%3B%0A%20%20%20%20%20%20colorNode%20%3D%20instanceColor.mul%28colorNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isBatchedMesh%20%26%26%20object._colorsTexture%29%20%7B%0A%20%20%20%20%20%20const%20batchColor%20%3D%20varyingProperty%28%22vec3%22%2C%20%22vBatchColor%22%29%3B%0A%20%20%20%20%20%20colorNode%20%3D%20batchColor.mul%28colorNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20diffuseColor.assign%28colorNode%29%3B%0A%20%20%20%20const%20opacityNode%20%3D%20this.opacityNode%20%3F%20float%28this.opacityNode%29%20%3A%20materialOpacity%3B%0A%20%20%20%20diffuseColor.a.assign%28diffuseColor.a.mul%28opacityNode%29%29%3B%0A%20%20%20%20if%20%28this.alphaTestNode%20%21%3D%3D%20null%20%7C%7C%20this.alphaTest%20%3E%200%29%20%7B%0A%20%20%20%20%20%20const%20alphaTestNode%20%3D%20this.alphaTestNode%20%21%3D%3D%20null%20%3F%20float%28this.alphaTestNode%29%20%3A%20materialAlphaTest%3B%0A%20%20%20%20%20%20diffuseColor.a.lessThanEqual%28alphaTestNode%29.discard%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.alphaHash%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20diffuseColor.a.lessThan%28getAlphaHashThreshold%28positionLocal%29%29.discard%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.transparent%20%3D%3D%3D%20false%20%26%26%20this.blending%20%3D%3D%3D%20NormalBlending2%20%26%26%20this.alphaToCoverage%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20diffuseColor.a.assign%281%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setupVariants%28%29%20%7B%0A%20%20%7D%0A%20%20setupOutgoingLight%28%29%20%7B%0A%20%20%20%20return%20this.lights%20%3D%3D%3D%20true%20%3F%20vec3%280%29%20%3A%20diffuseColor.rgb%3B%0A%20%20%7D%0A%20%20setupNormal%28%29%20%7B%0A%20%20%20%20return%20this.normalNode%20%3F%20vec3%28this.normalNode%29%20%3A%20materialNormal%3B%0A%20%20%7D%0A%20%20setupEnvironment%28%29%20%7B%0A%20%20%20%20let%20node%20%3D%20null%3B%0A%20%20%20%20if%20%28this.envNode%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20this.envNode%3B%0A%20%20%20%20%7D%20else%20if%20%28this.envMap%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20this.envMap.isCubeTexture%20%3F%20materialReference%28%22envMap%22%2C%20%22cubeTexture%22%29%20%3A%20materialReference%28%22envMap%22%2C%20%22texture%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%20%20setupLightMap%28builder%29%20%7B%0A%20%20%20%20let%20node%20%3D%20null%3B%0A%20%20%20%20if%20%28builder.material.lightMap%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20new%20IrradianceNode%28materialLightMap%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%20%20setupLights%28builder%29%20%7B%0A%20%20%20%20const%20materialLightsNode%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20envNode%20%3D%20this.setupEnvironment%28builder%29%3B%0A%20%20%20%20if%20%28envNode%20%26%26%20envNode.isLightingNode%29%20%7B%0A%20%20%20%20%20%20materialLightsNode.push%28envNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20lightMapNode%20%3D%20this.setupLightMap%28builder%29%3B%0A%20%20%20%20if%20%28lightMapNode%20%26%26%20lightMapNode.isLightingNode%29%20%7B%0A%20%20%20%20%20%20materialLightsNode.push%28lightMapNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.aoNode%20%21%3D%3D%20null%20%7C%7C%20builder.material.aoMap%29%20%7B%0A%20%20%20%20%20%20const%20aoNode%20%3D%20this.aoNode%20%21%3D%3D%20null%20%3F%20this.aoNode%20%3A%20materialAOMap%3B%0A%20%20%20%20%20%20materialLightsNode.push%28new%20AONode%28aoNode%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20lightsN%20%3D%20this.lightsNode%20%7C%7C%20builder.lightsNode%3B%0A%20%20%20%20if%20%28materialLightsNode.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20lightsN%20%3D%20builder.renderer.lighting.createNode%28%5B...lightsN.getLights%28%29%2C%20...materialLightsNode%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20lightsN%3B%0A%20%20%7D%0A%20%20setupLightingModel%28%29%20%7B%0A%20%20%7D%0A%20%20setupLighting%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20material%20%7D%20%3D%20builder%3B%0A%20%20%20%20const%20%7B%20backdropNode%2C%20backdropAlphaNode%2C%20emissiveNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20lights%20%3D%20this.lights%20%3D%3D%3D%20true%20%7C%7C%20this.lightsNode%20%21%3D%3D%20null%3B%0A%20%20%20%20const%20lightsNode%20%3D%20lights%20%3F%20this.setupLights%28builder%29%20%3A%20null%3B%0A%20%20%20%20let%20outgoingLightNode%20%3D%20this.setupOutgoingLight%28builder%29%3B%0A%20%20%20%20if%20%28lightsNode%20%26%26%20lightsNode.getScope%28%29.hasLights%29%20%7B%0A%20%20%20%20%20%20const%20lightingModel%20%3D%20this.setupLightingModel%28builder%29%3B%0A%20%20%20%20%20%20outgoingLightNode%20%3D%20lightingContext%28lightsNode%2C%20lightingModel%2C%20backdropNode%2C%20backdropAlphaNode%29%3B%0A%20%20%20%20%7D%20else%20if%20%28backdropNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20outgoingLightNode%20%3D%20vec3%28backdropAlphaNode%20%21%3D%3D%20null%20%3F%20mix%28outgoingLightNode%2C%20backdropNode%2C%20backdropAlphaNode%29%20%3A%20backdropNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28emissiveNode%20%26%26%20emissiveNode.isNode%20%3D%3D%3D%20true%20%7C%7C%20material.emissive%20%26%26%20material.emissive.isColor%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20emissive.assign%28vec3%28emissiveNode%20%3F%20emissiveNode%20%3A%20materialEmissive%29%29%3B%0A%20%20%20%20%20%20outgoingLightNode%20%3D%20outgoingLightNode.add%28emissive%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20outgoingLightNode%3B%0A%20%20%7D%0A%20%20setupOutput%28builder%2C%20outputNode%29%20%7B%0A%20%20%20%20if%20%28this.fog%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20fogNode%20%3D%20builder.fogNode%3B%0A%20%20%20%20%20%20if%20%28fogNode%29%20outputNode%20%3D%20vec4%28fogNode.mix%28outputNode.rgb%2C%20fogNode.colorNode%29%2C%20outputNode.a%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20outputNode%3B%0A%20%20%7D%0A%20%20setDefaultValues%28material%29%20%7B%0A%20%20%20%20for%20%28const%20property2%20in%20material%29%20%7B%0A%20%20%20%20%20%20const%20value%20%3D%20material%5Bproperty2%5D%3B%0A%20%20%20%20%20%20if%20%28this%5Bproperty2%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this%5Bproperty2%5D%20%3D%20value%3B%0A%20%20%20%20%20%20%20%20if%20%28value%20%26%26%20value.clone%29%20this%5Bproperty2%5D%20%3D%20value.clone%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20descriptors%20%3D%20Object.getOwnPropertyDescriptors%28material.constructor.prototype%29%3B%0A%20%20%20%20for%20%28const%20key%20in%20descriptors%29%20%7B%0A%20%20%20%20%20%20if%20%28Object.getOwnPropertyDescriptor%28this.constructor.prototype%2C%20key%29%20%3D%3D%3D%20void%200%20%26%26%20descriptors%5Bkey%5D.get%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20Object.defineProperty%28this.constructor.prototype%2C%20key%2C%20descriptors%5Bkey%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20toJSON%28meta%29%20%7B%0A%20%20%20%20const%20isRoot%20%3D%20meta%20%3D%3D%3D%20void%200%20%7C%7C%20typeof%20meta%20%3D%3D%3D%20%22string%22%3B%0A%20%20%20%20if%20%28isRoot%29%20%7B%0A%20%20%20%20%20%20meta%20%3D%20%7B%0A%20%20%20%20%20%20%20%20textures%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20images%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20nodes%3A%20%7B%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20data%20%3D%20Material2.prototype.toJSON.call%28this%2C%20meta%29%3B%0A%20%20%20%20const%20nodeChildren%20%3D%20getNodeChildren%28this%29%3B%0A%20%20%20%20data.inputNodes%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20%7B%20property%3A%20property2%2C%20childNode%20%7D%20of%20nodeChildren%29%20%7B%0A%20%20%20%20%20%20data.inputNodes%5Bproperty2%5D%20%3D%20childNode.toJSON%28meta%29.uuid%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20extractFromCache%28cache2%29%20%7B%0A%20%20%20%20%20%20const%20values%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28const%20key%20in%20cache2%29%20%7B%0A%20%20%20%20%20%20%20%20const%20data2%20%3D%20cache2%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20delete%20data2.metadata%3B%0A%20%20%20%20%20%20%20%20values.push%28data2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20values%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28isRoot%29%20%7B%0A%20%20%20%20%20%20const%20textures%20%3D%20extractFromCache%28meta.textures%29%3B%0A%20%20%20%20%20%20const%20images%20%3D%20extractFromCache%28meta.images%29%3B%0A%20%20%20%20%20%20const%20nodes%20%3D%20extractFromCache%28meta.nodes%29%3B%0A%20%20%20%20%20%20if%20%28textures.length%20%3E%200%29%20data.textures%20%3D%20textures%3B%0A%20%20%20%20%20%20if%20%28images.length%20%3E%200%29%20data.images%20%3D%20images%3B%0A%20%20%20%20%20%20if%20%28nodes.length%20%3E%200%29%20data.nodes%20%3D%20nodes%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.lightsNode%20%3D%20source.lightsNode%3B%0A%20%20%20%20this.envNode%20%3D%20source.envNode%3B%0A%20%20%20%20this.colorNode%20%3D%20source.colorNode%3B%0A%20%20%20%20this.normalNode%20%3D%20source.normalNode%3B%0A%20%20%20%20this.opacityNode%20%3D%20source.opacityNode%3B%0A%20%20%20%20this.backdropNode%20%3D%20source.backdropNode%3B%0A%20%20%20%20this.backdropAlphaNode%20%3D%20source.backdropAlphaNode%3B%0A%20%20%20%20this.alphaTestNode%20%3D%20source.alphaTestNode%3B%0A%20%20%20%20this.positionNode%20%3D%20source.positionNode%3B%0A%20%20%20%20this.geometryNode%20%3D%20source.geometryNode%3B%0A%20%20%20%20this.depthNode%20%3D%20source.depthNode%3B%0A%20%20%20%20this.shadowNode%20%3D%20source.shadowNode%3B%0A%20%20%20%20this.shadowPositionNode%20%3D%20source.shadowPositionNode%3B%0A%20%20%20%20this.outputNode%20%3D%20source.outputNode%3B%0A%20%20%20%20this.mrtNode%20%3D%20source.mrtNode%3B%0A%20%20%20%20this.fragmentNode%20%3D%20source.fragmentNode%3B%0A%20%20%20%20this.vertexNode%20%3D%20source.vertexNode%3B%0A%20%20%20%20return%20super.copy%28source%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultValues%24d%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20LineBasicMaterial2%28%29%3B%0Avar%20LineBasicNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LineBasicNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLineBasicNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20false%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%24d%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultValues%24c%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20LineDashedMaterial%28%29%3B%0Avar%20LineDashedNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LineDashedNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isLineDashedNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20false%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%24c%29%3B%0A%20%20%20%20this.offsetNode%20%3D%20null%3B%0A%20%20%20%20this.dashScaleNode%20%3D%20null%3B%0A%20%20%20%20this.dashSizeNode%20%3D%20null%3B%0A%20%20%20%20this.gapSizeNode%20%3D%20null%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupVariants%28%29%20%7B%0A%20%20%20%20const%20offsetNode%20%3D%20this.offsetNode%3B%0A%20%20%20%20const%20dashScaleNode%20%3D%20this.dashScaleNode%20%3F%20float%28this.dashScaleNode%29%20%3A%20materialLineScale%3B%0A%20%20%20%20const%20dashSizeNode%20%3D%20this.dashSizeNode%20%3F%20float%28this.dashSizeNode%29%20%3A%20materialLineDashSize%3B%0A%20%20%20%20const%20gapSizeNode%20%3D%20this.dashSizeNode%20%3F%20float%28this.dashGapNode%29%20%3A%20materialLineGapSize%3B%0A%20%20%20%20dashSize.assign%28dashSizeNode%29%3B%0A%20%20%20%20gapSize.assign%28gapSizeNode%29%3B%0A%20%20%20%20const%20vLineDistance%20%3D%20varying%28attribute%28%22lineDistance%22%29.mul%28dashScaleNode%29%29%3B%0A%20%20%20%20const%20vLineDistanceOffset%20%3D%20offsetNode%20%3F%20vLineDistance.add%28offsetNode%29%20%3A%20vLineDistance%3B%0A%20%20%20%20vLineDistanceOffset.mod%28dashSize.add%28gapSize%29%29.greaterThan%28dashSize%29.discard%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20directionToColor%20%3D%20%28node%29%20%3D%3E%20nodeObject%28node%29.mul%280.5%29.add%280.5%29%3B%0Avar%20_defaultValues%24a%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20MeshNormalMaterial%28%29%3B%0Avar%20MeshNormalNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshNormalNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.lights%20%3D%20false%3B%0A%20%20%20%20this.isMeshNormalNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%24a%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupDiffuseColor%28%29%20%7B%0A%20%20%20%20const%20opacityNode%20%3D%20this.opacityNode%20%3F%20float%28this.opacityNode%29%20%3A%20materialOpacity%3B%0A%20%20%20%20diffuseColor.assign%28vec4%28directionToColor%28transformedNormalView%29%2C%20opacityNode%29%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20EquirectUVNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22EquirectUVNode%22%3B%0A%20%20%7D%0A%20%20constructor%28dirNode%20%3D%20positionWorldDirection%29%20%7B%0A%20%20%20%20super%28%22vec2%22%29%3B%0A%20%20%20%20this.dirNode%20%3D%20dirNode%3B%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20const%20dir%20%3D%20this.dirNode%3B%0A%20%20%20%20const%20u%20%3D%20dir.z.atan2%28dir.x%29.mul%281%20%2F%20%28Math.PI%20%2A%202%29%29.add%280.5%29%3B%0A%20%20%20%20const%20v%20%3D%20dir.y.clamp%28-1%2C%201%29.asin%28%29.mul%281%20%2F%20Math.PI%29.add%280.5%29%3B%0A%20%20%20%20return%20vec2%28u%2C%20v%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20equirectUV%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28EquirectUVNode%29%3B%0Avar%20CubeRenderTarget%20%3D%20class%20extends%20WebGLCubeRenderTarget2%20%7B%0A%20%20constructor%28size%20%3D%201%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28size%2C%20options%29%3B%0A%20%20%20%20this.isCubeRenderTarget%20%3D%20true%3B%0A%20%20%7D%0A%20%20fromEquirectangularTexture%28renderer3%2C%20texture%241%29%20%7B%0A%20%20%20%20const%20currentMinFilter%20%3D%20texture%241.minFilter%3B%0A%20%20%20%20const%20currentGenerateMipmaps%20%3D%20texture%241.generateMipmaps%3B%0A%20%20%20%20texture%241.generateMipmaps%20%3D%20true%3B%0A%20%20%20%20this.texture.type%20%3D%20texture%241.type%3B%0A%20%20%20%20this.texture.colorSpace%20%3D%20texture%241.colorSpace%3B%0A%20%20%20%20this.texture.generateMipmaps%20%3D%20texture%241.generateMipmaps%3B%0A%20%20%20%20this.texture.minFilter%20%3D%20texture%241.minFilter%3B%0A%20%20%20%20this.texture.magFilter%20%3D%20texture%241.magFilter%3B%0A%20%20%20%20const%20geometry%20%3D%20new%20BoxGeometry2%285%2C%205%2C%205%29%3B%0A%20%20%20%20const%20uvNode%20%3D%20equirectUV%28positionWorldDirection%29%3B%0A%20%20%20%20const%20material%20%3D%20new%20NodeMaterial%28%29%3B%0A%20%20%20%20material.colorNode%20%3D%20texture%28texture%241%2C%20uvNode%2C%200%29%3B%0A%20%20%20%20material.side%20%3D%20BackSide2%3B%0A%20%20%20%20material.blending%20%3D%20NoBlending2%3B%0A%20%20%20%20const%20mesh%20%3D%20new%20Mesh2%28geometry%2C%20material%29%3B%0A%20%20%20%20const%20scene3%20%3D%20new%20Scene2%28%29%3B%0A%20%20%20%20scene3.add%28mesh%29%3B%0A%20%20%20%20if%20%28texture%241.minFilter%20%3D%3D%3D%20LinearMipmapLinearFilter2%29%20texture%241.minFilter%20%3D%20LinearFilter2%3B%0A%20%20%20%20const%20camera3%20%3D%20new%20CubeCamera2%281%2C%2010%2C%20this%29%3B%0A%20%20%20%20const%20currentMRT%20%3D%20renderer3.getMRT%28%29%3B%0A%20%20%20%20renderer3.setMRT%28null%29%3B%0A%20%20%20%20camera3.update%28renderer3%2C%20scene3%29%3B%0A%20%20%20%20renderer3.setMRT%28currentMRT%29%3B%0A%20%20%20%20texture%241.minFilter%20%3D%20currentMinFilter%3B%0A%20%20%20%20texture%241.currentGenerateMipmaps%20%3D%20currentGenerateMipmaps%3B%0A%20%20%20%20mesh.geometry.dispose%28%29%3B%0A%20%20%20%20mesh.material.dispose%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_cache%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Avar%20CubeMapNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22CubeMapNode%22%3B%0A%20%20%7D%0A%20%20constructor%28envNode%29%20%7B%0A%20%20%20%20super%28%22vec3%22%29%3B%0A%20%20%20%20this.envNode%20%3D%20envNode%3B%0A%20%20%20%20this._cubeTexture%20%3D%20null%3B%0A%20%20%20%20this._cubeTextureNode%20%3D%20cubeTexture%28%29%3B%0A%20%20%20%20const%20defaultTexture%20%3D%20new%20CubeTexture2%28%29%3B%0A%20%20%20%20defaultTexture.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20this._defaultTexture%20%3D%20defaultTexture%3B%0A%20%20%20%20this.updateBeforeType%20%3D%20NodeUpdateType.RENDER%3B%0A%20%20%7D%0A%20%20updateBefore%28frame2%29%20%7B%0A%20%20%20%20const%20%7B%20renderer%3A%20renderer3%2C%20material%20%7D%20%3D%20frame2%3B%0A%20%20%20%20const%20envNode%20%3D%20this.envNode%3B%0A%20%20%20%20if%20%28envNode.isTextureNode%20%7C%7C%20envNode.isMaterialReferenceNode%29%20%7B%0A%20%20%20%20%20%20const%20texture2%20%3D%20envNode.isTextureNode%20%3F%20envNode.value%20%3A%20material%5BenvNode.property%5D%3B%0A%20%20%20%20%20%20if%20%28texture2%20%26%26%20texture2.isTexture%29%20%7B%0A%20%20%20%20%20%20%20%20const%20mapping%20%3D%20texture2.mapping%3B%0A%20%20%20%20%20%20%20%20if%20%28mapping%20%3D%3D%3D%20EquirectangularReflectionMapping2%20%7C%7C%20mapping%20%3D%3D%3D%20EquirectangularRefractionMapping2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28_cache%241.has%28texture2%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20cubeMap%20%3D%20_cache%241.get%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20mapTextureMapping%28cubeMap%2C%20texture2.mapping%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._cubeTexture%20%3D%20cubeMap%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20image%20%3D%20texture2.image%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28isEquirectangularMapReady%241%28image%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20renderTarget%20%3D%20new%20CubeRenderTarget%28image.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20renderTarget.fromEquirectangularTexture%28renderer3%2C%20texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20mapTextureMapping%28renderTarget.texture%2C%20texture2.mapping%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._cubeTexture%20%3D%20renderTarget.texture%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_cache%241.set%28texture2%2C%20renderTarget.texture%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture2.addEventListener%28%22dispose%22%2C%20onTextureDispose%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._cubeTexture%20%3D%20this._defaultTexture%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20this._cubeTextureNode.value%20%3D%20this._cubeTexture%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._cubeTextureNode%20%3D%20this.envNode%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20this.updateBefore%28builder%29%3B%0A%20%20%20%20return%20this._cubeTextureNode%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20isEquirectangularMapReady%241%28image%29%20%7B%0A%20%20if%20%28image%20%3D%3D%3D%20null%20%7C%7C%20image%20%3D%3D%3D%20void%200%29%20return%20false%3B%0A%20%20return%20image.height%20%3E%200%3B%0A%7D%0Afunction%20onTextureDispose%28event%29%20%7B%0A%20%20const%20texture2%20%3D%20event.target%3B%0A%20%20texture2.removeEventListener%28%22dispose%22%2C%20onTextureDispose%29%3B%0A%20%20const%20renderTarget%20%3D%20_cache%241.get%28texture2%29%3B%0A%20%20if%20%28renderTarget%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20_cache%241.delete%28texture2%29%3B%0A%20%20%20%20renderTarget.dispose%28%29%3B%0A%20%20%7D%0A%7D%0Afunction%20mapTextureMapping%28texture2%2C%20mapping%29%20%7B%0A%20%20if%20%28mapping%20%3D%3D%3D%20EquirectangularReflectionMapping2%29%20%7B%0A%20%20%20%20texture2.mapping%20%3D%20CubeReflectionMapping2%3B%0A%20%20%7D%20else%20if%20%28mapping%20%3D%3D%3D%20EquirectangularRefractionMapping2%29%20%7B%0A%20%20%20%20texture2.mapping%20%3D%20CubeRefractionMapping2%3B%0A%20%20%7D%0A%7D%0Avar%20cubeMapNode%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28CubeMapNode%29%3B%0Avar%20BasicEnvironmentNode%20%3D%20class%20extends%20LightingNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22BasicEnvironmentNode%22%3B%0A%20%20%7D%0A%20%20constructor%28envNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.envNode%20%3D%20envNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20builder.context.environment%20%3D%20cubeMapNode%28this.envNode%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20BasicLightMapNode%20%3D%20class%20extends%20LightingNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22BasicLightMapNode%22%3B%0A%20%20%7D%0A%20%20constructor%28lightMapNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.lightMapNode%20%3D%20lightMapNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20RECIPROCAL_PI2%20%3D%20float%281%20%2F%20Math.PI%29%3B%0A%20%20%20%20builder.context.irradianceLightMap%20%3D%20this.lightMapNode.mul%28RECIPROCAL_PI2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LightingModel%20%3D%20class%20%7B%0A%20%20start%28%29%20%7B%0A%20%20%7D%0A%20%20finish%28%29%20%7B%0A%20%20%7D%0A%20%20direct%28%29%20%7B%0A%20%20%7D%0A%20%20directRectArea%28%29%20%7B%0A%20%20%7D%0A%20%20indirect%28%29%20%7B%0A%20%20%7D%0A%20%20ambientOcclusion%28%29%20%7B%0A%20%20%7D%0A%7D%3B%0Avar%20BasicLightingModel%20%3D%20class%20extends%20LightingModel%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%7D%0A%20%20indirect%28context2%2C%20stack2%2C%20builder%29%20%7B%0A%20%20%20%20const%20ambientOcclusion%20%3D%20context2.ambientOcclusion%3B%0A%20%20%20%20const%20reflectedLight%20%3D%20context2.reflectedLight%3B%0A%20%20%20%20const%20irradianceLightMap%20%3D%20builder.context.irradianceLightMap%3B%0A%20%20%20%20reflectedLight.indirectDiffuse.assign%28vec4%280%29%29%3B%0A%20%20%20%20if%20%28irradianceLightMap%29%20%7B%0A%20%20%20%20%20%20reflectedLight.indirectDiffuse.addAssign%28irradianceLightMap%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20reflectedLight.indirectDiffuse.addAssign%28vec4%281%2C%201%2C%201%2C%200%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20reflectedLight.indirectDiffuse.mulAssign%28ambientOcclusion%29%3B%0A%20%20%20%20reflectedLight.indirectDiffuse.mulAssign%28diffuseColor.rgb%29%3B%0A%20%20%7D%0A%20%20finish%28context2%2C%20stack2%2C%20builder%29%20%7B%0A%20%20%20%20const%20material%20%3D%20builder.material%3B%0A%20%20%20%20const%20outgoingLight%20%3D%20context2.outgoingLight%3B%0A%20%20%20%20const%20envNode%20%3D%20builder.context.environment%3B%0A%20%20%20%20if%20%28envNode%29%20%7B%0A%20%20%20%20%20%20switch%20%28material.combine%29%20%7B%0A%20%20%20%20%20%20%20%20case%20MultiplyOperation2%3A%0A%20%20%20%20%20%20%20%20%20%20outgoingLight.rgb.assign%28mix%28outgoingLight.rgb%2C%20outgoingLight.rgb.mul%28envNode.rgb%29%2C%20materialSpecularStrength.mul%28materialReflectivity%29%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20MixOperation2%3A%0A%20%20%20%20%20%20%20%20%20%20outgoingLight.rgb.assign%28mix%28outgoingLight.rgb%2C%20envNode.rgb%2C%20materialSpecularStrength.mul%28materialReflectivity%29%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20AddOperation2%3A%0A%20%20%20%20%20%20%20%20%20%20outgoingLight.rgb.addAssign%28envNode.rgb.mul%28materialSpecularStrength.mul%28materialReflectivity%29%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.BasicLightingModel%3A%20Unsupported%20.combine%20value%3A%22%2C%20material.combine%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultValues%249%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20MeshBasicMaterial2%28%29%3B%0Avar%20MeshBasicNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshBasicNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshBasicNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20true%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%249%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupNormal%28%29%20%7B%0A%20%20%20%20return%20normalView%3B%0A%20%20%7D%0A%20%20setupEnvironment%28builder%29%20%7B%0A%20%20%20%20const%20envNode%20%3D%20super.setupEnvironment%28builder%29%3B%0A%20%20%20%20return%20envNode%20%3F%20new%20BasicEnvironmentNode%28envNode%29%20%3A%20null%3B%0A%20%20%7D%0A%20%20setupLightMap%28builder%29%20%7B%0A%20%20%20%20let%20node%20%3D%20null%3B%0A%20%20%20%20if%20%28builder.material.lightMap%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20new%20BasicLightMapNode%28materialLightMap%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%20%20setupOutgoingLight%28%29%20%7B%0A%20%20%20%20return%20diffuseColor.rgb%3B%0A%20%20%7D%0A%20%20setupLightingModel%28%29%20%7B%0A%20%20%20%20return%20new%20BasicLightingModel%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20F_Schlick%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20f0%2C%20f90%2C%20dotVH%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20fresnel%20%3D%20dotVH.mul%28-5.55473%29.sub%286.98316%29.mul%28dotVH%29.exp2%28%29%3B%0A%20%20return%20f0.mul%28fresnel.oneMinus%28%29%29.add%28f90.mul%28fresnel%29%29%3B%0A%7D%29%3B%0Avar%20BRDF_Lambert%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28inputs%29%20%3D%3E%20%7B%0A%20%20return%20inputs.diffuseColor.mul%281%20%2F%20Math.PI%29%3B%0A%7D%29%3B%0Avar%20G_BlinnPhong_Implicit%20%3D%20%28%29%20%3D%3E%20float%280.25%29%3B%0Avar%20D_BlinnPhong%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20dotNH%20%7D%29%20%3D%3E%20%7B%0A%20%20return%20shininess.mul%28float%280.5%29%29.add%281%29.mul%28float%281%20%2F%20Math.PI%29%29.mul%28dotNH.pow%28shininess%29%29%3B%0A%7D%29%3B%0Avar%20BRDF_BlinnPhong%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20lightDirection%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20halfDir%20%3D%20lightDirection.add%28positionViewDirection%29.normalize%28%29%3B%0A%20%20const%20dotNH%20%3D%20transformedNormalView.dot%28halfDir%29.clamp%28%29%3B%0A%20%20const%20dotVH%20%3D%20positionViewDirection.dot%28halfDir%29.clamp%28%29%3B%0A%20%20const%20F%20%3D%20F_Schlick%28%7B%20f0%3A%20specularColor%2C%20f90%3A%201%2C%20dotVH%20%7D%29%3B%0A%20%20const%20G%20%3D%20G_BlinnPhong_Implicit%28%29%3B%0A%20%20const%20D%20%3D%20D_BlinnPhong%28%7B%20dotNH%20%7D%29%3B%0A%20%20return%20F.mul%28G%29.mul%28D%29%3B%0A%7D%29%3B%0Avar%20PhongLightingModel%20%3D%20class%20extends%20BasicLightingModel%20%7B%0A%20%20constructor%28specular%20%3D%20true%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.specular%20%3D%20specular%3B%0A%20%20%7D%0A%20%20direct%28%7B%20lightDirection%2C%20lightColor%2C%20reflectedLight%20%7D%29%20%7B%0A%20%20%20%20const%20dotNL%20%3D%20transformedNormalView.dot%28lightDirection%29.clamp%28%29%3B%0A%20%20%20%20const%20irradiance%20%3D%20dotNL.mul%28lightColor%29%3B%0A%20%20%20%20reflectedLight.directDiffuse.addAssign%28irradiance.mul%28BRDF_Lambert%28%7B%20diffuseColor%3A%20diffuseColor.rgb%20%7D%29%29%29%3B%0A%20%20%20%20if%20%28this.specular%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20reflectedLight.directSpecular.addAssign%28irradiance.mul%28BRDF_BlinnPhong%28%7B%20lightDirection%20%7D%29%29.mul%28materialSpecularStrength%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20indirect%28%7B%20ambientOcclusion%2C%20irradiance%2C%20reflectedLight%20%7D%29%20%7B%0A%20%20%20%20reflectedLight.indirectDiffuse.addAssign%28irradiance.mul%28BRDF_Lambert%28%7B%20diffuseColor%20%7D%29%29%29%3B%0A%20%20%20%20reflectedLight.indirectDiffuse.mulAssign%28ambientOcclusion%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultValues%248%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20MeshLambertMaterial2%28%29%3B%0Avar%20MeshLambertNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshLambertNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshLambertNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20true%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%248%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupEnvironment%28builder%29%20%7B%0A%20%20%20%20const%20envNode%20%3D%20super.setupEnvironment%28builder%29%3B%0A%20%20%20%20return%20envNode%20%3F%20new%20BasicEnvironmentNode%28envNode%29%20%3A%20null%3B%0A%20%20%7D%0A%20%20setupLightingModel%28%29%20%7B%0A%20%20%20%20return%20new%20PhongLightingModel%28false%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultValues%247%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20MeshPhongMaterial%28%29%3B%0Avar%20MeshPhongNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshPhongNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshPhongNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20true%3B%0A%20%20%20%20this.shininessNode%20%3D%20null%3B%0A%20%20%20%20this.specularNode%20%3D%20null%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%247%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupEnvironment%28builder%29%20%7B%0A%20%20%20%20const%20envNode%20%3D%20super.setupEnvironment%28builder%29%3B%0A%20%20%20%20return%20envNode%20%3F%20new%20BasicEnvironmentNode%28envNode%29%20%3A%20null%3B%0A%20%20%7D%0A%20%20setupLightingModel%28%29%20%7B%0A%20%20%20%20return%20new%20PhongLightingModel%28%29%3B%0A%20%20%7D%0A%20%20setupVariants%28%29%20%7B%0A%20%20%20%20const%20shininessNode%20%3D%20%28this.shininessNode%20%3F%20float%28this.shininessNode%29%20%3A%20materialShininess%29.max%281e-4%29%3B%0A%20%20%20%20shininess.assign%28shininessNode%29%3B%0A%20%20%20%20const%20specularNode%20%3D%20this.specularNode%20%7C%7C%20materialSpecular%3B%0A%20%20%20%20specularColor.assign%28specularNode%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.shininessNode%20%3D%20source.shininessNode%3B%0A%20%20%20%20this.specularNode%20%3D%20source.specularNode%3B%0A%20%20%20%20return%20super.copy%28source%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20getGeometryRoughness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28builder%29%20%3D%3E%20%7B%0A%20%20if%20%28builder.geometry.hasAttribute%28%22normal%22%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20return%20float%280%29%3B%0A%20%20%7D%0A%20%20const%20dxy%20%3D%20normalView.dFdx%28%29.abs%28%29.max%28normalView.dFdy%28%29.abs%28%29%29%3B%0A%20%20const%20geometryRoughness%20%3D%20dxy.x.max%28dxy.y%29.max%28dxy.z%29%3B%0A%20%20return%20geometryRoughness%3B%0A%7D%29%3B%0Avar%20getRoughness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28inputs%29%20%3D%3E%20%7B%0A%20%20const%20%7B%20roughness%3A%20roughness2%20%7D%20%3D%20inputs%3B%0A%20%20const%20geometryRoughness%20%3D%20getGeometryRoughness%28%29%3B%0A%20%20let%20roughnessFactor%20%3D%20roughness2.max%280.0525%29%3B%0A%20%20roughnessFactor%20%3D%20roughnessFactor.add%28geometryRoughness%29%3B%0A%20%20roughnessFactor%20%3D%20roughnessFactor.min%281%29%3B%0A%20%20return%20roughnessFactor%3B%0A%7D%29%3B%0Avar%20V_GGX_SmithCorrelated%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20alpha%2C%20dotNL%2C%20dotNV%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20a2%20%3D%20alpha.pow2%28%29%3B%0A%20%20const%20gv%20%3D%20dotNL.mul%28a2.add%28a2.oneMinus%28%29.mul%28dotNV.pow2%28%29%29%29.sqrt%28%29%29%3B%0A%20%20const%20gl%20%3D%20dotNV.mul%28a2.add%28a2.oneMinus%28%29.mul%28dotNL.pow2%28%29%29%29.sqrt%28%29%29%3B%0A%20%20return%20div%280.5%2C%20gv.add%28gl%29.max%28EPSILON%29%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22V_GGX_SmithCorrelated%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22alpha%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotNL%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotNV%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20V_GGX_SmithCorrelated_Anisotropic%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20alphaT%3A%20alphaT2%2C%20alphaB%2C%20dotTV%2C%20dotBV%2C%20dotTL%2C%20dotBL%2C%20dotNV%2C%20dotNL%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20gv%20%3D%20dotNL.mul%28vec3%28alphaT2.mul%28dotTV%29%2C%20alphaB.mul%28dotBV%29%2C%20dotNV%29.length%28%29%29%3B%0A%20%20const%20gl%20%3D%20dotNV.mul%28vec3%28alphaT2.mul%28dotTL%29%2C%20alphaB.mul%28dotBL%29%2C%20dotNL%29.length%28%29%29%3B%0A%20%20const%20v%20%3D%20div%280.5%2C%20gv.add%28gl%29%29%3B%0A%20%20return%20v.saturate%28%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22V_GGX_SmithCorrelated_Anisotropic%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22alphaT%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22alphaB%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotTV%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotBV%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotTL%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotBL%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotNV%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotNL%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20D_GGX%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20alpha%2C%20dotNH%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20a2%20%3D%20alpha.pow2%28%29%3B%0A%20%20const%20denom%20%3D%20dotNH.pow2%28%29.mul%28a2.oneMinus%28%29%29.oneMinus%28%29%3B%0A%20%20return%20a2.div%28denom.pow2%28%29%29.mul%281%20%2F%20Math.PI%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22D_GGX%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22alpha%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotNH%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20RECIPROCAL_PI%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%281%20%2F%20Math.PI%29%3B%0Avar%20D_GGX_Anisotropic%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20alphaT%3A%20alphaT2%2C%20alphaB%2C%20dotNH%2C%20dotTH%2C%20dotBH%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20a2%20%3D%20alphaT2.mul%28alphaB%29%3B%0A%20%20const%20v%20%3D%20vec3%28alphaB.mul%28dotTH%29%2C%20alphaT2.mul%28dotBH%29%2C%20a2.mul%28dotNH%29%29%3B%0A%20%20const%20v2%20%3D%20v.dot%28v%29%3B%0A%20%20const%20w22%20%3D%20a2.div%28v2%29%3B%0A%20%20return%20RECIPROCAL_PI.mul%28a2.mul%28w22.pow2%28%29%29%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22D_GGX_Anisotropic%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22alphaT%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22alphaB%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotNH%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotTH%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotBH%22%2C%20type%3A%20%22float%22%2C%20qualifier%3A%20%22in%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20BRDF_GGX%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28inputs%29%20%3D%3E%20%7B%0A%20%20const%20%7B%20lightDirection%2C%20f0%2C%20f90%2C%20roughness%3A%20roughness2%2C%20f%2C%20USE_IRIDESCENCE%2C%20USE_ANISOTROPY%20%7D%20%3D%20inputs%3B%0A%20%20const%20normalView2%20%3D%20inputs.normalView%20%7C%7C%20transformedNormalView%3B%0A%20%20const%20alpha%20%3D%20roughness2.pow2%28%29%3B%0A%20%20const%20halfDir%20%3D%20lightDirection.add%28positionViewDirection%29.normalize%28%29%3B%0A%20%20const%20dotNL%20%3D%20normalView2.dot%28lightDirection%29.clamp%28%29%3B%0A%20%20const%20dotNV%20%3D%20normalView2.dot%28positionViewDirection%29.clamp%28%29%3B%0A%20%20const%20dotNH%20%3D%20normalView2.dot%28halfDir%29.clamp%28%29%3B%0A%20%20const%20dotVH%20%3D%20positionViewDirection.dot%28halfDir%29.clamp%28%29%3B%0A%20%20let%20F%20%3D%20F_Schlick%28%7B%20f0%2C%20f90%2C%20dotVH%20%7D%29%3B%0A%20%20let%20V%2C%20D%3B%0A%20%20if%20%28defined%28USE_IRIDESCENCE%29%29%20%7B%0A%20%20%20%20F%20%3D%20iridescence.mix%28F%2C%20f%29%3B%0A%20%20%7D%0A%20%20if%20%28defined%28USE_ANISOTROPY%29%29%20%7B%0A%20%20%20%20const%20dotTL%20%3D%20anisotropyT.dot%28lightDirection%29%3B%0A%20%20%20%20const%20dotTV%20%3D%20anisotropyT.dot%28positionViewDirection%29%3B%0A%20%20%20%20const%20dotTH%20%3D%20anisotropyT.dot%28halfDir%29%3B%0A%20%20%20%20const%20dotBL%20%3D%20anisotropyB.dot%28lightDirection%29%3B%0A%20%20%20%20const%20dotBV%20%3D%20anisotropyB.dot%28positionViewDirection%29%3B%0A%20%20%20%20const%20dotBH%20%3D%20anisotropyB.dot%28halfDir%29%3B%0A%20%20%20%20V%20%3D%20V_GGX_SmithCorrelated_Anisotropic%28%7B%20alphaT%2C%20alphaB%3A%20alpha%2C%20dotTV%2C%20dotBV%2C%20dotTL%2C%20dotBL%2C%20dotNV%2C%20dotNL%20%7D%29%3B%0A%20%20%20%20D%20%3D%20D_GGX_Anisotropic%28%7B%20alphaT%2C%20alphaB%3A%20alpha%2C%20dotNH%2C%20dotTH%2C%20dotBH%20%7D%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20V%20%3D%20V_GGX_SmithCorrelated%28%7B%20alpha%2C%20dotNL%2C%20dotNV%20%7D%29%3B%0A%20%20%20%20D%20%3D%20D_GGX%28%7B%20alpha%2C%20dotNH%20%7D%29%3B%0A%20%20%7D%0A%20%20return%20F.mul%28V%29.mul%28D%29%3B%0A%7D%29%3B%0Avar%20DFGApprox%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20roughness%3A%20roughness2%2C%20dotNV%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20c0%20%3D%20vec4%28-1%2C%20-0.0275%2C%20-0.572%2C%200.022%29%3B%0A%20%20const%20c1%20%3D%20vec4%281%2C%200.0425%2C%201.04%2C%20-0.04%29%3B%0A%20%20const%20r%20%3D%20roughness2.mul%28c0%29.add%28c1%29%3B%0A%20%20const%20a004%20%3D%20r.x.mul%28r.x%29.min%28dotNV.mul%28-9.28%29.exp2%28%29%29.mul%28r.x%29.add%28r.y%29%3B%0A%20%20const%20fab%20%3D%20vec2%28-1.04%2C%201.04%29.mul%28a004%29.add%28r.zw%29%3B%0A%20%20return%20fab%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22DFGApprox%22%2C%0A%20%20type%3A%20%22vec2%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22roughness%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotNV%22%2C%20type%3A%20%22vec3%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20EnvironmentBRDF%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28inputs%29%20%3D%3E%20%7B%0A%20%20const%20%7B%20dotNV%2C%20specularColor%3A%20specularColor2%2C%20specularF90%3A%20specularF902%2C%20roughness%3A%20roughness2%20%7D%20%3D%20inputs%3B%0A%20%20const%20fab%20%3D%20DFGApprox%28%7B%20dotNV%2C%20roughness%3A%20roughness2%20%7D%29%3B%0A%20%20return%20specularColor2.mul%28fab.x%29.add%28specularF902.mul%28fab.y%29%29%3B%0A%7D%29%3B%0Avar%20Schlick_to_F0%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20f%2C%20f90%2C%20dotVH%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20x2%20%3D%20dotVH.oneMinus%28%29.saturate%28%29%3B%0A%20%20const%20x22%20%3D%20x2.mul%28x2%29%3B%0A%20%20const%20x5%20%3D%20x2.mul%28x22%2C%20x22%29.clamp%280%2C%200.9999%29%3B%0A%20%20return%20f.sub%28vec3%28f90%29.mul%28x5%29%29.div%28x5.oneMinus%28%29%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22Schlick_to_F0%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22f%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22f90%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotVH%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20D_Charlie%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20roughness%3A%20roughness2%2C%20dotNH%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20alpha%20%3D%20roughness2.pow2%28%29%3B%0A%20%20const%20invAlpha%20%3D%20float%281%29.div%28alpha%29%3B%0A%20%20const%20cos2h%20%3D%20dotNH.pow2%28%29%3B%0A%20%20const%20sin2h%20%3D%20cos2h.oneMinus%28%29.max%2878125e-7%29%3B%0A%20%20return%20float%282%29.add%28invAlpha%29.mul%28sin2h.pow%28invAlpha.mul%280.5%29%29%29.div%282%20%2A%20Math.PI%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22D_Charlie%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22roughness%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotNH%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20V_Neubelt%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20dotNV%2C%20dotNL%20%7D%29%20%3D%3E%20%7B%0A%20%20return%20float%281%29.div%28float%284%29.mul%28dotNL.add%28dotNV%29.sub%28dotNL.mul%28dotNV%29%29%29%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22V_Neubelt%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22dotNV%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22dotNL%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20BRDF_Sheen%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20lightDirection%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20halfDir%20%3D%20lightDirection.add%28positionViewDirection%29.normalize%28%29%3B%0A%20%20const%20dotNL%20%3D%20transformedNormalView.dot%28lightDirection%29.clamp%28%29%3B%0A%20%20const%20dotNV%20%3D%20transformedNormalView.dot%28positionViewDirection%29.clamp%28%29%3B%0A%20%20const%20dotNH%20%3D%20transformedNormalView.dot%28halfDir%29.clamp%28%29%3B%0A%20%20const%20D%20%3D%20D_Charlie%28%7B%20roughness%3A%20sheenRoughness%2C%20dotNH%20%7D%29%3B%0A%20%20const%20V%20%3D%20V_Neubelt%28%7B%20dotNV%2C%20dotNL%20%7D%29%3B%0A%20%20return%20sheen.mul%28D%29.mul%28V%29%3B%0A%7D%29%3B%0Avar%20LTC_Uv%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20N%2C%20V%2C%20roughness%3A%20roughness2%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20LUT_SIZE%20%3D%2064%3B%0A%20%20const%20LUT_SCALE%20%3D%20%28LUT_SIZE%20-%201%29%20%2F%20LUT_SIZE%3B%0A%20%20const%20LUT_BIAS%20%3D%200.5%20%2F%20LUT_SIZE%3B%0A%20%20const%20dotNV%20%3D%20N.dot%28V%29.saturate%28%29%3B%0A%20%20const%20uv2%20%3D%20vec2%28roughness2%2C%20dotNV.oneMinus%28%29.sqrt%28%29%29%3B%0A%20%20uv2.assign%28uv2.mul%28LUT_SCALE%29.add%28LUT_BIAS%29%29%3B%0A%20%20return%20uv2%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22LTC_Uv%22%2C%0A%20%20type%3A%20%22vec2%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22N%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22V%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22roughness%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20LTC_ClippedSphereFormFactor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20f%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20l%20%3D%20f.length%28%29%3B%0A%20%20return%20max%241%28l.mul%28l%29.add%28f.z%29.div%28l.add%281%29%29%2C%200%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22LTC_ClippedSphereFormFactor%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22f%22%2C%20type%3A%20%22vec3%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20LTC_EdgeVectorFormFactor%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20v1%2C%20v2%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20x2%20%3D%20v1.dot%28v2%29%3B%0A%20%20const%20y2%20%3D%20x2.abs%28%29.toVar%28%29%3B%0A%20%20const%20a2%20%3D%20y2.mul%280.0145206%29.add%280.4965155%29.mul%28y2%29.add%280.8543985%29.toVar%28%29%3B%0A%20%20const%20b%20%3D%20y2.add%284.1616724%29.mul%28y2%29.add%283.417594%29.toVar%28%29%3B%0A%20%20const%20v%20%3D%20a2.div%28b%29%3B%0A%20%20const%20theta_sintheta%20%3D%20x2.greaterThan%280%29.select%28v%2C%20max%241%28x2.mul%28x2%29.oneMinus%28%29%2C%201e-7%29.inverseSqrt%28%29.mul%280.5%29.sub%28v%29%29%3B%0A%20%20return%20v1.cross%28v2%29.mul%28theta_sintheta%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22LTC_EdgeVectorFormFactor%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22v1%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22v2%22%2C%20type%3A%20%22vec3%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20LTC_Evaluate%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20N%2C%20V%2C%20P%2C%20mInv%2C%20p0%2C%20p1%2C%20p2%2C%20p3%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20v1%20%3D%20p1.sub%28p0%29.toVar%28%29%3B%0A%20%20const%20v2%20%3D%20p3.sub%28p0%29.toVar%28%29%3B%0A%20%20const%20lightNormal%20%3D%20v1.cross%28v2%29%3B%0A%20%20const%20result%20%3D%20vec3%28%29.toVar%28%29%3B%0A%20%20If%28lightNormal.dot%28P.sub%28p0%29%29.greaterThanEqual%280%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20const%20T1%20%3D%20V.sub%28N.mul%28V.dot%28N%29%29%29.normalize%28%29%3B%0A%20%20%20%20const%20T2%20%3D%20N.cross%28T1%29.negate%28%29%3B%0A%20%20%20%20const%20mat%20%3D%20mInv.mul%28mat3%28T1%2C%20T2%2C%20N%29.transpose%28%29%29.toVar%28%29%3B%0A%20%20%20%20const%20coords0%20%3D%20mat.mul%28p0.sub%28P%29%29.normalize%28%29.toVar%28%29%3B%0A%20%20%20%20const%20coords1%20%3D%20mat.mul%28p1.sub%28P%29%29.normalize%28%29.toVar%28%29%3B%0A%20%20%20%20const%20coords2%20%3D%20mat.mul%28p2.sub%28P%29%29.normalize%28%29.toVar%28%29%3B%0A%20%20%20%20const%20coords3%20%3D%20mat.mul%28p3.sub%28P%29%29.normalize%28%29.toVar%28%29%3B%0A%20%20%20%20const%20vectorFormFactor%20%3D%20vec3%280%29.toVar%28%29%3B%0A%20%20%20%20vectorFormFactor.addAssign%28LTC_EdgeVectorFormFactor%28%7B%20v1%3A%20coords0%2C%20v2%3A%20coords1%20%7D%29%29%3B%0A%20%20%20%20vectorFormFactor.addAssign%28LTC_EdgeVectorFormFactor%28%7B%20v1%3A%20coords1%2C%20v2%3A%20coords2%20%7D%29%29%3B%0A%20%20%20%20vectorFormFactor.addAssign%28LTC_EdgeVectorFormFactor%28%7B%20v1%3A%20coords2%2C%20v2%3A%20coords3%20%7D%29%29%3B%0A%20%20%20%20vectorFormFactor.addAssign%28LTC_EdgeVectorFormFactor%28%7B%20v1%3A%20coords3%2C%20v2%3A%20coords0%20%7D%29%29%3B%0A%20%20%20%20result.assign%28vec3%28LTC_ClippedSphereFormFactor%28%7B%20f%3A%20vectorFormFactor%20%7D%29%29%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20result%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22LTC_Evaluate%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22N%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22V%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22P%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22mInv%22%2C%20type%3A%20%22mat3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22p0%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22p1%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22p2%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22p3%22%2C%20type%3A%20%22vec3%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20bC%20%3D%201%20%2F%206%3B%0Avar%20w0%20%3D%20%28a2%29%20%3D%3E%20mul%28bC%2C%20mul%28a2%2C%20mul%28a2%2C%20a2.negate%28%29.add%283%29%29.sub%283%29%29.add%281%29%29%3B%0Avar%20w1%20%3D%20%28a2%29%20%3D%3E%20mul%28bC%2C%20mul%28a2%2C%20mul%28a2%2C%20mul%283%2C%20a2%29.sub%286%29%29%29.add%284%29%29%3B%0Avar%20w2%20%3D%20%28a2%29%20%3D%3E%20mul%28bC%2C%20mul%28a2%2C%20mul%28a2%2C%20mul%28-3%2C%20a2%29.add%283%29%29.add%283%29%29.add%281%29%29%3B%0Avar%20w3%20%3D%20%28a2%29%20%3D%3E%20mul%28bC%2C%20pow%28a2%2C%203%29%29%3B%0Avar%20g0%20%3D%20%28a2%29%20%3D%3E%20w0%28a2%29.add%28w1%28a2%29%29%3B%0Avar%20g1%20%3D%20%28a2%29%20%3D%3E%20w2%28a2%29.add%28w3%28a2%29%29%3B%0Avar%20h0%20%3D%20%28a2%29%20%3D%3E%20add4%28-1%2C%20w1%28a2%29.div%28w0%28a2%29.add%28w1%28a2%29%29%29%29%3B%0Avar%20h1%20%3D%20%28a2%29%20%3D%3E%20add4%281%2C%20w3%28a2%29.div%28w2%28a2%29.add%28w3%28a2%29%29%29%29%3B%0Avar%20bicubic%20%3D%20%28textureNode%2C%20texelSize%2C%20lod%29%20%3D%3E%20%7B%0A%20%20const%20uv2%20%3D%20textureNode.uvNode%3B%0A%20%20const%20uvScaled%20%3D%20mul%28uv2%2C%20texelSize.zw%29.add%280.5%29%3B%0A%20%20const%20iuv%20%3D%20floor%28uvScaled%29%3B%0A%20%20const%20fuv%20%3D%20fract%28uvScaled%29%3B%0A%20%20const%20g0x%20%3D%20g0%28fuv.x%29%3B%0A%20%20const%20g1x%20%3D%20g1%28fuv.x%29%3B%0A%20%20const%20h0x%20%3D%20h0%28fuv.x%29%3B%0A%20%20const%20h1x%20%3D%20h1%28fuv.x%29%3B%0A%20%20const%20h0y%20%3D%20h0%28fuv.y%29%3B%0A%20%20const%20h1y%20%3D%20h1%28fuv.y%29%3B%0A%20%20const%20p0%20%3D%20vec2%28iuv.x.add%28h0x%29%2C%20iuv.y.add%28h0y%29%29.sub%280.5%29.mul%28texelSize.xy%29%3B%0A%20%20const%20p1%20%3D%20vec2%28iuv.x.add%28h1x%29%2C%20iuv.y.add%28h0y%29%29.sub%280.5%29.mul%28texelSize.xy%29%3B%0A%20%20const%20p2%20%3D%20vec2%28iuv.x.add%28h0x%29%2C%20iuv.y.add%28h1y%29%29.sub%280.5%29.mul%28texelSize.xy%29%3B%0A%20%20const%20p3%20%3D%20vec2%28iuv.x.add%28h1x%29%2C%20iuv.y.add%28h1y%29%29.sub%280.5%29.mul%28texelSize.xy%29%3B%0A%20%20const%20a2%20%3D%20g0%28fuv.y%29.mul%28add4%28g0x.mul%28textureNode.uv%28p0%29.level%28lod%29%29%2C%20g1x.mul%28textureNode.uv%28p1%29.level%28lod%29%29%29%29%3B%0A%20%20const%20b%20%3D%20g1%28fuv.y%29.mul%28add4%28g0x.mul%28textureNode.uv%28p2%29.level%28lod%29%29%2C%20g1x.mul%28textureNode.uv%28p3%29.level%28lod%29%29%29%29%3B%0A%20%20return%20a2.add%28b%29%3B%0A%7D%3B%0Avar%20textureBicubic%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5BtextureNode%2C%20lodNode%20%3D%20float%283%29%5D%29%20%3D%3E%20%7B%0A%20%20const%20fLodSize%20%3D%20vec2%28textureNode.size%28int%28lodNode%29%29%29%3B%0A%20%20const%20cLodSize%20%3D%20vec2%28textureNode.size%28int%28lodNode.add%281%29%29%29%29%3B%0A%20%20const%20fLodSizeInv%20%3D%20div%281%2C%20fLodSize%29%3B%0A%20%20const%20cLodSizeInv%20%3D%20div%281%2C%20cLodSize%29%3B%0A%20%20const%20fSample%20%3D%20bicubic%28textureNode%2C%20vec4%28fLodSizeInv%2C%20fLodSize%29%2C%20floor%28lodNode%29%29%3B%0A%20%20const%20cSample%20%3D%20bicubic%28textureNode%2C%20vec4%28cLodSizeInv%2C%20cLodSize%29%2C%20ceil%28lodNode%29%29%3B%0A%20%20return%20fract%28lodNode%29.mix%28fSample%2C%20cSample%29%3B%0A%7D%29%3B%0Avar%20getVolumeTransmissionRay%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bn%2C%20v%2C%20thickness2%2C%20ior2%2C%20modelMatrix%5D%29%20%3D%3E%20%7B%0A%20%20const%20refractionVector%20%3D%20vec3%28refract%28v.negate%28%29%2C%20normalize2%28n%29%2C%20div%281%2C%20ior2%29%29%29%3B%0A%20%20const%20modelScale2%20%3D%20vec3%28%0A%20%20%20%20length%28modelMatrix%5B0%5D.xyz%29%2C%0A%20%20%20%20length%28modelMatrix%5B1%5D.xyz%29%2C%0A%20%20%20%20length%28modelMatrix%5B2%5D.xyz%29%0A%20%20%29%3B%0A%20%20return%20normalize2%28refractionVector%29.mul%28thickness2.mul%28modelScale2%29%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22getVolumeTransmissionRay%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22n%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22v%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22thickness%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22ior%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22modelMatrix%22%2C%20type%3A%20%22mat4%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20applyIorToRoughness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Broughness2%2C%20ior2%5D%29%20%3D%3E%20%7B%0A%20%20return%20roughness2.mul%28clamp2%28ior2.mul%282%29.sub%282%29%2C%200%2C%201%29%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22applyIorToRoughness%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22roughness%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22ior%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20viewportBackSideTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20viewportMipTexture%28%29%3B%0Avar%20viewportFrontSideTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20viewportMipTexture%28%29%3B%0Avar%20getTransmissionSample%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5BfragCoord%2C%20roughness2%2C%20ior2%5D%2C%20%7B%20material%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20vTexture%20%3D%20material.side%20%3D%3D%20BackSide2%20%3F%20viewportBackSideTexture%20%3A%20viewportFrontSideTexture%3B%0A%20%20const%20transmissionSample%20%3D%20vTexture.uv%28fragCoord%29%3B%0A%20%20const%20lod%20%3D%20log2%28screenSize.x%29.mul%28applyIorToRoughness%28roughness2%2C%20ior2%29%29%3B%0A%20%20return%20textureBicubic%28transmissionSample%2C%20lod%29%3B%0A%7D%29%3B%0Avar%20volumeAttenuation%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5BtransmissionDistance%2C%20attenuationColor2%2C%20attenuationDistance2%5D%29%20%3D%3E%20%7B%0A%20%20If%28attenuationDistance2.notEqual%280%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20const%20attenuationCoefficient%20%3D%20log%28attenuationColor2%29.negate%28%29.div%28attenuationDistance2%29%3B%0A%20%20%20%20const%20transmittance%20%3D%20exp%28attenuationCoefficient.negate%28%29.mul%28transmissionDistance%29%29%3B%0A%20%20%20%20return%20transmittance%3B%0A%20%20%7D%29%3B%0A%20%20return%20vec3%281%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22volumeAttenuation%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22transmissionDistance%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22attenuationColor%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22attenuationDistance%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20getIBLVolumeRefraction%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bn%2C%20v%2C%20roughness2%2C%20diffuseColor2%2C%20specularColor2%2C%20specularF902%2C%20position%2C%20modelMatrix%2C%20viewMatrix%2C%20projMatrix%2C%20ior2%2C%20thickness2%2C%20attenuationColor2%2C%20attenuationDistance2%2C%20dispersion2%5D%29%20%3D%3E%20%7B%0A%20%20let%20transmittedLight%2C%20transmittance%3B%0A%20%20if%20%28dispersion2%29%20%7B%0A%20%20%20%20transmittedLight%20%3D%20vec4%28%29.toVar%28%29%3B%0A%20%20%20%20transmittance%20%3D%20vec3%28%29.toVar%28%29%3B%0A%20%20%20%20const%20halfSpread%20%3D%20ior2.sub%281%29.mul%28dispersion2.mul%280.025%29%29%3B%0A%20%20%20%20const%20iors%20%3D%20vec3%28ior2.sub%28halfSpread%29%2C%20ior2%2C%20ior2.add%28halfSpread%29%29%3B%0A%20%20%20%20Loop%28%7B%20start%3A%200%2C%20end%3A%203%20%7D%2C%20%28%7B%20i%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20ior3%20%3D%20iors.element%28i%29%3B%0A%20%20%20%20%20%20const%20transmissionRay%20%3D%20getVolumeTransmissionRay%28n%2C%20v%2C%20thickness2%2C%20ior3%2C%20modelMatrix%29%3B%0A%20%20%20%20%20%20const%20refractedRayExit%20%3D%20position.add%28transmissionRay%29%3B%0A%20%20%20%20%20%20const%20ndcPos%20%3D%20projMatrix.mul%28viewMatrix.mul%28vec4%28refractedRayExit%2C%201%29%29%29%3B%0A%20%20%20%20%20%20const%20refractionCoords%20%3D%20vec2%28ndcPos.xy.div%28ndcPos.w%29%29.toVar%28%29%3B%0A%20%20%20%20%20%20refractionCoords.addAssign%281%29%3B%0A%20%20%20%20%20%20refractionCoords.divAssign%282%29%3B%0A%20%20%20%20%20%20refractionCoords.assign%28vec2%28refractionCoords.x%2C%20refractionCoords.y.oneMinus%28%29%29%29%3B%0A%20%20%20%20%20%20const%20transmissionSample%20%3D%20getTransmissionSample%28refractionCoords%2C%20roughness2%2C%20ior3%29%3B%0A%20%20%20%20%20%20transmittedLight.element%28i%29.assign%28transmissionSample.element%28i%29%29%3B%0A%20%20%20%20%20%20transmittedLight.a.addAssign%28transmissionSample.a%29%3B%0A%20%20%20%20%20%20transmittance.element%28i%29.assign%28diffuseColor2.element%28i%29.mul%28volumeAttenuation%28length%28transmissionRay%29%2C%20attenuationColor2%2C%20attenuationDistance2%29.element%28i%29%29%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20transmittedLight.a.divAssign%283%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20const%20transmissionRay%20%3D%20getVolumeTransmissionRay%28n%2C%20v%2C%20thickness2%2C%20ior2%2C%20modelMatrix%29%3B%0A%20%20%20%20const%20refractedRayExit%20%3D%20position.add%28transmissionRay%29%3B%0A%20%20%20%20const%20ndcPos%20%3D%20projMatrix.mul%28viewMatrix.mul%28vec4%28refractedRayExit%2C%201%29%29%29%3B%0A%20%20%20%20const%20refractionCoords%20%3D%20vec2%28ndcPos.xy.div%28ndcPos.w%29%29.toVar%28%29%3B%0A%20%20%20%20refractionCoords.addAssign%281%29%3B%0A%20%20%20%20refractionCoords.divAssign%282%29%3B%0A%20%20%20%20refractionCoords.assign%28vec2%28refractionCoords.x%2C%20refractionCoords.y.oneMinus%28%29%29%29%3B%0A%20%20%20%20transmittedLight%20%3D%20getTransmissionSample%28refractionCoords%2C%20roughness2%2C%20ior2%29%3B%0A%20%20%20%20transmittance%20%3D%20diffuseColor2.mul%28volumeAttenuation%28length%28transmissionRay%29%2C%20attenuationColor2%2C%20attenuationDistance2%29%29%3B%0A%20%20%7D%0A%20%20const%20attenuatedColor%20%3D%20transmittance.rgb.mul%28transmittedLight.rgb%29%3B%0A%20%20const%20dotNV%20%3D%20n.dot%28v%29.clamp%28%29%3B%0A%20%20const%20F%20%3D%20vec3%28EnvironmentBRDF%28%7B%0A%20%20%20%20%2F%2F%20n%2C%20v%2C%20specularColor%2C%20specularF90%2C%20roughness%0A%20%20%20%20dotNV%2C%0A%20%20%20%20specularColor%3A%20specularColor2%2C%0A%20%20%20%20specularF90%3A%20specularF902%2C%0A%20%20%20%20roughness%3A%20roughness2%0A%20%20%7D%29%29%3B%0A%20%20const%20transmittanceFactor%20%3D%20transmittance.r.add%28transmittance.g%2C%20transmittance.b%29.div%283%29%3B%0A%20%20return%20vec4%28F.oneMinus%28%29.mul%28attenuatedColor%29%2C%20transmittedLight.a.oneMinus%28%29.mul%28transmittanceFactor%29.oneMinus%28%29%29%3B%0A%7D%29%3B%0Avar%20XYZ_TO_REC709%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20mat3%28%0A%20%203.2404542%2C%0A%20%20-0.969266%2C%0A%20%200.0556434%2C%0A%20%20-1.5371385%2C%0A%20%201.8760108%2C%0A%20%20-0.2040259%2C%0A%20%20-0.4985314%2C%0A%20%200.041556%2C%0A%20%201.0572252%0A%29%3B%0Avar%20Fresnel0ToIor%20%3D%20%28fresnel0%29%20%3D%3E%20%7B%0A%20%20const%20sqrtF0%20%3D%20fresnel0.sqrt%28%29%3B%0A%20%20return%20vec3%281%29.add%28sqrtF0%29.div%28vec3%281%29.sub%28sqrtF0%29%29%3B%0A%7D%3B%0Avar%20IorToFresnel0%20%3D%20%28transmittedIor%2C%20incidentIor%29%20%3D%3E%20%7B%0A%20%20return%20transmittedIor.sub%28incidentIor%29.div%28transmittedIor.add%28incidentIor%29%29.pow2%28%29%3B%0A%7D%3B%0Avar%20evalSensitivity%20%3D%20%28OPD%2C%20shift%29%20%3D%3E%20%7B%0A%20%20const%20phase%20%3D%20OPD.mul%282%20%2A%20Math.PI%20%2A%201e-9%29%3B%0A%20%20const%20val%20%3D%20vec3%2854856e-17%2C%2044201e-17%2C%2052481e-17%29%3B%0A%20%20const%20pos%20%3D%20vec3%281681e3%2C%201795300%2C%202208400%29%3B%0A%20%20const%20VAR%20%3D%20vec3%2843278e5%2C%2093046e5%2C%2066121e5%29%3B%0A%20%20const%20x2%20%3D%20float%289747e-17%20%2A%20Math.sqrt%282%20%2A%20Math.PI%20%2A%2045282e5%29%29.mul%28phase.mul%282239900%29.add%28shift.x%29.cos%28%29%29.mul%28phase.pow2%28%29.mul%28-45282e5%29.exp%28%29%29%3B%0A%20%20let%20xyz%20%3D%20val.mul%28VAR.mul%282%20%2A%20Math.PI%29.sqrt%28%29%29.mul%28pos.mul%28phase%29.add%28shift%29.cos%28%29%29.mul%28phase.pow2%28%29.negate%28%29.mul%28VAR%29.exp%28%29%29%3B%0A%20%20xyz%20%3D%20vec3%28xyz.x.add%28x2%29%2C%20xyz.y%2C%20xyz.z%29.div%2810685e-11%29%3B%0A%20%20const%20rgb2%20%3D%20XYZ_TO_REC709.mul%28xyz%29%3B%0A%20%20return%20rgb2%3B%0A%7D%3B%0Avar%20evalIridescence%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20outsideIOR%2C%20eta2%2C%20cosTheta1%2C%20thinFilmThickness%2C%20baseF0%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20iridescenceIOR2%20%3D%20mix%28outsideIOR%2C%20eta2%2C%20smoothstep2%280%2C%200.03%2C%20thinFilmThickness%29%29%3B%0A%20%20const%20sinTheta2Sq%20%3D%20outsideIOR.div%28iridescenceIOR2%29.pow2%28%29.mul%28cosTheta1.pow2%28%29.oneMinus%28%29%29%3B%0A%20%20const%20cosTheta2Sq%20%3D%20sinTheta2Sq.oneMinus%28%29%3B%0A%20%20If%28cosTheta2Sq.lessThan%280%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20return%20vec3%281%29%3B%0A%20%20%7D%29%3B%0A%20%20const%20cosTheta2%20%3D%20cosTheta2Sq.sqrt%28%29%3B%0A%20%20const%20R0%20%3D%20IorToFresnel0%28iridescenceIOR2%2C%20outsideIOR%29%3B%0A%20%20const%20R12%20%3D%20F_Schlick%28%7B%20f0%3A%20R0%2C%20f90%3A%201%2C%20dotVH%3A%20cosTheta1%20%7D%29%3B%0A%20%20const%20T121%20%3D%20R12.oneMinus%28%29%3B%0A%20%20const%20phi12%20%3D%20iridescenceIOR2.lessThan%28outsideIOR%29.select%28Math.PI%2C%200%29%3B%0A%20%20const%20phi21%20%3D%20float%28Math.PI%29.sub%28phi12%29%3B%0A%20%20const%20baseIOR%20%3D%20Fresnel0ToIor%28baseF0.clamp%280%2C%200.9999%29%29%3B%0A%20%20const%20R1%20%3D%20IorToFresnel0%28baseIOR%2C%20iridescenceIOR2.toVec3%28%29%29%3B%0A%20%20const%20R23%20%3D%20F_Schlick%28%7B%20f0%3A%20R1%2C%20f90%3A%201%2C%20dotVH%3A%20cosTheta2%20%7D%29%3B%0A%20%20const%20phi23%20%3D%20vec3%28%0A%20%20%20%20baseIOR.x.lessThan%28iridescenceIOR2%29.select%28Math.PI%2C%200%29%2C%0A%20%20%20%20baseIOR.y.lessThan%28iridescenceIOR2%29.select%28Math.PI%2C%200%29%2C%0A%20%20%20%20baseIOR.z.lessThan%28iridescenceIOR2%29.select%28Math.PI%2C%200%29%0A%20%20%29%3B%0A%20%20const%20OPD%20%3D%20iridescenceIOR2.mul%28thinFilmThickness%2C%20cosTheta2%2C%202%29%3B%0A%20%20const%20phi%20%3D%20vec3%28phi21%29.add%28phi23%29%3B%0A%20%20const%20R123%20%3D%20R12.mul%28R23%29.clamp%281e-5%2C%200.9999%29%3B%0A%20%20const%20r123%20%3D%20R123.sqrt%28%29%3B%0A%20%20const%20Rs%20%3D%20T121.pow2%28%29.mul%28R23%29.div%28vec3%281%29.sub%28R123%29%29%3B%0A%20%20const%20C0%20%3D%20R12.add%28Rs%29%3B%0A%20%20const%20I%20%3D%20C0.toVar%28%29%3B%0A%20%20const%20Cm%20%3D%20Rs.sub%28T121%29.toVar%28%29%3B%0A%20%20Loop%28%7B%20start%3A%201%2C%20end%3A%202%2C%20condition%3A%20%22%3C%3D%22%2C%20name%3A%20%22m%22%20%7D%2C%20%28%7B%20m%3A%20m2%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20Cm.mulAssign%28r123%29%3B%0A%20%20%20%20const%20Sm%20%3D%20evalSensitivity%28float%28m2%29.mul%28OPD%29%2C%20float%28m2%29.mul%28phi%29%29.mul%282%29%3B%0A%20%20%20%20I.addAssign%28Cm.mul%28Sm%29%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20I.max%28vec3%280%29%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22evalIridescence%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22outsideIOR%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22eta2%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22cosTheta1%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22thinFilmThickness%22%2C%20type%3A%20%22float%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22baseF0%22%2C%20type%3A%20%22vec3%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20IBLSheenBRDF%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20normal%3A%20normal2%2C%20viewDir%2C%20roughness%3A%20roughness2%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20dotNV%20%3D%20normal2.dot%28viewDir%29.saturate%28%29%3B%0A%20%20const%20r2%20%3D%20roughness2.pow2%28%29%3B%0A%20%20const%20a2%20%3D%20select%28%0A%20%20%20%20roughness2.lessThan%280.25%29%2C%0A%20%20%20%20float%28-339.2%29.mul%28r2%29.add%28float%28161.4%29.mul%28roughness2%29%29.sub%2825.9%29%2C%0A%20%20%20%20float%28-8.48%29.mul%28r2%29.add%28float%2814.3%29.mul%28roughness2%29%29.sub%289.95%29%0A%20%20%29%3B%0A%20%20const%20b%20%3D%20select%28%0A%20%20%20%20roughness2.lessThan%280.25%29%2C%0A%20%20%20%20float%2844%29.mul%28r2%29.sub%28float%2823.7%29.mul%28roughness2%29%29.add%283.26%29%2C%0A%20%20%20%20float%281.97%29.mul%28r2%29.sub%28float%283.27%29.mul%28roughness2%29%29.add%280.72%29%0A%20%20%29%3B%0A%20%20const%20DG%20%3D%20select%28roughness2.lessThan%280.25%29%2C%200%2C%20float%280.1%29.mul%28roughness2%29.sub%280.025%29%29.add%28a2.mul%28dotNV%29.add%28b%29.exp%28%29%29%3B%0A%20%20return%20DG.mul%281%20%2F%20Math.PI%29.saturate%28%29%3B%0A%7D%29%3B%0Avar%20clearcoatF0%20%3D%20vec3%280.04%29%3B%0Avar%20clearcoatF90%20%3D%20float%281%29%3B%0Avar%20PhysicalLightingModel%20%3D%20class%20extends%20LightingModel%20%7B%0A%20%20constructor%28clearcoat2%20%3D%20false%2C%20sheen2%20%3D%20false%2C%20iridescence2%20%3D%20false%2C%20anisotropy2%20%3D%20false%2C%20transmission2%20%3D%20false%2C%20dispersion2%20%3D%20false%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.clearcoat%20%3D%20clearcoat2%3B%0A%20%20%20%20this.sheen%20%3D%20sheen2%3B%0A%20%20%20%20this.iridescence%20%3D%20iridescence2%3B%0A%20%20%20%20this.anisotropy%20%3D%20anisotropy2%3B%0A%20%20%20%20this.transmission%20%3D%20transmission2%3B%0A%20%20%20%20this.dispersion%20%3D%20dispersion2%3B%0A%20%20%20%20this.clearcoatRadiance%20%3D%20null%3B%0A%20%20%20%20this.clearcoatSpecularDirect%20%3D%20null%3B%0A%20%20%20%20this.clearcoatSpecularIndirect%20%3D%20null%3B%0A%20%20%20%20this.sheenSpecularDirect%20%3D%20null%3B%0A%20%20%20%20this.sheenSpecularIndirect%20%3D%20null%3B%0A%20%20%20%20this.iridescenceFresnel%20%3D%20null%3B%0A%20%20%20%20this.iridescenceF0%20%3D%20null%3B%0A%20%20%7D%0A%20%20start%28context2%29%20%7B%0A%20%20%20%20if%20%28this.clearcoat%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.clearcoatRadiance%20%3D%20vec3%28%29.toVar%28%22clearcoatRadiance%22%29%3B%0A%20%20%20%20%20%20this.clearcoatSpecularDirect%20%3D%20vec3%28%29.toVar%28%22clearcoatSpecularDirect%22%29%3B%0A%20%20%20%20%20%20this.clearcoatSpecularIndirect%20%3D%20vec3%28%29.toVar%28%22clearcoatSpecularIndirect%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.sheen%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.sheenSpecularDirect%20%3D%20vec3%28%29.toVar%28%22sheenSpecularDirect%22%29%3B%0A%20%20%20%20%20%20this.sheenSpecularIndirect%20%3D%20vec3%28%29.toVar%28%22sheenSpecularIndirect%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.iridescence%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20dotNVi%20%3D%20transformedNormalView.dot%28positionViewDirection%29.clamp%28%29%3B%0A%20%20%20%20%20%20this.iridescenceFresnel%20%3D%20evalIridescence%28%7B%0A%20%20%20%20%20%20%20%20outsideIOR%3A%20float%281%29%2C%0A%20%20%20%20%20%20%20%20eta2%3A%20iridescenceIOR%2C%0A%20%20%20%20%20%20%20%20cosTheta1%3A%20dotNVi%2C%0A%20%20%20%20%20%20%20%20thinFilmThickness%3A%20iridescenceThickness%2C%0A%20%20%20%20%20%20%20%20baseF0%3A%20specularColor%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20this.iridescenceF0%20%3D%20Schlick_to_F0%28%7B%20f%3A%20this.iridescenceFresnel%2C%20f90%3A%201%2C%20dotVH%3A%20dotNVi%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.transmission%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20position%20%3D%20positionWorld%3B%0A%20%20%20%20%20%20const%20v%20%3D%20cameraPosition.sub%28positionWorld%29.normalize%28%29%3B%0A%20%20%20%20%20%20const%20n%20%3D%20transformedNormalWorld%3B%0A%20%20%20%20%20%20context2.backdrop%20%3D%20getIBLVolumeRefraction%28%0A%20%20%20%20%20%20%20%20n%2C%0A%20%20%20%20%20%20%20%20v%2C%0A%20%20%20%20%20%20%20%20roughness%2C%0A%20%20%20%20%20%20%20%20diffuseColor%2C%0A%20%20%20%20%20%20%20%20specularColor%2C%0A%20%20%20%20%20%20%20%20specularF90%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20specularF90%0A%20%20%20%20%20%20%20%20position%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20positionWorld%0A%20%20%20%20%20%20%20%20modelWorldMatrix%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20modelMatrix%0A%20%20%20%20%20%20%20%20cameraViewMatrix%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20viewMatrix%0A%20%20%20%20%20%20%20%20cameraProjectionMatrix%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20projMatrix%0A%20%20%20%20%20%20%20%20ior%2C%0A%20%20%20%20%20%20%20%20thickness%2C%0A%20%20%20%20%20%20%20%20attenuationColor%2C%0A%20%20%20%20%20%20%20%20attenuationDistance%2C%0A%20%20%20%20%20%20%20%20this.dispersion%20%3F%20dispersion%20%3A%20null%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20context2.backdropAlpha%20%3D%20transmission%3B%0A%20%20%20%20%20%20diffuseColor.a.mulAssign%28mix%281%2C%20context2.backdrop.a%2C%20transmission%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2F%20Fdez-Ag%C3%83%C2%BCera%27s%20%22Multiple-Scattering%20Microfacet%20Model%20for%20Real-Time%20Image%20Based%20Lighting%22%0A%20%20%2F%2F%20Approximates%20multiscattering%20in%20order%20to%20preserve%20energy.%0A%20%20%2F%2F%20http%3A%2F%2Fwww.jcgt.org%2Fpublished%2F0008%2F01%2F03%2F%0A%20%20computeMultiscattering%28singleScatter%2C%20multiScatter%2C%20specularF902%29%20%7B%0A%20%20%20%20const%20dotNV%20%3D%20transformedNormalView.dot%28positionViewDirection%29.clamp%28%29%3B%0A%20%20%20%20const%20fab%20%3D%20DFGApprox%28%7B%20roughness%2C%20dotNV%20%7D%29%3B%0A%20%20%20%20const%20Fr%20%3D%20this.iridescenceF0%20%3F%20iridescence.mix%28specularColor%2C%20this.iridescenceF0%29%20%3A%20specularColor%3B%0A%20%20%20%20const%20FssEss%20%3D%20Fr.mul%28fab.x%29.add%28specularF902.mul%28fab.y%29%29%3B%0A%20%20%20%20const%20Ess%20%3D%20fab.x.add%28fab.y%29%3B%0A%20%20%20%20const%20Ems%20%3D%20Ess.oneMinus%28%29%3B%0A%20%20%20%20const%20Favg%20%3D%20specularColor.add%28specularColor.oneMinus%28%29.mul%280.047619%29%29%3B%0A%20%20%20%20const%20Fms%20%3D%20FssEss.mul%28Favg%29.div%28Ems.mul%28Favg%29.oneMinus%28%29%29%3B%0A%20%20%20%20singleScatter.addAssign%28FssEss%29%3B%0A%20%20%20%20multiScatter.addAssign%28Fms.mul%28Ems%29%29%3B%0A%20%20%7D%0A%20%20direct%28%7B%20lightDirection%2C%20lightColor%2C%20reflectedLight%20%7D%29%20%7B%0A%20%20%20%20const%20dotNL%20%3D%20transformedNormalView.dot%28lightDirection%29.clamp%28%29%3B%0A%20%20%20%20const%20irradiance%20%3D%20dotNL.mul%28lightColor%29%3B%0A%20%20%20%20if%20%28this.sheen%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.sheenSpecularDirect.addAssign%28irradiance.mul%28BRDF_Sheen%28%7B%20lightDirection%20%7D%29%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearcoat%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20dotNLcc%20%3D%20transformedClearcoatNormalView.dot%28lightDirection%29.clamp%28%29%3B%0A%20%20%20%20%20%20const%20ccIrradiance%20%3D%20dotNLcc.mul%28lightColor%29%3B%0A%20%20%20%20%20%20this.clearcoatSpecularDirect.addAssign%28ccIrradiance.mul%28BRDF_GGX%28%7B%20lightDirection%2C%20f0%3A%20clearcoatF0%2C%20f90%3A%20clearcoatF90%2C%20roughness%3A%20clearcoatRoughness%2C%20normalView%3A%20transformedClearcoatNormalView%20%7D%29%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20reflectedLight.directDiffuse.addAssign%28irradiance.mul%28BRDF_Lambert%28%7B%20diffuseColor%3A%20diffuseColor.rgb%20%7D%29%29%29%3B%0A%20%20%20%20reflectedLight.directSpecular.addAssign%28irradiance.mul%28BRDF_GGX%28%7B%20lightDirection%2C%20f0%3A%20specularColor%2C%20f90%3A%201%2C%20roughness%2C%20iridescence%3A%20this.iridescence%2C%20f%3A%20this.iridescenceFresnel%2C%20USE_IRIDESCENCE%3A%20this.iridescence%2C%20USE_ANISOTROPY%3A%20this.anisotropy%20%7D%29%29%29%3B%0A%20%20%7D%0A%20%20directRectArea%28%7B%20lightColor%2C%20lightPosition%3A%20lightPosition2%2C%20halfWidth%2C%20halfHeight%2C%20reflectedLight%2C%20ltc_1%2C%20ltc_2%20%7D%29%20%7B%0A%20%20%20%20const%20p0%20%3D%20lightPosition2.add%28halfWidth%29.sub%28halfHeight%29%3B%0A%20%20%20%20const%20p1%20%3D%20lightPosition2.sub%28halfWidth%29.sub%28halfHeight%29%3B%0A%20%20%20%20const%20p2%20%3D%20lightPosition2.sub%28halfWidth%29.add%28halfHeight%29%3B%0A%20%20%20%20const%20p3%20%3D%20lightPosition2.add%28halfWidth%29.add%28halfHeight%29%3B%0A%20%20%20%20const%20N%20%3D%20transformedNormalView%3B%0A%20%20%20%20const%20V%20%3D%20positionViewDirection%3B%0A%20%20%20%20const%20P%20%3D%20positionView.toVar%28%29%3B%0A%20%20%20%20const%20uv2%20%3D%20LTC_Uv%28%7B%20N%2C%20V%2C%20roughness%20%7D%29%3B%0A%20%20%20%20const%20t1%20%3D%20ltc_1.uv%28uv2%29.toVar%28%29%3B%0A%20%20%20%20const%20t2%20%3D%20ltc_2.uv%28uv2%29.toVar%28%29%3B%0A%20%20%20%20const%20mInv%20%3D%20mat3%28%0A%20%20%20%20%20%20vec3%28t1.x%2C%200%2C%20t1.y%29%2C%0A%20%20%20%20%20%20vec3%280%2C%201%2C%200%29%2C%0A%20%20%20%20%20%20vec3%28t1.z%2C%200%2C%20t1.w%29%0A%20%20%20%20%29.toVar%28%29%3B%0A%20%20%20%20const%20fresnel%20%3D%20specularColor.mul%28t2.x%29.add%28specularColor.oneMinus%28%29.mul%28t2.y%29%29.toVar%28%29%3B%0A%20%20%20%20reflectedLight.directSpecular.addAssign%28lightColor.mul%28fresnel%29.mul%28LTC_Evaluate%28%7B%20N%2C%20V%2C%20P%2C%20mInv%2C%20p0%2C%20p1%2C%20p2%2C%20p3%20%7D%29%29%29%3B%0A%20%20%20%20reflectedLight.directDiffuse.addAssign%28lightColor.mul%28diffuseColor%29.mul%28LTC_Evaluate%28%7B%20N%2C%20V%2C%20P%2C%20mInv%3A%20mat3%281%2C%200%2C%200%2C%200%2C%201%2C%200%2C%200%2C%200%2C%201%29%2C%20p0%2C%20p1%2C%20p2%2C%20p3%20%7D%29%29%29%3B%0A%20%20%7D%0A%20%20indirect%28context2%2C%20stack2%2C%20builder%29%20%7B%0A%20%20%20%20this.indirectDiffuse%28context2%2C%20stack2%2C%20builder%29%3B%0A%20%20%20%20this.indirectSpecular%28context2%2C%20stack2%2C%20builder%29%3B%0A%20%20%20%20this.ambientOcclusion%28context2%2C%20stack2%2C%20builder%29%3B%0A%20%20%7D%0A%20%20indirectDiffuse%28%7B%20irradiance%2C%20reflectedLight%20%7D%29%20%7B%0A%20%20%20%20reflectedLight.indirectDiffuse.addAssign%28irradiance.mul%28BRDF_Lambert%28%7B%20diffuseColor%20%7D%29%29%29%3B%0A%20%20%7D%0A%20%20indirectSpecular%28%7B%20radiance%2C%20iblIrradiance%2C%20reflectedLight%20%7D%29%20%7B%0A%20%20%20%20if%20%28this.sheen%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.sheenSpecularIndirect.addAssign%28iblIrradiance.mul%28%0A%20%20%20%20%20%20%20%20sheen%2C%0A%20%20%20%20%20%20%20%20IBLSheenBRDF%28%7B%0A%20%20%20%20%20%20%20%20%20%20normal%3A%20transformedNormalView%2C%0A%20%20%20%20%20%20%20%20%20%20viewDir%3A%20positionViewDirection%2C%0A%20%20%20%20%20%20%20%20%20%20roughness%3A%20sheenRoughness%0A%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearcoat%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20dotNVcc%20%3D%20transformedClearcoatNormalView.dot%28positionViewDirection%29.clamp%28%29%3B%0A%20%20%20%20%20%20const%20clearcoatEnv%20%3D%20EnvironmentBRDF%28%7B%0A%20%20%20%20%20%20%20%20dotNV%3A%20dotNVcc%2C%0A%20%20%20%20%20%20%20%20specularColor%3A%20clearcoatF0%2C%0A%20%20%20%20%20%20%20%20specularF90%3A%20clearcoatF90%2C%0A%20%20%20%20%20%20%20%20roughness%3A%20clearcoatRoughness%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20this.clearcoatSpecularIndirect.addAssign%28this.clearcoatRadiance.mul%28clearcoatEnv%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20singleScattering%20%3D%20vec3%28%29.toVar%28%22singleScattering%22%29%3B%0A%20%20%20%20const%20multiScattering%20%3D%20vec3%28%29.toVar%28%22multiScattering%22%29%3B%0A%20%20%20%20const%20cosineWeightedIrradiance%20%3D%20iblIrradiance.mul%281%20%2F%20Math.PI%29%3B%0A%20%20%20%20this.computeMultiscattering%28singleScattering%2C%20multiScattering%2C%20specularF90%29%3B%0A%20%20%20%20const%20totalScattering%20%3D%20singleScattering.add%28multiScattering%29%3B%0A%20%20%20%20const%20diffuse%20%3D%20diffuseColor.mul%28totalScattering.r.max%28totalScattering.g%29.max%28totalScattering.b%29.oneMinus%28%29%29%3B%0A%20%20%20%20reflectedLight.indirectSpecular.addAssign%28radiance.mul%28singleScattering%29%29%3B%0A%20%20%20%20reflectedLight.indirectSpecular.addAssign%28multiScattering.mul%28cosineWeightedIrradiance%29%29%3B%0A%20%20%20%20reflectedLight.indirectDiffuse.addAssign%28diffuse.mul%28cosineWeightedIrradiance%29%29%3B%0A%20%20%7D%0A%20%20ambientOcclusion%28%7B%20ambientOcclusion%2C%20reflectedLight%20%7D%29%20%7B%0A%20%20%20%20const%20dotNV%20%3D%20transformedNormalView.dot%28positionViewDirection%29.clamp%28%29%3B%0A%20%20%20%20const%20aoNV%20%3D%20dotNV.add%28ambientOcclusion%29%3B%0A%20%20%20%20const%20aoExp%20%3D%20roughness.mul%28-16%29.oneMinus%28%29.negate%28%29.exp2%28%29%3B%0A%20%20%20%20const%20aoNode%20%3D%20ambientOcclusion.sub%28aoNV.pow%28aoExp%29.oneMinus%28%29%29.clamp%28%29%3B%0A%20%20%20%20if%20%28this.clearcoat%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.clearcoatSpecularIndirect.mulAssign%28ambientOcclusion%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.sheen%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.sheenSpecularIndirect.mulAssign%28ambientOcclusion%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20reflectedLight.indirectDiffuse.mulAssign%28ambientOcclusion%29%3B%0A%20%20%20%20reflectedLight.indirectSpecular.mulAssign%28aoNode%29%3B%0A%20%20%7D%0A%20%20finish%28context2%29%20%7B%0A%20%20%20%20const%20%7B%20outgoingLight%20%7D%20%3D%20context2%3B%0A%20%20%20%20if%20%28this.clearcoat%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20dotNVcc%20%3D%20transformedClearcoatNormalView.dot%28positionViewDirection%29.clamp%28%29%3B%0A%20%20%20%20%20%20const%20Fcc%20%3D%20F_Schlick%28%7B%0A%20%20%20%20%20%20%20%20dotVH%3A%20dotNVcc%2C%0A%20%20%20%20%20%20%20%20f0%3A%20clearcoatF0%2C%0A%20%20%20%20%20%20%20%20f90%3A%20clearcoatF90%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20const%20clearcoatLight%20%3D%20outgoingLight.mul%28clearcoat.mul%28Fcc%29.oneMinus%28%29%29.add%28this.clearcoatSpecularDirect.add%28this.clearcoatSpecularIndirect%29.mul%28clearcoat%29%29%3B%0A%20%20%20%20%20%20outgoingLight.assign%28clearcoatLight%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.sheen%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20sheenEnergyComp%20%3D%20sheen.r.max%28sheen.g%29.max%28sheen.b%29.mul%280.157%29.oneMinus%28%29%3B%0A%20%20%20%20%20%20const%20sheenLight%20%3D%20outgoingLight.mul%28sheenEnergyComp%29.add%28this.sheenSpecularDirect%2C%20this.sheenSpecularIndirect%29%3B%0A%20%20%20%20%20%20outgoingLight.assign%28sheenLight%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20cubeUV_r0%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%281%29%3B%0Avar%20cubeUV_m0%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%28-2%29%3B%0Avar%20cubeUV_r1%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%280.8%29%3B%0Avar%20cubeUV_m1%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%28-1%29%3B%0Avar%20cubeUV_r4%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%280.4%29%3B%0Avar%20cubeUV_m4%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%282%29%3B%0Avar%20cubeUV_r5%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%280.305%29%3B%0Avar%20cubeUV_m5%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%283%29%3B%0Avar%20cubeUV_r6%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%280.21%29%3B%0Avar%20cubeUV_m6%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%284%29%3B%0Avar%20cubeUV_minMipLevel%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%284%29%3B%0Avar%20cubeUV_minTileSize%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20float%2816%29%3B%0Avar%20getFace%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bdirection2%5D%29%20%3D%3E%20%7B%0A%20%20const%20absDirection%20%3D%20vec3%28abs%28direction2%29%29.toVar%28%29%3B%0A%20%20const%20face%20%3D%20float%28-1%29.toVar%28%29%3B%0A%20%20If%28absDirection.x.greaterThan%28absDirection.z%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20If%28absDirection.x.greaterThan%28absDirection.y%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20face.assign%28select%28direction2.x.greaterThan%280%29%2C%200%2C%203%29%29%3B%0A%20%20%20%20%7D%29.Else%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20face.assign%28select%28direction2.y.greaterThan%280%29%2C%201%2C%204%29%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%29.Else%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20If%28absDirection.z.greaterThan%28absDirection.y%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20face.assign%28select%28direction2.z.greaterThan%280%29%2C%202%2C%205%29%29%3B%0A%20%20%20%20%7D%29.Else%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20face.assign%28select%28direction2.y.greaterThan%280%29%2C%201%2C%204%29%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20face%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22getFace%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22direction%22%2C%20type%3A%20%22vec3%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20getUV%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bdirection2%2C%20face%5D%29%20%3D%3E%20%7B%0A%20%20const%20uv2%20%3D%20vec2%28%29.toVar%28%29%3B%0A%20%20If%28face.equal%280%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20uv2.assign%28vec2%28direction2.z%2C%20direction2.y%29.div%28abs%28direction2.x%29%29%29%3B%0A%20%20%7D%29.ElseIf%28face.equal%281%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20uv2.assign%28vec2%28direction2.x.negate%28%29%2C%20direction2.z.negate%28%29%29.div%28abs%28direction2.y%29%29%29%3B%0A%20%20%7D%29.ElseIf%28face.equal%282%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20uv2.assign%28vec2%28direction2.x.negate%28%29%2C%20direction2.y%29.div%28abs%28direction2.z%29%29%29%3B%0A%20%20%7D%29.ElseIf%28face.equal%283%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20uv2.assign%28vec2%28direction2.z.negate%28%29%2C%20direction2.y%29.div%28abs%28direction2.x%29%29%29%3B%0A%20%20%7D%29.ElseIf%28face.equal%284%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20uv2.assign%28vec2%28direction2.x.negate%28%29%2C%20direction2.z%29.div%28abs%28direction2.y%29%29%29%3B%0A%20%20%7D%29.Else%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20uv2.assign%28vec2%28direction2.x%2C%20direction2.y%29.div%28abs%28direction2.z%29%29%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20mul%280.5%2C%20uv2.add%281%29%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22getUV%22%2C%0A%20%20type%3A%20%22vec2%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22direction%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22face%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20roughnessToMip%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Broughness2%5D%29%20%3D%3E%20%7B%0A%20%20const%20mip%20%3D%20float%280%29.toVar%28%29%3B%0A%20%20If%28roughness2.greaterThanEqual%28cubeUV_r1%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20mip.assign%28cubeUV_r0.sub%28roughness2%29.mul%28cubeUV_m1.sub%28cubeUV_m0%29%29.div%28cubeUV_r0.sub%28cubeUV_r1%29%29.add%28cubeUV_m0%29%29%3B%0A%20%20%7D%29.ElseIf%28roughness2.greaterThanEqual%28cubeUV_r4%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20mip.assign%28cubeUV_r1.sub%28roughness2%29.mul%28cubeUV_m4.sub%28cubeUV_m1%29%29.div%28cubeUV_r1.sub%28cubeUV_r4%29%29.add%28cubeUV_m1%29%29%3B%0A%20%20%7D%29.ElseIf%28roughness2.greaterThanEqual%28cubeUV_r5%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20mip.assign%28cubeUV_r4.sub%28roughness2%29.mul%28cubeUV_m5.sub%28cubeUV_m4%29%29.div%28cubeUV_r4.sub%28cubeUV_r5%29%29.add%28cubeUV_m4%29%29%3B%0A%20%20%7D%29.ElseIf%28roughness2.greaterThanEqual%28cubeUV_r6%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20mip.assign%28cubeUV_r5.sub%28roughness2%29.mul%28cubeUV_m6.sub%28cubeUV_m5%29%29.div%28cubeUV_r5.sub%28cubeUV_r6%29%29.add%28cubeUV_m5%29%29%3B%0A%20%20%7D%29.Else%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20mip.assign%28float%28-2%29.mul%28log2%28mul%281.16%2C%20roughness2%29%29%29%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20mip%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22roughnessToMip%22%2C%0A%20%20type%3A%20%22float%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22roughness%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20getDirection%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Buv_immutable%2C%20face%5D%29%20%3D%3E%20%7B%0A%20%20const%20uv2%20%3D%20uv_immutable.toVar%28%29%3B%0A%20%20uv2.assign%28mul%282%2C%20uv2%29.sub%281%29%29%3B%0A%20%20const%20direction2%20%3D%20vec3%28uv2%2C%201%29.toVar%28%29%3B%0A%20%20If%28face.equal%280%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20direction2.assign%28direction2.zyx%29%3B%0A%20%20%7D%29.ElseIf%28face.equal%281%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20direction2.assign%28direction2.xzy%29%3B%0A%20%20%20%20direction2.xz.mulAssign%28-1%29%3B%0A%20%20%7D%29.ElseIf%28face.equal%282%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20direction2.x.mulAssign%28-1%29%3B%0A%20%20%7D%29.ElseIf%28face.equal%283%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20direction2.assign%28direction2.zyx%29%3B%0A%20%20%20%20direction2.xz.mulAssign%28-1%29%3B%0A%20%20%7D%29.ElseIf%28face.equal%284%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20direction2.assign%28direction2.xzy%29%3B%0A%20%20%20%20direction2.xy.mulAssign%28-1%29%3B%0A%20%20%7D%29.ElseIf%28face.equal%285%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20direction2.z.mulAssign%28-1%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20direction2%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22getDirection%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22uv%22%2C%20type%3A%20%22vec2%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22face%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20textureCubeUV%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5BenvMap%2C%20sampleDir_immutable%2C%20roughness_immutable%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%5D%29%20%3D%3E%20%7B%0A%20%20const%20roughness2%20%3D%20float%28roughness_immutable%29%3B%0A%20%20const%20sampleDir%20%3D%20vec3%28sampleDir_immutable%29%3B%0A%20%20const%20mip%20%3D%20clamp2%28roughnessToMip%28roughness2%29%2C%20cubeUV_m0%2C%20CUBEUV_MAX_MIP%29%3B%0A%20%20const%20mipF%20%3D%20fract%28mip%29%3B%0A%20%20const%20mipInt%20%3D%20floor%28mip%29%3B%0A%20%20const%20color0%20%3D%20vec3%28bilinearCubeUV%28envMap%2C%20sampleDir%2C%20mipInt%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%29%29.toVar%28%29%3B%0A%20%20If%28mipF.notEqual%280%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20const%20color1%20%3D%20vec3%28bilinearCubeUV%28envMap%2C%20sampleDir%2C%20mipInt.add%281%29%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%29%29.toVar%28%29%3B%0A%20%20%20%20color0.assign%28mix%28color0%2C%20color1%2C%20mipF%29%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20color0%3B%0A%7D%29%3B%0Avar%20bilinearCubeUV%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5BenvMap%2C%20direction_immutable%2C%20mipInt_immutable%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%5D%29%20%3D%3E%20%7B%0A%20%20const%20mipInt%20%3D%20float%28mipInt_immutable%29.toVar%28%29%3B%0A%20%20const%20direction2%20%3D%20vec3%28direction_immutable%29%3B%0A%20%20const%20face%20%3D%20float%28getFace%28direction2%29%29.toVar%28%29%3B%0A%20%20const%20filterInt%20%3D%20float%28max%241%28cubeUV_minMipLevel.sub%28mipInt%29%2C%200%29%29.toVar%28%29%3B%0A%20%20mipInt.assign%28max%241%28mipInt%2C%20cubeUV_minMipLevel%29%29%3B%0A%20%20const%20faceSize%20%3D%20float%28exp2%28mipInt%29%29.toVar%28%29%3B%0A%20%20const%20uv2%20%3D%20vec2%28getUV%28direction2%2C%20face%29.mul%28faceSize.sub%282%29%29.add%281%29%29.toVar%28%29%3B%0A%20%20If%28face.greaterThan%282%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20uv2.y.addAssign%28faceSize%29%3B%0A%20%20%20%20face.subAssign%283%29%3B%0A%20%20%7D%29%3B%0A%20%20uv2.x.addAssign%28face.mul%28faceSize%29%29%3B%0A%20%20uv2.x.addAssign%28filterInt.mul%28mul%283%2C%20cubeUV_minTileSize%29%29%29%3B%0A%20%20uv2.y.addAssign%28mul%284%2C%20exp2%28CUBEUV_MAX_MIP%29.sub%28faceSize%29%29%29%3B%0A%20%20uv2.x.mulAssign%28CUBEUV_TEXEL_WIDTH%29%3B%0A%20%20uv2.y.mulAssign%28CUBEUV_TEXEL_HEIGHT%29%3B%0A%20%20return%20envMap.uv%28uv2%29.grad%28vec2%28%29%2C%20vec2%28%29%29%3B%0A%7D%29%3B%0Avar%20getSample%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20envMap%2C%20mipInt%2C%20outputDirection%3A%20outputDirection2%2C%20theta%2C%20axis%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20cosTheta%20%3D%20cos%28theta%29%3B%0A%20%20const%20sampleDirection%20%3D%20outputDirection2.mul%28cosTheta%29.add%28axis.cross%28outputDirection2%29.mul%28sin%28theta%29%29%29.add%28axis.mul%28axis.dot%28outputDirection2%29.mul%28cosTheta.oneMinus%28%29%29%29%29%3B%0A%20%20return%20bilinearCubeUV%28envMap%2C%20sampleDirection%2C%20mipInt%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%29%3B%0A%7D%29%3B%0Avar%20blur%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20n%2C%20latitudinal%2C%20poleAxis%2C%20outputDirection%3A%20outputDirection2%2C%20weights%2C%20samples%2C%20dTheta%2C%20mipInt%2C%20envMap%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20axis%20%3D%20vec3%28select%28latitudinal%2C%20poleAxis%2C%20cross%28poleAxis%2C%20outputDirection2%29%29%29.toVar%28%29%3B%0A%20%20If%28all%28axis.equals%28vec3%280%29%29%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20axis.assign%28vec3%28outputDirection2.z%2C%200%2C%20outputDirection2.x.negate%28%29%29%29%3B%0A%20%20%7D%29%3B%0A%20%20axis.assign%28normalize2%28axis%29%29%3B%0A%20%20const%20gl_FragColor%20%3D%20vec3%28%29.toVar%28%29%3B%0A%20%20gl_FragColor.addAssign%28weights.element%28int%280%29%29.mul%28getSample%28%7B%20theta%3A%200%2C%20axis%2C%20outputDirection%3A%20outputDirection2%2C%20mipInt%2C%20envMap%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%20%7D%29%29%29%3B%0A%20%20Loop%28%7B%20start%3A%20int%281%29%2C%20end%3A%20n%20%7D%2C%20%28%7B%20i%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20If%28i.greaterThanEqual%28samples%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20Break%28%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20theta%20%3D%20float%28dTheta.mul%28float%28i%29%29%29.toVar%28%29%3B%0A%20%20%20%20gl_FragColor.addAssign%28weights.element%28i%29.mul%28getSample%28%7B%20theta%3A%20theta.mul%28-1%29%2C%20axis%2C%20outputDirection%3A%20outputDirection2%2C%20mipInt%2C%20envMap%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%20%7D%29%29%29%3B%0A%20%20%20%20gl_FragColor.addAssign%28weights.element%28i%29.mul%28getSample%28%7B%20theta%2C%20axis%2C%20outputDirection%3A%20outputDirection2%2C%20mipInt%2C%20envMap%2C%20CUBEUV_TEXEL_WIDTH%2C%20CUBEUV_TEXEL_HEIGHT%2C%20CUBEUV_MAX_MIP%20%7D%29%29%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20vec4%28gl_FragColor%2C%201%29%3B%0A%7D%29%3B%0Avar%20_generator%20%3D%20null%3B%0Avar%20_cache2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Afunction%20_generateCubeUVSize%28imageHeight%29%20%7B%0A%20%20const%20maxMip%20%3D%20Math.log2%28imageHeight%29%20-%202%3B%0A%20%20const%20texelHeight%20%3D%201%20%2F%20imageHeight%3B%0A%20%20const%20texelWidth%20%3D%201%20%2F%20%283%20%2A%20Math.max%28Math.pow%282%2C%20maxMip%29%2C%207%20%2A%2016%29%29%3B%0A%20%20return%20%7B%20texelWidth%2C%20texelHeight%2C%20maxMip%20%7D%3B%0A%7D%0Afunction%20_getPMREMFromTexture%28texture2%29%20%7B%0A%20%20let%20cacheTexture%20%3D%20_cache2.get%28texture2%29%3B%0A%20%20const%20pmremVersion%20%3D%20cacheTexture%20%21%3D%3D%20void%200%20%3F%20cacheTexture.pmremVersion%20%3A%20-1%3B%0A%20%20if%20%28pmremVersion%20%21%3D%3D%20texture2.pmremVersion%29%20%7B%0A%20%20%20%20const%20image%20%3D%20texture2.image%3B%0A%20%20%20%20if%20%28texture2.isCubeTexture%29%20%7B%0A%20%20%20%20%20%20if%20%28isCubeMapReady%28image%29%29%20%7B%0A%20%20%20%20%20%20%20%20cacheTexture%20%3D%20_generator.fromCubemap%28texture2%2C%20cacheTexture%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28isEquirectangularMapReady%28image%29%29%20%7B%0A%20%20%20%20%20%20%20%20cacheTexture%20%3D%20_generator.fromEquirectangular%28texture2%2C%20cacheTexture%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20cacheTexture.pmremVersion%20%3D%20texture2.pmremVersion%3B%0A%20%20%20%20_cache2.set%28texture2%2C%20cacheTexture%29%3B%0A%20%20%7D%0A%20%20return%20cacheTexture.texture%3B%0A%7D%0Avar%20PMREMNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22PMREMNode%22%3B%0A%20%20%7D%0A%20%20constructor%28value%2C%20uvNode%20%3D%20null%2C%20levelNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%22vec3%22%29%3B%0A%20%20%20%20this._value%20%3D%20value%3B%0A%20%20%20%20this._pmrem%20%3D%20null%3B%0A%20%20%20%20this.uvNode%20%3D%20uvNode%3B%0A%20%20%20%20this.levelNode%20%3D%20levelNode%3B%0A%20%20%20%20this._generator%20%3D%20null%3B%0A%20%20%20%20const%20defaultTexture%20%3D%20new%20Texture2%28%29%3B%0A%20%20%20%20defaultTexture.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20this._texture%20%3D%20texture%28defaultTexture%29%3B%0A%20%20%20%20this._width%20%3D%20uniform%280%29%3B%0A%20%20%20%20this._height%20%3D%20uniform%280%29%3B%0A%20%20%20%20this._maxMip%20%3D%20uniform%280%29%3B%0A%20%20%20%20this.updateBeforeType%20%3D%20NodeUpdateType.RENDER%3B%0A%20%20%7D%0A%20%20set%20value%28value%29%20%7B%0A%20%20%20%20this._value%20%3D%20value%3B%0A%20%20%20%20this._pmrem%20%3D%20null%3B%0A%20%20%7D%0A%20%20get%20value%28%29%20%7B%0A%20%20%20%20return%20this._value%3B%0A%20%20%7D%0A%20%20updateFromTexture%28texture2%29%20%7B%0A%20%20%20%20const%20cubeUVSize%20%3D%20_generateCubeUVSize%28texture2.image.height%29%3B%0A%20%20%20%20this._texture.value%20%3D%20texture2%3B%0A%20%20%20%20this._width.value%20%3D%20cubeUVSize.texelWidth%3B%0A%20%20%20%20this._height.value%20%3D%20cubeUVSize.texelHeight%3B%0A%20%20%20%20this._maxMip.value%20%3D%20cubeUVSize.maxMip%3B%0A%20%20%7D%0A%20%20updateBefore%28%29%20%7B%0A%20%20%20%20let%20pmrem%20%3D%20this._pmrem%3B%0A%20%20%20%20const%20pmremVersion%20%3D%20pmrem%20%3F%20pmrem.pmremVersion%20%3A%20-1%3B%0A%20%20%20%20const%20texture2%20%3D%20this._value%3B%0A%20%20%20%20if%20%28pmremVersion%20%21%3D%3D%20texture2.pmremVersion%29%20%7B%0A%20%20%20%20%20%20if%20%28texture2.isPMREMTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20pmrem%20%3D%20texture2%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20pmrem%20%3D%20_getPMREMFromTexture%28texture2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28pmrem%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this._pmrem%20%3D%20pmrem%3B%0A%20%20%20%20%20%20%20%20this.updateFromTexture%28pmrem%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20if%20%28_generator%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20_generator%20%3D%20builder.createPMREMGenerator%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.updateBefore%28builder%29%3B%0A%20%20%20%20let%20uvNode%20%3D%20this.uvNode%3B%0A%20%20%20%20if%20%28uvNode%20%3D%3D%3D%20null%20%26%26%20builder.context.getUV%29%20%7B%0A%20%20%20%20%20%20uvNode%20%3D%20builder.context.getUV%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20texture2%20%3D%20this.value%3B%0A%20%20%20%20if%20%28builder.renderer.coordinateSystem%20%3D%3D%3D%20WebGLCoordinateSystem2%20%26%26%20texture2.isPMREMTexture%20%21%3D%3D%20true%20%26%26%20texture2.isRenderTargetTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20uvNode%20%3D%20vec3%28uvNode.x.negate%28%29%2C%20uvNode.yz%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20levelNode%20%3D%20this.levelNode%3B%0A%20%20%20%20if%20%28levelNode%20%3D%3D%3D%20null%20%26%26%20builder.context.getTextureLevel%29%20%7B%0A%20%20%20%20%20%20levelNode%20%3D%20builder.context.getTextureLevel%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20textureCubeUV%28this._texture%2C%20uvNode%2C%20levelNode%2C%20this._width%2C%20this._height%2C%20this._maxMip%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20isCubeMapReady%28image%29%20%7B%0A%20%20if%20%28image%20%3D%3D%3D%20null%20%7C%7C%20image%20%3D%3D%3D%20void%200%29%20return%20false%3B%0A%20%20let%20count%20%3D%200%3B%0A%20%20const%20length2%20%3D%206%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20length2%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20if%20%28image%5Bi%5D%20%21%3D%3D%20void%200%29%20count%2B%2B%3B%0A%20%20%7D%0A%20%20return%20count%20%3D%3D%3D%20length2%3B%0A%7D%0Afunction%20isEquirectangularMapReady%28image%29%20%7B%0A%20%20if%20%28image%20%3D%3D%3D%20null%20%7C%7C%20image%20%3D%3D%3D%20void%200%29%20return%20false%3B%0A%20%20return%20image.height%20%3E%200%3B%0A%7D%0Avar%20pmremTexture%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28PMREMNode%29%3B%0Avar%20_envNodeCache%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Avar%20EnvironmentNode%20%3D%20class%20extends%20LightingNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22EnvironmentNode%22%3B%0A%20%20%7D%0A%20%20constructor%28envNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.envNode%20%3D%20envNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20material%20%7D%20%3D%20builder%3B%0A%20%20%20%20let%20envNode%20%3D%20this.envNode%3B%0A%20%20%20%20if%20%28envNode.isTextureNode%20%7C%7C%20envNode.isMaterialReferenceNode%29%20%7B%0A%20%20%20%20%20%20const%20value%20%3D%20envNode.isTextureNode%20%3F%20envNode.value%20%3A%20material%5BenvNode.property%5D%3B%0A%20%20%20%20%20%20let%20cacheEnvNode%20%3D%20_envNodeCache.get%28value%29%3B%0A%20%20%20%20%20%20if%20%28cacheEnvNode%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20cacheEnvNode%20%3D%20pmremTexture%28value%29%3B%0A%20%20%20%20%20%20%20%20_envNodeCache.set%28value%2C%20cacheEnvNode%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20envNode%20%3D%20cacheEnvNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20envMap%20%3D%20material.envMap%3B%0A%20%20%20%20const%20intensity%20%3D%20envMap%20%3F%20reference%28%22envMapIntensity%22%2C%20%22float%22%2C%20builder.material%29%20%3A%20reference%28%22environmentIntensity%22%2C%20%22float%22%2C%20builder.scene%29%3B%0A%20%20%20%20const%20useAnisotropy%20%3D%20material.useAnisotropy%20%3D%3D%3D%20true%20%7C%7C%20material.anisotropy%20%3E%200%3B%0A%20%20%20%20const%20radianceNormalView%20%3D%20useAnisotropy%20%3F%20transformedBentNormalView%20%3A%20transformedNormalView%3B%0A%20%20%20%20const%20radiance%20%3D%20envNode.context%28createRadianceContext%28roughness%2C%20radianceNormalView%29%29.mul%28intensity%29%3B%0A%20%20%20%20const%20irradiance%20%3D%20envNode.context%28createIrradianceContext%28transformedNormalWorld%29%29.mul%28Math.PI%29.mul%28intensity%29%3B%0A%20%20%20%20const%20isolateRadiance%20%3D%20cache%28radiance%29%3B%0A%20%20%20%20const%20isolateIrradiance%20%3D%20cache%28irradiance%29%3B%0A%20%20%20%20builder.context.radiance.addAssign%28isolateRadiance%29%3B%0A%20%20%20%20builder.context.iblIrradiance.addAssign%28isolateIrradiance%29%3B%0A%20%20%20%20const%20clearcoatRadiance%20%3D%20builder.context.lightingModel.clearcoatRadiance%3B%0A%20%20%20%20if%20%28clearcoatRadiance%29%20%7B%0A%20%20%20%20%20%20const%20clearcoatRadianceContext%20%3D%20envNode.context%28createRadianceContext%28clearcoatRoughness%2C%20transformedClearcoatNormalView%29%29.mul%28intensity%29%3B%0A%20%20%20%20%20%20const%20isolateClearcoatRadiance%20%3D%20cache%28clearcoatRadianceContext%29%3B%0A%20%20%20%20%20%20clearcoatRadiance.addAssign%28isolateClearcoatRadiance%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20createRadianceContext%20%3D%20%28roughnessNode%2C%20normalViewNode%29%20%3D%3E%20%7B%0A%20%20let%20reflectVec%20%3D%20null%3B%0A%20%20return%20%7B%0A%20%20%20%20getUV%3A%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20if%20%28reflectVec%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20reflectVec%20%3D%20positionViewDirection.negate%28%29.reflect%28normalViewNode%29%3B%0A%20%20%20%20%20%20%20%20reflectVec%20%3D%20roughnessNode.mul%28roughnessNode%29.mix%28reflectVec%2C%20normalViewNode%29.normalize%28%29%3B%0A%20%20%20%20%20%20%20%20reflectVec%20%3D%20reflectVec.transformDirection%28cameraViewMatrix%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20reflectVec%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20getTextureLevel%3A%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20return%20roughnessNode%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%3B%0Avar%20createIrradianceContext%20%3D%20%28normalWorldNode%29%20%3D%3E%20%7B%0A%20%20return%20%7B%0A%20%20%20%20getUV%3A%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20return%20normalWorldNode%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20getTextureLevel%3A%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20return%20float%281%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%3B%0Avar%20_defaultValues%246%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20MeshStandardMaterial%28%29%3B%0Avar%20MeshStandardNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshStandardNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshStandardNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20true%3B%0A%20%20%20%20this.emissiveNode%20%3D%20null%3B%0A%20%20%20%20this.metalnessNode%20%3D%20null%3B%0A%20%20%20%20this.roughnessNode%20%3D%20null%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%246%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupEnvironment%28builder%29%20%7B%0A%20%20%20%20let%20envNode%20%3D%20super.setupEnvironment%28builder%29%3B%0A%20%20%20%20if%20%28envNode%20%3D%3D%3D%20null%20%26%26%20builder.environmentNode%29%20%7B%0A%20%20%20%20%20%20envNode%20%3D%20builder.environmentNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20envNode%20%3F%20new%20EnvironmentNode%28envNode%29%20%3A%20null%3B%0A%20%20%7D%0A%20%20setupLightingModel%28%29%20%7B%0A%20%20%20%20return%20new%20PhysicalLightingModel%28%29%3B%0A%20%20%7D%0A%20%20setupSpecular%28%29%20%7B%0A%20%20%20%20const%20specularColorNode%20%3D%20mix%28vec3%280.04%29%2C%20diffuseColor.rgb%2C%20metalness%29%3B%0A%20%20%20%20specularColor.assign%28specularColorNode%29%3B%0A%20%20%20%20specularF90.assign%281%29%3B%0A%20%20%7D%0A%20%20setupVariants%28%29%20%7B%0A%20%20%20%20const%20metalnessNode%20%3D%20this.metalnessNode%20%3F%20float%28this.metalnessNode%29%20%3A%20materialMetalness%3B%0A%20%20%20%20metalness.assign%28metalnessNode%29%3B%0A%20%20%20%20let%20roughnessNode%20%3D%20this.roughnessNode%20%3F%20float%28this.roughnessNode%29%20%3A%20materialRoughness%3B%0A%20%20%20%20roughnessNode%20%3D%20getRoughness%28%7B%20roughness%3A%20roughnessNode%20%7D%29%3B%0A%20%20%20%20roughness.assign%28roughnessNode%29%3B%0A%20%20%20%20this.setupSpecular%28%29%3B%0A%20%20%20%20diffuseColor.assign%28vec4%28diffuseColor.rgb.mul%28metalnessNode.oneMinus%28%29%29%2C%20diffuseColor.a%29%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.emissiveNode%20%3D%20source.emissiveNode%3B%0A%20%20%20%20this.metalnessNode%20%3D%20source.metalnessNode%3B%0A%20%20%20%20this.roughnessNode%20%3D%20source.roughnessNode%3B%0A%20%20%20%20return%20super.copy%28source%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultValues%245%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20MeshPhysicalMaterial%28%29%3B%0Avar%20MeshPhysicalNodeMaterial%20%3D%20class%20extends%20MeshStandardNodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshPhysicalNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshPhysicalNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.clearcoatNode%20%3D%20null%3B%0A%20%20%20%20this.clearcoatRoughnessNode%20%3D%20null%3B%0A%20%20%20%20this.clearcoatNormalNode%20%3D%20null%3B%0A%20%20%20%20this.sheenNode%20%3D%20null%3B%0A%20%20%20%20this.sheenRoughnessNode%20%3D%20null%3B%0A%20%20%20%20this.iridescenceNode%20%3D%20null%3B%0A%20%20%20%20this.iridescenceIORNode%20%3D%20null%3B%0A%20%20%20%20this.iridescenceThicknessNode%20%3D%20null%3B%0A%20%20%20%20this.specularIntensityNode%20%3D%20null%3B%0A%20%20%20%20this.specularColorNode%20%3D%20null%3B%0A%20%20%20%20this.iorNode%20%3D%20null%3B%0A%20%20%20%20this.transmissionNode%20%3D%20null%3B%0A%20%20%20%20this.thicknessNode%20%3D%20null%3B%0A%20%20%20%20this.attenuationDistanceNode%20%3D%20null%3B%0A%20%20%20%20this.attenuationColorNode%20%3D%20null%3B%0A%20%20%20%20this.dispersionNode%20%3D%20null%3B%0A%20%20%20%20this.anisotropyNode%20%3D%20null%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%245%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20get%20useClearcoat%28%29%20%7B%0A%20%20%20%20return%20this.clearcoat%20%3E%200%20%7C%7C%20this.clearcoatNode%20%21%3D%3D%20null%3B%0A%20%20%7D%0A%20%20get%20useIridescence%28%29%20%7B%0A%20%20%20%20return%20this.iridescence%20%3E%200%20%7C%7C%20this.iridescenceNode%20%21%3D%3D%20null%3B%0A%20%20%7D%0A%20%20get%20useSheen%28%29%20%7B%0A%20%20%20%20return%20this.sheen%20%3E%200%20%7C%7C%20this.sheenNode%20%21%3D%3D%20null%3B%0A%20%20%7D%0A%20%20get%20useAnisotropy%28%29%20%7B%0A%20%20%20%20return%20this.anisotropy%20%3E%200%20%7C%7C%20this.anisotropyNode%20%21%3D%3D%20null%3B%0A%20%20%7D%0A%20%20get%20useTransmission%28%29%20%7B%0A%20%20%20%20return%20this.transmission%20%3E%200%20%7C%7C%20this.transmissionNode%20%21%3D%3D%20null%3B%0A%20%20%7D%0A%20%20get%20useDispersion%28%29%20%7B%0A%20%20%20%20return%20this.dispersion%20%3E%200%20%7C%7C%20this.dispersionNode%20%21%3D%3D%20null%3B%0A%20%20%7D%0A%20%20setupSpecular%28%29%20%7B%0A%20%20%20%20const%20iorNode%20%3D%20this.iorNode%20%3F%20float%28this.iorNode%29%20%3A%20materialIOR%3B%0A%20%20%20%20ior.assign%28iorNode%29%3B%0A%20%20%20%20specularColor.assign%28mix%28min%241%28pow2%28ior.sub%281%29.div%28ior.add%281%29%29%29.mul%28materialSpecularColor%29%2C%20vec3%281%29%29.mul%28materialSpecularIntensity%29%2C%20diffuseColor.rgb%2C%20metalness%29%29%3B%0A%20%20%20%20specularF90.assign%28mix%28materialSpecularIntensity%2C%201%2C%20metalness%29%29%3B%0A%20%20%7D%0A%20%20setupLightingModel%28%29%20%7B%0A%20%20%20%20return%20new%20PhysicalLightingModel%28this.useClearcoat%2C%20this.useSheen%2C%20this.useIridescence%2C%20this.useAnisotropy%2C%20this.useTransmission%2C%20this.useDispersion%29%3B%0A%20%20%7D%0A%20%20setupVariants%28builder%29%20%7B%0A%20%20%20%20super.setupVariants%28builder%29%3B%0A%20%20%20%20if%20%28this.useClearcoat%29%20%7B%0A%20%20%20%20%20%20const%20clearcoatNode%20%3D%20this.clearcoatNode%20%3F%20float%28this.clearcoatNode%29%20%3A%20materialClearcoat%3B%0A%20%20%20%20%20%20const%20clearcoatRoughnessNode%20%3D%20this.clearcoatRoughnessNode%20%3F%20float%28this.clearcoatRoughnessNode%29%20%3A%20materialClearcoatRoughness%3B%0A%20%20%20%20%20%20clearcoat.assign%28clearcoatNode%29%3B%0A%20%20%20%20%20%20clearcoatRoughness.assign%28getRoughness%28%7B%20roughness%3A%20clearcoatRoughnessNode%20%7D%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.useSheen%29%20%7B%0A%20%20%20%20%20%20const%20sheenNode%20%3D%20this.sheenNode%20%3F%20vec3%28this.sheenNode%29%20%3A%20materialSheen%3B%0A%20%20%20%20%20%20const%20sheenRoughnessNode%20%3D%20this.sheenRoughnessNode%20%3F%20float%28this.sheenRoughnessNode%29%20%3A%20materialSheenRoughness%3B%0A%20%20%20%20%20%20sheen.assign%28sheenNode%29%3B%0A%20%20%20%20%20%20sheenRoughness.assign%28sheenRoughnessNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.useIridescence%29%20%7B%0A%20%20%20%20%20%20const%20iridescenceNode%20%3D%20this.iridescenceNode%20%3F%20float%28this.iridescenceNode%29%20%3A%20materialIridescence%3B%0A%20%20%20%20%20%20const%20iridescenceIORNode%20%3D%20this.iridescenceIORNode%20%3F%20float%28this.iridescenceIORNode%29%20%3A%20materialIridescenceIOR%3B%0A%20%20%20%20%20%20const%20iridescenceThicknessNode%20%3D%20this.iridescenceThicknessNode%20%3F%20float%28this.iridescenceThicknessNode%29%20%3A%20materialIridescenceThickness%3B%0A%20%20%20%20%20%20iridescence.assign%28iridescenceNode%29%3B%0A%20%20%20%20%20%20iridescenceIOR.assign%28iridescenceIORNode%29%3B%0A%20%20%20%20%20%20iridescenceThickness.assign%28iridescenceThicknessNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.useAnisotropy%29%20%7B%0A%20%20%20%20%20%20const%20anisotropyV%20%3D%20%28this.anisotropyNode%20%3F%20vec2%28this.anisotropyNode%29%20%3A%20materialAnisotropy%29.toVar%28%29%3B%0A%20%20%20%20%20%20anisotropy.assign%28anisotropyV.length%28%29%29%3B%0A%20%20%20%20%20%20If%28anisotropy.equal%280%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20anisotropyV.assign%28vec2%281%2C%200%29%29%3B%0A%20%20%20%20%20%20%7D%29.Else%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20anisotropyV.divAssign%28vec2%28anisotropy%29%29%3B%0A%20%20%20%20%20%20%20%20anisotropy.assign%28anisotropy.saturate%28%29%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20alphaT.assign%28anisotropy.pow2%28%29.mix%28roughness.pow2%28%29%2C%201%29%29%3B%0A%20%20%20%20%20%20anisotropyT.assign%28TBNViewMatrix%5B0%5D.mul%28anisotropyV.x%29.add%28TBNViewMatrix%5B1%5D.mul%28anisotropyV.y%29%29%29%3B%0A%20%20%20%20%20%20anisotropyB.assign%28TBNViewMatrix%5B1%5D.mul%28anisotropyV.x%29.sub%28TBNViewMatrix%5B0%5D.mul%28anisotropyV.y%29%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.useTransmission%29%20%7B%0A%20%20%20%20%20%20const%20transmissionNode%20%3D%20this.transmissionNode%20%3F%20float%28this.transmissionNode%29%20%3A%20materialTransmission%3B%0A%20%20%20%20%20%20const%20thicknessNode%20%3D%20this.thicknessNode%20%3F%20float%28this.thicknessNode%29%20%3A%20materialThickness%3B%0A%20%20%20%20%20%20const%20attenuationDistanceNode%20%3D%20this.attenuationDistanceNode%20%3F%20float%28this.attenuationDistanceNode%29%20%3A%20materialAttenuationDistance%3B%0A%20%20%20%20%20%20const%20attenuationColorNode%20%3D%20this.attenuationColorNode%20%3F%20vec3%28this.attenuationColorNode%29%20%3A%20materialAttenuationColor%3B%0A%20%20%20%20%20%20transmission.assign%28transmissionNode%29%3B%0A%20%20%20%20%20%20thickness.assign%28thicknessNode%29%3B%0A%20%20%20%20%20%20attenuationDistance.assign%28attenuationDistanceNode%29%3B%0A%20%20%20%20%20%20attenuationColor.assign%28attenuationColorNode%29%3B%0A%20%20%20%20%20%20if%20%28this.useDispersion%29%20%7B%0A%20%20%20%20%20%20%20%20const%20dispersionNode%20%3D%20this.dispersionNode%20%3F%20float%28this.dispersionNode%29%20%3A%20materialDispersion%3B%0A%20%20%20%20%20%20%20%20dispersion.assign%28dispersionNode%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setupClearcoatNormal%28%29%20%7B%0A%20%20%20%20return%20this.clearcoatNormalNode%20%3F%20vec3%28this.clearcoatNormalNode%29%20%3A%20materialClearcoatNormal%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20builder.context.setupClearcoatNormal%20%3D%20%28%29%20%3D%3E%20this.setupClearcoatNormal%28builder%29%3B%0A%20%20%20%20super.setup%28builder%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.clearcoatNode%20%3D%20source.clearcoatNode%3B%0A%20%20%20%20this.clearcoatRoughnessNode%20%3D%20source.clearcoatRoughnessNode%3B%0A%20%20%20%20this.clearcoatNormalNode%20%3D%20source.clearcoatNormalNode%3B%0A%20%20%20%20this.sheenNode%20%3D%20source.sheenNode%3B%0A%20%20%20%20this.sheenRoughnessNode%20%3D%20source.sheenRoughnessNode%3B%0A%20%20%20%20this.iridescenceNode%20%3D%20source.iridescenceNode%3B%0A%20%20%20%20this.iridescenceIORNode%20%3D%20source.iridescenceIORNode%3B%0A%20%20%20%20this.iridescenceThicknessNode%20%3D%20source.iridescenceThicknessNode%3B%0A%20%20%20%20this.specularIntensityNode%20%3D%20source.specularIntensityNode%3B%0A%20%20%20%20this.specularColorNode%20%3D%20source.specularColorNode%3B%0A%20%20%20%20this.transmissionNode%20%3D%20source.transmissionNode%3B%0A%20%20%20%20this.thicknessNode%20%3D%20source.thicknessNode%3B%0A%20%20%20%20this.attenuationDistanceNode%20%3D%20source.attenuationDistanceNode%3B%0A%20%20%20%20this.attenuationColorNode%20%3D%20source.attenuationColorNode%3B%0A%20%20%20%20this.dispersionNode%20%3D%20source.dispersionNode%3B%0A%20%20%20%20this.anisotropyNode%20%3D%20source.anisotropyNode%3B%0A%20%20%20%20return%20super.copy%28source%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20getGradientIrradiance%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%7B%20normal%3A%20normal2%2C%20lightDirection%2C%20builder%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20dotNL%20%3D%20normal2.dot%28lightDirection%29%3B%0A%20%20const%20coord%20%3D%20vec2%28dotNL.mul%280.5%29.add%280.5%29%2C%200%29%3B%0A%20%20if%20%28builder.material.gradientMap%29%20%7B%0A%20%20%20%20const%20gradientMap%20%3D%20materialReference%28%22gradientMap%22%2C%20%22texture%22%29.context%28%7B%20getUV%3A%20%28%29%20%3D%3E%20coord%20%7D%29%3B%0A%20%20%20%20return%20vec3%28gradientMap.r%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20const%20fw%20%3D%20coord.fwidth%28%29.mul%280.5%29%3B%0A%20%20%20%20return%20mix%28vec3%280.7%29%2C%20vec3%281%29%2C%20smoothstep2%28float%280.7%29.sub%28fw.x%29%2C%20float%280.7%29.add%28fw.x%29%2C%20coord.x%29%29%3B%0A%20%20%7D%0A%7D%29%3B%0Avar%20ToonLightingModel%20%3D%20class%20extends%20LightingModel%20%7B%0A%20%20direct%28%7B%20lightDirection%2C%20lightColor%2C%20reflectedLight%20%7D%2C%20stack2%2C%20builder%29%20%7B%0A%20%20%20%20const%20irradiance%20%3D%20getGradientIrradiance%28%7B%20normal%3A%20normalGeometry%2C%20lightDirection%2C%20builder%20%7D%29.mul%28lightColor%29%3B%0A%20%20%20%20reflectedLight.directDiffuse.addAssign%28irradiance.mul%28BRDF_Lambert%28%7B%20diffuseColor%3A%20diffuseColor.rgb%20%7D%29%29%29%3B%0A%20%20%7D%0A%20%20indirect%28%7B%20ambientOcclusion%2C%20irradiance%2C%20reflectedLight%20%7D%29%20%7B%0A%20%20%20%20reflectedLight.indirectDiffuse.addAssign%28irradiance.mul%28BRDF_Lambert%28%7B%20diffuseColor%20%7D%29%29%29%3B%0A%20%20%20%20reflectedLight.indirectDiffuse.mulAssign%28ambientOcclusion%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultValues%244%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20MeshToonMaterial%28%29%3B%0Avar%20MeshToonNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshToonNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isMeshToonNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20true%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%244%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupLightingModel%28%29%20%7B%0A%20%20%20%20return%20new%20ToonLightingModel%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20MatcapUVNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MatcapUVNode%22%3B%0A%20%20%7D%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%22vec2%22%29%3B%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20const%20x2%20%3D%20vec3%28positionViewDirection.z%2C%200%2C%20positionViewDirection.x.negate%28%29%29.normalize%28%29%3B%0A%20%20%20%20const%20y2%20%3D%20positionViewDirection.cross%28x2%29%3B%0A%20%20%20%20return%20vec2%28x2.dot%28transformedNormalView%29%2C%20y2.dot%28transformedNormalView%29%29.mul%280.495%29.add%280.5%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20matcapUV%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28MatcapUVNode%29%3B%0Avar%20_defaultValues%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20MeshMatcapMaterial%28%29%3B%0Avar%20MeshMatcapNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22MeshMatcapNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.lights%20%3D%20false%3B%0A%20%20%20%20this.isMeshMatcapNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%243%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupVariants%28builder%29%20%7B%0A%20%20%20%20const%20uv2%20%3D%20matcapUV%3B%0A%20%20%20%20let%20matcapColor%3B%0A%20%20%20%20if%20%28builder.material.matcap%29%20%7B%0A%20%20%20%20%20%20matcapColor%20%3D%20materialReference%28%22matcap%22%2C%20%22texture%22%29.context%28%7B%20getUV%3A%20%28%29%20%3D%3E%20uv2%20%7D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20matcapColor%20%3D%20vec3%28mix%280.2%2C%200.8%2C%20uv2.y%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20diffuseColor.rgb.mulAssign%28matcapColor.rgb%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultValues%242%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20PointsMaterial%28%29%3B%0Avar%20PointsNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22PointsNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isPointsNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20false%3B%0A%20%20%20%20this.transparent%20%3D%20true%3B%0A%20%20%20%20this.sizeNode%20%3D%20null%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%242%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.sizeNode%20%3D%20source.sizeNode%3B%0A%20%20%20%20return%20super.copy%28source%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20RotateNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22RotateNode%22%3B%0A%20%20%7D%0A%20%20constructor%28positionNode%2C%20rotationNode%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.positionNode%20%3D%20positionNode%3B%0A%20%20%20%20this.rotationNode%20%3D%20rotationNode%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.positionNode.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20rotationNode%2C%20positionNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20nodeType%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20if%20%28nodeType%20%3D%3D%3D%20%22vec2%22%29%20%7B%0A%20%20%20%20%20%20const%20cosAngle%20%3D%20rotationNode.cos%28%29%3B%0A%20%20%20%20%20%20const%20sinAngle%20%3D%20rotationNode.sin%28%29%3B%0A%20%20%20%20%20%20const%20rotationMatrix%20%3D%20mat2%28%0A%20%20%20%20%20%20%20%20cosAngle%2C%0A%20%20%20%20%20%20%20%20sinAngle%2C%0A%20%20%20%20%20%20%20%20sinAngle.negate%28%29%2C%0A%20%20%20%20%20%20%20%20cosAngle%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20return%20rotationMatrix.mul%28positionNode%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20rotation%20%3D%20rotationNode%3B%0A%20%20%20%20%20%20const%20rotationXMatrix%20%3D%20mat4%28vec4%281%2C%200%2C%200%2C%200%29%2C%20vec4%280%2C%20cos%28rotation.x%29%2C%20sin%28rotation.x%29.negate%28%29%2C%200%29%2C%20vec4%280%2C%20sin%28rotation.x%29%2C%20cos%28rotation.x%29%2C%200%29%2C%20vec4%280%2C%200%2C%200%2C%201%29%29%3B%0A%20%20%20%20%20%20const%20rotationYMatrix%20%3D%20mat4%28vec4%28cos%28rotation.y%29%2C%200%2C%20sin%28rotation.y%29%2C%200%29%2C%20vec4%280%2C%201%2C%200%2C%200%29%2C%20vec4%28sin%28rotation.y%29.negate%28%29%2C%200%2C%20cos%28rotation.y%29%2C%200%29%2C%20vec4%280%2C%200%2C%200%2C%201%29%29%3B%0A%20%20%20%20%20%20const%20rotationZMatrix%20%3D%20mat4%28vec4%28cos%28rotation.z%29%2C%20sin%28rotation.z%29.negate%28%29%2C%200%2C%200%29%2C%20vec4%28sin%28rotation.z%29%2C%20cos%28rotation.z%29%2C%200%2C%200%29%2C%20vec4%280%2C%200%2C%201%2C%200%29%2C%20vec4%280%2C%200%2C%200%2C%201%29%29%3B%0A%20%20%20%20%20%20return%20rotationXMatrix.mul%28rotationYMatrix%29.mul%28rotationZMatrix%29.mul%28vec4%28positionNode%2C%201%29%29.xyz%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20rotate%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28RotateNode%29%3B%0Avar%20_defaultValues%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20SpriteMaterial%28%29%3B%0Avar%20SpriteNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22SpriteNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isSpriteNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20false%3B%0A%20%20%20%20this._useSizeAttenuation%20%3D%20true%3B%0A%20%20%20%20this.positionNode%20%3D%20null%3B%0A%20%20%20%20this.rotationNode%20%3D%20null%3B%0A%20%20%20%20this.scaleNode%20%3D%20null%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%241%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupPosition%28%7B%20object%2C%20camera%3A%20camera3%2C%20context%3A%20context2%20%7D%29%20%7B%0A%20%20%20%20const%20sizeAttenuation%20%3D%20this.sizeAttenuation%3B%0A%20%20%20%20const%20%7B%20positionNode%2C%20rotationNode%2C%20scaleNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20vertex2%20%3D%20positionLocal%3B%0A%20%20%20%20let%20mvPosition%20%3D%20modelViewMatrix.mul%28vec3%28positionNode%20%7C%7C%200%29%29%3B%0A%20%20%20%20let%20scale%20%3D%20vec2%28modelWorldMatrix%5B0%5D.xyz.length%28%29%2C%20modelWorldMatrix%5B1%5D.xyz.length%28%29%29%3B%0A%20%20%20%20if%20%28scaleNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20scale%20%3D%20scale.mul%28scaleNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%21sizeAttenuation%29%20%7B%0A%20%20%20%20%20%20if%20%28camera3.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20%20%20scale%20%3D%20scale.mul%28mvPosition.z.negate%28%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20orthoScale%20%3D%20float%282%29.div%28cameraProjectionMatrix.element%281%29.element%281%29%29%3B%0A%20%20%20%20%20%20%20%20scale%20%3D%20scale.mul%28orthoScale.mul%282%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20let%20alignedPosition%20%3D%20vertex2.xy%3B%0A%20%20%20%20if%20%28object.center%20%26%26%20object.center.isVector2%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20center%20%3D%20reference%241%28%22center%22%2C%20%22vec2%22%29%3B%0A%20%20%20%20%20%20alignedPosition%20%3D%20alignedPosition.sub%28center.sub%280.5%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20alignedPosition%20%3D%20alignedPosition.mul%28scale%29%3B%0A%20%20%20%20const%20rotation%20%3D%20float%28rotationNode%20%7C%7C%20materialRotation%29%3B%0A%20%20%20%20const%20rotatedPosition%20%3D%20rotate%28alignedPosition%2C%20rotation%29%3B%0A%20%20%20%20mvPosition%20%3D%20vec4%28mvPosition.xy.add%28rotatedPosition%29%2C%20mvPosition.zw%29%3B%0A%20%20%20%20const%20modelViewProjection2%20%3D%20cameraProjectionMatrix.mul%28mvPosition%29%3B%0A%20%20%20%20context2.vertex%20%3D%20vertex2%3B%0A%20%20%20%20return%20modelViewProjection2%3B%0A%20%20%7D%0A%20%20copy%28source%29%20%7B%0A%20%20%20%20this.positionNode%20%3D%20source.positionNode%3B%0A%20%20%20%20this.rotationNode%20%3D%20source.rotationNode%3B%0A%20%20%20%20this.scaleNode%20%3D%20source.scaleNode%3B%0A%20%20%20%20return%20super.copy%28source%29%3B%0A%20%20%7D%0A%20%20get%20sizeAttenuation%28%29%20%7B%0A%20%20%20%20return%20this._useSizeAttenuation%3B%0A%20%20%7D%0A%20%20set%20sizeAttenuation%28value%29%20%7B%0A%20%20%20%20if%20%28this._useSizeAttenuation%20%21%3D%3D%20value%29%20%7B%0A%20%20%20%20%20%20this._useSizeAttenuation%20%3D%20value%3B%0A%20%20%20%20%20%20this.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20ShadowMaskModel%20%3D%20class%20extends%20LightingModel%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.shadowNode%20%3D%20float%281%29.toVar%28%22shadowMask%22%29%3B%0A%20%20%7D%0A%20%20direct%28%7B%20shadowMask%20%7D%29%20%7B%0A%20%20%20%20this.shadowNode.mulAssign%28shadowMask%29%3B%0A%20%20%7D%0A%20%20finish%28context2%29%20%7B%0A%20%20%20%20diffuseColor.a.mulAssign%28this.shadowNode.oneMinus%28%29%29%3B%0A%20%20%20%20context2.outgoingLight.rgb.assign%28diffuseColor.rgb%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultValues%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20ShadowMaterial%28%29%3B%0Avar%20ShadowNodeMaterial%20%3D%20class%20extends%20NodeMaterial%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ShadowNodeMaterial%22%3B%0A%20%20%7D%0A%20%20constructor%28parameters%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.isShadowNodeMaterial%20%3D%20true%3B%0A%20%20%20%20this.lights%20%3D%20true%3B%0A%20%20%20%20this.setDefaultValues%28_defaultValues%29%3B%0A%20%20%20%20this.setValues%28parameters%29%3B%0A%20%20%7D%0A%20%20setupLightingModel%28%29%20%7B%0A%20%20%20%20return%20new%20ShadowMaskModel%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20normal%20%3D%20Fn%28%28%7B%20texture%3A%20texture2%2C%20uv%3A%20uv2%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20epsilon%20%3D%201e-4%3B%0A%20%20const%20ret%20%3D%20vec3%28%29.toVar%28%29%3B%0A%20%20If%28uv2.x.lessThan%28epsilon%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20ret.assign%28vec3%281%2C%200%2C%200%29%29%3B%0A%20%20%7D%29.ElseIf%28uv2.y.lessThan%28epsilon%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20ret.assign%28vec3%280%2C%201%2C%200%29%29%3B%0A%20%20%7D%29.ElseIf%28uv2.z.lessThan%28epsilon%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20ret.assign%28vec3%280%2C%200%2C%201%29%29%3B%0A%20%20%7D%29.ElseIf%28uv2.x.greaterThan%281%20-%20epsilon%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20ret.assign%28vec3%28-1%2C%200%2C%200%29%29%3B%0A%20%20%7D%29.ElseIf%28uv2.y.greaterThan%281%20-%20epsilon%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20ret.assign%28vec3%280%2C%20-1%2C%200%29%29%3B%0A%20%20%7D%29.ElseIf%28uv2.z.greaterThan%281%20-%20epsilon%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20ret.assign%28vec3%280%2C%200%2C%20-1%29%29%3B%0A%20%20%7D%29.Else%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20const%20step2%20%3D%200.01%3B%0A%20%20%20%20const%20x2%20%3D%20texture2.uv%28uv2.add%28vec3%28-step2%2C%200%2C%200%29%29%29.r.sub%28texture2.uv%28uv2.add%28vec3%28step2%2C%200%2C%200%29%29%29.r%29%3B%0A%20%20%20%20const%20y2%20%3D%20texture2.uv%28uv2.add%28vec3%280%2C%20-step2%2C%200%29%29%29.r.sub%28texture2.uv%28uv2.add%28vec3%280%2C%20step2%2C%200%29%29%29.r%29%3B%0A%20%20%20%20const%20z2%20%3D%20texture2.uv%28uv2.add%28vec3%280%2C%200%2C%20-step2%29%29%29.r.sub%28texture2.uv%28uv2.add%28vec3%280%2C%200%2C%20step2%29%29%29.r%29%3B%0A%20%20%20%20ret.assign%28vec3%28x2%2C%20y2%2C%20z2%29%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20ret.normalize%28%29%3B%0A%7D%29%3B%0Avar%20Animation%20%3D%20class%20%7B%0A%20%20constructor%28nodes%2C%20info%29%20%7B%0A%20%20%20%20this.nodes%20%3D%20nodes%3B%0A%20%20%20%20this.info%20%3D%20info%3B%0A%20%20%20%20this.animationLoop%20%3D%20null%3B%0A%20%20%20%20this.requestId%20%3D%20null%3B%0A%20%20%20%20this._init%28%29%3B%0A%20%20%7D%0A%20%20_init%28%29%20%7B%0A%20%20%20%20const%20update4%20%3D%20%28time%2C%20frame2%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20this.requestId%20%3D%20self.requestAnimationFrame%28update4%29%3B%0A%20%20%20%20%20%20if%20%28this.info.autoReset%20%3D%3D%3D%20true%29%20this.info.reset%28%29%3B%0A%20%20%20%20%20%20this.nodes.nodeFrame.update%28%29%3B%0A%20%20%20%20%20%20this.info.frame%20%3D%20this.nodes.nodeFrame.frameId%3B%0A%20%20%20%20%20%20if%20%28this.animationLoop%20%21%3D%3D%20null%29%20this.animationLoop%28time%2C%20frame2%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20update4%28%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20self.cancelAnimationFrame%28this.requestId%29%3B%0A%20%20%20%20this.requestId%20%3D%20null%3B%0A%20%20%7D%0A%20%20setAnimationLoop%28callback%29%20%7B%0A%20%20%20%20this.animationLoop%20%3D%20callback%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ChainMap%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.weakMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%20%20get%28keys%29%20%7B%0A%20%20%20%20let%20map%20%3D%20this.weakMap%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20keys.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20map%20%3D%20map.get%28keys%5Bi%5D%29%3B%0A%20%20%20%20%20%20if%20%28map%20%3D%3D%3D%20void%200%29%20return%20void%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20map.get%28keys%5Bkeys.length%20-%201%5D%29%3B%0A%20%20%7D%0A%20%20set%28keys%2C%20value%29%20%7B%0A%20%20%20%20let%20map%20%3D%20this.weakMap%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20keys.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20key%20%3D%20keys%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28map.has%28key%29%20%3D%3D%3D%20false%29%20map.set%28key%2C%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%29%3B%0A%20%20%20%20%20%20map%20%3D%20map.get%28key%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20map.set%28keys%5Bkeys.length%20-%201%5D%2C%20value%29%3B%0A%20%20%7D%0A%20%20delete%28keys%29%20%7B%0A%20%20%20%20let%20map%20%3D%20this.weakMap%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20keys.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20map%20%3D%20map.get%28keys%5Bi%5D%29%3B%0A%20%20%20%20%20%20if%20%28map%20%3D%3D%3D%20void%200%29%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20map.delete%28keys%5Bkeys.length%20-%201%5D%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_plane2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Plane2%28%29%3B%0Avar%20ClippingContext%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.version%20%3D%200%3B%0A%20%20%20%20this.globalClippingCount%20%3D%200%3B%0A%20%20%20%20this.localClippingCount%20%3D%200%3B%0A%20%20%20%20this.localClippingEnabled%20%3D%20false%3B%0A%20%20%20%20this.localClipIntersection%20%3D%20false%3B%0A%20%20%20%20this.planes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.parentVersion%20%3D%200%3B%0A%20%20%20%20this.viewNormalMatrix%20%3D%20new%20Matrix32%28%29%3B%0A%20%20%20%20this.cacheKey%20%3D%200%3B%0A%20%20%7D%0A%20%20projectPlanes%28source%2C%20offset%29%20%7B%0A%20%20%20%20const%20l%20%3D%20source.length%3B%0A%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20_plane2.copy%28source%5Bi%5D%29.applyMatrix4%28this.viewMatrix%2C%20this.viewNormalMatrix%29%3B%0A%20%20%20%20%20%20const%20v%20%3D%20planes%5Boffset%20%2B%20i%5D%3B%0A%20%20%20%20%20%20const%20normal2%20%3D%20_plane2.normal%3B%0A%20%20%20%20%20%20v.x%20%3D%20-normal2.x%3B%0A%20%20%20%20%20%20v.y%20%3D%20-normal2.y%3B%0A%20%20%20%20%20%20v.z%20%3D%20-normal2.z%3B%0A%20%20%20%20%20%20v.w%20%3D%20_plane2.constant%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateGlobal%28renderer3%2C%20camera3%29%20%7B%0A%20%20%20%20const%20rendererClippingPlanes%20%3D%20renderer3.clippingPlanes%3B%0A%20%20%20%20this.viewMatrix%20%3D%20camera3.matrixWorldInverse%3B%0A%20%20%20%20this.viewNormalMatrix.getNormalMatrix%28this.viewMatrix%29%3B%0A%20%20%20%20let%20update4%20%3D%20false%3B%0A%20%20%20%20if%20%28Array.isArray%28rendererClippingPlanes%29%20%26%26%20rendererClippingPlanes.length%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20const%20l%20%3D%20rendererClippingPlanes.length%3B%0A%20%20%20%20%20%20if%20%28l%20%21%3D%3D%20this.globalClippingCount%29%20%7B%0A%20%20%20%20%20%20%20%20const%20planes%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20planes.push%28new%20Vector42%28%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this.globalClippingCount%20%3D%20l%3B%0A%20%20%20%20%20%20%20%20this.planes%20%3D%20planes%3B%0A%20%20%20%20%20%20%20%20update4%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.projectPlanes%28rendererClippingPlanes%2C%200%29%3B%0A%20%20%20%20%7D%20else%20if%20%28this.globalClippingCount%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20this.globalClippingCount%20%3D%200%3B%0A%20%20%20%20%20%20this.planes%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20update4%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderer3.localClippingEnabled%20%21%3D%3D%20this.localClippingEnabled%29%20%7B%0A%20%20%20%20%20%20this.localClippingEnabled%20%3D%20renderer3.localClippingEnabled%3B%0A%20%20%20%20%20%20update4%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28update4%29%20%7B%0A%20%20%20%20%20%20this.version%2B%2B%3B%0A%20%20%20%20%20%20this.cacheKey%20%3D%20hash%241%28this.globalClippingCount%2C%20this.localClippingEnabled%20%3D%3D%3D%20true%20%3F%201%20%3A%200%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%28parent%2C%20material%29%20%7B%0A%20%20%20%20let%20update4%20%3D%20false%3B%0A%20%20%20%20if%20%28this%20%21%3D%3D%20parent%20%26%26%20parent.version%20%21%3D%3D%20this.parentVersion%29%20%7B%0A%20%20%20%20%20%20this.globalClippingCount%20%3D%20material.isShadowNodeMaterial%20%3F%200%20%3A%20parent.globalClippingCount%3B%0A%20%20%20%20%20%20this.localClippingEnabled%20%3D%20parent.localClippingEnabled%3B%0A%20%20%20%20%20%20this.planes%20%3D%20Array.from%28parent.planes%29%3B%0A%20%20%20%20%20%20this.parentVersion%20%3D%20parent.version%3B%0A%20%20%20%20%20%20this.viewMatrix%20%3D%20parent.viewMatrix%3B%0A%20%20%20%20%20%20this.viewNormalMatrix%20%3D%20parent.viewNormalMatrix%3B%0A%20%20%20%20%20%20update4%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.localClippingEnabled%29%20%7B%0A%20%20%20%20%20%20const%20localClippingPlanes%20%3D%20material.clippingPlanes%3B%0A%20%20%20%20%20%20if%20%28Array.isArray%28localClippingPlanes%29%20%26%26%20localClippingPlanes.length%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20l%20%3D%20localClippingPlanes.length%3B%0A%20%20%20%20%20%20%20%20const%20planes%20%3D%20this.planes%3B%0A%20%20%20%20%20%20%20%20const%20offset%20%3D%20this.globalClippingCount%3B%0A%20%20%20%20%20%20%20%20if%20%28update4%20%7C%7C%20l%20%21%3D%3D%20this.localClippingCount%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20planes.length%20%3D%20offset%20%2B%20l%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20planes%5Boffset%20%2B%20i%5D%20%3D%20new%20Vector42%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20this.localClippingCount%20%3D%20l%3B%0A%20%20%20%20%20%20%20%20%20%20update4%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this.projectPlanes%28localClippingPlanes%2C%20offset%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28this.localClippingCount%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20this.localClippingCount%20%3D%200%3B%0A%20%20%20%20%20%20%20%20update4%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this.localClipIntersection%20%21%3D%3D%20material.clipIntersection%29%20%7B%0A%20%20%20%20%20%20%20%20this.localClipIntersection%20%3D%20material.clipIntersection%3B%0A%20%20%20%20%20%20%20%20update4%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28update4%29%20%7B%0A%20%20%20%20%20%20this.version%20%2B%3D%20parent.version%3B%0A%20%20%20%20%20%20this.cacheKey%20%3D%20hash%241%28parent.cacheKey%2C%20this.localClippingCount%2C%20this.localClipIntersection%20%3D%3D%3D%20true%20%3F%201%20%3A%200%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20_id%247%20%3D%200%3B%0Afunction%20getKeys%28obj%29%20%7B%0A%20%20const%20keys%20%3D%20Object.keys%28obj%29%3B%0A%20%20let%20proto%20%3D%20Object.getPrototypeOf%28obj%29%3B%0A%20%20while%20%28proto%29%20%7B%0A%20%20%20%20const%20descriptors%20%3D%20Object.getOwnPropertyDescriptors%28proto%29%3B%0A%20%20%20%20for%20%28const%20key%20in%20descriptors%29%20%7B%0A%20%20%20%20%20%20if%20%28descriptors%5Bkey%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20descriptor%20%3D%20descriptors%5Bkey%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28descriptor%20%26%26%20typeof%20descriptor.get%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20keys.push%28key%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20proto%20%3D%20Object.getPrototypeOf%28proto%29%3B%0A%20%20%7D%0A%20%20return%20keys%3B%0A%7D%0Avar%20RenderObject%20%3D%20class%20%7B%0A%20%20constructor%28nodes%2C%20geometries%2C%20renderer3%2C%20object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20renderContext%29%20%7B%0A%20%20%20%20this._nodes%20%3D%20nodes%3B%0A%20%20%20%20this._geometries%20%3D%20geometries%3B%0A%20%20%20%20this.id%20%3D%20_id%247%2B%2B%3B%0A%20%20%20%20this.renderer%20%3D%20renderer3%3B%0A%20%20%20%20this.object%20%3D%20object%3B%0A%20%20%20%20this.material%20%3D%20material%3B%0A%20%20%20%20this.scene%20%3D%20scene3%3B%0A%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%20%20this.lightsNode%20%3D%20lightsNode%3B%0A%20%20%20%20this.context%20%3D%20renderContext%3B%0A%20%20%20%20this.geometry%20%3D%20object.geometry%3B%0A%20%20%20%20this.version%20%3D%20material.version%3B%0A%20%20%20%20this.drawRange%20%3D%20null%3B%0A%20%20%20%20this.attributes%20%3D%20null%3B%0A%20%20%20%20this.pipeline%20%3D%20null%3B%0A%20%20%20%20this.vertexBuffers%20%3D%20null%3B%0A%20%20%20%20this.drawParams%20%3D%20null%3B%0A%20%20%20%20this.bundle%20%3D%20null%3B%0A%20%20%20%20this.updateClipping%28renderContext.clippingContext%29%3B%0A%20%20%20%20this.clippingContextVersion%20%3D%20this.clippingContext.version%3B%0A%20%20%20%20this.initialNodesCacheKey%20%3D%20this.getDynamicCacheKey%28%29%3B%0A%20%20%20%20this.initialCacheKey%20%3D%20this.getCacheKey%28%29%3B%0A%20%20%20%20this._nodeBuilderState%20%3D%20null%3B%0A%20%20%20%20this._bindings%20%3D%20null%3B%0A%20%20%20%20this._monitor%20%3D%20null%3B%0A%20%20%20%20this.onDispose%20%3D%20null%3B%0A%20%20%20%20this.isRenderObject%20%3D%20true%3B%0A%20%20%20%20this.onMaterialDispose%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20this.dispose%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.material.addEventListener%28%22dispose%22%2C%20this.onMaterialDispose%29%3B%0A%20%20%7D%0A%20%20updateClipping%28parent%29%20%7B%0A%20%20%20%20const%20material%20%3D%20this.material%3B%0A%20%20%20%20let%20clippingContext%20%3D%20this.clippingContext%3B%0A%20%20%20%20if%20%28Array.isArray%28material.clippingPlanes%29%29%20%7B%0A%20%20%20%20%20%20if%20%28clippingContext%20%3D%3D%3D%20parent%20%7C%7C%20%21clippingContext%29%20%7B%0A%20%20%20%20%20%20%20%20clippingContext%20%3D%20new%20ClippingContext%28%29%3B%0A%20%20%20%20%20%20%20%20this.clippingContext%20%3D%20clippingContext%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20clippingContext.update%28parent%2C%20material%29%3B%0A%20%20%20%20%7D%20else%20if%20%28this.clippingContext%20%21%3D%3D%20parent%29%20%7B%0A%20%20%20%20%20%20this.clippingContext%20%3D%20parent%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20get%20clippingNeedsUpdate%28%29%20%7B%0A%20%20%20%20if%20%28this.clippingContext.version%20%3D%3D%3D%20this.clippingContextVersion%29%20return%20false%3B%0A%20%20%20%20this.clippingContextVersion%20%3D%20this.clippingContext.version%3B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20getNodeBuilderState%28%29%20%7B%0A%20%20%20%20return%20this._nodeBuilderState%20%7C%7C%20%28this._nodeBuilderState%20%3D%20this._nodes.getForRender%28this%29%29%3B%0A%20%20%7D%0A%20%20getMonitor%28%29%20%7B%0A%20%20%20%20return%20this._monitor%20%7C%7C%20%28this._monitor%20%3D%20this.getNodeBuilderState%28%29.monitor%29%3B%0A%20%20%7D%0A%20%20getBindings%28%29%20%7B%0A%20%20%20%20return%20this._bindings%20%7C%7C%20%28this._bindings%20%3D%20this.getNodeBuilderState%28%29.createBindings%28%29%29%3B%0A%20%20%7D%0A%20%20getIndex%28%29%20%7B%0A%20%20%20%20return%20this._geometries.getIndex%28this%29%3B%0A%20%20%7D%0A%20%20getIndirect%28%29%20%7B%0A%20%20%20%20return%20this._geometries.getIndirect%28this%29%3B%0A%20%20%7D%0A%20%20getChainArray%28%29%20%7B%0A%20%20%20%20return%20%5Bthis.object%2C%20this.material%2C%20this.context%2C%20this.lightsNode%5D%3B%0A%20%20%7D%0A%20%20getAttributes%28%29%20%7B%0A%20%20%20%20if%20%28this.attributes%20%21%3D%3D%20null%29%20return%20this.attributes%3B%0A%20%20%20%20const%20nodeAttributes%20%3D%20this.getNodeBuilderState%28%29.nodeAttributes%3B%0A%20%20%20%20const%20geometry%20%3D%20this.geometry%3B%0A%20%20%20%20const%20attributes%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vertexBuffers%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%29%3B%0A%20%20%20%20for%20%28const%20nodeAttribute%20of%20nodeAttributes%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20nodeAttribute.node%20%26%26%20nodeAttribute.node.attribute%20%3F%20nodeAttribute.node.attribute%20%3A%20geometry.getAttribute%28nodeAttribute.name%29%3B%0A%20%20%20%20%20%20if%20%28attribute2%20%3D%3D%3D%20void%200%29%20continue%3B%0A%20%20%20%20%20%20attributes.push%28attribute2%29%3B%0A%20%20%20%20%20%20const%20bufferAttribute2%20%3D%20attribute2.isInterleavedBufferAttribute%20%3F%20attribute2.data%20%3A%20attribute2%3B%0A%20%20%20%20%20%20vertexBuffers.add%28bufferAttribute2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.attributes%20%3D%20attributes%3B%0A%20%20%20%20this.vertexBuffers%20%3D%20Array.from%28vertexBuffers.values%28%29%29%3B%0A%20%20%20%20return%20attributes%3B%0A%20%20%7D%0A%20%20getVertexBuffers%28%29%20%7B%0A%20%20%20%20if%20%28this.vertexBuffers%20%3D%3D%3D%20null%29%20this.getAttributes%28%29%3B%0A%20%20%20%20return%20this.vertexBuffers%3B%0A%20%20%7D%0A%20%20getDrawParameters%28%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20material%2C%20geometry%2C%20group%2C%20drawRange%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20drawParams%20%3D%20this.drawParams%20%7C%7C%20%28this.drawParams%20%3D%20%7B%0A%20%20%20%20%20%20vertexCount%3A%200%2C%0A%20%20%20%20%20%20firstVertex%3A%200%2C%0A%20%20%20%20%20%20instanceCount%3A%200%2C%0A%20%20%20%20%20%20firstInstance%3A%200%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20index5%20%3D%20this.getIndex%28%29%3B%0A%20%20%20%20const%20hasIndex%20%3D%20index5%20%21%3D%3D%20null%3B%0A%20%20%20%20const%20instanceCount%20%3D%20geometry.isInstancedBufferGeometry%20%3F%20geometry.instanceCount%20%3A%20object.count%20%3E%201%20%3F%20object.count%20%3A%201%3B%0A%20%20%20%20if%20%28instanceCount%20%3D%3D%3D%200%29%20return%20null%3B%0A%20%20%20%20drawParams.instanceCount%20%3D%20instanceCount%3B%0A%20%20%20%20if%20%28object.isBatchedMesh%20%3D%3D%3D%20true%29%20return%20drawParams%3B%0A%20%20%20%20let%20rangeFactor%20%3D%201%3B%0A%20%20%20%20if%20%28material.wireframe%20%3D%3D%3D%20true%20%26%26%20%21object.isPoints%20%26%26%20%21object.isLineSegments%20%26%26%20%21object.isLine%20%26%26%20%21object.isLineLoop%29%20%7B%0A%20%20%20%20%20%20rangeFactor%20%3D%202%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20firstVertex%20%3D%20drawRange.start%20%2A%20rangeFactor%3B%0A%20%20%20%20let%20lastVertex%20%3D%20%28drawRange.start%20%2B%20drawRange.count%29%20%2A%20rangeFactor%3B%0A%20%20%20%20if%20%28group%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20firstVertex%20%3D%20Math.max%28firstVertex%2C%20group.start%20%2A%20rangeFactor%29%3B%0A%20%20%20%20%20%20lastVertex%20%3D%20Math.min%28lastVertex%2C%20%28group.start%20%2B%20group.count%29%20%2A%20rangeFactor%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20position%20%3D%20geometry.attributes.position%3B%0A%20%20%20%20let%20itemCount%20%3D%20Infinity%3B%0A%20%20%20%20if%20%28hasIndex%29%20%7B%0A%20%20%20%20%20%20itemCount%20%3D%20index5.count%3B%0A%20%20%20%20%7D%20else%20if%20%28position%20%21%3D%3D%20void%200%20%26%26%20position%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20itemCount%20%3D%20position.count%3B%0A%20%20%20%20%7D%0A%20%20%20%20firstVertex%20%3D%20Math.max%28firstVertex%2C%200%29%3B%0A%20%20%20%20lastVertex%20%3D%20Math.min%28lastVertex%2C%20itemCount%29%3B%0A%20%20%20%20const%20count%20%3D%20lastVertex%20-%20firstVertex%3B%0A%20%20%20%20if%20%28count%20%3C%200%20%7C%7C%20count%20%3D%3D%3D%20Infinity%29%20return%20null%3B%0A%20%20%20%20drawParams.vertexCount%20%3D%20count%3B%0A%20%20%20%20drawParams.firstVertex%20%3D%20firstVertex%3B%0A%20%20%20%20return%20drawParams%3B%0A%20%20%7D%0A%20%20getGeometryCacheKey%28%29%20%7B%0A%20%20%20%20const%20%7B%20geometry%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20cacheKey%20%3D%20%22%22%3B%0A%20%20%20%20for%20%28const%20name%20of%20Object.keys%28geometry.attributes%29.sort%28%29%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20geometry.attributes%5Bname%5D%3B%0A%20%20%20%20%20%20cacheKey%20%2B%3D%20name%20%2B%20%22%2C%22%3B%0A%20%20%20%20%20%20if%20%28attribute2.data%29%20cacheKey%20%2B%3D%20attribute2.data.stride%20%2B%20%22%2C%22%3B%0A%20%20%20%20%20%20if%20%28attribute2.offset%29%20cacheKey%20%2B%3D%20attribute2.offset%20%2B%20%22%2C%22%3B%0A%20%20%20%20%20%20if%20%28attribute2.itemSize%29%20cacheKey%20%2B%3D%20attribute2.itemSize%20%2B%20%22%2C%22%3B%0A%20%20%20%20%20%20if%20%28attribute2.normalized%29%20cacheKey%20%2B%3D%20%22n%2C%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28geometry.index%29%20%7B%0A%20%20%20%20%20%20cacheKey%20%2B%3D%20%22index%2C%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20cacheKey%3B%0A%20%20%7D%0A%20%20getMaterialCacheKey%28%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20material%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20cacheKey%20%3D%20material.customProgramCacheKey%28%29%3B%0A%20%20%20%20for%20%28const%20property2%20of%20getKeys%28material%29%29%20%7B%0A%20%20%20%20%20%20if%20%28%2F%5E%28is%5BA-Z%5D%7C_%29%7C%5E%28visible%7Cversion%7Cuuid%7Cname%7Copacity%7CuserData%29%24%2F.test%28property2%29%29%20continue%3B%0A%20%20%20%20%20%20const%20value%20%3D%20material%5Bproperty2%5D%3B%0A%20%20%20%20%20%20let%20valueKey%3B%0A%20%20%20%20%20%20if%20%28value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20const%20type%20%3D%20typeof%20value%3B%0A%20%20%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20valueKey%20%3D%20value%20%21%3D%3D%200%20%3F%20%221%22%20%3A%20%220%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20valueKey%20%3D%20%22%7B%22%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28value.isTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20valueKey%20%2B%3D%20value.mapping%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20valueKey%20%2B%3D%20%22%7D%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20valueKey%20%3D%20String%28value%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20valueKey%20%3D%20String%28value%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20cacheKey%20%2B%3D%20%2F%2Aproperty%20%2B%20%27%3A%27%20%2B%2A%2F%0A%20%20%20%20%20%20valueKey%20%2B%20%22%2C%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20cacheKey%20%2B%3D%20this.clippingContext.cacheKey%20%2B%20%22%2C%22%3B%0A%20%20%20%20if%20%28object.geometry%29%20%7B%0A%20%20%20%20%20%20cacheKey%20%2B%3D%20this.getGeometryCacheKey%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.skeleton%29%20%7B%0A%20%20%20%20%20%20cacheKey%20%2B%3D%20object.skeleton.bones.length%20%2B%20%22%2C%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.morphTargetInfluences%29%20%7B%0A%20%20%20%20%20%20cacheKey%20%2B%3D%20object.morphTargetInfluences.length%20%2B%20%22%2C%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isBatchedMesh%29%20%7B%0A%20%20%20%20%20%20cacheKey%20%2B%3D%20object._matricesTexture.uuid%20%2B%20%22%2C%22%3B%0A%20%20%20%20%20%20if%20%28object._colorsTexture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20cacheKey%20%2B%3D%20object._colorsTexture.uuid%20%2B%20%22%2C%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.count%20%3E%201%29%20%7B%0A%20%20%20%20%20%20cacheKey%20%2B%3D%20object.uuid%20%2B%20%22%2C%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20hashString%28cacheKey%29%3B%0A%20%20%7D%0A%20%20get%20needsUpdate%28%29%20%7B%0A%20%20%20%20return%20%28%0A%20%20%20%20%20%20%2F%2Athis.object.static%20%21%3D%3D%20true%20%26%26%2A%2F%0A%20%20%20%20%20%20this.initialNodesCacheKey%20%21%3D%3D%20this.getDynamicCacheKey%28%29%20%7C%7C%20this.clippingNeedsUpdate%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20getDynamicCacheKey%28%29%20%7B%0A%20%20%20%20let%20cacheKey%20%3D%20this._nodes.getCacheKey%28this.scene%2C%20this.lightsNode%29%3B%0A%20%20%20%20if%20%28this.object.receiveShadow%29%20%7B%0A%20%20%20%20%20%20cacheKey%20%2B%3D%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20cacheKey%3B%0A%20%20%7D%0A%20%20getCacheKey%28%29%20%7B%0A%20%20%20%20return%20this.getMaterialCacheKey%28%29%20%2B%20this.getDynamicCacheKey%28%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.material.removeEventListener%28%22dispose%22%2C%20this.onMaterialDispose%29%3B%0A%20%20%20%20this.onDispose%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20chainArray%20%3D%20%5B%5D%3B%0Avar%20RenderObjects%20%3D%20class%20%7B%0A%20%20constructor%28renderer3%2C%20nodes%2C%20geometries%2C%20pipelines%2C%20bindings%2C%20info%29%20%7B%0A%20%20%20%20this.renderer%20%3D%20renderer3%3B%0A%20%20%20%20this.nodes%20%3D%20nodes%3B%0A%20%20%20%20this.geometries%20%3D%20geometries%3B%0A%20%20%20%20this.pipelines%20%3D%20pipelines%3B%0A%20%20%20%20this.bindings%20%3D%20bindings%3B%0A%20%20%20%20this.info%20%3D%20info%3B%0A%20%20%20%20this.chainMaps%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20get%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20renderContext%2C%20passId%29%20%7B%0A%20%20%20%20const%20chainMap%20%3D%20this.getChainMap%28passId%29%3B%0A%20%20%20%20chainArray%5B0%5D%20%3D%20object%3B%0A%20%20%20%20chainArray%5B1%5D%20%3D%20material%3B%0A%20%20%20%20chainArray%5B2%5D%20%3D%20renderContext%3B%0A%20%20%20%20chainArray%5B3%5D%20%3D%20lightsNode%3B%0A%20%20%20%20let%20renderObject%20%3D%20chainMap.get%28chainArray%29%3B%0A%20%20%20%20if%20%28renderObject%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20renderObject%20%3D%20this.createRenderObject%28this.nodes%2C%20this.geometries%2C%20this.renderer%2C%20object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20renderContext%2C%20passId%29%3B%0A%20%20%20%20%20%20chainMap.set%28chainArray%2C%20renderObject%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderObject.updateClipping%28renderContext.clippingContext%29%3B%0A%20%20%20%20%20%20if%20%28renderObject.version%20%21%3D%3D%20material.version%20%7C%7C%20renderObject.needsUpdate%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28renderObject.initialCacheKey%20%21%3D%3D%20renderObject.getCacheKey%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderObject.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderObject%20%3D%20this.get%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20renderContext%2C%20passId%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderObject.version%20%3D%20material.version%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20renderObject%3B%0A%20%20%7D%0A%20%20getChainMap%28passId%20%3D%20%22default%22%29%20%7B%0A%20%20%20%20return%20this.chainMaps%5BpassId%5D%20%7C%7C%20%28this.chainMaps%5BpassId%5D%20%3D%20new%20ChainMap%28%29%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.chainMaps%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20createRenderObject%28nodes%2C%20geometries%2C%20renderer3%2C%20object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20renderContext%2C%20passId%29%20%7B%0A%20%20%20%20const%20chainMap%20%3D%20this.getChainMap%28passId%29%3B%0A%20%20%20%20const%20renderObject%20%3D%20new%20RenderObject%28nodes%2C%20geometries%2C%20renderer3%2C%20object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20renderContext%29%3B%0A%20%20%20%20renderObject.onDispose%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20this.pipelines.delete%28renderObject%29%3B%0A%20%20%20%20%20%20this.bindings.delete%28renderObject%29%3B%0A%20%20%20%20%20%20this.nodes.delete%28renderObject%29%3B%0A%20%20%20%20%20%20chainMap.delete%28renderObject.getChainArray%28%29%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20return%20renderObject%3B%0A%20%20%7D%0A%7D%3B%0Avar%20DataMap%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.data%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%20%20get%28object%29%20%7B%0A%20%20%20%20let%20map%20%3D%20this.data.get%28object%29%3B%0A%20%20%20%20if%20%28map%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20map%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20this.data.set%28object%2C%20map%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20map%3B%0A%20%20%7D%0A%20%20delete%28object%29%20%7B%0A%20%20%20%20let%20map%3B%0A%20%20%20%20if%20%28this.data.has%28object%29%29%20%7B%0A%20%20%20%20%20%20map%20%3D%20this.data.get%28object%29%3B%0A%20%20%20%20%20%20this.data.delete%28object%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20map%3B%0A%20%20%7D%0A%20%20has%28object%29%20%7B%0A%20%20%20%20return%20this.data.has%28object%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.data%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20AttributeType%20%3D%20%7B%0A%20%20VERTEX%3A%201%2C%0A%20%20INDEX%3A%202%2C%0A%20%20STORAGE%3A%203%2C%0A%20%20INDIRECT%3A%204%0A%7D%3B%0Avar%20GPU_CHUNK_BYTES%20%3D%2016%3B%0Avar%20BlendColorFactor%20%3D%20211%3B%0Avar%20OneMinusBlendColorFactor%20%3D%20212%3B%0Avar%20Attributes%20%3D%20class%20extends%20DataMap%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%7D%0A%20%20delete%28attribute2%29%20%7B%0A%20%20%20%20const%20attributeData%20%3D%20super.delete%28attribute2%29%3B%0A%20%20%20%20if%20%28attributeData%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this.backend.destroyAttribute%28attribute2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20attributeData%3B%0A%20%20%7D%0A%20%20update%28attribute2%2C%20type%29%20%7B%0A%20%20%20%20const%20data%20%3D%20this.get%28attribute2%29%3B%0A%20%20%20%20if%20%28data.version%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20AttributeType.VERTEX%29%20%7B%0A%20%20%20%20%20%20%20%20this.backend.createAttribute%28attribute2%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20AttributeType.INDEX%29%20%7B%0A%20%20%20%20%20%20%20%20this.backend.createIndexAttribute%28attribute2%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20AttributeType.STORAGE%29%20%7B%0A%20%20%20%20%20%20%20%20this.backend.createStorageAttribute%28attribute2%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20AttributeType.INDIRECT%29%20%7B%0A%20%20%20%20%20%20%20%20this.backend.createIndirectStorageAttribute%28attribute2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20data.version%20%3D%20this._getBufferAttribute%28attribute2%29.version%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20bufferAttribute2%20%3D%20this._getBufferAttribute%28attribute2%29%3B%0A%20%20%20%20%20%20if%20%28data.version%20%3C%20bufferAttribute2.version%20%7C%7C%20bufferAttribute2.usage%20%3D%3D%3D%20DynamicDrawUsage%29%20%7B%0A%20%20%20%20%20%20%20%20this.backend.updateAttribute%28attribute2%29%3B%0A%20%20%20%20%20%20%20%20data.version%20%3D%20bufferAttribute2.version%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_getBufferAttribute%28attribute2%29%20%7B%0A%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20attribute2%20%3D%20attribute2.data%3B%0A%20%20%20%20return%20attribute2%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20arrayNeedsUint322%28array%29%20%7B%0A%20%20for%20%28let%20i%20%3D%20array.length%20-%201%3B%20i%20%3E%3D%200%3B%20--i%29%20%7B%0A%20%20%20%20if%20%28array%5Bi%5D%20%3E%3D%2065535%29%20return%20true%3B%0A%20%20%7D%0A%20%20return%20false%3B%0A%7D%0Afunction%20getWireframeVersion%28geometry%29%20%7B%0A%20%20return%20geometry.index%20%21%3D%3D%20null%20%3F%20geometry.index.version%20%3A%20geometry.attributes.position.version%3B%0A%7D%0Afunction%20getWireframeIndex%28geometry%29%20%7B%0A%20%20const%20indices%20%3D%20%5B%5D%3B%0A%20%20const%20geometryIndex%20%3D%20geometry.index%3B%0A%20%20const%20geometryPosition%20%3D%20geometry.attributes.position%3B%0A%20%20if%20%28geometryIndex%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20const%20array%20%3D%20geometryIndex.array%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20array.length%3B%20i%20%3C%20l%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20const%20a2%20%3D%20array%5Bi%20%2B%200%5D%3B%0A%20%20%20%20%20%20const%20b%20%3D%20array%5Bi%20%2B%201%5D%3B%0A%20%20%20%20%20%20const%20c2%20%3D%20array%5Bi%20%2B%202%5D%3B%0A%20%20%20%20%20%20indices.push%28a2%2C%20b%2C%20b%2C%20c2%2C%20c2%2C%20a2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20const%20array%20%3D%20geometryPosition.array%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20array.length%20%2F%203%20-%201%3B%20i%20%3C%20l%3B%20i%20%2B%3D%203%29%20%7B%0A%20%20%20%20%20%20const%20a2%20%3D%20i%20%2B%200%3B%0A%20%20%20%20%20%20const%20b%20%3D%20i%20%2B%201%3B%0A%20%20%20%20%20%20const%20c2%20%3D%20i%20%2B%202%3B%0A%20%20%20%20%20%20indices.push%28a2%2C%20b%2C%20b%2C%20c2%2C%20c2%2C%20a2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20const%20attribute2%20%3D%20new%20%28arrayNeedsUint322%28indices%29%20%3F%20Uint32BufferAttribute2%20%3A%20Uint16BufferAttribute2%29%28indices%2C%201%29%3B%0A%20%20attribute2.version%20%3D%20getWireframeVersion%28geometry%29%3B%0A%20%20return%20attribute2%3B%0A%7D%0Avar%20Geometries%20%3D%20class%20extends%20DataMap%20%7B%0A%20%20constructor%28attributes%2C%20info%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.attributes%20%3D%20attributes%3B%0A%20%20%20%20this.info%20%3D%20info%3B%0A%20%20%20%20this.wireframes%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.attributeCall%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%20%20has%28renderObject%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20renderObject.geometry%3B%0A%20%20%20%20return%20super.has%28geometry%29%20%26%26%20this.get%28geometry%29.initialized%20%3D%3D%3D%20true%3B%0A%20%20%7D%0A%20%20updateForRender%28renderObject%29%20%7B%0A%20%20%20%20if%20%28this.has%28renderObject%29%20%3D%3D%3D%20false%29%20this.initGeometry%28renderObject%29%3B%0A%20%20%20%20this.updateAttributes%28renderObject%29%3B%0A%20%20%7D%0A%20%20initGeometry%28renderObject%29%20%7B%0A%20%20%20%20const%20geometry%20%3D%20renderObject.geometry%3B%0A%20%20%20%20const%20geometryData%20%3D%20this.get%28geometry%29%3B%0A%20%20%20%20geometryData.initialized%20%3D%20true%3B%0A%20%20%20%20this.info.memory.geometries%2B%2B%3B%0A%20%20%20%20const%20onDispose%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20this.info.memory.geometries--%3B%0A%20%20%20%20%20%20const%20index5%20%3D%20geometry.index%3B%0A%20%20%20%20%20%20const%20geometryAttributes%20%3D%20renderObject.getAttributes%28%29%3B%0A%20%20%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this.attributes.delete%28index5%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28const%20geometryAttribute%20of%20geometryAttributes%29%20%7B%0A%20%20%20%20%20%20%20%20this.attributes.delete%28geometryAttribute%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20wireframeAttribute%20%3D%20this.wireframes.get%28geometry%29%3B%0A%20%20%20%20%20%20if%20%28wireframeAttribute%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this.attributes.delete%28wireframeAttribute%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20geometry.removeEventListener%28%22dispose%22%2C%20onDispose%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20geometry.addEventListener%28%22dispose%22%2C%20onDispose%29%3B%0A%20%20%7D%0A%20%20updateAttributes%28renderObject%29%20%7B%0A%20%20%20%20const%20attributes%20%3D%20renderObject.getAttributes%28%29%3B%0A%20%20%20%20for%20%28const%20attribute2%20of%20attributes%29%20%7B%0A%20%20%20%20%20%20if%20%28attribute2.isStorageBufferAttribute%20%7C%7C%20attribute2.isStorageInstancedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20%20%20this.updateAttribute%28attribute2%2C%20AttributeType.STORAGE%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this.updateAttribute%28attribute2%2C%20AttributeType.VERTEX%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20index5%20%3D%20this.getIndex%28renderObject%29%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.updateAttribute%28index5%2C%20AttributeType.INDEX%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20indirect%20%3D%20renderObject.geometry.indirect%3B%0A%20%20%20%20if%20%28indirect%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.updateAttribute%28indirect%2C%20AttributeType.INDIRECT%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateAttribute%28attribute2%2C%20type%29%20%7B%0A%20%20%20%20const%20callId%20%3D%20this.info.render.calls%3B%0A%20%20%20%20if%20%28%21attribute2.isInterleavedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20if%20%28this.attributeCall.get%28attribute2%29%20%21%3D%3D%20callId%29%20%7B%0A%20%20%20%20%20%20%20%20this.attributes.update%28attribute2%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20this.attributeCall.set%28attribute2%2C%20callId%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28this.attributeCall.get%28attribute2%29%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this.attributes.update%28attribute2%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20this.attributeCall.set%28attribute2%2C%20callId%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28this.attributeCall.get%28attribute2.data%29%20%21%3D%3D%20callId%29%20%7B%0A%20%20%20%20%20%20%20%20this.attributes.update%28attribute2%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20this.attributeCall.set%28attribute2.data%2C%20callId%29%3B%0A%20%20%20%20%20%20%20%20this.attributeCall.set%28attribute2%2C%20callId%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getIndirect%28renderObject%29%20%7B%0A%20%20%20%20return%20renderObject.geometry.indirect%3B%0A%20%20%7D%0A%20%20getIndex%28renderObject%29%20%7B%0A%20%20%20%20const%20%7B%20geometry%2C%20material%20%7D%20%3D%20renderObject%3B%0A%20%20%20%20let%20index5%20%3D%20geometry.index%3B%0A%20%20%20%20if%20%28material.wireframe%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20wireframes%20%3D%20this.wireframes%3B%0A%20%20%20%20%20%20let%20wireframeAttribute%20%3D%20wireframes.get%28geometry%29%3B%0A%20%20%20%20%20%20if%20%28wireframeAttribute%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20wireframeAttribute%20%3D%20getWireframeIndex%28geometry%29%3B%0A%20%20%20%20%20%20%20%20wireframes.set%28geometry%2C%20wireframeAttribute%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28wireframeAttribute.version%20%21%3D%3D%20getWireframeVersion%28geometry%29%29%20%7B%0A%20%20%20%20%20%20%20%20this.attributes.delete%28wireframeAttribute%29%3B%0A%20%20%20%20%20%20%20%20wireframeAttribute%20%3D%20getWireframeIndex%28geometry%29%3B%0A%20%20%20%20%20%20%20%20wireframes.set%28geometry%2C%20wireframeAttribute%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20index5%20%3D%20wireframeAttribute%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20index5%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Info%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.autoReset%20%3D%20true%3B%0A%20%20%20%20this.frame%20%3D%200%3B%0A%20%20%20%20this.calls%20%3D%200%3B%0A%20%20%20%20this.render%20%3D%20%7B%0A%20%20%20%20%20%20calls%3A%200%2C%0A%20%20%20%20%20%20frameCalls%3A%200%2C%0A%20%20%20%20%20%20drawCalls%3A%200%2C%0A%20%20%20%20%20%20triangles%3A%200%2C%0A%20%20%20%20%20%20points%3A%200%2C%0A%20%20%20%20%20%20lines%3A%200%2C%0A%20%20%20%20%20%20timestamp%3A%200%2C%0A%20%20%20%20%20%20previousFrameCalls%3A%200%2C%0A%20%20%20%20%20%20timestampCalls%3A%200%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.compute%20%3D%20%7B%0A%20%20%20%20%20%20calls%3A%200%2C%0A%20%20%20%20%20%20frameCalls%3A%200%2C%0A%20%20%20%20%20%20timestamp%3A%200%2C%0A%20%20%20%20%20%20previousFrameCalls%3A%200%2C%0A%20%20%20%20%20%20timestampCalls%3A%200%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.memory%20%3D%20%7B%0A%20%20%20%20%20%20geometries%3A%200%2C%0A%20%20%20%20%20%20textures%3A%200%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20update%28object%2C%20count%2C%20instanceCount%29%20%7B%0A%20%20%20%20this.render.drawCalls%2B%2B%3B%0A%20%20%20%20if%20%28object.isMesh%20%7C%7C%20object.isSprite%29%20%7B%0A%20%20%20%20%20%20this.render.triangles%20%2B%3D%20instanceCount%20%2A%20%28count%20%2F%203%29%3B%0A%20%20%20%20%7D%20else%20if%20%28object.isPoints%29%20%7B%0A%20%20%20%20%20%20this.render.points%20%2B%3D%20instanceCount%20%2A%20count%3B%0A%20%20%20%20%7D%20else%20if%20%28object.isLineSegments%29%20%7B%0A%20%20%20%20%20%20this.render.lines%20%2B%3D%20instanceCount%20%2A%20%28count%20%2F%202%29%3B%0A%20%20%20%20%7D%20else%20if%20%28object.isLine%29%20%7B%0A%20%20%20%20%20%20this.render.lines%20%2B%3D%20instanceCount%20%2A%20%28count%20-%201%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGPUInfo%3A%20Unknown%20object%20type.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateTimestamp%28type%2C%20time%29%20%7B%0A%20%20%20%20if%20%28this%5Btype%5D.timestampCalls%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20this%5Btype%5D.timestamp%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20this%5Btype%5D.timestamp%20%2B%3D%20time%3B%0A%20%20%20%20this%5Btype%5D.timestampCalls%2B%2B%3B%0A%20%20%20%20if%20%28this%5Btype%5D.timestampCalls%20%3E%3D%20this%5Btype%5D.previousFrameCalls%29%20%7B%0A%20%20%20%20%20%20this%5Btype%5D.timestampCalls%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20reset%28%29%20%7B%0A%20%20%20%20const%20previousRenderFrameCalls%20%3D%20this.render.frameCalls%3B%0A%20%20%20%20this.render.previousFrameCalls%20%3D%20previousRenderFrameCalls%3B%0A%20%20%20%20const%20previousComputeFrameCalls%20%3D%20this.compute.frameCalls%3B%0A%20%20%20%20this.compute.previousFrameCalls%20%3D%20previousComputeFrameCalls%3B%0A%20%20%20%20this.render.drawCalls%20%3D%200%3B%0A%20%20%20%20this.render.frameCalls%20%3D%200%3B%0A%20%20%20%20this.compute.frameCalls%20%3D%200%3B%0A%20%20%20%20this.render.triangles%20%3D%200%3B%0A%20%20%20%20this.render.points%20%3D%200%3B%0A%20%20%20%20this.render.lines%20%3D%200%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.reset%28%29%3B%0A%20%20%20%20this.calls%20%3D%200%3B%0A%20%20%20%20this.render.calls%20%3D%200%3B%0A%20%20%20%20this.compute.calls%20%3D%200%3B%0A%20%20%20%20this.render.timestamp%20%3D%200%3B%0A%20%20%20%20this.compute.timestamp%20%3D%200%3B%0A%20%20%20%20this.memory.geometries%20%3D%200%3B%0A%20%20%20%20this.memory.textures%20%3D%200%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Pipeline%20%3D%20class%20%7B%0A%20%20constructor%28cacheKey%29%20%7B%0A%20%20%20%20this.cacheKey%20%3D%20cacheKey%3B%0A%20%20%20%20this.usedTimes%20%3D%200%3B%0A%20%20%7D%0A%7D%3B%0Avar%20RenderPipeline%20%3D%20class%20extends%20Pipeline%20%7B%0A%20%20constructor%28cacheKey%2C%20vertexProgram%2C%20fragmentProgram%29%20%7B%0A%20%20%20%20super%28cacheKey%29%3B%0A%20%20%20%20this.vertexProgram%20%3D%20vertexProgram%3B%0A%20%20%20%20this.fragmentProgram%20%3D%20fragmentProgram%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ComputePipeline%20%3D%20class%20extends%20Pipeline%20%7B%0A%20%20constructor%28cacheKey%2C%20computeProgram%29%20%7B%0A%20%20%20%20super%28cacheKey%29%3B%0A%20%20%20%20this.computeProgram%20%3D%20computeProgram%3B%0A%20%20%20%20this.isComputePipeline%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_id%246%20%3D%200%3B%0Avar%20ProgrammableStage%20%3D%20class%20%7B%0A%20%20constructor%28code%2C%20type%2C%20transforms%20%3D%20null%2C%20attributes%20%3D%20null%29%20%7B%0A%20%20%20%20this.id%20%3D%20_id%246%2B%2B%3B%0A%20%20%20%20this.code%20%3D%20code%3B%0A%20%20%20%20this.stage%20%3D%20type%3B%0A%20%20%20%20this.transforms%20%3D%20transforms%3B%0A%20%20%20%20this.attributes%20%3D%20attributes%3B%0A%20%20%20%20this.usedTimes%20%3D%200%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Pipelines%20%3D%20class%20extends%20DataMap%20%7B%0A%20%20constructor%28backend%2C%20nodes%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.nodes%20%3D%20nodes%3B%0A%20%20%20%20this.bindings%20%3D%20null%3B%0A%20%20%20%20this.caches%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20this.programs%20%3D%20%7B%0A%20%20%20%20%20%20vertex%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%2C%0A%20%20%20%20%20%20fragment%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%2C%0A%20%20%20%20%20%20compute%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20getForCompute%28computeNode%2C%20bindings%29%20%7B%0A%20%20%20%20const%20%7B%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20data%20%3D%20this.get%28computeNode%29%3B%0A%20%20%20%20if%20%28this._needsComputeUpdate%28computeNode%29%29%20%7B%0A%20%20%20%20%20%20const%20previousPipeline%20%3D%20data.pipeline%3B%0A%20%20%20%20%20%20if%20%28previousPipeline%29%20%7B%0A%20%20%20%20%20%20%20%20previousPipeline.usedTimes--%3B%0A%20%20%20%20%20%20%20%20previousPipeline.computeProgram.usedTimes--%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20nodeBuilderState%20%3D%20this.nodes.getForCompute%28computeNode%29%3B%0A%20%20%20%20%20%20let%20stageCompute%20%3D%20this.programs.compute.get%28nodeBuilderState.computeShader%29%3B%0A%20%20%20%20%20%20if%20%28stageCompute%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28previousPipeline%20%26%26%20previousPipeline.computeProgram.usedTimes%20%3D%3D%3D%200%29%20this._releaseProgram%28previousPipeline.computeProgram%29%3B%0A%20%20%20%20%20%20%20%20stageCompute%20%3D%20new%20ProgrammableStage%28nodeBuilderState.computeShader%2C%20%22compute%22%2C%20nodeBuilderState.transforms%2C%20nodeBuilderState.nodeAttributes%29%3B%0A%20%20%20%20%20%20%20%20this.programs.compute.set%28nodeBuilderState.computeShader%2C%20stageCompute%29%3B%0A%20%20%20%20%20%20%20%20backend.createProgram%28stageCompute%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20cacheKey%20%3D%20this._getComputeCacheKey%28computeNode%2C%20stageCompute%29%3B%0A%20%20%20%20%20%20let%20pipeline%20%3D%20this.caches.get%28cacheKey%29%3B%0A%20%20%20%20%20%20if%20%28pipeline%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28previousPipeline%20%26%26%20previousPipeline.usedTimes%20%3D%3D%3D%200%29%20this._releasePipeline%28previousPipeline%29%3B%0A%20%20%20%20%20%20%20%20pipeline%20%3D%20this._getComputePipeline%28computeNode%2C%20stageCompute%2C%20cacheKey%2C%20bindings%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20pipeline.usedTimes%2B%2B%3B%0A%20%20%20%20%20%20stageCompute.usedTimes%2B%2B%3B%0A%20%20%20%20%20%20data.version%20%3D%20computeNode.version%3B%0A%20%20%20%20%20%20data.pipeline%20%3D%20pipeline%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data.pipeline%3B%0A%20%20%7D%0A%20%20getForRender%28renderObject%2C%20promises%20%3D%20null%29%20%7B%0A%20%20%20%20const%20%7B%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20data%20%3D%20this.get%28renderObject%29%3B%0A%20%20%20%20if%20%28this._needsRenderUpdate%28renderObject%29%29%20%7B%0A%20%20%20%20%20%20const%20previousPipeline%20%3D%20data.pipeline%3B%0A%20%20%20%20%20%20if%20%28previousPipeline%29%20%7B%0A%20%20%20%20%20%20%20%20previousPipeline.usedTimes--%3B%0A%20%20%20%20%20%20%20%20previousPipeline.vertexProgram.usedTimes--%3B%0A%20%20%20%20%20%20%20%20previousPipeline.fragmentProgram.usedTimes--%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20nodeBuilderState%20%3D%20renderObject.getNodeBuilderState%28%29%3B%0A%20%20%20%20%20%20let%20stageVertex%20%3D%20this.programs.vertex.get%28nodeBuilderState.vertexShader%29%3B%0A%20%20%20%20%20%20if%20%28stageVertex%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28previousPipeline%20%26%26%20previousPipeline.vertexProgram.usedTimes%20%3D%3D%3D%200%29%20this._releaseProgram%28previousPipeline.vertexProgram%29%3B%0A%20%20%20%20%20%20%20%20stageVertex%20%3D%20new%20ProgrammableStage%28nodeBuilderState.vertexShader%2C%20%22vertex%22%29%3B%0A%20%20%20%20%20%20%20%20this.programs.vertex.set%28nodeBuilderState.vertexShader%2C%20stageVertex%29%3B%0A%20%20%20%20%20%20%20%20backend.createProgram%28stageVertex%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20stageFragment%20%3D%20this.programs.fragment.get%28nodeBuilderState.fragmentShader%29%3B%0A%20%20%20%20%20%20if%20%28stageFragment%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28previousPipeline%20%26%26%20previousPipeline.fragmentProgram.usedTimes%20%3D%3D%3D%200%29%20this._releaseProgram%28previousPipeline.fragmentProgram%29%3B%0A%20%20%20%20%20%20%20%20stageFragment%20%3D%20new%20ProgrammableStage%28nodeBuilderState.fragmentShader%2C%20%22fragment%22%29%3B%0A%20%20%20%20%20%20%20%20this.programs.fragment.set%28nodeBuilderState.fragmentShader%2C%20stageFragment%29%3B%0A%20%20%20%20%20%20%20%20backend.createProgram%28stageFragment%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20cacheKey%20%3D%20this._getRenderCacheKey%28renderObject%2C%20stageVertex%2C%20stageFragment%29%3B%0A%20%20%20%20%20%20let%20pipeline%20%3D%20this.caches.get%28cacheKey%29%3B%0A%20%20%20%20%20%20if%20%28pipeline%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28previousPipeline%20%26%26%20previousPipeline.usedTimes%20%3D%3D%3D%200%29%20this._releasePipeline%28previousPipeline%29%3B%0A%20%20%20%20%20%20%20%20pipeline%20%3D%20this._getRenderPipeline%28renderObject%2C%20stageVertex%2C%20stageFragment%2C%20cacheKey%2C%20promises%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20renderObject.pipeline%20%3D%20pipeline%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20pipeline.usedTimes%2B%2B%3B%0A%20%20%20%20%20%20stageVertex.usedTimes%2B%2B%3B%0A%20%20%20%20%20%20stageFragment.usedTimes%2B%2B%3B%0A%20%20%20%20%20%20data.pipeline%20%3D%20pipeline%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data.pipeline%3B%0A%20%20%7D%0A%20%20delete%28object%29%20%7B%0A%20%20%20%20const%20pipeline%20%3D%20this.get%28object%29.pipeline%3B%0A%20%20%20%20if%20%28pipeline%29%20%7B%0A%20%20%20%20%20%20pipeline.usedTimes--%3B%0A%20%20%20%20%20%20if%20%28pipeline.usedTimes%20%3D%3D%3D%200%29%20this._releasePipeline%28pipeline%29%3B%0A%20%20%20%20%20%20if%20%28pipeline.isComputePipeline%29%20%7B%0A%20%20%20%20%20%20%20%20pipeline.computeProgram.usedTimes--%3B%0A%20%20%20%20%20%20%20%20if%20%28pipeline.computeProgram.usedTimes%20%3D%3D%3D%200%29%20this._releaseProgram%28pipeline.computeProgram%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20pipeline.fragmentProgram.usedTimes--%3B%0A%20%20%20%20%20%20%20%20pipeline.vertexProgram.usedTimes--%3B%0A%20%20%20%20%20%20%20%20if%20%28pipeline.vertexProgram.usedTimes%20%3D%3D%3D%200%29%20this._releaseProgram%28pipeline.vertexProgram%29%3B%0A%20%20%20%20%20%20%20%20if%20%28pipeline.fragmentProgram.usedTimes%20%3D%3D%3D%200%29%20this._releaseProgram%28pipeline.fragmentProgram%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20super.delete%28object%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20super.dispose%28%29%3B%0A%20%20%20%20this.caches%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20this.programs%20%3D%20%7B%0A%20%20%20%20%20%20vertex%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%2C%0A%20%20%20%20%20%20fragment%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%2C%0A%20%20%20%20%20%20compute%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20updateForRender%28renderObject%29%20%7B%0A%20%20%20%20this.getForRender%28renderObject%29%3B%0A%20%20%7D%0A%20%20_getComputePipeline%28computeNode%2C%20stageCompute%2C%20cacheKey%2C%20bindings%29%20%7B%0A%20%20%20%20cacheKey%20%3D%20cacheKey%20%7C%7C%20this._getComputeCacheKey%28computeNode%2C%20stageCompute%29%3B%0A%20%20%20%20let%20pipeline%20%3D%20this.caches.get%28cacheKey%29%3B%0A%20%20%20%20if%20%28pipeline%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20pipeline%20%3D%20new%20ComputePipeline%28cacheKey%2C%20stageCompute%29%3B%0A%20%20%20%20%20%20this.caches.set%28cacheKey%2C%20pipeline%29%3B%0A%20%20%20%20%20%20this.backend.createComputePipeline%28pipeline%2C%20bindings%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20pipeline%3B%0A%20%20%7D%0A%20%20_getRenderPipeline%28renderObject%2C%20stageVertex%2C%20stageFragment%2C%20cacheKey%2C%20promises%29%20%7B%0A%20%20%20%20cacheKey%20%3D%20cacheKey%20%7C%7C%20this._getRenderCacheKey%28renderObject%2C%20stageVertex%2C%20stageFragment%29%3B%0A%20%20%20%20let%20pipeline%20%3D%20this.caches.get%28cacheKey%29%3B%0A%20%20%20%20if%20%28pipeline%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20pipeline%20%3D%20new%20RenderPipeline%28cacheKey%2C%20stageVertex%2C%20stageFragment%29%3B%0A%20%20%20%20%20%20this.caches.set%28cacheKey%2C%20pipeline%29%3B%0A%20%20%20%20%20%20renderObject.pipeline%20%3D%20pipeline%3B%0A%20%20%20%20%20%20this.backend.createRenderPipeline%28renderObject%2C%20promises%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20pipeline%3B%0A%20%20%7D%0A%20%20_getComputeCacheKey%28computeNode%2C%20stageCompute%29%20%7B%0A%20%20%20%20return%20computeNode.id%20%2B%20%22%2C%22%20%2B%20stageCompute.id%3B%0A%20%20%7D%0A%20%20_getRenderCacheKey%28renderObject%2C%20stageVertex%2C%20stageFragment%29%20%7B%0A%20%20%20%20return%20stageVertex.id%20%2B%20%22%2C%22%20%2B%20stageFragment.id%20%2B%20%22%2C%22%20%2B%20this.backend.getRenderCacheKey%28renderObject%29%3B%0A%20%20%7D%0A%20%20_releasePipeline%28pipeline%29%20%7B%0A%20%20%20%20this.caches.delete%28pipeline.cacheKey%29%3B%0A%20%20%7D%0A%20%20_releaseProgram%28program%29%20%7B%0A%20%20%20%20const%20code%20%3D%20program.code%3B%0A%20%20%20%20const%20stage%20%3D%20program.stage%3B%0A%20%20%20%20this.programs%5Bstage%5D.delete%28code%29%3B%0A%20%20%7D%0A%20%20_needsComputeUpdate%28computeNode%29%20%7B%0A%20%20%20%20const%20data%20%3D%20this.get%28computeNode%29%3B%0A%20%20%20%20return%20data.pipeline%20%3D%3D%3D%20void%200%20%7C%7C%20data.version%20%21%3D%3D%20computeNode.version%3B%0A%20%20%7D%0A%20%20_needsRenderUpdate%28renderObject%29%20%7B%0A%20%20%20%20const%20data%20%3D%20this.get%28renderObject%29%3B%0A%20%20%20%20return%20data.pipeline%20%3D%3D%3D%20void%200%20%7C%7C%20this.backend.needsRenderUpdate%28renderObject%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Bindings%20%3D%20class%20extends%20DataMap%20%7B%0A%20%20constructor%28backend%2C%20nodes%2C%20textures%2C%20attributes%2C%20pipelines%2C%20info%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.textures%20%3D%20textures%3B%0A%20%20%20%20this.pipelines%20%3D%20pipelines%3B%0A%20%20%20%20this.attributes%20%3D%20attributes%3B%0A%20%20%20%20this.nodes%20%3D%20nodes%3B%0A%20%20%20%20this.info%20%3D%20info%3B%0A%20%20%20%20this.pipelines.bindings%20%3D%20this%3B%0A%20%20%7D%0A%20%20getForRender%28renderObject%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20renderObject.getBindings%28%29%3B%0A%20%20%20%20for%20%28const%20bindGroup%20of%20bindings%29%20%7B%0A%20%20%20%20%20%20const%20groupData%20%3D%20this.get%28bindGroup%29%3B%0A%20%20%20%20%20%20if%20%28groupData.bindGroup%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this._init%28bindGroup%29%3B%0A%20%20%20%20%20%20%20%20this.backend.createBindings%28bindGroup%2C%20bindings%29%3B%0A%20%20%20%20%20%20%20%20groupData.bindGroup%20%3D%20bindGroup%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20bindings%3B%0A%20%20%7D%0A%20%20getForCompute%28computeNode%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20this.nodes.getForCompute%28computeNode%29.bindings%3B%0A%20%20%20%20for%20%28const%20bindGroup%20of%20bindings%29%20%7B%0A%20%20%20%20%20%20const%20groupData%20%3D%20this.get%28bindGroup%29%3B%0A%20%20%20%20%20%20if%20%28groupData.bindGroup%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this._init%28bindGroup%29%3B%0A%20%20%20%20%20%20%20%20this.backend.createBindings%28bindGroup%2C%20bindings%29%3B%0A%20%20%20%20%20%20%20%20groupData.bindGroup%20%3D%20bindGroup%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20bindings%3B%0A%20%20%7D%0A%20%20updateForCompute%28computeNode%29%20%7B%0A%20%20%20%20this._updateBindings%28this.getForCompute%28computeNode%29%29%3B%0A%20%20%7D%0A%20%20updateForRender%28renderObject%29%20%7B%0A%20%20%20%20this._updateBindings%28this.getForRender%28renderObject%29%29%3B%0A%20%20%7D%0A%20%20_updateBindings%28bindings%29%20%7B%0A%20%20%20%20for%20%28const%20bindGroup%20of%20bindings%29%20%7B%0A%20%20%20%20%20%20this._update%28bindGroup%2C%20bindings%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_init%28bindGroup%29%20%7B%0A%20%20%20%20for%20%28const%20binding%20of%20bindGroup.bindings%29%20%7B%0A%20%20%20%20%20%20if%20%28binding.isSampledTexture%29%20%7B%0A%20%20%20%20%20%20%20%20this.textures.updateTexture%28binding.texture%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isStorageBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20const%20attribute2%20%3D%20binding.attribute%3B%0A%20%20%20%20%20%20%20%20const%20attributeType%20%3D%20attribute2.isIndirectStorageBufferAttribute%20%3F%20AttributeType.INDIRECT%20%3A%20AttributeType.STORAGE%3B%0A%20%20%20%20%20%20%20%20this.attributes.update%28attribute2%2C%20attributeType%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_update%28bindGroup%2C%20bindings%29%20%7B%0A%20%20%20%20const%20%7B%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20needsBindingsUpdate%20%3D%20false%3B%0A%20%20%20%20for%20%28const%20binding%20of%20bindGroup.bindings%29%20%7B%0A%20%20%20%20%20%20if%20%28binding.isNodeUniformsGroup%29%20%7B%0A%20%20%20%20%20%20%20%20const%20updated%20%3D%20this.nodes.updateGroup%28binding%29%3B%0A%20%20%20%20%20%20%20%20if%20%28%21updated%29%20continue%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28binding.isUniformBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20const%20updated%20%3D%20binding.update%28%29%3B%0A%20%20%20%20%20%20%20%20if%20%28updated%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20backend.updateBinding%28binding%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampler%29%20%7B%0A%20%20%20%20%20%20%20%20binding.update%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28binding.needsBindingsUpdate%28this.textures.get%28binding.texture%29.generation%29%29%20needsBindingsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20const%20updated%20%3D%20binding.update%28%29%3B%0A%20%20%20%20%20%20%20%20const%20texture2%20%3D%20binding.texture%3B%0A%20%20%20%20%20%20%20%20if%20%28updated%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.textures.updateTexture%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20const%20textureData%20%3D%20backend.get%28texture2%29%3B%0A%20%20%20%20%20%20%20%20if%20%28backend.isWebGPUBackend%20%3D%3D%3D%20true%20%26%26%20textureData.texture%20%3D%3D%3D%20void%200%20%26%26%20textureData.externalTexture%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22Bindings._update%3A%20binding%20should%20be%20available%3A%22%2C%20binding%2C%20updated%2C%20texture2%2C%20binding.textureNode.value%2C%20needsBindingsUpdate%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.textures.updateTexture%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20needsBindingsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28texture2.isStorageTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20textureData2%20%3D%20this.get%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28binding.store%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20textureData2.needsMipmap%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28this.textures.needsMipmaps%28texture2%29%20%26%26%20textureData2.needsMipmap%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.backend.generateMipmaps%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20textureData2.needsMipmap%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28needsBindingsUpdate%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.backend.updateBindings%28bindGroup%2C%20bindings%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Afunction%20painterSortStable2%28a2%2C%20b%29%20%7B%0A%20%20if%20%28a2.groupOrder%20%21%3D%3D%20b.groupOrder%29%20%7B%0A%20%20%20%20return%20a2.groupOrder%20-%20b.groupOrder%3B%0A%20%20%7D%20else%20if%20%28a2.renderOrder%20%21%3D%3D%20b.renderOrder%29%20%7B%0A%20%20%20%20return%20a2.renderOrder%20-%20b.renderOrder%3B%0A%20%20%7D%20else%20if%20%28a2.material.id%20%21%3D%3D%20b.material.id%29%20%7B%0A%20%20%20%20return%20a2.material.id%20-%20b.material.id%3B%0A%20%20%7D%20else%20if%20%28a2.z%20%21%3D%3D%20b.z%29%20%7B%0A%20%20%20%20return%20a2.z%20-%20b.z%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20a2.id%20-%20b.id%3B%0A%20%20%7D%0A%7D%0Afunction%20reversePainterSortStable2%28a2%2C%20b%29%20%7B%0A%20%20if%20%28a2.groupOrder%20%21%3D%3D%20b.groupOrder%29%20%7B%0A%20%20%20%20return%20a2.groupOrder%20-%20b.groupOrder%3B%0A%20%20%7D%20else%20if%20%28a2.renderOrder%20%21%3D%3D%20b.renderOrder%29%20%7B%0A%20%20%20%20return%20a2.renderOrder%20-%20b.renderOrder%3B%0A%20%20%7D%20else%20if%20%28a2.z%20%21%3D%3D%20b.z%29%20%7B%0A%20%20%20%20return%20b.z%20-%20a2.z%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20a2.id%20-%20b.id%3B%0A%20%20%7D%0A%7D%0Afunction%20needsDoublePass%28material%29%20%7B%0A%20%20const%20hasTransmission%20%3D%20material.transmission%20%3E%200%20%7C%7C%20material.transmissionNode%3B%0A%20%20return%20hasTransmission%20%26%26%20material.side%20%3D%3D%3D%20DoubleSide2%20%26%26%20material.forceSinglePass%20%3D%3D%3D%20false%3B%0A%7D%0Avar%20RenderList%20%3D%20class%20%7B%0A%20%20constructor%28lighting%2C%20scene3%2C%20camera3%29%20%7B%0A%20%20%20%20this.renderItems%20%3D%20%5B%5D%3B%0A%20%20%20%20this.renderItemsIndex%20%3D%200%3B%0A%20%20%20%20this.opaque%20%3D%20%5B%5D%3B%0A%20%20%20%20this.transparentDoublePass%20%3D%20%5B%5D%3B%0A%20%20%20%20this.transparent%20%3D%20%5B%5D%3B%0A%20%20%20%20this.bundles%20%3D%20%5B%5D%3B%0A%20%20%20%20this.lightsNode%20%3D%20lighting.getNode%28scene3%2C%20camera3%29%3B%0A%20%20%20%20this.lightsArray%20%3D%20%5B%5D%3B%0A%20%20%20%20this.scene%20%3D%20scene3%3B%0A%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%20%20this.occlusionQueryCount%20%3D%200%3B%0A%20%20%7D%0A%20%20begin%28%29%20%7B%0A%20%20%20%20this.renderItemsIndex%20%3D%200%3B%0A%20%20%20%20this.opaque.length%20%3D%200%3B%0A%20%20%20%20this.transparentDoublePass.length%20%3D%200%3B%0A%20%20%20%20this.transparent.length%20%3D%200%3B%0A%20%20%20%20this.bundles.length%20%3D%200%3B%0A%20%20%20%20this.lightsArray.length%20%3D%200%3B%0A%20%20%20%20this.occlusionQueryCount%20%3D%200%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getNextRenderItem%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%20%7B%0A%20%20%20%20let%20renderItem%20%3D%20this.renderItems%5Bthis.renderItemsIndex%5D%3B%0A%20%20%20%20if%20%28renderItem%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20renderItem%20%3D%20%7B%0A%20%20%20%20%20%20%20%20id%3A%20object.id%2C%0A%20%20%20%20%20%20%20%20object%2C%0A%20%20%20%20%20%20%20%20geometry%2C%0A%20%20%20%20%20%20%20%20material%2C%0A%20%20%20%20%20%20%20%20groupOrder%2C%0A%20%20%20%20%20%20%20%20renderOrder%3A%20object.renderOrder%2C%0A%20%20%20%20%20%20%20%20z%3A%20z2%2C%0A%20%20%20%20%20%20%20%20group%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20this.renderItems%5Bthis.renderItemsIndex%5D%20%3D%20renderItem%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderItem.id%20%3D%20object.id%3B%0A%20%20%20%20%20%20renderItem.object%20%3D%20object%3B%0A%20%20%20%20%20%20renderItem.geometry%20%3D%20geometry%3B%0A%20%20%20%20%20%20renderItem.material%20%3D%20material%3B%0A%20%20%20%20%20%20renderItem.groupOrder%20%3D%20groupOrder%3B%0A%20%20%20%20%20%20renderItem.renderOrder%20%3D%20object.renderOrder%3B%0A%20%20%20%20%20%20renderItem.z%20%3D%20z2%3B%0A%20%20%20%20%20%20renderItem.group%20%3D%20group%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.renderItemsIndex%2B%2B%3B%0A%20%20%20%20return%20renderItem%3B%0A%20%20%7D%0A%20%20push%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%20%7B%0A%20%20%20%20const%20renderItem%20%3D%20this.getNextRenderItem%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%3B%0A%20%20%20%20if%20%28object.occlusionTest%20%3D%3D%3D%20true%29%20this.occlusionQueryCount%2B%2B%3B%0A%20%20%20%20if%20%28material.transparent%20%3D%3D%3D%20true%20%7C%7C%20material.transmission%20%3E%200%29%20%7B%0A%20%20%20%20%20%20if%20%28needsDoublePass%28material%29%29%20this.transparentDoublePass.push%28renderItem%29%3B%0A%20%20%20%20%20%20this.transparent.push%28renderItem%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.opaque.push%28renderItem%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20unshift%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%20%7B%0A%20%20%20%20const%20renderItem%20%3D%20this.getNextRenderItem%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20z2%2C%20group%29%3B%0A%20%20%20%20if%20%28material.transparent%20%3D%3D%3D%20true%20%7C%7C%20material.transmission%20%3E%200%29%20%7B%0A%20%20%20%20%20%20if%20%28needsDoublePass%28material%29%29%20this.transparentDoublePass.unshift%28renderItem%29%3B%0A%20%20%20%20%20%20this.transparent.unshift%28renderItem%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.opaque.unshift%28renderItem%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20pushBundle%28group%29%20%7B%0A%20%20%20%20this.bundles.push%28group%29%3B%0A%20%20%7D%0A%20%20pushLight%28light%29%20%7B%0A%20%20%20%20this.lightsArray.push%28light%29%3B%0A%20%20%7D%0A%20%20sort%28customOpaqueSort%2C%20customTransparentSort%29%20%7B%0A%20%20%20%20if%20%28this.opaque.length%20%3E%201%29%20this.opaque.sort%28customOpaqueSort%20%7C%7C%20painterSortStable2%29%3B%0A%20%20%20%20if%20%28this.transparentDoublePass.length%20%3E%201%29%20this.transparentDoublePass.sort%28customTransparentSort%20%7C%7C%20reversePainterSortStable2%29%3B%0A%20%20%20%20if%20%28this.transparent.length%20%3E%201%29%20this.transparent.sort%28customTransparentSort%20%7C%7C%20reversePainterSortStable2%29%3B%0A%20%20%7D%0A%20%20finish%28%29%20%7B%0A%20%20%20%20this.lightsNode.setLights%28this.lightsArray%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%20this.renderItemsIndex%2C%20il%20%3D%20this.renderItems.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20renderItem%20%3D%20this.renderItems%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28renderItem.id%20%3D%3D%3D%20null%29%20break%3B%0A%20%20%20%20%20%20renderItem.id%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.object%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.geometry%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.material%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.groupOrder%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.renderOrder%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.z%20%3D%20null%3B%0A%20%20%20%20%20%20renderItem.group%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20RenderLists%20%3D%20class%20%7B%0A%20%20constructor%28lighting%29%20%7B%0A%20%20%20%20this.lighting%20%3D%20lighting%3B%0A%20%20%20%20this.lists%20%3D%20new%20ChainMap%28%29%3B%0A%20%20%7D%0A%20%20get%28scene3%2C%20camera3%29%20%7B%0A%20%20%20%20const%20lists%20%3D%20this.lists%3B%0A%20%20%20%20const%20keys%20%3D%20%5Bscene3%2C%20camera3%5D%3B%0A%20%20%20%20let%20list%20%3D%20lists.get%28keys%29%3B%0A%20%20%20%20if%20%28list%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20list%20%3D%20new%20RenderList%28this.lighting%2C%20scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20lists.set%28keys%2C%20list%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20list%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.lists%20%3D%20new%20ChainMap%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20id%241%20%3D%200%3B%0Avar%20RenderContext%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.id%20%3D%20id%241%2B%2B%3B%0A%20%20%20%20this.color%20%3D%20true%3B%0A%20%20%20%20this.clearColor%20%3D%20true%3B%0A%20%20%20%20this.clearColorValue%20%3D%20%7B%20r%3A%200%2C%20g%3A%200%2C%20b%3A%200%2C%20a%3A%201%20%7D%3B%0A%20%20%20%20this.depth%20%3D%20true%3B%0A%20%20%20%20this.clearDepth%20%3D%20true%3B%0A%20%20%20%20this.clearDepthValue%20%3D%201%3B%0A%20%20%20%20this.stencil%20%3D%20false%3B%0A%20%20%20%20this.clearStencil%20%3D%20true%3B%0A%20%20%20%20this.clearStencilValue%20%3D%201%3B%0A%20%20%20%20this.viewport%20%3D%20false%3B%0A%20%20%20%20this.viewportValue%20%3D%20new%20Vector42%28%29%3B%0A%20%20%20%20this.scissor%20%3D%20false%3B%0A%20%20%20%20this.scissorValue%20%3D%20new%20Vector42%28%29%3B%0A%20%20%20%20this.textures%20%3D%20null%3B%0A%20%20%20%20this.depthTexture%20%3D%20null%3B%0A%20%20%20%20this.activeCubeFace%20%3D%200%3B%0A%20%20%20%20this.sampleCount%20%3D%201%3B%0A%20%20%20%20this.width%20%3D%200%3B%0A%20%20%20%20this.height%20%3D%200%3B%0A%20%20%20%20this.isRenderContext%20%3D%20true%3B%0A%20%20%7D%0A%20%20getCacheKey%28%29%20%7B%0A%20%20%20%20return%20getCacheKey%28this%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20getCacheKey%28renderContext%29%20%7B%0A%20%20const%20%7B%20textures%2C%20activeCubeFace%20%7D%20%3D%20renderContext%3B%0A%20%20const%20values%20%3D%20%5BactiveCubeFace%5D%3B%0A%20%20for%20%28const%20texture2%20of%20textures%29%20%7B%0A%20%20%20%20values.push%28texture2.id%29%3B%0A%20%20%7D%0A%20%20return%20hashArray%28values%29%3B%0A%7D%0Avar%20RenderContexts%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.chainMaps%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20get%28scene3%2C%20camera3%2C%20renderTarget%20%3D%20null%29%20%7B%0A%20%20%20%20const%20chainKey%20%3D%20%5Bscene3%2C%20camera3%5D%3B%0A%20%20%20%20let%20attachmentState%3B%0A%20%20%20%20if%20%28renderTarget%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20attachmentState%20%3D%20%22default%22%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20format2%20%3D%20renderTarget.texture.format%3B%0A%20%20%20%20%20%20const%20count%20%3D%20renderTarget.textures.length%3B%0A%20%20%20%20%20%20attachmentState%20%3D%20%60%24%7Bcount%7D%3A%24%7Bformat2%7D%3A%24%7BrenderTarget.samples%7D%3A%24%7BrenderTarget.depthBuffer%7D%3A%24%7BrenderTarget.stencilBuffer%7D%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20chainMap%20%3D%20this.getChainMap%28attachmentState%29%3B%0A%20%20%20%20let%20renderState%20%3D%20chainMap.get%28chainKey%29%3B%0A%20%20%20%20if%20%28renderState%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20renderState%20%3D%20new%20RenderContext%28%29%3B%0A%20%20%20%20%20%20chainMap.set%28chainKey%2C%20renderState%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%29%20renderState.sampleCount%20%3D%20renderTarget.samples%20%3D%3D%3D%200%20%3F%201%20%3A%20renderTarget.samples%3B%0A%20%20%20%20return%20renderState%3B%0A%20%20%7D%0A%20%20getChainMap%28attachmentState%29%20%7B%0A%20%20%20%20return%20this.chainMaps%5BattachmentState%5D%20%7C%7C%20%28this.chainMaps%5BattachmentState%5D%20%3D%20new%20ChainMap%28%29%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.chainMaps%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_size%243%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28%29%3B%0Avar%20Textures%20%3D%20class%20extends%20DataMap%20%7B%0A%20%20constructor%28renderer3%2C%20backend%2C%20info%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.renderer%20%3D%20renderer3%3B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.info%20%3D%20info%3B%0A%20%20%7D%0A%20%20updateRenderTarget%28renderTarget%2C%20activeMipmapLevel%20%3D%200%29%20%7B%0A%20%20%20%20const%20renderTargetData%20%3D%20this.get%28renderTarget%29%3B%0A%20%20%20%20const%20sampleCount%20%3D%20renderTarget.samples%20%3D%3D%3D%200%20%3F%201%20%3A%20renderTarget.samples%3B%0A%20%20%20%20const%20depthTextureMips%20%3D%20renderTargetData.depthTextureMips%20%7C%7C%20%28renderTargetData.depthTextureMips%20%3D%20%7B%7D%29%3B%0A%20%20%20%20const%20textures%20%3D%20renderTarget.textures%3B%0A%20%20%20%20const%20size%20%3D%20this.getSize%28textures%5B0%5D%29%3B%0A%20%20%20%20const%20mipWidth%20%3D%20size.width%20%3E%3E%20activeMipmapLevel%3B%0A%20%20%20%20const%20mipHeight%20%3D%20size.height%20%3E%3E%20activeMipmapLevel%3B%0A%20%20%20%20let%20depthTexture%20%3D%20renderTarget.depthTexture%20%7C%7C%20depthTextureMips%5BactiveMipmapLevel%5D%3B%0A%20%20%20%20const%20useDepthTexture%20%3D%20renderTarget.depthBuffer%20%3D%3D%3D%20true%20%7C%7C%20renderTarget.stencilBuffer%20%3D%3D%3D%20true%3B%0A%20%20%20%20let%20textureNeedsUpdate%20%3D%20false%3B%0A%20%20%20%20if%20%28depthTexture%20%3D%3D%3D%20void%200%20%26%26%20useDepthTexture%29%20%7B%0A%20%20%20%20%20%20depthTexture%20%3D%20new%20DepthTexture2%28%29%3B%0A%20%20%20%20%20%20depthTexture.format%20%3D%20renderTarget.stencilBuffer%20%3F%20DepthStencilFormat2%20%3A%20DepthFormat2%3B%0A%20%20%20%20%20%20depthTexture.type%20%3D%20renderTarget.stencilBuffer%20%3F%20UnsignedInt248Type2%20%3A%20UnsignedIntType2%3B%0A%20%20%20%20%20%20depthTexture.image.width%20%3D%20mipWidth%3B%0A%20%20%20%20%20%20depthTexture.image.height%20%3D%20mipHeight%3B%0A%20%20%20%20%20%20depthTextureMips%5BactiveMipmapLevel%5D%20%3D%20depthTexture%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderTargetData.width%20%21%3D%3D%20size.width%20%7C%7C%20size.height%20%21%3D%3D%20renderTargetData.height%29%20%7B%0A%20%20%20%20%20%20textureNeedsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20if%20%28depthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20depthTexture.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20depthTexture.image.width%20%3D%20mipWidth%3B%0A%20%20%20%20%20%20%20%20depthTexture.image.height%20%3D%20mipHeight%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20renderTargetData.width%20%3D%20size.width%3B%0A%20%20%20%20renderTargetData.height%20%3D%20size.height%3B%0A%20%20%20%20renderTargetData.textures%20%3D%20textures%3B%0A%20%20%20%20renderTargetData.depthTexture%20%3D%20depthTexture%20%7C%7C%20null%3B%0A%20%20%20%20renderTargetData.depth%20%3D%20renderTarget.depthBuffer%3B%0A%20%20%20%20renderTargetData.stencil%20%3D%20renderTarget.stencilBuffer%3B%0A%20%20%20%20renderTargetData.renderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20if%20%28renderTargetData.sampleCount%20%21%3D%3D%20sampleCount%29%20%7B%0A%20%20%20%20%20%20textureNeedsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20if%20%28depthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20depthTexture.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20renderTargetData.sampleCount%20%3D%20sampleCount%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20options%20%3D%20%7B%20sampleCount%20%7D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20texture2%20%3D%20textures%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28textureNeedsUpdate%29%20texture2.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20this.updateTexture%28texture2%2C%20options%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28depthTexture%29%20%7B%0A%20%20%20%20%20%20this.updateTexture%28depthTexture%2C%20options%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderTargetData.initialized%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20renderTargetData.initialized%20%3D%20true%3B%0A%20%20%20%20%20%20const%20onDispose%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20renderTarget.removeEventListener%28%22dispose%22%2C%20onDispose%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._destroyTexture%28textures%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28depthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._destroyTexture%28depthTexture%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this.delete%28renderTarget%29%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20renderTarget.addEventListener%28%22dispose%22%2C%20onDispose%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateTexture%28texture2%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20const%20textureData%20%3D%20this.get%28texture2%29%3B%0A%20%20%20%20if%20%28textureData.initialized%20%3D%3D%3D%20true%20%26%26%20textureData.version%20%3D%3D%3D%20texture2.version%29%20return%3B%0A%20%20%20%20const%20isRenderTarget%20%3D%20texture2.isRenderTargetTexture%20%7C%7C%20texture2.isDepthTexture%20%7C%7C%20texture2.isFramebufferTexture%3B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20if%20%28isRenderTarget%20%26%26%20textureData.initialized%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20backend.destroySampler%28texture2%29%3B%0A%20%20%20%20%20%20backend.destroyTexture%28texture2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28texture2.isFramebufferTexture%29%20%7B%0A%20%20%20%20%20%20const%20renderTarget%20%3D%20this.renderer.getRenderTarget%28%29%3B%0A%20%20%20%20%20%20if%20%28renderTarget%29%20%7B%0A%20%20%20%20%20%20%20%20texture2.type%20%3D%20renderTarget.texture.type%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20texture2.type%20%3D%20UnsignedByteType2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20%7B%20width%2C%20height%2C%20depth%3A%20depth2%20%7D%20%3D%20this.getSize%28texture2%29%3B%0A%20%20%20%20options.width%20%3D%20width%3B%0A%20%20%20%20options.height%20%3D%20height%3B%0A%20%20%20%20options.depth%20%3D%20depth2%3B%0A%20%20%20%20options.needsMipmaps%20%3D%20this.needsMipmaps%28texture2%29%3B%0A%20%20%20%20options.levels%20%3D%20options.needsMipmaps%20%3F%20this.getMipLevels%28texture2%2C%20width%2C%20height%29%20%3A%201%3B%0A%20%20%20%20if%20%28isRenderTarget%20%7C%7C%20texture2.isStorageTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20backend.createSampler%28texture2%29%3B%0A%20%20%20%20%20%20backend.createTexture%28texture2%2C%20options%29%3B%0A%20%20%20%20%20%20textureData.generation%20%3D%20texture2.version%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20needsCreate%20%3D%20textureData.initialized%20%21%3D%3D%20true%3B%0A%20%20%20%20%20%20if%20%28needsCreate%29%20backend.createSampler%28texture2%29%3B%0A%20%20%20%20%20%20if%20%28texture2.version%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20image%20%3D%20texture2.image%3B%0A%20%20%20%20%20%20%20%20if%20%28image%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.Renderer%3A%20Texture%20marked%20for%20update%20but%20image%20is%20undefined.%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28image.complete%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.Renderer%3A%20Texture%20marked%20for%20update%20but%20image%20is%20incomplete.%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28texture2.images%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20images%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28const%20image2%20of%20texture2.images%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20images.push%28image2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20options.images%20%3D%20images%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20options.image%20%3D%20image%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28textureData.isDefaultTexture%20%3D%3D%3D%20void%200%20%7C%7C%20textureData.isDefaultTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20backend.createTexture%28texture2%2C%20options%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20textureData.isDefaultTexture%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20textureData.generation%20%3D%20texture2.version%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28texture2.source.dataReady%20%3D%3D%3D%20true%29%20backend.updateTexture%28texture2%2C%20options%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28options.needsMipmaps%20%26%26%20texture2.mipmaps.length%20%3D%3D%3D%200%29%20backend.generateMipmaps%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20backend.createDefaultTexture%28texture2%29%3B%0A%20%20%20%20%20%20%20%20textureData.isDefaultTexture%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20textureData.generation%20%3D%20texture2.version%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28textureData.initialized%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20textureData.initialized%20%3D%20true%3B%0A%20%20%20%20%20%20textureData.generation%20%3D%20texture2.version%3B%0A%20%20%20%20%20%20this.info.memory.textures%2B%2B%3B%0A%20%20%20%20%20%20const%20onDispose%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20texture2.removeEventListener%28%22dispose%22%2C%20onDispose%29%3B%0A%20%20%20%20%20%20%20%20this._destroyTexture%28texture2%29%3B%0A%20%20%20%20%20%20%20%20this.info.memory.textures--%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20texture2.addEventListener%28%22dispose%22%2C%20onDispose%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20textureData.version%20%3D%20texture2.version%3B%0A%20%20%7D%0A%20%20getSize%28texture2%2C%20target%20%3D%20_size%243%29%20%7B%0A%20%20%20%20let%20image%20%3D%20texture2.images%20%3F%20texture2.images%5B0%5D%20%3A%20texture2.image%3B%0A%20%20%20%20if%20%28image%29%20%7B%0A%20%20%20%20%20%20if%20%28image.image%20%21%3D%3D%20void%200%29%20image%20%3D%20image.image%3B%0A%20%20%20%20%20%20target.width%20%3D%20image.width%3B%0A%20%20%20%20%20%20target.height%20%3D%20image.height%3B%0A%20%20%20%20%20%20target.depth%20%3D%20texture2.isCubeTexture%20%3F%206%20%3A%20image.depth%20%7C%7C%201%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20target.width%20%3D%20target.height%20%3D%20target.depth%20%3D%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20getMipLevels%28texture2%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20let%20mipLevelCount%3B%0A%20%20%20%20if%20%28texture2.isCompressedTexture%29%20%7B%0A%20%20%20%20%20%20mipLevelCount%20%3D%20texture2.mipmaps.length%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20mipLevelCount%20%3D%20Math.floor%28Math.log2%28Math.max%28width%2C%20height%29%29%29%20%2B%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20mipLevelCount%3B%0A%20%20%7D%0A%20%20needsMipmaps%28texture2%29%20%7B%0A%20%20%20%20return%20this.isEnvironmentTexture%28texture2%29%20%7C%7C%20texture2.isCompressedTexture%20%3D%3D%3D%20true%20%7C%7C%20texture2.generateMipmaps%3B%0A%20%20%7D%0A%20%20isEnvironmentTexture%28texture2%29%20%7B%0A%20%20%20%20const%20mapping%20%3D%20texture2.mapping%3B%0A%20%20%20%20return%20mapping%20%3D%3D%3D%20EquirectangularReflectionMapping2%20%7C%7C%20mapping%20%3D%3D%3D%20EquirectangularRefractionMapping2%20%7C%7C%20%28mapping%20%3D%3D%3D%20CubeReflectionMapping2%20%7C%7C%20mapping%20%3D%3D%3D%20CubeRefractionMapping2%29%3B%0A%20%20%7D%0A%20%20_destroyTexture%28texture2%29%20%7B%0A%20%20%20%20this.backend.destroySampler%28texture2%29%3B%0A%20%20%20%20this.backend.destroyTexture%28texture2%29%3B%0A%20%20%20%20this.delete%28texture2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Color4%20%3D%20class%20extends%20Color2%20%7B%0A%20%20constructor%28r%2C%20g%2C%20b%2C%20a2%20%3D%201%29%20%7B%0A%20%20%20%20super%28r%2C%20g%2C%20b%29%3B%0A%20%20%20%20this.a%20%3D%20a2%3B%0A%20%20%7D%0A%20%20set%28r%2C%20g%2C%20b%2C%20a2%20%3D%201%29%20%7B%0A%20%20%20%20this.a%20%3D%20a2%3B%0A%20%20%20%20return%20super.set%28r%2C%20g%2C%20b%29%3B%0A%20%20%7D%0A%20%20copy%28color2%29%20%7B%0A%20%20%20%20if%20%28color2.a%20%21%3D%3D%20void%200%29%20this.a%20%3D%20color2.a%3B%0A%20%20%20%20return%20super.copy%28color2%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.r%2C%20this.g%2C%20this.b%2C%20this.a%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ParameterNode%20%3D%20class%20extends%20PropertyNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ParameterNode%22%3B%0A%20%20%7D%0A%20%20constructor%28nodeType%2C%20name%20%3D%20null%29%20%7B%0A%20%20%20%20super%28nodeType%2C%20name%29%3B%0A%20%20%20%20this.isParameterNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getHash%28%29%20%7B%0A%20%20%20%20return%20this.uuid%3B%0A%20%20%7D%0A%20%20generate%28%29%20%7B%0A%20%20%20%20return%20this.name%3B%0A%20%20%7D%0A%7D%3B%0Avar%20StackNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22StackNode%22%3B%0A%20%20%7D%0A%20%20constructor%28parent%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.nodes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.outputNode%20%3D%20null%3B%0A%20%20%20%20this.parent%20%3D%20parent%3B%0A%20%20%20%20this._currentCond%20%3D%20null%3B%0A%20%20%20%20this.isStackNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.outputNode%20%3F%20this.outputNode.getNodeType%28builder%29%20%3A%20%22void%22%3B%0A%20%20%7D%0A%20%20add%28node%29%20%7B%0A%20%20%20%20this.nodes.push%28node%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20If%28boolNode%2C%20method%29%20%7B%0A%20%20%20%20const%20methodNode%20%3D%20new%20ShaderNode%28method%29%3B%0A%20%20%20%20this._currentCond%20%3D%20select%28boolNode%2C%20methodNode%29%3B%0A%20%20%20%20return%20this.add%28this._currentCond%29%3B%0A%20%20%7D%0A%20%20ElseIf%28boolNode%2C%20method%29%20%7B%0A%20%20%20%20const%20methodNode%20%3D%20new%20ShaderNode%28method%29%3B%0A%20%20%20%20const%20ifNode%20%3D%20select%28boolNode%2C%20methodNode%29%3B%0A%20%20%20%20this._currentCond.elseNode%20%3D%20ifNode%3B%0A%20%20%20%20this._currentCond%20%3D%20ifNode%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20Else%28method%29%20%7B%0A%20%20%20%20this._currentCond.elseNode%20%3D%20new%20ShaderNode%28method%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20build%28builder%2C%20...params%29%20%7B%0A%20%20%20%20const%20previousStack%20%3D%20getCurrentStack%28%29%3B%0A%20%20%20%20setCurrentStack%28this%29%3B%0A%20%20%20%20for%20%28const%20node%20of%20this.nodes%29%20%7B%0A%20%20%20%20%20%20node.build%28builder%2C%20%22void%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20setCurrentStack%28previousStack%29%3B%0A%20%20%20%20return%20this.outputNode%20%3F%20this.outputNode.build%28builder%2C%20...params%29%20%3A%20super.build%28builder%2C%20...params%29%3B%0A%20%20%7D%0A%20%20%2F%2F%0A%20%20else%28...params%29%20%7B%0A%20%20%20%20console.warn%28%22TSL.StackNode%3A%20.else%28%29%20has%20been%20renamed%20to%20.Else%28%29.%22%29%3B%0A%20%20%20%20return%20this.Else%28...params%29%3B%0A%20%20%7D%0A%20%20elseif%28...params%29%20%7B%0A%20%20%20%20console.warn%28%22TSL.StackNode%3A%20.elseif%28%29%20has%20been%20renamed%20to%20.ElseIf%28%29.%22%29%3B%0A%20%20%20%20return%20this.ElseIf%28...params%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20stack%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28StackNode%29%3B%0Avar%20_reflectorPlane%20%3D%20new%20Plane2%28%29%3B%0Avar%20_normal%20%3D%20new%20Vector32%28%29%3B%0Avar%20_reflectorWorldPosition%20%3D%20new%20Vector32%28%29%3B%0Avar%20_cameraWorldPosition%20%3D%20new%20Vector32%28%29%3B%0Avar%20_rotationMatrix%20%3D%20new%20Matrix42%28%29%3B%0Avar%20_lookAtPosition%20%3D%20new%20Vector32%280%2C%200%2C%20-1%29%3B%0Avar%20clipPlane%20%3D%20new%20Vector42%28%29%3B%0Avar%20_view%20%3D%20new%20Vector32%28%29%3B%0Avar%20_target2%20%3D%20new%20Vector32%28%29%3B%0Avar%20_q%20%3D%20new%20Vector42%28%29%3B%0Avar%20_size%242%20%3D%20new%20Vector22%28%29%3B%0Avar%20_defaultRT%20%3D%20new%20RenderTarget2%28%29%3B%0Avar%20_defaultUV%20%3D%20screenUV.flipX%28%29%3B%0A_defaultRT.depthTexture%20%3D%20new%20DepthTexture2%281%2C%201%29%3B%0Avar%20_camera%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20OrthographicCamera2%28-1%2C%201%2C%201%2C%20-1%2C%200%2C%201%29%3B%0Avar%20QuadGeometry%20%3D%20class%20extends%20BufferGeometry2%20%7B%0A%20%20constructor%28flipY%20%3D%20false%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20const%20uv2%20%3D%20flipY%20%3D%3D%3D%20false%20%3F%20%5B0%2C%20-1%2C%200%2C%201%2C%202%2C%201%5D%20%3A%20%5B0%2C%202%2C%200%2C%200%2C%202%2C%200%5D%3B%0A%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute2%28%5B-1%2C%203%2C%200%2C%20-1%2C%20-1%2C%200%2C%203%2C%20-1%2C%200%5D%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22uv%22%2C%20new%20Float32BufferAttribute2%28uv2%2C%202%29%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_geometry%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20QuadGeometry%28%29%3B%0Avar%20QuadMesh%20%3D%20class%20extends%20Mesh2%20%7B%0A%20%20constructor%28material%20%3D%20null%29%20%7B%0A%20%20%20%20super%28_geometry%2C%20material%29%3B%0A%20%20%20%20this.camera%20%3D%20_camera%3B%0A%20%20%20%20this.isQuadMesh%20%3D%20true%3B%0A%20%20%7D%0A%20%20renderAsync%28renderer3%29%20%7B%0A%20%20%20%20return%20renderer3.renderAsync%28this%2C%20_camera%29%3B%0A%20%20%7D%0A%20%20render%28renderer3%29%20%7B%0A%20%20%20%20renderer3.render%28this%2C%20_camera%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_e12%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Euler2%28%29%3B%0Avar%20_m12%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20SceneNode%20%3D%20class%20_SceneNode%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22SceneNode%22%3B%0A%20%20%7D%0A%20%20constructor%28scope%20%3D%20_SceneNode.BACKGROUND_BLURRINESS%2C%20scene3%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.scope%20%3D%20scope%3B%0A%20%20%20%20this.scene%20%3D%20scene3%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20scope%20%3D%20this.scope%3B%0A%20%20%20%20const%20scene3%20%3D%20this.scene%20%21%3D%3D%20null%20%3F%20this.scene%20%3A%20builder.scene%3B%0A%20%20%20%20let%20output2%3B%0A%20%20%20%20if%20%28scope%20%3D%3D%3D%20_SceneNode.BACKGROUND_BLURRINESS%29%20%7B%0A%20%20%20%20%20%20output2%20%3D%20reference%28%22backgroundBlurriness%22%2C%20%22float%22%2C%20scene3%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_SceneNode.BACKGROUND_INTENSITY%29%20%7B%0A%20%20%20%20%20%20output2%20%3D%20reference%28%22backgroundIntensity%22%2C%20%22float%22%2C%20scene3%29%3B%0A%20%20%20%20%7D%20else%20if%20%28scope%20%3D%3D%3D%20_SceneNode.BACKGROUND_ROTATION%29%20%7B%0A%20%20%20%20%20%20output2%20%3D%20uniform%28%22mat4%22%29.label%28%22backgroundRotation%22%29.setGroup%28renderGroup%29.onRenderUpdate%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20background%20%3D%20scene3.background%3B%0A%20%20%20%20%20%20%20%20if%20%28background%20%21%3D%3D%20null%20%26%26%20background.isTexture%20%26%26%20background.mapping%20%21%3D%3D%20UVMapping2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_e12.copy%28scene3.backgroundRotation%29%3B%0A%20%20%20%20%20%20%20%20%20%20_e12.x%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20_e12.y%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20_e12.z%20%2A%3D%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20_m12.makeRotationFromEuler%28_e12%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20_m12.identity%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20_m12%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.SceneNode%3A%20Unknown%20scope%3A%22%2C%20scope%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%7D%3B%0ASceneNode.BACKGROUND_BLURRINESS%20%3D%20%22backgroundBlurriness%22%3B%0ASceneNode.BACKGROUND_INTENSITY%20%3D%20%22backgroundIntensity%22%3B%0ASceneNode.BACKGROUND_ROTATION%20%3D%20%22backgroundRotation%22%3B%0Avar%20backgroundBlurriness%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28SceneNode%2C%20SceneNode.BACKGROUND_BLURRINESS%29%3B%0Avar%20backgroundIntensity%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28SceneNode%2C%20SceneNode.BACKGROUND_INTENSITY%29%3B%0Avar%20backgroundRotation%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeImmutable%28SceneNode%2C%20SceneNode.BACKGROUND_ROTATION%29%3B%0Avar%20GPUPrimitiveTopology%20%3D%20%7B%0A%20%20PointList%3A%20%22point-list%22%2C%0A%20%20LineList%3A%20%22line-list%22%2C%0A%20%20LineStrip%3A%20%22line-strip%22%2C%0A%20%20TriangleList%3A%20%22triangle-list%22%2C%0A%20%20TriangleStrip%3A%20%22triangle-strip%22%0A%7D%3B%0Avar%20GPUCompareFunction%20%3D%20%7B%0A%20%20Never%3A%20%22never%22%2C%0A%20%20Less%3A%20%22less%22%2C%0A%20%20Equal%3A%20%22equal%22%2C%0A%20%20LessEqual%3A%20%22less-equal%22%2C%0A%20%20Greater%3A%20%22greater%22%2C%0A%20%20NotEqual%3A%20%22not-equal%22%2C%0A%20%20GreaterEqual%3A%20%22greater-equal%22%2C%0A%20%20Always%3A%20%22always%22%0A%7D%3B%0Avar%20GPUStoreOp%20%3D%20%7B%0A%20%20Store%3A%20%22store%22%2C%0A%20%20Discard%3A%20%22discard%22%0A%7D%3B%0Avar%20GPULoadOp%20%3D%20%7B%0A%20%20Load%3A%20%22load%22%2C%0A%20%20Clear%3A%20%22clear%22%0A%7D%3B%0Avar%20GPUFrontFace%20%3D%20%7B%0A%20%20CCW%3A%20%22ccw%22%2C%0A%20%20CW%3A%20%22cw%22%0A%7D%3B%0Avar%20GPUCullMode%20%3D%20%7B%0A%20%20None%3A%20%22none%22%2C%0A%20%20Front%3A%20%22front%22%2C%0A%20%20Back%3A%20%22back%22%0A%7D%3B%0Avar%20GPUIndexFormat%20%3D%20%7B%0A%20%20Uint16%3A%20%22uint16%22%2C%0A%20%20Uint32%3A%20%22uint32%22%0A%7D%3B%0Avar%20GPUTextureFormat%20%3D%20%7B%0A%20%20%2F%2F%208-bit%20formats%0A%20%20R8Unorm%3A%20%22r8unorm%22%2C%0A%20%20R8Snorm%3A%20%22r8snorm%22%2C%0A%20%20R8Uint%3A%20%22r8uint%22%2C%0A%20%20R8Sint%3A%20%22r8sint%22%2C%0A%20%20%2F%2F%2016-bit%20formats%0A%20%20R16Uint%3A%20%22r16uint%22%2C%0A%20%20R16Sint%3A%20%22r16sint%22%2C%0A%20%20R16Float%3A%20%22r16float%22%2C%0A%20%20RG8Unorm%3A%20%22rg8unorm%22%2C%0A%20%20RG8Snorm%3A%20%22rg8snorm%22%2C%0A%20%20RG8Uint%3A%20%22rg8uint%22%2C%0A%20%20RG8Sint%3A%20%22rg8sint%22%2C%0A%20%20%2F%2F%2032-bit%20formats%0A%20%20R32Uint%3A%20%22r32uint%22%2C%0A%20%20R32Sint%3A%20%22r32sint%22%2C%0A%20%20R32Float%3A%20%22r32float%22%2C%0A%20%20RG16Uint%3A%20%22rg16uint%22%2C%0A%20%20RG16Sint%3A%20%22rg16sint%22%2C%0A%20%20RG16Float%3A%20%22rg16float%22%2C%0A%20%20RGBA8Unorm%3A%20%22rgba8unorm%22%2C%0A%20%20RGBA8UnormSRGB%3A%20%22rgba8unorm-srgb%22%2C%0A%20%20RGBA8Snorm%3A%20%22rgba8snorm%22%2C%0A%20%20RGBA8Uint%3A%20%22rgba8uint%22%2C%0A%20%20RGBA8Sint%3A%20%22rgba8sint%22%2C%0A%20%20BGRA8Unorm%3A%20%22bgra8unorm%22%2C%0A%20%20BGRA8UnormSRGB%3A%20%22bgra8unorm-srgb%22%2C%0A%20%20%2F%2F%20Packed%2032-bit%20formats%0A%20%20RGB9E5UFloat%3A%20%22rgb9e5ufloat%22%2C%0A%20%20RGB10A2Unorm%3A%20%22rgb10a2unorm%22%2C%0A%20%20RG11B10uFloat%3A%20%22rgb10a2unorm%22%2C%0A%20%20%2F%2F%2064-bit%20formats%0A%20%20RG32Uint%3A%20%22rg32uint%22%2C%0A%20%20RG32Sint%3A%20%22rg32sint%22%2C%0A%20%20RG32Float%3A%20%22rg32float%22%2C%0A%20%20RGBA16Uint%3A%20%22rgba16uint%22%2C%0A%20%20RGBA16Sint%3A%20%22rgba16sint%22%2C%0A%20%20RGBA16Float%3A%20%22rgba16float%22%2C%0A%20%20%2F%2F%20128-bit%20formats%0A%20%20RGBA32Uint%3A%20%22rgba32uint%22%2C%0A%20%20RGBA32Sint%3A%20%22rgba32sint%22%2C%0A%20%20RGBA32Float%3A%20%22rgba32float%22%2C%0A%20%20%2F%2F%20Depth%20and%20stencil%20formats%0A%20%20Stencil8%3A%20%22stencil8%22%2C%0A%20%20Depth16Unorm%3A%20%22depth16unorm%22%2C%0A%20%20Depth24Plus%3A%20%22depth24plus%22%2C%0A%20%20Depth24PlusStencil8%3A%20%22depth24plus-stencil8%22%2C%0A%20%20Depth32Float%3A%20%22depth32float%22%2C%0A%20%20%2F%2F%20%27depth32float-stencil8%27%20extension%0A%20%20Depth32FloatStencil8%3A%20%22depth32float-stencil8%22%2C%0A%20%20%2F%2F%20BC%20compressed%20formats%20usable%20if%20%27texture-compression-bc%27%20is%20both%0A%20%20%2F%2F%20supported%20by%20the%20device%2Fuser%20agent%20and%20enabled%20in%20requestDevice.%0A%20%20BC1RGBAUnorm%3A%20%22bc1-rgba-unorm%22%2C%0A%20%20BC1RGBAUnormSRGB%3A%20%22bc1-rgba-unorm-srgb%22%2C%0A%20%20BC2RGBAUnorm%3A%20%22bc2-rgba-unorm%22%2C%0A%20%20BC2RGBAUnormSRGB%3A%20%22bc2-rgba-unorm-srgb%22%2C%0A%20%20BC3RGBAUnorm%3A%20%22bc3-rgba-unorm%22%2C%0A%20%20BC3RGBAUnormSRGB%3A%20%22bc3-rgba-unorm-srgb%22%2C%0A%20%20BC4RUnorm%3A%20%22bc4-r-unorm%22%2C%0A%20%20BC4RSnorm%3A%20%22bc4-r-snorm%22%2C%0A%20%20BC5RGUnorm%3A%20%22bc5-rg-unorm%22%2C%0A%20%20BC5RGSnorm%3A%20%22bc5-rg-snorm%22%2C%0A%20%20BC6HRGBUFloat%3A%20%22bc6h-rgb-ufloat%22%2C%0A%20%20BC6HRGBFloat%3A%20%22bc6h-rgb-float%22%2C%0A%20%20BC7RGBAUnorm%3A%20%22bc7-rgba-unorm%22%2C%0A%20%20BC7RGBAUnormSRGB%3A%20%22bc7-rgba-srgb%22%2C%0A%20%20%2F%2F%20ETC2%20compressed%20formats%20usable%20if%20%27texture-compression-etc2%27%20is%20both%0A%20%20%2F%2F%20supported%20by%20the%20device%2Fuser%20agent%20and%20enabled%20in%20requestDevice.%0A%20%20ETC2RGB8Unorm%3A%20%22etc2-rgb8unorm%22%2C%0A%20%20ETC2RGB8UnormSRGB%3A%20%22etc2-rgb8unorm-srgb%22%2C%0A%20%20ETC2RGB8A1Unorm%3A%20%22etc2-rgb8a1unorm%22%2C%0A%20%20ETC2RGB8A1UnormSRGB%3A%20%22etc2-rgb8a1unorm-srgb%22%2C%0A%20%20ETC2RGBA8Unorm%3A%20%22etc2-rgba8unorm%22%2C%0A%20%20ETC2RGBA8UnormSRGB%3A%20%22etc2-rgba8unorm-srgb%22%2C%0A%20%20EACR11Unorm%3A%20%22eac-r11unorm%22%2C%0A%20%20EACR11Snorm%3A%20%22eac-r11snorm%22%2C%0A%20%20EACRG11Unorm%3A%20%22eac-rg11unorm%22%2C%0A%20%20EACRG11Snorm%3A%20%22eac-rg11snorm%22%2C%0A%20%20%2F%2F%20ASTC%20compressed%20formats%20usable%20if%20%27texture-compression-astc%27%20is%20both%0A%20%20%2F%2F%20supported%20by%20the%20device%2Fuser%20agent%20and%20enabled%20in%20requestDevice.%0A%20%20ASTC4x4Unorm%3A%20%22astc-4x4-unorm%22%2C%0A%20%20ASTC4x4UnormSRGB%3A%20%22astc-4x4-unorm-srgb%22%2C%0A%20%20ASTC5x4Unorm%3A%20%22astc-5x4-unorm%22%2C%0A%20%20ASTC5x4UnormSRGB%3A%20%22astc-5x4-unorm-srgb%22%2C%0A%20%20ASTC5x5Unorm%3A%20%22astc-5x5-unorm%22%2C%0A%20%20ASTC5x5UnormSRGB%3A%20%22astc-5x5-unorm-srgb%22%2C%0A%20%20ASTC6x5Unorm%3A%20%22astc-6x5-unorm%22%2C%0A%20%20ASTC6x5UnormSRGB%3A%20%22astc-6x5-unorm-srgb%22%2C%0A%20%20ASTC6x6Unorm%3A%20%22astc-6x6-unorm%22%2C%0A%20%20ASTC6x6UnormSRGB%3A%20%22astc-6x6-unorm-srgb%22%2C%0A%20%20ASTC8x5Unorm%3A%20%22astc-8x5-unorm%22%2C%0A%20%20ASTC8x5UnormSRGB%3A%20%22astc-8x5-unorm-srgb%22%2C%0A%20%20ASTC8x6Unorm%3A%20%22astc-8x6-unorm%22%2C%0A%20%20ASTC8x6UnormSRGB%3A%20%22astc-8x6-unorm-srgb%22%2C%0A%20%20ASTC8x8Unorm%3A%20%22astc-8x8-unorm%22%2C%0A%20%20ASTC8x8UnormSRGB%3A%20%22astc-8x8-unorm-srgb%22%2C%0A%20%20ASTC10x5Unorm%3A%20%22astc-10x5-unorm%22%2C%0A%20%20ASTC10x5UnormSRGB%3A%20%22astc-10x5-unorm-srgb%22%2C%0A%20%20ASTC10x6Unorm%3A%20%22astc-10x6-unorm%22%2C%0A%20%20ASTC10x6UnormSRGB%3A%20%22astc-10x6-unorm-srgb%22%2C%0A%20%20ASTC10x8Unorm%3A%20%22astc-10x8-unorm%22%2C%0A%20%20ASTC10x8UnormSRGB%3A%20%22astc-10x8-unorm-srgb%22%2C%0A%20%20ASTC10x10Unorm%3A%20%22astc-10x10-unorm%22%2C%0A%20%20ASTC10x10UnormSRGB%3A%20%22astc-10x10-unorm-srgb%22%2C%0A%20%20ASTC12x10Unorm%3A%20%22astc-12x10-unorm%22%2C%0A%20%20ASTC12x10UnormSRGB%3A%20%22astc-12x10-unorm-srgb%22%2C%0A%20%20ASTC12x12Unorm%3A%20%22astc-12x12-unorm%22%2C%0A%20%20ASTC12x12UnormSRGB%3A%20%22astc-12x12-unorm-srgb%22%0A%7D%3B%0Avar%20GPUAddressMode%20%3D%20%7B%0A%20%20ClampToEdge%3A%20%22clamp-to-edge%22%2C%0A%20%20Repeat%3A%20%22repeat%22%2C%0A%20%20MirrorRepeat%3A%20%22mirror-repeat%22%0A%7D%3B%0Avar%20GPUFilterMode%20%3D%20%7B%0A%20%20Linear%3A%20%22linear%22%2C%0A%20%20Nearest%3A%20%22nearest%22%0A%7D%3B%0Avar%20GPUBlendFactor%20%3D%20%7B%0A%20%20Zero%3A%20%22zero%22%2C%0A%20%20One%3A%20%22one%22%2C%0A%20%20Src%3A%20%22src%22%2C%0A%20%20OneMinusSrc%3A%20%22one-minus-src%22%2C%0A%20%20SrcAlpha%3A%20%22src-alpha%22%2C%0A%20%20OneMinusSrcAlpha%3A%20%22one-minus-src-alpha%22%2C%0A%20%20Dst%3A%20%22dst%22%2C%0A%20%20OneMinusDstColor%3A%20%22one-minus-dst%22%2C%0A%20%20DstAlpha%3A%20%22dst-alpha%22%2C%0A%20%20OneMinusDstAlpha%3A%20%22one-minus-dst-alpha%22%2C%0A%20%20SrcAlphaSaturated%3A%20%22src-alpha-saturated%22%2C%0A%20%20Constant%3A%20%22constant%22%2C%0A%20%20OneMinusConstant%3A%20%22one-minus-constant%22%0A%7D%3B%0Avar%20GPUBlendOperation%20%3D%20%7B%0A%20%20Add%3A%20%22add%22%2C%0A%20%20Subtract%3A%20%22subtract%22%2C%0A%20%20ReverseSubtract%3A%20%22reverse-subtract%22%2C%0A%20%20Min%3A%20%22min%22%2C%0A%20%20Max%3A%20%22max%22%0A%7D%3B%0Avar%20GPUColorWriteFlags%20%3D%20%7B%0A%20%20None%3A%200%2C%0A%20%20Red%3A%201%2C%0A%20%20Green%3A%202%2C%0A%20%20Blue%3A%204%2C%0A%20%20Alpha%3A%208%2C%0A%20%20All%3A%2015%0A%7D%3B%0Avar%20GPUStencilOperation%20%3D%20%7B%0A%20%20Keep%3A%20%22keep%22%2C%0A%20%20Zero%3A%20%22zero%22%2C%0A%20%20Replace%3A%20%22replace%22%2C%0A%20%20Invert%3A%20%22invert%22%2C%0A%20%20IncrementClamp%3A%20%22increment-clamp%22%2C%0A%20%20DecrementClamp%3A%20%22decrement-clamp%22%2C%0A%20%20IncrementWrap%3A%20%22increment-wrap%22%2C%0A%20%20DecrementWrap%3A%20%22decrement-wrap%22%0A%7D%3B%0Avar%20GPUBufferBindingType%20%3D%20%7B%0A%20%20Uniform%3A%20%22uniform%22%2C%0A%20%20Storage%3A%20%22storage%22%2C%0A%20%20ReadOnlyStorage%3A%20%22read-only-storage%22%0A%7D%3B%0Avar%20GPUStorageTextureAccess%20%3D%20%7B%0A%20%20WriteOnly%3A%20%22write-only%22%2C%0A%20%20ReadOnly%3A%20%22read-only%22%2C%0A%20%20ReadWrite%3A%20%22read-write%22%0A%7D%3B%0Avar%20GPUTextureSampleType%20%3D%20%7B%0A%20%20Float%3A%20%22float%22%2C%0A%20%20UnfilterableFloat%3A%20%22unfilterable-float%22%2C%0A%20%20Depth%3A%20%22depth%22%2C%0A%20%20SInt%3A%20%22sint%22%2C%0A%20%20UInt%3A%20%22uint%22%0A%7D%3B%0Avar%20GPUTextureDimension%20%3D%20%7B%0A%20%20OneD%3A%20%221d%22%2C%0A%20%20TwoD%3A%20%222d%22%2C%0A%20%20ThreeD%3A%20%223d%22%0A%7D%3B%0Avar%20GPUTextureViewDimension%20%3D%20%7B%0A%20%20OneD%3A%20%221d%22%2C%0A%20%20TwoD%3A%20%222d%22%2C%0A%20%20TwoDArray%3A%20%222d-array%22%2C%0A%20%20Cube%3A%20%22cube%22%2C%0A%20%20CubeArray%3A%20%22cube-array%22%2C%0A%20%20ThreeD%3A%20%223d%22%0A%7D%3B%0Avar%20GPUTextureAspect%20%3D%20%7B%0A%20%20All%3A%20%22all%22%2C%0A%20%20StencilOnly%3A%20%22stencil-only%22%2C%0A%20%20DepthOnly%3A%20%22depth-only%22%0A%7D%3B%0Avar%20GPUInputStepMode%20%3D%20%7B%0A%20%20Vertex%3A%20%22vertex%22%2C%0A%20%20Instance%3A%20%22instance%22%0A%7D%3B%0Avar%20GPUFeatureName%20%3D%20%7B%0A%20%20DepthClipControl%3A%20%22depth-clip-control%22%2C%0A%20%20Depth32FloatStencil8%3A%20%22depth32float-stencil8%22%2C%0A%20%20TextureCompressionBC%3A%20%22texture-compression-bc%22%2C%0A%20%20TextureCompressionETC2%3A%20%22texture-compression-etc2%22%2C%0A%20%20TextureCompressionASTC%3A%20%22texture-compression-astc%22%2C%0A%20%20TimestampQuery%3A%20%22timestamp-query%22%2C%0A%20%20IndirectFirstInstance%3A%20%22indirect-first-instance%22%2C%0A%20%20ShaderF16%3A%20%22shader-f16%22%2C%0A%20%20RG11B10UFloat%3A%20%22rg11b10ufloat-renderable%22%2C%0A%20%20BGRA8UNormStorage%3A%20%22bgra8unorm-storage%22%2C%0A%20%20Float32Filterable%3A%20%22float32-filterable%22%2C%0A%20%20ClipDistances%3A%20%22clip-distances%22%2C%0A%20%20DualSourceBlending%3A%20%22dual-source-blending%22%2C%0A%20%20Subgroups%3A%20%22subgroups%22%0A%7D%3B%0Avar%20_size%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector22%28%29%3B%0Avar%20PassTextureNode%20%3D%20class%20extends%20TextureNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22PassTextureNode%22%3B%0A%20%20%7D%0A%20%20constructor%28passNode%2C%20texture2%29%20%7B%0A%20%20%20%20super%28texture2%29%3B%0A%20%20%20%20this.passNode%20%3D%20passNode%3B%0A%20%20%20%20this.setUpdateMatrix%28false%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20if%20%28builder.object.isQuadMesh%29%20this.passNode.build%28builder%29%3B%0A%20%20%20%20return%20super.setup%28builder%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.passNode%2C%20this.value%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20PassMultipleTextureNode%20%3D%20class%20extends%20PassTextureNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22PassMultipleTextureNode%22%3B%0A%20%20%7D%0A%20%20constructor%28passNode%2C%20textureName%2C%20previousTexture%20%3D%20false%29%20%7B%0A%20%20%20%20super%28passNode%2C%20null%29%3B%0A%20%20%20%20this.textureName%20%3D%20textureName%3B%0A%20%20%20%20this.previousTexture%20%3D%20previousTexture%3B%0A%20%20%7D%0A%20%20updateTexture%28%29%20%7B%0A%20%20%20%20this.value%20%3D%20this.previousTexture%20%3F%20this.passNode.getPreviousTexture%28this.textureName%29%20%3A%20this.passNode.getTexture%28this.textureName%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20this.updateTexture%28%29%3B%0A%20%20%20%20return%20super.setup%28builder%29%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20new%20this.constructor%28this.passNode%2C%20this.textureName%2C%20this.previousTexture%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20PassNode%20%3D%20class%20_PassNode%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22PassNode%22%3B%0A%20%20%7D%0A%20%20constructor%28scope%2C%20scene3%2C%20camera3%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28%22vec4%22%29%3B%0A%20%20%20%20this.scope%20%3D%20scope%3B%0A%20%20%20%20this.scene%20%3D%20scene3%3B%0A%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%20%20this.options%20%3D%20options%3B%0A%20%20%20%20this._pixelRatio%20%3D%201%3B%0A%20%20%20%20this._width%20%3D%201%3B%0A%20%20%20%20this._height%20%3D%201%3B%0A%20%20%20%20const%20depthTexture%20%3D%20new%20DepthTexture2%28%29%3B%0A%20%20%20%20depthTexture.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20depthTexture.name%20%3D%20%22depth%22%3B%0A%20%20%20%20const%20renderTarget%20%3D%20new%20RenderTarget2%28this._width%20%2A%20this._pixelRatio%2C%20this._height%20%2A%20this._pixelRatio%2C%20%7B%20type%3A%20HalfFloatType2%2C%20...options%20%7D%29%3B%0A%20%20%20%20renderTarget.texture.name%20%3D%20%22output%22%3B%0A%20%20%20%20renderTarget.depthTexture%20%3D%20depthTexture%3B%0A%20%20%20%20this.renderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20this.updateBeforeType%20%3D%20NodeUpdateType.FRAME%3B%0A%20%20%20%20this._textures%20%3D%20%7B%0A%20%20%20%20%20%20output%3A%20renderTarget.texture%2C%0A%20%20%20%20%20%20depth%3A%20depthTexture%0A%20%20%20%20%7D%3B%0A%20%20%20%20this._textureNodes%20%3D%20%7B%7D%3B%0A%20%20%20%20this._linearDepthNodes%20%3D%20%7B%7D%3B%0A%20%20%20%20this._viewZNodes%20%3D%20%7B%7D%3B%0A%20%20%20%20this._previousTextures%20%3D%20%7B%7D%3B%0A%20%20%20%20this._previousTextureNodes%20%3D%20%7B%7D%3B%0A%20%20%20%20this._cameraNear%20%3D%20uniform%280%29%3B%0A%20%20%20%20this._cameraFar%20%3D%20uniform%280%29%3B%0A%20%20%20%20this._mrt%20%3D%20null%3B%0A%20%20%20%20this.isPassNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20setMRT%28mrt%29%20%7B%0A%20%20%20%20this._mrt%20%3D%20mrt%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getMRT%28%29%20%7B%0A%20%20%20%20return%20this._mrt%3B%0A%20%20%7D%0A%20%20isGlobal%28%29%20%7B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20getTexture%28name%29%20%7B%0A%20%20%20%20let%20texture2%20%3D%20this._textures%5Bname%5D%3B%0A%20%20%20%20if%20%28texture2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20refTexture%20%3D%20this.renderTarget.texture%3B%0A%20%20%20%20%20%20texture2%20%3D%20refTexture.clone%28%29%3B%0A%20%20%20%20%20%20texture2.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20%20%20texture2.name%20%3D%20name%3B%0A%20%20%20%20%20%20this._textures%5Bname%5D%20%3D%20texture2%3B%0A%20%20%20%20%20%20this.renderTarget.textures.push%28texture2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20texture2%3B%0A%20%20%7D%0A%20%20getPreviousTexture%28name%29%20%7B%0A%20%20%20%20let%20texture2%20%3D%20this._previousTextures%5Bname%5D%3B%0A%20%20%20%20if%20%28texture2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20texture2%20%3D%20this.getTexture%28name%29.clone%28%29%3B%0A%20%20%20%20%20%20texture2.isRenderTargetTexture%20%3D%20true%3B%0A%20%20%20%20%20%20this._previousTextures%5Bname%5D%20%3D%20texture2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20texture2%3B%0A%20%20%7D%0A%20%20toggleTexture%28name%29%20%7B%0A%20%20%20%20const%20prevTexture%20%3D%20this._previousTextures%5Bname%5D%3B%0A%20%20%20%20if%20%28prevTexture%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20texture2%20%3D%20this._textures%5Bname%5D%3B%0A%20%20%20%20%20%20const%20index5%20%3D%20this.renderTarget.textures.indexOf%28texture2%29%3B%0A%20%20%20%20%20%20this.renderTarget.textures%5Bindex5%5D%20%3D%20prevTexture%3B%0A%20%20%20%20%20%20this._textures%5Bname%5D%20%3D%20prevTexture%3B%0A%20%20%20%20%20%20this._previousTextures%5Bname%5D%20%3D%20texture2%3B%0A%20%20%20%20%20%20this._textureNodes%5Bname%5D.updateTexture%28%29%3B%0A%20%20%20%20%20%20this._previousTextureNodes%5Bname%5D.updateTexture%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getTextureNode%28name%20%3D%20%22output%22%29%20%7B%0A%20%20%20%20let%20textureNode%20%3D%20this._textureNodes%5Bname%5D%3B%0A%20%20%20%20if%20%28textureNode%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20textureNode%20%3D%20nodeObject%28new%20PassMultipleTextureNode%28this%2C%20name%29%29%3B%0A%20%20%20%20%20%20textureNode.updateTexture%28%29%3B%0A%20%20%20%20%20%20this._textureNodes%5Bname%5D%20%3D%20textureNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20textureNode%3B%0A%20%20%7D%0A%20%20getPreviousTextureNode%28name%20%3D%20%22output%22%29%20%7B%0A%20%20%20%20let%20textureNode%20%3D%20this._previousTextureNodes%5Bname%5D%3B%0A%20%20%20%20if%20%28textureNode%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28this._textureNodes%5Bname%5D%20%3D%3D%3D%20void%200%29%20this.getTextureNode%28name%29%3B%0A%20%20%20%20%20%20textureNode%20%3D%20nodeObject%28new%20PassMultipleTextureNode%28this%2C%20name%2C%20true%29%29%3B%0A%20%20%20%20%20%20textureNode.updateTexture%28%29%3B%0A%20%20%20%20%20%20this._previousTextureNodes%5Bname%5D%20%3D%20textureNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20textureNode%3B%0A%20%20%7D%0A%20%20getViewZNode%28name%20%3D%20%22depth%22%29%20%7B%0A%20%20%20%20let%20viewZNode%20%3D%20this._viewZNodes%5Bname%5D%3B%0A%20%20%20%20if%20%28viewZNode%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20cameraNear2%20%3D%20this._cameraNear%3B%0A%20%20%20%20%20%20const%20cameraFar2%20%3D%20this._cameraFar%3B%0A%20%20%20%20%20%20this._viewZNodes%5Bname%5D%20%3D%20viewZNode%20%3D%20perspectiveDepthToViewZ%28this.getTextureNode%28name%29%2C%20cameraNear2%2C%20cameraFar2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20viewZNode%3B%0A%20%20%7D%0A%20%20getLinearDepthNode%28name%20%3D%20%22depth%22%29%20%7B%0A%20%20%20%20let%20linearDepthNode%20%3D%20this._linearDepthNodes%5Bname%5D%3B%0A%20%20%20%20if%20%28linearDepthNode%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20cameraNear2%20%3D%20this._cameraNear%3B%0A%20%20%20%20%20%20const%20cameraFar2%20%3D%20this._cameraFar%3B%0A%20%20%20%20%20%20const%20viewZNode%20%3D%20this.getViewZNode%28name%29%3B%0A%20%20%20%20%20%20this._linearDepthNodes%5Bname%5D%20%3D%20linearDepthNode%20%3D%20viewZToOrthographicDepth%28viewZNode%2C%20cameraNear2%2C%20cameraFar2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20linearDepthNode%3B%0A%20%20%7D%0A%20%20setup%28%7B%20renderer%3A%20renderer3%20%7D%29%20%7B%0A%20%20%20%20this.renderTarget.samples%20%3D%20this.options.samples%20%3D%3D%3D%20void%200%20%3F%20renderer3.samples%20%3A%20this.options.samples%3B%0A%20%20%20%20if%20%28renderer3.backend.isWebGLBackend%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.renderTarget.samples%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.renderTarget.depthTexture.isMultisampleRenderTargetTexture%20%3D%20this.renderTarget.samples%20%3E%201%3B%0A%20%20%20%20return%20this.scope%20%3D%3D%3D%20_PassNode.COLOR%20%3F%20this.getTextureNode%28%29%20%3A%20this.getLinearDepthNode%28%29%3B%0A%20%20%7D%0A%20%20updateBefore%28frame2%29%20%7B%0A%20%20%20%20const%20%7B%20renderer%3A%20renderer3%20%7D%20%3D%20frame2%3B%0A%20%20%20%20const%20%7B%20scene%3A%20scene3%2C%20camera%3A%20camera3%20%7D%20%3D%20this%3B%0A%20%20%20%20this._pixelRatio%20%3D%20renderer3.getPixelRatio%28%29%3B%0A%20%20%20%20const%20size%20%3D%20renderer3.getSize%28_size%29%3B%0A%20%20%20%20this.setSize%28size.width%2C%20size.height%29%3B%0A%20%20%20%20const%20currentRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20const%20currentMRT%20%3D%20renderer3.getMRT%28%29%3B%0A%20%20%20%20this._cameraNear.value%20%3D%20camera3.near%3B%0A%20%20%20%20this._cameraFar.value%20%3D%20camera3.far%3B%0A%20%20%20%20for%20%28const%20name%20in%20this._previousTextures%29%20%7B%0A%20%20%20%20%20%20this.toggleTexture%28name%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.setRenderTarget%28this.renderTarget%29%3B%0A%20%20%20%20renderer3.setMRT%28this._mrt%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20camera3%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28currentRenderTarget%29%3B%0A%20%20%20%20renderer3.setMRT%28currentMRT%29%3B%0A%20%20%7D%0A%20%20setSize%28width%2C%20height%29%20%7B%0A%20%20%20%20this._width%20%3D%20width%3B%0A%20%20%20%20this._height%20%3D%20height%3B%0A%20%20%20%20const%20effectiveWidth%20%3D%20this._width%20%2A%20this._pixelRatio%3B%0A%20%20%20%20const%20effectiveHeight%20%3D%20this._height%20%2A%20this._pixelRatio%3B%0A%20%20%20%20this.renderTarget.setSize%28effectiveWidth%2C%20effectiveHeight%29%3B%0A%20%20%7D%0A%20%20setPixelRatio%28pixelRatio%29%20%7B%0A%20%20%20%20this._pixelRatio%20%3D%20pixelRatio%3B%0A%20%20%20%20this.setSize%28this._width%2C%20this._height%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.renderTarget.dispose%28%29%3B%0A%20%20%7D%0A%7D%3B%0APassNode.COLOR%20%3D%20%22color%22%3B%0APassNode.DEPTH%20%3D%20%22depth%22%3B%0Avar%20linearToneMapping%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bcolor2%2C%20exposure%5D%29%20%3D%3E%20%7B%0A%20%20return%20color2.mul%28exposure%29.clamp%28%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22linearToneMapping%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22color%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22exposure%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20reinhardToneMapping%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bcolor2%2C%20exposure%5D%29%20%3D%3E%20%7B%0A%20%20color2%20%3D%20color2.mul%28exposure%29%3B%0A%20%20return%20color2.div%28color2.add%281%29%29.clamp%28%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22reinhardToneMapping%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22color%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22exposure%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20cineonToneMapping%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bcolor2%2C%20exposure%5D%29%20%3D%3E%20%7B%0A%20%20color2%20%3D%20color2.mul%28exposure%29%3B%0A%20%20color2%20%3D%20color2.sub%284e-3%29.max%280%29%3B%0A%20%20const%20a2%20%3D%20color2.mul%28color2.mul%286.2%29.add%280.5%29%29%3B%0A%20%20const%20b%20%3D%20color2.mul%28color2.mul%286.2%29.add%281.7%29%29.add%280.06%29%3B%0A%20%20return%20a2.div%28b%29.pow%282.2%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22cineonToneMapping%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22color%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22exposure%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20RRTAndODTFit%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bcolor2%5D%29%20%3D%3E%20%7B%0A%20%20const%20a2%20%3D%20color2.mul%28color2.add%280.0245786%29%29.sub%2890537e-9%29%3B%0A%20%20const%20b%20%3D%20color2.mul%28color2.add%280.432951%29.mul%280.983729%29%29.add%280.238081%29%3B%0A%20%20return%20a2.div%28b%29%3B%0A%7D%29%3B%0Avar%20acesFilmicToneMapping%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bcolor2%2C%20exposure%5D%29%20%3D%3E%20%7B%0A%20%20const%20ACESInputMat%20%3D%20mat3%28%0A%20%20%20%200.59719%2C%0A%20%20%20%200.35458%2C%0A%20%20%20%200.04823%2C%0A%20%20%20%200.076%2C%0A%20%20%20%200.90834%2C%0A%20%20%20%200.01566%2C%0A%20%20%20%200.0284%2C%0A%20%20%20%200.13383%2C%0A%20%20%20%200.83777%0A%20%20%29%3B%0A%20%20const%20ACESOutputMat%20%3D%20mat3%28%0A%20%20%20%201.60475%2C%0A%20%20%20%20-0.53108%2C%0A%20%20%20%20-0.07367%2C%0A%20%20%20%20-0.10208%2C%0A%20%20%20%201.10813%2C%0A%20%20%20%20-605e-5%2C%0A%20%20%20%20-327e-5%2C%0A%20%20%20%20-0.07276%2C%0A%20%20%20%201.07602%0A%20%20%29%3B%0A%20%20color2%20%3D%20color2.mul%28exposure%29.div%280.6%29%3B%0A%20%20color2%20%3D%20ACESInputMat.mul%28color2%29%3B%0A%20%20color2%20%3D%20RRTAndODTFit%28color2%29%3B%0A%20%20color2%20%3D%20ACESOutputMat.mul%28color2%29%3B%0A%20%20return%20color2.clamp%28%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22acesFilmicToneMapping%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22color%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22exposure%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20LINEAR_REC2020_TO_LINEAR_SRGB%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20mat3%28vec3%281.6605%2C%20-0.1246%2C%20-0.0182%29%2C%20vec3%28-0.5876%2C%201.1329%2C%20-0.1006%29%2C%20vec3%28-0.0728%2C%20-83e-4%2C%201.1187%29%29%3B%0Avar%20LINEAR_SRGB_TO_LINEAR_REC2020%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20mat3%28vec3%280.6274%2C%200.0691%2C%200.0164%29%2C%20vec3%280.3293%2C%200.9195%2C%200.088%29%2C%20vec3%280.0433%2C%200.0113%2C%200.8956%29%29%3B%0Avar%20agxDefaultContrastApprox%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bx_immutable%5D%29%20%3D%3E%20%7B%0A%20%20const%20x2%20%3D%20vec3%28x_immutable%29.toVar%28%29%3B%0A%20%20const%20x22%20%3D%20vec3%28x2.mul%28x2%29%29.toVar%28%29%3B%0A%20%20const%20x4%20%3D%20vec3%28x22.mul%28x22%29%29.toVar%28%29%3B%0A%20%20return%20float%2815.5%29.mul%28x4.mul%28x22%29%29.sub%28mul%2840.14%2C%20x4.mul%28x2%29%29%29.add%28mul%2831.96%2C%20x4%29.sub%28mul%286.868%2C%20x22.mul%28x2%29%29%29.add%28mul%280.4298%2C%20x22%29.add%28mul%280.1191%2C%20x2%29.sub%28232e-5%29%29%29%29%3B%0A%7D%29%3B%0Avar%20agxToneMapping%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bcolor2%2C%20exposure%5D%29%20%3D%3E%20%7B%0A%20%20const%20colortone%20%3D%20vec3%28color2%29.toVar%28%29%3B%0A%20%20const%20AgXInsetMatrix%20%3D%20mat3%28vec3%280.856627153315983%2C%200.137318972929847%2C%200.11189821299995%29%2C%20vec3%280.0951212405381588%2C%200.761241990602591%2C%200.0767994186031903%29%2C%20vec3%280.0482516061458583%2C%200.101439036467562%2C%200.811302368396859%29%29%3B%0A%20%20const%20AgXOutsetMatrix%20%3D%20mat3%28vec3%281.1271005818144368%2C%20-0.1413297634984383%2C%20-0.14132976349843826%29%2C%20vec3%28-0.11060664309660323%2C%201.157823702216272%2C%20-0.11060664309660294%29%2C%20vec3%28-0.016493938717834573%2C%20-0.016493938717834257%2C%201.2519364065950405%29%29%3B%0A%20%20const%20AgxMinEv%20%3D%20float%28-12.47393%29%3B%0A%20%20const%20AgxMaxEv%20%3D%20float%284.026069%29%3B%0A%20%20colortone.mulAssign%28exposure%29%3B%0A%20%20colortone.assign%28LINEAR_SRGB_TO_LINEAR_REC2020.mul%28colortone%29%29%3B%0A%20%20colortone.assign%28AgXInsetMatrix.mul%28colortone%29%29%3B%0A%20%20colortone.assign%28max%241%28colortone%2C%201e-10%29%29%3B%0A%20%20colortone.assign%28log2%28colortone%29%29%3B%0A%20%20colortone.assign%28colortone.sub%28AgxMinEv%29.div%28AgxMaxEv.sub%28AgxMinEv%29%29%29%3B%0A%20%20colortone.assign%28clamp2%28colortone%2C%200%2C%201%29%29%3B%0A%20%20colortone.assign%28agxDefaultContrastApprox%28colortone%29%29%3B%0A%20%20colortone.assign%28AgXOutsetMatrix.mul%28colortone%29%29%3B%0A%20%20colortone.assign%28pow%28max%241%28vec3%280%29%2C%20colortone%29%2C%20vec3%282.2%29%29%29%3B%0A%20%20colortone.assign%28LINEAR_REC2020_TO_LINEAR_SRGB.mul%28colortone%29%29%3B%0A%20%20colortone.assign%28clamp2%28colortone%2C%200%2C%201%29%29%3B%0A%20%20return%20colortone%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22agxToneMapping%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22color%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22exposure%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20neutralToneMapping%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bcolor2%2C%20exposure%5D%29%20%3D%3E%20%7B%0A%20%20const%20StartCompression%20%3D%20float%280.8%20-%200.04%29%3B%0A%20%20const%20Desaturation%20%3D%20float%280.15%29%3B%0A%20%20color2%20%3D%20color2.mul%28exposure%29%3B%0A%20%20const%20x2%20%3D%20min%241%28color2.r%2C%20min%241%28color2.g%2C%20color2.b%29%29%3B%0A%20%20const%20offset%20%3D%20select%28x2.lessThan%280.08%29%2C%20x2.sub%28mul%286.25%2C%20x2.mul%28x2%29%29%29%2C%200.04%29%3B%0A%20%20color2.subAssign%28offset%29%3B%0A%20%20const%20peak%20%3D%20max%241%28color2.r%2C%20max%241%28color2.g%2C%20color2.b%29%29%3B%0A%20%20If%28peak.lessThan%28StartCompression%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20return%20color2%3B%0A%20%20%7D%29%3B%0A%20%20const%20d%20%3D%20sub%281%2C%20StartCompression%29%3B%0A%20%20const%20newPeak%20%3D%20sub%281%2C%20d.mul%28d%29.div%28peak.add%28d.sub%28StartCompression%29%29%29%29%3B%0A%20%20color2.mulAssign%28newPeak.div%28peak%29%29%3B%0A%20%20const%20g%20%3D%20sub%281%2C%20div%281%2C%20Desaturation.mul%28peak.sub%28newPeak%29%29.add%281%29%29%29%3B%0A%20%20return%20mix%28color2%2C%20vec3%28newPeak%29%2C%20g%29%3B%0A%7D%29.setLayout%28%7B%0A%20%20name%3A%20%22neutralToneMapping%22%2C%0A%20%20type%3A%20%22vec3%22%2C%0A%20%20inputs%3A%20%5B%0A%20%20%20%20%7B%20name%3A%20%22color%22%2C%20type%3A%20%22vec3%22%20%7D%2C%0A%20%20%20%20%7B%20name%3A%20%22exposure%22%2C%20type%3A%20%22float%22%20%7D%0A%20%20%5D%0A%7D%29%3B%0Avar%20CodeNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22CodeNode%22%3B%0A%20%20%7D%0A%20%20constructor%28code%20%3D%20%22%22%2C%20includes%20%3D%20%5B%5D%2C%20language%20%3D%20%22%22%29%20%7B%0A%20%20%20%20super%28%22code%22%29%3B%0A%20%20%20%20this.isCodeNode%20%3D%20true%3B%0A%20%20%20%20this.code%20%3D%20code%3B%0A%20%20%20%20this.language%20%3D%20language%3B%0A%20%20%20%20this.includes%20%3D%20includes%3B%0A%20%20%7D%0A%20%20isGlobal%28%29%20%7B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20setIncludes%28includes%29%20%7B%0A%20%20%20%20this.includes%20%3D%20includes%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getIncludes%28%29%20%7B%0A%20%20%20%20return%20this.includes%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20includes%20%3D%20this.getIncludes%28builder%29%3B%0A%20%20%20%20for%20%28const%20include%20of%20includes%29%20%7B%0A%20%20%20%20%20%20include.build%28builder%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20nodeCode%20%3D%20builder.getCodeFromNode%28this%2C%20this.getNodeType%28builder%29%29%3B%0A%20%20%20%20nodeCode.code%20%3D%20this.code%3B%0A%20%20%20%20return%20nodeCode.code%3B%0A%20%20%7D%0A%20%20serialize%28data%29%20%7B%0A%20%20%20%20super.serialize%28data%29%3B%0A%20%20%20%20data.code%20%3D%20this.code%3B%0A%20%20%20%20data.language%20%3D%20this.language%3B%0A%20%20%7D%0A%20%20deserialize%28data%29%20%7B%0A%20%20%20%20super.deserialize%28data%29%3B%0A%20%20%20%20this.code%20%3D%20data.code%3B%0A%20%20%20%20this.language%20%3D%20data.language%3B%0A%20%20%7D%0A%7D%3B%0Avar%20FunctionNode%20%3D%20class%20extends%20CodeNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22FunctionNode%22%3B%0A%20%20%7D%0A%20%20constructor%28code%20%3D%20%22%22%2C%20includes%20%3D%20%5B%5D%2C%20language%20%3D%20%22%22%29%20%7B%0A%20%20%20%20super%28code%2C%20includes%2C%20language%29%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.getNodeFunction%28builder%29.type%3B%0A%20%20%7D%0A%20%20getInputs%28builder%29%20%7B%0A%20%20%20%20return%20this.getNodeFunction%28builder%29.inputs%3B%0A%20%20%7D%0A%20%20getNodeFunction%28builder%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20builder.getDataFromNode%28this%29%3B%0A%20%20%20%20let%20nodeFunction%20%3D%20nodeData.nodeFunction%3B%0A%20%20%20%20if%20%28nodeFunction%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20nodeFunction%20%3D%20builder.parser.parseFunction%28this.code%29%3B%0A%20%20%20%20%20%20nodeData.nodeFunction%20%3D%20nodeFunction%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeFunction%3B%0A%20%20%7D%0A%20%20generate%28builder%2C%20output2%29%20%7B%0A%20%20%20%20super.generate%28builder%29%3B%0A%20%20%20%20const%20nodeFunction%20%3D%20this.getNodeFunction%28builder%29%3B%0A%20%20%20%20const%20name%20%3D%20nodeFunction.name%3B%0A%20%20%20%20const%20type%20%3D%20nodeFunction.type%3B%0A%20%20%20%20const%20nodeCode%20%3D%20builder.getCodeFromNode%28this%2C%20type%29%3B%0A%20%20%20%20if%20%28name%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20nodeCode.name%20%3D%20name%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20propertyName%20%3D%20builder.getPropertyName%28nodeCode%29%3B%0A%20%20%20%20const%20code%20%3D%20this.getNodeFunction%28builder%29.getCode%28propertyName%29%3B%0A%20%20%20%20nodeCode.code%20%3D%20code%20%2B%20%22%5Cn%22%3B%0A%20%20%20%20if%20%28output2%20%3D%3D%3D%20%22property%22%29%20%7B%0A%20%20%20%20%20%20return%20propertyName%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20builder.format%28%60%24%7BpropertyName%7D%28%29%60%2C%20type%2C%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20Resources%20%3D%20class%20extends%20Map%20%7B%0A%20%20get%28key%2C%20callback%20%3D%20null%2C%20...params%29%20%7B%0A%20%20%20%20if%20%28this.has%28key%29%29%20return%20super.get%28key%29%3B%0A%20%20%20%20if%20%28callback%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20value%20%3D%20callback%28...params%29%3B%0A%20%20%20%20%20%20this.set%28key%2C%20value%29%3B%0A%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20ScriptableNodeResources%20%3D%20new%20Resources%28%29%3B%0Avar%20FogNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22FogNode%22%3B%0A%20%20%7D%0A%20%20constructor%28colorNode%2C%20factorNode%29%20%7B%0A%20%20%20%20super%28%22float%22%29%3B%0A%20%20%20%20this.isFogNode%20%3D%20true%3B%0A%20%20%20%20this.colorNode%20%3D%20colorNode%3B%0A%20%20%20%20this.factorNode%20%3D%20factorNode%3B%0A%20%20%7D%0A%20%20getViewZNode%28builder%29%20%7B%0A%20%20%20%20let%20viewZ%3B%0A%20%20%20%20const%20getViewZ%20%3D%20builder.context.getViewZ%3B%0A%20%20%20%20if%20%28getViewZ%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20viewZ%20%3D%20getViewZ%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%28viewZ%20%7C%7C%20positionView.z%29.negate%28%29%3B%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20return%20this.factorNode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20FogRangeNode%20%3D%20class%20extends%20FogNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22FogRangeNode%22%3B%0A%20%20%7D%0A%20%20constructor%28colorNode%2C%20nearNode%2C%20farNode%29%20%7B%0A%20%20%20%20super%28colorNode%29%3B%0A%20%20%20%20this.isFogRangeNode%20%3D%20true%3B%0A%20%20%20%20this.nearNode%20%3D%20nearNode%3B%0A%20%20%20%20this.farNode%20%3D%20farNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20viewZ%20%3D%20this.getViewZNode%28builder%29%3B%0A%20%20%20%20return%20smoothstep2%28this.nearNode%2C%20this.farNode%2C%20viewZ%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20rangeFog%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28FogRangeNode%29%3B%0Avar%20FogExp2Node%20%3D%20class%20extends%20FogNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22FogExp2Node%22%3B%0A%20%20%7D%0A%20%20constructor%28colorNode%2C%20densityNode%29%20%7B%0A%20%20%20%20super%28colorNode%29%3B%0A%20%20%20%20this.isFogExp2Node%20%3D%20true%3B%0A%20%20%20%20this.densityNode%20%3D%20densityNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20viewZ%20%3D%20this.getViewZNode%28builder%29%3B%0A%20%20%20%20const%20density%20%3D%20this.densityNode%3B%0A%20%20%20%20return%20density.mul%28density%2C%20viewZ%2C%20viewZ%29.negate%28%29.exp%28%29.oneMinus%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20densityFog%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20nodeProxy%28FogExp2Node%29%3B%0Avar%20BarrierNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20constructor%28scope%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.scope%20%3D%20scope%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20scope%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20renderer%3A%20renderer3%20%7D%20%3D%20builder%3B%0A%20%20%20%20if%20%28renderer3.backend.isWebGLBackend%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20builder.addFlowCode%28%60%09%2F%2F%20%24%7Bscope%7DBarrier%20%0A%60%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20builder.addLineFlowCode%28%60%24%7Bscope%7DBarrier%28%29%60%2C%20this%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20barrier%20%3D%20nodeProxy%28BarrierNode%29%3B%0Avar%20AtomicFunctionNode%20%3D%20class%20extends%20TempNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22AtomicFunctionNode%22%3B%0A%20%20%7D%0A%20%20constructor%28method%2C%20pointerNode%2C%20valueNode%2C%20storeNode%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%22uint%22%29%3B%0A%20%20%20%20this.method%20%3D%20method%3B%0A%20%20%20%20this.pointerNode%20%3D%20pointerNode%3B%0A%20%20%20%20this.valueNode%20%3D%20valueNode%3B%0A%20%20%20%20this.storeNode%20%3D%20storeNode%3B%0A%20%20%7D%0A%20%20getInputType%28builder%29%20%7B%0A%20%20%20%20return%20this.pointerNode.getNodeType%28builder%29%3B%0A%20%20%7D%0A%20%20getNodeType%28builder%29%20%7B%0A%20%20%20%20return%20this.getInputType%28builder%29%3B%0A%20%20%7D%0A%20%20generate%28builder%29%20%7B%0A%20%20%20%20const%20method%20%3D%20this.method%3B%0A%20%20%20%20const%20type%20%3D%20this.getNodeType%28builder%29%3B%0A%20%20%20%20const%20inputType%20%3D%20this.getInputType%28builder%29%3B%0A%20%20%20%20const%20a2%20%3D%20this.pointerNode%3B%0A%20%20%20%20const%20b%20%3D%20this.valueNode%3B%0A%20%20%20%20const%20params%20%3D%20%5B%5D%3B%0A%20%20%20%20params.push%28%60%26%24%7Ba2.build%28builder%2C%20inputType%29%7D%60%29%3B%0A%20%20%20%20params.push%28b.build%28builder%2C%20inputType%29%29%3B%0A%20%20%20%20const%20methodSnippet%20%3D%20%60%24%7Bbuilder.getMethod%28method%2C%20type%29%7D%28%20%24%7Bparams.join%28%22%2C%20%22%29%7D%20%29%60%3B%0A%20%20%20%20if%20%28this.storeNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20varSnippet%20%3D%20this.storeNode.build%28builder%2C%20inputType%29%3B%0A%20%20%20%20%20%20builder.addLineFlowCode%28%60%24%7BvarSnippet%7D%20%3D%20%24%7BmethodSnippet%7D%60%2C%20this%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20builder.addLineFlowCode%28methodSnippet%2C%20this%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0AAtomicFunctionNode.ATOMIC_LOAD%20%3D%20%22atomicLoad%22%3B%0AAtomicFunctionNode.ATOMIC_STORE%20%3D%20%22atomicStore%22%3B%0AAtomicFunctionNode.ATOMIC_ADD%20%3D%20%22atomicAdd%22%3B%0AAtomicFunctionNode.ATOMIC_SUB%20%3D%20%22atomicSub%22%3B%0AAtomicFunctionNode.ATOMIC_MAX%20%3D%20%22atomicMax%22%3B%0AAtomicFunctionNode.ATOMIC_MIN%20%3D%20%22atomicMin%22%3B%0AAtomicFunctionNode.ATOMIC_AND%20%3D%20%22atomicAnd%22%3B%0AAtomicFunctionNode.ATOMIC_OR%20%3D%20%22atomicOr%22%3B%0AAtomicFunctionNode.ATOMIC_XOR%20%3D%20%22atomicXor%22%3B%0Avar%20atomicNode%20%3D%20nodeProxy%28AtomicFunctionNode%29%3B%0Avar%20uniformsLib%3B%0Afunction%20getLightData%28light%29%20%7B%0A%20%20uniformsLib%20%3D%20uniformsLib%20%7C%7C%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20let%20uniforms%20%3D%20uniformsLib.get%28light%29%3B%0A%20%20if%20%28uniforms%20%3D%3D%3D%20void%200%29%20uniformsLib.set%28light%2C%20uniforms%20%3D%20%7B%7D%29%3B%0A%20%20return%20uniforms%3B%0A%7D%0Afunction%20lightPosition%28light%29%20%7B%0A%20%20const%20data%20%3D%20getLightData%28light%29%3B%0A%20%20return%20data.position%20%7C%7C%20%28data.position%20%3D%20uniform%28new%20Vector32%28%29%29.setGroup%28renderGroup%29.onRenderUpdate%28%28_%2C%20self2%29%20%3D%3E%20self2.value.setFromMatrixPosition%28light.matrixWorld%29%29%29%3B%0A%7D%0Afunction%20lightTargetPosition%28light%29%20%7B%0A%20%20const%20data%20%3D%20getLightData%28light%29%3B%0A%20%20return%20data.targetPosition%20%7C%7C%20%28data.targetPosition%20%3D%20uniform%28new%20Vector32%28%29%29.setGroup%28renderGroup%29.onRenderUpdate%28%28_%2C%20self2%29%20%3D%3E%20self2.value.setFromMatrixPosition%28light.target.matrixWorld%29%29%29%3B%0A%7D%0Afunction%20lightViewPosition%28light%29%20%7B%0A%20%20const%20data%20%3D%20getLightData%28light%29%3B%0A%20%20return%20data.viewPosition%20%7C%7C%20%28data.viewPosition%20%3D%20uniform%28new%20Vector32%28%29%29.setGroup%28renderGroup%29.onRenderUpdate%28%28%7B%20camera%3A%20camera3%20%7D%2C%20self2%29%20%3D%3E%20%7B%0A%20%20%20%20self2.value%20%3D%20self2.value%20%7C%7C%20new%20Vector32%28%29%3B%0A%20%20%20%20self2.value.setFromMatrixPosition%28light.matrixWorld%29%3B%0A%20%20%20%20self2.value.applyMatrix4%28camera3.matrixWorldInverse%29%3B%0A%20%20%7D%29%29%3B%0A%7D%0Avar%20lightTargetDirection%20%3D%20%28light%29%20%3D%3E%20cameraViewMatrix.transformDirection%28lightPosition%28light%29.sub%28lightTargetPosition%28light%29%29%29%3B%0Avar%20sortLights%20%3D%20%28lights%29%20%3D%3E%20%7B%0A%20%20return%20lights.sort%28%28a2%2C%20b%29%20%3D%3E%20a2.id%20-%20b.id%29%3B%0A%7D%3B%0Avar%20getLightNodeById%20%3D%20%28id2%2C%20lightNodes%29%20%3D%3E%20%7B%0A%20%20for%20%28const%20lightNode%20of%20lightNodes%29%20%7B%0A%20%20%20%20if%20%28lightNode.isAnalyticLightNode%20%26%26%20lightNode.light.id%20%3D%3D%3D%20id2%29%20%7B%0A%20%20%20%20%20%20return%20lightNode%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20null%3B%0A%7D%3B%0Avar%20_lightsNodeRef%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Avar%20LightsNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LightsNode%22%3B%0A%20%20%7D%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%22vec3%22%29%3B%0A%20%20%20%20this.totalDiffuseNode%20%3D%20vec3%28%29.toVar%28%22totalDiffuse%22%29%3B%0A%20%20%20%20this.totalSpecularNode%20%3D%20vec3%28%29.toVar%28%22totalSpecular%22%29%3B%0A%20%20%20%20this.outgoingLightNode%20%3D%20vec3%28%29.toVar%28%22outgoingLight%22%29%3B%0A%20%20%20%20this._lights%20%3D%20%5B%5D%3B%0A%20%20%20%20this._lightNodes%20%3D%20null%3B%0A%20%20%20%20this._lightNodesHash%20%3D%20null%3B%0A%20%20%20%20this.global%20%3D%20true%3B%0A%20%20%7D%0A%20%20getHash%28builder%29%20%7B%0A%20%20%20%20if%20%28this._lightNodesHash%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28this._lightNodes%20%3D%3D%3D%20null%29%20this.setupLightsNode%28builder%29%3B%0A%20%20%20%20%20%20const%20hash%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28const%20lightNode%20of%20this._lightNodes%29%20%7B%0A%20%20%20%20%20%20%20%20hash.push%28lightNode.getSelf%28%29.getHash%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._lightNodesHash%20%3D%20%22lights-%22%20%2B%20hash.join%28%22%2C%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this._lightNodesHash%3B%0A%20%20%7D%0A%20%20analyze%28builder%29%20%7B%0A%20%20%20%20const%20properties%20%3D%20builder.getDataFromNode%28this%29%3B%0A%20%20%20%20for%20%28const%20node%20of%20properties.nodes%29%20%7B%0A%20%20%20%20%20%20node.build%28builder%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setupLightsNode%28builder%29%20%7B%0A%20%20%20%20const%20lightNodes%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20previousLightNodes%20%3D%20this._lightNodes%3B%0A%20%20%20%20const%20lights%20%3D%20sortLights%28this._lights%29%3B%0A%20%20%20%20const%20nodeLibrary%20%3D%20builder.renderer.library%3B%0A%20%20%20%20for%20%28const%20light%20of%20lights%29%20%7B%0A%20%20%20%20%20%20if%20%28light.isNode%29%20%7B%0A%20%20%20%20%20%20%20%20lightNodes.push%28nodeObject%28light%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20let%20lightNode%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20if%20%28previousLightNodes%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20lightNode%20%3D%20getLightNodeById%28light.id%2C%20previousLightNodes%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28lightNode%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20lightNodeClass%20%3D%20nodeLibrary.getLightNodeClass%28light.constructor%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28lightNodeClass%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn%28%60LightsNode.setupNodeLights%3A%20Light%20node%20not%20found%20for%20%24%7Blight.constructor.name%7D%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20let%20lightNode2%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21_lightsNodeRef.has%28light%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20lightNode2%20%3D%20nodeObject%28new%20lightNodeClass%28light%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_lightsNodeRef.set%28light%2C%20lightNode2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20lightNode2%20%3D%20_lightsNodeRef.get%28light%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20lightNodes.push%28lightNode2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this._lightNodes%20%3D%20lightNodes%3B%0A%20%20%7D%0A%20%20setupLights%28builder%2C%20lightNodes%29%20%7B%0A%20%20%20%20for%20%28const%20lightNode%20of%20lightNodes%29%20%7B%0A%20%20%20%20%20%20lightNode.build%28builder%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20if%20%28this._lightNodes%20%3D%3D%3D%20null%29%20this.setupLightsNode%28builder%29%3B%0A%20%20%20%20const%20context2%20%3D%20builder.context%3B%0A%20%20%20%20const%20lightingModel%20%3D%20context2.lightingModel%3B%0A%20%20%20%20let%20outgoingLightNode%20%3D%20this.outgoingLightNode%3B%0A%20%20%20%20if%20%28lightingModel%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20_lightNodes%2C%20totalDiffuseNode%2C%20totalSpecularNode%20%7D%20%3D%20this%3B%0A%20%20%20%20%20%20context2.outgoingLight%20%3D%20outgoingLightNode%3B%0A%20%20%20%20%20%20const%20stack2%20%3D%20builder.addStack%28%29%3B%0A%20%20%20%20%20%20const%20properties%20%3D%20builder.getDataFromNode%28this%29%3B%0A%20%20%20%20%20%20properties.nodes%20%3D%20stack2.nodes%3B%0A%20%20%20%20%20%20lightingModel.start%28context2%2C%20stack2%2C%20builder%29%3B%0A%20%20%20%20%20%20this.setupLights%28builder%2C%20_lightNodes%29%3B%0A%20%20%20%20%20%20lightingModel.indirect%28context2%2C%20stack2%2C%20builder%29%3B%0A%20%20%20%20%20%20const%20%7B%20backdrop%2C%20backdropAlpha%20%7D%20%3D%20context2%3B%0A%20%20%20%20%20%20const%20%7B%20directDiffuse%2C%20directSpecular%2C%20indirectDiffuse%2C%20indirectSpecular%20%7D%20%3D%20context2.reflectedLight%3B%0A%20%20%20%20%20%20let%20totalDiffuse%20%3D%20directDiffuse.add%28indirectDiffuse%29%3B%0A%20%20%20%20%20%20if%20%28backdrop%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28backdropAlpha%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20totalDiffuse%20%3D%20vec3%28backdropAlpha.mix%28totalDiffuse%2C%20backdrop%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20totalDiffuse%20%3D%20vec3%28backdrop%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20context2.material.transparent%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20totalDiffuseNode.assign%28totalDiffuse%29%3B%0A%20%20%20%20%20%20totalSpecularNode.assign%28directSpecular.add%28indirectSpecular%29%29%3B%0A%20%20%20%20%20%20outgoingLightNode.assign%28totalDiffuseNode.add%28totalSpecularNode%29%29%3B%0A%20%20%20%20%20%20lightingModel.finish%28context2%2C%20stack2%2C%20builder%29%3B%0A%20%20%20%20%20%20outgoingLightNode%20%3D%20outgoingLightNode.bypass%28builder.removeStack%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20outgoingLightNode%3B%0A%20%20%7D%0A%20%20setLights%28lights%29%20%7B%0A%20%20%20%20this._lights%20%3D%20lights%3B%0A%20%20%20%20this._lightNodes%20%3D%20null%3B%0A%20%20%20%20this._lightNodesHash%20%3D%20null%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getLights%28%29%20%7B%0A%20%20%20%20return%20this._lights%3B%0A%20%20%7D%0A%20%20get%20hasLights%28%29%20%7B%0A%20%20%20%20return%20this._lights.length%20%3E%200%3B%0A%20%20%7D%0A%7D%3B%0Avar%20BasicShadowMap%20%3D%20Fn%28%28%7B%20depthTexture%2C%20shadowCoord%20%7D%29%20%3D%3E%20%7B%0A%20%20return%20texture%28depthTexture%2C%20shadowCoord.xy%29.compare%28shadowCoord.z%29%3B%0A%7D%29%3B%0Avar%20PCFShadowMap2%20%3D%20Fn%28%28%7B%20depthTexture%2C%20shadowCoord%2C%20shadow%3A%20shadow2%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20depthCompare%20%3D%20%28uv2%2C%20compare%29%20%3D%3E%20texture%28depthTexture%2C%20uv2%29.compare%28compare%29%3B%0A%20%20const%20mapSize%20%3D%20reference%28%22mapSize%22%2C%20%22vec2%22%2C%20shadow2%29.setGroup%28renderGroup%29%3B%0A%20%20const%20radius%20%3D%20reference%28%22radius%22%2C%20%22float%22%2C%20shadow2%29.setGroup%28renderGroup%29%3B%0A%20%20const%20texelSize%20%3D%20vec2%281%29.div%28mapSize%29%3B%0A%20%20const%20dx0%20%3D%20texelSize.x.negate%28%29.mul%28radius%29%3B%0A%20%20const%20dy0%20%3D%20texelSize.y.negate%28%29.mul%28radius%29%3B%0A%20%20const%20dx1%20%3D%20texelSize.x.mul%28radius%29%3B%0A%20%20const%20dy1%20%3D%20texelSize.y.mul%28radius%29%3B%0A%20%20const%20dx2%20%3D%20dx0.div%282%29%3B%0A%20%20const%20dy2%20%3D%20dy0.div%282%29%3B%0A%20%20const%20dx3%20%3D%20dx1.div%282%29%3B%0A%20%20const%20dy3%20%3D%20dy1.div%282%29%3B%0A%20%20return%20add4%28%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx0%2C%20dy0%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%280%2C%20dy0%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx1%2C%20dy0%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx2%2C%20dy2%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%280%2C%20dy2%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx3%2C%20dy2%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx0%2C%200%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx2%2C%200%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx3%2C%200%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx1%2C%200%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx2%2C%20dy3%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%280%2C%20dy3%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx3%2C%20dy3%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx0%2C%20dy1%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%280%2C%20dy1%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28shadowCoord.xy.add%28vec2%28dx1%2C%20dy1%29%29%2C%20shadowCoord.z%29%0A%20%20%29.mul%281%20%2F%2017%29%3B%0A%7D%29%3B%0Avar%20PCFSoftShadowMap2%20%3D%20Fn%28%28%7B%20depthTexture%2C%20shadowCoord%2C%20shadow%3A%20shadow2%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20depthCompare%20%3D%20%28uv3%2C%20compare%29%20%3D%3E%20texture%28depthTexture%2C%20uv3%29.compare%28compare%29%3B%0A%20%20const%20mapSize%20%3D%20reference%28%22mapSize%22%2C%20%22vec2%22%2C%20shadow2%29.setGroup%28renderGroup%29%3B%0A%20%20const%20texelSize%20%3D%20vec2%281%29.div%28mapSize%29%3B%0A%20%20const%20dx%20%3D%20texelSize.x%3B%0A%20%20const%20dy%20%3D%20texelSize.y%3B%0A%20%20const%20uv2%20%3D%20shadowCoord.xy%3B%0A%20%20const%20f%20%3D%20fract%28uv2.mul%28mapSize%29.add%280.5%29%29%3B%0A%20%20uv2.subAssign%28f.mul%28texelSize%29%29%3B%0A%20%20return%20add4%28%0A%20%20%20%20depthCompare%28uv2%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28uv2.add%28vec2%28dx%2C%200%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28uv2.add%28vec2%280%2C%20dy%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20depthCompare%28uv2.add%28texelSize%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20mix%28%0A%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx.negate%28%29%2C%200%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx.mul%282%29%2C%200%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20f.x%0A%20%20%20%20%29%2C%0A%20%20%20%20mix%28%0A%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx.negate%28%29%2C%20dy%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx.mul%282%29%2C%20dy%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20f.x%0A%20%20%20%20%29%2C%0A%20%20%20%20mix%28%0A%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%280%2C%20dy.negate%28%29%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%280%2C%20dy.mul%282%29%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20f.y%0A%20%20%20%20%29%2C%0A%20%20%20%20mix%28%0A%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx%2C%20dy.negate%28%29%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx%2C%20dy.mul%282%29%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20f.y%0A%20%20%20%20%29%2C%0A%20%20%20%20mix%28%0A%20%20%20%20%20%20mix%28%0A%20%20%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx.negate%28%29%2C%20dy.negate%28%29%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx.mul%282%29%2C%20dy.negate%28%29%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20%20%20f.x%0A%20%20%20%20%20%20%29%2C%0A%20%20%20%20%20%20mix%28%0A%20%20%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx.negate%28%29%2C%20dy.mul%282%29%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20%20%20depthCompare%28uv2.add%28vec2%28dx.mul%282%29%2C%20dy.mul%282%29%29%29%2C%20shadowCoord.z%29%2C%0A%20%20%20%20%20%20%20%20f.x%0A%20%20%20%20%20%20%29%2C%0A%20%20%20%20%20%20f.y%0A%20%20%20%20%29%0A%20%20%29.mul%281%20%2F%209%29%3B%0A%7D%29%3B%0Avar%20VSMShadowMapNode%20%3D%20Fn%28%28%7B%20depthTexture%2C%20shadowCoord%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20occlusion%20%3D%20float%281%29.toVar%28%29%3B%0A%20%20const%20distribution%20%3D%20texture%28depthTexture%29.uv%28shadowCoord.xy%29.rg%3B%0A%20%20const%20hardShadow%20%3D%20step%28shadowCoord.z%2C%20distribution.x%29%3B%0A%20%20If%28hardShadow.notEqual%28float%281%29%29%2C%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20const%20distance2%20%3D%20shadowCoord.z.sub%28distribution.x%29%3B%0A%20%20%20%20const%20variance%20%3D%20max%241%280%2C%20distribution.y.mul%28distribution.y%29%29%3B%0A%20%20%20%20let%20softnessProbability%20%3D%20variance.div%28variance.add%28distance2.mul%28distance2%29%29%29%3B%0A%20%20%20%20softnessProbability%20%3D%20clamp2%28sub%28softnessProbability%2C%200.3%29.div%280.95%20-%200.3%29%29%3B%0A%20%20%20%20occlusion.assign%28clamp2%28max%241%28hardShadow%2C%20softnessProbability%29%29%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20occlusion%3B%0A%7D%29%3B%0Avar%20VSMPassVertical%20%3D%20Fn%28%28%7B%20samples%2C%20radius%2C%20size%2C%20shadowPass%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20mean%20%3D%20float%280%29.toVar%28%29%3B%0A%20%20const%20squaredMean%20%3D%20float%280%29.toVar%28%29%3B%0A%20%20const%20uvStride%20%3D%20samples.lessThanEqual%28float%281%29%29.select%28float%280%29%2C%20float%282%29.div%28samples.sub%281%29%29%29%3B%0A%20%20const%20uvStart%20%3D%20samples.lessThanEqual%28float%281%29%29.select%28float%280%29%2C%20float%28-1%29%29%3B%0A%20%20Loop%28%7B%20start%3A%20int%280%29%2C%20end%3A%20int%28samples%29%2C%20type%3A%20%22int%22%2C%20condition%3A%20%22%3C%22%20%7D%2C%20%28%7B%20i%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20const%20uvOffset%20%3D%20uvStart.add%28float%28i%29.mul%28uvStride%29%29%3B%0A%20%20%20%20const%20depth2%20%3D%20shadowPass.uv%28add4%28screenCoordinate.xy%2C%20vec2%280%2C%20uvOffset%29.mul%28radius%29%29.div%28size%29%29.x%3B%0A%20%20%20%20mean.addAssign%28depth2%29%3B%0A%20%20%20%20squaredMean.addAssign%28depth2.mul%28depth2%29%29%3B%0A%20%20%7D%29%3B%0A%20%20mean.divAssign%28samples%29%3B%0A%20%20squaredMean.divAssign%28samples%29%3B%0A%20%20const%20std_dev%20%3D%20sqrt%28squaredMean.sub%28mean.mul%28mean%29%29%29%3B%0A%20%20return%20vec2%28mean%2C%20std_dev%29%3B%0A%7D%29%3B%0Avar%20VSMPassHorizontal%20%3D%20Fn%28%28%7B%20samples%2C%20radius%2C%20size%2C%20shadowPass%20%7D%29%20%3D%3E%20%7B%0A%20%20const%20mean%20%3D%20float%280%29.toVar%28%29%3B%0A%20%20const%20squaredMean%20%3D%20float%280%29.toVar%28%29%3B%0A%20%20const%20uvStride%20%3D%20samples.lessThanEqual%28float%281%29%29.select%28float%280%29%2C%20float%282%29.div%28samples.sub%281%29%29%29%3B%0A%20%20const%20uvStart%20%3D%20samples.lessThanEqual%28float%281%29%29.select%28float%280%29%2C%20float%28-1%29%29%3B%0A%20%20Loop%28%7B%20start%3A%20int%280%29%2C%20end%3A%20int%28samples%29%2C%20type%3A%20%22int%22%2C%20condition%3A%20%22%3C%22%20%7D%2C%20%28%7B%20i%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20const%20uvOffset%20%3D%20uvStart.add%28float%28i%29.mul%28uvStride%29%29%3B%0A%20%20%20%20const%20distribution%20%3D%20shadowPass.uv%28add4%28screenCoordinate.xy%2C%20vec2%28uvOffset%2C%200%29.mul%28radius%29%29.div%28size%29%29%3B%0A%20%20%20%20mean.addAssign%28distribution.x%29%3B%0A%20%20%20%20squaredMean.addAssign%28add4%28distribution.y.mul%28distribution.y%29%2C%20distribution.x.mul%28distribution.x%29%29%29%3B%0A%20%20%7D%29%3B%0A%20%20mean.divAssign%28samples%29%3B%0A%20%20squaredMean.divAssign%28samples%29%3B%0A%20%20const%20std_dev%20%3D%20sqrt%28squaredMean.sub%28mean.mul%28mean%29%29%29%3B%0A%20%20return%20vec2%28mean%2C%20std_dev%29%3B%0A%7D%29%3B%0Avar%20_shadowFilterLib%20%3D%20%5BBasicShadowMap%2C%20PCFShadowMap2%2C%20PCFSoftShadowMap2%2C%20VSMShadowMapNode%5D%3B%0Avar%20_overrideMaterial%20%3D%20null%3B%0Avar%20_quadMesh%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20QuadMesh%28%29%3B%0Avar%20ShadowNode%20%3D%20class%20extends%20Node%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22ShadowNode%22%3B%0A%20%20%7D%0A%20%20constructor%28light%2C%20shadow2%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.light%20%3D%20light%3B%0A%20%20%20%20this.shadow%20%3D%20shadow2%20%7C%7C%20light.shadow%3B%0A%20%20%20%20this.shadowMap%20%3D%20null%3B%0A%20%20%20%20this.vsmShadowMapVertical%20%3D%20null%3B%0A%20%20%20%20this.vsmShadowMapHorizontal%20%3D%20null%3B%0A%20%20%20%20this.vsmMaterialVertical%20%3D%20null%3B%0A%20%20%20%20this.vsmMaterialHorizontal%20%3D%20null%3B%0A%20%20%20%20this.updateBeforeType%20%3D%20NodeUpdateType.RENDER%3B%0A%20%20%20%20this._node%20%3D%20null%3B%0A%20%20%20%20this.isShadowNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20setupShadow%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20renderer%3A%20renderer3%20%7D%20%3D%20builder%3B%0A%20%20%20%20if%20%28_overrideMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20_overrideMaterial%20%3D%20new%20NodeMaterial%28%29%3B%0A%20%20%20%20%20%20_overrideMaterial.fragmentNode%20%3D%20vec4%280%2C%200%2C%200%2C%201%29%3B%0A%20%20%20%20%20%20_overrideMaterial.isShadowNodeMaterial%20%3D%20true%3B%0A%20%20%20%20%20%20_overrideMaterial.name%20%3D%20%22ShadowMaterial%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20shadow2%20%3D%20this.shadow%3B%0A%20%20%20%20const%20shadowMapType%20%3D%20renderer3.shadowMap.type%3B%0A%20%20%20%20const%20depthTexture%20%3D%20new%20DepthTexture2%28shadow2.mapSize.width%2C%20shadow2.mapSize.height%29%3B%0A%20%20%20%20depthTexture.compareFunction%20%3D%20LessCompare2%3B%0A%20%20%20%20const%20shadowMap%20%3D%20builder.createRenderTarget%28shadow2.mapSize.width%2C%20shadow2.mapSize.height%29%3B%0A%20%20%20%20shadowMap.depthTexture%20%3D%20depthTexture%3B%0A%20%20%20%20shadow2.camera.updateProjectionMatrix%28%29%3B%0A%20%20%20%20if%20%28shadowMapType%20%3D%3D%3D%20VSMShadowMap2%29%20%7B%0A%20%20%20%20%20%20depthTexture.compareFunction%20%3D%20null%3B%0A%20%20%20%20%20%20this.vsmShadowMapVertical%20%3D%20builder.createRenderTarget%28shadow2.mapSize.width%2C%20shadow2.mapSize.height%2C%20%7B%20format%3A%20RGFormat2%2C%20type%3A%20HalfFloatType2%20%7D%29%3B%0A%20%20%20%20%20%20this.vsmShadowMapHorizontal%20%3D%20builder.createRenderTarget%28shadow2.mapSize.width%2C%20shadow2.mapSize.height%2C%20%7B%20format%3A%20RGFormat2%2C%20type%3A%20HalfFloatType2%20%7D%29%3B%0A%20%20%20%20%20%20const%20shadowPassVertical%20%3D%20texture%28depthTexture%29%3B%0A%20%20%20%20%20%20const%20shadowPassHorizontal%20%3D%20texture%28this.vsmShadowMapVertical.texture%29%3B%0A%20%20%20%20%20%20const%20samples%20%3D%20reference%28%22blurSamples%22%2C%20%22float%22%2C%20shadow2%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20%20%20const%20radius%20%3D%20reference%28%22radius%22%2C%20%22float%22%2C%20shadow2%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20%20%20const%20size%20%3D%20reference%28%22mapSize%22%2C%20%22vec2%22%2C%20shadow2%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20%20%20let%20material%20%3D%20this.vsmMaterialVertical%20%7C%7C%20%28this.vsmMaterialVertical%20%3D%20new%20NodeMaterial%28%29%29%3B%0A%20%20%20%20%20%20material.fragmentNode%20%3D%20VSMPassVertical%28%7B%20samples%2C%20radius%2C%20size%2C%20shadowPass%3A%20shadowPassVertical%20%7D%29.context%28builder.getSharedContext%28%29%29%3B%0A%20%20%20%20%20%20material.name%20%3D%20%22VSMVertical%22%3B%0A%20%20%20%20%20%20material%20%3D%20this.vsmMaterialHorizontal%20%7C%7C%20%28this.vsmMaterialHorizontal%20%3D%20new%20NodeMaterial%28%29%29%3B%0A%20%20%20%20%20%20material.fragmentNode%20%3D%20VSMPassHorizontal%28%7B%20samples%2C%20radius%2C%20size%2C%20shadowPass%3A%20shadowPassHorizontal%20%7D%29.context%28builder.getSharedContext%28%29%29%3B%0A%20%20%20%20%20%20material.name%20%3D%20%22VSMHorizontal%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20shadowIntensity%20%3D%20reference%28%22intensity%22%2C%20%22float%22%2C%20shadow2%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20const%20bias%20%3D%20reference%28%22bias%22%2C%20%22float%22%2C%20shadow2%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20const%20normalBias%20%3D%20reference%28%22normalBias%22%2C%20%22float%22%2C%20shadow2%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20const%20position%20%3D%20object.material.shadowPositionNode%20%7C%7C%20positionWorld%3B%0A%20%20%20%20let%20shadowCoord%20%3D%20uniform%28shadow2.matrix%29.setGroup%28renderGroup%29.mul%28position.add%28transformedNormalWorld.mul%28normalBias%29%29%29%3B%0A%20%20%20%20let%20coordZ%3B%0A%20%20%20%20if%20%28shadow2.camera.isOrthographicCamera%20%7C%7C%20renderer3.logarithmicDepthBuffer%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20shadowCoord%20%3D%20shadowCoord.xyz.div%28shadowCoord.w%29%3B%0A%20%20%20%20%20%20coordZ%20%3D%20shadowCoord.z%3B%0A%20%20%20%20%20%20if%20%28renderer3.coordinateSystem%20%3D%3D%3D%20WebGPUCoordinateSystem2%29%20%7B%0A%20%20%20%20%20%20%20%20coordZ%20%3D%20coordZ.mul%282%29.sub%281%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20w%20%3D%20shadowCoord.w%3B%0A%20%20%20%20%20%20shadowCoord%20%3D%20shadowCoord.xy.div%28w%29%3B%0A%20%20%20%20%20%20const%20cameraNearLocal%20%3D%20uniform%28%22float%22%29.onRenderUpdate%28%28%29%20%3D%3E%20shadow2.camera.near%29%3B%0A%20%20%20%20%20%20const%20cameraFarLocal%20%3D%20uniform%28%22float%22%29.onRenderUpdate%28%28%29%20%3D%3E%20shadow2.camera.far%29%3B%0A%20%20%20%20%20%20coordZ%20%3D%20perspectiveDepthToLogarithmicDepth%28w%2C%20cameraNearLocal%2C%20cameraFarLocal%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20shadowCoord%20%3D%20vec3%28%0A%20%20%20%20%20%20shadowCoord.x%2C%0A%20%20%20%20%20%20shadowCoord.y.oneMinus%28%29%2C%0A%20%20%20%20%20%20%2F%2F%20follow%20webgpu%20standards%0A%20%20%20%20%20%20coordZ.add%28bias%29%0A%20%20%20%20%29%3B%0A%20%20%20%20const%20frustumTest%20%3D%20shadowCoord.x.greaterThanEqual%280%29.and%28shadowCoord.x.lessThanEqual%281%29%29.and%28shadowCoord.y.greaterThanEqual%280%29%29.and%28shadowCoord.y.lessThanEqual%281%29%29.and%28shadowCoord.z.lessThanEqual%281%29%29%3B%0A%20%20%20%20const%20filterFn%20%3D%20shadow2.filterNode%20%7C%7C%20_shadowFilterLib%5Brenderer3.shadowMap.type%5D%20%7C%7C%20null%3B%0A%20%20%20%20if%20%28filterFn%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGPURenderer%3A%20Shadow%20map%20type%20not%20supported%20yet.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20shadowColor%20%3D%20texture%28shadowMap.texture%2C%20shadowCoord%29%3B%0A%20%20%20%20const%20shadowNode%20%3D%20frustumTest.select%28filterFn%28%7B%20depthTexture%3A%20shadowMapType%20%3D%3D%3D%20VSMShadowMap2%20%3F%20this.vsmShadowMapHorizontal.texture%20%3A%20depthTexture%2C%20shadowCoord%2C%20shadow%3A%20shadow2%20%7D%29%2C%20float%281%29%29%3B%0A%20%20%20%20this.shadowMap%20%3D%20shadowMap%3B%0A%20%20%20%20this.shadow.map%20%3D%20shadowMap%3B%0A%20%20%20%20return%20mix%281%2C%20shadowNode.rgb.mix%28shadowColor%2C%201%29%2C%20shadowIntensity.mul%28shadowColor.a%29%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20if%20%28builder.renderer.shadowMap.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20return%20this._node%20%21%3D%3D%20null%20%3F%20this._node%20%3A%20this._node%20%3D%20this.setupShadow%28builder%29%3B%0A%20%20%7D%0A%20%20updateShadow%28frame2%29%20%7B%0A%20%20%20%20const%20%7B%20shadowMap%2C%20light%2C%20shadow%3A%20shadow2%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20renderer%3A%20renderer3%2C%20scene%3A%20scene3%2C%20camera%3A%20camera3%20%7D%20%3D%20frame2%3B%0A%20%20%20%20const%20shadowType%20%3D%20renderer3.shadowMap.type%3B%0A%20%20%20%20const%20depthVersion%20%3D%20shadowMap.depthTexture.version%3B%0A%20%20%20%20this._depthVersionCached%20%3D%20depthVersion%3B%0A%20%20%20%20const%20currentOverrideMaterial%20%3D%20scene3.overrideMaterial%3B%0A%20%20%20%20scene3.overrideMaterial%20%3D%20_overrideMaterial%3B%0A%20%20%20%20shadowMap.setSize%28shadow2.mapSize.width%2C%20shadow2.mapSize.height%29%3B%0A%20%20%20%20shadow2.updateMatrices%28light%29%3B%0A%20%20%20%20shadow2.camera.layers.mask%20%3D%20camera3.layers.mask%3B%0A%20%20%20%20const%20currentRenderTarget%20%3D%20renderer3.getRenderTarget%28%29%3B%0A%20%20%20%20const%20currentRenderObjectFunction%20%3D%20renderer3.getRenderObjectFunction%28%29%3B%0A%20%20%20%20renderer3.setRenderObjectFunction%28%28object%2C%20...params%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20if%20%28object.castShadow%20%3D%3D%3D%20true%20%7C%7C%20object.receiveShadow%20%26%26%20shadowType%20%3D%3D%3D%20VSMShadowMap2%29%20%7B%0A%20%20%20%20%20%20%20%20renderer3.renderObject%28object%2C%20...params%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28shadowMap%29%3B%0A%20%20%20%20renderer3.render%28scene3%2C%20shadow2.camera%29%3B%0A%20%20%20%20renderer3.setRenderObjectFunction%28currentRenderObjectFunction%29%3B%0A%20%20%20%20if%20%28light.isPointLight%20%21%3D%3D%20true%20%26%26%20shadowType%20%3D%3D%3D%20VSMShadowMap2%29%20%7B%0A%20%20%20%20%20%20this.vsmPass%28renderer3%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.setRenderTarget%28currentRenderTarget%29%3B%0A%20%20%20%20scene3.overrideMaterial%20%3D%20currentOverrideMaterial%3B%0A%20%20%7D%0A%20%20vsmPass%28renderer3%29%20%7B%0A%20%20%20%20const%20%7B%20shadow%3A%20shadow2%20%7D%20%3D%20this%3B%0A%20%20%20%20this.vsmShadowMapVertical.setSize%28shadow2.mapSize.width%2C%20shadow2.mapSize.height%29%3B%0A%20%20%20%20this.vsmShadowMapHorizontal.setSize%28shadow2.mapSize.width%2C%20shadow2.mapSize.height%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28this.vsmShadowMapVertical%29%3B%0A%20%20%20%20_quadMesh%241.material%20%3D%20this.vsmMaterialVertical%3B%0A%20%20%20%20_quadMesh%241.render%28renderer3%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28this.vsmShadowMapHorizontal%29%3B%0A%20%20%20%20_quadMesh%241.material%20%3D%20this.vsmMaterialHorizontal%3B%0A%20%20%20%20_quadMesh%241.render%28renderer3%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.shadowMap.dispose%28%29%3B%0A%20%20%20%20this.shadowMap%20%3D%20null%3B%0A%20%20%20%20if%20%28this.vsmShadowMapVertical%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.vsmShadowMapVertical.dispose%28%29%3B%0A%20%20%20%20%20%20this.vsmShadowMapVertical%20%3D%20null%3B%0A%20%20%20%20%20%20this.vsmMaterialVertical.dispose%28%29%3B%0A%20%20%20%20%20%20this.vsmMaterialVertical%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.vsmShadowMapHorizontal%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.vsmShadowMapHorizontal.dispose%28%29%3B%0A%20%20%20%20%20%20this.vsmShadowMapHorizontal%20%3D%20null%3B%0A%20%20%20%20%20%20this.vsmMaterialHorizontal.dispose%28%29%3B%0A%20%20%20%20%20%20this.vsmMaterialHorizontal%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.updateBeforeType%20%3D%20NodeUpdateType.NONE%3B%0A%20%20%7D%0A%20%20updateBefore%28frame2%29%20%7B%0A%20%20%20%20const%20%7B%20shadow%3A%20shadow2%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20needsUpdate%20%3D%20shadow2.needsUpdate%20%7C%7C%20shadow2.autoUpdate%3B%0A%20%20%20%20if%20%28needsUpdate%29%20%7B%0A%20%20%20%20%20%20this.updateShadow%28frame2%29%3B%0A%20%20%20%20%20%20if%20%28this.shadowMap.depthTexture.version%20%3D%3D%3D%20this._depthVersionCached%29%20%7B%0A%20%20%20%20%20%20%20%20shadow2.needsUpdate%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20shadow%20%3D%20%28light%2C%20shadow2%29%20%3D%3E%20nodeObject%28new%20ShadowNode%28light%2C%20shadow2%29%29%3B%0Avar%20AnalyticLightNode%20%3D%20class%20extends%20LightingNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22AnalyticLightNode%22%3B%0A%20%20%7D%0A%20%20constructor%28light%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.FRAME%3B%0A%20%20%20%20this.light%20%3D%20light%3B%0A%20%20%20%20this.color%20%3D%20new%20Color2%28%29%3B%0A%20%20%20%20this.colorNode%20%3D%20uniform%28this.color%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20this.baseColorNode%20%3D%20null%3B%0A%20%20%20%20this.shadowNode%20%3D%20null%3B%0A%20%20%20%20this.shadowColorNode%20%3D%20null%3B%0A%20%20%20%20this.isAnalyticLightNode%20%3D%20true%3B%0A%20%20%7D%0A%20%20getCacheKey%28%29%20%7B%0A%20%20%20%20return%20hash%241%28super.getCacheKey%28%29%2C%20this.light.id%2C%20this.light.castShadow%20%3F%201%20%3A%200%29%3B%0A%20%20%7D%0A%20%20getHash%28%29%20%7B%0A%20%20%20%20return%20this.light.uuid%3B%0A%20%20%7D%0A%20%20setupShadow%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20renderer%3A%20renderer3%20%7D%20%3D%20builder%3B%0A%20%20%20%20if%20%28renderer3.shadowMap.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20let%20shadowColorNode%20%3D%20this.shadowColorNode%3B%0A%20%20%20%20if%20%28shadowColorNode%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20customShadowNode%20%3D%20this.light.shadow.shadowNode%3B%0A%20%20%20%20%20%20let%20shadowNode%3B%0A%20%20%20%20%20%20if%20%28customShadowNode%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20shadowNode%20%3D%20nodeObject%28customShadowNode%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20shadowNode%20%3D%20shadow%28this.light%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.shadowNode%20%3D%20shadowNode%3B%0A%20%20%20%20%20%20this.shadowColorNode%20%3D%20shadowColorNode%20%3D%20this.colorNode.mul%28shadowNode%29%3B%0A%20%20%20%20%20%20this.baseColorNode%20%3D%20this.colorNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.colorNode%20%3D%20shadowColorNode%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20this.colorNode%20%3D%20this.baseColorNode%20%7C%7C%20this.colorNode%3B%0A%20%20%20%20if%20%28this.light.castShadow%29%20%7B%0A%20%20%20%20%20%20if%20%28builder.object.receiveShadow%29%20%7B%0A%20%20%20%20%20%20%20%20this.setupShadow%28builder%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28this.shadowNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.shadowNode.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20const%20%7B%20light%20%7D%20%3D%20this%3B%0A%20%20%20%20this.color.copy%28light.color%29.multiplyScalar%28light.intensity%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20getDistanceAttenuation%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28inputs%29%20%3D%3E%20%7B%0A%20%20const%20%7B%20lightDistance%2C%20cutoffDistance%2C%20decayExponent%20%7D%20%3D%20inputs%3B%0A%20%20const%20distanceFalloff%20%3D%20lightDistance.pow%28decayExponent%29.max%280.01%29.reciprocal%28%29%3B%0A%20%20return%20cutoffDistance.greaterThan%280%29.select%28%0A%20%20%20%20distanceFalloff.mul%28lightDistance.div%28cutoffDistance%29.pow4%28%29.oneMinus%28%29.clamp%28%29.pow2%28%29%29%2C%0A%20%20%20%20distanceFalloff%0A%20%20%29%3B%0A%7D%29%3B%0Avar%20directPointLight%20%3D%20Fn%28%28%7B%20color%3A%20color2%2C%20lightViewPosition%3A%20lightViewPosition2%2C%20cutoffDistance%2C%20decayExponent%20%7D%2C%20builder%29%20%3D%3E%20%7B%0A%20%20const%20lightingModel%20%3D%20builder.context.lightingModel%3B%0A%20%20const%20lVector%20%3D%20lightViewPosition2.sub%28positionView%29%3B%0A%20%20const%20lightDirection%20%3D%20lVector.normalize%28%29%3B%0A%20%20const%20lightDistance%20%3D%20lVector.length%28%29%3B%0A%20%20const%20lightAttenuation%20%3D%20getDistanceAttenuation%28%7B%0A%20%20%20%20lightDistance%2C%0A%20%20%20%20cutoffDistance%2C%0A%20%20%20%20decayExponent%0A%20%20%7D%29%3B%0A%20%20const%20lightColor%20%3D%20color2.mul%28lightAttenuation%29%3B%0A%20%20const%20reflectedLight%20%3D%20builder.context.reflectedLight%3B%0A%20%20lightingModel.direct%28%7B%0A%20%20%20%20lightDirection%2C%0A%20%20%20%20lightColor%2C%0A%20%20%20%20reflectedLight%0A%20%20%7D%2C%20builder.stack%2C%20builder%29%3B%0A%7D%29%3B%0Avar%20PointLightNode%20%3D%20class%20extends%20AnalyticLightNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22PointLightNode%22%3B%0A%20%20%7D%0A%20%20constructor%28light%20%3D%20null%29%20%7B%0A%20%20%20%20super%28light%29%3B%0A%20%20%20%20this.cutoffDistanceNode%20%3D%20uniform%280%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20this.decayExponentNode%20%3D%20uniform%280%29.setGroup%28renderGroup%29%3B%0A%20%20%7D%0A%20%20update%28frame2%29%20%7B%0A%20%20%20%20const%20%7B%20light%20%7D%20%3D%20this%3B%0A%20%20%20%20super.update%28frame2%29%3B%0A%20%20%20%20this.cutoffDistanceNode.value%20%3D%20light.distance%3B%0A%20%20%20%20this.decayExponentNode.value%20%3D%20light.decay%3B%0A%20%20%7D%0A%20%20setup%28%29%20%7B%0A%20%20%20%20directPointLight%28%7B%0A%20%20%20%20%20%20color%3A%20this.colorNode%2C%0A%20%20%20%20%20%20lightViewPosition%3A%20lightViewPosition%28this.light%29%2C%0A%20%20%20%20%20%20cutoffDistance%3A%20this.cutoffDistanceNode%2C%0A%20%20%20%20%20%20decayExponent%3A%20this.decayExponentNode%0A%20%20%20%20%7D%29.append%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20getShIrradianceAt%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20Fn%28%28%5Bnormal2%2C%20shCoefficients%5D%29%20%3D%3E%20%7B%0A%20%20const%20x2%20%3D%20normal2.x%2C%20y2%20%3D%20normal2.y%2C%20z2%20%3D%20normal2.z%3B%0A%20%20let%20result%20%3D%20shCoefficients.element%280%29.mul%280.886227%29%3B%0A%20%20result%20%3D%20result.add%28shCoefficients.element%281%29.mul%282%20%2A%200.511664%29.mul%28y2%29%29%3B%0A%20%20result%20%3D%20result.add%28shCoefficients.element%282%29.mul%282%20%2A%200.511664%29.mul%28z2%29%29%3B%0A%20%20result%20%3D%20result.add%28shCoefficients.element%283%29.mul%282%20%2A%200.511664%29.mul%28x2%29%29%3B%0A%20%20result%20%3D%20result.add%28shCoefficients.element%284%29.mul%282%20%2A%200.429043%29.mul%28x2%29.mul%28y2%29%29%3B%0A%20%20result%20%3D%20result.add%28shCoefficients.element%285%29.mul%282%20%2A%200.429043%29.mul%28y2%29.mul%28z2%29%29%3B%0A%20%20result%20%3D%20result.add%28shCoefficients.element%286%29.mul%28z2.mul%28z2%29.mul%280.743125%29.sub%280.247708%29%29%29%3B%0A%20%20result%20%3D%20result.add%28shCoefficients.element%287%29.mul%282%20%2A%200.429043%29.mul%28x2%29.mul%28z2%29%29%3B%0A%20%20result%20%3D%20result.add%28shCoefficients.element%288%29.mul%280.429043%29.mul%28mul%28x2%2C%20x2%29.sub%28mul%28y2%2C%20y2%29%29%29%29%3B%0A%20%20return%20result%3B%0A%7D%29%3B%0Avar%20_clearColor%241%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color4%28%29%3B%0Avar%20Background%20%3D%20class%20extends%20DataMap%20%7B%0A%20%20constructor%28renderer3%2C%20nodes%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.renderer%20%3D%20renderer3%3B%0A%20%20%20%20this.nodes%20%3D%20nodes%3B%0A%20%20%7D%0A%20%20update%28scene3%2C%20renderList%2C%20renderContext%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this.renderer%3B%0A%20%20%20%20const%20background%20%3D%20this.nodes.getBackgroundNode%28scene3%29%20%7C%7C%20scene3.background%3B%0A%20%20%20%20let%20forceClear%20%3D%20false%3B%0A%20%20%20%20if%20%28background%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20renderer3._clearColor.getRGB%28_clearColor%241%2C%20LinearSRGBColorSpace2%29%3B%0A%20%20%20%20%20%20_clearColor%241.a%20%3D%20renderer3._clearColor.a%3B%0A%20%20%20%20%7D%20else%20if%20%28background.isColor%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20background.getRGB%28_clearColor%241%2C%20LinearSRGBColorSpace2%29%3B%0A%20%20%20%20%20%20_clearColor%241.a%20%3D%201%3B%0A%20%20%20%20%20%20forceClear%20%3D%20true%3B%0A%20%20%20%20%7D%20else%20if%20%28background.isNode%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20sceneData%20%3D%20this.get%28scene3%29%3B%0A%20%20%20%20%20%20const%20backgroundNode%20%3D%20background%3B%0A%20%20%20%20%20%20_clearColor%241.copy%28renderer3._clearColor%29%3B%0A%20%20%20%20%20%20let%20backgroundMesh%20%3D%20sceneData.backgroundMesh%3B%0A%20%20%20%20%20%20if%20%28backgroundMesh%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20backgroundMeshNode%20%3D%20context%28vec4%28backgroundNode%29.mul%28backgroundIntensity%29%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%2F%2F%20%40TODO%3A%20Add%20Texture2D%20support%20using%20node%20context%0A%20%20%20%20%20%20%20%20%20%20getUV%3A%20%28%29%20%3D%3E%20backgroundRotation.mul%28normalWorld%29%2C%0A%20%20%20%20%20%20%20%20%20%20getTextureLevel%3A%20%28%29%20%3D%3E%20backgroundBlurriness%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20let%20viewProj%20%3D%20modelViewProjection%28%29%3B%0A%20%20%20%20%20%20%20%20viewProj%20%3D%20viewProj.setZ%28viewProj.w%29%3B%0A%20%20%20%20%20%20%20%20const%20nodeMaterial%20%3D%20new%20NodeMaterial%28%29%3B%0A%20%20%20%20%20%20%20%20nodeMaterial.name%20%3D%20%22Background.material%22%3B%0A%20%20%20%20%20%20%20%20nodeMaterial.side%20%3D%20BackSide2%3B%0A%20%20%20%20%20%20%20%20nodeMaterial.depthTest%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20nodeMaterial.depthWrite%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20nodeMaterial.fog%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20nodeMaterial.lights%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20nodeMaterial.vertexNode%20%3D%20viewProj%3B%0A%20%20%20%20%20%20%20%20nodeMaterial.colorNode%20%3D%20backgroundMeshNode%3B%0A%20%20%20%20%20%20%20%20sceneData.backgroundMeshNode%20%3D%20backgroundMeshNode%3B%0A%20%20%20%20%20%20%20%20sceneData.backgroundMesh%20%3D%20backgroundMesh%20%3D%20new%20Mesh2%28new%20SphereGeometry2%281%2C%2032%2C%2032%29%2C%20nodeMaterial%29%3B%0A%20%20%20%20%20%20%20%20backgroundMesh.frustumCulled%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20backgroundMesh.name%20%3D%20%22Background.mesh%22%3B%0A%20%20%20%20%20%20%20%20backgroundMesh.onBeforeRender%20%3D%20function%28renderer4%2C%20scene4%2C%20camera3%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.matrixWorld.copyPosition%28camera3.matrixWorld%29%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20backgroundCacheKey%20%3D%20backgroundNode.getCacheKey%28%29%3B%0A%20%20%20%20%20%20if%20%28sceneData.backgroundCacheKey%20%21%3D%3D%20backgroundCacheKey%29%20%7B%0A%20%20%20%20%20%20%20%20sceneData.backgroundMeshNode.node%20%3D%20vec4%28backgroundNode%29.mul%28backgroundIntensity%29%3B%0A%20%20%20%20%20%20%20%20sceneData.backgroundMeshNode.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20backgroundMesh.material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20sceneData.backgroundCacheKey%20%3D%20backgroundCacheKey%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20renderList.unshift%28backgroundMesh%2C%20backgroundMesh.geometry%2C%20backgroundMesh.material%2C%200%2C%200%2C%20null%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.Renderer%3A%20Unsupported%20background%20configuration.%22%2C%20background%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderer3.autoClear%20%3D%3D%3D%20true%20%7C%7C%20forceClear%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20clearColorValue%20%3D%20renderContext.clearColorValue%3B%0A%20%20%20%20%20%20clearColorValue.r%20%3D%20_clearColor%241.r%3B%0A%20%20%20%20%20%20clearColorValue.g%20%3D%20_clearColor%241.g%3B%0A%20%20%20%20%20%20clearColorValue.b%20%3D%20_clearColor%241.b%3B%0A%20%20%20%20%20%20clearColorValue.a%20%3D%20_clearColor%241.a%3B%0A%20%20%20%20%20%20if%20%28renderer3.backend.isWebGLBackend%20%3D%3D%3D%20true%20%7C%7C%20renderer3.alpha%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20clearColorValue.r%20%2A%3D%20clearColorValue.a%3B%0A%20%20%20%20%20%20%20%20clearColorValue.g%20%2A%3D%20clearColorValue.a%3B%0A%20%20%20%20%20%20%20%20clearColorValue.b%20%2A%3D%20clearColorValue.a%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20renderContext.depthClearValue%20%3D%20renderer3._clearDepth%3B%0A%20%20%20%20%20%20renderContext.stencilClearValue%20%3D%20renderer3._clearStencil%3B%0A%20%20%20%20%20%20renderContext.clearColor%20%3D%20renderer3.autoClearColor%20%3D%3D%3D%20true%3B%0A%20%20%20%20%20%20renderContext.clearDepth%20%3D%20renderer3.autoClearDepth%20%3D%3D%3D%20true%3B%0A%20%20%20%20%20%20renderContext.clearStencil%20%3D%20renderer3.autoClearStencil%20%3D%3D%3D%20true%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderContext.clearColor%20%3D%20false%3B%0A%20%20%20%20%20%20renderContext.clearDepth%20%3D%20false%3B%0A%20%20%20%20%20%20renderContext.clearStencil%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20_id%245%20%3D%200%3B%0Avar%20BindGroup%20%3D%20class%20%7B%0A%20%20constructor%28name%20%3D%20%22%22%2C%20bindings%20%3D%20%5B%5D%2C%20index5%20%3D%200%2C%20bindingsReference%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.bindings%20%3D%20bindings%3B%0A%20%20%20%20this.index%20%3D%20index5%3B%0A%20%20%20%20this.bindingsReference%20%3D%20bindingsReference%3B%0A%20%20%20%20this.id%20%3D%20_id%245%2B%2B%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeBuilderState%20%3D%20class%20%7B%0A%20%20constructor%28vertexShader%2C%20fragmentShader%2C%20computeShader%2C%20nodeAttributes%2C%20bindings%2C%20updateNodes%2C%20updateBeforeNodes%2C%20updateAfterNodes%2C%20monitor%2C%20transforms%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20this.vertexShader%20%3D%20vertexShader%3B%0A%20%20%20%20this.fragmentShader%20%3D%20fragmentShader%3B%0A%20%20%20%20this.computeShader%20%3D%20computeShader%3B%0A%20%20%20%20this.transforms%20%3D%20transforms%3B%0A%20%20%20%20this.nodeAttributes%20%3D%20nodeAttributes%3B%0A%20%20%20%20this.bindings%20%3D%20bindings%3B%0A%20%20%20%20this.updateNodes%20%3D%20updateNodes%3B%0A%20%20%20%20this.updateBeforeNodes%20%3D%20updateBeforeNodes%3B%0A%20%20%20%20this.updateAfterNodes%20%3D%20updateAfterNodes%3B%0A%20%20%20%20this.monitor%20%3D%20monitor%3B%0A%20%20%20%20this.usedTimes%20%3D%200%3B%0A%20%20%7D%0A%20%20createBindings%28%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28const%20instanceGroup%20of%20this.bindings%29%20%7B%0A%20%20%20%20%20%20const%20shared%20%3D%20instanceGroup.bindings%5B0%5D.groupNode.shared%3B%0A%20%20%20%20%20%20if%20%28shared%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20const%20bindingsGroup%20%3D%20new%20BindGroup%28instanceGroup.name%2C%20%5B%5D%2C%20instanceGroup.index%2C%20instanceGroup%29%3B%0A%20%20%20%20%20%20%20%20bindings.push%28bindingsGroup%29%3B%0A%20%20%20%20%20%20%20%20for%20%28const%20instanceBinding%20of%20instanceGroup.bindings%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20bindingsGroup.bindings.push%28instanceBinding.clone%28%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20bindings.push%28instanceGroup%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20bindings%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeAttribute%20%3D%20class%20%7B%0A%20%20constructor%28name%2C%20type%2C%20node%20%3D%20null%29%20%7B%0A%20%20%20%20this.isNodeAttribute%20%3D%20true%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.type%20%3D%20type%3B%0A%20%20%20%20this.node%20%3D%20node%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeUniform%20%3D%20class%20%7B%0A%20%20constructor%28name%2C%20type%2C%20node%29%20%7B%0A%20%20%20%20this.isNodeUniform%20%3D%20true%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.type%20%3D%20type%3B%0A%20%20%20%20this.node%20%3D%20node.getSelf%28%29%3B%0A%20%20%7D%0A%20%20get%20value%28%29%20%7B%0A%20%20%20%20return%20this.node.value%3B%0A%20%20%7D%0A%20%20set%20value%28val%29%20%7B%0A%20%20%20%20this.node.value%20%3D%20val%3B%0A%20%20%7D%0A%20%20get%20id%28%29%20%7B%0A%20%20%20%20return%20this.node.id%3B%0A%20%20%7D%0A%20%20get%20groupNode%28%29%20%7B%0A%20%20%20%20return%20this.node.groupNode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeVar%20%3D%20class%20%7B%0A%20%20constructor%28name%2C%20type%29%20%7B%0A%20%20%20%20this.isNodeVar%20%3D%20true%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.type%20%3D%20type%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeVarying%20%3D%20class%20extends%20NodeVar%20%7B%0A%20%20constructor%28name%2C%20type%29%20%7B%0A%20%20%20%20super%28name%2C%20type%29%3B%0A%20%20%20%20this.needsInterpolation%20%3D%20false%3B%0A%20%20%20%20this.isNodeVarying%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeCode%20%3D%20class%20%7B%0A%20%20constructor%28name%2C%20type%2C%20code%20%3D%20%22%22%29%20%7B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.type%20%3D%20type%3B%0A%20%20%20%20this.code%20%3D%20code%3B%0A%20%20%20%20Object.defineProperty%28this%2C%20%22isNodeCode%22%2C%20%7B%20value%3A%20true%20%7D%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20id%20%3D%200%3B%0Avar%20NodeCache%20%3D%20class%20%7B%0A%20%20constructor%28parent%20%3D%20null%29%20%7B%0A%20%20%20%20this.id%20%3D%20id%2B%2B%3B%0A%20%20%20%20this.nodesData%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.parent%20%3D%20parent%3B%0A%20%20%7D%0A%20%20getData%28node%29%20%7B%0A%20%20%20%20let%20data%20%3D%20this.nodesData.get%28node%29%3B%0A%20%20%20%20if%20%28data%20%3D%3D%3D%20void%200%20%26%26%20this.parent%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20data%20%3D%20this.parent.getData%28node%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20data%3B%0A%20%20%7D%0A%20%20setData%28node%2C%20data%29%20%7B%0A%20%20%20%20this.nodesData.set%28node%2C%20data%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Uniform%20%3D%20class%20%7B%0A%20%20constructor%28name%2C%20value%29%20%7B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.value%20%3D%20value%3B%0A%20%20%20%20this.boundary%20%3D%200%3B%0A%20%20%20%20this.itemSize%20%3D%200%3B%0A%20%20%20%20this.offset%20%3D%200%3B%0A%20%20%7D%0A%20%20setValue%28value%29%20%7B%0A%20%20%20%20this.value%20%3D%20value%3B%0A%20%20%7D%0A%20%20getValue%28%29%20%7B%0A%20%20%20%20return%20this.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NumberUniform%20%3D%20class%20extends%20Uniform%20%7B%0A%20%20constructor%28name%2C%20value%20%3D%200%29%20%7B%0A%20%20%20%20super%28name%2C%20value%29%3B%0A%20%20%20%20this.isNumberUniform%20%3D%20true%3B%0A%20%20%20%20this.boundary%20%3D%204%3B%0A%20%20%20%20this.itemSize%20%3D%201%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Vector2Uniform%20%3D%20class%20extends%20Uniform%20%7B%0A%20%20constructor%28name%2C%20value%20%3D%20new%20Vector22%28%29%29%20%7B%0A%20%20%20%20super%28name%2C%20value%29%3B%0A%20%20%20%20this.isVector2Uniform%20%3D%20true%3B%0A%20%20%20%20this.boundary%20%3D%208%3B%0A%20%20%20%20this.itemSize%20%3D%202%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Vector3Uniform%20%3D%20class%20extends%20Uniform%20%7B%0A%20%20constructor%28name%2C%20value%20%3D%20new%20Vector32%28%29%29%20%7B%0A%20%20%20%20super%28name%2C%20value%29%3B%0A%20%20%20%20this.isVector3Uniform%20%3D%20true%3B%0A%20%20%20%20this.boundary%20%3D%2016%3B%0A%20%20%20%20this.itemSize%20%3D%203%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Vector4Uniform%20%3D%20class%20extends%20Uniform%20%7B%0A%20%20constructor%28name%2C%20value%20%3D%20new%20Vector42%28%29%29%20%7B%0A%20%20%20%20super%28name%2C%20value%29%3B%0A%20%20%20%20this.isVector4Uniform%20%3D%20true%3B%0A%20%20%20%20this.boundary%20%3D%2016%3B%0A%20%20%20%20this.itemSize%20%3D%204%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ColorUniform%20%3D%20class%20extends%20Uniform%20%7B%0A%20%20constructor%28name%2C%20value%20%3D%20new%20Color2%28%29%29%20%7B%0A%20%20%20%20super%28name%2C%20value%29%3B%0A%20%20%20%20this.isColorUniform%20%3D%20true%3B%0A%20%20%20%20this.boundary%20%3D%2016%3B%0A%20%20%20%20this.itemSize%20%3D%203%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Matrix3Uniform%20%3D%20class%20extends%20Uniform%20%7B%0A%20%20constructor%28name%2C%20value%20%3D%20new%20Matrix32%28%29%29%20%7B%0A%20%20%20%20super%28name%2C%20value%29%3B%0A%20%20%20%20this.isMatrix3Uniform%20%3D%20true%3B%0A%20%20%20%20this.boundary%20%3D%2048%3B%0A%20%20%20%20this.itemSize%20%3D%2012%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Matrix4Uniform%20%3D%20class%20extends%20Uniform%20%7B%0A%20%20constructor%28name%2C%20value%20%3D%20new%20Matrix42%28%29%29%20%7B%0A%20%20%20%20super%28name%2C%20value%29%3B%0A%20%20%20%20this.isMatrix4Uniform%20%3D%20true%3B%0A%20%20%20%20this.boundary%20%3D%2064%3B%0A%20%20%20%20this.itemSize%20%3D%2016%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NumberNodeUniform%20%3D%20class%20extends%20NumberUniform%20%7B%0A%20%20constructor%28nodeUniform%29%20%7B%0A%20%20%20%20super%28nodeUniform.name%2C%20nodeUniform.value%29%3B%0A%20%20%20%20this.nodeUniform%20%3D%20nodeUniform%3B%0A%20%20%7D%0A%20%20getValue%28%29%20%7B%0A%20%20%20%20return%20this.nodeUniform.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Vector2NodeUniform%20%3D%20class%20extends%20Vector2Uniform%20%7B%0A%20%20constructor%28nodeUniform%29%20%7B%0A%20%20%20%20super%28nodeUniform.name%2C%20nodeUniform.value%29%3B%0A%20%20%20%20this.nodeUniform%20%3D%20nodeUniform%3B%0A%20%20%7D%0A%20%20getValue%28%29%20%7B%0A%20%20%20%20return%20this.nodeUniform.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Vector3NodeUniform%20%3D%20class%20extends%20Vector3Uniform%20%7B%0A%20%20constructor%28nodeUniform%29%20%7B%0A%20%20%20%20super%28nodeUniform.name%2C%20nodeUniform.value%29%3B%0A%20%20%20%20this.nodeUniform%20%3D%20nodeUniform%3B%0A%20%20%7D%0A%20%20getValue%28%29%20%7B%0A%20%20%20%20return%20this.nodeUniform.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Vector4NodeUniform%20%3D%20class%20extends%20Vector4Uniform%20%7B%0A%20%20constructor%28nodeUniform%29%20%7B%0A%20%20%20%20super%28nodeUniform.name%2C%20nodeUniform.value%29%3B%0A%20%20%20%20this.nodeUniform%20%3D%20nodeUniform%3B%0A%20%20%7D%0A%20%20getValue%28%29%20%7B%0A%20%20%20%20return%20this.nodeUniform.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ColorNodeUniform%20%3D%20class%20extends%20ColorUniform%20%7B%0A%20%20constructor%28nodeUniform%29%20%7B%0A%20%20%20%20super%28nodeUniform.name%2C%20nodeUniform.value%29%3B%0A%20%20%20%20this.nodeUniform%20%3D%20nodeUniform%3B%0A%20%20%7D%0A%20%20getValue%28%29%20%7B%0A%20%20%20%20return%20this.nodeUniform.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Matrix3NodeUniform%20%3D%20class%20extends%20Matrix3Uniform%20%7B%0A%20%20constructor%28nodeUniform%29%20%7B%0A%20%20%20%20super%28nodeUniform.name%2C%20nodeUniform.value%29%3B%0A%20%20%20%20this.nodeUniform%20%3D%20nodeUniform%3B%0A%20%20%7D%0A%20%20getValue%28%29%20%7B%0A%20%20%20%20return%20this.nodeUniform.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Matrix4NodeUniform%20%3D%20class%20extends%20Matrix4Uniform%20%7B%0A%20%20constructor%28nodeUniform%29%20%7B%0A%20%20%20%20super%28nodeUniform.name%2C%20nodeUniform.value%29%3B%0A%20%20%20%20this.nodeUniform%20%3D%20nodeUniform%3B%0A%20%20%7D%0A%20%20getValue%28%29%20%7B%0A%20%20%20%20return%20this.nodeUniform.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LOD_MIN2%20%3D%204%3B%0Avar%20EXTRA_LOD_SIGMA2%20%3D%20%5B0.125%2C%200.215%2C%200.35%2C%200.446%2C%200.526%2C%200.582%5D%3B%0Avar%20MAX_SAMPLES2%20%3D%2020%3B%0Avar%20_flatCamera2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20OrthographicCamera2%28-1%2C%201%2C%201%2C%20-1%2C%200%2C%201%29%3B%0Avar%20_cubeCamera%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20PerspectiveCamera2%2890%2C%201%29%3B%0Avar%20_clearColor2%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Color2%28%29%3B%0Avar%20_oldTarget2%20%3D%20null%3B%0Avar%20_oldActiveCubeFace2%20%3D%200%3B%0Avar%20_oldActiveMipmapLevel2%20%3D%200%3B%0Avar%20PHI2%20%3D%20%281%20%2B%20Math.sqrt%285%29%29%20%2F%202%3B%0Avar%20INV_PHI2%20%3D%201%20%2F%20PHI2%3B%0Avar%20_axisDirections2%20%3D%20%5B%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28-PHI2%2C%20INV_PHI2%2C%200%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28PHI2%2C%20INV_PHI2%2C%200%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28-INV_PHI2%2C%200%2C%20PHI2%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28INV_PHI2%2C%200%2C%20PHI2%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%280%2C%20PHI2%2C%20-INV_PHI2%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%280%2C%20PHI2%2C%20INV_PHI2%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28-1%2C%201%2C%20-1%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%281%2C%201%2C%20-1%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%28-1%2C%201%2C%201%29%2C%0A%20%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector32%281%2C%201%2C%201%29%0A%5D%3B%0Avar%20_faceLib%20%3D%20%5B%0A%20%203%2C%0A%20%201%2C%0A%20%205%2C%0A%20%200%2C%0A%20%204%2C%0A%20%202%0A%5D%3B%0Avar%20direction%20%3D%20getDirection%28uv%28%29%2C%20attribute%28%22faceIndex%22%29%29.normalize%28%29%3B%0Avar%20outputDirection%20%3D%20vec3%28direction.x%2C%20direction.y.negate%28%29%2C%20direction.z%29%3B%0Avar%20PMREMGenerator2%20%3D%20class%20%7B%0A%20%20constructor%28renderer3%29%20%7B%0A%20%20%20%20this._renderer%20%3D%20renderer3%3B%0A%20%20%20%20this._pingPongRenderTarget%20%3D%20null%3B%0A%20%20%20%20this._lodMax%20%3D%200%3B%0A%20%20%20%20this._cubeSize%20%3D%200%3B%0A%20%20%20%20this._lodPlanes%20%3D%20%5B%5D%3B%0A%20%20%20%20this._sizeLods%20%3D%20%5B%5D%3B%0A%20%20%20%20this._sigmas%20%3D%20%5B%5D%3B%0A%20%20%20%20this._lodMeshes%20%3D%20%5B%5D%3B%0A%20%20%20%20this._blurMaterial%20%3D%20null%3B%0A%20%20%20%20this._cubemapMaterial%20%3D%20null%3B%0A%20%20%20%20this._equirectMaterial%20%3D%20null%3B%0A%20%20%20%20this._backgroundBox%20%3D%20null%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Generates%20a%20PMREM%20from%20a%20supplied%20Scene%2C%20which%20can%20be%20faster%20than%20using%20an%0A%20%20%20%2A%20image%20if%20networking%20bandwidth%20is%20low.%20Optional%20sigma%20specifies%20a%20blur%20radius%0A%20%20%20%2A%20in%20radians%20to%20be%20applied%20to%20the%20scene%20before%20PMREM%20generation.%20Optional%20near%0A%20%20%20%2A%20and%20far%20planes%20ensure%20the%20scene%20is%20rendered%20in%20its%20entirety%20%28the%20cubeCamera%0A%20%20%20%2A%20is%20placed%20at%20the%20origin%29.%0A%20%20%20%2A%2F%0A%20%20fromScene%28scene3%2C%20sigma%20%3D%200%2C%20near%20%3D%200.1%2C%20far%20%3D%20100%29%20%7B%0A%20%20%20%20_oldTarget2%20%3D%20this._renderer.getRenderTarget%28%29%3B%0A%20%20%20%20_oldActiveCubeFace2%20%3D%20this._renderer.getActiveCubeFace%28%29%3B%0A%20%20%20%20_oldActiveMipmapLevel2%20%3D%20this._renderer.getActiveMipmapLevel%28%29%3B%0A%20%20%20%20this._setSize%28256%29%3B%0A%20%20%20%20const%20cubeUVRenderTarget%20%3D%20this._allocateTargets%28%29%3B%0A%20%20%20%20cubeUVRenderTarget.depthBuffer%20%3D%20true%3B%0A%20%20%20%20this._sceneToCubeUV%28scene3%2C%20near%2C%20far%2C%20cubeUVRenderTarget%29%3B%0A%20%20%20%20if%20%28sigma%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this._blur%28cubeUVRenderTarget%2C%200%2C%200%2C%20sigma%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._applyPMREM%28cubeUVRenderTarget%29%3B%0A%20%20%20%20this._cleanup%28cubeUVRenderTarget%29%3B%0A%20%20%20%20return%20cubeUVRenderTarget%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Generates%20a%20PMREM%20from%20an%20equirectangular%20texture%2C%20which%20can%20be%20either%20LDR%0A%20%20%20%2A%20or%20HDR.%20The%20ideal%20input%20image%20size%20is%201k%20%281024%20x%20512%29%2C%0A%20%20%20%2A%20as%20this%20matches%20best%20with%20the%20256%20x%20256%20cubemap%20output.%0A%20%20%20%2A%2F%0A%20%20fromEquirectangular%28equirectangular%2C%20renderTarget%20%3D%20null%29%20%7B%0A%20%20%20%20return%20this._fromTexture%28equirectangular%2C%20renderTarget%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Generates%20a%20PMREM%20from%20an%20cubemap%20texture%2C%20which%20can%20be%20either%20LDR%0A%20%20%20%2A%20or%20HDR.%20The%20ideal%20input%20cube%20size%20is%20256%20x%20256%2C%0A%20%20%20%2A%20as%20this%20matches%20best%20with%20the%20256%20x%20256%20cubemap%20output.%0A%20%20%20%2A%2F%0A%20%20fromCubemap%28cubemap%2C%20renderTarget%20%3D%20null%29%20%7B%0A%20%20%20%20return%20this._fromTexture%28cubemap%2C%20renderTarget%29%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Pre-compiles%20the%20cubemap%20shader.%20You%20can%20get%20faster%20start-up%20by%20invoking%20this%20method%20during%0A%20%20%20%2A%20your%20texture%27s%20network%20fetch%20for%20increased%20concurrency.%0A%20%20%20%2A%2F%0A%20%20async%20compileCubemapShader%28%29%20%7B%0A%20%20%20%20if%20%28this._cubemapMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._cubemapMaterial%20%3D%20_getCubemapMaterial2%28%29%3B%0A%20%20%20%20%20%20await%20this._compileMaterial%28this._cubemapMaterial%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Pre-compiles%20the%20equirectangular%20shader.%20You%20can%20get%20faster%20start-up%20by%20invoking%20this%20method%20during%0A%20%20%20%2A%20your%20texture%27s%20network%20fetch%20for%20increased%20concurrency.%0A%20%20%20%2A%2F%0A%20%20async%20compileEquirectangularShader%28%29%20%7B%0A%20%20%20%20if%20%28this._equirectMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._equirectMaterial%20%3D%20_getEquirectMaterial2%28%29%3B%0A%20%20%20%20%20%20await%20this._compileMaterial%28this._equirectMaterial%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20Disposes%20of%20the%20PMREMGenerator%27s%20internal%20memory.%20Note%20that%20PMREMGenerator%20is%20a%20static%20class%2C%0A%20%20%20%2A%20so%20you%20should%20not%20need%20more%20than%20one%20PMREMGenerator%20object.%20If%20you%20do%2C%20calling%20dispose%28%29%20on%0A%20%20%20%2A%20one%20of%20them%20will%20cause%20any%20others%20to%20also%20become%20unusable.%0A%20%20%20%2A%2F%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this._dispose%28%29%3B%0A%20%20%20%20if%20%28this._cubemapMaterial%20%21%3D%3D%20null%29%20this._cubemapMaterial.dispose%28%29%3B%0A%20%20%20%20if%20%28this._equirectMaterial%20%21%3D%3D%20null%29%20this._equirectMaterial.dispose%28%29%3B%0A%20%20%20%20if%20%28this._backgroundBox%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._backgroundBox.geometry.dispose%28%29%3B%0A%20%20%20%20%20%20this._backgroundBox.material.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2F%20private%20interface%0A%20%20_setSize%28cubeSize%29%20%7B%0A%20%20%20%20this._lodMax%20%3D%20Math.floor%28Math.log2%28cubeSize%29%29%3B%0A%20%20%20%20this._cubeSize%20%3D%20Math.pow%282%2C%20this._lodMax%29%3B%0A%20%20%7D%0A%20%20_dispose%28%29%20%7B%0A%20%20%20%20if%20%28this._blurMaterial%20%21%3D%3D%20null%29%20this._blurMaterial.dispose%28%29%3B%0A%20%20%20%20if%20%28this._pingPongRenderTarget%20%21%3D%3D%20null%29%20this._pingPongRenderTarget.dispose%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this._lodPlanes.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this._lodPlanes%5Bi%5D.dispose%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_cleanup%28outputTarget%29%20%7B%0A%20%20%20%20this._renderer.setRenderTarget%28_oldTarget2%2C%20_oldActiveCubeFace2%2C%20_oldActiveMipmapLevel2%29%3B%0A%20%20%20%20outputTarget.scissorTest%20%3D%20false%3B%0A%20%20%20%20_setViewport2%28outputTarget%2C%200%2C%200%2C%20outputTarget.width%2C%20outputTarget.height%29%3B%0A%20%20%7D%0A%20%20_fromTexture%28texture2%2C%20renderTarget%29%20%7B%0A%20%20%20%20if%20%28texture2.mapping%20%3D%3D%3D%20CubeReflectionMapping2%20%7C%7C%20texture2.mapping%20%3D%3D%3D%20CubeRefractionMapping2%29%20%7B%0A%20%20%20%20%20%20this._setSize%28texture2.image.length%20%3D%3D%3D%200%20%3F%2016%20%3A%20texture2.image%5B0%5D.width%20%7C%7C%20texture2.image%5B0%5D.image.width%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._setSize%28texture2.image.width%20%2F%204%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_oldTarget2%20%3D%20this._renderer.getRenderTarget%28%29%3B%0A%20%20%20%20_oldActiveCubeFace2%20%3D%20this._renderer.getActiveCubeFace%28%29%3B%0A%20%20%20%20_oldActiveMipmapLevel2%20%3D%20this._renderer.getActiveMipmapLevel%28%29%3B%0A%20%20%20%20const%20cubeUVRenderTarget%20%3D%20renderTarget%20%7C%7C%20this._allocateTargets%28%29%3B%0A%20%20%20%20this._textureToCubeUV%28texture2%2C%20cubeUVRenderTarget%29%3B%0A%20%20%20%20this._applyPMREM%28cubeUVRenderTarget%29%3B%0A%20%20%20%20this._cleanup%28cubeUVRenderTarget%29%3B%0A%20%20%20%20return%20cubeUVRenderTarget%3B%0A%20%20%7D%0A%20%20_allocateTargets%28%29%20%7B%0A%20%20%20%20const%20width%20%3D%203%20%2A%20Math.max%28this._cubeSize%2C%2016%20%2A%207%29%3B%0A%20%20%20%20const%20height%20%3D%204%20%2A%20this._cubeSize%3B%0A%20%20%20%20const%20params%20%3D%20%7B%0A%20%20%20%20%20%20magFilter%3A%20LinearFilter2%2C%0A%20%20%20%20%20%20minFilter%3A%20LinearFilter2%2C%0A%20%20%20%20%20%20generateMipmaps%3A%20false%2C%0A%20%20%20%20%20%20type%3A%20HalfFloatType2%2C%0A%20%20%20%20%20%20format%3A%20RGBAFormat2%2C%0A%20%20%20%20%20%20colorSpace%3A%20LinearSRGBColorSpace2%0A%20%20%20%20%20%20%2F%2FdepthBuffer%3A%20false%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20cubeUVRenderTarget%20%3D%20_createRenderTarget2%28width%2C%20height%2C%20params%29%3B%0A%20%20%20%20if%20%28this._pingPongRenderTarget%20%3D%3D%3D%20null%20%7C%7C%20this._pingPongRenderTarget.width%20%21%3D%3D%20width%20%7C%7C%20this._pingPongRenderTarget.height%20%21%3D%3D%20height%29%20%7B%0A%20%20%20%20%20%20if%20%28this._pingPongRenderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this._dispose%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._pingPongRenderTarget%20%3D%20_createRenderTarget2%28width%2C%20height%2C%20params%29%3B%0A%20%20%20%20%20%20const%20%7B%20_lodMax%20%7D%20%3D%20this%3B%0A%20%20%20%20%20%20%28%7B%20sizeLods%3A%20this._sizeLods%2C%20lodPlanes%3A%20this._lodPlanes%2C%20sigmas%3A%20this._sigmas%2C%20lodMeshes%3A%20this._lodMeshes%20%7D%20%3D%20_createPlanes2%28_lodMax%29%29%3B%0A%20%20%20%20%20%20this._blurMaterial%20%3D%20_getBlurShader2%28_lodMax%2C%20width%2C%20height%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20cubeUVRenderTarget%3B%0A%20%20%7D%0A%20%20async%20_compileMaterial%28material%29%20%7B%0A%20%20%20%20const%20tmpMesh%20%3D%20new%20Mesh2%28this._lodPlanes%5B0%5D%2C%20material%29%3B%0A%20%20%20%20await%20this._renderer.compile%28tmpMesh%2C%20_flatCamera2%29%3B%0A%20%20%7D%0A%20%20_sceneToCubeUV%28scene3%2C%20near%2C%20far%2C%20cubeUVRenderTarget%29%20%7B%0A%20%20%20%20const%20cubeCamera%20%3D%20_cubeCamera%3B%0A%20%20%20%20cubeCamera.near%20%3D%20near%3B%0A%20%20%20%20cubeCamera.far%20%3D%20far%3B%0A%20%20%20%20const%20upSign%20%3D%20%5B-1%2C%201%2C%20-1%2C%20-1%2C%20-1%2C%20-1%5D%3B%0A%20%20%20%20const%20forwardSign%20%3D%20%5B1%2C%201%2C%201%2C%20-1%2C%20-1%2C%20-1%5D%3B%0A%20%20%20%20const%20renderer3%20%3D%20this._renderer%3B%0A%20%20%20%20const%20originalAutoClear%20%3D%20renderer3.autoClear%3B%0A%20%20%20%20renderer3.getClearColor%28_clearColor2%29%3B%0A%20%20%20%20renderer3.autoClear%20%3D%20false%3B%0A%20%20%20%20let%20backgroundBox%20%3D%20this._backgroundBox%3B%0A%20%20%20%20if%20%28backgroundBox%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20backgroundMaterial%20%3D%20new%20MeshBasicMaterial2%28%7B%0A%20%20%20%20%20%20%20%20name%3A%20%22PMREM.Background%22%2C%0A%20%20%20%20%20%20%20%20side%3A%20BackSide2%2C%0A%20%20%20%20%20%20%20%20depthWrite%3A%20false%2C%0A%20%20%20%20%20%20%20%20depthTest%3A%20false%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20backgroundBox%20%3D%20new%20Mesh2%28new%20BoxGeometry2%28%29%2C%20backgroundMaterial%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20useSolidColor%20%3D%20false%3B%0A%20%20%20%20const%20background%20%3D%20scene3.background%3B%0A%20%20%20%20if%20%28background%29%20%7B%0A%20%20%20%20%20%20if%20%28background.isColor%29%20%7B%0A%20%20%20%20%20%20%20%20backgroundBox.material.color.copy%28background%29%3B%0A%20%20%20%20%20%20%20%20scene3.background%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20useSolidColor%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20backgroundBox.material.color.copy%28_clearColor2%29%3B%0A%20%20%20%20%20%20useSolidColor%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.setRenderTarget%28cubeUVRenderTarget%29%3B%0A%20%20%20%20renderer3.clear%28%29%3B%0A%20%20%20%20if%20%28useSolidColor%29%20%7B%0A%20%20%20%20%20%20renderer3.render%28backgroundBox%2C%20cubeCamera%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20col%20%3D%20i%20%25%203%3B%0A%20%20%20%20%20%20if%20%28col%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20cubeCamera.up.set%280%2C%20upSign%5Bi%5D%2C%200%29%3B%0A%20%20%20%20%20%20%20%20cubeCamera.lookAt%28forwardSign%5Bi%5D%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28col%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20cubeCamera.up.set%280%2C%200%2C%20upSign%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20cubeCamera.lookAt%280%2C%20forwardSign%5Bi%5D%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20cubeCamera.up.set%280%2C%20upSign%5Bi%5D%2C%200%29%3B%0A%20%20%20%20%20%20%20%20cubeCamera.lookAt%280%2C%200%2C%20forwardSign%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20size%20%3D%20this._cubeSize%3B%0A%20%20%20%20%20%20_setViewport2%28cubeUVRenderTarget%2C%20col%20%2A%20size%2C%20i%20%3E%202%20%3F%20size%20%3A%200%2C%20size%2C%20size%29%3B%0A%20%20%20%20%20%20renderer3.render%28scene3%2C%20cubeCamera%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.autoClear%20%3D%20originalAutoClear%3B%0A%20%20%20%20scene3.background%20%3D%20background%3B%0A%20%20%7D%0A%20%20_textureToCubeUV%28texture2%2C%20cubeUVRenderTarget%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this._renderer%3B%0A%20%20%20%20const%20isCubeTexture%20%3D%20texture2.mapping%20%3D%3D%3D%20CubeReflectionMapping2%20%7C%7C%20texture2.mapping%20%3D%3D%3D%20CubeRefractionMapping2%3B%0A%20%20%20%20if%20%28isCubeTexture%29%20%7B%0A%20%20%20%20%20%20if%20%28this._cubemapMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this._cubemapMaterial%20%3D%20_getCubemapMaterial2%28texture2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28this._equirectMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this._equirectMaterial%20%3D%20_getEquirectMaterial2%28texture2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20material%20%3D%20isCubeTexture%20%3F%20this._cubemapMaterial%20%3A%20this._equirectMaterial%3B%0A%20%20%20%20material.fragmentNode.value%20%3D%20texture2%3B%0A%20%20%20%20const%20mesh%20%3D%20this._lodMeshes%5B0%5D%3B%0A%20%20%20%20mesh.material%20%3D%20material%3B%0A%20%20%20%20const%20size%20%3D%20this._cubeSize%3B%0A%20%20%20%20_setViewport2%28cubeUVRenderTarget%2C%200%2C%200%2C%203%20%2A%20size%2C%202%20%2A%20size%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28cubeUVRenderTarget%29%3B%0A%20%20%20%20renderer3.render%28mesh%2C%20_flatCamera2%29%3B%0A%20%20%7D%0A%20%20_applyPMREM%28cubeUVRenderTarget%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this._renderer%3B%0A%20%20%20%20const%20autoClear%20%3D%20renderer3.autoClear%3B%0A%20%20%20%20renderer3.autoClear%20%3D%20false%3B%0A%20%20%20%20const%20n%20%3D%20this._lodPlanes.length%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%20n%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20sigma%20%3D%20Math.sqrt%28this._sigmas%5Bi%5D%20%2A%20this._sigmas%5Bi%5D%20-%20this._sigmas%5Bi%20-%201%5D%20%2A%20this._sigmas%5Bi%20-%201%5D%29%3B%0A%20%20%20%20%20%20const%20poleAxis%20%3D%20_axisDirections2%5B%28n%20-%20i%20-%201%29%20%25%20_axisDirections2.length%5D%3B%0A%20%20%20%20%20%20this._blur%28cubeUVRenderTarget%2C%20i%20-%201%2C%20i%2C%20sigma%2C%20poleAxis%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.autoClear%20%3D%20autoClear%3B%0A%20%20%7D%0A%20%20%2F%2A%2A%0A%20%20%20%2A%20This%20is%20a%20two-pass%20Gaussian%20blur%20for%20a%20cubemap.%20Normally%20this%20is%20done%0A%20%20%20%2A%20vertically%20and%20horizontally%2C%20but%20this%20breaks%20down%20on%20a%20cube.%20Here%20we%20apply%0A%20%20%20%2A%20the%20blur%20latitudinally%20%28around%20the%20poles%29%2C%20and%20then%20longitudinally%20%28towards%0A%20%20%20%2A%20the%20poles%29%20to%20approximate%20the%20orthogonally-separable%20blur.%20It%20is%20least%0A%20%20%20%2A%20accurate%20at%20the%20poles%2C%20but%20still%20does%20a%20decent%20job.%0A%20%20%20%2A%2F%0A%20%20_blur%28cubeUVRenderTarget%2C%20lodIn%2C%20lodOut%2C%20sigma%2C%20poleAxis%29%20%7B%0A%20%20%20%20const%20pingPongRenderTarget%20%3D%20this._pingPongRenderTarget%3B%0A%20%20%20%20this._halfBlur%28%0A%20%20%20%20%20%20cubeUVRenderTarget%2C%0A%20%20%20%20%20%20pingPongRenderTarget%2C%0A%20%20%20%20%20%20lodIn%2C%0A%20%20%20%20%20%20lodOut%2C%0A%20%20%20%20%20%20sigma%2C%0A%20%20%20%20%20%20%22latitudinal%22%2C%0A%20%20%20%20%20%20poleAxis%0A%20%20%20%20%29%3B%0A%20%20%20%20this._halfBlur%28%0A%20%20%20%20%20%20pingPongRenderTarget%2C%0A%20%20%20%20%20%20cubeUVRenderTarget%2C%0A%20%20%20%20%20%20lodOut%2C%0A%20%20%20%20%20%20lodOut%2C%0A%20%20%20%20%20%20sigma%2C%0A%20%20%20%20%20%20%22longitudinal%22%2C%0A%20%20%20%20%20%20poleAxis%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20_halfBlur%28targetIn%2C%20targetOut%2C%20lodIn%2C%20lodOut%2C%20sigmaRadians%2C%20direction2%2C%20poleAxis%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this._renderer%3B%0A%20%20%20%20const%20blurMaterial%20%3D%20this._blurMaterial%3B%0A%20%20%20%20if%20%28direction2%20%21%3D%3D%20%22latitudinal%22%20%26%26%20direction2%20%21%3D%3D%20%22longitudinal%22%29%20%7B%0A%20%20%20%20%20%20console.error%28%22blur%20direction%20must%20be%20either%20latitudinal%20or%20longitudinal%21%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20STANDARD_DEVIATIONS%20%3D%203%3B%0A%20%20%20%20const%20blurMesh%20%3D%20this._lodMeshes%5BlodOut%5D%3B%0A%20%20%20%20blurMesh.material%20%3D%20blurMaterial%3B%0A%20%20%20%20const%20blurUniforms%20%3D%20blurMaterial.uniforms%3B%0A%20%20%20%20const%20pixels%20%3D%20this._sizeLods%5BlodIn%5D%20-%201%3B%0A%20%20%20%20const%20radiansPerPixel%20%3D%20isFinite%28sigmaRadians%29%20%3F%20Math.PI%20%2F%20%282%20%2A%20pixels%29%20%3A%202%20%2A%20Math.PI%20%2F%20%282%20%2A%20MAX_SAMPLES2%20-%201%29%3B%0A%20%20%20%20const%20sigmaPixels%20%3D%20sigmaRadians%20%2F%20radiansPerPixel%3B%0A%20%20%20%20const%20samples%20%3D%20isFinite%28sigmaRadians%29%20%3F%201%20%2B%20Math.floor%28STANDARD_DEVIATIONS%20%2A%20sigmaPixels%29%20%3A%20MAX_SAMPLES2%3B%0A%20%20%20%20if%20%28samples%20%3E%20MAX_SAMPLES2%29%20%7B%0A%20%20%20%20%20%20console.warn%28%60sigmaRadians%2C%20%24%7BsigmaRadians%7D%2C%20is%20too%20large%20and%20will%20clip%2C%20as%20it%20requested%20%24%7Bsamples%7D%20samples%20when%20the%20maximum%20is%20set%20to%20%24%7BMAX_SAMPLES2%7D%60%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20weights%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20sum%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20MAX_SAMPLES2%3B%20%2B%2Bi%29%20%7B%0A%20%20%20%20%20%20const%20x3%20%3D%20i%20%2F%20sigmaPixels%3B%0A%20%20%20%20%20%20const%20weight%20%3D%20Math.exp%28-x3%20%2A%20x3%20%2F%202%29%3B%0A%20%20%20%20%20%20weights.push%28weight%29%3B%0A%20%20%20%20%20%20if%20%28i%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20sum%20%2B%3D%20weight%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28i%20%3C%20samples%29%20%7B%0A%20%20%20%20%20%20%20%20sum%20%2B%3D%202%20%2A%20weight%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20weights.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20weights%5Bi%5D%20%3D%20weights%5Bi%5D%20%2F%20sum%3B%0A%20%20%20%20%7D%0A%20%20%20%20targetIn.texture.frame%20%3D%20%28targetIn.texture.frame%20%7C%7C%200%29%20%2B%201%3B%0A%20%20%20%20blurUniforms.envMap.value%20%3D%20targetIn.texture%3B%0A%20%20%20%20blurUniforms.samples.value%20%3D%20samples%3B%0A%20%20%20%20blurUniforms.weights.array%20%3D%20weights%3B%0A%20%20%20%20blurUniforms.latitudinal.value%20%3D%20direction2%20%3D%3D%3D%20%22latitudinal%22%20%3F%201%20%3A%200%3B%0A%20%20%20%20if%20%28poleAxis%29%20%7B%0A%20%20%20%20%20%20blurUniforms.poleAxis.value%20%3D%20poleAxis%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20%7B%20_lodMax%20%7D%20%3D%20this%3B%0A%20%20%20%20blurUniforms.dTheta.value%20%3D%20radiansPerPixel%3B%0A%20%20%20%20blurUniforms.mipInt.value%20%3D%20_lodMax%20-%20lodIn%3B%0A%20%20%20%20const%20outputSize%20%3D%20this._sizeLods%5BlodOut%5D%3B%0A%20%20%20%20const%20x2%20%3D%203%20%2A%20outputSize%20%2A%20%28lodOut%20%3E%20_lodMax%20-%20LOD_MIN2%20%3F%20lodOut%20-%20_lodMax%20%2B%20LOD_MIN2%20%3A%200%29%3B%0A%20%20%20%20const%20y2%20%3D%204%20%2A%20%28this._cubeSize%20-%20outputSize%29%3B%0A%20%20%20%20_setViewport2%28targetOut%2C%20x2%2C%20y2%2C%203%20%2A%20outputSize%2C%202%20%2A%20outputSize%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28targetOut%29%3B%0A%20%20%20%20renderer3.render%28blurMesh%2C%20_flatCamera2%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20_createPlanes2%28lodMax%29%20%7B%0A%20%20const%20lodPlanes%20%3D%20%5B%5D%3B%0A%20%20const%20sizeLods%20%3D%20%5B%5D%3B%0A%20%20const%20sigmas%20%3D%20%5B%5D%3B%0A%20%20const%20lodMeshes%20%3D%20%5B%5D%3B%0A%20%20let%20lod%20%3D%20lodMax%3B%0A%20%20const%20totalLods%20%3D%20lodMax%20-%20LOD_MIN2%20%2B%201%20%2B%20EXTRA_LOD_SIGMA2.length%3B%0A%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20totalLods%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20const%20sizeLod%20%3D%20Math.pow%282%2C%20lod%29%3B%0A%20%20%20%20sizeLods.push%28sizeLod%29%3B%0A%20%20%20%20let%20sigma%20%3D%201%20%2F%20sizeLod%3B%0A%20%20%20%20if%20%28i%20%3E%20lodMax%20-%20LOD_MIN2%29%20%7B%0A%20%20%20%20%20%20sigma%20%3D%20EXTRA_LOD_SIGMA2%5Bi%20-%20lodMax%20%2B%20LOD_MIN2%20-%201%5D%3B%0A%20%20%20%20%7D%20else%20if%20%28i%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20sigma%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20sigmas.push%28sigma%29%3B%0A%20%20%20%20const%20texelSize%20%3D%201%20%2F%20%28sizeLod%20-%202%29%3B%0A%20%20%20%20const%20min2%20%3D%20-texelSize%3B%0A%20%20%20%20const%20max2%20%3D%201%20%2B%20texelSize%3B%0A%20%20%20%20const%20uv1%20%3D%20%5Bmin2%2C%20min2%2C%20max2%2C%20min2%2C%20max2%2C%20max2%2C%20min2%2C%20min2%2C%20max2%2C%20max2%2C%20min2%2C%20max2%5D%3B%0A%20%20%20%20const%20cubeFaces%20%3D%206%3B%0A%20%20%20%20const%20vertices%20%3D%206%3B%0A%20%20%20%20const%20positionSize%20%3D%203%3B%0A%20%20%20%20const%20uvSize%20%3D%202%3B%0A%20%20%20%20const%20faceIndexSize%20%3D%201%3B%0A%20%20%20%20const%20position%20%3D%20new%20Float32Array%28positionSize%20%2A%20vertices%20%2A%20cubeFaces%29%3B%0A%20%20%20%20const%20uv2%20%3D%20new%20Float32Array%28uvSize%20%2A%20vertices%20%2A%20cubeFaces%29%3B%0A%20%20%20%20const%20faceIndex%20%3D%20new%20Float32Array%28faceIndexSize%20%2A%20vertices%20%2A%20cubeFaces%29%3B%0A%20%20%20%20for%20%28let%20face%20%3D%200%3B%20face%20%3C%20cubeFaces%3B%20face%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20x2%20%3D%20face%20%25%203%20%2A%202%20%2F%203%20-%201%3B%0A%20%20%20%20%20%20const%20y2%20%3D%20face%20%3E%202%20%3F%200%20%3A%20-1%3B%0A%20%20%20%20%20%20const%20coordinates%20%3D%20%5B%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%20%2B%202%20%2F%203%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%20%2B%202%20%2F%203%2C%0A%20%20%20%20%20%20%20%20y2%20%2B%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%20y2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%20%2B%202%20%2F%203%2C%0A%20%20%20%20%20%20%20%20y2%20%2B%201%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20x2%2C%0A%20%20%20%20%20%20%20%20y2%20%2B%201%2C%0A%20%20%20%20%20%20%20%200%0A%20%20%20%20%20%20%5D%3B%0A%20%20%20%20%20%20const%20faceIdx%20%3D%20_faceLib%5Bface%5D%3B%0A%20%20%20%20%20%20position.set%28coordinates%2C%20positionSize%20%2A%20vertices%20%2A%20faceIdx%29%3B%0A%20%20%20%20%20%20uv2.set%28uv1%2C%20uvSize%20%2A%20vertices%20%2A%20faceIdx%29%3B%0A%20%20%20%20%20%20const%20fill%20%3D%20%5BfaceIdx%2C%20faceIdx%2C%20faceIdx%2C%20faceIdx%2C%20faceIdx%2C%20faceIdx%5D%3B%0A%20%20%20%20%20%20faceIndex.set%28fill%2C%20faceIndexSize%20%2A%20vertices%20%2A%20faceIdx%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20planes%20%3D%20new%20BufferGeometry2%28%29%3B%0A%20%20%20%20planes.setAttribute%28%22position%22%2C%20new%20BufferAttribute2%28position%2C%20positionSize%29%29%3B%0A%20%20%20%20planes.setAttribute%28%22uv%22%2C%20new%20BufferAttribute2%28uv2%2C%20uvSize%29%29%3B%0A%20%20%20%20planes.setAttribute%28%22faceIndex%22%2C%20new%20BufferAttribute2%28faceIndex%2C%20faceIndexSize%29%29%3B%0A%20%20%20%20lodPlanes.push%28planes%29%3B%0A%20%20%20%20lodMeshes.push%28new%20Mesh2%28planes%2C%20null%29%29%3B%0A%20%20%20%20if%20%28lod%20%3E%20LOD_MIN2%29%20%7B%0A%20%20%20%20%20%20lod--%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20%7B%20lodPlanes%2C%20sizeLods%2C%20sigmas%2C%20lodMeshes%20%7D%3B%0A%7D%0Afunction%20_createRenderTarget2%28width%2C%20height%2C%20params%29%20%7B%0A%20%20const%20cubeUVRenderTarget%20%3D%20new%20RenderTarget2%28width%2C%20height%2C%20params%29%3B%0A%20%20cubeUVRenderTarget.texture.mapping%20%3D%20CubeUVReflectionMapping2%3B%0A%20%20cubeUVRenderTarget.texture.name%20%3D%20%22PMREM.cubeUv%22%3B%0A%20%20cubeUVRenderTarget.texture.isPMREMTexture%20%3D%20true%3B%0A%20%20cubeUVRenderTarget.scissorTest%20%3D%20true%3B%0A%20%20return%20cubeUVRenderTarget%3B%0A%7D%0Afunction%20_setViewport2%28target%2C%20x2%2C%20y2%2C%20width%2C%20height%29%20%7B%0A%20%20target.viewport.set%28x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%20%20target.scissor.set%28x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%7D%0Afunction%20_getMaterial%28type%29%20%7B%0A%20%20const%20material%20%3D%20new%20NodeMaterial%28%29%3B%0A%20%20material.depthTest%20%3D%20false%3B%0A%20%20material.depthWrite%20%3D%20false%3B%0A%20%20material.blending%20%3D%20NoBlending2%3B%0A%20%20material.name%20%3D%20%60PMREM_%24%7Btype%7D%60%3B%0A%20%20return%20material%3B%0A%7D%0Afunction%20_getBlurShader2%28lodMax%2C%20width%2C%20height%29%20%7B%0A%20%20const%20weights%20%3D%20uniformArray%28new%20Array%28MAX_SAMPLES2%29.fill%280%29%29%3B%0A%20%20const%20poleAxis%20%3D%20uniform%28new%20Vector32%280%2C%201%2C%200%29%29%3B%0A%20%20const%20dTheta%20%3D%20uniform%280%29%3B%0A%20%20const%20n%20%3D%20float%28MAX_SAMPLES2%29%3B%0A%20%20const%20latitudinal%20%3D%20uniform%280%29%3B%0A%20%20const%20samples%20%3D%20uniform%281%29%3B%0A%20%20const%20envMap%20%3D%20texture%28null%29%3B%0A%20%20const%20mipInt%20%3D%20uniform%280%29%3B%0A%20%20const%20CUBEUV_TEXEL_WIDTH%20%3D%20float%281%20%2F%20width%29%3B%0A%20%20const%20CUBEUV_TEXEL_HEIGHT%20%3D%20float%281%20%2F%20height%29%3B%0A%20%20const%20CUBEUV_MAX_MIP%20%3D%20float%28lodMax%29%3B%0A%20%20const%20materialUniforms%20%3D%20%7B%0A%20%20%20%20n%2C%0A%20%20%20%20latitudinal%2C%0A%20%20%20%20weights%2C%0A%20%20%20%20poleAxis%2C%0A%20%20%20%20outputDirection%2C%0A%20%20%20%20dTheta%2C%0A%20%20%20%20samples%2C%0A%20%20%20%20envMap%2C%0A%20%20%20%20mipInt%2C%0A%20%20%20%20CUBEUV_TEXEL_WIDTH%2C%0A%20%20%20%20CUBEUV_TEXEL_HEIGHT%2C%0A%20%20%20%20CUBEUV_MAX_MIP%0A%20%20%7D%3B%0A%20%20const%20material%20%3D%20_getMaterial%28%22blur%22%29%3B%0A%20%20material.uniforms%20%3D%20materialUniforms%3B%0A%20%20material.fragmentNode%20%3D%20blur%28%7B%20...materialUniforms%2C%20latitudinal%3A%20latitudinal.equal%281%29%20%7D%29%3B%0A%20%20return%20material%3B%0A%7D%0Afunction%20_getCubemapMaterial2%28envTexture%29%20%7B%0A%20%20const%20material%20%3D%20_getMaterial%28%22cubemap%22%29%3B%0A%20%20material.fragmentNode%20%3D%20cubeTexture%28envTexture%2C%20outputDirection%29%3B%0A%20%20return%20material%3B%0A%7D%0Afunction%20_getEquirectMaterial2%28envTexture%29%20%7B%0A%20%20const%20material%20%3D%20_getMaterial%28%22equirect%22%29%3B%0A%20%20material.fragmentNode%20%3D%20texture%28envTexture%2C%20equirectUV%28outputDirection%29%2C%200%29%3B%0A%20%20return%20material%3B%0A%7D%0Avar%20rendererCache%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Avar%20typeFromLength%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%5B%0A%20%20%5B2%2C%20%22vec2%22%5D%2C%0A%20%20%5B3%2C%20%22vec3%22%5D%2C%0A%20%20%5B4%2C%20%22vec4%22%5D%2C%0A%20%20%5B9%2C%20%22mat3%22%5D%2C%0A%20%20%5B16%2C%20%22mat4%22%5D%0A%5D%29%3B%0Avar%20typeFromArray%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%5B%0A%20%20%5BInt8Array%2C%20%22int%22%5D%2C%0A%20%20%5BInt16Array%2C%20%22int%22%5D%2C%0A%20%20%5BInt32Array%2C%20%22int%22%5D%2C%0A%20%20%5BUint8Array%2C%20%22uint%22%5D%2C%0A%20%20%5BUint16Array%2C%20%22uint%22%5D%2C%0A%20%20%5BUint32Array%2C%20%22uint%22%5D%2C%0A%20%20%5BFloat32Array%2C%20%22float%22%5D%0A%5D%29%3B%0Avar%20toFloat%20%3D%20%28value%29%20%3D%3E%20%7B%0A%20%20if%20%28%2Fe%2Fg.test%28value%29%29%20%7B%0A%20%20%20%20return%20String%28value%29.replace%28%2F%5C%2B%2Fg%2C%20%22%22%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20value%20%3D%20Number%28value%29%3B%0A%20%20%20%20return%20value%20%2B%20%28value%20%25%201%20%3F%20%22%22%20%3A%20%22.0%22%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeBuilder%20%3D%20class%20%7B%0A%20%20constructor%28object%2C%20renderer3%2C%20parser%29%20%7B%0A%20%20%20%20this.object%20%3D%20object%3B%0A%20%20%20%20this.material%20%3D%20object%20%26%26%20object.material%20%7C%7C%20null%3B%0A%20%20%20%20this.geometry%20%3D%20object%20%26%26%20object.geometry%20%7C%7C%20null%3B%0A%20%20%20%20this.renderer%20%3D%20renderer3%3B%0A%20%20%20%20this.parser%20%3D%20parser%3B%0A%20%20%20%20this.scene%20%3D%20null%3B%0A%20%20%20%20this.camera%20%3D%20null%3B%0A%20%20%20%20this.nodes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.sequentialNodes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.updateNodes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.updateBeforeNodes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.updateAfterNodes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.hashNodes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.monitor%20%3D%20null%3B%0A%20%20%20%20this.lightsNode%20%3D%20null%3B%0A%20%20%20%20this.environmentNode%20%3D%20null%3B%0A%20%20%20%20this.fogNode%20%3D%20null%3B%0A%20%20%20%20this.clippingContext%20%3D%20null%3B%0A%20%20%20%20this.vertexShader%20%3D%20null%3B%0A%20%20%20%20this.fragmentShader%20%3D%20null%3B%0A%20%20%20%20this.computeShader%20%3D%20null%3B%0A%20%20%20%20this.flowNodes%20%3D%20%7B%20vertex%3A%20%5B%5D%2C%20fragment%3A%20%5B%5D%2C%20compute%3A%20%5B%5D%20%7D%3B%0A%20%20%20%20this.flowCode%20%3D%20%7B%20vertex%3A%20%22%22%2C%20fragment%3A%20%22%22%2C%20compute%3A%20%22%22%20%7D%3B%0A%20%20%20%20this.uniforms%20%3D%20%7B%20vertex%3A%20%5B%5D%2C%20fragment%3A%20%5B%5D%2C%20compute%3A%20%5B%5D%2C%20index%3A%200%20%7D%3B%0A%20%20%20%20this.structs%20%3D%20%7B%20vertex%3A%20%5B%5D%2C%20fragment%3A%20%5B%5D%2C%20compute%3A%20%5B%5D%2C%20index%3A%200%20%7D%3B%0A%20%20%20%20this.bindings%20%3D%20%7B%20vertex%3A%20%7B%7D%2C%20fragment%3A%20%7B%7D%2C%20compute%3A%20%7B%7D%20%7D%3B%0A%20%20%20%20this.bindingsIndexes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.bindGroups%20%3D%20null%3B%0A%20%20%20%20this.attributes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.bufferAttributes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.varyings%20%3D%20%5B%5D%3B%0A%20%20%20%20this.codes%20%3D%20%7B%7D%3B%0A%20%20%20%20this.vars%20%3D%20%7B%7D%3B%0A%20%20%20%20this.flow%20%3D%20%7B%20code%3A%20%22%22%20%7D%3B%0A%20%20%20%20this.chaining%20%3D%20%5B%5D%3B%0A%20%20%20%20this.stack%20%3D%20stack%28%29%3B%0A%20%20%20%20this.stacks%20%3D%20%5B%5D%3B%0A%20%20%20%20this.tab%20%3D%20%22%09%22%3B%0A%20%20%20%20this.currentFunctionNode%20%3D%20null%3B%0A%20%20%20%20this.context%20%3D%20%7B%0A%20%20%20%20%20%20material%3A%20this.material%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.cache%20%3D%20new%20NodeCache%28%29%3B%0A%20%20%20%20this.globalCache%20%3D%20this.cache%3B%0A%20%20%20%20this.flowsData%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.shaderStage%20%3D%20null%3B%0A%20%20%20%20this.buildStage%20%3D%20null%3B%0A%20%20%20%20this.useComparisonMethod%20%3D%20false%3B%0A%20%20%7D%0A%20%20getBindGroupsCache%28%29%20%7B%0A%20%20%20%20let%20bindGroupsCache%20%3D%20rendererCache.get%28this.renderer%29%3B%0A%20%20%20%20if%20%28bindGroupsCache%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20bindGroupsCache%20%3D%20new%20ChainMap%28%29%3B%0A%20%20%20%20%20%20rendererCache.set%28this.renderer%2C%20bindGroupsCache%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20bindGroupsCache%3B%0A%20%20%7D%0A%20%20createRenderTarget%28width%2C%20height%2C%20options%29%20%7B%0A%20%20%20%20return%20new%20RenderTarget2%28width%2C%20height%2C%20options%29%3B%0A%20%20%7D%0A%20%20createCubeRenderTarget%28size%2C%20options%29%20%7B%0A%20%20%20%20return%20new%20CubeRenderTarget%28size%2C%20options%29%3B%0A%20%20%7D%0A%20%20createPMREMGenerator%28%29%20%7B%0A%20%20%20%20return%20new%20PMREMGenerator2%28this.renderer%29%3B%0A%20%20%7D%0A%20%20includes%28node%29%20%7B%0A%20%20%20%20return%20this.nodes.includes%28node%29%3B%0A%20%20%7D%0A%20%20_getBindGroup%28groupName%2C%20bindings%29%20%7B%0A%20%20%20%20const%20bindGroupsCache%20%3D%20this.getBindGroupsCache%28%29%3B%0A%20%20%20%20const%20bindingsArray%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20sharedGroup%20%3D%20true%3B%0A%20%20%20%20for%20%28const%20binding%20of%20bindings%29%20%7B%0A%20%20%20%20%20%20bindingsArray.push%28binding%29%3B%0A%20%20%20%20%20%20sharedGroup%20%3D%20sharedGroup%20%26%26%20binding.groupNode.shared%20%21%3D%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20bindGroup%3B%0A%20%20%20%20if%20%28sharedGroup%29%20%7B%0A%20%20%20%20%20%20bindGroup%20%3D%20bindGroupsCache.get%28bindingsArray%29%3B%0A%20%20%20%20%20%20if%20%28bindGroup%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20bindGroup%20%3D%20new%20BindGroup%28groupName%2C%20bindingsArray%2C%20this.bindingsIndexes%5BgroupName%5D.group%2C%20bindingsArray%29%3B%0A%20%20%20%20%20%20%20%20bindGroupsCache.set%28bindingsArray%2C%20bindGroup%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20bindGroup%20%3D%20new%20BindGroup%28groupName%2C%20bindingsArray%2C%20this.bindingsIndexes%5BgroupName%5D.group%2C%20bindingsArray%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20bindGroup%3B%0A%20%20%7D%0A%20%20getBindGroupArray%28groupName%2C%20shaderStage%29%20%7B%0A%20%20%20%20const%20bindings%20%3D%20this.bindings%5BshaderStage%5D%3B%0A%20%20%20%20let%20bindGroup%20%3D%20bindings%5BgroupName%5D%3B%0A%20%20%20%20if%20%28bindGroup%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28this.bindingsIndexes%5BgroupName%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20this.bindingsIndexes%5BgroupName%5D%20%3D%20%7B%20binding%3A%200%2C%20group%3A%20Object.keys%28this.bindingsIndexes%29.length%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20bindings%5BgroupName%5D%20%3D%20bindGroup%20%3D%20%5B%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20bindGroup%3B%0A%20%20%7D%0A%20%20getBindings%28%29%20%7B%0A%20%20%20%20let%20bindingsGroups%20%3D%20this.bindGroups%3B%0A%20%20%20%20if%20%28bindingsGroups%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20groups%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20const%20bindings%20%3D%20this.bindings%3B%0A%20%20%20%20%20%20for%20%28const%20shaderStage%20of%20shaderStages%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28const%20groupName%20in%20bindings%5BshaderStage%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20uniforms%20%3D%20bindings%5BshaderStage%5D%5BgroupName%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20groupUniforms%20%3D%20groups%5BgroupName%5D%20%7C%7C%20%28groups%5BgroupName%5D%20%3D%20%5B%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20groupUniforms.push%28...uniforms%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20bindingsGroups%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28const%20groupName%20in%20groups%29%20%7B%0A%20%20%20%20%20%20%20%20const%20group%20%3D%20groups%5BgroupName%5D%3B%0A%20%20%20%20%20%20%20%20const%20bindingsGroup%20%3D%20this._getBindGroup%28groupName%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20bindingsGroups.push%28bindingsGroup%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.bindGroups%20%3D%20bindingsGroups%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20bindingsGroups%3B%0A%20%20%7D%0A%20%20sortBindingGroups%28%29%20%7B%0A%20%20%20%20const%20bindingsGroups%20%3D%20this.getBindings%28%29%3B%0A%20%20%20%20bindingsGroups.sort%28%28a2%2C%20b%29%20%3D%3E%20a2.bindings%5B0%5D.groupNode.order%20-%20b.bindings%5B0%5D.groupNode.order%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20bindingsGroups.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20bindingGroup%20%3D%20bindingsGroups%5Bi%5D%3B%0A%20%20%20%20%20%20this.bindingsIndexes%5BbindingGroup.name%5D.group%20%3D%20i%3B%0A%20%20%20%20%20%20bindingGroup.index%20%3D%20i%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setHashNode%28node%2C%20hash%29%20%7B%0A%20%20%20%20this.hashNodes%5Bhash%5D%20%3D%20node%3B%0A%20%20%7D%0A%20%20addNode%28node%29%20%7B%0A%20%20%20%20if%20%28this.nodes.includes%28node%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this.nodes.push%28node%29%3B%0A%20%20%20%20%20%20this.setHashNode%28node%2C%20node.getHash%28this%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20addSequentialNode%28node%29%20%7B%0A%20%20%20%20if%20%28this.sequentialNodes.includes%28node%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this.sequentialNodes.push%28node%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20buildUpdateNodes%28%29%20%7B%0A%20%20%20%20for%20%28const%20node%20of%20this.nodes%29%20%7B%0A%20%20%20%20%20%20const%20updateType%20%3D%20node.getUpdateType%28%29%3B%0A%20%20%20%20%20%20if%20%28updateType%20%21%3D%3D%20NodeUpdateType.NONE%29%20%7B%0A%20%20%20%20%20%20%20%20this.updateNodes.push%28node.getSelf%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28const%20node%20of%20this.sequentialNodes%29%20%7B%0A%20%20%20%20%20%20const%20updateBeforeType%20%3D%20node.getUpdateBeforeType%28%29%3B%0A%20%20%20%20%20%20const%20updateAfterType%20%3D%20node.getUpdateAfterType%28%29%3B%0A%20%20%20%20%20%20if%20%28updateBeforeType%20%21%3D%3D%20NodeUpdateType.NONE%29%20%7B%0A%20%20%20%20%20%20%20%20this.updateBeforeNodes.push%28node.getSelf%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28updateAfterType%20%21%3D%3D%20NodeUpdateType.NONE%29%20%7B%0A%20%20%20%20%20%20%20%20this.updateAfterNodes.push%28node.getSelf%28%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20get%20currentNode%28%29%20%7B%0A%20%20%20%20return%20this.chaining%5Bthis.chaining.length%20-%201%5D%3B%0A%20%20%7D%0A%20%20isFilteredTexture%28texture2%29%20%7B%0A%20%20%20%20return%20texture2.magFilter%20%3D%3D%3D%20LinearFilter2%20%7C%7C%20texture2.magFilter%20%3D%3D%3D%20LinearMipmapNearestFilter2%20%7C%7C%20texture2.magFilter%20%3D%3D%3D%20NearestMipmapLinearFilter2%20%7C%7C%20texture2.magFilter%20%3D%3D%3D%20LinearMipmapLinearFilter2%20%7C%7C%20texture2.minFilter%20%3D%3D%3D%20LinearFilter2%20%7C%7C%20texture2.minFilter%20%3D%3D%3D%20LinearMipmapNearestFilter2%20%7C%7C%20texture2.minFilter%20%3D%3D%3D%20NearestMipmapLinearFilter2%20%7C%7C%20texture2.minFilter%20%3D%3D%3D%20LinearMipmapLinearFilter2%3B%0A%20%20%7D%0A%20%20addChain%28node%29%20%7B%0A%20%20%20%20this.chaining.push%28node%29%3B%0A%20%20%7D%0A%20%20removeChain%28node%29%20%7B%0A%20%20%20%20const%20lastChain%20%3D%20this.chaining.pop%28%29%3B%0A%20%20%20%20if%20%28lastChain%20%21%3D%3D%20node%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22NodeBuilder%3A%20Invalid%20node%20chaining%21%22%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getMethod%28method%29%20%7B%0A%20%20%20%20return%20method%3B%0A%20%20%7D%0A%20%20getNodeFromHash%28hash%29%20%7B%0A%20%20%20%20return%20this.hashNodes%5Bhash%5D%3B%0A%20%20%7D%0A%20%20addFlow%28shaderStage%2C%20node%29%20%7B%0A%20%20%20%20this.flowNodes%5BshaderStage%5D.push%28node%29%3B%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%20%20setContext%28context2%29%20%7B%0A%20%20%20%20this.context%20%3D%20context2%3B%0A%20%20%7D%0A%20%20getContext%28%29%20%7B%0A%20%20%20%20return%20this.context%3B%0A%20%20%7D%0A%20%20getSharedContext%28%29%20%7B%0A%20%20%20%20%28%7B%20...this.context%20%7D%29%3B%0A%20%20%20%20return%20this.context%3B%0A%20%20%7D%0A%20%20setCache%28cache2%29%20%7B%0A%20%20%20%20this.cache%20%3D%20cache2%3B%0A%20%20%7D%0A%20%20getCache%28%29%20%7B%0A%20%20%20%20return%20this.cache%3B%0A%20%20%7D%0A%20%20getCacheFromNode%28node%2C%20parent%20%3D%20true%29%20%7B%0A%20%20%20%20const%20data%20%3D%20this.getDataFromNode%28node%29%3B%0A%20%20%20%20if%20%28data.cache%20%3D%3D%3D%20void%200%29%20data.cache%20%3D%20new%20NodeCache%28parent%20%3F%20this.getCache%28%29%20%3A%20null%29%3B%0A%20%20%20%20return%20data.cache%3B%0A%20%20%7D%0A%20%20isAvailable%28%29%20%7B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20getVertexIndex%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20getInstanceIndex%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20getDrawIndex%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20getFrontFacing%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20getFragCoord%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20isFlipY%28%29%20%7B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20increaseUsage%28node%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%29%3B%0A%20%20%20%20nodeData.usageCount%20%3D%20nodeData.usageCount%20%3D%3D%3D%20void%200%20%3F%201%20%3A%20nodeData.usageCount%20%2B%201%3B%0A%20%20%20%20return%20nodeData.usageCount%3B%0A%20%20%7D%0A%20%20generateTexture%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20generateTextureLod%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20generateConst%28type%2C%20value%20%3D%20null%29%20%7B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20%22float%22%20%7C%7C%20type%20%3D%3D%3D%20%22int%22%20%7C%7C%20type%20%3D%3D%3D%20%22uint%22%29%20value%20%3D%200%3B%0A%20%20%20%20%20%20else%20if%20%28type%20%3D%3D%3D%20%22bool%22%29%20value%20%3D%20false%3B%0A%20%20%20%20%20%20else%20if%20%28type%20%3D%3D%3D%20%22color%22%29%20value%20%3D%20new%20Color2%28%29%3B%0A%20%20%20%20%20%20else%20if%20%28type%20%3D%3D%3D%20%22vec2%22%29%20value%20%3D%20new%20Vector22%28%29%3B%0A%20%20%20%20%20%20else%20if%20%28type%20%3D%3D%3D%20%22vec3%22%29%20value%20%3D%20new%20Vector32%28%29%3B%0A%20%20%20%20%20%20else%20if%20%28type%20%3D%3D%3D%20%22vec4%22%29%20value%20%3D%20new%20Vector42%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22float%22%29%20return%20toFloat%28value%29%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22int%22%29%20return%20%60%24%7BMath.round%28value%29%7D%60%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22uint%22%29%20return%20value%20%3E%3D%200%20%3F%20%60%24%7BMath.round%28value%29%7Du%60%20%3A%20%220u%22%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22bool%22%29%20return%20value%20%3F%20%22true%22%20%3A%20%22false%22%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22color%22%29%20return%20%60%24%7Bthis.getType%28%22vec3%22%29%7D%28%20%24%7BtoFloat%28value.r%29%7D%2C%20%24%7BtoFloat%28value.g%29%7D%2C%20%24%7BtoFloat%28value.b%29%7D%20%29%60%3B%0A%20%20%20%20const%20typeLength%20%3D%20this.getTypeLength%28type%29%3B%0A%20%20%20%20const%20componentType%20%3D%20this.getComponentType%28type%29%3B%0A%20%20%20%20const%20generateConst%20%3D%20%28value2%29%20%3D%3E%20this.generateConst%28componentType%2C%20value2%29%3B%0A%20%20%20%20if%20%28typeLength%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28type%29%7D%28%20%24%7BgenerateConst%28value.x%29%7D%2C%20%24%7BgenerateConst%28value.y%29%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20if%20%28typeLength%20%3D%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28type%29%7D%28%20%24%7BgenerateConst%28value.x%29%7D%2C%20%24%7BgenerateConst%28value.y%29%7D%2C%20%24%7BgenerateConst%28value.z%29%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20if%20%28typeLength%20%3D%3D%3D%204%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28type%29%7D%28%20%24%7BgenerateConst%28value.x%29%7D%2C%20%24%7BgenerateConst%28value.y%29%7D%2C%20%24%7BgenerateConst%28value.z%29%7D%2C%20%24%7BgenerateConst%28value.w%29%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20if%20%28typeLength%20%3E%204%20%26%26%20value%20%26%26%20%28value.isMatrix3%20%7C%7C%20value.isMatrix4%29%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28type%29%7D%28%20%24%7Bvalue.elements.map%28generateConst%29.join%28%22%2C%20%22%29%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20if%20%28typeLength%20%3E%204%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28type%29%7D%28%29%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20throw%20new%20Error%28%60NodeBuilder%3A%20Type%20%27%24%7Btype%7D%27%20not%20found%20in%20generate%20constant%20attempt.%60%29%3B%0A%20%20%7D%0A%20%20getType%28type%29%20%7B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22color%22%29%20return%20%22vec3%22%3B%0A%20%20%20%20return%20type%3B%0A%20%20%7D%0A%20%20hasGeometryAttribute%28name%29%20%7B%0A%20%20%20%20return%20this.geometry%20%26%26%20this.geometry.getAttribute%28name%29%20%21%3D%3D%20void%200%3B%0A%20%20%7D%0A%20%20getAttribute%28name%2C%20type%29%20%7B%0A%20%20%20%20const%20attributes%20%3D%20this.attributes%3B%0A%20%20%20%20for%20%28const%20attribute3%20of%20attributes%29%20%7B%0A%20%20%20%20%20%20if%20%28attribute3.name%20%3D%3D%3D%20name%29%20%7B%0A%20%20%20%20%20%20%20%20return%20attribute3%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20attribute2%20%3D%20new%20NodeAttribute%28name%2C%20type%29%3B%0A%20%20%20%20attributes.push%28attribute2%29%3B%0A%20%20%20%20return%20attribute2%3B%0A%20%20%7D%0A%20%20getPropertyName%28node%29%20%7B%0A%20%20%20%20return%20node.name%3B%0A%20%20%7D%0A%20%20isVector%28type%29%20%7B%0A%20%20%20%20return%20%2Fvec%5Cd%2F.test%28type%29%3B%0A%20%20%7D%0A%20%20isMatrix%28type%29%20%7B%0A%20%20%20%20return%20%2Fmat%5Cd%2F.test%28type%29%3B%0A%20%20%7D%0A%20%20isReference%28type%29%20%7B%0A%20%20%20%20return%20type%20%3D%3D%3D%20%22void%22%20%7C%7C%20type%20%3D%3D%3D%20%22property%22%20%7C%7C%20type%20%3D%3D%3D%20%22sampler%22%20%7C%7C%20type%20%3D%3D%3D%20%22texture%22%20%7C%7C%20type%20%3D%3D%3D%20%22cubeTexture%22%20%7C%7C%20type%20%3D%3D%3D%20%22storageTexture%22%20%7C%7C%20type%20%3D%3D%3D%20%22depthTexture%22%20%7C%7C%20type%20%3D%3D%3D%20%22texture3D%22%3B%0A%20%20%7D%0A%20%20needsToWorkingColorSpace%28%29%20%7B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20getComponentTypeFromTexture%28texture2%29%20%7B%0A%20%20%20%20const%20type%20%3D%20texture2.type%3B%0A%20%20%20%20if%20%28texture2.isDataTexture%29%20%7B%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20IntType2%29%20return%20%22int%22%3B%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20UnsignedIntType2%29%20return%20%22uint%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%22float%22%3B%0A%20%20%7D%0A%20%20getElementType%28type%29%20%7B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22mat2%22%29%20return%20%22vec2%22%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22mat3%22%29%20return%20%22vec3%22%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22mat4%22%29%20return%20%22vec4%22%3B%0A%20%20%20%20return%20this.getComponentType%28type%29%3B%0A%20%20%7D%0A%20%20getComponentType%28type%29%20%7B%0A%20%20%20%20type%20%3D%20this.getVectorType%28type%29%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22float%22%20%7C%7C%20type%20%3D%3D%3D%20%22bool%22%20%7C%7C%20type%20%3D%3D%3D%20%22int%22%20%7C%7C%20type%20%3D%3D%3D%20%22uint%22%29%20return%20type%3B%0A%20%20%20%20const%20componentType%20%3D%20%2F%28b%7Ci%7Cu%7C%29%28vec%7Cmat%29%28%5B2-4%5D%29%2F.exec%28type%29%3B%0A%20%20%20%20if%20%28componentType%20%3D%3D%3D%20null%29%20return%20null%3B%0A%20%20%20%20if%20%28componentType%5B1%5D%20%3D%3D%3D%20%22b%22%29%20return%20%22bool%22%3B%0A%20%20%20%20if%20%28componentType%5B1%5D%20%3D%3D%3D%20%22i%22%29%20return%20%22int%22%3B%0A%20%20%20%20if%20%28componentType%5B1%5D%20%3D%3D%3D%20%22u%22%29%20return%20%22uint%22%3B%0A%20%20%20%20return%20%22float%22%3B%0A%20%20%7D%0A%20%20getVectorType%28type%29%20%7B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22color%22%29%20return%20%22vec3%22%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22texture%22%20%7C%7C%20type%20%3D%3D%3D%20%22cubeTexture%22%20%7C%7C%20type%20%3D%3D%3D%20%22storageTexture%22%20%7C%7C%20type%20%3D%3D%3D%20%22texture3D%22%29%20return%20%22vec4%22%3B%0A%20%20%20%20return%20type%3B%0A%20%20%7D%0A%20%20getTypeFromLength%28length2%2C%20componentType%20%3D%20%22float%22%29%20%7B%0A%20%20%20%20if%20%28length2%20%3D%3D%3D%201%29%20return%20componentType%3B%0A%20%20%20%20const%20baseType%20%3D%20typeFromLength.get%28length2%29%3B%0A%20%20%20%20const%20prefix%20%3D%20componentType%20%3D%3D%3D%20%22float%22%20%3F%20%22%22%20%3A%20componentType%5B0%5D%3B%0A%20%20%20%20return%20prefix%20%2B%20baseType%3B%0A%20%20%7D%0A%20%20getTypeFromArray%28array%29%20%7B%0A%20%20%20%20return%20typeFromArray.get%28array.constructor%29%3B%0A%20%20%7D%0A%20%20getTypeFromAttribute%28attribute2%29%20%7B%0A%20%20%20%20let%20dataAttribute%20%3D%20attribute2%3B%0A%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20dataAttribute%20%3D%20attribute2.data%3B%0A%20%20%20%20const%20array%20%3D%20dataAttribute.array%3B%0A%20%20%20%20const%20itemSize%20%3D%20attribute2.itemSize%3B%0A%20%20%20%20const%20normalized%20%3D%20attribute2.normalized%3B%0A%20%20%20%20let%20arrayType%3B%0A%20%20%20%20if%20%28%21%28attribute2%20instanceof%20Float16BufferAttribute%29%20%26%26%20normalized%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20arrayType%20%3D%20this.getTypeFromArray%28array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.getTypeFromLength%28itemSize%2C%20arrayType%29%3B%0A%20%20%7D%0A%20%20getTypeLength%28type%29%20%7B%0A%20%20%20%20const%20vecType%20%3D%20this.getVectorType%28type%29%3B%0A%20%20%20%20const%20vecNum%20%3D%20%2Fvec%28%5B2-4%5D%29%2F.exec%28vecType%29%3B%0A%20%20%20%20if%20%28vecNum%20%21%3D%3D%20null%29%20return%20Number%28vecNum%5B1%5D%29%3B%0A%20%20%20%20if%20%28vecType%20%3D%3D%3D%20%22float%22%20%7C%7C%20vecType%20%3D%3D%3D%20%22bool%22%20%7C%7C%20vecType%20%3D%3D%3D%20%22int%22%20%7C%7C%20vecType%20%3D%3D%3D%20%22uint%22%29%20return%201%3B%0A%20%20%20%20if%20%28%2Fmat2%2F.test%28type%29%20%3D%3D%3D%20true%29%20return%204%3B%0A%20%20%20%20if%20%28%2Fmat3%2F.test%28type%29%20%3D%3D%3D%20true%29%20return%209%3B%0A%20%20%20%20if%20%28%2Fmat4%2F.test%28type%29%20%3D%3D%3D%20true%29%20return%2016%3B%0A%20%20%20%20return%200%3B%0A%20%20%7D%0A%20%20getVectorFromMatrix%28type%29%20%7B%0A%20%20%20%20return%20type.replace%28%22mat%22%2C%20%22vec%22%29%3B%0A%20%20%7D%0A%20%20changeComponentType%28type%2C%20newComponentType%29%20%7B%0A%20%20%20%20return%20this.getTypeFromLength%28this.getTypeLength%28type%29%2C%20newComponentType%29%3B%0A%20%20%7D%0A%20%20getIntegerType%28type%29%20%7B%0A%20%20%20%20const%20componentType%20%3D%20this.getComponentType%28type%29%3B%0A%20%20%20%20if%20%28componentType%20%3D%3D%3D%20%22int%22%20%7C%7C%20componentType%20%3D%3D%3D%20%22uint%22%29%20return%20type%3B%0A%20%20%20%20return%20this.changeComponentType%28type%2C%20%22int%22%29%3B%0A%20%20%7D%0A%20%20addStack%28%29%20%7B%0A%20%20%20%20this.stack%20%3D%20stack%28this.stack%29%3B%0A%20%20%20%20this.stacks.push%28getCurrentStack%28%29%20%7C%7C%20this.stack%29%3B%0A%20%20%20%20setCurrentStack%28this.stack%29%3B%0A%20%20%20%20return%20this.stack%3B%0A%20%20%7D%0A%20%20removeStack%28%29%20%7B%0A%20%20%20%20const%20lastStack%20%3D%20this.stack%3B%0A%20%20%20%20this.stack%20%3D%20lastStack.parent%3B%0A%20%20%20%20setCurrentStack%28this.stacks.pop%28%29%29%3B%0A%20%20%20%20return%20lastStack%3B%0A%20%20%7D%0A%20%20getDataFromNode%28node%2C%20shaderStage%20%3D%20this.shaderStage%2C%20cache2%20%3D%20null%29%20%7B%0A%20%20%20%20cache2%20%3D%20cache2%20%3D%3D%3D%20null%20%3F%20node.isGlobal%28this%29%20%3F%20this.globalCache%20%3A%20this.cache%20%3A%20cache2%3B%0A%20%20%20%20let%20nodeData%20%3D%20cache2.getData%28node%29%3B%0A%20%20%20%20if%20%28nodeData%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20nodeData%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20cache2.setData%28node%2C%20nodeData%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28nodeData%5BshaderStage%5D%20%3D%3D%3D%20void%200%29%20nodeData%5BshaderStage%5D%20%3D%20%7B%7D%3B%0A%20%20%20%20return%20nodeData%5BshaderStage%5D%3B%0A%20%20%7D%0A%20%20getNodeProperties%28node%2C%20shaderStage%20%3D%20%22any%22%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%2C%20shaderStage%29%3B%0A%20%20%20%20return%20nodeData.properties%20%7C%7C%20%28nodeData.properties%20%3D%20%7B%20outputNode%3A%20null%20%7D%29%3B%0A%20%20%7D%0A%20%20getBufferAttributeFromNode%28node%2C%20type%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%29%3B%0A%20%20%20%20let%20bufferAttribute2%20%3D%20nodeData.bufferAttribute%3B%0A%20%20%20%20if%20%28bufferAttribute2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20index5%20%3D%20this.uniforms.index%2B%2B%3B%0A%20%20%20%20%20%20bufferAttribute2%20%3D%20new%20NodeAttribute%28%22nodeAttribute%22%20%2B%20index5%2C%20type%2C%20node%29%3B%0A%20%20%20%20%20%20this.bufferAttributes.push%28bufferAttribute2%29%3B%0A%20%20%20%20%20%20nodeData.bufferAttribute%20%3D%20bufferAttribute2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20bufferAttribute2%3B%0A%20%20%7D%0A%20%20getStructTypeFromNode%28node%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%2C%20shaderStage%29%3B%0A%20%20%20%20if%20%28nodeData.structType%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20index5%20%3D%20this.structs.index%2B%2B%3B%0A%20%20%20%20%20%20node.name%20%3D%20%60StructType%24%7Bindex5%7D%60%3B%0A%20%20%20%20%20%20this.structs%5BshaderStage%5D.push%28node%29%3B%0A%20%20%20%20%20%20nodeData.structType%20%3D%20node%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%20%20getUniformFromNode%28node%2C%20type%2C%20shaderStage%20%3D%20this.shaderStage%2C%20name%20%3D%20null%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%2C%20shaderStage%2C%20this.globalCache%29%3B%0A%20%20%20%20let%20nodeUniform%20%3D%20nodeData.uniform%3B%0A%20%20%20%20if%20%28nodeUniform%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20index5%20%3D%20this.uniforms.index%2B%2B%3B%0A%20%20%20%20%20%20nodeUniform%20%3D%20new%20NodeUniform%28name%20%7C%7C%20%22nodeUniform%22%20%2B%20index5%2C%20type%2C%20node%29%3B%0A%20%20%20%20%20%20this.uniforms%5BshaderStage%5D.push%28nodeUniform%29%3B%0A%20%20%20%20%20%20nodeData.uniform%20%3D%20nodeUniform%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeUniform%3B%0A%20%20%7D%0A%20%20getVarFromNode%28node%2C%20name%20%3D%20null%2C%20type%20%3D%20node.getNodeType%28this%29%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%2C%20shaderStage%29%3B%0A%20%20%20%20let%20nodeVar%20%3D%20nodeData.variable%3B%0A%20%20%20%20if%20%28nodeVar%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20vars%20%3D%20this.vars%5BshaderStage%5D%20%7C%7C%20%28this.vars%5BshaderStage%5D%20%3D%20%5B%5D%29%3B%0A%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20null%29%20name%20%3D%20%22nodeVar%22%20%2B%20vars.length%3B%0A%20%20%20%20%20%20nodeVar%20%3D%20new%20NodeVar%28name%2C%20type%29%3B%0A%20%20%20%20%20%20vars.push%28nodeVar%29%3B%0A%20%20%20%20%20%20nodeData.variable%20%3D%20nodeVar%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeVar%3B%0A%20%20%7D%0A%20%20getVaryingFromNode%28node%2C%20name%20%3D%20null%2C%20type%20%3D%20node.getNodeType%28this%29%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%2C%20%22any%22%29%3B%0A%20%20%20%20let%20nodeVarying%20%3D%20nodeData.varying%3B%0A%20%20%20%20if%20%28nodeVarying%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20varyings%20%3D%20this.varyings%3B%0A%20%20%20%20%20%20const%20index5%20%3D%20varyings.length%3B%0A%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20null%29%20name%20%3D%20%22nodeVarying%22%20%2B%20index5%3B%0A%20%20%20%20%20%20nodeVarying%20%3D%20new%20NodeVarying%28name%2C%20type%29%3B%0A%20%20%20%20%20%20varyings.push%28nodeVarying%29%3B%0A%20%20%20%20%20%20nodeData.varying%20%3D%20nodeVarying%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeVarying%3B%0A%20%20%7D%0A%20%20getCodeFromNode%28node%2C%20type%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%29%3B%0A%20%20%20%20let%20nodeCode%20%3D%20nodeData.code%3B%0A%20%20%20%20if%20%28nodeCode%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20codes%20%3D%20this.codes%5BshaderStage%5D%20%7C%7C%20%28this.codes%5BshaderStage%5D%20%3D%20%5B%5D%29%3B%0A%20%20%20%20%20%20const%20index5%20%3D%20codes.length%3B%0A%20%20%20%20%20%20nodeCode%20%3D%20new%20NodeCode%28%22nodeCode%22%20%2B%20index5%2C%20type%29%3B%0A%20%20%20%20%20%20codes.push%28nodeCode%29%3B%0A%20%20%20%20%20%20nodeData.code%20%3D%20nodeCode%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeCode%3B%0A%20%20%7D%0A%20%20addFlowCodeHierarchy%28node%2C%20nodeBlock%29%20%7B%0A%20%20%20%20const%20%7B%20flowCodes%2C%20flowCodeBlock%20%7D%20%3D%20this.getDataFromNode%28node%29%3B%0A%20%20%20%20let%20needsFlowCode%20%3D%20true%3B%0A%20%20%20%20let%20nodeBlockHierarchy%20%3D%20nodeBlock%3B%0A%20%20%20%20while%20%28nodeBlockHierarchy%29%20%7B%0A%20%20%20%20%20%20if%20%28flowCodeBlock.get%28nodeBlockHierarchy%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20needsFlowCode%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20nodeBlockHierarchy%20%3D%20this.getDataFromNode%28nodeBlockHierarchy%29.parentNodeBlock%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28needsFlowCode%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20flowCode%20of%20flowCodes%29%20%7B%0A%20%20%20%20%20%20%20%20this.addLineFlowCode%28flowCode%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20addLineFlowCodeBlock%28node%2C%20code%2C%20nodeBlock%29%20%7B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%29%3B%0A%20%20%20%20const%20flowCodes%20%3D%20nodeData.flowCodes%20%7C%7C%20%28nodeData.flowCodes%20%3D%20%5B%5D%29%3B%0A%20%20%20%20const%20codeBlock%20%3D%20nodeData.flowCodeBlock%20%7C%7C%20%28nodeData.flowCodeBlock%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%29%3B%0A%20%20%20%20flowCodes.push%28code%29%3B%0A%20%20%20%20codeBlock.set%28nodeBlock%2C%20true%29%3B%0A%20%20%7D%0A%20%20addLineFlowCode%28code%2C%20node%20%3D%20null%29%20%7B%0A%20%20%20%20if%20%28code%20%3D%3D%3D%20%22%22%29%20return%20this%3B%0A%20%20%20%20if%20%28node%20%21%3D%3D%20null%20%26%26%20this.context.nodeBlock%29%20%7B%0A%20%20%20%20%20%20this.addLineFlowCodeBlock%28node%2C%20code%2C%20this.context.nodeBlock%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20code%20%3D%20this.tab%20%2B%20code%3B%0A%20%20%20%20if%20%28%21%2F%3B%5Cs%2A%24%2F.test%28code%29%29%20%7B%0A%20%20%20%20%20%20code%20%3D%20code%20%2B%20%22%3B%5Cn%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.flow.code%20%2B%3D%20code%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addFlowCode%28code%29%20%7B%0A%20%20%20%20this.flow.code%20%2B%3D%20code%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20addFlowTab%28%29%20%7B%0A%20%20%20%20this.tab%20%2B%3D%20%22%09%22%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20removeFlowTab%28%29%20%7B%0A%20%20%20%20this.tab%20%3D%20this.tab.slice%280%2C%20-1%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getFlowData%28node%29%20%7B%0A%20%20%20%20return%20this.flowsData.get%28node%29%3B%0A%20%20%7D%0A%20%20flowNode%28node%29%20%7B%0A%20%20%20%20const%20output2%20%3D%20node.getNodeType%28this%29%3B%0A%20%20%20%20const%20flowData%20%3D%20this.flowChildNode%28node%2C%20output2%29%3B%0A%20%20%20%20this.flowsData.set%28node%2C%20flowData%29%3B%0A%20%20%20%20return%20flowData%3B%0A%20%20%7D%0A%20%20buildFunctionNode%28shaderNode%29%20%7B%0A%20%20%20%20const%20fn%20%3D%20new%20FunctionNode%28%29%3B%0A%20%20%20%20const%20previous%20%3D%20this.currentFunctionNode%3B%0A%20%20%20%20this.currentFunctionNode%20%3D%20fn%3B%0A%20%20%20%20fn.code%20%3D%20this.buildFunctionCode%28shaderNode%29%3B%0A%20%20%20%20this.currentFunctionNode%20%3D%20previous%3B%0A%20%20%20%20return%20fn%3B%0A%20%20%7D%0A%20%20flowShaderNode%28shaderNode%29%20%7B%0A%20%20%20%20const%20layout%20%3D%20shaderNode.layout%3B%0A%20%20%20%20const%20inputs%20%3D%20%7B%0A%20%20%20%20%20%20%5BSymbol.iterator%5D%28%29%20%7B%0A%20%20%20%20%20%20%20%20let%20index5%20%3D%200%3B%0A%20%20%20%20%20%20%20%20const%20values%20%3D%20Object.values%28this%29%3B%0A%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20next%3A%20%28%29%20%3D%3E%20%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3A%20values%5Bindex5%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20done%3A%20index5%2B%2B%20%3E%3D%20values.length%0A%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20for%20%28const%20input%20of%20layout.inputs%29%20%7B%0A%20%20%20%20%20%20inputs%5Binput.name%5D%20%3D%20new%20ParameterNode%28input.type%2C%20input.name%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20shaderNode.layout%20%3D%20null%3B%0A%20%20%20%20const%20callNode%20%3D%20shaderNode.call%28inputs%29%3B%0A%20%20%20%20const%20flowData%20%3D%20this.flowStagesNode%28callNode%2C%20layout.type%29%3B%0A%20%20%20%20shaderNode.layout%20%3D%20layout%3B%0A%20%20%20%20return%20flowData%3B%0A%20%20%7D%0A%20%20flowStagesNode%28node%2C%20output2%20%3D%20null%29%20%7B%0A%20%20%20%20const%20previousFlow%20%3D%20this.flow%3B%0A%20%20%20%20const%20previousVars%20%3D%20this.vars%3B%0A%20%20%20%20const%20previousCache%20%3D%20this.cache%3B%0A%20%20%20%20const%20previousBuildStage%20%3D%20this.buildStage%3B%0A%20%20%20%20const%20previousStack%20%3D%20this.stack%3B%0A%20%20%20%20const%20flow%20%3D%20%7B%0A%20%20%20%20%20%20code%3A%20%22%22%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.flow%20%3D%20flow%3B%0A%20%20%20%20this.vars%20%3D%20%7B%7D%3B%0A%20%20%20%20this.cache%20%3D%20new%20NodeCache%28%29%3B%0A%20%20%20%20this.stack%20%3D%20stack%28%29%3B%0A%20%20%20%20for%20%28const%20buildStage%20of%20defaultBuildStages%29%20%7B%0A%20%20%20%20%20%20this.setBuildStage%28buildStage%29%3B%0A%20%20%20%20%20%20flow.result%20%3D%20node.build%28this%2C%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20flow.vars%20%3D%20this.getVars%28this.shaderStage%29%3B%0A%20%20%20%20this.flow%20%3D%20previousFlow%3B%0A%20%20%20%20this.vars%20%3D%20previousVars%3B%0A%20%20%20%20this.cache%20%3D%20previousCache%3B%0A%20%20%20%20this.stack%20%3D%20previousStack%3B%0A%20%20%20%20this.setBuildStage%28previousBuildStage%29%3B%0A%20%20%20%20return%20flow%3B%0A%20%20%7D%0A%20%20getFunctionOperator%28%29%20%7B%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%20%20flowChildNode%28node%2C%20output2%20%3D%20null%29%20%7B%0A%20%20%20%20const%20previousFlow%20%3D%20this.flow%3B%0A%20%20%20%20const%20flow%20%3D%20%7B%0A%20%20%20%20%20%20code%3A%20%22%22%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.flow%20%3D%20flow%3B%0A%20%20%20%20flow.result%20%3D%20node.build%28this%2C%20output2%29%3B%0A%20%20%20%20this.flow%20%3D%20previousFlow%3B%0A%20%20%20%20return%20flow%3B%0A%20%20%7D%0A%20%20flowNodeFromShaderStage%28shaderStage%2C%20node%2C%20output2%20%3D%20null%2C%20propertyName%20%3D%20null%29%20%7B%0A%20%20%20%20const%20previousShaderStage%20%3D%20this.shaderStage%3B%0A%20%20%20%20this.setShaderStage%28shaderStage%29%3B%0A%20%20%20%20const%20flowData%20%3D%20this.flowChildNode%28node%2C%20output2%29%3B%0A%20%20%20%20if%20%28propertyName%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20flowData.code%20%2B%3D%20%60%24%7Bthis.tab%20%2B%20propertyName%7D%20%3D%20%24%7BflowData.result%7D%3B%0A%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.flowCode%5BshaderStage%5D%20%3D%20this.flowCode%5BshaderStage%5D%20%2B%20flowData.code%3B%0A%20%20%20%20this.setShaderStage%28previousShaderStage%29%3B%0A%20%20%20%20return%20flowData%3B%0A%20%20%7D%0A%20%20getAttributesArray%28%29%20%7B%0A%20%20%20%20return%20this.attributes.concat%28this.bufferAttributes%29%3B%0A%20%20%7D%0A%20%20getAttributes%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20getVaryings%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20getVar%28type%2C%20name%29%20%7B%0A%20%20%20%20return%20%60%24%7Bthis.getType%28type%29%7D%20%24%7Bname%7D%60%3B%0A%20%20%7D%0A%20%20getVars%28shaderStage%29%20%7B%0A%20%20%20%20let%20snippet%20%3D%20%22%22%3B%0A%20%20%20%20const%20vars%20%3D%20this.vars%5BshaderStage%5D%3B%0A%20%20%20%20if%20%28vars%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20variable%20of%20vars%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%2B%3D%20%60%24%7Bthis.getVar%28variable.type%2C%20variable.name%29%7D%3B%20%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippet%3B%0A%20%20%7D%0A%20%20getUniforms%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20getCodes%28shaderStage%29%20%7B%0A%20%20%20%20const%20codes%20%3D%20this.codes%5BshaderStage%5D%3B%0A%20%20%20%20let%20code%20%3D%20%22%22%3B%0A%20%20%20%20if%20%28codes%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20nodeCode%20of%20codes%29%20%7B%0A%20%20%20%20%20%20%20%20code%20%2B%3D%20nodeCode.code%20%2B%20%22%5Cn%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20code%3B%0A%20%20%7D%0A%20%20getHash%28%29%20%7B%0A%20%20%20%20return%20this.vertexShader%20%2B%20this.fragmentShader%20%2B%20this.computeShader%3B%0A%20%20%7D%0A%20%20setShaderStage%28shaderStage%29%20%7B%0A%20%20%20%20this.shaderStage%20%3D%20shaderStage%3B%0A%20%20%7D%0A%20%20getShaderStage%28%29%20%7B%0A%20%20%20%20return%20this.shaderStage%3B%0A%20%20%7D%0A%20%20setBuildStage%28buildStage%29%20%7B%0A%20%20%20%20this.buildStage%20%3D%20buildStage%3B%0A%20%20%7D%0A%20%20getBuildStage%28%29%20%7B%0A%20%20%20%20return%20this.buildStage%3B%0A%20%20%7D%0A%20%20buildCode%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%20%20build%28%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20material%2C%20renderer%3A%20renderer3%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28material%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20let%20nodeMaterial%20%3D%20renderer3.library.fromMaterial%28material%29%3B%0A%20%20%20%20%20%20if%20%28nodeMaterial%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%60NodeMaterial%3A%20Material%20%22%24%7Bmaterial.type%7D%22%20is%20not%20compatible.%60%29%3B%0A%20%20%20%20%20%20%20%20nodeMaterial%20%3D%20new%20NodeMaterial%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20nodeMaterial.build%28this%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.addFlow%28%22compute%22%2C%20object%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28const%20buildStage%20of%20defaultBuildStages%29%20%7B%0A%20%20%20%20%20%20this.setBuildStage%28buildStage%29%3B%0A%20%20%20%20%20%20if%20%28this.context.vertex%20%26%26%20this.context.vertex.isNode%29%20%7B%0A%20%20%20%20%20%20%20%20this.flowNodeFromShaderStage%28%22vertex%22%2C%20this.context.vertex%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28const%20shaderStage%20of%20shaderStages%29%20%7B%0A%20%20%20%20%20%20%20%20this.setShaderStage%28shaderStage%29%3B%0A%20%20%20%20%20%20%20%20const%20flowNodes%20%3D%20this.flowNodes%5BshaderStage%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28const%20node%20of%20flowNodes%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28buildStage%20%3D%3D%3D%20%22generate%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.flowNode%28node%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20node.build%28this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.setBuildStage%28null%29%3B%0A%20%20%20%20this.setShaderStage%28null%29%3B%0A%20%20%20%20this.buildCode%28%29%3B%0A%20%20%20%20this.buildUpdateNodes%28%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getNodeUniform%28uniformNode%2C%20type%29%20%7B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22float%22%20%7C%7C%20type%20%3D%3D%3D%20%22int%22%20%7C%7C%20type%20%3D%3D%3D%20%22uint%22%29%20return%20new%20NumberNodeUniform%28uniformNode%29%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22vec2%22%20%7C%7C%20type%20%3D%3D%3D%20%22ivec2%22%20%7C%7C%20type%20%3D%3D%3D%20%22uvec2%22%29%20return%20new%20Vector2NodeUniform%28uniformNode%29%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22vec3%22%20%7C%7C%20type%20%3D%3D%3D%20%22ivec3%22%20%7C%7C%20type%20%3D%3D%3D%20%22uvec3%22%29%20return%20new%20Vector3NodeUniform%28uniformNode%29%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22vec4%22%20%7C%7C%20type%20%3D%3D%3D%20%22ivec4%22%20%7C%7C%20type%20%3D%3D%3D%20%22uvec4%22%29%20return%20new%20Vector4NodeUniform%28uniformNode%29%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22color%22%29%20return%20new%20ColorNodeUniform%28uniformNode%29%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22mat3%22%29%20return%20new%20Matrix3NodeUniform%28uniformNode%29%3B%0A%20%20%20%20if%20%28type%20%3D%3D%3D%20%22mat4%22%29%20return%20new%20Matrix4NodeUniform%28uniformNode%29%3B%0A%20%20%20%20throw%20new%20Error%28%60Uniform%20%22%24%7Btype%7D%22%20not%20declared.%60%29%3B%0A%20%20%7D%0A%20%20createNodeMaterial%28type%20%3D%20%22NodeMaterial%22%29%20%7B%0A%20%20%20%20throw%20new%20Error%28%60THREE.NodeBuilder%3A%20createNodeMaterial%28%29%20was%20deprecated.%20Use%20new%20%24%7Btype%7D%28%29%20instead.%60%29%3B%0A%20%20%7D%0A%20%20format%28snippet%2C%20fromType%2C%20toType%29%20%7B%0A%20%20%20%20fromType%20%3D%20this.getVectorType%28fromType%29%3B%0A%20%20%20%20toType%20%3D%20this.getVectorType%28toType%29%3B%0A%20%20%20%20if%20%28fromType%20%3D%3D%3D%20toType%20%7C%7C%20toType%20%3D%3D%3D%20null%20%7C%7C%20this.isReference%28toType%29%29%20%7B%0A%20%20%20%20%20%20return%20snippet%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20fromTypeLength%20%3D%20this.getTypeLength%28fromType%29%3B%0A%20%20%20%20const%20toTypeLength%20%3D%20this.getTypeLength%28toType%29%3B%0A%20%20%20%20if%20%28fromTypeLength%20%3D%3D%3D%2016%20%26%26%20toTypeLength%20%3D%3D%3D%209%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28toType%29%7D%28%24%7Bsnippet%7D%5B0%5D.xyz%2C%20%24%7Bsnippet%7D%5B1%5D.xyz%2C%20%24%7Bsnippet%7D%5B2%5D.xyz%29%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28fromTypeLength%20%3D%3D%3D%209%20%26%26%20toTypeLength%20%3D%3D%3D%204%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28toType%29%7D%28%24%7Bsnippet%7D%5B0%5D.xy%2C%20%24%7Bsnippet%7D%5B1%5D.xy%29%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28fromTypeLength%20%3E%204%29%20%7B%0A%20%20%20%20%20%20return%20snippet%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28toTypeLength%20%3E%204%20%7C%7C%20toTypeLength%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20return%20snippet%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28fromTypeLength%20%3D%3D%3D%20toTypeLength%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28toType%29%7D%28%20%24%7Bsnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28fromTypeLength%20%3E%20toTypeLength%29%20%7B%0A%20%20%20%20%20%20return%20this.format%28%60%24%7Bsnippet%7D.%24%7B%22xyz%22.slice%280%2C%20toTypeLength%29%7D%60%2C%20this.getTypeFromLength%28toTypeLength%2C%20this.getComponentType%28fromType%29%29%2C%20toType%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28toTypeLength%20%3D%3D%3D%204%20%26%26%20fromTypeLength%20%3E%201%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28toType%29%7D%28%20%24%7Bthis.format%28snippet%2C%20fromType%2C%20%22vec3%22%29%7D%2C%201.0%20%29%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28fromTypeLength%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20return%20%60%24%7Bthis.getType%28toType%29%7D%28%20%24%7Bthis.format%28snippet%2C%20fromType%2C%20%22vec2%22%29%7D%2C%200.0%20%29%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28fromTypeLength%20%3D%3D%3D%201%20%26%26%20toTypeLength%20%3E%201%20%26%26%20fromType%20%21%3D%3D%20this.getComponentType%28toType%29%29%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20%60%24%7Bthis.getType%28this.getComponentType%28toType%29%29%7D%28%20%24%7Bsnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%60%24%7Bthis.getType%28toType%29%7D%28%20%24%7Bsnippet%7D%20%29%60%3B%0A%20%20%7D%0A%20%20getSignature%28%29%20%7B%0A%20%20%20%20return%20%60%2F%2F%20Three.js%20r%24%7BREVISION2%7D%20-%20Node%20System%0A%60%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeFrame%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.time%20%3D%200%3B%0A%20%20%20%20this.deltaTime%20%3D%200%3B%0A%20%20%20%20this.frameId%20%3D%200%3B%0A%20%20%20%20this.renderId%20%3D%200%3B%0A%20%20%20%20this.startTime%20%3D%20null%3B%0A%20%20%20%20this.updateMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.updateBeforeMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.updateAfterMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.renderer%20%3D%20null%3B%0A%20%20%20%20this.material%20%3D%20null%3B%0A%20%20%20%20this.camera%20%3D%20null%3B%0A%20%20%20%20this.object%20%3D%20null%3B%0A%20%20%20%20this.scene%20%3D%20null%3B%0A%20%20%7D%0A%20%20_getMaps%28referenceMap%2C%20nodeRef%29%20%7B%0A%20%20%20%20let%20maps%20%3D%20referenceMap.get%28nodeRef%29%3B%0A%20%20%20%20if%20%28maps%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20maps%20%3D%20%7B%0A%20%20%20%20%20%20%20%20renderMap%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%2C%0A%20%20%20%20%20%20%20%20frameMap%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20referenceMap.set%28nodeRef%2C%20maps%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20maps%3B%0A%20%20%7D%0A%20%20updateBeforeNode%28node%29%20%7B%0A%20%20%20%20const%20updateType%20%3D%20node.getUpdateBeforeType%28%29%3B%0A%20%20%20%20const%20reference2%20%3D%20node.updateReference%28this%29%3B%0A%20%20%20%20if%20%28updateType%20%3D%3D%3D%20NodeUpdateType.FRAME%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20frameMap%20%7D%20%3D%20this._getMaps%28this.updateBeforeMap%2C%20reference2%29%3B%0A%20%20%20%20%20%20if%20%28frameMap.get%28reference2%29%20%21%3D%3D%20this.frameId%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28node.updateBefore%28this%29%20%21%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20frameMap.set%28reference2%2C%20this.frameId%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28updateType%20%3D%3D%3D%20NodeUpdateType.RENDER%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20renderMap%20%7D%20%3D%20this._getMaps%28this.updateBeforeMap%2C%20reference2%29%3B%0A%20%20%20%20%20%20if%20%28renderMap.get%28reference2%29%20%21%3D%3D%20this.renderId%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28node.updateBefore%28this%29%20%21%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderMap.set%28reference2%2C%20this.renderId%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28updateType%20%3D%3D%3D%20NodeUpdateType.OBJECT%29%20%7B%0A%20%20%20%20%20%20node.updateBefore%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateAfterNode%28node%29%20%7B%0A%20%20%20%20const%20updateType%20%3D%20node.getUpdateAfterType%28%29%3B%0A%20%20%20%20const%20reference2%20%3D%20node.updateReference%28this%29%3B%0A%20%20%20%20if%20%28updateType%20%3D%3D%3D%20NodeUpdateType.FRAME%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20frameMap%20%7D%20%3D%20this._getMaps%28this.updateAfterMap%2C%20reference2%29%3B%0A%20%20%20%20%20%20if%20%28frameMap.get%28reference2%29%20%21%3D%3D%20this.frameId%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28node.updateAfter%28this%29%20%21%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20frameMap.set%28reference2%2C%20this.frameId%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28updateType%20%3D%3D%3D%20NodeUpdateType.RENDER%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20renderMap%20%7D%20%3D%20this._getMaps%28this.updateAfterMap%2C%20reference2%29%3B%0A%20%20%20%20%20%20if%20%28renderMap.get%28reference2%29%20%21%3D%3D%20this.renderId%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28node.updateAfter%28this%29%20%21%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderMap.set%28reference2%2C%20this.renderId%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28updateType%20%3D%3D%3D%20NodeUpdateType.OBJECT%29%20%7B%0A%20%20%20%20%20%20node.updateAfter%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateNode%28node%29%20%7B%0A%20%20%20%20const%20updateType%20%3D%20node.getUpdateType%28%29%3B%0A%20%20%20%20const%20reference2%20%3D%20node.updateReference%28this%29%3B%0A%20%20%20%20if%20%28updateType%20%3D%3D%3D%20NodeUpdateType.FRAME%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20frameMap%20%7D%20%3D%20this._getMaps%28this.updateMap%2C%20reference2%29%3B%0A%20%20%20%20%20%20if%20%28frameMap.get%28reference2%29%20%21%3D%3D%20this.frameId%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28node.update%28this%29%20%21%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20frameMap.set%28reference2%2C%20this.frameId%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28updateType%20%3D%3D%3D%20NodeUpdateType.RENDER%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20renderMap%20%7D%20%3D%20this._getMaps%28this.updateMap%2C%20reference2%29%3B%0A%20%20%20%20%20%20if%20%28renderMap.get%28reference2%29%20%21%3D%3D%20this.renderId%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28node.update%28this%29%20%21%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderMap.set%28reference2%2C%20this.renderId%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28updateType%20%3D%3D%3D%20NodeUpdateType.OBJECT%29%20%7B%0A%20%20%20%20%20%20node.update%28this%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20this.frameId%2B%2B%3B%0A%20%20%20%20if%20%28this.lastTime%20%3D%3D%3D%20void%200%29%20this.lastTime%20%3D%20performance.now%28%29%3B%0A%20%20%20%20this.deltaTime%20%3D%20%28performance.now%28%29%20-%20this.lastTime%29%20%2F%201e3%3B%0A%20%20%20%20this.lastTime%20%3D%20performance.now%28%29%3B%0A%20%20%20%20this.time%20%2B%3D%20this.deltaTime%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeFunctionInput%20%3D%20class%20%7B%0A%20%20constructor%28type%2C%20name%2C%20count%20%3D%20null%2C%20qualifier%20%3D%20%22%22%2C%20isConst%20%3D%20false%29%20%7B%0A%20%20%20%20this.type%20%3D%20type%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.count%20%3D%20count%3B%0A%20%20%20%20this.qualifier%20%3D%20qualifier%3B%0A%20%20%20%20this.isConst%20%3D%20isConst%3B%0A%20%20%7D%0A%7D%3B%0ANodeFunctionInput.isNodeFunctionInput%20%3D%20true%3B%0Avar%20DirectionalLightNode%20%3D%20class%20extends%20AnalyticLightNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22DirectionalLightNode%22%3B%0A%20%20%7D%0A%20%20constructor%28light%20%3D%20null%29%20%7B%0A%20%20%20%20super%28light%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20super.setup%28builder%29%3B%0A%20%20%20%20const%20lightingModel%20%3D%20builder.context.lightingModel%3B%0A%20%20%20%20const%20lightColor%20%3D%20this.colorNode%3B%0A%20%20%20%20const%20lightDirection%20%3D%20lightTargetDirection%28this.light%29%3B%0A%20%20%20%20const%20reflectedLight%20%3D%20builder.context.reflectedLight%3B%0A%20%20%20%20lightingModel.direct%28%7B%0A%20%20%20%20%20%20lightDirection%2C%0A%20%20%20%20%20%20lightColor%2C%0A%20%20%20%20%20%20reflectedLight%0A%20%20%20%20%7D%2C%20builder.stack%2C%20builder%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_matrix41%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20_matrix42%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20ltcLib%20%3D%20null%3B%0Avar%20RectAreaLightNode%20%3D%20class%20extends%20AnalyticLightNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22RectAreaLightNode%22%3B%0A%20%20%7D%0A%20%20constructor%28light%20%3D%20null%29%20%7B%0A%20%20%20%20super%28light%29%3B%0A%20%20%20%20this.halfHeight%20%3D%20uniform%28new%20Vector32%28%29%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20this.halfWidth%20%3D%20uniform%28new%20Vector32%28%29%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20this.updateType%20%3D%20NodeUpdateType.RENDER%3B%0A%20%20%7D%0A%20%20update%28frame2%29%20%7B%0A%20%20%20%20super.update%28frame2%29%3B%0A%20%20%20%20const%20%7B%20light%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20viewMatrix%20%3D%20frame2.camera.matrixWorldInverse%3B%0A%20%20%20%20_matrix42.identity%28%29%3B%0A%20%20%20%20_matrix41.copy%28light.matrixWorld%29%3B%0A%20%20%20%20_matrix41.premultiply%28viewMatrix%29%3B%0A%20%20%20%20_matrix42.extractRotation%28_matrix41%29%3B%0A%20%20%20%20this.halfWidth.value.set%28light.width%20%2A%200.5%2C%200%2C%200%29%3B%0A%20%20%20%20this.halfHeight.value.set%280%2C%20light.height%20%2A%200.5%2C%200%29%3B%0A%20%20%20%20this.halfWidth.value.applyMatrix4%28_matrix42%29%3B%0A%20%20%20%20this.halfHeight.value.applyMatrix4%28_matrix42%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20super.setup%28builder%29%3B%0A%20%20%20%20let%20ltc_1%2C%20ltc_2%3B%0A%20%20%20%20if%20%28builder.isAvailable%28%22float32Filterable%22%29%29%20%7B%0A%20%20%20%20%20%20ltc_1%20%3D%20texture%28ltcLib.LTC_FLOAT_1%29%3B%0A%20%20%20%20%20%20ltc_2%20%3D%20texture%28ltcLib.LTC_FLOAT_2%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20ltc_1%20%3D%20texture%28ltcLib.LTC_HALF_1%29%3B%0A%20%20%20%20%20%20ltc_2%20%3D%20texture%28ltcLib.LTC_HALF_2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20%7B%20colorNode%2C%20light%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20lightingModel%20%3D%20builder.context.lightingModel%3B%0A%20%20%20%20const%20lightPosition2%20%3D%20lightViewPosition%28light%29%3B%0A%20%20%20%20const%20reflectedLight%20%3D%20builder.context.reflectedLight%3B%0A%20%20%20%20lightingModel.directRectArea%28%7B%0A%20%20%20%20%20%20lightColor%3A%20colorNode%2C%0A%20%20%20%20%20%20lightPosition%3A%20lightPosition2%2C%0A%20%20%20%20%20%20halfWidth%3A%20this.halfWidth%2C%0A%20%20%20%20%20%20halfHeight%3A%20this.halfHeight%2C%0A%20%20%20%20%20%20reflectedLight%2C%0A%20%20%20%20%20%20ltc_1%2C%0A%20%20%20%20%20%20ltc_2%0A%20%20%20%20%7D%2C%20builder.stack%2C%20builder%29%3B%0A%20%20%7D%0A%20%20static%20setLTC%28ltc%29%20%7B%0A%20%20%20%20ltcLib%20%3D%20ltc%3B%0A%20%20%7D%0A%7D%3B%0Avar%20SpotLightNode%20%3D%20class%20extends%20AnalyticLightNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22SpotLightNode%22%3B%0A%20%20%7D%0A%20%20constructor%28light%20%3D%20null%29%20%7B%0A%20%20%20%20super%28light%29%3B%0A%20%20%20%20this.coneCosNode%20%3D%20uniform%280%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20this.penumbraCosNode%20%3D%20uniform%280%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20this.cutoffDistanceNode%20%3D%20uniform%280%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20this.decayExponentNode%20%3D%20uniform%280%29.setGroup%28renderGroup%29%3B%0A%20%20%7D%0A%20%20update%28frame2%29%20%7B%0A%20%20%20%20super.update%28frame2%29%3B%0A%20%20%20%20const%20%7B%20light%20%7D%20%3D%20this%3B%0A%20%20%20%20this.coneCosNode.value%20%3D%20Math.cos%28light.angle%29%3B%0A%20%20%20%20this.penumbraCosNode.value%20%3D%20Math.cos%28light.angle%20%2A%20%281%20-%20light.penumbra%29%29%3B%0A%20%20%20%20this.cutoffDistanceNode.value%20%3D%20light.distance%3B%0A%20%20%20%20this.decayExponentNode.value%20%3D%20light.decay%3B%0A%20%20%7D%0A%20%20getSpotAttenuation%28angleCosine%29%20%7B%0A%20%20%20%20const%20%7B%20coneCosNode%2C%20penumbraCosNode%20%7D%20%3D%20this%3B%0A%20%20%20%20return%20smoothstep2%28coneCosNode%2C%20penumbraCosNode%2C%20angleCosine%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20super.setup%28builder%29%3B%0A%20%20%20%20const%20lightingModel%20%3D%20builder.context.lightingModel%3B%0A%20%20%20%20const%20%7B%20colorNode%2C%20cutoffDistanceNode%2C%20decayExponentNode%2C%20light%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20lVector%20%3D%20lightViewPosition%28light%29.sub%28positionView%29%3B%0A%20%20%20%20const%20lightDirection%20%3D%20lVector.normalize%28%29%3B%0A%20%20%20%20const%20angleCos%20%3D%20lightDirection.dot%28lightTargetDirection%28light%29%29%3B%0A%20%20%20%20const%20spotAttenuation%20%3D%20this.getSpotAttenuation%28angleCos%29%3B%0A%20%20%20%20const%20lightDistance%20%3D%20lVector.length%28%29%3B%0A%20%20%20%20const%20lightAttenuation%20%3D%20getDistanceAttenuation%28%7B%0A%20%20%20%20%20%20lightDistance%2C%0A%20%20%20%20%20%20cutoffDistance%3A%20cutoffDistanceNode%2C%0A%20%20%20%20%20%20decayExponent%3A%20decayExponentNode%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20lightColor%20%3D%20colorNode.mul%28spotAttenuation%29.mul%28lightAttenuation%29%3B%0A%20%20%20%20const%20reflectedLight%20%3D%20builder.context.reflectedLight%3B%0A%20%20%20%20lightingModel.direct%28%7B%0A%20%20%20%20%20%20lightDirection%2C%0A%20%20%20%20%20%20lightColor%2C%0A%20%20%20%20%20%20reflectedLight%0A%20%20%20%20%7D%2C%20builder.stack%2C%20builder%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20IESSpotLightNode%20%3D%20class%20extends%20SpotLightNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22IESSpotLightNode%22%3B%0A%20%20%7D%0A%20%20getSpotAttenuation%28angleCosine%29%20%7B%0A%20%20%20%20const%20iesMap%20%3D%20this.light.iesMap%3B%0A%20%20%20%20let%20spotAttenuation%20%3D%20null%3B%0A%20%20%20%20if%20%28iesMap%20%26%26%20iesMap.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20angle%20%3D%20angleCosine.acos%28%29.mul%281%20%2F%20Math.PI%29%3B%0A%20%20%20%20%20%20spotAttenuation%20%3D%20texture%28iesMap%2C%20vec2%28angle%2C%200%29%2C%200%29.r%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20spotAttenuation%20%3D%20super.getSpotAttenuation%28angleCosine%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20spotAttenuation%3B%0A%20%20%7D%0A%7D%3B%0Avar%20AmbientLightNode%20%3D%20class%20extends%20AnalyticLightNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22AmbientLightNode%22%3B%0A%20%20%7D%0A%20%20constructor%28light%20%3D%20null%29%20%7B%0A%20%20%20%20super%28light%29%3B%0A%20%20%7D%0A%20%20setup%28%7B%20context%3A%20context2%20%7D%29%20%7B%0A%20%20%20%20context2.irradiance.addAssign%28this.colorNode%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20HemisphereLightNode%20%3D%20class%20extends%20AnalyticLightNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22HemisphereLightNode%22%3B%0A%20%20%7D%0A%20%20constructor%28light%20%3D%20null%29%20%7B%0A%20%20%20%20super%28light%29%3B%0A%20%20%20%20this.lightPositionNode%20%3D%20lightPosition%28light%29%3B%0A%20%20%20%20this.lightDirectionNode%20%3D%20this.lightPositionNode.normalize%28%29%3B%0A%20%20%20%20this.groundColorNode%20%3D%20uniform%28new%20Color2%28%29%29.setGroup%28renderGroup%29%3B%0A%20%20%7D%0A%20%20update%28frame2%29%20%7B%0A%20%20%20%20const%20%7B%20light%20%7D%20%3D%20this%3B%0A%20%20%20%20super.update%28frame2%29%3B%0A%20%20%20%20this.lightPositionNode.object3d%20%3D%20light%3B%0A%20%20%20%20this.groundColorNode.value.copy%28light.groundColor%29.multiplyScalar%28light.intensity%29%3B%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20%7B%20colorNode%2C%20groundColorNode%2C%20lightDirectionNode%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20dotNL%20%3D%20normalView.dot%28lightDirectionNode%29%3B%0A%20%20%20%20const%20hemiDiffuseWeight%20%3D%20dotNL.mul%280.5%29.add%280.5%29%3B%0A%20%20%20%20const%20irradiance%20%3D%20mix%28groundColorNode%2C%20colorNode%2C%20hemiDiffuseWeight%29%3B%0A%20%20%20%20builder.context.irradiance.addAssign%28irradiance%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20LightProbeNode%20%3D%20class%20extends%20AnalyticLightNode%20%7B%0A%20%20static%20get%20type%28%29%20%7B%0A%20%20%20%20return%20%22LightProbeNode%22%3B%0A%20%20%7D%0A%20%20constructor%28light%20%3D%20null%29%20%7B%0A%20%20%20%20super%28light%29%3B%0A%20%20%20%20const%20array%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20array.push%28new%20Vector32%28%29%29%3B%0A%20%20%20%20this.lightProbe%20%3D%20uniformArray%28array%29%3B%0A%20%20%7D%0A%20%20update%28frame2%29%20%7B%0A%20%20%20%20const%20%7B%20light%20%7D%20%3D%20this%3B%0A%20%20%20%20super.update%28frame2%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%209%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.lightProbe.array%5Bi%5D.copy%28light.sh.coefficients%5Bi%5D%29.multiplyScalar%28light.intensity%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setup%28builder%29%20%7B%0A%20%20%20%20const%20irradiance%20%3D%20getShIrradianceAt%28normalWorld%2C%20this.lightProbe%29%3B%0A%20%20%20%20builder.context.irradiance.addAssign%28irradiance%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeParser%20%3D%20class%20%7B%0A%20%20parseFunction%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeFunction%20%3D%20class%20%7B%0A%20%20constructor%28type%2C%20inputs%2C%20name%20%3D%20%22%22%2C%20precision%20%3D%20%22%22%29%20%7B%0A%20%20%20%20this.type%20%3D%20type%3B%0A%20%20%20%20this.inputs%20%3D%20inputs%3B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.precision%20%3D%20precision%3B%0A%20%20%7D%0A%20%20getCode%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20function.%22%29%3B%0A%20%20%7D%0A%7D%3B%0ANodeFunction.isNodeFunction%20%3D%20true%3B%0Avar%20declarationRegexp%241%20%3D%20%2F%5E%5Cs%2A%28highp%7Cmediump%7Clowp%29%3F%5Cs%2A%28%5Ba-z_0-9%5D%2B%29%5Cs%2A%28%5Ba-z_0-9%5D%2B%29%3F%5Cs%2A%5C%28%28%5B%5Cs%5CS%5D%2A%3F%29%5C%29%2Fi%3B%0Avar%20propertiesRegexp%241%20%3D%20%2F%5Ba-z_0-9%5D%2B%2Fig%3B%0Avar%20pragmaMain%20%3D%20%22%23pragma%20main%22%3B%0Avar%20parse%241%20%3D%20%28source%29%20%3D%3E%20%7B%0A%20%20source%20%3D%20source.trim%28%29%3B%0A%20%20const%20pragmaMainIndex%20%3D%20source.indexOf%28pragmaMain%29%3B%0A%20%20const%20mainCode%20%3D%20pragmaMainIndex%20%21%3D%3D%20-1%20%3F%20source.slice%28pragmaMainIndex%20%2B%20pragmaMain.length%29%20%3A%20source%3B%0A%20%20const%20declaration%20%3D%20mainCode.match%28declarationRegexp%241%29%3B%0A%20%20if%20%28declaration%20%21%3D%3D%20null%20%26%26%20declaration.length%20%3D%3D%3D%205%29%20%7B%0A%20%20%20%20const%20inputsCode%20%3D%20declaration%5B4%5D%3B%0A%20%20%20%20const%20propsMatches%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20nameMatch%20%3D%20null%3B%0A%20%20%20%20while%20%28%28nameMatch%20%3D%20propertiesRegexp%241.exec%28inputsCode%29%29%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20propsMatches.push%28nameMatch%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20inputs%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20i%20%3D%200%3B%0A%20%20%20%20while%20%28i%20%3C%20propsMatches.length%29%20%7B%0A%20%20%20%20%20%20const%20isConst%20%3D%20propsMatches%5Bi%5D%5B0%5D%20%3D%3D%3D%20%22const%22%3B%0A%20%20%20%20%20%20if%20%28isConst%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20i%2B%2B%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20qualifier%20%3D%20propsMatches%5Bi%5D%5B0%5D%3B%0A%20%20%20%20%20%20if%20%28qualifier%20%3D%3D%3D%20%22in%22%20%7C%7C%20qualifier%20%3D%3D%3D%20%22out%22%20%7C%7C%20qualifier%20%3D%3D%3D%20%22inout%22%29%20%7B%0A%20%20%20%20%20%20%20%20i%2B%2B%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20qualifier%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20type2%20%3D%20propsMatches%5Bi%2B%2B%5D%5B0%5D%3B%0A%20%20%20%20%20%20let%20count%20%3D%20Number.parseInt%28propsMatches%5Bi%5D%5B0%5D%29%3B%0A%20%20%20%20%20%20if%20%28Number.isNaN%28count%29%20%3D%3D%3D%20false%29%20i%2B%2B%3B%0A%20%20%20%20%20%20else%20count%20%3D%20null%3B%0A%20%20%20%20%20%20const%20name2%20%3D%20propsMatches%5Bi%2B%2B%5D%5B0%5D%3B%0A%20%20%20%20%20%20inputs.push%28new%20NodeFunctionInput%28type2%2C%20name2%2C%20count%2C%20qualifier%2C%20isConst%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20blockCode%20%3D%20mainCode.substring%28declaration%5B0%5D.length%29%3B%0A%20%20%20%20const%20name%20%3D%20declaration%5B3%5D%20%21%3D%3D%20void%200%20%3F%20declaration%5B3%5D%20%3A%20%22%22%3B%0A%20%20%20%20const%20type%20%3D%20declaration%5B2%5D%3B%0A%20%20%20%20const%20precision%20%3D%20declaration%5B1%5D%20%21%3D%3D%20void%200%20%3F%20declaration%5B1%5D%20%3A%20%22%22%3B%0A%20%20%20%20const%20headerCode%20%3D%20pragmaMainIndex%20%21%3D%3D%20-1%20%3F%20source.slice%280%2C%20pragmaMainIndex%29%20%3A%20%22%22%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20type%2C%0A%20%20%20%20%20%20inputs%2C%0A%20%20%20%20%20%20name%2C%0A%20%20%20%20%20%20precision%2C%0A%20%20%20%20%20%20inputsCode%2C%0A%20%20%20%20%20%20blockCode%2C%0A%20%20%20%20%20%20headerCode%0A%20%20%20%20%7D%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20throw%20new%20Error%28%22FunctionNode%3A%20Function%20is%20not%20a%20GLSL%20code.%22%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20GLSLNodeFunction%20%3D%20class%20extends%20NodeFunction%20%7B%0A%20%20constructor%28source%29%20%7B%0A%20%20%20%20const%20%7B%20type%2C%20inputs%2C%20name%2C%20precision%2C%20inputsCode%2C%20blockCode%2C%20headerCode%20%7D%20%3D%20parse%241%28source%29%3B%0A%20%20%20%20super%28type%2C%20inputs%2C%20name%2C%20precision%29%3B%0A%20%20%20%20this.inputsCode%20%3D%20inputsCode%3B%0A%20%20%20%20this.blockCode%20%3D%20blockCode%3B%0A%20%20%20%20this.headerCode%20%3D%20headerCode%3B%0A%20%20%7D%0A%20%20getCode%28name%20%3D%20this.name%29%20%7B%0A%20%20%20%20let%20code%3B%0A%20%20%20%20const%20blockCode%20%3D%20this.blockCode%3B%0A%20%20%20%20if%20%28blockCode%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20type%2C%20inputsCode%2C%20headerCode%2C%20precision%20%7D%20%3D%20this%3B%0A%20%20%20%20%20%20let%20declarationCode%20%3D%20%60%24%7Btype%7D%20%24%7Bname%7D%20%28%20%24%7BinputsCode.trim%28%29%7D%20%29%60%3B%0A%20%20%20%20%20%20if%20%28precision%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20%20%20declarationCode%20%3D%20%60%24%7Bprecision%7D%20%24%7BdeclarationCode%7D%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20code%20%3D%20headerCode%20%2B%20declarationCode%20%2B%20blockCode%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20code%20%3D%20%22%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20code%3B%0A%20%20%7D%0A%7D%3B%0Avar%20GLSLNodeParser%20%3D%20class%20extends%20NodeParser%20%7B%0A%20%20parseFunction%28source%29%20%7B%0A%20%20%20%20return%20new%20GLSLNodeFunction%28source%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20outputNodeMap%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0Avar%20Nodes%20%3D%20class%20extends%20DataMap%20%7B%0A%20%20constructor%28renderer3%2C%20backend%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.renderer%20%3D%20renderer3%3B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.nodeFrame%20%3D%20new%20NodeFrame%28%29%3B%0A%20%20%20%20this.nodeBuilderCache%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20this.callHashCache%20%3D%20new%20ChainMap%28%29%3B%0A%20%20%20%20this.groupsData%20%3D%20new%20ChainMap%28%29%3B%0A%20%20%7D%0A%20%20updateGroup%28nodeUniformsGroup%29%20%7B%0A%20%20%20%20const%20groupNode%20%3D%20nodeUniformsGroup.groupNode%3B%0A%20%20%20%20const%20name%20%3D%20groupNode.name%3B%0A%20%20%20%20if%20%28name%20%3D%3D%3D%20objectGroup.name%29%20return%20true%3B%0A%20%20%20%20if%20%28name%20%3D%3D%3D%20renderGroup.name%29%20%7B%0A%20%20%20%20%20%20const%20uniformsGroupData%20%3D%20this.get%28nodeUniformsGroup%29%3B%0A%20%20%20%20%20%20const%20renderId%20%3D%20this.nodeFrame.renderId%3B%0A%20%20%20%20%20%20if%20%28uniformsGroupData.renderId%20%21%3D%3D%20renderId%29%20%7B%0A%20%20%20%20%20%20%20%20uniformsGroupData.renderId%20%3D%20renderId%3B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28name%20%3D%3D%3D%20frameGroup.name%29%20%7B%0A%20%20%20%20%20%20const%20uniformsGroupData%20%3D%20this.get%28nodeUniformsGroup%29%3B%0A%20%20%20%20%20%20const%20frameId%20%3D%20this.nodeFrame.frameId%3B%0A%20%20%20%20%20%20if%20%28uniformsGroupData.frameId%20%21%3D%3D%20frameId%29%20%7B%0A%20%20%20%20%20%20%20%20uniformsGroupData.frameId%20%3D%20frameId%3B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20groupChain%20%3D%20%5BgroupNode%2C%20nodeUniformsGroup%5D%3B%0A%20%20%20%20let%20groupData%20%3D%20this.groupsData.get%28groupChain%29%3B%0A%20%20%20%20if%20%28groupData%20%3D%3D%3D%20void%200%29%20this.groupsData.set%28groupChain%2C%20groupData%20%3D%20%7B%7D%29%3B%0A%20%20%20%20if%20%28groupData.version%20%21%3D%3D%20groupNode.version%29%20%7B%0A%20%20%20%20%20%20groupData.version%20%3D%20groupNode.version%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20getForRenderCacheKey%28renderObject%29%20%7B%0A%20%20%20%20return%20renderObject.initialCacheKey%3B%0A%20%20%7D%0A%20%20getForRender%28renderObject%29%20%7B%0A%20%20%20%20const%20renderObjectData%20%3D%20this.get%28renderObject%29%3B%0A%20%20%20%20let%20nodeBuilderState%20%3D%20renderObjectData.nodeBuilderState%3B%0A%20%20%20%20if%20%28nodeBuilderState%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20nodeBuilderCache%20%7D%20%3D%20this%3B%0A%20%20%20%20%20%20const%20cacheKey%20%3D%20this.getForRenderCacheKey%28renderObject%29%3B%0A%20%20%20%20%20%20nodeBuilderState%20%3D%20nodeBuilderCache.get%28cacheKey%29%3B%0A%20%20%20%20%20%20if%20%28nodeBuilderState%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20nodeBuilder%20%3D%20this.backend.createNodeBuilder%28renderObject.object%2C%20this.renderer%29%3B%0A%20%20%20%20%20%20%20%20nodeBuilder.scene%20%3D%20renderObject.scene%3B%0A%20%20%20%20%20%20%20%20nodeBuilder.material%20%3D%20renderObject.material%3B%0A%20%20%20%20%20%20%20%20nodeBuilder.camera%20%3D%20renderObject.camera%3B%0A%20%20%20%20%20%20%20%20nodeBuilder.context.material%20%3D%20renderObject.material%3B%0A%20%20%20%20%20%20%20%20nodeBuilder.lightsNode%20%3D%20renderObject.lightsNode%3B%0A%20%20%20%20%20%20%20%20nodeBuilder.environmentNode%20%3D%20this.getEnvironmentNode%28renderObject.scene%29%3B%0A%20%20%20%20%20%20%20%20nodeBuilder.fogNode%20%3D%20this.getFogNode%28renderObject.scene%29%3B%0A%20%20%20%20%20%20%20%20nodeBuilder.clippingContext%20%3D%20renderObject.clippingContext%3B%0A%20%20%20%20%20%20%20%20nodeBuilder.build%28%29%3B%0A%20%20%20%20%20%20%20%20nodeBuilderState%20%3D%20this._createNodeBuilderState%28nodeBuilder%29%3B%0A%20%20%20%20%20%20%20%20nodeBuilderCache.set%28cacheKey%2C%20nodeBuilderState%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20nodeBuilderState.usedTimes%2B%2B%3B%0A%20%20%20%20%20%20renderObjectData.nodeBuilderState%20%3D%20nodeBuilderState%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeBuilderState%3B%0A%20%20%7D%0A%20%20delete%28object%29%20%7B%0A%20%20%20%20if%20%28object.isRenderObject%29%20%7B%0A%20%20%20%20%20%20const%20nodeBuilderState%20%3D%20this.get%28object%29.nodeBuilderState%3B%0A%20%20%20%20%20%20nodeBuilderState.usedTimes--%3B%0A%20%20%20%20%20%20if%20%28nodeBuilderState.usedTimes%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20this.nodeBuilderCache.delete%28this.getForRenderCacheKey%28object%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20super.delete%28object%29%3B%0A%20%20%7D%0A%20%20getForCompute%28computeNode%29%20%7B%0A%20%20%20%20const%20computeData%20%3D%20this.get%28computeNode%29%3B%0A%20%20%20%20let%20nodeBuilderState%20%3D%20computeData.nodeBuilderState%3B%0A%20%20%20%20if%20%28nodeBuilderState%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20nodeBuilder%20%3D%20this.backend.createNodeBuilder%28computeNode%2C%20this.renderer%29%3B%0A%20%20%20%20%20%20nodeBuilder.build%28%29%3B%0A%20%20%20%20%20%20nodeBuilderState%20%3D%20this._createNodeBuilderState%28nodeBuilder%29%3B%0A%20%20%20%20%20%20computeData.nodeBuilderState%20%3D%20nodeBuilderState%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeBuilderState%3B%0A%20%20%7D%0A%20%20_createNodeBuilderState%28nodeBuilder%29%20%7B%0A%20%20%20%20return%20new%20NodeBuilderState%28%0A%20%20%20%20%20%20nodeBuilder.vertexShader%2C%0A%20%20%20%20%20%20nodeBuilder.fragmentShader%2C%0A%20%20%20%20%20%20nodeBuilder.computeShader%2C%0A%20%20%20%20%20%20nodeBuilder.getAttributesArray%28%29%2C%0A%20%20%20%20%20%20nodeBuilder.getBindings%28%29%2C%0A%20%20%20%20%20%20nodeBuilder.updateNodes%2C%0A%20%20%20%20%20%20nodeBuilder.updateBeforeNodes%2C%0A%20%20%20%20%20%20nodeBuilder.updateAfterNodes%2C%0A%20%20%20%20%20%20nodeBuilder.monitor%2C%0A%20%20%20%20%20%20nodeBuilder.transforms%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20getEnvironmentNode%28scene3%29%20%7B%0A%20%20%20%20return%20scene3.environmentNode%20%7C%7C%20this.get%28scene3%29.environmentNode%20%7C%7C%20null%3B%0A%20%20%7D%0A%20%20getBackgroundNode%28scene3%29%20%7B%0A%20%20%20%20return%20scene3.backgroundNode%20%7C%7C%20this.get%28scene3%29.backgroundNode%20%7C%7C%20null%3B%0A%20%20%7D%0A%20%20getFogNode%28scene3%29%20%7B%0A%20%20%20%20return%20scene3.fogNode%20%7C%7C%20this.get%28scene3%29.fogNode%20%7C%7C%20null%3B%0A%20%20%7D%0A%20%20getCacheKey%28scene3%2C%20lightsNode%29%20%7B%0A%20%20%20%20const%20chain%20%3D%20%5Bscene3%2C%20lightsNode%5D%3B%0A%20%20%20%20const%20callId%20%3D%20this.renderer.info.calls%3B%0A%20%20%20%20let%20cacheKeyData%20%3D%20this.callHashCache.get%28chain%29%3B%0A%20%20%20%20if%20%28cacheKeyData%20%3D%3D%3D%20void%200%20%7C%7C%20cacheKeyData.callId%20%21%3D%3D%20callId%29%20%7B%0A%20%20%20%20%20%20const%20environmentNode%20%3D%20this.getEnvironmentNode%28scene3%29%3B%0A%20%20%20%20%20%20const%20fogNode%20%3D%20this.getFogNode%28scene3%29%3B%0A%20%20%20%20%20%20const%20values%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20if%20%28lightsNode%29%20values.push%28lightsNode.getCacheKey%28true%29%29%3B%0A%20%20%20%20%20%20if%20%28environmentNode%29%20values.push%28environmentNode.getCacheKey%28%29%29%3B%0A%20%20%20%20%20%20if%20%28fogNode%29%20values.push%28fogNode.getCacheKey%28%29%29%3B%0A%20%20%20%20%20%20values.push%28this.renderer.shadowMap.enabled%20%3F%201%20%3A%200%29%3B%0A%20%20%20%20%20%20cacheKeyData%20%3D%20%7B%0A%20%20%20%20%20%20%20%20callId%2C%0A%20%20%20%20%20%20%20%20cacheKey%3A%20hashArray%28values%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20this.callHashCache.set%28chain%2C%20cacheKeyData%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20cacheKeyData.cacheKey%3B%0A%20%20%7D%0A%20%20updateScene%28scene3%29%20%7B%0A%20%20%20%20this.updateEnvironment%28scene3%29%3B%0A%20%20%20%20this.updateFog%28scene3%29%3B%0A%20%20%20%20this.updateBackground%28scene3%29%3B%0A%20%20%7D%0A%20%20get%20isToneMappingState%28%29%20%7B%0A%20%20%20%20return%20this.renderer.getRenderTarget%28%29%20%3F%20false%20%3A%20true%3B%0A%20%20%7D%0A%20%20updateBackground%28scene3%29%20%7B%0A%20%20%20%20const%20sceneData%20%3D%20this.get%28scene3%29%3B%0A%20%20%20%20const%20background%20%3D%20scene3.background%3B%0A%20%20%20%20if%20%28background%29%20%7B%0A%20%20%20%20%20%20const%20forceUpdate%20%3D%20scene3.backgroundBlurriness%20%3D%3D%3D%200%20%26%26%20sceneData.backgroundBlurriness%20%3E%200%20%7C%7C%20scene3.backgroundBlurriness%20%3E%200%20%26%26%20sceneData.backgroundBlurriness%20%3D%3D%3D%200%3B%0A%20%20%20%20%20%20if%20%28sceneData.background%20%21%3D%3D%20background%20%7C%7C%20forceUpdate%29%20%7B%0A%20%20%20%20%20%20%20%20let%20backgroundNode%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20if%20%28background.isCubeTexture%20%3D%3D%3D%20true%20%7C%7C%20%28background.mapping%20%3D%3D%3D%20EquirectangularReflectionMapping2%20%7C%7C%20background.mapping%20%3D%3D%3D%20EquirectangularRefractionMapping2%20%7C%7C%20background.mapping%20%3D%3D%3D%20CubeUVReflectionMapping2%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28scene3.backgroundBlurriness%20%3E%200%20%7C%7C%20background.mapping%20%3D%3D%3D%20CubeUVReflectionMapping2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20backgroundNode%20%3D%20pmremTexture%28background%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20envMap%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28background.isCubeTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20envMap%20%3D%20cubeTexture%28background%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20envMap%20%3D%20texture%28background%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20backgroundNode%20%3D%20cubeMapNode%28envMap%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28background.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20backgroundNode%20%3D%20texture%28background%2C%20screenUV.flipY%28%29%29.setUpdateMatrix%28true%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28background.isColor%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPUNodes%3A%20Unsupported%20background%20configuration.%22%2C%20background%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20sceneData.backgroundNode%20%3D%20backgroundNode%3B%0A%20%20%20%20%20%20%20%20sceneData.background%20%3D%20background%3B%0A%20%20%20%20%20%20%20%20sceneData.backgroundBlurriness%20%3D%20scene3.backgroundBlurriness%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28sceneData.backgroundNode%29%20%7B%0A%20%20%20%20%20%20delete%20sceneData.backgroundNode%3B%0A%20%20%20%20%20%20delete%20sceneData.background%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateFog%28scene3%29%20%7B%0A%20%20%20%20const%20sceneData%20%3D%20this.get%28scene3%29%3B%0A%20%20%20%20const%20fog%20%3D%20scene3.fog%3B%0A%20%20%20%20if%20%28fog%29%20%7B%0A%20%20%20%20%20%20if%20%28sceneData.fog%20%21%3D%3D%20fog%29%20%7B%0A%20%20%20%20%20%20%20%20let%20fogNode%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20if%20%28fog.isFogExp2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20color2%20%3D%20reference%28%22color%22%2C%20%22color%22%2C%20fog%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20density%20%3D%20reference%28%22density%22%2C%20%22float%22%2C%20fog%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20%20%20%20%20%20%20fogNode%20%3D%20densityFog%28color2%2C%20density%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28fog.isFog%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20color2%20%3D%20reference%28%22color%22%2C%20%22color%22%2C%20fog%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20near%20%3D%20reference%28%22near%22%2C%20%22float%22%2C%20fog%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20far%20%3D%20reference%28%22far%22%2C%20%22float%22%2C%20fog%29.setGroup%28renderGroup%29%3B%0A%20%20%20%20%20%20%20%20%20%20fogNode%20%3D%20rangeFog%28color2%2C%20near%2C%20far%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPUNodes%3A%20Unsupported%20fog%20configuration.%22%2C%20fog%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20sceneData.fogNode%20%3D%20fogNode%3B%0A%20%20%20%20%20%20%20%20sceneData.fog%20%3D%20fog%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20delete%20sceneData.fogNode%3B%0A%20%20%20%20%20%20delete%20sceneData.fog%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateEnvironment%28scene3%29%20%7B%0A%20%20%20%20const%20sceneData%20%3D%20this.get%28scene3%29%3B%0A%20%20%20%20const%20environment%20%3D%20scene3.environment%3B%0A%20%20%20%20if%20%28environment%29%20%7B%0A%20%20%20%20%20%20if%20%28sceneData.environment%20%21%3D%3D%20environment%29%20%7B%0A%20%20%20%20%20%20%20%20let%20environmentNode%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20if%20%28environment.isCubeTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20environmentNode%20%3D%20cubeTexture%28environment%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28environment.isTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20environmentNode%20%3D%20texture%28environment%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22Nodes%3A%20Unsupported%20environment%20configuration.%22%2C%20environment%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20sceneData.environmentNode%20%3D%20environmentNode%3B%0A%20%20%20%20%20%20%20%20sceneData.environment%20%3D%20environment%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28sceneData.environmentNode%29%20%7B%0A%20%20%20%20%20%20delete%20sceneData.environmentNode%3B%0A%20%20%20%20%20%20delete%20sceneData.environment%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getNodeFrame%28renderer3%20%3D%20this.renderer%2C%20scene3%20%3D%20null%2C%20object%20%3D%20null%2C%20camera3%20%3D%20null%2C%20material%20%3D%20null%29%20%7B%0A%20%20%20%20const%20nodeFrame%20%3D%20this.nodeFrame%3B%0A%20%20%20%20nodeFrame.renderer%20%3D%20renderer3%3B%0A%20%20%20%20nodeFrame.scene%20%3D%20scene3%3B%0A%20%20%20%20nodeFrame.object%20%3D%20object%3B%0A%20%20%20%20nodeFrame.camera%20%3D%20camera3%3B%0A%20%20%20%20nodeFrame.material%20%3D%20material%3B%0A%20%20%20%20return%20nodeFrame%3B%0A%20%20%7D%0A%20%20getNodeFrameForRender%28renderObject%29%20%7B%0A%20%20%20%20return%20this.getNodeFrame%28renderObject.renderer%2C%20renderObject.scene%2C%20renderObject.object%2C%20renderObject.camera%2C%20renderObject.material%29%3B%0A%20%20%7D%0A%20%20getOutputCacheKey%28%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this.renderer%3B%0A%20%20%20%20return%20renderer3.toneMapping%20%2B%20%22%2C%22%20%2B%20renderer3.currentColorSpace%3B%0A%20%20%7D%0A%20%20hasOutputChange%28outputTarget%29%20%7B%0A%20%20%20%20const%20cacheKey%20%3D%20outputNodeMap.get%28outputTarget%29%3B%0A%20%20%20%20return%20cacheKey%20%21%3D%3D%20this.getOutputCacheKey%28%29%3B%0A%20%20%7D%0A%20%20getOutputNode%28outputTexture%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this.renderer%3B%0A%20%20%20%20const%20cacheKey%20%3D%20this.getOutputCacheKey%28%29%3B%0A%20%20%20%20const%20output2%20%3D%20texture%28outputTexture%2C%20screenUV%29.renderOutput%28renderer3.toneMapping%2C%20renderer3.currentColorSpace%29%3B%0A%20%20%20%20outputNodeMap.set%28outputTexture%2C%20cacheKey%29%3B%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%20%20updateBefore%28renderObject%29%20%7B%0A%20%20%20%20const%20nodeBuilder%20%3D%20renderObject.getNodeBuilderState%28%29%3B%0A%20%20%20%20for%20%28const%20node%20of%20nodeBuilder.updateBeforeNodes%29%20%7B%0A%20%20%20%20%20%20this.getNodeFrameForRender%28renderObject%29.updateBeforeNode%28node%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateAfter%28renderObject%29%20%7B%0A%20%20%20%20const%20nodeBuilder%20%3D%20renderObject.getNodeBuilderState%28%29%3B%0A%20%20%20%20for%20%28const%20node%20of%20nodeBuilder.updateAfterNodes%29%20%7B%0A%20%20%20%20%20%20this.getNodeFrameForRender%28renderObject%29.updateAfterNode%28node%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateForCompute%28computeNode%29%20%7B%0A%20%20%20%20const%20nodeFrame%20%3D%20this.getNodeFrame%28%29%3B%0A%20%20%20%20const%20nodeBuilder%20%3D%20this.getForCompute%28computeNode%29%3B%0A%20%20%20%20for%20%28const%20node%20of%20nodeBuilder.updateNodes%29%20%7B%0A%20%20%20%20%20%20nodeFrame.updateNode%28node%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateForRender%28renderObject%29%20%7B%0A%20%20%20%20const%20nodeFrame%20%3D%20this.getNodeFrameForRender%28renderObject%29%3B%0A%20%20%20%20const%20nodeBuilder%20%3D%20renderObject.getNodeBuilderState%28%29%3B%0A%20%20%20%20for%20%28const%20node%20of%20nodeBuilder.updateNodes%29%20%7B%0A%20%20%20%20%20%20nodeFrame.updateNode%28node%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20needsRefresh%28renderObject%29%20%7B%0A%20%20%20%20const%20nodeFrame%20%3D%20this.getNodeFrameForRender%28renderObject%29%3B%0A%20%20%20%20const%20monitor%20%3D%20renderObject.getMonitor%28%29%3B%0A%20%20%20%20return%20monitor.needsRefresh%28renderObject%2C%20nodeFrame%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20super.dispose%28%29%3B%0A%20%20%20%20this.nodeFrame%20%3D%20new%20NodeFrame%28%29%3B%0A%20%20%20%20this.nodeBuilderCache%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20RenderBundle%20%3D%20class%20%7B%0A%20%20constructor%28scene3%2C%20camera3%29%20%7B%0A%20%20%20%20this.scene%20%3D%20scene3%3B%0A%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20Object.assign%28new%20this.constructor%28%29%2C%20this%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20RenderBundles%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.lists%20%3D%20new%20ChainMap%28%29%3B%0A%20%20%7D%0A%20%20get%28scene3%2C%20camera3%29%20%7B%0A%20%20%20%20const%20lists%20%3D%20this.lists%3B%0A%20%20%20%20const%20keys%20%3D%20%5Bscene3%2C%20camera3%5D%3B%0A%20%20%20%20let%20list%20%3D%20lists.get%28keys%29%3B%0A%20%20%20%20if%20%28list%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20list%20%3D%20new%20RenderBundle%28scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20lists.set%28keys%2C%20list%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20list%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.lists%20%3D%20new%20ChainMap%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeLibrary%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.lightNodes%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.materialNodes%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20this.toneMappingNodes%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%7D%0A%20%20fromMaterial%28material%29%20%7B%0A%20%20%20%20if%20%28material.isNodeMaterial%29%20return%20material%3B%0A%20%20%20%20let%20nodeMaterial%20%3D%20null%3B%0A%20%20%20%20const%20nodeMaterialClass%20%3D%20this.getMaterialNodeClass%28material.type%29%3B%0A%20%20%20%20if%20%28nodeMaterialClass%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20nodeMaterial%20%3D%20new%20nodeMaterialClass%28%29%3B%0A%20%20%20%20%20%20for%20%28const%20key%20in%20material%29%20%7B%0A%20%20%20%20%20%20%20%20nodeMaterial%5Bkey%5D%20%3D%20material%5Bkey%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeMaterial%3B%0A%20%20%7D%0A%20%20addToneMapping%28toneMappingNode%2C%20toneMapping2%29%20%7B%0A%20%20%20%20this.addType%28toneMappingNode%2C%20toneMapping2%2C%20this.toneMappingNodes%29%3B%0A%20%20%7D%0A%20%20getToneMappingFunction%28toneMapping2%29%20%7B%0A%20%20%20%20return%20this.toneMappingNodes.get%28toneMapping2%29%20%7C%7C%20null%3B%0A%20%20%7D%0A%20%20getMaterialNodeClass%28materialType%29%20%7B%0A%20%20%20%20return%20this.materialNodes.get%28materialType%29%20%7C%7C%20null%3B%0A%20%20%7D%0A%20%20addMaterial%28materialNodeClass%2C%20materialClass%29%20%7B%0A%20%20%20%20this.addType%28materialNodeClass%2C%20materialClass.type%2C%20this.materialNodes%29%3B%0A%20%20%7D%0A%20%20getLightNodeClass%28light%29%20%7B%0A%20%20%20%20return%20this.lightNodes.get%28light%29%20%7C%7C%20null%3B%0A%20%20%7D%0A%20%20addLight%28lightNodeClass%2C%20lightClass%29%20%7B%0A%20%20%20%20this.addClass%28lightNodeClass%2C%20lightClass%2C%20this.lightNodes%29%3B%0A%20%20%7D%0A%20%20addType%28nodeClass%2C%20type%2C%20library%29%20%7B%0A%20%20%20%20if%20%28library.has%28type%29%29%20%7B%0A%20%20%20%20%20%20console.warn%28%60Redefinition%20of%20node%20%24%7Btype%7D%60%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28typeof%20nodeClass%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%28%60Node%20class%20%24%7BnodeClass.name%7D%20is%20not%20a%20class.%60%29%3B%0A%20%20%20%20if%20%28typeof%20type%20%3D%3D%3D%20%22function%22%20%7C%7C%20typeof%20type%20%3D%3D%3D%20%22object%22%29%20throw%20new%20Error%28%60Base%20class%20%24%7Btype%7D%20is%20not%20a%20class.%60%29%3B%0A%20%20%20%20library.set%28type%2C%20nodeClass%29%3B%0A%20%20%7D%0A%20%20addClass%28nodeClass%2C%20baseClass%2C%20library%29%20%7B%0A%20%20%20%20if%20%28library.has%28baseClass%29%29%20%7B%0A%20%20%20%20%20%20console.warn%28%60Redefinition%20of%20node%20%24%7BbaseClass.name%7D%60%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28typeof%20nodeClass%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%28%60Node%20class%20%24%7BnodeClass.name%7D%20is%20not%20a%20class.%60%29%3B%0A%20%20%20%20if%20%28typeof%20baseClass%20%21%3D%3D%20%22function%22%29%20throw%20new%20Error%28%60Base%20class%20%24%7BbaseClass.name%7D%20is%20not%20a%20class.%60%29%3B%0A%20%20%20%20library.set%28baseClass%2C%20nodeClass%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_defaultLights%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20LightsNode%28%29%3B%0Avar%20Lighting%20%3D%20class%20extends%20ChainMap%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%7D%0A%20%20createNode%28lights%20%3D%20%5B%5D%29%20%7B%0A%20%20%20%20return%20new%20LightsNode%28%29.setLights%28lights%29%3B%0A%20%20%7D%0A%20%20getNode%28scene3%2C%20camera3%29%20%7B%0A%20%20%20%20if%20%28scene3.isQuadMesh%29%20return%20_defaultLights%3B%0A%20%20%20%20const%20keys%20%3D%20%5Bscene3%2C%20camera3%5D%3B%0A%20%20%20%20let%20node%20%3D%20this.get%28keys%29%3B%0A%20%20%20%20if%20%28node%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20node%20%3D%20this.createNode%28%29%3B%0A%20%20%20%20%20%20this.set%28keys%2C%20node%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20node%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_scene%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Scene2%28%29%3B%0Avar%20_drawingBufferSize%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector22%28%29%3B%0Avar%20_screen%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector42%28%29%3B%0Avar%20_frustum%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Frustum2%28%29%3B%0Avar%20_projScreenMatrix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Matrix42%28%29%3B%0Avar%20_vector4%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Vector42%28%29%3B%0Avar%20Renderer%20%3D%20class%20%7B%0A%20%20constructor%28backend%2C%20parameters%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20this.isRenderer%20%3D%20true%3B%0A%20%20%20%20const%20%7B%0A%20%20%20%20%20%20logarithmicDepthBuffer%20%3D%20false%2C%0A%20%20%20%20%20%20alpha%20%3D%20true%2C%0A%20%20%20%20%20%20depth%3A%20depth2%20%3D%20true%2C%0A%20%20%20%20%20%20stencil%20%3D%20false%2C%0A%20%20%20%20%20%20antialias%20%3D%20false%2C%0A%20%20%20%20%20%20samples%20%3D%200%2C%0A%20%20%20%20%20%20getFallback%20%3D%20null%0A%20%20%20%20%7D%20%3D%20parameters%3B%0A%20%20%20%20this.domElement%20%3D%20backend.getDomElement%28%29%3B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.samples%20%3D%20samples%20%7C%7C%20antialias%20%3D%3D%3D%20true%20%3F%204%20%3A%200%3B%0A%20%20%20%20this.autoClear%20%3D%20true%3B%0A%20%20%20%20this.autoClearColor%20%3D%20true%3B%0A%20%20%20%20this.autoClearDepth%20%3D%20true%3B%0A%20%20%20%20this.autoClearStencil%20%3D%20true%3B%0A%20%20%20%20this.alpha%20%3D%20alpha%3B%0A%20%20%20%20this.logarithmicDepthBuffer%20%3D%20logarithmicDepthBuffer%3B%0A%20%20%20%20this.outputColorSpace%20%3D%20SRGBColorSpace2%3B%0A%20%20%20%20this.toneMapping%20%3D%20NoToneMapping2%3B%0A%20%20%20%20this.toneMappingExposure%20%3D%201%3B%0A%20%20%20%20this.sortObjects%20%3D%20true%3B%0A%20%20%20%20this.depth%20%3D%20depth2%3B%0A%20%20%20%20this.stencil%20%3D%20stencil%3B%0A%20%20%20%20this.clippingPlanes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.info%20%3D%20new%20Info%28%29%3B%0A%20%20%20%20this.nodes%20%3D%20%7B%0A%20%20%20%20%20%20modelViewMatrix%3A%20null%2C%0A%20%20%20%20%20%20modelNormalViewMatrix%3A%20null%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.library%20%3D%20new%20NodeLibrary%28%29%3B%0A%20%20%20%20this.lighting%20%3D%20new%20Lighting%28%29%3B%0A%20%20%20%20this._getFallback%20%3D%20getFallback%3B%0A%20%20%20%20this._pixelRatio%20%3D%201%3B%0A%20%20%20%20this._width%20%3D%20this.domElement.width%3B%0A%20%20%20%20this._height%20%3D%20this.domElement.height%3B%0A%20%20%20%20this._viewport%20%3D%20new%20Vector42%280%2C%200%2C%20this._width%2C%20this._height%29%3B%0A%20%20%20%20this._scissor%20%3D%20new%20Vector42%280%2C%200%2C%20this._width%2C%20this._height%29%3B%0A%20%20%20%20this._scissorTest%20%3D%20false%3B%0A%20%20%20%20this._attributes%20%3D%20null%3B%0A%20%20%20%20this._geometries%20%3D%20null%3B%0A%20%20%20%20this._nodes%20%3D%20null%3B%0A%20%20%20%20this._animation%20%3D%20null%3B%0A%20%20%20%20this._bindings%20%3D%20null%3B%0A%20%20%20%20this._objects%20%3D%20null%3B%0A%20%20%20%20this._pipelines%20%3D%20null%3B%0A%20%20%20%20this._bundles%20%3D%20null%3B%0A%20%20%20%20this._renderLists%20%3D%20null%3B%0A%20%20%20%20this._renderContexts%20%3D%20null%3B%0A%20%20%20%20this._textures%20%3D%20null%3B%0A%20%20%20%20this._background%20%3D%20null%3B%0A%20%20%20%20this._quad%20%3D%20new%20QuadMesh%28new%20NodeMaterial%28%29%29%3B%0A%20%20%20%20this._quad.material.type%20%3D%20%22Renderer_output%22%3B%0A%20%20%20%20this._currentRenderContext%20%3D%20null%3B%0A%20%20%20%20this._opaqueSort%20%3D%20null%3B%0A%20%20%20%20this._transparentSort%20%3D%20null%3B%0A%20%20%20%20this._frameBufferTarget%20%3D%20null%3B%0A%20%20%20%20const%20alphaClear%20%3D%20this.alpha%20%3D%3D%3D%20true%20%3F%200%20%3A%201%3B%0A%20%20%20%20this._clearColor%20%3D%20new%20Color4%280%2C%200%2C%200%2C%20alphaClear%29%3B%0A%20%20%20%20this._clearDepth%20%3D%201%3B%0A%20%20%20%20this._clearStencil%20%3D%200%3B%0A%20%20%20%20this._renderTarget%20%3D%20null%3B%0A%20%20%20%20this._activeCubeFace%20%3D%200%3B%0A%20%20%20%20this._activeMipmapLevel%20%3D%200%3B%0A%20%20%20%20this._mrt%20%3D%20null%3B%0A%20%20%20%20this._renderObjectFunction%20%3D%20null%3B%0A%20%20%20%20this._currentRenderObjectFunction%20%3D%20null%3B%0A%20%20%20%20this._currentRenderBundle%20%3D%20null%3B%0A%20%20%20%20this._handleObjectFunction%20%3D%20this._renderObjectDirect%3B%0A%20%20%20%20this._isDeviceLost%20%3D%20false%3B%0A%20%20%20%20this.onDeviceLost%20%3D%20this._onDeviceLost%3B%0A%20%20%20%20this._initialized%20%3D%20false%3B%0A%20%20%20%20this._initPromise%20%3D%20null%3B%0A%20%20%20%20this._compilationPromises%20%3D%20null%3B%0A%20%20%20%20this.transparent%20%3D%20true%3B%0A%20%20%20%20this.opaque%20%3D%20true%3B%0A%20%20%20%20this.shadowMap%20%3D%20%7B%0A%20%20%20%20%20%20enabled%3A%20false%2C%0A%20%20%20%20%20%20type%3A%20PCFShadowMap%241%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.xr%20%3D%20%7B%0A%20%20%20%20%20%20enabled%3A%20false%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.debug%20%3D%20%7B%0A%20%20%20%20%20%20checkShaderErrors%3A%20true%2C%0A%20%20%20%20%20%20onShaderError%3A%20null%2C%0A%20%20%20%20%20%20getShaderAsync%3A%20async%20%28scene3%2C%20camera3%2C%20object%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20await%20this.compileAsync%28scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20%20%20const%20renderList%20%3D%20this._renderLists.get%28scene3%2C%20camera3%29%3B%0A%20%20%20%20%20%20%20%20const%20renderContext%20%3D%20this._renderContexts.get%28scene3%2C%20camera3%2C%20this._renderTarget%29%3B%0A%20%20%20%20%20%20%20%20const%20material%20%3D%20scene3.overrideMaterial%20%7C%7C%20object.material%3B%0A%20%20%20%20%20%20%20%20const%20renderObject%20%3D%20this._objects.get%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20renderList.lightsNode%2C%20renderContext%29%3B%0A%20%20%20%20%20%20%20%20const%20%7B%20fragmentShader%2C%20vertexShader%20%7D%20%3D%20renderObject.getNodeBuilderState%28%29%3B%0A%20%20%20%20%20%20%20%20return%20%7B%20fragmentShader%2C%20vertexShader%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20async%20init%28%29%20%7B%0A%20%20%20%20if%20%28this._initialized%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22Renderer%3A%20Backend%20has%20already%20been%20initialized.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this._initPromise%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20this._initPromise%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._initPromise%20%3D%20new%20Promise%28async%20%28resolve%2C%20reject%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20let%20backend%20%3D%20this.backend%3B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20await%20backend.init%28this%29%3B%0A%20%20%20%20%20%20%7D%20catch%20%28error%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this._getFallback%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.backend%20%3D%20backend%20%3D%20this._getFallback%28error%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20await%20backend.init%28this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20catch%20%28error2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20reject%28error2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20reject%28error%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._nodes%20%3D%20new%20Nodes%28this%2C%20backend%29%3B%0A%20%20%20%20%20%20this._animation%20%3D%20new%20Animation%28this._nodes%2C%20this.info%29%3B%0A%20%20%20%20%20%20this._attributes%20%3D%20new%20Attributes%28backend%29%3B%0A%20%20%20%20%20%20this._background%20%3D%20new%20Background%28this%2C%20this._nodes%29%3B%0A%20%20%20%20%20%20this._geometries%20%3D%20new%20Geometries%28this._attributes%2C%20this.info%29%3B%0A%20%20%20%20%20%20this._textures%20%3D%20new%20Textures%28this%2C%20backend%2C%20this.info%29%3B%0A%20%20%20%20%20%20this._pipelines%20%3D%20new%20Pipelines%28backend%2C%20this._nodes%29%3B%0A%20%20%20%20%20%20this._bindings%20%3D%20new%20Bindings%28backend%2C%20this._nodes%2C%20this._textures%2C%20this._attributes%2C%20this._pipelines%2C%20this.info%29%3B%0A%20%20%20%20%20%20this._objects%20%3D%20new%20RenderObjects%28this%2C%20this._nodes%2C%20this._geometries%2C%20this._pipelines%2C%20this._bindings%2C%20this.info%29%3B%0A%20%20%20%20%20%20this._renderLists%20%3D%20new%20RenderLists%28this.lighting%29%3B%0A%20%20%20%20%20%20this._bundles%20%3D%20new%20RenderBundles%28%29%3B%0A%20%20%20%20%20%20this._renderContexts%20%3D%20new%20RenderContexts%28%29%3B%0A%20%20%20%20%20%20this._initialized%20%3D%20true%3B%0A%20%20%20%20%20%20resolve%28%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20return%20this._initPromise%3B%0A%20%20%7D%0A%20%20get%20coordinateSystem%28%29%20%7B%0A%20%20%20%20return%20this.backend.coordinateSystem%3B%0A%20%20%7D%0A%20%20async%20compileAsync%28scene3%2C%20camera3%2C%20targetScene%20%3D%20null%29%20%7B%0A%20%20%20%20if%20%28this._isDeviceLost%20%3D%3D%3D%20true%29%20return%3B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20await%20this.init%28%29%3B%0A%20%20%20%20const%20nodeFrame%20%3D%20this._nodes.nodeFrame%3B%0A%20%20%20%20const%20previousRenderId%20%3D%20nodeFrame.renderId%3B%0A%20%20%20%20const%20previousRenderContext%20%3D%20this._currentRenderContext%3B%0A%20%20%20%20const%20previousRenderObjectFunction%20%3D%20this._currentRenderObjectFunction%3B%0A%20%20%20%20const%20previousCompilationPromises%20%3D%20this._compilationPromises%3B%0A%20%20%20%20const%20sceneRef%20%3D%20scene3.isScene%20%3D%3D%3D%20true%20%3F%20scene3%20%3A%20_scene%3B%0A%20%20%20%20if%20%28targetScene%20%3D%3D%3D%20null%29%20targetScene%20%3D%20scene3%3B%0A%20%20%20%20const%20renderTarget%20%3D%20this._renderTarget%3B%0A%20%20%20%20const%20renderContext%20%3D%20this._renderContexts.get%28targetScene%2C%20camera3%2C%20renderTarget%29%3B%0A%20%20%20%20const%20activeMipmapLevel%20%3D%20this._activeMipmapLevel%3B%0A%20%20%20%20const%20compilationPromises%20%3D%20%5B%5D%3B%0A%20%20%20%20this._currentRenderContext%20%3D%20renderContext%3B%0A%20%20%20%20this._currentRenderObjectFunction%20%3D%20this.renderObject%3B%0A%20%20%20%20this._handleObjectFunction%20%3D%20this._createObjectPipeline%3B%0A%20%20%20%20this._compilationPromises%20%3D%20compilationPromises%3B%0A%20%20%20%20nodeFrame.renderId%2B%2B%3B%0A%20%20%20%20nodeFrame.update%28%29%3B%0A%20%20%20%20renderContext.depth%20%3D%20this.depth%3B%0A%20%20%20%20renderContext.stencil%20%3D%20this.stencil%3B%0A%20%20%20%20if%20%28%21renderContext.clippingContext%29%20renderContext.clippingContext%20%3D%20new%20ClippingContext%28%29%3B%0A%20%20%20%20renderContext.clippingContext.updateGlobal%28this%2C%20camera3%29%3B%0A%20%20%20%20sceneRef.onBeforeRender%28this%2C%20scene3%2C%20camera3%2C%20renderTarget%29%3B%0A%20%20%20%20const%20renderList%20%3D%20this._renderLists.get%28scene3%2C%20camera3%29%3B%0A%20%20%20%20renderList.begin%28%29%3B%0A%20%20%20%20this._projectObject%28scene3%2C%20camera3%2C%200%2C%20renderList%29%3B%0A%20%20%20%20if%20%28targetScene%20%21%3D%3D%20scene3%29%20%7B%0A%20%20%20%20%20%20targetScene.traverseVisible%28function%28object%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28object.isLight%20%26%26%20object.layers.test%28camera3.layers%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderList.pushLight%28object%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderList.finish%28%29%3B%0A%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._textures.updateRenderTarget%28renderTarget%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20%20%20const%20renderTargetData%20%3D%20this._textures.get%28renderTarget%29%3B%0A%20%20%20%20%20%20renderContext.textures%20%3D%20renderTargetData.textures%3B%0A%20%20%20%20%20%20renderContext.depthTexture%20%3D%20renderTargetData.depthTexture%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderContext.textures%20%3D%20null%3B%0A%20%20%20%20%20%20renderContext.depthTexture%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._nodes.updateScene%28sceneRef%29%3B%0A%20%20%20%20this._background.update%28sceneRef%2C%20renderList%2C%20renderContext%29%3B%0A%20%20%20%20const%20opaqueObjects%20%3D%20renderList.opaque%3B%0A%20%20%20%20const%20transparentObjects%20%3D%20renderList.transparent%3B%0A%20%20%20%20const%20lightsNode%20%3D%20renderList.lightsNode%3B%0A%20%20%20%20if%20%28this.opaque%20%3D%3D%3D%20true%20%26%26%20opaqueObjects.length%20%3E%200%29%20this._renderObjects%28opaqueObjects%2C%20camera3%2C%20sceneRef%2C%20lightsNode%29%3B%0A%20%20%20%20if%20%28this.transparent%20%3D%3D%3D%20true%20%26%26%20transparentObjects.length%20%3E%200%29%20this._renderTransparents%28transparentObjects%2C%20camera3%2C%20sceneRef%2C%20lightsNode%29%3B%0A%20%20%20%20nodeFrame.renderId%20%3D%20previousRenderId%3B%0A%20%20%20%20this._currentRenderContext%20%3D%20previousRenderContext%3B%0A%20%20%20%20this._currentRenderObjectFunction%20%3D%20previousRenderObjectFunction%3B%0A%20%20%20%20this._compilationPromises%20%3D%20previousCompilationPromises%3B%0A%20%20%20%20this._handleObjectFunction%20%3D%20this._renderObjectDirect%3B%0A%20%20%20%20await%20Promise.all%28compilationPromises%29%3B%0A%20%20%7D%0A%20%20async%20renderAsync%28scene3%2C%20camera3%29%20%7B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20await%20this.init%28%29%3B%0A%20%20%20%20const%20renderContext%20%3D%20this._renderScene%28scene3%2C%20camera3%29%3B%0A%20%20%20%20await%20this.backend.resolveTimestampAsync%28renderContext%2C%20%22render%22%29%3B%0A%20%20%7D%0A%20%20async%20waitForGPU%28%29%20%7B%0A%20%20%20%20await%20this.backend.waitForGPU%28%29%3B%0A%20%20%7D%0A%20%20setMRT%28mrt%29%20%7B%0A%20%20%20%20this._mrt%20%3D%20mrt%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20getMRT%28%29%20%7B%0A%20%20%20%20return%20this._mrt%3B%0A%20%20%7D%0A%20%20_onDeviceLost%28info%29%20%7B%0A%20%20%20%20let%20errorMessage%20%3D%20%60THREE.WebGPURenderer%3A%20%24%7Binfo.api%7D%20Device%20Lost%3A%0A%0AMessage%3A%20%24%7Binfo.message%7D%60%3B%0A%20%20%20%20if%20%28info.reason%29%20%7B%0A%20%20%20%20%20%20errorMessage%20%2B%3D%20%60%0AReason%3A%20%24%7Binfo.reason%7D%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20console.error%28errorMessage%29%3B%0A%20%20%20%20this._isDeviceLost%20%3D%20true%3B%0A%20%20%7D%0A%20%20_renderBundle%28bundle%2C%20sceneRef%2C%20lightsNode%29%20%7B%0A%20%20%20%20const%20%7B%20bundleGroup%2C%20camera%3A%20camera3%2C%20renderList%20%7D%20%3D%20bundle%3B%0A%20%20%20%20const%20renderContext%20%3D%20this._currentRenderContext%3B%0A%20%20%20%20const%20renderBundle%20%3D%20this._bundles.get%28bundleGroup%2C%20camera3%29%3B%0A%20%20%20%20const%20renderBundleData%20%3D%20this.backend.get%28renderBundle%29%3B%0A%20%20%20%20if%20%28renderBundleData.renderContexts%20%3D%3D%3D%20void%200%29%20renderBundleData.renderContexts%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%29%3B%0A%20%20%20%20const%20needsUpdate%20%3D%20bundleGroup.version%20%21%3D%3D%20renderBundleData.version%3B%0A%20%20%20%20const%20renderBundleNeedsUpdate%20%3D%20renderBundleData.renderContexts.has%28renderContext%29%20%3D%3D%3D%20false%20%7C%7C%20needsUpdate%3B%0A%20%20%20%20renderBundleData.renderContexts.add%28renderContext%29%3B%0A%20%20%20%20if%20%28renderBundleNeedsUpdate%29%20%7B%0A%20%20%20%20%20%20this.backend.beginBundle%28renderContext%29%3B%0A%20%20%20%20%20%20if%20%28renderBundleData.renderObjects%20%3D%3D%3D%20void%200%20%7C%7C%20needsUpdate%29%20%7B%0A%20%20%20%20%20%20%20%20renderBundleData.renderObjects%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._currentRenderBundle%20%3D%20renderBundle%3B%0A%20%20%20%20%20%20const%20opaqueObjects%20%3D%20renderList.opaque%3B%0A%20%20%20%20%20%20if%20%28this.opaque%20%3D%3D%3D%20true%20%26%26%20opaqueObjects.length%20%3E%200%29%20this._renderObjects%28opaqueObjects%2C%20camera3%2C%20sceneRef%2C%20lightsNode%29%3B%0A%20%20%20%20%20%20this._currentRenderBundle%20%3D%20null%3B%0A%20%20%20%20%20%20this.backend.finishBundle%28renderContext%2C%20renderBundle%29%3B%0A%20%20%20%20%20%20renderBundleData.version%20%3D%20bundleGroup.version%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20%7B%20renderObjects%20%7D%20%3D%20renderBundleData%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20renderObjects.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20renderObject%20%3D%20renderObjects%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28this._nodes.needsRefresh%28renderObject%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._nodes.updateBefore%28renderObject%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._nodes.updateForRender%28renderObject%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._bindings.updateForRender%28renderObject%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._nodes.updateAfter%28renderObject%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.backend.addBundle%28renderContext%2C%20renderBundle%29%3B%0A%20%20%7D%0A%20%20render%28scene3%2C%20camera3%29%20%7B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.Renderer%3A%20.render%28%29%20called%20before%20the%20backend%20is%20initialized.%20Try%20using%20.renderAsync%28%29%20instead.%22%29%3B%0A%20%20%20%20%20%20return%20this.renderAsync%28scene3%2C%20camera3%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._renderScene%28scene3%2C%20camera3%29%3B%0A%20%20%7D%0A%20%20_getFrameBufferTarget%28%29%20%7B%0A%20%20%20%20const%20%7B%20currentToneMapping%2C%20currentColorSpace%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20useToneMapping%20%3D%20currentToneMapping%20%21%3D%3D%20NoToneMapping2%3B%0A%20%20%20%20const%20useColorSpace%20%3D%20currentColorSpace%20%21%3D%3D%20LinearSRGBColorSpace2%3B%0A%20%20%20%20if%20%28useToneMapping%20%3D%3D%3D%20false%20%26%26%20useColorSpace%20%3D%3D%3D%20false%29%20return%20null%3B%0A%20%20%20%20const%20%7B%20width%2C%20height%20%7D%20%3D%20this.getDrawingBufferSize%28_drawingBufferSize%29%3B%0A%20%20%20%20const%20%7B%20depth%3A%20depth2%2C%20stencil%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20frameBufferTarget%20%3D%20this._frameBufferTarget%3B%0A%20%20%20%20if%20%28frameBufferTarget%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20frameBufferTarget%20%3D%20new%20RenderTarget2%28width%2C%20height%2C%20%7B%0A%20%20%20%20%20%20%20%20depthBuffer%3A%20depth2%2C%0A%20%20%20%20%20%20%20%20stencilBuffer%3A%20stencil%2C%0A%20%20%20%20%20%20%20%20type%3A%20HalfFloatType2%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20FloatType%0A%20%20%20%20%20%20%20%20format%3A%20RGBAFormat2%2C%0A%20%20%20%20%20%20%20%20colorSpace%3A%20LinearSRGBColorSpace2%2C%0A%20%20%20%20%20%20%20%20generateMipmaps%3A%20false%2C%0A%20%20%20%20%20%20%20%20minFilter%3A%20LinearFilter2%2C%0A%20%20%20%20%20%20%20%20magFilter%3A%20LinearFilter2%2C%0A%20%20%20%20%20%20%20%20samples%3A%20this.samples%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20frameBufferTarget.isPostProcessingRenderTarget%20%3D%20true%3B%0A%20%20%20%20%20%20this._frameBufferTarget%20%3D%20frameBufferTarget%3B%0A%20%20%20%20%7D%0A%20%20%20%20frameBufferTarget.depthBuffer%20%3D%20depth2%3B%0A%20%20%20%20frameBufferTarget.stencilBuffer%20%3D%20stencil%3B%0A%20%20%20%20frameBufferTarget.setSize%28width%2C%20height%29%3B%0A%20%20%20%20frameBufferTarget.viewport.copy%28this._viewport%29%3B%0A%20%20%20%20frameBufferTarget.scissor.copy%28this._scissor%29%3B%0A%20%20%20%20frameBufferTarget.viewport.multiplyScalar%28this._pixelRatio%29%3B%0A%20%20%20%20frameBufferTarget.scissor.multiplyScalar%28this._pixelRatio%29%3B%0A%20%20%20%20frameBufferTarget.scissorTest%20%3D%20this._scissorTest%3B%0A%20%20%20%20return%20frameBufferTarget%3B%0A%20%20%7D%0A%20%20_renderScene%28scene3%2C%20camera3%2C%20useFrameBufferTarget%20%3D%20true%29%20%7B%0A%20%20%20%20if%20%28this._isDeviceLost%20%3D%3D%3D%20true%29%20return%3B%0A%20%20%20%20const%20frameBufferTarget%20%3D%20useFrameBufferTarget%20%3F%20this._getFrameBufferTarget%28%29%20%3A%20null%3B%0A%20%20%20%20const%20nodeFrame%20%3D%20this._nodes.nodeFrame%3B%0A%20%20%20%20const%20previousRenderId%20%3D%20nodeFrame.renderId%3B%0A%20%20%20%20const%20previousRenderContext%20%3D%20this._currentRenderContext%3B%0A%20%20%20%20const%20previousRenderObjectFunction%20%3D%20this._currentRenderObjectFunction%3B%0A%20%20%20%20const%20sceneRef%20%3D%20scene3.isScene%20%3D%3D%3D%20true%20%3F%20scene3%20%3A%20_scene%3B%0A%20%20%20%20const%20outputRenderTarget%20%3D%20this._renderTarget%3B%0A%20%20%20%20const%20activeCubeFace%20%3D%20this._activeCubeFace%3B%0A%20%20%20%20const%20activeMipmapLevel%20%3D%20this._activeMipmapLevel%3B%0A%20%20%20%20let%20renderTarget%3B%0A%20%20%20%20if%20%28frameBufferTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20renderTarget%20%3D%20frameBufferTarget%3B%0A%20%20%20%20%20%20this.setRenderTarget%28renderTarget%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderTarget%20%3D%20outputRenderTarget%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20renderContext%20%3D%20this._renderContexts.get%28scene3%2C%20camera3%2C%20renderTarget%29%3B%0A%20%20%20%20this._currentRenderContext%20%3D%20renderContext%3B%0A%20%20%20%20this._currentRenderObjectFunction%20%3D%20this._renderObjectFunction%20%7C%7C%20this.renderObject%3B%0A%20%20%20%20this.info.calls%2B%2B%3B%0A%20%20%20%20this.info.render.calls%2B%2B%3B%0A%20%20%20%20this.info.render.frameCalls%2B%2B%3B%0A%20%20%20%20nodeFrame.renderId%20%3D%20this.info.calls%3B%0A%20%20%20%20const%20coordinateSystem%20%3D%20this.coordinateSystem%3B%0A%20%20%20%20if%20%28camera3.coordinateSystem%20%21%3D%3D%20coordinateSystem%29%20%7B%0A%20%20%20%20%20%20camera3.coordinateSystem%20%3D%20coordinateSystem%3B%0A%20%20%20%20%20%20camera3.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28scene3.matrixWorldAutoUpdate%20%3D%3D%3D%20true%29%20scene3.updateMatrixWorld%28%29%3B%0A%20%20%20%20if%20%28camera3.parent%20%3D%3D%3D%20null%20%26%26%20camera3.matrixWorldAutoUpdate%20%3D%3D%3D%20true%29%20camera3.updateMatrixWorld%28%29%3B%0A%20%20%20%20let%20viewport2%20%3D%20this._viewport%3B%0A%20%20%20%20let%20scissor%20%3D%20this._scissor%3B%0A%20%20%20%20let%20pixelRatio%20%3D%20this._pixelRatio%3B%0A%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20viewport2%20%3D%20renderTarget.viewport%3B%0A%20%20%20%20%20%20scissor%20%3D%20renderTarget.scissor%3B%0A%20%20%20%20%20%20pixelRatio%20%3D%201%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.getDrawingBufferSize%28_drawingBufferSize%29%3B%0A%20%20%20%20_screen.set%280%2C%200%2C%20_drawingBufferSize.width%2C%20_drawingBufferSize.height%29%3B%0A%20%20%20%20const%20minDepth%20%3D%20viewport2.minDepth%20%3D%3D%3D%20void%200%20%3F%200%20%3A%20viewport2.minDepth%3B%0A%20%20%20%20const%20maxDepth%20%3D%20viewport2.maxDepth%20%3D%3D%3D%20void%200%20%3F%201%20%3A%20viewport2.maxDepth%3B%0A%20%20%20%20renderContext.viewportValue.copy%28viewport2%29.multiplyScalar%28pixelRatio%29.floor%28%29%3B%0A%20%20%20%20renderContext.viewportValue.width%20%3E%3E%3D%20activeMipmapLevel%3B%0A%20%20%20%20renderContext.viewportValue.height%20%3E%3E%3D%20activeMipmapLevel%3B%0A%20%20%20%20renderContext.viewportValue.minDepth%20%3D%20minDepth%3B%0A%20%20%20%20renderContext.viewportValue.maxDepth%20%3D%20maxDepth%3B%0A%20%20%20%20renderContext.viewport%20%3D%20renderContext.viewportValue.equals%28_screen%29%20%3D%3D%3D%20false%3B%0A%20%20%20%20renderContext.scissorValue.copy%28scissor%29.multiplyScalar%28pixelRatio%29.floor%28%29%3B%0A%20%20%20%20renderContext.scissor%20%3D%20this._scissorTest%20%26%26%20renderContext.scissorValue.equals%28_screen%29%20%3D%3D%3D%20false%3B%0A%20%20%20%20renderContext.scissorValue.width%20%3E%3E%3D%20activeMipmapLevel%3B%0A%20%20%20%20renderContext.scissorValue.height%20%3E%3E%3D%20activeMipmapLevel%3B%0A%20%20%20%20if%20%28%21renderContext.clippingContext%29%20renderContext.clippingContext%20%3D%20new%20ClippingContext%28%29%3B%0A%20%20%20%20renderContext.clippingContext.updateGlobal%28this%2C%20camera3%29%3B%0A%20%20%20%20sceneRef.onBeforeRender%28this%2C%20scene3%2C%20camera3%2C%20renderTarget%29%3B%0A%20%20%20%20_projScreenMatrix.multiplyMatrices%28camera3.projectionMatrix%2C%20camera3.matrixWorldInverse%29%3B%0A%20%20%20%20_frustum.setFromProjectionMatrix%28_projScreenMatrix%2C%20coordinateSystem%29%3B%0A%20%20%20%20const%20renderList%20%3D%20this._renderLists.get%28scene3%2C%20camera3%29%3B%0A%20%20%20%20renderList.begin%28%29%3B%0A%20%20%20%20this._projectObject%28scene3%2C%20camera3%2C%200%2C%20renderList%29%3B%0A%20%20%20%20renderList.finish%28%29%3B%0A%20%20%20%20if%20%28this.sortObjects%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20renderList.sort%28this._opaqueSort%2C%20this._transparentSort%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._textures.updateRenderTarget%28renderTarget%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20%20%20const%20renderTargetData%20%3D%20this._textures.get%28renderTarget%29%3B%0A%20%20%20%20%20%20renderContext.textures%20%3D%20renderTargetData.textures%3B%0A%20%20%20%20%20%20renderContext.depthTexture%20%3D%20renderTargetData.depthTexture%3B%0A%20%20%20%20%20%20renderContext.width%20%3D%20renderTargetData.width%3B%0A%20%20%20%20%20%20renderContext.height%20%3D%20renderTargetData.height%3B%0A%20%20%20%20%20%20renderContext.renderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20%20%20renderContext.depth%20%3D%20renderTarget.depthBuffer%3B%0A%20%20%20%20%20%20renderContext.stencil%20%3D%20renderTarget.stencilBuffer%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderContext.textures%20%3D%20null%3B%0A%20%20%20%20%20%20renderContext.depthTexture%20%3D%20null%3B%0A%20%20%20%20%20%20renderContext.width%20%3D%20this.domElement.width%3B%0A%20%20%20%20%20%20renderContext.height%20%3D%20this.domElement.height%3B%0A%20%20%20%20%20%20renderContext.depth%20%3D%20this.depth%3B%0A%20%20%20%20%20%20renderContext.stencil%20%3D%20this.stencil%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderContext.width%20%3E%3E%3D%20activeMipmapLevel%3B%0A%20%20%20%20renderContext.height%20%3E%3E%3D%20activeMipmapLevel%3B%0A%20%20%20%20renderContext.activeCubeFace%20%3D%20activeCubeFace%3B%0A%20%20%20%20renderContext.activeMipmapLevel%20%3D%20activeMipmapLevel%3B%0A%20%20%20%20renderContext.occlusionQueryCount%20%3D%20renderList.occlusionQueryCount%3B%0A%20%20%20%20this._nodes.updateScene%28sceneRef%29%3B%0A%20%20%20%20this._background.update%28sceneRef%2C%20renderList%2C%20renderContext%29%3B%0A%20%20%20%20this.backend.beginRender%28renderContext%29%3B%0A%20%20%20%20const%20%7B%0A%20%20%20%20%20%20bundles%2C%0A%20%20%20%20%20%20lightsNode%2C%0A%20%20%20%20%20%20transparentDoublePass%3A%20transparentDoublePassObjects%2C%0A%20%20%20%20%20%20transparent%3A%20transparentObjects%2C%0A%20%20%20%20%20%20opaque%3A%20opaqueObjects%0A%20%20%20%20%7D%20%3D%20renderList%3B%0A%20%20%20%20if%20%28bundles.length%20%3E%200%29%20this._renderBundles%28bundles%2C%20sceneRef%2C%20lightsNode%29%3B%0A%20%20%20%20if%20%28this.opaque%20%3D%3D%3D%20true%20%26%26%20opaqueObjects.length%20%3E%200%29%20this._renderObjects%28opaqueObjects%2C%20camera3%2C%20sceneRef%2C%20lightsNode%29%3B%0A%20%20%20%20if%20%28this.transparent%20%3D%3D%3D%20true%20%26%26%20transparentObjects.length%20%3E%200%29%20this._renderTransparents%28transparentObjects%2C%20transparentDoublePassObjects%2C%20camera3%2C%20sceneRef%2C%20lightsNode%29%3B%0A%20%20%20%20this.backend.finishRender%28renderContext%29%3B%0A%20%20%20%20nodeFrame.renderId%20%3D%20previousRenderId%3B%0A%20%20%20%20this._currentRenderContext%20%3D%20previousRenderContext%3B%0A%20%20%20%20this._currentRenderObjectFunction%20%3D%20previousRenderObjectFunction%3B%0A%20%20%20%20if%20%28frameBufferTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.setRenderTarget%28outputRenderTarget%2C%20activeCubeFace%2C%20activeMipmapLevel%29%3B%0A%20%20%20%20%20%20const%20quad%20%3D%20this._quad%3B%0A%20%20%20%20%20%20if%20%28this._nodes.hasOutputChange%28renderTarget.texture%29%29%20%7B%0A%20%20%20%20%20%20%20%20quad.material.fragmentNode%20%3D%20this._nodes.getOutputNode%28renderTarget.texture%29%3B%0A%20%20%20%20%20%20%20%20quad.material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._renderScene%28quad%2C%20quad.camera%2C%20false%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20sceneRef.onAfterRender%28this%2C%20scene3%2C%20camera3%2C%20renderTarget%29%3B%0A%20%20%20%20return%20renderContext%3B%0A%20%20%7D%0A%20%20getMaxAnisotropy%28%29%20%7B%0A%20%20%20%20return%20this.backend.getMaxAnisotropy%28%29%3B%0A%20%20%7D%0A%20%20getActiveCubeFace%28%29%20%7B%0A%20%20%20%20return%20this._activeCubeFace%3B%0A%20%20%7D%0A%20%20getActiveMipmapLevel%28%29%20%7B%0A%20%20%20%20return%20this._activeMipmapLevel%3B%0A%20%20%7D%0A%20%20async%20setAnimationLoop%28callback%29%20%7B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20await%20this.init%28%29%3B%0A%20%20%20%20this._animation.setAnimationLoop%28callback%29%3B%0A%20%20%7D%0A%20%20async%20getArrayBufferAsync%28attribute2%29%20%7B%0A%20%20%20%20return%20await%20this.backend.getArrayBufferAsync%28attribute2%29%3B%0A%20%20%7D%0A%20%20getContext%28%29%20%7B%0A%20%20%20%20return%20this.backend.getContext%28%29%3B%0A%20%20%7D%0A%20%20getPixelRatio%28%29%20%7B%0A%20%20%20%20return%20this._pixelRatio%3B%0A%20%20%7D%0A%20%20getDrawingBufferSize%28target%29%20%7B%0A%20%20%20%20return%20target.set%28this._width%20%2A%20this._pixelRatio%2C%20this._height%20%2A%20this._pixelRatio%29.floor%28%29%3B%0A%20%20%7D%0A%20%20getSize%28target%29%20%7B%0A%20%20%20%20return%20target.set%28this._width%2C%20this._height%29%3B%0A%20%20%7D%0A%20%20setPixelRatio%28value%20%3D%201%29%20%7B%0A%20%20%20%20if%20%28this._pixelRatio%20%3D%3D%3D%20value%29%20return%3B%0A%20%20%20%20this._pixelRatio%20%3D%20value%3B%0A%20%20%20%20this.setSize%28this._width%2C%20this._height%2C%20false%29%3B%0A%20%20%7D%0A%20%20setDrawingBufferSize%28width%2C%20height%2C%20pixelRatio%29%20%7B%0A%20%20%20%20this._width%20%3D%20width%3B%0A%20%20%20%20this._height%20%3D%20height%3B%0A%20%20%20%20this._pixelRatio%20%3D%20pixelRatio%3B%0A%20%20%20%20this.domElement.width%20%3D%20Math.floor%28width%20%2A%20pixelRatio%29%3B%0A%20%20%20%20this.domElement.height%20%3D%20Math.floor%28height%20%2A%20pixelRatio%29%3B%0A%20%20%20%20this.setViewport%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20if%20%28this._initialized%29%20this.backend.updateSize%28%29%3B%0A%20%20%7D%0A%20%20setSize%28width%2C%20height%2C%20updateStyle%20%3D%20true%29%20%7B%0A%20%20%20%20this._width%20%3D%20width%3B%0A%20%20%20%20this._height%20%3D%20height%3B%0A%20%20%20%20this.domElement.width%20%3D%20Math.floor%28width%20%2A%20this._pixelRatio%29%3B%0A%20%20%20%20this.domElement.height%20%3D%20Math.floor%28height%20%2A%20this._pixelRatio%29%3B%0A%20%20%20%20if%20%28updateStyle%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.domElement.style.width%20%3D%20width%20%2B%20%22px%22%3B%0A%20%20%20%20%20%20this.domElement.style.height%20%3D%20height%20%2B%20%22px%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.setViewport%280%2C%200%2C%20width%2C%20height%29%3B%0A%20%20%20%20if%20%28this._initialized%29%20this.backend.updateSize%28%29%3B%0A%20%20%7D%0A%20%20setOpaqueSort%28method%29%20%7B%0A%20%20%20%20this._opaqueSort%20%3D%20method%3B%0A%20%20%7D%0A%20%20setTransparentSort%28method%29%20%7B%0A%20%20%20%20this._transparentSort%20%3D%20method%3B%0A%20%20%7D%0A%20%20getScissor%28target%29%20%7B%0A%20%20%20%20const%20scissor%20%3D%20this._scissor%3B%0A%20%20%20%20target.x%20%3D%20scissor.x%3B%0A%20%20%20%20target.y%20%3D%20scissor.y%3B%0A%20%20%20%20target.width%20%3D%20scissor.width%3B%0A%20%20%20%20target.height%20%3D%20scissor.height%3B%0A%20%20%20%20return%20target%3B%0A%20%20%7D%0A%20%20setScissor%28x2%2C%20y2%2C%20width%2C%20height%29%20%7B%0A%20%20%20%20const%20scissor%20%3D%20this._scissor%3B%0A%20%20%20%20if%20%28x2.isVector4%29%20%7B%0A%20%20%20%20%20%20scissor.copy%28x2%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20scissor.set%28x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getScissorTest%28%29%20%7B%0A%20%20%20%20return%20this._scissorTest%3B%0A%20%20%7D%0A%20%20setScissorTest%28boolean%29%20%7B%0A%20%20%20%20this._scissorTest%20%3D%20boolean%3B%0A%20%20%20%20this.backend.setScissorTest%28boolean%29%3B%0A%20%20%7D%0A%20%20getViewport%28target%29%20%7B%0A%20%20%20%20return%20target.copy%28this._viewport%29%3B%0A%20%20%7D%0A%20%20setViewport%28x2%2C%20y2%2C%20width%2C%20height%2C%20minDepth%20%3D%200%2C%20maxDepth%20%3D%201%29%20%7B%0A%20%20%20%20const%20viewport2%20%3D%20this._viewport%3B%0A%20%20%20%20if%20%28x2.isVector4%29%20%7B%0A%20%20%20%20%20%20viewport2.copy%28x2%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20viewport2.set%28x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20viewport2.minDepth%20%3D%20minDepth%3B%0A%20%20%20%20viewport2.maxDepth%20%3D%20maxDepth%3B%0A%20%20%7D%0A%20%20getClearColor%28target%29%20%7B%0A%20%20%20%20return%20target.copy%28this._clearColor%29%3B%0A%20%20%7D%0A%20%20setClearColor%28color2%2C%20alpha%20%3D%201%29%20%7B%0A%20%20%20%20this._clearColor.set%28color2%29%3B%0A%20%20%20%20this._clearColor.a%20%3D%20alpha%3B%0A%20%20%7D%0A%20%20getClearAlpha%28%29%20%7B%0A%20%20%20%20return%20this._clearColor.a%3B%0A%20%20%7D%0A%20%20setClearAlpha%28alpha%29%20%7B%0A%20%20%20%20this._clearColor.a%20%3D%20alpha%3B%0A%20%20%7D%0A%20%20getClearDepth%28%29%20%7B%0A%20%20%20%20return%20this._clearDepth%3B%0A%20%20%7D%0A%20%20setClearDepth%28depth2%29%20%7B%0A%20%20%20%20this._clearDepth%20%3D%20depth2%3B%0A%20%20%7D%0A%20%20getClearStencil%28%29%20%7B%0A%20%20%20%20return%20this._clearStencil%3B%0A%20%20%7D%0A%20%20setClearStencil%28stencil%29%20%7B%0A%20%20%20%20this._clearStencil%20%3D%20stencil%3B%0A%20%20%7D%0A%20%20isOccluded%28object%29%20%7B%0A%20%20%20%20const%20renderContext%20%3D%20this._currentRenderContext%3B%0A%20%20%20%20return%20renderContext%20%26%26%20this.backend.isOccluded%28renderContext%2C%20object%29%3B%0A%20%20%7D%0A%20%20clear%28color2%20%3D%20true%2C%20depth2%20%3D%20true%2C%20stencil%20%3D%20true%29%20%7B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.Renderer%3A%20.clear%28%29%20called%20before%20the%20backend%20is%20initialized.%20Try%20using%20.clearAsync%28%29%20instead.%22%29%3B%0A%20%20%20%20%20%20return%20this.clearAsync%28color2%2C%20depth2%2C%20stencil%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20renderTarget%20%3D%20this._renderTarget%20%7C%7C%20this._getFrameBufferTarget%28%29%3B%0A%20%20%20%20let%20renderTargetData%20%3D%20null%3B%0A%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._textures.updateRenderTarget%28renderTarget%29%3B%0A%20%20%20%20%20%20renderTargetData%20%3D%20this._textures.get%28renderTarget%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.backend.clear%28color2%2C%20depth2%2C%20stencil%2C%20renderTargetData%29%3B%0A%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%20%26%26%20this._renderTarget%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20quad%20%3D%20this._quad%3B%0A%20%20%20%20%20%20if%20%28this._nodes.hasOutputChange%28renderTarget.texture%29%29%20%7B%0A%20%20%20%20%20%20%20%20quad.material.fragmentNode%20%3D%20this._nodes.getOutputNode%28renderTarget.texture%29%3B%0A%20%20%20%20%20%20%20%20quad.material.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._renderScene%28quad%2C%20quad.camera%2C%20false%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clearColor%28%29%20%7B%0A%20%20%20%20return%20this.clear%28true%2C%20false%2C%20false%29%3B%0A%20%20%7D%0A%20%20clearDepth%28%29%20%7B%0A%20%20%20%20return%20this.clear%28false%2C%20true%2C%20false%29%3B%0A%20%20%7D%0A%20%20clearStencil%28%29%20%7B%0A%20%20%20%20return%20this.clear%28false%2C%20false%2C%20true%29%3B%0A%20%20%7D%0A%20%20async%20clearAsync%28color2%20%3D%20true%2C%20depth2%20%3D%20true%2C%20stencil%20%3D%20true%29%20%7B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20await%20this.init%28%29%3B%0A%20%20%20%20this.clear%28color2%2C%20depth2%2C%20stencil%29%3B%0A%20%20%7D%0A%20%20clearColorAsync%28%29%20%7B%0A%20%20%20%20return%20this.clearAsync%28true%2C%20false%2C%20false%29%3B%0A%20%20%7D%0A%20%20clearDepthAsync%28%29%20%7B%0A%20%20%20%20return%20this.clearAsync%28false%2C%20true%2C%20false%29%3B%0A%20%20%7D%0A%20%20clearStencilAsync%28%29%20%7B%0A%20%20%20%20return%20this.clearAsync%28false%2C%20false%2C%20true%29%3B%0A%20%20%7D%0A%20%20get%20currentToneMapping%28%29%20%7B%0A%20%20%20%20return%20this._renderTarget%20%21%3D%3D%20null%20%3F%20NoToneMapping2%20%3A%20this.toneMapping%3B%0A%20%20%7D%0A%20%20get%20currentColorSpace%28%29%20%7B%0A%20%20%20%20return%20this._renderTarget%20%21%3D%3D%20null%20%3F%20LinearSRGBColorSpace2%20%3A%20this.outputColorSpace%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.info.dispose%28%29%3B%0A%20%20%20%20this.backend.dispose%28%29%3B%0A%20%20%20%20this._animation.dispose%28%29%3B%0A%20%20%20%20this._objects.dispose%28%29%3B%0A%20%20%20%20this._pipelines.dispose%28%29%3B%0A%20%20%20%20this._nodes.dispose%28%29%3B%0A%20%20%20%20this._bindings.dispose%28%29%3B%0A%20%20%20%20this._renderLists.dispose%28%29%3B%0A%20%20%20%20this._renderContexts.dispose%28%29%3B%0A%20%20%20%20this._textures.dispose%28%29%3B%0A%20%20%20%20this.setRenderTarget%28null%29%3B%0A%20%20%20%20this.setAnimationLoop%28null%29%3B%0A%20%20%7D%0A%20%20setRenderTarget%28renderTarget%2C%20activeCubeFace%20%3D%200%2C%20activeMipmapLevel%20%3D%200%29%20%7B%0A%20%20%20%20this._renderTarget%20%3D%20renderTarget%3B%0A%20%20%20%20this._activeCubeFace%20%3D%20activeCubeFace%3B%0A%20%20%20%20this._activeMipmapLevel%20%3D%20activeMipmapLevel%3B%0A%20%20%7D%0A%20%20getRenderTarget%28%29%20%7B%0A%20%20%20%20return%20this._renderTarget%3B%0A%20%20%7D%0A%20%20setRenderObjectFunction%28renderObjectFunction%29%20%7B%0A%20%20%20%20this._renderObjectFunction%20%3D%20renderObjectFunction%3B%0A%20%20%7D%0A%20%20getRenderObjectFunction%28%29%20%7B%0A%20%20%20%20return%20this._renderObjectFunction%3B%0A%20%20%7D%0A%20%20compute%28computeNodes%29%20%7B%0A%20%20%20%20if%20%28this.isDeviceLost%20%3D%3D%3D%20true%29%20return%3B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.Renderer%3A%20.compute%28%29%20called%20before%20the%20backend%20is%20initialized.%20Try%20using%20.computeAsync%28%29%20instead.%22%29%3B%0A%20%20%20%20%20%20return%20this.computeAsync%28computeNodes%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20nodeFrame%20%3D%20this._nodes.nodeFrame%3B%0A%20%20%20%20const%20previousRenderId%20%3D%20nodeFrame.renderId%3B%0A%20%20%20%20this.info.calls%2B%2B%3B%0A%20%20%20%20this.info.compute.calls%2B%2B%3B%0A%20%20%20%20this.info.compute.frameCalls%2B%2B%3B%0A%20%20%20%20nodeFrame.renderId%20%3D%20this.info.calls%3B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20pipelines%20%3D%20this._pipelines%3B%0A%20%20%20%20const%20bindings%20%3D%20this._bindings%3B%0A%20%20%20%20const%20nodes%20%3D%20this._nodes%3B%0A%20%20%20%20const%20computeList%20%3D%20Array.isArray%28computeNodes%29%20%3F%20computeNodes%20%3A%20%5BcomputeNodes%5D%3B%0A%20%20%20%20if%20%28computeList%5B0%5D%20%3D%3D%3D%20void%200%20%7C%7C%20computeList%5B0%5D.isComputeNode%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.Renderer%3A%20.compute%28%29%20expects%20a%20ComputeNode.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20backend.beginCompute%28computeNodes%29%3B%0A%20%20%20%20for%20%28const%20computeNode%20of%20computeList%29%20%7B%0A%20%20%20%20%20%20if%20%28pipelines.has%28computeNode%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20const%20dispose%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20computeNode.removeEventListener%28%22dispose%22%2C%20dispose%29%3B%0A%20%20%20%20%20%20%20%20%20%20pipelines.delete%28computeNode%29%3B%0A%20%20%20%20%20%20%20%20%20%20bindings.delete%28computeNode%29%3B%0A%20%20%20%20%20%20%20%20%20%20nodes.delete%28computeNode%29%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20computeNode.addEventListener%28%22dispose%22%2C%20dispose%29%3B%0A%20%20%20%20%20%20%20%20const%20onInitFn%20%3D%20computeNode.onInitFunction%3B%0A%20%20%20%20%20%20%20%20if%20%28onInitFn%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20onInitFn.call%28computeNode%2C%20%7B%20renderer%3A%20this%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20nodes.updateForCompute%28computeNode%29%3B%0A%20%20%20%20%20%20bindings.updateForCompute%28computeNode%29%3B%0A%20%20%20%20%20%20const%20computeBindings%20%3D%20bindings.getForCompute%28computeNode%29%3B%0A%20%20%20%20%20%20const%20computePipeline%20%3D%20pipelines.getForCompute%28computeNode%2C%20computeBindings%29%3B%0A%20%20%20%20%20%20backend.compute%28computeNodes%2C%20computeNode%2C%20computeBindings%2C%20computePipeline%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20backend.finishCompute%28computeNodes%29%3B%0A%20%20%20%20nodeFrame.renderId%20%3D%20previousRenderId%3B%0A%20%20%7D%0A%20%20async%20computeAsync%28computeNodes%29%20%7B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20await%20this.init%28%29%3B%0A%20%20%20%20this.compute%28computeNodes%29%3B%0A%20%20%20%20await%20this.backend.resolveTimestampAsync%28computeNodes%2C%20%22compute%22%29%3B%0A%20%20%7D%0A%20%20async%20hasFeatureAsync%28name%29%20%7B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20await%20this.init%28%29%3B%0A%20%20%20%20return%20this.backend.hasFeature%28name%29%3B%0A%20%20%7D%0A%20%20hasFeature%28name%29%20%7B%0A%20%20%20%20if%20%28this._initialized%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.Renderer%3A%20.hasFeature%28%29%20called%20before%20the%20backend%20is%20initialized.%20Try%20using%20.hasFeatureAsync%28%29%20instead.%22%29%3B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.backend.hasFeature%28name%29%3B%0A%20%20%7D%0A%20%20copyFramebufferToTexture%28framebufferTexture%2C%20rectangle%20%3D%20null%29%20%7B%0A%20%20%20%20if%20%28rectangle%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28rectangle.isVector2%29%20%7B%0A%20%20%20%20%20%20%20%20rectangle%20%3D%20_vector4.set%28rectangle.x%2C%20rectangle.y%2C%20framebufferTexture.image.width%2C%20framebufferTexture.image.height%29.floor%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28rectangle.isVector4%29%20%7B%0A%20%20%20%20%20%20%20%20rectangle%20%3D%20_vector4.copy%28rectangle%29.floor%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.Renderer.copyFramebufferToTexture%3A%20Invalid%20rectangle.%22%29%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20rectangle%20%3D%20_vector4.set%280%2C%200%2C%20framebufferTexture.image.width%2C%20framebufferTexture.image.height%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20renderContext%20%3D%20this._currentRenderContext%3B%0A%20%20%20%20let%20renderTarget%3B%0A%20%20%20%20if%20%28renderContext%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20renderTarget%20%3D%20renderContext.renderTarget%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderTarget%20%3D%20this._renderTarget%20%7C%7C%20this._getFrameBufferTarget%28%29%3B%0A%20%20%20%20%20%20if%20%28renderTarget%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this._textures.updateRenderTarget%28renderTarget%29%3B%0A%20%20%20%20%20%20%20%20renderContext%20%3D%20this._textures.get%28renderTarget%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this._textures.updateTexture%28framebufferTexture%2C%20%7B%20renderTarget%20%7D%29%3B%0A%20%20%20%20this.backend.copyFramebufferToTexture%28framebufferTexture%2C%20renderContext%2C%20rectangle%29%3B%0A%20%20%7D%0A%20%20copyTextureToTexture%28srcTexture%2C%20dstTexture%2C%20srcRegion%20%3D%20null%2C%20dstPosition%20%3D%20null%2C%20level%20%3D%200%29%20%7B%0A%20%20%20%20this._textures.updateTexture%28srcTexture%29%3B%0A%20%20%20%20this._textures.updateTexture%28dstTexture%29%3B%0A%20%20%20%20this.backend.copyTextureToTexture%28srcTexture%2C%20dstTexture%2C%20srcRegion%2C%20dstPosition%2C%20level%29%3B%0A%20%20%7D%0A%20%20readRenderTargetPixelsAsync%28renderTarget%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20index5%20%3D%200%2C%20faceIndex%20%3D%200%29%20%7B%0A%20%20%20%20return%20this.backend.copyTextureToBuffer%28renderTarget.textures%5Bindex5%5D%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20faceIndex%29%3B%0A%20%20%7D%0A%20%20_projectObject%28object%2C%20camera3%2C%20groupOrder%2C%20renderList%29%20%7B%0A%20%20%20%20if%20%28object.visible%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20const%20visible%20%3D%20object.layers.test%28camera3.layers%29%3B%0A%20%20%20%20if%20%28visible%29%20%7B%0A%20%20%20%20%20%20if%20%28object.isGroup%29%20%7B%0A%20%20%20%20%20%20%20%20groupOrder%20%3D%20object.renderOrder%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28object.isLOD%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28object.autoUpdate%20%3D%3D%3D%20true%29%20object.update%28camera3%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28object.isLight%29%20%7B%0A%20%20%20%20%20%20%20%20renderList.pushLight%28object%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28object.isSprite%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21object.frustumCulled%20%7C%7C%20_frustum.intersectsSprite%28object%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.sortObjects%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector4.setFromMatrixPosition%28object.matrixWorld%29.applyMatrix4%28_projScreenMatrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20const%20%7B%20geometry%2C%20material%20%7D%20%3D%20object%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28material.visible%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderList.push%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20_vector4.z%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28object.isLineLoop%29%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.Renderer%3A%20Objects%20of%20type%20THREE.LineLoop%20are%20not%20supported.%20Please%20use%20THREE.Line%20or%20THREE.LineSegments.%22%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28object.isMesh%20%7C%7C%20object.isLine%20%7C%7C%20object.isPoints%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21object.frustumCulled%20%7C%7C%20_frustum.intersectsObject%28object%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20%7B%20geometry%2C%20material%20%7D%20%3D%20object%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.sortObjects%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28geometry.boundingSphere%20%3D%3D%3D%20null%29%20geometry.computeBoundingSphere%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_vector4.copy%28geometry.boundingSphere.center%29.applyMatrix4%28object.matrixWorld%29.applyMatrix4%28_projScreenMatrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28Array.isArray%28material%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20groups%20%3D%20geometry.groups%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20groups.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20group%20%3D%20groups%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20groupMaterial%20%3D%20material%5Bgroup.materialIndex%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28groupMaterial%20%26%26%20groupMaterial.visible%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20renderList.push%28object%2C%20geometry%2C%20groupMaterial%2C%20groupOrder%2C%20_vector4.z%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28material.visible%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderList.push%28object%2C%20geometry%2C%20material%2C%20groupOrder%2C%20_vector4.z%2C%20null%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isBundleGroup%20%3D%3D%3D%20true%20%26%26%20this.backend.beginBundle%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20baseRenderList%20%3D%20renderList%3B%0A%20%20%20%20%20%20renderList%20%3D%20this._renderLists.get%28object%2C%20camera3%29%3B%0A%20%20%20%20%20%20renderList.begin%28%29%3B%0A%20%20%20%20%20%20baseRenderList.pushBundle%28%7B%0A%20%20%20%20%20%20%20%20bundleGroup%3A%20object%2C%0A%20%20%20%20%20%20%20%20camera%3A%20camera3%2C%0A%20%20%20%20%20%20%20%20renderList%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20renderList.finish%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20children%20%3D%20object.children%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20children.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this._projectObject%28children%5Bi%5D%2C%20camera3%2C%20groupOrder%2C%20renderList%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_renderBundles%28bundles%2C%20sceneRef%2C%20lightsNode%29%20%7B%0A%20%20%20%20for%20%28const%20bundle%20of%20bundles%29%20%7B%0A%20%20%20%20%20%20this._renderBundle%28bundle%2C%20sceneRef%2C%20lightsNode%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_renderTransparents%28renderList%2C%20doublePassList%2C%20camera3%2C%20scene3%2C%20lightsNode%29%20%7B%0A%20%20%20%20if%20%28doublePassList.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20%7B%20material%20%7D%20of%20doublePassList%29%20%7B%0A%20%20%20%20%20%20%20%20material.side%20%3D%20BackSide2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._renderObjects%28doublePassList%2C%20camera3%2C%20scene3%2C%20lightsNode%2C%20%22backSide%22%29%3B%0A%20%20%20%20%20%20for%20%28const%20%7B%20material%20%7D%20of%20doublePassList%29%20%7B%0A%20%20%20%20%20%20%20%20material.side%20%3D%20FrontSide2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._renderObjects%28renderList%2C%20camera3%2C%20scene3%2C%20lightsNode%29%3B%0A%20%20%20%20%20%20for%20%28const%20%7B%20material%20%7D%20of%20doublePassList%29%20%7B%0A%20%20%20%20%20%20%20%20material.side%20%3D%20DoubleSide2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._renderObjects%28renderList%2C%20camera3%2C%20scene3%2C%20lightsNode%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_renderObjects%28renderList%2C%20camera3%2C%20scene3%2C%20lightsNode%2C%20passId%20%3D%20null%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20renderList.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20renderItem%20%3D%20renderList%5Bi%5D%3B%0A%20%20%20%20%20%20const%20%7B%20object%2C%20geometry%2C%20material%2C%20group%20%7D%20%3D%20renderItem%3B%0A%20%20%20%20%20%20if%20%28camera3.isArrayCamera%29%20%7B%0A%20%20%20%20%20%20%20%20const%20cameras%20%3D%20camera3.cameras%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20j%20%3D%200%2C%20jl%20%3D%20cameras.length%3B%20j%20%3C%20jl%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20camera22%20%3D%20cameras%5Bj%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28object.layers.test%28camera22.layers%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20vp%20%3D%20camera22.viewport%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20minDepth%20%3D%20vp.minDepth%20%3D%3D%3D%20void%200%20%3F%200%20%3A%20vp.minDepth%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20maxDepth%20%3D%20vp.maxDepth%20%3D%3D%3D%20void%200%20%3F%201%20%3A%20vp.maxDepth%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20viewportValue%20%3D%20this._currentRenderContext.viewportValue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20viewportValue.copy%28vp%29.multiplyScalar%28this._pixelRatio%29.floor%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20viewportValue.minDepth%20%3D%20minDepth%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20viewportValue.maxDepth%20%3D%20maxDepth%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.backend.updateViewport%28this._currentRenderContext%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._currentRenderObjectFunction%28object%2C%20scene3%2C%20camera22%2C%20geometry%2C%20material%2C%20group%2C%20lightsNode%2C%20passId%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this._currentRenderObjectFunction%28object%2C%20scene3%2C%20camera3%2C%20geometry%2C%20material%2C%20group%2C%20lightsNode%2C%20passId%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20renderObject%28object%2C%20scene3%2C%20camera3%2C%20geometry%2C%20material%2C%20group%2C%20lightsNode%2C%20passId%20%3D%20null%29%20%7B%0A%20%20%20%20let%20overridePositionNode%3B%0A%20%20%20%20let%20overrideFragmentNode%3B%0A%20%20%20%20let%20overrideDepthNode%3B%0A%20%20%20%20object.onBeforeRender%28this%2C%20scene3%2C%20camera3%2C%20geometry%2C%20material%2C%20group%29%3B%0A%20%20%20%20if%20%28scene3.overrideMaterial%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20overrideMaterial%20%3D%20scene3.overrideMaterial%3B%0A%20%20%20%20%20%20if%20%28material.positionNode%20%26%26%20material.positionNode.isNode%29%20%7B%0A%20%20%20%20%20%20%20%20overridePositionNode%20%3D%20overrideMaterial.positionNode%3B%0A%20%20%20%20%20%20%20%20overrideMaterial.positionNode%20%3D%20material.positionNode%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28overrideMaterial.isShadowNodeMaterial%29%20%7B%0A%20%20%20%20%20%20%20%20overrideMaterial.side%20%3D%20material.shadowSide%20%3D%3D%3D%20null%20%3F%20material.side%20%3A%20material.shadowSide%3B%0A%20%20%20%20%20%20%20%20if%20%28material.depthNode%20%26%26%20material.depthNode.isNode%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20overrideDepthNode%20%3D%20overrideMaterial.depthNode%3B%0A%20%20%20%20%20%20%20%20%20%20overrideMaterial.depthNode%20%3D%20material.depthNode%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28material.shadowNode%20%26%26%20material.shadowNode.isNode%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20overrideFragmentNode%20%3D%20overrideMaterial.fragmentNode%3B%0A%20%20%20%20%20%20%20%20%20%20overrideMaterial.fragmentNode%20%3D%20material.shadowNode%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28this.localClippingEnabled%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28material.clipShadows%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28overrideMaterial.clippingPlanes%20%21%3D%3D%20material.clippingPlanes%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20overrideMaterial.clippingPlanes%20%3D%20material.clippingPlanes%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20overrideMaterial.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28overrideMaterial.clipIntersection%20%21%3D%3D%20material.clipIntersection%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20overrideMaterial.clipIntersection%20%3D%20material.clipIntersection%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28Array.isArray%28overrideMaterial.clippingPlanes%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20overrideMaterial.clippingPlanes%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20overrideMaterial.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20material%20%3D%20overrideMaterial%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28material.transparent%20%3D%3D%3D%20true%20%26%26%20material.side%20%3D%3D%3D%20DoubleSide2%20%26%26%20material.forceSinglePass%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20material.side%20%3D%20BackSide2%3B%0A%20%20%20%20%20%20this._handleObjectFunction%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20group%2C%20%22backSide%22%29%3B%0A%20%20%20%20%20%20material.side%20%3D%20FrontSide2%3B%0A%20%20%20%20%20%20this._handleObjectFunction%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20group%2C%20passId%29%3B%0A%20%20%20%20%20%20material.side%20%3D%20DoubleSide2%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._handleObjectFunction%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20group%2C%20passId%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28overridePositionNode%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20scene3.overrideMaterial.positionNode%20%3D%20overridePositionNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28overrideDepthNode%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20scene3.overrideMaterial.depthNode%20%3D%20overrideDepthNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28overrideFragmentNode%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20scene3.overrideMaterial.fragmentNode%20%3D%20overrideFragmentNode%3B%0A%20%20%20%20%7D%0A%20%20%20%20object.onAfterRender%28this%2C%20scene3%2C%20camera3%2C%20geometry%2C%20material%2C%20group%29%3B%0A%20%20%7D%0A%20%20_renderObjectDirect%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20group%2C%20passId%29%20%7B%0A%20%20%20%20const%20renderObject%20%3D%20this._objects.get%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20this._currentRenderContext%2C%20passId%29%3B%0A%20%20%20%20renderObject.drawRange%20%3D%20object.geometry.drawRange%3B%0A%20%20%20%20renderObject.group%20%3D%20group%3B%0A%20%20%20%20const%20needsRefresh%20%3D%20this._nodes.needsRefresh%28renderObject%29%3B%0A%20%20%20%20if%20%28needsRefresh%29%20%7B%0A%20%20%20%20%20%20this._nodes.updateBefore%28renderObject%29%3B%0A%20%20%20%20%20%20this._geometries.updateForRender%28renderObject%29%3B%0A%20%20%20%20%20%20this._nodes.updateForRender%28renderObject%29%3B%0A%20%20%20%20%20%20this._bindings.updateForRender%28renderObject%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._pipelines.updateForRender%28renderObject%29%3B%0A%20%20%20%20if%20%28this._currentRenderBundle%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20renderBundleData%20%3D%20this.backend.get%28this._currentRenderBundle%29%3B%0A%20%20%20%20%20%20renderBundleData.renderObjects.push%28renderObject%29%3B%0A%20%20%20%20%20%20renderObject.bundle%20%3D%20this._currentRenderBundle.scene%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.backend.draw%28renderObject%2C%20this.info%29%3B%0A%20%20%20%20if%20%28needsRefresh%29%20this._nodes.updateAfter%28renderObject%29%3B%0A%20%20%7D%0A%20%20_createObjectPipeline%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20passId%29%20%7B%0A%20%20%20%20const%20renderObject%20%3D%20this._objects.get%28object%2C%20material%2C%20scene3%2C%20camera3%2C%20lightsNode%2C%20this._currentRenderContext%2C%20passId%29%3B%0A%20%20%20%20this._nodes.updateBefore%28renderObject%29%3B%0A%20%20%20%20this._geometries.updateForRender%28renderObject%29%3B%0A%20%20%20%20this._nodes.updateForRender%28renderObject%29%3B%0A%20%20%20%20this._bindings.updateForRender%28renderObject%29%3B%0A%20%20%20%20this._pipelines.getForRender%28renderObject%2C%20this._compilationPromises%29%3B%0A%20%20%20%20this._nodes.updateAfter%28renderObject%29%3B%0A%20%20%7D%0A%20%20get%20compile%28%29%20%7B%0A%20%20%20%20return%20this.compileAsync%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Binding%20%3D%20class%20%7B%0A%20%20constructor%28name%20%3D%20%22%22%29%20%7B%0A%20%20%20%20this.name%20%3D%20name%3B%0A%20%20%20%20this.visibility%20%3D%200%3B%0A%20%20%7D%0A%20%20setVisibility%28visibility%29%20%7B%0A%20%20%20%20this.visibility%20%7C%3D%20visibility%3B%0A%20%20%7D%0A%20%20clone%28%29%20%7B%0A%20%20%20%20return%20Object.assign%28new%20this.constructor%28%29%2C%20this%29%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20getFloatLength%28floatLength%29%20%7B%0A%20%20return%20floatLength%20%2B%20%28GPU_CHUNK_BYTES%20-%20floatLength%20%25%20GPU_CHUNK_BYTES%29%20%25%20GPU_CHUNK_BYTES%3B%0A%7D%0Avar%20Buffer2%20%3D%20class%20extends%20Binding%20%7B%0A%20%20constructor%28name%2C%20buffer2%20%3D%20null%29%20%7B%0A%20%20%20%20super%28name%29%3B%0A%20%20%20%20this.isBuffer%20%3D%20true%3B%0A%20%20%20%20this.bytesPerElement%20%3D%20Float32Array.BYTES_PER_ELEMENT%3B%0A%20%20%20%20this._buffer%20%3D%20buffer2%3B%0A%20%20%7D%0A%20%20get%20byteLength%28%29%20%7B%0A%20%20%20%20return%20getFloatLength%28this._buffer.byteLength%29%3B%0A%20%20%7D%0A%20%20get%20buffer%28%29%20%7B%0A%20%20%20%20return%20this._buffer%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20UniformBuffer%20%3D%20class%20extends%20Buffer2%20%7B%0A%20%20constructor%28name%2C%20buffer2%20%3D%20null%29%20%7B%0A%20%20%20%20super%28name%2C%20buffer2%29%3B%0A%20%20%20%20this.isUniformBuffer%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_id%244%20%3D%200%3B%0Avar%20NodeUniformBuffer%20%3D%20class%20extends%20UniformBuffer%20%7B%0A%20%20constructor%28nodeUniform%2C%20groupNode%29%20%7B%0A%20%20%20%20super%28%22UniformBuffer_%22%20%2B%20_id%244%2B%2B%2C%20nodeUniform%20%3F%20nodeUniform.value%20%3A%20null%29%3B%0A%20%20%20%20this.nodeUniform%20%3D%20nodeUniform%3B%0A%20%20%20%20this.groupNode%20%3D%20groupNode%3B%0A%20%20%7D%0A%20%20get%20buffer%28%29%20%7B%0A%20%20%20%20return%20this.nodeUniform.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20UniformsGroup%20%3D%20class%20extends%20UniformBuffer%20%7B%0A%20%20constructor%28name%29%20%7B%0A%20%20%20%20super%28name%29%3B%0A%20%20%20%20this.isUniformsGroup%20%3D%20true%3B%0A%20%20%20%20this._values%20%3D%20null%3B%0A%20%20%20%20this.uniforms%20%3D%20%5B%5D%3B%0A%20%20%7D%0A%20%20addUniform%28uniform2%29%20%7B%0A%20%20%20%20this.uniforms.push%28uniform2%29%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20removeUniform%28uniform2%29%20%7B%0A%20%20%20%20const%20index5%20%3D%20this.uniforms.indexOf%28uniform2%29%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20this.uniforms.splice%28index5%2C%201%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%20%20get%20values%28%29%20%7B%0A%20%20%20%20if%20%28this._values%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._values%20%3D%20Array.from%28this.buffer%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this._values%3B%0A%20%20%7D%0A%20%20get%20buffer%28%29%20%7B%0A%20%20%20%20let%20buffer2%20%3D%20this._buffer%3B%0A%20%20%20%20if%20%28buffer2%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20byteLength%20%3D%20this.byteLength%3B%0A%20%20%20%20%20%20buffer2%20%3D%20new%20Float32Array%28new%20ArrayBuffer%28byteLength%29%29%3B%0A%20%20%20%20%20%20this._buffer%20%3D%20buffer2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20buffer2%3B%0A%20%20%7D%0A%20%20get%20byteLength%28%29%20%7B%0A%20%20%20%20let%20offset%20%3D%200%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20this.uniforms.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20uniform2%20%3D%20this.uniforms%5Bi%5D%3B%0A%20%20%20%20%20%20const%20%7B%20boundary%2C%20itemSize%20%7D%20%3D%20uniform2%3B%0A%20%20%20%20%20%20const%20chunkOffset%20%3D%20offset%20%25%20GPU_CHUNK_BYTES%3B%0A%20%20%20%20%20%20const%20remainingSizeInChunk%20%3D%20GPU_CHUNK_BYTES%20-%20chunkOffset%3B%0A%20%20%20%20%20%20if%20%28chunkOffset%20%21%3D%3D%200%20%26%26%20remainingSizeInChunk%20-%20boundary%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20offset%20%2B%3D%20GPU_CHUNK_BYTES%20-%20chunkOffset%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28chunkOffset%20%25%20boundary%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20offset%20%2B%3D%20chunkOffset%20%25%20boundary%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20uniform2.offset%20%3D%20offset%20%2F%20this.bytesPerElement%3B%0A%20%20%20%20%20%20offset%20%2B%3D%20itemSize%20%2A%20this.bytesPerElement%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20Math.ceil%28offset%20%2F%20GPU_CHUNK_BYTES%29%20%2A%20GPU_CHUNK_BYTES%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20let%20updated%20%3D%20false%3B%0A%20%20%20%20for%20%28const%20uniform2%20of%20this.uniforms%29%20%7B%0A%20%20%20%20%20%20if%20%28this.updateByType%28uniform2%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20updated%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20updated%3B%0A%20%20%7D%0A%20%20updateByType%28uniform2%29%20%7B%0A%20%20%20%20if%20%28uniform2.isNumberUniform%29%20return%20this.updateNumber%28uniform2%29%3B%0A%20%20%20%20if%20%28uniform2.isVector2Uniform%29%20return%20this.updateVector2%28uniform2%29%3B%0A%20%20%20%20if%20%28uniform2.isVector3Uniform%29%20return%20this.updateVector3%28uniform2%29%3B%0A%20%20%20%20if%20%28uniform2.isVector4Uniform%29%20return%20this.updateVector4%28uniform2%29%3B%0A%20%20%20%20if%20%28uniform2.isColorUniform%29%20return%20this.updateColor%28uniform2%29%3B%0A%20%20%20%20if%20%28uniform2.isMatrix3Uniform%29%20return%20this.updateMatrix3%28uniform2%29%3B%0A%20%20%20%20if%20%28uniform2.isMatrix4Uniform%29%20return%20this.updateMatrix4%28uniform2%29%3B%0A%20%20%20%20console.error%28%22THREE.WebGPUUniformsGroup%3A%20Unsupported%20uniform%20type.%22%2C%20uniform2%29%3B%0A%20%20%7D%0A%20%20updateNumber%28uniform2%29%20%7B%0A%20%20%20%20let%20updated%20%3D%20false%3B%0A%20%20%20%20const%20a2%20%3D%20this.values%3B%0A%20%20%20%20const%20v%20%3D%20uniform2.getValue%28%29%3B%0A%20%20%20%20const%20offset%20%3D%20uniform2.offset%3B%0A%20%20%20%20if%20%28a2%5Boffset%5D%20%21%3D%3D%20v%29%20%7B%0A%20%20%20%20%20%20const%20b%20%3D%20this.buffer%3B%0A%20%20%20%20%20%20b%5Boffset%5D%20%3D%20a2%5Boffset%5D%20%3D%20v%3B%0A%20%20%20%20%20%20updated%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20updated%3B%0A%20%20%7D%0A%20%20updateVector2%28uniform2%29%20%7B%0A%20%20%20%20let%20updated%20%3D%20false%3B%0A%20%20%20%20const%20a2%20%3D%20this.values%3B%0A%20%20%20%20const%20v%20%3D%20uniform2.getValue%28%29%3B%0A%20%20%20%20const%20offset%20%3D%20uniform2.offset%3B%0A%20%20%20%20if%20%28a2%5Boffset%20%2B%200%5D%20%21%3D%3D%20v.x%20%7C%7C%20a2%5Boffset%20%2B%201%5D%20%21%3D%3D%20v.y%29%20%7B%0A%20%20%20%20%20%20const%20b%20%3D%20this.buffer%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%200%5D%20%3D%20a2%5Boffset%20%2B%200%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%201%5D%20%3D%20a2%5Boffset%20%2B%201%5D%20%3D%20v.y%3B%0A%20%20%20%20%20%20updated%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20updated%3B%0A%20%20%7D%0A%20%20updateVector3%28uniform2%29%20%7B%0A%20%20%20%20let%20updated%20%3D%20false%3B%0A%20%20%20%20const%20a2%20%3D%20this.values%3B%0A%20%20%20%20const%20v%20%3D%20uniform2.getValue%28%29%3B%0A%20%20%20%20const%20offset%20%3D%20uniform2.offset%3B%0A%20%20%20%20if%20%28a2%5Boffset%20%2B%200%5D%20%21%3D%3D%20v.x%20%7C%7C%20a2%5Boffset%20%2B%201%5D%20%21%3D%3D%20v.y%20%7C%7C%20a2%5Boffset%20%2B%202%5D%20%21%3D%3D%20v.z%29%20%7B%0A%20%20%20%20%20%20const%20b%20%3D%20this.buffer%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%200%5D%20%3D%20a2%5Boffset%20%2B%200%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%201%5D%20%3D%20a2%5Boffset%20%2B%201%5D%20%3D%20v.y%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%202%5D%20%3D%20a2%5Boffset%20%2B%202%5D%20%3D%20v.z%3B%0A%20%20%20%20%20%20updated%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20updated%3B%0A%20%20%7D%0A%20%20updateVector4%28uniform2%29%20%7B%0A%20%20%20%20let%20updated%20%3D%20false%3B%0A%20%20%20%20const%20a2%20%3D%20this.values%3B%0A%20%20%20%20const%20v%20%3D%20uniform2.getValue%28%29%3B%0A%20%20%20%20const%20offset%20%3D%20uniform2.offset%3B%0A%20%20%20%20if%20%28a2%5Boffset%20%2B%200%5D%20%21%3D%3D%20v.x%20%7C%7C%20a2%5Boffset%20%2B%201%5D%20%21%3D%3D%20v.y%20%7C%7C%20a2%5Boffset%20%2B%202%5D%20%21%3D%3D%20v.z%20%7C%7C%20a2%5Boffset%20%2B%204%5D%20%21%3D%3D%20v.w%29%20%7B%0A%20%20%20%20%20%20const%20b%20%3D%20this.buffer%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%200%5D%20%3D%20a2%5Boffset%20%2B%200%5D%20%3D%20v.x%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%201%5D%20%3D%20a2%5Boffset%20%2B%201%5D%20%3D%20v.y%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%202%5D%20%3D%20a2%5Boffset%20%2B%202%5D%20%3D%20v.z%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%203%5D%20%3D%20a2%5Boffset%20%2B%203%5D%20%3D%20v.w%3B%0A%20%20%20%20%20%20updated%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20updated%3B%0A%20%20%7D%0A%20%20updateColor%28uniform2%29%20%7B%0A%20%20%20%20let%20updated%20%3D%20false%3B%0A%20%20%20%20const%20a2%20%3D%20this.values%3B%0A%20%20%20%20const%20c2%20%3D%20uniform2.getValue%28%29%3B%0A%20%20%20%20const%20offset%20%3D%20uniform2.offset%3B%0A%20%20%20%20if%20%28a2%5Boffset%20%2B%200%5D%20%21%3D%3D%20c2.r%20%7C%7C%20a2%5Boffset%20%2B%201%5D%20%21%3D%3D%20c2.g%20%7C%7C%20a2%5Boffset%20%2B%202%5D%20%21%3D%3D%20c2.b%29%20%7B%0A%20%20%20%20%20%20const%20b%20%3D%20this.buffer%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%200%5D%20%3D%20a2%5Boffset%20%2B%200%5D%20%3D%20c2.r%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%201%5D%20%3D%20a2%5Boffset%20%2B%201%5D%20%3D%20c2.g%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%202%5D%20%3D%20a2%5Boffset%20%2B%202%5D%20%3D%20c2.b%3B%0A%20%20%20%20%20%20updated%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20updated%3B%0A%20%20%7D%0A%20%20updateMatrix3%28uniform2%29%20%7B%0A%20%20%20%20let%20updated%20%3D%20false%3B%0A%20%20%20%20const%20a2%20%3D%20this.values%3B%0A%20%20%20%20const%20e%20%3D%20uniform2.getValue%28%29.elements%3B%0A%20%20%20%20const%20offset%20%3D%20uniform2.offset%3B%0A%20%20%20%20if%20%28a2%5Boffset%20%2B%200%5D%20%21%3D%3D%20e%5B0%5D%20%7C%7C%20a2%5Boffset%20%2B%201%5D%20%21%3D%3D%20e%5B1%5D%20%7C%7C%20a2%5Boffset%20%2B%202%5D%20%21%3D%3D%20e%5B2%5D%20%7C%7C%20a2%5Boffset%20%2B%204%5D%20%21%3D%3D%20e%5B3%5D%20%7C%7C%20a2%5Boffset%20%2B%205%5D%20%21%3D%3D%20e%5B4%5D%20%7C%7C%20a2%5Boffset%20%2B%206%5D%20%21%3D%3D%20e%5B5%5D%20%7C%7C%20a2%5Boffset%20%2B%208%5D%20%21%3D%3D%20e%5B6%5D%20%7C%7C%20a2%5Boffset%20%2B%209%5D%20%21%3D%3D%20e%5B7%5D%20%7C%7C%20a2%5Boffset%20%2B%2010%5D%20%21%3D%3D%20e%5B8%5D%29%20%7B%0A%20%20%20%20%20%20const%20b%20%3D%20this.buffer%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%200%5D%20%3D%20a2%5Boffset%20%2B%200%5D%20%3D%20e%5B0%5D%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%201%5D%20%3D%20a2%5Boffset%20%2B%201%5D%20%3D%20e%5B1%5D%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%202%5D%20%3D%20a2%5Boffset%20%2B%202%5D%20%3D%20e%5B2%5D%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%204%5D%20%3D%20a2%5Boffset%20%2B%204%5D%20%3D%20e%5B3%5D%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%205%5D%20%3D%20a2%5Boffset%20%2B%205%5D%20%3D%20e%5B4%5D%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%206%5D%20%3D%20a2%5Boffset%20%2B%206%5D%20%3D%20e%5B5%5D%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%208%5D%20%3D%20a2%5Boffset%20%2B%208%5D%20%3D%20e%5B6%5D%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%209%5D%20%3D%20a2%5Boffset%20%2B%209%5D%20%3D%20e%5B7%5D%3B%0A%20%20%20%20%20%20b%5Boffset%20%2B%2010%5D%20%3D%20a2%5Boffset%20%2B%2010%5D%20%3D%20e%5B8%5D%3B%0A%20%20%20%20%20%20updated%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20updated%3B%0A%20%20%7D%0A%20%20updateMatrix4%28uniform2%29%20%7B%0A%20%20%20%20let%20updated%20%3D%20false%3B%0A%20%20%20%20const%20a2%20%3D%20this.values%3B%0A%20%20%20%20const%20e%20%3D%20uniform2.getValue%28%29.elements%3B%0A%20%20%20%20const%20offset%20%3D%20uniform2.offset%3B%0A%20%20%20%20if%20%28arraysEqual2%28a2%2C%20e%2C%20offset%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20const%20b%20%3D%20this.buffer%3B%0A%20%20%20%20%20%20b.set%28e%2C%20offset%29%3B%0A%20%20%20%20%20%20setArray%28a2%2C%20e%2C%20offset%29%3B%0A%20%20%20%20%20%20updated%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20updated%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20setArray%28a2%2C%20b%2C%20offset%29%20%7B%0A%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20b.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20a2%5Boffset%20%2B%20i%5D%20%3D%20b%5Bi%5D%3B%0A%20%20%7D%0A%7D%0Afunction%20arraysEqual2%28a2%2C%20b%2C%20offset%29%20%7B%0A%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20b.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20if%20%28a2%5Boffset%20%2B%20i%5D%20%21%3D%3D%20b%5Bi%5D%29%20return%20false%3B%0A%20%20%7D%0A%20%20return%20true%3B%0A%7D%0Avar%20_id%243%20%3D%200%3B%0Avar%20NodeUniformsGroup%20%3D%20class%20extends%20UniformsGroup%20%7B%0A%20%20constructor%28name%2C%20groupNode%29%20%7B%0A%20%20%20%20super%28name%29%3B%0A%20%20%20%20this.id%20%3D%20_id%243%2B%2B%3B%0A%20%20%20%20this.groupNode%20%3D%20groupNode%3B%0A%20%20%20%20this.isNodeUniformsGroup%20%3D%20true%3B%0A%20%20%7D%0A%20%20getNodes%28%29%20%7B%0A%20%20%20%20const%20nodes%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28const%20uniform2%20of%20this.uniforms%29%20%7B%0A%20%20%20%20%20%20const%20node%20%3D%20uniform2.nodeUniform.node%3B%0A%20%20%20%20%20%20if%20%28%21node%29%20throw%20new%20Error%28%22NodeUniformsGroup%3A%20Uniform%20has%20no%20node.%22%29%3B%0A%20%20%20%20%20%20nodes.push%28node%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodes%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_id%2422%20%3D%200%3B%0Avar%20SampledTexture%20%3D%20class%20extends%20Binding%20%7B%0A%20%20constructor%28name%2C%20texture2%29%20%7B%0A%20%20%20%20super%28name%29%3B%0A%20%20%20%20this.id%20%3D%20_id%2422%2B%2B%3B%0A%20%20%20%20this.texture%20%3D%20texture2%3B%0A%20%20%20%20this.version%20%3D%20texture2%20%3F%20texture2.version%20%3A%200%3B%0A%20%20%20%20this.store%20%3D%20false%3B%0A%20%20%20%20this.generation%20%3D%20null%3B%0A%20%20%20%20this.isSampledTexture%20%3D%20true%3B%0A%20%20%7D%0A%20%20needsBindingsUpdate%28generation%29%20%7B%0A%20%20%20%20const%20%7B%20texture%3A%20texture2%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28generation%20%21%3D%3D%20this.generation%29%20%7B%0A%20%20%20%20%20%20this.generation%20%3D%20generation%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20texture2.isVideoTexture%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20const%20%7B%20texture%3A%20texture2%2C%20version%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28version%20%21%3D%3D%20texture2.version%29%20%7B%0A%20%20%20%20%20%20this.version%20%3D%20texture2.version%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeSampledTexture%20%3D%20class%20extends%20SampledTexture%20%7B%0A%20%20constructor%28name%2C%20textureNode%2C%20groupNode%2C%20access%20%3D%20null%29%20%7B%0A%20%20%20%20super%28name%2C%20textureNode%20%3F%20textureNode.value%20%3A%20null%29%3B%0A%20%20%20%20this.textureNode%20%3D%20textureNode%3B%0A%20%20%20%20this.groupNode%20%3D%20groupNode%3B%0A%20%20%20%20this.access%20%3D%20access%3B%0A%20%20%7D%0A%20%20needsBindingsUpdate%28generation%29%20%7B%0A%20%20%20%20return%20this.textureNode.value%20%21%3D%3D%20this.texture%20%7C%7C%20super.needsBindingsUpdate%28generation%29%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20const%20%7B%20textureNode%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28this.texture%20%21%3D%3D%20textureNode.value%29%20%7B%0A%20%20%20%20%20%20this.texture%20%3D%20textureNode.value%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20super.update%28%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeSampledCubeTexture%20%3D%20class%20extends%20NodeSampledTexture%20%7B%0A%20%20constructor%28name%2C%20textureNode%2C%20groupNode%2C%20access%29%20%7B%0A%20%20%20%20super%28name%2C%20textureNode%2C%20groupNode%2C%20access%29%3B%0A%20%20%20%20this.isSampledCubeTexture%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeSampledTexture3D%20%3D%20class%20extends%20NodeSampledTexture%20%7B%0A%20%20constructor%28name%2C%20textureNode%2C%20groupNode%2C%20access%29%20%7B%0A%20%20%20%20super%28name%2C%20textureNode%2C%20groupNode%2C%20access%29%3B%0A%20%20%20%20this.isSampledTexture3D%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20glslMethods%20%3D%20%7B%0A%20%20atan2%3A%20%22atan%22%2C%0A%20%20textureDimensions%3A%20%22textureSize%22%2C%0A%20%20equals%3A%20%22equal%22%0A%7D%3B%0Avar%20precisionLib%20%3D%20%7B%0A%20%20low%3A%20%22lowp%22%2C%0A%20%20medium%3A%20%22mediump%22%2C%0A%20%20high%3A%20%22highp%22%0A%7D%3B%0Avar%20supports%241%20%3D%20%7B%0A%20%20swizzleAssign%3A%20true%2C%0A%20%20storageBuffer%3A%20false%0A%7D%3B%0Avar%20defaultPrecisions%20%3D%20%60%0Aprecision%20highp%20float%3B%0Aprecision%20highp%20int%3B%0Aprecision%20highp%20sampler2D%3B%0Aprecision%20highp%20sampler3D%3B%0Aprecision%20highp%20samplerCube%3B%0Aprecision%20highp%20sampler2DArray%3B%0A%0Aprecision%20highp%20usampler2D%3B%0Aprecision%20highp%20usampler3D%3B%0Aprecision%20highp%20usamplerCube%3B%0Aprecision%20highp%20usampler2DArray%3B%0A%0Aprecision%20highp%20isampler2D%3B%0Aprecision%20highp%20isampler3D%3B%0Aprecision%20highp%20isamplerCube%3B%0Aprecision%20highp%20isampler2DArray%3B%0A%0Aprecision%20lowp%20sampler2DShadow%3B%0A%60%3B%0Avar%20GLSLNodeBuilder%20%3D%20class%20extends%20NodeBuilder%20%7B%0A%20%20constructor%28object%2C%20renderer3%29%20%7B%0A%20%20%20%20super%28object%2C%20renderer3%2C%20new%20GLSLNodeParser%28%29%29%3B%0A%20%20%20%20this.uniformGroups%20%3D%20%7B%7D%3B%0A%20%20%20%20this.transforms%20%3D%20%5B%5D%3B%0A%20%20%20%20this.extensions%20%3D%20%7B%7D%3B%0A%20%20%20%20this.useComparisonMethod%20%3D%20true%3B%0A%20%20%7D%0A%20%20needsColorSpaceToLinearSRGB%28texture2%29%20%7B%0A%20%20%20%20return%20texture2.isVideoTexture%20%3D%3D%3D%20true%20%26%26%20texture2.colorSpace%20%21%3D%3D%20NoColorSpace2%3B%0A%20%20%7D%0A%20%20getMethod%28method%29%20%7B%0A%20%20%20%20return%20glslMethods%5Bmethod%5D%20%7C%7C%20method%3B%0A%20%20%7D%0A%20%20getOutputStructName%28%29%20%7B%0A%20%20%20%20return%20%22%22%3B%0A%20%20%7D%0A%20%20buildFunctionCode%28shaderNode%29%20%7B%0A%20%20%20%20const%20layout%20%3D%20shaderNode.layout%3B%0A%20%20%20%20const%20flowData%20%3D%20this.flowShaderNode%28shaderNode%29%3B%0A%20%20%20%20const%20parameters%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28const%20input%20of%20layout.inputs%29%20%7B%0A%20%20%20%20%20%20parameters.push%28this.getType%28input.type%29%20%2B%20%22%20%22%20%2B%20input.name%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20code%20%3D%20%60%24%7Bthis.getType%28layout.type%29%7D%20%24%7Blayout.name%7D%28%20%24%7Bparameters.join%28%22%2C%20%22%29%7D%20%29%20%7B%0A%0A%09%24%7BflowData.vars%7D%0A%0A%24%7BflowData.code%7D%0A%09return%20%24%7BflowData.result%7D%3B%0A%0A%7D%60%3B%0A%20%20%20%20return%20code%3B%0A%20%20%7D%0A%20%20setupPBO%28storageBufferNode%29%20%7B%0A%20%20%20%20const%20attribute2%20%3D%20storageBufferNode.value%3B%0A%20%20%20%20if%20%28attribute2.pbo%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20originalArray%20%3D%20attribute2.array%3B%0A%20%20%20%20%20%20const%20numElements%20%3D%20attribute2.count%20%2A%20attribute2.itemSize%3B%0A%20%20%20%20%20%20const%20%7B%20itemSize%20%7D%20%3D%20attribute2%3B%0A%20%20%20%20%20%20const%20isInteger%20%3D%20attribute2.array.constructor.name.toLowerCase%28%29.includes%28%22int%22%29%3B%0A%20%20%20%20%20%20let%20format2%20%3D%20isInteger%20%3F%20RedIntegerFormat2%20%3A%20RedFormat2%3B%0A%20%20%20%20%20%20if%20%28itemSize%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20%20%20format2%20%3D%20isInteger%20%3F%20RGIntegerFormat2%20%3A%20RGFormat2%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28itemSize%20%3D%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20format2%20%3D%20isInteger%20%3F%20RGBIntegerFormat%20%3A%20RGBFormat2%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28itemSize%20%3D%3D%3D%204%29%20%7B%0A%20%20%20%20%20%20%20%20format2%20%3D%20isInteger%20%3F%20RGBAIntegerFormat2%20%3A%20RGBAFormat2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20typeMap%20%3D%20%7B%0A%20%20%20%20%20%20%20%20Float32Array%3A%20FloatType2%2C%0A%20%20%20%20%20%20%20%20Uint8Array%3A%20UnsignedByteType2%2C%0A%20%20%20%20%20%20%20%20Uint16Array%3A%20UnsignedShortType2%2C%0A%20%20%20%20%20%20%20%20Uint32Array%3A%20UnsignedIntType2%2C%0A%20%20%20%20%20%20%20%20Int8Array%3A%20ByteType2%2C%0A%20%20%20%20%20%20%20%20Int16Array%3A%20ShortType2%2C%0A%20%20%20%20%20%20%20%20Int32Array%3A%20IntType2%2C%0A%20%20%20%20%20%20%20%20Uint8ClampedArray%3A%20UnsignedByteType2%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20const%20width%20%3D%20Math.pow%282%2C%20Math.ceil%28Math.log2%28Math.sqrt%28numElements%20%2F%20itemSize%29%29%29%29%3B%0A%20%20%20%20%20%20let%20height%20%3D%20Math.ceil%28numElements%20%2F%20itemSize%20%2F%20width%29%3B%0A%20%20%20%20%20%20if%20%28width%20%2A%20height%20%2A%20itemSize%20%3C%20numElements%29%20height%2B%2B%3B%0A%20%20%20%20%20%20const%20newSize%20%3D%20width%20%2A%20height%20%2A%20itemSize%3B%0A%20%20%20%20%20%20const%20newArray%20%3D%20new%20originalArray.constructor%28newSize%29%3B%0A%20%20%20%20%20%20newArray.set%28originalArray%2C%200%29%3B%0A%20%20%20%20%20%20attribute2.array%20%3D%20newArray%3B%0A%20%20%20%20%20%20const%20pboTexture%20%3D%20new%20DataTexture%28attribute2.array%2C%20width%2C%20height%2C%20format2%2C%20typeMap%5Battribute2.array.constructor.name%5D%20%7C%7C%20FloatType2%29%3B%0A%20%20%20%20%20%20pboTexture.needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20pboTexture.isPBOTexture%20%3D%20true%3B%0A%20%20%20%20%20%20const%20pbo%20%3D%20new%20TextureNode%28pboTexture%2C%20null%2C%20null%29%3B%0A%20%20%20%20%20%20pbo.setPrecision%28%22high%22%29%3B%0A%20%20%20%20%20%20attribute2.pboNode%20%3D%20pbo%3B%0A%20%20%20%20%20%20attribute2.pbo%20%3D%20pbo.value%3B%0A%20%20%20%20%20%20this.getUniformFromNode%28attribute2.pboNode%2C%20%22texture%22%2C%20this.shaderStage%2C%20this.context.label%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getPropertyName%28node%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20if%20%28node.isNodeUniform%20%26%26%20node.node.isTextureNode%20%21%3D%3D%20true%20%26%26%20node.node.isBufferNode%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20return%20shaderStage.charAt%280%29%20%2B%20%22_%22%20%2B%20node.name%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20super.getPropertyName%28node%2C%20shaderStage%29%3B%0A%20%20%7D%0A%20%20generatePBO%28storageArrayElementNode%29%20%7B%0A%20%20%20%20const%20%7B%20node%2C%20indexNode%20%7D%20%3D%20storageArrayElementNode%3B%0A%20%20%20%20const%20attribute2%20%3D%20node.value%3B%0A%20%20%20%20if%20%28this.renderer.backend.has%28attribute2%29%29%20%7B%0A%20%20%20%20%20%20const%20attributeData%20%3D%20this.renderer.backend.get%28attribute2%29%3B%0A%20%20%20%20%20%20attributeData.pbo%20%3D%20attribute2.pbo%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20nodeUniform%20%3D%20this.getUniformFromNode%28attribute2.pboNode%2C%20%22texture%22%2C%20this.shaderStage%2C%20this.context.label%29%3B%0A%20%20%20%20const%20textureName%20%3D%20this.getPropertyName%28nodeUniform%29%3B%0A%20%20%20%20this.increaseUsage%28indexNode%29%3B%0A%20%20%20%20const%20indexSnippet%20%3D%20indexNode.build%28this%2C%20%22uint%22%29%3B%0A%20%20%20%20const%20elementNodeData%20%3D%20this.getDataFromNode%28storageArrayElementNode%29%3B%0A%20%20%20%20let%20propertyName%20%3D%20elementNodeData.propertyName%3B%0A%20%20%20%20if%20%28propertyName%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20nodeVar%20%3D%20this.getVarFromNode%28storageArrayElementNode%29%3B%0A%20%20%20%20%20%20propertyName%20%3D%20this.getPropertyName%28nodeVar%29%3B%0A%20%20%20%20%20%20const%20bufferNodeData%20%3D%20this.getDataFromNode%28node%29%3B%0A%20%20%20%20%20%20let%20propertySizeName%20%3D%20bufferNodeData.propertySizeName%3B%0A%20%20%20%20%20%20if%20%28propertySizeName%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20propertySizeName%20%3D%20propertyName%20%2B%20%22Size%22%3B%0A%20%20%20%20%20%20%20%20this.getVarFromNode%28node%2C%20propertySizeName%2C%20%22uint%22%29%3B%0A%20%20%20%20%20%20%20%20this.addLineFlowCode%28%60%24%7BpropertySizeName%7D%20%3D%20uint%28%20textureSize%28%20%24%7BtextureName%7D%2C%200%20%29.x%20%29%60%2C%20storageArrayElementNode%29%3B%0A%20%20%20%20%20%20%20%20bufferNodeData.propertySizeName%20%3D%20propertySizeName%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20%7B%20itemSize%20%7D%20%3D%20attribute2%3B%0A%20%20%20%20%20%20const%20channel%20%3D%20%22.%22%20%2B%20vectorComponents.join%28%22%22%29.slice%280%2C%20itemSize%29%3B%0A%20%20%20%20%20%20const%20uvSnippet%20%3D%20%60ivec2%28%24%7BindexSnippet%7D%20%25%20%24%7BpropertySizeName%7D%2C%20%24%7BindexSnippet%7D%20%2F%20%24%7BpropertySizeName%7D%29%60%3B%0A%20%20%20%20%20%20const%20snippet%20%3D%20this.generateTextureLoad%28null%2C%20textureName%2C%20uvSnippet%2C%20null%2C%20%220%22%29%3B%0A%20%20%20%20%20%20let%20prefix%20%3D%20%22vec4%22%3B%0A%20%20%20%20%20%20if%20%28attribute2.pbo.type%20%3D%3D%3D%20UnsignedIntType2%29%20%7B%0A%20%20%20%20%20%20%20%20prefix%20%3D%20%22uvec4%22%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28attribute2.pbo.type%20%3D%3D%3D%20IntType2%29%20%7B%0A%20%20%20%20%20%20%20%20prefix%20%3D%20%22ivec4%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.addLineFlowCode%28%60%24%7BpropertyName%7D%20%3D%20%24%7Bprefix%7D%28%24%7Bsnippet%7D%29%24%7Bchannel%7D%60%2C%20storageArrayElementNode%29%3B%0A%20%20%20%20%20%20elementNodeData.propertyName%20%3D%20propertyName%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20propertyName%3B%0A%20%20%7D%0A%20%20generateTextureLoad%28texture2%2C%20textureProperty%2C%20uvIndexSnippet%2C%20depthSnippet%2C%20levelSnippet%20%3D%20%220%22%29%20%7B%0A%20%20%20%20if%20%28depthSnippet%29%20%7B%0A%20%20%20%20%20%20return%20%60texelFetch%28%20%24%7BtextureProperty%7D%2C%20ivec3%28%20%24%7BuvIndexSnippet%7D%2C%20%24%7BdepthSnippet%7D%20%29%2C%20%24%7BlevelSnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20%60texelFetch%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvIndexSnippet%7D%2C%20%24%7BlevelSnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generateTexture%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20depthSnippet%29%20%7B%0A%20%20%20%20if%20%28texture2.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20return%20%60texture%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvSnippet%7D%20%29.x%60%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28depthSnippet%29%20uvSnippet%20%3D%20%60vec3%28%20%24%7BuvSnippet%7D%2C%20%24%7BdepthSnippet%7D%20%29%60%3B%0A%20%20%20%20%20%20return%20%60texture%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvSnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generateTextureLevel%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%29%20%7B%0A%20%20%20%20return%20%60textureLod%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvSnippet%7D%2C%20%24%7BlevelSnippet%7D%20%29%60%3B%0A%20%20%7D%0A%20%20generateTextureBias%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20biasSnippet%29%20%7B%0A%20%20%20%20return%20%60texture%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvSnippet%7D%2C%20%24%7BbiasSnippet%7D%20%29%60%3B%0A%20%20%7D%0A%20%20generateTextureGrad%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20gradSnippet%29%20%7B%0A%20%20%20%20return%20%60textureGrad%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvSnippet%7D%2C%20%24%7BgradSnippet%5B0%5D%7D%2C%20%24%7BgradSnippet%5B1%5D%7D%20%29%60%3B%0A%20%20%7D%0A%20%20generateTextureCompare%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20compareSnippet%2C%20depthSnippet%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20return%20%60texture%28%20%24%7BtextureProperty%7D%2C%20vec3%28%20%24%7BuvSnippet%7D%2C%20%24%7BcompareSnippet%7D%20%29%20%29%60%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%60WebGPURenderer%3A%20THREE.DepthTexture.compareFunction%28%29%20does%20not%20support%20%24%7BshaderStage%7D%20shader.%60%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getVars%28shaderStage%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vars%20%3D%20this.vars%5BshaderStage%5D%3B%0A%20%20%20%20if%20%28vars%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20variable%20of%20vars%29%20%7B%0A%20%20%20%20%20%20%20%20snippets.push%28%60%24%7Bthis.getVar%28variable.type%2C%20variable.name%29%7D%3B%60%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippets.join%28%22%5Cn%09%22%29%3B%0A%20%20%7D%0A%20%20getUniforms%28shaderStage%29%20%7B%0A%20%20%20%20const%20uniforms%20%3D%20this.uniforms%5BshaderStage%5D%3B%0A%20%20%20%20const%20bindingSnippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20uniformGroups%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20uniform2%20of%20uniforms%29%20%7B%0A%20%20%20%20%20%20let%20snippet%20%3D%20null%3B%0A%20%20%20%20%20%20let%20group%20%3D%20false%3B%0A%20%20%20%20%20%20if%20%28uniform2.type%20%3D%3D%3D%20%22texture%22%29%20%7B%0A%20%20%20%20%20%20%20%20const%20texture2%20%3D%20uniform2.node.value%3B%0A%20%20%20%20%20%20%20%20let%20typePrefix%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20if%20%28texture2.isDataTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28texture2.type%20%3D%3D%3D%20UnsignedIntType2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20typePrefix%20%3D%20%22u%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28texture2.type%20%3D%3D%3D%20IntType2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20typePrefix%20%3D%20%22i%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28texture2.compareFunction%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20snippet%20%3D%20%60sampler2DShadow%20%24%7Buniform2.name%7D%3B%60%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isDataArrayTexture%20%3D%3D%3D%20true%20%7C%7C%20texture2.isCompressedArrayTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20snippet%20%3D%20%60%24%7BtypePrefix%7Dsampler2DArray%20%24%7Buniform2.name%7D%3B%60%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20snippet%20%3D%20%60%24%7BtypePrefix%7Dsampler2D%20%24%7Buniform2.name%7D%3B%60%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28uniform2.type%20%3D%3D%3D%20%22cubeTexture%22%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20%60samplerCube%20%24%7Buniform2.name%7D%3B%60%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28uniform2.type%20%3D%3D%3D%20%22texture3D%22%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20%60sampler3D%20%24%7Buniform2.name%7D%3B%60%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28uniform2.type%20%3D%3D%3D%20%22buffer%22%29%20%7B%0A%20%20%20%20%20%20%20%20const%20bufferNode%20%3D%20uniform2.node%3B%0A%20%20%20%20%20%20%20%20const%20bufferType%20%3D%20this.getType%28bufferNode.bufferType%29%3B%0A%20%20%20%20%20%20%20%20const%20bufferCount%20%3D%20bufferNode.bufferCount%3B%0A%20%20%20%20%20%20%20%20const%20bufferCountSnippet%20%3D%20bufferCount%20%3E%200%20%3F%20bufferCount%20%3A%20%22%22%3B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20%60%24%7BbufferNode.name%7D%20%7B%0A%09%24%7BbufferType%7D%20%24%7Buniform2.name%7D%5B%24%7BbufferCountSnippet%7D%5D%3B%0A%7D%3B%0A%60%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20vectorType%20%3D%20this.getVectorType%28uniform2.type%29%3B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20%60%24%7BvectorType%7D%20%24%7Bthis.getPropertyName%28uniform2%2C%20shaderStage%29%7D%3B%60%3B%0A%20%20%20%20%20%20%20%20group%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20precision%20%3D%20uniform2.node.precision%3B%0A%20%20%20%20%20%20if%20%28precision%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20precisionLib%5Bprecision%5D%20%2B%20%22%20%22%20%2B%20snippet%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28group%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20%22%09%22%20%2B%20snippet%3B%0A%20%20%20%20%20%20%20%20const%20groupName%20%3D%20uniform2.groupNode.name%3B%0A%20%20%20%20%20%20%20%20const%20groupSnippets%20%3D%20uniformGroups%5BgroupName%5D%20%7C%7C%20%28uniformGroups%5BgroupName%5D%20%3D%20%5B%5D%29%3B%0A%20%20%20%20%20%20%20%20groupSnippets.push%28snippet%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%3D%20%22uniform%20%22%20%2B%20snippet%3B%0A%20%20%20%20%20%20%20%20bindingSnippets.push%28snippet%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20let%20output2%20%3D%20%22%22%3B%0A%20%20%20%20for%20%28const%20name%20in%20uniformGroups%29%20%7B%0A%20%20%20%20%20%20const%20groupSnippets%20%3D%20uniformGroups%5Bname%5D%3B%0A%20%20%20%20%20%20output2%20%2B%3D%20this._getGLSLUniformStruct%28shaderStage%20%2B%20%22_%22%20%2B%20name%2C%20groupSnippets.join%28%22%5Cn%22%29%29%20%2B%20%22%5Cn%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20output2%20%2B%3D%20bindingSnippets.join%28%22%5Cn%22%29%3B%0A%20%20%20%20return%20output2%3B%0A%20%20%7D%0A%20%20getTypeFromAttribute%28attribute2%29%20%7B%0A%20%20%20%20let%20nodeType%20%3D%20super.getTypeFromAttribute%28attribute2%29%3B%0A%20%20%20%20if%20%28%2F%5E%5Biu%5D%2F.test%28nodeType%29%20%26%26%20attribute2.gpuType%20%21%3D%3D%20IntType2%29%20%7B%0A%20%20%20%20%20%20let%20dataAttribute%20%3D%20attribute2%3B%0A%20%20%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20dataAttribute%20%3D%20attribute2.data%3B%0A%20%20%20%20%20%20const%20array%20%3D%20dataAttribute.array%3B%0A%20%20%20%20%20%20if%20%28%28array%20instanceof%20Uint32Array%20%7C%7C%20array%20instanceof%20Int32Array%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20nodeType%20%3D%20nodeType.slice%281%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20nodeType%3B%0A%20%20%7D%0A%20%20getAttributes%28shaderStage%29%20%7B%0A%20%20%20%20let%20snippet%20%3D%20%22%22%3B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%20%7C%7C%20shaderStage%20%3D%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20const%20attributes%20%3D%20this.getAttributesArray%28%29%3B%0A%20%20%20%20%20%20let%20location%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28const%20attribute2%20of%20attributes%29%20%7B%0A%20%20%20%20%20%20%20%20snippet%20%2B%3D%20%60layout%28%20location%20%3D%20%24%7Blocation%2B%2B%7D%20%29%20in%20%24%7Battribute2.type%7D%20%24%7Battribute2.name%7D%3B%0A%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippet%3B%0A%20%20%7D%0A%20%20getStructMembers%28struct%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20members%20%3D%20struct.getMemberTypes%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20members.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20member%20%3D%20members%5Bi%5D%3B%0A%20%20%20%20%20%20snippets.push%28%60layout%28%20location%20%3D%20%24%7Bi%7D%20%29%20out%20%24%7Bmember%7D%20m%24%7Bi%7D%3B%60%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippets.join%28%22%5Cn%22%29%3B%0A%20%20%7D%0A%20%20getStructs%28shaderStage%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20structs%20%3D%20this.structs%5BshaderStage%5D%3B%0A%20%20%20%20if%20%28structs.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20return%20%22layout%28%20location%20%3D%200%20%29%20out%20vec4%20fragColor%3B%5Cn%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20index5%20%3D%200%2C%20length2%20%3D%20structs.length%3B%20index5%20%3C%20length2%3B%20index5%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20struct%20%3D%20structs%5Bindex5%5D%3B%0A%20%20%20%20%20%20let%20snippet%20%3D%20%22%5Cn%22%3B%0A%20%20%20%20%20%20snippet%20%2B%3D%20this.getStructMembers%28struct%29%3B%0A%20%20%20%20%20%20snippet%20%2B%3D%20%22%5Cn%22%3B%0A%20%20%20%20%20%20snippets.push%28snippet%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippets.join%28%22%5Cn%5Cn%22%29%3B%0A%20%20%7D%0A%20%20getVaryings%28shaderStage%29%20%7B%0A%20%20%20%20let%20snippet%20%3D%20%22%22%3B%0A%20%20%20%20const%20varyings%20%3D%20this.varyings%3B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%20%7C%7C%20shaderStage%20%3D%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20varying2%20of%20varyings%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22compute%22%29%20varying2.needsInterpolation%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20const%20type%20%3D%20varying2.type%3B%0A%20%20%20%20%20%20%20%20const%20flat%20%3D%20type.includes%28%22int%22%29%20%7C%7C%20type.includes%28%22uv%22%29%20%7C%7C%20type.includes%28%22iv%22%29%20%3F%20%22flat%20%22%20%3A%20%22%22%3B%0A%20%20%20%20%20%20%20%20snippet%20%2B%3D%20%60%24%7Bflat%7D%24%7Bvarying2.needsInterpolation%20%3F%20%22out%22%20%3A%20%22%2F%2Aout%2A%2F%22%7D%20%24%7Btype%7D%20%24%7Bvarying2.name%7D%3B%0A%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20varying2%20of%20varyings%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28varying2.needsInterpolation%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20type%20%3D%20varying2.type%3B%0A%20%20%20%20%20%20%20%20%20%20const%20flat%20%3D%20type.includes%28%22int%22%29%20%7C%7C%20type.includes%28%22uv%22%29%20%7C%7C%20type.includes%28%22iv%22%29%20%3F%20%22flat%20%22%20%3A%20%22%22%3B%0A%20%20%20%20%20%20%20%20%20%20snippet%20%2B%3D%20%60%24%7Bflat%7Din%20%24%7Btype%7D%20%24%7Bvarying2.name%7D%3B%0A%60%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippet%3B%0A%20%20%7D%0A%20%20getVertexIndex%28%29%20%7B%0A%20%20%20%20return%20%22uint%28%20gl_VertexID%20%29%22%3B%0A%20%20%7D%0A%20%20getInstanceIndex%28%29%20%7B%0A%20%20%20%20return%20%22uint%28%20gl_InstanceID%20%29%22%3B%0A%20%20%7D%0A%20%20getInvocationLocalIndex%28%29%20%7B%0A%20%20%20%20const%20workgroupSize%20%3D%20this.object.workgroupSize%3B%0A%20%20%20%20const%20size%20%3D%20workgroupSize.reduce%28%28acc%2C%20curr%29%20%3D%3E%20acc%20%2A%20curr%2C%201%29%3B%0A%20%20%20%20return%20%60uint%28%20gl_InstanceID%20%29%20%25%20%24%7Bsize%7Du%60%3B%0A%20%20%7D%0A%20%20getDrawIndex%28%29%20%7B%0A%20%20%20%20const%20extensions%20%3D%20this.renderer.backend.extensions%3B%0A%20%20%20%20if%20%28extensions.has%28%22WEBGL_multi_draw%22%29%29%20%7B%0A%20%20%20%20%20%20return%20%22uint%28%20gl_DrawID%20%29%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%20%20getFrontFacing%28%29%20%7B%0A%20%20%20%20return%20%22gl_FrontFacing%22%3B%0A%20%20%7D%0A%20%20getFragCoord%28%29%20%7B%0A%20%20%20%20return%20%22gl_FragCoord.xy%22%3B%0A%20%20%7D%0A%20%20getFragDepth%28%29%20%7B%0A%20%20%20%20return%20%22gl_FragDepth%22%3B%0A%20%20%7D%0A%20%20enableExtension%28name%2C%20behavior%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20const%20map%20%3D%20this.extensions%5BshaderStage%5D%20%7C%7C%20%28this.extensions%5BshaderStage%5D%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%29%3B%0A%20%20%20%20if%20%28map.has%28name%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20map.set%28name%2C%20%7B%0A%20%20%20%20%20%20%20%20name%2C%0A%20%20%20%20%20%20%20%20behavior%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getExtensions%28shaderStage%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%29%20%7B%0A%20%20%20%20%20%20const%20ext%20%3D%20this.renderer.backend.extensions%3B%0A%20%20%20%20%20%20const%20isBatchedMesh%20%3D%20this.object.isBatchedMesh%3B%0A%20%20%20%20%20%20if%20%28isBatchedMesh%20%26%26%20ext.has%28%22WEBGL_multi_draw%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20this.enableExtension%28%22GL_ANGLE_multi_draw%22%2C%20%22require%22%2C%20shaderStage%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20extensions%20%3D%20this.extensions%5BshaderStage%5D%3B%0A%20%20%20%20if%20%28extensions%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20%7B%20name%2C%20behavior%20%7D%20of%20extensions.values%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20snippets.push%28%60%23extension%20%24%7Bname%7D%20%3A%20%24%7Bbehavior%7D%60%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippets.join%28%22%5Cn%22%29%3B%0A%20%20%7D%0A%20%20isAvailable%28name%29%20%7B%0A%20%20%20%20let%20result%20%3D%20supports%241%5Bname%5D%3B%0A%20%20%20%20if%20%28result%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20%22float32Filterable%22%29%20%7B%0A%20%20%20%20%20%20%20%20const%20extensions%20%3D%20this.renderer.backend.extensions%3B%0A%20%20%20%20%20%20%20%20if%20%28extensions.has%28%22OES_texture_float_linear%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20extensions.get%28%22OES_texture_float_linear%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20result%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20result%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20supports%241%5Bname%5D%20%3D%20result%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20isFlipY%28%29%20%7B%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20registerTransform%28varyingName%2C%20attributeNode%29%20%7B%0A%20%20%20%20this.transforms.push%28%7B%20varyingName%2C%20attributeNode%20%7D%29%3B%0A%20%20%7D%0A%20%20getTransforms%28%29%20%7B%0A%20%20%20%20const%20transforms%20%3D%20this.transforms%3B%0A%20%20%20%20let%20snippet%20%3D%20%22%22%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20transforms.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20transform%20%3D%20transforms%5Bi%5D%3B%0A%20%20%20%20%20%20const%20attributeName%20%3D%20this.getPropertyName%28transform.attributeNode%29%3B%0A%20%20%20%20%20%20snippet%20%2B%3D%20%60%24%7Btransform.varyingName%7D%20%3D%20%24%7BattributeName%7D%3B%0A%09%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippet%3B%0A%20%20%7D%0A%20%20_getGLSLUniformStruct%28name%2C%20vars%29%20%7B%0A%20%20%20%20return%20%60%0Alayout%28%20std140%20%29%20uniform%20%24%7Bname%7D%20%7B%0A%24%7Bvars%7D%0A%7D%3B%60%3B%0A%20%20%7D%0A%20%20_getGLSLVertexCode%28shaderData%29%20%7B%0A%20%20%20%20return%20%60%23version%20300%20es%0A%0A%24%7Bthis.getSignature%28%29%7D%0A%0A%2F%2F%20extensions%20%0A%24%7BshaderData.extensions%7D%0A%0A%2F%2F%20precision%0A%24%7BdefaultPrecisions%7D%0A%0A%2F%2F%20uniforms%0A%24%7BshaderData.uniforms%7D%0A%0A%2F%2F%20varyings%0A%24%7BshaderData.varyings%7D%0A%0A%2F%2F%20attributes%0A%24%7BshaderData.attributes%7D%0A%0A%2F%2F%20codes%0A%24%7BshaderData.codes%7D%0A%0Avoid%20main%28%29%20%7B%0A%0A%09%2F%2F%20vars%0A%09%24%7BshaderData.vars%7D%0A%0A%09%2F%2F%20transforms%0A%09%24%7BshaderData.transforms%7D%0A%0A%09%2F%2F%20flow%0A%09%24%7BshaderData.flow%7D%0A%0A%09gl_PointSize%20%3D%201.0%3B%0A%0A%7D%0A%60%3B%0A%20%20%7D%0A%20%20_getGLSLFragmentCode%28shaderData%29%20%7B%0A%20%20%20%20return%20%60%23version%20300%20es%0A%0A%24%7Bthis.getSignature%28%29%7D%0A%0A%2F%2F%20precision%0A%24%7BdefaultPrecisions%7D%0A%0A%2F%2F%20uniforms%0A%24%7BshaderData.uniforms%7D%0A%0A%2F%2F%20varyings%0A%24%7BshaderData.varyings%7D%0A%0A%2F%2F%20codes%0A%24%7BshaderData.codes%7D%0A%0A%24%7BshaderData.structs%7D%0A%0Avoid%20main%28%29%20%7B%0A%0A%09%2F%2F%20vars%0A%09%24%7BshaderData.vars%7D%0A%0A%09%2F%2F%20flow%0A%09%24%7BshaderData.flow%7D%0A%0A%7D%0A%60%3B%0A%20%20%7D%0A%20%20buildCode%28%29%20%7B%0A%20%20%20%20const%20shadersData%20%3D%20this.material%20%21%3D%3D%20null%20%3F%20%7B%20fragment%3A%20%7B%7D%2C%20vertex%3A%20%7B%7D%20%7D%20%3A%20%7B%20compute%3A%20%7B%7D%20%7D%3B%0A%20%20%20%20this.sortBindingGroups%28%29%3B%0A%20%20%20%20for%20%28const%20shaderStage%20in%20shadersData%29%20%7B%0A%20%20%20%20%20%20let%20flow%20%3D%20%22%2F%2F%20code%5Cn%5Cn%22%3B%0A%20%20%20%20%20%20flow%20%2B%3D%20this.flowCode%5BshaderStage%5D%3B%0A%20%20%20%20%20%20const%20flowNodes%20%3D%20this.flowNodes%5BshaderStage%5D%3B%0A%20%20%20%20%20%20const%20mainNode%20%3D%20flowNodes%5BflowNodes.length%20-%201%5D%3B%0A%20%20%20%20%20%20for%20%28const%20node%20of%20flowNodes%29%20%7B%0A%20%20%20%20%20%20%20%20const%20flowSlotData%20%3D%20this.getFlowData%28%0A%20%20%20%20%20%20%20%20%20%20node%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%2C%20shaderStage%2A%2F%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20const%20slotName%20%3D%20node.name%3B%0A%20%20%20%20%20%20%20%20if%20%28slotName%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28flow.length%20%3E%200%29%20flow%20%2B%3D%20%22%5Cn%22%3B%0A%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%60%09%2F%2F%20flow%20-%3E%20%24%7BslotName%7D%0A%09%60%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20flow%20%2B%3D%20%60%24%7BflowSlotData.code%7D%0A%09%60%3B%0A%20%20%20%20%20%20%20%20if%20%28node%20%3D%3D%3D%20mainNode%20%26%26%20shaderStage%20%21%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%22%2F%2F%20result%5Cn%09%22%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%22gl_Position%20%3D%20%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%60%24%7BflowSlotData.result%7D%3B%60%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21node.outputNode.isOutputStructNode%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%22fragColor%20%3D%20%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%60%24%7BflowSlotData.result%7D%3B%60%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20stageData%20%3D%20shadersData%5BshaderStage%5D%3B%0A%20%20%20%20%20%20stageData.extensions%20%3D%20this.getExtensions%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.uniforms%20%3D%20this.getUniforms%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.attributes%20%3D%20this.getAttributes%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.varyings%20%3D%20this.getVaryings%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.vars%20%3D%20this.getVars%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.structs%20%3D%20this.getStructs%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.codes%20%3D%20this.getCodes%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.transforms%20%3D%20this.getTransforms%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.flow%20%3D%20flow%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.material%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.vertexShader%20%3D%20this._getGLSLVertexCode%28shadersData.vertex%29%3B%0A%20%20%20%20%20%20this.fragmentShader%20%3D%20this._getGLSLFragmentCode%28shadersData.fragment%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.computeShader%20%3D%20this._getGLSLVertexCode%28shadersData.compute%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getUniformFromNode%28node%2C%20type%2C%20shaderStage%2C%20name%20%3D%20null%29%20%7B%0A%20%20%20%20const%20uniformNode%20%3D%20super.getUniformFromNode%28node%2C%20type%2C%20shaderStage%2C%20name%29%3B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%2C%20shaderStage%2C%20this.globalCache%29%3B%0A%20%20%20%20let%20uniformGPU%20%3D%20nodeData.uniformGPU%3B%0A%20%20%20%20if%20%28uniformGPU%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20node.groupNode%3B%0A%20%20%20%20%20%20const%20groupName%20%3D%20group.name%3B%0A%20%20%20%20%20%20const%20bindings%20%3D%20this.getBindGroupArray%28groupName%2C%20shaderStage%29%3B%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20%22texture%22%29%20%7B%0A%20%20%20%20%20%20%20%20uniformGPU%20%3D%20new%20NodeSampledTexture%28uniformNode.name%2C%20uniformNode.node%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20bindings.push%28uniformGPU%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22cubeTexture%22%29%20%7B%0A%20%20%20%20%20%20%20%20uniformGPU%20%3D%20new%20NodeSampledCubeTexture%28uniformNode.name%2C%20uniformNode.node%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20bindings.push%28uniformGPU%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22texture3D%22%29%20%7B%0A%20%20%20%20%20%20%20%20uniformGPU%20%3D%20new%20NodeSampledTexture3D%28uniformNode.name%2C%20uniformNode.node%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20bindings.push%28uniformGPU%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22buffer%22%29%20%7B%0A%20%20%20%20%20%20%20%20node.name%20%3D%20%60NodeBuffer_%24%7Bnode.id%7D%60%3B%0A%20%20%20%20%20%20%20%20uniformNode.name%20%3D%20%60buffer%24%7Bnode.id%7D%60%3B%0A%20%20%20%20%20%20%20%20const%20buffer2%20%3D%20new%20NodeUniformBuffer%28node%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20buffer2.name%20%3D%20node.name%3B%0A%20%20%20%20%20%20%20%20bindings.push%28buffer2%29%3B%0A%20%20%20%20%20%20%20%20uniformGPU%20%3D%20buffer2%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20uniformsStage%20%3D%20this.uniformGroups%5BshaderStage%5D%20%7C%7C%20%28this.uniformGroups%5BshaderStage%5D%20%3D%20%7B%7D%29%3B%0A%20%20%20%20%20%20%20%20let%20uniformsGroup%20%3D%20uniformsStage%5BgroupName%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28uniformsGroup%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20uniformsGroup%20%3D%20new%20NodeUniformsGroup%28shaderStage%20%2B%20%22_%22%20%2B%20groupName%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%20%20uniformsStage%5BgroupName%5D%20%3D%20uniformsGroup%3B%0A%20%20%20%20%20%20%20%20%20%20bindings.push%28uniformsGroup%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20uniformGPU%20%3D%20this.getNodeUniform%28uniformNode%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20uniformsGroup.addUniform%28uniformGPU%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20nodeData.uniformGPU%20%3D%20uniformGPU%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20uniformNode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20vector2%20%3D%20null%3B%0Avar%20vector4%20%3D%20null%3B%0Avar%20color4%20%3D%20null%3B%0Avar%20Backend%20%3D%20class%20%7B%0A%20%20constructor%28parameters%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20this.parameters%20%3D%20Object.assign%28%7B%7D%2C%20parameters%29%3B%0A%20%20%20%20this.data%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.renderer%20%3D%20null%3B%0A%20%20%20%20this.domElement%20%3D%20null%3B%0A%20%20%7D%0A%20%20async%20init%28renderer3%29%20%7B%0A%20%20%20%20this.renderer%20%3D%20renderer3%3B%0A%20%20%7D%0A%20%20%2F%2F%20render%20context%0A%20%20begin%28%29%20%7B%0A%20%20%7D%0A%20%20finish%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20render%20object%0A%20%20draw%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20program%0A%20%20createProgram%28%29%20%7B%0A%20%20%7D%0A%20%20destroyProgram%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20bindings%0A%20%20createBindings%28%29%20%7B%0A%20%20%7D%0A%20%20updateBindings%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20pipeline%0A%20%20createRenderPipeline%28%29%20%7B%0A%20%20%7D%0A%20%20createComputePipeline%28%29%20%7B%0A%20%20%7D%0A%20%20destroyPipeline%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20cache%20key%0A%20%20needsRenderUpdate%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20return%20Boolean%20%28%20fast%20test%20%29%0A%20%20getRenderCacheKey%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20return%20String%0A%20%20%2F%2F%20node%20builder%0A%20%20createNodeBuilder%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20return%20NodeBuilder%20%28ADD%20IT%29%0A%20%20%2F%2F%20textures%0A%20%20createSampler%28%29%20%7B%0A%20%20%7D%0A%20%20createDefaultTexture%28%29%20%7B%0A%20%20%7D%0A%20%20createTexture%28%29%20%7B%0A%20%20%7D%0A%20%20copyTextureToBuffer%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20attributes%0A%20%20createAttribute%28%29%20%7B%0A%20%20%7D%0A%20%20createIndexAttribute%28%29%20%7B%0A%20%20%7D%0A%20%20updateAttribute%28%29%20%7B%0A%20%20%7D%0A%20%20destroyAttribute%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20canvas%0A%20%20getContext%28%29%20%7B%0A%20%20%7D%0A%20%20updateSize%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20utils%0A%20%20resolveTimestampAsync%28%29%20%7B%0A%20%20%7D%0A%20%20hasFeatureAsync%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20return%20Boolean%0A%20%20hasFeature%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20return%20Boolean%0A%20%20getInstanceCount%28renderObject%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20geometry%20%7D%20%3D%20renderObject%3B%0A%20%20%20%20return%20geometry.isInstancedBufferGeometry%20%3F%20geometry.instanceCount%20%3A%20object.count%20%3E%201%20%3F%20object.count%20%3A%201%3B%0A%20%20%7D%0A%20%20getDrawingBufferSize%28%29%20%7B%0A%20%20%20%20vector2%20%3D%20vector2%20%7C%7C%20new%20Vector22%28%29%3B%0A%20%20%20%20return%20this.renderer.getDrawingBufferSize%28vector2%29%3B%0A%20%20%7D%0A%20%20getScissor%28%29%20%7B%0A%20%20%20%20vector4%20%3D%20vector4%20%7C%7C%20new%20Vector42%28%29%3B%0A%20%20%20%20return%20this.renderer.getScissor%28vector4%29%3B%0A%20%20%7D%0A%20%20setScissorTest%28%29%20%7B%0A%20%20%7D%0A%20%20getClearColor%28%29%20%7B%0A%20%20%20%20const%20renderer3%20%3D%20this.renderer%3B%0A%20%20%20%20color4%20%3D%20color4%20%7C%7C%20new%20Color4%28%29%3B%0A%20%20%20%20renderer3.getClearColor%28color4%29%3B%0A%20%20%20%20color4.getRGB%28color4%2C%20this.renderer.currentColorSpace%29%3B%0A%20%20%20%20return%20color4%3B%0A%20%20%7D%0A%20%20getDomElement%28%29%20%7B%0A%20%20%20%20let%20domElement%20%3D%20this.domElement%3B%0A%20%20%20%20if%20%28domElement%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20domElement%20%3D%20this.parameters.canvas%20%21%3D%3D%20void%200%20%3F%20this.parameters.canvas%20%3A%20createCanvasElement2%28%29%3B%0A%20%20%20%20%20%20if%20%28%22setAttribute%22%20in%20domElement%29%20domElement.setAttribute%28%22data-engine%22%2C%20%60three.js%20r%24%7BREVISION2%7D%20webgpu%60%29%3B%0A%20%20%20%20%20%20this.domElement%20%3D%20domElement%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20domElement%3B%0A%20%20%7D%0A%20%20%2F%2F%20resource%20properties%0A%20%20set%28object%2C%20value%29%20%7B%0A%20%20%20%20this.data.set%28object%2C%20value%29%3B%0A%20%20%7D%0A%20%20get%28object%29%20%7B%0A%20%20%20%20let%20map%20%3D%20this.data.get%28object%29%3B%0A%20%20%20%20if%20%28map%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20map%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20this.data.set%28object%2C%20map%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20map%3B%0A%20%20%7D%0A%20%20has%28object%29%20%7B%0A%20%20%20%20return%20this.data.has%28object%29%3B%0A%20%20%7D%0A%20%20delete%28object%29%20%7B%0A%20%20%20%20this.data.delete%28object%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%7D%0A%7D%3B%0Avar%20_id%2412%20%3D%200%3B%0Avar%20DualAttributeData%20%3D%20class%20%7B%0A%20%20constructor%28attributeData%2C%20dualBuffer%29%20%7B%0A%20%20%20%20this.buffers%20%3D%20%5BattributeData.bufferGPU%2C%20dualBuffer%5D%3B%0A%20%20%20%20this.type%20%3D%20attributeData.type%3B%0A%20%20%20%20this.bufferType%20%3D%20attributeData.bufferType%3B%0A%20%20%20%20this.pbo%20%3D%20attributeData.pbo%3B%0A%20%20%20%20this.byteLength%20%3D%20attributeData.byteLength%3B%0A%20%20%20%20this.bytesPerElement%20%3D%20attributeData.BYTES_PER_ELEMENT%3B%0A%20%20%20%20this.version%20%3D%20attributeData.version%3B%0A%20%20%20%20this.isInteger%20%3D%20attributeData.isInteger%3B%0A%20%20%20%20this.activeBufferIndex%20%3D%200%3B%0A%20%20%20%20this.baseId%20%3D%20attributeData.id%3B%0A%20%20%7D%0A%20%20get%20id%28%29%20%7B%0A%20%20%20%20return%20%60%24%7Bthis.baseId%7D%7C%24%7Bthis.activeBufferIndex%7D%60%3B%0A%20%20%7D%0A%20%20get%20bufferGPU%28%29%20%7B%0A%20%20%20%20return%20this.buffers%5Bthis.activeBufferIndex%5D%3B%0A%20%20%7D%0A%20%20get%20transformBuffer%28%29%20%7B%0A%20%20%20%20return%20this.buffers%5Bthis.activeBufferIndex%20%5E%201%5D%3B%0A%20%20%7D%0A%20%20switchBuffers%28%29%20%7B%0A%20%20%20%20this.activeBufferIndex%20%5E%3D%201%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGLAttributeUtils%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%7D%0A%20%20createAttribute%28attribute2%2C%20bufferType%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20backend%3B%0A%20%20%20%20const%20array%20%3D%20attribute2.array%3B%0A%20%20%20%20const%20usage%20%3D%20attribute2.usage%20%7C%7C%20gl.STATIC_DRAW%3B%0A%20%20%20%20const%20bufferAttribute2%20%3D%20attribute2.isInterleavedBufferAttribute%20%3F%20attribute2.data%20%3A%20attribute2%3B%0A%20%20%20%20const%20bufferData%20%3D%20backend.get%28bufferAttribute2%29%3B%0A%20%20%20%20let%20bufferGPU%20%3D%20bufferData.bufferGPU%3B%0A%20%20%20%20if%20%28bufferGPU%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20bufferGPU%20%3D%20this._createBuffer%28gl%2C%20bufferType%2C%20array%2C%20usage%29%3B%0A%20%20%20%20%20%20bufferData.bufferGPU%20%3D%20bufferGPU%3B%0A%20%20%20%20%20%20bufferData.bufferType%20%3D%20bufferType%3B%0A%20%20%20%20%20%20bufferData.version%20%3D%20bufferAttribute2.version%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20type%3B%0A%20%20%20%20if%20%28array%20instanceof%20Float32Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.FLOAT%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Uint16Array%29%20%7B%0A%20%20%20%20%20%20if%20%28attribute2.isFloat16BufferAttribute%29%20%7B%0A%20%20%20%20%20%20%20%20type%20%3D%20gl.HALF_FLOAT%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20type%20%3D%20gl.UNSIGNED_SHORT%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Int16Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.SHORT%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Uint32Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.UNSIGNED_INT%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Int32Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.INT%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Int8Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.BYTE%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Uint8Array%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.UNSIGNED_BYTE%3B%0A%20%20%20%20%7D%20else%20if%20%28array%20instanceof%20Uint8ClampedArray%29%20%7B%0A%20%20%20%20%20%20type%20%3D%20gl.UNSIGNED_BYTE%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGLBackend%3A%20Unsupported%20buffer%20data%20format%3A%20%22%20%2B%20array%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20attributeData%20%3D%20%7B%0A%20%20%20%20%20%20bufferGPU%2C%0A%20%20%20%20%20%20bufferType%2C%0A%20%20%20%20%20%20type%2C%0A%20%20%20%20%20%20byteLength%3A%20array.byteLength%2C%0A%20%20%20%20%20%20bytesPerElement%3A%20array.BYTES_PER_ELEMENT%2C%0A%20%20%20%20%20%20version%3A%20attribute2.version%2C%0A%20%20%20%20%20%20pbo%3A%20attribute2.pbo%2C%0A%20%20%20%20%20%20isInteger%3A%20type%20%3D%3D%3D%20gl.INT%20%7C%7C%20type%20%3D%3D%3D%20gl.UNSIGNED_INT%20%7C%7C%20attribute2.gpuType%20%3D%3D%3D%20IntType2%2C%0A%20%20%20%20%20%20id%3A%20_id%2412%2B%2B%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28attribute2.isStorageBufferAttribute%20%7C%7C%20attribute2.isStorageInstancedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20const%20bufferGPUDual%20%3D%20this._createBuffer%28gl%2C%20bufferType%2C%20array%2C%20usage%29%3B%0A%20%20%20%20%20%20attributeData%20%3D%20new%20DualAttributeData%28attributeData%2C%20bufferGPUDual%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20backend.set%28attribute2%2C%20attributeData%29%3B%0A%20%20%7D%0A%20%20updateAttribute%28attribute2%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20backend%3B%0A%20%20%20%20const%20array%20%3D%20attribute2.array%3B%0A%20%20%20%20const%20bufferAttribute2%20%3D%20attribute2.isInterleavedBufferAttribute%20%3F%20attribute2.data%20%3A%20attribute2%3B%0A%20%20%20%20const%20bufferData%20%3D%20backend.get%28bufferAttribute2%29%3B%0A%20%20%20%20const%20bufferType%20%3D%20bufferData.bufferType%3B%0A%20%20%20%20const%20updateRanges%20%3D%20attribute2.isInterleavedBufferAttribute%20%3F%20attribute2.data.updateRanges%20%3A%20attribute2.updateRanges%3B%0A%20%20%20%20gl.bindBuffer%28bufferType%2C%20bufferData.bufferGPU%29%3B%0A%20%20%20%20if%20%28updateRanges.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20gl.bufferSubData%28bufferType%2C%200%2C%20array%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20updateRanges.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20range%20%3D%20updateRanges%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20gl.bufferSubData%28%0A%20%20%20%20%20%20%20%20%20%20bufferType%2C%0A%20%20%20%20%20%20%20%20%20%20range.start%20%2A%20array.BYTES_PER_ELEMENT%2C%0A%20%20%20%20%20%20%20%20%20%20array%2C%0A%20%20%20%20%20%20%20%20%20%20range.start%2C%0A%20%20%20%20%20%20%20%20%20%20range.count%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20bufferAttribute2.clearUpdateRanges%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20gl.bindBuffer%28bufferType%2C%20null%29%3B%0A%20%20%20%20bufferData.version%20%3D%20bufferAttribute2.version%3B%0A%20%20%7D%0A%20%20destroyAttribute%28attribute2%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20backend%3B%0A%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20backend.delete%28attribute2.data%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20attributeData%20%3D%20backend.get%28attribute2%29%3B%0A%20%20%20%20gl.deleteBuffer%28attributeData.bufferGPU%29%3B%0A%20%20%20%20backend.delete%28attribute2%29%3B%0A%20%20%7D%0A%20%20async%20getArrayBufferAsync%28attribute2%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20backend%3B%0A%20%20%20%20const%20bufferAttribute2%20%3D%20attribute2.isInterleavedBufferAttribute%20%3F%20attribute2.data%20%3A%20attribute2%3B%0A%20%20%20%20const%20%7B%20bufferGPU%20%7D%20%3D%20backend.get%28bufferAttribute2%29%3B%0A%20%20%20%20const%20array%20%3D%20attribute2.array%3B%0A%20%20%20%20const%20byteLength%20%3D%20array.byteLength%3B%0A%20%20%20%20gl.bindBuffer%28gl.COPY_READ_BUFFER%2C%20bufferGPU%29%3B%0A%20%20%20%20const%20writeBuffer%20%3D%20gl.createBuffer%28%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.COPY_WRITE_BUFFER%2C%20writeBuffer%29%3B%0A%20%20%20%20gl.bufferData%28gl.COPY_WRITE_BUFFER%2C%20byteLength%2C%20gl.STREAM_READ%29%3B%0A%20%20%20%20gl.copyBufferSubData%28gl.COPY_READ_BUFFER%2C%20gl.COPY_WRITE_BUFFER%2C%200%2C%200%2C%20byteLength%29%3B%0A%20%20%20%20await%20backend.utils._clientWaitAsync%28%29%3B%0A%20%20%20%20const%20dstBuffer%20%3D%20new%20attribute2.array.constructor%28array.length%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.COPY_WRITE_BUFFER%2C%20writeBuffer%29%3B%0A%20%20%20%20gl.getBufferSubData%28gl.COPY_WRITE_BUFFER%2C%200%2C%20dstBuffer%29%3B%0A%20%20%20%20gl.deleteBuffer%28writeBuffer%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.COPY_READ_BUFFER%2C%20null%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.COPY_WRITE_BUFFER%2C%20null%29%3B%0A%20%20%20%20return%20dstBuffer.buffer%3B%0A%20%20%7D%0A%20%20_createBuffer%28gl%2C%20bufferType%2C%20array%2C%20usage%29%20%7B%0A%20%20%20%20const%20bufferGPU%20%3D%20gl.createBuffer%28%29%3B%0A%20%20%20%20gl.bindBuffer%28bufferType%2C%20bufferGPU%29%3B%0A%20%20%20%20gl.bufferData%28bufferType%2C%20array%2C%20usage%29%3B%0A%20%20%20%20gl.bindBuffer%28bufferType%2C%20null%29%3B%0A%20%20%20%20return%20bufferGPU%3B%0A%20%20%7D%0A%7D%3B%0Avar%20initialized%241%20%3D%20false%3B%0Avar%20equationToGL%3B%0Avar%20factorToGL%3B%0Avar%20WebGLState2%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.gl%20%3D%20this.backend.gl%3B%0A%20%20%20%20this.enabled%20%3D%20%7B%7D%3B%0A%20%20%20%20this.currentFlipSided%20%3D%20null%3B%0A%20%20%20%20this.currentCullFace%20%3D%20null%3B%0A%20%20%20%20this.currentProgram%20%3D%20null%3B%0A%20%20%20%20this.currentBlendingEnabled%20%3D%20false%3B%0A%20%20%20%20this.currentBlending%20%3D%20null%3B%0A%20%20%20%20this.currentBlendSrc%20%3D%20null%3B%0A%20%20%20%20this.currentBlendDst%20%3D%20null%3B%0A%20%20%20%20this.currentBlendSrcAlpha%20%3D%20null%3B%0A%20%20%20%20this.currentBlendDstAlpha%20%3D%20null%3B%0A%20%20%20%20this.currentPremultipledAlpha%20%3D%20null%3B%0A%20%20%20%20this.currentPolygonOffsetFactor%20%3D%20null%3B%0A%20%20%20%20this.currentPolygonOffsetUnits%20%3D%20null%3B%0A%20%20%20%20this.currentColorMask%20%3D%20null%3B%0A%20%20%20%20this.currentDepthFunc%20%3D%20null%3B%0A%20%20%20%20this.currentDepthMask%20%3D%20null%3B%0A%20%20%20%20this.currentStencilFunc%20%3D%20null%3B%0A%20%20%20%20this.currentStencilRef%20%3D%20null%3B%0A%20%20%20%20this.currentStencilFuncMask%20%3D%20null%3B%0A%20%20%20%20this.currentStencilFail%20%3D%20null%3B%0A%20%20%20%20this.currentStencilZFail%20%3D%20null%3B%0A%20%20%20%20this.currentStencilZPass%20%3D%20null%3B%0A%20%20%20%20this.currentStencilMask%20%3D%20null%3B%0A%20%20%20%20this.currentLineWidth%20%3D%20null%3B%0A%20%20%20%20this.currentBoundFramebuffers%20%3D%20%7B%7D%3B%0A%20%20%20%20this.currentDrawbuffers%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%20%20this.maxTextures%20%3D%20this.gl.getParameter%28this.gl.MAX_TEXTURE_IMAGE_UNITS%29%3B%0A%20%20%20%20this.currentTextureSlot%20%3D%20null%3B%0A%20%20%20%20this.currentBoundTextures%20%3D%20%7B%7D%3B%0A%20%20%20%20this.currentBoundBufferBases%20%3D%20%7B%7D%3B%0A%20%20%20%20if%20%28initialized%241%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this._init%28this.gl%29%3B%0A%20%20%20%20%20%20initialized%241%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_init%28gl%29%20%7B%0A%20%20%20%20equationToGL%20%3D%20%7B%0A%20%20%20%20%20%20%5BAddEquation2%5D%3A%20gl.FUNC_ADD%2C%0A%20%20%20%20%20%20%5BSubtractEquation2%5D%3A%20gl.FUNC_SUBTRACT%2C%0A%20%20%20%20%20%20%5BReverseSubtractEquation2%5D%3A%20gl.FUNC_REVERSE_SUBTRACT%0A%20%20%20%20%7D%3B%0A%20%20%20%20factorToGL%20%3D%20%7B%0A%20%20%20%20%20%20%5BZeroFactor2%5D%3A%20gl.ZERO%2C%0A%20%20%20%20%20%20%5BOneFactor2%5D%3A%20gl.ONE%2C%0A%20%20%20%20%20%20%5BSrcColorFactor2%5D%3A%20gl.SRC_COLOR%2C%0A%20%20%20%20%20%20%5BSrcAlphaFactor2%5D%3A%20gl.SRC_ALPHA%2C%0A%20%20%20%20%20%20%5BSrcAlphaSaturateFactor2%5D%3A%20gl.SRC_ALPHA_SATURATE%2C%0A%20%20%20%20%20%20%5BDstColorFactor2%5D%3A%20gl.DST_COLOR%2C%0A%20%20%20%20%20%20%5BDstAlphaFactor2%5D%3A%20gl.DST_ALPHA%2C%0A%20%20%20%20%20%20%5BOneMinusSrcColorFactor2%5D%3A%20gl.ONE_MINUS_SRC_COLOR%2C%0A%20%20%20%20%20%20%5BOneMinusSrcAlphaFactor2%5D%3A%20gl.ONE_MINUS_SRC_ALPHA%2C%0A%20%20%20%20%20%20%5BOneMinusDstColorFactor2%5D%3A%20gl.ONE_MINUS_DST_COLOR%2C%0A%20%20%20%20%20%20%5BOneMinusDstAlphaFactor2%5D%3A%20gl.ONE_MINUS_DST_ALPHA%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20enable%28id2%29%20%7B%0A%20%20%20%20const%20%7B%20enabled%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28enabled%5Bid2%5D%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.gl.enable%28id2%29%3B%0A%20%20%20%20%20%20enabled%5Bid2%5D%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20disable%28id2%29%20%7B%0A%20%20%20%20const%20%7B%20enabled%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28enabled%5Bid2%5D%20%21%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this.gl.disable%28id2%29%3B%0A%20%20%20%20%20%20enabled%5Bid2%5D%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setFlipSided%28flipSided%29%20%7B%0A%20%20%20%20if%20%28this.currentFlipSided%20%21%3D%3D%20flipSided%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20%20%20if%20%28flipSided%29%20%7B%0A%20%20%20%20%20%20%20%20gl.frontFace%28gl.CW%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20gl.frontFace%28gl.CCW%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.currentFlipSided%20%3D%20flipSided%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setCullFace%28cullFace%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28cullFace%20%21%3D%3D%20CullFaceNone2%29%20%7B%0A%20%20%20%20%20%20this.enable%28gl.CULL_FACE%29%3B%0A%20%20%20%20%20%20if%20%28cullFace%20%21%3D%3D%20this.currentCullFace%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28cullFace%20%3D%3D%3D%20CullFaceBack2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.cullFace%28gl.BACK%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28cullFace%20%3D%3D%3D%20CullFaceFront2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.cullFace%28gl.FRONT%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.cullFace%28gl.FRONT_AND_BACK%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.disable%28gl.CULL_FACE%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.currentCullFace%20%3D%20cullFace%3B%0A%20%20%7D%0A%20%20setLineWidth%28width%29%20%7B%0A%20%20%20%20const%20%7B%20currentLineWidth%2C%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28width%20%21%3D%3D%20currentLineWidth%29%20%7B%0A%20%20%20%20%20%20gl.lineWidth%28width%29%3B%0A%20%20%20%20%20%20this.currentLineWidth%20%3D%20width%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setBlending%28blending%2C%20blendEquation%2C%20blendSrc%2C%20blendDst%2C%20blendEquationAlpha%2C%20blendSrcAlpha%2C%20blendDstAlpha%2C%20premultipliedAlpha%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28blending%20%3D%3D%3D%20NoBlending2%29%20%7B%0A%20%20%20%20%20%20if%20%28this.currentBlendingEnabled%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20this.disable%28gl.BLEND%29%3B%0A%20%20%20%20%20%20%20%20this.currentBlendingEnabled%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.currentBlendingEnabled%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this.enable%28gl.BLEND%29%3B%0A%20%20%20%20%20%20this.currentBlendingEnabled%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28blending%20%21%3D%3D%20CustomBlending2%29%20%7B%0A%20%20%20%20%20%20if%20%28blending%20%21%3D%3D%20this.currentBlending%20%7C%7C%20premultipliedAlpha%20%21%3D%3D%20this.currentPremultipledAlpha%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.currentBlendEquation%20%21%3D%3D%20AddEquation2%20%7C%7C%20this.currentBlendEquationAlpha%20%21%3D%3D%20AddEquation2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.blendEquation%28gl.FUNC_ADD%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.currentBlendEquation%20%3D%20AddEquation2%3B%0A%20%20%20%20%20%20%20%20%20%20this.currentBlendEquationAlpha%20%3D%20AddEquation2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28premultipliedAlpha%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20switch%20%28blending%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20NormalBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.ONE%2C%20gl.ONE_MINUS_SRC_ALPHA%2C%20gl.ONE%2C%20gl.ONE_MINUS_SRC_ALPHA%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20AdditiveBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFunc%28gl.ONE%2C%20gl.ONE%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20SubtractiveBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.ZERO%2C%20gl.ONE_MINUS_SRC_COLOR%2C%20gl.ZERO%2C%20gl.ONE%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20MultiplyBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.ZERO%2C%20gl.SRC_COLOR%2C%20gl.ZERO%2C%20gl.SRC_ALPHA%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%20Invalid%20blending%3A%20%22%2C%20blending%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20switch%20%28blending%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20NormalBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.SRC_ALPHA%2C%20gl.ONE_MINUS_SRC_ALPHA%2C%20gl.ONE%2C%20gl.ONE_MINUS_SRC_ALPHA%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20AdditiveBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFunc%28gl.SRC_ALPHA%2C%20gl.ONE%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20SubtractiveBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFuncSeparate%28gl.ZERO%2C%20gl.ONE_MINUS_SRC_COLOR%2C%20gl.ZERO%2C%20gl.ONE%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20MultiplyBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.blendFunc%28gl.ZERO%2C%20gl.SRC_COLOR%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGLState%3A%20Invalid%20blending%3A%20%22%2C%20blending%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this.currentBlendSrc%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.currentBlendDst%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.currentBlendSrcAlpha%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.currentBlendDstAlpha%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.currentBlending%20%3D%20blending%3B%0A%20%20%20%20%20%20%20%20this.currentPremultipledAlpha%20%3D%20premultipliedAlpha%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20blendEquationAlpha%20%3D%20blendEquationAlpha%20%7C%7C%20blendEquation%3B%0A%20%20%20%20blendSrcAlpha%20%3D%20blendSrcAlpha%20%7C%7C%20blendSrc%3B%0A%20%20%20%20blendDstAlpha%20%3D%20blendDstAlpha%20%7C%7C%20blendDst%3B%0A%20%20%20%20if%20%28blendEquation%20%21%3D%3D%20this.currentBlendEquation%20%7C%7C%20blendEquationAlpha%20%21%3D%3D%20this.currentBlendEquationAlpha%29%20%7B%0A%20%20%20%20%20%20gl.blendEquationSeparate%28equationToGL%5BblendEquation%5D%2C%20equationToGL%5BblendEquationAlpha%5D%29%3B%0A%20%20%20%20%20%20this.currentBlendEquation%20%3D%20blendEquation%3B%0A%20%20%20%20%20%20this.currentBlendEquationAlpha%20%3D%20blendEquationAlpha%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28blendSrc%20%21%3D%3D%20this.currentBlendSrc%20%7C%7C%20blendDst%20%21%3D%3D%20this.currentBlendDst%20%7C%7C%20blendSrcAlpha%20%21%3D%3D%20this.currentBlendSrcAlpha%20%7C%7C%20blendDstAlpha%20%21%3D%3D%20this.currentBlendDstAlpha%29%20%7B%0A%20%20%20%20%20%20gl.blendFuncSeparate%28factorToGL%5BblendSrc%5D%2C%20factorToGL%5BblendDst%5D%2C%20factorToGL%5BblendSrcAlpha%5D%2C%20factorToGL%5BblendDstAlpha%5D%29%3B%0A%20%20%20%20%20%20this.currentBlendSrc%20%3D%20blendSrc%3B%0A%20%20%20%20%20%20this.currentBlendDst%20%3D%20blendDst%3B%0A%20%20%20%20%20%20this.currentBlendSrcAlpha%20%3D%20blendSrcAlpha%3B%0A%20%20%20%20%20%20this.currentBlendDstAlpha%20%3D%20blendDstAlpha%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.currentBlending%20%3D%20blending%3B%0A%20%20%20%20this.currentPremultipledAlpha%20%3D%20false%3B%0A%20%20%7D%0A%20%20setColorMask%28colorMask%29%20%7B%0A%20%20%20%20if%20%28this.currentColorMask%20%21%3D%3D%20colorMask%29%20%7B%0A%20%20%20%20%20%20this.gl.colorMask%28colorMask%2C%20colorMask%2C%20colorMask%2C%20colorMask%29%3B%0A%20%20%20%20%20%20this.currentColorMask%20%3D%20colorMask%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setDepthTest%28depthTest%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28depthTest%29%20%7B%0A%20%20%20%20%20%20this.enable%28gl.DEPTH_TEST%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.disable%28gl.DEPTH_TEST%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setDepthMask%28depthMask%29%20%7B%0A%20%20%20%20if%20%28this.currentDepthMask%20%21%3D%3D%20depthMask%29%20%7B%0A%20%20%20%20%20%20this.gl.depthMask%28depthMask%29%3B%0A%20%20%20%20%20%20this.currentDepthMask%20%3D%20depthMask%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setDepthFunc%28depthFunc%29%20%7B%0A%20%20%20%20if%20%28this.currentDepthFunc%20%21%3D%3D%20depthFunc%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20%20%20switch%20%28depthFunc%29%20%7B%0A%20%20%20%20%20%20%20%20case%20NeverDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.NEVER%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20AlwaysDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.ALWAYS%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20LessDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.LESS%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20LessEqualDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.LEQUAL%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20EqualDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.EQUAL%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20GreaterEqualDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.GEQUAL%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20GreaterDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.GREATER%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20NotEqualDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.NOTEQUAL%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20gl.depthFunc%28gl.LEQUAL%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.currentDepthFunc%20%3D%20depthFunc%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setStencilTest%28stencilTest%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28stencilTest%29%20%7B%0A%20%20%20%20%20%20this.enable%28gl.STENCIL_TEST%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.disable%28gl.STENCIL_TEST%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setStencilMask%28stencilMask%29%20%7B%0A%20%20%20%20if%20%28this.currentStencilMask%20%21%3D%3D%20stencilMask%29%20%7B%0A%20%20%20%20%20%20this.gl.stencilMask%28stencilMask%29%3B%0A%20%20%20%20%20%20this.currentStencilMask%20%3D%20stencilMask%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setStencilFunc%28stencilFunc%2C%20stencilRef%2C%20stencilMask%29%20%7B%0A%20%20%20%20if%20%28this.currentStencilFunc%20%21%3D%3D%20stencilFunc%20%7C%7C%20this.currentStencilRef%20%21%3D%3D%20stencilRef%20%7C%7C%20this.currentStencilFuncMask%20%21%3D%3D%20stencilMask%29%20%7B%0A%20%20%20%20%20%20this.gl.stencilFunc%28stencilFunc%2C%20stencilRef%2C%20stencilMask%29%3B%0A%20%20%20%20%20%20this.currentStencilFunc%20%3D%20stencilFunc%3B%0A%20%20%20%20%20%20this.currentStencilRef%20%3D%20stencilRef%3B%0A%20%20%20%20%20%20this.currentStencilFuncMask%20%3D%20stencilMask%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setStencilOp%28stencilFail%2C%20stencilZFail%2C%20stencilZPass%29%20%7B%0A%20%20%20%20if%20%28this.currentStencilFail%20%21%3D%3D%20stencilFail%20%7C%7C%20this.currentStencilZFail%20%21%3D%3D%20stencilZFail%20%7C%7C%20this.currentStencilZPass%20%21%3D%3D%20stencilZPass%29%20%7B%0A%20%20%20%20%20%20this.gl.stencilOp%28stencilFail%2C%20stencilZFail%2C%20stencilZPass%29%3B%0A%20%20%20%20%20%20this.currentStencilFail%20%3D%20stencilFail%3B%0A%20%20%20%20%20%20this.currentStencilZFail%20%3D%20stencilZFail%3B%0A%20%20%20%20%20%20this.currentStencilZPass%20%3D%20stencilZPass%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setMaterial%28material%2C%20frontFaceCW%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20material.side%20%3D%3D%3D%20DoubleSide2%20%3F%20this.disable%28gl.CULL_FACE%29%20%3A%20this.enable%28gl.CULL_FACE%29%3B%0A%20%20%20%20let%20flipSided%20%3D%20material.side%20%3D%3D%3D%20BackSide2%3B%0A%20%20%20%20if%20%28frontFaceCW%29%20flipSided%20%3D%20%21flipSided%3B%0A%20%20%20%20this.setFlipSided%28flipSided%29%3B%0A%20%20%20%20material.blending%20%3D%3D%3D%20NormalBlending2%20%26%26%20material.transparent%20%3D%3D%3D%20false%20%3F%20this.setBlending%28NoBlending2%29%20%3A%20this.setBlending%28material.blending%2C%20material.blendEquation%2C%20material.blendSrc%2C%20material.blendDst%2C%20material.blendEquationAlpha%2C%20material.blendSrcAlpha%2C%20material.blendDstAlpha%2C%20material.premultipliedAlpha%29%3B%0A%20%20%20%20this.setDepthFunc%28material.depthFunc%29%3B%0A%20%20%20%20this.setDepthTest%28material.depthTest%29%3B%0A%20%20%20%20this.setDepthMask%28material.depthWrite%29%3B%0A%20%20%20%20this.setColorMask%28material.colorWrite%29%3B%0A%20%20%20%20const%20stencilWrite%20%3D%20material.stencilWrite%3B%0A%20%20%20%20this.setStencilTest%28stencilWrite%29%3B%0A%20%20%20%20if%20%28stencilWrite%29%20%7B%0A%20%20%20%20%20%20this.setStencilMask%28material.stencilWriteMask%29%3B%0A%20%20%20%20%20%20this.setStencilFunc%28material.stencilFunc%2C%20material.stencilRef%2C%20material.stencilFuncMask%29%3B%0A%20%20%20%20%20%20this.setStencilOp%28material.stencilFail%2C%20material.stencilZFail%2C%20material.stencilZPass%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.setPolygonOffset%28material.polygonOffset%2C%20material.polygonOffsetFactor%2C%20material.polygonOffsetUnits%29%3B%0A%20%20%20%20material.alphaToCoverage%20%3D%3D%3D%20true%20%26%26%20this.backend.renderer.samples%20%3E%201%20%3F%20this.enable%28gl.SAMPLE_ALPHA_TO_COVERAGE%29%20%3A%20this.disable%28gl.SAMPLE_ALPHA_TO_COVERAGE%29%3B%0A%20%20%7D%0A%20%20setPolygonOffset%28polygonOffset%2C%20factor%2C%20units%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28polygonOffset%29%20%7B%0A%20%20%20%20%20%20this.enable%28gl.POLYGON_OFFSET_FILL%29%3B%0A%20%20%20%20%20%20if%20%28this.currentPolygonOffsetFactor%20%21%3D%3D%20factor%20%7C%7C%20this.currentPolygonOffsetUnits%20%21%3D%3D%20units%29%20%7B%0A%20%20%20%20%20%20%20%20gl.polygonOffset%28factor%2C%20units%29%3B%0A%20%20%20%20%20%20%20%20this.currentPolygonOffsetFactor%20%3D%20factor%3B%0A%20%20%20%20%20%20%20%20this.currentPolygonOffsetUnits%20%3D%20units%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.disable%28gl.POLYGON_OFFSET_FILL%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20useProgram%28program%29%20%7B%0A%20%20%20%20if%20%28this.currentProgram%20%21%3D%3D%20program%29%20%7B%0A%20%20%20%20%20%20this.gl.useProgram%28program%29%3B%0A%20%20%20%20%20%20this.currentProgram%20%3D%20program%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20%2F%2F%20framebuffer%0A%20%20bindFramebuffer%28target%2C%20framebuffer%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20currentBoundFramebuffers%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28currentBoundFramebuffers%5Btarget%5D%20%21%3D%3D%20framebuffer%29%20%7B%0A%20%20%20%20%20%20gl.bindFramebuffer%28target%2C%20framebuffer%29%3B%0A%20%20%20%20%20%20currentBoundFramebuffers%5Btarget%5D%20%3D%20framebuffer%3B%0A%20%20%20%20%20%20if%20%28target%20%3D%3D%3D%20gl.DRAW_FRAMEBUFFER%29%20%7B%0A%20%20%20%20%20%20%20%20currentBoundFramebuffers%5Bgl.FRAMEBUFFER%5D%20%3D%20framebuffer%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28target%20%3D%3D%3D%20gl.FRAMEBUFFER%29%20%7B%0A%20%20%20%20%20%20%20%20currentBoundFramebuffers%5Bgl.DRAW_FRAMEBUFFER%5D%20%3D%20framebuffer%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20drawBuffers%28renderContext%2C%20framebuffer%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20drawBuffers%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20needsUpdate%20%3D%20false%3B%0A%20%20%20%20if%20%28renderContext.textures%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20drawBuffers%20%3D%20this.currentDrawbuffers.get%28framebuffer%29%3B%0A%20%20%20%20%20%20if%20%28drawBuffers%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20drawBuffers%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20this.currentDrawbuffers.set%28framebuffer%2C%20drawBuffers%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20textures%20%3D%20renderContext.textures%3B%0A%20%20%20%20%20%20if%20%28drawBuffers.length%20%21%3D%3D%20textures.length%20%7C%7C%20drawBuffers%5B0%5D%20%21%3D%3D%20gl.COLOR_ATTACHMENT0%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20textures.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20drawBuffers%5Bi%5D%20%3D%20gl.COLOR_ATTACHMENT0%20%2B%20i%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20drawBuffers.length%20%3D%20textures.length%3B%0A%20%20%20%20%20%20%20%20needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28drawBuffers%5B0%5D%20%21%3D%3D%20gl.BACK%29%20%7B%0A%20%20%20%20%20%20%20%20drawBuffers%5B0%5D%20%3D%20gl.BACK%3B%0A%20%20%20%20%20%20%20%20needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28needsUpdate%29%20%7B%0A%20%20%20%20%20%20gl.drawBuffers%28drawBuffers%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2F%20texture%0A%20%20activeTexture%28webglSlot%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20currentTextureSlot%2C%20maxTextures%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28webglSlot%20%3D%3D%3D%20void%200%29%20webglSlot%20%3D%20gl.TEXTURE0%20%2B%20maxTextures%20-%201%3B%0A%20%20%20%20if%20%28currentTextureSlot%20%21%3D%3D%20webglSlot%29%20%7B%0A%20%20%20%20%20%20gl.activeTexture%28webglSlot%29%3B%0A%20%20%20%20%20%20this.currentTextureSlot%20%3D%20webglSlot%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20bindTexture%28webglType%2C%20webglTexture%2C%20webglSlot%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20currentTextureSlot%2C%20currentBoundTextures%2C%20maxTextures%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28webglSlot%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28currentTextureSlot%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20webglSlot%20%3D%20gl.TEXTURE0%20%2B%20maxTextures%20-%201%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20webglSlot%20%3D%20currentTextureSlot%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20let%20boundTexture%20%3D%20currentBoundTextures%5BwebglSlot%5D%3B%0A%20%20%20%20if%20%28boundTexture%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20boundTexture%20%3D%20%7B%20type%3A%20void%200%2C%20texture%3A%20void%200%20%7D%3B%0A%20%20%20%20%20%20currentBoundTextures%5BwebglSlot%5D%20%3D%20boundTexture%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28boundTexture.type%20%21%3D%3D%20webglType%20%7C%7C%20boundTexture.texture%20%21%3D%3D%20webglTexture%29%20%7B%0A%20%20%20%20%20%20if%20%28currentTextureSlot%20%21%3D%3D%20webglSlot%29%20%7B%0A%20%20%20%20%20%20%20%20gl.activeTexture%28webglSlot%29%3B%0A%20%20%20%20%20%20%20%20this.currentTextureSlot%20%3D%20webglSlot%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20gl.bindTexture%28webglType%2C%20webglTexture%29%3B%0A%20%20%20%20%20%20boundTexture.type%20%3D%20webglType%3B%0A%20%20%20%20%20%20boundTexture.texture%20%3D%20webglTexture%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20bindBufferBase%28target%2C%20index5%2C%20buffer2%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20key%20%3D%20%60%24%7Btarget%7D-%24%7Bindex5%7D%60%3B%0A%20%20%20%20if%20%28this.currentBoundBufferBases%5Bkey%5D%20%21%3D%3D%20buffer2%29%20%7B%0A%20%20%20%20%20%20gl.bindBufferBase%28target%2C%20index5%2C%20buffer2%29%3B%0A%20%20%20%20%20%20this.currentBoundBufferBases%5Bkey%5D%20%3D%20buffer2%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20unbindTexture%28%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20currentTextureSlot%2C%20currentBoundTextures%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20boundTexture%20%3D%20currentBoundTextures%5BcurrentTextureSlot%5D%3B%0A%20%20%20%20if%20%28boundTexture%20%21%3D%3D%20void%200%20%26%26%20boundTexture.type%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20gl.bindTexture%28boundTexture.type%2C%20null%29%3B%0A%20%20%20%20%20%20boundTexture.type%20%3D%20void%200%3B%0A%20%20%20%20%20%20boundTexture.texture%20%3D%20void%200%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20WebGLUtils2%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.gl%20%3D%20this.backend.gl%3B%0A%20%20%20%20this.extensions%20%3D%20backend.extensions%3B%0A%20%20%7D%0A%20%20convert%28p%2C%20colorSpace%20%3D%20NoColorSpace2%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20extensions%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20extension%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedByteType2%29%20return%20gl.UNSIGNED_BYTE%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedShort4444Type2%29%20return%20gl.UNSIGNED_SHORT_4_4_4_4%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedShort5551Type2%29%20return%20gl.UNSIGNED_SHORT_5_5_5_1%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedInt5999Type2%29%20return%20gl.UNSIGNED_INT_5_9_9_9_REV%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20ByteType2%29%20return%20gl.BYTE%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20ShortType2%29%20return%20gl.SHORT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedShortType2%29%20return%20gl.UNSIGNED_SHORT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20IntType2%29%20return%20gl.INT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedIntType2%29%20return%20gl.UNSIGNED_INT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20FloatType2%29%20return%20gl.FLOAT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20HalfFloatType2%29%20%7B%0A%20%20%20%20%20%20return%20gl.HALF_FLOAT%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20AlphaFormat2%29%20return%20gl.ALPHA%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBFormat2%29%20return%20gl.RGB%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBAFormat2%29%20return%20gl.RGBA%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20LuminanceFormat2%29%20return%20gl.LUMINANCE%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20LuminanceAlphaFormat2%29%20return%20gl.LUMINANCE_ALPHA%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20DepthFormat2%29%20return%20gl.DEPTH_COMPONENT%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20DepthStencilFormat2%29%20return%20gl.DEPTH_STENCIL%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RedFormat2%29%20return%20gl.RED%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RedIntegerFormat2%29%20return%20gl.RED_INTEGER%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGFormat2%29%20return%20gl.RG%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGIntegerFormat2%29%20return%20gl.RG_INTEGER%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBAIntegerFormat2%29%20return%20gl.RGBA_INTEGER%3B%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_S3TC_DXT1_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_S3TC_DXT1_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_S3TC_DXT3_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_S3TC_DXT5_Format2%29%20%7B%0A%20%20%20%20%20%20if%20%28colorSpace%20%3D%3D%3D%20SRGBColorSpace2%29%20%7B%0A%20%20%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_s3tc_srgb%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_S3TC_DXT1_Format2%29%20return%20extension.COMPRESSED_SRGB_S3TC_DXT1_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT1_Format2%29%20return%20extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT3_Format2%29%20return%20extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT5_Format2%29%20return%20extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_s3tc%22%29%3B%0A%20%20%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_S3TC_DXT1_Format2%29%20return%20extension.COMPRESSED_RGB_S3TC_DXT1_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT1_Format2%29%20return%20extension.COMPRESSED_RGBA_S3TC_DXT1_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT3_Format2%29%20return%20extension.COMPRESSED_RGBA_S3TC_DXT3_EXT%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_S3TC_DXT5_Format2%29%20return%20extension.COMPRESSED_RGBA_S3TC_DXT5_EXT%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_PVRTC_4BPPV1_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGB_PVRTC_2BPPV1_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_PVRTC_4BPPV1_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_PVRTC_2BPPV1_Format2%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_pvrtc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_PVRTC_4BPPV1_Format2%29%20return%20extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_PVRTC_2BPPV1_Format2%29%20return%20extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_PVRTC_4BPPV1_Format2%29%20return%20extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_PVRTC_2BPPV1_Format2%29%20return%20extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_ETC1_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGB_ETC2_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ETC2_EAC_Format2%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_etc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGB_ETC1_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGB_ETC2_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ETC2%20%3A%20extension.COMPRESSED_RGB8_ETC2%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ETC2_EAC_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC%20%3A%20extension.COMPRESSED_RGBA8_ETC2_EAC%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_4x4_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_5x4_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_5x5_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_6x5_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_6x6_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_8x5_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_8x6_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_8x8_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_10x5_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_10x6_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_10x8_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_10x10_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_12x10_Format2%20%7C%7C%20p%20%3D%3D%3D%20RGBA_ASTC_12x12_Format2%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22WEBGL_compressed_texture_astc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_4x4_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_4x4_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_5x4_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_5x4_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_5x5_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_5x5_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_6x5_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_6x5_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_6x6_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_6x6_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_8x5_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_8x5_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_8x6_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_8x6_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_8x8_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_8x8_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_10x5_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_10x5_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_10x6_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_10x6_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_10x8_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_10x8_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_10x10_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_10x10_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_12x10_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_12x10_KHR%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_ASTC_12x12_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR%20%3A%20extension.COMPRESSED_RGBA_ASTC_12x12_KHR%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_BPTC_Format2%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22EXT_texture_compression_bptc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_BPTC_Format2%29%20return%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20extension.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT%20%3A%20extension.COMPRESSED_RGBA_BPTC_UNORM_EXT%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20RED_RGTC1_Format2%20%7C%7C%20p%20%3D%3D%3D%20SIGNED_RED_RGTC1_Format2%20%7C%7C%20p%20%3D%3D%3D%20RED_GREEN_RGTC2_Format2%20%7C%7C%20p%20%3D%3D%3D%20SIGNED_RED_GREEN_RGTC2_Format2%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20extensions.get%28%22EXT_texture_compression_rgtc%22%29%3B%0A%20%20%20%20%20%20if%20%28extension%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RGBA_BPTC_Format2%29%20return%20extension.COMPRESSED_RED_RGTC1_EXT%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20SIGNED_RED_RGTC1_Format2%29%20return%20extension.COMPRESSED_SIGNED_RED_RGTC1_EXT%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20RED_GREEN_RGTC2_Format2%29%20return%20extension.COMPRESSED_RED_GREEN_RGTC2_EXT%3B%0A%20%20%20%20%20%20%20%20if%20%28p%20%3D%3D%3D%20SIGNED_RED_GREEN_RGTC2_Format2%29%20return%20extension.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28p%20%3D%3D%3D%20UnsignedInt248Type2%29%20%7B%0A%20%20%20%20%20%20return%20gl.UNSIGNED_INT_24_8%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20gl%5Bp%5D%20%21%3D%3D%20void%200%20%3F%20gl%5Bp%5D%20%3A%20null%3B%0A%20%20%7D%0A%20%20_clientWaitAsync%28%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20sync%20%3D%20gl.fenceSync%28gl.SYNC_GPU_COMMANDS_COMPLETE%2C%200%29%3B%0A%20%20%20%20gl.flush%28%29%3B%0A%20%20%20%20return%20new%20Promise%28%28resolve%2C%20reject%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20function%20test%28%29%20%7B%0A%20%20%20%20%20%20%20%20const%20res%20%3D%20gl.clientWaitSync%28sync%2C%20gl.SYNC_FLUSH_COMMANDS_BIT%2C%200%29%3B%0A%20%20%20%20%20%20%20%20if%20%28res%20%3D%3D%3D%20gl.WAIT_FAILED%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.deleteSync%28sync%29%3B%0A%20%20%20%20%20%20%20%20%20%20reject%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28res%20%3D%3D%3D%20gl.TIMEOUT_EXPIRED%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20requestAnimationFrame%28test%29%3B%0A%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20gl.deleteSync%28sync%29%3B%0A%20%20%20%20%20%20%20%20resolve%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20test%28%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20initialized%20%3D%20false%3B%0Avar%20wrappingToGL%3B%0Avar%20filterToGL%3B%0Avar%20compareToGL%3B%0Avar%20WebGLTextureUtils%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.gl%20%3D%20backend.gl%3B%0A%20%20%20%20this.extensions%20%3D%20backend.extensions%3B%0A%20%20%20%20this.defaultTextures%20%3D%20%7B%7D%3B%0A%20%20%20%20if%20%28initialized%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this._init%28this.gl%29%3B%0A%20%20%20%20%20%20initialized%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_init%28gl%29%20%7B%0A%20%20%20%20wrappingToGL%20%3D%20%7B%0A%20%20%20%20%20%20%5BRepeatWrapping2%5D%3A%20gl.REPEAT%2C%0A%20%20%20%20%20%20%5BClampToEdgeWrapping2%5D%3A%20gl.CLAMP_TO_EDGE%2C%0A%20%20%20%20%20%20%5BMirroredRepeatWrapping2%5D%3A%20gl.MIRRORED_REPEAT%0A%20%20%20%20%7D%3B%0A%20%20%20%20filterToGL%20%3D%20%7B%0A%20%20%20%20%20%20%5BNearestFilter2%5D%3A%20gl.NEAREST%2C%0A%20%20%20%20%20%20%5BNearestMipmapNearestFilter2%5D%3A%20gl.NEAREST_MIPMAP_NEAREST%2C%0A%20%20%20%20%20%20%5BNearestMipmapLinearFilter2%5D%3A%20gl.NEAREST_MIPMAP_LINEAR%2C%0A%20%20%20%20%20%20%5BLinearFilter2%5D%3A%20gl.LINEAR%2C%0A%20%20%20%20%20%20%5BLinearMipmapNearestFilter2%5D%3A%20gl.LINEAR_MIPMAP_NEAREST%2C%0A%20%20%20%20%20%20%5BLinearMipmapLinearFilter2%5D%3A%20gl.LINEAR_MIPMAP_LINEAR%0A%20%20%20%20%7D%3B%0A%20%20%20%20compareToGL%20%3D%20%7B%0A%20%20%20%20%20%20%5BNeverCompare2%5D%3A%20gl.NEVER%2C%0A%20%20%20%20%20%20%5BAlwaysCompare2%5D%3A%20gl.ALWAYS%2C%0A%20%20%20%20%20%20%5BLessCompare2%5D%3A%20gl.LESS%2C%0A%20%20%20%20%20%20%5BLessEqualCompare2%5D%3A%20gl.LEQUAL%2C%0A%20%20%20%20%20%20%5BEqualCompare2%5D%3A%20gl.EQUAL%2C%0A%20%20%20%20%20%20%5BGreaterEqualCompare2%5D%3A%20gl.GEQUAL%2C%0A%20%20%20%20%20%20%5BGreaterCompare2%5D%3A%20gl.GREATER%2C%0A%20%20%20%20%20%20%5BNotEqualCompare2%5D%3A%20gl.NOTEQUAL%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20filterFallback%28f%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28f%20%3D%3D%3D%20NearestFilter2%20%7C%7C%20f%20%3D%3D%3D%20NearestMipmapNearestFilter2%20%7C%7C%20f%20%3D%3D%3D%20NearestMipmapLinearFilter2%29%20%7B%0A%20%20%20%20%20%20return%20gl.NEAREST%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20gl.LINEAR%3B%0A%20%20%7D%0A%20%20getGLTextureType%28texture2%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20glTextureType%3B%0A%20%20%20%20if%20%28texture2.isCubeTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20glTextureType%20%3D%20gl.TEXTURE_CUBE_MAP%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isDataArrayTexture%20%3D%3D%3D%20true%20%7C%7C%20texture2.isCompressedArrayTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20glTextureType%20%3D%20gl.TEXTURE_2D_ARRAY%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isData3DTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20glTextureType%20%3D%20gl.TEXTURE_3D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20glTextureType%20%3D%20gl.TEXTURE_2D%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20glTextureType%3B%0A%20%20%7D%0A%20%20getInternalFormat%28internalFormatName%2C%20glFormat%2C%20glType%2C%20colorSpace%2C%20forceLinearTransfer%20%3D%20false%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20extensions%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28internalFormatName%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20if%20%28gl%5BinternalFormatName%5D%20%21%3D%3D%20void%200%29%20return%20gl%5BinternalFormatName%5D%3B%0A%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Attempt%20to%20use%20non-existing%20WebGL%20internal%20format%20%27%22%20%2B%20internalFormatName%20%2B%20%22%27%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20internalFormat%20%3D%20glFormat%3B%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RED%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.FLOAT%29%20internalFormat%20%3D%20gl.R32F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.HALF_FLOAT%29%20internalFormat%20%3D%20gl.R16F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20gl.R8%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20gl.R16%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20internalFormat%20%3D%20gl.R32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.BYTE%29%20internalFormat%20%3D%20gl.R8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.SHORT%29%20internalFormat%20%3D%20gl.R16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.INT%29%20internalFormat%20%3D%20gl.R32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RED_INTEGER%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20gl.R8UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20gl.R16UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20internalFormat%20%3D%20gl.R32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.BYTE%29%20internalFormat%20%3D%20gl.R8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.SHORT%29%20internalFormat%20%3D%20gl.R16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.INT%29%20internalFormat%20%3D%20gl.R32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RG%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.FLOAT%29%20internalFormat%20%3D%20gl.RG32F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.HALF_FLOAT%29%20internalFormat%20%3D%20gl.RG16F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20gl.RG8%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20gl.RG16%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20internalFormat%20%3D%20gl.RG32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.BYTE%29%20internalFormat%20%3D%20gl.RG8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.SHORT%29%20internalFormat%20%3D%20gl.RG16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.INT%29%20internalFormat%20%3D%20gl.RG32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RG_INTEGER%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20gl.RG8UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20gl.RG16UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20internalFormat%20%3D%20gl.RG32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.BYTE%29%20internalFormat%20%3D%20gl.RG8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.SHORT%29%20internalFormat%20%3D%20gl.RG16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.INT%29%20internalFormat%20%3D%20gl.RG32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RGB%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.FLOAT%29%20internalFormat%20%3D%20gl.RGB32F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.HALF_FLOAT%29%20internalFormat%20%3D%20gl.RGB16F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20gl.RGB8%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20gl.RGB16%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20internalFormat%20%3D%20gl.RGB32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.BYTE%29%20internalFormat%20%3D%20gl.RGB8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.SHORT%29%20internalFormat%20%3D%20gl.RGB16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.INT%29%20internalFormat%20%3D%20gl.RGB32I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%26%26%20forceLinearTransfer%20%3D%3D%3D%20false%20%3F%20gl.SRGB8%20%3A%20gl.RGB8%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_5_6_5%29%20internalFormat%20%3D%20gl.RGB565%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_5_5_5_1%29%20internalFormat%20%3D%20gl.RGB5_A1%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_4_4_4_4%29%20internalFormat%20%3D%20gl.RGB4%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT_5_9_9_9_REV%29%20internalFormat%20%3D%20gl.RGB9_E5%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RGB_INTEGER%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20gl.RGB8UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20gl.RGB16UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20internalFormat%20%3D%20gl.RGB32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.BYTE%29%20internalFormat%20%3D%20gl.RGB8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.SHORT%29%20internalFormat%20%3D%20gl.RGB16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.INT%29%20internalFormat%20%3D%20gl.RGB32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RGBA%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.FLOAT%29%20internalFormat%20%3D%20gl.RGBA32F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.HALF_FLOAT%29%20internalFormat%20%3D%20gl.RGBA16F%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20gl.RGBA8%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20gl.RGBA16%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20internalFormat%20%3D%20gl.RGBA32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.BYTE%29%20internalFormat%20%3D%20gl.RGBA8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.SHORT%29%20internalFormat%20%3D%20gl.RGBA16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.INT%29%20internalFormat%20%3D%20gl.RGBA32I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%26%26%20forceLinearTransfer%20%3D%3D%3D%20false%20%3F%20gl.SRGB8_ALPHA8%20%3A%20gl.RGBA8%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_4_4_4_4%29%20internalFormat%20%3D%20gl.RGBA4%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_5_5_5_1%29%20internalFormat%20%3D%20gl.RGB5_A1%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RGBA_INTEGER%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20internalFormat%20%3D%20gl.RGBA8UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%29%20internalFormat%20%3D%20gl.RGBA16UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20internalFormat%20%3D%20gl.RGBA32UI%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.BYTE%29%20internalFormat%20%3D%20gl.RGBA8I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.SHORT%29%20internalFormat%20%3D%20gl.RGBA16I%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.INT%29%20internalFormat%20%3D%20gl.RGBA32I%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.DEPTH_COMPONENT%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20internalFormat%20%3D%20gl.DEPTH24_STENCIL8%3B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.FLOAT%29%20internalFormat%20%3D%20gl.DEPTH_COMPONENT32F%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.DEPTH_STENCIL%29%20%7B%0A%20%20%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT_24_8%29%20internalFormat%20%3D%20gl.DEPTH24_STENCIL8%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28internalFormat%20%3D%3D%3D%20gl.R16F%20%7C%7C%20internalFormat%20%3D%3D%3D%20gl.R32F%20%7C%7C%20internalFormat%20%3D%3D%3D%20gl.RG16F%20%7C%7C%20internalFormat%20%3D%3D%3D%20gl.RG32F%20%7C%7C%20internalFormat%20%3D%3D%3D%20gl.RGBA16F%20%7C%7C%20internalFormat%20%3D%3D%3D%20gl.RGBA32F%29%20%7B%0A%20%20%20%20%20%20extensions.get%28%22EXT_color_buffer_float%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20internalFormat%3B%0A%20%20%7D%0A%20%20setTextureParameters%28textureType%2C%20texture2%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20extensions%2C%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_FLIP_Y_WEBGL%2C%20texture2.flipY%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL%2C%20texture2.premultiplyAlpha%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_ALIGNMENT%2C%20texture2.unpackAlignment%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_COLORSPACE_CONVERSION_WEBGL%2C%20gl.NONE%29%3B%0A%20%20%20%20gl.texParameteri%28textureType%2C%20gl.TEXTURE_WRAP_S%2C%20wrappingToGL%5Btexture2.wrapS%5D%29%3B%0A%20%20%20%20gl.texParameteri%28textureType%2C%20gl.TEXTURE_WRAP_T%2C%20wrappingToGL%5Btexture2.wrapT%5D%29%3B%0A%20%20%20%20if%20%28textureType%20%3D%3D%3D%20gl.TEXTURE_3D%20%7C%7C%20textureType%20%3D%3D%3D%20gl.TEXTURE_2D_ARRAY%29%20%7B%0A%20%20%20%20%20%20gl.texParameteri%28textureType%2C%20gl.TEXTURE_WRAP_R%2C%20wrappingToGL%5Btexture2.wrapR%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20gl.texParameteri%28textureType%2C%20gl.TEXTURE_MAG_FILTER%2C%20filterToGL%5Btexture2.magFilter%5D%29%3B%0A%20%20%20%20const%20hasMipmaps%20%3D%20texture2.mipmaps%20%21%3D%3D%20void%200%20%26%26%20texture2.mipmaps.length%20%3E%200%3B%0A%20%20%20%20const%20minFilter%20%3D%20texture2.minFilter%20%3D%3D%3D%20LinearFilter2%20%26%26%20hasMipmaps%20%3F%20LinearMipmapLinearFilter2%20%3A%20texture2.minFilter%3B%0A%20%20%20%20gl.texParameteri%28textureType%2C%20gl.TEXTURE_MIN_FILTER%2C%20filterToGL%5BminFilter%5D%29%3B%0A%20%20%20%20if%20%28texture2.compareFunction%29%20%7B%0A%20%20%20%20%20%20gl.texParameteri%28textureType%2C%20gl.TEXTURE_COMPARE_MODE%2C%20gl.COMPARE_REF_TO_TEXTURE%29%3B%0A%20%20%20%20%20%20gl.texParameteri%28textureType%2C%20gl.TEXTURE_COMPARE_FUNC%2C%20compareToGL%5Btexture2.compareFunction%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28extensions.has%28%22EXT_texture_filter_anisotropic%22%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20if%20%28texture2.magFilter%20%3D%3D%3D%20NearestFilter2%29%20return%3B%0A%20%20%20%20%20%20if%20%28texture2.minFilter%20%21%3D%3D%20NearestMipmapLinearFilter2%20%26%26%20texture2.minFilter%20%21%3D%3D%20LinearMipmapLinearFilter2%29%20return%3B%0A%20%20%20%20%20%20if%20%28texture2.type%20%3D%3D%3D%20FloatType2%20%26%26%20extensions.has%28%22OES_texture_float_linear%22%29%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20if%20%28texture2.anisotropy%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20const%20extension%20%3D%20extensions.get%28%22EXT_texture_filter_anisotropic%22%29%3B%0A%20%20%20%20%20%20%20%20gl.texParameterf%28textureType%2C%20extension.TEXTURE_MAX_ANISOTROPY_EXT%2C%20Math.min%28texture2.anisotropy%2C%20backend.getMaxAnisotropy%28%29%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20createDefaultTexture%28texture2%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20backend%2C%20defaultTextures%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20glTextureType%20%3D%20this.getGLTextureType%28texture2%29%3B%0A%20%20%20%20let%20textureGPU%20%3D%20defaultTextures%5BglTextureType%5D%3B%0A%20%20%20%20if%20%28textureGPU%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20textureGPU%20%3D%20gl.createTexture%28%29%3B%0A%20%20%20%20%20%20backend.state.bindTexture%28glTextureType%2C%20textureGPU%29%3B%0A%20%20%20%20%20%20gl.texParameteri%28glTextureType%2C%20gl.TEXTURE_MIN_FILTER%2C%20gl.NEAREST%29%3B%0A%20%20%20%20%20%20gl.texParameteri%28glTextureType%2C%20gl.TEXTURE_MAG_FILTER%2C%20gl.NEAREST%29%3B%0A%20%20%20%20%20%20defaultTextures%5BglTextureType%5D%20%3D%20textureGPU%3B%0A%20%20%20%20%7D%0A%20%20%20%20backend.set%28texture2%2C%20%7B%0A%20%20%20%20%20%20textureGPU%2C%0A%20%20%20%20%20%20glTextureType%2C%0A%20%20%20%20%20%20isDefault%3A%20true%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20createTexture%28texture2%2C%20options%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20levels%2C%20width%2C%20height%2C%20depth%3A%20depth2%20%7D%20%3D%20options%3B%0A%20%20%20%20const%20glFormat%20%3D%20backend.utils.convert%28texture2.format%2C%20texture2.colorSpace%29%3B%0A%20%20%20%20const%20glType%20%3D%20backend.utils.convert%28texture2.type%29%3B%0A%20%20%20%20const%20glInternalFormat%20%3D%20this.getInternalFormat%28texture2.internalFormat%2C%20glFormat%2C%20glType%2C%20texture2.colorSpace%2C%20texture2.isVideoTexture%29%3B%0A%20%20%20%20const%20textureGPU%20%3D%20gl.createTexture%28%29%3B%0A%20%20%20%20const%20glTextureType%20%3D%20this.getGLTextureType%28texture2%29%3B%0A%20%20%20%20backend.state.bindTexture%28glTextureType%2C%20textureGPU%29%3B%0A%20%20%20%20this.setTextureParameters%28glTextureType%2C%20texture2%29%3B%0A%20%20%20%20if%20%28texture2.isDataArrayTexture%20%7C%7C%20texture2.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20gl.texStorage3D%28gl.TEXTURE_2D_ARRAY%2C%20levels%2C%20glInternalFormat%2C%20width%2C%20height%2C%20depth2%29%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isData3DTexture%29%20%7B%0A%20%20%20%20%20%20gl.texStorage3D%28gl.TEXTURE_3D%2C%20levels%2C%20glInternalFormat%2C%20width%2C%20height%2C%20depth2%29%3B%0A%20%20%20%20%7D%20else%20if%20%28%21texture2.isVideoTexture%29%20%7B%0A%20%20%20%20%20%20gl.texStorage2D%28glTextureType%2C%20levels%2C%20glInternalFormat%2C%20width%2C%20height%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20backend.set%28texture2%2C%20%7B%0A%20%20%20%20%20%20textureGPU%2C%0A%20%20%20%20%20%20glTextureType%2C%0A%20%20%20%20%20%20glFormat%2C%0A%20%20%20%20%20%20glType%2C%0A%20%20%20%20%20%20glInternalFormat%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20copyBufferToTexture%28buffer2%2C%20texture2%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20textureGPU%2C%20glTextureType%2C%20glFormat%2C%20glType%20%7D%20%3D%20backend.get%28texture2%29%3B%0A%20%20%20%20const%20%7B%20width%2C%20height%20%7D%20%3D%20texture2.source.data%3B%0A%20%20%20%20gl.bindBuffer%28gl.PIXEL_UNPACK_BUFFER%2C%20buffer2%29%3B%0A%20%20%20%20backend.state.bindTexture%28glTextureType%2C%20textureGPU%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_FLIP_Y_WEBGL%2C%20false%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL%2C%20false%29%3B%0A%20%20%20%20gl.texSubImage2D%28glTextureType%2C%200%2C%200%2C%200%2C%20width%2C%20height%2C%20glFormat%2C%20glType%2C%200%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.PIXEL_UNPACK_BUFFER%2C%20null%29%3B%0A%20%20%20%20backend.state.unbindTexture%28%29%3B%0A%20%20%7D%0A%20%20updateTexture%28texture2%2C%20options%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20width%2C%20height%20%7D%20%3D%20options%3B%0A%20%20%20%20const%20%7B%20textureGPU%2C%20glTextureType%2C%20glFormat%2C%20glType%2C%20glInternalFormat%20%7D%20%3D%20this.backend.get%28texture2%29%3B%0A%20%20%20%20if%20%28texture2.isRenderTargetTexture%20%7C%7C%20textureGPU%20%3D%3D%3D%20void%200%29%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20const%20getImage%20%3D%20%28source%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20if%20%28source.isDataTexture%29%20%7B%0A%20%20%20%20%20%20%20%20return%20source.image.data%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28source%20instanceof%20ImageBitmap%20%7C%7C%20source%20instanceof%20OffscreenCanvas%20%7C%7C%20source%20instanceof%20HTMLImageElement%20%7C%7C%20source%20instanceof%20HTMLCanvasElement%29%20%7B%0A%20%20%20%20%20%20%20%20return%20source%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20source.data%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.backend.state.bindTexture%28glTextureType%2C%20textureGPU%29%3B%0A%20%20%20%20this.setTextureParameters%28glTextureType%2C%20texture2%29%3B%0A%20%20%20%20if%20%28texture2.isCompressedTexture%29%20%7B%0A%20%20%20%20%20%20const%20mipmaps%20%3D%20texture2.mipmaps%3B%0A%20%20%20%20%20%20const%20image%20%3D%20options.image%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20mipmaps.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20mipmap%20%3D%20mipmaps%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28texture2.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28texture2.format%20%21%3D%3D%20gl.RGBA%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28glFormat%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20gl.compressedTexSubImage3D%28gl.TEXTURE_2D_ARRAY%2C%20i%2C%200%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20image.depth%2C%20glFormat%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLRenderer%3A%20Attempt%20to%20load%20unsupported%20compressed%20texture%20format%20in%20.uploadTexture%28%29%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.texSubImage3D%28gl.TEXTURE_2D_ARRAY%2C%20i%2C%200%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20image.depth%2C%20glFormat%2C%20glType%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28glFormat%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.compressedTexSubImage2D%28gl.TEXTURE_2D%2C%20i%2C%200%2C%200%2C%20mipmap.width%2C%20mipmap.height%2C%20glFormat%2C%20mipmap.data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.warn%28%22Unsupported%20compressed%20texture%20format%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28texture2.isCubeTexture%29%20%7B%0A%20%20%20%20%20%20const%20images%20%3D%20options.images%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20image%20%3D%20getImage%28images%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20gl.texSubImage2D%28gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20i%2C%200%2C%200%2C%200%2C%20width%2C%20height%2C%20glFormat%2C%20glType%2C%20image%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28texture2.isDataArrayTexture%29%20%7B%0A%20%20%20%20%20%20const%20image%20%3D%20options.image%3B%0A%20%20%20%20%20%20gl.texSubImage3D%28gl.TEXTURE_2D_ARRAY%2C%200%2C%200%2C%200%2C%200%2C%20image.width%2C%20image.height%2C%20image.depth%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isData3DTexture%29%20%7B%0A%20%20%20%20%20%20const%20image%20%3D%20options.image%3B%0A%20%20%20%20%20%20gl.texSubImage3D%28gl.TEXTURE_3D%2C%200%2C%200%2C%200%2C%200%2C%20image.width%2C%20image.height%2C%20image.depth%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isVideoTexture%29%20%7B%0A%20%20%20%20%20%20texture2.update%28%29%3B%0A%20%20%20%20%20%20gl.texImage2D%28glTextureType%2C%200%2C%20glInternalFormat%2C%20glFormat%2C%20glType%2C%20options.image%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20image%20%3D%20getImage%28options.image%29%3B%0A%20%20%20%20%20%20gl.texSubImage2D%28glTextureType%2C%200%2C%200%2C%200%2C%20width%2C%20height%2C%20glFormat%2C%20glType%2C%20image%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generateMipmaps%28texture2%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20textureGPU%2C%20glTextureType%20%7D%20%3D%20backend.get%28texture2%29%3B%0A%20%20%20%20backend.state.bindTexture%28glTextureType%2C%20textureGPU%29%3B%0A%20%20%20%20gl.generateMipmap%28glTextureType%29%3B%0A%20%20%7D%0A%20%20deallocateRenderBuffers%28renderTarget%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28renderTarget%29%20%7B%0A%20%20%20%20%20%20const%20renderContextData%20%3D%20backend.get%28renderTarget%29%3B%0A%20%20%20%20%20%20renderContextData.renderBufferStorageSetup%20%3D%20void%200%3B%0A%20%20%20%20%20%20if%20%28renderContextData.framebuffers%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28const%20cacheKey%20in%20renderContextData.framebuffers%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.deleteFramebuffer%28renderContextData.framebuffers%5BcacheKey%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20delete%20renderContextData.framebuffers%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderContextData.depthRenderbuffer%29%20%7B%0A%20%20%20%20%20%20%20%20gl.deleteRenderbuffer%28renderContextData.depthRenderbuffer%29%3B%0A%20%20%20%20%20%20%20%20delete%20renderContextData.depthRenderbuffer%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderContextData.stencilRenderbuffer%29%20%7B%0A%20%20%20%20%20%20%20%20gl.deleteRenderbuffer%28renderContextData.stencilRenderbuffer%29%3B%0A%20%20%20%20%20%20%20%20delete%20renderContextData.stencilRenderbuffer%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderContextData.msaaFrameBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20gl.deleteFramebuffer%28renderContextData.msaaFrameBuffer%29%3B%0A%20%20%20%20%20%20%20%20delete%20renderContextData.msaaFrameBuffer%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderContextData.msaaRenderbuffers%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20renderContextData.msaaRenderbuffers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.deleteRenderbuffer%28renderContextData.msaaRenderbuffers%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20delete%20renderContextData.msaaRenderbuffers%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20destroyTexture%28texture2%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20textureGPU%2C%20renderTarget%20%7D%20%3D%20backend.get%28texture2%29%3B%0A%20%20%20%20this.deallocateRenderBuffers%28renderTarget%29%3B%0A%20%20%20%20gl.deleteTexture%28textureGPU%29%3B%0A%20%20%20%20backend.delete%28texture2%29%3B%0A%20%20%7D%0A%20%20copyTextureToTexture%28srcTexture%2C%20dstTexture%2C%20srcRegion%20%3D%20null%2C%20dstPosition%20%3D%20null%2C%20level%20%3D%200%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20backend%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20state%20%7D%20%3D%20this.backend%3B%0A%20%20%20%20const%20%7B%20textureGPU%3A%20dstTextureGPU%2C%20glTextureType%2C%20glType%2C%20glFormat%20%7D%20%3D%20backend.get%28dstTexture%29%3B%0A%20%20%20%20let%20width%2C%20height%2C%20minX%2C%20minY%3B%0A%20%20%20%20let%20dstX%2C%20dstY%3B%0A%20%20%20%20if%20%28srcRegion%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20width%20%3D%20srcRegion.max.x%20-%20srcRegion.min.x%3B%0A%20%20%20%20%20%20height%20%3D%20srcRegion.max.y%20-%20srcRegion.min.y%3B%0A%20%20%20%20%20%20minX%20%3D%20srcRegion.min.x%3B%0A%20%20%20%20%20%20minY%20%3D%20srcRegion.min.y%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20width%20%3D%20srcTexture.image.width%3B%0A%20%20%20%20%20%20height%20%3D%20srcTexture.image.height%3B%0A%20%20%20%20%20%20minX%20%3D%200%3B%0A%20%20%20%20%20%20minY%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28dstPosition%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20dstX%20%3D%20dstPosition.x%3B%0A%20%20%20%20%20%20dstY%20%3D%20dstPosition.y%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20dstX%20%3D%200%3B%0A%20%20%20%20%20%20dstY%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.bindTexture%28glTextureType%2C%20dstTextureGPU%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_ALIGNMENT%2C%20dstTexture.unpackAlignment%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_FLIP_Y_WEBGL%2C%20dstTexture.flipY%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL%2C%20dstTexture.premultiplyAlpha%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_ALIGNMENT%2C%20dstTexture.unpackAlignment%29%3B%0A%20%20%20%20const%20currentUnpackRowLen%20%3D%20gl.getParameter%28gl.UNPACK_ROW_LENGTH%29%3B%0A%20%20%20%20const%20currentUnpackImageHeight%20%3D%20gl.getParameter%28gl.UNPACK_IMAGE_HEIGHT%29%3B%0A%20%20%20%20const%20currentUnpackSkipPixels%20%3D%20gl.getParameter%28gl.UNPACK_SKIP_PIXELS%29%3B%0A%20%20%20%20const%20currentUnpackSkipRows%20%3D%20gl.getParameter%28gl.UNPACK_SKIP_ROWS%29%3B%0A%20%20%20%20const%20currentUnpackSkipImages%20%3D%20gl.getParameter%28gl.UNPACK_SKIP_IMAGES%29%3B%0A%20%20%20%20const%20image%20%3D%20srcTexture.isCompressedTexture%20%3F%20srcTexture.mipmaps%5Blevel%5D%20%3A%20srcTexture.image%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_ROW_LENGTH%2C%20image.width%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_IMAGE_HEIGHT%2C%20image.height%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_SKIP_PIXELS%2C%20minX%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_SKIP_ROWS%2C%20minY%29%3B%0A%20%20%20%20if%20%28srcTexture.isRenderTargetTexture%20%7C%7C%20srcTexture.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20const%20srcTextureData%20%3D%20backend.get%28srcTexture%29%3B%0A%20%20%20%20%20%20const%20dstTextureData%20%3D%20backend.get%28dstTexture%29%3B%0A%20%20%20%20%20%20const%20srcRenderContextData%20%3D%20backend.get%28srcTextureData.renderTarget%29%3B%0A%20%20%20%20%20%20const%20dstRenderContextData%20%3D%20backend.get%28dstTextureData.renderTarget%29%3B%0A%20%20%20%20%20%20const%20srcFramebuffer%20%3D%20srcRenderContextData.framebuffers%5BsrcTextureData.cacheKey%5D%3B%0A%20%20%20%20%20%20const%20dstFramebuffer%20%3D%20dstRenderContextData.framebuffers%5BdstTextureData.cacheKey%5D%3B%0A%20%20%20%20%20%20state.bindFramebuffer%28gl.READ_FRAMEBUFFER%2C%20srcFramebuffer%29%3B%0A%20%20%20%20%20%20state.bindFramebuffer%28gl.DRAW_FRAMEBUFFER%2C%20dstFramebuffer%29%3B%0A%20%20%20%20%20%20let%20mask%20%3D%20gl.COLOR_BUFFER_BIT%3B%0A%20%20%20%20%20%20if%20%28srcTexture.isDepthTexture%29%20mask%20%3D%20gl.DEPTH_BUFFER_BIT%3B%0A%20%20%20%20%20%20gl.blitFramebuffer%28minX%2C%20minY%2C%20width%2C%20height%2C%20dstX%2C%20dstY%2C%20width%2C%20height%2C%20mask%2C%20gl.NEAREST%29%3B%0A%20%20%20%20%20%20state.bindFramebuffer%28gl.READ_FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20%20%20state.bindFramebuffer%28gl.DRAW_FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28srcTexture.isDataTexture%29%20%7B%0A%20%20%20%20%20%20%20%20gl.texSubImage2D%28gl.TEXTURE_2D%2C%20level%2C%20dstX%2C%20dstY%2C%20width%2C%20height%2C%20glFormat%2C%20glType%2C%20image.data%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28srcTexture.isCompressedTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.compressedTexSubImage2D%28gl.TEXTURE_2D%2C%20level%2C%20dstX%2C%20dstY%2C%20image.width%2C%20image.height%2C%20glFormat%2C%20image.data%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.texSubImage2D%28gl.TEXTURE_2D%2C%20level%2C%20dstX%2C%20dstY%2C%20width%2C%20height%2C%20glFormat%2C%20glType%2C%20image%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_ROW_LENGTH%2C%20currentUnpackRowLen%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_IMAGE_HEIGHT%2C%20currentUnpackImageHeight%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_SKIP_PIXELS%2C%20currentUnpackSkipPixels%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_SKIP_ROWS%2C%20currentUnpackSkipRows%29%3B%0A%20%20%20%20gl.pixelStorei%28gl.UNPACK_SKIP_IMAGES%2C%20currentUnpackSkipImages%29%3B%0A%20%20%20%20if%20%28level%20%3D%3D%3D%200%20%26%26%20dstTexture.generateMipmaps%29%20gl.generateMipmap%28gl.TEXTURE_2D%29%3B%0A%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%7D%0A%20%20copyFramebufferToTexture%28texture2%2C%20renderContext%2C%20rectangle%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20state%20%7D%20%3D%20this.backend%3B%0A%20%20%20%20const%20%7B%20textureGPU%20%7D%20%3D%20this.backend.get%28texture2%29%3B%0A%20%20%20%20const%20%7B%20x%3A%20x2%2C%20y%3A%20y2%2C%20z%3A%20width%2C%20w%3A%20height%20%7D%20%3D%20rectangle%3B%0A%20%20%20%20const%20requireDrawFrameBuffer%20%3D%20texture2.isDepthTexture%20%3D%3D%3D%20true%20%7C%7C%20renderContext.renderTarget%20%26%26%20renderContext.renderTarget.samples%20%3E%200%3B%0A%20%20%20%20const%20srcHeight%20%3D%20renderContext.renderTarget%20%3F%20renderContext.renderTarget.height%20%3A%20this.backend.gerDrawingBufferSize%28%29.y%3B%0A%20%20%20%20if%20%28requireDrawFrameBuffer%29%20%7B%0A%20%20%20%20%20%20const%20partial%20%3D%20x2%20%21%3D%3D%200%20%7C%7C%20y2%20%21%3D%3D%200%3B%0A%20%20%20%20%20%20let%20mask%3B%0A%20%20%20%20%20%20let%20attachment%3B%0A%20%20%20%20%20%20if%20%28texture2.isDepthTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20mask%20%3D%20gl.DEPTH_BUFFER_BIT%3B%0A%20%20%20%20%20%20%20%20attachment%20%3D%20gl.DEPTH_ATTACHMENT%3B%0A%20%20%20%20%20%20%20%20if%20%28renderContext.stencil%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20mask%20%7C%3D%20gl.STENCIL_BUFFER_BIT%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20mask%20%3D%20gl.COLOR_BUFFER_BIT%3B%0A%20%20%20%20%20%20%20%20attachment%20%3D%20gl.COLOR_ATTACHMENT0%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28partial%29%20%7B%0A%20%20%20%20%20%20%20%20const%20renderTargetContextData%20%3D%20this.backend.get%28renderContext.renderTarget%29%3B%0A%20%20%20%20%20%20%20%20const%20fb%20%3D%20renderTargetContextData.framebuffers%5BrenderContext.getCacheKey%28%29%5D%3B%0A%20%20%20%20%20%20%20%20const%20msaaFrameBuffer%20%3D%20renderTargetContextData.msaaFrameBuffer%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28gl.DRAW_FRAMEBUFFER%2C%20fb%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28gl.READ_FRAMEBUFFER%2C%20msaaFrameBuffer%29%3B%0A%20%20%20%20%20%20%20%20const%20flippedY%20%3D%20srcHeight%20-%20y2%20-%20height%3B%0A%20%20%20%20%20%20%20%20gl.blitFramebuffer%28x2%2C%20flippedY%2C%20x2%20%2B%20width%2C%20flippedY%20%2B%20height%2C%20x2%2C%20flippedY%2C%20x2%20%2B%20width%2C%20flippedY%20%2B%20height%2C%20mask%2C%20gl.NEAREST%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28gl.READ_FRAMEBUFFER%2C%20fb%29%3B%0A%20%20%20%20%20%20%20%20state.bindTexture%28gl.TEXTURE_2D%2C%20textureGPU%29%3B%0A%20%20%20%20%20%20%20%20gl.copyTexSubImage2D%28gl.TEXTURE_2D%2C%200%2C%200%2C%200%2C%20x2%2C%20flippedY%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20fb%20%3D%20gl.createFramebuffer%28%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28gl.DRAW_FRAMEBUFFER%2C%20fb%29%3B%0A%20%20%20%20%20%20%20%20gl.framebufferTexture2D%28gl.DRAW_FRAMEBUFFER%2C%20attachment%2C%20gl.TEXTURE_2D%2C%20textureGPU%2C%200%29%3B%0A%20%20%20%20%20%20%20%20gl.blitFramebuffer%280%2C%200%2C%20width%2C%20height%2C%200%2C%200%2C%20width%2C%20height%2C%20mask%2C%20gl.NEAREST%29%3B%0A%20%20%20%20%20%20%20%20gl.deleteFramebuffer%28fb%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20state.bindTexture%28gl.TEXTURE_2D%2C%20textureGPU%29%3B%0A%20%20%20%20%20%20gl.copyTexSubImage2D%28gl.TEXTURE_2D%2C%200%2C%200%2C%200%2C%20x2%2C%20srcHeight%20-%20height%20-%20y2%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20state.unbindTexture%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28texture2.generateMipmaps%29%20this.generateMipmaps%28texture2%29%3B%0A%20%20%20%20this.backend._setFramebuffer%28renderContext%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20Setup%20storage%20for%20internal%20depth%2Fstencil%20buffers%20and%20bind%20to%20correct%20framebuffer%0A%20%20setupRenderBufferStorage%28renderbuffer%2C%20renderContext%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20renderTarget%20%3D%20renderContext.renderTarget%3B%0A%20%20%20%20const%20%7B%20samples%2C%20depthTexture%2C%20depthBuffer%2C%20stencilBuffer%2C%20width%2C%20height%20%7D%20%3D%20renderTarget%3B%0A%20%20%20%20gl.bindRenderbuffer%28gl.RENDERBUFFER%2C%20renderbuffer%29%3B%0A%20%20%20%20if%20%28depthBuffer%20%26%26%20%21stencilBuffer%29%20%7B%0A%20%20%20%20%20%20let%20glInternalFormat%20%3D%20gl.DEPTH_COMPONENT24%3B%0A%20%20%20%20%20%20if%20%28samples%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28depthTexture%20%26%26%20depthTexture.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28depthTexture.type%20%3D%3D%3D%20gl.FLOAT%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20glInternalFormat%20%3D%20gl.DEPTH_COMPONENT32F%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20gl.renderbufferStorageMultisample%28gl.RENDERBUFFER%2C%20samples%2C%20glInternalFormat%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20gl.renderbufferStorage%28gl.RENDERBUFFER%2C%20glInternalFormat%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20gl.framebufferRenderbuffer%28gl.FRAMEBUFFER%2C%20gl.DEPTH_ATTACHMENT%2C%20gl.RENDERBUFFER%2C%20renderbuffer%29%3B%0A%20%20%20%20%7D%20else%20if%20%28depthBuffer%20%26%26%20stencilBuffer%29%20%7B%0A%20%20%20%20%20%20if%20%28samples%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20gl.renderbufferStorageMultisample%28gl.RENDERBUFFER%2C%20samples%2C%20gl.DEPTH24_STENCIL8%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20gl.renderbufferStorage%28gl.RENDERBUFFER%2C%20gl.DEPTH_STENCIL%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20gl.framebufferRenderbuffer%28gl.FRAMEBUFFER%2C%20gl.DEPTH_STENCIL_ATTACHMENT%2C%20gl.RENDERBUFFER%2C%20renderbuffer%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20async%20copyTextureToBuffer%28texture2%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20faceIndex%29%20%7B%0A%20%20%20%20const%20%7B%20backend%2C%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20%7B%20textureGPU%2C%20glFormat%2C%20glType%20%7D%20%3D%20this.backend.get%28texture2%29%3B%0A%20%20%20%20const%20fb%20%3D%20gl.createFramebuffer%28%29%3B%0A%20%20%20%20gl.bindFramebuffer%28gl.READ_FRAMEBUFFER%2C%20fb%29%3B%0A%20%20%20%20const%20target%20%3D%20texture2.isCubeTexture%20%3F%20gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20faceIndex%20%3A%20gl.TEXTURE_2D%3B%0A%20%20%20%20gl.framebufferTexture2D%28gl.READ_FRAMEBUFFER%2C%20gl.COLOR_ATTACHMENT0%2C%20target%2C%20textureGPU%2C%200%29%3B%0A%20%20%20%20const%20typedArrayType%20%3D%20this._getTypedArrayType%28glType%29%3B%0A%20%20%20%20const%20bytesPerTexel%20%3D%20this._getBytesPerTexel%28glType%2C%20glFormat%29%3B%0A%20%20%20%20const%20elementCount%20%3D%20width%20%2A%20height%3B%0A%20%20%20%20const%20byteLength%20%3D%20elementCount%20%2A%20bytesPerTexel%3B%0A%20%20%20%20const%20buffer2%20%3D%20gl.createBuffer%28%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.PIXEL_PACK_BUFFER%2C%20buffer2%29%3B%0A%20%20%20%20gl.bufferData%28gl.PIXEL_PACK_BUFFER%2C%20byteLength%2C%20gl.STREAM_READ%29%3B%0A%20%20%20%20gl.readPixels%28x2%2C%20y2%2C%20width%2C%20height%2C%20glFormat%2C%20glType%2C%200%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.PIXEL_PACK_BUFFER%2C%20null%29%3B%0A%20%20%20%20await%20backend.utils._clientWaitAsync%28%29%3B%0A%20%20%20%20const%20dstBuffer%20%3D%20new%20typedArrayType%28byteLength%20%2F%20typedArrayType.BYTES_PER_ELEMENT%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.PIXEL_PACK_BUFFER%2C%20buffer2%29%3B%0A%20%20%20%20gl.getBufferSubData%28gl.PIXEL_PACK_BUFFER%2C%200%2C%20dstBuffer%29%3B%0A%20%20%20%20gl.bindBuffer%28gl.PIXEL_PACK_BUFFER%2C%20null%29%3B%0A%20%20%20%20gl.deleteFramebuffer%28fb%29%3B%0A%20%20%20%20return%20dstBuffer%3B%0A%20%20%7D%0A%20%20_getTypedArrayType%28glType%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20return%20Uint8Array%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_4_4_4_4%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_5_5_5_1%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_5_6_5%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%29%20return%20Uint32Array%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.HALF_FLOAT%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.FLOAT%29%20return%20Float32Array%3B%0A%20%20%20%20throw%20new%20Error%28%60Unsupported%20WebGL%20type%3A%20%24%7BglType%7D%60%29%3B%0A%20%20%7D%0A%20%20_getBytesPerTexel%28glType%2C%20glFormat%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20bytesPerComponent%20%3D%200%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_BYTE%29%20bytesPerComponent%20%3D%201%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_4_4_4_4%20%7C%7C%20glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_5_5_5_1%20%7C%7C%20glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT_5_6_5%20%7C%7C%20glType%20%3D%3D%3D%20gl.UNSIGNED_SHORT%20%7C%7C%20glType%20%3D%3D%3D%20gl.HALF_FLOAT%29%20bytesPerComponent%20%3D%202%3B%0A%20%20%20%20if%20%28glType%20%3D%3D%3D%20gl.UNSIGNED_INT%20%7C%7C%20glType%20%3D%3D%3D%20gl.FLOAT%29%20bytesPerComponent%20%3D%204%3B%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RGBA%29%20return%20bytesPerComponent%20%2A%204%3B%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.RGB%29%20return%20bytesPerComponent%20%2A%203%3B%0A%20%20%20%20if%20%28glFormat%20%3D%3D%3D%20gl.ALPHA%29%20return%20bytesPerComponent%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGLExtensions2%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.gl%20%3D%20this.backend.gl%3B%0A%20%20%20%20this.availableExtensions%20%3D%20this.gl.getSupportedExtensions%28%29%3B%0A%20%20%20%20this.extensions%20%3D%20%7B%7D%3B%0A%20%20%7D%0A%20%20get%28name%29%20%7B%0A%20%20%20%20let%20extension%20%3D%20this.extensions%5Bname%5D%3B%0A%20%20%20%20if%20%28extension%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20extension%20%3D%20this.gl.getExtension%28name%29%3B%0A%20%20%20%20%20%20this.extensions%5Bname%5D%20%3D%20extension%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20extension%3B%0A%20%20%7D%0A%20%20has%28name%29%20%7B%0A%20%20%20%20return%20this.availableExtensions.includes%28name%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGLCapabilities2%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.maxAnisotropy%20%3D%20null%3B%0A%20%20%7D%0A%20%20getMaxAnisotropy%28%29%20%7B%0A%20%20%20%20if%20%28this.maxAnisotropy%20%21%3D%3D%20null%29%20return%20this.maxAnisotropy%3B%0A%20%20%20%20const%20gl%20%3D%20this.backend.gl%3B%0A%20%20%20%20const%20extensions%20%3D%20this.backend.extensions%3B%0A%20%20%20%20if%20%28extensions.has%28%22EXT_texture_filter_anisotropic%22%29%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20extension%20%3D%20extensions.get%28%22EXT_texture_filter_anisotropic%22%29%3B%0A%20%20%20%20%20%20this.maxAnisotropy%20%3D%20gl.getParameter%28extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.maxAnisotropy%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.maxAnisotropy%3B%0A%20%20%7D%0A%7D%3B%0Avar%20GLFeatureName%20%3D%20%7B%0A%20%20%22WEBGL_multi_draw%22%3A%20%22WEBGL_multi_draw%22%2C%0A%20%20%22WEBGL_compressed_texture_astc%22%3A%20%22texture-compression-astc%22%2C%0A%20%20%22WEBGL_compressed_texture_etc%22%3A%20%22texture-compression-etc2%22%2C%0A%20%20%22WEBGL_compressed_texture_etc1%22%3A%20%22texture-compression-etc1%22%2C%0A%20%20%22WEBGL_compressed_texture_pvrtc%22%3A%20%22texture-compression-pvrtc%22%2C%0A%20%20%22WEBKIT_WEBGL_compressed_texture_pvrtc%22%3A%20%22texture-compression-pvrtc%22%2C%0A%20%20%22WEBGL_compressed_texture_s3tc%22%3A%20%22texture-compression-bc%22%2C%0A%20%20%22EXT_texture_compression_bptc%22%3A%20%22texture-compression-bptc%22%2C%0A%20%20%22EXT_disjoint_timer_query_webgl2%22%3A%20%22timestamp-query%22%0A%7D%3B%0Avar%20WebGLBufferRenderer2%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.gl%20%3D%20backend.gl%3B%0A%20%20%20%20this.extensions%20%3D%20backend.extensions%3B%0A%20%20%20%20this.info%20%3D%20backend.renderer.info%3B%0A%20%20%20%20this.mode%20%3D%20null%3B%0A%20%20%20%20this.index%20%3D%200%3B%0A%20%20%20%20this.type%20%3D%20null%3B%0A%20%20%20%20this.object%20%3D%20null%3B%0A%20%20%7D%0A%20%20render%28start%2C%20count%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20mode%2C%20object%2C%20type%2C%20info%2C%20index%3A%20index5%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20gl.drawElements%28mode%2C%20count%2C%20type%2C%20start%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20gl.drawArrays%28mode%2C%20start%2C%20count%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20info.update%28object%2C%20count%2C%20mode%2C%201%29%3B%0A%20%20%7D%0A%20%20renderInstances%28start%2C%20count%2C%20primcount%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20mode%2C%20type%2C%20index%3A%20index5%2C%20object%2C%20info%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28primcount%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20gl.drawElementsInstanced%28mode%2C%20count%2C%20type%2C%20start%2C%20primcount%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20gl.drawArraysInstanced%28mode%2C%20start%2C%20count%2C%20primcount%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20info.update%28object%2C%20count%2C%20mode%2C%20primcount%29%3B%0A%20%20%7D%0A%20%20renderMultiDraw%28starts%2C%20counts%2C%20drawCount%29%20%7B%0A%20%20%20%20const%20%7B%20extensions%2C%20mode%2C%20object%2C%20info%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28drawCount%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20const%20extension%20%3D%20extensions.get%28%22WEBGL_multi_draw%22%29%3B%0A%20%20%20%20if%20%28extension%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this.render%28starts%5Bi%5D%2C%20counts%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28this.index%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20extension.multiDrawElementsWEBGL%28mode%2C%20counts%2C%200%2C%20this.type%2C%20starts%2C%200%2C%20drawCount%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20extension.multiDrawArraysWEBGL%28mode%2C%20starts%2C%200%2C%20counts%2C%200%2C%20drawCount%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20elementCount%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20elementCount%20%2B%3D%20counts%5Bi%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20info.update%28object%2C%20elementCount%2C%20mode%2C%201%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20renderMultiDrawInstances%28starts%2C%20counts%2C%20drawCount%2C%20primcount%29%20%7B%0A%20%20%20%20const%20%7B%20extensions%2C%20mode%2C%20object%2C%20info%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28drawCount%20%3D%3D%3D%200%29%20return%3B%0A%20%20%20%20const%20extension%20%3D%20extensions.get%28%22WEBGL_multi_draw%22%29%3B%0A%20%20%20%20if%20%28extension%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this.renderInstances%28starts%5Bi%5D%2C%20counts%5Bi%5D%2C%20primcount%5Bi%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28this.index%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20extension.multiDrawElementsInstancedWEBGL%28mode%2C%20counts%2C%200%2C%20this.type%2C%20starts%2C%200%2C%20primcount%2C%200%2C%20drawCount%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20extension.multiDrawArraysInstancedWEBGL%28mode%2C%20starts%2C%200%2C%20counts%2C%200%2C%20primcount%2C%200%2C%20drawCount%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20let%20elementCount%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20elementCount%20%2B%3D%20counts%5Bi%5D%20%2A%20primcount%5Bi%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20info.update%28object%2C%20elementCount%2C%20mode%2C%201%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2F%0A%7D%3B%0Avar%20WebGLBackend%20%3D%20class%20extends%20Backend%20%7B%0A%20%20constructor%28parameters%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28parameters%29%3B%0A%20%20%20%20this.isWebGLBackend%20%3D%20true%3B%0A%20%20%7D%0A%20%20init%28renderer3%29%20%7B%0A%20%20%20%20super.init%28renderer3%29%3B%0A%20%20%20%20const%20parameters%20%3D%20this.parameters%3B%0A%20%20%20%20const%20glContext%20%3D%20parameters.context%20%21%3D%3D%20void%200%20%3F%20parameters.context%20%3A%20renderer3.domElement.getContext%28%22webgl2%22%29%3B%0A%20%20%20%20function%20onContextLost%28event%29%20%7B%0A%20%20%20%20%20%20event.preventDefault%28%29%3B%0A%20%20%20%20%20%20const%20contextLossInfo%20%3D%20%7B%0A%20%20%20%20%20%20%20%20api%3A%20%22WebGL%22%2C%0A%20%20%20%20%20%20%20%20message%3A%20event.statusMessage%20%7C%7C%20%22Unknown%20reason%22%2C%0A%20%20%20%20%20%20%20%20reason%3A%20null%2C%0A%20%20%20%20%20%20%20%20originalEvent%3A%20event%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20renderer3.onDeviceLost%28contextLossInfo%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._onContextLost%20%3D%20onContextLost%3B%0A%20%20%20%20renderer3.domElement.addEventListener%28%22webglcontextlost%22%2C%20onContextLost%2C%20false%29%3B%0A%20%20%20%20this.gl%20%3D%20glContext%3B%0A%20%20%20%20this.extensions%20%3D%20new%20WebGLExtensions2%28this%29%3B%0A%20%20%20%20this.capabilities%20%3D%20new%20WebGLCapabilities2%28this%29%3B%0A%20%20%20%20this.attributeUtils%20%3D%20new%20WebGLAttributeUtils%28this%29%3B%0A%20%20%20%20this.textureUtils%20%3D%20new%20WebGLTextureUtils%28this%29%3B%0A%20%20%20%20this.bufferRenderer%20%3D%20new%20WebGLBufferRenderer2%28this%29%3B%0A%20%20%20%20this.state%20%3D%20new%20WebGLState2%28this%29%3B%0A%20%20%20%20this.utils%20%3D%20new%20WebGLUtils2%28this%29%3B%0A%20%20%20%20this.vaoCache%20%3D%20%7B%7D%3B%0A%20%20%20%20this.transformFeedbackCache%20%3D%20%7B%7D%3B%0A%20%20%20%20this.discard%20%3D%20false%3B%0A%20%20%20%20this.trackTimestamp%20%3D%20parameters.trackTimestamp%20%3D%3D%3D%20true%3B%0A%20%20%20%20this.extensions.get%28%22EXT_color_buffer_float%22%29%3B%0A%20%20%20%20this.extensions.get%28%22WEBGL_clip_cull_distance%22%29%3B%0A%20%20%20%20this.extensions.get%28%22OES_texture_float_linear%22%29%3B%0A%20%20%20%20this.extensions.get%28%22EXT_color_buffer_half_float%22%29%3B%0A%20%20%20%20this.extensions.get%28%22WEBGL_multisampled_render_to_texture%22%29%3B%0A%20%20%20%20this.extensions.get%28%22WEBGL_render_shared_exponent%22%29%3B%0A%20%20%20%20this.extensions.get%28%22WEBGL_multi_draw%22%29%3B%0A%20%20%20%20this.disjoint%20%3D%20this.extensions.get%28%22EXT_disjoint_timer_query_webgl2%22%29%3B%0A%20%20%20%20this.parallel%20%3D%20this.extensions.get%28%22KHR_parallel_shader_compile%22%29%3B%0A%20%20%20%20this._knownBindings%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakSet%28%29%3B%0A%20%20%20%20this._currentContext%20%3D%20null%3B%0A%20%20%7D%0A%20%20get%20coordinateSystem%28%29%20%7B%0A%20%20%20%20return%20WebGLCoordinateSystem2%3B%0A%20%20%7D%0A%20%20async%20getArrayBufferAsync%28attribute2%29%20%7B%0A%20%20%20%20return%20await%20this.attributeUtils.getArrayBufferAsync%28attribute2%29%3B%0A%20%20%7D%0A%20%20async%20waitForGPU%28%29%20%7B%0A%20%20%20%20await%20this.utils._clientWaitAsync%28%29%3B%0A%20%20%7D%0A%20%20initTimestampQuery%28renderContext%29%20%7B%0A%20%20%20%20if%20%28%21this.disjoint%20%7C%7C%20%21this.trackTimestamp%29%20return%3B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20if%20%28this.queryRunning%29%20%7B%0A%20%20%20%20%20%20if%20%28%21renderContextData.queryQueue%29%20renderContextData.queryQueue%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20renderContextData.queryQueue.push%28renderContext%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderContextData.activeQuery%29%20%7B%0A%20%20%20%20%20%20this.gl.endQuery%28this.disjoint.TIME_ELAPSED_EXT%29%3B%0A%20%20%20%20%20%20renderContextData.activeQuery%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderContextData.activeQuery%20%3D%20this.gl.createQuery%28%29%3B%0A%20%20%20%20if%20%28renderContextData.activeQuery%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.gl.beginQuery%28this.disjoint.TIME_ELAPSED_EXT%2C%20renderContextData.activeQuery%29%3B%0A%20%20%20%20%20%20this.queryRunning%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2F%20timestamp%20utils%0A%20%20prepareTimestampBuffer%28renderContext%29%20%7B%0A%20%20%20%20if%20%28%21this.disjoint%20%7C%7C%20%21this.trackTimestamp%29%20return%3B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20if%20%28renderContextData.activeQuery%29%20%7B%0A%20%20%20%20%20%20this.gl.endQuery%28this.disjoint.TIME_ELAPSED_EXT%29%3B%0A%20%20%20%20%20%20if%20%28%21renderContextData.gpuQueries%29%20renderContextData.gpuQueries%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20renderContextData.gpuQueries.push%28%7B%20query%3A%20renderContextData.activeQuery%20%7D%29%3B%0A%20%20%20%20%20%20renderContextData.activeQuery%20%3D%20null%3B%0A%20%20%20%20%20%20this.queryRunning%20%3D%20false%3B%0A%20%20%20%20%20%20if%20%28renderContextData.queryQueue%20%26%26%20renderContextData.queryQueue.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20nextRenderContext%20%3D%20renderContextData.queryQueue.shift%28%29%3B%0A%20%20%20%20%20%20%20%20this.initTimestampQuery%28nextRenderContext%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20async%20resolveTimestampAsync%28renderContext%2C%20type%20%3D%20%22render%22%29%20%7B%0A%20%20%20%20if%20%28%21this.disjoint%20%7C%7C%20%21this.trackTimestamp%29%20return%3B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20if%20%28%21renderContextData.gpuQueries%29%20renderContextData.gpuQueries%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20renderContextData.gpuQueries.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20queryInfo%20%3D%20renderContextData.gpuQueries%5Bi%5D%3B%0A%20%20%20%20%20%20const%20available%20%3D%20this.gl.getQueryParameter%28queryInfo.query%2C%20this.gl.QUERY_RESULT_AVAILABLE%29%3B%0A%20%20%20%20%20%20const%20disjoint%20%3D%20this.gl.getParameter%28this.disjoint.GPU_DISJOINT_EXT%29%3B%0A%20%20%20%20%20%20if%20%28available%20%26%26%20%21disjoint%29%20%7B%0A%20%20%20%20%20%20%20%20const%20elapsed%20%3D%20this.gl.getQueryParameter%28queryInfo.query%2C%20this.gl.QUERY_RESULT%29%3B%0A%20%20%20%20%20%20%20%20const%20duration%20%3D%20Number%28elapsed%29%20%2F%201e6%3B%0A%20%20%20%20%20%20%20%20this.gl.deleteQuery%28queryInfo.query%29%3B%0A%20%20%20%20%20%20%20%20renderContextData.gpuQueries.splice%28i%2C%201%29%3B%0A%20%20%20%20%20%20%20%20i--%3B%0A%20%20%20%20%20%20%20%20this.renderer.info.updateTimestamp%28type%2C%20duration%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getContext%28%29%20%7B%0A%20%20%20%20return%20this.gl%3B%0A%20%20%7D%0A%20%20beginRender%28renderContext%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20this.initTimestampQuery%28renderContext%29%3B%0A%20%20%20%20renderContextData.previousContext%20%3D%20this._currentContext%3B%0A%20%20%20%20this._currentContext%20%3D%20renderContext%3B%0A%20%20%20%20this._setFramebuffer%28renderContext%29%3B%0A%20%20%20%20this.clear%28renderContext.clearColor%2C%20renderContext.clearDepth%2C%20renderContext.clearStencil%2C%20renderContext%2C%20false%29%3B%0A%20%20%20%20if%20%28renderContext.viewport%29%20%7B%0A%20%20%20%20%20%20this.updateViewport%28renderContext%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20gl.viewport%280%2C%200%2C%20gl.drawingBufferWidth%2C%20gl.drawingBufferHeight%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderContext.scissor%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20x%3A%20x2%2C%20y%3A%20y2%2C%20width%2C%20height%20%7D%20%3D%20renderContext.scissorValue%3B%0A%20%20%20%20%20%20gl.scissor%28x2%2C%20renderContext.height%20-%20height%20-%20y2%2C%20width%2C%20height%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20occlusionQueryCount%20%3D%20renderContext.occlusionQueryCount%3B%0A%20%20%20%20if%20%28occlusionQueryCount%20%3E%200%29%20%7B%0A%20%20%20%20%20%20renderContextData.currentOcclusionQueries%20%3D%20renderContextData.occlusionQueries%3B%0A%20%20%20%20%20%20renderContextData.currentOcclusionQueryObjects%20%3D%20renderContextData.occlusionQueryObjects%3B%0A%20%20%20%20%20%20renderContextData.lastOcclusionObject%20%3D%20null%3B%0A%20%20%20%20%20%20renderContextData.occlusionQueries%20%3D%20new%20Array%28occlusionQueryCount%29%3B%0A%20%20%20%20%20%20renderContextData.occlusionQueryObjects%20%3D%20new%20Array%28occlusionQueryCount%29%3B%0A%20%20%20%20%20%20renderContextData.occlusionQueryIndex%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20finishRender%28renderContext%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20state%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20const%20previousContext%20%3D%20renderContextData.previousContext%3B%0A%20%20%20%20const%20occlusionQueryCount%20%3D%20renderContext.occlusionQueryCount%3B%0A%20%20%20%20if%20%28occlusionQueryCount%20%3E%200%29%20%7B%0A%20%20%20%20%20%20if%20%28occlusionQueryCount%20%3E%20renderContextData.occlusionQueryIndex%29%20%7B%0A%20%20%20%20%20%20%20%20gl.endQuery%28gl.ANY_SAMPLES_PASSED%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.resolveOccludedAsync%28renderContext%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20textures%20%3D%20renderContext.textures%3B%0A%20%20%20%20if%20%28textures%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20texture2%20%3D%20textures%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28texture2.generateMipmaps%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.generateMipmaps%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this._currentContext%20%3D%20previousContext%3B%0A%20%20%20%20if%20%28renderContext.textures%20%21%3D%3D%20null%20%26%26%20renderContext.renderTarget%29%20%7B%0A%20%20%20%20%20%20const%20renderTargetContextData%20%3D%20this.get%28renderContext.renderTarget%29%3B%0A%20%20%20%20%20%20const%20%7B%20samples%20%7D%20%3D%20renderContext.renderTarget%3B%0A%20%20%20%20%20%20if%20%28samples%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20const%20fb%20%3D%20renderTargetContextData.framebuffers%5BrenderContext.getCacheKey%28%29%5D%3B%0A%20%20%20%20%20%20%20%20const%20mask%20%3D%20gl.COLOR_BUFFER_BIT%3B%0A%20%20%20%20%20%20%20%20const%20msaaFrameBuffer%20%3D%20renderTargetContextData.msaaFrameBuffer%3B%0A%20%20%20%20%20%20%20%20const%20textures2%20%3D%20renderContext.textures%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28gl.READ_FRAMEBUFFER%2C%20msaaFrameBuffer%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28gl.DRAW_FRAMEBUFFER%2C%20fb%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures2.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28renderContext.scissor%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20%7B%20x%3A%20x2%2C%20y%3A%20y2%2C%20width%2C%20height%20%7D%20%3D%20renderContext.scissorValue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20viewY%20%3D%20renderContext.height%20-%20height%20-%20y2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.blitFramebuffer%28x2%2C%20viewY%2C%20x2%20%2B%20width%2C%20viewY%20%2B%20height%2C%20x2%2C%20viewY%2C%20x2%20%2B%20width%2C%20viewY%20%2B%20height%2C%20mask%2C%20gl.NEAREST%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.invalidateSubFramebuffer%28gl.READ_FRAMEBUFFER%2C%20renderTargetContextData.invalidationArray%2C%20x2%2C%20viewY%2C%20width%2C%20height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.blitFramebuffer%280%2C%200%2C%20renderContext.width%2C%20renderContext.height%2C%200%2C%200%2C%20renderContext.width%2C%20renderContext.height%2C%20mask%2C%20gl.NEAREST%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.invalidateFramebuffer%28gl.READ_FRAMEBUFFER%2C%20renderTargetContextData.invalidationArray%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28previousContext%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._setFramebuffer%28previousContext%29%3B%0A%20%20%20%20%20%20if%20%28previousContext.viewport%29%20%7B%0A%20%20%20%20%20%20%20%20this.updateViewport%28previousContext%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20gl.viewport%280%2C%200%2C%20gl.drawingBufferWidth%2C%20gl.drawingBufferHeight%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.prepareTimestampBuffer%28renderContext%29%3B%0A%20%20%7D%0A%20%20resolveOccludedAsync%28renderContext%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20const%20%7B%20currentOcclusionQueries%2C%20currentOcclusionQueryObjects%20%7D%20%3D%20renderContextData%3B%0A%20%20%20%20if%20%28currentOcclusionQueries%20%26%26%20currentOcclusionQueryObjects%29%20%7B%0A%20%20%20%20%20%20const%20occluded%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakSet%28%29%3B%0A%20%20%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20%20%20renderContextData.currentOcclusionQueryObjects%20%3D%20null%3B%0A%20%20%20%20%20%20renderContextData.currentOcclusionQueries%20%3D%20null%3B%0A%20%20%20%20%20%20const%20check%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20let%20completed%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20currentOcclusionQueries.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20query%20%3D%20currentOcclusionQueries%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28query%20%3D%3D%3D%20null%29%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28gl.getQueryParameter%28query%2C%20gl.QUERY_RESULT_AVAILABLE%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28gl.getQueryParameter%28query%2C%20gl.QUERY_RESULT%29%20%3E%200%29%20occluded.add%28currentOcclusionQueryObjects%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20currentOcclusionQueries%5Bi%5D%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.deleteQuery%28query%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20completed%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28completed%20%3C%20currentOcclusionQueries.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20requestAnimationFrame%28check%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderContextData.occluded%20%3D%20occluded%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20check%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20isOccluded%28renderContext%2C%20object%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20return%20renderContextData.occluded%20%26%26%20renderContextData.occluded.has%28object%29%3B%0A%20%20%7D%0A%20%20updateViewport%28renderContext%29%20%7B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20const%20%7B%20x%3A%20x2%2C%20y%3A%20y2%2C%20width%2C%20height%20%7D%20%3D%20renderContext.viewportValue%3B%0A%20%20%20%20gl.viewport%28x2%2C%20renderContext.height%20-%20height%20-%20y2%2C%20width%2C%20height%29%3B%0A%20%20%7D%0A%20%20setScissorTest%28boolean%29%20%7B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20if%20%28boolean%29%20%7B%0A%20%20%20%20%20%20gl.enable%28gl.SCISSOR_TEST%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20gl.disable%28gl.SCISSOR_TEST%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20clear%28color2%2C%20depth2%2C%20stencil%2C%20descriptor%20%3D%20null%2C%20setFrameBuffer%20%3D%20true%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28descriptor%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20clearColor%20%3D%20this.getClearColor%28%29%3B%0A%20%20%20%20%20%20clearColor.r%20%2A%3D%20clearColor.a%3B%0A%20%20%20%20%20%20clearColor.g%20%2A%3D%20clearColor.a%3B%0A%20%20%20%20%20%20clearColor.b%20%2A%3D%20clearColor.a%3B%0A%20%20%20%20%20%20descriptor%20%3D%20%7B%0A%20%20%20%20%20%20%20%20textures%3A%20null%2C%0A%20%20%20%20%20%20%20%20clearColorValue%3A%20clearColor%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20clear%20%3D%200%3B%0A%20%20%20%20if%20%28color2%29%20clear%20%7C%3D%20gl.COLOR_BUFFER_BIT%3B%0A%20%20%20%20if%20%28depth2%29%20clear%20%7C%3D%20gl.DEPTH_BUFFER_BIT%3B%0A%20%20%20%20if%20%28stencil%29%20clear%20%7C%3D%20gl.STENCIL_BUFFER_BIT%3B%0A%20%20%20%20if%20%28clear%20%21%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20let%20clearColor%3B%0A%20%20%20%20%20%20if%20%28descriptor.clearColorValue%29%20%7B%0A%20%20%20%20%20%20%20%20clearColor%20%3D%20descriptor.clearColorValue%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20clearColor%20%3D%20this.getClearColor%28%29%3B%0A%20%20%20%20%20%20%20%20clearColor.r%20%2A%3D%20clearColor.a%3B%0A%20%20%20%20%20%20%20%20clearColor.g%20%2A%3D%20clearColor.a%3B%0A%20%20%20%20%20%20%20%20clearColor.b%20%2A%3D%20clearColor.a%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28depth2%29%20this.state.setDepthMask%28true%29%3B%0A%20%20%20%20%20%20if%20%28descriptor.textures%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20gl.clearColor%28clearColor.r%2C%20clearColor.g%2C%20clearColor.b%2C%20clearColor.a%29%3B%0A%20%20%20%20%20%20%20%20gl.clear%28clear%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28setFrameBuffer%29%20this._setFramebuffer%28descriptor%29%3B%0A%20%20%20%20%20%20%20%20if%20%28color2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20descriptor.textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.clearBufferfv%28gl.COLOR%2C%20i%2C%20%5BclearColor.r%2C%20clearColor.g%2C%20clearColor.b%2C%20clearColor.a%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28depth2%20%26%26%20stencil%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.clearBufferfi%28gl.DEPTH_STENCIL%2C%200%2C%201%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28depth2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.clearBufferfv%28gl.DEPTH%2C%200%2C%20%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28stencil%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20gl.clearBufferiv%28gl.STENCIL%2C%200%2C%20%5B0%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20beginCompute%28computeGroup%29%20%7B%0A%20%20%20%20const%20%7B%20state%2C%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20state.bindFramebuffer%28gl.FRAMEBUFFER%2C%20null%29%3B%0A%20%20%20%20this.initTimestampQuery%28computeGroup%29%3B%0A%20%20%7D%0A%20%20compute%28computeGroup%2C%20computeNode%2C%20bindings%2C%20pipeline%29%20%7B%0A%20%20%20%20const%20%7B%20state%2C%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20if%20%28%21this.discard%29%20%7B%0A%20%20%20%20%20%20gl.enable%28gl.RASTERIZER_DISCARD%29%3B%0A%20%20%20%20%20%20this.discard%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20%7B%20programGPU%2C%20transformBuffers%2C%20attributes%20%7D%20%3D%20this.get%28pipeline%29%3B%0A%20%20%20%20const%20vaoKey%20%3D%20this._getVaoKey%28null%2C%20attributes%29%3B%0A%20%20%20%20const%20vaoGPU%20%3D%20this.vaoCache%5BvaoKey%5D%3B%0A%20%20%20%20if%20%28vaoGPU%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this._createVao%28null%2C%20attributes%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20gl.bindVertexArray%28vaoGPU%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.useProgram%28programGPU%29%3B%0A%20%20%20%20this._bindUniforms%28bindings%29%3B%0A%20%20%20%20const%20transformFeedbackGPU%20%3D%20this._getTransformFeedback%28transformBuffers%29%3B%0A%20%20%20%20gl.bindTransformFeedback%28gl.TRANSFORM_FEEDBACK%2C%20transformFeedbackGPU%29%3B%0A%20%20%20%20gl.beginTransformFeedback%28gl.POINTS%29%3B%0A%20%20%20%20if%20%28attributes%5B0%5D.isStorageInstancedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20gl.drawArraysInstanced%28gl.POINTS%2C%200%2C%201%2C%20computeNode.count%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20gl.drawArrays%28gl.POINTS%2C%200%2C%20computeNode.count%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20gl.endTransformFeedback%28%29%3B%0A%20%20%20%20gl.bindTransformFeedback%28gl.TRANSFORM_FEEDBACK%2C%20null%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20transformBuffers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20dualAttributeData%20%3D%20transformBuffers%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28dualAttributeData.pbo%29%20%7B%0A%20%20%20%20%20%20%20%20this.textureUtils.copyBufferToTexture%28dualAttributeData.transformBuffer%2C%20dualAttributeData.pbo%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20dualAttributeData.switchBuffers%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20finishCompute%28computeGroup%29%20%7B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20this.discard%20%3D%20false%3B%0A%20%20%20%20gl.disable%28gl.RASTERIZER_DISCARD%29%3B%0A%20%20%20%20this.prepareTimestampBuffer%28computeGroup%29%3B%0A%20%20%20%20if%20%28this._currentContext%29%20%7B%0A%20%20%20%20%20%20this._setFramebuffer%28this._currentContext%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20draw%28renderObject%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20pipeline%2C%20material%2C%20context%3A%20context2%20%7D%20%3D%20renderObject%3B%0A%20%20%20%20const%20%7B%20programGPU%20%7D%20%3D%20this.get%28pipeline%29%3B%0A%20%20%20%20const%20%7B%20gl%2C%20state%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20contextData%20%3D%20this.get%28context2%29%3B%0A%20%20%20%20const%20drawParams%20%3D%20renderObject.getDrawParameters%28%29%3B%0A%20%20%20%20if%20%28drawParams%20%3D%3D%3D%20null%29%20return%3B%0A%20%20%20%20this._bindUniforms%28renderObject.getBindings%28%29%29%3B%0A%20%20%20%20const%20frontFaceCW%20%3D%20object.isMesh%20%26%26%20object.matrixWorld.determinant%28%29%20%3C%200%3B%0A%20%20%20%20state.setMaterial%28material%2C%20frontFaceCW%29%3B%0A%20%20%20%20state.useProgram%28programGPU%29%3B%0A%20%20%20%20let%20vaoGPU%20%3D%20renderObject.staticVao%3B%0A%20%20%20%20if%20%28vaoGPU%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20vaoKey%20%3D%20this._getVaoKey%28renderObject.getIndex%28%29%2C%20renderObject.getAttributes%28%29%29%3B%0A%20%20%20%20%20%20vaoGPU%20%3D%20this.vaoCache%5BvaoKey%5D%3B%0A%20%20%20%20%20%20if%20%28vaoGPU%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20let%20staticVao%3B%0A%20%20%20%20%20%20%20%20%28%7B%20vaoGPU%2C%20staticVao%20%7D%20%3D%20this._createVao%28renderObject.getIndex%28%29%2C%20renderObject.getAttributes%28%29%29%29%3B%0A%20%20%20%20%20%20%20%20if%20%28staticVao%29%20renderObject.staticVao%20%3D%20vaoGPU%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20gl.bindVertexArray%28vaoGPU%29%3B%0A%20%20%20%20const%20index5%20%3D%20renderObject.getIndex%28%29%3B%0A%20%20%20%20const%20lastObject%20%3D%20contextData.lastOcclusionObject%3B%0A%20%20%20%20if%20%28lastObject%20%21%3D%3D%20object%20%26%26%20lastObject%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28lastObject%20%21%3D%3D%20null%20%26%26%20lastObject.occlusionTest%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20gl.endQuery%28gl.ANY_SAMPLES_PASSED%29%3B%0A%20%20%20%20%20%20%20%20contextData.occlusionQueryIndex%2B%2B%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28object.occlusionTest%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20const%20query%20%3D%20gl.createQuery%28%29%3B%0A%20%20%20%20%20%20%20%20gl.beginQuery%28gl.ANY_SAMPLES_PASSED%2C%20query%29%3B%0A%20%20%20%20%20%20%20%20contextData.occlusionQueries%5BcontextData.occlusionQueryIndex%5D%20%3D%20query%3B%0A%20%20%20%20%20%20%20%20contextData.occlusionQueryObjects%5BcontextData.occlusionQueryIndex%5D%20%3D%20object%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20contextData.lastOcclusionObject%20%3D%20object%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20renderer3%20%3D%20this.bufferRenderer%3B%0A%20%20%20%20if%20%28object.isPoints%29%20renderer3.mode%20%3D%20gl.POINTS%3B%0A%20%20%20%20else%20if%20%28object.isLineSegments%29%20renderer3.mode%20%3D%20gl.LINES%3B%0A%20%20%20%20else%20if%20%28object.isLine%29%20renderer3.mode%20%3D%20gl.LINE_STRIP%3B%0A%20%20%20%20else%20if%20%28object.isLineLoop%29%20renderer3.mode%20%3D%20gl.LINE_LOOP%3B%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20if%20%28material.wireframe%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20state.setLineWidth%28material.wireframeLinewidth%20%2A%20this.renderer.getPixelRatio%28%29%29%3B%0A%20%20%20%20%20%20%20%20renderer3.mode%20%3D%20gl.LINES%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20renderer3.mode%20%3D%20gl.TRIANGLES%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20%7B%20vertexCount%2C%20instanceCount%20%7D%20%3D%20drawParams%3B%0A%20%20%20%20let%20%7B%20firstVertex%20%7D%20%3D%20drawParams%3B%0A%20%20%20%20renderer3.object%20%3D%20object%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20firstVertex%20%2A%3D%20index5.array.BYTES_PER_ELEMENT%3B%0A%20%20%20%20%20%20const%20indexData%20%3D%20this.get%28index5%29%3B%0A%20%20%20%20%20%20renderer3.index%20%3D%20index5.count%3B%0A%20%20%20%20%20%20renderer3.type%20%3D%20indexData.type%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderer3.index%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isBatchedMesh%29%20%7B%0A%20%20%20%20%20%20if%20%28object._multiDrawInstances%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20renderer3.renderMultiDrawInstances%28object._multiDrawStarts%2C%20object._multiDrawCounts%2C%20object._multiDrawCount%2C%20object._multiDrawInstances%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28%21this.hasFeature%28%22WEBGL_multi_draw%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20warnOnce2%28%22THREE.WebGLRenderer%3A%20WEBGL_multi_draw%20not%20supported.%22%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20renderer3.renderMultiDraw%28object._multiDrawStarts%2C%20object._multiDrawCounts%2C%20object._multiDrawCount%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28instanceCount%20%3E%201%29%20%7B%0A%20%20%20%20%20%20renderer3.renderInstances%28firstVertex%2C%20vertexCount%2C%20instanceCount%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderer3.render%28firstVertex%2C%20vertexCount%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20gl.bindVertexArray%28null%29%3B%0A%20%20%7D%0A%20%20needsRenderUpdate%28%29%20%7B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20getRenderCacheKey%28%29%20%7B%0A%20%20%20%20return%20%22%22%3B%0A%20%20%7D%0A%20%20%2F%2F%20textures%0A%20%20createDefaultTexture%28texture2%29%20%7B%0A%20%20%20%20this.textureUtils.createDefaultTexture%28texture2%29%3B%0A%20%20%7D%0A%20%20createTexture%28texture2%2C%20options%29%20%7B%0A%20%20%20%20this.textureUtils.createTexture%28texture2%2C%20options%29%3B%0A%20%20%7D%0A%20%20updateTexture%28texture2%2C%20options%29%20%7B%0A%20%20%20%20this.textureUtils.updateTexture%28texture2%2C%20options%29%3B%0A%20%20%7D%0A%20%20generateMipmaps%28texture2%29%20%7B%0A%20%20%20%20this.textureUtils.generateMipmaps%28texture2%29%3B%0A%20%20%7D%0A%20%20destroyTexture%28texture2%29%20%7B%0A%20%20%20%20this.textureUtils.destroyTexture%28texture2%29%3B%0A%20%20%7D%0A%20%20copyTextureToBuffer%28texture2%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20faceIndex%29%20%7B%0A%20%20%20%20return%20this.textureUtils.copyTextureToBuffer%28texture2%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20faceIndex%29%3B%0A%20%20%7D%0A%20%20createSampler%28%29%20%7B%0A%20%20%7D%0A%20%20destroySampler%28%29%20%7B%0A%20%20%7D%0A%20%20%2F%2F%20node%20builder%0A%20%20createNodeBuilder%28object%2C%20renderer3%29%20%7B%0A%20%20%20%20return%20new%20GLSLNodeBuilder%28object%2C%20renderer3%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20program%0A%20%20createProgram%28program%29%20%7B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20const%20%7B%20stage%2C%20code%20%7D%20%3D%20program%3B%0A%20%20%20%20const%20shader%20%3D%20stage%20%3D%3D%3D%20%22fragment%22%20%3F%20gl.createShader%28gl.FRAGMENT_SHADER%29%20%3A%20gl.createShader%28gl.VERTEX_SHADER%29%3B%0A%20%20%20%20gl.shaderSource%28shader%2C%20code%29%3B%0A%20%20%20%20gl.compileShader%28shader%29%3B%0A%20%20%20%20this.set%28program%2C%20%7B%0A%20%20%20%20%20%20shaderGPU%3A%20shader%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20destroyProgram%28%29%20%7B%0A%20%20%20%20console.warn%28%22Abstract%20class.%22%29%3B%0A%20%20%7D%0A%20%20createRenderPipeline%28renderObject%2C%20promises%29%20%7B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20const%20pipeline%20%3D%20renderObject.pipeline%3B%0A%20%20%20%20const%20%7B%20fragmentProgram%2C%20vertexProgram%20%7D%20%3D%20pipeline%3B%0A%20%20%20%20const%20programGPU%20%3D%20gl.createProgram%28%29%3B%0A%20%20%20%20const%20fragmentShader%20%3D%20this.get%28fragmentProgram%29.shaderGPU%3B%0A%20%20%20%20const%20vertexShader%20%3D%20this.get%28vertexProgram%29.shaderGPU%3B%0A%20%20%20%20gl.attachShader%28programGPU%2C%20fragmentShader%29%3B%0A%20%20%20%20gl.attachShader%28programGPU%2C%20vertexShader%29%3B%0A%20%20%20%20gl.linkProgram%28programGPU%29%3B%0A%20%20%20%20this.set%28pipeline%2C%20%7B%0A%20%20%20%20%20%20programGPU%2C%0A%20%20%20%20%20%20fragmentShader%2C%0A%20%20%20%20%20%20vertexShader%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20if%20%28promises%20%21%3D%3D%20null%20%26%26%20this.parallel%29%20%7B%0A%20%20%20%20%20%20const%20p%20%3D%20new%20Promise%28%28resolve%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20parallel%20%3D%20this.parallel%3B%0A%20%20%20%20%20%20%20%20const%20checkStatus%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28gl.getProgramParameter%28programGPU%2C%20parallel.COMPLETION_STATUS_KHR%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._completeCompile%28renderObject%2C%20pipeline%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20resolve%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20requestAnimationFrame%28checkStatus%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20checkStatus%28%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20promises.push%28p%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._completeCompile%28renderObject%2C%20pipeline%29%3B%0A%20%20%7D%0A%20%20_handleSource%28string%2C%20errorLine%29%20%7B%0A%20%20%20%20const%20lines%20%3D%20string.split%28%22%5Cn%22%29%3B%0A%20%20%20%20const%20lines2%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20from%20%3D%20Math.max%28errorLine%20-%206%2C%200%29%3B%0A%20%20%20%20const%20to%20%3D%20Math.min%28errorLine%20%2B%206%2C%20lines.length%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%20from%3B%20i%20%3C%20to%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20line%20%3D%20i%20%2B%201%3B%0A%20%20%20%20%20%20lines2.push%28%60%24%7Bline%20%3D%3D%3D%20errorLine%20%3F%20%22%3E%22%20%3A%20%22%20%22%7D%20%24%7Bline%7D%3A%20%24%7Blines%5Bi%5D%7D%60%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20lines2.join%28%22%5Cn%22%29%3B%0A%20%20%7D%0A%20%20_getShaderErrors%28gl%2C%20shader%2C%20type%29%20%7B%0A%20%20%20%20const%20status%20%3D%20gl.getShaderParameter%28shader%2C%20gl.COMPILE_STATUS%29%3B%0A%20%20%20%20const%20errors%20%3D%20gl.getShaderInfoLog%28shader%29.trim%28%29%3B%0A%20%20%20%20if%20%28status%20%26%26%20errors%20%3D%3D%3D%20%22%22%29%20return%20%22%22%3B%0A%20%20%20%20const%20errorMatches%20%3D%20%2FERROR%3A%200%3A%28%5Cd%2B%29%2F.exec%28errors%29%3B%0A%20%20%20%20if%20%28errorMatches%29%20%7B%0A%20%20%20%20%20%20const%20errorLine%20%3D%20parseInt%28errorMatches%5B1%5D%29%3B%0A%20%20%20%20%20%20return%20type.toUpperCase%28%29%20%2B%20%22%5Cn%5Cn%22%20%2B%20errors%20%2B%20%22%5Cn%5Cn%22%20%2B%20this._handleSource%28gl.getShaderSource%28shader%29%2C%20errorLine%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20errors%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_logProgramError%28programGPU%2C%20glFragmentShader%2C%20glVertexShader%29%20%7B%0A%20%20%20%20if%20%28this.renderer.debug.checkShaderErrors%29%20%7B%0A%20%20%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20%20%20const%20programLog%20%3D%20gl.getProgramInfoLog%28programGPU%29.trim%28%29%3B%0A%20%20%20%20%20%20if%20%28gl.getProgramParameter%28programGPU%2C%20gl.LINK_STATUS%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28typeof%20this.renderer.debug.onShaderError%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.renderer.debug.onShaderError%28gl%2C%20programGPU%2C%20glVertexShader%2C%20glFragmentShader%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20vertexErrors%20%3D%20this._getShaderErrors%28gl%2C%20glVertexShader%2C%20%22vertex%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20fragmentErrors%20%3D%20this._getShaderErrors%28gl%2C%20glFragmentShader%2C%20%22fragment%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20console.error%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%22THREE.WebGLProgram%3A%20Shader%20Error%20%22%20%2B%20gl.getError%28%29%20%2B%20%22%20-%20VALIDATE_STATUS%20%22%20%2B%20gl.getProgramParameter%28programGPU%2C%20gl.VALIDATE_STATUS%29%20%2B%20%22%5Cn%5CnProgram%20Info%20Log%3A%20%22%20%2B%20programLog%20%2B%20%22%5Cn%22%20%2B%20vertexErrors%20%2B%20%22%5Cn%22%20%2B%20fragmentErrors%0A%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28programLog%20%21%3D%3D%20%22%22%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGLProgram%3A%20Program%20Info%20Log%3A%22%2C%20programLog%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_completeCompile%28renderObject%2C%20pipeline%29%20%7B%0A%20%20%20%20const%20%7B%20state%2C%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20pipelineData%20%3D%20this.get%28pipeline%29%3B%0A%20%20%20%20const%20%7B%20programGPU%2C%20fragmentShader%2C%20vertexShader%20%7D%20%3D%20pipelineData%3B%0A%20%20%20%20if%20%28gl.getProgramParameter%28programGPU%2C%20gl.LINK_STATUS%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this._logProgramError%28programGPU%2C%20fragmentShader%2C%20vertexShader%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.useProgram%28programGPU%29%3B%0A%20%20%20%20const%20bindings%20%3D%20renderObject.getBindings%28%29%3B%0A%20%20%20%20this._setupBindings%28bindings%2C%20programGPU%29%3B%0A%20%20%20%20this.set%28pipeline%2C%20%7B%0A%20%20%20%20%20%20programGPU%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20createComputePipeline%28computePipeline%2C%20bindings%29%20%7B%0A%20%20%20%20const%20%7B%20state%2C%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20fragmentProgram%20%3D%20%7B%0A%20%20%20%20%20%20stage%3A%20%22fragment%22%2C%0A%20%20%20%20%20%20code%3A%20%22%23version%20300%20es%5Cnprecision%20highp%20float%3B%5Cnvoid%20main%28%29%20%7B%7D%22%0A%20%20%20%20%7D%3B%0A%20%20%20%20this.createProgram%28fragmentProgram%29%3B%0A%20%20%20%20const%20%7B%20computeProgram%20%7D%20%3D%20computePipeline%3B%0A%20%20%20%20const%20programGPU%20%3D%20gl.createProgram%28%29%3B%0A%20%20%20%20const%20fragmentShader%20%3D%20this.get%28fragmentProgram%29.shaderGPU%3B%0A%20%20%20%20const%20vertexShader%20%3D%20this.get%28computeProgram%29.shaderGPU%3B%0A%20%20%20%20const%20transforms%20%3D%20computeProgram.transforms%3B%0A%20%20%20%20const%20transformVaryingNames%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20transformAttributeNodes%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20transforms.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20transform%20%3D%20transforms%5Bi%5D%3B%0A%20%20%20%20%20%20transformVaryingNames.push%28transform.varyingName%29%3B%0A%20%20%20%20%20%20transformAttributeNodes.push%28transform.attributeNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20gl.attachShader%28programGPU%2C%20fragmentShader%29%3B%0A%20%20%20%20gl.attachShader%28programGPU%2C%20vertexShader%29%3B%0A%20%20%20%20gl.transformFeedbackVaryings%28%0A%20%20%20%20%20%20programGPU%2C%0A%20%20%20%20%20%20transformVaryingNames%2C%0A%20%20%20%20%20%20gl.SEPARATE_ATTRIBS%0A%20%20%20%20%29%3B%0A%20%20%20%20gl.linkProgram%28programGPU%29%3B%0A%20%20%20%20if%20%28gl.getProgramParameter%28programGPU%2C%20gl.LINK_STATUS%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this._logProgramError%28programGPU%2C%20fragmentShader%2C%20vertexShader%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.useProgram%28programGPU%29%3B%0A%20%20%20%20this._setupBindings%28bindings%2C%20programGPU%29%3B%0A%20%20%20%20const%20attributeNodes%20%3D%20computeProgram.attributes%3B%0A%20%20%20%20const%20attributes%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20transformBuffers%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20attributeNodes.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributeNodes%5Bi%5D.node.attribute%3B%0A%20%20%20%20%20%20attributes.push%28attribute2%29%3B%0A%20%20%20%20%20%20if%20%28%21this.has%28attribute2%29%29%20this.attributeUtils.createAttribute%28attribute2%2C%20gl.ARRAY_BUFFER%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20transformAttributeNodes.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20transformAttributeNodes%5Bi%5D.attribute%3B%0A%20%20%20%20%20%20if%20%28%21this.has%28attribute2%29%29%20this.attributeUtils.createAttribute%28attribute2%2C%20gl.ARRAY_BUFFER%29%3B%0A%20%20%20%20%20%20const%20attributeData%20%3D%20this.get%28attribute2%29%3B%0A%20%20%20%20%20%20transformBuffers.push%28attributeData%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.set%28computePipeline%2C%20%7B%0A%20%20%20%20%20%20programGPU%2C%0A%20%20%20%20%20%20transformBuffers%2C%0A%20%20%20%20%20%20attributes%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20createBindings%28bindGroup%2C%20bindings%29%20%7B%0A%20%20%20%20if%20%28this._knownBindings.has%28bindings%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this._knownBindings.add%28bindings%29%3B%0A%20%20%20%20%20%20let%20uniformBuffers%20%3D%200%3B%0A%20%20%20%20%20%20let%20textures%20%3D%200%3B%0A%20%20%20%20%20%20for%20%28const%20bindGroup2%20of%20bindings%29%20%7B%0A%20%20%20%20%20%20%20%20this.set%28bindGroup2%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20textures%2C%0A%20%20%20%20%20%20%20%20%20%20uniformBuffers%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20for%20%28const%20binding%20of%20bindGroup2.bindings%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28binding.isUniformBuffer%29%20uniformBuffers%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28binding.isSampledTexture%29%20textures%2B%2B%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.updateBindings%28bindGroup%2C%20bindings%29%3B%0A%20%20%7D%0A%20%20updateBindings%28bindGroup%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20bindGroupData%20%3D%20this.get%28bindGroup%29%3B%0A%20%20%20%20let%20i%20%3D%20bindGroupData.uniformBuffers%3B%0A%20%20%20%20let%20t%20%3D%20bindGroupData.textures%3B%0A%20%20%20%20for%20%28const%20binding%20of%20bindGroup.bindings%29%20%7B%0A%20%20%20%20%20%20if%20%28binding.isUniformsGroup%20%7C%7C%20binding.isUniformBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20const%20data%20%3D%20binding.buffer%3B%0A%20%20%20%20%20%20%20%20const%20bufferGPU%20%3D%20gl.createBuffer%28%29%3B%0A%20%20%20%20%20%20%20%20gl.bindBuffer%28gl.UNIFORM_BUFFER%2C%20bufferGPU%29%3B%0A%20%20%20%20%20%20%20%20gl.bufferData%28gl.UNIFORM_BUFFER%2C%20data%2C%20gl.DYNAMIC_DRAW%29%3B%0A%20%20%20%20%20%20%20%20this.set%28binding%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20index%3A%20i%2B%2B%2C%0A%20%20%20%20%20%20%20%20%20%20bufferGPU%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture%29%20%7B%0A%20%20%20%20%20%20%20%20const%20%7B%20textureGPU%2C%20glTextureType%20%7D%20%3D%20this.get%28binding.texture%29%3B%0A%20%20%20%20%20%20%20%20this.set%28binding%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20index%3A%20t%2B%2B%2C%0A%20%20%20%20%20%20%20%20%20%20textureGPU%2C%0A%20%20%20%20%20%20%20%20%20%20glTextureType%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateBinding%28binding%29%20%7B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20if%20%28binding.isUniformsGroup%20%7C%7C%20binding.isUniformBuffer%29%20%7B%0A%20%20%20%20%20%20const%20bindingData%20%3D%20this.get%28binding%29%3B%0A%20%20%20%20%20%20const%20bufferGPU%20%3D%20bindingData.bufferGPU%3B%0A%20%20%20%20%20%20const%20data%20%3D%20binding.buffer%3B%0A%20%20%20%20%20%20gl.bindBuffer%28gl.UNIFORM_BUFFER%2C%20bufferGPU%29%3B%0A%20%20%20%20%20%20gl.bufferData%28gl.UNIFORM_BUFFER%2C%20data%2C%20gl.DYNAMIC_DRAW%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2F%20attributes%0A%20%20createIndexAttribute%28attribute2%29%20%7B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20this.attributeUtils.createAttribute%28attribute2%2C%20gl.ELEMENT_ARRAY_BUFFER%29%3B%0A%20%20%7D%0A%20%20createAttribute%28attribute2%29%20%7B%0A%20%20%20%20if%20%28this.has%28attribute2%29%29%20return%3B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20this.attributeUtils.createAttribute%28attribute2%2C%20gl.ARRAY_BUFFER%29%3B%0A%20%20%7D%0A%20%20createStorageAttribute%28attribute2%29%20%7B%0A%20%20%20%20if%20%28this.has%28attribute2%29%29%20return%3B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20this.attributeUtils.createAttribute%28attribute2%2C%20gl.ARRAY_BUFFER%29%3B%0A%20%20%7D%0A%20%20updateAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.attributeUtils.updateAttribute%28attribute2%29%3B%0A%20%20%7D%0A%20%20destroyAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.attributeUtils.destroyAttribute%28attribute2%29%3B%0A%20%20%7D%0A%20%20updateSize%28%29%20%7B%0A%20%20%7D%0A%20%20hasFeature%28name%29%20%7B%0A%20%20%20%20const%20keysMatching%20%3D%20Object.keys%28GLFeatureName%29.filter%28%28key%29%20%3D%3E%20GLFeatureName%5Bkey%5D%20%3D%3D%3D%20name%29%3B%0A%20%20%20%20const%20extensions%20%3D%20this.extensions%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20keysMatching.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28extensions.has%28keysMatching%5Bi%5D%29%29%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20getMaxAnisotropy%28%29%20%7B%0A%20%20%20%20return%20this.capabilities.getMaxAnisotropy%28%29%3B%0A%20%20%7D%0A%20%20copyTextureToTexture%28srcTexture%2C%20dstTexture%2C%20srcRegion%2C%20dstPosition%2C%20level%29%20%7B%0A%20%20%20%20this.textureUtils.copyTextureToTexture%28srcTexture%2C%20dstTexture%2C%20srcRegion%2C%20dstPosition%2C%20level%29%3B%0A%20%20%7D%0A%20%20copyFramebufferToTexture%28texture2%2C%20renderContext%2C%20rectangle%29%20%7B%0A%20%20%20%20this.textureUtils.copyFramebufferToTexture%28texture2%2C%20renderContext%2C%20rectangle%29%3B%0A%20%20%7D%0A%20%20_setFramebuffer%28descriptor%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20state%20%7D%20%3D%20this%3B%0A%20%20%20%20let%20currentFrameBuffer%20%3D%20null%3B%0A%20%20%20%20if%20%28descriptor.textures%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20renderTarget%20%3D%20descriptor.renderTarget%3B%0A%20%20%20%20%20%20const%20renderTargetContextData%20%3D%20this.get%28renderTarget%29%3B%0A%20%20%20%20%20%20const%20%7B%20samples%2C%20depthBuffer%2C%20stencilBuffer%20%7D%20%3D%20renderTarget%3B%0A%20%20%20%20%20%20const%20isCube%20%3D%20renderTarget.isWebGLCubeRenderTarget%20%3D%3D%3D%20true%3B%0A%20%20%20%20%20%20let%20msaaFb%20%3D%20renderTargetContextData.msaaFrameBuffer%3B%0A%20%20%20%20%20%20let%20depthRenderbuffer%20%3D%20renderTargetContextData.depthRenderbuffer%3B%0A%20%20%20%20%20%20const%20cacheKey%20%3D%20getCacheKey%28descriptor%29%3B%0A%20%20%20%20%20%20let%20fb%3B%0A%20%20%20%20%20%20if%20%28isCube%29%20%7B%0A%20%20%20%20%20%20%20%20renderTargetContextData.cubeFramebuffers%20%7C%7C%20%28renderTargetContextData.cubeFramebuffers%20%3D%20%7B%7D%29%3B%0A%20%20%20%20%20%20%20%20fb%20%3D%20renderTargetContextData.cubeFramebuffers%5BcacheKey%5D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20renderTargetContextData.framebuffers%20%7C%7C%20%28renderTargetContextData.framebuffers%20%3D%20%7B%7D%29%3B%0A%20%20%20%20%20%20%20%20fb%20%3D%20renderTargetContextData.framebuffers%5BcacheKey%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28fb%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20fb%20%3D%20gl.createFramebuffer%28%29%3B%0A%20%20%20%20%20%20%20%20state.bindFramebuffer%28gl.FRAMEBUFFER%2C%20fb%29%3B%0A%20%20%20%20%20%20%20%20const%20textures%20%3D%20descriptor.textures%3B%0A%20%20%20%20%20%20%20%20if%20%28isCube%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderTargetContextData.cubeFramebuffers%5BcacheKey%5D%20%3D%20fb%3B%0A%20%20%20%20%20%20%20%20%20%20const%20%7B%20textureGPU%20%7D%20%3D%20this.get%28textures%5B0%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20cubeFace%20%3D%20this.renderer._activeCubeFace%3B%0A%20%20%20%20%20%20%20%20%20%20gl.framebufferTexture2D%28gl.FRAMEBUFFER%2C%20gl.COLOR_ATTACHMENT0%2C%20gl.TEXTURE_CUBE_MAP_POSITIVE_X%20%2B%20cubeFace%2C%20textureGPU%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20renderTargetContextData.framebuffers%5BcacheKey%5D%20%3D%20fb%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20texture2%20%3D%20textures%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20textureData%20%3D%20this.get%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20textureData.renderTarget%20%3D%20descriptor.renderTarget%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20textureData.cacheKey%20%3D%20cacheKey%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20attachment%20%3D%20gl.COLOR_ATTACHMENT0%20%2B%20i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.framebufferTexture2D%28gl.FRAMEBUFFER%2C%20attachment%2C%20gl.TEXTURE_2D%2C%20textureData.textureGPU%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20state.drawBuffers%28descriptor%2C%20fb%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28descriptor.depthTexture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20textureData%20%3D%20this.get%28descriptor.depthTexture%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20depthStyle%20%3D%20stencilBuffer%20%3F%20gl.DEPTH_STENCIL_ATTACHMENT%20%3A%20gl.DEPTH_ATTACHMENT%3B%0A%20%20%20%20%20%20%20%20%20%20textureData.renderTarget%20%3D%20descriptor.renderTarget%3B%0A%20%20%20%20%20%20%20%20%20%20textureData.cacheKey%20%3D%20cacheKey%3B%0A%20%20%20%20%20%20%20%20%20%20gl.framebufferTexture2D%28gl.FRAMEBUFFER%2C%20depthStyle%2C%20gl.TEXTURE_2D%2C%20textureData.textureGPU%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28samples%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28msaaFb%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20invalidationArray%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20msaaFb%20%3D%20gl.createFramebuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.bindFramebuffer%28gl.FRAMEBUFFER%2C%20msaaFb%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20msaaRenderbuffers%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20const%20textures%20%3D%20descriptor.textures%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20msaaRenderbuffers%5Bi%5D%20%3D%20gl.createRenderbuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.bindRenderbuffer%28gl.RENDERBUFFER%2C%20msaaRenderbuffers%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20invalidationArray.push%28gl.COLOR_ATTACHMENT0%20%2B%20i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28depthBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20depthStyle%20%3D%20stencilBuffer%20%3F%20gl.DEPTH_STENCIL_ATTACHMENT%20%3A%20gl.DEPTH_ATTACHMENT%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20invalidationArray.push%28depthStyle%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20texture2%20%3D%20descriptor.textures%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20textureData%20%3D%20this.get%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.renderbufferStorageMultisample%28gl.RENDERBUFFER%2C%20samples%2C%20textureData.glInternalFormat%2C%20descriptor.width%2C%20descriptor.height%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20gl.framebufferRenderbuffer%28gl.FRAMEBUFFER%2C%20gl.COLOR_ATTACHMENT0%20%2B%20i%2C%20gl.RENDERBUFFER%2C%20msaaRenderbuffers%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20renderTargetContextData.msaaFrameBuffer%20%3D%20msaaFb%3B%0A%20%20%20%20%20%20%20%20%20%20renderTargetContextData.msaaRenderbuffers%20%3D%20msaaRenderbuffers%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28depthRenderbuffer%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20depthRenderbuffer%20%3D%20gl.createRenderbuffer%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.textureUtils.setupRenderBufferStorage%28depthRenderbuffer%2C%20descriptor%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20renderTargetContextData.depthRenderbuffer%20%3D%20depthRenderbuffer%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20depthStyle%20%3D%20stencilBuffer%20%3F%20gl.DEPTH_STENCIL_ATTACHMENT%20%3A%20gl.DEPTH_ATTACHMENT%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20invalidationArray.push%28depthStyle%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20renderTargetContextData.invalidationArray%20%3D%20invalidationArray%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20currentFrameBuffer%20%3D%20renderTargetContextData.msaaFrameBuffer%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20currentFrameBuffer%20%3D%20fb%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20state.bindFramebuffer%28gl.FRAMEBUFFER%2C%20currentFrameBuffer%29%3B%0A%20%20%7D%0A%20%20_getVaoKey%28index5%2C%20attributes%29%20%7B%0A%20%20%20%20let%20key%20%3D%20%5B%5D%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20indexData%20%3D%20this.get%28index5%29%3B%0A%20%20%20%20%20%20key%20%2B%3D%20%22%3A%22%20%2B%20indexData.id%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20attributes.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20attributeData%20%3D%20this.get%28attributes%5Bi%5D%29%3B%0A%20%20%20%20%20%20key%20%2B%3D%20%22%3A%22%20%2B%20attributeData.id%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20key%3B%0A%20%20%7D%0A%20%20_createVao%28index5%2C%20attributes%29%20%7B%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20vaoGPU%20%3D%20gl.createVertexArray%28%29%3B%0A%20%20%20%20let%20key%20%3D%20%22%22%3B%0A%20%20%20%20let%20staticVao%20%3D%20true%3B%0A%20%20%20%20gl.bindVertexArray%28vaoGPU%29%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20indexData%20%3D%20this.get%28index5%29%3B%0A%20%20%20%20%20%20gl.bindBuffer%28gl.ELEMENT_ARRAY_BUFFER%2C%20indexData.bufferGPU%29%3B%0A%20%20%20%20%20%20key%20%2B%3D%20%22%3A%22%20%2B%20indexData.id%3B%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20attributes.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bi%5D%3B%0A%20%20%20%20%20%20const%20attributeData%20%3D%20this.get%28attribute2%29%3B%0A%20%20%20%20%20%20key%20%2B%3D%20%22%3A%22%20%2B%20attributeData.id%3B%0A%20%20%20%20%20%20gl.bindBuffer%28gl.ARRAY_BUFFER%2C%20attributeData.bufferGPU%29%3B%0A%20%20%20%20%20%20gl.enableVertexAttribArray%28i%29%3B%0A%20%20%20%20%20%20if%20%28attribute2.isStorageBufferAttribute%20%7C%7C%20attribute2.isStorageInstancedBufferAttribute%29%20staticVao%20%3D%20false%3B%0A%20%20%20%20%20%20let%20stride%2C%20offset%3B%0A%20%20%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20stride%20%3D%20attribute2.data.stride%20%2A%20attributeData.bytesPerElement%3B%0A%20%20%20%20%20%20%20%20offset%20%3D%20attribute2.offset%20%2A%20attributeData.bytesPerElement%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20stride%20%3D%200%3B%0A%20%20%20%20%20%20%20%20offset%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28attributeData.isInteger%29%20%7B%0A%20%20%20%20%20%20%20%20gl.vertexAttribIPointer%28i%2C%20attribute2.itemSize%2C%20attributeData.type%2C%20stride%2C%20offset%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20gl.vertexAttribPointer%28i%2C%20attribute2.itemSize%2C%20attributeData.type%2C%20attribute2.normalized%2C%20stride%2C%20offset%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28attribute2.isInstancedBufferAttribute%20%26%26%20%21attribute2.isInterleavedBufferAttribute%29%20%7B%0A%20%20%20%20%20%20%20%20gl.vertexAttribDivisor%28i%2C%20attribute2.meshPerAttribute%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28attribute2.isInterleavedBufferAttribute%20%26%26%20attribute2.data.isInstancedInterleavedBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20gl.vertexAttribDivisor%28i%2C%20attribute2.data.meshPerAttribute%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20gl.bindBuffer%28gl.ARRAY_BUFFER%2C%20null%29%3B%0A%20%20%20%20this.vaoCache%5Bkey%5D%20%3D%20vaoGPU%3B%0A%20%20%20%20return%20%7B%20vaoGPU%2C%20staticVao%20%7D%3B%0A%20%20%7D%0A%20%20_getTransformFeedback%28transformBuffers%29%20%7B%0A%20%20%20%20let%20key%20%3D%20%22%22%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20transformBuffers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20key%20%2B%3D%20%22%3A%22%20%2B%20transformBuffers%5Bi%5D.id%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20transformFeedbackGPU%20%3D%20this.transformFeedbackCache%5Bkey%5D%3B%0A%20%20%20%20if%20%28transformFeedbackGPU%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20return%20transformFeedbackGPU%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20%7B%20gl%20%7D%20%3D%20this%3B%0A%20%20%20%20transformFeedbackGPU%20%3D%20gl.createTransformFeedback%28%29%3B%0A%20%20%20%20gl.bindTransformFeedback%28gl.TRANSFORM_FEEDBACK%2C%20transformFeedbackGPU%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20transformBuffers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20attributeData%20%3D%20transformBuffers%5Bi%5D%3B%0A%20%20%20%20%20%20gl.bindBufferBase%28gl.TRANSFORM_FEEDBACK_BUFFER%2C%20i%2C%20attributeData.transformBuffer%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20gl.bindTransformFeedback%28gl.TRANSFORM_FEEDBACK%2C%20null%29%3B%0A%20%20%20%20this.transformFeedbackCache%5Bkey%5D%20%3D%20transformFeedbackGPU%3B%0A%20%20%20%20return%20transformFeedbackGPU%3B%0A%20%20%7D%0A%20%20_setupBindings%28bindings%2C%20programGPU%29%20%7B%0A%20%20%20%20const%20gl%20%3D%20this.gl%3B%0A%20%20%20%20for%20%28const%20bindGroup%20of%20bindings%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20binding%20of%20bindGroup.bindings%29%20%7B%0A%20%20%20%20%20%20%20%20const%20bindingData%20%3D%20this.get%28binding%29%3B%0A%20%20%20%20%20%20%20%20const%20index5%20%3D%20bindingData.index%3B%0A%20%20%20%20%20%20%20%20if%20%28binding.isUniformsGroup%20%7C%7C%20binding.isUniformBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20location%20%3D%20gl.getUniformBlockIndex%28programGPU%2C%20binding.name%29%3B%0A%20%20%20%20%20%20%20%20%20%20gl.uniformBlockBinding%28programGPU%2C%20location%2C%20index5%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20location%20%3D%20gl.getUniformLocation%28programGPU%2C%20binding.name%29%3B%0A%20%20%20%20%20%20%20%20%20%20gl.uniform1i%28location%2C%20index5%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_bindUniforms%28bindings%29%20%7B%0A%20%20%20%20const%20%7B%20gl%2C%20state%20%7D%20%3D%20this%3B%0A%20%20%20%20for%20%28const%20bindGroup%20of%20bindings%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20binding%20of%20bindGroup.bindings%29%20%7B%0A%20%20%20%20%20%20%20%20const%20bindingData%20%3D%20this.get%28binding%29%3B%0A%20%20%20%20%20%20%20%20const%20index5%20%3D%20bindingData.index%3B%0A%20%20%20%20%20%20%20%20if%20%28binding.isUniformsGroup%20%7C%7C%20binding.isUniformBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.bindBufferBase%28gl.UNIFORM_BUFFER%2C%20index5%2C%20bindingData.bufferGPU%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.bindTexture%28bindingData.glTextureType%2C%20bindingData.textureGPU%2C%20gl.TEXTURE0%20%2B%20index5%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.renderer.domElement.removeEventListener%28%22webglcontextlost%22%2C%20this._onContextLost%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20Sampler%20%3D%20class%20extends%20Binding%20%7B%0A%20%20constructor%28name%2C%20texture2%29%20%7B%0A%20%20%20%20super%28name%29%3B%0A%20%20%20%20this.texture%20%3D%20texture2%3B%0A%20%20%20%20this.version%20%3D%20texture2%20%3F%20texture2.version%20%3A%200%3B%0A%20%20%20%20this.isSampler%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20NodeSampler%20%3D%20class%20extends%20Sampler%20%7B%0A%20%20constructor%28name%2C%20textureNode%2C%20groupNode%29%20%7B%0A%20%20%20%20super%28name%2C%20textureNode%20%3F%20textureNode.value%20%3A%20null%29%3B%0A%20%20%20%20this.textureNode%20%3D%20textureNode%3B%0A%20%20%20%20this.groupNode%20%3D%20groupNode%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20this.texture%20%3D%20this.textureNode.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20StorageBuffer%20%3D%20class%20extends%20Buffer2%20%7B%0A%20%20constructor%28name%2C%20attribute2%29%20%7B%0A%20%20%20%20super%28name%2C%20attribute2%20%3F%20attribute2.array%20%3A%20null%29%3B%0A%20%20%20%20this.attribute%20%3D%20attribute2%3B%0A%20%20%20%20this.isStorageBuffer%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_id%20%3D%200%3B%0Avar%20NodeStorageBuffer%20%3D%20class%20extends%20StorageBuffer%20%7B%0A%20%20constructor%28nodeUniform%2C%20groupNode%29%20%7B%0A%20%20%20%20super%28%22StorageBuffer_%22%20%2B%20_id%2B%2B%2C%20nodeUniform%20%3F%20nodeUniform.value%20%3A%20null%29%3B%0A%20%20%20%20this.nodeUniform%20%3D%20nodeUniform%3B%0A%20%20%20%20this.access%20%3D%20nodeUniform%20%3F%20nodeUniform.access%20%3A%20GPUBufferBindingType.Storage%3B%0A%20%20%20%20this.groupNode%20%3D%20groupNode%3B%0A%20%20%7D%0A%20%20get%20buffer%28%29%20%7B%0A%20%20%20%20return%20this.nodeUniform.value%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGPUTexturePassUtils%20%3D%20class%20extends%20DataMap%20%7B%0A%20%20constructor%28device%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.device%20%3D%20device%3B%0A%20%20%20%20const%20mipmapVertexSource%20%3D%20%60%0Astruct%20VarysStruct%20%7B%0A%09%40builtin%28%20position%20%29%20Position%3A%20vec4%3Cf32%3E%2C%0A%09%40location%28%200%20%29%20vTex%20%3A%20vec2%3Cf32%3E%0A%7D%3B%0A%0A%40vertex%0Afn%20main%28%20%40builtin%28%20vertex_index%20%29%20vertexIndex%20%3A%20u32%20%29%20-%3E%20VarysStruct%20%7B%0A%0A%09var%20Varys%20%3A%20VarysStruct%3B%0A%0A%09var%20pos%20%3D%20array%3C%20vec2%3Cf32%3E%2C%204%20%3E%28%0A%09%09vec2%3Cf32%3E%28%20-1.0%2C%20%201.0%20%29%2C%0A%09%09vec2%3Cf32%3E%28%20%201.0%2C%20%201.0%20%29%2C%0A%09%09vec2%3Cf32%3E%28%20-1.0%2C%20-1.0%20%29%2C%0A%09%09vec2%3Cf32%3E%28%20%201.0%2C%20-1.0%20%29%0A%09%29%3B%0A%0A%09var%20tex%20%3D%20array%3C%20vec2%3Cf32%3E%2C%204%20%3E%28%0A%09%09vec2%3Cf32%3E%28%200.0%2C%200.0%20%29%2C%0A%09%09vec2%3Cf32%3E%28%201.0%2C%200.0%20%29%2C%0A%09%09vec2%3Cf32%3E%28%200.0%2C%201.0%20%29%2C%0A%09%09vec2%3Cf32%3E%28%201.0%2C%201.0%20%29%0A%09%29%3B%0A%0A%09Varys.vTex%20%3D%20tex%5B%20vertexIndex%20%5D%3B%0A%09Varys.Position%20%3D%20vec4%3Cf32%3E%28%20pos%5B%20vertexIndex%20%5D%2C%200.0%2C%201.0%20%29%3B%0A%0A%09return%20Varys%3B%0A%0A%7D%0A%60%3B%0A%20%20%20%20const%20mipmapFragmentSource%20%3D%20%60%0A%40group%28%200%20%29%20%40binding%28%200%20%29%0Avar%20imgSampler%20%3A%20sampler%3B%0A%0A%40group%28%200%20%29%20%40binding%28%201%20%29%0Avar%20img%20%3A%20texture_2d%3Cf32%3E%3B%0A%0A%40fragment%0Afn%20main%28%20%40location%28%200%20%29%20vTex%20%3A%20vec2%3Cf32%3E%20%29%20-%3E%20%40location%28%200%20%29%20vec4%3Cf32%3E%20%7B%0A%0A%09return%20textureSample%28%20img%2C%20imgSampler%2C%20vTex%20%29%3B%0A%0A%7D%0A%60%3B%0A%20%20%20%20const%20flipYFragmentSource%20%3D%20%60%0A%40group%28%200%20%29%20%40binding%28%200%20%29%0Avar%20imgSampler%20%3A%20sampler%3B%0A%0A%40group%28%200%20%29%20%40binding%28%201%20%29%0Avar%20img%20%3A%20texture_2d%3Cf32%3E%3B%0A%0A%40fragment%0Afn%20main%28%20%40location%28%200%20%29%20vTex%20%3A%20vec2%3Cf32%3E%20%29%20-%3E%20%40location%28%200%20%29%20vec4%3Cf32%3E%20%7B%0A%0A%09return%20textureSample%28%20img%2C%20imgSampler%2C%20vec2%28%20vTex.x%2C%201.0%20-%20vTex.y%20%29%20%29%3B%0A%0A%7D%0A%60%3B%0A%20%20%20%20this.mipmapSampler%20%3D%20device.createSampler%28%7B%20minFilter%3A%20GPUFilterMode.Linear%20%7D%29%3B%0A%20%20%20%20this.flipYSampler%20%3D%20device.createSampler%28%7B%20minFilter%3A%20GPUFilterMode.Nearest%20%7D%29%3B%0A%20%20%20%20this.transferPipelines%20%3D%20%7B%7D%3B%0A%20%20%20%20this.flipYPipelines%20%3D%20%7B%7D%3B%0A%20%20%20%20this.mipmapVertexShaderModule%20%3D%20device.createShaderModule%28%7B%0A%20%20%20%20%20%20label%3A%20%22mipmapVertex%22%2C%0A%20%20%20%20%20%20code%3A%20mipmapVertexSource%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.mipmapFragmentShaderModule%20%3D%20device.createShaderModule%28%7B%0A%20%20%20%20%20%20label%3A%20%22mipmapFragment%22%2C%0A%20%20%20%20%20%20code%3A%20mipmapFragmentSource%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.flipYFragmentShaderModule%20%3D%20device.createShaderModule%28%7B%0A%20%20%20%20%20%20label%3A%20%22flipYFragment%22%2C%0A%20%20%20%20%20%20code%3A%20flipYFragmentSource%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20getTransferPipeline%28format2%29%20%7B%0A%20%20%20%20let%20pipeline%20%3D%20this.transferPipelines%5Bformat2%5D%3B%0A%20%20%20%20if%20%28pipeline%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20pipeline%20%3D%20this.device.createRenderPipeline%28%7B%0A%20%20%20%20%20%20%20%20label%3A%20%60mipmap-%24%7Bformat2%7D%60%2C%0A%20%20%20%20%20%20%20%20vertex%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20module%3A%20this.mipmapVertexShaderModule%2C%0A%20%20%20%20%20%20%20%20%20%20entryPoint%3A%20%22main%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20fragment%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20module%3A%20this.mipmapFragmentShaderModule%2C%0A%20%20%20%20%20%20%20%20%20%20entryPoint%3A%20%22main%22%2C%0A%20%20%20%20%20%20%20%20%20%20targets%3A%20%5B%7B%20format%3A%20format2%20%7D%5D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20primitive%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20topology%3A%20GPUPrimitiveTopology.TriangleStrip%2C%0A%20%20%20%20%20%20%20%20%20%20stripIndexFormat%3A%20GPUIndexFormat.Uint32%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20layout%3A%20%22auto%22%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20this.transferPipelines%5Bformat2%5D%20%3D%20pipeline%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20pipeline%3B%0A%20%20%7D%0A%20%20getFlipYPipeline%28format2%29%20%7B%0A%20%20%20%20let%20pipeline%20%3D%20this.flipYPipelines%5Bformat2%5D%3B%0A%20%20%20%20if%20%28pipeline%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20pipeline%20%3D%20this.device.createRenderPipeline%28%7B%0A%20%20%20%20%20%20%20%20label%3A%20%60flipY-%24%7Bformat2%7D%60%2C%0A%20%20%20%20%20%20%20%20vertex%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20module%3A%20this.mipmapVertexShaderModule%2C%0A%20%20%20%20%20%20%20%20%20%20entryPoint%3A%20%22main%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20fragment%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20module%3A%20this.flipYFragmentShaderModule%2C%0A%20%20%20%20%20%20%20%20%20%20entryPoint%3A%20%22main%22%2C%0A%20%20%20%20%20%20%20%20%20%20targets%3A%20%5B%7B%20format%3A%20format2%20%7D%5D%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20primitive%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20topology%3A%20GPUPrimitiveTopology.TriangleStrip%2C%0A%20%20%20%20%20%20%20%20%20%20stripIndexFormat%3A%20GPUIndexFormat.Uint32%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20layout%3A%20%22auto%22%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20this.flipYPipelines%5Bformat2%5D%20%3D%20pipeline%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20pipeline%3B%0A%20%20%7D%0A%20%20flipY%28textureGPU%2C%20textureGPUDescriptor%2C%20baseArrayLayer%20%3D%200%29%20%7B%0A%20%20%20%20const%20format2%20%3D%20textureGPUDescriptor.format%3B%0A%20%20%20%20const%20%7B%20width%2C%20height%20%7D%20%3D%20textureGPUDescriptor.size%3B%0A%20%20%20%20const%20transferPipeline%20%3D%20this.getTransferPipeline%28format2%29%3B%0A%20%20%20%20const%20flipYPipeline%20%3D%20this.getFlipYPipeline%28format2%29%3B%0A%20%20%20%20const%20tempTexture%20%3D%20this.device.createTexture%28%7B%0A%20%20%20%20%20%20size%3A%20%7B%20width%2C%20height%2C%20depthOrArrayLayers%3A%201%20%7D%2C%0A%20%20%20%20%20%20format%3A%20format2%2C%0A%20%20%20%20%20%20usage%3A%20GPUTextureUsage.RENDER_ATTACHMENT%20%7C%20GPUTextureUsage.TEXTURE_BINDING%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20srcView%20%3D%20textureGPU.createView%28%7B%0A%20%20%20%20%20%20baseMipLevel%3A%200%2C%0A%20%20%20%20%20%20mipLevelCount%3A%201%2C%0A%20%20%20%20%20%20dimension%3A%20GPUTextureViewDimension.TwoD%2C%0A%20%20%20%20%20%20baseArrayLayer%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20dstView%20%3D%20tempTexture.createView%28%7B%0A%20%20%20%20%20%20baseMipLevel%3A%200%2C%0A%20%20%20%20%20%20mipLevelCount%3A%201%2C%0A%20%20%20%20%20%20dimension%3A%20GPUTextureViewDimension.TwoD%2C%0A%20%20%20%20%20%20baseArrayLayer%3A%200%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20commandEncoder%20%3D%20this.device.createCommandEncoder%28%7B%7D%29%3B%0A%20%20%20%20const%20pass%20%3D%20%28pipeline%2C%20sourceView%2C%20destinationView%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20bindGroupLayout%20%3D%20pipeline.getBindGroupLayout%280%29%3B%0A%20%20%20%20%20%20const%20bindGroup%20%3D%20this.device.createBindGroup%28%7B%0A%20%20%20%20%20%20%20%20layout%3A%20bindGroupLayout%2C%0A%20%20%20%20%20%20%20%20entries%3A%20%5B%7B%0A%20%20%20%20%20%20%20%20%20%20binding%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20resource%3A%20this.flipYSampler%0A%20%20%20%20%20%20%20%20%7D%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20binding%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20resource%3A%20sourceView%0A%20%20%20%20%20%20%20%20%7D%5D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20const%20passEncoder%20%3D%20commandEncoder.beginRenderPass%28%7B%0A%20%20%20%20%20%20%20%20colorAttachments%3A%20%5B%7B%0A%20%20%20%20%20%20%20%20%20%20view%3A%20destinationView%2C%0A%20%20%20%20%20%20%20%20%20%20loadOp%3A%20GPULoadOp.Clear%2C%0A%20%20%20%20%20%20%20%20%20%20storeOp%3A%20GPUStoreOp.Store%2C%0A%20%20%20%20%20%20%20%20%20%20clearValue%3A%20%5B0%2C%200%2C%200%2C%200%5D%0A%20%20%20%20%20%20%20%20%7D%5D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20passEncoder.setPipeline%28pipeline%29%3B%0A%20%20%20%20%20%20passEncoder.setBindGroup%280%2C%20bindGroup%29%3B%0A%20%20%20%20%20%20passEncoder.draw%284%2C%201%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20passEncoder.end%28%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20pass%28transferPipeline%2C%20srcView%2C%20dstView%29%3B%0A%20%20%20%20pass%28flipYPipeline%2C%20dstView%2C%20srcView%29%3B%0A%20%20%20%20this.device.queue.submit%28%5BcommandEncoder.finish%28%29%5D%29%3B%0A%20%20%20%20tempTexture.destroy%28%29%3B%0A%20%20%7D%0A%20%20generateMipmaps%28textureGPU%2C%20textureGPUDescriptor%2C%20baseArrayLayer%20%3D%200%29%20%7B%0A%20%20%20%20const%20textureData%20%3D%20this.get%28textureGPU%29%3B%0A%20%20%20%20if%20%28textureData.useCount%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20textureData.useCount%20%3D%200%3B%0A%20%20%20%20%20%20textureData.layers%20%3D%20%5B%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20passes%20%3D%20textureData.layers%5BbaseArrayLayer%5D%20%7C%7C%20this._mipmapCreateBundles%28textureGPU%2C%20textureGPUDescriptor%2C%20baseArrayLayer%29%3B%0A%20%20%20%20const%20commandEncoder%20%3D%20this.device.createCommandEncoder%28%7B%7D%29%3B%0A%20%20%20%20this._mipmapRunBundles%28commandEncoder%2C%20passes%29%3B%0A%20%20%20%20this.device.queue.submit%28%5BcommandEncoder.finish%28%29%5D%29%3B%0A%20%20%20%20if%20%28textureData.useCount%20%21%3D%3D%200%29%20textureData.layers%5BbaseArrayLayer%5D%20%3D%20passes%3B%0A%20%20%20%20textureData.useCount%2B%2B%3B%0A%20%20%7D%0A%20%20_mipmapCreateBundles%28textureGPU%2C%20textureGPUDescriptor%2C%20baseArrayLayer%29%20%7B%0A%20%20%20%20const%20pipeline%20%3D%20this.getTransferPipeline%28textureGPUDescriptor.format%29%3B%0A%20%20%20%20const%20bindGroupLayout%20%3D%20pipeline.getBindGroupLayout%280%29%3B%0A%20%20%20%20let%20srcView%20%3D%20textureGPU.createView%28%7B%0A%20%20%20%20%20%20baseMipLevel%3A%200%2C%0A%20%20%20%20%20%20mipLevelCount%3A%201%2C%0A%20%20%20%20%20%20dimension%3A%20GPUTextureViewDimension.TwoD%2C%0A%20%20%20%20%20%20baseArrayLayer%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20passes%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%20textureGPUDescriptor.mipLevelCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20bindGroup%20%3D%20this.device.createBindGroup%28%7B%0A%20%20%20%20%20%20%20%20layout%3A%20bindGroupLayout%2C%0A%20%20%20%20%20%20%20%20entries%3A%20%5B%7B%0A%20%20%20%20%20%20%20%20%20%20binding%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20resource%3A%20this.mipmapSampler%0A%20%20%20%20%20%20%20%20%7D%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20binding%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20resource%3A%20srcView%0A%20%20%20%20%20%20%20%20%7D%5D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20const%20dstView%20%3D%20textureGPU.createView%28%7B%0A%20%20%20%20%20%20%20%20baseMipLevel%3A%20i%2C%0A%20%20%20%20%20%20%20%20mipLevelCount%3A%201%2C%0A%20%20%20%20%20%20%20%20dimension%3A%20GPUTextureViewDimension.TwoD%2C%0A%20%20%20%20%20%20%20%20baseArrayLayer%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20const%20passDescriptor%20%3D%20%7B%0A%20%20%20%20%20%20%20%20colorAttachments%3A%20%5B%7B%0A%20%20%20%20%20%20%20%20%20%20view%3A%20dstView%2C%0A%20%20%20%20%20%20%20%20%20%20loadOp%3A%20GPULoadOp.Clear%2C%0A%20%20%20%20%20%20%20%20%20%20storeOp%3A%20GPUStoreOp.Store%2C%0A%20%20%20%20%20%20%20%20%20%20clearValue%3A%20%5B0%2C%200%2C%200%2C%200%5D%0A%20%20%20%20%20%20%20%20%7D%5D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20const%20passEncoder%20%3D%20this.device.createRenderBundleEncoder%28%7B%0A%20%20%20%20%20%20%20%20colorFormats%3A%20%5BtextureGPUDescriptor.format%5D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20passEncoder.setPipeline%28pipeline%29%3B%0A%20%20%20%20%20%20passEncoder.setBindGroup%280%2C%20bindGroup%29%3B%0A%20%20%20%20%20%20passEncoder.draw%284%2C%201%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20passes.push%28%7B%0A%20%20%20%20%20%20%20%20renderBundles%3A%20%5BpassEncoder.finish%28%29%5D%2C%0A%20%20%20%20%20%20%20%20passDescriptor%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20srcView%20%3D%20dstView%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20passes%3B%0A%20%20%7D%0A%20%20_mipmapRunBundles%28commandEncoder%2C%20passes%29%20%7B%0A%20%20%20%20const%20levels%20%3D%20passes.length%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20levels%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20pass%20%3D%20passes%5Bi%5D%3B%0A%20%20%20%20%20%20const%20passEncoder%20%3D%20commandEncoder.beginRenderPass%28pass.passDescriptor%29%3B%0A%20%20%20%20%20%20passEncoder.executeBundles%28pass.renderBundles%29%3B%0A%20%20%20%20%20%20passEncoder.end%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20_compareToWebGPU%20%3D%20%7B%0A%20%20%5BNeverCompare2%5D%3A%20%22never%22%2C%0A%20%20%5BLessCompare2%5D%3A%20%22less%22%2C%0A%20%20%5BEqualCompare2%5D%3A%20%22equal%22%2C%0A%20%20%5BLessEqualCompare2%5D%3A%20%22less-equal%22%2C%0A%20%20%5BGreaterCompare2%5D%3A%20%22greater%22%2C%0A%20%20%5BGreaterEqualCompare2%5D%3A%20%22greater-equal%22%2C%0A%20%20%5BAlwaysCompare2%5D%3A%20%22always%22%2C%0A%20%20%5BNotEqualCompare2%5D%3A%20%22not-equal%22%0A%7D%3B%0Avar%20_flipMap%20%3D%20%5B0%2C%201%2C%203%2C%202%2C%204%2C%205%5D%3B%0Avar%20WebGPUTextureUtils%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this._passUtils%20%3D%20null%3B%0A%20%20%20%20this.defaultTexture%20%3D%20%7B%7D%3B%0A%20%20%20%20this.defaultCubeTexture%20%3D%20%7B%7D%3B%0A%20%20%20%20this.defaultVideoFrame%20%3D%20null%3B%0A%20%20%20%20this.colorBuffer%20%3D%20null%3B%0A%20%20%20%20this.depthTexture%20%3D%20new%20DepthTexture2%28%29%3B%0A%20%20%20%20this.depthTexture.name%20%3D%20%22depthBuffer%22%3B%0A%20%20%7D%0A%20%20createSampler%28texture2%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20device%20%3D%20backend.device%3B%0A%20%20%20%20const%20textureGPU%20%3D%20backend.get%28texture2%29%3B%0A%20%20%20%20const%20samplerDescriptorGPU%20%3D%20%7B%0A%20%20%20%20%20%20addressModeU%3A%20this._convertAddressMode%28texture2.wrapS%29%2C%0A%20%20%20%20%20%20addressModeV%3A%20this._convertAddressMode%28texture2.wrapT%29%2C%0A%20%20%20%20%20%20addressModeW%3A%20this._convertAddressMode%28texture2.wrapR%29%2C%0A%20%20%20%20%20%20magFilter%3A%20this._convertFilterMode%28texture2.magFilter%29%2C%0A%20%20%20%20%20%20minFilter%3A%20this._convertFilterMode%28texture2.minFilter%29%2C%0A%20%20%20%20%20%20mipmapFilter%3A%20this._convertFilterMode%28texture2.minFilter%29%2C%0A%20%20%20%20%20%20maxAnisotropy%3A%201%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28samplerDescriptorGPU.magFilter%20%3D%3D%3D%20GPUFilterMode.Linear%20%26%26%20samplerDescriptorGPU.minFilter%20%3D%3D%3D%20GPUFilterMode.Linear%20%26%26%20samplerDescriptorGPU.mipmapFilter%20%3D%3D%3D%20GPUFilterMode.Linear%29%20%7B%0A%20%20%20%20%20%20samplerDescriptorGPU.maxAnisotropy%20%3D%20texture2.anisotropy%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28texture2.isDepthTexture%20%26%26%20texture2.compareFunction%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20samplerDescriptorGPU.compare%20%3D%20_compareToWebGPU%5Btexture2.compareFunction%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20textureGPU.sampler%20%3D%20device.createSampler%28samplerDescriptorGPU%29%3B%0A%20%20%7D%0A%20%20createDefaultTexture%28texture2%29%20%7B%0A%20%20%20%20let%20textureGPU%3B%0A%20%20%20%20const%20format2%20%3D%20getFormat2%28texture2%29%3B%0A%20%20%20%20if%20%28texture2.isCubeTexture%29%20%7B%0A%20%20%20%20%20%20textureGPU%20%3D%20this._getDefaultCubeTextureGPU%28format2%29%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isVideoTexture%29%20%7B%0A%20%20%20%20%20%20this.backend.get%28texture2%29.externalTexture%20%3D%20this._getDefaultVideoFrame%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20textureGPU%20%3D%20this._getDefaultTextureGPU%28format2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.backend.get%28texture2%29.texture%20%3D%20textureGPU%3B%0A%20%20%7D%0A%20%20createTexture%28texture2%2C%20options%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20textureData%20%3D%20backend.get%28texture2%29%3B%0A%20%20%20%20if%20%28textureData.initialized%29%20%7B%0A%20%20%20%20%20%20throw%20new%20Error%28%22WebGPUTextureUtils%3A%20Texture%20already%20initialized.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28options.needsMipmaps%20%3D%3D%3D%20void%200%29%20options.needsMipmaps%20%3D%20false%3B%0A%20%20%20%20if%20%28options.levels%20%3D%3D%3D%20void%200%29%20options.levels%20%3D%201%3B%0A%20%20%20%20if%20%28options.depth%20%3D%3D%3D%20void%200%29%20options.depth%20%3D%201%3B%0A%20%20%20%20const%20%7B%20width%2C%20height%2C%20depth%3A%20depth2%2C%20levels%20%7D%20%3D%20options%3B%0A%20%20%20%20if%20%28texture2.isFramebufferTexture%29%20%7B%0A%20%20%20%20%20%20if%20%28options.renderTarget%29%20%7B%0A%20%20%20%20%20%20%20%20options.format%20%3D%20this.backend.utils.getCurrentColorFormat%28options.renderTarget%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20options.format%20%3D%20this.backend.utils.getPreferredCanvasFormat%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20dimension%20%3D%20this._getDimension%28texture2%29%3B%0A%20%20%20%20const%20format2%20%3D%20texture2.internalFormat%20%7C%7C%20options.format%20%7C%7C%20getFormat2%28texture2%2C%20backend.device%29%3B%0A%20%20%20%20textureData.format%20%3D%20format2%3B%0A%20%20%20%20let%20sampleCount%20%3D%20options.sampleCount%20%21%3D%3D%20void%200%20%3F%20options.sampleCount%20%3A%201%3B%0A%20%20%20%20sampleCount%20%3D%20backend.utils.getSampleCount%28sampleCount%29%3B%0A%20%20%20%20const%20primarySampleCount%20%3D%20texture2.isRenderTargetTexture%20%26%26%20%21texture2.isMultisampleRenderTargetTexture%20%3F%201%20%3A%20sampleCount%3B%0A%20%20%20%20let%20usage%20%3D%20GPUTextureUsage.TEXTURE_BINDING%20%7C%20GPUTextureUsage.COPY_DST%20%7C%20GPUTextureUsage.COPY_SRC%3B%0A%20%20%20%20if%20%28texture2.isStorageTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20usage%20%7C%3D%20GPUTextureUsage.STORAGE_BINDING%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28texture2.isCompressedTexture%20%21%3D%3D%20true%20%26%26%20texture2.isCompressedArrayTexture%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20usage%20%7C%3D%20GPUTextureUsage.RENDER_ATTACHMENT%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20textureDescriptorGPU%20%3D%20%7B%0A%20%20%20%20%20%20label%3A%20texture2.name%2C%0A%20%20%20%20%20%20size%3A%20%7B%0A%20%20%20%20%20%20%20%20width%2C%0A%20%20%20%20%20%20%20%20height%2C%0A%20%20%20%20%20%20%20%20depthOrArrayLayers%3A%20depth2%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20mipLevelCount%3A%20levels%2C%0A%20%20%20%20%20%20sampleCount%3A%20primarySampleCount%2C%0A%20%20%20%20%20%20dimension%2C%0A%20%20%20%20%20%20format%3A%20format2%2C%0A%20%20%20%20%20%20usage%0A%20%20%20%20%7D%3B%0A%20%20%20%20if%20%28texture2.isVideoTexture%29%20%7B%0A%20%20%20%20%20%20const%20video%20%3D%20texture2.source.data%3B%0A%20%20%20%20%20%20const%20videoFrame%20%3D%20new%20VideoFrame%28video%29%3B%0A%20%20%20%20%20%20textureDescriptorGPU.size.width%20%3D%20videoFrame.displayWidth%3B%0A%20%20%20%20%20%20textureDescriptorGPU.size.height%20%3D%20videoFrame.displayHeight%3B%0A%20%20%20%20%20%20videoFrame.close%28%29%3B%0A%20%20%20%20%20%20textureData.externalTexture%20%3D%20video%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28format2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22WebGPURenderer%3A%20Texture%20format%20not%20supported.%22%29%3B%0A%20%20%20%20%20%20%20%20return%20this.createDefaultTexture%28texture2%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20textureData.texture%20%3D%20backend.device.createTexture%28textureDescriptorGPU%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28texture2.isRenderTargetTexture%20%26%26%20sampleCount%20%3E%201%20%26%26%20%21texture2.isMultisampleRenderTargetTexture%29%20%7B%0A%20%20%20%20%20%20const%20msaaTextureDescriptorGPU%20%3D%20Object.assign%28%7B%7D%2C%20textureDescriptorGPU%29%3B%0A%20%20%20%20%20%20msaaTextureDescriptorGPU.label%20%3D%20msaaTextureDescriptorGPU.label%20%2B%20%22-msaa%22%3B%0A%20%20%20%20%20%20msaaTextureDescriptorGPU.sampleCount%20%3D%20sampleCount%3B%0A%20%20%20%20%20%20textureData.msaaTexture%20%3D%20backend.device.createTexture%28msaaTextureDescriptorGPU%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20textureData.initialized%20%3D%20true%3B%0A%20%20%20%20textureData.textureDescriptorGPU%20%3D%20textureDescriptorGPU%3B%0A%20%20%7D%0A%20%20destroyTexture%28texture2%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20textureData%20%3D%20backend.get%28texture2%29%3B%0A%20%20%20%20textureData.texture.destroy%28%29%3B%0A%20%20%20%20if%20%28textureData.msaaTexture%20%21%3D%3D%20void%200%29%20textureData.msaaTexture.destroy%28%29%3B%0A%20%20%20%20backend.delete%28texture2%29%3B%0A%20%20%7D%0A%20%20destroySampler%28texture2%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20textureData%20%3D%20backend.get%28texture2%29%3B%0A%20%20%20%20delete%20textureData.sampler%3B%0A%20%20%7D%0A%20%20generateMipmaps%28texture2%29%20%7B%0A%20%20%20%20const%20textureData%20%3D%20this.backend.get%28texture2%29%3B%0A%20%20%20%20if%20%28texture2.isCubeTexture%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this._generateMipmaps%28textureData.texture%2C%20textureData.textureDescriptorGPU%2C%20i%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20depth2%20%3D%20texture2.image.depth%20%7C%7C%201%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20depth2%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this._generateMipmaps%28textureData.texture%2C%20textureData.textureDescriptorGPU%2C%20i%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getColorBuffer%28%29%20%7B%0A%20%20%20%20if%20%28this.colorBuffer%29%20this.colorBuffer.destroy%28%29%3B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20%7B%20width%2C%20height%20%7D%20%3D%20backend.getDrawingBufferSize%28%29%3B%0A%20%20%20%20this.colorBuffer%20%3D%20backend.device.createTexture%28%7B%0A%20%20%20%20%20%20label%3A%20%22colorBuffer%22%2C%0A%20%20%20%20%20%20size%3A%20%7B%0A%20%20%20%20%20%20%20%20width%2C%0A%20%20%20%20%20%20%20%20height%2C%0A%20%20%20%20%20%20%20%20depthOrArrayLayers%3A%201%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20sampleCount%3A%20backend.utils.getSampleCount%28backend.renderer.samples%29%2C%0A%20%20%20%20%20%20format%3A%20backend.utils.getPreferredCanvasFormat%28%29%2C%0A%20%20%20%20%20%20usage%3A%20GPUTextureUsage.RENDER_ATTACHMENT%20%7C%20GPUTextureUsage.COPY_SRC%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20return%20this.colorBuffer%3B%0A%20%20%7D%0A%20%20getDepthBuffer%28depth2%20%3D%20true%2C%20stencil%20%3D%20false%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20%7B%20width%2C%20height%20%7D%20%3D%20backend.getDrawingBufferSize%28%29%3B%0A%20%20%20%20const%20depthTexture%20%3D%20this.depthTexture%3B%0A%20%20%20%20const%20depthTextureGPU%20%3D%20backend.get%28depthTexture%29.texture%3B%0A%20%20%20%20let%20format2%2C%20type%3B%0A%20%20%20%20if%20%28stencil%29%20%7B%0A%20%20%20%20%20%20format2%20%3D%20DepthStencilFormat2%3B%0A%20%20%20%20%20%20type%20%3D%20UnsignedInt248Type2%3B%0A%20%20%20%20%7D%20else%20if%20%28depth2%29%20%7B%0A%20%20%20%20%20%20format2%20%3D%20DepthFormat2%3B%0A%20%20%20%20%20%20type%20%3D%20UnsignedIntType2%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28depthTextureGPU%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28depthTexture.image.width%20%3D%3D%3D%20width%20%26%26%20depthTexture.image.height%20%3D%3D%3D%20height%20%26%26%20depthTexture.format%20%3D%3D%3D%20format2%20%26%26%20depthTexture.type%20%3D%3D%3D%20type%29%20%7B%0A%20%20%20%20%20%20%20%20return%20depthTextureGPU%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.destroyTexture%28depthTexture%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20depthTexture.name%20%3D%20%22depthBuffer%22%3B%0A%20%20%20%20depthTexture.format%20%3D%20format2%3B%0A%20%20%20%20depthTexture.type%20%3D%20type%3B%0A%20%20%20%20depthTexture.image.width%20%3D%20width%3B%0A%20%20%20%20depthTexture.image.height%20%3D%20height%3B%0A%20%20%20%20this.createTexture%28depthTexture%2C%20%7B%20sampleCount%3A%20backend.utils.getSampleCount%28backend.renderer.samples%29%2C%20width%2C%20height%20%7D%29%3B%0A%20%20%20%20return%20backend.get%28depthTexture%29.texture%3B%0A%20%20%7D%0A%20%20updateTexture%28texture2%2C%20options%29%20%7B%0A%20%20%20%20const%20textureData%20%3D%20this.backend.get%28texture2%29%3B%0A%20%20%20%20const%20%7B%20textureDescriptorGPU%20%7D%20%3D%20textureData%3B%0A%20%20%20%20if%20%28texture2.isRenderTargetTexture%20%7C%7C%20textureDescriptorGPU%20%3D%3D%3D%20void%200%29%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20if%20%28texture2.isDataTexture%29%20%7B%0A%20%20%20%20%20%20this._copyBufferToTexture%28options.image%2C%20textureData.texture%2C%20textureDescriptorGPU%2C%200%2C%20texture2.flipY%29%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isDataArrayTexture%20%7C%7C%20texture2.isData3DTexture%29%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20options.image.depth%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this._copyBufferToTexture%28options.image%2C%20textureData.texture%2C%20textureDescriptorGPU%2C%20i%2C%20texture2.flipY%2C%20i%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28texture2.isCompressedTexture%20%7C%7C%20texture2.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20this._copyCompressedBufferToTexture%28texture2.mipmaps%2C%20textureData.texture%2C%20textureDescriptorGPU%29%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isCubeTexture%29%20%7B%0A%20%20%20%20%20%20this._copyCubeMapToTexture%28options.images%2C%20textureData.texture%2C%20textureDescriptorGPU%2C%20texture2.flipY%29%3B%0A%20%20%20%20%7D%20else%20if%20%28texture2.isVideoTexture%29%20%7B%0A%20%20%20%20%20%20const%20video%20%3D%20texture2.source.data%3B%0A%20%20%20%20%20%20textureData.externalTexture%20%3D%20video%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._copyImageToTexture%28options.image%2C%20textureData.texture%2C%20textureDescriptorGPU%2C%200%2C%20texture2.flipY%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20textureData.version%20%3D%20texture2.version%3B%0A%20%20%20%20if%20%28texture2.onUpdate%29%20texture2.onUpdate%28texture2%29%3B%0A%20%20%7D%0A%20%20async%20copyTextureToBuffer%28texture2%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20faceIndex%29%20%7B%0A%20%20%20%20const%20device%20%3D%20this.backend.device%3B%0A%20%20%20%20const%20textureData%20%3D%20this.backend.get%28texture2%29%3B%0A%20%20%20%20const%20textureGPU%20%3D%20textureData.texture%3B%0A%20%20%20%20const%20format2%20%3D%20textureData.textureDescriptorGPU.format%3B%0A%20%20%20%20const%20bytesPerTexel%20%3D%20this._getBytesPerTexel%28format2%29%3B%0A%20%20%20%20let%20bytesPerRow%20%3D%20width%20%2A%20bytesPerTexel%3B%0A%20%20%20%20bytesPerRow%20%3D%20Math.ceil%28bytesPerRow%20%2F%20256%29%20%2A%20256%3B%0A%20%20%20%20const%20readBuffer%20%3D%20device.createBuffer%28%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20size%3A%20width%20%2A%20height%20%2A%20bytesPerTexel%2C%0A%20%20%20%20%20%20%20%20usage%3A%20GPUBufferUsage.COPY_DST%20%7C%20GPUBufferUsage.MAP_READ%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%29%3B%0A%20%20%20%20const%20encoder%20%3D%20device.createCommandEncoder%28%29%3B%0A%20%20%20%20encoder.copyTextureToBuffer%28%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture%3A%20textureGPU%2C%0A%20%20%20%20%20%20%20%20origin%3A%20%7B%20x%3A%20x2%2C%20y%3A%20y2%2C%20z%3A%20faceIndex%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20buffer%3A%20readBuffer%2C%0A%20%20%20%20%20%20%20%20bytesPerRow%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20width%2C%0A%20%20%20%20%20%20%20%20height%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%29%3B%0A%20%20%20%20const%20typedArrayType%20%3D%20this._getTypedArrayType%28format2%29%3B%0A%20%20%20%20device.queue.submit%28%5Bencoder.finish%28%29%5D%29%3B%0A%20%20%20%20await%20readBuffer.mapAsync%28GPUMapMode.READ%29%3B%0A%20%20%20%20const%20buffer2%20%3D%20readBuffer.getMappedRange%28%29%3B%0A%20%20%20%20return%20new%20typedArrayType%28buffer2%29%3B%0A%20%20%7D%0A%20%20_isEnvironmentTexture%28texture2%29%20%7B%0A%20%20%20%20const%20mapping%20%3D%20texture2.mapping%3B%0A%20%20%20%20return%20mapping%20%3D%3D%3D%20EquirectangularReflectionMapping2%20%7C%7C%20mapping%20%3D%3D%3D%20EquirectangularRefractionMapping2%20%7C%7C%20%28mapping%20%3D%3D%3D%20CubeReflectionMapping2%20%7C%7C%20mapping%20%3D%3D%3D%20CubeRefractionMapping2%29%3B%0A%20%20%7D%0A%20%20_getDefaultTextureGPU%28format2%29%20%7B%0A%20%20%20%20let%20defaultTexture%20%3D%20this.defaultTexture%5Bformat2%5D%3B%0A%20%20%20%20if%20%28defaultTexture%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20texture2%20%3D%20new%20Texture2%28%29%3B%0A%20%20%20%20%20%20texture2.minFilter%20%3D%20NearestFilter2%3B%0A%20%20%20%20%20%20texture2.magFilter%20%3D%20NearestFilter2%3B%0A%20%20%20%20%20%20this.createTexture%28texture2%2C%20%7B%20width%3A%201%2C%20height%3A%201%2C%20format%3A%20format2%20%7D%29%3B%0A%20%20%20%20%20%20this.defaultTexture%5Bformat2%5D%20%3D%20defaultTexture%20%3D%20texture2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.backend.get%28defaultTexture%29.texture%3B%0A%20%20%7D%0A%20%20_getDefaultCubeTextureGPU%28format2%29%20%7B%0A%20%20%20%20let%20defaultCubeTexture%20%3D%20this.defaultTexture%5Bformat2%5D%3B%0A%20%20%20%20if%20%28defaultCubeTexture%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20texture2%20%3D%20new%20CubeTexture2%28%29%3B%0A%20%20%20%20%20%20texture2.minFilter%20%3D%20NearestFilter2%3B%0A%20%20%20%20%20%20texture2.magFilter%20%3D%20NearestFilter2%3B%0A%20%20%20%20%20%20this.createTexture%28texture2%2C%20%7B%20width%3A%201%2C%20height%3A%201%2C%20depth%3A%206%20%7D%29%3B%0A%20%20%20%20%20%20this.defaultCubeTexture%5Bformat2%5D%20%3D%20defaultCubeTexture%20%3D%20texture2%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.backend.get%28defaultCubeTexture%29.texture%3B%0A%20%20%7D%0A%20%20_getDefaultVideoFrame%28%29%20%7B%0A%20%20%20%20let%20defaultVideoFrame%20%3D%20this.defaultVideoFrame%3B%0A%20%20%20%20if%20%28defaultVideoFrame%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20init4%20%3D%20%7B%0A%20%20%20%20%20%20%20%20timestamp%3A%200%2C%0A%20%20%20%20%20%20%20%20codedWidth%3A%201%2C%0A%20%20%20%20%20%20%20%20codedHeight%3A%201%2C%0A%20%20%20%20%20%20%20%20format%3A%20%22RGBA%22%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20this.defaultVideoFrame%20%3D%20defaultVideoFrame%20%3D%20new%20VideoFrame%28new%20Uint8Array%28%5B0%2C%200%2C%200%2C%20255%5D%29%2C%20init4%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20defaultVideoFrame%3B%0A%20%20%7D%0A%20%20_copyCubeMapToTexture%28images%2C%20textureGPU%2C%20textureDescriptorGPU%2C%20flipY%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%206%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20image%20%3D%20images%5Bi%5D%3B%0A%20%20%20%20%20%20const%20flipIndex%20%3D%20flipY%20%3D%3D%3D%20true%20%3F%20_flipMap%5Bi%5D%20%3A%20i%3B%0A%20%20%20%20%20%20if%20%28image.isDataTexture%29%20%7B%0A%20%20%20%20%20%20%20%20this._copyBufferToTexture%28image.image%2C%20textureGPU%2C%20textureDescriptorGPU%2C%20flipIndex%2C%20flipY%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this._copyImageToTexture%28image%2C%20textureGPU%2C%20textureDescriptorGPU%2C%20flipIndex%2C%20flipY%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_copyImageToTexture%28image%2C%20textureGPU%2C%20textureDescriptorGPU%2C%20originDepth%2C%20flipY%29%20%7B%0A%20%20%20%20const%20device%20%3D%20this.backend.device%3B%0A%20%20%20%20device.queue.copyExternalImageToTexture%28%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20source%3A%20image%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture%3A%20textureGPU%2C%0A%20%20%20%20%20%20%20%20mipLevel%3A%200%2C%0A%20%20%20%20%20%20%20%20origin%3A%20%7B%20x%3A%200%2C%20y%3A%200%2C%20z%3A%20originDepth%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20width%3A%20image.width%2C%0A%20%20%20%20%20%20%20%20height%3A%20image.height%2C%0A%20%20%20%20%20%20%20%20depthOrArrayLayers%3A%201%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%29%3B%0A%20%20%20%20if%20%28flipY%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this._flipY%28textureGPU%2C%20textureDescriptorGPU%2C%20originDepth%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_getPassUtils%28%29%20%7B%0A%20%20%20%20let%20passUtils%20%3D%20this._passUtils%3B%0A%20%20%20%20if%20%28passUtils%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._passUtils%20%3D%20passUtils%20%3D%20new%20WebGPUTexturePassUtils%28this.backend.device%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20passUtils%3B%0A%20%20%7D%0A%20%20_generateMipmaps%28textureGPU%2C%20textureDescriptorGPU%2C%20baseArrayLayer%20%3D%200%29%20%7B%0A%20%20%20%20this._getPassUtils%28%29.generateMipmaps%28textureGPU%2C%20textureDescriptorGPU%2C%20baseArrayLayer%29%3B%0A%20%20%7D%0A%20%20_flipY%28textureGPU%2C%20textureDescriptorGPU%2C%20originDepth%20%3D%200%29%20%7B%0A%20%20%20%20this._getPassUtils%28%29.flipY%28textureGPU%2C%20textureDescriptorGPU%2C%20originDepth%29%3B%0A%20%20%7D%0A%20%20_copyBufferToTexture%28image%2C%20textureGPU%2C%20textureDescriptorGPU%2C%20originDepth%2C%20flipY%2C%20depth2%20%3D%200%29%20%7B%0A%20%20%20%20const%20device%20%3D%20this.backend.device%3B%0A%20%20%20%20const%20data%20%3D%20image.data%3B%0A%20%20%20%20const%20bytesPerTexel%20%3D%20this._getBytesPerTexel%28textureDescriptorGPU.format%29%3B%0A%20%20%20%20const%20bytesPerRow%20%3D%20image.width%20%2A%20bytesPerTexel%3B%0A%20%20%20%20device.queue.writeTexture%28%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture%3A%20textureGPU%2C%0A%20%20%20%20%20%20%20%20mipLevel%3A%200%2C%0A%20%20%20%20%20%20%20%20origin%3A%20%7B%20x%3A%200%2C%20y%3A%200%2C%20z%3A%20originDepth%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20data%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20offset%3A%20image.width%20%2A%20image.height%20%2A%20bytesPerTexel%20%2A%20depth2%2C%0A%20%20%20%20%20%20%20%20bytesPerRow%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20width%3A%20image.width%2C%0A%20%20%20%20%20%20%20%20height%3A%20image.height%2C%0A%20%20%20%20%20%20%20%20depthOrArrayLayers%3A%201%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%29%3B%0A%20%20%20%20if%20%28flipY%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this._flipY%28textureGPU%2C%20textureDescriptorGPU%2C%20originDepth%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_copyCompressedBufferToTexture%28mipmaps%2C%20textureGPU%2C%20textureDescriptorGPU%29%20%7B%0A%20%20%20%20const%20device%20%3D%20this.backend.device%3B%0A%20%20%20%20const%20blockData%20%3D%20this._getBlockData%28textureDescriptorGPU.format%29%3B%0A%20%20%20%20const%20isTextureArray%20%3D%20textureDescriptorGPU.size.depthOrArrayLayers%20%3E%201%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20mipmaps.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20mipmap%20%3D%20mipmaps%5Bi%5D%3B%0A%20%20%20%20%20%20const%20width%20%3D%20mipmap.width%3B%0A%20%20%20%20%20%20const%20height%20%3D%20mipmap.height%3B%0A%20%20%20%20%20%20const%20depth2%20%3D%20isTextureArray%20%3F%20textureDescriptorGPU.size.depthOrArrayLayers%20%3A%201%3B%0A%20%20%20%20%20%20const%20bytesPerRow%20%3D%20Math.ceil%28width%20%2F%20blockData.width%29%20%2A%20blockData.byteLength%3B%0A%20%20%20%20%20%20const%20bytesPerImage%20%3D%20bytesPerRow%20%2A%20Math.ceil%28height%20%2F%20blockData.height%29%3B%0A%20%20%20%20%20%20for%20%28let%20j%20%3D%200%3B%20j%20%3C%20depth2%3B%20j%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20device.queue.writeTexture%28%0A%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20texture%3A%20textureGPU%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mipLevel%3A%20i%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20origin%3A%20%7B%20x%3A%200%2C%20y%3A%200%2C%20z%3A%20j%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20mipmap.data%2C%0A%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20offset%3A%20j%20%2A%20bytesPerImage%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20bytesPerRow%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20rowsPerImage%3A%20Math.ceil%28height%20%2F%20blockData.height%29%0A%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20Math.ceil%28width%20%2F%20blockData.width%29%20%2A%20blockData.width%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20Math.ceil%28height%20%2F%20blockData.height%29%20%2A%20blockData.height%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20depthOrArrayLayers%3A%201%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_getBlockData%28format2%29%20%7B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.BC1RGBAUnorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.BC1RGBAUnormSRGB%29%20return%20%7B%20byteLength%3A%208%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.BC2RGBAUnorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.BC2RGBAUnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.BC3RGBAUnorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.BC3RGBAUnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.BC4RUnorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.BC4RSNorm%29%20return%20%7B%20byteLength%3A%208%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.BC5RGUnorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.BC5RGSnorm%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.BC6HRGBUFloat%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.BC6HRGBFloat%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.BC7RGBAUnorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.BC7RGBAUnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ETC2RGB8Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ETC2RGB8UnormSRGB%29%20return%20%7B%20byteLength%3A%208%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ETC2RGB8A1Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ETC2RGB8A1UnormSRGB%29%20return%20%7B%20byteLength%3A%208%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ETC2RGBA8Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ETC2RGBA8UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.EACR11Unorm%29%20return%20%7B%20byteLength%3A%208%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.EACR11Snorm%29%20return%20%7B%20byteLength%3A%208%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.EACRG11Unorm%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.EACRG11Snorm%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC4x4Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC4x4UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%204%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC5x4Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC5x4UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%205%2C%20height%3A%204%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC5x5Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC5x5UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%205%2C%20height%3A%205%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC6x5Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC6x5UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%206%2C%20height%3A%205%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC6x6Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC6x6UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%206%2C%20height%3A%206%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC8x5Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC8x5UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%208%2C%20height%3A%205%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC8x6Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC8x6UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%208%2C%20height%3A%206%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC8x8Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC8x8UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%208%2C%20height%3A%208%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC10x5Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC10x5UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%2010%2C%20height%3A%205%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC10x6Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC10x6UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%2010%2C%20height%3A%206%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC10x8Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC10x8UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%2010%2C%20height%3A%208%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC10x10Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC10x10UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%2010%2C%20height%3A%2010%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC12x10Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC12x10UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%2012%2C%20height%3A%2010%20%7D%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.ASTC12x12Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.ASTC12x12UnormSRGB%29%20return%20%7B%20byteLength%3A%2016%2C%20width%3A%2012%2C%20height%3A%2012%20%7D%3B%0A%20%20%7D%0A%20%20_convertAddressMode%28value%29%20%7B%0A%20%20%20%20let%20addressMode%20%3D%20GPUAddressMode.ClampToEdge%3B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20RepeatWrapping2%29%20%7B%0A%20%20%20%20%20%20addressMode%20%3D%20GPUAddressMode.Repeat%3B%0A%20%20%20%20%7D%20else%20if%20%28value%20%3D%3D%3D%20MirroredRepeatWrapping2%29%20%7B%0A%20%20%20%20%20%20addressMode%20%3D%20GPUAddressMode.MirrorRepeat%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20addressMode%3B%0A%20%20%7D%0A%20%20_convertFilterMode%28value%29%20%7B%0A%20%20%20%20let%20filterMode%20%3D%20GPUFilterMode.Linear%3B%0A%20%20%20%20if%20%28value%20%3D%3D%3D%20NearestFilter2%20%7C%7C%20value%20%3D%3D%3D%20NearestMipmapNearestFilter2%20%7C%7C%20value%20%3D%3D%3D%20NearestMipmapLinearFilter2%29%20%7B%0A%20%20%20%20%20%20filterMode%20%3D%20GPUFilterMode.Nearest%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20filterMode%3B%0A%20%20%7D%0A%20%20_getBytesPerTexel%28format2%29%20%7B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R8Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.R8Snorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.R8Uint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.R8Sint%29%20return%201%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R16Uint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.R16Sint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.R16Float%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG8Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG8Snorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG8Uint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG8Sint%29%20return%202%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R32Uint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.R32Sint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.R32Float%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG16Uint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG16Sint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG16Float%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA8Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA8UnormSRGB%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA8Snorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA8Uint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA8Sint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.BGRA8Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.BGRA8UnormSRGB%20%7C%7C%20%2F%2F%20Packed%2032-bit%20formats%0A%20%20%20%20format2%20%3D%3D%3D%20GPUTextureFormat.RGB9E5UFloat%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGB10A2Unorm%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG11B10UFloat%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.Depth32Float%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.Depth24Plus%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.Depth24PlusStencil8%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.Depth32FloatStencil8%29%20return%204%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG32Uint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG32Sint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RG32Float%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA16Uint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA16Sint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA16Float%29%20return%208%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA32Uint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA32Sint%20%7C%7C%20format2%20%3D%3D%3D%20GPUTextureFormat.RGBA32Float%29%20return%2016%3B%0A%20%20%7D%0A%20%20_getTypedArrayType%28format2%29%20%7B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R8Uint%29%20return%20Uint8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R8Sint%29%20return%20Int8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R8Unorm%29%20return%20Uint8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R8Snorm%29%20return%20Int8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG8Uint%29%20return%20Uint8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG8Sint%29%20return%20Int8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG8Unorm%29%20return%20Uint8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG8Snorm%29%20return%20Int8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA8Uint%29%20return%20Uint8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA8Sint%29%20return%20Int8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA8Unorm%29%20return%20Uint8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA8Snorm%29%20return%20Int8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R16Uint%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R16Sint%29%20return%20Int16Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG16Uint%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG16Sint%29%20return%20Int16Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA16Uint%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA16Sint%29%20return%20Int16Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R16Float%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG16Float%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA16Float%29%20return%20Uint16Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R32Uint%29%20return%20Uint32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R32Sint%29%20return%20Int32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.R32Float%29%20return%20Float32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG32Uint%29%20return%20Uint32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG32Sint%29%20return%20Int32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG32Float%29%20return%20Float32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA32Uint%29%20return%20Uint32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA32Sint%29%20return%20Int32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGBA32Float%29%20return%20Float32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.BGRA8Unorm%29%20return%20Uint8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.BGRA8UnormSRGB%29%20return%20Uint8Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGB10A2Unorm%29%20return%20Uint32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RGB9E5UFloat%29%20return%20Uint32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.RG11B10UFloat%29%20return%20Uint32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.Depth32Float%29%20return%20Float32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.Depth24Plus%29%20return%20Uint32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.Depth24PlusStencil8%29%20return%20Uint32Array%3B%0A%20%20%20%20if%20%28format2%20%3D%3D%3D%20GPUTextureFormat.Depth32FloatStencil8%29%20return%20Float32Array%3B%0A%20%20%7D%0A%20%20_getDimension%28texture2%29%20%7B%0A%20%20%20%20let%20dimension%3B%0A%20%20%20%20if%20%28texture2.isData3DTexture%29%20%7B%0A%20%20%20%20%20%20dimension%20%3D%20GPUTextureDimension.ThreeD%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20dimension%20%3D%20GPUTextureDimension.TwoD%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20dimension%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20getFormat2%28texture2%2C%20device%20%3D%20null%29%20%7B%0A%20%20const%20format2%20%3D%20texture2.format%3B%0A%20%20const%20type%20%3D%20texture2.type%3B%0A%20%20const%20colorSpace%20%3D%20texture2.colorSpace%3B%0A%20%20let%20formatGPU%3B%0A%20%20if%20%28texture2.isCompressedTexture%20%3D%3D%3D%20true%20%7C%7C%20texture2.isCompressedArrayTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20switch%20%28format2%29%20%7B%0A%20%20%20%20%20%20case%20RGBA_S3TC_DXT1_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.BC1RGBAUnormSRGB%20%3A%20GPUTextureFormat.BC1RGBAUnorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_S3TC_DXT3_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.BC2RGBAUnormSRGB%20%3A%20GPUTextureFormat.BC2RGBAUnorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_S3TC_DXT5_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.BC3RGBAUnormSRGB%20%3A%20GPUTextureFormat.BC3RGBAUnorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGB_ETC2_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ETC2RGB8UnormSRGB%20%3A%20GPUTextureFormat.ETC2RGB8Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ETC2_EAC_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ETC2RGBA8UnormSRGB%20%3A%20GPUTextureFormat.ETC2RGBA8Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_4x4_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC4x4UnormSRGB%20%3A%20GPUTextureFormat.ASTC4x4Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_5x4_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC5x4UnormSRGB%20%3A%20GPUTextureFormat.ASTC5x4Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_5x5_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC5x5UnormSRGB%20%3A%20GPUTextureFormat.ASTC5x5Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_6x5_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC6x5UnormSRGB%20%3A%20GPUTextureFormat.ASTC6x5Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_6x6_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC6x6UnormSRGB%20%3A%20GPUTextureFormat.ASTC6x6Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_8x5_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC8x5UnormSRGB%20%3A%20GPUTextureFormat.ASTC8x5Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_8x6_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC8x6UnormSRGB%20%3A%20GPUTextureFormat.ASTC8x6Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_8x8_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC8x8UnormSRGB%20%3A%20GPUTextureFormat.ASTC8x8Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_10x5_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC10x5UnormSRGB%20%3A%20GPUTextureFormat.ASTC10x5Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_10x6_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC10x6UnormSRGB%20%3A%20GPUTextureFormat.ASTC10x6Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_10x8_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC10x8UnormSRGB%20%3A%20GPUTextureFormat.ASTC10x8Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_10x10_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC10x10UnormSRGB%20%3A%20GPUTextureFormat.ASTC10x10Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_12x10_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC12x10UnormSRGB%20%3A%20GPUTextureFormat.ASTC12x10Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBA_ASTC_12x12_Format2%3A%0A%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.ASTC12x12UnormSRGB%20%3A%20GPUTextureFormat.ASTC12x12Unorm%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20format.%22%2C%20format2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20switch%20%28format2%29%20%7B%0A%20%20%20%20%20%20case%20RGBAFormat2%3A%0A%20%20%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20ByteType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGBA8Snorm%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20ShortType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGBA16Sint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedShortType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGBA16Uint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedIntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGBA32Uint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20IntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGBA32Sint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedByteType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20colorSpace%20%3D%3D%3D%20SRGBColorSpace2%20%3F%20GPUTextureFormat.RGBA8UnormSRGB%20%3A%20GPUTextureFormat.RGBA8Unorm%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20HalfFloatType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGBA16Float%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20FloatType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGBA32Float%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20type%20with%20RGBAFormat.%22%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBFormat2%3A%0A%20%20%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedInt5999Type2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGB9E5UFloat%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20type%20with%20RGBFormat.%22%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RedFormat2%3A%0A%20%20%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20ByteType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R8Snorm%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20ShortType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R16Sint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedShortType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R16Uint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedIntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R32Uint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20IntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R32Sint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedByteType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R8Unorm%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20HalfFloatType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R16Float%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20FloatType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R32Float%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20type%20with%20RedFormat.%22%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGFormat2%3A%0A%20%20%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20ByteType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG8Snorm%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20ShortType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG16Sint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedShortType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG16Uint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedIntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG32Uint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20IntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG32Sint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedByteType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG8Unorm%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20HalfFloatType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG16Float%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20FloatType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG32Float%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20type%20with%20RGFormat.%22%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20DepthFormat2%3A%0A%20%20%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedShortType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.Depth16Unorm%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedIntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.Depth24Plus%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20FloatType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.Depth32Float%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20type%20with%20DepthFormat.%22%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20DepthStencilFormat2%3A%0A%20%20%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedInt248Type2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.Depth24PlusStencil8%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20FloatType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28device%20%26%26%20device.features.has%28GPUFeatureName.Depth32FloatStencil8%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%27WebGPURenderer%3A%20Depth%20textures%20with%20DepthStencilFormat%20%2B%20FloatType%20can%20only%20be%20used%20with%20the%20%22depth32float-stencil8%22%20GPU%20feature.%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.Depth32FloatStencil8%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20type%20with%20DepthStencilFormat.%22%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RedIntegerFormat2%3A%0A%20%20%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20IntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R32Sint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedIntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.R32Uint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20type%20with%20RedIntegerFormat.%22%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGIntegerFormat2%3A%0A%20%20%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20IntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG32Sint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedIntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RG32Uint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20type%20with%20RGIntegerFormat.%22%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20RGBAIntegerFormat2%3A%0A%20%20%20%20%20%20%20%20switch%20%28type%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20IntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGBA32Sint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20UnsignedIntType2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20formatGPU%20%3D%20GPUTextureFormat.RGBA32Uint%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20type%20with%20RGBAIntegerFormat.%22%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.error%28%22WebGPURenderer%3A%20Unsupported%20texture%20format.%22%2C%20format2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20formatGPU%3B%0A%7D%0Avar%20declarationRegexp%20%3D%20%2F%5E%5Bfn%5D%2A%5Cs%2A%28%5Ba-z_0-9%5D%2B%29%3F%5Cs%2A%5C%28%28%5B%5Cs%5CS%5D%2A%3F%29%5C%29%5Cs%2A%5B%5C-%5C%3E%5D%2A%5Cs%2A%28%5Ba-z_0-9%5D%2B%28%3F%3A%3C%5B%5Cs%5CS%5D%2B%3F%3E%29%3F%29%2Fi%3B%0Avar%20propertiesRegexp%20%3D%20%2F%28%5Ba-z_0-9%5D%2B%29%5Cs%2A%3A%5Cs%2A%28%5Ba-z_0-9%5D%2B%28%3F%3A%3C%5B%5Cs%5CS%5D%2B%3F%3E%29%3F%29%2Fig%3B%0Avar%20wgslTypeLib%241%20%3D%20%7B%0A%20%20%22f32%22%3A%20%22float%22%2C%0A%20%20%22i32%22%3A%20%22int%22%2C%0A%20%20%22u32%22%3A%20%22uint%22%2C%0A%20%20%22bool%22%3A%20%22bool%22%2C%0A%20%20%22vec2%3Cf32%3E%22%3A%20%22vec2%22%2C%0A%20%20%22vec2%3Ci32%3E%22%3A%20%22ivec2%22%2C%0A%20%20%22vec2%3Cu32%3E%22%3A%20%22uvec2%22%2C%0A%20%20%22vec2%3Cbool%3E%22%3A%20%22bvec2%22%2C%0A%20%20%22vec2f%22%3A%20%22vec2%22%2C%0A%20%20%22vec2i%22%3A%20%22ivec2%22%2C%0A%20%20%22vec2u%22%3A%20%22uvec2%22%2C%0A%20%20%22vec2b%22%3A%20%22bvec2%22%2C%0A%20%20%22vec3%3Cf32%3E%22%3A%20%22vec3%22%2C%0A%20%20%22vec3%3Ci32%3E%22%3A%20%22ivec3%22%2C%0A%20%20%22vec3%3Cu32%3E%22%3A%20%22uvec3%22%2C%0A%20%20%22vec3%3Cbool%3E%22%3A%20%22bvec3%22%2C%0A%20%20%22vec3f%22%3A%20%22vec3%22%2C%0A%20%20%22vec3i%22%3A%20%22ivec3%22%2C%0A%20%20%22vec3u%22%3A%20%22uvec3%22%2C%0A%20%20%22vec3b%22%3A%20%22bvec3%22%2C%0A%20%20%22vec4%3Cf32%3E%22%3A%20%22vec4%22%2C%0A%20%20%22vec4%3Ci32%3E%22%3A%20%22ivec4%22%2C%0A%20%20%22vec4%3Cu32%3E%22%3A%20%22uvec4%22%2C%0A%20%20%22vec4%3Cbool%3E%22%3A%20%22bvec4%22%2C%0A%20%20%22vec4f%22%3A%20%22vec4%22%2C%0A%20%20%22vec4i%22%3A%20%22ivec4%22%2C%0A%20%20%22vec4u%22%3A%20%22uvec4%22%2C%0A%20%20%22vec4b%22%3A%20%22bvec4%22%2C%0A%20%20%22mat2x2%3Cf32%3E%22%3A%20%22mat2%22%2C%0A%20%20%22mat2x2f%22%3A%20%22mat2%22%2C%0A%20%20%22mat3x3%3Cf32%3E%22%3A%20%22mat3%22%2C%0A%20%20%22mat3x3f%22%3A%20%22mat3%22%2C%0A%20%20%22mat4x4%3Cf32%3E%22%3A%20%22mat4%22%2C%0A%20%20%22mat4x4f%22%3A%20%22mat4%22%2C%0A%20%20%22sampler%22%3A%20%22sampler%22%2C%0A%20%20%22texture_1d%22%3A%20%22texture%22%2C%0A%20%20%22texture_2d%22%3A%20%22texture%22%2C%0A%20%20%22texture_2d_array%22%3A%20%22texture%22%2C%0A%20%20%22texture_multisampled_2d%22%3A%20%22cubeTexture%22%2C%0A%20%20%22texture_depth_2d%22%3A%20%22depthTexture%22%2C%0A%20%20%22texture_3d%22%3A%20%22texture3D%22%2C%0A%20%20%22texture_cube%22%3A%20%22cubeTexture%22%2C%0A%20%20%22texture_cube_array%22%3A%20%22cubeTexture%22%2C%0A%20%20%22texture_storage_1d%22%3A%20%22storageTexture%22%2C%0A%20%20%22texture_storage_2d%22%3A%20%22storageTexture%22%2C%0A%20%20%22texture_storage_2d_array%22%3A%20%22storageTexture%22%2C%0A%20%20%22texture_storage_3d%22%3A%20%22storageTexture%22%0A%7D%3B%0Avar%20parse%20%3D%20%28source%29%20%3D%3E%20%7B%0A%20%20source%20%3D%20source.trim%28%29%3B%0A%20%20const%20declaration%20%3D%20source.match%28declarationRegexp%29%3B%0A%20%20if%20%28declaration%20%21%3D%3D%20null%20%26%26%20declaration.length%20%3D%3D%3D%204%29%20%7B%0A%20%20%20%20const%20inputsCode%20%3D%20declaration%5B2%5D%3B%0A%20%20%20%20const%20propsMatches%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20match%20%3D%20null%3B%0A%20%20%20%20while%20%28%28match%20%3D%20propertiesRegexp.exec%28inputsCode%29%29%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20propsMatches.push%28%7B%20name%3A%20match%5B1%5D%2C%20type%3A%20match%5B2%5D%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20inputs%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20propsMatches.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20name%3A%20name2%2C%20type%3A%20type2%20%7D%20%3D%20propsMatches%5Bi%5D%3B%0A%20%20%20%20%20%20let%20resolvedType%20%3D%20type2%3B%0A%20%20%20%20%20%20if%20%28resolvedType.startsWith%28%22ptr%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20resolvedType%20%3D%20%22pointer%22%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28resolvedType.startsWith%28%22texture%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20resolvedType%20%3D%20type2.split%28%22%3C%22%29%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20resolvedType%20%3D%20wgslTypeLib%241%5BresolvedType%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20inputs.push%28new%20NodeFunctionInput%28resolvedType%2C%20name2%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20blockCode%20%3D%20source.substring%28declaration%5B0%5D.length%29%3B%0A%20%20%20%20const%20outputType%20%3D%20declaration%5B3%5D%20%7C%7C%20%22void%22%3B%0A%20%20%20%20const%20name%20%3D%20declaration%5B1%5D%20%21%3D%3D%20void%200%20%3F%20declaration%5B1%5D%20%3A%20%22%22%3B%0A%20%20%20%20const%20type%20%3D%20wgslTypeLib%241%5BoutputType%5D%20%7C%7C%20outputType%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20type%2C%0A%20%20%20%20%20%20inputs%2C%0A%20%20%20%20%20%20name%2C%0A%20%20%20%20%20%20inputsCode%2C%0A%20%20%20%20%20%20blockCode%2C%0A%20%20%20%20%20%20outputType%0A%20%20%20%20%7D%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20throw%20new%20Error%28%22FunctionNode%3A%20Function%20is%20not%20a%20WGSL%20code.%22%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WGSLNodeFunction%20%3D%20class%20extends%20NodeFunction%20%7B%0A%20%20constructor%28source%29%20%7B%0A%20%20%20%20const%20%7B%20type%2C%20inputs%2C%20name%2C%20inputsCode%2C%20blockCode%2C%20outputType%20%7D%20%3D%20parse%28source%29%3B%0A%20%20%20%20super%28type%2C%20inputs%2C%20name%29%3B%0A%20%20%20%20this.inputsCode%20%3D%20inputsCode%3B%0A%20%20%20%20this.blockCode%20%3D%20blockCode%3B%0A%20%20%20%20this.outputType%20%3D%20outputType%3B%0A%20%20%7D%0A%20%20getCode%28name%20%3D%20this.name%29%20%7B%0A%20%20%20%20const%20outputType%20%3D%20this.outputType%20%21%3D%3D%20%22void%22%20%3F%20%22-%3E%20%22%20%2B%20this.outputType%20%3A%20%22%22%3B%0A%20%20%20%20return%20%60fn%20%24%7Bname%7D%20%28%20%24%7Bthis.inputsCode.trim%28%29%7D%20%29%20%24%7BoutputType%7D%60%20%2B%20this.blockCode%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WGSLNodeParser%20%3D%20class%20extends%20NodeParser%20%7B%0A%20%20parseFunction%28source%29%20%7B%0A%20%20%20%20return%20new%20WGSLNodeFunction%28source%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20GPUShaderStage%20%3D%20self.GPUShaderStage%3B%0Avar%20gpuShaderStageLib%20%3D%20%7B%0A%20%20%22vertex%22%3A%20GPUShaderStage%20%3F%20GPUShaderStage.VERTEX%20%3A%201%2C%0A%20%20%22fragment%22%3A%20GPUShaderStage%20%3F%20GPUShaderStage.FRAGMENT%20%3A%202%2C%0A%20%20%22compute%22%3A%20GPUShaderStage%20%3F%20GPUShaderStage.COMPUTE%20%3A%204%0A%7D%3B%0Avar%20supports%20%3D%20%7B%0A%20%20instance%3A%20true%2C%0A%20%20swizzleAssign%3A%20false%2C%0A%20%20storageBuffer%3A%20true%0A%7D%3B%0Avar%20wgslFnOpLib%20%3D%20%7B%0A%20%20%22%5E%5E%22%3A%20%22tsl_xor%22%0A%7D%3B%0Avar%20wgslTypeLib%20%3D%20%7B%0A%20%20float%3A%20%22f32%22%2C%0A%20%20int%3A%20%22i32%22%2C%0A%20%20uint%3A%20%22u32%22%2C%0A%20%20bool%3A%20%22bool%22%2C%0A%20%20color%3A%20%22vec3%3Cf32%3E%22%2C%0A%20%20vec2%3A%20%22vec2%3Cf32%3E%22%2C%0A%20%20ivec2%3A%20%22vec2%3Ci32%3E%22%2C%0A%20%20uvec2%3A%20%22vec2%3Cu32%3E%22%2C%0A%20%20bvec2%3A%20%22vec2%3Cbool%3E%22%2C%0A%20%20vec3%3A%20%22vec3%3Cf32%3E%22%2C%0A%20%20ivec3%3A%20%22vec3%3Ci32%3E%22%2C%0A%20%20uvec3%3A%20%22vec3%3Cu32%3E%22%2C%0A%20%20bvec3%3A%20%22vec3%3Cbool%3E%22%2C%0A%20%20vec4%3A%20%22vec4%3Cf32%3E%22%2C%0A%20%20ivec4%3A%20%22vec4%3Ci32%3E%22%2C%0A%20%20uvec4%3A%20%22vec4%3Cu32%3E%22%2C%0A%20%20bvec4%3A%20%22vec4%3Cbool%3E%22%2C%0A%20%20mat2%3A%20%22mat2x2%3Cf32%3E%22%2C%0A%20%20mat3%3A%20%22mat3x3%3Cf32%3E%22%2C%0A%20%20mat4%3A%20%22mat4x4%3Cf32%3E%22%0A%7D%3B%0Avar%20wgslPolyfill%20%3D%20%7B%0A%20%20tsl_xor%3A%20new%20CodeNode%28%22fn%20tsl_xor%28%20a%20%3A%20bool%2C%20b%20%3A%20bool%20%29%20-%3E%20bool%20%7B%20return%20%28%20a%20%7C%7C%20b%20%29%20%26%26%20%21%28%20a%20%26%26%20b%20%29%3B%20%7D%22%29%2C%0A%20%20mod_float%3A%20new%20CodeNode%28%22fn%20tsl_mod_float%28%20x%20%3A%20f32%2C%20y%20%3A%20f32%20%29%20-%3E%20f32%20%7B%20return%20x%20-%20y%20%2A%20floor%28%20x%20%2F%20y%20%29%3B%20%7D%22%29%2C%0A%20%20mod_vec2%3A%20new%20CodeNode%28%22fn%20tsl_mod_vec2%28%20x%20%3A%20vec2f%2C%20y%20%3A%20vec2f%20%29%20-%3E%20vec2f%20%7B%20return%20x%20-%20y%20%2A%20floor%28%20x%20%2F%20y%20%29%3B%20%7D%22%29%2C%0A%20%20mod_vec3%3A%20new%20CodeNode%28%22fn%20tsl_mod_vec3%28%20x%20%3A%20vec3f%2C%20y%20%3A%20vec3f%20%29%20-%3E%20vec3f%20%7B%20return%20x%20-%20y%20%2A%20floor%28%20x%20%2F%20y%20%29%3B%20%7D%22%29%2C%0A%20%20mod_vec4%3A%20new%20CodeNode%28%22fn%20tsl_mod_vec4%28%20x%20%3A%20vec4f%2C%20y%20%3A%20vec4f%20%29%20-%3E%20vec4f%20%7B%20return%20x%20-%20y%20%2A%20floor%28%20x%20%2F%20y%20%29%3B%20%7D%22%29%2C%0A%20%20equals_bool%3A%20new%20CodeNode%28%22fn%20tsl_equals_bool%28%20a%20%3A%20bool%2C%20b%20%3A%20bool%20%29%20-%3E%20bool%20%7B%20return%20a%20%3D%3D%20b%3B%20%7D%22%29%2C%0A%20%20equals_bvec2%3A%20new%20CodeNode%28%22fn%20tsl_equals_bvec2%28%20a%20%3A%20vec2f%2C%20b%20%3A%20vec2f%20%29%20-%3E%20vec2%3Cbool%3E%20%7B%20return%20vec2%3Cbool%3E%28%20a.x%20%3D%3D%20b.x%2C%20a.y%20%3D%3D%20b.y%20%29%3B%20%7D%22%29%2C%0A%20%20equals_bvec3%3A%20new%20CodeNode%28%22fn%20tsl_equals_bvec3%28%20a%20%3A%20vec3f%2C%20b%20%3A%20vec3f%20%29%20-%3E%20vec3%3Cbool%3E%20%7B%20return%20vec3%3Cbool%3E%28%20a.x%20%3D%3D%20b.x%2C%20a.y%20%3D%3D%20b.y%2C%20a.z%20%3D%3D%20b.z%20%29%3B%20%7D%22%29%2C%0A%20%20equals_bvec4%3A%20new%20CodeNode%28%22fn%20tsl_equals_bvec4%28%20a%20%3A%20vec4f%2C%20b%20%3A%20vec4f%20%29%20-%3E%20vec4%3Cbool%3E%20%7B%20return%20vec4%3Cbool%3E%28%20a.x%20%3D%3D%20b.x%2C%20a.y%20%3D%3D%20b.y%2C%20a.z%20%3D%3D%20b.z%2C%20a.w%20%3D%3D%20b.w%20%29%3B%20%7D%22%29%2C%0A%20%20repeatWrapping%3A%20new%20CodeNode%28%0A%20%20%20%20%2F%2A%20wgsl%20%2A%2F%0A%20%20%20%20%60%0Afn%20tsl_repeatWrapping%28%20uv%20%3A%20vec2%3Cf32%3E%2C%20dimension%20%3A%20vec2%3Cu32%3E%20%29%20-%3E%20vec2%3Cu32%3E%20%7B%0A%0A%09let%20uvScaled%20%3D%20vec2%3Cu32%3E%28%20uv%20%2A%20vec2%3Cf32%3E%28%20dimension%20%29%20%29%3B%0A%0A%09return%20%28%20%28%20uvScaled%20%25%20dimension%20%29%20%2B%20dimension%20%29%20%25%20dimension%3B%0A%0A%7D%0A%60%0A%20%20%29%2C%0A%20%20biquadraticTexture%3A%20new%20CodeNode%28%0A%20%20%20%20%2F%2A%20wgsl%20%2A%2F%0A%20%20%20%20%60%0Afn%20tsl_biquadraticTexture%28%20map%20%3A%20texture_2d%3Cf32%3E%2C%20coord%20%3A%20vec2f%2C%20level%20%3A%20i32%20%29%20-%3E%20vec4f%20%7B%0A%0A%09let%20iRes%20%3D%20vec2i%28%20textureDimensions%28%20map%2C%20level%20%29%20%29%3B%0A%09let%20res%20%3D%20vec2f%28%20iRes%20%29%3B%0A%0A%09let%20uvScaled%20%3D%20coord%20%2A%20res%3B%0A%09let%20uvWrapping%20%3D%20%28%20%28%20uvScaled%20%25%20res%20%29%20%2B%20res%20%29%20%25%20res%3B%0A%0A%09%2F%2F%20https%3A%2F%2Fwww.shadertoy.com%2Fview%2FWtyXRy%0A%0A%09let%20uv%20%3D%20uvWrapping%20-%200.5%3B%0A%09let%20iuv%20%3D%20floor%28%20uv%20%29%3B%0A%09let%20f%20%3D%20fract%28%20uv%20%29%3B%0A%0A%09let%20rg1%20%3D%20textureLoad%28%20map%2C%20vec2i%28%20iuv%20%2B%20vec2%28%200.5%2C%200.5%20%29%20%29%20%25%20iRes%2C%20level%20%29%3B%0A%09let%20rg2%20%3D%20textureLoad%28%20map%2C%20vec2i%28%20iuv%20%2B%20vec2%28%201.5%2C%200.5%20%29%20%29%20%25%20iRes%2C%20level%20%29%3B%0A%09let%20rg3%20%3D%20textureLoad%28%20map%2C%20vec2i%28%20iuv%20%2B%20vec2%28%200.5%2C%201.5%20%29%20%29%20%25%20iRes%2C%20level%20%29%3B%0A%09let%20rg4%20%3D%20textureLoad%28%20map%2C%20vec2i%28%20iuv%20%2B%20vec2%28%201.5%2C%201.5%20%29%20%29%20%25%20iRes%2C%20level%20%29%3B%0A%0A%09return%20mix%28%20mix%28%20rg1%2C%20rg2%2C%20f.x%20%29%2C%20mix%28%20rg3%2C%20rg4%2C%20f.x%20%29%2C%20f.y%20%29%3B%0A%0A%7D%0A%60%0A%20%20%29%0A%7D%3B%0Avar%20wgslMethods%20%3D%20%7B%0A%20%20dFdx%3A%20%22dpdx%22%2C%0A%20%20dFdy%3A%20%22-%20dpdy%22%2C%0A%20%20mod_float%3A%20%22tsl_mod_float%22%2C%0A%20%20mod_vec2%3A%20%22tsl_mod_vec2%22%2C%0A%20%20mod_vec3%3A%20%22tsl_mod_vec3%22%2C%0A%20%20mod_vec4%3A%20%22tsl_mod_vec4%22%2C%0A%20%20equals_bool%3A%20%22tsl_equals_bool%22%2C%0A%20%20equals_bvec2%3A%20%22tsl_equals_bvec2%22%2C%0A%20%20equals_bvec3%3A%20%22tsl_equals_bvec3%22%2C%0A%20%20equals_bvec4%3A%20%22tsl_equals_bvec4%22%2C%0A%20%20inversesqrt%3A%20%22inverseSqrt%22%2C%0A%20%20bitcast%3A%20%22bitcast%3Cf32%3E%22%0A%7D%3B%0Aif%20%28%2FWindows%2Fg.test%28navigator.userAgent%29%29%20%7B%0A%20%20wgslPolyfill.pow_float%20%3D%20new%20CodeNode%28%22fn%20tsl_pow_float%28%20a%20%3A%20f32%2C%20b%20%3A%20f32%20%29%20-%3E%20f32%20%7B%20return%20select%28%20-pow%28%20-a%2C%20b%20%29%2C%20pow%28%20a%2C%20b%20%29%2C%20a%20%3E%200.0%20%29%3B%20%7D%22%29%3B%0A%20%20wgslPolyfill.pow_vec2%20%3D%20new%20CodeNode%28%22fn%20tsl_pow_vec2%28%20a%20%3A%20vec2f%2C%20b%20%3A%20vec2f%20%29%20-%3E%20vec2f%20%7B%20return%20vec2f%28%20tsl_pow_float%28%20a.x%2C%20b.x%20%29%2C%20tsl_pow_float%28%20a.y%2C%20b.y%20%29%20%29%3B%20%7D%22%2C%20%5BwgslPolyfill.pow_float%5D%29%3B%0A%20%20wgslPolyfill.pow_vec3%20%3D%20new%20CodeNode%28%22fn%20tsl_pow_vec3%28%20a%20%3A%20vec3f%2C%20b%20%3A%20vec3f%20%29%20-%3E%20vec3f%20%7B%20return%20vec3f%28%20tsl_pow_float%28%20a.x%2C%20b.x%20%29%2C%20tsl_pow_float%28%20a.y%2C%20b.y%20%29%2C%20tsl_pow_float%28%20a.z%2C%20b.z%20%29%20%29%3B%20%7D%22%2C%20%5BwgslPolyfill.pow_float%5D%29%3B%0A%20%20wgslPolyfill.pow_vec4%20%3D%20new%20CodeNode%28%22fn%20tsl_pow_vec4%28%20a%20%3A%20vec4f%2C%20b%20%3A%20vec4f%20%29%20-%3E%20vec4f%20%7B%20return%20vec4f%28%20tsl_pow_float%28%20a.x%2C%20b.x%20%29%2C%20tsl_pow_float%28%20a.y%2C%20b.y%20%29%2C%20tsl_pow_float%28%20a.z%2C%20b.z%20%29%2C%20tsl_pow_float%28%20a.w%2C%20b.w%20%29%20%29%3B%20%7D%22%2C%20%5BwgslPolyfill.pow_float%5D%29%3B%0A%20%20wgslMethods.pow_float%20%3D%20%22tsl_pow_float%22%3B%0A%20%20wgslMethods.pow_vec2%20%3D%20%22tsl_pow_vec2%22%3B%0A%20%20wgslMethods.pow_vec3%20%3D%20%22tsl_pow_vec3%22%3B%0A%20%20wgslMethods.pow_vec4%20%3D%20%22tsl_pow_vec4%22%3B%0A%7D%0Avar%20diagnostics%20%3D%20%22%22%3B%0Aif%20%28%2FFirefox%7CDeno%2Fg.test%28navigator.userAgent%29%20%21%3D%3D%20true%29%20%7B%0A%20%20diagnostics%20%2B%3D%20%22diagnostic%28%20off%2C%20derivative_uniformity%20%29%3B%5Cn%22%3B%0A%7D%0Avar%20WGSLNodeBuilder%20%3D%20class%20extends%20NodeBuilder%20%7B%0A%20%20constructor%28object%2C%20renderer3%29%20%7B%0A%20%20%20%20super%28object%2C%20renderer3%2C%20new%20WGSLNodeParser%28%29%29%3B%0A%20%20%20%20this.uniformGroups%20%3D%20%7B%7D%3B%0A%20%20%20%20this.builtins%20%3D%20%7B%7D%3B%0A%20%20%20%20this.directives%20%3D%20%7B%7D%3B%0A%20%20%20%20this.scopedArrays%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%7D%0A%20%20needsToWorkingColorSpace%28texture2%29%20%7B%0A%20%20%20%20return%20texture2.isVideoTexture%20%3D%3D%3D%20true%20%26%26%20texture2.colorSpace%20%21%3D%3D%20NoColorSpace2%3B%0A%20%20%7D%0A%20%20_generateTextureSample%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20depthSnippet%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20if%20%28depthSnippet%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%60textureSample%28%20%24%7BtextureProperty%7D%2C%20%24%7BtextureProperty%7D_sampler%2C%20%24%7BuvSnippet%7D%2C%20%24%7BdepthSnippet%7D%20%29%60%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20%60textureSample%28%20%24%7BtextureProperty%7D%2C%20%24%7BtextureProperty%7D_sampler%2C%20%24%7BuvSnippet%7D%20%29%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28this.isFilteredTexture%28texture2%29%29%20%7B%0A%20%20%20%20%20%20return%20this.generateFilteredTexture%28texture2%2C%20textureProperty%2C%20uvSnippet%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20this.generateTextureLod%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20%220%22%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_generateVideoSample%28textureProperty%2C%20uvSnippet%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20return%20%60textureSampleBaseClampToEdge%28%20%24%7BtextureProperty%7D%2C%20%24%7BtextureProperty%7D_sampler%2C%20vec2%3Cf32%3E%28%20%24%7BuvSnippet%7D.x%2C%201.0%20-%20%24%7BuvSnippet%7D.y%20%29%20%29%60%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%60WebGPURenderer%3A%20THREE.VideoTexture%20does%20not%20support%20%24%7BshaderStage%7D%20shader.%60%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_generateTextureSampleLevel%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%2C%20depthSnippet%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%20%26%26%20this.isUnfilterable%28texture2%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20return%20%60textureSampleLevel%28%20%24%7BtextureProperty%7D%2C%20%24%7BtextureProperty%7D_sampler%2C%20%24%7BuvSnippet%7D%2C%20%24%7BlevelSnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20if%20%28this.isFilteredTexture%28texture2%29%29%20%7B%0A%20%20%20%20%20%20return%20this.generateFilteredTexture%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20this.generateTextureLod%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generateFilteredTexture%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%20%3D%20%220%22%29%20%7B%0A%20%20%20%20this._include%28%22biquadraticTexture%22%29%3B%0A%20%20%20%20return%20%60tsl_biquadraticTexture%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvSnippet%7D%2C%20i32%28%20%24%7BlevelSnippet%7D%20%29%20%29%60%3B%0A%20%20%7D%0A%20%20generateTextureLod%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%20%3D%20%220%22%29%20%7B%0A%20%20%20%20this._include%28%22repeatWrapping%22%29%3B%0A%20%20%20%20const%20dimension%20%3D%20texture2.isMultisampleRenderTargetTexture%20%3D%3D%3D%20true%20%3F%20%60textureDimensions%28%20%24%7BtextureProperty%7D%20%29%60%20%3A%20%60textureDimensions%28%20%24%7BtextureProperty%7D%2C%200%20%29%60%3B%0A%20%20%20%20return%20%60textureLoad%28%20%24%7BtextureProperty%7D%2C%20tsl_repeatWrapping%28%20%24%7BuvSnippet%7D%2C%20%24%7Bdimension%7D%20%29%2C%20i32%28%20%24%7BlevelSnippet%7D%20%29%20%29%60%3B%0A%20%20%7D%0A%20%20generateTextureLoad%28texture2%2C%20textureProperty%2C%20uvIndexSnippet%2C%20depthSnippet%2C%20levelSnippet%20%3D%20%220u%22%29%20%7B%0A%20%20%20%20if%20%28depthSnippet%29%20%7B%0A%20%20%20%20%20%20return%20%60textureLoad%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvIndexSnippet%7D%2C%20%24%7BdepthSnippet%7D%2C%20%24%7BlevelSnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20%60textureLoad%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvIndexSnippet%7D%2C%20%24%7BlevelSnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generateTextureStore%28texture2%2C%20textureProperty%2C%20uvIndexSnippet%2C%20valueSnippet%29%20%7B%0A%20%20%20%20return%20%60textureStore%28%20%24%7BtextureProperty%7D%2C%20%24%7BuvIndexSnippet%7D%2C%20%24%7BvalueSnippet%7D%20%29%60%3B%0A%20%20%7D%0A%20%20isUnfilterable%28texture2%29%20%7B%0A%20%20%20%20return%20this.getComponentTypeFromTexture%28texture2%29%20%21%3D%3D%20%22float%22%20%7C%7C%20%21this.isAvailable%28%22float32Filterable%22%29%20%26%26%20texture2.isDataTexture%20%3D%3D%3D%20true%20%26%26%20texture2.type%20%3D%3D%3D%20FloatType2%20%7C%7C%20texture2.isMultisampleRenderTargetTexture%20%3D%3D%3D%20true%3B%0A%20%20%7D%0A%20%20generateTexture%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20depthSnippet%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20let%20snippet%20%3D%20null%3B%0A%20%20%20%20if%20%28texture2.isVideoTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20this._generateVideoSample%28textureProperty%2C%20uvSnippet%2C%20shaderStage%29%3B%0A%20%20%20%20%7D%20else%20if%20%28this.isUnfilterable%28texture2%29%29%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20this.generateTextureLod%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20%220%22%2C%20depthSnippet%2C%20shaderStage%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20this._generateTextureSample%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20depthSnippet%2C%20shaderStage%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippet%3B%0A%20%20%7D%0A%20%20generateTextureGrad%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20gradSnippet%2C%20depthSnippet%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20return%20%60textureSampleGrad%28%20%24%7BtextureProperty%7D%2C%20%24%7BtextureProperty%7D_sampler%2C%20%24%7BuvSnippet%7D%2C%20%20%24%7BgradSnippet%5B0%5D%7D%2C%20%24%7BgradSnippet%5B1%5D%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%60WebGPURenderer%3A%20THREE.TextureNode.gradient%28%29%20does%20not%20support%20%24%7BshaderStage%7D%20shader.%60%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generateTextureCompare%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20compareSnippet%2C%20depthSnippet%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20return%20%60textureSampleCompare%28%20%24%7BtextureProperty%7D%2C%20%24%7BtextureProperty%7D_sampler%2C%20%24%7BuvSnippet%7D%2C%20%24%7BcompareSnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%60WebGPURenderer%3A%20THREE.DepthTexture.compareFunction%28%29%20does%20not%20support%20%24%7BshaderStage%7D%20shader.%60%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20generateTextureLevel%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%2C%20depthSnippet%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20let%20snippet%20%3D%20null%3B%0A%20%20%20%20if%20%28texture2.isVideoTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20this._generateVideoSample%28textureProperty%2C%20uvSnippet%2C%20shaderStage%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20snippet%20%3D%20this._generateTextureSampleLevel%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20levelSnippet%2C%20depthSnippet%2C%20shaderStage%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippet%3B%0A%20%20%7D%0A%20%20generateTextureBias%28texture2%2C%20textureProperty%2C%20uvSnippet%2C%20biasSnippet%2C%20depthSnippet%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20return%20%60textureSampleBias%28%20%24%7BtextureProperty%7D%2C%20%24%7BtextureProperty%7D_sampler%2C%20%24%7BuvSnippet%7D%2C%20%24%7BbiasSnippet%7D%20%29%60%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%60WebGPURenderer%3A%20THREE.TextureNode.biasNode%20does%20not%20support%20%24%7BshaderStage%7D%20shader.%60%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getPropertyName%28node%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20if%20%28node.isNodeVarying%20%3D%3D%3D%20true%20%26%26%20node.needsInterpolation%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%60varyings.%24%7Bnode.name%7D%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28node.isNodeUniform%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20name%20%3D%20node.name%3B%0A%20%20%20%20%20%20const%20type%20%3D%20node.type%3B%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20%22texture%22%20%7C%7C%20type%20%3D%3D%3D%20%22cubeTexture%22%20%7C%7C%20type%20%3D%3D%3D%20%22storageTexture%22%20%7C%7C%20type%20%3D%3D%3D%20%22texture3D%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%20name%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22buffer%22%20%7C%7C%20type%20%3D%3D%3D%20%22storageBuffer%22%20%7C%7C%20type%20%3D%3D%3D%20%22indirectStorageBuffer%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%60NodeBuffer_%24%7Bnode.id%7D.%24%7Bname%7D%60%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20node.groupNode.name%20%2B%20%22.%22%20%2B%20name%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20super.getPropertyName%28node%29%3B%0A%20%20%7D%0A%20%20getOutputStructName%28%29%20%7B%0A%20%20%20%20return%20%22output%22%3B%0A%20%20%7D%0A%20%20_getUniformGroupCount%28shaderStage%29%20%7B%0A%20%20%20%20return%20Object.keys%28this.uniforms%5BshaderStage%5D%29.length%3B%0A%20%20%7D%0A%20%20getFunctionOperator%28op%29%20%7B%0A%20%20%20%20const%20fnOp%20%3D%20wgslFnOpLib%5Bop%5D%3B%0A%20%20%20%20if%20%28fnOp%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this._include%28fnOp%29%3B%0A%20%20%20%20%20%20return%20fnOp%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%20%20getStorageAccess%28node%29%20%7B%0A%20%20%20%20if%20%28node.isStorageTextureNode%29%20%7B%0A%20%20%20%20%20%20switch%20%28node.access%29%20%7B%0A%20%20%20%20%20%20%20%20case%20GPUStorageTextureAccess.ReadOnly%3A%0A%20%20%20%20%20%20%20%20%20%20return%20%22read%22%3B%0A%20%20%20%20%20%20%20%20case%20GPUStorageTextureAccess.WriteOnly%3A%0A%20%20%20%20%20%20%20%20%20%20return%20%22write%22%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20return%20%22read_write%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20switch%20%28node.access%29%20%7B%0A%20%20%20%20%20%20%20%20case%20GPUBufferBindingType.Storage%3A%0A%20%20%20%20%20%20%20%20%20%20return%20%22read_write%22%3B%0A%20%20%20%20%20%20%20%20case%20GPUBufferBindingType.ReadOnlyStorage%3A%0A%20%20%20%20%20%20%20%20%20%20return%20%22read%22%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20return%20%22write%22%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getUniformFromNode%28node%2C%20type%2C%20shaderStage%2C%20name%20%3D%20null%29%20%7B%0A%20%20%20%20const%20uniformNode%20%3D%20super.getUniformFromNode%28node%2C%20type%2C%20shaderStage%2C%20name%29%3B%0A%20%20%20%20const%20nodeData%20%3D%20this.getDataFromNode%28node%2C%20shaderStage%2C%20this.globalCache%29%3B%0A%20%20%20%20if%20%28nodeData.uniformGPU%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20let%20uniformGPU%3B%0A%20%20%20%20%20%20const%20group%20%3D%20node.groupNode%3B%0A%20%20%20%20%20%20const%20groupName%20%3D%20group.name%3B%0A%20%20%20%20%20%20const%20bindings%20%3D%20this.getBindGroupArray%28groupName%2C%20shaderStage%29%3B%0A%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20%22texture%22%20%7C%7C%20type%20%3D%3D%3D%20%22cubeTexture%22%20%7C%7C%20type%20%3D%3D%3D%20%22storageTexture%22%20%7C%7C%20type%20%3D%3D%3D%20%22texture3D%22%29%20%7B%0A%20%20%20%20%20%20%20%20let%20texture2%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20%22texture%22%20%7C%7C%20type%20%3D%3D%3D%20%22storageTexture%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture2%20%3D%20new%20NodeSampledTexture%28uniformNode.name%2C%20uniformNode.node%2C%20group%2C%20node.access%20%3F%20node.access%20%3A%20null%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22cubeTexture%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture2%20%3D%20new%20NodeSampledCubeTexture%28uniformNode.name%2C%20uniformNode.node%2C%20group%2C%20node.access%20%3F%20node.access%20%3A%20null%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22texture3D%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture2%20%3D%20new%20NodeSampledTexture3D%28uniformNode.name%2C%20uniformNode.node%2C%20group%2C%20node.access%20%3F%20node.access%20%3A%20null%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20texture2.store%20%3D%20node.isStorageTextureNode%20%3D%3D%3D%20true%3B%0A%20%20%20%20%20%20%20%20texture2.setVisibility%28gpuShaderStageLib%5BshaderStage%5D%29%3B%0A%20%20%20%20%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%20%26%26%20this.isUnfilterable%28node.value%29%20%3D%3D%3D%20false%20%26%26%20texture2.store%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20sampler%20%3D%20new%20NodeSampler%28%60%24%7BuniformNode.name%7D_sampler%60%2C%20uniformNode.node%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%20%20sampler.setVisibility%28gpuShaderStageLib%5BshaderStage%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20bindings.push%28sampler%2C%20texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20uniformGPU%20%3D%20%5Bsampler%2C%20texture2%5D%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20bindings.push%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20uniformGPU%20%3D%20%5Btexture2%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20%22buffer%22%20%7C%7C%20type%20%3D%3D%3D%20%22storageBuffer%22%20%7C%7C%20type%20%3D%3D%3D%20%22indirectStorageBuffer%22%29%20%7B%0A%20%20%20%20%20%20%20%20const%20bufferClass%20%3D%20type%20%3D%3D%3D%20%22buffer%22%20%3F%20NodeUniformBuffer%20%3A%20NodeStorageBuffer%3B%0A%20%20%20%20%20%20%20%20const%20buffer2%20%3D%20new%20bufferClass%28node%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20buffer2.setVisibility%28gpuShaderStageLib%5BshaderStage%5D%29%3B%0A%20%20%20%20%20%20%20%20bindings.push%28buffer2%29%3B%0A%20%20%20%20%20%20%20%20uniformGPU%20%3D%20buffer2%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20uniformsStage%20%3D%20this.uniformGroups%5BshaderStage%5D%20%7C%7C%20%28this.uniformGroups%5BshaderStage%5D%20%3D%20%7B%7D%29%3B%0A%20%20%20%20%20%20%20%20let%20uniformsGroup%20%3D%20uniformsStage%5BgroupName%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28uniformsGroup%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20uniformsGroup%20%3D%20new%20NodeUniformsGroup%28groupName%2C%20group%29%3B%0A%20%20%20%20%20%20%20%20%20%20uniformsGroup.setVisibility%28gpuShaderStageLib%5BshaderStage%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20uniformsStage%5BgroupName%5D%20%3D%20uniformsGroup%3B%0A%20%20%20%20%20%20%20%20%20%20bindings.push%28uniformsGroup%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20uniformGPU%20%3D%20this.getNodeUniform%28uniformNode%2C%20type%29%3B%0A%20%20%20%20%20%20%20%20uniformsGroup.addUniform%28uniformGPU%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20nodeData.uniformGPU%20%3D%20uniformGPU%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20uniformNode%3B%0A%20%20%7D%0A%20%20getBuiltin%28name%2C%20property2%2C%20type%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20const%20map%20%3D%20this.builtins%5BshaderStage%5D%20%7C%7C%20%28this.builtins%5BshaderStage%5D%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%29%3B%0A%20%20%20%20if%20%28map.has%28name%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20map.set%28name%2C%20%7B%0A%20%20%20%20%20%20%20%20name%2C%0A%20%20%20%20%20%20%20%20property%3A%20property2%2C%0A%20%20%20%20%20%20%20%20type%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20property2%3B%0A%20%20%7D%0A%20%20hasBuiltin%28name%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20return%20this.builtins%5BshaderStage%5D%20%21%3D%3D%20void%200%20%26%26%20this.builtins%5BshaderStage%5D.has%28name%29%3B%0A%20%20%7D%0A%20%20getVertexIndex%28%29%20%7B%0A%20%20%20%20if%20%28this.shaderStage%20%3D%3D%3D%20%22vertex%22%29%20%7B%0A%20%20%20%20%20%20return%20this.getBuiltin%28%22vertex_index%22%2C%20%22vertexIndex%22%2C%20%22u32%22%2C%20%22attribute%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%22vertexIndex%22%3B%0A%20%20%7D%0A%20%20buildFunctionCode%28shaderNode%29%20%7B%0A%20%20%20%20const%20layout%20%3D%20shaderNode.layout%3B%0A%20%20%20%20const%20flowData%20%3D%20this.flowShaderNode%28shaderNode%29%3B%0A%20%20%20%20const%20parameters%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28const%20input%20of%20layout.inputs%29%20%7B%0A%20%20%20%20%20%20parameters.push%28input.name%20%2B%20%22%20%3A%20%22%20%2B%20this.getType%28input.type%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20code%20%3D%20%60fn%20%24%7Blayout.name%7D%28%20%24%7Bparameters.join%28%22%2C%20%22%29%7D%20%29%20-%3E%20%24%7Bthis.getType%28layout.type%29%7D%20%7B%0A%24%7BflowData.vars%7D%0A%24%7BflowData.code%7D%0A%60%3B%0A%20%20%20%20if%20%28flowData.result%29%20%7B%0A%20%20%20%20%20%20code%20%2B%3D%20%60%09return%20%24%7BflowData.result%7D%3B%0A%60%3B%0A%20%20%20%20%7D%0A%20%20%20%20code%20%2B%3D%20%22%5Cn%7D%5Cn%22%3B%0A%20%20%20%20return%20code%3B%0A%20%20%7D%0A%20%20getInstanceIndex%28%29%20%7B%0A%20%20%20%20if%20%28this.shaderStage%20%3D%3D%3D%20%22vertex%22%29%20%7B%0A%20%20%20%20%20%20return%20this.getBuiltin%28%22instance_index%22%2C%20%22instanceIndex%22%2C%20%22u32%22%2C%20%22attribute%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%22instanceIndex%22%3B%0A%20%20%7D%0A%20%20getInvocationLocalIndex%28%29%20%7B%0A%20%20%20%20return%20this.getBuiltin%28%22local_invocation_index%22%2C%20%22invocationLocalIndex%22%2C%20%22u32%22%2C%20%22attribute%22%29%3B%0A%20%20%7D%0A%20%20getSubgroupSize%28%29%20%7B%0A%20%20%20%20this.enableSubGroups%28%29%3B%0A%20%20%20%20return%20this.getBuiltin%28%22subgroup_size%22%2C%20%22subgroupSize%22%2C%20%22u32%22%2C%20%22attribute%22%29%3B%0A%20%20%7D%0A%20%20getInvocationSubgroupIndex%28%29%20%7B%0A%20%20%20%20this.enableSubGroups%28%29%3B%0A%20%20%20%20return%20this.getBuiltin%28%22subgroup_invocation_id%22%2C%20%22invocationSubgroupIndex%22%2C%20%22u32%22%2C%20%22attribute%22%29%3B%0A%20%20%7D%0A%20%20getSubgroupIndex%28%29%20%7B%0A%20%20%20%20this.enableSubGroups%28%29%3B%0A%20%20%20%20return%20this.getBuiltin%28%22subgroup_id%22%2C%20%22subgroupIndex%22%2C%20%22u32%22%2C%20%22attribute%22%29%3B%0A%20%20%7D%0A%20%20getDrawIndex%28%29%20%7B%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%20%20getFrontFacing%28%29%20%7B%0A%20%20%20%20return%20this.getBuiltin%28%22front_facing%22%2C%20%22isFront%22%2C%20%22bool%22%29%3B%0A%20%20%7D%0A%20%20getFragCoord%28%29%20%7B%0A%20%20%20%20return%20this.getBuiltin%28%22position%22%2C%20%22fragCoord%22%2C%20%22vec4%3Cf32%3E%22%29%20%2B%20%22.xy%22%3B%0A%20%20%7D%0A%20%20getFragDepth%28%29%20%7B%0A%20%20%20%20return%20%22output.%22%20%2B%20this.getBuiltin%28%22frag_depth%22%2C%20%22depth%22%2C%20%22f32%22%2C%20%22output%22%29%3B%0A%20%20%7D%0A%20%20isFlipY%28%29%20%7B%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20enableDirective%28name%2C%20shaderStage%20%3D%20this.shaderStage%29%20%7B%0A%20%20%20%20const%20stage%20%3D%20this.directives%5BshaderStage%5D%20%7C%7C%20%28this.directives%5BshaderStage%5D%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%29%29%3B%0A%20%20%20%20stage.add%28name%29%3B%0A%20%20%7D%0A%20%20getDirectives%28shaderStage%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20directives%20%3D%20this.directives%5BshaderStage%5D%3B%0A%20%20%20%20if%20%28directives%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20directive%20of%20directives%29%20%7B%0A%20%20%20%20%20%20%20%20snippets.push%28%60enable%20%24%7Bdirective%7D%3B%60%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippets.join%28%22%5Cn%22%29%3B%0A%20%20%7D%0A%20%20enableSubGroups%28%29%20%7B%0A%20%20%20%20this.enableDirective%28%22subgroups%22%29%3B%0A%20%20%7D%0A%20%20enableSubgroupsF16%28%29%20%7B%0A%20%20%20%20this.enableDirective%28%22subgroups-f16%22%29%3B%0A%20%20%7D%0A%20%20enableClipDistances%28%29%20%7B%0A%20%20%20%20this.enableDirective%28%22clip_distances%22%29%3B%0A%20%20%7D%0A%20%20enableShaderF16%28%29%20%7B%0A%20%20%20%20this.enableDirective%28%22f16%22%29%3B%0A%20%20%7D%0A%20%20enableDualSourceBlending%28%29%20%7B%0A%20%20%20%20this.enableDirective%28%22dual_source_blending%22%29%3B%0A%20%20%7D%0A%20%20getBuiltins%28shaderStage%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20builtins%20%3D%20this.builtins%5BshaderStage%5D%3B%0A%20%20%20%20if%20%28builtins%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20%7B%20name%2C%20property%3A%20property2%2C%20type%20%7D%20of%20builtins.values%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20snippets.push%28%60%40builtin%28%20%24%7Bname%7D%20%29%20%24%7Bproperty2%7D%20%3A%20%24%7Btype%7D%60%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippets.join%28%22%2C%5Cn%09%22%29%3B%0A%20%20%7D%0A%20%20getScopedArray%28name%2C%20scope%2C%20bufferType%2C%20bufferCount%29%20%7B%0A%20%20%20%20if%20%28this.scopedArrays.has%28name%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20this.scopedArrays.set%28name%2C%20%7B%0A%20%20%20%20%20%20%20%20name%2C%0A%20%20%20%20%20%20%20%20scope%2C%0A%20%20%20%20%20%20%20%20bufferType%2C%0A%20%20%20%20%20%20%20%20bufferCount%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20name%3B%0A%20%20%7D%0A%20%20getScopedArrays%28shaderStage%29%20%7B%0A%20%20%20%20if%20%28shaderStage%20%21%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28const%20%7B%20name%2C%20scope%2C%20bufferType%2C%20bufferCount%20%7D%20of%20this.scopedArrays.values%28%29%29%20%7B%0A%20%20%20%20%20%20const%20type%20%3D%20this.getType%28bufferType%29%3B%0A%20%20%20%20%20%20snippets.push%28%60var%3C%24%7Bscope%7D%3E%20%24%7Bname%7D%3A%20array%3C%20%24%7Btype%7D%2C%20%24%7BbufferCount%7D%20%3E%3B%60%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippets.join%28%22%5Cn%22%29%3B%0A%20%20%7D%0A%20%20getAttributes%28shaderStage%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20this.getBuiltin%28%22global_invocation_id%22%2C%20%22id%22%2C%20%22vec3%3Cu32%3E%22%2C%20%22attribute%22%29%3B%0A%20%20%20%20%20%20this.getBuiltin%28%22workgroup_id%22%2C%20%22workgroupId%22%2C%20%22vec3%3Cu32%3E%22%2C%20%22attribute%22%29%3B%0A%20%20%20%20%20%20this.getBuiltin%28%22local_invocation_id%22%2C%20%22localId%22%2C%20%22vec3%3Cu32%3E%22%2C%20%22attribute%22%29%3B%0A%20%20%20%20%20%20this.getBuiltin%28%22num_workgroups%22%2C%20%22numWorkgroups%22%2C%20%22vec3%3Cu32%3E%22%2C%20%22attribute%22%29%3B%0A%20%20%20%20%20%20if%20%28this.renderer.hasFeature%28%22subgroups%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20this.enableDirective%28%22subgroups%22%2C%20shaderStage%29%3B%0A%20%20%20%20%20%20%20%20this.getBuiltin%28%22subgroup_size%22%2C%20%22subgroupSize%22%2C%20%22u32%22%2C%20%22attribute%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%20%7C%7C%20shaderStage%20%3D%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20const%20builtins%20%3D%20this.getBuiltins%28%22attribute%22%29%3B%0A%20%20%20%20%20%20if%20%28builtins%29%20snippets.push%28builtins%29%3B%0A%20%20%20%20%20%20const%20attributes%20%3D%20this.getAttributesArray%28%29%3B%0A%20%20%20%20%20%20for%20%28let%20index5%20%3D%200%2C%20length2%20%3D%20attributes.length%3B%20index5%20%3C%20length2%3B%20index5%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20attribute2%20%3D%20attributes%5Bindex5%5D%3B%0A%20%20%20%20%20%20%20%20const%20name%20%3D%20attribute2.name%3B%0A%20%20%20%20%20%20%20%20const%20type%20%3D%20this.getType%28attribute2.type%29%3B%0A%20%20%20%20%20%20%20%20snippets.push%28%60%40location%28%20%24%7Bindex5%7D%20%29%20%24%7Bname%7D%20%3A%20%24%7Btype%7D%60%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippets.join%28%22%2C%5Cn%09%22%29%3B%0A%20%20%7D%0A%20%20getStructMembers%28struct%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20members%20%3D%20struct.getMemberTypes%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20members.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20member%20%3D%20members%5Bi%5D%3B%0A%20%20%20%20%20%20snippets.push%28%60%09%40location%28%20%24%7Bi%7D%20%29%20m%24%7Bi%7D%20%3A%20%24%7Bmember%7D%3Cf32%3E%60%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20builtins%20%3D%20this.getBuiltins%28%22output%22%29%3B%0A%20%20%20%20if%20%28builtins%29%20snippets.push%28%22%09%22%20%2B%20builtins%29%3B%0A%20%20%20%20return%20snippets.join%28%22%2C%5Cn%22%29%3B%0A%20%20%7D%0A%20%20getStructs%28shaderStage%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20structs%20%3D%20this.structs%5BshaderStage%5D%3B%0A%20%20%20%20for%20%28let%20index5%20%3D%200%2C%20length2%20%3D%20structs.length%3B%20index5%20%3C%20length2%3B%20index5%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20struct%20%3D%20structs%5Bindex5%5D%3B%0A%20%20%20%20%20%20const%20name%20%3D%20struct.name%3B%0A%20%20%20%20%20%20let%20snippet%20%3D%20%60struct%20%24%7Bname%7D%20%7B%0A%60%3B%0A%20%20%20%20%20%20snippet%20%2B%3D%20this.getStructMembers%28struct%29%3B%0A%20%20%20%20%20%20snippet%20%2B%3D%20%22%5Cn%7D%22%3B%0A%20%20%20%20%20%20snippets.push%28snippet%29%3B%0A%20%20%20%20%20%20snippets.push%28%60%0Avar%3Cprivate%3E%20output%20%3A%20%24%7Bname%7D%3B%0A%0A%60%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20snippets.join%28%22%5Cn%5Cn%22%29%3B%0A%20%20%7D%0A%20%20getVar%28type%2C%20name%29%20%7B%0A%20%20%20%20return%20%60var%20%24%7Bname%7D%20%3A%20%24%7Bthis.getType%28type%29%7D%60%3B%0A%20%20%7D%0A%20%20getVars%28shaderStage%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20vars%20%3D%20this.vars%5BshaderStage%5D%3B%0A%20%20%20%20if%20%28vars%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20for%20%28const%20variable%20of%20vars%29%20%7B%0A%20%20%20%20%20%20%20%20snippets.push%28%60%09%24%7Bthis.getVar%28variable.type%2C%20variable.name%29%7D%3B%60%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20%60%0A%24%7Bsnippets.join%28%22%5Cn%22%29%7D%0A%60%3B%0A%20%20%7D%0A%20%20getVaryings%28shaderStage%29%20%7B%0A%20%20%20%20const%20snippets%20%3D%20%5B%5D%3B%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%29%20%7B%0A%20%20%20%20%20%20this.getBuiltin%28%22position%22%2C%20%22Vertex%22%2C%20%22vec4%3Cf32%3E%22%2C%20%22vertex%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%20%7C%7C%20shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20const%20varyings%20%3D%20this.varyings%3B%0A%20%20%20%20%20%20const%20vars%20%3D%20this.vars%5BshaderStage%5D%3B%0A%20%20%20%20%20%20for%20%28let%20index5%20%3D%200%3B%20index5%20%3C%20varyings.length%3B%20index5%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20varying2%20%3D%20varyings%5Bindex5%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28varying2.needsInterpolation%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20let%20attributesSnippet%20%3D%20%60%40location%28%20%24%7Bindex5%7D%20%29%60%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%2F%5E%28int%7Cuint%7Civec%7Cuvec%29%2F.test%28varying2.type%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20attributesSnippet%20%2B%3D%20%22%20%40interpolate%28%20flat%20%29%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20snippets.push%28%60%24%7BattributesSnippet%7D%20%24%7Bvarying2.name%7D%20%3A%20%24%7Bthis.getType%28varying2.type%29%7D%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%20%26%26%20vars.includes%28varying2%29%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20vars.push%28varying2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20builtins%20%3D%20this.getBuiltins%28shaderStage%29%3B%0A%20%20%20%20if%20%28builtins%29%20snippets.push%28builtins%29%3B%0A%20%20%20%20const%20code%20%3D%20snippets.join%28%22%2C%5Cn%09%22%29%3B%0A%20%20%20%20return%20shaderStage%20%3D%3D%3D%20%22vertex%22%20%3F%20this._getWGSLStruct%28%22VaryingsStruct%22%2C%20%22%09%22%20%2B%20code%29%20%3A%20code%3B%0A%20%20%7D%0A%20%20getUniforms%28shaderStage%29%20%7B%0A%20%20%20%20const%20uniforms%20%3D%20this.uniforms%5BshaderStage%5D%3B%0A%20%20%20%20const%20bindingSnippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20bufferSnippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20structSnippets%20%3D%20%5B%5D%3B%0A%20%20%20%20const%20uniformGroups%20%3D%20%7B%7D%3B%0A%20%20%20%20for%20%28const%20uniform2%20of%20uniforms%29%20%7B%0A%20%20%20%20%20%20const%20groupName%20%3D%20uniform2.groupNode.name%3B%0A%20%20%20%20%20%20const%20uniformIndexes%20%3D%20this.bindingsIndexes%5BgroupName%5D%3B%0A%20%20%20%20%20%20if%20%28uniform2.type%20%3D%3D%3D%20%22texture%22%20%7C%7C%20uniform2.type%20%3D%3D%3D%20%22cubeTexture%22%20%7C%7C%20uniform2.type%20%3D%3D%3D%20%22storageTexture%22%20%7C%7C%20uniform2.type%20%3D%3D%3D%20%22texture3D%22%29%20%7B%0A%20%20%20%20%20%20%20%20const%20texture2%20%3D%20uniform2.node.value%3B%0A%20%20%20%20%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%20%26%26%20this.isUnfilterable%28texture2%29%20%3D%3D%3D%20false%20%26%26%20uniform2.node.isStorageTextureNode%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28texture2.isDepthTexture%20%3D%3D%3D%20true%20%26%26%20texture2.compareFunction%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20bindingSnippets.push%28%60%40binding%28%20%24%7BuniformIndexes.binding%2B%2B%7D%20%29%20%40group%28%20%24%7BuniformIndexes.group%7D%20%29%20var%20%24%7Buniform2.name%7D_sampler%20%3A%20sampler_comparison%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20bindingSnippets.push%28%60%40binding%28%20%24%7BuniformIndexes.binding%2B%2B%7D%20%29%20%40group%28%20%24%7BuniformIndexes.group%7D%20%29%20var%20%24%7Buniform2.name%7D_sampler%20%3A%20sampler%3B%60%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20let%20textureType%3B%0A%20%20%20%20%20%20%20%20let%20multisampled%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20if%20%28texture2.isMultisampleRenderTargetTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20multisampled%20%3D%20%22_multisampled%22%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28texture2.isCubeTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20textureType%20%3D%20%22texture_cube%3Cf32%3E%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isDataArrayTexture%20%3D%3D%3D%20true%20%7C%7C%20texture2.isCompressedArrayTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20textureType%20%3D%20%22texture_2d_array%3Cf32%3E%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isDepthTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20textureType%20%3D%20%60texture_depth%24%7Bmultisampled%7D_2d%60%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isVideoTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20textureType%20%3D%20%22texture_external%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28texture2.isData3DTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20textureType%20%3D%20%22texture_3d%3Cf32%3E%22%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28uniform2.node.isStorageTextureNode%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20format2%20%3D%20getFormat2%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20access%20%3D%20this.getStorageAccess%28uniform2.node%29%3B%0A%20%20%20%20%20%20%20%20%20%20textureType%20%3D%20%60texture_storage_2d%3C%24%7Bformat2%7D%2C%20%24%7Baccess%7D%3E%60%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20componentPrefix%20%3D%20this.getComponentTypeFromTexture%28texture2%29.charAt%280%29%3B%0A%20%20%20%20%20%20%20%20%20%20textureType%20%3D%20%60texture%24%7Bmultisampled%7D_2d%3C%24%7BcomponentPrefix%7D32%3E%60%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20bindingSnippets.push%28%60%40binding%28%20%24%7BuniformIndexes.binding%2B%2B%7D%20%29%20%40group%28%20%24%7BuniformIndexes.group%7D%20%29%20var%20%24%7Buniform2.name%7D%20%3A%20%24%7BtextureType%7D%3B%60%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28uniform2.type%20%3D%3D%3D%20%22buffer%22%20%7C%7C%20uniform2.type%20%3D%3D%3D%20%22storageBuffer%22%20%7C%7C%20uniform2.type%20%3D%3D%3D%20%22indirectStorageBuffer%22%29%20%7B%0A%20%20%20%20%20%20%20%20const%20bufferNode%20%3D%20uniform2.node%3B%0A%20%20%20%20%20%20%20%20const%20bufferType%20%3D%20this.getType%28bufferNode.bufferType%29%3B%0A%20%20%20%20%20%20%20%20const%20bufferCount%20%3D%20bufferNode.bufferCount%3B%0A%20%20%20%20%20%20%20%20const%20bufferCountSnippet%20%3D%20bufferCount%20%3E%200%20%26%26%20uniform2.type%20%3D%3D%3D%20%22buffer%22%20%3F%20%22%2C%20%22%20%2B%20bufferCount%20%3A%20%22%22%3B%0A%20%20%20%20%20%20%20%20const%20bufferTypeSnippet%20%3D%20bufferNode.isAtomic%20%3F%20%60atomic%3C%24%7BbufferType%7D%3E%60%20%3A%20%60%24%7BbufferType%7D%60%3B%0A%20%20%20%20%20%20%20%20const%20bufferSnippet%20%3D%20%60%09%24%7Buniform2.name%7D%20%3A%20array%3C%20%24%7BbufferTypeSnippet%7D%24%7BbufferCountSnippet%7D%20%3E%0A%60%3B%0A%20%20%20%20%20%20%20%20const%20bufferAccessMode%20%3D%20bufferNode.isStorageBufferNode%20%3F%20%60storage%2C%20%24%7Bthis.getStorageAccess%28bufferNode%29%7D%60%20%3A%20%22uniform%22%3B%0A%20%20%20%20%20%20%20%20bufferSnippets.push%28this._getWGSLStructBinding%28%22NodeBuffer_%22%20%2B%20bufferNode.id%2C%20bufferSnippet%2C%20bufferAccessMode%2C%20uniformIndexes.binding%2B%2B%2C%20uniformIndexes.group%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20const%20vectorType%20%3D%20this.getType%28this.getVectorType%28uniform2.type%29%29%3B%0A%20%20%20%20%20%20%20%20const%20groupName2%20%3D%20uniform2.groupNode.name%3B%0A%20%20%20%20%20%20%20%20const%20group%20%3D%20uniformGroups%5BgroupName2%5D%20%7C%7C%20%28uniformGroups%5BgroupName2%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20index%3A%20uniformIndexes.binding%2B%2B%2C%0A%20%20%20%20%20%20%20%20%20%20id%3A%20uniformIndexes.group%2C%0A%20%20%20%20%20%20%20%20%20%20snippets%3A%20%5B%5D%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20group.snippets.push%28%60%09%24%7Buniform2.name%7D%20%3A%20%24%7BvectorType%7D%60%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20for%20%28const%20name%20in%20uniformGroups%29%20%7B%0A%20%20%20%20%20%20const%20group%20%3D%20uniformGroups%5Bname%5D%3B%0A%20%20%20%20%20%20structSnippets.push%28this._getWGSLStructBinding%28name%2C%20group.snippets.join%28%22%2C%5Cn%22%29%2C%20%22uniform%22%2C%20group.index%2C%20group.id%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20code%20%3D%20bindingSnippets.join%28%22%5Cn%22%29%3B%0A%20%20%20%20code%20%2B%3D%20bufferSnippets.join%28%22%5Cn%22%29%3B%0A%20%20%20%20code%20%2B%3D%20structSnippets.join%28%22%5Cn%22%29%3B%0A%20%20%20%20return%20code%3B%0A%20%20%7D%0A%20%20buildCode%28%29%20%7B%0A%20%20%20%20const%20shadersData%20%3D%20this.material%20%21%3D%3D%20null%20%3F%20%7B%20fragment%3A%20%7B%7D%2C%20vertex%3A%20%7B%7D%20%7D%20%3A%20%7B%20compute%3A%20%7B%7D%20%7D%3B%0A%20%20%20%20this.sortBindingGroups%28%29%3B%0A%20%20%20%20for%20%28const%20shaderStage%20in%20shadersData%29%20%7B%0A%20%20%20%20%20%20const%20stageData%20%3D%20shadersData%5BshaderStage%5D%3B%0A%20%20%20%20%20%20stageData.uniforms%20%3D%20this.getUniforms%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.attributes%20%3D%20this.getAttributes%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.varyings%20%3D%20this.getVaryings%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.structs%20%3D%20this.getStructs%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.vars%20%3D%20this.getVars%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.codes%20%3D%20this.getCodes%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.directives%20%3D%20this.getDirectives%28shaderStage%29%3B%0A%20%20%20%20%20%20stageData.scopedArrays%20%3D%20this.getScopedArrays%28shaderStage%29%3B%0A%20%20%20%20%20%20let%20flow%20%3D%20%22%2F%2F%20code%5Cn%5Cn%22%3B%0A%20%20%20%20%20%20flow%20%2B%3D%20this.flowCode%5BshaderStage%5D%3B%0A%20%20%20%20%20%20const%20flowNodes%20%3D%20this.flowNodes%5BshaderStage%5D%3B%0A%20%20%20%20%20%20const%20mainNode%20%3D%20flowNodes%5BflowNodes.length%20-%201%5D%3B%0A%20%20%20%20%20%20const%20outputNode%20%3D%20mainNode.outputNode%3B%0A%20%20%20%20%20%20const%20isOutputStruct%20%3D%20outputNode%20%21%3D%3D%20void%200%20%26%26%20outputNode.isOutputStructNode%20%3D%3D%3D%20true%3B%0A%20%20%20%20%20%20for%20%28const%20node%20of%20flowNodes%29%20%7B%0A%20%20%20%20%20%20%20%20const%20flowSlotData%20%3D%20this.getFlowData%28%0A%20%20%20%20%20%20%20%20%20%20node%0A%20%20%20%20%20%20%20%20%20%20%2F%2A%2C%20shaderStage%2A%2F%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20const%20slotName%20%3D%20node.name%3B%0A%20%20%20%20%20%20%20%20if%20%28slotName%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28flow.length%20%3E%200%29%20flow%20%2B%3D%20%22%5Cn%22%3B%0A%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%60%09%2F%2F%20flow%20-%3E%20%24%7BslotName%7D%0A%09%60%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20flow%20%2B%3D%20%60%24%7BflowSlotData.code%7D%0A%09%60%3B%0A%20%20%20%20%20%20%20%20if%20%28node%20%3D%3D%3D%20mainNode%20%26%26%20shaderStage%20%21%3D%3D%20%22compute%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%22%2F%2F%20result%5Cn%5Cn%09%22%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28shaderStage%20%3D%3D%3D%20%22vertex%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%60varyings.Vertex%20%3D%20%24%7BflowSlotData.result%7D%3B%60%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28shaderStage%20%3D%3D%3D%20%22fragment%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28isOutputStruct%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stageData.returnType%20%3D%20outputNode.nodeType%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%60return%20%24%7BflowSlotData.result%7D%3B%60%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20structSnippet%20%3D%20%22%09%40location%280%29%20color%3A%20vec4%3Cf32%3E%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20builtins%20%3D%20this.getBuiltins%28%22output%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28builtins%29%20structSnippet%20%2B%3D%20%22%2C%5Cn%09%22%20%2B%20builtins%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stageData.returnType%20%3D%20%22OutputStruct%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stageData.structs%20%2B%3D%20this._getWGSLStruct%28%22OutputStruct%22%2C%20structSnippet%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stageData.structs%20%2B%3D%20%22%5Cnvar%3Cprivate%3E%20output%20%3A%20OutputStruct%3B%5Cn%5Cn%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20flow%20%2B%3D%20%60output.color%20%3D%20%24%7BflowSlotData.result%7D%3B%0A%0A%09return%20output%3B%60%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20stageData.flow%20%3D%20flow%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.material%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.vertexShader%20%3D%20this._getWGSLVertexCode%28shadersData.vertex%29%3B%0A%20%20%20%20%20%20this.fragmentShader%20%3D%20this._getWGSLFragmentCode%28shadersData.fragment%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.computeShader%20%3D%20this._getWGSLComputeCode%28shadersData.compute%2C%20%28this.object.workgroupSize%20%7C%7C%20%5B64%5D%29.join%28%22%2C%20%22%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20getMethod%28method%2C%20output2%20%3D%20null%29%20%7B%0A%20%20%20%20let%20wgslMethod%3B%0A%20%20%20%20if%20%28output2%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20wgslMethod%20%3D%20this._getWGSLMethod%28method%20%2B%20%22_%22%20%2B%20output2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28wgslMethod%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20wgslMethod%20%3D%20this._getWGSLMethod%28method%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20wgslMethod%20%7C%7C%20method%3B%0A%20%20%7D%0A%20%20getType%28type%29%20%7B%0A%20%20%20%20return%20wgslTypeLib%5Btype%5D%20%7C%7C%20type%3B%0A%20%20%7D%0A%20%20isAvailable%28name%29%20%7B%0A%20%20%20%20let%20result%20%3D%20supports%5Bname%5D%3B%0A%20%20%20%20if%20%28result%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20if%20%28name%20%3D%3D%3D%20%22float32Filterable%22%29%20%7B%0A%20%20%20%20%20%20%20%20result%20%3D%20this.renderer.hasFeature%28%22float32-filterable%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20supports%5Bname%5D%20%3D%20result%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20result%3B%0A%20%20%7D%0A%20%20_getWGSLMethod%28method%29%20%7B%0A%20%20%20%20if%20%28wgslPolyfill%5Bmethod%5D%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20this._include%28method%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20wgslMethods%5Bmethod%5D%3B%0A%20%20%7D%0A%20%20_include%28name%29%20%7B%0A%20%20%20%20const%20codeNode%20%3D%20wgslPolyfill%5Bname%5D%3B%0A%20%20%20%20codeNode.build%28this%29%3B%0A%20%20%20%20if%20%28this.currentFunctionNode%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.currentFunctionNode.includes.push%28codeNode%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20codeNode%3B%0A%20%20%7D%0A%20%20_getWGSLVertexCode%28shaderData%29%20%7B%0A%20%20%20%20return%20%60%24%7Bthis.getSignature%28%29%7D%0A%2F%2F%20directives%0A%24%7BshaderData.directives%7D%0A%0A%2F%2F%20uniforms%0A%24%7BshaderData.uniforms%7D%0A%0A%2F%2F%20varyings%0A%24%7BshaderData.varyings%7D%0Avar%3Cprivate%3E%20varyings%20%3A%20VaryingsStruct%3B%0A%0A%2F%2F%20codes%0A%24%7BshaderData.codes%7D%0A%0A%40vertex%0Afn%20main%28%20%24%7BshaderData.attributes%7D%20%29%20-%3E%20VaryingsStruct%20%7B%0A%0A%09%2F%2F%20vars%0A%09%24%7BshaderData.vars%7D%0A%0A%09%2F%2F%20flow%0A%09%24%7BshaderData.flow%7D%0A%0A%09return%20varyings%3B%0A%0A%7D%0A%60%3B%0A%20%20%7D%0A%20%20_getWGSLFragmentCode%28shaderData%29%20%7B%0A%20%20%20%20return%20%60%24%7Bthis.getSignature%28%29%7D%0A%2F%2F%20global%0A%24%7Bdiagnostics%7D%0A%0A%2F%2F%20uniforms%0A%24%7BshaderData.uniforms%7D%0A%0A%2F%2F%20structs%0A%24%7BshaderData.structs%7D%0A%0A%2F%2F%20codes%0A%24%7BshaderData.codes%7D%0A%0A%40fragment%0Afn%20main%28%20%24%7BshaderData.varyings%7D%20%29%20-%3E%20%24%7BshaderData.returnType%7D%20%7B%0A%0A%09%2F%2F%20vars%0A%09%24%7BshaderData.vars%7D%0A%0A%09%2F%2F%20flow%0A%09%24%7BshaderData.flow%7D%0A%0A%7D%0A%60%3B%0A%20%20%7D%0A%20%20_getWGSLComputeCode%28shaderData%2C%20workgroupSize%29%20%7B%0A%20%20%20%20return%20%60%24%7Bthis.getSignature%28%29%7D%0A%2F%2F%20directives%0A%24%7BshaderData.directives%7D%0A%0A%2F%2F%20system%0Avar%3Cprivate%3E%20instanceIndex%20%3A%20u32%3B%0A%0A%2F%2F%20locals%0A%24%7BshaderData.scopedArrays%7D%0A%0A%2F%2F%20uniforms%0A%24%7BshaderData.uniforms%7D%0A%0A%2F%2F%20codes%0A%24%7BshaderData.codes%7D%0A%0A%40compute%20%40workgroup_size%28%20%24%7BworkgroupSize%7D%20%29%0Afn%20main%28%20%24%7BshaderData.attributes%7D%20%29%20%7B%0A%0A%09%2F%2F%20system%0A%09instanceIndex%20%3D%20id.x%20%2B%20id.y%20%2A%20numWorkgroups.x%20%2A%20u32%28%24%7BworkgroupSize%7D%29%20%2B%20id.z%20%2A%20numWorkgroups.x%20%2A%20numWorkgroups.y%20%2A%20u32%28%24%7BworkgroupSize%7D%29%3B%0A%0A%09%2F%2F%20vars%0A%09%24%7BshaderData.vars%7D%0A%0A%09%2F%2F%20flow%0A%09%24%7BshaderData.flow%7D%0A%0A%7D%0A%60%3B%0A%20%20%7D%0A%20%20_getWGSLStruct%28name%2C%20vars%29%20%7B%0A%20%20%20%20return%20%60%0Astruct%20%24%7Bname%7D%20%7B%0A%24%7Bvars%7D%0A%7D%3B%60%3B%0A%20%20%7D%0A%20%20_getWGSLStructBinding%28name%2C%20vars%2C%20access%2C%20binding%20%3D%200%2C%20group%20%3D%200%29%20%7B%0A%20%20%20%20const%20structName%20%3D%20name%20%2B%20%22Struct%22%3B%0A%20%20%20%20const%20structSnippet%20%3D%20this._getWGSLStruct%28structName%2C%20vars%29%3B%0A%20%20%20%20return%20%60%24%7BstructSnippet%7D%0A%40binding%28%20%24%7Bbinding%7D%20%29%20%40group%28%20%24%7Bgroup%7D%20%29%0Avar%3C%24%7Baccess%7D%3E%20%24%7Bname%7D%20%3A%20%24%7BstructName%7D%3B%60%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGPUUtils%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%7D%0A%20%20getCurrentDepthStencilFormat%28renderContext%29%20%7B%0A%20%20%20%20let%20format2%3B%0A%20%20%20%20if%20%28renderContext.depthTexture%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20format2%20%3D%20this.getTextureFormatGPU%28renderContext.depthTexture%29%3B%0A%20%20%20%20%7D%20else%20if%20%28renderContext.depth%20%26%26%20renderContext.stencil%29%20%7B%0A%20%20%20%20%20%20format2%20%3D%20GPUTextureFormat.Depth24PlusStencil8%3B%0A%20%20%20%20%7D%20else%20if%20%28renderContext.depth%29%20%7B%0A%20%20%20%20%20%20format2%20%3D%20GPUTextureFormat.Depth24Plus%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20format2%3B%0A%20%20%7D%0A%20%20getTextureFormatGPU%28texture2%29%20%7B%0A%20%20%20%20return%20this.backend.get%28texture2%29.format%3B%0A%20%20%7D%0A%20%20getCurrentColorFormat%28renderContext%29%20%7B%0A%20%20%20%20let%20format2%3B%0A%20%20%20%20if%20%28renderContext.textures%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20format2%20%3D%20this.getTextureFormatGPU%28renderContext.textures%5B0%5D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20format2%20%3D%20this.getPreferredCanvasFormat%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20format2%3B%0A%20%20%7D%0A%20%20getCurrentColorSpace%28renderContext%29%20%7B%0A%20%20%20%20if%20%28renderContext.textures%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20renderContext.textures%5B0%5D.colorSpace%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.backend.renderer.outputColorSpace%3B%0A%20%20%7D%0A%20%20getPrimitiveTopology%28object%2C%20material%29%20%7B%0A%20%20%20%20if%20%28object.isPoints%29%20return%20GPUPrimitiveTopology.PointList%3B%0A%20%20%20%20else%20if%20%28object.isLineSegments%20%7C%7C%20object.isMesh%20%26%26%20material.wireframe%20%3D%3D%3D%20true%29%20return%20GPUPrimitiveTopology.LineList%3B%0A%20%20%20%20else%20if%20%28object.isLine%29%20return%20GPUPrimitiveTopology.LineStrip%3B%0A%20%20%20%20else%20if%20%28object.isMesh%29%20return%20GPUPrimitiveTopology.TriangleList%3B%0A%20%20%7D%0A%20%20getSampleCount%28sampleCount%29%20%7B%0A%20%20%20%20let%20count%20%3D%201%3B%0A%20%20%20%20if%20%28sampleCount%20%3E%201%29%20%7B%0A%20%20%20%20%20%20count%20%3D%20Math.pow%282%2C%20Math.floor%28Math.log2%28sampleCount%29%29%29%3B%0A%20%20%20%20%20%20if%20%28count%20%3D%3D%3D%202%29%20%7B%0A%20%20%20%20%20%20%20%20count%20%3D%204%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20count%3B%0A%20%20%7D%0A%20%20getSampleCountRenderContext%28renderContext%29%20%7B%0A%20%20%20%20if%20%28renderContext.textures%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20this.getSampleCount%28renderContext.sampleCount%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20this.getSampleCount%28this.backend.renderer.samples%29%3B%0A%20%20%7D%0A%20%20getPreferredCanvasFormat%28%29%20%7B%0A%20%20%20%20if%20%28navigator.userAgent.includes%28%22Quest%22%29%29%20%7B%0A%20%20%20%20%20%20return%20GPUTextureFormat.BGRA8Unorm%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20navigator.gpu.getPreferredCanvasFormat%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20typedArraysToVertexFormatPrefix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%5B%0A%20%20%5BInt8Array%2C%20%5B%22sint8%22%2C%20%22snorm8%22%5D%5D%2C%0A%20%20%5BUint8Array%2C%20%5B%22uint8%22%2C%20%22unorm8%22%5D%5D%2C%0A%20%20%5BInt16Array%2C%20%5B%22sint16%22%2C%20%22snorm16%22%5D%5D%2C%0A%20%20%5BUint16Array%2C%20%5B%22uint16%22%2C%20%22unorm16%22%5D%5D%2C%0A%20%20%5BInt32Array%2C%20%5B%22sint32%22%2C%20%22snorm32%22%5D%5D%2C%0A%20%20%5BUint32Array%2C%20%5B%22uint32%22%2C%20%22unorm32%22%5D%5D%2C%0A%20%20%5BFloat32Array%2C%20%5B%22float32%22%5D%5D%0A%5D%29%3B%0Avar%20typedAttributeToVertexFormatPrefix%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%5B%0A%20%20%5BFloat16BufferAttribute%2C%20%5B%22float16%22%5D%5D%0A%5D%29%3B%0Avar%20typeArraysToVertexFormatPrefixForItemSize1%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%5B%0A%20%20%5BInt32Array%2C%20%22sint32%22%5D%2C%0A%20%20%5BInt16Array%2C%20%22sint32%22%5D%2C%0A%20%20%2F%2F%20patch%20for%20INT16%0A%20%20%5BUint32Array%2C%20%22uint32%22%5D%2C%0A%20%20%5BUint16Array%2C%20%22uint32%22%5D%2C%0A%20%20%2F%2F%20patch%20for%20UINT16%0A%20%20%5BFloat32Array%2C%20%22float32%22%5D%0A%5D%29%3B%0Avar%20WebGPUAttributeUtils%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%7D%0A%20%20createAttribute%28attribute2%2C%20usage%29%20%7B%0A%20%20%20%20const%20bufferAttribute2%20%3D%20this._getBufferAttribute%28attribute2%29%3B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20bufferData%20%3D%20backend.get%28bufferAttribute2%29%3B%0A%20%20%20%20let%20buffer2%20%3D%20bufferData.buffer%3B%0A%20%20%20%20if%20%28buffer2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20device%20%3D%20backend.device%3B%0A%20%20%20%20%20%20let%20array%20%3D%20bufferAttribute2.array%3B%0A%20%20%20%20%20%20if%20%28attribute2.normalized%20%3D%3D%3D%20false%20%26%26%20%28array.constructor%20%3D%3D%3D%20Int16Array%20%7C%7C%20array.constructor%20%3D%3D%3D%20Uint16Array%29%29%20%7B%0A%20%20%20%20%20%20%20%20const%20tempArray%20%3D%20new%20Uint32Array%28array.length%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20array.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20tempArray%5Bi%5D%20%3D%20array%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20array%20%3D%20tempArray%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20bufferAttribute2.array%20%3D%20array%3B%0A%20%20%20%20%20%20if%20%28%28bufferAttribute2.isStorageBufferAttribute%20%7C%7C%20bufferAttribute2.isStorageInstancedBufferAttribute%29%20%26%26%20bufferAttribute2.itemSize%20%3D%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20%20%20array%20%3D%20new%20array.constructor%28bufferAttribute2.count%20%2A%204%29%3B%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20bufferAttribute2.count%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20array.set%28bufferAttribute2.array.subarray%28i%20%2A%203%2C%20i%20%2A%203%20%2B%203%29%2C%20i%20%2A%204%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20bufferAttribute2.itemSize%20%3D%204%3B%0A%20%20%20%20%20%20%20%20bufferAttribute2.array%20%3D%20array%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20size%20%3D%20array.byteLength%20%2B%20%284%20-%20array.byteLength%20%25%204%29%20%25%204%3B%0A%20%20%20%20%20%20buffer2%20%3D%20device.createBuffer%28%7B%0A%20%20%20%20%20%20%20%20label%3A%20bufferAttribute2.name%2C%0A%20%20%20%20%20%20%20%20size%2C%0A%20%20%20%20%20%20%20%20usage%2C%0A%20%20%20%20%20%20%20%20mappedAtCreation%3A%20true%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20new%20array.constructor%28buffer2.getMappedRange%28%29%29.set%28array%29%3B%0A%20%20%20%20%20%20buffer2.unmap%28%29%3B%0A%20%20%20%20%20%20bufferData.buffer%20%3D%20buffer2%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateAttribute%28attribute2%29%20%7B%0A%20%20%20%20const%20bufferAttribute2%20%3D%20this._getBufferAttribute%28attribute2%29%3B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20device%20%3D%20backend.device%3B%0A%20%20%20%20const%20buffer2%20%3D%20backend.get%28bufferAttribute2%29.buffer%3B%0A%20%20%20%20const%20array%20%3D%20bufferAttribute2.array%3B%0A%20%20%20%20const%20updateRanges%20%3D%20bufferAttribute2.updateRanges%3B%0A%20%20%20%20if%20%28updateRanges.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20device.queue.writeBuffer%28%0A%20%20%20%20%20%20%20%20buffer2%2C%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20array%2C%0A%20%20%20%20%20%20%20%200%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20updateRanges.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20range%20%3D%20updateRanges%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20device.queue.writeBuffer%28%0A%20%20%20%20%20%20%20%20%20%20buffer2%2C%0A%20%20%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20%20%20array%2C%0A%20%20%20%20%20%20%20%20%20%20range.start%20%2A%20array.BYTES_PER_ELEMENT%2C%0A%20%20%20%20%20%20%20%20%20%20range.count%20%2A%20array.BYTES_PER_ELEMENT%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20bufferAttribute2.clearUpdateRanges%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20createShaderVertexBuffers%28renderObject%29%20%7B%0A%20%20%20%20const%20attributes%20%3D%20renderObject.getAttributes%28%29%3B%0A%20%20%20%20const%20vertexBuffers%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%20%20for%20%28let%20slot%20%3D%200%3B%20slot%20%3C%20attributes.length%3B%20slot%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20geometryAttribute%20%3D%20attributes%5Bslot%5D%3B%0A%20%20%20%20%20%20const%20bytesPerElement%20%3D%20geometryAttribute.array.BYTES_PER_ELEMENT%3B%0A%20%20%20%20%20%20const%20bufferAttribute2%20%3D%20this._getBufferAttribute%28geometryAttribute%29%3B%0A%20%20%20%20%20%20let%20vertexBufferLayout%20%3D%20vertexBuffers.get%28bufferAttribute2%29%3B%0A%20%20%20%20%20%20if%20%28vertexBufferLayout%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20let%20arrayStride%2C%20stepMode%3B%0A%20%20%20%20%20%20%20%20if%20%28geometryAttribute.isInterleavedBufferAttribute%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20arrayStride%20%3D%20geometryAttribute.data.stride%20%2A%20bytesPerElement%3B%0A%20%20%20%20%20%20%20%20%20%20stepMode%20%3D%20geometryAttribute.data.isInstancedInterleavedBuffer%20%3F%20GPUInputStepMode.Instance%20%3A%20GPUInputStepMode.Vertex%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20arrayStride%20%3D%20geometryAttribute.itemSize%20%2A%20bytesPerElement%3B%0A%20%20%20%20%20%20%20%20%20%20stepMode%20%3D%20geometryAttribute.isInstancedBufferAttribute%20%3F%20GPUInputStepMode.Instance%20%3A%20GPUInputStepMode.Vertex%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28geometryAttribute.normalized%20%3D%3D%3D%20false%20%26%26%20%28geometryAttribute.array.constructor%20%3D%3D%3D%20Int16Array%20%7C%7C%20geometryAttribute.array.constructor%20%3D%3D%3D%20Uint16Array%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20arrayStride%20%3D%204%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20vertexBufferLayout%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20arrayStride%2C%0A%20%20%20%20%20%20%20%20%20%20attributes%3A%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20stepMode%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20vertexBuffers.set%28bufferAttribute2%2C%20vertexBufferLayout%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20format2%20%3D%20this._getVertexFormat%28geometryAttribute%29%3B%0A%20%20%20%20%20%20const%20offset%20%3D%20geometryAttribute.isInterleavedBufferAttribute%20%3D%3D%3D%20true%20%3F%20geometryAttribute.offset%20%2A%20bytesPerElement%20%3A%200%3B%0A%20%20%20%20%20%20vertexBufferLayout.attributes.push%28%7B%0A%20%20%20%20%20%20%20%20shaderLocation%3A%20slot%2C%0A%20%20%20%20%20%20%20%20offset%2C%0A%20%20%20%20%20%20%20%20format%3A%20format2%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20Array.from%28vertexBuffers.values%28%29%29%3B%0A%20%20%7D%0A%20%20destroyAttribute%28attribute2%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20data%20%3D%20backend.get%28this._getBufferAttribute%28attribute2%29%29%3B%0A%20%20%20%20data.buffer.destroy%28%29%3B%0A%20%20%20%20backend.delete%28attribute2%29%3B%0A%20%20%7D%0A%20%20async%20getArrayBufferAsync%28attribute2%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20device%20%3D%20backend.device%3B%0A%20%20%20%20const%20data%20%3D%20backend.get%28this._getBufferAttribute%28attribute2%29%29%3B%0A%20%20%20%20const%20bufferGPU%20%3D%20data.buffer%3B%0A%20%20%20%20const%20size%20%3D%20bufferGPU.size%3B%0A%20%20%20%20const%20readBufferGPU%20%3D%20device.createBuffer%28%7B%0A%20%20%20%20%20%20label%3A%20attribute2.name%2C%0A%20%20%20%20%20%20size%2C%0A%20%20%20%20%20%20usage%3A%20GPUBufferUsage.COPY_DST%20%7C%20GPUBufferUsage.MAP_READ%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20cmdEncoder%20%3D%20device.createCommandEncoder%28%7B%7D%29%3B%0A%20%20%20%20cmdEncoder.copyBufferToBuffer%28%0A%20%20%20%20%20%20bufferGPU%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20readBufferGPU%2C%0A%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20size%0A%20%20%20%20%29%3B%0A%20%20%20%20readBufferGPU.unmap%28%29%3B%0A%20%20%20%20const%20gpuCommands%20%3D%20cmdEncoder.finish%28%29%3B%0A%20%20%20%20device.queue.submit%28%5BgpuCommands%5D%29%3B%0A%20%20%20%20await%20readBufferGPU.mapAsync%28GPUMapMode.READ%29%3B%0A%20%20%20%20const%20arrayBuffer%20%3D%20readBufferGPU.getMappedRange%28%29%3B%0A%20%20%20%20return%20arrayBuffer%3B%0A%20%20%7D%0A%20%20_getVertexFormat%28geometryAttribute%29%20%7B%0A%20%20%20%20const%20%7B%20itemSize%2C%20normalized%20%7D%20%3D%20geometryAttribute%3B%0A%20%20%20%20const%20ArrayType%20%3D%20geometryAttribute.array.constructor%3B%0A%20%20%20%20const%20AttributeType2%20%3D%20geometryAttribute.constructor%3B%0A%20%20%20%20let%20format2%3B%0A%20%20%20%20if%20%28itemSize%20%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20format2%20%3D%20typeArraysToVertexFormatPrefixForItemSize1.get%28ArrayType%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20prefixOptions%20%3D%20typedAttributeToVertexFormatPrefix.get%28AttributeType2%29%20%7C%7C%20typedArraysToVertexFormatPrefix.get%28ArrayType%29%3B%0A%20%20%20%20%20%20const%20prefix%20%3D%20prefixOptions%5Bnormalized%20%3F%201%20%3A%200%5D%3B%0A%20%20%20%20%20%20if%20%28prefix%29%20%7B%0A%20%20%20%20%20%20%20%20const%20bytesPerUnit%20%3D%20ArrayType.BYTES_PER_ELEMENT%20%2A%20itemSize%3B%0A%20%20%20%20%20%20%20%20const%20paddedBytesPerUnit%20%3D%20Math.floor%28%28bytesPerUnit%20%2B%203%29%20%2F%204%29%20%2A%204%3B%0A%20%20%20%20%20%20%20%20const%20paddedItemSize%20%3D%20paddedBytesPerUnit%20%2F%20ArrayType.BYTES_PER_ELEMENT%3B%0A%20%20%20%20%20%20%20%20if%20%28paddedItemSize%20%25%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28%22THREE.WebGPUAttributeUtils%3A%20Bad%20vertex%20format%20item%20size.%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20format2%20%3D%20%60%24%7Bprefix%7Dx%24%7BpaddedItemSize%7D%60%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%21format2%29%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGPUAttributeUtils%3A%20Vertex%20format%20not%20supported%20yet.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20format2%3B%0A%20%20%7D%0A%20%20_getBufferAttribute%28attribute2%29%20%7B%0A%20%20%20%20if%20%28attribute2.isInterleavedBufferAttribute%29%20attribute2%20%3D%20attribute2.data%3B%0A%20%20%20%20return%20attribute2%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGPUBindingUtils%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%20%20this.bindGroupLayoutCache%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakMap%28%29%3B%0A%20%20%7D%0A%20%20createBindingsLayout%28bindGroup%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20device%20%3D%20backend.device%3B%0A%20%20%20%20const%20entries%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20index5%20%3D%200%3B%0A%20%20%20%20for%20%28const%20binding%20of%20bindGroup.bindings%29%20%7B%0A%20%20%20%20%20%20const%20bindingGPU%20%3D%20%7B%0A%20%20%20%20%20%20%20%20binding%3A%20index5%2B%2B%2C%0A%20%20%20%20%20%20%20%20visibility%3A%20binding.visibility%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20if%20%28binding.isUniformBuffer%20%7C%7C%20binding.isStorageBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20const%20buffer2%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20%28binding.isStorageBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20buffer2.type%20%3D%20binding.access%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20bindingGPU.buffer%20%3D%20buffer2%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampler%29%20%7B%0A%20%20%20%20%20%20%20%20const%20sampler%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20%28binding.texture.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28binding.texture.compareFunction%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sampler.type%20%3D%20%22comparison%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20bindingGPU.sampler%20%3D%20sampler%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture%20%26%26%20binding.texture.isVideoTexture%29%20%7B%0A%20%20%20%20%20%20%20%20bindingGPU.externalTexture%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture%20%26%26%20binding.store%29%20%7B%0A%20%20%20%20%20%20%20%20const%20format2%20%3D%20this.backend.get%28binding.texture%29.texture.format%3B%0A%20%20%20%20%20%20%20%20const%20access%20%3D%20binding.access%3B%0A%20%20%20%20%20%20%20%20bindingGPU.storageTexture%20%3D%20%7B%20format%3A%20format2%2C%20access%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture%29%20%7B%0A%20%20%20%20%20%20%20%20const%20texture2%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20%28binding.texture.isMultisampleRenderTargetTexture%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture2.multisampled%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28binding.texture.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture2.sampleType%20%3D%20GPUTextureSampleType.Depth%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28binding.texture.isDataTexture%20%7C%7C%20binding.texture.isDataArrayTexture%20%7C%7C%20binding.texture.isData3DTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20type%20%3D%20binding.texture.type%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28type%20%3D%3D%3D%20IntType2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20texture2.sampleType%20%3D%20GPUTextureSampleType.SInt%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20UnsignedIntType2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20texture2.sampleType%20%3D%20GPUTextureSampleType.UInt%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28type%20%3D%3D%3D%20FloatType2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28this.backend.hasFeature%28%22float32-filterable%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture2.sampleType%20%3D%20GPUTextureSampleType.Float%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20texture2.sampleType%20%3D%20GPUTextureSampleType.UnfilterableFloat%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28binding.isSampledCubeTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture2.viewDimension%20%3D%20GPUTextureViewDimension.Cube%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28binding.texture.isDataArrayTexture%20%7C%7C%20binding.texture.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture2.viewDimension%20%3D%20GPUTextureViewDimension.TwoDArray%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture3D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture2.viewDimension%20%3D%20GPUTextureViewDimension.ThreeD%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20bindingGPU.texture%20%3D%20texture2%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.error%28%60WebGPUBindingUtils%3A%20Unsupported%20binding%20%22%24%7Bbinding%7D%22.%60%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20entries.push%28bindingGPU%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20device.createBindGroupLayout%28%7B%20entries%20%7D%29%3B%0A%20%20%7D%0A%20%20createBindings%28bindGroup%29%20%7B%0A%20%20%20%20const%20%7B%20backend%2C%20bindGroupLayoutCache%20%7D%20%3D%20this%3B%0A%20%20%20%20const%20bindingsData%20%3D%20backend.get%28bindGroup%29%3B%0A%20%20%20%20let%20bindLayoutGPU%20%3D%20bindGroupLayoutCache.get%28bindGroup.bindingsReference%29%3B%0A%20%20%20%20if%20%28bindLayoutGPU%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20bindLayoutGPU%20%3D%20this.createBindingsLayout%28bindGroup%29%3B%0A%20%20%20%20%20%20bindGroupLayoutCache.set%28bindGroup.bindingsReference%2C%20bindLayoutGPU%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20bindGroupGPU%20%3D%20this.createBindGroup%28bindGroup%2C%20bindLayoutGPU%29%3B%0A%20%20%20%20bindingsData.layout%20%3D%20bindLayoutGPU%3B%0A%20%20%20%20bindingsData.group%20%3D%20bindGroupGPU%3B%0A%20%20%7D%0A%20%20updateBinding%28binding%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20device%20%3D%20backend.device%3B%0A%20%20%20%20const%20buffer2%20%3D%20binding.buffer%3B%0A%20%20%20%20const%20bufferGPU%20%3D%20backend.get%28binding%29.buffer%3B%0A%20%20%20%20device.queue.writeBuffer%28bufferGPU%2C%200%2C%20buffer2%2C%200%29%3B%0A%20%20%7D%0A%20%20createBindGroup%28bindGroup%2C%20layoutGPU%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20device%20%3D%20backend.device%3B%0A%20%20%20%20let%20bindingPoint%20%3D%200%3B%0A%20%20%20%20const%20entriesGPU%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28const%20binding%20of%20bindGroup.bindings%29%20%7B%0A%20%20%20%20%20%20if%20%28binding.isUniformBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20const%20bindingData%20%3D%20backend.get%28binding%29%3B%0A%20%20%20%20%20%20%20%20if%20%28bindingData.buffer%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20byteLength%20%3D%20binding.byteLength%3B%0A%20%20%20%20%20%20%20%20%20%20const%20usage%20%3D%20GPUBufferUsage.UNIFORM%20%7C%20GPUBufferUsage.COPY_DST%3B%0A%20%20%20%20%20%20%20%20%20%20const%20bufferGPU%20%3D%20device.createBuffer%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3A%20%22bindingBuffer_%22%20%2B%20binding.name%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20size%3A%20byteLength%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20usage%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20bindingData.buffer%20%3D%20bufferGPU%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20entriesGPU.push%28%7B%20binding%3A%20bindingPoint%2C%20resource%3A%20%7B%20buffer%3A%20bindingData.buffer%20%7D%20%7D%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isStorageBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20const%20bindingData%20%3D%20backend.get%28binding%29%3B%0A%20%20%20%20%20%20%20%20if%20%28bindingData.buffer%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20attribute2%20%3D%20binding.attribute%3B%0A%20%20%20%20%20%20%20%20%20%20bindingData.buffer%20%3D%20backend.get%28attribute2%29.buffer%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20entriesGPU.push%28%7B%20binding%3A%20bindingPoint%2C%20resource%3A%20%7B%20buffer%3A%20bindingData.buffer%20%7D%20%7D%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampler%29%20%7B%0A%20%20%20%20%20%20%20%20const%20textureGPU%20%3D%20backend.get%28binding.texture%29%3B%0A%20%20%20%20%20%20%20%20entriesGPU.push%28%7B%20binding%3A%20bindingPoint%2C%20resource%3A%20textureGPU.sampler%20%7D%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture%29%20%7B%0A%20%20%20%20%20%20%20%20const%20textureData%20%3D%20backend.get%28binding.texture%29%3B%0A%20%20%20%20%20%20%20%20let%20resourceGPU%3B%0A%20%20%20%20%20%20%20%20if%20%28textureData.externalTexture%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20resourceGPU%20%3D%20device.importExternalTexture%28%7B%20source%3A%20textureData.externalTexture%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20mipLevelCount%20%3D%20binding.store%20%3F%201%20%3A%20textureData.texture.mipLevelCount%3B%0A%20%20%20%20%20%20%20%20%20%20const%20propertyName%20%3D%20%60view-%24%7BtextureData.texture.width%7D-%24%7BtextureData.texture.height%7D-%24%7BmipLevelCount%7D%60%3B%0A%20%20%20%20%20%20%20%20%20%20resourceGPU%20%3D%20textureData%5BpropertyName%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28resourceGPU%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20aspectGPU%20%3D%20GPUTextureAspect.All%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20let%20dimensionViewGPU%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28binding.isSampledCubeTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20dimensionViewGPU%20%3D%20GPUTextureViewDimension.Cube%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28binding.isSampledTexture3D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20dimensionViewGPU%20%3D%20GPUTextureViewDimension.ThreeD%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28binding.texture.isDataArrayTexture%20%7C%7C%20binding.texture.isCompressedArrayTexture%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20dimensionViewGPU%20%3D%20GPUTextureViewDimension.TwoDArray%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20dimensionViewGPU%20%3D%20GPUTextureViewDimension.TwoD%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20resourceGPU%20%3D%20textureData%5BpropertyName%5D%20%3D%20textureData.texture.createView%28%7B%20aspect%3A%20aspectGPU%2C%20dimension%3A%20dimensionViewGPU%2C%20mipLevelCount%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20entriesGPU.push%28%7B%20binding%3A%20bindingPoint%2C%20resource%3A%20resourceGPU%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20bindingPoint%2B%2B%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20device.createBindGroup%28%7B%0A%20%20%20%20%20%20label%3A%20%22bindGroup_%22%20%2B%20bindGroup.name%2C%0A%20%20%20%20%20%20layout%3A%20layoutGPU%2C%0A%20%20%20%20%20%20entries%3A%20entriesGPU%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGPUPipelineUtils%20%3D%20class%20%7B%0A%20%20constructor%28backend%29%20%7B%0A%20%20%20%20this.backend%20%3D%20backend%3B%0A%20%20%7D%0A%20%20_getSampleCount%28renderObjectContext%29%20%7B%0A%20%20%20%20return%20this.backend.utils.getSampleCountRenderContext%28renderObjectContext%29%3B%0A%20%20%7D%0A%20%20createRenderPipeline%28renderObject%2C%20promises%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20material%2C%20geometry%2C%20pipeline%20%7D%20%3D%20renderObject%3B%0A%20%20%20%20const%20%7B%20vertexProgram%2C%20fragmentProgram%20%7D%20%3D%20pipeline%3B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20device%20%3D%20backend.device%3B%0A%20%20%20%20const%20utils%20%3D%20backend.utils%3B%0A%20%20%20%20const%20pipelineData%20%3D%20backend.get%28pipeline%29%3B%0A%20%20%20%20const%20bindGroupLayouts%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28const%20bindGroup%20of%20renderObject.getBindings%28%29%29%20%7B%0A%20%20%20%20%20%20const%20bindingsData%20%3D%20backend.get%28bindGroup%29%3B%0A%20%20%20%20%20%20bindGroupLayouts.push%28bindingsData.layout%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20vertexBuffers%20%3D%20backend.attributeUtils.createShaderVertexBuffers%28renderObject%29%3B%0A%20%20%20%20let%20blending%3B%0A%20%20%20%20if%20%28material.transparent%20%3D%3D%3D%20true%20%26%26%20material.blending%20%21%3D%3D%20NoBlending2%29%20%7B%0A%20%20%20%20%20%20blending%20%3D%20this._getBlending%28material%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20stencilFront%20%3D%20%7B%7D%3B%0A%20%20%20%20if%20%28material.stencilWrite%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20stencilFront%20%3D%20%7B%0A%20%20%20%20%20%20%20%20compare%3A%20this._getStencilCompare%28material%29%2C%0A%20%20%20%20%20%20%20%20failOp%3A%20this._getStencilOperation%28material.stencilFail%29%2C%0A%20%20%20%20%20%20%20%20depthFailOp%3A%20this._getStencilOperation%28material.stencilZFail%29%2C%0A%20%20%20%20%20%20%20%20passOp%3A%20this._getStencilOperation%28material.stencilZPass%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20colorWriteMask%20%3D%20this._getColorWriteMask%28material%29%3B%0A%20%20%20%20const%20targets%20%3D%20%5B%5D%3B%0A%20%20%20%20if%20%28renderObject.context.textures%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20textures%20%3D%20renderObject.context.textures%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20colorFormat%20%3D%20utils.getTextureFormatGPU%28textures%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20targets.push%28%7B%0A%20%20%20%20%20%20%20%20%20%20format%3A%20colorFormat%2C%0A%20%20%20%20%20%20%20%20%20%20blend%3A%20blending%2C%0A%20%20%20%20%20%20%20%20%20%20writeMask%3A%20colorWriteMask%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20colorFormat%20%3D%20utils.getCurrentColorFormat%28renderObject.context%29%3B%0A%20%20%20%20%20%20targets.push%28%7B%0A%20%20%20%20%20%20%20%20format%3A%20colorFormat%2C%0A%20%20%20%20%20%20%20%20blend%3A%20blending%2C%0A%20%20%20%20%20%20%20%20writeMask%3A%20colorWriteMask%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20vertexModule%20%3D%20backend.get%28vertexProgram%29.module%3B%0A%20%20%20%20const%20fragmentModule%20%3D%20backend.get%28fragmentProgram%29.module%3B%0A%20%20%20%20const%20primitiveState%20%3D%20this._getPrimitiveState%28object%2C%20geometry%2C%20material%29%3B%0A%20%20%20%20const%20depthCompare%20%3D%20this._getDepthCompare%28material%29%3B%0A%20%20%20%20const%20depthStencilFormat%20%3D%20utils.getCurrentDepthStencilFormat%28renderObject.context%29%3B%0A%20%20%20%20const%20sampleCount%20%3D%20this._getSampleCount%28renderObject.context%29%3B%0A%20%20%20%20const%20pipelineDescriptor%20%3D%20%7B%0A%20%20%20%20%20%20label%3A%20%60renderPipeline_%24%7Bmaterial.name%20%7C%7C%20material.type%7D_%24%7Bmaterial.id%7D%60%2C%0A%20%20%20%20%20%20vertex%3A%20Object.assign%28%7B%7D%2C%20vertexModule%2C%20%7B%20buffers%3A%20vertexBuffers%20%7D%29%2C%0A%20%20%20%20%20%20fragment%3A%20Object.assign%28%7B%7D%2C%20fragmentModule%2C%20%7B%20targets%20%7D%29%2C%0A%20%20%20%20%20%20primitive%3A%20primitiveState%2C%0A%20%20%20%20%20%20multisample%3A%20%7B%0A%20%20%20%20%20%20%20%20count%3A%20sampleCount%2C%0A%20%20%20%20%20%20%20%20alphaToCoverageEnabled%3A%20material.alphaToCoverage%20%26%26%20sampleCount%20%3E%201%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20layout%3A%20device.createPipelineLayout%28%7B%0A%20%20%20%20%20%20%20%20bindGroupLayouts%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20%7D%3B%0A%20%20%20%20const%20depthStencil%20%3D%20%7B%7D%3B%0A%20%20%20%20const%20renderDepth%20%3D%20renderObject.context.depth%3B%0A%20%20%20%20const%20renderStencil%20%3D%20renderObject.context.stencil%3B%0A%20%20%20%20if%20%28renderDepth%20%3D%3D%3D%20true%20%7C%7C%20renderStencil%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20if%20%28renderDepth%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20depthStencil.format%20%3D%20depthStencilFormat%3B%0A%20%20%20%20%20%20%20%20depthStencil.depthWriteEnabled%20%3D%20material.depthWrite%3B%0A%20%20%20%20%20%20%20%20depthStencil.depthCompare%20%3D%20depthCompare%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderStencil%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20depthStencil.stencilFront%20%3D%20stencilFront%3B%0A%20%20%20%20%20%20%20%20depthStencil.stencilBack%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20depthStencil.stencilReadMask%20%3D%20material.stencilFuncMask%3B%0A%20%20%20%20%20%20%20%20depthStencil.stencilWriteMask%20%3D%20material.stencilWriteMask%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20pipelineDescriptor.depthStencil%20%3D%20depthStencil%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28promises%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20pipelineData.pipeline%20%3D%20device.createRenderPipeline%28pipelineDescriptor%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20p%20%3D%20new%20Promise%28%28resolve%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20device.createRenderPipelineAsync%28pipelineDescriptor%29.then%28%28pipeline2%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20pipelineData.pipeline%20%3D%20pipeline2%3B%0A%20%20%20%20%20%20%20%20%20%20resolve%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20promises.push%28p%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20createBundleEncoder%28renderContext%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20%7B%20utils%2C%20device%20%7D%20%3D%20backend%3B%0A%20%20%20%20const%20depthStencilFormat%20%3D%20utils.getCurrentDepthStencilFormat%28renderContext%29%3B%0A%20%20%20%20const%20colorFormat%20%3D%20utils.getCurrentColorFormat%28renderContext%29%3B%0A%20%20%20%20const%20sampleCount%20%3D%20this._getSampleCount%28renderContext%29%3B%0A%20%20%20%20const%20descriptor%20%3D%20%7B%0A%20%20%20%20%20%20label%3A%20%22renderBundleEncoder%22%2C%0A%20%20%20%20%20%20colorFormats%3A%20%5BcolorFormat%5D%2C%0A%20%20%20%20%20%20depthStencilFormat%2C%0A%20%20%20%20%20%20sampleCount%0A%20%20%20%20%7D%3B%0A%20%20%20%20return%20device.createRenderBundleEncoder%28descriptor%29%3B%0A%20%20%7D%0A%20%20createComputePipeline%28pipeline%2C%20bindings%29%20%7B%0A%20%20%20%20const%20backend%20%3D%20this.backend%3B%0A%20%20%20%20const%20device%20%3D%20backend.device%3B%0A%20%20%20%20const%20computeProgram%20%3D%20backend.get%28pipeline.computeProgram%29.module%3B%0A%20%20%20%20const%20pipelineGPU%20%3D%20backend.get%28pipeline%29%3B%0A%20%20%20%20const%20bindGroupLayouts%20%3D%20%5B%5D%3B%0A%20%20%20%20for%20%28const%20bindingsGroup%20of%20bindings%29%20%7B%0A%20%20%20%20%20%20const%20bindingsData%20%3D%20backend.get%28bindingsGroup%29%3B%0A%20%20%20%20%20%20bindGroupLayouts.push%28bindingsData.layout%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20pipelineGPU.pipeline%20%3D%20device.createComputePipeline%28%7B%0A%20%20%20%20%20%20compute%3A%20computeProgram%2C%0A%20%20%20%20%20%20layout%3A%20device.createPipelineLayout%28%7B%0A%20%20%20%20%20%20%20%20bindGroupLayouts%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20_getBlending%28material%29%20%7B%0A%20%20%20%20let%20color2%2C%20alpha%3B%0A%20%20%20%20const%20blending%20%3D%20material.blending%3B%0A%20%20%20%20const%20blendSrc%20%3D%20material.blendSrc%3B%0A%20%20%20%20const%20blendDst%20%3D%20material.blendDst%3B%0A%20%20%20%20const%20blendEquation%20%3D%20material.blendEquation%3B%0A%20%20%20%20if%20%28blending%20%3D%3D%3D%20CustomBlending2%29%20%7B%0A%20%20%20%20%20%20const%20blendSrcAlpha%20%3D%20material.blendSrcAlpha%20%21%3D%3D%20null%20%3F%20material.blendSrcAlpha%20%3A%20blendSrc%3B%0A%20%20%20%20%20%20const%20blendDstAlpha%20%3D%20material.blendDstAlpha%20%21%3D%3D%20null%20%3F%20material.blendDstAlpha%20%3A%20blendDst%3B%0A%20%20%20%20%20%20const%20blendEquationAlpha%20%3D%20material.blendEquationAlpha%20%21%3D%3D%20null%20%3F%20material.blendEquationAlpha%20%3A%20blendEquation%3B%0A%20%20%20%20%20%20color2%20%3D%20%7B%0A%20%20%20%20%20%20%20%20srcFactor%3A%20this._getBlendFactor%28blendSrc%29%2C%0A%20%20%20%20%20%20%20%20dstFactor%3A%20this._getBlendFactor%28blendDst%29%2C%0A%20%20%20%20%20%20%20%20operation%3A%20this._getBlendOperation%28blendEquation%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20alpha%20%3D%20%7B%0A%20%20%20%20%20%20%20%20srcFactor%3A%20this._getBlendFactor%28blendSrcAlpha%29%2C%0A%20%20%20%20%20%20%20%20dstFactor%3A%20this._getBlendFactor%28blendDstAlpha%29%2C%0A%20%20%20%20%20%20%20%20operation%3A%20this._getBlendOperation%28blendEquationAlpha%29%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20premultipliedAlpha%20%3D%20material.premultipliedAlpha%3B%0A%20%20%20%20%20%20const%20setBlend%20%3D%20%28srcRGB%2C%20dstRGB%2C%20srcAlpha%2C%20dstAlpha%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20color2%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20srcFactor%3A%20srcRGB%2C%0A%20%20%20%20%20%20%20%20%20%20dstFactor%3A%20dstRGB%2C%0A%20%20%20%20%20%20%20%20%20%20operation%3A%20GPUBlendOperation.Add%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20alpha%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20srcFactor%3A%20srcAlpha%2C%0A%20%20%20%20%20%20%20%20%20%20dstFactor%3A%20dstAlpha%2C%0A%20%20%20%20%20%20%20%20%20%20operation%3A%20GPUBlendOperation.Add%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20if%20%28premultipliedAlpha%29%20%7B%0A%20%20%20%20%20%20%20%20switch%20%28blending%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20NormalBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20setBlend%28GPUBlendFactor.One%2C%20GPUBlendFactor.OneMinusSrcAlpha%2C%20GPUBlendFactor.One%2C%20GPUBlendFactor.OneMinusSrcAlpha%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20AdditiveBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20setBlend%28GPUBlendFactor.One%2C%20GPUBlendFactor.One%2C%20GPUBlendFactor.One%2C%20GPUBlendFactor.One%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20SubtractiveBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20setBlend%28GPUBlendFactor.Zero%2C%20GPUBlendFactor.OneMinusSrc%2C%20GPUBlendFactor.Zero%2C%20GPUBlendFactor.One%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20MultiplyBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20setBlend%28GPUBlendFactor.Zero%2C%20GPUBlendFactor.Src%2C%20GPUBlendFactor.Zero%2C%20GPUBlendFactor.SrcAlpha%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20switch%20%28blending%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20case%20NormalBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20setBlend%28GPUBlendFactor.SrcAlpha%2C%20GPUBlendFactor.OneMinusSrcAlpha%2C%20GPUBlendFactor.One%2C%20GPUBlendFactor.OneMinusSrcAlpha%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20AdditiveBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20setBlend%28GPUBlendFactor.SrcAlpha%2C%20GPUBlendFactor.One%2C%20GPUBlendFactor.SrcAlpha%2C%20GPUBlendFactor.One%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20SubtractiveBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20setBlend%28GPUBlendFactor.Zero%2C%20GPUBlendFactor.OneMinusSrc%2C%20GPUBlendFactor.Zero%2C%20GPUBlendFactor.One%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20case%20MultiplyBlending2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20setBlend%28GPUBlendFactor.Zero%2C%20GPUBlendFactor.Src%2C%20GPUBlendFactor.Zero%2C%20GPUBlendFactor.Src%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28color2%20%21%3D%3D%20void%200%20%26%26%20alpha%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20return%20%7B%20color%3A%20color2%2C%20alpha%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.error%28%22THREE.WebGPURenderer%3A%20Invalid%20blending%3A%20%22%2C%20blending%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_getBlendFactor%28blend%29%20%7B%0A%20%20%20%20let%20blendFactor%3B%0A%20%20%20%20switch%20%28blend%29%20%7B%0A%20%20%20%20%20%20case%20ZeroFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.Zero%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20OneFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.One%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20SrcColorFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.Src%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20OneMinusSrcColorFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.OneMinusSrc%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20SrcAlphaFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.SrcAlpha%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20OneMinusSrcAlphaFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.OneMinusSrcAlpha%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20DstColorFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.Dst%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20OneMinusDstColorFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.OneMinusDstColor%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20DstAlphaFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.DstAlpha%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20OneMinusDstAlphaFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.OneMinusDstAlpha%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20SrcAlphaSaturateFactor2%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.SrcAlphaSaturated%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20BlendColorFactor%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.Constant%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20OneMinusBlendColorFactor%3A%0A%20%20%20%20%20%20%20%20blendFactor%20%3D%20GPUBlendFactor.OneMinusConstant%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGPURenderer%3A%20Blend%20factor%20not%20supported.%22%2C%20blend%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20blendFactor%3B%0A%20%20%7D%0A%20%20_getStencilCompare%28material%29%20%7B%0A%20%20%20%20let%20stencilCompare%3B%0A%20%20%20%20const%20stencilFunc%20%3D%20material.stencilFunc%3B%0A%20%20%20%20switch%20%28stencilFunc%29%20%7B%0A%20%20%20%20%20%20case%20NeverStencilFunc%3A%0A%20%20%20%20%20%20%20%20stencilCompare%20%3D%20GPUCompareFunction.Never%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20AlwaysStencilFunc2%3A%0A%20%20%20%20%20%20%20%20stencilCompare%20%3D%20GPUCompareFunction.Always%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20LessStencilFunc%3A%0A%20%20%20%20%20%20%20%20stencilCompare%20%3D%20GPUCompareFunction.Less%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20LessEqualStencilFunc%3A%0A%20%20%20%20%20%20%20%20stencilCompare%20%3D%20GPUCompareFunction.LessEqual%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20EqualStencilFunc%3A%0A%20%20%20%20%20%20%20%20stencilCompare%20%3D%20GPUCompareFunction.Equal%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20GreaterEqualStencilFunc%3A%0A%20%20%20%20%20%20%20%20stencilCompare%20%3D%20GPUCompareFunction.GreaterEqual%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20GreaterStencilFunc%3A%0A%20%20%20%20%20%20%20%20stencilCompare%20%3D%20GPUCompareFunction.Greater%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20NotEqualStencilFunc%3A%0A%20%20%20%20%20%20%20%20stencilCompare%20%3D%20GPUCompareFunction.NotEqual%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGPURenderer%3A%20Invalid%20stencil%20function.%22%2C%20stencilFunc%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20stencilCompare%3B%0A%20%20%7D%0A%20%20_getStencilOperation%28op%29%20%7B%0A%20%20%20%20let%20stencilOperation%3B%0A%20%20%20%20switch%20%28op%29%20%7B%0A%20%20%20%20%20%20case%20KeepStencilOp2%3A%0A%20%20%20%20%20%20%20%20stencilOperation%20%3D%20GPUStencilOperation.Keep%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20ZeroStencilOp%3A%0A%20%20%20%20%20%20%20%20stencilOperation%20%3D%20GPUStencilOperation.Zero%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20ReplaceStencilOp%3A%0A%20%20%20%20%20%20%20%20stencilOperation%20%3D%20GPUStencilOperation.Replace%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20InvertStencilOp%3A%0A%20%20%20%20%20%20%20%20stencilOperation%20%3D%20GPUStencilOperation.Invert%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20IncrementStencilOp%3A%0A%20%20%20%20%20%20%20%20stencilOperation%20%3D%20GPUStencilOperation.IncrementClamp%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20DecrementStencilOp%3A%0A%20%20%20%20%20%20%20%20stencilOperation%20%3D%20GPUStencilOperation.DecrementClamp%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20IncrementWrapStencilOp%3A%0A%20%20%20%20%20%20%20%20stencilOperation%20%3D%20GPUStencilOperation.IncrementWrap%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20DecrementWrapStencilOp%3A%0A%20%20%20%20%20%20%20%20stencilOperation%20%3D%20GPUStencilOperation.DecrementWrap%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGPURenderer%3A%20Invalid%20stencil%20operation.%22%2C%20stencilOperation%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20stencilOperation%3B%0A%20%20%7D%0A%20%20_getBlendOperation%28blendEquation%29%20%7B%0A%20%20%20%20let%20blendOperation%3B%0A%20%20%20%20switch%20%28blendEquation%29%20%7B%0A%20%20%20%20%20%20case%20AddEquation2%3A%0A%20%20%20%20%20%20%20%20blendOperation%20%3D%20GPUBlendOperation.Add%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20SubtractEquation2%3A%0A%20%20%20%20%20%20%20%20blendOperation%20%3D%20GPUBlendOperation.Subtract%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20ReverseSubtractEquation2%3A%0A%20%20%20%20%20%20%20%20blendOperation%20%3D%20GPUBlendOperation.ReverseSubtract%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20MinEquation2%3A%0A%20%20%20%20%20%20%20%20blendOperation%20%3D%20GPUBlendOperation.Min%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20MaxEquation2%3A%0A%20%20%20%20%20%20%20%20blendOperation%20%3D%20GPUBlendOperation.Max%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGPUPipelineUtils%3A%20Blend%20equation%20not%20supported.%22%2C%20blendEquation%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20blendOperation%3B%0A%20%20%7D%0A%20%20_getPrimitiveState%28object%2C%20geometry%2C%20material%29%20%7B%0A%20%20%20%20const%20descriptor%20%3D%20%7B%7D%3B%0A%20%20%20%20const%20utils%20%3D%20this.backend.utils%3B%0A%20%20%20%20descriptor.topology%20%3D%20utils.getPrimitiveTopology%28object%2C%20material%29%3B%0A%20%20%20%20if%20%28geometry.index%20%21%3D%3D%20null%20%26%26%20object.isLine%20%3D%3D%3D%20true%20%26%26%20object.isLineSegments%20%21%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20descriptor.stripIndexFormat%20%3D%20geometry.index.array%20instanceof%20Uint16Array%20%3F%20GPUIndexFormat.Uint16%20%3A%20GPUIndexFormat.Uint32%3B%0A%20%20%20%20%7D%0A%20%20%20%20switch%20%28material.side%29%20%7B%0A%20%20%20%20%20%20case%20FrontSide2%3A%0A%20%20%20%20%20%20%20%20descriptor.frontFace%20%3D%20GPUFrontFace.CCW%3B%0A%20%20%20%20%20%20%20%20descriptor.cullMode%20%3D%20GPUCullMode.Back%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20BackSide2%3A%0A%20%20%20%20%20%20%20%20descriptor.frontFace%20%3D%20GPUFrontFace.CCW%3B%0A%20%20%20%20%20%20%20%20descriptor.cullMode%20%3D%20GPUCullMode.Front%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20DoubleSide2%3A%0A%20%20%20%20%20%20%20%20descriptor.frontFace%20%3D%20GPUFrontFace.CCW%3B%0A%20%20%20%20%20%20%20%20descriptor.cullMode%20%3D%20GPUCullMode.None%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGPUPipelineUtils%3A%20Unknown%20material.side%20value.%22%2C%20material.side%29%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20descriptor%3B%0A%20%20%7D%0A%20%20_getColorWriteMask%28material%29%20%7B%0A%20%20%20%20return%20material.colorWrite%20%3D%3D%3D%20true%20%3F%20GPUColorWriteFlags.All%20%3A%20GPUColorWriteFlags.None%3B%0A%20%20%7D%0A%20%20_getDepthCompare%28material%29%20%7B%0A%20%20%20%20let%20depthCompare%3B%0A%20%20%20%20if%20%28material.depthTest%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20depthCompare%20%3D%20GPUCompareFunction.Always%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20depthFunc%20%3D%20material.depthFunc%3B%0A%20%20%20%20%20%20switch%20%28depthFunc%29%20%7B%0A%20%20%20%20%20%20%20%20case%20NeverDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20depthCompare%20%3D%20GPUCompareFunction.Never%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20AlwaysDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20depthCompare%20%3D%20GPUCompareFunction.Always%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20LessDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20depthCompare%20%3D%20GPUCompareFunction.Less%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20LessEqualDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20depthCompare%20%3D%20GPUCompareFunction.LessEqual%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20EqualDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20depthCompare%20%3D%20GPUCompareFunction.Equal%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20GreaterEqualDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20depthCompare%20%3D%20GPUCompareFunction.GreaterEqual%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20GreaterDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20depthCompare%20%3D%20GPUCompareFunction.Greater%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20NotEqualDepth2%3A%0A%20%20%20%20%20%20%20%20%20%20depthCompare%20%3D%20GPUCompareFunction.NotEqual%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20console.error%28%22THREE.WebGPUPipelineUtils%3A%20Invalid%20depth%20function.%22%2C%20depthFunc%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20depthCompare%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGPUBackend%20%3D%20class%20extends%20Backend%20%7B%0A%20%20constructor%28parameters%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20super%28parameters%29%3B%0A%20%20%20%20this.isWebGPUBackend%20%3D%20true%3B%0A%20%20%20%20this.parameters.alpha%20%3D%20parameters.alpha%20%3D%3D%3D%20void%200%20%3F%20true%20%3A%20parameters.alpha%3B%0A%20%20%20%20this.parameters.requiredLimits%20%3D%20parameters.requiredLimits%20%3D%3D%3D%20void%200%20%3F%20%7B%7D%20%3A%20parameters.requiredLimits%3B%0A%20%20%20%20this.trackTimestamp%20%3D%20parameters.trackTimestamp%20%3D%3D%3D%20true%3B%0A%20%20%20%20this.device%20%3D%20null%3B%0A%20%20%20%20this.context%20%3D%20null%3B%0A%20%20%20%20this.colorBuffer%20%3D%20null%3B%0A%20%20%20%20this.defaultRenderPassdescriptor%20%3D%20null%3B%0A%20%20%20%20this.utils%20%3D%20new%20WebGPUUtils%28this%29%3B%0A%20%20%20%20this.attributeUtils%20%3D%20new%20WebGPUAttributeUtils%28this%29%3B%0A%20%20%20%20this.bindingUtils%20%3D%20new%20WebGPUBindingUtils%28this%29%3B%0A%20%20%20%20this.pipelineUtils%20%3D%20new%20WebGPUPipelineUtils%28this%29%3B%0A%20%20%20%20this.textureUtils%20%3D%20new%20WebGPUTextureUtils%28this%29%3B%0A%20%20%20%20this.occludedResolveCache%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%3B%0A%20%20%7D%0A%20%20async%20init%28renderer3%29%20%7B%0A%20%20%20%20await%20super.init%28renderer3%29%3B%0A%20%20%20%20const%20parameters%20%3D%20this.parameters%3B%0A%20%20%20%20let%20device%3B%0A%20%20%20%20if%20%28parameters.device%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20adapterOptions%20%3D%20%7B%0A%20%20%20%20%20%20%20%20powerPreference%3A%20parameters.powerPreference%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20const%20adapter%20%3D%20await%20navigator.gpu.requestAdapter%28adapterOptions%29%3B%0A%20%20%20%20%20%20if%20%28adapter%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22WebGPUBackend%3A%20Unable%20to%20create%20WebGPU%20adapter.%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20features%20%3D%20Object.values%28GPUFeatureName%29%3B%0A%20%20%20%20%20%20const%20supportedFeatures%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28const%20name%20of%20features%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28adapter.features.has%28name%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20supportedFeatures.push%28name%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20deviceDescriptor%20%3D%20%7B%0A%20%20%20%20%20%20%20%20requiredFeatures%3A%20supportedFeatures%2C%0A%20%20%20%20%20%20%20%20requiredLimits%3A%20parameters.requiredLimits%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20device%20%3D%20await%20adapter.requestDevice%28deviceDescriptor%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20device%20%3D%20parameters.device%3B%0A%20%20%20%20%7D%0A%20%20%20%20device.lost.then%28%28info%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20deviceLossInfo%20%3D%20%7B%0A%20%20%20%20%20%20%20%20api%3A%20%22WebGPU%22%2C%0A%20%20%20%20%20%20%20%20message%3A%20info.message%20%7C%7C%20%22Unknown%20reason%22%2C%0A%20%20%20%20%20%20%20%20reason%3A%20info.reason%20%7C%7C%20null%2C%0A%20%20%20%20%20%20%20%20originalEvent%3A%20info%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20renderer3.onDeviceLost%28deviceLossInfo%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20const%20context2%20%3D%20parameters.context%20%21%3D%3D%20void%200%20%3F%20parameters.context%20%3A%20renderer3.domElement.getContext%28%22webgpu%22%29%3B%0A%20%20%20%20this.device%20%3D%20device%3B%0A%20%20%20%20this.context%20%3D%20context2%3B%0A%20%20%20%20const%20alphaMode%20%3D%20parameters.alpha%20%3F%20%22premultiplied%22%20%3A%20%22opaque%22%3B%0A%20%20%20%20this.trackTimestamp%20%3D%20this.trackTimestamp%20%26%26%20this.hasFeature%28GPUFeatureName.TimestampQuery%29%3B%0A%20%20%20%20this.context.configure%28%7B%0A%20%20%20%20%20%20device%3A%20this.device%2C%0A%20%20%20%20%20%20format%3A%20this.utils.getPreferredCanvasFormat%28%29%2C%0A%20%20%20%20%20%20usage%3A%20GPUTextureUsage.RENDER_ATTACHMENT%20%7C%20GPUTextureUsage.COPY_SRC%2C%0A%20%20%20%20%20%20alphaMode%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.updateSize%28%29%3B%0A%20%20%7D%0A%20%20get%20coordinateSystem%28%29%20%7B%0A%20%20%20%20return%20WebGPUCoordinateSystem2%3B%0A%20%20%7D%0A%20%20async%20getArrayBufferAsync%28attribute2%29%20%7B%0A%20%20%20%20return%20await%20this.attributeUtils.getArrayBufferAsync%28attribute2%29%3B%0A%20%20%7D%0A%20%20getContext%28%29%20%7B%0A%20%20%20%20return%20this.context%3B%0A%20%20%7D%0A%20%20_getDefaultRenderPassDescriptor%28%29%20%7B%0A%20%20%20%20let%20descriptor%20%3D%20this.defaultRenderPassdescriptor%3B%0A%20%20%20%20if%20%28descriptor%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20renderer3%20%3D%20this.renderer%3B%0A%20%20%20%20%20%20descriptor%20%3D%20%7B%0A%20%20%20%20%20%20%20%20colorAttachments%3A%20%5B%7B%0A%20%20%20%20%20%20%20%20%20%20view%3A%20null%0A%20%20%20%20%20%20%20%20%7D%5D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20if%20%28this.renderer.depth%20%3D%3D%3D%20true%20%7C%7C%20this.renderer.stencil%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20descriptor.depthStencilAttachment%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20view%3A%20this.textureUtils.getDepthBuffer%28renderer3.depth%2C%20renderer3.stencil%29.createView%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20colorAttachment2%20%3D%20descriptor.colorAttachments%5B0%5D%3B%0A%20%20%20%20%20%20if%20%28this.renderer.samples%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20colorAttachment2.view%20%3D%20this.colorBuffer.createView%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20colorAttachment2.resolveTarget%20%3D%20void%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this.defaultRenderPassdescriptor%20%3D%20descriptor%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20colorAttachment%20%3D%20descriptor.colorAttachments%5B0%5D%3B%0A%20%20%20%20if%20%28this.renderer.samples%20%3E%200%29%20%7B%0A%20%20%20%20%20%20colorAttachment.resolveTarget%20%3D%20this.context.getCurrentTexture%28%29.createView%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20colorAttachment.view%20%3D%20this.context.getCurrentTexture%28%29.createView%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20descriptor%3B%0A%20%20%7D%0A%20%20_getRenderPassDescriptor%28renderContext%29%20%7B%0A%20%20%20%20const%20renderTarget%20%3D%20renderContext.renderTarget%3B%0A%20%20%20%20const%20renderTargetData%20%3D%20this.get%28renderTarget%29%3B%0A%20%20%20%20let%20descriptors%20%3D%20renderTargetData.descriptors%3B%0A%20%20%20%20if%20%28descriptors%20%3D%3D%3D%20void%200%20%7C%7C%20renderTargetData.width%20%21%3D%3D%20renderTarget.width%20%7C%7C%20renderTargetData.height%20%21%3D%3D%20renderTarget.height%20%7C%7C%20renderTargetData.activeMipmapLevel%20%21%3D%3D%20renderTarget.activeMipmapLevel%20%7C%7C%20renderTargetData.samples%20%21%3D%3D%20renderTarget.samples%29%20%7B%0A%20%20%20%20%20%20descriptors%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20renderTargetData.descriptors%20%3D%20descriptors%3B%0A%20%20%20%20%20%20const%20onDispose%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20renderTarget.removeEventListener%28%22dispose%22%2C%20onDispose%29%3B%0A%20%20%20%20%20%20%20%20this.delete%28renderTarget%29%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20renderTarget.addEventListener%28%22dispose%22%2C%20onDispose%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20cacheKey%20%3D%20renderContext.getCacheKey%28%29%3B%0A%20%20%20%20let%20descriptor%20%3D%20descriptors%5BcacheKey%5D%3B%0A%20%20%20%20if%20%28descriptor%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20textures%20%3D%20renderContext.textures%3B%0A%20%20%20%20%20%20const%20colorAttachments%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20textureData%20%3D%20this.get%28textures%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20const%20textureView%20%3D%20textureData.texture.createView%28%7B%0A%20%20%20%20%20%20%20%20%20%20baseMipLevel%3A%20renderContext.activeMipmapLevel%2C%0A%20%20%20%20%20%20%20%20%20%20mipLevelCount%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20baseArrayLayer%3A%20renderContext.activeCubeFace%2C%0A%20%20%20%20%20%20%20%20%20%20dimension%3A%20GPUTextureViewDimension.TwoD%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20let%20view%2C%20resolveTarget%3B%0A%20%20%20%20%20%20%20%20if%20%28textureData.msaaTexture%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20view%20%3D%20textureData.msaaTexture.createView%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20resolveTarget%20%3D%20textureView%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20view%20%3D%20textureView%3B%0A%20%20%20%20%20%20%20%20%20%20resolveTarget%20%3D%20void%200%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20colorAttachments.push%28%7B%0A%20%20%20%20%20%20%20%20%20%20view%2C%0A%20%20%20%20%20%20%20%20%20%20resolveTarget%2C%0A%20%20%20%20%20%20%20%20%20%20loadOp%3A%20GPULoadOp.Load%2C%0A%20%20%20%20%20%20%20%20%20%20storeOp%3A%20GPUStoreOp.Store%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20descriptor%20%3D%20%7B%0A%20%20%20%20%20%20%20%20colorAttachments%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20if%20%28renderContext.depth%29%20%7B%0A%20%20%20%20%20%20%20%20const%20depthTextureData%20%3D%20this.get%28renderContext.depthTexture%29%3B%0A%20%20%20%20%20%20%20%20const%20depthStencilAttachment%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20view%3A%20depthTextureData.texture.createView%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20descriptor.depthStencilAttachment%20%3D%20depthStencilAttachment%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20descriptors%5BcacheKey%5D%20%3D%20descriptor%3B%0A%20%20%20%20%20%20renderTargetData.width%20%3D%20renderTarget.width%3B%0A%20%20%20%20%20%20renderTargetData.height%20%3D%20renderTarget.height%3B%0A%20%20%20%20%20%20renderTargetData.samples%20%3D%20renderTarget.samples%3B%0A%20%20%20%20%20%20renderTargetData.activeMipmapLevel%20%3D%20renderTarget.activeMipmapLevel%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20descriptor%3B%0A%20%20%7D%0A%20%20beginRender%28renderContext%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20const%20device%20%3D%20this.device%3B%0A%20%20%20%20const%20occlusionQueryCount%20%3D%20renderContext.occlusionQueryCount%3B%0A%20%20%20%20let%20occlusionQuerySet%3B%0A%20%20%20%20if%20%28occlusionQueryCount%20%3E%200%29%20%7B%0A%20%20%20%20%20%20if%20%28renderContextData.currentOcclusionQuerySet%29%20renderContextData.currentOcclusionQuerySet.destroy%28%29%3B%0A%20%20%20%20%20%20if%20%28renderContextData.currentOcclusionQueryBuffer%29%20renderContextData.currentOcclusionQueryBuffer.destroy%28%29%3B%0A%20%20%20%20%20%20renderContextData.currentOcclusionQuerySet%20%3D%20renderContextData.occlusionQuerySet%3B%0A%20%20%20%20%20%20renderContextData.currentOcclusionQueryBuffer%20%3D%20renderContextData.occlusionQueryBuffer%3B%0A%20%20%20%20%20%20renderContextData.currentOcclusionQueryObjects%20%3D%20renderContextData.occlusionQueryObjects%3B%0A%20%20%20%20%20%20occlusionQuerySet%20%3D%20device.createQuerySet%28%7B%20type%3A%20%22occlusion%22%2C%20count%3A%20occlusionQueryCount%20%7D%29%3B%0A%20%20%20%20%20%20renderContextData.occlusionQuerySet%20%3D%20occlusionQuerySet%3B%0A%20%20%20%20%20%20renderContextData.occlusionQueryIndex%20%3D%200%3B%0A%20%20%20%20%20%20renderContextData.occlusionQueryObjects%20%3D%20new%20Array%28occlusionQueryCount%29%3B%0A%20%20%20%20%20%20renderContextData.lastOcclusionObject%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20descriptor%3B%0A%20%20%20%20if%20%28renderContext.textures%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20descriptor%20%3D%20this._getDefaultRenderPassDescriptor%28%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20descriptor%20%3D%20this._getRenderPassDescriptor%28renderContext%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.initTimestampQuery%28renderContext%2C%20descriptor%29%3B%0A%20%20%20%20descriptor.occlusionQuerySet%20%3D%20occlusionQuerySet%3B%0A%20%20%20%20const%20depthStencilAttachment%20%3D%20descriptor.depthStencilAttachment%3B%0A%20%20%20%20if%20%28renderContext.textures%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20colorAttachments%20%3D%20descriptor.colorAttachments%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20colorAttachments.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20colorAttachment%20%3D%20colorAttachments%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28renderContext.clearColor%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20colorAttachment.clearValue%20%3D%20i%20%3D%3D%3D%200%20%3F%20renderContext.clearColorValue%20%3A%20%7B%20r%3A%200%2C%20g%3A%200%2C%20b%3A%200%2C%20a%3A%201%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20colorAttachment.loadOp%20%3D%20GPULoadOp.Clear%3B%0A%20%20%20%20%20%20%20%20%20%20colorAttachment.storeOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20colorAttachment.loadOp%20%3D%20GPULoadOp.Load%3B%0A%20%20%20%20%20%20%20%20%20%20colorAttachment.storeOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20colorAttachment%20%3D%20descriptor.colorAttachments%5B0%5D%3B%0A%20%20%20%20%20%20if%20%28renderContext.clearColor%29%20%7B%0A%20%20%20%20%20%20%20%20colorAttachment.clearValue%20%3D%20renderContext.clearColorValue%3B%0A%20%20%20%20%20%20%20%20colorAttachment.loadOp%20%3D%20GPULoadOp.Clear%3B%0A%20%20%20%20%20%20%20%20colorAttachment.storeOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20colorAttachment.loadOp%20%3D%20GPULoadOp.Load%3B%0A%20%20%20%20%20%20%20%20colorAttachment.storeOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderContext.depth%29%20%7B%0A%20%20%20%20%20%20if%20%28renderContext.clearDepth%29%20%7B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthClearValue%20%3D%20renderContext.clearDepthValue%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthLoadOp%20%3D%20GPULoadOp.Clear%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthStoreOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthLoadOp%20%3D%20GPULoadOp.Load%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthStoreOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderContext.stencil%29%20%7B%0A%20%20%20%20%20%20if%20%28renderContext.clearStencil%29%20%7B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilClearValue%20%3D%20renderContext.clearStencilValue%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilLoadOp%20%3D%20GPULoadOp.Clear%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilStoreOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilLoadOp%20%3D%20GPULoadOp.Load%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilStoreOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20encoder%20%3D%20device.createCommandEncoder%28%7B%20label%3A%20%22renderContext_%22%20%2B%20renderContext.id%20%7D%29%3B%0A%20%20%20%20const%20currentPass%20%3D%20encoder.beginRenderPass%28descriptor%29%3B%0A%20%20%20%20renderContextData.descriptor%20%3D%20descriptor%3B%0A%20%20%20%20renderContextData.encoder%20%3D%20encoder%3B%0A%20%20%20%20renderContextData.currentPass%20%3D%20currentPass%3B%0A%20%20%20%20renderContextData.currentSets%20%3D%20%7B%20attributes%3A%20%7B%7D%2C%20bindingGroups%3A%20%5B%5D%2C%20pipeline%3A%20null%2C%20index%3A%20null%20%7D%3B%0A%20%20%20%20renderContextData.renderBundles%20%3D%20%5B%5D%3B%0A%20%20%20%20if%20%28renderContext.viewport%29%20%7B%0A%20%20%20%20%20%20this.updateViewport%28renderContext%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderContext.scissor%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20x%3A%20x2%2C%20y%3A%20y2%2C%20width%2C%20height%20%7D%20%3D%20renderContext.scissorValue%3B%0A%20%20%20%20%20%20currentPass.setScissorRect%28x2%2C%20y2%2C%20width%2C%20height%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20finishRender%28renderContext%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20const%20occlusionQueryCount%20%3D%20renderContext.occlusionQueryCount%3B%0A%20%20%20%20if%20%28renderContextData.renderBundles.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20renderContextData.currentPass.executeBundles%28renderContextData.renderBundles%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28occlusionQueryCount%20%3E%20renderContextData.occlusionQueryIndex%29%20%7B%0A%20%20%20%20%20%20renderContextData.currentPass.endOcclusionQuery%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderContextData.currentPass.end%28%29%3B%0A%20%20%20%20if%20%28occlusionQueryCount%20%3E%200%29%20%7B%0A%20%20%20%20%20%20const%20bufferSize%20%3D%20occlusionQueryCount%20%2A%208%3B%0A%20%20%20%20%20%20let%20queryResolveBuffer%20%3D%20this.occludedResolveCache.get%28bufferSize%29%3B%0A%20%20%20%20%20%20if%20%28queryResolveBuffer%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20queryResolveBuffer%20%3D%20this.device.createBuffer%28%0A%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20size%3A%20bufferSize%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20usage%3A%20GPUBufferUsage.QUERY_RESOLVE%20%7C%20GPUBufferUsage.COPY_SRC%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20this.occludedResolveCache.set%28bufferSize%2C%20queryResolveBuffer%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20const%20readBuffer%20%3D%20this.device.createBuffer%28%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20size%3A%20bufferSize%2C%0A%20%20%20%20%20%20%20%20%20%20usage%3A%20GPUBufferUsage.COPY_DST%20%7C%20GPUBufferUsage.MAP_READ%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20renderContextData.encoder.resolveQuerySet%28renderContextData.occlusionQuerySet%2C%200%2C%20occlusionQueryCount%2C%20queryResolveBuffer%2C%200%29%3B%0A%20%20%20%20%20%20renderContextData.encoder.copyBufferToBuffer%28queryResolveBuffer%2C%200%2C%20readBuffer%2C%200%2C%20bufferSize%29%3B%0A%20%20%20%20%20%20renderContextData.occlusionQueryBuffer%20%3D%20readBuffer%3B%0A%20%20%20%20%20%20this.resolveOccludedAsync%28renderContext%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.prepareTimestampBuffer%28renderContext%2C%20renderContextData.encoder%29%3B%0A%20%20%20%20this.device.queue.submit%28%5BrenderContextData.encoder.finish%28%29%5D%29%3B%0A%20%20%20%20if%20%28renderContext.textures%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20const%20textures%20%3D%20renderContext.textures%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20textures.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20texture2%20%3D%20textures%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28texture2.generateMipmaps%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.textureUtils.generateMipmaps%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20isOccluded%28renderContext%2C%20object%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20return%20renderContextData.occluded%20%26%26%20renderContextData.occluded.has%28object%29%3B%0A%20%20%7D%0A%20%20async%20resolveOccludedAsync%28renderContext%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20const%20%7B%20currentOcclusionQueryBuffer%2C%20currentOcclusionQueryObjects%20%7D%20%3D%20renderContextData%3B%0A%20%20%20%20if%20%28currentOcclusionQueryBuffer%20%26%26%20currentOcclusionQueryObjects%29%20%7B%0A%20%20%20%20%20%20const%20occluded%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20WeakSet%28%29%3B%0A%20%20%20%20%20%20renderContextData.currentOcclusionQueryObjects%20%3D%20null%3B%0A%20%20%20%20%20%20renderContextData.currentOcclusionQueryBuffer%20%3D%20null%3B%0A%20%20%20%20%20%20await%20currentOcclusionQueryBuffer.mapAsync%28GPUMapMode.READ%29%3B%0A%20%20%20%20%20%20const%20buffer2%20%3D%20currentOcclusionQueryBuffer.getMappedRange%28%29%3B%0A%20%20%20%20%20%20const%20results%20%3D%20new%20BigUint64Array%28buffer2%29%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20currentOcclusionQueryObjects.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28results%5Bi%5D%20%21%3D%3D%20BigInt%280%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20occluded.add%28currentOcclusionQueryObjects%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20currentOcclusionQueryBuffer.destroy%28%29%3B%0A%20%20%20%20%20%20renderContextData.occluded%20%3D%20occluded%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20updateViewport%28renderContext%29%20%7B%0A%20%20%20%20const%20%7B%20currentPass%20%7D%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20const%20%7B%20x%3A%20x2%2C%20y%3A%20y2%2C%20width%2C%20height%2C%20minDepth%2C%20maxDepth%20%7D%20%3D%20renderContext.viewportValue%3B%0A%20%20%20%20currentPass.setViewport%28x2%2C%20y2%2C%20width%2C%20height%2C%20minDepth%2C%20maxDepth%29%3B%0A%20%20%7D%0A%20%20clear%28color2%2C%20depth2%2C%20stencil%2C%20renderTargetData%20%3D%20null%29%20%7B%0A%20%20%20%20const%20device%20%3D%20this.device%3B%0A%20%20%20%20const%20renderer3%20%3D%20this.renderer%3B%0A%20%20%20%20let%20colorAttachments%20%3D%20%5B%5D%3B%0A%20%20%20%20let%20depthStencilAttachment%3B%0A%20%20%20%20let%20clearValue%3B%0A%20%20%20%20let%20supportsDepth%3B%0A%20%20%20%20let%20supportsStencil%3B%0A%20%20%20%20if%20%28color2%29%20%7B%0A%20%20%20%20%20%20const%20clearColor%20%3D%20this.getClearColor%28%29%3B%0A%20%20%20%20%20%20if%20%28this.renderer.alpha%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20const%20a2%20%3D%20clearColor.a%3B%0A%20%20%20%20%20%20%20%20clearValue%20%3D%20%7B%20r%3A%20clearColor.r%20%2A%20a2%2C%20g%3A%20clearColor.g%20%2A%20a2%2C%20b%3A%20clearColor.b%20%2A%20a2%2C%20a%3A%20a2%20%7D%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20clearValue%20%3D%20%7B%20r%3A%20clearColor.r%2C%20g%3A%20clearColor.g%2C%20b%3A%20clearColor.b%2C%20a%3A%20clearColor.a%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderTargetData%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20supportsDepth%20%3D%20renderer3.depth%3B%0A%20%20%20%20%20%20supportsStencil%20%3D%20renderer3.stencil%3B%0A%20%20%20%20%20%20const%20descriptor%20%3D%20this._getDefaultRenderPassDescriptor%28%29%3B%0A%20%20%20%20%20%20if%20%28color2%29%20%7B%0A%20%20%20%20%20%20%20%20colorAttachments%20%3D%20descriptor.colorAttachments%3B%0A%20%20%20%20%20%20%20%20const%20colorAttachment%20%3D%20colorAttachments%5B0%5D%3B%0A%20%20%20%20%20%20%20%20colorAttachment.clearValue%20%3D%20clearValue%3B%0A%20%20%20%20%20%20%20%20colorAttachment.loadOp%20%3D%20GPULoadOp.Clear%3B%0A%20%20%20%20%20%20%20%20colorAttachment.storeOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28supportsDepth%20%7C%7C%20supportsStencil%29%20%7B%0A%20%20%20%20%20%20%20%20depthStencilAttachment%20%3D%20descriptor.depthStencilAttachment%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20supportsDepth%20%3D%20renderTargetData.depth%3B%0A%20%20%20%20%20%20supportsStencil%20%3D%20renderTargetData.stencil%3B%0A%20%20%20%20%20%20if%20%28color2%29%20%7B%0A%20%20%20%20%20%20%20%20for%20%28const%20texture2%20of%20renderTargetData.textures%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20textureData%20%3D%20this.get%28texture2%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20textureView%20%3D%20textureData.texture.createView%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20let%20view%2C%20resolveTarget%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28textureData.msaaTexture%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20view%20%3D%20textureData.msaaTexture.createView%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20resolveTarget%20%3D%20textureView%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20view%20%3D%20textureView%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20resolveTarget%20%3D%20void%200%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20colorAttachments.push%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20view%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20resolveTarget%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20clearValue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20loadOp%3A%20GPULoadOp.Clear%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20storeOp%3A%20GPUStoreOp.Store%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28supportsDepth%20%7C%7C%20supportsStencil%29%20%7B%0A%20%20%20%20%20%20%20%20const%20depthTextureData%20%3D%20this.get%28renderTargetData.depthTexture%29%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20view%3A%20depthTextureData.texture.createView%28%29%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28supportsDepth%29%20%7B%0A%20%20%20%20%20%20if%20%28depth2%29%20%7B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthLoadOp%20%3D%20GPULoadOp.Clear%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthClearValue%20%3D%20renderer3.getClearDepth%28%29%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthStoreOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthLoadOp%20%3D%20GPULoadOp.Load%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.depthStoreOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28supportsStencil%29%20%7B%0A%20%20%20%20%20%20if%20%28stencil%29%20%7B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilLoadOp%20%3D%20GPULoadOp.Clear%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilClearValue%20%3D%20renderer3.getClearStencil%28%29%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilStoreOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilLoadOp%20%3D%20GPULoadOp.Load%3B%0A%20%20%20%20%20%20%20%20depthStencilAttachment.stencilStoreOp%20%3D%20GPUStoreOp.Store%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20encoder%20%3D%20device.createCommandEncoder%28%7B%7D%29%3B%0A%20%20%20%20const%20currentPass%20%3D%20encoder.beginRenderPass%28%7B%0A%20%20%20%20%20%20colorAttachments%2C%0A%20%20%20%20%20%20depthStencilAttachment%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20currentPass.end%28%29%3B%0A%20%20%20%20device.queue.submit%28%5Bencoder.finish%28%29%5D%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20compute%0A%20%20beginCompute%28computeGroup%29%20%7B%0A%20%20%20%20const%20groupGPU%20%3D%20this.get%28computeGroup%29%3B%0A%20%20%20%20const%20descriptor%20%3D%20%7B%7D%3B%0A%20%20%20%20this.initTimestampQuery%28computeGroup%2C%20descriptor%29%3B%0A%20%20%20%20groupGPU.cmdEncoderGPU%20%3D%20this.device.createCommandEncoder%28%29%3B%0A%20%20%20%20groupGPU.passEncoderGPU%20%3D%20groupGPU.cmdEncoderGPU.beginComputePass%28descriptor%29%3B%0A%20%20%7D%0A%20%20compute%28computeGroup%2C%20computeNode%2C%20bindings%2C%20pipeline%29%20%7B%0A%20%20%20%20const%20%7B%20passEncoderGPU%20%7D%20%3D%20this.get%28computeGroup%29%3B%0A%20%20%20%20const%20pipelineGPU%20%3D%20this.get%28pipeline%29.pipeline%3B%0A%20%20%20%20passEncoderGPU.setPipeline%28pipelineGPU%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20bindings.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20bindGroup%20%3D%20bindings%5Bi%5D%3B%0A%20%20%20%20%20%20const%20bindingsData%20%3D%20this.get%28bindGroup%29%3B%0A%20%20%20%20%20%20passEncoderGPU.setBindGroup%28i%2C%20bindingsData.group%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20maxComputeWorkgroupsPerDimension%20%3D%20this.device.limits.maxComputeWorkgroupsPerDimension%3B%0A%20%20%20%20const%20computeNodeData%20%3D%20this.get%28computeNode%29%3B%0A%20%20%20%20if%20%28computeNodeData.dispatchSize%20%3D%3D%3D%20void%200%29%20computeNodeData.dispatchSize%20%3D%20%7B%20x%3A%200%2C%20y%3A%201%2C%20z%3A%201%20%7D%3B%0A%20%20%20%20const%20%7B%20dispatchSize%20%7D%20%3D%20computeNodeData%3B%0A%20%20%20%20if%20%28computeNode.dispatchCount%20%3E%20maxComputeWorkgroupsPerDimension%29%20%7B%0A%20%20%20%20%20%20dispatchSize.x%20%3D%20Math.min%28computeNode.dispatchCount%2C%20maxComputeWorkgroupsPerDimension%29%3B%0A%20%20%20%20%20%20dispatchSize.y%20%3D%20Math.ceil%28computeNode.dispatchCount%20%2F%20maxComputeWorkgroupsPerDimension%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20dispatchSize.x%20%3D%20computeNode.dispatchCount%3B%0A%20%20%20%20%7D%0A%20%20%20%20passEncoderGPU.dispatchWorkgroups%28%0A%20%20%20%20%20%20dispatchSize.x%2C%0A%20%20%20%20%20%20dispatchSize.y%2C%0A%20%20%20%20%20%20dispatchSize.z%0A%20%20%20%20%29%3B%0A%20%20%7D%0A%20%20finishCompute%28computeGroup%29%20%7B%0A%20%20%20%20const%20groupData%20%3D%20this.get%28computeGroup%29%3B%0A%20%20%20%20groupData.passEncoderGPU.end%28%29%3B%0A%20%20%20%20this.prepareTimestampBuffer%28computeGroup%2C%20groupData.cmdEncoderGPU%29%3B%0A%20%20%20%20this.device.queue.submit%28%5BgroupData.cmdEncoderGPU.finish%28%29%5D%29%3B%0A%20%20%7D%0A%20%20async%20waitForGPU%28%29%20%7B%0A%20%20%20%20await%20this.device.queue.onSubmittedWorkDone%28%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20render%20object%0A%20%20draw%28renderObject%2C%20info%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20context%3A%20context2%2C%20pipeline%20%7D%20%3D%20renderObject%3B%0A%20%20%20%20const%20bindings%20%3D%20renderObject.getBindings%28%29%3B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28context2%29%3B%0A%20%20%20%20const%20pipelineGPU%20%3D%20this.get%28pipeline%29.pipeline%3B%0A%20%20%20%20const%20currentSets%20%3D%20renderContextData.currentSets%3B%0A%20%20%20%20const%20passEncoderGPU%20%3D%20renderContextData.currentPass%3B%0A%20%20%20%20const%20drawParams%20%3D%20renderObject.getDrawParameters%28%29%3B%0A%20%20%20%20if%20%28drawParams%20%3D%3D%3D%20null%29%20return%3B%0A%20%20%20%20if%20%28currentSets.pipeline%20%21%3D%3D%20pipelineGPU%29%20%7B%0A%20%20%20%20%20%20passEncoderGPU.setPipeline%28pipelineGPU%29%3B%0A%20%20%20%20%20%20currentSets.pipeline%20%3D%20pipelineGPU%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20currentBindingGroups%20%3D%20currentSets.bindingGroups%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20bindings.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20bindGroup%20%3D%20bindings%5Bi%5D%3B%0A%20%20%20%20%20%20const%20bindingsData%20%3D%20this.get%28bindGroup%29%3B%0A%20%20%20%20%20%20if%20%28currentBindingGroups%5BbindGroup.index%5D%20%21%3D%3D%20bindGroup.id%29%20%7B%0A%20%20%20%20%20%20%20%20passEncoderGPU.setBindGroup%28bindGroup.index%2C%20bindingsData.group%29%3B%0A%20%20%20%20%20%20%20%20currentBindingGroups%5BbindGroup.index%5D%20%3D%20bindGroup.id%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20index5%20%3D%20renderObject.getIndex%28%29%3B%0A%20%20%20%20const%20hasIndex%20%3D%20index5%20%21%3D%3D%20null%3B%0A%20%20%20%20if%20%28hasIndex%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20if%20%28currentSets.index%20%21%3D%3D%20index5%29%20%7B%0A%20%20%20%20%20%20%20%20const%20buffer2%20%3D%20this.get%28index5%29.buffer%3B%0A%20%20%20%20%20%20%20%20const%20indexFormat%20%3D%20index5.array%20instanceof%20Uint16Array%20%3F%20GPUIndexFormat.Uint16%20%3A%20GPUIndexFormat.Uint32%3B%0A%20%20%20%20%20%20%20%20passEncoderGPU.setIndexBuffer%28buffer2%2C%20indexFormat%29%3B%0A%20%20%20%20%20%20%20%20currentSets.index%20%3D%20index5%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20vertexBuffers%20%3D%20renderObject.getVertexBuffers%28%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20l%20%3D%20vertexBuffers.length%3B%20i%20%3C%20l%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20vertexBuffer%20%3D%20vertexBuffers%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28currentSets.attributes%5Bi%5D%20%21%3D%3D%20vertexBuffer%29%20%7B%0A%20%20%20%20%20%20%20%20const%20buffer2%20%3D%20this.get%28vertexBuffer%29.buffer%3B%0A%20%20%20%20%20%20%20%20passEncoderGPU.setVertexBuffer%28i%2C%20buffer2%29%3B%0A%20%20%20%20%20%20%20%20currentSets.attributes%5Bi%5D%20%3D%20vertexBuffer%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28renderContextData.occlusionQuerySet%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20lastObject%20%3D%20renderContextData.lastOcclusionObject%3B%0A%20%20%20%20%20%20if%20%28lastObject%20%21%3D%3D%20object%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28lastObject%20%21%3D%3D%20null%20%26%26%20lastObject.occlusionTest%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20passEncoderGPU.endOcclusionQuery%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderContextData.occlusionQueryIndex%2B%2B%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28object.occlusionTest%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20passEncoderGPU.beginOcclusionQuery%28renderContextData.occlusionQueryIndex%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderContextData.occlusionQueryObjects%5BrenderContextData.occlusionQueryIndex%5D%20%3D%20object%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20renderContextData.lastOcclusionObject%20%3D%20object%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28object.isBatchedMesh%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20starts%20%3D%20object._multiDrawStarts%3B%0A%20%20%20%20%20%20const%20counts%20%3D%20object._multiDrawCounts%3B%0A%20%20%20%20%20%20const%20drawCount%20%3D%20object._multiDrawCount%3B%0A%20%20%20%20%20%20const%20drawInstances%20%3D%20object._multiDrawInstances%3B%0A%20%20%20%20%20%20const%20bytesPerElement%20%3D%20hasIndex%20%3F%20index5.array.BYTES_PER_ELEMENT%20%3A%201%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20drawCount%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20const%20count%20%3D%20drawInstances%20%3F%20drawInstances%5Bi%5D%20%3A%201%3B%0A%20%20%20%20%20%20%20%20const%20firstInstance%20%3D%20count%20%3E%201%20%3F%200%20%3A%20i%3B%0A%20%20%20%20%20%20%20%20passEncoderGPU.drawIndexed%28counts%5Bi%5D%2C%20count%2C%20starts%5Bi%5D%20%2F%20bytesPerElement%2C%200%2C%20firstInstance%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28hasIndex%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20vertexCount%3A%20indexCount%2C%20instanceCount%2C%20firstVertex%3A%20firstIndex%20%7D%20%3D%20drawParams%3B%0A%20%20%20%20%20%20const%20indirect%20%3D%20renderObject.getIndirect%28%29%3B%0A%20%20%20%20%20%20if%20%28indirect%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20const%20buffer2%20%3D%20this.get%28indirect%29.buffer%3B%0A%20%20%20%20%20%20%20%20passEncoderGPU.drawIndexedIndirect%28buffer2%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20passEncoderGPU.drawIndexed%28indexCount%2C%20instanceCount%2C%20firstIndex%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20info.update%28object%2C%20indexCount%2C%20instanceCount%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20%7B%20vertexCount%2C%20instanceCount%2C%20firstVertex%20%7D%20%3D%20drawParams%3B%0A%20%20%20%20%20%20const%20indirect%20%3D%20renderObject.getIndirect%28%29%3B%0A%20%20%20%20%20%20if%20%28indirect%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20const%20buffer2%20%3D%20this.get%28indirect%29.buffer%3B%0A%20%20%20%20%20%20%20%20passEncoderGPU.drawIndirect%28buffer2%2C%200%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20passEncoderGPU.draw%28vertexCount%2C%20instanceCount%2C%20firstVertex%2C%200%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20info.update%28object%2C%20vertexCount%2C%20instanceCount%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2F%20cache%20key%0A%20%20needsRenderUpdate%28renderObject%29%20%7B%0A%20%20%20%20const%20data%20%3D%20this.get%28renderObject%29%3B%0A%20%20%20%20const%20%7B%20object%2C%20material%20%7D%20%3D%20renderObject%3B%0A%20%20%20%20const%20utils%20%3D%20this.utils%3B%0A%20%20%20%20const%20sampleCount%20%3D%20utils.getSampleCountRenderContext%28renderObject.context%29%3B%0A%20%20%20%20const%20colorSpace%20%3D%20utils.getCurrentColorSpace%28renderObject.context%29%3B%0A%20%20%20%20const%20colorFormat%20%3D%20utils.getCurrentColorFormat%28renderObject.context%29%3B%0A%20%20%20%20const%20depthStencilFormat%20%3D%20utils.getCurrentDepthStencilFormat%28renderObject.context%29%3B%0A%20%20%20%20const%20primitiveTopology%20%3D%20utils.getPrimitiveTopology%28object%2C%20material%29%3B%0A%20%20%20%20let%20needsUpdate%20%3D%20false%3B%0A%20%20%20%20if%20%28data.material%20%21%3D%3D%20material%20%7C%7C%20data.materialVersion%20%21%3D%3D%20material.version%20%7C%7C%20data.transparent%20%21%3D%3D%20material.transparent%20%7C%7C%20data.blending%20%21%3D%3D%20material.blending%20%7C%7C%20data.premultipliedAlpha%20%21%3D%3D%20material.premultipliedAlpha%20%7C%7C%20data.blendSrc%20%21%3D%3D%20material.blendSrc%20%7C%7C%20data.blendDst%20%21%3D%3D%20material.blendDst%20%7C%7C%20data.blendEquation%20%21%3D%3D%20material.blendEquation%20%7C%7C%20data.blendSrcAlpha%20%21%3D%3D%20material.blendSrcAlpha%20%7C%7C%20data.blendDstAlpha%20%21%3D%3D%20material.blendDstAlpha%20%7C%7C%20data.blendEquationAlpha%20%21%3D%3D%20material.blendEquationAlpha%20%7C%7C%20data.colorWrite%20%21%3D%3D%20material.colorWrite%20%7C%7C%20data.depthWrite%20%21%3D%3D%20material.depthWrite%20%7C%7C%20data.depthTest%20%21%3D%3D%20material.depthTest%20%7C%7C%20data.depthFunc%20%21%3D%3D%20material.depthFunc%20%7C%7C%20data.stencilWrite%20%21%3D%3D%20material.stencilWrite%20%7C%7C%20data.stencilFunc%20%21%3D%3D%20material.stencilFunc%20%7C%7C%20data.stencilFail%20%21%3D%3D%20material.stencilFail%20%7C%7C%20data.stencilZFail%20%21%3D%3D%20material.stencilZFail%20%7C%7C%20data.stencilZPass%20%21%3D%3D%20material.stencilZPass%20%7C%7C%20data.stencilFuncMask%20%21%3D%3D%20material.stencilFuncMask%20%7C%7C%20data.stencilWriteMask%20%21%3D%3D%20material.stencilWriteMask%20%7C%7C%20data.side%20%21%3D%3D%20material.side%20%7C%7C%20data.alphaToCoverage%20%21%3D%3D%20material.alphaToCoverage%20%7C%7C%20data.sampleCount%20%21%3D%3D%20sampleCount%20%7C%7C%20data.colorSpace%20%21%3D%3D%20colorSpace%20%7C%7C%20data.colorFormat%20%21%3D%3D%20colorFormat%20%7C%7C%20data.depthStencilFormat%20%21%3D%3D%20depthStencilFormat%20%7C%7C%20data.primitiveTopology%20%21%3D%3D%20primitiveTopology%20%7C%7C%20data.clippingContextCacheKey%20%21%3D%3D%20renderObject.clippingContext.cacheKey%29%20%7B%0A%20%20%20%20%20%20data.material%20%3D%20material%3B%0A%20%20%20%20%20%20data.materialVersion%20%3D%20material.version%3B%0A%20%20%20%20%20%20data.transparent%20%3D%20material.transparent%3B%0A%20%20%20%20%20%20data.blending%20%3D%20material.blending%3B%0A%20%20%20%20%20%20data.premultipliedAlpha%20%3D%20material.premultipliedAlpha%3B%0A%20%20%20%20%20%20data.blendSrc%20%3D%20material.blendSrc%3B%0A%20%20%20%20%20%20data.blendDst%20%3D%20material.blendDst%3B%0A%20%20%20%20%20%20data.blendEquation%20%3D%20material.blendEquation%3B%0A%20%20%20%20%20%20data.blendSrcAlpha%20%3D%20material.blendSrcAlpha%3B%0A%20%20%20%20%20%20data.blendDstAlpha%20%3D%20material.blendDstAlpha%3B%0A%20%20%20%20%20%20data.blendEquationAlpha%20%3D%20material.blendEquationAlpha%3B%0A%20%20%20%20%20%20data.colorWrite%20%3D%20material.colorWrite%3B%0A%20%20%20%20%20%20data.depthWrite%20%3D%20material.depthWrite%3B%0A%20%20%20%20%20%20data.depthTest%20%3D%20material.depthTest%3B%0A%20%20%20%20%20%20data.depthFunc%20%3D%20material.depthFunc%3B%0A%20%20%20%20%20%20data.stencilWrite%20%3D%20material.stencilWrite%3B%0A%20%20%20%20%20%20data.stencilFunc%20%3D%20material.stencilFunc%3B%0A%20%20%20%20%20%20data.stencilFail%20%3D%20material.stencilFail%3B%0A%20%20%20%20%20%20data.stencilZFail%20%3D%20material.stencilZFail%3B%0A%20%20%20%20%20%20data.stencilZPass%20%3D%20material.stencilZPass%3B%0A%20%20%20%20%20%20data.stencilFuncMask%20%3D%20material.stencilFuncMask%3B%0A%20%20%20%20%20%20data.stencilWriteMask%20%3D%20material.stencilWriteMask%3B%0A%20%20%20%20%20%20data.side%20%3D%20material.side%3B%0A%20%20%20%20%20%20data.alphaToCoverage%20%3D%20material.alphaToCoverage%3B%0A%20%20%20%20%20%20data.sampleCount%20%3D%20sampleCount%3B%0A%20%20%20%20%20%20data.colorSpace%20%3D%20colorSpace%3B%0A%20%20%20%20%20%20data.colorFormat%20%3D%20colorFormat%3B%0A%20%20%20%20%20%20data.depthStencilFormat%20%3D%20depthStencilFormat%3B%0A%20%20%20%20%20%20data.primitiveTopology%20%3D%20primitiveTopology%3B%0A%20%20%20%20%20%20data.clippingContextCacheKey%20%3D%20renderObject.clippingContext.cacheKey%3B%0A%20%20%20%20%20%20needsUpdate%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20needsUpdate%3B%0A%20%20%7D%0A%20%20getRenderCacheKey%28renderObject%29%20%7B%0A%20%20%20%20const%20%7B%20object%2C%20material%20%7D%20%3D%20renderObject%3B%0A%20%20%20%20const%20utils%20%3D%20this.utils%3B%0A%20%20%20%20const%20renderContext%20%3D%20renderObject.context%3B%0A%20%20%20%20return%20%5B%0A%20%20%20%20%20%20material.transparent%2C%0A%20%20%20%20%20%20material.blending%2C%0A%20%20%20%20%20%20material.premultipliedAlpha%2C%0A%20%20%20%20%20%20material.blendSrc%2C%0A%20%20%20%20%20%20material.blendDst%2C%0A%20%20%20%20%20%20material.blendEquation%2C%0A%20%20%20%20%20%20material.blendSrcAlpha%2C%0A%20%20%20%20%20%20material.blendDstAlpha%2C%0A%20%20%20%20%20%20material.blendEquationAlpha%2C%0A%20%20%20%20%20%20material.colorWrite%2C%0A%20%20%20%20%20%20material.depthWrite%2C%0A%20%20%20%20%20%20material.depthTest%2C%0A%20%20%20%20%20%20material.depthFunc%2C%0A%20%20%20%20%20%20material.stencilWrite%2C%0A%20%20%20%20%20%20material.stencilFunc%2C%0A%20%20%20%20%20%20material.stencilFail%2C%0A%20%20%20%20%20%20material.stencilZFail%2C%0A%20%20%20%20%20%20material.stencilZPass%2C%0A%20%20%20%20%20%20material.stencilFuncMask%2C%0A%20%20%20%20%20%20material.stencilWriteMask%2C%0A%20%20%20%20%20%20material.side%2C%0A%20%20%20%20%20%20utils.getSampleCountRenderContext%28renderContext%29%2C%0A%20%20%20%20%20%20utils.getCurrentColorSpace%28renderContext%29%2C%0A%20%20%20%20%20%20utils.getCurrentColorFormat%28renderContext%29%2C%0A%20%20%20%20%20%20utils.getCurrentDepthStencilFormat%28renderContext%29%2C%0A%20%20%20%20%20%20utils.getPrimitiveTopology%28object%2C%20material%29%2C%0A%20%20%20%20%20%20renderObject.getGeometryCacheKey%28%29%2C%0A%20%20%20%20%20%20renderObject.clippingContext.cacheKey%0A%20%20%20%20%5D.join%28%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20textures%0A%20%20createSampler%28texture2%29%20%7B%0A%20%20%20%20this.textureUtils.createSampler%28texture2%29%3B%0A%20%20%7D%0A%20%20destroySampler%28texture2%29%20%7B%0A%20%20%20%20this.textureUtils.destroySampler%28texture2%29%3B%0A%20%20%7D%0A%20%20createDefaultTexture%28texture2%29%20%7B%0A%20%20%20%20this.textureUtils.createDefaultTexture%28texture2%29%3B%0A%20%20%7D%0A%20%20createTexture%28texture2%2C%20options%29%20%7B%0A%20%20%20%20this.textureUtils.createTexture%28texture2%2C%20options%29%3B%0A%20%20%7D%0A%20%20updateTexture%28texture2%2C%20options%29%20%7B%0A%20%20%20%20this.textureUtils.updateTexture%28texture2%2C%20options%29%3B%0A%20%20%7D%0A%20%20generateMipmaps%28texture2%29%20%7B%0A%20%20%20%20this.textureUtils.generateMipmaps%28texture2%29%3B%0A%20%20%7D%0A%20%20destroyTexture%28texture2%29%20%7B%0A%20%20%20%20this.textureUtils.destroyTexture%28texture2%29%3B%0A%20%20%7D%0A%20%20copyTextureToBuffer%28texture2%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20faceIndex%29%20%7B%0A%20%20%20%20return%20this.textureUtils.copyTextureToBuffer%28texture2%2C%20x2%2C%20y2%2C%20width%2C%20height%2C%20faceIndex%29%3B%0A%20%20%7D%0A%20%20initTimestampQuery%28renderContext%2C%20descriptor%29%20%7B%0A%20%20%20%20if%20%28%21this.trackTimestamp%29%20return%3B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20if%20%28%21renderContextData.timeStampQuerySet%29%20%7B%0A%20%20%20%20%20%20const%20timeStampQuerySet%20%3D%20this.device.createQuerySet%28%7B%20type%3A%20%22timestamp%22%2C%20count%3A%202%20%7D%29%3B%0A%20%20%20%20%20%20const%20timestampWrites%20%3D%20%7B%0A%20%20%20%20%20%20%20%20querySet%3A%20timeStampQuerySet%2C%0A%20%20%20%20%20%20%20%20beginningOfPassWriteIndex%3A%200%2C%0A%20%20%20%20%20%20%20%20%2F%2F%20Write%20timestamp%20in%20index%200%20when%20pass%20begins.%0A%20%20%20%20%20%20%20%20endOfPassWriteIndex%3A%201%0A%20%20%20%20%20%20%20%20%2F%2F%20Write%20timestamp%20in%20index%201%20when%20pass%20ends.%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20Object.assign%28descriptor%2C%20%7B%0A%20%20%20%20%20%20%20%20timestampWrites%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20renderContextData.timeStampQuerySet%20%3D%20timeStampQuerySet%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2F%20timestamp%20utils%0A%20%20prepareTimestampBuffer%28renderContext%2C%20encoder%29%20%7B%0A%20%20%20%20if%20%28%21this.trackTimestamp%29%20return%3B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20const%20size%20%3D%202%20%2A%20BigInt64Array.BYTES_PER_ELEMENT%3B%0A%20%20%20%20if%20%28renderContextData.currentTimestampQueryBuffers%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20renderContextData.currentTimestampQueryBuffers%20%3D%20%7B%0A%20%20%20%20%20%20%20%20resolveBuffer%3A%20this.device.createBuffer%28%7B%0A%20%20%20%20%20%20%20%20%20%20label%3A%20%22timestamp%20resolve%20buffer%22%2C%0A%20%20%20%20%20%20%20%20%20%20size%2C%0A%20%20%20%20%20%20%20%20%20%20usage%3A%20GPUBufferUsage.QUERY_RESOLVE%20%7C%20GPUBufferUsage.COPY_SRC%0A%20%20%20%20%20%20%20%20%7D%29%2C%0A%20%20%20%20%20%20%20%20resultBuffer%3A%20this.device.createBuffer%28%7B%0A%20%20%20%20%20%20%20%20%20%20label%3A%20%22timestamp%20result%20buffer%22%2C%0A%20%20%20%20%20%20%20%20%20%20size%2C%0A%20%20%20%20%20%20%20%20%20%20usage%3A%20GPUBufferUsage.COPY_DST%20%7C%20GPUBufferUsage.MAP_READ%0A%20%20%20%20%20%20%20%20%7D%29%2C%0A%20%20%20%20%20%20%20%20isMappingPending%3A%20false%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20%7B%20resolveBuffer%2C%20resultBuffer%2C%20isMappingPending%20%7D%20%3D%20renderContextData.currentTimestampQueryBuffers%3B%0A%20%20%20%20if%20%28isMappingPending%20%3D%3D%3D%20true%29%20return%3B%0A%20%20%20%20encoder.resolveQuerySet%28renderContextData.timeStampQuerySet%2C%200%2C%202%2C%20resolveBuffer%2C%200%29%3B%0A%20%20%20%20encoder.copyBufferToBuffer%28resolveBuffer%2C%200%2C%20resultBuffer%2C%200%2C%20size%29%3B%0A%20%20%7D%0A%20%20async%20resolveTimestampAsync%28renderContext%2C%20type%20%3D%20%22render%22%29%20%7B%0A%20%20%20%20if%20%28%21this.trackTimestamp%29%20return%3B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20if%20%28renderContextData.currentTimestampQueryBuffers%20%3D%3D%3D%20void%200%29%20return%3B%0A%20%20%20%20const%20%7B%20resultBuffer%2C%20isMappingPending%20%7D%20%3D%20renderContextData.currentTimestampQueryBuffers%3B%0A%20%20%20%20if%20%28isMappingPending%20%3D%3D%3D%20true%29%20return%3B%0A%20%20%20%20renderContextData.currentTimestampQueryBuffers.isMappingPending%20%3D%20true%3B%0A%20%20%20%20resultBuffer.mapAsync%28GPUMapMode.READ%29.then%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20times%20%3D%20new%20BigUint64Array%28resultBuffer.getMappedRange%28%29%29%3B%0A%20%20%20%20%20%20const%20duration%20%3D%20Number%28times%5B1%5D%20-%20times%5B0%5D%29%20%2F%201e6%3B%0A%20%20%20%20%20%20this.renderer.info.updateTimestamp%28type%2C%20duration%29%3B%0A%20%20%20%20%20%20resultBuffer.unmap%28%29%3B%0A%20%20%20%20%20%20renderContextData.currentTimestampQueryBuffers.isMappingPending%20%3D%20false%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20node%20builder%0A%20%20createNodeBuilder%28object%2C%20renderer3%29%20%7B%0A%20%20%20%20return%20new%20WGSLNodeBuilder%28object%2C%20renderer3%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20program%0A%20%20createProgram%28program%29%20%7B%0A%20%20%20%20const%20programGPU%20%3D%20this.get%28program%29%3B%0A%20%20%20%20programGPU.module%20%3D%20%7B%0A%20%20%20%20%20%20module%3A%20this.device.createShaderModule%28%7B%20code%3A%20program.code%2C%20label%3A%20program.stage%20%7D%29%2C%0A%20%20%20%20%20%20entryPoint%3A%20%22main%22%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20destroyProgram%28program%29%20%7B%0A%20%20%20%20this.delete%28program%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20pipelines%0A%20%20createRenderPipeline%28renderObject%2C%20promises%29%20%7B%0A%20%20%20%20this.pipelineUtils.createRenderPipeline%28renderObject%2C%20promises%29%3B%0A%20%20%7D%0A%20%20createComputePipeline%28computePipeline%2C%20bindings%29%20%7B%0A%20%20%20%20this.pipelineUtils.createComputePipeline%28computePipeline%2C%20bindings%29%3B%0A%20%20%7D%0A%20%20beginBundle%28renderContext%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20renderContextData._currentPass%20%3D%20renderContextData.currentPass%3B%0A%20%20%20%20renderContextData._currentSets%20%3D%20renderContextData.currentSets%3B%0A%20%20%20%20renderContextData.currentSets%20%3D%20%7B%20attributes%3A%20%7B%7D%2C%20bindingGroups%3A%20%5B%5D%2C%20pipeline%3A%20null%2C%20index%3A%20null%20%7D%3B%0A%20%20%20%20renderContextData.currentPass%20%3D%20this.pipelineUtils.createBundleEncoder%28renderContext%29%3B%0A%20%20%7D%0A%20%20finishBundle%28renderContext%2C%20bundle%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20const%20bundleEncoder%20%3D%20renderContextData.currentPass%3B%0A%20%20%20%20const%20bundleGPU%20%3D%20bundleEncoder.finish%28%29%3B%0A%20%20%20%20this.get%28bundle%29.bundleGPU%20%3D%20bundleGPU%3B%0A%20%20%20%20renderContextData.currentSets%20%3D%20renderContextData._currentSets%3B%0A%20%20%20%20renderContextData.currentPass%20%3D%20renderContextData._currentPass%3B%0A%20%20%7D%0A%20%20addBundle%28renderContext%2C%20bundle%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20renderContextData.renderBundles.push%28this.get%28bundle%29.bundleGPU%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20bindings%0A%20%20createBindings%28bindGroup%29%20%7B%0A%20%20%20%20this.bindingUtils.createBindings%28bindGroup%29%3B%0A%20%20%7D%0A%20%20updateBindings%28bindGroup%29%20%7B%0A%20%20%20%20this.bindingUtils.createBindings%28bindGroup%29%3B%0A%20%20%7D%0A%20%20updateBinding%28binding%29%20%7B%0A%20%20%20%20this.bindingUtils.updateBinding%28binding%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20attributes%0A%20%20createIndexAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.attributeUtils.createAttribute%28attribute2%2C%20GPUBufferUsage.INDEX%20%7C%20GPUBufferUsage.COPY_SRC%20%7C%20GPUBufferUsage.COPY_DST%29%3B%0A%20%20%7D%0A%20%20createAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.attributeUtils.createAttribute%28attribute2%2C%20GPUBufferUsage.VERTEX%20%7C%20GPUBufferUsage.COPY_SRC%20%7C%20GPUBufferUsage.COPY_DST%29%3B%0A%20%20%7D%0A%20%20createStorageAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.attributeUtils.createAttribute%28attribute2%2C%20GPUBufferUsage.STORAGE%20%7C%20GPUBufferUsage.VERTEX%20%7C%20GPUBufferUsage.COPY_SRC%20%7C%20GPUBufferUsage.COPY_DST%29%3B%0A%20%20%7D%0A%20%20createIndirectStorageAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.attributeUtils.createAttribute%28attribute2%2C%20GPUBufferUsage.STORAGE%20%7C%20GPUBufferUsage.INDIRECT%20%7C%20GPUBufferUsage.COPY_SRC%20%7C%20GPUBufferUsage.COPY_DST%29%3B%0A%20%20%7D%0A%20%20updateAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.attributeUtils.updateAttribute%28attribute2%29%3B%0A%20%20%7D%0A%20%20destroyAttribute%28attribute2%29%20%7B%0A%20%20%20%20this.attributeUtils.destroyAttribute%28attribute2%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20canvas%0A%20%20updateSize%28%29%20%7B%0A%20%20%20%20this.colorBuffer%20%3D%20this.textureUtils.getColorBuffer%28%29%3B%0A%20%20%20%20this.defaultRenderPassdescriptor%20%3D%20null%3B%0A%20%20%7D%0A%20%20%2F%2F%20utils%20public%0A%20%20getMaxAnisotropy%28%29%20%7B%0A%20%20%20%20return%2016%3B%0A%20%20%7D%0A%20%20hasFeature%28name%29%20%7B%0A%20%20%20%20return%20this.device.features.has%28name%29%3B%0A%20%20%7D%0A%20%20copyTextureToTexture%28srcTexture%2C%20dstTexture%2C%20srcRegion%20%3D%20null%2C%20dstPosition%20%3D%20null%2C%20level%20%3D%200%29%20%7B%0A%20%20%20%20let%20dstX%20%3D%200%3B%0A%20%20%20%20let%20dstY%20%3D%200%3B%0A%20%20%20%20let%20dstLayer%20%3D%200%3B%0A%20%20%20%20let%20srcX%20%3D%200%3B%0A%20%20%20%20let%20srcY%20%3D%200%3B%0A%20%20%20%20let%20srcLayer%20%3D%200%3B%0A%20%20%20%20let%20srcWidth%20%3D%20srcTexture.image.width%3B%0A%20%20%20%20let%20srcHeight%20%3D%20srcTexture.image.height%3B%0A%20%20%20%20if%20%28srcRegion%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20srcX%20%3D%20srcRegion.x%3B%0A%20%20%20%20%20%20srcY%20%3D%20srcRegion.y%3B%0A%20%20%20%20%20%20srcLayer%20%3D%20srcRegion.z%20%7C%7C%200%3B%0A%20%20%20%20%20%20srcWidth%20%3D%20srcRegion.width%3B%0A%20%20%20%20%20%20srcHeight%20%3D%20srcRegion.height%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28dstPosition%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20dstX%20%3D%20dstPosition.x%3B%0A%20%20%20%20%20%20dstY%20%3D%20dstPosition.y%3B%0A%20%20%20%20%20%20dstLayer%20%3D%20dstPosition.z%20%7C%7C%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20encoder%20%3D%20this.device.createCommandEncoder%28%7B%20label%3A%20%22copyTextureToTexture_%22%20%2B%20srcTexture.id%20%2B%20%22_%22%20%2B%20dstTexture.id%20%7D%29%3B%0A%20%20%20%20const%20sourceGPU%20%3D%20this.get%28srcTexture%29.texture%3B%0A%20%20%20%20const%20destinationGPU%20%3D%20this.get%28dstTexture%29.texture%3B%0A%20%20%20%20encoder.copyTextureToTexture%28%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture%3A%20sourceGPU%2C%0A%20%20%20%20%20%20%20%20mipLevel%3A%20level%2C%0A%20%20%20%20%20%20%20%20origin%3A%20%7B%20x%3A%20srcX%2C%20y%3A%20srcY%2C%20z%3A%20srcLayer%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture%3A%20destinationGPU%2C%0A%20%20%20%20%20%20%20%20mipLevel%3A%20level%2C%0A%20%20%20%20%20%20%20%20origin%3A%20%7B%20x%3A%20dstX%2C%20y%3A%20dstY%2C%20z%3A%20dstLayer%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20srcWidth%2C%0A%20%20%20%20%20%20%20%20srcHeight%2C%0A%20%20%20%20%20%20%20%201%0A%20%20%20%20%20%20%5D%0A%20%20%20%20%29%3B%0A%20%20%20%20this.device.queue.submit%28%5Bencoder.finish%28%29%5D%29%3B%0A%20%20%7D%0A%20%20copyFramebufferToTexture%28texture2%2C%20renderContext%2C%20rectangle%29%20%7B%0A%20%20%20%20const%20renderContextData%20%3D%20this.get%28renderContext%29%3B%0A%20%20%20%20let%20sourceGPU%20%3D%20null%3B%0A%20%20%20%20if%20%28renderContext.renderTarget%29%20%7B%0A%20%20%20%20%20%20if%20%28texture2.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20sourceGPU%20%3D%20this.get%28renderContext.depthTexture%29.texture%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20sourceGPU%20%3D%20this.get%28renderContext.textures%5B0%5D%29.texture%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28texture2.isDepthTexture%29%20%7B%0A%20%20%20%20%20%20%20%20sourceGPU%20%3D%20this.textureUtils.getDepthBuffer%28renderContext.depth%2C%20renderContext.stencil%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20sourceGPU%20%3D%20this.context.getCurrentTexture%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20destinationGPU%20%3D%20this.get%28texture2%29.texture%3B%0A%20%20%20%20if%20%28sourceGPU.format%20%21%3D%3D%20destinationGPU.format%29%20%7B%0A%20%20%20%20%20%20console.error%28%22WebGPUBackend%3A%20copyFramebufferToTexture%3A%20Source%20and%20destination%20formats%20do%20not%20match.%22%2C%20sourceGPU.format%2C%20destinationGPU.format%29%3B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20encoder%3B%0A%20%20%20%20if%20%28renderContextData.currentPass%29%20%7B%0A%20%20%20%20%20%20renderContextData.currentPass.end%28%29%3B%0A%20%20%20%20%20%20encoder%20%3D%20renderContextData.encoder%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20encoder%20%3D%20this.device.createCommandEncoder%28%7B%20label%3A%20%22copyFramebufferToTexture_%22%20%2B%20texture2.id%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20encoder.copyTextureToTexture%28%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture%3A%20sourceGPU%2C%0A%20%20%20%20%20%20%20%20origin%3A%20%7B%20x%3A%20rectangle.x%2C%20y%3A%20rectangle.y%2C%20z%3A%200%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20texture%3A%20destinationGPU%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20rectangle.z%2C%0A%20%20%20%20%20%20%20%20rectangle.w%0A%20%20%20%20%20%20%5D%0A%20%20%20%20%29%3B%0A%20%20%20%20if%20%28texture2.generateMipmaps%29%20this.textureUtils.generateMipmaps%28texture2%29%3B%0A%20%20%20%20if%20%28renderContextData.currentPass%29%20%7B%0A%20%20%20%20%20%20const%20%7B%20descriptor%20%7D%20%3D%20renderContextData%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20descriptor.colorAttachments.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20descriptor.colorAttachments%5Bi%5D.loadOp%20%3D%20GPULoadOp.Load%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28renderContext.depth%29%20descriptor.depthStencilAttachment.depthLoadOp%20%3D%20GPULoadOp.Load%3B%0A%20%20%20%20%20%20if%20%28renderContext.stencil%29%20descriptor.depthStencilAttachment.stencilLoadOp%20%3D%20GPULoadOp.Load%3B%0A%20%20%20%20%20%20renderContextData.currentPass%20%3D%20encoder.beginRenderPass%28descriptor%29%3B%0A%20%20%20%20%20%20renderContextData.currentSets%20%3D%20%7B%20attributes%3A%20%7B%7D%2C%20bindingGroups%3A%20%5B%5D%2C%20pipeline%3A%20null%2C%20index%3A%20null%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.device.queue.submit%28%5Bencoder.finish%28%29%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20IESSpotLight%20%3D%20class%20extends%20SpotLight%20%7B%0A%20%20constructor%28color2%2C%20intensity%2C%20distance2%2C%20angle%2C%20penumbra%2C%20decay%29%20%7B%0A%20%20%20%20super%28color2%2C%20intensity%2C%20distance2%2C%20angle%2C%20penumbra%2C%20decay%29%3B%0A%20%20%20%20this.iesMap%20%3D%20null%3B%0A%20%20%7D%0A%20%20copy%28source%2C%20recursive%29%20%7B%0A%20%20%20%20super.copy%28source%2C%20recursive%29%3B%0A%20%20%20%20this.iesMap%20%3D%20source.iesMap%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%0A%7D%3B%0Avar%20StandardNodeLibrary%20%3D%20class%20extends%20NodeLibrary%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.addMaterial%28MeshPhongNodeMaterial%2C%20MeshPhongMaterial%29%3B%0A%20%20%20%20this.addMaterial%28MeshStandardNodeMaterial%2C%20MeshStandardMaterial%29%3B%0A%20%20%20%20this.addMaterial%28MeshPhysicalNodeMaterial%2C%20MeshPhysicalMaterial%29%3B%0A%20%20%20%20this.addMaterial%28MeshToonNodeMaterial%2C%20MeshToonMaterial%29%3B%0A%20%20%20%20this.addMaterial%28MeshBasicNodeMaterial%2C%20MeshBasicMaterial2%29%3B%0A%20%20%20%20this.addMaterial%28MeshLambertNodeMaterial%2C%20MeshLambertMaterial2%29%3B%0A%20%20%20%20this.addMaterial%28MeshNormalNodeMaterial%2C%20MeshNormalMaterial%29%3B%0A%20%20%20%20this.addMaterial%28MeshMatcapNodeMaterial%2C%20MeshMatcapMaterial%29%3B%0A%20%20%20%20this.addMaterial%28LineBasicNodeMaterial%2C%20LineBasicMaterial2%29%3B%0A%20%20%20%20this.addMaterial%28LineDashedNodeMaterial%2C%20LineDashedMaterial%29%3B%0A%20%20%20%20this.addMaterial%28PointsNodeMaterial%2C%20PointsMaterial%29%3B%0A%20%20%20%20this.addMaterial%28SpriteNodeMaterial%2C%20SpriteMaterial%29%3B%0A%20%20%20%20this.addMaterial%28ShadowNodeMaterial%2C%20ShadowMaterial%29%3B%0A%20%20%20%20this.addLight%28PointLightNode%2C%20PointLight%29%3B%0A%20%20%20%20this.addLight%28DirectionalLightNode%2C%20DirectionalLight2%29%3B%0A%20%20%20%20this.addLight%28RectAreaLightNode%2C%20RectAreaLight%29%3B%0A%20%20%20%20this.addLight%28SpotLightNode%2C%20SpotLight%29%3B%0A%20%20%20%20this.addLight%28AmbientLightNode%2C%20AmbientLight2%29%3B%0A%20%20%20%20this.addLight%28HemisphereLightNode%2C%20HemisphereLight%29%3B%0A%20%20%20%20this.addLight%28LightProbeNode%2C%20LightProbe%29%3B%0A%20%20%20%20this.addLight%28IESSpotLightNode%2C%20IESSpotLight%29%3B%0A%20%20%20%20this.addToneMapping%28linearToneMapping%2C%20LinearToneMapping2%29%3B%0A%20%20%20%20this.addToneMapping%28reinhardToneMapping%2C%20ReinhardToneMapping2%29%3B%0A%20%20%20%20this.addToneMapping%28cineonToneMapping%2C%20CineonToneMapping2%29%3B%0A%20%20%20%20this.addToneMapping%28acesFilmicToneMapping%2C%20ACESFilmicToneMapping2%29%3B%0A%20%20%20%20this.addToneMapping%28agxToneMapping%2C%20AgXToneMapping2%29%3B%0A%20%20%20%20this.addToneMapping%28neutralToneMapping%2C%20NeutralToneMapping2%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20WebGPURenderer%20%3D%20class%20extends%20Renderer%20%7B%0A%20%20constructor%28parameters%20%3D%20%7B%7D%29%20%7B%0A%20%20%20%20let%20BackendClass%3B%0A%20%20%20%20if%20%28parameters.forceWebGL%29%20%7B%0A%20%20%20%20%20%20BackendClass%20%3D%20WebGLBackend%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20BackendClass%20%3D%20WebGPUBackend%3B%0A%20%20%20%20%20%20parameters.getFallback%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.WebGPURenderer%3A%20WebGPU%20is%20not%20available%2C%20running%20under%20WebGL2%20backend.%22%29%3B%0A%20%20%20%20%20%20%20%20return%20new%20WebGLBackend%28parameters%29%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20backend%20%3D%20new%20BackendClass%28parameters%29%3B%0A%20%20%20%20super%28backend%2C%20parameters%29%3B%0A%20%20%20%20this.library%20%3D%20new%20StandardNodeLibrary%28%29%3B%0A%20%20%20%20this.isWebGPURenderer%20%3D%20true%3B%0A%20%20%7D%0A%7D%3B%0Aif%20%28typeof%20__THREE_DEVTOOLS__%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20__THREE_DEVTOOLS__.dispatchEvent%28new%20CustomEvent%28%22register%22%2C%20%7B%20detail%3A%20%7B%0A%20%20%20%20revision%3A%20REVISION2%0A%20%20%7D%20%7D%29%29%3B%0A%7D%0Aif%20%28typeof%20window%20%21%3D%3D%20%22undefined%22%29%20%7B%0A%20%20if%20%28window.__THREE__%29%20%7B%0A%20%20%20%20console.warn%28%22WARNING%3A%20Multiple%20instances%20of%20Three.js%20being%20imported.%22%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20window.__THREE__%20%3D%20REVISION2%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fcontrols%2FTrackballControls.js%0Avar%20_changeEvent%20%3D%20%7B%20type%3A%20%22change%22%20%7D%3B%0Avar%20_startEvent%20%3D%20%7B%20type%3A%20%22start%22%20%7D%3B%0Avar%20_endEvent%20%3D%20%7B%20type%3A%20%22end%22%20%7D%3B%0Avar%20_EPS%20%3D%201e-6%3B%0Avar%20_STATE%20%3D%20%7B%20NONE%3A%20-1%2C%20ROTATE%3A%200%2C%20ZOOM%3A%201%2C%20PAN%3A%202%2C%20TOUCH_ROTATE%3A%203%2C%20TOUCH_ZOOM_PAN%3A%204%20%7D%3B%0Avar%20_v2%20%3D%20new%20Vector2%28%29%3B%0Avar%20_mouseChange%20%3D%20new%20Vector2%28%29%3B%0Avar%20_objectUp%20%3D%20new%20Vector3%28%29%3B%0Avar%20_pan%20%3D%20new%20Vector3%28%29%3B%0Avar%20_axis%20%3D%20new%20Vector3%28%29%3B%0Avar%20_quaternion%20%3D%20new%20Quaternion%28%29%3B%0Avar%20_eyeDirection%20%3D%20new%20Vector3%28%29%3B%0Avar%20_objectUpDirection%20%3D%20new%20Vector3%28%29%3B%0Avar%20_objectSidewaysDirection%20%3D%20new%20Vector3%28%29%3B%0Avar%20_moveDirection%20%3D%20new%20Vector3%28%29%3B%0Avar%20TrackballControls%20%3D%20class%20extends%20Controls%20%7B%0A%20%20constructor%28object%2C%20domElement%20%3D%20null%29%20%7B%0A%20%20%20%20super%28object%2C%20domElement%29%3B%0A%20%20%20%20this.enabled%20%3D%20true%3B%0A%20%20%20%20this.screen%20%3D%20%7B%20left%3A%200%2C%20top%3A%200%2C%20width%3A%200%2C%20height%3A%200%20%7D%3B%0A%20%20%20%20this.rotateSpeed%20%3D%201%3B%0A%20%20%20%20this.zoomSpeed%20%3D%201.2%3B%0A%20%20%20%20this.panSpeed%20%3D%200.3%3B%0A%20%20%20%20this.noRotate%20%3D%20false%3B%0A%20%20%20%20this.noZoom%20%3D%20false%3B%0A%20%20%20%20this.noPan%20%3D%20false%3B%0A%20%20%20%20this.staticMoving%20%3D%20false%3B%0A%20%20%20%20this.dynamicDampingFactor%20%3D%200.2%3B%0A%20%20%20%20this.minDistance%20%3D%200%3B%0A%20%20%20%20this.maxDistance%20%3D%20Infinity%3B%0A%20%20%20%20this.minZoom%20%3D%200%3B%0A%20%20%20%20this.maxZoom%20%3D%20Infinity%3B%0A%20%20%20%20this.keys%20%3D%20%5B%0A%20%20%20%20%20%20%22KeyA%22%2C%0A%20%20%20%20%20%20%22KeyS%22%2C%0A%20%20%20%20%20%20%22KeyD%22%0A%20%20%20%20%20%20%2F%2AD%2A%2F%0A%20%20%20%20%5D%3B%0A%20%20%20%20this.mouseButtons%20%3D%20%7B%20LEFT%3A%20MOUSE.ROTATE%2C%20MIDDLE%3A%20MOUSE.DOLLY%2C%20RIGHT%3A%20MOUSE.PAN%20%7D%3B%0A%20%20%20%20this.state%20%3D%20_STATE.NONE%3B%0A%20%20%20%20this.keyState%20%3D%20_STATE.NONE%3B%0A%20%20%20%20this.target%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this._lastPosition%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this._lastZoom%20%3D%201%3B%0A%20%20%20%20this._touchZoomDistanceStart%20%3D%200%3B%0A%20%20%20%20this._touchZoomDistanceEnd%20%3D%200%3B%0A%20%20%20%20this._lastAngle%20%3D%200%3B%0A%20%20%20%20this._eye%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this._movePrev%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._moveCurr%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._lastAxis%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this._zoomStart%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._zoomEnd%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._panStart%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._panEnd%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._pointers%20%3D%20%5B%5D%3B%0A%20%20%20%20this._pointerPositions%20%3D%20%7B%7D%3B%0A%20%20%20%20this._onPointerMove%20%3D%20onPointerMove2.bind%28this%29%3B%0A%20%20%20%20this._onPointerDown%20%3D%20onPointerDown2.bind%28this%29%3B%0A%20%20%20%20this._onPointerUp%20%3D%20onPointerUp.bind%28this%29%3B%0A%20%20%20%20this._onPointerCancel%20%3D%20onPointerCancel2.bind%28this%29%3B%0A%20%20%20%20this._onContextMenu%20%3D%20onContextMenu2.bind%28this%29%3B%0A%20%20%20%20this._onMouseWheel%20%3D%20onMouseWheel.bind%28this%29%3B%0A%20%20%20%20this._onKeyDown%20%3D%20onKeyDown.bind%28this%29%3B%0A%20%20%20%20this._onKeyUp%20%3D%20onKeyUp.bind%28this%29%3B%0A%20%20%20%20this._onTouchStart%20%3D%20onTouchStart.bind%28this%29%3B%0A%20%20%20%20this._onTouchMove%20%3D%20onTouchMove.bind%28this%29%3B%0A%20%20%20%20this._onTouchEnd%20%3D%20onTouchEnd.bind%28this%29%3B%0A%20%20%20%20this._onMouseDown%20%3D%20onMouseDown.bind%28this%29%3B%0A%20%20%20%20this._onMouseMove%20%3D%20onMouseMove.bind%28this%29%3B%0A%20%20%20%20this._onMouseUp%20%3D%20onMouseUp.bind%28this%29%3B%0A%20%20%20%20this._target0%20%3D%20this.target.clone%28%29%3B%0A%20%20%20%20this._position0%20%3D%20this.object.position.clone%28%29%3B%0A%20%20%20%20this._up0%20%3D%20this.object.up.clone%28%29%3B%0A%20%20%20%20this._zoom0%20%3D%20this.object.zoom%3B%0A%20%20%20%20if%20%28domElement%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.connect%28%29%3B%0A%20%20%20%20%20%20this.handleResize%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.update%28%29%3B%0A%20%20%7D%0A%20%20connect%28%29%20%7B%0A%20%20%20%20window.addEventListener%28%22keydown%22%2C%20this._onKeyDown%29%3B%0A%20%20%20%20window.addEventListener%28%22keyup%22%2C%20this._onKeyUp%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointerdown%22%2C%20this._onPointerDown%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointercancel%22%2C%20this._onPointerCancel%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22wheel%22%2C%20this._onMouseWheel%2C%20%7B%20passive%3A%20false%20%7D%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22contextmenu%22%2C%20this._onContextMenu%29%3B%0A%20%20%20%20this.domElement.style.touchAction%20%3D%20%22none%22%3B%0A%20%20%7D%0A%20%20disconnect%28%29%20%7B%0A%20%20%20%20window.removeEventListener%28%22keydown%22%2C%20this._onKeyDown%29%3B%0A%20%20%20%20window.removeEventListener%28%22keyup%22%2C%20this._onKeyUp%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerdown%22%2C%20this._onPointerDown%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerup%22%2C%20this._onPointerUp%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointercancel%22%2C%20this._onPointerCancel%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22wheel%22%2C%20this._onMouseWheel%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22contextmenu%22%2C%20this._onContextMenu%29%3B%0A%20%20%20%20this.domElement.style.touchAction%20%3D%20%22auto%22%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.disconnect%28%29%3B%0A%20%20%7D%0A%20%20handleResize%28%29%20%7B%0A%20%20%20%20const%20box%20%3D%20this.domElement.getBoundingClientRect%28%29%3B%0A%20%20%20%20const%20d%20%3D%20this.domElement.ownerDocument.documentElement%3B%0A%20%20%20%20this.screen.left%20%3D%20box.left%20%2B%20window.pageXOffset%20-%20d.clientLeft%3B%0A%20%20%20%20this.screen.top%20%3D%20box.top%20%2B%20window.pageYOffset%20-%20d.clientTop%3B%0A%20%20%20%20this.screen.width%20%3D%20box.width%3B%0A%20%20%20%20this.screen.height%20%3D%20box.height%3B%0A%20%20%7D%0A%20%20update%28%29%20%7B%0A%20%20%20%20this._eye.subVectors%28this.object.position%2C%20this.target%29%3B%0A%20%20%20%20if%20%28%21this.noRotate%29%20%7B%0A%20%20%20%20%20%20this._rotateCamera%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%21this.noZoom%29%20%7B%0A%20%20%20%20%20%20this._zoomCamera%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28%21this.noPan%29%20%7B%0A%20%20%20%20%20%20this._panCamera%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.object.position.addVectors%28this.target%2C%20this._eye%29%3B%0A%20%20%20%20if%20%28this.object.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20this._checkDistances%28%29%3B%0A%20%20%20%20%20%20this.object.lookAt%28this.target%29%3B%0A%20%20%20%20%20%20if%20%28this._lastPosition.distanceToSquared%28this.object.position%29%20%3E%20_EPS%29%20%7B%0A%20%20%20%20%20%20%20%20this.dispatchEvent%28_changeEvent%29%3B%0A%20%20%20%20%20%20%20%20this._lastPosition.copy%28this.object.position%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20this.object.lookAt%28this.target%29%3B%0A%20%20%20%20%20%20if%20%28this._lastPosition.distanceToSquared%28this.object.position%29%20%3E%20_EPS%20%7C%7C%20this._lastZoom%20%21%3D%3D%20this.object.zoom%29%20%7B%0A%20%20%20%20%20%20%20%20this.dispatchEvent%28_changeEvent%29%3B%0A%20%20%20%20%20%20%20%20this._lastPosition.copy%28this.object.position%29%3B%0A%20%20%20%20%20%20%20%20this._lastZoom%20%3D%20this.object.zoom%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22THREE.TrackballControls%3A%20Unsupported%20camera%20type.%22%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20reset%28%29%20%7B%0A%20%20%20%20this.state%20%3D%20_STATE.NONE%3B%0A%20%20%20%20this.keyState%20%3D%20_STATE.NONE%3B%0A%20%20%20%20this.target.copy%28this._target0%29%3B%0A%20%20%20%20this.object.position.copy%28this._position0%29%3B%0A%20%20%20%20this.object.up.copy%28this._up0%29%3B%0A%20%20%20%20this.object.zoom%20%3D%20this._zoom0%3B%0A%20%20%20%20this.object.updateProjectionMatrix%28%29%3B%0A%20%20%20%20this._eye.subVectors%28this.object.position%2C%20this.target%29%3B%0A%20%20%20%20this.object.lookAt%28this.target%29%3B%0A%20%20%20%20this.dispatchEvent%28_changeEvent%29%3B%0A%20%20%20%20this._lastPosition.copy%28this.object.position%29%3B%0A%20%20%20%20this._lastZoom%20%3D%20this.object.zoom%3B%0A%20%20%7D%0A%20%20_panCamera%28%29%20%7B%0A%20%20%20%20_mouseChange.copy%28this._panEnd%29.sub%28this._panStart%29%3B%0A%20%20%20%20if%20%28_mouseChange.lengthSq%28%29%29%20%7B%0A%20%20%20%20%20%20if%20%28this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20%20%20const%20scale_x%20%3D%20%28this.object.right%20-%20this.object.left%29%20%2F%20this.object.zoom%20%2F%20this.domElement.clientWidth%3B%0A%20%20%20%20%20%20%20%20const%20scale_y%20%3D%20%28this.object.top%20-%20this.object.bottom%29%20%2F%20this.object.zoom%20%2F%20this.domElement.clientWidth%3B%0A%20%20%20%20%20%20%20%20_mouseChange.x%20%2A%3D%20scale_x%3B%0A%20%20%20%20%20%20%20%20_mouseChange.y%20%2A%3D%20scale_y%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_mouseChange.multiplyScalar%28this._eye.length%28%29%20%2A%20this.panSpeed%29%3B%0A%20%20%20%20%20%20_pan.copy%28this._eye%29.cross%28this.object.up%29.setLength%28_mouseChange.x%29%3B%0A%20%20%20%20%20%20_pan.add%28_objectUp.copy%28this.object.up%29.setLength%28_mouseChange.y%29%29%3B%0A%20%20%20%20%20%20this.object.position.add%28_pan%29%3B%0A%20%20%20%20%20%20this.target.add%28_pan%29%3B%0A%20%20%20%20%20%20if%20%28this.staticMoving%29%20%7B%0A%20%20%20%20%20%20%20%20this._panStart.copy%28this._panEnd%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this._panStart.add%28_mouseChange.subVectors%28this._panEnd%2C%20this._panStart%29.multiplyScalar%28this.dynamicDampingFactor%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_rotateCamera%28%29%20%7B%0A%20%20%20%20_moveDirection.set%28this._moveCurr.x%20-%20this._movePrev.x%2C%20this._moveCurr.y%20-%20this._movePrev.y%2C%200%29%3B%0A%20%20%20%20let%20angle%20%3D%20_moveDirection.length%28%29%3B%0A%20%20%20%20if%20%28angle%29%20%7B%0A%20%20%20%20%20%20this._eye.copy%28this.object.position%29.sub%28this.target%29%3B%0A%20%20%20%20%20%20_eyeDirection.copy%28this._eye%29.normalize%28%29%3B%0A%20%20%20%20%20%20_objectUpDirection.copy%28this.object.up%29.normalize%28%29%3B%0A%20%20%20%20%20%20_objectSidewaysDirection.crossVectors%28_objectUpDirection%2C%20_eyeDirection%29.normalize%28%29%3B%0A%20%20%20%20%20%20_objectUpDirection.setLength%28this._moveCurr.y%20-%20this._movePrev.y%29%3B%0A%20%20%20%20%20%20_objectSidewaysDirection.setLength%28this._moveCurr.x%20-%20this._movePrev.x%29%3B%0A%20%20%20%20%20%20_moveDirection.copy%28_objectUpDirection.add%28_objectSidewaysDirection%29%29%3B%0A%20%20%20%20%20%20_axis.crossVectors%28_moveDirection%2C%20this._eye%29.normalize%28%29%3B%0A%20%20%20%20%20%20angle%20%2A%3D%20this.rotateSpeed%3B%0A%20%20%20%20%20%20_quaternion.setFromAxisAngle%28_axis%2C%20angle%29%3B%0A%20%20%20%20%20%20this._eye.applyQuaternion%28_quaternion%29%3B%0A%20%20%20%20%20%20this.object.up.applyQuaternion%28_quaternion%29%3B%0A%20%20%20%20%20%20this._lastAxis.copy%28_axis%29%3B%0A%20%20%20%20%20%20this._lastAngle%20%3D%20angle%3B%0A%20%20%20%20%7D%20else%20if%20%28%21this.staticMoving%20%26%26%20this._lastAngle%29%20%7B%0A%20%20%20%20%20%20this._lastAngle%20%2A%3D%20Math.sqrt%281%20-%20this.dynamicDampingFactor%29%3B%0A%20%20%20%20%20%20this._eye.copy%28this.object.position%29.sub%28this.target%29%3B%0A%20%20%20%20%20%20_quaternion.setFromAxisAngle%28this._lastAxis%2C%20this._lastAngle%29%3B%0A%20%20%20%20%20%20this._eye.applyQuaternion%28_quaternion%29%3B%0A%20%20%20%20%20%20this.object.up.applyQuaternion%28_quaternion%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._movePrev.copy%28this._moveCurr%29%3B%0A%20%20%7D%0A%20%20_zoomCamera%28%29%20%7B%0A%20%20%20%20let%20factor%3B%0A%20%20%20%20if%20%28this.state%20%3D%3D%3D%20_STATE.TOUCH_ZOOM_PAN%29%20%7B%0A%20%20%20%20%20%20factor%20%3D%20this._touchZoomDistanceStart%20%2F%20this._touchZoomDistanceEnd%3B%0A%20%20%20%20%20%20this._touchZoomDistanceStart%20%3D%20this._touchZoomDistanceEnd%3B%0A%20%20%20%20%20%20if%20%28this.object.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20%20%20this._eye.multiplyScalar%28factor%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20%20%20this.object.zoom%20%3D%20MathUtils.clamp%28this.object.zoom%20%2F%20factor%2C%20this.minZoom%2C%20this.maxZoom%29%3B%0A%20%20%20%20%20%20%20%20if%20%28this._lastZoom%20%21%3D%3D%20this.object.zoom%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.object.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22THREE.TrackballControls%3A%20Unsupported%20camera%20type%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20factor%20%3D%201%20%2B%20%28this._zoomEnd.y%20-%20this._zoomStart.y%29%20%2A%20this.zoomSpeed%3B%0A%20%20%20%20%20%20if%20%28factor%20%21%3D%3D%201%20%26%26%20factor%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.object.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._eye.multiplyScalar%28factor%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.object.zoom%20%3D%20MathUtils.clamp%28this.object.zoom%20%2F%20factor%2C%20this.minZoom%2C%20this.maxZoom%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28this._lastZoom%20%21%3D%3D%20this.object.zoom%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.object.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.warn%28%22THREE.TrackballControls%3A%20Unsupported%20camera%20type%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this.staticMoving%29%20%7B%0A%20%20%20%20%20%20%20%20this._zoomStart.copy%28this._zoomEnd%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this._zoomStart.y%20%2B%3D%20%28this._zoomEnd.y%20-%20this._zoomStart.y%29%20%2A%20this.dynamicDampingFactor%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_getMouseOnScreen%28pageX%2C%20pageY%29%20%7B%0A%20%20%20%20_v2.set%28%0A%20%20%20%20%20%20%28pageX%20-%20this.screen.left%29%20%2F%20this.screen.width%2C%0A%20%20%20%20%20%20%28pageY%20-%20this.screen.top%29%20%2F%20this.screen.height%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20_v2%3B%0A%20%20%7D%0A%20%20_getMouseOnCircle%28pageX%2C%20pageY%29%20%7B%0A%20%20%20%20_v2.set%28%0A%20%20%20%20%20%20%28pageX%20-%20this.screen.width%20%2A%200.5%20-%20this.screen.left%29%20%2F%20%28this.screen.width%20%2A%200.5%29%2C%0A%20%20%20%20%20%20%28this.screen.height%20%2B%202%20%2A%20%28this.screen.top%20-%20pageY%29%29%20%2F%20this.screen.width%0A%20%20%20%20%20%20%2F%2F%20screen.width%20intentional%0A%20%20%20%20%29%3B%0A%20%20%20%20return%20_v2%3B%0A%20%20%7D%0A%20%20_addPointer%28event%29%20%7B%0A%20%20%20%20this._pointers.push%28event%29%3B%0A%20%20%7D%0A%20%20_removePointer%28event%29%20%7B%0A%20%20%20%20delete%20this._pointerPositions%5Bevent.pointerId%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this._pointers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28this._pointers%5Bi%5D.pointerId%20%3D%3D%20event.pointerId%29%20%7B%0A%20%20%20%20%20%20%20%20this._pointers.splice%28i%2C%201%29%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_trackPointer%28event%29%20%7B%0A%20%20%20%20let%20position%20%3D%20this._pointerPositions%5Bevent.pointerId%5D%3B%0A%20%20%20%20if%20%28position%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20position%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20%20%20this._pointerPositions%5Bevent.pointerId%5D%20%3D%20position%3B%0A%20%20%20%20%7D%0A%20%20%20%20position.set%28event.pageX%2C%20event.pageY%29%3B%0A%20%20%7D%0A%20%20_getSecondPointerPosition%28event%29%20%7B%0A%20%20%20%20const%20pointer%20%3D%20event.pointerId%20%3D%3D%3D%20this._pointers%5B0%5D.pointerId%20%3F%20this._pointers%5B1%5D%20%3A%20this._pointers%5B0%5D%3B%0A%20%20%20%20return%20this._pointerPositions%5Bpointer.pointerId%5D%3B%0A%20%20%7D%0A%20%20_checkDistances%28%29%20%7B%0A%20%20%20%20if%20%28%21this.noZoom%20%7C%7C%20%21this.noPan%29%20%7B%0A%20%20%20%20%20%20if%20%28this._eye.lengthSq%28%29%20%3E%20this.maxDistance%20%2A%20this.maxDistance%29%20%7B%0A%20%20%20%20%20%20%20%20this.object.position.addVectors%28this.target%2C%20this._eye.setLength%28this.maxDistance%29%29%3B%0A%20%20%20%20%20%20%20%20this._zoomStart.copy%28this._zoomEnd%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this._eye.lengthSq%28%29%20%3C%20this.minDistance%20%2A%20this.minDistance%29%20%7B%0A%20%20%20%20%20%20%20%20this.object.position.addVectors%28this.target%2C%20this._eye.setLength%28this.minDistance%29%29%3B%0A%20%20%20%20%20%20%20%20this._zoomStart.copy%28this._zoomEnd%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Afunction%20onPointerDown2%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28this._pointers.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20this.domElement.setPointerCapture%28event.pointerId%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointerup%22%2C%20this._onPointerUp%29%3B%0A%20%20%7D%0A%20%20this._addPointer%28event%29%3B%0A%20%20if%20%28event.pointerType%20%3D%3D%3D%20%22touch%22%29%20%7B%0A%20%20%20%20this._onTouchStart%28event%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20this._onMouseDown%28event%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onPointerMove2%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28event.pointerType%20%3D%3D%3D%20%22touch%22%29%20%7B%0A%20%20%20%20this._onTouchMove%28event%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20this._onMouseMove%28event%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onPointerUp%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28event.pointerType%20%3D%3D%3D%20%22touch%22%29%20%7B%0A%20%20%20%20this._onTouchEnd%28event%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20this._onMouseUp%28%29%3B%0A%20%20%7D%0A%20%20this._removePointer%28event%29%3B%0A%20%20if%20%28this._pointers.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20this.domElement.releasePointerCapture%28event.pointerId%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerup%22%2C%20this._onPointerUp%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onPointerCancel2%28event%29%20%7B%0A%20%20this._removePointer%28event%29%3B%0A%7D%0Afunction%20onKeyUp%28%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20this.keyState%20%3D%20_STATE.NONE%3B%0A%20%20window.addEventListener%28%22keydown%22%2C%20this._onKeyDown%29%3B%0A%7D%0Afunction%20onKeyDown%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20window.removeEventListener%28%22keydown%22%2C%20this._onKeyDown%29%3B%0A%20%20if%20%28this.keyState%20%21%3D%3D%20_STATE.NONE%29%20%7B%0A%20%20%20%20return%3B%0A%20%20%7D%20else%20if%20%28event.code%20%3D%3D%3D%20this.keys%5B_STATE.ROTATE%5D%20%26%26%20%21this.noRotate%29%20%7B%0A%20%20%20%20this.keyState%20%3D%20_STATE.ROTATE%3B%0A%20%20%7D%20else%20if%20%28event.code%20%3D%3D%3D%20this.keys%5B_STATE.ZOOM%5D%20%26%26%20%21this.noZoom%29%20%7B%0A%20%20%20%20this.keyState%20%3D%20_STATE.ZOOM%3B%0A%20%20%7D%20else%20if%20%28event.code%20%3D%3D%3D%20this.keys%5B_STATE.PAN%5D%20%26%26%20%21this.noPan%29%20%7B%0A%20%20%20%20this.keyState%20%3D%20_STATE.PAN%3B%0A%20%20%7D%0A%7D%0Afunction%20onMouseDown%28event%29%20%7B%0A%20%20let%20mouseAction%3B%0A%20%20switch%20%28event.button%29%20%7B%0A%20%20%20%20case%200%3A%0A%20%20%20%20%20%20mouseAction%20%3D%20this.mouseButtons.LEFT%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%201%3A%0A%20%20%20%20%20%20mouseAction%20%3D%20this.mouseButtons.MIDDLE%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%202%3A%0A%20%20%20%20%20%20mouseAction%20%3D%20this.mouseButtons.RIGHT%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20mouseAction%20%3D%20-1%3B%0A%20%20%7D%0A%20%20switch%20%28mouseAction%29%20%7B%0A%20%20%20%20case%20MOUSE.DOLLY%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE.ZOOM%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20MOUSE.ROTATE%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE.ROTATE%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20MOUSE.PAN%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE.PAN%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE.NONE%3B%0A%20%20%7D%0A%20%20const%20state%20%3D%20this.keyState%20%21%3D%3D%20_STATE.NONE%20%3F%20this.keyState%20%3A%20this.state%3B%0A%20%20if%20%28state%20%3D%3D%3D%20_STATE.ROTATE%20%26%26%20%21this.noRotate%29%20%7B%0A%20%20%20%20this._moveCurr.copy%28this._getMouseOnCircle%28event.pageX%2C%20event.pageY%29%29%3B%0A%20%20%20%20this._movePrev.copy%28this._moveCurr%29%3B%0A%20%20%7D%20else%20if%20%28state%20%3D%3D%3D%20_STATE.ZOOM%20%26%26%20%21this.noZoom%29%20%7B%0A%20%20%20%20this._zoomStart.copy%28this._getMouseOnScreen%28event.pageX%2C%20event.pageY%29%29%3B%0A%20%20%20%20this._zoomEnd.copy%28this._zoomStart%29%3B%0A%20%20%7D%20else%20if%20%28state%20%3D%3D%3D%20_STATE.PAN%20%26%26%20%21this.noPan%29%20%7B%0A%20%20%20%20this._panStart.copy%28this._getMouseOnScreen%28event.pageX%2C%20event.pageY%29%29%3B%0A%20%20%20%20this._panEnd.copy%28this._panStart%29%3B%0A%20%20%7D%0A%20%20this.dispatchEvent%28_startEvent%29%3B%0A%7D%0Afunction%20onMouseMove%28event%29%20%7B%0A%20%20const%20state%20%3D%20this.keyState%20%21%3D%3D%20_STATE.NONE%20%3F%20this.keyState%20%3A%20this.state%3B%0A%20%20if%20%28state%20%3D%3D%3D%20_STATE.ROTATE%20%26%26%20%21this.noRotate%29%20%7B%0A%20%20%20%20this._movePrev.copy%28this._moveCurr%29%3B%0A%20%20%20%20this._moveCurr.copy%28this._getMouseOnCircle%28event.pageX%2C%20event.pageY%29%29%3B%0A%20%20%7D%20else%20if%20%28state%20%3D%3D%3D%20_STATE.ZOOM%20%26%26%20%21this.noZoom%29%20%7B%0A%20%20%20%20this._zoomEnd.copy%28this._getMouseOnScreen%28event.pageX%2C%20event.pageY%29%29%3B%0A%20%20%7D%20else%20if%20%28state%20%3D%3D%3D%20_STATE.PAN%20%26%26%20%21this.noPan%29%20%7B%0A%20%20%20%20this._panEnd.copy%28this._getMouseOnScreen%28event.pageX%2C%20event.pageY%29%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onMouseUp%28%29%20%7B%0A%20%20this.state%20%3D%20_STATE.NONE%3B%0A%20%20this.dispatchEvent%28_endEvent%29%3B%0A%7D%0Afunction%20onMouseWheel%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28this.noZoom%20%3D%3D%3D%20true%29%20return%3B%0A%20%20event.preventDefault%28%29%3B%0A%20%20switch%20%28event.deltaMode%29%20%7B%0A%20%20%20%20case%202%3A%0A%20%20%20%20%20%20this._zoomStart.y%20-%3D%20event.deltaY%20%2A%200.025%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%201%3A%0A%20%20%20%20%20%20this._zoomStart.y%20-%3D%20event.deltaY%20%2A%200.01%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20this._zoomStart.y%20-%3D%20event.deltaY%20%2A%2025e-5%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%20%20this.dispatchEvent%28_startEvent%29%3B%0A%20%20this.dispatchEvent%28_endEvent%29%3B%0A%7D%0Afunction%20onContextMenu2%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20event.preventDefault%28%29%3B%0A%7D%0Afunction%20onTouchStart%28event%29%20%7B%0A%20%20this._trackPointer%28event%29%3B%0A%20%20switch%20%28this._pointers.length%29%20%7B%0A%20%20%20%20case%201%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE.TOUCH_ROTATE%3B%0A%20%20%20%20%20%20this._moveCurr.copy%28this._getMouseOnCircle%28this._pointers%5B0%5D.pageX%2C%20this._pointers%5B0%5D.pageY%29%29%3B%0A%20%20%20%20%20%20this._movePrev.copy%28this._moveCurr%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE.TOUCH_ZOOM_PAN%3B%0A%20%20%20%20%20%20const%20dx%20%3D%20this._pointers%5B0%5D.pageX%20-%20this._pointers%5B1%5D.pageX%3B%0A%20%20%20%20%20%20const%20dy%20%3D%20this._pointers%5B0%5D.pageY%20-%20this._pointers%5B1%5D.pageY%3B%0A%20%20%20%20%20%20this._touchZoomDistanceEnd%20%3D%20this._touchZoomDistanceStart%20%3D%20Math.sqrt%28dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%29%3B%0A%20%20%20%20%20%20const%20x2%20%3D%20%28this._pointers%5B0%5D.pageX%20%2B%20this._pointers%5B1%5D.pageX%29%20%2F%202%3B%0A%20%20%20%20%20%20const%20y2%20%3D%20%28this._pointers%5B0%5D.pageY%20%2B%20this._pointers%5B1%5D.pageY%29%20%2F%202%3B%0A%20%20%20%20%20%20this._panStart.copy%28this._getMouseOnScreen%28x2%2C%20y2%29%29%3B%0A%20%20%20%20%20%20this._panEnd.copy%28this._panStart%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%20%20this.dispatchEvent%28_startEvent%29%3B%0A%7D%0Afunction%20onTouchMove%28event%29%20%7B%0A%20%20this._trackPointer%28event%29%3B%0A%20%20switch%20%28this._pointers.length%29%20%7B%0A%20%20%20%20case%201%3A%0A%20%20%20%20%20%20this._movePrev.copy%28this._moveCurr%29%3B%0A%20%20%20%20%20%20this._moveCurr.copy%28this._getMouseOnCircle%28event.pageX%2C%20event.pageY%29%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20const%20position%20%3D%20this._getSecondPointerPosition%28event%29%3B%0A%20%20%20%20%20%20const%20dx%20%3D%20event.pageX%20-%20position.x%3B%0A%20%20%20%20%20%20const%20dy%20%3D%20event.pageY%20-%20position.y%3B%0A%20%20%20%20%20%20this._touchZoomDistanceEnd%20%3D%20Math.sqrt%28dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%29%3B%0A%20%20%20%20%20%20const%20x2%20%3D%20%28event.pageX%20%2B%20position.x%29%20%2F%202%3B%0A%20%20%20%20%20%20const%20y2%20%3D%20%28event.pageY%20%2B%20position.y%29%20%2F%202%3B%0A%20%20%20%20%20%20this._panEnd.copy%28this._getMouseOnScreen%28x2%2C%20y2%29%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%7D%0Afunction%20onTouchEnd%28event%29%20%7B%0A%20%20switch%20%28this._pointers.length%29%20%7B%0A%20%20%20%20case%200%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE.NONE%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%201%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE.TOUCH_ROTATE%3B%0A%20%20%20%20%20%20this._moveCurr.copy%28this._getMouseOnCircle%28event.pageX%2C%20event.pageY%29%29%3B%0A%20%20%20%20%20%20this._movePrev.copy%28this._moveCurr%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%202%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE.TOUCH_ZOOM_PAN%3B%0A%20%20%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this._pointers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this._pointers%5Bi%5D.pointerId%20%21%3D%3D%20event.pointerId%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20position%20%3D%20this._pointerPositions%5Bthis._pointers%5Bi%5D.pointerId%5D%3B%0A%20%20%20%20%20%20%20%20%20%20this._moveCurr.copy%28this._getMouseOnCircle%28position.x%2C%20position.y%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._movePrev.copy%28this._moveCurr%29%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%20%20this.dispatchEvent%28_endEvent%29%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fcontrols%2FOrbitControls.js%0Avar%20_changeEvent2%20%3D%20%7B%20type%3A%20%22change%22%20%7D%3B%0Avar%20_startEvent2%20%3D%20%7B%20type%3A%20%22start%22%20%7D%3B%0Avar%20_endEvent2%20%3D%20%7B%20type%3A%20%22end%22%20%7D%3B%0Avar%20_ray%20%3D%20new%20Ray%28%29%3B%0Avar%20_plane3%20%3D%20new%20Plane%28%29%3B%0Avar%20_TILT_LIMIT%20%3D%20Math.cos%2870%20%2A%20MathUtils.DEG2RAD%29%3B%0Avar%20_v%20%3D%20new%20Vector3%28%29%3B%0Avar%20_twoPI%20%3D%202%20%2A%20Math.PI%3B%0Avar%20_STATE2%20%3D%20%7B%0A%20%20NONE%3A%20-1%2C%0A%20%20ROTATE%3A%200%2C%0A%20%20DOLLY%3A%201%2C%0A%20%20PAN%3A%202%2C%0A%20%20TOUCH_ROTATE%3A%203%2C%0A%20%20TOUCH_PAN%3A%204%2C%0A%20%20TOUCH_DOLLY_PAN%3A%205%2C%0A%20%20TOUCH_DOLLY_ROTATE%3A%206%0A%7D%3B%0Avar%20_EPS2%20%3D%201e-6%3B%0Avar%20OrbitControls%20%3D%20class%20extends%20Controls%20%7B%0A%20%20constructor%28object%2C%20domElement%20%3D%20null%29%20%7B%0A%20%20%20%20super%28object%2C%20domElement%29%3B%0A%20%20%20%20this.state%20%3D%20_STATE2.NONE%3B%0A%20%20%20%20this.enabled%20%3D%20true%3B%0A%20%20%20%20this.target%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this.cursor%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this.minDistance%20%3D%200%3B%0A%20%20%20%20this.maxDistance%20%3D%20Infinity%3B%0A%20%20%20%20this.minZoom%20%3D%200%3B%0A%20%20%20%20this.maxZoom%20%3D%20Infinity%3B%0A%20%20%20%20this.minTargetRadius%20%3D%200%3B%0A%20%20%20%20this.maxTargetRadius%20%3D%20Infinity%3B%0A%20%20%20%20this.minPolarAngle%20%3D%200%3B%0A%20%20%20%20this.maxPolarAngle%20%3D%20Math.PI%3B%0A%20%20%20%20this.minAzimuthAngle%20%3D%20-Infinity%3B%0A%20%20%20%20this.maxAzimuthAngle%20%3D%20Infinity%3B%0A%20%20%20%20this.enableDamping%20%3D%20false%3B%0A%20%20%20%20this.dampingFactor%20%3D%200.05%3B%0A%20%20%20%20this.enableZoom%20%3D%20true%3B%0A%20%20%20%20this.zoomSpeed%20%3D%201%3B%0A%20%20%20%20this.enableRotate%20%3D%20true%3B%0A%20%20%20%20this.rotateSpeed%20%3D%201%3B%0A%20%20%20%20this.enablePan%20%3D%20true%3B%0A%20%20%20%20this.panSpeed%20%3D%201%3B%0A%20%20%20%20this.screenSpacePanning%20%3D%20true%3B%0A%20%20%20%20this.keyPanSpeed%20%3D%207%3B%0A%20%20%20%20this.zoomToCursor%20%3D%20false%3B%0A%20%20%20%20this.autoRotate%20%3D%20false%3B%0A%20%20%20%20this.autoRotateSpeed%20%3D%202%3B%0A%20%20%20%20this.keys%20%3D%20%7B%20LEFT%3A%20%22ArrowLeft%22%2C%20UP%3A%20%22ArrowUp%22%2C%20RIGHT%3A%20%22ArrowRight%22%2C%20BOTTOM%3A%20%22ArrowDown%22%20%7D%3B%0A%20%20%20%20this.mouseButtons%20%3D%20%7B%20LEFT%3A%20MOUSE.ROTATE%2C%20MIDDLE%3A%20MOUSE.DOLLY%2C%20RIGHT%3A%20MOUSE.PAN%20%7D%3B%0A%20%20%20%20this.touches%20%3D%20%7B%20ONE%3A%20TOUCH.ROTATE%2C%20TWO%3A%20TOUCH.DOLLY_PAN%20%7D%3B%0A%20%20%20%20this.target0%20%3D%20this.target.clone%28%29%3B%0A%20%20%20%20this.position0%20%3D%20this.object.position.clone%28%29%3B%0A%20%20%20%20this.zoom0%20%3D%20this.object.zoom%3B%0A%20%20%20%20this._domElementKeyEvents%20%3D%20null%3B%0A%20%20%20%20this._lastPosition%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this._lastQuaternion%20%3D%20new%20Quaternion%28%29%3B%0A%20%20%20%20this._lastTargetPosition%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this._quat%20%3D%20new%20Quaternion%28%29.setFromUnitVectors%28object.up%2C%20new%20Vector3%280%2C%201%2C%200%29%29%3B%0A%20%20%20%20this._quatInverse%20%3D%20this._quat.clone%28%29.invert%28%29%3B%0A%20%20%20%20this._spherical%20%3D%20new%20Spherical%28%29%3B%0A%20%20%20%20this._sphericalDelta%20%3D%20new%20Spherical%28%29%3B%0A%20%20%20%20this._scale%20%3D%201%3B%0A%20%20%20%20this._panOffset%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this._rotateStart%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._rotateEnd%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._rotateDelta%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._panStart%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._panEnd%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._panDelta%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._dollyStart%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._dollyEnd%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._dollyDelta%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._dollyDirection%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this._mouse%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20this._performCursorZoom%20%3D%20false%3B%0A%20%20%20%20this._pointers%20%3D%20%5B%5D%3B%0A%20%20%20%20this._pointerPositions%20%3D%20%7B%7D%3B%0A%20%20%20%20this._controlActive%20%3D%20false%3B%0A%20%20%20%20this._onPointerMove%20%3D%20onPointerMove3.bind%28this%29%3B%0A%20%20%20%20this._onPointerDown%20%3D%20onPointerDown3.bind%28this%29%3B%0A%20%20%20%20this._onPointerUp%20%3D%20onPointerUp2.bind%28this%29%3B%0A%20%20%20%20this._onContextMenu%20%3D%20onContextMenu3.bind%28this%29%3B%0A%20%20%20%20this._onMouseWheel%20%3D%20onMouseWheel2.bind%28this%29%3B%0A%20%20%20%20this._onKeyDown%20%3D%20onKeyDown2.bind%28this%29%3B%0A%20%20%20%20this._onTouchStart%20%3D%20onTouchStart2.bind%28this%29%3B%0A%20%20%20%20this._onTouchMove%20%3D%20onTouchMove2.bind%28this%29%3B%0A%20%20%20%20this._onMouseDown%20%3D%20onMouseDown2.bind%28this%29%3B%0A%20%20%20%20this._onMouseMove%20%3D%20onMouseMove2.bind%28this%29%3B%0A%20%20%20%20this._interceptControlDown%20%3D%20interceptControlDown.bind%28this%29%3B%0A%20%20%20%20this._interceptControlUp%20%3D%20interceptControlUp.bind%28this%29%3B%0A%20%20%20%20if%20%28this.domElement%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.connect%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.update%28%29%3B%0A%20%20%7D%0A%20%20connect%28%29%20%7B%0A%20%20%20%20this.domElement.addEventListener%28%22pointerdown%22%2C%20this._onPointerDown%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointercancel%22%2C%20this._onPointerUp%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22contextmenu%22%2C%20this._onContextMenu%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22wheel%22%2C%20this._onMouseWheel%2C%20%7B%20passive%3A%20false%20%7D%29%3B%0A%20%20%20%20const%20document2%20%3D%20this.domElement.getRootNode%28%29%3B%0A%20%20%20%20document2.addEventListener%28%22keydown%22%2C%20this._interceptControlDown%2C%20%7B%20passive%3A%20true%2C%20capture%3A%20true%20%7D%29%3B%0A%20%20%20%20this.domElement.style.touchAction%20%3D%20%22none%22%3B%0A%20%20%7D%0A%20%20disconnect%28%29%20%7B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerdown%22%2C%20this._onPointerDown%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerup%22%2C%20this._onPointerUp%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointercancel%22%2C%20this._onPointerUp%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22wheel%22%2C%20this._onMouseWheel%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22contextmenu%22%2C%20this._onContextMenu%29%3B%0A%20%20%20%20this.stopListenToKeyEvents%28%29%3B%0A%20%20%20%20const%20document2%20%3D%20this.domElement.getRootNode%28%29%3B%0A%20%20%20%20document2.removeEventListener%28%22keydown%22%2C%20this._interceptControlDown%2C%20%7B%20capture%3A%20true%20%7D%29%3B%0A%20%20%20%20this.domElement.style.touchAction%20%3D%20%22auto%22%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.disconnect%28%29%3B%0A%20%20%7D%0A%20%20getPolarAngle%28%29%20%7B%0A%20%20%20%20return%20this._spherical.phi%3B%0A%20%20%7D%0A%20%20getAzimuthalAngle%28%29%20%7B%0A%20%20%20%20return%20this._spherical.theta%3B%0A%20%20%7D%0A%20%20getDistance%28%29%20%7B%0A%20%20%20%20return%20this.object.position.distanceTo%28this.target%29%3B%0A%20%20%7D%0A%20%20listenToKeyEvents%28domElement%29%20%7B%0A%20%20%20%20domElement.addEventListener%28%22keydown%22%2C%20this._onKeyDown%29%3B%0A%20%20%20%20this._domElementKeyEvents%20%3D%20domElement%3B%0A%20%20%7D%0A%20%20stopListenToKeyEvents%28%29%20%7B%0A%20%20%20%20if%20%28this._domElementKeyEvents%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this._domElementKeyEvents.removeEventListener%28%22keydown%22%2C%20this._onKeyDown%29%3B%0A%20%20%20%20%20%20this._domElementKeyEvents%20%3D%20null%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20saveState%28%29%20%7B%0A%20%20%20%20this.target0.copy%28this.target%29%3B%0A%20%20%20%20this.position0.copy%28this.object.position%29%3B%0A%20%20%20%20this.zoom0%20%3D%20this.object.zoom%3B%0A%20%20%7D%0A%20%20reset%28%29%20%7B%0A%20%20%20%20this.target.copy%28this.target0%29%3B%0A%20%20%20%20this.object.position.copy%28this.position0%29%3B%0A%20%20%20%20this.object.zoom%20%3D%20this.zoom0%3B%0A%20%20%20%20this.object.updateProjectionMatrix%28%29%3B%0A%20%20%20%20this.dispatchEvent%28_changeEvent2%29%3B%0A%20%20%20%20this.update%28%29%3B%0A%20%20%20%20this.state%20%3D%20_STATE2.NONE%3B%0A%20%20%7D%0A%20%20update%28deltaTime%20%3D%20null%29%20%7B%0A%20%20%20%20const%20position%20%3D%20this.object.position%3B%0A%20%20%20%20_v.copy%28position%29.sub%28this.target%29%3B%0A%20%20%20%20_v.applyQuaternion%28this._quat%29%3B%0A%20%20%20%20this._spherical.setFromVector3%28_v%29%3B%0A%20%20%20%20if%20%28this.autoRotate%20%26%26%20this.state%20%3D%3D%3D%20_STATE2.NONE%29%20%7B%0A%20%20%20%20%20%20this._rotateLeft%28this._getAutoRotationAngle%28deltaTime%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.enableDamping%29%20%7B%0A%20%20%20%20%20%20this._spherical.theta%20%2B%3D%20this._sphericalDelta.theta%20%2A%20this.dampingFactor%3B%0A%20%20%20%20%20%20this._spherical.phi%20%2B%3D%20this._sphericalDelta.phi%20%2A%20this.dampingFactor%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._spherical.theta%20%2B%3D%20this._sphericalDelta.theta%3B%0A%20%20%20%20%20%20this._spherical.phi%20%2B%3D%20this._sphericalDelta.phi%3B%0A%20%20%20%20%7D%0A%20%20%20%20let%20min2%20%3D%20this.minAzimuthAngle%3B%0A%20%20%20%20let%20max2%20%3D%20this.maxAzimuthAngle%3B%0A%20%20%20%20if%20%28isFinite%28min2%29%20%26%26%20isFinite%28max2%29%29%20%7B%0A%20%20%20%20%20%20if%20%28min2%20%3C%20-Math.PI%29%20min2%20%2B%3D%20_twoPI%3B%0A%20%20%20%20%20%20else%20if%20%28min2%20%3E%20Math.PI%29%20min2%20-%3D%20_twoPI%3B%0A%20%20%20%20%20%20if%20%28max2%20%3C%20-Math.PI%29%20max2%20%2B%3D%20_twoPI%3B%0A%20%20%20%20%20%20else%20if%20%28max2%20%3E%20Math.PI%29%20max2%20-%3D%20_twoPI%3B%0A%20%20%20%20%20%20if%20%28min2%20%3C%3D%20max2%29%20%7B%0A%20%20%20%20%20%20%20%20this._spherical.theta%20%3D%20Math.max%28min2%2C%20Math.min%28max2%2C%20this._spherical.theta%29%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this._spherical.theta%20%3D%20this._spherical.theta%20%3E%20%28min2%20%2B%20max2%29%20%2F%202%20%3F%20Math.max%28min2%2C%20this._spherical.theta%29%20%3A%20Math.min%28max2%2C%20this._spherical.theta%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this._spherical.phi%20%3D%20Math.max%28this.minPolarAngle%2C%20Math.min%28this.maxPolarAngle%2C%20this._spherical.phi%29%29%3B%0A%20%20%20%20this._spherical.makeSafe%28%29%3B%0A%20%20%20%20if%20%28this.enableDamping%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this.target.addScaledVector%28this._panOffset%2C%20this.dampingFactor%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this.target.add%28this._panOffset%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.target.sub%28this.cursor%29%3B%0A%20%20%20%20this.target.clampLength%28this.minTargetRadius%2C%20this.maxTargetRadius%29%3B%0A%20%20%20%20this.target.add%28this.cursor%29%3B%0A%20%20%20%20let%20zoomChanged%20%3D%20false%3B%0A%20%20%20%20if%20%28this.zoomToCursor%20%26%26%20this._performCursorZoom%20%7C%7C%20this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20this._spherical.radius%20%3D%20this._clampDistance%28this._spherical.radius%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20prevRadius%20%3D%20this._spherical.radius%3B%0A%20%20%20%20%20%20this._spherical.radius%20%3D%20this._clampDistance%28this._spherical.radius%20%2A%20this._scale%29%3B%0A%20%20%20%20%20%20zoomChanged%20%3D%20prevRadius%20%21%3D%20this._spherical.radius%3B%0A%20%20%20%20%7D%0A%20%20%20%20_v.setFromSpherical%28this._spherical%29%3B%0A%20%20%20%20_v.applyQuaternion%28this._quatInverse%29%3B%0A%20%20%20%20position.copy%28this.target%29.add%28_v%29%3B%0A%20%20%20%20this.object.lookAt%28this.target%29%3B%0A%20%20%20%20if%20%28this.enableDamping%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20this._sphericalDelta.theta%20%2A%3D%201%20-%20this.dampingFactor%3B%0A%20%20%20%20%20%20this._sphericalDelta.phi%20%2A%3D%201%20-%20this.dampingFactor%3B%0A%20%20%20%20%20%20this._panOffset.multiplyScalar%281%20-%20this.dampingFactor%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._sphericalDelta.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20this._panOffset.set%280%2C%200%2C%200%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.zoomToCursor%20%26%26%20this._performCursorZoom%29%20%7B%0A%20%20%20%20%20%20let%20newRadius%20%3D%20null%3B%0A%20%20%20%20%20%20if%20%28this.object.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20%20%20const%20prevRadius%20%3D%20_v.length%28%29%3B%0A%20%20%20%20%20%20%20%20newRadius%20%3D%20this._clampDistance%28prevRadius%20%2A%20this._scale%29%3B%0A%20%20%20%20%20%20%20%20const%20radiusDelta%20%3D%20prevRadius%20-%20newRadius%3B%0A%20%20%20%20%20%20%20%20this.object.position.addScaledVector%28this._dollyDirection%2C%20radiusDelta%29%3B%0A%20%20%20%20%20%20%20%20this.object.updateMatrixWorld%28%29%3B%0A%20%20%20%20%20%20%20%20zoomChanged%20%3D%20%21%21radiusDelta%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20%20%20const%20mouseBefore%20%3D%20new%20Vector3%28this._mouse.x%2C%20this._mouse.y%2C%200%29%3B%0A%20%20%20%20%20%20%20%20mouseBefore.unproject%28this.object%29%3B%0A%20%20%20%20%20%20%20%20const%20prevZoom%20%3D%20this.object.zoom%3B%0A%20%20%20%20%20%20%20%20this.object.zoom%20%3D%20Math.max%28this.minZoom%2C%20Math.min%28this.maxZoom%2C%20this.object.zoom%20%2F%20this._scale%29%29%3B%0A%20%20%20%20%20%20%20%20this.object.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%20%20%20%20zoomChanged%20%3D%20prevZoom%20%21%3D%3D%20this.object.zoom%3B%0A%20%20%20%20%20%20%20%20const%20mouseAfter%20%3D%20new%20Vector3%28this._mouse.x%2C%20this._mouse.y%2C%200%29%3B%0A%20%20%20%20%20%20%20%20mouseAfter.unproject%28this.object%29%3B%0A%20%20%20%20%20%20%20%20this.object.position.sub%28mouseAfter%29.add%28mouseBefore%29%3B%0A%20%20%20%20%20%20%20%20this.object.updateMatrixWorld%28%29%3B%0A%20%20%20%20%20%20%20%20newRadius%20%3D%20_v.length%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22WARNING%3A%20OrbitControls.js%20encountered%20an%20unknown%20camera%20type%20-%20zoom%20to%20cursor%20disabled.%22%29%3B%0A%20%20%20%20%20%20%20%20this.zoomToCursor%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28newRadius%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.screenSpacePanning%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.target.set%280%2C%200%2C%20-1%29.transformDirection%28this.object.matrix%29.multiplyScalar%28newRadius%29.add%28this.object.position%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20_ray.origin.copy%28this.object.position%29%3B%0A%20%20%20%20%20%20%20%20%20%20_ray.direction.set%280%2C%200%2C%20-1%29.transformDirection%28this.object.matrix%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28Math.abs%28this.object.up.dot%28_ray.direction%29%29%20%3C%20_TILT_LIMIT%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this.object.lookAt%28this.target%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_plane3.setFromNormalAndCoplanarPoint%28this.object.up%2C%20this.target%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_ray.intersectPlane%28_plane3%2C%20this.target%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20const%20prevZoom%20%3D%20this.object.zoom%3B%0A%20%20%20%20%20%20this.object.zoom%20%3D%20Math.max%28this.minZoom%2C%20Math.min%28this.maxZoom%2C%20this.object.zoom%20%2F%20this._scale%29%29%3B%0A%20%20%20%20%20%20if%20%28prevZoom%20%21%3D%3D%20this.object.zoom%29%20%7B%0A%20%20%20%20%20%20%20%20this.object.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%20%20%20%20zoomChanged%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this._scale%20%3D%201%3B%0A%20%20%20%20this._performCursorZoom%20%3D%20false%3B%0A%20%20%20%20if%20%28zoomChanged%20%7C%7C%20this._lastPosition.distanceToSquared%28this.object.position%29%20%3E%20_EPS2%20%7C%7C%208%20%2A%20%281%20-%20this._lastQuaternion.dot%28this.object.quaternion%29%29%20%3E%20_EPS2%20%7C%7C%20this._lastTargetPosition.distanceToSquared%28this.target%29%20%3E%20_EPS2%29%20%7B%0A%20%20%20%20%20%20this.dispatchEvent%28_changeEvent2%29%3B%0A%20%20%20%20%20%20this._lastPosition.copy%28this.object.position%29%3B%0A%20%20%20%20%20%20this._lastQuaternion.copy%28this.object.quaternion%29%3B%0A%20%20%20%20%20%20this._lastTargetPosition.copy%28this.target%29%3B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20_getAutoRotationAngle%28deltaTime%29%20%7B%0A%20%20%20%20if%20%28deltaTime%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20return%20_twoPI%20%2F%2060%20%2A%20this.autoRotateSpeed%20%2A%20deltaTime%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20_twoPI%20%2F%2060%20%2F%2060%20%2A%20this.autoRotateSpeed%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_getZoomScale%28delta%29%20%7B%0A%20%20%20%20const%20normalizedDelta%20%3D%20Math.abs%28delta%20%2A%200.01%29%3B%0A%20%20%20%20return%20Math.pow%280.95%2C%20this.zoomSpeed%20%2A%20normalizedDelta%29%3B%0A%20%20%7D%0A%20%20_rotateLeft%28angle%29%20%7B%0A%20%20%20%20this._sphericalDelta.theta%20-%3D%20angle%3B%0A%20%20%7D%0A%20%20_rotateUp%28angle%29%20%7B%0A%20%20%20%20this._sphericalDelta.phi%20-%3D%20angle%3B%0A%20%20%7D%0A%20%20_panLeft%28distance2%2C%20objectMatrix%29%20%7B%0A%20%20%20%20_v.setFromMatrixColumn%28objectMatrix%2C%200%29%3B%0A%20%20%20%20_v.multiplyScalar%28-distance2%29%3B%0A%20%20%20%20this._panOffset.add%28_v%29%3B%0A%20%20%7D%0A%20%20_panUp%28distance2%2C%20objectMatrix%29%20%7B%0A%20%20%20%20if%20%28this.screenSpacePanning%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20_v.setFromMatrixColumn%28objectMatrix%2C%201%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20_v.setFromMatrixColumn%28objectMatrix%2C%200%29%3B%0A%20%20%20%20%20%20_v.crossVectors%28this.object.up%2C%20_v%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20_v.multiplyScalar%28distance2%29%3B%0A%20%20%20%20this._panOffset.add%28_v%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20deltaX%20and%20deltaY%20are%20in%20pixels%3B%20right%20and%20down%20are%20positive%0A%20%20_pan%28deltaX%2C%20deltaY%29%20%7B%0A%20%20%20%20const%20element2%20%3D%20this.domElement%3B%0A%20%20%20%20if%20%28this.object.isPerspectiveCamera%29%20%7B%0A%20%20%20%20%20%20const%20position%20%3D%20this.object.position%3B%0A%20%20%20%20%20%20_v.copy%28position%29.sub%28this.target%29%3B%0A%20%20%20%20%20%20let%20targetDistance%20%3D%20_v.length%28%29%3B%0A%20%20%20%20%20%20targetDistance%20%2A%3D%20Math.tan%28this.object.fov%20%2F%202%20%2A%20Math.PI%20%2F%20180%29%3B%0A%20%20%20%20%20%20this._panLeft%282%20%2A%20deltaX%20%2A%20targetDistance%20%2F%20element2.clientHeight%2C%20this.object.matrix%29%3B%0A%20%20%20%20%20%20this._panUp%282%20%2A%20deltaY%20%2A%20targetDistance%20%2F%20element2.clientHeight%2C%20this.object.matrix%29%3B%0A%20%20%20%20%7D%20else%20if%20%28this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20this._panLeft%28deltaX%20%2A%20%28this.object.right%20-%20this.object.left%29%20%2F%20this.object.zoom%20%2F%20element2.clientWidth%2C%20this.object.matrix%29%3B%0A%20%20%20%20%20%20this._panUp%28deltaY%20%2A%20%28this.object.top%20-%20this.object.bottom%29%20%2F%20this.object.zoom%20%2F%20element2.clientHeight%2C%20this.object.matrix%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22WARNING%3A%20OrbitControls.js%20encountered%20an%20unknown%20camera%20type%20-%20pan%20disabled.%22%29%3B%0A%20%20%20%20%20%20this.enablePan%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_dollyOut%28dollyScale%29%20%7B%0A%20%20%20%20if%20%28this.object.isPerspectiveCamera%20%7C%7C%20this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20this._scale%20%2F%3D%20dollyScale%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22WARNING%3A%20OrbitControls.js%20encountered%20an%20unknown%20camera%20type%20-%20dolly%2Fzoom%20disabled.%22%29%3B%0A%20%20%20%20%20%20this.enableZoom%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_dollyIn%28dollyScale%29%20%7B%0A%20%20%20%20if%20%28this.object.isPerspectiveCamera%20%7C%7C%20this.object.isOrthographicCamera%29%20%7B%0A%20%20%20%20%20%20this._scale%20%2A%3D%20dollyScale%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20console.warn%28%22WARNING%3A%20OrbitControls.js%20encountered%20an%20unknown%20camera%20type%20-%20dolly%2Fzoom%20disabled.%22%29%3B%0A%20%20%20%20%20%20this.enableZoom%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_updateZoomParameters%28x2%2C%20y2%29%20%7B%0A%20%20%20%20if%20%28%21this.zoomToCursor%29%20%7B%0A%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._performCursorZoom%20%3D%20true%3B%0A%20%20%20%20const%20rect%20%3D%20this.domElement.getBoundingClientRect%28%29%3B%0A%20%20%20%20const%20dx%20%3D%20x2%20-%20rect.left%3B%0A%20%20%20%20const%20dy%20%3D%20y2%20-%20rect.top%3B%0A%20%20%20%20const%20w%20%3D%20rect.width%3B%0A%20%20%20%20const%20h%20%3D%20rect.height%3B%0A%20%20%20%20this._mouse.x%20%3D%20dx%20%2F%20w%20%2A%202%20-%201%3B%0A%20%20%20%20this._mouse.y%20%3D%20-%28dy%20%2F%20h%29%20%2A%202%20%2B%201%3B%0A%20%20%20%20this._dollyDirection.set%28this._mouse.x%2C%20this._mouse.y%2C%201%29.unproject%28this.object%29.sub%28this.object.position%29.normalize%28%29%3B%0A%20%20%7D%0A%20%20_clampDistance%28dist%29%20%7B%0A%20%20%20%20return%20Math.max%28this.minDistance%2C%20Math.min%28this.maxDistance%2C%20dist%29%29%3B%0A%20%20%7D%0A%20%20%2F%2F%0A%20%20%2F%2F%20event%20callbacks%20-%20update%20the%20object%20state%0A%20%20%2F%2F%0A%20%20_handleMouseDownRotate%28event%29%20%7B%0A%20%20%20%20this._rotateStart.set%28event.clientX%2C%20event.clientY%29%3B%0A%20%20%7D%0A%20%20_handleMouseDownDolly%28event%29%20%7B%0A%20%20%20%20this._updateZoomParameters%28event.clientX%2C%20event.clientX%29%3B%0A%20%20%20%20this._dollyStart.set%28event.clientX%2C%20event.clientY%29%3B%0A%20%20%7D%0A%20%20_handleMouseDownPan%28event%29%20%7B%0A%20%20%20%20this._panStart.set%28event.clientX%2C%20event.clientY%29%3B%0A%20%20%7D%0A%20%20_handleMouseMoveRotate%28event%29%20%7B%0A%20%20%20%20this._rotateEnd.set%28event.clientX%2C%20event.clientY%29%3B%0A%20%20%20%20this._rotateDelta.subVectors%28this._rotateEnd%2C%20this._rotateStart%29.multiplyScalar%28this.rotateSpeed%29%3B%0A%20%20%20%20const%20element2%20%3D%20this.domElement%3B%0A%20%20%20%20this._rotateLeft%28_twoPI%20%2A%20this._rotateDelta.x%20%2F%20element2.clientHeight%29%3B%0A%20%20%20%20this._rotateUp%28_twoPI%20%2A%20this._rotateDelta.y%20%2F%20element2.clientHeight%29%3B%0A%20%20%20%20this._rotateStart.copy%28this._rotateEnd%29%3B%0A%20%20%20%20this.update%28%29%3B%0A%20%20%7D%0A%20%20_handleMouseMoveDolly%28event%29%20%7B%0A%20%20%20%20this._dollyEnd.set%28event.clientX%2C%20event.clientY%29%3B%0A%20%20%20%20this._dollyDelta.subVectors%28this._dollyEnd%2C%20this._dollyStart%29%3B%0A%20%20%20%20if%20%28this._dollyDelta.y%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this._dollyOut%28this._getZoomScale%28this._dollyDelta.y%29%29%3B%0A%20%20%20%20%7D%20else%20if%20%28this._dollyDelta.y%20%3C%200%29%20%7B%0A%20%20%20%20%20%20this._dollyIn%28this._getZoomScale%28this._dollyDelta.y%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._dollyStart.copy%28this._dollyEnd%29%3B%0A%20%20%20%20this.update%28%29%3B%0A%20%20%7D%0A%20%20_handleMouseMovePan%28event%29%20%7B%0A%20%20%20%20this._panEnd.set%28event.clientX%2C%20event.clientY%29%3B%0A%20%20%20%20this._panDelta.subVectors%28this._panEnd%2C%20this._panStart%29.multiplyScalar%28this.panSpeed%29%3B%0A%20%20%20%20this._pan%28this._panDelta.x%2C%20this._panDelta.y%29%3B%0A%20%20%20%20this._panStart.copy%28this._panEnd%29%3B%0A%20%20%20%20this.update%28%29%3B%0A%20%20%7D%0A%20%20_handleMouseWheel%28event%29%20%7B%0A%20%20%20%20this._updateZoomParameters%28event.clientX%2C%20event.clientY%29%3B%0A%20%20%20%20if%20%28event.deltaY%20%3C%200%29%20%7B%0A%20%20%20%20%20%20this._dollyIn%28this._getZoomScale%28event.deltaY%29%29%3B%0A%20%20%20%20%7D%20else%20if%20%28event.deltaY%20%3E%200%29%20%7B%0A%20%20%20%20%20%20this._dollyOut%28this._getZoomScale%28event.deltaY%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.update%28%29%3B%0A%20%20%7D%0A%20%20_handleKeyDown%28event%29%20%7B%0A%20%20%20%20let%20needsUpdate%20%3D%20false%3B%0A%20%20%20%20switch%20%28event.code%29%20%7B%0A%20%20%20%20%20%20case%20this.keys.UP%3A%0A%20%20%20%20%20%20%20%20if%20%28event.ctrlKey%20%7C%7C%20event.metaKey%20%7C%7C%20event.shiftKey%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._rotateUp%28_twoPI%20%2A%20this.rotateSpeed%20%2F%20this.domElement.clientHeight%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._pan%280%2C%20this.keyPanSpeed%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20this.keys.BOTTOM%3A%0A%20%20%20%20%20%20%20%20if%20%28event.ctrlKey%20%7C%7C%20event.metaKey%20%7C%7C%20event.shiftKey%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._rotateUp%28-_twoPI%20%2A%20this.rotateSpeed%20%2F%20this.domElement.clientHeight%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._pan%280%2C%20-this.keyPanSpeed%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20this.keys.LEFT%3A%0A%20%20%20%20%20%20%20%20if%20%28event.ctrlKey%20%7C%7C%20event.metaKey%20%7C%7C%20event.shiftKey%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._rotateLeft%28_twoPI%20%2A%20this.rotateSpeed%20%2F%20this.domElement.clientHeight%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._pan%28this.keyPanSpeed%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%20this.keys.RIGHT%3A%0A%20%20%20%20%20%20%20%20if%20%28event.ctrlKey%20%7C%7C%20event.metaKey%20%7C%7C%20event.shiftKey%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._rotateLeft%28-_twoPI%20%2A%20this.rotateSpeed%20%2F%20this.domElement.clientHeight%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._pan%28-this.keyPanSpeed%2C%200%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20needsUpdate%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28needsUpdate%29%20%7B%0A%20%20%20%20%20%20event.preventDefault%28%29%3B%0A%20%20%20%20%20%20this.update%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_handleTouchStartRotate%28event%29%20%7B%0A%20%20%20%20if%20%28this._pointers.length%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20this._rotateStart.set%28event.pageX%2C%20event.pageY%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20position%20%3D%20this._getSecondPointerPosition%28event%29%3B%0A%20%20%20%20%20%20const%20x2%20%3D%200.5%20%2A%20%28event.pageX%20%2B%20position.x%29%3B%0A%20%20%20%20%20%20const%20y2%20%3D%200.5%20%2A%20%28event.pageY%20%2B%20position.y%29%3B%0A%20%20%20%20%20%20this._rotateStart.set%28x2%2C%20y2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_handleTouchStartPan%28event%29%20%7B%0A%20%20%20%20if%20%28this._pointers.length%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20this._panStart.set%28event.pageX%2C%20event.pageY%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20position%20%3D%20this._getSecondPointerPosition%28event%29%3B%0A%20%20%20%20%20%20const%20x2%20%3D%200.5%20%2A%20%28event.pageX%20%2B%20position.x%29%3B%0A%20%20%20%20%20%20const%20y2%20%3D%200.5%20%2A%20%28event.pageY%20%2B%20position.y%29%3B%0A%20%20%20%20%20%20this._panStart.set%28x2%2C%20y2%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_handleTouchStartDolly%28event%29%20%7B%0A%20%20%20%20const%20position%20%3D%20this._getSecondPointerPosition%28event%29%3B%0A%20%20%20%20const%20dx%20%3D%20event.pageX%20-%20position.x%3B%0A%20%20%20%20const%20dy%20%3D%20event.pageY%20-%20position.y%3B%0A%20%20%20%20const%20distance2%20%3D%20Math.sqrt%28dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%29%3B%0A%20%20%20%20this._dollyStart.set%280%2C%20distance2%29%3B%0A%20%20%7D%0A%20%20_handleTouchStartDollyPan%28event%29%20%7B%0A%20%20%20%20if%20%28this.enableZoom%29%20this._handleTouchStartDolly%28event%29%3B%0A%20%20%20%20if%20%28this.enablePan%29%20this._handleTouchStartPan%28event%29%3B%0A%20%20%7D%0A%20%20_handleTouchStartDollyRotate%28event%29%20%7B%0A%20%20%20%20if%20%28this.enableZoom%29%20this._handleTouchStartDolly%28event%29%3B%0A%20%20%20%20if%20%28this.enableRotate%29%20this._handleTouchStartRotate%28event%29%3B%0A%20%20%7D%0A%20%20_handleTouchMoveRotate%28event%29%20%7B%0A%20%20%20%20if%20%28this._pointers.length%20%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20this._rotateEnd.set%28event.pageX%2C%20event.pageY%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20position%20%3D%20this._getSecondPointerPosition%28event%29%3B%0A%20%20%20%20%20%20const%20x2%20%3D%200.5%20%2A%20%28event.pageX%20%2B%20position.x%29%3B%0A%20%20%20%20%20%20const%20y2%20%3D%200.5%20%2A%20%28event.pageY%20%2B%20position.y%29%3B%0A%20%20%20%20%20%20this._rotateEnd.set%28x2%2C%20y2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._rotateDelta.subVectors%28this._rotateEnd%2C%20this._rotateStart%29.multiplyScalar%28this.rotateSpeed%29%3B%0A%20%20%20%20const%20element2%20%3D%20this.domElement%3B%0A%20%20%20%20this._rotateLeft%28_twoPI%20%2A%20this._rotateDelta.x%20%2F%20element2.clientHeight%29%3B%0A%20%20%20%20this._rotateUp%28_twoPI%20%2A%20this._rotateDelta.y%20%2F%20element2.clientHeight%29%3B%0A%20%20%20%20this._rotateStart.copy%28this._rotateEnd%29%3B%0A%20%20%7D%0A%20%20_handleTouchMovePan%28event%29%20%7B%0A%20%20%20%20if%20%28this._pointers.length%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20this._panEnd.set%28event.pageX%2C%20event.pageY%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20const%20position%20%3D%20this._getSecondPointerPosition%28event%29%3B%0A%20%20%20%20%20%20const%20x2%20%3D%200.5%20%2A%20%28event.pageX%20%2B%20position.x%29%3B%0A%20%20%20%20%20%20const%20y2%20%3D%200.5%20%2A%20%28event.pageY%20%2B%20position.y%29%3B%0A%20%20%20%20%20%20this._panEnd.set%28x2%2C%20y2%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._panDelta.subVectors%28this._panEnd%2C%20this._panStart%29.multiplyScalar%28this.panSpeed%29%3B%0A%20%20%20%20this._pan%28this._panDelta.x%2C%20this._panDelta.y%29%3B%0A%20%20%20%20this._panStart.copy%28this._panEnd%29%3B%0A%20%20%7D%0A%20%20_handleTouchMoveDolly%28event%29%20%7B%0A%20%20%20%20const%20position%20%3D%20this._getSecondPointerPosition%28event%29%3B%0A%20%20%20%20const%20dx%20%3D%20event.pageX%20-%20position.x%3B%0A%20%20%20%20const%20dy%20%3D%20event.pageY%20-%20position.y%3B%0A%20%20%20%20const%20distance2%20%3D%20Math.sqrt%28dx%20%2A%20dx%20%2B%20dy%20%2A%20dy%29%3B%0A%20%20%20%20this._dollyEnd.set%280%2C%20distance2%29%3B%0A%20%20%20%20this._dollyDelta.set%280%2C%20Math.pow%28this._dollyEnd.y%20%2F%20this._dollyStart.y%2C%20this.zoomSpeed%29%29%3B%0A%20%20%20%20this._dollyOut%28this._dollyDelta.y%29%3B%0A%20%20%20%20this._dollyStart.copy%28this._dollyEnd%29%3B%0A%20%20%20%20const%20centerX%20%3D%20%28event.pageX%20%2B%20position.x%29%20%2A%200.5%3B%0A%20%20%20%20const%20centerY%20%3D%20%28event.pageY%20%2B%20position.y%29%20%2A%200.5%3B%0A%20%20%20%20this._updateZoomParameters%28centerX%2C%20centerY%29%3B%0A%20%20%7D%0A%20%20_handleTouchMoveDollyPan%28event%29%20%7B%0A%20%20%20%20if%20%28this.enableZoom%29%20this._handleTouchMoveDolly%28event%29%3B%0A%20%20%20%20if%20%28this.enablePan%29%20this._handleTouchMovePan%28event%29%3B%0A%20%20%7D%0A%20%20_handleTouchMoveDollyRotate%28event%29%20%7B%0A%20%20%20%20if%20%28this.enableZoom%29%20this._handleTouchMoveDolly%28event%29%3B%0A%20%20%20%20if%20%28this.enableRotate%29%20this._handleTouchMoveRotate%28event%29%3B%0A%20%20%7D%0A%20%20%2F%2F%20pointers%0A%20%20_addPointer%28event%29%20%7B%0A%20%20%20%20this._pointers.push%28event.pointerId%29%3B%0A%20%20%7D%0A%20%20_removePointer%28event%29%20%7B%0A%20%20%20%20delete%20this._pointerPositions%5Bevent.pointerId%5D%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this._pointers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28this._pointers%5Bi%5D%20%3D%3D%20event.pointerId%29%20%7B%0A%20%20%20%20%20%20%20%20this._pointers.splice%28i%2C%201%29%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20_isTrackingPointer%28event%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this._pointers.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28this._pointers%5Bi%5D%20%3D%3D%20event.pointerId%29%20return%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20false%3B%0A%20%20%7D%0A%20%20_trackPointer%28event%29%20%7B%0A%20%20%20%20let%20position%20%3D%20this._pointerPositions%5Bevent.pointerId%5D%3B%0A%20%20%20%20if%20%28position%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20position%20%3D%20new%20Vector2%28%29%3B%0A%20%20%20%20%20%20this._pointerPositions%5Bevent.pointerId%5D%20%3D%20position%3B%0A%20%20%20%20%7D%0A%20%20%20%20position.set%28event.pageX%2C%20event.pageY%29%3B%0A%20%20%7D%0A%20%20_getSecondPointerPosition%28event%29%20%7B%0A%20%20%20%20const%20pointerId%20%3D%20event.pointerId%20%3D%3D%3D%20this._pointers%5B0%5D%20%3F%20this._pointers%5B1%5D%20%3A%20this._pointers%5B0%5D%3B%0A%20%20%20%20return%20this._pointerPositions%5BpointerId%5D%3B%0A%20%20%7D%0A%20%20%2F%2F%0A%20%20_customWheelEvent%28event%29%20%7B%0A%20%20%20%20const%20mode%20%3D%20event.deltaMode%3B%0A%20%20%20%20const%20newEvent%20%3D%20%7B%0A%20%20%20%20%20%20clientX%3A%20event.clientX%2C%0A%20%20%20%20%20%20clientY%3A%20event.clientY%2C%0A%20%20%20%20%20%20deltaY%3A%20event.deltaY%0A%20%20%20%20%7D%3B%0A%20%20%20%20switch%20%28mode%29%20%7B%0A%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20newEvent.deltaY%20%2A%3D%2016%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20newEvent.deltaY%20%2A%3D%20100%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28event.ctrlKey%20%26%26%20%21this._controlActive%29%20%7B%0A%20%20%20%20%20%20newEvent.deltaY%20%2A%3D%2010%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20newEvent%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20onPointerDown3%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28this._pointers.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20this.domElement.setPointerCapture%28event.pointerId%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointerup%22%2C%20this._onPointerUp%29%3B%0A%20%20%7D%0A%20%20if%20%28this._isTrackingPointer%28event%29%29%20return%3B%0A%20%20this._addPointer%28event%29%3B%0A%20%20if%20%28event.pointerType%20%3D%3D%3D%20%22touch%22%29%20%7B%0A%20%20%20%20this._onTouchStart%28event%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20this._onMouseDown%28event%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onPointerMove3%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28event.pointerType%20%3D%3D%3D%20%22touch%22%29%20%7B%0A%20%20%20%20this._onTouchMove%28event%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20this._onMouseMove%28event%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onPointerUp2%28event%29%20%7B%0A%20%20this._removePointer%28event%29%3B%0A%20%20switch%20%28this._pointers.length%29%20%7B%0A%20%20%20%20case%200%3A%0A%20%20%20%20%20%20this.domElement.releasePointerCapture%28event.pointerId%29%3B%0A%20%20%20%20%20%20this.domElement.removeEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20%20%20this.domElement.removeEventListener%28%22pointerup%22%2C%20this._onPointerUp%29%3B%0A%20%20%20%20%20%20this.dispatchEvent%28_endEvent2%29%3B%0A%20%20%20%20%20%20this.state%20%3D%20_STATE2.NONE%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%201%3A%0A%20%20%20%20%20%20const%20pointerId%20%3D%20this._pointers%5B0%5D%3B%0A%20%20%20%20%20%20const%20position%20%3D%20this._pointerPositions%5BpointerId%5D%3B%0A%20%20%20%20%20%20this._onTouchStart%28%7B%20pointerId%2C%20pageX%3A%20position.x%2C%20pageY%3A%20position.y%20%7D%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%7D%0Afunction%20onMouseDown2%28event%29%20%7B%0A%20%20let%20mouseAction%3B%0A%20%20switch%20%28event.button%29%20%7B%0A%20%20%20%20case%200%3A%0A%20%20%20%20%20%20mouseAction%20%3D%20this.mouseButtons.LEFT%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%201%3A%0A%20%20%20%20%20%20mouseAction%20%3D%20this.mouseButtons.MIDDLE%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%202%3A%0A%20%20%20%20%20%20mouseAction%20%3D%20this.mouseButtons.RIGHT%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20mouseAction%20%3D%20-1%3B%0A%20%20%7D%0A%20%20switch%20%28mouseAction%29%20%7B%0A%20%20%20%20case%20MOUSE.DOLLY%3A%0A%20%20%20%20%20%20if%20%28this.enableZoom%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20this._handleMouseDownDolly%28event%29%3B%0A%20%20%20%20%20%20this.state%20%3D%20_STATE2.DOLLY%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20MOUSE.ROTATE%3A%0A%20%20%20%20%20%20if%20%28event.ctrlKey%20%7C%7C%20event.metaKey%20%7C%7C%20event.shiftKey%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.enablePan%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20%20%20this._handleMouseDownPan%28event%29%3B%0A%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.PAN%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.enableRotate%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20%20%20this._handleMouseDownRotate%28event%29%3B%0A%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.ROTATE%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20MOUSE.PAN%3A%0A%20%20%20%20%20%20if%20%28event.ctrlKey%20%7C%7C%20event.metaKey%20%7C%7C%20event.shiftKey%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.enableRotate%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20%20%20this._handleMouseDownRotate%28event%29%3B%0A%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.ROTATE%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this.enablePan%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20%20%20this._handleMouseDownPan%28event%29%3B%0A%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.PAN%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE2.NONE%3B%0A%20%20%7D%0A%20%20if%20%28this.state%20%21%3D%3D%20_STATE2.NONE%29%20%7B%0A%20%20%20%20this.dispatchEvent%28_startEvent2%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onMouseMove2%28event%29%20%7B%0A%20%20switch%20%28this.state%29%20%7B%0A%20%20%20%20case%20_STATE2.ROTATE%3A%0A%20%20%20%20%20%20if%20%28this.enableRotate%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20this._handleMouseMoveRotate%28event%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20_STATE2.DOLLY%3A%0A%20%20%20%20%20%20if%20%28this.enableZoom%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20this._handleMouseMoveDolly%28event%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20_STATE2.PAN%3A%0A%20%20%20%20%20%20if%20%28this.enablePan%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20this._handleMouseMovePan%28event%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%7D%0Afunction%20onMouseWheel2%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%20%7C%7C%20this.enableZoom%20%3D%3D%3D%20false%20%7C%7C%20this.state%20%21%3D%3D%20_STATE2.NONE%29%20return%3B%0A%20%20event.preventDefault%28%29%3B%0A%20%20this.dispatchEvent%28_startEvent2%29%3B%0A%20%20this._handleMouseWheel%28this._customWheelEvent%28event%29%29%3B%0A%20%20this.dispatchEvent%28_endEvent2%29%3B%0A%7D%0Afunction%20onKeyDown2%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%20%7C%7C%20this.enablePan%20%3D%3D%3D%20false%29%20return%3B%0A%20%20this._handleKeyDown%28event%29%3B%0A%7D%0Afunction%20onTouchStart2%28event%29%20%7B%0A%20%20this._trackPointer%28event%29%3B%0A%20%20switch%20%28this._pointers.length%29%20%7B%0A%20%20%20%20case%201%3A%0A%20%20%20%20%20%20switch%20%28this.touches.ONE%29%20%7B%0A%20%20%20%20%20%20%20%20case%20TOUCH.ROTATE%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.enableRotate%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20this._handleTouchStartRotate%28event%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.TOUCH_ROTATE%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20TOUCH.PAN%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.enablePan%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20this._handleTouchStartPan%28event%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.TOUCH_PAN%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.NONE%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%202%3A%0A%20%20%20%20%20%20switch%20%28this.touches.TWO%29%20%7B%0A%20%20%20%20%20%20%20%20case%20TOUCH.DOLLY_PAN%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.enableZoom%20%3D%3D%3D%20false%20%26%26%20this.enablePan%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20this._handleTouchStartDollyPan%28event%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.TOUCH_DOLLY_PAN%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20TOUCH.DOLLY_ROTATE%3A%0A%20%20%20%20%20%20%20%20%20%20if%20%28this.enableZoom%20%3D%3D%3D%20false%20%26%26%20this.enableRotate%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20%20%20%20%20this._handleTouchStartDollyRotate%28event%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.TOUCH_DOLLY_ROTATE%3B%0A%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20this.state%20%3D%20_STATE2.NONE%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE2.NONE%3B%0A%20%20%7D%0A%20%20if%20%28this.state%20%21%3D%3D%20_STATE2.NONE%29%20%7B%0A%20%20%20%20this.dispatchEvent%28_startEvent2%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onTouchMove2%28event%29%20%7B%0A%20%20this._trackPointer%28event%29%3B%0A%20%20switch%20%28this.state%29%20%7B%0A%20%20%20%20case%20_STATE2.TOUCH_ROTATE%3A%0A%20%20%20%20%20%20if%20%28this.enableRotate%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20this._handleTouchMoveRotate%28event%29%3B%0A%20%20%20%20%20%20this.update%28%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20_STATE2.TOUCH_PAN%3A%0A%20%20%20%20%20%20if%20%28this.enablePan%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20this._handleTouchMovePan%28event%29%3B%0A%20%20%20%20%20%20this.update%28%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20_STATE2.TOUCH_DOLLY_PAN%3A%0A%20%20%20%20%20%20if%20%28this.enableZoom%20%3D%3D%3D%20false%20%26%26%20this.enablePan%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20this._handleTouchMoveDollyPan%28event%29%3B%0A%20%20%20%20%20%20this.update%28%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20_STATE2.TOUCH_DOLLY_ROTATE%3A%0A%20%20%20%20%20%20if%20%28this.enableZoom%20%3D%3D%3D%20false%20%26%26%20this.enableRotate%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20%20%20this._handleTouchMoveDollyRotate%28event%29%3B%0A%20%20%20%20%20%20this.update%28%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20this.state%20%3D%20_STATE2.NONE%3B%0A%20%20%7D%0A%7D%0Afunction%20onContextMenu3%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20event.preventDefault%28%29%3B%0A%7D%0Afunction%20interceptControlDown%28event%29%20%7B%0A%20%20if%20%28event.key%20%3D%3D%3D%20%22Control%22%29%20%7B%0A%20%20%20%20this._controlActive%20%3D%20true%3B%0A%20%20%20%20const%20document2%20%3D%20this.domElement.getRootNode%28%29%3B%0A%20%20%20%20document2.addEventListener%28%22keyup%22%2C%20this._interceptControlUp%2C%20%7B%20passive%3A%20true%2C%20capture%3A%20true%20%7D%29%3B%0A%20%20%7D%0A%7D%0Afunction%20interceptControlUp%28event%29%20%7B%0A%20%20if%20%28event.key%20%3D%3D%3D%20%22Control%22%29%20%7B%0A%20%20%20%20this._controlActive%20%3D%20false%3B%0A%20%20%20%20const%20document2%20%3D%20this.domElement.getRootNode%28%29%3B%0A%20%20%20%20document2.removeEventListener%28%22keyup%22%2C%20this._interceptControlUp%2C%20%7B%20passive%3A%20true%2C%20capture%3A%20true%20%7D%29%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fcontrols%2FFlyControls.js%0Avar%20_changeEvent3%20%3D%20%7B%20type%3A%20%22change%22%20%7D%3B%0Avar%20_EPS3%20%3D%201e-6%3B%0Avar%20_tmpQuaternion%20%3D%20new%20Quaternion%28%29%3B%0Avar%20FlyControls%20%3D%20class%20extends%20Controls%20%7B%0A%20%20constructor%28object%2C%20domElement%20%3D%20null%29%20%7B%0A%20%20%20%20super%28object%2C%20domElement%29%3B%0A%20%20%20%20this.movementSpeed%20%3D%201%3B%0A%20%20%20%20this.rollSpeed%20%3D%205e-3%3B%0A%20%20%20%20this.dragToLook%20%3D%20false%3B%0A%20%20%20%20this.autoForward%20%3D%20false%3B%0A%20%20%20%20this._moveState%20%3D%20%7B%20up%3A%200%2C%20down%3A%200%2C%20left%3A%200%2C%20right%3A%200%2C%20forward%3A%200%2C%20back%3A%200%2C%20pitchUp%3A%200%2C%20pitchDown%3A%200%2C%20yawLeft%3A%200%2C%20yawRight%3A%200%2C%20rollLeft%3A%200%2C%20rollRight%3A%200%20%7D%3B%0A%20%20%20%20this._moveVector%20%3D%20new%20Vector3%280%2C%200%2C%200%29%3B%0A%20%20%20%20this._rotationVector%20%3D%20new%20Vector3%280%2C%200%2C%200%29%3B%0A%20%20%20%20this._lastQuaternion%20%3D%20new%20Quaternion%28%29%3B%0A%20%20%20%20this._lastPosition%20%3D%20new%20Vector3%28%29%3B%0A%20%20%20%20this._status%20%3D%200%3B%0A%20%20%20%20this._onKeyDown%20%3D%20onKeyDown3.bind%28this%29%3B%0A%20%20%20%20this._onKeyUp%20%3D%20onKeyUp2.bind%28this%29%3B%0A%20%20%20%20this._onPointerMove%20%3D%20onPointerMove4.bind%28this%29%3B%0A%20%20%20%20this._onPointerDown%20%3D%20onPointerDown4.bind%28this%29%3B%0A%20%20%20%20this._onPointerUp%20%3D%20onPointerUp3.bind%28this%29%3B%0A%20%20%20%20this._onPointerCancel%20%3D%20onPointerCancel3.bind%28this%29%3B%0A%20%20%20%20this._onContextMenu%20%3D%20onContextMenu4.bind%28this%29%3B%0A%20%20%20%20if%20%28domElement%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.connect%28%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20connect%28%29%20%7B%0A%20%20%20%20window.addEventListener%28%22keydown%22%2C%20this._onKeyDown%29%3B%0A%20%20%20%20window.addEventListener%28%22keyup%22%2C%20this._onKeyUp%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointerdown%22%2C%20this._onPointerDown%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointerup%22%2C%20this._onPointerUp%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22pointercancel%22%2C%20this._onPointerCancel%29%3B%0A%20%20%20%20this.domElement.addEventListener%28%22contextmenu%22%2C%20this._onContextMenu%29%3B%0A%20%20%7D%0A%20%20disconnect%28%29%20%7B%0A%20%20%20%20window.removeEventListener%28%22keydown%22%2C%20this._onKeyDown%29%3B%0A%20%20%20%20window.removeEventListener%28%22keyup%22%2C%20this._onKeyUp%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointermove%22%2C%20this._onPointerMove%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerdown%22%2C%20this._onPointerDown%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointerup%22%2C%20this._onPointerUp%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22pointercancel%22%2C%20this._onPointerCancel%29%3B%0A%20%20%20%20this.domElement.removeEventListener%28%22contextmenu%22%2C%20this._onContextMenu%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.disconnect%28%29%3B%0A%20%20%7D%0A%20%20update%28delta%29%20%7B%0A%20%20%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20%20%20const%20object%20%3D%20this.object%3B%0A%20%20%20%20const%20moveMult%20%3D%20delta%20%2A%20this.movementSpeed%3B%0A%20%20%20%20const%20rotMult%20%3D%20delta%20%2A%20this.rollSpeed%3B%0A%20%20%20%20object.translateX%28this._moveVector.x%20%2A%20moveMult%29%3B%0A%20%20%20%20object.translateY%28this._moveVector.y%20%2A%20moveMult%29%3B%0A%20%20%20%20object.translateZ%28this._moveVector.z%20%2A%20moveMult%29%3B%0A%20%20%20%20_tmpQuaternion.set%28this._rotationVector.x%20%2A%20rotMult%2C%20this._rotationVector.y%20%2A%20rotMult%2C%20this._rotationVector.z%20%2A%20rotMult%2C%201%29.normalize%28%29%3B%0A%20%20%20%20object.quaternion.multiply%28_tmpQuaternion%29%3B%0A%20%20%20%20if%20%28this._lastPosition.distanceToSquared%28object.position%29%20%3E%20_EPS3%20%7C%7C%208%20%2A%20%281%20-%20this._lastQuaternion.dot%28object.quaternion%29%29%20%3E%20_EPS3%29%20%7B%0A%20%20%20%20%20%20this.dispatchEvent%28_changeEvent3%29%3B%0A%20%20%20%20%20%20this._lastQuaternion.copy%28object.quaternion%29%3B%0A%20%20%20%20%20%20this._lastPosition.copy%28object.position%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%2F%2F%20private%0A%20%20_updateMovementVector%28%29%20%7B%0A%20%20%20%20const%20forward%20%3D%20this._moveState.forward%20%7C%7C%20this.autoForward%20%26%26%20%21this._moveState.back%20%3F%201%20%3A%200%3B%0A%20%20%20%20this._moveVector.x%20%3D%20-this._moveState.left%20%2B%20this._moveState.right%3B%0A%20%20%20%20this._moveVector.y%20%3D%20-this._moveState.down%20%2B%20this._moveState.up%3B%0A%20%20%20%20this._moveVector.z%20%3D%20-forward%20%2B%20this._moveState.back%3B%0A%20%20%7D%0A%20%20_updateRotationVector%28%29%20%7B%0A%20%20%20%20this._rotationVector.x%20%3D%20-this._moveState.pitchDown%20%2B%20this._moveState.pitchUp%3B%0A%20%20%20%20this._rotationVector.y%20%3D%20-this._moveState.yawRight%20%2B%20this._moveState.yawLeft%3B%0A%20%20%20%20this._rotationVector.z%20%3D%20-this._moveState.rollRight%20%2B%20this._moveState.rollLeft%3B%0A%20%20%7D%0A%20%20_getContainerDimensions%28%29%20%7B%0A%20%20%20%20if%20%28this.domElement%20%21%3D%20document%29%20%7B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20size%3A%20%5Bthis.domElement.offsetWidth%2C%20this.domElement.offsetHeight%5D%2C%0A%20%20%20%20%20%20%20%20offset%3A%20%5Bthis.domElement.offsetLeft%2C%20this.domElement.offsetTop%5D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20size%3A%20%5Bwindow.innerWidth%2C%20window.innerHeight%5D%2C%0A%20%20%20%20%20%20%20%20offset%3A%20%5B0%2C%200%5D%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Afunction%20onKeyDown3%28event%29%20%7B%0A%20%20if%20%28event.altKey%20%7C%7C%20this.enabled%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%20%20switch%20%28event.code%29%20%7B%0A%20%20%20%20case%20%22ShiftLeft%22%3A%0A%20%20%20%20case%20%22ShiftRight%22%3A%0A%20%20%20%20%20%20this.movementSpeedMultiplier%20%3D%200.1%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyW%22%3A%0A%20%20%20%20%20%20this._moveState.forward%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyS%22%3A%0A%20%20%20%20%20%20this._moveState.back%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyA%22%3A%0A%20%20%20%20%20%20this._moveState.left%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyD%22%3A%0A%20%20%20%20%20%20this._moveState.right%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyR%22%3A%0A%20%20%20%20%20%20this._moveState.up%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyF%22%3A%0A%20%20%20%20%20%20this._moveState.down%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ArrowUp%22%3A%0A%20%20%20%20%20%20this._moveState.pitchUp%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ArrowDown%22%3A%0A%20%20%20%20%20%20this._moveState.pitchDown%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ArrowLeft%22%3A%0A%20%20%20%20%20%20this._moveState.yawLeft%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ArrowRight%22%3A%0A%20%20%20%20%20%20this._moveState.yawRight%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyQ%22%3A%0A%20%20%20%20%20%20this._moveState.rollLeft%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyE%22%3A%0A%20%20%20%20%20%20this._moveState.rollRight%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%20%20this._updateMovementVector%28%29%3B%0A%20%20this._updateRotationVector%28%29%3B%0A%7D%0Afunction%20onKeyUp2%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20switch%20%28event.code%29%20%7B%0A%20%20%20%20case%20%22ShiftLeft%22%3A%0A%20%20%20%20case%20%22ShiftRight%22%3A%0A%20%20%20%20%20%20this.movementSpeedMultiplier%20%3D%201%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyW%22%3A%0A%20%20%20%20%20%20this._moveState.forward%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyS%22%3A%0A%20%20%20%20%20%20this._moveState.back%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyA%22%3A%0A%20%20%20%20%20%20this._moveState.left%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyD%22%3A%0A%20%20%20%20%20%20this._moveState.right%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyR%22%3A%0A%20%20%20%20%20%20this._moveState.up%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyF%22%3A%0A%20%20%20%20%20%20this._moveState.down%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ArrowUp%22%3A%0A%20%20%20%20%20%20this._moveState.pitchUp%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ArrowDown%22%3A%0A%20%20%20%20%20%20this._moveState.pitchDown%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ArrowLeft%22%3A%0A%20%20%20%20%20%20this._moveState.yawLeft%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22ArrowRight%22%3A%0A%20%20%20%20%20%20this._moveState.yawRight%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyQ%22%3A%0A%20%20%20%20%20%20this._moveState.rollLeft%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20%22KeyE%22%3A%0A%20%20%20%20%20%20this._moveState.rollRight%20%3D%200%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%20%20this._updateMovementVector%28%29%3B%0A%20%20this._updateRotationVector%28%29%3B%0A%7D%0Afunction%20onPointerDown4%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28this.dragToLook%29%20%7B%0A%20%20%20%20this._status%2B%2B%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20switch%20%28event.button%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20this._moveState.forward%20%3D%201%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20this._moveState.back%20%3D%201%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._updateMovementVector%28%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onPointerMove4%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28%21this.dragToLook%20%7C%7C%20this._status%20%3E%200%29%20%7B%0A%20%20%20%20const%20container%20%3D%20this._getContainerDimensions%28%29%3B%0A%20%20%20%20const%20halfWidth%20%3D%20container.size%5B0%5D%20%2F%202%3B%0A%20%20%20%20const%20halfHeight%20%3D%20container.size%5B1%5D%20%2F%202%3B%0A%20%20%20%20this._moveState.yawLeft%20%3D%20-%28event.pageX%20-%20container.offset%5B0%5D%20-%20halfWidth%29%20%2F%20halfWidth%3B%0A%20%20%20%20this._moveState.pitchDown%20%3D%20%28event.pageY%20-%20container.offset%5B1%5D%20-%20halfHeight%29%20%2F%20halfHeight%3B%0A%20%20%20%20this._updateRotationVector%28%29%3B%0A%20%20%7D%0A%7D%0Afunction%20onPointerUp3%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28this.dragToLook%29%20%7B%0A%20%20%20%20this._status--%3B%0A%20%20%20%20this._moveState.yawLeft%20%3D%20this._moveState.pitchDown%20%3D%200%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20switch%20%28event.button%29%20%7B%0A%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20this._moveState.forward%20%3D%200%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20this._moveState.back%20%3D%200%3B%0A%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%20%20%20%20this._updateMovementVector%28%29%3B%0A%20%20%7D%0A%20%20this._updateRotationVector%28%29%3B%0A%7D%0Afunction%20onPointerCancel3%28%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20if%20%28this.dragToLook%29%20%7B%0A%20%20%20%20this._status%20%3D%200%3B%0A%20%20%20%20this._moveState.yawLeft%20%3D%20this._moveState.pitchDown%20%3D%200%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20this._moveState.forward%20%3D%200%3B%0A%20%20%20%20this._moveState.back%20%3D%200%3B%0A%20%20%20%20this._updateMovementVector%28%29%3B%0A%20%20%7D%0A%20%20this._updateRotationVector%28%29%3B%0A%7D%0Afunction%20onContextMenu4%28event%29%20%7B%0A%20%20if%20%28this.enabled%20%3D%3D%3D%20false%29%20return%3B%0A%20%20event.preventDefault%28%29%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fshaders%2FCopyShader.js%0Avar%20CopyShader%20%3D%20%7B%0A%20%20name%3A%20%22CopyShader%22%2C%0A%20%20uniforms%3A%20%7B%0A%20%20%20%20%22tDiffuse%22%3A%20%7B%20value%3A%20null%20%7D%2C%0A%20%20%20%20%22opacity%22%3A%20%7B%20value%3A%201%20%7D%0A%20%20%7D%2C%0A%20%20vertexShader%3A%20%28%0A%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%60%0A%0A%09%09varying%20vec2%20vUv%3B%0A%0A%09%09void%20main%28%29%20%7B%0A%0A%09%09%09vUv%20%3D%20uv%3B%0A%09%09%09gl_Position%20%3D%20projectionMatrix%20%2A%20modelViewMatrix%20%2A%20vec4%28%20position%2C%201.0%20%29%3B%0A%0A%09%09%7D%60%0A%20%20%29%2C%0A%20%20fragmentShader%3A%20%28%0A%20%20%20%20%2F%2A%20glsl%20%2A%2F%0A%20%20%20%20%60%0A%0A%09%09uniform%20float%20opacity%3B%0A%0A%09%09uniform%20sampler2D%20tDiffuse%3B%0A%0A%09%09varying%20vec2%20vUv%3B%0A%0A%09%09void%20main%28%29%20%7B%0A%0A%09%09%09vec4%20texel%20%3D%20texture2D%28%20tDiffuse%2C%20vUv%20%29%3B%0A%09%09%09gl_FragColor%20%3D%20opacity%20%2A%20texel%3B%0A%0A%0A%09%09%7D%60%0A%20%20%29%0A%7D%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fpostprocessing%2FPass.js%0Avar%20Pass%20%3D%20class%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20this.isPass%20%3D%20true%3B%0A%20%20%20%20this.enabled%20%3D%20true%3B%0A%20%20%20%20this.needsSwap%20%3D%20true%3B%0A%20%20%20%20this.clear%20%3D%20false%3B%0A%20%20%20%20this.renderToScreen%20%3D%20false%3B%0A%20%20%7D%0A%20%20setSize%28%29%20%7B%0A%20%20%7D%0A%20%20render%28%29%20%7B%0A%20%20%20%20console.error%28%22THREE.Pass%3A%20.render%28%29%20must%20be%20implemented%20in%20derived%20pass.%22%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%7D%0A%7D%3B%0Avar%20_camera2%20%3D%20new%20OrthographicCamera%28-1%2C%201%2C%201%2C%20-1%2C%200%2C%201%29%3B%0Avar%20FullscreenTriangleGeometry%20%3D%20class%20extends%20BufferGeometry%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.setAttribute%28%22position%22%2C%20new%20Float32BufferAttribute%28%5B-1%2C%203%2C%200%2C%20-1%2C%20-1%2C%200%2C%203%2C%20-1%2C%200%5D%2C%203%29%29%3B%0A%20%20%20%20this.setAttribute%28%22uv%22%2C%20new%20Float32BufferAttribute%28%5B0%2C%202%2C%200%2C%200%2C%202%2C%200%5D%2C%202%29%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20_geometry2%20%3D%20new%20FullscreenTriangleGeometry%28%29%3B%0Avar%20FullScreenQuad%20%3D%20class%20%7B%0A%20%20constructor%28material%29%20%7B%0A%20%20%20%20this._mesh%20%3D%20new%20Mesh%28_geometry2%2C%20material%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this._mesh.geometry.dispose%28%29%3B%0A%20%20%7D%0A%20%20render%28renderer3%29%20%7B%0A%20%20%20%20renderer3.render%28this._mesh%2C%20_camera2%29%3B%0A%20%20%7D%0A%20%20get%20material%28%29%20%7B%0A%20%20%20%20return%20this._mesh.material%3B%0A%20%20%7D%0A%20%20set%20material%28value%29%20%7B%0A%20%20%20%20this._mesh.material%20%3D%20value%3B%0A%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fpostprocessing%2FShaderPass.js%0Avar%20ShaderPass%20%3D%20class%20extends%20Pass%20%7B%0A%20%20constructor%28shader%2C%20textureID%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.textureID%20%3D%20textureID%20%21%3D%3D%20void%200%20%3F%20textureID%20%3A%20%22tDiffuse%22%3B%0A%20%20%20%20if%20%28shader%20instanceof%20ShaderMaterial%29%20%7B%0A%20%20%20%20%20%20this.uniforms%20%3D%20shader.uniforms%3B%0A%20%20%20%20%20%20this.material%20%3D%20shader%3B%0A%20%20%20%20%7D%20else%20if%20%28shader%29%20%7B%0A%20%20%20%20%20%20this.uniforms%20%3D%20UniformsUtils.clone%28shader.uniforms%29%3B%0A%20%20%20%20%20%20this.material%20%3D%20new%20ShaderMaterial%28%7B%0A%20%20%20%20%20%20%20%20name%3A%20shader.name%20%21%3D%3D%20void%200%20%3F%20shader.name%20%3A%20%22unspecified%22%2C%0A%20%20%20%20%20%20%20%20defines%3A%20Object.assign%28%7B%7D%2C%20shader.defines%29%2C%0A%20%20%20%20%20%20%20%20uniforms%3A%20this.uniforms%2C%0A%20%20%20%20%20%20%20%20vertexShader%3A%20shader.vertexShader%2C%0A%20%20%20%20%20%20%20%20fragmentShader%3A%20shader.fragmentShader%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.fsQuad%20%3D%20new%20FullScreenQuad%28this.material%29%3B%0A%20%20%7D%0A%20%20render%28renderer3%2C%20writeBuffer%2C%20readBuffer%29%20%7B%0A%20%20%20%20if%20%28this.uniforms%5Bthis.textureID%5D%29%20%7B%0A%20%20%20%20%20%20this.uniforms%5Bthis.textureID%5D.value%20%3D%20readBuffer.texture%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.fsQuad.material%20%3D%20this.material%3B%0A%20%20%20%20if%20%28this.renderToScreen%29%20%7B%0A%20%20%20%20%20%20renderer3.setRenderTarget%28null%29%3B%0A%20%20%20%20%20%20this.fsQuad.render%28renderer3%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20renderer3.setRenderTarget%28writeBuffer%29%3B%0A%20%20%20%20%20%20if%20%28this.clear%29%20renderer3.clear%28renderer3.autoClearColor%2C%20renderer3.autoClearDepth%2C%20renderer3.autoClearStencil%29%3B%0A%20%20%20%20%20%20this.fsQuad.render%28renderer3%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.material.dispose%28%29%3B%0A%20%20%20%20this.fsQuad.dispose%28%29%3B%0A%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fpostprocessing%2FMaskPass.js%0Avar%20MaskPass%20%3D%20class%20extends%20Pass%20%7B%0A%20%20constructor%28scene3%2C%20camera3%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.scene%20%3D%20scene3%3B%0A%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%20%20this.clear%20%3D%20true%3B%0A%20%20%20%20this.needsSwap%20%3D%20false%3B%0A%20%20%20%20this.inverse%20%3D%20false%3B%0A%20%20%7D%0A%20%20render%28renderer3%2C%20writeBuffer%2C%20readBuffer%29%20%7B%0A%20%20%20%20const%20context2%20%3D%20renderer3.getContext%28%29%3B%0A%20%20%20%20const%20state%20%3D%20renderer3.state%3B%0A%20%20%20%20state.buffers.color.setMask%28false%29%3B%0A%20%20%20%20state.buffers.depth.setMask%28false%29%3B%0A%20%20%20%20state.buffers.color.setLocked%28true%29%3B%0A%20%20%20%20state.buffers.depth.setLocked%28true%29%3B%0A%20%20%20%20let%20writeValue%2C%20clearValue%3B%0A%20%20%20%20if%20%28this.inverse%29%20%7B%0A%20%20%20%20%20%20writeValue%20%3D%200%3B%0A%20%20%20%20%20%20clearValue%20%3D%201%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20writeValue%20%3D%201%3B%0A%20%20%20%20%20%20clearValue%20%3D%200%3B%0A%20%20%20%20%7D%0A%20%20%20%20state.buffers.stencil.setTest%28true%29%3B%0A%20%20%20%20state.buffers.stencil.setOp%28context2.REPLACE%2C%20context2.REPLACE%2C%20context2.REPLACE%29%3B%0A%20%20%20%20state.buffers.stencil.setFunc%28context2.ALWAYS%2C%20writeValue%2C%204294967295%29%3B%0A%20%20%20%20state.buffers.stencil.setClear%28clearValue%29%3B%0A%20%20%20%20state.buffers.stencil.setLocked%28true%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28readBuffer%29%3B%0A%20%20%20%20if%20%28this.clear%29%20renderer3.clear%28%29%3B%0A%20%20%20%20renderer3.render%28this.scene%2C%20this.camera%29%3B%0A%20%20%20%20renderer3.setRenderTarget%28writeBuffer%29%3B%0A%20%20%20%20if%20%28this.clear%29%20renderer3.clear%28%29%3B%0A%20%20%20%20renderer3.render%28this.scene%2C%20this.camera%29%3B%0A%20%20%20%20state.buffers.color.setLocked%28false%29%3B%0A%20%20%20%20state.buffers.depth.setLocked%28false%29%3B%0A%20%20%20%20state.buffers.color.setMask%28true%29%3B%0A%20%20%20%20state.buffers.depth.setMask%28true%29%3B%0A%20%20%20%20state.buffers.stencil.setLocked%28false%29%3B%0A%20%20%20%20state.buffers.stencil.setFunc%28context2.EQUAL%2C%201%2C%204294967295%29%3B%0A%20%20%20%20state.buffers.stencil.setOp%28context2.KEEP%2C%20context2.KEEP%2C%20context2.KEEP%29%3B%0A%20%20%20%20state.buffers.stencil.setLocked%28true%29%3B%0A%20%20%7D%0A%7D%3B%0Avar%20ClearMaskPass%20%3D%20class%20extends%20Pass%20%7B%0A%20%20constructor%28%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.needsSwap%20%3D%20false%3B%0A%20%20%7D%0A%20%20render%28renderer3%29%20%7B%0A%20%20%20%20renderer3.state.buffers.stencil.setLocked%28false%29%3B%0A%20%20%20%20renderer3.state.buffers.stencil.setTest%28false%29%3B%0A%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fpostprocessing%2FEffectComposer.js%0Avar%20EffectComposer%20%3D%20class%20%7B%0A%20%20constructor%28renderer3%2C%20renderTarget%29%20%7B%0A%20%20%20%20this.renderer%20%3D%20renderer3%3B%0A%20%20%20%20this._pixelRatio%20%3D%20renderer3.getPixelRatio%28%29%3B%0A%20%20%20%20if%20%28renderTarget%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20size%20%3D%20renderer3.getSize%28new%20Vector2%28%29%29%3B%0A%20%20%20%20%20%20this._width%20%3D%20size.width%3B%0A%20%20%20%20%20%20this._height%20%3D%20size.height%3B%0A%20%20%20%20%20%20renderTarget%20%3D%20new%20WebGLRenderTarget%28this._width%20%2A%20this._pixelRatio%2C%20this._height%20%2A%20this._pixelRatio%2C%20%7B%20type%3A%20HalfFloatType%20%7D%29%3B%0A%20%20%20%20%20%20renderTarget.texture.name%20%3D%20%22EffectComposer.rt1%22%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20this._width%20%3D%20renderTarget.width%3B%0A%20%20%20%20%20%20this._height%20%3D%20renderTarget.height%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.renderTarget1%20%3D%20renderTarget%3B%0A%20%20%20%20this.renderTarget2%20%3D%20renderTarget.clone%28%29%3B%0A%20%20%20%20this.renderTarget2.texture.name%20%3D%20%22EffectComposer.rt2%22%3B%0A%20%20%20%20this.writeBuffer%20%3D%20this.renderTarget1%3B%0A%20%20%20%20this.readBuffer%20%3D%20this.renderTarget2%3B%0A%20%20%20%20this.renderToScreen%20%3D%20true%3B%0A%20%20%20%20this.passes%20%3D%20%5B%5D%3B%0A%20%20%20%20this.copyPass%20%3D%20new%20ShaderPass%28CopyShader%29%3B%0A%20%20%20%20this.copyPass.material.blending%20%3D%20NoBlending%3B%0A%20%20%20%20this.clock%20%3D%20new%20Clock%28%29%3B%0A%20%20%7D%0A%20%20swapBuffers%28%29%20%7B%0A%20%20%20%20const%20tmp2%20%3D%20this.readBuffer%3B%0A%20%20%20%20this.readBuffer%20%3D%20this.writeBuffer%3B%0A%20%20%20%20this.writeBuffer%20%3D%20tmp2%3B%0A%20%20%7D%0A%20%20addPass%28pass%29%20%7B%0A%20%20%20%20this.passes.push%28pass%29%3B%0A%20%20%20%20pass.setSize%28this._width%20%2A%20this._pixelRatio%2C%20this._height%20%2A%20this._pixelRatio%29%3B%0A%20%20%7D%0A%20%20insertPass%28pass%2C%20index5%29%20%7B%0A%20%20%20%20this.passes.splice%28index5%2C%200%2C%20pass%29%3B%0A%20%20%20%20pass.setSize%28this._width%20%2A%20this._pixelRatio%2C%20this._height%20%2A%20this._pixelRatio%29%3B%0A%20%20%7D%0A%20%20removePass%28pass%29%20%7B%0A%20%20%20%20const%20index5%20%3D%20this.passes.indexOf%28pass%29%3B%0A%20%20%20%20if%20%28index5%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20this.passes.splice%28index5%2C%201%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20isLastEnabledPass%28passIndex%29%20%7B%0A%20%20%20%20for%20%28let%20i%20%3D%20passIndex%20%2B%201%3B%20i%20%3C%20this.passes.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20if%20%28this.passes%5Bi%5D.enabled%29%20%7B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20true%3B%0A%20%20%7D%0A%20%20render%28deltaTime%29%20%7B%0A%20%20%20%20if%20%28deltaTime%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20deltaTime%20%3D%20this.clock.getDelta%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20currentRenderTarget%20%3D%20this.renderer.getRenderTarget%28%29%3B%0A%20%20%20%20let%20maskActive%20%3D%20false%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%2C%20il%20%3D%20this.passes.length%3B%20i%20%3C%20il%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20const%20pass%20%3D%20this.passes%5Bi%5D%3B%0A%20%20%20%20%20%20if%20%28pass.enabled%20%3D%3D%3D%20false%29%20continue%3B%0A%20%20%20%20%20%20pass.renderToScreen%20%3D%20this.renderToScreen%20%26%26%20this.isLastEnabledPass%28i%29%3B%0A%20%20%20%20%20%20pass.render%28this.renderer%2C%20this.writeBuffer%2C%20this.readBuffer%2C%20deltaTime%2C%20maskActive%29%3B%0A%20%20%20%20%20%20if%20%28pass.needsSwap%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28maskActive%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20context2%20%3D%20this.renderer.getContext%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20const%20stencil%20%3D%20this.renderer.state.buffers.stencil%3B%0A%20%20%20%20%20%20%20%20%20%20stencil.setFunc%28context2.NOTEQUAL%2C%201%2C%204294967295%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.copyPass.render%28this.renderer%2C%20this.writeBuffer%2C%20this.readBuffer%2C%20deltaTime%29%3B%0A%20%20%20%20%20%20%20%20%20%20stencil.setFunc%28context2.EQUAL%2C%201%2C%204294967295%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this.swapBuffers%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28MaskPass%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28pass%20instanceof%20MaskPass%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20maskActive%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28pass%20instanceof%20ClearMaskPass%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20maskActive%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20this.renderer.setRenderTarget%28currentRenderTarget%29%3B%0A%20%20%7D%0A%20%20reset%28renderTarget%29%20%7B%0A%20%20%20%20if%20%28renderTarget%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20const%20size%20%3D%20this.renderer.getSize%28new%20Vector2%28%29%29%3B%0A%20%20%20%20%20%20this._pixelRatio%20%3D%20this.renderer.getPixelRatio%28%29%3B%0A%20%20%20%20%20%20this._width%20%3D%20size.width%3B%0A%20%20%20%20%20%20this._height%20%3D%20size.height%3B%0A%20%20%20%20%20%20renderTarget%20%3D%20this.renderTarget1.clone%28%29%3B%0A%20%20%20%20%20%20renderTarget.setSize%28this._width%20%2A%20this._pixelRatio%2C%20this._height%20%2A%20this._pixelRatio%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20this.renderTarget1.dispose%28%29%3B%0A%20%20%20%20this.renderTarget2.dispose%28%29%3B%0A%20%20%20%20this.renderTarget1%20%3D%20renderTarget%3B%0A%20%20%20%20this.renderTarget2%20%3D%20renderTarget.clone%28%29%3B%0A%20%20%20%20this.writeBuffer%20%3D%20this.renderTarget1%3B%0A%20%20%20%20this.readBuffer%20%3D%20this.renderTarget2%3B%0A%20%20%7D%0A%20%20setSize%28width%2C%20height%29%20%7B%0A%20%20%20%20this._width%20%3D%20width%3B%0A%20%20%20%20this._height%20%3D%20height%3B%0A%20%20%20%20const%20effectiveWidth%20%3D%20this._width%20%2A%20this._pixelRatio%3B%0A%20%20%20%20const%20effectiveHeight%20%3D%20this._height%20%2A%20this._pixelRatio%3B%0A%20%20%20%20this.renderTarget1.setSize%28effectiveWidth%2C%20effectiveHeight%29%3B%0A%20%20%20%20this.renderTarget2.setSize%28effectiveWidth%2C%20effectiveHeight%29%3B%0A%20%20%20%20for%20%28let%20i%20%3D%200%3B%20i%20%3C%20this.passes.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20this.passes%5Bi%5D.setSize%28effectiveWidth%2C%20effectiveHeight%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20setPixelRatio%28pixelRatio%29%20%7B%0A%20%20%20%20this._pixelRatio%20%3D%20pixelRatio%3B%0A%20%20%20%20this.setSize%28this._width%2C%20this._height%29%3B%0A%20%20%7D%0A%20%20dispose%28%29%20%7B%0A%20%20%20%20this.renderTarget1.dispose%28%29%3B%0A%20%20%20%20this.renderTarget2.dispose%28%29%3B%0A%20%20%20%20this.copyPass.dispose%28%29%3B%0A%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree%2Fexamples%2Fjsm%2Fpostprocessing%2FRenderPass.js%0Avar%20RenderPass%20%3D%20class%20extends%20Pass%20%7B%0A%20%20constructor%28scene3%2C%20camera3%2C%20overrideMaterial%20%3D%20null%2C%20clearColor%20%3D%20null%2C%20clearAlpha%20%3D%20null%29%20%7B%0A%20%20%20%20super%28%29%3B%0A%20%20%20%20this.scene%20%3D%20scene3%3B%0A%20%20%20%20this.camera%20%3D%20camera3%3B%0A%20%20%20%20this.overrideMaterial%20%3D%20overrideMaterial%3B%0A%20%20%20%20this.clearColor%20%3D%20clearColor%3B%0A%20%20%20%20this.clearAlpha%20%3D%20clearAlpha%3B%0A%20%20%20%20this.clear%20%3D%20true%3B%0A%20%20%20%20this.clearDepth%20%3D%20false%3B%0A%20%20%20%20this.needsSwap%20%3D%20false%3B%0A%20%20%20%20this._oldClearColor%20%3D%20new%20Color%28%29%3B%0A%20%20%7D%0A%20%20render%28renderer3%2C%20writeBuffer%2C%20readBuffer%29%20%7B%0A%20%20%20%20const%20oldAutoClear%20%3D%20renderer3.autoClear%3B%0A%20%20%20%20renderer3.autoClear%20%3D%20false%3B%0A%20%20%20%20let%20oldClearAlpha%2C%20oldOverrideMaterial%3B%0A%20%20%20%20if%20%28this.overrideMaterial%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20oldOverrideMaterial%20%3D%20this.scene.overrideMaterial%3B%0A%20%20%20%20%20%20this.scene.overrideMaterial%20%3D%20this.overrideMaterial%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearColor%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20renderer3.getClearColor%28this._oldClearColor%29%3B%0A%20%20%20%20%20%20renderer3.setClearColor%28this.clearColor%2C%20renderer3.getClearAlpha%28%29%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearAlpha%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20oldClearAlpha%20%3D%20renderer3.getClearAlpha%28%29%3B%0A%20%20%20%20%20%20renderer3.setClearAlpha%28this.clearAlpha%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearDepth%20%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20renderer3.clearDepth%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.setRenderTarget%28this.renderToScreen%20%3F%20null%20%3A%20readBuffer%29%3B%0A%20%20%20%20if%20%28this.clear%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20renderer3.clear%28renderer3.autoClearColor%2C%20renderer3.autoClearDepth%2C%20renderer3.autoClearStencil%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.render%28this.scene%2C%20this.camera%29%3B%0A%20%20%20%20if%20%28this.clearColor%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20renderer3.setClearColor%28this._oldClearColor%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.clearAlpha%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20renderer3.setClearAlpha%28oldClearAlpha%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28this.overrideMaterial%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20this.scene.overrideMaterial%20%3D%20oldOverrideMaterial%3B%0A%20%20%20%20%7D%0A%20%20%20%20renderer3.autoClear%20%3D%20oldAutoClear%3B%0A%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40babel%2Fruntime%2Fhelpers%2Fesm%2Fextends.js%0Afunction%20_extends%28%29%20%7B%0A%20%20return%20_extends%20%3D%20Object.assign%20%3F%20Object.assign.bind%28%29%20%3A%20function%28n%29%20%7B%0A%20%20%20%20for%20%28var%20e%20%3D%201%3B%20e%20%3C%20arguments.length%3B%20e%2B%2B%29%20%7B%0A%20%20%20%20%20%20var%20t%20%3D%20arguments%5Be%5D%3B%0A%20%20%20%20%20%20for%20%28var%20r%20in%20t%29%20%28%7B%7D%29.hasOwnProperty.call%28t%2C%20r%29%20%26%26%20%28n%5Br%5D%20%3D%20t%5Br%5D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20n%3B%0A%20%20%7D%2C%20_extends.apply%28null%2C%20arguments%29%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40babel%2Fruntime%2Fhelpers%2Fesm%2FassertThisInitialized.js%0Afunction%20_assertThisInitialized2%28e%29%20%7B%0A%20%20if%20%28void%200%20%3D%3D%3D%20e%29%20throw%20new%20ReferenceError%28%22this%20hasn%27t%20been%20initialised%20-%20super%28%29%20hasn%27t%20been%20called%22%29%3B%0A%20%20return%20e%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40babel%2Fruntime%2Fhelpers%2Fesm%2FsetPrototypeOf.js%0Afunction%20_setPrototypeOf2%28t%2C%20e%29%20%7B%0A%20%20return%20_setPrototypeOf2%20%3D%20Object.setPrototypeOf%20%3F%20Object.setPrototypeOf.bind%28%29%20%3A%20function%28t2%2C%20e2%29%20%7B%0A%20%20%20%20return%20t2.__proto__%20%3D%20e2%2C%20t2%3B%0A%20%20%7D%2C%20_setPrototypeOf2%28t%2C%20e%29%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40babel%2Fruntime%2Fhelpers%2Fesm%2FinheritsLoose.js%0Afunction%20_inheritsLoose%28t%2C%20o%29%20%7B%0A%20%20t.prototype%20%3D%20Object.create%28o.prototype%29%2C%20t.prototype.constructor%20%3D%20t%2C%20_setPrototypeOf2%28t%2C%20o%29%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40babel%2Fruntime%2Fhelpers%2Fesm%2FgetPrototypeOf.js%0Afunction%20_getPrototypeOf2%28t%29%20%7B%0A%20%20return%20_getPrototypeOf2%20%3D%20Object.setPrototypeOf%20%3F%20Object.getPrototypeOf.bind%28%29%20%3A%20function%28t2%29%20%7B%0A%20%20%20%20return%20t2.__proto__%20%7C%7C%20Object.getPrototypeOf%28t2%29%3B%0A%20%20%7D%2C%20_getPrototypeOf2%28t%29%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40babel%2Fruntime%2Fhelpers%2Fesm%2FisNativeFunction.js%0Afunction%20_isNativeFunction%28t%29%20%7B%0A%20%20try%20%7B%0A%20%20%20%20return%20-1%20%21%3D%3D%20Function.toString.call%28t%29.indexOf%28%22%5Bnative%20code%5D%22%29%3B%0A%20%20%7D%20catch%20%28n%29%20%7B%0A%20%20%20%20return%20%22function%22%20%3D%3D%20typeof%20t%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40babel%2Fruntime%2Fhelpers%2Fesm%2FisNativeReflectConstruct.js%0Afunction%20_isNativeReflectConstruct2%28%29%20%7B%0A%20%20try%20%7B%0A%20%20%20%20var%20t%20%3D%20%21Boolean.prototype.valueOf.call%28Reflect.construct%28Boolean%2C%20%5B%5D%2C%20function%28%29%20%7B%0A%20%20%20%20%7D%29%29%3B%0A%20%20%7D%20catch%20%28t2%29%20%7B%0A%20%20%7D%0A%20%20return%20%28_isNativeReflectConstruct2%20%3D%20function%20_isNativeReflectConstruct3%28%29%20%7B%0A%20%20%20%20return%20%21%21t%3B%0A%20%20%7D%29%28%29%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40babel%2Fruntime%2Fhelpers%2Fesm%2Fconstruct.js%0Afunction%20_construct2%28t%2C%20e%2C%20r%29%20%7B%0A%20%20if%20%28_isNativeReflectConstruct2%28%29%29%20return%20Reflect.construct.apply%28null%2C%20arguments%29%3B%0A%20%20var%20o%20%3D%20%5Bnull%5D%3B%0A%20%20o.push.apply%28o%2C%20e%29%3B%0A%20%20var%20p%20%3D%20new%20%28t.bind.apply%28t%2C%20o%29%29%28%29%3B%0A%20%20return%20r%20%26%26%20_setPrototypeOf2%28p%2C%20r.prototype%29%2C%20p%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40babel%2Fruntime%2Fhelpers%2Fesm%2FwrapNativeSuper.js%0Afunction%20_wrapNativeSuper%28t%29%20%7B%0A%20%20var%20r%20%3D%20%22function%22%20%3D%3D%20typeof%20Map%20%3F%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Map%28%29%20%3A%20void%200%3B%0A%20%20return%20_wrapNativeSuper%20%3D%20function%20_wrapNativeSuper2%28t2%29%20%7B%0A%20%20%20%20if%20%28null%20%3D%3D%3D%20t2%20%7C%7C%20%21_isNativeFunction%28t2%29%29%20return%20t2%3B%0A%20%20%20%20if%20%28%22function%22%20%21%3D%20typeof%20t2%29%20throw%20new%20TypeError%28%22Super%20expression%20must%20either%20be%20null%20or%20a%20function%22%29%3B%0A%20%20%20%20if%20%28void%200%20%21%3D%3D%20r%29%20%7B%0A%20%20%20%20%20%20if%20%28r.has%28t2%29%29%20return%20r.get%28t2%29%3B%0A%20%20%20%20%20%20r.set%28t2%2C%20Wrapper%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20Wrapper%28%29%20%7B%0A%20%20%20%20%20%20return%20_construct2%28t2%2C%20arguments%2C%20_getPrototypeOf2%28this%29.constructor%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20Wrapper.prototype%20%3D%20Object.create%28t2.prototype%2C%20%7B%0A%20%20%20%20%20%20constructor%3A%20%7B%0A%20%20%20%20%20%20%20%20value%3A%20Wrapper%2C%0A%20%20%20%20%20%20%20%20enumerable%3A%20false%2C%0A%20%20%20%20%20%20%20%20writable%3A%20true%2C%0A%20%20%20%20%20%20%20%20configurable%3A%20true%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%2C%20_setPrototypeOf2%28Wrapper%2C%20t2%29%3B%0A%20%20%7D%2C%20_wrapNativeSuper%28t%29%3B%0A%7D%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fpolished%2Fdist%2Fpolished.esm.js%0Avar%20ERRORS%20%3D%20%7B%0A%20%20%221%22%3A%20%22Passed%20invalid%20arguments%20to%20hsl%2C%20please%20pass%20multiple%20numbers%20e.g.%20hsl%28360%2C%200.75%2C%200.4%29%20or%20an%20object%20e.g.%20rgb%28%7B%20hue%3A%20255%2C%20saturation%3A%200.4%2C%20lightness%3A%200.75%20%7D%29.%5Cn%5Cn%22%2C%0A%20%20%222%22%3A%20%22Passed%20invalid%20arguments%20to%20hsla%2C%20please%20pass%20multiple%20numbers%20e.g.%20hsla%28360%2C%200.75%2C%200.4%2C%200.7%29%20or%20an%20object%20e.g.%20rgb%28%7B%20hue%3A%20255%2C%20saturation%3A%200.4%2C%20lightness%3A%200.75%2C%20alpha%3A%200.7%20%7D%29.%5Cn%5Cn%22%2C%0A%20%20%223%22%3A%20%22Passed%20an%20incorrect%20argument%20to%20a%20color%20function%2C%20please%20pass%20a%20string%20representation%20of%20a%20color.%5Cn%5Cn%22%2C%0A%20%20%224%22%3A%20%22Couldn%27t%20generate%20valid%20rgb%20string%20from%20%25s%2C%20it%20returned%20%25s.%5Cn%5Cn%22%2C%0A%20%20%225%22%3A%20%22Couldn%27t%20parse%20the%20color%20string.%20Please%20provide%20the%20color%20as%20a%20string%20in%20hex%2C%20rgb%2C%20rgba%2C%20hsl%20or%20hsla%20notation.%5Cn%5Cn%22%2C%0A%20%20%226%22%3A%20%22Passed%20invalid%20arguments%20to%20rgb%2C%20please%20pass%20multiple%20numbers%20e.g.%20rgb%28255%2C%20205%2C%20100%29%20or%20an%20object%20e.g.%20rgb%28%7B%20red%3A%20255%2C%20green%3A%20205%2C%20blue%3A%20100%20%7D%29.%5Cn%5Cn%22%2C%0A%20%20%227%22%3A%20%22Passed%20invalid%20arguments%20to%20rgba%2C%20please%20pass%20multiple%20numbers%20e.g.%20rgb%28255%2C%20205%2C%20100%2C%200.75%29%20or%20an%20object%20e.g.%20rgb%28%7B%20red%3A%20255%2C%20green%3A%20205%2C%20blue%3A%20100%2C%20alpha%3A%200.75%20%7D%29.%5Cn%5Cn%22%2C%0A%20%20%228%22%3A%20%22Passed%20invalid%20argument%20to%20toColorString%2C%20please%20pass%20a%20RgbColor%2C%20RgbaColor%2C%20HslColor%20or%20HslaColor%20object.%5Cn%5Cn%22%2C%0A%20%20%229%22%3A%20%22Please%20provide%20a%20number%20of%20steps%20to%20the%20modularScale%20helper.%5Cn%5Cn%22%2C%0A%20%20%2210%22%3A%20%22Please%20pass%20a%20number%20or%20one%20of%20the%20predefined%20scales%20to%20the%20modularScale%20helper%20as%20the%20ratio.%5Cn%5Cn%22%2C%0A%20%20%2211%22%3A%20%27Invalid%20value%20passed%20as%20base%20to%20modularScale%2C%20expected%20number%20or%20em%20string%20but%20got%20%22%25s%22%5Cn%5Cn%27%2C%0A%20%20%2212%22%3A%20%27Expected%20a%20string%20ending%20in%20%22px%22%20or%20a%20number%20passed%20as%20the%20first%20argument%20to%20%25s%28%29%2C%20got%20%22%25s%22%20instead.%5Cn%5Cn%27%2C%0A%20%20%2213%22%3A%20%27Expected%20a%20string%20ending%20in%20%22px%22%20or%20a%20number%20passed%20as%20the%20second%20argument%20to%20%25s%28%29%2C%20got%20%22%25s%22%20instead.%5Cn%5Cn%27%2C%0A%20%20%2214%22%3A%20%27Passed%20invalid%20pixel%20value%20%28%22%25s%22%29%20to%20%25s%28%29%2C%20please%20pass%20a%20value%20like%20%2212px%22%20or%2012.%5Cn%5Cn%27%2C%0A%20%20%2215%22%3A%20%27Passed%20invalid%20base%20value%20%28%22%25s%22%29%20to%20%25s%28%29%2C%20please%20pass%20a%20value%20like%20%2212px%22%20or%2012.%5Cn%5Cn%27%2C%0A%20%20%2216%22%3A%20%22You%20must%20provide%20a%20template%20to%20this%20method.%5Cn%5Cn%22%2C%0A%20%20%2217%22%3A%20%22You%20passed%20an%20unsupported%20selector%20state%20to%20this%20method.%5Cn%5Cn%22%2C%0A%20%20%2218%22%3A%20%22minScreen%20and%20maxScreen%20must%20be%20provided%20as%20stringified%20numbers%20with%20the%20same%20units.%5Cn%5Cn%22%2C%0A%20%20%2219%22%3A%20%22fromSize%20and%20toSize%20must%20be%20provided%20as%20stringified%20numbers%20with%20the%20same%20units.%5Cn%5Cn%22%2C%0A%20%20%2220%22%3A%20%22expects%20either%20an%20array%20of%20objects%20or%20a%20single%20object%20with%20the%20properties%20prop%2C%20fromSize%2C%20and%20toSize.%5Cn%5Cn%22%2C%0A%20%20%2221%22%3A%20%22expects%20the%20objects%20in%20the%20first%20argument%20array%20to%20have%20the%20properties%20%60prop%60%2C%20%60fromSize%60%2C%20and%20%60toSize%60.%5Cn%5Cn%22%2C%0A%20%20%2222%22%3A%20%22expects%20the%20first%20argument%20object%20to%20have%20the%20properties%20%60prop%60%2C%20%60fromSize%60%2C%20and%20%60toSize%60.%5Cn%5Cn%22%2C%0A%20%20%2223%22%3A%20%22fontFace%20expects%20a%20name%20of%20a%20font-family.%5Cn%5Cn%22%2C%0A%20%20%2224%22%3A%20%22fontFace%20expects%20either%20the%20path%20to%20the%20font%20file%28s%29%20or%20a%20name%20of%20a%20local%20copy.%5Cn%5Cn%22%2C%0A%20%20%2225%22%3A%20%22fontFace%20expects%20localFonts%20to%20be%20an%20array.%5Cn%5Cn%22%2C%0A%20%20%2226%22%3A%20%22fontFace%20expects%20fileFormats%20to%20be%20an%20array.%5Cn%5Cn%22%2C%0A%20%20%2227%22%3A%20%22radialGradient%20requries%20at%20least%202%20color-stops%20to%20properly%20render.%5Cn%5Cn%22%2C%0A%20%20%2228%22%3A%20%22Please%20supply%20a%20filename%20to%20retinaImage%28%29%20as%20the%20first%20argument.%5Cn%5Cn%22%2C%0A%20%20%2229%22%3A%20%22Passed%20invalid%20argument%20to%20triangle%2C%20please%20pass%20correct%20pointingDirection%20e.g.%20%27right%27.%5Cn%5Cn%22%2C%0A%20%20%2230%22%3A%20%22Passed%20an%20invalid%20value%20to%20%60height%60%20or%20%60width%60.%20Please%20provide%20a%20pixel%20based%20unit.%5Cn%5Cn%22%2C%0A%20%20%2231%22%3A%20%22The%20animation%20shorthand%20only%20takes%208%20arguments.%20See%20the%20specification%20for%20more%20information%3A%20http%3A%2F%2Fmdn.io%2Fanimation%5Cn%5Cn%22%2C%0A%20%20%2232%22%3A%20%22To%20pass%20multiple%20animations%20please%20supply%20them%20in%20arrays%2C%20e.g.%20animation%28%5B%27rotate%27%2C%20%272s%27%5D%2C%20%5B%27move%27%2C%20%271s%27%5D%29%5CnTo%20pass%20a%20single%20animation%20please%20supply%20them%20in%20simple%20values%2C%20e.g.%20animation%28%27rotate%27%2C%20%272s%27%29%5Cn%5Cn%22%2C%0A%20%20%2233%22%3A%20%22The%20animation%20shorthand%20arrays%20can%20only%20have%208%20elements.%20See%20the%20specification%20for%20more%20information%3A%20http%3A%2F%2Fmdn.io%2Fanimation%5Cn%5Cn%22%2C%0A%20%20%2234%22%3A%20%22borderRadius%20expects%20a%20radius%20value%20as%20a%20string%20or%20number%20as%20the%20second%20argument.%5Cn%5Cn%22%2C%0A%20%20%2235%22%3A%20%27borderRadius%20expects%20one%20of%20%22top%22%2C%20%22bottom%22%2C%20%22left%22%20or%20%22right%22%20as%20the%20first%20argument.%5Cn%5Cn%27%2C%0A%20%20%2236%22%3A%20%22Property%20must%20be%20a%20string%20value.%5Cn%5Cn%22%2C%0A%20%20%2237%22%3A%20%22Syntax%20Error%20at%20%25s.%5Cn%5Cn%22%2C%0A%20%20%2238%22%3A%20%22Formula%20contains%20a%20function%20that%20needs%20parentheses%20at%20%25s.%5Cn%5Cn%22%2C%0A%20%20%2239%22%3A%20%22Formula%20is%20missing%20closing%20parenthesis%20at%20%25s.%5Cn%5Cn%22%2C%0A%20%20%2240%22%3A%20%22Formula%20has%20too%20many%20closing%20parentheses%20at%20%25s.%5Cn%5Cn%22%2C%0A%20%20%2241%22%3A%20%22All%20values%20in%20a%20formula%20must%20have%20the%20same%20unit%20or%20be%20unitless.%5Cn%5Cn%22%2C%0A%20%20%2242%22%3A%20%22Please%20provide%20a%20number%20of%20steps%20to%20the%20modularScale%20helper.%5Cn%5Cn%22%2C%0A%20%20%2243%22%3A%20%22Please%20pass%20a%20number%20or%20one%20of%20the%20predefined%20scales%20to%20the%20modularScale%20helper%20as%20the%20ratio.%5Cn%5Cn%22%2C%0A%20%20%2244%22%3A%20%22Invalid%20value%20passed%20as%20base%20to%20modularScale%2C%20expected%20number%20or%20em%2Frem%20string%20but%20got%20%25s.%5Cn%5Cn%22%2C%0A%20%20%2245%22%3A%20%22Passed%20invalid%20argument%20to%20hslToColorString%2C%20please%20pass%20a%20HslColor%20or%20HslaColor%20object.%5Cn%5Cn%22%2C%0A%20%20%2246%22%3A%20%22Passed%20invalid%20argument%20to%20rgbToColorString%2C%20please%20pass%20a%20RgbColor%20or%20RgbaColor%20object.%5Cn%5Cn%22%2C%0A%20%20%2247%22%3A%20%22minScreen%20and%20maxScreen%20must%20be%20provided%20as%20stringified%20numbers%20with%20the%20same%20units.%5Cn%5Cn%22%2C%0A%20%20%2248%22%3A%20%22fromSize%20and%20toSize%20must%20be%20provided%20as%20stringified%20numbers%20with%20the%20same%20units.%5Cn%5Cn%22%2C%0A%20%20%2249%22%3A%20%22Expects%20either%20an%20array%20of%20objects%20or%20a%20single%20object%20with%20the%20properties%20prop%2C%20fromSize%2C%20and%20toSize.%5Cn%5Cn%22%2C%0A%20%20%2250%22%3A%20%22Expects%20the%20objects%20in%20the%20first%20argument%20array%20to%20have%20the%20properties%20prop%2C%20fromSize%2C%20and%20toSize.%5Cn%5Cn%22%2C%0A%20%20%2251%22%3A%20%22Expects%20the%20first%20argument%20object%20to%20have%20the%20properties%20prop%2C%20fromSize%2C%20and%20toSize.%5Cn%5Cn%22%2C%0A%20%20%2252%22%3A%20%22fontFace%20expects%20either%20the%20path%20to%20the%20font%20file%28s%29%20or%20a%20name%20of%20a%20local%20copy.%5Cn%5Cn%22%2C%0A%20%20%2253%22%3A%20%22fontFace%20expects%20localFonts%20to%20be%20an%20array.%5Cn%5Cn%22%2C%0A%20%20%2254%22%3A%20%22fontFace%20expects%20fileFormats%20to%20be%20an%20array.%5Cn%5Cn%22%2C%0A%20%20%2255%22%3A%20%22fontFace%20expects%20a%20name%20of%20a%20font-family.%5Cn%5Cn%22%2C%0A%20%20%2256%22%3A%20%22linearGradient%20requries%20at%20least%202%20color-stops%20to%20properly%20render.%5Cn%5Cn%22%2C%0A%20%20%2257%22%3A%20%22radialGradient%20requries%20at%20least%202%20color-stops%20to%20properly%20render.%5Cn%5Cn%22%2C%0A%20%20%2258%22%3A%20%22Please%20supply%20a%20filename%20to%20retinaImage%28%29%20as%20the%20first%20argument.%5Cn%5Cn%22%2C%0A%20%20%2259%22%3A%20%22Passed%20invalid%20argument%20to%20triangle%2C%20please%20pass%20correct%20pointingDirection%20e.g.%20%27right%27.%5Cn%5Cn%22%2C%0A%20%20%2260%22%3A%20%22Passed%20an%20invalid%20value%20to%20%60height%60%20or%20%60width%60.%20Please%20provide%20a%20pixel%20based%20unit.%5Cn%5Cn%22%2C%0A%20%20%2261%22%3A%20%22Property%20must%20be%20a%20string%20value.%5Cn%5Cn%22%2C%0A%20%20%2262%22%3A%20%22borderRadius%20expects%20a%20radius%20value%20as%20a%20string%20or%20number%20as%20the%20second%20argument.%5Cn%5Cn%22%2C%0A%20%20%2263%22%3A%20%27borderRadius%20expects%20one%20of%20%22top%22%2C%20%22bottom%22%2C%20%22left%22%20or%20%22right%22%20as%20the%20first%20argument.%5Cn%5Cn%27%2C%0A%20%20%2264%22%3A%20%22The%20animation%20shorthand%20only%20takes%208%20arguments.%20See%20the%20specification%20for%20more%20information%3A%20http%3A%2F%2Fmdn.io%2Fanimation.%5Cn%5Cn%22%2C%0A%20%20%2265%22%3A%20%22To%20pass%20multiple%20animations%20please%20supply%20them%20in%20arrays%2C%20e.g.%20animation%28%5B%27rotate%27%2C%20%272s%27%5D%2C%20%5B%27move%27%2C%20%271s%27%5D%29%5C%5CnTo%20pass%20a%20single%20animation%20please%20supply%20them%20in%20simple%20values%2C%20e.g.%20animation%28%27rotate%27%2C%20%272s%27%29.%5Cn%5Cn%22%2C%0A%20%20%2266%22%3A%20%22The%20animation%20shorthand%20arrays%20can%20only%20have%208%20elements.%20See%20the%20specification%20for%20more%20information%3A%20http%3A%2F%2Fmdn.io%2Fanimation.%5Cn%5Cn%22%2C%0A%20%20%2267%22%3A%20%22You%20must%20provide%20a%20template%20to%20this%20method.%5Cn%5Cn%22%2C%0A%20%20%2268%22%3A%20%22You%20passed%20an%20unsupported%20selector%20state%20to%20this%20method.%5Cn%5Cn%22%2C%0A%20%20%2269%22%3A%20%27Expected%20a%20string%20ending%20in%20%22px%22%20or%20a%20number%20passed%20as%20the%20first%20argument%20to%20%25s%28%29%2C%20got%20%25s%20instead.%5Cn%5Cn%27%2C%0A%20%20%2270%22%3A%20%27Expected%20a%20string%20ending%20in%20%22px%22%20or%20a%20number%20passed%20as%20the%20second%20argument%20to%20%25s%28%29%2C%20got%20%25s%20instead.%5Cn%5Cn%27%2C%0A%20%20%2271%22%3A%20%27Passed%20invalid%20pixel%20value%20%25s%20to%20%25s%28%29%2C%20please%20pass%20a%20value%20like%20%2212px%22%20or%2012.%5Cn%5Cn%27%2C%0A%20%20%2272%22%3A%20%27Passed%20invalid%20base%20value%20%25s%20to%20%25s%28%29%2C%20please%20pass%20a%20value%20like%20%2212px%22%20or%2012.%5Cn%5Cn%27%2C%0A%20%20%2273%22%3A%20%22Please%20provide%20a%20valid%20CSS%20variable.%5Cn%5Cn%22%2C%0A%20%20%2274%22%3A%20%22CSS%20variable%20not%20found%20and%20no%20default%20was%20provided.%5Cn%5Cn%22%2C%0A%20%20%2275%22%3A%20%22important%20requires%20a%20valid%20style%20object%2C%20got%20a%20%25s%20instead.%5Cn%5Cn%22%2C%0A%20%20%2276%22%3A%20%22fromSize%20and%20toSize%20must%20be%20provided%20as%20stringified%20numbers%20with%20the%20same%20units%20as%20minScreen%20and%20maxScreen.%5Cn%5Cn%22%2C%0A%20%20%2277%22%3A%20%27remToPx%20expects%20a%20value%20in%20%22rem%22%20but%20you%20provided%20it%20in%20%22%25s%22.%5Cn%5Cn%27%2C%0A%20%20%2278%22%3A%20%27base%20must%20be%20set%20in%20%22px%22%20or%20%22%25%22%20but%20you%20set%20it%20in%20%22%25s%22.%5Cn%27%0A%7D%3B%0Afunction%20format%28%29%20%7B%0A%20%20for%20%28var%20_len%20%3D%20arguments.length%2C%20args%20%3D%20new%20Array%28_len%29%2C%20_key%20%3D%200%3B%20_key%20%3C%20_len%3B%20_key%2B%2B%29%20%7B%0A%20%20%20%20args%5B_key%5D%20%3D%20arguments%5B_key%5D%3B%0A%20%20%7D%0A%20%20var%20a2%20%3D%20args%5B0%5D%3B%0A%20%20var%20b%20%3D%20%5B%5D%3B%0A%20%20var%20c2%3B%0A%20%20for%20%28c2%20%3D%201%3B%20c2%20%3C%20args.length%3B%20c2%20%2B%3D%201%29%20%7B%0A%20%20%20%20b.push%28args%5Bc2%5D%29%3B%0A%20%20%7D%0A%20%20b.forEach%28function%28d%29%20%7B%0A%20%20%20%20a2%20%3D%20a2.replace%28%2F%25%5Ba-z%5D%2F%2C%20d%29%3B%0A%20%20%7D%29%3B%0A%20%20return%20a2%3B%0A%7D%0Avar%20PolishedError%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20function%28_Error%29%20%7B%0A%20%20_inheritsLoose%28PolishedError2%2C%20_Error%29%3B%0A%20%20function%20PolishedError2%28code%29%20%7B%0A%20%20%20%20var%20_this%3B%0A%20%20%20%20if%20%28false%29%20%7B%0A%20%20%20%20%20%20_this%20%3D%20_Error.call%28this%2C%20%22An%20error%20occurred.%20See%20https%3A%2F%2Fgithub.com%2Fstyled-components%2Fpolished%2Fblob%2Fmain%2Fsrc%2FinternalHelpers%2Ferrors.md%23%22%20%2B%20code%20%2B%20%22%20for%20more%20information.%22%29%20%7C%7C%20this%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20%28var%20_len2%20%3D%20arguments.length%2C%20args%20%3D%20new%20Array%28_len2%20%3E%201%20%3F%20_len2%20-%201%20%3A%200%29%2C%20_key2%20%3D%201%3B%20_key2%20%3C%20_len2%3B%20_key2%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20args%5B_key2%20-%201%5D%20%3D%20arguments%5B_key2%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20_this%20%3D%20_Error.call%28this%2C%20format.apply%28void%200%2C%20%5BERRORS%5Bcode%5D%5D.concat%28args%29%29%29%20%7C%7C%20this%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20_assertThisInitialized2%28_this%29%3B%0A%20%20%7D%0A%20%20return%20PolishedError2%3B%0A%7D%28%2F%2A%20%40__PURE__%20%2A%2F%20_wrapNativeSuper%28Error%29%29%3B%0Afunction%20endsWith%28string%2C%20suffix%29%20%7B%0A%20%20return%20string.substr%28-suffix.length%29%20%3D%3D%3D%20suffix%3B%0A%7D%0Avar%20cssRegex%241%20%3D%20%2F%5E%28%5B%2B-%5D%3F%28%3F%3A%5Cd%2B%7C%5Cd%2A%5C.%5Cd%2B%29%29%28%5Ba-z%5D%2A%7C%25%29%24%2F%3B%0Afunction%20stripUnit%28value%29%20%7B%0A%20%20if%20%28typeof%20value%20%21%3D%3D%20%22string%22%29%20return%20value%3B%0A%20%20var%20matchedValue%20%3D%20value.match%28cssRegex%241%29%3B%0A%20%20return%20matchedValue%20%3F%20parseFloat%28value%29%20%3A%20value%3B%0A%7D%0Avar%20pxtoFactory%20%3D%20function%20pxtoFactory2%28to%29%20%7B%0A%20%20return%20function%28pxval%2C%20base%29%20%7B%0A%20%20%20%20if%20%28base%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20base%20%3D%20%2216px%22%3B%0A%20%20%20%20%7D%0A%20%20%20%20var%20newPxval%20%3D%20pxval%3B%0A%20%20%20%20var%20newBase%20%3D%20base%3B%0A%20%20%20%20if%20%28typeof%20pxval%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20%20%20if%20%28%21endsWith%28pxval%2C%20%22px%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20PolishedError%2869%2C%20to%2C%20pxval%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20newPxval%20%3D%20stripUnit%28pxval%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28typeof%20base%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20%20%20if%20%28%21endsWith%28base%2C%20%22px%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20throw%20new%20PolishedError%2870%2C%20to%2C%20base%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20newBase%20%3D%20stripUnit%28base%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28typeof%20newPxval%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20%20%20throw%20new%20PolishedError%2871%2C%20pxval%2C%20to%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28typeof%20newBase%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20%20%20throw%20new%20PolishedError%2872%2C%20base%2C%20to%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%22%22%20%2B%20newPxval%20%2F%20newBase%20%2B%20to%3B%0A%20%20%7D%3B%0A%7D%3B%0Avar%20pixelsto%20%3D%20pxtoFactory%3B%0Avar%20em%20%3D%20pixelsto%28%22em%22%29%3B%0Avar%20rem%20%3D%20pixelsto%28%22rem%22%29%3B%0Afunction%20colorToInt%28color2%29%20%7B%0A%20%20return%20Math.round%28color2%20%2A%20255%29%3B%0A%7D%0Afunction%20convertToInt%28red%2C%20green%2C%20blue%29%20%7B%0A%20%20return%20colorToInt%28red%29%20%2B%20%22%2C%22%20%2B%20colorToInt%28green%29%20%2B%20%22%2C%22%20%2B%20colorToInt%28blue%29%3B%0A%7D%0Afunction%20hslToRgb2%28hue%2C%20saturation%2C%20lightness%2C%20convert2%29%20%7B%0A%20%20if%20%28convert2%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20convert2%20%3D%20convertToInt%3B%0A%20%20%7D%0A%20%20if%20%28saturation%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20return%20convert2%28lightness%2C%20lightness%2C%20lightness%29%3B%0A%20%20%7D%0A%20%20var%20huePrime%20%3D%20%28hue%20%25%20360%20%2B%20360%29%20%25%20360%20%2F%2060%3B%0A%20%20var%20chroma%20%3D%20%281%20-%20Math.abs%282%20%2A%20lightness%20-%201%29%29%20%2A%20saturation%3B%0A%20%20var%20secondComponent%20%3D%20chroma%20%2A%20%281%20-%20Math.abs%28huePrime%20%25%202%20-%201%29%29%3B%0A%20%20var%20red%20%3D%200%3B%0A%20%20var%20green%20%3D%200%3B%0A%20%20var%20blue%20%3D%200%3B%0A%20%20if%20%28huePrime%20%3E%3D%200%20%26%26%20huePrime%20%3C%201%29%20%7B%0A%20%20%20%20red%20%3D%20chroma%3B%0A%20%20%20%20green%20%3D%20secondComponent%3B%0A%20%20%7D%20else%20if%20%28huePrime%20%3E%3D%201%20%26%26%20huePrime%20%3C%202%29%20%7B%0A%20%20%20%20red%20%3D%20secondComponent%3B%0A%20%20%20%20green%20%3D%20chroma%3B%0A%20%20%7D%20else%20if%20%28huePrime%20%3E%3D%202%20%26%26%20huePrime%20%3C%203%29%20%7B%0A%20%20%20%20green%20%3D%20chroma%3B%0A%20%20%20%20blue%20%3D%20secondComponent%3B%0A%20%20%7D%20else%20if%20%28huePrime%20%3E%3D%203%20%26%26%20huePrime%20%3C%204%29%20%7B%0A%20%20%20%20green%20%3D%20secondComponent%3B%0A%20%20%20%20blue%20%3D%20chroma%3B%0A%20%20%7D%20else%20if%20%28huePrime%20%3E%3D%204%20%26%26%20huePrime%20%3C%205%29%20%7B%0A%20%20%20%20red%20%3D%20secondComponent%3B%0A%20%20%20%20blue%20%3D%20chroma%3B%0A%20%20%7D%20else%20if%20%28huePrime%20%3E%3D%205%20%26%26%20huePrime%20%3C%206%29%20%7B%0A%20%20%20%20red%20%3D%20chroma%3B%0A%20%20%20%20blue%20%3D%20secondComponent%3B%0A%20%20%7D%0A%20%20var%20lightnessModification%20%3D%20lightness%20-%20chroma%20%2F%202%3B%0A%20%20var%20finalRed%20%3D%20red%20%2B%20lightnessModification%3B%0A%20%20var%20finalGreen%20%3D%20green%20%2B%20lightnessModification%3B%0A%20%20var%20finalBlue%20%3D%20blue%20%2B%20lightnessModification%3B%0A%20%20return%20convert2%28finalRed%2C%20finalGreen%2C%20finalBlue%29%3B%0A%7D%0Avar%20namedColorMap%20%3D%20%7B%0A%20%20aliceblue%3A%20%22f0f8ff%22%2C%0A%20%20antiquewhite%3A%20%22faebd7%22%2C%0A%20%20aqua%3A%20%2200ffff%22%2C%0A%20%20aquamarine%3A%20%227fffd4%22%2C%0A%20%20azure%3A%20%22f0ffff%22%2C%0A%20%20beige%3A%20%22f5f5dc%22%2C%0A%20%20bisque%3A%20%22ffe4c4%22%2C%0A%20%20black%3A%20%22000%22%2C%0A%20%20blanchedalmond%3A%20%22ffebcd%22%2C%0A%20%20blue%3A%20%220000ff%22%2C%0A%20%20blueviolet%3A%20%228a2be2%22%2C%0A%20%20brown%3A%20%22a52a2a%22%2C%0A%20%20burlywood%3A%20%22deb887%22%2C%0A%20%20cadetblue%3A%20%225f9ea0%22%2C%0A%20%20chartreuse%3A%20%227fff00%22%2C%0A%20%20chocolate%3A%20%22d2691e%22%2C%0A%20%20coral%3A%20%22ff7f50%22%2C%0A%20%20cornflowerblue%3A%20%226495ed%22%2C%0A%20%20cornsilk%3A%20%22fff8dc%22%2C%0A%20%20crimson%3A%20%22dc143c%22%2C%0A%20%20cyan%3A%20%2200ffff%22%2C%0A%20%20darkblue%3A%20%2200008b%22%2C%0A%20%20darkcyan%3A%20%22008b8b%22%2C%0A%20%20darkgoldenrod%3A%20%22b8860b%22%2C%0A%20%20darkgray%3A%20%22a9a9a9%22%2C%0A%20%20darkgreen%3A%20%22006400%22%2C%0A%20%20darkgrey%3A%20%22a9a9a9%22%2C%0A%20%20darkkhaki%3A%20%22bdb76b%22%2C%0A%20%20darkmagenta%3A%20%228b008b%22%2C%0A%20%20darkolivegreen%3A%20%22556b2f%22%2C%0A%20%20darkorange%3A%20%22ff8c00%22%2C%0A%20%20darkorchid%3A%20%229932cc%22%2C%0A%20%20darkred%3A%20%228b0000%22%2C%0A%20%20darksalmon%3A%20%22e9967a%22%2C%0A%20%20darkseagreen%3A%20%228fbc8f%22%2C%0A%20%20darkslateblue%3A%20%22483d8b%22%2C%0A%20%20darkslategray%3A%20%222f4f4f%22%2C%0A%20%20darkslategrey%3A%20%222f4f4f%22%2C%0A%20%20darkturquoise%3A%20%2200ced1%22%2C%0A%20%20darkviolet%3A%20%229400d3%22%2C%0A%20%20deeppink%3A%20%22ff1493%22%2C%0A%20%20deepskyblue%3A%20%2200bfff%22%2C%0A%20%20dimgray%3A%20%22696969%22%2C%0A%20%20dimgrey%3A%20%22696969%22%2C%0A%20%20dodgerblue%3A%20%221e90ff%22%2C%0A%20%20firebrick%3A%20%22b22222%22%2C%0A%20%20floralwhite%3A%20%22fffaf0%22%2C%0A%20%20forestgreen%3A%20%22228b22%22%2C%0A%20%20fuchsia%3A%20%22ff00ff%22%2C%0A%20%20gainsboro%3A%20%22dcdcdc%22%2C%0A%20%20ghostwhite%3A%20%22f8f8ff%22%2C%0A%20%20gold%3A%20%22ffd700%22%2C%0A%20%20goldenrod%3A%20%22daa520%22%2C%0A%20%20gray%3A%20%22808080%22%2C%0A%20%20green%3A%20%22008000%22%2C%0A%20%20greenyellow%3A%20%22adff2f%22%2C%0A%20%20grey%3A%20%22808080%22%2C%0A%20%20honeydew%3A%20%22f0fff0%22%2C%0A%20%20hotpink%3A%20%22ff69b4%22%2C%0A%20%20indianred%3A%20%22cd5c5c%22%2C%0A%20%20indigo%3A%20%224b0082%22%2C%0A%20%20ivory%3A%20%22fffff0%22%2C%0A%20%20khaki%3A%20%22f0e68c%22%2C%0A%20%20lavender%3A%20%22e6e6fa%22%2C%0A%20%20lavenderblush%3A%20%22fff0f5%22%2C%0A%20%20lawngreen%3A%20%227cfc00%22%2C%0A%20%20lemonchiffon%3A%20%22fffacd%22%2C%0A%20%20lightblue%3A%20%22add8e6%22%2C%0A%20%20lightcoral%3A%20%22f08080%22%2C%0A%20%20lightcyan%3A%20%22e0ffff%22%2C%0A%20%20lightgoldenrodyellow%3A%20%22fafad2%22%2C%0A%20%20lightgray%3A%20%22d3d3d3%22%2C%0A%20%20lightgreen%3A%20%2290ee90%22%2C%0A%20%20lightgrey%3A%20%22d3d3d3%22%2C%0A%20%20lightpink%3A%20%22ffb6c1%22%2C%0A%20%20lightsalmon%3A%20%22ffa07a%22%2C%0A%20%20lightseagreen%3A%20%2220b2aa%22%2C%0A%20%20lightskyblue%3A%20%2287cefa%22%2C%0A%20%20lightslategray%3A%20%22789%22%2C%0A%20%20lightslategrey%3A%20%22789%22%2C%0A%20%20lightsteelblue%3A%20%22b0c4de%22%2C%0A%20%20lightyellow%3A%20%22ffffe0%22%2C%0A%20%20lime%3A%20%220f0%22%2C%0A%20%20limegreen%3A%20%2232cd32%22%2C%0A%20%20linen%3A%20%22faf0e6%22%2C%0A%20%20magenta%3A%20%22f0f%22%2C%0A%20%20maroon%3A%20%22800000%22%2C%0A%20%20mediumaquamarine%3A%20%2266cdaa%22%2C%0A%20%20mediumblue%3A%20%220000cd%22%2C%0A%20%20mediumorchid%3A%20%22ba55d3%22%2C%0A%20%20mediumpurple%3A%20%229370db%22%2C%0A%20%20mediumseagreen%3A%20%223cb371%22%2C%0A%20%20mediumslateblue%3A%20%227b68ee%22%2C%0A%20%20mediumspringgreen%3A%20%2200fa9a%22%2C%0A%20%20mediumturquoise%3A%20%2248d1cc%22%2C%0A%20%20mediumvioletred%3A%20%22c71585%22%2C%0A%20%20midnightblue%3A%20%22191970%22%2C%0A%20%20mintcream%3A%20%22f5fffa%22%2C%0A%20%20mistyrose%3A%20%22ffe4e1%22%2C%0A%20%20moccasin%3A%20%22ffe4b5%22%2C%0A%20%20navajowhite%3A%20%22ffdead%22%2C%0A%20%20navy%3A%20%22000080%22%2C%0A%20%20oldlace%3A%20%22fdf5e6%22%2C%0A%20%20olive%3A%20%22808000%22%2C%0A%20%20olivedrab%3A%20%226b8e23%22%2C%0A%20%20orange%3A%20%22ffa500%22%2C%0A%20%20orangered%3A%20%22ff4500%22%2C%0A%20%20orchid%3A%20%22da70d6%22%2C%0A%20%20palegoldenrod%3A%20%22eee8aa%22%2C%0A%20%20palegreen%3A%20%2298fb98%22%2C%0A%20%20paleturquoise%3A%20%22afeeee%22%2C%0A%20%20palevioletred%3A%20%22db7093%22%2C%0A%20%20papayawhip%3A%20%22ffefd5%22%2C%0A%20%20peachpuff%3A%20%22ffdab9%22%2C%0A%20%20peru%3A%20%22cd853f%22%2C%0A%20%20pink%3A%20%22ffc0cb%22%2C%0A%20%20plum%3A%20%22dda0dd%22%2C%0A%20%20powderblue%3A%20%22b0e0e6%22%2C%0A%20%20purple%3A%20%22800080%22%2C%0A%20%20rebeccapurple%3A%20%22639%22%2C%0A%20%20red%3A%20%22f00%22%2C%0A%20%20rosybrown%3A%20%22bc8f8f%22%2C%0A%20%20royalblue%3A%20%224169e1%22%2C%0A%20%20saddlebrown%3A%20%228b4513%22%2C%0A%20%20salmon%3A%20%22fa8072%22%2C%0A%20%20sandybrown%3A%20%22f4a460%22%2C%0A%20%20seagreen%3A%20%222e8b57%22%2C%0A%20%20seashell%3A%20%22fff5ee%22%2C%0A%20%20sienna%3A%20%22a0522d%22%2C%0A%20%20silver%3A%20%22c0c0c0%22%2C%0A%20%20skyblue%3A%20%2287ceeb%22%2C%0A%20%20slateblue%3A%20%226a5acd%22%2C%0A%20%20slategray%3A%20%22708090%22%2C%0A%20%20slategrey%3A%20%22708090%22%2C%0A%20%20snow%3A%20%22fffafa%22%2C%0A%20%20springgreen%3A%20%2200ff7f%22%2C%0A%20%20steelblue%3A%20%224682b4%22%2C%0A%20%20tan%3A%20%22d2b48c%22%2C%0A%20%20teal%3A%20%22008080%22%2C%0A%20%20thistle%3A%20%22d8bfd8%22%2C%0A%20%20tomato%3A%20%22ff6347%22%2C%0A%20%20turquoise%3A%20%2240e0d0%22%2C%0A%20%20violet%3A%20%22ee82ee%22%2C%0A%20%20wheat%3A%20%22f5deb3%22%2C%0A%20%20white%3A%20%22fff%22%2C%0A%20%20whitesmoke%3A%20%22f5f5f5%22%2C%0A%20%20yellow%3A%20%22ff0%22%2C%0A%20%20yellowgreen%3A%20%229acd32%22%0A%7D%3B%0Afunction%20nameToHex%28color2%29%20%7B%0A%20%20if%20%28typeof%20color2%20%21%3D%3D%20%22string%22%29%20return%20color2%3B%0A%20%20var%20normalizedColorName%20%3D%20color2.toLowerCase%28%29%3B%0A%20%20return%20namedColorMap%5BnormalizedColorName%5D%20%3F%20%22%23%22%20%2B%20namedColorMap%5BnormalizedColorName%5D%20%3A%20color2%3B%0A%7D%0Avar%20hexRegex%20%3D%20%2F%5E%23%5Ba-fA-F0-9%5D%7B6%7D%24%2F%3B%0Avar%20hexRgbaRegex%20%3D%20%2F%5E%23%5Ba-fA-F0-9%5D%7B8%7D%24%2F%3B%0Avar%20reducedHexRegex%20%3D%20%2F%5E%23%5Ba-fA-F0-9%5D%7B3%7D%24%2F%3B%0Avar%20reducedRgbaHexRegex%20%3D%20%2F%5E%23%5Ba-fA-F0-9%5D%7B4%7D%24%2F%3B%0Avar%20rgbRegex%20%3D%20%2F%5Ergb%5C%28%5Cs%2A%28%5Cd%7B1%2C3%7D%29%5Cs%2A%28%3F%3A%2C%29%3F%5Cs%2A%28%5Cd%7B1%2C3%7D%29%5Cs%2A%28%3F%3A%2C%29%3F%5Cs%2A%28%5Cd%7B1%2C3%7D%29%5Cs%2A%5C%29%24%2Fi%3B%0Avar%20rgbaRegex%20%3D%20%2F%5Ergb%28%3F%3Aa%29%3F%5C%28%5Cs%2A%28%5Cd%7B1%2C3%7D%29%5Cs%2A%28%3F%3A%2C%29%3F%5Cs%2A%28%5Cd%7B1%2C3%7D%29%5Cs%2A%28%3F%3A%2C%29%3F%5Cs%2A%28%5Cd%7B1%2C3%7D%29%5Cs%2A%28%3F%3A%2C%7C%5C%2F%29%5Cs%2A%28%5B-%2B%5D%3F%5Cd%2A%5B.%5D%3F%5Cd%2B%5B%25%5D%3F%29%5Cs%2A%5C%29%24%2Fi%3B%0Avar%20hslRegex%20%3D%20%2F%5Ehsl%5C%28%5Cs%2A%28%5Cd%7B0%2C3%7D%5B.%5D%3F%5B0-9%5D%2B%28%3F%3Adeg%29%3F%29%5Cs%2A%28%3F%3A%2C%29%3F%5Cs%2A%28%5Cd%7B1%2C3%7D%5B.%5D%3F%5B0-9%5D%3F%29%25%5Cs%2A%28%3F%3A%2C%29%3F%5Cs%2A%28%5Cd%7B1%2C3%7D%5B.%5D%3F%5B0-9%5D%3F%29%25%5Cs%2A%5C%29%24%2Fi%3B%0Avar%20hslaRegex%20%3D%20%2F%5Ehsl%28%3F%3Aa%29%3F%5C%28%5Cs%2A%28%5Cd%7B0%2C3%7D%5B.%5D%3F%5B0-9%5D%2B%28%3F%3Adeg%29%3F%29%5Cs%2A%28%3F%3A%2C%29%3F%5Cs%2A%28%5Cd%7B1%2C3%7D%5B.%5D%3F%5B0-9%5D%3F%29%25%5Cs%2A%28%3F%3A%2C%29%3F%5Cs%2A%28%5Cd%7B1%2C3%7D%5B.%5D%3F%5B0-9%5D%3F%29%25%5Cs%2A%28%3F%3A%2C%7C%5C%2F%29%5Cs%2A%28%5B-%2B%5D%3F%5Cd%2A%5B.%5D%3F%5Cd%2B%5B%25%5D%3F%29%5Cs%2A%5C%29%24%2Fi%3B%0Afunction%20parseToRgb%28color2%29%20%7B%0A%20%20if%20%28typeof%20color2%20%21%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20throw%20new%20PolishedError%283%29%3B%0A%20%20%7D%0A%20%20var%20normalizedColor%20%3D%20nameToHex%28color2%29%3B%0A%20%20if%20%28normalizedColor.match%28hexRegex%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20red%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B1%5D%20%2B%20normalizedColor%5B2%5D%2C%2016%29%2C%0A%20%20%20%20%20%20green%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B3%5D%20%2B%20normalizedColor%5B4%5D%2C%2016%29%2C%0A%20%20%20%20%20%20blue%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B5%5D%20%2B%20normalizedColor%5B6%5D%2C%2016%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28normalizedColor.match%28hexRgbaRegex%29%29%20%7B%0A%20%20%20%20var%20alpha%20%3D%20parseFloat%28%28parseInt%28%22%22%20%2B%20normalizedColor%5B7%5D%20%2B%20normalizedColor%5B8%5D%2C%2016%29%20%2F%20255%29.toFixed%282%29%29%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20red%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B1%5D%20%2B%20normalizedColor%5B2%5D%2C%2016%29%2C%0A%20%20%20%20%20%20green%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B3%5D%20%2B%20normalizedColor%5B4%5D%2C%2016%29%2C%0A%20%20%20%20%20%20blue%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B5%5D%20%2B%20normalizedColor%5B6%5D%2C%2016%29%2C%0A%20%20%20%20%20%20alpha%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28normalizedColor.match%28reducedHexRegex%29%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20red%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B1%5D%20%2B%20normalizedColor%5B1%5D%2C%2016%29%2C%0A%20%20%20%20%20%20green%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B2%5D%20%2B%20normalizedColor%5B2%5D%2C%2016%29%2C%0A%20%20%20%20%20%20blue%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B3%5D%20%2B%20normalizedColor%5B3%5D%2C%2016%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20if%20%28normalizedColor.match%28reducedRgbaHexRegex%29%29%20%7B%0A%20%20%20%20var%20_alpha%20%3D%20parseFloat%28%28parseInt%28%22%22%20%2B%20normalizedColor%5B4%5D%20%2B%20normalizedColor%5B4%5D%2C%2016%29%20%2F%20255%29.toFixed%282%29%29%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20red%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B1%5D%20%2B%20normalizedColor%5B1%5D%2C%2016%29%2C%0A%20%20%20%20%20%20green%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B2%5D%20%2B%20normalizedColor%5B2%5D%2C%2016%29%2C%0A%20%20%20%20%20%20blue%3A%20parseInt%28%22%22%20%2B%20normalizedColor%5B3%5D%20%2B%20normalizedColor%5B3%5D%2C%2016%29%2C%0A%20%20%20%20%20%20alpha%3A%20_alpha%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20var%20rgbMatched%20%3D%20rgbRegex.exec%28normalizedColor%29%3B%0A%20%20if%20%28rgbMatched%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20red%3A%20parseInt%28%22%22%20%2B%20rgbMatched%5B1%5D%2C%2010%29%2C%0A%20%20%20%20%20%20green%3A%20parseInt%28%22%22%20%2B%20rgbMatched%5B2%5D%2C%2010%29%2C%0A%20%20%20%20%20%20blue%3A%20parseInt%28%22%22%20%2B%20rgbMatched%5B3%5D%2C%2010%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20var%20rgbaMatched%20%3D%20rgbaRegex.exec%28normalizedColor.substring%280%2C%2050%29%29%3B%0A%20%20if%20%28rgbaMatched%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20red%3A%20parseInt%28%22%22%20%2B%20rgbaMatched%5B1%5D%2C%2010%29%2C%0A%20%20%20%20%20%20green%3A%20parseInt%28%22%22%20%2B%20rgbaMatched%5B2%5D%2C%2010%29%2C%0A%20%20%20%20%20%20blue%3A%20parseInt%28%22%22%20%2B%20rgbaMatched%5B3%5D%2C%2010%29%2C%0A%20%20%20%20%20%20alpha%3A%20parseFloat%28%22%22%20%2B%20rgbaMatched%5B4%5D%29%20%3E%201%20%3F%20parseFloat%28%22%22%20%2B%20rgbaMatched%5B4%5D%29%20%2F%20100%20%3A%20parseFloat%28%22%22%20%2B%20rgbaMatched%5B4%5D%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20var%20hslMatched%20%3D%20hslRegex.exec%28normalizedColor%29%3B%0A%20%20if%20%28hslMatched%29%20%7B%0A%20%20%20%20var%20hue%20%3D%20parseInt%28%22%22%20%2B%20hslMatched%5B1%5D%2C%2010%29%3B%0A%20%20%20%20var%20saturation%20%3D%20parseInt%28%22%22%20%2B%20hslMatched%5B2%5D%2C%2010%29%20%2F%20100%3B%0A%20%20%20%20var%20lightness%20%3D%20parseInt%28%22%22%20%2B%20hslMatched%5B3%5D%2C%2010%29%20%2F%20100%3B%0A%20%20%20%20var%20rgbColorString%20%3D%20%22rgb%28%22%20%2B%20hslToRgb2%28hue%2C%20saturation%2C%20lightness%29%20%2B%20%22%29%22%3B%0A%20%20%20%20var%20hslRgbMatched%20%3D%20rgbRegex.exec%28rgbColorString%29%3B%0A%20%20%20%20if%20%28%21hslRgbMatched%29%20%7B%0A%20%20%20%20%20%20throw%20new%20PolishedError%284%2C%20normalizedColor%2C%20rgbColorString%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20red%3A%20parseInt%28%22%22%20%2B%20hslRgbMatched%5B1%5D%2C%2010%29%2C%0A%20%20%20%20%20%20green%3A%20parseInt%28%22%22%20%2B%20hslRgbMatched%5B2%5D%2C%2010%29%2C%0A%20%20%20%20%20%20blue%3A%20parseInt%28%22%22%20%2B%20hslRgbMatched%5B3%5D%2C%2010%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20var%20hslaMatched%20%3D%20hslaRegex.exec%28normalizedColor.substring%280%2C%2050%29%29%3B%0A%20%20if%20%28hslaMatched%29%20%7B%0A%20%20%20%20var%20_hue%20%3D%20parseInt%28%22%22%20%2B%20hslaMatched%5B1%5D%2C%2010%29%3B%0A%20%20%20%20var%20_saturation%20%3D%20parseInt%28%22%22%20%2B%20hslaMatched%5B2%5D%2C%2010%29%20%2F%20100%3B%0A%20%20%20%20var%20_lightness%20%3D%20parseInt%28%22%22%20%2B%20hslaMatched%5B3%5D%2C%2010%29%20%2F%20100%3B%0A%20%20%20%20var%20_rgbColorString%20%3D%20%22rgb%28%22%20%2B%20hslToRgb2%28_hue%2C%20_saturation%2C%20_lightness%29%20%2B%20%22%29%22%3B%0A%20%20%20%20var%20_hslRgbMatched%20%3D%20rgbRegex.exec%28_rgbColorString%29%3B%0A%20%20%20%20if%20%28%21_hslRgbMatched%29%20%7B%0A%20%20%20%20%20%20throw%20new%20PolishedError%284%2C%20normalizedColor%2C%20_rgbColorString%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20red%3A%20parseInt%28%22%22%20%2B%20_hslRgbMatched%5B1%5D%2C%2010%29%2C%0A%20%20%20%20%20%20green%3A%20parseInt%28%22%22%20%2B%20_hslRgbMatched%5B2%5D%2C%2010%29%2C%0A%20%20%20%20%20%20blue%3A%20parseInt%28%22%22%20%2B%20_hslRgbMatched%5B3%5D%2C%2010%29%2C%0A%20%20%20%20%20%20alpha%3A%20parseFloat%28%22%22%20%2B%20hslaMatched%5B4%5D%29%20%3E%201%20%3F%20parseFloat%28%22%22%20%2B%20hslaMatched%5B4%5D%29%20%2F%20100%20%3A%20parseFloat%28%22%22%20%2B%20hslaMatched%5B4%5D%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20throw%20new%20PolishedError%285%29%3B%0A%7D%0Afunction%20rgbToHsl2%28color2%29%20%7B%0A%20%20var%20red%20%3D%20color2.red%20%2F%20255%3B%0A%20%20var%20green%20%3D%20color2.green%20%2F%20255%3B%0A%20%20var%20blue%20%3D%20color2.blue%20%2F%20255%3B%0A%20%20var%20max2%20%3D%20Math.max%28red%2C%20green%2C%20blue%29%3B%0A%20%20var%20min2%20%3D%20Math.min%28red%2C%20green%2C%20blue%29%3B%0A%20%20var%20lightness%20%3D%20%28max2%20%2B%20min2%29%20%2F%202%3B%0A%20%20if%20%28max2%20%3D%3D%3D%20min2%29%20%7B%0A%20%20%20%20if%20%28color2.alpha%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20hue%3A%200%2C%0A%20%20%20%20%20%20%20%20saturation%3A%200%2C%0A%20%20%20%20%20%20%20%20lightness%2C%0A%20%20%20%20%20%20%20%20alpha%3A%20color2.alpha%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20hue%3A%200%2C%0A%20%20%20%20%20%20%20%20saturation%3A%200%2C%0A%20%20%20%20%20%20%20%20lightness%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20var%20hue%3B%0A%20%20var%20delta%20%3D%20max2%20-%20min2%3B%0A%20%20var%20saturation%20%3D%20lightness%20%3E%200.5%20%3F%20delta%20%2F%20%282%20-%20max2%20-%20min2%29%20%3A%20delta%20%2F%20%28max2%20%2B%20min2%29%3B%0A%20%20switch%20%28max2%29%20%7B%0A%20%20%20%20case%20red%3A%0A%20%20%20%20%20%20hue%20%3D%20%28green%20-%20blue%29%20%2F%20delta%20%2B%20%28green%20%3C%20blue%20%3F%206%20%3A%200%29%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20case%20green%3A%0A%20%20%20%20%20%20hue%20%3D%20%28blue%20-%20red%29%20%2F%20delta%20%2B%202%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%20%20default%3A%0A%20%20%20%20%20%20hue%20%3D%20%28red%20-%20green%29%20%2F%20delta%20%2B%204%3B%0A%20%20%20%20%20%20break%3B%0A%20%20%7D%0A%20%20hue%20%2A%3D%2060%3B%0A%20%20if%20%28color2.alpha%20%21%3D%3D%20void%200%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20hue%2C%0A%20%20%20%20%20%20saturation%2C%0A%20%20%20%20%20%20lightness%2C%0A%20%20%20%20%20%20alpha%3A%20color2.alpha%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%20%20return%20%7B%0A%20%20%20%20hue%2C%0A%20%20%20%20saturation%2C%0A%20%20%20%20lightness%0A%20%20%7D%3B%0A%7D%0Afunction%20parseToHsl%28color2%29%20%7B%0A%20%20return%20rgbToHsl2%28parseToRgb%28color2%29%29%3B%0A%7D%0Avar%20reduceHexValue%20%3D%20function%20reduceHexValue2%28value%29%20%7B%0A%20%20if%20%28value.length%20%3D%3D%3D%207%20%26%26%20value%5B1%5D%20%3D%3D%3D%20value%5B2%5D%20%26%26%20value%5B3%5D%20%3D%3D%3D%20value%5B4%5D%20%26%26%20value%5B5%5D%20%3D%3D%3D%20value%5B6%5D%29%20%7B%0A%20%20%20%20return%20%22%23%22%20%2B%20value%5B1%5D%20%2B%20value%5B3%5D%20%2B%20value%5B5%5D%3B%0A%20%20%7D%0A%20%20return%20value%3B%0A%7D%3B%0Avar%20reduceHexValue%241%20%3D%20reduceHexValue%3B%0Afunction%20numberToHex%28value%29%20%7B%0A%20%20var%20hex%20%3D%20value.toString%2816%29%3B%0A%20%20return%20hex.length%20%3D%3D%3D%201%20%3F%20%220%22%20%2B%20hex%20%3A%20hex%3B%0A%7D%0Afunction%20colorToHex%28color2%29%20%7B%0A%20%20return%20numberToHex%28Math.round%28color2%20%2A%20255%29%29%3B%0A%7D%0Afunction%20convertToHex%28red%2C%20green%2C%20blue%29%20%7B%0A%20%20return%20reduceHexValue%241%28%22%23%22%20%2B%20colorToHex%28red%29%20%2B%20colorToHex%28green%29%20%2B%20colorToHex%28blue%29%29%3B%0A%7D%0Afunction%20hslToHex%28hue%2C%20saturation%2C%20lightness%29%20%7B%0A%20%20return%20hslToRgb2%28hue%2C%20saturation%2C%20lightness%2C%20convertToHex%29%3B%0A%7D%0Afunction%20hsl%28value%2C%20saturation%2C%20lightness%29%20%7B%0A%20%20if%20%28typeof%20value%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20saturation%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20lightness%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20return%20hslToHex%28value%2C%20saturation%2C%20lightness%29%3B%0A%20%20%7D%20else%20if%20%28typeof%20value%20%3D%3D%3D%20%22object%22%20%26%26%20saturation%20%3D%3D%3D%20void%200%20%26%26%20lightness%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20return%20hslToHex%28value.hue%2C%20value.saturation%2C%20value.lightness%29%3B%0A%20%20%7D%0A%20%20throw%20new%20PolishedError%281%29%3B%0A%7D%0Afunction%20hsla%28value%2C%20saturation%2C%20lightness%2C%20alpha%29%20%7B%0A%20%20if%20%28typeof%20value%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20saturation%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20lightness%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20alpha%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20return%20alpha%20%3E%3D%201%20%3F%20hslToHex%28value%2C%20saturation%2C%20lightness%29%20%3A%20%22rgba%28%22%20%2B%20hslToRgb2%28value%2C%20saturation%2C%20lightness%29%20%2B%20%22%2C%22%20%2B%20alpha%20%2B%20%22%29%22%3B%0A%20%20%7D%20else%20if%20%28typeof%20value%20%3D%3D%3D%20%22object%22%20%26%26%20saturation%20%3D%3D%3D%20void%200%20%26%26%20lightness%20%3D%3D%3D%20void%200%20%26%26%20alpha%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20return%20value.alpha%20%3E%3D%201%20%3F%20hslToHex%28value.hue%2C%20value.saturation%2C%20value.lightness%29%20%3A%20%22rgba%28%22%20%2B%20hslToRgb2%28value.hue%2C%20value.saturation%2C%20value.lightness%29%20%2B%20%22%2C%22%20%2B%20value.alpha%20%2B%20%22%29%22%3B%0A%20%20%7D%0A%20%20throw%20new%20PolishedError%282%29%3B%0A%7D%0Afunction%20rgb%28value%2C%20green%2C%20blue%29%20%7B%0A%20%20if%20%28typeof%20value%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20green%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20blue%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20return%20reduceHexValue%241%28%22%23%22%20%2B%20numberToHex%28value%29%20%2B%20numberToHex%28green%29%20%2B%20numberToHex%28blue%29%29%3B%0A%20%20%7D%20else%20if%20%28typeof%20value%20%3D%3D%3D%20%22object%22%20%26%26%20green%20%3D%3D%3D%20void%200%20%26%26%20blue%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20return%20reduceHexValue%241%28%22%23%22%20%2B%20numberToHex%28value.red%29%20%2B%20numberToHex%28value.green%29%20%2B%20numberToHex%28value.blue%29%29%3B%0A%20%20%7D%0A%20%20throw%20new%20PolishedError%286%29%3B%0A%7D%0Afunction%20rgba%28firstValue%2C%20secondValue%2C%20thirdValue%2C%20fourthValue%29%20%7B%0A%20%20if%20%28typeof%20firstValue%20%3D%3D%3D%20%22string%22%20%26%26%20typeof%20secondValue%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20var%20rgbValue%20%3D%20parseToRgb%28firstValue%29%3B%0A%20%20%20%20return%20%22rgba%28%22%20%2B%20rgbValue.red%20%2B%20%22%2C%22%20%2B%20rgbValue.green%20%2B%20%22%2C%22%20%2B%20rgbValue.blue%20%2B%20%22%2C%22%20%2B%20secondValue%20%2B%20%22%29%22%3B%0A%20%20%7D%20else%20if%20%28typeof%20firstValue%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20secondValue%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20thirdValue%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20fourthValue%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20return%20fourthValue%20%3E%3D%201%20%3F%20rgb%28firstValue%2C%20secondValue%2C%20thirdValue%29%20%3A%20%22rgba%28%22%20%2B%20firstValue%20%2B%20%22%2C%22%20%2B%20secondValue%20%2B%20%22%2C%22%20%2B%20thirdValue%20%2B%20%22%2C%22%20%2B%20fourthValue%20%2B%20%22%29%22%3B%0A%20%20%7D%20else%20if%20%28typeof%20firstValue%20%3D%3D%3D%20%22object%22%20%26%26%20secondValue%20%3D%3D%3D%20void%200%20%26%26%20thirdValue%20%3D%3D%3D%20void%200%20%26%26%20fourthValue%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20return%20firstValue.alpha%20%3E%3D%201%20%3F%20rgb%28firstValue.red%2C%20firstValue.green%2C%20firstValue.blue%29%20%3A%20%22rgba%28%22%20%2B%20firstValue.red%20%2B%20%22%2C%22%20%2B%20firstValue.green%20%2B%20%22%2C%22%20%2B%20firstValue.blue%20%2B%20%22%2C%22%20%2B%20firstValue.alpha%20%2B%20%22%29%22%3B%0A%20%20%7D%0A%20%20throw%20new%20PolishedError%287%29%3B%0A%7D%0Avar%20isRgb%20%3D%20function%20isRgb2%28color2%29%20%7B%0A%20%20return%20typeof%20color2.red%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.green%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.blue%20%3D%3D%3D%20%22number%22%20%26%26%20%28typeof%20color2.alpha%20%21%3D%3D%20%22number%22%20%7C%7C%20typeof%20color2.alpha%20%3D%3D%3D%20%22undefined%22%29%3B%0A%7D%3B%0Avar%20isRgba%20%3D%20function%20isRgba2%28color2%29%20%7B%0A%20%20return%20typeof%20color2.red%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.green%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.blue%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.alpha%20%3D%3D%3D%20%22number%22%3B%0A%7D%3B%0Avar%20isHsl%20%3D%20function%20isHsl2%28color2%29%20%7B%0A%20%20return%20typeof%20color2.hue%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.saturation%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.lightness%20%3D%3D%3D%20%22number%22%20%26%26%20%28typeof%20color2.alpha%20%21%3D%3D%20%22number%22%20%7C%7C%20typeof%20color2.alpha%20%3D%3D%3D%20%22undefined%22%29%3B%0A%7D%3B%0Avar%20isHsla%20%3D%20function%20isHsla2%28color2%29%20%7B%0A%20%20return%20typeof%20color2.hue%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.saturation%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.lightness%20%3D%3D%3D%20%22number%22%20%26%26%20typeof%20color2.alpha%20%3D%3D%3D%20%22number%22%3B%0A%7D%3B%0Afunction%20toColorString%28color2%29%20%7B%0A%20%20if%20%28typeof%20color2%20%21%3D%3D%20%22object%22%29%20throw%20new%20PolishedError%288%29%3B%0A%20%20if%20%28isRgba%28color2%29%29%20return%20rgba%28color2%29%3B%0A%20%20if%20%28isRgb%28color2%29%29%20return%20rgb%28color2%29%3B%0A%20%20if%20%28isHsla%28color2%29%29%20return%20hsla%28color2%29%3B%0A%20%20if%20%28isHsl%28color2%29%29%20return%20hsl%28color2%29%3B%0A%20%20throw%20new%20PolishedError%288%29%3B%0A%7D%0Afunction%20curried%28f%2C%20length2%2C%20acc%29%20%7B%0A%20%20return%20function%20fn%28%29%20%7B%0A%20%20%20%20var%20combined%20%3D%20acc.concat%28Array.prototype.slice.call%28arguments%29%29%3B%0A%20%20%20%20return%20combined.length%20%3E%3D%20length2%20%3F%20f.apply%28this%2C%20combined%29%20%3A%20curried%28f%2C%20length2%2C%20combined%29%3B%0A%20%20%7D%3B%0A%7D%0Afunction%20curry%28f%29%20%7B%0A%20%20return%20curried%28f%2C%20f.length%2C%20%5B%5D%29%3B%0A%7D%0Afunction%20adjustHue%28degree%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20var%20hslColor%20%3D%20parseToHsl%28color2%29%3B%0A%20%20return%20toColorString%28_extends%28%7B%7D%2C%20hslColor%2C%20%7B%0A%20%20%20%20hue%3A%20hslColor.hue%20%2B%20parseFloat%28degree%29%0A%20%20%7D%29%29%3B%0A%7D%0Avar%20curriedAdjustHue%20%3D%20curry%28adjustHue%29%3B%0Afunction%20guard%28lowerBoundary%2C%20upperBoundary%2C%20value%29%20%7B%0A%20%20return%20Math.max%28lowerBoundary%2C%20Math.min%28upperBoundary%2C%20value%29%29%3B%0A%7D%0Afunction%20darken2%28amount%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20var%20hslColor%20%3D%20parseToHsl%28color2%29%3B%0A%20%20return%20toColorString%28_extends%28%7B%7D%2C%20hslColor%2C%20%7B%0A%20%20%20%20lightness%3A%20guard%280%2C%201%2C%20hslColor.lightness%20-%20parseFloat%28amount%29%29%0A%20%20%7D%29%29%3B%0A%7D%0Avar%20curriedDarken%20%3D%20curry%28darken2%29%3B%0Afunction%20desaturate2%28amount%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20var%20hslColor%20%3D%20parseToHsl%28color2%29%3B%0A%20%20return%20toColorString%28_extends%28%7B%7D%2C%20hslColor%2C%20%7B%0A%20%20%20%20saturation%3A%20guard%280%2C%201%2C%20hslColor.saturation%20-%20parseFloat%28amount%29%29%0A%20%20%7D%29%29%3B%0A%7D%0Avar%20curriedDesaturate%20%3D%20curry%28desaturate2%29%3B%0Afunction%20lighten2%28amount%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20var%20hslColor%20%3D%20parseToHsl%28color2%29%3B%0A%20%20return%20toColorString%28_extends%28%7B%7D%2C%20hslColor%2C%20%7B%0A%20%20%20%20lightness%3A%20guard%280%2C%201%2C%20hslColor.lightness%20%2B%20parseFloat%28amount%29%29%0A%20%20%7D%29%29%3B%0A%7D%0Avar%20curriedLighten%20%3D%20curry%28lighten2%29%3B%0Afunction%20mix2%28weight%2C%20color2%2C%20otherColor%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20otherColor%3B%0A%20%20if%20%28otherColor%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20if%20%28weight%20%3D%3D%3D%200%29%20return%20otherColor%3B%0A%20%20var%20parsedColor1%20%3D%20parseToRgb%28color2%29%3B%0A%20%20var%20color1%20%3D%20_extends%28%7B%7D%2C%20parsedColor1%2C%20%7B%0A%20%20%20%20alpha%3A%20typeof%20parsedColor1.alpha%20%3D%3D%3D%20%22number%22%20%3F%20parsedColor1.alpha%20%3A%201%0A%20%20%7D%29%3B%0A%20%20var%20parsedColor2%20%3D%20parseToRgb%28otherColor%29%3B%0A%20%20var%20color22%20%3D%20_extends%28%7B%7D%2C%20parsedColor2%2C%20%7B%0A%20%20%20%20alpha%3A%20typeof%20parsedColor2.alpha%20%3D%3D%3D%20%22number%22%20%3F%20parsedColor2.alpha%20%3A%201%0A%20%20%7D%29%3B%0A%20%20var%20alphaDelta%20%3D%20color1.alpha%20-%20color22.alpha%3B%0A%20%20var%20x2%20%3D%20parseFloat%28weight%29%20%2A%202%20-%201%3B%0A%20%20var%20y2%20%3D%20x2%20%2A%20alphaDelta%20%3D%3D%3D%20-1%20%3F%20x2%20%3A%20x2%20%2B%20alphaDelta%3B%0A%20%20var%20z2%20%3D%201%20%2B%20x2%20%2A%20alphaDelta%3B%0A%20%20var%20weight1%20%3D%20%28y2%20%2F%20z2%20%2B%201%29%20%2F%202%3B%0A%20%20var%20weight2%20%3D%201%20-%20weight1%3B%0A%20%20var%20mixedColor%20%3D%20%7B%0A%20%20%20%20red%3A%20Math.floor%28color1.red%20%2A%20weight1%20%2B%20color22.red%20%2A%20weight2%29%2C%0A%20%20%20%20green%3A%20Math.floor%28color1.green%20%2A%20weight1%20%2B%20color22.green%20%2A%20weight2%29%2C%0A%20%20%20%20blue%3A%20Math.floor%28color1.blue%20%2A%20weight1%20%2B%20color22.blue%20%2A%20weight2%29%2C%0A%20%20%20%20alpha%3A%20color1.alpha%20%2A%20parseFloat%28weight%29%20%2B%20color22.alpha%20%2A%20%281%20-%20parseFloat%28weight%29%29%0A%20%20%7D%3B%0A%20%20return%20rgba%28mixedColor%29%3B%0A%7D%0Avar%20curriedMix%20%3D%20curry%28mix2%29%3B%0Avar%20mix%241%20%3D%20curriedMix%3B%0Afunction%20opacify%28amount%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20var%20parsedColor%20%3D%20parseToRgb%28color2%29%3B%0A%20%20var%20alpha%20%3D%20typeof%20parsedColor.alpha%20%3D%3D%3D%20%22number%22%20%3F%20parsedColor.alpha%20%3A%201%3B%0A%20%20var%20colorWithAlpha%20%3D%20_extends%28%7B%7D%2C%20parsedColor%2C%20%7B%0A%20%20%20%20alpha%3A%20guard%280%2C%201%2C%20%28alpha%20%2A%20100%20%2B%20parseFloat%28amount%29%20%2A%20100%29%20%2F%20100%29%0A%20%20%7D%29%3B%0A%20%20return%20rgba%28colorWithAlpha%29%3B%0A%7D%0Avar%20curriedOpacify%20%3D%20curry%28opacify%29%3B%0Avar%20curriedOpacify%241%20%3D%20curriedOpacify%3B%0Afunction%20saturate3%28amount%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20var%20hslColor%20%3D%20parseToHsl%28color2%29%3B%0A%20%20return%20toColorString%28_extends%28%7B%7D%2C%20hslColor%2C%20%7B%0A%20%20%20%20saturation%3A%20guard%280%2C%201%2C%20hslColor.saturation%20%2B%20parseFloat%28amount%29%29%0A%20%20%7D%29%29%3B%0A%7D%0Avar%20curriedSaturate%20%3D%20curry%28saturate3%29%3B%0Afunction%20setHue%28hue%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20return%20toColorString%28_extends%28%7B%7D%2C%20parseToHsl%28color2%29%2C%20%7B%0A%20%20%20%20hue%3A%20parseFloat%28hue%29%0A%20%20%7D%29%29%3B%0A%7D%0Avar%20curriedSetHue%20%3D%20curry%28setHue%29%3B%0Afunction%20setLightness%28lightness%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20return%20toColorString%28_extends%28%7B%7D%2C%20parseToHsl%28color2%29%2C%20%7B%0A%20%20%20%20lightness%3A%20parseFloat%28lightness%29%0A%20%20%7D%29%29%3B%0A%7D%0Avar%20curriedSetLightness%20%3D%20curry%28setLightness%29%3B%0Afunction%20setSaturation%28saturation%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20return%20toColorString%28_extends%28%7B%7D%2C%20parseToHsl%28color2%29%2C%20%7B%0A%20%20%20%20saturation%3A%20parseFloat%28saturation%29%0A%20%20%7D%29%29%3B%0A%7D%0Avar%20curriedSetSaturation%20%3D%20curry%28setSaturation%29%3B%0Afunction%20shade%28percentage%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20return%20mix%241%28parseFloat%28percentage%29%2C%20%22rgb%280%2C%200%2C%200%29%22%2C%20color2%29%3B%0A%7D%0Avar%20curriedShade%20%3D%20curry%28shade%29%3B%0Afunction%20tint%28percentage%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20return%20mix%241%28parseFloat%28percentage%29%2C%20%22rgb%28255%2C%20255%2C%20255%29%22%2C%20color2%29%3B%0A%7D%0Avar%20curriedTint%20%3D%20curry%28tint%29%3B%0Afunction%20transparentize%28amount%2C%20color2%29%20%7B%0A%20%20if%20%28color2%20%3D%3D%3D%20%22transparent%22%29%20return%20color2%3B%0A%20%20var%20parsedColor%20%3D%20parseToRgb%28color2%29%3B%0A%20%20var%20alpha%20%3D%20typeof%20parsedColor.alpha%20%3D%3D%3D%20%22number%22%20%3F%20parsedColor.alpha%20%3A%201%3B%0A%20%20var%20colorWithAlpha%20%3D%20_extends%28%7B%7D%2C%20parsedColor%2C%20%7B%0A%20%20%20%20alpha%3A%20guard%280%2C%201%2C%20%2B%28alpha%20%2A%20100%20-%20parseFloat%28amount%29%20%2A%20100%29.toFixed%282%29%20%2F%20100%29%0A%20%20%7D%29%3B%0A%20%20return%20rgba%28colorWithAlpha%29%3B%0A%7D%0Avar%20curriedTransparentize%20%3D%20curry%28transparentize%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F%40tweenjs%2Ftween.js%2Fdist%2Ftween.esm.js%0Avar%20Easing%20%3D%20Object.freeze%28%7B%0A%20%20Linear%3A%20Object.freeze%28%7B%0A%20%20%20%20None%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Quadratic%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%20%2A%20amount%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%20%2A%20%282%20-%20amount%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28%28amount%20%2A%3D%202%29%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%200.5%20%2A%20amount%20%2A%20amount%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20-0.5%20%2A%20%28--amount%20%2A%20%28amount%20-%202%29%20-%201%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Cubic%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%20%2A%20amount%20%2A%20amount%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20--amount%20%2A%20amount%20%2A%20amount%20%2B%201%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28%28amount%20%2A%3D%202%29%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%200.5%20%2A%20amount%20%2A%20amount%20%2A%20amount%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%200.5%20%2A%20%28%28amount%20-%3D%202%29%20%2A%20amount%20%2A%20amount%20%2B%202%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Quartic%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%201%20-%20--amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28%28amount%20%2A%3D%202%29%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%200.5%20%2A%20amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20-0.5%20%2A%20%28%28amount%20-%3D%202%29%20%2A%20amount%20%2A%20amount%20%2A%20amount%20-%202%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Quintic%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20--amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%20%2B%201%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28%28amount%20%2A%3D%202%29%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%200.5%20%2A%20amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%200.5%20%2A%20%28%28amount%20-%3D%202%29%20%2A%20amount%20%2A%20amount%20%2A%20amount%20%2A%20amount%20%2B%202%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Sinusoidal%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%201%20-%20Math.sin%28%281%20-%20amount%29%20%2A%20Math.PI%20%2F%202%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20Math.sin%28amount%20%2A%20Math.PI%20%2F%202%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%200.5%20%2A%20%281%20-%20Math.sin%28Math.PI%20%2A%20%280.5%20-%20amount%29%29%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Exponential%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%20%3D%3D%3D%200%20%3F%200%20%3A%20Math.pow%281024%2C%20amount%20-%201%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20amount%20%3D%3D%3D%201%20%3F%201%20%3A%201%20-%20Math.pow%282%2C%20-10%20%2A%20amount%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28amount%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28amount%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28%28amount%20%2A%3D%202%29%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%200.5%20%2A%20Math.pow%281024%2C%20amount%20-%201%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%200.5%20%2A%20%28-Math.pow%282%2C%20-10%20%2A%20%28amount%20-%201%29%29%20%2B%202%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Circular%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%201%20-%20Math.sqrt%281%20-%20amount%20%2A%20amount%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%20Math.sqrt%281%20-%20--amount%20%2A%20amount%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28%28amount%20%2A%3D%202%29%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%20-0.5%20%2A%20%28Math.sqrt%281%20-%20amount%20%2A%20amount%29%20-%201%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%200.5%20%2A%20%28Math.sqrt%281%20-%20%28amount%20-%3D%202%29%20%2A%20amount%29%20%2B%201%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Elastic%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28amount%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28amount%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20-Math.pow%282%2C%2010%20%2A%20%28amount%20-%201%29%29%20%2A%20Math.sin%28%28amount%20-%201.1%29%20%2A%205%20%2A%20Math.PI%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28amount%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28amount%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20Math.pow%282%2C%20-10%20%2A%20amount%29%20%2A%20Math.sin%28%28amount%20-%200.1%29%20%2A%205%20%2A%20Math.PI%29%20%2B%201%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28amount%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28amount%20%3D%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20amount%20%2A%3D%202%3B%0A%20%20%20%20%20%20if%20%28amount%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%20-0.5%20%2A%20Math.pow%282%2C%2010%20%2A%20%28amount%20-%201%29%29%20%2A%20Math.sin%28%28amount%20-%201.1%29%20%2A%205%20%2A%20Math.PI%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%200.5%20%2A%20Math.pow%282%2C%20-10%20%2A%20%28amount%20-%201%29%29%20%2A%20Math.sin%28%28amount%20-%201.1%29%20%2A%205%20%2A%20Math.PI%29%20%2B%201%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Back%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20var%20s%20%3D%201.70158%3B%0A%20%20%20%20%20%20return%20amount%20%3D%3D%3D%201%20%3F%201%20%3A%20amount%20%2A%20amount%20%2A%20%28%28s%20%2B%201%29%20%2A%20amount%20-%20s%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20var%20s%20%3D%201.70158%3B%0A%20%20%20%20%20%20return%20amount%20%3D%3D%3D%200%20%3F%200%20%3A%20--amount%20%2A%20amount%20%2A%20%28%28s%20%2B%201%29%20%2A%20amount%20%2B%20s%29%20%2B%201%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20var%20s%20%3D%201.70158%20%2A%201.525%3B%0A%20%20%20%20%20%20if%20%28%28amount%20%2A%3D%202%29%20%3C%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%200.5%20%2A%20%28amount%20%2A%20amount%20%2A%20%28%28s%20%2B%201%29%20%2A%20amount%20-%20s%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%200.5%20%2A%20%28%28amount%20-%3D%202%29%20%2A%20amount%20%2A%20%28%28s%20%2B%201%29%20%2A%20amount%20%2B%20s%29%20%2B%202%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20Bounce%3A%20Object.freeze%28%7B%0A%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20return%201%20-%20Easing.Bounce.Out%281%20-%20amount%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28amount%20%3C%201%20%2F%202.75%29%20%7B%0A%20%20%20%20%20%20%20%20return%207.5625%20%2A%20amount%20%2A%20amount%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28amount%20%3C%202%20%2F%202.75%29%20%7B%0A%20%20%20%20%20%20%20%20return%207.5625%20%2A%20%28amount%20-%3D%201.5%20%2F%202.75%29%20%2A%20amount%20%2B%200.75%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28amount%20%3C%202.5%20%2F%202.75%29%20%7B%0A%20%20%20%20%20%20%20%20return%207.5625%20%2A%20%28amount%20-%3D%202.25%20%2F%202.75%29%20%2A%20amount%20%2B%200.9375%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%207.5625%20%2A%20%28amount%20-%3D%202.625%20%2F%202.75%29%20%2A%20amount%20%2B%200.984375%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28amount%20%3C%200.5%29%20%7B%0A%20%20%20%20%20%20%20%20return%20Easing.Bounce.In%28amount%20%2A%202%29%20%2A%200.5%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20Easing.Bounce.Out%28amount%20%2A%202%20-%201%29%20%2A%200.5%20%2B%200.5%3B%0A%20%20%20%20%7D%0A%20%20%7D%29%2C%0A%20%20generatePow%3A%20function%28power%29%20%7B%0A%20%20%20%20if%20%28power%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20power%20%3D%204%3B%0A%20%20%20%20%7D%0A%20%20%20%20power%20%3D%20power%20%3C%20Number.EPSILON%20%3F%20Number.EPSILON%20%3A%20power%3B%0A%20%20%20%20power%20%3D%20power%20%3E%201e4%20%3F%201e4%20%3A%20power%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20In%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20%20%20return%20Math.pow%28amount%2C%20power%29%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20Out%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20%20%20return%201%20-%20Math.pow%281%20-%20amount%2C%20power%29%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20InOut%3A%20function%28amount%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28amount%20%3C%200.5%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20Math.pow%28amount%20%2A%202%2C%20power%29%20%2F%202%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%281%20-%20Math.pow%282%20-%20amount%20%2A%202%2C%20power%29%29%20%2F%202%20%2B%200.5%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%29%3B%0Avar%20now4%20%3D%20function%28%29%20%7B%0A%20%20return%20performance.now%28%29%3B%0A%7D%3B%0Avar%20Group2%20%3D%20%28%0A%20%20%2F%2A%2A%20%40class%20%2A%2F%0A%20%20function%28%29%20%7B%0A%20%20%20%20function%20Group3%28%29%20%7B%0A%20%20%20%20%20%20var%20tweens%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28var%20_i%20%3D%200%3B%20_i%20%3C%20arguments.length%3B%20_i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20tweens%5B_i%5D%20%3D%20arguments%5B_i%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._tweens%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20this._tweensAddedDuringUpdate%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20this.add.apply%28this%2C%20tweens%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20Group3.prototype.getAll%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20_this%20%3D%20this%3B%0A%20%20%20%20%20%20return%20Object.keys%28this._tweens%29.map%28function%28tweenId%29%20%7B%0A%20%20%20%20%20%20%20%20return%20_this._tweens%5BtweenId%5D%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Group3.prototype.removeAll%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20this._tweens%20%3D%20%7B%7D%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Group3.prototype.add%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20_a%3B%0A%20%20%20%20%20%20var%20tweens%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28var%20_i%20%3D%200%3B%20_i%20%3C%20arguments.length%3B%20_i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20tweens%5B_i%5D%20%3D%20arguments%5B_i%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28var%20_b%20%3D%200%2C%20tweens_1%20%3D%20tweens%3B%20_b%20%3C%20tweens_1.length%3B%20_b%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20var%20tween%20%3D%20tweens_1%5B_b%5D%3B%0A%20%20%20%20%20%20%20%20%28_a%20%3D%20tween._group%29%20%3D%3D%3D%20null%20%7C%7C%20_a%20%3D%3D%3D%20void%200%20%3F%20void%200%20%3A%20_a.remove%28tween%29%3B%0A%20%20%20%20%20%20%20%20tween._group%20%3D%20this%3B%0A%20%20%20%20%20%20%20%20this._tweens%5Btween.getId%28%29%5D%20%3D%20tween%3B%0A%20%20%20%20%20%20%20%20this._tweensAddedDuringUpdate%5Btween.getId%28%29%5D%20%3D%20tween%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20Group3.prototype.remove%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20tweens%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28var%20_i%20%3D%200%3B%20_i%20%3C%20arguments.length%3B%20_i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20tweens%5B_i%5D%20%3D%20arguments%5B_i%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20for%20%28var%20_a%20%3D%200%2C%20tweens_2%20%3D%20tweens%3B%20_a%20%3C%20tweens_2.length%3B%20_a%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20var%20tween%20%3D%20tweens_2%5B_a%5D%3B%0A%20%20%20%20%20%20%20%20tween._group%20%3D%20void%200%3B%0A%20%20%20%20%20%20%20%20delete%20this._tweens%5Btween.getId%28%29%5D%3B%0A%20%20%20%20%20%20%20%20delete%20this._tweensAddedDuringUpdate%5Btween.getId%28%29%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20Group3.prototype.allStopped%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20this.getAll%28%29.every%28function%28tween%29%20%7B%0A%20%20%20%20%20%20%20%20return%20%21tween.isPlaying%28%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Group3.prototype.update%20%3D%20function%28time%2C%20preserve%29%20%7B%0A%20%20%20%20%20%20if%20%28time%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20time%20%3D%20now4%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28preserve%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20preserve%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20tweenIds%20%3D%20Object.keys%28this._tweens%29%3B%0A%20%20%20%20%20%20if%20%28tweenIds.length%20%3D%3D%3D%200%29%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20while%20%28tweenIds.length%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20this._tweensAddedDuringUpdate%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20tweenIds.length%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20tween%20%3D%20this._tweens%5BtweenIds%5Bi%5D%5D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20autoStart%20%3D%20%21preserve%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28tween%20%26%26%20tween.update%28time%2C%20autoStart%29%20%3D%3D%3D%20false%20%26%26%20%21preserve%29%0A%20%20%20%20%20%20%20%20%20%20%20%20this.remove%28tween%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20tweenIds%20%3D%20Object.keys%28this._tweensAddedDuringUpdate%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20return%20Group3%3B%0A%20%20%7D%28%29%0A%29%3B%0Avar%20Interpolation%20%3D%20%7B%0A%20%20Linear%3A%20function%28v%2C%20k%29%20%7B%0A%20%20%20%20var%20m2%20%3D%20v.length%20-%201%3B%0A%20%20%20%20var%20f%20%3D%20m2%20%2A%20k%3B%0A%20%20%20%20var%20i%20%3D%20Math.floor%28f%29%3B%0A%20%20%20%20var%20fn%20%3D%20Interpolation.Utils.Linear%3B%0A%20%20%20%20if%20%28k%20%3C%200%29%20%7B%0A%20%20%20%20%20%20return%20fn%28v%5B0%5D%2C%20v%5B1%5D%2C%20f%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28k%20%3E%201%29%20%7B%0A%20%20%20%20%20%20return%20fn%28v%5Bm2%5D%2C%20v%5Bm2%20-%201%5D%2C%20m2%20-%20f%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20fn%28v%5Bi%5D%2C%20v%5Bi%20%2B%201%20%3E%20m2%20%3F%20m2%20%3A%20i%20%2B%201%5D%2C%20f%20-%20i%29%3B%0A%20%20%7D%2C%0A%20%20Bezier%3A%20function%28v%2C%20k%29%20%7B%0A%20%20%20%20var%20b%20%3D%200%3B%0A%20%20%20%20var%20n%20%3D%20v.length%20-%201%3B%0A%20%20%20%20var%20pw%20%3D%20Math.pow%3B%0A%20%20%20%20var%20bn%20%3D%20Interpolation.Utils.Bernstein%3B%0A%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%3D%20n%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20b%20%2B%3D%20pw%281%20-%20k%2C%20n%20-%20i%29%20%2A%20pw%28k%2C%20i%29%20%2A%20v%5Bi%5D%20%2A%20bn%28n%2C%20i%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20b%3B%0A%20%20%7D%2C%0A%20%20CatmullRom%3A%20function%28v%2C%20k%29%20%7B%0A%20%20%20%20var%20m2%20%3D%20v.length%20-%201%3B%0A%20%20%20%20var%20f%20%3D%20m2%20%2A%20k%3B%0A%20%20%20%20var%20i%20%3D%20Math.floor%28f%29%3B%0A%20%20%20%20var%20fn%20%3D%20Interpolation.Utils.CatmullRom%3B%0A%20%20%20%20if%20%28v%5B0%5D%20%3D%3D%3D%20v%5Bm2%5D%29%20%7B%0A%20%20%20%20%20%20if%20%28k%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20i%20%3D%20Math.floor%28f%20%3D%20m2%20%2A%20%281%20%2B%20k%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20fn%28v%5B%28i%20-%201%20%2B%20m2%29%20%25%20m2%5D%2C%20v%5Bi%5D%2C%20v%5B%28i%20%2B%201%29%20%25%20m2%5D%2C%20v%5B%28i%20%2B%202%29%20%25%20m2%5D%2C%20f%20-%20i%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20if%20%28k%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20return%20v%5B0%5D%20-%20%28fn%28v%5B0%5D%2C%20v%5B0%5D%2C%20v%5B1%5D%2C%20v%5B1%5D%2C%20-f%29%20-%20v%5B0%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28k%20%3E%201%29%20%7B%0A%20%20%20%20%20%20%20%20return%20v%5Bm2%5D%20-%20%28fn%28v%5Bm2%5D%2C%20v%5Bm2%5D%2C%20v%5Bm2%20-%201%5D%2C%20v%5Bm2%20-%201%5D%2C%20f%20-%20m2%29%20-%20v%5Bm2%5D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20fn%28v%5Bi%20%3F%20i%20-%201%20%3A%200%5D%2C%20v%5Bi%5D%2C%20v%5Bm2%20%3C%20i%20%2B%201%20%3F%20m2%20%3A%20i%20%2B%201%5D%2C%20v%5Bm2%20%3C%20i%20%2B%202%20%3F%20m2%20%3A%20i%20%2B%202%5D%2C%20f%20-%20i%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20Utils%3A%20%7B%0A%20%20%20%20Linear%3A%20function%28p0%2C%20p1%2C%20t%29%20%7B%0A%20%20%20%20%20%20return%20%28p1%20-%20p0%29%20%2A%20t%20%2B%20p0%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Bernstein%3A%20function%28n%2C%20i%29%20%7B%0A%20%20%20%20%20%20var%20fc%20%3D%20Interpolation.Utils.Factorial%3B%0A%20%20%20%20%20%20return%20fc%28n%29%20%2F%20fc%28i%29%20%2F%20fc%28n%20-%20i%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20Factorial%3A%20%2F%2A%20%40__PURE__%20%2A%2F%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20a2%20%3D%20%5B1%5D%3B%0A%20%20%20%20%20%20return%20function%28n%29%20%7B%0A%20%20%20%20%20%20%20%20var%20s%20%3D%201%3B%0A%20%20%20%20%20%20%20%20if%20%28a2%5Bn%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20a2%5Bn%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%20n%3B%20i%20%3E%201%3B%20i--%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20s%20%2A%3D%20i%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20a2%5Bn%5D%20%3D%20s%3B%0A%20%20%20%20%20%20%20%20return%20s%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%28%29%2C%0A%20%20%20%20CatmullRom%3A%20function%28p0%2C%20p1%2C%20p2%2C%20p3%2C%20t%29%20%7B%0A%20%20%20%20%20%20var%20v0%20%3D%20%28p2%20-%20p0%29%20%2A%200.5%3B%0A%20%20%20%20%20%20var%20v1%20%3D%20%28p3%20-%20p1%29%20%2A%200.5%3B%0A%20%20%20%20%20%20var%20t2%20%3D%20t%20%2A%20t%3B%0A%20%20%20%20%20%20var%20t3%20%3D%20t%20%2A%20t2%3B%0A%20%20%20%20%20%20return%20%282%20%2A%20p1%20-%202%20%2A%20p2%20%2B%20v0%20%2B%20v1%29%20%2A%20t3%20%2B%20%28-3%20%2A%20p1%20%2B%203%20%2A%20p2%20-%202%20%2A%20v0%20-%20v1%29%20%2A%20t2%20%2B%20v0%20%2A%20t%20%2B%20p1%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%3B%0Avar%20Sequence%20%3D%20%28%0A%20%20%2F%2A%2A%20%40class%20%2A%2F%0A%20%20function%28%29%20%7B%0A%20%20%20%20function%20Sequence2%28%29%20%7B%0A%20%20%20%20%7D%0A%20%20%20%20Sequence2.nextId%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20Sequence2._nextId%2B%2B%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Sequence2._nextId%20%3D%200%3B%0A%20%20%20%20return%20Sequence2%3B%0A%20%20%7D%28%29%0A%29%3B%0Avar%20mainGroup%20%3D%20new%20Group2%28%29%3B%0Avar%20Tween%20%3D%20%28%0A%20%20%2F%2A%2A%20%40class%20%2A%2F%0A%20%20function%28%29%20%7B%0A%20%20%20%20function%20Tween2%28object%2C%20group%29%20%7B%0A%20%20%20%20%20%20this._isPaused%20%3D%20false%3B%0A%20%20%20%20%20%20this._pauseStart%20%3D%200%3B%0A%20%20%20%20%20%20this._valuesStart%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20this._valuesEnd%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20this._valuesStartRepeat%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20this._duration%20%3D%201e3%3B%0A%20%20%20%20%20%20this._isDynamic%20%3D%20false%3B%0A%20%20%20%20%20%20this._initialRepeat%20%3D%200%3B%0A%20%20%20%20%20%20this._repeat%20%3D%200%3B%0A%20%20%20%20%20%20this._yoyo%20%3D%20false%3B%0A%20%20%20%20%20%20this._isPlaying%20%3D%20false%3B%0A%20%20%20%20%20%20this._reversed%20%3D%20false%3B%0A%20%20%20%20%20%20this._delayTime%20%3D%200%3B%0A%20%20%20%20%20%20this._startTime%20%3D%200%3B%0A%20%20%20%20%20%20this._easingFunction%20%3D%20Easing.Linear.None%3B%0A%20%20%20%20%20%20this._interpolationFunction%20%3D%20Interpolation.Linear%3B%0A%20%20%20%20%20%20this._chainedTweens%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20this._onStartCallbackFired%20%3D%20false%3B%0A%20%20%20%20%20%20this._onEveryStartCallbackFired%20%3D%20false%3B%0A%20%20%20%20%20%20this._id%20%3D%20Sequence.nextId%28%29%3B%0A%20%20%20%20%20%20this._isChainStopped%20%3D%20false%3B%0A%20%20%20%20%20%20this._propertiesAreSetUp%20%3D%20false%3B%0A%20%20%20%20%20%20this._goToEnd%20%3D%20false%3B%0A%20%20%20%20%20%20this._object%20%3D%20object%3B%0A%20%20%20%20%20%20if%20%28typeof%20group%20%3D%3D%3D%20%22object%22%29%20%7B%0A%20%20%20%20%20%20%20%20this._group%20%3D%20group%3B%0A%20%20%20%20%20%20%20%20group.add%28this%29%3B%0A%20%20%20%20%20%20%7D%20else%20if%20%28group%20%3D%3D%3D%20true%29%20%7B%0A%20%20%20%20%20%20%20%20this._group%20%3D%20mainGroup%3B%0A%20%20%20%20%20%20%20%20mainGroup.add%28this%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20Tween2.prototype.getId%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20this._id%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.isPlaying%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20this._isPlaying%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.isPaused%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20this._isPaused%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.getDuration%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20return%20this._duration%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.to%20%3D%20function%28target%2C%20duration%29%20%7B%0A%20%20%20%20%20%20if%20%28duration%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20duration%20%3D%201e3%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this._isPlaying%29%0A%20%20%20%20%20%20%20%20throw%20new%20Error%28%22Can%20not%20call%20Tween.to%28%29%20while%20Tween%20is%20already%20started%20or%20paused.%20Stop%20the%20Tween%20first.%22%29%3B%0A%20%20%20%20%20%20this._valuesEnd%20%3D%20target%3B%0A%20%20%20%20%20%20this._propertiesAreSetUp%20%3D%20false%3B%0A%20%20%20%20%20%20this._duration%20%3D%20duration%20%3C%200%20%3F%200%20%3A%20duration%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.duration%20%3D%20function%28duration%29%20%7B%0A%20%20%20%20%20%20if%20%28duration%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20duration%20%3D%201e3%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._duration%20%3D%20duration%20%3C%200%20%3F%200%20%3A%20duration%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.dynamic%20%3D%20function%28dynamic%29%20%7B%0A%20%20%20%20%20%20if%20%28dynamic%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20dynamic%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._isDynamic%20%3D%20dynamic%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.start%20%3D%20function%28time%2C%20overrideStartingValues%29%20%7B%0A%20%20%20%20%20%20if%20%28time%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20time%20%3D%20now4%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28overrideStartingValues%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20overrideStartingValues%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this._isPlaying%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._repeat%20%3D%20this._initialRepeat%3B%0A%20%20%20%20%20%20if%20%28this._reversed%29%20%7B%0A%20%20%20%20%20%20%20%20this._reversed%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20for%20%28var%20property2%20in%20this._valuesStartRepeat%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._swapEndStartRepeatValues%28property2%29%3B%0A%20%20%20%20%20%20%20%20%20%20this._valuesStart%5Bproperty2%5D%20%3D%20this._valuesStartRepeat%5Bproperty2%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._isPlaying%20%3D%20true%3B%0A%20%20%20%20%20%20this._isPaused%20%3D%20false%3B%0A%20%20%20%20%20%20this._onStartCallbackFired%20%3D%20false%3B%0A%20%20%20%20%20%20this._onEveryStartCallbackFired%20%3D%20false%3B%0A%20%20%20%20%20%20this._isChainStopped%20%3D%20false%3B%0A%20%20%20%20%20%20this._startTime%20%3D%20time%3B%0A%20%20%20%20%20%20this._startTime%20%2B%3D%20this._delayTime%3B%0A%20%20%20%20%20%20if%20%28%21this._propertiesAreSetUp%20%7C%7C%20overrideStartingValues%29%20%7B%0A%20%20%20%20%20%20%20%20this._propertiesAreSetUp%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20if%20%28%21this._isDynamic%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20tmp2%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28var%20prop%20in%20this._valuesEnd%29%0A%20%20%20%20%20%20%20%20%20%20%20%20tmp2%5Bprop%5D%20%3D%20this._valuesEnd%5Bprop%5D%3B%0A%20%20%20%20%20%20%20%20%20%20this._valuesEnd%20%3D%20tmp2%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this._setupProperties%28this._object%2C%20this._valuesStart%2C%20this._valuesEnd%2C%20this._valuesStartRepeat%2C%20overrideStartingValues%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.startFromCurrentValues%20%3D%20function%28time%29%20%7B%0A%20%20%20%20%20%20return%20this.start%28time%2C%20true%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype._setupProperties%20%3D%20function%28_object%2C%20_valuesStart%2C%20_valuesEnd%2C%20_valuesStartRepeat%2C%20overrideStartingValues%29%20%7B%0A%20%20%20%20%20%20for%20%28var%20property2%20in%20_valuesEnd%29%20%7B%0A%20%20%20%20%20%20%20%20var%20startValue%20%3D%20_object%5Bproperty2%5D%3B%0A%20%20%20%20%20%20%20%20var%20startValueIsArray%20%3D%20Array.isArray%28startValue%29%3B%0A%20%20%20%20%20%20%20%20var%20propType%20%3D%20startValueIsArray%20%3F%20%22array%22%20%3A%20typeof%20startValue%3B%0A%20%20%20%20%20%20%20%20var%20isInterpolationList%20%3D%20%21startValueIsArray%20%26%26%20Array.isArray%28_valuesEnd%5Bproperty2%5D%29%3B%0A%20%20%20%20%20%20%20%20if%20%28propType%20%3D%3D%3D%20%22undefined%22%20%7C%7C%20propType%20%3D%3D%3D%20%22function%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28isInterpolationList%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20endValues%20%3D%20_valuesEnd%5Bproperty2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28endValues.length%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20temp2%20%3D%20%5BstartValue%5D%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%2C%20l%20%3D%20endValues.length%3B%20i%20%3C%20l%3B%20i%20%2B%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20value%20%3D%20this._handleRelativeValue%28startValue%2C%20endValues%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28isNaN%28value%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20isInterpolationList%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.warn%28%22Found%20invalid%20interpolation%20list.%20Skipping.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20temp2.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28isInterpolationList%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_valuesEnd%5Bproperty2%5D%20%3D%20temp2%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28%28propType%20%3D%3D%3D%20%22object%22%20%7C%7C%20startValueIsArray%29%20%26%26%20startValue%20%26%26%20%21isInterpolationList%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_valuesStart%5Bproperty2%5D%20%3D%20startValueIsArray%20%3F%20%5B%5D%20%3A%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20nestedObject%20%3D%20startValue%3B%0A%20%20%20%20%20%20%20%20%20%20for%20%28var%20prop%20in%20nestedObject%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_valuesStart%5Bproperty2%5D%5Bprop%5D%20%3D%20nestedObject%5Bprop%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20_valuesStartRepeat%5Bproperty2%5D%20%3D%20startValueIsArray%20%3F%20%5B%5D%20%3A%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20var%20endValues%20%3D%20_valuesEnd%5Bproperty2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21this._isDynamic%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20tmp2%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20%28var%20prop%20in%20endValues%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20tmp2%5Bprop%5D%20%3D%20endValues%5Bprop%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_valuesEnd%5Bproperty2%5D%20%3D%20endValues%20%3D%20tmp2%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20this._setupProperties%28nestedObject%2C%20_valuesStart%5Bproperty2%5D%2C%20endValues%2C%20_valuesStartRepeat%5Bproperty2%5D%2C%20overrideStartingValues%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20_valuesStart%5Bproperty2%5D%20%3D%3D%3D%20%22undefined%22%20%7C%7C%20overrideStartingValues%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_valuesStart%5Bproperty2%5D%20%3D%20startValue%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21startValueIsArray%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_valuesStart%5Bproperty2%5D%20%2A%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28isInterpolationList%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_valuesStartRepeat%5Bproperty2%5D%20%3D%20_valuesEnd%5Bproperty2%5D.slice%28%29.reverse%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_valuesStartRepeat%5Bproperty2%5D%20%3D%20_valuesStart%5Bproperty2%5D%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.stop%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28%21this._isChainStopped%29%20%7B%0A%20%20%20%20%20%20%20%20this._isChainStopped%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20this.stopChainedTweens%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28%21this._isPlaying%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._isPlaying%20%3D%20false%3B%0A%20%20%20%20%20%20this._isPaused%20%3D%20false%3B%0A%20%20%20%20%20%20if%20%28this._onStopCallback%29%20%7B%0A%20%20%20%20%20%20%20%20this._onStopCallback%28this._object%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.end%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20this._goToEnd%20%3D%20true%3B%0A%20%20%20%20%20%20this.update%28this._startTime%20%2B%20this._duration%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.pause%20%3D%20function%28time%29%20%7B%0A%20%20%20%20%20%20if%20%28time%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20time%20%3D%20now4%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this._isPaused%20%7C%7C%20%21this._isPlaying%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._isPaused%20%3D%20true%3B%0A%20%20%20%20%20%20this._pauseStart%20%3D%20time%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.resume%20%3D%20function%28time%29%20%7B%0A%20%20%20%20%20%20if%20%28time%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20time%20%3D%20now4%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28%21this._isPaused%20%7C%7C%20%21this._isPlaying%29%20%7B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._isPaused%20%3D%20false%3B%0A%20%20%20%20%20%20this._startTime%20%2B%3D%20time%20-%20this._pauseStart%3B%0A%20%20%20%20%20%20this._pauseStart%20%3D%200%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.stopChainedTweens%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20for%20%28var%20i%20%3D%200%2C%20numChainedTweens%20%3D%20this._chainedTweens.length%3B%20i%20%3C%20numChainedTweens%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20this._chainedTweens%5Bi%5D.stop%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.group%20%3D%20function%28group%29%20%7B%0A%20%20%20%20%20%20if%20%28%21group%29%20%7B%0A%20%20%20%20%20%20%20%20console.warn%28%22tween.group%28%29%20without%20args%20has%20been%20removed%2C%20use%20group.add%28tween%29%20instead.%22%29%3B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20group.add%28this%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.remove%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20_a%3B%0A%20%20%20%20%20%20%28_a%20%3D%20this._group%29%20%3D%3D%3D%20null%20%7C%7C%20_a%20%3D%3D%3D%20void%200%20%3F%20void%200%20%3A%20_a.remove%28this%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.delay%20%3D%20function%28amount%29%20%7B%0A%20%20%20%20%20%20if%20%28amount%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20amount%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._delayTime%20%3D%20amount%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.repeat%20%3D%20function%28times%29%20%7B%0A%20%20%20%20%20%20if%20%28times%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20times%20%3D%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._initialRepeat%20%3D%20times%3B%0A%20%20%20%20%20%20this._repeat%20%3D%20times%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.repeatDelay%20%3D%20function%28amount%29%20%7B%0A%20%20%20%20%20%20this._repeatDelayTime%20%3D%20amount%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.yoyo%20%3D%20function%28yoyo%29%20%7B%0A%20%20%20%20%20%20if%20%28yoyo%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20yoyo%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._yoyo%20%3D%20yoyo%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.easing%20%3D%20function%28easingFunction%29%20%7B%0A%20%20%20%20%20%20if%20%28easingFunction%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20easingFunction%20%3D%20Easing.Linear.None%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._easingFunction%20%3D%20easingFunction%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.interpolation%20%3D%20function%28interpolationFunction%29%20%7B%0A%20%20%20%20%20%20if%20%28interpolationFunction%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20interpolationFunction%20%3D%20Interpolation.Linear%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._interpolationFunction%20%3D%20interpolationFunction%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.chain%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20var%20tweens%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20for%20%28var%20_i%20%3D%200%3B%20_i%20%3C%20arguments.length%3B%20_i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20tweens%5B_i%5D%20%3D%20arguments%5B_i%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._chainedTweens%20%3D%20tweens%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.onStart%20%3D%20function%28callback%29%20%7B%0A%20%20%20%20%20%20this._onStartCallback%20%3D%20callback%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.onEveryStart%20%3D%20function%28callback%29%20%7B%0A%20%20%20%20%20%20this._onEveryStartCallback%20%3D%20callback%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.onUpdate%20%3D%20function%28callback%29%20%7B%0A%20%20%20%20%20%20this._onUpdateCallback%20%3D%20callback%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.onRepeat%20%3D%20function%28callback%29%20%7B%0A%20%20%20%20%20%20this._onRepeatCallback%20%3D%20callback%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.onComplete%20%3D%20function%28callback%29%20%7B%0A%20%20%20%20%20%20this._onCompleteCallback%20%3D%20callback%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.onStop%20%3D%20function%28callback%29%20%7B%0A%20%20%20%20%20%20this._onStopCallback%20%3D%20callback%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype.update%20%3D%20function%28time%2C%20autoStart%29%20%7B%0A%20%20%20%20%20%20var%20_this%20%3D%20this%3B%0A%20%20%20%20%20%20var%20_a%3B%0A%20%20%20%20%20%20if%20%28time%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20time%20%3D%20now4%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28autoStart%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20autoStart%20%3D%20Tween2.autoStartOnUpdate%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this._isPaused%29%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20var%20property2%3B%0A%20%20%20%20%20%20if%20%28%21this._goToEnd%20%26%26%20%21this._isPlaying%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28autoStart%29%0A%20%20%20%20%20%20%20%20%20%20this.start%28time%2C%20true%29%3B%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._goToEnd%20%3D%20false%3B%0A%20%20%20%20%20%20if%20%28time%20%3C%20this._startTime%29%20%7B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this._onStartCallbackFired%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this._onStartCallback%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._onStartCallback%28this._object%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this._onStartCallbackFired%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this._onEveryStartCallbackFired%20%3D%3D%3D%20false%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this._onEveryStartCallback%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._onEveryStartCallback%28this._object%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this._onEveryStartCallbackFired%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20var%20elapsedTime%20%3D%20time%20-%20this._startTime%3B%0A%20%20%20%20%20%20var%20durationAndDelay%20%3D%20this._duration%20%2B%20%28%28_a%20%3D%20this._repeatDelayTime%29%20%21%3D%3D%20null%20%26%26%20_a%20%21%3D%3D%20void%200%20%3F%20_a%20%3A%20this._delayTime%29%3B%0A%20%20%20%20%20%20var%20totalTime%20%3D%20this._duration%20%2B%20this._repeat%20%2A%20durationAndDelay%3B%0A%20%20%20%20%20%20var%20calculateElapsedPortion%20%3D%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28_this._duration%20%3D%3D%3D%200%29%0A%20%20%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%20%20if%20%28elapsedTime%20%3E%20totalTime%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20timesRepeated%20%3D%20Math.trunc%28elapsedTime%20%2F%20durationAndDelay%29%3B%0A%20%20%20%20%20%20%20%20var%20timeIntoCurrentRepeat%20%3D%20elapsedTime%20-%20timesRepeated%20%2A%20durationAndDelay%3B%0A%20%20%20%20%20%20%20%20var%20portion%20%3D%20Math.min%28timeIntoCurrentRepeat%20%2F%20_this._duration%2C%201%29%3B%0A%20%20%20%20%20%20%20%20if%20%28portion%20%3D%3D%3D%200%20%26%26%20elapsedTime%20%3D%3D%3D%20_this._duration%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20portion%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20var%20elapsed%20%3D%20calculateElapsedPortion%28%29%3B%0A%20%20%20%20%20%20var%20value%20%3D%20this._easingFunction%28elapsed%29%3B%0A%20%20%20%20%20%20this._updateProperties%28this._object%2C%20this._valuesStart%2C%20this._valuesEnd%2C%20value%29%3B%0A%20%20%20%20%20%20if%20%28this._onUpdateCallback%29%20%7B%0A%20%20%20%20%20%20%20%20this._onUpdateCallback%28this._object%2C%20elapsed%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28this._duration%20%3D%3D%3D%200%20%7C%7C%20elapsedTime%20%3E%3D%20this._duration%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28this._repeat%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20completeCount%20%3D%20Math.min%28Math.trunc%28%28elapsedTime%20-%20this._duration%29%20%2F%20durationAndDelay%29%20%2B%201%2C%20this._repeat%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28isFinite%28this._repeat%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._repeat%20-%3D%20completeCount%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20for%20%28property2%20in%20this._valuesStartRepeat%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21this._yoyo%20%26%26%20typeof%20this._valuesEnd%5Bproperty2%5D%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._valuesStartRepeat%5Bproperty2%5D%20%3D%20%2F%2F%20eslint-disable-next-line%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%40ts-ignore%20FIXME%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._valuesStartRepeat%5Bproperty2%5D%20%2B%20parseFloat%28this._valuesEnd%5Bproperty2%5D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28this._yoyo%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20this._swapEndStartRepeatValues%28property2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20this._valuesStart%5Bproperty2%5D%20%3D%20this._valuesStartRepeat%5Bproperty2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28this._yoyo%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._reversed%20%3D%20%21this._reversed%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20this._startTime%20%2B%3D%20durationAndDelay%20%2A%20completeCount%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28this._onRepeatCallback%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._onRepeatCallback%28this._object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20this._onEveryStartCallbackFired%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20%28this._onCompleteCallback%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._onCompleteCallback%28this._object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%2C%20numChainedTweens%20%3D%20this._chainedTweens.length%3B%20i%20%3C%20numChainedTweens%3B%20i%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20this._chainedTweens%5Bi%5D.start%28this._startTime%20%2B%20this._duration%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20this._isPlaying%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype._updateProperties%20%3D%20function%28_object%2C%20_valuesStart%2C%20_valuesEnd%2C%20value%29%20%7B%0A%20%20%20%20%20%20for%20%28var%20property2%20in%20_valuesEnd%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28_valuesStart%5Bproperty2%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20start%20%3D%20_valuesStart%5Bproperty2%5D%20%7C%7C%200%3B%0A%20%20%20%20%20%20%20%20var%20end%20%3D%20_valuesEnd%5Bproperty2%5D%3B%0A%20%20%20%20%20%20%20%20var%20startIsArray%20%3D%20Array.isArray%28_object%5Bproperty2%5D%29%3B%0A%20%20%20%20%20%20%20%20var%20endIsArray%20%3D%20Array.isArray%28end%29%3B%0A%20%20%20%20%20%20%20%20var%20isInterpolationList%20%3D%20%21startIsArray%20%26%26%20endIsArray%3B%0A%20%20%20%20%20%20%20%20if%20%28isInterpolationList%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20_object%5Bproperty2%5D%20%3D%20this._interpolationFunction%28end%2C%20value%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20end%20%3D%3D%3D%20%22object%22%20%26%26%20end%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20this._updateProperties%28_object%5Bproperty2%5D%2C%20start%2C%20end%2C%20value%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20end%20%3D%20this._handleRelativeValue%28start%2C%20end%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20end%20%3D%3D%3D%20%22number%22%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_object%5Bproperty2%5D%20%3D%20start%20%2B%20%28end%20-%20start%29%20%2A%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype._handleRelativeValue%20%3D%20function%28start%2C%20end%29%20%7B%0A%20%20%20%20%20%20if%20%28typeof%20end%20%21%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%20end%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28end.charAt%280%29%20%3D%3D%3D%20%22%2B%22%20%7C%7C%20end.charAt%280%29%20%3D%3D%3D%20%22-%22%29%20%7B%0A%20%20%20%20%20%20%20%20return%20start%20%2B%20parseFloat%28end%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20parseFloat%28end%29%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.prototype._swapEndStartRepeatValues%20%3D%20function%28property2%29%20%7B%0A%20%20%20%20%20%20var%20tmp2%20%3D%20this._valuesStartRepeat%5Bproperty2%5D%3B%0A%20%20%20%20%20%20var%20endValue%20%3D%20this._valuesEnd%5Bproperty2%5D%3B%0A%20%20%20%20%20%20if%20%28typeof%20endValue%20%3D%3D%3D%20%22string%22%29%20%7B%0A%20%20%20%20%20%20%20%20this._valuesStartRepeat%5Bproperty2%5D%20%3D%20this._valuesStartRepeat%5Bproperty2%5D%20%2B%20parseFloat%28endValue%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20this._valuesStartRepeat%5Bproperty2%5D%20%3D%20this._valuesEnd%5Bproperty2%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20this._valuesEnd%5Bproperty2%5D%20%3D%20tmp2%3B%0A%20%20%20%20%7D%3B%0A%20%20%20%20Tween2.autoStartOnUpdate%20%3D%20false%3B%0A%20%20%20%20return%20Tween2%3B%0A%20%20%7D%28%29%0A%29%3B%0Avar%20nextId%20%3D%20Sequence.nextId%3B%0Avar%20TWEEN%20%3D%20mainGroup%3B%0Avar%20getAll%20%3D%20TWEEN.getAll.bind%28TWEEN%29%3B%0Avar%20removeAll4%20%3D%20TWEEN.removeAll.bind%28TWEEN%29%3B%0Avar%20add5%20%3D%20TWEEN.add.bind%28TWEEN%29%3B%0Avar%20remove%20%3D%20TWEEN.remove.bind%28TWEEN%29%3B%0Avar%20update2%20%3D%20TWEEN.update.bind%28TWEEN%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2Fthree-render-objects%2Fdist%2Fthree-render-objects.mjs%0Afunction%20styleInject%28css%2C%20ref%29%20%7B%0A%20%20if%20%28ref%20%3D%3D%3D%20void%200%29%20ref%20%3D%20%7B%7D%3B%0A%20%20var%20insertAt%20%3D%20ref.insertAt%3B%0A%20%20if%20%28typeof%20document%20%3D%3D%3D%20%22undefined%22%29%20%7B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%20%20var%20head%20%3D%20document.head%20%7C%7C%20document.getElementsByTagName%28%22head%22%29%5B0%5D%3B%0A%20%20var%20style%20%3D%20document.createElement%28%22style%22%29%3B%0A%20%20style.type%20%3D%20%22text%2Fcss%22%3B%0A%20%20if%20%28insertAt%20%3D%3D%3D%20%22top%22%29%20%7B%0A%20%20%20%20if%20%28head.firstChild%29%20%7B%0A%20%20%20%20%20%20head.insertBefore%28style%2C%20head.firstChild%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20head.appendChild%28style%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20head.appendChild%28style%29%3B%0A%20%20%7D%0A%20%20if%20%28style.styleSheet%29%20%7B%0A%20%20%20%20style.styleSheet.cssText%20%3D%20css%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20style.appendChild%28document.createTextNode%28css%29%29%3B%0A%20%20%7D%0A%7D%0Avar%20css_248z%20%3D%20%22.scene-nav-info%20%7B%5Cn%20%20bottom%3A%205px%3B%5Cn%20%20width%3A%20100%25%3B%5Cn%20%20text-align%3A%20center%3B%5Cn%20%20color%3A%20slategrey%3B%5Cn%20%20opacity%3A%200.7%3B%5Cn%20%20font-size%3A%2010px%3B%5Cn%7D%5Cn%5Cn.scene-tooltip%20%7B%5Cn%20%20top%3A%200%3B%5Cn%20%20color%3A%20lavender%3B%5Cn%20%20font-size%3A%2015px%3B%5Cn%7D%5Cn%5Cn.scene-nav-info%2C%20.scene-tooltip%20%7B%5Cn%20%20position%3A%20absolute%3B%5Cn%20%20font-family%3A%20sans-serif%3B%5Cn%20%20pointer-events%3A%20none%3B%5Cn%20%20user-select%3A%20none%3B%5Cn%7D%5Cn%5Cn.scene-container%20canvas%3Afocus%20%7B%5Cn%20%20outline%3A%20none%3B%5Cn%7D%22%3B%0AstyleInject%28css_248z%29%3B%0Afunction%20_arrayLikeToArray5%28r%2C%20a2%29%20%7B%0A%20%20%28null%20%3D%3D%20a2%20%7C%7C%20a2%20%3E%20r.length%29%20%26%26%20%28a2%20%3D%20r.length%29%3B%0A%20%20for%20%28var%20e%20%3D%200%2C%20n%20%3D%20Array%28a2%29%3B%20e%20%3C%20a2%3B%20e%2B%2B%29%20n%5Be%5D%20%3D%20r%5Be%5D%3B%0A%20%20return%20n%3B%0A%7D%0Afunction%20_arrayWithHoles5%28r%29%20%7B%0A%20%20if%20%28Array.isArray%28r%29%29%20return%20r%3B%0A%7D%0Afunction%20_arrayWithoutHoles4%28r%29%20%7B%0A%20%20if%20%28Array.isArray%28r%29%29%20return%20_arrayLikeToArray5%28r%29%3B%0A%7D%0Afunction%20_defineProperty3%28e%2C%20r%2C%20t%29%20%7B%0A%20%20return%20%28r%20%3D%20_toPropertyKey4%28r%29%29%20in%20e%20%3F%20Object.defineProperty%28e%2C%20r%2C%20%7B%0A%20%20%20%20value%3A%20t%2C%0A%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20writable%3A%20true%0A%20%20%7D%29%20%3A%20e%5Br%5D%20%3D%20t%2C%20e%3B%0A%7D%0Afunction%20_iterableToArray4%28r%29%20%7B%0A%20%20if%20%28%22undefined%22%20%21%3D%20typeof%20Symbol%20%26%26%20null%20%21%3D%20r%5BSymbol.iterator%5D%20%7C%7C%20null%20%21%3D%20r%5B%22%40%40iterator%22%5D%29%20return%20Array.from%28r%29%3B%0A%7D%0Afunction%20_iterableToArrayLimit5%28r%2C%20l%29%20%7B%0A%20%20var%20t%20%3D%20null%20%3D%3D%20r%20%3F%20null%20%3A%20%22undefined%22%20%21%3D%20typeof%20Symbol%20%26%26%20r%5BSymbol.iterator%5D%20%7C%7C%20r%5B%22%40%40iterator%22%5D%3B%0A%20%20if%20%28null%20%21%3D%20t%29%20%7B%0A%20%20%20%20var%20e%2C%20n%2C%20i%2C%20u%2C%20a2%20%3D%20%5B%5D%2C%20f%20%3D%20true%2C%20o%20%3D%20false%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20if%20%28i%20%3D%20%28t%20%3D%20t.call%28r%29%29.next%2C%200%20%3D%3D%3D%20l%29%20%3B%0A%20%20%20%20%20%20else%20for%20%28%3B%20%21%28f%20%3D%20%28e%20%3D%20i.call%28t%29%29.done%29%20%26%26%20%28a2.push%28e.value%29%2C%20a2.length%20%21%3D%3D%20l%29%3B%20f%20%3D%20true%29%20%3B%0A%20%20%20%20%7D%20catch%20%28r2%29%20%7B%0A%20%20%20%20%20%20o%20%3D%20true%2C%20n%20%3D%20r2%3B%0A%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%21f%20%26%26%20null%20%21%3D%20t.return%20%26%26%20%28u%20%3D%20t.return%28%29%2C%20Object%28u%29%20%21%3D%3D%20u%29%29%20return%3B%0A%20%20%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20%20%20if%20%28o%29%20throw%20n%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20return%20a2%3B%0A%20%20%7D%0A%7D%0Afunction%20_nonIterableRest5%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20destructure%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20_nonIterableSpread4%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20spread%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20_slicedToArray5%28r%2C%20e%29%20%7B%0A%20%20return%20_arrayWithHoles5%28r%29%20%7C%7C%20_iterableToArrayLimit5%28r%2C%20e%29%20%7C%7C%20_unsupportedIterableToArray5%28r%2C%20e%29%20%7C%7C%20_nonIterableRest5%28%29%3B%0A%7D%0Afunction%20_toConsumableArray4%28r%29%20%7B%0A%20%20return%20_arrayWithoutHoles4%28r%29%20%7C%7C%20_iterableToArray4%28r%29%20%7C%7C%20_unsupportedIterableToArray5%28r%29%20%7C%7C%20_nonIterableSpread4%28%29%3B%0A%7D%0Afunction%20_toPrimitive4%28t%2C%20r%29%20%7B%0A%20%20if%20%28%22object%22%20%21%3D%20typeof%20t%20%7C%7C%20%21t%29%20return%20t%3B%0A%20%20var%20e%20%3D%20t%5BSymbol.toPrimitive%5D%3B%0A%20%20if%20%28void%200%20%21%3D%3D%20e%29%20%7B%0A%20%20%20%20var%20i%20%3D%20e.call%28t%2C%20r%20%7C%7C%20%22default%22%29%3B%0A%20%20%20%20if%20%28%22object%22%20%21%3D%20typeof%20i%29%20return%20i%3B%0A%20%20%20%20throw%20new%20TypeError%28%22%40%40toPrimitive%20must%20return%20a%20primitive%20value.%22%29%3B%0A%20%20%7D%0A%20%20return%20%28%22string%22%20%3D%3D%3D%20r%20%3F%20String%20%3A%20Number%29%28t%29%3B%0A%7D%0Afunction%20_toPropertyKey4%28t%29%20%7B%0A%20%20var%20i%20%3D%20_toPrimitive4%28t%2C%20%22string%22%29%3B%0A%20%20return%20%22symbol%22%20%3D%3D%20typeof%20i%20%3F%20i%20%3A%20i%20%2B%20%22%22%3B%0A%7D%0Afunction%20_unsupportedIterableToArray5%28r%2C%20a2%29%20%7B%0A%20%20if%20%28r%29%20%7B%0A%20%20%20%20if%20%28%22string%22%20%3D%3D%20typeof%20r%29%20return%20_arrayLikeToArray5%28r%2C%20a2%29%3B%0A%20%20%20%20var%20t%20%3D%20%7B%7D.toString.call%28r%29.slice%288%2C%20-1%29%3B%0A%20%20%20%20return%20%22Object%22%20%3D%3D%3D%20t%20%26%26%20r.constructor%20%26%26%20%28t%20%3D%20r.constructor.name%29%2C%20%22Map%22%20%3D%3D%3D%20t%20%7C%7C%20%22Set%22%20%3D%3D%3D%20t%20%3F%20Array.from%28r%29%20%3A%20%22Arguments%22%20%3D%3D%3D%20t%20%7C%7C%20%2F%5E%28%3F%3AUi%7CI%29nt%28%3F%3A8%7C16%7C32%29%28%3F%3AClamped%29%3FArray%24%2F.test%28t%29%20%3F%20_arrayLikeToArray5%28r%2C%20a2%29%20%3A%20void%200%3B%0A%20%20%7D%0A%7D%0Avar%20three2%20%3D%20window.THREE%20%3F%20window.THREE%20%3A%20%7B%0A%20%20WebGLRenderer%2C%0A%20%20Scene%2C%0A%20%20PerspectiveCamera%2C%0A%20%20Raycaster%2C%0A%20%20SRGBColorSpace%2C%0A%20%20TextureLoader%2C%0A%20%20Vector2%2C%0A%20%20Vector3%2C%0A%20%20Box3%2C%0A%20%20Color%2C%0A%20%20Mesh%2C%0A%20%20SphereGeometry%2C%0A%20%20MeshBasicMaterial%2C%0A%20%20BackSide%2C%0A%20%20EventDispatcher%2C%0A%20%20MOUSE%2C%0A%20%20Quaternion%2C%0A%20%20Spherical%2C%0A%20%20Clock%0A%7D%3B%0Avar%20threeRenderObjects%20%3D%20index2%28%7B%0A%20%20props%3A%20%7B%0A%20%20%20%20width%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20window.innerWidth%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange8%28width%2C%20state%2C%20prevWidth%29%20%7B%0A%20%20%20%20%20%20%20%20isNaN%28width%29%20%26%26%20%28state.width%20%3D%20prevWidth%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20height%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20window.innerHeight%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange9%28height%2C%20state%2C%20prevHeight%29%20%7B%0A%20%20%20%20%20%20%20%20isNaN%28height%29%20%26%26%20%28state.height%20%3D%20prevHeight%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20backgroundColor%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22%23000011%22%0A%20%20%20%20%7D%2C%0A%20%20%20%20backgroundImageUrl%3A%20%7B%7D%2C%0A%20%20%20%20onBackgroundImageLoaded%3A%20%7B%7D%2C%0A%20%20%20%20showNavInfo%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20true%0A%20%20%20%20%7D%2C%0A%20%20%20%20skyRadius%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%205e4%0A%20%20%20%20%7D%2C%0A%20%20%20%20objects%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%5B%5D%0A%20%20%20%20%7D%2C%0A%20%20%20%20lights%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%5B%5D%0A%20%20%20%20%7D%2C%0A%20%20%20%20enablePointerInteraction%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20true%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange10%28_%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20state.hoverObj%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20if%20%28state.toolTipElem%29%20state.toolTipElem.innerHTML%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20lineHoverPrecision%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%201%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20hoverOrderComparator%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default8%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20-1%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20keep%20existing%20order%20by%20default%0A%20%20%20%20hoverFilter%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default9%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20exclude%20objects%20from%20interaction%0A%20%20%20%20tooltipContent%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20hoverDuringDrag%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20false%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20clickAfterDrag%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20false%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onHover%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default10%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onClick%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default11%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onRightClick%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%0A%20%20%7D%2C%0A%20%20methods%3A%20%7B%0A%20%20%20%20tick%3A%20function%20tick%28state%29%20%7B%0A%20%20%20%20%20%20if%20%28state.initialised%29%20%7B%0A%20%20%20%20%20%20%20%20state.controls.update%20%26%26%20state.controls.update%28Math.min%281%2C%20state.clock.getDelta%28%29%29%29%3B%0A%20%20%20%20%20%20%20%20state.postProcessingComposer%20%3F%20state.postProcessingComposer.render%28%29%20%3A%20state.renderer.render%28state.scene%2C%20state.camera%29%3B%0A%20%20%20%20%20%20%20%20state.extraRenderers.forEach%28function%28r%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20r.render%28state.scene%2C%20state.camera%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20if%20%28state.enablePointerInteraction%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20topObject%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28state.hoverDuringDrag%20%7C%7C%20%21state.isPointerDragging%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20intersects%20%3D%20this.intersectingObjects%28state.pointerPos.x%2C%20state.pointerPos.y%29.filter%28function%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20state.hoverFilter%28d.object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29.sort%28function%28a2%2C%20b%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20state.hoverOrderComparator%28a2.object%2C%20b.object%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20topIntersect%20%3D%20intersects.length%20%3F%20intersects%5B0%5D%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20topObject%20%3D%20topIntersect%20%3F%20topIntersect.object%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.intersectionPoint%20%3D%20topIntersect%20%3F%20topIntersect.point%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20if%20%28topObject%20%21%3D%3D%20state.hoverObj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.onHover%28topObject%2C%20state.hoverObj%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.toolTipElem.innerHTML%20%3D%20topObject%20%3F%20index3%28state.tooltipContent%29%28topObject%29%20%7C%7C%20%22%22%20%3A%20%22%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20state.hoverObj%20%3D%20topObject%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state.tweenGroup.update%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20getPointerPos%3A%20function%20getPointerPos%28state%29%20%7B%0A%20%20%20%20%20%20var%20_state%24pointerPos%20%3D%20state.pointerPos%2C%20x2%20%3D%20_state%24pointerPos.x%2C%20y2%20%3D%20_state%24pointerPos.y%3B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20x%3A%20x2%2C%0A%20%20%20%20%20%20%20%20y%3A%20y2%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20cameraPosition%3A%20function%20cameraPosition2%28state%2C%20position%2C%20lookAt%2C%20transitionDuration%29%20%7B%0A%20%20%20%20%20%20var%20camera3%20%3D%20state.camera%3B%0A%20%20%20%20%20%20if%20%28position%20%26%26%20state.initialised%29%20%7B%0A%20%20%20%20%20%20%20%20var%20finalPos%20%3D%20position%3B%0A%20%20%20%20%20%20%20%20var%20finalLookAt%20%3D%20lookAt%20%7C%7C%20%7B%0A%20%20%20%20%20%20%20%20%20%20x%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20y%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20z%3A%200%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20if%20%28%21transitionDuration%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20setCameraPos%28finalPos%29%3B%0A%20%20%20%20%20%20%20%20%20%20setLookAt%28finalLookAt%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20camPos%20%3D%20Object.assign%28%7B%7D%2C%20camera3.position%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20camLookAt%20%3D%20getLookAt%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.tweenGroup.add%28new%20Tween%28camPos%29.to%28finalPos%2C%20transitionDuration%29.easing%28Easing.Quadratic.Out%29.onUpdate%28setCameraPos%29.start%28%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.tweenGroup.add%28new%20Tween%28camLookAt%29.to%28finalLookAt%2C%20transitionDuration%20%2F%203%29.easing%28Easing.Quadratic.Out%29.onUpdate%28setLookAt%29.start%28%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20Object.assign%28%7B%7D%2C%20camera3.position%2C%20%7B%0A%20%20%20%20%20%20%20%20lookAt%3A%20getLookAt%28%29%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20function%20setCameraPos%28pos%29%20%7B%0A%20%20%20%20%20%20%20%20var%20x2%20%3D%20pos.x%2C%20y2%20%3D%20pos.y%2C%20z2%20%3D%20pos.z%3B%0A%20%20%20%20%20%20%20%20if%20%28x2%20%21%3D%3D%20void%200%29%20camera3.position.x%20%3D%20x2%3B%0A%20%20%20%20%20%20%20%20if%20%28y2%20%21%3D%3D%20void%200%29%20camera3.position.y%20%3D%20y2%3B%0A%20%20%20%20%20%20%20%20if%20%28z2%20%21%3D%3D%20void%200%29%20camera3.position.z%20%3D%20z2%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20setLookAt%28lookAt2%29%20%7B%0A%20%20%20%20%20%20%20%20var%20lookAtVect%20%3D%20new%20three2.Vector3%28lookAt2.x%2C%20lookAt2.y%2C%20lookAt2.z%29%3B%0A%20%20%20%20%20%20%20%20if%20%28state.controls.target%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.controls.target%20%3D%20lookAtVect%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20camera3.lookAt%28lookAtVect%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20function%20getLookAt%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20Object.assign%28new%20three2.Vector3%280%2C%200%2C%20-1e3%29.applyQuaternion%28camera3.quaternion%29.add%28camera3.position%29%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20zoomToFit%3A%20function%20zoomToFit%28state%29%20%7B%0A%20%20%20%20%20%20var%20transitionDuration%20%3D%20arguments.length%20%3E%201%20%26%26%20arguments%5B1%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B1%5D%20%3A%200%3B%0A%20%20%20%20%20%20var%20padding%20%3D%20arguments.length%20%3E%202%20%26%26%20arguments%5B2%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B2%5D%20%3A%2010%3B%0A%20%20%20%20%20%20for%20%28var%20_len%20%3D%20arguments.length%2C%20bboxArgs%20%3D%20new%20Array%28_len%20%3E%203%20%3F%20_len%20-%203%20%3A%200%29%2C%20_key%20%3D%203%3B%20_key%20%3C%20_len%3B%20_key%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20bboxArgs%5B_key%20-%203%5D%20%3D%20arguments%5B_key%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this.fitToBbox%28this.getBbox.apply%28this%2C%20bboxArgs%29%2C%20transitionDuration%2C%20padding%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20fitToBbox%3A%20function%20fitToBbox%28state%2C%20bbox%29%20%7B%0A%20%20%20%20%20%20var%20transitionDuration%20%3D%20arguments.length%20%3E%202%20%26%26%20arguments%5B2%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B2%5D%20%3A%200%3B%0A%20%20%20%20%20%20var%20padding%20%3D%20arguments.length%20%3E%203%20%26%26%20arguments%5B3%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B3%5D%20%3A%2010%3B%0A%20%20%20%20%20%20var%20camera3%20%3D%20state.camera%3B%0A%20%20%20%20%20%20if%20%28bbox%29%20%7B%0A%20%20%20%20%20%20%20%20var%20center%20%3D%20new%20three2.Vector3%280%2C%200%2C%200%29%3B%0A%20%20%20%20%20%20%20%20var%20maxBoxSide%20%3D%20Math.max.apply%28Math%2C%20_toConsumableArray4%28Object.entries%28bbox%29.map%28function%28_ref%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20_ref2%20%3D%20_slicedToArray5%28_ref%2C%202%29%2C%20coordType%20%3D%20_ref2%5B0%5D%2C%20coords%20%3D%20_ref2%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20return%20Math.max.apply%28Math%2C%20_toConsumableArray4%28coords.map%28function%28c2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20Math.abs%28center%5BcoordType%5D%20-%20c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%29%29%20%2A%202%3B%0A%20%20%20%20%20%20%20%20var%20paddedFov%20%3D%20%281%20-%20padding%20%2A%202%20%2F%20state.height%29%20%2A%20camera3.fov%3B%0A%20%20%20%20%20%20%20%20var%20fitHeightDistance%20%3D%20maxBoxSide%20%2F%20Math.atan%28paddedFov%20%2A%20Math.PI%20%2F%20180%29%3B%0A%20%20%20%20%20%20%20%20var%20fitWidthDistance%20%3D%20fitHeightDistance%20%2F%20camera3.aspect%3B%0A%20%20%20%20%20%20%20%20var%20distance2%20%3D%20Math.max%28fitHeightDistance%2C%20fitWidthDistance%29%3B%0A%20%20%20%20%20%20%20%20if%20%28distance2%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20newCameraPosition%20%3D%20center.clone%28%29.sub%28camera3.position%29.normalize%28%29.multiplyScalar%28-distance2%29%3B%0A%20%20%20%20%20%20%20%20%20%20this.cameraPosition%28newCameraPosition%2C%20center%2C%20transitionDuration%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20getBbox%3A%20function%20getBbox%28state%29%20%7B%0A%20%20%20%20%20%20var%20objFilter%20%3D%20arguments.length%20%3E%201%20%26%26%20arguments%5B1%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B1%5D%20%3A%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20var%20box%20%3D%20new%20three2.Box3%28new%20three2.Vector3%280%2C%200%2C%200%29%2C%20new%20three2.Vector3%280%2C%200%2C%200%29%29%3B%0A%20%20%20%20%20%20var%20objs%20%3D%20state.objects.filter%28objFilter%29%3B%0A%20%20%20%20%20%20if%20%28%21objs.length%29%20return%20null%3B%0A%20%20%20%20%20%20objs.forEach%28function%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20return%20box.expandByObject%28obj%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20return%20Object.assign.apply%28Object%2C%20_toConsumableArray4%28%5B%22x%22%2C%20%22y%22%2C%20%22z%22%5D.map%28function%28c2%29%20%7B%0A%20%20%20%20%20%20%20%20return%20_defineProperty3%28%7B%7D%2C%20c2%2C%20%5Bbox.min%5Bc2%5D%2C%20box.max%5Bc2%5D%5D%29%3B%0A%20%20%20%20%20%20%7D%29%29%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20getScreenCoords%3A%20function%20getScreenCoords%28state%2C%20x2%2C%20y2%2C%20z2%29%20%7B%0A%20%20%20%20%20%20var%20vec%20%3D%20new%20three2.Vector3%28x2%2C%20y2%2C%20z2%29%3B%0A%20%20%20%20%20%20vec.project%28this.camera%28%29%29%3B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20align%20relative%20pos%20to%20canvas%20dimensions%0A%20%20%20%20%20%20%20%20x%3A%20%28vec.x%20%2B%201%29%20%2A%20state.width%20%2F%202%2C%0A%20%20%20%20%20%20%20%20y%3A%20-%28vec.y%20-%201%29%20%2A%20state.height%20%2F%202%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20getSceneCoords%3A%20function%20getSceneCoords%28state%2C%20screenX%2C%20screenY%29%20%7B%0A%20%20%20%20%20%20var%20distance2%20%3D%20arguments.length%20%3E%203%20%26%26%20arguments%5B3%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B3%5D%20%3A%200%3B%0A%20%20%20%20%20%20var%20relCoords%20%3D%20new%20three2.Vector2%28screenX%20%2F%20state.width%20%2A%202%20-%201%2C%20-%28screenY%20%2F%20state.height%29%20%2A%202%20%2B%201%29%3B%0A%20%20%20%20%20%20var%20raycaster%20%3D%20new%20three2.Raycaster%28%29%3B%0A%20%20%20%20%20%20raycaster.setFromCamera%28relCoords%2C%20state.camera%29%3B%0A%20%20%20%20%20%20return%20Object.assign%28%7B%7D%2C%20raycaster.ray.at%28distance2%2C%20new%20three2.Vector3%28%29%29%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20intersectingObjects%3A%20function%20intersectingObjects%28state%2C%20x2%2C%20y2%29%20%7B%0A%20%20%20%20%20%20var%20relCoords%20%3D%20new%20three2.Vector2%28x2%20%2F%20state.width%20%2A%202%20-%201%2C%20-%28y2%20%2F%20state.height%29%20%2A%202%20%2B%201%29%3B%0A%20%20%20%20%20%20var%20raycaster%20%3D%20new%20three2.Raycaster%28%29%3B%0A%20%20%20%20%20%20raycaster.params.Line.threshold%20%3D%20state.lineHoverPrecision%3B%0A%20%20%20%20%20%20raycaster.setFromCamera%28relCoords%2C%20state.camera%29%3B%0A%20%20%20%20%20%20return%20raycaster.intersectObjects%28state.objects%2C%20true%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20renderer%3A%20function%20renderer%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.renderer%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20scene%3A%20function%20scene%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.scene%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20camera%3A%20function%20camera%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.camera%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20postProcessingComposer%3A%20function%20postProcessingComposer%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.postProcessingComposer%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20controls%3A%20function%20controls%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.controls%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20tbControls%3A%20function%20tbControls%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.controls%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20to%20be%20deprecated%0A%20%20%7D%2C%0A%20%20stateInit%3A%20function%20stateInit2%28%29%20%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20scene%3A%20new%20three2.Scene%28%29%2C%0A%20%20%20%20%20%20camera%3A%20new%20three2.PerspectiveCamera%28%29%2C%0A%20%20%20%20%20%20clock%3A%20new%20three2.Clock%28%29%2C%0A%20%20%20%20%20%20tweenGroup%3A%20new%20Group2%28%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%2C%0A%20%20init%3A%20function%20init2%28domNode%2C%20state%29%20%7B%0A%20%20%20%20var%20_ref4%20%3D%20arguments.length%20%3E%202%20%26%26%20arguments%5B2%5D%20%21%3D%3D%20void%200%20%3F%20arguments%5B2%5D%20%3A%20%7B%7D%2C%20_ref4%24controlType%20%3D%20_ref4.controlType%2C%20controlType%20%3D%20_ref4%24controlType%20%3D%3D%3D%20void%200%20%3F%20%22trackball%22%20%3A%20_ref4%24controlType%2C%20_ref4%24useWebGPU%20%3D%20_ref4.useWebGPU%2C%20useWebGPU%20%3D%20_ref4%24useWebGPU%20%3D%3D%3D%20void%200%20%3F%20false%20%3A%20_ref4%24useWebGPU%2C%20_ref4%24rendererConfig%20%3D%20_ref4.rendererConfig%2C%20rendererConfig%20%3D%20_ref4%24rendererConfig%20%3D%3D%3D%20void%200%20%3F%20%7B%7D%20%3A%20_ref4%24rendererConfig%2C%20_ref4%24extraRenderers%20%3D%20_ref4.extraRenderers%2C%20extraRenderers%20%3D%20_ref4%24extraRenderers%20%3D%3D%3D%20void%200%20%3F%20%5B%5D%20%3A%20_ref4%24extraRenderers%2C%20_ref4%24waitForLoadComp%20%3D%20_ref4.waitForLoadComplete%2C%20waitForLoadComplete%20%3D%20_ref4%24waitForLoadComp%20%3D%3D%3D%20void%200%20%3F%20true%20%3A%20_ref4%24waitForLoadComp%3B%0A%20%20%20%20domNode.innerHTML%20%3D%20%22%22%3B%0A%20%20%20%20domNode.appendChild%28state.container%20%3D%20document.createElement%28%22div%22%29%29%3B%0A%20%20%20%20state.container.className%20%3D%20%22scene-container%22%3B%0A%20%20%20%20state.container.style.position%20%3D%20%22relative%22%3B%0A%20%20%20%20state.container.appendChild%28state.navInfo%20%3D%20document.createElement%28%22div%22%29%29%3B%0A%20%20%20%20state.navInfo.className%20%3D%20%22scene-nav-info%22%3B%0A%20%20%20%20state.navInfo.textContent%20%3D%20%7B%0A%20%20%20%20%20%20orbit%3A%20%22Left-click%3A%20rotate%2C%20Mouse-wheel%2Fmiddle-click%3A%20zoom%2C%20Right-click%3A%20pan%22%2C%0A%20%20%20%20%20%20trackball%3A%20%22Left-click%3A%20rotate%2C%20Mouse-wheel%2Fmiddle-click%3A%20zoom%2C%20Right-click%3A%20pan%22%2C%0A%20%20%20%20%20%20fly%3A%20%22WASD%3A%20move%2C%20R%7CF%3A%20up%20%7C%20down%2C%20Q%7CE%3A%20roll%2C%20up%7Cdown%3A%20pitch%2C%20left%7Cright%3A%20yaw%22%0A%20%20%20%20%7D%5BcontrolType%5D%20%7C%7C%20%22%22%3B%0A%20%20%20%20state.navInfo.style.display%20%3D%20state.showNavInfo%20%3F%20null%20%3A%20%22none%22%3B%0A%20%20%20%20state.toolTipElem%20%3D%20document.createElement%28%22div%22%29%3B%0A%20%20%20%20state.toolTipElem.classList.add%28%22scene-tooltip%22%29%3B%0A%20%20%20%20state.container.appendChild%28state.toolTipElem%29%3B%0A%20%20%20%20state.pointerPos%20%3D%20new%20three2.Vector2%28%29%3B%0A%20%20%20%20state.pointerPos.x%20%3D%20-2%3B%0A%20%20%20%20state.pointerPos.y%20%3D%20-2%3B%0A%20%20%20%20%5B%22pointermove%22%2C%20%22pointerdown%22%5D.forEach%28function%28evType%29%20%7B%0A%20%20%20%20%20%20return%20state.container.addEventListener%28evType%2C%20function%28ev%29%20%7B%0A%20%20%20%20%20%20%20%20evType%20%3D%3D%3D%20%22pointerdown%22%20%26%26%20%28state.isPointerPressed%20%3D%20true%29%3B%0A%20%20%20%20%20%20%20%20%21state.isPointerDragging%20%26%26%20ev.type%20%3D%3D%3D%20%22pointermove%22%20%26%26%20%28ev.pressure%20%3E%200%20%7C%7C%20state.isPointerPressed%29%20%26%26%20%28ev.pointerType%20%21%3D%3D%20%22touch%22%20%7C%7C%20ev.movementX%20%3D%3D%3D%20void%200%20%7C%7C%20%5Bev.movementX%2C%20ev.movementY%5D.some%28function%28m2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20Math.abs%28m2%29%20%3E%201%3B%0A%20%20%20%20%20%20%20%20%7D%29%29%20%26%26%20%28state.isPointerDragging%20%3D%20true%29%3B%0A%20%20%20%20%20%20%20%20if%20%28state.enablePointerInteraction%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20offset%20%3D%20getOffset%28state.container%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.pointerPos.x%20%3D%20ev.pageX%20-%20offset.left%3B%0A%20%20%20%20%20%20%20%20%20%20state.pointerPos.y%20%3D%20ev.pageY%20-%20offset.top%3B%0A%20%20%20%20%20%20%20%20%20%20state.toolTipElem.style.top%20%3D%20%22%22.concat%28state.pointerPos.y%2C%20%22px%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.toolTipElem.style.left%20%3D%20%22%22.concat%28state.pointerPos.x%2C%20%22px%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.toolTipElem.style.transform%20%3D%20%22translate%28-%22.concat%28state.pointerPos.x%20%2F%20state.width%20%2A%20100%2C%20%22%25%2C%20%22%29.concat%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20flip%20to%20above%20if%20near%20bottom%0A%20%20%20%20%20%20%20%20%20%20%20%20state.height%20-%20state.pointerPos.y%20%3C%20100%20%3F%20%22calc%28-100%25%20-%208px%29%22%20%3A%20%2221px%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%29%22%0A%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20getOffset%28el%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20rect%20%3D%20el.getBoundingClientRect%28%29%2C%20scrollLeft%20%3D%20window.pageXOffset%20%7C%7C%20document.documentElement.scrollLeft%2C%20scrollTop%20%3D%20window.pageYOffset%20%7C%7C%20document.documentElement.scrollTop%3B%0A%20%20%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20top%3A%20rect.top%20%2B%20scrollTop%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20left%3A%20rect.left%20%2B%20scrollLeft%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%20%7B%0A%20%20%20%20%20%20%20%20passive%3A%20true%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20state.container.addEventListener%28%22pointerup%22%2C%20function%28ev%29%20%7B%0A%20%20%20%20%20%20state.isPointerPressed%20%3D%20false%3B%0A%20%20%20%20%20%20if%20%28state.isPointerDragging%29%20%7B%0A%20%20%20%20%20%20%20%20state.isPointerDragging%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20if%20%28%21state.clickAfterDrag%29%20return%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20requestAnimationFrame%28function%28%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28ev.button%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.onClick%28state.hoverObj%20%7C%7C%20null%2C%20ev%2C%20state.intersectionPoint%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28ev.button%20%3D%3D%3D%202%20%26%26%20state.onRightClick%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.onRightClick%28state.hoverObj%20%7C%7C%20null%2C%20ev%2C%20state.intersectionPoint%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%2C%20%7B%0A%20%20%20%20%20%20passive%3A%20true%2C%0A%20%20%20%20%20%20capture%3A%20true%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20state.container.addEventListener%28%22contextmenu%22%2C%20function%28ev%29%20%7B%0A%20%20%20%20%20%20if%20%28state.onRightClick%29%20ev.preventDefault%28%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20state.renderer%20%3D%20new%20%28useWebGPU%20%3F%20WebGPURenderer%20%3A%20three2.WebGLRenderer%29%28Object.assign%28%7B%0A%20%20%20%20%20%20antialias%3A%20true%2C%0A%20%20%20%20%20%20alpha%3A%20true%0A%20%20%20%20%7D%2C%20rendererConfig%29%29%3B%0A%20%20%20%20state.renderer.setPixelRatio%28Math.min%282%2C%20window.devicePixelRatio%29%29%3B%0A%20%20%20%20state.container.appendChild%28state.renderer.domElement%29%3B%0A%20%20%20%20state.extraRenderers%20%3D%20extraRenderers%3B%0A%20%20%20%20state.extraRenderers.forEach%28function%28r%29%20%7B%0A%20%20%20%20%20%20r.domElement.style.position%20%3D%20%22absolute%22%3B%0A%20%20%20%20%20%20r.domElement.style.top%20%3D%20%220px%22%3B%0A%20%20%20%20%20%20r.domElement.style.pointerEvents%20%3D%20%22none%22%3B%0A%20%20%20%20%20%20state.container.appendChild%28r.domElement%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20state.postProcessingComposer%20%3D%20new%20EffectComposer%28state.renderer%29%3B%0A%20%20%20%20state.postProcessingComposer.addPass%28new%20RenderPass%28state.scene%2C%20state.camera%29%29%3B%0A%20%20%20%20state.controls%20%3D%20new%20%7B%0A%20%20%20%20%20%20trackball%3A%20TrackballControls%2C%0A%20%20%20%20%20%20orbit%3A%20OrbitControls%2C%0A%20%20%20%20%20%20fly%3A%20FlyControls%0A%20%20%20%20%7D%5BcontrolType%5D%28state.camera%2C%20state.renderer.domElement%29%3B%0A%20%20%20%20if%20%28controlType%20%3D%3D%3D%20%22fly%22%29%20%7B%0A%20%20%20%20%20%20state.controls.movementSpeed%20%3D%20300%3B%0A%20%20%20%20%20%20state.controls.rollSpeed%20%3D%20Math.PI%20%2F%206%3B%0A%20%20%20%20%20%20state.controls.dragToLook%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28controlType%20%3D%3D%3D%20%22trackball%22%20%7C%7C%20controlType%20%3D%3D%3D%20%22orbit%22%29%20%7B%0A%20%20%20%20%20%20state.controls.minDistance%20%3D%200.1%3B%0A%20%20%20%20%20%20state.controls.maxDistance%20%3D%20state.skyRadius%3B%0A%20%20%20%20%20%20state.controls.addEventListener%28%22start%22%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20state.controlsEngaged%20%3D%20true%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20state.controls.addEventListener%28%22change%22%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28state.controlsEngaged%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state.controlsDragging%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20state.controls.addEventListener%28%22end%22%2C%20function%28%29%20%7B%0A%20%20%20%20%20%20%20%20state.controlsEngaged%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20state.controlsDragging%20%3D%20false%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20%5Bstate.renderer%2C%20state.postProcessingComposer%5D.concat%28_toConsumableArray4%28state.extraRenderers%29%29.forEach%28function%28r%29%20%7B%0A%20%20%20%20%20%20return%20r.setSize%28state.width%2C%20state.height%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20state.camera.aspect%20%3D%20state.width%20%2F%20state.height%3B%0A%20%20%20%20state.camera.updateProjectionMatrix%28%29%3B%0A%20%20%20%20state.camera.position.z%20%3D%201e3%3B%0A%20%20%20%20state.scene.add%28state.skysphere%20%3D%20new%20three2.Mesh%28%29%29%3B%0A%20%20%20%20state.skysphere.visible%20%3D%20false%3B%0A%20%20%20%20state.loadComplete%20%3D%20state.scene.visible%20%3D%20%21waitForLoadComplete%3B%0A%20%20%20%20window.scene%20%3D%20state.scene%3B%0A%20%20%7D%2C%0A%20%20update%3A%20function%20update3%28state%2C%20changedProps%29%20%7B%0A%20%20%20%20if%20%28state.width%20%26%26%20state.height%20%26%26%20%28changedProps.hasOwnProperty%28%22width%22%29%20%7C%7C%20changedProps.hasOwnProperty%28%22height%22%29%29%29%20%7B%0A%20%20%20%20%20%20state.container.style.width%20%3D%20%22%22.concat%28state.width%2C%20%22px%22%29%3B%0A%20%20%20%20%20%20state.container.style.height%20%3D%20%22%22.concat%28state.height%2C%20%22px%22%29%3B%0A%20%20%20%20%20%20%5Bstate.renderer%2C%20state.postProcessingComposer%5D.concat%28_toConsumableArray4%28state.extraRenderers%29%29.forEach%28function%28r%29%20%7B%0A%20%20%20%20%20%20%20%20return%20r.setSize%28state.width%2C%20state.height%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20state.camera.aspect%20%3D%20state.width%20%2F%20state.height%3B%0A%20%20%20%20%20%20state.camera.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28changedProps.hasOwnProperty%28%22skyRadius%22%29%20%26%26%20state.skyRadius%29%20%7B%0A%20%20%20%20%20%20state.controls.hasOwnProperty%28%22maxDistance%22%29%20%26%26%20changedProps.skyRadius%20%26%26%20%28state.controls.maxDistance%20%3D%20Math.min%28state.controls.maxDistance%2C%20state.skyRadius%29%29%3B%0A%20%20%20%20%20%20state.camera.far%20%3D%20state.skyRadius%20%2A%202.5%3B%0A%20%20%20%20%20%20state.camera.updateProjectionMatrix%28%29%3B%0A%20%20%20%20%20%20state.skysphere.geometry%20%3D%20new%20three2.SphereGeometry%28state.skyRadius%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28changedProps.hasOwnProperty%28%22backgroundColor%22%29%29%20%7B%0A%20%20%20%20%20%20var%20alpha%20%3D%20parseToRgb%28state.backgroundColor%29.alpha%3B%0A%20%20%20%20%20%20if%20%28alpha%20%3D%3D%3D%20void%200%29%20alpha%20%3D%201%3B%0A%20%20%20%20%20%20state.renderer.setClearColor%28new%20three2.Color%28curriedOpacify%241%281%2C%20state.backgroundColor%29%29%2C%20alpha%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28changedProps.hasOwnProperty%28%22backgroundImageUrl%22%29%29%20%7B%0A%20%20%20%20%20%20if%20%28%21state.backgroundImageUrl%29%20%7B%0A%20%20%20%20%20%20%20%20state.skysphere.visible%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20state.skysphere.material.map%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%21state.loadComplete%20%26%26%20finishLoad%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20new%20three2.TextureLoader%28%29.load%28state.backgroundImageUrl%2C%20function%28texture2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20texture2.colorSpace%20%3D%20three2.SRGBColorSpace%3B%0A%20%20%20%20%20%20%20%20%20%20state.skysphere.material%20%3D%20new%20three2.MeshBasicMaterial%28%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20map%3A%20texture2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20side%3A%20three2.BackSide%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.skysphere.visible%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20state.onBackgroundImageLoaded%20%26%26%20setTimeout%28state.onBackgroundImageLoaded%29%3B%0A%20%20%20%20%20%20%20%20%20%20%21state.loadComplete%20%26%26%20finishLoad%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20changedProps.hasOwnProperty%28%22showNavInfo%22%29%20%26%26%20%28state.navInfo.style.display%20%3D%20state.showNavInfo%20%3F%20null%20%3A%20%22none%22%29%3B%0A%20%20%20%20if%20%28changedProps.hasOwnProperty%28%22lights%22%29%29%20%7B%0A%20%20%20%20%20%20%28changedProps.lights%20%7C%7C%20%5B%5D%29.forEach%28function%28light%29%20%7B%0A%20%20%20%20%20%20%20%20return%20state.scene.remove%28light%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20state.lights.forEach%28function%28light%29%20%7B%0A%20%20%20%20%20%20%20%20return%20state.scene.add%28light%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20if%20%28changedProps.hasOwnProperty%28%22objects%22%29%29%20%7B%0A%20%20%20%20%20%20%28changedProps.objects%20%7C%7C%20%5B%5D%29.forEach%28function%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20return%20state.scene.remove%28obj%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20state.objects.forEach%28function%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20return%20state.scene.add%28obj%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20finishLoad%28%29%20%7B%0A%20%20%20%20%20%20state.loadComplete%20%3D%20state.scene.visible%20%3D%20true%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%29%3B%0A%0A%2F%2F%20..%2F..%2Fnode_modules%2F3d-force-graph%2Fdist%2F3d-force-graph.mjs%0Afunction%20styleInject2%28css%2C%20ref%29%20%7B%0A%20%20if%20%28ref%20%3D%3D%3D%20void%200%29%20ref%20%3D%20%7B%7D%3B%0A%20%20var%20insertAt%20%3D%20ref.insertAt%3B%0A%20%20if%20%28typeof%20document%20%3D%3D%3D%20%22undefined%22%29%20%7B%0A%20%20%20%20return%3B%0A%20%20%7D%0A%20%20var%20head%20%3D%20document.head%20%7C%7C%20document.getElementsByTagName%28%22head%22%29%5B0%5D%3B%0A%20%20var%20style%20%3D%20document.createElement%28%22style%22%29%3B%0A%20%20style.type%20%3D%20%22text%2Fcss%22%3B%0A%20%20if%20%28insertAt%20%3D%3D%3D%20%22top%22%29%20%7B%0A%20%20%20%20if%20%28head.firstChild%29%20%7B%0A%20%20%20%20%20%20head.insertBefore%28style%2C%20head.firstChild%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20head.appendChild%28style%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20head.appendChild%28style%29%3B%0A%20%20%7D%0A%20%20if%20%28style.styleSheet%29%20%7B%0A%20%20%20%20style.styleSheet.cssText%20%3D%20css%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20style.appendChild%28document.createTextNode%28css%29%29%3B%0A%20%20%7D%0A%7D%0Avar%20css_248z2%20%3D%20%22.graph-info-msg%20%7B%5Cn%20%20top%3A%2050%25%3B%5Cn%20%20width%3A%20100%25%3B%5Cn%20%20text-align%3A%20center%3B%5Cn%20%20color%3A%20lavender%3B%5Cn%20%20opacity%3A%200.7%3B%5Cn%20%20font-size%3A%2022px%3B%5Cn%20%20position%3A%20absolute%3B%5Cn%20%20font-family%3A%20Sans-serif%3B%5Cn%7D%5Cn%5Cn.scene-container%20.clickable%20%7B%5Cn%20%20cursor%3A%20pointer%3B%5Cn%7D%5Cn%5Cn.scene-container%20.grabbable%20%7B%5Cn%20%20cursor%3A%20move%3B%5Cn%20%20cursor%3A%20grab%3B%5Cn%20%20cursor%3A%20-moz-grab%3B%5Cn%20%20cursor%3A%20-webkit-grab%3B%5Cn%7D%5Cn%5Cn.scene-container%20.grabbable%3Aactive%20%7B%5Cn%20%20cursor%3A%20grabbing%3B%5Cn%20%20cursor%3A%20-moz-grabbing%3B%5Cn%20%20cursor%3A%20-webkit-grabbing%3B%5Cn%7D%22%3B%0AstyleInject2%28css_248z2%29%3B%0Afunction%20_arrayLikeToArray6%28r%2C%20a2%29%20%7B%0A%20%20%28null%20%3D%3D%20a2%20%7C%7C%20a2%20%3E%20r.length%29%20%26%26%20%28a2%20%3D%20r.length%29%3B%0A%20%20for%20%28var%20e%20%3D%200%2C%20n%20%3D%20Array%28a2%29%3B%20e%20%3C%20a2%3B%20e%2B%2B%29%20n%5Be%5D%20%3D%20r%5Be%5D%3B%0A%20%20return%20n%3B%0A%7D%0Afunction%20_arrayWithoutHoles5%28r%29%20%7B%0A%20%20if%20%28Array.isArray%28r%29%29%20return%20_arrayLikeToArray6%28r%29%3B%0A%7D%0Afunction%20_defineProperty4%28e%2C%20r%2C%20t%29%20%7B%0A%20%20return%20%28r%20%3D%20_toPropertyKey5%28r%29%29%20in%20e%20%3F%20Object.defineProperty%28e%2C%20r%2C%20%7B%0A%20%20%20%20value%3A%20t%2C%0A%20%20%20%20enumerable%3A%20true%2C%0A%20%20%20%20configurable%3A%20true%2C%0A%20%20%20%20writable%3A%20true%0A%20%20%7D%29%20%3A%20e%5Br%5D%20%3D%20t%2C%20e%3B%0A%7D%0Afunction%20_iterableToArray5%28r%29%20%7B%0A%20%20if%20%28%22undefined%22%20%21%3D%20typeof%20Symbol%20%26%26%20null%20%21%3D%20r%5BSymbol.iterator%5D%20%7C%7C%20null%20%21%3D%20r%5B%22%40%40iterator%22%5D%29%20return%20Array.from%28r%29%3B%0A%7D%0Afunction%20_nonIterableSpread5%28%29%20%7B%0A%20%20throw%20new%20TypeError%28%22Invalid%20attempt%20to%20spread%20non-iterable%20instance.%5CnIn%20order%20to%20be%20iterable%2C%20non-array%20objects%20must%20have%20a%20%5BSymbol.iterator%5D%28%29%20method.%22%29%3B%0A%7D%0Afunction%20ownKeys3%28e%2C%20r%29%20%7B%0A%20%20var%20t%20%3D%20Object.keys%28e%29%3B%0A%20%20if%20%28Object.getOwnPropertySymbols%29%20%7B%0A%20%20%20%20var%20o%20%3D%20Object.getOwnPropertySymbols%28e%29%3B%0A%20%20%20%20r%20%26%26%20%28o%20%3D%20o.filter%28function%28r2%29%20%7B%0A%20%20%20%20%20%20return%20Object.getOwnPropertyDescriptor%28e%2C%20r2%29.enumerable%3B%0A%20%20%20%20%7D%29%29%2C%20t.push.apply%28t%2C%20o%29%3B%0A%20%20%7D%0A%20%20return%20t%3B%0A%7D%0Afunction%20_objectSpread23%28e%29%20%7B%0A%20%20for%20%28var%20r%20%3D%201%3B%20r%20%3C%20arguments.length%3B%20r%2B%2B%29%20%7B%0A%20%20%20%20var%20t%20%3D%20null%20%21%3D%20arguments%5Br%5D%20%3F%20arguments%5Br%5D%20%3A%20%7B%7D%3B%0A%20%20%20%20r%20%25%202%20%3F%20ownKeys3%28Object%28t%29%2C%20true%29.forEach%28function%28r2%29%20%7B%0A%20%20%20%20%20%20_defineProperty4%28e%2C%20r2%2C%20t%5Br2%5D%29%3B%0A%20%20%20%20%7D%29%20%3A%20Object.getOwnPropertyDescriptors%20%3F%20Object.defineProperties%28e%2C%20Object.getOwnPropertyDescriptors%28t%29%29%20%3A%20ownKeys3%28Object%28t%29%29.forEach%28function%28r2%29%20%7B%0A%20%20%20%20%20%20Object.defineProperty%28e%2C%20r2%2C%20Object.getOwnPropertyDescriptor%28t%2C%20r2%29%29%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%7D%0A%20%20return%20e%3B%0A%7D%0Afunction%20_toConsumableArray5%28r%29%20%7B%0A%20%20return%20_arrayWithoutHoles5%28r%29%20%7C%7C%20_iterableToArray5%28r%29%20%7C%7C%20_unsupportedIterableToArray6%28r%29%20%7C%7C%20_nonIterableSpread5%28%29%3B%0A%7D%0Afunction%20_toPrimitive5%28t%2C%20r%29%20%7B%0A%20%20if%20%28%22object%22%20%21%3D%20typeof%20t%20%7C%7C%20%21t%29%20return%20t%3B%0A%20%20var%20e%20%3D%20t%5BSymbol.toPrimitive%5D%3B%0A%20%20if%20%28void%200%20%21%3D%3D%20e%29%20%7B%0A%20%20%20%20var%20i%20%3D%20e.call%28t%2C%20r%20%7C%7C%20%22default%22%29%3B%0A%20%20%20%20if%20%28%22object%22%20%21%3D%20typeof%20i%29%20return%20i%3B%0A%20%20%20%20throw%20new%20TypeError%28%22%40%40toPrimitive%20must%20return%20a%20primitive%20value.%22%29%3B%0A%20%20%7D%0A%20%20return%20%28%22string%22%20%3D%3D%3D%20r%20%3F%20String%20%3A%20Number%29%28t%29%3B%0A%7D%0Afunction%20_toPropertyKey5%28t%29%20%7B%0A%20%20var%20i%20%3D%20_toPrimitive5%28t%2C%20%22string%22%29%3B%0A%20%20return%20%22symbol%22%20%3D%3D%20typeof%20i%20%3F%20i%20%3A%20i%20%2B%20%22%22%3B%0A%7D%0Afunction%20_unsupportedIterableToArray6%28r%2C%20a2%29%20%7B%0A%20%20if%20%28r%29%20%7B%0A%20%20%20%20if%20%28%22string%22%20%3D%3D%20typeof%20r%29%20return%20_arrayLikeToArray6%28r%2C%20a2%29%3B%0A%20%20%20%20var%20t%20%3D%20%7B%7D.toString.call%28r%29.slice%288%2C%20-1%29%3B%0A%20%20%20%20return%20%22Object%22%20%3D%3D%3D%20t%20%26%26%20r.constructor%20%26%26%20%28t%20%3D%20r.constructor.name%29%2C%20%22Map%22%20%3D%3D%3D%20t%20%7C%7C%20%22Set%22%20%3D%3D%3D%20t%20%3F%20Array.from%28r%29%20%3A%20%22Arguments%22%20%3D%3D%3D%20t%20%7C%7C%20%2F%5E%28%3F%3AUi%7CI%29nt%28%3F%3A8%7C16%7C32%29%28%3F%3AClamped%29%3FArray%24%2F.test%28t%29%20%3F%20_arrayLikeToArray6%28r%2C%20a2%29%20%3A%20void%200%3B%0A%20%20%7D%0A%7D%0Afunction%20linkKapsule%28kapsulePropName%2C%20kapsuleType%29%20%7B%0A%20%20var%20dummyK%20%3D%20new%20kapsuleType%28%29%3B%0A%20%20dummyK._destructor%20%26%26%20dummyK._destructor%28%29%3B%0A%20%20return%20%7B%0A%20%20%20%20linkProp%3A%20function%20linkProp%28prop%29%20%7B%0A%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%22default%22%3A%20dummyK%5Bprop%5D%28%29%2C%0A%20%20%20%20%20%20%20%20onChange%3A%20function%20onChange13%28v%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20state%5BkapsulePropName%5D%5Bprop%5D%28v%29%3B%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkMethod%3A%20function%20linkMethod%28method%29%20%7B%0A%20%20%20%20%20%20return%20function%28state%29%20%7B%0A%20%20%20%20%20%20%20%20var%20kapsuleInstance%20%3D%20state%5BkapsulePropName%5D%3B%0A%20%20%20%20%20%20%20%20for%20%28var%20_len%20%3D%20arguments.length%2C%20args%20%3D%20new%20Array%28_len%20%3E%201%20%3F%20_len%20-%201%20%3A%200%29%2C%20_key%20%3D%201%3B%20_key%20%3C%20_len%3B%20_key%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20args%5B_key%20-%201%5D%20%3D%20arguments%5B_key%5D%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20returnVal%20%3D%20kapsuleInstance%5Bmethod%5D.apply%28kapsuleInstance%2C%20args%29%3B%0A%20%20%20%20%20%20%20%20return%20returnVal%20%3D%3D%3D%20kapsuleInstance%20%3F%20this%20%3A%20returnVal%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%7D%0Avar%20three3%20%3D%20window.THREE%20%3F%20window.THREE%20%3A%20%7B%0A%20%20AmbientLight%2C%0A%20%20DirectionalLight%2C%0A%20%20Vector3%2C%0A%20%20REVISION%0A%7D%3B%0Avar%20CAMERA_DISTANCE2NODES_FACTOR%20%3D%20170%3B%0Avar%20bindFG%20%3D%20linkKapsule%28%22forceGraph%22%2C%20threeForcegraph%29%3B%0Avar%20linkedFGProps%20%3D%20Object.assign.apply%28Object%2C%20_toConsumableArray5%28%5B%22jsonUrl%22%2C%20%22graphData%22%2C%20%22numDimensions%22%2C%20%22dagMode%22%2C%20%22dagLevelDistance%22%2C%20%22dagNodeFilter%22%2C%20%22onDagError%22%2C%20%22nodeRelSize%22%2C%20%22nodeId%22%2C%20%22nodeVal%22%2C%20%22nodeResolution%22%2C%20%22nodeColor%22%2C%20%22nodeAutoColorBy%22%2C%20%22nodeOpacity%22%2C%20%22nodeVisibility%22%2C%20%22nodeThreeObject%22%2C%20%22nodeThreeObjectExtend%22%2C%20%22linkSource%22%2C%20%22linkTarget%22%2C%20%22linkVisibility%22%2C%20%22linkColor%22%2C%20%22linkAutoColorBy%22%2C%20%22linkOpacity%22%2C%20%22linkWidth%22%2C%20%22linkResolution%22%2C%20%22linkCurvature%22%2C%20%22linkCurveRotation%22%2C%20%22linkMaterial%22%2C%20%22linkThreeObject%22%2C%20%22linkThreeObjectExtend%22%2C%20%22linkPositionUpdate%22%2C%20%22linkDirectionalArrowLength%22%2C%20%22linkDirectionalArrowColor%22%2C%20%22linkDirectionalArrowRelPos%22%2C%20%22linkDirectionalArrowResolution%22%2C%20%22linkDirectionalParticles%22%2C%20%22linkDirectionalParticleSpeed%22%2C%20%22linkDirectionalParticleWidth%22%2C%20%22linkDirectionalParticleColor%22%2C%20%22linkDirectionalParticleResolution%22%2C%20%22forceEngine%22%2C%20%22d3AlphaDecay%22%2C%20%22d3VelocityDecay%22%2C%20%22d3AlphaMin%22%2C%20%22ngraphPhysics%22%2C%20%22warmupTicks%22%2C%20%22cooldownTicks%22%2C%20%22cooldownTime%22%2C%20%22onEngineTick%22%2C%20%22onEngineStop%22%5D.map%28function%28p%29%20%7B%0A%20%20return%20_defineProperty4%28%7B%7D%2C%20p%2C%20bindFG.linkProp%28p%29%29%3B%0A%7D%29%29%29%3B%0Avar%20linkedFGMethods%20%3D%20Object.assign.apply%28Object%2C%20_toConsumableArray5%28%5B%22refresh%22%2C%20%22getGraphBbox%22%2C%20%22d3Force%22%2C%20%22d3ReheatSimulation%22%2C%20%22emitParticle%22%5D.map%28function%28p%29%20%7B%0A%20%20return%20_defineProperty4%28%7B%7D%2C%20p%2C%20bindFG.linkMethod%28p%29%29%3B%0A%7D%29%29%29%3B%0Avar%20bindRenderObjs%20%3D%20linkKapsule%28%22renderObjs%22%2C%20threeRenderObjects%29%3B%0Avar%20linkedRenderObjsProps%20%3D%20Object.assign.apply%28Object%2C%20_toConsumableArray5%28%5B%22width%22%2C%20%22height%22%2C%20%22backgroundColor%22%2C%20%22showNavInfo%22%2C%20%22enablePointerInteraction%22%5D.map%28function%28p%29%20%7B%0A%20%20return%20_defineProperty4%28%7B%7D%2C%20p%2C%20bindRenderObjs.linkProp%28p%29%29%3B%0A%7D%29%29%29%3B%0Avar%20linkedRenderObjsMethods%20%3D%20Object.assign.apply%28Object%2C%20_toConsumableArray5%28%5B%22lights%22%2C%20%22cameraPosition%22%2C%20%22postProcessingComposer%22%5D.map%28function%28p%29%20%7B%0A%20%20return%20_defineProperty4%28%7B%7D%2C%20p%2C%20bindRenderObjs.linkMethod%28p%29%29%3B%0A%7D%29%29.concat%28%5B%7B%0A%20%20graph2ScreenCoords%3A%20bindRenderObjs.linkMethod%28%22getScreenCoords%22%29%2C%0A%20%20screen2GraphCoords%3A%20bindRenderObjs.linkMethod%28%22getSceneCoords%22%29%0A%7D%5D%29%29%3B%0Avar%20_3dForceGraph%20%3D%20index2%28%7B%0A%20%20props%3A%20_objectSpread23%28_objectSpread23%28%7B%0A%20%20%20%20nodeLabel%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22name%22%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkLabel%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20%22name%22%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20linkHoverPrecision%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%201%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange11%28p%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20return%20state.renderObjs.lineHoverPrecision%28p%29%3B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20enableNavigationControls%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20true%2C%0A%20%20%20%20%20%20onChange%3A%20function%20onChange12%28enable%2C%20state%29%20%7B%0A%20%20%20%20%20%20%20%20var%20controls3%20%3D%20state.renderObjs.controls%28%29%3B%0A%20%20%20%20%20%20%20%20if%20%28controls3%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20controls3.enabled%20%3D%20enable%3B%0A%20%20%20%20%20%20%20%20%20%20enable%20%26%26%20controls3.domElement%20%26%26%20controls3.domElement.dispatchEvent%28new%20PointerEvent%28%22pointerup%22%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20enableNodeDrag%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20true%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onNodeDrag%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default12%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onNodeDragEnd%3A%20%7B%0A%20%20%20%20%20%20%22default%22%3A%20function%20_default13%28%29%20%7B%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onNodeClick%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onNodeRightClick%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onNodeHover%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onLinkClick%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onLinkRightClick%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onLinkHover%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onBackgroundClick%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%2C%0A%20%20%20%20onBackgroundRightClick%3A%20%7B%0A%20%20%20%20%20%20triggerUpdate%3A%20false%0A%20%20%20%20%7D%0A%20%20%7D%2C%20linkedFGProps%29%2C%20linkedRenderObjsProps%29%2C%0A%20%20methods%3A%20_objectSpread23%28_objectSpread23%28%7B%0A%20%20%20%20zoomToFit%3A%20function%20zoomToFit2%28state%2C%20transitionDuration%2C%20padding%29%20%7B%0A%20%20%20%20%20%20var%20_state%24forceGraph%3B%0A%20%20%20%20%20%20for%20%28var%20_len%20%3D%20arguments.length%2C%20bboxArgs%20%3D%20new%20Array%28_len%20%3E%203%20%3F%20_len%20-%203%20%3A%200%29%2C%20_key%20%3D%203%3B%20_key%20%3C%20_len%3B%20_key%2B%2B%29%20%7B%0A%20%20%20%20%20%20%20%20bboxArgs%5B_key%20-%203%5D%20%3D%20arguments%5B_key%5D%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.renderObjs.fitToBbox%28%28_state%24forceGraph%20%3D%20state.forceGraph%29.getGraphBbox.apply%28_state%24forceGraph%2C%20bboxArgs%29%2C%20transitionDuration%2C%20padding%29%3B%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20pauseAnimation%3A%20function%20pauseAnimation%28state%29%20%7B%0A%20%20%20%20%20%20if%20%28state.animationFrameRequestId%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20cancelAnimationFrame%28state.animationFrameRequestId%29%3B%0A%20%20%20%20%20%20%20%20state.animationFrameRequestId%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20resumeAnimation%3A%20function%20resumeAnimation%28state%29%20%7B%0A%20%20%20%20%20%20if%20%28state.animationFrameRequestId%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this._animationCycle%28%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20_animationCycle%3A%20function%20_animationCycle%28state%29%20%7B%0A%20%20%20%20%20%20if%20%28state.enablePointerInteraction%29%20%7B%0A%20%20%20%20%20%20%20%20this.renderer%28%29.domElement.style.cursor%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20state.forceGraph.tickFrame%28%29%3B%0A%20%20%20%20%20%20state.renderObjs.tick%28%29%3B%0A%20%20%20%20%20%20state.animationFrameRequestId%20%3D%20requestAnimationFrame%28this._animationCycle%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20scene%3A%20function%20scene2%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.renderObjs.scene%28%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20Expose%20scene%0A%20%20%20%20camera%3A%20function%20camera2%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.renderObjs.camera%28%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20Expose%20camera%0A%20%20%20%20renderer%3A%20function%20renderer2%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.renderObjs.renderer%28%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20Expose%20renderer%0A%20%20%20%20controls%3A%20function%20controls2%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.renderObjs.controls%28%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20Expose%20controls%0A%20%20%20%20tbControls%3A%20function%20tbControls2%28state%29%20%7B%0A%20%20%20%20%20%20return%20state.renderObjs.tbControls%28%29%3B%0A%20%20%20%20%7D%2C%0A%20%20%20%20%2F%2F%20To%20be%20deprecated%0A%20%20%20%20_destructor%3A%20function%20_destructor%28%29%20%7B%0A%20%20%20%20%20%20this.pauseAnimation%28%29%3B%0A%20%20%20%20%20%20this.graphData%28%7B%0A%20%20%20%20%20%20%20%20nodes%3A%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20links%3A%20%5B%5D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%7D%2C%20linkedFGMethods%29%2C%20linkedRenderObjsMethods%29%2C%0A%20%20stateInit%3A%20function%20stateInit3%28_ref5%29%20%7B%0A%20%20%20%20var%20controlType%20%3D%20_ref5.controlType%2C%20rendererConfig%20%3D%20_ref5.rendererConfig%2C%20extraRenderers%20%3D%20_ref5.extraRenderers%3B%0A%20%20%20%20var%20forceGraph%20%3D%20new%20threeForcegraph%28%29%3B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20forceGraph%2C%0A%20%20%20%20%20%20renderObjs%3A%20threeRenderObjects%28%7B%0A%20%20%20%20%20%20%20%20controlType%2C%0A%20%20%20%20%20%20%20%20rendererConfig%2C%0A%20%20%20%20%20%20%20%20extraRenderers%0A%20%20%20%20%20%20%7D%29.objects%28%5BforceGraph%5D%29.lights%28%5Bnew%20three3.AmbientLight%2813421772%2C%20Math.PI%29%2C%20new%20three3.DirectionalLight%2816777215%2C%200.6%20%2A%20Math.PI%29%5D%29%0A%20%20%20%20%7D%3B%0A%20%20%7D%2C%0A%20%20init%3A%20function%20init3%28domNode%2C%20state%29%20%7B%0A%20%20%20%20domNode.innerHTML%20%3D%20%22%22%3B%0A%20%20%20%20domNode.appendChild%28state.container%20%3D%20document.createElement%28%22div%22%29%29%3B%0A%20%20%20%20state.container.style.position%20%3D%20%22relative%22%3B%0A%20%20%20%20var%20roDomNode%20%3D%20document.createElement%28%22div%22%29%3B%0A%20%20%20%20state.container.appendChild%28roDomNode%29%3B%0A%20%20%20%20state.renderObjs%28roDomNode%29%3B%0A%20%20%20%20var%20camera3%20%3D%20state.renderObjs.camera%28%29%3B%0A%20%20%20%20var%20renderer3%20%3D%20state.renderObjs.renderer%28%29%3B%0A%20%20%20%20var%20controls3%20%3D%20state.renderObjs.controls%28%29%3B%0A%20%20%20%20controls3.enabled%20%3D%20%21%21state.enableNavigationControls%3B%0A%20%20%20%20state.lastSetCameraZ%20%3D%20camera3.position.z%3B%0A%20%20%20%20var%20infoElem%3B%0A%20%20%20%20state.container.appendChild%28infoElem%20%3D%20document.createElement%28%22div%22%29%29%3B%0A%20%20%20%20infoElem.className%20%3D%20%22graph-info-msg%22%3B%0A%20%20%20%20infoElem.textContent%20%3D%20%22%22%3B%0A%20%20%20%20state.forceGraph.onLoading%28function%28%29%20%7B%0A%20%20%20%20%20%20infoElem.textContent%20%3D%20%22Loading...%22%3B%0A%20%20%20%20%7D%29.onFinishLoading%28function%28%29%20%7B%0A%20%20%20%20%20%20infoElem.textContent%20%3D%20%22%22%3B%0A%20%20%20%20%7D%29.onUpdate%28function%28%29%20%7B%0A%20%20%20%20%20%20state.graphData%20%3D%20state.forceGraph.graphData%28%29%3B%0A%20%20%20%20%20%20if%20%28camera3.position.x%20%3D%3D%3D%200%20%26%26%20camera3.position.y%20%3D%3D%3D%200%20%26%26%20camera3.position.z%20%3D%3D%3D%20state.lastSetCameraZ%20%26%26%20state.graphData.nodes.length%29%20%7B%0A%20%20%20%20%20%20%20%20camera3.lookAt%28state.forceGraph.position%29%3B%0A%20%20%20%20%20%20%20%20state.lastSetCameraZ%20%3D%20camera3.position.z%20%3D%20Math.cbrt%28state.graphData.nodes.length%29%20%2A%20CAMERA_DISTANCE2NODES_FACTOR%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29.onFinishUpdate%28function%28%29%20%7B%0A%20%20%20%20%20%20if%20%28state._dragControls%29%20%7B%0A%20%20%20%20%20%20%20%20var%20curNodeDrag%20%3D%20state.graphData.nodes.find%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20node.__initialFixedPos%20%26%26%20%21node.__disposeControlsAfterDrag%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20if%20%28curNodeDrag%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20curNodeDrag.__disposeControlsAfterDrag%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20state._dragControls.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20state._dragControls%20%3D%20void%200%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if%20%28state.enableNodeDrag%20%26%26%20state.enablePointerInteraction%20%26%26%20state.forceEngine%20%3D%3D%3D%20%22d3%22%29%20%7B%0A%20%20%20%20%20%20%20%20var%20dragControls%20%3D%20state._dragControls%20%3D%20new%20DragControls%28state.graphData.nodes.map%28function%28node%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20node.__threeObj%3B%0A%20%20%20%20%20%20%20%20%7D%29.filter%28function%28obj%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20obj%3B%0A%20%20%20%20%20%20%20%20%7D%29%2C%20camera3%2C%20renderer3.domElement%29%3B%0A%20%20%20%20%20%20%20%20dragControls.addEventListener%28%22dragstart%22%2C%20function%28event%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20controls3.enabled%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20event.object.__initialPos%20%3D%20event.object.position.clone%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20event.object.__prevPos%20%3D%20event.object.position.clone%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20var%20node%20%3D%20getGraphObj%28event.object%29.__data%3B%0A%20%20%20%20%20%20%20%20%20%20%21node.__initialFixedPos%20%26%26%20%28node.__initialFixedPos%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20fx%3A%20node.fx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fy%3A%20node.fy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fz%3A%20node.fz%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%21node.__initialPos%20%26%26%20%28node.__initialPos%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20node.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20node.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20z%3A%20node.z%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%5B%22x%22%2C%20%22y%22%2C%20%22z%22%5D.forEach%28function%28c2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20node%5B%22f%22.concat%28c2%29%5D%20%3D%20node%5Bc2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20renderer3.domElement.classList.add%28%22grabbable%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20dragControls.addEventListener%28%22drag%22%2C%20function%28event%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20nodeObj%20%3D%20getGraphObj%28event.object%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28%21event.object.hasOwnProperty%28%22__graphObjType%22%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20initPos%20%3D%20event.object.__initialPos%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20prevPos%20%3D%20event.object.__prevPos%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20_newPos%20%3D%20event.object.position%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20nodeObj.position.add%28_newPos.clone%28%29.sub%28prevPos%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20prevPos.copy%28_newPos%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20_newPos.copy%28initPos%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20node%20%3D%20nodeObj.__data%3B%0A%20%20%20%20%20%20%20%20%20%20var%20newPos%20%3D%20nodeObj.position%3B%0A%20%20%20%20%20%20%20%20%20%20var%20translate%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20newPos.x%20-%20node.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20newPos.y%20-%20node.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20z%3A%20newPos.z%20-%20node.z%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%5B%22x%22%2C%20%22y%22%2C%20%22z%22%5D.forEach%28function%28c2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20node%5B%22f%22.concat%28c2%29%5D%20%3D%20node%5Bc2%5D%20%3D%20newPos%5Bc2%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20state.forceGraph.d3AlphaTarget%280.3%29.resetCountdown%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20node.__dragged%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20state.onNodeDrag%28node%2C%20translate%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20dragControls.addEventListener%28%22dragend%22%2C%20function%28event%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20delete%20event.object.__initialPos%3B%0A%20%20%20%20%20%20%20%20%20%20delete%20event.object.__prevPos%3B%0A%20%20%20%20%20%20%20%20%20%20var%20node%20%3D%20getGraphObj%28event.object%29.__data%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28node.__disposeControlsAfterDrag%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20dragControls.dispose%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20delete%20node.__disposeControlsAfterDrag%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20var%20initFixedPos%20%3D%20node.__initialFixedPos%3B%0A%20%20%20%20%20%20%20%20%20%20var%20initPos%20%3D%20node.__initialPos%3B%0A%20%20%20%20%20%20%20%20%20%20var%20translate%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3A%20initPos.x%20-%20node.x%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3A%20initPos.y%20-%20node.y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20z%3A%20initPos.z%20-%20node.z%0A%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28initFixedPos%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%22x%22%2C%20%22y%22%2C%20%22z%22%5D.forEach%28function%28c2%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20fc%20%3D%20%22f%22.concat%28c2%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28initFixedPos%5Bfc%5D%20%3D%3D%3D%20void%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20delete%20node%5Bfc%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20delete%20node.__initialFixedPos%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20delete%20node.__initialPos%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28node.__dragged%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20delete%20node.__dragged%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20state.onNodeDragEnd%28node%2C%20translate%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20state.forceGraph.d3AlphaTarget%280%29.resetCountdown%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28state.enableNavigationControls%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20controls3.enabled%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20controls3.domElement%20%26%26%20controls3.domElement.ownerDocument%20%26%26%20controls3.domElement.ownerDocument.dispatchEvent%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20simulate%20mouseup%20to%20ensure%20the%20controls%20don%27t%20take%20over%20after%20dragend%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20new%20PointerEvent%28%22pointerup%22%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pointerType%3A%20%22touch%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20renderer3.domElement.classList.remove%28%22grabbable%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20three3.REVISION%20%3C%20155%20%26%26%20%28state.renderObjs.renderer%28%29.useLegacyLights%20%3D%20false%29%3B%0A%20%20%20%20state.renderObjs.hoverOrderComparator%28function%28a2%2C%20b%29%20%7B%0A%20%20%20%20%20%20var%20aObj%20%3D%20getGraphObj%28a2%29%3B%0A%20%20%20%20%20%20if%20%28%21aObj%29%20return%201%3B%0A%20%20%20%20%20%20var%20bObj%20%3D%20getGraphObj%28b%29%3B%0A%20%20%20%20%20%20if%20%28%21bObj%29%20return%20-1%3B%0A%20%20%20%20%20%20var%20isNode%20%3D%20function%20isNode2%28o%29%20%7B%0A%20%20%20%20%20%20%20%20return%20o.__graphObjType%20%3D%3D%3D%20%22node%22%3B%0A%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20return%20isNode%28bObj%29%20-%20isNode%28aObj%29%3B%0A%20%20%20%20%7D%29.tooltipContent%28function%28obj%29%20%7B%0A%20%20%20%20%20%20var%20graphObj%20%3D%20getGraphObj%28obj%29%3B%0A%20%20%20%20%20%20return%20graphObj%20%3F%20index3%28state%5B%22%22.concat%28graphObj.__graphObjType%2C%20%22Label%22%29%5D%29%28graphObj.__data%29%20%7C%7C%20%22%22%20%3A%20%22%22%3B%0A%20%20%20%20%7D%29.hoverDuringDrag%28false%29.onHover%28function%28obj%29%20%7B%0A%20%20%20%20%20%20var%20hoverObj%20%3D%20getGraphObj%28obj%29%3B%0A%20%20%20%20%20%20if%20%28hoverObj%20%21%3D%3D%20state.hoverObj%29%20%7B%0A%20%20%20%20%20%20%20%20var%20prevObjType%20%3D%20state.hoverObj%20%3F%20state.hoverObj.__graphObjType%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20var%20prevObjData%20%3D%20state.hoverObj%20%3F%20state.hoverObj.__data%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20var%20objType%20%3D%20hoverObj%20%3F%20hoverObj.__graphObjType%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20var%20objData%20%3D%20hoverObj%20%3F%20hoverObj.__data%20%3A%20null%3B%0A%20%20%20%20%20%20%20%20if%20%28prevObjType%20%26%26%20prevObjType%20%21%3D%3D%20objType%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20fn%20%3D%20state%5B%22on%22.concat%28prevObjType%20%3D%3D%3D%20%22node%22%20%3F%20%22Node%22%20%3A%20%22Link%22%2C%20%22Hover%22%29%5D%3B%0A%20%20%20%20%20%20%20%20%20%20fn%20%26%26%20fn%28null%2C%20prevObjData%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if%20%28objType%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20_fn%20%3D%20state%5B%22on%22.concat%28objType%20%3D%3D%3D%20%22node%22%20%3F%20%22Node%22%20%3A%20%22Link%22%2C%20%22Hover%22%29%5D%3B%0A%20%20%20%20%20%20%20%20%20%20_fn%20%26%26%20_fn%28objData%2C%20prevObjType%20%3D%3D%3D%20objType%20%3F%20prevObjData%20%3A%20null%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20renderer3.domElement.classList%5BhoverObj%20%26%26%20state%5B%22on%22.concat%28objType%20%3D%3D%3D%20%22node%22%20%3F%20%22Node%22%20%3A%20%22Link%22%2C%20%22Click%22%29%5D%20%7C%7C%20%21hoverObj%20%26%26%20state.onBackgroundClick%20%3F%20%22add%22%20%3A%20%22remove%22%5D%28%22clickable%22%29%3B%0A%20%20%20%20%20%20%20%20state.hoverObj%20%3D%20hoverObj%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29.clickAfterDrag%28false%29.onClick%28function%28obj%2C%20ev%29%20%7B%0A%20%20%20%20%20%20var%20graphObj%20%3D%20getGraphObj%28obj%29%3B%0A%20%20%20%20%20%20if%20%28graphObj%29%20%7B%0A%20%20%20%20%20%20%20%20var%20fn%20%3D%20state%5B%22on%22.concat%28graphObj.__graphObjType%20%3D%3D%3D%20%22node%22%20%3F%20%22Node%22%20%3A%20%22Link%22%2C%20%22Click%22%29%5D%3B%0A%20%20%20%20%20%20%20%20fn%20%26%26%20fn%28graphObj.__data%2C%20ev%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20state.onBackgroundClick%20%26%26%20state.onBackgroundClick%28ev%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29.onRightClick%28function%28obj%2C%20ev%29%20%7B%0A%20%20%20%20%20%20var%20graphObj%20%3D%20getGraphObj%28obj%29%3B%0A%20%20%20%20%20%20if%20%28graphObj%29%20%7B%0A%20%20%20%20%20%20%20%20var%20fn%20%3D%20state%5B%22on%22.concat%28graphObj.__graphObjType%20%3D%3D%3D%20%22node%22%20%3F%20%22Node%22%20%3A%20%22Link%22%2C%20%22RightClick%22%29%5D%3B%0A%20%20%20%20%20%20%20%20fn%20%26%26%20fn%28graphObj.__data%2C%20ev%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20state.onBackgroundRightClick%20%26%26%20state.onBackgroundRightClick%28ev%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this._animationCycle%28%29%3B%0A%20%20%7D%0A%7D%29%3B%0Afunction%20getGraphObj%28object%29%20%7B%0A%20%20var%20obj%20%3D%20object%3B%0A%20%20while%20%28obj%20%26%26%20%21obj.hasOwnProperty%28%22__graphObjType%22%29%29%20%7B%0A%20%20%20%20obj%20%3D%20obj.parent%3B%0A%20%20%7D%0A%20%20return%20obj%3B%0A%7D%0A%0A%2F%2F%20%3Cstdin%3E%0Acore.ForceGraph3D%20%3D%20async%20%28args%2C%20env%29%20%3D%3E%20%7B%0A%20%20await%20interpretate.shared.SpriteText.load%28%29%3B%0A%20%20const%20data%20%3D%20await%20interpretate%28args%5B0%5D%2C%20env%29%3B%0A%20%20const%20SpriteText%20%3D%20interpretate.shared.SpriteText.SpriteText%3B%0A%20%20const%20opts%20%3D%20await%20core._getRules%28args%2C%20env%29%3B%0A%20%20const%20labels%20%3D%20%28opts.VertexLabels%20%7C%7C%20%5B%5D%29.reduce%28%28acc%2C%20%7B%20lhs%2C%20rhs%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20acc%5Blhs%5D%20%3D%20rhs%3B%0A%20%20%20%20return%20acc%3B%0A%20%20%7D%2C%20%7B%7D%29%3B%0A%20%20const%20nodeIds%20%3D%20%2F%2A%20%40__PURE__%20%2A%2F%20new%20Set%28%29%3B%0A%20%20const%20links%20%3D%20data.map%28%28%7B%20lhs%2C%20rhs%20%7D%29%20%3D%3E%20%7B%0A%20%20%20%20nodeIds.add%28lhs%29%3B%0A%20%20%20%20nodeIds.add%28rhs%29%3B%0A%20%20%20%20return%20%7B%20source%3A%20String%28rhs%29%2C%20target%3A%20String%28lhs%29%20%7D%3B%0A%20%20%7D%29%3B%0A%20%20const%20nodes%20%3D%20Array.from%28nodeIds%29.map%28%28id2%29%20%3D%3E%20%28%7B%0A%20%20%20%20id%3A%20String%28id2%29%2C%0A%20%20%20%20label%3A%20labels%5Bid2%5D%20%7C%7C%20String%28id2%29%0A%20%20%7D%29%29%3B%0A%20%20let%20imageSize%20%3D%20opts.ImageSize%20%7C%7C%20350%3B%0A%20%20if%20%28%21Array.isArray%28imageSize%29%29%20%7B%0A%20%20%20%20imageSize%20%3D%20%5BimageSize%2C%20imageSize%20%2A%200.7%5D%3B%0A%20%20%7D%0A%20%20const%20Graph%20%3D%20_3dForceGraph%28%7B%7D%29%28env.element%29.width%28imageSize%5B0%5D%29.height%28imageSize%5B1%5D%29.cooldownTicks%28100%29.graphData%28%7B%20nodes%2C%20links%20%7D%29.nodeThreeObject%28%28node%29%20%3D%3E%20%7B%0A%20%20%20%20const%20sprite%20%3D%20new%20SpriteText%28node.label%29%3B%0A%20%20%20%20sprite.material.depthWrite%20%3D%20true%3B%0A%20%20%20%20sprite.color%20%3D%20%22white%22%3B%0A%20%20%20%20sprite.textHeight%20%3D%2012%3B%0A%20%20%20%20return%20sprite%3B%0A%20%20%7D%29.nodeThreeObjectExtend%28false%29%3B%0A%20%20if%20%28%22Charge%22%20in%20opts%29%20%7B%0A%20%20%20%20Graph.d3Force%28%22charge%22%29.strength%28opts.Charge%29%3B%0A%20%20%7D%0A%20%20Graph.onEngineStop%28%28%29%20%3D%3E%20Graph.zoomToFit%28400%29%29%3B%0A%20%20env.local.Graph%20%3D%20Graph%3B%0A%7D%3B%0Acore.ForceGraph3D.destroy%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20console.warn%28%223D%20graph%20was%20removed%22%29%3B%0A%7D%3B%0Acore.ForceGraph3D.virtual%20%3D%20true%3B%0A%2F%2A%21%20Bundled%20license%20information%3A%0A%0Athree%2Fbuild%2Fthree.module.js%3A%0A%20%20%28%2A%2A%0A%20%20%20%2A%20%40license%0A%20%20%20%2A%20Copyright%202010-2024%20Three.js%20Authors%0A%20%20%20%2A%20SPDX-License-Identifier%3A%20MIT%0A%20%20%20%2A%29%0A%0Athree%2Fbuild%2Fthree.webgpu.js%3A%0A%20%20%28%2A%2A%0A%20%20%20%2A%20%40license%0A%20%20%20%2A%20Copyright%202010-2024%20Three.js%20Authors%0A%20%20%20%2A%20SPDX-License-Identifier%3A%20MIT%0A%20%20%20%2A%29%0A%2A%2F%0A"}),"\n",(0,a.jsxs)(t.p,{children:["Note, ",(0,a.jsx)(t.strong,{children:"you don't need to compile and reevaluate the cell above"})," an invisible output cell stores JS module in this notebook."]}),"\n",(0,a.jsx)(t.p,{children:"Now we need to register this symbol in Wolfram Language"}),"\n",(0,a.jsx)(n.EB,{display:"codemirror",nid:"0e558a46-d138-4d43-ac36-3fa77b0def40",id:"0dbd713f-67bf-4cd0-8390-818796ea949a",type:"Input",opts:{},children:"ForceGraph3D%20%2F%3A%20MakeBoxes%5Bf_ForceGraph3D%2C%20StandardForm%5D%20%3A%3D%20With%5B%7B%0A%20%20%28%2A%20compress%20it%20for%20the%20case%20if%20you%20have%20many%20labels%20and%20vertices%20%2A%29%0A%20%20o%20%3D%20CreateFrontEndObject%5Bf%5D%20%0A%7D%2C%0A%20%20%28%2A%20low-level%20decoration%20box%20%2A%29%0A%20%20ViewBox%5Bo%2C%20o%5D%0A%5D"}),"\n",(0,a.jsx)(t.h2,{id:"testing",children:"Testing"}),"\n",(0,a.jsx)(t.p,{children:"Let us make a simple graph"}),"\n",(0,a.jsx)(n.EB,{display:"codemirror",nid:"0e558a46-d138-4d43-ac36-3fa77b0def40",id:"5ec196d7-da48-4f56-b56a-2564160a9f68",type:"Input",opts:{},children:"ForceGraph3D%5B%7B%0A%20%201-%3E2%2C%202-%3E3%2C%203-%3E4%2C%204-%3E2%2C%203-%3E5%0A%7D%2C%20%22VertexLabels%22-%3E%7B1-%3E%22one%22%2C%204-%3E%22four%22%2C%205-%3E%22five%22%7D%2C%20ImageSize-%3E500%5D"}),"\n",(0,a.jsx)(n.EB,{display:"codemirror",nid:"0e558a46-d138-4d43-ac36-3fa77b0def40",id:"1eba839b-2ec1-432d-b7d0-9bc7bcb06565",type:"Output",opts:{},children:"%28%2AVB%5B%2A%29%28FrontEndExecutable%5B%227350994e-9424-4b9f-a7f0-dcc29c29ba2a%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKmxubGlhamqTqWpoYmeiaJFmm6SaapxnopiQnG1kCUVKiUSIAeQIVrA%3D%3D%22%2A%29%28%2A%5DVB%2A%29"}),"\n",(0,a.jsx)(t.p,{children:"Try to drag around the nodes."}),"\n",(0,a.jsx)(t.p,{children:"More nodes!"}),"\n",(0,a.jsx)(n.EB,{display:"codemirror",nid:"0e558a46-d138-4d43-ac36-3fa77b0def40",id:"d61df717-8c5d-4d28-83c2-bdb2560beba9",type:"Input",opts:{},children:"words%20%3D%20DictionaryLookup%5B%22pea%2A%22%5D%3B%0AFlatten%5BMap%5B%28Thread%5B%23%20-%3E%20%0A%20%20%20%20%20%20%20DeleteCases%5BNearest%5Bwords%2C%20%23%2C%203%5D%2C%20%23%5D%5D%29%20%26%2C%20words%5D%5D%3B%0A%0AForceGraph3D%5B%25%2C%20ImageSize-%3E500%5D"}),"\n",(0,a.jsx)(n.EB,{display:"codemirror",nid:"0e558a46-d138-4d43-ac36-3fa77b0def40",id:"1260ef7e-2244-43c8-90e8-bc3518853747",type:"Output",opts:{},children:"%28%2AVB%5B%2A%29%28FrontEndExecutable%5B%22bcb3e485-f716-4f53-bc06-81af27eda67a%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKJyUnGaeaWJjqppkbmumapJka6yYlG5jpWhgmphmZp6YkmpknAgCK7hYF%22%2A%29%28%2A%5DVB%2A%29"})]})}function c(e={}){const{wrapper:t}={...(0,i.M)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},46880:(e,t,r)=>{"use strict";r.d(t,{EB:()=>l,gL:()=>D,Af:()=>B});var a,i=r(11504);r(93391),r(28264);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},n.apply(this,arguments)}const A=e=>{let{title:t,titleId:r,...A}=e;return i.createElement("svg",n({xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"w-5 h-5 ml-auto",viewBox:"0 0 24 24","aria-labelledby":r},A),t?i.createElement("title",{id:r},t):null,a||(a=i.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",d:"M17 17h.01m.39-3h.6c.932 0 1.398 0 1.765.152a2 2 0 0 1 1.083 1.083C21 15.602 21 16.068 21 17s0 1.398-.152 1.765a2 2 0 0 1-1.083 1.083C19.398 20 18.932 20 18 20H6c-.932 0-1.398 0-1.765-.152a2 2 0 0 1-1.083-1.083C3 18.398 3 17.932 3 17s0-1.398.152-1.765a2 2 0 0 1 1.083-1.083C4.602 14 5.068 14 6 14h.6m5.4 1V4m0 11-3-3m3 3 3-3"})))};var o=r(66528),s=(r(98684),r(52964),r(93664),r(17624));function B(e){let{json:t,notebook:r,kernel:a}=e;const{colorMode:n,setColorMode:B}=(0,o.U)();return(0,i.useEffect)((()=>{console.warn("Create store"),console.warn(t);const e={},r={},i=[],n=new Deferred;let A=async()=>{A=async()=>{},fetch(t).then((t=>{console.warn("Store loaded!"),t.json().then((t=>{interpretate(t.objects,{hold:!0}).then((t=>{console.warn("Objects loaded!"),Object.keys(t).forEach((e=>{const r=new ObjectStorage(e);r.cache=t[e],r.cached=!0})),Object.keys(e).forEach((r=>{Array.isArray(e[r])?e[r].forEach((e=>e.resolve(t[r]))):e[r].resolve(t[r])}))})),interpretate(t.symbols,{hold:!0}).then((e=>{console.warn("Symbols loaded!"),Object.keys(e).forEach((t=>{core[t]=async(e,r)=>await interpretate(core[t].data,r),core[t].data=e[t],core[t]=async(e,r)=>{console.log("IE: calling our symbol...");const a=await interpretate(core[t].data,r);return r.root&&!r.novirtual&&(core[t].instances[r.root.uid]=r.root),a},core[t].update=async(e,r)=>{if(r.useCache)return core[t].cached&&core[t].currentData==core[t].data||(core[t].cached=await interpretate(core[t].data,r),core[t].currentData=core[t].data),core[t].cached;return await interpretate(core[t].data,r)},core[t].destroy=async(e,r)=>{delete core[t].instances[r.root.uid],console.warn(r.root.uid+" was destroyed"),console.warn("external symbol was destoryed")},core[t].data=structuredClone(e[t]),core[t].virtual=!0,core[t].instances={}})),Object.keys(r).forEach((t=>{console.warn(t),r[t].resolve(e[t])})),n.resolve()}))}))}))};core.Offload=(e,t)=>{if(e.length>1)if("'Static'"===e[1][1]){if(e[1][2])return interpretate(e[0],{...t,static:!0})}else if(e.length>2&&"'Static'"===e[2][1]&&e[2][2])return interpretate(e[0],{...t,static:!0});return interpretate(e[0],t)},core.Offload.update=(e,t)=>{if(e.length>1)if("'Volatile'"===e[1][1]){if(!e[1][2])return void console.log("Update was rejected (Nonvolatile)")}else if(e.length>2&&"'Volatile'"===e[2][1]&&!e[2][2])return void console.log("Update was rejected (Nonvolatile)");return interpretate(e[0],t)},window.server={kernel:{}},window.server.ask=t=>{const r=new Deferred;if(t.length<42)return console.error("Unknown command"),console.error(t),!1;return Array.isArray(e[t.slice(60,-2)])?e[t.slice(60,-2)].push(r):e[t.slice(60,-2)]=[r],A(),r.promise},window.server.getSymbol=e=>{const t=new Deferred;return console.warn("Asking for symbol"+e),r[e]=t,t.promise},window.server.kernel.emitt=function(e,t,r){void 0===r&&(r="Default"),i.push({uid:e,data:t,type:r})},interpretate.anonymous=async(e,t)=>{let a,i;if(console.log("Anonimous symbol: "+JSON.stringify(e)),e instanceof Array)throw console.error(e),"unknown WL expression. Error at "+e[0];a=e;const n=new Deferred;return console.warn("Asking for symbol"+a),r[a]=n,i=await n.promise,core[a]=async(e,t)=>{console.log("IE: calling our symbol...");const r=await interpretate(core[a].data,t);return t.root&&!t.novirtual&&(core[a].instances[t.root.uid]=t.root),r},core[a].update=async(e,t)=>{if(t.useCache)return core[a].cached&&core[a].currentData==core[a].data||(core[a].cached=await interpretate(core[a].data,t),core[a].currentData=core[a].data),core[a].cached;return await interpretate(core[a].data,t)},core[a].destroy=async(e,t)=>{delete core[a].instances[t.root.uid],console.warn(t.root.uid+" was destroyed"),console.warn("external symbol was destoryed")},core[a].data=i,core[a].virtual=!0,core[a].instances={},interpretate(e,t)},(async()=>{if(console.warn("Kernel"),a){if(console.warn("KERNEL"),!window.KernelState){const e=new Deferred,t=document.createElement("script");t.src="https://cdn.jsdelivr.net/gh/JerryI/wljs-export-html@base/dist/decoder.min.js",t.addEventListener("load",(()=>e.resolve())),document.head.appendChild(t),await e.promise,console.warn("KernelState lib loaded!")}fetch(a).then((e=>{console.log(e),e.json().then((async e=>{let t=[];for(const r of e)t.push(await interpretate.unzlib64String(r));t=t.map(KernelMesh.unpack),console.warn("Mesh loaded!"),console.log(t),window.server.kernel.emitt=function(e,r,a){void 0===a&&(a="Default"),setTimeout((()=>{const i={type:"event",uid:e,pattern:a,data:r},n=t;for(let e=0;e<n.length;++e)if(n[e].test(i)){if(n[e].state)n[e].state=new KernelState(n[e].state,i,!0);else{if(n[e].database.has("$initialization")){n[e].database.get("$initialization").forEach((t=>n[e].state=new KernelState(n[e].state,t,!0)))}n[e].state=new KernelState(n[e].state,i,!0)}n[e].state.exec(n[e].database,(e=>{for(const t of Object.keys(e))if(console.warn(t),"$state"!==t)if(1===e[t].set.length){console.log(e[t].set[0]),core[t].data=structuredClone(e[t].set[0]);for(const e of Object.values(core[t].instances))e.update()}else{e[t].i+=1,e[t].i>=e[t].set.length&&(e[t].i=0),core[t].data=structuredClone(e[t].set[e[t].i]);for(const e of Object.values(core[t].instances))e.update()}}))}}),4)},i.forEach((e=>window.server.kernel.emitt(e.uid,e.data,e.type)))}))}))}})()})),console.log("DONE loading mesh"),r?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("a",{href:r,className:"dark"==n?"p-2 text-xs w-full flex ring-1 ring-inset shadow ring-gray-300 text-gray-300 my-2":"p-2 text-xs w-full flex ring-1 ring-inset text-gray-600 shadow ring-gray-300 bg-gray-300 my-2",children:["Download original notebook ",(0,s.jsx)(A,{})]})}):(0,s.jsx)(s.Fragment,{})}function D(e){let{children:t,data:r}=e;const a={__html:decodeURIComponent(t)};return(0,s.jsx)("div",{dangerouslySetInnerHTML:a})}function l(e){let{children:t,nid:r,id:a,type:n,display:A,opts:B}=e;const D=(0,i.useRef)(null),{colorMode:l,setColorMode:c}=(0,o.U)(),u=decodeURIComponent(t),[d,C]=(0,i.useState)(B.Fade),[h,p]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const e=D.current;let t;if(console.warn("Create Codemirror"),console.warn(A),console.log(u),p(!0),console.warn("Created: "+A),"print"!=A){if(window.SupportedCells[A])return window.SupportedCells[A].view&&(t=new window.SupportedCells[A].view({element:e},u)),t.editor&&B.Fade&&(D.current.addEventListener("focusin",(()=>{C(!1)})),D.current.addEventListener("focusout",(()=>{C(!0)}))),()=>{t&&t.dispose()};console.warn("Not found: "+A)}}),[]),(0,s.jsx)("div",{style:{filter:"dark"==l?"invert(1) contrast(0.8) hue-rotate(-185deg)":"none"},className:"language-mathematica codeBlockContainer_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Container-styles-module theme-code-block",children:(0,s.jsx)("div",{className:d?"h-fade-20 codeBlockContent_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module":"codeBlockContent_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module",children:(0,s.jsxs)("pre",{tabIndex:"0",className:"prism-code language-mathematica codeBlock_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module thin-scrollbar",style:{color:"rgb(57, 58, 52)",backgroundColor:"rgb(246, 248, 250)"},children:[!h&&(0,s.jsx)("code",{style:{whiteSpace:"pre-wrap"},className:"codeBlockLines_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module",children:u}),(0,s.jsx)("code",{ref:D,className:"codeBlockLines_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module"})]})})})}},61848:(e,t,r)=>{"use strict";r.d(t,{c:()=>a});const a=r.p+"cd9d981d45a45432b7f70130ee89ef1d.txt"},15888:(e,t,r)=>{"use strict";r.d(t,{c:()=>a});const a=r.p+"67cf532c694e8bae065ebdf40247be7a.wln"},47944:()=>{},73223:()=>{}}]);