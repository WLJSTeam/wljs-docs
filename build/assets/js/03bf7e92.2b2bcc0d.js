"use strict";(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[17944],{59948:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var i=t(17624),a=t(4552);const r={title:"Animated bar charts",authors:"jerryi",tags:["animation","short"],enableComments:!0},s=void 0,l={permalink:"/wljs-docs/blog/2024/09/11/barcharts",source:"@site/blog/2024-09-11-barcharts.md",title:"Animated bar charts",description:"You've likely seen videos featuring animated bar charts with a timeline, where the bars dynamically shift and overtake each other",date:"2024-09-11T00:00:00.000Z",tags:[{label:"animation",permalink:"/wljs-docs/blog/tags/animation"},{label:"short",permalink:"/wljs-docs/blog/tags/short"}],readingTime:1.35,hasTruncateMarker:!0,authors:[{name:"Kirill Vasin",title:"Maintainer",url:"https://github.com/JerryI",imageURL:"https://avatars.githubusercontent.com/u/4111822?s=48&v=4",key:"jerryi"}],frontMatter:{title:"Animated bar charts",authors:"jerryi",tags:["animation","short"],enableComments:!0},unlisted:!1,prevItem:{title:"How to make simple counter animation for slides",permalink:"/wljs-docs/blog/2024/10/08/statcnt"},nextItem:{title:"Trippy raster animation",permalink:"/wljs-docs/blog/2024/09/07/raster"}},o={authorsImageUrls:[void 0]},c=[];function d(e){const n={code:"code",img:"img",p:"p",pre:"pre",...(0,a.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"You've likely seen videos featuring animated bar charts with a timeline, where the bars dynamically shift and overtake each other"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(25466).c+"",width:"800",height:"713"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mathematica",children:'Options[barTimelineAnimated] = {PlotLegends -> Automatic};\n\ngetMagnitude[e_Quantity] := QuantityMagnitude[e];\ngetMagnitude[e_] := e;\n\ngetLevels = Function[{list}, \n  SortBy[\n    MapIndexed[Function[{value, index}, {value, index // First}], Ordering[list]], \n    First\n  ][[All, 2]]\n];\n\nbarTimelineAnimated[l_List, OptionsPattern[]] := With[{\n  timeline = MinimalBy[(#["Times"] & /@ l), Length] // First,\n  labels = If[OptionValue[PlotLegends] === Automatic, Range[Length[l]], OptionValue[PlotLegends]],\n  interpolated = TimeSeries[#, MissingDataMethod -> Automatic] & /@ l\n},\n\n  With[{\n    first = getMagnitude[#[timeline // First]] & /@ interpolated\n  },\n\n    Module[{\n      levels = getLevels[first] / Length[first] // N,\n      order = getLevels[first],\n      rects,\n      date = timeline // First // DateObject // TextString,\n      recalc\n    },\n\n      recalc[index_] := With[{values = getMagnitude[#[timeline[[index]]]] & /@ interpolated},\n\n        With[{newOrdering = getLevels[values]},\n          If[order != newOrdering,\n            order = newOrdering;\n            levels = newOrdering / Length[first] // N;\n          ];\n        ];\n\n        date = timeline[[index]] // DateObject // TextString;\n\n        With[{min = Min[values], max = Max[values]},\n          rects = ((values - min) / (max - min) + 0.02) / 1.02;\n        ];\n      ];\n\n      recalc[1];\n\n      Column[{\n        With[{spacing = 0.8 / Length[levels]}, \n          Graphics[{\n            Text[date // Offload, {0.5, 0.}, {0, 0}],\n            Directive[TransitionType -> "CubicInOut", TransitionDuration -> 500],\n            Table[\n              With[{i = i},\n                Translate[{\n                  ColorData[97][i] // Lighter,\n                  {\n                    Directive[TransitionType -> "Linear", TransitionDuration -> 20],\n                    Rectangle[{0, 0}, {Offload[rects[[i]]], spacing}]\n                  },\n                  Black,\n                  Text[Style[labels[[i]], FontSize -> 14], {-0.02, spacing / 3.0}, {1, 0}]\n                }, {0, Offload[levels[[i]]]}]\n              ], \n              {i, 1, Length[rects]}\n            ]\n          }, PlotRange -> {{-0.4, 1}, {-0.1, 1 + spacing}}, ImagePadding -> None]\n        ],\n        \n        EventHandler[InputRange[1, Length[timeline], 1, 1], recalc]\n      }]\n    ]\n  ]\n];\n\n(* test it! *)\n\ncountry = {"Germany", "UK", "Switzerland", "Russia", "China"};\ngdp = CountryData[#, {"GDP", {1970, 2015}}] &/@ country;\n\nbarTimelineAnimated[gdp, PlotLegends->country]\n'})})]})}function m(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},25466:(e,n,t)=>{t.d(n,{c:()=>i});const i=t.p+"assets/images/SimpleBarNaimted1-ezgif.com-video-to-gif-converter-c20125ef834f79150e356dcf215f656f.gif"},4552:(e,n,t)=>{t.d(n,{I:()=>l,M:()=>s});var i=t(11504);const a={},r=i.createContext(a);function s(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);