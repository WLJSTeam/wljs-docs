"use strict";(self.webpackChunkwljs_docs=self.webpackChunkwljs_docs||[]).push([[7604],{3905:(e,a,t)=>{t.d(a,{Zo:()=>l,kt:()=>d});var n=t(7294);function s(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function p(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){s(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var i=n.createContext({}),m=function(e){var a=n.useContext(i),t=a;return e&&(t="function"==typeof e?e(a):p(p({},a),e)),t},l=function(e){var a=m(e.components);return n.createElement(i.Provider,{value:a},e.children)},c="mdxType",k={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},N=n.forwardRef((function(e,a){var t=e.components,s=e.mdxType,r=e.originalType,i=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),c=m(t),N=s,d=c["".concat(i,".").concat(N)]||c[N]||k[N]||r;return t?n.createElement(d,p(p({ref:a},l),{},{components:t})):n.createElement(d,p({ref:a},l))}));function d(e,a){var t=arguments,s=a&&a.mdxType;if("string"==typeof e||s){var r=t.length,p=new Array(r);p[0]=N;var o={};for(var i in a)hasOwnProperty.call(a,i)&&(o[i]=a[i]);o.originalType=e,o[c]="string"==typeof e?e:s,p[1]=o;for(var m=2;m<r;m++)p[m]=t[m];return n.createElement.apply(null,p)}return n.createElement.apply(null,t)}N.displayName="MDXCreateElement"},7433:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>i,contentTitle:()=>p,default:()=>k,frontMatter:()=>r,metadata:()=>o,toc:()=>m});var n=t(7462),s=(t(7294),t(3905));const r={sidebar_position:8},p=void 0,o={unversionedId:"frontend/Expressions representation",id:"frontend/Expressions representation",title:"Expressions representation",description:"The aim is to make a compromise between DisplayForm and InputForm representations Wolfram Expressions on the frontend's side.",source:"@site/docs/frontend/Expressions representation.md",sourceDirName:"frontend",slug:"/frontend/Expressions representation",permalink:"/wljs-docs/docs/frontend/Expressions representation",draft:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"frontendSidebar",previous:{title:"Mathematica vs WLJS",permalink:"/wljs-docs/docs/frontend/Mathematica vs WLJS"},next:{title:"Advanced",permalink:"/wljs-docs/docs/category/advanced-1"}},i={},m=[{value:"Balancing between InputForm and DisplayFrom",id:"balancing-between-inputform-and-displayfrom",level:2},{value:"For the sake of performance",id:"for-the-sake-of-performance",level:3}],l={toc:m},c="wrapper";function k(e){let{components:a,...t}=e;return(0,s.kt)(c,(0,n.Z)({},l,t,{components:a,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"The aim is to make a compromise between ",(0,s.kt)("inlineCode",{parentName:"p"},"DisplayForm")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"InputForm")," representations Wolfram Expressions on the frontend's side."),(0,s.kt)("admonition",{type:"note"},(0,s.kt)("p",{parentName:"admonition"},"In Mathematica notebook (",(0,s.kt)("inlineCode",{parentName:"p"},"DisplayForm"),") everything you type becomes a bunch of ",(0,s.kt)("strong",{parentName:"p"},"wrapper functions  being executed on a small WL interpreter"),", which runs on a java-frontend")),(0,s.kt)("p",null,"what user see"),(0,s.kt)("p",null,(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mfrac",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"mfrac"},"1"),(0,s.kt)("mn",{parentName:"mfrac"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\frac{1}{2}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.1901em",verticalAlign:"-0.345em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,s.kt)("span",{parentName:"span",className:"mfrac"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8451em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.655em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,s.kt)("span",{parentName:"span",style:{top:"-3.394em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.345em"}},(0,s.kt)("span",{parentName:"span"}))))),(0,s.kt)("span",{parentName:"span",className:"mclose nulldelimiter"}))))))),(0,s.kt)("p",null,"what it actually is"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-mathematica"},'Cell[BoxData[FractionBox["1", "2"]], "Input"]\n')),(0,s.kt)("p",null,"i.e. this is an executable object, written as a sort of computable WL functions."),(0,s.kt)("p",null,"The power of Mathematica's frontend, that it expands and follows the paradigm of WL, where "),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"Everything is an expression")),(0,s.kt)("p",null,"to all interactive objects, including mostly graphics. It makes you feel like you are still operating a bunch of symbolic expressions underneath it"),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"Graphics is a syntax sugar")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-mathematica"},"Cuboid[]//Graphics3D\n% /. {Cuboid :> Sphere}\n")),(0,s.kt)("p",null,"The idea to reproduce full functionality of Mathematica's frontend in this manner is doomed by a few reasons"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"frontend functions are poorly documented"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("del",{parentName:"li"},"WYSIWIG editor with mutable WL expressions inside is a mess")," (see ",(0,s.kt)("a",{parentName:"li",href:"/wljs-docs/docs/frontend/Decorations"},"Decorations"),")"),(0,s.kt)("li",{parentName:"ul"},"even with a ~20 years of development, Mathematica frontend is quite laggy")),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"With some compromises, giving to a user a full control and ability to customize the processes under the hood it might result in an extremely flexible tool.")),(0,s.kt)("p",null,"Since Mathematica is a paid software, one have to do it from the scratch."),(0,s.kt)("h2",{id:"balancing-between-inputform-and-displayfrom"},"Balancing between InputForm and DisplayFrom"),(0,s.kt)("p",null,"In principle, we do not need to make the whole WL expression mutable and interactive. There are only a few cases, where we really need this"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Graphics, sliders, buttons and etc - ",(0,s.kt)("strong",{parentName:"li"},"separate objects")),(0,s.kt)("li",{parentName:"ol"},"Syntax sugar for fractions, square roots, matrixes and etc. - ",(0,s.kt)("strong",{parentName:"li"},"mixed"))),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"The first one")," (",(0,s.kt)("strong",{parentName:"p"},"separate objects"),") can be even separated from the actual code-area, since it originally works as inline block (a symbol or an atom). "),(0,s.kt)("p",null,"In the simples case one could just replace graphic objects with images (svgs) and substitute it to some advanced HTML-like editor, like a lot people did before"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Jupyter"),(0,s.kt)("li",{parentName:"ul"},"Wolfram Notebook VS Code extension")),(0,s.kt)("p",null,"Anyway, since ",(0,s.kt)("inlineCode",{parentName:"p"},"Plot")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"Plot3D")," is an overset of ",(0,s.kt)("inlineCode",{parentName:"p"},"Graphics")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"Graphics3D")," symbols with a recipe inside made from other symbols, one need to cook it and display to the user, i.e. ",(0,s.kt)("strong",{parentName:"p"},"we need a frontend WL interpreter for sure"),". Since the portability is great - we should use web-stack, where Javascript rules all computations. See ",(0,s.kt)("a",{parentName:"p",href:"/wljs-docs/docs/interpreter/intro"},"WLJS Interpreter")),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"The second one")," (",(0,s.kt)("strong",{parentName:"p"},"mixed"),") is rather tricky to implement fully, since it involves mutable WL expressions. "),(0,s.kt)("p",null,"However, here also we have a solution. Nowadays developers are using sort-of syntax sugar for the live previews of Markdown, where the code you typing is replaced by the corresponding styled object. A good example is Obsidian - notes making app based on CodeMirror 6 Decorations. Which will require to write a WL tokenizer inside the editor. TL-DR see ",(0,s.kt)("a",{parentName:"p",href:"/wljs-docs/docs/frontend/Decorations"},"Decorations")),(0,s.kt)("h3",{id:"for-the-sake-of-performance"},"For the sake of performance"),(0,s.kt)("p",null,"For the most cases there is no point in interpreting the whole output expression.\nLets have a look at the ",(0,s.kt)("inlineCode",{parentName:"p"},"DisplayForm")," output from Mathematica or Wolfram Engine for\n",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mfrac",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"mfrac"},(0,s.kt)("mi",{parentName:"mrow"},"a"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mi",{parentName:"mrow"},"b")),(0,s.kt)("msqrt",{parentName:"mfrac"},(0,s.kt)("mn",{parentName:"msqrt"},"2")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\frac{a\\times b}{\\sqrt{2}}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.4181em",verticalAlign:"-0.538em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,s.kt)("span",{parentName:"span",className:"mfrac"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8801em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.551em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord sqrt mtight"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.9128em"}},(0,s.kt)("span",{parentName:"span",className:"svg-align",style:{top:"-3em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mtight",style:{paddingLeft:"0.833em"}},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2"))),(0,s.kt)("span",{parentName:"span",style:{top:"-2.8728em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"hide-tail mtight",style:{minWidth:"0.853em",height:"1.08em"}},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.08em",viewBox:"0 0 400000 1080",preserveAspectRatio:"xMinYMin slice"},(0,s.kt)("path",{parentName:"svg",d:"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"}))))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1272em"}},(0,s.kt)("span",{parentName:"span"})))))))),(0,s.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,s.kt)("span",{parentName:"span",style:{top:"-3.394em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"a"),(0,s.kt)("span",{parentName:"span",className:"mbin mtight"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"b"))))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.538em"}},(0,s.kt)("span",{parentName:"span"}))))),(0,s.kt)("span",{parentName:"span",className:"mclose nulldelimiter"}))))))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-mathematica"},'FractionBox[RowBox[{"a", " ", "b"}], SqrtBox["2"]]\n')),(0,s.kt)("p",null,"what I (as @JerryI a maintainer) would like to simplify here - ",(0,s.kt)("strong",{parentName:"p"},"keep the actual code")," "),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-mathematica"},"FractionBox[a b, SqrtBox[2]]\n")),(0,s.kt)("p",null,"to remove an overhead while editing those expressions. Thankfully, it can easily be done using Wolfram Language"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-mathematica"},"RowBoxAlt[x_List, y___] := StringJoin @@ (ToString[#] & /@ x)\n( (a b)/Sqrt[2] // ToBoxes ) /. {RowBox -> RowBoxAlt} // ToString\n")),(0,s.kt)("p",null,"The issues with styling and etc can also be solved - see ",(0,s.kt)("a",{parentName:"p",href:"/wljs-docs/docs/frontend/Decorations"},"Decorations")))}k.isMDXComponent=!0}}]);