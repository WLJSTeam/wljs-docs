(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[87960],{26832:(s,e,a)=>{"use strict";a.r(e),a.d(e,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>m,toc:()=>o});var n=a(17624),i=a(4552),t=a(46880);const l=a.p+"assets/medias/Spin_system-83740217bdf73011242a11902eeafd02.mov",r={authors:"jerryi",tags:["quantum","animation"],enableComments:!0},c="Modelling quantum spin-system with orbital degeneracy",m={permalink:"/wljs-docs/blog/2023/10/10/spin-hamiltonian",source:"@site/blog/2023-10-10-spin-hamiltonian/index.mdx",title:"Modelling quantum spin-system with orbital degeneracy",description:"This notebook delves into quantum mechanics with a focus on symbolic quantum operators and spin-Hamiltonians. It begins with setting up orthogonality rules and defining the linear properties of basis functions.",date:"2023-10-10T00:00:00.000Z",tags:[{label:"quantum",permalink:"/wljs-docs/blog/tags/quantum"},{label:"animation",permalink:"/wljs-docs/blog/tags/animation"}],readingTime:5.755,hasTruncateMarker:!0,authors:[{name:"Kirill Vasin",title:"Maintainer",url:"https://github.com/JerryI",imageURL:"https://avatars.githubusercontent.com/u/4111822?s=48&v=4",key:"jerryi"}],frontMatter:{authors:"jerryi",tags:["quantum","animation"],enableComments:!0},unlisted:!1,prevItem:{title:"An overview of Wolfram Language and WLJS",permalink:"/wljs-docs/blog/2023/12/12/notebook"},nextItem:{title:"Image and Raster were implemented!",permalink:"/wljs-docs/blog/imageraster"}},d={authorsImageUrls:[void 0]},o=[{value:"Setting up rules",id:"setting-up-rules",level:2},{value:"Symbolic quantum operators",id:"symbolic-quantum-operators",level:2},{value:"Testing",id:"testing",level:3},{value:"Spin-Hamiltonian",id:"spin-hamiltonian",level:2},{value:"Implementation",id:"implementation",level:3},{value:"Ferromagnetic ordering",id:"ferromagnetic-ordering",level:2},{value:"Implementation",id:"implementation-1",level:3},{value:"Progress bar",id:"progress-bar",level:4},{value:"Converting operators to matrixes",id:"converting-operators-to-matrixes",level:3},{value:"Modelling",id:"modelling",level:2},{value:"Real-time modelling",id:"real-time-modelling",level:2}];function h(s){const e={a:"a",annotation:"annotation",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",math:"math",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msqrt:"msqrt",msub:"msub",msup:"msup",mtext:"mtext",p:"p",path:"path",semantics:"semantics",span:"span",strong:"strong",svg:"svg",...(0,i.M)(),...s.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:"This notebook delves into quantum mechanics with a focus on symbolic quantum operators and spin-Hamiltonians. It begins with setting up orthogonality rules and defining the linear properties of basis functions."}),"\n",(0,n.jsxs)(e.p,{children:["Next, we investigate the spin-Hamiltonian for a cubic system with doubly degenerated orbital states, particularly focusing on ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"e"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:"2"}),(0,n.jsx)(e.mo,{children:"+"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"Fe^{2+}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8141em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"F"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mtight",children:"2"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"+"})]})})]})})})})})]})]})})]})," ions in cubic spinels with ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mrow,{}),(0,n.jsx)(e.mn,{children:"5"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"E"}),(0,n.jsx)(e.mi,{children:"g"})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"^5E_g"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.1002em",verticalAlign:"-0.2861em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"5"})})]})})})})})]}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0576em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"g"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})," states. The Hamiltonian for a paramagnetic state is presented and implemented in code, followed by defining basis vectors and functions to find eigenvalues and eigenvectors, and calculating thermal averages of quantum operators."]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.p,{children:["Let us start from the ground level - ",(0,n.jsx)(e.em,{children:"how to represent a state"})]}),"\n","\n",(0,n.jsx)(t.Af,{json:a(4128).c,notebook:a(63112).c}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"75d9f1a8-f8de-4944-9675-3d80ddf19a87",type:"Output",opts:{},children:"%28%2ABB%5B%2A%29%28Ket%5B%28%2AFB%5B%2A%29%28%281%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282%29%29%28%2A%5DFB%2A%29%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29"}),"\n",(0,n.jsx)(e.p,{children:"Just copy and paste the expression above to have prettier representation of your wavefunction."}),"\n",(0,n.jsxs)(e.p,{children:["Let's work with wavefunction in the basis of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"S=2"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"2"})]})]})]})," and a doubly-degenerated orbital state ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.mover,{accent:"true",children:[(0,n.jsx)(e.mi,{children:"L"}),(0,n.jsx)(e.mo,{children:"^"})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\hat{L}=1/2"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.9468em"}}),(0,n.jsx)(e.span,{className:"mord accent",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.9468em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"L"})]}),(0,n.jsxs)(e.span,{style:{top:"-3.2523em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"accent-body",style:{left:"-0.2222em"},children:(0,n.jsx)(e.span,{className:"mord",children:"^"})})]})]})})})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1/2"})]})]})]})]}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"fcef7bb0-031c-45cc-94d8-fec7f794bde5",type:"Input",opts:{},children:"%28%2ABB%5B%2A%29%28Ket%5BMs%2C%20Ml%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29"}),"\n",(0,n.jsx)(e.h2,{id:"setting-up-rules",children:"Setting up rules"}),"\n",(0,n.jsx)(e.p,{children:"Firstly, define the ortogonality of our basis functions"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"0f0a1000-2228-4cf5-a6b4-abe66b0a0f22",type:"Input",opts:{InitGroup:!0},children:"Ket%20%2F%3A%20%28%2ABB%5B%2A%29%28Bra%5BMs1_%2C%20Ml1_%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMaeiRJfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABBAEzo%3D%22%2A%29%28%2A%5DBB%2A%29.%28%2ABB%5B%2A%29%28Ket%5BMs2_%2C%20Ml2_%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%20%3A%3D%20KroneckerDelta%5BMs1%2C%20Ms2%5D%20KroneckerDelta%5BMl1%2C%20Ml2%5D%0A%0AKet%20%2F%3A%20Conjugate%5B%28%2ABB%5B%2A%29%28Ket%5BMs2_%2C%20Ml2_%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%5D%20%3A%3D%20%28%2ABB%5B%2A%29%28Bra%5BMs2%2C%20Ml2%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMaeiRJfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABBAEzo%3D%22%2A%29%28%2A%5DBB%2A%29%20%20"}),"\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"Linear properties"})," must also be defined as well"]}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"9f55b8ec-17af-42a4-8aa4-2f63e34f1076",type:"Input",opts:{InitGroup:!0},children:"Unprotect%5BDot%5D%3B%0AUnprotect%5BConjugate%5D%3B%0A%0AConjugate%5Ba_%20b_%5D%20%3A%3D%20Conjugate%5Ba%5D%20Conjugate%5Bb%5D%0AConjugate%5Ba_%20%2B%20b_%5D%20%3A%3D%20Conjugate%5Ba%5D%20%2B%20Conjugate%5Bb%5D%0ADot%5Ba_%2C%20b_%3FNumericQ%5D%20%3A%3D%20b%20a%0ADot%5Bb_%3FNumericQ%2C%20a_%5D%20%3A%3D%20b%20a%0ADot%5Ba_%20%2B%20b_%2C%20c_%5D%20%3A%3D%20a.c%20%2B%20b.c%20%0ADot%5Bc_%2C%20a_%20%2B%20b_%5D%20%3A%3D%20c.a%20%2B%20c.b%20%20%0ADot%5Ba_%2C%20b_%3FNumericQ%20c_%5D%20%3A%3D%20b%20a.c%0ADot%5Bb_%3FNumericQ%20c_%2C%20a_%5D%20%3A%3D%20b%20c.a%0A%0AProtect%5BDot%5D%3B%0AProtect%5BConjugate%5D%3B"}),"\n",(0,n.jsx)(e.h2,{id:"symbolic-quantum-operators",children:"Symbolic quantum operators"}),"\n",(0,n.jsxs)(e.p,{children:["A well known ladder-like operators (see ",(0,n.jsx)(e.a,{href:"https://easyspin.org/easyspin/documentation/spinoperators.html",children:"more here"}),") as well as pauli-like operators ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"U"}),(0,n.jsx)(e.mi,{children:"\u03b8"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"U_\\theta"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.109em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"\u03b8"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),", ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"U"}),(0,n.jsx)(e.mi,{children:"\u03b5"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"U_\\varepsilon"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.109em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"\u03b5"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})," for an orbital doublet"]}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"34f1e933-2579-47ac-9d9d-5334f990c173",type:"Input",opts:{InitGroup:!0},children:"Ket%20%2F%3A%20Sp.%28%2ABB%5B%2A%29%28Ket%5BMs_%2C%20Ml_%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%20%3A%3D%20%28%2ASqB%5B%2A%29Sqrt%5B2%282%2B1%29%20-%20%28Ms%2B1%29Ms%5D%28%2A%5DSqB%2A%29%20%28%2ABB%5B%2A%29%28Ket%5BMs%2B1%2C%20Ml%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%0AKet%20%2F%3A%20Sm.%28%2ABB%5B%2A%29%28Ket%5BMs_%2C%20Ml_%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%20%3A%3D%20%28%2ASqB%5B%2A%29Sqrt%5B2%282%2B1%29%20-%20%28Ms-1%29Ms%5D%28%2A%5DSqB%2A%29%20%28%2ABB%5B%2A%29%28Ket%5BMs-1%2C%20Ml%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%0AKet%20%2F%3A%20Sz.%28%2ABB%5B%2A%29%28Ket%5BMs_%2C%20Ml_%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%20%3A%3D%20Ms%20%28%2ABB%5B%2A%29%28Ket%5BMs%2C%20Ml%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%0A%0AU%CE%B8%20%3D%20Sum%5B%28%2ABB%5B%2A%29%28Ket%5BMs%2C1%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29.%28%2ABB%5B%2A%29%28Bra%5BMs%2C%201%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMaeiRJfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABBAEzo%3D%22%2A%29%28%2A%5DBB%2A%29%20-%20%28%2ABB%5B%2A%29%28Ket%5BMs%2C-1%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29.%28%2ABB%5B%2A%29%28Bra%5BMs%2C%20-1%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMaeiRJfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABBAEzo%3D%22%2A%29%28%2A%5DBB%2A%29%2C%20%7BMs%2C-2%2C2%7D%5D%3B%0AU%CF%B5%20%3D%20Sum%5B%28%2ABB%5B%2A%29%28Ket%5BMs%2C1%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29.%28%2ABB%5B%2A%29%28Bra%5BMs%2C%20-1%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMaeiRJfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABBAEzo%3D%22%2A%29%28%2A%5DBB%2A%29%20%2B%20%28%2ABB%5B%2A%29%28Ket%5BMs%2C-1%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29.%28%2ABB%5B%2A%29%28Bra%5BMs%2C%201%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMaeiRJfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABBAEzo%3D%22%2A%29%28%2A%5DBB%2A%29%2C%20%7BMs%2C-2%2C2%7D%5D%3B%0A%0ASx%20%3D%20%28%2AFB%5B%2A%29%28%281%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282%29%29%28%2A%5DFB%2A%29%28Sp%20%2B%20Sm%29%3B%0ASy%20%3D%20%20%28%2AFB%5B%2A%29%28%281%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282I%20%29%29%28%2A%5DFB%2A%29%28Sp%20-%20Sm%29%3B%20%0A"}),"\n",(0,n.jsx)(e.h3,{id:"testing",children:"Testing"}),"\n",(0,n.jsx)(e.p,{children:"check a single operator"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"712f64a9-e8f7-4c89-ab9a-de5e91396c44",type:"Input",opts:{},children:"Sm.%28%2ABB%5B%2A%29%28Ket%5B0%2C1%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"f039f870-17ce-4bdd-93a1-df4dad254e95",type:"Output",opts:{},children:"%28%28%2ASqB%5B%2A%29Sqrt%5B6%5D%28%2A%5DSqB%2A%29%29%20%28%28%2ABB%5B%2A%29%28Ket%5B-1%2C1%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%29"}),"\n",(0,n.jsx)(e.p,{children:"We can also build the matrix of a operator in the basis of spin-only states"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"3cc87509-2d6d-40e6-bf22-704536ae3ffa",type:"Input",opts:{},children:"Table%5B%0A%0A%20%20%28%2ABB%5B%2A%29%28Bra%5BMs1%2C%201%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMaeiRJfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABBAEzo%3D%22%2A%29%28%2A%5DBB%2A%29.%28Sz%29.%28%2ABB%5B%2A%29%28Ket%5BMs2%2C%201%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%0A%0A%2C%20%7BMs1%2C%20-2%2C2%7D%2C%20%7BMs2%2C%20-2%2C2%7D%5D%20%2F%2F%20MatrixForm%20"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"94da53aa-2903-4980-b377-909f98e0b262",type:"Output",opts:{},children:"%28%28%2AGB%5B%2A%29%7B%7B-2%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B0%28%2A%7C%2A%29%2C%28%2A%7C%2A%29-1%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B0%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B0%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%291%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B0%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%292%7D%7D%28%2A%5DGB%2A%29%29"}),"\n",(0,n.jsx)(e.p,{children:"Now check the modulus of an spin-momentum"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"8d137b94-3783-4faa-9d8f-96d1026f44be",type:"Input",opts:{},children:"Table%5B%0A%0A%20%20%28%2ABB%5B%2A%29%28Bra%5BMs1%2C%201%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMaeiRJfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABBAEzo%3D%22%2A%29%28%2A%5DBB%2A%29.%28Sz.Sz%20%2B%20Sx.Sx%20%2B%20Sy.Sy%29.%28%2ABB%5B%2A%29%28Ket%5BMs2%2C%201%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%0A%0A%2C%20%7BMs1%2C%20-2%2C2%7D%2C%20%7BMs2%2C%20-2%2C2%7D%5D%20%2F%2F%20MatrixForm%20"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"2ed8138f-66a2-42e3-bc42-54d9b282e186",type:"Output",opts:{},children:"%28%28%2AGB%5B%2A%29%7B%7B6%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B0%28%2A%7C%2A%29%2C%28%2A%7C%2A%296%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B0%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%296%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B0%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%296%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B0%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%290%28%2A%7C%2A%29%2C%28%2A%7C%2A%296%7D%7D%28%2A%5DGB%2A%29%29"}),"\n",(0,n.jsxs)(e.p,{children:["This is correct! As it should be ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mn,{children:"6"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"S(S + 1) = 6"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1"}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"6"})]})]})]})]}),"\n",(0,n.jsx)(e.h2,{id:"spin-hamiltonian",children:"Spin-Hamiltonian"}),"\n",(0,n.jsxs)(e.p,{children:["Let us have a look at the cubic system with a doubly degenerated orbital states. For example, it can be effectively ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"F"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"e"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:"2"}),(0,n.jsx)(e.mo,{children:"+"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"Fe^{2+}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8141em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"F"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mtight",children:"2"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"+"})]})})]})})})})})]})]})})]})," ions in a cubic spinels with ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mrow,{}),(0,n.jsx)(e.mn,{children:"5"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"E"}),(0,n.jsx)(e.mi,{children:"g"})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"^5E_g"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.1002em",verticalAlign:"-0.2861em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"5"})})]})})})})})]}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0576em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"g"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})," states as a ground multiplet. Let us have a look at the Hamiltonian for a paramagnetic state"]}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"H"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mi,{children:"\u03bc"}),(0,n.jsx)(e.mi,{children:"g"}),(0,n.jsx)(e.mtext,{children:"\xa0"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:"bold",children:"S"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:"bold",children:"H"}),(0,n.jsx)(e.mn,{mathvariant:"bold",children:"0"})]})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mi,{children:"d"}),(0,n.jsx)(e.mo,{fence:"false",stretchy:"true",minsize:"1.8em",maxsize:"1.8em",children:"["}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"U"}),(0,n.jsx)(e.mi,{children:"\u03b8"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mn,{children:"3"}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"z"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.msqrt,{children:(0,n.jsx)(e.mn,{children:"3"})}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"U"}),(0,n.jsx)(e.mi,{children:"\u03f5"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"y"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{fence:"false",stretchy:"true",minsize:"1.8em",maxsize:"1.8em",children:"]"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"H = \\mu g~ \\mathbf{S H_0} - d \\Big[ U_{\\theta} (3 Sz^2 - S(S+1)) + \\sqrt{3} U_{\\epsilon}(Sx^2 - Sy^2)  \\Big] "})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8805em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03bcg"}),(0,n.jsx)(e.span,{className:"mspace nobreak",children:"\xa0"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathbf",children:"S"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathbf",children:"H"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathbf mtight",children:"0"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.8em",verticalAlign:"-0.65em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"delimsizing size2",children:"["})}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.109em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"\u03b8"})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord",children:"3"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"z"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8641em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1"}),(0,n.jsx)(e.span,{className:"mclose",children:"))"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.2061em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord sqrt",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.9561em"},children:[(0,n.jsxs)(e.span,{className:"svg-align",style:{top:"-3em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",style:{paddingLeft:"0.833em"},children:(0,n.jsx)(e.span,{className:"mord",children:"3"})})]}),(0,n.jsxs)(e.span,{style:{top:"-2.9161em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"hide-tail",style:{minWidth:"0.853em",height:"1.08em"},children:(0,n.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.08em",viewBox:"0 0 400000 1080",preserveAspectRatio:"xMinYMin slice",children:(0,n.jsx)(e.path,{d:"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.0839em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.109em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"\u03f5"})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8641em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.8em",verticalAlign:"-0.65em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8641em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"delimsizing size2",children:"]"})})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:["where ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"d"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"d"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"d"})]})})]})," accounts for an effective spin-orbit coupling and then dictates cubic anistoropy for the spin"]}),"\n",(0,n.jsx)(e.h3,{id:"implementation",children:"Implementation"}),"\n",(0,n.jsx)(e.p,{children:"Now we move to the actual code"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"4093b274-8e97-4f30-8ccb-2876acdb3ecf",type:"Input",opts:{InitGroup:!0},children:"%CE%BC%20%3D%200.466%3B%0Ag%20%3D%202.%3B"}),"\n",(0,n.jsx)(e.p,{children:"Effective hamiltonian in our notations"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"871e3517-a110-4a95-b065-8f9b5272e000",type:"Input",opts:{InitGroup:!0},children:"H%5BHx_%2C%20Hy_%2C%20Hz_%2C%20d_%5D%20%3A%3D%20%CE%BC%20g%20%28Hx%20Sx%20%2B%20Hy%20Sy%20%2B%20Hz%20Sz%20%29%20-%20d%20%283%20Sz.Sz.U%CE%B8%20-%20%202%282%2B1%29%20U%CE%B8%20%2B%20%28%2ASqB%5B%2A%29Sqrt%5B3%5D%28%2A%5DSqB%2A%29%20Sx.Sx.U%CF%B5%20-%20%28%2ASqB%5B%2A%29Sqrt%5B3%5D%28%2A%5DSqB%2A%29%20Sy.Sy.U%CF%B5%29"}),"\n",(0,n.jsxs)(e.p,{children:["Now define an array of basis vectors and function to ",(0,n.jsx)(e.strong,{children:"find eigenvalues and eigenvectors"})]}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"51af0447-17fb-4d21-92e9-5ee1d160da06",type:"Input",opts:{InitGroup:!0},children:"basis%20%3D%20Table%5B%28%2ABB%5B%2A%29%28Ket%5BMs2%2C%20Ml%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNiYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFxTxAMe%2FUEpfU5PyixJL8IohKFiARVJqTGgxieKQmpgQzQ9QBABLAE1g%3D%22%2A%29%28%2A%5DBB%2A%29%2C%20%7BMs2%2C-2%2C2%7D%2C%20%7BMl%2C-1%2C1%2C2%7D%5D%20%2F%2F%20Flatten%3B%20%0A%0Asystem%5Bparams__%5D%20%3A%3D%20With%5B%7B%20h%20%3D%20Simplify%5BH%5Bparams%5D%5D%7D%2C%20With%5B%7B%0A%20%20r%20%3D%20Table%5B%0A%0A%20%20%20%20Conjugate%5Bi%5D.%28h.j%29%0A%0A%20%20%2C%20%7Bi%2C%20basis%7D%2C%20%7Bj%2C%20basis%7D%5D%20%20%2F%2F%20Eigensystem%20%2F%2F%20Transpose%20%0A%7D%2C%0A%0A%20%20%28%2A%20truncate%20accuracy%20%2A%29%0A%20%20r%20%2F%2F%20Chop%0A%5D%20%5D"}),"\n",(0,n.jsxs)(e.p,{children:["Now we need a helper function to find a ",(0,n.jsx)(e.strong,{children:"thermal average of any quantum operator"})]}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"87b512a0-d724-466c-845c-551b28b56a51",type:"Input",opts:{InitGroup:!0},children:"%28%2A%20for%20caching%20already%20calculated%20values%20%2A%29%0A%0AClearAll%5Bcached%5D%3B%0Acached%5Bexpr_%5D%20%3A%3D%20cached%5Bexpr%5D%20%3D%20expr%3B%0ASetAttributes%5Bcached%2C%20HoldFirst%5D%0A%0A%0Aaverage%5Bsys_%2C%20T_%2C%20operator_%5D%20%3A%3D%20With%5B%7B%0A%20%20operatorMatrix%20%3D%20cached%5BTable%5BConjugate%5Bi%5D.operator.j%2C%20%7Bi%2C%20basis%7D%2C%20%7Bj%2C%20basis%7D%5D%5D%2C%0A%20%20%0A%20%20stat%20%3D%20Total%5BExp%5B-%28%2AFB%5B%2A%29%28%28%23%5B%5B1%5D%5D%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%280.7%20T%29%29%28%2A%5DFB%2A%29%5D%20%26%2F%40%20sys%5D%0A%7D%2C%0A%20%20Map%5B%0A%20%20%20%20%28%28Conjugate%5B%7B%23%5B%5B2%5D%5D%7D%5D.operatorMatrix.Transpose%5B%7B%23%5B%5B2%5D%5D%7D%5D%29%20%2F%2F%20First%20%2F%2F%20First%29%20%28%2AFB%5B%2A%29%28%281%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%28stat%29%29%28%2A%5DFB%2A%29%20Exp%5B-%28%2AFB%5B%2A%29%28%28%23%5B%5B1%5D%5D%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%280.7%20T%29%29%28%2A%5DFB%2A%29%5D%20%26%0A%20%20%20%20%2C%20sys%5D%20%2F%2F%20Total%20%20%0A%5D"}),"\n",(0,n.jsxs)(e.p,{children:["Usually for such systems a parameter ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"d"}),(0,n.jsx)(e.mo,{children:"\u2243"}),(0,n.jsx)(e.mn,{children:"3"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"4"}),(0,n.jsx)(e.mtext,{children:"\xa0"}),(0,n.jsx)(e.mi,{children:"c"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"m"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"d\\simeq 3-4~cm^{-1}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"\u2243"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,n.jsx)(e.span,{className:"mord",children:"3"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8141em"}}),(0,n.jsx)(e.span,{className:"mord",children:"4"}),(0,n.jsx)(e.span,{className:"mspace nobreak",children:"\xa0"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"c"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"m"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})})})})})]})]})]})]}),"."]}),"\n",(0,n.jsxs)(e.p,{children:["Let's try to see a magnetic anisotropy in an averaged magnetic moment of a single ion site at ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"T"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mn,{children:"10"}),(0,n.jsx)(e.mtext,{children:"\xa0"}),(0,n.jsx)(e.mi,{children:"K"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"T=10~K"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord",children:"10"}),(0,n.jsx)(e.span,{className:"mspace nobreak",children:"\xa0"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"})]})]})]})," in the magnetic field around ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mn,{children:"10"}),(0,n.jsx)(e.mtext,{children:"\xa0"}),(0,n.jsx)(e.mi,{children:"T"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"10~T"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord",children:"10"}),(0,n.jsx)(e.span,{className:"mspace nobreak",children:"\xa0"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"})]})})]})]}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"300638ac-7c5f-406b-883f-24f341f61a29",type:"Input",opts:{InitGroup:!0},children:"Table%5B%0A%20%20With%5B%7B%0A%20%20%20%20%28%2ABB%5B%2A%29%28%2Aapply%20a%20magnetic%20field%20to%20the%20given%20direction%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0A%20%20%20%20sys%20%3D%20system%5B10%20Sin%5Bx%5D%2C%2010%20Cos%5Bx%5D%2C%200%2C%203.%5D%0A%20%20%7D%2C%0A%20%20%20%20%28%2ABB%5B%2A%29%28%2Aproject%20magnetic%20moment%20to%20the%20direction%20of%20field%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0A%20%20%20%20%282.0%20average%5Bsys%2C%2010%2C%20%23%5D%20%26%2F%40%20%7BSx%2C%20Sy%7D%29.%28%7BSin%5Bx%5D%2C%20%20Cos%5Bx%5D%7D%29%0A%20%20%20%0A%20%20%5D%20%7BSin%5Bx%5D%2C%20%20Cos%5Bx%5D%7D%0A%2C%20%7Bx%2C%200%2C%202Pi%2C%200.1%7D%5D%20%2F%2F%20Re%3B%0A%0AListLinePlot%5B%25%2C%20%0A%20%20PlotRange-%3EFull%2C%20%0A%20%20Epilog-%3E%7B%0A%20%20%20%20Black%20%2F%2F%20Lighter%2C%20Arrow%5B%7B%7B0%2C%200%7D%2C%20%7B2.5501%2C%200.0%7D%7D%5D%2C%0A%20%20%20%20Arrow%5B%7B%7B0%2C0%7D%2C%20%7B0%2C%202.52099%7D%7D%5D%0A%7D%2C%20AxesLabel-%3E%7B%22%5C%5Cmu%20x%22%2C%20%22%5C%5Cmu%20y%22%7D%2C%20ImageSize-%3E500%2C%20AspectRatio-%3E1%5D"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"36788727-23bc-4fff-881c-3b4b3655095b",type:"Output",opts:{},children:"%28%2AVB%5B%2A%29%28FrontEndRef%5B%22c7710bc3-f3fa-4da9-b610-78b5b046c42c%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKJ5ubGxokJRvrphmnJeqapCRa6iaZGRromlskmSYZmJglmxglAwCKFxXG%22%2A%29%28%2A%5DVB%2A%29"}),"\n",(0,n.jsxs)(e.p,{children:["It is clear, ",(0,n.jsx)(e.strong,{children:"that a cubic anistropy is quite visible here"})," \ud83d\udcab"]}),"\n",(0,n.jsxs)(e.p,{children:["Actually, this is not a typical spin system with a fixed magnetic anisotropy. Here it comes from the orbital degeneracy, which is lifted in magnetic fields. However, it also means, that the field can change anisotropy. The less field we apply, the less spin prjection we have, the less splitting between the orbital states we have, and therefore the less anisotropy we observe. ",(0,n.jsx)(e.em,{children:"Try to evaluate the cell above using different fields"})]}),"\n",(0,n.jsx)(e.h2,{id:"ferromagnetic-ordering",children:"Ferromagnetic ordering"}),"\n",(0,n.jsxs)(e.p,{children:["One can go further and model an ordered state using ",(0,n.jsx)(e.em,{children:"mean field approximation"}),", which is suitable for ferromagnets"]}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"H"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mi,{children:"\u03bc"}),(0,n.jsx)(e.mi,{children:"g"}),(0,n.jsx)(e.mtext,{children:"\xa0"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:"bold",children:"S"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{mathvariant:"bold",children:"H"}),(0,n.jsx)(e.mn,{mathvariant:"bold",children:"0"})]})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mi,{children:"d"}),(0,n.jsx)(e.mo,{fence:"false",stretchy:"true",minsize:"1.8em",maxsize:"1.8em",children:"["}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"U"}),(0,n.jsx)(e.mi,{children:"\u03b8"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mn,{children:"3"}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"z"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.msqrt,{children:(0,n.jsx)(e.mn,{children:"3"})}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"U"}),(0,n.jsx)(e.mi,{children:"\u03f5"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:"y"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{fence:"false",stretchy:"true",minsize:"1.8em",maxsize:"1.8em",children:"]"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{children:"J"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:"bold",children:"S"}),(0,n.jsx)(e.mi,{mathvariant:"bold",children:"M"})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"H = \\mu g~ \\mathbf{S H_0} - d \\Big[ U_{\\theta} (3 Sz^2 - S(S+1)) + \\sqrt{3} U_{\\epsilon}(Sx^2 - Sy^2)  \\Big] + J \\mathbf{S M}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8805em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03bcg"}),(0,n.jsx)(e.span,{className:"mspace nobreak",children:"\xa0"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathbf",children:"S"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathbf",children:"H"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathbf mtight",children:"0"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.8em",verticalAlign:"-0.65em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"delimsizing size2",children:"["})}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.109em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"\u03b8"})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord",children:"3"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"z"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8641em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord",children:"1"}),(0,n.jsx)(e.span,{className:"mclose",children:"))"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.2061em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord sqrt",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.9561em"},children:[(0,n.jsxs)(e.span,{className:"svg-align",style:{top:"-3em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",style:{paddingLeft:"0.833em"},children:(0,n.jsx)(e.span,{className:"mord",children:"3"})})]}),(0,n.jsxs)(e.span,{style:{top:"-2.9161em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"hide-tail",style:{minWidth:"0.853em",height:"1.08em"},children:(0,n.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.08em",viewBox:"0 0 400000 1080",preserveAspectRatio:"xMinYMin slice",children:(0,n.jsx)(e.path,{d:"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.0839em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"U"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.109em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"\u03f5"})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8641em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.8em",verticalAlign:"-0.65em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8641em"},children:(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"delimsizing size2",children:"]"})}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6861em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord mathbf",children:"SM"})})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:["where ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"M"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"M"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"})]})})]})," is an average of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.mover,{accent:"true",children:[(0,n.jsx)(e.mi,{children:"S"}),(0,n.jsx)(e.mo,{children:"^"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\hat{S}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.9468em"}}),(0,n.jsx)(e.span,{className:"mord accent",children:(0,n.jsx)(e.span,{className:"vlist-t",children:(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.9468em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"})]}),(0,n.jsxs)(e.span,{style:{top:"-3.2523em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"accent-body",style:{left:"-0.1667em"},children:(0,n.jsx)(e.span,{className:"mord",children:"^"})})]})]})})})})]})})]})," (i.e. just a classical vector)."]}),"\n",(0,n.jsx)(e.h3,{id:"implementation-1",children:"Implementation"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"7e23f79d-bb36-41c6-af0c-7f3e21815c49",type:"Input",opts:{},children:"H%5BHx_%2C%20Hy_%2C%20Hz_%2C%20d_%2C%20J_%2C%20Mx_%2C%20My_%2C%20Mz_%5D%20%3A%3D%20%CE%BC%20g%20%28Hx%20Sx%20%2B%20Hy%20Sy%20%2B%20Hz%20Sz%20%29%20-%20d%20%283%20Sz.Sz.U%CE%B8%20-%20%202%282%2B1%29%20U%CE%B8%20%2B%20%28%2ASqB%5B%2A%29Sqrt%5B3%5D%28%2A%5DSqB%2A%29%20Sx.Sx.U%CF%B5%20-%20%28%2ASqB%5B%2A%29Sqrt%5B3%5D%28%2A%5DSqB%2A%29%20Sy.Sy.U%CF%B5%29%20%2B%20J%20%28Mx%20Sx%20%2B%20My%20Sy%20%2B%20Mz%20Sz%29"}),"\n",(0,n.jsx)(e.p,{children:"Now it becomes more computationally expensive to do. It is better monitor the progress, for this reason we need a helper function"}),"\n",(0,n.jsx)(t.gL,{children:"%3Cbr%20%2F%3E"}),"\n",(0,n.jsx)(e.h4,{id:"progress-bar",children:"Progress bar"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"49a3d89f-99d5-48f8-b879-e6ecef6cc279",type:"Input",opts:{InitGroup:!0,Fade:!0},children:"progressBar.wl%0A%0AModule%5B%7BprogressBar%7D%2C%0A%20%20progressBar%5Bmax_%2C%20OptionsPattern%5B%5D%20%5D%20%3A%3D%20With%5B%7Bcell%20%3D%20OptionValue%5B%22Cell%22%5D%7D%2C%20LeakyModule%5B%7Bprogress%20%3D%200.%2C%20indicator%20%3D%200.%2C%20handler%2C%20timer%20%3D%20AbsoluteTime%5B%5D%7D%2C%0A%20%20%20%20With%5B%7B%0A%20%20%20%20%20%20%20%20cell%20%3D%20CellPrint%5BToString%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20Graphics%5B%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20LightBlue%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Rectangle%5B%7B-0.004%2C-0.12%7D%2C%20%7B1.004%2C1.12%7D%5D%2C%20Green%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Rectangle%5B%7B0%2C0%7D%2C%20%7BOffload%5Bindicator%5D%2C1%7D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20PlotRange-%3E%7B%7B0%2C1%7D%2C%20%7B0%2C1%7D%7D%2C%20ImagePadding-%3E0%2C%20ImageSize-%3E%7B300%2C%2020%7D%2C%20Controls-%3EFalse%5D%0A%20%20%20%20%20%20%20%20%2C%20StandardForm%5D%2C%20%22After%22-%3Ecell%5D%0A%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20handler%5Bn_%5D%20%3A%3D%20With%5B%7Bdiff%20%3D%20AbsoluteTime%5B%5D%20-%20timer%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20progress%20%3D%20n%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20If%5Bdiff%20%3E%200.03%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20indicator%20%3D%20progress%20%2F%20max%20%2F%2F%20N%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20timer%20%3D%20AbsoluteTime%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20If%5BAbs%5Bprogress%20-%20max%5D%20%3C%200.1%2C%20Delete%5Bcell%5D%20%5D%3B%0A%20%20%20%20%20%20%20%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20handler%0A%20%20%20%20%5D%0A%20%20%5D%20%5D%3B%0A%0A%20%20%20%20Options%5BprogressBar%5D%20%3D%20%7B%22Cell%22%3A%3EEvaluationCell%5B%5D%7D%3B%0A%0A%20%20%20%20progressBar%0A%5D"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.em,{children:"we store it to a file, so we can reuse it later"})}),"\n",(0,n.jsx)(e.p,{children:"Continue with our plotting"}),"\n",(0,n.jsxs)(e.p,{children:["Since this is a mean approximation method, we need to substitute an averaged value of a spin back to the Hamiltonian and wait until it converges. The ",(0,n.jsx)(e.em,{children:"memory"})," of our system is stored exactly in this mean field vector"]}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"089d74eb-21bd-40e4-8388-2602f11aebd8",type:"Input",opts:{},children:"meanField%20%3D%20%7B0.1%2C%20-0.8%2C%20-0.1%7D%3B%0Asys%3B%0A%0AprogressBarGenerator%20%3D%20Get%5B%22progressBar.wl%22%5D%3B%0A%0AWith%5B%7B%0A%20%20progress%20%3D%20progressBarGenerator%5B2Pi%5D%0A%7D%2C%0A%0ATable%5B%0A%20%20With%5B%7B%0A%20%20%20%20%0A%20%20%7D%2C%0A%20%20%0A%20%20%20%20Do%5B%0A%20%20%20%20%0A%20%20%20%20%20%20sys%20%3D%20system%20%40%40%20Join%5B%7B10.%20Sin%5Bx%5D%2C%2010.%20Cos%5Bx%5D%2C%200%2C%203.%2C%20-100.%7D%2C%20meanField%5D%3B%0A%20%20%20%20%20%20meanField%20%3D%20average%5Bsys%2C%2010%2C%20%23%5D%20%26%2F%40%20%7BSx%2C%20Sy%2C%20Sz%7D%3B%20%0A%20%20%20%20%20%20%0A%20%20%20%20%2C%20%7Bi%2C%2015%7D%5D%3B%0A%0A%20%20%20%20progress%5Bx%5D%3B%0A%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%28%20meanField%5B%5B%7B1%2C2%7D%5D%5D%20%29%20.%20%7BSin%5Bx%5D%2C%20Cos%5Bx%5D%7D%0A%20%20%20%0A%20%20%5D%20%7BSin%5Bx%5D%2C%20Cos%5Bx%5D%7D%0A%20%20%0A%2C%20%7Bx%2C%200%2C%202Pi%2C%200.05%7D%5D%0A%0A%5D%3B%0A%0AListLinePlot%5B%25%2C%20%0A%20%20PlotRange-%3EFull%2C%20%0A%20%20Epilog-%3E%7B%0A%20%20%20%20Black%20%2F%2F%20Lighter%2C%20Arrow%5B%7B%7B0%2C%200%7D%2C%20%7B2.3501%2C%200.0%7D%7D%5D%2C%0A%20%20%20%20Arrow%5B%7B%7B0%2C0%7D%2C%20%7B0%2C%202.32099%7D%7D%5D%0A%7D%2C%20AxesLabel-%3E%7B%22%5C%5Cmu%20x%22%2C%20%22%5C%5Cmu%20y%22%7D%2C%20ImageSize-%3E500%2C%20AspectRatio-%3E1%5D"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"223743a2-287c-47cc-a4cf-6e74b45fce7b",type:"Output",opts:{},children:"%28%2AVB%5B%2A%29%28FrontEndRef%5B%228d6b2390-be0d-45a5-b9d7-099c0e12ef55%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKW6SYJRkZWxroJqUapOiamCaa6iZZppjrGlhaJhukGhqlppmaAgCErRWn%22%2A%29%28%2A%5DVB%2A%29"}),"\n",(0,n.jsxs)(e.p,{children:["From this plot one can see, that our magnetic moment sticks to ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"C"}),(0,n.jsx)(e.mn,{children:"4"})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"C_4"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"4"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})," directions and when the rotating magnetic field overcomes the anisotropy magnetic moment switches to another easy-axis or direction."]}),"\n",(0,n.jsx)(e.p,{children:"A calculation itself is quite slow, due to algebra we used for quantum computations. In general, we do not need all operators, once we constructed the Hamiltonian in the basis we have. We can deal only with matrixes and simple numerics."}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"7c752533-16f1-40a5-9bb8-5ab73c0451c4",type:"Input",opts:{Hidden:!1},children:".md%0A%23%23%23%20Converting%20operators%20to%20matrixes%0AWe%20build%20a%20function%2C%20that%20approximate%20any%20arbitary%20function%20up%20to%202nd%20order%20for%20all%20variables%20in%20arguments"}),"\n",(0,n.jsx)(e.h3,{id:"converting-operators-to-matrixes",children:"Converting operators to matrixes"}),"\n",(0,n.jsx)(e.p,{children:"We build a function, that approximate any arbitary function up to 2nd order for all variables in arguments"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"5e8e7f8c-88c8-4bd3-b72c-8b0e2cd29340",type:"Input",opts:{Fade:!0,InitGroup:!0},children:"quadInterpolator.wl%0A%0ABeginPackage%5B%22Misc%60QuadarticInterpolation%60%22%5D%0ABegin%5B%22%60Private%60%22%5D%0A%0AquadraticInterpolation%5Bf_%2C%20vars__%2C%20OptionsPattern%5B%5D%5D%20%3A%3D%20Module%5B%7B%0A%20%20variables%20%3D%20%20List%5Bvars%5D%2C%0A%20%20rules%2C%0A%20%20constant%2C%0A%20%20quadratic%2C%0A%20%20final%2C%0A%20%20cached%2C%0A%20%20mdcache%2C%0A%20%20calculated%20%3D%20%3C%7C%7C%3E%2C%0A%20%20linear%2C%0A%20%20handler%2C%20count%20%3D%200%0A%7D%2C%0A%0A%20%20If%5BOptionValue%5B%22Monitor%22%5D%20%3D%21%3D%20Null%2C%0A%20%20%20%20handler%20%3D%20OptionValue%5B%22Monitor%22%5D%5B%20%28Length%5Bvariables%5D%20Length%5Bvariables%5D%20-%20Length%5Bvariables%5D%29%20%2F%202%20%20%2B%202%20Length%5Bvariables%5D%5D%3B%0A%20%20%5D%3B%0A%0A%20%20cached%5Bexpr_%2C%20%7Bi_%2Cj_%7D%5D%20%3A%3D%20mdcache%5Bexpr%2C%20Sort%5B%7Bi%2Cj%7D%5D%5D%3B%0A%20%20SetAttributes%5Bcached%2C%20HoldFirst%5D%3B%0A%0A%20%20mdcache%5Bexpr_%2C%20%7Bi_%2Cj_%7D%5D%20%3A%3D%20If%5BKeyExistsQ%5Bcalculated%2C%20%7Bi%2Cj%7D%5D%2C%0A%20%20%20%20calculated%5B%7Bi%2Cj%7D%5D%0A%20%20%2C%0A%20%20%20%20calculated%5B%7Bi%2Cj%7D%5D%20%3D%20expr%0A%20%20%5D%3B%0A%0A%20%20SetAttributes%5Bmdcache%2C%20HoldFirst%5D%3B%0A%0A%20%20rules%20%3D%20%28%23%5B%5B1%5D%5D%20-%3E%20%23%5B%5B2%5D%5D%29%20%26%2F%40%20variables%3B%0A%20%20%0A%20%20constant%20%3D%20Hold%5Bf%5D%20%2F.%20rules%20%2F%2F%20ReleaseHold%3B%0A%0A%20%20linear%20%3D%20Table%5B%0A%20%20%20%20With%5B%7B%0A%20%20%20%20%20%20r%20%3D%20%7Bi%5B%5B1%5D%5D%20-%3E%201.%7D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%20%20count%2B%2B%3B%0A%20%20%20%20%20%20handler%5Bcount%5D%3B%0A%0A%20%20%20%20%20%20%28Hold%5Bf%5D%20%2F.%20r%20%2F.%20rules%20%2F%2F%20ReleaseHold%29%20-%20constant%0A%20%20%20%20%5D%0A%20%20%20%20%0A%20%20%2C%20%7Bi%2C%20variables%7D%5D%3B%0A%0A%20%20quadratic%20%3D%20Table%5B%0A%20%20%20%20cached%5BWith%5B%7B%0A%20%20%20%20%20%20f11%20%3D%20With%5B%7B%0A%20%20%20%20%20%20%20%20r%20%3D%20%7Bi%5B%5B1%5D%5D%20-%3E%201.%2C%20j%5B%5B1%5D%5D%20-%3E%201.%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%28Hold%5Bf%5D%20%2F.%20r%20%2F.%20rules%20%2F%2F%20ReleaseHold%29%0A%20%20%20%20%20%20%5D%2C%0A%0A%20%20%20%20%20%20fm1m1%20%3D%20With%5B%7B%0A%20%20%20%20%20%20%20%20r%20%3D%20%7Bi%5B%5B1%5D%5D%20-%3E%20-1.%2C%20j%5B%5B1%5D%5D%20-%3E%20-1.%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%28Hold%5Bf%5D%20%2F.%20r%20%2F.%20rules%20%2F%2F%20ReleaseHold%29%0A%20%20%20%20%20%20%5D%2C%0A%0A%20%20%20%20%20%20f1m1%20%3D%20With%5B%7B%0A%20%20%20%20%20%20%20%20r%20%3D%20%7Bi%5B%5B1%5D%5D%20-%3E%201.%2C%20j%5B%5B1%5D%5D%20-%3E%20-1.%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%28Hold%5Bf%5D%20%2F.%20r%20%2F.%20rules%20%2F%2F%20ReleaseHold%29%0A%20%20%20%20%20%20%5D%2C%0A%0A%20%20%20%20%20%20fm11%20%3D%20With%5B%7B%0A%20%20%20%20%20%20%20%20r%20%3D%20%7Bi%5B%5B1%5D%5D%20-%3E%20-1.%2C%20j%5B%5B1%5D%5D%20-%3E%201.%7D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%28Hold%5Bf%5D%20%2F.%20r%20%2F.%20rules%20%2F%2F%20ReleaseHold%29%0A%20%20%20%20%20%20%5D%20%20%20%20%20%20%0A%20%20%20%20%20%20%0A%20%20%20%20%7D%2C%0A%20%20%20%20%20%20count%2B%2B%3B%0A%20%20%20%20%20%20handler%5Bcount%5D%3B%0A%0A%20%20%20%20%20%20Print%5B%22Checking...%20%22%2C%20i%2C%20j%5D%3B%0A%0A%20%20%20%20%20%20%28%2AFB%5B%2A%29%28%28f11%20-%20f1m1%20-%20fm11%20%2B%20fm1m1%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%284.%29%29%28%2A%5DFB%2A%29%0A%20%20%20%20%5D%2C%20%7Bi%2Cj%7D%5D%0A%20%20%20%20%0A%20%20%2C%20%7Bi%2C%20variables%7D%2C%20%7Bj%2C%20variables%7D%5D%3B%0A%0A%20%20final%20%3D%20Sum%5B%0A%20%20%20%20With%5B%7Bl%20%3D%20linear%5B%5Bi%5D%5D%7D%2C%0A%20%20%20%20%20%20Slot%5Bi%5D%20Hold%5Bl%5D%0A%20%20%20%20%5D%0A%20%20%2C%20%7Bi%2C%20Length%5Blinear%5D%7D%5D%20%2B%20Sum%5B%0A%20%20%20%20With%5B%7B%0A%20%20%20%20%20%20q%20%3D%20%28%2AFB%5B%2A%29%28%281%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282%29%29%28%2A%5DFB%2A%29quadratic%5B%5Bi%2C%20j%5D%5D%0A%20%20%20%20%7D%2C%0A%20%20%20%20%20%20Slot%5Bi%5DSlot%5Bj%5D%20Hold%5Bq%5D%0A%20%20%20%20%5D%0A%20%20%2C%20%7Bi%2C%20Length%5Blinear%5D%7D%2C%20%7Bj%2C%20Length%5Blinear%5D%7D%5D%20%2B%20With%5B%7Bc%20%3D%20constant%7D%2C%20Hold%5Bc%5D%20%5D%3B%0A%0A%20%20With%5B%7B%0A%20%20%20%20r%20%3D%20final%0A%20%20%7D%2C%0A%20%20%20%20%28r%20%26%29%20%2F.%20%7BHold%20-%3E%20Identity%7D%0A%20%20%5D%0A%5D%0A%0ASetAttributes%5BquadraticInterpolation%2C%20HoldFirst%5D%0A%0AOptions%5BquadraticInterpolation%5D%20%3D%20%7B%22Monitor%22-%3ENull%7D%0A%0AEnd%5B%5D%0AEndPackage%5B%5D%0A%0AMisc%60QuadarticInterpolation%60Private%60quadraticInterpolation"}),"\n",(0,n.jsx)(e.p,{children:"Now lets import it"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"bfb63009-e4f7-4865-932a-7801c2cd1253",type:"Input",opts:{},children:"quadInterpolation%20%3D%20Get%5B%22quadInterpolator.wl%22%5D%3B%0AprogressBarGenerator%20%3D%20Get%5B%22progressBar.wl%22%5D%3B"}),"\n",(0,n.jsx)(e.p,{children:"Now we apply it to our hamiltonian calculated in the basis with a given parameters"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"5008ce32-4eff-41b3-b3a2-5076ca36a05c",type:"Input",opts:{},children:"int%20%3D%20quadInterpolation%5B%0A%0A%20%20Table%5BConjugate%5Bfin%5D.H%5Ba1%2Ca2%2Ca3%2C%20a4%2C%20a5%2C%20a6%2Ca7%2Ca8%5D.ini%2C%20%7Bfin%2C%20basis%7D%2C%20%7Bini%2C%20basis%7D%5D%0A%20%20%0A%2C%20%7Ba1%2C0%7D%2C%20%7Ba2%2C0%7D%2C%20%7Ba3%2C0%7D%2C%20%7Ba4%2C0%7D%2C%20%7Ba5%2C0%7D%2C%20%7Ba6%2C0%7D%2C%20%7Ba7%2C0%7D%2C%20%7Ba8%2C0%7D%2C%20%22Monitor%22-%3EprogressBarGenerator%5D%3B"}),"\n",(0,n.jsxs)(e.p,{children:["Now one can check that ",(0,n.jsx)(e.strong,{children:"it speeds up things"})," drastically"]}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"3e7fa315-759b-47d8-bca2-7dffedb4620a",type:"Input",opts:{},children:"%28%2A%20old%20%2A%29%0ATable%5BConjugate%5Bfin%5D.H%5B0%2C1.%2C1.%2C%201.%2C%201.%2C%20%201.%2C1.%2C1.%5D.ini%2C%20%7Bfin%2C%20basis%7D%2C%20%7Bini%2C%20basis%7D%5D%20%2F%2F%20RepeatedTiming%20%2F%2F%20First%20%0A%28%2A%20converted%20%2A%29%0Aint%5B0%2C1.%2C1.%2C%201.%2C%201.%2C%20%201.%2C1.%2C1.%5D%20%2F%2F%20RepeatedTiming%20%2F%2F%20First%20"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"69c43abe-82ce-4f99-8518-2ce98785ae8e",type:"Output",opts:{},children:"1.051729%60"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"6c95d102-46a5-4442-a8df-0217e9cb391f",type:"Output",opts:{},children:"0.0007063037109375%60"}),"\n",(0,n.jsx)(e.p,{children:"We can also save this function for later, so that we do not need to derive it again"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"d79b5e89-466f-4b16-b210-0377aac50666",type:"Input",opts:{},children:"int%20%2F%2F%20Iconize%20"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"6e47f3e7-56e3-4f42-9c6d-22380f9197bc",type:"Output",opts:{},children:"%28%2AVB%5B%2A%29%28Get%5BFileNameJoin%5B%7B%22.iconized%22%2C%20%22iconized-6f9a.wl%22%7D%5D%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRAeH5DwTM7Py6xKdcvMSXXKr8i0EGdmAADrVArH%22%2A%29%28%2A%5DVB%2A%29"}),"\n",(0,n.jsx)(e.p,{children:"Or better to internal Notebook storage, so that we do not need to worry about folders structure"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"8965c3c8-90b1-447b-9e0e-88f192dacdc4",type:"Input",opts:{},children:"NotebookStore%5B%22Int%22%5D%20%3D%20int"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"21f4e6c9-ec62-47c1-b274-50ebc3b52fa4",type:"Output",opts:{},children:"%22Int%22"}),"\n",(0,n.jsx)(e.h2,{id:"modelling",children:"Modelling"}),"\n",(0,n.jsx)(e.p,{children:"using faster approach"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"7ff151e9-5232-424c-a818-28f4d840475a",type:"Input",opts:{},children:"progressBarGenerator%20%3D%20Get%5B%22progressBar.wl%22%5D%3B%0Aint%20%3D%20NotebookStore%5B%22Int%22%5D%3B%0A%0AmeanField%20%3D%20%7B0.1%2C%20-0.8%2C%20-0.1%7D%3B%0Asys%3B%0A%0AWith%5B%7B%0A%20%20progress%20%3D%20progressBarGenerator%5B15%5D%0A%7D%2C%0ATable%5B%0A%20%20With%5B%7B%0A%20%20%20%20%0A%20%20%7D%2C%0A%20%20%0A%20%20%20%20Do%5B%0A%20%20%20%20%20%20sys%20%3D%20int%20%40%40%20Join%5B%7Bh%20Sin%5Bx%5D%2C%20h%20Cos%5Bx%5D%2C%200%2C%203.%2C%20-100.%7D%2C%20meanField%5D%20%2F%2F%20Eigensystem%20%2F%2F%20Transpose%3B%0A%20%20%20%20%20%20meanField%20%3D%20average%5Bsys%2C%2010%2C%20%23%5D%20%26%2F%40%20%7BSx%2C%20Sy%2C%20Sz%7D%3B%20%0A%20%20%20%20%2C%20%7Bi%2C%2025%7D%5D%3B%0A%0A%20%20%20%20progress%5Bh%5D%3B%0A%0A%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%28%20meanField%5B%5B%7B1%2C2%7D%5D%5D%29.%28%7BSin%5Bx%5D%2C%20Cos%5Bx%5D%7D%29%0A%20%20%20%0A%20%20%5D%20%7BSin%5Bx%5D%2C%20Cos%5Bx%5D%7D%0A%2C%20%7Bh%2C%20%7B1%2C5%2C10%2C15%7D%7D%2C%20%7Bx%2C%200%2C%202Pi%2C%200.05%7D%5D%0A%5D%3B%0A%0AListLinePlot%5B%25%2C%20%0A%20%20PlotRange-%3EFull%2C%20%0A%20%20Epilog-%3E%7B%0A%20%20%20%20Black%20%2F%2F%20Lighter%2C%20Arrow%5B%7B%7B0%2C%200%7D%2C%20%7B2.5501%2C%200.0%7D%7D%5D%2C%0A%20%20%20%20Arrow%5B%7B%7B0%2C0%7D%2C%20%7B0%2C%202.52099%7D%7D%5D%0A%7D%2C%20AxesLabel-%3E%7B%22%5C%5Cmu%20x%22%2C%20%22%5C%5Cmu%20y%22%7D%2C%20ImageSize-%3E500%2C%20AspectRatio-%3E1%2C%20PlotLegends-%3E%7B%221T%22%2C%20%225T%22%2C%20%2210T%22%2C%20%2215T%22%7D%5D"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"9d4d305b-4b73-41ae-961d-8a8dfa8eea87",type:"Output",opts:{},children:"%28%2AVB%5B%2A%29%28FrontEndRef%5B%2217a8d4a4-9c68-4b79-a0ce-37fa69f6fee7%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKG5onWqSYJJroWiabWeiaJJlb6iYaJKfqGpunJZpZppmlpaaaAwCGQBYd%22%2A%29%28%2A%5DVB%2A%29"}),"\n",(0,n.jsx)(e.p,{children:"Here we have magnetic moment curves plotted for different magnitudes of applied field"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"649d88f3-aa88-4a3a-bb24-c34be9ad9094",type:"Output",opts:{},children:"%28%2AGB%5B%2A%29%7B%7B%28%2AVB%5B%2A%29%28RGBColor%5B0.368417%2C%200.506779%2C%200.709798%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRcVTJv0VGXKdfsiw2kvp3eYP7AvOt4yw3vVtmf2AKMBH1E%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.880722%2C%200.611041%2C%200.142051%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRf5HIl%2Bfl%2FvjX3Rv%2BoPt5b2PrYv2jxrnfouvUP2ALwBIFo%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.560181%2C%200.691569%2C%200.194885%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRcxPIvawvD2oX1R6dq9%2FqGKz%2ByLJCfsvff34wl7AJc8HzE%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.922526%2C%200.385626%2C%200.209179%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdd2frNLrT1rX3RHf35ayTW3bAv0nBnXJRw7JQ9AKbfHmU%3D%22%2A%29%28%2A%5DVB%2A%29%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B1%28%2A%7C%2A%29%2C%28%2A%7C%2A%295%28%2A%7C%2A%29%2C%28%2A%7C%2A%2910%28%2A%7C%2A%29%2C%28%2A%7C%2A%2915%7D%7D%28%2A%5DGB%2A%29"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.em,{children:"Why do we have circles at the bottom?"})}),"\n",(0,n.jsx)(e.p,{children:"Well, it looks that the magnetic field cannot overcome the anisotropy and the position of magentic moment remains constant, while projection goes from 0 up to the maximum. We can prove its shape by plotting this function"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"a62be35f-d619-46b1-8752-7ca773ab19ee",type:"Input",opts:{},children:"PolarPlot%5B%28%2ABB%5B%2A%29%28%2Aour%20constant%20magnetic%20moment%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%20%7B0%2C-1%7D.%7B%20%28%2ABB%5B%2A%29%28%2Aprojection%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%20Cos%5Bx%5D%2C%20Sin%5Bx%5D%7D%2C%20%7Bx%2C0%2C2Pi%7D%2C%20PlotRange-%3E%7B%7B-1%2C1%7D%2C%7B-1%2C1%7D%7D%2C%20Epilog-%3E%7BSVGAttribute%5BCircle%5B%7B0%2C0%7D%2C%201%5D%2C%20%22stroke-dasharray%22-%3E%223%22%5D%7D%5D%20"}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"767697f0-dbcb-4cd2-a93e-86277e042697",type:"Output",opts:{},children:"%28%2AVB%5B%2A%29%28FrontEndRef%5B%2280ee3f9f-f7c6-4c81-9107-63b95fea7fa0%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKWxikphqnWabpppknm%2BmaJFsY6loaGpjrmhknWZqmpSaapyUaAACJHBXn%22%2A%29%28%2A%5DVB%2A%29"}),"\n",(0,n.jsx)(t.gL,{children:"%3Cstyle%3E%0A%20%20%23realtimeStuff%20%7B%0A%20%20%20%20scroll-behavior%3A%20smooth%3B%0A%20%20%7D%0A%3C%2Fstyle%3E%0A%3Cdiv%20id%3D%22realtimeStuff%22%3E%3C%2Fdiv%3E"}),"\n",(0,n.jsx)(e.h2,{id:"real-time-modelling",children:"Real-time modelling"}),"\n",(0,n.jsxs)(e.p,{children:["We can go further and recalculate spins based on user's input. For this case ",(0,n.jsx)(e.code,{children:"Offload"})," keyword is used together with some GUI building blocks"]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.em,{children:"Download this notebook to try it"})}),"\n",(0,n.jsx)(t.EB,{display:"codemirror",nid:"44b68f07-c3d6-4925-99c0-99f949c395f0",id:"59b7d207-02e9-439a-98a2-67d82bd5d5d5",type:"Input",opts:{},children:"int%20%3D%20NotebookStore%5B%22Int%22%5D%3B%0A%0ALeakyModule%5B%7B%0A%20%20spin%20%3D%20%7B0.1%2C%20-0.8%2C%20-0.11%7D%2C%0A%20%20defaults%20%3D%20%7B0.%2C0.%2C0.%2C%203.%2C%20-100.%7D%2C%0A%20%20temperature%20%3D%2010.%2C%0A%20%20field%20%3D%20%7B0.%2C0.%7D%2C%0A%20%20controlPanel%2C%0A%20%20frame%20%3D%20CreateUUID%5B%5D%0A%7D%2C%0A%0A%20%20controlPanel%20%3D%20InputGroup%5B%7B%0A%20%20%20%20InputRange%5B0%2C%205.%2C%201%2C%203%2C%20%22Label%22-%3E%22Spin-orbit%22%5D%2C%0A%20%20%20%20InputRange%5B-100%2C%200.%2C%2010%2C%20-100%2C%20%22Label%22-%3E%22J%22%5D%2C%0A%20%20%20%20InputRange%5B1%2C%20150.%2C%2010%2C%2010%2C%20%22Label%22-%3E%22Temperature%22%5D%0A%20%20%7D%5D%3B%0A%0A%20%20EventHandler%5Bframe%2C%20Function%5B%0A%20%20%20%20With%5B%7B%0A%20%20%20%20%20%20sys%20%3D%20int%20%40%40%20Join%5Bdefaults%2C%20spin%5D%20%2F%2F%20Eigensystem%20%2F%2F%20Transpose%0A%20%20%20%20%7D%2C%0A%20%20%20%20%20%20spin%20%3D%20average%5Bsys%2C%20temperature%2C%20%23%5D%20%26%2F%40%20%7BSx%2C%20Sy%2C%20Sz%7D%20%2F%2F%20Chop%20%2F%2F%20Re%3B%0A%20%20%20%20%5D%20%20%0A%20%20%5D%5D%3B%0A%0A%20%20EventHandler%5BcontrolPanel%2C%20Function%5Bdata%2C%0A%20%20%20%20defaults%5B%5B4%3B%3B5%5D%5D%20%3D%20data%5B%5B1%3B%3B2%5D%5D%3B%0A%20%20%20%20temperature%20%3D%20data%5B%5B3%5D%5D%3B%0A%20%20%5D%5D%3B%0A%0A%20%20%7B%0A%20%20%20%20Graphics%5B%7B%0A%20%20%20%20%20%20White%2C%20EventHandler%5BRectangle%5B%7B-4%2C-4%7D%2C%20%7B4%2C4%7D%5D%2C%20%7B%22mousemove%22%20-%3E%20Function%5Bxy%2C%0A%20%20%20%20%20%20%20%20defaults%5B%5B1%3B%3B2%5D%5D%20%3D%20-%2010%20xy%3B%0A%20%20%20%20%20%20%20%20field%20%3D%20xy%200.8%3B%0A%20%20%20%20%20%20%5D%7D%5D%2C%0A%20%20%20%20%20%20Red%2C%20Arrow%5B%7B%7B0%2C0%7D%2C%20With%5B%7Bs%20%3D%20spin%7D%2C%20%7Bs%5B%5B1%5D%5D%2C%20s%5B%5B2%5D%5D%7D%5D%20%2F%2F%20Offload%7D%5D%2C%0A%20%20%20%20%20%20Blue%2C%20Arrow%5B%7B%7B0%2C0%7D%2C%20field%20%2F%2F%20Offload%7D%5D%2C%0A%20%20%20%20%20%20AnimationFrameListener%5Bspin%20%2F%2F%20Offload%2C%20%22Event%22%20-%3E%20frame%5D%0A%20%20%20%20%7D%2C%20PlotRange-%3E1.5%7B%7B-2%2C2%7D%2C%20%7B-2%2C2%7D%7D%2C%20Controls-%3EFalse%2C%20TransitionType-%3E%22Linear%22%2C%20TransitionDuration-%3E30%2C%20ImagePadding-%3E0%5D%2C%0A%20%20%20%20%0A%20%20%20%20controlPanel%0A%20%20%7D%20%2F%2F%20Row%20%20%0A%5D"}),"\n",(0,n.jsx)(e.p,{children:"Expected result is shown in this video"}),"\n","\n",(0,n.jsx)("video",{width:"100%",controls:!0,children:(0,n.jsx)("source",{src:l})})]})}function p(s={}){const{wrapper:e}={...(0,i.M)(),...s.components};return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(h,{...s})}):h(s)}},46880:(s,e,a)=>{"use strict";a.d(e,{EB:()=>o,gL:()=>d,Af:()=>m});var n,i=a(11504);a(93391),a(28264);function t(){return t=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(s[n]=a[n])}return s},t.apply(this,arguments)}const l=s=>{let{title:e,titleId:a,...l}=s;return i.createElement("svg",t({xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"w-5 h-5 ml-auto",viewBox:"0 0 24 24","aria-labelledby":a},l),e?i.createElement("title",{id:a},e):null,n||(n=i.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",d:"M17 17h.01m.39-3h.6c.932 0 1.398 0 1.765.152a2 2 0 0 1 1.083 1.083C21 15.602 21 16.068 21 17s0 1.398-.152 1.765a2 2 0 0 1-1.083 1.083C19.398 20 18.932 20 18 20H6c-.932 0-1.398 0-1.765-.152a2 2 0 0 1-1.083-1.083C3 18.398 3 17.932 3 17s0-1.398.152-1.765a2 2 0 0 1 1.083-1.083C4.602 14 5.068 14 6 14h.6m5.4 1V4m0 11-3-3m3 3 3-3"})))};var r=a(66528),c=(a(98684),a(52964),a(93664),a(17624));function m(s){let{json:e,notebook:a,kernel:n}=s;const{colorMode:t,setColorMode:m}=(0,r.U)();return(0,i.useEffect)((()=>{console.warn("Create store"),console.warn(e);const s={},a={},i=[],t=new Deferred;let l=async()=>{l=async()=>{},fetch(e).then((e=>{console.warn("Store loaded!"),e.json().then((e=>{interpretate(e.objects,{hold:!0}).then((e=>{console.warn("Objects loaded!"),Object.keys(e).forEach((s=>{const a=new ObjectStorage(s);a.cache=e[s],a.cached=!0})),Object.keys(s).forEach((a=>{Array.isArray(s[a])?s[a].forEach((s=>s.resolve(e[a]))):s[a].resolve(e[a])}))})),interpretate(e.symbols,{hold:!0}).then((s=>{console.warn("Symbols loaded!"),Object.keys(s).forEach((e=>{core[e]=async(s,a)=>await interpretate(core[e].data,a),core[e].data=s[e],core[e]=async(s,a)=>{console.log("IE: calling our symbol...");const n=await interpretate(core[e].data,a);return a.root&&!a.novirtual&&(core[e].instances[a.root.uid]=a.root),n},core[e].update=async(s,a)=>{if(a.useCache)return core[e].cached&&core[e].currentData==core[e].data||(core[e].cached=await interpretate(core[e].data,a),core[e].currentData=core[e].data),core[e].cached;return await interpretate(core[e].data,a)},core[e].destroy=async(s,a)=>{delete core[e].instances[a.root.uid],console.warn(a.root.uid+" was destroyed"),console.warn("external symbol was destoryed")},core[e].data=structuredClone(s[e]),core[e].virtual=!0,core[e].instances={}})),Object.keys(a).forEach((e=>{console.warn(e),a[e].resolve(s[e])})),t.resolve()}))}))}))};core.Offload=(s,e)=>{if(s.length>1)if("'Static'"===s[1][1]){if(s[1][2])return interpretate(s[0],{...e,static:!0})}else if(s.length>2&&"'Static'"===s[2][1]&&s[2][2])return interpretate(s[0],{...e,static:!0});return interpretate(s[0],e)},core.Offload.update=(s,e)=>{if(s.length>1)if("'Volatile'"===s[1][1]){if(!s[1][2])return void console.log("Update was rejected (Nonvolatile)")}else if(s.length>2&&"'Volatile'"===s[2][1]&&!s[2][2])return void console.log("Update was rejected (Nonvolatile)");return interpretate(s[0],e)},window.server={kernel:{}},window.server.ask=e=>{const a=new Deferred;return e.length<42?(console.error("Unknown command"),console.error(e),!1):(Array.isArray(s[e.slice(42,-2)])?s[e.slice(42,-2)].push(a):s[e.slice(42,-2)]=[a],l(),a.promise)},window.server.getSymbol=s=>{const e=new Deferred;return console.warn("Asking for symbol"+s),a[s]=e,e.promise},window.server.kernel.emitt=function(s,e,a){void 0===a&&(a="Default"),i.push({uid:s,data:e,type:a})},interpretate.anonymous=async(s,e)=>{let n,i;if(console.log("Anonimous symbol: "+JSON.stringify(s)),s instanceof Array)throw console.error(s),"unknown WL expression. Error at "+s[0];n=s;const t=new Deferred;return console.warn("Asking for symbol"+n),a[n]=t,i=await t.promise,core[n]=async(s,e)=>{console.log("IE: calling our symbol...");const a=await interpretate(core[n].data,e);return e.root&&!e.novirtual&&(core[n].instances[e.root.uid]=e.root),a},core[n].update=async(s,e)=>{if(e.useCache)return core[n].cached&&core[n].currentData==core[n].data||(core[n].cached=await interpretate(core[n].data,e),core[n].currentData=core[n].data),core[n].cached;return await interpretate(core[n].data,e)},core[n].destroy=async(s,e)=>{delete core[n].instances[e.root.uid],console.warn(e.root.uid+" was destroyed"),console.warn("external symbol was destoryed")},core[n].data=i,core[n].virtual=!0,core[n].instances={},interpretate(s,e)},(async()=>{if(console.warn("Kernel"),n){if(console.warn("KERNEL"),!interpretate.unzlib64String){const s=new Deferred,e=document.createElement("script");e.src="https://cdn.jsdelivr.net/gh/JerryI/wljs-export-html@main/dist/zip.min.js",e.addEventListener("load",(()=>s.resolve())),document.head.appendChild(e),await s.promise,console.warn("ZIP loaded!")}if(!window.KernelState){const s=new Deferred,e=document.createElement("script");e.src="https://cdn.jsdelivr.net/gh/JerryI/wljs-export-html@main/dist/decoder.min.js",e.addEventListener("load",(()=>s.resolve())),document.head.appendChild(e),await s.promise,console.warn("KernelState lib loaded!")}fetch(n).then((s=>{console.log(s),s.json().then((async s=>{let e=s;e=e.map((s=>interpretate.unzlib64String(s))),e=e.map(KernelMesh.unpack),console.warn("Mesh loaded!"),window.server.kernel.emitt=function(s,a,n){void 0===n&&(n="Default"),setTimeout((()=>{const i={type:"event",uid:s,pattern:n,data:a},t=e;for(let s=0;s<t.length;++s)if(t[s].test(i)){if(t[s].state)t[s].state=new KernelState(t[s].state,i,!0);else{if(t[s].database.has("$initialization")){t[s].database.get("$initialization").forEach((e=>t[s].state=new KernelState(t[s].state,e,!0)))}t[s].state=new KernelState(t[s].state,i,!0)}t[s].state.exec(t[s].database,(s=>{for(const e of Object.keys(s))if(console.warn(e),"$state"!==e)if(1===s[e].set.length){console.log(s[e].set[0]),core[e].data=structuredClone(s[e].set[0]);for(const s of Object.values(core[e].instances))s.update()}else{s[e].i+=1,s[e].i>=s[e].set.length&&(s[e].i=0),core[e].data=structuredClone(s[e].set[s[e].i]);for(const s of Object.values(core[e].instances))s.update()}}))}}),4)},i.forEach((s=>window.server.kernel.emitt(s.uid,s.data,s.type)))}))}))}})()})),(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("a",{href:a,className:"dark"==t?"p-2 text-xs w-full flex ring-1 ring-inset shadow ring-gray-300 text-gray-300 my-2":"p-2 text-xs w-full flex ring-1 ring-inset text-gray-600 shadow ring-gray-300 bg-gray-300 my-2",children:["Download original notebook ",(0,c.jsx)(l,{})]})})}function d(s){let{children:e,data:a}=s;const n={__html:decodeURIComponent(e)};return(0,c.jsx)("div",{dangerouslySetInnerHTML:n})}function o(s){let{children:e,nid:a,id:n,type:t,display:l,opts:m}=s;const d=(0,i.useRef)(null),{colorMode:o,setColorMode:h}=(0,r.U)(),p=decodeURIComponent(e),[x,A]=(0,i.useState)(m.Fade),[B,j]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const s=d.current;let e;if(console.warn("Create Codemirror"),console.warn(l),console.log(p),j(!0),console.warn("Created: "+l),"print"!=l){if(window.SupportedCells[l])return window.SupportedCells[l].view&&(e=new window.SupportedCells[l].view({element:s},p)),e.editor&&m.Fade&&(d.current.addEventListener("focusin",(()=>{A(!1)})),d.current.addEventListener("focusout",(()=>{A(!0)}))),()=>{e&&e.dispose()};console.warn("Not found: "+l)}}),[]),(0,c.jsx)("div",{style:{filter:"dark"==o?"invert(1) contrast(0.8) hue-rotate(-185deg)":"none"},className:"language-mathematica codeBlockContainer_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Container-styles-module theme-code-block",children:(0,c.jsx)("div",{className:x?"h-fade-20 codeBlockContent_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module":"codeBlockContent_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module",children:(0,c.jsxs)("pre",{tabIndex:"0",className:"prism-code language-mathematica codeBlock_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module thin-scrollbar",style:{color:"rgb(57, 58, 52)",backgroundColor:"rgb(246, 248, 250)"},children:[!B&&(0,c.jsx)("code",{style:{whiteSpace:"pre-wrap"},className:"codeBlockLines_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module",children:p}),(0,c.jsx)("code",{ref:d,className:"codeBlockLines_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module"})]})})})}},4128:(s,e,a)=>{"use strict";a.d(e,{c:()=>n});const n=a.p+"a19a7805477f866259cf22f437d62eb9.txt"},63112:(s,e,a)=>{"use strict";a.d(e,{c:()=>n});const n=a.p+"d7911513ea696aa9b990f87fbc03d163.wln"},47944:()=>{},73223:()=>{}}]);