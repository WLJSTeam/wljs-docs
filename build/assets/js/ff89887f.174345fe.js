(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[91008],{59508:(s,e,a)=>{"use strict";a.r(e),a.d(e,{assets:()=>h,contentTitle:()=>m,default:()=>o,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var n=a(17624),l=a(4552),i=a(46880);const t=a.p+"assets/medias/fluidSim-ad0847cb1bafd3e16edea595e850a4bc.mov",r={authors:"jerryi",tags:["visualization","dynamics"],enableComments:!0},m="Real-time Fluid Simulation Part 2",c={permalink:"/wljs-docs/blog/2024/08/19/fluid-2",source:"@site/blog/2024-08-19-fluid-2/index.mdx",title:"Real-time Fluid Simulation Part 2",description:"Using Wolfram Language and WLJS libraries",date:"2024-08-19T00:00:00.000Z",tags:[{label:"visualization",permalink:"/wljs-docs/blog/tags/visualization"},{label:"dynamics",permalink:"/wljs-docs/blog/tags/dynamics"}],readingTime:8.35,hasTruncateMarker:!0,authors:[{name:"Kirill Vasin",title:"Maintainer",url:"https://github.com/JerryI",imageURL:"https://avatars.githubusercontent.com/u/4111822?s=48&v=4",key:"jerryi"}],frontMatter:{authors:"jerryi",tags:["visualization","dynamics"],enableComments:!0},unlisted:!1,prevItem:{title:"Real-time Fluid Simulation Part 3",permalink:"/wljs-docs/blog/2024/08/21/fluid-3"},nextItem:{title:"Real-time Fluid Simulation Part 1",permalink:"/wljs-docs/blog/2024/08/18/fluid-1"}},h={authorsImageUrls:[void 0]},d=[{value:"Advection",id:"advection",level:2},{value:"Naive approach",id:"naive-approach",level:3},{value:"Donor-cell advection",id:"donor-cell-advection",level:3},{value:"Advection differential equation",id:"advection-differential-equation",level:4},{value:"Fluid Momentum",id:"fluid-momentum",level:3},{value:"Test particles",id:"test-particles",level:2},{value:"Bilinear interpolation",id:"bilinear-interpolation",level:3},{value:"Uniform distribution",id:"uniform-distribution",level:3},{value:"Complete Real-Time fluid simulation",id:"complete-real-time-fluid-simulation",level:2},{value:"Optimizations",id:"optimizations",level:2}];function C(s){const e={a:"a",annotation:"annotation",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mspace:"mspace",mstyle:"mstyle",msub:"msub",msubsup:"msubsup",mtable:"mtable",mtd:"mtd",mtext:"mtext",mtr:"mtr",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",...(0,l.M)(),...s.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:(0,n.jsx)(e.em,{children:"Using Wolfram Language and WLJS libraries"})}),"\n",(0,n.jsxs)(e.p,{children:["In this notebook, we will ",(0,n.jsx)(e.strong,{children:"continue"})," to explore a simple technique for simulating 2D incompressible fluids for visual effects. This work is mostly based on Jos Stam. Stable Fluids SIGGRAPH 1999 as well as a tutorial by ",(0,n.jsx)(e.a,{href:"https://www.karlsims.com/fluid-flow.html",children:"Karl Sims"})]}),"\n","\n",(0,n.jsx)(i.Af,{json:a(27752).c,notebook:a(49952).c}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsx)(e.h2,{id:"advection",children:"Advection"}),"\n",(0,n.jsx)(e.p,{children:"From mathematica point of view it describes a general process of moving something on a scalar or vector field in the direction given by another vector field."}),"\n",(0,n.jsx)(e.p,{children:"For simplicity's sake, we will first start with scalar fields."}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"f30a2585-dca9-4c0a-817d-49b50222edad",type:"Input",opts:{},children:"grid%20%3D%20Table%5B%7B0%2C0%7D%2C%20%7B5%7D%2C%20%7B5%7D%5D%3B%20grid%5B%5B3%2C3%5D%5D%20%3D%20%7B0%2C1%7D%3B%0Au%20%3D%20Table%5B1.%2C%20%7B5%7D%2C%20%7B5%7D%5D%3B%20%28%2ABB%5B%2A%29%28%2Aour%20scalar%20field%20we%20will%20move%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29"}),"\n",(0,n.jsxs)(e.p,{children:["One can think about ",(0,n.jsx)(e.code,{children:"u"})," as if it were a mass of something, which will be carried by the stream ",(0,n.jsx)(e.code,{children:"grid"}),"."]}),"\n",(0,n.jsx)(e.h3,{id:"naive-approach",children:"Naive approach"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.em,{children:"Looking at the borders"})}),"\n",(0,n.jsx)(i.gL,{children:"%3Cdiv%20class%3D%22text-center%20w-full%22%3E%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20362.609375%20167.34765625%22%3E%0A%20%20%3C%21--%20svg-source%3Aexcalidraw%20--%3E%0A%20%20%0A%20%20%3Cdefs%3E%0A%20%20%20%20%3Cstyle%20class%3D%22style-fonts%22%3E%0A%20%20%20%20%20%20%40font-face%20%7B%0A%20%20%20%20%20%20%20%20font-family%3A%20%22Virgil%22%3B%0A%20%20%20%20%20%20%20%20src%3A%20url%28%22https%3A%2F%2Funpkg.com%2F%40excalidraw%2Fexcalidraw%40undefined%2Fdist%2Fexcalidraw-assets%2FVirgil.woff2%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%40font-face%20%7B%0A%20%20%20%20%20%20%20%20font-family%3A%20%22Cascadia%22%3B%0A%20%20%20%20%20%20%20%20src%3A%20url%28%22https%3A%2F%2Funpkg.com%2F%40excalidraw%2Fexcalidraw%40undefined%2Fdist%2Fexcalidraw-assets%2FCascadia.woff2%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%40font-face%20%7B%0A%20%20%20%20%20%20%20%20font-family%3A%20%22Assistant%22%3B%0A%20%20%20%20%20%20%20%20src%3A%20url%28%22https%3A%2F%2Funpkg.com%2F%40excalidraw%2Fexcalidraw%40undefined%2Fdist%2Fexcalidraw-assets%2FAssistant-Regular.woff2%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%3C%2Fstyle%3E%0A%20%20%20%20%0A%20%20%3C%2Fdefs%3E%0A%20%20%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28150.49307433001178%2078.12304707232147%29%20rotate%280%207.959858655597571%207.959858655597571%29%22%3E%3Cpath%20d%3D%22M7.66%20-0.1%20C9.22%20-0.26%2C%2011.43%200.76%2C%2012.82%201.83%20C14.22%202.9%2C%2015.72%204.7%2C%2016.03%206.34%20C16.33%207.97%2C%2015.56%2010.11%2C%2014.67%2011.63%20C13.78%2013.14%2C%2012.13%2014.81%2C%2010.7%2015.42%20C9.27%2016.04%2C%207.69%2015.85%2C%206.08%2015.3%20C4.47%2014.75%2C%201.97%2013.46%2C%201.02%2012.11%20C0.07%2010.76%2C%200.08%208.83%2C%200.39%207.2%20C0.7%205.58%2C%201.67%203.6%2C%202.89%202.34%20C4.1%201.07%2C%206.83%200.06%2C%207.68%20-0.37%20C8.53%20-0.81%2C%207.94%20-0.39%2C%207.98%20-0.27%20M7.31%20-0.22%20C8.77%20-0.34%2C%2010.46%201.06%2C%2011.95%202.18%20C13.44%203.29%2C%2015.6%205.02%2C%2016.25%206.46%20C16.9%207.9%2C%2016.78%209.26%2C%2015.84%2010.83%20C14.91%2012.4%2C%2012.34%2014.98%2C%2010.65%2015.89%20C8.97%2016.79%2C%207.24%2016.88%2C%205.73%2016.24%20C4.22%2015.59%2C%202.55%2013.57%2C%201.59%2012%20C0.64%2010.42%2C%20-0.01%208.33%2C%200.02%206.77%20C0.04%205.21%2C%200.56%203.79%2C%201.76%202.64%20C2.97%201.49%2C%206.29%200.2%2C%207.27%20-0.11%20C8.25%20-0.42%2C%207.58%200.6%2C%207.64%200.78%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.14%200.08%20C9.79%200.11%2C%2011.63%201.07%2C%2012.96%202.17%20C14.3%203.26%2C%2015.87%205.09%2C%2016.16%206.64%20C16.44%208.19%2C%2015.54%2010.03%2C%2014.67%2011.48%20C13.8%2012.93%2C%2012.5%2014.61%2C%2010.95%2015.33%20C9.39%2016.05%2C%206.95%2016.38%2C%205.35%2015.82%20C3.76%2015.27%2C%202.26%2013.56%2C%201.36%2011.98%20C0.45%2010.4%2C%20-0.31%208.03%2C%20-0.07%206.34%20C0.17%204.65%2C%201.41%202.93%2C%202.78%201.83%20C4.15%200.73%2C%207.07%20-0.05%2C%208.13%20-0.25%20C9.18%20-0.45%2C%209.02%200.48%2C%209.11%200.64%20M8.31%20-0.03%20C9.97%20-0.06%2C%2012.17%201.14%2C%2013.5%202.14%20C14.83%203.14%2C%2016.04%204.34%2C%2016.28%205.96%20C16.51%207.59%2C%2015.85%2010.34%2C%2014.89%2011.9%20C13.93%2013.46%2C%2012.16%2014.62%2C%2010.5%2015.32%20C8.84%2016.03%2C%206.43%2016.66%2C%204.92%2016.13%20C3.42%2015.6%2C%202.26%2013.82%2C%201.46%2012.14%20C0.66%2010.47%2C%20-0.13%207.78%2C%200.13%206.07%20C0.39%204.37%2C%201.79%202.9%2C%203.01%201.91%20C4.22%200.92%2C%206.64%200.5%2C%207.42%200.15%20C8.19%20-0.21%2C%207.67%20-0.42%2C%207.64%20-0.22%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28165.97489797260033%2060.36721962944003%29%20rotate%280%2011.364946874028647%2011.364946874028632%29%22%3E%3Cpath%20d%3D%22M12.07%200.21%20C14.42%200.24%2C%2017.77%201.58%2C%2019.47%203.22%20C21.18%204.86%2C%2022.12%207.64%2C%2022.3%2010.06%20C22.47%2012.48%2C%2021.73%2015.75%2C%2020.53%2017.74%20C19.33%2019.72%2C%2017.43%2021.34%2C%2015.11%2022%20C12.79%2022.65%2C%208.88%2022.53%2C%206.62%2021.65%20C4.35%2020.77%2C%202.53%2018.84%2C%201.53%2016.72%20C0.53%2014.61%2C%200.15%2011.44%2C%200.63%208.97%20C1.1%206.49%2C%202.41%203.42%2C%204.38%201.87%20C6.35%200.31%2C%2010.96%20-0.04%2C%2012.43%20-0.37%20C13.89%20-0.69%2C%2013.2%20-0.36%2C%2013.19%20-0.08%20M11.06%200.67%20C13.49%200.71%2C%2017.48%201.92%2C%2019.52%203.34%20C21.57%204.75%2C%2023.19%206.7%2C%2023.34%209.15%20C23.5%2011.6%2C%2021.88%2015.75%2C%2020.47%2018.03%20C19.05%2020.3%2C%2017.04%2022.22%2C%2014.85%2022.79%20C12.67%2023.37%2C%209.61%2022.56%2C%207.35%2021.49%20C5.1%2020.42%2C%202.61%2018.37%2C%201.31%2016.36%20C0.02%2014.34%2C%20-0.9%2011.77%2C%20-0.42%209.42%20C0.07%207.08%2C%202.16%203.76%2C%204.22%202.29%20C6.29%200.82%2C%2010.69%200.92%2C%2011.97%200.61%20C13.25%200.29%2C%2011.82%200.26%2C%2011.88%200.38%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.69%200.57%20C10.95%20-0.1%2C%2014.73%200.3%2C%2016.9%201.28%20C19.06%202.26%2C%2020.73%204.23%2C%2021.67%206.45%20C22.6%208.67%2C%2023.19%2012.11%2C%2022.52%2014.58%20C21.86%2017.06%2C%2019.73%2019.95%2C%2017.69%2021.3%20C15.64%2022.66%2C%2012.74%2023.12%2C%2010.27%2022.72%20C7.79%2022.31%2C%204.57%2020.7%2C%202.84%2018.9%20C1.12%2017.1%2C%200.06%2014.37%2C%20-0.07%2011.93%20C-0.21%209.49%2C%200.45%206.13%2C%202.03%204.25%20C3.62%202.37%2C%208.16%201.32%2C%209.45%200.66%20C10.74%200.01%2C%209.78%200.19%2C%209.76%200.33%20M11.2%200.34%20C13.51%20-0.03%2C%2016.79%200.3%2C%2018.66%201.71%20C20.53%203.12%2C%2022%206.34%2C%2022.43%208.78%20C22.87%2011.23%2C%2022.43%2014.11%2C%2021.27%2016.39%20C20.11%2018.68%2C%2017.61%2021.48%2C%2015.47%2022.48%20C13.33%2023.48%2C%2010.71%2023.3%2C%208.44%2022.39%20C6.18%2021.48%2C%203.24%2019.08%2C%201.88%2017.02%20C0.52%2014.96%2C%200.09%2012.32%2C%200.29%2010.03%20C0.5%207.73%2C%201.41%204.96%2C%203.1%203.23%20C4.8%201.5%2C%209.31%200.04%2C%2010.47%20-0.37%20C11.64%20-0.77%2C%2010.09%200.52%2C%2010.09%200.8%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28170.20674296303383%2088.179385067966%29%20rotate%280%204.885304075052915%204.885304075052915%29%22%3E%3Cpath%20d%3D%22M4.91%200.08%20C5.86%20-0.04%2C%206.89%200.39%2C%207.65%201.04%20C8.4%201.68%2C%209.13%202.95%2C%209.45%203.94%20C9.76%204.93%2C%2010.01%206.1%2C%209.53%207%20C9.05%207.9%2C%207.55%208.87%2C%206.56%209.32%20C5.58%209.77%2C%204.53%209.99%2C%203.6%209.71%20C2.66%209.43%2C%201.57%208.59%2C%200.96%207.64%20C0.34%206.68%2C%20-0.18%205.07%2C%20-0.09%203.96%20C0%202.85%2C%200.66%201.68%2C%201.48%200.97%20C2.3%200.26%2C%204.27%20-0.17%2C%204.83%20-0.3%20C5.39%20-0.43%2C%204.82%200.04%2C%204.83%200.17%20M5%200.29%20C6.15%200.04%2C%207.59%20-0.08%2C%208.31%200.57%20C9.02%201.23%2C%209.13%203.06%2C%209.28%204.22%20C9.43%205.38%2C%209.6%206.7%2C%209.21%207.52%20C8.83%208.33%2C%207.91%208.8%2C%206.95%209.1%20C5.99%209.4%2C%204.54%209.53%2C%203.44%209.32%20C2.34%209.1%2C%200.93%208.67%2C%200.35%207.82%20C-0.23%206.96%2C%20-0.28%205.22%2C%20-0.05%204.2%20C0.17%203.19%2C%200.91%202.4%2C%201.7%201.71%20C2.5%201.03%2C%204.16%200.35%2C%204.72%200.11%20C5.28%20-0.14%2C%205.01%200.18%2C%205.05%200.24%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M5.25%200.02%20C6.24%20-0.1%2C%207.23%200.22%2C%208.01%200.9%20C8.79%201.58%2C%209.73%202.95%2C%209.91%204.08%20C10.1%205.22%2C%209.7%206.79%2C%209.15%207.7%20C8.6%208.62%2C%207.67%209.3%2C%206.64%209.57%20C5.61%209.83%2C%203.98%209.69%2C%202.96%209.29%20C1.94%208.9%2C%201.04%208.13%2C%200.53%207.21%20C0.02%206.28%2C%20-0.34%204.71%2C%20-0.08%203.74%20C0.18%202.76%2C%201.17%201.98%2C%202.07%201.35%20C2.96%200.72%2C%204.79%200.15%2C%205.3%20-0.04%20C5.81%20-0.23%2C%205.2%200.09%2C%205.14%200.21%20M5.18%20-0.37%20C6.12%20-0.47%2C%207.28%200.42%2C%208.01%201.13%20C8.73%201.85%2C%209.38%202.84%2C%209.53%203.95%20C9.67%205.05%2C%209.33%206.81%2C%208.88%207.75%20C8.43%208.68%2C%207.76%209.34%2C%206.82%209.56%20C5.89%209.79%2C%204.26%209.48%2C%203.26%209.11%20C2.25%208.74%2C%201.4%208.18%2C%200.81%207.36%20C0.23%206.53%2C%20-0.37%205.24%2C%20-0.25%204.16%20C-0.13%203.09%2C%200.77%201.54%2C%201.55%200.91%20C2.33%200.27%2C%203.91%200.49%2C%204.42%200.37%20C4.93%200.25%2C%204.57%200.12%2C%204.63%200.2%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%3E%3Cg%20transform%3D%22translate%28163.72685972175793%2073.47685972175782%29%20rotate%2889.99999999999994%2051.552734375%200%29%22%3E%3Cpath%20d%3D%22M0%200%20C17.18%200%2C%2085.92%200%2C%20103.11%200%20M0%200%20C17.18%200%2C%2085.92%200%2C%20103.11%200%22%20stroke%3D%22%231e1e1e%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3Cmask%3E%3C%2Fmask%3E%3Cg%20stroke-linecap%3D%22round%22%3E%3Cg%20transform%3D%22translate%28181.94726562500017%20-126.06227829773717%29%20rotate%2889.99999999999994%20-1.7053025658242404e-13%20170.662109375%29%22%3E%3Cpath%20d%3D%22M0%200%20C0%2056.89%2C%200%20284.44%2C%200%20341.32%20M0%200%20C0%2056.89%2C%200%20284.44%2C%200%20341.32%22%20stroke%3D%22%231e1e1e%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3Cmask%3E%3C%2Fmask%3E%3Cg%20stroke-linecap%3D%22round%22%3E%3Cg%20transform%3D%22translate%28180.32226562500017%20-63.8719554162075%29%20rotate%2889.99999999999994%20-1.7053025658242404e-13%20170.322265625%29%22%3E%3Cpath%20d%3D%22M0%200%20C0%2056.77%2C%200%20283.87%2C%200%20340.64%20M0%200%20C0%2056.77%2C%200%20283.87%2C%200%20340.64%22%20stroke%3D%22%231e1e1e%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3Cmask%3E%3C%2Fmask%3E%3Cg%20stroke-linecap%3D%22round%22%3E%3Cg%20transform%3D%22translate%2890.76107921688504%2074.21589335392412%29%20rotate%2889.99999999999994%2051.552734375%200%29%22%3E%3Cpath%20d%3D%22M0%200%20C17.18%200%2C%2085.92%200%2C%20103.11%200%20M0%200%20C17.18%200%2C%2085.92%200%2C%20103.11%200%22%20stroke%3D%22%231e1e1e%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3Cmask%3E%3C%2Fmask%3E%3Cg%20stroke-linecap%3D%22round%22%3E%3Cg%20transform%3D%22translate%28163.50131810993025%2076.39720583377255%29%20rotate%280%2021.245434695034874%200.5416314581137271%29%22%3E%3Cpath%20d%3D%22M0%200%20C7.08%200.18%2C%2035.41%200.9%2C%2042.49%201.08%20M0%200%20C7.08%200.18%2C%2035.41%200.9%2C%2042.49%201.08%22%20stroke%3D%22%232f9e44%22%20stroke-width%3D%224%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20transform%3D%22translate%28163.50131810993025%2076.39720583377255%29%20rotate%280%2021.245434695034874%200.5416314581137271%29%22%3E%3Cpath%20d%3D%22M42.49%201.08%20L28.74%207.07%20L29.06%20-5.6%20L42.49%201.08%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%232f9e44%22%20fill-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M42.49%201.08%20C39.24%202.5%2C%2035.98%203.92%2C%2028.74%207.07%20M42.49%201.08%20C39.01%202.6%2C%2035.52%204.12%2C%2028.74%207.07%20M28.74%207.07%20C28.84%203.11%2C%2028.94%20-0.85%2C%2029.06%20-5.6%20M28.74%207.07%20C28.83%203.6%2C%2028.92%200.13%2C%2029.06%20-5.6%20M29.06%20-5.6%20C32.99%20-3.65%2C%2036.92%20-1.69%2C%2042.49%201.08%20M29.06%20-5.6%20C33.73%20-3.28%2C%2038.39%20-0.96%2C%2042.49%201.08%20M42.49%201.08%20C42.49%201.08%2C%2042.49%201.08%2C%2042.49%201.08%20M42.49%201.08%20C42.49%201.08%2C%2042.49%201.08%2C%2042.49%201.08%22%20stroke%3D%22%232f9e44%22%20stroke-width%3D%224%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3Cmask%3E%3C%2Fmask%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%2886.13497691818259%2079.1703181154445%29%20rotate%280%207.959858655597571%207.959858655597571%29%22%3E%3Cpath%20d%3D%22M8.12%20-0.44%20C9.69%20-0.53%2C%2011.8%200.6%2C%2013.14%201.72%20C14.48%202.85%2C%2015.89%204.69%2C%2016.16%206.34%20C16.43%207.98%2C%2015.72%2010.05%2C%2014.73%2011.6%20C13.74%2013.15%2C%2011.82%2014.97%2C%2010.23%2015.66%20C8.65%2016.34%2C%206.75%2016.37%2C%205.23%2015.69%20C3.72%2015.01%2C%202.08%2013.06%2C%201.16%2011.56%20C0.23%2010.07%2C%20-0.53%208.26%2C%20-0.31%206.7%20C-0.08%205.14%2C%200.95%203.39%2C%202.49%202.22%20C4.02%201.05%2C%207.81%200.03%2C%208.91%20-0.33%20C10.01%20-0.68%2C%209.12%20-0.05%2C%209.09%200.09%20M5.91%200.67%20C7.46%200.21%2C%2010.24%20-0.38%2C%2011.85%200.36%20C13.47%201.1%2C%2015.01%203.43%2C%2015.61%205.12%20C16.21%206.82%2C%2015.93%208.86%2C%2015.47%2010.53%20C15%2012.19%2C%2014.12%2014.12%2C%2012.81%2015.11%20C11.49%2016.1%2C%209.39%2016.81%2C%207.55%2016.46%20C5.71%2016.11%2C%203.05%2014.38%2C%201.78%2013.03%20C0.51%2011.67%2C%20-0.04%209.86%2C%20-0.08%208.3%20C-0.12%206.74%2C%200.4%205.1%2C%201.56%203.64%20C2.71%202.18%2C%205.96%200.01%2C%206.83%20-0.45%20C7.71%20-0.9%2C%206.83%200.66%2C%206.81%200.9%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.24%20-0.14%20C9.87%20-0.05%2C%2012.05%201.18%2C%2013.37%202.34%20C14.69%203.5%2C%2016.01%205.17%2C%2016.17%206.81%20C16.33%208.45%2C%2015.24%2010.65%2C%2014.34%2012.17%20C13.45%2013.7%2C%2012.36%2015.42%2C%2010.8%2015.94%20C9.24%2016.47%2C%206.7%2016.02%2C%204.99%2015.35%20C3.28%2014.68%2C%201.26%2013.42%2C%200.55%2011.93%20C-0.17%2010.44%2C%200.29%208.1%2C%200.69%206.41%20C1.09%204.72%2C%201.59%202.84%2C%202.94%201.77%20C4.29%200.7%2C%207.74%200.29%2C%208.79%200%20C9.85%20-0.3%2C%209.32%20-0.13%2C%209.26%20-0.01%20M7.61%20-0.62%20C9.32%20-0.87%2C%2011.89%200.2%2C%2013.26%201.38%20C14.62%202.57%2C%2015.46%204.74%2C%2015.8%206.5%20C16.14%208.27%2C%2016.27%2010.4%2C%2015.29%2011.96%20C14.31%2013.53%2C%2011.7%2015.41%2C%209.94%2015.91%20C8.19%2016.4%2C%206.17%2015.63%2C%204.76%2014.95%20C3.35%2014.27%2C%202.24%2013.37%2C%201.48%2011.84%20C0.73%2010.32%2C%20-0.02%207.51%2C%200.22%205.82%20C0.47%204.13%2C%201.55%202.57%2C%202.96%201.7%20C4.38%200.84%2C%207.97%200.98%2C%208.71%200.63%20C9.45%200.29%2C%207.58%20-0.46%2C%207.39%20-0.38%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28101.61680056077114%2061.41449067256306%29%20rotate%280%2011.364946874028647%2011.364946874028632%29%22%3E%3Cpath%20d%3D%22M13.84%200.27%20C16.19%200.73%2C%2019.04%202.64%2C%2020.54%204.57%20C22.05%206.5%2C%2022.98%209.38%2C%2022.87%2011.86%20C22.76%2014.34%2C%2021.54%2017.71%2C%2019.89%2019.43%20C18.25%2021.14%2C%2015.51%2021.89%2C%2013%2022.17%20C10.49%2022.45%2C%206.95%2022.3%2C%204.84%2021.11%20C2.74%2019.91%2C%201.04%2017.38%2C%200.37%2015.01%20C-0.31%2012.64%2C%20-0.18%209.14%2C%200.77%206.91%20C1.73%204.68%2C%203.83%202.76%2C%206.1%201.62%20C8.37%200.48%2C%2012.99%200.25%2C%2014.41%200.07%20C15.83%20-0.11%2C%2014.7%200.34%2C%2014.63%200.52%20M13.06%20-0.51%20C15.35%20-0.45%2C%2018.13%202.05%2C%2019.61%203.84%20C21.1%205.64%2C%2021.73%207.82%2C%2021.98%2010.28%20C22.23%2012.74%2C%2022.3%2016.53%2C%2021.09%2018.6%20C19.88%2020.67%2C%2017.26%2022.12%2C%2014.74%2022.71%20C12.21%2023.3%2C%208.17%2023.19%2C%205.95%2022.13%20C3.73%2021.07%2C%202.3%2018.62%2C%201.44%2016.35%20C0.57%2014.08%2C%200.07%2010.89%2C%200.74%208.51%20C1.41%206.12%2C%203.42%203.47%2C%205.46%202.03%20C7.49%200.59%2C%2011.65%200.09%2C%2012.95%20-0.13%20C14.26%20-0.35%2C%2013.38%200.4%2C%2013.3%200.73%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M9.66%200.47%20C11.81%20-0.18%2C%2014.67%20-0.1%2C%2016.76%201.16%20C18.86%202.41%2C%2021.38%205.58%2C%2022.24%208%20C23.1%2010.42%2C%2022.76%2013.48%2C%2021.94%2015.67%20C21.11%2017.86%2C%2019.46%2020.04%2C%2017.28%2021.14%20C15.1%2022.23%2C%2011.26%2022.61%2C%208.86%2022.23%20C6.46%2021.85%2C%204.34%2020.7%2C%202.88%2018.87%20C1.42%2017.04%2C%200.1%2013.74%2C%200.12%2011.23%20C0.14%208.72%2C%201.34%205.58%2C%203.01%203.8%20C4.68%202.02%2C%208.9%201.14%2C%2010.16%200.58%20C11.41%200.01%2C%2010.62%200.22%2C%2010.56%200.4%20M9.37%200.28%20C11.58%20-0.28%2C%2015.07%200.23%2C%2017.18%201.51%20C19.3%202.8%2C%2021.21%205.8%2C%2022.06%207.99%20C22.91%2010.17%2C%2023.16%2012.49%2C%2022.26%2014.6%20C21.37%2016.72%2C%2018.86%2019.44%2C%2016.69%2020.68%20C14.53%2021.91%2C%2011.51%2022.27%2C%209.28%2022.02%20C7.04%2021.77%2C%204.91%2020.99%2C%203.27%2019.18%20C1.64%2017.37%2C%20-0.33%2013.61%2C%20-0.55%2011.16%20C-0.76%208.71%2C%200.45%206.25%2C%201.97%204.46%20C3.5%202.67%2C%207.34%200.99%2C%208.6%200.41%20C9.86%20-0.17%2C%209.34%200.77%2C%209.53%200.99%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28105.84864555120453%2089.22665611108903%29%20rotate%280%204.885304075052915%204.885304075052915%29%22%3E%3Cpath%20d%3D%22M4.96%20-0.28%20C5.98%20-0.3%2C%207.14%200.46%2C%207.95%201.15%20C8.76%201.84%2C%209.62%202.75%2C%209.82%203.85%20C10.03%204.96%2C%209.79%206.78%2C%209.17%207.77%20C8.55%208.76%2C%207.17%209.49%2C%206.11%209.77%20C5.05%2010.06%2C%203.69%209.87%2C%202.8%209.48%20C1.91%209.09%2C%201.21%208.33%2C%200.77%207.43%20C0.33%206.54%2C%20-0.01%205.16%2C%200.14%204.13%20C0.29%203.1%2C%200.81%201.94%2C%201.67%201.27%20C2.54%200.59%2C%204.72%200.3%2C%205.33%200.09%20C5.93%20-0.12%2C%205.37%200.02%2C%205.3%200.03%20M5.01%200.15%20C5.9%200.25%2C%207.16%201.08%2C%208.01%201.87%20C8.86%202.66%2C%2010.01%203.9%2C%2010.11%204.88%20C10.21%205.86%2C%209.25%207%2C%208.59%207.75%20C7.94%208.5%2C%207.21%209.08%2C%206.2%209.4%20C5.18%209.72%2C%203.55%2010.12%2C%202.52%209.67%20C1.48%209.22%2C%200.45%207.69%2C%200.01%206.72%20C-0.43%205.74%2C%20-0.47%204.8%2C%20-0.13%203.81%20C0.22%202.82%2C%201.24%201.38%2C%202.1%200.76%20C2.95%200.13%2C%204.48%200.19%2C%204.99%200.07%20C5.49%20-0.06%2C%205.06%20-0.12%2C%205.13%20-0.01%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M4.48%200.32%20C5.43%200.17%2C%207.08%200.28%2C%207.96%200.83%20C8.84%201.38%2C%209.6%202.49%2C%209.78%203.61%20C9.95%204.72%2C%209.52%206.58%2C%209%207.51%20C8.48%208.44%2C%207.57%208.85%2C%206.67%209.2%20C5.78%209.56%2C%204.65%209.91%2C%203.64%209.64%20C2.62%209.37%2C%201.2%208.51%2C%200.57%207.58%20C-0.05%206.64%2C%20-0.3%205.04%2C%20-0.11%204.01%20C0.09%202.99%2C%200.97%202.08%2C%201.75%201.44%20C2.53%200.81%2C%204.09%200.45%2C%204.58%200.2%20C5.07%20-0.06%2C%204.7%20-0.13%2C%204.71%20-0.09%20M5.26%20-0.34%20C6.25%20-0.25%2C%207.3%201.08%2C%208.08%201.83%20C8.86%202.57%2C%209.73%203.15%2C%209.93%204.14%20C10.13%205.13%2C%209.87%206.81%2C%209.31%207.77%20C8.74%208.72%2C%207.56%209.63%2C%206.54%209.86%20C5.53%2010.09%2C%204.29%209.58%2C%203.21%209.15%20C2.14%208.71%2C%200.62%208.19%2C%200.1%207.27%20C-0.42%206.35%2C%20-0.27%204.71%2C%200.09%203.62%20C0.45%202.53%2C%201.37%201.27%2C%202.24%200.74%20C3.11%200.22%2C%204.72%200.61%2C%205.3%200.49%20C5.87%200.37%2C%205.65%200.08%2C%205.69%200.03%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28124.39765612237721%2090.82398804048364%29%20rotate%280%204.885304075052915%204.885304075052915%29%22%3E%3Cpath%20d%3D%22M5.02%200.14%20C6.05%200.08%2C%207.45%200.35%2C%208.2%201.01%20C8.94%201.67%2C%209.3%203.01%2C%209.48%204.11%20C9.67%205.2%2C%209.83%206.61%2C%209.29%207.56%20C8.76%208.52%2C%207.28%209.51%2C%206.28%209.84%20C5.27%2010.17%2C%204.25%209.97%2C%203.26%209.56%20C2.28%209.15%2C%200.97%208.35%2C%200.39%207.37%20C-0.19%206.39%2C%20-0.5%204.75%2C%20-0.21%203.67%20C0.08%202.59%2C%201.21%201.53%2C%202.14%200.89%20C3.06%200.26%2C%204.81%20-0.01%2C%205.35%20-0.14%20C5.89%20-0.28%2C%205.41%20-0.07%2C%205.39%200.08%20M4.81%200.18%20C5.77%200.12%2C%206.83%200.27%2C%207.71%200.89%20C8.58%201.5%2C%209.9%202.79%2C%2010.09%203.87%20C10.27%204.95%2C%209.36%206.48%2C%208.83%207.37%20C8.3%208.26%2C%207.8%208.83%2C%206.91%209.19%20C6.01%209.56%2C%204.47%209.89%2C%203.46%209.56%20C2.45%209.23%2C%201.4%208.05%2C%200.85%207.21%20C0.29%206.36%2C%20-0.08%205.43%2C%200.12%204.52%20C0.32%203.6%2C%201.22%202.43%2C%202.04%201.72%20C2.86%201%2C%204.54%200.55%2C%205.06%200.23%20C5.57%20-0.09%2C%205.22%20-0.24%2C%205.12%20-0.23%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28224.5265845026703%2078.90040412884707%29%20rotate%280%207.959858655597571%207.959858655597571%29%22%3E%3Cpath%20d%3D%22M7.55%200.17%20C9.15%20-0.12%2C%2010.6%200.49%2C%2012.01%201.39%20C13.42%202.28%2C%2015.48%203.9%2C%2015.99%205.55%20C16.51%207.2%2C%2015.92%209.69%2C%2015.11%2011.29%20C14.3%2012.88%2C%2012.64%2014.38%2C%2011.13%2015.12%20C9.63%2015.87%2C%207.6%2016.19%2C%206.07%2015.76%20C4.55%2015.33%2C%203.01%2013.88%2C%201.98%2012.54%20C0.96%2011.2%2C%20-0.18%209.42%2C%20-0.08%207.73%20C0.02%206.04%2C%201.36%203.62%2C%202.59%202.4%20C3.83%201.19%2C%206.52%200.85%2C%207.33%200.44%20C8.14%200.03%2C%207.41%20-0.09%2C%207.45%20-0.07%20M8.71%200.38%20C10.35%200.63%2C%2013.36%201.66%2C%2014.45%202.89%20C15.53%204.13%2C%2015.18%206.19%2C%2015.23%207.79%20C15.27%209.39%2C%2015.75%2011.15%2C%2014.71%2012.48%20C13.67%2013.81%2C%2010.83%2015.39%2C%208.98%2015.76%20C7.12%2016.13%2C%204.97%2015.54%2C%203.58%2014.69%20C2.2%2013.84%2C%201.23%2012.29%2C%200.68%2010.66%20C0.13%209.03%2C%20-0.3%206.41%2C%200.27%204.9%20C0.83%203.38%2C%202.63%202.26%2C%204.07%201.58%20C5.51%200.89%2C%208.12%200.94%2C%208.91%200.79%20C9.71%200.63%2C%208.94%200.58%2C%208.86%200.64%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.07%20-0.15%20C9.62%20-0.26%2C%2011.67%201.07%2C%2012.95%202.13%20C14.23%203.19%2C%2015.33%204.62%2C%2015.75%206.2%20C16.17%207.77%2C%2016.19%209.99%2C%2015.46%2011.58%20C14.72%2013.17%2C%2012.93%2015.11%2C%2011.33%2015.76%20C9.73%2016.4%2C%207.49%2016.07%2C%205.85%2015.45%20C4.22%2014.83%2C%202.53%2013.49%2C%201.5%2012.03%20C0.48%2010.56%2C%20-0.47%208.3%2C%20-0.32%206.65%20C-0.16%205.01%2C%201.13%203.27%2C%202.44%202.16%20C3.75%201.04%2C%206.62%200.3%2C%207.54%20-0.04%20C8.46%20-0.38%2C%207.86%20-0.09%2C%207.94%200.11%20M8.02%200.74%20C9.77%200.52%2C%2011.75%201.06%2C%2012.94%202.06%20C14.13%203.07%2C%2014.79%205.27%2C%2015.17%206.79%20C15.55%208.31%2C%2016.01%209.7%2C%2015.22%2011.18%20C14.42%2012.65%2C%2011.92%2014.89%2C%2010.4%2015.64%20C8.87%2016.39%2C%207.56%2016.19%2C%206.06%2015.68%20C4.56%2015.18%2C%202.46%2014.18%2C%201.4%2012.62%20C0.33%2011.07%2C%20-0.59%208.19%2C%20-0.36%206.36%20C-0.12%204.52%2C%201.45%202.76%2C%202.82%201.6%20C4.19%200.45%2C%206.97%20-0.33%2C%207.88%20-0.58%20C8.79%20-0.82%2C%208.29%20-0.07%2C%208.27%200.13%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28240.00840814525884%2061.144576685965575%29%20rotate%280%2011.364946874028647%2011.364946874028632%29%22%3E%3Cpath%20d%3D%22M11.72%200.07%20C14.03%200.02%2C%2017.81%201.27%2C%2019.61%202.96%20C21.41%204.66%2C%2022.38%207.78%2C%2022.53%2010.24%20C22.67%2012.69%2C%2021.8%2015.68%2C%2020.47%2017.69%20C19.15%2019.71%2C%2016.77%2021.68%2C%2014.56%2022.34%20C12.36%2023%2C%209.49%2022.59%2C%207.24%2021.65%20C4.99%2020.71%2C%202.17%2018.86%2C%201.08%2016.69%20C-0.01%2014.52%2C%200.1%2010.97%2C%200.7%208.62%20C1.31%206.27%2C%202.76%204.08%2C%204.71%202.61%20C6.65%201.14%2C%2011.01%200.23%2C%2012.35%20-0.21%20C13.7%20-0.64%2C%2012.74%20-0.27%2C%2012.77%200%20M10.18%200.3%20C12.41%20-0.24%2C%2014.53%200.51%2C%2016.61%201.67%20C18.7%202.84%2C%2021.89%204.98%2C%2022.69%207.29%20C23.49%209.6%2C%2022.49%2013.22%2C%2021.41%2015.52%20C20.34%2017.82%2C%2018.28%2019.97%2C%2016.25%2021.11%20C14.22%2022.24%2C%2011.57%2022.85%2C%209.24%2022.32%20C6.92%2021.8%2C%203.82%2019.75%2C%202.32%2017.95%20C0.82%2016.14%2C%200.19%2013.73%2C%200.24%2011.49%20C0.28%209.26%2C%201.06%206.36%2C%202.59%204.53%20C4.11%202.7%2C%208.31%201.17%2C%209.38%200.52%20C10.46%20-0.14%2C%208.91%200.54%2C%209.04%200.61%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M12.3%200.45%20C14.56%200.48%2C%2017.5%201.49%2C%2019.31%203.1%20C21.13%204.71%2C%2022.86%207.59%2C%2023.17%2010.1%20C23.48%2012.62%2C%2022.56%2016.16%2C%2021.17%2018.19%20C19.78%2020.21%2C%2017.18%2021.67%2C%2014.81%2022.24%20C12.45%2022.81%2C%209.33%2022.62%2C%206.98%2021.6%20C4.63%2020.58%2C%201.86%2018.27%2C%200.71%2016.12%20C-0.43%2013.96%2C%20-0.48%2011.02%2C%200.13%208.68%20C0.74%206.34%2C%202.27%203.52%2C%204.36%202.08%20C6.46%200.64%2C%2011.16%200.27%2C%2012.69%200.05%20C14.23%20-0.17%2C%2013.58%200.64%2C%2013.58%200.76%20M14.18%200.71%20C16.3%201.09%2C%2018.51%203.34%2C%2019.97%205.16%20C21.43%206.98%2C%2023.09%209.22%2C%2022.93%2011.62%20C22.77%2014.02%2C%2020.64%2017.68%2C%2019%2019.55%20C17.37%2021.41%2C%2015.43%2022.53%2C%2013.13%2022.81%20C10.83%2023.1%2C%207.4%2022.7%2C%205.21%2021.24%20C3.03%2019.77%2C%200.69%2016.5%2C%200.02%2014.02%20C-0.66%2011.53%2C%200.07%208.56%2C%201.17%206.32%20C2.26%204.08%2C%204.32%201.58%2C%206.57%200.58%20C8.82%20-0.42%2C%2013.43%200.33%2C%2014.68%200.3%20C15.94%200.27%2C%2014.29%200.3%2C%2014.11%200.39%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28244.24025313569234%2088.9567421244916%29%20rotate%280%204.885304075052915%204.885304075052915%29%22%3E%3Cpath%20d%3D%22M5.35%20-0.12%20C6.37%20-0.13%2C%207.4%200.63%2C%208.09%201.36%20C8.78%202.09%2C%209.34%203.22%2C%209.5%204.25%20C9.65%205.28%2C%209.49%206.68%2C%209.02%207.55%20C8.54%208.41%2C%207.67%209.12%2C%206.66%209.46%20C5.65%209.8%2C%203.93%209.99%2C%202.96%209.6%20C1.98%209.21%2C%201.28%208.03%2C%200.81%207.12%20C0.34%206.2%2C%20-0.02%205.15%2C%200.16%204.11%20C0.34%203.06%2C%201.04%201.56%2C%201.91%200.85%20C2.78%200.13%2C%204.76%20-0.09%2C%205.37%20-0.18%20C5.98%20-0.28%2C%205.63%200.21%2C%205.57%200.28%20M4.74%200.01%20C5.74%20-0.06%2C%207.85%200.32%2C%208.62%201.04%20C9.4%201.76%2C%209.39%203.28%2C%209.39%204.34%20C9.38%205.41%2C%209.1%206.58%2C%208.59%207.43%20C8.08%208.28%2C%207.32%209.19%2C%206.35%209.45%20C5.39%209.72%2C%203.77%209.38%2C%202.82%209.03%20C1.87%208.68%2C%201.14%208.14%2C%200.66%207.34%20C0.19%206.53%2C%20-0.23%205.21%2C%20-0.04%204.19%20C0.15%203.17%2C%200.99%201.88%2C%201.79%201.21%20C2.59%200.54%2C%204.15%200.4%2C%204.75%200.19%20C5.35%20-0.03%2C%205.29%20-0.14%2C%205.39%20-0.09%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M4.63%20-0.09%20C5.67%20-0.27%2C%207.27%200.19%2C%208.15%200.88%20C9.04%201.57%2C%209.71%203.03%2C%209.93%204.06%20C10.16%205.08%2C%209.99%206.18%2C%209.5%207.06%20C9.01%207.93%2C%208.06%208.91%2C%207%209.31%20C5.95%209.71%2C%204.25%209.73%2C%203.19%209.45%20C2.13%209.18%2C%201.2%208.5%2C%200.63%207.64%20C0.06%206.77%2C%20-0.36%205.32%2C%20-0.22%204.26%20C-0.09%203.2%2C%200.59%201.95%2C%201.43%201.28%20C2.28%200.6%2C%204.28%200.47%2C%204.85%200.22%20C5.42%20-0.02%2C%204.81%20-0.29%2C%204.85%20-0.22%20M5.3%200.4%20C6.3%200.4%2C%208.06%200.59%2C%208.74%201.36%20C9.43%202.14%2C%209.35%203.92%2C%209.4%205.04%20C9.45%206.16%2C%209.61%207.26%2C%209.03%208.08%20C8.45%208.91%2C%207.04%209.86%2C%205.91%209.98%20C4.77%2010.1%2C%203.11%209.42%2C%202.2%208.8%20C1.29%208.19%2C%200.74%207.29%2C%200.44%206.31%20C0.15%205.32%2C%200.03%203.82%2C%200.42%202.88%20C0.81%201.94%2C%201.91%201.15%2C%202.79%200.66%20C3.68%200.17%2C%205.28%200.11%2C%205.73%20-0.04%20C6.19%20-0.19%2C%205.58%20-0.28%2C%205.52%20-0.24%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%20transform%3D%22translate%28222.99720919507246%2089.65405267113067%29%20rotate%280%204.885304075052915%204.885304075052915%29%22%3E%3Cpath%20d%3D%22M4.67%20-0.17%20C5.76%20-0.26%2C%207.28%200.43%2C%208.08%201.09%20C8.88%201.74%2C%209.25%202.83%2C%209.46%203.77%20C9.68%204.71%2C%209.78%205.87%2C%209.34%206.74%20C8.9%207.62%2C%207.77%208.55%2C%206.82%209.03%20C5.87%209.51%2C%204.67%209.89%2C%203.65%209.64%20C2.64%209.38%2C%201.32%208.34%2C%200.73%207.51%20C0.14%206.68%2C%20-0.01%205.72%2C%200.12%204.65%20C0.26%203.59%2C%200.84%201.89%2C%201.54%201.13%20C2.25%200.37%2C%203.82%200.32%2C%204.37%200.11%20C4.92%20-0.11%2C%204.81%20-0.26%2C%204.84%20-0.18%20M4.19%200.33%20C5.11%200.2%2C%206.48%200.51%2C%207.46%201.06%20C8.44%201.61%2C%209.71%202.65%2C%2010.09%203.62%20C10.47%204.6%2C%2010.24%206.01%2C%209.72%206.91%20C9.2%207.81%2C%208%208.49%2C%206.97%209%20C5.95%209.51%2C%204.67%2010.13%2C%203.56%209.96%20C2.44%209.79%2C%200.96%208.89%2C%200.31%207.98%20C-0.34%207.07%2C%20-0.56%205.6%2C%20-0.34%204.5%20C-0.12%203.4%2C%200.77%202.07%2C%201.64%201.36%20C2.51%200.65%2C%204.43%200.52%2C%204.9%200.24%20C5.38%20-0.04%2C%204.54%20-0.31%2C%204.5%20-0.34%22%20stroke%3D%22none%22%20stroke-width%3D%220%22%20fill%3D%22%23ffc9c9%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M4.43%20-0.16%20C5.31%20-0.31%2C%206.27%200.39%2C%207.14%200.94%20C8.02%201.5%2C%209.36%202.16%2C%209.69%203.16%20C10.02%204.16%2C%209.57%205.99%2C%209.13%206.94%20C8.7%207.9%2C%207.97%208.45%2C%207.07%208.88%20C6.17%209.3%2C%204.71%209.65%2C%203.73%209.48%20C2.76%209.31%2C%201.8%208.62%2C%201.21%207.85%20C0.61%207.09%2C%200.09%205.93%2C%200.14%204.91%20C0.19%203.89%2C%200.88%202.55%2C%201.51%201.73%20C2.13%200.91%2C%203.37%200.24%2C%203.87%20-0.03%20C4.38%20-0.3%2C%204.51%20-0.02%2C%204.54%200.11%20M5.1%20-0.01%20C6.19%200.04%2C%207.79%200.81%2C%208.64%201.6%20C9.49%202.39%2C%2010.2%203.78%2C%2010.21%204.74%20C10.22%205.7%2C%209.38%206.55%2C%208.68%207.37%20C7.98%208.18%2C%206.92%209.24%2C%206%209.64%20C5.08%2010.04%2C%204.12%2010.19%2C%203.18%209.76%20C2.24%209.32%2C%200.86%208%2C%200.36%207.01%20C-0.14%206.02%2C%20-0.08%204.84%2C%200.18%203.83%20C0.44%202.81%2C%201.03%201.62%2C%201.93%200.91%20C2.83%200.21%2C%205.11%20-0.19%2C%205.59%20-0.4%20C6.06%20-0.62%2C%204.81%20-0.5%2C%204.79%20-0.37%22%20stroke%3D%22%23e03131%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Cg%20stroke-linecap%3D%22round%22%3E%3Cg%20transform%3D%22translate%2824.880859374999943%2075.20703125%29%20rotate%2889.99999999999994%2051.552734375%200%29%22%3E%3Cpath%20d%3D%22M0%200%20C17.18%200%2C%2085.92%200%2C%20103.11%200%20M0%200%20C17.18%200%2C%2085.92%200%2C%20103.11%200%22%20stroke%3D%22%231e1e1e%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3Cmask%3E%3C%2Fmask%3E%3Cg%20stroke-linecap%3D%22round%22%3E%3Cg%20transform%3D%22translate%28226.29101562499994%2074.04296875%29%20rotate%2889.99999999999994%2051.552734375%200%29%22%3E%3Cpath%20d%3D%22M0%200%20C17.18%200%2C%2085.92%200%2C%20103.11%200%20M0%200%20C17.18%200%2C%2085.92%200%2C%20103.11%200%22%20stroke%3D%22%231e1e1e%22%20stroke-width%3D%222%22%20fill%3D%22none%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3Cmask%3E%3C%2Fmask%3E%3Cg%20transform%3D%22translate%28235.10546875%2012.6015625%29%20rotate%280%2014.419998168945312%2012.5%29%22%3E%3Ctext%20x%3D%220%22%20y%3D%220%22%20font-family%3D%22Virgil%2C%20Segoe%20UI%20Emoji%22%20font-size%3D%2220px%22%20fill%3D%22%231e1e1e%22%20text-anchor%3D%22start%22%20style%3D%22white-space%3A%20pre%3B%22%20direction%3D%22ltr%22%20dominant-baseline%3D%22text-before-edge%22%3Eq%2B1%3C%2Ftext%3E%3C%2Fg%3E%3Cg%20transform%3D%22translate%28172.9198455810547%2010%29%20rotate%280%205.459999084472656%2012.5%29%22%3E%3Ctext%20x%3D%220%22%20y%3D%220%22%20font-family%3D%22Virgil%2C%20Segoe%20UI%20Emoji%22%20font-size%3D%2220px%22%20fill%3D%22%231e1e1e%22%20text-anchor%3D%22start%22%20style%3D%22white-space%3A%20pre%3B%22%20direction%3D%22ltr%22%20dominant-baseline%3D%22text-before-edge%22%3Eq%3C%2Ftext%3E%3C%2Fg%3E%3Cg%20transform%3D%22translate%2894.01359558105469%2012.52734375%29%20rotate%280%2012.279991149902344%2012.5%29%22%3E%3Ctext%20x%3D%220%22%20y%3D%220%22%20font-family%3D%22Virgil%2C%20Segoe%20UI%20Emoji%22%20font-size%3D%2220px%22%20fill%3D%22%231e1e1e%22%20text-anchor%3D%22start%22%20style%3D%22white-space%3A%20pre%3B%22%20direction%3D%22ltr%22%20dominant-baseline%3D%22text-before-edge%22%3Eq-1%3C%2Ftext%3E%3C%2Fg%3E%3Cg%20transform%3D%22translate%28168.9609375%20109.04296875%29%20rotate%280%205.2299957275390625%2012.5%29%22%3E%3Ctext%20x%3D%220%22%20y%3D%220%22%20font-family%3D%22Virgil%2C%20Segoe%20UI%20Emoji%22%20font-size%3D%2220px%22%20fill%3D%22%232f9e44%22%20text-anchor%3D%22start%22%20style%3D%22white-space%3A%20pre%3B%22%20direction%3D%22ltr%22%20dominant-baseline%3D%22text-before-edge%22%3Ev%3C%2Ftext%3E%3C%2Fg%3E%3Cg%20transform%3D%22translate%28177.9765625%20116.24609375%29%20rotate%280%204.3679962158203125%2010%29%22%3E%3Ctext%20x%3D%220%22%20y%3D%220%22%20font-family%3D%22Virgil%2C%20Segoe%20UI%20Emoji%22%20font-size%3D%2216px%22%20fill%3D%22%232f9e44%22%20text-anchor%3D%22start%22%20style%3D%22white-space%3A%20pre%3B%22%20direction%3D%22ltr%22%20dominant-baseline%3D%22text-before-edge%22%3Eq%3C%2Ftext%3E%3C%2Fg%3E%3Cg%20transform%3D%22translate%28170.32421875%20130.92578125%29%20rotate%280%205.67999267578125%2012.5%29%22%3E%3Ctext%20x%3D%220%22%20y%3D%220%22%20font-family%3D%22Virgil%2C%20Segoe%20UI%20Emoji%22%20font-size%3D%2220px%22%20fill%3D%22%23e03131%22%20text-anchor%3D%22start%22%20style%3D%22white-space%3A%20pre%3B%22%20direction%3D%22ltr%22%20dominant-baseline%3D%22text-before-edge%22%3Eu%3C%2Ftext%3E%3C%2Fg%3E%3Cg%20transform%3D%22translate%28181.51171875%20137.34765625%29%20rotate%280%204.3679962158203125%2010%29%22%3E%3Ctext%20x%3D%220%22%20y%3D%220%22%20font-family%3D%22Virgil%2C%20Segoe%20UI%20Emoji%22%20font-size%3D%2216px%22%20fill%3D%22%23e03131%22%20text-anchor%3D%22start%22%20style%3D%22white-space%3A%20pre%3B%22%20direction%3D%22ltr%22%20dominant-baseline%3D%22text-before-edge%22%3Eq%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fsvg%3E%3C%2Fdiv%3E"}),"\n",(0,n.jsx)(e.p,{children:"One can consider interpolating the velocity at borders and then move the mass between them. We can write it as follows:"}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mi,{children:"t"})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"\u03b4"}),(0,n.jsx)(e.mi,{children:"t"})]})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mi,{children:"q"})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"})]})]})]}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"})]})]})]}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mi,{children:"q"})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]})]}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]})]}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\frac{u_{q}^{t} - u_{q}^{t-1}}{\\delta t} = - \\frac{v_{q} + v_{q+1}}{2} \\frac{u_{q} + u_{q+1}}{2} + \\frac{v_{q} + v_{q-1}}{2} \\frac{u_{q}^{t-1} + u_{q-1}^{t-1}}{2}  "})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.2732em",verticalAlign:"-0.686em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.5872em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03785em"},children:"\u03b4"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.7731em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.7936em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8141em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.9463em",verticalAlign:"-0.686em"}}),(0,n.jsx)(e.span,{className:"mord",children:"\u2212"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.2603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord",children:"2"})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.2603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord",children:"2"})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.3327em",verticalAlign:"-0.686em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.2603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord",children:"2"})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.6467em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord",children:"2"})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.7924em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8141em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8542em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.4337em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.1031em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.4024em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsx)(i.gL,{children:"%3Cspan%20style%3D%22color%3Ared%22%3EWarning%3A%20this%20is%20wrong%3C%2Fspan%3E"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"9a6b6264-a049-4748-a649-dc5144bb9270",type:"Input",opts:{Fade:!0},children:"advect%5Bv_%2C%20u_%2C%20%CE%B4t_%3A0.1%5D%20%3A%3D%20With%5B%7Bmax%20%3D%20Length%5Bv%5D%7D%2C%20With%5B%7B%0A%20%20take%20%3D%20Function%5B%7Barray%2C%20x%2Cy%7D%2C%20If%5Bx%20%3E%3D%201%20%26%26%20x%20%3C%3D%20max%20%26%26%20y%20%3E%3D%201%20%26%26%20y%20%3C%3D%20max%2C%20array%5B%5Bx%2Cy%5D%5D%2C%20array%5B%5B1%2C1%5D%5D%200.%5D%5D%0A%7D%2C%0A%20%20Table%5B%20%0A%20%20%0A%20%20%20%20With%5B%7B%0A%20%20%20%20%20%20v2%20%3D%20%20%28%2AFB%5B%2A%29%28%28take%5Bv%2C%20i%2C%20j%2B1%5D%20%2B%20take%5Bv%2C%20i%2C%20j%5D%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29.%7B0%2C-1%7D%2C%0A%20%20%20%20%20%20v4%20%3D%20%20%28%2AFB%5B%2A%29%28%28take%5Bv%2C%20i%2C%20j-1%5D%20%2B%20take%5Bv%2C%20i%2C%20j%5D%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29.%7B0%2C1%7D%2C%0A%20%20%20%20%20%20org%20%3D%20u%5B%5Bi%2Cj%5D%5D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%20%20org%20%2B%20%28%0A%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20v4%20%20%28%2AFB%5B%2A%29%28%28take%5Bu%2C%20i%2C%20j-1%5D%20%2B%20org%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29%20%2B%20v2%20%20%28%2AFB%5B%2A%29%28%28take%5Bu%2C%20i%2C%20j%2B1%5D%20%2B%20org%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%29%20%CE%B4t%0A%20%20%20%20%5D%0A%20%20%20%20%0A%20%20%2C%20%7Bi%2C%20max%7D%2C%20%7Bj%2C%20max%7D%5D%20%2F%2F%20Chop%0A%20%5D%5D"}),"\n",(0,n.jsxs)(e.p,{children:["Now if we test it on our ",(0,n.jsx)(e.code,{children:"u"})," field"]}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"853b1af3-6052-4ee6-a20e-c2a950b49bd7",type:"Input",opts:{},children:"arrow%20%3D%20Graphics%5BArrow%5B%7B%7B0%2C0%7D%2C%20%7B1%2C0%7D%7D%5D%2C%20ImagePadding-%3ENone%2C%20ImageSize-%3E30%5D%3B%0A%0ATable%5BMatrixPlot%5BNest%5Badvect%5Bgrid%2C%20%23%5D%26%2C%20u%2C%20n%5D%2C%20ImageSize-%3E150%5D%2C%20%7Bn%2C%20%7B0%2C%201%2C%20100%7D%7D%5D%3B%0ARiffle%5B%25%2C%20arrow%5D%20%2F%2F%20Row%20"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"3e30781a-26ec-4575-8cd4-fb06b06f4472",type:"Output",opts:{},children:"%28%2AGB%5B%2A%29%7B%7B%28%2AVB%5B%2A%29%28FrontEndRef%5B%22e1451c50-456f-4076-9ed4-1aeca5bf0e88%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKpxqamBommxrompiapemaGJib6VqmppjoGiamJieaJqUZpFpYAAB7ihWk%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28Graphics%5BArrow%5B%7B%7B0%2C%200%7D%2C%20%7B1%2C%200%7D%7D%5D%2C%20ImagePadding%20-%3E%20None%2C%20ImageSize%20-%3E%2030%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KWnMIB4HkHAvSizIyEwuhsizAgnHoqL88jQmmHKfzOISVF4mkGYAE2jijJjiQaU5qcU8QIZnbmJ6akBiSkpmXjpYxi8%2FLxVNHSdMXXBmVWqmHJAHALiLJE4%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28FrontEndRef%5B%22b238a126-d81c-40fe-8c34-f1d04780de66%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKJxkZWyQaGpnpplgYJuuaGKSl6lokG5vophmmGJiYWxikpJqZAQCAdxVw%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28Graphics%5BArrow%5B%7B%7B0%2C%200%7D%2C%20%7B1%2C%200%7D%7D%5D%2C%20ImagePadding%20-%3E%20None%2C%20ImageSize%20-%3E%2030%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KWnMIB4HkHAvSizIyEwuhsizAgnHoqL88jQmmHKfzOISVF4mkGYAE2jijJjiQaU5qcU8QIZnbmJ6akBiSkpmXjpYxi8%2FLxVNHSdMXXBmVWqmHJAHALiLJE4%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28FrontEndRef%5B%229b540d0e-6b20-4b41-91d4-cb4acf1fb194%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKWyaZmhikGKTqmiUZGeiaJJkY6loappjoJieZJCanGaYlGVqaAACB3RXB%22%2A%29%28%2A%5DVB%2A%29%7D%7D%28%2A%5DGB%2A%29"}),"\n",(0,n.jsx)(e.p,{children:"After 100 iterations, the space in the middle becomes negative. In our code"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"705aac04-68f0-4322-8736-98dd77b5d1e0",type:"Input",opts:{},children:"v4%20%20%28%2AFB%5B%2A%29%28%28take%5Bu%2C%20i%2C%20j-1%5D%20%2B%20org%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29%20%2B%20v2%20%20%28%2AFB%5B%2A%29%28%28take%5Bu%2C%20i%2C%20j%2B1%5D%20%2B%20org%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29"}),"\n",(0,n.jsxs)(e.p,{children:["If ",(0,n.jsx)(e.code,{children:"org"})," (which stands for the current cell) equals ",(0,n.jsx)(e.code,{children:"0"}),", it still does not mean that it cannot be reduced even more if we have a velocity vector to the nearest cell."]}),"\n",(0,n.jsx)(e.h3,{id:"donor-cell-advection",children:"Donor-cell advection"}),"\n",(0,n.jsxs)(e.p,{children:["The way to fix it is to use the ",(0,n.jsx)(e.em,{children:"Donor-cell"})," method described well in Heidelberg University's ",(0,n.jsx)(e.a,{href:"https://www.ita.uni-heidelberg.de/~dullemond/lectures/num_fluid_2009/Chapter_4.pdf",children:"lecture"})," on numerical fluid dynamics. There we again consider velocities at borders, but based on the relative sign (outtake or intake) we decide which cell is going to be a donor."]}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mi,{children:"q"})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"})]})]})]}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mspace,{linebreak:"newline"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mi,{children:"q"})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]})]}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"v_{q+1/2} = \\frac{v_{q} + v_{q+1}}{2} \\\\\nv_{q-1/2} = \\frac{v_{q} + v_{q-1}}{2}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7858em",verticalAlign:"-0.3552em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.5198em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3552em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.9463em",verticalAlign:"-0.686em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.2603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord",children:"2"})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]}),(0,n.jsx)(e.span,{className:"mspace newline"}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.7858em",verticalAlign:"-0.3552em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.5198em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3552em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.9463em",verticalAlign:"-0.686em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.2603em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord",children:"2"})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:["Using these notations one can write the ",(0,n.jsx)(e.strong,{children:"donor-cell"})," method as follows:"]}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mi,{children:"t"})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"\u03b4"}),(0,n.jsx)(e.mi,{children:"t"})]})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:"true",children:"{"}),(0,n.jsxs)(e.mtable,{rowspacing:"0.36em",columnalign:"left left",columnspacing:"1em",children:[(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]}),(0,n.jsx)(e.mo,{separator:"true",children:","})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsx)(e.mo,{children:">"}),(0,n.jsx)(e.mn,{children:"0"})]})})})]}),(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsx)(e.mrow,{})})})]})]})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:"true",children:"{"}),(0,n.jsxs)(e.mtable,{rowspacing:"0.36em",columnalign:"left left",columnspacing:"1em",children:[(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]}),(0,n.jsx)(e.mo,{separator:"true",children:","})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsx)(e.mo,{children:">"}),(0,n.jsx)(e.mn,{children:"0"})]})})})]}),(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"})]})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsx)(e.mrow,{})})})]})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\frac{u_{q}^{t} - u_{q}^{t-1}}{\\delta t} = - v_{q+1/2}\\begin{cases}\n   u_{q}^{t-1} ,& v_{q+1/2} > 0 \\\\\n   u_{q+1}^{t-1} &\n\\end{cases} + v_{q-1/2}\\begin{cases}\n   u_{q-1}^{t-1} ,& v_{q-1/2} > 0 \\\\\n   u_{q}^{t-1} &\n\\end{cases}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.2732em",verticalAlign:"-0.686em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.5872em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03785em"},children:"\u03b4"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.7731em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.7936em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8141em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"3em",verticalAlign:"-1.25em"}}),(0,n.jsx)(e.span,{className:"mord",children:"\u2212"}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.5198em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3552em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsxs)(e.span,{className:"minner",children:[(0,n.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,n.jsx)(e.span,{className:"delimsizing size4",children:"{"})}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsxs)(e.span,{className:"mtable",children:[(0,n.jsx)(e.span,{className:"col-align-l",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.69em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3.69em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8141em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mpunct",children:","})]})]}),(0,n.jsxs)(e.span,{style:{top:"-2.25em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8542em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.4337em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.1031em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.4024em"},children:(0,n.jsx)(e.span,{})})})]})})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"1.19em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"arraycolsep",style:{width:"1em"}}),(0,n.jsx)(e.span,{className:"col-align-l",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.69em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3.69em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.5198em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3552em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:">"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-2.25em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsx)(e.span,{className:"mord"})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"1.19em"},children:(0,n.jsx)(e.span,{})})})]})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"3em",verticalAlign:"-1.25em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.5198em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3552em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsxs)(e.span,{className:"minner",children:[(0,n.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,n.jsx)(e.span,{className:"delimsizing size4",children:"{"})}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsxs)(e.span,{className:"mtable",children:[(0,n.jsx)(e.span,{className:"col-align-l",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.69em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3.69em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8542em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.4337em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.1031em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.4024em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mpunct",children:","})]})]}),(0,n.jsxs)(e.span,{style:{top:"-2.25em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8141em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"1.19em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"arraycolsep",style:{width:"1em"}}),(0,n.jsx)(e.span,{className:"col-align-l",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.69em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3.69em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.5198em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3552em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:">"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-2.25em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsx)(e.span,{className:"mord"})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"1.19em"},children:(0,n.jsx)(e.span,{})})})]})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsx)(i.gL,{children:"%3Cspan%20style%3D%22color%3Agreen%22%3EWarning%3A%20this%20is%20correct%3C%2Fspan%3E"}),"\n",(0,n.jsx)(e.p,{children:"Adding the projections from other sides, our final function will be"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"b7ae7fc2-5348-4d80-8294-98b564a72445",type:"Input",opts:{InitGroup:!0,Fade:!0},children:"advect%5Bv_%2C%20u_%2C%20%CE%B4t_%3A0.1%5D%20%3A%3D%20With%5B%7Bmax%20%3D%20Length%5Bv%5D%7D%2C%20With%5B%7B%0A%20%20take%20%3D%20Function%5B%7Barray%2C%20x%2Cy%7D%2C%20If%5Bx%20%3E%3D%201%20%26%26%20x%20%3C%3D%20max%20%26%26%20y%20%3E%3D%201%20%26%26%20y%20%3C%3D%20max%2C%20array%5B%5Bx%2Cy%5D%5D%2C%20array%5B%5B1%2C1%5D%5D%200.%5D%5D%0A%7D%2C%0A%20%20Table%5B%20%0A%20%20%0A%20%20%20%20With%5B%7B%0A%20%20%20%20%20%20v1%20%3D%20%20%28%2AFB%5B%2A%29%28%28take%5Bv%2C%20i-1%2C%20j%5D%20%2B%20take%5Bv%2C%20i%2C%20j%5D%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29.%7B1%2C0%7D%2C%0A%20%20%20%20%20%20v2%20%3D%20%20%28%2AFB%5B%2A%29%28%28take%5Bv%2C%20i%2C%20j%2B1%5D%20%2B%20take%5Bv%2C%20i%2C%20j%5D%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29.%7B0%2C-1%7D%2C%0A%20%20%20%20%20%20v3%20%3D%20%20%28%2AFB%5B%2A%29%28%28take%5Bv%2C%20i%2B1%2C%20j%5D%20%2B%20take%5Bv%2C%20i%2C%20j%5D%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29.%7B-1%2C0%7D%2C%0A%20%20%20%20%20%20v4%20%3D%20%20%28%2AFB%5B%2A%29%28%28take%5Bv%2C%20i%2C%20j-1%5D%20%2B%20take%5Bv%2C%20i%2C%20j%5D%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29.%7B0%2C1%7D%2C%0A%20%20%20%20%20%20org%20%3D%20u%5B%5Bi%2Cj%5D%5D%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%20%20org%20%2B%20%28%0A%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20v1%20%28%2ATB%5B%2A%29Piecewise%5B%7B%7B%28%2A%7C%2A%29take%5Bu%2C%20i-1%2C%20j%5D%28%2A%7C%2A%29%2C%28%2A%7C%2A%29v1%20%3E%200%28%2A%7C%2A%29%7D%2C%7B%28%2A%7C%2A%29org%28%2A%7C%2A%29%2C%28%2A%7C%2A%29True%28%2A%7C%2A%29%7D%7D%5D%28%2A%7C%2A%29%28%2A1%3AeJxTTMoPSmNkYGAo5gESAZmpyanlmcWpTvkVmUxAAQBzVQdd%2A%29%28%2A%5DTB%2A%29%20%2B%20v3%20%28%2ATB%5B%2A%29Piecewise%5B%7B%7B%28%2A%7C%2A%29take%5Bu%2C%20i%2B1%2C%20j%5D%28%2A%7C%2A%29%2C%28%2A%7C%2A%29v3%20%3E%200%28%2A%7C%2A%29%7D%2C%7B%28%2A%7C%2A%29org%28%2A%7C%2A%29%2C%28%2A%7C%2A%29True%28%2A%7C%2A%29%7D%7D%5D%28%2A%7C%2A%29%28%2A1%3AeJxTTMoPSmNkYGAo5gESAZmpyanlmcWpTvkVmUxAAQBzVQdd%2A%29%28%2A%5DTB%2A%29%20%20%2B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20v4%20%28%2ATB%5B%2A%29Piecewise%5B%7B%7B%28%2A%7C%2A%29take%5Bu%2C%20i%2C%20j-1%5D%28%2A%7C%2A%29%2C%28%2A%7C%2A%29v4%20%3E%200%28%2A%7C%2A%29%7D%2C%7B%28%2A%7C%2A%29org%28%2A%7C%2A%29%2C%28%2A%7C%2A%29True%28%2A%7C%2A%29%7D%7D%5D%28%2A%7C%2A%29%28%2A1%3AeJxTTMoPSmNkYGAo5gESAZmpyanlmcWpTvkVmUxAAQBzVQdd%2A%29%28%2A%5DTB%2A%29%20%2B%20v2%20%28%2ATB%5B%2A%29Piecewise%5B%7B%7B%28%2A%7C%2A%29take%5Bu%2C%20i%2C%20j%2B1%5D%28%2A%7C%2A%29%2C%28%2A%7C%2A%29v2%20%3E%200%28%2A%7C%2A%29%7D%2C%7B%28%2A%7C%2A%29org%28%2A%7C%2A%29%2C%28%2A%7C%2A%29True%28%2A%7C%2A%29%7D%7D%5D%28%2A%7C%2A%29%28%2A1%3AeJxTTMoPSmNkYGAo5gESAZmpyanlmcWpTvkVmUxAAQBzVQdd%2A%29%28%2A%5DTB%2A%29%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%29%20%CE%B4t%0A%20%20%20%20%5D%0A%20%20%20%20%0A%20%20%2C%20%7Bi%2C%20max%7D%2C%20%7Bj%2C%20max%7D%5D%20%2F%2F%20Chop%0A%20%5D%5D"}),"\n",(0,n.jsx)(e.p,{children:"Now if we run the same test, the result should be correct"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"4d103ec1-c5a1-401d-b6b6-fa90cf4cfbcf",type:"Input",opts:{},children:"arrow%20%3D%20Graphics%5BArrow%5B%7B%7B0%2C0%7D%2C%20%7B1%2C0%7D%7D%5D%2C%20ImagePadding-%3ENone%2C%20ImageSize-%3E30%5D%3B%0A%0ATable%5BMatrixPlot%5BNest%5Badvect%5Bgrid%2C%20%23%5D%26%2C%20u%2C%20n%5D%2C%20ImageSize-%3E150%5D%2C%20%7Bn%2C%20%7B0%2C%201%2C%20100%7D%7D%5D%3B%0ARiffle%5B%25%2C%20arrow%5D%20%2F%2F%20Row%20"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"dfc29d73-9162-4a75-a34a-cd5f3ed89c21",type:"Output",opts:{},children:"%28%2AGB%5B%2A%29%7B%7B%28%2AVB%5B%2A%29%28FrontEndRef%5B%22e8fdf197-1b9a-4d20-bb58-7d80a23f0253%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKp1qkpaQZWprrGiZZJuqapBgZ6CYlmVromqdYGCQaGacZGJkaAwCNkhWi%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28Graphics%5BArrow%5B%7B%7B0%2C%200%7D%2C%20%7B1%2C%200%7D%7D%5D%2C%20ImagePadding%20-%3E%20None%2C%20ImageSize%20-%3E%2030%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KWnMIB4HkHAvSizIyEwuhsizAgnHoqL88jQmmHKfzOISVF4mkGYAE2jijJjiQaU5qcU8QIZnbmJ6akBiSkpmXjpYxi8%2FLxVNHSdMXXBmVWqmHJAHALiLJE4%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28FrontEndRef%5B%22f41c04c8-2eef-469c-bf5d-4f8fe8dd9191%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKp5kYJhuYJFvoGqWmpumamFkm6yalmabomqRZpKVapKRYGloaAgCQbhZK%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28Graphics%5BArrow%5B%7B%7B0%2C%200%7D%2C%20%7B1%2C%200%7D%7D%5D%2C%20ImagePadding%20-%3E%20None%2C%20ImageSize%20-%3E%2030%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KWnMIB4HkHAvSizIyEwuhsizAgnHoqL88jQmmHKfzOISVF4mkGYAE2jijJjiQaU5qcU8QIZnbmJ6akBiSkpmXjpYxi8%2FLxVNHSdMXXBmVWqmHJAHALiLJE4%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28FrontEndRef%5B%22086251cd-1038-4ff8-989d-cbc828c24c25%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKG1iYGZkaJqfoGhoYW%2BiapKVZ6FpaWKboJiclWxhZJBuZJBuZAgB5KRVP%22%2A%29%28%2A%5DVB%2A%29%7D%7D%28%2A%5DGB%2A%29"}),"\n",(0,n.jsx)(e.p,{children:"We can check it numerically as well"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"b238e764-e482-46d8-ab01-3d18fc086995",type:"Input",opts:{},children:"Nest%5Badvect%5Bgrid%2C%20%23%5D%26%2C%20u%2C%20100%5D%20%2F%2F%20Chop%20%2F%2F%20MatrixForm%20"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"ca607c0c-9569-4772-90c2-a134e2fc6722",type:"Output",opts:{},children:"%28%28%2AGB%5B%2A%29%7B%7B1.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B1.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B1.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%290.005920529220334025%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%290.0370812093273552%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%292.9569982614523105%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B1.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B1.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%28%2A%7C%2A%29%2C%28%2A%7C%2A%291.%60%7D%7D%28%2A%5DGB%2A%29%29"}),"\n",(0,n.jsx)(e.p,{children:"or in a more creative way"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"bada543f-214a-494c-aeea-85340291005a",type:"Input",opts:{},children:"Map%5BFunction%5Bcell%2C%20RGBColor%5BTanh%5Bcell%5D%2C%200%2C-Tanh%5Bcell%5D%5D%5D%2C%20Nest%5Badvect%5Bgrid%2C%20%23%5D%26%2C%20u%2C%20100%5D%2C%20%7B2%7D%5D%3B%0A%25%20%2F%2F%20MatrixForm"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"561cc248-f763-40b0-8125-215303d6d7c6",type:"Output",opts:{},children:"%28%28%2AGB%5B%2A%29%7B%7B%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.005920460044525685%2C%200%2C%20-0.005920460044525685%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRedvOydwutQYV%2FEAAUwkf0AVBEZTA%3D%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.037064222916834776%2C%200%2C%20-0.037064222916834776%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRc5i%2FZ%2FEvm1yL6IAQpgIvsBV8caPg%3D%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.9946118170687553%2C%200%2C%20-0.9946118170687553%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRelXgjQvHP5vX0RAxTARPYDAG2TG8Q%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%7D%28%2A%7C%7C%2A%29%2C%28%2A%7C%7C%2A%29%7B%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28RGBColor%5B0.7615941559557649%2C%200%2C%20-0.7615941559557649%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs%2FJLwouTyxJzghJzS3ISSxJTWMGyXMgyRdN%2BSyy9VfcC%2FsiBiiAiewHAHfzHEw%3D%22%2A%29%28%2A%5DVB%2A%29%7D%7D%28%2A%5DGB%2A%29%29"}),"\n",(0,n.jsx)(e.p,{children:"Now we are ready to apply this knowledge to our fluid simulation. But how?"}),"\n",(0,n.jsx)(e.h4,{id:"advection-differential-equation",children:"Advection differential equation"}),"\n",(0,n.jsx)(e.p,{children:"I would like to draw your attention to the differential equation of advection"}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,n.jsx)(e.mi,{children:"u"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,n.jsx)(e.mi,{children:"t"})]})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{mathvariant:"bold",children:"v"}),(0,n.jsx)(e.mo,{children:"\u22c5"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"\u2207"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mn,{children:"0"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\frac{\\partial u}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) u = 0"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.0574em",verticalAlign:"-0.686em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"v"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord",children:"\u2207"}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0"})]})]})]})}),"\n",(0,n.jsx)(e.p,{children:"If one tries to descritize it on 1D grid"}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"t"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"})]})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mi,{children:"t"})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"\u03b4"}),(0,n.jsx)(e.mi,{children:"t"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"\u03b4"}),(0,n.jsx)(e.mi,{children:"q"})]})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"f"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mi,{children:"t"})]}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"f"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mi,{children:"t"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mn,{children:"0"}),(0,n.jsx)(e.mtext,{children:"\xa0"}),(0,n.jsx)(e.mo,{separator:"true",children:","})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"u^{t+1}_{q} - u^{t}_{q} + \\frac{\\delta t}{\\delta q} (f^{t}_{q + 1/2}  - f^{t}_{q - 1/2}) = 0~,"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.2472em",verticalAlign:"-0.3831em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8641em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.2267em",verticalAlign:"-0.3831em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8436em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.2519em",verticalAlign:"-0.8804em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03785em"},children:"\u03b4"}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03785em"},children:"\u03b4"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.8804em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8436em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.428em",marginLeft:"-0.1076em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.447em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.2906em",verticalAlign:"-0.447em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8436em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.428em",marginLeft:"-0.1076em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.447em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.8389em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0"}),(0,n.jsx)(e.span,{className:"mspace nobreak",children:"\xa0"}),(0,n.jsx)(e.span,{className:"mpunct",children:","})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:["where ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"f"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\xb1"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]})]})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"f_{q \\pm 1/2}"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.0496em",verticalAlign:"-0.3552em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.5198em",marginLeft:"-0.1076em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\xb1"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3552em"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]})," we define flux at the interface of ",(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:"q"})}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"q"})]})})}),(0,n.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]})})]})," th cell. The exact form if a flux is given by the algorythm used. For above-mentioned ",(0,n.jsx)(e.strong,{children:"donor-cell"})," we find"]}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"f"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\xb1"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]}),(0,n.jsx)(e.mi,{children:"t"})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\xb1"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:"true",children:"{"}),(0,n.jsxs)(e.mtable,{rowspacing:"0.36em",columnalign:"left left",columnspacing:"1em",children:[(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mi,{children:"t"})]}),(0,n.jsx)(e.mo,{separator:"true",children:","})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\xb1"}),(0,n.jsx)(e.mn,{children:"1"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(e.mn,{children:"2"})]})]}),(0,n.jsx)(e.mo,{children:">"}),(0,n.jsx)(e.mn,{children:"0"})]})})})]}),(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.msubsup,{children:[(0,n.jsx)(e.mi,{children:"u"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"q"}),(0,n.jsx)(e.mo,{children:"\xb1"}),(0,n.jsx)(e.mn,{children:"1"})]}),(0,n.jsx)(e.mi,{children:"t"})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsx)(e.mrow,{})})})]})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"f_{q\\pm 1/2}^{t} = v_{q\\pm 1/2} \\begin{cases}\n   u_{q}^{t} ,& v_{q\\pm 1/2} > 0 \\\\\n   u_{q \\pm 1}^{t} &\n\\end{cases}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.2906em",verticalAlign:"-0.447em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.8436em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.428em",marginLeft:"-0.1076em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\xb1"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.447em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"3em",verticalAlign:"-1.25em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.5198em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\xb1"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3552em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsxs)(e.span,{className:"minner",children:[(0,n.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,n.jsx)(e.span,{className:"delimsizing size4",children:"{"})}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsxs)(e.span,{className:"mtable",children:[(0,n.jsx)(e.span,{className:"col-align-l",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.69em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3.69em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.7936em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mpunct",children:","})]})]}),(0,n.jsxs)(e.span,{style:{top:"-2.25em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"0.7936em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.4519em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\xb1"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]}),(0,n.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3842em"},children:(0,n.jsx)(e.span,{})})})]})})]})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"1.19em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"arraycolsep",style:{width:"1em"}}),(0,n.jsx)(e.span,{className:"col-align-l",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.69em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3.69em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.5198em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsxs)(e.span,{className:"mord mtight",children:[(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"}),(0,n.jsx)(e.span,{className:"mbin mtight",children:"\xb1"}),(0,n.jsx)(e.span,{className:"mord mtight",children:"1/2"})]})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3552em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:">"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-2.25em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsx)(e.span,{className:"mord"})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"1.19em"},children:(0,n.jsx)(e.span,{})})})]})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:['After substituting it back, one finds, that it matches our previous equation we found for a problem of moving "mass" on a grid. ==We solved this exact differnetial advection equation while implementing ',(0,n.jsx)(e.code,{children:"advect"})," function.=="]}),"\n",(0,n.jsx)(e.h3,{id:"fluid-momentum",children:"Fluid Momentum"}),"\n",(0,n.jsx)(e.p,{children:"Newton's second law in the Navier-Stokes equation is defined by the following term."}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,n.jsx)(e.mi,{mathvariant:"bold",children:"v"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{mathvariant:"normal",children:"\u2202"}),(0,n.jsx)(e.mi,{children:"t"})]})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{mathvariant:"bold",children:"v"}),(0,n.jsx)(e.mo,{children:"\u22c5"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"\u2207"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mi,{mathvariant:"bold",children:"v"}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mn,{children:"0"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} + ... = 0"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"2.0574em",verticalAlign:"-0.686em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,n.jsx)(e.span,{className:"mfrac",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,n.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})]}),(0,n.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,n.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord",style:{marginRight:"0.05556em"},children:"\u2202"}),(0,n.jsx)(e.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"v"})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"v"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord",children:"\u2207"}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"v"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.3669em"}}),(0,n.jsx)(e.span,{className:"mord",children:"..."}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,n.jsx)(e.span,{className:"mord",children:"0"})]})]})]})}),"\n",(0,n.jsxs)(e.p,{children:["Does it remind you anything?.. The conservation of momentum of our fluid is actual ",(0,n.jsx)(e.strong,{children:"self advection"}),"."]}),"\n",(0,n.jsxs)(e.blockquote,{children:["\n",(0,n.jsx)(e.p,{children:"To simulate fluid momentum, the flow field can simply flow itself. Flow vectors are updated by reading interpolated values from upstream grid cells in the same way the tracer image is advected above. New vector values are pulled from the negative direction of flow."}),"\n"]}),"\n",(0,n.jsxs)(e.p,{children:["To test it, one can construct the same sandbox used in ",(0,n.jsx)(e.em,{children:"Part 1"}),", but change the update loop slightly."]}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"f5bc4328-ed14-48e3-a545-6cf0438b2dae",type:"Input",opts:{},children:"vgrid%20%3D%20Table%5B%7B0.%2C0.%7D%2C%20%7Bi%2C15%7D%2C%20%7Bj%2C15%7D%5D%3B%0Avcolors%20%3D%20Table%5B1.0%2C%20%7BLength%5Bvgrid%5D%7D%2C%20%7BLength%5Bvgrid%5D%7D%5D%3B%0Avfps%20%3D%200%3B%0A"}),"\n",(0,n.jsx)(e.p,{children:"add mouse handler"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"42ce8215-2ef7-4376-b2fd-0c5efe561c89",type:"Input",opts:{},children:"mouseHandler%5Bbgrid_%2C%20win_%2C%20canvas_%5D%20%3D%20Module%5B%7B%0A%20%20arrow%20%3D%20False%2C%0A%20%20dest%20%3D%20%7B0%2C0%7D%2C%0A%20%20start%20%3D%20%7B0%2C0%7D%0A%7D%2C%20%7B%0A%20%20%20%20%20%20%22mouseup%22%20-%3E%20Function%5Bxy%2C%0A%20%20%20%20%20%20%20%20With%5B%7Bv%20%3D%20-Normalize%5Bstart%20-%20xy%5D%7D%2C%0A%20%20%20%20%20%20%20%20%20%20Do%5B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20With%5B%7Bp%20%3D%20Clip%5B%23%2C%20%7B1%2C15%7D%5D%20%26%2F%40%20Round%20%2F%40%20%28%28xy%20-%20start%29%20a%20%2B%20start%29%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20bgrid%5B%5Bp%5B%5B1%5D%5D%2Cp%5B%5B2%5D%5D%5D%5D%20%3D%20%7Bv%5B%5B1%5D%5D%2C%20v%5B%5B2%5D%5D%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%2C%20%7Ba%2C%200%2C%201%2C0.1%7D%5D%3B%20%28%2A%20a%20very%20stipid%20way%20of%20drawing%20lines%20%2A%29%0A%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20Delete%5Barrow%5D%3B%20%0A%20%20%20%20%20%20%20%20arrow%20%3D%20False%3B%0A%20%20%20%20%20%20%0A%20%20%20%20%20%20%5D%2C%0A%0A%20%20%20%20%20%20%22mousemove%22%20-%3E%20Function%5Bxy%2C%0A%20%20%20%20%20%20%20%20dest%20%3D%20xy%3B%0A%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%0A%20%20%20%20%20%20%22mousedown%22%20-%3E%20Function%5Bxy%2C%0A%20%20%20%20%20%20%20%20start%20%3D%20xy%3B%0A%20%20%20%20%20%20%20%20dest%20%3D%20xy%20%2B%20%7B1%2C1%7D%3B%20%0A%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20If%5Barrow%20%3D%21%3D%20False%2C%20Delete%5Barrow%5D%5D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20arrow%20%3D%20FrontSubmit%5B%7B%0A%20%20%20%20%20%20%20%20%20%20AbsoluteThickness%5B3%5D%2C%20Gray%2C%20%0A%20%20%20%20%20%20%20%20%20%20Arrow%5B%7Bxy%2C%20dest%20%2F%2F%20Offload%7D%5D%0A%20%20%20%20%20%20%20%20%7D%2C%20%0A%20%20%20%20%20%20%20%20%20%20canvas%2C%20%0A%20%20%20%20%20%20%20%20%20%20%22Window%22-%3Ewin%2C%20%0A%20%20%20%20%20%20%20%20%20%20%22Tracking%22-%3ETrue%20%0A%20%20%20%20%20%20%20%20%5D%3B%0A%20%20%20%20%20%20%0A%20%20%20%20%20%20%5D%0A%20%20%7D%5D%3B%0A%0ASetAttributes%5BmouseHandler%2C%20HoldFirst%5D"}),"\n",(0,n.jsx)(e.p,{children:"Subscribe for events"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"8ce88c58-4077-41f8-b510-6b255e24b7f4",type:"Input",opts:{},children:"vtime%20%3D%20AbsoluteTime%5B%5D%3B%0A%0AEventHandler%5B%22vframe%22%2C%20Function%5BNull%2C%0A%20%20vgrid%20%3D%20advect%5Bvgrid%2C%20vgrid%5D%20%2F%2F%20N%3B%20%0A%20%20vcolors%20%3D%20Map%5BFunction%5Bval%2C%20%28%2AFB%5B%2A%29%28%28%CF%80%20%2B%202.0%20ToPolarCoordinates%5Bval%5D%2F%2F%20Last%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%283.0%20%CF%80%29%29%28%2A%5DFB%2A%29%20%5D%2C%20vgrid%2C%20%7B2%7D%5D%3B%0A%20%20%0A%20%20vfps%20%3D%20%28%2AFB%5B%2A%29%28%28%28vfps%20%2B%201%20%2F%20%28AbsoluteTime%5B%5D%20-%20vtime%29%29%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29%20%2F%2F%20Round%3B%0A%20%20vtime%20%3D%20AbsoluteTime%5B%5D%3B%20%0A%5D%5D%3B"}),"\n",(0,n.jsx)(e.p,{children:"Assemble the widget"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"1fea2dd4-8fa5-4606-b6ed-4b23afe8279b",type:"Input",opts:{},children:"With%5B%7B%0A%20%20win%20%3D%20CurrentWindow%5B%5D%2C%20%0A%20%20currentCell%20%3D%20ResultCell%5B%5D%2C%0A%20%20canvas%20%3D%20CreateUUID%5B%5D%0A%7D%2C%0A%0A%20%20EventHandler%5Bwin%2C%20%7B%22Closed%22%20-%3E%20Function%5BNull%2C%0A%20%20%20%20Delete%5BcurrentCell%5D%20%0A%20%20%5D%7D%5D%3B%0A%0A%20%20Graphics%5B%7B%0A%20%20%20%20Table%5BWith%5B%7Bi%3Di%2C%20j%3Dj%7D%2C%20%0A%20%20%20%20%20%20%0A%20%20%20%20%20%20Offload%5B%7B%20%0A%20%20%20%20%20%20%20%20Hue%5Bvcolors%5B%5Bi%5D%5D%5B%5Bj%5D%5D%5D%2C%0A%20%20%20%20%20%20%20%20Arrow%5B%7B%7Bi%2Cj%7D%2C%20%7Bi%2Cj%7D%20%2B%20%20vgrid%5B%5Bi%5D%5D%5B%5Bj%5D%5D%7D%5D%0A%20%20%20%20%20%20%7D%5D%20%0A%20%20%20%20%0A%20%20%20%20%5D%2C%20%7Bi%2C15%7D%2C%20%7Bj%2C15%7D%5D%2C%0A%0A%20%20%20%0A%20%20%20%20EventHandler%5BGraphics%60Canvas%5B%5D%2C%20mouseHandler%5Bvgrid%2C%20win%2C%20MetaMarker%5Bcanvas%5D%5D%5D%2C%20%0A%0A%20%20%20%20AnimationFrameListener%5Bvfps%20%2F%2F%20Offload%2C%20%22Event%22-%3E%22vframe%22%5D%2C%20%0A%20%20%20%20%0A%20%20%20%20MetaMarker%5Bcanvas%5D%2C%20%0A%20%20%20%20Text%5Bvfps%20%2F%2F%20Offload%2C%20%7B0%2C0%7D%5D%0A%20%20%7D%2C%20%0A%20%20%20%20Controls-%3EFalse%2C%20%0A%20%20%20%20ImageSize-%3E500%2C%20%0A%20%20%20%20PlotRange-%3E%7B%7B-0.5%2C15.5%7D%2C%20%7B-0.5%2C15.5%7D%7D%2C%20%0A%20%20%20%20ImagePadding-%3ENone%2C%20%0A%20%20%20%20TransitionType-%3ENone%0A%20%20%5D%0A%5D"}),"\n",(0,n.jsx)(e.p,{children:"In the end it should be similar to what is shown on the animation"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:a(91928).c+"",width:"600",height:"605"})}),"\n",(0,n.jsx)(e.h2,{id:"test-particles",children:"Test particles"}),"\n",(0,n.jsx)(e.p,{children:"In order to better visualize the fluid, we need something to be moved by our stream. The simplest solution is to spread hundreds of tracer particles. The velocity field can push them in the direction interpolated bilinearly from the grid."}),"\n",(0,n.jsx)(e.h3,{id:"bilinear-interpolation",children:"Bilinear interpolation"}),"\n",(0,n.jsx)(e.p,{children:"This is the most basic thing to implement. This probably is not the fastest version, but good enough for educational purposes."}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"cd79795a-7b00-4737-9eb6-03ce468ce3fe",type:"Input",opts:{InitGroup:!0,Fade:!0},children:"bilinearInterpolation%5Barray_%2C%20%7Bx0_%2C%20y0_%7D%5D%20%3A%3D%20Module%5B%0A%20%20%7Brows%2C%20cols%2C%20x%20%3D%20y0%2C%20y%20%3D%20x0%2C%20x1%2C%20x2%2C%20y1%2C%20y2%2C%20fQ11%2C%20fQ12%2C%20fQ21%2C%20fQ22%7D%2C%0A%20%20%0A%20%20%28%2A%20Get%20the%20dimensions%20of%20the%20array%20%2A%29%0A%20%20%7Brows%2C%20cols%7D%20%3D%20Take%5BDimensions%5Barray%5D%2C%202%5D%3B%0A%20%20%0A%20%20%28%2A%20Clip%20points%20to%20the%20boundaries%20%2A%29%0A%20%20x%20%3D%20Clip%5Bx%2C%20%7B1%2C%20cols%7D%5D%3B%0A%20%20y%20%3D%20Clip%5By%2C%20%7B1%2C%20rows%7D%5D%3B%0A%20%20%0A%20%20%28%2A%20Find%20the%20bounding%20indices%20%2A%29%0A%20%20x1%20%3D%20Floor%5Bx%5D%3B%20%0A%20%20x2%20%3D%20Ceiling%5Bx%5D%3B%0A%20%20y1%20%3D%20Floor%5By%5D%3B%20%0A%20%20y2%20%3D%20Ceiling%5By%5D%3B%0A%20%20%0A%20%20%28%2A%20Get%20the%20values%20at%20the%20four%20corners%20%2A%29%0A%20%20fQ11%20%3D%20array%5B%5By1%2C%20x1%5D%5D%3B%0A%20%20fQ12%20%3D%20array%5B%5By2%2C%20x1%5D%5D%3B%0A%20%20fQ21%20%3D%20array%5B%5By1%2C%20x2%5D%5D%3B%0A%20%20fQ22%20%3D%20array%5B%5By2%2C%20x2%5D%5D%3B%0A%20%20%0A%20%20%28%2A%20Perform%20bilinear%20interpolation%20%2A%29%0A%20%20If%5Bx2%20%3D%3D%20x1%2C%0A%20%20%20%20If%5By2%20%3D%3D%20y1%2C%0A%20%20%20%20%20%20fQ11%2C%0A%20%20%20%20%20%201%2F%282%20%28y2%20-%20y1%29%29%20%2A%20%28%0A%20%20%20%20%20%20%20%20fQ11%20%28y2%20-%20y%29%20%2B%0A%20%20%20%20%20%20%20%20fQ21%20%28y2%20-%20y%29%20%2B%0A%20%20%20%20%20%20%20%20fQ12%20%28y%20-%20y1%29%20%2B%0A%20%20%20%20%20%20%20%20fQ22%20%28y%20-%20y1%29%0A%20%20%20%20%20%20%29%0A%20%20%20%20%5D%2C%0A%20%20%20%20If%5By2%20%3D%3D%20y1%2C%0A%20%20%20%20%20%201%2F%282%20%28x2%20-%20x1%29%29%20%2A%20%28%0A%20%20%20%20%20%20%20%20fQ11%20%28x2%20-%20x%29%20%2B%0A%20%20%20%20%20%20%20%20fQ21%20%28x%20-%20x1%29%20%2B%0A%20%20%20%20%20%20%20%20fQ12%20%28x2%20-%20x%29%20%2B%0A%20%20%20%20%20%20%20%20fQ22%20%28x%20-%20x1%29%0A%20%20%20%20%20%20%29%2C%0A%20%20%20%20%20%201%2F%28%28x2%20-%20x1%29%20%28y2%20-%20y1%29%29%20%2A%20%28%0A%20%20%20%20%20%20%20%20fQ11%20%28x2%20-%20x%29%20%28y2%20-%20y%29%20%2B%0A%20%20%20%20%20%20%20%20fQ21%20%28x%20-%20x1%29%20%28y2%20-%20y%29%20%2B%0A%20%20%20%20%20%20%20%20fQ12%20%28x2%20-%20x%29%20%28y%20-%20y1%29%20%2B%0A%20%20%20%20%20%20%20%20fQ22%20%28x%20-%20x1%29%20%28y%20-%20y1%29%0A%20%20%20%20%20%20%29%0A%20%20%20%20%5D%0A%20%20%5D%0A%5D"}),"\n",(0,n.jsx)(e.p,{children:"One can check if it works correctly by scaling up some raster images"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"e5035e3b-0e46-4a38-becf-47d581c9bfd7",type:"Input",opts:{},children:"bmp%20%3D%20Table%5B%7B%28%2ASpB%5B%2A%29Power%5BCos%5By%5D%28%2A%7C%2A%29%2C%28%2A%7C%2A%292%5D%28%2A%5DSpB%2A%29%2C%20%28%2ASpB%5B%2A%29Power%5BSin%5Bx%5D%28%2A%7C%2A%29%2C%28%2A%7C%2A%292%5D%28%2A%5DSpB%2A%29%2C%200.5%7D%20%2F%2F%20N%2C%20%7Bx%2C%200%2C%20Pi%2C%20Pi%2F5%7D%2C%20%7By%2C%200%2C%20Pi%2C%20Pi%2F5%7D%5D%3B%0Aibmp%20%3D%20Table%5BbilinearInterpolation%5Bbmp%2C%20%7Bx%2Cy%7D%5D%2C%20%20%7Bx%2C%201%2C%206%20-%200.1%2C%200.0165%202%7D%2C%20%7By%2C%201%2C%206%20-%200.1%2C%200.0165%202%7D%5D%3B%0A%0A%7B%0A%20%20Image%5BImageResize%5BImage%5Bbmp%2C%20%22Real32%22%5D%2C%20Scaled%5B25%5D%2C%20Resampling-%3E%22Nearest%22%5D%2C%20Magnification-%3E2%5D%2C%20%0A%20%20Image%5Bibmp%2C%20%22Real32%22%2C%20Magnification-%3E2%5D%0A%7D%20%2F%2F%20Row%20"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"382912b8-ecef-4381-a47d-ae6a836bb223",type:"Output",opts:{},children:"%28%2AGB%5B%2A%29%7B%7B%28%2AVB%5B%2A%29%28FrontEndRef%5B%22a2a331ed-cc9c-4b80-9377-d58dd2533045%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKJxolGhsbpqboJidbJuuaJFkY6Foam5vrpphapKQYmRobG5iYAgCKcRVw%22%2A%29%28%2A%5DVB%2A%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%29%28%2AVB%5B%2A%29%28FrontEndRef%5B%22c2d79718-ca37-454d-8357-b2c9a1224b84%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKJxulmFuaG1roJicam%2BuamJqk6FoYm5rrJhklWyYaGhmZJFmYAAB9KBUa%22%2A%29%28%2A%5DVB%2A%29%7D%7D%28%2A%5DGB%2A%29"}),"\n",(0,n.jsx)(e.p,{children:"On the right, there is our interpolated array, while on the left, the original one"}),"\n",(0,n.jsx)(e.h3,{id:"uniform-distribution",children:"Uniform distribution"}),"\n",(0,n.jsx)(e.p,{children:"There is another short problem to solve: how to distribute particles evenly over a defined region. However, there is a solution out of the box in the Wolfram Language standard library."}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"0046f1c0-1a6e-47cf-83e0-ec7ed85e08fa",type:"Input",opts:{},children:"RandomPointConfiguration%5B%0A%20%20%20%20%20%20HardcorePointProcess%5B10000%2C%200.4%2C%202%5D%2C%0A%20%20%20%20%20%20Rectangle%5B%7B1%2C1%7D%2C%20%7B5%2C5%7D%5D%0A%2C%20Method%20-%3E%20%7B%22LengthOfRun%22%20-%3E%2010000000%7D%5D%5B%22Points%22%5D%20%2F%2F%20Point%20%2F%2F%20Graphics%20"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"0d78c370-1e1a-4292-a10d-cadb58446f16",type:"Output",opts:{},children:"%28%2AVB%5B%2A%29%28FrontEndRef%5B%221b5a0b27-3686-4aa2-a7a8-ce20c1a34c56%22%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKGyaZJhokGZnrGptZmOmaJCYa6SaaJ1roJqcaGSQbJhqbJJuaAQCBHhWL%22%2A%29%28%2A%5DVB%2A%29"}),"\n",(0,n.jsx)(e.p,{children:"The last thing is to implement a function, which updates all probe particles"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"d78c897a-3693-4790-a328-f846ff49ba42",type:"Input",opts:{InitGroup:!0},children:"advectParticles%5Bv_%2C%20pts_%2C%20%CE%B4t_%3A0.02%5D%20%3A%3D%20Map%5BFunction%5Bp%2C%20p%20%2B%20%CE%B4t%20%28bilinearInterpolation%5Bv%2C%20p%5D%29%5D%2C%20pts%5D"}),"\n",(0,n.jsx)(e.h2,{id:"complete-real-time-fluid-simulation",children:"Complete Real-Time fluid simulation"}),"\n",(0,n.jsx)(e.p,{children:"Wrapping everything up together with the divergence solver from the previous part, we can finally assemble the model"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"1b7c985e-3f91-4ec9-8c4a-9b59f7dd221c",type:"Input",opts:{InitGroup:!0,Fade:!0},children:"removeDivergence%5Bgrid_%5D%20%3A%3D%20With%5B%7B%0A%20%20%28%2ABB%5B%2A%29%28%2Asafety%20checks%2C%20which%20enforce%20closed%20boundaries%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0A%20%20take%20%3D%20Function%5B%7Barray%2C%20x%2Cy%7D%2C%20If%5Bx%20%3E%3D%201%20%26%26%20x%20%3C%3D%20Length%5Bgrid%5D%20%26%26%20y%20%3E%3D%201%20%26%26%20y%20%3C%3D%20Length%5Bgrid%5D%2C%20array%5B%5Bx%2Cy%5D%5D%2C%20%7B0%2C0%7D%5D%5D%0A%7D%2C%0A%20%20MapIndexed%5BFunction%5B%7Bval%2C%20i%7D%2C%20%0A%20%20%20%20val%20%2B%20%28%2AFB%5B%2A%29%28%281%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%288.0%29%29%28%2A%5DFB%2A%29%20%28%0A%20%20%20%20%20%20%28%28take%5Bgrid%2C%20i%5B%5B1%5D%5D%20-%201%2C%20i%5B%5B2%5D%5D%20-%201%5D%20%2B%20take%5Bgrid%2C%20i%5B%5B1%5D%5D%20%2B%201%2C%20i%5B%5B2%5D%5D%20%2B%201%5D%29.%7B1%2C1%7D%29%7B1%2C1%7D%20%2B%0A%0A%20%20%20%20%20%20%28%28take%5Bgrid%2C%20i%5B%5B1%5D%5D%20-%201%2C%20i%5B%5B2%5D%5D%20%2B%201%5D%20%2B%20take%5Bgrid%2C%20i%5B%5B1%5D%5D%20%2B%201%2C%20i%5B%5B2%5D%5D%20-%201%5D%29.%7B1%2C-1%7D%29%7B1%2C-1%7D%20%2B%0A%0A%20%20%20%20%20%20%28take%5Bgrid%2C%20i%5B%5B1%5D%5D-1%2C%20i%5B%5B2%5D%5D%5D%20%2B%20take%5Bgrid%2C%20i%5B%5B1%5D%5D%2B1%2C%20i%5B%5B2%5D%5D%5D%20-%20take%5Bgrid%2C%20i%5B%5B1%5D%5D%2C%20i%5B%5B2%5D%5D-1%5D%20-%20take%5Bgrid%2C%20i%5B%5B1%5D%5D%2C%20i%5B%5B2%5D%5D%2B1%5D%29%7B2%2C-2%7D%20%2B%20take%5Bgrid%2C%20i%5B%5B1%5D%5D%2C%20i%5B%5B2%5D%5D%5D%20%28-4%29%0A%0A%20%20%20%20%29%0A%20%20%5D%2C%20grid%2C%20%7B2%7D%5D%0A%5D"}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"TL;DR"}),"\nHere is the final code"]}),"\n",(0,n.jsx)(i.gL,{children:"%3Cspan%20id%3D%22tldr%22%20style%3D%22color%3A%20blue%22%3E%3Cb%20%3EEvaluate%20the%20cell%20below%3C%2Fb%3E%20in%20the%20notebook.%20Use%20your%20mouse%20to%20draw%20velocity%20vectors.%3C%2Fspan%3E"}),"\n",(0,n.jsx)(i.EB,{display:"codemirror",nid:"5caf3e63-833d-41f0-b4be-6dd62b241fad",id:"078e51b7-428a-421e-96de-b82dd3c3ff07",type:"Input",opts:{},children:"fgrid%20%3D%20Table%5B%7B0.%2C0.%7D%2C%20%7Bi%2C15%7D%2C%20%7Bj%2C15%7D%5D%3B%0Afcolors%20%3D%20Table%5B1.0%2C%20%7BLength%5Bfgrid%5D%7D%2C%20%7BLength%5Bfgrid%5D%7D%5D%3B%0Affps%20%3D%200%3B%0A%0Aparticles%20%3D%20RandomPointConfiguration%5B%0A%20%20%20%20%20%20HardcorePointProcess%5B10000%0A%20%20%20%20%20%20%2C%200.4%2C%202%5D%2C%0A%20%20%20%20%20%20Rectangle%5B%7B1%2B4%2C1%2B4%7D%2C%20%7B15-4%2C15-4%7D%5D%2C%20Method%20-%3E%20%7B%22LengthOfRun%22%20-%3E%2010000000%7D%5D%5B%22Points%22%5D%3B%0A%0A%0Aftime%20%3D%20AbsoluteTime%5B%5D%3B%0A%0Afpipeline%20%3D%20Composition%5BremoveDivergence%2C%20removeDivergence%2C%20advect%5B%23%2C%23%2C%200.2%5D%26%5D%3B%0A%0AEventHandler%5B%22fframe%22%2C%20Function%5BNull%2C%0A%0A%20%20fgrid%20%3D%20fpipeline%5Bfgrid%5D%3B%0A%20%20%0A%20%20fcolors%20%3D%20Map%5BFunction%5Bval%2C%20%28%2AFB%5B%2A%29%28%28%CF%80%20%2B%202.0%20ToPolarCoordinates%5Bval%5D%2F%2F%20Last%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%283.0%20%CF%80%29%29%28%2A%5DFB%2A%29%20%5D%2C%20fgrid%2C%20%7B2%7D%5D%3B%0A%20%20%0A%20%20particles%20%3D%20With%5B%7Bp%20%3D%20advectParticles%5Bfgrid%2C%20particles%2C%200.3%5D%7D%2C%0A%20%20%20%20advectParticles%5Bfgrid%2C%20p%2C%200.3%5D%0A%20%20%5D%3B%0A%0A%20%20ffps%20%3D%20%28%2AFB%5B%2A%29%28%28%28ffps%20%2B%201%20%2F%20%28AbsoluteTime%5B%5D%20-%20ftime%29%29%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%282.0%29%29%28%2A%5DFB%2A%29%20%2F%2F%20Round%3B%0A%20%20ftime%20%3D%20AbsoluteTime%5B%5D%3B%20%0A%5D%5D%3B%0A%0AWith%5B%7B%0A%20%20win%20%3D%20CurrentWindow%5B%5D%2C%20%0A%20%20currentCell%20%3D%20ResultCell%5B%5D%2C%0A%20%20canvas%20%3D%20CreateUUID%5B%5D%0A%7D%2C%0A%0A%20%20EventHandler%5Bwin%2C%20%7B%22Closed%22%20-%3E%20Function%5BNull%2C%0A%20%20%20%20Delete%5BcurrentCell%5D%20%0A%20%20%5D%7D%5D%3B%0A%0A%20%20Graphics%5B%7BArrowheads%5BMedium%2F2%5D%2C%0A%20%20%20%20Table%5BWith%5B%7Bi%3Di%2C%20j%3Dj%7D%2C%20%0A%20%20%20%20%20%20%0A%20%20%20%20%20%20Offload%5B%7B%20%0A%20%20%20%20%20%20%20%20Hue%5Bfcolors%5B%5Bi%5D%5D%5B%5Bj%5D%5D%5D%2C%0A%20%20%20%20%20%20%20%20Arrow%5B%7B%7Bi%2Cj%7D%2C%20%7Bi%2Cj%7D%20%2B%20%20fgrid%5B%5Bi%5D%5D%5B%5Bj%5D%5D%7D%5D%0A%20%20%20%20%20%20%7D%5D%20%0A%20%20%20%20%0A%20%20%20%20%5D%2C%20%7Bi%2C15%7D%2C%20%7Bj%2C15%7D%5D%2C%0A%0A%20%20%20%20%0A%20%20%20%20EventHandler%5BGraphics%60Canvas%5B%5D%2C%20mouseHandler%5Bfgrid%2C%20win%2C%20MetaMarker%5Bcanvas%5D%5D%5D%2C%20%0A%0A%20%20%20%20%0A%20%20%20%20AnimationFrameListener%5Bffps%20%2F%2F%20Offload%2C%20%22Event%22-%3E%22fframe%22%5D%2C%20%0A%20%20%20%20%0A%20%20%20%20MetaMarker%5Bcanvas%5D%2C%20%0A%20%20%20%20PointSize%5B0.02%5D%2C%20Point%5Bparticles%2F%2FOffload%5D%2C%0A%20%20%20%20Text%5Bffps%20%2F%2F%20Offload%2C%20%7B0%2C0%7D%5D%0A%20%20%7D%2C%20%0A%20%20%20%20Controls-%3EFalse%2C%20%0A%20%20%20%20ImageSize-%3E500%2C%20%0A%20%20%20%20PlotRange-%3E%7B%7B-0.5%2C15.5%7D%2C%20%7B-0.5%2C15.5%7D%7D%2C%20%0A%20%20%20%20ImagePadding-%3ENone%2C%20%0A%20%20%20%20TransitionDuration-%3E35%20%0A%20%20%5D%0A%5D"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.em,{children:"Use your mouse to draw velocity vectors"})}),"\n","\n",(0,n.jsx)("video",{width:"100%",controls:!0,children:(0,n.jsx)("source",{src:t})}),"\n",(0,n.jsx)(e.p,{children:"There is still a lot that can be improved further. Especially advection and the code for removing divergence can be optimized and compiled as well."}),"\n",(0,n.jsx)(e.h2,{id:"optimizations",children:"Optimizations"}),"\n",(0,n.jsxs)(e.p,{children:["Since all our main functions used in the animation loop are dealing only with numerics, one can apply ",(0,n.jsx)(e.code,{children:"Compile"})," to them. With some minor changes made (which unfortunately make the code a bit ugly, because not all functions are compilable) we have"]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-mathematica",children:"advect = Compile[{{v, _Real, 3}, {u, _Real, 3}, {\u03b4t, _Real, 0}} , With[{max = Length[v]}, With[{\n \n},\n  Table[ \n  \n    With[{\n      v1 =  (*FB[*)((If[i-1 >= 1, v[[i-1, j]], {0.,0.}] + v[[i, j]])(*,*)/(*,*)(2.0))(*]FB*).{1,0},\n      v2 =  (*FB[*)((If[j+1 <= max, v[[i, j+1]], {0.,0.}] + v[[i, j]])(*,*)/(*,*)(2.0))(*]FB*).{0,-1},\n      v3 =  (*FB[*)((If[i+1 <= max, v[[i+1, j]], {0.,0.}] + v[[i, j]])(*,*)/(*,*)(2.0))(*]FB*).{-1,0},\n      v4 =  (*FB[*)((If[j-1 >= 1, v[[i, j-1]], {0.,0.}] + v[[i, j]])(*,*)/(*,*)(2.0))(*]FB*).{0,1},\n      org = u[[i,j]]\n    },\n\n      org +  (\n      \n        v1 If[v1 >0, If[i-1 >= 1, u[[i-1, j]], {0.,0.} ], org]  + v3 If[v3>0,If[i+1 <= max, u[[i+1, j]], {0.,0.} ], org]+\n        \n        v4 If[v4 >0, If[j-1 >= 1, u[[i, j-1]], {0.,0.} ], org] + v2 If[v2>0, If[j+1 <= max, u[[i, j+1]], {0.,0.} ], org]\n        \n      ) \u03b4t \n    ]\n    \n  , {i, max}, {j, max}] // Chop\n ]] ];\n"})}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-mathematica",children:"removeDivergence = Compile[{{grid, _Real, 3}}, With[{\n  max = grid // Length\n},\n  MapIndexed[Function[{val, i}, \n    val + (*FB[*)((1)(*,*)/(*,*)(8.0))(*]FB*) (\n      (\n        (\n          If[i[[1]] - 1 >= 1 && i[[1]] - 1 <= max && i[[2]] - 1 >= 1 && i[[2]] - 1 <= max, grid[[i[[1]] - 1, i[[2]] - 1]], {0.,0.}] \n          \n          + If[i[[1]] + 1 >=1 && i[[1]] + 1 <= max && i[[2]] + 1 >= 1 && i[[2]] + 1 <= max, grid[[i[[1]] + 1, i[[2]] + 1]], {0.,0.}]\n        \n        ).{1,1}\n        \n      ){1,1} +\n\n      (\n        (\n          If[i[[1]] - 1 >= 1 && i[[1]] - 1 <= max && i[[2]] + 1 >= 1 && i[[2]] + 1 <= max, grid[[i[[1]] - 1, i[[2]] + 1]], {0.,0.}]\n          \n          + If[i[[1]] + 1 >= 1 && i[[1]] + 1 <= max && i[[2]] - 1 >= 1 && i[[2]] - 1 <= max, grid[[i[[1]] + 1, i[[2]] - 1]], {0.,0.}]\n          \n        ).{1,-1}\n        \n      ){1,-1} +\n\n      (\n        If[i[[1]]-1 >= 1 && i[[1]]-1 <= max, grid[[i[[1]]-1, i[[2]] ]], {0.,0.}]\n        \n        + If[i[[1]]+1 >= 1 && i[[1]]+1 <= max, grid[[ i[[1]]+1, i[[2]] ]], {0.,0.}]\n        \n        - If[i[[2]]-1 >= 1 && i[[2]]-1 <= max, grid[[ i[[1]], i[[2]]-1 ]], {0.,0.}]\n        \n        - If[i[[2]]+1 >= 1 && i[[2]]+1 <= max, grid[[i[[1]], i[[2]]+1]], {0.,0.}]\n        \n      ){2,-2} \n        \n        + grid[[ i[[1]], i[[2]] ]] (-4)\n\n    )\n  ], grid, {2}]\n] ];\n"})}),"\n",(0,n.jsx)(e.p,{children:"and"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-mathematica",children:"bilinearInterpolation = Compile[{{array, _Real, 3}, {v, _Real, 1}}, Module[\n  {rows, cols, x = v[[2]], y = v[[1]], x1, x2, y1, y2, fQ11, fQ12, fQ21, fQ22},\n  \n  (* Get the dimensions of the array *)\n  {rows, cols} = {Length[array], Length[array]};\n  \n  (* Clip points to the boundaries *)\n  x = Clip[x, {1, cols}];\n  y = Clip[y, {1, rows}];\n  \n  (* Find the bounding indices *)\n  x1 = Floor[x]; \n  x2 = Ceiling[x];\n  y1 = Floor[y]; \n  y2 = Ceiling[y];\n  \n  (* Get the values at the four corners *)\n  fQ11 = array[[y1, x1]];\n  fQ12 = array[[y2, x1]];\n  fQ21 = array[[y1, x2]];\n  fQ22 = array[[y2, x2]];\n  \n  (* Perform bilinear interpolation *)\n  If[x2 == x1,\n    If[y2 == y1,\n      fQ11,\n      1/(2 (y2 - y1)) * (\n        fQ11 (y2 - y) +\n        fQ21 (y2 - y) +\n        fQ12 (y - y1) +\n        fQ22 (y - y1)\n      )\n    ],\n    If[y2 == y1,\n      1/(2 (x2 - x1)) * (\n        fQ11 (x2 - x) +\n        fQ21 (x - x1) +\n        fQ12 (x2 - x) +\n        fQ22 (x - x1)\n      ),\n      1/((x2 - x1) (y2 - y1)) * (\n        fQ11 (x2 - x) (y2 - y) +\n        fQ21 (x - x1) (y2 - y) +\n        fQ12 (x2 - x) (y - y1) +\n        fQ22 (x - x1) (y - y1)\n      )\n    ]\n  ]\n] ];\n"})}),"\n",(0,n.jsxs)(e.p,{children:["After that the main bottleneck is still the way how we draw and update SVG graphics (as well as WebSocket connection latency). However, these changes improves average FPS from ",(0,n.jsx)(e.code,{children:"17-24"})," up to ",(0,n.jsx)(e.code,{children:"30-35"})," on my Mac Air M1."]})]})}function o(s={}){const{wrapper:e}={...(0,l.M)(),...s.components};return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(C,{...s})}):C(s)}},46880:(s,e,a)=>{"use strict";a.d(e,{EB:()=>d,gL:()=>h,Af:()=>c});var n,l=a(11504);a(93391),a(28264);function i(){return i=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(s[n]=a[n])}return s},i.apply(this,arguments)}const t=s=>{let{title:e,titleId:a,...t}=s;return l.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"w-5 h-5 ml-auto",viewBox:"0 0 24 24","aria-labelledby":a},t),e?l.createElement("title",{id:a},e):null,n||(n=l.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",d:"M17 17h.01m.39-3h.6c.932 0 1.398 0 1.765.152a2 2 0 0 1 1.083 1.083C21 15.602 21 16.068 21 17s0 1.398-.152 1.765a2 2 0 0 1-1.083 1.083C19.398 20 18.932 20 18 20H6c-.932 0-1.398 0-1.765-.152a2 2 0 0 1-1.083-1.083C3 18.398 3 17.932 3 17s0-1.398.152-1.765a2 2 0 0 1 1.083-1.083C4.602 14 5.068 14 6 14h.6m5.4 1V4m0 11-3-3m3 3 3-3"})))};var r=a(66528),m=(a(98684),a(52964),a(93664),a(17624));function c(s){let{json:e,notebook:a,kernel:n}=s;const{colorMode:i,setColorMode:c}=(0,r.U)();return(0,l.useEffect)((()=>{console.warn("Create store"),console.warn(e);const s={},a={},l=[],i=new Deferred;let t=async()=>{t=async()=>{},fetch(e).then((e=>{console.warn("Store loaded!"),e.json().then((e=>{interpretate(e.objects,{hold:!0}).then((e=>{console.warn("Objects loaded!"),Object.keys(e).forEach((s=>{const a=new ObjectStorage(s);a.cache=e[s],a.cached=!0})),Object.keys(s).forEach((a=>{Array.isArray(s[a])?s[a].forEach((s=>s.resolve(e[a]))):s[a].resolve(e[a])}))})),interpretate(e.symbols,{hold:!0}).then((s=>{console.warn("Symbols loaded!"),Object.keys(s).forEach((e=>{core[e]=async(s,a)=>await interpretate(core[e].data,a),core[e].data=s[e],core[e]=async(s,a)=>{console.log("IE: calling our symbol...");const n=await interpretate(core[e].data,a);return a.root&&!a.novirtual&&(core[e].instances[a.root.uid]=a.root),n},core[e].update=async(s,a)=>{if(a.useCache)return core[e].cached&&core[e].currentData==core[e].data||(core[e].cached=await interpretate(core[e].data,a),core[e].currentData=core[e].data),core[e].cached;return await interpretate(core[e].data,a)},core[e].destroy=async(s,a)=>{delete core[e].instances[a.root.uid],console.warn(a.root.uid+" was destroyed"),console.warn("external symbol was destoryed")},core[e].data=structuredClone(s[e]),core[e].virtual=!0,core[e].instances={}})),Object.keys(a).forEach((e=>{console.warn(e),a[e].resolve(s[e])})),i.resolve()}))}))}))};core.Offload=(s,e)=>{if(s.length>1)if("'Static'"===s[1][1]){if(s[1][2])return interpretate(s[0],{...e,static:!0})}else if(s.length>2&&"'Static'"===s[2][1]&&s[2][2])return interpretate(s[0],{...e,static:!0});return interpretate(s[0],e)},core.Offload.update=(s,e)=>{if(s.length>1)if("'Volatile'"===s[1][1]){if(!s[1][2])return void console.log("Update was rejected (Nonvolatile)")}else if(s.length>2&&"'Volatile'"===s[2][1]&&!s[2][2])return void console.log("Update was rejected (Nonvolatile)");return interpretate(s[0],e)},window.server={kernel:{}},window.server.ask=e=>{const a=new Deferred;if(e.length<42)return console.error("Unknown command"),console.error(e),!1;return Array.isArray(s[e.slice(60,-2)])?s[e.slice(60,-2)].push(a):s[e.slice(60,-2)]=[a],t(),a.promise},window.server.getSymbol=s=>{const e=new Deferred;return console.warn("Asking for symbol"+s),a[s]=e,e.promise},window.server.kernel.emitt=function(s,e,a){void 0===a&&(a="Default"),l.push({uid:s,data:e,type:a})},interpretate.anonymous=async(s,e)=>{let n,l;if(console.log("Anonimous symbol: "+JSON.stringify(s)),s instanceof Array)throw console.error(s),"unknown WL expression. Error at "+s[0];n=s;const i=new Deferred;return console.warn("Asking for symbol"+n),a[n]=i,l=await i.promise,core[n]=async(s,e)=>{console.log("IE: calling our symbol...");const a=await interpretate(core[n].data,e);return e.root&&!e.novirtual&&(core[n].instances[e.root.uid]=e.root),a},core[n].update=async(s,e)=>{if(e.useCache)return core[n].cached&&core[n].currentData==core[n].data||(core[n].cached=await interpretate(core[n].data,e),core[n].currentData=core[n].data),core[n].cached;return await interpretate(core[n].data,e)},core[n].destroy=async(s,e)=>{delete core[n].instances[e.root.uid],console.warn(e.root.uid+" was destroyed"),console.warn("external symbol was destoryed")},core[n].data=l,core[n].virtual=!0,core[n].instances={},interpretate(s,e)},(async()=>{if(console.warn("Kernel"),n){if(console.warn("KERNEL"),!window.KernelState){const s=new Deferred,e=document.createElement("script");e.src="https://cdn.jsdelivr.net/gh/JerryI/wljs-export-html@base/dist/decoder.min.js",e.addEventListener("load",(()=>s.resolve())),document.head.appendChild(e),await s.promise,console.warn("KernelState lib loaded!")}fetch(n).then((s=>{console.log(s),s.json().then((async s=>{let e=[];for(const a of s)e.push(await interpretate.unzlib64String(a));e=e.map(KernelMesh.unpack),console.warn("Mesh loaded!"),console.log(e),window.server.kernel.emitt=function(s,a,n){void 0===n&&(n="Default"),setTimeout((()=>{const l={type:"event",uid:s,pattern:n,data:a},i=e;for(let s=0;s<i.length;++s)if(i[s].test(l)){if(i[s].state)i[s].state=new KernelState(i[s].state,l,!0);else{if(i[s].database.has("$initialization")){i[s].database.get("$initialization").forEach((e=>i[s].state=new KernelState(i[s].state,e,!0)))}i[s].state=new KernelState(i[s].state,l,!0)}i[s].state.exec(i[s].database,(s=>{for(const e of Object.keys(s))if(console.warn(e),"$state"!==e)if(1===s[e].set.length){console.log(s[e].set[0]),core[e].data=structuredClone(s[e].set[0]);for(const s of Object.values(core[e].instances))s.update()}else{s[e].i+=1,s[e].i>=s[e].set.length&&(s[e].i=0),core[e].data=structuredClone(s[e].set[s[e].i]);for(const s of Object.values(core[e].instances))s.update()}}))}}),4)},l.forEach((s=>window.server.kernel.emitt(s.uid,s.data,s.type)))}))}))}})()})),console.log("DONE loading mesh"),a?(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("a",{href:a,className:"dark"==i?"p-2 text-xs w-full flex ring-1 ring-inset shadow ring-gray-300 text-gray-300 my-2":"p-2 text-xs w-full flex ring-1 ring-inset text-gray-600 shadow ring-gray-300 bg-gray-300 my-2",children:["Download original notebook ",(0,m.jsx)(t,{})]})}):(0,m.jsx)(m.Fragment,{})}function h(s){let{children:e,data:a}=s;const n={__html:decodeURIComponent(e)};return(0,m.jsx)("div",{dangerouslySetInnerHTML:n})}function d(s){let{children:e,nid:a,id:n,type:i,display:t,opts:c}=s;const h=(0,l.useRef)(null),{colorMode:d,setColorMode:C}=(0,r.U)(),o=decodeURIComponent(e),[p,x]=(0,l.useState)(c.Fade),[j,g]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{const s=h.current;let e;if(console.warn("Create Codemirror"),console.warn(t),console.log(o),g(!0),console.warn("Created: "+t),"print"!=t){if(window.SupportedCells[t])return window.SupportedCells[t].view&&(e=new window.SupportedCells[t].view({element:s},o)),e.editor&&c.Fade&&(h.current.addEventListener("focusin",(()=>{x(!1)})),h.current.addEventListener("focusout",(()=>{x(!0)}))),()=>{e&&e.dispose()};console.warn("Not found: "+t)}}),[]),(0,m.jsx)("div",{style:{filter:"dark"==d?"invert(1) contrast(0.8) hue-rotate(-185deg)":"none"},className:"language-mathematica codeBlockContainer_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Container-styles-module theme-code-block",children:(0,m.jsx)("div",{className:p?"h-fade-20 codeBlockContent_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module":"codeBlockContent_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module",children:(0,m.jsxs)("pre",{tabIndex:"0",className:"prism-code language-mathematica codeBlock_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module thin-scrollbar",style:{color:"rgb(57, 58, 52)",backgroundColor:"rgb(246, 248, 250)"},children:[!j&&(0,m.jsx)("code",{style:{whiteSpace:"pre-wrap"},className:"codeBlockLines_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module",children:o}),(0,m.jsx)("code",{ref:h,className:"codeBlockLines_node_modules-@docusaurus-theme-classic-lib-theme-CodeBlock-Content-styles-module"})]})})})}},27752:(s,e,a)=>{"use strict";a.d(e,{c:()=>n});const n=a.p+"1c4737661d41fdb682981313f87cad74.txt"},49952:(s,e,a)=>{"use strict";a.d(e,{c:()=>n});const n=a.p+"7627b351c7bc33c865ab4fda1716c3b7.wln"},91928:(s,e,a)=>{"use strict";a.d(e,{c:()=>n});const n=a.p+"assets/images/momentum-ezgif.com-speed-d84da0f5f93daf5b8fe9d8d36c9d16e8.webp"},47944:()=>{},73223:()=>{}}]);