"use strict";(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[4246],{24970:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var a=i(74848),t=i(28453);const s={authors:"jerryi",tags:["dev","animation"],enableComments:!0},r="Mathematica's render in animations and dynamics",o={permalink:"/blog/2025/05/07/mma",source:"@site/blog/2025-05-07-mma/index.md",title:"Mathematica's render in animations and dynamics",description:"Developers log",date:"2025-05-07T00:00:00.000Z",tags:[{label:"dev",permalink:"/blog/tags/dev"},{label:"animation",permalink:"/blog/tags/animation"}],readingTime:1.835,hasTruncateMarker:!0,authors:[{name:"Kirill Vasin",title:"Maintainer",url:"https://github.com/JerryI",imageURL:"https://avatars.githubusercontent.com/u/4111822?s=48&v=4",key:"jerryi"}],frontMatter:{authors:"jerryi",tags:["dev","animation"],enableComments:!0},unlisted:!1,prevItem:{title:"Galton Board",permalink:"/blog/2025/12/06/galton"},nextItem:{title:"Interactive Magnifying Glass Effect",permalink:"/blog/2025/05/04/glass"}},l={authorsImageUrls:[void 0]},c=[{value:"Animation",id:"animation",level:2},{value:"Manipulate",id:"manipulate",level:2},{value:"UPD",id:"upd",level:2},{value:"Graphics3D",id:"graphics3d",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Developers log"})}),"\n",(0,a.jsxs)(n.p,{children:["It is clear, that not everyone is happy with WLJS rendering engine. Some styles might be different or look different from the traditional Mathematica's plots. For this reason we have ",(0,a.jsx)(n.code,{children:"MMAView"})," allowing to use built-in raster rendering engine of Wolfram Engine."]}),"\n",(0,a.jsxs)(n.p,{children:["But is it possible to animate things or use ",(0,a.jsx)(n.code,{children:"Manipulate"})," together with ",(0,a.jsx)(n.code,{children:"MMAView"}),"?"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsxs)(n.p,{children:["Short answer: ",(0,a.jsx)(n.strong,{children:"kinda"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"MMAView[]\n"})}),"\n",(0,a.jsxs)(n.p,{children:["acts indirectly using parallel kernel to build and render the given expression, which is already async operation. Having it inside ",(0,a.jsx)(n.code,{children:"Manipulate"})," or ",(0,a.jsx)(n.code,{children:"Animate"})," makes it 2x async, which is not possible in Wolfram Kernel. Therefore most likely you will get"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Timeout!\n"})}),"\n",(0,a.jsx)(n.h2,{id:"animation",children:"Animation"}),"\n",(0,a.jsxs)(n.p,{children:["Utilizing raster dynamics of ",(0,a.jsx)(n.code,{children:"Image"})," and manually updating pixel data, one can achieve the desired effect:"]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"prepare frames of animation"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"frames = Table[MMAView @ Plot[Sin[y x], {y,0,10}], {x, 0.1, 1.0, 0.05}];\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsx)(n.li,{children:"animate frames"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'Module[{buffer = ImageData[frames//First, "Byte"]},\n  Animate[Image[buffer // Offload, "Byte"], {i, 1, Length[frames], 1},\n    "UpdateFunction" -> Function[i,\n      (* stabilize raw image size *)\n      buffer = ImageData[ImageCrop[frames[[i]], ImageDimensions[frames // First]], "Byte"];\n      False (* prevent full refresh *)\n    ]\n  ]\n]\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:i(97085).A+"",width:"800",height:"300"})}),"\n",(0,a.jsx)(n.h2,{id:"manipulate",children:"Manipulate"}),"\n",(0,a.jsxs)(n.p,{children:["Here we need to forget about ",(0,a.jsx)(n.code,{children:"Manipulate"})," or ",(0,a.jsx)(n.code,{children:"ManipulatePlot"})," and define directly all sliders and etc. Also ",(0,a.jsx)(n.code,{children:"MMAView"})," is a blocking function and does not provide a control over the rasterization process. However we can do it all at the low level anyway"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:'With[{function = Plot[Sin[#1 x], {x,0,10}]&},\n With[{firstImage = MMAView[function[1]]},\n  With[{dims = ImageDimensions[firstImage]},\n    Module[{buffer = ImageData[firstImage, "Byte"]},\n      {\n        EventHandler[InputRange[0, 2, 0.1, "Label"->"w"], Function[w,\n          Then[ParallelSubmitFunctionAsync[Function[{args, cbk},\n              cbk @ ImageData[ImageCrop[Rasterize[function @ w], dims], "Byte"]\n            ], {all}], Function[imgData,\n              buffer = imgData;\n          ]];\n        ]],\n\n        Image[buffer // Offload, "Byte"]\n      } // Column \n\n    ]\n  ]\n ]\n]\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:i(61960).A+"",width:"800",height:"339"})}),"\n",(0,a.jsx)(n.p,{children:"Viola"}),"\n",(0,a.jsx)(n.p,{children:"PS: Most probably we need to make a wrapper for such things \ud83e\uddd9\ud83c\udffc\u200d\u2642\ufe0f"}),"\n",(0,a.jsx)(n.h2,{id:"upd",children:"UPD"}),"\n",(0,a.jsx)(n.p,{children:"Screw that! We made it \ud83c\udf88"}),"\n",(0,a.jsx)(n.h3,{id:"graphics3d",children:"Graphics3D"}),"\n",(0,a.jsxs)(n.p,{children:["We have a special wrapper for ",(0,a.jsx)(n.a,{href:"frontend/Reference/Graphics3D/Graphics3D.md",children:"Graphics3D"})," -like plots to make them interactive in the session"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mathematica",children:"With[{p = Plot3D[f[x] y, {x,0,10}, {y,0,10}]},\n  MMAView[p]\n]\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["Note, that it is important to pass it using ",(0,a.jsx)(n.code,{children:"With"}),", since ",(0,a.jsx)(n.code,{children:"MMAView"})," has ",(0,a.jsx)(n.code,{children:"HoldFirst"})," attribute. Otherwise the direct pass will give your a static plot"]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:i(52466).A+"",width:"354",height:"300"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"See more examples in the documentation!"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var a=i(96540);const t={},s=a.createContext(t);function r(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(s.Provider,{value:n},e.children)}},52466:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/neverasked-ezgif.com-optimize-37bf0759fe16d29770f988354ac7e682.gif"},61960:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/manipualte-ezgif.com-video-to-gif-converter-b0dc5b941ef524a4bc159aa3254d5bf0.gif"},97085:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/fifffsa-ezgif.com-video-to-gif-converter-c8845c0e8784a48b8741f89acc450f49.gif"}}]);