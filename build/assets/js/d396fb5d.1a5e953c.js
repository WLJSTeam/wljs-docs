"use strict";(self.webpackChunkwlx_docs=self.webpackChunkwlx_docs||[]).push([[17820],{69284:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var r=t(17624),a=t(4552);const o={title:"Speech to text using local WL neural network",authors:"jerryi",tags:["AI","short","javascript"],enableComments:!0},s=void 0,l={permalink:"/wljs-docs/blog/2024/10/15/speech2text",source:"@site/blog/2024-10-15-speech2text.md",title:"Speech to text using local WL neural network",description:"Speech2Text using built-in WL's neural network",date:"2024-10-15T00:00:00.000Z",tags:[{label:"AI",permalink:"/wljs-docs/blog/tags/ai"},{label:"short",permalink:"/wljs-docs/blog/tags/short"},{label:"javascript",permalink:"/wljs-docs/blog/tags/javascript"}],readingTime:.98,hasTruncateMarker:!0,authors:[{name:"Kirill Vasin",title:"Maintainer",url:"https://github.com/JerryI",imageURL:"https://avatars.githubusercontent.com/u/4111822?s=48&v=4",key:"jerryi"}],frontMatter:{title:"Speech to text using local WL neural network",authors:"jerryi",tags:["AI","short","javascript"],enableComments:!0},unlisted:!1,prevItem:{title:"Giant dweller worm",permalink:"/wljs-docs/blog/2024/10/24/worm"},nextItem:{title:"How to make simple counter animation for slides",permalink:"/wljs-docs/blog/2024/10/08/statcnt"}},i={authorsImageUrls:[void 0]},c=[];function d(e){const n={code:"code",p:"p",pre:"pre",...(0,a.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Speech2Text using built-in WL's neural network"}),"\n",(0,r.jsx)(n.p,{children:"Microphone capture function"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:".js\n\nconst label = document.createElement('div');\nlabel.classList.add('rounded', 'p-1', 'text-small');\nlabel.innerText = \"Not recording\";\nlabel.style.background = 'lightgray';\n\ncore.GetVoice = async (args, env) => {\nconst interval = await interpretate(args[0], env);\nconst promise = new Deferred();\n  \nnavigator.mediaDevices.getUserMedia({ audio: true })\n  .then(stream => {\n    const mediaRecorder = new MediaRecorder(stream);\n    let chunks = [];\n\n    mediaRecorder.ondataavailable = event => {\n      chunks.push(event.data);\n    };\n\n    mediaRecorder.onstop = () => {\n      const audioBlob = new Blob(chunks, { 'type' : 'audio/ogg; codecs=opus' });\n      const reader = new FileReader();\n\n      reader.onloadend = () => {\n        label.style.background = 'lightgray';\n        label.innerText = \"Finished\";\n        const base64data = reader.result.split(',')[1];\n        promise.resolve(base64data);\n      };\n\n      reader.readAsDataURL(audioBlob);\n    };\n\n    mediaRecorder.start();\n    label.innerText = \"Recording...\";\n    label.style.background = 'green';\n\n    setTimeout(() => {\n      mediaRecorder.stop();\n    }, interval);\n  })\n  .catch(error => {\n    console.error('Error accessing microphone:', error);\n    label.innerText = \"Error accessing microphone\";\n    label.style.background = 'red';\n  });\n\n\n  return promise.promise;\n};\n\nreturn label;\n\n"})}),"\n",(0,r.jsx)(n.p,{children:"Widget"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mathematica",children:'Module[{text = " ", win = CurrentWindow[], status = " "}, Panel[Column[{\n  {EventHandler[InputButton["Speak"], Function[Null,\n    status = "Listerning...";\n    Then[FrontFetchAsync[GetVoice[3000], "Window"->win], Function[str,\n      status = "Processing...";\n      text = StringJoin[text, "\\n", SpeechRecognize[ImportString[str, "Base64"], Method->"NeuralNetwork"]];\n      status = " ";\n    ]]\n  ]], TextView[status // Offload]} // Row,\n\n  HTMLView[text // Offload, "Style"->"width:500px"]\n}], Style["Click and speak", 10]]]\n'})})]})}function u(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},4552:(e,n,t)=>{t.d(n,{I:()=>l,M:()=>s});var r=t(11504);const a={},o=r.createContext(a);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);