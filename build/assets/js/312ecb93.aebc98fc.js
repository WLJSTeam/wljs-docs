"use strict";(self.webpackChunkwljs_docs=self.webpackChunkwljs_docs||[]).push([[5801],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=d(n),u=r,h=p["".concat(l,".").concat(u)]||p[u]||m[u]||o;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6902:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(7294),r=n(412);const o=["https://cdn.jsdelivr.net/gh/JerryI/wljs-interpreter@latest/src/interpreter.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-interpreter@latest/src/core.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-cells@master/dist/kernel.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-editor@master/dist/kernel.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-editor@master/src/boxes.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-markdown-support@master/dist/kernel.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-js-support@master/dist/kernel.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-html-support@master/dist/kernel.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-inputs@master/dist/kernel.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-graphics-d3@latest/dist/kernel.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-plotly@latest/dist/kernel.js","https://cdn.jsdelivr.net/gh/JerryI/wljs-hydrator@latest/src/kernel.js"];function i(e){return new Promise(((t,n)=>{if(r.Z.canUseDOM){var a=document.createElement("script");a.src=e,a.type="module",a.onload=()=>{t()},a.onerror=()=>{n("cannot load script "+e)},document.head.appendChild(a)}}))}const s=new Event("load-wljs");function l(){return(0,a.useEffect)((async()=>{if(r.Z.canUseDOM){if(window.loadedNotebooks={},window.LoadedWLJS)return;for(const e of o)await i(e);window.LoadedWLJS=!0,window.dispatchEvent(s)}}),[]),a.createElement("div",{id:"helmet"})}},1365:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(7294),r=n(3778),o=n(412);function i(e){let{children:t,code:n,name:i,width:s,height:l}=e;return(0,a.useEffect)((()=>{if(o.Z.canUseDOM){const e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),t=async()=>{if(window.LoadedWLJSForSure=!0,e in window.eventAttr)return;window.eventAttr[e]=!0;const t=r.iF(r.TD(atob(n),!0)),a=r.T8(t),o=JSON.parse(a);console.warn(i);for(const e of o[0]){const t=new ObjectStorage(e[0]);t.cache=e[1],t.cached=!0}if(o.length>2){console.warn("symbols restore"),console.log(o);for(const e of o[2])console.log(e)}for(const e of o[1]){const t={local:{},global:{}};console.log(e),await interpretate(e,t)}};return window.LoadedWLJSForSure?t():window.addEventListener("load-wljs",t),()=>{Object.values(window.CellHashStorage).forEach((e=>{console.log(e),"input"===e?.type&&e.dispose()}))}}}),[]),a.createElement("main",{id:"frontend-editor",className:"main-container styles-container-editor"},a.createElement("div",{id:"frontend-editor-content",className:"group-container"},a.createElement("div",{id:i})))}o.Z.canUseDOM&&(window.eventAttr={},window.OfflineMode=!0)},7862:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>p});var a=n(7462),r=(n(7294),n(3905)),o=n(6902),i=n(1365);const s={slug:"balls-example",title:"Interactive graphics example",authors:"jerryi",tags:["frontend","dynamics"],enableComments:!0},l=void 0,d={permalink:"/wljs-docs/blog/balls-example",source:"@site/blog/2023-07-13-balls/index.md",title:"Interactive graphics example",description:"Here we will try to recreate a simple example of the interactive plot, where bouncing dots are created using mouse clicks on an empty canvas.",date:"2023-07-13T00:00:00.000Z",formattedDate:"July 13, 2023",tags:[{label:"frontend",permalink:"/wljs-docs/blog/tags/frontend"},{label:"dynamics",permalink:"/wljs-docs/blog/tags/dynamics"}],readingTime:2.255,hasTruncateMarker:!0,authors:[{name:"Kirill Vasin",title:"Maintainer",url:"https://github.com/JerryI",imageURL:"https://avatars.githubusercontent.com/u/4111822?s=48&v=4",key:"jerryi"}],frontMatter:{slug:"balls-example",title:"Interactive graphics example",authors:"jerryi",tags:["frontend","dynamics"],enableComments:!0},prevItem:{title:"Interactive curves fitting example",permalink:"/wljs-docs/blog/curvesfit-example"},nextItem:{title:"Introducing Events shortcuts",permalink:"/wljs-docs/blog/event-shortcuts"}},c={authorsImageUrls:[void 0]},p=[{value:"Mathematica&#39;s version",id:"mathematicas-version",level:2},{value:"WLJS Frontend version",id:"wljs-frontend-version",level:2}],m={toc:p},u="wrapper";function h(e){let{components:t,...s}=e;return(0,r.kt)(u,(0,a.Z)({},m,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(o.Z,{mdxType:"Component"}),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(9171).Z,width:"586",height:"351"})),(0,r.kt)("p",null,"Here we will try to recreate a simple example of the interactive plot, where bouncing dots are created using mouse clicks on an empty canvas."),(0,r.kt)("h2",{id:"mathematicas-version"},"Mathematica's version"),(0,r.kt)("p",null,"Originally it was designed for Wolfram Mathematica by Wolfram Research group. Let us have a look at the original core first"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},'Framed@DynamicModule[{points = {}, vel = {}}, \n  EventHandler[\n  \n   Graphics[{PointSize[0.1], \n       Point[Dynamic[{vel, points} = animate[vel, points]; points]]}\n    , PlotRange -> {{-1, 1}, {-1, 1}}], \n   \n   "MouseDown" :> ({points, vel} = \n      addPoint[MousePosition["Graphics"], points, vel])\n  ]\n]\n')),(0,r.kt)("p",null,"It uses ",(0,r.kt)("inlineCode",{parentName:"p"},"DynamicModule")," to localize dynamic variables and a set of two functions ",(0,r.kt)("inlineCode",{parentName:"p"},"animate")," to recalculate new positions and ",(0,r.kt)("inlineCode",{parentName:"p"},"addPoint"),"."),(0,r.kt)("p",null,(0,r.kt)("a",{target:"_blank",href:n(1343).Z},"Download Notebook")),(0,r.kt)("h2",{id:"wljs-frontend-version"},"WLJS Frontend version"),(0,r.kt)("p",null,"To recreate this using WLJS Frontend we need to change the way how dynamics is processed. Firstly, we need an event-listener object to get the place where a user clicked"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},'Graphics[{\n    RGBColor[1,1,1],\n    EventHandler[Rectangle[{-10,10},{10,-10}], {"click"->addPoint}],\n    RGBColor[0,0,0], PointSize[0.1],\n    Point[points // Hold]\n}]\n')),(0,r.kt)("p",null,"Here it creates a white rectangle in the background to add event-listener for clicks. And a global variable ",(0,r.kt)("inlineCode",{parentName:"p"},"points")," is bounded to ",(0,r.kt)("inlineCode",{parentName:"p"},"Point")," expression using ",(0,r.kt)("inlineCode",{parentName:"p"},"Hold"),"."),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"EventHandler")," expression does not fully correspond to the one used in Wolfram Mathematica")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Dynamic binding is possible only using global variables.")),(0,r.kt)("p",null,"Then, we need an function, that adds dots to an array"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},"points = {{0,0}};\nvel = {RandomReal[{-1,1}]};\n\naddPoint[xy_] := (points = Append[points, xy]; vel = Append[vel, RandomReal[{-1,1},2]]);\n")),(0,r.kt)("p",null,"Now it should add new dots, when we click on a canvas"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(7217).Z,width:"557",height:"341"})),(0,r.kt)("p",null,"One thing is missing - animation. One need to update ",(0,r.kt)("inlineCode",{parentName:"p"},"points")," symbol with a new positions and etc. The corresponding function will be"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},"points = {{0,0}};\nvel = {RandomReal[{-1,1}]};\n\naddPoint[xy_] := (points = Append[points, xy]; vel = Append[vel, RandomReal[{-1,1},2]]);\n\nanimate[i_] := points = MapIndexed[(If[Max[#1//Abs] > 1.2, vel[[#2//First]] = - vel[[#2//First]]]; #1 + 0.1 vel[[#2//First]])&, points];\n")),(0,r.kt)("p",null,"Instead of using timers, one can assign the an event handler to the transition animation, which is provided by ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/JerryI/wljs-graphics-d3"},"wljs-graphics-d3")," library. "),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"IO operations between the frontend and a server cannot run at full speed giving 60FPS, therefore the data is interpolated using the time-constant provided by the option to the ",(0,r.kt)("inlineCode",{parentName:"p"},"Graphics")," expression called ",(0,r.kt)("inlineCode",{parentName:"p"},'"TransitionDuration"'),".")),(0,r.kt)("p",null,"To capture the transitions we need a ",(0,r.kt)("inlineCode",{parentName:"p"},"MiddlewareHandler")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},'Point[MiddlewareHandler[points//Hold, "end"->animate, "Threshold"->0.2]]\n')),(0,r.kt)("p",null,"It stands in between the drawing function and an updatable symbol. Threshold value specifies when the event ",(0,r.kt)("inlineCode",{parentName:"p"},"animate")," will be fired, i.e. ",(0,r.kt)("inlineCode",{parentName:"p"},"1")," means after the transition and anything less means, that it will be fired a bit early. It is used to compensate the latency of the network making the animation smoother. "),(0,r.kt)("p",null,"Here the full code"),(0,r.kt)(i.Z,{code:"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",name:"expo-4312f",mdxType:"Notebook"},"expo-4312f"),(0,r.kt)("p",null,"Links"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{target:"_blank",href:n(6641).Z},"Download Notebook"))),(0,r.kt)("p",null,"Thanks for reading! See you next time"))}h.isMDXComponent=!0},1343:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/Balls-ffc8f9f88b78ba0c961f0b5f620b0ba0.nb"},6641:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/Balls-1156acbbaeee794f0b527a589d981882.wl"},9171:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ezgif.com-video-to-gif-16-ef6c2f916fa117ab7387436f2ea1fce9.gif"},7217:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ezgif.com-video-to-gif-17-33ba6d88897d13c03d8661facbd19c73.gif"}}]);