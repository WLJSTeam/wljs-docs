"use strict";(self.webpackChunkwljs_docs=self.webpackChunkwljs_docs||[]).push([[3669],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,h=p["".concat(s,".").concat(m)]||p[m]||u[m]||i;return n?a.createElement(h,o(o({ref:t},d),{},{components:n})):a.createElement(h,o({ref:t},d))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3e3:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(7294);const r={crush:(e,t=50)=>{let n=[];const a="-_.!~*'()";for(let i=127;--i;)(i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122||a.includes(String.fromCharCode(i)))&&n.push(String.fromCharCode(i));for(let i=32;i<255;++i){let e=String.fromCharCode(i);"\\"==e||n.includes(e)||n.unshift(e)}e=e.replace(new RegExp("\x01","g"),"");const r=((e,n)=>{let a=n.length,r="";const i=e=>encodeURI(encodeURIComponent(e)).replace(/%../g,"i").length,o=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t>=56320&&t<=57343||n>=55296&&n<=56319};let l={};for(let s=2;s<t;s++)for(let t=0;t<e.length-s;++t){let n=e.substr(t,s);if(l[n])continue;if(o(n))continue;let a=1;for(let r=e.indexOf(n,t+s);r>=0;++a)r=e.indexOf(n,r+s);a>1&&(l[n]=a)}for(;;){for(;a--&&e.includes(n[a]););if(a<0)break;let t,o=n[a],s=0,c=i(o);for(let e in l){let n=l[e],a=(n-1)*i(e)-(n+1)*c;r.length||(a-=i("\x01")),a<=0?delete l[e]:a>s&&(t=e,s=a)}if(!t)break;e=e.split(t).join(o)+o+t,r=o+r;let d={};for(let n in l){let a=n.split(t).join(o),r=0;for(let t=e.indexOf(a);t>=0;++r)t=e.indexOf(a,t+a.length);r>1&&(d[a]=r)}l=d}return{a:e,b:r}})(e=i(e),n);let o=r.a;return r.b.length&&(o+="\x01"+r.b),o+="_",o},uncrush:e=>{const t=(e=e.substring(0,e.length-1)).split("\x01");let n=t[0];if(t.length>1){let e=t[1];for(let t of e){let e=n.split(t);n=e.join(e.pop())}}return i(n,0)}},i=(e,t=1)=>{const n=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],a=(e,t)=>{let n=new RegExp(`${(t[2]?t[2]:"")+t[0]}|${(t[3]?t[3]:"")+t[1]}`,"g");return e.replace(n,(e=>e===t[0]?t[1]:t[0]))};if(t)for(let r=0;r<n.length;++r)e=a(e,n[r]);else for(let r=n.length;r--;)e=a(e,n[r]);return e};function o(e){let{children:t,code:n,width:i,height:o}=e;(0,a.useRef)();const l=JSON.parse(r.uncrush(decodeURIComponent(n))),s=l.js,c=l.compiled,d=`<html>\n  <head>  \n\n    <script>             \n    function isElement(o){\n      return (\n        typeof HTMLElement === "object" ? o instanceof HTMLElement : //DOM2\n        o && typeof o === "object" && o !== null && o.nodeType === 1 && typeof o.nodeName==="string"\n    );\n    }\n    <\/script>\n \n  </head>\n  <body>\n    <div id="canvas"></div>\n\n    \n    <script type="module" src="https://cdn.jsdelivr.net/gh/JerryI/wljs-interpreter@main/dist/interpreter.js"><\/script>\n    <script type="module" src="https://cdn.jsdelivr.net/gh/JerryI/wljs-interpreter@main/dist/core.js"><\/script>\n\n    ${(l.includes||[]).map((e=>`<script type="module" src="${e}"><\/script>`)).join("")}\n    \n\n    <script type="module">\n    console.log('start');\n      let global = {};\n      let env = {global: global};\n\n\n        const $f = async () => {\n          ${s}\n        };\n\n        const r = await $f();\n\n        console.log('js');\n\n        if (isElement(r)) {\n          document.getElementById('canvas').appendChild(r);\n        } else {\n          console.log(r);\n        }\n        console.log('op');\n        await interpretate(${JSON.stringify(c)}, env);\n        console.log('ok');\n\n\n    <\/script>\n  </body>\n  </html>`;return a.createElement("iframe",{width:i||"100%",height:o||"auto",srcDoc:d})}},9192:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=n(7462),r=(n(7294),n(3905)),i=n(3e3);const o={sidebar_position:2},l="Symbols and expressions",s={unversionedId:"interpreter/Basics/scripts",id:"interpreter/Basics/scripts",title:"Symbols and expressions",description:"It is assumed, you have wljs-graphics-d3 (see Libraries @ syntax) library included in your page. Most examples depend on it.",source:"@site/docs/interpreter/Basics/scripts.md",sourceDirName:"interpreter/Basics",slug:"/interpreter/Basics/scripts",permalink:"/wljs-docs/docs/interpreter/Basics/scripts",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/interpreter/Basics/scripts.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"interpreterSidebar",previous:{title:"Syntax",permalink:"/wljs-docs/docs/interpreter/Basics/syntax"},next:{title:"Javascript integration",permalink:"/wljs-docs/docs/interpreter/Basics/js-access"}},c={},d=[{value:"Limitations",id:"limitations",level:2},{value:"Implicit data-binding",id:"implicit-data-binding",level:2},{value:"Containers and DOM structure",id:"containers-and-dom-structure",level:2}],p={toc:d},u="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"symbols-and-expressions"},"Symbols and expressions"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"It is assumed, you have ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/JerryI/wljs-graphics-d3"},"wljs-graphics-d3")," (see Libraries @ ",(0,r.kt)("a",{parentName:"p",href:"/wljs-docs/docs/interpreter/Basics/syntax#Libraries"},"syntax"),") library included in your page. Most examples depend on it.")),(0,r.kt)("h2",{id:"limitations"},"Limitations"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"no pattern matching possible"),(0,r.kt)("li",{parentName:"ul"},"no symbolic computations"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"UpValue"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"DownValue")," are not supported"),(0,r.kt)("li",{parentName:"ul"},"no WL function definition is possible (for now)"),(0,r.kt)("li",{parentName:"ul"},"most WL Kernel functions are not implemented")),(0,r.kt)("p",null,"Despite the fact of those limitations, WLJS intepreter together with graphics extensions can interpret results produced by Wolfram Engine / Mathematica and also is feasible for some simple standalone calculations. "),(0,r.kt)("p",null,"The biggest advantage compared to the original Wolfram Kernel is a native integration with Javascript ecosystem, since it is capable to read, write and execute Javascript functions and objects with no overhead complexity under the hood."),(0,r.kt)("h2",{id:"implicit-data-binding"},"Implicit data-binding"),(0,r.kt)("p",null,"By the default all defined symbols can be considered as ",(0,r.kt)("inlineCode",{parentName:"p"},"Dynamic")," in terms of Wolfram Mathematica. For example, when you define a variable"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},"a = 1;\n")),(0,r.kt)("p",null,"it extends the ",(0,r.kt)("a",{parentName:"p",href:"/wljs-docs/docs/interpreter/Advanced/architecture"},"default context")," ",(0,r.kt)("inlineCode",{parentName:"p"},"core")," with a corresponding symbol with a ",(0,r.kt)("inlineCode",{parentName:"p"},"virtual")," attribute. It means, if this one enters the any other expressions that support updates"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},'(* to be able to manipulate DOM elements, we need container *)\nFrontEndVirtual[{\n    (* attach a dom element to draw by ID *)\n    AttachDOM["canvas"],\n    (* our graphics *)\n    Graphics[{PointSize[0.1], RGBColor[{1.,1.,0}],  Point[{a,0}]}]\n}]; \n')),(0,r.kt)("p",null,"It creates a special object called ",(0,r.kt)("a",{parentName:"p",href:"/wljs-docs/docs/frontend/front-end-functions"},"Virtual Container"),", that has its identity, local memory and can be connected to a chain to other functions. More about it you can read in the ",(0,r.kt)("a",{parentName:"p",href:"/wljs-docs/docs/interpreter/Advanced/containers"},"Advanced guide"),". As well as all functions, which use DOM elements to draw need to be executed inside ",(0,r.kt)("inlineCode",{parentName:"p"},"FrontEndVirtual"),". "),(0,r.kt)("p",null,"Then if one change the variable later"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},"a = -1;\n")),(0,r.kt)("p",null,"it will trigger the cascade of update in all expressions, where it is used. "),(0,r.kt)(i.Z,{code:"('wls!'%241%3BK%7B*_be%20able_animate%20we%20need%20a%20container%23Kf%5B(K%5Ct%7B*%20attach%20a%20dom%20element_draw%236QAttachDOM%5B%5C'canvas%5C'Z6Q%7B*%20our%20gY%236QGY%5B(PointSize%5B0.1Z%20RGBColor%5B(1.%2C1.%2C0)ZQPoint%5B(a%2C0)%5D)%2C%20ImageSize-%3E(500%2C100)%5DK)%5D%3B%20KKWhile%5BTrue%2C8-1%3B81%3BK%5D%3BK'~js!''~includes!%5B'https%3A%2F%2Fcdn.jsdelivr.net%2Fgh%2FJerryI%2Fwljs-gY-d3%40latest%2Fdist%2Fkernel.js'%5D~compiled!%5B'Hold'XSet'~a71NfU'4AttachDOM'~%22canvas%22'NGYU'4PointSize70.1NRGBColorU71%2C1%2C094PointU'~a709NRule'~ImageSizeU7500%2C10099NWhile7trueXq-1Nq1Znull9%2Cnull9)4%2C%5B'6KQ7'%2C86Pause%5B2%5D%3B6%249%5D%5DK%5CnN%5D4Q%20%20U'4ListX4CompoundExpression'4YraphicsZ%5D%2C_%20to%20fFrontEndVirtualqPause72NSet'~a7%23%20*%7D%24a%20%3D%20%01%24%23qf_ZYXUQNK98764_",mdxType:"Sandbox"},"Ball movement"),(0,r.kt)("h2",{id:"containers-and-dom-structure"},"Containers and DOM structure"),(0,r.kt)("p",null,"Manipulation with DOM is better to do using pure JS functions, however if one needs only to attach a specific graphical element generated by Wolfram Language a procedure ",(0,r.kt)("inlineCode",{parentName:"p"},'AttachDOM["element-id"]')," is provided."),(0,r.kt)("p",null,"Since ",(0,r.kt)("inlineCode",{parentName:"p"},"Graphics")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"Graphics3D")," has its own local scope to store event handlers, which are necessary to manipulate with plots, you need to execute them inside so-called container (virtual container)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},"FrontEndVirtual[{\n    ...\n}]\n")),(0,r.kt)("p",null,"For each call of ",(0,r.kt)("inlineCode",{parentName:"p"},"FrontEndVirtual")," a local memory and id is created, therefore ",(0,r.kt)("inlineCode",{parentName:"p"},"Graphics")," can use it to store its data and have an access to DOM elements attached by ",(0,r.kt)("inlineCode",{parentName:"p"},"AttachDOM"),". "),(0,r.kt)("p",null,"For example one can create an HTML structure "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<div id="left"  style="display:inline-block"></div>\n<div id="right" style="display:inline-block"></div>\n')),(0,r.kt)("p",null,"and attach different graphics elements to is "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-mathematica"},'a = 1;\n\nFrontEndVirtual[{\n    (* attach a dom element to draw *)\n    AttachDOM["left"],\n    (* our graphics *)\n    Graphics[{PointSize[0.1], RGBColor[{1.,1.,0}],  Point[{a,0}]}, ImageSize->{200,100}]\n}]; \n\nFrontEndVirtual[{\n    (* attach a dom element to draw *)\n    AttachDOM["right"],  \n    (* our graphics *)\n    Graphics[{PointSize[0.1], RGBColor[{1.,0.,1.}],  Point[{-a,0}]}, ImageSize->{200,100}]\n}]; \n')),(0,r.kt)("p",null,"Both plots will be updated independently"),(0,r.kt)(i.Z,{code:"('wls!'a61%3B9b%3D-1%3B%209%7B*%20to%20be%20able%20to%20animate%20we%20need%20a%20container%20*%7D9%267%60left%5C'q58%2B1.%2C0%7FaQ%267%60right%5C'q%2558%2B0.%2C1.%7FbQWhile%5BTrue%2CXa6-1%3BXb61%3B5a61%3BX5a61%3BXb6-1%3B9%5D%3B9'~js!'const%20el1Y1.id6%5C'left%5C'%3B9el1_const%20el2Y2.id6%5C'right%5C'%3B9el2_%241%7D%3B9%242%7D%3B9'~includes!%5B'https%3A%2F%2Fcdn.jsdelivr.net%2Fgh%2FJerryI%2Fwljs-g%7C-d3%40latest%2Fdist%2Fkernel.js'%5D~compiled!%5B'Hold'%3CSet'~aKb'%2C-1%5D4%23lefZolorU%2C1%2C1%2C0%5E4PointU~aN%23righZolorU%2C1%2C0%2C1%5E4PointU~bNWhile'%2Ctrue%3CPauseKa'%2C-%3FbKa'%2C%3Fa'%2C%3Fb'%2C-1qnull%5Dqnull%5E)4%2C%5B'59%256%20%3D%207ual%5B(9%5Ct%7B*%20attach%20a%20dom%20element%20to%20draw%20*%7D5%258%25%7B*%20our%20g%7C%20*%7D5%25G%7C%5B(PointSize%5B0.19%5CnK'%2C1%5D4Set'~N'%2C0%5E%5D4Rule'~ImageSizeU%2C200%2C100%5E%5E%5D4Q%2C0)%5D)%2C%20ImageSize-%3E(200%2C100)%5D9)%5D%3B%2099U'4List'X5Pause%5B1%5D%3B5Y6document.createElement%7B%22div%22%7D%3B9elZt%22'%5D4G%7CU4PointSize'%2C0.1%5D4RGBC_.style.display6%5C'inline-block%5C'%3B99q%5D%2C%23%26ualU4AttachDOM'~%22%24document.body.append%7Bel%25%20%20%26FrontEndVirt%2Bq%20RGBColor%5B(1.%2C%3C4CompoundExpression'4%3F1%5D4PauseK%5E%5D%5D%60AttachDOM%5B%5C'%7Craphics%7F)q%25Point%5B(%01%7F%7C%60%5E%3F%3C%2B%26%25%24%23q_ZYXUQNK987654_",mdxType:"Sandbox"},"Two divs"))}m.isMDXComponent=!0}}]);