<!DOCTYPE html> <html class="h-full" os="Browser"><head ><meta charset="UTF-8"/><meta serializer="hsfn-4"/><script id="json-objects" type="application/json">{"storage":[
	"Association",
	["Rule","'44f319c3-084b-4355-bf29-f7afde4f7de0'",["Hold",["Graphics",["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.922526,0.385626,0.209179]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.2735096798074832,2.626999531662566e-2],["List",9.759995386115178e-2,9.577418320423858e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.2735096798074832,2.626999531662566e-2],["List",0.11498620157193032,0.11283519202249344]]],["List"]]]],["List",["List",["List",0.17590972594633142,0.371109633668635],["List",-6.950418788761292e-2,0.12204417852086424]],["List",0.2735096798074832,2.626999531662566e-2,0.984099323035079],["List"]],"'BubbleChartBubble'"],0.984099323035079],["Style",0.984099323035079,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.528488,0.470624,0.701351]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.5184714623790537,3.492654770491234e-2],["List",9.5686130400643e-2,9.389616101799762e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.5184714623790537,3.492654770491234e-2],["List",0.11307237811142154,0.11095716983625248]]],["List"]]]],["List",["List",["List",0.42278533197841073,0.6141575927796967],["List",-5.8969613313085284e-2,0.12882270872290996]],["List",0.5184714623790538,3.4926547704912325e-2,0.9431120134258875],["List"]],"'BubbleChartBubble'"],0.9431120134258875],["Style",0.9431120134258875,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.968878568987794,0.846624629978438],["List",9.48711199913651e-2,9.309639674390191e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.968878568987794,0.846624629978438],["List",0.11225736770214365,0.11015740556215677]]],["List"]]]],["List",["List",["List",0.8740074489964289,1.0637496889791591],["List",0.7535282332345361,0.9397210267223399]],["List",0.9688785689877941,0.8466246299784379,0.9259220639770542],["List"]],"'BubbleChartBubble'"],0.9259220639770542],["Style",0.9259220639770542,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.560181,0.691569,0.194885]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.29773331474631015,0.7185310257568733],["List",9.46087020858052e-2,9.283888780492311e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.29773331474631015,0.7185310257568733],["List",0.11199494979658374,0.10989989662317796]]],["List"]]]],["List",["List",["List",0.20312461266050494,0.39234201683211534],["List",0.6256921379519502,0.8113699135617964]],["List",0.29773331474631015,0.7185310257568733,0.9204208746189224],["List"]],"'BubbleChartBubble'"],0.9204208746189224],["Style",0.9204208746189224,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.528488,0.470624,0.701351]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.821517408648017,0.8985967860663973],["List",9.447562520085362e-2,9.270830034606292e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.821517408648017,0.8985967860663973],["List",0.11186187291163216,0.10976930916431778]]],["List"]]]],["List",["List",["List",0.7270417834471634,0.9159930338488707],["List",0.8058884857203343,0.9913050864124602]],["List",0.821517408648017,0.8985967860663973,0.9176373852646891],["List"]],"'BubbleChartBubble'"],0.9176373852646891],["Style",0.9176373852646891,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.560181,0.691569,0.194885]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.47101767633623565,0.17984246899987366],["List",9.22667771907057e-2,9.054077253867082e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.47101767633623565,0.17984246899987366],["List",0.10965302490148424,0.10760178135692568]]],["List"]]]],["List",["List",["List",0.37875089914552995,0.5632844535269413],["List",8.930169646120283e-2,0.2703832415385445]],["List",0.4710176763362357,0.17984246899987366,0.8720518722790169],["List"]],"'BubbleChartBubble'"],0.8720518722790169],["Style",0.8720518722790169,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.368417,0.506779,0.709798]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.6237734673178149,0.48435178348398655],["List",9.172193257246708e-2,9.00061201518545e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.6237734673178149,0.48435178348398655],["List",0.10910818028324562,0.10706712897010935]]],["List"]]]],["List",["List",["List",0.5320515347453478,0.715495399890282],["List",0.39434566333213206,0.574357903635841]],["List",0.623773467317815,0.48435178348398655,0.8609860951989425],["List"]],"'BubbleChartBubble'"],0.8609860951989425],["Style",0.8609860951989425,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.368417,0.506779,0.709798]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.5427438328937013,0.18721740678624754],["List",8.833474279628162e-2,8.668229343536427e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.5427438328937013,0.18721740678624754],["List",0.10572099050706016,0.10374330225361912]]],["List"]]]],["List",["List",["List",0.4544090900974197,0.6310785756899829],["List",0.10053511335088328,0.2738997002216118]],["List",0.5427438328937013,0.18721740678624754,0.7937774226123602],["List"]],"'BubbleChartBubble'"],0.7937774226123602],["Style",0.7937774226123602,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.922526,0.385626,0.209179]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.9897977279724184,0.7415571360001945],["List",8.831975748715082e-2,8.666758845154732e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.9897977279724184,0.7415571360001945],["List",0.10570600519792936,0.10372859726980217]]],["List"]]]],["List",["List",["List",0.9014779704852676,1.0781174854595692],["List",0.6548895475486471,0.8282247244517418]],["List",0.9897977279724184,0.7415571360001945,0.7934861513381082],["List"]],"'BubbleChartBubble'"],0.7934861513381082],["Style",0.7934861513381082,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.560181,0.691569,0.194885]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.881699891042275,0.21903532298162287],["List",8.777829584255503e-2,8.613625575418393e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.881699891042275,0.21903532298162287],["List",0.10516454355333357,0.10319726457243879]]],["List"]]]],["List",["List",["List",0.7939215951997199,0.96947818688483],["List",0.13289906722743894,0.3051715787358068]],["List",0.8816998910422751,0.21903532298162287,0.7829975527618105],["List"]],"'BubbleChartBubble'"],0.7829975527618105],["Style",0.7829975527618105,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.15758202316903389,0.9840118273590114],["List",8.54836882458998e-2,8.388457263703264e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.15758202316903389,0.9840118273590114],["List",0.10286993595667834,0.1009455814552875]]],["List"]]]],["List",["List",["List",7.209833492313408e-2,0.2430657114149337],["List",0.9001272547219787,1.067896399996044]],["List",0.1575820231690339,0.9840118273590115,0.7393234216703004],["List"]],"'BubbleChartBubble'"],0.7393234216703004],["Style",0.7393234216703004,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.922526,0.385626,0.209179]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.40324747154449114,0.32384342022028734],["List",8.474927825455525e-2,8.316390101501409e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.40324747154449114,0.32384342022028734],["List",0.10213552596533379,0.10022490983326894]]],["List"]]]],["List",["List",["List",0.3184981932899359,0.4879967497990464],["List",0.24067951920527325,0.4070073212353014]],["List",0.40324747154449114,0.32384342022028734,0.7256098630013548],["List"]],"'BubbleChartBubble'"],0.7256098630013548],["Style",0.7256098630013548,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.922526,0.385626,0.209179]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.7154975450080905,3.31894090936371e-2],["List",7.630302948310197e-2,7.487565347776062e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.7154975450080905,3.31894090936371e-2],["List",9.368927719388051e-2,9.193666229601548e-2]]],["List"]]]],["List",["List",["List",0.6391945155249885,0.7918005744911925],["List",-4.1686244384123515e-2,0.10806506257139772]],["List",0.7154975450080905,3.31894090936371e-2,0.5771222878078999],["List"]],"'BubbleChartBubble'"],0.5771222878078999],["Style",0.5771222878078999,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.528488,0.470624,0.701351]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.8252429332879574,0.965925759398165],["List",7.602520609370766e-2,7.460302724033296e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.8252429332879574,0.965925759398165],["List",9.34114538044862e-2,9.166403605858782e-2]]],["List"]]]],["List",["List",["List",0.7492177271942497,0.9012681393816651],["List",0.8913227321578321,1.040528786638498]],["List",0.8252429332879574,0.9659257593981652,0.5725265212456743],["List"]],"'BubbleChartBubble'"],0.5725265212456743],["Style",0.5725265212456743,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.368417,0.506779,0.709798]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.8971156393875342,0.33649899063818767],["List",7.36069432686518e-2,7.223000207300156e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.8971156393875342,0.33649899063818767],["List",9.099319097943034e-2,8.929101089125642e-2]]],["List"]]]],["List",["List",["List",0.8235086961188824,0.970722582656186],["List",0.2642689885651861,0.40872899271118923]],["List",0.8971156393875344,0.33649899063818767,0.5332994419299253],["List"]],"'BubbleChartBubble'"],0.5332994419299253],["Style",0.5332994419299253,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.922526,0.385626,0.209179]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.28997465238475373,0.9379158502576428],["List",7.253349582842972e-2,7.117663526561335e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.28997465238475373,0.9379158502576428],["List",8.991974353920826e-2,8.823764408386821e-2]]],["List"]]]],["List",["List",["List",0.217441156556324,0.36250814821318345],["List",0.8667392149920294,1.0090924855232561]],["List",0.28997465238475373,0.9379158502576428,0.5163329274114006],["List"]],"'BubbleChartBubble'"],0.5163329274114006],["Style",0.5163329274114006,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.560181,0.691569,0.194885]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.4399685949686678,0.5688332135276286],["List",7.125946253807713e-2,6.992643490248507e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.4399685949686678,0.5688332135276286],["List",8.864571024885567e-2,8.698744372073992e-2]]],["List"]]]],["List",["List",["List",0.36870913243059067,0.5112280575067449],["List",0.49890677862514354,0.6387596484301137]],["List",0.4399685949686678,0.5688332135276286,0.4965519594106149],["List"]],"'BubbleChartBubble'"],0.4965519594106149],["Style",0.4965519594106149,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.560181,0.691569,0.194885]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.14857062276144514,0.49567482970139987],["List",7.030941326588358e-2,6.899415789364993e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.14857062276144514,0.49567482970139987],["List",8.769566097666212e-2,8.605516671190479e-2]]],["List"]]]],["List",["List",["List",7.826120949556156e-2,0.21888003602732872],["List",0.42668067180774993,0.5646689875950498]],["List",0.14857062276144517,0.49567482970139976,0.48205271798135296],["List"]],"'BubbleChartBubble'"],0.48205271798135296],["Style",0.48205271798135296,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.368417,0.506779,0.709798]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.8360443233963318,0.6864659830652271],["List",6.984724306226042e-2,6.85406333580102e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.8360443233963318,0.6864659830652271],["List",8.723349077303896e-2,8.560164217626505e-2]]],["List"]]]],["List",["List",["List",0.7661970803340714,0.9058915664585923],["List",0.6179253497072169,0.7550066164232373]],["List",0.836044323396332,0.6864659830652271,0.4750769524434346],["List"]],"'BubbleChartBubble'"],0.4750769524434346],["Style",0.4750769524434346,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.560181,0.691569,0.194885]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.3523479061381487,0.7233580631554091],["List",6.663743868494187e-2,6.539087374930774e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.3523479061381487,0.7233580631554091],["List",8.402368639572041e-2,8.24518825675626e-2]]],["List"]]]],["List",["List",["List",0.28571046745320683,0.4189853448230906],["List",0.6579671894061013,0.7887489369047168]],["List",0.3523479061381487,0.7233580631554091,0.42803246754454083],["List"]],"'BubbleChartBubble'"],0.42803246754454083],["Style",0.42803246754454083,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.9781791900479928,0.9046260087806077],["List",6.065036911535193e-2,5.951580234681342e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.9781791900479928,0.9046260087806077],["List",7.803661682613047e-2,7.657681116506827e-2]]],["List"]]]],["List",["List",["List",0.9175288209326409,1.0388295591633447],["List",0.8451102064337943,0.9641418111274211]],["List",0.978179190047993,0.9046260087806077,0.3468359949133957],["List"]],"'BubbleChartBubble'"],0.3468359949133957],["Style",0.3468359949133957,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.922526,0.385626,0.209179]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",1.3798189360900714e-2,0.808346171390167],["List",5.808727421577384e-2,5.7000654431566655e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",1.3798189360900714e-2,0.808346171390167],["List",7.547352192655238e-2,7.406166324982151e-2]]],["List"]]]],["List",["List",["List",-4.428908485487312e-2,7.188546357667455e-2],["List",0.7513455169586003,0.8653468258217336]],["List",1.3798189360900714e-2,0.808346171390167,0.3146834711046247],["List"]],"'BubbleChartBubble'"],0.3146834711046247],["Style",0.3146834711046247,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.368417,0.506779,0.709798]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",9.112636319693566e-2,0.831160722881408],["List",5.6185262963270685e-2,5.513422348619035e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",9.112636319693566e-2,0.831160722881408],["List",7.357151067404923e-2,7.21952323044452e-2]]],["List"]]]],["List",["List",["List",3.494110023366498e-2,0.14731162616020635],["List",0.7760264993952176,0.8862949463675983]],["List",9.112636319693568e-2,0.831160722881408,0.2918345716866164],["List"]],"'BubbleChartBubble'"],0.2918345716866164],["Style",0.2918345716866164,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.3570150263778529,0.4130934643572062],["List",5.293167506057417e-2,5.1941499396307544e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.3570150263778529,0.4130934643572062],["List",7.031792277135271e-2,6.90025082145624e-2]]],["List"]]]],["List",["List",["List",0.3040833513172787,0.40994670143842704],["List",0.36115196496089863,0.4650349637535137]],["List",0.3570150263778529,0.4130934643572062,0.2547454581905413],["List"]],"'BubbleChartBubble'"],0.2547454581905413],["Style",0.2547454581905413,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.6374564822786852,0.3187527822844449],["List",5.2798394842262786e-2,5.1810712407778625e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.6374564822786852,0.3187527822844449],["List",7.018464255304133e-2,6.887172122603348e-2]]],["List"]]]],["List",["List",["List",0.5846580874364224,0.690254877120948],["List",0.2669420698766663,0.37056349469222355]],["List",0.6374564822786852,0.3187527822844449,0.2532798585575211],["List"]],"'BubbleChartBubble'"],0.2532798585575211],["Style",0.2532798585575211,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.528488,0.470624,0.701351]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.3059654850538749,0.5068277102724694],["List",5.017945842084126e-2,4.924076757991222e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.3059654850538749,0.5068277102724694],["List",6.75657061316198e-2,6.630177639816708e-2]]],["List"]]]],["List",["List",["List",0.2557860266330336,0.35614494347471615],["List",0.45758694269255723,0.5560684778523817]],["List",0.3059654850538749,0.5068277102724694,0.2253388568639223],["List"]],"'BubbleChartBubble'"],0.2253388568639223],["Style",0.2253388568639223,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.528488,0.470624,0.701351]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.18726548583412092,0.4156021549816382],["List",4.767224272378198e-2,4.678045355308069e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.18726548583412092,0.4156021549816382],["List",6.505849043456052e-2,6.384146237133555e-2]]],["List"]]]],["List",["List",["List",0.13959324311033894,0.2349377285579029],["List",0.3688217014285575,0.4623826085347189]],["List",0.18726548583412095,0.4156021549816382,0.20011935057155594],["List"]],"'BubbleChartBubble'"],0.20011935057155594],["Style",0.20011935057155594,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.39879653455670394,0.4240854064086603],["List",4.478193653169793e-2,4.394421538076748e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.39879653455670394,0.4240854064086603],["List",6.216818424247647e-2,6.100522419902234e-2]]],["List"]]]],["List",["List",["List",0.354014598025006,0.44357847108840187],["List",0.38014119102789284,0.4680296217894278]],["List",0.39879653455670394,0.4240854064086603,0.1729030454806304],["List"]],"'BubbleChartBubble'"],0.1729030454806304],["Style",0.1729030454806304,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.368417,0.506779,0.709798]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.5248164338170013,0.8062046912204763],["List",4.3618393208243345e-2,4.2802438084590166e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.5248164338170013,0.8062046912204763],["List",6.1004640919021885e-2,5.986344690284502e-2]]],["List"]]]],["List",["List",["List",0.4811980406087579,0.5684348270252446],["List",0.7634022531358862,0.8490071293050665]],["List",0.5248164338170014,0.8062046912204763,0.1625079974129151],["List"]],"'BubbleChartBubble'"],0.1625079974129151],["Style",0.1625079974129151,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.29351112996427653,0.560062513043109],["List",4.306768354483226e-2,4.2262030368097836e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.29351112996427653,0.560062513043109],["List",6.04539312556108e-2,5.932303918635269e-2]]],["List"]]]],["List",["List",["List",0.25044344641944427,0.3365788135091088],["List",0.5178004826750111,0.6023245434112068]],["List",0.29351112996427653,0.560062513043109,0.15770033242078552],["List"]],"'BubbleChartBubble'"],0.15770033242078552],["Style",0.15770033242078552,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.368417,0.506779,0.709798]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.9393476709138783,0.5192541789458194],["List",3.792090733938236e-2,3.721153323453119e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.9393476709138783,0.5192541789458194],["List",5.53071550501609e-2,5.4272542052786046e-2]]],["List"]]]],["List",["List",["List",0.9014267635744959,0.9772685782532606],["List",0.4820426457112882,0.5564657121803506]],["List",0.9393476709138784,0.5192541789458194,0.1162590829516581],["List"]],"'BubbleChartBubble'"],0.1162590829516581],["Style",0.1162590829516581,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.560181,0.691569,0.194885]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.3863964009048657,0.1717614704349011],["List",3.6452500136951616e-2,3.577059504900609e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.3863964009048657,0.1717614704349011],["List",5.3838747847730156e-2,5.283160386726095e-2]]],["List"]]]],["List",["List",["List",0.3499439007679141,0.4228489010418173],["List",0.135990875385895,0.20753206548390718]],["List",0.3863964009048657,0.1717614704349011,0.10559167825377513],["List"]],"'BubbleChartBubble'"],0.10559167825377513],["Style",0.10559167825377513,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.922526,0.385626,0.209179]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.47463011678605005,0.7064978634467103],["List",3.1387796182164474e-2,3.0800634867149013e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.47463011678605005,0.7064978634467103],["List",4.8774043892943014e-2,4.786164368540387e-2]]],["List"]]]],["List",["List",["List",0.4432423206038856,0.5060179129682145],["List",0.6756972285795613,0.7372984983138593]],["List",0.47463011678605005,0.7064978634467103,7.27364307185474e-2],["List"]],"'BubbleChartBubble'"],7.27364307185474e-2],["Style",7.27364307185474e-2,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.528488,0.470624,0.701351]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.5982381095029361,0.6003955109095425],["List",2.273804968142379e-2,2.2312696366576512e-2]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.5982381095029361,0.6003955109095425],["List",4.012429739220233e-2,3.937370518483137e-2]]],["List"]]]],["List",["List",["List",0.5755000598215123,0.6209761591843599],["List",0.578082814542966,0.622708207276119]],["List",0.5982381095029361,0.6003955109095425,3.0742436768540493e-2],["List"]],"'BubbleChartBubble'"],3.0742436768540493e-2],["Style",3.0742436768540493e-2,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.528488,0.470624,0.701351]],["Tooltip",["StatusArea",["Annotation",["Dynamic",["List",["Disk",["List",0.3345856902428084,0.7482081010394064],["List",9.759995386115161e-3,9.577418320423803e-3]],["If",["CurrentValue","'MouseOver'"],["List",["Thickness",1.0e-2],["Circle",["List",0.3345856902428084,0.7482081010394064],["List",2.71462430968937e-2,2.6638427138678655e-2]]],["List"]]]],["List",["List",["List",0.3248256948566932,0.34434568562892354],["List",0.7386306827189826,0.7577855193598302]],["List",0.3345856902428084,0.7482081010394064,1.1394120158920718e-3],["List"]],"'BubbleChartBubble'"],1.1394120158920718e-3],["Style",1.1394120158920718e-3,["List"]]]]]],["List",["List",["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"]]],["List",["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"]]],["List",["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"]]],["List",["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"]]],["List",["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"]]]],["List"],["List"]],["List",["Rule","AspectRatio",1],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",-6.26273900569366e-2,-6.950418788761292e-2]],["Rule","Frame",true],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List",-6.26273900569366e-2,1.0964557906616328],["List",-6.950418788761292e-2,1.067896399996044]]],["Rule","PlotRangeClipping",true],["Rule","PlotRangePadding",["List",["List",["Scaled",5.0e-2],["Scaled",5.0e-2]],["List",["Scaled",5.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","Automatic","Automatic"]]]]]],
	["Rule","'f79760d0-3fd5-41d4-8bef-5cd40ce1f85e'",["Hold",["Graphics",["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",0.93024938332567,0.357855589202835],["List",0.9163987953483064,0.36100066647444645],["List",0.9265765043279137,0.3654089576994085],["List",0.9017590434574015,0.36551749547599327],["List",0.9251537521021771,0.3724910442738491],["List",0.9213184424478845,0.37550168576020204],["List",0.9228242414017717,0.3794924304495532],["List",0.9236793738680195,0.38379223402360474],["List",0.918860916331229,0.38593147689934626],["List",0.9238933803104258,0.39185310018107594],["List",0.909744394970943,0.38898944140896097],["List",0.9108619947814782,0.39303861208917273],["List",0.9119626892314282,0.3972571582398447],["List",0.9121630803582155,0.4014550634975187],["List",0.912533942723434,0.40570587620295423],["List",0.9061634053223875,0.4050186477595475],["List",0.9121589406761875,0.4146352702034828],["List",0.893446467000174,0.40113690174967015],["List",0.9057833890597393,0.4178992681197861],["List",0.9000605123157595,0.41619527643265997],["List",0.902546981514378,0.42431494487131344],["List",0.9019439139122015,0.429151103337341],["List",0.8991871555019432,0.43083574036843997],["List",0.8970370836180868,0.43385942182958404],["List",0.8899607037441168,0.42813193098278685],["List",0.8947786652458272,0.44294851599479457],["List",0.894139842122573,0.44971768874423224],["List",0.8851343922871454,0.43825972783068323],["List",0.8880875492635736,0.45396675625981275],["List",0.8825420919641641,0.44952791257982855],["List",0.8849692904991843,0.4669661301913208],["List",0.8752633461144343,0.4481833614565721],["List",0.87024043011819,0.4409439965249531],["List",0.8675832527000407,0.4414691607477091],["List",0.8659221348355765,0.4483564885007514],["List",0.862426964284921,0.444826288376443],["List",0.8591822484428842,0.44297061757589046],["List",0.8578235133026534,0.4581039177172091],["List",0.8539420319003528,0.4452307704835037],["List",0.8508739359549858,0.4399570335437294],["List",0.8482024309053992,0.4586062837786568],["List",0.84532622570968,0.4450058880715532],["List",0.842359270015068,0.44577334047302775],["List",0.8382428246750603,0.4587892768889811],["List",0.8349785428532844,0.4573139144702221],["List",0.8323591331803047,0.453722462168593],["List",0.8307845305800228,0.44620492459080596],["List",0.8263374161242041,0.4515531806080064],["List",0.8230247493268754,0.45194061457271684],["List",0.822657592145251,0.44162124980837425],["List",0.8151191251796848,0.45391184838781473],["List",0.8192398826861133,0.43405648496409255],["List",0.8170159941569987,0.43179978741793],["List",0.8084784231180167,0.44354355814485485],["List",0.8076400611139662,0.4374922215014099],["List",0.8075212883916292,0.43095195016396504],["List",0.8120681881181808,0.4178832085020211],["List",0.8091324188631082,0.41740475463337634],["List",0.8002288085909295,0.4253076115909703],["List",0.7966049009161651,0.4250563493742468],["List",0.7961869362687968,0.4202725137492078],["List",0.7979591946227639,0.4137250736398541],["List",0.7948788457858464,0.41235572215379185],["List",0.785214485043871,0.41698338874386426],["List",0.7858929726599146,0.41188012810125135],["List",0.7825325778507818,0.40993373399166533],["List",0.7818464776997953,0.4061417782592141],["List",0.7798742179197561,0.40338520783485204],["List",0.7799124246020915,0.3990150788993468],["List",0.790167763135737,0.3895658515934255],["List",0.7703977243922742,0.3956163710333699],["List",0.7782405802787018,0.3880541240897237],["List",0.7821965171771957,0.38295135080451487],["List",0.7699704265289613,0.3832878552872204],["List",0.7896310624553077,0.3740124061836805],["List",0.7711275582657003,0.37497167860528746],["List",0.7847896508875342,0.36869533281238925],["List",0.7790053889804944,0.3663905995972833],["List",0.7699902253029154,0.3635032616585469],["List",0.7707155723289786,0.35977761322185003],["List",0.7782266859858271,0.35634278487371485],["List",0.7736045708628784,0.35248141453713855],["List",0.7674392986457719,0.3482245425998148],["List",0.7783925705527138,0.34591452706298487],["List",0.7816259188261407,0.343046088566281],["List",0.7625768245613943,0.3346956469308951],["List",0.7705043613880336,0.33266798217309373],["List",0.7759397383291053,0.33072966874727133],["List",0.7846432327496726,0.3307139688690702],["List",0.7833528557597118,0.3264627809272558],["List",0.7753274818841372,0.31860935731888357],["List",0.7736944846909258,0.3131445243835748],["List",0.7764845373998976,0.3105143617165064],["List",0.7856361272086363,0.3126796976797795],["List",0.7764688392229283,0.30114045749426727],["List",0.7761307370463333,0.29596320915536145],["List",0.7949105037426978,0.3077909024846896],["List",0.7861571474139808,0.2945858792772636],["List",0.7901977404906466,0.29394925822803725],["List",0.7963694072775148,0.29576879149600055],["List",0.7995003215708228,0.2948201772715424],["List",0.801002929862557,0.29194890099253656],["List",0.8124411776892129,0.30340658919156827],["List",0.800246952635906,0.279197935837661],["List",0.8127710648083792,0.2941946650754559],["List",0.808585380850902,0.2802506615295209],["List",0.8145220126253304,0.28583008094884027],["List",0.8143040538155983,0.27801177994452075],["List",0.8190716333831173,0.2821775944603632],["List",0.8177843413216354,0.2697074334319358],["List",0.8215619905517683,0.2708565751877512],["List",0.825735498678367,0.2748892627421174],["List",0.830740476562515,0.2829145643642582],["List",0.8317183550075503,0.2754005823252762],["List",0.8354499665098498,0.28143730819548324],["List",0.8360130158439586,0.26650391304081783],["List",0.8377129848173988,0.2552268261508162],["List",0.8421850588086596,0.26826845112188413],["List",0.8454117164416972,0.2741976819072968],["List",0.8478076693026739,0.25280076205282176],["List",0.8512975146259182,0.2543599260881586],["List",0.8531264283513859,0.27985759464526777],["List",0.8567472433679286,0.2659594265664908],["List",0.8592608666848578,0.27093014422040707],["List",0.8619693956995177,0.2713961959758514],["List",0.8663561405213411,0.2642364213725664],["List",0.8683541885627915,0.26936364220505343],["List",0.8660630952575284,0.2899893155526042],["List",0.8759472932159291,0.2647912862701063],["List",0.8744815350572591,0.27941320344158604],["List",0.879409072679448,0.2745442694331473],["List",0.8810858615514353,0.27874868666840613],["List",0.8875862746296843,0.27121763988809144],["List",0.8885466719879452,0.2771383778084979],["List",0.8891787730264904,0.2825544965245304],["List",0.8921761149163141,0.2832493859449499],["List",0.8870258628235541,0.29748166028974504],["List",0.8975120415472205,0.28670511700419316],["List",0.8987485569147123,0.29073749875351435],["List",0.8997401636117308,0.2947469321450816],["List",0.903217549756293,0.2953553179760944],["List",0.9084638172192785,0.29475974852545483],["List",0.9149524973433508,0.2931440732743693],["List",0.9174856979587516,0.2962016496480618],["List",0.911862878419977,0.30594367773463005],["List",0.9143089038711723,0.3082473023729336],["List",0.9172117347841038,0.310703324659708],["List",0.9188749293813807,0.31381207075052286],["List",0.9179166179723656,0.318370221020435],["List",0.9212070916960802,0.3208251170191692],["List",0.9192402461125742,0.3256371333906423],["List",0.9203060551193274,0.329215095336129],["List",0.9202239754725072,0.3331287491265726],["List",0.9254897011613907,0.33510740109271636],["List",0.9189177094818637,0.34075355330805185],["List",0.9349124278553448,0.3410256350211141],["List",0.9208544077956233,0.3471532197931549],["List",0.9107796431351936,0.35177507356550514],["List",0.9323540657070252,0.35356596960193615],["List",0.9145296824511038,0.357855589202835]]]],["List",["List",["List",0.7742211142505901,0.9233261128441839],["List",0.2666740672241038,0.4490371111815662]],["List",0.8487736135473869,0.357855589202835,0.9501132661504412],["List"]],"'BubbleChartBubble'"],0.9501132661504412],["Style",0.9501132661504412,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",0.592371590002254,0.5131290283541845],["List",0.5926832901385197,0.5160516639785212],["List",0.6111873015810713,0.5210264003182973],["List",0.5983744301707714,0.5230392337244422],["List",0.5973903194025976,0.526072374821423],["List",0.593043286509738,0.5285026000564512],["List",0.5992682952060707,0.5334149701273279],["List",0.6061042153284235,0.5395356912548533],["List",0.5891413511695713,0.5368838185040571],["List",0.58565362714094,0.5383885503236143],["List",0.598084519091149,0.5479765843047683],["List",0.5991789560999538,0.5524200810078644],["List",0.5799376910705433,0.544366818202445],["List",0.589180760178249,0.5539430813788888],["List",0.588407260828129,0.5570812947677903],["List",0.5887427006882481,0.5615345527246574],["List",0.5829472662053634,0.5607008452446535],["List",0.58433336282925,0.5659239479804239],["List",0.5769085133541938,0.5627013141385983],["List",0.5818693855135244,0.5723121352712147],["List",0.5832289733139094,0.5791120321404929],["List",0.5759937655991911,0.5750147619659378],["List",0.5799671437173035,0.5856930904397829],["List",0.5732606977848479,0.5815049903691174],["List",0.5743072298398239,0.5890004209046862],["List",0.5715636831713989,0.5903010470351099],["List",0.5690435080507783,0.5925101471785199],["List",0.5593963025315938,0.5784842365575282],["List",0.5622789906356764,0.5924304322679708],["List",0.5552794219583588,0.5821874118887108],["List",0.5599624969878899,0.6039290874469688],["List",0.5533150965884558,0.5931736333649059],["List",0.5475210233341616,0.5815603450838119],["List",0.552105634905764,0.6121007926001631],["List",0.5491777253492123,0.6151779647445399],["List",0.5447667538112593,0.6082046400865273],["List",0.5390645294828584,0.5885527957629575],["List",0.5378284494231503,0.6016079631273501],["List",0.5349794747739305,0.5999974958752046],["List",0.5321955070991488,0.6051653774923004],["List",0.5292811171225972,0.6118917762003923],["List",0.5270534497802983,0.5835993155965639],["List",0.5238963353283346,0.5946095643503224],["List",0.5207785685655167,0.5999893404400206],["List",0.5180523994408551,0.5981215184339445],["List",0.5143601167844766,0.6035435078574648],["List",0.5113191265875042,0.6040951893836387],["List",0.508031129319968,0.6042110902111588],["List",0.5063667388993845,0.5989028789476113],["List",0.5056840159005495,0.5906112825042702],["List",0.49817811021627717,0.603500973815538],["List",0.505727623833437,0.575344774988348],["List",0.4976027047281553,0.5881924974507284],["List",0.4906787901722925,0.5964077699814139],["List",0.4940669413192965,0.5823894676481208],["List",0.4900505659135338,0.5836350685041716],["List",0.48685978355902854,0.5834200505108647],["List",0.47935919173341873,0.5889630524313514],["List",0.4841450265864583,0.5766226981416783],["List",0.48157123936557644,0.575307419020888],["List",0.4761536645353437,0.576852396808424],["List",0.48006434210902027,0.5678575468313223],["List",0.47521735645878366,0.5683662539714537],["List",0.4757855646855822,0.5634157576817614],["List",0.4684161313599796,0.5659028511945741],["List",0.47106262517304487,0.5593401152140355],["List",0.4658756971090059,0.5592783532401034],["List",0.47348027067213205,0.5503729524078635],["List",0.4659818027849334,0.5512987612159839],["List",0.4492017095113891,0.5567610886325629],["List",0.45901259825324936,0.5472535144800527],["List",0.4691981871288721,0.5390931037385893],["List",0.4573080872964337,0.5404698035850838],["List",0.4557192708179157,0.5370504503469258],["List",0.467748888066769,0.530091627152756],["List",0.45678916634920064,0.5292323863063992],["List",0.45812813011157555,0.5252781577802678],["List",0.4536228421675593,0.5224530870600221],["List",0.43405291415252345,0.5199957030814513],["List",0.4676275233401339,0.5146609122113824],["List",0.46374136412000455,0.5117115908626951],["List",0.4606934463045364,0.5081853550430849],["List",0.4583638533416973,0.5046651958860591],["List",0.44780731545200325,0.499210938537968],["List",0.4557923324141849,0.49679750376335813],["List",0.4578196637877183,0.49377783565527156],["List",0.4595010961399222,0.49049313299715874],["List",0.45003444957515437,0.48340622513815973],["List",0.4632929704214525,0.4849641845984807],["List",0.4632683825144788,0.48118347443739395],["List",0.45326852898632225,0.4722122088362506],["List",0.4705426962376248,0.477815730699365],["List",0.46882902844823604,0.4731730187039272],["List",0.4634667786495072,0.465637179485007],["List",0.47133948809782267,0.46724101251656436],["List",0.46540662303407676,0.45823033808898267],["List",0.4725690734391004,0.4598958869432678],["List",0.4653913413615699,0.44800697134456224],["List",0.47861252628472584,0.4572386845149003],["List",0.4779062915885154,0.4515984414017371],["List",0.4795753463581174,0.4488240485221592],["List",0.47995772746611526,0.4443076721460136],["List",0.4850595688645327,0.4460180379549],["List",0.47595410459605736,0.42578283586269483],["List",0.49786702351524376,0.4565915096414658],["List",0.4912499036693053,0.4386081715549073],["List",0.4928125069740112,0.4352641085387321],["List",0.5012510981659882,0.446904537907782],["List",0.49513019171128336,0.42468891123403485],["List",0.4961488719439332,0.41729258739474756],["List",0.5035139618829236,0.4289580500034963],["List",0.5023074645961741,0.41397340070713723],["List",0.5050231985583894,0.40999258064151284],["List",0.5128214600096611,0.43084656272791944],["List",0.5163079965897526,0.4355098064026457],["List",0.5177518194658801,0.4265837401561969],["List",0.5214707343313041,0.43546318611755563],["List",0.5233679437917388,0.4251119666810478],["List",0.5264313861690032,0.428282995898202],["List",0.5291127622140956,0.4339236281995955],["List",0.5319924416614327,0.4249077332794957],["List",0.5350225544460848,0.42028139576464246],["List",0.5381791262020063,0.4170323820229579],["List",0.5412861992076209,0.4182637236609039],["List",0.5466428426438663,0.4030427487111169],["List",0.5465342629208492,0.4242449551092579],["List",0.5510444211477985,0.4173029658997792],["List",0.5490350979664252,0.43778669475591836],["List",0.5556375807924863,0.42478110906060557],["List",0.5592738003200018,0.42332103835865226],["List",0.5555111780648894,0.4433205772655291],["List",0.5603220052138215,0.4385054500230424],["List",0.5671771996310934,0.4297869147296923],["List",0.5667112800028178,0.43830290444966485],["List",0.5630332311777221,0.45127036767248846],["List",0.5686472863400212,0.4464234839848642],["List",0.5750452376644688,0.4417827494254982],["List",0.5772990052771045,0.44384781596708967],["List",0.5846009554916997,0.439584539579398],["List",0.5822105734436712,0.4482831327445933],["List",0.5761615551728501,0.45995422844829037],["List",0.5865064010976528,0.45323060224149453],["List",0.5887393871974511,0.4555366092981179],["List",0.5763026591837168,0.4714399640679182],["List",0.5888709720419918,0.46455726017547255],["List",0.5832734740046038,0.47268223981019086],["List",0.5946982236160757,0.4684439388709317],["List",0.6034136476696137,0.4669045470498805],["List",0.5909917639532242,0.4782077910994055],["List",0.5936788298522332,0.48049296077457454],["List",0.6024382224243349,0.4799364467711608],["List",0.5968128456505996,0.48631453907133493],["List",0.6091730567718554,0.4856745789032274],["List",0.6030389958676056,0.49142404888287033],["List",0.5938675340229049,0.49751854021676095],["List",0.5918190783828685,0.5010196473475427],["List",0.6015559185299864,0.5024809876117564],["List",0.6079481396067776,0.5054695876970958],["List",0.6067258835872108,0.5091830485429514],["List",0.603386690523843,0.5131290283541845]]]],["List",["List",["List",0.4574198279226309,0.6022622312028241],["List",0.42455419248203147,0.6017038642263375]],["List",0.5298410295627274,0.5131290283541845,0.8965663202927352],["List"]],"'BubbleChartBubble'"],0.8965663202927352],["Style",0.8965663202927352,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",0.8792924673505396,0.8576308646478074],["List",0.8806782411565444,0.8611439548476347],["List",0.880780704125648,0.8649743132624356],["List",0.8666895239177348,0.8665311622349221],["List",0.8716518800484085,0.8703754147971229],["List",0.8714443632586781,0.8737589864787625],["List",0.8737609363497233,0.8776811827137814],["List",0.8683015243202324,0.879500958754042],["List",0.8662415291801374,0.8821071598298778],["List",0.8648457600890629,0.8846523092836395],["List",0.8640834536921322,0.8877294518362492],["List",0.8741075788787871,0.8967120123799239],["List",0.8750002979488943,0.9011922285639005],["List",0.8617957201621411,0.8965987939426706],["List",0.8713220817115577,0.9072985493027822],["List",0.8642698671013677,0.9062238577571853],["List",0.8725719416804374,0.9180353769097049],["List",0.8575318104420302,0.9083906173324287],["List",0.8515255936564813,0.9064848909556944],["List",0.8684213742054121,0.9296143766005374],["List",0.8631114031617552,0.9292785433079284],["List",0.8500346682753245,0.9178295648586603],["List",0.8555510029792364,0.9306072289497995],["List",0.8439479220280925,0.9187442690316164],["List",0.8442171647331079,0.924306970317298],["List",0.8469329070680508,0.9349326848615562],["List",0.8453006679348988,0.9389520659984185],["List",0.8392738555327023,0.9331104655183133],["List",0.8375057074782613,0.9367554414118773],["List",0.8317606437612407,0.9298985333552976],["List",0.8275420332376142,0.9251607405254327],["List",0.823542085272034,0.9203801738101978],["List",0.8271298686408313,0.9427434738939947],["List",0.8230437275674253,0.9372170896300944],["List",0.8224047073056985,0.9487445267960957],["List",0.8174642763408015,0.936134981334403],["List",0.8156963451956948,0.9439531424412155],["List",0.8144203350064579,0.9604309381787798],["List",0.8100300124410611,0.9402981281123357],["List",0.8070081667681617,0.9306543553602521],["List",0.8046075489775243,0.9515632729649757],["List",0.8018758968808665,0.9401496528682246],["List",0.7983471172905321,0.9507380911336669],["List",0.796206179216834,0.9432589455628366],["List",0.7938058190832964,0.9393474668049077],["List",0.7905052863667482,0.9431036652779391],["List",0.7889008588378263,0.9373861322352387],["List",0.7868325874308331,0.9340862299865349],["List",0.7842845111500354,0.9338360292236565],["List",0.778323029063996,0.9436450279633043],["List",0.7769754904362297,0.9380179081404938],["List",0.7718824692160104,0.943439850672305],["List",0.7689292893540007,0.9419437856250412],["List",0.7785112113778445,0.914257310139933],["List",0.7666402114497857,0.9321685461622076],["List",0.7641600178705908,0.9302447882980943],["List",0.7579712558859775,0.9347701975760556],["List",0.7612319334031732,0.923589858151556],["List",0.7590418788853204,0.9216833763303696],["List",0.7601059606526525,0.9156412447182738],["List",0.7533405003888886,0.9191135524283647],["List",0.7490762122622903,0.9192720145586266],["List",0.7480786313104468,0.915333244708715],["List",0.7512026060084482,0.9078078265338906],["List",0.7545368228187659,0.9011071624648438],["List",0.742836896715995,0.906613100597143],["List",0.7449165977711762,0.9010805396338356],["List",0.7479334131931874,0.8954337736493596],["List",0.7416422675625008,0.8955845722509762],["List",0.7381385495161362,0.8938838325675398],["List",0.728041317186036,0.894776337286167],["List",0.7320099594774439,0.8889413343787486],["List",0.7395565093134356,0.8823521226725759],["List",0.7441466034205416,0.8773153762317789],["List",0.7479605284228542,0.8732514201231416],["List",0.725885586691137,0.8751015131638558],["List",0.7339904145148566,0.8696845741467447],["List",0.7349993366930527,0.8662114462910677],["List",0.7379640979963372,0.8624464474040998],["List",0.7384476119343024,0.8592730339568154],["List",0.7353680597999004,0.856134677454189],["List",0.7426038411054541,0.8531598664515161],["List",0.7305541823264203,0.8487989192662118],["List",0.7357488139444359,0.8458577315991415],["List",0.7317305932280468,0.8414403193113686],["List",0.7244102588427528,0.8359398254741556],["List",0.7429183309624885,0.8376074602723861],["List",0.7510435215913742,0.8374833872184748],["List",0.7385701326799617,0.8294567585530807],["List",0.7399536128759063,0.8263504845752814],["List",0.734838023373859,0.8200646833755892],["List",0.7528972759241997,0.8265192721491589],["List",0.7321848770225599,0.8098534008978316],["List",0.7457458836040108,0.8151333597515215],["List",0.7436531084731509,0.8094011101536603],["List",0.7499991819621726,0.8106503292956224],["List",0.7498447014840899,0.806234915570068],["List",0.757217491644614,0.809208328897126],["List",0.7553572928547796,0.8033178017778283],["List",0.7644118594709005,0.8093773984020542],["List",0.7620305733509819,0.8024807984093743],["List",0.7604379732493083,0.7959577341332185],["List",0.7608646782195202,0.7912782756188868],["List",0.7630226620089995,0.7893620622758175],["List",0.7608293412560496,0.7792791234348868],["List",0.7699306905369324,0.7896402688647942],["List",0.7625427895327743,0.7680557442892044],["List",0.7736928588090103,0.7847878778229072],["List",0.7708389812731333,0.7702347340710466],["List",0.7724572641430816,0.7646654780573771],["List",0.7798977196438203,0.7769278431588764],["List",0.7837537560510127,0.78061308389729],["List",0.7858254974601206,0.7773644982881309],["List",0.7887896609762737,0.7785834754326948],["List",0.791333232071967,0.7784411842804542],["List",0.7942255846458737,0.7794952484456785],["List",0.7964214251285772,0.7767327103236983],["List",0.7983856925757985,0.7657888768615697],["List",0.801949000464374,0.7782236815039234],["List",0.8043714999671256,0.7740414437381058],["List",0.8070821481224772,0.7779938505304271],["List",0.8104519313279224,0.762447860309031],["List",0.8115011692885822,0.7843192122344598],["List",0.8168582749966942,0.7605025157906431],["List",0.8164560707061732,0.7834879344054656],["List",0.8231852985138732,0.7615480529766655],["List",0.8224712489584954,0.7793048116438672],["List",0.823691393778128,0.7848115189406606],["List",0.8287766202356373,0.7766805313379092],["List",0.8302614302477146,0.780978269960563],["List",0.8293476882909193,0.7917996968429358],["List",0.8379563925795612,0.7772899028163006],["List",0.8361444017709067,0.7884227493279409],["List",0.842498634343956,0.78181374888262],["List",0.843203964315758,0.7866930847048627],["List",0.8447845773198779,0.7894844315894777],["List",0.8510976964215289,0.7850954685687479],["List",0.8528110305537802,0.7880387378672266],["List",0.8511310861254983,0.7958633366225802],["List",0.8554557455142928,0.7953281529815744],["List",0.8494407699856478,0.8067747817802773],["List",0.8548671583719696,0.8050665942153568],["List",0.8627788852133512,0.8012700672703794],["List",0.8537885422345188,0.8139795976985287],["List",0.8566439866701179,0.8152517624651286],["List",0.8640030637944368,0.8130733152483904],["List",0.8550318827102771,0.8232565775962698],["List",0.859023281147523,0.8237769223791797],["List",0.8649450702555455,0.8234781372645964],["List",0.8684744934981663,0.8252521440490201],["List",0.8688706824908545,0.8284922266232262],["List",0.8611544310708595,0.8352035752816406],["List",0.8729839642399809,0.8341521179143795],["List",0.8757573868561543,0.8366911126351617],["List",0.887557187785544,0.8375365093152837],["List",0.8837669441992174,0.8422686079901689],["List",0.8772562135470469,0.8469232476949416],["List",0.8713631395444149,0.8511368128523266],["List",0.8732759683584532,0.8541339099431894],["List",0.8744179696486827,0.8576308646478074]]]],["List",["List",["List",0.7346209997629631,0.8756591540981864],["List",0.7713824243496471,0.9438793049459676]],["List",0.8051400769305748,0.8576308646478075,0.8500886313046121],["List"]],"'BubbleChartBubble'"],0.8500886313046121],["Style",0.8500886313046121,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",0.3129681350137544,0.9132491781986367],["List",0.31918684553464927,0.9150687662045027],["List",0.31884408248766205,0.9170142529075704],["List",0.31345550980627135,0.9180779821747653],["List",0.3166408493876832,0.9202581322700794],["List",0.3164815193372621,0.9221079552850406],["List",0.3100946788894147,0.9220243575368522],["List",0.3161502538032982,0.9257449128949512],["List",0.31459304417296885,0.9270816913020451],["List",0.3118844102323468,0.9276511831491832],["List",0.31888553959909954,0.9330737475761826],["List",0.3119556643916268,0.9313219279203689],["List",0.30875790757933885,0.9311423835127746],["List",0.31277391887139716,0.9357483872049344],["List",0.3032209311110319,0.9306291223568623],["List",0.30465971204137937,0.9334634516638451],["List",0.30465775543955387,0.9352815113043431],["List",0.30088561970568967,0.9334239373615314],["List",0.3057107808890004,0.9402626846546301],["List",0.3086952978207593,0.9458197728185388],["List",0.3051256743190505,0.9442254973378198],["List",0.3049958921604419,0.9466824848553732],["List",0.30232493199180493,0.9454773455574392],["List",0.30158237854941766,0.9471384635326675],["List",0.29672178191831716,0.9416749068223479],["List",0.30163983332046673,0.9531600614687236],["List",0.29845041800555866,0.9504834492497335],["List",0.29764313056209535,0.9521256268836349],["List",0.296715038824637,0.953960488259742],["List",0.2960990213263662,0.9567847735781386],["List",0.29604388430923834,0.9614253184655888],["List",0.2912757900362313,0.9514865131353375],["List",0.28948608565818523,0.949724729375479],["List",0.28999625405132057,0.957408454093068],["List",0.2884375808302587,0.9574499375798611],["List",0.28672523679083645,0.9556920346882953],["List",0.2845934898108711,0.9503029455688758],["List",0.28352858202748793,0.951647059084252],["List",0.28235602558416906,0.9520273192075284],["List",0.2812073738450175,0.9580131452280449],["List",0.2798026036400615,0.9590428582734775],["List",0.2784569472985302,0.9538306344434132],["List",0.2768867645266305,0.9567733403001689],["List",0.2758739056101602,0.9533926136348094],["List",0.2754803957793562,0.9462827595410674],["List",0.2727430597544355,0.9559958881207162],["List",0.27044961168659637,0.9604593434242359],["List",0.26882528848386056,0.9601766241785246],["List",0.26998935439198457,0.950054911957884],["List",0.26977834044636373,0.946234140694892],["List",0.26694559288065095,0.9506865073830502],["List",0.2647697785227444,0.9527056818325252],["List",0.26890172192988315,0.9392351972022167],["List",0.2629209309560544,0.9497002347684836],["List",0.25862548611441705,0.9547517767866142],["List",0.256756889685778,0.9545446651759675],["List",0.26027527906714876,0.9456085081713304],["List",0.25720248163846776,0.9475891714290248],["List",0.25545090428772294,0.9474461028276085],["List",0.2566981128948086,0.9433454887406629],["List",0.2510992987116965,0.9476262596709459],["List",0.2522841856631138,0.9437905974387089],["List",0.24961609659083253,0.9440372835554162],["List",0.2502740119503804,0.9409605589446554],["List",0.2508966127058397,0.9383071050546006],["List",0.24614471792290032,0.9399148330938651],["List",0.24737190696308672,0.936834389613453],["List",0.2532780720108478,0.9309484924558168],["List",0.24612441507964544,0.9335343746089361],["List",0.2481209538254183,0.9305318544628057],["List",0.2465528589169441,0.9293936799930261],["List",0.2446817429717938,0.9283972376015166],["List",0.24582097608285539,0.9261561709598325],["List",0.24623449130222202,0.9241664499046882],["List",0.24968891279622918,0.9215466892257395],["List",0.2441814501806566,0.9211586394886536],["List",0.2442714368435586,0.9193126181566096],["List",0.24978120253564995,0.9169535694551031],["List",0.24794854953672185,0.9155512814422124],["List",0.24607813205933746,0.9140859687813092],["List",0.24116290888333464,0.9124150235629879],["List",0.24306731714335125,0.9106042453378498],["List",0.2460480882305824,0.9092214601171593],["List",0.24496692778245654,0.9072948039736282],["List",0.24608925613044544,0.9057564022210232],["List",0.25193913255438316,0.9056928748197938],["List",0.24854538824370495,0.9031068354798139],["List",0.23860943671636453,0.8978106901901212],["List",0.2461581863088809,0.8989001223230475],["List",0.25081049265877126,0.8992124426503192],["List",0.2532954807303128,0.898946264720122],["List",0.24159696715795567,0.8903423803827548],["List",0.24964413432752247,0.893328747578207],["List",0.24828040946028562,0.8905087791025215],["List",0.2474353572522801,0.8876569977343737],["List",0.2451399810931134,0.8834951182966518],["List",0.2527908334118216,0.8879009678174016],["List",0.2470308499021066,0.8798732093795097],["List",0.2560549784450717,0.8870572554597714],["List",0.25123908436392034,0.8791004650460972],["List",0.257601556995023,0.8845152108786771],["List",0.25839757740203567,0.8833596151414643],["List",0.25726211490796225,0.8790801799617334],["List",0.26084007893457645,0.8820916969045192],["List",0.26348864224894186,0.8839432171074995],["List",0.2613471599253593,0.8771097212849623],["List",0.2613464235345563,0.8738929222713774],["List",0.26465346839033627,0.8775570064659063],["List",0.2649389209155584,0.8747163611190987],["List",0.2647009207684805,0.8695543727544076],["List",0.267764477388147,0.8739317326728544],["List",0.2688967061564189,0.873039217713297],["List",0.270884614681493,0.8751094375376482],["List",0.2706396214291874,0.867694873061428],["List",0.2713084114680241,0.8630413770942966],["List",0.27352153597066164,0.8664251588762463],["List",0.2756540360503704,0.8723467571717334],["List",0.27665934769847333,0.8669789980944055],["List",0.2785489152047684,0.8755918881734907],["List",0.27968962134376996,0.8727258091108601],["List",0.2810126491477246,0.8742756746745683],["List",0.2823622122432241,0.8720356715445508],["List",0.28409669980953595,0.8667517614854884],["List",0.28501623495269324,0.8721869547897858],["List",0.2858342595912557,0.8754305015809705],["List",0.28782889139156387,0.8718950947461402],["List",0.2896629567710888,0.8698598566149421],["List",0.29248796457817033,0.8644744966853157],["List",0.292540292045298,0.8705143308592794],["List",0.2921334635960992,0.8764162850485034],["List",0.29319389121154193,0.8775383754743706],["List",0.29518294434497044,0.876230594843364],["List",0.2959447237942245,0.877796119905701],["List",0.300580232792054,0.8716090122278762],["List",0.2987211364657433,0.8784754810691622],["List",0.2977837186719925,0.882787023470898],["List",0.30126444120496854,0.8797854890268882],["List",0.3061782148670781,0.8751239159730632],["List",0.3027939174791843,0.8827197166932935],["List",0.3085874978739684,0.8779281301798749],["List",0.3031817218126921,0.8867085711439899],["List",0.3044842579331275,0.8874337360824208],["List",0.30912201909912984,0.8848337150275726],["List",0.3095959318055888,0.8867491865040102],["List",0.3106335728983005,0.888094068931994],["List",0.31363611246699696,0.8878347294919872],["List",0.3122825197302826,0.8910501456032726],["List",0.31298851600510963,0.8925621212326871],["List",0.3137255725316504,0.8940251096236356],["List",0.3114452972695687,0.8972050755295373],["List",0.31268841138872083,0.8983319690343708],["List",0.3183296718938595,0.8979274767493562],["List",0.3178649139775512,0.9001667929352858],["List",0.311352822559235,0.9039707526528052],["List",0.31643397384030314,0.9043812752492348],["List",0.3173124022931149,0.9059711716245998],["List",0.3153460013282551,0.9080103338842841],["List",0.3188043033138257,0.9094500018383049],["List",0.31079616672486404,0.9116718124899627],["List",0.3144128580963245,0.9132491781986367]]]],["List",["List",["List",0.24460531734504376,0.3155191231826835],["List",0.8698835713674111,0.9566147850298623]],["List",0.2800622202638636,0.9132491781986369,0.21490799082816414],["List"]],"'BubbleChartBubble'"],0.21490799082816414],["Style",0.21490799082816414,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",0.3458947655148573,2.192532214033438e-2],["List",0.34684793678444104,2.359398013478916e-2],["List",0.34321738688501713,2.505614415892899e-2],["List",0.34481126233961523,2.6819107855499402e-2],["List",0.349643561561324,2.9335962344559277e-2],["List",0.3441648307177625,3.000010814169475e-2],["List",0.34286712106620093,3.1245747231336808e-2],["List",0.3480327783378736,3.475905531575127e-2],["List",0.3474642566394824,3.6544918528043126e-2],["List",0.3357208345043063,3.31276267738721e-2],["List",0.34508346631655507,3.934558994297214e-2],["List",0.3391945000096577,3.791982253473525e-2],["List",0.3416296759378423,4.1044048875665345e-2],["List",0.33172804326017385,3.620373536617029e-2],["List",0.3382647905133592,4.2410328629905576e-2],["List",0.3391404703608467,4.507703143025582e-2],["List",0.3417285546179473,4.947965900968319e-2],["List",0.34014162105100626,5.018961984183309e-2],["List",0.3384381771532346,5.085675916742312e-2],["List",0.33600215771035674,5.040140890650259e-2],["List",0.3319646096446094,4.787462776639523e-2],["List",0.3331298986420091,5.164118753823993e-2],["List",0.3359183591966667,5.8043346041124606e-2],["List",0.33277200741776247,5.626066632999572e-2],["List",0.3271110310203646,4.946869308395406e-2],["List",0.33078962707880233,5.8587156260240504e-2],["List",0.3306922088758861,6.186367663729219e-2],["List",0.3281447640209413,5.9906769967273725e-2],["List",0.32411381498382597,5.406156965202917e-2],["List",0.3268071705053814,6.492278668734089e-2],["List",0.3238523341727594,6.076287943035555e-2],["List",0.3228863045920089,6.256371265521443e-2],["List",0.3233460167949757,6.98327612376152e-2],["List",0.3189971445728231,5.7614238981591265e-2],["List",0.31837383300176003,6.1006279977792795e-2],["List",0.317300223002171,6.225725720847359e-2],["List",0.31653423526934527,6.74374931986962e-2],["List",0.3155638802253486,7.282860366989899e-2],["List",0.3136625002485957,6.746737857874055e-2],["List",0.31193200436706653,5.958489511303254e-2],["List",0.3107716246759457,5.666896396648776e-2],["List",0.3090976994101658,6.922176119821472e-2],["List",0.30766912967121973,6.714922231449746e-2],["List",0.3070335317982398,5.96414432535882e-2],["List",0.30507095207396995,6.444556496848841e-2],["List",0.3035748764231141,6.510748377872755e-2],["List",0.30185350374171005,6.669204626472122e-2],["List",0.30119297766017145,6.275005929891425e-2],["List",0.30046790404717816,6.029430921090014e-2],["List",0.2996150445100936,5.834119495035533e-2],["List",0.29679242128685535,6.2386798379645586e-2],["List",0.2967581102197141,5.8590236780002886e-2],["List",0.2940854503178216,6.123590872932957e-2],["List",0.2964279850589984,5.284601956663876e-2],["List",0.29022747726816306,6.2081173566735516e-2],["List",0.2925643607452125,5.4536395447866017e-2],["List",0.29011582664464597,5.602769436866377e-2],["List",0.2876551711446882,5.694684420247845e-2],["List",0.2844764761211107,5.873558521526194e-2],["List",0.2869019505788347,5.292660171532056e-2],["List",0.2870217780749764,5.034861839557975e-2],["List",0.2858722400861549,4.9518286455600566e-2],["List",0.28704737678250375,4.6115232668333984e-2],["List",0.28285835019599337,4.8075727266427934e-2],["List",0.28140736659541893,4.732315123118297e-2],["List",0.2835498221065858,4.348173116831479e-2],["List",0.2841788748415334,4.125340944944912e-2],["List",0.28259527882583757,4.06747797193793e-2],["List",0.281978196467377,3.9253370868901336e-2],["List",0.27565442070433743,4.103300075284559e-2],["List",0.2731416127784301,4.015001424812699e-2],["List",0.2738700421738445,3.780897140775443e-2],["List",0.2725500372775482,3.640692370046682e-2],["List",0.2734134229692574,3.4045557136866966e-2],["List",0.27321212699789865,3.22397969646548e-2],["List",0.2774339432430666,2.931761151100211e-2],["List",0.2780471825684251,2.7502652185588155e-2],["List",0.2698107874658957,2.6960312253269655e-2],["List",0.2745088273481443,2.4538980094362423e-2],["List",0.27770711622991007,2.274431991950874e-2],["List",0.275501789243804,2.1164773946866562e-2],["List",0.27283690565191243,1.9199115244882242e-2],["List",0.2755791080650728,1.7734743971006564e-2],["List",0.2751670589606839,1.5851124367226216e-2],["List",0.27706340693139914,1.4447494101866399e-2],["List",0.2752972230973579,1.2340894003096889e-2],["List",0.2742705631086573,1.0115631903293341e-2],["List",0.277638179556743,9.511892074868989e-3],["List",0.268854089293152,4.1013839602402555e-3],["List",0.27388859798002596,4.132112493841985e-3],["List",0.28082407899358813,5.817480039177279e-3],["List",0.2772317155988022,1.8343613775459386e-3],["List",0.28080803348181077,2.173540653080886e-3],["List",0.2821269419613193,1.2886529419780315e-3],["List",0.2804679491992289,-1.999075637327683e-3],["List",0.28013039386065336,-4.349101433016454e-3],["List",0.28308417491410576,-3.992691038907266e-3],["List",0.2810906055719432,-8.26436890762931e-3],["List",0.28520989407788505,-6.177444817250351e-3],["List",0.2871851186178391,-6.252567270108169e-3],["List",0.2866639596815807,-9.167642837871894e-3],["List",0.2894557956184814,-7.754751423555896e-3],["List",0.2894649722054935,-1.0300725108268426e-2],["List",0.29048847523232274,-1.1271237946997706e-2],["List",0.29044523102860675,-1.4364785239783823e-2],["List",0.29150948204304594,-1.5650928537974423e-2],["List",0.2929863720673985,-1.5888349633414844e-2],["List",0.2971013911791545,-1.0196075390067269e-2],["List",0.29287076035751325,-2.4186347134094975e-2],["List",0.2991323065002685,-1.1742685758237115e-2],["List",0.29932051632839285,-1.5315066594637959e-2],["List",0.29917132348358344,-2.05597657967298e-2],["List",0.30097079771643637,-1.9622924617548637e-2],["List",0.3023674357538444,-1.9657671100840456e-2],["List",0.30384855611494166,-1.8911933790859183e-2],["List",0.30545086521562137,-1.757548635927171e-2],["List",0.30700623940145855,-1.4840374749031625e-2],["List",0.3076703185755117,-2.2922632806529987e-2],["List",0.309094450428444,-2.4711164492768584e-2],["List",0.3105905316963845,-1.9192419710755124e-2],["List",0.3121207490112408,-2.5320140207347096e-2],["List",0.3134689498542667,-2.2878470421641837e-2],["List",0.3151674289236396,-2.6466272608115148e-2],["List",0.3158910418701291,-1.887524023408515e-2],["List",0.3165906463605261,-1.4910621740586182e-2],["List",0.3193983903116097,-2.2959600253110446e-2],["List",0.31924631586775626,-1.5484793540081518e-2],["List",0.32078229440694944,-1.659631631698888e-2],["List",0.3235817965908588,-2.127231488016e-2],["List",0.32403813691522526,-1.7953669833657454e-2],["List",0.3261207660033871,-1.928010918208671e-2],["List",0.3278945875672953,-1.9512921049226292e-2],["List",0.3261444174536322,-1.1950275184398534e-2],["List",0.32596186594518184,-8.502686496908645e-3],["List",0.3308966692090972,-1.521364058902265e-2],["List",0.3341440549878595,-1.7911852525503216e-2],["List",0.33420455904935004,-1.4748244184185334e-2],["List",0.3346824015357948,-1.2693120713670701e-2],["List",0.3355063646391645,-1.1029756658784626e-2],["List",0.3374801403667924,-1.0902247703226113e-2],["List",0.33401972048621514,-4.53679013516747e-3],["List",0.33856950500858296,-7.250362823521959e-3],["List",0.3416359850378079,-8.062086853275079e-3],["List",0.3402898816480519,-4.384064460824823e-3],["List",0.34025829446325123,-2.17520040358744e-3],["List",0.33815884331269125,1.3431045741741643e-3],["List",0.3448293330880776,-1.4039338240040035e-3],["List",0.33840388521025394,4.688175213163542e-3],["List",0.3432538828052332,3.488222686108971e-3],["List",0.34858466801462784,2.6946990089777266e-3],["List",0.3468497699533211,5.519883341288119e-3],["List",0.34353256343506794,8.88720826688161e-3],["List",0.34542295416038,1.0001695874442789e-2],["List",0.34435418978281196,1.2025680506930836e-2],["List",0.3522053737484985,1.187126342912049e-2],["List",0.34314709054465153,1.56382307911392e-2],["List",0.3433179128217605,1.7122179419046687e-2],["List",0.3513814486379325,1.7962304575529428e-2],["List",0.3466520040111563,2.0093934012327022e-2],["List",0.34688713151460476,2.192532214033437e-2]]]],["List",["List",["List",0.275845155867823,0.3460920354854431],["List",-2.1032442241861876e-2,6.488308652253064e-2]],["List",0.31096859567663304,2.192532214033438e-2,0.21088468981509645],["List"]],"'BubbleChartBubble'"],0.21088468981509645],["Style",0.21088468981509645,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",0.7801939923922228,0.3516135309142612],["List",0.7808508917139722,0.35335622070174433],["List",0.7786682547523899,0.3550394610265509],["List",0.7775938399508648,0.35656102949654883],["List",0.7725957318719641,0.35721170812410125],["List",0.782298197807961,0.36108021700932896],["List",0.7778174701288683,0.3616758901199181],["List",0.7739351746931308,0.362193569536112],["List",0.7790988848208593,0.3659220728376089],["List",0.7800244748021188,0.3681981174457563],["List",0.7726876207565773,0.3665791859877919],["List",0.7807529213684139,0.3727914386812374],["List",0.7748816727677534,0.3712565806488581],["List",0.7689882638236097,0.3692271640851996],["List",0.7713298840427751,0.3725893184121183],["List",0.7753093009166526,0.37785332715678144],["List",0.7732664788928841,0.37838566272618945],["List",0.7656398520980581,0.3731802639310564],["List",0.7713110841796873,0.3810313198244308],["List",0.7667015850819192,0.3781425282915792],["List",0.7643295460569982,0.37750574557014516],["List",0.7721654837787856,0.3902120611747495],["List",0.7658189881021493,0.38409727882959166],["List",0.7673401107238748,0.3893456110498755],["List",0.7630546150666547,0.38518422668944946],["List",0.7604493343397325,0.38318621554980453],["List",0.7646585036167685,0.39470093997384825],["List",0.7649001391352872,0.399201354773809],["List",0.7573544128166875,0.385777587452988],["List",0.7577415744657059,0.3906020829308449],["List",0.7566357918287383,0.3915734572836049],["List",0.756421221301592,0.3960839412521612],["List",0.7555375917281624,0.39867117223859766],["List",0.7531440828390324,0.39501855307579103],["List",0.7512465788971946,0.3931306570581023],["List",0.7502049010983817,0.39508932810381603],["List",0.7490587427492739,0.3980528318129434],["List",0.7470399635266576,0.39215903639203475],["List",0.745945417446242,0.3949880794737846],["List",0.7444139168176982,0.3920399976672997],["List",0.7431161557577372,0.39810447200178023],["List",0.7413285299411051,0.40346794954479953],["List",0.7408661963339318,0.3860650405534829],["List",0.7389098086609935,0.3944560168484814],["List",0.7384236366026881,0.3873454453564381],["List",0.7367214570511977,0.3905003763100931],["List",0.7349627556988044,0.3929515843990792],["List",0.7317846702384738,0.40003656422970674],["List",0.732099934598041,0.392829306068744],["List",0.7318730763511166,0.3885204563272921],["List",0.729194302056914,0.39210140524218196],["List",0.7268715259354775,0.3942068486361904],["List",0.727545377855577,0.3884821045519192],["List",0.7259621922162519,0.38865202165016394],["List",0.7241073250166598,0.3889258700467916],["List",0.7241275358138769,0.3857271230484223],["List",0.7214351545182381,0.3875014228979452],["List",0.7250908305205697,0.3790871838115427],["List",0.7217299996063946,0.3816953859395602],["List",0.7195258130490384,0.38234078022166845],["List",0.7159611618808943,0.38415756098442677],["List",0.7178893773224867,0.37963968238937273],["List",0.7167725997654384,0.37851951718205545],["List",0.712743196635514,0.38011408733420515],["List",0.7130111783095704,0.37770497539096487],["List",0.7122794647985258,0.3760642940168671],["List",0.7114545736066411,0.3746466981455293],["List",0.7091025158364888,0.3742643577071957],["List",0.7083950432385892,0.3725244632489333],["List",0.7102314242556479,0.36954930554815896],["List",0.7066282449059944,0.3693200558367401],["List",0.7114148471870713,0.3652992104227867],["List",0.7126603483815066,0.36319298094667196],["List",0.7126911735152549,0.36151769146030954],["List",0.7051000490504533,0.3620709378486632],["List",0.7107847035905852,0.3587986906023735],["List",0.7116236883326876,0.35699343057838495],["List",0.7120527219513804,0.3554458815468753],["List",0.7056739814877228,0.3543165079723199],["List",0.7071242104738332,0.35250625086096105],["List",0.7057656227150332,0.3508069362225431],["List",0.7085429646840159,0.3491228934141643],["List",0.7020266506381116,0.34671678603946665],["List",0.7117499499704004,0.34624712687850995],["List",0.7043716827122756,0.3430102626332651],["List",0.7069897862320008,0.34183603341171165],["List",0.7107019247861888,0.34109758018958686],["List",0.7084778298660817,0.33861482615555905],["List",0.7092163752075363,0.33715472578771266],["List",0.7097388753816811,0.335470630882126],["List",0.7132234657738588,0.33549941395651905],["List",0.7073154337841656,0.3301365518655234],["List",0.7127072890349925,0.3315265293630342],["List",0.7186873802422277,0.3339457590673382],["List",0.7150878726097233,0.3294216885509898],["List",0.7127680163771616,0.3255320812754881],["List",0.7197149140825209,0.32961756064473974],["List",0.717085712637923,0.3250452069698283],["List",0.7180215620698394,0.3239477516379572],["List",0.7163321103609351,0.3195683971504408],["List",0.7203640262139185,0.32216950521292687],["List",0.7171146664878575,0.3153770169873471],["List",0.7175606750578838,0.3129202411323409],["List",0.7222226294228319,0.3173196502789959],["List",0.7260920056726974,0.32104480040292166],["List",0.7223493841986034,0.31100318321352416],["List",0.7260212489517569,0.31511149740995303],["List",0.7261679695138039,0.3117449581810563],["List",0.7265780240945705,0.3088042955857867],["List",0.7300137691756936,0.31359442619045114],["List",0.7300313906833771,0.308937210059644],["List",0.731687895767269,0.3095081696539105],["List",0.7337065421857372,0.3114142988174277],["List",0.734645707784254,0.30938822685284695],["List",0.7355606805197181,0.3067671039066826],["List",0.7371250184280933,0.30683679132462693],["List",0.7395222292196074,0.3158208047450195],["List",0.7406057793391065,0.3138951096012043],["List",0.7416157630706341,0.3077188525740241],["List",0.7430215782179856,0.3126619203181587],["List",0.7444807823487604,0.3064633361862996],["List",0.745820103236187,0.3078844520591583],["List",0.747025257873913,0.30959873237176694],["List",0.7487387248360593,0.3071945195980513],["List",0.7501037846216535,0.3075571742128719],["List",0.7513498623227762,0.30917608191420076],["List",0.7522922453389937,0.3113345173163628],["List",0.7526736146730988,0.31513229641124435],["List",0.7545658258469998,0.3133034213212064],["List",0.7596943154867993,0.3018329458412653],["List",0.7582910284115507,0.311063123853018],["List",0.7585583534364483,0.31445318684840357],["List",0.7609004096848556,0.3125037115966803],["List",0.7624449387189612,0.312921740067296],["List",0.7641882050995085,0.3128337987461872],["List",0.7604554703353593,0.32226138618375594],["List",0.7668615138943254,0.31455197611130475],["List",0.7615200503857554,0.32513149721402573],["List",0.7652876353005712,0.3221904444000822],["List",0.7666030187696679,0.3228575947383557],["List",0.7718932129571383,0.3188807633420246],["List",0.7637311283559945,0.3301009743602798],["List",0.7673941074140214,0.3281316137390319],["List",0.7753323843674211,0.3229430674125302],["List",0.7687700594745852,0.3307215331969793],["List",0.7696216454621839,0.3317491693783765],["List",0.7697585733226328,0.3334391217413108],["List",0.7781577948993607,0.3297630345274711],["List",0.7729564713393576,0.334723193054283],["List",0.7732542436628347,0.3363406550562921],["List",0.7735835548298945,0.3378038636954625],["List",0.778873646113847,0.3374023087349579],["List",0.7753132566894436,0.34056228776511294],["List",0.7771018530814402,0.34161409886321437],["List",0.7811021443143575,0.3424163183088396],["List",0.7754236516236018,0.34535273181370046],["List",0.7819071608103748,0.3458930772052832],["List",0.7769046259741216,0.34832596865787774],["List",0.7813432750534495,0.3496651185431939],["List",0.7811079623065063,0.3516135309142612]]]],["List",["List",["List",0.7082639974885412,0.778495453192984],["List",0.30866519864964403,0.3945618631788783]],["List",0.7433797253407626,0.3516135309142612,0.2107920932449927],["List"]],"'BubbleChartBubble'"],0.2107920932449927],["Style",0.2107920932449927,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",0.2772252841993953,0.9337405419276466],["List",0.2822728117184294,0.935240141028068],["List",0.2838320434250654,0.9370222986952019],["List",0.2785508039599556,0.937864973055606],["List",0.2800039480754231,0.939484226700711],["List",0.28597145405643964,0.9424834362274509],["List",0.2827394504128614,0.943298331693973],["List",0.27796660932789635,0.9434142872784358],["List",0.2817744539442286,0.9464574550499734],["List",0.27612744060684224,0.9455523060315362],["List",0.2742256215018151,0.9460964229729898],["List",0.2848709332200826,0.953484332538819],["List",0.27972662429963163,0.952258779459128],["List",0.27588756969811057,0.9515264496751482],["List",0.27473833220736404,0.9522845125348395],["List",0.2778700124887426,0.956620709149817],["List",0.2705050598602671,0.9520831009552638],["List",0.27814720073382154,0.9609832981949412],["List",0.2746026701629943,0.9596224181466967],["List",0.2729478729658616,0.9598116352404192],["List",0.2738219673780471,0.9631471897380617],["List",0.26800032082885644,0.9578386923442375],["List",0.27240769242518814,0.9661372427138171],["List",0.26665113925263406,0.9599172692754445],["List",0.2728073617145532,0.9726073522591414],["List",0.2673226620175521,0.965728457689525],["List",0.2673442801707714,0.9688031516769426],["List",0.26455438267994796,0.9658613122875002],["List",0.2669620787809508,0.9751380814823934],["List",0.2613698028477115,0.9645289602702574],["List",0.26241656887096904,0.9710837390734236],["List",0.2604649880587982,0.9693278870817603],["List",0.25899729713144015,0.9684544942191272],["List",0.25879957311835855,0.9727298967499141],["List",0.25714027051948907,0.9712724168766003],["List",0.2556185289595137,0.9693481725159787],["List",0.2551561334307827,0.9756704898849053],["List",0.2535811613320338,0.9730937181633731],["List",0.2522799547731896,0.9718016997928922],["List",0.2512115507151147,0.9799835419524859],["List",0.24982174703453158,0.9702202842094494],["List",0.2484605324078751,0.9733804429818298],["List",0.2473774331821666,0.9700780325568016],["List",0.24581323596365875,0.9741428565764847],["List",0.24440460031161584,0.9742876090252275],["List",0.24242547105807508,0.9781455056478937],["List",0.2414808919463778,0.9757204934939353],["List",0.23990478442945729,0.9760192494758022],["List",0.2411812897085192,0.966068014135206],["List",0.23913338699712752,0.9686861941732373],["List",0.23847992899202242,0.9667025149264259],["List",0.23811849355687684,0.964470075231012],["List",0.23370131797973642,0.971756768487972],["List",0.2365680761148959,0.9623643442135392],["List",0.23231960999052273,0.9680259632675691],["List",0.23509024392709502,0.9602102396433226],["List",0.22769471469452368,0.9702650495449893],["List",0.22715875395986448,0.9680956591505515],["List",0.22946426108861714,0.962314219015821],["List",0.228557389058572,0.9613984803108954],["List",0.23040186857728326,0.9570361333076133],["List",0.22742264306406626,0.9585953169400032],["List",0.22687139040127602,0.9571578215452207],["List",0.22419662938578347,0.9577714762382973],["List",0.22397417049538781,0.9561254347004112],["List",0.22409490812924387,0.9541293611305126],["List",0.221932575201053,0.9540110650634105],["List",0.22107481700602663,0.9528735529665576],["List",0.2198570146225669,0.9517745818384175],["List",0.22499276504294008,0.9472868284509074],["List",0.2228615276034468,0.9468293682424738],["List",0.22474066016313365,0.9445674907165328],["List",0.22673464138767466,0.9425210185706362],["List",0.21450040862481515,0.9452065935554054],["List",0.22394024343054697,0.9408674607989103],["List",0.21792830844990518,0.9408166358919299],["List",0.21632400356103587,0.9394505470601299],["List",0.21878305053371214,0.9375629231563208],["List",0.21750201900329885,0.9360722422558424],["List",0.2205735104118483,0.9344658139531424],["List",0.2166361669293803,0.9330244773274073],["List",0.22128918194622443,0.9316858338408596],["List",0.219212735447377,0.9300915452268035],["List",0.21921853942350938,0.9285132199103652],["List",0.21504831560754886,0.9260256090403951],["List",0.21840950157091707,0.925244917125137],["List",0.21530326722685506,0.9225656933677517],["List",0.2197776421139079,0.9224740261460911],["List",0.22072338909703285,0.9213378425382086],["List",0.21682697408039422,0.917808426943157],["List",0.22019734795357632,0.9178001151600874],["List",0.22371341481399487,0.9180693667246029],["List",0.21655976096897983,0.9118222365001057],["List",0.21996147323142445,0.9122270552573636],["List",0.2223051926120591,0.9119946133468021],["List",0.22695389664302942,0.9140807221243342],["List",0.22478021835322687,0.9102727113109257],["List",0.2271673592089423,0.910640842110815],["List",0.2273815599273737,0.9090326436811089],["List",0.22931729155125455,0.9092025047337803],["List",0.23193079203244893,0.9105880339121485],["List",0.23119191389448912,0.9077526159464888],["List",0.2322851870030085,0.907149730759381],["List",0.23362106380215977,0.9071453639383821],["List",0.23146193542658983,0.900910407714452],["List",0.2326395634581924,0.9001617611860676],["List",0.23302545142910383,0.8979857878026235],["List",0.23431714601599957,0.8973472956181215],["List",0.23602533733568334,0.898061579124428],["List",0.23972985350864026,0.9044461455516326],["List",0.23886201313824887,0.8980396722475303],["List",0.2397295341228129,0.8966510324078775],["List",0.24015474768592865,0.8927075453690256],["List",0.24236394974996975,0.8966853705404674],["List",0.2445667950066078,0.902414379840356],["List",0.2447544841150523,0.8959840257446964],["List",0.24604117374346504,0.8967425939974611],["List",0.24748754946213017,0.8991894284366186],["List",0.248628788940971,0.8989084362084069],["List",0.24966091384641032,0.8937557799323609],["List",0.25099619826671926,0.8940613651089342],["List",0.25206464249686955,0.8972560317166363],["List",0.25366105691045987,0.8918759842885444],["List",0.25531219742243466,0.8899461861837376],["List",0.2560919712646455,0.8940127854671217],["List",0.25695772989827215,0.8968457839576335],["List",0.2581485113426001,0.8970434447705599],["List",0.2601564344193095,0.8939856737595736],["List",0.261521852193771,0.8943783650974086],["List",0.26172122232689027,0.8980628115081767],["List",0.2620039392472625,0.9011742073485915],["List",0.2657150775782611,0.895336783044524],["List",0.26594313953136917,0.8982158843263859],["List",0.26584193358625263,0.9016481801107127],["List",0.26640432304807316,0.9032218449905796],["List",0.2690569179145221,0.9010319776825089],["List",0.2687288698154605,0.9042256462167932],["List",0.2666497936207359,0.9094761444710855],["List",0.26999797051445756,0.9069209283292586],["List",0.271779247352945,0.9068080413248896],["List",0.27379080050587745,0.9064620872150699],["List",0.2753855361522417,0.9069368186975622],["List",0.2736954415982962,0.9105984206292324],["List",0.2740074014227535,0.9122248213029988],["List",0.2753361288738896,0.9129166465472671],["List",0.27350695191854946,0.9159680902857185],["List",0.2759276459835335,0.91589667786059],["List",0.27708111407149005,0.9167438617612979],["List",0.27576644308162196,0.9190424567016503],["List",0.2758272386929638,0.9205513749657502],["List",0.2818625811467728,0.919185525578704],["List",0.27836489048260527,0.9223951094416497],["List",0.2870045116393727,0.9209442676049626],["List",0.2778539330816287,0.9254896413607262],["List",0.28449088511982906,0.9253381823902537],["List",0.2785115876545883,0.9281754775997031],["List",0.28008301476526515,0.9292781344887572],["List",0.2825688851072457,0.9305495304370189],["List",0.2820603346798067,0.9320965674931496],["List",0.27772512793522347,0.9337405419276466]]]],["List",["List",["List",0.21886062128294026,0.28119649962340243],["List",0.8956205572552576,0.9718605266000355]],["List",0.25002856045317134,0.9337405419276466,0.16606080642847942],["List"]],"'BubbleChartBubble'"],0.16606080642847942],["Style",0.16606080642847942,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",0.8535355242668548,8.717088757632019e-2],["List",0.8505854017080022,8.854465291192684e-2],["List",0.8500361639894225,8.998527167053132e-2],["List",0.8502058098489521,9.138739518207922e-2],["List",0.851146124411963,9.293831698632332e-2],["List",0.8518103073378015,9.465392288733522e-2],["List",0.8540765560713156,9.682184173719673e-2],["List",0.8485777489284503,9.670366573815983e-2],["List",0.851150147198288,9.922981518477354e-2],["List",0.8481624502867817,9.944281108083972e-2],["List",0.8522475562969473,0.10310309600650672],["List",0.8515180568573512,0.10443773040100263],["List",0.8477268360677139,0.10380722212379981],["List",0.8447412496250678,0.10346799254742373],["List",0.8490916859312397,0.10821775217029239],["List",0.8450595988133193,0.10690464487565088],["List",0.8423195395416574,0.10622669180872141],["List",0.8460729287238488,0.11141744601689701],["List",0.8387800763600249,0.10584786193339968],["List",0.8443745102754326,0.11370652039475208],["List",0.8405514108042701,0.111276923115986],["List",0.8396813690253547,0.11215776821112812],["List",0.8396660540372943,0.11412465161792855],["List",0.8385735947693631,0.11477151931904128],["List",0.8393537188009738,0.11840742463779275],["List",0.8366683054956852,0.11606506561663807],["List",0.837029285038832,0.11953379478311896],["List",0.836236852140316,0.12076042312352073],["List",0.8331961450975824,0.11687246936472082],["List",0.832389407303453,0.11796296441342992],["List",0.8323156633453755,0.12114041089686757],["List",0.8319196963614252,0.12424649581133435],["List",0.8300073047287393,0.1218529108687251],["List",0.8296296764417534,0.12532385288002212],["List",0.8278722089222744,0.12319172417238047],["List",0.8270382488314055,0.1253358041989627],["List",0.8259459686666015,0.1272329528587954],["List",0.8247455652382305,0.1281429770023853],["List",0.8233173866341207,0.12555621105939602],["List",0.8218811968063505,0.1197867209143101],["List",0.8208742338723688,0.1176128079770068],["List",0.8197165326712818,0.12080061107829411],["List",0.8186182701582232,0.12045759872107029],["List",0.8172671043567414,0.12339802750783027],["List",0.8147503756207642,0.13256634475154633],["List",0.8144335930308484,0.1257946583702073],["List",0.812861089125024,0.12737325042087408],["List",0.8138057121501208,0.11741104349185294],["List",0.811628495236708,0.12158495179434277],["List",0.8101615357100976,0.12208481210379732],["List",0.8097734317522229,0.11934725670501856],["List",0.8110605319817824,0.11293681221900759],["List",0.8058770456484944,0.12249206783808736],["List",0.8048342637508055,0.12164698179643857],["List",0.8042759447447235,0.11964014269986578],["List",0.8040784558584855,0.11723768903518521],["List",0.8031476654721749,0.11644294904788857],["List",0.7993934059695194,0.11969873093589475],["List",0.7951595960140708,0.12314065671731445],["List",0.8041924988495605,0.10888165927179018],["List",0.8001818049830637,0.11193628376713388],["List",0.8010846082043761,0.10911895570256787],["List",0.7996688400490725,0.10878898982995706],["List",0.7944029226111923,0.11195717554284966],["List",0.7971322554828918,0.107717325317998],["List",0.7943603222079757,0.10815158539888704],["List",0.7913416227939207,0.10860241333856946],["List",0.7957196847016856,0.1039073868746726],["List",0.7896796301464996,0.10591958237410365],["List",0.790382229263721,0.10376278283490034],["List",0.7927964824207617,0.10078163881797236],["List",0.7918875725163929,9.965534243329949e-2],["List",0.7917397668731391,9.821797118227411e-2],["List",0.7922088604955119,9.647780291313524e-2],["List",0.7895238276350705,9.578247373061952e-2],["List",0.788897076054113,9.425789080923472e-2],["List",0.792790949975334,9.195781142623566e-2],["List",0.7929702832633907,9.060559601297616e-2],["List",0.7907524193602967,8.934257427845826e-2],["List",0.7951399296931589,8.78087931577408e-2],["List",0.7915730823479651,8.653885446989544e-2],["List",0.7935944496365465,8.520819371532484e-2],["List",0.789621124844477,8.34496745976995e-2],["List",0.7864597079204562,8.130273325053823e-2],["List",0.7949844467043692,8.142280203165908e-2],["List",0.7967558299930603,8.064421912929015e-2],["List",0.7922365836340158,7.789954764304352e-2],["List",0.79472866158886,7.736907220914435e-2],["List",0.7955145284052201,7.63649687306576e-2],["List",0.7964352167879922,7.536076367668354e-2],["List",0.7920837607836162,7.169436342272054e-2],["List",0.7951961356627903,7.177630963871569e-2],["List",0.7926262031501942,6.855857670253444e-2],["List",0.7946324969688878,6.827101465646519e-2],["List",0.7914683229115879,6.396981657403683e-2],["List",0.7960427243417443,6.586717692509275e-2],["List",0.7964221771274698,6.428277550064909e-2],["List",0.7978625442249829,6.374474553162891e-2],["List",0.7950704251158295,5.883062003122287e-2],["List",0.7977415908277918,5.9559613935996306e-2],["List",0.8025175483989356,6.346636025927807e-2],["List",0.8028428028747056,6.2055770773534615e-2],["List",0.8037002115177008,6.117468572154866e-2],["List",0.8039204061566012,5.9410409461254435e-2],["List",0.8049271557118775,5.8667556925161346e-2],["List",0.8042229568679983,5.468340600344699e-2],["List",0.8063555886427034,5.627763938358969e-2],["List",0.8075303874537201,5.5862009482801005e-2],["List",0.8094124438334496,5.752754237184264e-2],["List",0.8078226848241411,4.9555196646194066e-2],["List",0.8100399899172337,5.198066291726583e-2],["List",0.8115907885446728,5.311723474219479e-2],["List",0.8134715809050175,5.569017645156679e-2],["List",0.8131526096551472,4.9005711650464724e-2],["List",0.8153797756825187,5.4667356464281947e-2],["List",0.8156962715354554,4.8866935677526376e-2],["List",0.816496297404388,4.494777026736468e-2],["List",0.8181643050602784,4.7976249449412305e-2],["List",0.8196188446587083,5.163702201446785e-2],["List",0.8206879183081359,4.81375086633277e-2],["List",0.8219353100991054,5.073714776651682e-2],["List",0.8230335075683106,5.1571426867514175e-2],["List",0.8239685652751897,5.349771280974108e-2],["List",0.8246463453505699,5.73355649613399e-2],["List",0.8270902396512563,4.7574096219660855e-2],["List",0.828556226976836,4.718660719915679e-2],["List",0.8290255832661282,5.1111857764222224e-2],["List",0.8322282324548469,4.3280561891632305e-2],["List",0.8300508150240044,5.633403421612586e-2],["List",0.831370366785819,5.567071928190395e-2],["List",0.8323809045413311,5.6348507358796845e-2],["List",0.8349457282955203,5.314354908187303e-2],["List",0.8359084674974315,5.3996586618786445e-2],["List",0.8338929189943486,6.11004381398655e-2],["List",0.8365441329787043,5.8289308540742865e-2],["List",0.8360649957899368,6.135557176795667e-2],["List",0.8345445348351752,6.58672974192507e-2],["List",0.8372858348500561,6.346446501106096e-2],["List",0.8406241281138587,6.087787688183155e-2],["List",0.8372811407352997,6.706895108547595e-2],["List",0.8421872146559969,6.290224238125824e-2],["List",0.8437589897212927,6.31628673873502e-2],["List",0.8429783932090571,6.572559498846953e-2],["List",0.8447596805126776,6.589382328749593e-2],["List",0.8448004421679249,6.76256277673596e-2],["List",0.8464621671852589,6.793221536513121e-2],["List",0.8491181145231683,6.783042044278022e-2],["List",0.8513445728195599,6.813529972715507e-2],["List",0.8502088560357073,7.051737580822556e-2],["List",0.8540561995732068,7.029536199527726e-2],["List",0.8529137454947173,7.26008253821282e-2],["List",0.844854886470835,7.763850135926319e-2],["List",0.8466419248175513,7.831318393181297e-2],["List",0.8506819598445997,7.838334614826148e-2],["List",0.8498819150228673,8.014051858600439e-2],["List",0.8491305206185311,8.168384384909148e-2],["List",0.8479313855584392,8.317913659308232e-2],["List",0.8523221113475363,8.41039291530075e-2],["List",0.8520708542145913,8.557863348381387e-2],["List",0.8534133615060219,8.717088757632017e-2]]]],["List",["List",["List",0.7913972436682832,0.8506963908585763],["List",5.090794170695196e-2,0.12343383344568842]],["List",0.8210468172634298,8.717088757632019e-2,0.15027539262444534],["List"]],"'BubbleChartBubble'"],0.15027539262444534],["Style",0.15027539262444534,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",0.8776027611814117,0.5312175627613234],["List",0.8857507275007133,0.5328753748460985],["List",0.8830467988261458,0.5344157037049048],["List",0.873363457158338,0.5345808878907347],["List",0.876328853397453,0.5362424812064821],["List",0.8807387548401017,0.5386691394564019],["List",0.8765575042945336,0.5389468343763848],["List",0.8760553947698247,0.5402032094456548],["List",0.880695326284675,0.5434717361149921],["List",0.8813007508092108,0.5453362391372935],["List",0.8765051525299068,0.5446986279799942],["List",0.8724005886746297,0.543851818443831],["List",0.8763008872901559,0.5475522699718326],["List",0.8726731231166799,0.5467402677992184],["List",0.8723313392395677,0.5478980934667589],["List",0.8713562111066193,0.5486821888034943],["List",0.8766077373459588,0.5549587041386943],["List",0.8759475631010022,0.5562555338587128],["List",0.8703993396632244,0.5525923387287017],["List",0.8713056930092162,0.5553341598341571],["List",0.8670104254679167,0.552111746903655],["List",0.8685704312919381,0.5559782155966234],["List",0.8695732118119396,0.5594009158899721],["List",0.8673075687769495,0.5583082795610314],["List",0.868142362079527,0.561994884817709],["List",0.8668338869860819,0.5621607838356114],["List",0.8662439956889173,0.5638982450993171],["List",0.8637613329669235,0.5614165396273192],["List",0.8619269116401506,0.5601196989774572],["List",0.8610265212492524,0.560867652849154],["List",0.8604851642123672,0.5625094104018838],["List",0.8589573969399084,0.5614048795459804],["List",0.8594104486537104,0.5672363465300856],["List",0.8564048660314908,0.5592238538012382],["List",0.8561227805200287,0.5629783929690284],["List",0.8555076698316163,0.5656347013297545],["List",0.8545465093917988,0.567540648380888],["List",0.8533090623304128,0.56671437280966],["List",0.85236502087763,0.5694314177791969],["List",0.8509868499967578,0.5657048747471906],["List",0.8499115100368252,0.5652756090150937],["List",0.8486836709204364,0.5671386413947653],["List",0.8478821481391066,0.5616793645237524],["List",0.8460972784339289,0.569626191420316],["List",0.8447105001501096,0.5701073643219936],["List",0.8448135088692088,0.562119534382759],["List",0.8431981551231758,0.5651369851449999],["List",0.8413673706181877,0.5677057782526383],["List",0.8418541981119367,0.5613640857229887],["List",0.8383529454737928,0.5689103110045891],["List",0.8398540100321215,0.5604746639270866],["List",0.837802585324028,0.5629583577658552],["List",0.8387085609178325,0.5577519995674802],["List",0.8376405316288698,0.5577224680912654],["List",0.8344485512308949,0.5615284516693025],["List",0.8329585638641841,0.5615991817047427],["List",0.8351018658854243,0.5557528475033905],["List",0.8318258989456383,0.5586758938481462],["List",0.8301345137461519,0.558965584736833],["List",0.831079393359116,0.5557247413995711],["List",0.827150961831418,0.558462013533965],["List",0.8328971683941148,0.5501367992560626],["List",0.8267328625815242,0.5548518139901985],["List",0.8261143106894708,0.5535352488041845],["List",0.8278531887853735,0.5503350828929837],["List",0.8236942436623252,0.5519811580980644],["List",0.8260411661155205,0.5485787007173144],["List",0.8234722592038691,0.548816556848146],["List",0.8245374257694273,0.5464994889410993],["List",0.8293020082558942,0.5424733581207041],["List",0.8236232491127169,0.5439760310311251],["List",0.8236918953791724,0.542526091123424],["List",0.8226363541539017,0.5415715199285549],["List",0.8212532527619844,0.5405287977561315],["List",0.8232697296399929,0.5385484267095737],["List",0.8233824011649078,0.5371081317487352],["List",0.8190049873837126,0.536486254326697],["List",0.82353819184424,0.534467531092412],["List",0.8203421912116227,0.5333511128331215],["List",0.8186776320890943,0.5319913892000039],["List",0.8181538330881231,0.5305324124448068],["List",0.8249938055752107,0.5294222789674597],["List",0.8223854215323574,0.5279352501949072],["List",0.8170930884785202,0.5256167301431881],["List",0.8218349861993695,0.5249826684792799],["List",0.8142015004234127,0.5215708741859384],["List",0.8196774076365879,0.5214258757660052],["List",0.8188968798529999,0.5195947021791205],["List",0.8244682749756479,0.5203676155937785],["List",0.8231466177467461,0.5182815067553265],["List",0.8274874333480813,0.5191319931097745],["List",0.8196957595808401,0.5131085170516072],["List",0.8259825996599999,0.5154203650046699],["List",0.8245071827759382,0.5129022013271043],["List",0.8257430927899808,0.5121086481049676],["List",0.8240966371807582,0.5090585509157284],["List",0.8271415670412136,0.5098738868091932],["List",0.8288430685052426,0.5097342270325765],["List",0.8295806827545561,0.5088259566255189],["List",0.8283659165730521,0.5054622851394865],["List",0.8319386960777055,0.507977896278482],["List",0.8321439773261976,0.5064382486317823],["List",0.8317768811252031,0.5037510407255305],["List",0.831549184538277,0.5011407976426788],["List",0.8355594850499364,0.5054984088882617],["List",0.835922591311103,0.5038316033497642],["List",0.8373195498493808,0.5043327079359972],["List",0.83716728491999,0.5012501345862079],["List",0.8365199847730381,0.49660519025031924],["List",0.8382833169498876,0.4975922558489685],["List",0.8390778575173915,0.4959636853848005],["List",0.84074583420457,0.4975142002021884],["List",0.8425462591344669,0.49980708895866977],["List",0.8429738844642772,0.4967435780965783],["List",0.8452938252779598,0.5036252157644658],["List",0.8453391489024865,0.4971022785973386],["List",0.8461097171549918,0.4941501137947706],["List",0.8478095162177459,0.5000104957485687],["List",0.8486009416688616,0.4938004672434795],["List",0.8498367613509807,0.5020884125473325],["List",0.8511183199975195,0.4896484920876165],["List",0.8517065522704759,0.5025121108891331],["List",0.8532990620696038,0.49440128908004916],["List",0.8547924174073034,0.4923617144433344],["List",0.8556243974357902,0.4950515491146226],["List",0.8559749638844234,0.49996044458210037],["List",0.8581924898567529,0.494665335255952],["List",0.8592330778343676,0.49538559406152316],["List",0.8591327468166164,0.5002979839963627],["List",0.8608369864794213,0.4984698957048188],["List",0.8596366148480074,0.5052957962303078],["List",0.8636290210506737,0.498107037131403],["List",0.8676940688889001,0.49195418908461463],["List",0.8616692712819276,0.5077476934503721],["List",0.8671117638833187,0.4995221437587486],["List",0.8684868624093921,0.4996195858207961],["List",0.8690393465876624,0.5013326431683813],["List",0.8714174196031342,0.5001041753862672],["List",0.8691397078825606,0.5056527417747327],["List",0.8703985840267521,0.5060887980737799],["List",0.8699327082186095,0.508455385931874],["List",0.869277406061273,0.5109508421386417],["List",0.8727429530906698,0.5090811585627154],["List",0.8716358175610769,0.5118980390672354],["List",0.8726483320365609,0.5126678376308534],["List",0.8710346714548364,0.5153741100190605],["List",0.8756045892819012,0.5136486626860531],["List",0.8725785719513529,0.5170975274745506],["List",0.8767528163780858,0.515999611612777],["List",0.8757919951376578,0.5180852845699288],["List",0.8761245436880679,0.5193208314732322],["List",0.8808190373837173,0.5189199702015684],["List",0.8800536725454183,0.5208530796375231],["List",0.8753739720976047,0.5237245768775584],["List",0.8757239266307496,0.5249712388651314],["List",0.8789866593729855,0.525574533689879],["List",0.8775479627037128,0.5271428425740801],["List",0.8840401087357687,0.5278897343535136],["List",0.8802943489196902,0.5296681267366212],["List",0.8814352070364778,0.5312175627613234]]]],["List",["List",["List",0.8211352166475301,0.8790739717780522],["List",0.49578653144658247,0.5666485940760643]],["List",0.8501045942127912,0.5312175627613234,0.14345949429248317],["List"]],"'BubbleChartBubble'"],0.14345949429248317],["Style",0.14345949429248317,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.3]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Annotation",["Polygon",["List",["List",["List",1.0050845524583953,0.43392157209245136],["List",1.0056314761980656,0.4343902709561982],["List",1.0028624503349077,0.4346311445921273],["List",1.0069206972164575,0.435565306804072],["List",1.0052852794296236,0.43578630082240005],["List",1.005457617427025,0.43633067653734436],["List",1.003838302995297,0.4363422917608564],["List",1.003583178060391,0.43670188593508363],["List",1.003964676081832,0.43729093752446807],["List",1.0046356043867661,0.43803190337692943],["List",1.0048347927220969,0.43866090339080394],["List",1.0049061912883182,0.43922134099587834],["List",1.0037143710369556,0.43901025261526533],["List",1.004154972561213,0.43983765518263684],["List",1.0035972579085908,0.43995814017863466],["List",1.0032401481361815,0.4402384327297666],["List",1.0034106859148073,0.44095988043254575],["List",1.0023287083875223,0.4404856837842005],["List",1.0028669682310039,0.4416241867174605],["List",1.0033276525107306,0.44276473711649983],["List",1.002248645563206,0.44219614232535787],["List",1.002218246137571,0.44285819066534327],["List",1.0020310161403192,0.44329854086091014],["List",1.0019194099844349,0.44394632779389187],["List",1.0006344312347526,0.44259092707883385],["List",1.0010453631439906,0.44407946009494964],["List",1.0001750444880089,0.44327963172729146],["List",1.0005484506522724,0.4449667263307099],["List",0.9999155670013342,0.44458542978752885],["List",0.999183460502416,0.4437757921042668],["List",0.9992742643926528,0.44513751888919667],["List",0.999104319255323,0.446029386574331],["List",0.9979949408832348,0.4433710866589259],["List",0.9979773106714489,0.4446957819861861],["List",0.9979014441134261,0.44631250747015255],["List",0.9974117040083652,0.4457578355011507],["List",0.996868285368591,0.4446725925801281],["List",0.9965837880950196,0.4453337762965766],["List",0.9961380151215032,0.443802244192365],["List",0.9958555551458051,0.4457267967087902],["List",0.9954936810847039,0.44448243133151943],["List",0.9950886167675652,0.4456752157848963],["List",0.9947110001953908,0.4454699689876437],["List",0.99445077480083,0.444491294285045],["List",0.9937961598249428,0.44659185322324224],["List",0.993509456635906,0.4458598828069806],["List",0.993015109759453,0.4463885672603954],["List",0.9927744093167917,0.44552777718299247],["List",0.9920837329995594,0.44660011742934846],["List",0.9917061382488643,0.4462619385122424],["List",0.9915291159713265,0.4454080758398692],["List",0.9913513531272664,0.4447637995125326],["List",0.9914799616711214,0.44340649198231985],["List",0.9909637955074256,0.4436817203724581],["List",0.9901064515342478,0.4444674360987626],["List",0.9897842344041634,0.44414441950220496],["List",0.9895951929377014,0.44366580446586484],["List",0.9892025867126175,0.44346202036051696],["List",0.9890068798332988,0.4430180423287821],["List",0.9896443766283299,0.44153343660732264],["List",0.9893684573147892,0.4412628740525841],["List",0.9885281716827257,0.4416458453205031],["List",0.987510212400108,0.44205525877899016],["List",0.987885667881898,0.44105485427776],["List",0.9883389707026443,0.4401200538383471],["List",0.987333352660668,0.4403842247502066],["List",0.9891825424609063,0.43851809091564836],["List",0.9874794481776475,0.4392570460713199],["List",0.9851012678827877,0.4401690787868622],["List",0.9865879514403678,0.4387726507698009],["List",0.9867825263466744,0.43814737218682914],["List",0.9859712554063377,0.438024208084218],["List",0.9861882172448129,0.437451768763899],["List",0.9861790406980849,0.43694702209015834],["List",0.986545369399432,0.4363824666240707],["List",0.9853861945800776,0.4361628375666485],["List",0.9851412750832647,0.43568555204745824],["List",0.9860690017459303,0.4350818531177623],["List",0.986274003903288,0.4345867866431478],["List",0.9858737879182828,0.43415991706632623],["List",0.9856256921244197,0.43370867959567355],["List",0.9849744249667093,0.43316522237593874],["List",0.9852856776162295,0.4327057213102724],["List",0.9858419532509337,0.4322738724253891],["List",0.9857994997551821,0.4317703044342739],["List",0.9865190205347896,0.431494112061013],["List",0.9867897684113089,0.43110132318459987],["List",0.9865144163254286,0.43055507658317954],["List",0.9853348725878739,0.42959676453574464],["List",0.9866977258276676,0.4296720141972989],["List",0.9879306465675105,0.4298482415679928],["List",0.9871035602318117,0.4288894386758172],["List",0.9873197560527841,0.42852935939497006],["List",0.9876163842363492,0.4282423993080229],["List",0.9871927406134426,0.42736343531642873],["List",0.9859729006465812,0.42575877029842696],["List",0.9867533423006714,0.42574195130194403],["List",0.9885495994749612,0.42684454967533364],["List",0.9879157512957113,0.425588723001583],["List",0.9881966083143148,0.42520530301596776],["List",0.9888762572773215,0.4253792950062555],["List",0.9900964921714416,0.42639275302213514],["List",0.9880713522678273,0.4227084959235058],["List",0.9891753666585543,0.4235830655056293],["List",0.9908690890307384,0.42563834374946286],["List",0.9903181219066947,0.42381176489874817],["List",0.9909703902050822,0.42428393031334777],["List",0.9911885609725851,0.4238106908630923],["List",0.9915508160553261,0.42372295450364933],["List",0.991896056086585,0.4235179187756075],["List",0.9912453870074729,0.4201478170223366],["List",0.9924196382390712,0.422635517153756],["List",0.9926308763921905,0.42177568688094325],["List",0.9929938736220388,0.42154659607281064],["List",0.9934358331549404,0.4217753074892629],["List",0.9938018781703344,0.4213815270278194],["List",0.9942708075366788,0.4220192990258751],["List",0.9947181188172928,0.4225618432626137],["List",0.9950615987425284,0.42167970459827425],["List",0.9954519705823752,0.42287355599186593],["List",0.995841028678594,0.42213329613649775],["List",0.996267766917067,0.4211235958686383],["List",0.9966799996370548,0.4209392683000046],["List",0.9968948976374341,0.4228036042749912],["List",0.9973039992509024,0.42245256763533306],["List",0.9974381330098793,0.4238870205704191],["List",0.9983165329535423,0.42143463347369625],["List",0.9982793879826279,0.42322187401146866],["List",0.9984561672078267,0.4239807127007205],["List",0.9995509940427398,0.421724211867246],["List",0.9996300387518517,0.4228358112602289],["List",1.0004100087787169,0.4220319895234362],["List",1.000799795181915,0.4222108670006479],["List",1.0001351025238492,0.42462357284530805],["List",1.0012299483012503,0.42334275635564184],["List",1.0013554455848503,0.4239484799343116],["List",1.002127835006567,0.42354531405262674],["List",1.0021133697909663,0.4243452674924937],["List",1.0023392422592663,0.42480815551785495],["List",1.0020834085067467,0.4258360653294054],["List",1.0024884840326247,0.4259604459443843],["List",1.0021980102473682,0.42689801439779335],["List",1.0039147635895354,0.42574575294957306],["List",1.0027699273737927,0.42744646822545385],["List",1.0051207058340403,0.42604940604226366],["List",1.0038318934775905,0.42765511220546726],["List",1.0040619525986139,0.4280594840981431],["List",1.003230229737374,0.4290984410147531],["List",1.0059556797039968,0.42798124899578766],["List",1.0049140692524408,0.429136156149782],["List",1.0065431974970867,0.42889693349169133],["List",1.004585358644887,0.43030537563065635],["List",1.0051446190846092,0.43060239020964897],["List",1.0050650956377887,0.43110116820728034],["List",1.0042903924323436,0.43179141798060533],["List",1.005162433701441,0.43204417203587586],["List",1.004473326541187,0.43259718731038976],["List",1.0040215649541413,0.43309117097040256],["List",1.0040830284475066,0.4334838117990684],["List",1.0045311719204895,0.43392157209245136]]]],["List",["List",["List",0.985924128351741,1.0051829784905393],["List",0.42214429243194646,0.44569885175295626]],["List",0.9955535534211402,0.4339215720924514,1.5850818153139157e-2],["List"]],"'BubbleChartBubble'"],1.5850818153139157e-2],["Style",1.5850818153139157e-2,["List"]]]]]],["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"]],["List"],["List"]],["List",["Rule","AspectRatio",1],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",0.2061136139132348,-2.1032442241861876e-2]],["Rule","Frame",true],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List",0.2061136139132348,1.0179299858602446],["List",-2.1032442241861876e-2,0.9718605266000355]]],["Rule","PlotRangeClipping",true],["Rule","PlotRangePadding",["List",["List",["Scaled",5.0e-2],["Scaled",5.0e-2]],["List",["Scaled",5.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","Automatic","Automatic"]]]]]],
	["Rule","'bc6440fb-800a-4b9a-885c-967b69a33838'",["Hold",["Graphics",["List",["List",["Opacity",0],["Point",["List",["List",-0.4116533139111435,0],["List",4.35360524399126,0]]]],["List",["List"],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.6789999999999999]]],["RGBColor",0.982864,0.7431472,0.3262672]],["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.6789999999999999]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Rectangle",["List",0.5487982520029133,0],["List",1.4512017479970867,1],["Rule","'RoundingRadius'",0]],1],["Style",1,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.6789999999999999]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Rectangle",["List",1.5487982520029133,0],["List",2.4512017479970867,2],["Rule","'RoundingRadius'",0]],2],["Style",2,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.6789999999999999]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Rectangle",["List",2.5487982520029133,0],["List",3.4512017479970867,3],["Rule","'RoundingRadius'",0]],3],["Style",3,["List"]]]]]],["List"],["List"]],["List"],["List"],["List"],["List"],["List",["Style",["List",["Rule","Antialiasing",false],["List",["Directive",["Thickness","Tiny"]],["List",["Line",["List",["List",-0.4116533139111435,0],["List",4.430862345229425,0]]]],["Style",["List"],"'GraphicsLabel'"]],["Style",["List",["List",["Directive",["Thickness","Tiny"]],["Line",["List",["List",0.5487982520029133,0],["Offset",["List",-1.102182119232618e-15,-6],["List",0.5487982520029133,0]]]],["Line",["List",["List",3.4512017479970867,0],["Offset",["List",-1.102182119232618e-15,-6],["List",3.4512017479970867,0]]]],["List",["List"],["List"],["List"],["List"],["List"]]],["Style",["List"],"'GraphicsLabel'"]],"'GraphicsTicks'"]],"'GraphicsAxes'"]]],["List",["Rule","AspectRatio",["Power","GoldenRatio",-1]],["Rule","Axes",["List",false,true]],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",-0.4116533139111435,0]],["Rule","CoordinatesToolOptions",["List",["Rule","'DisplayFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]],["Rule","'CopiedValueFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]]]],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List","All","All"],["List","All","All"]]],["Rule","PlotRangePadding",["List",["List",["Scaled",2.0e-2],["Scaled",2.0e-2]],["List",["Scaled",2.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","None","Automatic"]]]]]],
	["Rule","'37f38a18-eaa6-44bf-aa2f-bcd29fc1b204'",["Hold",["Graphics",["List",["List",["Opacity",0],["Point",["List",["List",0.574231609613984,0],["List",9.231973780043699,0]]]],["List",["List"],["List",["List",["List"],["List",["List"],["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Rectangle",["List",0.7439912600145666,0],["List",1.64639475600874,1],["Rule","'RoundingRadius'",0]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Rectangle",["List",1.7439912600145666,0],["List",2.64639475600874,2],["Rule","'RoundingRadius'",0]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.4992,0.5552,0.8309304]],["Rectangle",["List",2.7439912600145666,0],["List",3.64639475600874,3],["Rule","'RoundingRadius'",0]]]]],["List"],["List"]],["List",["List"],["List",["List"],["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Rectangle",["List",4.0367807720320465,0],["List",4.93918426802622,1],["Rule","'RoundingRadius'",0]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Rectangle",["List",5.0367807720320465,0],["List",5.93918426802622,3],["Rule","'RoundingRadius'",0]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.4992,0.5552,0.8309304]],["Rectangle",["List",6.0367807720320465,0],["List",6.93918426802622,2],["Rule","'RoundingRadius'",0]]]]],["List"],["List"]],["List",["List"],["List",["List"],["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Rectangle",["List",7.3295702840495265,0],["List",8.231973780043699,5],["Rule","'RoundingRadius'",0]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Rectangle",["List",8.329570284049526,0],["List",9.231973780043699,2],["Rule","'RoundingRadius'",0]]]]],["List"],["List"]]],["List"],["List"]],["List"],["List",["Text",["Style",1,["List"]],["Offset",["List",0,4],["List",1.1951930080116533,1]],["ImageScaled",["List",0.5,0]]],["Text",["Style",2,["List"]],["Offset",["List",0,4],["List",2.1951930080116533,2]],["ImageScaled",["List",0.5,0]]],["Text",["Style",3,["List"]],["Offset",["List",0,4],["List",3.1951930080116533,3]],["ImageScaled",["List",0.5,0]]],["Text",["Style",1,["List"]],["Offset",["List",0,4],["List",4.487982520029133,1]],["ImageScaled",["List",0.5,0]]],["Text",["Style",3,["List"]],["Offset",["List",0,4],["List",5.487982520029133,3]],["ImageScaled",["List",0.5,0]]],["Text",["Style",2,["List"]],["Offset",["List",0,4],["List",6.487982520029133,2]],["ImageScaled",["List",0.5,0]]],["Text",["Style",5,["List"]],["Offset",["List",0,4],["List",7.780772032046613,5]],["ImageScaled",["List",0.5,0]]],["Text",["Style",2,["List"]],["Offset",["List",0,4],["List",8.780772032046613,2]],["ImageScaled",["List",0.5,0]]]],["List"],["List"],["List",["Style",["List",["Rule","Antialiasing",false],["List",["Directive",["Thickness","Tiny"]],["List",["Line",["List",["List",0.574231609613984,0],["List",9.405128623452294,0]]]],["Style",["List"],"'GraphicsLabel'"]],["Style",["List",["List",["Directive",["Thickness","Tiny"]],["Line",["List",["List",0.7439912600145666,0],["Offset",["List",-1.102182119232618e-15,-6],["List",0.7439912600145666,0]]]],["Line",["List",["List",9.231973780043699,0],["Offset",["List",-1.102182119232618e-15,-6],["List",9.231973780043699,0]]]],["List",["List"],["List"],["List"],["List",["Line",["List",["List",1.64639475600874,0],["Offset",["List",-7.347880794884119e-16,-4],["List",1.64639475600874,0]]]],["Line",["List",["List",1.7439912600145666,0],["Offset",["List",-7.347880794884119e-16,-4],["List",1.7439912600145666,0]]]],["Line",["List",["List",2.64639475600874,0],["Offset",["List",-7.347880794884119e-16,-4],["List",2.64639475600874,0]]]],["Line",["List",["List",2.7439912600145666,0],["Offset",["List",-7.347880794884119e-16,-4],["List",2.7439912600145666,0]]]]],["List"],["List"],["List"],["List",["Line",["List",["List",4.93918426802622,0],["Offset",["List",-7.347880794884119e-16,-4],["List",4.93918426802622,0]]]],["Line",["List",["List",5.0367807720320465,0],["Offset",["List",-7.347880794884119e-16,-4],["List",5.0367807720320465,0]]]],["Line",["List",["List",5.93918426802622,0],["Offset",["List",-7.347880794884119e-16,-4],["List",5.93918426802622,0]]]],["Line",["List",["List",6.0367807720320465,0],["Offset",["List",-7.347880794884119e-16,-4],["List",6.0367807720320465,0]]]]],["List"],["List"],["List",["Line",["List",["List",8.231973780043699,0],["Offset",["List",-7.347880794884119e-16,-4],["List",8.231973780043699,0]]]],["Line",["List",["List",8.329570284049526,0],["Offset",["List",-7.347880794884119e-16,-4],["List",8.329570284049526,0]]]]],["List",["Line",["List",["List",3.64639475600874,0],["Offset",["List",-1.102182119232618e-15,-6],["List",3.64639475600874,0]]]],["Line",["List",["List",4.0367807720320465,0],["Offset",["List",-1.102182119232618e-15,-6],["List",4.0367807720320465,0]]]],["Line",["List",["List",6.93918426802622,0],["Offset",["List",-1.102182119232618e-15,-6],["List",6.93918426802622,0]]]],["Line",["List",["List",7.3295702840495265,0],["Offset",["List",-1.102182119232618e-15,-6],["List",7.3295702840495265,0]]]]]]],["Style",["List",["Directive",["Thickness","Tiny"]],["Directive",["Thickness","Tiny"]],["Style",["List",["Text","'a'",["Offset",["List",0,-2],["List",1.1951930080116533,0]],["List",0,1],["List",1,0]],["Text","'b'",["Offset",["List",0,-2],["List",2.1951930080116533,0]],["List",0,1],["List",1,0]],["Text","'c'",["Offset",["List",0,-2],["List",3.1951930080116533,0]],["List",0,1],["List",1,0]],["Text","'a'",["Offset",["List",0,-2],["List",4.487982520029133,0]],["List",0,1],["List",1,0]],["Text","'b'",["Offset",["List",0,-2],["List",5.487982520029133,0]],["List",0,1],["List",1,0]],["Text","'c'",["Offset",["List",0,-2],["List",6.487982520029133,0]],["List",0,1],["List",1,0]],["Text","'a'",["Offset",["List",0,-2],["List",7.780772032046612,0]],["List",0,1],["List",1,0]],["Text","'b'",["Offset",["List",0,-2],["List",8.780772032046613,0]],["List",0,1],["List",1,0]]],["List"]]],"'GraphicsLabel'"]],"'GraphicsTicks'"]],"'GraphicsAxes'"]]],["List",["Rule","AspectRatio",["Power","GoldenRatio",-1]],["Rule","Axes",["List",false,true]],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",0.574231609613984,0]],["Rule","CoordinatesToolOptions",["List",["Rule","'DisplayFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]],["Rule","'CopiedValueFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]]]],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List","All","All"],["List","All","All"]]],["Rule","PlotRangePadding",["List",["List",["Scaled",2.0e-2],["Scaled",2.0e-2]],["List",["Scaled",2.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","None","Automatic"]]]]]],
	["Rule","'04343707-6532-46f9-ad2d-ca2228fb2f46'",["Hold",["EditorView","'(*GB[*){{(*VB[*)(FrontEndRef[\"be015f7a-923d-405f-9e23-fa69166e4f4e\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKJ6UaGJqmmSfqWhoZp+iaGJim6VqmGhnrpiWaWRqamaWapJmkAgCE3BWt\"*)(*]VB*)(*|*),(*|*)(*GB[*){{(*VB[*)(RGBColor[0.982864, 0.7431472, 0.3262672])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs\/JLwouTyxJzghJzS3ISSxJTWMGyXMgyRcd8+U1mV\/83r5o+VLmxXeOP7cv2lNVcKn\/4RV7AJpFH3g=\"*)(*]VB*)(*|*),(*|*)(*VB[*)(\"a\")(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5Kdh4AkDCM68ktSgvMSchKLE8JLWiJBgkkwgAniYOGg==\"*)(*]VB*)}(*||*),(*||*){(*VB[*)(RGBColor[0.784, 0.47519999999999996, 0.2])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs\/JLwouTyxJzghJzS3ISSxJTWMGyXMgyRd58TBpt4u9tC96d\/Kw09rMe\/ZFs2aCwEl7AH\/rHgQ=\"*)(*]VB*)(*|*),(*|*)(*VB[*)(\"b\")(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5Kdh4AkDCM68ktSgvMSchKLE8JLWiJBgkkwQAnicOGw==\"*)(*]VB*)}(*||*),(*||*){(*VB[*)(RGBColor[0.4992, 0.5552, 0.8309304])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs\/JLwouTyxJzghJzS3ISSxJTWMGyXMgyRfdK+zqe\/Lpvn1R+\/LwU0ZHHtoXMQmtiPw97ZU9ALZsH70=\"*)(*]VB*)(*|*),(*|*)(*VB[*)(\"c\")(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5Kdh4AkDCM68ktSgvMSchKLE8JLWiJBgkkwwAnigOHA==\"*)(*]VB*)}}(*]GB*)}}(*]GB*)'"]]],
	["Rule","'199a2580-954b-4151-8652-904912b8ba92'",["Hold",["Graphics",["List",["List"],["List"],["DynamicModule",["List",["Set","DynamicChart`click$515906",false],["Set","DynamicChart`click$515912",false],["Set","DynamicChart`click$515918",false]],["List",["List",["Directive",["RGBColor",0.5,0.5,1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]]],["List",["List",["List",["List",["List",["List"],["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",1.0471975511965979,3.141592653589793]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",1,1]],["Style",["List",1,1],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.10000000000000005],["List",0,1,0.17320508075688773],["List",0,0,1]]]],["Dynamic","DynamicChart`click$515906"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2,["List",-1.0471975511965974,1.0471975511965979]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",1,2]],["Style",["List",1,2],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.4],["List",0,1,8.881784197001253e-17],["List",0,0,1]]]],["Dynamic","DynamicChart`click$515912"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.4992,0.5552,0.8309304]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],3,["List",-3.141592653589793,-1.0471975511965974]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",1,3]],["Style",["List",1,3],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.29999999999999993],["List",0,1,-0.5196152422706632],["List",0,0,1]]]],["Dynamic","DynamicChart`click$515918"]]]]]]],["List"]],["List",["List"]]]],["List",["List",["List",["List",["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",1,1]],["Style",["List",1,1],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.10000000000000005],["List",0,1,0.17320508075688773],["List",0,0,1]]]],["Dynamic","DynamicChart`click$515906"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",1,2]],["Style",["List",1,2],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.4],["List",0,1,8.881784197001253e-17],["List",0,0,1]]]],["Dynamic","DynamicChart`click$515912"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",1,3]],["Style",["List",1,3],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.29999999999999993],["List",0,1,-0.5196152422706632],["List",0,0,1]]]],["Dynamic","DynamicChart`click$515918"]]],["List"]]],["List"]],["List"],["List"]],["RuleDelayed","DynamicModuleValues",["List"]]],["List",["List",["List"],["List"]]],["List",["List",["List",["List"],["List"],["List"],["List"]]],["List"]]],["List",["Rule","ContentSelectable",false],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List",-3,3],["List",-3,3]]],["Rule","PlotRangePadding",["Scaled",5.0e-2]]]]]],
	["Rule","'e3409c35-8582-4b3f-a317-13e8585a18d7'",["Hold",["Graphics",["List",["List"],["List"],["DynamicModule",["List",["Set","DynamicChart`click$516246",false],["Set","DynamicChart`click$516252",false],["Set","DynamicChart`click$516258",false]],["List",["List",["Directive",["RGBColor",0.5,0.5,1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]]],["List",["List",["List",["List",["List",["List"],["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Polygon",["List",["List",0.4999999999999999,0.8660254037844387],["List",0.4112871031306115,0.9115058523116731],["List",0.31848665025168443,0.9479273461671318],["List",0.22252093395631445,0.9749279121818236],["List",0.12434370464748506,0.9922392066001721],["List",2.4930691738072813e-2,0.9996891820008162],["List",-7.473009358642427e-2,0.9972037971811801],["List",-0.17364817766693053,0.984807753012208],["List",-0.2708404681430052,0.962624246950012],["List",-0.3653410243663951,0.9308737486442042],["List",-0.45621065735316296,0.8898718088114685],["List",-0.5425462638657594,0.8400259231507715],["List",-0.6234898018587335,0.7818314824680299],["List",-0.6982368180860727,0.7158668492597186],["List",-0.7660444431189779,0.6427876096865395],["List",-0.826238774315995,0.5633200580636218],["List",-0.8782215733702284,0.47825397862131847],["List",-0.9214762118704077,0.3884347962746946],["List",-0.9555728057861406,0.2947551744109046],["List",-0.9801724878485438,0.1981461431993976],["List",-0.9950307753654014,9.956784659581673e-2],["List",-1,1.2246467991473532e-16],["List",-2,2.4492935982947064e-16],["List",-1.9900615507308028,0.19913569319163346],["List",-1.9603449756970877,0.3962922863987952],["List",-1.9111456115722816,0.5895103488218084],["List",-1.8429524237408155,0.7768695925493893],["List",-1.7564431467404569,0.9565079572426369],["List",-1.65247754863199,1.1266401161272437],["List",-1.5320888862379558,1.285575219373079],["List",-1.3964736361721455,1.431733698519437],["List",-1.246979603717467,1.5636629649360598],["List",-1.0850925277315189,1.680051846301543],["List",-0.9124213147063259,1.779743617622937],["List",-0.7306820487327902,1.8617474972884085],["List",-0.5416809362860104,1.925248493900024],["List",-0.3472963553338606,1.969615506024416],["List",-0.14946018717284854,1.9944075943623603],["List",4.9861383476145625e-2,1.9993783640016325],["List",0.24868740929497013,1.9844784132003441],["List",0.44504186791262845,1.9498558243636472],["List",0.6369733005033689,1.8958546923342636],["List",0.822574206261223,1.8230117046233463],["List",0.9999999999999998,1.7320508075688774]]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",1,1]],["Style",["List",1,1],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.10000000000000005],["List",0,1,0.17320508075688773],["List",0,0,1]]]],["Dynamic","DynamicChart`click$516246"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Polygon",["List",["List",0.5000000000000003,-0.8660254037844385],["List",0.5837436722347901,-0.8119380057158563],["List",0.6616858375968596,-0.749781202967734],["List",0.7330518718298265,-0.6801727377709191],["List",0.7971325072229227,-0.6038044103254772],["List",0.8532908816321558,-0.5214352033794978],["List",0.9009688679024193,-0.4338837391175579],["List",0.9396926207859085,-0.34202014332566844],["List",0.969077286229078,-0.2467573976902934],["List",0.9888308262251285,-0.14904226617617425],["List",0.9987569212189223,-4.984588566069691e-2],["List",0.9987569212189223,4.984588566069736e-2],["List",0.9888308262251285,0.14904226617617458],["List",0.969077286229078,0.24675739769029373],["List",0.9396926207859083,0.342020143325669],["List",0.900968867902419,0.4338837391175583],["List",0.8532908816321556,0.5214352033794982],["List",0.7971325072229224,0.6038044103254775],["List",0.7330518718298263,0.6801727377709195],["List",0.6616858375968593,0.7497812029677343],["List",0.5837436722347897,0.8119380057158566],["List",0.4999999999999999,0.8660254037844387],["List",1.4999999999999996,2.598076211353316],["List",1.7512310167043692,2.4358140171475697],["List",1.9850575127905778,2.249343608903203],["List",2.1991556154894787,2.040518213312758],["List",2.3913975216687673,1.8114132309764326],["List",2.559872644896467,1.5643056101384947],["List",2.702906603707257,1.3016512173526749],["List",2.819077862357725,1.0260604299770066],["List",2.9072318586872337,0.7402721930708815],["List",2.9664924786753857,0.4471267985285241],["List",2.996270763656767,0.14953765698209207],["List",2.996270763656767,-0.14953765698209073],["List",2.966492478675386,-0.44712679852852244],["List",2.907231858687234,-0.7402721930708799],["List",2.8190778623577253,-1.0260604299770058],["List",2.702906603707258,-1.3016512173526738],["List",2.5598726448964673,-1.5643056101384933],["List",2.391397521668768,-1.8114132309764315],["List",2.1991556154894796,-2.0405182133127573],["List",1.9850575127905787,-2.249343608903202],["List",1.75123101670437,-2.435814017147569],["List",1.5000000000000009,-2.5980762113533156]]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",1,2]],["Style",["List",1,2],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.4],["List",0,1,8.881784197001253e-17],["List",0,0,1]]]],["Dynamic","DynamicChart`click$516252"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.4992,0.5552,0.8309304]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Polygon",["List",["List",-1,-1.2246467991473532e-16],["List",-0.9950307753654014,-9.956784659581673e-2],["List",-0.9801724878485438,-0.1981461431993976],["List",-0.9555728057861408,-0.2947551744109042],["List",-0.9214762118704077,-0.3884347962746946],["List",-0.8782215733702284,-0.47825397862131847],["List",-0.8262387743159948,-0.5633200580636223],["List",-0.7660444431189779,-0.6427876096865395],["List",-0.6982368180860727,-0.7158668492597186],["List",-0.6234898018587335,-0.7818314824680299],["List",-0.5425462638657594,-0.8400259231507715],["List",-0.45621065735316296,-0.8898718088114685],["List",-0.3653410243663949,-0.9308737486442044],["List",-0.270840468143005,-0.9626242469500121],["List",-0.17364817766693008,-0.9848077530122081],["List",-7.473009358642405e-2,-0.9972037971811801],["List",2.4930691738073035e-2,-0.9996891820008162],["List",0.12434370464748527,-0.9922392066001721],["List",0.22252093395631445,-0.9749279121818236],["List",0.31848665025168466,-0.9479273461671317],["List",0.4112871031306117,-0.9115058523116731],["List",0.5000000000000003,-0.8660254037844385],["List",2.0000000000000013,-3.464101615137754],["List",1.6451484125224476,-3.646023409246692],["List",1.2739466010067393,-3.7917093846685264],["List",0.8900837358252587,-3.899711648727294],["List",0.497374818589942,-3.9689568264006883],["List",9.972276695229303e-2,-3.998756728003265],["List",-0.2989203743456962,-3.9888151887247205],["List",-0.6945927106677203,-3.9392310120488325],["List",-1.0833618725720193,-3.8504969878000486],["List",-1.4613640974655786,-3.7234949945768174],["List",-1.8248426294126503,-3.559487235245875],["List",-2.170185055463036,-3.360103692603087],["List",-2.493959207434934,-3.1273259298721197],["List",-2.7929472723442896,-2.8634673970388755],["List",-3.0641777724759116,-2.571150438746158],["List",-3.304955097263979,-2.253280232254489],["List",-3.5128862934809137,-1.9130159144852739],["List",-3.68590484748163,-1.55373918509878],["List",-3.8222912231445623,-1.1790206976436184],["List",-3.9206899513941753,-0.7925845727975904],["List",-3.9801231014616056,-0.3982713863832687],["List",-4,-4.898587196589413e-16]]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",1,3]],["Style",["List",1,3],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.29999999999999993],["List",0,1,-0.5196152422706632],["List",0,0,1]]]],["Dynamic","DynamicChart`click$516258"]]]]]]],["List"]],["List",["List"]]]],["List",["List",["List",["List",["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",1,1]],["Style",["List",1,1],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.10000000000000005],["List",0,1,0.17320508075688773],["List",0,0,1]]]],["Dynamic","DynamicChart`click$516246"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",1,2]],["Style",["List",1,2],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.4],["List",0,1,8.881784197001253e-17],["List",0,0,1]]]],["Dynamic","DynamicChart`click$516252"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",1,3]],["Style",["List",1,3],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.29999999999999993],["List",0,1,-0.5196152422706632],["List",0,0,1]]]],["Dynamic","DynamicChart`click$516258"]]],["List"]]],["List"]],["List"],["List"]],["RuleDelayed","DynamicModuleValues",["List"]]],["List",["List",["List"],["List"]]],["List",["List",["List",["List"],["List"],["List"],["List"]]],["List"]]],["List",["Rule","ContentSelectable",false],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List",-4,4],["List",-4,4]]],["Rule","PlotRangePadding",["Scaled",5.0e-2]]]]]],
	["Rule","'2a87b6f8-cea7-4c17-863d-070124d53f1e'",["Hold",["Graphics",["List",["List"],["List"],["DynamicModule",["List",["Set","DynamicChart`click$517073",false],["Set","DynamicChart`click$517079",false],["Set","DynamicChart`click$517085",false],["Set","DynamicChart`click$517091",false]],["List",["List",["Directive",["RGBColor",0.5,0.5,1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]]],["List",["List",["List",["List",["List",["List"],["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",2.5132741228718345,3.141592653589793]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.1902113032590307],["List",0,1,6.180339887498951e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517073"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.928,0.5210666666666667,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",1.256637061435917,2.5132741228718345]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-6.180339887498947e-2],["List",0,1,0.19021130325903074],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517079"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.7116405333333333,0.4816,0.5483194666666666]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",-0.6283185307179591,1.256637061435917]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],3],["Style",3,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.19021130325903074],["List",0,1,6.1803398874989424e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517085"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.4992,0.5552,0.8309304]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",-3.141592653589793,-0.6283185307179591]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],4],["Style",4,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-6.1803398874989514e-2],["List",0,1,-0.1902113032590307],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517091"]]]]]]],["List"]],["List",["List"]]]],["List",["List",["List",["List",["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.1902113032590307],["List",0,1,6.180339887498951e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517073"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-6.180339887498947e-2],["List",0,1,0.19021130325903074],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517079"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],3],["Style",3,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.19021130325903074],["List",0,1,6.1803398874989424e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517085"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],4],["Style",4,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-6.1803398874989514e-2],["List",0,1,-0.1902113032590307],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517091"]]],["List"]]],["List"]],["List"],["List"]],["RuleDelayed","DynamicModuleValues",["List"]]],["List",["List",["List"],["List"]]],["List",["List",["List",["List"],["List"],["List"],["List"]]],["List"]]],["List",["Rule","ContentSelectable",false],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List",-1,1],["List",-1,1]]],["Rule","PlotRangePadding",["Scaled",9.166666666666669e-2]]]]]],
	["Rule","'7f26095d-4a5a-4740-98ba-53418641c212'",["Hold",["Graphics",["List",["List"],["List"],["DynamicModule",["List",["Set","DynamicChart`click$517578",false],["Set","DynamicChart`click$517586",false],["Set","DynamicChart`click$517594",false],["Set","DynamicChart`click$517605",false],["Set","DynamicChart`click$517613",false],["Set","DynamicChart`click$517621",false]],["List",["List",["Directive",["RGBColor",0.5,0.5,1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]]],["List",["List",["List",["List",["List",["List",["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Polygon",["List",["List",1.0112712429686843,0.7347315653655915],["List",0.9356384352138764,0.828903322800994],["List",0.8512698234834964,0.9153358332472168],["List",0.758953134773389,0.9932220996421928],["List",0.6595503051326659,1.0618349189019012],["List",0.5539894319990517,1.1205336716196297],["List",0.44325610880316946,1.1687703033567685],["List",0.3283842227482336,1.2060944416794392],["List",0.2104463016837983,1.2321576011645634],["List",9.054350020220273e-2,1.246716437114364],["List",-3.020468154516537e-2,1.249635017600241],["List",-0.1506708503191539,1.2408860926225675],["List",-0.2697302459597578,1.22055134853659],["List",-0.3862712429686844,1.1888206453689418],["List",-0.49920572945711944,1.145990244145728],["List",-0.6074792665532577,1.0924600407831475],["List",-0.7100809334139446,1.0287298323670706],["List",-0.8060527659202134,0.9553946506823102],["List",-0.8944987009301517,0.8731392065611709],["List",-0.9745929425790278,0.7827314969228925],["List",-1.0455876725127835,0.6850156341933376],["List",-1.1068200320665125,0.5809039650547103],["List",-1.1577183111972207,0.4713685521104004],["List",-1.1978072863864577,0.3574320979983616],["List",-1.2267126576742668,0.24015839669213518],["List",-1.2441645433970607,0.12064240114314383],["List",-1.25,-4.0203066241915914e-16],["List",-2.25,2.755455298081545e-16],["List",-2.2394961781147096,0.2171563220576589],["List",-2.2080827838136803,0.43228511404584435],["List",-2.156053115495624,0.6433777763970508],["List",-2.083892960154997,0.8484633937987217],["List",-1.992276057719722,1.0456271370984795],["List",-1.8820578105230101,1.2330281415480076],["List",-1.7542672966422501,1.4089166944612064],["List",-1.6100976616742722,1.5716505718101084],["List",-1.4508949786563834,1.7197103712281592],["List",-1.2781456801451003,1.851713698260727],["List",-1.0934626797958629,1.966428073409666],["List",-0.8985703130228144,2.0627824394623104],["List",-0.695288237343631,2.1398771616640957],["List",-0.48551444272756356,2.196992427365862],["List",-0.2712075305744765,2.2335949667206214],["List",-5.436842678129716e-2,2.249343031680434],["List",0.1629783003639659,2.244089586805855],["List",0.3788033430308374,2.2178836820962142],["List",0.5910916009468209,2.1709699950229906],["List",0.7978609958457055,2.103786546042183],["List",0.9971809775982939,2.016960608915333],["List",1.187190549238799,1.9113028540234218],["List",1.3661156425921004,1.787799779355947],["List",1.5322856822702942,1.6476044998449897],["List",1.6841491833849778,1.4920259810417889],["List",1.8202882373436322,1.3225168176580637]]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List"]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-6.180339887498947e-2],["List",0,1,0.19021130325903074],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517605"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Polygon",["List",["List",-0.3862712429686842,-1.188820645368942],["List",-0.26973024595975753,-1.2205513485365902],["List",-0.15067085031915362,-1.2408860926225675],["List",-3.020468154516537e-2,-1.249635017600241],["List",9.0543500202203e-2,-1.246716437114364],["List",0.2104463016837983,-1.2321576011645634],["List",0.32838422274823387,-1.2060944416794392],["List",0.44325610880316973,-1.1687703033567685],["List",0.5539894319990517,-1.1205336716196297],["List",0.6595503051326662,-1.061834918901901],["List",0.7589531347733891,-0.9932220996421928],["List",0.8512698234834966,-0.9153358332472168],["List",0.9356384352138765,-0.8289033228009939],["List",1.0112712429686845,-0.7347315653655911],["List",1.0774620836000617,-0.6336998172669879],["List",1.133592951063182,-0.5267513847156612],["List",1.179139766572179,-0.41488481641066033],["List",1.2136772717825652,-0.29914458035944697],["List",1.236882999313814,-0.18061131196152633],["List",1.2485402835404082,-6.039172440688373e-2],["List",1.2485402835404082,6.0391724406884006e-2],["List",1.2368829993138137,0.18061131196152713],["List",1.213677271782565,0.29914458035944747],["List",1.1791397665721788,0.4148848164106606],["List",1.1335929510631817,0.5267513847156617],["List",1.0774620836000615,0.6336998172669882],["List",1.011271242968684,0.7347315653655918],["List",1.8202882373436318,1.3225168176580646],["List",1.9394317504801108,1.1406596710805783],["List",2.0404673119137273,0.9481524924881904],["List",2.122451579829922,0.7467926695391889],["List",2.184619089208617,0.5384602446470048],["List",2.226389398764865,0.3251003615307479],["List",2.247372510372735,0.1087051039323907],["List",2.247372510372735,-0.10870510393239095],["List",2.226389398764865,-0.32510036153074817],["List",2.184619089208617,-0.5384602446470053],["List",2.1224515798299217,-0.7467926695391891],["List",2.0404673119137273,-0.9481524924881907],["List",1.9394317504801106,-1.1406596710805788],["List",1.8202882373436315,-1.3225168176580648],["List",1.6841491833849775,-1.492025981041789],["List",1.5322856822702933,-1.6476044998449906],["List",1.3661156425921,-1.7877997793559472],["List",1.1871905492387984,-1.9113028540234225],["List",0.9971809775982925,-2.016960608915334],["List",0.797860995845705,-2.1037865460421834],["List",0.5910916009468205,-2.1709699950229906],["List",0.37880334303083596,-2.2178836820962147],["List",0.1629783003639649,-2.2440895868058552],["List",-5.436842678129766e-2,-2.249343031680434],["List",-0.2712075305744775,-2.2335949667206214],["List",-0.48551444272756406,-2.196992427365862],["List",-0.6952882373436325,-2.1398771616640953]]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List"]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.1618033988749895],["List",0,1,-0.11755705045849463],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517613"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.4992,0.5552,0.8309304]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Polygon",["List",["List",-1.25,-1.5308084989341916e-16],["List",-1.2441645433970607,-0.12064240114314383],["List",-1.2267126576742668,-0.24015839669213573],["List",-1.1978072863864577,-0.3574320979983616],["List",-1.1577183111972205,-0.47136855211040096],["List",-1.1068200320665122,-0.5809039650547109],["List",-1.0455876725127835,-0.6850156341933376],["List",-0.9745929425790278,-0.7827314969228925],["List",-0.8944987009301513,-0.8731392065611714],["List",-0.806052765920213,-0.9553946506823107],["List",-0.7100809334139446,-1.0287298323670706],["List",-0.6074792665532571,-1.0924600407831477],["List",-0.49920572945711916,-1.1459902441457281],["List",-0.38627124296868387,-1.188820645368942],["List",-0.6952882373436315,-2.1398771616640957],["List",-0.898570313022815,-2.0627824394623104],["List",-1.0934626797958638,-1.9664280734096655],["List",-1.2781456801451003,-1.851713698260727],["List",-1.450894978656384,-1.7197103712281585],["List",-1.6100976616742722,-1.5716505718101084],["List",-1.7542672966422501,-1.4089166944612064],["List",-1.8820578105230101,-1.2330281415480076],["List",-1.992276057719722,-1.0456271370984795],["List",-2.0838929601549974,-0.8484633937987207],["List",-2.156053115495624,-0.6433777763970508],["List",-2.2080827838136803,-0.43228511404584335],["List",-2.2394961781147096,-0.2171563220576589],["List",-2.25,-2.755455298081545e-16]]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List"]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.1618033988749895],["List",0,1,-0.11755705045849466],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517621"]]]]]],["List",["List",["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",2.0943951023931957,3.141592653589793]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List"]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.17320508075688776],["List",0,1,9.999999999999999e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517578"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",0,2.0943951023931957]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List"]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,9.999999999999998e-2],["List",0,1,0.17320508075688776],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517586"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.4992,0.5552,0.8309304]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",-3.141592653589793,0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List"]],3],["Style",3,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,1.2246467991473533e-17],["List",0,1,-0.2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517594"]]]]]]]],["List"]],["List",["List"],["List"],["List"]]]],["List",["List",["List",["List",["List",["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List",["List"],["List",["Text",["Style","'a'",["List"]],["List",-0.5773502691896257,0.33333333333333326]]]]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.17320508075688776],["List",0,1,9.999999999999999e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517578"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List",["List"],["List",["Text",["Style","'b'",["List"]],["List",0.33333333333333326,0.5773502691896257]]]]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,9.999999999999998e-2],["List",0,1,0.17320508075688776],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517586"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List",["List"],["List",["Text",["Style","'c'",["List"]],["List",4.082155997157844e-17,-0.6666666666666666]]]]],3],["Style",3,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,1.2246467991473533e-17],["List",0,1,-0.2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517594"]]],["List"]],["List"]],["List",["List",["List",["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List",["List"],["List",["Text",["Style","'a'",["List"]],["List",-0.5407797401561578,1.6643489035165189]]]]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-6.180339887498947e-2],["List",0,1,0.19021130325903074],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517605"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List",["List"],["List",["Text",["Style","'b'",["List"]],["List",1.415779740156158,-1.028624191511828]]]]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.1618033988749895],["List",0,1,-0.11755705045849463],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517613"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List",["List"],["List",["Text",["Style","'c'",["List"]],["List",-1.4157797401561578,-1.0286241915118282]]]]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.1618033988749895],["List",0,1,-0.11755705045849466],["List",0,0,1]]]],["Dynamic","DynamicChart`click$517621"]]],["List"]],["List"]]],["List"]],["List"],["List"]],["RuleDelayed","DynamicModuleValues",["List"]]],["List",["List",["List"],["List"]],["List",["List"],["List"]]],["List",["List",["List",["List"],["List"],["List"],["List"]],["List",["List"],["List"],["List"],["List"]]],["List"]]],["List",["Rule","ContentSelectable",false],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List",-2.25,2.25],["List",-2.25,2.25]]],["Rule","PlotRangePadding",["Scaled",5.0e-2]]]]]],
	["Rule","'f397805e-de62-4a70-ae83-3de12aa36421'",["Hold",["EditorView","'(*GB[*){{(*VB[*)(FrontEndRef[\"f81af593-92be-4a57-9814-c48fbc4be695\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKp1kYJqaZWhrrWholpeqaJJqa61paGJroJptYpCUlmySlmlmaAgCFgBW8\"*)(*]VB*)(*|*),(*|*)(*GB[*){{(*VB[*)(RGBColor[0.982864, 0.7431472, 0.3262672])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs\/JLwouTyxJzghJzS3ISSxJTWMGyXMgyRcd8+U1mV\/83r5o+VLmxXeOP7cv2lNVcKn\/4RV7AJpFH3g=\"*)(*]VB*)(*|*),(*|*)(*VB[*)(\"a\")(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5Kdh4AkDCM68ktSgvMSchKLE8JLWiJBgkkwgAniYOGg==\"*)(*]VB*)}(*||*),(*||*){(*VB[*)(RGBColor[0.784, 0.47519999999999996, 0.2])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs\/JLwouTyxJzghJzS3ISSxJTWMGyXMgyRd58TBpt4u9tC96d\/Kw09rMe\/ZFs2aCwEl7AH\/rHgQ=\"*)(*]VB*)(*|*),(*|*)(*VB[*)(\"b\")(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5Kdh4AkDCM68ktSgvMSchKLE8JLWiJBgkkwQAnicOGw==\"*)(*]VB*)}(*||*),(*||*){(*VB[*)(RGBColor[0.4992, 0.5552, 0.8309304])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeGJAIcndyzs\/JLwouTyxJzghJzS3ISSxJTWMGyXMgyRfdK+zqe\/Lpvn1R+\/LwU0ZHHtoXMQmtiPw97ZU9ALZsH70=\"*)(*]VB*)(*|*),(*|*)(*VB[*)(\"c\")(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5Kdh4AkDCM68ktSgvMSchKLE8JLWiJBgkkwwAnigOHA==\"*)(*]VB*)}}(*]GB*)}}(*]GB*)'"]]],
	["Rule","'895e4d03-4888-4fa1-89c5-db965f80a20e'",["Hold",["Graphics",["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.595]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["List",["List"],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.595]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["List",["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-3,0],["List",-2.5,2],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],2],["Style",2,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-2.5,0],["List",-2,3],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],3],["Style",3,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-2,0],["List",-1.5,11],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],11],["Style",11,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-1.5,0],["List",-1,17],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],17],["Style",17,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-1,0],["List",-0.5,24],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],24],["Style",24,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-0.5,0],["List",0,34],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],34],["Style",34,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",0,0],["List",0.5,41],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],41],["Style",41,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",0.5,0],["List",1,34],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],34],["Style",34,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",1,0],["List",1.5,22],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],22],["Style",22,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",1.5,0],["List",2,6],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],6],["Style",6,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2,0],["List",2.5,4],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],4],["Style",4,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2.5,0],["List",3,1],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],1],["Style",1,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",3,0],["List",3.5,1],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],1],["Style",1,["List"]]]]]],["List"],["List"]]],["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"]]],["List",["Rule","AspectRatio",["Power","GoldenRatio",-1]],["Rule","Axes",["List",true,true]],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",-3.13,0]],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","Method",["List",["Rule","CoordinatesToolOptions",["List",["Rule","'DisplayFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]],["Rule","'CopiedValueFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]]]],["Rule","'AxisPadding'",["Scaled",2.0e-2]],["Rule","'ChartDefaultStyle'",["List",["RGBColor",0.97858,0.678934,0.157834],["RGBColor",0.368417,0.506779,0.709798],["RGBColor",0.560181,0.691569,0.194885],["RGBColor",0.922526,0.385626,0.209179],["RGBColor",0.528488,0.470624,0.701351],["RGBColor",0.772079,0.431554,0.102387],["RGBColor",0.363898,0.618501,0.782349],["RGBColor",1,0.75,0],["RGBColor",0.647624,0.37816,0.614037],["RGBColor",0.571589,0.586483,0],["RGBColor",0.915,0.3325,0.2125],["RGBColor",0.40082222609352647,0.5220066643438841,0.85],["RGBColor",0.9728288904374106,0.621644452187053,7.336199581899142e-2],["RGBColor",0.736782672705901,0.358,0.5030266573755369],["RGBColor",0.28026441037696703,0.715,0.4292089322474965]]],["Rule","'DefaultBoundaryStyle'","Automatic"],["Rule","'DefaultChartBaseStyle'",["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["Rule","'DefaultGraphicsInteraction'",["List",["Rule","'Version'",1.2],["Rule","'TrackMousePosition'",["List",true,false]],["Rule","'Effects'",["List",["Rule","'Highlight'",["List",["Rule","'ratio'",2]]],["Rule","'HighlightPoint'",["List",["Rule","'ratio'",2]]],["Rule","'Droplines'",["List",["Rule","'freeformCursorMode'",true],["Rule","'placement'",["List",["Rule","'x'","'All'"],["Rule","'y'","'None'"]]]]]]]]],["Rule","'DefaultPlotStyle'","Automatic"],["Rule","'DomainPadding'",["Scaled",2.0e-2]],["Rule","'RangePadding'",["Scaled",5.0e-2]]]],["Rule","PlotRange",["List",["List",-3,3.5],["List","All","All"]]],["Rule","PlotRangePadding",["List",["List",["Scaled",2.0e-2],["Scaled",2.0e-2]],["List",["Scaled",2.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","Automatic","Automatic"]]]]]],
	["Rule","'638c18ec-495a-4a48-93ea-ae6025807404'",["Hold",["Graphics",["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.5599999999999999]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["List",["List",["List",["List"],["List",["Directive",["Opacity",0.5],["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.5599999999999999]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["Directive",["RGBColor",0.97858,0.678934,0.157834]]],["List",["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-4,0],["List",-3.5,1],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],1],["Style",1,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-3,0],["List",-2.5,3],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],3],["Style",3,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-2.5,0],["List",-2,4],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],4],["Style",4,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-2,0],["List",-1.5,15],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],15],["Style",15,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-1.5,0],["List",-1,51],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],51],["Style",51,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-1,0],["List",-0.5,83],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],83],["Style",83,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-0.5,0],["List",0,107],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],107],["Style",107,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",0,0],["List",0.5,81],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],81],["Style",81,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",0.5,0],["List",1,67],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],67],["Style",67,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",1,0],["List",1.5,53],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],53],["Style",53,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",1.5,0],["List",2,23],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],23],["Style",23,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2,0],["List",2.5,8],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],8],["Style",8,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2.5,0],["List",3,3],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],3],["Style",3,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",3,0],["List",3.5,1],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],1],["Style",1,["List"]]]]]],["List"],["List"]]],["List",["List",["List"],["List",["Directive",["Opacity",0.5],["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.5599999999999999]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["Directive",["RGBColor",0.368417,0.506779,0.709798]]],["List",["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",1.5,0],["List",2,7],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],7],["Style",7,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2,0],["List",2.5,73],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],73],["Style",73,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2.5,0],["List",3,171],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],171],["Style",171,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",3,0],["List",3.5,161],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],161],["Style",161,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",3.5,0],["List",4,73],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],73],["Style",73,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",4,0],["List",4.5,14],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],14],["Style",14,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",4.5,0],["List",5,1],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],1],["Style",1,["List"]]]]]],["List"],["List"]]]]],["List",["List",["List",["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"]],["List"]]],["List",["List",["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"]],["List"]]]]],["List",["Rule","AspectRatio",["Power","GoldenRatio",-1]],["Rule","Axes",["List",true,true]],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",-4.18,0]],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","Method",["List",["Rule","CoordinatesToolOptions",["List",["Rule","'DisplayFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]],["Rule","'CopiedValueFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]]]],["Rule","'AxisPadding'",["Scaled",2.0e-2]],["Rule","'ChartDefaultStyle'",["List",["RGBColor",0.97858,0.678934,0.157834],["RGBColor",0.368417,0.506779,0.709798],["RGBColor",0.560181,0.691569,0.194885],["RGBColor",0.922526,0.385626,0.209179],["RGBColor",0.528488,0.470624,0.701351],["RGBColor",0.772079,0.431554,0.102387],["RGBColor",0.363898,0.618501,0.782349],["RGBColor",1,0.75,0],["RGBColor",0.647624,0.37816,0.614037],["RGBColor",0.571589,0.586483,0],["RGBColor",0.915,0.3325,0.2125],["RGBColor",0.40082222609352647,0.5220066643438841,0.85],["RGBColor",0.9728288904374106,0.621644452187053,7.336199581899142e-2],["RGBColor",0.736782672705901,0.358,0.5030266573755369],["RGBColor",0.28026441037696703,0.715,0.4292089322474965]]],["Rule","'DefaultBoundaryStyle'","Automatic"],["Rule","'DefaultChartBaseStyle'",["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["Rule","'DefaultGraphicsInteraction'",["List",["Rule","'Version'",1.2],["Rule","'TrackMousePosition'",["List",true,false]],["Rule","'Effects'",["List",["Rule","'Highlight'",["List",["Rule","'ratio'",2]]],["Rule","'HighlightPoint'",["List",["Rule","'ratio'",2]]],["Rule","'Droplines'",["List",["Rule","'freeformCursorMode'",true],["Rule","'placement'",["List",["Rule","'x'","'All'"],["Rule","'y'","'None'"]]]]]]]]],["Rule","'DefaultPlotStyle'","Automatic"],["Rule","'DomainPadding'",["Scaled",2.0e-2]],["Rule","'RangePadding'",["Scaled",5.0e-2]]]],["Rule","PlotRange",["List",["List",-4,5],["List","All","All"]]],["Rule","PlotRangePadding",["List",["List",["Scaled",2.0e-2],["Scaled",2.0e-2]],["List",["Scaled",2.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","Automatic","Automatic"]]]]]],
	["Rule","'b2add816-91a1-49fa-abf7-b8f36e7c0d2b'",["Hold",["Graphics",["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.5599999999999999]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["List",["List",["List",["List"],["List",["Directive",["Opacity",0.5],["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.5599999999999999]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["Directive",["RGBColor",0.761959,0.470832,0.940597]]],["List",["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-4,0],["List",-3.5,1],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],1],["Style",1,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-3,0],["List",-2.5,3],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],3],["Style",3,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-2.5,0],["List",-2,4],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],4],["Style",4,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-2,0],["List",-1.5,15],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],15],["Style",15,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-1.5,0],["List",-1,51],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],51],["Style",51,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-1,0],["List",-0.5,83],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],83],["Style",83,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",-0.5,0],["List",0,107],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],107],["Style",107,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",0,0],["List",0.5,81],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],81],["Style",81,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",0.5,0],["List",1,67],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],67],["Style",67,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",1,0],["List",1.5,53],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],53],["Style",53,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",1.5,0],["List",2,23],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],23],["Style",23,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2,0],["List",2.5,8],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],8],["Style",8,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2.5,0],["List",3,3],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],3],["Style",3,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",3,0],["List",3.5,1],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],1],["Style",1,["List"]]]]]],["List"],["List"]]],["List",["List",["List"],["List",["Directive",["Opacity",0.5],["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.5599999999999999]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["Directive",["RGBColor",0.431296,0.709773,0.927077]]],["List",["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",1.5,0],["List",2,7],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],7],["Style",7,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2,0],["List",2.5,73],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],73],["Style",73,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",2.5,0],["List",3,171],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],171],["Style",171,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",3,0],["List",3.5,161],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],161],["Style",161,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",3.5,0],["List",4,73],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],73],["Style",73,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",4,0],["List",4.5,14],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],14],["Style",14,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Charting`DelayedMouseEffect",["Rectangle",["List",4.5,0],["List",5,1],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],1],["Style",1,["List"]]]]]],["List"],["List"]]]]],["List",["List",["List",["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"]],["List"]]],["List",["List",["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"]],["List"]]]]],["List",["Rule","AspectRatio",["Power","GoldenRatio",-1]],["Rule","Axes",["List",true,true]],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",-4.18,0]],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","Method",["List",["Rule","CoordinatesToolOptions",["List",["Rule","'DisplayFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]],["Rule","'CopiedValueFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]]]],["Rule","'AxisPadding'",["Scaled",2.0e-2]],["Rule","'ChartDefaultStyle'",["List",["RGBColor",0.97858,0.678934,0.157834],["RGBColor",0.368417,0.506779,0.709798],["RGBColor",0.560181,0.691569,0.194885],["RGBColor",0.922526,0.385626,0.209179],["RGBColor",0.528488,0.470624,0.701351],["RGBColor",0.772079,0.431554,0.102387],["RGBColor",0.363898,0.618501,0.782349],["RGBColor",1,0.75,0],["RGBColor",0.647624,0.37816,0.614037],["RGBColor",0.571589,0.586483,0],["RGBColor",0.915,0.3325,0.2125],["RGBColor",0.40082222609352647,0.5220066643438841,0.85],["RGBColor",0.9728288904374106,0.621644452187053,7.336199581899142e-2],["RGBColor",0.736782672705901,0.358,0.5030266573755369],["RGBColor",0.28026441037696703,0.715,0.4292089322474965]]],["Rule","'DefaultBoundaryStyle'","Automatic"],["Rule","'DefaultChartBaseStyle'",["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["Rule","'DefaultGraphicsInteraction'",["List",["Rule","'Version'",1.2],["Rule","'TrackMousePosition'",["List",true,false]],["Rule","'Effects'",["List",["Rule","'Highlight'",["List",["Rule","'ratio'",2]]],["Rule","'HighlightPoint'",["List",["Rule","'ratio'",2]]],["Rule","'Droplines'",["List",["Rule","'freeformCursorMode'",true],["Rule","'placement'",["List",["Rule","'x'","'All'"],["Rule","'y'","'None'"]]]]]]]]],["Rule","'DefaultPlotStyle'","Automatic"],["Rule","'DomainPadding'",["Scaled",2.0e-2]],["Rule","'RangePadding'",["Scaled",5.0e-2]]]],["Rule","PlotRange",["List",["List",-4,5],["List","All","All"]]],["Rule","PlotRangePadding",["List",["List",["Scaled",2.0e-2],["Scaled",2.0e-2]],["List",["Scaled",2.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","Automatic","Automatic"]]]]]],
	["Rule","'01fe870c-d01c-4623-8d3e-aa0bea69f17d'",["Hold",["Graphics",["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.595]]],["RGBColor",0.5,0,0.5]],["List",["List"],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.595]]],["RGBColor",0.5,0,0.5]],["List",["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",0]],["Charting`DelayedMouseEffect",["Rectangle",["List",-3.5,0],["List",-3,1],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],1],["Style",1,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",2.0408163265306124e-2]],["Charting`DelayedMouseEffect",["Rectangle",["List",-3,0],["List",-2.5,3],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],3],["Style",3,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",5.102040816326531e-2]],["Charting`DelayedMouseEffect",["Rectangle",["List",-2.5,0],["List",-2,6],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],6],["Style",6,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",0.18367346938775508]],["Charting`DelayedMouseEffect",["Rectangle",["List",-2,0],["List",-1.5,19],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],19],["Style",19,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",0.4591836734693877]],["Charting`DelayedMouseEffect",["Rectangle",["List",-1.5,0],["List",-1,46],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],46],["Style",46,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",0.7244897959183673]],["Charting`DelayedMouseEffect",["Rectangle",["List",-1,0],["List",-0.5,72],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],72],["Style",72,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",0.9489795918367346]],["Charting`DelayedMouseEffect",["Rectangle",["List",-0.5,0],["List",0,94],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],94],["Style",94,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",1]],["Charting`DelayedMouseEffect",["Rectangle",["List",0,0],["List",0.5,99],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],99],["Style",99,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",0.8061224489795917]],["Charting`DelayedMouseEffect",["Rectangle",["List",0.5,0],["List",1,80],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],80],["Style",80,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",0.48979591836734687]],["Charting`DelayedMouseEffect",["Rectangle",["List",1,0],["List",1.5,49],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],49],["Style",49,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",0.173469387755102]],["Charting`DelayedMouseEffect",["Rectangle",["List",1.5,0],["List",2,18],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],18],["Style",18,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",9.183673469387754e-2]],["Charting`DelayedMouseEffect",["Rectangle",["List",2,0],["List",2.5,10],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],10],["Style",10,["List"]]]],["List",["Tooltip",["StatusArea",["List",["Directive",["Opacity",2.0408163265306124e-2]],["Charting`DelayedMouseEffect",["Rectangle",["List",2.5,0],["List",3,3],["Rule","'RoundingRadius'",0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",1.5],["Opacity",0.66]]]]]],3],["Style",3,["List"]]]]]],["List"],["List"]]],["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"]]],["List",["Rule","AspectRatio",["Power","GoldenRatio",-1]],["Rule","Axes",["List",true,true]],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",-3.63,0]],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","Method",["List",["Rule","CoordinatesToolOptions",["List",["Rule","'DisplayFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]],["Rule","'CopiedValueFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]]]],["Rule","'AxisPadding'",["Scaled",2.0e-2]],["Rule","'ChartDefaultStyle'",["List",["RGBColor",0.97858,0.678934,0.157834],["RGBColor",0.368417,0.506779,0.709798],["RGBColor",0.560181,0.691569,0.194885],["RGBColor",0.922526,0.385626,0.209179],["RGBColor",0.528488,0.470624,0.701351],["RGBColor",0.772079,0.431554,0.102387],["RGBColor",0.363898,0.618501,0.782349],["RGBColor",1,0.75,0],["RGBColor",0.647624,0.37816,0.614037],["RGBColor",0.571589,0.586483,0],["RGBColor",0.915,0.3325,0.2125],["RGBColor",0.40082222609352647,0.5220066643438841,0.85],["RGBColor",0.9728288904374106,0.621644452187053,7.336199581899142e-2],["RGBColor",0.736782672705901,0.358,0.5030266573755369],["RGBColor",0.28026441037696703,0.715,0.4292089322474965]]],["Rule","'DefaultBoundaryStyle'","Automatic"],["Rule","'DefaultChartBaseStyle'",["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["Rule","'DefaultGraphicsInteraction'",["List",["Rule","'Version'",1.2],["Rule","'TrackMousePosition'",["List",true,false]],["Rule","'Effects'",["List",["Rule","'Highlight'",["List",["Rule","'ratio'",2]]],["Rule","'HighlightPoint'",["List",["Rule","'ratio'",2]]],["Rule","'Droplines'",["List",["Rule","'freeformCursorMode'",true],["Rule","'placement'",["List",["Rule","'x'","'All'"],["Rule","'y'","'None'"]]]]]]]]],["Rule","'DefaultPlotStyle'","Automatic"],["Rule","'DomainPadding'",["Scaled",2.0e-2]],["Rule","'RangePadding'",["Scaled",5.0e-2]]]],["Rule","PlotRange",["List",["List",-3.5,3],["List","All","All"]]],["Rule","PlotRangePadding",["List",["List",["Scaled",2.0e-2],["Scaled",2.0e-2]],["List",["Scaled",2.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","Automatic","Automatic"]]]]]],
	["Rule","'dc7525c1-be14-45e7-af40-d90ae8897092'",["Hold",["Graphics",["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.434]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["List",["List"],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.434]]],["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["List",["List",["List",["Rectangle",["List",5,0],["List",15,1.578002456770292e-2]]]],["List",["List",["Rectangle",["List",15,0],["List",25,1.908721534536521e-2]]]],["List",["List",["Rectangle",["List",25,0],["List",35,2.475668524992913e-2]]]],["List",["List",["Rectangle",["List",35,0],["List",45,1.927619767551734e-2]]]],["List",["List",["Rectangle",["List",45,0],["List",55,2.929226117358027e-2]]]],["List",["List",["Rectangle",["List",55,0],["List",65,2.7213455541906833e-2]]]],["List",["List",["Rectangle",["List",65,0],["List",75,2.1355003307190777e-2]]]],["List",["List",["Rectangle",["List",75,0],["List",85,2.315033544363602e-2]]]],["List",["List",["Rectangle",["List",85,0],["List",95,2.2394406123027497e-2]]]],["List",["List",["Rectangle",["List",95,0],["List",105,2.229991495795143e-2]]]],["List",["List",["Rectangle",["List",105,0],["List",115,1.8520268354908817e-2]]]],["List",["List",["Rectangle",["List",115,0],["List",125,2.0599073986582256e-2]]]],["List",["List",["Rectangle",["List",125,0],["List",135,2.2772370783331757e-2]]]],["List",["List",["Rectangle",["List",135,0],["List",145,2.418973825947274e-2]]]],["List",["List",["Rectangle",["List",145,0],["List",155,2.2488897288103563e-2]]]],["List",["List",["Rectangle",["List",155,0],["List",165,2.94812435037324e-2]]]],["List",["List",["Rectangle",["List",165,0],["List",175,4.7056600207880564e-2]]]],["List",["List",["Rectangle",["List",175,0],["List",185,4.715109137295663e-2]]]],["List",["List",["Rectangle",["List",185,0],["List",195,4.2143059623925165e-2]]]],["List",["List",["Rectangle",["List",195,0],["List",205,3.411131059245961e-2]]]],["List",["List",["Rectangle",["List",205,0],["List",215,2.8914296513276008e-2]]]],["List",["List",["Rectangle",["List",215,0],["List",225,2.8914296513276008e-2]]]],["List",["List",["Rectangle",["List",225,0],["List",235,2.7496929037135028e-2]]]],["List",["List",["Rectangle",["List",235,0],["List",245,2.929226117358027e-2]]]],["List",["List",["Rectangle",["List",245,0],["List",255,2.9575734668808466e-2]]]],["List",["List",["Rectangle",["List",255,0],["List",265,2.7874893697439288e-2]]]],["List",["List",["Rectangle",["List",265,0],["List",275,3.363885476707928e-2]]]],["List",["List",["Rectangle",["List",275,0],["List",285,3.845790418595861e-2]]]],["List",["List",["Rectangle",["List",285,0],["List",295,3.855239535103468e-2]]]],["List",["List",["Rectangle",["List",295,0],["List",305,3.609562505905698e-2]]]],["List",["List",["Rectangle",["List",305,0],["List",315,3.052064631956912e-2]]]],["List",["List",["Rectangle",["List",315,0],["List",325,3.0237172824340925e-2]]]],["List",["List",["Rectangle",["List",325,0],["List",335,2.437872058962487e-2]]]],["List",["List",["Rectangle",["List",335,0],["List",345,2.1071529811962583e-2]]]],["List",["List",["Rectangle",["List",345,0],["List",355,2.050458282150619e-2]]]],["List",["List",["Rectangle",["List",355,0],["List",365,2.1355003307190777e-2]]]]]],["List"],["List"]]],["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"]]],["List",["Rule","AspectRatio",["Power","GoldenRatio",-1]],["Rule","Axes",["List",true,true]],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",-2.2,0]],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","Method",["List",["Rule","CoordinatesToolOptions",["List",["Rule","'DisplayFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]],["Rule","'CopiedValueFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]]]],["Rule","'AxisPadding'",["Scaled",2.0e-2]],["Rule","'ChartDefaultStyle'",["List",["RGBColor",0.97858,0.678934,0.157834],["RGBColor",0.368417,0.506779,0.709798],["RGBColor",0.560181,0.691569,0.194885],["RGBColor",0.922526,0.385626,0.209179],["RGBColor",0.528488,0.470624,0.701351],["RGBColor",0.772079,0.431554,0.102387],["RGBColor",0.363898,0.618501,0.782349],["RGBColor",1,0.75,0],["RGBColor",0.647624,0.37816,0.614037],["RGBColor",0.571589,0.586483,0],["RGBColor",0.915,0.3325,0.2125],["RGBColor",0.40082222609352647,0.5220066643438841,0.85],["RGBColor",0.9728288904374106,0.621644452187053,7.336199581899142e-2],["RGBColor",0.736782672705901,0.358,0.5030266573755369],["RGBColor",0.28026441037696703,0.715,0.4292089322474965]]],["Rule","'DefaultBoundaryStyle'","Automatic"],["Rule","'DefaultChartBaseStyle'",["RGBColor",0.987148,0.8073604000000001,0.49470040000000004]],["Rule","'DefaultGraphicsInteraction'",["List",["Rule","'Version'",1.2],["Rule","'TrackMousePosition'",["List",true,false]],["Rule","'Effects'",["List",["Rule","'Highlight'",["List",["Rule","'ratio'",2]]],["Rule","'HighlightPoint'",["List",["Rule","'ratio'",2]]],["Rule","'Droplines'",["List",["Rule","'freeformCursorMode'",true],["Rule","'placement'",["List",["Rule","'x'","'All'"],["Rule","'y'","'None'"]]]]]]]]],["Rule","'DefaultPlotStyle'","Automatic"],["Rule","'DomainPadding'",["Scaled",2.0e-2]],["Rule","'RangePadding'",["Scaled",5.0e-2]]]],["Rule","PlotRange",["List",["List",5,365],["List","All","All"]]],["Rule","PlotRangePadding",["List",["List",["Scaled",2.0e-2],["Scaled",2.0e-2]],["List",["Scaled",2.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","Automatic","Automatic"]]]]]],
	["Rule","'50e54f29-0e9c-4444-8d80-685158f6c2fa'",["Hold",["Graphics",["List",["List"],["List"],["DynamicModule",["List",["Set","DynamicChart`click$507623",false],["Set","DynamicChart`click$507629",false],["Set","DynamicChart`click$507635",false],["Set","DynamicChart`click$507641",false],["Set","DynamicChart`click$507647",false],["Set","DynamicChart`click$507653",false],["Set","DynamicChart`click$507659",false],["Set","DynamicChart`click$507665",false],["Set","DynamicChart`click$507671",false],["Set","DynamicChart`click$507677",false],["Set","DynamicChart`click$507683",false],["Set","DynamicChart`click$507689",false],["Set","DynamicChart`click$507695",false],["Set","DynamicChart`click$507701",false],["Set","DynamicChart`click$507707",false],["Set","DynamicChart`click$507713",false],["Set","DynamicChart`click$507719",false],["Set","DynamicChart`click$507725",false],["Set","DynamicChart`click$507731",false],["Set","DynamicChart`click$507737",false],["Set","DynamicChart`click$507743",false],["Set","DynamicChart`click$507749",false],["Set","DynamicChart`click$507755",false],["Set","DynamicChart`click$507761",false],["Set","DynamicChart`click$507767",false],["Set","DynamicChart`click$507773",false],["Set","DynamicChart`click$507779",false],["Set","DynamicChart`click$507785",false],["Set","DynamicChart`click$507791",false],["Set","DynamicChart`click$507797",false],["Set","DynamicChart`click$507803",false],["Set","DynamicChart`click$507809",false],["Set","DynamicChart`click$507815",false],["Set","DynamicChart`click$507821",false],["Set","DynamicChart`click$507827",false],["Set","DynamicChart`click$507833",false]],["List",["List",["Directive",["RGBColor",0.5,0.5,1],["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]]],["List",["List",["List",["List",["List",["List",["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1.578002456770292,["List",1.3962634015954636,1.5707963267948966]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,1.578002456770292]],["Style",["List",10,1.578002456770292],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,2.750639523548882e-2],["List",0,1,0.3143995362020628],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507623"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9848224,0.7203875200000001,0.31183666285714284]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1.908721534536521,["List",1.2217304763960306,1.3962634015954636]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,1.908721534536521]],["Style",["List",10,1.908721534536521],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,9.880269698707217e-2],["List",0,1,0.3687366850805855],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507629"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9867808,0.69762784,0.2974061257142857]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.475668524992913,["List",1.0471975511965976,1.2217304763960306]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.475668524992913]],["Style",["List",10,2.475668524992913],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.20925254573573324],["List",0,1,0.44874353246452287],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507635"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9887391999999999,0.67486816,0.28297558857142857]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1.927619767551734,["List",0.8726646259971647,1.0471975511965976]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,1.927619767551734]],["Style",["List",10,1.927619767551734],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.2211274553824311],["List",0,1,0.3158027346403748],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507641"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9906976,0.65210848,0.26854505142857144]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.929226117358027,["List",0.6981317007977318,0.8726646259971647]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.929226117358027]],["Style",["List",10,2.929226117358027],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.4142551302425206],["List",0,1,0.41425513024252053],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507647"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.992656,0.6293488,0.2541145142857143]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.7213455541906835,["List",0.5235987755982987,0.6981317007977318]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.7213455541906835]],["Style",["List",10,2.7213455541906835],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.44583915478641156],["List",0,1,0.31217993701049096],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507653"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9946144,0.60658912,0.23968397714285716]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.135500330719078,["List",0.34906585039886595,0.5235987755982987]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.135500330719078]],["Style",["List",10,2.135500330719078],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.38708411579000834],["List",0,1,0.18050028754303707],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507659"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9965728,0.58382944,0.22525344000000003]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.3150335443636023,["List",0.17453292519943275,0.34906585039886595]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.3150335443636023]],["Style",["List",10,2.3150335443636023],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.4472301378452646],["List",0,1,0.11983495426649832],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507665"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9985312,0.5610697600000001,0.21082290285714286]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.2394406123027495,["List",0,0.17453292519943275]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.2394406123027495]],["Style",["List",10,2.2394406123027495],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.44618377293346634],["List",0,1,3.9036021980903265e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507671"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9938285714285715,0.5420342857142858,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.229991495795143,["List",-0.17453292519943298,0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.229991495795143]],["Style",["List",10,2.229991495795143],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.44430114098016055],["List",0,1,-3.8871313027397394e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507677"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9691428571428572,0.5341714285714286,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1.8520268354908818,["List",-0.34906585039886595,-0.17453292519943298]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,1.8520268354908818]],["Style",["List",10,1.8520268354908818],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.3577841102762117],["List",0,1,-9.586796341319868e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507683"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9444571428571429,0.5263085714285715,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.0599073986582255,["List",-0.5235987755982991,-0.34906585039886595]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.0599073986582255]],["Style",["List",10,2.0599073986582255],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.3733820231956717],["List",0,1,-0.1741108968335491],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507689"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.9197714285714286,0.5184457142857143,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.277237078333176,["List",-0.6981317007977319,-0.5235987755982991]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.277237078333176]],["Style",["List",10,2.277237078333176],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.37308068160946234],["List",0,1,-0.2612339056233623],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507695"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.8950857142857143,0.5105828571428571,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.418973825947274,["List",-0.8726646259971647,-0.6981317007977319]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.418973825947274]],["Style",["List",10,2.418973825947274],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.342094559168017],["List",0,1,-0.3420945591680169],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507701"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.8704000000000001,0.5027200000000001,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.248889728810356,["List",-1.0471975511965979,-0.8726646259971647]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.248889728810356]],["Style",["List",10,2.248889728810356],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.25798203127950287],["List",0,1,-0.36843652374710395],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507707"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.8457142857142858,0.49485714285714283,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.94812435037324,["List",-1.221730476396031,-1.0471975511965979]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.94812435037324]],["Style",["List",10,2.94812435037324],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.2491862376700334],["List",0,1,-0.5343816111791265],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507713"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.8210285714285714,0.4869942857142857,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],4.705660020788057,["List",-1.3962634015954638,-1.221730476396031]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,4.705660020788057]],["Style",["List",10,4.705660020788057],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.24358288663149433],["List",0,1,-0.9090637087630276],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507719"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.7963428571428572,0.47913142857142854,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],4.715109137295663,["List",-1.5707963267948966,-1.3962634015954638]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,4.715109137295663]],["Style",["List",10,4.715109137295663],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,8.218976779945462e-2],["List",0,1,-0.9394333446995768],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507725"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.77779776,0.4757485714285714,0.2298559542857142]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],4.214305962392516,["List",-1.7453292519943298,-1.5707963267948966]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,4.214305962392516]],["Style",["List",10,4.214305962392516],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-7.346019326364088e-2],["List",0,1,-0.8396538511743712],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507731"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.7653932800000001,0.47684571428571426,0.28956786285714275]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],3.4111310592459607,["List",-1.9198621771937625,-1.7453292519943298]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,3.4111310592459607]],["Style",["List",10,3.4111310592459607],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.17657313669471802],["List",0,1,-0.658979917396492],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507737"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.7529888,0.4779428571428571,0.34927977142857136]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.8914296513276008,["List",-2.0943951023931957,-1.9198621771937625]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.8914296513276008]],["Style",["List",10,2.8914296513276008],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.24439419463791762],["List",0,1,-0.524105041733374],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507743"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.74058432,0.47903999999999997,0.40899167999999997]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.8914296513276008,["List",-2.2689280275926285,-2.0943951023931957]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.8914296513276008]],["Style",["List",10,2.8914296513276008],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.33169118307364664],["List",0,1,-0.4737041019605622],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507749"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.72817984,0.4801371428571428,0.4687035885714286]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.7496929037135027,["List",-2.443460952792062,-2.2689280275926285]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.7496929037135027]],["Style",["List",10,2.7496929037135027],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.3888652996792694],["List",0,1,-0.38886529967926914],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507755"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.71577536,0.4812342857142857,0.5284154971428572]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.929226117358027,["List",-2.617993877991495,-2.443460952792062]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.929226117358027]],["Style",["List",10,2.929226117358027],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.479896312443707],["List",0,1,-0.33602701553212544],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507761"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.70337088,0.4823314285714286,0.5881274057142858]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.9575734668808464,["List",-2.7925268031909267,-2.617993877991495]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.9575734668808464]],["Style",["List",10,2.9575734668808464],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.5360943727534185],["List",0,1,-0.24998491150871952],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507767"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.6909664,0.48342857142857143,0.6478393142857144]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.7874893697439287,["List",-2.9670597283903604,-2.7925268031909267]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.7874893697439287]],["Style",["List",10,2.7874893697439287],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.5385015945483796],["List",0,1,-0.14429106738211037],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507773"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.6785619199999999,0.4845257142857143,0.707551222857143]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],3.3638854767079276,["List",-3.141592653589793,-2.9670597283903604]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,3.3638854767079276]],["Style",["List",10,3.3638854767079276],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.6702169753768523],["List",0,1,-5.8636387448107945e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507779"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.6603527314285714,0.4908342857142857,0.7317750171428571]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],3.845790418595861,["List",-3.316125578789226,-3.141592653589793]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,3.845790418595861]],["Style",["List",10,3.845790418595861],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.7662312049954463],["List",0,1,6.703654407690972e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507785"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.64020864,0.49888,0.74416944]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],3.855239535103468,["List",-3.4906585039886595,-3.316125578789226]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,3.855239535103468]],["Style",["List",10,3.855239535103468],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.7447750866974202],["List",0,1,0.19956188302339317],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507791"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.6200645485714286,0.5069257142857143,0.7565638628571428]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],3.609562505905698,["List",-3.6651914291880923,-3.4906585039886595]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,3.609562505905698]],["Style",["List",10,3.609562505905698],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.6542749213795716],["List",0,1,0.30509340637805404],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507797"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.5999204571428571,0.5149714285714285,0.7689582857142857]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],3.052064631956912,["List",-3.839724354387525,-3.6651914291880923]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,3.052064631956912]],["Style",["List",10,3.052064631956912],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.5000209965139267],["List",0,1,0.3501184710221826],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507803"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.5797763657142857,0.5230171428571428,0.7813527085714286]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],3.0237172824340925,["List",-4.014257279586959,-3.839724354387525]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,3.0237172824340925]],["Style",["List",10,3.0237172824340925],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.4276181989600211],["List",0,1,0.4276181989600213],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507809"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.5596322742857143,0.5310628571428572,0.7937471314285713]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.437872058962487,["List",-4.188790204786391,-4.014257279586959]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.437872058962487]],["Style",["List",10,2.437872058962487],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.2796611935718979],["List",0,1,0.3993975761628271],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507815"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.5394881828571428,0.5391085714285715,0.8061415542857142]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.107152981196258,["List",-4.363323129985824,-4.188790204786391]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.107152981196258]],["Style",["List",10,2.107152981196258],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.17810426602697896],["List",0,1,0.38194583106713215],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507821"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.5193440914285714,0.5471542857142857,0.8185359771428571]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.050458282150619,["List",-4.537856055185257,-4.363323129985824]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.050458282150619]],["Style",["List",10,2.050458282150619],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.10613953092175561],["List",0,1,0.3961181220915201],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507827"]]],["List",["Directive",["Opacity",1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5],["Thickness","Tiny"]]],["RGBColor",0.4992,0.5552,0.8309304]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],2.135500330719078,["List",-4.71238898038469,-4.537856055185257]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],["List",10,2.135500330719078]],["Style",["List",10,2.135500330719078],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-3.722422349233821e-2],["List",0,1,0.4254748214471029],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507833"]]]]]]],["List"]],["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"]]]],["List",["List",["List",["List",["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,1.578002456770292]],["Style",["List",10,1.578002456770292],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,2.750639523548882e-2],["List",0,1,0.3143995362020628],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507623"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,1.908721534536521]],["Style",["List",10,1.908721534536521],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,9.880269698707217e-2],["List",0,1,0.3687366850805855],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507629"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.475668524992913]],["Style",["List",10,2.475668524992913],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.20925254573573324],["List",0,1,0.44874353246452287],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507635"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,1.927619767551734]],["Style",["List",10,1.927619767551734],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.2211274553824311],["List",0,1,0.3158027346403748],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507641"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.929226117358027]],["Style",["List",10,2.929226117358027],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.4142551302425206],["List",0,1,0.41425513024252053],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507647"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.7213455541906835]],["Style",["List",10,2.7213455541906835],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.44583915478641156],["List",0,1,0.31217993701049096],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507653"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.135500330719078]],["Style",["List",10,2.135500330719078],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.38708411579000834],["List",0,1,0.18050028754303707],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507659"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.3150335443636023]],["Style",["List",10,2.3150335443636023],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.4472301378452646],["List",0,1,0.11983495426649832],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507665"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.2394406123027495]],["Style",["List",10,2.2394406123027495],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.44618377293346634],["List",0,1,3.9036021980903265e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507671"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.229991495795143]],["Style",["List",10,2.229991495795143],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.44430114098016055],["List",0,1,-3.8871313027397394e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507677"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,1.8520268354908818]],["Style",["List",10,1.8520268354908818],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.3577841102762117],["List",0,1,-9.586796341319868e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507683"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.0599073986582255]],["Style",["List",10,2.0599073986582255],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.3733820231956717],["List",0,1,-0.1741108968335491],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507689"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.277237078333176]],["Style",["List",10,2.277237078333176],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.37308068160946234],["List",0,1,-0.2612339056233623],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507695"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.418973825947274]],["Style",["List",10,2.418973825947274],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.342094559168017],["List",0,1,-0.3420945591680169],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507701"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.248889728810356]],["Style",["List",10,2.248889728810356],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.25798203127950287],["List",0,1,-0.36843652374710395],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507707"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.94812435037324]],["Style",["List",10,2.94812435037324],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.2491862376700334],["List",0,1,-0.5343816111791265],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507713"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,4.705660020788057]],["Style",["List",10,4.705660020788057],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.24358288663149433],["List",0,1,-0.9090637087630276],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507719"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,4.715109137295663]],["Style",["List",10,4.715109137295663],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,8.218976779945462e-2],["List",0,1,-0.9394333446995768],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507725"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,4.214305962392516]],["Style",["List",10,4.214305962392516],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-7.346019326364088e-2],["List",0,1,-0.8396538511743712],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507731"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,3.4111310592459607]],["Style",["List",10,3.4111310592459607],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.17657313669471802],["List",0,1,-0.658979917396492],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507737"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.8914296513276008]],["Style",["List",10,2.8914296513276008],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.24439419463791762],["List",0,1,-0.524105041733374],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507743"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.8914296513276008]],["Style",["List",10,2.8914296513276008],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.33169118307364664],["List",0,1,-0.4737041019605622],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507749"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.7496929037135027]],["Style",["List",10,2.7496929037135027],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.3888652996792694],["List",0,1,-0.38886529967926914],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507755"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.929226117358027]],["Style",["List",10,2.929226117358027],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.479896312443707],["List",0,1,-0.33602701553212544],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507761"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.9575734668808464]],["Style",["List",10,2.9575734668808464],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.5360943727534185],["List",0,1,-0.24998491150871952],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507767"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.7874893697439287]],["Style",["List",10,2.7874893697439287],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.5385015945483796],["List",0,1,-0.14429106738211037],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507773"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,3.3638854767079276]],["Style",["List",10,3.3638854767079276],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.6702169753768523],["List",0,1,-5.8636387448107945e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507779"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,3.845790418595861]],["Style",["List",10,3.845790418595861],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.7662312049954463],["List",0,1,6.703654407690972e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507785"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,3.855239535103468]],["Style",["List",10,3.855239535103468],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.7447750866974202],["List",0,1,0.19956188302339317],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507791"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,3.609562505905698]],["Style",["List",10,3.609562505905698],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.6542749213795716],["List",0,1,0.30509340637805404],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507797"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,3.052064631956912]],["Style",["List",10,3.052064631956912],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.5000209965139267],["List",0,1,0.3501184710221826],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507803"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,3.0237172824340925]],["Style",["List",10,3.0237172824340925],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.4276181989600211],["List",0,1,0.4276181989600213],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507809"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.437872058962487]],["Style",["List",10,2.437872058962487],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.2796611935718979],["List",0,1,0.3993975761628271],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507815"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.107152981196258]],["Style",["List",10,2.107152981196258],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.17810426602697896],["List",0,1,0.38194583106713215],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507821"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.050458282150619]],["Style",["List",10,2.050458282150619],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.10613953092175561],["List",0,1,0.3961181220915201],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507827"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],["List",10,2.135500330719078]],["Style",["List",10,2.135500330719078],["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-3.722422349233821e-2],["List",0,1,0.4254748214471029],["List",0,0,1]]]],["Dynamic","DynamicChart`click$507833"]]],["List"]]],["List"]],["List"],["List"]],["RuleDelayed","DynamicModuleValues",["List"]]],["List",["List",["List",["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",3.061616997868383e-16,5]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",0.8682408883346521,4.92403876506104]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",1.7101007166283442,4.698463103929542]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",2.5000000000000004,4.330127018922193]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",3.2139380484326967,3.83022221559489]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",3.83022221559489,3.2139380484326963]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",4.330127018922193,2.5]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",4.698463103929542,1.7101007166283444]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",4.92403876506104,0.8682408883346517]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",5,0]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",4.92403876506104,-0.8682408883346517]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",4.698463103929542,-1.7101007166283448]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",4.330127018922193,-2.5]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",3.83022221559489,-3.2139380484326967]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",3.2139380484326976,-3.83022221559489]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",2.5000000000000004,-4.330127018922193]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",1.7101007166283442,-4.698463103929542]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",0.8682408883346511,-4.924038765061041]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",3.061616997868383e-16,-5]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-0.8682408883346504,-4.924038765061041]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-1.7101007166283435,-4.698463103929543]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-2.499999999999999,-4.330127018922194]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-3.2139380484326967,-3.83022221559489]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-3.8302222155948895,-3.2139380484326976]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-4.330127018922194,-2.4999999999999996]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-4.698463103929542,-1.7101007166283444]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-4.92403876506104,-0.8682408883346514]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-5,-6.123233995736766e-16]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-4.924038765061041,0.8682408883346502]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-4.698463103929543,1.7101007166283433]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-4.3301270189221945,2.499999999999999]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-3.8302222155948917,3.2139380484326945]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-3.2139380484326976,3.8302222155948895]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-2.500000000000002,4.330127018922192]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-1.7101007166283426,4.698463103929543]]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Line",["List",["List",0,0],["List",-0.8682408883346516,4.92403876506104]]]]],["List",["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Circle",["List",0,0],0,["List",-4.71238898038469,1.5707963267948966]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Circle",["List",0,0],1,["List",-4.71238898038469,1.5707963267948966]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Circle",["List",0,0],2,["List",-4.71238898038469,1.5707963267948966]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Circle",["List",0,0],3,["List",-4.71238898038469,1.5707963267948966]]],["List",["Directive",["GrayLevel",0.5],["Opacity",0.4]],["Circle",["List",0,0],4,["List",-4.71238898038469,1.5707963267948966]]]]]],["List",["List",["List",["List",["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",3.061616997868383e-16,5]],["Scaled",["List",4.898587196589413e-19,8.0e-3],["List",3.061616997868383e-16,5]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",0.8682408883346521,4.92403876506104]],["Scaled",["List",1.3891854213354433e-3,7.878462024097664e-3],["List",0.8682408883346521,4.92403876506104]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",1.7101007166283442,4.698463103929542]],["Scaled",["List",2.7361611466053507e-3,7.517540966287267e-3],["List",1.7101007166283442,4.698463103929542]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",2.5000000000000004,4.330127018922193]],["Scaled",["List",4.000000000000001e-3,6.928203230275509e-3],["List",2.5000000000000004,4.330127018922193]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",3.2139380484326967,3.83022221559489]],["Scaled",["List",5.142300877492315e-3,6.128355544951824e-3],["List",3.2139380484326967,3.83022221559489]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",3.83022221559489,3.2139380484326963]],["Scaled",["List",6.128355544951824e-3,5.142300877492314e-3],["List",3.83022221559489,3.2139380484326963]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",4.330127018922193,2.5]],["Scaled",["List",6.928203230275509e-3,4.0e-3],["List",4.330127018922193,2.5]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",4.698463103929542,1.7101007166283444]],["Scaled",["List",7.517540966287267e-3,2.736161146605351e-3],["List",4.698463103929542,1.7101007166283444]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",4.92403876506104,0.8682408883346517]],["Scaled",["List",7.878462024097664e-3,1.389185421335443e-3],["List",4.92403876506104,0.8682408883346517]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",5,0]],["Scaled",["List",8.0e-3,0],["List",5,0]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",4.92403876506104,-0.8682408883346517]],["Scaled",["List",7.878462024097664e-3,-1.389185421335443e-3],["List",4.92403876506104,-0.8682408883346517]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",4.698463103929542,-1.7101007166283448]],["Scaled",["List",7.517540966287267e-3,-2.736161146605352e-3],["List",4.698463103929542,-1.7101007166283448]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",4.330127018922193,-2.5]],["Scaled",["List",6.928203230275509e-3,-4.0e-3],["List",4.330127018922193,-2.5]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",3.83022221559489,-3.2139380484326967]],["Scaled",["List",6.128355544951824e-3,-5.142300877492315e-3],["List",3.83022221559489,-3.2139380484326967]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",3.2139380484326976,-3.83022221559489]],["Scaled",["List",5.142300877492316e-3,-6.128355544951824e-3],["List",3.2139380484326976,-3.83022221559489]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",2.5000000000000004,-4.330127018922193]],["Scaled",["List",4.000000000000001e-3,-6.928203230275509e-3],["List",2.5000000000000004,-4.330127018922193]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",1.7101007166283442,-4.698463103929542]],["Scaled",["List",2.7361611466053507e-3,-7.517540966287267e-3],["List",1.7101007166283442,-4.698463103929542]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",0.8682408883346511,-4.924038765061041]],["Scaled",["List",1.3891854213354418e-3,-7.878462024097666e-3],["List",0.8682408883346511,-4.924038765061041]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",3.061616997868383e-16,-5]],["Scaled",["List",4.898587196589413e-19,-8.0e-3],["List",3.061616997868383e-16,-5]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-0.8682408883346504,-4.924038765061041]],["Scaled",["List",-1.3891854213354407e-3,-7.878462024097666e-3],["List",-0.8682408883346504,-4.924038765061041]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-1.7101007166283435,-4.698463103929543]],["Scaled",["List",-2.73616114660535e-3,-7.517540966287268e-3],["List",-1.7101007166283435,-4.698463103929543]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-2.499999999999999,-4.330127018922194]],["Scaled",["List",-3.999999999999998e-3,-6.9282032302755096e-3],["List",-2.499999999999999,-4.330127018922194]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-3.2139380484326967,-3.83022221559489]],["Scaled",["List",-5.142300877492315e-3,-6.128355544951824e-3],["List",-3.2139380484326967,-3.83022221559489]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-3.8302222155948895,-3.2139380484326976]],["Scaled",["List",-6.1283555449518235e-3,-5.142300877492316e-3],["List",-3.8302222155948895,-3.2139380484326976]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-4.330127018922194,-2.4999999999999996]],["Scaled",["List",-6.9282032302755096e-3,-3.999999999999999e-3],["List",-4.330127018922194,-2.4999999999999996]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-4.698463103929542,-1.7101007166283444]],["Scaled",["List",-7.517540966287267e-3,-2.736161146605351e-3],["List",-4.698463103929542,-1.7101007166283444]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-4.92403876506104,-0.8682408883346514]],["Scaled",["List",-7.878462024097664e-3,-1.3891854213354423e-3],["List",-4.92403876506104,-0.8682408883346514]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-5,-6.123233995736766e-16]],["Scaled",["List",-8.0e-3,-9.797174393178825e-19],["List",-5,-6.123233995736766e-16]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-4.924038765061041,0.8682408883346502]],["Scaled",["List",-7.878462024097666e-3,1.3891854213354403e-3],["List",-4.924038765061041,0.8682408883346502]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-4.698463103929543,1.7101007166283433]],["Scaled",["List",-7.517540966287268e-3,2.7361611466053494e-3],["List",-4.698463103929543,1.7101007166283433]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-4.3301270189221945,2.499999999999999]],["Scaled",["List",-6.92820323027551e-3,3.999999999999998e-3],["List",-4.3301270189221945,2.499999999999999]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-3.8302222155948917,3.2139380484326945]],["Scaled",["List",-6.128355544951827e-3,5.142300877492311e-3],["List",-3.8302222155948917,3.2139380484326945]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-3.2139380484326976,3.8302222155948895]],["Scaled",["List",-5.142300877492316e-3,6.1283555449518235e-3],["List",-3.2139380484326976,3.8302222155948895]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-2.500000000000002,4.330127018922192]],["Scaled",["List",-4.0000000000000036e-3,6.928203230275507e-3],["List",-2.500000000000002,4.330127018922192]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-1.7101007166283426,4.698463103929543]],["Scaled",["List",-2.7361611466053485e-3,7.517540966287268e-3],["List",-1.7101007166283426,4.698463103929543]]]],["List"]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",-0.8682408883346516,4.92403876506104]],["Scaled",["List",-1.3891854213354427e-3,7.878462024097664e-3],["List",-0.8682408883346516,4.92403876506104]]]],["List"]]]],["Style",["Line",["List",["List",["List",-9.184850993605148e-16,5],["Scaled",["List",-7.347880794884119e-19,4.0e-3],["List",-9.184850993605148e-16,5]]],["List",["List",-0.1744974835125038,4.9969541350954785],["Scaled",["List",-1.3959798681000305e-4,3.997563308076383e-3],["List",-0.1744974835125038,4.9969541350954785]]],["List",["List",-0.3487823687206279,4.987820251299121],["Scaled",["List",-2.790258949765023e-4,3.9902562010392965e-3],["List",-0.3487823687206279,4.987820251299121]]],["List",["List",-0.5226423163382667,4.972609476841367],["Scaled",["List",-4.1811385307061346e-4,3.978087581473094e-3],["List",-0.5226423163382667,4.972609476841367]]],["List",["List",-0.6958655048003292,4.951340343707852],["Scaled",["List",-5.566924038402633e-4,3.961072274966281e-3],["List",-0.6958655048003292,4.951340343707852]]],["List",["List",-1.039558454088799,4.890738003669028],["Scaled",["List",-8.316467632710392e-4,3.912590402935222e-3],["List",-1.039558454088799,4.890738003669028]]],["List",["List",-1.2096094779983388,4.851478631379982],["Scaled",["List",-9.676875823986711e-4,3.881182905103986e-3],["List",-1.2096094779983388,4.851478631379982]]],["List",["List",-1.3781867790849944,4.806308479691595],["Scaled",["List",-1.1025494232679955e-3,3.8450467837532762e-3],["List",-1.3781867790849944,4.806308479691595]]],["List",["List",-1.5450849718747377,4.755282581475767],["Scaled",["List",-1.2360679774997903e-3,3.8042260651806143e-3],["List",-1.5450849718747377,4.755282581475767]]],["List",["List",-1.8730329670795616,4.635919272833936],["Scaled",["List",-1.4984263736636493e-3,3.7087354182671495e-3],["List",-1.8730329670795616,4.635919272833936]]],["List",["List",-2.0336832153790003,4.567727288213005],["Scaled",["List",-1.6269465723032005e-3,3.654181830570404e-3],["List",-2.0336832153790003,4.567727288213005]]],["List",["List",-2.191855733945389,4.493970231495834],["Scaled",["List",-1.753484587156311e-3,3.5951761851966673e-3],["List",-2.191855733945389,4.493970231495834]]],["List",["List",-2.3473578139294538,4.414737964294635],["Scaled",["List",-1.877886251143563e-3,3.531790371435708e-3],["List",-2.3473578139294538,4.414737964294635]]],["List",["List",-2.649596321166025,4.24024048078213],["Scaled",["List",-2.11967705693282e-3,3.3921923846257037e-3],["List",-2.649596321166025,4.24024048078213]]],["List",["List",-2.795964517353733,4.1451878627752095],["Scaled",["List",-2.2367716138829864e-3,3.3161502902201673e-3],["List",-2.795964517353733,4.1451878627752095]]],["List",["List",-2.9389262614623664,4.045084971874736],["Scaled",["List",-2.351141009169893e-3,3.2360679774997895e-3],["List",-2.9389262614623664,4.045084971874736]]],["List",["List",-3.0783073766282905,3.9400537680336107],["Scaled",["List",-2.462645901302632e-3,3.1520430144268887e-3],["List",-3.0783073766282905,3.9400537680336107]]],["List",["List",-3.3456530317942907,3.715724127386972],["Scaled",["List",-2.6765224254354327e-3,2.9725793019095776e-3],["List",-3.3456530317942907,3.715724127386972]]],["List",["List",-3.473291852294987,3.5966990016932545],["Scaled",["List",-2.77863348183599e-3,2.8773592013546035e-3],["List",-3.473291852294987,3.5966990016932545]]],["List",["List",-3.5966990016932554,3.4732918522949867],["Scaled",["List",-2.8773592013546043e-3,2.7786334818359895e-3],["List",-3.5966990016932554,3.4732918522949867]]],["List",["List",-3.7157241273869728,3.3456530317942894],["Scaled",["List",-2.9725793019095784e-3,2.676522425435432e-3],["List",-3.7157241273869728,3.3456530317942894]]],["List",["List",-3.83022221559489,3.2139380484326963],["Scaled",["List",-3.064177772475912e-3,2.571150438746157e-3],["List",-3.83022221559489,3.2139380484326963]]],["List",["List",-3.940053768033609,3.0783073766282927],["Scaled",["List",-3.1520430144268874e-3,2.462645901302634e-3],["List",-3.940053768033609,3.0783073766282927]]],["List",["List",-4.045084971874737,2.938926261462365],["Scaled",["List",-3.23606797749979e-3,2.351141009169892e-3],["List",-4.045084971874737,2.938926261462365]]],["List",["List",-4.145187862775208,2.795964517353735],["Scaled",["List",-3.316150290220166e-3,2.236771613882988e-3],["List",-4.145187862775208,2.795964517353735]]],["List",["List",-4.240240480782131,2.649596321166024],["Scaled",["List",-3.392192384625704e-3,2.119677056932819e-3],["List",-4.240240480782131,2.649596321166024]]],["List",["List",-4.330127018922193,2.5000000000000004],["Scaled",["List",-3.4641016151377543e-3,2.0000000000000005e-3],["List",-4.330127018922193,2.5000000000000004]]],["List",["List",-4.414737964294636,2.3473578139294524],["Scaled",["List",-3.5317903714357085e-3,1.877886251143562e-3],["List",-4.414737964294636,2.3473578139294524]]],["List",["List",-4.493970231495835,2.1918557339453875],["Scaled",["List",-3.5951761851966677e-3,1.75348458715631e-3],["List",-4.493970231495835,2.1918557339453875]]],["List",["List",-4.567727288213005,2.033683215378999],["Scaled",["List",-3.6541818305704044e-3,1.6269465723031994e-3],["List",-4.567727288213005,2.033683215378999]]],["List",["List",-4.635919272833937,1.87303296707956],["Scaled",["List",-3.70873541826715e-3,1.4984263736636482e-3],["List",-4.635919272833937,1.87303296707956]]],["List",["List",-4.698463103929541,1.7101007166283453],["Scaled",["List",-3.758770483143633e-3,1.3680805733026762e-3],["List",-4.698463103929541,1.7101007166283453]]],["List",["List",-4.755282581475768,1.5450849718747364],["Scaled",["List",-3.8042260651806148e-3,1.2360679774997892e-3],["List",-4.755282581475768,1.5450849718747364]]],["List",["List",-4.806308479691594,1.3781867790849973],["Scaled",["List",-3.8450467837532754e-3,1.1025494232679979e-3],["List",-4.806308479691594,1.3781867790849973]]],["List",["List",-4.851478631379982,1.2096094779983375],["Scaled",["List",-3.881182905103986e-3,9.6768758239867e-4],["List",-4.851478631379982,1.2096094779983375]]],["List",["List",-4.890738003669028,1.0395584540887977],["Scaled",["List",-3.912590402935222e-3,8.316467632710381e-4],["List",-4.890738003669028,1.0395584540887977]]],["List",["List",-4.951340343707852,0.6958655048003276],["Scaled",["List",-3.961072274966281e-3,5.566924038402621e-4],["List",-4.951340343707852,0.6958655048003276]]],["List",["List",-4.972609476841367,0.5226423163382653],["Scaled",["List",-3.978087581473094e-3,4.181138530706122e-4],["List",-4.972609476841367,0.5226423163382653]]],["List",["List",-4.987820251299121,0.3487823687206264],["Scaled",["List",-3.9902562010392965e-3,2.790258949765011e-4],["List",-4.987820251299121,0.3487823687206264]]],["List",["List",-4.9969541350954785,0.1744974835125067],["Scaled",["List",-3.997563308076383e-3,1.3959798681000539e-4],["List",-4.9969541350954785,0.1744974835125067]]],["List",["List",-4.9969541350954785,-0.1744974835125035],["Scaled",["List",-3.997563308076383e-3,-1.395979868100028e-4],["List",-4.9969541350954785,-0.1744974835125035]]],["List",["List",-4.987820251299121,-0.3487823687206276],["Scaled",["List",-3.9902562010392965e-3,-2.790258949765021e-4],["List",-4.987820251299121,-0.3487823687206276]]],["List",["List",-4.972609476841367,-0.5226423163382664],["Scaled",["List",-3.978087581473094e-3,-4.181138530706132e-4],["List",-4.972609476841367,-0.5226423163382664]]],["List",["List",-4.951340343707852,-0.6958655048003287],["Scaled",["List",-3.961072274966281e-3,-5.56692403840263e-4],["List",-4.951340343707852,-0.6958655048003287]]],["List",["List",-4.890738003669028,-1.0395584540887985],["Scaled",["List",-3.912590402935222e-3,-8.316467632710389e-4],["List",-4.890738003669028,-1.0395584540887985]]],["List",["List",-4.851478631379982,-1.2096094779983386],["Scaled",["List",-3.881182905103986e-3,-9.676875823986709e-4],["List",-4.851478631379982,-1.2096094779983386]]],["List",["List",-4.806308479691595,-1.3781867790849942],["Scaled",["List",-3.8450467837532762e-3,-1.1025494232679953e-3],["List",-4.806308479691595,-1.3781867790849942]]],["List",["List",-4.755282581475767,-1.5450849718747375],["Scaled",["List",-3.8042260651806143e-3,-1.23606797749979e-3],["List",-4.755282581475767,-1.5450849718747375]]],["List",["List",-4.698463103929543,-1.7101007166283424],["Scaled",["List",-3.758770483143634e-3,-1.368080573302674e-3],["List",-4.698463103929543,-1.7101007166283424]]],["List",["List",-4.635919272833936,-1.8730329670795611],["Scaled",["List",-3.7087354182671495e-3,-1.498426373663649e-3],["List",-4.635919272833936,-1.8730329670795611]]],["List",["List",-4.567727288213005,-2.0336832153790003],["Scaled",["List",-3.654181830570404e-3,-1.6269465723032003e-3],["List",-4.567727288213005,-2.0336832153790003]]],["List",["List",-4.493970231495834,-2.1918557339453884],["Scaled",["List",-3.5951761851966673e-3,-1.7534845871563108e-3],["List",-4.493970231495834,-2.1918557339453884]]],["List",["List",-4.414737964294635,-2.3473578139294533],["Scaled",["List",-3.531790371435708e-3,-1.8778862511435628e-3],["List",-4.414737964294635,-2.3473578139294533]]],["List",["List",-4.330127018922193,-2.5000000000000018],["Scaled",["List",-3.464101615137754e-3,-2.0000000000000013e-3],["List",-4.330127018922193,-2.5000000000000018]]],["List",["List",-4.24024048078213,-2.649596321166025],["Scaled",["List",-3.3921923846257037e-3,-2.11967705693282e-3],["List",-4.24024048078213,-2.649596321166025]]],["List",["List",-4.1451878627752095,-2.7959645173537324],["Scaled",["List",-3.3161502902201677e-3,-2.236771613882986e-3],["List",-4.1451878627752095,-2.7959645173537324]]],["List",["List",-4.045084971874736,-2.9389262614623664],["Scaled",["List",-3.2360679774997895e-3,-2.351141009169893e-3],["List",-4.045084971874736,-2.9389262614623664]]],["List",["List",-3.9400537680336107,-3.0783073766282905],["Scaled",["List",-3.1520430144268887e-3,-2.462645901302632e-3],["List",-3.9400537680336107,-3.0783073766282905]]],["List",["List",-3.715724127386972,-3.3456530317942903],["Scaled",["List",-2.9725793019095776e-3,-2.6765224254354323e-3],["List",-3.715724127386972,-3.3456530317942903]]],["List",["List",-3.5966990016932563,-3.473291852294986],["Scaled",["List",-2.877359201354605e-3,-2.7786334818359886e-3],["List",-3.5966990016932563,-3.473291852294986]]],["List",["List",-3.4732918522949867,-3.5966990016932554],["Scaled",["List",-2.7786334818359895e-3,-2.8773592013546043e-3],["List",-3.4732918522949867,-3.5966990016932554]]],["List",["List",-3.345653031794291,-3.715724127386971],["Scaled",["List",-2.676522425435433e-3,-2.972579301909577e-3],["List",-3.345653031794291,-3.715724127386971]]],["List",["List",-3.0783073766282913,-3.94005376803361],["Scaled",["List",-2.462645901302633e-3,-3.1520430144268883e-3],["List",-3.0783073766282913,-3.94005376803361]]],["List",["List",-2.938926261462365,-4.045084971874737],["Scaled",["List",-2.351141009169892e-3,-3.23606797749979e-3],["List",-2.938926261462365,-4.045084971874737]]],["List",["List",-2.7959645173537333,-4.145187862775209],["Scaled",["List",-2.236771613882987e-3,-3.316150290220167e-3],["List",-2.7959645173537333,-4.145187862775209]]],["List",["List",-2.649596321166024,-4.240240480782131],["Scaled",["List",-2.119677056932819e-3,-3.392192384625704e-3],["List",-2.649596321166024,-4.240240480782131]]],["List",["List",-2.500000000000001,-4.330127018922193],["Scaled",["List",-2.000000000000001e-3,-3.4641016151377543e-3],["List",-2.500000000000001,-4.330127018922193]]],["List",["List",-2.3473578139294546,-4.414737964294634],["Scaled",["List",-1.8778862511435637e-3,-3.5317903714357076e-3],["List",-2.3473578139294546,-4.414737964294634]]],["List",["List",-2.1918557339453875,-4.493970231495835],["Scaled",["List",-1.7534845871563101e-3,-3.5951761851966677e-3],["List",-2.1918557339453875,-4.493970231495835]]],["List",["List",-2.033683215379001,-4.567727288213004],["Scaled",["List",-1.6269465723032011e-3,-3.6541818305704035e-3],["List",-2.033683215379001,-4.567727288213004]]],["List",["List",-1.8730329670795602,-4.635919272833937],["Scaled",["List",-1.4984263736636484e-3,-3.70873541826715e-3],["List",-1.8730329670795602,-4.635919272833937]]],["List",["List",-1.5450849718747368,-4.755282581475768],["Scaled",["List",-1.2360679774997894e-3,-3.8042260651806148e-3],["List",-1.5450849718747368,-4.755282581475768]]],["List",["List",-1.3781867790849953,-4.8063084796915945],["Scaled",["List",-1.1025494232679962e-3,-3.845046783753276e-3],["List",-1.3781867790849953,-4.8063084796915945]]],["List",["List",-1.2096094779983377,-4.851478631379982],["Scaled",["List",-9.676875823986703e-4,-3.881182905103986e-3],["List",-1.2096094779983377,-4.851478631379982]]],["List",["List",-1.0395584540887979,-4.890738003669028],["Scaled",["List",-8.316467632710383e-4,-3.912590402935222e-3],["List",-1.0395584540887979,-4.890738003669028]]],["List",["List",-0.8682408883346526,-4.92403876506104],["Scaled",["List",-6.945927106677221e-4,-3.939231012048832e-3],["List",-0.8682408883346526,-4.92403876506104]]],["List",["List",-0.6958655048003279,-4.951340343707852],["Scaled",["List",-5.566924038402624e-4,-3.961072274966281e-3],["List",-0.6958655048003279,-4.951340343707852]]],["List",["List",-0.5226423163382677,-4.972609476841367],["Scaled",["List",-4.181138530706142e-4,-3.978087581473094e-3],["List",-0.5226423163382677,-4.972609476841367]]],["List",["List",-0.3487823687206266,-4.987820251299121],["Scaled",["List",-2.7902589497650135e-4,-3.9902562010392965e-3],["List",-0.3487823687206266,-4.987820251299121]]],["List",["List",-0.17449748351250477,-4.9969541350954785],["Scaled",["List",-1.395979868100038e-4,-3.997563308076383e-3],["List",-0.17449748351250477,-4.9969541350954785]]],["List",["List",0.1744974835125054,-4.9969541350954785],["Scaled",["List",1.3959798681000433e-4,-3.997563308076383e-3],["List",0.1744974835125054,-4.9969541350954785]]],["List",["List",0.3487823687206273,-4.987820251299121],["Scaled",["List",2.7902589497650184e-4,-3.9902562010392965e-3],["List",0.3487823687206273,-4.987820251299121]]],["List",["List",0.5226423163382684,-4.972609476841367],["Scaled",["List",4.181138530706147e-4,-3.978087581473094e-3],["List",0.5226423163382684,-4.972609476841367]]],["List",["List",0.6958655048003262,-4.951340343707852],["Scaled",["List",5.566924038402609e-4,-3.961072274966282e-3],["List",0.6958655048003262,-4.951340343707852]]],["List",["List",1.039558454088796,-4.8907380036690284],["Scaled",["List",8.31646763271037e-4,-3.912590402935223e-3],["List",1.039558454088796,-4.8907380036690284]]],["List",["List",1.2096094779983384,-4.851478631379982],["Scaled",["List",9.676875823986707e-4,-3.881182905103986e-3],["List",1.2096094779983384,-4.851478631379982]]],["List",["List",1.3781867790849958,-4.8063084796915945],["Scaled",["List",1.1025494232679966e-3,-3.845046783753276e-3],["List",1.3781867790849958,-4.8063084796915945]]],["List",["List",1.5450849718747373,-4.755282581475767],["Scaled",["List",1.2360679774997899e-3,-3.8042260651806143e-3],["List",1.5450849718747373,-4.755282581475767]]],["List",["List",1.873032967079561,-4.635919272833936],["Scaled",["List",1.4984263736636488e-3,-3.7087354182671495e-3],["List",1.873032967079561,-4.635919272833936]]],["List",["List",2.0336832153790017,-4.567727288213003],["Scaled",["List",1.6269465723032016e-3,-3.654181830570403e-3],["List",2.0336832153790017,-4.567727288213003]]],["List",["List",2.191855733945386,-4.493970231495835],["Scaled",["List",1.753484587156309e-3,-3.595176185196668e-3],["List",2.191855733945386,-4.493970231495835]]],["List",["List",2.3473578139294533,-4.414737964294635],["Scaled",["List",1.8778862511435626e-3,-3.531790371435708e-3],["List",2.3473578139294533,-4.414737964294635]]],["List",["List",2.4999999999999996,-4.330127018922194],["Scaled",["List",1.9999999999999996e-3,-3.4641016151377548e-3],["List",2.4999999999999996,-4.330127018922194]]],["List",["List",2.6495963211660243,-4.24024048078213],["Scaled",["List",2.1196770569328195e-3,-3.3921923846257037e-3],["List",2.6495963211660243,-4.24024048078213]]],["List",["List",2.7959645173537337,-4.145187862775209],["Scaled",["List",2.2367716138829872e-3,-3.316150290220167e-3],["List",2.7959645173537337,-4.145187862775209]]],["List",["List",2.938926261462366,-4.045084971874737],["Scaled",["List",2.3511410091698924e-3,-3.23606797749979e-3],["List",2.938926261462366,-4.045084971874737]]],["List",["List",3.078307376628292,-3.9400537680336094],["Scaled",["List",2.4626459013026335e-3,-3.152043014426888e-3],["List",3.078307376628292,-3.9400537680336094]]],["List",["List",3.3456530317942916,-3.7157241273869706],["Scaled",["List",2.6765224254354336e-3,-2.9725793019095767e-3],["List",3.3456530317942916,-3.7157241273869706]]],["List",["List",3.473291852294986,-3.5966990016932563],["Scaled",["List",2.7786334818359886e-3,-2.877359201354605e-3],["List",3.473291852294986,-3.5966990016932563]]],["List",["List",3.596699001693255,-3.4732918522949867],["Scaled",["List",2.877359201354604e-3,-2.7786334818359895e-3],["List",3.596699001693255,-3.4732918522949867]]],["List",["List",3.7157241273869706,-3.3456530317942916],["Scaled",["List",2.9725793019095767e-3,-2.6765224254354336e-3],["List",3.7157241273869706,-3.3456530317942916]]],["List",["List",3.9400537680336094,-3.0783073766282913],["Scaled",["List",3.152043014426888e-3,-2.462645901302633e-3],["List",3.9400537680336094,-3.0783073766282913]]],["List",["List",4.045084971874737,-2.938926261462366],["Scaled",["List",3.23606797749979e-3,-2.3511410091698924e-3],["List",4.045084971874737,-2.938926261462366]]],["List",["List",4.145187862775209,-2.7959645173537337],["Scaled",["List",3.316150290220167e-3,-2.2367716138829872e-3],["List",4.145187862775209,-2.7959645173537337]]],["List",["List",4.240240480782131,-2.6495963211660243],["Scaled",["List",3.392192384625704e-3,-2.1196770569328195e-3],["List",4.240240480782131,-2.6495963211660243]]],["List",["List",4.330127018922194,-2.499999999999999],["Scaled",["List",3.4641016151377548e-3,-1.999999999999999e-3],["List",4.330127018922194,-2.499999999999999]]],["List",["List",4.414737964294634,-2.347357813929455],["Scaled",["List",3.5317903714357076e-3,-1.877886251143564e-3],["List",4.414737964294634,-2.347357813929455]]],["List",["List",4.493970231495835,-2.191855733945388],["Scaled",["List",3.5951761851966677e-3,-1.7534845871563104e-3],["List",4.493970231495835,-2.191855733945388]]],["List",["List",4.567727288213004,-2.0336832153790017],["Scaled",["List",3.6541818305704035e-3,-1.6269465723032013e-3],["List",4.567727288213004,-2.0336832153790017]]],["List",["List",4.635919272833936,-1.8730329670795607],["Scaled",["List",3.7087354182671495e-3,-1.4984263736636486e-3],["List",4.635919272833936,-1.8730329670795607]]],["List",["List",4.698463103929542,-1.710100716628344],["Scaled",["List",3.7587704831436334e-3,-1.3680805733026751e-3],["List",4.698463103929542,-1.710100716628344]]],["List",["List",4.755282581475767,-1.545084971874737],["Scaled",["List",3.8042260651806143e-3,-1.2360679774997896e-3],["List",4.755282581475767,-1.545084971874737]]],["List",["List",4.8063084796915945,-1.3781867790849955],["Scaled",["List",3.845046783753276e-3,-1.1025494232679964e-3],["List",4.8063084796915945,-1.3781867790849955]]],["List",["List",4.851478631379982,-1.2096094779983393],["Scaled",["List",3.881182905103986e-3,-9.676875823986713e-4],["List",4.851478631379982,-1.2096094779983393]]],["List",["List",4.890738003669028,-1.039558454088797],["Scaled",["List",3.912590402935222e-3,-8.316467632710376e-4],["List",4.890738003669028,-1.039558454088797]]],["List",["List",4.951340343707852,-0.695865504800327],["Scaled",["List",3.961072274966282e-3,-5.566924038402617e-4],["List",4.951340343707852,-0.695865504800327]]],["List",["List",4.972609476841367,-0.5226423163382681],["Scaled",["List",3.978087581473094e-3,-4.1811385307061443e-4],["List",4.972609476841367,-0.5226423163382681]]],["List",["List",4.987820251299121,-0.348782368720627],["Scaled",["List",3.9902562010392965e-3,-2.790258949765016e-4],["List",4.987820251299121,-0.348782368720627]]],["List",["List",4.9969541350954785,-0.1744974835125051],["Scaled",["List",3.997563308076383e-3,-1.3959798681000408e-4],["List",4.9969541350954785,-0.1744974835125051]]],["List",["List",4.9969541350954785,0.1744974835125051],["Scaled",["List",3.997563308076383e-3,1.3959798681000408e-4],["List",4.9969541350954785,0.1744974835125051]]],["List",["List",4.987820251299121,0.3487823687206259],["Scaled",["List",3.990256201039297e-3,2.790258949765007e-4],["List",4.987820251299121,0.3487823687206259]]],["List",["List",4.972609476841367,0.522642316338267],["Scaled",["List",3.978087581473094e-3,4.1811385307061357e-4],["List",4.972609476841367,0.522642316338267]]],["List",["List",4.951340343707852,0.695865504800327],["Scaled",["List",3.961072274966282e-3,5.566924038402617e-4],["List",4.951340343707852,0.695865504800327]]],["List",["List",4.890738003669028,1.039558454088797],["Scaled",["List",3.912590402935222e-3,8.316467632710376e-4],["List",4.890738003669028,1.039558454088797]]],["List",["List",4.851478631379982,1.2096094779983382],["Scaled",["List",3.881182905103986e-3,9.676875823986705e-4],["List",4.851478631379982,1.2096094779983382]]],["List",["List",4.8063084796915945,1.3781867790849955],["Scaled",["List",3.845046783753276e-3,1.1025494232679964e-3],["List",4.8063084796915945,1.3781867790849955]]],["List",["List",4.755282581475767,1.545084971874737],["Scaled",["List",3.8042260651806143e-3,1.2360679774997896e-3],["List",4.755282581475767,1.545084971874737]]],["List",["List",4.698463103929542,1.710100716628344],["Scaled",["List",3.7587704831436334e-3,1.3680805733026751e-3],["List",4.698463103929542,1.710100716628344]]],["List",["List",4.635919272833937,1.8730329670795596],["Scaled",["List",3.70873541826715e-3,1.4984263736636477e-3],["List",4.635919272833937,1.8730329670795596]]],["List",["List",4.567727288213005,2.0336832153790008],["Scaled",["List",3.654181830570404e-3,1.6269465723032007e-3],["List",4.567727288213005,2.0336832153790008]]],["List",["List",4.493970231495835,2.191855733945387],["Scaled",["List",3.595176185196668e-3,1.7534845871563097e-3],["List",4.493970231495835,2.191855733945387]]],["List",["List",4.414737964294635,2.347357813929454],["Scaled",["List",3.531790371435708e-3,1.8778862511435632e-3],["List",4.414737964294635,2.347357813929454]]],["List",["List",4.240240480782131,2.6495963211660243],["Scaled",["List",3.392192384625704e-3,2.1196770569328195e-3],["List",4.240240480782131,2.6495963211660243]]],["List",["List",4.145187862775209,2.7959645173537337],["Scaled",["List",3.316150290220167e-3,2.2367716138829872e-3],["List",4.145187862775209,2.7959645173537337]]],["List",["List",4.045084971874737,2.938926261462366],["Scaled",["List",3.23606797749979e-3,2.3511410091698924e-3],["List",4.045084971874737,2.938926261462366]]],["List",["List",3.94005376803361,3.078307376628291],["Scaled",["List",3.1520430144268883e-3,2.4626459013026326e-3],["List",3.94005376803361,3.078307376628291]]],["List",["List",3.715724127386972,3.3456530317942907],["Scaled",["List",2.9725793019095776e-3,2.6765224254354327e-3],["List",3.715724127386972,3.3456530317942907]]],["List",["List",3.596699001693256,3.4732918522949863],["Scaled",["List",2.8773592013546048e-3,2.778633481835989e-3],["List",3.596699001693256,3.4732918522949863]]],["List",["List",3.4732918522949863,3.5966990016932554],["Scaled",["List",2.778633481835989e-3,2.8773592013546043e-3],["List",3.4732918522949863,3.5966990016932554]]],["List",["List",3.345653031794291,3.715724127386971],["Scaled",["List",2.676522425435433e-3,2.972579301909577e-3],["List",3.345653031794291,3.715724127386971]]],["List",["List",3.078307376628292,3.9400537680336094],["Scaled",["List",2.4626459013026335e-3,3.152043014426888e-3],["List",3.078307376628292,3.9400537680336094]]],["List",["List",2.938926261462366,4.045084971874737],["Scaled",["List",2.3511410091698924e-3,3.23606797749979e-3],["List",2.938926261462366,4.045084971874737]]],["List",["List",2.7959645173537346,4.145187862775208],["Scaled",["List",2.2367716138829877e-3,3.3161502902201664e-3],["List",2.7959645173537346,4.145187862775208]]],["List",["List",2.6495963211660243,4.24024048078213],["Scaled",["List",2.1196770569328195e-3,3.3921923846257037e-3],["List",2.6495963211660243,4.24024048078213]]],["List",["List",2.4999999999999996,4.330127018922194],["Scaled",["List",1.9999999999999996e-3,3.4641016151377548e-3],["List",2.4999999999999996,4.330127018922194]]],["List",["List",2.347357813929454,4.414737964294634],["Scaled",["List",1.8778862511435635e-3,3.5317903714357076e-3],["List",2.347357813929454,4.414737964294634]]],["List",["List",2.1918557339453875,4.493970231495835],["Scaled",["List",1.75348458715631e-3,3.5951761851966677e-3],["List",2.1918557339453875,4.493970231495835]]],["List",["List",2.0336832153790017,4.567727288213003],["Scaled",["List",1.6269465723032016e-3,3.654181830570403e-3],["List",2.0336832153790017,4.567727288213003]]],["List",["List",1.873032967079561,4.635919272833936],["Scaled",["List",1.4984263736636488e-3,3.7087354182671495e-3],["List",1.873032967079561,4.635919272833936]]],["List",["List",1.5450849718747373,4.755282581475767],["Scaled",["List",1.2360679774997899e-3,3.8042260651806143e-3],["List",1.5450849718747373,4.755282581475767]]],["List",["List",1.3781867790849958,4.8063084796915945],["Scaled",["List",1.1025494232679966e-3,3.845046783753276e-3],["List",1.3781867790849958,4.8063084796915945]]],["List",["List",1.2096094779983384,4.851478631379982],["Scaled",["List",9.676875823986707e-4,3.881182905103986e-3],["List",1.2096094779983384,4.851478631379982]]],["List",["List",1.0395584540887972,4.890738003669028],["Scaled",["List",8.316467632710379e-4,3.912590402935222e-3],["List",1.0395584540887972,4.890738003669028]]],["List",["List",0.6958655048003273,4.951340343707852],["Scaled",["List",5.566924038402619e-4,3.961072274966282e-3],["List",0.6958655048003273,4.951340343707852]]],["List",["List",0.5226423163382673,4.972609476841367],["Scaled",["List",4.1811385307061384e-4,3.978087581473094e-3],["List",0.5226423163382673,4.972609476841367]]],["List",["List",0.3487823687206273,4.987820251299121],["Scaled",["List",2.7902589497650184e-4,3.9902562010392965e-3],["List",0.3487823687206273,4.987820251299121]]],["List",["List",0.1744974835125054,4.9969541350954785],["Scaled",["List",1.3959798681000433e-4,3.997563308076383e-3],["List",0.1744974835125054,4.9969541350954785]]]]],["List"]],["List",["Text",["Style",0,["List"]],["Offset",["List",4.898587196589413e-16,8],["List",3.061616997868383e-16,5]],["List",-6.123233995736766e-17,-1],["Rule","Background","Automatic"]],["Text",["Style",10,["List"]],["Offset",["List",1.3891854213354433,7.878462024097664],["List",0.8682408883346521,4.92403876506104]],["List",-0.17364817766693041,-0.984807753012208],["Rule","Background","Automatic"]],["Text",["Style",20,["List"]],["Offset",["List",2.7361611466053506,7.5175409662872665],["List",1.7101007166283442,4.698463103929542]],["List",-0.3420201433256688,-0.9396926207859083],["Rule","Background","Automatic"]],["Text",["Style",30,["List"]],["Offset",["List",4.000000000000001,6.928203230275509],["List",2.5000000000000004,4.330127018922193]],["List",-0.5000000000000001,-0.8660254037844386],["Rule","Background","Automatic"]],["Text",["Style",40,["List"]],["Offset",["List",5.142300877492315,6.128355544951824],["List",3.2139380484326967,3.83022221559489]],["List",-0.6427876096865394,-0.766044443118978],["Rule","Background","Automatic"]],["Text",["Style",50,["List"]],["Offset",["List",6.128355544951824,5.142300877492314],["List",3.83022221559489,3.2139380484326963]],["List",-0.766044443118978,-0.6427876096865393],["Rule","Background","Automatic"]],["Text",["Style",60,["List"]],["Offset",["List",6.928203230275509,4],["List",4.330127018922193,2.5]],["List",-0.8660254037844386,-0.5],["Rule","Background","Automatic"]],["Text",["Style",70,["List"]],["Offset",["List",7.5175409662872665,2.736161146605351],["List",4.698463103929542,1.7101007166283444]],["List",-0.9396926207859083,-0.3420201433256689],["Rule","Background","Automatic"]],["Text",["Style",80,["List"]],["Offset",["List",7.878462024097664,1.3891854213354429],["List",4.92403876506104,0.8682408883346517]],["List",-0.984807753012208,-0.17364817766693036],["Rule","Background","Automatic"]],["Text",["Style",90,["List"]],["Offset",["List",8,0],["List",5,0]],["List",-1,0],["Rule","Background","Automatic"]],["Text",["Style",100,["List"]],["Offset",["List",7.878462024097664,-1.3891854213354429],["List",4.92403876506104,-0.8682408883346517]],["List",-0.984807753012208,0.17364817766693036],["Rule","Background","Automatic"]],["Text",["Style",110,["List"]],["Offset",["List",7.5175409662872665,-2.736161146605352],["List",4.698463103929542,-1.7101007166283448]],["List",-0.9396926207859083,0.342020143325669],["Rule","Background","Automatic"]],["Text",["Style",120,["List"]],["Offset",["List",6.928203230275509,-4],["List",4.330127018922193,-2.5]],["List",-0.8660254037844386,0.5],["Rule","Background","Automatic"]],["Text",["Style",130,["List"]],["Offset",["List",6.128355544951824,-5.142300877492315],["List",3.83022221559489,-3.2139380484326967]],["List",-0.766044443118978,0.6427876096865394],["Rule","Background","Automatic"]],["Text",["Style",140,["List"]],["Offset",["List",5.142300877492316,-6.128355544951824],["List",3.2139380484326976,-3.83022221559489]],["List",-0.6427876096865395,0.766044443118978],["Rule","Background","Automatic"]],["Text",["Style",150,["List"]],["Offset",["List",4.000000000000001,-6.928203230275509],["List",2.5000000000000004,-4.330127018922193]],["List",-0.5000000000000001,0.8660254037844386],["Rule","Background","Automatic"]],["Text",["Style",160,["List"]],["Offset",["List",2.7361611466053506,-7.5175409662872665],["List",1.7101007166283442,-4.698463103929542]],["List",-0.3420201433256688,0.9396926207859083],["Rule","Background","Automatic"]],["Text",["Style",170,["List"]],["Offset",["List",1.3891854213354418,-7.878462024097665],["List",0.8682408883346511,-4.924038765061041]],["List",-0.17364817766693022,0.9848077530122081],["Rule","Background","Automatic"]],["Text",["Style",180,["List"]],["Offset",["List",4.898587196589413e-16,-8],["List",3.061616997868383e-16,-5]],["List",-6.123233995736766e-17,1],["Rule","Background","Automatic"]],["Text",["Style",190,["List"]],["Offset",["List",-1.3891854213354407,-7.878462024097665],["List",-0.8682408883346504,-4.924038765061041]],["List",0.17364817766693008,0.9848077530122081],["Rule","Background","Automatic"]],["Text",["Style",200,["List"]],["Offset",["List",-2.7361611466053497,-7.517540966287267],["List",-1.7101007166283435,-4.698463103929543]],["List",0.3420201433256687,0.9396926207859084],["Rule","Background","Automatic"]],["Text",["Style",210,["List"]],["Offset",["List",-3.9999999999999987,-6.92820323027551],["List",-2.499999999999999,-4.330127018922194]],["List",0.49999999999999983,0.8660254037844387],["Rule","Background","Automatic"]],["Text",["Style",220,["List"]],["Offset",["List",-5.142300877492315,-6.128355544951824],["List",-3.2139380484326967,-3.83022221559489]],["List",0.6427876096865394,0.766044443118978],["Rule","Background","Automatic"]],["Text",["Style",230,["List"]],["Offset",["List",-6.128355544951823,-5.142300877492316],["List",-3.8302222155948895,-3.2139380484326976]],["List",0.7660444431189779,0.6427876096865395],["Rule","Background","Automatic"]],["Text",["Style",240,["List"]],["Offset",["List",-6.92820323027551,-3.9999999999999996],["List",-4.330127018922194,-2.4999999999999996]],["List",0.8660254037844387,0.49999999999999994],["Rule","Background","Automatic"]],["Text",["Style",250,["List"]],["Offset",["List",-7.5175409662872665,-2.736161146605351],["List",-4.698463103929542,-1.7101007166283444]],["List",0.9396926207859083,0.3420201433256689],["Rule","Background","Automatic"]],["Text",["Style",260,["List"]],["Offset",["List",-7.878462024097664,-1.3891854213354422],["List",-4.92403876506104,-0.8682408883346514]],["List",0.984807753012208,0.17364817766693028],["Rule","Background","Automatic"]],["Text",["Style",270,["List"]],["Offset",["List",-8,-9.797174393178826e-16],["List",-5,-6.123233995736766e-16]],["List",1,1.2246467991473532e-16],["Rule","Background","Automatic"]],["Text",["Style",280,["List"]],["Offset",["List",-7.878462024097665,1.3891854213354402],["List",-4.924038765061041,0.8682408883346502]],["List",0.9848077530122081,-0.17364817766693003],["Rule","Background","Automatic"]],["Text",["Style",290,["List"]],["Offset",["List",-7.517540966287267,2.7361611466053493],["List",-4.698463103929543,1.7101007166283433]],["List",0.9396926207859084,-0.34202014332566866],["Rule","Background","Automatic"]],["Text",["Style",300,["List"]],["Offset",["List",-6.9282032302755105,3.9999999999999982],["List",-4.3301270189221945,2.499999999999999]],["List",0.8660254037844388,-0.4999999999999998],["Rule","Background","Automatic"]],["Text",["Style",310,["List"]],["Offset",["List",-6.128355544951827,5.142300877492311],["List",-3.8302222155948917,3.2139380484326945]],["List",0.7660444431189783,-0.6427876096865389],["Rule","Background","Automatic"]],["Text",["Style",320,["List"]],["Offset",["List",-5.142300877492316,6.128355544951823],["List",-3.2139380484326976,3.8302222155948895]],["List",0.6427876096865395,-0.7660444431189779],["Rule","Background","Automatic"]],["Text",["Style",330,["List"]],["Offset",["List",-4.0000000000000036,6.928203230275507],["List",-2.500000000000002,4.330127018922192]],["List",0.5000000000000004,-0.8660254037844384],["Rule","Background","Automatic"]],["Text",["Style",340,["List"]],["Offset",["List",-2.7361611466053484,7.517540966287267],["List",-1.7101007166283426,4.698463103929543]],["List",0.34202014332566855,-0.9396926207859084],["Rule","Background","Automatic"]],["Text",["Style",350,["List"]],["Offset",["List",-1.3891854213354426,7.878462024097664],["List",-0.8682408883346516,4.92403876506104]],["List",0.17364817766693033,-0.984807753012208],["Rule","Background","Automatic"]]],["List",["Circle",["List",0,0],5,["List",-4.71238898038469,1.5707963267948966]]]]],["List",["List",["Directive",["GrayLevel",0.6],["Rule","Antialiasing",false]],["Line",["List",["List",0,0],["List",0,5]]]],["List",["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",0,0]],["Scaled",["List",6.0e-3,0],["List",0,0]]]],["Directive",["GrayLevel",0.6],["List"],["Rule","Antialiasing",false]]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",0,1]],["Scaled",["List",6.0e-3,0],["List",0,1]]]],["Directive",["GrayLevel",0.6],["List"],["Rule","Antialiasing",false]]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",0,2]],["Scaled",["List",6.0e-3,0],["List",0,2]]]],["Directive",["GrayLevel",0.6],["List"],["Rule","Antialiasing",false]]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",0,3]],["Scaled",["List",6.0e-3,0],["List",0,3]]]],["Directive",["GrayLevel",0.6],["List"],["Rule","Antialiasing",false]]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",0,4]],["Scaled",["List",6.0e-3,0],["List",0,4]]]],["Directive",["GrayLevel",0.6],["List"],["Rule","Antialiasing",false]]]],["List",["Style",["Line",["List",["Scaled",["List",0,0],["List",0,5]],["Scaled",["List",6.0e-3,0],["List",0,5]]]],["Directive",["GrayLevel",0.6],["List"],["Rule","Antialiasing",false]]]]],["Style",["Line",["List",["List",["List",0,0],["Scaled",["List",3.0e-3,0],["List",0,0]]],["List",["List",0,0.2],["Scaled",["List",3.0e-3,0],["List",0,0.2]]],["List",["List",0,0.4],["Scaled",["List",3.0e-3,0],["List",0,0.4]]],["List",["List",0,0.6],["Scaled",["List",3.0e-3,0],["List",0,0.6]]],["List",["List",0,0.8],["Scaled",["List",3.0e-3,0],["List",0,0.8]]],["List",["List",0,1],["Scaled",["List",3.0e-3,0],["List",0,1]]],["List",["List",0,1],["Scaled",["List",3.0e-3,0],["List",0,1]]],["List",["List",0,1.2],["Scaled",["List",3.0e-3,0],["List",0,1.2]]],["List",["List",0,1.4],["Scaled",["List",3.0e-3,0],["List",0,1.4]]],["List",["List",0,1.6],["Scaled",["List",3.0e-3,0],["List",0,1.6]]],["List",["List",0,1.8],["Scaled",["List",3.0e-3,0],["List",0,1.8]]],["List",["List",0,2],["Scaled",["List",3.0e-3,0],["List",0,2]]],["List",["List",0,2],["Scaled",["List",3.0e-3,0],["List",0,2]]],["List",["List",0,2.2],["Scaled",["List",3.0e-3,0],["List",0,2.2]]],["List",["List",0,2.4],["Scaled",["List",3.0e-3,0],["List",0,2.4]]],["List",["List",0,2.6],["Scaled",["List",3.0e-3,0],["List",0,2.6]]],["List",["List",0,2.8],["Scaled",["List",3.0e-3,0],["List",0,2.8]]],["List",["List",0,3],["Scaled",["List",3.0e-3,0],["List",0,3]]],["List",["List",0,3],["Scaled",["List",3.0e-3,0],["List",0,3]]],["List",["List",0,3.2],["Scaled",["List",3.0e-3,0],["List",0,3.2]]],["List",["List",0,3.4],["Scaled",["List",3.0e-3,0],["List",0,3.4]]],["List",["List",0,3.6],["Scaled",["List",3.0e-3,0],["List",0,3.6]]],["List",["List",0,3.8],["Scaled",["List",3.0e-3,0],["List",0,3.8]]],["List",["List",0,4],["Scaled",["List",3.0e-3,0],["List",0,4]]],["List",["List",0,4],["Scaled",["List",3.0e-3,0],["List",0,4]]],["List",["List",0,4.2],["Scaled",["List",3.0e-3,0],["List",0,4.2]]],["List",["List",0,4.4],["Scaled",["List",3.0e-3,0],["List",0,4.4]]],["List",["List",0,4.6],["Scaled",["List",3.0e-3,0],["List",0,4.6]]],["List",["List",0,4.8],["Scaled",["List",3.0e-3,0],["List",0,4.8]]],["List",["List",0,5],["Scaled",["List",3.0e-3,0],["List",0,5]]]]],["List"]],["List",["Text",["Style",0,["List"]],["Offset",["List",8,0],["Scaled",["List",6.0e-3,0],["List",0,0]]],["List",-1,0]],["Text",["Style",1,["List"]],["Offset",["List",8,0],["Scaled",["List",6.0e-3,0],["List",0,1]]],["List",-1,0]],["Text",["Style",2,["List"]],["Offset",["List",8,0],["Scaled",["List",6.0e-3,0],["List",0,2]]],["List",-1,0]],["Text",["Style",3,["List"]],["Offset",["List",8,0],["Scaled",["List",6.0e-3,0],["List",0,3]]],["List",-1,0]],["Text",["Style",4,["List"]],["Offset",["List",8,0],["Scaled",["List",6.0e-3,0],["List",0,4]]],["List",-1,0]],["Text",["Style",5,["List"]],["Offset",["List",8,0],["Scaled",["List",6.0e-3,0],["List",0,5]]],["List",-1,0]]]]]],["List",["Rule","ContentSelectable",false],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List",["Times",-2,"Pi"],["Times",2,"Pi"]],["List",["Times",-2,"Pi"],["Times",2,"Pi"]]]],["Rule","PlotRangePadding",["Scaled",5.0e-2]]]]]],
	["Rule","'be015f7a-923d-405f-9e23-fa69166e4f4e'",["Hold",["Graphics",["List",["List",["Opacity",0],["Point",["List",["List",0.574231609613984,0],["List",9.231973780043699,0]]]],["List",["List"],["List",["List",["List"],["List",["List"],["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Rectangle",["List",0.7439912600145666,0],["List",1.64639475600874,1],["Rule","'RoundingRadius'",0]],1],["Style",1,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Tooltip",["StatusArea",["Rectangle",["List",1.7439912600145666,0],["List",2.64639475600874,2],["Rule","'RoundingRadius'",0]],2],["Style",2,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.4992,0.5552,0.8309304]],["Tooltip",["StatusArea",["Rectangle",["List",2.7439912600145666,0],["List",3.64639475600874,3],["Rule","'RoundingRadius'",0]],3],["Style",3,["List"]]]]]],["List"],["List"]],["List",["List"],["List",["List"],["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Rectangle",["List",4.0367807720320465,0],["List",4.93918426802622,1],["Rule","'RoundingRadius'",0]],1],["Style",1,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Tooltip",["StatusArea",["Rectangle",["List",5.0367807720320465,0],["List",5.93918426802622,3],["Rule","'RoundingRadius'",0]],3],["Style",3,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.4992,0.5552,0.8309304]],["Tooltip",["StatusArea",["Rectangle",["List",6.0367807720320465,0],["List",6.93918426802622,2],["Rule","'RoundingRadius'",0]],2],["Style",2,["List"]]]]]],["List"],["List"]],["List",["List"],["List",["List"],["List",["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Tooltip",["StatusArea",["Rectangle",["List",7.3295702840495265,0],["List",8.231973780043699,5],["Rule","'RoundingRadius'",0]],5],["Style",5,["List"]]]],["List",["Directive",["EdgeForm",["Directive",["Thickness","Small"],["Opacity",0.644]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Tooltip",["StatusArea",["Rectangle",["List",8.329570284049526,0],["List",9.231973780043699,2],["Rule","'RoundingRadius'",0]],2],["Style",2,["List"]]]]]],["List"],["List"]]],["List"],["List"]],["List"],["List"],["List"],["List"],["List",["Style",["List",["Rule","Antialiasing",false],["List",["Directive",["Thickness","Tiny"]],["List",["Line",["List",["List",0.574231609613984,0],["List",9.405128623452294,0]]]],["Style",["List"],"'GraphicsLabel'"]],["Style",["List",["List",["Directive",["Thickness","Tiny"]],["Line",["List",["List",0.7439912600145666,0],["Offset",["List",-1.102182119232618e-15,-6],["List",0.7439912600145666,0]]]],["Line",["List",["List",9.231973780043699,0],["Offset",["List",-1.102182119232618e-15,-6],["List",9.231973780043699,0]]]],["List",["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List"],["List",["Line",["List",["List",3.64639475600874,0],["Offset",["List",-1.102182119232618e-15,-6],["List",3.64639475600874,0]]]],["Line",["List",["List",4.0367807720320465,0],["Offset",["List",-1.102182119232618e-15,-6],["List",4.0367807720320465,0]]]],["Line",["List",["List",6.93918426802622,0],["Offset",["List",-1.102182119232618e-15,-6],["List",6.93918426802622,0]]]],["Line",["List",["List",7.3295702840495265,0],["Offset",["List",-1.102182119232618e-15,-6],["List",7.3295702840495265,0]]]]]]],["Style",["List"],"'GraphicsLabel'"]],"'GraphicsTicks'"]],"'GraphicsAxes'"]]],["List",["Rule","AspectRatio",["Power","GoldenRatio",-1]],["Rule","Axes",["List",false,true]],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",0.574231609613984,0]],["Rule","CoordinatesToolOptions",["List",["Rule","'DisplayFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]],["Rule","'CopiedValueFunction'",["Function",["List",["Identity",["Part",["Slot",1],1]],["Identity",["Part",["Slot",1],2]]]]]]],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameTicks",["List",["List","Automatic","Automatic"],["List","Automatic","Automatic"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List","All","All"],["List","All","All"]]],["Rule","PlotRangePadding",["List",["List",["Scaled",2.0e-2],["Scaled",2.0e-2]],["List",["Scaled",2.0e-2],["Scaled",5.0e-2]]]],["Rule","Ticks",["List","None","Automatic"]]]]]],
	["Rule","'f81af593-92be-4a57-9814-c48fbc4be695'",["Hold",["Graphics",["List",["List"],["List"],["DynamicModule",["List",["Set","DynamicChart`click$529454",false],["Set","DynamicChart`click$529460",false],["Set","DynamicChart`click$529466",false],["Set","DynamicChart`click$529475",false],["Set","DynamicChart`click$529481",false],["Set","DynamicChart`click$529487",false]],["List",["List",["Directive",["RGBColor",0.5,0.5,1],["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]]],["List",["List",["List",["List",["List",["List",["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Polygon",["List",["List",1.0112712429686843,0.7347315653655915],["List",0.9356384352138764,0.828903322800994],["List",0.8512698234834964,0.9153358332472168],["List",0.758953134773389,0.9932220996421928],["List",0.6595503051326659,1.0618349189019012],["List",0.5539894319990517,1.1205336716196297],["List",0.44325610880316946,1.1687703033567685],["List",0.3283842227482336,1.2060944416794392],["List",0.2104463016837983,1.2321576011645634],["List",9.054350020220273e-2,1.246716437114364],["List",-3.020468154516537e-2,1.249635017600241],["List",-0.1506708503191539,1.2408860926225675],["List",-0.2697302459597578,1.22055134853659],["List",-0.3862712429686844,1.1888206453689418],["List",-0.49920572945711944,1.145990244145728],["List",-0.6074792665532577,1.0924600407831475],["List",-0.7100809334139446,1.0287298323670706],["List",-0.8060527659202134,0.9553946506823102],["List",-0.8944987009301517,0.8731392065611709],["List",-0.9745929425790278,0.7827314969228925],["List",-1.0455876725127835,0.6850156341933376],["List",-1.1068200320665125,0.5809039650547103],["List",-1.1577183111972207,0.4713685521104004],["List",-1.1978072863864577,0.3574320979983616],["List",-1.2267126576742668,0.24015839669213518],["List",-1.2441645433970607,0.12064240114314383],["List",-1.25,-4.0203066241915914e-16],["List",-2.25,2.755455298081545e-16],["List",-2.2394961781147096,0.2171563220576589],["List",-2.2080827838136803,0.43228511404584435],["List",-2.156053115495624,0.6433777763970508],["List",-2.083892960154997,0.8484633937987217],["List",-1.992276057719722,1.0456271370984795],["List",-1.8820578105230101,1.2330281415480076],["List",-1.7542672966422501,1.4089166944612064],["List",-1.6100976616742722,1.5716505718101084],["List",-1.4508949786563834,1.7197103712281592],["List",-1.2781456801451003,1.851713698260727],["List",-1.0934626797958629,1.966428073409666],["List",-0.8985703130228144,2.0627824394623104],["List",-0.695288237343631,2.1398771616640957],["List",-0.48551444272756356,2.196992427365862],["List",-0.2712075305744765,2.2335949667206214],["List",-5.436842678129716e-2,2.249343031680434],["List",0.1629783003639659,2.244089586805855],["List",0.3788033430308374,2.2178836820962142],["List",0.5910916009468209,2.1709699950229906],["List",0.7978609958457055,2.103786546042183],["List",0.9971809775982939,2.016960608915333],["List",1.187190549238799,1.9113028540234218],["List",1.3661156425921004,1.787799779355947],["List",1.5322856822702942,1.6476044998449897],["List",1.6841491833849778,1.4920259810417889],["List",1.8202882373436322,1.3225168176580637]]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-6.180339887498947e-2],["List",0,1,0.19021130325903074],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529475"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Polygon",["List",["List",-0.3862712429686842,-1.188820645368942],["List",-0.26973024595975753,-1.2205513485365902],["List",-0.15067085031915362,-1.2408860926225675],["List",-3.020468154516537e-2,-1.249635017600241],["List",9.0543500202203e-2,-1.246716437114364],["List",0.2104463016837983,-1.2321576011645634],["List",0.32838422274823387,-1.2060944416794392],["List",0.44325610880316973,-1.1687703033567685],["List",0.5539894319990517,-1.1205336716196297],["List",0.6595503051326662,-1.061834918901901],["List",0.7589531347733891,-0.9932220996421928],["List",0.8512698234834966,-0.9153358332472168],["List",0.9356384352138765,-0.8289033228009939],["List",1.0112712429686845,-0.7347315653655911],["List",1.0774620836000617,-0.6336998172669879],["List",1.133592951063182,-0.5267513847156612],["List",1.179139766572179,-0.41488481641066033],["List",1.2136772717825652,-0.29914458035944697],["List",1.236882999313814,-0.18061131196152633],["List",1.2485402835404082,-6.039172440688373e-2],["List",1.2485402835404082,6.0391724406884006e-2],["List",1.2368829993138137,0.18061131196152713],["List",1.213677271782565,0.29914458035944747],["List",1.1791397665721788,0.4148848164106606],["List",1.1335929510631817,0.5267513847156617],["List",1.0774620836000615,0.6336998172669882],["List",1.011271242968684,0.7347315653655918],["List",1.8202882373436318,1.3225168176580646],["List",1.9394317504801108,1.1406596710805783],["List",2.0404673119137273,0.9481524924881904],["List",2.122451579829922,0.7467926695391889],["List",2.184619089208617,0.5384602446470048],["List",2.226389398764865,0.3251003615307479],["List",2.247372510372735,0.1087051039323907],["List",2.247372510372735,-0.10870510393239095],["List",2.226389398764865,-0.32510036153074817],["List",2.184619089208617,-0.5384602446470053],["List",2.1224515798299217,-0.7467926695391891],["List",2.0404673119137273,-0.9481524924881907],["List",1.9394317504801106,-1.1406596710805788],["List",1.8202882373436315,-1.3225168176580648],["List",1.6841491833849775,-1.492025981041789],["List",1.5322856822702933,-1.6476044998449906],["List",1.3661156425921,-1.7877997793559472],["List",1.1871905492387984,-1.9113028540234225],["List",0.9971809775982925,-2.016960608915334],["List",0.797860995845705,-2.1037865460421834],["List",0.5910916009468205,-2.1709699950229906],["List",0.37880334303083596,-2.2178836820962147],["List",0.1629783003639649,-2.2440895868058552],["List",-5.436842678129766e-2,-2.249343031680434],["List",-0.2712075305744775,-2.2335949667206214],["List",-0.48551444272756406,-2.196992427365862],["List",-0.6952882373436325,-2.1398771616640953]]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.1618033988749895],["List",0,1,-0.11755705045849463],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529481"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.4992,0.5552,0.8309304]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Polygon",["List",["List",-1.25,-1.5308084989341916e-16],["List",-1.2441645433970607,-0.12064240114314383],["List",-1.2267126576742668,-0.24015839669213573],["List",-1.1978072863864577,-0.3574320979983616],["List",-1.1577183111972205,-0.47136855211040096],["List",-1.1068200320665122,-0.5809039650547109],["List",-1.0455876725127835,-0.6850156341933376],["List",-0.9745929425790278,-0.7827314969228925],["List",-0.8944987009301513,-0.8731392065611714],["List",-0.806052765920213,-0.9553946506823107],["List",-0.7100809334139446,-1.0287298323670706],["List",-0.6074792665532571,-1.0924600407831477],["List",-0.49920572945711916,-1.1459902441457281],["List",-0.38627124296868387,-1.188820645368942],["List",-0.6952882373436315,-2.1398771616640957],["List",-0.898570313022815,-2.0627824394623104],["List",-1.0934626797958638,-1.9664280734096655],["List",-1.2781456801451003,-1.851713698260727],["List",-1.450894978656384,-1.7197103712281585],["List",-1.6100976616742722,-1.5716505718101084],["List",-1.7542672966422501,-1.4089166944612064],["List",-1.8820578105230101,-1.2330281415480076],["List",-1.992276057719722,-1.0456271370984795],["List",-2.0838929601549974,-0.8484633937987207],["List",-2.156053115495624,-0.6433777763970508],["List",-2.2080827838136803,-0.43228511404584335],["List",-2.2394961781147096,-0.2171563220576589],["List",-2.25,-2.755455298081545e-16]]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.1618033988749895],["List",0,1,-0.11755705045849466],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529487"]]]]]],["List",["List",["List",["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.982864,0.7431472,0.3262672]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",2.0943951023931957,3.141592653589793]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.17320508075688776],["List",0,1,9.999999999999999e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529454"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.784,0.47519999999999996,0.2]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",0,2.0943951023931957]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,9.999999999999998e-2],["List",0,1,0.17320508075688776],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529460"]]],["List",["Directive",["EdgeForm",["Directive",["GrayLevel",0],["Opacity",0.5]]],["RGBColor",0.4992,0.5552,0.8309304]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["Charting`DelayedMouseEffect",["Disk",["List",0,0],1,["List",-3.141592653589793,0]],["List","'Style'",["EdgeForm",["List",["GrayLevel",0.5],["AbsoluteThickness",2.5],["Opacity",0.66]]]]],3],["Style",3,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,1.2246467991473533e-17],["List",0,1,-0.2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529466"]]]]]]]],["List"]],["List",["List"],["List"],["List"]]]],["List",["List",["List",["List",["List",["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.17320508075688776],["List",0,1,9.999999999999999e-2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529454"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,9.999999999999998e-2],["List",0,1,0.17320508075688776],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529460"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],3],["Style",3,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,1.2246467991473533e-17],["List",0,1,-0.2],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529466"]]],["List"]],["List"]],["List",["List",["List",["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-6.180339887498947e-2],["List",0,1,0.19021130325903074],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529475"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],2],["Style",2,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,0.1618033988749895],["List",0,1,-0.11755705045849463],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529481"]],["Charting`DelayedClickEffect",["Tooltip",["StatusArea",["List",["List"],["List"]],1],["Style",1,["List"]]],["List","'GeometricTransformation'",["TransformationFunction",["List",["List",1,0,-0.1618033988749895],["List",0,1,-0.11755705045849466],["List",0,0,1]]]],["Dynamic","DynamicChart`click$529487"]]],["List"]],["List"]]],["List"]],["List"],["List"]],["RuleDelayed","DynamicModuleValues",["List"]]],["List",["List",["List"],["List"]],["List",["List"],["List"]]],["List",["List",["List",["List"],["List"],["List"],["List"]],["List",["List"],["List"],["List"],["List"]]],["List"]]],["List",["Rule","ContentSelectable",false],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","PlotRange",["List",["List",-2.25,2.25],["List",-2.25,2.25]]],["Rule","PlotRangePadding",["Scaled",5.0e-2]]]]]]
]}</script><meta serializer="separator"/><script id="cells-data" type="application/json">{"storage": [
	"Association",
	["Rule","'Cells'",["List",["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\n## Bubble chart'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'1051fc34-831e-4396-b4f7-196487ec6fda'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-1051fc34-831e-4396-b4f7-196487ec6fda\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-1051fc34-831e-4396-b4f7-196487ec6fda\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"1051fc34-831e-4396-b4f7-196487ec6fda\"><div id=\"gi-1051fc34-831e-4396-b4f7-196487ec6fda\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-1051fc34-831e-4396-b4f7-196487ec6fda\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'## Bubble chart'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'a9b3659d-cc2f-4583-8ae4-3a661cf94759'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-a9b3659d-cc2f-4583-8ae4-3a661cf94759\"><div id=\"frame-a9b3659d-cc2f-4583-8ae4-3a661cf94759\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"a9b3659d-cc2f-4583-8ae4-3a661cf94759\"><div id=\"gi-a9b3659d-cc2f-4583-8ae4-3a661cf94759\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'BubbleChart[RandomReal[1, {5, 7, 3}]]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'41b20662-c3d4-4c69-aff2-82efc1f8c504'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-41b20662-c3d4-4c69-aff2-82efc1f8c504\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-41b20662-c3d4-4c69-aff2-82efc1f8c504\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"41b20662-c3d4-4c69-aff2-82efc1f8c504\"><div id=\"gi-41b20662-c3d4-4c69-aff2-82efc1f8c504\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-41b20662-c3d4-4c69-aff2-82efc1f8c504\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"44f319c3-084b-4355-bf29-f7afde4f7de0\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKm5ikGRtaJhvrGliYJOmaGJua6ialGVnqppknpqWkmqSZp6QaAAB86xXd\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'67ea1d26-6a07-46bc-b979-853e75ea358e'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-67ea1d26-6a07-46bc-b979-853e75ea358e\"><div id=\"frame-67ea1d26-6a07-46bc-b979-853e75ea358e\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"67ea1d26-6a07-46bc-b979-853e75ea358e\"><div id=\"gi-67ea1d26-6a07-46bc-b979-853e75ea358e\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'BubbleChart[RandomReal[1, {10, 3}], \n ChartElementFunction -> \"NoiseBubble\"]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'66c757b1-35d4-4aeb-9709-5ef7692a199f'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-66c757b1-35d4-4aeb-9709-5ef7692a199f\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-66c757b1-35d4-4aeb-9709-5ef7692a199f\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"66c757b1-35d4-4aeb-9709-5ef7692a199f\"><div id=\"gi-66c757b1-35d4-4aeb-9709-5ef7692a199f\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-66c757b1-35d4-4aeb-9709-5ef7692a199f\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"f79760d0-3fd5-41d4-8bef-5cd40ce1f85e\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKp5lbmpsZpBjoGqelmOqaGKaY6FokpabpmianmBgkpxqmWZimAgCF8xYP\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'82c7ccec-693b-4c27-a1e5-8235a1c7e19a'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-82c7ccec-693b-4c27-a1e5-8235a1c7e19a\"><div id=\"frame-82c7ccec-693b-4c27-a1e5-8235a1c7e19a\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"82c7ccec-693b-4c27-a1e5-8235a1c7e19a\"><div id=\"gi-82c7ccec-693b-4c27-a1e5-8235a1c7e19a\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\n## Bar Charts\nGenerate a bar chart for a list of heights'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'ed5f3b3c-ddfd-4b1c-83f1-3e5dd1bd2c1d'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-ed5f3b3c-ddfd-4b1c-83f1-3e5dd1bd2c1d\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-ed5f3b3c-ddfd-4b1c-83f1-3e5dd1bd2c1d\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"ed5f3b3c-ddfd-4b1c-83f1-3e5dd1bd2c1d\"><div id=\"gi-ed5f3b3c-ddfd-4b1c-83f1-3e5dd1bd2c1d\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-ed5f3b3c-ddfd-4b1c-83f1-3e5dd1bd2c1d\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'## Bar Charts\nGenerate a bar chart for a list of heights'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'1b7d31ad-16a2-46e4-bb8d-80be3ff581c1'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-1b7d31ad-16a2-46e4-bb8d-80be3ff581c1\"><div id=\"frame-1b7d31ad-16a2-46e4-bb8d-80be3ff581c1\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"1b7d31ad-16a2-46e4-bb8d-80be3ff581c1\"><div id=\"gi-1b7d31ad-16a2-46e4-bb8d-80be3ff581c1\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'BarChart[{1, 2, 3}]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'72d24873-e8da-4880-a811-dd369bec22e3'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-72d24873-e8da-4880-a811-dd369bec22e3\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-72d24873-e8da-4880-a811-dd369bec22e3\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"72d24873-e8da-4880-a811-dd369bec22e3\"><div id=\"gi-72d24873-e8da-4880-a811-dd369bec22e3\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-72d24873-e8da-4880-a811-dd369bec22e3\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"bc6440fb-800a-4b9a-885c-967b69a33838\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKJyWbmZgYpCXpWhgYJOqaJFkm6lpYmCbrWpqZJ5lZJhobWxhbAACE3RVQ\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'9a2675ad-a121-45a5-bc9a-46d133416ea2'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-9a2675ad-a121-45a5-bc9a-46d133416ea2\"><div id=\"frame-9a2675ad-a121-45a5-bc9a-46d133416ea2\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"9a2675ad-a121-45a5-bc9a-46d133416ea2\"><div id=\"gi-9a2675ad-a121-45a5-bc9a-46d133416ea2\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nMultiple datasets'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'e25c4e27-8130-4241-9493-f4078a791adb'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-e25c4e27-8130-4241-9493-f4078a791adb\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-e25c4e27-8130-4241-9493-f4078a791adb\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"e25c4e27-8130-4241-9493-f4078a791adb\"><div id=\"gi-e25c4e27-8130-4241-9493-f4078a791adb\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-e25c4e27-8130-4241-9493-f4078a791adb\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Multiple datasets'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'89b2dc08-d4cc-4521-a7fb-1d3878ae1371'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-89b2dc08-d4cc-4521-a7fb-1d3878ae1371\"><div id=\"frame-89b2dc08-d4cc-4521-a7fb-1d3878ae1371\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"89b2dc08-d4cc-4521-a7fb-1d3878ae1371\"><div id=\"gi-89b2dc08-d4cc-4521-a7fb-1d3878ae1371\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'BarChart[{{1, 2, 3}, {1, 3, 2}, {5, 2}}, \n ChartLabels -> {\"a\", \"b\", \"c\"}, LabelingFunction -> Above]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'3ee89e37-beee-4822-8b16-3eca5e7b09de'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-3ee89e37-beee-4822-8b16-3eca5e7b09de\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-3ee89e37-beee-4822-8b16-3eca5e7b09de\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"3ee89e37-beee-4822-8b16-3eca5e7b09de\"><div id=\"gi-3ee89e37-beee-4822-8b16-3eca5e7b09de\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-3ee89e37-beee-4822-8b16-3eca5e7b09de\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"37f38a18-eaa6-44bf-aa2f-bcd29fc1b204\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKG5unGVskGlropiYmmumamCSl6SYmGqXpJiWnGFmmJRsmGRmYAACPYhZV\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'583117e8-3b89-4cee-82da-b78cb4f009c5'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-583117e8-3b89-4cee-82da-b78cb4f009c5\"><div id=\"frame-583117e8-3b89-4cee-82da-b78cb4f009c5\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"583117e8-3b89-4cee-82da-b78cb4f009c5\"><div id=\"gi-583117e8-3b89-4cee-82da-b78cb4f009c5\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nCategorical legends'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'492a1e79-c49c-4f73-a535-5019748b042a'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-492a1e79-c49c-4f73-a535-5019748b042a\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-492a1e79-c49c-4f73-a535-5019748b042a\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"492a1e79-c49c-4f73-a535-5019748b042a\"><div id=\"gi-492a1e79-c49c-4f73-a535-5019748b042a\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-492a1e79-c49c-4f73-a535-5019748b042a\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Categorical legends'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'e7c2c913-ac4a-41b1-81d6-80cbad979e04'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-e7c2c913-ac4a-41b1-81d6-80cbad979e04\"><div id=\"frame-e7c2c913-ac4a-41b1-81d6-80cbad979e04\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"e7c2c913-ac4a-41b1-81d6-80cbad979e04\"><div id=\"gi-e7c2c913-ac4a-41b1-81d6-80cbad979e04\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'BarChart[{{1, 2, 3}, {1, 3, 2}, {5, 2}}, \n ChartLegends -> {\"a\", \"b\", \"c\"}]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'2f0d7238-2d6d-4fff-a937-1e07f750e286'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-2f0d7238-2d6d-4fff-a937-1e07f750e286\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-2f0d7238-2d6d-4fff-a937-1e07f750e286\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"2f0d7238-2d6d-4fff-a937-1e07f750e286\"><div id=\"gi-2f0d7238-2d6d-4fff-a937-1e07f750e286\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-2f0d7238-2d6d-4fff-a937-1e07f750e286\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"04343707-6532-46f9-ad2d-ca2228fb2f46\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKG5gYmxibG5jrmpkaG+mamKVZ6iamGKXoJicaGRlZpCUZpZmYAQBuWBUP\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'b3de38af-328a-4441-952f-d6dfb54226c7'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-b3de38af-328a-4441-952f-d6dfb54226c7\"><div id=\"frame-b3de38af-328a-4441-952f-d6dfb54226c7\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"b3de38af-328a-4441-952f-d6dfb54226c7\"><div id=\"gi-b3de38af-328a-4441-952f-d6dfb54226c7\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\n\n## Sector charts\nA sector chart with the second component representing the radial size'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'6e8e9b4d-bb83-4e96-a482-b09d1c5b849f'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-6e8e9b4d-bb83-4e96-a482-b09d1c5b849f\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-6e8e9b4d-bb83-4e96-a482-b09d1c5b849f\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"6e8e9b4d-bb83-4e96-a482-b09d1c5b849f\"><div id=\"gi-6e8e9b4d-bb83-4e96-a482-b09d1c5b849f\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-6e8e9b4d-bb83-4e96-a482-b09d1c5b849f\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'\n## Sector charts\nA sector chart with the second component representing the radial size'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'b11045d8-0ca3-48e0-bb8f-fcecf734046b'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-b11045d8-0ca3-48e0-bb8f-fcecf734046b\"><div id=\"frame-b11045d8-0ca3-48e0-bb8f-fcecf734046b\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"b11045d8-0ca3-48e0-bb8f-fcecf734046b\"><div id=\"gi-b11045d8-0ca3-48e0-bb8f-fcecf734046b\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'SectorChart[{{1, 1}, {1, 2}, {1, 3}}]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'980495c2-9e5c-46dd-b455-9b8a4dd63ee7'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-980495c2-9e5c-46dd-b455-9b8a4dd63ee7\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-980495c2-9e5c-46dd-b455-9b8a4dd63ee7\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"980495c2-9e5c-46dd-b455-9b8a4dd63ee7\"><div id=\"gi-980495c2-9e5c-46dd-b455-9b8a4dd63ee7\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-980495c2-9e5c-46dd-b455-9b8a4dd63ee7\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"199a2580-954b-4151-8652-904912b8ba92\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKG1paJhqZWhjoWpqaJOmaGJoa6lqYmRrpWhqYWBoaJVkkJVoaAQBpUxRb\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'5bdf3d24-aba8-4c2d-b3b8-994575b08cb2'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-5bdf3d24-aba8-4c2d-b3b8-994575b08cb2\"><div id=\"frame-5bdf3d24-aba8-4c2d-b3b8-994575b08cb2\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"5bdf3d24-aba8-4c2d-b3b8-994575b08cb2\"><div id=\"gi-5bdf3d24-aba8-4c2d-b3b8-994575b08cb2\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nAn anuual sector chart'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'9a23ba80-5ed6-408d-b9da-a278c023d2ed'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-9a23ba80-5ed6-408d-b9da-a278c023d2ed\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-9a23ba80-5ed6-408d-b9da-a278c023d2ed\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"9a23ba80-5ed6-408d-b9da-a278c023d2ed\"><div id=\"gi-9a23ba80-5ed6-408d-b9da-a278c023d2ed\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-9a23ba80-5ed6-408d-b9da-a278c023d2ed\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'An anuual sector chart'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'c6de63d4-0ba6-4027-8bc4-00d938246ba2'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-c6de63d4-0ba6-4027-8bc4-00d938246ba2\"><div id=\"frame-c6de63d4-0ba6-4027-8bc4-00d938246ba2\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"c6de63d4-0ba6-4027-8bc4-00d938246ba2\"><div id=\"gi-c6de63d4-0ba6-4027-8bc4-00d938246ba2\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'SectorChart[{{1, 1}, {1, 2}, {1, 3}}, SectorOrigin -> {Automatic, 1}]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'8edf750a-c931-49e5-8dba-5ad6e067a2b7'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-8edf750a-c931-49e5-8dba-5ad6e067a2b7\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-8edf750a-c931-49e5-8dba-5ad6e067a2b7\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"8edf750a-c931-49e5-8dba-5ad6e067a2b7\"><div id=\"gi-8edf750a-c931-49e5-8dba-5ad6e067a2b7\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-8edf750a-c931-49e5-8dba-5ad6e067a2b7\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"e3409c35-8582-4b3f-a317-13e8585a18d7\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKpxqbGFgmG5vqWphaGOmaJBmn6SYaG5rrGhqnAkVMEw0tUswBdjIU7Q==\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'56391a06-b85c-4bf4-9d40-f7e6ffbfa95c'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-56391a06-b85c-4bf4-9d40-f7e6ffbfa95c\"><div id=\"frame-56391a06-b85c-4bf4-9d40-f7e6ffbfa95c\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"56391a06-b85c-4bf4-9d40-f7e6ffbfa95c\"><div id=\"gi-56391a06-b85c-4bf4-9d40-f7e6ffbfa95c\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\n## Pie chart\nGenerate a pie chart for a list of values'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'e49a7a2e-1d7d-4ae0-a88a-3e341206ccb6'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-e49a7a2e-1d7d-4ae0-a88a-3e341206ccb6\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-e49a7a2e-1d7d-4ae0-a88a-3e341206ccb6\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"e49a7a2e-1d7d-4ae0-a88a-3e341206ccb6\"><div id=\"gi-e49a7a2e-1d7d-4ae0-a88a-3e341206ccb6\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-e49a7a2e-1d7d-4ae0-a88a-3e341206ccb6\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'## Pie chart\nGenerate a pie chart for a list of values'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'f45e1bc6-e690-4385-b772-3f8e2250d286'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-f45e1bc6-e690-4385-b772-3f8e2250d286\"><div id=\"frame-f45e1bc6-e690-4385-b772-3f8e2250d286\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"f45e1bc6-e690-4385-b772-3f8e2250d286\"><div id=\"gi-f45e1bc6-e690-4385-b772-3f8e2250d286\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'PieChart[{1, 2, 3, 4}]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'ed26e1be-f40a-40cd-b8cc-bf82b325e7d2'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-ed26e1be-f40a-40cd-b8cc-bf82b325e7d2\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-ed26e1be-f40a-40cd-b8cc-bf82b325e7d2\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"ed26e1be-f40a-40cd-b8cc-bf82b325e7d2\"><div id=\"gi-ed26e1be-f40a-40cd-b8cc-bf82b325e7d2\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-ed26e1be-f40a-40cd-b8cc-bf82b325e7d2\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"2a87b6f8-cea7-4c17-863d-070124d53f1e\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKGyVamCeZpVnoJqcmmuuaJBua61qYGafoGpgbGBqZpJgapxmmAgCFTRV1\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'2d2b3066-16f2-428f-8fb3-d6b676f5057e'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-2d2b3066-16f2-428f-8fb3-d6b676f5057e\"><div id=\"frame-2d2b3066-16f2-428f-8fb3-d6b676f5057e\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"2d2b3066-16f2-428f-8fb3-d6b676f5057e\"><div id=\"gi-2d2b3066-16f2-428f-8fb3-d6b676f5057e\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nMultiple datasets and categorical labels'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'769f41ca-3d51-4ca3-a78c-5895a0fd8981'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-769f41ca-3d51-4ca3-a78c-5895a0fd8981\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-769f41ca-3d51-4ca3-a78c-5895a0fd8981\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"769f41ca-3d51-4ca3-a78c-5895a0fd8981\"><div id=\"gi-769f41ca-3d51-4ca3-a78c-5895a0fd8981\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-769f41ca-3d51-4ca3-a78c-5895a0fd8981\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Multiple datasets and categorical labels'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'810f9296-accb-4c1a-81e0-9a3bc3c74b49'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-810f9296-accb-4c1a-81e0-9a3bc3c74b49\"><div id=\"frame-810f9296-accb-4c1a-81e0-9a3bc3c74b49\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"810f9296-accb-4c1a-81e0-9a3bc3c74b49\"><div id=\"gi-810f9296-accb-4c1a-81e0-9a3bc3c74b49\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'PieChart[{{1, 2, 3}, {2, 2, 1}}, ChartLabels -> {\"a\", \"b\", \"c\"}]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'090d156c-e052-440a-9c81-fad5c69059a1'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-090d156c-e052-440a-9c81-fad5c69059a1\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-090d156c-e052-440a-9c81-fad5c69059a1\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"090d156c-e052-440a-9c81-fad5c69059a1\"><div id=\"gi-090d156c-e052-440a-9c81-fad5c69059a1\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-090d156c-e052-440a-9c81-fad5c69059a1\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"7f26095d-4a5a-4740-98ba-53418641c212\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKm6cZmRlYmqbomiSaJuqamJsY6FpaJCXqmhqbGFqYmRgmGxkaAQB3exSw\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'f19159f0-483e-419f-b877-c8f7cce8ce58'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-f19159f0-483e-419f-b877-c8f7cce8ce58\"><div id=\"frame-f19159f0-483e-419f-b877-c8f7cce8ce58\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"f19159f0-483e-419f-b877-c8f7cce8ce58\"><div id=\"gi-f19159f0-483e-419f-b877-c8f7cce8ce58\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nOr as legends'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'f2fb3074-6152-43e0-a0fc-11ffdb8c5ea3'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-f2fb3074-6152-43e0-a0fc-11ffdb8c5ea3\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-f2fb3074-6152-43e0-a0fc-11ffdb8c5ea3\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"f2fb3074-6152-43e0-a0fc-11ffdb8c5ea3\"><div id=\"gi-f2fb3074-6152-43e0-a0fc-11ffdb8c5ea3\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-f2fb3074-6152-43e0-a0fc-11ffdb8c5ea3\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Or as legends'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'19ab1c75-17f5-414b-a103-aa9c59d61863'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-19ab1c75-17f5-414b-a103-aa9c59d61863\"><div id=\"frame-19ab1c75-17f5-414b-a103-aa9c59d61863\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"19ab1c75-17f5-414b-a103-aa9c59d61863\"><div id=\"gi-19ab1c75-17f5-414b-a103-aa9c59d61863\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'PieChart[{{1, 2, 3}, {2, 2, 1}}, ChartLegends -> {\"a\", \"b\", \"c\"}]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'4110a063-3737-4f64-b75e-be0df795126c'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-4110a063-3737-4f64-b75e-be0df795126c\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-4110a063-3737-4f64-b75e-be0df795126c\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"4110a063-3737-4f64-b75e-be0df795126c\"><div id=\"gi-4110a063-3737-4f64-b75e-be0df795126c\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-4110a063-3737-4f64-b75e-be0df795126c\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"f397805e-de62-4a70-ae83-3de12aa36421\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKpxlbmlsYmKbqpqSaGemaJJob6CamWhjrGqekGholJhqbmRgZAgCC3RVt\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'d46ebab3-c5a2-4bfa-aa5f-e6f5f5086127'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-d46ebab3-c5a2-4bfa-aa5f-e6f5f5086127\"><div id=\"frame-d46ebab3-c5a2-4bfa-aa5f-e6f5f5086127\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"d46ebab3-c5a2-4bfa-aa5f-e6f5f5086127\"><div id=\"gi-d46ebab3-c5a2-4bfa-aa5f-e6f5f5086127\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\n## Histogram\nGenerate a histogram for a list of values'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'be66c107-c6d1-4940-abf0-b2d8aceee47d'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-be66c107-c6d1-4940-abf0-b2d8aceee47d\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-be66c107-c6d1-4940-abf0-b2d8aceee47d\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"be66c107-c6d1-4940-abf0-b2d8aceee47d\"><div id=\"gi-be66c107-c6d1-4940-abf0-b2d8aceee47d\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-be66c107-c6d1-4940-abf0-b2d8aceee47d\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'## Histogram\nGenerate a histogram for a list of values'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'033023b0-48b0-4d24-94be-f27d76c84aa6'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-033023b0-48b0-4d24-94be-f27d76c84aa6\"><div id=\"frame-033023b0-48b0-4d24-94be-f27d76c84aa6\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"033023b0-48b0-4d24-94be-f27d76c84aa6\"><div id=\"gi-033023b0-48b0-4d24-94be-f27d76c84aa6\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Histogram[RandomVariate[NormalDistribution[0, 1], 200]]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'891fa5ee-e4f9-4f67-af9b-2ca3e7769e71'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-891fa5ee-e4f9-4f67-af9b-2ca3e7769e71\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-891fa5ee-e4f9-4f67-af9b-2ca3e7769e71\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"891fa5ee-e4f9-4f67-af9b-2ca3e7769e71\"><div id=\"gi-891fa5ee-e4f9-4f67-af9b-2ca3e7769e71\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-891fa5ee-e4f9-4f67-af9b-2ca3e7769e71\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"895e4d03-4888-4fa1-89c5-db965f80a20e\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKW1iappqkGBjrmlhYWOiapCUa6lpYJpvqpiRZmpmmWRgkGhmkAgB67BVa\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'c8293eba-ab07-4c02-8714-173bac5fccbc'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-c8293eba-ab07-4c02-8714-173bac5fccbc\"><div id=\"frame-c8293eba-ab07-4c02-8714-173bac5fccbc\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"c8293eba-ab07-4c02-8714-173bac5fccbc\"><div id=\"gi-c8293eba-ab07-4c02-8714-173bac5fccbc\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nMultiple datasets'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'77e237c8-a809-44b3-a9f3-6247ff5d62c1'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-77e237c8-a809-44b3-a9f3-6247ff5d62c1\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-77e237c8-a809-44b3-a9f3-6247ff5d62c1\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"77e237c8-a809-44b3-a9f3-6247ff5d62c1\"><div id=\"gi-77e237c8-a809-44b3-a9f3-6247ff5d62c1\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-77e237c8-a809-44b3-a9f3-6247ff5d62c1\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Multiple datasets'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'8e374a2d-6eb6-44b0-b03f-1d2fa9b9aaf8'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-8e374a2d-6eb6-44b0-b03f-1d2fa9b9aaf8\"><div id=\"frame-8e374a2d-6eb6-44b0-b03f-1d2fa9b9aaf8\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"8e374a2d-6eb6-44b0-b03f-1d2fa9b9aaf8\"><div id=\"gi-8e374a2d-6eb6-44b0-b03f-1d2fa9b9aaf8\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'data1 = RandomVariate[NormalDistribution[0, 1], 500];\ndata2 = RandomVariate[NormalDistribution[3, 1\/2], 500];\n\nHistogram[{data1, data2}]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'21c8d936-d7ed-4cec-9753-7d44e984d649'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-21c8d936-d7ed-4cec-9753-7d44e984d649\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-21c8d936-d7ed-4cec-9753-7d44e984d649\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"21c8d936-d7ed-4cec-9753-7d44e984d649\"><div id=\"gi-21c8d936-d7ed-4cec-9753-7d44e984d649\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-21c8d936-d7ed-4cec-9753-7d44e984d649\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"638c18ec-495a-4a48-93ea-ae6025807404\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKmxlbJBtapCbrmliaJuqaJJpY6FoapybqJqaaGRiZWhiYmxiYAAB\/xRUY\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'d65388e7-2ed3-4028-a464-02136c8372a0'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-d65388e7-2ed3-4028-a464-02136c8372a0\"><div id=\"frame-d65388e7-2ed3-4028-a464-02136c8372a0\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"d65388e7-2ed3-4028-a464-02136c8372a0\"><div id=\"gi-d65388e7-2ed3-4028-a464-02136c8372a0\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\n__Stylize__ the data'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'452415a7-464e-479b-915f-3da454c8b006'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-452415a7-464e-479b-915f-3da454c8b006\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-452415a7-464e-479b-915f-3da454c8b006\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"452415a7-464e-479b-915f-3da454c8b006\"><div id=\"gi-452415a7-464e-479b-915f-3da454c8b006\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-452415a7-464e-479b-915f-3da454c8b006\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'__Stylize__ the data'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'dde8565b-0aa5-4e9f-9609-ec0baabc6894'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-dde8565b-0aa5-4e9f-9609-ec0baabc6894\"><div id=\"frame-dde8565b-0aa5-4e9f-9609-ec0baabc6894\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"dde8565b-0aa5-4e9f-9609-ec0baabc6894\"><div id=\"gi-dde8565b-0aa5-4e9f-9609-ec0baabc6894\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Histogram[{data1, data2}, ChartStyle -> \"Pastel\"]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'bcc32a34-e070-4c6c-953f-48efe9d84141'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-bcc32a34-e070-4c6c-953f-48efe9d84141\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-bcc32a34-e070-4c6c-953f-48efe9d84141\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"bcc32a34-e070-4c6c-953f-48efe9d84141\"><div id=\"gi-bcc32a34-e070-4c6c-953f-48efe9d84141\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-bcc32a34-e070-4c6c-953f-48efe9d84141\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"b2add816-91a1-49fa-abf7-b8f36e7c0d2b\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKJxklpqRYGJrpWhomGuqaWKYl6iYmpZnrJlmkGZulmicbpBglAQCQRBZf\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'72012d04-76c5-4dec-9db2-9cf097994563'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-72012d04-76c5-4dec-9db2-9cf097994563\"><div id=\"frame-72012d04-76c5-4dec-9db2-9cf097994563\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"72012d04-76c5-4dec-9db2-9cf097994563\"><div id=\"gi-72012d04-76c5-4dec-9db2-9cf097994563\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nUse color function'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'7e03aaac-5155-4277-b5b5-07930001c655'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-7e03aaac-5155-4277-b5b5-07930001c655\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-7e03aaac-5155-4277-b5b5-07930001c655\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"7e03aaac-5155-4277-b5b5-07930001c655\"><div id=\"gi-7e03aaac-5155-4277-b5b5-07930001c655\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-7e03aaac-5155-4277-b5b5-07930001c655\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Use color function'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'c4d71ec9-bf19-443e-b634-ea070afd2a97'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-c4d71ec9-bf19-443e-b634-ea070afd2a97\"><div id=\"frame-c4d71ec9-bf19-443e-b634-ea070afd2a97\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"c4d71ec9-bf19-443e-b634-ea070afd2a97\"><div id=\"gi-c4d71ec9-bf19-443e-b634-ea070afd2a97\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Histogram[RandomVariate[NormalDistribution[0, 1], 500], \n ColorFunction -> Function[{height}, Opacity[height]], \n ChartStyle -> Purple]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'300759a5-d8fd-4d86-9043-704d77524ec0'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-300759a5-d8fd-4d86-9043-704d77524ec0\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-300759a5-d8fd-4d86-9043-704d77524ec0\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"300759a5-d8fd-4d86-9043-704d77524ec0\"><div id=\"gi-300759a5-d8fd-4d86-9043-704d77524ec0\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-300759a5-d8fd-4d86-9043-704d77524ec0\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"01fe870c-d01c-4623-8d3e-aa0bea69f17d\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKGximpVqYGyTrphgYJuuamBkZ61qkGKfqJiYaJKUmmlmmGZqnAACE9RX3\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'49aaecfe-5ee2-4aaf-bc3d-8c89b3b7228d'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-49aaecfe-5ee2-4aaf-bc3d-8c89b3b7228d\"><div id=\"frame-49aaecfe-5ee2-4aaf-bc3d-8c89b3b7228d\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"49aaecfe-5ee2-4aaf-bc3d-8c89b3b7228d\"><div id=\"gi-49aaecfe-5ee2-4aaf-bc3d-8c89b3b7228d\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nGet the wind data directions'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'aaf263b7-262a-4cc2-a446-5933d112a702'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-aaf263b7-262a-4cc2-a446-5933d112a702\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-aaf263b7-262a-4cc2-a446-5933d112a702\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"aaf263b7-262a-4cc2-a446-5933d112a702\"><div id=\"gi-aaf263b7-262a-4cc2-a446-5933d112a702\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-aaf263b7-262a-4cc2-a446-5933d112a702\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Get the wind data directions'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'3337aa8d-7202-44aa-8d26-6a06406b3aa2'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-3337aa8d-7202-44aa-8d26-6a06406b3aa2\"><div id=\"frame-3337aa8d-7202-44aa-8d26-6a06406b3aa2\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"3337aa8d-7202-44aa-8d26-6a06406b3aa2\"><div id=\"gi-3337aa8d-7202-44aa-8d26-6a06406b3aa2\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'data = WeatherData[\"KCMI\", \n   \"WindDirection\", {{2007, 11, 1}, {2008, 11, 1}}]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'48eaea66-4b0f-4283-a34b-270c091c2b93'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-48eaea66-4b0f-4283-a34b-270c091c2b93\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-48eaea66-4b0f-4283-a34b-270c091c2b93\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"48eaea66-4b0f-4283-a34b-270c091c2b93\"><div id=\"gi-48eaea66-4b0f-4283-a34b-270c091c2b93\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-48eaea66-4b0f-4283-a34b-270c091c2b93\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)temporalStorage$434371(*,*)(*\"1:eJwlk8uyqkYARa0kg1S+IrmjcyRVvEQkM16CCAgCjXjrDhAbEHnZPLrl63NuMlm1a4\/X+uvWnfNfVqvV8McX9Ptj7BB4QBxov65W4aOBAUQPOHz\/WAPl+\/rzz4\/13+vPj\/U39h9oLS64szNXyf6VGrj07IW9zoe9xpFUpuRDD3zG7o\/wrexGFeyA6hdMigJNM5WDmFTk\/SyISW08DrWlyXVGA6L8Xmp2JeYUFPhZwoLJpDuXb7LgdVHBW54Ue1fabSoWQZCVV0e7XgoPT4GtlDmTMtGBaMvAlUYdqKSEtN0JlGFs9CVuwqHwn7dDiInnW4TwmM9xd3ROFwdrENfmxaSTbb0BKr48qeWIGKDCaLKTdxF5oUg31En0RGV0LNYO5UxfKLZNTOdAAnglXrZ\/2L1tKZBQ4dRx+SLPDmqHKnpml5zRErpm0z45mkugRQ7Poj72mdFlmc1eQkXxMOptuZyGlGdNhs1uCU6hW\/qUGKhHMXheMuQIRC+7LTVm7kvSSkSa9qQ1uDVT2jk27b3Fo3OY51sv3SsHxSLzQlXuTjEzNz0tlkIiHZkQeNPEkF4QFmusb9KbCbUtY1WQumzi8Nqee3DvzVG5CpfFBxTfF0J7orew3nsozV8YGCKybdqId2JSHETu6sI4efLCtGxoKhu41jFSaT\/wjKBKJzzInt45+15lpEmiylNQU6p2L9UmkUNrcEY6LyLgOF3dsWJRvTbJhnD+8x1Ay\/CIwmNjKLyd77FcPOF74FzPX1bgXn3r6jaz0xZYuTKjE7mNTxSR8ijszJiz9rkC5IyO3HoG+k1VD2xXIpXgvbrlLStV+BgsYf7IsiF9Az+zkFvW+mvfGqhS0Jk4bYggqzzxMrEGH221MnoY80OHYC5eoxVzVRPGcpidqc7rBsMdVPji1EZqrsU0iErBeXQtYU+VnGP47WcjP4Cy\/vzxf1y\/feE81TD4\/eeA6f3U1u\/\/3hBN8F91ziMf\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'e8a52e05-947b-49ee-be13-f875e6e15059'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-e8a52e05-947b-49ee-be13-f875e6e15059\"><div id=\"frame-e8a52e05-947b-49ee-be13-f875e6e15059\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"e8a52e05-947b-49ee-be13-f875e6e15059\"><div id=\"gi-e8a52e05-947b-49ee-be13-f875e6e15059\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nDefine a chart element function that stores bin width and count data using Sow'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'a67d4a55-272c-4088-b79d-0d28a880dd31'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-a67d4a55-272c-4088-b79d-0d28a880dd31\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-a67d4a55-272c-4088-b79d-0d28a880dd31\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"a67d4a55-272c-4088-b79d-0d28a880dd31\"><div id=\"gi-a67d4a55-272c-4088-b79d-0d28a880dd31\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-a67d4a55-272c-4088-b79d-0d28a880dd31\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Define a chart element function that stores bin width and count data using Sow'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'63b26f60-c944-45fa-bd4a-3fc0b677eae2'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-63b26f60-c944-45fa-bd4a-3fc0b677eae2\"><div id=\"frame-63b26f60-c944-45fa-bd4a-3fc0b677eae2\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"63b26f60-c944-45fa-bd4a-3fc0b677eae2\"><div id=\"gi-63b26f60-c944-45fa-bd4a-3fc0b677eae2\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'sowingBar[{{x0_, x1_}, {y0_, y1_}}, __] := (Sow[{x1 - x0, \n    100*(y1 - y0)}]; Rectangle[{x0, y0}, {x1, y1}])'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'675fd694-63aa-4076-a919-f3319a84a0fd'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-675fd694-63aa-4076-a919-f3319a84a0fd\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-675fd694-63aa-4076-a919-f3319a84a0fd\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"675fd694-63aa-4076-a919-f3319a84a0fd\"><div id=\"gi-675fd694-63aa-4076-a919-f3319a84a0fd\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-675fd694-63aa-4076-a919-f3319a84a0fd\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'{histogram, newdata} = \n  Reap[Histogram[data, Automatic, \"Probability\", \n    ChartElementFunction -> sowingBar]];\n\nhistogram '"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'64593087-c6ab-45fa-a6e2-1cf13cde18e5'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-64593087-c6ab-45fa-a6e2-1cf13cde18e5\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-64593087-c6ab-45fa-a6e2-1cf13cde18e5\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"64593087-c6ab-45fa-a6e2-1cf13cde18e5\"><div id=\"gi-64593087-c6ab-45fa-a6e2-1cf13cde18e5\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-64593087-c6ab-45fa-a6e2-1cf13cde18e5\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"dc7525c1-be14-45e7-af40-d90ae8897092\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKpySbmxqZJhvqJqUamuiamKaa6yammRjoplgaJKZaWFiaG1gaAQCHWxV7\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'026fbedd-2f48-4a60-977f-23d388fce668'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-026fbedd-2f48-4a60-977f-23d388fce668\"><div id=\"frame-026fbedd-2f48-4a60-977f-23d388fce668\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"026fbedd-2f48-4a60-977f-23d388fce668\"><div id=\"gi-026fbedd-2f48-4a60-977f-23d388fce668\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nCreate a polar histogram of the wind-direction frequencies:'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'9ac8f33f-d358-4931-a0c0-b8d49ab8b5d9'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-9ac8f33f-d358-4931-a0c0-b8d49ab8b5d9\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-9ac8f33f-d358-4931-a0c0-b8d49ab8b5d9\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"9ac8f33f-d358-4931-a0c0-b8d49ab8b5d9\"><div id=\"gi-9ac8f33f-d358-4931-a0c0-b8d49ab8b5d9\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-9ac8f33f-d358-4931-a0c0-b8d49ab8b5d9\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Create a polar histogram of the wind-direction frequencies:'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'d2079cc2-37c4-401a-bfc7-293974f55762'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-d2079cc2-37c4-401a-bfc7-293974f55762\"><div id=\"frame-d2079cc2-37c4-401a-bfc7-293974f55762\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"d2079cc2-37c4-401a-bfc7-293974f55762\"><div id=\"gi-d2079cc2-37c4-401a-bfc7-293974f55762\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'SectorChart[newdata, SectorOrigin -> {Pi\/2, \"Clockwise\"}, \n PolarAxes -> True, PolarGridLines -> Automatic, \n PlotRange->{2 Pi {-1,1}, 2 Pi {-1,1}},\n ChartBaseStyle -> Directive[Opacity[1], EdgeForm[Thin]]]'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'e8a3ecaa-862a-412e-b647-91c6aac756be'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-e8a3ecaa-862a-412e-b647-91c6aac756be\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide \"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-e8a3ecaa-862a-412e-b647-91c6aac756be\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"e8a3ecaa-862a-412e-b647-91c6aac756be\"><div id=\"gi-e8a3ecaa-862a-412e-b647-91c6aac756be\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-e8a3ecaa-862a-412e-b647-91c6aac756be\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'(*VB[*)(FrontEndRef[\"50e54f29-0e9c-4444-8d80-685158f6c2fa\"])(*,*)(*\"1:eJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKmxqkmpqkGVnqGqRaJuuaAIGuRYqFga6ZhamhqUWaWbJRWiIAd3kVJQ==\"*)(*]VB*)'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'6367366e-64fb-49ae-a2bf-10f4b49a44f9'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-6367366e-64fb-49ae-a2bf-10f4b49a44f9\"><div id=\"frame-6367366e-64fb-49ae-a2bf-10f4b49a44f9\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"6367366e-64fb-49ae-a2bf-10f4b49a44f9\"><div id=\"gi-6367366e-64fb-49ae-a2bf-10f4b49a44f9\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'.md\nWarning: __ticks styling__ in polar plots are not supported for now.'"],["Rule","'Display'","'codemirror'"],["Rule","'Hash'","'3c71dfac-1041-4879-948b-b82dd3909e8c'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association",["Rule","'Hidden'",true]]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Input'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear hover:b0g-teal-700\/5  \" style=\"border-radius:2px\" id=\"group-3c71dfac-1041-4879-948b-b82dd3909e8c\"><div class=\"csubgroup flex flex-row group relative\"><div class=\"grow-0 self-end pr-1 mb-1 group-hover:opacity-100 opacity-0 hidden\"><button class=\"button-chide rotate-90\"><svg class=\"text-gray-500 h-5 w-5 shrink-0\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z\" clip-rule=\"evenodd\"\/><\/svg><\/button><\/div>\n<div id=\"frame-3c71dfac-1041-4879-948b-b82dd3909e8c\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper hidden \" id=\"3c71dfac-1041-4879-948b-b82dd3909e8c\"><div id=\"gi-3c71dfac-1041-4879-948b-b82dd3909e8c\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div>\n<div id=\"children-3c71dfac-1041-4879-948b-b82dd3909e8c\" class=\"cchildren\"><\/div><\/div>\n<div class=\"cborder group-hover:bg-gray-300 absolute\" style=\"height: calc(100%); width: 2px; border-radius:2px; right: -0.5rem;\"><\/div><\/div><\/div>'"]],["Association",["Rule","'Data'",["Association",["Rule","'Data'","'Warning: __ticks styling__ in polar plots are not supported for now.'"],["Rule","'Display'","'markdown'"],["Rule","'Hash'","'7a39d4d2-8e2d-4100-a135-168988cb165a'"],["Rule","'Invisible'",false],["Rule","'MetaOnly'",false],["Rule","'Props'",["Association"]],["Rule","'PublicFields'",["List","'Properties'"]],["Rule","'State'","'Idle'"],["Rule","'Type'","'Output'"],["Rule","'UID'",null],["Rule","'Notebook'","'3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6'"]]],["Rule","'Template'","'<div class=\"cgroup transition duration-100 ease-linear  \" style=\"Missing[KeyAbsent, Style]\" id=\"group-7a39d4d2-8e2d-4100-a135-168988cb165a\"><div id=\"frame-7a39d4d2-8e2d-4100-a135-168988cb165a\" class=\"cframe grow\" style=\"position:relative\"><div class=\"cwrapper  \" id=\"7a39d4d2-8e2d-4100-a135-168988cb165a\"><div id=\"gi-7a39d4d2-8e2d-4100-a135-168988cb165a\" class=\"cgi-ico bg-teal-300 hidden\"><\/div><\/div><\/div><\/div>'"]]]],
	["Rule","'List'",["List","'1051fc34-831e-4396-b4f7-196487ec6fda'","'a9b3659d-cc2f-4583-8ae4-3a661cf94759'","'41b20662-c3d4-4c69-aff2-82efc1f8c504'","'67ea1d26-6a07-46bc-b979-853e75ea358e'","'66c757b1-35d4-4aeb-9709-5ef7692a199f'","'82c7ccec-693b-4c27-a1e5-8235a1c7e19a'","'ed5f3b3c-ddfd-4b1c-83f1-3e5dd1bd2c1d'","'1b7d31ad-16a2-46e4-bb8d-80be3ff581c1'","'72d24873-e8da-4880-a811-dd369bec22e3'","'9a2675ad-a121-45a5-bc9a-46d133416ea2'","'e25c4e27-8130-4241-9493-f4078a791adb'","'89b2dc08-d4cc-4521-a7fb-1d3878ae1371'","'3ee89e37-beee-4822-8b16-3eca5e7b09de'","'583117e8-3b89-4cee-82da-b78cb4f009c5'","'492a1e79-c49c-4f73-a535-5019748b042a'","'e7c2c913-ac4a-41b1-81d6-80cbad979e04'","'2f0d7238-2d6d-4fff-a937-1e07f750e286'","'b3de38af-328a-4441-952f-d6dfb54226c7'","'6e8e9b4d-bb83-4e96-a482-b09d1c5b849f'","'b11045d8-0ca3-48e0-bb8f-fcecf734046b'","'980495c2-9e5c-46dd-b455-9b8a4dd63ee7'","'5bdf3d24-aba8-4c2d-b3b8-994575b08cb2'","'9a23ba80-5ed6-408d-b9da-a278c023d2ed'","'c6de63d4-0ba6-4027-8bc4-00d938246ba2'","'8edf750a-c931-49e5-8dba-5ad6e067a2b7'","'56391a06-b85c-4bf4-9d40-f7e6ffbfa95c'","'e49a7a2e-1d7d-4ae0-a88a-3e341206ccb6'","'f45e1bc6-e690-4385-b772-3f8e2250d286'","'ed26e1be-f40a-40cd-b8cc-bf82b325e7d2'","'2d2b3066-16f2-428f-8fb3-d6b676f5057e'","'769f41ca-3d51-4ca3-a78c-5895a0fd8981'","'810f9296-accb-4c1a-81e0-9a3bc3c74b49'","'090d156c-e052-440a-9c81-fad5c69059a1'","'f19159f0-483e-419f-b877-c8f7cce8ce58'","'f2fb3074-6152-43e0-a0fc-11ffdb8c5ea3'","'19ab1c75-17f5-414b-a103-aa9c59d61863'","'4110a063-3737-4f64-b75e-be0df795126c'","'d46ebab3-c5a2-4bfa-aa5f-e6f5f5086127'","'be66c107-c6d1-4940-abf0-b2d8aceee47d'","'033023b0-48b0-4d24-94be-f27d76c84aa6'","'891fa5ee-e4f9-4f67-af9b-2ca3e7769e71'","'c8293eba-ab07-4c02-8714-173bac5fccbc'","'77e237c8-a809-44b3-a9f3-6247ff5d62c1'","'8e374a2d-6eb6-44b0-b03f-1d2fa9b9aaf8'","'21c8d936-d7ed-4cec-9753-7d44e984d649'","'d65388e7-2ed3-4028-a464-02136c8372a0'","'452415a7-464e-479b-915f-3da454c8b006'","'dde8565b-0aa5-4e9f-9609-ec0baabc6894'","'bcc32a34-e070-4c6c-953f-48efe9d84141'","'72012d04-76c5-4dec-9db2-9cf097994563'","'7e03aaac-5155-4277-b5b5-07930001c655'","'c4d71ec9-bf19-443e-b634-ea070afd2a97'","'300759a5-d8fd-4d86-9043-704d77524ec0'","'49aaecfe-5ee2-4aaf-bc3d-8c89b3b7228d'","'aaf263b7-262a-4cc2-a446-5933d112a702'","'3337aa8d-7202-44aa-8d26-6a06406b3aa2'","'48eaea66-4b0f-4283-a34b-270c091c2b93'","'e8a52e05-947b-49ee-be13-f875e6e15059'","'a67d4a55-272c-4088-b79d-0d28a880dd31'","'63b26f60-c944-45fa-bd4a-3fc0b677eae2'","'675fd694-63aa-4076-a919-f3319a84a0fd'","'64593087-c6ab-45fa-a6e2-1cf13cde18e5'","'026fbedd-2f48-4a60-977f-23d388fce668'","'9ac8f33f-d358-4931-a0c0-b8d49ab8b5d9'","'d2079cc2-37c4-401a-bfc7-293974f55762'","'e8a3ecaa-862a-412e-b647-91c6aac756be'","'6367366e-64fb-49ae-a2bf-10f4b49a44f9'","'3c71dfac-1041-4879-948b-b82dd3909e8c'","'7a39d4d2-8e2d-4100-a135-168988cb165a'"]]
]}</script><meta serializer="separator"/><script id="json-storage" type="application/json">{"storage":[
	"Association"
]}</script><meta serializer="end"/><meta serializer="hsfn-extras"/><script id="json-symbols" type="application/json">{"storage":[
	"Association",
	["Rule","'iconTempSymbol$423252'",["Graphics",["List",["List"],["List",["List"],["List"],["List",["GrayLevel",0.5],["PointSize",0.125],["AbsoluteThickness",1.5],["Style",["Line",["List",["List",1,1.0786974808168008],["List",2,0.8225923764690866],["List",3,1.2351515192384148],["List",4,2.175007457486014],["List",5,2.2418867917949643],["List",6,3.6587064873332547],["List",7,3.8767286999282553],["List",8,1.1063404803108767],["List",9,1.686851184625744],["List",10,0.35274211815401646],["List",11,-0.869775869092456],["List",12,-1.4053663629189868],["List",13,-1.814407889239499],["List",14,-1.2518515630407365],["List",15,-3.2513777731675715],["List",16,-3.00860171079174],["List",17,-3.2314806430702854],["List",18,-2.856961856797875],["List",19,-2.1813146783760504],["List",20,-1.9765745390757676],["List",21,-2.0546964390428704],["List",22,-3.30895245216771],["List",23,-5.284738580678435],["List",24,-4.593410230803565],["List",25,-4.198332300268029],["List",26,-6.20910365507879],["List",27,-6.674631327632843],["List",28,-5.86366296248532],["List",29,-7.030970816185017],["List",30,-5.233012116710768],["List",31,-5.5895472588592945],["List",32,-5.083392364268537],["List",33,-3.411190045372538],["List",34,-4.360288174040149],["List",35,-4.597457053225644],["List",36,-2.920132185669389],["List",37,-2.1352488240136402],["List",38,-1.2332768816166548],["List",39,0.1706610335689045],["List",40,0.3015024111041621],["List",41,1.220269369353312],["List",42,1.1625019235683953],["List",43,0.32964429476287194],["List",44,-0.38976818959929727],["List",45,-0.8919552619045075],["List",46,-0.39414642731353916],["List",47,0.32472184895644735],["List",48,2.0443460301601935],["List",49,3.077101328976367],["List",50,4.273359296964368]]],["Rule","FontFamily","'Arial'"]]]],["List"]],["Rule","AspectRatio",1],["Rule","Axes",["List",false,false]],["Rule","AxesLabel",["List","None","None"]],["Rule","AxesOrigin",["List",0,0]],["Rule","Background",["GrayLevel",0.93]],["Rule","BaseStyle",["List",["Rule","FontFamily","'Arial'"]]],["Rule","DisplayFunction","Identity"],["Rule","Frame",["List",["List",true,true],["List",true,true]]],["Rule","FrameLabel",["List",["List","None","None"],["List","None","None"]]],["Rule","FrameStyle",["Directive",["Thickness","Tiny"],["GrayLevel",0.7]]],["Rule","FrameTicks",["List",["List","None","None"],["List","None","None"]]],["Rule","GridLines",["List","None","None"]],["Rule","GridLinesStyle",["Directive",["GrayLevel",0.5,0.4]]],["Rule","ImageSize",["Dynamic",["List","Automatic",["Times",3.5,["Times",["CurrentValue","'FontCapHeight'"],["Power",["AbsoluteCurrentValue","Magnification"],-1]]]]]],["Rule","LabelStyle",["List",["Rule","FontFamily","'Arial'"]]],["Rule","Method",["List",["Rule","'ScalingFunctions'","None"]]],["Rule","PlotRange",["List",["List",0,50],["List",-7.030970816185017,4.273359296964368]]],["Rule","PlotRangeClipping",true],["Rule","PlotRangePadding",["List",["List",1,1],["List",1,1]]],["Rule","Ticks",["List","Automatic","Automatic"]]]]
]}</script><meta serializer="end-extras"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title > Bubble chart</title><style >
.margin-bottom-fix {
  margin-bottom: 0.15em;
}


  
.cm-line {
  font-family: 'SF Mono Regular', monospace !important;
  font-size: 0.875rem;
}

.cell-type-widget {
  display: inline-block;
  position: relative;
  border-radius: 4px;
  padding-left: 6px;
  padding-right: 6px;
  font-size: 0.75rem;
  /* line-height: 120%; */
  height:1.1rem;
  background-color: rgb(236, 236, 236);
  color: rgba(55, 53, 47, 0.5);
  opacity: 0.7;
}

:root {
    font-size: 0.9em;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;

    --editor-key-meta: #404740;
    --editor-key-keyword: #708;
    --editor-key-atom: #219;
    --editor-key-literal: #164;
    --editor-key-string: #a11;
    --editor-key-escape: #e40;
    --editor-key-variable: #00f;
    --editor-local-variable: #30a;
    --editor-key-type: #085;
    --editor-key-class: #167;
    --editor-special-variable: #256;
    --editor-key-property: #00c;
    --editor-key-comment: #940;
    --editor-key-invalid: #f00;
    
    --editor-outline: #696969;
  
    --editor-bracket-1: #5461c8;
    --editor-bracket-2: #c724b1;
    --editor-bracket-3: #e4002b;
    --editor-bracket-4: #ff6900;
    --editor-bracket-5: #978d00;
    --editor-bracket-6: #019e79;
    --editor-bracket-7: #008dc1;
  
    --editor-bracket-1-a: #5461c8; 
    --editor-bracket-2-a: #c724b1;
    --editor-bracket-3-a: #e4002b;
    --editor-bracket-4-a: #ff6900;
    --editor-bracket-5-a: #978d00;
    --editor-bracket-6-a: #019e79;
    --editor-bracket-7-a: #008dc1;
  }
  
.bg-d9 {
  background: #d9d9d9;
}

.bg-239 {
  background: rgb(239,239,239)
}

input::selection {
  color: #2fa1d6;
}

.sm-controls {
    font-family: system-ui;
    caret-color: auto;
}

.cgi-ico {
  position: absolute;
  width: 0.5rem;
  height: 0.5rem;
  border-radius: 999px;
  margin-right: 0.25rem;
  margin-top: 0.25rem;
  right: 0;
}

.text-gray-454 {
  --tw-text-opacity: 1;
  color: rgb(154 154 154 / var(--tw-text-opacity));
}

.bg-gray-454-half {
  --tw-text-opacity: 1;
  background: rgb(154 154 154 / 50%);
}

@media (min-width: 1024px) {
  .lg\:pl-70 {
    padding-left:16rem;
  }
}

@media (min-width: 768px) {
 .md\:pl-70 {
    padding-left: 16rem;
 }
}

@media (min-width: 768px) {
  .md\:w-70 {
    width:16rem;
  }
}

@media (min-width: 1024px) {
  .lg\:w-70 {
    width:16rem;
  }
}

.sc-b {
  scrollbar-width: 2px;
  scrollbar-color: rgba(15, 15, 15, 0.2) transparent;
}

.sc-b::-webkit-scrollbar {
  width: 2px;
  height: 2px;
}

.sc-b::-webkit-scrollbar-thumb {
  background: rgba(15, 15, 15, 0.2);
  border-radius: 5px;
}

.sc-b::-webkit-scrollbar-track {
  background-color: transparent;
}

.sc-b::-webkit-scrollbar-button {
  background-color: transparent;
  border-radius: 5px;
}

.z-inf {
  z-index:110;
}

@media (prefers-color-scheme: dark) {
.dark\:bg-black {
  --tw-bg-opacity: 1;
  background-color: #222 !important;
}
}

.ttint {
  transition: height 0.2s;
  background: #0056880f;
}

.h-fade-20 {
  mask-image: -webkit-gradient(linear, left top, left bottom, from(rgba(0,0,0,1)), to(rgba(0,0,0,0)));
  max-height: 4rem;
  overflow: hidden;
}


.hover\:bg-gray-100:hover {
  --tw-bg-opacity: 1;
  background-color: rgb(243 244 246 / var(--tw-bg-opacity)) /* #f3f4f6 */;
}

main {
  width: calc(100% - 16rem) !important;
  display: inline-block !important; 
}

@media (max-width: 1250px) {
  main {
    width: 100% !important;
    display: inline-block !important;    
  }
}</style>
<style >/*
! tailwindcss v3.4.3 | MIT License | https://tailwindcss.com
*/

/*
1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4)
2. Allow adding a border to an element by just adding a border-width. (https://github.com/tailwindcss/tailwindcss/pull/116)
*/

*,
::before,
::after {
  box-sizing: border-box;
  /* 1 */
  border-width: 0;
  /* 2 */
  border-style: solid;
  /* 2 */
  border-color: #e5e7eb;
  /* 2 */
}

::before,
::after {
  --tw-content: '';
}

/*
1. Use a consistent sensible line-height in all browsers.
2. Prevent adjustments of font size after orientation changes in iOS.
3. Use a more readable tab size.
4. Use the user's configured `sans` font-family by default.
5. Use the user's configured `sans` font-feature-settings by default.
6. Use the user's configured `sans` font-variation-settings by default.
7. Disable tap highlights on iOS
*/

html,
:host {
  line-height: 1.5;
  /* 1 */
  -webkit-text-size-adjust: 100%;
  /* 2 */
  -moz-tab-size: 4;
  /* 3 */
  -o-tab-size: 4;
     tab-size: 4;
  /* 3 */
  font-family: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  /* 4 */
  font-feature-settings: normal;
  /* 5 */
  font-variation-settings: normal;
  /* 6 */
  -webkit-tap-highlight-color: transparent;
  /* 7 */
}

/*
1. Remove the margin in all browsers.
2. Inherit line-height from `html` so users can set them as a class directly on the `html` element.
*/

body {
  margin: 0;
  /* 1 */
  line-height: inherit;
  /* 2 */
}

/*
1. Add the correct height in Firefox.
2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)
3. Ensure horizontal rules are visible by default.
*/

hr {
  height: 0;
  /* 1 */
  color: inherit;
  /* 2 */
  border-top-width: 1px;
  /* 3 */
}

/*
Add the correct text decoration in Chrome, Edge, and Safari.
*/

abbr:where([title]) {
  -webkit-text-decoration: underline dotted;
          text-decoration: underline dotted;
}

/*
Remove the default font size and weight for headings.
*/

h1,
h2,
h3,
h4,
h5,
h6 {
  font-size: inherit;
  font-weight: inherit;
}

/*
Reset links to optimize for opt-in styling instead of opt-out.
*/

a {
  color: inherit;
  text-decoration: inherit;
}

/*
Add the correct font weight in Edge and Safari.
*/

b,
strong {
  font-weight: bolder;
}

/*
1. Use the user's configured `mono` font-family by default.
2. Use the user's configured `mono` font-feature-settings by default.
3. Use the user's configured `mono` font-variation-settings by default.
4. Correct the odd `em` font sizing in all browsers.
*/

code,
kbd,
samp,
pre {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  /* 1 */
  font-feature-settings: normal;
  /* 2 */
  font-variation-settings: normal;
  /* 3 */
  font-size: 1em;
  /* 4 */
}

/*
Add the correct font size in all browsers.
*/

small {
  font-size: 80%;
}

/*
Prevent `sub` and `sup` elements from affecting the line height in all browsers.
*/

sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

sub {
  bottom: -0.25em;
}

sup {
  top: -0.5em;
}

/*
1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)
2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)
3. Remove gaps between table borders by default.
*/

table {
  text-indent: 0;
  /* 1 */
  border-color: inherit;
  /* 2 */
  border-collapse: collapse;
  /* 3 */
}

/*
1. Change the font styles in all browsers.
2. Remove the margin in Firefox and Safari.
3. Remove default padding in all browsers.
*/

button,
input,
optgroup,
select,
textarea {
  font-family: inherit;
  /* 1 */
  font-feature-settings: inherit;
  /* 1 */
  font-variation-settings: inherit;
  /* 1 */
  font-size: 100%;
  /* 1 */
  font-weight: inherit;
  /* 1 */
  line-height: inherit;
  /* 1 */
  letter-spacing: inherit;
  /* 1 */
  color: inherit;
  /* 1 */
  margin: 0;
  /* 2 */
  padding: 0;
  /* 3 */
}

/*
Remove the inheritance of text transform in Edge and Firefox.
*/

button,
select {
  text-transform: none;
}

/*
1. Correct the inability to style clickable types in iOS and Safari.
2. Remove default button styles.
*/

button,
input:where([type='button']),
input:where([type='reset']),
input:where([type='submit']) {
  -webkit-appearance: button;
  /* 1 */
  background-color: transparent;
  /* 2 */
  background-image: none;
  /* 2 */
}

/*
Use the modern Firefox focus style for all focusable elements.
*/

:-moz-focusring {
  outline: auto;
}

/*
Remove the additional `:invalid` styles in Firefox. (https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737)
*/

:-moz-ui-invalid {
  box-shadow: none;
}

/*
Add the correct vertical alignment in Chrome and Firefox.
*/

progress {
  vertical-align: baseline;
}

/*
Correct the cursor style of increment and decrement buttons in Safari.
*/

::-webkit-inner-spin-button,
::-webkit-outer-spin-button {
  height: auto;
}

/*
1. Correct the odd appearance in Chrome and Safari.
2. Correct the outline style in Safari.
*/

[type='search'] {
  -webkit-appearance: textfield;
  /* 1 */
  outline-offset: -2px;
  /* 2 */
}

/*
Remove the inner padding in Chrome and Safari on macOS.
*/

::-webkit-search-decoration {
  -webkit-appearance: none;
}

/*
1. Correct the inability to style clickable types in iOS and Safari.
2. Change font properties to `inherit` in Safari.
*/

::-webkit-file-upload-button {
  -webkit-appearance: button;
  /* 1 */
  font: inherit;
  /* 2 */
}

/*
Add the correct display in Chrome and Safari.
*/

summary {
  display: list-item;
}

/*
Removes the default spacing and border for appropriate elements.
*/

blockquote,
dl,
dd,
h1,
h2,
h3,
h4,
h5,
h6,
hr,
figure,
p,
pre {
  margin: 0;
}

fieldset {
  margin: 0;
  padding: 0;
}

legend {
  padding: 0;
}

ol,
ul,
menu {
  list-style: none;
  margin: 0;
  padding: 0;
}

/*
Reset default styling for dialogs.
*/

dialog {
  padding: 0;
}

/*
Prevent resizing textareas horizontally by default.
*/

textarea {
  resize: vertical;
}

/*
1. Reset the default placeholder opacity in Firefox. (https://github.com/tailwindlabs/tailwindcss/issues/3300)
2. Set the default placeholder color to the user's configured gray 400 color.
*/

input::-moz-placeholder, textarea::-moz-placeholder {
  opacity: 1;
  /* 1 */
  color: #9ca3af;
  /* 2 */
}

input::placeholder,
textarea::placeholder {
  opacity: 1;
  /* 1 */
  color: #9ca3af;
  /* 2 */
}

/*
Set the default cursor for buttons.
*/

button,
[role="button"] {
  cursor: pointer;
}

/*
Make sure disabled buttons don't get the pointer cursor.
*/

:disabled {
  cursor: default;
}

/*
1. Make replaced elements `display: block` by default. (https://github.com/mozdevs/cssremedy/issues/14)
2. Add `vertical-align: middle` to align replaced elements more sensibly by default. (https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210)
   This can trigger a poorly considered lint error in some tools but is included by design.
*/

img,
svg,
video,
canvas,
audio,
iframe,
embed,
object {
  display: block;
  /* 1 */
  vertical-align: middle;
  /* 2 */
}

/*
Constrain images and videos to the parent width and preserve their intrinsic aspect ratio. (https://github.com/mozdevs/cssremedy/issues/14)
*/

img,
video {
  max-width: 100%;
  height: auto;
}

/* Make elements with the HTML hidden attribute stay hidden by default */

[hidden] {
  display: none;
}

[type='text'],input:where(:not([type])),[type='email'],[type='url'],[type='password'],[type='number'],[type='date'],[type='datetime-local'],[type='month'],[type='search'],[type='tel'],[type='time'],[type='week'],[multiple],textarea,select {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none;
  background-color: #fff;
  border-color: #6b7280;
  border-width: 1px;
  border-radius: 0px;
  padding-top: 0.5rem;
  padding-right: 0.75rem;
  padding-bottom: 0.5rem;
  padding-left: 0.75rem;
  font-size: 1rem;
  line-height: 1.5rem;
  --tw-shadow: 0 0 #0000;
}

[type='text']:focus, input:where(:not([type])):focus, [type='email']:focus, [type='url']:focus, [type='password']:focus, [type='number']:focus, [type='date']:focus, [type='datetime-local']:focus, [type='month']:focus, [type='search']:focus, [type='tel']:focus, [type='time']:focus, [type='week']:focus, [multiple]:focus, textarea:focus, select:focus {
  outline: 2px solid transparent;
  outline-offset: 2px;
  --tw-ring-inset: var(--tw-empty,/*!*/ /*!*/);
  --tw-ring-offset-width: 0px;
  --tw-ring-offset-color: #fff;
  --tw-ring-color: #2563eb;
  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);
  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
  border-color: #2563eb;
}

input::-moz-placeholder, textarea::-moz-placeholder {
  color: #6b7280;
  opacity: 1;
}

input::placeholder,textarea::placeholder {
  color: #6b7280;
  opacity: 1;
}

::-webkit-datetime-edit-fields-wrapper {
  padding: 0;
}

::-webkit-date-and-time-value {
  min-height: 1.5em;
  text-align: inherit;
}

::-webkit-datetime-edit {
  display: inline-flex;
}

::-webkit-datetime-edit,::-webkit-datetime-edit-year-field,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-second-field,::-webkit-datetime-edit-millisecond-field,::-webkit-datetime-edit-meridiem-field {
  padding-top: 0;
  padding-bottom: 0;
}

select {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 0.5rem center;
  background-repeat: no-repeat;
  background-size: 1.5em 1.5em;
  padding-right: 2.5rem;
  -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
}

[multiple],[size]:where(select:not([size="1"])) {
  background-image: initial;
  background-position: initial;
  background-repeat: unset;
  background-size: initial;
  padding-right: 0.75rem;
  -webkit-print-color-adjust: unset;
          print-color-adjust: unset;
}

[type='checkbox'],[type='radio'] {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none;
  padding: 0;
  -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
  display: inline-block;
  vertical-align: middle;
  background-origin: border-box;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  flex-shrink: 0;
  height: 1rem;
  width: 1rem;
  color: #2563eb;
  background-color: #fff;
  border-color: #6b7280;
  border-width: 1px;
  --tw-shadow: 0 0 #0000;
}

[type='checkbox'] {
  border-radius: 0px;
}

[type='radio'] {
  border-radius: 100%;
}

[type='checkbox']:focus,[type='radio']:focus {
  outline: 2px solid transparent;
  outline-offset: 2px;
  --tw-ring-inset: var(--tw-empty,/*!*/ /*!*/);
  --tw-ring-offset-width: 2px;
  --tw-ring-offset-color: #fff;
  --tw-ring-color: #2563eb;
  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
}

[type='checkbox']:checked,[type='radio']:checked {
  border-color: transparent;
  background-color: currentColor;
  background-size: 100% 100%;
  background-position: center;
  background-repeat: no-repeat;
}

[type='checkbox']:checked {
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
}

@media (forced-colors: active)  {
  [type='checkbox']:checked {
    -webkit-appearance: auto;
       -moz-appearance: auto;
            appearance: auto;
  }
}

[type='radio']:checked {
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='8' cy='8' r='3'/%3e%3c/svg%3e");
}

@media (forced-colors: active)  {
  [type='radio']:checked {
    -webkit-appearance: auto;
       -moz-appearance: auto;
            appearance: auto;
  }
}

[type='checkbox']:checked:hover,[type='checkbox']:checked:focus,[type='radio']:checked:hover,[type='radio']:checked:focus {
  border-color: transparent;
  background-color: currentColor;
}

[type='checkbox']:indeterminate {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 16 16'%3e%3cpath stroke='white' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 8h8'/%3e%3c/svg%3e");
  border-color: transparent;
  background-color: currentColor;
  background-size: 100% 100%;
  background-position: center;
  background-repeat: no-repeat;
}

@media (forced-colors: active)  {
  [type='checkbox']:indeterminate {
    -webkit-appearance: auto;
       -moz-appearance: auto;
            appearance: auto;
  }
}

[type='checkbox']:indeterminate:hover,[type='checkbox']:indeterminate:focus {
  border-color: transparent;
  background-color: currentColor;
}

[type='file'] {
  background: unset;
  border-color: inherit;
  border-width: 0;
  border-radius: 0;
  padding: 0;
  font-size: unset;
  line-height: inherit;
}

[type='file']:focus {
  outline: 1px solid ButtonText;
  outline: 1px auto -webkit-focus-ring-color;
}

*, ::before, ::after {
  --tw-border-spacing-x: 0;
  --tw-border-spacing-y: 0;
  --tw-translate-x: 0;
  --tw-translate-y: 0;
  --tw-rotate: 0;
  --tw-skew-x: 0;
  --tw-skew-y: 0;
  --tw-scale-x: 1;
  --tw-scale-y: 1;
  --tw-pan-x:  ;
  --tw-pan-y:  ;
  --tw-pinch-zoom:  ;
  --tw-scroll-snap-strictness: proximity;
  --tw-gradient-from-position:  ;
  --tw-gradient-via-position:  ;
  --tw-gradient-to-position:  ;
  --tw-ordinal:  ;
  --tw-slashed-zero:  ;
  --tw-numeric-figure:  ;
  --tw-numeric-spacing:  ;
  --tw-numeric-fraction:  ;
  --tw-ring-inset:  ;
  --tw-ring-offset-width: 0px;
  --tw-ring-offset-color: #fff;
  --tw-ring-color: rgb(59 130 246 / 0.5);
  --tw-ring-offset-shadow: 0 0 #0000;
  --tw-ring-shadow: 0 0 #0000;
  --tw-shadow: 0 0 #0000;
  --tw-shadow-colored: 0 0 #0000;
  --tw-blur:  ;
  --tw-brightness:  ;
  --tw-contrast:  ;
  --tw-grayscale:  ;
  --tw-hue-rotate:  ;
  --tw-invert:  ;
  --tw-saturate:  ;
  --tw-sepia:  ;
  --tw-drop-shadow:  ;
  --tw-backdrop-blur:  ;
  --tw-backdrop-brightness:  ;
  --tw-backdrop-contrast:  ;
  --tw-backdrop-grayscale:  ;
  --tw-backdrop-hue-rotate:  ;
  --tw-backdrop-invert:  ;
  --tw-backdrop-opacity:  ;
  --tw-backdrop-saturate:  ;
  --tw-backdrop-sepia:  ;
  --tw-contain-size:  ;
  --tw-contain-layout:  ;
  --tw-contain-paint:  ;
  --tw-contain-style:  ;
}

::backdrop {
  --tw-border-spacing-x: 0;
  --tw-border-spacing-y: 0;
  --tw-translate-x: 0;
  --tw-translate-y: 0;
  --tw-rotate: 0;
  --tw-skew-x: 0;
  --tw-skew-y: 0;
  --tw-scale-x: 1;
  --tw-scale-y: 1;
  --tw-pan-x:  ;
  --tw-pan-y:  ;
  --tw-pinch-zoom:  ;
  --tw-scroll-snap-strictness: proximity;
  --tw-gradient-from-position:  ;
  --tw-gradient-via-position:  ;
  --tw-gradient-to-position:  ;
  --tw-ordinal:  ;
  --tw-slashed-zero:  ;
  --tw-numeric-figure:  ;
  --tw-numeric-spacing:  ;
  --tw-numeric-fraction:  ;
  --tw-ring-inset:  ;
  --tw-ring-offset-width: 0px;
  --tw-ring-offset-color: #fff;
  --tw-ring-color: rgb(59 130 246 / 0.5);
  --tw-ring-offset-shadow: 0 0 #0000;
  --tw-ring-shadow: 0 0 #0000;
  --tw-shadow: 0 0 #0000;
  --tw-shadow-colored: 0 0 #0000;
  --tw-blur:  ;
  --tw-brightness:  ;
  --tw-contrast:  ;
  --tw-grayscale:  ;
  --tw-hue-rotate:  ;
  --tw-invert:  ;
  --tw-saturate:  ;
  --tw-sepia:  ;
  --tw-drop-shadow:  ;
  --tw-backdrop-blur:  ;
  --tw-backdrop-brightness:  ;
  --tw-backdrop-contrast:  ;
  --tw-backdrop-grayscale:  ;
  --tw-backdrop-hue-rotate:  ;
  --tw-backdrop-invert:  ;
  --tw-backdrop-opacity:  ;
  --tw-backdrop-saturate:  ;
  --tw-backdrop-sepia:  ;
  --tw-contain-size:  ;
  --tw-contain-layout:  ;
  --tw-contain-paint:  ;
  --tw-contain-style:  ;
}

.container {
  width: 100%;
}

@media (min-width: 640px) {
  .container {
    max-width: 640px;
  }
}

@media (min-width: 768px) {
  .container {
    max-width: 768px;
  }
}

@media (min-width: 1024px) {
  .container {
    max-width: 1024px;
  }
}

@media (min-width: 1280px) {
  .container {
    max-width: 1280px;
  }
}

@media (min-width: 1536px) {
  .container {
    max-width: 1536px;
  }
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.pointer-events-none {
  pointer-events: none;
}

.pointer-events-auto {
  pointer-events: auto;
}

.visible {
  visibility: visible;
}

.fixed {
  position: fixed;
}

.absolute {
  position: absolute;
}

.relative {
  position: relative;
}

.sticky {
  position: sticky;
}

.inset-0 {
  inset: 0px;
}

.-top-6 {
  top: -1.5rem;
}

.bottom-0 {
  bottom: 0px;
}

.left-0 {
  left: 0px;
}

.right-0 {
  right: 0px;
}

.top-0 {
  top: 0px;
}

.top-6 {
  top: 1.5rem;
}

.z-0 {
  z-index: 0;
}

.z-10 {
  z-index: 10;
}

.z-40 {
  z-index: 40;
}

.z-50 {
  z-index: 50;
}

.-m-1 {
  margin: -0.25rem;
}

.-m-1\.5 {
  margin: -0.375rem;
}

.m-4 {
  margin: 1rem;
}

.-mx-2 {
  margin-left: -0.5rem;
  margin-right: -0.5rem;
}

.mx-1 {
  margin-left: 0.25rem;
  margin-right: 0.25rem;
}

.mx-4 {
  margin-left: 1rem;
  margin-right: 1rem;
}

.mx-auto {
  margin-left: auto;
  margin-right: auto;
}

.my-1 {
  margin-top: 0.25rem;
  margin-bottom: 0.25rem;
}

.my-2 {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
}

.my-auto {
  margin-top: auto;
  margin-bottom: auto;
}

.-ml-0 {
  margin-left: -0px;
}

.-ml-0\.5 {
  margin-left: -0.125rem;
}

.-mt-1 {
  margin-top: -0.25rem;
}

.mb-1 {
  margin-bottom: 0.25rem;
}

.mb-2 {
  margin-bottom: 0.5rem;
}

.mb-4 {
  margin-bottom: 1rem;
}

.mb-6 {
  margin-bottom: 1.5rem;
}

.mb-auto {
  margin-bottom: auto;
}

.ml-0 {
  margin-left: 0px;
}

.ml-0\.5 {
  margin-left: 0.125rem;
}

.ml-1 {
  margin-left: 0.25rem;
}

.ml-3 {
  margin-left: 0.75rem;
}

.ml-4 {
  margin-left: 1rem;
}

.ml-auto {
  margin-left: auto;
}

.mr-0 {
  margin-right: 0px;
}

.mr-0\.5 {
  margin-right: 0.125rem;
}

.mr-1 {
  margin-right: 0.25rem;
}

.mr-1\.5 {
  margin-right: 0.375rem;
}

.mr-2 {
  margin-right: 0.5rem;
}

.mr-3 {
  margin-right: 0.75rem;
}

.mr-8 {
  margin-right: 2rem;
}

.mr-auto {
  margin-right: auto;
}

.mt-0 {
  margin-top: 0px;
}

.mt-1 {
  margin-top: 0.25rem;
}

.mt-10 {
  margin-top: 2.5rem;
}

.mt-12 {
  margin-top: 3rem;
}

.mt-2 {
  margin-top: 0.5rem;
}

.mt-3 {
  margin-top: 0.75rem;
}

.mt-4 {
  margin-top: 1rem;
}

.mt-5 {
  margin-top: 1.25rem;
}

.mt-6 {
  margin-top: 1.5rem;
}

.mt-auto {
  margin-top: auto;
}

.block {
  display: block;
}

.inline-block {
  display: inline-block;
}

.inline {
  display: inline;
}

.flex {
  display: flex;
}

.inline-flex {
  display: inline-flex;
}

.table {
  display: table;
}

.hidden {
  display: none;
}

.h-1 {
  height: 0.25rem;
}

.h-1\.5 {
  height: 0.375rem;
}

.h-10 {
  height: 2.5rem;
}

.h-12 {
  height: 3rem;
}

.h-16 {
  height: 4rem;
}

.h-2 {
  height: 0.5rem;
}

.h-3 {
  height: 0.75rem;
}

.h-4 {
  height: 1rem;
}

.h-5 {
  height: 1.25rem;
}

.h-6 {
  height: 1.5rem;
}

.h-7 {
  height: 1.75rem;
}

.h-8 {
  height: 2rem;
}

.h-auto {
  height: auto;
}

.h-full {
  height: 100%;
}

.h-px {
  height: 1px;
}

.max-h-10 {
  max-height: 2.5rem;
}

.max-h-60 {
  max-height: 15rem;
}

.max-h-80 {
  max-height: 20rem;
}

.max-h-96 {
  max-height: 24rem;
}

.min-h-full {
  min-height: 100%;
}

.w-0 {
  width: 0px;
}

.w-1 {
  width: 0.25rem;
}

.w-1\.5 {
  width: 0.375rem;
}

.w-12 {
  width: 3rem;
}

.w-2 {
  width: 0.5rem;
}

.w-2\/4 {
  width: 50%;
}

.w-3 {
  width: 0.75rem;
}

.w-3\/6 {
  width: 50%;
}

.w-4 {
  width: 1rem;
}

.w-5 {
  width: 1.25rem;
}

.w-56 {
  width: 14rem;
}

.w-6 {
  width: 1.5rem;
}

.w-7 {
  width: 1.75rem;
}

.w-8 {
  width: 2rem;
}

.w-96 {
  width: 24rem;
}

.w-full {
  width: 100%;
}

.w-px {
  width: 1px;
}

.w-screen {
  width: 100vw;
}

.min-w-0 {
  min-width: 0px;
}

.max-w-2xl {
  max-width: 42rem;
}

.max-w-60 {
  max-width: 15rem;
}

.max-w-7xl {
  max-width: 80rem;
}

.max-w-full {
  max-width: 100%;
}

.max-w-lg {
  max-width: 32rem;
}

.max-w-xs {
  max-width: 20rem;
}

.flex-1 {
  flex: 1 1 0%;
}

.flex-auto {
  flex: 1 1 auto;
}

.flex-none {
  flex: none;
}

.flex-shrink-0 {
  flex-shrink: 0;
}

.shrink {
  flex-shrink: 1;
}

.shrink-0 {
  flex-shrink: 0;
}

.flex-grow {
  flex-grow: 1;
}

.grow {
  flex-grow: 1;
}

.grow-0 {
  flex-grow: 0;
}

.origin-top-right {
  transform-origin: top right;
}

.translate-x-0 {
  --tw-translate-x: 0px;
  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}

.translate-x-5 {
  --tw-translate-x: 1.25rem;
  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}

.translate-y-0 {
  --tw-translate-y: 0px;
  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}

.translate-y-2 {
  --tw-translate-y: 0.5rem;
  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}

.rotate-45 {
  --tw-rotate: 45deg;
  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}

.rotate-90 {
  --tw-rotate: 90deg;
  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}

.transform {
  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

.cursor-default {
  cursor: default;
}

.cursor-pointer {
  cursor: pointer;
}

.cursor-vertical-text {
  cursor: vertical-text;
}

.select-none {
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
}

.resize-none {
  resize: none;
}

.scroll-py-2 {
  scroll-padding-top: 0.5rem;
  scroll-padding-bottom: 0.5rem;
}

.list-disc {
  list-style-type: disc;
}

.appearance-none {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none;
}

.columns-1 {
  -moz-columns: 1;
       columns: 1;
}

.columns-10 {
  -moz-columns: 10;
       columns: 10;
}

.columns-11 {
  -moz-columns: 11;
       columns: 11;
}

.columns-12 {
  -moz-columns: 12;
       columns: 12;
}

.columns-2 {
  -moz-columns: 2;
       columns: 2;
}

.columns-2xl {
  -moz-columns: 42rem;
       columns: 42rem;
}

.columns-2xs {
  -moz-columns: 18rem;
       columns: 18rem;
}

.columns-3 {
  -moz-columns: 3;
       columns: 3;
}

.columns-3xl {
  -moz-columns: 48rem;
       columns: 48rem;
}

.columns-3xs {
  -moz-columns: 16rem;
       columns: 16rem;
}

.columns-4 {
  -moz-columns: 4;
       columns: 4;
}

.columns-4xl {
  -moz-columns: 56rem;
       columns: 56rem;
}

.columns-5 {
  -moz-columns: 5;
       columns: 5;
}

.columns-5xl {
  -moz-columns: 64rem;
       columns: 64rem;
}

.columns-6 {
  -moz-columns: 6;
       columns: 6;
}

.columns-6xl {
  -moz-columns: 72rem;
       columns: 72rem;
}

.columns-7 {
  -moz-columns: 7;
       columns: 7;
}

.columns-7xl {
  -moz-columns: 80rem;
       columns: 80rem;
}

.columns-8 {
  -moz-columns: 8;
       columns: 8;
}

.columns-9 {
  -moz-columns: 9;
       columns: 9;
}

.columns-auto {
  -moz-columns: auto;
       columns: auto;
}

.columns-lg {
  -moz-columns: 32rem;
       columns: 32rem;
}

.columns-md {
  -moz-columns: 28rem;
       columns: 28rem;
}

.columns-sm {
  -moz-columns: 24rem;
       columns: 24rem;
}

.columns-xl {
  -moz-columns: 36rem;
       columns: 36rem;
}

.columns-xs {
  -moz-columns: 20rem;
       columns: 20rem;
}

.flex-row {
  flex-direction: row;
}

.flex-row-reverse {
  flex-direction: row-reverse;
}

.flex-col {
  flex-direction: column;
}

.flex-wrap-reverse {
  flex-wrap: wrap-reverse;
}

.items-start {
  align-items: flex-start;
}

.items-end {
  align-items: flex-end;
}

.items-center {
  align-items: center;
}

.justify-center {
  justify-content: center;
}

.justify-between {
  justify-content: space-between;
}

.gap-x-1 {
  -moz-column-gap: 0.25rem;
       column-gap: 0.25rem;
}

.gap-x-10 {
  -moz-column-gap: 2.5rem;
       column-gap: 2.5rem;
}

.gap-x-2 {
  -moz-column-gap: 0.5rem;
       column-gap: 0.5rem;
}

.gap-x-3 {
  -moz-column-gap: 0.75rem;
       column-gap: 0.75rem;
}

.gap-x-4 {
  -moz-column-gap: 1rem;
       column-gap: 1rem;
}

.gap-x-5 {
  -moz-column-gap: 1.25rem;
       column-gap: 1.25rem;
}

.gap-x-6 {
  -moz-column-gap: 1.5rem;
       column-gap: 1.5rem;
}

.gap-y-1 {
  row-gap: 0.25rem;
}

.gap-y-2 {
  row-gap: 0.5rem;
}

.gap-y-3 {
  row-gap: 0.75rem;
}

.gap-y-5 {
  row-gap: 1.25rem;
}

.gap-y-7 {
  row-gap: 1.75rem;
}

.space-x-1 > :not([hidden]) ~ :not([hidden]) {
  --tw-space-x-reverse: 0;
  margin-right: calc(0.25rem * var(--tw-space-x-reverse));
  margin-left: calc(0.25rem * calc(1 - var(--tw-space-x-reverse)));
}

.space-y-0 > :not([hidden]) ~ :not([hidden]) {
  --tw-space-y-reverse: 0;
  margin-top: calc(0px * calc(1 - var(--tw-space-y-reverse)));
  margin-bottom: calc(0px * var(--tw-space-y-reverse));
}

.space-y-1 > :not([hidden]) ~ :not([hidden]) {
  --tw-space-y-reverse: 0;
  margin-top: calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));
  margin-bottom: calc(0.25rem * var(--tw-space-y-reverse));
}

.space-y-6 > :not([hidden]) ~ :not([hidden]) {
  --tw-space-y-reverse: 0;
  margin-top: calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));
  margin-bottom: calc(1.5rem * var(--tw-space-y-reverse));
}

.divide-x > :not([hidden]) ~ :not([hidden]) {
  --tw-divide-x-reverse: 0;
  border-right-width: calc(1px * var(--tw-divide-x-reverse));
  border-left-width: calc(1px * calc(1 - var(--tw-divide-x-reverse)));
}

.divide-y > :not([hidden]) ~ :not([hidden]) {
  --tw-divide-y-reverse: 0;
  border-top-width: calc(1px * calc(1 - var(--tw-divide-y-reverse)));
  border-bottom-width: calc(1px * var(--tw-divide-y-reverse));
}

.divide-gray-100 > :not([hidden]) ~ :not([hidden]) {
  --tw-divide-opacity: 1;
  border-color: rgb(243 244 246 / var(--tw-divide-opacity));
}

.divide-gray-200 > :not([hidden]) ~ :not([hidden]) {
  --tw-divide-opacity: 1;
  border-color: rgb(229 231 235 / var(--tw-divide-opacity));
}

.divide-gray-400 > :not([hidden]) ~ :not([hidden]) {
  --tw-divide-opacity: 1;
  border-color: rgb(156 163 175 / var(--tw-divide-opacity));
}

.divide-gray-500 > :not([hidden]) ~ :not([hidden]) {
  --tw-divide-opacity: 1;
  border-color: rgb(107 114 128 / var(--tw-divide-opacity));
}

.divide-opacity-10 > :not([hidden]) ~ :not([hidden]) {
  --tw-divide-opacity: 0.1;
}

.self-start {
  align-self: flex-start;
}

.self-end {
  align-self: flex-end;
}

.overflow-hidden {
  overflow: hidden;
}

.overflow-x-auto {
  overflow-x: auto;
}

.overflow-y-auto {
  overflow-y: auto;
}

.overflow-y-scroll {
  overflow-y: scroll;
}

.scroll-smooth {
  scroll-behavior: smooth;
}

.truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.whitespace-nowrap {
  white-space: nowrap;
}

.rounded {
  border-radius: 0.25rem;
}

.rounded-full {
  border-radius: 9999px;
}

.rounded-lg {
  border-radius: 0.5rem;
}

.rounded-md {
  border-radius: 0.375rem;
}

.rounded-sm {
  border-radius: 0.125rem;
}

.rounded-xl {
  border-radius: 0.75rem;
}

.rounded-b-lg {
  border-bottom-right-radius: 0.5rem;
  border-bottom-left-radius: 0.5rem;
}

.border {
  border-width: 1px;
}

.border-0 {
  border-width: 0px;
}

.border-2 {
  border-width: 2px;
}

.border-b {
  border-bottom-width: 1px;
}

.border-l {
  border-left-width: 1px;
}

.border-r {
  border-right-width: 1px;
}

.border-t {
  border-top-width: 1px;
}

.border-solid {
  border-style: solid;
}

.border-gray-100 {
  --tw-border-opacity: 1;
  border-color: rgb(243 244 246 / var(--tw-border-opacity));
}

.border-gray-200 {
  --tw-border-opacity: 1;
  border-color: rgb(229 231 235 / var(--tw-border-opacity));
}

.border-gray-300 {
  --tw-border-opacity: 1;
  border-color: rgb(209 213 219 / var(--tw-border-opacity));
}

.border-transparent {
  border-color: transparent;
}

.bg-gray-100 {
  --tw-bg-opacity: 1;
  background-color: rgb(243 244 246 / var(--tw-bg-opacity));
}

.bg-gray-200 {
  --tw-bg-opacity: 1;
  background-color: rgb(229 231 235 / var(--tw-bg-opacity));
}

.bg-gray-400\/30 {
  background-color: rgb(156 163 175 / 0.3);
}

.bg-gray-50 {
  --tw-bg-opacity: 1;
  background-color: rgb(249 250 251 / var(--tw-bg-opacity));
}

.bg-gray-500 {
  --tw-bg-opacity: 1;
  background-color: rgb(107 114 128 / var(--tw-bg-opacity));
}

.bg-green-300\/50 {
  background-color: rgb(134 239 172 / 0.5);
}

.bg-red-100 {
  --tw-bg-opacity: 1;
  background-color: rgb(254 226 226 / var(--tw-bg-opacity));
}

.bg-red-50 {
  --tw-bg-opacity: 1;
  background-color: rgb(254 242 242 / var(--tw-bg-opacity));
}

.bg-red-600 {
  --tw-bg-opacity: 1;
  background-color: rgb(220 38 38 / var(--tw-bg-opacity));
}

.bg-teal-300 {
  --tw-bg-opacity: 1;
  background-color: rgb(94 234 212 / var(--tw-bg-opacity));
}

.bg-teal-400 {
  --tw-bg-opacity: 1;
  background-color: rgb(45 212 191 / var(--tw-bg-opacity));
}

.bg-teal-600 {
  --tw-bg-opacity: 1;
  background-color: rgb(13 148 136 / var(--tw-bg-opacity));
}

.bg-transparent {
  background-color: transparent;
}

.bg-white {
  --tw-bg-opacity: 1;
  background-color: rgb(255 255 255 / var(--tw-bg-opacity));
}

.bg-white\/90 {
  background-color: rgb(255 255 255 / 0.9);
}

.bg-yellow-300 {
  --tw-bg-opacity: 1;
  background-color: rgb(253 224 71 / var(--tw-bg-opacity));
}

.bg-opacity-25 {
  --tw-bg-opacity: 0.25;
}

.bg-opacity-60 {
  --tw-bg-opacity: 0.6;
}

.bg-opacity-75 {
  --tw-bg-opacity: 0.75;
}

.bg-opacity-80 {
  --tw-bg-opacity: 0.8;
}

.fill-current {
  fill: currentColor;
}

.fill-teal-600 {
  fill: #0d9488;
}

.stroke-current {
  stroke: currentColor;
}

.p-0 {
  padding: 0px;
}

.p-0\.5 {
  padding: 0.125rem;
}

.p-1 {
  padding: 0.25rem;
}

.p-1\.5 {
  padding: 0.375rem;
}

.p-2 {
  padding: 0.5rem;
}

.p-2\.5 {
  padding: 0.625rem;
}

.p-3 {
  padding: 0.75rem;
}

.p-4 {
  padding: 1rem;
}

.p-8 {
  padding: 2rem;
}

.px-0 {
  padding-left: 0px;
  padding-right: 0px;
}

.px-1 {
  padding-left: 0.25rem;
  padding-right: 0.25rem;
}

.px-2 {
  padding-left: 0.5rem;
  padding-right: 0.5rem;
}

.px-3 {
  padding-left: 0.75rem;
  padding-right: 0.75rem;
}

.px-4 {
  padding-left: 1rem;
  padding-right: 1rem;
}

.px-5 {
  padding-left: 1.25rem;
  padding-right: 1.25rem;
}

.px-6 {
  padding-left: 1.5rem;
  padding-right: 1.5rem;
}

.py-0 {
  padding-top: 0px;
  padding-bottom: 0px;
}

.py-0\.5 {
  padding-top: 0.125rem;
  padding-bottom: 0.125rem;
}

.py-1 {
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
}

.py-1\.5 {
  padding-top: 0.375rem;
  padding-bottom: 0.375rem;
}

.py-2 {
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
}

.py-3 {
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
}

.py-4 {
  padding-top: 1rem;
  padding-bottom: 1rem;
}

.py-5 {
  padding-top: 1.25rem;
  padding-bottom: 1.25rem;
}

.py-6 {
  padding-top: 1.5rem;
  padding-bottom: 1.5rem;
}

.py-8 {
  padding-top: 2rem;
  padding-bottom: 2rem;
}

.pb-0 {
  padding-bottom: 0px;
}

.pb-0\.5 {
  padding-bottom: 0.125rem;
}

.pb-1 {
  padding-bottom: 0.25rem;
}

.pb-10 {
  padding-bottom: 2.5rem;
}

.pb-2 {
  padding-bottom: 0.5rem;
}

.pb-3 {
  padding-bottom: 0.75rem;
}

.pb-4 {
  padding-bottom: 1rem;
}

.pl-0 {
  padding-left: 0px;
}

.pl-0\.5 {
  padding-left: 0.125rem;
}

.pl-1 {
  padding-left: 0.25rem;
}

.pl-2 {
  padding-left: 0.5rem;
}

.pl-20 {
  padding-left: 5rem;
}

.pl-24 {
  padding-left: 6rem;
}

.pl-3 {
  padding-left: 0.75rem;
}

.pl-5 {
  padding-left: 1.25rem;
}

.pl-7 {
  padding-left: 1.75rem;
}

.pr-0 {
  padding-right: 0px;
}

.pr-1 {
  padding-right: 0.25rem;
}

.pr-10 {
  padding-right: 2.5rem;
}

.pr-2 {
  padding-right: 0.5rem;
}

.pr-4 {
  padding-right: 1rem;
}

.pt-0 {
  padding-top: 0px;
}

.pt-0\.5 {
  padding-top: 0.125rem;
}

.pt-1 {
  padding-top: 0.25rem;
}

.pt-2 {
  padding-top: 0.5rem;
}

.pt-2\.5 {
  padding-top: 0.625rem;
}

.pt-5 {
  padding-top: 1.25rem;
}

.text-left {
  text-align: left;
}

.text-center {
  text-align: center;
}

.text-start {
  text-align: start;
}

.align-middle {
  vertical-align: middle;
}

.font-sans {
  font-family: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
}

.text-2xl {
  font-size: 1.5rem;
  line-height: 2rem;
}

.text-3xl {
  font-size: 1.875rem;
  line-height: 2.25rem;
}

.text-base {
  font-size: 1rem;
  line-height: 1.5rem;
}

.text-lg {
  font-size: 1.125rem;
  line-height: 1.75rem;
}

.text-sm {
  font-size: 0.875rem;
  line-height: 1.25rem;
}

.text-xs {
  font-size: 0.75rem;
  line-height: 1rem;
}

.font-bold {
  font-weight: 700;
}

.font-medium {
  font-weight: 500;
}

.font-semibold {
  font-weight: 600;
}

.uppercase {
  text-transform: uppercase;
}

.leading-4 {
  line-height: 1rem;
}

.leading-5 {
  line-height: 1.25rem;
}

.leading-6 {
  line-height: 1.5rem;
}

.leading-7 {
  line-height: 1.75rem;
}

.leading-8 {
  line-height: 2rem;
}

.leading-tight {
  line-height: 1.25;
}

.tracking-tight {
  letter-spacing: -0.025em;
}

.text-black {
  --tw-text-opacity: 1;
  color: rgb(0 0 0 / var(--tw-text-opacity));
}

.text-blue-600 {
  --tw-text-opacity: 1;
  color: rgb(37 99 235 / var(--tw-text-opacity));
}

.text-gray-200 {
  --tw-text-opacity: 1;
  color: rgb(229 231 235 / var(--tw-text-opacity));
}

.text-gray-400 {
  --tw-text-opacity: 1;
  color: rgb(156 163 175 / var(--tw-text-opacity));
}

.text-gray-500 {
  --tw-text-opacity: 1;
  color: rgb(107 114 128 / var(--tw-text-opacity));
}

.text-gray-600 {
  --tw-text-opacity: 1;
  color: rgb(75 85 99 / var(--tw-text-opacity));
}

.text-gray-700 {
  --tw-text-opacity: 1;
  color: rgb(55 65 81 / var(--tw-text-opacity));
}

.text-gray-800 {
  --tw-text-opacity: 1;
  color: rgb(31 41 55 / var(--tw-text-opacity));
}

.text-gray-900 {
  --tw-text-opacity: 1;
  color: rgb(17 24 39 / var(--tw-text-opacity));
}

.text-green-400 {
  --tw-text-opacity: 1;
  color: rgb(74 222 128 / var(--tw-text-opacity));
}

.text-indigo-600 {
  --tw-text-opacity: 1;
  color: rgb(79 70 229 / var(--tw-text-opacity));
}

.text-orange-600 {
  --tw-text-opacity: 1;
  color: rgb(234 88 12 / var(--tw-text-opacity));
}

.text-red-400 {
  --tw-text-opacity: 1;
  color: rgb(248 113 113 / var(--tw-text-opacity));
}

.text-red-500 {
  --tw-text-opacity: 1;
  color: rgb(239 68 68 / var(--tw-text-opacity));
}

.text-red-600 {
  --tw-text-opacity: 1;
  color: rgb(220 38 38 / var(--tw-text-opacity));
}

.text-red-700 {
  --tw-text-opacity: 1;
  color: rgb(185 28 28 / var(--tw-text-opacity));
}

.text-red-800 {
  --tw-text-opacity: 1;
  color: rgb(153 27 27 / var(--tw-text-opacity));
}

.text-teal-500 {
  --tw-text-opacity: 1;
  color: rgb(20 184 166 / var(--tw-text-opacity));
}

.text-teal-600 {
  --tw-text-opacity: 1;
  color: rgb(13 148 136 / var(--tw-text-opacity));
}

.text-transparent {
  color: transparent;
}

.text-white {
  --tw-text-opacity: 1;
  color: rgb(255 255 255 / var(--tw-text-opacity));
}

.text-yellow-400 {
  --tw-text-opacity: 1;
  color: rgb(250 204 21 / var(--tw-text-opacity));
}

.text-opacity-40 {
  --tw-text-opacity: 0.4;
}

.opacity-0 {
  opacity: 0;
}

.opacity-100 {
  opacity: 1;
}

.shadow {
  --tw-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
  --tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);
  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow-2xl {
  --tw-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25);
  --tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);
  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow-inner {
  --tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);
  --tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);
  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow-lg {
  --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);
  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow-md {
  --tw-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);
  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow-sm {
  --tw-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);
  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.shadow-xl {
  --tw-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
  --tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);
  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}

.outline {
  outline-style: solid;
}

.outline-1 {
  outline-width: 1px;
}

.outline-offset-0 {
  outline-offset: 0px;
}

.outline-gray-300 {
  outline-color: #d1d5db;
}

.ring-0 {
  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);
  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
}

.ring-1 {
  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);
  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
}

.ring-inset {
  --tw-ring-inset: inset;
}

.ring-black {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(0 0 0 / var(--tw-ring-opacity));
}

.ring-gray-200 {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(229 231 235 / var(--tw-ring-opacity));
}

.ring-gray-300 {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(209 213 219 / var(--tw-ring-opacity));
}

.ring-gray-400 {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(156 163 175 / var(--tw-ring-opacity));
}

.ring-opacity-5 {
  --tw-ring-opacity: 0.05;
}

.blur {
  --tw-blur: blur(8px);
  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);
}

.drop-shadow-xl {
  --tw-drop-shadow: drop-shadow(0 20px 13px rgb(0 0 0 / 0.03)) drop-shadow(0 8px 5px rgb(0 0 0 / 0.08));
  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);
}

.grayscale {
  --tw-grayscale: grayscale(100%);
  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);
}

.filter {
  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);
}

.backdrop-blur {
  --tw-backdrop-blur: blur(8px);
  -webkit-backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);
          backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);
}

.backdrop-blur-xl {
  --tw-backdrop-blur: blur(24px);
  -webkit-backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);
          backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);
}

.backdrop-filter {
  -webkit-backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);
          backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);
}

.transition {
  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;
  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

.transition-all {
  transition-property: all;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

.transition-colors {
  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

.transition-opacity {
  transition-property: opacity;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

.duration-100 {
  transition-duration: 100ms;
}

.duration-200 {
  transition-duration: 200ms;
}

.duration-300 {
  transition-duration: 300ms;
}

.ease-in {
  transition-timing-function: cubic-bezier(0.4, 0, 1, 1);
}

.ease-in-out {
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

.ease-linear {
  transition-timing-function: linear;
}

.ease-out {
  transition-timing-function: cubic-bezier(0, 0, 0.2, 1);
}

.placeholder\:text-gray-400::-moz-placeholder {
  --tw-text-opacity: 1;
  color: rgb(156 163 175 / var(--tw-text-opacity));
}

.placeholder\:text-gray-400::placeholder {
  --tw-text-opacity: 1;
  color: rgb(156 163 175 / var(--tw-text-opacity));
}

.focus-within\:ring-2:focus-within {
  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
}

.focus-within\:ring-indigo-600:focus-within {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(79 70 229 / var(--tw-ring-opacity));
}

.focus-within\:ring-teal-600:focus-within {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(13 148 136 / var(--tw-ring-opacity));
}

.hover\:rotate-90:hover {
  --tw-rotate: 90deg;
  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}

.hover\:bg-gray-100:hover {
  --tw-bg-opacity: 1;
  background-color: rgb(243 244 246 / var(--tw-bg-opacity));
}

.hover\:bg-gray-200:hover {
  --tw-bg-opacity: 1;
  background-color: rgb(229 231 235 / var(--tw-bg-opacity));
}

.hover\:bg-gray-50:hover {
  --tw-bg-opacity: 1;
  background-color: rgb(249 250 251 / var(--tw-bg-opacity));
}

.hover\:bg-red-500:hover {
  --tw-bg-opacity: 1;
  background-color: rgb(239 68 68 / var(--tw-bg-opacity));
}

.hover\:bg-sky-100:hover {
  --tw-bg-opacity: 1;
  background-color: rgb(224 242 254 / var(--tw-bg-opacity));
}

.hover\:bg-teal-400:hover {
  --tw-bg-opacity: 1;
  background-color: rgb(45 212 191 / var(--tw-bg-opacity));
}

.hover\:text-gray-400:hover {
  --tw-text-opacity: 1;
  color: rgb(156 163 175 / var(--tw-text-opacity));
}

.hover\:text-gray-500:hover {
  --tw-text-opacity: 1;
  color: rgb(107 114 128 / var(--tw-text-opacity));
}

.hover\:text-teal-600:hover {
  --tw-text-opacity: 1;
  color: rgb(13 148 136 / var(--tw-text-opacity));
}

.hover\:text-white:hover {
  --tw-text-opacity: 1;
  color: rgb(255 255 255 / var(--tw-text-opacity));
}

.focus\:border-blue-500:focus {
  --tw-border-opacity: 1;
  border-color: rgb(59 130 246 / var(--tw-border-opacity));
}

.focus\:bg-teal-500\/25:focus {
  background-color: rgb(20 184 166 / 0.25);
}

.focus\:outline-none:focus {
  outline: 2px solid transparent;
  outline-offset: 2px;
}

.focus\:ring-0:focus {
  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);
  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
}

.focus\:ring-2:focus {
  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
}

.focus\:ring-inset:focus {
  --tw-ring-inset: inset;
}

.focus\:ring-blue-500:focus {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity));
}

.focus\:ring-indigo-500:focus {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(99 102 241 / var(--tw-ring-opacity));
}

.focus\:ring-indigo-600:focus {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(79 70 229 / var(--tw-ring-opacity));
}

.focus\:ring-teal-600:focus {
  --tw-ring-opacity: 1;
  --tw-ring-color: rgb(13 148 136 / var(--tw-ring-opacity));
}

.focus\:ring-offset-2:focus {
  --tw-ring-offset-width: 2px;
}

.focus-visible\:outline:focus-visible {
  outline-style: solid;
}

.focus-visible\:outline-2:focus-visible {
  outline-width: 2px;
}

.focus-visible\:outline-offset-2:focus-visible {
  outline-offset: 2px;
}

.group:hover .group-hover\:bg-gray-300 {
  --tw-bg-opacity: 1;
  background-color: rgb(209 213 219 / var(--tw-bg-opacity));
}

.group:hover .group-hover\:text-indigo-500 {
  --tw-text-opacity: 1;
  color: rgb(99 102 241 / var(--tw-text-opacity));
}

.group:hover .group-hover\:text-white {
  --tw-text-opacity: 1;
  color: rgb(255 255 255 / var(--tw-text-opacity));
}

.group:hover .group-hover\:opacity-0 {
  opacity: 0;
}

.group:hover .group-hover\:opacity-100 {
  opacity: 1;
}

[os="Browser"] .bro\:ml-0 {
  margin-left: 0px;
}

[os="Browser"] .bro\:hidden {
  display: none;
}

@media (min-width: 640px) {
  .sm\:mx-0 {
    margin-left: 0px;
    margin-right: 0px;
  }

  .sm\:my-8 {
    margin-top: 2rem;
    margin-bottom: 2rem;
  }

  .sm\:ml-3 {
    margin-left: 0.75rem;
  }

  .sm\:ml-4 {
    margin-left: 1rem;
  }

  .sm\:mt-0 {
    margin-top: 0px;
  }

  .sm\:mt-4 {
    margin-top: 1rem;
  }

  .sm\:flex {
    display: flex;
  }

  .sm\:h-10 {
    height: 2.5rem;
  }

  .sm\:w-10 {
    width: 2.5rem;
  }

  .sm\:w-auto {
    width: auto;
  }

  .sm\:w-full {
    width: 100%;
  }

  .sm\:max-w-lg {
    max-width: 32rem;
  }

  .sm\:translate-x-0 {
    --tw-translate-x: 0px;
    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
  }

  .sm\:translate-x-2 {
    --tw-translate-x: 0.5rem;
    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
  }

  .sm\:translate-y-0 {
    --tw-translate-y: 0px;
    transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
  }

  .sm\:flex-row-reverse {
    flex-direction: row-reverse;
  }

  .sm\:flex-col {
    flex-direction: column;
  }

  .sm\:items-start {
    align-items: flex-start;
  }

  .sm\:items-end {
    align-items: flex-end;
  }

  .sm\:items-center {
    align-items: center;
  }

  .sm\:p-0 {
    padding: 0px;
  }

  .sm\:p-6 {
    padding: 1.5rem;
  }

  .sm\:px-0 {
    padding-left: 0px;
    padding-right: 0px;
  }

  .sm\:px-2 {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
  }

  .sm\:px-6 {
    padding-left: 1.5rem;
    padding-right: 1.5rem;
  }

  .sm\:pr-3 {
    padding-right: 0.75rem;
  }

  .sm\:text-left {
    text-align: left;
  }

  .sm\:text-sm {
    font-size: 0.875rem;
    line-height: 1.25rem;
  }

  .sm\:text-xs {
    font-size: 0.75rem;
    line-height: 1rem;
  }

  .sm\:leading-6 {
    line-height: 1.5rem;
  }
}

@media (min-width: 768px) {
  .md\:fixed {
    position: fixed;
  }

  .md\:inset-y-0 {
    top: 0px;
    bottom: 0px;
  }

  .md\:z-50 {
    z-index: 50;
  }

  .md\:-ml-14 {
    margin-left: -3.5rem;
  }

  .md\:ml-2 {
    margin-left: 0.5rem;
  }

  .md\:ml-5 {
    margin-left: 1.25rem;
  }

  .md\:block {
    display: block;
  }

  .md\:flex {
    display: flex;
  }

  .md\:flex-col {
    flex-direction: column;
  }

  .md\:space-x-3 > :not([hidden]) ~ :not([hidden]) {
    --tw-space-x-reverse: 0;
    margin-right: calc(0.75rem * var(--tw-space-x-reverse));
    margin-left: calc(0.75rem * calc(1 - var(--tw-space-x-reverse)));
  }

  .md\:p-20 {
    padding: 5rem;
  }

  .md\:px-4 {
    padding-left: 1rem;
    padding-right: 1rem;
  }

  .md\:pl-2 {
    padding-left: 0.5rem;
  }

  .md\:pr-5 {
    padding-right: 1.25rem;
  }
}

@media (min-width: 1024px) {
  .lg\:px-8 {
    padding-left: 2rem;
    padding-right: 2rem;
  }
}

@media (prefers-color-scheme: dark) {
  .dark\:divide-gray-600 > :not([hidden]) ~ :not([hidden]) {
    --tw-divide-opacity: 1;
    border-color: rgb(75 85 99 / var(--tw-divide-opacity));
  }

  .dark\:divide-gray-700 > :not([hidden]) ~ :not([hidden]) {
    --tw-divide-opacity: 1;
    border-color: rgb(55 65 81 / var(--tw-divide-opacity));
  }

  .dark\:border-gray-500 {
    --tw-border-opacity: 1;
    border-color: rgb(107 114 128 / var(--tw-border-opacity));
  }

  .dark\:border-gray-600 {
    --tw-border-opacity: 1;
    border-color: rgb(75 85 99 / var(--tw-border-opacity));
  }

  .dark\:bg-gray-400 {
    --tw-bg-opacity: 1;
    background-color: rgb(156 163 175 / var(--tw-bg-opacity));
  }

  .dark\:bg-gray-600 {
    --tw-bg-opacity: 1;
    background-color: rgb(75 85 99 / var(--tw-bg-opacity));
  }

  .dark\:bg-gray-700 {
    --tw-bg-opacity: 1;
    background-color: rgb(55 65 81 / var(--tw-bg-opacity));
  }

  .dark\:bg-gray-800 {
    --tw-bg-opacity: 1;
    background-color: rgb(31 41 55 / var(--tw-bg-opacity));
  }

  .dark\:bg-red-800 {
    --tw-bg-opacity: 1;
    background-color: rgb(153 27 27 / var(--tw-bg-opacity));
  }

  .dark\:bg-teal-500 {
    --tw-bg-opacity: 1;
    background-color: rgb(20 184 166 / var(--tw-bg-opacity));
  }

  .dark\:bg-opacity-75 {
    --tw-bg-opacity: 0.75;
  }

  .dark\:text-blue-300 {
    --tw-text-opacity: 1;
    color: rgb(147 197 253 / var(--tw-text-opacity));
  }

  .dark\:text-gray-300 {
    --tw-text-opacity: 1;
    color: rgb(209 213 219 / var(--tw-text-opacity));
  }

  .dark\:text-gray-400 {
    --tw-text-opacity: 1;
    color: rgb(156 163 175 / var(--tw-text-opacity));
  }

  .dark\:text-gray-500 {
    --tw-text-opacity: 1;
    color: rgb(107 114 128 / var(--tw-text-opacity));
  }

  .dark\:text-gray-600 {
    --tw-text-opacity: 1;
    color: rgb(75 85 99 / var(--tw-text-opacity));
  }

  .dark\:text-gray-800 {
    --tw-text-opacity: 1;
    color: rgb(31 41 55 / var(--tw-text-opacity));
  }

  .dark\:text-red-200 {
    --tw-text-opacity: 1;
    color: rgb(254 202 202 / var(--tw-text-opacity));
  }

  .dark\:text-red-300 {
    --tw-text-opacity: 1;
    color: rgb(252 165 165 / var(--tw-text-opacity));
  }

  .dark\:text-white {
    --tw-text-opacity: 1;
    color: rgb(255 255 255 / var(--tw-text-opacity));
  }

  .dark\:placeholder-gray-400::-moz-placeholder {
    --tw-placeholder-opacity: 1;
    color: rgb(156 163 175 / var(--tw-placeholder-opacity));
  }

  .dark\:placeholder-gray-400::placeholder {
    --tw-placeholder-opacity: 1;
    color: rgb(156 163 175 / var(--tw-placeholder-opacity));
  }

  .dark\:outline-gray-700 {
    outline-color: #374151;
  }

  .dark\:ring-gray-500 {
    --tw-ring-opacity: 1;
    --tw-ring-color: rgb(107 114 128 / var(--tw-ring-opacity));
  }

  .dark\:ring-gray-600 {
    --tw-ring-opacity: 1;
    --tw-ring-color: rgb(75 85 99 / var(--tw-ring-opacity));
  }

  .dark\:ring-gray-700 {
    --tw-ring-opacity: 1;
    --tw-ring-color: rgb(55 65 81 / var(--tw-ring-opacity));
  }

  .dark\:ring-gray-800 {
    --tw-ring-opacity: 1;
    --tw-ring-color: rgb(31 41 55 / var(--tw-ring-opacity));
  }

  .dark\:contrast-75 {
    --tw-contrast: contrast(.75);
    filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);
  }

  .dark\:hue-rotate-180 {
    --tw-hue-rotate: hue-rotate(180deg);
    filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);
  }

  .dark\:invert {
    --tw-invert: invert(100%);
    filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);
  }

  .dark\:hover\:bg-gray-200:hover {
    --tw-bg-opacity: 1;
    background-color: rgb(229 231 235 / var(--tw-bg-opacity));
  }

  .dark\:hover\:bg-gray-700:hover {
    --tw-bg-opacity: 1;
    background-color: rgb(55 65 81 / var(--tw-bg-opacity));
  }

  .dark\:hover\:text-white:hover {
    --tw-text-opacity: 1;
    color: rgb(255 255 255 / var(--tw-text-opacity));
  }
}</style><style >.frontend-view {
    display: inline-flex;
    vertical-align: sub;
    position: relative;
}

@keyframes pulse {
  50% {
      opacity:.75
  }
}

.frontend-view:empty::after {
  width: 100%;
  height: 100%;
  padding: 0.20em;
  padding-right:1em;
  padding-left:1em;
  border-radius:4px;
  font-family:system-ui;
  color:#444;
  background: rgba(15, 15, 15, 0.2);
  opacity: 0.25;
  overflow: hidden;
  font-size:x-small;
  content: 'Loading...';
  animation: pulse 2s cubic-bezier(.4,0,.6,1) infinite;
}

.cm-tooltip {
    font-family: var(--font-code-family);
    line-height:1.2;
}

.cm-focused {
    outline: none !important;
    background: var(--editor-selected-tint) !important;
    border-radius: 1px !important;
}


.cm-tooltip.cm-tooltip-autocomplete ul li {
  font-family: var(--font-code-family);
}

.cm-tooltip-autocomplete.cm-tooltip{
border: 1px none #888 !important;
border-radius: 4px !important;
/* box-shadow: 0px 0px 10px #d4d4d47f !important; */
background-color: #fff !important;
}

.cm-tooltip.cm-tooltip-autocomplete > ul{
font-family: 'Hasklig' !important;
  font-size: small !important;
  padding: 0em;
  white-space: nowrap;
  overflow: hidden auto;
  max-width: 700px;
  max-width: min(700px, 95vw);
  min-width: 250px;
  max-height: 10em;
  height: 100%;
  list-style: none;
  margin: 0;
  padding: 0;
  padding: 0.25rem !important;
  overflow-y: hidden !important;
}

.cm-tooltip-autocomplete ul li[aria-selected] {
background: #00b5f8 !important;
color: white !important;

border-radius: 4px !important;
}

.cm-tooltip.cm-completionInfo {
position: absolute;
padding: 3px 9px;
font-size: small !important;
width: max-content;
max-width: 400px;
box-sizing: border-box;
border-radius: 4px !important;
border: 1px none #888 !important;
color: #333338;
border-radius: 4px !important;
box-shadow: 0px 0px 10px #d4d4d47f !important;
background-color: #fff !important;
}
.frame-box {
    border: 1px solid #000000;
  }

sup.subscript-tail {
    line-height: normal;
    vertical-align: super;
    font-size: smaller;
    top:auto;
}

sub.subscript-tail {
  line-height: normal;
  vertical-align: sub;
  font-size: smaller;
  bottom:auto;
}
  
  .subscript-tail {
    display: inline-block;
  }
  
  .fraction {
    display: inline-flex;
    vertical-align: middle;
  }
  
  .matrix {
    display: inline-flex;
  }
  
  .fraction .container .enumenator {
    border-bottom:solid 1px;
  }
  
  .sqroot {
    display: inline-block;
    vertical-align: middle;
    border-top: 1px solid;
    border-left: 1px solid;
    transform: skew(-15deg);
    transform-origin: bottom left;
    margin: 0 10px;
    position: relative;
  }
  
  .sqroot:before {
    content: "";
    position: absolute;
    bottom: 0;
    height: 40%;
    width: 5px;
    left: -5px;
    border-top: 1px solid;
    border-right: 1px solid;
    transform: skew(30deg);
    transform-origin: bottom right;
  }
  
  .radicand {
    display: inline-block;
    padding-left: 0.5em;
    transform: skew(15deg);
  }

 </style>
<style >.cell-type-html {
    background: #b6d3ff;
    color: #0000009c;
  }</style>
<style >.cell-type-js {
    background: #ffe846;
    color: #000000ad;
}
.cell-type-esm {
    background: #ffc364;
    color: #000000ad;
}</style>
<style >@font-face {
    font-family: KaTeX_AMS;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"), url(fonts/KaTeX_AMS-Regular.woff) format("woff"), url(fonts/KaTeX_AMS-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Caligraphic;
    font-style: normal;
    font-weight: 700;
    src: url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"), url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"), url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Caligraphic;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"), url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"), url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Fraktur;
    font-style: normal;
    font-weight: 700;
    src: url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"), url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"), url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Fraktur;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"), url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"), url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Main;
    font-style: normal;
    font-weight: 700;
    src: url(fonts/KaTeX_Main-Bold.woff2) format("woff2"), url(fonts/KaTeX_Main-Bold.woff) format("woff"), url(fonts/KaTeX_Main-Bold.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Main;
    font-style: italic;
    font-weight: 700;
    src: url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"), url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"), url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Main;
    font-style: italic;
    font-weight: 400;
    src: url(fonts/KaTeX_Main-Italic.woff2) format("woff2"), url(fonts/KaTeX_Main-Italic.woff) format("woff"), url(fonts/KaTeX_Main-Italic.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Main;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Main-Regular.woff2) format("woff2"), url(fonts/KaTeX_Main-Regular.woff) format("woff"), url(fonts/KaTeX_Main-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Math;
    font-style: italic;
    font-weight: 700;
    src: url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"), url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"), url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Math;
    font-style: italic;
    font-weight: 400;
    src: url(fonts/KaTeX_Math-Italic.woff2) format("woff2"), url(fonts/KaTeX_Math-Italic.woff) format("woff"), url(fonts/KaTeX_Math-Italic.ttf) format("truetype")
}

@font-face {
    font-family: "KaTeX_SansSerif";
    font-style: normal;
    font-weight: 700;
    src: url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"), url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"), url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype")
}

@font-face {
    font-family: "KaTeX_SansSerif";
    font-style: italic;
    font-weight: 400;
    src: url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"), url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"), url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype")
}

@font-face {
    font-family: "KaTeX_SansSerif";
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"), url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"), url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Script;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Script-Regular.woff2) format("woff2"), url(fonts/KaTeX_Script-Regular.woff) format("woff"), url(fonts/KaTeX_Script-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Size1;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"), url(fonts/KaTeX_Size1-Regular.woff) format("woff"), url(fonts/KaTeX_Size1-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Size2;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"), url(fonts/KaTeX_Size2-Regular.woff) format("woff"), url(fonts/KaTeX_Size2-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Size3;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"), url(fonts/KaTeX_Size3-Regular.woff) format("woff"), url(fonts/KaTeX_Size3-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Size4;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"), url(fonts/KaTeX_Size4-Regular.woff) format("woff"), url(fonts/KaTeX_Size4-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Typewriter;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"), url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"), url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype")
}

.katex {
    text-rendering: auto;
    font: normal 1.21em KaTeX_Main, Times New Roman, serif;
    line-height: normal;
    text-indent:0
}

.katex * {
    -ms-high-contrast-adjust: none !important;
    border-color:currentColor
}

.katex .katex-version:after {
    content: "0.16.2"
}

.katex .katex-mathml {
    clip: rect(1px, 1px, 1px, 1px);
    border: 0;
    height: 1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width:1px
}

.katex .katex-html > .newline {
    display:block
}

.katex .base {
    position: relative;
    white-space: nowrap;
    width: -webkit-min-content;
    width: -moz-min-content;
    width:min-content
}

.katex .base, .katex .strut {
    display:inline-block
}

.katex .textbf {
    font-weight:700
}

.katex .textit {
    font-style:italic
}

.katex .textrm {
    font-family:KaTeX_Main
}

.katex .textsf {
    font-family:KaTeX_SansSerif
}

.katex .texttt {
    font-family:KaTeX_Typewriter
}

.katex .mathnormal {
    font-family: KaTeX_Math;
    font-style:italic
}

.katex .mathit {
    font-family: KaTeX_Main;
    font-style:italic
}

.katex .mathrm {
    font-style:normal
}

.katex .mathbf {
    font-family: KaTeX_Main;
    font-weight:700
}

.katex .boldsymbol {
    font-family: KaTeX_Math;
    font-style: italic;
    font-weight:700
}

.katex .amsrm, .katex .mathbb, .katex .textbb {
    font-family:KaTeX_AMS
}

.katex .mathcal {
    font-family:KaTeX_Caligraphic
}

.katex .mathfrak, .katex .textfrak {
    font-family:KaTeX_Fraktur
}

.katex .mathtt {
    font-family:KaTeX_Typewriter
}

.katex .mathscr, .katex .textscr {
    font-family:KaTeX_Script
}

.katex .mathsf, .katex .textsf {
    font-family:KaTeX_SansSerif
}

.katex .mathboldsf, .katex .textboldsf {
    font-family: KaTeX_SansSerif;
    font-weight:700
}

.katex .mathitsf, .katex .textitsf {
    font-family: KaTeX_SansSerif;
    font-style:italic
}

.katex .mainrm {
    font-family: KaTeX_Main;
    font-style:normal
}

.katex .vlist-t {
    border-collapse: collapse;
    display: inline-table;
    table-layout:fixed
}

.katex .vlist-r {
    display:table-row
}

.katex .vlist {
    display: table-cell;
    position: relative;
    vertical-align:bottom
}

.katex .vlist > span {
    display: block;
    height: 0;
    position:relative
}

.katex .vlist > span > span {
    display:inline-block
}

.katex .vlist > span > .pstrut {
    overflow: hidden;
    width:0
}

.katex .vlist-t2 {
    margin-right:-2px
}

.katex .vlist-s {
    display: table-cell;
    font-size: 1px;
    min-width: 2px;
    vertical-align: bottom;
    width:2px
}

.katex .vbox {
    align-items: baseline;
    display: inline-flex;
    flex-direction:column
}

.katex .hbox {
    width:100%
}

.katex .hbox, .katex .thinbox {
    display: inline-flex;
    flex-direction:row
}

.katex .thinbox {
    max-width: 0;
    width:0
}

.katex .msupsub {
    text-align:left
}

.katex .mfrac > span > span {
    text-align:center
}

.katex .mfrac .frac-line {
    border-bottom-style: solid;
    display: inline-block;
    width:100%
}

.katex .hdashline, .katex .hline, .katex .mfrac .frac-line, .katex .overline .overline-line, .katex .rule, .katex .underline .underline-line {
    min-height:1px
}

.katex .mspace {
    display:inline-block
}

.katex .clap, .katex .llap, .katex .rlap {
    position: relative;
    width:0
}

.katex .clap > .inner, .katex .llap > .inner, .katex .rlap > .inner {
    position:absolute
}

.katex .clap > .fix, .katex .llap > .fix, .katex .rlap > .fix {
    display:inline-block
}

.katex .llap > .inner {
    right:0
}

.katex .clap > .inner, .katex .rlap > .inner {
    left:0
}

.katex .clap > .inner > span {
    margin-left: -50%;
    margin-right:50%
}

.katex .rule {
    border: 0 solid;
    display: inline-block;
    position:relative
}

.katex .hline, .katex .overline .overline-line, .katex .underline .underline-line {
    border-bottom-style: solid;
    display: inline-block;
    width:100%
}

.katex .hdashline {
    border-bottom-style: dashed;
    display: inline-block;
    width:100%
}

.katex .sqrt > .root {
    margin-left: .27777778em;
    margin-right:-.55555556em
}

.katex .fontsize-ensurer.reset-size1.size1, .katex .sizing.reset-size1.size1 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size1.size2, .katex .sizing.reset-size1.size2 {
    font-size:1.2em
}

.katex .fontsize-ensurer.reset-size1.size3, .katex .sizing.reset-size1.size3 {
    font-size:1.4em
}

.katex .fontsize-ensurer.reset-size1.size4, .katex .sizing.reset-size1.size4 {
    font-size:1.6em
}

.katex .fontsize-ensurer.reset-size1.size5, .katex .sizing.reset-size1.size5 {
    font-size:1.8em
}

.katex .fontsize-ensurer.reset-size1.size6, .katex .sizing.reset-size1.size6 {
    font-size:2em
}

.katex .fontsize-ensurer.reset-size1.size7, .katex .sizing.reset-size1.size7 {
    font-size:2.4em
}

.katex .fontsize-ensurer.reset-size1.size8, .katex .sizing.reset-size1.size8 {
    font-size:2.88em
}

.katex .fontsize-ensurer.reset-size1.size9, .katex .sizing.reset-size1.size9 {
    font-size:3.456em
}

.katex .fontsize-ensurer.reset-size1.size10, .katex .sizing.reset-size1.size10 {
    font-size:4.148em
}

.katex .fontsize-ensurer.reset-size1.size11, .katex .sizing.reset-size1.size11 {
    font-size:4.976em
}

.katex .fontsize-ensurer.reset-size2.size1, .katex .sizing.reset-size2.size1 {
    font-size:.83333333em
}

.katex .fontsize-ensurer.reset-size2.size2, .katex .sizing.reset-size2.size2 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size2.size3, .katex .sizing.reset-size2.size3 {
    font-size:1.16666667em
}

.katex .fontsize-ensurer.reset-size2.size4, .katex .sizing.reset-size2.size4 {
    font-size:1.33333333em
}

.katex .fontsize-ensurer.reset-size2.size5, .katex .sizing.reset-size2.size5 {
    font-size:1.5em
}

.katex .fontsize-ensurer.reset-size2.size6, .katex .sizing.reset-size2.size6 {
    font-size:1.66666667em
}

.katex .fontsize-ensurer.reset-size2.size7, .katex .sizing.reset-size2.size7 {
    font-size:2em
}

.katex .fontsize-ensurer.reset-size2.size8, .katex .sizing.reset-size2.size8 {
    font-size:2.4em
}

.katex .fontsize-ensurer.reset-size2.size9, .katex .sizing.reset-size2.size9 {
    font-size:2.88em
}

.katex .fontsize-ensurer.reset-size2.size10, .katex .sizing.reset-size2.size10 {
    font-size:3.45666667em
}

.katex .fontsize-ensurer.reset-size2.size11, .katex .sizing.reset-size2.size11 {
    font-size:4.14666667em
}

.katex .fontsize-ensurer.reset-size3.size1, .katex .sizing.reset-size3.size1 {
    font-size:.71428571em
}

.katex .fontsize-ensurer.reset-size3.size2, .katex .sizing.reset-size3.size2 {
    font-size:.85714286em
}

.katex .fontsize-ensurer.reset-size3.size3, .katex .sizing.reset-size3.size3 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size3.size4, .katex .sizing.reset-size3.size4 {
    font-size:1.14285714em
}

.katex .fontsize-ensurer.reset-size3.size5, .katex .sizing.reset-size3.size5 {
    font-size:1.28571429em
}

.katex .fontsize-ensurer.reset-size3.size6, .katex .sizing.reset-size3.size6 {
    font-size:1.42857143em
}

.katex .fontsize-ensurer.reset-size3.size7, .katex .sizing.reset-size3.size7 {
    font-size:1.71428571em
}

.katex .fontsize-ensurer.reset-size3.size8, .katex .sizing.reset-size3.size8 {
    font-size:2.05714286em
}

.katex .fontsize-ensurer.reset-size3.size9, .katex .sizing.reset-size3.size9 {
    font-size:2.46857143em
}

.katex .fontsize-ensurer.reset-size3.size10, .katex .sizing.reset-size3.size10 {
    font-size:2.96285714em
}

.katex .fontsize-ensurer.reset-size3.size11, .katex .sizing.reset-size3.size11 {
    font-size:3.55428571em
}

.katex .fontsize-ensurer.reset-size4.size1, .katex .sizing.reset-size4.size1 {
    font-size:.625em
}

.katex .fontsize-ensurer.reset-size4.size2, .katex .sizing.reset-size4.size2 {
    font-size:.75em
}

.katex .fontsize-ensurer.reset-size4.size3, .katex .sizing.reset-size4.size3 {
    font-size:.875em
}

.katex .fontsize-ensurer.reset-size4.size4, .katex .sizing.reset-size4.size4 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size4.size5, .katex .sizing.reset-size4.size5 {
    font-size:1.125em
}

.katex .fontsize-ensurer.reset-size4.size6, .katex .sizing.reset-size4.size6 {
    font-size:1.25em
}

.katex .fontsize-ensurer.reset-size4.size7, .katex .sizing.reset-size4.size7 {
    font-size:1.5em
}

.katex .fontsize-ensurer.reset-size4.size8, .katex .sizing.reset-size4.size8 {
    font-size:1.8em
}

.katex .fontsize-ensurer.reset-size4.size9, .katex .sizing.reset-size4.size9 {
    font-size:2.16em
}

.katex .fontsize-ensurer.reset-size4.size10, .katex .sizing.reset-size4.size10 {
    font-size:2.5925em
}

.katex .fontsize-ensurer.reset-size4.size11, .katex .sizing.reset-size4.size11 {
    font-size:3.11em
}

.katex .fontsize-ensurer.reset-size5.size1, .katex .sizing.reset-size5.size1 {
    font-size:.55555556em
}

.katex .fontsize-ensurer.reset-size5.size2, .katex .sizing.reset-size5.size2 {
    font-size:.66666667em
}

.katex .fontsize-ensurer.reset-size5.size3, .katex .sizing.reset-size5.size3 {
    font-size:.77777778em
}

.katex .fontsize-ensurer.reset-size5.size4, .katex .sizing.reset-size5.size4 {
    font-size:.88888889em
}

.katex .fontsize-ensurer.reset-size5.size5, .katex .sizing.reset-size5.size5 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size5.size6, .katex .sizing.reset-size5.size6 {
    font-size:1.11111111em
}

.katex .fontsize-ensurer.reset-size5.size7, .katex .sizing.reset-size5.size7 {
    font-size:1.33333333em
}

.katex .fontsize-ensurer.reset-size5.size8, .katex .sizing.reset-size5.size8 {
    font-size:1.6em
}

.katex .fontsize-ensurer.reset-size5.size9, .katex .sizing.reset-size5.size9 {
    font-size:1.92em
}

.katex .fontsize-ensurer.reset-size5.size10, .katex .sizing.reset-size5.size10 {
    font-size:2.30444444em
}

.katex .fontsize-ensurer.reset-size5.size11, .katex .sizing.reset-size5.size11 {
    font-size:2.76444444em
}

.katex .fontsize-ensurer.reset-size6.size1, .katex .sizing.reset-size6.size1 {
    font-size:.5em
}

.katex .fontsize-ensurer.reset-size6.size2, .katex .sizing.reset-size6.size2 {
    font-size:.6em
}

.katex .fontsize-ensurer.reset-size6.size3, .katex .sizing.reset-size6.size3 {
    font-size:.7em
}

.katex .fontsize-ensurer.reset-size6.size4, .katex .sizing.reset-size6.size4 {
    font-size:.8em
}

.katex .fontsize-ensurer.reset-size6.size5, .katex .sizing.reset-size6.size5 {
    font-size:.9em
}

.katex .fontsize-ensurer.reset-size6.size6, .katex .sizing.reset-size6.size6 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size6.size7, .katex .sizing.reset-size6.size7 {
    font-size:1.2em
}

.katex .fontsize-ensurer.reset-size6.size8, .katex .sizing.reset-size6.size8 {
    font-size:1.44em
}

.katex .fontsize-ensurer.reset-size6.size9, .katex .sizing.reset-size6.size9 {
    font-size:1.728em
}

.katex .fontsize-ensurer.reset-size6.size10, .katex .sizing.reset-size6.size10 {
    font-size:2.074em
}

.katex .fontsize-ensurer.reset-size6.size11, .katex .sizing.reset-size6.size11 {
    font-size:2.488em
}

.katex .fontsize-ensurer.reset-size7.size1, .katex .sizing.reset-size7.size1 {
    font-size:.41666667em
}

.katex .fontsize-ensurer.reset-size7.size2, .katex .sizing.reset-size7.size2 {
    font-size:.5em
}

.katex .fontsize-ensurer.reset-size7.size3, .katex .sizing.reset-size7.size3 {
    font-size:.58333333em
}

.katex .fontsize-ensurer.reset-size7.size4, .katex .sizing.reset-size7.size4 {
    font-size:.66666667em
}

.katex .fontsize-ensurer.reset-size7.size5, .katex .sizing.reset-size7.size5 {
    font-size:.75em
}

.katex .fontsize-ensurer.reset-size7.size6, .katex .sizing.reset-size7.size6 {
    font-size:.83333333em
}

.katex .fontsize-ensurer.reset-size7.size7, .katex .sizing.reset-size7.size7 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size7.size8, .katex .sizing.reset-size7.size8 {
    font-size:1.2em
}

.katex .fontsize-ensurer.reset-size7.size9, .katex .sizing.reset-size7.size9 {
    font-size:1.44em
}

.katex .fontsize-ensurer.reset-size7.size10, .katex .sizing.reset-size7.size10 {
    font-size:1.72833333em
}

.katex .fontsize-ensurer.reset-size7.size11, .katex .sizing.reset-size7.size11 {
    font-size:2.07333333em
}

.katex .fontsize-ensurer.reset-size8.size1, .katex .sizing.reset-size8.size1 {
    font-size:.34722222em
}

.katex .fontsize-ensurer.reset-size8.size2, .katex .sizing.reset-size8.size2 {
    font-size:.41666667em
}

.katex .fontsize-ensurer.reset-size8.size3, .katex .sizing.reset-size8.size3 {
    font-size:.48611111em
}

.katex .fontsize-ensurer.reset-size8.size4, .katex .sizing.reset-size8.size4 {
    font-size:.55555556em
}

.katex .fontsize-ensurer.reset-size8.size5, .katex .sizing.reset-size8.size5 {
    font-size:.625em
}

.katex .fontsize-ensurer.reset-size8.size6, .katex .sizing.reset-size8.size6 {
    font-size:.69444444em
}

.katex .fontsize-ensurer.reset-size8.size7, .katex .sizing.reset-size8.size7 {
    font-size:.83333333em
}

.katex .fontsize-ensurer.reset-size8.size8, .katex .sizing.reset-size8.size8 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size8.size9, .katex .sizing.reset-size8.size9 {
    font-size:1.2em
}

.katex .fontsize-ensurer.reset-size8.size10, .katex .sizing.reset-size8.size10 {
    font-size:1.44027778em
}

.katex .fontsize-ensurer.reset-size8.size11, .katex .sizing.reset-size8.size11 {
    font-size:1.72777778em
}

.katex .fontsize-ensurer.reset-size9.size1, .katex .sizing.reset-size9.size1 {
    font-size:.28935185em
}

.katex .fontsize-ensurer.reset-size9.size2, .katex .sizing.reset-size9.size2 {
    font-size:.34722222em
}

.katex .fontsize-ensurer.reset-size9.size3, .katex .sizing.reset-size9.size3 {
    font-size:.40509259em
}

.katex .fontsize-ensurer.reset-size9.size4, .katex .sizing.reset-size9.size4 {
    font-size:.46296296em
}

.katex .fontsize-ensurer.reset-size9.size5, .katex .sizing.reset-size9.size5 {
    font-size:.52083333em
}

.katex .fontsize-ensurer.reset-size9.size6, .katex .sizing.reset-size9.size6 {
    font-size:.5787037em
}

.katex .fontsize-ensurer.reset-size9.size7, .katex .sizing.reset-size9.size7 {
    font-size:.69444444em
}

.katex .fontsize-ensurer.reset-size9.size8, .katex .sizing.reset-size9.size8 {
    font-size:.83333333em
}

.katex .fontsize-ensurer.reset-size9.size9, .katex .sizing.reset-size9.size9 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size9.size10, .katex .sizing.reset-size9.size10 {
    font-size:1.20023148em
}

.katex .fontsize-ensurer.reset-size9.size11, .katex .sizing.reset-size9.size11 {
    font-size:1.43981481em
}

.katex .fontsize-ensurer.reset-size10.size1, .katex .sizing.reset-size10.size1 {
    font-size:.24108004em
}

.katex .fontsize-ensurer.reset-size10.size2, .katex .sizing.reset-size10.size2 {
    font-size:.28929605em
}

.katex .fontsize-ensurer.reset-size10.size3, .katex .sizing.reset-size10.size3 {
    font-size:.33751205em
}

.katex .fontsize-ensurer.reset-size10.size4, .katex .sizing.reset-size10.size4 {
    font-size:.38572806em
}

.katex .fontsize-ensurer.reset-size10.size5, .katex .sizing.reset-size10.size5 {
    font-size:.43394407em
}

.katex .fontsize-ensurer.reset-size10.size6, .katex .sizing.reset-size10.size6 {
    font-size:.48216008em
}

.katex .fontsize-ensurer.reset-size10.size7, .katex .sizing.reset-size10.size7 {
    font-size:.57859209em
}

.katex .fontsize-ensurer.reset-size10.size8, .katex .sizing.reset-size10.size8 {
    font-size:.69431051em
}

.katex .fontsize-ensurer.reset-size10.size9, .katex .sizing.reset-size10.size9 {
    font-size:.83317261em
}

.katex .fontsize-ensurer.reset-size10.size10, .katex .sizing.reset-size10.size10 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size10.size11, .katex .sizing.reset-size10.size11 {
    font-size:1.19961427em
}

.katex .fontsize-ensurer.reset-size11.size1, .katex .sizing.reset-size11.size1 {
    font-size:.20096463em
}

.katex .fontsize-ensurer.reset-size11.size2, .katex .sizing.reset-size11.size2 {
    font-size:.24115756em
}

.katex .fontsize-ensurer.reset-size11.size3, .katex .sizing.reset-size11.size3 {
    font-size:.28135048em
}

.katex .fontsize-ensurer.reset-size11.size4, .katex .sizing.reset-size11.size4 {
    font-size:.32154341em
}

.katex .fontsize-ensurer.reset-size11.size5, .katex .sizing.reset-size11.size5 {
    font-size:.36173633em
}

.katex .fontsize-ensurer.reset-size11.size6, .katex .sizing.reset-size11.size6 {
    font-size:.40192926em
}

.katex .fontsize-ensurer.reset-size11.size7, .katex .sizing.reset-size11.size7 {
    font-size:.48231511em
}

.katex .fontsize-ensurer.reset-size11.size8, .katex .sizing.reset-size11.size8 {
    font-size:.57877814em
}

.katex .fontsize-ensurer.reset-size11.size9, .katex .sizing.reset-size11.size9 {
    font-size:.69453376em
}

.katex .fontsize-ensurer.reset-size11.size10, .katex .sizing.reset-size11.size10 {
    font-size:.83360129em
}

.katex .fontsize-ensurer.reset-size11.size11, .katex .sizing.reset-size11.size11 {
    font-size:1em
}

.katex .delimsizing.size1 {
    font-family:KaTeX_Size1
}

.katex .delimsizing.size2 {
    font-family:KaTeX_Size2
}

.katex .delimsizing.size3 {
    font-family:KaTeX_Size3
}

.katex .delimsizing.size4 {
    font-family:KaTeX_Size4
}

.katex .delimsizing.mult .delim-size1 > span {
    font-family:KaTeX_Size1
}

.katex .delimsizing.mult .delim-size4 > span {
    font-family:KaTeX_Size4
}

.katex .nulldelimiter {
    display: inline-block;
    width:.12em
}

.katex .delimcenter, .katex .op-symbol {
    position:relative
}

.katex .op-symbol.small-op {
    font-family:KaTeX_Size1
}

.katex .op-symbol.large-op {
    font-family:KaTeX_Size2
}

.katex .accent > .vlist-t, .katex .op-limits > .vlist-t {
    text-align:center
}

.katex .accent .accent-body {
    position:relative
}

.katex .accent .accent-body:not(.accent-full) {
    width:0
}

.katex .overlay {
    display:block
}

.katex .mtable .vertical-separator {
    display: inline-block;
    min-width:1px
}

.katex .mtable .arraycolsep {
    display:inline-block
}

.katex .mtable .col-align-c > .vlist-t {
    text-align:center
}

.katex .mtable .col-align-l > .vlist-t {
    text-align:left
}

.katex .mtable .col-align-r > .vlist-t {
    text-align:right
}

.katex .svg-align {
    text-align:left
}

.katex svg {
    fill: currentColor;
    stroke: currentColor;
    fill-rule: nonzero;
    fill-opacity: 1;
    stroke-width: 1;
    stroke-linecap: butt;
    stroke-linejoin: miter;
    stroke-miterlimit: 4;
    stroke-dasharray: none;
    stroke-dashoffset: 0;
    stroke-opacity: 1;
    display: block;
    height: inherit;
    position: absolute;
    width:100%
}

.katex svg path {
    stroke:none
}

.katex img {
    border-style: none;
    max-height: none;
    max-width: none;
    min-height: 0;
    min-width:0
}

.katex .stretchy {
    display: block;
    overflow: hidden;
    position: relative;
    width:100%
}

.katex .stretchy:after, .katex .stretchy:before {
    content: ""
}

.katex .hide-tail {
    overflow: hidden;
    position: relative;
    width:100%
}

.katex .halfarrow-left {
    left: 0;
    overflow: hidden;
    position: absolute;
    width:50.2%
}

.katex .halfarrow-right {
    overflow: hidden;
    position: absolute;
    right: 0;
    width:50.2%
}

.katex .brace-left {
    left: 0;
    overflow: hidden;
    position: absolute;
    width:25.1%
}

.katex .brace-center {
    left: 25%;
    overflow: hidden;
    position: absolute;
    width:50%
}

.katex .brace-right {
    overflow: hidden;
    position: absolute;
    right: 0;
    width:25.1%
}

.katex .x-arrow-pad {
    padding:0 .5em
}

.katex .cd-arrow-pad {
    padding:0 .55556em 0 .27778em
}

.katex .mover, .katex .munder, .katex .x-arrow {
    text-align:center
}

.katex .boxpad {
    padding:0 .3em
}

.katex .fbox, .katex .fcolorbox {
    border: .04em solid;
    box-sizing:border-box
}

.katex .cancel-pad {
    padding:0 .2em
}

.katex .cancel-lap {
    margin-left: -.2em;
    margin-right:-.2em
}

.katex .sout {
    border-bottom-style: solid;
    border-bottom-width:.08em
}

.katex .angl {
    border-right: .049em solid;
    border-top: .049em solid;
    box-sizing: border-box;
    margin-right:.03889em
}

.katex .anglpad {
    padding:0 .03889em
}

.katex .eqn-num:before {
    content: "(" counter(katexEqnNo) ")";
    counter-increment:katexEqnNo
}

.katex .mml-eqn-num:before {
    content: "(" counter(mmlEqnNo) ")";
    counter-increment:mmlEqnNo
}

.katex .mtr-glue {
    width:50%
}

.katex .cd-vert-arrow {
    display: inline-block;
    position:relative
}

.katex .cd-label-left {
    display: inline-block;
    position: absolute;
    right: calc(50% + .3em);
    text-align:left
}

.katex .cd-label-right {
    display: inline-block;
    left: calc(50% + .3em);
    position: absolute;
    text-align:right
}

.katex-display {
    display: block;
    margin: 1em 0;
    text-align:center
}

.katex-display > .katex {
    display: block;
    text-align: center;
    white-space:nowrap
}

.katex-display > .katex > .katex-html {
    display: block;
    position:relative
}

.katex-display > .katex > .katex-html > .tag {
    position: absolute;
    right:0
}

.katex-display.leqno > .katex > .katex-html > .tag {
    left: 0;
    right:auto
}

.katex-display.fleqn > .katex {
    padding-left: 2em;
    text-align:left
}


@font-face {
    font-family: KaTeX_AMS;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"), url(fonts/KaTeX_AMS-Regular.woff) format("woff"), url(fonts/KaTeX_AMS-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Caligraphic;
    font-style: normal;
    font-weight: 700;
    src: url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"), url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"), url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Caligraphic;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"), url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"), url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Fraktur;
    font-style: normal;
    font-weight: 700;
    src: url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"), url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"), url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Fraktur;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"), url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"), url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Main;
    font-style: normal;
    font-weight: 700;
    src: url(fonts/KaTeX_Main-Bold.woff2) format("woff2"), url(fonts/KaTeX_Main-Bold.woff) format("woff"), url(fonts/KaTeX_Main-Bold.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Main;
    font-style: italic;
    font-weight: 700;
    src: url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"), url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"), url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Main;
    font-style: italic;
    font-weight: 400;
    src: url(fonts/KaTeX_Main-Italic.woff2) format("woff2"), url(fonts/KaTeX_Main-Italic.woff) format("woff"), url(fonts/KaTeX_Main-Italic.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Main;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Main-Regular.woff2) format("woff2"), url(fonts/KaTeX_Main-Regular.woff) format("woff"), url(fonts/KaTeX_Main-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Math;
    font-style: italic;
    font-weight: 700;
    src: url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"), url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"), url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Math;
    font-style: italic;
    font-weight: 400;
    src: url(fonts/KaTeX_Math-Italic.woff2) format("woff2"), url(fonts/KaTeX_Math-Italic.woff) format("woff"), url(fonts/KaTeX_Math-Italic.ttf) format("truetype")
}

@font-face {
    font-family: "KaTeX_SansSerif";
    font-style: normal;
    font-weight: 700;
    src: url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"), url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"), url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype")
}

@font-face {
    font-family: "KaTeX_SansSerif";
    font-style: italic;
    font-weight: 400;
    src: url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"), url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"), url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype")
}

@font-face {
    font-family: "KaTeX_SansSerif";
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"), url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"), url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Script;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Script-Regular.woff2) format("woff2"), url(fonts/KaTeX_Script-Regular.woff) format("woff"), url(fonts/KaTeX_Script-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Size1;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"), url(fonts/KaTeX_Size1-Regular.woff) format("woff"), url(fonts/KaTeX_Size1-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Size2;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"), url(fonts/KaTeX_Size2-Regular.woff) format("woff"), url(fonts/KaTeX_Size2-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Size3;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"), url(fonts/KaTeX_Size3-Regular.woff) format("woff"), url(fonts/KaTeX_Size3-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Size4;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"), url(fonts/KaTeX_Size4-Regular.woff) format("woff"), url(fonts/KaTeX_Size4-Regular.ttf) format("truetype")
}

@font-face {
    font-family: KaTeX_Typewriter;
    font-style: normal;
    font-weight: 400;
    src: url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"), url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"), url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype")
}

.katex {
    text-rendering: auto;
    font: normal 1.21em KaTeX_Main, Times New Roman, serif;
    line-height: 1.2;
    text-indent:0
}

.katex * {
    -ms-high-contrast-adjust: none !important;
    border-color:currentColor
}

.katex .katex-version:after {
    content: "0.16.2"
}

.katex .katex-mathml {
    clip: rect(1px, 1px, 1px, 1px);
    border: 0;
    height: 1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width:1px
}

.katex .katex-html > .newline {
    display:block
}

.katex .base {
    position: relative;
    white-space: nowrap;
    width: -webkit-min-content;
    width: -moz-min-content;
    width:min-content
}

.katex .base, .katex .strut {
    display:inline-block
}

.katex .textbf {
    font-weight:700
}

.katex .textit {
    font-style:italic
}

.katex .textrm {
    font-family:KaTeX_Main
}

.katex .textsf {
    font-family:KaTeX_SansSerif
}

.katex .texttt {
    font-family:KaTeX_Typewriter
}

.katex .mathnormal {
    font-family: KaTeX_Math;
    font-style:italic
}

.katex .mathit {
    font-family: KaTeX_Main;
    font-style:italic
}

.katex .mathrm {
    font-style:normal
}

.katex .mathbf {
    font-family: KaTeX_Main;
    font-weight:700
}

.katex .boldsymbol {
    font-family: KaTeX_Math;
    font-style: italic;
    font-weight:700
}

.katex .amsrm, .katex .mathbb, .katex .textbb {
    font-family:KaTeX_AMS
}

.katex .mathcal {
    font-family:KaTeX_Caligraphic
}

.katex .mathfrak, .katex .textfrak {
    font-family:KaTeX_Fraktur
}

.katex .mathtt {
    font-family:KaTeX_Typewriter
}

.katex .mathscr, .katex .textscr {
    font-family:KaTeX_Script
}

.katex .mathsf, .katex .textsf {
    font-family:KaTeX_SansSerif
}

.katex .mathboldsf, .katex .textboldsf {
    font-family: KaTeX_SansSerif;
    font-weight:700
}

.katex .mathitsf, .katex .textitsf {
    font-family: KaTeX_SansSerif;
    font-style:italic
}

.katex .mainrm {
    font-family: KaTeX_Main;
    font-style:normal
}

.katex .vlist-t {
    border-collapse: collapse;
    display: inline-table;
    table-layout:fixed
}

.katex .vlist-r {
    display:table-row
}

.katex .vlist {
    display: table-cell;
    position: relative;
    vertical-align:bottom
}

.katex .vlist > span {
    display: block;
    height: 0;
    position:relative
}

.katex .vlist > span > span {
    display:inline-block
}

.katex .vlist > span > .pstrut {
    overflow: hidden;
    width:0
}

.katex .vlist-t2 {
    margin-right:-2px
}

.katex .vlist-s {
    display: table-cell;
    font-size: 1px;
    min-width: 2px;
    vertical-align: bottom;
    width:2px
}

.katex .vbox {
    align-items: baseline;
    display: inline-flex;
    flex-direction:column
}

.katex .hbox {
    width:100%
}

.katex .hbox, .katex .thinbox {
    display: inline-flex;
    flex-direction:row
}

.katex .thinbox {
    max-width: 0;
    width:0
}

.katex .msupsub {
    text-align:left
}

.katex .mfrac > span > span {
    text-align:center
}

.katex .mfrac .frac-line {
    border-bottom-style: solid;
    display: inline-block;
    width:100%
}

.katex .hdashline, .katex .hline, .katex .mfrac .frac-line, .katex .overline .overline-line, .katex .rule, .katex .underline .underline-line {
    min-height:1px
}

.katex .mspace {
    display:inline-block
}

.katex .clap, .katex .llap, .katex .rlap {
    position: relative;
    width:0
}

.katex .clap > .inner, .katex .llap > .inner, .katex .rlap > .inner {
    position:absolute
}

.katex .clap > .fix, .katex .llap > .fix, .katex .rlap > .fix {
    display:inline-block
}

.katex .llap > .inner {
    right:0
}

.katex .clap > .inner, .katex .rlap > .inner {
    left:0
}

.katex .clap > .inner > span {
    margin-left: -50%;
    margin-right:50%
}

.katex .rule {
    border: 0 solid;
    display: inline-block;
    position:relative
}

.katex .hline, .katex .overline .overline-line, .katex .underline .underline-line {
    border-bottom-style: solid;
    display: inline-block;
    width:100%
}

.katex .hdashline {
    border-bottom-style: dashed;
    display: inline-block;
    width:100%
}

.katex .sqrt > .root {
    margin-left: .27777778em;
    margin-right:-.55555556em
}

.katex .fontsize-ensurer.reset-size1.size1, .katex .sizing.reset-size1.size1 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size1.size2, .katex .sizing.reset-size1.size2 {
    font-size:1.2em
}

.katex .fontsize-ensurer.reset-size1.size3, .katex .sizing.reset-size1.size3 {
    font-size:1.4em
}

.katex .fontsize-ensurer.reset-size1.size4, .katex .sizing.reset-size1.size4 {
    font-size:1.6em
}

.katex .fontsize-ensurer.reset-size1.size5, .katex .sizing.reset-size1.size5 {
    font-size:1.8em
}

.katex .fontsize-ensurer.reset-size1.size6, .katex .sizing.reset-size1.size6 {
    font-size:2em
}

.katex .fontsize-ensurer.reset-size1.size7, .katex .sizing.reset-size1.size7 {
    font-size:2.4em
}

.katex .fontsize-ensurer.reset-size1.size8, .katex .sizing.reset-size1.size8 {
    font-size:2.88em
}

.katex .fontsize-ensurer.reset-size1.size9, .katex .sizing.reset-size1.size9 {
    font-size:3.456em
}

.katex .fontsize-ensurer.reset-size1.size10, .katex .sizing.reset-size1.size10 {
    font-size:4.148em
}

.katex .fontsize-ensurer.reset-size1.size11, .katex .sizing.reset-size1.size11 {
    font-size:4.976em
}

.katex .fontsize-ensurer.reset-size2.size1, .katex .sizing.reset-size2.size1 {
    font-size:.83333333em
}

.katex .fontsize-ensurer.reset-size2.size2, .katex .sizing.reset-size2.size2 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size2.size3, .katex .sizing.reset-size2.size3 {
    font-size:1.16666667em
}

.katex .fontsize-ensurer.reset-size2.size4, .katex .sizing.reset-size2.size4 {
    font-size:1.33333333em
}

.katex .fontsize-ensurer.reset-size2.size5, .katex .sizing.reset-size2.size5 {
    font-size:1.5em
}

.katex .fontsize-ensurer.reset-size2.size6, .katex .sizing.reset-size2.size6 {
    font-size:1.66666667em
}

.katex .fontsize-ensurer.reset-size2.size7, .katex .sizing.reset-size2.size7 {
    font-size:2em
}

.katex .fontsize-ensurer.reset-size2.size8, .katex .sizing.reset-size2.size8 {
    font-size:2.4em
}

.katex .fontsize-ensurer.reset-size2.size9, .katex .sizing.reset-size2.size9 {
    font-size:2.88em
}

.katex .fontsize-ensurer.reset-size2.size10, .katex .sizing.reset-size2.size10 {
    font-size:3.45666667em
}

.katex .fontsize-ensurer.reset-size2.size11, .katex .sizing.reset-size2.size11 {
    font-size:4.14666667em
}

.katex .fontsize-ensurer.reset-size3.size1, .katex .sizing.reset-size3.size1 {
    font-size:.71428571em
}

.katex .fontsize-ensurer.reset-size3.size2, .katex .sizing.reset-size3.size2 {
    font-size:.85714286em
}

.katex .fontsize-ensurer.reset-size3.size3, .katex .sizing.reset-size3.size3 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size3.size4, .katex .sizing.reset-size3.size4 {
    font-size:1.14285714em
}

.katex .fontsize-ensurer.reset-size3.size5, .katex .sizing.reset-size3.size5 {
    font-size:1.28571429em
}

.katex .fontsize-ensurer.reset-size3.size6, .katex .sizing.reset-size3.size6 {
    font-size:1.42857143em
}

.katex .fontsize-ensurer.reset-size3.size7, .katex .sizing.reset-size3.size7 {
    font-size:1.71428571em
}

.katex .fontsize-ensurer.reset-size3.size8, .katex .sizing.reset-size3.size8 {
    font-size:2.05714286em
}

.katex .fontsize-ensurer.reset-size3.size9, .katex .sizing.reset-size3.size9 {
    font-size:2.46857143em
}

.katex .fontsize-ensurer.reset-size3.size10, .katex .sizing.reset-size3.size10 {
    font-size:2.96285714em
}

.katex .fontsize-ensurer.reset-size3.size11, .katex .sizing.reset-size3.size11 {
    font-size:3.55428571em
}

.katex .fontsize-ensurer.reset-size4.size1, .katex .sizing.reset-size4.size1 {
    font-size:.625em
}

.katex .fontsize-ensurer.reset-size4.size2, .katex .sizing.reset-size4.size2 {
    font-size:.75em
}

.katex .fontsize-ensurer.reset-size4.size3, .katex .sizing.reset-size4.size3 {
    font-size:.875em
}

.katex .fontsize-ensurer.reset-size4.size4, .katex .sizing.reset-size4.size4 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size4.size5, .katex .sizing.reset-size4.size5 {
    font-size:1.125em
}

.katex .fontsize-ensurer.reset-size4.size6, .katex .sizing.reset-size4.size6 {
    font-size:1.25em
}

.katex .fontsize-ensurer.reset-size4.size7, .katex .sizing.reset-size4.size7 {
    font-size:1.5em
}

.katex .fontsize-ensurer.reset-size4.size8, .katex .sizing.reset-size4.size8 {
    font-size:1.8em
}

.katex .fontsize-ensurer.reset-size4.size9, .katex .sizing.reset-size4.size9 {
    font-size:2.16em
}

.katex .fontsize-ensurer.reset-size4.size10, .katex .sizing.reset-size4.size10 {
    font-size:2.5925em
}

.katex .fontsize-ensurer.reset-size4.size11, .katex .sizing.reset-size4.size11 {
    font-size:3.11em
}

.katex .fontsize-ensurer.reset-size5.size1, .katex .sizing.reset-size5.size1 {
    font-size:.55555556em
}

.katex .fontsize-ensurer.reset-size5.size2, .katex .sizing.reset-size5.size2 {
    font-size:.66666667em
}

.katex .fontsize-ensurer.reset-size5.size3, .katex .sizing.reset-size5.size3 {
    font-size:.77777778em
}

.katex .fontsize-ensurer.reset-size5.size4, .katex .sizing.reset-size5.size4 {
    font-size:.88888889em
}

.katex .fontsize-ensurer.reset-size5.size5, .katex .sizing.reset-size5.size5 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size5.size6, .katex .sizing.reset-size5.size6 {
    font-size:1.11111111em
}

.katex .fontsize-ensurer.reset-size5.size7, .katex .sizing.reset-size5.size7 {
    font-size:1.33333333em
}

.katex .fontsize-ensurer.reset-size5.size8, .katex .sizing.reset-size5.size8 {
    font-size:1.6em
}

.katex .fontsize-ensurer.reset-size5.size9, .katex .sizing.reset-size5.size9 {
    font-size:1.92em
}

.katex .fontsize-ensurer.reset-size5.size10, .katex .sizing.reset-size5.size10 {
    font-size:2.30444444em
}

.katex .fontsize-ensurer.reset-size5.size11, .katex .sizing.reset-size5.size11 {
    font-size:2.76444444em
}

.katex .fontsize-ensurer.reset-size6.size1, .katex .sizing.reset-size6.size1 {
    font-size:.5em
}

.katex .fontsize-ensurer.reset-size6.size2, .katex .sizing.reset-size6.size2 {
    font-size:.6em
}

.katex .fontsize-ensurer.reset-size6.size3, .katex .sizing.reset-size6.size3 {
    font-size:.7em
}

.katex .fontsize-ensurer.reset-size6.size4, .katex .sizing.reset-size6.size4 {
    font-size:.8em
}

.katex .fontsize-ensurer.reset-size6.size5, .katex .sizing.reset-size6.size5 {
    font-size:.9em
}

.katex .fontsize-ensurer.reset-size6.size6, .katex .sizing.reset-size6.size6 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size6.size7, .katex .sizing.reset-size6.size7 {
    font-size:1.2em
}

.katex .fontsize-ensurer.reset-size6.size8, .katex .sizing.reset-size6.size8 {
    font-size:1.44em
}

.katex .fontsize-ensurer.reset-size6.size9, .katex .sizing.reset-size6.size9 {
    font-size:1.728em
}

.katex .fontsize-ensurer.reset-size6.size10, .katex .sizing.reset-size6.size10 {
    font-size:2.074em
}

.katex .fontsize-ensurer.reset-size6.size11, .katex .sizing.reset-size6.size11 {
    font-size:2.488em
}

.katex .fontsize-ensurer.reset-size7.size1, .katex .sizing.reset-size7.size1 {
    font-size:.41666667em
}

.katex .fontsize-ensurer.reset-size7.size2, .katex .sizing.reset-size7.size2 {
    font-size:.5em
}

.katex .fontsize-ensurer.reset-size7.size3, .katex .sizing.reset-size7.size3 {
    font-size:.58333333em
}

.katex .fontsize-ensurer.reset-size7.size4, .katex .sizing.reset-size7.size4 {
    font-size:.66666667em
}

.katex .fontsize-ensurer.reset-size7.size5, .katex .sizing.reset-size7.size5 {
    font-size:.75em
}

.katex .fontsize-ensurer.reset-size7.size6, .katex .sizing.reset-size7.size6 {
    font-size:.83333333em
}

.katex .fontsize-ensurer.reset-size7.size7, .katex .sizing.reset-size7.size7 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size7.size8, .katex .sizing.reset-size7.size8 {
    font-size:1.2em
}

.katex .fontsize-ensurer.reset-size7.size9, .katex .sizing.reset-size7.size9 {
    font-size:1.44em
}

.katex .fontsize-ensurer.reset-size7.size10, .katex .sizing.reset-size7.size10 {
    font-size:1.72833333em
}

.katex .fontsize-ensurer.reset-size7.size11, .katex .sizing.reset-size7.size11 {
    font-size:2.07333333em
}

.katex .fontsize-ensurer.reset-size8.size1, .katex .sizing.reset-size8.size1 {
    font-size:.34722222em
}

.katex .fontsize-ensurer.reset-size8.size2, .katex .sizing.reset-size8.size2 {
    font-size:.41666667em
}

.katex .fontsize-ensurer.reset-size8.size3, .katex .sizing.reset-size8.size3 {
    font-size:.48611111em
}

.katex .fontsize-ensurer.reset-size8.size4, .katex .sizing.reset-size8.size4 {
    font-size:.55555556em
}

.katex .fontsize-ensurer.reset-size8.size5, .katex .sizing.reset-size8.size5 {
    font-size:.625em
}

.katex .fontsize-ensurer.reset-size8.size6, .katex .sizing.reset-size8.size6 {
    font-size:.69444444em
}

.katex .fontsize-ensurer.reset-size8.size7, .katex .sizing.reset-size8.size7 {
    font-size:.83333333em
}

.katex .fontsize-ensurer.reset-size8.size8, .katex .sizing.reset-size8.size8 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size8.size9, .katex .sizing.reset-size8.size9 {
    font-size:1.2em
}

.katex .fontsize-ensurer.reset-size8.size10, .katex .sizing.reset-size8.size10 {
    font-size:1.44027778em
}

.katex .fontsize-ensurer.reset-size8.size11, .katex .sizing.reset-size8.size11 {
    font-size:1.72777778em
}

.katex .fontsize-ensurer.reset-size9.size1, .katex .sizing.reset-size9.size1 {
    font-size:.28935185em
}

.katex .fontsize-ensurer.reset-size9.size2, .katex .sizing.reset-size9.size2 {
    font-size:.34722222em
}

.katex .fontsize-ensurer.reset-size9.size3, .katex .sizing.reset-size9.size3 {
    font-size:.40509259em
}

.katex .fontsize-ensurer.reset-size9.size4, .katex .sizing.reset-size9.size4 {
    font-size:.46296296em
}

.katex .fontsize-ensurer.reset-size9.size5, .katex .sizing.reset-size9.size5 {
    font-size:.52083333em
}

.katex .fontsize-ensurer.reset-size9.size6, .katex .sizing.reset-size9.size6 {
    font-size:.5787037em
}

.katex .fontsize-ensurer.reset-size9.size7, .katex .sizing.reset-size9.size7 {
    font-size:.69444444em
}

.katex .fontsize-ensurer.reset-size9.size8, .katex .sizing.reset-size9.size8 {
    font-size:.83333333em
}

.katex .fontsize-ensurer.reset-size9.size9, .katex .sizing.reset-size9.size9 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size9.size10, .katex .sizing.reset-size9.size10 {
    font-size:1.20023148em
}

.katex .fontsize-ensurer.reset-size9.size11, .katex .sizing.reset-size9.size11 {
    font-size:1.43981481em
}

.katex .fontsize-ensurer.reset-size10.size1, .katex .sizing.reset-size10.size1 {
    font-size:.24108004em
}

.katex .fontsize-ensurer.reset-size10.size2, .katex .sizing.reset-size10.size2 {
    font-size:.28929605em
}

.katex .fontsize-ensurer.reset-size10.size3, .katex .sizing.reset-size10.size3 {
    font-size:.33751205em
}

.katex .fontsize-ensurer.reset-size10.size4, .katex .sizing.reset-size10.size4 {
    font-size:.38572806em
}

.katex .fontsize-ensurer.reset-size10.size5, .katex .sizing.reset-size10.size5 {
    font-size:.43394407em
}

.katex .fontsize-ensurer.reset-size10.size6, .katex .sizing.reset-size10.size6 {
    font-size:.48216008em
}

.katex .fontsize-ensurer.reset-size10.size7, .katex .sizing.reset-size10.size7 {
    font-size:.57859209em
}

.katex .fontsize-ensurer.reset-size10.size8, .katex .sizing.reset-size10.size8 {
    font-size:.69431051em
}

.katex .fontsize-ensurer.reset-size10.size9, .katex .sizing.reset-size10.size9 {
    font-size:.83317261em
}

.katex .fontsize-ensurer.reset-size10.size10, .katex .sizing.reset-size10.size10 {
    font-size:1em
}

.katex .fontsize-ensurer.reset-size10.size11, .katex .sizing.reset-size10.size11 {
    font-size:1.19961427em
}

.katex .fontsize-ensurer.reset-size11.size1, .katex .sizing.reset-size11.size1 {
    font-size:.20096463em
}

.katex .fontsize-ensurer.reset-size11.size2, .katex .sizing.reset-size11.size2 {
    font-size:.24115756em
}

.katex .fontsize-ensurer.reset-size11.size3, .katex .sizing.reset-size11.size3 {
    font-size:.28135048em
}

.katex .fontsize-ensurer.reset-size11.size4, .katex .sizing.reset-size11.size4 {
    font-size:.32154341em
}

.katex .fontsize-ensurer.reset-size11.size5, .katex .sizing.reset-size11.size5 {
    font-size:.36173633em
}

.katex .fontsize-ensurer.reset-size11.size6, .katex .sizing.reset-size11.size6 {
    font-size:.40192926em
}

.katex .fontsize-ensurer.reset-size11.size7, .katex .sizing.reset-size11.size7 {
    font-size:.48231511em
}

.katex .fontsize-ensurer.reset-size11.size8, .katex .sizing.reset-size11.size8 {
    font-size:.57877814em
}

.katex .fontsize-ensurer.reset-size11.size9, .katex .sizing.reset-size11.size9 {
    font-size:.69453376em
}

.katex .fontsize-ensurer.reset-size11.size10, .katex .sizing.reset-size11.size10 {
    font-size:.83360129em
}

.katex .fontsize-ensurer.reset-size11.size11, .katex .sizing.reset-size11.size11 {
    font-size:1em
}

.katex .delimsizing.size1 {
    font-family:KaTeX_Size1
}

.katex .delimsizing.size2 {
    font-family:KaTeX_Size2
}

.katex .delimsizing.size3 {
    font-family:KaTeX_Size3
}

.katex .delimsizing.size4 {
    font-family:KaTeX_Size4
}

.katex .delimsizing.mult .delim-size1 > span {
    font-family:KaTeX_Size1
}

.katex .delimsizing.mult .delim-size4 > span {
    font-family:KaTeX_Size4
}

.katex .nulldelimiter {
    display: inline-block;
    width:.12em
}

.katex .delimcenter, .katex .op-symbol {
    position:relative
}

.katex .op-symbol.small-op {
    font-family:KaTeX_Size1
}

.katex .op-symbol.large-op {
    font-family:KaTeX_Size2
}

.katex .accent > .vlist-t, .katex .op-limits > .vlist-t {
    text-align:center
}

.katex .accent .accent-body {
    position:relative
}

.katex .accent .accent-body:not(.accent-full) {
    width:0
}

.katex .overlay {
    display:block
}

.katex .mtable .vertical-separator {
    display: inline-block;
    min-width:1px
}

.katex .mtable .arraycolsep {
    display:inline-block
}

.katex .mtable .col-align-c > .vlist-t {
    text-align:center
}

.katex .mtable .col-align-l > .vlist-t {
    text-align:left
}

.katex .mtable .col-align-r > .vlist-t {
    text-align:right
}

.katex .svg-align {
    text-align:left
}

.katex svg {
    fill: currentColor;
    stroke: currentColor;
    fill-rule: nonzero;
    fill-opacity: 1;
    stroke-width: 1;
    stroke-linecap: butt;
    stroke-linejoin: miter;
    stroke-miterlimit: 4;
    stroke-dasharray: none;
    stroke-dashoffset: 0;
    stroke-opacity: 1;
    display: block;
    height: inherit;
    position: absolute;
    width:100%
}

.katex svg path {
    stroke:none
}

.katex img {
    border-style: none;
    max-height: none;
    max-width: none;
    min-height: 0;
    min-width:0
}

.katex .stretchy {
    display: block;
    overflow: hidden;
    position: relative;
    width:100%
}

.katex .stretchy:after, .katex .stretchy:before {
    content: ""
}

.katex .hide-tail {
    overflow: hidden;
    position: relative;
    width:100%
}

.katex .halfarrow-left {
    left: 0;
    overflow: hidden;
    position: absolute;
    width:50.2%
}

.katex .halfarrow-right {
    overflow: hidden;
    position: absolute;
    right: 0;
    width:50.2%
}

.katex .brace-left {
    left: 0;
    overflow: hidden;
    position: absolute;
    width:25.1%
}

.katex .brace-center {
    left: 25%;
    overflow: hidden;
    position: absolute;
    width:50%
}

.katex .brace-right {
    overflow: hidden;
    position: absolute;
    right: 0;
    width:25.1%
}

.katex .x-arrow-pad {
    padding:0 .5em
}

.katex .cd-arrow-pad {
    padding:0 .55556em 0 .27778em
}

.katex .mover, .katex .munder, .katex .x-arrow {
    text-align:center
}

.katex .boxpad {
    padding:0 .3em
}

.katex .fbox, .katex .fcolorbox {
    border: .04em solid;
    box-sizing:border-box
}

.katex .cancel-pad {
    padding:0 .2em
}

.katex .cancel-lap {
    margin-left: -.2em;
    margin-right:-.2em
}

.katex .sout {
    border-bottom-style: solid;
    border-bottom-width:.08em
}

.katex .angl {
    border-right: .049em solid;
    border-top: .049em solid;
    box-sizing: border-box;
    margin-right:.03889em
}

.katex .anglpad {
    padding:0 .03889em
}

.katex .eqn-num:before {
    content: "(" counter(katexEqnNo) ")";
    counter-increment:katexEqnNo
}

.katex .mml-eqn-num:before {
    content: "(" counter(mmlEqnNo) ")";
    counter-increment:mmlEqnNo
}

.katex .mtr-glue {
    width:50%
}

.katex .cd-vert-arrow {
    display: inline-block;
    position:relative
}

.katex .cd-label-left {
    display: inline-block;
    position: absolute;
    right: calc(50% + .3em);
    text-align:left
}

.katex .cd-label-right {
    display: inline-block;
    left: calc(50% + .3em);
    position: absolute;
    text-align:right
}

.katex-display {
    display: block;
    margin: 1em 0;
    text-align:center
}

.katex-display > .katex {
    display: block;
    text-align: center;
    white-space:nowrap
}

.katex-display > .katex > .katex-html {
    display: block;
    position:relative
}

.katex-display > .katex > .katex-html > .tag {
    position: absolute;
    right:0
}

.katex-display.leqno > .katex > .katex-html > .tag {
    left: 0;
    right:auto
}

.katex-display.fleqn > .katex {
    padding-left: 2em;
    text-align:left
}

.markdown {
    font-size: medium;
    padding-left: 0.1rem;
}

.markdown h4 {
    font-weight: 500;
}

.markdown h3 {
    font-weight: 500;
    font-size:large;
}

.markdown h2 {
    font-weight: 500;
    font-size:x-large;
    padding-bottom: 0.25rem;
}

.markdown h1 {
    font-weight: 500;
    font-size: xx-large;
    padding-bottom: 0.5rem;
}

.markdown blockquote {
    background-color: rgb(249 250 251 / 70%);
    border-inline-start-width: 4px;
    padding: 0.5rem;
    padding-top: 0.2rem;
    border-color: rgb(209 213 219);
    margin-bottom: 0.5rem;
    margin-top: 0.5rem;
}

.markdown ul {
    list-style-type: disc !important;
    padding-left: 1rem;
    padding-bottom: 0.5rem;
}

.markdown ol {
    padding-left: 1rem;
    list-style-type: auto;
    padding-bottom: 0.5rem;
}

.markdown a {
    text-decoration:underline;
    color: blue;
}

.markdown p {
    /* margin-top: 0.5rem; */
    margin-top: 0.5rem;
    /* margin-bottom: 0.5rem; */
}

.markdown-feobject {
    text-align: left;
    /* justify-content: center; */
    padding: 1rem;
    margin-left: auto;
    margin-right: auto;
    display:inline-block;
    /* text-align: center; */
    justify-content: center;
    /* width: 100%; */
    display: flex;
}

.excalidraw li {
    list-style: none;
}

.excalidraw .dropdown-menu-button.main-menu-trigger {
    display: none;
}

.excalidraw .mobile-misc-tools-container {
    display: none !important;
}

.admonition {
    color: rgb(56, 56, 56);
    background-color: rgb(238, 249, 253);
    border-bottom-color: rgb(76, 179, 212);
    border-bottom-style: solid;
    border-bottom-width: 0px;
    border-image-outset: 0;
    border-left-color: rgb(76, 179, 212);
    border-left-style: solid;
    border-left-width: 5px;
    border-right-color: rgb(76, 179, 212);
    border-right-style: solid;
    border-right-width: 0px;
    border-top-color: rgb(76, 179, 212);
    border-top-style: solid;
    border-top-width: 0px;
    /* box-shadow: rgba(0, 0, 0, 0.1) 0px 1px 2px; */
    padding: 0.5rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
    /* border-radius: 4px; */    
}

.admonition.warning {
    background-color: rgb(255 251 240);
    border-bottom-color: rgb(230, 167, 0);
    border-left-color: rgb(230, 167, 0);
    border-right-color: rgb(230, 167, 0);
    border-top-color: rgb(230, 167, 0);
}

.admonition.todo {
    background-color: rgb(255 251 240);
    border-left-style: dashed;
    border-bottom-color: rgb(230, 167, 0);
    border-left-color: rgb(230, 167, 0);
    border-right-color: rgb(230, 167, 0);
    border-top-color: rgb(230, 167, 0);
}

.admonition.tip {
    background-color: rgb(232, 255, 232);
    border-bottom-color: rgb(0, 148, 0);
    border-left-color: rgb(0, 148, 0);
    border-right-color: rgb(0, 148, 0);
    border-top-color: rgb(0, 148, 0);
}

.admonition.danger {
  background-color: rgb(255, 235, 236);
  border-bottom-color: rgb(225, 50, 56);
  border-left-color: rgb(225, 50, 56);
  border-right-color: rgb(225, 50, 56);
  border-top-color: rgb(225, 50, 56);
}</style>
<style >.d3-controls {
    position: absolute;
    right: -1rem;
    padding: 0;
    opacity: 0.7;
    opacity: 0;
    cursor: pointer;
}

.frontend-view:hover .d3-controls {
    opacity: 0.6;
}

.graphics2d-controller {
    position:absolute;
    right:0;
    opacity:0;
}

.graphics2d-controller:hover {
    opacity:1;
}</style>
<style >.cell-type-wlx {
  background-color: rgb(45 255 227 / 79%);
  color: #0000009c;
}
</style>
<style >/*!
 * Copyright (c) HANDSONCODE sp. z o. o.
 *
 * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o., a Polish corporation based in
 * Gdynia, Poland, at Aleja Zwyciestwa 96-98, registered by the District Court in Gdansk under number
 * 538651, EU tax ID number: PL5862294002, share capital: PLN 62,800.00.
 *
 * This software is protected by applicable copyright laws, including international treaties, and dual-
 * licensed - depending on whether your use for commercial purposes, meaning intended for or
 * resulting in commercial advantage or monetary compensation, or not.
 *
 * If your use is strictly personal or solely for evaluation purposes, meaning for the purposes of testing
 * the suitability, performance, and usefulness of this software outside the production environment,
 * you agree to be bound by the terms included in the "handsontable-non-commercial-license.pdf" file.
 *
 * Your use of this software for commercial purposes is subject to the terms included in an applicable
 * license agreement.
 *
 * In any case, you must not make any such use of this software as to develop software which may be
 * considered competitive with this software.
 *
 * UNLESS EXPRESSLY AGREED OTHERWISE, HANDSONCODE PROVIDES THIS SOFTWARE ON AN "AS IS"
 * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, AND IN NO EVENT AND UNDER NO
 * LEGAL THEORY, SHALL HANDSONCODE BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY DIRECT,
 * INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING FROM
 * USE OR INABILITY TO USE THIS SOFTWARE.
 *
 * Version: 13.1.0
 * Release date: 31/08/2023 (built at 31/08/2023 08:24:01)
 */
 .handsontable .table td,.handsontable .table th {
    border-top: none
}

.handsontable tr {
    /* background:#fff; */
}

.handsontable td {
    background-color: inherit
}

.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th {
    border-top: 1px solid #ccc
}

.handsontable .table-bordered {
    border: 0;
    border-collapse: separate
}

.handsontable .table-bordered td,.handsontable .table-bordered th {
    border-left: none
}

.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child {
    border-left: 1px solid #ccc
}

.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th {
    line-height: 21px;
    padding: 0
}

.col-lg-1.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-md-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable {
    padding-left: 0;
    padding-right: 0
}

.handsontable .table-striped>tbody>tr:nth-of-type(2n) {
    background-color: #fff
}

.handsontable {
    position: relative
}

.handsontable .hide {
    display: none
}

.handsontable .relative {
    position: relative
}

.handsontable .wtHider {
    width: 0
}

.handsontable .wtSpreader {
    height: auto;
    position: relative;
    width: 0;
    /* border-radius: 7rem !important; */
}

.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead {
    box-sizing: content-box;
    -webkit-box-sizing: content-box;
    -moz-box-sizing: content-box
}

.handsontable input,.handsontable textarea {
    min-height: auto
}

.handsontable table.htCore {
    border-collapse: separate;
    border-spacing: 0;
    border-width: 0;
    cursor: default;
    margin: 0;
    max-height: none;
    max-width: none;
    outline-width: 0;
    table-layout: fixed;
    /* border-radius: 3rem; */
    width: 0;
    font-size: smaller;
    font-family: system-ui;
}

.handsontable col,.handsontable col.rowHeader {
    width: 50px;
    border-radius: 0.3rem;
}

.handsontable td,.handsontable th {
    /* background-color:#fff; */
    border-bottom: 1px solid #ccc;
    border-left-width: 0;
    border-right: 1px solid #ccc;
    border-top-width: 0;
    empty-cells: show;
    height: 22px;
    line-height: 21px;
    outline-width: 0;
    overflow: hidden;
    padding: 0 4px;
    vertical-align: top;
    white-space: pre-wrap
}

[dir=rtl].handsontable td,[dir=rtl].handsontable th {
    border-left: 1px solid #ccc;
    border-right-width: 0
}

.handsontable th:last-child {
    border-bottom: 1px solid #ccc;
    border-left: none;
    border-right: 1px solid #ccc
}

[dir=rtl].handsontable th:last-child {
    border-left: 1px solid #ccc;
    border-right: none
}

.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2) {
    border-left: 1px solid #ccc
}

[dir=rtl].handsontable td:first-of-type,[dir=rtl].handsontable th:first-child,[dir=rtl].handsontable th:nth-child(2) {
    border-right: 1px solid #ccc
}

.handsontable .ht_clone_top th:nth-child(2) {
    border-left-width: 0;
    border-right: 1px solid #ccc
}

[dir=rtl].handsontable .ht_clone_top th:nth-child(2) {
    border-left: 1px solid #ccc;
    border-right-width: 0
}

.handsontable.htRowHeaders thead tr th:nth-child(2) {
    border-left: 1px solid #ccc
}

[dir=rtl].handsontable.htRowHeaders thead tr th:nth-child(2) {
    border-right: 1px solid #ccc
}

.handsontable tr:first-child td,.handsontable tr:first-child th {
    border-top: 1px solid #ccc
}

.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child {
    border-left: 1px solid #ccc;
    border-right-width: 0
}

[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child {
    border-left-width: 0;
    border-right: 1px solid #ccc
}

.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th {
    border-bottom-width: 0
}

.handsontable th {
    background-color: #f0f0f0;
    color: #222;
    font-weight: 400;
    text-align: center;
    white-space: nowrap
}

.handsontable thead th {
    padding: 0
}

.handsontable th.active {
    background-color: #ccc
}

.handsontable thead th .relative {
    padding: 2px 4px
}

.handsontable span.colHeader {
    display: inline-block;
    line-height: 1.1
}

.handsontable .wtBorder {
    font-size: 0;
    position: absolute
}

.handsontable .wtBorder.hidden {
    display: none!important
}

.handsontable .wtBorder.current {
    z-index: 10
}

.handsontable .wtBorder.area {
    z-index: 8
}

.handsontable .wtBorder.fill {
    z-index: 6
}

.handsontable .wtBorder.corner {
    cursor: crosshair;
    font-size: 0
}

.ht_clone_master {
    z-index: 100
}

.ht_clone_inline_start {
    z-index: 120
}

.ht_clone_bottom {
    z-index: 130
}

.ht_clone_bottom_inline_start_corner {
    z-index: 150
}

.ht_clone_top {
    z-index: 160
}

.ht_clone_top_inline_start_corner {
    z-index: 180
}

.handsontable col.hidden {
    width: 0!important
}

.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th {
    display: none
}

.ht_clone_bottom,.ht_clone_inline_start,.ht_clone_top,.ht_master {
    overflow: hidden
}

.ht_master .wtHolder {
    overflow: auto
}

.handsontable .ht_clone_inline_start thead,.handsontable .ht_master thead,.handsontable .ht_master tr th {
    visibility: hidden
}

.ht_clone_bottom .wtHolder,.ht_clone_inline_start .wtHolder,.ht_clone_top .wtHolder {
    overflow: hidden
}

.handsontable {
    color: #373737;
    font-family: system-ui;
    font-size: 13px;
    font-size: small;
    font-weight: 400;
    touch-action: manipulation
}

.handsontable a {
    color: #104acc
}

.handsontable.htAutoSize {
    left: -99000px;
    position: absolute;
    top: -99000px;
    visibility: hidden
}

.handsontable td.htInvalid {
    background-color: #ff4c42!important
}

.handsontable td.htNoWrap {
    white-space: nowrap
}

.hot-display-license-info {
    color: #373737;
    font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;
    font-size: 10px;
    font-weight: 400;
    padding: 5px 0 3px;
    text-align: left
}

.hot-display-license-info a {
    color: #104acc;
    font-size: 10px
}

.handsontable .manualColumnResizer {
    cursor: col-resize;
    height: 25px;
    position: absolute;
    top: 0;
    width: 5px;
    z-index: 210
}

.handsontable .manualRowResizer {
    cursor: row-resize;
    height: 5px;
    left: 0;
    position: absolute;
    width: 50px;
    z-index: 210
}

.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover {
    background-color: #34a9db
}

.handsontable .manualColumnResizerGuide {
    background-color: #34a9db;
    border-left: none;
    border-right: 1px dashed #777;
    display: none;
    margin-left: 5px;
    margin-right: unset;
    position: absolute;
    right: unset;
    top: 0;
    width: 0
}

[dir=rtl].handsontable .manualColumnResizerGuide {
    border-left: 1px dashed #777;
    border-right: none;
    left: unset;
    margin-left: unset;
    margin-right: 5px
}

.handsontable .manualRowResizerGuide {
    background-color: #34a9db;
    border-bottom: 1px dashed #777;
    bottom: 0;
    display: none;
    height: 0;
    left: 0;
    margin-top: 5px;
    position: absolute
}

.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active {
    display: block;
    z-index: 209
}

.handsontable .columnSorting {
    position: relative
}

.handsontable .columnSorting.sortAction:hover {
    cursor: pointer;
    text-decoration: underline
}

.handsontable span.colHeader.columnSorting:before {
    background-position-x: right;
    background-repeat: no-repeat;
    background-size: contain;
    content: "";
    height: 10px;
    left: unset;
    margin-top: -6px;
    padding-left: 8px;
    padding-right: 0;
    position: absolute;
    right: -9px;
    top: 50%;
    width: 5px
}

[dir=rtl].handsontable span.colHeader.columnSorting:before {
    background-position-x: left;
    left: -9px;
    padding-left: 0;
    padding-right: 8px;
    right: unset
}

.handsontable span.colHeader.columnSorting.ascending:before {
    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC)
}

.handsontable span.colHeader.columnSorting.descending:before {
    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII=)
}

.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):after {
    content: "*";
    display: inline-block;
    padding-right: 20px;
    position: relative
}

.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7 {
    position: relative
}

.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before {
    background: #005eff;
    bottom: 0;
    bottom: -100%\9;
    content: "";
    left: 0;
    position: absolute;
    right: 0;
    top: 0
}

@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active) {
    .handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before {
        bottom: -100%
    }
}

.handsontable td.area:before {
    opacity: .1
}

.handsontable td.area-1:before {
    opacity: .2
}

.handsontable td.area-2:before {
    opacity: .27
}

.handsontable td.area-3:before {
    opacity: .35
}

.handsontable td.area-4:before {
    opacity: .41
}

.handsontable td.area-5:before {
    opacity: .47
}

.handsontable td.area-6:before {
    opacity: .54
}

.handsontable td.area-7:before {
    opacity: .58
}

.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight {
    background-color: #dcdcdc
}

.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight {
    background-color: #8eb0e7;
    color: #000
}

.handsontableInput {
    background-color: #fff;
    border: none;
    border-radius: 0;
    box-shadow: inset 0 0 0 2px #5292f7;
    color: #000;
    display: block;
    font-family: inherit;
    font-size: inherit;
    line-height: 21px;
    margin: 0;
    outline-width: 0;
    padding: 1px 5px 0;
    resize: none
}

.handsontableInput:focus {
    outline: none
}

.handsontableInputHolder {
    left: 0;
    position: absolute;
    top: 0
}

.htSelectEditor {
    -webkit-appearance: menulist-button!important;
    position: absolute;
    width: auto
}

.htSelectEditor:focus {
    outline: none
}

.handsontable .htDimmed {
    color: #777
}

.handsontable .htSubmenu {
    position: relative
}

.handsontable .htSubmenu :after {
    color: #777;
    content: "â–¶";
    font-size: 9px;
    position: absolute;
    right: 5px
}

[dir=rtl].handsontable .htSubmenu :after {
    content: ""
}

[dir=rtl].handsontable .htSubmenu :before {
    color: #777;
    content: "â—€";
    font-size: 9px;
    left: 5px;
    position: absolute
}

.handsontable .htLeft {
    text-align: left
}

.handsontable .htCenter {
    text-align: center
}

.handsontable .htRight {
    text-align: right
}

.handsontable .htJustify {
    text-align: justify
}

.handsontable .htTop {
    vertical-align: top
}

.handsontable .htMiddle {
    vertical-align: middle
}

.handsontable .htBottom {
    vertical-align: bottom
}

.handsontable .htPlaceholder {
    color: #999
}

.handsontable.listbox {
    margin: 0
}

.handsontable.listbox .ht_master table {
    background: #fff;
    border: 1px solid #ccc;
    border-collapse: separate
}

.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th {
    border-color: transparent!important
}

.handsontable.listbox td,.handsontable.listbox th {
    text-overflow: ellipsis;
    white-space: nowrap
}

.handsontable.listbox td.htDimmed {
    color: inherit;
    cursor: default;
    font-style: inherit
}

.handsontable.listbox .wtBorder {
    visibility: hidden
}

.handsontable.listbox tr td.current,.handsontable.listbox tr:hover td {
    background: #eee
}

.ht_editor_hidden {
    z-index: -1
}

.ht_editor_visible {
    z-index: 200
}

.handsontable td.htSearchResult {
    background: #fcedd9;
    color: #583707
}

.handsontable .collapsibleIndicator {
    background: #eee;
    border: 1px solid #a6a6a6;
    border-radius: 10px;
    -webkit-box-shadow: 0 0 0 6px #eee;
    -moz-box-shadow: 0 0 0 6px #eee;
    box-shadow: 0 0 0 6px #eee;
    color: #222;
    cursor: pointer;
    font-size: 10px;
    height: 10px;
    left: unset;
    line-height: 8px;
    position: absolute;
    right: 5px;
    text-align: center;
    top: 50%;
    transform: translateY(-50%);
    width: 10px
}

[dir=rtl].handsontable .collapsibleIndicator {
    left: 5px;
    right: unset
}

.handsontable.mobile,.handsontable.mobile .wtHolder {
    -webkit-touch-callout: none;
    -webkit-tap-highlight-color: rgba(0,0,0,0);
    -webkit-overflow-scrolling: touch;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none
}

.handsontable.mobile .handsontableInput:focus {
    -webkit-appearance: none;
    -webkit-box-shadow: inset 0 0 0 2px #5292f7;
    -moz-box-shadow: inset 0 0 0 2px #5292f7;
    box-shadow: inset 0 0 0 2px #5292f7
}

.handsontable .bottomSelectionHandle,.handsontable .bottomSelectionHandle-HitArea,.handsontable .topSelectionHandle,.handsontable .topSelectionHandle-HitArea {
    left: -10000px;
    right: unset;
    top: -10000px;
    z-index: 9999
}

[dir=rtl].handsontable .bottomSelectionHandle,[dir=rtl].handsontable .bottomSelectionHandle-HitArea,[dir=rtl].handsontable .topSelectionHandle,[dir=rtl].handsontable .topSelectionHandle-HitArea {
    left: unset;
    right: -10000px
}

.handsontable.hide-tween {
    -webkit-animation: opacity-hide .3s;
    animation: opacity-hide .3s;
    animation-fill-mode: forwards;
    -webkit-animation-fill-mode: forwards
}

.handsontable.show-tween {
    -webkit-animation: opacity-show .3s;
    animation: opacity-show .3s;
    animation-fill-mode: forwards;
    -webkit-animation-fill-mode: forwards
}

.handsontable .htAutocompleteArrow {
    color: #eee;
    cursor: default;
    float: right;
    font-size: 10px;
    text-align: center;
    width: 16px
}

[dir=rtl].handsontable .htAutocompleteArrow {
    float: left
}

.handsontable td .htAutocompleteArrow:hover {
    color: #777
}

.handsontable td.area .htAutocompleteArrow {
    color: #d3d3d3
}

.handsontable .htCheckboxRendererInput {
    display: inline-block
}

.handsontable .htCheckboxRendererInput.noValue {
    opacity: .5
}

.handsontable .htCheckboxRendererLabel {
    cursor: pointer;
    display: inline-block;
    font-size: inherit;
    vertical-align: middle
}

.handsontable .htCheckboxRendererLabel.fullWidth {
    width: 100%
}

.handsontable .htCommentCell {
    position: relative
}

.handsontable .htCommentCell:after {
    border-left: 6px solid transparent;
    border-right: none;
    border-top: 6px solid #000;
    content: "";
    left: unset;
    position: absolute;
    right: 0;
    top: 0
}

[dir=rtl].handsontable .htCommentCell:after {
    border-left: none;
    border-right: 6px solid transparent;
    left: 0;
    right: unset
}

.htCommentsContainer .htComments {
    display: none;
    position: absolute;
    z-index: 1059
}

.htCommentsContainer .htCommentTextArea {
    -webkit-appearance: none;
    background-color: #fff;
    border: none;
    border-left: 3px solid #ccc;
    box-shadow: 0 1px 3px rgba(0,0,0,.118),0 1px 2px rgba(0,0,0,.239);
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    font-size: 12px;
    height: 90px;
    outline: 0!important;
    padding: 5px;
    width: 215px
}

[dir=rtl].htCommentsContainer .htCommentTextArea {
    border-left: none;
    border-right: 3px solid #ccc
}

.htCommentsContainer .htCommentTextArea:focus {
    border-left: 3px solid #5292f7;
    border-right: none;
    box-shadow: 0 1px 3px rgba(0,0,0,.118),0 1px 2px rgba(0,0,0,.239),inset 0 0 0 1px #5292f7
}

[dir=rtl].htCommentsContainer .htCommentTextArea:focus {
    border-left: none;
    border-right: 3px solid #5292f7
}

/*!
 * Handsontable ContextMenu
 */
.htContextMenu:not(.htGhostTable) {
    display: none;
    position: absolute;
    z-index: 1060
}

.htContextMenu .ht_clone_bottom,.htContextMenu .ht_clone_bottom_inline_start_corner,.htContextMenu .ht_clone_inline_start,.htContextMenu .ht_clone_top,.htContextMenu .ht_clone_top_inline_start_corner {
    display: none
}

.htContextMenu .ht_master table.htCore {
    /* border-color:#ccc; */
    border-style: solid;
    font-size: smaller;
    background: white;
    border-width: 1px 2px 2px 1px;
    border-radius: 0.3rem;
    box-shadow: #0000004f 3px 3px 16px;
}

[dir=rtl].htContextMenu .ht_master table.htCore {
    border-left-width: 2px;
    border-right-width: 1px
}

.htContextMenu .wtBorder {
    visibility: hidden
}

.htContextMenu table tbody tr td {
    /* background:#fff; */
    border-width: 0;
    cursor: pointer;
    overflow: hidden;
    padding: 4px 6px 0;
    text-overflow: ellipsis;
    white-space: nowrap
}

.htContextMenu table tbody tr td:first-child {
    border-width: 0;
    /* border-radius: 13.3rem; */
}

[dir=rtl].htContextMenu table tbody tr td:first-child {
    border-left-width: 0;
    border-right-width: 0
}

.htContextMenu table tbody tr td.htDimmed {
    color: #323232;
    font-style: normal
}

.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover {
    background: #f3f3f3
}

.htContextMenu table tbody tr td.htSeparator {
    border-top: 1px solid #e6e6e6;
    cursor: default;
    height: 0;
    padding: 0
}

.htContextMenu table tbody tr td.htDisabled {
    color: #999;
    cursor: default
}

.htContextMenu table tbody tr td.htDisabled:hover {
    background: #fff;
    color: #999;
    cursor: default
}

.htContextMenu table tbody tr.htHidden {
    display: none
}

.htContextMenu table tbody tr td .htItemWrapper {
    margin-left: 5px;
    margin-right: 5px;
}

[dir=rtl].htContextMenu table tbody tr td .htItemWrapper {
    margin-left: 6px;
    margin-right: 10px
}

.htContextMenu table tbody tr td div span.selected {
    left: 4px;
    margin-top: -2px;
    position: absolute;
    right: 0
}

[dir=rtl].htContextMenu table tbody tr td div span.selected {
    left: 0;
    right: 4px
}

.htContextMenu .ht_master .wtHolder {
    overflow: hidden
}

textarea.HandsontableCopyPaste {
    opacity: 0;
    outline: 0 none!important;
    overflow: hidden;
    position: fixed!important;
    right: 100%!important;
    top: 0!important
}

/*!
 * Handsontable DropdownMenu
 */
.handsontable .changeType {
    background: #eee;
    border: 1px solid #bbb;
    border-radius: 2px;
    color: #bbb;
    float: right;
    font-size: 9px;
    line-height: 9px;
    margin: 3px 1px 0 5px;
    padding: 2px
}

[dir=rtl].handsontable .changeType {
    float: left
}

.handsontable .changeType:before {
    content: "â–¼ "
}

.handsontable .changeType:hover {
    border: 1px solid #777;
    color: #777;
    cursor: pointer
}

.htDropdownMenu:not(.htGhostTable) {
    display: none;
    position: absolute;
    z-index: 1060
}

.htDropdownMenu .ht_clone_bottom,.htDropdownMenu .ht_clone_bottom_inline_start_corner,.htDropdownMenu .ht_clone_inline_start,.htDropdownMenu .ht_clone_top,.htDropdownMenu .ht_clone_top_inline_start_corner {
    display: none
}

.htDropdownMenu table.htCore {
    border-color: #ccc;
    border-style: solid;
    border-width: 1px 2px 2px 1px
}

[dir=rtl].htDropdownMenu table.htCore {
    border-left-width: 2px;
    border-right-width: 1px
}

.htDropdownMenu .wtBorder {
    visibility: hidden
}

.htDropdownMenu table tbody tr td {
    background: #fff;
    border-width: 0;
    cursor: pointer;
    overflow: hidden;
    padding: 4px 6px 0;
    text-overflow: ellipsis;
    white-space: nowrap
}

.htDropdownMenu table tbody tr td:first-child {
    border-width: 0
}

[dir=rtl].htDropdownMenu table tbody tr td:first-child {
    border-left-width: 0;
    border-right-width: 0
}

.htDropdownMenu table tbody tr td.htDimmed {
    color: #323232;
    font-style: normal
}

.htDropdownMenu table tbody tr td.current,.htDropdownMenu table tbody tr td.zeroclipboard-is-hover {
    background: #e9e9e9
}

.htDropdownMenu table tbody tr td.htSeparator {
    border-top: 1px solid #e6e6e6;
    cursor: default;
    height: 0;
    padding: 0
}

.htDropdownMenu table tbody tr td.htDisabled {
    color: #999
}

.htDropdownMenu table tbody tr td.htDisabled:hover {
    background: #fff;
    color: #999;
    cursor: default
}

.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden {
    display: none
}

.htDropdownMenu table tbody tr td .htItemWrapper,[dir=rtl].htDropdownMenu table tbody tr td .htItemWrapper {
    margin-left: 10px;
    margin-right: 10px
}

.htDropdownMenu table tbody tr td div span.selected {
    left: 4px;
    margin-top: -2px;
    position: absolute;
    right: 0
}

[dir=rtl].htDropdownMenu table tbody tr td div span.selected {
    left: 0;
    right: 4px
}

.htDropdownMenu .ht_master .wtHolder {
    overflow: hidden
}

/*!
 * Handsontable Filters
 */
.htFiltersConditionsMenu:not(.htGhostTable) {
    display: none;
    position: absolute;
    z-index: 1070
}

.htFiltersConditionsMenu .ht_clone_bottom,.htFiltersConditionsMenu .ht_clone_bottom_inline_start_corner,.htFiltersConditionsMenu .ht_clone_inline_start,.htFiltersConditionsMenu .ht_clone_top,.htFiltersConditionsMenu .ht_clone_top_inline_start_corner {
    display: none
}

.htFiltersConditionsMenu table.htCore {
    border-color: #bbb;
    border-style: solid;
    border-width: 1px 2px 2px 1px
}

.htFiltersConditionsMenu .wtBorder {
    visibility: hidden
}

.htFiltersConditionsMenu table tbody tr td {
    background: #fff;
    border-width: 0;
    cursor: pointer;
    overflow: hidden;
    padding: 4px 6px 0;
    text-overflow: ellipsis;
    white-space: nowrap
}

.htFiltersConditionsMenu table tbody tr td:first-child {
    border-width: 0
}

[dir=rtl].htFiltersConditionsMenu table tbody tr td:first-child {
    border-left-width: 0;
    border-right-width: 0
}

.htFiltersConditionsMenu table tbody tr td.htDimmed {
    color: #323232;
    font-style: normal
}

.htFiltersConditionsMenu table tbody tr td.current,.htFiltersConditionsMenu table tbody tr td.zeroclipboard-is-hover {
    background: #e9e9e9
}

.htFiltersConditionsMenu table tbody tr td.htSeparator {
    border-top: 1px solid #e6e6e6;
    height: 0;
    padding: 0
}

.htFiltersConditionsMenu table tbody tr td.htDisabled {
    color: #999
}

.htFiltersConditionsMenu table tbody tr td.htDisabled:hover {
    background: #fff;
    color: #999;
    cursor: default
}

.htFiltersConditionsMenu table tbody tr td .htItemWrapper {
    margin-left: 10px;
    margin-right: 10px
}

.htFiltersConditionsMenu table tbody tr td div span.selected {
    left: 4px;
    margin-top: -2px;
    position: absolute
}

.htFiltersConditionsMenu .ht_master .wtHolder {
    overflow: hidden
}

.handsontable .htMenuFiltering {
    border-bottom: 1px dotted #ccc;
    height: 135px;
    overflow: hidden
}

.handsontable .ht_master table td.htCustomMenuRenderer {
    background-color: #fff;
    cursor: auto
}

.handsontable .htFiltersMenuLabel {
    font-size: .75em
}

.handsontable .htFiltersMenuActionBar {
    padding-bottom: 3px;
    padding-top: 10px;
    text-align: center
}

.handsontable .htFiltersMenuCondition.border {
    border-bottom: 1px dotted #ccc!important
}

.handsontable .htFiltersMenuCondition .htUIInput {
    padding: 0 0 5px
}

.handsontable .htFiltersMenuValue {
    border-bottom: 1px dotted #ccc!important
}

.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch {
    padding: 0
}

.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input {
    box-sizing: border-box;
    font-family: inherit;
    font-size: .75em;
    padding: 4px;
    width: 100%
}

.htUIMultipleSelect .ht_master .wtHolder {
    overflow-y: scroll
}

.handsontable .htFiltersActive .changeType {
    background-color: #d2e0d9;
    border: 1px solid #509272;
    color: #18804e
}

.handsontable .htUISelectAll {
    margin-left: 0;
    margin-right: 10px
}

[dir=rtl].handsontable .htUISelectAll {
    margin-left: 10px;
    margin-right: 0
}

.handsontable .htUIClearAll,.handsontable .htUISelectAll {
    display: inline-block
}

.handsontable .htUIClearAll a,.handsontable .htUISelectAll a {
    font-size: .75em
}

.handsontable .htUISelectionControls {
    text-align: right
}

[dir=rtl].handsontable .htUISelectionControls {
    text-align: left
}

.handsontable .htCheckboxRendererInput {
    height: 1em;
    margin: 0 5px 0 0;
    vertical-align: middle
}

[dir=rtl].handsontable .htCheckboxRendererInput {
    margin-left: 5px;
    margin-right: 0
}

.handsontable .htUIInput {
    padding: 3px 0 7px;
    position: relative;
    text-align: center
}

.handsontable .htUIInput input {
    border: 1px solid #d2d1d1;
    border-radius: 2px
}

.handsontable .htUIInput input:focus {
    outline: 0
}

.handsontable .htUIInputIcon {
    position: absolute
}

.handsontable .htUIInput.htUIButton {
    cursor: pointer;
    display: inline-block
}

.handsontable .htUIInput.htUIButton input {
    background-color: #eee;
    color: #000;
    cursor: pointer;
    font-family: inherit;
    font-size: .75em;
    font-weight: 700;
    height: 19px;
    min-width: 64px
}

.handsontable .htUIInput.htUIButton input:hover {
    border-color: #b9b9b9
}

.handsontable .htUIInput.htUIButtonOK {
    margin-left: 0;
    margin-right: 10px
}

[dir=rtl].handsontable .htUIInput.htUIButtonOK {
    margin-left: 10px;
    margin-right: 0
}

.handsontable .htUIInput.htUIButtonOK input {
    background-color: #0f9d58;
    border-color: #18804e;
    color: #fff
}

.handsontable .htUIInput.htUIButtonOK input:hover {
    border-color: #1a6f46
}

.handsontable .htUISelect {
    cursor: pointer;
    margin-bottom: 7px;
    position: relative
}

.handsontable .htUISelectCaption {
    background-color: #e8e8e8;
    border: 1px solid #d2d1d1;
    border-radius: 2px;
    font-family: inherit;
    font-size: .75em;
    font-weight: 700;
    overflow: hidden;
    padding: 3px 20px 3px 10px;
    text-overflow: ellipsis;
    white-space: nowrap
}

.handsontable .htUISelectCaption:hover {
    background-color: #e8e8e8;
    border: 1px solid #b9b9b9
}

.handsontable .htUISelectDropdown:after {
    content: "â–²";
    font-size: 7px;
    position: absolute;
    right: 10px;
    top: 0
}

.handsontable .htUISelectDropdown:before {
    content: "â–¼";
    font-size: 7px;
    position: absolute;
    right: 10px;
    top: 8px
}

.handsontable .htUIMultipleSelect .handsontable .htCore {
    border: none
}

.handsontable .htUIMultipleSelect .handsontable .htCore td:hover {
    background-color: #f5f5f5
}

.handsontable .htUIMultipleSelectSearch input {
    border: 1px solid #d2d1d1;
    border-radius: 2px;
    padding: 3px
}

.handsontable .htUIRadio {
    display: inline-block;
    height: 100%;
    margin-left: 0;
    margin-right: 5px
}

[dir=rtl].handsontable .htUIRadio {
    margin-left: 5px;
    margin-right: 0
}

.handsontable .htUIRadio:last-child {
    margin-right: 0
}

.handsontable .htUIRadio>input[type=radio] {
    margin-left: 0;
    margin-right: .5ex
}

[dir=rtl].handsontable .htUIRadio>input[type=radio] {
    margin-left: .5ex;
    margin-right: 0
}

.handsontable .htUIRadio label {
    vertical-align: middle
}

.handsontable .htFiltersMenuOperators {
    padding-bottom: 5px
}

.handsontable th.beforeHiddenColumn {
    position: relative
}

.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after {
    color: #bbb;
    font-size: 5pt;
    position: absolute;
    top: 50%;
    transform: translateY(-50%)
}

.handsontable th.afterHiddenColumn {
    position: relative
}

.handsontable th.beforeHiddenColumn:after {
    content: "â—€";
    right: 1px
}

[dir=rtl].handsontable th.beforeHiddenColumn:after {
    content: "â–¶";
    left: 1px;
    right: auto
}

.handsontable th.afterHiddenColumn:before {
    content: "â–¶";
    left: 1px
}

[dir=rtl].handsontable th.afterHiddenColumn:before {
    content: "â—€";
    left: auto;
    right: 1px
}

/*!
 * Handsontable HiddenRows
 */
.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before {
    color: #bbb;
    font-size: 6pt;
    left: 2px;
    line-height: 6pt;
    position: absolute
}

.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow {
    position: relative
}

.handsontable th.beforeHiddenRow:before {
    bottom: 2px;
    content: "â–²"
}

.handsontable th.afterHiddenRow:after {
    content: "â–¼";
    top: 2px
}

.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before {
    color: #eee
}

.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow {
    border-top: 1px solid #ccc
}

.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_inline_start td:first-of-type,.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_top_inline_start_corner th:nth-child(2) {
    border-left: 0
}

.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight {
    cursor: move;
    cursor: -moz-grab;
    cursor: -webkit-grab;
    cursor: grab
}

.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight {
    cursor: move;
    cursor: -moz-grabbing;
    cursor: -webkit-grabbing;
    cursor: grabbing
}

.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer {
    display: none
}

.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline {
    display: none;
    height: 100%;
    position: absolute
}

.handsontable .ht__manualColumnMove--guideline {
    background: #757575;
    margin-inline-end:0;margin-inline-start:-1px;top: 0;
    width: 2px;
    z-index: 205
}

.handsontable .ht__manualColumnMove--backlight {
    background: #343434;
    background: rgba(52,52,52,.25);
    display: none;
    pointer-events: none;
    z-index: 205
}

.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline {
    display: block
}

.handsontable .wtHider {
    position: relative;
    /* border-radius: 1.3rem; */
}

.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight {
    cursor: move;
    cursor: -moz-grab;
    cursor: -webkit-grab;
    cursor: grab
}

.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight {
    cursor: move;
    cursor: -moz-grabbing;
    cursor: -webkit-grabbing;
    cursor: grabbing
}

.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer {
    display: none
}

.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline {
    display: none;
    position: absolute;
    width: 100%
}

.handsontable .ht__manualRowMove--guideline {
    background: #757575;
    height: 2px;
    left: 0;
    margin-top: -1px;
    z-index: 205
}

.handsontable .ht__manualRowMove--backlight {
    background: #343434;
    background: rgba(52,52,52,.25);
    display: none;
    pointer-events: none;
    z-index: 205
}

.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline {
    display: block
}

.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before {
    opacity: 0
}

.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before {
    opacity: .1
}

.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before {
    opacity: .2
}

.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before {
    opacity: .27
}

.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before {
    opacity: .35
}

.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before {
    opacity: .41
}

.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before {
    opacity: .47
}

.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before {
    opacity: .54
}

.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before {
    opacity: .58
}

.handsontable span.colHeader.columnSorting:after {
    font-size: 8px;
    height: 8px;
    left: unset;
    line-height: 1.1;
    margin-top: -2px;
    padding-left: 5px;
    padding-right: unset;
    position: absolute;
    right: -15px;
    text-decoration: underline;
    top: 50%
}

[dir=rtl].handsontable span.colHeader.columnSorting:after {
    left: -15px;
    padding-left: unset;
    padding-right: 5px;
    right: unset
}

.handsontable span.colHeader.columnSorting:after {
    text-decoration: none
}

.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after {
    content: "+"
}

.handsontable span.colHeader.columnSorting.sort-1:after {
    content: "1"
}

.handsontable span.colHeader.columnSorting.sort-2:after {
    content: "2"
}

.handsontable span.colHeader.columnSorting.sort-3:after {
    content: "3"
}

.handsontable span.colHeader.columnSorting.sort-4:after {
    content: "4"
}

.handsontable span.colHeader.columnSorting.sort-5:after {
    content: "5"
}

.handsontable span.colHeader.columnSorting.sort-6:after {
    content: "6"
}

.handsontable span.colHeader.columnSorting.sort-7:after {
    content: "7"
}

.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled) {
    padding-right: 5px
}

.handsontable thead th.hiddenHeader:not(:first-of-type) {
    display: none
}

.handsontable th.ht_nestingLevels {
    padding-left: 7px;
    text-align: left
}

[dir=rtl].handsontable th.ht_nestingLevels {
    padding-right: 7px;
    text-align: right
}

.handsontable th div.ht_nestingLevels {
    display: inline-block;
    left: 11px;
    position: absolute;
    right: unset
}

[dir=rtl].handsontable th div.ht_nestingLevels {
    left: unset;
    right: 11px
}

.handsontable.innerBorderInlineStart th div.ht_nestingLevels,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels {
    left: unset;
    right: 10px
}

[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingLevels,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels {
    left: 10px;
    right: unset
}

.handsontable th span.ht_nestingLevel {
    display: inline-block
}

.handsontable th span.ht_nestingLevel_empty {
    display: inline-block;
    float: left;
    height: 1px;
    width: 10px
}

[dir=rtl].handsontable th span.ht_nestingLevel_empty {
    float: right
}

.handsontable th span.ht_nestingLevel:after {
    bottom: 3px;
    content: "â”";
    display: inline-block;
    font-size: 9px;
    position: relative
}

.handsontable th div.ht_nestingButton {
    cursor: pointer;
    display: inline-block;
    left: unset;
    position: absolute;
    right: -2px
}

[dir=rtl].handsontable th div.ht_nestingButton {
    left: -2px;
    right: unset
}

.handsontable th div.ht_nestingButton.ht_nestingExpand:after {
    content: "+"
}

.handsontable th div.ht_nestingButton.ht_nestingCollapse:after {
    content: "-"
}

.handsontable.innerBorderInlineStart th div.ht_nestingButton,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton {
    left: unset;
    right: 0
}

[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingButton,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton {
    left: 0;
    right: unset
}</style>
<style >.sm-controls {
    font-family: system-ui;
}</style><script type="module">const t=(t,e)=>{if(e<=0)throw new Error("Size must be greater than zero.");const r=[];for(let n=0;n<t.length;n+=e)r.push(t.slice(n,n+e));return r};class e{dims;buffer;constructor(t,e){return this.buffer=t,this.dims=e,this}toJSON(){return this.normal()}normal(){let e=Array.from(this.buffer);for(let r=this.dims.length-1;r>0;--r)e=t(e,this.dims[r]);return e}static Q(t){return t instanceof e}}window.NumericArrayObject=e;class r{constructor(t,e){this.re=t,this.im=e}static isComplex(t){return t instanceof r}add(t){return new r(this.re+t.re,this.im+t.im)}subtract(t){return new r(this.re-t.re,this.im-t.im)}multiply(t){const e=this.re*t.re-this.im*t.im,n=this.re*t.im+this.im*t.re;return new r(e,n)}divide(t){const e=t.re**2+t.im**2,n=(this.re*t.re+this.im*t.im)/e,i=(this.im*t.re-this.re*t.im)/e;return new r(n,i)}}function n(t){return/^-?\d+$/.test(t)}const i=new RegExp(/^(-?\d+)(.?\d*)(\*\^)?(\d*)/);window.Complex=r,window.Deferred=class{promise={};reject={};resolve={};constructor(){this.promise=new Promise(((t,e)=>{this.reject=e,this.resolve=t}))}},window.aflatten=t=>t.flat(1/0),window.isNumeric=n;var o=(t,e={})=>{if(void 0===t)return console.log("undefined object"),t;const r="string"==typeof t;if(r){if("'"==t.charAt(0))return t.slice(1,-1);if(n(t))return parseInt(t);if(i.test(t)){console.log(t);let[e,r,n,o,a]=t.split(i);return r+="."===n?n+"0":n,o&&(r+="E"+a),console.log(r),parseFloat(r)}}if("number"==typeof t)return t;if(!(t instanceof Array||r))return t;let a,s;if(r?(a=t,s=void 0):(a=t[0],s=t.slice(1,t.length)),"scope"in e&&a in e.scope)return e.scope[a](s,e);if("context"in e)if(Array.isArray(e.context)){for(let r=0;r<e.context.length;++r)if(a in e.context[r]){if(e.method)return e.context[r][a][e.method]?e.context[r][a][e.method](s,e):console.error("method "+e.method+" is not defined for "+a);if("virtual"in e.context[r][a]&&!e.novirtual){const n=new l("virtual-"+u(),e,t);let i=n.assignScope();return console.log("virtual env"),n.firstName=a,e.context[r][a](s,i)}return e.context[r][a](s,e)}}else if(a in e.context){if(e.method)return e.context[a][e.method]?e.context[a][e.method](s,e):console.error("method "+e.method+" is not defined for "+a);if("virtual"in e.context[a]&&!e.novirtual){const r=new l("virtual-"+u(),e,t);let n=r.assignScope();return console.log("virtual env"),r.firstName=a,e.context[a](s,n)}return e.context[a](s,e)}const c=o.contextes;for(let r=0;r<c.length;++r)if(a in c[r]){if(e.method)return c[r][a][e.method]?c[r][a][e.method](s,e):console.error("method "+e.method+" is not defined for "+a);if("virtual"in c[r][a]&&!e.novirtual){const n=new l("virtual-"+u(),e,t);let i=n.assignScope();return console.log("virtual env"),n.firstName=a,c[r][a](s,i)}return c[r][a](s,e)}return o.anonymous(t,e)};const a=function(t){return t.split("").reduce((function(t,e){return 0|(t=(t<<5)-t+e.charCodeAt(0))}),0)};let s;o.hash=t=>{if(void 0===t)return console.log("undefined object"),a("undefined");const e="string"==typeof t;if(e){if("'"==t.charAt(0))return a(t.slice(1,-1));if(n(t))return a(String(parseInt(t)));if(i.test(t)){console.log(t);let[e,r,n,o,s]=t.split(i);return r+="."===n?n+"0":n,o&&(r+="E"+s),console.log(r),a(String(parseFloat(r)))}}return"number"==typeof t?a(String(t)):t instanceof Array||e?e?a(t):t.map((t=>o.hash(t))).reduce(((t,e)=>t+e),0):a(String(t))},o.cnt=0,o.contextes=[],o.contextExpand=t=>{console.log(t.name+" was added to the contextes of the interpreter"),o.contextes.push(t)},o.shared={},o.shared=class{constructor(t,e){this.key=t;const r=this;r.load=async()=>{await e(r),r.load=async()=>{console.log("Already loaded!")}},o.shared[t]=this}},o.handleMessage=t=>{const e={call:Math.floor(100*Math.random())};o(JSON.parse(t.data),{global:e})},o.unzlib64String=async t=>{s||(s=(await Promise.resolve().then((function(){return _}))).unzlibSync);const e=atob(t);return(new TextDecoder).decode(s(Uint8Array.from(e,(t=>t.charCodeAt(0)))))},o.anonymous=async(t,e)=>{throw"Unknown symbol "+JSON.stringify(t)};var c={};window.InstancesHashMap=c;class l{env={};uid="";instance="";dead=!1;virtual=!1;local={};assignScope(){return this.env.local=this.local,this.env}async execute(t){return o(this.virtual,t?{...this.env,...t}:this.env)}dispose(){if(this.dead)return;if(this.dead=!0,console.log("DESTORY: "+this.uid),this.static)return void delete c[this.instance];this.env.method="destroy";let t=this.virtual;this.env.local=this.local,o(t,this.env),delete c[this.instance]}update(t){if(this.parent instanceof l&&!(this.child instanceof l))return this.parent.update();let e;return this.env.method="update",this.env.local=this.local,e=this.virtual?this.virtual:this.storage.get(this.uid),o(e,this.env)}constructor(t,e,r=!1,n=!1){if(this.static=n,this.uid=t,this.env={...e,exposed:e},this.instance=u(),this.env.element=this.env.element||"body",this.env.global.stack=this.env.global.stack||{},this.env.global.stack[t]=this,this.env.root=this.env.root||{},this.local.middleware=t=>t,r?this.virtual=r:(t in ObjectHashMap?this.storage=ObjectHashMap[t]:this.storage=new ObjectStorage(t),this.storage.assign(this)),this.env.root instanceof l&&!this.env.static&&(this.env.root.static||(this.parent=this.env.root,this.env.root.child=this)),this.env.root=this,c[this.instance]=this,this.env.global.hooks){const t=this;this.env.global.hooks.forEach((e=>{e(t)}))}return this}}function u(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}window.ExecutableObject=l,window.uuidv4=u,window.downloadByURL=function(t,e){var r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download",e),r.click(),r.remove()};window.setInnerHTML=function(t,e){return t.innerHTML=e,Array.from(t.querySelectorAll("script")).forEach((t=>{const e=document.createElement("script");Array.from(t.attributes).forEach((t=>e.setAttribute(t.name,t.value))),e.appendChild(document.createTextNode(t.innerHTML)),t.parentNode.replaceChild(e,t)})),t},window.setInnerHTMLAsync=async function(t,e){return t.innerHTML=e,Array.from(t.querySelectorAll("script")).forEach((t=>{const e=document.createElement("script");Array.from(t.attributes).forEach((t=>e.setAttribute(t.name,t.value))),e.src||"module"!=e.type?e.appendChild(document.createTextNode(t.innerHTML)):(e.removeAttribute("type"),e.appendChild(document.createTextNode("{\n"+t.innerHTML+"\n}"))),t.parentNode.replaceChild(e,t)})),t},window.openawindow=function(t,e="_self"){const r=document.createElement("a");r.target=e,r.href=t,r.click()},o.throttle=30,window.throttle=function(t,e=()=>o.throttle){let r,n=!1;const i=()=>{null==r?n=!1:(t(...r),r=null,setTimeout(i,e()))};return(...o)=>{n?r=o:(t(...o),n=!0,setTimeout(i,e()))}},window.interpretate=o;var h=Uint8Array,d=Uint16Array,f=Int32Array,v=new h([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),m=new h([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),w=new h([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p=function(t,e){for(var r=new d(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];var i=new f(r[30]);for(n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},x=p(v,2),g=x.b,b=x.r;g[28]=258,b[258]=28;for(var y=p(m,0).b,A=new d(32768),S=0;S<32768;++S){var E=(43690&S)>>1|(21845&S)<<1;E=(61680&(E=(52428&E)>>2|(13107&E)<<2))>>4|(3855&E)<<4,A[S]=((65280&E)>>8|(255&E)<<8)>>1}var T=function(t,e,r){for(var n=t.length,i=0,o=new d(e);i<n;++i)t[i]&&++o[t[i]-1];var a,s=new d(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;if(r){a=new d(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var l=i<<4|t[i],u=e-t[i],h=s[t[i]-1]++<<u,f=h|(1<<u)-1;h<=f;++h)a[A[h]>>c]=l}else for(a=new d(n),i=0;i<n;++i)t[i]&&(a[i]=A[s[t[i]-1]++]>>15-t[i]);return a},k=new h(288);for(S=0;S<144;++S)k[S]=8;for(S=144;S<256;++S)k[S]=9;for(S=256;S<280;++S)k[S]=7;for(S=280;S<288;++S)k[S]=8;var M=new h(32);for(S=0;S<32;++S)M[S]=5;var N=T(k,9,1),O=T(M,5,1),j=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},H=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(7&e)&r},z=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(7&e)},C=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],L=function(t,e,r){var n=new Error(e||C[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,L),!r)throw n;return n},I=function(t,e,r,n){var i=t.length,o=n?n.length:0;if(!i||e.f&&!e.l)return r||new h(0);var a=!r,s=a||2!=e.i,c=e.i;a&&(r=new h(3*i));var l=function(t){var e=r.length;if(t>e){var n=new h(Math.max(2*e,t));n.set(r),r=n}},u=e.f||0,d=e.p||0,f=e.b||0,p=e.l,x=e.d,b=e.m,A=e.n,S=8*i;do{if(!p){u=H(t,d,1);var E=H(t,d+1,3);if(d+=3,!E){var k=t[(P=4+((d+7)/8|0))-4]|t[P-3]<<8,M=P+k;if(M>i){c&&L(0);break}s&&l(f+k),r.set(t.subarray(P,M),f),e.b=f+=k,e.p=d=8*M,e.f=u;continue}if(1==E)p=N,x=O,b=9,A=5;else if(2==E){var C=H(t,d,31)+257,I=H(t,d+10,15)+4,U=C+H(t,d+5,31)+1;d+=14;for(var D=new h(U),_=new h(19),F=0;F<I;++F)_[w[F]]=H(t,d+3*F,7);d+=3*I;var J=j(_),R=(1<<J)-1,q=T(_,J,1);for(F=0;F<U;){var P,B=q[H(t,d,R)];if(d+=15&B,(P=B>>4)<16)D[F++]=P;else{var Q=0,Y=0;for(16==P?(Y=3+H(t,d,3),d+=2,Q=D[F-1]):17==P?(Y=3+H(t,d,7),d+=3):18==P&&(Y=11+H(t,d,127),d+=7);Y--;)D[F++]=Q}}var $=D.subarray(0,C),G=D.subarray(C);b=j($),A=j(G),p=T($,b,1),x=T(G,A,1)}else L(1);if(d>S){c&&L(0);break}}s&&l(f+131072);for(var K=(1<<b)-1,V=(1<<A)-1,W=d;;W=d){var X=(Q=p[z(t,d)&K])>>4;if((d+=15&Q)>S){c&&L(0);break}if(Q||L(2),X<256)r[f++]=X;else{if(256==X){W=d,p=null;break}var Z=X-254;if(X>264){var tt=v[F=X-257];Z=H(t,d,(1<<tt)-1)+g[F],d+=tt}var et=x[z(t,d)&V],rt=et>>4;et||L(3),d+=15&et;G=y[rt];if(rt>3){tt=m[rt];G+=z(t,d)&(1<<tt)-1,d+=tt}if(d>S){c&&L(0);break}s&&l(f+131072);var nt=f+Z;if(f<G){var it=o-G,ot=Math.min(G,nt);for(it+f<0&&L(3);f<ot;++f)r[f]=n[it+f]}for(;f<nt;++f)r[f]=r[f-G]}}e.l=p,e.p=W,e.b=f,e.f=u,p&&(u=1,e.m=b,e.d=x,e.n=A)}while(!u);return f!=r.length&&a?function(t,e,r){return(null==e||e<0)&&(e=0),(null==r||r>t.length)&&(r=t.length),new h(t.subarray(e,r))}(r,0,f):r.subarray(0,f)},U=new h(0);var D="undefined"!=typeof TextDecoder&&new TextDecoder;try{D.decode(U,{stream:!0})}catch(t){}var _=Object.freeze({__proto__:null,unzlibSync:function(t,e){return I(t.subarray((r=t,n=e&&e.dictionary,(8!=(15&r[0])||r[0]>>4>7||(r[0]<<8|r[1])%31)&&L(6,"invalid zlib data"),(r[1]>>5&1)==+!n&&L(6,"invalid zlib data: "+(32&r[1]?"need":"unexpected")+" dictionary"),2+(r[1]>>3&4)),-4),{i:2},e&&e.out,e&&e.dictionary);var r,n}});</script>
<script type="module">var core = {};
core.name = "Core Context";
interpretate.contextExpand(core);

core.DefaultWidth = 370;

core.ConsoleLog = [];

core.GarbageCollected = async(args, env) => {
    if ('element' in env) {
        env.element.innerText = '- Garbage -';
    }
    console.log('garbage collected');
}

core.GarbageCollected.update = async() => console.warn('Gargbage collected items cannot be updated')
core.GarbageCollected.destroy = async() => console.warn('Gargbage collected items cannot be destroyed')

core.True = (args, env) => {
    return true;
}

core.False = (args, env) => {
    return false;
}
/*
core.FrontEndExecutable = async(args, env) => {
    const key = interpretate(args[0], env);
    //creates an instance with its own separate env
    //we need this local context to create stuff and then, destory it if it necessary
    console.log("FEE: creating an object with key " + key);
    //new local scope, global is the same
    const obj = new ExecutableObject(key, env);

    const result = await obj.execute()
    return result;
};

core.FrontEndExecutable.update = async(args, env) => {
    const key = interpretate(args[0], env);
    return await env.global.stack[key].execute();
};

core.FrontEndExecutable.destroy = async(args, env) => {
    const key = interpretate(args[0], env);
    await env.global.stack[key].dispose();
};
*/
core._typeof = function(args, env) {
    if (typeof args === 'string') {
        if (args.charAt(0) === "'")
            return 'string';

        //if (core[args].virtual) return 'variable';
        return 'idunno'
    }
    if (typeof args === 'number') {
        return 'number';
    }
    if (args instanceof Array) {
        return args[0];
    }

    return 'undefined';
}

core._getRules = async function(args, env) {
    let rules = {};
    if (env.hold) {
        for (const el of args) {
            if (el instanceof Array) {
                if (el[0] === 'Rule') {
                    rules[interpretate(el[1], {
                        ...env,
                        hold: false
                    })] = el[2];
                }
            }
        };
    } else {
        for (const el of args) {
            if (el instanceof Array) {
                if (el[0] === 'Rule') {
                    rules[interpretate(el[1], {
                        ...env,
                        hold: false
                    })] = await interpretate(el[2], env);
                }
            }
        };
    }

    return rules;
}



core.ReadClipboard = async(args, env) => {
    const clipText = await navigator.clipboard.readText();
    return clipText;
}

core.FrontEndDispose = function(args, env) {
    //no need anymore
    console.log('garbage removed');
}



core.NoVirtual = async(args, env) => {
    return await interpretate(args, {
        ...env,
        novirtual: true
    })
}

core.NoVirtual.destroy = core.NoVirtual


core.FlipSymbols = async function(args, env) {
    const key1 = args[0];
    const key2 = args[1];

    if (args.length > 2) {
        console.log('applying function ' + args[2]);
        const temp = await interpretate([args[2], key1], {
            ...env,
            novirtual: true
        });
        core[key1].data = core[key2].data;
        core[key2].data = temp;
    } else {
        const temp = core[key1].data;
        core[key1].data = core[key2].data;
        core[key2].data = temp;
    }



    Object.values(core[key1].instances).forEach((inst) => {
        inst.update();
    });

    Object.values(core[key2].instances).forEach((inst) => {
        inst.update();
    });
}

core.Unsafe = async function(args, env) {
    return await interpretate(args[0], {
        ...env,
        unsafe: true
    });
}

core.GlobalThrottle = async function(args, env) {
    interpretate.throttle = await interpretate(args[0], env);
}

core.FrontEndExecutableHold = core.FrontEndExecutable;
//to prevent codemirror 6 from drawing it
core.FrontEndRef = core.FrontEndExecutable;
//another alias
core.FrontEndExecutableWrapper = core.FrontEndExecutable;
//hold analogue for the backend

core.FrontEndOnly = (args, env) => {
    return interpretate(args[0], env);
};

core.FrontEndOnly.update = (args, env) => {
    return interpretate(args[0], env);
};

core.FrontEndOnly.destroy = (args, env) => {
    interpretate(args[0], env);
};

core.FHold = core.FrontEndOnly;

core.Hold = core.FrontEndOnly;

core.Dynamic = () => {
    console.warn('Dynamic is not supported. Use Offload! Ignored...');
};


core.Power = async(args, env) => {
    //if (!env.numerical) return ["Power", ...args];

    const val = await interpretate(args[0], env);
    const p = await interpretate(args[1], env);

    return Math.pow(val, p);
}

core.Power.destroy = core.Power
core.Power.update = core.Power

core.E = () => Math.E
core.E.update = core.E
core.E.destroy = core.E


core.Complex = (args, env) => {
    return new Complex(interpretate(args[0], env), interpretate(args[1], env))
}

core.Plus = async(args, env) => {
    let x = await interpretate(args[0], env);
    let y = await interpretate(args[1], env);

    if (x instanceof NumericArrayObject) {
        x = x.normal();
    }

    if (y instanceof NumericArrayObject) {
        y = y.normal();
    }

    const typeX = typeof x;
    const typeY = typeof y;
    let result;

    if (typeX === 'number' && typeof typeY !== 'number') {
        result =  sumNestedArrayByScalar(y, x)
    } else if (typeY === 'number' && typeof typeX !== 'number') {
        result =  sumNestedArrayByScalar(x, y)
    } else if (typeY !== 'number' && typeof typeX !== 'number') {
        result =  calculateNestedArraySum(x, y)
    } else {
        result = x + y
    }

    //TODO: support multiple arguments better
    if (args.length > 2) {
        return await core.Plus([['JSObject', result], ...args.slice(2)])
    }

    return result;
}

core.Plus.update = core.Plus;

core.Plus.destroy = async(args, env) => {
    await interpretate(args[0], env);
    await interpretate(args[1], env);
}

core.Rational = async function(args, env) {
    return (await interpretate(args[0], env)) / (await interpretate(args[1], env));
}

core.Rational.update = core.Rational
core.Rational.destroy = core.Rational

function multiplyNestedArrayByScalar(arr, scalar) {
    if (Array.isArray(arr)) {
        return arr.map((item) => multiplyNestedArrayByScalar(item, scalar));
    } else {
        return arr * scalar;
    }
}

function calculateNestedArraySum(arr1, arr2) {
    // Base case: if both inputs are numbers, return their sum


    const result = [];

    for (let i = 0; i < arr1.length; i++) {
        if (Array.isArray(arr1[i]) && Array.isArray(arr2[i])) {
            // If both elements are arrays, recursively calculate nested sum
            result.push(calculateNestedArraySum(arr1[i], arr2[i]));
        } else if (!Array.isArray(arr1[i]) && !Array.isArray(arr2[i])) {
            // If both elements are numbers, add them
            result.push(arr1[i] + arr2[i]);
        } else {
            // Mismatched types, throw an error
            throw new Error('Mismatched element types in nested arrays.');
        }
    }

    return result;
}

function sumNestedArrayByScalar(arr, scalar) {
    if (Array.isArray(arr)) {
        return arr.map((item) => sumNestedArrayByScalar(item, scalar));
    } else {
        return arr + scalar;
    }
}

core.Times = async function(args, env) {
    //if (env.numerical === true) return (await interpretate(args[0], env)) * (await interpretate(args[1], env));
    let x = await interpretate(args[0], env);
    let y = await interpretate(args[1], env);

    if (x instanceof NumericArrayObject) {
        x = x.normal();
    }

    if (y instanceof NumericArrayObject) {
        y = y.normal();
    }

    const typeX = typeof x;
    const typeY = typeof y;

    if (typeX === 'number' && typeof typeY !== 'number') {
        return multiplyNestedArrayByScalar(y, x)
    }

    if (typeY === 'number' && typeof typeX !== 'number') {
        return multiplyNestedArrayByScalar(x, y)
    }

    //TODO: evaluate it before sending its original symbolic form
    return x * y;
}

core.Times.update = core.Times;

function getRandomArbitrary(min, max) {
    return Math.random() * (max - min) + min;
}

core.Times.destroy = async function(args, env) {
    //if (env.numerical === true) return (await interpretate(args[0], env)) * (await interpretate(args[1], env));
    await interpretate(args[0], env);
    await interpretate(args[1], env);
}

core.RandomReal = async(args, env) => {
    const range = await interpretate(args[0], env);

    if (args.length > 1) {
        let size = await interpretate(args[1], env);
        let arr = [];

        if (size[0]) {
            for (let j = 0; j < size[0]; ++j) {
                const sub = [];
                for (let i = 0; i < size[1]; ++i) {
                    sub.push(getRandomArbitrary(...range));
                }
                arr.push(sub);
            }

            return arr;
        } else {
            for (let i = 0; i < size; ++i) {
                arr.push(getRandomArbitrary(...range));
            }
            return arr;
        }
    }
    return getRandomArbitrary(...range);


}

core.Abs = async (args, env) => {
  const d = await interpretate(args[0], env);
  return Math.abs(d)
}

core.Abs.update = core.Abs 

core.Tan = async function(args, env) {
    return Math.tan(await interpretate(args[0], env));
}

core.Sin = async function(args, env) {
    return Math.sin(await interpretate(args[0], env));
}

core.Cos = async function(args, env) {
    return Math.cos(await interpretate(args[0], env));
}

core.Cos.update = core.Cos
core.Cos.destroy = core.Cos

core.Sin.update = core.Sin
core.Sin.destroy = core.Sin

core.Tuples = async(args, env) => {
    const array = await interpretate(args[0], env);
    const subsetSize = interpretate(args[1], env);

    const result = [];

    function generateSubsets(index, currentSubset) {
        if (currentSubset.length === subsetSize) {
            result.push(currentSubset);
            return;
        }

        for (let i = 0; i < array.length; i++) {
            generateSubsets(i, [...currentSubset, array[i]]);
        }
    }

    generateSubsets(0, []);

    return result;
}

core.Tuples.update = core.Tuples;
core.Tuples.destroy = (args, env) => {
    interpretate(args[0], env)
}

core.EventListener = (args, env) => {
    console.error('Event listener for general cases is not supported! Please, use it with Graphics or other packages');
}

core.List = async function(args, env) {
    let copy, e, i, len, list;
    list = [];

    if (env.hold === true) {
        //console.log('holding...');
        for (i = 0, len = args.length; i < len; i++) {
            e = args[i];
            list.push(e);
        }
        return list;
    }

    copy = Object.assign({}, env);
    for (i = 0, len = args.length; i < len; i++) {
        e = args[i];
        const evaluated = await interpretate(e, copy);

        if (evaluated instanceof NumericArrayObject) {
            list.push(evaluated.normal());
            continue;
        }

        list.push(evaluated);
    }

    return list;
};

core.List.destroy = (args, env) => {
    console.log('List destroed!');
    console.warn('Usually it should never happen... Probably some parent`s destructor did work in a wrong way');
};

core.List.update = core.List;

core.Association = async function(args, env) {
    return (await core._getRules(args, env));
};

core.Association.update = core.Association

core.Association.destroy = async(args, env) => {
    for (const i of args) {
        await interpretate(i, env);
    }
}


core.Function = (args, env) => {
    //void
}

core.$Failed = (args, env) => {
    console.error('$Failed encountered');
}

core.Pause = async(args, env) => {
    const time = 1000 * (await interpretate(args[0], env));

    return new Promise(resolve => {
        setTimeout(() => {
            //console.log("Finished Inner Timeout")
            resolve('resolved');
        }, time);
    })
}

core.Normalize = async(args, env) => {
    const data = await interpretate(args[0], env);
    //console.log(data);

    let length = 0.0;
    for (let i = 0; i < data.length; ++i) {
        length += data[i] * data[i];
    }


    return (data.map((e) => e / length));
}

core.Normalize.update = core.Normalize
core.Normalize.destroy = async(args, env) => await interpretate(args[0], env)

core.Dot = async(args, env) => {
    const x = await interpretate(args[0], env);
    const y = await interpretate(args[1], env);

    let total = 0.0;
    for (let i = 0; i < x.length; ++i) {
        total += x[i] * y[i];
    }
    return total;
}

core.Dot.update = core.Dot
core.Dot.destroy = async(args, env) => {
    await interpretate(args[0], env);
    await interpretate(args[1], env);
}

core.Cross = async(args, env) => {
    const x = await interpretate(args[0], env);
    const y = await interpretate(args[1], env);

    return [y[2] * x[1] - y[1] * x[2], -y[2] * x[0] + y[0] * x[2], y[1] * x[0] - y[0] * x[1]];
}

core.Cross.update = core.Cross
core.Cross.destroy = async(args, env) => {
    await interpretate(args[0], env);
    await interpretate(args[1], env);
}

core.NoUpdates = async(args, env) => {
    return await interpretate(args[0], env);
}

core.NoUpdates.destroy = async(args, env) => {
    return await interpretate(args[0], env);
}

core.NoUpdates.update = async(args, env) => {
    console.log('Updates are blocked by NoUpdates expr');
    return null;
}

core.Static = async(args, env) => {
    return await interpretate(args[0], env);
}

core.Static.destroy = async(args, env) => {
    return await interpretate(args[0], env);
}

core.Static.update = async(args, env) => {
    console.log('Updates are not allowed inside Static');
    return undefined;
}

core.Constant = async(args, env) => {
    return await interpretate(args, {
        ...env,
        novirtual: true
    })
}

core.Constant.update = async(args, env) => {
    console.log('Updates are blocked for constants');
    return undefined;
}

core.Constant.destroy = core.Constant

core.CompoundExpression = async(args, env) => {
    //sequential execution
    let content;

    for (const expr of args) {
        content = await interpretate(expr, env);
    }

    return content;
}

core.CompoundExpression.update = async(args, env) => {
    //sequential execution
    let content;

    for (const expr of args) {
        content = await interpretate(expr, env);
    }

    return content;
}

core.CompoundExpression.destroy = async(args, env) => {
    for (const expr of args) {
        await interpretate(expr, env);
    }
}

core.While = async(args, env) => {
    //sequential execution

    //creating virtual objects in conditions are fobidden
    const condition = await interpretate(args[0], {
        ...env,
        novirtual: true
    });
    //console.log('condition: ' + condition);
    if (condition) {

        //creating virtual objects is fobidden in cycles
        await interpretate(args[1], {
            ...env,
            novirtual: true
        });
        await interpretate(['While', ...args], env);
    }
}

core.If = async(args, env) => {
    const cond = await interpretate(args[0], env);
    if (cond) {
        return await interpretate(args[1], env);
    } else {
        if (args.length > 2) return await interpretate(args[2], env);
        return null;
    }
}

core.If.update = core.If
core.If.destroy = async(args, env) => {
    await interpretate(args[0], env)
    await interpretate(args[1], env);
}

core.Less = async(args, env) => {
    if ((await interpretate(args[0], env)) < (await interpretate(args[1], env))) return true;
    else return false;
}

core.Less.update = core.Less
core.Less.destroy = core.Less

core.Greater = async(args, env) => {
    if ((await interpretate(args[0], env)) > (await interpretate(args[1], env))) return true;
    else return false;
}

core.Greater.update = core.Greater
core.Greater.destroy = core.Greater

core.Equals = async(args, env) => {
    if ((await interpretate(args[0], env)) === (await interpretate(args[1], env))) return true;
    else return false;
}

core.Equals.update = core.Equals
core.Equals.destroy = core.Equals

core.Alert = async(args, env) => {
    alert(await interpretate(args[0], env));
}

core.Print = async(args, env) => {
    console.log('Out:\t' + JSON.stringify(await interpretate(args[0], env)));
}

core.Null = () => undefined
core.Null.update = () => undefined
core.Null.destory = () => undefined

core.N = (args, env) => {
    const copy = {
        ...env,
        numerical: true
    };
    return interpretate(args[0], copy);
}

core.AttachDOM = async(args, env) => {
    //used to attach dom element to the containirized function
    if (!env.root) {
        console.warn('Using AttachDOM on pure function is not recommended. Consider to use virtual or real containers instead!');
    }

    const id = await interpretate(args[0], env);
    env.element = document.getElementById(id);
    return id;
}

core.AttachDOM.destroy = async(args, env) => {}
core.AttachDOM.update = async(args, env) => {}

core['Global`AttachDOM'] = core.AttachDOM

core.WindowScope = async(args, env) => {
    const key = interpretate(args[0]);
    return window[key];
}

core.Evaluate = async(args, env) => {
    const i = await interpretate(args[0], env);

    return await interpretate(i, env);
}

core.RandomSample = async(args, env) => {
    //TODO: needs perfomance optimization. do not evaluate deeper than
    let list = await interpretate(args[0], {
        ...env
    });

    _shuffle(list);

    return list;
}

function _shuffle(array) {
    let currentIndex = array.length,
        randomIndex;

    // While there remain elements to shuffle.
    while (currentIndex != 0) {

        // Pick a remaining element.
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex--;

        // And swap it with the current element.
        [array[currentIndex], array[randomIndex]] = [
            array[randomIndex], array[currentIndex]
        ];
    }

    return array;
}

core.Table = async(args, env) => {
    let copy = Object.assign({}, env);
    copy.hold = false;

    let listOfRanges = [];

    for (let ranges of args.slice(1)) {
        listOfRanges.push({
            ranges: await interpretate(ranges, {
                ...env,
                hold: true
            })
        });
        //just to get a JS array of WL objects //hah kinda strange combination
    }

    if (!copy.scope) copy.scope = {};
    let deepcopy = {
        ...copy.scope
    };

    //first stage - assign the first values
    for (let i = 0; i < listOfRanges.length; ++i) {
        //console.warn(listOfRanges[i]);
        listOfRanges[i].id = listOfRanges[i].ranges.shift();
        //console.log('variable: '+listOfRanges[i].id);

        switch (listOfRanges[i].ranges.length) {
            case 1:
                const a = await interpretate(listOfRanges[i].ranges[0], {
                    ...env,
                    numerical: true,
                    novirtual: true,
                    hold: false
                });
                if (a instanceof Array) {
                    //array instead of a number
                    listOfRanges[i].ranges = [1, a.length];
                    listOfRanges[i].array = a;

                    break;
                }

                const newranges = [1, a];
                listOfRanges[i].ranges = newranges;

                break;

            case 2:
                //console.log('a numerical range');

                listOfRanges[i].ranges[0] = await interpretate(listOfRanges[i].ranges[0], {
                    ...env,
                    novirtual: true,
                    numerical: true,
                    hold: false
                });
                listOfRanges[i].ranges[1] = await interpretate(listOfRanges[i].ranges[1], {
                    ...env,
                    novirtual: true,
                    numerical: true,
                    hold: false
                });
                break;

            case 3:
                //console.log('a numerical range with defined step');

                listOfRanges[i].ranges[0] = await interpretate(listOfRanges[i].ranges[0], {
                    ...env,
                    novirtual: true,
                    numerical: true,
                    hold: false
                });
                listOfRanges[i].ranges[1] = await interpretate(listOfRanges[i].ranges[1], {
                    ...env,
                    novirtual: true,
                    numerical: true,
                    hold: false
                });
                listOfRanges[i].ranges[2] = await interpretate(listOfRanges[i].ranges[2], {
                    ...env,
                    novirtual: true,
                    numerical: true,
                    hold: false
                });
                break;
        }
    }

    //console.log(JSON.stringify(listOfRanges));


    const iterate = async(r0, f, level) => {
        const result = [];
        const r = {
            ...r0
        };

        //console.log('range: '+JSON.stringify(r));

        switch (r.ranges.length) {
            case 2:
                if (r.array) {

                    for (let i = r.ranges[0]; i <= r.ranges[1]; i++) {
                        //console.log('iterator '+r.id+' = '+i);
                        deepcopy[r.id] = () => r.array[i - 1];
                        result.push(await f(level + 1));
                    }

                    break;
                }

                for (let i = r.ranges[0]; i <= r.ranges[1]; i++) {
                    //console.log('iterator '+r.id+' = '+i);
                    deepcopy[r.id] = () => i;
                    result.push(await f(level + 1));
                }
                break;

            case 3:
                for (let i = r.ranges[0]; i <= r.ranges[1]; i = i + r.ranges[2]) {
                    //console.log('iterator '+r.id+' = '+i);
                    deepcopy[r.id] = () => i;
                    result.push(await f(level + 1));
                }
                break;
        }
        return result;
    };

    let m;
    m = (level) => {
        //console.log('go deeper');
        if (level === listOfRanges.length) return interpretate(args[0], {
            ...copy,
            scope: {
                ...deepcopy
            }
        });
        //console.log('next nested');
        return iterate(listOfRanges[level], m, level);
    }

    const table = await iterate(listOfRanges[0], m, 0);
    //console.log('table');
    //console.log(table);

    if (env.hold) {
        //env.hold = false;
        //return ["JSObject", table]; 
    }
    return table;

}

core.Table.update = core.Table

core.Table.destroy = (args, env) => {
    args.forEach((a) => {
        interpretate(a, env);
    })
}

core.JSObject = (args, env) => {
    return args[0];
}

core.Set = async(args, env) => {
    const data = await interpretate(args[1], {
        ...env,
        novirtual: true,
        method: undefined
    });
    const name = args[0];

    //console.log(name);

    if (name in core) {
        //console.log("update");
        //update
        core[name].data = data;

        for (const inst of Object.values(core[name].instances)) {
            inst.update();
        };

        return;
    }

    //create
    console.log("create");
    core[name] = async(args, env) => {
        //console.log('calling our symbol...');
        if (env.root && !env.novirtual) core[name].instances[env.root.uid] = env.root; //if it was evaluated insdide the container, then, add it to the tracking list
        //if (env.hold) return ['JSObject', core[name].data];

        return core[name].data;
    }

    core[name].update = async(args, env) => {
        //if (env.hold) return ['JSObject', core[name].data];
        return core[name].data;
    }

    core[name].virtual = true;
    core[name].instances = {};

    core[name].data = data;

}

core.Set.destroy = (args, env) => {
    interpretate(args[1], env);
}

core.Set.update = core.Set

core.SetDelayed = async(args, env) => {
    //just copy Set without intepreteate()

}

core.Length = async(args, env) => {
    const l = (await interpretate(args[0], {
        ...env,
        novirtual: true
    })).length;
    //console.log('length: '+l);
    return l;
}

core.Length.update = async(args, env) => {
    const l = (await interpretate(args[0], {
        ...env,
        novirtual: true
    })).length;
    //console.log('length: '+l);
    return l;
}

core.Length.destroy = async(args, env) => {
    await interpretate(args[0], {
        ...env,
        novirtual: true
    });
}

///todo needs so more optimizations!!!
//do not evlaute the whole stuff
core.Part = async(args, env) => {
    const p = await interpretate(args[1], env);
    const data = await interpretate(args[0], {
        ...env,
        useCache: true //enable caching to prevent multiple evaluations
    });

    if (Array.isArray(p)) {
        throw('Arrays in Part is not supported for now!');
    }

    if (data instanceof NumericArrayObject) {
        let offset = p-1; 
        //console.log('Taking part: '+offset);
        //console.log(data);

        if (data.dims.length > 1) {
            let step = 1;
            for (let i = data.dims.length-1; i > 0; --i) {
                offset *= data.dims[i];
                step *= data.dims[i];
            }
            //console.log(step);
            const part = (new NumericArrayObject(data.buffer.slice(offset, offset+step), data.dims.slice(1)));
            //console.log(part);
            return part;
        }

        //console.log('LAready simple');
        //console.log(data);
        //console.log(data.buffer[p-1]);

        return data.buffer[p-1];

    }

    return data[p - 1];
}

core.Part.update = core.Part;
core.Part.destroy = async(args, env) => {
    const p = await interpretate(args[1], env);
    const data = await interpretate(args[0], {
        ...env
    })
}

core.JSObject = async(args, env) => {
    return args[0];
}

core.JSObject.update = core.JSObject;
core.JSObject.destroy = core.JSObject;



/*core.RGBColor =  async (args, env) => {
const color = [];
for (const col of args) {
color.push(await interpretate(col, env));
}

color.unshift('RGBColor');
console.log('color:' + JSON.stringify(color));
return color;

return new UnevaluedSymbl() aka JS object
}*/

core.Flatten = async(args, env) => {
    //always reset hold if it is there, that it wont propagate
    const result = (await interpretate(args[0], {
        ...env,
        hold: false
    })).flat(Infinity);
    //if (env.hold) return ['JSObject', result];
    return result;
}

core.Flatten.update = core.Flatten

core.Flatten.destroy = async(args, env) => {
    await interpretate(args[0], {
        ...env,
        hold: false
    });
}

core.Partition = async(args, env) => {
    const perChunk = await interpretate(args[1], {
        ...env,
        hold: false
    });
    const inputArray = await interpretate(args[0], {
        ...env,
        hold: false
    });

    const result = inputArray.reduce((resultArray, item, index) => {
        const chunkIndex = Math.floor(index / perChunk)

        if (!resultArray[chunkIndex]) {
            resultArray[chunkIndex] = [] // start a new chunk
        }

        resultArray[chunkIndex].push(item)

        return resultArray
    }, []);


    //if (env.hold) return ['JSObject', result];
    return result;
}

core.Partition.update = core.Partition
core.Partition.destroy = async(args, env) => {
    const perChunk = await interpretate(args[1], {
        ...env,
        hold: false
    });
    const inputArray = await interpretate(args[0], {
        ...env,
        hold: false
    });
}

core.HoldFirstLevel = async(args, env) => {
    return await interpretate(args[0], {
        ...env,
        hold: true
    });
}


core.With = async(args, env) => {
    const params = await interpretate(args[0], {
        ...env,
        hold: true
    });

    //console.log(JSON.stringify(params));

    let scope;
    if (env.scope) scope = {
        ...env.scope
    };
    else scope = {};

    const copy = {
        ...env,
        scope: scope
    };
    for (const p of params) {
        const r = await interpretate(p[2], env);
        copy.scope[p[1]] = () => r;
    }

    return await interpretate(args[1], copy);
}

core.With.update = core.With

core.With.destroy = (args, env) => {
    //destroy params
    interpretate(args[0], env);

    //destory args
    interpretate(args[1], env);
}

core.Map = async(args, env) => {
    const func = args[0];
    const array = await interpretate(args[1], {
        ...env,
        hold: false
    });


    const result = [];

    for (const el of array) {
        result.push(await interpretate([func, ['JSObject', el]], {
            ...env,
            hold: false
        }));
    }

    //if (env.hold) return ["JSObject", result];
    return result;
}

function transpose(matrix) {
    const rows = matrix.length, cols = matrix[0].length;
    const grid = [];
    for (let j = 0; j < cols; j++) {
      grid[j] = Array(rows);
    }
    for (let i = 0; i < rows; i++) {
      for (let j = 0; j < cols; j++) {
        grid[j][i] = matrix[i][j];
      }
    }
    return grid;
  }

core.Transpose = async (args, env) => {
    const array = await interpretate(args[0], env);
    return transpose(array);
}

core.Transpose.update = core.Transpose 

core.White = (args, env) => {
    return interpretate(['RGBColor', 1, 1, 1], env);
}

core.LightBlue = (args, env) => {
    return interpretate(['RGBColor', 0.87, 0.94, 1], env);
}

core.Brown = (args, env) => {
    return interpretate(['RGBColor', 0.6, 0.4, 0.2], env);
}

core.Sqrt = async(args, env) => {
    return Math.sqrt(await interpretate(args[0], env));
}

core.Sqrt.update = core.Sqrt
core.Sqrt.destroy = core.Sqrt

core.Rule = async(args, env) => {
    const key = await interpretate(args[0], env);
    const val = await interpretate(args[1], env)
    if (env.Association) {
        env.Association[key] = val;
        return;
    } else {
        return {
            lhs: key,
            rhs: val
        };
    }
}

core.Identity = async (args, env) => {
    if (!args) return;
    if (args.length)
        return await interpretate(args[0], env);
}

core.Identity.update = core.Identity
core.Identity.destroy = core.Identity

core.Rule.destroy = async(args, env) => {
    const key = await interpretate(args[0], env);
    const val = await interpretate(args[1], env);
}

core.Dynamic = (args, env) => {
    console.warn('Dynamic is not supported! Use Offload keyword');
    interpretate(args[0], env);
}

core.AbsoluteCurrentValue = () => {}

core.Dynamic.update = core.Dynamic
core.Dynamic.destroy = core.Dynamic

core.Pi = () => Math.PI
core.Pi.update = () => Math.PI
core.Pi.destroy = () => {}

core.Norm = async (args, env) => {
    const vector = await interpretate(args[0], env);
    return Math.sqrt(vector.map((el) => el*el).reduce((accumulator, currentValue) => {
    return accumulator + currentValue
  },0));
  }
  
core.Norm.update = core.Norm 

let numerics = {};
//Speeds up by the factor of 60X!!!
numerics.name = "Numerics";
//interpretate.contextExpand(numerics);

core.NumericArray = (args, env) => {
  //const type = interpretate(args[1], env);

  return interpretate(args[0], {...env, context: numerics});
}

core.NumericArray.update = core.NumericArray

numerics.List = (args, env) => {
  return args.map((e) => interpretate(e, env))
}

numerics.List.update = numerics.List

core.ProvidedOptions = async (args, env) => {
    env.options = await core._getRules(args.slice(1), env);
    return await interpretate(args[0], env);
}

core.ProvidedOptions.update = core.ProvidedOptions
core.ProvidedOptions.destroy = core.ProvidedOptions

window.core = core;</script>
<script type="module">core._NotebookUI = true; // detect if you run it on WLJS Frontend
interpretate.throttle = 40;</script>
<script type="module">;;
function __emptyFalse(a) {
  if (a === '') return false;
  return a;
}

function throttle(func, ms) {

  let isThrottled = false,
    savedArgs,
    savedThis;

  function wrapper() {

    if (isThrottled) { // (2)
      savedArgs = arguments;
      savedThis = this;
      return;
    }

    func.apply(this, arguments); // (1)

    isThrottled = true;

    setTimeout(function() {
      isThrottled = false; // (3)
      if (savedArgs) {
        wrapper.apply(savedThis, savedArgs);
        savedArgs = savedThis = null;
      }
    }, ms);
  }

  return wrapper;
}

//CELL TYPES / LANGUAGES
window.SupportedCells = {};
window.SupportedLanguages = [];
//GLobals
window.Extensions = [];

window.CellHashStorage = {};

const CellHash = {
  add: (obj) => {
    CellHashStorage[obj.uid] = obj;
  },

  get: (uid) => {
    return CellHashStorage[uid];
  },

  remove: (uid) => {
    CellHashStorage[uid] = undefined;
  },

}

const Notebook = {};
      Notebook.add = (sign, list) => {
        
        if (sign in Notebook) {
          if (list) Notebook[sign].Cells = list;
          return Notebook[sign];
        }
        Notebook[sign] = {
          element: document.getElementById("container-"+sign),
          Cells: []
        };
        if (list) Notebook[sign].Cells = list;
        return Notebook[sign];
      }

core.CellHash = CellHash;
core.Notebook = Notebook;

let currentCell;

let forceFocusNew = false;
let focusDirection = 1;

const focusable = class {
  origin;
  element;
  handler = {};
  action = {};
  skipOutputs = false;

  constructor(obj) {
    this.origin = obj.origin;
    this.element = obj.element;
    this.handler = obj.handler;

    obj.origin.inner.focusable.push(this);
  }

  findIndex() {
    return this.origin.inner.focusable.indexOf(this)
  }

  focusNext() {
    const i = this.findIndex();
    if (this.origin.inner.focusable.length-1 == i) {
      this.origin.focusNext(this.skipOutputs, i+1);
      return;
    }

    this.origin.inner.focusable[i+1].focus(this.skipOutputs);
  }

  focusPrev() {
    const i = this.findIndex();
    if (i == 0) {
      const prev = this.origin;

      if (prev.display.editor && !prev.invisible && !prev.props["Locked"]) {
        prev.focus(-1);
      } else {
        //go futher
        console.warn('further');
        prev.focusPrev(false, -1);
      }

      return;
    }

    this.origin.inner.focusable[i-1].focus(this.skipOutputs);
  }

  focus(skipOutputs=false, backwards=false) {
    this.skipOutputs = skipOutputs;
    this.backwards = backwards;

    console.log('Focused!');
    if (this.handler.onfocus) this.handler.onfocus(this);
  }

  blur(skipOutputs=false, forced=false) {
    this.skipOutputs = skipOutputs;
    if (this.handler.onblur) this.handler.onblur(this);
  }
}

window.CellWrapper = class {
  uid = ''
  notebook = ''
  type = "Input"
  element;
  inner = {
    focusable: []
  };

  static forceFocusNew = () => {
    forceFocusNew = true;
  }

  static epilog = []
  static prolog = []
  static focusable = focusable

  static remove = (uid, ev) => {
    CellHash.get(uid).dispose();
  }

  static scrollTo = (uid, opts = {}) => {
    CellHash.get(uid).scrollTo(opts);
  }

  static morph = (uid, template, props) => {
    CellHash.get(uid).morph(template, props);
  }

  static setContent = (uid, content) => {
    CellHash.get(uid).setContent(content);
  }

  static toggleCell = (uid) => {
    CellHash.get(uid).toggle(true);
  }

  static vanishCell = (uid) => {
    CellHash.get(uid).vanish();
  }

  static fadeCell = (uid) => {
    CellHash.get(uid).fade(true);
  }

  static lockCell = (uid) => {
    CellHash.get(uid).lock();
  }  

  

  static setInit = (uid, state) => {
    CellHash.get(uid).setInit(state);
  }

  static unhideAll = (nid) => {
    const list = Notebook[nid].Cells; 
    if (!list) return;
    
    list.forEach((h) => {
      const cell = CellHash.get(h);
      if (cell.type == 'Input' && !cell.invisible) {
        cell.toggle(false);
      }
    });
  }

  channel;

  focusNext(skipOutputs = false, findex = 0) {
    //console.log(this.inner.focusable);
    if (this.inner.focusable[findex]) {
      this.inner.focusable[findex].focus(skipOutputs, true);
      return;
    }

    console.log('next');
    console.log('skip outputs?: ', skipOutputs);
    focusDirection = 1;

    const list = Notebook[this.notebook].Cells; 

    const pos = list.indexOf(this.uid);
    if (pos + 1 < list.length) {
      const next = CellHash.get(list[pos + 1]);
      console.log([next.display.editor, (!skipOutputs || (next.type == 'Input')), !next.invisible, !next.props["Locked"]]);
      if (next.display.editor && (!skipOutputs || (next.type == 'Input')) && !next.invisible && !next.props["Locked"]) {
        
        next.focus(1);
      } else {
        //go futher
        next.focusNext();
      }
    } else {
      this.addCellAfter();
    }
  }

  focus(dir) {
    if (!this.display.editor) return;

    const self = this;
    if (self.props["Hidden"] && self.type == 'Input') {
      //temporary unhide it
      self.toggle(false);
      self.display.focus(dir);

      function leftFocus() {
        self.toggle(false);
        self.element.removeEventListener('focusout', leftFocus);
      }

      self.element.addEventListener('focusout', leftFocus);            
    } else if (self.props["Fade"] && self.type == 'Input') {
      //temporary unhide it
      self.fade(false);
      self._fade_block = true;
      self.display.focus(dir);

      function leftFocus() {
        self.fade(false);
        self._fade_block = false;
        self.element.removeEventListener('focusout', leftFocus);
      }

      self.element.addEventListener('focusout', leftFocus);       
    } {
      self.display.focus(dir);
    }
  }

  focusPrev(startpoint, findex = 99) {
    console.log('prev');
    focusDirection = -1;


    const list = Notebook[this.notebook].Cells; 

    const pos = list.indexOf(this.uid);

    if (pos - 1 >= 0) {
      const prev = CellHash.get(list[pos - 1]);

      let _index = findex;
      if (_index == 99) _index = this.inner.focusable.length-1;

      if (prev.inner.focusable[_index]) {
        prev.inner.focusable[_index].focus(false, false);
        return;
      }

      if (prev.display.editor && !prev.invisible && !prev.props["Locked"]) {
        prev.focus(-1);
      } else {
        //go futher
        prev.focusPrev();
      }
      
    }
  }

  vanish() {
    this.group.classList.toggle('invisible-cell');
    if (this.invisible) {
      this.invisible  = false;
      if (this.display.editor) {
        this.display.readOnly(false);
      }       
    } else {
      this.invisible = true;
      if (this.display.editor) {
        this.display.readOnly(true);
      }       
    }
  }

  fade() {
    if (this.type == 'Output') return;
    const wrapper = document.getElementById(this.uid);
    wrapper.classList.toggle('h-fade-20');

    if (!this.props["Fade"]) {
      this.setProp('Fade', true);
    } else {
      this.setProp('Fade', false);
    }    
  }

  lock() {
    if (this.type == 'Output') return;
    const wrapper = document.getElementById(this.uid);
    wrapper.classList.toggle('blur');

    if (!this.props["Locked"]) {
      this.setProp('Locked', true);
      if (this.display.editor) {
        this.display.readOnly(true);
      }
    } else {
      this.setProp('Locked', false);
      if (this.display.editor) {
        this.display.readOnly(false);
      }      
    }    
  }  
  
  toggle(jump = true) {
    if (this.type == 'Output') return;

    const list = Notebook[this.notebook].Cells; 
    const pos = list.indexOf(this.uid);

    if (!(pos + 1 < list.length) && !(this.props["Hidden"] === true)) {
      alert('There are no output cells to be hidden');
      return;
    }
    if (CellHash.get(list[pos + 1]).type != 'Output' && !(this.props["Hidden"] === true)) {
      alert('There are no output cells to be hidden');
      return;
    }

    const wrapper = document.getElementById(this.uid);
    wrapper.classList.toggle('hidden');

    if (!this.props["Hidden"]) {
      this.setProp('Hidden', true);
    } else {
      this.setProp('Hidden', false);
    }

    if (jump) this.focusNext(true);

    return true;
  }

  //private
  _listeners = {}

  _event(type, data) {
    if (this._listeners[type])
      this._listeners[type].forEach((el) => el(data));
  }
  //end of private

  addEventListener(type, handler) {
    if (!Array.isArray(this._listeners[type])) this._listeners[type] = [];
    this._listeners[type].push(handler);
  }

  setProp(key, value) {
    this.props[key] = value;
    const uid = this.uid;
    server.emitt(this.channel, '"'+JSON.stringify({Cell: uid, Key: key, Value: value}).replace(/"/gm, "\\\"")+'"', "SetProperty");
    this._event('property', {key: key, value: value, self:this});
  }

  addCellAfter() {
    server.emitt(this.channel, '"'+this.uid+'"', 'AddAfter');
    this._event('addafter', {uid: this.uid, self:this});
  }

  addCellBefore() {
    server.emitt(this.channel, '"'+this.uid+'"', 'AddBefore');
    this._event('addbefore', {uid: this.uid, self:this});
  }  

  findInput() {
    const self = this;
    if (this.type == 'Input') return self;
    const list = Notebook[this.notebook].Cells;
    return CellHash.get(list[list.indexOf(self.uid)-1]).findInput();
  }

  save(content) {
    //const fixed = content.replaceAll('\\\"', '\\\\\"').replaceAll('\"', '\\"');
    this.throttledSave(content);
    this._event('saved', {uid: this.uid, self:this});
  }
  
  constructor(template, input, list, eventid, meta = {}) {

    this.uid         = input["Hash"];
    this.channel     = eventid;
    //this.state       = input["State"];
    this.type        = input["Type"];
    this.notebook    = input["Notebook"];
    this.invisible   = input["Invisible"];
    this.props       = input["Props"];

    const oldNotebook = (Notebook[input["Notebook"]]);

    let _list = [];
    if (oldNotebook) {
      _list = [...oldNotebook.Cells];
    }

    const notebook = Notebook.add(input["Notebook"], list); 
    const pos  = notebook.Cells.indexOf(this.uid);
    console.log(pos);

     console.log('position: '+ pos);
     console.log(this.uid);
     console.log('in the list');
     console.log(notebook.Cells);

    CellHash.add(this);

    const self = this;

    this.throttledSave = throttle((content) => {
      server.emitt(self.channel, '{"'+self.uid+'","'+(content)+'"}', "UpdateCell");
    }, 300);

    CellWrapper.prolog.forEach((f) => f({cell: self, props: input, event: eventid}));

    if (pos == 0) {
      console.log('First cell!');
      notebook.element.insertAdjacentHTML('beforeend', template);

    } else {
      let next;
      if (!meta["IgnoreList"]) next = notebook.Cells[pos + 1];
    
      let parent = notebook.Cells[pos - 1];  

      if (next) next   = CellHash.get(  next);
                parent = CellHash.get(parent);
      
      if (parent.type == 'Input' && this.type == 'Input') {
        console.log('Insert after input input cell');
        document.getElementById('group-' + parent.uid).insertAdjacentHTML('afterend', template);

        if (next) {
          if (next.type == "Output") {
            //find all kids and move them
            const currentKids = document.getElementById('children-' + this.uid);
            const starting = _list.indexOf(parent.uid);
            let iterator = starting + 1;

            while(iterator < _list.length) {
              const o = CellHash.get(_list[iterator]);
              if (o.type === 'Input') break;

              const node = o.group;
              currentKids.appendChild(node);
              iterator ++ ;
            }
          }
        } 

      } else if (parent.type == 'Input' && this.type == 'Output') {
        console.log('Insert after input output cell');
        document.getElementById('children-' + parent.uid).insertAdjacentHTML('beforeend', template);

      } else if (parent.type == 'Output' && this.type == 'Input') {
        console.log('Insert after output input cell');
        //find input parent first
        const inputparent = parent.findInput();

        if (next) {
          if (next.type == 'Input') {
            document.getElementById('group-' + inputparent.uid).insertAdjacentHTML('afterend', template);
          } else {
            //the most complecated case. We need to break a chain
            console.warn('Restructuring cells...');
            //insert after the parent input firstly
            document.getElementById('group-' + inputparent.uid).insertAdjacentHTML('afterend', template);
            //now we need to move all kids starting from prev

            const currentKids = document.getElementById('children-' + this.uid);
            //move kids starting from ...
            const starting = _list.indexOf(next.uid);
            let iterator = starting;

            while(iterator < _list.length) {
              const o = CellHash.get(_list[iterator]);
              if (o.type === 'Input') break;

              const node = o.group;
              currentKids.appendChild(node);
              iterator ++ ;
            }

          }
        } else {
          document.getElementById('group-' + inputparent.uid).insertAdjacentHTML('afterend', template);
        }

      } else if (parent.type == 'Output' && this.type == 'Output') {
        console.log('Insert after output output cell');
        document.getElementById('group-' + parent.uid).insertAdjacentHTML('afterend', template);

      } else {
        console.error(parent);
        console.error(this);
        throw('Unexpected value!');
      }

      
    }

    this.group       = document.getElementById('group-' + input["Hash"]);

    this.element = document.getElementById(this.uid);
    this.display = new window.SupportedCells[input["Display"]].view(this, input["Data"]);  

    if (!notebook.focusedFirst && meta["FocusFirst"]) {
      if (this.type == 'Input' && this.display.editor && !(this.props["Locked"] || this.invisible || this.props["Hidden"])) {
        notebook.focusedFirst = true;
        this.display.editor.focus();
      }
    }

    if (this.props["Locked"] || this.invisible) {
      if (this.display.editor) {
        this.display.readOnly(true);
      } 
    } 

    if (this.type == 'Input') {
      this.element.addEventListener('focusin', ()=>{
        //call on cell focus event
        server.emitt(self.uid, 'True', 'Focus');
        if (!self._fade_block && self.props["Fade"]) {

          self.fade(true);

          function leftFocus() {
            self.fade(false);
            self.element.removeEventListener('focusout', leftFocus);
          }
    
          self.element.addEventListener('focusout', leftFocus);  
        }
        currentCell = self;
      });
    }

    CellWrapper.epilog.forEach((f) => f({cell: self, props: input, event: eventid}));

    this._event('epilog', {self:this});


    //force focus flag
    if (forceFocusNew && this.type == 'Input') {
      console.warn('focus input cell - i');
      forceFocusNew = false;
      if (this.display?.editor) this.display?.focus(-1);
    }

    //setTimeout(() => self.group.classList.remove('-translate-x-6'), 50);
    
    
    return this;
  }

  setInit(state) {
    const icon = document.getElementById('gi-'+this.uid);
    if (state) {
      icon.classList.remove('hidden');
    } else {
      icon.classList.add('hidden');
    }
  }

  scrollTo(opts = {}) {
    this.element.scrollIntoView(opts)
  }

  setContent(content) {
    
    if (!this.display.editor) return;
    if (this.display.setContent) {
      this.display.setContent(content);
      this._event('contentmutate', {self:this});
    }
  }

  morph(template, input) {
    const notebook = Notebook[this.notebook]; 
    const pos  = notebook.Cells.indexOf(this.uid);
    const inputparent = this.findInput();

    const self = this;
    const eventid = this.channel;

    CellWrapper.prolog.forEach((f) => f({cell: self, props: input, event: eventid, morph: true}));

    const afterInputParent = document.getElementById('group-' + inputparent.uid);
    //temporary move
    afterInputParent.parentNode.appendChild(this.element);
    this.element.id = this.element.id + 'temporal';

    //remove original group
    this.group.remove();

    //add new template on its place
    document.getElementById('group-' + inputparent.uid).insertAdjacentHTML('afterend', template);
    this.group = document.getElementById('group-' + this.uid);

    //insert original into a new container
    const dummy = document.getElementById(this.uid);
    dummy.after(this.element);

    //copy styles
    const templateClass = dummy.className;
    this.element.className = templateClass;

    //remove template's version
    dummy.remove();

    //restore uid
    this.element.id = this.uid;

    //fuckmylife
    //move kids

    const currentKids = document.getElementById('children-' + this.uid);
    //move kids starting from ...
    const starting = notebook.Cells.indexOf(this.uid);
    let iterator = starting + 1;

    while(iterator < notebook.Cells.length) {
      const o = CellHash.get(notebook.Cells[iterator]);
      if (o.type === 'Input') break;

      const node = o.group;
      currentKids.appendChild(node);
      iterator ++ ;
    }

    this.type = 'Input';

    this.element.addEventListener('focusin', ()=>{
      //call on cell focus event
      server.emitt(self.uid, 'True', 'Focus');
      currentCell = self;
    });

    CellWrapper.epilog.forEach((f) => f({cell: self, props: input, event: eventid, morph: true}));
    self.display.editor.focus();
    this._event('morph', {self:this});
  }

  eval(content) {
    if (this.type == "Output") console.warn('Output cell cannot be evaluated, but we will try to convert it');
    server.emitt(this.channel, '"'+this.uid+'"', 'Evaluate');  
    this._event('eval', {self:this});
  }  
  
  dispose() {
    this._event('beforedispose', {self:this});
    const group = this.group;
    group.classList.add('scale-50');

    

    //remove from the list
    const list = Notebook[this.notebook].Cells; 
    const pos = list.indexOf(this.uid);

    list.splice(pos, 1);
    //remove hash
    CellHash.remove(this.uid);

    //remove dom holders
    setTimeout(() => {
      this.display.dispose();
      group.remove();
      this._event('afterdispose', {self:this});
    }, 100);
  }
  
  remove(jump = true, direction = -1) {
    server.emitt(this.channel, '"'+this.uid+'"', 'RemoveCell');
    if (jump) {
      if (this.type == 'Output') {
        if (direction < 0) this.focusPrev(); else this.focusNext();
      } else {
        if (direction < 0) {
          this.focusPrev();
        } else {
          this.focusNext(true);
        }
      }
    }
  }


};;


window.WindowWrapper = class {
  uid = ''
  element;
  notebook = '';

  channel;

  focus() {
    if (!this.display.editor) return;
    this.display.editor.focus();
  }
  
  constructor(template, input, list, eventid, meta = {}) {

    this.uid         = input["Hash"];
    this.channel     = eventid;
    this.state       = input["State"];
    this.type        = input["Type"];
    this.notebook    = input["Notebook"];

    const self = this;

    const notebook = Notebook.add(input["Notebook"], {}); 

    this.throttledSave = throttle((content) => {
      console.warn('editing inside window is not permitted');
    }, 150);

    notebook.element.innerHTML = "";
    notebook.element.insertAdjacentHTML('beforeend', template);

    this.group       = document.getElementById('group-' + input["Hash"]);

    this.element = document.getElementById(this.uid);
    this.display = new window.SupportedCells[input["Display"]].view(this, input["Data"]);  

    //if (this.type == 'Input') {
      this.element.addEventListener('focusin', ()=>{
        //call on cell focus event
        server.emitt(self.uid, 'True', 'Focus');
        currentCell = self;
      });
    //}

    //CellWrapper.epilog.forEach((f) => f({cell: self, props: input, event: eventid}));

    //global JS event
    const newCellEvent = new CustomEvent("newWindowCreated", { detail: self });
    window.dispatchEvent(newCellEvent);

    //setTimeout(() => self.group.classList.remove('-translate-x-6'), 50);
    return this;
  }
}</script>
<script type="module">function e(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let t={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function r(e){t=e}const n=/[&<>"']/,a=new RegExp(n.source,"g"),i=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,s=new RegExp(i.source,"g"),o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},l=e=>o[e];function h(e,t){if(t){if(n.test(e))return e.replace(a,l)}else if(i.test(e))return e.replace(s,l);return e}const c=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function p(e){return e.replace(c,((e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const m=/(^|[^\[])\^/g;function u(e,t){let r="string"==typeof e?e:e.source;t=t||"";const n={replace:(e,t)=>{let a="string"==typeof t?t:t.source;return a=a.replace(m,"$1"),r=r.replace(e,a),n},getRegex:()=>new RegExp(r,t)};return n}function d(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch(e){return null}return e}const g={exec:()=>null};function f(e,t){const r=e.replace(/\|/g,((e,t,r)=>{let n=!1,a=t;for(;--a>=0&&"\\"===r[a];)n=!n;return n?"|":" |"})).split(/ \|/);let n=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(/\\\|/g,"|");return r}function b(e,t,r){const n=e.length;if(0===n)return"";let a=0;for(;a<n;){const i=e.charAt(n-a-1);if(i!==t||r){if(i===t||!r)break;a++}else a++}return e.slice(0,n-a)}function v(e,t,r,n){const a=t.href,i=t.title?h(t.title):null,s=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){n.state.inLink=!0;const e={type:"link",raw:r,href:a,title:i,text:s,tokens:n.inlineTokens(s)};return n.state.inLink=!1,e}return{type:"image",raw:r,href:a,title:i,text:h(s)}}class x{options;rules;lexer;constructor(e){this.options=e||t}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:b(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],r=function(e,t){const r=e.match(/^(\s+)(?:```)/);if(null===r)return t;const n=r[1];return t.split("\n").map((e=>{const t=e.match(/^\s+/);if(null===t)return e;const[r]=t;return r.length>=n.length?e.slice(n.length):e})).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){const t=b(e,"#");this.options.pedantic?e=t.trim():t&&!/ $/.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const e=b(t[0].replace(/^ *>[ \t]?/gm,""),"\n"),r=this.lexer.state.top;this.lexer.state.top=!0;const n=this.lexer.blockTokens(e);return this.lexer.state.top=r,{type:"blockquote",raw:t[0],tokens:n,text:e}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const n=r.length>1,a={type:"list",raw:"",ordered:n,start:n?+r.slice(0,-1):"",loose:!1,items:[]};r=n?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=n?r:"[*+-]");const i=new RegExp(`^( {0,3}${r})((?:[\t ][^\\n]*)?(?:\\n|$))`);let s="",o="",l=!1;for(;e;){let r=!1;if(!(t=i.exec(e)))break;if(this.rules.block.hr.test(e))break;s=t[0],e=e.substring(s.length);let n=t[2].split("\n",1)[0].replace(/^\t+/,(e=>" ".repeat(3*e.length))),h=e.split("\n",1)[0],c=0;this.options.pedantic?(c=2,o=n.trimStart()):(c=t[2].search(/[^ ]/),c=c>4?1:c,o=n.slice(c),c+=t[1].length);let p=!1;if(!n&&/^ *$/.test(h)&&(s+=h+"\n",e=e.substring(h.length+1),r=!0),!r){const t=new RegExp(`^ {0,${Math.min(3,c-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),r=new RegExp(`^ {0,${Math.min(3,c-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),a=new RegExp(`^ {0,${Math.min(3,c-1)}}(?:\`\`\`|~~~)`),i=new RegExp(`^ {0,${Math.min(3,c-1)}}#`);for(;e;){const l=e.split("\n",1)[0];if(h=l,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),a.test(h))break;if(i.test(h))break;if(t.test(h))break;if(r.test(e))break;if(h.search(/[^ ]/)>=c||!h.trim())o+="\n"+h.slice(c);else{if(p)break;if(n.search(/[^ ]/)>=4)break;if(a.test(n))break;if(i.test(n))break;if(r.test(n))break;o+="\n"+h}p||h.trim()||(p=!0),s+=l+"\n",e=e.substring(l.length+1),n=h.slice(c)}}a.loose||(l?a.loose=!0:/\n *\n *$/.test(s)&&(l=!0));let m,u=null;this.options.gfm&&(u=/^\[[ xX]\] /.exec(o),u&&(m="[ ] "!==u[0],o=o.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:s,task:!!u,checked:m,loose:!1,text:o,tokens:[]}),a.raw+=s}a.items[a.items.length-1].raw=s.trimEnd(),a.items[a.items.length-1].text=o.trimEnd(),a.raw=a.raw.trimEnd();for(let e=0;e<a.items.length;e++)if(this.lexer.state.top=!1,a.items[e].tokens=this.lexer.blockTokens(a.items[e].text,[]),!a.loose){const t=a.items[e].tokens.filter((e=>"space"===e.type)),r=t.length>0&&t.some((e=>/\n.*\n/.test(e.raw)));a.loose=r}if(a.loose)for(let e=0;e<a.items.length;e++)a.items[e].loose=!0;return a}}html(e){const t=this.rules.block.html.exec(e);if(t){return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:r,title:n}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!/[:|]/.test(t[2]))return;const r=f(t[1]),n=t[2].replace(/^\||\| *$/g,"").split("|"),a=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===n.length){for(const e of n)/^ *-+: *$/.test(e)?i.align.push("right"):/^ *:-+: *$/.test(e)?i.align.push("center"):/^ *:-+ *$/.test(e)?i.align.push("left"):i.align.push(null);for(const e of r)i.header.push({text:e,tokens:this.lexer.inline(e)});for(const e of a)i.rows.push(f(e,i.header.length).map((e=>({text:e,tokens:this.lexer.inline(e)}))));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:h(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;const t=b(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let r=0;for(let n=0;n<e.length;n++)if("\\"===e[n])n++;else if(e[n]===t[0])r++;else if(e[n]===t[1]&&(r--,r<0))return n;return-1}(t[2],"()");if(e>-1){const r=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,r).trim(),t[3]=""}}let r=t[2],n="";if(this.options.pedantic){const e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);e&&(r=e[1],n=e[3])}else n=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(r=this.options.pedantic&&!/>$/.test(e)?r.slice(1):r.slice(1,-1)),v(t,{href:r?r.replace(this.rules.inline.anyPunctuation,"$1"):r,title:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){const e=t[(r[2]||r[1]).replace(/\s+/g," ").toLowerCase()];if(!e){const e=r[0].charAt(0);return{type:"text",raw:e,text:e}}return v(r,e,r[0],this.lexer)}}emStrong(e,t,r=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(!n)return;if(n[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(n[1]||n[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const r=[...n[0]].length-1;let a,i,s=r,o=0;const l="*"===n[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+r);null!=(n=l.exec(t));){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(i=[...a].length,n[3]||n[4]){s+=i;continue}if((n[5]||n[6])&&r%3&&!((r+i)%3)){o+=i;continue}if(s-=i,s>0)continue;i=Math.min(i,i+s+o);const t=[...n[0]][0].length,l=e.slice(0,r+n.index+t+i);if(Math.min(r,i)%2){const e=l.slice(1,-1);return{type:"em",raw:l,text:e,tokens:this.lexer.inlineTokens(e)}}const h=l.slice(2,-2);return{type:"strong",raw:l,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," ");const r=/[^ ]/.test(e),n=/^ /.test(e)&&/ $/.test(e);return r&&n&&(e=e.substring(1,e.length-1)),e=h(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,r;return"@"===t[2]?(e=h(t[1]),r="mailto:"+e):(e=h(t[1]),r=e),{type:"link",raw:t[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,r;if("@"===t[2])e=h(t[0]),r="mailto:"+e;else{let n;do{n=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(n!==t[0]);e=h(t[0]),r="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let e;return e=this.lexer.state.inRawBlock?t[0]:h(t[0]),{type:"text",raw:t[0],text:e}}}}const y=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,w=/(?:[*+-]|\d{1,9}[.)])/,k=u(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,w).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),S=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,z=/(?!\s*\])(?:\\.|[^\[\]\\])+/,M=u(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",z).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),T=u(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,w).getRegex(),A="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",B=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,C=u("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",B).replace("tag",A).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),q=u(S).replace("hr",y).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",A).getRegex(),N={blockquote:u(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",q).getRegex(),code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,def:M,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:y,html:C,lheading:k,list:T,newline:/^(?: *(?:\n|$))+/,paragraph:q,table:g,text:/^[^\n]+/},R=u("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",y).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",A).getRegex(),I={...N,table:R,paragraph:u(S).replace("hr",y).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",R).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",A).getRegex()},E={...N,html:u("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",B).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:g,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:u(S).replace("hr",y).replace("heading"," *#{1,6} *[^\n]").replace("lheading",k).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},H=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,O=/^( {2,}|\\)\n(?!\s*$)/,L="\\p{P}\\p{S}",D=u(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,L).getRegex(),P=u(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,L).getRegex(),$=u("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,L).getRegex(),V=u("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,L).getRegex(),F=u(/\\([punct])/,"gu").replace(/punct/g,L).getRegex(),_=u(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),G=u(B).replace("(?:--\x3e|$)","--\x3e").getRegex(),U=u("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",G).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),X=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Y=u(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",X).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),W=u(/^!?\[(label)\]\[(ref)\]/).replace("label",X).replace("ref",z).getRegex(),Z=u(/^!?\[(ref)\](?:\[\])?/).replace("ref",z).getRegex(),j={_backpedal:g,anyPunctuation:F,autolink:_,blockSkip:/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,br:O,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:g,emStrongLDelim:P,emStrongRDelimAst:$,emStrongRDelimUnd:V,escape:H,link:Y,nolink:Z,punctuation:D,reflink:W,reflinkSearch:u("reflink|nolink(?!\\()","g").replace("reflink",W).replace("nolink",Z).getRegex(),tag:U,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:g},K={...j,link:u(/^!?\[(label)\]\((.*?)\)/).replace("label",X).getRegex(),reflink:u(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",X).getRegex()},Q={...j,escape:u(H).replace("])","~|])").getRegex(),url:u(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},J={...Q,br:u(O).replace("{2,}","*").getRegex(),text:u(Q.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ee={normal:N,gfm:I,pedantic:E},te={normal:j,gfm:Q,breaks:J,pedantic:K};class re{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||t,this.options.tokenizer=this.options.tokenizer||new x,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const r={block:ee.normal,inline:te.normal};this.options.pedantic?(r.block=ee.pedantic,r.inline=te.pedantic):this.options.gfm&&(r.block=ee.gfm,this.options.breaks?r.inline=te.breaks:r.inline=te.gfm),this.tokenizer.rules=r}static get rules(){return{block:ee,inline:te}}static lex(e,t){return new re(t).lex(e)}static lexInline(e,t){return new re(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){let r,n,a,i;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,((e,t,r)=>t+"    ".repeat(r.length)));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0)))))if(r=this.tokenizer.space(e))e=e.substring(r.raw.length),1===r.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(r);else if(r=this.tokenizer.code(e))e=e.substring(r.raw.length),n=t[t.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?t.push(r):(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text);else if(r=this.tokenizer.fences(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.heading(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.hr(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.blockquote(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.list(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.html(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.def(e))e=e.substring(r.raw.length),n=t[t.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title}):(n.raw+="\n"+r.raw,n.text+="\n"+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text);else if(r=this.tokenizer.table(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.lheading(e))e=e.substring(r.raw.length),t.push(r);else{if(a=e,this.options.extensions&&this.options.extensions.startBlock){let t=1/0;const r=e.slice(1);let n;this.options.extensions.startBlock.forEach((e=>{n=e.call({lexer:this},r),"number"==typeof n&&n>=0&&(t=Math.min(t,n))})),t<1/0&&t>=0&&(a=e.substring(0,t+1))}if(this.state.top&&(r=this.tokenizer.paragraph(a)))n=t[t.length-1],i&&"paragraph"===n.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(r),i=a.length!==e.length,e=e.substring(r.raw.length);else if(r=this.tokenizer.text(e))e=e.substring(r.raw.length),n=t[t.length-1],n&&"text"===n.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(r);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,n,a,i,s,o,l=e;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(i=this.tokenizer.rules.inline.reflinkSearch.exec(l));)e.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(i=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(i=this.tokenizer.rules.inline.anyPunctuation.exec(l));)l=l.slice(0,i.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(s||(o=""),s=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0)))))if(r=this.tokenizer.escape(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.tag(e))e=e.substring(r.raw.length),n=t[t.length-1],n&&"text"===r.type&&"text"===n.type?(n.raw+=r.raw,n.text+=r.text):t.push(r);else if(r=this.tokenizer.link(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(r.raw.length),n=t[t.length-1],n&&"text"===r.type&&"text"===n.type?(n.raw+=r.raw,n.text+=r.text):t.push(r);else if(r=this.tokenizer.emStrong(e,l,o))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.codespan(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.br(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.del(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.autolink(e))e=e.substring(r.raw.length),t.push(r);else if(this.state.inLink||!(r=this.tokenizer.url(e))){if(a=e,this.options.extensions&&this.options.extensions.startInline){let t=1/0;const r=e.slice(1);let n;this.options.extensions.startInline.forEach((e=>{n=e.call({lexer:this},r),"number"==typeof n&&n>=0&&(t=Math.min(t,n))})),t<1/0&&t>=0&&(a=e.substring(0,t+1))}if(r=this.tokenizer.inlineText(a))e=e.substring(r.raw.length),"_"!==r.raw.slice(-1)&&(o=r.raw.slice(-1)),s=!0,n=t[t.length-1],n&&"text"===n.type?(n.raw+=r.raw,n.text+=r.text):t.push(r);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}else e=e.substring(r.raw.length),t.push(r);return t}}class ne{options;constructor(e){this.options=e||t}code(e,t,r){const n=(t||"").match(/^\S*/)?.[0];return e=e.replace(/\n$/,"")+"\n",n?'<pre><code class="language-'+h(n)+'">'+(r?e:h(e,!0))+"</code></pre>\n":"<pre><code>"+(r?e:h(e,!0))+"</code></pre>\n"}blockquote(e){return`<blockquote>\n${e}</blockquote>\n`}html(e,t){return e}heading(e,t,r){return`<h${t}>${e}</h${t}>\n`}hr(){return"<hr>\n"}list(e,t,r){const n=t?"ol":"ul";return"<"+n+(t&&1!==r?' start="'+r+'"':"")+">\n"+e+"</"+n+">\n"}listitem(e,t,r){return`<li>${e}</li>\n`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>\n`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return`<tr>\n${e}</tr>\n`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>\n`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,r){const n=d(e);if(null===n)return r;let a='<a href="'+(e=n)+'"';return t&&(a+=' title="'+t+'"'),a+=">"+r+"</a>",a}image(e,t,r){const n=d(e);if(null===n)return r;let a=`<img src="${e=n}" alt="${r}"`;return t&&(a+=` title="${t}"`),a+=">",a}text(e){return e}}class ae{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}}class ie{options;renderer;textRenderer;constructor(e){this.options=e||t,this.options.renderer=this.options.renderer||new ne,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ae}static parse(e,t){return new ie(t).parse(e)}static parseInline(e,t){return new ie(t).parseInline(e)}parse(e,t=!0){let r="";for(let n=0;n<e.length;n++){const a=e[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const e=a,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){r+=t||"";continue}}switch(a.type){case"space":continue;case"hr":r+=this.renderer.hr();continue;case"heading":{const e=a;r+=this.renderer.heading(this.parseInline(e.tokens),e.depth,p(this.parseInline(e.tokens,this.textRenderer)));continue}case"code":{const e=a;r+=this.renderer.code(e.text,e.lang,!!e.escaped);continue}case"table":{const e=a;let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.renderer.tablecell(this.parseInline(e.header[t].tokens),{header:!0,align:e.align[t]});t+=this.renderer.tablerow(n);let i="";for(let t=0;t<e.rows.length;t++){const r=e.rows[t];n="";for(let t=0;t<r.length;t++)n+=this.renderer.tablecell(this.parseInline(r[t].tokens),{header:!1,align:e.align[t]});i+=this.renderer.tablerow(n)}r+=this.renderer.table(t,i);continue}case"blockquote":{const e=a,t=this.parse(e.tokens);r+=this.renderer.blockquote(t);continue}case"list":{const e=a,t=e.ordered,n=e.start,i=e.loose;let s="";for(let t=0;t<e.items.length;t++){const r=e.items[t],n=r.checked,a=r.task;let o="";if(r.task){const e=this.renderer.checkbox(!!n);i?r.tokens.length>0&&"paragraph"===r.tokens[0].type?(r.tokens[0].text=e+" "+r.tokens[0].text,r.tokens[0].tokens&&r.tokens[0].tokens.length>0&&"text"===r.tokens[0].tokens[0].type&&(r.tokens[0].tokens[0].text=e+" "+r.tokens[0].tokens[0].text)):r.tokens.unshift({type:"text",text:e+" "}):o+=e+" "}o+=this.parse(r.tokens,i),s+=this.renderer.listitem(o,a,!!n)}r+=this.renderer.list(s,t,n);continue}case"html":{const e=a;r+=this.renderer.html(e.text,e.block);continue}case"paragraph":{const e=a;r+=this.renderer.paragraph(this.parseInline(e.tokens));continue}case"text":{let i=a,s=i.tokens?this.parseInline(i.tokens):i.text;for(;n+1<e.length&&"text"===e[n+1].type;)i=e[++n],s+="\n"+(i.tokens?this.parseInline(i.tokens):i.text);r+=t?this.renderer.paragraph(s):s;continue}default:{const e='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let n=0;n<e.length;n++){const a=e[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const e=this.options.extensions.renderers[a.type].call({parser:this},a);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=e||"";continue}}switch(a.type){case"escape":{const e=a;r+=t.text(e.text);break}case"html":{const e=a;r+=t.html(e.text);break}case"link":{const e=a;r+=t.link(e.href,e.title,this.parseInline(e.tokens,t));break}case"image":{const e=a;r+=t.image(e.href,e.title,e.text);break}case"strong":{const e=a;r+=t.strong(this.parseInline(e.tokens,t));break}case"em":{const e=a;r+=t.em(this.parseInline(e.tokens,t));break}case"codespan":{const e=a;r+=t.codespan(e.text);break}case"br":r+=t.br();break;case"del":{const e=a;r+=t.del(this.parseInline(e.tokens,t));break}case"text":{const e=a;r+=t.text(e.text);break}default:{const e='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return r}}class se{options;constructor(e){this.options=e||t}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}class oe{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.#e(re.lex,ie.parse);parseInline=this.#e(re.lexInline,ie.parseInline);Parser=ie;Renderer=ne;TextRenderer=ae;Lexer=re;Tokenizer=x;Hooks=se;constructor(...e){this.use(...e)}walkTokens(e,t){let r=[];for(const n of e)switch(r=r.concat(t.call(this,n)),n.type){case"table":{const e=n;for(const n of e.header)r=r.concat(this.walkTokens(n.tokens,t));for(const n of e.rows)for(const e of n)r=r.concat(this.walkTokens(e.tokens,t));break}case"list":{const e=n;r=r.concat(this.walkTokens(e.items,t));break}default:{const e=n;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach((n=>{const a=e[n].flat(1/0);r=r.concat(this.walkTokens(a,t))})):e.tokens&&(r=r.concat(this.walkTokens(e.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach((e=>{const r={...e};if(r.async=this.defaults.async||r.async||!1,e.extensions&&(e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const r=t.renderers[e.name];t.renderers[e.name]=r?function(...t){let n=e.renderer.apply(this,t);return!1===n&&(n=r.apply(this,t)),n}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const r=t[e.level];r?r.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),r.extensions=t),e.renderer){const t=this.defaults.renderer||new ne(this.defaults);for(const r in e.renderer){if(!(r in t))throw new Error(`renderer '${r}' does not exist`);if("options"===r)continue;const n=r,a=e.renderer[n],i=t[n];t[n]=(...e)=>{let r=a.apply(t,e);return!1===r&&(r=i.apply(t,e)),r||""}}r.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new x(this.defaults);for(const r in e.tokenizer){if(!(r in t))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;const n=r,a=e.tokenizer[n],i=t[n];t[n]=(...e)=>{let r=a.apply(t,e);return!1===r&&(r=i.apply(t,e)),r}}r.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new se;for(const r in e.hooks){if(!(r in t))throw new Error(`hook '${r}' does not exist`);if("options"===r)continue;const n=r,a=e.hooks[n],i=t[n];se.passThroughHooks.has(r)?t[n]=e=>{if(this.defaults.async)return Promise.resolve(a.call(t,e)).then((e=>i.call(t,e)));const r=a.call(t,e);return i.call(t,r)}:t[n]=(...e)=>{let r=a.apply(t,e);return!1===r&&(r=i.apply(t,e)),r}}r.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,n=e.walkTokens;r.walkTokens=function(e){let r=[];return r.push(n.call(this,e)),t&&(r=r.concat(t.call(this,e))),r}}this.defaults={...this.defaults,...r}})),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return re.lex(e,t??this.defaults)}parser(e,t){return ie.parse(e,t??this.defaults)}#e(e,t){return(r,n)=>{const a={...n},i={...this.defaults,...a};!0===this.defaults.async&&!1===a.async&&(i.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),i.async=!0);const s=this.#t(!!i.silent,!!i.async);if(null==r)return s(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof r)return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(i.hooks&&(i.hooks.options=i),i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(r):r).then((t=>e(t,i))).then((e=>i.hooks?i.hooks.processAllTokens(e):e)).then((e=>i.walkTokens?Promise.all(this.walkTokens(e,i.walkTokens)).then((()=>e)):e)).then((e=>t(e,i))).then((e=>i.hooks?i.hooks.postprocess(e):e)).catch(s);try{i.hooks&&(r=i.hooks.preprocess(r));let n=e(r,i);i.hooks&&(n=i.hooks.processAllTokens(n)),i.walkTokens&&this.walkTokens(n,i.walkTokens);let a=t(n,i);return i.hooks&&(a=i.hooks.postprocess(a)),a}catch(e){return s(e)}}}#t(e,t){return r=>{if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+h(r.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(r);throw r}}}const le=new oe;function he(e,t){return le.parse(e,t)}he.options=he.setOptions=function(e){return le.setOptions(e),he.defaults=le.defaults,r(he.defaults),he},he.getDefaults=e,he.defaults=t,he.use=function(...e){return le.use(...e),he.defaults=le.defaults,r(he.defaults),he},he.walkTokens=function(e,t){return le.walkTokens(e,t)},he.parseInline=le.parseInline,he.Parser=ie,he.parser=ie.parse,he.Renderer=ne,he.TextRenderer=ae,he.Lexer=re,he.lexer=re.lex,he.Tokenizer=x,he.Hooks=se,he.parse=he,he.options,he.setOptions,he.use,he.walkTokens,he.parseInline,ie.parse,re.lex;class ce{constructor(e,t,r){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=e,this.start=t,this.end=r}static range(e,t){return t?e&&e.loc&&t.loc&&e.loc.lexer===t.loc.lexer?new ce(e.loc.lexer,e.loc.start,t.loc.end):null:e&&e.loc}}class pe{constructor(e,t){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=e,this.loc=t}range(e,t){return new pe(t,ce.range(this,e))}}class me{constructor(e,t){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;var r,n,a="KaTeX parse error: "+e,i=t&&t.loc;if(i&&i.start<=i.end){var s=i.lexer.input;r=i.start,n=i.end,r===s.length?a+=" at end of input: ":a+=" at position "+(r+1)+": ";var o=s.slice(r,n).replace(/[^]/g,"$&̲");a+=(r>15?"…"+s.slice(r-15,r):s.slice(0,r))+o+(n+15<s.length?s.slice(n,n+15)+"…":s.slice(n))}var l=new Error(a);return l.name="ParseError",l.__proto__=me.prototype,l.position=r,null!=r&&null!=n&&(l.length=n-r),l.rawMessage=e,l}}me.prototype.__proto__=Error.prototype;var ue=/([A-Z])/g,de={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},ge=/[&><"']/g;var fe=function e(t){return"ordgroup"===t.type||"color"===t.type?1===t.body.length?e(t.body[0]):t:"font"===t.type?e(t.body):t},be={contains:function(e,t){return-1!==e.indexOf(t)},deflt:function(e,t){return void 0===e?t:e},escape:function(e){return String(e).replace(ge,(e=>de[e]))},hyphenate:function(e){return e.replace(ue,"-$1").toLowerCase()},getBaseElem:fe,isCharacterBox:function(e){var t=fe(e);return"mathord"===t.type||"textord"===t.type||"atom"===t.type},protocolFromUrl:function(e){var t=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(e);return t?":"!==t[2]?null:/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(t[1])?t[1].toLowerCase():null:"_relative"}},ve={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:e=>"#"+e},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(e,t)=>(t.push(e),t)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:e=>Math.max(0,e),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:e=>Math.max(0,e),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:e=>Math.max(0,e),cli:"-e, --max-expand <n>",cliProcessor:e=>"Infinity"===e?1/0:parseInt(e)},globalGroup:{type:"boolean",cli:!1}};function xe(e){if(e.default)return e.default;var t=e.type,r=Array.isArray(t)?t[0]:t;if("string"!=typeof r)return r.enum[0];switch(r){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class ye{constructor(e){for(var t in this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,e=e||{},ve)if(ve.hasOwnProperty(t)){var r=ve[t];this[t]=void 0!==e[t]?r.processor?r.processor(e[t]):e[t]:xe(r)}}reportNonstrict(e,t,r){var n=this.strict;if("function"==typeof n&&(n=n(e,t,r)),n&&"ignore"!==n){if(!0===n||"error"===n)throw new me("LaTeX-incompatible input and strict mode is set to 'error': "+t+" ["+e+"]",r);"warn"===n?"undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+t+" ["+e+"]"):"undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to unrecognized '"+n+"': "+t+" ["+e+"]")}}useStrictBehavior(e,t,r){var n=this.strict;if("function"==typeof n)try{n=n(e,t,r)}catch(e){n="error"}return!(!n||"ignore"===n)&&(!0===n||"error"===n||("warn"===n?("undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+t+" ["+e+"]"),!1):("undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to unrecognized '"+n+"': "+t+" ["+e+"]"),!1)))}isTrusted(e){if(e.url&&!e.protocol){var t=be.protocolFromUrl(e.url);if(null==t)return!1;e.protocol=t}var r="function"==typeof this.trust?this.trust(e):this.trust;return Boolean(r)}}class we{constructor(e,t,r){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=e,this.size=t,this.cramped=r}sup(){return ke[Se[this.id]]}sub(){return ke[ze[this.id]]}fracNum(){return ke[Me[this.id]]}fracDen(){return ke[Te[this.id]]}cramp(){return ke[Ae[this.id]]}text(){return ke[Be[this.id]]}isTight(){return this.size>=2}}var ke=[new we(0,0,!1),new we(1,0,!0),new we(2,1,!1),new we(3,1,!0),new we(4,2,!1),new we(5,2,!0),new we(6,3,!1),new we(7,3,!0)],Se=[4,5,4,5,6,7,6,7],ze=[5,5,5,5,7,7,7,7],Me=[2,3,4,5,6,7,6,7],Te=[3,3,5,5,7,7,7,7],Ae=[1,1,3,3,5,5,7,7],Be=[0,1,2,3,2,3,2,3],Ce={DISPLAY:ke[0],TEXT:ke[2],SCRIPT:ke[4],SCRIPTSCRIPT:ke[6]},qe=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];var Ne=[];function Re(e){for(var t=0;t<Ne.length;t+=2)if(e>=Ne[t]&&e<=Ne[t+1])return!0;return!1}qe.forEach((e=>e.blocks.forEach((e=>Ne.push(...e)))));var Ie=80,Ee={doubleleftarrow:"M262 157\nl10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3\n 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28\n 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5\nc2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5\n 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87\n-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7\n-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z\nm8 0v40h399730v-40zm0 194v40h399730v-40z",doublerightarrow:"M399738 392l\n-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5\n 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88\n-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68\n-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18\n-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782\nc-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3\n-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z",leftarrow:"M400000 241H110l3-3c68.7-52.7 113.7-120\n 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8\n-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247\nc-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208\n 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3\n 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202\n l-3-3h399890zM100 241v40h399900v-40z",leftbrace:"M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z",leftbraceunder:"M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z",leftgroup:"M400000 80\nH435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0\n 435 0h399565z",leftgroupunder:"M400000 262\nH435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219\n 435 219h399565z",leftharpoon:"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3\n-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5\n-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7\n-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z",leftharpoonplus:"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5\n 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3\n-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7\n-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z\nm0 0v40h400000v-40z",leftharpoondown:"M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333\n 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5\n 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667\n-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z",leftharpoondownplus:"M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12\n 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7\n-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0\nv40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z",lefthook:"M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5\n-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3\n-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21\n 71.5 23h399859zM103 281v-40h399897v40z",leftlinesegment:"M40 281 V428 H0 V94 H40 V241 H400000 v40z\nM40 281 V428 H0 V94 H40 V241 H400000 v40z",leftmapsto:"M40 281 V448H0V74H40V241H400000v40z\nM40 281 V448H0V74H40V241H400000v40z",leftToFrom:"M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23\n-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8\nc28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3\n 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z",longequal:"M0 50 h400000 v40H0z m0 194h40000v40H0z\nM0 50 h400000 v40H0z m0 194h40000v40H0z",midbrace:"M200428 334\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z",midbraceunder:"M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z",oiintSize1:"M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6\n-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z\nm368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8\n60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z",oiintSize2:"M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8\n-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z\nm502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2\nc0 110 84 276 504 276s502.4-166 502.4-276z",oiiintSize1:"M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6\n-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z\nm525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0\n85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z",oiiintSize2:"M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8\n-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z\nm770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1\nc0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z",rightarrow:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z",rightbrace:"M400000 542l\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z",rightbraceunder:"M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z",rightgroup:"M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0\n 3-1 3-3v-38c-76-158-257-219-435-219H0z",rightgroupunder:"M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18\n 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z",rightharpoon:"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3\n-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2\n-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58\n 69.2 92 94.5zm0 0v40h399900v-40z",rightharpoonplus:"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11\n-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7\n 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z\nm0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z",rightharpoondown:"M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8\n 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5\n-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95\n-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z",rightharpoondownplus:"M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8\n 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3\n 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3\n-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z\nm0-194v40h400000v-40zm0 0v40h400000v-40z",righthook:"M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3\n 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0\n-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21\n 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z",rightlinesegment:"M399960 241 V94 h40 V428 h-40 V281 H0 v-40z\nM399960 241 V94 h40 V428 h-40 V281 H0 v-40z",rightToFrom:"M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23\n 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32\n-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142\n-167z M100 147v40h399900v-40zM0 341v40h399900v-40z",twoheadleftarrow:"M0 167c68 40\n 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69\n-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3\n-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19\n-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101\n 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z",twoheadrightarrow:"M400000 167\nc-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3\n 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42\n 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333\n-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70\n 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z",tilde1:"M200 55.538c-77 0-168 73.953-177 73.953-3 0-7\n-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0\n 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0\n 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128\n-68.267.847-113-73.952-191-73.952z",tilde2:"M344 55.266c-142 0-300.638 81.316-311.5 86.418\n-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9\n 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114\nc1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751\n 181.476 676 181.476c-149 0-189-126.21-332-126.21z",tilde3:"M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457\n-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0\n 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697\n 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696\n -338 0-409-156.573-744-156.573z",tilde4:"M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345\n-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409\n 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9\n 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409\n -175.236-744-175.236z",vec:"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z",widehat1:"M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z",widehat2:"M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widehat3:"M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widehat4:"M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widecheck1:"M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,\n-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z",widecheck2:"M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",widecheck3:"M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",widecheck4:"M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",baraboveleftarrow:"M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202\nc4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5\nc-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130\ns-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47\n121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6\ns2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11\nc0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z\nM100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z",rightarrowabovebar:"M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32\n-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0\n13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39\n-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5\n-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z",baraboveshortleftharpoon:"M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17\nc2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21\nc-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40\nc-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z\nM0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z",rightharpoonaboveshortbar:"M0,241 l0,40c399126,0,399993,0,399993,0\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\nM0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z",shortbaraboveleftharpoon:"M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,\n1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,\n-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z\nM93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z",shortrightharpoonabovebar:"M53,241l0,40c398570,0,399437,0,399437,0\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\nM500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z"};class He{constructor(e){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=e,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(e){return be.contains(this.classes,e)}toNode(){for(var e=document.createDocumentFragment(),t=0;t<this.children.length;t++)e.appendChild(this.children[t].toNode());return e}toMarkup(){for(var e="",t=0;t<this.children.length;t++)e+=this.children[t].toMarkup();return e}toText(){return this.children.map((e=>e.toText())).join("")}}var Oe={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},Le={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},De={"Å":"A","Ð":"D","Þ":"o","å":"a","ð":"d","þ":"o","А":"A","Б":"B","В":"B","Г":"F","Д":"A","Е":"E","Ж":"K","З":"3","И":"N","Й":"N","К":"K","Л":"N","М":"M","Н":"H","О":"O","П":"N","Р":"P","С":"C","Т":"T","У":"y","Ф":"O","Х":"X","Ц":"U","Ч":"h","Ш":"W","Щ":"W","Ъ":"B","Ы":"X","Ь":"B","Э":"3","Ю":"X","Я":"R","а":"a","б":"b","в":"a","г":"r","д":"y","е":"e","ж":"m","з":"e","и":"n","й":"n","к":"n","л":"n","м":"m","н":"n","о":"o","п":"n","р":"p","с":"c","т":"o","у":"y","ф":"b","х":"x","ц":"n","ч":"n","ш":"w","щ":"w","ъ":"a","ы":"m","ь":"a","э":"e","ю":"m","я":"r"};function Pe(e,t,r){if(!Oe[t])throw new Error("Font metrics not found for font: "+t+".");var n=e.charCodeAt(0),a=Oe[t][n];if(!a&&e[0]in De&&(n=De[e[0]].charCodeAt(0),a=Oe[t][n]),a||"text"!==r||Re(n)&&(a=Oe[t][77]),a)return{depth:a[0],height:a[1],italic:a[2],skew:a[3],width:a[4]}}var $e={};var Ve=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],Fe=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],_e=function(e,t){return t.size<2?e:Ve[e-1][t.size-1]};class Ge{constructor(e){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=e.style,this.color=e.color,this.size=e.size||Ge.BASESIZE,this.textSize=e.textSize||this.size,this.phantom=!!e.phantom,this.font=e.font||"",this.fontFamily=e.fontFamily||"",this.fontWeight=e.fontWeight||"",this.fontShape=e.fontShape||"",this.sizeMultiplier=Fe[this.size-1],this.maxSize=e.maxSize,this.minRuleThickness=e.minRuleThickness,this._fontMetrics=void 0}extend(e){var t={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return new Ge(t)}havingStyle(e){return this.style===e?this:this.extend({style:e,size:_e(this.textSize,e)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(e){return this.size===e&&this.textSize===e?this:this.extend({style:this.style.text(),size:e,textSize:e,sizeMultiplier:Fe[e-1]})}havingBaseStyle(e){e=e||this.style.text();var t=_e(Ge.BASESIZE,e);return this.size===t&&this.textSize===Ge.BASESIZE&&this.style===e?this:this.extend({style:e,size:t})}havingBaseSizing(){var e;switch(this.style.id){case 4:case 5:e=3;break;case 6:case 7:e=1;break;default:e=6}return this.extend({style:this.style.text(),size:e})}withColor(e){return this.extend({color:e})}withPhantom(){return this.extend({phantom:!0})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}sizingClasses(e){return e.size!==this.size?["sizing","reset-size"+e.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==Ge.BASESIZE?["sizing","reset-size"+this.size,"size"+Ge.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=function(e){var t;if(!$e[t=e>=5?0:e>=3?1:2]){var r=$e[t]={cssEmPerMu:Le.quad[t]/18};for(var n in Le)Le.hasOwnProperty(n)&&(r[n]=Le[n][t])}return $e[t]}(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}Ge.BASESIZE=6;var Ue={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:1.00375,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:1.00375},Xe={ex:!0,em:!0,mu:!0},Ye=function(e){return"string"!=typeof e&&(e=e.unit),e in Ue||e in Xe||"ex"===e},We=function(e,t){var r;if(e.unit in Ue)r=Ue[e.unit]/t.fontMetrics().ptPerEm/t.sizeMultiplier;else if("mu"===e.unit)r=t.fontMetrics().cssEmPerMu;else{var n;if(n=t.style.isTight()?t.havingStyle(t.style.text()):t,"ex"===e.unit)r=n.fontMetrics().xHeight;else{if("em"!==e.unit)throw new me("Invalid unit: '"+e.unit+"'");r=n.fontMetrics().quad}n!==t&&(r*=n.sizeMultiplier/t.sizeMultiplier)}return Math.min(e.number*r,t.maxSize)},Ze=function(e){return+e.toFixed(4)+"em"},je=function(e){return e.filter((e=>e)).join(" ")},Ke=function(e,t,r){if(this.classes=e||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=r||{},t){t.style.isTight()&&this.classes.push("mtight");var n=t.getColor();n&&(this.style.color=n)}},Qe=function(e){var t=document.createElement(e);for(var r in t.className=je(this.classes),this.style)this.style.hasOwnProperty(r)&&(t.style[r]=this.style[r]);for(var n in this.attributes)this.attributes.hasOwnProperty(n)&&t.setAttribute(n,this.attributes[n]);for(var a=0;a<this.children.length;a++)t.appendChild(this.children[a].toNode());return t},Je=function(e){var t="<"+e;this.classes.length&&(t+=' class="'+be.escape(je(this.classes))+'"');var r="";for(var n in this.style)this.style.hasOwnProperty(n)&&(r+=be.hyphenate(n)+":"+this.style[n]+";");for(var a in r&&(t+=' style="'+be.escape(r)+'"'),this.attributes)this.attributes.hasOwnProperty(a)&&(t+=" "+a+'="'+be.escape(this.attributes[a])+'"');t+=">";for(var i=0;i<this.children.length;i++)t+=this.children[i].toMarkup();return t+="</"+e+">"};class et{constructor(e,t,r,n){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,Ke.call(this,e,r,n),this.children=t||[]}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return be.contains(this.classes,e)}toNode(){return Qe.call(this,"span")}toMarkup(){return Je.call(this,"span")}}class tt{constructor(e,t,r,n){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,Ke.call(this,t,n),this.children=r||[],this.setAttribute("href",e)}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return be.contains(this.classes,e)}toNode(){return Qe.call(this,"a")}toMarkup(){return Je.call(this,"a")}}class rt{constructor(e,t,r){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=t,this.src=e,this.classes=["mord"],this.style=r}hasClass(e){return be.contains(this.classes,e)}toNode(){var e=document.createElement("img");for(var t in e.src=this.src,e.alt=this.alt,e.className="mord",this.style)this.style.hasOwnProperty(t)&&(e.style[t]=this.style[t]);return e}toMarkup(){var e='<img src="'+be.escape(this.src)+'" alt="'+be.escape(this.alt)+'"',t="";for(var r in this.style)this.style.hasOwnProperty(r)&&(t+=be.hyphenate(r)+":"+this.style[r]+";");return t&&(e+=' style="'+be.escape(t)+'"'),e+="'/>"}}var nt={"î":"ı̂","ï":"ı̈","í":"ı́","ì":"ı̀"};class at{constructor(e,t,r,n,a,i,s,o){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=e,this.height=t||0,this.depth=r||0,this.italic=n||0,this.skew=a||0,this.width=i||0,this.classes=s||[],this.style=o||{},this.maxFontSize=0;var l=function(e){for(var t=0;t<qe.length;t++)for(var r=qe[t],n=0;n<r.blocks.length;n++){var a=r.blocks[n];if(e>=a[0]&&e<=a[1])return r.name}return null}(this.text.charCodeAt(0));l&&this.classes.push(l+"_fallback"),/[îïíì]/.test(this.text)&&(this.text=nt[this.text])}hasClass(e){return be.contains(this.classes,e)}toNode(){var e=document.createTextNode(this.text),t=null;for(var r in this.italic>0&&((t=document.createElement("span")).style.marginRight=Ze(this.italic)),this.classes.length>0&&((t=t||document.createElement("span")).className=je(this.classes)),this.style)this.style.hasOwnProperty(r)&&((t=t||document.createElement("span")).style[r]=this.style[r]);return t?(t.appendChild(e),t):e}toMarkup(){var e=!1,t="<span";this.classes.length&&(e=!0,t+=' class="',t+=be.escape(je(this.classes)),t+='"');var r="";for(var n in this.italic>0&&(r+="margin-right:"+this.italic+"em;"),this.style)this.style.hasOwnProperty(n)&&(r+=be.hyphenate(n)+":"+this.style[n]+";");r&&(e=!0,t+=' style="'+be.escape(r)+'"');var a=be.escape(this.text);return e?(t+=">",t+=a,t+="</span>"):a}}class it{constructor(e,t){this.children=void 0,this.attributes=void 0,this.children=e||[],this.attributes=t||{}}toNode(){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);for(var r=0;r<this.children.length;r++)e.appendChild(this.children[r].toNode());return e}toMarkup(){var e='<svg xmlns="http://www.w3.org/2000/svg"';for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+be.escape(this.attributes[t])+'"');e+=">";for(var r=0;r<this.children.length;r++)e+=this.children[r].toMarkup();return e+="</svg>"}}class st{constructor(e,t){this.pathName=void 0,this.alternate=void 0,this.pathName=e,this.alternate=t}toNode(){var e=document.createElementNS("http://www.w3.org/2000/svg","path");return this.alternate?e.setAttribute("d",this.alternate):e.setAttribute("d",Ee[this.pathName]),e}toMarkup(){return this.alternate?'<path d="'+be.escape(this.alternate)+'"/>':'<path d="'+be.escape(Ee[this.pathName])+'"/>'}}class ot{constructor(e){this.attributes=void 0,this.attributes=e||{}}toNode(){var e=document.createElementNS("http://www.w3.org/2000/svg","line");for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);return e}toMarkup(){var e="<line";for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+be.escape(this.attributes[t])+'"');return e+="/>"}}function lt(e){if(e instanceof at)return e;throw new Error("Expected symbolNode but got "+String(e)+".")}var ht={bin:1,close:1,inner:1,open:1,punct:1,rel:1},ct={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},pt={math:{},text:{}};function mt(e,t,r,n,a,i){pt[e][a]={font:t,group:r,replace:n},i&&n&&(pt[e][n]=pt[e][a])}var ut="math",dt="text",gt="main",ft="ams",bt="accent-token",vt="bin",xt="close",yt="inner",wt="mathord",kt="op-token",St="open",zt="punct",Mt="rel",Tt="spacing",At="textord";mt(ut,gt,Mt,"≡","\\equiv",!0),mt(ut,gt,Mt,"≺","\\prec",!0),mt(ut,gt,Mt,"≻","\\succ",!0),mt(ut,gt,Mt,"∼","\\sim",!0),mt(ut,gt,Mt,"⊥","\\perp"),mt(ut,gt,Mt,"⪯","\\preceq",!0),mt(ut,gt,Mt,"⪰","\\succeq",!0),mt(ut,gt,Mt,"≃","\\simeq",!0),mt(ut,gt,Mt,"∣","\\mid",!0),mt(ut,gt,Mt,"≪","\\ll",!0),mt(ut,gt,Mt,"≫","\\gg",!0),mt(ut,gt,Mt,"≍","\\asymp",!0),mt(ut,gt,Mt,"∥","\\parallel"),mt(ut,gt,Mt,"⋈","\\bowtie",!0),mt(ut,gt,Mt,"⌣","\\smile",!0),mt(ut,gt,Mt,"⊑","\\sqsubseteq",!0),mt(ut,gt,Mt,"⊒","\\sqsupseteq",!0),mt(ut,gt,Mt,"≐","\\doteq",!0),mt(ut,gt,Mt,"⌢","\\frown",!0),mt(ut,gt,Mt,"∋","\\ni",!0),mt(ut,gt,Mt,"∝","\\propto",!0),mt(ut,gt,Mt,"⊢","\\vdash",!0),mt(ut,gt,Mt,"⊣","\\dashv",!0),mt(ut,gt,Mt,"∋","\\owns"),mt(ut,gt,zt,".","\\ldotp"),mt(ut,gt,zt,"⋅","\\cdotp"),mt(ut,gt,At,"#","\\#"),mt(dt,gt,At,"#","\\#"),mt(ut,gt,At,"&","\\&"),mt(dt,gt,At,"&","\\&"),mt(ut,gt,At,"ℵ","\\aleph",!0),mt(ut,gt,At,"∀","\\forall",!0),mt(ut,gt,At,"ℏ","\\hbar",!0),mt(ut,gt,At,"∃","\\exists",!0),mt(ut,gt,At,"∇","\\nabla",!0),mt(ut,gt,At,"♭","\\flat",!0),mt(ut,gt,At,"ℓ","\\ell",!0),mt(ut,gt,At,"♮","\\natural",!0),mt(ut,gt,At,"♣","\\clubsuit",!0),mt(ut,gt,At,"℘","\\wp",!0),mt(ut,gt,At,"♯","\\sharp",!0),mt(ut,gt,At,"♢","\\diamondsuit",!0),mt(ut,gt,At,"ℜ","\\Re",!0),mt(ut,gt,At,"♡","\\heartsuit",!0),mt(ut,gt,At,"ℑ","\\Im",!0),mt(ut,gt,At,"♠","\\spadesuit",!0),mt(ut,gt,At,"§","\\S",!0),mt(dt,gt,At,"§","\\S"),mt(ut,gt,At,"¶","\\P",!0),mt(dt,gt,At,"¶","\\P"),mt(ut,gt,At,"†","\\dag"),mt(dt,gt,At,"†","\\dag"),mt(dt,gt,At,"†","\\textdagger"),mt(ut,gt,At,"‡","\\ddag"),mt(dt,gt,At,"‡","\\ddag"),mt(dt,gt,At,"‡","\\textdaggerdbl"),mt(ut,gt,xt,"⎱","\\rmoustache",!0),mt(ut,gt,St,"⎰","\\lmoustache",!0),mt(ut,gt,xt,"⟯","\\rgroup",!0),mt(ut,gt,St,"⟮","\\lgroup",!0),mt(ut,gt,vt,"∓","\\mp",!0),mt(ut,gt,vt,"⊖","\\ominus",!0),mt(ut,gt,vt,"⊎","\\uplus",!0),mt(ut,gt,vt,"⊓","\\sqcap",!0),mt(ut,gt,vt,"∗","\\ast"),mt(ut,gt,vt,"⊔","\\sqcup",!0),mt(ut,gt,vt,"◯","\\bigcirc",!0),mt(ut,gt,vt,"∙","\\bullet",!0),mt(ut,gt,vt,"‡","\\ddagger"),mt(ut,gt,vt,"≀","\\wr",!0),mt(ut,gt,vt,"⨿","\\amalg"),mt(ut,gt,vt,"&","\\And"),mt(ut,gt,Mt,"⟵","\\longleftarrow",!0),mt(ut,gt,Mt,"⇐","\\Leftarrow",!0),mt(ut,gt,Mt,"⟸","\\Longleftarrow",!0),mt(ut,gt,Mt,"⟶","\\longrightarrow",!0),mt(ut,gt,Mt,"⇒","\\Rightarrow",!0),mt(ut,gt,Mt,"⟹","\\Longrightarrow",!0),mt(ut,gt,Mt,"↔","\\leftrightarrow",!0),mt(ut,gt,Mt,"⟷","\\longleftrightarrow",!0),mt(ut,gt,Mt,"⇔","\\Leftrightarrow",!0),mt(ut,gt,Mt,"⟺","\\Longleftrightarrow",!0),mt(ut,gt,Mt,"↦","\\mapsto",!0),mt(ut,gt,Mt,"⟼","\\longmapsto",!0),mt(ut,gt,Mt,"↗","\\nearrow",!0),mt(ut,gt,Mt,"↩","\\hookleftarrow",!0),mt(ut,gt,Mt,"↪","\\hookrightarrow",!0),mt(ut,gt,Mt,"↘","\\searrow",!0),mt(ut,gt,Mt,"↼","\\leftharpoonup",!0),mt(ut,gt,Mt,"⇀","\\rightharpoonup",!0),mt(ut,gt,Mt,"↙","\\swarrow",!0),mt(ut,gt,Mt,"↽","\\leftharpoondown",!0),mt(ut,gt,Mt,"⇁","\\rightharpoondown",!0),mt(ut,gt,Mt,"↖","\\nwarrow",!0),mt(ut,gt,Mt,"⇌","\\rightleftharpoons",!0),mt(ut,ft,Mt,"≮","\\nless",!0),mt(ut,ft,Mt,"","\\@nleqslant"),mt(ut,ft,Mt,"","\\@nleqq"),mt(ut,ft,Mt,"⪇","\\lneq",!0),mt(ut,ft,Mt,"≨","\\lneqq",!0),mt(ut,ft,Mt,"","\\@lvertneqq"),mt(ut,ft,Mt,"⋦","\\lnsim",!0),mt(ut,ft,Mt,"⪉","\\lnapprox",!0),mt(ut,ft,Mt,"⊀","\\nprec",!0),mt(ut,ft,Mt,"⋠","\\npreceq",!0),mt(ut,ft,Mt,"⋨","\\precnsim",!0),mt(ut,ft,Mt,"⪹","\\precnapprox",!0),mt(ut,ft,Mt,"≁","\\nsim",!0),mt(ut,ft,Mt,"","\\@nshortmid"),mt(ut,ft,Mt,"∤","\\nmid",!0),mt(ut,ft,Mt,"⊬","\\nvdash",!0),mt(ut,ft,Mt,"⊭","\\nvDash",!0),mt(ut,ft,Mt,"⋪","\\ntriangleleft"),mt(ut,ft,Mt,"⋬","\\ntrianglelefteq",!0),mt(ut,ft,Mt,"⊊","\\subsetneq",!0),mt(ut,ft,Mt,"","\\@varsubsetneq"),mt(ut,ft,Mt,"⫋","\\subsetneqq",!0),mt(ut,ft,Mt,"","\\@varsubsetneqq"),mt(ut,ft,Mt,"≯","\\ngtr",!0),mt(ut,ft,Mt,"","\\@ngeqslant"),mt(ut,ft,Mt,"","\\@ngeqq"),mt(ut,ft,Mt,"⪈","\\gneq",!0),mt(ut,ft,Mt,"≩","\\gneqq",!0),mt(ut,ft,Mt,"","\\@gvertneqq"),mt(ut,ft,Mt,"⋧","\\gnsim",!0),mt(ut,ft,Mt,"⪊","\\gnapprox",!0),mt(ut,ft,Mt,"⊁","\\nsucc",!0),mt(ut,ft,Mt,"⋡","\\nsucceq",!0),mt(ut,ft,Mt,"⋩","\\succnsim",!0),mt(ut,ft,Mt,"⪺","\\succnapprox",!0),mt(ut,ft,Mt,"≆","\\ncong",!0),mt(ut,ft,Mt,"","\\@nshortparallel"),mt(ut,ft,Mt,"∦","\\nparallel",!0),mt(ut,ft,Mt,"⊯","\\nVDash",!0),mt(ut,ft,Mt,"⋫","\\ntriangleright"),mt(ut,ft,Mt,"⋭","\\ntrianglerighteq",!0),mt(ut,ft,Mt,"","\\@nsupseteqq"),mt(ut,ft,Mt,"⊋","\\supsetneq",!0),mt(ut,ft,Mt,"","\\@varsupsetneq"),mt(ut,ft,Mt,"⫌","\\supsetneqq",!0),mt(ut,ft,Mt,"","\\@varsupsetneqq"),mt(ut,ft,Mt,"⊮","\\nVdash",!0),mt(ut,ft,Mt,"⪵","\\precneqq",!0),mt(ut,ft,Mt,"⪶","\\succneqq",!0),mt(ut,ft,Mt,"","\\@nsubseteqq"),mt(ut,ft,vt,"⊴","\\unlhd"),mt(ut,ft,vt,"⊵","\\unrhd"),mt(ut,ft,Mt,"↚","\\nleftarrow",!0),mt(ut,ft,Mt,"↛","\\nrightarrow",!0),mt(ut,ft,Mt,"⇍","\\nLeftarrow",!0),mt(ut,ft,Mt,"⇏","\\nRightarrow",!0),mt(ut,ft,Mt,"↮","\\nleftrightarrow",!0),mt(ut,ft,Mt,"⇎","\\nLeftrightarrow",!0),mt(ut,ft,Mt,"△","\\vartriangle"),mt(ut,ft,At,"ℏ","\\hslash"),mt(ut,ft,At,"▽","\\triangledown"),mt(ut,ft,At,"◊","\\lozenge"),mt(ut,ft,At,"Ⓢ","\\circledS"),mt(ut,ft,At,"®","\\circledR"),mt(dt,ft,At,"®","\\circledR"),mt(ut,ft,At,"∡","\\measuredangle",!0),mt(ut,ft,At,"∄","\\nexists"),mt(ut,ft,At,"℧","\\mho"),mt(ut,ft,At,"Ⅎ","\\Finv",!0),mt(ut,ft,At,"⅁","\\Game",!0),mt(ut,ft,At,"‵","\\backprime"),mt(ut,ft,At,"▲","\\blacktriangle"),mt(ut,ft,At,"▼","\\blacktriangledown"),mt(ut,ft,At,"■","\\blacksquare"),mt(ut,ft,At,"⧫","\\blacklozenge"),mt(ut,ft,At,"★","\\bigstar"),mt(ut,ft,At,"∢","\\sphericalangle",!0),mt(ut,ft,At,"∁","\\complement",!0),mt(ut,ft,At,"ð","\\eth",!0),mt(dt,gt,At,"ð","ð"),mt(ut,ft,At,"╱","\\diagup"),mt(ut,ft,At,"╲","\\diagdown"),mt(ut,ft,At,"□","\\square"),mt(ut,ft,At,"□","\\Box"),mt(ut,ft,At,"◊","\\Diamond"),mt(ut,ft,At,"¥","\\yen",!0),mt(dt,ft,At,"¥","\\yen",!0),mt(ut,ft,At,"✓","\\checkmark",!0),mt(dt,ft,At,"✓","\\checkmark"),mt(ut,ft,At,"ℶ","\\beth",!0),mt(ut,ft,At,"ℸ","\\daleth",!0),mt(ut,ft,At,"ℷ","\\gimel",!0),mt(ut,ft,At,"ϝ","\\digamma",!0),mt(ut,ft,At,"ϰ","\\varkappa"),mt(ut,ft,St,"┌","\\@ulcorner",!0),mt(ut,ft,xt,"┐","\\@urcorner",!0),mt(ut,ft,St,"└","\\@llcorner",!0),mt(ut,ft,xt,"┘","\\@lrcorner",!0),mt(ut,ft,Mt,"≦","\\leqq",!0),mt(ut,ft,Mt,"⩽","\\leqslant",!0),mt(ut,ft,Mt,"⪕","\\eqslantless",!0),mt(ut,ft,Mt,"≲","\\lesssim",!0),mt(ut,ft,Mt,"⪅","\\lessapprox",!0),mt(ut,ft,Mt,"≊","\\approxeq",!0),mt(ut,ft,vt,"⋖","\\lessdot"),mt(ut,ft,Mt,"⋘","\\lll",!0),mt(ut,ft,Mt,"≶","\\lessgtr",!0),mt(ut,ft,Mt,"⋚","\\lesseqgtr",!0),mt(ut,ft,Mt,"⪋","\\lesseqqgtr",!0),mt(ut,ft,Mt,"≑","\\doteqdot"),mt(ut,ft,Mt,"≓","\\risingdotseq",!0),mt(ut,ft,Mt,"≒","\\fallingdotseq",!0),mt(ut,ft,Mt,"∽","\\backsim",!0),mt(ut,ft,Mt,"⋍","\\backsimeq",!0),mt(ut,ft,Mt,"⫅","\\subseteqq",!0),mt(ut,ft,Mt,"⋐","\\Subset",!0),mt(ut,ft,Mt,"⊏","\\sqsubset",!0),mt(ut,ft,Mt,"≼","\\preccurlyeq",!0),mt(ut,ft,Mt,"⋞","\\curlyeqprec",!0),mt(ut,ft,Mt,"≾","\\precsim",!0),mt(ut,ft,Mt,"⪷","\\precapprox",!0),mt(ut,ft,Mt,"⊲","\\vartriangleleft"),mt(ut,ft,Mt,"⊴","\\trianglelefteq"),mt(ut,ft,Mt,"⊨","\\vDash",!0),mt(ut,ft,Mt,"⊪","\\Vvdash",!0),mt(ut,ft,Mt,"⌣","\\smallsmile"),mt(ut,ft,Mt,"⌢","\\smallfrown"),mt(ut,ft,Mt,"≏","\\bumpeq",!0),mt(ut,ft,Mt,"≎","\\Bumpeq",!0),mt(ut,ft,Mt,"≧","\\geqq",!0),mt(ut,ft,Mt,"⩾","\\geqslant",!0),mt(ut,ft,Mt,"⪖","\\eqslantgtr",!0),mt(ut,ft,Mt,"≳","\\gtrsim",!0),mt(ut,ft,Mt,"⪆","\\gtrapprox",!0),mt(ut,ft,vt,"⋗","\\gtrdot"),mt(ut,ft,Mt,"⋙","\\ggg",!0),mt(ut,ft,Mt,"≷","\\gtrless",!0),mt(ut,ft,Mt,"⋛","\\gtreqless",!0),mt(ut,ft,Mt,"⪌","\\gtreqqless",!0),mt(ut,ft,Mt,"≖","\\eqcirc",!0),mt(ut,ft,Mt,"≗","\\circeq",!0),mt(ut,ft,Mt,"≜","\\triangleq",!0),mt(ut,ft,Mt,"∼","\\thicksim"),mt(ut,ft,Mt,"≈","\\thickapprox"),mt(ut,ft,Mt,"⫆","\\supseteqq",!0),mt(ut,ft,Mt,"⋑","\\Supset",!0),mt(ut,ft,Mt,"⊐","\\sqsupset",!0),mt(ut,ft,Mt,"≽","\\succcurlyeq",!0),mt(ut,ft,Mt,"⋟","\\curlyeqsucc",!0),mt(ut,ft,Mt,"≿","\\succsim",!0),mt(ut,ft,Mt,"⪸","\\succapprox",!0),mt(ut,ft,Mt,"⊳","\\vartriangleright"),mt(ut,ft,Mt,"⊵","\\trianglerighteq"),mt(ut,ft,Mt,"⊩","\\Vdash",!0),mt(ut,ft,Mt,"∣","\\shortmid"),mt(ut,ft,Mt,"∥","\\shortparallel"),mt(ut,ft,Mt,"≬","\\between",!0),mt(ut,ft,Mt,"⋔","\\pitchfork",!0),mt(ut,ft,Mt,"∝","\\varpropto"),mt(ut,ft,Mt,"◀","\\blacktriangleleft"),mt(ut,ft,Mt,"∴","\\therefore",!0),mt(ut,ft,Mt,"∍","\\backepsilon"),mt(ut,ft,Mt,"▶","\\blacktriangleright"),mt(ut,ft,Mt,"∵","\\because",!0),mt(ut,ft,Mt,"⋘","\\llless"),mt(ut,ft,Mt,"⋙","\\gggtr"),mt(ut,ft,vt,"⊲","\\lhd"),mt(ut,ft,vt,"⊳","\\rhd"),mt(ut,ft,Mt,"≂","\\eqsim",!0),mt(ut,gt,Mt,"⋈","\\Join"),mt(ut,ft,Mt,"≑","\\Doteq",!0),mt(ut,ft,vt,"∔","\\dotplus",!0),mt(ut,ft,vt,"∖","\\smallsetminus"),mt(ut,ft,vt,"⋒","\\Cap",!0),mt(ut,ft,vt,"⋓","\\Cup",!0),mt(ut,ft,vt,"⩞","\\doublebarwedge",!0),mt(ut,ft,vt,"⊟","\\boxminus",!0),mt(ut,ft,vt,"⊞","\\boxplus",!0),mt(ut,ft,vt,"⋇","\\divideontimes",!0),mt(ut,ft,vt,"⋉","\\ltimes",!0),mt(ut,ft,vt,"⋊","\\rtimes",!0),mt(ut,ft,vt,"⋋","\\leftthreetimes",!0),mt(ut,ft,vt,"⋌","\\rightthreetimes",!0),mt(ut,ft,vt,"⋏","\\curlywedge",!0),mt(ut,ft,vt,"⋎","\\curlyvee",!0),mt(ut,ft,vt,"⊝","\\circleddash",!0),mt(ut,ft,vt,"⊛","\\circledast",!0),mt(ut,ft,vt,"⋅","\\centerdot"),mt(ut,ft,vt,"⊺","\\intercal",!0),mt(ut,ft,vt,"⋒","\\doublecap"),mt(ut,ft,vt,"⋓","\\doublecup"),mt(ut,ft,vt,"⊠","\\boxtimes",!0),mt(ut,ft,Mt,"⇢","\\dashrightarrow",!0),mt(ut,ft,Mt,"⇠","\\dashleftarrow",!0),mt(ut,ft,Mt,"⇇","\\leftleftarrows",!0),mt(ut,ft,Mt,"⇆","\\leftrightarrows",!0),mt(ut,ft,Mt,"⇚","\\Lleftarrow",!0),mt(ut,ft,Mt,"↞","\\twoheadleftarrow",!0),mt(ut,ft,Mt,"↢","\\leftarrowtail",!0),mt(ut,ft,Mt,"↫","\\looparrowleft",!0),mt(ut,ft,Mt,"⇋","\\leftrightharpoons",!0),mt(ut,ft,Mt,"↶","\\curvearrowleft",!0),mt(ut,ft,Mt,"↺","\\circlearrowleft",!0),mt(ut,ft,Mt,"↰","\\Lsh",!0),mt(ut,ft,Mt,"⇈","\\upuparrows",!0),mt(ut,ft,Mt,"↿","\\upharpoonleft",!0),mt(ut,ft,Mt,"⇃","\\downharpoonleft",!0),mt(ut,gt,Mt,"⊶","\\origof",!0),mt(ut,gt,Mt,"⊷","\\imageof",!0),mt(ut,ft,Mt,"⊸","\\multimap",!0),mt(ut,ft,Mt,"↭","\\leftrightsquigarrow",!0),mt(ut,ft,Mt,"⇉","\\rightrightarrows",!0),mt(ut,ft,Mt,"⇄","\\rightleftarrows",!0),mt(ut,ft,Mt,"↠","\\twoheadrightarrow",!0),mt(ut,ft,Mt,"↣","\\rightarrowtail",!0),mt(ut,ft,Mt,"↬","\\looparrowright",!0),mt(ut,ft,Mt,"↷","\\curvearrowright",!0),mt(ut,ft,Mt,"↻","\\circlearrowright",!0),mt(ut,ft,Mt,"↱","\\Rsh",!0),mt(ut,ft,Mt,"⇊","\\downdownarrows",!0),mt(ut,ft,Mt,"↾","\\upharpoonright",!0),mt(ut,ft,Mt,"⇂","\\downharpoonright",!0),mt(ut,ft,Mt,"⇝","\\rightsquigarrow",!0),mt(ut,ft,Mt,"⇝","\\leadsto"),mt(ut,ft,Mt,"⇛","\\Rrightarrow",!0),mt(ut,ft,Mt,"↾","\\restriction"),mt(ut,gt,At,"‘","`"),mt(ut,gt,At,"$","\\$"),mt(dt,gt,At,"$","\\$"),mt(dt,gt,At,"$","\\textdollar"),mt(ut,gt,At,"%","\\%"),mt(dt,gt,At,"%","\\%"),mt(ut,gt,At,"_","\\_"),mt(dt,gt,At,"_","\\_"),mt(dt,gt,At,"_","\\textunderscore"),mt(ut,gt,At,"∠","\\angle",!0),mt(ut,gt,At,"∞","\\infty",!0),mt(ut,gt,At,"′","\\prime"),mt(ut,gt,At,"△","\\triangle"),mt(ut,gt,At,"Γ","\\Gamma",!0),mt(ut,gt,At,"Δ","\\Delta",!0),mt(ut,gt,At,"Θ","\\Theta",!0),mt(ut,gt,At,"Λ","\\Lambda",!0),mt(ut,gt,At,"Ξ","\\Xi",!0),mt(ut,gt,At,"Π","\\Pi",!0),mt(ut,gt,At,"Σ","\\Sigma",!0),mt(ut,gt,At,"Υ","\\Upsilon",!0),mt(ut,gt,At,"Φ","\\Phi",!0),mt(ut,gt,At,"Ψ","\\Psi",!0),mt(ut,gt,At,"Ω","\\Omega",!0),mt(ut,gt,At,"A","Α"),mt(ut,gt,At,"B","Β"),mt(ut,gt,At,"E","Ε"),mt(ut,gt,At,"Z","Ζ"),mt(ut,gt,At,"H","Η"),mt(ut,gt,At,"I","Ι"),mt(ut,gt,At,"K","Κ"),mt(ut,gt,At,"M","Μ"),mt(ut,gt,At,"N","Ν"),mt(ut,gt,At,"O","Ο"),mt(ut,gt,At,"P","Ρ"),mt(ut,gt,At,"T","Τ"),mt(ut,gt,At,"X","Χ"),mt(ut,gt,At,"¬","\\neg",!0),mt(ut,gt,At,"¬","\\lnot"),mt(ut,gt,At,"⊤","\\top"),mt(ut,gt,At,"⊥","\\bot"),mt(ut,gt,At,"∅","\\emptyset"),mt(ut,ft,At,"∅","\\varnothing"),mt(ut,gt,wt,"α","\\alpha",!0),mt(ut,gt,wt,"β","\\beta",!0),mt(ut,gt,wt,"γ","\\gamma",!0),mt(ut,gt,wt,"δ","\\delta",!0),mt(ut,gt,wt,"ϵ","\\epsilon",!0),mt(ut,gt,wt,"ζ","\\zeta",!0),mt(ut,gt,wt,"η","\\eta",!0),mt(ut,gt,wt,"θ","\\theta",!0),mt(ut,gt,wt,"ι","\\iota",!0),mt(ut,gt,wt,"κ","\\kappa",!0),mt(ut,gt,wt,"λ","\\lambda",!0),mt(ut,gt,wt,"μ","\\mu",!0),mt(ut,gt,wt,"ν","\\nu",!0),mt(ut,gt,wt,"ξ","\\xi",!0),mt(ut,gt,wt,"ο","\\omicron",!0),mt(ut,gt,wt,"π","\\pi",!0),mt(ut,gt,wt,"ρ","\\rho",!0),mt(ut,gt,wt,"σ","\\sigma",!0),mt(ut,gt,wt,"τ","\\tau",!0),mt(ut,gt,wt,"υ","\\upsilon",!0),mt(ut,gt,wt,"ϕ","\\phi",!0),mt(ut,gt,wt,"χ","\\chi",!0),mt(ut,gt,wt,"ψ","\\psi",!0),mt(ut,gt,wt,"ω","\\omega",!0),mt(ut,gt,wt,"ε","\\varepsilon",!0),mt(ut,gt,wt,"ϑ","\\vartheta",!0),mt(ut,gt,wt,"ϖ","\\varpi",!0),mt(ut,gt,wt,"ϱ","\\varrho",!0),mt(ut,gt,wt,"ς","\\varsigma",!0),mt(ut,gt,wt,"φ","\\varphi",!0),mt(ut,gt,vt,"∗","*",!0),mt(ut,gt,vt,"+","+"),mt(ut,gt,vt,"−","-",!0),mt(ut,gt,vt,"⋅","\\cdot",!0),mt(ut,gt,vt,"∘","\\circ",!0),mt(ut,gt,vt,"÷","\\div",!0),mt(ut,gt,vt,"±","\\pm",!0),mt(ut,gt,vt,"×","\\times",!0),mt(ut,gt,vt,"∩","\\cap",!0),mt(ut,gt,vt,"∪","\\cup",!0),mt(ut,gt,vt,"∖","\\setminus",!0),mt(ut,gt,vt,"∧","\\land"),mt(ut,gt,vt,"∨","\\lor"),mt(ut,gt,vt,"∧","\\wedge",!0),mt(ut,gt,vt,"∨","\\vee",!0),mt(ut,gt,At,"√","\\surd"),mt(ut,gt,St,"⟨","\\langle",!0),mt(ut,gt,St,"∣","\\lvert"),mt(ut,gt,St,"∥","\\lVert"),mt(ut,gt,xt,"?","?"),mt(ut,gt,xt,"!","!"),mt(ut,gt,xt,"⟩","\\rangle",!0),mt(ut,gt,xt,"∣","\\rvert"),mt(ut,gt,xt,"∥","\\rVert"),mt(ut,gt,Mt,"=","="),mt(ut,gt,Mt,":",":"),mt(ut,gt,Mt,"≈","\\approx",!0),mt(ut,gt,Mt,"≅","\\cong",!0),mt(ut,gt,Mt,"≥","\\ge"),mt(ut,gt,Mt,"≥","\\geq",!0),mt(ut,gt,Mt,"←","\\gets"),mt(ut,gt,Mt,">","\\gt",!0),mt(ut,gt,Mt,"∈","\\in",!0),mt(ut,gt,Mt,"","\\@not"),mt(ut,gt,Mt,"⊂","\\subset",!0),mt(ut,gt,Mt,"⊃","\\supset",!0),mt(ut,gt,Mt,"⊆","\\subseteq",!0),mt(ut,gt,Mt,"⊇","\\supseteq",!0),mt(ut,ft,Mt,"⊈","\\nsubseteq",!0),mt(ut,ft,Mt,"⊉","\\nsupseteq",!0),mt(ut,gt,Mt,"⊨","\\models"),mt(ut,gt,Mt,"←","\\leftarrow",!0),mt(ut,gt,Mt,"≤","\\le"),mt(ut,gt,Mt,"≤","\\leq",!0),mt(ut,gt,Mt,"<","\\lt",!0),mt(ut,gt,Mt,"→","\\rightarrow",!0),mt(ut,gt,Mt,"→","\\to"),mt(ut,ft,Mt,"≱","\\ngeq",!0),mt(ut,ft,Mt,"≰","\\nleq",!0),mt(ut,gt,Tt," ","\\ "),mt(ut,gt,Tt," ","\\space"),mt(ut,gt,Tt," ","\\nobreakspace"),mt(dt,gt,Tt," ","\\ "),mt(dt,gt,Tt," "," "),mt(dt,gt,Tt," ","\\space"),mt(dt,gt,Tt," ","\\nobreakspace"),mt(ut,gt,Tt,null,"\\nobreak"),mt(ut,gt,Tt,null,"\\allowbreak"),mt(ut,gt,zt,",",","),mt(ut,gt,zt,";",";"),mt(ut,ft,vt,"⊼","\\barwedge",!0),mt(ut,ft,vt,"⊻","\\veebar",!0),mt(ut,gt,vt,"⊙","\\odot",!0),mt(ut,gt,vt,"⊕","\\oplus",!0),mt(ut,gt,vt,"⊗","\\otimes",!0),mt(ut,gt,At,"∂","\\partial",!0),mt(ut,gt,vt,"⊘","\\oslash",!0),mt(ut,ft,vt,"⊚","\\circledcirc",!0),mt(ut,ft,vt,"⊡","\\boxdot",!0),mt(ut,gt,vt,"△","\\bigtriangleup"),mt(ut,gt,vt,"▽","\\bigtriangledown"),mt(ut,gt,vt,"†","\\dagger"),mt(ut,gt,vt,"⋄","\\diamond"),mt(ut,gt,vt,"⋆","\\star"),mt(ut,gt,vt,"◃","\\triangleleft"),mt(ut,gt,vt,"▹","\\triangleright"),mt(ut,gt,St,"{","\\{"),mt(dt,gt,At,"{","\\{"),mt(dt,gt,At,"{","\\textbraceleft"),mt(ut,gt,xt,"}","\\}"),mt(dt,gt,At,"}","\\}"),mt(dt,gt,At,"}","\\textbraceright"),mt(ut,gt,St,"{","\\lbrace"),mt(ut,gt,xt,"}","\\rbrace"),mt(ut,gt,St,"[","\\lbrack",!0),mt(dt,gt,At,"[","\\lbrack",!0),mt(ut,gt,xt,"]","\\rbrack",!0),mt(dt,gt,At,"]","\\rbrack",!0),mt(ut,gt,St,"(","\\lparen",!0),mt(ut,gt,xt,")","\\rparen",!0),mt(dt,gt,At,"<","\\textless",!0),mt(dt,gt,At,">","\\textgreater",!0),mt(ut,gt,St,"⌊","\\lfloor",!0),mt(ut,gt,xt,"⌋","\\rfloor",!0),mt(ut,gt,St,"⌈","\\lceil",!0),mt(ut,gt,xt,"⌉","\\rceil",!0),mt(ut,gt,At,"\\","\\backslash"),mt(ut,gt,At,"∣","|"),mt(ut,gt,At,"∣","\\vert"),mt(dt,gt,At,"|","\\textbar",!0),mt(ut,gt,At,"∥","\\|"),mt(ut,gt,At,"∥","\\Vert"),mt(dt,gt,At,"∥","\\textbardbl"),mt(dt,gt,At,"~","\\textasciitilde"),mt(dt,gt,At,"\\","\\textbackslash"),mt(dt,gt,At,"^","\\textasciicircum"),mt(ut,gt,Mt,"↑","\\uparrow",!0),mt(ut,gt,Mt,"⇑","\\Uparrow",!0),mt(ut,gt,Mt,"↓","\\downarrow",!0),mt(ut,gt,Mt,"⇓","\\Downarrow",!0),mt(ut,gt,Mt,"↕","\\updownarrow",!0),mt(ut,gt,Mt,"⇕","\\Updownarrow",!0),mt(ut,gt,kt,"∐","\\coprod"),mt(ut,gt,kt,"⋁","\\bigvee"),mt(ut,gt,kt,"⋀","\\bigwedge"),mt(ut,gt,kt,"⨄","\\biguplus"),mt(ut,gt,kt,"⋂","\\bigcap"),mt(ut,gt,kt,"⋃","\\bigcup"),mt(ut,gt,kt,"∫","\\int"),mt(ut,gt,kt,"∫","\\intop"),mt(ut,gt,kt,"∬","\\iint"),mt(ut,gt,kt,"∭","\\iiint"),mt(ut,gt,kt,"∏","\\prod"),mt(ut,gt,kt,"∑","\\sum"),mt(ut,gt,kt,"⨂","\\bigotimes"),mt(ut,gt,kt,"⨁","\\bigoplus"),mt(ut,gt,kt,"⨀","\\bigodot"),mt(ut,gt,kt,"∮","\\oint"),mt(ut,gt,kt,"∯","\\oiint"),mt(ut,gt,kt,"∰","\\oiiint"),mt(ut,gt,kt,"⨆","\\bigsqcup"),mt(ut,gt,kt,"∫","\\smallint"),mt(dt,gt,yt,"…","\\textellipsis"),mt(ut,gt,yt,"…","\\mathellipsis"),mt(dt,gt,yt,"…","\\ldots",!0),mt(ut,gt,yt,"…","\\ldots",!0),mt(ut,gt,yt,"⋯","\\@cdots",!0),mt(ut,gt,yt,"⋱","\\ddots",!0),mt(ut,gt,At,"⋮","\\varvdots"),mt(ut,gt,bt,"ˊ","\\acute"),mt(ut,gt,bt,"ˋ","\\grave"),mt(ut,gt,bt,"¨","\\ddot"),mt(ut,gt,bt,"~","\\tilde"),mt(ut,gt,bt,"ˉ","\\bar"),mt(ut,gt,bt,"˘","\\breve"),mt(ut,gt,bt,"ˇ","\\check"),mt(ut,gt,bt,"^","\\hat"),mt(ut,gt,bt,"⃗","\\vec"),mt(ut,gt,bt,"˙","\\dot"),mt(ut,gt,bt,"˚","\\mathring"),mt(ut,gt,wt,"","\\@imath"),mt(ut,gt,wt,"","\\@jmath"),mt(ut,gt,At,"ı","ı"),mt(ut,gt,At,"ȷ","ȷ"),mt(dt,gt,At,"ı","\\i",!0),mt(dt,gt,At,"ȷ","\\j",!0),mt(dt,gt,At,"ß","\\ss",!0),mt(dt,gt,At,"æ","\\ae",!0),mt(dt,gt,At,"œ","\\oe",!0),mt(dt,gt,At,"ø","\\o",!0),mt(dt,gt,At,"Æ","\\AE",!0),mt(dt,gt,At,"Œ","\\OE",!0),mt(dt,gt,At,"Ø","\\O",!0),mt(dt,gt,bt,"ˊ","\\'"),mt(dt,gt,bt,"ˋ","\\`"),mt(dt,gt,bt,"ˆ","\\^"),mt(dt,gt,bt,"˜","\\~"),mt(dt,gt,bt,"ˉ","\\="),mt(dt,gt,bt,"˘","\\u"),mt(dt,gt,bt,"˙","\\."),mt(dt,gt,bt,"¸","\\c"),mt(dt,gt,bt,"˚","\\r"),mt(dt,gt,bt,"ˇ","\\v"),mt(dt,gt,bt,"¨",'\\"'),mt(dt,gt,bt,"˝","\\H"),mt(dt,gt,bt,"◯","\\textcircled");var Bt={"--":!0,"---":!0,"``":!0,"''":!0};mt(dt,gt,At,"–","--",!0),mt(dt,gt,At,"–","\\textendash"),mt(dt,gt,At,"—","---",!0),mt(dt,gt,At,"—","\\textemdash"),mt(dt,gt,At,"‘","`",!0),mt(dt,gt,At,"‘","\\textquoteleft"),mt(dt,gt,At,"’","'",!0),mt(dt,gt,At,"’","\\textquoteright"),mt(dt,gt,At,"“","``",!0),mt(dt,gt,At,"“","\\textquotedblleft"),mt(dt,gt,At,"”","''",!0),mt(dt,gt,At,"”","\\textquotedblright"),mt(ut,gt,At,"°","\\degree",!0),mt(dt,gt,At,"°","\\degree"),mt(dt,gt,At,"°","\\textdegree",!0),mt(ut,gt,At,"£","\\pounds"),mt(ut,gt,At,"£","\\mathsterling",!0),mt(dt,gt,At,"£","\\pounds"),mt(dt,gt,At,"£","\\textsterling",!0),mt(ut,ft,At,"✠","\\maltese"),mt(dt,ft,At,"✠","\\maltese");for(var Ct='0123456789/@."',qt=0;qt<14;qt++){var Nt=Ct.charAt(qt);mt(ut,gt,At,Nt,Nt)}for(var Rt='0123456789!@*()-=+";:?/.,',It=0;It<25;It++){var Et=Rt.charAt(It);mt(dt,gt,At,Et,Et)}for(var Ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Ot=0;Ot<52;Ot++){var Lt=Ht.charAt(Ot);mt(ut,gt,wt,Lt,Lt),mt(dt,gt,At,Lt,Lt)}mt(ut,ft,At,"C","ℂ"),mt(dt,ft,At,"C","ℂ"),mt(ut,ft,At,"H","ℍ"),mt(dt,ft,At,"H","ℍ"),mt(ut,ft,At,"N","ℕ"),mt(dt,ft,At,"N","ℕ"),mt(ut,ft,At,"P","ℙ"),mt(dt,ft,At,"P","ℙ"),mt(ut,ft,At,"Q","ℚ"),mt(dt,ft,At,"Q","ℚ"),mt(ut,ft,At,"R","ℝ"),mt(dt,ft,At,"R","ℝ"),mt(ut,ft,At,"Z","ℤ"),mt(dt,ft,At,"Z","ℤ"),mt(ut,gt,wt,"h","ℎ"),mt(dt,gt,wt,"h","ℎ");for(var Dt="",Pt=0;Pt<52;Pt++){var $t=Ht.charAt(Pt);mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56320+Pt)),mt(dt,gt,At,$t,Dt),mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56372+Pt)),mt(dt,gt,At,$t,Dt),mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56424+Pt)),mt(dt,gt,At,$t,Dt),mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56580+Pt)),mt(dt,gt,At,$t,Dt),mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56684+Pt)),mt(dt,gt,At,$t,Dt),mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56736+Pt)),mt(dt,gt,At,$t,Dt),mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56788+Pt)),mt(dt,gt,At,$t,Dt),mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56840+Pt)),mt(dt,gt,At,$t,Dt),mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56944+Pt)),mt(dt,gt,At,$t,Dt),Pt<26&&(mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56632+Pt)),mt(dt,gt,At,$t,Dt),mt(ut,gt,wt,$t,Dt=String.fromCharCode(55349,56476+Pt)),mt(dt,gt,At,$t,Dt))}mt(ut,gt,wt,"k",Dt=String.fromCharCode(55349,56668)),mt(dt,gt,At,"k",Dt);for(var Vt=0;Vt<10;Vt++){var Ft=Vt.toString();mt(ut,gt,wt,Ft,Dt=String.fromCharCode(55349,57294+Vt)),mt(dt,gt,At,Ft,Dt),mt(ut,gt,wt,Ft,Dt=String.fromCharCode(55349,57314+Vt)),mt(dt,gt,At,Ft,Dt),mt(ut,gt,wt,Ft,Dt=String.fromCharCode(55349,57324+Vt)),mt(dt,gt,At,Ft,Dt),mt(ut,gt,wt,Ft,Dt=String.fromCharCode(55349,57334+Vt)),mt(dt,gt,At,Ft,Dt)}for(var _t="ÐÞþ",Gt=0;Gt<3;Gt++){var Ut=_t.charAt(Gt);mt(ut,gt,wt,Ut,Ut),mt(dt,gt,At,Ut,Ut)}var Xt=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],Yt=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],Wt=function(e,t,r){return pt[r][e]&&pt[r][e].replace&&(e=pt[r][e].replace),{value:e,metrics:Pe(e,t,r)}},Zt=function(e,t,r,n,a){var i,s=Wt(e,t,r),o=s.metrics;if(e=s.value,o){var l=o.italic;("text"===r||n&&"mathit"===n.font)&&(l=0),i=new at(e,o.height,o.depth,l,o.skew,o.width,a)}else"undefined"!=typeof console&&console.warn("No character metrics for '"+e+"' in style '"+t+"' and mode '"+r+"'"),i=new at(e,0,0,0,0,0,a);if(n){i.maxFontSize=n.sizeMultiplier,n.style.isTight()&&i.classes.push("mtight");var h=n.getColor();h&&(i.style.color=h)}return i},jt=(e,t)=>{if(je(e.classes)!==je(t.classes)||e.skew!==t.skew||e.maxFontSize!==t.maxFontSize)return!1;if(1===e.classes.length){var r=e.classes[0];if("mbin"===r||"mord"===r)return!1}for(var n in e.style)if(e.style.hasOwnProperty(n)&&e.style[n]!==t.style[n])return!1;for(var a in t.style)if(t.style.hasOwnProperty(a)&&e.style[a]!==t.style[a])return!1;return!0},Kt=function(e){for(var t=0,r=0,n=0,a=0;a<e.children.length;a++){var i=e.children[a];i.height>t&&(t=i.height),i.depth>r&&(r=i.depth),i.maxFontSize>n&&(n=i.maxFontSize)}e.height=t,e.depth=r,e.maxFontSize=n},Qt=function(e,t,r,n){var a=new et(e,t,r,n);return Kt(a),a},Jt=(e,t,r,n)=>new et(e,t,r,n),er=function(e){var t=new He(e);return Kt(t),t},tr=function(e,t,r){var n="";switch(e){case"amsrm":n="AMS";break;case"textrm":n="Main";break;case"textsf":n="SansSerif";break;case"texttt":n="Typewriter";break;default:n=e}return n+"-"+("textbf"===t&&"textit"===r?"BoldItalic":"textbf"===t?"Bold":"textit"===t?"Italic":"Regular")},rr={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},nr={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},ar={fontMap:rr,makeSymbol:Zt,mathsym:function(e,t,r,n){return void 0===n&&(n=[]),"boldsymbol"===r.font&&Wt(e,"Main-Bold",t).metrics?Zt(e,"Main-Bold",t,r,n.concat(["mathbf"])):"\\"===e||"main"===pt[t][e].font?Zt(e,"Main-Regular",t,r,n):Zt(e,"AMS-Regular",t,r,n.concat(["amsrm"]))},makeSpan:Qt,makeSvgSpan:Jt,makeLineSpan:function(e,t,r){var n=Qt([e],[],t);return n.height=Math.max(r||t.fontMetrics().defaultRuleThickness,t.minRuleThickness),n.style.borderBottomWidth=Ze(n.height),n.maxFontSize=1,n},makeAnchor:function(e,t,r,n){var a=new tt(e,t,r,n);return Kt(a),a},makeFragment:er,wrapFragment:function(e,t){return e instanceof He?Qt([],[e],t):e},makeVList:function(e,t){for(var{children:r,depth:n}=function(e){if("individualShift"===e.positionType){for(var t=e.children,r=[t[0]],n=-t[0].shift-t[0].elem.depth,a=n,i=1;i<t.length;i++){var s=-t[i].shift-a-t[i].elem.depth,o=s-(t[i-1].elem.height+t[i-1].elem.depth);a+=s,r.push({type:"kern",size:o}),r.push(t[i])}return{children:r,depth:n}}var l;if("top"===e.positionType){for(var h=e.positionData,c=0;c<e.children.length;c++){var p=e.children[c];h-="kern"===p.type?p.size:p.elem.height+p.elem.depth}l=h}else if("bottom"===e.positionType)l=-e.positionData;else{var m=e.children[0];if("elem"!==m.type)throw new Error('First child must have type "elem".');if("shift"===e.positionType)l=-m.elem.depth-e.positionData;else{if("firstBaseline"!==e.positionType)throw new Error("Invalid positionType "+e.positionType+".");l=-m.elem.depth}}return{children:e.children,depth:l}}(e),a=0,i=0;i<r.length;i++){var s=r[i];if("elem"===s.type){var o=s.elem;a=Math.max(a,o.maxFontSize,o.height)}}a+=2;var l=Qt(["pstrut"],[]);l.style.height=Ze(a);for(var h=[],c=n,p=n,m=n,u=0;u<r.length;u++){var d=r[u];if("kern"===d.type)m+=d.size;else{var g=d.elem,f=d.wrapperClasses||[],b=d.wrapperStyle||{},v=Qt(f,[l,g],void 0,b);v.style.top=Ze(-a-m-g.depth),d.marginLeft&&(v.style.marginLeft=d.marginLeft),d.marginRight&&(v.style.marginRight=d.marginRight),h.push(v),m+=g.height+g.depth}c=Math.min(c,m),p=Math.max(p,m)}var x,y=Qt(["vlist"],h);if(y.style.height=Ze(p),c<0){var w=Qt([],[]),k=Qt(["vlist"],[w]);k.style.height=Ze(-c);var S=Qt(["vlist-s"],[new at("​")]);x=[Qt(["vlist-r"],[y,S]),Qt(["vlist-r"],[k])]}else x=[Qt(["vlist-r"],[y])];var z=Qt(["vlist-t"],x);return 2===x.length&&z.classes.push("vlist-t2"),z.height=p,z.depth=-c,z},makeOrd:function(e,t,r){var n=e.mode,a=e.text,i=["mord"],s="math"===n||"text"===n&&t.font,o=s?t.font:t.fontFamily,l="",h="";if(55349===a.charCodeAt(0)&&([l,h]=function(e,t){var r=1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536,n="math"===t?0:1;if(119808<=r&&r<120484){var a=Math.floor((r-119808)/26);return[Xt[a][2],Xt[a][n]]}if(120782<=r&&r<=120831){var i=Math.floor((r-120782)/10);return[Yt[i][2],Yt[i][n]]}if(120485===r||120486===r)return[Xt[0][2],Xt[0][n]];if(120486<r&&r<120782)return["",""];throw new me("Unsupported character: "+e)}(a,n)),l.length>0)return Zt(a,l,n,t,i.concat(h));if(o){var c,p;if("boldsymbol"===o){var m=function(e,t,r,n,a){return"textord"!==a&&Wt(e,"Math-BoldItalic",t).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}}(a,n,0,0,r);c=m.fontName,p=[m.fontClass]}else s?(c=rr[o].fontName,p=[o]):(c=tr(o,t.fontWeight,t.fontShape),p=[o,t.fontWeight,t.fontShape]);if(Wt(a,c,n).metrics)return Zt(a,c,n,t,i.concat(p));if(Bt.hasOwnProperty(a)&&"Typewriter"===c.slice(0,10)){for(var u=[],d=0;d<a.length;d++)u.push(Zt(a[d],c,n,t,i.concat(p)));return er(u)}}if("mathord"===r)return Zt(a,"Math-Italic",n,t,i.concat(["mathnormal"]));if("textord"===r){var g=pt[n][a]&&pt[n][a].font;if("ams"===g){var f=tr("amsrm",t.fontWeight,t.fontShape);return Zt(a,f,n,t,i.concat("amsrm",t.fontWeight,t.fontShape))}if("main"!==g&&g){var b=tr(g,t.fontWeight,t.fontShape);return Zt(a,b,n,t,i.concat(b,t.fontWeight,t.fontShape))}var v=tr("textrm",t.fontWeight,t.fontShape);return Zt(a,v,n,t,i.concat(t.fontWeight,t.fontShape))}throw new Error("unexpected type: "+r+" in makeOrd")},makeGlue:(e,t)=>{var r=Qt(["mspace"],[],t),n=We(e,t);return r.style.marginRight=Ze(n),r},staticSvg:function(e,t){var[r,n,a]=nr[e],i=new st(r),s=new it([i],{width:Ze(n),height:Ze(a),style:"width:"+Ze(n),viewBox:"0 0 "+1e3*n+" "+1e3*a,preserveAspectRatio:"xMinYMin"}),o=Jt(["overlay"],[s],t);return o.height=a,o.style.height=Ze(a),o.style.width=Ze(n),o},svgData:nr,tryCombineChars:e=>{for(var t=0;t<e.length-1;t++){var r=e[t],n=e[t+1];r instanceof at&&n instanceof at&&jt(r,n)&&(r.text+=n.text,r.height=Math.max(r.height,n.height),r.depth=Math.max(r.depth,n.depth),r.italic=n.italic,e.splice(t+1,1),t--)}return e}},ir={number:3,unit:"mu"},sr={number:4,unit:"mu"},or={number:5,unit:"mu"},lr={mord:{mop:ir,mbin:sr,mrel:or,minner:ir},mop:{mord:ir,mop:ir,mrel:or,minner:ir},mbin:{mord:sr,mop:sr,mopen:sr,minner:sr},mrel:{mord:or,mop:or,mopen:or,minner:or},mopen:{},mclose:{mop:ir,mbin:sr,mrel:or,minner:ir},mpunct:{mord:ir,mop:ir,mrel:or,mopen:ir,mclose:ir,mpunct:ir,minner:ir},minner:{mord:ir,mop:ir,mbin:sr,mrel:or,mopen:ir,mpunct:ir,minner:ir}},hr={mord:{mop:ir},mop:{mord:ir,mop:ir},mbin:{},mrel:{},mopen:{},mclose:{mop:ir},mpunct:{},minner:{mop:ir}},cr={},pr={},mr={};function ur(e){for(var{type:t,names:r,props:n,handler:a,htmlBuilder:i,mathmlBuilder:s}=e,o={type:t,numArgs:n.numArgs,argTypes:n.argTypes,allowedInArgument:!!n.allowedInArgument,allowedInText:!!n.allowedInText,allowedInMath:void 0===n.allowedInMath||n.allowedInMath,numOptionalArgs:n.numOptionalArgs||0,infix:!!n.infix,primitive:!!n.primitive,handler:a},l=0;l<r.length;++l)cr[r[l]]=o;t&&(i&&(pr[t]=i),s&&(mr[t]=s))}function dr(e){var{type:t,htmlBuilder:r,mathmlBuilder:n}=e;ur({type:t,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:r,mathmlBuilder:n})}var gr=function(e){return"ordgroup"===e.type&&1===e.body.length?e.body[0]:e},fr=function(e){return"ordgroup"===e.type?e.body:[e]},br=ar.makeSpan,vr=["leftmost","mbin","mopen","mrel","mop","mpunct"],xr=["rightmost","mrel","mclose","mpunct"],yr={display:Ce.DISPLAY,text:Ce.TEXT,script:Ce.SCRIPT,scriptscript:Ce.SCRIPTSCRIPT},wr={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},kr=function(e,t,r,n){void 0===n&&(n=[null,null]);for(var a=[],i=0;i<e.length;i++){var s=Br(e[i],t);if(s instanceof He){var o=s.children;a.push(...o)}else a.push(s)}if(ar.tryCombineChars(a),!r)return a;var l=t;if(1===e.length){var h=e[0];"sizing"===h.type?l=t.havingSize(h.size):"styling"===h.type&&(l=t.havingStyle(yr[h.style]))}var c=br([n[0]||"leftmost"],[],t),p=br([n[1]||"rightmost"],[],t),m="root"===r;return Sr(a,((e,t)=>{var r=t.classes[0],n=e.classes[0];"mbin"===r&&be.contains(xr,n)?t.classes[0]="mord":"mbin"===n&&be.contains(vr,r)&&(e.classes[0]="mord")}),{node:c},p,m),Sr(a,((e,t)=>{var r=Tr(t),n=Tr(e),a=r&&n?e.hasClass("mtight")?hr[r][n]:lr[r][n]:null;if(a)return ar.makeGlue(a,l)}),{node:c},p,m),a},Sr=function e(t,r,n,a,i){a&&t.push(a);for(var s=0;s<t.length;s++){var o=t[s],l=zr(o);if(l)e(l.children,r,n,null,i);else{var h=!o.hasClass("mspace");if(h){var c=r(o,n.node);c&&(n.insertAfter?n.insertAfter(c):(t.unshift(c),s++))}h?n.node=o:i&&o.hasClass("newline")&&(n.node=br(["leftmost"])),n.insertAfter=(e=>r=>{t.splice(e+1,0,r),s++})(s)}}a&&t.pop()},zr=function(e){return e instanceof He||e instanceof tt||e instanceof et&&e.hasClass("enclosing")?e:null},Mr=function e(t,r){var n=zr(t);if(n){var a=n.children;if(a.length){if("right"===r)return e(a[a.length-1],"right");if("left"===r)return e(a[0],"left")}}return t},Tr=function(e,t){return e?(t&&(e=Mr(e,t)),wr[e.classes[0]]||null):null},Ar=function(e,t){var r=["nulldelimiter"].concat(e.baseSizingClasses());return br(t.concat(r))},Br=function(e,t,r){if(!e)return br();if(pr[e.type]){var n=pr[e.type](e,t);if(r&&t.size!==r.size){n=br(t.sizingClasses(r),[n],t);var a=t.sizeMultiplier/r.sizeMultiplier;n.height*=a,n.depth*=a}return n}throw new me("Got group of unknown type: '"+e.type+"'")};function Cr(e,t){var r=br(["base"],e,t),n=br(["strut"]);return n.style.height=Ze(r.height+r.depth),r.depth&&(n.style.verticalAlign=Ze(-r.depth)),r.children.unshift(n),r}function qr(e,t){var r=null;1===e.length&&"tag"===e[0].type&&(r=e[0].tag,e=e[0].body);var n,a=kr(e,t,"root");2===a.length&&a[1].hasClass("tag")&&(n=a.pop());for(var i,s=[],o=[],l=0;l<a.length;l++)if(o.push(a[l]),a[l].hasClass("mbin")||a[l].hasClass("mrel")||a[l].hasClass("allowbreak")){for(var h=!1;l<a.length-1&&a[l+1].hasClass("mspace")&&!a[l+1].hasClass("newline");)l++,o.push(a[l]),a[l].hasClass("nobreak")&&(h=!0);h||(s.push(Cr(o,t)),o=[])}else a[l].hasClass("newline")&&(o.pop(),o.length>0&&(s.push(Cr(o,t)),o=[]),s.push(a[l]));o.length>0&&s.push(Cr(o,t)),r?((i=Cr(kr(r,t,!0))).classes=["tag"],s.push(i)):n&&s.push(n);var c=br(["katex-html"],s);if(c.setAttribute("aria-hidden","true"),i){var p=i.children[0];p.style.height=Ze(c.height+c.depth),c.depth&&(p.style.verticalAlign=Ze(-c.depth))}return c}function Nr(e){return new He(e)}class Rr{constructor(e,t,r){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=e,this.attributes={},this.children=t||[],this.classes=r||[]}setAttribute(e,t){this.attributes[e]=t}getAttribute(e){return this.attributes[e]}toNode(){var e=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);this.classes.length>0&&(e.className=je(this.classes));for(var r=0;r<this.children.length;r++)e.appendChild(this.children[r].toNode());return e}toMarkup(){var e="<"+this.type;for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="',e+=be.escape(this.attributes[t]),e+='"');this.classes.length>0&&(e+=' class ="'+be.escape(je(this.classes))+'"'),e+=">";for(var r=0;r<this.children.length;r++)e+=this.children[r].toMarkup();return e+="</"+this.type+">"}toText(){return this.children.map((e=>e.toText())).join("")}}class Ir{constructor(e){this.text=void 0,this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return be.escape(this.toText())}toText(){return this.text}}var Er={MathNode:Rr,TextNode:Ir,SpaceNode:class{constructor(e){this.width=void 0,this.character=void 0,this.width=e,this.character=e>=.05555&&e<=.05556?" ":e>=.1666&&e<=.1667?" ":e>=.2222&&e<=.2223?" ":e>=.2777&&e<=.2778?"  ":e>=-.05556&&e<=-.05555?" ⁣":e>=-.1667&&e<=-.1666?" ⁣":e>=-.2223&&e<=-.2222?" ⁣":e>=-.2778&&e<=-.2777?" ⁣":null}toNode(){if(this.character)return document.createTextNode(this.character);var e=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return e.setAttribute("width",Ze(this.width)),e}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+Ze(this.width)+'"/>'}toText(){return this.character?this.character:" "}},newDocumentFragment:Nr},Hr=function(e,t,r){return!pt[t][e]||!pt[t][e].replace||55349===e.charCodeAt(0)||Bt.hasOwnProperty(e)&&r&&(r.fontFamily&&"tt"===r.fontFamily.slice(4,6)||r.font&&"tt"===r.font.slice(4,6))||(e=pt[t][e].replace),new Er.TextNode(e)},Or=function(e){return 1===e.length?e[0]:new Er.MathNode("mrow",e)},Lr=function(e,t){if("texttt"===t.fontFamily)return"monospace";if("textsf"===t.fontFamily)return"textit"===t.fontShape&&"textbf"===t.fontWeight?"sans-serif-bold-italic":"textit"===t.fontShape?"sans-serif-italic":"textbf"===t.fontWeight?"bold-sans-serif":"sans-serif";if("textit"===t.fontShape&&"textbf"===t.fontWeight)return"bold-italic";if("textit"===t.fontShape)return"italic";if("textbf"===t.fontWeight)return"bold";var r=t.font;if(!r||"mathnormal"===r)return null;var n=e.mode;if("mathit"===r)return"italic";if("boldsymbol"===r)return"textord"===e.type?"bold":"bold-italic";if("mathbf"===r)return"bold";if("mathbb"===r)return"double-struck";if("mathfrak"===r)return"fraktur";if("mathscr"===r||"mathcal"===r)return"script";if("mathsf"===r)return"sans-serif";if("mathtt"===r)return"monospace";var a=e.text;return be.contains(["\\imath","\\jmath"],a)?null:(pt[n][a]&&pt[n][a].replace&&(a=pt[n][a].replace),Pe(a,ar.fontMap[r].fontName,n)?ar.fontMap[r].variant:null)},Dr=function(e,t,r){if(1===e.length){var n=$r(e[0],t);return r&&n instanceof Rr&&"mo"===n.type&&(n.setAttribute("lspace","0em"),n.setAttribute("rspace","0em")),[n]}for(var a,i=[],s=0;s<e.length;s++){var o=$r(e[s],t);if(o instanceof Rr&&a instanceof Rr){if("mtext"===o.type&&"mtext"===a.type&&o.getAttribute("mathvariant")===a.getAttribute("mathvariant")){a.children.push(...o.children);continue}if("mn"===o.type&&"mn"===a.type){a.children.push(...o.children);continue}if("mi"===o.type&&1===o.children.length&&"mn"===a.type){var l=o.children[0];if(l instanceof Ir&&"."===l.text){a.children.push(...o.children);continue}}else if("mi"===a.type&&1===a.children.length){var h=a.children[0];if(h instanceof Ir&&"̸"===h.text&&("mo"===o.type||"mi"===o.type||"mn"===o.type)){var c=o.children[0];c instanceof Ir&&c.text.length>0&&(c.text=c.text.slice(0,1)+"̸"+c.text.slice(1),i.pop())}}}i.push(o),a=o}return i},Pr=function(e,t,r){return Or(Dr(e,t,r))},$r=function(e,t){if(!e)return new Er.MathNode("mrow");if(mr[e.type])return mr[e.type](e,t);throw new me("Got group of unknown type: '"+e.type+"'")};function Vr(e,t,r,n,a){var i,s=Dr(e,r);i=1===s.length&&s[0]instanceof Rr&&be.contains(["mrow","mtable"],s[0].type)?s[0]:new Er.MathNode("mrow",s);var o=new Er.MathNode("annotation",[new Er.TextNode(t)]);o.setAttribute("encoding","application/x-tex");var l=new Er.MathNode("semantics",[i,o]),h=new Er.MathNode("math",[l]);h.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),n&&h.setAttribute("display","block");var c=a?"katex":"katex-mathml";return ar.makeSpan([c],[h])}var Fr=function(e){return new Ge({style:e.displayMode?Ce.DISPLAY:Ce.TEXT,maxSize:e.maxSize,minRuleThickness:e.minRuleThickness})},_r=function(e,t){if(t.displayMode){var r=["katex-display"];t.leqno&&r.push("leqno"),t.fleqn&&r.push("fleqn"),e=ar.makeSpan(r,[e])}return e},Gr={widehat:"^",widecheck:"ˇ",widetilde:"~",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",undergroup:"⏡",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xrightleftharpoons:"⇌",xleftrightharpoons:"⇋",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xtofrom:"⇄",xrightleftarrows:"⇄",xrightequilibrium:"⇌",xleftequilibrium:"⇋","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="},Ur={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},Xr=function(e,t,r,n,a){var i,s=e.height+e.depth+r+n;if(/fbox|color|angl/.test(t)){if(i=ar.makeSpan(["stretchy",t],[],a),"fbox"===t){var o=a.color&&a.getColor();o&&(i.style.borderColor=o)}}else{var l=[];/^[bx]cancel$/.test(t)&&l.push(new ot({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(t)&&l.push(new ot({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var h=new it(l,{width:"100%",height:Ze(s)});i=ar.makeSvgSpan([],[h],a)}return i.height=s,i.style.height=Ze(s),i},Yr=function(e){var t=new Er.MathNode("mo",[new Er.TextNode(Gr[e.replace(/^\\/,"")])]);return t.setAttribute("stretchy","true"),t},Wr=function(e,t){var{span:r,minWidth:n,height:a}=function(){var r=4e5,n=e.label.slice(1);if(be.contains(["widehat","widecheck","widetilde","utilde"],n)){var a,i,s,o="ordgroup"===(u=e.base).type?u.body.length:1;if(o>5)"widehat"===n||"widecheck"===n?(a=420,r=2364,s=.42,i=n+"4"):(a=312,r=2340,s=.34,i="tilde4");else{var l=[1,1,2,2,3,3][o];"widehat"===n||"widecheck"===n?(r=[0,1062,2364,2364,2364][l],a=[0,239,300,360,420][l],s=[0,.24,.3,.3,.36,.42][l],i=n+l):(r=[0,600,1033,2339,2340][l],a=[0,260,286,306,312][l],s=[0,.26,.286,.3,.306,.34][l],i="tilde"+l)}var h=new st(i),c=new it([h],{width:"100%",height:Ze(s),viewBox:"0 0 "+r+" "+a,preserveAspectRatio:"none"});return{span:ar.makeSvgSpan([],[c],t),minWidth:0,height:s}}var p,m,u,d=[],g=Ur[n],[f,b,v]=g,x=v/1e3,y=f.length;if(1===y)p=["hide-tail"],m=[g[3]];else if(2===y)p=["halfarrow-left","halfarrow-right"],m=["xMinYMin","xMaxYMin"];else{if(3!==y)throw new Error("Correct katexImagesData or update code here to support\n                    "+y+" children.");p=["brace-left","brace-center","brace-right"],m=["xMinYMin","xMidYMin","xMaxYMin"]}for(var w=0;w<y;w++){var k=new st(f[w]),S=new it([k],{width:"400em",height:Ze(x),viewBox:"0 0 "+r+" "+v,preserveAspectRatio:m[w]+" slice"}),z=ar.makeSvgSpan([p[w]],[S],t);if(1===y)return{span:z,minWidth:b,height:x};z.style.height=Ze(x),d.push(z)}return{span:ar.makeSpan(["stretchy"],d,t),minWidth:b,height:x}}();return r.height=a,r.style.height=Ze(a),n>0&&(r.style.minWidth=Ze(n)),r};function Zr(e,t){if(!e||e.type!==t)throw new Error("Expected node of type "+t+", but got "+(e?"node of type "+e.type:String(e)));return e}function jr(e){var t=Kr(e);if(!t)throw new Error("Expected node of symbol group type, but got "+(e?"node of type "+e.type:String(e)));return t}function Kr(e){return e&&("atom"===e.type||ct.hasOwnProperty(e.type))?e:null}var Qr=(e,t)=>{var r,n,a;e&&"supsub"===e.type?(r=(n=Zr(e.base,"accent")).base,e.base=r,a=function(e){if(e instanceof et)return e;throw new Error("Expected span<HtmlDomNode> but got "+String(e)+".")}(Br(e,t)),e.base=n):r=(n=Zr(e,"accent")).base;var i=Br(r,t.havingCrampedStyle()),s=0;if(n.isShifty&&be.isCharacterBox(r)){var o=be.getBaseElem(r);s=lt(Br(o,t.havingCrampedStyle())).skew}var l,h="\\c"===n.label,c=h?i.height+i.depth:Math.min(i.height,t.fontMetrics().xHeight);if(n.isStretchy)l=Wr(n,t),l=ar.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"elem",elem:l,wrapperClasses:["svg-align"],wrapperStyle:s>0?{width:"calc(100% - "+Ze(2*s)+")",marginLeft:Ze(2*s)}:void 0}]},t);else{var p,m;"\\vec"===n.label?(p=ar.staticSvg("vec",t),m=ar.svgData.vec[1]):((p=lt(p=ar.makeOrd({mode:n.mode,text:n.label},t,"textord"))).italic=0,m=p.width,h&&(c+=p.depth)),l=ar.makeSpan(["accent-body"],[p]);var u="\\textcircled"===n.label;u&&(l.classes.push("accent-full"),c=i.height);var d=s;u||(d-=m/2),l.style.left=Ze(d),"\\textcircled"===n.label&&(l.style.top=".2em"),l=ar.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"kern",size:-c},{type:"elem",elem:l}]},t)}var g=ar.makeSpan(["mord","accent"],[l],t);return a?(a.children[0]=g,a.height=Math.max(g.height,a.height),a.classes[0]="mord",a):g},Jr=(e,t)=>{var r=e.isStretchy?Yr(e.label):new Er.MathNode("mo",[Hr(e.label,e.mode)]),n=new Er.MathNode("mover",[$r(e.base,t),r]);return n.setAttribute("accent","true"),n},en=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map((e=>"\\"+e)).join("|"));ur({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(e,t)=>{var r=gr(t[0]),n=!en.test(e.funcName),a=!n||"\\widehat"===e.funcName||"\\widetilde"===e.funcName||"\\widecheck"===e.funcName;return{type:"accent",mode:e.parser.mode,label:e.funcName,isStretchy:n,isShifty:a,base:r}},htmlBuilder:Qr,mathmlBuilder:Jr}),ur({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(e,t)=>{var r=t[0],n=e.parser.mode;return"math"===n&&(e.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+e.funcName+" works only in text mode"),n="text"),{type:"accent",mode:n,label:e.funcName,isStretchy:!1,isShifty:!0,base:r}},htmlBuilder:Qr,mathmlBuilder:Jr}),ur({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(e,t)=>{var{parser:r,funcName:n}=e,a=t[0];return{type:"accentUnder",mode:r.mode,label:n,base:a}},htmlBuilder:(e,t)=>{var r=Br(e.base,t),n=Wr(e,t),a="\\utilde"===e.label?.12:0,i=ar.makeVList({positionType:"top",positionData:r.height,children:[{type:"elem",elem:n,wrapperClasses:["svg-align"]},{type:"kern",size:a},{type:"elem",elem:r}]},t);return ar.makeSpan(["mord","accentunder"],[i],t)},mathmlBuilder:(e,t)=>{var r=Yr(e.label),n=new Er.MathNode("munder",[$r(e.base,t),r]);return n.setAttribute("accentunder","true"),n}});var tn=e=>{var t=new Er.MathNode("mpadded",e?[e]:[]);return t.setAttribute("width","+0.6em"),t.setAttribute("lspace","0.3em"),t};ur({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,r){var{parser:n,funcName:a}=e;return{type:"xArrow",mode:n.mode,label:a,body:t[0],below:r[0]}},htmlBuilder(e,t){var r,n=t.style,a=t.havingStyle(n.sup()),i=ar.wrapFragment(Br(e.body,a,t),t),s="\\x"===e.label.slice(0,2)?"x":"cd";i.classes.push(s+"-arrow-pad"),e.below&&(a=t.havingStyle(n.sub()),(r=ar.wrapFragment(Br(e.below,a,t),t)).classes.push(s+"-arrow-pad"));var o,l=Wr(e,t),h=-t.fontMetrics().axisHeight+.5*l.height,c=-t.fontMetrics().axisHeight-.5*l.height-.111;if((i.depth>.25||"\\xleftequilibrium"===e.label)&&(c-=i.depth),r){var p=-t.fontMetrics().axisHeight+r.height+.5*l.height+.111;o=ar.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:c},{type:"elem",elem:l,shift:h},{type:"elem",elem:r,shift:p}]},t)}else o=ar.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:c},{type:"elem",elem:l,shift:h}]},t);return o.children[0].children[0].children[1].classes.push("svg-align"),ar.makeSpan(["mrel","x-arrow"],[o],t)},mathmlBuilder(e,t){var r,n=Yr(e.label);if(n.setAttribute("minsize","x"===e.label.charAt(0)?"1.75em":"3.0em"),e.body){var a=tn($r(e.body,t));if(e.below){var i=tn($r(e.below,t));r=new Er.MathNode("munderover",[n,i,a])}else r=new Er.MathNode("mover",[n,a])}else if(e.below){var s=tn($r(e.below,t));r=new Er.MathNode("munder",[n,s])}else r=tn(),r=new Er.MathNode("mover",[n,r]);return r}});var rn=ar.makeSpan;function nn(e,t){var r=kr(e.body,t,!0);return rn([e.mclass],r,t)}function an(e,t){var r,n=Dr(e.body,t);return"minner"===e.mclass?r=new Er.MathNode("mpadded",n):"mord"===e.mclass?e.isCharacterBox?(r=n[0]).type="mi":r=new Er.MathNode("mi",n):(e.isCharacterBox?(r=n[0]).type="mo":r=new Er.MathNode("mo",n),"mbin"===e.mclass?(r.attributes.lspace="0.22em",r.attributes.rspace="0.22em"):"mpunct"===e.mclass?(r.attributes.lspace="0em",r.attributes.rspace="0.17em"):"mopen"===e.mclass||"mclose"===e.mclass?(r.attributes.lspace="0em",r.attributes.rspace="0em"):"minner"===e.mclass&&(r.attributes.lspace="0.0556em",r.attributes.width="+0.1111em")),r}ur({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(e,t){var{parser:r,funcName:n}=e,a=t[0];return{type:"mclass",mode:r.mode,mclass:"m"+n.slice(5),body:fr(a),isCharacterBox:be.isCharacterBox(a)}},htmlBuilder:nn,mathmlBuilder:an});var sn=e=>{var t="ordgroup"===e.type&&e.body.length?e.body[0]:e;return"atom"!==t.type||"bin"!==t.family&&"rel"!==t.family?"mord":"m"+t.family};ur({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(e,t){var{parser:r}=e;return{type:"mclass",mode:r.mode,mclass:sn(t[0]),body:fr(t[1]),isCharacterBox:be.isCharacterBox(t[1])}}}),ur({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(e,t){var r,{parser:n,funcName:a}=e,i=t[1],s=t[0];r="\\stackrel"!==a?sn(i):"mrel";var o={type:"op",mode:i.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:"\\stackrel"!==a,body:fr(i)},l={type:"supsub",mode:s.mode,base:o,sup:"\\underset"===a?null:s,sub:"\\underset"===a?s:null};return{type:"mclass",mode:n.mode,mclass:r,body:[l],isCharacterBox:be.isCharacterBox(l)}},htmlBuilder:nn,mathmlBuilder:an}),ur({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(e,t){var{parser:r}=e;return{type:"pmb",mode:r.mode,mclass:sn(t[0]),body:fr(t[0])}},htmlBuilder(e,t){var r=kr(e.body,t,!0),n=ar.makeSpan([e.mclass],r,t);return n.style.textShadow="0.02em 0.01em 0.04px",n},mathmlBuilder(e,t){var r=Dr(e.body,t),n=new Er.MathNode("mstyle",r);return n.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),n}});var on={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},ln=e=>"textord"===e.type&&"@"===e.text;function hn(e,t,r){var n=on[e];switch(n){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return r.callFunction(n,[t[0]],[t[1]]);case"\\uparrow":case"\\downarrow":var a={type:"atom",text:n,mode:"math",family:"rel"},i={type:"ordgroup",mode:"math",body:[r.callFunction("\\\\cdleft",[t[0]],[]),r.callFunction("\\Big",[a],[]),r.callFunction("\\\\cdright",[t[1]],[])]};return r.callFunction("\\\\cdparent",[i],[]);case"\\\\cdlongequal":return r.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":return r.callFunction("\\Big",[{type:"textord",text:"\\Vert",mode:"math"}],[]);default:return{type:"textord",text:" ",mode:"math"}}}ur({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(e,t){var{parser:r,funcName:n}=e;return{type:"cdlabel",mode:r.mode,side:n.slice(4),label:t[0]}},htmlBuilder(e,t){var r=t.havingStyle(t.style.sup()),n=ar.wrapFragment(Br(e.label,r,t),t);return n.classes.push("cd-label-"+e.side),n.style.bottom=Ze(.8-n.depth),n.height=0,n.depth=0,n},mathmlBuilder(e,t){var r=new Er.MathNode("mrow",[$r(e.label,t)]);return(r=new Er.MathNode("mpadded",[r])).setAttribute("width","0"),"left"===e.side&&r.setAttribute("lspace","-1width"),r.setAttribute("voffset","0.7em"),(r=new Er.MathNode("mstyle",[r])).setAttribute("displaystyle","false"),r.setAttribute("scriptlevel","1"),r}}),ur({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(e,t){var{parser:r}=e;return{type:"cdlabelparent",mode:r.mode,fragment:t[0]}},htmlBuilder(e,t){var r=ar.wrapFragment(Br(e.fragment,t),t);return r.classes.push("cd-vert-arrow"),r},mathmlBuilder:(e,t)=>new Er.MathNode("mrow",[$r(e.fragment,t)])}),ur({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(e,t){for(var{parser:r}=e,n=Zr(t[0],"ordgroup").body,a="",i=0;i<n.length;i++){a+=Zr(n[i],"textord").text}var s,o=parseInt(a);if(isNaN(o))throw new me("\\@char has non-numeric argument "+a);if(o<0||o>=1114111)throw new me("\\@char with invalid code point "+a);return o<=65535?s=String.fromCharCode(o):(o-=65536,s=String.fromCharCode(55296+(o>>10),56320+(1023&o))),{type:"textord",mode:r.mode,text:s}}});var cn=(e,t)=>{var r=kr(e.body,t.withColor(e.color),!1);return ar.makeFragment(r)},pn=(e,t)=>{var r=Dr(e.body,t.withColor(e.color)),n=new Er.MathNode("mstyle",r);return n.setAttribute("mathcolor",e.color),n};ur({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(e,t){var{parser:r}=e,n=Zr(t[0],"color-token").color,a=t[1];return{type:"color",mode:r.mode,color:n,body:fr(a)}},htmlBuilder:cn,mathmlBuilder:pn}),ur({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(e,t){var{parser:r,breakOnTokenText:n}=e,a=Zr(t[0],"color-token").color;r.gullet.macros.set("\\current@color",a);var i=r.parseExpression(!0,n);return{type:"color",mode:r.mode,color:a,body:i}},htmlBuilder:cn,mathmlBuilder:pn}),ur({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(e,t,r){var{parser:n}=e,a="["===n.gullet.future().text?n.parseSizeGroup(!0):null,i=!n.settings.displayMode||!n.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:n.mode,newLine:i,size:a&&Zr(a,"size").value}},htmlBuilder(e,t){var r=ar.makeSpan(["mspace"],[],t);return e.newLine&&(r.classes.push("newline"),e.size&&(r.style.marginTop=Ze(We(e.size,t)))),r},mathmlBuilder(e,t){var r=new Er.MathNode("mspace");return e.newLine&&(r.setAttribute("linebreak","newline"),e.size&&r.setAttribute("height",Ze(We(e.size,t)))),r}});var mn={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},un=e=>{var t=e.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(t))throw new me("Expected a control sequence",e);return t},dn=(e,t,r,n)=>{var a=e.gullet.macros.get(r.text);null==a&&(r.noexpand=!0,a={tokens:[r],numArgs:0,unexpandable:!e.gullet.isExpandable(r.text)}),e.gullet.macros.set(t,a,n)};ur({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(e){var{parser:t,funcName:r}=e;t.consumeSpaces();var n=t.fetch();if(mn[n.text])return"\\global"!==r&&"\\\\globallong"!==r||(n.text=mn[n.text]),Zr(t.parseFunction(),"internal");throw new me("Invalid token after macro prefix",n)}}),ur({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:r}=e,n=t.gullet.popToken(),a=n.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(a))throw new me("Expected a control sequence",n);for(var i,s=0,o=[[]];"{"!==t.gullet.future().text;)if("#"===(n=t.gullet.popToken()).text){if("{"===t.gullet.future().text){i=t.gullet.future(),o[s].push("{");break}if(n=t.gullet.popToken(),!/^[1-9]$/.test(n.text))throw new me('Invalid argument number "'+n.text+'"');if(parseInt(n.text)!==s+1)throw new me('Argument number "'+n.text+'" out of order');s++,o.push([])}else{if("EOF"===n.text)throw new me("Expected a macro definition");o[s].push(n.text)}var{tokens:l}=t.gullet.consumeArg();return i&&l.unshift(i),"\\edef"!==r&&"\\xdef"!==r||(l=t.gullet.expandTokens(l)).reverse(),t.gullet.macros.set(a,{tokens:l,numArgs:s,delimiters:o},r===mn[r]),{type:"internal",mode:t.mode}}}),ur({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:r}=e,n=un(t.gullet.popToken());t.gullet.consumeSpaces();var a=(e=>{var t=e.gullet.popToken();return"="===t.text&&" "===(t=e.gullet.popToken()).text&&(t=e.gullet.popToken()),t})(t);return dn(t,n,a,"\\\\globallet"===r),{type:"internal",mode:t.mode}}}),ur({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:r}=e,n=un(t.gullet.popToken()),a=t.gullet.popToken(),i=t.gullet.popToken();return dn(t,n,i,"\\\\globalfuture"===r),t.gullet.pushToken(i),t.gullet.pushToken(a),{type:"internal",mode:t.mode}}});var gn=function(e,t,r){var n=Pe(pt.math[e]&&pt.math[e].replace||e,t,r);if(!n)throw new Error("Unsupported symbol "+e+" and font size "+t+".");return n},fn=function(e,t,r,n){var a=r.havingBaseStyle(t),i=ar.makeSpan(n.concat(a.sizingClasses(r)),[e],r),s=a.sizeMultiplier/r.sizeMultiplier;return i.height*=s,i.depth*=s,i.maxFontSize=a.sizeMultiplier,i},bn=function(e,t,r){var n=t.havingBaseStyle(r),a=(1-t.sizeMultiplier/n.sizeMultiplier)*t.fontMetrics().axisHeight;e.classes.push("delimcenter"),e.style.top=Ze(a),e.height-=a,e.depth+=a},vn=function(e,t,r,n,a,i){var s=function(e,t,r,n){return ar.makeSymbol(e,"Size"+t+"-Regular",r,n)}(e,t,a,n),o=fn(ar.makeSpan(["delimsizing","size"+t],[s],n),Ce.TEXT,n,i);return r&&bn(o,n,Ce.TEXT),o},xn=function(e,t,r){var n;return n="Size1-Regular"===t?"delim-size1":"delim-size4",{type:"elem",elem:ar.makeSpan(["delimsizinginner",n],[ar.makeSpan([],[ar.makeSymbol(e,t,r)])])}},yn=function(e,t,r){var n=Oe["Size4-Regular"][e.charCodeAt(0)]?Oe["Size4-Regular"][e.charCodeAt(0)][4]:Oe["Size1-Regular"][e.charCodeAt(0)][4],a=new st("inner",function(e,t){switch(e){case"⎜":return"M291 0 H417 V"+t+" H291z M291 0 H417 V"+t+" H291z";case"∣":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145z";case"∥":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145zM367 0 H410 V"+t+" H367z M367 0 H410 V"+t+" H367z";case"⎟":return"M457 0 H583 V"+t+" H457z M457 0 H583 V"+t+" H457z";case"⎢":return"M319 0 H403 V"+t+" H319z M319 0 H403 V"+t+" H319z";case"⎥":return"M263 0 H347 V"+t+" H263z M263 0 H347 V"+t+" H263z";case"⎪":return"M384 0 H504 V"+t+" H384z M384 0 H504 V"+t+" H384z";case"⏐":return"M312 0 H355 V"+t+" H312z M312 0 H355 V"+t+" H312z";case"‖":return"M257 0 H300 V"+t+" H257z M257 0 H300 V"+t+" H257zM478 0 H521 V"+t+" H478z M478 0 H521 V"+t+" H478z";default:return""}}(e,Math.round(1e3*t))),i=new it([a],{width:Ze(n),height:Ze(t),style:"width:"+Ze(n),viewBox:"0 0 "+1e3*n+" "+Math.round(1e3*t),preserveAspectRatio:"xMinYMin"}),s=ar.makeSvgSpan([],[i],r);return s.height=t,s.style.height=Ze(t),s.style.width=Ze(n),{type:"elem",elem:s}},wn={type:"kern",size:-.008},kn=["|","\\lvert","\\rvert","\\vert"],Sn=["\\|","\\lVert","\\rVert","\\Vert"],zn=function(e,t,r,n,a,i){var s,o,l,h,c="",p=0;s=l=h=e,o=null;var m="Size1-Regular";"\\uparrow"===e?l=h="⏐":"\\Uparrow"===e?l=h="‖":"\\downarrow"===e?s=l="⏐":"\\Downarrow"===e?s=l="‖":"\\updownarrow"===e?(s="\\uparrow",l="⏐",h="\\downarrow"):"\\Updownarrow"===e?(s="\\Uparrow",l="‖",h="\\Downarrow"):be.contains(kn,e)?(l="∣",c="vert",p=333):be.contains(Sn,e)?(l="∥",c="doublevert",p=556):"["===e||"\\lbrack"===e?(s="⎡",l="⎢",h="⎣",m="Size4-Regular",c="lbrack",p=667):"]"===e||"\\rbrack"===e?(s="⎤",l="⎥",h="⎦",m="Size4-Regular",c="rbrack",p=667):"\\lfloor"===e||"⌊"===e?(l=s="⎢",h="⎣",m="Size4-Regular",c="lfloor",p=667):"\\lceil"===e||"⌈"===e?(s="⎡",l=h="⎢",m="Size4-Regular",c="lceil",p=667):"\\rfloor"===e||"⌋"===e?(l=s="⎥",h="⎦",m="Size4-Regular",c="rfloor",p=667):"\\rceil"===e||"⌉"===e?(s="⎤",l=h="⎥",m="Size4-Regular",c="rceil",p=667):"("===e||"\\lparen"===e?(s="⎛",l="⎜",h="⎝",m="Size4-Regular",c="lparen",p=875):")"===e||"\\rparen"===e?(s="⎞",l="⎟",h="⎠",m="Size4-Regular",c="rparen",p=875):"\\{"===e||"\\lbrace"===e?(s="⎧",o="⎨",h="⎩",l="⎪",m="Size4-Regular"):"\\}"===e||"\\rbrace"===e?(s="⎫",o="⎬",h="⎭",l="⎪",m="Size4-Regular"):"\\lgroup"===e||"⟮"===e?(s="⎧",h="⎩",l="⎪",m="Size4-Regular"):"\\rgroup"===e||"⟯"===e?(s="⎫",h="⎭",l="⎪",m="Size4-Regular"):"\\lmoustache"===e||"⎰"===e?(s="⎧",h="⎭",l="⎪",m="Size4-Regular"):"\\rmoustache"!==e&&"⎱"!==e||(s="⎫",h="⎩",l="⎪",m="Size4-Regular");var u=gn(s,m,a),d=u.height+u.depth,g=gn(l,m,a),f=g.height+g.depth,b=gn(h,m,a),v=b.height+b.depth,x=0,y=1;if(null!==o){var w=gn(o,m,a);x=w.height+w.depth,y=2}var k=d+v+x,S=k+Math.max(0,Math.ceil((t-k)/(y*f)))*y*f,z=n.fontMetrics().axisHeight;r&&(z*=n.sizeMultiplier);var M=S/2-z,T=[];if(c.length>0){var A=S-d-v,B=Math.round(1e3*S),C=function(e,t){switch(e){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+" v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v"+t+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+" v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v"+t+" v1759 h84z";case"vert":return"M145 15 v585 v"+t+" v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v"+-t+" v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v"+t+" v585 h43z";case"doublevert":return"M145 15 v585 v"+t+" v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v"+-t+" v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v"+t+" v585 h43z\nM367 15 v585 v"+t+" v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v"+-t+" v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M410 15 H367 v585 v"+t+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+t+" v1715 h263 v84 H319z\nMM319 602 V0 H403 V602 v"+t+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+t+" v1799 H0 v-84 H319z\nMM319 602 V0 H403 V602 v"+t+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+" v602 h84z\nM403 1759 V0 H319 V1759 v"+t+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+" v602 h84z\nM347 1759 V0 h-84 V1759 v"+t+" v602 h84z";case"lparen":return"M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\n-36,557 l0,"+(t+84)+"c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\nl0,-"+(t+92)+"c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z";case"rparen":return"M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,"+(t+9)+"\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\nl0,-"+(t+144)+"c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z";default:throw new Error("Unknown stretchy delimiter.")}}(c,Math.round(1e3*A)),q=new st(c,C),N=(p/1e3).toFixed(3)+"em",R=(B/1e3).toFixed(3)+"em",I=new it([q],{width:N,height:R,viewBox:"0 0 "+p+" "+B}),E=ar.makeSvgSpan([],[I],n);E.height=B/1e3,E.style.width=N,E.style.height=R,T.push({type:"elem",elem:E})}else{if(T.push(xn(h,m,a)),T.push(wn),null===o){var H=S-d-v+.016;T.push(yn(l,H,n))}else{var O=(S-d-v-x)/2+.016;T.push(yn(l,O,n)),T.push(wn),T.push(xn(o,m,a)),T.push(wn),T.push(yn(l,O,n))}T.push(wn),T.push(xn(s,m,a))}var L=n.havingBaseStyle(Ce.TEXT),D=ar.makeVList({positionType:"bottom",positionData:M,children:T},L);return fn(ar.makeSpan(["delimsizing","mult"],[D],L),Ce.TEXT,n,i)},Mn=.08,Tn=function(e,t,r,n,a){var i=function(e,t,r){t*=1e3;var n="";switch(e){case"sqrtMain":n=function(e,t){return"M95,"+(622+e+t)+"\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl"+e/2.075+" -"+e+"\nc5.3,-9.3,12,-14,20,-14\nH400000v"+(40+e)+"H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM"+(834+e)+" "+t+"h400000v"+(40+e)+"h-400000z"}(t,Ie);break;case"sqrtSize1":n=function(e,t){return"M263,"+(601+e+t)+"c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl"+e/2.084+" -"+e+"\nc4.7,-7.3,11,-11,19,-11\nH40000v"+(40+e)+"H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM"+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"}(t,Ie);break;case"sqrtSize2":n=function(e,t){return"M983 "+(10+e+t)+"\nl"+e/3.13+" -"+e+"\nc4,-6.7,10,-10,18,-10 H400000v"+(40+e)+"\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM"+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"}(t,Ie);break;case"sqrtSize3":n=function(e,t){return"M424,"+(2398+e+t)+"\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl"+e/4.223+" -"+e+"c4,-6.7,10,-10,18,-10 H400000\nv"+(40+e)+"H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M"+(1001+e)+" "+t+"\nh400000v"+(40+e)+"h-400000z"}(t,Ie);break;case"sqrtSize4":n=function(e,t){return"M473,"+(2713+e+t)+"\nc339.3,-1799.3,509.3,-2700,510,-2702 l"+e/5.298+" -"+e+"\nc3.3,-7.3,9.3,-11,18,-11 H400000v"+(40+e)+"H1017.7\ns-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200\nc0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26\ns76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,\n606zM"+(1001+e)+" "+t+"h400000v"+(40+e)+"H1017.7z"}(t,Ie);break;case"sqrtTall":n=function(e,t,r){return"M702 "+(e+t)+"H400000"+(40+e)+"\nH742v"+(r-54-t-e)+"l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 "+t+"H400000v"+(40+e)+"H742z"}(t,Ie,r)}return n}(e,n,r),s=new st(e,i),o=new it([s],{width:"400em",height:Ze(t),viewBox:"0 0 400000 "+r,preserveAspectRatio:"xMinYMin slice"});return ar.makeSvgSpan(["hide-tail"],[o],a)},An=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","\\surd"],Bn=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱"],Cn=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],qn=[0,1.2,1.8,2.4,3],Nn=[{type:"small",style:Ce.SCRIPTSCRIPT},{type:"small",style:Ce.SCRIPT},{type:"small",style:Ce.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],Rn=[{type:"small",style:Ce.SCRIPTSCRIPT},{type:"small",style:Ce.SCRIPT},{type:"small",style:Ce.TEXT},{type:"stack"}],In=[{type:"small",style:Ce.SCRIPTSCRIPT},{type:"small",style:Ce.SCRIPT},{type:"small",style:Ce.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],En=function(e){if("small"===e.type)return"Main-Regular";if("large"===e.type)return"Size"+e.size+"-Regular";if("stack"===e.type)return"Size4-Regular";throw new Error("Add support for delim type '"+e.type+"' here.")},Hn=function(e,t,r,n){for(var a=Math.min(2,3-n.style.size);a<r.length&&"stack"!==r[a].type;a++){var i=gn(e,En(r[a]),"math"),s=i.height+i.depth;if("small"===r[a].type&&(s*=n.havingBaseStyle(r[a].style).sizeMultiplier),s>t)return r[a]}return r[r.length-1]},On=function(e,t,r,n,a,i){var s;"<"===e||"\\lt"===e||"⟨"===e?e="\\langle":">"!==e&&"\\gt"!==e&&"⟩"!==e||(e="\\rangle"),s=be.contains(Cn,e)?Nn:be.contains(An,e)?In:Rn;var o=Hn(e,t,s,n);return"small"===o.type?function(e,t,r,n,a,i){var s=ar.makeSymbol(e,"Main-Regular",a,n),o=fn(s,t,n,i);return r&&bn(o,n,t),o}(e,o.style,r,n,a,i):"large"===o.type?vn(e,o.size,r,n,a,i):zn(e,t,r,n,a,i)},Ln={sqrtImage:function(e,t){var r,n,a=t.havingBaseSizing(),i=Hn("\\surd",e*a.sizeMultiplier,In,a),s=a.sizeMultiplier,o=Math.max(0,t.minRuleThickness-t.fontMetrics().sqrtRuleThickness),l=0,h=0,c=0;return"small"===i.type?(e<1?s=1:e<1.4&&(s=.7),h=(1+o)/s,(r=Tn("sqrtMain",l=(1+o+Mn)/s,c=1e3+1e3*o+80,o,t)).style.minWidth="0.853em",n=.833/s):"large"===i.type?(c=1080*qn[i.size],h=(qn[i.size]+o)/s,l=(qn[i.size]+o+Mn)/s,(r=Tn("sqrtSize"+i.size,l,c,o,t)).style.minWidth="1.02em",n=1/s):(l=e+o+Mn,h=e+o,c=Math.floor(1e3*e+o)+80,(r=Tn("sqrtTall",l,c,o,t)).style.minWidth="0.742em",n=1.056),r.height=h,r.style.height=Ze(l),{span:r,advanceWidth:n,ruleWidth:(t.fontMetrics().sqrtRuleThickness+o)*s}},sizedDelim:function(e,t,r,n,a){if("<"===e||"\\lt"===e||"⟨"===e?e="\\langle":">"!==e&&"\\gt"!==e&&"⟩"!==e||(e="\\rangle"),be.contains(An,e)||be.contains(Cn,e))return vn(e,t,!1,r,n,a);if(be.contains(Bn,e))return zn(e,qn[t],!1,r,n,a);throw new me("Illegal delimiter: '"+e+"'")},sizeToMaxHeight:qn,customSizedDelim:On,leftRightDelim:function(e,t,r,n,a,i){var s=n.fontMetrics().axisHeight*n.sizeMultiplier,o=5/n.fontMetrics().ptPerEm,l=Math.max(t-s,r+s),h=Math.max(l/500*901,2*l-o);return On(e,h,!0,n,a,i)}},Dn={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},Pn=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function $n(e,t){var r=Kr(e);if(r&&be.contains(Pn,r.text))return r;throw new me(r?"Invalid delimiter '"+r.text+"' after '"+t.funcName+"'":"Invalid delimiter type '"+e.type+"'",e)}function Vn(e){if(!e.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}ur({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{var r=$n(t[0],e);return{type:"delimsizing",mode:e.parser.mode,size:Dn[e.funcName].size,mclass:Dn[e.funcName].mclass,delim:r.text}},htmlBuilder:(e,t)=>"."===e.delim?ar.makeSpan([e.mclass]):Ln.sizedDelim(e.delim,e.size,t,e.mode,[e.mclass]),mathmlBuilder:e=>{var t=[];"."!==e.delim&&t.push(Hr(e.delim,e.mode));var r=new Er.MathNode("mo",t);"mopen"===e.mclass||"mclose"===e.mclass?r.setAttribute("fence","true"):r.setAttribute("fence","false"),r.setAttribute("stretchy","true");var n=Ze(Ln.sizeToMaxHeight[e.size]);return r.setAttribute("minsize",n),r.setAttribute("maxsize",n),r}}),ur({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var r=e.parser.gullet.macros.get("\\current@color");if(r&&"string"!=typeof r)throw new me("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:e.parser.mode,delim:$n(t[0],e).text,color:r}}}),ur({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var r=$n(t[0],e),n=e.parser;++n.leftrightDepth;var a=n.parseExpression(!1);--n.leftrightDepth,n.expect("\\right",!1);var i=Zr(n.parseFunction(),"leftright-right");return{type:"leftright",mode:n.mode,body:a,left:r.text,right:i.delim,rightColor:i.color}},htmlBuilder:(e,t)=>{Vn(e);for(var r,n,a=kr(e.body,t,!0,["mopen","mclose"]),i=0,s=0,o=!1,l=0;l<a.length;l++)a[l].isMiddle?o=!0:(i=Math.max(a[l].height,i),s=Math.max(a[l].depth,s));if(i*=t.sizeMultiplier,s*=t.sizeMultiplier,r="."===e.left?Ar(t,["mopen"]):Ln.leftRightDelim(e.left,i,s,t,e.mode,["mopen"]),a.unshift(r),o)for(var h=1;h<a.length;h++){var c=a[h].isMiddle;c&&(a[h]=Ln.leftRightDelim(c.delim,i,s,c.options,e.mode,[]))}if("."===e.right)n=Ar(t,["mclose"]);else{var p=e.rightColor?t.withColor(e.rightColor):t;n=Ln.leftRightDelim(e.right,i,s,p,e.mode,["mclose"])}return a.push(n),ar.makeSpan(["minner"],a,t)},mathmlBuilder:(e,t)=>{Vn(e);var r=Dr(e.body,t);if("."!==e.left){var n=new Er.MathNode("mo",[Hr(e.left,e.mode)]);n.setAttribute("fence","true"),r.unshift(n)}if("."!==e.right){var a=new Er.MathNode("mo",[Hr(e.right,e.mode)]);a.setAttribute("fence","true"),e.rightColor&&a.setAttribute("mathcolor",e.rightColor),r.push(a)}return Or(r)}}),ur({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var r=$n(t[0],e);if(!e.parser.leftrightDepth)throw new me("\\middle without preceding \\left",r);return{type:"middle",mode:e.parser.mode,delim:r.text}},htmlBuilder:(e,t)=>{var r;if("."===e.delim)r=Ar(t,[]);else{r=Ln.sizedDelim(e.delim,1,t,e.mode,[]);var n={delim:e.delim,options:t};r.isMiddle=n}return r},mathmlBuilder:(e,t)=>{var r="\\vert"===e.delim||"|"===e.delim?Hr("|","text"):Hr(e.delim,e.mode),n=new Er.MathNode("mo",[r]);return n.setAttribute("fence","true"),n.setAttribute("lspace","0.05em"),n.setAttribute("rspace","0.05em"),n}});var Fn=(e,t)=>{var r,n,a,i=ar.wrapFragment(Br(e.body,t),t),s=e.label.slice(1),o=t.sizeMultiplier,l=0,h=be.isCharacterBox(e.body);if("sout"===s)(r=ar.makeSpan(["stretchy","sout"])).height=t.fontMetrics().defaultRuleThickness/o,l=-.5*t.fontMetrics().xHeight;else if("phase"===s){var c=We({number:.6,unit:"pt"},t),p=We({number:.35,unit:"ex"},t);o/=t.havingBaseSizing().sizeMultiplier;var m=i.height+i.depth+c+p;i.style.paddingLeft=Ze(m/2+c);var u=Math.floor(1e3*m*o),d="M400000 "+(n=u)+" H0 L"+n/2+" 0 l65 45 L145 "+(n-80)+" H400000z",g=new it([new st("phase",d)],{width:"400em",height:Ze(u/1e3),viewBox:"0 0 400000 "+u,preserveAspectRatio:"xMinYMin slice"});(r=ar.makeSvgSpan(["hide-tail"],[g],t)).style.height=Ze(m),l=i.depth+c+p}else{/cancel/.test(s)?h||i.classes.push("cancel-pad"):"angl"===s?i.classes.push("anglpad"):i.classes.push("boxpad");var f=0,b=0,v=0;/box/.test(s)?(v=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness),b=f=t.fontMetrics().fboxsep+("colorbox"===s?0:v)):"angl"===s?(f=4*(v=Math.max(t.fontMetrics().defaultRuleThickness,t.minRuleThickness)),b=Math.max(0,.25-i.depth)):b=f=h?.2:0,r=Xr(i,s,f,b,t),/fbox|boxed|fcolorbox/.test(s)?(r.style.borderStyle="solid",r.style.borderWidth=Ze(v)):"angl"===s&&.049!==v&&(r.style.borderTopWidth=Ze(v),r.style.borderRightWidth=Ze(v)),l=i.depth+b,e.backgroundColor&&(r.style.backgroundColor=e.backgroundColor,e.borderColor&&(r.style.borderColor=e.borderColor))}if(e.backgroundColor)a=ar.makeVList({positionType:"individualShift",children:[{type:"elem",elem:r,shift:l},{type:"elem",elem:i,shift:0}]},t);else{var x=/cancel|phase/.test(s)?["svg-align"]:[];a=ar.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:0},{type:"elem",elem:r,shift:l,wrapperClasses:x}]},t)}return/cancel/.test(s)&&(a.height=i.height,a.depth=i.depth),/cancel/.test(s)&&!h?ar.makeSpan(["mord","cancel-lap"],[a],t):ar.makeSpan(["mord"],[a],t)},_n=(e,t)=>{var r=0,n=new Er.MathNode(e.label.indexOf("colorbox")>-1?"mpadded":"menclose",[$r(e.body,t)]);switch(e.label){case"\\cancel":n.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":n.setAttribute("notation","downdiagonalstrike");break;case"\\phase":n.setAttribute("notation","phasorangle");break;case"\\sout":n.setAttribute("notation","horizontalstrike");break;case"\\fbox":n.setAttribute("notation","box");break;case"\\angl":n.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(r=t.fontMetrics().fboxsep*t.fontMetrics().ptPerEm,n.setAttribute("width","+"+2*r+"pt"),n.setAttribute("height","+"+2*r+"pt"),n.setAttribute("lspace",r+"pt"),n.setAttribute("voffset",r+"pt"),"\\fcolorbox"===e.label){var a=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness);n.setAttribute("style","border: "+a+"em solid "+String(e.borderColor))}break;case"\\xcancel":n.setAttribute("notation","updiagonalstrike downdiagonalstrike")}return e.backgroundColor&&n.setAttribute("mathbackground",e.backgroundColor),n};ur({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(e,t,r){var{parser:n,funcName:a}=e,i=Zr(t[0],"color-token").color,s=t[1];return{type:"enclose",mode:n.mode,label:a,backgroundColor:i,body:s}},htmlBuilder:Fn,mathmlBuilder:_n}),ur({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(e,t,r){var{parser:n,funcName:a}=e,i=Zr(t[0],"color-token").color,s=Zr(t[1],"color-token").color,o=t[2];return{type:"enclose",mode:n.mode,label:a,backgroundColor:s,borderColor:i,body:o}},htmlBuilder:Fn,mathmlBuilder:_n}),ur({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(e,t){var{parser:r}=e;return{type:"enclose",mode:r.mode,label:"\\fbox",body:t[0]}}}),ur({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(e,t){var{parser:r,funcName:n}=e,a=t[0];return{type:"enclose",mode:r.mode,label:n,body:a}},htmlBuilder:Fn,mathmlBuilder:_n}),ur({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(e,t){var{parser:r}=e;return{type:"enclose",mode:r.mode,label:"\\angl",body:t[0]}}});var Gn={};function Un(e){for(var{type:t,names:r,props:n,handler:a,htmlBuilder:i,mathmlBuilder:s}=e,o={type:t,numArgs:n.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:a},l=0;l<r.length;++l)Gn[r[l]]=o;i&&(pr[t]=i),s&&(mr[t]=s)}var Xn={};function Yn(e,t){Xn[e]=t}function Wn(e){var t=[];e.consumeSpaces();var r=e.fetch().text;for("\\relax"===r&&(e.consume(),e.consumeSpaces(),r=e.fetch().text);"\\hline"===r||"\\hdashline"===r;)e.consume(),t.push("\\hdashline"===r),e.consumeSpaces(),r=e.fetch().text;return t}var Zn=e=>{if(!e.parser.settings.displayMode)throw new me("{"+e.envName+"} can be used only in display mode.")};function jn(e){if(-1===e.indexOf("ed"))return-1===e.indexOf("*")}function Kn(e,t,r){var{hskipBeforeAndAfter:n,addJot:a,cols:i,arraystretch:s,colSeparationType:o,autoTag:l,singleRow:h,emptySingleRow:c,maxNumCols:p,leqno:m}=t;if(e.gullet.beginGroup(),h||e.gullet.macros.set("\\cr","\\\\\\relax"),!s){var u=e.gullet.expandMacroAsText("\\arraystretch");if(null==u)s=1;else if(!(s=parseFloat(u))||s<0)throw new me("Invalid \\arraystretch: "+u)}e.gullet.beginGroup();var d=[],g=[d],f=[],b=[],v=null!=l?[]:void 0;function x(){l&&e.gullet.macros.set("\\@eqnsw","1",!0)}function y(){v&&(e.gullet.macros.get("\\df@tag")?(v.push(e.subparse([new pe("\\df@tag")])),e.gullet.macros.set("\\df@tag",void 0,!0)):v.push(Boolean(l)&&"1"===e.gullet.macros.get("\\@eqnsw")))}for(x(),b.push(Wn(e));;){var w=e.parseExpression(!1,h?"\\end":"\\\\");e.gullet.endGroup(),e.gullet.beginGroup(),w={type:"ordgroup",mode:e.mode,body:w},r&&(w={type:"styling",mode:e.mode,style:r,body:[w]}),d.push(w);var k=e.fetch().text;if("&"===k){if(p&&d.length===p){if(h||o)throw new me("Too many tab characters: &",e.nextToken);e.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}e.consume()}else{if("\\end"===k){y(),1===d.length&&"styling"===w.type&&0===w.body[0].body.length&&(g.length>1||!c)&&g.pop(),b.length<g.length+1&&b.push([]);break}if("\\\\"!==k)throw new me("Expected & or \\\\ or \\cr or \\end",e.nextToken);e.consume();var S=void 0;" "!==e.gullet.future().text&&(S=e.parseSizeGroup(!0)),f.push(S?S.value:null),y(),b.push(Wn(e)),d=[],g.push(d),x()}}return e.gullet.endGroup(),e.gullet.endGroup(),{type:"array",mode:e.mode,addJot:a,arraystretch:s,body:g,cols:i,rowGaps:f,hskipBeforeAndAfter:n,hLinesBeforeRow:b,colSeparationType:o,tags:v,leqno:m}}function Qn(e){return"d"===e.slice(0,1)?"display":"text"}var Jn=function(e,t){var r,n,a=e.body.length,i=e.hLinesBeforeRow,s=0,o=new Array(a),l=[],h=Math.max(t.fontMetrics().arrayRuleWidth,t.minRuleThickness),c=1/t.fontMetrics().ptPerEm,p=5*c;e.colSeparationType&&"small"===e.colSeparationType&&(p=t.havingStyle(Ce.SCRIPT).sizeMultiplier/t.sizeMultiplier*.2778);var m="CD"===e.colSeparationType?We({number:3,unit:"ex"},t):12*c,u=3*c,d=e.arraystretch*m,g=.7*d,f=.3*d,b=0;function v(e){for(var t=0;t<e.length;++t)t>0&&(b+=.25),l.push({pos:b,isDashed:e[t]})}for(v(i[0]),r=0;r<e.body.length;++r){var x=e.body[r],y=g,w=f;s<x.length&&(s=x.length);var k=new Array(x.length);for(n=0;n<x.length;++n){var S=Br(x[n],t);w<S.depth&&(w=S.depth),y<S.height&&(y=S.height),k[n]=S}var z=e.rowGaps[r],M=0;z&&(M=We(z,t))>0&&(w<(M+=f)&&(w=M),M=0),e.addJot&&(w+=u),k.height=y,k.depth=w,b+=y,k.pos=b,b+=w+M,o[r]=k,v(i[r+1])}var T,A,B=b/2+t.fontMetrics().axisHeight,C=e.cols||[],q=[],N=[];if(e.tags&&e.tags.some((e=>e)))for(r=0;r<a;++r){var R=o[r],I=R.pos-B,E=e.tags[r],H=void 0;(H=!0===E?ar.makeSpan(["eqn-num"],[],t):!1===E?ar.makeSpan([],[],t):ar.makeSpan([],kr(E,t,!0),t)).depth=R.depth,H.height=R.height,N.push({type:"elem",elem:H,shift:I})}for(n=0,A=0;n<s||A<C.length;++n,++A){for(var O=C[A]||{},L=!0;"separator"===O.type;){if(L||((T=ar.makeSpan(["arraycolsep"],[])).style.width=Ze(t.fontMetrics().doubleRuleSep),q.push(T)),"|"!==O.separator&&":"!==O.separator)throw new me("Invalid separator type: "+O.separator);var D="|"===O.separator?"solid":"dashed",P=ar.makeSpan(["vertical-separator"],[],t);P.style.height=Ze(b),P.style.borderRightWidth=Ze(h),P.style.borderRightStyle=D,P.style.margin="0 "+Ze(-h/2);var $=b-B;$&&(P.style.verticalAlign=Ze(-$)),q.push(P),O=C[++A]||{},L=!1}if(!(n>=s)){var V=void 0;(n>0||e.hskipBeforeAndAfter)&&0!==(V=be.deflt(O.pregap,p))&&((T=ar.makeSpan(["arraycolsep"],[])).style.width=Ze(V),q.push(T));var F=[];for(r=0;r<a;++r){var _=o[r],G=_[n];if(G){var U=_.pos-B;G.depth=_.depth,G.height=_.height,F.push({type:"elem",elem:G,shift:U})}}F=ar.makeVList({positionType:"individualShift",children:F},t),F=ar.makeSpan(["col-align-"+(O.align||"c")],[F]),q.push(F),(n<s-1||e.hskipBeforeAndAfter)&&0!==(V=be.deflt(O.postgap,p))&&((T=ar.makeSpan(["arraycolsep"],[])).style.width=Ze(V),q.push(T))}}if(o=ar.makeSpan(["mtable"],q),l.length>0){for(var X=ar.makeLineSpan("hline",t,h),Y=ar.makeLineSpan("hdashline",t,h),W=[{type:"elem",elem:o,shift:0}];l.length>0;){var Z=l.pop(),j=Z.pos-B;Z.isDashed?W.push({type:"elem",elem:Y,shift:j}):W.push({type:"elem",elem:X,shift:j})}o=ar.makeVList({positionType:"individualShift",children:W},t)}if(0===N.length)return ar.makeSpan(["mord"],[o],t);var K=ar.makeVList({positionType:"individualShift",children:N},t);return K=ar.makeSpan(["tag"],[K],t),ar.makeFragment([o,K])},ea={c:"center ",l:"left ",r:"right "},ta=function(e,t){for(var r=[],n=new Er.MathNode("mtd",[],["mtr-glue"]),a=new Er.MathNode("mtd",[],["mml-eqn-num"]),i=0;i<e.body.length;i++){for(var s=e.body[i],o=[],l=0;l<s.length;l++)o.push(new Er.MathNode("mtd",[$r(s[l],t)]));e.tags&&e.tags[i]&&(o.unshift(n),o.push(n),e.leqno?o.unshift(a):o.push(a)),r.push(new Er.MathNode("mtr",o))}var h=new Er.MathNode("mtable",r),c=.5===e.arraystretch?.1:.16+e.arraystretch-1+(e.addJot?.09:0);h.setAttribute("rowspacing",Ze(c));var p="",m="";if(e.cols&&e.cols.length>0){var u=e.cols,d="",g=!1,f=0,b=u.length;"separator"===u[0].type&&(p+="top ",f=1),"separator"===u[u.length-1].type&&(p+="bottom ",b-=1);for(var v=f;v<b;v++)"align"===u[v].type?(m+=ea[u[v].align],g&&(d+="none "),g=!0):"separator"===u[v].type&&g&&(d+="|"===u[v].separator?"solid ":"dashed ",g=!1);h.setAttribute("columnalign",m.trim()),/[sd]/.test(d)&&h.setAttribute("columnlines",d.trim())}if("align"===e.colSeparationType){for(var x=e.cols||[],y="",w=1;w<x.length;w++)y+=w%2?"0em ":"1em ";h.setAttribute("columnspacing",y.trim())}else"alignat"===e.colSeparationType||"gather"===e.colSeparationType?h.setAttribute("columnspacing","0em"):"small"===e.colSeparationType?h.setAttribute("columnspacing","0.2778em"):"CD"===e.colSeparationType?h.setAttribute("columnspacing","0.5em"):h.setAttribute("columnspacing","1em");var k="",S=e.hLinesBeforeRow;p+=S[0].length>0?"left ":"",p+=S[S.length-1].length>0?"right ":"";for(var z=1;z<S.length-1;z++)k+=0===S[z].length?"none ":S[z][0]?"dashed ":"solid ";return/[sd]/.test(k)&&h.setAttribute("rowlines",k.trim()),""!==p&&(h=new Er.MathNode("menclose",[h])).setAttribute("notation",p.trim()),e.arraystretch&&e.arraystretch<1&&(h=new Er.MathNode("mstyle",[h])).setAttribute("scriptlevel","1"),h},ra=function(e,t){-1===e.envName.indexOf("ed")&&Zn(e);var r,n=[],a=e.envName.indexOf("at")>-1?"alignat":"align",i="split"===e.envName,s=Kn(e.parser,{cols:n,addJot:!0,autoTag:i?void 0:jn(e.envName),emptySingleRow:!0,colSeparationType:a,maxNumCols:i?2:void 0,leqno:e.parser.settings.leqno},"display"),o=0,l={type:"ordgroup",mode:e.mode,body:[]};if(t[0]&&"ordgroup"===t[0].type){for(var h="",c=0;c<t[0].body.length;c++){h+=Zr(t[0].body[c],"textord").text}r=Number(h),o=2*r}var p=!o;s.body.forEach((function(e){for(var t=1;t<e.length;t+=2){var n=Zr(e[t],"styling");Zr(n.body[0],"ordgroup").body.unshift(l)}if(p)o<e.length&&(o=e.length);else{var a=e.length/2;if(r<a)throw new me("Too many math in a row: expected "+r+", but got "+a,e[0])}}));for(var m=0;m<o;++m){var u="r",d=0;m%2==1?u="l":m>0&&p&&(d=1),n[m]={type:"align",align:u,pregap:d,postgap:0}}return s.colSeparationType=p?"align":"alignat",s};Un({type:"array",names:["array","darray"],props:{numArgs:1},handler(e,t){var r=(Kr(t[0])?[t[0]]:Zr(t[0],"ordgroup").body).map((function(e){var t=jr(e).text;if(-1!=="lcr".indexOf(t))return{type:"align",align:t};if("|"===t)return{type:"separator",separator:"|"};if(":"===t)return{type:"separator",separator:":"};throw new me("Unknown column alignment: "+t,e)})),n={cols:r,hskipBeforeAndAfter:!0,maxNumCols:r.length};return Kn(e.parser,n,Qn(e.envName))},htmlBuilder:Jn,mathmlBuilder:ta}),Un({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(e){var t={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[e.envName.replace("*","")],r="c",n={hskipBeforeAndAfter:!1,cols:[{type:"align",align:r}]};if("*"===e.envName.charAt(e.envName.length-1)){var a=e.parser;if(a.consumeSpaces(),"["===a.fetch().text){if(a.consume(),a.consumeSpaces(),r=a.fetch().text,-1==="lcr".indexOf(r))throw new me("Expected l or c or r",a.nextToken);a.consume(),a.consumeSpaces(),a.expect("]"),a.consume(),n.cols=[{type:"align",align:r}]}}var i=Kn(e.parser,n,Qn(e.envName)),s=Math.max(0,...i.body.map((e=>e.length)));return i.cols=new Array(s).fill({type:"align",align:r}),t?{type:"leftright",mode:e.mode,body:[i],left:t[0],right:t[1],rightColor:void 0}:i},htmlBuilder:Jn,mathmlBuilder:ta}),Un({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(e){var t=Kn(e.parser,{arraystretch:.5},"script");return t.colSeparationType="small",t},htmlBuilder:Jn,mathmlBuilder:ta}),Un({type:"array",names:["subarray"],props:{numArgs:1},handler(e,t){var r=(Kr(t[0])?[t[0]]:Zr(t[0],"ordgroup").body).map((function(e){var t=jr(e).text;if(-1!=="lc".indexOf(t))return{type:"align",align:t};throw new me("Unknown column alignment: "+t,e)}));if(r.length>1)throw new me("{subarray} can contain only one column");var n={cols:r,hskipBeforeAndAfter:!1,arraystretch:.5};if((n=Kn(e.parser,n,"script")).body.length>0&&n.body[0].length>1)throw new me("{subarray} can contain only one column");return n},htmlBuilder:Jn,mathmlBuilder:ta}),Un({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(e){var t=Kn(e.parser,{arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},Qn(e.envName));return{type:"leftright",mode:e.mode,body:[t],left:e.envName.indexOf("r")>-1?".":"\\{",right:e.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:Jn,mathmlBuilder:ta}),Un({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:ra,htmlBuilder:Jn,mathmlBuilder:ta}),Un({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(e){be.contains(["gather","gather*"],e.envName)&&Zn(e);var t={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:jn(e.envName),emptySingleRow:!0,leqno:e.parser.settings.leqno};return Kn(e.parser,t,"display")},htmlBuilder:Jn,mathmlBuilder:ta}),Un({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:ra,htmlBuilder:Jn,mathmlBuilder:ta}),Un({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(e){Zn(e);var t={autoTag:jn(e.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:e.parser.settings.leqno};return Kn(e.parser,t,"display")},htmlBuilder:Jn,mathmlBuilder:ta}),Un({type:"array",names:["CD"],props:{numArgs:0},handler:e=>(Zn(e),function(e){var t=[];for(e.gullet.beginGroup(),e.gullet.macros.set("\\cr","\\\\\\relax"),e.gullet.beginGroup();;){t.push(e.parseExpression(!1,"\\\\")),e.gullet.endGroup(),e.gullet.beginGroup();var r=e.fetch().text;if("&"!==r&&"\\\\"!==r){if("\\end"===r){0===t[t.length-1].length&&t.pop();break}throw new me("Expected \\\\ or \\cr or \\end",e.nextToken)}e.consume()}for(var n,a,i=[],s=[i],o=0;o<t.length;o++){for(var l=t[o],h={type:"styling",body:[],mode:"math",style:"display"},c=0;c<l.length;c++)if(ln(l[c])){i.push(h);var p=jr(l[c+=1]).text,m=new Array(2);if(m[0]={type:"ordgroup",mode:"math",body:[]},m[1]={type:"ordgroup",mode:"math",body:[]},"=|.".indexOf(p)>-1);else{if(!("<>AV".indexOf(p)>-1))throw new me('Expected one of "<>AV=|." after @',l[c]);for(var u=0;u<2;u++){for(var d=!0,g=c+1;g<l.length;g++){if(a=p,("mathord"===(n=l[g]).type||"atom"===n.type)&&n.text===a){d=!1,c=g;break}if(ln(l[g]))throw new me("Missing a "+p+" character to complete a CD arrow.",l[g]);m[u].body.push(l[g])}if(d)throw new me("Missing a "+p+" character to complete a CD arrow.",l[c])}}var f={type:"styling",body:[hn(p,m,e)],mode:"math",style:"display"};i.push(f),h={type:"styling",body:[],mode:"math",style:"display"}}else h.body.push(l[c]);o%2==0?i.push(h):i.shift(),i=[],s.push(i)}return e.gullet.endGroup(),e.gullet.endGroup(),{type:"array",mode:"math",body:s,arraystretch:1,addJot:!0,rowGaps:[null],cols:new Array(s[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25}),colSeparationType:"CD",hLinesBeforeRow:new Array(s.length+1).fill([])}}(e.parser)),htmlBuilder:Jn,mathmlBuilder:ta}),Yn("\\nonumber","\\gdef\\@eqnsw{0}"),Yn("\\notag","\\nonumber"),ur({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(e,t){throw new me(e.funcName+" valid only within array environment")}});var na=Gn;ur({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(e,t){var{parser:r,funcName:n}=e,a=t[0];if("ordgroup"!==a.type)throw new me("Invalid environment name",a);for(var i="",s=0;s<a.body.length;++s)i+=Zr(a.body[s],"textord").text;if("\\begin"===n){if(!na.hasOwnProperty(i))throw new me("No such environment: "+i,a);var o=na[i],{args:l,optArgs:h}=r.parseArguments("\\begin{"+i+"}",o),c={mode:r.mode,envName:i,parser:r},p=o.handler(c,l,h);r.expect("\\end",!1);var m=r.nextToken,u=Zr(r.parseFunction(),"environment");if(u.name!==i)throw new me("Mismatch: \\begin{"+i+"} matched by \\end{"+u.name+"}",m);return p}return{type:"environment",mode:r.mode,name:i,nameGroup:a}}});var aa=(e,t)=>{var r=e.font,n=t.withFont(r);return Br(e.body,n)},ia=(e,t)=>{var r=e.font,n=t.withFont(r);return $r(e.body,n)},sa={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};ur({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(e,t)=>{var{parser:r,funcName:n}=e,a=gr(t[0]),i=n;return i in sa&&(i=sa[i]),{type:"font",mode:r.mode,font:i.slice(1),body:a}},htmlBuilder:aa,mathmlBuilder:ia}),ur({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(e,t)=>{var{parser:r}=e,n=t[0],a=be.isCharacterBox(n);return{type:"mclass",mode:r.mode,mclass:sn(n),body:[{type:"font",mode:r.mode,font:"boldsymbol",body:n}],isCharacterBox:a}}}),ur({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{var{parser:r,funcName:n,breakOnTokenText:a}=e,{mode:i}=r,s=r.parseExpression(!0,a);return{type:"font",mode:i,font:"math"+n.slice(1),body:{type:"ordgroup",mode:r.mode,body:s}}},htmlBuilder:aa,mathmlBuilder:ia});var oa=(e,t)=>{var r=t;return"display"===e?r=r.id>=Ce.SCRIPT.id?r.text():Ce.DISPLAY:"text"===e&&r.size===Ce.DISPLAY.size?r=Ce.TEXT:"script"===e?r=Ce.SCRIPT:"scriptscript"===e&&(r=Ce.SCRIPTSCRIPT),r},la=(e,t)=>{var r,n=oa(e.size,t.style),a=n.fracNum(),i=n.fracDen();r=t.havingStyle(a);var s=Br(e.numer,r,t);if(e.continued){var o=8.5/t.fontMetrics().ptPerEm,l=3.5/t.fontMetrics().ptPerEm;s.height=s.height<o?o:s.height,s.depth=s.depth<l?l:s.depth}r=t.havingStyle(i);var h,c,p,m,u,d,g,f,b,v,x=Br(e.denom,r,t);if(e.hasBarLine?(e.barSize?(c=We(e.barSize,t),h=ar.makeLineSpan("frac-line",t,c)):h=ar.makeLineSpan("frac-line",t),c=h.height,p=h.height):(h=null,c=0,p=t.fontMetrics().defaultRuleThickness),n.size===Ce.DISPLAY.size||"display"===e.size?(m=t.fontMetrics().num1,u=c>0?3*p:7*p,d=t.fontMetrics().denom1):(c>0?(m=t.fontMetrics().num2,u=p):(m=t.fontMetrics().num3,u=3*p),d=t.fontMetrics().denom2),h){var y=t.fontMetrics().axisHeight;m-s.depth-(y+.5*c)<u&&(m+=u-(m-s.depth-(y+.5*c))),y-.5*c-(x.height-d)<u&&(d+=u-(y-.5*c-(x.height-d)));var w=-(y-.5*c);g=ar.makeVList({positionType:"individualShift",children:[{type:"elem",elem:x,shift:d},{type:"elem",elem:h,shift:w},{type:"elem",elem:s,shift:-m}]},t)}else{var k=m-s.depth-(x.height-d);k<u&&(m+=.5*(u-k),d+=.5*(u-k)),g=ar.makeVList({positionType:"individualShift",children:[{type:"elem",elem:x,shift:d},{type:"elem",elem:s,shift:-m}]},t)}return r=t.havingStyle(n),g.height*=r.sizeMultiplier/t.sizeMultiplier,g.depth*=r.sizeMultiplier/t.sizeMultiplier,f=n.size===Ce.DISPLAY.size?t.fontMetrics().delim1:n.size===Ce.SCRIPTSCRIPT.size?t.havingStyle(Ce.SCRIPT).fontMetrics().delim2:t.fontMetrics().delim2,b=null==e.leftDelim?Ar(t,["mopen"]):Ln.customSizedDelim(e.leftDelim,f,!0,t.havingStyle(n),e.mode,["mopen"]),v=e.continued?ar.makeSpan([]):null==e.rightDelim?Ar(t,["mclose"]):Ln.customSizedDelim(e.rightDelim,f,!0,t.havingStyle(n),e.mode,["mclose"]),ar.makeSpan(["mord"].concat(r.sizingClasses(t)),[b,ar.makeSpan(["mfrac"],[g]),v],t)},ha=(e,t)=>{var r=new Er.MathNode("mfrac",[$r(e.numer,t),$r(e.denom,t)]);if(e.hasBarLine){if(e.barSize){var n=We(e.barSize,t);r.setAttribute("linethickness",Ze(n))}}else r.setAttribute("linethickness","0px");var a=oa(e.size,t.style);if(a.size!==t.style.size){r=new Er.MathNode("mstyle",[r]);var i=a.size===Ce.DISPLAY.size?"true":"false";r.setAttribute("displaystyle",i),r.setAttribute("scriptlevel","0")}if(null!=e.leftDelim||null!=e.rightDelim){var s=[];if(null!=e.leftDelim){var o=new Er.MathNode("mo",[new Er.TextNode(e.leftDelim.replace("\\",""))]);o.setAttribute("fence","true"),s.push(o)}if(s.push(r),null!=e.rightDelim){var l=new Er.MathNode("mo",[new Er.TextNode(e.rightDelim.replace("\\",""))]);l.setAttribute("fence","true"),s.push(l)}return Or(s)}return r};ur({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(e,t)=>{var r,{parser:n,funcName:a}=e,i=t[0],s=t[1],o=null,l=null,h="auto";switch(a){case"\\dfrac":case"\\frac":case"\\tfrac":r=!0;break;case"\\\\atopfrac":r=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":r=!1,o="(",l=")";break;case"\\\\bracefrac":r=!1,o="\\{",l="\\}";break;case"\\\\brackfrac":r=!1,o="[",l="]";break;default:throw new Error("Unrecognized genfrac command")}switch(a){case"\\dfrac":case"\\dbinom":h="display";break;case"\\tfrac":case"\\tbinom":h="text"}return{type:"genfrac",mode:n.mode,continued:!1,numer:i,denom:s,hasBarLine:r,leftDelim:o,rightDelim:l,size:h,barSize:null}},htmlBuilder:la,mathmlBuilder:ha}),ur({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(e,t)=>{var{parser:r,funcName:n}=e,a=t[0],i=t[1];return{type:"genfrac",mode:r.mode,continued:!0,numer:a,denom:i,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}}),ur({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(e){var t,{parser:r,funcName:n,token:a}=e;switch(n){case"\\over":t="\\frac";break;case"\\choose":t="\\binom";break;case"\\atop":t="\\\\atopfrac";break;case"\\brace":t="\\\\bracefrac";break;case"\\brack":t="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:r.mode,replaceWith:t,token:a}}});var ca=["display","text","script","scriptscript"],pa=function(e){var t=null;return e.length>0&&(t="."===(t=e)?null:t),t};ur({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(e,t){var r,{parser:n}=e,a=t[4],i=t[5],s=gr(t[0]),o="atom"===s.type&&"open"===s.family?pa(s.text):null,l=gr(t[1]),h="atom"===l.type&&"close"===l.family?pa(l.text):null,c=Zr(t[2],"size"),p=null;r=!!c.isBlank||(p=c.value).number>0;var m="auto",u=t[3];if("ordgroup"===u.type){if(u.body.length>0){var d=Zr(u.body[0],"textord");m=ca[Number(d.text)]}}else u=Zr(u,"textord"),m=ca[Number(u.text)];return{type:"genfrac",mode:n.mode,numer:a,denom:i,continued:!1,hasBarLine:r,barSize:p,leftDelim:o,rightDelim:h,size:m}},htmlBuilder:la,mathmlBuilder:ha}),ur({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(e,t){var{parser:r,funcName:n,token:a}=e;return{type:"infix",mode:r.mode,replaceWith:"\\\\abovefrac",size:Zr(t[0],"size").value,token:a}}}),ur({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(e,t)=>{var{parser:r,funcName:n}=e,a=t[0],i=function(e){if(!e)throw new Error("Expected non-null, but got "+String(e));return e}(Zr(t[1],"infix").size),s=t[2],o=i.number>0;return{type:"genfrac",mode:r.mode,numer:a,denom:s,continued:!1,hasBarLine:o,barSize:i,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:la,mathmlBuilder:ha});var ma=(e,t)=>{var r,n,a=t.style;"supsub"===e.type?(r=e.sup?Br(e.sup,t.havingStyle(a.sup()),t):Br(e.sub,t.havingStyle(a.sub()),t),n=Zr(e.base,"horizBrace")):n=Zr(e,"horizBrace");var i,s=Br(n.base,t.havingBaseStyle(Ce.DISPLAY)),o=Wr(n,t);if(n.isOver?(i=ar.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:s},{type:"kern",size:.1},{type:"elem",elem:o}]},t)).children[0].children[0].children[1].classes.push("svg-align"):(i=ar.makeVList({positionType:"bottom",positionData:s.depth+.1+o.height,children:[{type:"elem",elem:o},{type:"kern",size:.1},{type:"elem",elem:s}]},t)).children[0].children[0].children[0].classes.push("svg-align"),r){var l=ar.makeSpan(["mord",n.isOver?"mover":"munder"],[i],t);i=n.isOver?ar.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:l},{type:"kern",size:.2},{type:"elem",elem:r}]},t):ar.makeVList({positionType:"bottom",positionData:l.depth+.2+r.height+r.depth,children:[{type:"elem",elem:r},{type:"kern",size:.2},{type:"elem",elem:l}]},t)}return ar.makeSpan(["mord",n.isOver?"mover":"munder"],[i],t)};ur({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(e,t){var{parser:r,funcName:n}=e;return{type:"horizBrace",mode:r.mode,label:n,isOver:/^\\over/.test(n),base:t[0]}},htmlBuilder:ma,mathmlBuilder:(e,t)=>{var r=Yr(e.label);return new Er.MathNode(e.isOver?"mover":"munder",[$r(e.base,t),r])}}),ur({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=t[1],a=Zr(t[0],"url").url;return r.settings.isTrusted({command:"\\href",url:a})?{type:"href",mode:r.mode,href:a,body:fr(n)}:r.formatUnsupportedCmd("\\href")},htmlBuilder:(e,t)=>{var r=kr(e.body,t,!1);return ar.makeAnchor(e.href,[],r,t)},mathmlBuilder:(e,t)=>{var r=Pr(e.body,t);return r instanceof Rr||(r=new Rr("mrow",[r])),r.setAttribute("href",e.href),r}}),ur({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=Zr(t[0],"url").url;if(!r.settings.isTrusted({command:"\\url",url:n}))return r.formatUnsupportedCmd("\\url");for(var a=[],i=0;i<n.length;i++){var s=n[i];"~"===s&&(s="\\textasciitilde"),a.push({type:"textord",mode:"text",text:s})}var o={type:"text",mode:r.mode,font:"\\texttt",body:a};return{type:"href",mode:r.mode,href:n,body:fr(o)}}}),ur({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(e,t){var{parser:r}=e;return{type:"hbox",mode:r.mode,body:fr(t[0])}},htmlBuilder(e,t){var r=kr(e.body,t,!1);return ar.makeFragment(r)},mathmlBuilder:(e,t)=>new Er.MathNode("mrow",Dr(e.body,t))}),ur({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(e,t)=>{var r,{parser:n,funcName:a,token:i}=e,s=Zr(t[0],"raw").string,o=t[1];n.settings.strict&&n.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var l={};switch(a){case"\\htmlClass":l.class=s,r={command:"\\htmlClass",class:s};break;case"\\htmlId":l.id=s,r={command:"\\htmlId",id:s};break;case"\\htmlStyle":l.style=s,r={command:"\\htmlStyle",style:s};break;case"\\htmlData":for(var h=s.split(","),c=0;c<h.length;c++){var p=h[c].split("=");if(2!==p.length)throw new me("Error parsing key-value for \\htmlData");l["data-"+p[0].trim()]=p[1].trim()}r={command:"\\htmlData",attributes:l};break;default:throw new Error("Unrecognized html command")}return n.settings.isTrusted(r)?{type:"html",mode:n.mode,attributes:l,body:fr(o)}:n.formatUnsupportedCmd(a)},htmlBuilder:(e,t)=>{var r=kr(e.body,t,!1),n=["enclosing"];e.attributes.class&&n.push(...e.attributes.class.trim().split(/\s+/));var a=ar.makeSpan(n,r,t);for(var i in e.attributes)"class"!==i&&e.attributes.hasOwnProperty(i)&&a.setAttribute(i,e.attributes[i]);return a},mathmlBuilder:(e,t)=>Pr(e.body,t)}),ur({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(e,t)=>{var{parser:r}=e;return{type:"htmlmathml",mode:r.mode,html:fr(t[0]),mathml:fr(t[1])}},htmlBuilder:(e,t)=>{var r=kr(e.html,t,!1);return ar.makeFragment(r)},mathmlBuilder:(e,t)=>Pr(e.mathml,t)});var ua=function(e){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(e))return{number:+e,unit:"bp"};var t=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(e);if(!t)throw new me("Invalid size: '"+e+"' in \\includegraphics");var r={number:+(t[1]+t[2]),unit:t[3]};if(!Ye(r))throw new me("Invalid unit: '"+r.unit+"' in \\includegraphics.");return r};ur({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(e,t,r)=>{var{parser:n}=e,a={number:0,unit:"em"},i={number:.9,unit:"em"},s={number:0,unit:"em"},o="";if(r[0])for(var l=Zr(r[0],"raw").string.split(","),h=0;h<l.length;h++){var c=l[h].split("=");if(2===c.length){var p=c[1].trim();switch(c[0].trim()){case"alt":o=p;break;case"width":a=ua(p);break;case"height":i=ua(p);break;case"totalheight":s=ua(p);break;default:throw new me("Invalid key: '"+c[0]+"' in \\includegraphics.")}}}var m=Zr(t[0],"url").url;return""===o&&(o=(o=(o=m).replace(/^.*[\\/]/,"")).substring(0,o.lastIndexOf("."))),n.settings.isTrusted({command:"\\includegraphics",url:m})?{type:"includegraphics",mode:n.mode,alt:o,width:a,height:i,totalheight:s,src:m}:n.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(e,t)=>{var r=We(e.height,t),n=0;e.totalheight.number>0&&(n=We(e.totalheight,t)-r);var a=0;e.width.number>0&&(a=We(e.width,t));var i={height:Ze(r+n)};a>0&&(i.width=Ze(a)),n>0&&(i.verticalAlign=Ze(-n));var s=new rt(e.src,e.alt,i);return s.height=r,s.depth=n,s},mathmlBuilder:(e,t)=>{var r=new Er.MathNode("mglyph",[]);r.setAttribute("alt",e.alt);var n=We(e.height,t),a=0;if(e.totalheight.number>0&&(a=We(e.totalheight,t)-n,r.setAttribute("valign",Ze(-a))),r.setAttribute("height",Ze(n+a)),e.width.number>0){var i=We(e.width,t);r.setAttribute("width",Ze(i))}return r.setAttribute("src",e.src),r}}),ur({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(e,t){var{parser:r,funcName:n}=e,a=Zr(t[0],"size");if(r.settings.strict){var i="m"===n[1],s="mu"===a.value.unit;i?(s||r.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" supports only mu units, not "+a.value.unit+" units"),"math"!==r.mode&&r.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" works only in math mode")):s&&r.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" doesn't support mu units")}return{type:"kern",mode:r.mode,dimension:a.value}},htmlBuilder:(e,t)=>ar.makeGlue(e.dimension,t),mathmlBuilder(e,t){var r=We(e.dimension,t);return new Er.SpaceNode(r)}}),ur({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:r,funcName:n}=e,a=t[0];return{type:"lap",mode:r.mode,alignment:n.slice(5),body:a}},htmlBuilder:(e,t)=>{var r;"clap"===e.alignment?(r=ar.makeSpan([],[Br(e.body,t)]),r=ar.makeSpan(["inner"],[r],t)):r=ar.makeSpan(["inner"],[Br(e.body,t)]);var n=ar.makeSpan(["fix"],[]),a=ar.makeSpan([e.alignment],[r,n],t),i=ar.makeSpan(["strut"]);return i.style.height=Ze(a.height+a.depth),a.depth&&(i.style.verticalAlign=Ze(-a.depth)),a.children.unshift(i),a=ar.makeSpan(["thinbox"],[a],t),ar.makeSpan(["mord","vbox"],[a],t)},mathmlBuilder:(e,t)=>{var r=new Er.MathNode("mpadded",[$r(e.body,t)]);if("rlap"!==e.alignment){var n="llap"===e.alignment?"-1":"-0.5";r.setAttribute("lspace",n+"width")}return r.setAttribute("width","0px"),r}}),ur({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){var{funcName:r,parser:n}=e,a=n.mode;n.switchMode("math");var i="\\("===r?"\\)":"$",s=n.parseExpression(!1,i);return n.expect(i),n.switchMode(a),{type:"styling",mode:n.mode,style:"text",body:s}}}),ur({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){throw new me("Mismatched "+e.funcName)}});var da=(e,t)=>{switch(t.style.size){case Ce.DISPLAY.size:return e.display;case Ce.TEXT.size:return e.text;case Ce.SCRIPT.size:return e.script;case Ce.SCRIPTSCRIPT.size:return e.scriptscript;default:return e.text}};ur({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(e,t)=>{var{parser:r}=e;return{type:"mathchoice",mode:r.mode,display:fr(t[0]),text:fr(t[1]),script:fr(t[2]),scriptscript:fr(t[3])}},htmlBuilder:(e,t)=>{var r=da(e,t),n=kr(r,t,!1);return ar.makeFragment(n)},mathmlBuilder:(e,t)=>{var r=da(e,t);return Pr(r,t)}});var ga=(e,t,r,n,a,i,s)=>{e=ar.makeSpan([],[e]);var o,l,h,c=r&&be.isCharacterBox(r);if(t){var p=Br(t,n.havingStyle(a.sup()),n);l={elem:p,kern:Math.max(n.fontMetrics().bigOpSpacing1,n.fontMetrics().bigOpSpacing3-p.depth)}}if(r){var m=Br(r,n.havingStyle(a.sub()),n);o={elem:m,kern:Math.max(n.fontMetrics().bigOpSpacing2,n.fontMetrics().bigOpSpacing4-m.height)}}if(l&&o){var u=n.fontMetrics().bigOpSpacing5+o.elem.height+o.elem.depth+o.kern+e.depth+s;h=ar.makeVList({positionType:"bottom",positionData:u,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:o.elem,marginLeft:Ze(-i)},{type:"kern",size:o.kern},{type:"elem",elem:e},{type:"kern",size:l.kern},{type:"elem",elem:l.elem,marginLeft:Ze(i)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}else if(o){var d=e.height-s;h=ar.makeVList({positionType:"top",positionData:d,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:o.elem,marginLeft:Ze(-i)},{type:"kern",size:o.kern},{type:"elem",elem:e}]},n)}else{if(!l)return e;var g=e.depth+s;h=ar.makeVList({positionType:"bottom",positionData:g,children:[{type:"elem",elem:e},{type:"kern",size:l.kern},{type:"elem",elem:l.elem,marginLeft:Ze(i)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}var f=[h];if(o&&0!==i&&!c){var b=ar.makeSpan(["mspace"],[],n);b.style.marginRight=Ze(i),f.unshift(b)}return ar.makeSpan(["mop","op-limits"],f,n)},fa=["\\smallint"],ba=(e,t)=>{var r,n,a,i=!1;"supsub"===e.type?(r=e.sup,n=e.sub,a=Zr(e.base,"op"),i=!0):a=Zr(e,"op");var s,o=t.style,l=!1;if(o.size===Ce.DISPLAY.size&&a.symbol&&!be.contains(fa,a.name)&&(l=!0),a.symbol){var h=l?"Size2-Regular":"Size1-Regular",c="";if("\\oiint"!==a.name&&"\\oiiint"!==a.name||(c=a.name.slice(1),a.name="oiint"===c?"\\iint":"\\iiint"),s=ar.makeSymbol(a.name,h,"math",t,["mop","op-symbol",l?"large-op":"small-op"]),c.length>0){var p=s.italic,m=ar.staticSvg(c+"Size"+(l?"2":"1"),t);s=ar.makeVList({positionType:"individualShift",children:[{type:"elem",elem:s,shift:0},{type:"elem",elem:m,shift:l?.08:0}]},t),a.name="\\"+c,s.classes.unshift("mop"),s.italic=p}}else if(a.body){var u=kr(a.body,t,!0);1===u.length&&u[0]instanceof at?(s=u[0]).classes[0]="mop":s=ar.makeSpan(["mop"],u,t)}else{for(var d=[],g=1;g<a.name.length;g++)d.push(ar.mathsym(a.name[g],a.mode,t));s=ar.makeSpan(["mop"],d,t)}var f=0,b=0;return(s instanceof at||"\\oiint"===a.name||"\\oiiint"===a.name)&&!a.suppressBaseShift&&(f=(s.height-s.depth)/2-t.fontMetrics().axisHeight,b=s.italic),i?ga(s,r,n,t,o,b,f):(f&&(s.style.position="relative",s.style.top=Ze(f)),s)},va=(e,t)=>{var r;if(e.symbol)r=new Rr("mo",[Hr(e.name,e.mode)]),be.contains(fa,e.name)&&r.setAttribute("largeop","false");else if(e.body)r=new Rr("mo",Dr(e.body,t));else{r=new Rr("mi",[new Ir(e.name.slice(1))]);var n=new Rr("mo",[Hr("⁡","text")]);r=e.parentIsSupSub?new Rr("mrow",[r,n]):Nr([r,n])}return r},xa={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨆":"\\bigsqcup"};ur({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:(e,t)=>{var{parser:r,funcName:n}=e,a=n;return 1===a.length&&(a=xa[a]),{type:"op",mode:r.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:a}},htmlBuilder:ba,mathmlBuilder:va}),ur({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var{parser:r}=e,n=t[0];return{type:"op",mode:r.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:fr(n)}},htmlBuilder:ba,mathmlBuilder:va});var ya={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint"};ur({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(e){var{parser:t,funcName:r}=e;return{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:r}},htmlBuilder:ba,mathmlBuilder:va}),ur({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(e){var{parser:t,funcName:r}=e;return{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:r}},htmlBuilder:ba,mathmlBuilder:va}),ur({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","∫","∬","∭","∮","∯","∰"],props:{numArgs:0},handler(e){var{parser:t,funcName:r}=e,n=r;return 1===n.length&&(n=ya[n]),{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:n}},htmlBuilder:ba,mathmlBuilder:va});var wa=(e,t)=>{var r,n,a,i,s=!1;if("supsub"===e.type?(r=e.sup,n=e.sub,a=Zr(e.base,"operatorname"),s=!0):a=Zr(e,"operatorname"),a.body.length>0){for(var o=a.body.map((e=>{var t=e.text;return"string"==typeof t?{type:"textord",mode:e.mode,text:t}:e})),l=kr(o,t.withFont("mathrm"),!0),h=0;h<l.length;h++){var c=l[h];c instanceof at&&(c.text=c.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}i=ar.makeSpan(["mop"],l,t)}else i=ar.makeSpan(["mop"],[],t);return s?ga(i,r,n,t,t.style,0,0):i};function ka(e,t,r){for(var n=kr(e,t,!1),a=t.sizeMultiplier/r.sizeMultiplier,i=0;i<n.length;i++){var s=n[i].classes.indexOf("sizing");s<0?Array.prototype.push.apply(n[i].classes,t.sizingClasses(r)):n[i].classes[s+1]==="reset-size"+t.size&&(n[i].classes[s+1]="reset-size"+r.size),n[i].height*=a,n[i].depth*=a}return ar.makeFragment(n)}ur({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(e,t)=>{var{parser:r,funcName:n}=e,a=t[0];return{type:"operatorname",mode:r.mode,body:fr(a),alwaysHandleSupSub:"\\operatornamewithlimits"===n,limits:!1,parentIsSupSub:!1}},htmlBuilder:wa,mathmlBuilder:(e,t)=>{for(var r=Dr(e.body,t.withFont("mathrm")),n=!0,a=0;a<r.length;a++){var i=r[a];if(i instanceof Er.SpaceNode);else if(i instanceof Er.MathNode)switch(i.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":var s=i.children[0];1===i.children.length&&s instanceof Er.TextNode?s.text=s.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):n=!1;break;default:n=!1}else n=!1}if(n){var o=r.map((e=>e.toText())).join("");r=[new Er.TextNode(o)]}var l=new Er.MathNode("mi",r);l.setAttribute("mathvariant","normal");var h=new Er.MathNode("mo",[Hr("⁡","text")]);return e.parentIsSupSub?new Er.MathNode("mrow",[l,h]):Er.newDocumentFragment([l,h])}}),Yn("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@"),dr({type:"ordgroup",htmlBuilder:(e,t)=>e.semisimple?ar.makeFragment(kr(e.body,t,!1)):ar.makeSpan(["mord"],kr(e.body,t,!0),t),mathmlBuilder:(e,t)=>Pr(e.body,t,!0)}),ur({type:"overline",names:["\\overline"],props:{numArgs:1},handler(e,t){var{parser:r}=e,n=t[0];return{type:"overline",mode:r.mode,body:n}},htmlBuilder(e,t){var r=Br(e.body,t.havingCrampedStyle()),n=ar.makeLineSpan("overline-line",t),a=t.fontMetrics().defaultRuleThickness,i=ar.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r},{type:"kern",size:3*a},{type:"elem",elem:n},{type:"kern",size:a}]},t);return ar.makeSpan(["mord","overline"],[i],t)},mathmlBuilder(e,t){var r=new Er.MathNode("mo",[new Er.TextNode("‾")]);r.setAttribute("stretchy","true");var n=new Er.MathNode("mover",[$r(e.body,t),r]);return n.setAttribute("accent","true"),n}}),ur({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=t[0];return{type:"phantom",mode:r.mode,body:fr(n)}},htmlBuilder:(e,t)=>{var r=kr(e.body,t.withPhantom(),!1);return ar.makeFragment(r)},mathmlBuilder:(e,t)=>{var r=Dr(e.body,t);return new Er.MathNode("mphantom",r)}}),ur({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=t[0];return{type:"hphantom",mode:r.mode,body:n}},htmlBuilder:(e,t)=>{var r=ar.makeSpan([],[Br(e.body,t.withPhantom())]);if(r.height=0,r.depth=0,r.children)for(var n=0;n<r.children.length;n++)r.children[n].height=0,r.children[n].depth=0;return r=ar.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r}]},t),ar.makeSpan(["mord"],[r],t)},mathmlBuilder:(e,t)=>{var r=Dr(fr(e.body),t),n=new Er.MathNode("mphantom",r),a=new Er.MathNode("mpadded",[n]);return a.setAttribute("height","0px"),a.setAttribute("depth","0px"),a}}),ur({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=t[0];return{type:"vphantom",mode:r.mode,body:n}},htmlBuilder:(e,t)=>{var r=ar.makeSpan(["inner"],[Br(e.body,t.withPhantom())]),n=ar.makeSpan(["fix"],[]);return ar.makeSpan(["mord","rlap"],[r,n],t)},mathmlBuilder:(e,t)=>{var r=Dr(fr(e.body),t),n=new Er.MathNode("mphantom",r),a=new Er.MathNode("mpadded",[n]);return a.setAttribute("width","0px"),a}}),ur({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(e,t){var{parser:r}=e,n=Zr(t[0],"size").value,a=t[1];return{type:"raisebox",mode:r.mode,dy:n,body:a}},htmlBuilder(e,t){var r=Br(e.body,t),n=We(e.dy,t);return ar.makeVList({positionType:"shift",positionData:-n,children:[{type:"elem",elem:r}]},t)},mathmlBuilder(e,t){var r=new Er.MathNode("mpadded",[$r(e.body,t)]),n=e.dy.number+e.dy.unit;return r.setAttribute("voffset",n),r}}),ur({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0},handler(e){var{parser:t}=e;return{type:"internal",mode:t.mode}}}),ur({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,argTypes:["size","size","size"]},handler(e,t,r){var{parser:n}=e,a=r[0],i=Zr(t[0],"size"),s=Zr(t[1],"size");return{type:"rule",mode:n.mode,shift:a&&Zr(a,"size").value,width:i.value,height:s.value}},htmlBuilder(e,t){var r=ar.makeSpan(["mord","rule"],[],t),n=We(e.width,t),a=We(e.height,t),i=e.shift?We(e.shift,t):0;return r.style.borderRightWidth=Ze(n),r.style.borderTopWidth=Ze(a),r.style.bottom=Ze(i),r.width=n,r.height=a+i,r.depth=-i,r.maxFontSize=1.125*a*t.sizeMultiplier,r},mathmlBuilder(e,t){var r=We(e.width,t),n=We(e.height,t),a=e.shift?We(e.shift,t):0,i=t.color&&t.getColor()||"black",s=new Er.MathNode("mspace");s.setAttribute("mathbackground",i),s.setAttribute("width",Ze(r)),s.setAttribute("height",Ze(n));var o=new Er.MathNode("mpadded",[s]);return a>=0?o.setAttribute("height",Ze(a)):(o.setAttribute("height",Ze(a)),o.setAttribute("depth",Ze(-a))),o.setAttribute("voffset",Ze(a)),o}});var Sa=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"];ur({type:"sizing",names:Sa,props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{var{breakOnTokenText:r,funcName:n,parser:a}=e,i=a.parseExpression(!1,r);return{type:"sizing",mode:a.mode,size:Sa.indexOf(n)+1,body:i}},htmlBuilder:(e,t)=>{var r=t.havingSize(e.size);return ka(e.body,r,t)},mathmlBuilder:(e,t)=>{var r=t.havingSize(e.size),n=Dr(e.body,r),a=new Er.MathNode("mstyle",n);return a.setAttribute("mathsize",Ze(r.sizeMultiplier)),a}}),ur({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(e,t,r)=>{var{parser:n}=e,a=!1,i=!1,s=r[0]&&Zr(r[0],"ordgroup");if(s)for(var o="",l=0;l<s.body.length;++l){if("t"===(o=s.body[l].text))a=!0;else{if("b"!==o){a=!1,i=!1;break}i=!0}}else a=!0,i=!0;var h=t[0];return{type:"smash",mode:n.mode,body:h,smashHeight:a,smashDepth:i}},htmlBuilder:(e,t)=>{var r=ar.makeSpan([],[Br(e.body,t)]);if(!e.smashHeight&&!e.smashDepth)return r;if(e.smashHeight&&(r.height=0,r.children))for(var n=0;n<r.children.length;n++)r.children[n].height=0;if(e.smashDepth&&(r.depth=0,r.children))for(var a=0;a<r.children.length;a++)r.children[a].depth=0;var i=ar.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r}]},t);return ar.makeSpan(["mord"],[i],t)},mathmlBuilder:(e,t)=>{var r=new Er.MathNode("mpadded",[$r(e.body,t)]);return e.smashHeight&&r.setAttribute("height","0px"),e.smashDepth&&r.setAttribute("depth","0px"),r}}),ur({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,r){var{parser:n}=e,a=r[0],i=t[0];return{type:"sqrt",mode:n.mode,body:i,index:a}},htmlBuilder(e,t){var r=Br(e.body,t.havingCrampedStyle());0===r.height&&(r.height=t.fontMetrics().xHeight),r=ar.wrapFragment(r,t);var n=t.fontMetrics().defaultRuleThickness,a=n;t.style.id<Ce.TEXT.id&&(a=t.fontMetrics().xHeight);var i=n+a/4,s=r.height+r.depth+i+n,{span:o,ruleWidth:l,advanceWidth:h}=Ln.sqrtImage(s,t),c=o.height-l;c>r.height+r.depth+i&&(i=(i+c-r.height-r.depth)/2);var p=o.height-r.height-i-l;r.style.paddingLeft=Ze(h);var m=ar.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r,wrapperClasses:["svg-align"]},{type:"kern",size:-(r.height+p)},{type:"elem",elem:o},{type:"kern",size:l}]},t);if(e.index){var u=t.havingStyle(Ce.SCRIPTSCRIPT),d=Br(e.index,u,t),g=.6*(m.height-m.depth),f=ar.makeVList({positionType:"shift",positionData:-g,children:[{type:"elem",elem:d}]},t),b=ar.makeSpan(["root"],[f]);return ar.makeSpan(["mord","sqrt"],[b,m],t)}return ar.makeSpan(["mord","sqrt"],[m],t)},mathmlBuilder(e,t){var{body:r,index:n}=e;return n?new Er.MathNode("mroot",[$r(r,t),$r(n,t)]):new Er.MathNode("msqrt",[$r(r,t)])}});var za={display:Ce.DISPLAY,text:Ce.TEXT,script:Ce.SCRIPT,scriptscript:Ce.SCRIPTSCRIPT};ur({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e,t){var{breakOnTokenText:r,funcName:n,parser:a}=e,i=a.parseExpression(!0,r),s=n.slice(1,n.length-5);return{type:"styling",mode:a.mode,style:s,body:i}},htmlBuilder(e,t){var r=za[e.style],n=t.havingStyle(r).withFont("");return ka(e.body,n,t)},mathmlBuilder(e,t){var r=za[e.style],n=t.havingStyle(r),a=Dr(e.body,n),i=new Er.MathNode("mstyle",a),s={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]}[e.style];return i.setAttribute("scriptlevel",s[0]),i.setAttribute("displaystyle",s[1]),i}});dr({type:"supsub",htmlBuilder(e,t){var r=function(e,t){var r=e.base;return r?"op"===r.type?r.limits&&(t.style.size===Ce.DISPLAY.size||r.alwaysHandleSupSub)?ba:null:"operatorname"===r.type?r.alwaysHandleSupSub&&(t.style.size===Ce.DISPLAY.size||r.limits)?wa:null:"accent"===r.type?be.isCharacterBox(r.base)?Qr:null:"horizBrace"===r.type&&!e.sub===r.isOver?ma:null:null}(e,t);if(r)return r(e,t);var n,a,i,{base:s,sup:o,sub:l}=e,h=Br(s,t),c=t.fontMetrics(),p=0,m=0,u=s&&be.isCharacterBox(s);if(o){var d=t.havingStyle(t.style.sup());n=Br(o,d,t),u||(p=h.height-d.fontMetrics().supDrop*d.sizeMultiplier/t.sizeMultiplier)}if(l){var g=t.havingStyle(t.style.sub());a=Br(l,g,t),u||(m=h.depth+g.fontMetrics().subDrop*g.sizeMultiplier/t.sizeMultiplier)}i=t.style===Ce.DISPLAY?c.sup1:t.style.cramped?c.sup3:c.sup2;var f,b=t.sizeMultiplier,v=Ze(.5/c.ptPerEm/b),x=null;if(a){var y=e.base&&"op"===e.base.type&&e.base.name&&("\\oiint"===e.base.name||"\\oiiint"===e.base.name);(h instanceof at||y)&&(x=Ze(-h.italic))}if(n&&a){p=Math.max(p,i,n.depth+.25*c.xHeight),m=Math.max(m,c.sub2);var w=4*c.defaultRuleThickness;if(p-n.depth-(a.height-m)<w){m=w-(p-n.depth)+a.height;var k=.8*c.xHeight-(p-n.depth);k>0&&(p+=k,m-=k)}var S=[{type:"elem",elem:a,shift:m,marginRight:v,marginLeft:x},{type:"elem",elem:n,shift:-p,marginRight:v}];f=ar.makeVList({positionType:"individualShift",children:S},t)}else if(a){m=Math.max(m,c.sub1,a.height-.8*c.xHeight);var z=[{type:"elem",elem:a,marginLeft:x,marginRight:v}];f=ar.makeVList({positionType:"shift",positionData:m,children:z},t)}else{if(!n)throw new Error("supsub must have either sup or sub.");p=Math.max(p,i,n.depth+.25*c.xHeight),f=ar.makeVList({positionType:"shift",positionData:-p,children:[{type:"elem",elem:n,marginRight:v}]},t)}var M=Tr(h,"right")||"mord";return ar.makeSpan([M],[h,ar.makeSpan(["msupsub"],[f])],t)},mathmlBuilder(e,t){var r,n=!1;e.base&&"horizBrace"===e.base.type&&!!e.sup===e.base.isOver&&(n=!0,r=e.base.isOver),!e.base||"op"!==e.base.type&&"operatorname"!==e.base.type||(e.base.parentIsSupSub=!0);var a,i=[$r(e.base,t)];if(e.sub&&i.push($r(e.sub,t)),e.sup&&i.push($r(e.sup,t)),n)a=r?"mover":"munder";else if(e.sub)if(e.sup){var s=e.base;a=s&&"op"===s.type&&s.limits&&t.style===Ce.DISPLAY||s&&"operatorname"===s.type&&s.alwaysHandleSupSub&&(t.style===Ce.DISPLAY||s.limits)?"munderover":"msubsup"}else{var o=e.base;a=o&&"op"===o.type&&o.limits&&(t.style===Ce.DISPLAY||o.alwaysHandleSupSub)||o&&"operatorname"===o.type&&o.alwaysHandleSupSub&&(o.limits||t.style===Ce.DISPLAY)?"munder":"msub"}else{var l=e.base;a=l&&"op"===l.type&&l.limits&&(t.style===Ce.DISPLAY||l.alwaysHandleSupSub)||l&&"operatorname"===l.type&&l.alwaysHandleSupSub&&(l.limits||t.style===Ce.DISPLAY)?"mover":"msup"}return new Er.MathNode(a,i)}}),dr({type:"atom",htmlBuilder:(e,t)=>ar.mathsym(e.text,e.mode,t,["m"+e.family]),mathmlBuilder(e,t){var r=new Er.MathNode("mo",[Hr(e.text,e.mode)]);if("bin"===e.family){var n=Lr(e,t);"bold-italic"===n&&r.setAttribute("mathvariant",n)}else"punct"===e.family?r.setAttribute("separator","true"):"open"!==e.family&&"close"!==e.family||r.setAttribute("stretchy","false");return r}});var Ma={mi:"italic",mn:"normal",mtext:"normal"};dr({type:"mathord",htmlBuilder:(e,t)=>ar.makeOrd(e,t,"mathord"),mathmlBuilder(e,t){var r=new Er.MathNode("mi",[Hr(e.text,e.mode,t)]),n=Lr(e,t)||"italic";return n!==Ma[r.type]&&r.setAttribute("mathvariant",n),r}}),dr({type:"textord",htmlBuilder:(e,t)=>ar.makeOrd(e,t,"textord"),mathmlBuilder(e,t){var r,n=Hr(e.text,e.mode,t),a=Lr(e,t)||"normal";return r="text"===e.mode?new Er.MathNode("mtext",[n]):/[0-9]/.test(e.text)?new Er.MathNode("mn",[n]):"\\prime"===e.text?new Er.MathNode("mo",[n]):new Er.MathNode("mi",[n]),a!==Ma[r.type]&&r.setAttribute("mathvariant",a),r}});var Ta={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},Aa={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};dr({type:"spacing",htmlBuilder(e,t){if(Aa.hasOwnProperty(e.text)){var r=Aa[e.text].className||"";if("text"===e.mode){var n=ar.makeOrd(e,t,"textord");return n.classes.push(r),n}return ar.makeSpan(["mspace",r],[ar.mathsym(e.text,e.mode,t)],t)}if(Ta.hasOwnProperty(e.text))return ar.makeSpan(["mspace",Ta[e.text]],[],t);throw new me('Unknown type of space "'+e.text+'"')},mathmlBuilder(e,t){if(!Aa.hasOwnProperty(e.text)){if(Ta.hasOwnProperty(e.text))return new Er.MathNode("mspace");throw new me('Unknown type of space "'+e.text+'"')}return new Er.MathNode("mtext",[new Er.TextNode(" ")])}});var Ba=()=>{var e=new Er.MathNode("mtd",[]);return e.setAttribute("width","50%"),e};dr({type:"tag",mathmlBuilder(e,t){var r=new Er.MathNode("mtable",[new Er.MathNode("mtr",[Ba(),new Er.MathNode("mtd",[Pr(e.body,t)]),Ba(),new Er.MathNode("mtd",[Pr(e.tag,t)])])]);return r.setAttribute("width","100%"),r}});var Ca={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},qa={"\\textbf":"textbf","\\textmd":"textmd"},Na={"\\textit":"textit","\\textup":"textup"},Ra=(e,t)=>{var r=e.font;return r?Ca[r]?t.withTextFontFamily(Ca[r]):qa[r]?t.withTextFontWeight(qa[r]):t.withTextFontShape(Na[r]):t};ur({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(e,t){var{parser:r,funcName:n}=e,a=t[0];return{type:"text",mode:r.mode,body:fr(a),font:n}},htmlBuilder(e,t){var r=Ra(e,t),n=kr(e.body,r,!0);return ar.makeSpan(["mord","text"],n,r)},mathmlBuilder(e,t){var r=Ra(e,t);return Pr(e.body,r)}}),ur({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(e,t){var{parser:r}=e;return{type:"underline",mode:r.mode,body:t[0]}},htmlBuilder(e,t){var r=Br(e.body,t),n=ar.makeLineSpan("underline-line",t),a=t.fontMetrics().defaultRuleThickness,i=ar.makeVList({positionType:"top",positionData:r.height,children:[{type:"kern",size:a},{type:"elem",elem:n},{type:"kern",size:3*a},{type:"elem",elem:r}]},t);return ar.makeSpan(["mord","underline"],[i],t)},mathmlBuilder(e,t){var r=new Er.MathNode("mo",[new Er.TextNode("‾")]);r.setAttribute("stretchy","true");var n=new Er.MathNode("munder",[$r(e.body,t),r]);return n.setAttribute("accentunder","true"),n}}),ur({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(e,t){var{parser:r}=e;return{type:"vcenter",mode:r.mode,body:t[0]}},htmlBuilder(e,t){var r=Br(e.body,t),n=t.fontMetrics().axisHeight,a=.5*(r.height-n-(r.depth+n));return ar.makeVList({positionType:"shift",positionData:a,children:[{type:"elem",elem:r}]},t)},mathmlBuilder:(e,t)=>new Er.MathNode("mpadded",[$r(e.body,t)],["vcenter"])}),ur({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(e,t,r){throw new me("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(e,t){for(var r=Ia(e),n=[],a=t.havingStyle(t.style.text()),i=0;i<r.length;i++){var s=r[i];"~"===s&&(s="\\textasciitilde"),n.push(ar.makeSymbol(s,"Typewriter-Regular",e.mode,a,["mord","texttt"]))}return ar.makeSpan(["mord","text"].concat(a.sizingClasses(t)),ar.tryCombineChars(n),a)},mathmlBuilder(e,t){var r=new Er.TextNode(Ia(e)),n=new Er.MathNode("mtext",[r]);return n.setAttribute("mathvariant","monospace"),n}});var Ia=e=>e.body.replace(/ /g,e.star?"␣":" "),Ea=cr,Ha="[ \r\n\t]",Oa="(\\\\[a-zA-Z@]+)"+Ha+"*",La="[̀-ͯ]",Da=new RegExp(La+"+$"),Pa="("+Ha+"+)|\\\\(\n|[ \r\t]+\n?)[ \r\t]*|([!-\\[\\]-‧‪-퟿豈-￿]"+La+"*|[\ud800-\udbff][\udc00-\udfff]"+La+"*|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5|"+Oa+"|\\\\[^\ud800-\udfff])";class $a{constructor(e,t){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=e,this.settings=t,this.tokenRegex=new RegExp(Pa,"g"),this.catcodes={"%":14,"~":13}}setCatcode(e,t){this.catcodes[e]=t}lex(){var e=this.input,t=this.tokenRegex.lastIndex;if(t===e.length)return new pe("EOF",new ce(this,t,t));var r=this.tokenRegex.exec(e);if(null===r||r.index!==t)throw new me("Unexpected character: '"+e[t]+"'",new pe(e[t],new ce(this,t,t+1)));var n=r[6]||r[3]||(r[2]?"\\ ":" ");if(14===this.catcodes[n]){var a=e.indexOf("\n",this.tokenRegex.lastIndex);return-1===a?(this.tokenRegex.lastIndex=e.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=a+1,this.lex()}return new pe(n,new ce(this,t,this.tokenRegex.lastIndex))}}class Va{constructor(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=t,this.builtins=e,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(0===this.undefStack.length)throw new me("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var e=this.undefStack.pop();for(var t in e)e.hasOwnProperty(t)&&(null==e[t]?delete this.current[t]:this.current[t]=e[t])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(e){return this.current.hasOwnProperty(e)||this.builtins.hasOwnProperty(e)}get(e){return this.current.hasOwnProperty(e)?this.current[e]:this.builtins[e]}set(e,t,r){if(void 0===r&&(r=!1),r){for(var n=0;n<this.undefStack.length;n++)delete this.undefStack[n][e];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][e]=t)}else{var a=this.undefStack[this.undefStack.length-1];a&&!a.hasOwnProperty(e)&&(a[e]=this.current[e])}null==t?delete this.current[e]:this.current[e]=t}}var Fa=Xn;Yn("\\noexpand",(function(e){var t=e.popToken();return e.isExpandable(t.text)&&(t.noexpand=!0,t.treatAsRelax=!0),{tokens:[t],numArgs:0}})),Yn("\\expandafter",(function(e){var t=e.popToken();return e.expandOnce(!0),{tokens:[t],numArgs:0}})),Yn("\\@firstoftwo",(function(e){return{tokens:e.consumeArgs(2)[0],numArgs:0}})),Yn("\\@secondoftwo",(function(e){return{tokens:e.consumeArgs(2)[1],numArgs:0}})),Yn("\\@ifnextchar",(function(e){var t=e.consumeArgs(3);e.consumeSpaces();var r=e.future();return 1===t[0].length&&t[0][0].text===r.text?{tokens:t[1],numArgs:0}:{tokens:t[2],numArgs:0}})),Yn("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}"),Yn("\\TextOrMath",(function(e){var t=e.consumeArgs(2);return"text"===e.mode?{tokens:t[0],numArgs:0}:{tokens:t[1],numArgs:0}}));var _a={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};Yn("\\char",(function(e){var t,r=e.popToken(),n="";if("'"===r.text)t=8,r=e.popToken();else if('"'===r.text)t=16,r=e.popToken();else if("`"===r.text)if("\\"===(r=e.popToken()).text[0])n=r.text.charCodeAt(1);else{if("EOF"===r.text)throw new me("\\char` missing argument");n=r.text.charCodeAt(0)}else t=10;if(t){if(null==(n=_a[r.text])||n>=t)throw new me("Invalid base-"+t+" digit "+r.text);for(var a;null!=(a=_a[e.future().text])&&a<t;)n*=t,n+=a,e.popToken()}return"\\@char{"+n+"}"}));var Ga=(e,t,r)=>{var n=e.consumeArg().tokens;if(1!==n.length)throw new me("\\newcommand's first argument must be a macro name");var a=n[0].text,i=e.isDefined(a);if(i&&!t)throw new me("\\newcommand{"+a+"} attempting to redefine "+a+"; use \\renewcommand");if(!i&&!r)throw new me("\\renewcommand{"+a+"} when command "+a+" does not yet exist; use \\newcommand");var s=0;if(1===(n=e.consumeArg().tokens).length&&"["===n[0].text){for(var o="",l=e.expandNextToken();"]"!==l.text&&"EOF"!==l.text;)o+=l.text,l=e.expandNextToken();if(!o.match(/^\s*[0-9]+\s*$/))throw new me("Invalid number of arguments: "+o);s=parseInt(o),n=e.consumeArg().tokens}return e.macros.set(a,{tokens:n,numArgs:s}),""};Yn("\\newcommand",(e=>Ga(e,!1,!0))),Yn("\\renewcommand",(e=>Ga(e,!0,!1))),Yn("\\providecommand",(e=>Ga(e,!0,!0))),Yn("\\message",(e=>{var t=e.consumeArgs(1)[0];return console.log(t.reverse().map((e=>e.text)).join("")),""})),Yn("\\errmessage",(e=>{var t=e.consumeArgs(1)[0];return console.error(t.reverse().map((e=>e.text)).join("")),""})),Yn("\\show",(e=>{var t=e.popToken(),r=t.text;return console.log(t,e.macros.get(r),Ea[r],pt.math[r],pt.text[r]),""})),Yn("\\bgroup","{"),Yn("\\egroup","}"),Yn("~","\\nobreakspace"),Yn("\\lq","`"),Yn("\\rq","'"),Yn("\\aa","\\r a"),Yn("\\AA","\\r A"),Yn("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`©}"),Yn("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}"),Yn("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`®}"),Yn("ℬ","\\mathscr{B}"),Yn("ℰ","\\mathscr{E}"),Yn("ℱ","\\mathscr{F}"),Yn("ℋ","\\mathscr{H}"),Yn("ℐ","\\mathscr{I}"),Yn("ℒ","\\mathscr{L}"),Yn("ℳ","\\mathscr{M}"),Yn("ℛ","\\mathscr{R}"),Yn("ℭ","\\mathfrak{C}"),Yn("ℌ","\\mathfrak{H}"),Yn("ℨ","\\mathfrak{Z}"),Yn("\\Bbbk","\\Bbb{k}"),Yn("·","\\cdotp"),Yn("\\llap","\\mathllap{\\textrm{#1}}"),Yn("\\rlap","\\mathrlap{\\textrm{#1}}"),Yn("\\clap","\\mathclap{\\textrm{#1}}"),Yn("\\mathstrut","\\vphantom{(}"),Yn("\\underbar","\\underline{\\text{#1}}"),Yn("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}'),Yn("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`≠}}"),Yn("\\ne","\\neq"),Yn("≠","\\neq"),Yn("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`∉}}"),Yn("∉","\\notin"),Yn("≘","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`≘}}"),Yn("≙","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`≘}}"),Yn("≚","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`≚}}"),Yn("≛","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`≛}}"),Yn("≝","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`≝}}"),Yn("≞","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`≞}}"),Yn("≟","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`≟}}"),Yn("⟂","\\perp"),Yn("‼","\\mathclose{!\\mkern-0.8mu!}"),Yn("∌","\\notni"),Yn("⌜","\\ulcorner"),Yn("⌝","\\urcorner"),Yn("⌞","\\llcorner"),Yn("⌟","\\lrcorner"),Yn("©","\\copyright"),Yn("®","\\textregistered"),Yn("️","\\textregistered"),Yn("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}'),Yn("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}'),Yn("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}'),Yn("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}'),Yn("\\vdots","\\mathord{\\varvdots\\rule{0pt}{15pt}}"),Yn("⋮","\\vdots"),Yn("\\varGamma","\\mathit{\\Gamma}"),Yn("\\varDelta","\\mathit{\\Delta}"),Yn("\\varTheta","\\mathit{\\Theta}"),Yn("\\varLambda","\\mathit{\\Lambda}"),Yn("\\varXi","\\mathit{\\Xi}"),Yn("\\varPi","\\mathit{\\Pi}"),Yn("\\varSigma","\\mathit{\\Sigma}"),Yn("\\varUpsilon","\\mathit{\\Upsilon}"),Yn("\\varPhi","\\mathit{\\Phi}"),Yn("\\varPsi","\\mathit{\\Psi}"),Yn("\\varOmega","\\mathit{\\Omega}"),Yn("\\substack","\\begin{subarray}{c}#1\\end{subarray}"),Yn("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax"),Yn("\\boxed","\\fbox{$\\displaystyle{#1}$}"),Yn("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;"),Yn("\\implies","\\DOTSB\\;\\Longrightarrow\\;"),Yn("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");var Ua={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};Yn("\\dots",(function(e){var t="\\dotso",r=e.expandAfterFuture().text;return r in Ua?t=Ua[r]:("\\not"===r.slice(0,4)||r in pt.math&&be.contains(["bin","rel"],pt.math[r].group))&&(t="\\dotsb"),t}));var Xa={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};Yn("\\dotso",(function(e){return e.future().text in Xa?"\\ldots\\,":"\\ldots"})),Yn("\\dotsc",(function(e){var t=e.future().text;return t in Xa&&","!==t?"\\ldots\\,":"\\ldots"})),Yn("\\cdots",(function(e){return e.future().text in Xa?"\\@cdots\\,":"\\@cdots"})),Yn("\\dotsb","\\cdots"),Yn("\\dotsm","\\cdots"),Yn("\\dotsi","\\!\\cdots"),Yn("\\dotsx","\\ldots\\,"),Yn("\\DOTSI","\\relax"),Yn("\\DOTSB","\\relax"),Yn("\\DOTSX","\\relax"),Yn("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax"),Yn("\\,","\\tmspace+{3mu}{.1667em}"),Yn("\\thinspace","\\,"),Yn("\\>","\\mskip{4mu}"),Yn("\\:","\\tmspace+{4mu}{.2222em}"),Yn("\\medspace","\\:"),Yn("\\;","\\tmspace+{5mu}{.2777em}"),Yn("\\thickspace","\\;"),Yn("\\!","\\tmspace-{3mu}{.1667em}"),Yn("\\negthinspace","\\!"),Yn("\\negmedspace","\\tmspace-{4mu}{.2222em}"),Yn("\\negthickspace","\\tmspace-{5mu}{.277em}"),Yn("\\enspace","\\kern.5em "),Yn("\\enskip","\\hskip.5em\\relax"),Yn("\\quad","\\hskip1em\\relax"),Yn("\\qquad","\\hskip2em\\relax"),Yn("\\tag","\\@ifstar\\tag@literal\\tag@paren"),Yn("\\tag@paren","\\tag@literal{({#1})}"),Yn("\\tag@literal",(e=>{if(e.macros.get("\\df@tag"))throw new me("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"})),Yn("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}"),Yn("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)"),Yn("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}"),Yn("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1"),Yn("\\newline","\\\\\\relax"),Yn("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var Ya=Ze(Oe["Main-Regular"]["T".charCodeAt(0)][1]-.7*Oe["Main-Regular"]["A".charCodeAt(0)][1]);Yn("\\LaTeX","\\textrm{\\html@mathml{L\\kern-.36em\\raisebox{"+Ya+"}{\\scriptstyle A}\\kern-.15em\\TeX}{LaTeX}}"),Yn("\\KaTeX","\\textrm{\\html@mathml{K\\kern-.17em\\raisebox{"+Ya+"}{\\scriptstyle A}\\kern-.15em\\TeX}{KaTeX}}"),Yn("\\hspace","\\@ifstar\\@hspacer\\@hspace"),Yn("\\@hspace","\\hskip #1\\relax"),Yn("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax"),Yn("\\ordinarycolon",":"),Yn("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}"),Yn("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}'),Yn("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}'),Yn("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}'),Yn("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}'),Yn("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}'),Yn("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}'),Yn("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}'),Yn("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}'),Yn("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}'),Yn("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}'),Yn("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}'),Yn("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}'),Yn("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}'),Yn("∷","\\dblcolon"),Yn("∹","\\eqcolon"),Yn("≔","\\coloneqq"),Yn("≕","\\eqqcolon"),Yn("⩴","\\Coloneqq"),Yn("\\ratio","\\vcentcolon"),Yn("\\coloncolon","\\dblcolon"),Yn("\\colonequals","\\coloneqq"),Yn("\\coloncolonequals","\\Coloneqq"),Yn("\\equalscolon","\\eqqcolon"),Yn("\\equalscoloncolon","\\Eqqcolon"),Yn("\\colonminus","\\coloneq"),Yn("\\coloncolonminus","\\Coloneq"),Yn("\\minuscolon","\\eqcolon"),Yn("\\minuscoloncolon","\\Eqcolon"),Yn("\\coloncolonapprox","\\Colonapprox"),Yn("\\coloncolonsim","\\Colonsim"),Yn("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),Yn("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}"),Yn("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),Yn("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}"),Yn("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`∌}}"),Yn("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}"),Yn("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}"),Yn("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}"),Yn("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}"),Yn("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}"),Yn("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}"),Yn("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}"),Yn("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}"),Yn("\\gvertneqq","\\html@mathml{\\@gvertneqq}{≩}"),Yn("\\lvertneqq","\\html@mathml{\\@lvertneqq}{≨}"),Yn("\\ngeqq","\\html@mathml{\\@ngeqq}{≱}"),Yn("\\ngeqslant","\\html@mathml{\\@ngeqslant}{≱}"),Yn("\\nleqq","\\html@mathml{\\@nleqq}{≰}"),Yn("\\nleqslant","\\html@mathml{\\@nleqslant}{≰}"),Yn("\\nshortmid","\\html@mathml{\\@nshortmid}{∤}"),Yn("\\nshortparallel","\\html@mathml{\\@nshortparallel}{∦}"),Yn("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{⊈}"),Yn("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{⊉}"),Yn("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{⊊}"),Yn("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{⫋}"),Yn("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{⊋}"),Yn("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{⫌}"),Yn("\\imath","\\html@mathml{\\@imath}{ı}"),Yn("\\jmath","\\html@mathml{\\@jmath}{ȷ}"),Yn("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`⟦}}"),Yn("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`⟧}}"),Yn("⟦","\\llbracket"),Yn("⟧","\\rrbracket"),Yn("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`⦃}}"),Yn("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`⦄}}"),Yn("⦃","\\lBrace"),Yn("⦄","\\rBrace"),Yn("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`⦵}}"),Yn("⦵","\\minuso"),Yn("\\darr","\\downarrow"),Yn("\\dArr","\\Downarrow"),Yn("\\Darr","\\Downarrow"),Yn("\\lang","\\langle"),Yn("\\rang","\\rangle"),Yn("\\uarr","\\uparrow"),Yn("\\uArr","\\Uparrow"),Yn("\\Uarr","\\Uparrow"),Yn("\\N","\\mathbb{N}"),Yn("\\R","\\mathbb{R}"),Yn("\\Z","\\mathbb{Z}"),Yn("\\alef","\\aleph"),Yn("\\alefsym","\\aleph"),Yn("\\Alpha","\\mathrm{A}"),Yn("\\Beta","\\mathrm{B}"),Yn("\\bull","\\bullet"),Yn("\\Chi","\\mathrm{X}"),Yn("\\clubs","\\clubsuit"),Yn("\\cnums","\\mathbb{C}"),Yn("\\Complex","\\mathbb{C}"),Yn("\\Dagger","\\ddagger"),Yn("\\diamonds","\\diamondsuit"),Yn("\\empty","\\emptyset"),Yn("\\Epsilon","\\mathrm{E}"),Yn("\\Eta","\\mathrm{H}"),Yn("\\exist","\\exists"),Yn("\\harr","\\leftrightarrow"),Yn("\\hArr","\\Leftrightarrow"),Yn("\\Harr","\\Leftrightarrow"),Yn("\\hearts","\\heartsuit"),Yn("\\image","\\Im"),Yn("\\infin","\\infty"),Yn("\\Iota","\\mathrm{I}"),Yn("\\isin","\\in"),Yn("\\Kappa","\\mathrm{K}"),Yn("\\larr","\\leftarrow"),Yn("\\lArr","\\Leftarrow"),Yn("\\Larr","\\Leftarrow"),Yn("\\lrarr","\\leftrightarrow"),Yn("\\lrArr","\\Leftrightarrow"),Yn("\\Lrarr","\\Leftrightarrow"),Yn("\\Mu","\\mathrm{M}"),Yn("\\natnums","\\mathbb{N}"),Yn("\\Nu","\\mathrm{N}"),Yn("\\Omicron","\\mathrm{O}"),Yn("\\plusmn","\\pm"),Yn("\\rarr","\\rightarrow"),Yn("\\rArr","\\Rightarrow"),Yn("\\Rarr","\\Rightarrow"),Yn("\\real","\\Re"),Yn("\\reals","\\mathbb{R}"),Yn("\\Reals","\\mathbb{R}"),Yn("\\Rho","\\mathrm{P}"),Yn("\\sdot","\\cdot"),Yn("\\sect","\\S"),Yn("\\spades","\\spadesuit"),Yn("\\sub","\\subset"),Yn("\\sube","\\subseteq"),Yn("\\supe","\\supseteq"),Yn("\\Tau","\\mathrm{T}"),Yn("\\thetasym","\\vartheta"),Yn("\\weierp","\\wp"),Yn("\\Zeta","\\mathrm{Z}"),Yn("\\argmin","\\DOTSB\\operatorname*{arg\\,min}"),Yn("\\argmax","\\DOTSB\\operatorname*{arg\\,max}"),Yn("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits"),Yn("\\bra","\\mathinner{\\langle{#1}|}"),Yn("\\ket","\\mathinner{|{#1}\\rangle}"),Yn("\\braket","\\mathinner{\\langle{#1}\\rangle}"),Yn("\\Bra","\\left\\langle#1\\right|"),Yn("\\Ket","\\left|#1\\right\\rangle");var Wa=e=>t=>{var r=t.consumeArg().tokens,n=t.consumeArg().tokens,a=t.consumeArg().tokens,i=t.consumeArg().tokens,s=t.macros.get("|"),o=t.macros.get("\\|");t.macros.beginGroup();var l=t=>r=>{e&&(r.macros.set("|",s),a.length&&r.macros.set("\\|",o));var i=t;!t&&a.length&&("|"===r.future().text&&(r.popToken(),i=!0));return{tokens:i?a:n,numArgs:0}};t.macros.set("|",l(!1)),a.length&&t.macros.set("\\|",l(!0));var h=t.consumeArg().tokens,c=t.expandTokens([...i,...h,...r]);return t.macros.endGroup(),{tokens:c.reverse(),numArgs:0}};Yn("\\bra@ket",Wa(!1)),Yn("\\bra@set",Wa(!0)),Yn("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}"),Yn("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}"),Yn("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}"),Yn("\\angln","{\\angl n}"),Yn("\\blue","\\textcolor{##6495ed}{#1}"),Yn("\\orange","\\textcolor{##ffa500}{#1}"),Yn("\\pink","\\textcolor{##ff00af}{#1}"),Yn("\\red","\\textcolor{##df0030}{#1}"),Yn("\\green","\\textcolor{##28ae7b}{#1}"),Yn("\\gray","\\textcolor{gray}{#1}"),Yn("\\purple","\\textcolor{##9d38bd}{#1}"),Yn("\\blueA","\\textcolor{##ccfaff}{#1}"),Yn("\\blueB","\\textcolor{##80f6ff}{#1}"),Yn("\\blueC","\\textcolor{##63d9ea}{#1}"),Yn("\\blueD","\\textcolor{##11accd}{#1}"),Yn("\\blueE","\\textcolor{##0c7f99}{#1}"),Yn("\\tealA","\\textcolor{##94fff5}{#1}"),Yn("\\tealB","\\textcolor{##26edd5}{#1}"),Yn("\\tealC","\\textcolor{##01d1c1}{#1}"),Yn("\\tealD","\\textcolor{##01a995}{#1}"),Yn("\\tealE","\\textcolor{##208170}{#1}"),Yn("\\greenA","\\textcolor{##b6ffb0}{#1}"),Yn("\\greenB","\\textcolor{##8af281}{#1}"),Yn("\\greenC","\\textcolor{##74cf70}{#1}"),Yn("\\greenD","\\textcolor{##1fab54}{#1}"),Yn("\\greenE","\\textcolor{##0d923f}{#1}"),Yn("\\goldA","\\textcolor{##ffd0a9}{#1}"),Yn("\\goldB","\\textcolor{##ffbb71}{#1}"),Yn("\\goldC","\\textcolor{##ff9c39}{#1}"),Yn("\\goldD","\\textcolor{##e07d10}{#1}"),Yn("\\goldE","\\textcolor{##a75a05}{#1}"),Yn("\\redA","\\textcolor{##fca9a9}{#1}"),Yn("\\redB","\\textcolor{##ff8482}{#1}"),Yn("\\redC","\\textcolor{##f9685d}{#1}"),Yn("\\redD","\\textcolor{##e84d39}{#1}"),Yn("\\redE","\\textcolor{##bc2612}{#1}"),Yn("\\maroonA","\\textcolor{##ffbde0}{#1}"),Yn("\\maroonB","\\textcolor{##ff92c6}{#1}"),Yn("\\maroonC","\\textcolor{##ed5fa6}{#1}"),Yn("\\maroonD","\\textcolor{##ca337c}{#1}"),Yn("\\maroonE","\\textcolor{##9e034e}{#1}"),Yn("\\purpleA","\\textcolor{##ddd7ff}{#1}"),Yn("\\purpleB","\\textcolor{##c6b9fc}{#1}"),Yn("\\purpleC","\\textcolor{##aa87ff}{#1}"),Yn("\\purpleD","\\textcolor{##7854ab}{#1}"),Yn("\\purpleE","\\textcolor{##543b78}{#1}"),Yn("\\mintA","\\textcolor{##f5f9e8}{#1}"),Yn("\\mintB","\\textcolor{##edf2df}{#1}"),Yn("\\mintC","\\textcolor{##e0e5cc}{#1}"),Yn("\\grayA","\\textcolor{##f6f7f7}{#1}"),Yn("\\grayB","\\textcolor{##f0f1f2}{#1}"),Yn("\\grayC","\\textcolor{##e3e5e6}{#1}"),Yn("\\grayD","\\textcolor{##d6d8da}{#1}"),Yn("\\grayE","\\textcolor{##babec2}{#1}"),Yn("\\grayF","\\textcolor{##888d93}{#1}"),Yn("\\grayG","\\textcolor{##626569}{#1}"),Yn("\\grayH","\\textcolor{##3b3e40}{#1}"),Yn("\\grayI","\\textcolor{##21242c}{#1}"),Yn("\\kaBlue","\\textcolor{##314453}{#1}"),Yn("\\kaGreen","\\textcolor{##71B307}{#1}");var Za={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class ja{constructor(e,t,r){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=t,this.expansionCount=0,this.feed(e),this.macros=new Va(Fa,t.macros),this.mode=r,this.stack=[]}feed(e){this.lexer=new $a(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return 0===this.stack.length&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){var t,r,n;if(e){if(this.consumeSpaces(),"["!==this.future().text)return null;t=this.popToken(),({tokens:n,end:r}=this.consumeArg(["]"]))}else({tokens:n,start:t,end:r}=this.consumeArg());return this.pushToken(new pe("EOF",r.loc)),this.pushTokens(n),t.range(r,"")}consumeSpaces(){for(;;){if(" "!==this.future().text)break;this.stack.pop()}}consumeArg(e){var t=[],r=e&&e.length>0;r||this.consumeSpaces();var n,a=this.future(),i=0,s=0;do{if(n=this.popToken(),t.push(n),"{"===n.text)++i;else if("}"===n.text){if(-1===--i)throw new me("Extra }",n)}else if("EOF"===n.text)throw new me("Unexpected end of input in a macro argument, expected '"+(e&&r?e[s]:"}")+"'",n);if(e&&r)if((0===i||1===i&&"{"===e[s])&&n.text===e[s]){if(++s===e.length){t.splice(-s,s);break}}else s=0}while(0!==i||r);return"{"===a.text&&"}"===t[t.length-1].text&&(t.pop(),t.shift()),t.reverse(),{tokens:t,start:a,end:n}}consumeArgs(e,t){if(t){if(t.length!==e+1)throw new me("The length of delimiters doesn't match the number of args!");for(var r=t[0],n=0;n<r.length;n++){var a=this.popToken();if(r[n]!==a.text)throw new me("Use of the macro doesn't match its definition",a)}}for(var i=[],s=0;s<e;s++)i.push(this.consumeArg(t&&t[s+1]).tokens);return i}countExpansion(e){if(this.expansionCount+=e,this.expansionCount>this.settings.maxExpand)throw new me("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(e){var t=this.popToken(),r=t.text,n=t.noexpand?null:this._getExpansion(r);if(null==n||e&&n.unexpandable){if(e&&null==n&&"\\"===r[0]&&!this.isDefined(r))throw new me("Undefined control sequence: "+r);return this.pushToken(t),!1}this.countExpansion(1);var a=n.tokens,i=this.consumeArgs(n.numArgs,n.delimiters);if(n.numArgs)for(var s=(a=a.slice()).length-1;s>=0;--s){var o=a[s];if("#"===o.text){if(0===s)throw new me("Incomplete placeholder at end of macro body",o);if("#"===(o=a[--s]).text)a.splice(s+1,1);else{if(!/^[1-9]$/.test(o.text))throw new me("Not a valid argument number",o);a.splice(s,2,...i[+o.text-1])}}}return this.pushTokens(a),a.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(!1===this.expandOnce()){var e=this.stack.pop();return e.treatAsRelax&&(e.text="\\relax"),e}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new pe(e)]):void 0}expandTokens(e){var t=[],r=this.stack.length;for(this.pushTokens(e);this.stack.length>r;)if(!1===this.expandOnce(!0)){var n=this.stack.pop();n.treatAsRelax&&(n.noexpand=!1,n.treatAsRelax=!1),t.push(n)}return this.countExpansion(t.length),t}expandMacroAsText(e){var t=this.expandMacro(e);return t?t.map((e=>e.text)).join(""):t}_getExpansion(e){var t=this.macros.get(e);if(null==t)return t;if(1===e.length){var r=this.lexer.catcodes[e];if(null!=r&&13!==r)return}var n="function"==typeof t?t(this):t;if("string"==typeof n){var a=0;if(-1!==n.indexOf("#"))for(var i=n.replace(/##/g,"");-1!==i.indexOf("#"+(a+1));)++a;for(var s=new $a(n,this.settings),o=[],l=s.lex();"EOF"!==l.text;)o.push(l),l=s.lex();return o.reverse(),{tokens:o,numArgs:a}}return n}isDefined(e){return this.macros.has(e)||Ea.hasOwnProperty(e)||pt.math.hasOwnProperty(e)||pt.text.hasOwnProperty(e)||Za.hasOwnProperty(e)}isExpandable(e){var t=this.macros.get(e);return null!=t?"string"==typeof t||"function"==typeof t||!t.unexpandable:Ea.hasOwnProperty(e)&&!Ea[e].primitive}}var Ka=/^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/,Qa=Object.freeze({"₊":"+","₋":"-","₌":"=","₍":"(","₎":")","₀":"0","₁":"1","₂":"2","₃":"3","₄":"4","₅":"5","₆":"6","₇":"7","₈":"8","₉":"9","ₐ":"a","ₑ":"e","ₕ":"h","ᵢ":"i","ⱼ":"j","ₖ":"k","ₗ":"l","ₘ":"m","ₙ":"n","ₒ":"o","ₚ":"p","ᵣ":"r","ₛ":"s","ₜ":"t","ᵤ":"u","ᵥ":"v","ₓ":"x","ᵦ":"β","ᵧ":"γ","ᵨ":"ρ","ᵩ":"ϕ","ᵪ":"χ","⁺":"+","⁻":"-","⁼":"=","⁽":"(","⁾":")","⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","ᴬ":"A","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ⱽ":"V","ᵂ":"W","ᵃ":"a","ᵇ":"b","ᶜ":"c","ᵈ":"d","ᵉ":"e","ᶠ":"f","ᵍ":"g","ʰ":"h","ⁱ":"i","ʲ":"j","ᵏ":"k","ˡ":"l","ᵐ":"m","ⁿ":"n","ᵒ":"o","ᵖ":"p","ʳ":"r","ˢ":"s","ᵗ":"t","ᵘ":"u","ᵛ":"v","ʷ":"w","ˣ":"x","ʸ":"y","ᶻ":"z","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"ϕ","ᵡ":"χ","ᶿ":"θ"}),Ja={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"},"̧":{text:"\\c"}},ei={"á":"á","à":"à","ä":"ä","ǟ":"ǟ","ã":"ã","ā":"ā","ă":"ă","ắ":"ắ","ằ":"ằ","ẵ":"ẵ","ǎ":"ǎ","â":"â","ấ":"ấ","ầ":"ầ","ẫ":"ẫ","ȧ":"ȧ","ǡ":"ǡ","å":"å","ǻ":"ǻ","ḃ":"ḃ","ć":"ć","ḉ":"ḉ","č":"č","ĉ":"ĉ","ċ":"ċ","ç":"ç","ď":"ď","ḋ":"ḋ","ḑ":"ḑ","é":"é","è":"è","ë":"ë","ẽ":"ẽ","ē":"ē","ḗ":"ḗ","ḕ":"ḕ","ĕ":"ĕ","ḝ":"ḝ","ě":"ě","ê":"ê","ế":"ế","ề":"ề","ễ":"ễ","ė":"ė","ȩ":"ȩ","ḟ":"ḟ","ǵ":"ǵ","ḡ":"ḡ","ğ":"ğ","ǧ":"ǧ","ĝ":"ĝ","ġ":"ġ","ģ":"ģ","ḧ":"ḧ","ȟ":"ȟ","ĥ":"ĥ","ḣ":"ḣ","ḩ":"ḩ","í":"í","ì":"ì","ï":"ï","ḯ":"ḯ","ĩ":"ĩ","ī":"ī","ĭ":"ĭ","ǐ":"ǐ","î":"î","ǰ":"ǰ","ĵ":"ĵ","ḱ":"ḱ","ǩ":"ǩ","ķ":"ķ","ĺ":"ĺ","ľ":"ľ","ļ":"ļ","ḿ":"ḿ","ṁ":"ṁ","ń":"ń","ǹ":"ǹ","ñ":"ñ","ň":"ň","ṅ":"ṅ","ņ":"ņ","ó":"ó","ò":"ò","ö":"ö","ȫ":"ȫ","õ":"õ","ṍ":"ṍ","ṏ":"ṏ","ȭ":"ȭ","ō":"ō","ṓ":"ṓ","ṑ":"ṑ","ŏ":"ŏ","ǒ":"ǒ","ô":"ô","ố":"ố","ồ":"ồ","ỗ":"ỗ","ȯ":"ȯ","ȱ":"ȱ","ő":"ő","ṕ":"ṕ","ṗ":"ṗ","ŕ":"ŕ","ř":"ř","ṙ":"ṙ","ŗ":"ŗ","ś":"ś","ṥ":"ṥ","š":"š","ṧ":"ṧ","ŝ":"ŝ","ṡ":"ṡ","ş":"ş","ẗ":"ẗ","ť":"ť","ṫ":"ṫ","ţ":"ţ","ú":"ú","ù":"ù","ü":"ü","ǘ":"ǘ","ǜ":"ǜ","ǖ":"ǖ","ǚ":"ǚ","ũ":"ũ","ṹ":"ṹ","ū":"ū","ṻ":"ṻ","ŭ":"ŭ","ǔ":"ǔ","û":"û","ů":"ů","ű":"ű","ṽ":"ṽ","ẃ":"ẃ","ẁ":"ẁ","ẅ":"ẅ","ŵ":"ŵ","ẇ":"ẇ","ẘ":"ẘ","ẍ":"ẍ","ẋ":"ẋ","ý":"ý","ỳ":"ỳ","ÿ":"ÿ","ỹ":"ỹ","ȳ":"ȳ","ŷ":"ŷ","ẏ":"ẏ","ẙ":"ẙ","ź":"ź","ž":"ž","ẑ":"ẑ","ż":"ż","Á":"Á","À":"À","Ä":"Ä","Ǟ":"Ǟ","Ã":"Ã","Ā":"Ā","Ă":"Ă","Ắ":"Ắ","Ằ":"Ằ","Ẵ":"Ẵ","Ǎ":"Ǎ","Â":"Â","Ấ":"Ấ","Ầ":"Ầ","Ẫ":"Ẫ","Ȧ":"Ȧ","Ǡ":"Ǡ","Å":"Å","Ǻ":"Ǻ","Ḃ":"Ḃ","Ć":"Ć","Ḉ":"Ḉ","Č":"Č","Ĉ":"Ĉ","Ċ":"Ċ","Ç":"Ç","Ď":"Ď","Ḋ":"Ḋ","Ḑ":"Ḑ","É":"É","È":"È","Ë":"Ë","Ẽ":"Ẽ","Ē":"Ē","Ḗ":"Ḗ","Ḕ":"Ḕ","Ĕ":"Ĕ","Ḝ":"Ḝ","Ě":"Ě","Ê":"Ê","Ế":"Ế","Ề":"Ề","Ễ":"Ễ","Ė":"Ė","Ȩ":"Ȩ","Ḟ":"Ḟ","Ǵ":"Ǵ","Ḡ":"Ḡ","Ğ":"Ğ","Ǧ":"Ǧ","Ĝ":"Ĝ","Ġ":"Ġ","Ģ":"Ģ","Ḧ":"Ḧ","Ȟ":"Ȟ","Ĥ":"Ĥ","Ḣ":"Ḣ","Ḩ":"Ḩ","Í":"Í","Ì":"Ì","Ï":"Ï","Ḯ":"Ḯ","Ĩ":"Ĩ","Ī":"Ī","Ĭ":"Ĭ","Ǐ":"Ǐ","Î":"Î","İ":"İ","Ĵ":"Ĵ","Ḱ":"Ḱ","Ǩ":"Ǩ","Ķ":"Ķ","Ĺ":"Ĺ","Ľ":"Ľ","Ļ":"Ļ","Ḿ":"Ḿ","Ṁ":"Ṁ","Ń":"Ń","Ǹ":"Ǹ","Ñ":"Ñ","Ň":"Ň","Ṅ":"Ṅ","Ņ":"Ņ","Ó":"Ó","Ò":"Ò","Ö":"Ö","Ȫ":"Ȫ","Õ":"Õ","Ṍ":"Ṍ","Ṏ":"Ṏ","Ȭ":"Ȭ","Ō":"Ō","Ṓ":"Ṓ","Ṑ":"Ṑ","Ŏ":"Ŏ","Ǒ":"Ǒ","Ô":"Ô","Ố":"Ố","Ồ":"Ồ","Ỗ":"Ỗ","Ȯ":"Ȯ","Ȱ":"Ȱ","Ő":"Ő","Ṕ":"Ṕ","Ṗ":"Ṗ","Ŕ":"Ŕ","Ř":"Ř","Ṙ":"Ṙ","Ŗ":"Ŗ","Ś":"Ś","Ṥ":"Ṥ","Š":"Š","Ṧ":"Ṧ","Ŝ":"Ŝ","Ṡ":"Ṡ","Ş":"Ş","Ť":"Ť","Ṫ":"Ṫ","Ţ":"Ţ","Ú":"Ú","Ù":"Ù","Ü":"Ü","Ǘ":"Ǘ","Ǜ":"Ǜ","Ǖ":"Ǖ","Ǚ":"Ǚ","Ũ":"Ũ","Ṹ":"Ṹ","Ū":"Ū","Ṻ":"Ṻ","Ŭ":"Ŭ","Ǔ":"Ǔ","Û":"Û","Ů":"Ů","Ű":"Ű","Ṽ":"Ṽ","Ẃ":"Ẃ","Ẁ":"Ẁ","Ẅ":"Ẅ","Ŵ":"Ŵ","Ẇ":"Ẇ","Ẍ":"Ẍ","Ẋ":"Ẋ","Ý":"Ý","Ỳ":"Ỳ","Ÿ":"Ÿ","Ỹ":"Ỹ","Ȳ":"Ȳ","Ŷ":"Ŷ","Ẏ":"Ẏ","Ź":"Ź","Ž":"Ž","Ẑ":"Ẑ","Ż":"Ż","ά":"ά","ὰ":"ὰ","ᾱ":"ᾱ","ᾰ":"ᾰ","έ":"έ","ὲ":"ὲ","ή":"ή","ὴ":"ὴ","ί":"ί","ὶ":"ὶ","ϊ":"ϊ","ΐ":"ΐ","ῒ":"ῒ","ῑ":"ῑ","ῐ":"ῐ","ό":"ό","ὸ":"ὸ","ύ":"ύ","ὺ":"ὺ","ϋ":"ϋ","ΰ":"ΰ","ῢ":"ῢ","ῡ":"ῡ","ῠ":"ῠ","ώ":"ώ","ὼ":"ὼ","Ύ":"Ύ","Ὺ":"Ὺ","Ϋ":"Ϋ","Ῡ":"Ῡ","Ῠ":"Ῠ","Ώ":"Ώ","Ὼ":"Ὼ"};class ti{constructor(e,t){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new ja(e,t,this.mode),this.settings=t,this.leftrightDepth=0}expect(e,t){if(void 0===t&&(t=!0),this.fetch().text!==e)throw new me("Expected '"+e+"', got '"+this.fetch().text+"'",this.fetch());t&&this.consume()}consume(){this.nextToken=null}fetch(){return null==this.nextToken&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(e){this.mode=e,this.gullet.switchMode(e)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var e=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),e}finally{this.gullet.endGroups()}}subparse(e){var t=this.nextToken;this.consume(),this.gullet.pushToken(new pe("}")),this.gullet.pushTokens(e);var r=this.parseExpression(!1);return this.expect("}"),this.nextToken=t,r}parseExpression(e,t){for(var r=[];;){"math"===this.mode&&this.consumeSpaces();var n=this.fetch();if(-1!==ti.endOfExpression.indexOf(n.text))break;if(t&&n.text===t)break;if(e&&Ea[n.text]&&Ea[n.text].infix)break;var a=this.parseAtom(t);if(!a)break;"internal"!==a.type&&r.push(a)}return"text"===this.mode&&this.formLigatures(r),this.handleInfixNodes(r)}handleInfixNodes(e){for(var t,r=-1,n=0;n<e.length;n++)if("infix"===e[n].type){if(-1!==r)throw new me("only one infix operator per group",e[n].token);r=n,t=e[n].replaceWith}if(-1!==r&&t){var a,i,s=e.slice(0,r),o=e.slice(r+1);return a=1===s.length&&"ordgroup"===s[0].type?s[0]:{type:"ordgroup",mode:this.mode,body:s},i=1===o.length&&"ordgroup"===o[0].type?o[0]:{type:"ordgroup",mode:this.mode,body:o},["\\\\abovefrac"===t?this.callFunction(t,[a,e[r],i],[]):this.callFunction(t,[a,i],[])]}return e}handleSupSubscript(e){var t=this.fetch(),r=t.text;this.consume(),this.consumeSpaces();var n=this.parseGroup(e);if(!n)throw new me("Expected group after '"+r+"'",t);return n}formatUnsupportedCmd(e){for(var t=[],r=0;r<e.length;r++)t.push({type:"textord",mode:"text",text:e[r]});var n={type:"text",mode:this.mode,body:t};return{type:"color",mode:this.mode,color:this.settings.errorColor,body:[n]}}parseAtom(e){var t,r,n=this.parseGroup("atom",e);if("text"===this.mode)return n;for(;;){this.consumeSpaces();var a=this.fetch();if("\\limits"===a.text||"\\nolimits"===a.text){if(n&&"op"===n.type){var i="\\limits"===a.text;n.limits=i,n.alwaysHandleSupSub=!0}else{if(!n||"operatorname"!==n.type)throw new me("Limit controls must follow a math operator",a);n.alwaysHandleSupSub&&(n.limits="\\limits"===a.text)}this.consume()}else if("^"===a.text){if(t)throw new me("Double superscript",a);t=this.handleSupSubscript("superscript")}else if("_"===a.text){if(r)throw new me("Double subscript",a);r=this.handleSupSubscript("subscript")}else if("'"===a.text){if(t)throw new me("Double superscript",a);var s={type:"textord",mode:this.mode,text:"\\prime"},o=[s];for(this.consume();"'"===this.fetch().text;)o.push(s),this.consume();"^"===this.fetch().text&&o.push(this.handleSupSubscript("superscript")),t={type:"ordgroup",mode:this.mode,body:o}}else{if(!Qa[a.text])break;var l=Ka.test(a.text),h=[];for(h.push(new pe(Qa[a.text])),this.consume();;){var c=this.fetch().text;if(!Qa[c])break;if(Ka.test(c)!==l)break;h.unshift(new pe(Qa[c])),this.consume()}var p=this.subparse(h);l?r={type:"ordgroup",mode:"math",body:p}:t={type:"ordgroup",mode:"math",body:p}}}return t||r?{type:"supsub",mode:this.mode,base:n,sup:t,sub:r}:n}parseFunction(e,t){var r=this.fetch(),n=r.text,a=Ea[n];if(!a)return null;if(this.consume(),t&&"atom"!==t&&!a.allowedInArgument)throw new me("Got function '"+n+"' with no arguments"+(t?" as "+t:""),r);if("text"===this.mode&&!a.allowedInText)throw new me("Can't use function '"+n+"' in text mode",r);if("math"===this.mode&&!1===a.allowedInMath)throw new me("Can't use function '"+n+"' in math mode",r);var{args:i,optArgs:s}=this.parseArguments(n,a);return this.callFunction(n,i,s,r,e)}callFunction(e,t,r,n,a){var i={funcName:e,parser:this,token:n,breakOnTokenText:a},s=Ea[e];if(s&&s.handler)return s.handler(i,t,r);throw new me("No function handler for "+e)}parseArguments(e,t){var r=t.numArgs+t.numOptionalArgs;if(0===r)return{args:[],optArgs:[]};for(var n=[],a=[],i=0;i<r;i++){var s=t.argTypes&&t.argTypes[i],o=i<t.numOptionalArgs;(t.primitive&&null==s||"sqrt"===t.type&&1===i&&null==a[0])&&(s="primitive");var l=this.parseGroupOfType("argument to '"+e+"'",s,o);if(o)a.push(l);else{if(null==l)throw new me("Null argument, please report this as a bug");n.push(l)}}return{args:n,optArgs:a}}parseGroupOfType(e,t,r){switch(t){case"color":return this.parseColorGroup(r);case"size":return this.parseSizeGroup(r);case"url":return this.parseUrlGroup(r);case"math":case"text":return this.parseArgumentGroup(r,t);case"hbox":var n=this.parseArgumentGroup(r,"text");return null!=n?{type:"styling",mode:n.mode,body:[n],style:"text"}:null;case"raw":var a=this.parseStringGroup("raw",r);return null!=a?{type:"raw",mode:"text",string:a.text}:null;case"primitive":if(r)throw new me("A primitive argument cannot be optional");var i=this.parseGroup(e);if(null==i)throw new me("Expected group as "+e,this.fetch());return i;case"original":case null:case void 0:return this.parseArgumentGroup(r);default:throw new me("Unknown group type as "+e,this.fetch())}}consumeSpaces(){for(;" "===this.fetch().text;)this.consume()}parseStringGroup(e,t){var r=this.gullet.scanArgument(t);if(null==r)return null;for(var n,a="";"EOF"!==(n=this.fetch()).text;)a+=n.text,this.consume();return this.consume(),r.text=a,r}parseRegexGroup(e,t){for(var r,n=this.fetch(),a=n,i="";"EOF"!==(r=this.fetch()).text&&e.test(i+r.text);)i+=(a=r).text,this.consume();if(""===i)throw new me("Invalid "+t+": '"+n.text+"'",n);return n.range(a,i)}parseColorGroup(e){var t=this.parseStringGroup("color",e);if(null==t)return null;var r=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(t.text);if(!r)throw new me("Invalid color: '"+t.text+"'",t);var n=r[0];return/^[0-9a-f]{6}$/i.test(n)&&(n="#"+n),{type:"color-token",mode:this.mode,color:n}}parseSizeGroup(e){var t,r=!1;if(this.gullet.consumeSpaces(),!(t=e||"{"===this.gullet.future().text?this.parseStringGroup("size",e):this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size")))return null;e||0!==t.text.length||(t.text="0pt",r=!0);var n=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(t.text);if(!n)throw new me("Invalid size: '"+t.text+"'",t);var a={number:+(n[1]+n[2]),unit:n[3]};if(!Ye(a))throw new me("Invalid unit: '"+a.unit+"'",t);return{type:"size",mode:this.mode,value:a,isBlank:r}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var t=this.parseStringGroup("url",e);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),null==t)return null;var r=t.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:r}}parseArgumentGroup(e,t){var r=this.gullet.scanArgument(e);if(null==r)return null;var n=this.mode;t&&this.switchMode(t),this.gullet.beginGroup();var a=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var i={type:"ordgroup",mode:this.mode,loc:r.loc,body:a};return t&&this.switchMode(n),i}parseGroup(e,t){var r,n=this.fetch(),a=n.text;if("{"===a||"\\begingroup"===a){this.consume();var i="{"===a?"}":"\\endgroup";this.gullet.beginGroup();var s=this.parseExpression(!1,i),o=this.fetch();this.expect(i),this.gullet.endGroup(),r={type:"ordgroup",mode:this.mode,loc:ce.range(n,o),body:s,semisimple:"\\begingroup"===a||void 0}}else if(null==(r=this.parseFunction(t,e)||this.parseSymbol())&&"\\"===a[0]&&!Za.hasOwnProperty(a)){if(this.settings.throwOnError)throw new me("Undefined control sequence: "+a,n);r=this.formatUnsupportedCmd(a),this.consume()}return r}formLigatures(e){for(var t=e.length-1,r=0;r<t;++r){var n=e[r],a=n.text;"-"===a&&"-"===e[r+1].text&&(r+1<t&&"-"===e[r+2].text?(e.splice(r,3,{type:"textord",mode:"text",loc:ce.range(n,e[r+2]),text:"---"}),t-=2):(e.splice(r,2,{type:"textord",mode:"text",loc:ce.range(n,e[r+1]),text:"--"}),t-=1)),"'"!==a&&"`"!==a||e[r+1].text!==a||(e.splice(r,2,{type:"textord",mode:"text",loc:ce.range(n,e[r+1]),text:a+a}),t-=1)}}parseSymbol(){var e=this.fetch(),t=e.text;if(/^\\verb[^a-zA-Z]/.test(t)){this.consume();var r=t.slice(5),n="*"===r.charAt(0);if(n&&(r=r.slice(1)),r.length<2||r.charAt(0)!==r.slice(-1))throw new me("\\verb assertion failed --\n                    please report what input caused this bug");return{type:"verb",mode:"text",body:r=r.slice(1,-1),star:n}}ei.hasOwnProperty(t[0])&&!pt[this.mode][t[0]]&&(this.settings.strict&&"math"===this.mode&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+t[0]+'" used in math mode',e),t=ei[t[0]]+t.slice(1));var a,i=Da.exec(t);if(i&&("i"===(t=t.substring(0,i.index))?t="ı":"j"===t&&(t="ȷ")),pt[this.mode][t]){this.settings.strict&&"math"===this.mode&&_t.indexOf(t)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+t[0]+'" used in math mode',e);var s,o=pt[this.mode][t].group,l=ce.range(e);if(ht.hasOwnProperty(o)){var h=o;s={type:"atom",mode:this.mode,family:h,loc:l,text:t}}else s={type:o,mode:this.mode,loc:l,text:t};a=s}else{if(!(t.charCodeAt(0)>=128))return null;this.settings.strict&&(Re(t.charCodeAt(0))?"math"===this.mode&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+t[0]+'" used in math mode',e):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+t[0]+'" ('+t.charCodeAt(0)+")",e)),a={type:"textord",mode:"text",loc:ce.range(e),text:t}}if(this.consume(),i)for(var c=0;c<i[0].length;c++){var p=i[0][c];if(!Ja[p])throw new me("Unknown accent ' "+p+"'",e);var m=Ja[p][this.mode]||Ja[p].text;if(!m)throw new me("Accent "+p+" unsupported in "+this.mode+" mode",e);a={type:"accent",mode:this.mode,loc:ce.range(e),label:m,isStretchy:!1,isShifty:!0,base:a}}return a}}ti.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var ri=function(e,t){if(!("string"==typeof e||e instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var r=new ti(e,t);delete r.gullet.macros.current["\\df@tag"];var n=r.parse();if(delete r.gullet.macros.current["\\current@color"],delete r.gullet.macros.current["\\color"],r.gullet.macros.get("\\df@tag")){if(!t.displayMode)throw new me("\\tag works only in display equations");n=[{type:"tag",mode:"text",body:n,tag:r.subparse([new pe("\\df@tag")])}]}return n},ni=function(e,t,r){t.textContent="";var n=ii(e,r).toNode();t.appendChild(n)};"undefined"!=typeof document&&"CSS1Compat"!==document.compatMode&&("undefined"!=typeof console&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),ni=function(){throw new me("KaTeX doesn't work in quirks mode.")});var ai=function(e,t,r){if(r.throwOnError||!(e instanceof me))throw e;var n=ar.makeSpan(["katex-error"],[new at(t)]);return n.setAttribute("title",e.toString()),n.setAttribute("style","color:"+r.errorColor),n},ii=function(e,t){var r=new ye(t);try{return function(e,t,r){var n,a=Fr(r);if("mathml"===r.output)return Vr(e,t,a,r.displayMode,!0);if("html"===r.output){var i=qr(e,a);n=ar.makeSpan(["katex"],[i])}else{var s=Vr(e,t,a,r.displayMode,!1),o=qr(e,a);n=ar.makeSpan(["katex"],[s,o])}return _r(n,r)}(ri(e,r),e,r)}catch(t){return ai(t,e,r)}},si={version:"0.16.10",render:ni,renderToString:function(e,t){return ii(e,t).toMarkup()},ParseError:me,SETTINGS_SCHEMA:ve,__parse:function(e,t){var r=new ye(t);return ri(e,r)},__renderToDomTree:ii,__renderToHTMLTree:function(e,t){var r=new ye(t);try{return function(e,t,r){var n=qr(e,Fr(r)),a=ar.makeSpan(["katex"],[n]);return _r(a,r)}(ri(e,r),0,r)}catch(t){return ai(t,e,r)}},__setFontMetrics:function(e,t){Oe[e]=t},__defineSymbol:mt,__defineFunction:ur,__defineMacro:Yn,__domTree:{Span:et,Anchor:tt,SymbolNode:at,SvgNode:it,PathNode:st,LineNode:ot}};const oi=function(e,t,r){let n=r,a=0;const i=e.length;for(;n<t.length;){const r=t[n];if(a<=0&&t.slice(n,n+i)===e)return n;"\\"===r?n++:"{"===r?a++:"}"===r&&a--,n++}return-1},li=/^\\begin{/,hi=function(e,t,r){const n=function(e,t){let r;const n=[],a=new RegExp("("+t.map((e=>e.left.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"))).join("|")+")");for(;r=e.search(a),-1!==r;){r>0&&(n.push({type:"text",data:e.slice(0,r)}),e=e.slice(r));const a=t.findIndex((t=>e.startsWith(t.left)));if(r=oi(t[a].right,e,t[a].left.length),-1===r)break;const i=e.slice(0,r+t[a].right.length),s=li.test(i)?i:e.slice(t[a].left.length,r);n.push({type:"math",data:s,rawData:i,display:t[a].display}),e=e.slice(r+t[a].right.length)}return""!==e&&n.push({type:"text",data:e}),n}(e,t.delimiters);if(1===n.length&&"text"===n[0].type)return null;const a=document.createDocumentFragment();for(let e=0;e<n.length;e++)if("text"===n[e].type)a.appendChild(document.createTextNode(n[e].data));else{const i=document.createElement("span");let s=n[e].data;if(t.displayMode=n[e].display,!t.customRenderer(n[e],i,a,t,r.parentNode)){try{t.preProcess&&(s=t.preProcess(s)),si.render(s,i,t)}catch(r){if(!(r instanceof si.ParseError))throw r;t.errorCallback("KaTeX auto-render: Failed to parse `"+n[e].data+"` with ",r),a.appendChild(document.createTextNode(n[e].rawData));continue}a.appendChild(t.postRender(i))}}return a},ci=function(e,t){for(let r=0;r<e.childNodes.length;r++){const n=e.childNodes[r];if(3===n.nodeType){let a=n.textContent,i=n.nextSibling,s=0;for(;i&&i.nodeType===Node.TEXT_NODE;)a+=i.textContent,i=i.nextSibling,s++;const o=hi(a,t,n);if(o){for(let e=0;e<s;e++)n.nextSibling.remove();r+=o.childNodes.length-1,e.replaceChild(o,n)}else r+=s}else if(1===n.nodeType){const e=" "+n.className+" ";-1===t.ignoredTags.indexOf(n.nodeName.toLowerCase())&&t.ignoredClasses.every((t=>-1===e.indexOf(" "+t+" ")))&&ci(n,t)}}},pi=function(e,t){if(!e)throw new Error("No element provided to render");const r={};for(const e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);r.postRender=r.postRender||(e=>e),r.delimiters=r.delimiters||[{left:"$$",right:"$$",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\begin{CD}",right:"\\end{CD}",display:!0},{left:"\\[",right:"\\]",display:!0}],r.ignoredTags=r.ignoredTags||["script","noscript","style","textarea","pre","code","option"],r.ignoredClasses=r.ignoredClasses||[],r.errorCallback=r.errorCallback||console.error,r.macros=r.macros||{},r.customRenderer=r.customRenderer||(e=>!1),ci(e,r)};new interpretate.shared("katex",(async e=>{e.default=si,e.autorender=pi})),new interpretate.shared("Marked",(async e=>{e.default=oe,e.Renderer=ne}));</script>
<script type="module">class t{constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,n){let s=[];return this.decompose(0,t,s,2),n.length&&n.decompose(0,n.length,s,3),this.decompose(e,this.length,s,1),i.from(s,this.length-(e-t)+n.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let n=[];return this.decompose(t,e,n,0),i.from(n,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new r(this),s=new r(t);for(let t=e,r=e;;){if(n.next(t),s.next(t),t=0,n.lineBreak!=s.lineBreak||n.done!=s.done||n.value!=s.value)return!1;if(r+=n.value.length,n.done||r>=i)return!0}}iter(t=1){return new r(this,t)}iterRange(t,e=this.length){return new o(this,t,e)}iterLines(t,e){let i;if(null==t)i=this.iter();else{null==e&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new a(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}static of(n){if(0==n.length)throw new RangeError("A document must have at least one line");return 1!=n.length||n[0]?n.length<=32?new e(n):i.from(e.split(n,[])):t.empty}}class e extends t{constructor(t,e=function(t){let e=-1;for(let i of t)e+=i.length+1;return e}(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let s=0;;s++){let r=this.text[s],o=n+r.length;if((e?i:o)>=t)return new l(n,o,i,r);n=o+1,i++}}decompose(t,i,r,o){let a=t<=0&&i>=this.length?this:new e(s(this.text,t,i),Math.min(i,this.length)-Math.max(0,t));if(1&o){let t=r.pop(),i=n(a.text,t.text.slice(),0,a.length);if(i.length<=32)r.push(new e(i,t.length+a.length));else{let t=i.length>>1;r.push(new e(i.slice(0,t)),new e(i.slice(t)))}}else r.push(a)}replace(t,r,o){if(!(o instanceof e))return super.replace(t,r,o);let a=n(this.text,n(o.text,s(this.text,0,t)),r),l=this.length+o.length-(r-t);return a.length<=32?new e(a,l):i.from(e.split(a,[]),l)}sliceString(t,e=this.length,i="\n"){let n="";for(let s=0,r=0;s<=e&&r<this.text.length;r++){let o=this.text[r],a=s+o.length;s>t&&r&&(n+=i),t<a&&e>s&&(n+=o.slice(Math.max(0,t-s),e-s)),s=a+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,i){let n=[],s=-1;for(let r of t)n.push(r),s+=r.length+1,32==n.length&&(i.push(new e(n,s)),n=[],s=-1);return s>-1&&i.push(new e(n,s)),i}}class i extends t{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let e of t)this.lines+=e.lines}lineInner(t,e,i,n){for(let s=0;;s++){let r=this.children[s],o=n+r.length,a=i+r.lines-1;if((e?a:o)>=t)return r.lineInner(t,e,i,n);n=o+1,i=a+1}}decompose(t,e,i,n){for(let s=0,r=0;r<=e&&s<this.children.length;s++){let o=this.children[s],a=r+o.length;if(t<=a&&e>=r){let s=n&((r<=t?1:0)|(a>=e?2:0));r>=t&&a<=e&&!s?i.push(o):o.decompose(t-r,e-r,i,s)}r=a+1}}replace(t,e,n){if(n.lines<this.lines)for(let s=0,r=0;s<this.children.length;s++){let o=this.children[s],a=r+o.length;if(t>=r&&e<=a){let l=o.replace(t-r,e-r,n),h=this.lines-o.lines+l.lines;if(l.lines<h>>4&&l.lines>h>>6){let r=this.children.slice();return r[s]=l,new i(r,this.length-(e-t)+n.length)}return super.replace(r,a,l)}r=a+1}return super.replace(t,e,n)}sliceString(t,e=this.length,i="\n"){let n="";for(let s=0,r=0;s<this.children.length&&r<=e;s++){let o=this.children[s],a=r+o.length;r>t&&s&&(n+=i),t<a&&e>r&&(n+=o.sliceString(t-r,e-r,i)),r=a+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof i))return 0;let n=0,[s,r,o,a]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;s+=e,r+=e){if(s==o||r==a)return n;let i=this.children[s],l=t.children[r];if(i!=l)return n+i.scanIdentical(l,e);n+=i.length+1}}static from(t,n=t.reduce(((t,e)=>t+e.length+1),-1)){let s=0;for(let e of t)s+=e.lines;if(s<32){let i=[];for(let e of t)e.flatten(i);return new e(i,n)}let r=Math.max(32,s>>5),o=r<<1,a=r>>1,l=[],h=0,c=-1,d=[];function u(t){let n;if(t.lines>o&&t instanceof i)for(let e of t.children)u(e);else t.lines>a&&(h>a||!h)?(f(),l.push(t)):t instanceof e&&h&&(n=d[d.length-1])instanceof e&&t.lines+n.lines<=32?(h+=t.lines,c+=t.length+1,d[d.length-1]=new e(n.text.concat(t.text),n.length+1+t.length)):(h+t.lines>r&&f(),h+=t.lines,c+=t.length+1,d.push(t))}function f(){0!=h&&(l.push(1==d.length?d[0]:i.from(d,c)),c=-1,h=d.length=0)}for(let e of t)u(e);return f(),1==l.length?l[0]:new i(l,n)}}function n(t,e,i=0,n=1e9){for(let s=0,r=0,o=!0;r<t.length&&s<=n;r++){let a=t[r],l=s+a.length;l>=i&&(l>n&&(a=a.slice(0,n-s)),s<i&&(a=a.slice(i-s)),o?(e[e.length-1]+=a,o=!1):e.push(a)),s=l+1}return e}function s(t,e,i){return n(t,[""],e,i)}t.empty=new e([""],0);class r{constructor(t,i=1){this.dir=i,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[i>0?1:(t instanceof e?t.text.length:t.children.length)<<1]}nextInner(t,i){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,s=this.nodes[n],r=this.offsets[n],o=r>>1,a=s instanceof e?s.text.length:s.children.length;if(o==(i>0?a:0)){if(0==n)return this.done=!0,this.value="",this;i>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(i>0?0:1)){if(this.offsets[n]+=i,0==t)return this.lineBreak=!0,this.value="\n",this;t--}else if(s instanceof e){let e=s.text[o+(i<0?-1:0)];if(this.offsets[n]+=i,e.length>Math.max(0,t))return this.value=0==t?e:i>0?e.slice(t):e.slice(0,e.length-t),this;t-=e.length}else{let r=s.children[o+(i<0?-1:0)];t>r.length?(t-=r.length,this.offsets[n]+=i):(i<0&&this.offsets[n]--,this.nodes.push(r),this.offsets.push(i>0?1:(r instanceof e?r.text.length:r.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class o{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new r(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class a{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(t.prototype[Symbol.iterator]=function(){return this.iter()},r.prototype[Symbol.iterator]=o.prototype[Symbol.iterator]=a.prototype[Symbol.iterator]=function(){return this});let l=class{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}},h="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((t=>t?parseInt(t,36):1));for(let t=1;t<h.length;t++)h[t]+=h[t-1];function c(t){for(let e=1;e<h.length;e+=2)if(h[e]>t)return h[e-1]<=t;return!1}function d(t){return t>=127462&&t<=127487}const u=8205;function f(t,e,i=!0,n=!0){return(i?p:O)(t,e,n)}function p(t,e,i){if(e==t.length)return e;e&&g(t.charCodeAt(e))&&m(t.charCodeAt(e-1))&&e--;let n=w(t,e);for(e+=v(n);e<t.length;){let s=w(t,e);if(n==u||s==u||i&&c(s))e+=v(s),n=s;else{if(!d(s))break;{let i=0,n=e-2;for(;n>=0&&d(w(t,n));)i++,n-=2;if(i%2==0)break;e+=2}}}return e}function O(t,e,i){for(;e>0;){let n=p(t,e-2,i);if(n<e)return n;e--}return 0}function g(t){return t>=56320&&t<57344}function m(t){return t>=55296&&t<56320}function w(t,e){let i=t.charCodeAt(e);if(!m(i)||e+1==t.length)return i;let n=t.charCodeAt(e+1);return g(n)?n-56320+(i-55296<<10)+65536:i}function b(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function v(t){return t<65536?1:2}const y=/\r\n?|\n/;var S=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(S||(S={}));class x{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let s=this.sections[e++],r=this.sections[e++];r<0?(t(i,n,s),n+=s):n+=r,i+=s}}iterChangedRanges(t,e=!1){P(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new x(t)}composeDesc(t){return this.empty?t:t.empty?this:_(this,t)}mapDesc(t,e=!1){return t.empty?this:C(this,t,e)}mapPos(t,e=-1,i=S.Simple){let n=0,s=0;for(let r=0;r<this.sections.length;){let o=this.sections[r++],a=this.sections[r++],l=n+o;if(a<0){if(l>t)return s+(t-n);s+=o}else{if(i!=S.Simple&&l>=t&&(i==S.TrackDel&&n<t&&l>t||i==S.TrackBefore&&n<t||i==S.TrackAfter&&l>t))return null;if(l>t||l==t&&e<0&&!o)return t==n||e<0?s:s+a;s+=a}n=l}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return s}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let s=n+this.sections[i++];if(this.sections[i++]>=0&&n<=e&&s>=t)return!(n<t&&s>e)||"cover";n=s}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some((t=>"number"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new x(t)}static create(t){return new x(t)}}class k extends x{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return P(this,((e,i,n,s,r)=>t=t.replace(n,n+(i-e),r)),!1),t}mapDesc(t,e=!1){return C(this,t,e,!0)}invert(e){let i=this.sections.slice(),n=[];for(let s=0,r=0;s<i.length;s+=2){let o=i[s],a=i[s+1];if(a>=0){i[s]=a,i[s+1]=o;let l=s>>1;for(;n.length<l;)n.push(t.empty);n.push(o?e.slice(r,r+o):t.empty)}r+=o}return new k(i,n)}compose(t){return this.empty?t:t.empty?this:_(this,t,!0)}map(t,e=!1){return t.empty?this:C(this,t,e,!0)}iterChanges(t,e=!1){P(this,t,e)}get desc(){return x.create(this.sections)}filter(t){let e=[],i=[],n=[],s=new X(this);t:for(let r=0,o=0;;){let a=r==t.length?1e9:t[r++];for(;o<a||o==a&&0==s.len;){if(s.done)break t;let t=Math.min(s.len,a-o);Q(n,t,-1);let r=-1==s.ins?-1:0==s.off?s.ins:0;Q(e,t,r),r>0&&$(i,e,s.text),s.forward(t),o+=t}let l=t[r++];for(;o<l;){if(s.done)break t;let t=Math.min(s.len,l-o);Q(e,t,-1),Q(n,t,-1==s.ins?-1:0==s.off?s.ins:0),s.forward(t),o+=t}}return{changes:new k(e,i),filtered:x.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):0==n?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(e,i,n){let s=[],r=[],o=0,a=null;function l(t=!1){if(!t&&!s.length)return;o<i&&Q(s,i-o,-1);let e=new k(s,r);a=a?a.compose(e.map(a)):e,s=[],r=[],o=0}return function e(h){if(Array.isArray(h))for(let t of h)e(t);else if(h instanceof k){if(h.length!=i)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${i})`);l(),a=a?a.compose(h.map(a)):h}else{let{from:e,to:a=e,insert:c}=h;if(e>a||e<0||a>i)throw new RangeError(`Invalid change range ${e} to ${a} (in doc of length ${i})`);let d=c?"string"==typeof c?t.of(c.split(n||y)):c:t.empty,u=d.length;if(e==a&&0==u)return;e<o&&l(),e>o&&Q(s,e-o,-1),Q(s,a-e,u),$(r,s,d),o=a}}(e),l(!a),a}static empty(t){return new k(t?[t,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let i=[],n=[];for(let s=0;s<e.length;s++){let r=e[s];if("number"==typeof r)i.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some(((t,e)=>e&&"string"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)i.push(r[0],0);else{for(;n.length<s;)n.push(t.empty);n[s]=t.of(r.slice(1)),i.push(r[0],n[s].length)}}}return new k(i,n)}static createSet(t,e){return new k(t,e)}}function Q(t,e,i,n=!1){if(0==e&&i<=0)return;let s=t.length-2;s>=0&&i<=0&&i==t[s+1]?t[s]+=e:0==e&&0==t[s]?t[s+1]+=i:n?(t[s]+=e,t[s+1]+=i):t.push(e,i)}function $(e,i,n){if(0==n.length)return;let s=i.length-2>>1;if(s<e.length)e[e.length-1]=e[e.length-1].append(n);else{for(;e.length<s;)e.push(t.empty);e.push(n)}}function P(e,i,n){let s=e.inserted;for(let r=0,o=0,a=0;a<e.sections.length;){let l=e.sections[a++],h=e.sections[a++];if(h<0)r+=l,o+=l;else{let c=r,d=o,u=t.empty;for(;c+=l,d+=h,h&&s&&(u=u.append(s[a-2>>1])),!(n||a==e.sections.length||e.sections[a+1]<0);)l=e.sections[a++],h=e.sections[a++];i(r,c,o,d,u),r=c,o=d}}}function C(t,e,i,n=!1){let s=[],r=n?[]:null,o=new X(t),a=new X(e);for(let t=-1;;)if(-1==o.ins&&-1==a.ins){let t=Math.min(o.len,a.len);Q(s,t,-1),o.forward(t),a.forward(t)}else if(a.ins>=0&&(o.ins<0||t==o.i||0==o.off&&(a.len<o.len||a.len==o.len&&!i))){let e=a.len;for(Q(s,a.ins,-1);e;){let i=Math.min(o.len,e);o.ins>=0&&t<o.i&&o.len<=i&&(Q(s,0,o.ins),r&&$(r,s,o.text),t=o.i),o.forward(i),e-=i}a.next()}else{if(!(o.ins>=0)){if(o.done&&a.done)return r?k.createSet(s,r):x.create(s);throw new Error("Mismatched change set lengths")}{let e=0,i=o.len;for(;i;)if(-1==a.ins){let t=Math.min(i,a.len);e+=t,i-=t,a.forward(t)}else{if(!(0==a.ins&&a.len<i))break;i-=a.len,a.next()}Q(s,e,t<o.i?o.ins:0),r&&t<o.i&&$(r,s,o.text),t=o.i,o.forward(o.len-i)}}}function _(t,e,i=!1){let n=[],s=i?[]:null,r=new X(t),o=new X(e);for(let t=!1;;){if(r.done&&o.done)return s?k.createSet(n,s):x.create(n);if(0==r.ins)Q(n,r.len,0,t),r.next();else if(0!=o.len||o.done){if(r.done||o.done)throw new Error("Mismatched change set lengths");{let e=Math.min(r.len2,o.len),i=n.length;if(-1==r.ins){let i=-1==o.ins?-1:o.off?0:o.ins;Q(n,e,i,t),s&&i&&$(s,n,o.text)}else-1==o.ins?(Q(n,r.off?0:r.len,e,t),s&&$(s,n,r.textBit(e))):(Q(n,r.off?0:r.len,o.off?0:o.ins,t),s&&!o.off&&$(s,n,o.text));t=(r.ins>e||o.ins>=0&&o.len>e)&&(t||n.length>i),r.forward2(e),o.forward(e)}}else Q(n,0,o.ins,t),s&&$(s,n,o.text),o.next()}}class X{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length?t.empty:e[i]}textBit(e){let{inserted:i}=this.set,n=this.i-2>>1;return n>=i.length&&!e?t.empty:i[n].slice(this.off,null==e?void 0:this.off+e)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){-1==this.ins?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class Z{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return 16&this.flags?this.to:this.from}get head(){return 16&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 4&this.flags?-1:8&this.flags?1:0}get bidiLevel(){let t=3&this.flags;return 3==t?null:t}get goalColumn(){let t=this.flags>>5;return 33554431==t?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new Z(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return A.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return A.range(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid JSON representation for SelectionRange");return A.range(t.anchor,t.head)}static create(t,e,i){return new Z(t,e,i)}}class A{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:A.create(this.ranges.map((i=>i.map(t,e))),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new A([this.main],0)}addRange(t,e=!0){return A.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,A.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((t=>t.toJSON())),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new A(t.ranges.map((t=>Z.fromJSON(t))),t.main)}static single(t,e=t){return new A([A.range(t,e)],0)}static create(t,e=0){if(0==t.length)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let s=t[n];if(s.empty?s.from<=i:s.from<i)return A.normalized(t.slice(),e);i=s.to}return new A(t,e)}static cursor(t,e=0,i,n){return Z.create(t,t,(0==e?0:e<0?4:8)|(null==i?3:Math.min(2,i))|(null!=n?n:33554431)<<5)}static range(t,e,i,n){let s=(null!=i?i:33554431)<<5|(null==n?3:Math.min(2,n));return e<t?Z.create(e,t,24|s):Z.create(t,e,(e>t?4:0)|s)}static normalized(t,e=0){let i=t[e];t.sort(((t,e)=>t.from-e.from)),e=t.indexOf(i);for(let i=1;i<t.length;i++){let n=t[i],s=t[i-1];if(n.empty?n.from<=s.to:n.from<s.to){let r=s.from,o=Math.max(n.to,s.to);i<=e&&e--,t.splice(--i,2,n.anchor>n.head?A.range(o,r):A.range(r,o))}}return new A(t,e)}}function T(t,e){for(let i of t.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let R=0;class E{constructor(t,e,i,n,s){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=R++,this.default=t([]),this.extensions="function"==typeof s?s(this):s}static define(t={}){return new E(t.combine||(t=>t),t.compareInput||((t,e)=>t===e),t.compare||(t.combine?(t,e)=>t===e:V),!!t.static,t.enables)}of(t){return new M([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new M(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new M(t,this,2,e)}from(t,e){return e||(e=t=>t),this.compute([t],(i=>e(i.field(t))))}}function V(t,e){return t==e||t.length==e.length&&t.every(((t,i)=>t===e[i]))}class M{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=R++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,s=this.id,r=t[s]>>1,o=2==this.type,a=!1,l=!1,h=[];for(let i of this.dependencies)"doc"==i?a=!0:"selection"==i?l=!0:0==(1&(null!==(e=t[i.id])&&void 0!==e?e:1))&&h.push(t[i.id]);return{create:t=>(t.values[r]=i(t),1),update(t,e){if(a&&e.docChanged||l&&(e.docChanged||e.selection)||W(t,h)){let e=i(t);if(o?!D(e,t.values[r],n):!n(e,t.values[r]))return t.values[r]=e,1}return 0},reconfigure:(t,e)=>{let a,l=e.config.address[s];if(null!=l){let s=tt(e,l);if(this.dependencies.every((i=>i instanceof E?e.facet(i)===t.facet(i):!(i instanceof q)||e.field(i,!1)==t.field(i,!1)))||(o?D(a=i(t),s,n):n(a=i(t),s)))return t.values[r]=s,0}else a=i(t);return t.values[r]=a,1}}}}function D(t,e,i){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}function W(t,e){let i=!1;for(let n of e)1&K(t,n)&&(i=!0);return i}function U(t,e,i){let n=i.map((e=>t[e.id])),s=i.map((t=>t.type)),r=n.filter((t=>!(1&t))),o=t[e.id]>>1;function a(t){let i=[];for(let e=0;e<n.length;e++){let r=tt(t,n[e]);if(2==s[e])for(let t of r)i.push(t);else i.push(r)}return e.combine(i)}return{create(t){for(let e of n)K(t,e);return t.values[o]=a(t),1},update(t,i){if(!W(t,r))return 0;let n=a(t);return e.compare(n,t.values[o])?0:(t.values[o]=n,1)},reconfigure(t,s){let r=W(t,n),l=s.config.facets[e.id],h=s.facet(e);if(l&&!r&&V(i,l))return t.values[o]=h,0;let c=a(t);return e.compare(c,h)?(t.values[o]=h,0):(t.values[o]=c,1)}}}const Y=E.define({static:!0});class q{constructor(t,e,i,n,s){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=s,this.provides=void 0}static define(t){let e=new q(R++,t.create,t.update,t.compare||((t,e)=>t===e),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(Y).find((t=>t.field==this));return((null==e?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:t=>(t.values[e]=this.create(t),1),update:(t,i)=>{let n=t.values[e],s=this.updateF(n,i);return this.compareF(n,s)?0:(t.values[e]=s,1)},reconfigure:(t,i)=>null!=i.config.address[this.id]?(t.values[e]=i.field(this),0):(t.values[e]=this.create(t),1)}}init(t){return[this,Y.of({field:this,create:t})]}get extension(){return this}}const L=4,z=3,I=2,B=1;function j(t){return e=>new G(e,t)}const N={highest:j(0),high:j(B),default:j(I),low:j(z),lowest:j(L)};class G{constructor(t,e){this.inner=t,this.prec=e}}class H{of(t){return new F(this,t)}reconfigure(t){return H.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class F{constructor(t,e){this.compartment=t,this.inner=e}}class J{constructor(t,e,i,n,s,r){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=s,this.facets=r,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return null==e?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],s=Object.create(null),r=new Map;for(let i of function(t,e,i){let n=[[],[],[],[],[]],s=new Map;function r(t,o){let a=s.get(t);if(null!=a){if(a<=o)return;let e=n[a].indexOf(t);e>-1&&n[a].splice(e,1),t instanceof F&&i.delete(t.compartment)}if(s.set(t,o),Array.isArray(t))for(let e of t)r(e,o);else if(t instanceof F){if(i.has(t.compartment))throw new RangeError("Duplicate use of compartment in extensions");let n=e.get(t.compartment)||t.inner;i.set(t.compartment,n),r(n,o)}else if(t instanceof G)r(t.inner,t.prec);else if(t instanceof q)n[o].push(t),t.provides&&r(t.provides,o);else if(t instanceof M)n[o].push(t),t.facet.extensions&&r(t.facet.extensions,I);else{let e=t.extension;if(!e)throw new Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(e,o)}}return r(t,I),n.reduce(((t,e)=>t.concat(e)))}(t,e,r))i instanceof q?n.push(i):(s[i.facet.id]||(s[i.facet.id]=[])).push(i);let o=Object.create(null),a=[],l=[];for(let t of n)o[t.id]=l.length<<1,l.push((e=>t.slot(e)));let h=null==i?void 0:i.config.facets;for(let t in s){let e=s[t],n=e[0].facet,r=h&&h[t]||[];if(e.every((t=>0==t.type)))if(o[n.id]=a.length<<1|1,V(r,e))a.push(i.facet(n));else{let t=n.combine(e.map((t=>t.value)));a.push(i&&n.compare(t,i.facet(n))?i.facet(n):t)}else{for(let t of e)0==t.type?(o[t.id]=a.length<<1|1,a.push(t.value)):(o[t.id]=l.length<<1,l.push((e=>t.dynamicSlot(e))));o[n.id]=l.length<<1,l.push((t=>U(t,n,e)))}}let c=l.map((t=>t(o)));return new J(t,r,c,o,a,s)}}function K(t,e){if(1&e)return 2;let i=e>>1,n=t.status[i];if(4==n)throw new Error("Cyclic dependency between fields and/or facets");if(2&n)return n;t.status[i]=4;let s=t.computeSlot(t,t.config.dynamicSlots[i]);return t.status[i]=2|s}function tt(t,e){return 1&e?t.config.staticValues[e>>1]:t.values[e>>1]}const et=E.define(),it=E.define({combine:t=>t.some((t=>t)),static:!0}),nt=E.define({combine:t=>t.length?t[0]:void 0,static:!0}),st=E.define(),rt=E.define(),ot=E.define(),at=E.define({combine:t=>!!t.length&&t[0]});class lt{constructor(t,e){this.type=t,this.value=e}static define(){return new ht}}class ht{of(t){return new lt(this,t)}}class ct{constructor(t){this.map=t}of(t){return new dt(this,t)}}class dt{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return void 0===e?void 0:e==this.value?this:new dt(this.type,e)}is(t){return this.type==t}static define(t={}){return new ct(t.map||(t=>t))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let t=n.map(e);t&&i.push(t)}return i}}dt.reconfigure=dt.define(),dt.appendConfig=dt.define();class ut{constructor(t,e,i,n,s,r){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=s,this.scrollIntoView=r,this._doc=null,this._state=null,i&&T(i,e.newLength),s.some((t=>t.type==ut.time))||(this.annotations=s.concat(ut.time.of(Date.now())))}static create(t,e,i,n,s,r){return new ut(t,e,i,n,s,r)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(ut.userEvent);return!(!e||!(e==t||e.length>t.length&&e.slice(0,t.length)==t&&"."==e[t.length]))}}function ft(t,e){let i=[];for(let n=0,s=0;;){let r,o;if(n<t.length&&(s==e.length||e[s]>=t[n]))r=t[n++],o=t[n++];else{if(!(s<e.length))return i;r=e[s++],o=e[s++]}!i.length||i[i.length-1]<r?i.push(r,o):i[i.length-1]<o&&(i[i.length-1]=o)}}function pt(t,e,i){var n;let s,r,o;return i?(s=e.changes,r=k.empty(e.changes.length),o=t.changes.compose(e.changes)):(s=e.changes.map(t.changes),r=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(s)),{changes:o,selection:e.selection?e.selection.map(r):null===(n=t.selection)||void 0===n?void 0:n.map(s),effects:dt.mapEffects(t.effects,s).concat(dt.mapEffects(e.effects,r)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function Ot(t,e,i){let n=e.selection,s=wt(e.annotations);return e.userEvent&&(s=s.concat(ut.userEvent.of(e.userEvent))),{changes:e.changes instanceof k?e.changes:k.of(e.changes||[],i,t.facet(nt)),selection:n&&(n instanceof A?n:A.single(n.anchor,n.head)),effects:wt(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function gt(t,e,i){let n=Ot(t,e.length?e[0]:{},t.doc.length);e.length&&!1===e[0].filter&&(i=!1);for(let s=1;s<e.length;s++){!1===e[s].filter&&(i=!1);let r=!!e[s].sequential;n=pt(n,Ot(t,e[s],r?n.changes.newLength:t.doc.length),r)}let s=ut.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return function(t){let e=t.startState,i=e.facet(ot),n=t;for(let s=i.length-1;s>=0;s--){let r=i[s](t);r&&Object.keys(r).length&&(n=pt(n,Ot(e,r,t.changes.newLength),!0))}return n==t?t:ut.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}(i?function(t){let e=t.startState,i=!0;for(let n of e.facet(st)){let e=n(t);if(!1===e){i=!1;break}Array.isArray(e)&&(i=!0===i?e:ft(i,e))}if(!0!==i){let n,s;if(!1===i)s=t.changes.invertedDesc,n=k.empty(e.doc.length);else{let e=t.changes.filter(i);n=e.changes,s=e.filtered.mapDesc(e.changes).invertedDesc}t=ut.create(e,n,t.selection&&t.selection.map(s),dt.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let n=e.facet(rt);for(let i=n.length-1;i>=0;i--){let s=n[i](t);t=s instanceof ut?s:Array.isArray(s)&&1==s.length&&s[0]instanceof ut?s[0]:gt(e,wt(s),!1)}return t}(s):s)}ut.time=lt.define(),ut.userEvent=lt.define(),ut.addToHistory=lt.define(),ut.remote=lt.define();const mt=[];function wt(t){return null==t?mt:Array.isArray(t)?t:[t]}var bt=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(bt||(bt={}));const vt=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let yt;try{yt=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}function St(t){return e=>{if(!/\S/.test(e))return bt.Space;if(function(t){if(yt)return yt.test(t);for(let e=0;e<t.length;e++){let i=t[e];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||vt.test(i)))return!0}return!1}(e))return bt.Word;for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return bt.Word;return bt.Other}}class xt{constructor(t,e,i,n,s,r){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=s,r&&(r._state=this);for(let t=0;t<this.config.dynamicSlots.length;t++)K(this,t<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(null!=i)return K(this,i),tt(this,i);if(e)throw new RangeError("Field is not present in this state")}update(...t){return gt(this,t,!0)}applyTransaction(t){let e,i=this.config,{base:n,compartments:s}=i;for(let e of t.effects)e.is(H.reconfigure)?(i&&(s=new Map,i.compartments.forEach(((t,e)=>s.set(e,t))),i=null),s.set(e.value.compartment,e.value.extension)):e.is(dt.reconfigure)?(i=null,n=e.value):e.is(dt.appendConfig)&&(i=null,n=wt(n).concat(e.value));if(i)e=t.startState.values.slice();else{i=J.resolve(n,s,this),e=new xt(i,this.doc,this.selection,i.dynamicSlots.map((()=>null)),((t,e)=>e.reconfigure(t,this)),null).values}new xt(i,t.newDoc,t.newSelection,e,((e,i)=>i.update(e,t)),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:t},range:A.cursor(e.from+t.length)})))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),s=[i.range],r=wt(i.effects);for(let i=1;i<e.ranges.length;i++){let o=t(e.ranges[i]),a=this.changes(o.changes),l=a.map(n);for(let t=0;t<i;t++)s[t]=s[t].map(l);let h=n.mapDesc(a,!0);s.push(o.range.map(h)),n=n.compose(l),r=dt.mapEffects(r,l).concat(dt.mapEffects(wt(o.effects),h))}return{changes:n,selection:A.create(s,e.mainIndex),effects:r}}changes(t=[]){return t instanceof k?t:k.of(t,this.doc.length,this.facet(xt.lineSeparator))}toText(e){return t.of(e.split(this.facet(xt.lineSeparator)||y))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return null==e?t.default:(K(this,e),tt(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof q&&null!=this.config.address[n.id]&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i)for(let e in i)if(Object.prototype.hasOwnProperty.call(t,e)){let s=i[e],r=t[e];n.push(s.init((t=>s.spec.fromJSON(r,t))))}return xt.create({doc:t.doc,selection:A.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(e={}){let i=J.resolve(e.extensions||[],new Map),n=e.doc instanceof t?e.doc:t.of((e.doc||"").split(i.staticFacet(xt.lineSeparator)||y)),s=e.selection?e.selection instanceof A?e.selection:A.single(e.selection.anchor,e.selection.head):A.single(0);return T(s,n.length),i.staticFacet(it)||(s=s.asSingle()),new xt(i,n,s,i.dynamicSlots.map((()=>null)),((t,e)=>e.create(t)),null)}get tabSize(){return this.facet(xt.tabSize)}get lineBreak(){return this.facet(xt.lineSeparator)||"\n"}get readOnly(){return this.facet(at)}phrase(t,...e){for(let e of this.facet(xt.phrases))if(Object.prototype.hasOwnProperty.call(e,t)){t=e[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,((t,i)=>{if("$"==i)return"$";let n=+(i||1);return!n||n>e.length?t:e[n-1]}))),t}languageDataAt(t,e,i=-1){let n=[];for(let s of this.facet(et))for(let r of s(this,e,i))Object.prototype.hasOwnProperty.call(r,t)&&n.push(r[t]);return n}charCategorizer(t){return St(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),s=this.charCategorizer(t),r=t-i,o=t-i;for(;r>0;){let t=f(e,r,!1);if(s(e.slice(t,r))!=bt.Word)break;r=t}for(;o<n;){let t=f(e,o);if(s(e.slice(o,t))!=bt.Word)break;o=t}return r==o?null:A.range(r+i,o+i)}}function kt(t,e,i={}){let n={};for(let e of t)for(let t of Object.keys(e)){let s=e[t],r=n[t];if(void 0===r)n[t]=s;else if(r===s||void 0===s);else{if(!Object.hasOwnProperty.call(i,t))throw new Error("Config merge conflict for field "+t);n[t]=i[t](r,s)}}for(let t in e)void 0===n[t]&&(n[t]=e[t]);return n}xt.allowMultipleSelections=it,xt.tabSize=E.define({combine:t=>t.length?t[0]:4}),xt.lineSeparator=nt,xt.readOnly=at,xt.phrases=E.define({compare(t,e){let i=Object.keys(t),n=Object.keys(e);return i.length==n.length&&i.every((i=>t[i]==e[i]))}}),xt.languageData=et,xt.changeFilter=st,xt.transactionFilter=rt,xt.transactionExtender=ot,H.reconfigure=dt.define();class Qt{eq(t){return this==t}range(t,e=t){return $t.create(t,e,this)}}Qt.prototype.startSide=Qt.prototype.endSide=0,Qt.prototype.point=!1,Qt.prototype.mapMode=S.TrackDel;let $t=class t{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(e,i,n){return new t(e,i,n)}};function Pt(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class Ct{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let s=i?this.to:this.from;for(let r=n,o=s.length;;){if(r==o)return r;let n=r+o>>1,a=s[n]-t||(i?this.value[n].endSide:this.value[n].startSide)-e;if(n==r)return a>=0?r:o;a>=0?o=n:r=n+1}}between(t,e,i,n){for(let s=this.findIndex(e,-1e9,!0),r=this.findIndex(i,1e9,!1,s);s<r;s++)if(!1===n(this.from[s]+t,this.to[s]+t,this.value[s]))return!1}map(t,e){let i=[],n=[],s=[],r=-1,o=-1;for(let a=0;a<this.value.length;a++){let l,h,c=this.value[a],d=this.from[a]+t,u=this.to[a]+t;if(d==u){let t=e.mapPos(d,c.startSide,c.mapMode);if(null==t)continue;if(l=h=t,c.startSide!=c.endSide&&(h=e.mapPos(d,c.endSide),h<l))continue}else if(l=e.mapPos(d,c.startSide),h=e.mapPos(u,c.endSide),l>h||l==h&&c.startSide>0&&c.endSide<=0)continue;(h-l||c.endSide-c.startSide)<0||(r<0&&(r=l),c.point&&(o=Math.max(o,h-l)),i.push(c),n.push(l-r),s.push(h-r))}return{mapped:i.length?new Ct(n,s,i,o):null,pos:r}}}class _t{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new _t(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:s=this.length}=t,r=t.filter;if(0==e.length&&!r)return this;if(i&&(e=e.slice().sort(Pt)),this.isEmpty)return e.length?_t.of(e):this;let o=new At(this,null,-1).goto(0),a=0,l=[],h=new Xt;for(;o.value||a<e.length;)if(a<e.length&&(o.from-e[a].from||o.startSide-e[a].value.startSide)>=0){let t=e[a++];h.addInner(t.from,t.to,t.value)||l.push(t)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(a==e.length||this.chunkEnd(o.chunkIndex)<e[a].from)&&(!r||n>this.chunkEnd(o.chunkIndex)||s<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!r||n>o.to||s<o.from||r(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||l.push($t.create(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!l.length?_t.empty:this.nextLayer.update({add:l,filter:r,filterFrom:n,filterTo:s}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let s=0;s<this.chunk.length;s++){let r=this.chunkPos[s],o=this.chunk[s],a=t.touchesRange(r,r+o.length);if(!1===a)n=Math.max(n,o.maxPoint),e.push(o),i.push(t.mapPos(r));else if(!0===a){let{mapped:s,pos:a}=o.map(r,t);s&&(n=Math.max(n,s.maxPoint),e.push(s),i.push(a))}}let s=this.nextLayer.map(t);return 0==e.length?s:new _t(i,e,s||_t.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let s=this.chunkPos[n],r=this.chunk[n];if(e>=s&&t<=s+r.length&&!1===r.between(s,t-s,e-s,i))return}this.nextLayer.between(t,e,i)}}iter(t=0){return Tt.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return Tt.from(t).goto(e)}static compare(t,e,i,n,s=-1){let r=t.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=s)),o=e.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=s)),a=Zt(r,o,i),l=new Et(r,a,s),h=new Et(o,a,s);i.iterGaps(((t,e,i)=>Vt(l,t,h,e,i,n))),i.empty&&0==i.length&&Vt(l,0,h,0,0,n)}static eq(t,e,i=0,n){null==n&&(n=999999999);let s=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0)),r=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0));if(s.length!=r.length)return!1;if(!s.length)return!0;let o=Zt(s,r),a=new Et(s,o,0).goto(i),l=new Et(r,o,0).goto(i);for(;;){if(a.to!=l.to||!Mt(a.active,l.active)||a.point&&(!l.point||!a.point.eq(l.point)))return!1;if(a.to>n)return!0;a.next(),l.next()}}static spans(t,e,i,n,s=-1){let r=new Et(t,null,s).goto(e),o=e,a=r.openStart;for(;;){let t=Math.min(r.to,i);if(r.point){let i=r.activeForPoint(r.to),s=r.pointFrom<e?i.length+1:Math.min(i.length,a);n.point(o,t,r.point,i,s,r.pointRank),a=Math.min(r.openEnd(t),i.length)}else t>o&&(n.span(o,t,r.active,a),a=r.openEnd(t));if(r.to>i)return a+(r.point&&r.to>i?1:0);o=r.to,r.next()}}static of(t,e=!1){let i=new Xt;for(let n of t instanceof $t?[t]:e?function(t){if(t.length>1)for(let e=t[0],i=1;i<t.length;i++){let n=t[i];if(Pt(e,n)>0)return t.slice().sort(Pt);e=n}return t}(t):t)i.add(n.from,n.to,n.value);return i.finish()}}_t.empty=new _t([],[],null,-1),_t.empty.nextLayer=_t.empty;class Xt{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(t){this.chunks.push(new Ct(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new Xt)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(_t.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return t;let e=_t.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function Zt(t,e,i){let n=new Map;for(let e of t)for(let t=0;t<e.chunk.length;t++)e.chunk[t].maxPoint<=0&&n.set(e.chunk[t],e.chunkPos[t]);let s=new Set;for(let t of e)for(let e=0;e<t.chunk.length;e++){let r=n.get(t.chunk[e]);null==r||(i?i.mapPos(r):r)!=t.chunkPos[e]||(null==i?void 0:i.touchesRange(r,r+t.chunk[e].length))||s.add(t.chunk[e])}return s}class At{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let e=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(e)||this.layer.chunkEnd(this.chunkIndex)<t||e.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Tt{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let s=0;s<t.length;s++)for(let r=t[s];!r.isEmpty;r=r.nextLayer)r.maxPoint>=i&&n.push(new At(r,e,i,s));return 1==n.length?n[0]:new Tt(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let t=this.heap.length>>1;t>=0;t--)Rt(this.heap,t);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let t=this.heap.length>>1;t>=0;t--)Rt(this.heap,t);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Rt(this.heap,0)}}}function Rt(t,e){for(let i=t[e];;){let n=1+(e<<1);if(n>=t.length)break;let s=t[n];if(n+1<t.length&&s.compare(t[n+1])>=0&&(s=t[n+1],n++),i.compare(s)<0)break;t[n]=i,t[e]=s,e=n}}class Et{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Tt.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){Dt(this.active,t),Dt(this.activeTo,t),Dt(this.activeRank,t),this.minActive=Ut(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:s}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=s;)e++;Wt(this.active,e,i),Wt(this.activeTo,e,n),Wt(this.activeRank,e,s),t&&Wt(t,e,this.cursor.from),this.minActive=Ut(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&Dt(i,n)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let t=this.cursor.value;if(t.point){if(!(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=t,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=t.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(i),this.cursor.next()}}}if(i){this.openStart=0;for(let e=i.length-1;e>=0&&i[e]<t;e--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function Vt(t,e,i,n,s,r){t.goto(e),i.goto(n);let o=n+s,a=n,l=n-e;for(;;){let e=t.to+l-i.to||t.endSide-i.endSide,n=e<0?t.to+l:i.to,s=Math.min(n,o);if(t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&Mt(t.activeForPoint(t.to+l),i.activeForPoint(i.to))||r.comparePoint(a,s,t.point,i.point):s>a&&!Mt(t.active,i.active)&&r.compareRange(a,s,t.active,i.active),n>o)break;a=n,e<=0&&t.next(),e>=0&&i.next()}}function Mt(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!=e[i]&&!t[i].eq(e[i]))return!1;return!0}function Dt(t,e){for(let i=e,n=t.length-1;i<n;i++)t[i]=t[i+1];t.pop()}function Wt(t,e,i){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=i}function Ut(t,e){let i=-1,n=1e9;for(let s=0;s<e.length;s++)(e[s]-n||t[s].endSide-t[i].endSide)<0&&(i=s,n=e[s]);return i}function Yt(t,e,i=t.length){let n=0;for(let s=0;s<i;)9==t.charCodeAt(s)?(n+=e-n%e,s++):(n++,s=f(t,s));return n}const qt="undefined"==typeof Symbol?"__ͼ":Symbol.for("ͼ"),Lt="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),zt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class It{constructor(t,e){this.rules=[];let{finish:i}=e||{};function n(t){return/^@/.test(t)?[t]:t.split(/,\s*/)}function s(t,e,r,o){let a=[],l=/^@(\w+)\b/.exec(t[0]),h=l&&"keyframes"==l[1];if(l&&null==e)return r.push(t[0]+";");for(let i in e){let o=e[i];if(/&/.test(i))s(i.split(/,\s*/).map((e=>t.map((t=>e.replace(/&/,t))))).reduce(((t,e)=>t.concat(e))),o,r);else if(o&&"object"==typeof o){if(!l)throw new RangeError("The value of a property ("+i+") should be a primitive value.");s(n(i),o,a,h)}else null!=o&&a.push(i.replace(/_.*/,"").replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()))+": "+o+";")}(a.length||h)&&r.push((!i||l||o?t:t.map(i)).join(", ")+" {"+a.join(" ")+"}")}for(let e in t)s(n(e),t[e],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let t=zt[qt]||1;return zt[qt]=t+1,"ͼ"+t.toString(36)}static mount(t,e){(t[Lt]||new jt(t)).mount(Array.isArray(e)?e:[e])}}let Bt=new Map;class jt{constructor(t){let e=t.ownerDocument||t,i=e.defaultView;if(!t.head&&t.adoptedStyleSheets&&i.CSSStyleSheet){let n=Bt.get(e);if(n)return t.adoptedStyleSheets=[n.sheet,...t.adoptedStyleSheets],t[Lt]=n;this.sheet=new i.CSSStyleSheet,t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets],Bt.set(e,this)}else{this.styleTag=e.createElement("style");let i=t.head||t;i.insertBefore(this.styleTag,i.firstChild)}this.modules=[],t[Lt]=this}mount(t){let e=this.sheet,i=0,n=0;for(let s=0;s<t.length;s++){let r=t[s],o=this.modules.indexOf(r);if(o<n&&o>-1&&(this.modules.splice(o,1),n--,o=-1),-1==o){if(this.modules.splice(n++,0,r),e)for(let t=0;t<r.rules.length;t++)e.insertRule(r.rules[t],i++)}else{for(;n<o;)i+=this.modules[n++].rules.length;i+=r.rules.length,n++}}if(!e){let t="";for(let e=0;e<this.modules.length;e++)t+=this.modules[e].getRules()+"\n";this.styleTag.textContent=t}}}for(var Nt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Gt={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ht="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),Ft="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Jt="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Kt=Ft||Ht&&+Ht[1]<57,te=0;te<10;te++)Nt[48+te]=Nt[96+te]=String(te);for(te=1;te<=24;te++)Nt[te+111]="F"+te;for(te=65;te<=90;te++)Nt[te]=String.fromCharCode(te+32),Gt[te]=String.fromCharCode(te);for(var ee in Nt)Gt.hasOwnProperty(ee)||(Gt[ee]=Nt[ee]);function ie(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function ne(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function se(t,e){if(!e.anchorNode)return!1;try{return ne(t,e.anchorNode)}catch(t){return!1}}function re(t){return 3==t.nodeType?me(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function oe(t,e,i,n){return!!i&&(le(t,e,i,n,-1)||le(t,e,i,n,1))}function ae(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function le(t,e,i,n,s){for(;;){if(t==i&&e==n)return!0;if(e==(s<0?0:he(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=ae(t)+(s<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(s<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=s<0?he(t):0}}}function he(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}const ce={left:0,right:0,top:0,bottom:0};function de(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function ue(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}class fe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){this.set(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let pe,Oe=null;function ge(t){if(t.setActive)return t.setActive();if(Oe)return t.focus(Oe);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==Oe?{get preventScroll(){return Oe={preventScroll:!0},!0}}:void 0),!Oe){Oe=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}function me(t,e,i=e){let n=pe||(pe=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function we(t,e,i){let n={key:e,code:e,keyCode:i,which:i,cancelable:!0},s=new KeyboardEvent("keydown",n);s.synthetic=!0,t.dispatchEvent(s);let r=new KeyboardEvent("keyup",n);return r.synthetic=!0,t.dispatchEvent(r),s.defaultPrevented||r.defaultPrevented}function be(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}class ve{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new ve(t.parentNode,ae(t),e)}static after(t,e){return new ve(t.parentNode,ae(t)+1,e)}}const ye=[];class Se{constructor(){this.parent=null,this.dom=null,this.dirty=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}coordsAt(t,e){return null}sync(t,e){if(2&this.dirty){let i,n=this.dom,s=null;for(let r of this.children){if(r.dirty){if(!r.dom&&(i=s?s.nextSibling:n.firstChild)){let t=Se.get(i);(!t||!t.parent&&t.canReuseDOM(r))&&r.reuseDOM(i)}r.sync(t,e),r.dirty=0}if(i=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&i!=r.dom&&(e.written=!0),r.dom.parentNode==n)for(;i&&i!=r.dom;)i=xe(i);else n.insertBefore(r.dom,i);s=r.dom}for(i=s?s.nextSibling:n.firstChild,i&&e&&e.node==n&&(e.written=!0);i;)i=xe(i)}else if(1&this.dirty)for(let i of this.children)i.dirty&&(i.sync(t,e),i.dirty=0)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==he(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Se.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,s=-1,r=-1,o=-1;for(let a=0,l=i,h=i;a<this.children.length;a++){let i=this.children[a],c=l+i.length;if(l<t&&c>e)return i.domBoundsAround(t,e,l);if(c>=t&&-1==n&&(n=a,s=l),l>e&&i.dom.parentNode==this.dom){r=a,o=h;break}h=c,l=c+i.breakAfter}return{from:s,to:o<0?i+this.length:o,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:r<this.children.length&&r>=0?this.children[r].dom:null}}markDirty(t=!1){this.dirty|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),1&e.dirty)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=ye){this.markDirty();for(let i=t;i<e;i++){let t=this.children[i];t.parent==this&&t.destroy()}this.children.splice(t,e-t,...i);for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new ke(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,s,r){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}}function xe(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}Se.prototype.breakAfter=0;class ke{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Qe(t,e,i,n,s,r,o,a,l){let{children:h}=t,c=h.length?h[e]:null,d=r.length?r[r.length-1]:null,u=d?d.breakAfter:o;if(!(e==n&&c&&!o&&!u&&r.length<2&&c.merge(i,s,r.length?d:null,0==i,a,l))){if(n<h.length){let t=h[n];t&&s<t.length?(e==n&&(t=t.split(s),s=0),!u&&d&&t.merge(0,s,d,!0,0,l)?r[r.length-1]=t:(s&&t.merge(0,s,null,!1,0,l),r.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:o=1),n++}for(c&&(c.breakAfter=o,i>0&&(!o&&r.length&&c.merge(i,c.length,r[0],!1,a,0)?c.breakAfter=r.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,a,0),e++));e<n&&r.length;)if(h[n-1].become(r[r.length-1]))n--,r.pop(),l=r.length?0:a;else{if(!h[e].become(r[0]))break;e++,r.shift(),a=r.length?0:l}!r.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,a,l)&&e--,(e<n||r.length)&&t.replaceChildren(e,n,r)}}function $e(t,e,i,n,s,r){let o=t.childCursor(),{i:a,off:l}=o.findPos(i,1),{i:h,off:c}=o.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,Qe(t,h,c,a,l,n,0,s,r)}let Pe="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Ce="undefined"!=typeof document?document:{documentElement:{style:{}}};const _e=/Edge\/(\d+)/.exec(Pe.userAgent),Xe=/MSIE \d/.test(Pe.userAgent),Ze=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Pe.userAgent),Ae=!!(Xe||Ze||_e),Te=!Ae&&/gecko\/(\d+)/i.test(Pe.userAgent),Re=!Ae&&/Chrome\/(\d+)/.exec(Pe.userAgent),Ee="webkitFontSmoothing"in Ce.documentElement.style,Ve=!Ae&&/Apple Computer/.test(Pe.vendor),Me=Ve&&(/Mobile\/\w+/.test(Pe.userAgent)||Pe.maxTouchPoints>2);var De={mac:Me||/Mac/.test(Pe.platform),windows:/Win/.test(Pe.platform),linux:/Linux|X11/.test(Pe.platform),ie:Ae,ie_version:Xe?Ce.documentMode||6:Ze?+Ze[1]:_e?+_e[1]:0,gecko:Te,gecko_version:Te?+(/Firefox\/(\d+)/.exec(Pe.userAgent)||[0,0])[1]:0,chrome:!!Re,chrome_version:Re?+Re[1]:0,ios:Me,android:/Android\b/.test(Pe.userAgent),webkit:Ee,safari:Ve,webkit_version:Ee?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=Ce.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class We extends Se{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return(!i||i instanceof We&&!(this.length-(e-t)+i.length>256))&&(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new We(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new ve(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return Ye(this.dom,t,e)}}class Ue extends Se{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(be(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.dirty|=6)}sync(t,e){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,s,r){return(!i||!(!(i instanceof Ue&&i.mark.eq(this.mark))||t&&s<=0||e<this.length&&r<=0))&&($e(this,t,e,i?i.children:[],s-1,r-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,s=0;for(let r of this.children){let o=i+r.length;o>t&&e.push(i<t?r.split(t-i):r),n<0&&i>=t&&(n=s),i=o,s++}let r=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new Ue(this.mark,e,r)}domAtPos(t){return Ge(this,t)}coordsAt(t,e){return Fe(this,t,e)}}function Ye(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let s=e,r=e,o=0;0==e&&i<0||e==n&&i>=0?De.chrome||De.gecko||(e?(s--,o=1):r<n&&(r++,o=-1)):i<0?s--:r<n&&r++;let a=me(t,s,r).getClientRects();if(!a.length)return ce;let l=a[(o?o<0:i>=0)?0:a.length-1];return De.safari&&!o&&0==l.width&&(l=Array.prototype.find.call(a,(t=>t.width))||l),o?de(l,o<0):l||null}class qe extends Se{constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}static create(t,e,i){return new(t.customView||qe)(t,e,i)}split(t){let e=qe.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,i,n,s,r){return!(i&&(!(i instanceof qe&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&r<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t instanceof qe&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return t.empty;let e=this;for(;e.parent;)e=e.parent;let{view:i}=e,n=i&&i.state.doc,s=this.posAtStart;return n?n.slice(s,s+this.length):t.empty}domAtPos(t){return(this.length?0==t:this.side>0)?ve.before(this.dom):ve.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.dom.getClientRects(),n=null;if(!i.length)return ce;for(let e=t>0?i.length-1:0;n=i[e],!(t>0?0==e:e==i.length-1||n.top<n.bottom);e+=t>0?-1:1);return this.length?n:de(n,this.side>0)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Le extends qe{domAtPos(t){let{topView:e,text:i}=this.widget;return e?ze(t,0,e,i,this.length-e.length,((t,e)=>t.domAtPos(e)),((t,e)=>new ve(t,Math.min(e,t.nodeValue.length)))):new ve(i,Math.min(t,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(t,e){let{topView:i,text:n}=this.widget;return i?Be(t,e,i,n,this.length-i.length):Math.min(e,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(t,e){let{topView:i,text:n}=this.widget;return i?ze(t,e,i,n,this.length-i.length,((t,e,i)=>t.coordsAt(e,i)),((t,e,i)=>Ye(t,e,i))):Ye(n,t,e)}destroy(){var t;super.destroy(),null===(t=this.widget.topView)||void 0===t||t.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}}function ze(t,e,i,n,s,r,o){if(i instanceof Ue){for(let a=i.dom.firstChild;a;a=a.nextSibling){let i=Se.get(a);if(i){let l=ne(a,n),h=i.length+(l?s:0);if(t<h||t==h&&i.getSide()<=0)return l?ze(t,e,i,n,s,r,o):r(i,t,e);t-=h}else{let i=Ie(t,e,a,o);if("number"!=typeof i)return i;t=i}}return r(i,i.length,-1)}return i.dom==n?o(n,t,e):r(i,t,e)}function Ie(t,e,i,n){if(3==i.nodeType){let s=i.nodeValue.length;if(t<=s)return n(i,t,e);t-=s}else if(1==i.nodeType&&"false"!=i.contentEditable)for(let s=i.firstChild;s;s=s.nextSibling){let i=Ie(t,e,s,n);if("number"!=typeof i)return i;t=i}return t}function Be(t,e,i,n,s){if(i instanceof Ue){let r=0;for(let o=i.dom.firstChild;o;o=o.nextSibling){let i=Se.get(o);if(i){let a=ne(o,n);if(ne(o,t))return r+(a?Be(t,e,i,n,s):i.localPosFromDOM(t,e));r+=i.length+(a?s:0)}else{let i=je(t,e,o);if(null!=i.result)return r+i.result;r+=i.size}}}else if(i.dom==n)return Math.min(e,n.nodeValue.length);return i.localPosFromDOM(t,e)}function je(t,e,i){if(3==i.nodeType)return t==i?{result:e}:{size:i.nodeValue.length};if(1!=i.nodeType||"false"==i.contentEditable)return i.contains(t)?{result:0}:{size:0};{let n=0;for(let s=i.firstChild,r=0;;s=s.nextSibling,r++){if(t==i&&r==e)return{result:n};if(!s)return{size:n};let o=je(t,e,s);if(null!=o.result)return{result:e+o.result};n+=o.size}}}class Ne extends Se{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Ne&&t.side==this.side}split(){return new Ne(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?ve.before(this.dom):ve.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){let e=this.dom.getBoundingClientRect(),i=function(t,e){let i=t.parent,n=i?i.children.indexOf(t):-1;for(;i&&n>=0;)if(e<0?n>0:n<i.children.length){let t=i.children[n+e];if(t instanceof We){let i=t.coordsAt(e<0?t.length:0,e);if(i)return i}n+=e}else{if(!(i instanceof Ue&&i.parent)){let t=i.dom.lastChild;if(t&&"BR"==t.nodeName)return t.getClientRects()[0];break}n=i.parent.children.indexOf(i)+(e<0?0:1),i=i.parent}return}(this,this.side>0?-1:1);return i&&i.top<e.bottom&&i.bottom>e.top?{left:e.left,right:e.right,top:i.top,bottom:i.bottom}:e}get overrideDOMText(){return t.empty}get isHidden(){return!0}}function Ge(t,e){let i=t.dom,{children:n}=t,s=0;for(let t=0;s<n.length;s++){let r=n[s],o=t+r.length;if(!(o==t&&r.getSide()<=0)){if(e>t&&e<o&&r.dom.parentNode==i)return r.domAtPos(e-t);if(e<=t)break;t=o}}for(let t=s;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=s;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new ve(i,0)}function He(t,e,i){let n,{children:s}=t;i>0&&e instanceof Ue&&s.length&&(n=s[s.length-1])instanceof Ue&&n.mark.eq(e.mark)?He(n,e.children[0],i-1):(s.push(e),e.setParent(t)),t.length+=e.length}function Fe(t,e,i){let n=null,s=-1,r=null,o=-1;!function t(e,a){for(let l=0,h=0;l<e.children.length&&h<=a;l++){let c=e.children[l],d=h+c.length;d>=a&&(c.children.length?t(c,a-h):(!r||r instanceof Ne&&i>0)&&(d>a||h==d&&c.getSide()>0)?(r=c,o=a-h):(h<a||h==d&&c.getSide()<0)&&(n=c,s=a-h)),h=d}}(t,e);let a=(i<0?n:r)||n||r;return a?a.coordsAt(Math.max(0,a==n?s:o),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=re(e);return i[i.length-1]||null}(t)}function Je(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}function Ke(t,e){if(t==e)return!0;if(!t||!e)return!1;let i=Object.keys(t),n=Object.keys(e);if(i.length!=n.length)return!1;for(let s of i)if(-1==n.indexOf(s)||t[s]!==e[s])return!1;return!0}function ti(t,e,i){let n=null;if(e)for(let s in e)i&&s in i||t.removeAttribute(n=s);if(i)for(let s in i)e&&e[s]==i[s]||t.setAttribute(n=s,i[s]);return!!n}We.prototype.children=qe.prototype.children=Ne.prototype.children=ye;class ei{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}ignoreEvent(t){return!0}get customView(){return null}get isHidden(){return!1}destroy(t){}}var ii=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(ii||(ii={}));class ni extends Qt{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new si(t)}static widget(t){let e=t.side||0,i=!!t.block;return e+=i?e>0?3e8:-4e8:e>0?1e8:-1e8,new oi(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:s,end:r}=ai(t,n);e=(s?n?-3e8:-1:5e8)-1,i=1+(r?n?2e8:1:-6e8)}return new oi(t,e,i,n,t.widget||null,!0)}static line(t){return new ri(t)}static set(t,e=!1){return _t.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}ni.none=_t.empty;class si extends ni{constructor(t){let{start:e,end:i}=ai(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){return this==t||t instanceof si&&this.tagName==t.tagName&&this.class==t.class&&Ke(this.attrs,t.attrs)}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}si.prototype.point=!1;class ri extends ni{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof ri&&this.spec.class==t.spec.class&&Ke(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}ri.prototype.mapMode=S.TrackBefore,ri.prototype.point=!0;class oi extends ni{constructor(t,e,i,n,s,r){super(e,i,s,t),this.block=n,this.isReplace=r,this.mapMode=n?e<=0?S.TrackBefore:S.TrackAfter:S.TrackDel}get type(){return this.startSide<this.endSide?ii.WidgetRange:this.startSide<=0?ii.WidgetBefore:ii.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(t){return t instanceof oi&&(e=this.widget,i=t.widget,e==i||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function ai(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function li(t,e,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=t?i[s]=Math.max(i[s],e):i.push(t,e)}oi.prototype.point=!0;class hi extends Se{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,s,r){if(i){if(!(i instanceof hi))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),$e(this,t,e,i?i.children:[],s,r),!0}split(t){let e=new hi;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Ke(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){He(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=Je(e,this.attrs||{})),i&&(this.attrs=Je({class:i},this.attrs||{}))}domAtPos(t){return Ge(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.dirty|=6)}sync(t,e){var i;this.dom?4&this.dirty&&(be(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(ti(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&Se.get(n)instanceof Ue;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(i=Se.get(n))||void 0===i?void 0:i.isEditable)||De.ios&&this.children.some((t=>t instanceof We))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let i of this.children){if(!(i instanceof We)||/[^ -~]/.test(i.text))return null;let n=re(i.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let i=Fe(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return!1}get type(){return ii.Text}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let s=t.children[i],r=n+s.length;if(r>=e){if(s instanceof hi)return s;if(r>e)break}n=r+s.breakAfter}return null}}class ci extends Se{constructor(t,e,i){super(),this.widget=t,this.length=e,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,s,r){return!(i&&(!(i instanceof ci&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&r<=0))&&(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return 0==t?ve.before(this.dom):ve.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new ci(this.widget,e,this.type);return i.breakAfter=this.breakAfter,i}get children(){return ye}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):t.empty}domBoundsAround(){return null}become(t){return t instanceof ci&&t.type==this.type&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class di{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof ci&&t.type==ii.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new hi),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(ui(new Ne(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(ui(new We(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,s,r){if(this.disallowBlockEffectsFor[r]&&i instanceof oi){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=e-t;if(i instanceof oi)if(i.block){let{type:t}=i;t!=ii.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new ci(i.widget||new fi("div"),o,t))}else{let r=qe.create(i.widget||new fi("span"),o,o?0:i.startSide),a=this.atCursorPos&&!r.isEditable&&s<=n.length&&(t<e||i.startSide>0),l=!r.isEditable&&(t<e||s>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||a||r.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),a&&(h.append(ui(new Ne(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(ui(r,n),s),this.atCursorPos=l,this.pendingBuffer=l?t<e||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=s)}static build(t,e,i,n,s){let r=new di(t,e,i,s);return r.openEnd=_t.spans(n,e,i,r),r.openStart<0&&(r.openStart=r.openEnd),r.finish(r.openEnd),r}}function ui(t,e){for(let i of e)t=new Ue(i,[t],t.length);return t}class fi extends ei{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const pi=E.define(),Oi=E.define(),gi=E.define(),mi=E.define(),wi=E.define(),bi=E.define(),vi=E.define(),yi=E.define({combine:t=>t.some((t=>t))}),Si=E.define({combine:t=>t.some((t=>t))});class xi{constructor(t,e="nearest",i="nearest",n=5,s=5){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=s}map(t){return t.empty?this:new xi(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}}const ki=dt.define({map:(t,e)=>t.map(e)});function Qi(t,e,i){let n=t.facet(mi);n.length?n[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const $i=E.define({combine:t=>!t.length||t[0]});let Pi=0;const Ci=E.define();class _i{constructor(t,e,i,n){this.id=t,this.create=e,this.domEventHandlers=i,this.extension=n(this)}static define(t,e){const{eventHandlers:i,provide:n,decorations:s}=e||{};return new _i(Pi++,t,i,(t=>{let e=[Ci.of(t)];return s&&e.push(Ti.of((e=>{let i=e.plugin(t);return i?s(i):ni.none}))),n&&e.push(n(t)),e}))}static fromClass(t,e){return _i.define((e=>new t(e)),e)}}class Xi{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(Qi(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){Qi(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){Qi(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Zi=E.define(),Ai=E.define(),Ti=E.define(),Ri=E.define(),Ei=E.define(),Vi=E.define();class Mi{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new Mi(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,s=0,r=0,o=0;;n++){let a=n==t.length?null:t[n],l=r-o,h=a?a.fromB:1e9;for(;s<e.length&&e[s]<h;){let t=e[s],n=e[s+1],r=Math.max(o,t),a=Math.min(h,n);if(r<=a&&new Mi(r+l,a+l,r,a).addToSet(i),n>h)break;s+=2}if(!a)return i;new Mi(a.fromA,a.toA,a.fromB,a.toB).addToSet(i),r=a.toA,o=a.toB}}}class Di{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=k.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,s)=>n.push(new Mi(t,e,i,s)))),this.changedRanges=n}static create(t,e,i){return new Di(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}var Wi=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(Wi||(Wi={}));const Ui=Wi.LTR,Yi=Wi.RTL;function qi(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const Li=qi("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),zi=qi("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Ii=Object.create(null),Bi=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);Ii[e]=i,Ii[i]=-e}const ji=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ni{constructor(t,e,i){this.from=t,this.to=e,this.level=i}get dir(){return this.level%2?Yi:Ui}side(t,e){return this.dir==e==t?this.to:this.from}static find(t,e,i,n){let s=-1;for(let r=0;r<t.length;r++){let o=t[r];if(o.from<=e&&o.to>=e){if(o.level==i)return r;(s<0||(0!=n?n<0?o.from<e:o.to>e:t[s].level>o.level))&&(s=r)}}if(s<0)throw new RangeError("Index out of range");return s}}const Gi=[];function Hi(t){return[new Ni(0,t,0)]}let Fi="";function Ji(t,e,i,n,s){var r;let o=n.head-t.from,a=-1;if(0==o){if(!s||!t.length)return null;e[0].level!=i&&(o=e[0].side(!1,i),a=0)}else if(o==t.length){if(s)return null;let t=e[e.length-1];t.level!=i&&(o=t.side(!0,i),a=e.length-1)}a<0&&(a=Ni.find(e,o,null!==(r=n.bidiLevel)&&void 0!==r?r:-1,n.assoc));let l=e[a];o==l.side(s,i)&&(l=e[a+=s?1:-1],o=l.side(!s,i));let h=s==(l.dir==i),c=f(t.text,o,h);if(Fi=t.text.slice(Math.min(o,c),Math.max(o,c)),c!=l.side(s,i))return A.cursor(c+t.from,h?-1:1,l.level);let d=a==(s?e.length-1:0)?null:e[a+(s?1:-1)];return d||l.level==i?d&&d.level<l.level?A.cursor(d.side(!s,i)+t.from,s?1:-1,d.level):A.cursor(c+t.from,s?-1:1,l.level):A.cursor(s?t.to:t.from,s?-1:1,i)}const Ki="￿";class tn{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(xt.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Ki}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n),this.readNode(n);let t=n.nextSibling;if(t==e)break;let s=Se.get(n),r=Se.get(t);(s&&r?s.breakAfter:(s?s.breakAfter:en(n))||en(t)&&("BR"!=n.nodeName||n.cmIgnore))&&this.lineBreak(),n=t}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s,r=-1,o=1;if(this.lineSeparator?(r=e.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(s=n.exec(e))&&(r=s.index,o=s[0].length),this.append(e.slice(i,r<0?e.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=o-1);i=r+o}}readNode(t){if(t.cmIgnore)return;let e=Se.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+Math.min(e,i.offset))}}function en(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}class nn{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class sn extends Se{constructor(t){super(),this.view=t,this.compositionDeco=ni.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new hi],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Mi(0,0,0,t.state.doc.length)],0)}get length(){return this.view.state.doc.length}update(t){let e=t.changedRanges;this.minWidth>0&&e.length&&(e.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=ni.none:(t.transactions.length||this.dirty)&&(this.compositionDeco=function(t,e){let i=on(t);if(!i)return ni.none;let{from:n,to:s,node:r,text:o}=i,a=e.mapPos(n,1),l=Math.max(a,e.mapPos(s,-1)),{state:h}=t,c=3==r.nodeType?r.nodeValue:new tn([],h).readRange(r.firstChild,null).text;if(l-a<c.length)if(h.doc.sliceString(a,Math.min(h.doc.length,a+c.length),Ki)==c)l=a+c.length;else{if(h.doc.sliceString(Math.max(0,l-c.length),l,Ki)!=c)return ni.none;a=l-c.length}else if(h.doc.sliceString(a,l,Ki)!=c)return ni.none;let d=Se.get(r);d instanceof Le?d=d.widget.topView:d&&(d.parent=null);return ni.set(ni.replace({widget:new an(r,o,d),inclusive:!0}).range(a,l))}(this.view,t.changes)),(De.ie||De.chrome)&&!this.compositionDeco.size&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let i=function(t,e,i){let n=new hn;return _t.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return e=Mi.extendWithRanges(e,i),(0!=this.dirty||0!=e.length)&&(this.updateInner(e,t.startState.doc.length),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e);let{observer:i}=this.view;i.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=De.chrome||De.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.dirty=0,t&&(t.written||i.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""}));let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof ci&&t.widget instanceof rn&&n.push(t.dom);i.updateGaps(n)}updateChildren(t,e){let i=this.childCursor(e);for(let e=t.length-1;;e--){let n=e>=0?t[e]:null;if(!n)break;let{fromA:s,toA:r,fromB:o,toB:a}=n,{content:l,breakAtStart:h,openStart:c,openEnd:d}=di.build(this.view.state.doc,o,a,this.decorations,this.dynamicDecorationMap),{i:u,off:f}=i.findPos(r,1),{i:p,off:O}=i.findPos(s,-1);Qe(this,p,O,u,f,l,h,c,d)}}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&se(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||s))return;let r=this.forceSelection;this.forceSelection=!1;let o=this.view.state.selection.main,a=this.domAtPos(o.anchor),l=o.empty?a:this.domAtPos(o.head);if(De.gecko&&o.empty&&!this.compositionDeco.size&&(1==(h=a).node.nodeType&&h.node.firstChild&&(0==h.offset||"false"==h.node.childNodes[h.offset-1].contentEditable)&&(h.offset==h.node.childNodes.length||"false"==h.node.childNodes[h.offset].contentEditable))){let t=document.createTextNode("");this.view.observer.ignore((()=>a.node.insertBefore(t,a.node.childNodes[a.offset]||null))),a=l=new ve(t,0),r=!0}var h;let c=this.view.observer.selectionRange;!r&&c.focusNode&&oe(a.node,a.offset,c.anchorNode,c.anchorOffset)&&oe(l.node,l.offset,c.focusNode,c.focusOffset)||(this.view.observer.ignore((()=>{De.android&&De.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=ie(this.view.root);if(t)if(o.empty){if(De.gecko){let t=(e=a.node,n=a.offset,1!=e.nodeType?0:(n&&"false"==e.childNodes[n-1].contentEditable?1:0)|(n<e.childNodes.length&&"false"==e.childNodes[n].contentEditable?2:0));if(t&&3!=t){let e=ln(a.node,a.offset,1==t?1:-1);e&&(a=new ve(e,1==t?0:e.nodeValue.length))}}t.collapse(a.node,a.offset),null!=o.bidiLevel&&null!=c.cursorBidiLevel&&(c.cursorBidiLevel=o.bidiLevel)}else if(t.extend){t.collapse(a.node,a.offset);try{t.extend(l.node,l.offset)}catch(t){}}else{let e=document.createRange();o.anchor>o.head&&([a,l]=[l,a]),e.setEnd(l.node,l.offset),e.setStart(a.node,a.offset),t.removeAllRanges(),t.addRange(e)}else;var e,n;s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())})),this.view.observer.setSelectionRange(a,l)),this.impreciseAnchor=a.precise?null:new ve(c.anchorNode,c.anchorOffset),this.impreciseHead=l.precise?null:new ve(c.focusNode,c.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let{view:t}=this,e=t.state.selection.main,i=ie(t.root),{anchorNode:n,anchorOffset:s}=t.observer.selectionRange;if(!(i&&e.empty&&e.assoc&&i.modify))return;let r=hi.find(this,e.head);if(!r)return;let o=r.posAtStart;if(e.head==o||e.head==o+r.length)return;let a=this.coordsAt(e.head,-1),l=this.coordsAt(e.head,1);if(!a||!l||a.bottom>l.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,s)}nearest(t){for(let e=t;e;){let t=Se.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof hi)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){for(let i=this.length,n=this.children.length-1;;n--){let s=this.children[n],r=i-s.breakAfter-s.length;if(t>r||t==r&&s.type!=ii.WidgetBefore&&s.type!=ii.WidgetAfter&&(!n||2==e||this.children[n-1].breakAfter||this.children[n-1].type==ii.WidgetBefore&&e>-2))return s.coordsAt(t-r,e);i=r}}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,s=this.view.contentDOM.clientWidth,r=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,a=this.view.textDirection==Wi.LTR;for(let t=0,l=0;l<this.children.length;l++){let h=this.children[l],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),r){let e=h.dom.lastChild,n=e?re(e):[];if(n.length){let e=n[n.length-1],r=a?e.right-i.left:i.right-e.left;r>o&&(o=r,this.minWidth=s,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?Wi.RTL:Wi.LTR}measureTextSize(){for(let t of this.children)if(t instanceof hi){let e=t.measureTextSize();if(e)return e}let t,e,i,n=document.createElement("div");return n.className="cm-line",n.style.width="99999px",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let s=re(n.firstChild)[0];t=n.getBoundingClientRect().height,e=s?s.width/27:7,i=s?s.height:t,n.remove()})),{lineHeight:t,charWidth:e,textHeight:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new ke(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let s=n==e.viewports.length?null:e.viewports[n],r=s?s.from-1:this.length;if(r>i){let n=e.lineBlockAt(r).bottom-e.lineBlockAt(i).top;t.push(ni.replace({widget:new rn(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,r))}if(!s)break;i=s.to+1}return ni.set(t)}updateDeco(){let t=this.view.state.facet(Ti).map(((t,e)=>(this.dynamicDecorationMap[e]="function"==typeof t)?t(this.view):t));for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let s=0,r=0,o=0,a=0;for(let t of this.view.state.facet(Ei).map((t=>t(this.view))))if(t){let{left:e,right:i,top:n,bottom:l}=t;null!=e&&(s=Math.max(s,e)),null!=i&&(r=Math.max(r,i)),null!=n&&(o=Math.max(o,n)),null!=l&&(a=Math.max(a,l))}let l={left:n.left-s,top:n.top-o,right:n.right+r,bottom:n.bottom+a};!function(t,e,i,n,s,r,o,a){let l=t.ownerDocument,h=l.defaultView||window;for(let c=t;c;)if(1==c.nodeType){let t,d=c==l.body;if(d)t=ue(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();t={left:e.left,right:e.left+c.clientWidth,top:e.top,bottom:e.top+c.clientHeight}}let u=0,f=0;if("nearest"==s)e.top<t.top?(f=-(t.top-e.top+o),i>0&&e.bottom>t.bottom+f&&(f=e.bottom-t.bottom+f+o)):e.bottom>t.bottom&&(f=e.bottom-t.bottom+o,i<0&&e.top-f<t.top&&(f=-(t.top+f-e.top+o)));else{let n=e.bottom-e.top,r=t.bottom-t.top;f=("center"==s&&n<=r?e.top+n/2-r/2:"start"==s||"center"==s&&i<0?e.top-o:e.bottom-r+o)-t.top}if("nearest"==n?e.left<t.left?(u=-(t.left-e.left+r),i>0&&e.right>t.right+u&&(u=e.right-t.right+u+r)):e.right>t.right&&(u=e.right-t.right+r,i<0&&e.left<t.left+u&&(u=-(t.left+u-e.left+r))):u=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==a?e.left-r:e.right-(t.right-t.left)+r)-t.left,u||f)if(d)h.scrollBy(u,f);else{let t=0,i=0;if(f){let t=c.scrollTop;c.scrollTop+=f,i=c.scrollTop-t}if(u){let e=c.scrollLeft;c.scrollLeft+=u,t=c.scrollLeft-e}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&Math.abs(t-u)<1&&(n="nearest"),i&&Math.abs(i-f)<1&&(s="nearest")}if(d)break;c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,l,i.head<i.anchor?-1:1,t.x,t.y,t.xMargin,t.yMargin,this.view.textDirection==Wi.LTR)}}class rn extends ei{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function on(t){let e=t.observer.selectionRange,i=e.focusNode&&ln(e.focusNode,e.focusOffset,0);if(!i)return null;let n=t.docView.nearest(i);if(!n)return null;if(n instanceof hi){let t=i;for(;t.parentNode!=n.dom;)t=t.parentNode;let e=t.previousSibling;for(;e&&!Se.get(e);)e=e.previousSibling;let s=e?Se.get(e).posAtEnd:n.posAtStart;return{from:s,to:s,node:t,text:i}}{for(;;){let{parent:t}=n;if(!t)return null;if(t instanceof hi)break;n=t}let t=n.posAtStart;return{from:t,to:t+n.length,node:n.dom,text:i}}}class an extends ei{constructor(t,e,i){super(),this.top=t,this.text=e,this.topView=i}eq(t){return this.top==t.top&&this.text==t.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return Le}}function ln(t,e,i){if(i<=0)for(let i=t,n=e;;){if(3==i.nodeType)return i;if(!(1==i.nodeType&&n>0))break;i=i.childNodes[n-1],n=he(i)}if(i>=0)for(let n=t,s=e;;){if(3==n.nodeType)return n;if(!(1==n.nodeType&&s<n.childNodes.length&&i>=0))break;n=n.childNodes[s],s=0}return null}class hn{constructor(){this.changes=[]}compareRange(t,e){li(t,e,this.changes)}comparePoint(t,e){li(t,e,this.changes)}}function cn(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function dn(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function un(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function fn(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function pn(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function On(t,e,i){let n,s,r,o,a,l,h,c,d=!1;for(let u=t.firstChild;u;u=u.nextSibling){let t=re(u);for(let f=0;f<t.length;f++){let p=t[f];s&&un(s,p)&&(p=fn(pn(p,s.bottom),s.top));let O=cn(e,p),g=dn(i,p);if(0==O&&0==g)return 3==u.nodeType?gn(u,e,i):On(u,e,i);if(!n||o>g||o==g&&r>O){n=u,s=p,r=O,o=g;let a=g?i<p.top?-1:1:O?e<p.left?-1:1:0;d=!a||(a>0?f<t.length-1:f>0)}0==O?i>p.bottom&&(!h||h.bottom<p.bottom)?(a=u,h=p):i<p.top&&(!c||c.top>p.top)&&(l=u,c=p):h&&un(h,p)?h=pn(h,p.bottom):c&&un(c,p)&&(c=fn(c,p.top))}}if(h&&h.bottom>=i?(n=a,s=h):c&&c.top<=i&&(n=l,s=c),!n)return{node:t,offset:0};let u=Math.max(s.left,Math.min(s.right,e));return 3==n.nodeType?gn(n,u,i):d&&"false"!=n.contentEditable?On(n,u,i):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0)}}function gn(t,e,i){let n=t.nodeValue.length,s=-1,r=1e9,o=0;for(let a=0;a<n;a++){let n=me(t,a,a+1).getClientRects();for(let l=0;l<n.length;l++){let h=n[l];if(h.top==h.bottom)continue;o||(o=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<r){let i=e>=(h.left+h.right)/2,n=i;if(De.chrome||De.gecko){me(t,a).getBoundingClientRect().left==h.right&&(n=!i)}if(c<=0)return{node:t,offset:a+(n?1:0)};s=a+(n?1:0),r=c}}}return{node:t,offset:s>-1?s:o>0?t.nodeValue.length:0}}function mn(t,e,i,n=-1){var s,r;let o,a=t.contentDOM.getBoundingClientRect(),l=a.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-l;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.defaultLineHeight/2,s=!1;o=t.elementAtHeight(u),o.type!=ii.Text;)for(;u=n>0?o.bottom+e:o.top-e,!(u>=0&&u<=h);){if(s)return i?null:0;s=!0,n=-n}d=l+u;let f=o.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:wn(t,a,o,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:wn(t,a,o,c,d);let p=t.dom.ownerDocument,O=t.root.elementFromPoint?t.root:p,g=O.elementFromPoint(c,d);g&&!t.contentDOM.contains(g)&&(g=null),g||(c=Math.max(a.left+1,Math.min(a.right-1,c)),g=O.elementFromPoint(c,d),g&&!t.contentDOM.contains(g)&&(g=null));let m,w=-1;if(g&&0!=(null===(s=t.docView.nearest(g))||void 0===s?void 0:s.isEditable))if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:m,offset:w}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&(({startContainer:m,startOffset:w}=e),(!t.contentDOM.contains(m)||De.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return me(t,n-1,n).getBoundingClientRect().left>i}(m,w,c)||De.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}let n=1==t.nodeType?t.getBoundingClientRect():me(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return i-n.left>5}(m,w,c))&&(m=void 0))}if(!m||!t.docView.dom.contains(m)){let e=hi.find(t.docView,f);if(!e)return u>o.top+o.height/2?o.to:o.from;({node:m,offset:w}=On(e.dom,c,d))}let b=t.docView.nearest(m);if(!b)return null;if(b.isWidget&&1==(null===(r=b.dom)||void 0===r?void 0:r.nodeType)){let t=b.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?b.posAtStart:b.posAtEnd}return b.localPosFromDOM(m,w)+b.posAtStart}function wn(t,e,i,n,s){let r=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){r+=Math.floor((s-i.top)/t.defaultLineHeight)*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(i.from,i.to);return i.from+function(t,e,i,n){for(let n=0,s=0;;){if(s>=e)return n;if(n==t.length)break;s+=9==t.charCodeAt(n)?i-s%i:1,n=f(t,n)}return!0===n?-1:t.length}(o,r,t.state.tabSize)}function bn(t,e,i,n){let s=t.state.doc.lineAt(e.head),r=t.bidiSpans(s),o=t.textDirectionAt(s.from);for(let a=e,l=null;;){let e=Ji(s,r,o,a,i),h=Fi;if(!e){if(s.number==(i?t.state.doc.lines:1))return a;h="\n",s=t.state.doc.line(s.number+(i?1:-1)),r=t.bidiSpans(s),e=A.cursor(i?s.from:s.to)}if(l){if(!l(h))return a}else{if(!n)return e;l=n(h)}a=e}}function vn(t,e,i,n){let s=t.state.facet(Ri).map((e=>e(t)));for(;;){let t=!1;for(let r of s)r.between(i.from-1,i.from+1,((s,r,o)=>{i.from>s&&i.from<r&&(i=e.head>i.from?A.cursor(s,1):A.cursor(r,-1),t=!0,o.widget.skipPosition&&(i=o.widget.skipPosition(i,e,n)))}));if(!t)return i}}class yn{constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;let e=(e,i)=>{this.ignoreDuringComposition(i)||"keydown"==i.type&&this.keydown(t,i)||(this.mustFlushObserver(i)&&t.observer.forceFlush(),this.runCustomHandlers(i.type,t,i)?i.preventDefault():e(t,i))};for(let i in Cn){let n=Cn[i];t.contentDOM.addEventListener(i,(i=>{Pn(t,i)&&e(n,i)}),_n[i]),this.registeredEvents.push(i)}t.scrollDOM.addEventListener("mousedown",(i=>{if(i.target==t.scrollDOM&&i.clientY>t.contentDOM.getBoundingClientRect().bottom&&(e(Cn.mousedown,i),!i.defaultPrevented&&2==i.button)){let e=t.contentDOM.style.minHeight;t.contentDOM.style.minHeight="100%",setTimeout((()=>t.contentDOM.style.minHeight=e),200)}})),De.chrome&&102==De.chrome_version&&t.scrollDOM.addEventListener("wheel",(()=>{this.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout((()=>{this.chromeScrollHack=-1,t.contentDOM.style.pointerEvents=""}),100)}),{passive:!0}),this.notifiedFocused=t.hasFocus,De.safari&&t.contentDOM.addEventListener("input",(()=>null))}setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}ensureHandlers(t,e){var i;let n;this.customHandlers=[];for(let s of e)if(n=null===(i=s.update(t).spec)||void 0===i?void 0:i.domEventHandlers){this.customHandlers.push({plugin:s.value,handlers:n});for(let e in n)this.registeredEvents.indexOf(e)<0&&"scroll"!=e&&(this.registeredEvents.push(e),t.contentDOM.addEventListener(e,(i=>{Pn(t,i)&&this.runCustomHandlers(e,t,i)&&i.preventDefault()})))}}runCustomHandlers(t,e,i){for(let n of this.customHandlers){let s=n.handlers[t];if(s)try{if(s.call(n.plugin,i,e)||i.defaultPrevented)return!0}catch(t){Qi(e.state,t)}}return!1}runScrollHandlers(t,e){this.lastScrollTop=t.scrollDOM.scrollTop,this.lastScrollLeft=t.scrollDOM.scrollLeft;for(let i of this.customHandlers){let n=i.handlers.scroll;if(n)try{n.call(i.plugin,e,t)}catch(e){Qi(t.state,e)}}}keydown(t,e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(27!=e.keyCode&&kn.indexOf(e.keyCode)<0&&(t.inputState.lastEscPress=0),De.android&&De.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return t.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return!(!De.ios||e.synthetic||e.altKey||e.metaKey||!((i=Sn.find((t=>t.keyCode==e.keyCode)))&&!e.ctrlKey||xn.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey))&&(this.pendingIOSKey=i||e,setTimeout((()=>this.flushIOSKey(t)),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&(this.pendingIOSKey=void 0,we(t.contentDOM,e.key,e.keyCode))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(De.safari&&!De.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}mustFlushObserver(t){return"keydown"==t.type&&229!=t.keyCode}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const Sn=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],xn="dthko",kn=[16,17,18,20,91,92,224,225];function Qn(t){return.7*Math.max(0,t)+8}class $n{constructor(t,e,i,n){this.view=t,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParent=function(t){let e=t.ownerDocument;for(let i=t.parentNode;i&&i!=e.body;)if(1==i.nodeType){if(i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)return i;i=i.assignedSlot||i.parentNode}else{if(11!=i.nodeType)break;i=i.host}return null}(t.contentDOM);let s=t.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(xt.allowMultipleSelections)&&function(t,e){let i=t.state.facet(pi);return i.length?i[0](e):(De.mac,e.altKey)}(t,e),this.dragMove=function(t,e){let i=t.state.facet(Oi);return i.length?i[0](e):De.mac?!e.altKey:!e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=ie(t.root);if(!n||0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let i=s[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=Yn(e))&&null}start(t){!1===this.dragging&&(t.preventDefault(),this.select(t))}move(t){var e;if(0==t.buttons)return this.destroy();if(!1!==this.dragging)return;this.select(this.lastEvent=t);let i=0,n=0,s=(null===(e=this.scrollParent)||void 0===e?void 0:e.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight};t.clientX<=s.left+6?i=-Qn(s.left-t.clientX):t.clientX>=s.right-6&&(i=Qn(t.clientX-s.right)),t.clientY<=s.top+6?n=-Qn(s.top-t.clientY):t.clientY>=s.bottom-6&&(n=Qn(t.clientY-s.bottom)),this.setScrollSpeed(i,n)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}select(t){let e=this.style.get(t,this.extend,this.multiple);!this.mustSelect&&e.eq(this.view.state.selection)&&e.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:e,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.docChanged&&this.dragging&&(this.dragging=this.dragging.map(t.changes)),this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}function Pn(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=Se.get(n))&&i.ignoreEvent(e))return!1;return!0}const Cn=Object.create(null),_n=Object.create(null),Xn=De.ie&&De.ie_version<15||De.ios&&De.webkit_version<604;function Zn(t,e){let i,{state:n}=t,s=1,r=n.toText(e),o=r.lines==n.selection.ranges.length;if(null!=Ln&&n.selection.ranges.every((t=>t.empty))&&Ln==r.toString()){let t=-1;i=n.changeByRange((i=>{let a=n.doc.lineAt(i.from);if(a.from==t)return{range:i};t=a.from;let l=n.toText((o?r.line(s++).text:e)+n.lineBreak);return{changes:{from:a.from,insert:l},range:A.cursor(i.from+l.length)}}))}else i=o?n.changeByRange((t=>{let e=r.line(s++);return{changes:{from:t.from,to:t.to,insert:e.text},range:A.cursor(t.from+e.length)}})):n.replaceSelection(r);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function An(t,e,i,n){if(1==n)return A.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),r=e-s.from;if(0==s.length)return A.cursor(e);0==r?i=1:r==s.length&&(i=-1);let o=r,a=r;i<0?o=f(s.text,r,!1):a=f(s.text,r);let l=n(s.text.slice(o,a));for(;o>0;){let t=f(s.text,o,!1);if(n(s.text.slice(t,o))!=l)break;o=t}for(;a<s.length;){let t=f(s.text,a);if(n(s.text.slice(a,t))!=l)break;a=t}return A.range(o+s.from,a+s.from)}(t.state,e,i);{let i=hi.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:n.from,r=i?i.posAtEnd:n.to;return r<t.state.doc.length&&r==n.to&&r++,A.range(s,r)}}Cn.keydown=(t,e)=>{t.inputState.setSelectionOrigin("select"),27==e.keyCode&&(t.inputState.lastEscPress=Date.now())},Cn.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},Cn.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},_n.touchstart=_n.touchmove={passive:!0},Cn.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return;let i=null;for(let n of t.state.facet(gi))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=Vn(t,e),n=Yn(e),s=t.state.selection;return{update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),s=s.map(t.changes))},get(e,r,o){let a,l=Vn(t,e),h=An(t,l.pos,l.bias,n);if(i.pos!=l.pos&&!r){let e=An(t,i.pos,i.bias,n),s=Math.min(e.from,h.from),r=Math.max(e.to,h.to);h=s<h.from?A.range(s,r):A.range(r,s)}return r?s.replaceRange(s.main.extend(h.from,h.to)):o&&1==n&&s.ranges.length>1&&(a=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:s}=t.ranges[i];if(n<=e&&s>=e)return A.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(s,l.pos))?a:o?s.addRange(h):A.create([h])}}}(t,e)),i){let n=t.root.activeElement!=t.contentDOM;t.inputState.startMouseSelection(new $n(t,e,i,n)),n&&t.observer.ignore((()=>ge(t.contentDOM))),t.inputState.mouseSelection&&t.inputState.mouseSelection.start(e)}};let Tn=(t,e)=>t>=e.top&&t<=e.bottom,Rn=(t,e,i)=>Tn(e,i)&&t>=i.left&&t<=i.right;function En(t,e,i,n){let s=hi.find(t.docView,e);if(!s)return 1;let r=e-s.posAtStart;if(0==r)return 1;if(r==s.length)return-1;let o=s.coordsAt(r,-1);if(o&&Rn(i,n,o))return-1;let a=s.coordsAt(r,1);return a&&Rn(i,n,a)?1:o&&Tn(n,o)?-1:1}function Vn(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:En(t,i,e.clientX,e.clientY)}}const Mn=De.ie&&De.ie_version<=11;let Dn=null,Wn=0,Un=0;function Yn(t){if(!Mn)return t.detail;let e=Dn,i=Un;return Dn=t,Un=Date.now(),Wn=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(Wn+1)%3:1}function qn(t,e,i,n){if(!i)return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:r}=t.inputState,o=n&&r&&r.dragging&&r.dragMove?{from:r.dragging.from,to:r.dragging.to}:null,a={from:s,insert:i},l=t.state.changes(o?[o,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(s,-1),head:l.mapPos(s,1)},userEvent:o?"move.drop":"input.drop"})}Cn.dragstart=(t,e)=>{let{selection:{main:i}}=t.state,{mouseSelection:n}=t.inputState;n&&(n.dragging=i),e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(i.from,i.to)),e.dataTransfer.effectAllowed="copyMove")},Cn.drop=(t,e)=>{if(!e.dataTransfer)return;if(t.state.readOnly)return e.preventDefault();let i=e.dataTransfer.files;if(i&&i.length){e.preventDefault();let n=Array(i.length),s=0,r=()=>{++s==i.length&&qn(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=r,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),r()},e.readAsText(i[t])}}else qn(t,e,e.dataTransfer.getData("Text"),!0)},Cn.paste=(t,e)=>{if(t.state.readOnly)return e.preventDefault();t.observer.flush();let i=Xn?null:e.clipboardData;i?(Zn(t,i.getData("text/plain")||i.getData("text/uri-text")),e.preventDefault()):function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),Zn(t,i.value)}),50)}(t)};let Ln=null;Cn.copy=Cn.cut=(t,e)=>{let{text:i,ranges:n,linewise:s}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let s=-1;for(let{from:n}of t.selection.ranges){let r=t.doc.lineAt(n);r.number>s&&(e.push(r.text),i.push({from:r.from,to:Math.min(t.doc.length,r.to+1)})),s=r.number}n=!0}return{text:e.join(t.lineBreak),ranges:i,linewise:n}}(t.state);if(!i&&!s)return;Ln=s?i:null;let r=Xn?null:e.clipboardData;r?(e.preventDefault(),r.clearData(),r.setData("text/plain",i)):function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"})};const zn=lt.define();function In(t,e){let i=[];for(let n of t.facet(vi)){let s=n(t,e);s&&i.push(s)}return i?t.update({effects:i,annotations:zn.of(!0)}):null}function Bn(t){setTimeout((()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=In(t.state,e);i?t.dispatch(i):t.update([])}}),10)}Cn.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),Bn(t)},Cn.blur=t=>{t.observer.clearSelectionRange(),Bn(t)},Cn.compositionstart=Cn.compositionupdate=t=>{null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0)},Cn.compositionend=t=>{t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,De.chrome&&De.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((()=>t.observer.flush())):setTimeout((()=>{t.inputState.composing<0&&t.docView.compositionDeco.size&&t.update([])}),50)},Cn.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},Cn.beforeinput=(t,e)=>{var i;let n;if(De.chrome&&De.android&&(n=Sn.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(n.key,n.keyCode),"Backspace"==n.key||"Delete"==n.key)){let e=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}};const jn=["pre-wrap","normal","pre-line","break-spaces"];class Nn{constructor(e){this.lineWrapping=e,this.doc=t.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return jn.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,s,r){let o=jn.indexOf(t)>-1,a=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=s,a){this.heightSamples={};for(let t=0;t<r.length;t++){let e=r[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return a}}class Gn{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class Hn{constructor(t,e,i,n,s){this.from=t,this.length=e,this.top=i,this.height=n,this.type=s}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(t){let e=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new Hn(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var Fn=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(Fn||(Fn={}));const Jn=.001;class Kn{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>Jn&&(t.heightChanged=!0),this.height=e)}replace(t,e,i){return Kn.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let s=this,r=i.doc;for(let o=n.length-1;o>=0;o--){let{fromA:a,toA:l,fromB:h,toB:c}=n[o],d=s.lineAt(a,Fn.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=l?d:s.lineAt(l,Fn.ByPosNoHeight,i,0,0);for(c+=u.to-l,l=u.to;o>0&&d.from<=n[o-1].toA;)a=n[o-1].fromA,h=n[o-1].fromB,o--,a<d.from&&(d=s.lineAt(a,Fn.ByPosNoHeight,i,0,0));h+=d.from-a,a=d.from;let f=rs.build(i.setDoc(r),t,h,c);s=s.replace(a,l,f)}return s.updateHeight(i,0)}static empty(){return new es(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,s=0;for(;;)if(e==i)if(n>2*s){let s=t[e-1];s.break?t.splice(--e,1,s.left,null,s.right):t.splice(--e,1,s.left,s.right),i+=1+s.break,n-=s.size}else{if(!(s>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(n<s){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(s+=e.size)}let r=0;return null==t[e-1]?(r=1,e--):null==t[e]&&(r=1,i++),new ns(Kn.of(t.slice(0,e)),r,Kn.of(t.slice(i)))}}Kn.prototype.size=1;class ts extends Kn{constructor(t,e,i){super(t,e),this.type=i}blockAt(t,e,i,n){return new Hn(n,this.length,i,this.height,this.type)}lineAt(t,e,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(t,e,i,n,s,r){t<=s+this.length&&e>=s&&r(this.blockAt(0,i,n,s))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(t,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class es extends ts{constructor(t,e){super(t,e,ii.Text),this.collapsed=0,this.widgetHeight=0}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof es||n instanceof is&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof is?n=new es(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):Kn.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(t,n.heights[n.index++]):(i||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class is extends Kn{constructor(t){super(t,0)}heightMetrics(t,e){let i,n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,r=s-n+1,o=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*r);i=e/r,this.length>r+1&&(o=(this.height-e)/(this.length-r-1))}else i=this.height/r;return{firstLine:n,lastLine:s,perLine:i,perChar:o}}blockAt(t,e,i,n){let{firstLine:s,lastLine:r,perLine:o,perChar:a}=this.heightMetrics(e,n);if(e.lineWrapping){let s=n+Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length),r=e.doc.lineAt(s),l=o+r.length*a,h=Math.max(i,t-l/2);return new Hn(r.from,r.length,h,l,ii.Text)}{let n=Math.max(0,Math.min(r-s,Math.floor((t-i)/o))),{from:a,length:l}=e.doc.line(s+n);return new Hn(a,l,i+o*n,o,ii.Text)}}lineAt(t,e,i,n,s){if(e==Fn.ByHeight)return this.blockAt(t,i,n,s);if(e==Fn.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new Hn(e,n-e,0,0,ii.Text)}let{firstLine:r,perLine:o,perChar:a}=this.heightMetrics(i,s),l=i.doc.lineAt(t),h=o+l.length*a,c=l.number-r,d=n+o*c+a*(l.from-s-c);return new Hn(l.from,l.length,Math.max(n,Math.min(d,n+this.height-h)),h,ii.Text)}forEachLine(t,e,i,n,s,r){t=Math.max(t,s),e=Math.min(e,s+this.length);let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(i,s);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-o;c+=a*i+l*(t-s-i)}let n=a+l*e.length;r(new Hn(e.from,e.length,c,n,ii.Text)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof is?i[i.length-1]=new is(t.length+n):i.push(null,new is(n-1))}if(t>0){let e=i[0];e instanceof is?i[0]=new is(t+e.length):i.unshift(new is(t-1),null)}return Kn.of(i)}decomposeLeft(t,e){e.push(new is(t-1),null)}decomposeRight(t,e){e.push(null,new is(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let s=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],r=Math.max(e,n.from),o=-1;for(n.from>e&&i.push(new is(n.from-e-1).updateHeight(t,e));r<=s&&n.more;){let e=t.doc.lineAt(r).length;i.length&&i.push(null);let s=n.heights[n.index++];-1==o?o=s:Math.abs(s-o)>=Jn&&(o=-2);let a=new es(e,s);a.outdated=!1,i.push(a),r+=e+1}r<=s&&i.push(null,new is(s-r).updateHeight(t,r));let a=Kn.of(i);return(o<0||Math.abs(a.height-this.height)>=Jn||Math.abs(o-this.heightMetrics(t,e).perLine)>=Jn)&&(t.heightChanged=!0),a}return(i||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class ns extends Kn{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let s=i+this.left.height;return t<s?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,s,n+this.left.length+this.break)}lineAt(t,e,i,n,s){let r=n+this.left.height,o=s+this.left.length+this.break,a=e==Fn.ByHeight?t<r:t<o,l=a?this.left.lineAt(t,e,i,n,s):this.right.lineAt(t,e,i,r,o);if(this.break||(a?l.to<o:l.from>o))return l;let h=e==Fn.ByPosNoHeight?Fn.ByPosNoHeight:Fn.ByPos;return a?l.join(this.right.lineAt(o,h,i,r,o)):this.left.lineAt(o,h,i,n,s).join(l)}forEachLine(t,e,i,n,s,r){let o=n+this.left.height,a=s+this.left.length+this.break;if(this.break)t<a&&this.left.forEachLine(t,e,i,n,s,r),e>=a&&this.right.forEachLine(t,e,i,o,a,r);else{let l=this.lineAt(a,Fn.ByPos,i,n,s);t<l.from&&this.left.forEachLine(t,l.from-1,i,n,s,r),l.to>=t&&l.from<=e&&r(l),e>l.to&&this.right.forEachLine(l.to+1,e,i,o,a,r)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let s=[];t>0&&this.decomposeLeft(t,s);let r=s.length;for(let t of i)s.push(t);if(t>0&&ss(s,r-1),e<this.length){let t=s.length;this.decomposeRight(e,s),ss(s,t)}return Kn.of(s)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?Kn.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:s,right:r}=this,o=e+s.length+this.break,a=null;return n&&n.from<=e+s.length&&n.more?a=s=s.updateHeight(t,e,i,n):s.updateHeight(t,e,i),n&&n.from<=o+r.length&&n.more?a=r=r.updateHeight(t,o,i,n):r.updateHeight(t,o,i),a?this.balanced(s,r):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function ss(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof is&&(n=t[e+1])instanceof is&&t.splice(e-1,3,new is(i.length+1+n.length))}class rs{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof es?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new es(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0;n<0&&(n=this.oracle.lineHeight);let s=e-t;i.block?this.addBlock(new ts(s,n,i.type)):(s||n>=5)&&this.addLineDeco(n,s)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new es(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new is(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof es)return t;let e=new es(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine(),t.type!=ii.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,t.type!=ii.WidgetBefore&&(this.covering=t)}addLineDeco(t,e){let i=this.ensureLine();i.length+=e,i.collapsed+=e,i.widgetHeight=Math.max(i.widgetHeight,t),this.writtenTo=this.pos=this.pos+e}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof es||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new es(0,-1));let i=t;for(let t of this.nodes)t instanceof es&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let s=new rs(i,t);return _t.spans(e,i,n,s,0),s.finish(i)}}class os{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&li(t,e,this.changes,5)}}function as(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,r=Math.max(0,i.left),o=Math.min(s.innerWidth,i.right),a=Math.max(0,i.top),l=Math.min(s.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();r=Math.max(r,n.left),o=Math.min(o,n.right),a=Math.max(a,n.top),l=e==t.parentNode?n.bottom:Math.min(l,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:r-i.left,right:Math.max(r,o)-i.left,top:a-(i.top+e),bottom:Math.max(a,l)-(i.top+e)}}function ls(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class hs{constructor(t,e,i){this.from=t,this.to=e,this.size=i}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(t){return ni.replace({widget:new cs(this.size,t)}).range(this.from,this.to)}}class cs extends ei{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class ds{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=gs,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Wi.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let i=e.facet(Ai).some((t=>"function"!=typeof t&&"cm-lineWrapping"==t.class));this.heightOracle=new Nn(i),this.stateDeco=e.facet(Ti).filter((t=>"function"!=typeof t)),this.heightMap=Kn.empty().applyChanges(this.stateDeco,t.empty,this.heightOracle.setDoc(e.doc),[new Mi(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ni.set(this.lineGaps.map((t=>t.draw(!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new us(e,i))}}this.viewports=t.sort(((t,e)=>t.from-e.from)),this.scaler=this.heightMap.height<=7e6?gs:new ms(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(t=>{this.viewportLines.push(1==this.scaler.scale?t:ws(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Ti).filter((t=>"function"!=typeof t));let n=t.changedRanges,s=Mi.extendWithRanges(n,function(t,e,i){let n=new os;return _t.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:k.empty(this.state.doc.length))),r=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),s),this.heightMap.height!=r&&(t.flags|=2);let o=s.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<o.from||e.range.head>o.to)||!this.viewportIsAppropriate(o))&&(o=this.getViewport(0,e));let a=!t.changes.empty||2&t.flags||o.from!=this.viewport.from||o.to!=this.viewport.to;this.viewport=o,this.updateForViewport(),a&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(Si)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let i=e.contentDOM,n=window.getComputedStyle(i),s=this.heightOracle,r=n.whiteSpace;this.defaultTextDirection="rtl"==n.direction?Wi.RTL:Wi.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),a=i.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let h=0,c=0,d=parseInt(n.paddingTop)||0,u=parseInt(n.paddingBottom)||0;this.paddingTop==d&&this.paddingBottom==u||(this.paddingTop=d,this.paddingBottom=u,h|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,h|=8);let f=(this.printing?ls:as)(i,this.paddingTop),p=f.top-this.pixelViewport.top,O=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let g=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(g!=this.inView&&(this.inView=g,g&&(l=!0)),!this.inView&&!this.scrollTarget)return 0;let m=a.width;if(this.contentDOMWidth==m&&this.editorHeight==e.scrollDOM.clientHeight||(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,h|=8),l){let i=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(i)&&(o=!0),o||s.lineWrapping&&Math.abs(m-this.contentDOMWidth)>s.charWidth){let{lineHeight:t,charWidth:n,textHeight:a}=e.docView.measureTextSize();o=t>0&&s.refresh(r,t,n,a,m/n,i),o&&(e.docView.minWidth=0,h|=8)}p>0&&O>0?c=Math.max(p,O):p<0&&O<0&&(c=Math.min(p,O)),s.heightChanged=!1;for(let n of this.viewports){let r=n.from==this.viewport.from?i:e.docView.measureVisibleLineHeights(n);this.heightMap=(o?Kn.empty().applyChanges(this.stateDeco,t.empty,this.heightOracle,[new Mi(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,o,new Gn(n.from,r))}s.heightChanged&&(h|=2)}let w=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(this.viewport=this.getViewport(c,this.scrollTarget)),this.updateForViewport(),(2&h||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),h|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),h}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:r,visibleBottom:o}=this,a=new us(n.lineAt(r-1e3*i,Fn.ByHeight,s,0,0).from,n.lineAt(o+1e3*(1-i),Fn.ByHeight,s,0,0).to);if(e){let{head:t}=e.range;if(t<a.from||t>a.to){let i,r=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=n.lineAt(t,Fn.ByPos,s,0,0);i="center"==e.y?(o.top+o.bottom)/2-r/2:"start"==e.y||"nearest"==e.y&&t<a.from?o.top:o.bottom-r,a=new us(n.lineAt(i-500,Fn.ByHeight,s,0,0).from,n.lineAt(i+r+500,Fn.ByHeight,s,0,0).to)}}return a}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new us(this.heightMap.lineAt(i,Fn.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,Fn.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,Fn.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(e,Fn.ByPos,this.heightOracle,0,0),{visibleTop:r,visibleBottom:o}=this;return(0==t||n<=r-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||s>=o+Math.max(10,Math.min(i,250)))&&n>r-2e3&&s<o+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new hs(e.mapPos(n.from),e.mapPos(n.to),n.size));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,r=n<<1;if(this.defaultTextDirection!=Wi.LTR&&!i)return[];let o=[],a=(n,r,l,h)=>{if(r-n<s)return;let c=this.state.selection.main,d=[c.from];c.empty||d.push(c.to);for(let t of d)if(t>n&&t<r)return a(n,t-10,l,h),void a(t+10,r,l,h);let u=function(t,e){for(let i of t)if(e(i))return i;return}(t,(t=>t.from>=l.from&&t.to<=l.to&&Math.abs(t.from-n)<s&&Math.abs(t.to-r)<s&&!d.some((e=>t.from<e&&t.to>e))));if(!u){if(r<l.to&&e&&i&&e.visibleRanges.some((t=>t.from<=r&&t.to>=r))){let t=e.moveToLineBoundary(A.cursor(r),!1,!0).head;t>n&&(r=t)}u=new hs(n,r,this.gapSize(l,n,r,h))}o.push(u)};for(let t of this.viewportLines){if(t.length<r)continue;let e=fs(t.from,t.to,this.stateDeco);if(e.total<r)continue;let s,o,l=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let i,r,a=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=l){let n=Os(e,l),s=((this.visibleBottom-this.visibleTop)/2+a)/t.height;i=n-s,r=n+s}else i=(this.visibleTop-t.top-a)/t.height,r=(this.visibleBottom-t.top+a)/t.height;s=ps(e,i),o=ps(e,r)}else{let t,i,r=e.total*this.heightOracle.charWidth,a=n*this.heightOracle.charWidth;if(null!=l){let n=Os(e,l),s=((this.pixelViewport.right-this.pixelViewport.left)/2+a)/r;t=n-s,i=n+s}else t=(this.pixelViewport.left-a)/r,i=(this.pixelViewport.right+a)/r;s=ps(e,t),o=ps(e,i)}s>t.from&&a(t.from,s,t,e),o<t.to&&a(o,t.to,t,e)}return o}gapSize(t,e,i,n){let s=Os(n,i)-Os(n,e);return this.heightOracle.lineWrapping?t.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(t){hs.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=ni.set(t.map((t=>t.draw(this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];_t.spans(t,this.viewport.from,this.viewport.to,{span(t,i){e.push({from:t,to:i})},point(){}},20);let i=e.length!=this.visibleRanges.length||this.visibleRanges.some(((t,i)=>t.from!=e[i].from||t.to!=e[i].to));return this.visibleRanges=e,i?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||ws(this.heightMap.lineAt(t,Fn.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return ws(this.heightMap.lineAt(this.scaler.fromDOM(t),Fn.ByHeight,this.heightOracle,0,0),this.scaler)}elementAtHeight(t){return ws(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class us{constructor(t,e){this.from=t,this.to=e}}function fs(t,e,i){let n=[],s=t,r=0;return _t.spans(i,t,e,{span(){},point(t,e){t>s&&(n.push({from:s,to:t}),r+=t-s),s=e}},20),s<e&&(n.push({from:s,to:e}),r+=e-s),{total:r,ranges:n}}function ps({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:s}=e[t],r=s-i;if(n<=r)return i+n;n-=r}}function Os(t,e){let i=0;for(let{from:n,to:s}of t.ranges){if(e<=s){i+=e-n;break}i+=s-n}return i/t.total}const gs={toDOM:t=>t,fromDOM:t=>t,scale:1};class ms{constructor(t,e,i){let n=0,s=0,r=0;this.viewports=i.map((({from:i,to:s})=>{let r=e.lineAt(i,Fn.ByPos,t,0,0).top,o=e.lineAt(s,Fn.ByPos,t,0,0).bottom;return n+=o-r,{from:i,to:s,top:r,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=r+(t.top-s)*this.scale,r=t.domBottom=t.domTop+(t.bottom-t.top),s=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.top)return n+(t-i)*this.scale;if(t<=s.bottom)return s.domTop+(t-s.top);i=s.bottom,n=s.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.domTop)return i+(t-n)/this.scale;if(t<=s.domBottom)return s.top+(t-s.domTop);i=s.bottom,n=s.domBottom}}}function ws(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new Hn(t.from,t.length,i,n-i,Array.isArray(t.type)?t.type.map((t=>ws(t,e))):t.type)}const bs=E.define({combine:t=>t.join(" ")}),vs=E.define({combine:t=>t.indexOf(!0)>-1}),ys=It.newName(),Ss=It.newName(),xs=It.newName(),ks={"&light":"."+Ss,"&dark":"."+xs};function Qs(t,e,i){return new It(e,{finish:e=>/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e})}const $s=Qs("."+ys,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",borderRadius:"4px",marginTop:"0.5rem",width:"30%",minWidth:"190px",marginLeft:"auto",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"#333338",fontSize:"70%",padding:".2em 1em",borderRadius:"4px"},"&light .cm-button":{background:"#eee"},"&dark .cm-button":{background:"#eee"},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",borderRadius:"0.25rem",border:"1px solid silver",padding:".0em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},ks);class Ps{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="";let{impreciseHead:s,impreciseAnchor:r}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=s||r?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:r}=t.observer.selectionRange;i&&(e.push(new nn(i,n)),s==i&&r==n||e.push(new nn(s,r)));return e}(t),i=new tn(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?A.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=s&&s.node==e.focusNode&&s.offset==e.focusOffset||!ne(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=r&&r.node==e.anchorNode&&r.offset==e.anchorOffset||!ne(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset);this.newSel=A.single(n,i)}}}function Cs(e,i){let n,{newSel:s}=i,r=e.state.selection.main;if(i.bounds){let{from:s,to:o}=i.bounds,a=r.from,l=null;(8===e.inputState.lastKeyCode&&e.inputState.lastKeyTime>Date.now()-100||De.android&&i.text.length<o-s)&&(a=r.to,l="end");let h=function(t,e,i,n){let s=Math.min(t.length,e.length),r=0;for(;r<s&&t.charCodeAt(r)==e.charCodeAt(r);)r++;if(r==s&&t.length==e.length)return null;let o=t.length,a=e.length;for(;o>0&&a>0&&t.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if("end"==n){i-=o+Math.max(0,r-Math.min(o,a))-r}if(o<r&&t.length<e.length){r-=i<=r&&i>=o?r-i:0,a=r+(a-o),o=r}else if(a<r){r-=i<=r&&i>=a?r-i:0,o=r+(o-a),a=r}return{from:r,toA:o,toB:a}}(e.state.doc.sliceString(s,o,Ki),i.text,a-s,l);h&&(De.chrome&&13==e.inputState.lastKeyCode&&h.toB==h.from+2&&i.text.slice(h.from,h.toB)==Ki+Ki&&h.toB--,n={from:s+h.from,to:s+h.toA,insert:t.of(i.text.slice(h.from,h.toB).split(Ki))})}else s&&(!e.hasFocus&&e.state.facet($i)||s.main.eq(r))&&(s=null);if(!n&&!s)return!1;if(!n&&i.typeOver&&!r.empty&&s&&s.main.empty?n={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,r.to)}:n&&n.from>=r.from&&n.to<=r.to&&(n.from!=r.from||n.to!=r.to)&&r.to-r.from-(n.to-n.from)<=4?n={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,n.from).append(n.insert).append(e.state.doc.slice(n.to,r.to))}:(De.mac||De.android)&&n&&n.from==n.to&&n.from==r.head-1&&/^\. ?$/.test(n.insert.toString())&&"off"==e.contentDOM.getAttribute("autocorrect")?(s&&2==n.insert.length&&(s=A.single(s.main.anchor-1,s.main.head-1)),n={from:r.from,to:r.to,insert:t.of([" "])}):De.chrome&&n&&n.from==n.to&&n.from==r.head&&"\n "==n.insert.toString()&&e.lineWrapping&&(s&&(s=A.single(s.main.anchor-1,s.main.head-1)),n={from:r.from,to:r.to,insert:t.of([" "])}),n){let t=e.state;if(De.ios&&e.inputState.flushIOSKey(e))return!0;if(De.android&&(n.from==r.from&&n.to==r.to&&1==n.insert.length&&2==n.insert.lines&&we(e.contentDOM,"Enter",13)||n.from==r.from-1&&n.to==r.to&&0==n.insert.length&&we(e.contentDOM,"Backspace",8)||n.from==r.from&&n.to==r.to+1&&0==n.insert.length&&we(e.contentDOM,"Delete",46)))return!0;let i,o=n.insert.toString();if(e.state.facet(bi).some((t=>t(e,n.from,n.to,o))))return!0;if(e.inputState.composing>=0&&e.inputState.composing++,n.from>=r.from&&n.to<=r.to&&n.to-n.from>=(r.to-r.from)/3&&(!s||s.main.empty&&s.main.from==n.from+n.insert.length)&&e.inputState.composing<0){let s=r.from<n.from?t.sliceDoc(r.from,n.from):"",o=r.to>n.to?t.sliceDoc(n.to,r.to):"";i=t.replaceSelection(e.state.toText(s+n.insert.sliceString(0,void 0,e.state.lineBreak)+o))}else{let o=t.changes(n),a=s&&s.main.to<=o.newLength?s.main:void 0;if(t.selection.ranges.length>1&&e.inputState.composing>=0&&n.to<=r.to&&n.to>=r.to-10){let s=e.state.sliceDoc(n.from,n.to),l=on(e)||e.state.doc.lineAt(r.head),h=r.to-n.to,c=r.to-r.from;i=t.changeByRange((i=>{if(i.from==r.from&&i.to==r.to)return{changes:o,range:a||i.map(o)};let d=i.to-h,u=d-s.length;if(i.to-i.from!=c||e.state.sliceDoc(u,d)!=s||l&&i.to>=l.from&&i.from<=l.to)return{range:i};let f=t.changes({from:u,to:d,insert:n.insert}),p=i.to-r.to;return{changes:f,range:a?A.range(Math.max(0,a.anchor+p),Math.max(0,a.head+p)):i.map(f)}}))}else i={changes:o,selection:a&&t.selection.replaceRange(a)}}let a="input.type";return(e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,a+=".compose",e.inputState.compositionFirstChange&&(a+=".start",e.inputState.compositionFirstChange=!1)),e.dispatch(i,{scrollIntoView:!0,userEvent:a}),!0}if(s&&!s.main.eq(r)){let t=!1,i="select";return e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),i=e.inputState.lastSelectionOrigin),e.dispatch({selection:s,scrollIntoView:t,userEvent:i}),!0}return!1}const _s={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Xs=De.ie&&De.ie_version<=11;class Zs{constructor(t){this.view=t,this.active=!1,this.selectionRange=new fe,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(De.ie&&De.ie_version<=11||De.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),Xs&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(t.scrollDOM),this.resizeContent=new ResizeObserver((()=>this.view.requestMeasure())),this.resizeContent.observe(t.contentDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runScrollHandlers(this.view,t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet($i)?i.root.activeElement!=this.dom:!se(i.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);s&&s.ignoreEvent(t)?e||(this.selectionChanged=!1):(De.ie&&De.ie_version<=11||De.android&&De.chrome)&&!i.state.selection.main.empty&&n.focusNode&&oe(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=De.safari&&11==t.root.nodeType&&function(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}(this.dom.ownerDocument)==this.dom&&function(t){let e=null;function i(t){t.preventDefault(),t.stopImmediatePropagation(),e=t.getTargetRanges()[0]}if(t.contentDOM.addEventListener("beforeinput",i,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",i,!0),!e)return null;let n=e.startContainer,s=e.startOffset,r=e.endContainer,o=e.endOffset,a=t.docView.domAtPos(t.state.selection.main.anchor);oe(a.node,a.offset,r,o)&&([n,s,r,o]=[r,o,n,s]);return{anchorNode:n,anchorOffset:s,focusNode:r,focusOffset:o}}(this.view)||ie(t.root);if(!e||this.selectionRange.eq(e))return!1;let i=se(this.dom,e);return i&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(;;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:(i=t,n=he(i))}else{if(i==t)return!0;n=ae(i),i=i.parentNode}}(this.dom,e)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(e),i&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,_s),Xs&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Xs&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),!this.flush()&&t.force&&we(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let s of t){let t=this.readMutation(s);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&se(this.dom,this.selectionRange);return t<0&&!n?null:(t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new Ps(this.view,t,e,i))}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return!1;let i=this.view.state,n=Cs(this.view,e);return this.view.state==i&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.dirty|=4),"childList"==t.type){let i=As(e,t.previousSibling||t.target.previousSibling,-1),n=As(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var t,e,i,n;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect(),null===(n=this.resizeContent)||void 0===n||n.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function As(t,e,i){for(;e;){let n=Se.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:i>0?e.nextSibling:e.previousSibling}return null}class Ts{constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=t.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new ds(t.state||xt.create(t)),this.plugins=this.state.facet(Ci).map((t=>new Xi(t)));for(let t of this.plugins)t.update(this);this.observer=new Zs(this),this.inputState=new yn(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new sn(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...t){this._dispatch(1==t.length&&t[0]instanceof ut?t[0]:this.state.update(...t))}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,s=this.state;for(let e of t){if(e.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=e.state}if(this.destroyed)return void(this.viewState.state=s);let r=this.hasFocus,o=0,a=null;t.some((t=>t.annotation(zn)))?(this.inputState.notifiedFocused=r,o=1):r!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=r,a=In(s,r),a||(o=1));let l=this.observer.delayedAndroidKey,h=null;if(l?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(xt.phrases)!=this.state.facet(xt.phrases))return this.setState(s);e=Di.create(this,s,t),e.flags|=o;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new xi(t.empty?t:A.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(ki)&&(c=t.value)}this.viewState.update(e,c),this.bidiCache=Vs.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(Vi)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(bs)!=e.state.facet(bs)&&(this.viewState.mustMeasureContent=!0),(i||n||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!e.empty)for(let t of this.state.facet(wi))t(e);(a||h)&&Promise.resolve().then((()=>{a&&this.state==a.startState&&this.dispatch(a),h&&!Cs(this,h)&&l.force&&we(this.contentDOM,l.key,l.keyCode)}))}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new ds(t),this.plugins=t.facet(Ci).map((t=>new Xi(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView=new sn(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(Ci),i=t.state.facet(Ci);if(e!=i){let n=[];for(let s of i){let i=e.indexOf(s);if(i<0)n.push(new Xi(s));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this)}measure(t=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,{scrollHeight:i,scrollTop:n,clientHeight:s}=this.scrollDOM,r=n>i-s-4?i:n;try{for(let t=0;;t++){this.updateState=1;let i=this.viewport,n=this.viewState.lineBlockAtHeight(r),s=this.viewState.measure(this);if(!s&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let o=[];4&s||([this.measureRequests,o]=[o,this.measureRequests]);let a=o.map((t=>{try{return t.read(this)}catch(t){return Qi(this.state,t),Es}})),l=Di.create(this,this.state,[]),h=!1,c=!1;l.flags|=s,e?e.flags|=s:e=l,this.updateState=2,l.empty||(this.updatePlugins(l),this.inputState.update(l),this.updateAttrs(),h=this.docView.update(l));for(let t=0;t<o.length;t++)if(a[t]!=Es)try{let e=o[t];e.write&&e.write(a[t],this)}catch(t){Qi(this.state,t)}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,c=!0;else{let t=this.viewState.lineBlockAt(n.from).top-n.top;(t>1||t<-1)&&(this.scrollDOM.scrollTop+=t,c=!0)}if(h&&this.docView.updateSelection(!0),this.viewport.from==i.from&&this.viewport.to==i.to&&!c&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(wi))t(e)}get themeClasses(){return ys+" "+(this.state.facet(vs)?xs:Ss)+" "+this.state.facet(bs)}updateAttrs(){let t=Ms(this,Zi,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet($i)?"true":"false",class:"cm-content",style:`${De.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),Ms(this,Ai,e);let i=this.observer.ignore((()=>{let i=ti(this.contentDOM,this.contentAttrs,e),n=ti(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)if(t.is(Ts.announce)){e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value}}mountStyles(){this.styleModules=this.state.facet(Vi),It.mount(this.root,this.styleModules.concat($s).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return vn(this,t,bn(this,t,e,i))}moveByCharSelected(t,e,i){return vn(this,t,bn(this,t,e,i),!0)}moveByGroup(t,e){return vn(this,t,bn(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),s=n(i);return t=>{let e=n(t);return s==bt.Space&&(s=e),s==e}}(this,t.head,e))))}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let s=t.state.doc.lineAt(e.head),r=n&&t.lineWrapping?t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head):null;if(r){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(s.from),o=t.posAtCoords({x:i==(n==Wi.LTR)?e.right-1:e.left+1,y:(r.top+r.bottom)/2});if(null!=o)return A.cursor(o,i?-1:1)}let o=hi.find(t.docView,e.head),a=o?i?o.posAtEnd:o.posAtStart:i?s.to:s.from;return A.cursor(a,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return vn(this,t,function(t,e,i,n){let s=e.head,r=i?1:-1;if(s==(i?t.state.doc.length:0))return A.cursor(s,e.assoc);let o,a=e.goalColumn,l=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(s),c=t.documentTop;if(h)null==a&&(a=h.left-l.left),o=r<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(s);null==a&&(a=Math.min(l.right-l.left,t.defaultCharacterWidth*(s-e.from))),o=(r<0?e.top:e.bottom)+c}let d=l.left+a,u=null!=n?n:t.defaultLineHeight>>1;for(let i=0;;i+=10){let n=o+(u+i)*r,h=mn(t,{x:d,y:n},!1,r);if(n<l.top||n>l.bottom||(r<0?h<s:h>s))return A.cursor(h,e.assoc,void 0,a)}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),mn(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),s=this.bidiSpans(n);return de(i,s[Ni.find(s,t-n.from,-1,e)].dir==Wi.LTR==e>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(yi)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>Rs)return Hi(t.length);let e=this.textDirectionAt(t.from);for(let i of this.bidiCache)if(i.from==t.from&&i.dir==e)return i.order;let i=function(t,e){let i=t.length,n=e==Ui?1:2,s=e==Ui?2:1;if(!t||1==n&&!ji.test(t))return Hi(i);for(let e=0,s=n,o=n;e<i;e++){let i=(r=t.charCodeAt(e))<=247?Li[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?zi[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8203?256:64336<=r&&r<=65023?4:8204==r?256:1;512==i?i=s:8==i&&4==o&&(i=16),Gi[e]=4==i?2:i,7&i&&(o=i),s=i}var r;for(let t=0,e=n,s=n;t<i;t++){let n=Gi[t];if(128==n)t<i-1&&e==Gi[t+1]&&24&e?n=Gi[t]=e:Gi[t]=256;else if(64==n){let n=t+1;for(;n<i&&64==Gi[n];)n++;let r=t&&8==e||n<i&&8==Gi[n]?1==s?1:8:256;for(let e=t;e<n;e++)Gi[e]=r;t=n-1}else 8==n&&1==s&&(Gi[t]=1);e=n,7&n&&(s=n)}for(let e,r,o,a=0,l=0,h=0;a<i;a++)if(r=Ii[e=t.charCodeAt(a)])if(r<0){for(let t=l-3;t>=0;t-=3)if(Bi[t+1]==-r){let e=Bi[t+2],i=2&e?n:4&e?1&e?s:n:0;i&&(Gi[a]=Gi[Bi[t]]=i),l=t;break}}else{if(189==Bi.length)break;Bi[l++]=a,Bi[l++]=e,Bi[l++]=h}else if(2==(o=Gi[a])||1==o){let t=o==n;h=t?0:1;for(let e=l-3;e>=0;e-=3){let i=Bi[e+2];if(2&i)break;if(t)Bi[e+2]|=2;else{if(4&i)break;Bi[e+2]|=4}}}for(let t=0;t<i;t++)if(256==Gi[t]){let e=t+1;for(;e<i&&256==Gi[e];)e++;let s=1==(t?Gi[t-1]:n),r=s==(1==(e<i?Gi[e]:n))?s?1:2:n;for(let i=t;i<e;i++)Gi[i]=r;t=e-1}let o=[];if(1==n)for(let t=0;t<i;){let e=t,n=1!=Gi[t++];for(;t<i&&n==(1!=Gi[t]);)t++;if(n)for(let i=t;i>e;){let t=i,n=2!=Gi[--i];for(;i>e&&n==(2!=Gi[i-1]);)i--;o.push(new Ni(i,t,n?2:1))}else o.push(new Ni(e,t,0))}else for(let t=0;t<i;){let e=t,n=2==Gi[t++];for(;t<i&&n==(2==Gi[t]);)t++;o.push(new Ni(e,t,n?1:2))}return o}(t.text,e);return this.bidiCache.push(new Vs(t.from,t.to,e,i)),i}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||De.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{ge(this.contentDOM),this.docView.updateSelection()}))}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return ki.of(new xi("number"==typeof t?A.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}static domEventHandlers(t){return _i.define((()=>({})),{eventHandlers:t})}static theme(t,e){let i=It.newName(),n=[bs.of(i),Vi.of(Qs(`.${i}`,t))];return e&&e.dark&&n.push(vs.of(!0)),n}static baseTheme(t){return N.lowest(Vi.of(Qs("."+ys,t,ks)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&Se.get(i)||Se.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}Ts.styleModule=Vi,Ts.inputHandler=bi,Ts.focusChangeEffect=vi,Ts.perLineTextDirection=yi,Ts.exceptionSink=mi,Ts.updateListener=wi,Ts.editable=$i,Ts.mouseSelectionStyle=gi,Ts.dragMovesSelection=Oi,Ts.clickAddsSelectionRange=pi,Ts.decorations=Ti,Ts.atomicRanges=Ri,Ts.scrollMargins=Ei,Ts.darkTheme=vs,Ts.contentAttributes=Ai,Ts.editorAttributes=Zi,Ts.lineWrapping=Ts.contentAttributes.of({class:"cm-lineWrapping"}),Ts.announce=dt.define();const Rs=4096,Es={};class Vs{constructor(t,e,i,n){this.from=t,this.to=e,this.dir=i,this.order=n}static update(t,e){if(e.empty)return t;let i=[],n=t.length?t[t.length-1].dir:Wi.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let r=t[s];r.dir!=n||e.touchesRange(r.from,r.to)||i.push(new Vs(e.mapPos(r.from,1),e.mapPos(r.to,-1),r.dir,r.order))}return i}}function Ms(t,e,i){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let e=n[s],r="function"==typeof e?e(t):e;r&&Je(r,i)}return i}const Ds=De.mac?"mac":De.windows?"win":De.linux?"linux":"key";function Ws(t,e,i){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==i&&e.shiftKey&&(t="Shift-"+t),t}const Us=N.default(Ts.domEventHandlers({keydown:(t,e)=>Bs(Ls(e.state),t,e,"editor")})),Ys=E.define({enables:Us}),qs=new WeakMap;function Ls(t){let e=t.facet(Ys),i=qs.get(e);return i||qs.set(e,i=function(t,e=Ds){let i=Object.create(null),n=Object.create(null),s=(t,e)=>{let i=n[t];if(null==i)n[t]=e;else if(i!=e)throw new Error("Key binding "+t+" is used both as a regular binding and as a multi-stroke prefix")},r=(t,n,r,o)=>{var a,l;let h=i[t]||(i[t]=Object.create(null)),c=n.split(/ (?!$)/).map((t=>function(t,e){const i=t.split(/-(?!$)/);let n,s,r,o,a=i[i.length-1];"Space"==a&&(a=" ");for(let t=0;t<i.length-1;++t){const a=i[t];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))s=!0;else if(/^s(hift)?$/i.test(a))r=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);"mac"==e?o=!0:s=!0}}return n&&(a="Alt-"+a),s&&(a="Ctrl-"+a),o&&(a="Meta-"+a),r&&(a="Shift-"+a),a}(t,e)));for(let e=1;e<c.length;e++){let i=c.slice(0,e).join(" ");s(i,!0),h[i]||(h[i]={preventDefault:!0,run:[e=>{let n=zs={view:e,prefix:i,scope:t};return setTimeout((()=>{zs==n&&(zs=null)}),Is),!0}]})}let d=c.join(" ");s(d,!1);let u=h[d]||(h[d]={preventDefault:!1,run:(null===(l=null===(a=h._any)||void 0===a?void 0:a.run)||void 0===l?void 0:l.slice())||[]});r&&u.run.push(r),o&&(u.preventDefault=!0)};for(let n of t){let t=n.scope?n.scope.split(" "):["editor"];if(n.any)for(let e of t){let t=i[e]||(i[e]=Object.create(null));t._any||(t._any={preventDefault:!1,run:[]});for(let e in t)t[e].run.push(n.any)}let s=n[e]||n.key;if(s)for(let e of t)r(e,s,n.run,n.preventDefault),n.shift&&r(e,"Shift-"+s,n.shift,n.preventDefault)}return i}(e.reduce(((t,e)=>t.concat(e)),[]))),i}let zs=null;const Is=4e3;function Bs(t,e,i,n){let s=function(t){var e=!(Kt&&(t.ctrlKey||t.altKey||t.metaKey)||Jt&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?Gt:Nt)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(e),r=v(w(s,0))==s.length&&" "!=s,o="",a=!1;zs&&zs.view==i&&zs.scope==n&&(o=zs.prefix+" ",(a=kn.indexOf(e.keyCode)<0)&&(zs=null));let l,h,c=new Set,d=t=>{if(t){for(let n of t.run)if(!c.has(n)&&(c.add(n),n(i,e)))return!0;t.preventDefault&&(a=!0)}return!1},u=t[n];if(u){if(d(u[o+Ws(s,e,!r)]))return!0;if(r&&(e.altKey||e.metaKey||e.ctrlKey)&&!(De.windows&&e.ctrlKey&&e.altKey)&&(l=Nt[e.keyCode])&&l!=s){if(d(u[o+Ws(l,e,!0)]))return!0;if(e.shiftKey&&(h=Gt[e.keyCode])!=s&&h!=l&&d(u[o+Ws(h,e,!1)]))return!0}else if(r&&e.shiftKey&&d(u[o+Ws(s,e,!0)]))return!0;if(d(u._any))return!0}return a}class js{constructor(t,e,i,n,s){this.className=t,this.left=e,this.top=i,this.width=n,this.height=s}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,e){return e.className==this.className&&(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",null!=this.width&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,e,i){if(i.empty){let n=t.coordsAtPos(i.head,i.assoc||1);if(!n)return[];let s=Ns(t);return[new js(e,n.left-s.left,n.top-s.top,null,n.bottom-n.top)]}return function(t,e,i){if(i.to<=t.viewport.from||i.from>=t.viewport.to)return[];let n=Math.max(i.from,t.viewport.from),s=Math.min(i.to,t.viewport.to),r=t.textDirection==Wi.LTR,o=t.contentDOM,a=o.getBoundingClientRect(),l=Ns(t),h=o.querySelector(".cm-line"),c=h&&window.getComputedStyle(h),d=a.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),u=a.right-(c?parseInt(c.paddingRight):0),f=Hs(t,n),p=Hs(t,s),O=f.type==ii.Text?f:null,g=p.type==ii.Text?p:null;t.lineWrapping&&(O&&(O=Gs(t,n,O)),g&&(g=Gs(t,s,g)));if(O&&g&&O.from==g.from)return w(b(i.from,i.to,O));{let e=O?b(i.from,null,O):v(f,!1),n=g?b(null,i.to,g):v(p,!0),s=[];return(O||f).to<(g||p).from-1?s.push(m(d,e.bottom,u,n.top)):e.bottom<n.top&&t.elementAtHeight((e.bottom+n.top)/2).type==ii.Text&&(e.bottom=n.top=(e.bottom+n.top)/2),w(e).concat(s).concat(w(n))}function m(t,i,n,s){return new js(e,t-l.left,i-l.top-.01,n-t,s-i+.01)}function w({top:t,bottom:e,horizontal:i}){let n=[];for(let s=0;s<i.length;s+=2)n.push(m(i[s],t,i[s+1],e));return n}function b(e,i,n){let s=1e9,o=-1e9,a=[];function l(e,i,l,h,c){let f=t.coordsAtPos(e,e==n.to?-2:2),p=t.coordsAtPos(l,l==n.from?2:-2);s=Math.min(f.top,p.top,s),o=Math.max(f.bottom,p.bottom,o),c==Wi.LTR?a.push(r&&i?d:f.left,r&&h?u:p.right):a.push(!r&&h?d:p.left,!r&&i?u:f.right)}let h=null!=e?e:n.from,c=null!=i?i:n.to;for(let n of t.visibleRanges)if(n.to>h&&n.from<c)for(let s=Math.max(n.from,h),r=Math.min(n.to,c);;){let n=t.state.doc.lineAt(s);for(let o of t.bidiSpans(n)){let t=o.from+n.from,a=o.to+n.from;if(t>=r)break;a>s&&l(Math.max(t,s),null==e&&t<=h,Math.min(a,r),null==i&&a>=c,o.dir)}if(s=n.to+1,s>=r)break}return 0==a.length&&l(h,null==e,c,null==i,t.textDirection),{top:s,bottom:o,horizontal:a}}function v(t,e){let i=a.top+(e?t.top:t.bottom);return{top:i,bottom:i,horizontal:[]}}}(t,e,i)}}function Ns(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==Wi.LTR?e.left:e.right-t.scrollDOM.clientWidth)-t.scrollDOM.scrollLeft,top:e.top-t.scrollDOM.scrollTop}}function Gs(t,e,i){let n=A.cursor(e);return{from:Math.max(i.from,t.moveToLineBoundary(n,!1,!0).from),to:Math.min(i.to,t.moveToLineBoundary(n,!0,!0).from),type:ii.Text}}function Hs(t,e){let i=t.lineBlockAt(e);if(Array.isArray(i.type))for(let t of i.type)if(t.to>e||t.to==e&&(t.to==i.to||t.type==ii.Text))return t;return i}class Fs{constructor(t,e){this.view=t,this.layer=e,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),e.above&&this.dom.classList.add("cm-layer-above"),e.class&&this.dom.classList.add(e.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),e.mount&&e.mount(this.dom,t)}update(t){t.startState.facet(Js)!=t.state.facet(Js)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&t.view.requestMeasure(this.measureReq)}setOrder(t){let e=0,i=t.facet(Js);for(;e<i.length&&i[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?150:-1)-e)}measure(){return this.layer.markers(this.view)}draw(t){if(t.length!=this.drawn.length||t.some(((t,e)=>{return i=t,n=this.drawn[e],!(i.constructor==n.constructor&&i.eq(n));var i,n}))){let e=this.dom.firstChild,i=0;for(let n of t)n.update&&e&&n.constructor&&this.drawn[i].constructor&&n.update(e,this.drawn[i])?(e=e.nextSibling,i++):this.dom.insertBefore(n.draw(),e);for(;e;){let t=e.nextSibling;e.remove(),e=t}this.drawn=t}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Js=E.define();function Ks(t){return[_i.define((e=>new Fs(e,t))),Js.of(t)]}const tr=!De.ios,er=E.define({combine:t=>kt(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})});function ir(t={}){return[er.of(t),sr,or,lr,Si.of(!0)]}function nr(t){return t.startState.facet(er)!=t.state.facet(er)}const sr=Ks({above:!0,markers(t){let{state:e}=t,i=e.facet(er),n=[];for(let s of e.selection.ranges){let r=s==e.selection.main;if(s.empty?!r||tr:i.drawRangeCursor){let e=r?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",i=s.empty?s:A.cursor(s.head,s.head>s.anchor?-1:1);for(let s of js.forRange(t,e,i))n.push(s)}}return n},update(t,e){t.transactions.some((t=>t.selection))&&(e.style.animationName="cm-blink"==e.style.animationName?"cm-blink2":"cm-blink");let i=nr(t);return i&&rr(t.state,e),t.docChanged||t.selectionSet||i},mount(t,e){rr(e.state,t)},class:"cm-cursorLayer"});function rr(t,e){e.style.animationDuration=t.facet(er).cursorBlinkRate+"ms"}const or=Ks({above:!1,markers:t=>t.state.selection.ranges.map((e=>e.empty?[]:js.forRange(t,"cm-selectionBackground",e))).reduce(((t,e)=>t.concat(e))),update:(t,e)=>t.docChanged||t.selectionSet||t.viewportChanged||nr(t),class:"cm-selectionLayer"}),ar={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};tr&&(ar[".cm-line"].caretColor="transparent !important");const lr=N.highest(Ts.theme(ar)),hr=dt.define({map:(t,e)=>null==t?null:e.mapPos(t)}),cr=q.define({create:()=>null,update:(t,e)=>(null!=t&&(t=e.changes.mapPos(t)),e.effects.reduce(((t,e)=>e.is(hr)?e.value:t),t))}),dr=_i.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let i=t.state.field(cr);null==i?null!=this.cursor&&(null===(e=this.cursor)||void 0===e||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(cr)!=i||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let t=this.view.state.field(cr),e=null!=t&&this.view.coordsAtPos(t);if(!e)return null;let i=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-i.left+this.view.scrollDOM.scrollLeft,top:e.top-i.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(t){this.cursor&&(t?(this.cursor.style.left=t.left+"px",this.cursor.style.top=t.top+"px",this.cursor.style.height=t.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(cr)!=t&&this.view.dispatch({effects:hr.of(t)})}},{eventHandlers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){t.target!=this.view.contentDOM&&this.view.contentDOM.contains(t.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function ur(){return[cr,dr]}function fr(t,e,i,n,s){e.lastIndex=0;for(let r,o=t.iterRange(i,n),a=i;!o.next().done;a+=o.value.length)if(!o.lineBreak)for(;r=e.exec(o.value);)s(a+r.index,r)}class pr{constructor(t){const{regexp:e,decoration:i,decorate:n,boundary:s,maxLength:r=1e3}=t;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,n)this.addMatch=(t,e,i,s)=>n(s,i,i+t[0].length,t,e);else if("function"==typeof i)this.addMatch=(t,e,n,s)=>{let r=i(t,e,n);r&&s(n,n+t[0].length,r)};else{if(!i)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=(t,e,n,s)=>s(n,n+t[0].length,i)}this.boundary=s,this.maxLength=r}createDeco(t){let e=new Xt,i=e.add.bind(e);for(let{from:e,to:n}of function(t,e){let i=t.visibleRanges;if(1==i.length&&i[0].from==t.viewport.from&&i[0].to==t.viewport.to)return i;let n=[];for(let{from:s,to:r}of i)s=Math.max(t.state.doc.lineAt(s).from,s-e),r=Math.min(t.state.doc.lineAt(r).to,r+e),n.length&&n[n.length-1].to>=s?n[n.length-1].to=r:n.push({from:s,to:r});return n}(t,this.maxLength))fr(t.state.doc,this.regexp,e,n,((e,n)=>this.addMatch(n,t,e,i)));return e.finish()}updateDeco(t,e){let i=1e9,n=-1;return t.docChanged&&t.changes.iterChanges(((e,s,r,o)=>{o>t.view.viewport.from&&r<t.view.viewport.to&&(i=Math.min(r,i),n=Math.max(o,n))})),t.viewportChanged||n-i>1e3?this.createDeco(t.view):n>-1?this.updateRange(t.view,e.map(t.changes),i,n):e}updateRange(t,e,i,n){for(let s of t.visibleRanges){let r=Math.max(s.from,i),o=Math.min(s.to,n);if(o>r){let i=t.state.doc.lineAt(r),n=i.to<o?t.state.doc.lineAt(o):i,a=Math.max(s.from,i.from),l=Math.min(s.to,n.to);if(this.boundary){for(;r>i.from;r--)if(this.boundary.test(i.text[r-1-i.from])){a=r;break}for(;o<n.to;o++)if(this.boundary.test(n.text[o-n.from])){l=o;break}}let h,c=[],d=(t,e,i)=>c.push(i.range(t,e));if(i==n)for(this.regexp.lastIndex=a-i.from;(h=this.regexp.exec(i.text))&&h.index<l-i.from;)this.addMatch(h,t,h.index+i.from,d);else fr(t.state.doc,this.regexp,a,l,((e,i)=>this.addMatch(i,t,e,d)));e=e.update({filterFrom:a,filterTo:l,filter:(t,e)=>t<a||e>l,add:c})}}return e}}const Or=null!=/x/.unicode?"gu":"g",gr=new RegExp("[\0-\b\n--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\ufeff￹-￼]",Or),mr={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let wr=null;const br=E.define({combine(t){let e=kt(t,{render:null,specialChars:gr,addSpecialChars:null});return(e.replaceTabs=!function(){var t;if(null==wr&&"undefined"!=typeof document&&document.body){let e=document.body.style;wr=null!=(null!==(t=e.tabSize)&&void 0!==t?t:e.MozTabSize)}return wr||!1}())&&(e.specialChars=new RegExp("\t|"+e.specialChars.source,Or)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Or)),e}});function vr(t={}){return[br.of(t),yr||(yr=_i.fromClass(class{constructor(t){this.view=t,this.decorations=ni.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(br)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new pr({regexp:t.specialChars,decoration:(e,i,n)=>{let{doc:s}=i.state,r=w(e[0],0);if(9==r){let t=s.lineAt(n),e=i.state.tabSize,r=Yt(t.text,e,n-t.from);return ni.replace({widget:new xr((e-r%e)*this.view.defaultCharacterWidth)})}return this.decorationCache[r]||(this.decorationCache[r]=ni.replace({widget:new Sr(t,r)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(br);t.startState.facet(br)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))]}let yr=null;class Sr extends ei{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){let e=function(t){return t>=32?"•":10==t?"␤":String.fromCharCode(9216+t)}(this.code),i=t.state.phrase("Control character")+" "+(mr[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,i,e);if(n)return n;let s=document.createElement("span");return s.textContent=e,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class xr extends ei{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="\t",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}class kr extends ei{constructor(t){super(),this.content=t}toDOM(){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild("string"==typeof this.content?document.createTextNode(this.content):this.content),"string"==typeof this.content?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}ignoreEvent(){return!1}}const Qr="-10000px";class $r{constructor(t,e,i){this.facet=e,this.createTooltipView=i,this.input=t.state.facet(e),this.tooltips=this.input.filter((t=>t)),this.tooltipViews=this.tooltips.map(i)}update(t){var e;let i=t.state.facet(this.facet),n=i.filter((t=>t));if(i===this.input){for(let e of this.tooltipViews)e.update&&e.update(t);return!1}let s=[];for(let e=0;e<n.length;e++){let i=n[e],r=-1;if(i){for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];e&&e.create==i.create&&(r=t)}if(r<0)s[e]=this.createTooltipView(i);else{let i=s[e]=this.tooltipViews[r];i.update&&i.update(t)}}}for(let t of this.tooltipViews)s.indexOf(t)<0&&(t.dom.remove(),null===(e=t.destroy)||void 0===e||e.call(t));return this.input=i,this.tooltips=n,this.tooltipViews=s,!0}}function Pr(t){let{win:e}=t;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const Cr=E.define({combine:t=>{var e,i,n;return{position:De.ios?"absolute":(null===(e=t.find((t=>t.position)))||void 0===e?void 0:e.position)||"fixed",parent:(null===(i=t.find((t=>t.parent)))||void 0===i?void 0:i.parent)||null,tooltipSpace:(null===(n=t.find((t=>t.tooltipSpace)))||void 0===n?void 0:n.tooltipSpace)||Pr}}}),_r=new WeakMap,Xr=_i.fromClass(class{constructor(t){this.view=t,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(Cr);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new $r(t,Tr,(t=>this.createTooltip(t))),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t);e&&this.observeIntersection();let i=e||t.geometryChanged,n=t.state.facet(Cr);if(n.position!=this.position){this.position=n.position;for(let t of this.manager.tooltipViews)t.dom.style.position=this.position;i=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let t of this.manager.tooltipViews)this.container.appendChild(t.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(t){let e=t.create(this.view);if(e.dom.classList.add("cm-tooltip"),t.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=Qr,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let e of this.manager.tooltipViews)e.dom.remove(),null===(t=e.destroy)||void 0===t||t.call(e);null===(e=this.intersectionObserver)||void 0===e||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=this.view.dom.getBoundingClientRect();return{editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map(((t,e)=>{let i=this.manager.tooltipViews[e];return i.getCoords?i.getCoords(t.pos):this.view.coordsAtPos(t.pos)})),size:this.manager.tooltipViews.map((({dom:t})=>t.getBoundingClientRect())),space:this.view.state.facet(Cr).tooltipSpace(this.view)}}writeMeasure(t){var e;let{editor:i,space:n}=t,s=[];for(let r=0;r<this.manager.tooltips.length;r++){let o=this.manager.tooltips[r],a=this.manager.tooltipViews[r],{dom:l}=a,h=t.pos[r],c=t.size[r];if(!h||h.bottom<=Math.max(i.top,n.top)||h.top>=Math.min(i.bottom,n.bottom)||h.right<Math.max(i.left,n.left)-.1||h.left>Math.min(i.right,n.right)+.1){l.style.top=Qr;continue}let d=o.arrow?a.dom.querySelector(".cm-tooltip-arrow"):null,u=d?7:0,f=c.right-c.left,p=null!==(e=_r.get(a))&&void 0!==e?e:c.bottom-c.top,O=a.offset||Ar,g=this.view.textDirection==Wi.LTR,m=c.width>n.right-n.left?g?n.left:n.right-c.width:g?Math.min(h.left-(d?14:0)+O.x,n.right-f):Math.max(n.left,h.left-f+(d?14:0)-O.x),w=!!o.above;!o.strictSide&&(w?h.top-(c.bottom-c.top)-O.y<n.top:h.bottom+(c.bottom-c.top)+O.y>n.bottom)&&w==n.bottom-h.bottom>h.top-n.top&&(w=!w);let b=(w?h.top-n.top:n.bottom-h.bottom)-u;if(b<p&&!1!==a.resize){if(b<this.view.defaultLineHeight){l.style.top=Qr;continue}_r.set(a,p),l.style.height=(p=b)+"px"}else l.style.height&&(l.style.height="");let v=w?h.top-p-u-O.y:h.bottom+u+O.y,y=m+f;if(!0!==a.overlap)for(let t of s)t.left<y&&t.right>m&&t.top<v+p&&t.bottom>v&&(v=w?t.top-p-2-u:t.bottom+u+2);"absolute"==this.position?(l.style.top=v-t.parent.top+"px",l.style.left=m-t.parent.left+"px"):(l.style.top=v+"px",l.style.left=m+"px"),d&&(d.style.left=h.left+(g?O.x:-O.x)-(m+14-7)+"px"),!0!==a.overlap&&s.push({left:m,top:v,right:y,bottom:v+p}),l.classList.toggle("cm-tooltip-above",w),l.classList.toggle("cm-tooltip-below",!w),a.positioned&&a.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=Qr}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),Zr=Ts.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Ar={x:0,y:0},Tr=E.define({enables:[Xr,Zr]}),Rr=E.define();class Er{constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new $r(t,Rr,(t=>this.createHostedView(t)))}static create(t){return new Er(t)}createHostedView(t){let e=t.create(this.view);return e.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(e.dom),this.mounted&&e.mount&&e.mount(this.view),e}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)null===(t=e.destroy)||void 0===t||t.call(e)}}const Vr=Tr.compute([Rr],(t=>{let e=t.facet(Rr).filter((t=>t));return 0===e.length?null:{pos:Math.min(...e.map((t=>t.pos))),end:Math.max(...e.filter((t=>null!=t.end)).map((t=>t.end))),create:Er.create,above:e[0].above,arrow:e.some((t=>t.arrow))}}));class Mr{constructor(t,e,i,n,s){this.view=t,this.source=e,this.field=i,this.setHover=n,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((()=>this.startHover()),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:t}=this,e=this.view.contentDOM.contains(t.target)?this.view.posAtCoords(t):null;if(null==e)return;let i=this.view.coordsAtPos(e);if(null==i||t.y<i.top||t.y>i.bottom||t.x<i.left-this.view.defaultCharacterWidth||t.x>i.right+this.view.defaultCharacterWidth)return;let n=this.view.bidiSpans(this.view.state.doc.lineAt(e)).find((t=>t.from<=e&&t.to>=e)),s=n&&n.dir==Wi.RTL?-1:1,r=this.source(this.view,e,t.x<i.left?-s:s);if(null==r?void 0:r.then){let t=this.pending={pos:e};r.then((e=>{this.pending==t&&(this.pending=null,e&&this.view.dispatch({effects:this.setHover.of(e)}))}),(t=>Qi(this.view.state,t,"hover tooltip")))}else r&&this.view.dispatch({effects:this.setHover.of(r)})}mousemove(t){var e;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let i=this.active;if(i&&!Dr(this.lastMove.target)||this.pending){let{pos:n}=i||this.pending,s=null!==(e=null==i?void 0:i.end)&&void 0!==e?e:n;(n==s?this.view.posAtCoords(this.lastMove)==n:function(t,e,i,n,s,r){let o=document.createRange(),a=t.domAtPos(e),l=t.domAtPos(i);o.setEnd(l.node,l.offset),o.setStart(a.node,a.offset);let h=o.getClientRects();o.detach();for(let t=0;t<h.length;t++){let e=h[t];if(Math.max(e.top-s,s-e.bottom,e.left-n,n-e.right)<=r)return!0}return!1}(this.view,n,s,t.clientX,t.clientY,6))||(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!Dr(t.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function Dr(t){for(let e=t;e;e=e.parentNode)if(1==e.nodeType&&e.classList.contains("cm-tooltip"))return!0;return!1}function Wr(t,e={}){let i=dt.define(),n=q.define({create:()=>null,update(t,n){if(t&&(e.hideOnChange&&(n.docChanged||n.selection)||e.hideOn&&e.hideOn(n,t)))return null;if(t&&n.docChanged){let e=n.changes.mapPos(t.pos,-1,S.TrackDel);if(null==e)return null;let i=Object.assign(Object.create(null),t);i.pos=e,null!=t.end&&(i.end=n.changes.mapPos(t.end)),t=i}for(let e of n.effects)e.is(i)&&(t=e.value),e.is(Yr)&&(t=null);return t},provide:t=>Rr.from(t)});return[n,_i.define((s=>new Mr(s,t,n,i,e.hoverTime||300))),Vr]}function Ur(t,e){let i=t.plugin(Xr);if(!i)return null;let n=i.manager.tooltips.indexOf(e);return n<0?null:i.manager.tooltipViews[n]}const Yr=dt.define(),qr=E.define({combine(t){let e,i;for(let n of t)e=e||n.topContainer,i=i||n.bottomContainer;return{topContainer:e,bottomContainer:i}}});function Lr(t,e){let i=t.plugin(zr),n=i?i.specs.indexOf(e):-1;return n>-1?i.panels[n]:null}const zr=_i.fromClass(class{constructor(t){this.input=t.state.facet(jr),this.specs=this.input.filter((t=>t)),this.panels=this.specs.map((e=>e(t)));let e=t.state.facet(qr);this.top=new Ir(t,!0,e.topContainer),this.bottom=new Ir(t,!1,e.bottomContainer),this.top.sync(this.panels.filter((t=>t.top))),this.bottom.sync(this.panels.filter((t=>!t.top)));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(t){let e=t.state.facet(qr);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Ir(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Ir(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=t.state.facet(jr);if(i!=this.input){let e=i.filter((t=>t)),n=[],s=[],r=[],o=[];for(let i of e){let e,a=this.specs.indexOf(i);a<0?(e=i(t.view),o.push(e)):(e=this.panels[a],e.update&&e.update(t)),n.push(e),(e.top?s:r).push(e)}this.specs=e,this.panels=n,this.top.sync(s),this.bottom.sync(r);for(let t of o)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(let e of this.panels)e.update&&e.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Ts.scrollMargins.of((e=>{let i=e.plugin(t);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}}))});class Ir{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=Br(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=Br(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function Br(t){let e=t.nextSibling;return t.remove(),e}const jr=E.define({enables:zr});class Nr extends Qt{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}Nr.prototype.elementClass="",Nr.prototype.toDOM=void 0,Nr.prototype.mapMode=S.TrackBefore,Nr.prototype.startSide=Nr.prototype.endSide=-1,Nr.prototype.point=!0;const Gr=E.define(),Hr={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>_t.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Fr=E.define();function Jr(t){return[to(),Fr.of(Object.assign(Object.assign({},Hr),t))]}const Kr=E.define({combine:t=>t.some((t=>t))});function to(t){let e=[eo];return t&&!1===t.fixed&&e.push(Kr.of(!0)),e}const eo=_i.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(Fr).map((e=>new ro(t,e)));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!t.state.facet(Kr),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,i=t.view.viewport,n=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(n<.8*(i.to-i.from))}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Kr)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let i=_t.iter(this.view.state.facet(Gr),this.view.viewport.from),n=[],s=this.gutters.map((t=>new so(t,this.view.viewport,-this.view.documentPadding.top)));for(let t of this.view.viewportLineBlocks){let e;if(Array.isArray(t.type)){for(let i of t.type)if(i.type==ii.Text){e=i;break}}else e=t.type==ii.Text?t:void 0;if(e){n.length&&(n=[]),no(i,n,t.from);for(let t of s)t.line(this.view,e,n)}}for(let t of s)t.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(Fr),i=t.state.facet(Fr),n=t.docChanged||t.heightChanged||t.viewportChanged||!_t.eq(t.startState.facet(Gr),t.state.facet(Gr),t.view.viewport.from,t.view.viewport.to);if(e==i)for(let e of this.gutters)e.update(t)&&(n=!0);else{n=!0;let s=[];for(let n of i){let i=e.indexOf(n);i<0?s.push(new ro(this.view,n)):(this.gutters[i].update(t),s.push(this.gutters[i]))}for(let t of this.gutters)t.dom.remove(),s.indexOf(t)<0&&t.destroy();for(let t of s)this.dom.appendChild(t.dom);this.gutters=s}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>Ts.scrollMargins.of((e=>{let i=e.plugin(t);return i&&0!=i.gutters.length&&i.fixed?e.textDirection==Wi.LTR?{left:i.dom.offsetWidth}:{right:i.dom.offsetWidth}:null}))});function io(t){return Array.isArray(t)?t:[t]}function no(t,e,i){for(;t.value&&t.from<=i;)t.from==i&&e.push(t.value),t.next()}class so{constructor(t,e,i){this.gutter=t,this.height=i,this.i=0,this.cursor=_t.iter(t.markers,e.from)}line(t,e,i){let n=[];no(this.cursor,n,e.from),i.length&&(n=n.concat(i));let s=this.gutter.config.lineMarker(t,e,n);s&&n.unshift(s);let r=this.gutter;if(0==n.length&&!r.config.renderEmptyElements)return;let o=e.top-this.height;if(this.i==r.elements.length){let i=new oo(t,e.height,o,n);r.elements.push(i),r.dom.appendChild(i.dom)}else r.elements[this.i].update(t,e.height,o,n);this.height=e.bottom,this.i++}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class ro{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,(n=>{let s,r=n.target;if(r!=this.dom&&this.dom.contains(r)){for(;r.parentNode!=this.dom;)r=r.parentNode;let t=r.getBoundingClientRect();s=(t.top+t.bottom)/2}else s=n.clientY;let o=t.lineBlockAtHeight(s-t.documentTop);e.domEventHandlers[i](t,o,n)&&n.preventDefault()}));this.markers=io(e.markers(t)),e.initialSpacer&&(this.spacer=new oo(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=io(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e])}let i=t.view.viewport;return!_t.eq(this.markers,e,i.from,i.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(t)}destroy(){for(let t of this.elements)t.destroy()}}class oo{constructor(t,e,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,n)}update(t,e,i,n){this.height!=e&&(this.dom.style.height=(this.height=e)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),function(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].compare(e[i]))return!1;return!0}(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let i="cm-gutterElement",n=this.dom.firstChild;for(let s=0,r=0;;){let o=r,a=s<e.length?e[s++]:null,l=!1;if(a){let t=a.elementClass;t&&(i+=" "+t);for(let t=r;t<this.markers.length;t++)if(this.markers[t].compare(a)){o=t,l=!0;break}}else o=this.markers.length;for(;r<o;){let t=this.markers[r++];if(t.toDOM){t.destroy(n);let e=n.nextSibling;n.remove(),n=e}}if(!a)break;a.toDOM&&(l?n=n.nextSibling:this.dom.insertBefore(a.toDOM(t),n)),l&&r++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}const ao=E.define(),lo=E.define({combine:t=>kt(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let i=Object.assign({},t);for(let t in e){let n=i[t],s=e[t];i[t]=n?(t,e,i)=>n(t,e,i)||s(t,e,i):s}return i}})});class ho extends Nr{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function co(t,e){return t.state.facet(lo).formatNumber(e,t.state)}const uo=Fr.compute([lo],(t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:t=>t.state.facet(ao),lineMarker:(t,e,i)=>i.some((t=>t.toDOM))?null:new ho(co(t,t.state.doc.lineAt(e.from).number)),lineMarkerChange:t=>t.startState.facet(lo)!=t.state.facet(lo),initialSpacer:t=>new ho(co(t,fo(t.state.doc.lines))),updateSpacer(t,e){let i=co(e.view,fo(e.view.state.doc.lines));return i==t.number?t:new ho(i)},domEventHandlers:t.facet(lo).domEventHandlers})));function fo(t){let e=9;for(;e<t;)e=10*e+9;return e}const po=1024;let Oo=0;class go{constructor(t,e){this.from=t,this.to=e}}class mo{constructor(t={}){this.id=Oo++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=vo.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}mo.closedBy=new mo({deserialize:t=>t.split(" ")}),mo.openedBy=new mo({deserialize:t=>t.split(" ")}),mo.group=new mo({deserialize:t=>t.split(" ")}),mo.contextHash=new mo({perNode:!0}),mo.lookAhead=new mo({perNode:!0}),mo.mounted=new mo({perNode:!0});class wo{constructor(t,e,i){this.tree=t,this.overlay=e,this.parser=i}}const bo=Object.create(null);class vo{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):bo,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new vo(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(mo.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(mo.group),n=-1;n<(i?i.length:0);n++){let s=e[n<0?t.name:i[n]];if(s)return s}}}}vo.none=new vo("",Object.create(null),0,8);class yo{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let e of t){let t=e(i);t&&(n||(n=Object.assign({},i.props)),n[t[0].id]=t[1])}e.push(n?new vo(i.name,n,i.id,i.flags):i)}return new yo(e)}}const So=new WeakMap,xo=new WeakMap;var ko;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(ko||(ko={}));class Qo{constructor(t,e,i,n,s){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,s&&s.length){this.props=Object.create(null);for(let[t,e]of s)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(mo.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new Vo(this.topNode,t)}cursorAt(t,e=0,i=0){let n=So.get(this)||this.topNode,s=new Vo(n);return s.moveTo(t,e),So.set(this,s._tree),s}get topNode(){return new Zo(this,0,0,null)}resolve(t,e=0){let i=Xo(So.get(this)||this.topNode,t,e,!1);return So.set(this,i),i}resolveInner(t,e=0){let i=Xo(xo.get(this)||this.topNode,t,e,!0);return xo.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:s=this.length}=t;for(let r=this.cursor((t.mode||0)|ko.IncludeAnonymous);;){let t=!1;if(r.from<=s&&r.to>=n&&(r.type.isAnonymous||!1!==e(r))){if(r.firstChild())continue;t=!0}for(;t&&i&&!r.type.isAnonymous&&i(r),!r.nextSibling();){if(!r.parent())return;t=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:Uo(vo.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new Qo(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new Qo(vo.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:s=po,reused:r=[],minRepeatType:o=n.types.length}=t,a=Array.isArray(i)?new $o(i,i.length):i,l=n.types,h=0,c=0;function d(t,e,i,m,w){let{id:b,start:v,end:y,size:S}=a,x=c;for(;S<0;){if(a.next(),-1==S){let e=r[b];return i.push(e),void m.push(v-t)}if(-3==S)return void(h=b);if(-4==S)return void(c=b);throw new RangeError(`Unrecognized record size: ${S}`)}let k,Q,$=l[b],P=v-t;if(y-v<=s&&(Q=O(a.pos-e,w))){let e=new Uint16Array(Q.size-Q.skip),i=a.pos-Q.size,s=e.length;for(;a.pos>i;)s=g(Q.start,e,s);k=new Po(e,y-Q.start,n),P=Q.start-t}else{let t=a.pos-S;a.next();let e=[],i=[],n=b>=o?b:-1,r=0,l=y;for(;a.pos>t;)n>=0&&a.id==n&&a.size>=0?(a.end<=l-s&&(f(e,i,v,r,a.end,l,n,x),r=e.length,l=a.end),a.next()):d(v,t,e,i,n);if(n>=0&&r>0&&r<e.length&&f(e,i,v,r,v,l,n,x),e.reverse(),i.reverse(),n>-1&&r>0){let t=u($);k=Uo($,e,i,0,e.length,0,y-v,t,t)}else k=p($,e,i,y-v,x-y)}i.push(k),m.push(P)}function u(t){return(e,i,n)=>{let s,r,o=0,a=e.length-1;if(a>=0&&(s=e[a])instanceof Qo){if(!a&&s.type==t&&s.length==n)return s;(r=s.prop(mo.lookAhead))&&(o=i[a]+s.length+r)}return p(t,e,i,n,o)}}function f(t,e,i,s,r,o,a,l){let h=[],c=[];for(;t.length>s;)h.push(t.pop()),c.push(e.pop()+i-r);t.push(p(n.types[a],h,c,o-r,l-o)),e.push(r-i)}function p(t,e,i,n,s=0,r){if(h){let t=[mo.contextHash,h];r=r?[t].concat(r):[t]}if(s>25){let t=[mo.lookAhead,s];r=r?[t].concat(r):[t]}return new Qo(t,e,i,n,r)}function O(t,e){let i=a.fork(),n=0,r=0,l=0,h=i.end-s,c={size:0,start:0,skip:0};t:for(let s=i.pos-t;i.pos>s;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=r,c.skip=l,l+=4,n+=4,i.next();continue}let a=i.pos-t;if(t<0||a<s||i.start<h)break;let d=i.id>=o?4:0,u=i.start;for(i.next();i.pos>a;){if(i.size<0){if(-3!=i.size)break t;d+=4}else i.id>=o&&(d+=4);i.next()}r=u,n+=t,l+=d}return(e<0||n==t)&&(c.size=n,c.start=r,c.skip=l),c.size>4?c:void 0}function g(t,e,i){let{id:n,start:s,end:r,size:l}=a;if(a.next(),l>=0&&n<o){let o=i;if(l>4){let n=a.pos-(l-4);for(;a.pos>n;)i=g(t,e,i)}e[--i]=o,e[--i]=r-t,e[--i]=s-t,e[--i]=n}else-3==l?h=n:-4==l&&(c=n);return i}let m=[],w=[];for(;a.pos>0;)d(t.start||0,t.bufferStart||0,m,w,-1);let b=null!==(e=t.length)&&void 0!==e?e:m.length?w[0]+m[0].length:0;return new Qo(l[t.topID],m.reverse(),w.reverse(),b)}(t)}}Qo.empty=new Qo(vo.none,[],[],0);class $o{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new $o(this.buffer,this.index)}}class Po{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return vo.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],s=n.name;if(/\W/.test(s)&&!n.isError&&(s=JSON.stringify(s)),i==(t+=4))return s;let r=[];for(;t<i;)r.push(this.childString(t)),t=this.buffer[t+3];return s+"("+r.join(",")+")"}findChild(t,e,i,n,s){let{buffer:r}=this,o=-1;for(let a=t;a!=e&&!(Co(s,n,r[a+1],r[a+2])&&(o=a,i>0));a=r[a+3]);return o}slice(t,e,i){let n=this.buffer,s=new Uint16Array(e-t),r=0;for(let o=t,a=0;o<e;){s[a++]=n[o++],s[a++]=n[o++]-i;let e=s[a++]=n[o++]-i;s[a++]=n[o++]-t,r=Math.max(r,e)}return new Po(s,r,this.set)}}function Co(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function _o(t,e){let i=t.childBefore(e);for(;i;){let e=i.lastChild;if(!e||e.to!=i.to)break;e.type.isError&&e.from==e.to?(t=i,i=e.prevSibling):i=e}return t}function Xo(t,e,i,n){for(var s;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof Zo&&t.index<0?null:t.parent;if(!e)return t;t=e}let r=n?0:ko.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof Zo&&n.index<0&&(null===(s=o.enter(e,i,r))||void 0===s?void 0:s.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,i,r);if(!n)return t;t=n}}class Zo{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,s=0){for(let r=this;;){for(let{children:o,positions:a}=r._tree,l=e>0?o.length:-1;t!=l;t+=e){let l=o[t],h=a[t]+r.from;if(Co(n,i,h,h+l.length))if(l instanceof Po){if(s&ko.ExcludeBuffers)continue;let o=l.findChild(0,l.buffer.length,e,i-h,n);if(o>-1)return new Eo(new Ro(r,l,t,h),null,o)}else if(s&ko.IncludeAnonymous||!l.type.isAnonymous||Mo(l)){let o;if(!(s&ko.IgnoreMounts)&&l.props&&(o=l.prop(mo.mounted))&&!o.overlay)return new Zo(o.tree,h,t,r);let a=new Zo(l,h,t,r);return s&ko.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(e<0?l.children.length-1:0,e,i,n)}}if(s&ko.IncludeAnonymous||!r.type.isAnonymous)return null;if(t=r.index>=0?r.index+e:e<0?-1:r._parent._tree.children.length,r=r._parent,!r)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&ko.IgnoreOverlays)&&(n=this._tree.prop(mo.mounted))&&n.overlay){let i=t-this.from;for(let{from:t,to:s}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?s>=i:s>i))return new Zo(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new Vo(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return Xo(this,t,e,!1)}resolveInner(t,e=0){return Xo(this,t,e,!0)}enterUnfinishedNodesBefore(t){return _o(this,t)}getChild(t,e=null,i=null){let n=Ao(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return Ao(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return To(this,t)}}function Ao(t,e,i,n){let s=t.cursor(),r=[];if(!s.firstChild())return r;if(null!=i)for(;!s.type.is(i);)if(!s.nextSibling())return r;for(;;){if(null!=n&&s.type.is(n))return r;if(s.type.is(e)&&r.push(s.node),!s.nextSibling())return null==n?r:[]}}function To(t,e,i=e.length-1){for(let n=t.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class Ro{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class Eo{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return s<0?null:new Eo(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&ko.ExcludeBuffers)return null;let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return s<0?null:new Eo(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new Eo(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new Eo(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new Vo(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,s=i.buffer[this.index+3];if(s>n){let r=i.buffer[this.index+1];t.push(i.slice(n,s,r)),e.push(0)}return new Qo(this.type,t,e,this.to-this.from)}resolve(t,e=0){return Xo(this,t,e,!1)}resolveInner(t,e=0){return Xo(this,t,e,!0)}enterUnfinishedNodesBefore(t){return _o(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=Ao(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return Ao(this,t,e,i)}get node(){return this}matchContext(t){return To(this,t)}}class Vo{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Zo)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof Zo?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,s=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(s<0)&&(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&ko.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ko.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&ko.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,s=t<0?-1:i._tree.children.length;n!=s;n+=t){let t=i._tree.children[n];if(this.mode&ko.IncludeAnonymous||t instanceof Po||!t.type.isAnonymous||Mo(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,s=this.stack.length;s>=0;){for(let r=t;r;r=r._parent)if(r.index==n){if(n==this.index)return r;e=r,i=s+1;break t}n=this.stack[--s]}for(let t=i;t<this.stack.length;t++)e=new Eo(this.buffer,e,this.stack[t]);return this.bufferNode=new Eo(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return To(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,s=this.stack.length-1;n>=0;s--){if(s<0)return To(this.node,t,n);let r=i[e.buffer[this.stack[s]]];if(!r.isAnonymous){if(t[n]&&t[n]!=r.name)return!1;n--}}return!0}}function Mo(t){return t.children.some((t=>t instanceof Po||!t.type.isAnonymous||Mo(t)))}const Do=new WeakMap;function Wo(t,e){if(!t.isAnonymous||e instanceof Po||e.type!=t)return 1;let i=Do.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof Qo)){i=1;break}i+=Wo(t,n)}Do.set(e,i)}return i}function Uo(t,e,i,n,s,r,o,a,l){let h=0;for(let i=n;i<s;i++)h+=Wo(t,e[i]);let c=Math.ceil(1.5*h/8),d=[],u=[];return function e(i,n,s,o,a){for(let h=s;h<o;){let s=h,f=n[h],p=Wo(t,i[h]);for(h++;h<o;h++){let e=Wo(t,i[h]);if(p+e>=c)break;p+=e}if(h==s+1){if(p>c){let t=i[s];e(t.children,t.positions,0,t.children.length,n[s]+a);continue}d.push(i[s])}else{let e=n[h-1]+i[h-1].length-f;d.push(Uo(t,i,n,s,h,f,e,null,l))}u.push(f+a-r)}}(e,i,n,s,0),(a||l)(d,u,o)}class Yo{constructor(){this.map=new WeakMap}setBuffer(t,e,i){let n=this.map.get(t);n||this.map.set(t,n=new Map),n.set(e,i)}getBuffer(t,e){let i=this.map.get(t);return i&&i.get(e)}set(t,e){t instanceof Eo?this.setBuffer(t.context.buffer,t.index,e):t instanceof Zo&&this.map.set(t.tree,e)}get(t){return t instanceof Eo?this.getBuffer(t.context.buffer,t.index):t instanceof Zo?this.map.get(t.tree):void 0}cursorSet(t,e){t.buffer?this.setBuffer(t.buffer.buffer,t.index,e):this.map.set(t.tree,e)}cursorGet(t){return t.buffer?this.getBuffer(t.buffer.buffer,t.index):this.map.get(t.tree)}}class qo{constructor(t,e,i,n,s=!1,r=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(s?1:0)|(r?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new qo(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],s=1,r=t.length?t[0]:null;for(let o=0,a=0,l=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-a>=i)for(;r&&r.from<c;){let e=r;if(a>=e.from||c<=e.to||l){let t=Math.max(e.from,a)-l,i=Math.min(e.to,c)-l;e=t>=i?null:new qo(t,i,e.tree,e.offset+l,o>0,!!h)}if(e&&n.push(e),r.to>c)break;r=s<t.length?t[s++]:null}if(!h)break;a=h.toA,l=h.toA-h.toB}return n}}class Lo{startParse(t,e,i){return"string"==typeof t&&(t=new zo(t)),i=i?i.length?i.map((t=>new go(t.from,t.to))):[new go(0,0)]:[new go(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}class zo{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}function Io(t){return(e,i,n,s)=>new Go(e,t,i,n,s)}class Bo{constructor(t,e,i,n,s){this.parser=t,this.parse=e,this.overlay=i,this.target=n,this.ranges=s}}class jo{constructor(t,e,i,n,s,r,o){this.parser=t,this.predicate=e,this.mounts=i,this.index=n,this.start=s,this.target=r,this.prev=o,this.depth=0,this.ranges=[]}}const No=new mo({perNode:!0});class Go{constructor(t,e,i,n,s){this.nest=e,this.input=i,this.fragments=n,this.ranges=s,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=t}advance(){if(this.baseParse){let t=this.baseParse.advance();if(!t)return null;if(this.baseParse=null,this.baseTree=t,this.startInner(),null!=this.stoppedAt)for(let t of this.inner)t.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let t=this.baseTree;return null!=this.stoppedAt&&(t=new Qo(t.type,t.children,t.positions,t.length,t.propValues.concat([[No,this.stoppedAt]]))),t}let t=this.inner[this.innerDone],e=t.parse.advance();if(e){this.innerDone++;let i=Object.assign(Object.create(null),t.target.props);i[mo.mounted.id]=new wo(e,t.overlay,t.parser),t.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let t=this.input.length;for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].ranges[0].from<t&&(t=Math.min(t,this.inner[e].parse.parsedPos));return t}stopAt(t){if(this.stoppedAt=t,this.baseParse)this.baseParse.stopAt(t);else for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].parse.stopAt(t)}startInner(){let t=new ta(this.fragments),e=null,i=null,n=new Vo(new Zo(this.baseTree,this.ranges[0].from,0,null),ko.IncludeAnonymous|ko.IgnoreMounts);t:for(let s,r;null==this.stoppedAt||n.from<this.stoppedAt;){let o,a=!0;if(t.hasNode(n)){if(e){let t=e.mounts.find((t=>t.frag.from<=n.from&&t.frag.to>=n.to&&t.mount.overlay));if(t)for(let i of t.mount.overlay){let s=i.from+t.pos,r=i.to+t.pos;s>=n.from&&r<=n.to&&!e.ranges.some((t=>t.from<r&&t.to>s))&&e.ranges.push({from:s,to:r})}}a=!1}else if(i&&(r=Ho(i.ranges,n.from,n.to)))a=2!=r;else if(!n.type.isAnonymous&&n.from<n.to&&(s=this.nest(n,this.input))){n.tree||Jo(n);let r=t.findMounts(n.from,s.parser);if("function"==typeof s.overlay)e=new jo(s.parser,s.overlay,r,this.inner.length,n.from,n.tree,e);else{let t=ea(this.ranges,s.overlay||[new go(n.from,n.to)]);t.length&&this.inner.push(new Bo(s.parser,s.parser.startParse(this.input,na(r,t),t),s.overlay?s.overlay.map((t=>new go(t.from-n.from,t.to-n.from))):null,n.tree,t)),s.overlay?t.length&&(i={ranges:t,depth:0,prev:i}):a=!1}}else e&&(o=e.predicate(n))&&(!0===o&&(o=new go(n.from,n.to)),o.from<o.to&&e.ranges.push(o));if(a&&n.firstChild())e&&e.depth++,i&&i.depth++;else for(;!n.nextSibling();){if(!n.parent())break t;if(e&&! --e.depth){let t=ea(this.ranges,e.ranges);t.length&&this.inner.splice(e.index,0,new Bo(e.parser,e.parser.startParse(this.input,na(e.mounts,t),t),e.ranges.map((t=>new go(t.from-e.start,t.to-e.start))),e.target,t)),e=e.prev}i&&! --i.depth&&(i=i.prev)}}}}function Ho(t,e,i){for(let n of t){if(n.from>=i)break;if(n.to>e)return n.from<=e&&n.to>=i?2:1}return 0}function Fo(t,e,i,n,s,r){if(e<i){let o=t.buffer[e+1];n.push(t.slice(e,i,o)),s.push(o-r)}}function Jo(t){let{node:e}=t,i=0;do{t.parent(),i++}while(!t.tree);let n=0,s=t.tree,r=0;for(;r=s.positions[n]+t.from,!(r<=e.from&&r+s.children[n].length>=e.to);n++);let o=s.children[n],a=o.buffer;s.children[n]=function t(i,n,s,l,h){let c=i;for(;a[c+2]+r<=e.from;)c=a[c+3];let d=[],u=[];Fo(o,i,c,d,u,l);let f=a[c+1],p=a[c+2],O=f+r==e.from&&p+r==e.to&&a[c]==e.type.id;return d.push(O?e.toTree():t(c+4,a[c+3],o.set.types[a[c]],f,p-f)),u.push(f-l),Fo(o,a[c+3],n,d,u,l),new Qo(s,d,u,h)}(0,a.length,vo.none,0,o.length);for(let n=0;n<=i;n++)t.childAfter(e.from)}class Ko{constructor(t,e){this.offset=e,this.done=!1,this.cursor=t.cursor(ko.IncludeAnonymous|ko.IgnoreMounts)}moveTo(t){let{cursor:e}=this,i=t-this.offset;for(;!this.done&&e.from<i;)e.to>=t&&e.enter(i,1,ko.IgnoreOverlays|ko.ExcludeBuffers)||e.next(!1)||(this.done=!0)}hasNode(t){if(this.moveTo(t.from),!this.done&&this.cursor.from+this.offset==t.from&&this.cursor.tree)for(let e=this.cursor.tree;;){if(e==t.tree)return!0;if(!(e.children.length&&0==e.positions[0]&&e.children[0]instanceof Qo))break;e=e.children[0]}return!1}}let ta=class{constructor(t){var e;if(this.fragments=t,this.curTo=0,this.fragI=0,t.length){let i=this.curFrag=t[0];this.curTo=null!==(e=i.tree.prop(No))&&void 0!==e?e:i.to,this.inner=new Ko(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(t){for(;this.curFrag&&t.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=t.from&&this.curTo>=t.to&&this.inner.hasNode(t)}nextFrag(){var t;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let e=this.curFrag=this.fragments[this.fragI];this.curTo=null!==(t=e.tree.prop(No))&&void 0!==t?t:e.to,this.inner=new Ko(e.tree,-e.offset)}}findMounts(t,e){var i;let n=[];if(this.inner){this.inner.cursor.moveTo(t,1);for(let t=this.inner.cursor.node;t;t=t.parent){let s=null===(i=t.tree)||void 0===i?void 0:i.prop(mo.mounted);if(s&&s.parser==e)for(let e=this.fragI;e<this.fragments.length;e++){let i=this.fragments[e];if(i.from>=t.to)break;i.tree==this.curFrag.tree&&n.push({frag:i,pos:t.from-i.offset,mount:s})}}}return n}};function ea(t,e){let i=null,n=e;for(let s=1,r=0;s<t.length;s++){let o=t[s-1].to,a=t[s].from;for(;r<n.length;r++){let t=n[r];if(t.from>=a)break;t.to<=o||(i||(n=i=e.slice()),t.from<o?(i[r]=new go(t.from,o),t.to>a&&i.splice(r+1,0,new go(a,t.to))):t.to>a?i[r--]=new go(a,t.to):i.splice(r--,1))}}return n}function ia(t,e,i,n){let s=0,r=0,o=!1,a=!1,l=-1e9,h=[];for(;;){let c=s==t.length?1e9:o?t[s].to:t[s].from,d=r==e.length?1e9:a?e[r].to:e[r].from;if(o!=a){let t=Math.max(l,i),e=Math.min(c,d,n);t<e&&h.push(new go(t,e))}if(l=Math.min(c,d),1e9==l)break;c==l&&(o?(o=!1,s++):o=!0),d==l&&(a?(a=!1,r++):a=!0)}return h}function na(t,e){let i=[];for(let{pos:n,mount:s,frag:r}of t){let t=n+(s.overlay?s.overlay[0].from:0),o=t+s.tree.length,a=Math.max(r.from,t),l=Math.min(r.to,o);if(s.overlay){let o=ia(e,s.overlay.map((t=>new go(t.from+n,t.to+n))),a,l);for(let e=0,n=a;;e++){let a=e==o.length,h=a?l:o[e].from;if(h>n&&i.push(new qo(n,h,s.tree,-t,r.from>=n||r.openStart,r.to<=h||r.openEnd)),a)break;n=o[e].to}}else i.push(new qo(a,l,s.tree,-t,r.from>=t||r.openStart,r.to<=o||r.openEnd))}return i}let sa=0;class ra{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=sa++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new ra([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new aa;return e=>e.modified.indexOf(t)>-1?e:aa.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let oa=0;class aa{constructor(){this.instances=[],this.id=oa++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,s=i.modified,n.length==s.length&&n.every(((t,e)=>t==s[e])));var n,s}));if(i)return i;let n=[],s=new ra(n,t,e);for(let t of e)t.instances.push(s);let r=function(t){let e=[[]];for(let i=0;i<t.length;i++)for(let n=0,s=e.length;n<s;n++)e.push(e[n].concat(t[i]));return e.sort(((t,e)=>e.length-t.length))}(e);for(let e of t.set)if(!e.modified.length)for(let t of r)n.push(aa.get(e,t));return s}}function la(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],s=2,r=t;for(let e=0;;){if("..."==r&&e>0&&e+3==t.length){s=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(r);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){s=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);r=t.slice(e)}let o=i.length-1,a=i[o];if(!a)throw new RangeError("Invalid path: "+t);let l=new ca(n,s,o>0?i.slice(0,o):null);e[a]=l.sort(e[a])}}return ha.add(e)}const ha=new mo;class ca{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}function da(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:s=null}=e||{};return{style:t=>{let e=s;for(let n of t)for(let t of n.set){let n=i[t.id];if(n){e=e?e+" "+n:n;break}}return e},scope:n}}function ua(t,e,i,n=0,s=t.length){let r=new fa(n,Array.isArray(e)?e:[e],i);r.highlightRange(t.cursor(),n,s,"",r.highlighters),r.flush(s)}ca.empty=new ca([],2,null);class fa{constructor(t,e,i){this.at=t,this.highlighters=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,n,s){let{type:r,from:o,to:a}=t;if(o>=i||a<=e)return;r.isTop&&(s=this.highlighters.filter((t=>!t.scope||t.scope(r))));let l=n,h=function(t){let e=t.type.prop(ha);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}(t)||ca.empty,c=function(t,e){let i=null;for(let n of t){let t=n.style(e);t&&(i=i?i+" "+t:t)}return i}(s,h.tags);if(c&&(l&&(l+=" "),l+=c,1==h.mode&&(n+=(n?" ":"")+c)),this.startSpan(t.from,l),h.opaque)return;let d=t.tree&&t.tree.prop(mo.mounted);if(d&&d.overlay){let r=t.node.enter(d.overlay[0].from+o,1),h=this.highlighters.filter((t=>!t.scope||t.scope(d.tree.type))),c=t.firstChild();for(let u=0,f=o;;u++){let p=u<d.overlay.length?d.overlay[u]:null,O=p?p.from+o:a,g=Math.max(e,f),m=Math.min(i,O);if(g<m&&c)for(;t.from<m&&(this.highlightRange(t,g,m,n,s),this.startSpan(Math.min(m,t.to),l),!(t.to>=O)&&t.nextSibling()););if(!p||O>i)break;f=p.to+o,f>e&&(this.highlightRange(r.cursor(),Math.max(e,p.from+o),Math.min(i,f),n,h),this.startSpan(f,l))}c&&t.parent()}else if(t.firstChild()){do{if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,n,s),this.startSpan(Math.min(i,t.to),l)}}while(t.nextSibling());t.parent()}}}const pa=ra.define,Oa=pa(),ga=pa(),ma=pa(ga),wa=pa(ga),ba=pa(),va=pa(ba),ya=pa(ba),Sa=pa(),xa=pa(Sa),ka=pa(),Qa=pa(),$a=pa(),Pa=pa($a),Ca=pa(),_a={comment:Oa,lineComment:pa(Oa),blockComment:pa(Oa),docComment:pa(Oa),name:ga,variableName:pa(ga),typeName:ma,tagName:pa(ma),propertyName:wa,attributeName:pa(wa),className:pa(ga),labelName:pa(ga),namespace:pa(ga),macroName:pa(ga),literal:ba,string:va,docString:pa(va),character:pa(va),attributeValue:pa(va),number:ya,integer:pa(ya),float:pa(ya),bool:pa(ba),regexp:pa(ba),escape:pa(ba),color:pa(ba),url:pa(ba),keyword:ka,self:pa(ka),null:pa(ka),atom:pa(ka),unit:pa(ka),modifier:pa(ka),operatorKeyword:pa(ka),controlKeyword:pa(ka),definitionKeyword:pa(ka),moduleKeyword:pa(ka),operator:Qa,derefOperator:pa(Qa),arithmeticOperator:pa(Qa),logicOperator:pa(Qa),bitwiseOperator:pa(Qa),compareOperator:pa(Qa),updateOperator:pa(Qa),definitionOperator:pa(Qa),typeOperator:pa(Qa),controlOperator:pa(Qa),punctuation:$a,separator:pa($a),bracket:Pa,angleBracket:pa(Pa),squareBracket:pa(Pa),paren:pa(Pa),brace:pa(Pa),content:Sa,heading:xa,heading1:pa(xa),heading2:pa(xa),heading3:pa(xa),heading4:pa(xa),heading5:pa(xa),heading6:pa(xa),contentSeparator:pa(Sa),list:pa(Sa),quote:pa(Sa),emphasis:pa(Sa),strong:pa(Sa),link:pa(Sa),monospace:pa(Sa),strikethrough:pa(Sa),inserted:pa(),deleted:pa(),changed:pa(),invalid:pa(),meta:Ca,documentMeta:pa(Ca),annotation:pa(Ca),processingInstruction:pa(Ca),definition:ra.defineModifier(),constant:ra.defineModifier(),function:ra.defineModifier(),standard:ra.defineModifier(),local:ra.defineModifier(),special:ra.defineModifier()};var Xa;da([{tag:_a.link,class:"tok-link"},{tag:_a.heading,class:"tok-heading"},{tag:_a.emphasis,class:"tok-emphasis"},{tag:_a.strong,class:"tok-strong"},{tag:_a.keyword,class:"tok-keyword"},{tag:_a.atom,class:"tok-atom"},{tag:_a.bool,class:"tok-bool"},{tag:_a.url,class:"tok-url"},{tag:_a.labelName,class:"tok-labelName"},{tag:_a.inserted,class:"tok-inserted"},{tag:_a.deleted,class:"tok-deleted"},{tag:_a.literal,class:"tok-literal"},{tag:_a.string,class:"tok-string"},{tag:_a.number,class:"tok-number"},{tag:[_a.regexp,_a.escape,_a.special(_a.string)],class:"tok-string2"},{tag:_a.variableName,class:"tok-variableName"},{tag:_a.local(_a.variableName),class:"tok-variableName tok-local"},{tag:_a.definition(_a.variableName),class:"tok-variableName tok-definition"},{tag:_a.special(_a.variableName),class:"tok-variableName2"},{tag:_a.definition(_a.propertyName),class:"tok-propertyName tok-definition"},{tag:_a.typeName,class:"tok-typeName"},{tag:_a.namespace,class:"tok-namespace"},{tag:_a.className,class:"tok-className"},{tag:_a.macroName,class:"tok-macroName"},{tag:_a.propertyName,class:"tok-propertyName"},{tag:_a.operator,class:"tok-operator"},{tag:_a.comment,class:"tok-comment"},{tag:_a.meta,class:"tok-meta"},{tag:_a.invalid,class:"tok-invalid"},{tag:_a.punctuation,class:"tok-punctuation"}]);const Za=new mo;function Aa(t){return E.define({combine:t?e=>e.concat(t):void 0})}const Ta=new mo;class Ra{constructor(t,e,i=[],n=""){this.data=t,this.name=n,xt.prototype.hasOwnProperty("tree")||Object.defineProperty(xt.prototype,"tree",{get(){return Ma(this)}}),this.parser=e,this.extension=[Ba.of(this),xt.languageData.of(((t,e,i)=>{let n=Ea(t,e,i),s=n.type.prop(Za);if(!s)return[];let r=t.facet(s),o=n.type.prop(Ta);if(o){let s=n.resolve(e-n.from,i);for(let e of o)if(e.test(s,t)){let i=t.facet(e.facet);return"replace"==e.type?i:i.concat(r)}}return r}))].concat(i)}isActiveAt(t,e,i=-1){return Ea(t,e,i).type.prop(Za)==this.data}findRegions(t){let e=t.facet(Ba);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(t,e)=>{if(t.prop(Za)==this.data)return void i.push({from:e,to:e+t.length});let s=t.prop(mo.mounted);if(s){if(s.tree.prop(Za)==this.data){if(s.overlay)for(let t of s.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(s.overlay){let t=i.length;if(n(s.tree,s.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let s=t.children[i];s instanceof Qo&&n(s,t.positions[i]+e)}};return n(Ma(t),0),i}get allowsNesting(){return!0}}function Ea(t,e,i){let n=t.facet(Ba),s=Ma(t).topNode;if(!n||n.allowsNesting)for(let t=s;t;t=t.enter(e,i,ko.ExcludeBuffers))t.type.isTop&&(s=t);return s}Ra.setState=dt.define();class Va extends Ra{constructor(t,e,i){super(t,e,[],i),this.parser=e}static define(t){let e=Aa(t.languageData);return new Va(e,t.parser.configure({props:[Za.add((t=>t.isTop?e:void 0))]}),t.name)}configure(t,e){return new Va(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ma(t){let e=t.field(Ra.state,!1);return e?e.tree:Qo.empty}class Da{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let Wa=null;class Ua{constructor(t,e,i=[],n,s,r,o,a){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=s,this.viewport=r,this.skipped=o,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new Ua(t,e,[],Qo.empty,0,i,[],null)}startParse(){return this.parser.startParse(new Da(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=Qo.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var i;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(qo.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(qo.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=Wa;Wa=this;try{return t()}finally{Wa=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=Ya(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:s,viewport:r,skipped:o}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,i,n,s)=>e.push({fromA:t,toA:i,fromB:n,toB:s}))),i=qo.applyChanges(i,e),n=Qo.empty,s=0,r={from:t.mapPos(r.from,-1),to:t.mapPos(r.to,1)},this.skipped.length){o=[];for(let e of this.skipped){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&o.push({from:i,to:n})}}}return new Ua(this.parser,e,i,n,s,r,o,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=Ya(this.fragments,i,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends Lo{createParse(e,i,n){let s=n[0].from,r=n[n.length-1].to;return{parsedPos:s,advance(){let e=Wa;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=r,new Qo(vo.none,[],[],r-s)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return Wa}}function Ya(t,e,i){return qo.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class qa{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new qa(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=Ua.create(t.facet(Ba).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new qa(i)}}Ra.state=q.define({create:qa.init,update(t,e){for(let t of e.effects)if(t.is(Ra.setState))return t.value;return e.startState.facet(Ba)!=e.state.facet(Ba)?qa.init(e.state):t.apply(e)}});let La=t=>{let e=setTimeout((()=>t()),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(La=t=>{let e=-1,i=setTimeout((()=>{e=requestIdleCallback(t,{timeout:400})}),100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const za="undefined"!=typeof navigator&&(null===(Xa=navigator.scheduling)||void 0===Xa?void 0:Xa.isInputPending)?()=>navigator.scheduling.isInputPending():null,Ia=_i.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(Ra.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(Ra.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=La(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,s=i.field(Ra.state);if(s.tree==s.context.tree&&s.context.isDone(n+1e5))return;let r=Date.now()+Math.min(this.chunkBudget,100,t&&!za?Math.max(25,t.timeRemaining()-5):1e9),o=s.context.treeLen<n&&i.doc.length>n+1e3,a=s.context.work((()=>za&&za()||Date.now()>r),n+(o?0:1e5));this.chunkBudget-=Date.now()-e,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Ra.setState.of(new qa(s.context))})),this.chunkBudget>0&&(!a||o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then((()=>this.scheduleWork())).catch((t=>Qi(this.view.state,t))).then((()=>this.workScheduled--)),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ba=E.define({combine:t=>t.length?t[0]:null,enables:t=>[Ra.state,Ia,Ts.contentAttributes.compute([t],(e=>{let i=e.facet(t);return i&&i.name?{"data-language":i.name}:{}}))]});class ja{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}class Na{constructor(t,e,i,n,s,r=void 0){this.name=t,this.alias=e,this.extensions=i,this.filename=n,this.loadFunc=s,this.support=r,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then((t=>this.support=t),(t=>{throw this.loading=null,t})))}static of(t){let{load:e,support:i}=t;if(!e){if(!i)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");e=()=>Promise.resolve(i)}return new Na(t.name,(t.alias||[]).concat(t.name).map((t=>t.toLowerCase())),t.extensions||[],t.filename,e,i)}static matchFilename(t,e){for(let i of t)if(i.filename&&i.filename.test(e))return i;let i=/\.([^.]+)$/.exec(e);if(i)for(let e of t)if(e.extensions.indexOf(i[1])>-1)return e;return null}static matchLanguageName(t,e,i=!0){e=e.toLowerCase();for(let i of t)if(i.alias.some((t=>t==e)))return i;if(i)for(let i of t)for(let t of i.alias){let n=e.indexOf(t);if(n>-1&&(t.length>2||!/\w/.test(e[n-1])&&!/\w/.test(e[n+t.length])))return i}return null}}const Ga=E.define(),Ha=E.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some((t=>t!=e[0])))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function Fa(t){let e=t.facet(Ha);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function Ja(t,e){let i="",n=t.tabSize,s=t.facet(Ha)[0];if("\t"==s){for(;e>=n;)i+="\t",e-=n;s=" "}for(let t=0;t<e;t++)i+=s;return i}function Ka(t,e){t instanceof xt&&(t=new tl(t));for(let i of t.state.facet(Ga)){let n=i(t,e);if(void 0!==n)return n}let i=Ma(t.state);return i?function(t,e,i){return nl(e.resolveInner(i).enterUnfinishedNodesBefore(i),i,t)}(t,i,e):null}class tl{constructor(t,e={}){this.state=t,this.options=e,this.unit=Fa(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:s}=this.options;return null!=n&&n>=i.from&&n<=i.to?s&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),s=this.countColumn(i,t-n),r=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return r>-1&&(s+=r-this.countColumn(i,i.search(/\S|$/))),s}countColumn(t,e=t.length){return Yt(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),s=this.options.overrideIndentation;if(s){let t=s(n);if(t>-1)return t}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const el=new mo;function il(t){let e=t.type.prop(el);if(e)return e;let i,n=t.firstChild;if(n&&(i=n.type.prop(mo.closedBy))){let e=t.lastChild,n=e&&i.indexOf(e.name)>-1;return t=>ll(t,!0,1,void 0,n&&!function(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}(t)?e.from:void 0)}return null==t.parent?sl:null}function nl(t,e,i){for(;t;t=t.parent){let n=il(t);if(n)return n(rl.create(i,e,t))}return null}function sl(){return 0}class rl extends tl{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.node=i}static create(t,e,i){return new rl(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let t=this.state.doc.lineAt(this.node.from);for(;;){let e=this.node.resolve(t.from);for(;e.parent&&e.parent.from==e.from;)e=e.parent;if(ol(e,this.node))break;t=this.state.doc.lineAt(e.from)}return this.lineIndent(t.from)}continue(){let t=this.node.parent;return t?nl(t,this.pos,this.base):0}}function ol(t,e){for(let i=e;i;i=i.parent)if(t==i)return!0;return!1}function al({closing:t,align:e=!0,units:i=1}){return n=>ll(n,e,i,t)}function ll(t,e,i,n,s){let r=t.textAfter,o=r.match(/^\s*/)[0].length,a=n&&r.slice(o,o+n.length)==n||s==t.pos+o,l=e?function(t){let e=t.node,i=e.childAfter(e.from),n=e.lastChild;if(!i)return null;let s=t.options.simulateBreak,r=t.state.doc.lineAt(i.from),o=null==s||s<=r.from?r.to:Math.min(r.to,s);for(let t=i.to;;){let s=e.childAfter(t);if(!s||s==n)return null;if(!s.type.isSkipped)return s.from<o?i:null;t=s.to}}(t):null;return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*i)}function hl({except:t,units:e=1}={}){return i=>{let n=t&&t.test(i.textAfter);return i.baseIndent+(n?0:e*i.unit)}}function cl(){return xt.transactionFilter.of((t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let i=t.newDoc,{head:n}=t.newSelection.main,s=i.lineAt(n);if(n>s.from+200)return t;let r=i.sliceString(s.from,n);if(!e.some((t=>t.test(r))))return t;let{state:o}=t,a=-1,l=[];for(let{head:t}of o.selection.ranges){let e=o.doc.lineAt(t);if(e.from==a)continue;a=e.from;let i=Ka(o,e.from);if(null==i)continue;let n=/^\s*/.exec(e.text)[0],s=Ja(o,i);n!=s&&l.push({from:e.from,to:e.from+n.length,insert:s})}return l.length?[t,{changes:l,sequential:!0}]:t}))}const dl=E.define(),ul=new mo;function fl(t){let e=t.firstChild,i=t.lastChild;return e&&e.to<i.from?{from:e.to,to:i.type.isError?t.to:i.from}:null}function pl(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function Ol(t,e,i){for(let n of t.facet(dl)){let s=n(t,e,i);if(s)return s}return function(t,e,i){let n=Ma(t);if(n.length<i)return null;let s=null;for(let r=n.resolveInner(i,1);r;r=r.parent){if(r.to<=i||r.from>i)continue;if(s&&r.from<e)break;let o=r.type.prop(ul);if(o&&(r.to<n.length-50||n.length==t.doc.length||!pl(r))){let n=o(r,t);n&&n.from<=i&&n.from>=e&&n.to>i&&(s=n)}}return s}(t,e,i)}function gl(t,e){let i=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return i>=n?void 0:{from:i,to:n}}const ml=dt.define({map:gl}),wl=dt.define({map:gl}),bl=q.define({create:()=>ni.none,update(t,e){t=t.map(e.changes);for(let i of e.effects)i.is(ml)&&!yl(t,i.value.from,i.value.to)?t=t.update({add:[Ql.range(i.value.from,i.value.to)]}):i.is(wl)&&(t=t.update({filter:(t,e)=>i.value.from!=t||i.value.to!=e,filterFrom:i.value.from,filterTo:i.value.to}));if(e.selection){let i=!1,{head:n}=e.selection.main;t.between(n,n,((t,e)=>{t<n&&e>n&&(i=!0)})),i&&(t=t.update({filterFrom:n,filterTo:n,filter:(t,e)=>e<=n||t>=n}))}return t},provide:t=>Ts.decorations.from(t),toJSON(t,e){let i=[];return t.between(0,e.doc.length,((t,e)=>{i.push(t,e)})),i},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let i=0;i<t.length;){let n=t[i++],s=t[i++];if("number"!=typeof n||"number"!=typeof s)throw new RangeError("Invalid JSON for fold state");e.push(Ql.range(n,s))}return ni.set(e,!0)}});function vl(t,e,i){var n;let s=null;return null===(n=t.field(bl,!1))||void 0===n||n.between(e,i,((t,e)=>{(!s||s.from>t)&&(s={from:t,to:e})})),s}function yl(t,e,i){let n=!1;return t.between(e,e,((t,s)=>{t==e&&s==i&&(n=!0)})),n}const Sl={placeholderDOM:null,placeholderText:"…"},xl=E.define({combine:t=>kt(t,Sl)});function kl(t){let e=[bl,Cl];return t&&e.push(xl.of(t)),e}const Ql=ni.replace({widget:new class extends ei{toDOM(t){let{state:e}=t,i=e.facet(xl),n=e=>{let i=t.lineBlockAt(t.posAtDOM(e.target)),n=vl(t.state,i.from,i.to);n&&t.dispatch({effects:wl.of(n)}),e.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(t,n);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",e.phrase("folded code")),s.title=e.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=n,s}}}),$l={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Pl extends Nr{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}const Cl=Ts.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class _l{constructor(t,e){let i;function n(t){let e=It.newName();return(i||(i=Object.create(null)))["."+e]=t,e}this.specs=t;const s="string"==typeof e.all?e.all:e.all?n(e.all):void 0,r=e.scope;this.scope=r instanceof Ra?t=>t.prop(Za)==r.data:r?t=>t==r:void 0,this.style=da(t.map((t=>({tag:t.tag,class:t.class||n(Object.assign({},t,{tag:null}))}))),{all:s}).style,this.module=i?new It(i):null,this.themeType=e.themeType}static define(t,e){return new _l(t,e||{})}}const Xl=E.define(),Zl=E.define({combine:t=>t.length?[t[0]]:null});function Al(t){let e=t.facet(Xl);return e.length?e:t.facet(Zl)}function Tl(t,e){let i,n=[El];return t instanceof _l&&(t.module&&n.push(Ts.styleModule.of(t.module)),i=t.themeType),(null==e?void 0:e.fallback)?n.push(Zl.of(t)):i?n.push(Xl.computeN([Ts.darkTheme],(e=>e.facet(Ts.darkTheme)==("dark"==i)?[t]:[]))):n.push(Xl.of(t)),n}class Rl{constructor(t){this.markCache=Object.create(null),this.tree=Ma(t.state),this.decorations=this.buildDeco(t,Al(t.state))}update(t){let e=Ma(t.state),i=Al(t.state),n=i!=Al(t.startState);e.length<t.view.viewport.to&&!n&&e.type==this.tree.type?this.decorations=this.decorations.map(t.changes):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i))}buildDeco(t,e){if(!e||!this.tree.length)return ni.none;let i=new Xt;for(let{from:n,to:s}of t.visibleRanges)ua(this.tree,e,((t,e,n)=>{i.add(t,e,this.markCache[n]||(this.markCache[n]=ni.mark({class:n})))}),n,s);return i.finish()}}const El=N.high(_i.fromClass(Rl,{decorations:t=>t.decorations})),Vl=_l.define([{tag:_a.meta,color:"#404740"},{tag:_a.link,textDecoration:"underline"},{tag:_a.heading,textDecoration:"underline",fontWeight:"bold"},{tag:_a.emphasis,fontStyle:"italic"},{tag:_a.strong,fontWeight:"bold"},{tag:_a.strikethrough,textDecoration:"line-through"},{tag:_a.keyword,color:"#708"},{tag:[_a.atom,_a.bool,_a.url,_a.contentSeparator,_a.labelName],color:"#219"},{tag:[_a.literal,_a.inserted],color:"#164"},{tag:[_a.string,_a.deleted],color:"#a11"},{tag:[_a.regexp,_a.escape,_a.special(_a.string)],color:"#e40"},{tag:_a.definition(_a.variableName),color:"#00f"},{tag:_a.local(_a.variableName),color:"#30a"},{tag:[_a.typeName,_a.namespace],color:"#085"},{tag:_a.className,color:"#167"},{tag:[_a.special(_a.variableName),_a.macroName],color:"#256"},{tag:_a.definition(_a.propertyName),color:"#00c"},{tag:_a.comment,color:"#940"},{tag:_a.invalid,color:"#f00"}]),Ml=Ts.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Dl=1e4,Wl="()[]{}",Ul=E.define({combine:t=>kt(t,{afterCursor:!0,brackets:Wl,maxScanDistance:Dl,renderMatch:Ll})}),Yl=ni.mark({class:"cm-matchingBracket"}),ql=ni.mark({class:"cm-nonmatchingBracket"});function Ll(t){let e=[],i=t.matched?Yl:ql;return e.push(i.range(t.start.from,t.start.to)),t.end&&e.push(i.range(t.end.from,t.end.to)),e}const zl=q.define({create:()=>ni.none,update(t,e){if(!e.docChanged&&!e.selection)return t;let i=[],n=e.state.facet(Ul);for(let t of e.state.selection.ranges){if(!t.empty)continue;let s=Hl(e.state,t.head,-1,n)||t.head>0&&Hl(e.state,t.head-1,1,n)||n.afterCursor&&(Hl(e.state,t.head,1,n)||t.head<e.state.doc.length&&Hl(e.state,t.head+1,-1,n));s&&(i=i.concat(n.renderMatch(s,e.state)))}return ni.set(i,!0)},provide:t=>Ts.decorations.from(t)}),Il=[zl,Ml];function Bl(t={}){return[Ul.of(t),Il]}const jl=new mo;function Nl(t,e,i){let n=t.prop(e<0?mo.openedBy:mo.closedBy);if(n)return n;if(1==t.name.length){let n=i.indexOf(t.name);if(n>-1&&n%2==(e<0?1:0))return[i[n+e]]}return null}function Gl(t){let e=t.type.prop(jl);return e?e(t.node):t}function Hl(t,e,i,n={}){let s=n.maxScanDistance||Dl,r=n.brackets||Wl,o=Ma(t),a=o.resolveInner(e,i);for(let n=a;n;n=n.parent){let s=Nl(n.type,i,r);if(s&&n.from<n.to){let o=Gl(n);if(o&&(i>0?e>=o.from&&e<o.to:e>o.from&&e<=o.to))return Fl(t,e,i,n,o,s,r)}}return function(t,e,i,n,s,r,o){let a=i<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=i>0)return null;let h={from:i<0?e-1:e,to:i>0?e+1:e},c=t.doc.iterRange(e,i>0?t.doc.length:0),d=0;for(let t=0;!c.next().done&&t<=r;){let r=c.value;i<0&&(t+=r.length);let a=e+t*i;for(let t=i>0?0:r.length-1,e=i>0?r.length:-1;t!=e;t+=i){let e=o.indexOf(r[t]);if(!(e<0||n.resolveInner(a+t,1).type!=s))if(e%2==0==i>0)d++;else{if(1==d)return{start:h,end:{from:a+t,to:a+t+1},matched:e>>1==l>>1};d--}}i>0&&(t+=r.length)}return c.done?{start:h,matched:!1}:null}(t,e,i,o,a.type,s,r)}function Fl(t,e,i,n,s,r,o){let a=n.parent,l={from:s.from,to:s.to},h=0,c=null==a?void 0:a.cursor();if(c&&(i<0?c.childBefore(n.from):c.childAfter(n.to)))do{if(i<0?c.to<=n.from:c.from>=n.to){if(0==h&&r.indexOf(c.type.name)>-1&&c.from<c.to){let t=Gl(c);return{start:l,end:t?{from:t.from,to:t.to}:void 0,matched:!0}}if(Nl(c.type,i,o))h++;else if(Nl(c.type,-i,o)){if(0==h){let t=Gl(c);return{start:l,end:t&&t.from<t.to?{from:t.from,to:t.to}:void 0,matched:!1}}h--}}}while(i<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function Jl(t,e,i,n=0,s=0){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);let r=s;for(let s=n;s<e;s++)9==t.charCodeAt(s)?r+=i-r%i:r++;return r}class Kl{constructor(t,e,i,n){this.string=t,this.tabSize=e,this.indentUnit=i,this.overrideIndent=n,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(t){let e,i=this.string.charAt(this.pos);if(e="string"==typeof t?i==t:i&&(t instanceof RegExp?t.test(i):t(i)),e)return++this.pos,i}eatWhile(t){let e=this.pos;for(;this.eat(t););return this.pos>e}eatSpace(){let t=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t}skipToEnd(){this.pos=this.string.length}skipTo(t){let e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0}backUp(t){this.pos-=t}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Jl(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var t;return null!==(t=this.overrideIndent)&&void 0!==t?t:Jl(this.string,null,this.tabSize)}match(t,e,i){if("string"==typeof t){let n=t=>i?t.toLowerCase():t;return n(this.string.substr(this.pos,t.length))==n(t)?(!1!==e&&(this.pos+=t.length),!0):null}{let i=this.string.slice(this.pos).match(t);return i&&i.index>0?null:(i&&!1!==e&&(this.pos+=i[0].length),i)}}current(){return this.string.slice(this.start,this.pos)}}function th(t){if("object"!=typeof t)return t;let e={};for(let i in t){let n=t[i];e[i]=n instanceof Array?n.slice():n}return e}const eh=new WeakMap;class ih extends Ra{constructor(t){let e,i=Aa(t.languageData),n={name:(s=t).name||"",token:s.token,blankLine:s.blankLine||(()=>{}),startState:s.startState||(()=>!0),copyState:s.copyState||th,indent:s.indent||(()=>null),languageData:s.languageData||{},tokenTable:s.tokenTable||ah};var s;super(i,new class extends Lo{createParse(t,i,n){return new rh(e,t,i,n)}},[Ga.of(((t,e)=>this.getIndent(t,e)))],t.name),this.topNode=function(t){let e=vo.define({id:lh.length,name:"Document",props:[Za.add((()=>t))]});return lh.push(e),e}(i),e=this,this.streamParser=n,this.stateAfter=new mo({perNode:!0}),this.tokenTable=t.tokenTable?new uh(n.tokenTable):fh}static define(t){return new ih(t)}getIndent(t,e){let i,n=Ma(t.state),s=n.resolve(e);for(;s&&s.type!=this.topNode;)s=s.parent;if(!s)return null;let{overrideIndentation:r}=t.options;r&&(i=eh.get(t.state),null!=i&&i<e-1e4&&(i=void 0));let o,a,l=nh(this,n,0,s.from,null!=i?i:e);if(l?(a=l.state,o=l.pos+1):(a=this.streamParser.startState(t.unit),o=0),e-o>1e4)return null;for(;o<e;){let i=t.state.doc.lineAt(o),n=Math.min(e,i.to);if(i.length){let e=r?r(i.from):-1,s=new Kl(i.text,t.state.tabSize,t.unit,e<0?void 0:e);for(;s.pos<n-i.from;)oh(this.streamParser.token,s,a)}else this.streamParser.blankLine(a,t.unit);if(n==e)break;o=i.to+1}let h=t.lineAt(e);return r&&null==i&&eh.set(t.state,h.from),this.streamParser.indent(a,/^\s*(.*)/.exec(h.text)[1],t)}get allowsNesting(){return!1}}function nh(t,e,i,n,s){let r=i>=n&&i+e.length<=s&&e.prop(t.stateAfter);if(r)return{state:t.streamParser.copyState(r),pos:i+e.length};for(let r=e.children.length-1;r>=0;r--){let o=e.children[r],a=i+e.positions[r],l=o instanceof Qo&&a<s&&nh(t,o,a,n,s);if(l)return l}return null}function sh(t,e,i,n,s){if(s&&i<=0&&n>=e.length)return e;s||e.type!=t.topNode||(s=!0);for(let r=e.children.length-1;r>=0;r--){let o,a=e.positions[r],l=e.children[r];if(a<n&&l instanceof Qo){if(!(o=sh(t,l,i-a,n-a,s)))break;return s?new Qo(e.type,e.children.slice(0,r).concat(o),e.positions.slice(0,r+1),a+o.length):o}}return null}let rh=class{constructor(t,e,i,n){this.lang=t,this.input=e,this.fragments=i,this.ranges=n,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=n[n.length-1].to;let s=Ua.get(),r=n[0].from,{state:o,tree:a}=function(t,e,i,n){for(let n of e){let e,s=n.from+(n.openStart?25:0),r=n.to-(n.openEnd?25:0),o=s<=i&&r>i&&nh(t,n.tree,0-n.offset,i,r);if(o&&(e=sh(t,n.tree,i+n.offset,o.pos+n.offset,!1)))return{state:o.state,tree:e}}return{state:t.streamParser.startState(n?Fa(n):4),tree:Qo.empty}}(t,i,r,null==s?void 0:s.state);this.state=o,this.parsedPos=this.chunkStart=r+a.length;for(let t=0;t<a.children.length;t++)this.chunks.push(a.children[t]),this.chunkPos.push(a.positions[t]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(Fa(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let t=Ua.get(),e=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(e,this.chunkStart+2048);for(t&&(i=Math.min(i,t.viewport.to));this.parsedPos<i;)this.parseLine(t);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=e?this.finish():t&&this.parsedPos>=t.viewport.to?(t.skipUntilInView(this.parsedPos,e),this.finish()):null}stopAt(t){this.stoppedAt=t}lineAfter(t){let e=this.input.chunk(t);if(this.input.lineChunks)"\n"==e&&(e="");else{let t=e.indexOf("\n");t>-1&&(e=e.slice(0,t))}return t+e.length<=this.to?e:e.slice(0,this.to-t)}nextLine(){let t=this.parsedPos,e=this.lineAfter(t),i=t+e.length;for(let t=this.rangeIndex;;){let n=this.ranges[t].to;if(n>=i)break;if(e=e.slice(0,n-(i-e.length)),t++,t==this.ranges.length)break;let s=this.ranges[t].from,r=this.lineAfter(s);e+=r,i=s+r.length}return{line:e,end:i}}skipGapsTo(t,e,i){for(;;){let n=this.ranges[this.rangeIndex].to,s=t+e;if(i>0?n>s:n>=s)break;e+=this.ranges[++this.rangeIndex].from-n}return e}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(t,e,i,n,s){if(this.ranges.length>1){e+=s=this.skipGapsTo(e,s,1);let t=this.chunk.length;i+=s=this.skipGapsTo(i,s,-1),n+=this.chunk.length-t}return this.chunk.push(t,e,i,n),s}parseLine(t){let{line:e,end:i}=this.nextLine(),n=0,{streamParser:s}=this.lang,r=new Kl(e,t?t.state.tabSize:4,t?Fa(t.state):2);if(r.eol())s.blankLine(this.state,r.indentUnit);else for(;!r.eol();){let t=oh(s.token,r,this.state);if(t&&(n=this.emitToken(this.lang.tokenTable.resolve(t),this.parsedPos+r.start,this.parsedPos+r.pos,4,n)),r.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let t=Qo.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:hh,topID:0,maxBufferLength:2048,reused:this.chunkReused});t=new Qo(t.type,t.children,t.positions,t.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(t),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Qo(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function oh(t,e,i){e.start=e.pos;for(let n=0;n<10;n++){let n=t(e,i);if(e.pos>e.start)return n}throw new Error("Stream parser failed to advance stream.")}const ah=Object.create(null),lh=[vo.none],hh=new yo(lh),ch=[],dh=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])dh[t]=Oh(ah,e);class uh{constructor(t){this.extra=t,this.table=Object.assign(Object.create(null),dh)}resolve(t){return t?this.table[t]||(this.table[t]=Oh(this.extra,t)):0}}const fh=new uh(ah);function ph(t,e){ch.indexOf(t)>-1||(ch.push(t),console.warn(e))}function Oh(t,e){let i=null;for(let n of e.split(".")){let e=t[n]||_a[n];e?"function"==typeof e?i?i=e(i):ph(n,`Modifier ${n} used at start of tag`):i?ph(n,`Tag ${n} used as modifier`):i=e:ph(n,`Unknown highlighting tag ${n}`)}if(!i)return 0;let n=e.replace(/ /g,"_"),s=vo.define({id:lh.length,name:n,props:[la({[n]:i})]});return lh.push(s),s.id}function gh(t,e){return({state:i,dispatch:n})=>{if(i.readOnly)return!1;let s=t(e,i);return!!s&&(n(i.update(s)),!0)}}const mh=gh(xh,0),wh=gh(Sh,0),bh=gh(((t,e)=>Sh(t,e,function(t){let e=[];for(let i of t.selection.ranges){let n=t.doc.lineAt(i.from),s=i.to<=n.to?n:t.doc.lineAt(i.to),r=e.length-1;r>=0&&e[r].to>n.from?e[r].to=s.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:s.to})}return e}(e))),0);function vh(t,e){let i=t.languageDataAt("commentTokens",e);return i.length?i[0]:{}}const yh=50;function Sh(t,e,i=e.selection.ranges){let n=i.map((t=>vh(e,t.from).block));if(!n.every((t=>t)))return null;let s=i.map(((t,i)=>function(t,{open:e,close:i},n,s){let r,o,a=t.sliceDoc(n-yh,n),l=t.sliceDoc(s,s+yh),h=/\s*$/.exec(a)[0].length,c=/^\s*/.exec(l)[0].length,d=a.length-h;if(a.slice(d-e.length,d)==e&&l.slice(c,c+i.length)==i)return{open:{pos:n-h,margin:h&&1},close:{pos:s+c,margin:c&&1}};s-n<=2*yh?r=o=t.sliceDoc(n,s):(r=t.sliceDoc(n,n+yh),o=t.sliceDoc(s-yh,s));let u=/^\s*/.exec(r)[0].length,f=/\s*$/.exec(o)[0].length,p=o.length-f-i.length;return r.slice(u,u+e.length)==e&&o.slice(p,p+i.length)==i?{open:{pos:n+u+e.length,margin:/\s/.test(r.charAt(u+e.length))?1:0},close:{pos:s-f-i.length,margin:/\s/.test(o.charAt(p-1))?1:0}}:null}(e,n[i],t.from,t.to)));if(2!=t&&!s.every((t=>t)))return{changes:e.changes(i.map(((t,e)=>s[e]?[]:[{from:t.from,insert:n[e].open+" "},{from:t.to,insert:" "+n[e].close}])))};if(1!=t&&s.some((t=>t))){let t=[];for(let e,i=0;i<s.length;i++)if(e=s[i]){let s=n[i],{open:r,close:o}=e;t.push({from:r.pos-s.open.length,to:r.pos+r.margin},{from:o.pos-o.margin,to:o.pos+s.close.length})}return{changes:t}}return null}function xh(t,e,i=e.selection.ranges){let n=[],s=-1;for(let{from:t,to:r}of i){let i=n.length,o=1e9,a=vh(e,t).line;if(a){for(let i=t;i<=r;){let l=e.doc.lineAt(i);if(l.from>s&&(t==r||r>l.from)){s=l.from;let t=/^\s*/.exec(l.text)[0].length,e=t==l.length,i=l.text.slice(t,t+a.length)==a?t:-1;t<l.text.length&&t<o&&(o=t),n.push({line:l,comment:i,token:a,indent:t,empty:e,single:!1})}i=l.to+1}if(o<1e9)for(let t=i;t<n.length;t++)n[t].indent<n[t].line.text.length&&(n[t].indent=o);n.length==i+1&&(n[i].single=!0)}}if(2!=t&&n.some((t=>t.comment<0&&(!t.empty||t.single)))){let t=[];for(let{line:e,token:i,indent:s,empty:r,single:o}of n)!o&&r||t.push({from:e.from+s,insert:i+" "});let i=e.changes(t);return{changes:i,selection:e.selection.map(i,1)}}if(1!=t&&n.some((t=>t.comment>=0))){let t=[];for(let{line:e,comment:i,token:s}of n)if(i>=0){let n=e.from+i,r=n+s.length;" "==e.text[r-e.from]&&r++,t.push({from:n,to:r})}return{changes:t}}return null}const kh=lt.define(),Qh=lt.define(),$h=E.define(),Ph=E.define({combine:t=>kt(t,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(i,n)=>t(i,n)||e(i,n)})});const Ch=q.define({create:()=>Ih.empty,update(t,e){let i=e.state.facet(Ph),n=e.annotation(kh);if(n){let s=e.docChanged?A.single(function(t){let e=0;return t.iterChangedRanges(((t,i)=>e=i)),e}(e.changes)):void 0,r=Eh.fromTransaction(e,s),o=n.side,a=0==o?t.undone:t.done;return a=r?Vh(a,a.length,i.minDepth,r):Uh(a,e.startState.selection),new Ih(0==o?n.rest:a,0==o?a:n.rest)}let s=e.annotation(Qh);if("full"!=s&&"before"!=s||(t=t.isolate()),!1===e.annotation(ut.addToHistory))return e.changes.empty?t:t.addMapping(e.changes.desc);let r=Eh.fromTransaction(e),o=e.annotation(ut.time),a=e.annotation(ut.userEvent);return r?t=t.addChanges(r,o,a,i,e):e.selection&&(t=t.addSelection(e.startState.selection,o,a,i.newGroupDelay)),"full"!=s&&"after"!=s||(t=t.isolate()),t},toJSON:t=>({done:t.done.map((t=>t.toJSON())),undone:t.undone.map((t=>t.toJSON()))}),fromJSON:t=>new Ih(t.done.map(Eh.fromJSON),t.undone.map(Eh.fromJSON))});function _h(t={}){return[Ch,Ph.of(t),Ts.domEventHandlers({beforeinput(t,e){let i="historyUndo"==t.inputType?Zh:"historyRedo"==t.inputType?Ah:null;return!!i&&(t.preventDefault(),i(e))}})]}function Xh(t,e){return function({state:i,dispatch:n}){if(!e&&i.readOnly)return!1;let s=i.field(Ch,!1);if(!s)return!1;let r=s.pop(t,i,e);return!!r&&(n(r),!0)}}const Zh=Xh(0,!1),Ah=Xh(1,!1),Th=Xh(0,!0),Rh=Xh(1,!0);class Eh{constructor(t,e,i,n,s){this.changes=t,this.effects=e,this.mapped=i,this.startSelection=n,this.selectionsAfter=s}setSelAfter(t){return new Eh(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,i;return{changes:null===(t=this.changes)||void 0===t?void 0:t.toJSON(),mapped:null===(e=this.mapped)||void 0===e?void 0:e.toJSON(),startSelection:null===(i=this.startSelection)||void 0===i?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map((t=>t.toJSON()))}}static fromJSON(t){return new Eh(t.changes&&k.fromJSON(t.changes),[],t.mapped&&x.fromJSON(t.mapped),t.startSelection&&A.fromJSON(t.startSelection),t.selectionsAfter.map(A.fromJSON))}static fromTransaction(t,e){let i=Dh;for(let e of t.startState.facet($h)){let n=e(t);n.length&&(i=i.concat(n))}return!i.length&&t.changes.empty?null:new Eh(t.changes.invert(t.startState.doc),i,void 0,e||t.startState.selection,Dh)}static selection(t){return new Eh(void 0,Dh,void 0,void 0,t)}}function Vh(t,e,i,n){let s=e+1>i+20?e-i-1:0,r=t.slice(s,e);return r.push(n),r}function Mh(t,e){return t.length?e.length?t.concat(e):t:e}const Dh=[],Wh=200;function Uh(t,e){if(t.length){let i=t[t.length-1],n=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-Wh));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),Vh(t,t.length-1,1e9,i.setSelAfter(n)))}return[Eh.selection([e])]}function Yh(t){let e=t[t.length-1],i=t.slice();return i[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),i}function qh(t,e){if(!t.length)return t;let i=t.length,n=Dh;for(;i;){let s=Lh(t[i-1],e,n);if(s.changes&&!s.changes.empty||s.effects.length){let e=t.slice(0,i);return e[i-1]=s,e}e=s.mapped,i--,n=s.selectionsAfter}return n.length?[Eh.selection(n)]:Dh}function Lh(t,e,i){let n=Mh(t.selectionsAfter.length?t.selectionsAfter.map((t=>t.map(e))):Dh,i);if(!t.changes)return Eh.selection(n);let s=t.changes.map(e),r=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(r):r;return new Eh(s,dt.mapEffects(t.effects,e),o,t.startSelection.map(r),n)}const zh=/^(input\.type|delete)($|\.)/;class Ih{constructor(t,e,i=0,n=void 0){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new Ih(this.done,this.undone):this}addChanges(t,e,i,n,s){let r=this.done,o=r[r.length-1];return r=o&&o.changes&&!o.changes.empty&&t.changes&&(!i||zh.test(i))&&(!o.selectionsAfter.length&&e-this.prevTime<n.newGroupDelay&&n.joinToEvent(s,function(t,e){let i=[],n=!1;return t.iterChangedRanges(((t,e)=>i.push(t,e))),e.iterChangedRanges(((t,e,s,r)=>{for(let t=0;t<i.length;){let e=i[t++],o=i[t++];r>=e&&s<=o&&(n=!0)}})),n}(o.changes,t.changes))||"input.type.compose"==i)?Vh(r,r.length-1,n.minDepth,new Eh(t.changes.compose(o.changes),Mh(t.effects,o.effects),o.mapped,o.startSelection,Dh)):Vh(r,r.length,n.minDepth,t),new Ih(r,Dh,e,i)}addSelection(t,e,i,n){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Dh;return s.length>0&&e-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&(r=s[s.length-1],o=t,r.ranges.length==o.ranges.length&&0===r.ranges.filter(((t,e)=>t.empty!=o.ranges[e].empty)).length)?this:new Ih(Uh(this.done,t),this.undone,e,i);var r,o}addMapping(t){return new Ih(qh(this.done,t),qh(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,i){let n=0==t?this.done:this.undone;if(0==n.length)return null;let s=n[n.length-1];if(i&&s.selectionsAfter.length)return e.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:kh.of({side:t,rest:Yh(n)}),userEvent:0==t?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let i=1==n.length?Dh:n.slice(0,n.length-1);return s.mapped&&(i=qh(i,s.mapped)),e.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:kh.of({side:t,rest:i}),filter:!1,userEvent:0==t?"undo":"redo",scrollIntoView:!0})}return null}}Ih.empty=new Ih(Dh,Dh);const Bh=[{key:"Mod-z",run:Zh,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Ah,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Ah,preventDefault:!0},{key:"Mod-u",run:Th,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Rh,preventDefault:!0}];function jh(t,e){return A.create(t.ranges.map(e),t.mainIndex)}function Nh(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Gh({state:t,dispatch:e},i){let n=jh(t.selection,i);return!n.eq(t.selection)&&(e(Nh(t,n)),!0)}function Hh(t,e){return A.cursor(e?t.to:t.from)}function Fh(t,e){return Gh(t,(i=>i.empty?t.moveByChar(i,e):Hh(i,e)))}function Jh(t){return t.textDirectionAt(t.state.selection.main.head)==Wi.LTR}const Kh=t=>Fh(t,!Jh(t)),tc=t=>Fh(t,Jh(t));function ec(t,e){return Gh(t,(i=>i.empty?t.moveByGroup(i,e):Hh(i,e)))}function ic(t,e,i){if(e.type.prop(i))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function nc(t,e,i){let n,s,r=Ma(t).resolveInner(e.head),o=i?mo.closedBy:mo.openedBy;for(let n=e.head;;){let e=i?r.childAfter(n):r.childBefore(n);if(!e)break;ic(t,e,o)?r=e:n=i?e.to:e.from}return s=r.type.prop(o)&&(n=i?Hl(t,r.from,1):Hl(t,r.to,-1))&&n.matched?i?n.end.to:n.end.from:i?r.to:r.from,A.cursor(s,i?-1:1)}function sc(t,e){return Gh(t,(i=>{if(!i.empty)return Hh(i,e);let n=t.moveVertically(i,e);return n.head!=i.head?n:t.moveToLineBoundary(i,e)}))}const rc=t=>sc(t,!1),oc=t=>sc(t,!0);function ac(t){let e,i=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,s=0;if(i){for(let e of t.state.facet(Ts.scrollMargins)){let i=e(t);(null==i?void 0:i.top)&&(n=Math.max(null==i?void 0:i.top,n)),(null==i?void 0:i.bottom)&&(s=Math.max(null==i?void 0:i.bottom,s))}e=t.scrollDOM.clientHeight-n-s}else e=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:s,selfScroll:i,height:Math.max(t.defaultLineHeight,e-5)}}function lc(t,e){let i,n=ac(t),{state:s}=t,r=jh(s.selection,(i=>i.empty?t.moveVertically(i,e,n.height):Hh(i,e)));if(r.eq(s.selection))return!1;if(n.selfScroll){let e=t.coordsAtPos(s.selection.main.head),o=t.scrollDOM.getBoundingClientRect(),a=o.top+n.marginTop,l=o.bottom-n.marginBottom;e&&e.top>a&&e.bottom<l&&(i=Ts.scrollIntoView(r.main.head,{y:"start",yMargin:e.top-a}))}return t.dispatch(Nh(s,r),{effects:i}),!0}const hc=t=>lc(t,!1),cc=t=>lc(t,!0);function dc(t,e,i){let n=t.lineBlockAt(e.head),s=t.moveToLineBoundary(e,i);if(s.head==e.head&&s.head!=(i?n.to:n.from)&&(s=t.moveToLineBoundary(e,i,!1)),!i&&s.head==n.from&&n.length){let i=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;i&&e.head!=n.from+i&&(s=A.cursor(n.from+i))}return s}function uc(t,e){let i=jh(t.state.selection,(t=>{let i=e(t);return A.range(t.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)}));return!i.eq(t.state.selection)&&(t.dispatch(Nh(t.state,i)),!0)}function fc(t,e){return console.log("Select!"),uc(t,(i=>t.moveByCharSelected(i,e)))}const pc=t=>fc(t,!Jh(t)),Oc=t=>fc(t,Jh(t));function gc(t,e){return uc(t,(i=>t.moveByGroup(i,e)))}function mc(t,e){return uc(t,(i=>t.moveVertically(i,e)))}const wc=t=>mc(t,!1),bc=t=>mc(t,!0);function vc(t,e){return uc(t,(i=>t.moveVertically(i,e,ac(t).height)))}const yc=t=>vc(t,!1),Sc=t=>vc(t,!0),xc=({state:t,dispatch:e})=>(e(Nh(t,{anchor:0})),!0),kc=({state:t,dispatch:e})=>(e(Nh(t,{anchor:t.doc.length})),!0),Qc=({state:t,dispatch:e})=>(e(Nh(t,{anchor:t.selection.main.anchor,head:0})),!0),$c=({state:t,dispatch:e})=>(e(Nh(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0);function Pc(t,e){if(t.state.readOnly)return!1;let i="delete.selection",{state:n}=t,s=n.changeByRange((n=>{let{from:s,to:r}=n;if(s==r){let n=e(s);n<s?(i="delete.backward",n=Cc(t,n,!1)):n>s&&(i="delete.forward",n=Cc(t,n,!0)),s=Math.min(s,n),r=Math.max(r,n)}else s=Cc(t,s,!1),r=Cc(t,r,!0);return s==r?{range:n}:{changes:{from:s,to:r},range:A.cursor(s)}}));return!s.changes.empty&&(t.dispatch(n.update(s,{scrollIntoView:!0,userEvent:i,effects:"delete.selection"==i?Ts.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function Cc(t,e,i){if(t instanceof Ts)for(let n of t.state.facet(Ts.atomicRanges).map((e=>e(t))))n.between(e,e,((t,n)=>{t<e&&n>e&&(e=i?n:t)}));return e}const _c=(t,e)=>Pc(t,(i=>{let n,s,{state:r}=t,o=r.doc.lineAt(i);if(!e&&i>o.from&&i<o.from+200&&!/[^ \t]/.test(n=o.text.slice(0,i-o.from))){if("\t"==n[n.length-1])return i-1;let t=Yt(n,r.tabSize)%Fa(r)||Fa(r);for(let e=0;e<t&&" "==n[n.length-1-e];e++)i--;s=i}else s=f(o.text,i-o.from,e,e)+o.from,s==i&&o.number!=(e?r.doc.lines:1)&&(s+=e?1:-1);return s})),Xc=t=>_c(t,!1),Zc=t=>_c(t,!0),Ac=(t,e)=>Pc(t,(i=>{let n=i,{state:s}=t,r=s.doc.lineAt(n),o=s.charCategorizer(n);for(let t=null;;){if(n==(e?r.to:r.from)){n==i&&r.number!=(e?s.doc.lines:1)&&(n+=e?1:-1);break}let a=f(r.text,n-r.from,e)+r.from,l=r.text.slice(Math.min(n,a)-r.from,Math.max(n,a)-r.from),h=o(l);if(null!=t&&h!=t)break;" "==l&&n==i||(t=h),n=a}return n})),Tc=t=>Ac(t,!1),Rc=t=>Pc(t,(e=>{let i=t.lineBlockAt(e).to;return e<i?i:Math.min(t.state.doc.length,e+1)}));function Ec(t){let e=[],i=-1;for(let n of t.selection.ranges){let s=t.doc.lineAt(n.from),r=t.doc.lineAt(n.to);if(n.empty||n.to!=r.from||(r=t.doc.lineAt(n.to-1)),i>=s.number){let t=e[e.length-1];t.to=r.to,t.ranges.push(n)}else e.push({from:s.from,to:r.to,ranges:[n]});i=r.number+1}return e}function Vc(t,e,i){if(t.readOnly)return!1;let n=[],s=[];for(let e of Ec(t)){if(i?e.to==t.doc.length:0==e.from)continue;let r=t.doc.lineAt(i?e.to+1:e.from-1),o=r.length+1;if(i){n.push({from:e.to,to:r.to},{from:e.from,insert:r.text+t.lineBreak});for(let i of e.ranges)s.push(A.range(Math.min(t.doc.length,i.anchor+o),Math.min(t.doc.length,i.head+o)))}else{n.push({from:r.from,to:e.from},{from:e.to,insert:t.lineBreak+r.text});for(let t of e.ranges)s.push(A.range(t.anchor-o,t.head-o))}}return!!n.length&&(e(t.update({changes:n,scrollIntoView:!0,selection:A.create(s,t.selection.mainIndex),userEvent:"move.line"})),!0)}function Mc(t,e,i){if(t.readOnly)return!1;let n=[];for(let e of Ec(t))i?n.push({from:e.from,insert:t.doc.slice(e.from,e.to)+t.lineBreak}):n.push({from:e.to,insert:t.lineBreak+t.doc.slice(e.from,e.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Dc=Wc(!1);function Wc(e){return({state:i,dispatch:n})=>{if(i.readOnly)return!1;let s=i.changeByRange((n=>{let{from:s,to:r}=n,o=i.doc.lineAt(s),a=!e&&s==r&&function(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let i,n=Ma(t).resolveInner(e),s=n.childBefore(e),r=n.childAfter(e);return s&&r&&s.to<=e&&r.from>=e&&(i=s.type.prop(mo.closedBy))&&i.indexOf(r.name)>-1&&t.doc.lineAt(s.to).from==t.doc.lineAt(r.from).from?{from:s.to,to:r.from}:null}(i,s);e&&(s=r=(r<=o.to?o:i.doc.lineAt(r)).to);let l=new tl(i,{simulateBreak:s,simulateDoubleBreak:!!a}),h=Ka(l,s);for(null==h&&(h=/^\s*/.exec(i.doc.lineAt(s).text)[0].length);r<o.to&&/\s/.test(o.text[r-o.from]);)r++;a?({from:s,to:r}=a):s>o.from&&s<o.from+100&&!/\S/.test(o.text.slice(0,s))&&(s=o.from);let c=["",Ja(i,h)];return a&&c.push(Ja(i,l.lineIndent(o.from,-1))),{changes:{from:s,to:r,insert:t.of(c)},range:A.cursor(s+1+c[1].length)}}));return n(i.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function Uc(t,e){let i=-1;return t.changeByRange((n=>{let s=[];for(let r=n.from;r<=n.to;){let o=t.doc.lineAt(r);o.number>i&&(n.empty||n.to>o.from)&&(e(o,s,n),i=o.number),r=o.to+1}let r=t.changes(s);return{changes:s,range:A.range(r.mapPos(n.anchor,1),r.mapPos(n.head,1))}}))}const Yc=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(Uc(t,((e,i)=>{i.push({from:e.from,insert:t.facet(Ha)})})),{userEvent:"input.indent"})),!0),qc=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(Uc(t,((e,i)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let s=Yt(n,t.tabSize),r=0,o=Ja(t,Math.max(0,s-Fa(t)));for(;r<n.length&&r<o.length&&n.charCodeAt(r)==o.charCodeAt(r);)r++;i.push({from:e.from+r,to:e.from+n.length,insert:o.slice(r)})})),{userEvent:"delete.dedent"})),!0),Lc=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:t=>Gh(t,(e=>nc(t.state,e,!Jh(t)))),shift:t=>uc(t,(e=>nc(t.state,e,!Jh(t))))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:t=>Gh(t,(e=>nc(t.state,e,Jh(t)))),shift:t=>uc(t,(e=>nc(t.state,e,Jh(t))))},{key:"Alt-ArrowUp",run:({state:t,dispatch:e})=>Vc(t,e,!1)},{key:"Shift-Alt-ArrowUp",run:({state:t,dispatch:e})=>Mc(t,e,!1)},{key:"Alt-ArrowDown",run:({state:t,dispatch:e})=>Vc(t,e,!0)},{key:"Shift-Alt-ArrowDown",run:({state:t,dispatch:e})=>Mc(t,e,!0)},{key:"Escape",run:({state:t,dispatch:e})=>{let i=t.selection,n=null;return i.ranges.length>1?n=A.create([i.main]):i.main.empty||(n=A.create([A.cursor(i.main.head)])),!!n&&(e(Nh(t,n)),!0)}},{key:"Mod-Enter",run:Wc(!0)},{key:"Alt-l",mac:"Ctrl-l",run:({state:t,dispatch:e})=>{let i=Ec(t).map((({from:e,to:i})=>A.range(e,Math.min(i+1,t.doc.length))));return e(t.update({selection:A.create(i),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:t,dispatch:e})=>{let i=jh(t.selection,(e=>{var i;let n=Ma(t).resolveInner(e.head,1);for(;!(n.from<e.from&&n.to>=e.to||n.to>e.to&&n.from<=e.from)&&(null===(i=n.parent)||void 0===i?void 0:i.parent);)n=n.parent;return A.range(n.to,n.from)}));return e(Nh(t,i)),!0},preventDefault:!0},{key:"Mod-[",run:qc},{key:"Mod-]",run:Yc},{key:"Mod-Alt-\\",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=Object.create(null),n=new tl(t,{overrideIndentation:t=>{let e=i[t];return null==e?-1:e}}),s=Uc(t,((e,s,r)=>{let o=Ka(n,e.from);if(null==o)return;/\S/.test(e.text)||(o=0);let a=/^\s*/.exec(e.text)[0],l=Ja(t,o);(a!=l||r.from<e.from+a.length)&&(i[e.from]=o,s.push({from:e.from,to:e.from+a.length,insert:l}))}));return s.changes.empty||e(t.update(s,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:t=>{if(t.state.readOnly)return!1;let{state:e}=t,i=e.changes(Ec(e).map((({from:t,to:i})=>(t>0?t--:i<e.doc.length&&i++,{from:t,to:i})))),n=jh(e.selection,(e=>t.moveVertically(e,!0))).map(i);return t.dispatch({changes:i,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:t,dispatch:e})=>function(t,e,i){let n=!1,s=jh(t.selection,(e=>{let s=Hl(t,e.head,-1)||Hl(t,e.head,1)||e.head>0&&Hl(t,e.head-1,1)||e.head<t.doc.length&&Hl(t,e.head+1,-1);if(!s||!s.end)return e;n=!0;let r=s.start.from==e.head?s.end.to:s.end.from;return i?A.range(e.anchor,r):A.cursor(r)}));return!!n&&(e(Nh(t,s)),!0)}(t,e,!1)},{key:"Mod-/",win:"Alt+/",linux:"Alt+/",run:t=>{let{state:e}=t,i=e.doc.lineAt(e.selection.main.from),n=vh(t.state,i.from);return n.line?mh(t):!!n.block&&bh(t)}},{key:"Alt-A",run:wh}].concat([{key:"ArrowLeft",run:Kh,shift:pc,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t=>ec(t,!Jh(t)),shift:t=>gc(t,!Jh(t)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:t=>Gh(t,(e=>dc(t,e,!Jh(t)))),shift:t=>uc(t,(e=>dc(t,e,!Jh(t)))),preventDefault:!0},{key:"ArrowRight",run:tc,shift:Oc,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:t=>ec(t,Jh(t)),shift:t=>gc(t,Jh(t)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:t=>Gh(t,(e=>dc(t,e,Jh(t)))),shift:t=>uc(t,(e=>dc(t,e,Jh(t)))),preventDefault:!0},{key:"ArrowUp",run:rc,shift:wc,preventDefault:!0},{mac:"Cmd-ArrowUp",run:xc,shift:Qc},{mac:"Ctrl-ArrowUp",run:hc,shift:yc},{key:"ArrowDown",run:oc,shift:bc,preventDefault:!0},{mac:"Cmd-ArrowDown",run:kc,shift:$c},{mac:"Ctrl-ArrowDown",run:cc,shift:Sc},{key:"PageUp",run:hc,shift:yc},{key:"PageDown",run:cc,shift:Sc},{key:"Home",run:t=>Gh(t,(e=>dc(t,e,!1))),shift:t=>uc(t,(e=>dc(t,e,!1))),preventDefault:!0},{key:"Mod-Home",run:xc,shift:Qc},{key:"End",run:t=>Gh(t,(e=>dc(t,e,!0))),shift:t=>uc(t,(e=>dc(t,e,!0))),preventDefault:!0},{key:"Mod-End",run:kc,shift:$c},{key:"Enter",run:Dc},{key:"Mod-a",run:({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:Xc,shift:Xc},{key:"Delete",run:Zc},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Tc},{key:"Mod-Delete",mac:"Alt-Delete",run:t=>Ac(t,!0)},{mac:"Mod-Backspace",run:t=>Pc(t,(e=>{let i=t.lineBlockAt(e).from;return e>i?i:Math.max(0,e-1)}))},{mac:"Mod-Delete",run:Rc}].concat([{key:"Ctrl-b",run:Kh,shift:pc,preventDefault:!0},{key:"Ctrl-f",run:tc,shift:Oc},{key:"Ctrl-p",run:rc,shift:wc},{key:"Ctrl-n",run:oc,shift:bc},{key:"Ctrl-a",run:t=>Gh(t,(e=>A.cursor(t.lineBlockAt(e.head).from,1))),shift:t=>uc(t,(e=>A.cursor(t.lineBlockAt(e.head).from)))},{key:"Ctrl-e",run:t=>Gh(t,(e=>A.cursor(t.lineBlockAt(e.head).to,-1))),shift:t=>uc(t,(e=>A.cursor(t.lineBlockAt(e.head).to)))},{key:"Ctrl-d",run:Zc},{key:"Ctrl-h",run:Xc},{key:"Ctrl-k",run:Rc},{key:"Ctrl-Alt-h",run:Tc},{key:"Ctrl-o",run:({state:e,dispatch:i})=>{if(e.readOnly)return!1;let n=e.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:t.of(["",""])},range:A.cursor(e.from)})));return i(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((e=>{if(!e.empty||0==e.from||e.from==t.doc.length)return{range:e};let i=e.from,n=t.doc.lineAt(i),s=i==n.from?i-1:f(n.text,i-n.from,!1)+n.from,r=i==n.to?i+1:f(n.text,i-n.from,!0)+n.from;return{changes:{from:s,to:r,insert:t.doc.slice(i,r).append(t.doc.slice(s,i))},range:A.cursor(r)}}));return!i.changes.empty&&(e(t.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:cc}].map((t=>({mac:t.key,run:t.run,shift:t.shift})))));function zc(){var t=arguments[0];"string"==typeof t&&(t=document.createElement(t));var e=1,i=arguments[1];if(i&&"object"==typeof i&&null==i.nodeType&&!Array.isArray(i)){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var s=i[n];"string"==typeof s?t.setAttribute(n,s):null!=s&&(t[n]=s)}e++}for(;e<arguments.length;e++)Ic(t,arguments[e]);return t}function Ic(t,e){if("string"==typeof e)t.appendChild(document.createTextNode(e));else if(null==e);else if(null!=e.nodeType)t.appendChild(e);else{if(!Array.isArray(e))throw new RangeError("Unsupported child node: "+e);for(var i=0;i<e.length;i++)Ic(t,e[i])}}const Bc="function"==typeof String.prototype.normalize?t=>t.normalize("NFKD"):t=>t;class jc{constructor(t,e,i=0,n=t.length,s,r){this.test=r,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(i,n),this.bufferStart=i,this.normalize=s?t=>s(Bc(t)):Bc,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return w(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=b(t),i=this.bufferStart+this.bufferPos;this.bufferPos+=v(t);let n=this.normalize(e);for(let t=0,s=i;;t++){let r=n.charCodeAt(t),o=this.match(r,s);if(o)return this.value=o,this;if(t==n.length-1)break;s==i&&t<e.length&&e.charCodeAt(t)==r&&s++}}}match(t,e){let i=null;for(let n=0;n<this.matches.length;n+=2){let s=this.matches[n],r=!1;this.query.charCodeAt(s)==t&&(s==this.query.length-1?i={from:this.matches[n+1],to:e+1}:(this.matches[n]++,r=!0)),r||(this.matches.splice(n,2),n-=2)}return this.query.charCodeAt(0)==t&&(1==this.query.length?i={from:e,to:e+1}:this.matches.push(1,e)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferPos)&&(i=null),i}}"undefined"!=typeof Symbol&&(jc.prototype[Symbol.iterator]=function(){return this});const Nc={from:-1,to:-1,match:/.*/.exec("")},Gc="gm"+(null==/x/.unicode?"":"u");class Hc{constructor(t,e,i,n=0,s=t.length){if(this.text=t,this.to=s,this.curLine="",this.done=!1,this.value=Nc,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new Kc(t,e,i,n,s);this.re=new RegExp(e,Gc+((null==i?void 0:i.ignoreCase)?"i":"")),this.test=null==i?void 0:i.test,this.iter=t.iter();let r=t.lineAt(n);this.curLineStart=r.from,this.matchPos=td(t,n),this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let i=this.curLineStart+e.index,n=i+e[0].length;if(this.matchPos=td(this.text,n+(i==n?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<n||i>this.value.to)&&(!this.test||this.test(i,n,e)))return this.value={from:i,to:n,match:e},this;t=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),t=0}}}}const Fc=new WeakMap;class Jc{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,i){let n=Fc.get(t);if(!n||n.from>=i||n.to<=e){let n=new Jc(e,t.sliceString(e,i));return Fc.set(t,n),n}if(n.from==e&&n.to==i)return n;let{text:s,from:r}=n;return r>e&&(s=t.sliceString(e,r)+s,r=e),n.to<i&&(s+=t.sliceString(n.to,i)),Fc.set(t,new Jc(r,s)),new Jc(e,s.slice(e-r,i-r))}}class Kc{constructor(t,e,i,n,s){this.text=t,this.to=s,this.done=!1,this.value=Nc,this.matchPos=td(t,n),this.re=new RegExp(e,Gc+((null==i?void 0:i.ignoreCase)?"i":"")),this.test=null==i?void 0:i.test,this.flat=Jc.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e){let t=this.flat.from+e.index,i=t+e[0].length;if((this.flat.to>=this.to||e.index+e[0].length<=this.flat.text.length-10)&&(!this.test||this.test(t,i,e)))return this.value={from:t,to:i,match:e},this.matchPos=td(this.text,i+(t==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Jc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function td(t,e){if(e>=t.length)return e;let i,n=t.lineAt(e);for(;e<n.to&&(i=n.text.charCodeAt(e-n.from))>=56320&&i<57344;)e++;return e}function ed(t){let e=zc("input",{class:"cm-textfield",name:"line"});function i(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!i)return;let{state:n}=t,s=n.doc.lineAt(n.selection.main.head),[,r,o,a,l]=i,h=a?+a.slice(1):0,c=o?+o:s.number;if(o&&l){let t=c/100;r&&(t=t*("-"==r?-1:1)+s.number/n.doc.lines),c=Math.round(n.doc.lines*t)}else o&&r&&(c=c*("-"==r?-1:1)+s.number);let d=n.doc.line(Math.max(1,Math.min(n.doc.lines,c)));t.dispatch({effects:id.of(!1),selection:A.cursor(d.from+Math.max(0,Math.min(h,d.length))),scrollIntoView:!0}),t.focus()}return{dom:zc("form",{class:"cm-gotoLine",onkeydown:e=>{27==e.keyCode?(e.preventDefault(),t.dispatch({effects:id.of(!1)}),t.focus()):13==e.keyCode&&(e.preventDefault(),i())},onsubmit:t=>{t.preventDefault(),i()}},zc("label",t.state.phrase("Go to line"),": ",e)," ",zc("button",{class:"cm-button",type:"submit"},t.state.phrase("go")))}}"undefined"!=typeof Symbol&&(Hc.prototype[Symbol.iterator]=Kc.prototype[Symbol.iterator]=function(){return this});const id=dt.define(),nd=q.define({create:()=>!0,update(t,e){for(let i of e.effects)i.is(id)&&(t=i.value);return t},provide:t=>jr.from(t,(t=>t?ed:null))}),sd=Ts.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),rd={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},od=E.define({combine:t=>kt(t,rd,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})});function ad(t){let e=[ud,dd];return t&&e.push(od.of(t)),e}const ld=ni.mark({class:"cm-selectionMatch"}),hd=ni.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function cd(t,e,i,n){return!(0!=i&&t(e.sliceDoc(i-1,i))==bt.Word||n!=e.doc.length&&t(e.sliceDoc(n,n+1))==bt.Word)}const dd=_i.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(od),{state:i}=t,n=i.selection;if(n.ranges.length>1)return ni.none;let s,r=n.main,o=null;if(r.empty){if(!e.highlightWordAroundCursor)return ni.none;let t=i.wordAt(r.head);if(!t)return ni.none;o=i.charCategorizer(r.head),s=i.sliceDoc(t.from,t.to)}else{let t=r.to-r.from;if(t<e.minSelectionLength||t>200)return ni.none;if(e.wholeWords){if(s=i.sliceDoc(r.from,r.to),o=i.charCategorizer(r.head),!cd(o,i,r.from,r.to)||!function(t,e,i,n){return t(e.sliceDoc(i,i+1))==bt.Word&&t(e.sliceDoc(n-1,n))==bt.Word}(o,i,r.from,r.to))return ni.none}else if(s=i.sliceDoc(r.from,r.to).trim(),!s)return ni.none}let a=[];for(let n of t.visibleRanges){let t=new jc(i.doc,s,n.from,n.to);for(;!t.next().done;){let{from:n,to:s}=t.value;if((!o||cd(o,i,n,s))&&(r.empty&&n<=r.from&&s>=r.to?a.push(hd.range(n,s)):(n>=r.to||s<=r.from)&&a.push(ld.range(n,s)),a.length>e.maxMatches))return ni.none}}return ni.set(a)}},{decorations:t=>t.decorations}),ud=Ts.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});const fd=E.define({combine:t=>kt(t,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:t=>new qd(t),scrollToMatch:t=>Ts.scrollIntoView(t)})});class pd{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||function(t){try{return new RegExp(t,Gc),!0}catch(t){return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord}unquote(t){return this.literal?t:t.replace(/\\([nrt\\])/g,((t,e)=>"n"==e?"\n":"r"==e?"\r":"t"==e?"\t":"\\"))}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp&&this.wholeWord==t.wholeWord}create(){return this.regexp?new yd(this):new md(this)}getCursor(t,e=0,i){let n=t.doc?t:xt.create({doc:t});return null==i&&(i=n.doc.length),this.regexp?wd(this,n,e,i):gd(this,n,e,i)}}class Od{constructor(t){this.spec=t}}function gd(t,e,i,n){return new jc(e.doc,t.unquoted,i,n,t.caseSensitive?void 0:t=>t.toLowerCase(),t.wholeWord?function(t,e){return(i,n,s,r)=>((r>i||r+s.length<n)&&(r=Math.max(0,i-2),s=t.sliceString(r,Math.min(t.length,n+2))),!(e(bd(s,i-r))==bt.Word&&e(vd(s,i-r))==bt.Word||e(vd(s,n-r))==bt.Word&&e(bd(s,n-r))==bt.Word))}(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}class md extends Od{constructor(t){super(t)}nextMatch(t,e,i){let n=gd(this.spec,t,i,t.doc.length).nextOverlapping();return n.done&&(n=gd(this.spec,t,0,e).nextOverlapping()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=i;;){let i=Math.max(e,n-1e4-this.spec.unquoted.length),s=gd(this.spec,t,i,n),r=null;for(;!s.nextOverlapping().done;)r=s.value;if(r)return r;if(i==e)return null;n-=1e4}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace)}matchAll(t,e){let i=gd(this.spec,t,0,t.doc.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let s=gd(this.spec,t,Math.max(0,e-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,t.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}function wd(t,e,i,n){return new Hc(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?(s=e.charCategorizer(e.selection.main.head),(t,e,i)=>!i[0].length||(s(bd(i.input,i.index))!=bt.Word||s(vd(i.input,i.index))!=bt.Word)&&(s(vd(i.input,i.index+i[0].length))!=bt.Word||s(bd(i.input,i.index+i[0].length))!=bt.Word)):void 0},i,n);var s}function bd(t,e){return t.slice(f(t,e,!1),e)}function vd(t,e){return t.slice(e,f(t,e))}class yd extends Od{nextMatch(t,e,i){let n=wd(this.spec,t,i,t.doc.length).next();return n.done&&(n=wd(this.spec,t,0,e).next()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=1;;n++){let s=Math.max(e,i-1e4*n),r=wd(this.spec,t,s,i),o=null;for(;!r.next().done;)o=r.value;if(o&&(s==e||o.from>s+10))return o;if(s==e)return null}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,((e,i)=>"$"==i?"$":"&"==i?t.match[0]:"0"!=i&&+i<t.match.length?t.match[i]:e)))}matchAll(t,e){let i=wd(this.spec,t,0,t.doc.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let s=wd(this.spec,t,Math.max(0,e-250),Math.min(i+250,t.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}const Sd=dt.define(),xd=dt.define(),kd=q.define({create:t=>new Qd(Vd(t).create(),null),update(t,e){for(let i of e.effects)i.is(Sd)?t=new Qd(i.value.create(),t.panel):i.is(xd)&&(t=new Qd(t.query,i.value?Ed:null));return t},provide:t=>jr.from(t,(t=>t.panel))});class Qd{constructor(t,e){this.query=t,this.panel=e}}const $d=ni.mark({class:"cm-searchMatch"}),Pd=ni.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Cd=_i.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(kd))}update(t){let e=t.state.field(kd);(e!=t.startState.field(kd)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return ni.none;let{view:i}=this,n=new Xt;for(let e=0,s=i.visibleRanges,r=s.length;e<r;e++){let{from:o,to:a}=s[e];for(;e<r-1&&a>s[e+1].from-500;)a=s[++e].to;t.highlight(i.state,o,a,((t,e)=>{let s=i.state.selection.ranges.some((i=>i.from==t&&i.to==e));n.add(t,e,s?Pd:$d)}))}return n.finish()}},{decorations:t=>t.decorations});function _d(t){return e=>{let i=e.state.field(kd,!1);return i&&i.query.spec.valid?t(e,i):Wd(e)}}const Xd=_d(((t,{query:e})=>{let{to:i}=t.state.selection.main,n=e.nextMatch(t.state,i,i);if(!n)return!1;let s=A.single(n.from,n.to),r=t.state.facet(fd);return t.dispatch({selection:s,effects:[Bd(t,n),r.scrollToMatch(s.main,t)],userEvent:"select.search"}),Dd(t),!0})),Zd=_d(((t,{query:e})=>{let{state:i}=t,{from:n}=i.selection.main,s=e.prevMatch(i,n,n);if(!s)return!1;let r=A.single(s.from,s.to),o=t.state.facet(fd);return t.dispatch({selection:r,effects:[Bd(t,s),o.scrollToMatch(r.main,t)],userEvent:"select.search"}),Dd(t),!0})),Ad=_d(((t,{query:e})=>{let i=e.matchAll(t.state,1e3);return!(!i||!i.length)&&(t.dispatch({selection:A.create(i.map((t=>A.range(t.from,t.to)))),userEvent:"select.search.matches"}),!0)})),Td=_d(((t,{query:e})=>{let{state:i}=t,{from:n,to:s}=i.selection.main;if(i.readOnly)return!1;let r=e.nextMatch(i,n,n);if(!r)return!1;let o,a,l=[],h=[];if(r.from==n&&r.to==s&&(a=i.toText(e.getReplacement(r)),l.push({from:r.from,to:r.to,insert:a}),r=e.nextMatch(i,r.from,r.to),h.push(Ts.announce.of(i.phrase("replaced match on line $",i.doc.lineAt(n).number)+"."))),r){let e=0==l.length||l[0].from>=r.to?0:r.to-r.from-a.length;o=A.single(r.from-e,r.to-e),h.push(Bd(t,r)),h.push(i.facet(fd).scrollToMatch(o.main,t))}return t.dispatch({changes:l,selection:o,effects:h,userEvent:"input.replace"}),!0})),Rd=_d(((t,{query:e})=>{if(t.state.readOnly)return!1;let i=e.matchAll(t.state,1e9).map((t=>{let{from:i,to:n}=t;return{from:i,to:n,insert:e.getReplacement(t)}}));if(!i.length)return!1;let n=t.state.phrase("replaced $ matches",i.length)+".";return t.dispatch({changes:i,effects:Ts.announce.of(n),userEvent:"input.replace.all"}),!0}));function Ed(t){return t.state.facet(fd).createPanel(t)}function Vd(t,e){var i,n,s,r;let o=t.selection.main,a=o.empty||o.to>o.from+100?"":t.sliceDoc(o.from,o.to);if(e&&!a)return e;let l=t.facet(fd);return new pd({search:(null!==(i=null==e?void 0:e.literal)&&void 0!==i?i:l.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:null!==(n=null==e?void 0:e.caseSensitive)&&void 0!==n?n:l.caseSensitive,literal:null!==(s=null==e?void 0:e.literal)&&void 0!==s?s:l.literal,wholeWord:null!==(r=null==e?void 0:e.wholeWord)&&void 0!==r?r:l.wholeWord})}function Md(t){let e=Lr(t,Ed);return e&&e.dom.querySelector("[main-field]")}function Dd(t){let e=Md(t);e&&e==t.root.activeElement&&e.select()}const Wd=t=>{let e=t.state.field(kd,!1);if(e&&e.panel){let i=Md(t);if(i&&i!=t.root.activeElement){let n=Vd(t.state,e.query.spec);n.valid&&t.dispatch({effects:Sd.of(n)}),i.focus(),i.select()}}else t.dispatch({effects:[xd.of(!0),e?Sd.of(Vd(t.state,e.query.spec)):dt.appendConfig.of(Nd)]});return!0},Ud=t=>{let e=t.state.field(kd,!1);if(!e||!e.panel)return!1;let i=Lr(t,Ed);return i&&i.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:xd.of(!1)}),!0},Yd=[{key:"Mod-f",run:Wd,scope:"editor search-panel"},{key:"F3",run:Xd,shift:Zd,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Xd,shift:Zd,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Ud,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:t,dispatch:e})=>{let i=t.selection;if(i.ranges.length>1||i.main.empty)return!1;let{from:n,to:s}=i.main,r=[],o=0;for(let e=new jc(t.doc,t.sliceDoc(n,s));!e.next().done;){if(r.length>1e3)return!1;e.value.from==n&&(o=r.length),r.push(A.range(e.value.from,e.value.to))}return e(t.update({selection:A.create(r,o),userEvent:"select.search.matches"})),!0}},{key:"Alt-g",run:t=>{let e=Lr(t,ed);if(!e){let i=[id.of(!0)];null==t.state.field(nd,!1)&&i.push(dt.appendConfig.of([nd,sd])),t.dispatch({effects:i}),e=Lr(t,ed)}return e&&e.dom.querySelector("input").focus(),!0}},{key:"Mod-d",run:({state:t,dispatch:e})=>{let{ranges:i}=t.selection;if(i.some((t=>t.from===t.to)))return(({state:t,dispatch:e})=>{let{selection:i}=t,n=A.create(i.ranges.map((e=>t.wordAt(e.head)||A.cursor(e.head))),i.mainIndex);return!n.eq(i)&&(e(t.update({selection:n})),!0)})({state:t,dispatch:e});let n=t.sliceDoc(i[0].from,i[0].to);if(t.selection.ranges.some((e=>t.sliceDoc(e.from,e.to)!=n)))return!1;let s=function(t,e){let{main:i,ranges:n}=t.selection,s=t.wordAt(i.head),r=s&&s.from==i.from&&s.to==i.to;for(let i=!1,s=new jc(t.doc,e,n[n.length-1].to);;){if(s.next(),!s.done){if(i&&n.some((t=>t.from==s.value.from)))continue;if(r){let e=t.wordAt(s.value.from);if(!e||e.from!=s.value.from||e.to!=s.value.to)continue}return s.value}if(i)return null;s=new jc(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),i=!0}}(t,n);return!!s&&(e(t.update({selection:t.selection.addRange(A.range(s.from,s.to),!1),effects:Ts.scrollIntoView(s.to)})),!0)},preventDefault:!0}];class qd{constructor(t){this.view=t;let e=this.query=t.state.field(kd).query.spec;function i(t,e,i){return zc("button",{class:"cm-button",name:t,onclick:e,type:"button"},i)}this.commit=this.commit.bind(this),this.searchField=zc("input",{value:e.search,placeholder:Ld(t,"Find"),"aria-label":Ld(t,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=zc("input",{value:e.replace,placeholder:Ld(t,"Replace"),"aria-label":Ld(t,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=zc("input",{type:"checkbox",name:"case",form:"",checked:e.caseSensitive,onchange:this.commit}),this.reField=zc("input",{type:"checkbox",name:"re",form:"",checked:e.regexp,onchange:this.commit}),this.wordField=zc("input",{type:"checkbox",name:"word",form:"",checked:e.wholeWord,onchange:this.commit}),this.dom=zc("div",{onkeydown:t=>this.keydown(t),class:"cm-search"},[this.searchField,i("next",(()=>Xd(t)),[Ld(t,"next")]),i("prev",(()=>Zd(t)),[Ld(t,"previous")]),i("select",(()=>Ad(t)),[Ld(t,"all")]),...t.state.readOnly?[]:[zc("br"),this.replaceField,i("replace",(()=>Td(t)),[Ld(t,"replace")]),i("replaceAll",(()=>Rd(t)),[Ld(t,"replace all")])],zc("button",{name:"close",onclick:()=>Ud(t),"aria-label":Ld(t,"close"),type:"button"},["×"])])}commit(){let t=new pd({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:Sd.of(t)}))}keydown(t){var e,i,n;e=this.view,i=t,n="search-panel",Bs(Ls(e.state),i,e,n)?t.preventDefault():13==t.keyCode&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?Zd:Xd)(this.view)):13==t.keyCode&&t.target==this.replaceField&&(t.preventDefault(),Td(this.view))}update(t){for(let e of t.transactions)for(let t of e.effects)t.is(Sd)&&!t.value.eq(this.query)&&this.setQuery(t.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp,this.wordField.checked=t.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(fd).top}}function Ld(t,e){return t.state.phrase(e)}const zd=30,Id=/[\s\.,:;?!]/;function Bd(t,{from:e,to:i}){let n=t.state.doc.lineAt(e),s=t.state.doc.lineAt(i).to,r=Math.max(n.from,e-zd),o=Math.min(s,i+zd),a=t.state.sliceDoc(r,o);if(r!=n.from)for(let t=0;t<zd;t++)if(!Id.test(a[t+1])&&Id.test(a[t])){a=a.slice(t);break}if(o!=s)for(let t=a.length-1;t>a.length-zd;t--)if(!Id.test(a[t-1])&&Id.test(a[t])){a=a.slice(0,t);break}return Ts.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${n.number}.`)}const jd=Ts.baseTheme({".cm-panel.cm-search":{padding:"0.25rem 0.5rem 0.25rem 0.5rem",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"0.5rem",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Nd=[kd,N.lowest(Cd),jd];class Gd{constructor(t,e,i){this.state=t,this.pos=e,this.explicit=i,this.abortListeners=[]}tokenBefore(t){let e=Ma(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),i=Math.max(e.from,this.pos-250),n=e.text.slice(i-e.from,this.pos-e.from),s=n.search(tu(t,!1));return s<0?null:{from:i+s,to:this.pos,text:n.slice(s)}}get aborted(){return null==this.abortListeners}addEventListener(t,e){"abort"==t&&this.abortListeners&&this.abortListeners.push(e)}}function Hd(t){let e=Object.keys(t).join(""),i=/\w/.test(e);return i&&(e=e.replace(/\w/g,"")),`[${i?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Fd(t){let e=t.map((t=>"string"==typeof t?{label:t}:t)),[i,n]=e.every((t=>/^\w+$/.test(t.label)))?[/\w*$/,/\w+$/]:function(t){let e=Object.create(null),i=Object.create(null);for(let{label:n}of t){e[n[0]]=!0;for(let t=1;t<n.length;t++)i[n[t]]=!0}let n=Hd(e)+Hd(i)+"*$";return[new RegExp("^"+n),new RegExp(n)]}(e);return t=>{let s=t.matchBefore(n);return s||t.explicit?{from:s?s.from:t.pos,options:e,validFor:i}:null}}class Jd{constructor(t,e,i,n){this.completion=t,this.source=e,this.match=i,this.score=n}}function Kd(t){return t.selection.main.from}function tu(t,e){var i;let{source:n}=t,s=e&&"^"!=n[0],r="$"!=n[n.length-1];return s||r?new RegExp(`${s?"^":""}(?:${n})${r?"$":""}`,null!==(i=t.flags)&&void 0!==i?i:t.ignoreCase?"i":""):t}const eu=lt.define();const iu=new WeakMap;function nu(t){if(!Array.isArray(t))return t;let e=iu.get(t);return e||iu.set(t,e=Fd(t)),e}const su=dt.define(),ru=dt.define();class ou{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let e=0;e<t.length;){let i=w(t,e),n=v(i);this.chars.push(i);let s=t.slice(e,e+n),r=s.toUpperCase();this.folded.push(w(r==s?s.toLowerCase():r,0)),e+=n}this.astral=t.length!=this.chars.length}match(t){if(0==this.pattern.length)return[0];if(t.length<this.pattern.length)return null;let{chars:e,folded:i,any:n,precise:s,byWord:r}=this;if(1==e.length){let n=w(t,0),s=v(n),r=s==t.length?0:-100;if(n==e[0]);else{if(n!=i[0])return null;r+=-200}return[r,0,s]}let o=t.indexOf(this.pattern);if(0==o)return[t.length==this.pattern.length?0:-100,0,this.pattern.length];let a=e.length,l=0;if(o<0){for(let s=0,r=Math.min(t.length,200);s<r&&l<a;){let r=w(t,s);r!=e[l]&&r!=i[l]||(n[l++]=s),s+=v(r)}if(l<a)return null}let h=0,c=0,d=!1,u=0,f=-1,p=-1,O=/[a-z]/.test(t),g=!0;for(let n=0,l=Math.min(t.length,200),m=0;n<l&&c<a;){let l=w(t,n);o<0&&(h<a&&l==e[h]&&(s[h++]=n),u<a&&(l==e[u]||l==i[u]?(0==u&&(f=n),p=n+1,u++):u=0));let y,S=l<255?l>=48&&l<=57||l>=97&&l<=122?2:l>=65&&l<=90?1:0:(y=b(l))!=y.toLowerCase()?1:y!=y.toUpperCase()?2:0;(!n||1==S&&O||0==m&&0!=S)&&(e[c]==l||i[c]==l&&(d=!0)?r[c++]=n:r.length&&(g=!1)),m=S,n+=v(l)}return c==a&&0==r[0]&&g?this.result((d?-200:0)-100,r,t):u==a&&0==f?[-200-t.length+(p==t.length?0:-100),0,p]:o>-1?[-700-t.length,o,o+this.pattern.length]:u==a?[-900-t.length,f,p]:c==a?this.result((d?-200:0)-100-700+(g?0:-1100),r,t):2==e.length?null:this.result((n[0]?-700:0)-200-1100,n,t)}result(t,e,i){let n=[t-i.length],s=1;for(let t of e){let e=t+(this.astral?v(w(i,t)):1);s>1&&n[s-1]==t?n[s-1]=e:(n[s++]=t,n[s++]=e)}return n}}const au=E.define({combine:t=>kt(t,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:hu,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>i=>lu(t(i),e(i)),optionClass:(t,e)=>i=>lu(t(i),e(i)),addToOptions:(t,e)=>t.concat(e)})});function lu(t,e){return t?e?t+" "+e:t:e}function hu(t,e,i,n,s){let r,o,a=t.textDirection==Wi.RTL,l=a,h=!1,c="top",d=e.left-s.left,u=s.right-e.right,f=n.right-n.left,p=n.bottom-n.top;if(l&&d<Math.min(f,u)?l=!1:!l&&u<Math.min(f,d)&&(l=!0),f<=(l?d:u))r=Math.max(s.top,Math.min(i.top,s.bottom-p))-e.top,o=Math.min(400,l?d:u);else{h=!0,o=Math.min(400,(a?e.right:s.right-e.left)-30);let t=s.bottom-e.bottom;t>=p||t>e.top?r=i.bottom-e.top:(c="bottom",r=e.bottom-i.top)}return{style:`${c}: ${r}px; max-width: ${o}px`,class:"cm-completionInfo-"+(h?a?"left-narrow":"right-narrow":l?"left":"right")}}function cu(t,e="option"){return i=>{let n=i.state.field(Cu,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<i.state.facet(au).interactionDelay)return!1;let s,r=1;"page"==e&&(s=Ur(i,n.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,a=n.open.selected>-1?n.open.selected+r*(t?1:-1):t?0:o-1;return a<0?a="page"==e?0:o-1:a>=o&&(a="page"==e?o-1:0),i.dispatch({effects:Pu.of(a)}),!0}}const du=t=>{let e=t.state.field(Cu,!1);return!(t.state.readOnly||!e||!e.open||e.open.selected<0||Date.now()-e.open.timestamp<t.state.facet(au).interactionDelay)&&(!!e.open.disabled||pu(t,e.open.options[e.open.selected]))};class uu{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const fu=_i.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of t.state.field(Cu).active)1==e.state&&this.startQuery(e)}update(t){let e=t.state.field(Cu);if(!t.selectionSet&&!t.docChanged&&t.startState.field(Cu)==e)return;let i=t.transactions.some((t=>(t.selection||t.docChanged)&&!xu(t)));for(let e=0;e<this.running.length;e++){let n=this.running[e];if(i||n.updates.length+t.transactions.length>50&&Date.now()-n.time>1e3){for(let t of n.context.abortListeners)try{t()}catch(t){Qi(this.view.state,t)}n.context.abortListeners=null,this.running.splice(e--,1)}else n.updates.push(...t.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some((t=>1==t.state&&!this.running.some((e=>e.active.source==t.source))))?setTimeout((()=>this.startUpdate()),50):-1,0!=this.composing)for(let e of t.transactions)"input"==xu(e)?this.composing=2:2==this.composing&&e.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:t}=this.view,e=t.field(Cu);for(let t of e.active)1!=t.state||this.running.some((e=>e.active.source==t.source))||this.startQuery(t)}startQuery(t){let{state:e}=this.view,i=Kd(e),n=new Gd(e,i,t.explicitPos==i),s=new uu(t,n);this.running.push(s),Promise.resolve(t.source(n)).then((t=>{s.context.aborted||(s.done=t||null,this.scheduleAccept())}),(t=>{this.view.dispatch({effects:ru.of(null)}),Qi(this.view.state,t)}))}scheduleAccept(){this.running.every((t=>void 0!==t.done))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((()=>this.accept()),50))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],i=this.view.state.facet(au);for(let n=0;n<this.running.length;n++){let s=this.running[n];if(void 0===s.done)continue;if(this.running.splice(n--,1),s.done){let n=new Qu(s.active.source,s.active.explicitPos,s.done,s.done.from,null!==(t=s.done.to)&&void 0!==t?t:Kd(s.updates.length?s.updates[0].startState:this.view.state));for(let t of s.updates)n=n.update(t,i);if(n.hasResult()){e.push(n);continue}}let r=this.view.state.field(Cu).active.find((t=>t.source==s.active.source));if(r&&1==r.state)if(null==s.done){let t=new ku(s.active.source,0);for(let e of s.updates)t=t.update(e,i);1!=t.state&&e.push(t)}else this.startQuery(r)}e.length&&this.view.dispatch({effects:$u.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(Cu,!1);if(e&&e.tooltip&&this.view.state.facet(au).closeOnBlur){let i=e.open&&Ur(this.view,e.open.tooltip);i&&i.dom.contains(t.relatedTarget)||this.view.dispatch({effects:ru.of(null)})}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout((()=>this.view.dispatch({effects:su.of(!1)})),20),this.composing=0}}});function pu(t,e){const i=e.completion.apply||e.completion.label;let n=t.state.field(Cu).active.find((t=>t.source==e.source));return n instanceof Qu&&("string"==typeof i?t.dispatch(Object.assign(Object.assign({},function(t,e,i,n){let{main:s}=t.selection,r=i-s.from,o=n-s.from;return Object.assign(Object.assign({},t.changeByRange((a=>a!=s&&i!=n&&t.sliceDoc(a.from+r,a.from+o)!=t.sliceDoc(i,n)?{range:a}:{changes:{from:a.from+r,to:n==s.from?a.to:a.from+o,insert:e},range:A.cursor(a.from+r+e.length)}))),{userEvent:"input.complete"})}(t.state,i,n.from,n.to)),{annotations:eu.of(e.completion)})):i(t,e.completion,n.from,n.to),!0)}function Ou(t,e,i){if(t<=i)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let t=Math.floor(e/i);return{from:t*i,to:(t+1)*i}}let n=Math.floor((t-e)/i);return{from:t-(n+1)*i,to:t-n*i}}class gu{constructor(t,e){this.view=t,this.stateField=e,this.info=null,this.placeInfoReq={read:()=>this.measureInfo(),write:t=>this.placeInfo(t),key:this},this.space=null,this.currentClass="";let i=t.state.field(e),{options:n,selected:s}=i.open,r=t.state.facet(au);this.optionContent=function(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(t){let e=document.createElement("div");return e.classList.add("cm-completionIcon"),t.type&&e.classList.add(...t.type.split(/\s+/g).map((t=>"cm-completionIcon-"+t))),e.setAttribute("aria-hidden","true"),e},position:20}),e.push({render(t,e,i){let n=document.createElement("span");n.className="cm-completionLabel";let{label:s}=t,r=0;for(let t=1;t<i.length;){let e=i[t++],o=i[t++];e>r&&n.appendChild(document.createTextNode(s.slice(r,e)));let a=n.appendChild(document.createElement("span"));a.appendChild(document.createTextNode(s.slice(e,o))),a.className="cm-completionMatchedText",r=o}return r<s.length&&n.appendChild(document.createTextNode(s.slice(r))),n},position:50},{render(t){if(!t.detail)return null;let e=document.createElement("span");return e.className="cm-completionDetail",e.textContent=t.detail,e},position:80}),e.sort(((t,e)=>t.position-e.position)).map((t=>t.render))}(r),this.optionClass=r.optionClass,this.tooltipClass=r.tooltipClass,this.range=Ou(n.length,s,r.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",(e=>{for(let i,s=e.target;s&&s!=this.dom;s=s.parentNode)if("LI"==s.nodeName&&(i=/-(\d+)$/.exec(s.id))&&+i[1]<n.length)return pu(t,n[+i[1]]),void e.preventDefault()})),this.dom.addEventListener("focusout",(e=>{let i=t.state.field(this.stateField,!1);i&&i.tooltip&&t.state.facet(au).closeOnBlur&&e.relatedTarget!=t.contentDOM&&t.dispatch({effects:ru.of(null)})})),this.list=this.dom.appendChild(this.createListBox(n,i.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)}))}mount(){this.updateSel()}update(t){var e,i,n;let s=t.state.field(this.stateField),r=t.startState.field(this.stateField);this.updateTooltipClass(t.state),s!=r&&(this.updateSel(),(null===(e=s.open)||void 0===e?void 0:e.disabled)!=(null===(i=r.open)||void 0===i?void 0:i.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(null===(n=s.open)||void 0===n?void 0:n.disabled)))}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let t of this.currentClass.split(" "))t&&this.dom.classList.remove(t);for(let t of e.split(" "))t&&this.dom.classList.add(t);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=Ou(e.options.length,e.selected,this.view.state.facet(au).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e.options,t.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)}))),this.updateSelectedOption(e.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:i}=e.options[e.selected],{info:n,label:s,c:r}=i;if(!n)return;let o="string"==typeof n?document.createTextNode(n+" "):n(i);if(!o)return;if(!r){const t=document.createElement("span");t.appendChild(o),o=t;const e=document.createElement("a");e.innerText="🔎",e.href="/docFind/"+s,e.target="blank",o.appendChild(e)}if(!o)return;"then"in o?o.then((e=>{e&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(e)})).catch((t=>Qi(this.view.state,t,"completion info"))):this.addInfoPane(o)}}addInfoPane(t){let e=this.info=document.createElement("div");e.className="cm-tooltip cm-completionInfo",e.appendChild(t),this.dom.appendChild(e),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let e=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)"LI"==i.nodeName&&i.id?n==t?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),e=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected"):n--;return e&&function(t,e){let i=t.getBoundingClientRect(),n=e.getBoundingClientRect();n.top<i.top?t.scrollTop-=i.top-n.top:n.bottom>i.bottom&&(t.scrollTop+=n.bottom-i.bottom)}(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=t.getBoundingClientRect(),s=this.space;if(!s){let t=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:t.innerWidth,bottom:t.innerHeight}}return n.top>Math.min(s.bottom,e.bottom)-10||n.bottom<Math.max(s.top,e.top)+10?null:this.view.state.facet(au).positionInfo(this.view,e,n,i,s)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,i){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions"));let s=null;for(let r=i.from;r<i.to;r++){let{completion:o,match:a}=t[r],{section:l}=o;if(l){let t="string"==typeof l?l:l.name;if(t!=s&&(r>i.from||0==i.from))if(s=t,"string"!=typeof l&&l.header)n.appendChild(l.header(l));else{n.appendChild(document.createElement("completion-section")).textContent=t}}const h=n.appendChild(document.createElement("li"));h.id=e+"-"+r,h.setAttribute("role","option");let c=this.optionClass(o);c&&(h.className=c);for(let t of this.optionContent){let e=t(o,this.view.state,a);e&&h.appendChild(e)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}}function mu(t){return 100*(t.boost||0)+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}class wu{constructor(t,e,i,n,s,r){this.options=t,this.attrs=e,this.tooltip=i,this.timestamp=n,this.selected=s,this.disabled=r}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new wu(this.options,yu(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,i,n,s){let r=function(t,e){let i=[],n=null,s=t=>{i.push(t);let{section:e}=t.completion;if(e){n||(n=[]);let t="string"==typeof e?e:e.name;n.some((e=>e.name==t))||n.push("string"==typeof e?{name:t}:e)}};for(let n of t)if(n.hasResult())if(!1===n.result.filter){let t=n.result.getMatch;for(let e of n.result.options){let r=[1e9-i.length];if(t)for(let i of t(e))r.push(i);s(new Jd(e,n.source,r,r[0]))}}else{let t,i=new ou(e.sliceDoc(n.from,n.to));for(let e of n.result.options)(t=i.match(e.label))&&s(new Jd(e,n.source,t,t[0]+(e.boost||0)))}if(n){let t=Object.create(null),e=0,s=(t,e)=>{var i,n;return(null!==(i=t.rank)&&void 0!==i?i:1e9)-(null!==(n=e.rank)&&void 0!==n?n:1e9)||(t.name<e.name?-1:1)};for(let i of n.sort(s))e-=1e5,t[i.name]=e;for(let e of i){let{section:i}=e.completion;i&&(e.score+=t["string"==typeof i?i:i.name])}}let r=[],o=null,a=e.facet(au).compareCompletions;for(let t of i.sort(((t,e)=>e.score-t.score||a(t.completion,e.completion))))!o||o.label!=t.completion.label||o.detail!=t.completion.detail||null!=o.type&&null!=t.completion.type&&o.type!=t.completion.type||o.apply!=t.completion.apply?r.push(t):mu(t.completion)>mu(o)&&(r[r.length-1]=t),o=t.completion;return r}(t,e);if(!r.length)return n&&t.some((t=>1==t.state))?new wu(n.options,n.attrs,n.tooltip,n.timestamp,n.selected,!0):null;let o=e.facet(au).selectOnOpen?0:-1;if(n&&n.selected!=o&&-1!=n.selected){let t=n.options[n.selected].completion;for(let e=0;e<r.length;e++)if(r[e].completion==t){o=e;break}}return new wu(r,yu(i,o),{pos:t.reduce(((t,e)=>e.hasResult()?Math.min(t,e.from):t),1e8),create:(a=Cu,t=>new gu(t,a)),above:s.aboveCursor},n?n.timestamp:Date.now(),o,!1);var a}map(t){return new wu(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class bu{constructor(t,e,i){this.active=t,this.id=e,this.open=i}static start(){return new bu(Su,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(t){let{state:e}=t,i=e.facet(au),n=(i.override||e.languageDataAt("autocomplete",Kd(e)).map(nu)).map((e=>(this.active.find((t=>t.source==e))||new ku(e,this.active.some((t=>0!=t.state))?1:0)).update(t,i)));n.length==this.active.length&&n.every(((t,e)=>t==this.active[e]))&&(n=this.active);let s=this.open;s&&t.docChanged&&(s=s.map(t.changes)),t.selection||n.some((e=>e.hasResult()&&t.changes.touchesRange(e.from,e.to)))||!function(t,e){if(t==e)return!0;for(let i=0,n=0;;){for(;i<t.length&&!t[i].hasResult;)i++;for(;n<e.length&&!e[n].hasResult;)n++;let s=i==t.length,r=n==e.length;if(s||r)return s==r;if(t[i++].result!=e[n++].result)return!1}}(n,this.active)?s=wu.build(n,e,this.id,s,i):s&&s.disabled&&!n.some((t=>1==t.state))&&(s=null),!s&&n.every((t=>1!=t.state))&&n.some((t=>t.hasResult()))&&(n=n.map((t=>t.hasResult()?new ku(t.source,0):t)));for(let e of t.effects)e.is(Pu)&&(s=s&&s.setSelected(e.value,this.id));return n==this.active&&s==this.open?this:new bu(n,this.id,s)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:vu}}const vu={"aria-autocomplete":"list"};function yu(t,e){let i={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(i["aria-activedescendant"]=t+"-"+e),i}const Su=[];function xu(t){return t.isUserEvent("input.type")?"input":t.isUserEvent("delete.backward")?"delete":null}class ku{constructor(t,e,i=-1){this.source=t,this.state=e,this.explicitPos=i}hasResult(){return!1}update(t,e){let i=xu(t),n=this;i?n=n.handleUserEvent(t,i,e):t.docChanged?n=n.handleChange(t):t.selection&&0!=n.state&&(n=new ku(n.source,0));for(let e of t.effects)if(e.is(su))n=new ku(n.source,1,e.value?Kd(t.state):-1);else if(e.is(ru))n=new ku(n.source,0);else if(e.is($u))for(let t of e.value)t.source==n.source&&(n=t);return n}handleUserEvent(t,e,i){return"delete"!=e&&i.activateOnTyping?new ku(this.source,1):this.map(t.changes)}handleChange(t){return t.changes.touchesRange(Kd(t.startState))?new ku(this.source,0):this.map(t.changes)}map(t){return t.empty||this.explicitPos<0?this:new ku(this.source,this.state,t.mapPos(this.explicitPos))}}class Qu extends ku{constructor(t,e,i,n,s){super(t,2,e),this.result=i,this.from=n,this.to=s}hasResult(){return!0}handleUserEvent(t,e,i){var n;let s=t.changes.mapPos(this.from),r=t.changes.mapPos(this.to,1),o=Kd(t.state);if((this.explicitPos<0?o<=s:o<this.from)||o>r||"delete"==e&&Kd(t.startState)==this.from)return new ku(this.source,"input"==e&&i.activateOnTyping?1:0);let a,l=this.explicitPos<0?-1:t.changes.mapPos(this.explicitPos);return function(t,e,i,n){if(!t)return!1;let s=e.sliceDoc(i,n);return"function"==typeof t?t(s,i,n,e):tu(t,!0).test(s)}(this.result.validFor,t.state,s,r)?new Qu(this.source,l,this.result,s,r):this.result.update&&(a=this.result.update(this.result,s,r,new Gd(t.state,o,l>=0)))?new Qu(this.source,l,a,a.from,null!==(n=a.to)&&void 0!==n?n:Kd(t.state)):new ku(this.source,1,l)}handleChange(t){return t.changes.touchesRange(this.from,this.to)?new ku(this.source,0):this.map(t.changes)}map(t){return t.empty?this:new Qu(this.source,this.explicitPos<0?-1:t.mapPos(this.explicitPos),this.result,t.mapPos(this.from),t.mapPos(this.to,1))}}const $u=dt.define({map:(t,e)=>t.map((t=>t.map(e)))}),Pu=dt.define(),Cu=q.define({create:()=>bu.start(),update:(t,e)=>t.update(e),provide:t=>[Tr.from(t,(t=>t.tooltip)),Ts.contentAttributes.from(t,(t=>t.attrs))]}),_u=Ts.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Xu{constructor(t,e,i,n){this.field=t,this.line=e,this.from=i,this.to=n}}class Zu{constructor(t,e,i){this.field=t,this.from=e,this.to=i}map(t){let e=t.mapPos(this.from,-1,S.TrackDel),i=t.mapPos(this.to,1,S.TrackDel);return null==e||null==i?null:new Zu(this.field,e,i)}}class Au{constructor(t,e){this.lines=t,this.fieldPositions=e}instantiate(t,e){let i=[],n=[e],s=t.doc.lineAt(e),r=/^\s*/.exec(s.text)[0];for(let s of this.lines){if(i.length){let i=r,o=/^\t*/.exec(s)[0].length;for(let e=0;e<o;e++)i+=t.facet(Ha);n.push(e+i.length-o),s=i+s.slice(o)}i.push(s),e+=s.length+1}let o=this.fieldPositions.map((t=>new Zu(t.field,n[t.line]+t.from,n[t.line]+t.to)));return{text:i,ranges:o}}static parse(t){let e,i=[],n=[],s=[];for(let r of t.split(/\r\n?|\n/)){for(;e=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(r);){let t=e[1]?+e[1]:null,o=e[2]||e[3]||"",a=-1;for(let e=0;e<i.length;e++)(null!=t?i[e].seq==t:o&&i[e].name==o)&&(a=e);if(a<0){let e=0;for(;e<i.length&&(null==t||null!=i[e].seq&&i[e].seq<t);)e++;i.splice(e,0,{seq:t,name:o}),a=e;for(let t of s)t.field>=a&&t.field++}s.push(new Xu(a,n.length,e.index,e.index+o.length)),r=r.slice(0,e.index)+o+r.slice(e.index+e[0].length)}for(let t;t=/\\([{}])/.exec(r);){r=r.slice(0,t.index)+t[1]+r.slice(t.index+t[0].length);for(let e of s)e.line==n.length&&e.from>t.index&&(e.from--,e.to--)}n.push(r)}return new Au(n,s)}}let Tu=ni.widget({widget:new class extends ei{toDOM(){let t=document.createElement("span");return t.className="cm-snippetFieldPosition",t}ignoreEvent(){return!1}}}),Ru=ni.mark({class:"cm-snippetField"});class Eu{constructor(t,e){this.ranges=t,this.active=e,this.deco=ni.set(t.map((t=>(t.from==t.to?Tu:Ru).range(t.from,t.to))))}map(t){let e=[];for(let i of this.ranges){let n=i.map(t);if(!n)return null;e.push(n)}return new Eu(e,this.active)}selectionInsideField(t){return t.ranges.every((t=>this.ranges.some((e=>e.field==this.active&&e.from<=t.from&&e.to>=t.to))))}}const Vu=dt.define({map:(t,e)=>t&&t.map(e)}),Mu=dt.define(),Du=q.define({create:()=>null,update(t,e){for(let i of e.effects){if(i.is(Vu))return i.value;if(i.is(Mu)&&t)return new Eu(t.ranges,i.value)}return t&&e.docChanged&&(t=t.map(e.changes)),t&&e.selection&&!t.selectionInsideField(e.selection)&&(t=null),t},provide:t=>Ts.decorations.from(t,(t=>t?t.deco:ni.none))});function Wu(t,e){return A.create(t.filter((t=>t.field==e)).map((t=>A.range(t.from,t.to))))}function Uu(e){let i=Au.parse(e);return(e,n,s,r)=>{let{text:o,ranges:a}=i.instantiate(e.state,s),l={changes:{from:s,to:r,insert:t.of(o)},scrollIntoView:!0,annotations:n?eu.of(n):void 0};if(a.length&&(l.selection=Wu(a,0)),a.length>1){let t=new Eu(a,0),i=l.effects=[Vu.of(t)];void 0===e.state.field(Du,!1)&&i.push(dt.appendConfig.of([Du,zu,Bu,_u]))}e.dispatch(e.state.update(l))}}function Yu(t){return({state:e,dispatch:i})=>{let n=e.field(Du,!1);if(!n||t<0&&0==n.active)return!1;let s=n.active+t,r=t>0&&!n.ranges.some((e=>e.field==s+t));return i(e.update({selection:Wu(n.ranges,s),effects:Vu.of(r?null:new Eu(n.ranges,s))})),!0}}const qu=[{key:"Tab",run:Yu(1),shift:Yu(-1)},{key:"Escape",run:({state:t,dispatch:e})=>!!t.field(Du,!1)&&(e(t.update({effects:Vu.of(null)})),!0)}],Lu=E.define({combine:t=>t.length?t[0]:qu}),zu=N.highest(Ys.compute([Lu],(t=>t.facet(Lu))));function Iu(t,e){return Object.assign(Object.assign({},e),{apply:Uu(t)})}const Bu=Ts.domEventHandlers({mousedown(t,e){let i,n=e.state.field(Du,!1);if(!n||null==(i=e.posAtCoords({x:t.clientX,y:t.clientY})))return!1;let s=n.ranges.find((t=>t.from<=i&&t.to>=i));return!(!s||s.field==n.active)&&(e.dispatch({selection:Wu(n.ranges,s.field),effects:Vu.of(n.ranges.some((t=>t.field>s.field))?new Eu(n.ranges,s.field):null)}),!0)}}),ju=new class extends Qt{};function Nu(t={}){return[Cu,au.of(t),fu,Hu,_u]}ju.startSide=1,ju.endSide=-1;const Gu=[{key:"Ctrl-Space",run:t=>!!t.state.field(Cu,!1)&&(t.dispatch({effects:su.of(!0)}),!0)},{key:"Escape",run:t=>{let e=t.state.field(Cu,!1);return!(!e||!e.active.some((t=>0!=t.state)))&&(t.dispatch({effects:ru.of(null)}),!0)}},{key:"ArrowDown",run:cu(!0)},{key:"ArrowUp",run:cu(!1)},{key:"PageDown",run:cu(!0,"page")},{key:"PageUp",run:cu(!1,"page")},{key:"Enter",run:du}],Hu=N.highest(Ys.computeN([au],(t=>t.facet(au).defaultKeymap?[Gu]:[])));class Fu{constructor(t,e,i){this.from=t,this.to=e,this.diagnostic=i}}class Ju{constructor(t,e,i){this.diagnostics=t,this.panel=e,this.selected=i}static init(t,e,i){let n=t,s=i.facet(df).markerFilter;s&&(n=s(n));let r=ni.set(n.map((t=>t.from==t.to||t.from==t.to-1&&i.doc.lineAt(t.from).to==t.from?ni.widget({widget:new pf(t),diagnostic:t}).range(t.from):ni.mark({attributes:{class:"cm-lintRange cm-lintRange-"+t.severity},diagnostic:t}).range(t.from,t.to))),!0);return new Ju(r,e,Ku(r))}}function Ku(t,e=null,i=0){let n=null;return t.between(i,1e9,((t,i,{spec:s})=>{if(!e||s.diagnostic==e)return n=new Fu(t,i,s.diagnostic),!1})),n}function tf(t,e){return t.field(rf,!1)?e:e.concat(dt.appendConfig.of(bf))}const ef=dt.define(),nf=dt.define(),sf=dt.define(),rf=q.define({create:()=>new Ju(ni.none,null,null),update(t,e){if(e.docChanged){let i=t.diagnostics.map(e.changes),n=null;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);n=Ku(i,t.selected.diagnostic,s)||Ku(i,null,s)}t=new Ju(i,t.panel,n)}for(let i of e.effects)i.is(ef)?t=Ju.init(i.value,t.panel,e.state):i.is(nf)?t=new Ju(t.diagnostics,i.value?gf.open:null,t.selected):i.is(sf)&&(t=new Ju(t.diagnostics,t.panel,i.value));return t},provide:t=>[jr.from(t,(t=>t.panel)),Ts.decorations.from(t,(t=>t.diagnostics))]}),of=ni.mark({class:"cm-lintRange cm-lintRange-active"});function af(t,e,i){let{diagnostics:n}=t.state.field(rf),s=[],r=2e8,o=0;n.between(e-(i<0?1:0),e+(i>0?1:0),((t,n,{spec:a})=>{e>=t&&e<=n&&(t==n||(e>t||i>0)&&(e<n||i<0))&&(s.push(a.diagnostic),r=Math.min(t,r),o=Math.max(n,o))}));let a=t.state.facet(df).tooltipFilter;return a&&(s=a(s)),s.length?{pos:r,end:o,above:t.state.doc.lineAt(r).to<o,create:()=>({dom:lf(t,s)})}:null}function lf(t,e){return zc("ul",{class:"cm-tooltip-lint"},e.map((e=>ff(t,e,!1))))}const hf=t=>{let e=t.state.field(rf,!1);return!(!e||!e.panel)&&(t.dispatch({effects:nf.of(!1)}),!0)},cf=_i.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(df);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let t=Date.now();if(t<this.lintTime-10)setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:t}=this.view,{sources:e}=t.facet(df);Promise.all(e.map((t=>Promise.resolve(t(this.view))))).then((e=>{let i=e.reduce(((t,e)=>t.concat(e)));this.view.state.doc==t.doc&&this.view.dispatch(function(t,e){return{effects:tf(t,[ef.of(e)])}}(this.view.state,i))}),(t=>{Qi(this.view.state,t)}))}}update(t){let e=t.state.facet(df);(t.docChanged||e!=t.startState.facet(df)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),df=E.define({combine:t=>Object.assign({sources:t.map((t=>t.source))},kt(t.map((t=>t.config)),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(t,e)=>t?e?i=>t(i)||e(i):t:e}))});function uf(t){let e=[];if(t)t:for(let{name:i}of t){for(let t=0;t<i.length;t++){let n=i[t];if(/[a-zA-Z]/.test(n)&&!e.some((t=>t.toLowerCase()==n.toLowerCase()))){e.push(n);continue t}}e.push("")}return e}function ff(t,e,i){var n;let s=i?uf(e.actions):[];return zc("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},zc("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),null===(n=e.actions)||void 0===n?void 0:n.map(((i,n)=>{let r=!1,o=n=>{if(n.preventDefault(),r)return;r=!0;let s=Ku(t.state.field(rf).diagnostics,e);s&&i.apply(t,s.from,s.to)},{name:a}=i,l=s[n]?a.indexOf(s[n]):-1,h=l<0?a:[a.slice(0,l),zc("u",a.slice(l,l+1)),a.slice(l+1)];return zc("button",{type:"button",class:"cm-diagnosticAction",onclick:o,onmousedown:o,"aria-label":` Action: ${a}${l<0?"":` (access key "${s[n]})"`}.`},h)})),e.source&&zc("div",{class:"cm-diagnosticSource"},e.source))}class pf extends ei{constructor(t){super(),this.diagnostic=t}eq(t){return t.diagnostic==this.diagnostic}toDOM(){return zc("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Of{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=ff(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class gf{constructor(t){this.view=t,this.items=[];this.list=zc("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e=>{if(27==e.keyCode)hf(this.view),this.view.focus();else if(38==e.keyCode||33==e.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==e.keyCode||34==e.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==e.keyCode)this.moveSelection(0);else if(35==e.keyCode)this.moveSelection(this.items.length-1);else if(13==e.keyCode)this.view.focus();else{if(!(e.keyCode>=65&&e.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:i}=this.items[this.selectedIndex],n=uf(i.actions);for(let s=0;s<n.length;s++)if(n[s].toUpperCase().charCodeAt(0)==e.keyCode){let e=Ku(this.view.state.field(rf).diagnostics,i);e&&i.actions[s].apply(t,e.from,e.to)}}}e.preventDefault()},onclick:t=>{for(let e=0;e<this.items.length;e++)this.items[e].dom.contains(t.target)&&this.moveSelection(e)}}),this.dom=zc("div",{class:"cm-panel-lint"},this.list,zc("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>hf(this.view)},"×")),this.update()}get selectedIndex(){let t=this.view.state.field(rf).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(rf),i=0,n=!1,s=null;for(t.between(0,this.view.state.doc.length,((t,r,{spec:o})=>{let a,l=-1;for(let t=i;t<this.items.length;t++)if(this.items[t].diagnostic==o.diagnostic){l=t;break}l<0?(a=new Of(this.view,o.diagnostic),this.items.splice(i,0,a),n=!0):(a=this.items[l],l>i&&(this.items.splice(i,l-i),n=!0)),e&&a.diagnostic==e.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),s=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),i++}));i<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();0==this.items.length&&(this.items.push(new Of(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:t,panel:e})=>{t.top<e.top?this.list.scrollTop-=e.top-t.top:t.bottom>e.bottom&&(this.list.scrollTop+=t.bottom-e.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let t=this.list.firstChild;function e(){let e=t;t=e.nextSibling,e.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;t!=i.dom;)e();t=i.dom.nextSibling}else this.list.insertBefore(i.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=Ku(this.view.state.field(rf).diagnostics,this.items[t].diagnostic);e&&this.view.dispatch({selection:{anchor:e.from,head:e.to},scrollIntoView:!0,effects:sf.of(e)})}static open(t){return new gf(t)}}function mf(t){return function(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const wf=Ts.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:mf("#d11")},".cm-lintRange-warning":{backgroundImage:mf("orange")},".cm-lintRange-info":{backgroundImage:mf("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),bf=[rf,Ts.decorations.compute([rf],(t=>{let{selected:e,panel:i}=t.field(rf);return e&&i&&e.from!=e.to?ni.set([of.range(e.from,e.to)]):ni.none})),Wr(af,{hideOn:function(t,e){return!(!t.effects.some((t=>t.is(ef)))&&!t.changes.touchesRange(e.pos))}}),wf],vf=(()=>[vr(),_h(),ir(),Tl(Vl,{fallback:!0}),Ys.of([...Lc,...Bh])])();class yf{constructor(t,e,i,n,s,r,o,a,l,h=0,c){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=s,this.score=r,this.buffer=o,this.bufferBase=a,this.curContext=l,this.lookAhead=h,this.parent=c}toString(){return`[${this.stack.filter(((t,e)=>e%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new yf(t,[],e,i,i,0,[],0,n?new Sf(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let i=t>>19,n=65535&t,{parser:s}=this.p,r=s.dynamicPrecedence(n);if(r&&(this.score+=r),0==i)return this.pushState(s.getGoto(this.state,n,!0),this.reducePos),n<s.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,4,!0),void this.reduceContext(n,this.reducePos);let o=this.stack.length-3*(i-1)-(262144&t?6:0),a=o?this.stack[o-2]:this.p.ranges[0].from,l=this.reducePos-a;l>=2e3&&!(null===(e=this.p.parser.nodeSet.types[n])||void 0===e?void 0:e.isAnonymous)&&(a==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=l):this.p.lastBigReductionSize<l&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=a,this.p.lastBigReductionSize=l));let h=o?this.stack[o-1]:0,c=this.bufferBase+this.buffer.length-h;if(n<s.minRepeatTerm||131072&t){let t=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,a,t,c+4,!0)}if(262144&t)this.state=this.stack[o];else{let t=this.stack[o-3];this.state=s.getGoto(t,n,!0)}for(;this.stack.length>o;)this.stack.pop();this.reduceContext(n,a)}storeNode(t,e,i,n=4,s=!1){if(0==t&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let t=this,n=this.buffer.length;if(0==n&&t.parent&&(n=t.bufferBase-t.parent.bufferBase,t=t.parent),n>0&&0==t.buffer[n-4]&&t.buffer[n-1]>-1){if(e==i)return;if(t.buffer[n-2]>=e)return void(t.buffer[n-2]=i)}}if(s&&this.pos!=i){let s=this.buffer.length;if(s>0&&0!=this.buffer[s-4])for(;s>0&&this.buffer[s-2]>i;)this.buffer[s]=this.buffer[s-4],this.buffer[s+1]=this.buffer[s-3],this.buffer[s+2]=this.buffer[s-2],this.buffer[s+3]=this.buffer[s-1],s-=4,n>4&&(n-=4);this.buffer[s]=t,this.buffer[s+1]=e,this.buffer[s+2]=i,this.buffer[s+3]=n}else this.buffer.push(t,e,i,n)}shift(t,e,i){let n=this.pos;if(131072&t)this.pushState(65535&t,this.pos);else if(0==(262144&t)){let s=t,{parser:r}=this.p;(i>this.pos||e<=r.maxNode)&&(this.pos=i,r.stateFlag(s,1)||(this.reducePos=i)),this.pushState(s,n),this.shiftContext(e,n),e<=r.maxNode&&this.buffer.push(e,n,i,4)}else this.pos=i,this.shiftContext(e,n),e<=this.p.parser.maxNode&&this.buffer.push(e,n,i,4)}apply(t,e,i){65536&t?this.reduce(t):this.shift(t,e,i)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new yf(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new kf(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(0==i)return!1;if(0==(65536&i))return!0;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let i=[];for(let n,s=0;s<e.length;s+=2)(n=e[s+1])!=this.state&&this.p.parser.hasAction(n,t)&&i.push(e[s],n);if(this.stack.length<120)for(let t=0;i.length<8&&t<e.length;t+=2){let n=e[t+1];i.some(((t,e)=>1&e&&t==n))||i.push(e[t],n)}e=i}let i=[];for(let t=0;t<e.length&&i.length<4;t+=2){let n=e[t+1];if(n==this.state)continue;let s=this.split();s.pushState(n,this.pos),s.storeNode(0,s.pos,s.pos,4,!0),s.shiftContext(e[t],this.pos),s.score-=200,i.push(s)}return i}forceReduce(){let t=this.p.parser.stateSlot(this.state,5);if(0==(65536&t))return!1;let{parser:e}=this.p;if(!e.validAction(this.state,t)){let i=t>>19,n=65535&t,s=this.stack.length-3*i;if(s<0||e.getGoto(this.stack[s],n,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:t}=this.p;return 65535==t.data[t.stateSlot(this.state,1)]&&!t.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||-3!=this.buffer[t])&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||-4!=this.buffer[t])&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new Sf(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Sf{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}var xf;!function(t){t[t.Insert=200]="Insert",t[t.Delete=190]="Delete",t[t.Reduce=100]="Reduce",t[t.MaxNext=4]="MaxNext",t[t.MaxInsertStackDepth=300]="MaxInsertStackDepth",t[t.DampenInsertStackDepth=120]="DampenInsertStackDepth",t[t.MinBigReduction=2e3]="MinBigReduction"}(xf||(xf={}));class kf{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=65535&t,i=t>>19;0==i?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(i-1);let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}}class Qf{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,0==this.index&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new Qf(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new Qf(this.stack,this.pos,this.index)}}function $f(t,e=Uint16Array){if("string"!=typeof t)return t;let i=null;for(let n=0,s=0;n<t.length;){let r=0;for(;;){let e=t.charCodeAt(n++),i=!1;if(126==e){r=65535;break}e>=92&&e--,e>=34&&e--;let s=e-32;if(s>=46&&(s-=46,i=!0),r+=s,i)break;r*=46}i?i[s++]=r:i=new e(r)}return i}class Pf{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Cf=new Pf;class _f{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Cf,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,s=this.pos+t;for(;s<i.from;){if(!n)return null;let t=this.ranges[--n];s-=i.from-t.to,i=t}for(;e<0?s>i.to:s>=i.to;){if(n==this.ranges.length-1)return null;let t=this.ranges[++n];s+=t.from-i.to,i=t}return s}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e,i,n=this.chunkOff+t;if(n>=0&&n<this.chunk.length)e=this.pos+t,i=this.chunk.charCodeAt(n);else{let n=this.resolveOffset(t,1);if(null==n)return-1;if(e=n,e>=this.chunk2Pos&&e<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(e-this.chunk2Pos);else{let t=this.rangeIndex,n=this.range;for(;n.to<=e;)n=this.ranges[++t];this.chunk2=this.input.chunk(this.chunk2Pos=e),e+this.chunk2.length>n.to&&(this.chunk2=this.chunk2.slice(0,n.to-e)),i=this.chunk2.charCodeAt(0)}}return e>=this.token.lookAhead&&(this.token.lookAhead=e+1),i}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(null==i||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=Cf,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}}class Xf{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:i}=e.p;Tf(this.data,t,e,this.id,i.data,i.tokenPrecTable)}}Xf.prototype.contextual=Xf.prototype.fallback=Xf.prototype.extend=!1;class Zf{constructor(t,e,i){this.precTable=e,this.elseToken=i,this.data="string"==typeof t?$f(t):t}token(t,e){let i=t.pos,n=0;for(;Tf(this.data,t,e,0,this.data,this.precTable),!(t.token.value>-1);){if(null==this.elseToken)return;if(t.next<0)break;t.advance(),t.reset(t.pos,t.token),n++}n&&(t.reset(i,t.token),t.acceptToken(this.elseToken,n))}}Zf.prototype.contextual=Xf.prototype.fallback=Xf.prototype.extend=!1;class Af{constructor(t,e={}){this.token=t,this.contextual=!!e.contextual,this.fallback=!!e.fallback,this.extend=!!e.extend}}function Tf(t,e,i,n,s,r){let o=0,a=1<<n,{dialect:l}=i.p.parser;t:for(;0!=(a&t[o]);){let i=t[o+1];for(let n=o+3;n<i;n+=2)if((t[n+1]&a)>0){let i=t[n];if(l.allows(i)&&(-1==e.token.value||e.token.value==i||Ef(i,e.token.value,s,r))){e.acceptToken(i);break}}let n=e.next,h=0,c=t[o+2];if(!(e.next<0&&c>h&&65535==t[i+3*c-3]&&65535==t[i+3*c-3])){for(;h<c;){let s=h+c>>1,r=i+s+(s<<1),a=t[r],l=t[r+1]||65536;if(n<a)c=s;else{if(!(n>=l)){o=t[r+2],e.advance();continue t}h=s+1}}break}o=t[i+3*c-1]}}function Rf(t,e,i){for(let n,s=e;65535!=(n=t[s]);s++)if(n==i)return s-e;return-1}function Ef(t,e,i,n){let s=Rf(i,n,e);return s<0||Rf(i,n,t)<s}const Vf="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let Mf=null;var Df;function Wf(t,e,i){let n=t.cursor(ko.IncludeAnonymous);for(n.moveTo(e);;)if(!(i<0?n.childBefore(e):n.childAfter(e)))for(;;){if((i<0?n.to<e:n.from>e)&&!n.type.isError)return i<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(t.length,Math.max(n.from+1,e+25));if(i<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return i<0?0:t.length}}!function(t){t[t.Margin=25]="Margin"}(Df||(Df={}));let Uf=class{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?Wf(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?Wf(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=i.children[n],r=this.start[e]+i.positions[n];if(r>t)return this.nextStart=r,null;if(s instanceof Qo){if(r==t){if(r<this.safeFrom)return null;let t=r+s.length;if(t<=this.safeTo){let e=s.prop(mo.lookAhead);if(!e||t+e<this.fragment.to)return s}}this.index[e]++,r+s.length>=Math.max(this.safeFrom,t)&&(this.trees.push(s),this.start.push(r),this.index.push(0))}else this.index[e]++,this.nextStart=r+s.length}}};class Yf{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map((t=>new Pf))}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:s}=n,r=n.stateSlot(t.state,3),o=t.curContext?t.curContext.hash:0,a=0;for(let n=0;n<s.length;n++){if(0==(1<<n&r))continue;let l=s[n],h=this.tokens[n];if((!i||l.fallback)&&((l.contextual||h.start!=t.pos||h.mask!=r||h.context!=o)&&(this.updateCachedToken(h,l,t),h.mask=r,h.context=o),h.lookAhead>h.end+25&&(a=Math.max(h.lookAhead,a)),0!=h.value)){let n=e;if(h.extended>-1&&(e=this.addActions(t,h.extended,h.end,e)),e=this.addActions(t,h.value,h.end,e),!l.extend&&(i=h,e>n))break}}for(;this.actions.length>e;)this.actions.pop();return a&&t.setLookAhead(a),i||t.pos!=this.stream.end||(i=new Pf,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new Pf,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){let n=this.stream.clipPos(i.pos);if(e.token(this.stream.reset(n,t),i),t.value>-1){let{parser:e}=i.p;for(let n=0;n<e.specialized.length;n++)if(e.specialized[n]==t.value){let s=e.specializers[n](this.stream.read(t.start,t.end),i);if(s>=0&&i.p.parser.dialect.allows(s>>1)){0==(1&s)?t.value=s>>1:t.extended=s>>1;break}}}else t.value=0,t.end=this.stream.clipPos(n+1)}putAction(t,e,i,n){for(let e=0;e<n;e+=3)if(this.actions[e]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:s}=t,{parser:r}=t.p,{data:o}=r;for(let t=0;t<2;t++)for(let a=r.stateSlot(s,t?2:1);;a+=3){if(65535==o[a]){if(1!=o[a+1]){0==n&&2==o[a+1]&&(n=this.putAction(Gf(o,a+2),e,i,n));break}a=Gf(o,a+2)}o[a]==e&&(n=this.putAction(Gf(o,a+1),e,i,n))}return n}}var qf;!function(t){t[t.Distance=5]="Distance",t[t.MaxRemainingPerStep=3]="MaxRemainingPerStep",t[t.MinBufferLengthPrune=500]="MinBufferLengthPrune",t[t.ForceReduceLimit=10]="ForceReduceLimit",t[t.CutDepth=15e3]="CutDepth",t[t.CutTo=9e3]="CutTo",t[t.MaxLeftAssociativeReductionCount=300]="MaxLeftAssociativeReductionCount",t[t.MaxStackCount=12]="MaxStackCount"}(qf||(qf={}));class Lf{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new _f(e,n),this.tokens=new Yf(t,this.stream),this.topTerm=t.top[1];let{from:s}=n[0];this.stacks=[yf.start(this,t.top[0],s)],this.fragments=i.length&&this.stream.end-s>4*t.bufferLength?new Uf(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t,e,i=this.stacks,n=this.minStackPos,s=this.stacks=[];if(this.bigReductionCount>300&&1==i.length){let[t]=i;for(;t.forceReduce()&&t.stack.length&&t.stack[t.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let r=0;r<i.length;r++){let o=i[r];for(;;){if(this.tokens.mainToken=null,o.pos>n)s.push(o);else{if(this.advanceStack(o,s,i))continue;{t||(t=[],e=[]),t.push(o);let i=this.tokens.getMainToken(o);e.push(i.value,i.end)}}break}}if(!s.length){let e=t&&function(t){let e=null;for(let i of t){let t=i.p.stoppedAt;(i.pos==i.p.stream.end||null!=t&&i.pos>t)&&i.p.parser.stateFlag(i.state,2)&&(!e||e.score<i.score)&&(e=i)}return e}(t);if(e)return this.stackToTree(e);if(this.parser.strict)throw Vf&&t&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+n);this.recovering||(this.recovering=5)}if(this.recovering&&t){let i=null!=this.stoppedAt&&t[0].pos>this.stoppedAt?t[0]:this.runRecovery(t,e,s);if(i)return this.stackToTree(i.forceAll())}if(this.recovering){let t=1==this.recovering?1:3*this.recovering;if(s.length>t)for(s.sort(((t,e)=>e.score-t.score));s.length>t;)s.pop();s.some((t=>t.reducePos>n))&&this.recovering--}else if(s.length>1){t:for(let t=0;t<s.length-1;t++){let e=s[t];for(let i=t+1;i<s.length;i++){let n=s[i];if(e.sameState(n)||e.buffer.length>500&&n.buffer.length>500){if(!((e.score-n.score||e.buffer.length-n.buffer.length)>0)){s.splice(t--,1);continue t}s.splice(i--,1)}}}s.length>12&&s.splice(12,s.length-12)}this.minStackPos=s[0].pos;for(let t=1;t<s.length;t++)s[t].pos<this.minStackPos&&(this.minStackPos=s[t].pos);return null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:s}=this,r=Vf?this.stackID(t)+" -> ":"";if(null!=this.stoppedAt&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let e=t.curContext&&t.curContext.tracker.strict,i=e?t.curContext.hash:0;for(let o=this.fragments.nodeAt(n);o;){let n=this.parser.nodeSet.types[o.type.id]==o.type?s.getGoto(t.state,o.type.id):-1;if(n>-1&&o.length&&(!e||(o.prop(mo.contextHash)||0)==i))return t.useNode(o,n),Vf&&console.log(r+this.stackID(t)+` (via reuse of ${s.getName(o.type.id)})`),!0;if(!(o instanceof Qo)||0==o.children.length||o.positions[0]>0)break;let a=o.children[0];if(!(a instanceof Qo&&0==o.positions[0]))break;o=a}}let o=s.stateSlot(t.state,4);if(o>0)return t.reduce(o),Vf&&console.log(r+this.stackID(t)+` (via always-reduce ${s.getName(65535&o)})`),!0;if(t.stack.length>=15e3)for(;t.stack.length>9e3&&t.forceReduce(););let a=this.tokens.getActions(t);for(let o=0;o<a.length;){let l=a[o++],h=a[o++],c=a[o++],d=o==a.length||!i,u=d?t:t.split();if(u.apply(l,h,c),Vf&&console.log(r+this.stackID(u)+` (via ${0==(65536&l)?"shift":`reduce of ${s.getName(65535&l)}`} for ${s.getName(h)} @ ${n}${u==t?"":", split"})`),d)return!0;u.pos>n?e.push(u):i.push(u)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return zf(t,e),!0}}runRecovery(t,e,i){let n=null,s=!1;for(let r=0;r<t.length;r++){let o=t[r],a=e[r<<1],l=e[1+(r<<1)],h=Vf?this.stackID(o)+" -> ":"";if(o.deadEnd){if(s)continue;if(s=!0,o.restart(),Vf&&console.log(h+this.stackID(o)+" (restarted)"),this.advanceFully(o,i))continue}let c=o.split(),d=h;for(let t=0;c.forceReduce()&&t<10;t++){if(Vf&&console.log(d+this.stackID(c)+" (via force-reduce)"),this.advanceFully(c,i))break;Vf&&(d=this.stackID(c)+" -> ")}for(let t of o.recoverByInsert(a))Vf&&console.log(h+this.stackID(t)+" (via recover-insert)"),this.advanceFully(t,i);this.stream.end>o.pos?(l==o.pos&&(l++,a=0),o.recoverByDelete(a,l),Vf&&console.log(h+this.stackID(o)+` (via recover-delete ${this.parser.getName(a)})`),zf(o,i)):(!n||n.score<o.score)&&(n=o)}return n}stackToTree(t){return t.close(),Qo.build({buffer:Qf.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(Mf||(Mf=new WeakMap)).get(t);return e||Mf.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function zf(t,e){for(let i=0;i<e.length;i++){let n=e[i];if(n.pos==t.pos&&n.sameState(t))return void(e[i].score<t.score&&(e[i]=t))}e.push(t)}class If{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||0==this.disabled[t]}}const Bf=t=>t;class jf{constructor(t){this.start=t.start,this.shift=t.shift||Bf,this.reduce=t.reduce||Bf,this.reuse=t.reuse||Bf,this.hash=t.hash||(()=>0),this.strict=!1!==t.strict}}class Nf extends Lo{constructor(t){if(super(),this.wrappers=[],14!=t.version)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let i=0;i<t.repeatNodeCount;i++)e.push("");let i=Object.keys(t.topRules).map((e=>t.topRules[e][1])),n=[];for(let t=0;t<e.length;t++)n.push([]);function s(t,e,i){n[t].push([e,e.deserialize(String(i))])}if(t.nodeProps)for(let e of t.nodeProps){let t=e[0];"string"==typeof t&&(t=mo[t]);for(let i=1;i<e.length;){let n=e[i++];if(n>=0)s(n,t,e[i++]);else{let r=e[i+-n];for(let o=-n;o>0;o--)s(e[i++],t,r);i++}}}this.nodeSet=new yo(e.map(((e,s)=>vo.define({name:s>=this.minRepeatTerm?void 0:e,id:s,props:n[s],top:i.indexOf(s)>-1,error:0==s,skipped:t.skippedNodes&&t.skippedNodes.indexOf(s)>-1})))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=po;let r=$f(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let t=0;t<this.specializerSpecs.length;t++)this.specialized[t]=this.specializerSpecs[t].term;this.specializers=this.specializerSpecs.map(Hf),this.states=$f(t.states,Uint32Array),this.data=$f(t.stateData),this.goto=$f(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map((t=>"number"==typeof t?new Xf(r,t):t)),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new Lf(this,t,e,i);for(let s of this.wrappers)n=s(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return-1;for(let s=n[e+1];;){let e=n[s++],r=1&e,o=n[s++];if(r&&i)return o;for(let i=s+(e>>1);s<i;s++)if(n[s]==t)return o;if(r)return-1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let s,r=this.stateSlot(t,n?2:1);;r+=3){if(65535==(s=i[r])){if(1!=i[r+1]){if(2==i[r+1])return Gf(i,r+2);break}s=i[r=Gf(i,r+2)]}if(s==e||0==s)return Gf(i,r+1)}return 0}stateSlot(t,e){return this.states[6*t+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){if(e==this.stateSlot(t,4))return!0;for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])return!1;i=Gf(this.data,i+2)}if(e==Gf(this.data,i+1))return!0}}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])break;i=Gf(this.data,i+2)}if(0==(1&this.data[i+2])){let t=this.data[i+1];e.some(((e,i)=>1&i&&e==t))||e.push(this.data[i],t)}}return e}configure(t){let e=Object.assign(Object.create(Nf.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map((e=>{let i=t.tokenizers.find((t=>t.from==e));return i?i.to:e}))),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map(((i,n)=>{let s=t.specializers.find((t=>t.from==i.external));if(!s)return i;let r=Object.assign(Object.assign({},i),{external:s.to});return e.specializers[n]=Hf(r),r}))),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),null!=t.strict&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),null!=t.bufferLength&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return null==e?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map((()=>!1));if(t)for(let n of t.split(" ")){let t=e.indexOf(n);t>=0&&(i[t]=!0)}let n=null;for(let t=0;t<e.length;t++)if(!i[t])for(let i,s=this.dialects[e[t]];65535!=(i=this.data[s++]);)(n||(n=new Uint8Array(this.maxTerm+1)))[i]=1;return new If(t,i,n)}static deserialize(t){return new Nf(t)}}function Gf(t,e){return t[e]|t[e+1]<<16}function Hf(t){if(t.external){let e=t.extend?1:0;return(i,n)=>t.external(i,n)<<1|e}return t.get}const Ff=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],Jf=new jf({start:!1,shift:(t,e)=>3==e||4==e||305==e?t:306==e,strict:!1}),Kf=new Af(((t,e)=>{let{next:i}=t;(125==i||-1==i||e.context)&&e.canShift(303)&&t.acceptToken(303)}),{contextual:!0,fallback:!0}),tp=new Af(((t,e)=>{let i,{next:n}=t;Ff.indexOf(n)>-1||(47!=n||47!=(i=t.peek(1))&&42!=i)&&125!=n&&59!=n&&-1!=n&&!e.context&&e.canShift(302)&&t.acceptToken(302)}),{contextual:!0}),ep=new Af(((t,e)=>{let{next:i}=t;if((43==i||45==i)&&(t.advance(),i==t.next)){t.advance();let i=!e.context&&e.canShift(1);t.acceptToken(i?1:2)}}),{contextual:!0}),ip=la({"get set async static":_a.modifier,"for while do if else switch try catch finally return throw break continue default case":_a.controlKeyword,"in of await yield void typeof delete instanceof":_a.operatorKeyword,"let var const function class extends":_a.definitionKeyword,"import export from":_a.moduleKeyword,"with debugger as new":_a.keyword,TemplateString:_a.special(_a.string),super:_a.atom,BooleanLiteral:_a.bool,this:_a.self,null:_a.null,Star:_a.modifier,VariableName:_a.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":_a.function(_a.variableName),VariableDefinition:_a.definition(_a.variableName),Label:_a.labelName,PropertyName:_a.propertyName,PrivatePropertyName:_a.special(_a.propertyName),"CallExpression/MemberExpression/PropertyName":_a.function(_a.propertyName),"FunctionDeclaration/VariableDefinition":_a.function(_a.definition(_a.variableName)),"ClassDeclaration/VariableDefinition":_a.definition(_a.className),PropertyDefinition:_a.definition(_a.propertyName),PrivatePropertyDefinition:_a.definition(_a.special(_a.propertyName)),UpdateOp:_a.updateOperator,LineComment:_a.lineComment,BlockComment:_a.blockComment,Number:_a.number,String:_a.string,Escape:_a.escape,ArithOp:_a.arithmeticOperator,LogicOp:_a.logicOperator,BitOp:_a.bitwiseOperator,CompareOp:_a.compareOperator,RegExp:_a.regexp,Equals:_a.definitionOperator,Arrow:_a.function(_a.punctuation),": Spread":_a.punctuation,"( )":_a.paren,"[ ]":_a.squareBracket,"{ }":_a.brace,"InterpolationStart InterpolationEnd":_a.special(_a.brace),".":_a.derefOperator,", ;":_a.separator,"@":_a.meta,TypeName:_a.typeName,TypeDefinition:_a.definition(_a.typeName),"type enum interface implements namespace module declare":_a.definitionKeyword,"abstract global Privacy readonly override":_a.modifier,"is keyof unique infer":_a.operatorKeyword,JSXAttributeValue:_a.attributeValue,JSXText:_a.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":_a.angleBracket,"JSXIdentifier JSXNameSpacedName":_a.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":_a.attributeName,"JSXBuiltin/JSXIdentifier":_a.standard(_a.tagName)}),np={__proto__:null,export:14,as:19,from:27,default:30,async:35,function:36,extends:46,this:50,true:58,false:58,null:70,void:74,typeof:78,super:96,new:130,delete:146,yield:155,await:159,class:164,public:221,private:221,protected:221,readonly:223,instanceof:242,satisfies:245,in:246,const:248,import:280,keyof:335,unique:339,infer:345,is:381,abstract:401,implements:403,type:405,let:408,var:410,interface:417,enum:421,namespace:427,module:429,declare:433,global:437,for:456,of:465,while:468,with:472,do:476,if:480,else:482,switch:486,case:492,try:498,catch:502,finally:506,return:510,throw:514,break:518,continue:522,debugger:526},sp={__proto__:null,async:117,get:119,set:121,declare:181,public:183,private:183,protected:183,static:185,abstract:187,override:189,readonly:195,accessor:197,new:385},rp={__proto__:null,"<":137},op=Nf.deserialize({version:14,states:"$6[O`QUOOO%QQUOOO'TQWOOP(bOSOOO*pQ(CjO'#CfO*wOpO'#CgO+VO!bO'#CgO+eO07`O'#DZO-vQUO'#DaO.WQUO'#DlO%QQUO'#DvO0[QUO'#EOOOQ(CY'#EW'#EWO0uQSO'#ETOOQO'#Ei'#EiOOQO'#Ib'#IbO0}QSO'#GkO1YQSO'#EhO1_QSO'#EhO3aQ(CjO'#JcO6QQ(CjO'#JdO6nQSO'#FWO6sQ#tO'#FoOOQ(CY'#F`'#F`O7OO&jO'#F`O7^Q,UO'#FvO8tQSO'#FuOOQ(CY'#Jd'#JdOOQ(CW'#Jc'#JcOOQQ'#KO'#KOO8yQSO'#IOO9OQ(C[O'#IPOOQQ'#JP'#JPOOQQ'#IT'#ITQ`QUOOO%QQUO'#DnO9WQUO'#DzO%QQUO'#D|O9_QSO'#GkO9dQ,UO'#ClO9rQSO'#EgO9}QSO'#ErO:SQ,UO'#F_O:qQSO'#GkO:vQSO'#GoO;RQSO'#GoO;aQSO'#GrO;aQSO'#GsO;aQSO'#GuO9_QSO'#GxO<QQSO'#G{O=cQSO'#CbO=sQSO'#HXO={QSO'#H_O={QSO'#HaO`QUO'#HcO={QSO'#HeO={QSO'#HhO>QQSO'#HnO>VQ(C]O'#HtO%QQUO'#HvO>bQ(C]O'#HxO>mQ(C]O'#HzO9OQ(C[O'#H|O>xQ(CjO'#CfO?zQWO'#DfQOQSOOO@bQSO'#EPO9dQ,UO'#EgO@mQSO'#EgO@xQ`O'#F_OOQQ'#Cd'#CdOOQ(CW'#Dk'#DkOOQ(CW'#Jg'#JgO%QQUO'#JgOOQO'#Jk'#JkOOQO'#I_'#I_OAxQWO'#E`OOQ(CW'#E_'#E_OBtQ(C`O'#E`OCOQWO'#ESOOQO'#Jj'#JjOCdQWO'#JkODqQWO'#ESOCOQWO'#E`PEOO?MpO'#C`POOO)CDn)CDnOOOO'#IU'#IUOEZOpO,59ROOQ(CY,59R,59ROOOO'#IV'#IVOEiO!bO,59RO%QQUO'#D]OOOO'#IX'#IXOEwO07`O,59uOOQ(CY,59u,59uOFVQUO'#IYOFjQSO'#JeOHlQbO'#JeO+sQUO'#JeOHsQSO,59{OIZQSO'#EiOIhQSO'#JsOIsQSO'#JrOIsQSO'#JrOI{QSO,5;VOJQQSO'#JqOOQ(CY,5:W,5:WOJXQUO,5:WOLYQ(CjO,5:bOLyQSO,5:jOMdQ(C[O'#JpOMkQSO'#JoO:vQSO'#JoONPQSO'#JoONXQSO,5;UON^QSO'#JoO!!fQbO'#JdOOQ(CY'#Cf'#CfO%QQUO'#EOO!#UQ`O,5:oOOQO'#Jl'#JlOOQO-E<`-E<`O9_QSO,5=VO!#lQSO,5=VO!#qQUO,5;SO!%tQ,UO'#EdO!'XQSO,5;SO!(qQ,UO'#DpO!(xQUO'#DuO!)SQWO,5;]O!)[QWO,5;]O%QQUO,5;]OOQQ'#FO'#FOOOQQ'#FQ'#FQO%QQUO,5;^O%QQUO,5;^O%QQUO,5;^O%QQUO,5;^O%QQUO,5;^O%QQUO,5;^O%QQUO,5;^O%QQUO,5;^O%QQUO,5;^O%QQUO,5;^O%QQUO,5;^OOQQ'#FU'#FUO!)jQUO,5;oOOQ(CY,5;t,5;tOOQ(CY,5;u,5;uO!+mQSO,5;uOOQ(CY,5;v,5;vO%QQUO'#IfO!+uQ(C[O,5<cO!%tQ,UO,5;^O!,dQ,UO,5;^O%QQUO,5;rO!,kQ#tO'#FeO!-hQ#tO'#JwO!-SQ#tO'#JwO!-oQ#tO'#JwOOQO'#Jw'#JwO!.TQ#tO,5;}OOOO,5<Z,5<ZO!.fQUO'#FqOOOO'#Ie'#IeO7OO&jO,5;zO!.mQ#tO'#FsOOQ(CY,5;z,5;zO!/^Q7[O'#CrOOQ(CY'#Cv'#CvO!/qQSO'#CvO!/vO07`O'#CzO!0dQ,UO,5<`O!0kQSO,5<bO!2QQMhO'#GQO!2_QSO'#GRO!2dQSO'#GRO!2iQMhO'#GVO!3hQWO'#GZO!4ZQ7[O'#J^OOQ(CY'#J^'#J^O!4eQSO'#J]O!4sQSO'#J[O!4{QSO'#CqOOQ(CY'#Ct'#CtOOQ(CY'#DO'#DOOOQ(CY'#DQ'#DQO0xQSO'#DSO!'^Q,UO'#FxO!'^Q,UO'#FzO!5TQSO'#F|O!5YQSO'#F}O!2dQSO'#GTO!'^Q,UO'#GYO!5_QSO'#EjO!5|QSO,5<aO`QUO,5>jOOQQ'#JX'#JXOOQQ,5>k,5>kOOQQ-E<R-E<RO!7{Q(CjO,5:YO!:iQ(CjO,5:fO%QQUO,5:fO!=SQ(CjO,5:hOOQ(CW'#Co'#CoO!=sQ,UO,5=VO!>RQ(C[O'#JYO8tQSO'#JYO!>dQ(C[O,59WO!>oQWO,59WO!>wQ,UO,59WO9dQ,UO,59WO!?SQSO,5;SO!?[QSO'#HWO!?mQSO'#KSO%QQUO,5;wO!?uQWO,5;yO!?zQSO,5=qO!@PQSO,5=qO!@UQSO,5=qO9OQ(C[O,5=qO!@dQSO'#EkO!A^QWO'#ElOOQ(CW'#Jq'#JqO!AeQ(C[O'#KPO9OQ(C[O,5=ZO;aQSO,5=aOOQO'#Cr'#CrO!ApQWO,5=^O!AxQ,UO,5=_O!BTQSO,5=aO!BYQ`O,5=dO>QQSO'#G}O9_QSO'#HPO!BbQSO'#HPO9dQ,UO'#HRO!BgQSO'#HROOQQ,5=g,5=gO!BlQSO'#HSO!BtQSO'#ClO!ByQSO,58|O!CTQSO,58|O!E]QUO,58|OOQQ,58|,58|O!EjQ(C[O,58|O%QQUO,58|O!EuQUO'#HZOOQQ'#H['#H[OOQQ'#H]'#H]O`QUO,5=sO!FVQSO,5=sO`QUO,5=yO`QUO,5={O!F[QSO,5=}O`QUO,5>PO!FaQSO,5>SO!FfQUO,5>YOOQQ,5>`,5>`O%QQUO,5>`O9OQ(C[O,5>bOOQQ,5>d,5>dO!JmQSO,5>dOOQQ,5>f,5>fO!JmQSO,5>fOOQQ,5>h,5>hO!JrQWO'#DXO%QQUO'#JgO!KaQWO'#JgO!LOQWO'#DgO!LaQWO'#DgO!NrQUO'#DgO!NyQSO'#JfO# RQSO,5:QO# WQSO'#EmO# fQSO'#JtO# nQSO,5;WO# sQWO'#DgO#!QQWO'#EROOQ(CY,5:k,5:kO%QQUO,5:kO#!XQSO,5:kO>QQSO,5;RO!>oQWO,5;RO!>wQ,UO,5;RO9dQ,UO,5;RO#!aQSO,5@RO#!fQ!LQO,5:oOOQO-E<]-E<]O##lQ(C`O,5:zOCOQWO,5:nO##vQWO,5:nOCOQWO,5:zO!>dQ(C[O,5:nOOQ(CW'#Ec'#EcOOQO,5:z,5:zO%QQUO,5:zO#$TQ(C[O,5:zO#$`Q(C[O,5:zO!>oQWO,5:nOOQO,5;Q,5;QO#$nQ(C[O,5:zPOOO'#IS'#ISP#%SO?MpO,58zPOOO,58z,58zOOOO-E<S-E<SOOQ(CY1G.m1G.mOOOO-E<T-E<TO#%_Q`O,59wOOOO-E<V-E<VOOQ(CY1G/a1G/aO#%dQbO,5>tO+sQUO,5>tOOQO,5>z,5>zO#%nQUO'#IYOOQO-E<W-E<WO#%{QSO,5@PO#&TQbO,5@PO#&[QSO,5@^OOQ(CY1G/g1G/gO%QQUO,5@_O#&dQSO'#I`OOQO-E<^-E<^O#&[QSO,5@^OOQ(CW1G0q1G0qOOQ(CY1G/r1G/rOOQ(CY1G0U1G0UO%QQUO,5@[O#&xQ(C[O,5@[O#'ZQ(C[O,5@[O#'bQSO,5@ZO:vQSO,5@ZO#'jQSO,5@ZO#'xQSO'#IcO#'bQSO,5@ZOOQ(CW1G0p1G0pO!)SQWO,5:qO!)_QWO,5:qOOQO,5:s,5:sO#(jQSO,5:sO#(rQ,UO1G2qO9_QSO1G2qOOQ(CY1G0n1G0nO#)QQ(CjO1G0nO#*VQ(ChO,5;OOOQ(CY'#GP'#GPO#*sQ(CjO'#J^O!#qQUO1G0nO#,{Q,UO'#JhO#-VQSO,5:[O#-[QbO'#JiO%QQUO'#JiO#-fQSO,5:aOOQ(CY'#DX'#DXOOQ(CY1G0w1G0wO%QQUO1G0wOOQ(CY1G1a1G1aO#-kQSO1G0wO#0SQ(CjO1G0xO#0ZQ(CjO1G0xO#2tQ(CjO1G0xO#2{Q(CjO1G0xO#5VQ(CjO1G0xO#5mQ(CjO1G0xO#8gQ(CjO1G0xO#8nQ(CjO1G0xO#;XQ(CjO1G0xO#;`Q(CjO1G0xO#=WQ(CjO1G0xO#@WQ$IUO'#CfO#BUQ$IUO1G1ZO#B]Q$IUO'#JdO!+pQSO1G1aO#BmQ(CjO,5?QOOQ(CW-E<d-E<dO#CaQ(CjO1G0xOOQ(CY1G0x1G0xO#ElQ(CjO1G1^O#F`Q#tO,5<RO#FhQ#tO,5<SO#FpQ#tO'#FjO#GXQSO'#FiOOQO'#Jx'#JxOOQO'#Id'#IdO#G^Q#tO1G1iOOQ(CY1G1i1G1iOOOO1G1t1G1tO#GoQ$IUO'#JcO#GyQSO,5<]O!)jQUO,5<]OOOO-E<c-E<cOOQ(CY1G1f1G1fO#HOQWO'#JwOOQ(CY,5<_,5<_O#HWQWO,5<_OOQ(CY,59b,59bO!%tQ,UO'#C|OOOO'#IW'#IWO#H]O07`O,59fOOQ(CY,59f,59fO%QQUO1G1zO!5YQSO'#IhO#HhQSO,5<sOOQ(CY,5<p,5<pOOQO'#Gf'#GfO!'^Q,UO,5=POOQO'#Gh'#GhO!'^Q,UO,5=RO!%tQ,UO,5=TOOQO1G1|1G1|O#HvQ`O'#CoO#IZQ`O,5<lO#IbQSO'#J{O9_QSO'#J{O#IpQSO,5<nO!'^Q,UO,5<mO#IuQSO'#GSO#JQQSO,5<mO#JVQ`O'#GPO#JdQ`O'#J|O#JnQSO'#J|O!%tQ,UO'#J|O#JsQSO,5<qO#JxQWO'#G[O!3cQWO'#G[O#KZQSO'#G^O#K`QSO'#G`O!2dQSO'#GcO#KeQ(C[O'#IjO#KpQWO,5<uOOQ(CY,5<u,5<uO#KwQWO'#G[O#LVQWO'#G]O#L_QWO'#G]OOQ(CY,5=U,5=UO!'^Q,UO,5?wO!'^Q,UO,5?wO#LdQSO'#IkO#LoQSO,5?vO#LwQSO,59]O#MhQ,UO,59nOOQ(CY,59n,59nO#NZQ,UO,5<dO#N|Q,UO,5<fO?rQSO,5<hOOQ(CY,5<i,5<iO$ WQSO,5<oO$ ]Q,UO,5<tO$ mQSO'#JoO!#qQUO1G1{O$ rQSO1G1{OOQQ1G4U1G4UOOQ(CY1G/t1G/tO!+mQSO1G/tO$#qQ(CjO1G0QOOQQ1G2q1G2qO!%tQ,UO1G2qO%QQUO1G2qO$$bQSO1G2qO$$mQ,UO'#EdOOQ(CW,5?t,5?tO$$wQ(C[O,5?tOOQQ1G.r1G.rO!>dQ(C[O1G.rO!>oQWO1G.rO!>wQ,UO1G.rO$%YQSO1G0nO$%_QSO'#CfO$%jQSO'#KTO$%rQSO,5=rO$%wQSO'#KTO$%|QSO'#KTO$&XQSO'#IsO$&gQSO,5@nO$&oQbO1G1cOOQ(CY1G1e1G1eO9_QSO1G3]O?rQSO1G3]O$&vQSO1G3]O$&{QSO1G3]OOQQ1G3]1G3]O:vQSO'#JrO:vQSO'#EmO%QQUO'#EmO:vQSO'#ImO$'QQ(C[O,5@kOOQQ1G2u1G2uO!BTQSO1G2{O!%tQ,UO1G2xO$']QSO1G2xOOQQ1G2y1G2yO!%tQ,UO1G2yO$'bQSO1G2yO$'jQWO'#GwOOQQ1G2{1G2{O!3cQWO'#IoO!BYQ`O1G3OOOQQ1G3O1G3OOOQQ,5=i,5=iO$'rQ,UO,5=kO9_QSO,5=kO#K`QSO,5=mO8tQSO,5=mO!>oQWO,5=mO!>wQ,UO,5=mO9dQ,UO,5=mO$(QQSO'#KRO$(]QSO,5=nOOQQ1G.h1G.hO$(bQ(C[O1G.hO?rQSO1G.hO$(mQSO1G.hO9OQ(C[O1G.hO$*rQbO,5@pO$+SQSO,5@pO$+_QUO,5=uO$+fQSO,5=uO:vQSO,5@pOOQQ1G3_1G3_O`QUO1G3_OOQQ1G3e1G3eOOQQ1G3g1G3gO={QSO1G3iO$+kQUO1G3kO$/lQUO'#HjOOQQ1G3n1G3nO$/yQSO'#HpO>QQSO'#HrOOQQ1G3t1G3tO$0RQUO1G3tO9OQ(C[O1G3zOOQQ1G3|1G3|OOQ(CW'#GW'#GWO9OQ(C[O1G4OO9OQ(C[O1G4QO$4VQSO,5@RO!)jQUO,5;XO:vQSO,5;XO>QQSO,5:RO!)jQUO,5:RO!>oQWO,5:RO$4[Q$IUO,5:ROOQO,5;X,5;XO$4fQWO'#IZO$4|QSO,5@QOOQ(CY1G/l1G/lO$5UQWO'#IaO$5`QSO,5@`OOQ(CW1G0r1G0rO!LaQWO,5:ROOQO'#I^'#I^O$5hQWO,5:mOOQ(CY,5:m,5:mO#![QSO1G0VOOQ(CY1G0V1G0VO%QQUO1G0VOOQ(CY1G0m1G0mO>QQSO1G0mO!>oQWO1G0mO!>wQ,UO1G0mOOQ(CW1G5m1G5mO!>dQ(C[O1G0YOOQO1G0f1G0fO%QQUO1G0fO$5oQ(C[O1G0fO$5zQ(C[O1G0fO!>oQWO1G0YOCOQWO1G0YO$6YQ(C[O1G0fOOQO1G0Y1G0YO$6nQ(CjO1G0fPOOO-E<Q-E<QPOOO1G.f1G.fOOOO1G/c1G/cO$6xQ`O,5<cO$7QQbO1G4`OOQO1G4f1G4fO%QQUO,5>tO$7[QSO1G5kO$7dQSO1G5xO$7lQbO1G5yO:vQSO,5>zO$7vQ(CjO1G5vO%QQUO1G5vO$8WQ(C[O1G5vO$8iQSO1G5uO$8iQSO1G5uO:vQSO1G5uO$8qQSO,5>}O:vQSO,5>}OOQO,5>},5>}O$9VQSO,5>}O$ mQSO,5>}OOQO-E<a-E<aOOQO1G0]1G0]OOQO1G0_1G0_O!+pQSO1G0_OOQQ7+(]7+(]O!%tQ,UO7+(]O%QQUO7+(]O$9eQSO7+(]O$9pQ,UO7+(]O$:OQ(CjO,59nO$<WQ(CjO,5<dO$>cQ(CjO,5<fO$@nQ(CjO,5<tOOQ(CY7+&Y7+&YO$CPQ(CjO7+&YO$CsQ,UO'#I[O$C}QSO,5@SOOQ(CY1G/v1G/vO$DVQUO'#I]O$DdQSO,5@TO$DlQbO,5@TOOQ(CY1G/{1G/{O$DvQSO7+&cOOQ(CY7+&c7+&cO$D{Q$IUO,5:bO%QQUO7+&uO$EVQ$IUO,5:YO$EdQ$IUO,5:fO$EnQ$IUO,5:hOOQ(CY7+&{7+&{OOQO1G1m1G1mOOQO1G1n1G1nO$ExQ#tO,5<UO!)jQUO,5<TOOQO-E<b-E<bOOQ(CY7+'T7+'TOOOO7+'`7+'`OOOO1G1w1G1wO$FTQSO1G1wOOQ(CY1G1y1G1yO$FYQ`O,59hOOOO-E<U-E<UOOQ(CY1G/Q1G/QO$FaQ(CjO7+'fOOQ(CY,5?S,5?SO$GTQSO,5?SOOQ(CY1G2_1G2_P$GYQSO'#IhPOQ(CY-E<f-E<fO$G|Q,UO1G2kO$HoQ,UO1G2mO$HyQ`O1G2oOOQ(CY1G2W1G2WO$IQQSO'#IgO$I`QSO,5@gO$I`QSO,5@gO$IhQSO,5@gO$IsQSO,5@gOOQO1G2Y1G2YO$JRQ,UO1G2XO!'^Q,UO1G2XO$JcQMhO'#IiO$JsQSO,5@hO!%tQ,UO,5@hO$J{Q`O,5@hOOQ(CY1G2]1G2]OOQ(CW,5<v,5<vOOQ(CW,5<w,5<wO$ mQSO,5<wOBoQSO,5<wO!>oQWO,5<vOOQO'#G_'#G_O$KVQSO,5<xOOQ(CW,5<z,5<zO$ mQSO,5<}OOQO,5?U,5?UOOQO-E<h-E<hOOQ(CY1G2a1G2aO!3cQWO,5<vO$K_QSO,5<wO#KZQSO,5<xO!3cQWO,5<wO$KjQ,UO1G5cO$KtQ,UO1G5cOOQO,5?V,5?VOOQO-E<i-E<iOOQO1G.w1G.wO!?uQWO,59pO%QQUO,59pO$LRQSO1G2SO!'^Q,UO1G2ZO$LWQ(CjO7+'gOOQ(CY7+'g7+'gO!#qQUO7+'gOOQ(CY7+%`7+%`O$LzQ`O'#J}O#![QSO7+(]O$MUQbO7+(]O$9hQSO7+(]O$M]Q(ChO'#CfO$MpQ(ChO,5<{O$NbQSO,5<{OOQ(CW1G5`1G5`OOQQ7+$^7+$^O!>dQ(C[O7+$^O!>oQWO7+$^O!#qQUO7+&YO$NgQSO'#IrO$N{QSO,5@oOOQO1G3^1G3^O9_QSO,5@oO$N{QSO,5@oO% TQSO,5@oOOQO,5?_,5?_OOQO-E<q-E<qOOQ(CY7+&}7+&}O% YQSO7+(wO9OQ(C[O7+(wO9_QSO7+(wO?rQSO7+(wO% _QSO,5;XOOQ(CW,5?X,5?XOOQ(CW-E<k-E<kOOQQ7+(g7+(gO% dQ(ChO7+(dO!%tQ,UO7+(dO% nQ`O7+(eOOQQ7+(e7+(eO!%tQ,UO7+(eO% uQSO'#KQO%!QQSO,5=cOOQO,5?Z,5?ZOOQO-E<m-E<mOOQQ7+(j7+(jO%#aQWO'#HQOOQQ1G3V1G3VO!%tQ,UO1G3VO%QQUO1G3VO%#hQSO1G3VO%#sQ,UO1G3VO9OQ(C[O1G3XO#K`QSO1G3XO8tQSO1G3XO!>oQWO1G3XO!>wQ,UO1G3XO%$RQSO'#IqO%$^QSO,5@mO%$fQWO,5@mOOQ(CW1G3Y1G3YOOQQ7+$S7+$SO?rQSO7+$SO9OQ(C[O7+$SO%$qQSO7+$SO%QQUO1G6[O%QQUO1G6]O%$vQUO1G3aO%$}QSO1G3aO%%SQUO1G3aO%%ZQ(C[O1G6[OOQQ7+(y7+(yO9OQ(C[O7+)TO`QUO7+)VOOQQ'#KW'#KWOOQQ'#It'#ItO%%eQUO,5>UOOQQ,5>U,5>UO%QQUO'#HkO%%rQSO'#HmOOQQ,5>[,5>[O:vQSO,5>[OOQQ,5>^,5>^OOQQ7+)`7+)`OOQQ7+)f7+)fOOQQ7+)j7+)jOOQQ7+)l7+)lO%%wQWO1G5mO%&]Q$IUO1G0sO%&gQSO1G0sOOQO1G/m1G/mO%&rQ$IUO1G/mO>QQSO1G/mO!)jQUO'#DgOOQO,5>u,5>uOOQO-E<X-E<XOOQO,5>{,5>{OOQO-E<_-E<_O!>oQWO1G/mOOQO-E<[-E<[OOQ(CY1G0X1G0XOOQ(CY7+%q7+%qO#![QSO7+%qOOQ(CY7+&X7+&XO>QQSO7+&XO!>oQWO7+&XOOQO7+%t7+%tO$6nQ(CjO7+&QOOQO7+&Q7+&QO%QQUO7+&QO%&|Q(C[O7+&QO!>dQ(C[O7+%tO!>oQWO7+%tO%'XQ(C[O7+&QO%'gQ(CjO7++bO%QQUO7++bO%'wQSO7++aO%'wQSO7++aOOQO1G4i1G4iO:vQSO1G4iO%(PQSO1G4iOOQO7+%y7+%yO#![QSO<<KwO$MUQbO<<KwO%(_QSO<<KwOOQQ<<Kw<<KwO!%tQ,UO<<KwO%QQUO<<KwO%(gQSO<<KwO%(rQ(CjO1G2kO%*}Q(CjO1G2mO%-YQ(CjO1G2XO%/kQ,UO,5>vOOQO-E<Y-E<YO%/uQbO,5>wO%QQUO,5>wOOQO-E<Z-E<ZO%0PQSO1G5oOOQ(CY<<I}<<I}O%0XQ$IUO1G0nO%2cQ$IUO1G0xO%2jQ$IUO1G0xO%4nQ$IUO1G0xO%4uQ$IUO1G0xO%6jQ$IUO1G0xO%7QQ$IUO1G0xO%9eQ$IUO1G0xO%9lQ$IUO1G0xO%;pQ$IUO1G0xO%;wQ$IUO1G0xO%=oQ$IUO1G0xO%>SQ(CjO<<JaO%?XQ$IUO1G0xO%@}Q$IUO'#J^O%CQQ$IUO1G1^O%C_Q$IUO1G0QO!)jQUO'#FlOOQO'#Jy'#JyOOQO1G1p1G1pO%CiQSO1G1oO%CnQ$IUO,5?QOOOO7+'c7+'cOOOO1G/S1G/SOOQ(CY1G4n1G4nO!'^Q,UO7+(ZO%CxQSO,5?RO9_QSO,5?ROOQO-E<e-E<eO%DWQSO1G6RO%DWQSO1G6RO%D`QSO1G6RO%DkQ,UO7+'sO%D{Q`O,5?TO%EVQSO,5?TO!%tQ,UO,5?TOOQO-E<g-E<gO%E[Q`O1G6SO%EfQSO1G6SOOQ(CW1G2c1G2cO$ mQSO1G2cOOQ(CW1G2b1G2bO%EnQSO1G2dO!%tQ,UO1G2dOOQ(CW1G2i1G2iO!>oQWO1G2bOBoQSO1G2cO%EsQSO1G2dO%E{QSO1G2cO!'^Q,UO7+*}OOQ(CY1G/[1G/[O%FWQSO1G/[OOQ(CY7+'n7+'nO%F]Q,UO7+'uO%FmQ(CjO<<KROOQ(CY<<KR<<KRO!%tQ,UO'#IlO%GaQSO,5@iO!%tQ,UO1G2gOOQQ<<Gx<<GxO!>dQ(C[O<<GxO%GiQ(CjO<<ItOOQ(CY<<It<<ItOOQO,5?^,5?^O%H]QSO,5?^O$%|QSO,5?^OOQO-E<p-E<pO%HbQSO1G6ZO%HbQSO1G6ZO9_QSO1G6ZO?rQSO<<LcOOQQ<<Lc<<LcO%HjQSO<<LcO9OQ(C[O<<LcO%HoQSO1G0sOOQQ<<LO<<LOO% dQ(ChO<<LOOOQQ<<LP<<LPO% nQ`O<<LPO%HtQWO'#InO%IPQSO,5@lO!)jQUO,5@lOOQQ1G2}1G2}O%IXQUO'#JgOOQO'#Ip'#IpO9OQ(C[O'#IpO%IcQWO,5=lOOQQ,5=l,5=lO%IjQWO'#E`O%JOQSO7+(qO%JTQSO7+(qOOQQ7+(q7+(qO!%tQ,UO7+(qO%QQUO7+(qO%J]QSO7+(qOOQQ7+(s7+(sO9OQ(C[O7+(sO#K`QSO7+(sO8tQSO7+(sO!>oQWO7+(sO%JhQSO,5?]OOQO-E<o-E<oOOQO'#HT'#HTO%JsQSO1G6XO9OQ(C[O<<GnOOQQ<<Gn<<GnO?rQSO<<GnO%J{QSO7++vO%KQQSO7++wOOQQ7+({7+({O%KVQSO7+({O%K[QUO7+({O%KcQSO7+({O%QQUO7++vO%QQUO7++wOOQQ<<Lo<<LoOOQQ<<Lq<<LqOOQQ-E<r-E<rOOQQ1G3p1G3pO%KhQSO,5>VOOQQ,5>X,5>XO%KmQSO1G3vO:vQSO7+&_O!)jQUO7+&_OOQO7+%X7+%XO%KrQ$IUO1G5yO>QQSO7+%XOOQ(CY<<I]<<I]OOQ(CY<<Is<<IsO>QQSO<<IsOOQO<<Il<<IlO$6nQ(CjO<<IlO%QQUO<<IlOOQO<<I`<<I`O!>dQ(C[O<<I`O%K|Q(C[O<<IlO%LXQ(CjO<<N|O%LiQSO<<N{OOQO7+*T7+*TO:vQSO7+*TOOQQANAcANAcO%LqQSOANAcO!%tQ,UOANAcO#![QSOANAcO$MUQbOANAcO%QQUOANAcO%LyQ(CjO7+'sO& [Q(CjO7+'uO&#mQbO1G4cO&#wQ$IUO7+&YO&$UQ$IUO,59nO&&XQ$IUO,5<dO&([Q$IUO,5<fO&*_Q$IUO,5<tO&,TQ$IUO7+'fO&,bQ$IUO7+'gO&,oQSO,5<WOOQO7+'Z7+'ZO&,tQ,UO<<KuOOQO1G4m1G4mO&,{QSO1G4mO&-WQSO1G4mO&-fQSO7++mO&-fQSO7++mO!%tQ,UO1G4oO&-nQ`O1G4oO&-xQSO7++nOOQ(CW7+'}7+'}O$ mQSO7+(OO&.QQ`O7+(OOOQ(CW7+'|7+'|O$ mQSO7+'}O&.XQSO7+(OO!%tQ,UO7+(OOBoQSO7+'}O&.^Q,UO<<NiOOQ(CY7+$v7+$vO&.hQ`O,5?WOOQO-E<j-E<jO&.rQ(ChO7+(ROOQQAN=dAN=dO9_QSO1G4xOOQO1G4x1G4xO&/SQSO1G4xO&/XQSO7++uO&/XQSO7++uO9OQ(C[OANA}O?rQSOANA}OOQQANA}ANA}OOQQANAjANAjOOQQANAkANAkO&/aQSO,5?YOOQO-E<l-E<lO&/lQ$IUO1G6WO&1|QbO'#CfOOQO,5?[,5?[OOQO-E<n-E<nOOQQ1G3W1G3WO%IXQUO,5<xOOQQ<<L]<<L]O!%tQ,UO<<L]O%JOQSO<<L]O&2WQSO<<L]O%QQUO<<L]OOQQ<<L_<<L_O9OQ(C[O<<L_O#K`QSO<<L_O8tQSO<<L_O&2`QWO1G4wO&2kQSO7++sOOQQAN=YAN=YO9OQ(C[OAN=YOOQQ<= b<= bOOQQ<= c<= cOOQQ<<Lg<<LgO&2sQSO<<LgO&2xQUO<<LgO&3PQSO<= bO&3UQSO<= cOOQQ1G3q1G3qO>QQSO7+)bO&3ZQSO<<IyO&3fQ$IUO<<IyOOQO<<Hs<<HsOOQ(CYAN?_AN?_OOQOAN?WAN?WO$6nQ(CjOAN?WOOQOAN>zAN>zO%QQUOAN?WOOQO<<Mo<<MoOOQQG26}G26}O!%tQ,UOG26}O#![QSOG26}O&3pQSOG26}O$MUQbOG26}O&3xQ$IUO<<JaO&4VQ$IUO1G2XO&5{Q$IUO1G2kO&8OQ$IUO1G2mO&:RQ$IUO<<KRO&:`Q$IUO<<ItOOQO1G1r1G1rO!'^Q,UOANAaOOQO7+*X7+*XO&:mQSO7+*XO&:xQSO<= XO&;QQ`O7+*ZOOQ(CW<<Kj<<KjO$ mQSO<<KjOOQ(CW<<Ki<<KiO&;[Q`O<<KjO$ mQSO<<KiOOQO7+*d7+*dO9_QSO7+*dO&;cQSO<= aOOQQG27iG27iO9OQ(C[OG27iO!)jQUO1G4tO&;kQSO7++rO%JOQSOANAwOOQQANAwANAwO!%tQ,UOANAwO&;sQSOANAwOOQQANAyANAyO9OQ(C[OANAyO#K`QSOANAyOOQO'#HU'#HUOOQO7+*c7+*cOOQQG22tG22tOOQQANBRANBRO&;{QSOANBROOQQAND|AND|OOQQAND}AND}OOQQ<<L|<<L|O!)jQUOAN?eOOQOG24rG24rO$6nQ(CjOG24rO#![QSOLD,iOOQQLD,iLD,iO!%tQ,UOLD,iO&<QQSOLD,iO&<YQ$IUO7+'sO&>OQ$IUO7+'uO&?tQ,UOG26{OOQO<<Ms<<MsOOQ(CWANAUANAUO$ mQSOANAUOOQ(CWANATANATOOQO<<NO<<NOOOQQLD-TLD-TO&@UQ$IUO7+*`OOQQG27cG27cO%JOQSOG27cO!%tQ,UOG27cOOQQG27eG27eO9OQ(C[OG27eOOQQG27mG27mO&@`Q$IUOG25POOQOLD*^LD*^OOQQ!$(!T!$(!TO#![QSO!$(!TO!%tQ,UO!$(!TO&@jQ(CjOG26{OOQ(CWG26pG26pOOQQLD,}LD,}O%JOQSOLD,}OOQQLD-PLD-POOQQ!)9Eo!)9EoO#![QSO!)9EoOOQQ!$(!i!$(!iOOQQ!.K;Z!.K;ZO&B{Q$IUOG26{O!)jQUO'#DvO0uQSO'#ETO&DqQbO'#JcO!)jQUO'#DnO&DxQUO'#DzO!)jQUO'#D|O&EPQbO'#CfO&GgQbO'#CfO&GwQUO,5;SO!)jQUO,5;^O!)jQUO,5;^O!)jQUO,5;^O!)jQUO,5;^O!)jQUO,5;^O!)jQUO,5;^O!)jQUO,5;^O!)jQUO,5;^O!)jQUO,5;^O!)jQUO,5;^O!)jQUO,5;^O!)jQUO'#IfO&IzQSO,5<cO&JSQ,UO,5;^O&KgQ,UO,5;^O!)jQUO,5;rO0xQSO'#DSO0xQSO'#DSO!%tQ,UO'#FxO&JSQ,UO'#FxO!%tQ,UO'#FzO&JSQ,UO'#FzO!%tQ,UO'#GYO&JSQ,UO'#GYO!)jQUO,5:fO!)jQUO,5@_O&GwQUO1G0nO&KnQ$IUO'#CfO!)jQUO1G1zO!%tQ,UO,5=PO&JSQ,UO,5=PO!%tQ,UO,5=RO&JSQ,UO,5=RO!%tQ,UO,5<mO&JSQ,UO,5<mO&GwQUO1G1{O!)jQUO7+&uO!%tQ,UO1G2XO&JSQ,UO1G2XO!%tQ,UO1G2ZO&JSQ,UO1G2ZO&GwQUO7+'gO&GwQUO7+&YO!%tQ,UOANAaO&JSQ,UOANAaO&KxQSO'#EhO&K}QSO'#EhO&LVQSO'#FWO&L[QSO'#ErO&LaQSO'#JsO&LlQSO'#JqO&LwQSO,5;SO&L|Q,UO,5<`O&MTQSO'#GRO&MYQSO'#GRO&M_QSO,5<aO&MgQSO,5;SO&MoQ$IUO1G1ZO&MvQSO,5<mO&M{QSO,5<mO&NQQSO,5<oO&NVQSO,5<oO&N[QSO1G1{O&NaQSO1G0nO&NfQ,UO<<KuO&NmQ,UO<<KuO7^Q,UO'#FvO8tQSO'#FuO@mQSO'#EgO!)jQUO,5;oO!2dQSO'#GRO!2dQSO'#GRO!2dQSO'#GTO!2dQSO'#GTO!'^Q,UO7+(ZO!'^Q,UO7+(ZO$HyQ`O1G2oO$HyQ`O1G2oO!%tQ,UO,5=TO!%tQ,UO,5=T",stateData:"' v~O'mOS'nOSROS'oRQ~OPYOQYOV!TO^pOaxObwOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!XXO!csO!hZO!kYO!lYO!mYO!otO!quO!tvO!x]O#p}O$QzO$UfO%`{O%b!OO%d|O%e|O%h!PO%j!QO%m!RO%n!RO%p!SO%|!UO&S!VO&U!WO&W!XO&Y!YO&]!ZO&c![O&i!]O&k!^O&m!_O&o!`O&q!aO'tSO'vTO'yUO(RVO(a[O(niO~OPYOQYOa!gOb!fOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!X!cO!csO!hZO!kYO!lYO!mYO!otO!quO!t!eO$Q!hO$UfO't!bO'vTO'yUO(RVO(a[O(niO~O^!sOl!kO|!lO![!uO!]!rO!^!rO!x9mO!|!mO!}!mO#O!tO#P!mO#Q!mO#T!vO#U!vO'u!iO'vTO'yUO(U!jO(a!pO~O'o!wO~OPYXXYX^YXkYXyYXzYX|YX!VYX!eYX!fYX!hYX!lYX#XYX#dcX#gYX#hYX#iYX#jYX#kYX#lYX#mYX#nYX#oYX#qYX#sYX#uYX#vYX#{YX'kYX(RYX(bYX(iYX(jYX~O!a$zX~P(gO[!yO'v!{O'w!yO'x!{O~O[!|O'x!{O'y!{O'z!|O~Oq#OO!O#PO(S#PO(T#RO~OPYOQYOa!gOb!fOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!X!cO!csO!hZO!kYO!lYO!mYO!otO!quO!t!eO$Q!hO$UfO't9rO'vTO'yUO(RVO(a[O(niO~O!U#VO!V#SO!S(XP!S(fP~P+sO!W#_O~P`OPYOQYOa!gOb!fOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!X!cO!csO!hZO!kYO!lYO!mYO!otO!quO!t!eO$Q!hO$UfO'vTO'yUO(RVO(a[O(niO~Oi#iO!U#eO!x]O#b#hO#c#eO't9sO!g(cP~P._O!h#kO't#jO~O!t#oO!x]O%`#pO~O#d#qO~O!a#rO#d#qO~OP$YOX$aOk#}Oy#vOz#wO|#xO!V$^O!e$PO!f#tO!h#uO!l$YO#g#{O#h#|O#i#|O#j#|O#k$OO#l$PO#m$PO#n$`O#o$PO#q$QO#s$SO#u$UO#v$VO(RVO(b$WO(i#yO(j#zO~O^(VX'k(VX'i(VX!g(VX!S(VX!X(VX%a(VX!a(VX~P1gO#X$bO#{$bOP(WXX(WXk(WXy(WXz(WX|(WX!V(WX!e(WX!h(WX!l(WX#g(WX#h(WX#i(WX#j(WX#k(WX#l(WX#m(WX#n(WX#o(WX#q(WX#s(WX#u(WX#v(WX(R(WX(b(WX(i(WX(j(WX!X(WX%a(WX~O^(WX!f(WX'k(WX'i(WX!S(WX!g(WXo(WX!a(WX~P3}O#X$bO~O$W$dO$Y$cO$a$iO~O!X$jO$UfO$d$kO$f$mO~Oi%POk$qOl$pOm$pOs%QOu%ROw%SO|$xO!X$yO!c%XO!h$uO#c%YO$Q%VO$m%TO$o%UO$r%WO't$oO'vTO'yUO'}%OO(R$rOd(OP~O!h%ZO~O!a%]O~O^%^O'k%^O~O'u!iO~P%QO't%eO~O!h%ZO't%eO'u!iO'}%OO~Ob%lO!h%ZO't%eO~O#o$PO~Oy%qO!X%nO!h%pO%b%tO't%eO'u!iO'vTO'yUO](vP~O!t#oO~O|%vO!X%wO't%eO~O|%vO!X%wO%j%{O't%eO~O't%|O~O#p}O%b!OO%d|O%e|O%h!PO%j!QO%m!RO%n!RO~Oa&VOb&UO!t&SO%`&TO%r&RO~P;fOa&YObwO!X&XO!tvO!x]O#p}O%`{O%d|O%e|O%h!PO%j!QO%m!RO%n!RO%p!SO~O_&]O#X&`O%b&ZO'u!iO~P<eO!h&aO!q&eO~O!h#kO~O!XXO~O^%^O'j&mO'k%^O~O^%^O'j&pO'k%^O~O^%^O'j&rO'k%^O~O'iYX!SYXoYX!gYX&QYX!XYX%aYX!aYX~P(gO!['PO!]&xO!^&xO'u!iO'vTO'yUO~Ol&vO|&uO!U&yO(U&tO!W(YP!W(hP~P?fOg'SO!X'QO't%eO~Ob'XO!h%ZO't%eO~Oy%qO!h%pO~Ol!kO|!lO!x9mO!|!mO!}!mO#P!mO#Q!mO'u!iO'vTO'yUO(U!jO(a!pO~O!['_O!]'^O!^'^O#O!mO#T'`O#U'`O~PAQO^%^O!a#rO!h%ZO'k%^O'}%OO(b'bO~O!l'fO#X'dO~PB`Ol!kO|!lO'vTO'yUO(U!jO(a!pO~O!XXOl(_X|(_X![(_X!](_X!^(_X!x(_X!|(_X!}(_X#O(_X#P(_X#Q(_X#T(_X#U(_X'u(_X'v(_X'y(_X(U(_X(a(_X~O!]'^O!^'^O'u!iO~PCOO'p'jO'q'jO'r'lO~O[!yO'v'nO'w!yO'x'nO~O[!|O'x'nO'y'nO'z!|O~Oq#OO!O#PO(S#PO(T'rO~O!U'tO!S&|X!S'SX!V&|X!V'SX~P+sO!V'vO!S(XX~OP$YOX$aOk#}Oy#vOz#wO|#xO!V'vO!e$PO!f#tO!h#uO!l$YO#g#{O#h#|O#i#|O#j#|O#k$OO#l$PO#m$PO#n$`O#o$PO#q$QO#s$SO#u$UO#v$VO(RVO(b$WO(i#yO(j#zO~O!S(XX~PFrO!S'{O~O!S(eX!V(eX!a(eX!g(eX(b(eX~O#X(eX#d#]X!W(eX~PHxO#X'|O!S(gX!V(gX~O!V'}O!S(fX~O!S(QO~O#X$bO~PHxO!W(RO~P`Oy#vOz#wO|#xO!f#tO!h#uO(RVOP!jaX!jak!ja!V!ja!e!ja!l!ja#g!ja#h!ja#i!ja#j!ja#k!ja#l!ja#m!ja#n!ja#o!ja#q!ja#s!ja#u!ja#v!ja(b!ja(i!ja(j!ja~O^!ja'k!ja'i!ja!S!ja!g!jao!ja!X!ja%a!ja!a!ja~PJ`O!g(SO~O!a#rO#X(TO(b'bO!V(dX^(dX'k(dX~O!g(dX~PMOO|%vO!X%wO!x]O#b(YO#c(XO't%eO~O!V(ZO!g(cX~O!g(]O~O|%vO!X%wO#c(XO't%eO~OP(WXX(WXk(WXy(WXz(WX|(WX!V(WX!e(WX!f(WX!h(WX!l(WX#g(WX#h(WX#i(WX#j(WX#k(WX#l(WX#m(WX#n(WX#o(WX#q(WX#s(WX#u(WX#v(WX(R(WX(b(WX(i(WX(j(WX~O!a#rO!g(WX~PNlOy(^Oz(_O!f#tO!h#uO!x!wa|!wa~O!t!wa%`!wa!X!wa#b!wa#c!wa't!wa~P!!pO!t(cO~OPYOQYOa!gOb!fOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!XXO!csO!hZO!kYO!lYO!mYO!otO!quO!t!eO$Q!hO$UfO't!bO'vTO'yUO(RVO(a[O(niO~Oi%POk$qOl$pOm$pOs%QOu%ROw:VO|$xO!X$yO!c;aO!h$uO#c:]O$Q%VO$m:XO$o:ZO$r%WO't(gO'vTO'yUO'}%OO(R$rO~O#d(iO~Oi%POk$qOl$pOm$pOs%QOu%ROw%SO|$xO!X$yO!c%XO!h$uO#c%YO$Q%VO$m%TO$o%UO$r%WO't(gO'vTO'yUO'}%OO(R$rO~Od([P~P!'^O!U(mO!g(]P~P%QO(U(oO(a[O~O|(qO!h#uO(U(oO(a[O~OP9lOQ9lOa;]Ob!fOikOk9lOlkOmkOskOu9lOw9lO|WO!QkO!RkO!X!cO!c9oO!hZO!k9lO!l9lO!m9lO!o9pO!q9qO!t!eO$Q!hO$UfO't)PO'vTO'yUO(RVO(a[O(n;ZO~Oz)SO!h#uO~O!V$^O^$ka'k$ka'i$ka!g$ka!S$ka!X$ka%a$ka!a$ka~O#p)WO~P!%tOy)ZO!a)YO!X$XX$T$XX$W$XX$Y$XX$a$XX~O!a)YO!X(kX$T(kX$W(kX$Y(kX$a(kX~Oy)ZO~P!-SOy)ZO!X(kX$T(kX$W(kX$Y(kX$a(kX~O!X)]O$T)aO$W)[O$Y)[O$a)bO~O!U)eO~P!)jO$W$dO$Y$cO$a)iO~Og$sXy$sX|$sX!f$sX(i$sX(j$sX~OdfXd$sXgfX!VfX#XfX~P!.xOl)kO~Oq)lO(S)mO(T)oO~Og)xOy)qO|)rO(i)tO(j)vO~Od)pO~P!0ROd)yO~Oi%POk$qOl$pOm$pOs%QOu%ROw:VO|$xO!X$yO!c;aO!h$uO#c:]O$Q%VO$m:XO$o:ZO$r%WO'vTO'yUO'}%OO(R$rO~O!U)}O't)zO!g(oP~P!0pO#d*PO~O!h*QO~O!U*VO't*SO!S(pP~P!0pOk*cO|*ZO![*aO!]*YO!^*YO!h*QO#T*bO%W*]O'u!iO(U!jO~O!W*`O~P!2vO!f#tOg(QXy(QX|(QX(i(QX(j(QX!V(QX#X(QX~Od(QX#y(QX~P!3oOg*fO#X*eOd(PX!V(PX~O!V*gOd(OX~O't%|Od(OP~O!h*nO~O't(gO~Oi*rO|%vO!U#eO!X%wO!x]O#b#hO#c#eO't%eO!g(cP~O!a#rO#d*sO~OP$YOX$aOk#}Oy#vOz#wO|#xO!e$PO!f#tO!h#uO!l$YO#g#{O#h#|O#i#|O#j#|O#k$OO#l$PO#m$PO#n$`O#o$PO#q$QO#s$SO#u$UO#v$VO(RVO(b$WO(i#yO(j#zO~O^!ba!V!ba'k!ba'i!ba!S!ba!g!bao!ba!X!ba%a!ba!a!ba~P!6UOy#vOz#wO|#xO!f#tO!h#uO(RVOP!naX!nak!na!V!na!e!na!l!na#g!na#h!na#i!na#j!na#k!na#l!na#m!na#n!na#o!na#q!na#s!na#u!na#v!na(b!na(i!na(j!na~O^!na'k!na'i!na!S!na!g!nao!na!X!na%a!na!a!na~P!8oOy#vOz#wO|#xO!f#tO!h#uO(RVOP!paX!pak!pa!V!pa!e!pa!l!pa#g!pa#h!pa#i!pa#j!pa#k!pa#l!pa#m!pa#n!pa#o!pa#q!pa#s!pa#u!pa#v!pa(b!pa(i!pa(j!pa~O^!pa'k!pa'i!pa!S!pa!g!pao!pa!X!pa%a!pa!a!pa~P!;YOg*{O!X'QO%a*zO'}%OO~O!a*}O^'|X!X'|X'k'|X!V'|X~O^%^O!XXO'k%^O~O!h%ZO'}%OO~O!h%ZO't%eO'}%OO~O!a#rO#d(iO~O%b+ZO't+VO'vTO'yUO!W(wP~O!V+[O](vX~O(U(oO~OX+`O~O]+aO~O!X%nO't%eO'u!iO](vP~O|%vO!U+eO!V'}O!X%wO't%eO!S(fP~Ol&|O|+gO!U+fO'vTO'yUO(U(oO~O!W(hP~P!@xO!V+hO^(sX'k(sX~O#X+lO'}%OO~Og+oO!X$yO'}%OO~O!X+qO~Oy+sO!XXO~O!t+xO~Ob+}O~O't#jO!W(uP~Ob%lO~O%b!OO't%|O~P<eOX,TO],SO~OPYOQYOaxObwOikOkYOlkOmkOskOuYOwYO|WO!QkO!RkO!csO!hZO!kYO!lYO!mYO!otO!quO!tvO!x]O$UfO%`{O'vTO'yUO(RVO(a[O(niO~O!X!cO$Q!hO't!bO~P!C]O],SO^%^O'k%^O~O^,XO#p,ZO%d,ZO%e,ZO~P%QO!h&aO~O&S,`O~O!X,bO~O&e,dO&g,eOP&baQ&baV&ba^&baa&bab&bai&bak&bal&bam&bas&bau&baw&ba|&ba!Q&ba!R&ba!X&ba!c&ba!h&ba!k&ba!l&ba!m&ba!o&ba!q&ba!t&ba!x&ba#p&ba$Q&ba$U&ba%`&ba%b&ba%d&ba%e&ba%h&ba%j&ba%m&ba%n&ba%p&ba%|&ba&S&ba&U&ba&W&ba&Y&ba&]&ba&c&ba&i&ba&k&ba&m&ba&o&ba&q&ba'i&ba't&ba'v&ba'y&ba(R&ba(a&ba(n&ba!W&ba&Z&ba_&ba&`&ba~O't,jO~O!V{X!V!_X!W{X!W!_X!a{X!a!_X!h!_X#X{X'}!_X~O!a,oO#X,nO!V#aX!V(ZX!W#aX!W(ZX!a(ZX!h(ZX'}(ZX~O!a,qO!h%ZO'}%OO!V!ZX!W!ZX~Ol!kO|!lO'vTO'yUO(U!jO~OP9lOQ9lOa;]Ob!fOikOk9lOlkOmkOskOu9lOw9lO|WO!QkO!RkO!X!cO!c9oO!hZO!k9lO!l9lO!m9lO!o9pO!q9qO!t!eO$Q!hO$UfO'vTO'yUO(RVO(a[O(n;ZO~O't:bO~P!LrO!V,uO!W(YX~O!W,wO~O!a,oO#X,nO!V#aX!W#aX~O!V,xO!W(hX~O!W,zO~O!],{O!^,{O'u!iO~P!LaO!W-OO~P'TOg-RO!X'QO~O!S-WO~Ol!wa![!wa!]!wa!^!wa!|!wa!}!wa#O!wa#P!wa#Q!wa#T!wa#U!wa'u!wa'v!wa'y!wa(U!wa(a!wa~P!!pO!l-]O#X-ZO~PB`O!]-_O!^-_O'u!iO~PCOO^%^O#X-ZO'k%^O~O^%^O!a#rO#X-ZO'k%^O~O^%^O!a#rO!l-]O#X-ZO'k%^O(b'bO~O'p'jO'q'jO'r-dO~Oo-eO~O!S&|a!V&|a~P!6UO!U-iO!S&|X!V&|X~P%QO!V'vO!S(Xa~O!S(Xa~PFrO!V'}O!S(fa~O|%vO!U-mO!X%wO't%eO!S'SX!V'SX~O#X-oO!V(da!g(da^(da'k(da~O!a#rO~P#&xO!V(ZO!g(ca~O|%vO!X%wO#c-sO't%eO~Oi-xO|%vO!U-uO!X%wO!x]O#b-wO#c-uO't%eO!V'VX!g'VX~Oz-|O!h#uO~Og.PO!X'QO%a.OO'}%OO~O^#[i!V#[i'k#[i'i#[i!S#[i!g#[io#[i!X#[i%a#[i!a#[i~P!6UOg;gOy)qO|)rO(i)tO(j)vO~O#d#Wa^#Wa#X#Wa'k#Wa!V#Wa!g#Wa!X#Wa!S#Wa~P#)tO#d(QXP(QXX(QX^(QXk(QXz(QX!e(QX!h(QX!l(QX#g(QX#h(QX#i(QX#j(QX#k(QX#l(QX#m(QX#n(QX#o(QX#q(QX#s(QX#u(QX#v(QX'k(QX(R(QX(b(QX!g(QX!S(QX'i(QXo(QX!X(QX%a(QX!a(QX~P!3oO!V.YOd([X~P!0ROd.[O~O!V.]O!g(]X~P!6UO!g.`O~O!S.bO~OP$YOy#vOz#wO|#xO!f#tO!h#uO!l$YO(RVOX#fi^#fik#fi!V#fi!e#fi#h#fi#i#fi#j#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi'k#fi(b#fi(i#fi(j#fi'i#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~O#g#fi~P#-pO#g#{O~P#-pOP$YOy#vOz#wO|#xO!f#tO!h#uO!l$YO#g#{O#h#|O#i#|O#j#|O(RVOX#fi^#fi!V#fi!e#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi'k#fi(b#fi(i#fi(j#fi'i#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~Ok#fi~P#0bOk#}O~P#0bOP$YOk#}Oy#vOz#wO|#xO!f#tO!h#uO!l$YO#g#{O#h#|O#i#|O#j#|O#k$OO(RVO^#fi!V#fi#q#fi#s#fi#u#fi#v#fi'k#fi(b#fi(i#fi(j#fi'i#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~OX#fi!e#fi#l#fi#m#fi#n#fi#o#fi~P#3SOX$aO!e$PO#l$PO#m$PO#n$`O#o$PO~P#3SOP$YOX$aOk#}Oy#vOz#wO|#xO!e$PO!f#tO!h#uO!l$YO#g#{O#h#|O#i#|O#j#|O#k$OO#l$PO#m$PO#n$`O#o$PO#q$QO(RVO^#fi!V#fi#s#fi#u#fi#v#fi'k#fi(b#fi(j#fi'i#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~O(i#fi~P#6TO(i#yO~P#6TOP$YOX$aOk#}Oy#vOz#wO|#xO!e$PO!f#tO!h#uO!l$YO#g#{O#h#|O#i#|O#j#|O#k$OO#l$PO#m$PO#n$`O#o$PO#q$QO#s$SO(RVO(i#yO^#fi!V#fi#u#fi#v#fi'k#fi(b#fi'i#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~O(j#fi~P#8uO(j#zO~P#8uOP$YOX$aOk#}Oy#vOz#wO|#xO!e$PO!f#tO!h#uO!l$YO#g#{O#h#|O#i#|O#j#|O#k$OO#l$PO#m$PO#n$`O#o$PO#q$QO#s$SO#u$UO(RVO(i#yO(j#zO~O^#fi!V#fi#v#fi'k#fi(b#fi'i#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~P#;gOPYXXYXkYXyYXzYX|YX!eYX!fYX!hYX!lYX#XYX#dcX#gYX#hYX#iYX#jYX#kYX#lYX#mYX#nYX#oYX#qYX#sYX#uYX#vYX#{YX(RYX(bYX(iYX(jYX!VYX!WYX~O#yYX~P#>QOP$YOX:TOk9wOy#vOz#wO|#xO!e9yO!f#tO!h#uO!l$YO#g9uO#h9vO#i9vO#j9vO#k9xO#l9yO#m9yO#n:SO#o9yO#q9zO#s9|O#u:OO#v:PO(RVO(b$WO(i#yO(j#zO~O#y.dO~P#@_O#X:UO#{:UO#y(WX!W(WX~PNlO^'Ya!V'Ya'k'Ya'i'Ya!g'Ya!S'Yao'Ya!X'Ya%a'Ya!a'Ya~P!6UOP#fiX#fi^#fik#fiz#fi!V#fi!e#fi!f#fi!h#fi!l#fi#g#fi#h#fi#i#fi#j#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi'k#fi(R#fi(b#fi'i#fi!S#fi!g#fio#fi!X#fi%a#fi!a#fi~P#)tO^#zi!V#zi'k#zi'i#zi!S#zi!g#zio#zi!X#zi%a#zi!a#zi~P!6UO$W.iO$Y.iO~O$W.jO$Y.jO~O!a)YO#X.kO!X$^X$T$^X$W$^X$Y$^X$a$^X~O!U.lO~O!X)]O$T.nO$W)[O$Y)[O$a.oO~O!V:QO!W(VX~P#@_O!W.pO~O!a)YO$a(kX~O$a.rO~Oq)lO(S)mO(T.uO~Ol.xO!S.yO'vTO'yUO~O!VcX!acX!gcX!g$sX(bcX~P!.xO!g/PO~P#)tO!V/QO!a#rO(b'bO!g(oX~O!g/VO~O!U)}O't%eO!g(oP~O#d/XO~O!S$sX!V$sX!a$zX~P!.xO!V/YO!S(pX~P#)tO!a/[O~O!S/^O~Ok/bO!a#rO!h%ZO'}%OO(b'bO~O't/dO~O!a*}O~O^%^O!V/hO'k%^O~O!W/jO~P!2vO!]/kO!^/kO'u!iO(U!jO~O|/mO(U!jO~O#T/nO~O't%|Od'_X!V'_X~O!V*gOd(Oa~Od/sO~Oy/tOz/tO|/uOgva(iva(jva!Vva#Xva~Odva#yva~P#L|Oy)qO|)rOg$la(i$la(j$la!V$la#X$la~Od$la#y$la~P#MrOy)qO|)rOg$na(i$na(j$na!V$na#X$na~Od$na#y$na~P#NeO#d/wO~Od$|a!V$|a#X$|a#y$|a~P!0RO!a#rO~O#d/zO~Oy#vOz#wO|#xO!f#tO!h#uO(RVOP!niX!nik!ni!V!ni!e!ni!l!ni#g!ni#h!ni#i!ni#j!ni#k!ni#l!ni#m!ni#n!ni#o!ni#q!ni#s!ni#u!ni#v!ni(b!ni(i!ni(j!ni~O^!ni'k!ni'i!ni!S!ni!g!nio!ni!X!ni%a!ni!a!ni~P$ wOg.PO!X'QO%a.OO~Oi0RO't0QO~P!0sO!a*}O^'|a!X'|a'k'|a!V'|a~O#d0XO~OXYX!VcX!WcX~O!V0YO!W(wX~O!W0[O~OX0]O~O't+VO'vTO'yUO~O!X%nO't%eO]'gX!V'gX~O!V+[O](va~O!g0bO~P!6UOX0eO~O]0fO~O!V+hO^(sa'k(sa~O#X0lO~Og0oO!X$yO~O(U(oO!W(tP~Og0xO!X0uO%a0wO'}%OO~OX1SO!V1QO!W(uX~O!W1TO~O]1VO^%^O'k%^O~O't#jO'vTO'yUO~O#X$bO#{$bOP(WXX(WXk(WXy(WXz(WX|(WX!V(WX!e(WX!h(WX!l(WX#g(WX#h(WX#i(WX#j(WX#k(WX#l(WX#m(WX#n(WX#q(WX#s(WX#u(WX#v(WX(R(WX(b(WX(i(WX(j(WX~O#o1YO&Q1ZO^(WX!f(WX~P$(xO#X$bO#o1YO&Q1ZO~O^1[O~P%QO^1^O~O&Z1bOP&XiQ&XiV&Xi^&Xia&Xib&Xii&Xik&Xil&Xim&Xis&Xiu&Xiw&Xi|&Xi!Q&Xi!R&Xi!X&Xi!c&Xi!h&Xi!k&Xi!l&Xi!m&Xi!o&Xi!q&Xi!t&Xi!x&Xi#p&Xi$Q&Xi$U&Xi%`&Xi%b&Xi%d&Xi%e&Xi%h&Xi%j&Xi%m&Xi%n&Xi%p&Xi%|&Xi&S&Xi&U&Xi&W&Xi&Y&Xi&]&Xi&c&Xi&i&Xi&k&Xi&m&Xi&o&Xi&q&Xi'i&Xi't&Xi'v&Xi'y&Xi(R&Xi(a&Xi(n&Xi!W&Xi_&Xi&`&Xi~O_1hO!W1fO&`1gO~P`O!XXO!h1jO~O&g,eOP&biQ&biV&bi^&bia&bib&bii&bik&bil&bim&bis&biu&biw&bi|&bi!Q&bi!R&bi!X&bi!c&bi!h&bi!k&bi!l&bi!m&bi!o&bi!q&bi!t&bi!x&bi#p&bi$Q&bi$U&bi%`&bi%b&bi%d&bi%e&bi%h&bi%j&bi%m&bi%n&bi%p&bi%|&bi&S&bi&U&bi&W&bi&Y&bi&]&bi&c&bi&i&bi&k&bi&m&bi&o&bi&q&bi'i&bi't&bi'v&bi'y&bi(R&bi(a&bi(n&bi!W&bi&Z&bi_&bi&`&bi~O!S1pO~O!V!Za!W!Za~P#@_Ol!kO|!lO!U1vO(U!jO!V&}X!W&}X~P?fO!V,uO!W(Ya~O!V'TX!W'TX~P!@xO!V,xO!W(ha~O!W1}O~P'TO^%^O#X2WO'k%^O~O^%^O!a#rO#X2WO'k%^O~O^%^O!a#rO!l2[O#X2WO'k%^O(b'bO~O^%^O'k%^O~P!6UO!V$^Oo$ka~O!S&|i!V&|i~P!6UO!V'vO!S(Xi~O!V'}O!S(fi~O!S(gi!V(gi~P!6UO!V(di!g(di^(di'k(di~P!6UO#X2^O!V(di!g(di^(di'k(di~O!V(ZO!g(ci~O|%vO!X%wO!x]O#b2cO#c2bO't%eO~O|%vO!X%wO#c2bO't%eO~Og2jO!X'QO%a2iO~Og2jO!X'QO%a2iO'}%OO~O#dvaPvaXva^vakva!eva!fva!hva!lva#gva#hva#iva#jva#kva#lva#mva#nva#ova#qva#sva#uva#vva'kva(Rva(bva!gva!Sva'ivaova!Xva%ava!ava~P#L|O#d$laP$laX$la^$lak$laz$la!e$la!f$la!h$la!l$la#g$la#h$la#i$la#j$la#k$la#l$la#m$la#n$la#o$la#q$la#s$la#u$la#v$la'k$la(R$la(b$la!g$la!S$la'i$lao$la!X$la%a$la!a$la~P#MrO#d$naP$naX$na^$nak$naz$na!e$na!f$na!h$na!l$na#g$na#h$na#i$na#j$na#k$na#l$na#m$na#n$na#o$na#q$na#s$na#u$na#v$na'k$na(R$na(b$na!g$na!S$na'i$nao$na!X$na%a$na!a$na~P#NeO#d$|aP$|aX$|a^$|ak$|az$|a!V$|a!e$|a!f$|a!h$|a!l$|a#g$|a#h$|a#i$|a#j$|a#k$|a#l$|a#m$|a#n$|a#o$|a#q$|a#s$|a#u$|a#v$|a'k$|a(R$|a(b$|a!g$|a!S$|a'i$|a#X$|ao$|a!X$|a%a$|a!a$|a~P#)tO^#[q!V#[q'k#[q'i#[q!S#[q!g#[qo#[q!X#[q%a#[q!a#[q~P!6UOd'OX!V'OX~P!'^O!V.YOd([a~O!U2rO!V'PX!g'PX~P%QO!V.]O!g(]a~O!V.]O!g(]a~P!6UO!S2uO~O#y!ja!W!ja~PJ`O#y!ba!V!ba!W!ba~P#@_O#y!na!W!na~P!8oO#y!pa!W!pa~P!;YO!X3XO$UfO$_3YO~O!W3^O~Oo3_O~P#)tO^$hq!V$hq'k$hq'i$hq!S$hq!g$hqo$hq!X$hq%a$hq!a$hq~P!6UO!S3`O~Ol.xO'vTO'yUO~Oy)qO|)rO(j)vOg%Xi(i%Xi!V%Xi#X%Xi~Od%Xi#y%Xi~P$GeOy)qO|)rOg%Zi(i%Zi(j%Zi!V%Zi#X%Zi~Od%Zi#y%Zi~P$HWO(b$WO~P#)tO!U3cO't%eO!V'ZX!g'ZX~O!V/QO!g(oa~O!V/QO!a#rO!g(oa~O!V/QO!a#rO(b'bO!g(oa~Od$ui!V$ui#X$ui#y$ui~P!0RO!U3kO't*SO!S']X!V']X~P!0pO!V/YO!S(pa~O!V/YO!S(pa~P#)tO!a#rO#o3sO~Ok3vO!a#rO(b'bO~Od(Pi!V(Pi~P!0RO#X3yOd(Pi!V(Pi~P!0RO!g3|O~O^$iq!V$iq'k$iq'i$iq!S$iq!g$iqo$iq!X$iq%a$iq!a$iq~P!6UO!V4QO!X(qX~P#)tO!f#tO~P3}O^$sX!X$sX%UYX'k$sX!V$sX~P!.xO%U4SO^hXghXyhX|hX!XhX'khX(ihX(jhX!VhX~O%U4SO~O%b4ZO't+VO'vTO'yUO!V'fX!W'fX~O!V0YO!W(wa~OX4_O~O]4`O~O!S4dO~O^%^O'k%^O~P#)tO!X$yO~P#)tO!V4iO#X4kO!W(tX~O!W4lO~Ol!kO|4mO![!uO!]!rO!^!rO!x9mO!|!mO!}!mO#O!mO#P!mO#Q!mO#T4rO#U!vO'u!iO'vTO'yUO(U!jO(a!pO~O!W4qO~P%!VOg4wO!X0uO%a4vO~Og4wO!X0uO%a4vO'}%OO~O't#jO!V'eX!W'eX~O!V1QO!W(ua~O'vTO'yUO(U5QO~O]5UO~O!g5XO~P%QO^5ZO~O^5ZO~P%QO#o5]O&Q5^O~PMOO_1hO!W5bO&`1gO~P`O!a5dO~O!a5fO!V(Zi!W(Zi!a(Zi!h(Zi'}(Zi~O!V#ai!W#ai~P#@_O#X5gO!V#ai!W#ai~O!V!Zi!W!Zi~P#@_O^%^O#X5pO'k%^O~O^%^O!a#rO#X5pO'k%^O~O!V(dq!g(dq^(dq'k(dq~P!6UO!V(ZO!g(cq~O|%vO!X%wO#c5wO't%eO~O!X'QO%a5zO~Og5}O!X'QO%a5zO~O#d%XiP%XiX%Xi^%Xik%Xiz%Xi!e%Xi!f%Xi!h%Xi!l%Xi#g%Xi#h%Xi#i%Xi#j%Xi#k%Xi#l%Xi#m%Xi#n%Xi#o%Xi#q%Xi#s%Xi#u%Xi#v%Xi'k%Xi(R%Xi(b%Xi!g%Xi!S%Xi'i%Xio%Xi!X%Xi%a%Xi!a%Xi~P$GeO#d%ZiP%ZiX%Zi^%Zik%Ziz%Zi!e%Zi!f%Zi!h%Zi!l%Zi#g%Zi#h%Zi#i%Zi#j%Zi#k%Zi#l%Zi#m%Zi#n%Zi#o%Zi#q%Zi#s%Zi#u%Zi#v%Zi'k%Zi(R%Zi(b%Zi!g%Zi!S%Zi'i%Zio%Zi!X%Zi%a%Zi!a%Zi~P$HWO#d$uiP$uiX$ui^$uik$uiz$ui!V$ui!e$ui!f$ui!h$ui!l$ui#g$ui#h$ui#i$ui#j$ui#k$ui#l$ui#m$ui#n$ui#o$ui#q$ui#s$ui#u$ui#v$ui'k$ui(R$ui(b$ui!g$ui!S$ui'i$ui#X$uio$ui!X$ui%a$ui!a$ui~P#)tOd'Oa!V'Oa~P!0RO!V'Pa!g'Pa~P!6UO!V.]O!g(]i~O#y#[i!V#[i!W#[i~P#@_OP$YOy#vOz#wO|#xO!f#tO!h#uO!l$YO(RVOX#fik#fi!e#fi#h#fi#i#fi#j#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi#y#fi(b#fi(i#fi(j#fi!V#fi!W#fi~O#g#fi~P%0fO#g9uO~P%0fOP$YOy#vOz#wO|#xO!f#tO!h#uO!l$YO#g9uO#h9vO#i9vO#j9vO(RVOX#fi!e#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi#y#fi(b#fi(i#fi(j#fi!V#fi!W#fi~Ok#fi~P%2qOk9wO~P%2qOP$YOk9wOy#vOz#wO|#xO!f#tO!h#uO!l$YO#g9uO#h9vO#i9vO#j9vO#k9xO(RVO#q#fi#s#fi#u#fi#v#fi#y#fi(b#fi(i#fi(j#fi!V#fi!W#fi~OX#fi!e#fi#l#fi#m#fi#n#fi#o#fi~P%4|OX:TO!e9yO#l9yO#m9yO#n:SO#o9yO~P%4|OP$YOX:TOk9wOy#vOz#wO|#xO!e9yO!f#tO!h#uO!l$YO#g9uO#h9vO#i9vO#j9vO#k9xO#l9yO#m9yO#n:SO#o9yO#q9zO(RVO#s#fi#u#fi#v#fi#y#fi(b#fi(j#fi!V#fi!W#fi~O(i#fi~P%7hO(i#yO~P%7hOP$YOX:TOk9wOy#vOz#wO|#xO!e9yO!f#tO!h#uO!l$YO#g9uO#h9vO#i9vO#j9vO#k9xO#l9yO#m9yO#n:SO#o9yO#q9zO#s9|O(RVO(i#yO#u#fi#v#fi#y#fi(b#fi!V#fi!W#fi~O(j#fi~P%9sO(j#zO~P%9sOP$YOX:TOk9wOy#vOz#wO|#xO!e9yO!f#tO!h#uO!l$YO#g9uO#h9vO#i9vO#j9vO#k9xO#l9yO#m9yO#n:SO#o9yO#q9zO#s9|O#u:OO(RVO(i#yO(j#zO~O#v#fi#y#fi(b#fi!V#fi!W#fi~P%<OO^#wy!V#wy'k#wy'i#wy!S#wy!g#wyo#wy!X#wy%a#wy!a#wy~P!6UOg;hOy)qO|)rO(i)tO(j)vO~OP#fiX#fik#fiz#fi!e#fi!f#fi!h#fi!l#fi#g#fi#h#fi#i#fi#j#fi#k#fi#l#fi#m#fi#n#fi#o#fi#q#fi#s#fi#u#fi#v#fi#y#fi(R#fi(b#fi!V#fi!W#fi~P%>vO!f#tOP(QXX(QXg(QXk(QXy(QXz(QX|(QX!e(QX!h(QX!l(QX#g(QX#h(QX#i(QX#j(QX#k(QX#l(QX#m(QX#n(QX#o(QX#q(QX#s(QX#u(QX#v(QX#y(QX(R(QX(b(QX(i(QX(j(QX!V(QX!W(QX~O#y#zi!V#zi!W#zi~P#@_O#y!ni!W!ni~P$ wO!W6ZO~O!V'Ya!W'Ya~P#@_O!a#rO(b'bO!V'Za!g'Za~O!V/QO!g(oi~O!V/QO!a#rO!g(oi~Od$uq!V$uq#X$uq#y$uq~P!0RO!S']a!V']a~P#)tO!a6bO~O!V/YO!S(pi~P#)tO!V/YO!S(pi~O!S6fO~O!a#rO#o6kO~Ok6lO!a#rO(b'bO~O!S6nO~Od$wq!V$wq#X$wq#y$wq~P!0RO^$iy!V$iy'k$iy'i$iy!S$iy!g$iyo$iy!X$iy%a$iy!a$iy~P!6UO!V4QO!X(qa~O^#[y!V#[y'k#[y'i#[y!S#[y!g#[yo#[y!X#[y%a#[y!a#[y~P!6UOX6sO~O!V0YO!W(wi~O]6yO~O!a5fO~O(U(oO!V'bX!W'bX~O!V4iO!W(ta~OikO't7QO~P._O!W7TO~P%!VOl!kO|7UO'vTO'yUO(U!jO(a!pO~O!X0uO~O!X0uO%a7WO~Og7ZO!X0uO%a7WO~OX7`O!V'ea!W'ea~O!V1QO!W(ui~O!g7dO~O!g7eO~O!g7fO~O!g7fO~P%QO^7hO~O!a7kO~O!g7lO~O!V(gi!W(gi~P#@_O^%^O#X7tO'k%^O~O!V(dy!g(dy^(dy'k(dy~P!6UO!V(ZO!g(cy~O!X'QO%a7wO~O#d$uqP$uqX$uq^$uqk$uqz$uq!V$uq!e$uq!f$uq!h$uq!l$uq#g$uq#h$uq#i$uq#j$uq#k$uq#l$uq#m$uq#n$uq#o$uq#q$uq#s$uq#u$uq#v$uq'k$uq(R$uq(b$uq!g$uq!S$uq'i$uq#X$uqo$uq!X$uq%a$uq!a$uq~P#)tO#d$wqP$wqX$wq^$wqk$wqz$wq!V$wq!e$wq!f$wq!h$wq!l$wq#g$wq#h$wq#i$wq#j$wq#k$wq#l$wq#m$wq#n$wq#o$wq#q$wq#s$wq#u$wq#v$wq'k$wq(R$wq(b$wq!g$wq!S$wq'i$wq#X$wqo$wq!X$wq%a$wq!a$wq~P#)tO!V'Pi!g'Pi~P!6UO#y#[q!V#[q!W#[q~P#@_Oy/tOz/tO|/uOPvaXvagvakva!eva!fva!hva!lva#gva#hva#iva#jva#kva#lva#mva#nva#ova#qva#sva#uva#vva#yva(Rva(bva(iva(jva!Vva!Wva~Oy)qO|)rOP$laX$lag$lak$laz$la!e$la!f$la!h$la!l$la#g$la#h$la#i$la#j$la#k$la#l$la#m$la#n$la#o$la#q$la#s$la#u$la#v$la#y$la(R$la(b$la(i$la(j$la!V$la!W$la~Oy)qO|)rOP$naX$nag$nak$naz$na!e$na!f$na!h$na!l$na#g$na#h$na#i$na#j$na#k$na#l$na#m$na#n$na#o$na#q$na#s$na#u$na#v$na#y$na(R$na(b$na(i$na(j$na!V$na!W$na~OP$|aX$|ak$|az$|a!e$|a!f$|a!h$|a!l$|a#g$|a#h$|a#i$|a#j$|a#k$|a#l$|a#m$|a#n$|a#o$|a#q$|a#s$|a#u$|a#v$|a#y$|a(R$|a(b$|a!V$|a!W$|a~P%>vO#y$hq!V$hq!W$hq~P#@_O#y$iq!V$iq!W$iq~P#@_O!W8RO~O#y8SO~P!0RO!a#rO!V'Zi!g'Zi~O!a#rO(b'bO!V'Zi!g'Zi~O!V/QO!g(oq~O!S']i!V']i~P#)tO!V/YO!S(pq~O!S8YO~P#)tO!S8YO~Od(Py!V(Py~P!0RO!V'`a!X'`a~P#)tO^%Tq!X%Tq'k%Tq!V%Tq~P#)tOX8_O~O!V0YO!W(wq~O#X8cO!V'ba!W'ba~O!V4iO!W(ti~P#@_OPYXXYXkYXyYXzYX|YX!SYX!VYX!eYX!fYX!hYX!lYX#XYX#dcX#gYX#hYX#iYX#jYX#kYX#lYX#mYX#nYX#oYX#qYX#sYX#uYX#vYX#{YX(RYX(bYX(iYX(jYX~O!a%RX#o%RX~P&/vO!X0uO%a8gO~O'vTO'yUO(U8lO~O!V1QO!W(uq~O!g8oO~O!g8oO~P%QO!g8qO~O!g8rO~O#X8tO!V#ay!W#ay~O!V#ay!W#ay~P#@_O!X'QO%a8yO~O#y#wy!V#wy!W#wy~P#@_OP$uiX$uik$uiz$ui!e$ui!f$ui!h$ui!l$ui#g$ui#h$ui#i$ui#j$ui#k$ui#l$ui#m$ui#n$ui#o$ui#q$ui#s$ui#u$ui#v$ui#y$ui(R$ui(b$ui!V$ui!W$ui~P%>vOy)qO|)rO(j)vOP%XiX%Xig%Xik%Xiz%Xi!e%Xi!f%Xi!h%Xi!l%Xi#g%Xi#h%Xi#i%Xi#j%Xi#k%Xi#l%Xi#m%Xi#n%Xi#o%Xi#q%Xi#s%Xi#u%Xi#v%Xi#y%Xi(R%Xi(b%Xi(i%Xi!V%Xi!W%Xi~Oy)qO|)rOP%ZiX%Zig%Zik%Ziz%Zi!e%Zi!f%Zi!h%Zi!l%Zi#g%Zi#h%Zi#i%Zi#j%Zi#k%Zi#l%Zi#m%Zi#n%Zi#o%Zi#q%Zi#s%Zi#u%Zi#v%Zi#y%Zi(R%Zi(b%Zi(i%Zi(j%Zi!V%Zi!W%Zi~O#y$iy!V$iy!W$iy~P#@_O#y#[y!V#[y!W#[y~P#@_O!a#rO!V'Zq!g'Zq~O!V/QO!g(oy~O!S']q!V']q~P#)tO!S9QO~P#)tO!V0YO!W(wy~O!V4iO!W(tq~O!X0uO%a9XO~O!g9[O~O!X'QO%a9aO~OP$uqX$uqk$uqz$uq!e$uq!f$uq!h$uq!l$uq#g$uq#h$uq#i$uq#j$uq#k$uq#l$uq#m$uq#n$uq#o$uq#q$uq#s$uq#u$uq#v$uq#y$uq(R$uq(b$uq!V$uq!W$uq~P%>vOP$wqX$wqk$wqz$wq!e$wq!f$wq!h$wq!l$wq#g$wq#h$wq#i$wq#j$wq#k$wq#l$wq#m$wq#n$wq#o$wq#q$wq#s$wq#u$wq#v$wq#y$wq(R$wq(b$wq!V$wq!W$wq~P%>vOd%]!Z!V%]!Z#X%]!Z#y%]!Z~P!0RO!V'bq!W'bq~P#@_O!V#a!Z!W#a!Z~P#@_O#d%]!ZP%]!ZX%]!Z^%]!Zk%]!Zz%]!Z!V%]!Z!e%]!Z!f%]!Z!h%]!Z!l%]!Z#g%]!Z#h%]!Z#i%]!Z#j%]!Z#k%]!Z#l%]!Z#m%]!Z#n%]!Z#o%]!Z#q%]!Z#s%]!Z#u%]!Z#v%]!Z'k%]!Z(R%]!Z(b%]!Z!g%]!Z!S%]!Z'i%]!Z#X%]!Zo%]!Z!X%]!Z%a%]!Z!a%]!Z~P#)tOP%]!ZX%]!Zk%]!Zz%]!Z!e%]!Z!f%]!Z!h%]!Z!l%]!Z#g%]!Z#h%]!Z#i%]!Z#j%]!Z#k%]!Z#l%]!Z#m%]!Z#n%]!Z#o%]!Z#q%]!Z#s%]!Z#u%]!Z#v%]!Z#y%]!Z(R%]!Z(b%]!Z!V%]!Z!W%]!Z~P%>vOo(VX~P1gO'u!iO~P!)jO!ScX!VcX#XcX~P&/vOPYXXYXkYXyYXzYX|YX!VYX!VcX!eYX!fYX!hYX!lYX#XYX#XcX#dcX#gYX#hYX#iYX#jYX#kYX#lYX#mYX#nYX#oYX#qYX#sYX#uYX#vYX#{YX(RYX(bYX(iYX(jYX~O!acX!gYX!gcX(bcX~P&E^OP9lOQ9lOa;]Ob!fOikOk9lOlkOmkOskOu9lOw9lO|WO!QkO!RkO!XXO!c9oO!hZO!k9lO!l9lO!m9lO!o9pO!q9qO!t!eO$Q!hO$UfO't)PO'vTO'yUO(RVO(a[O(n;ZO~O!V:QO!W$ka~Oi%POk$qOl$pOm$pOs%QOu%ROw:WO|$xO!X$yO!c;bO!h$uO#c:^O$Q%VO$m:YO$o:[O$r%WO't(gO'vTO'yUO'}%OO(R$rO~O#p)WO~P&JSO!WYX!WcX~P&E^O#d9tO~O!a#rO#d9tO~O#X:UO~O#o9yO~O#X:`O!V(gX!W(gX~O#X:UO!V(eX!W(eX~O#d:aO~Od:cO~P!0RO#d:hO~O#d:iO~O!a#rO#d:jO~O!a#rO#d:aO~O#y:kO~P#@_O#d:lO~O#d:mO~O#d:nO~O#d:oO~O#d:pO~O#d:qO~O#y:rO~P!0RO#y:sO~P!0RO$U~!f!|!}#P#Q#T#b#c#n(n$m$o$r%U%`%a%b%h%j%m%n%p%r~'oR$U(n#h!R'm'u#il#g#jky'n(U'n't$W$Y$W~",goto:"$%Z({PPPP(|P)PP)aP*p.rPPPP5SPP5iP;d>iP>|P>|PPP>|P@lP>|P>|P>|P@pPP@uPA`PFUPPPFYPPPPFYIXPPPI_JYPFYPLgPPPPNuFYPPPFYPFYP!#TFYP!&g!'i!'rP!(e!(i!(ePPPPP!+r!'iPP!,`!-YP!/|FYFY!0R!3Z!7n!7n!;cPPP!;jFYPPPPPPPPPPP!>uP!@WPPFY!AePFYPFYFYFYFYPFY!BwPP!E}P!IPP!IT!I_!Ic!IcP!EzP!Ig!IgP!LiP!LmFYFY!Ls# t>|P>|P>|>|P##O>|>|#$x>|#'V>|#(y>|>|#)g#+c#+c#+g#+o#+c#+wP#+cP>|#,a>|#-i>|>|5SPPP#.tPP#/^#/^P#/^P#/s#/^PP#/yP#/pP#/p#0]#/p#0w#0}5P)P#1Q)PP#1X#1X#1XP)PP)PP)PP)PPP)PP#1_#1bP#1b)PP#1fP#1iP)PP)PP)PP)PP)PP)P)PPP#1o#1u#2P#2V#2]#2c#2i#2w#2}#3T#3_#3e#3o#4O#4U#4u#5X#5_#5e#5s#6Y#7j#7x#8O#8U#8[#8b#8l#8r#8x#9S#9f#9lPPPPPPPPPP#9rPPPPPPP#:f#=mP#>|#?T#?]PPPP#Cg#F]#Lr#Lu#Lx#Mq#Mt#Mw#NO#NWPP#N^#Nb$ Z$!Z$!_$!sPP$!w$!}$#RP$#U$#Y$#]$$R$$i$$n$$q$$t$$z$$}$%R$%VR!xRmpOXr!X#`%]&d&f&g&i,],b1b1eY!rQ'Q,}0u4pQ%ctQ%kwQ%rzQ&[!TS&x!c,uQ'W!fS'^!o!uS*Y$y*_Q+T%lQ+b%tQ+|&UQ,{'PQ-V'XQ-_'_Q/k*aQ1P+}R:_9p$zdOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$^$b%]%c%p&]&`&d&f&g&i&m&u'S'd't'v'|(T(i(m(q)p*s+g,X,],b-R-Z-i-o.].d/u/z0X0x1Y1Z1[1^1b1e1g2W2^2r4m4w5Z5]5^5p7U7Z7h7tS#m]9m!r)R$X$j&y)e,n,q.l1v3X4k5g8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^Q*j%SQ+Y%nQ,O&XQ,V&aQ.S:VQ0O*{Q0S*}Q0_+ZQ1X,TQ2f.PQ4Y0YQ5O1QQ5|2jQ6S:WQ6u4ZR7z5}&xkOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$X$^$b$j%]%c%p&]&`&a&d&f&g&i&m&u&y'S'd't'v'|(T(i(m(q)e)p*s*{+g,X,],b,n,q-R-Z-i-o.P.].d.l/u/z0X0x1Y1Z1[1^1b1e1g1v2W2^2j2r3X4k4m4w5Z5]5^5g5p5}7U7Z7h7t8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^t!kQ!o!r!u!v&x'P'Q'^'_'`,u,{,}-_0u4p4r$Y$pi#r#t$`$a$u$x%T%U%Y)l)u)w)x*P*V*e*f*z*}+l+o.O.Y/X/Y/[/w0l0o0w2i3a3k3s3y4Q4S4v5z6b6k7W7w8S8g8y9X9a:S:T:X:Y:Z:[:]:^:d:e:f:g:h:i:l:m:n:o:r:s;Z;c;d;g;hQ%uzQ&v!cS&|%w,xQ+Y%nS.x)r.zQ/v*nQ0_+ZQ0d+aQ1W,SQ1X,TQ4Y0YQ4c0fQ5R1SQ5S1VQ6u4ZQ6x4`Q7c5UQ8b6yR8m7`pmOXr!T!X#`%]&Z&d&f&g&i,],b1b1eR,Q&]&r^OPXYrstux!X!^!g!l#O#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$X$^$b$j%]%c%p&]&`&a&d&f&g&i&m&u'S'd'v'|(T(i(m(q)e)p*s*{+g,X,],b,n,q-R-Z-i-o.P.].d.l/u/z0X0x1Y1Z1[1^1b1e1g1v2W2^2j2r3X4k4m4w5Z5]5^5g5p5}7U7Z7h7t8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;];^[#XWZ#S#V&y'tQ%fvQ%jwS%oz%t!U%x|}#d#e#h%Z%v'}(X(Y(Z+e+f+h,Z,o-m-s-t-u-w1j2b2c5f5wQ&Q!RQ'T!eQ'V!fQ(b#oS)|$u*QS+S%k%lQ+W%nQ+w&SQ+{&US-U'W'XQ.R(cQ/U)}Q0W+TQ0^+ZQ0`+[Q0c+`Q0z+xS1O+|+}Q2S-VQ3b/QQ4X0YQ4]0]Q4b0eQ4}1PQ6_3cQ6t4ZQ6w4_Q8^6sR9S8_v$wi#t%T%U%Y)u)w*P*e*f.Y/X/w3a3y8S;Z;c;d!S%hw!f!q%j%k%l&w'V'W'X']'g*X+S+T,r-U-V-^/c0W1{2S2Z3uQ*|%fQ+m%}Q+p&OQ+z&UQ.Q(bQ0y+wU0}+{+|+}Q2k.RQ4x0zS4|1O1PQ7_4}!z;_#r$`$a$u$x)l)x*V*z*}+l+o.O/Y/[0l0o0w2i3k3s4Q4S4v5z6b6k7W7w8g8y9X9a:X:Z:]:d:f:h:l:n:r;g;hg;`:S:T:Y:[:^:e:g:i:m:o:sW$|i%O*g;ZS%}!O&ZQ&O!PQ&P!QR+k%{$Z${i#r#t$`$a$u$x%T%U%Y)l)u)w)x*P*V*e*f*z*}+l+o.O.Y/X/Y/[/w0l0o0w2i3a3k3s3y4Q4S4v5z6b6k7W7w8S8g8y9X9a:S:T:X:Y:Z:[:]:^:d:e:f:g:h:i:l:m:n:o:r:s;Z;c;d;g;hT)m$r)nV*k%S:V:WU&|!c%w,xS(p#v#wQ+_%qS-z(^(_Q0p+qQ3z/tR6}4i&xkOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$X$^$b$j%]%c%p&]&`&a&d&f&g&i&m&u&y'S'd't'v'|(T(i(m(q)e)p*s*{+g,X,],b,n,q-R-Z-i-o.P.].d.l/u/z0X0x1Y1Z1[1^1b1e1g1v2W2^2j2r3X4k4m4w5Z5]5^5g5p5}7U7Z7h7t8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^$i$]c#U#a%a%b%d's'y(e(l(t(u(v(w(x(y(z({(|(})O)Q)T)X)c*x+^,s-b-g-l-n.X._.c.e.f.g.v/x1q1t2U2]2q2v2w2x2y2z2{2|2}3O3P3Q3R3S3V3W3]4O4V5i5o5t6Q6R6W6X7P7n7r7{8P8Q8v9U9]9n;QT#PV#Q&ykOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$X$^$b$j%]%c%p&]&`&a&d&f&g&i&m&u&y'S'd't'v'|(T(i(m(q)e)p*s*{+g,X,],b,n,q-R-Z-i-o.P.].d.l/u/z0X0x1Y1Z1[1^1b1e1g1v2W2^2j2r3X4k4m4w5Z5]5^5g5p5}7U7Z7h7t8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^Q&z!cR1w,uv!kQ!c!o!r!u!v&x'P'Q'^'_'`,u,{,}-_0u4p4rS*X$y*_S/c*Y*aQ/l*bQ0r+sQ3u/kR3x/nlpOXr!X#`%]&d&f&g&i,],b1b1eQ&k![Q'h!tS(d#q9tQ+Q%iQ+u&QQ+v&RQ-S'UQ-a'aS.W(i:aS/y*s:jQ0U+RQ0t+tQ1i,dQ1k,eQ1s,pQ2Q-TQ2T-XS4P/z:pQ4T0VS4W0X:qQ5h1uQ5l2RQ5q2YQ6r4UQ7o5jQ7p5mQ7s5rR8s7l$d$[c#U#a%b%d's'y(e(l(t(u(v(w(x(y(z({(|(})O)Q)T)X)c*x+^,s-b-g-l-n.X._.c.f.g.v/x1q1t2U2]2q2v2w2x2y2z2{2|2}3O3P3Q3R3S3V3W3]4O4V5i5o5t6Q6R6W6X7P7n7r7{8P8Q8v9U9]9n;QS(a#l'ZU*d$z(h3US*w%a.eQ2g0OQ5y2fQ7y5|R8z7z$d$Zc#U#a%b%d's'y(e(l(t(u(v(w(x(y(z({(|(})O)Q)T)X)c*x+^,s-b-g-l-n.X._.c.f.g.v/x1q1t2U2]2q2v2w2x2y2z2{2|2}3O3P3Q3R3S3V3W3]4O4V5i5o5t6Q6R6W6X7P7n7r7{8P8Q8v9U9]9n;QS(`#l'ZS(r#w$[S*v%a.eS-{(_(aQ.h)SQ/{*wR2d-|&xkOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$X$^$b$j%]%c%p&]&`&a&d&f&g&i&m&u&y'S'd't'v'|(T(i(m(q)e)p*s*{+g,X,],b,n,q-R-Z-i-o.P.].d.l/u/z0X0x1Y1Z1[1^1b1e1g1v2W2^2j2r3X4k4m4w5Z5]5^5g5p5}7U7Z7h7t8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^S#m]9mQ&f!VQ&g!WQ&i!YQ&j!ZR1a,`Q'R!eQ*y%fQ-Q'TS-}(b*|Q2O-PW2h.Q.R/}0PQ5k2PU5x2e2g2kS7v5y5{S8x7x7yS9_8w8zQ9g9`R9j9hU!sQ'Q,}T4n0u4p!O_OXZ`r!T!X#`#d%Z%]&Z&]&d&f&g&i(Z,],b-t1b1e]!mQ!o'Q,}0u4pT#m]9m%UyOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$^$b%]%c%p&]&`&a&d&f&g&i&m&u'S'd't'v'|(T(i(m(q)p*s*{+g,X,],b-R-Z-i-o.P.].d/u/z0X0x1Y1Z1[1^1b1e1g2W2^2j2r4m4w5Z5]5^5p5}7U7Z7h7tS(p#v#wS-z(^(_!s:w$X$j&y)e,n,q.l1v3X4k5g8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^Y!qQ'Q,}0u4pQ']!oS'g!r!uS'i!v4rS-^'^'_Q-`'`R2Z-_Q'f!qS(V#c1_S-]']'iQ/T)|Q/a*XQ2[-`Q3g/US3p/b/lQ6^3bS6i3v3xQ8U6_R8]6lQ#sbQ'e!qS(U#c1_S(W#i*rQ*t%[Q+O%gQ+U%mU-[']'f'iQ-p(VQ/S)|Q/`*XQ/f*[Q0T+PQ0{+yS2X-]-`Q2a-xS3f/T/US3o/a/lQ3r/eQ3t/gQ4z0|Q5s2[Q6]3bQ6a3gS6e3p3xQ6j3wQ7]4{S8T6^6_Q8X6fQ8Z6iQ8j7^Q9O8UQ9P8YQ9R8]Q9Z8kQ9c9QQ:z:uQ;V;OR;W;PV!sQ'Q,}%UaOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$^$b%]%c%p&]&`&a&d&f&g&i&m&u'S'd't'v'|(T(i(m(q)p*s*{+g,X,],b-R-Z-i-o.P.].d/u/z0X0x1Y1Z1[1^1b1e1g2W2^2j2r4m4w5Z5]5^5p5}7U7Z7h7tS#sx!g!r:t$X$j&y)e,n,q.l1v3X4k5g8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^R:z;]%UbOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$^$b%]%c%p&]&`&a&d&f&g&i&m&u'S'd't'v'|(T(i(m(q)p*s*{+g,X,],b-R-Z-i-o.P.].d/u/z0X0x1Y1Z1[1^1b1e1g2W2^2j2r4m4w5Z5]5^5p5}7U7Z7h7tQ%[j!S%gw!f!q%j%k%l&w'V'W'X']'g*X+S+T,r-U-V-^/c0W1{2S2Z3uS%mx!gQ+P%hQ+y&UW0|+z+{+|+}U4{0}1O1PS7^4|4}Q8k7_!r:u$X$j&y)e,n,q.l1v3X4k5g8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^Q;O;[R;P;]$xeOPXYrstu!X!^!l#O#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$^$b%]%c%p&]&`&d&f&g&i&m&u'S'd'v'|(T(i(m(q)p*s*{+g,X,],b-R-Z-i-o.P.].d/u/z0X0x1Y1Z1[1^1b1e1g2W2^2j2r4m4w5Z5]5^5p5}7U7Z7h7tY#^WZ#S#V't!U%x|}#d#e#h%Z%v'}(X(Y(Z+e+f+h,Z,o-m-s-t-u-w1j2b2c5f5wQ,W&a!p:v$X$j)e,n,q.l1v3X4k5g8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^R:y&yS&}!c%wR1y,x$zdOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$^$b%]%c%p&]&`&d&f&g&i&m&u'S'd't'v'|(T(i(m(q)p*s+g,X,],b-R-Z-i-o.].d/u/z0X0x1Y1Z1[1^1b1e1g2W2^2r4m4w5Z5]5^5p7U7Z7h7t!r)R$X$j&y)e,n,q.l1v3X4k5g8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^Q,V&aQ0O*{Q2f.PQ5|2jR7z5}!f$Rc#U%a's'y(e(l({(|(})O)T)X+^-b-g-l-n.X._.v/x2U2]2q3S4O4V5o5t6Q7r8v9n!T9{)Q)c,s.e1q1t2v3O3P3Q3R3V3]5i6R6W6X7P7n7{8P8Q9U9];Q!b$Tc#U%a's'y(e(l(})O)T)X+^-b-g-l-n.X._.v/x2U2]2q3S4O4V5o5t6Q7r8v9n!P9})Q)c,s.e1q1t2v3Q3R3V3]5i6R6W6X7P7n7{8P8Q9U9];Q!^$Xc#U%a's'y(e(l)T)X+^-b-g-l-n.X._.v/x2U2]2q3S4O4V5o5t6Q7r8v9nQ3a/Oz;^)Q)c,s.e1q1t2v3V3]5i6R6W6X7P7n7{8P8Q9U9];QQ;c;eR;d;f&xkOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$X$^$b$j%]%c%p&]&`&a&d&f&g&i&m&u&y'S'd't'v'|(T(i(m(q)e)p*s*{+g,X,],b,n,q-R-Z-i-o.P.].d.l/u/z0X0x1Y1Z1[1^1b1e1g1v2W2^2j2r3X4k4m4w5Z5]5^5g5p5}7U7Z7h7t8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^S$kh$lR3Y.k'PgOPWXYZhrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$X$^$b$j$l%]%c%p&]&`&a&d&f&g&i&m&u&y'S'd't'v'|(T(i(m(q)e)p*s*{+g,X,],b,n,q-R-Z-i-o.P.].d.k.l/u/z0X0x1Y1Z1[1^1b1e1g1v2W2^2j2r3X4k4m4w5Z5]5^5g5p5}7U7Z7h7t8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^T$gf$mQ$efS)[$h)`R)h$mT$ff$mT)^$h)`'PhOPWXYZhrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$X$^$b$j$l%]%c%p&]&`&a&d&f&g&i&m&u&y'S'd't'v'|(T(i(m(q)e)p*s*{+g,X,],b,n,q-R-Z-i-o.P.].d.k.l/u/z0X0x1Y1Z1[1^1b1e1g1v2W2^2j2r3X4k4m4w5Z5]5^5g5p5}7U7Z7h7t8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^T$kh$lQ$nhR)g$l%UjOPWXYZrstu!X!^!l#O#S#V#`#k#q#u#x#{#|#}$O$P$Q$R$S$T$U$V$^$b%]%c%p&]&`&a&d&f&g&i&m&u'S'd't'v'|(T(i(m(q)p*s*{+g,X,],b-R-Z-i-o.P.].d/u/z0X0x1Y1Z1[1^1b1e1g2W2^2j2r4m4w5Z5]5^5p5}7U7Z7h7t!s;[$X$j&y)e,n,q.l1v3X4k5g8c8t9l9o9p9q9t9u9v9w9x9y9z9{9|9}:O:P:Q:U:_:`:a:c:j:k:p:q;^#alOPXZr!X!^!l#O#`#k#x$j%]&]&`&a&d&f&g&i&m&u'S(q)e*{+g,X,],b-R.P.l/u0x1Y1Z1[1^1b1e1g2j3X4m4w5Z5]5^5}7U7Z7hv$zi#t%T%U%Y)u)w*P*e*f.Y/X/w3a3y8S;Z;c;d!z(h#r$`$a$u$x)l)x*V*z*}+l+o.O/Y/[0l0o0w2i3k3s4Q4S4v5z6b6k7W7w8g8y9X9a:X:Z:]:d:f:h:l:n:r;g;hQ*o%WQ.w)qg3U:S:T:Y:[:^:e:g:i:m:o:sv$vi#t%T%U%Y)u)w*P*e*f.Y/X/w3a3y8S;Z;c;dQ*R$wS*[$y*_Q*p%XQ/g*]!z:|#r$`$a$u$x)l)x*V*z*}+l+o.O/Y/[0l0o0w2i3k3s4Q4S4v5z6b6k7W7w8g8y9X9a:X:Z:]:d:f:h:l:n:r;g;hf:}:S:T:Y:[:^:e:g:i:m:o:sQ;R;_Q;S;`Q;T;aR;U;bv$zi#t%T%U%Y)u)w*P*e*f.Y/X/w3a3y8S;Z;c;d!z(h#r$`$a$u$x)l)x*V*z*}+l+o.O/Y/[0l0o0w2i3k3s4Q4S4v5z6b6k7W7w8g8y9X9a:X:Z:]:d:f:h:l:n:r;g;hg3U:S:T:Y:[:^:e:g:i:m:o:slnOXr!X#`%]&d&f&g&i,],b1b1eQ*U$xQ,k&pQ,l&rR3j/Y$Y${i#r#t$`$a$u$x%T%U%Y)l)u)w)x*P*V*e*f*z*}+l+o.O.Y/X/Y/[/w0l0o0w2i3a3k3s3y4Q4S4v5z6b6k7W7w8S8g8y9X9a:S:T:X:Y:Z:[:]:^:d:e:f:g:h:i:l:m:n:o:r:s;Z;c;d;g;hQ+n&OQ0n+pQ4g0mR6|4hT*^$y*_S*^$y*_T4o0u4pS/e*Z4mT3w/m7UQ+O%gQ/f*[Q0T+PQ0{+yQ4z0|Q7]4{Q8j7^R9Z8kn)u$s(j*q/W/o/p2o3h3}6[6m8}:{;X;Y!W:d(f)V){*T.V.s/O/]/|0k0m2n3i3m4f4h6O6P6c6g6o6q8W8[9b;e;f]:e3T6V7|8{8|9kp)w$s(j*q.|/W/o/p2o3h3}6[6m8}:{;X;Y!Y:f(f)V){*T.V.s/O/]/|0k0m2l2n3i3m4f4h6O6P6c6g6o6q8W8[9b;e;f_:g3T6V7|7}8{8|9kpmOXr!T!X#`%]&Z&d&f&g&i,],b1b1eQ&W!SR,X&apmOXr!T!X#`%]&Z&d&f&g&i,],b1b1eR&W!SQ+r&PR0j+kqmOXr!T!X#`%]&Z&d&f&g&i,],b1b1eQ0v+wS4u0y0zU7V4s4t4xS8f7X7YS9V8e8hQ9d9WR9i9eQ&_!TR,R&ZR5R1SS%oz%tR0`+[Q&d!UR,]&eR,c&jT1c,b1eR,g&kQ,f&kR1l,gQ'k!wR-c'kQrOQ#`XT%`r#`Q!zTR'm!zQ!}UR'o!}Q)n$rR.t)nQ#QVR'q#QQ#TWU'w#T'x-jQ'x#UR-j'yQ,v&zR1x,vQ.Z(jR2p.ZQ.^(lS2s.^2tR2t._Q,}'QR1|,}Y!oQ'Q,}0u4pR'[!oS#ZW%vU(O#Z(P-kQ(P#[R-k'zQ,y&}R1z,yr`OXr!T!X#`%]&Z&]&d&f&g&i,],b1b1eS#dZ%ZU#n`#d-tR-t(ZQ([#fQ-q(WW-y([-q2_5uQ2_-rR5u2`Q)`$hR.m)`Q$lhR)f$lQ$_cU)U$_-f:RQ-f9nR:R)cQ/R)|W3d/R3e6`8VU3e/S/T/US6`3f3gR8V6a#m)s$s(f(j)V){*T*l*m*q.T.U.V.s.|.}/O/W/]/o/p/|0k0m2l2m2n2o3T3h3i3m3}4f4h6O6P6T6U6V6[6c6g6m6o6q7|7}8O8W8[8{8|8}9b9k:{;X;Y;e;fQ/Z*TU3l/Z3n6dQ3n/]R6d3mQ*_$yR/i*_Q*h$}R/r*hQ4R/|R6p4RQ+i%yR0i+iQ4j0pS7O4j8dR8d7PQ+t&QR0s+tQ4p0uR7S4pQ1R,OS5P1R7aR7a5RQ0Z+WW4[0Z4^6v8`Q4^0^Q6v4]R8`6wQ+]%oR0a+]Q1e,bR5a1eWqOXr#`Q&h!XQ*u%]Q,[&dQ,^&fQ,_&gQ,a&iQ1`,]S1c,b1eR5`1bQ%_oQ&l!]Q&o!_Q&q!`Q&s!aQ'c!qQ+Q%iQ+d%uQ+j%zQ,Q&_Q,i&nW-Y']'e'f'iQ-a'aQ/h*^Q0U+RS1U,R,UQ1m,hQ1n,kQ1o,lQ2T-XW2V-[-]-`-bQ4T0VQ4a0dQ4e0kQ4y0{Q5T1WQ5_1aU5n2U2X2[Q5q2YQ6r4UQ6z4cQ6{4fQ7R4oQ7[4zQ7b5SS7q5o5sQ7s5rQ8a6xQ8i7]Q8n7cQ8u7rQ9T8bQ9Y8jQ9^8vR9f9ZQ%iwQ'U!fQ'a!qU+R%j%k%lQ,p&wU-T'V'W'XS-X']'gQ/_*XS0V+S+TQ1u,rS2R-U-VQ2Y-^Q3q/cQ4U0WQ5j1{Q5m2SQ5r2ZR6h3uS$ti;ZR*i%OU$}i%O;ZR/q*gQ$siS(f#r*}Q(j#tS)V$`$aQ){$uQ*T$xQ*l%TQ*m%UQ*q%YQ.T:XQ.U:ZQ.V:]Q.s)lQ.|)uQ.})wQ/O)xQ/W*PQ/]*VQ/o*eQ/p*fh/|*z.O0w2i4v5z7W7w8g8y9X9aQ0k+lQ0m+oQ2l:dQ2m:fQ2n:hQ2o.YS3T:S:TQ3h/XQ3i/YQ3m/[Q3}/wQ4f0lQ4h0oQ6O:lQ6P:nQ6T:YQ6U:[Q6V:^Q6[3aQ6c3kQ6g3sQ6m3yQ6o4QQ6q4SQ7|:iQ7}:eQ8O:gQ8W6bQ8[6kQ8{:mQ8|:oQ8}8SQ9b:rQ9k:sQ:{;ZQ;X;cQ;Y;dQ;e;gR;f;hloOXr!X#`%]&d&f&g&i,],b1b1eQ!dPS#bZ#kQ&n!^U'Y!l4m7UQ'p#OQ(s#xQ)d$jS,U&]&`Q,Y&aQ,h&mQ,m&uQ-P'SQ.a(qQ.q)eQ0P*{Q0g+gQ1],XQ2P-RQ2g.PQ3[.lQ3{/uQ4t0xQ5V1YQ5W1ZQ5Y1[Q5[1^Q5c1gQ5y2jQ6Y3XQ7Y4wQ7g5ZQ7i5]Q7j5^Q7y5}Q8h7ZR8p7h#UcOPXZr!X!^!l#`#k#x%]&]&`&a&d&f&g&i&m&u'S(q*{+g,X,],b-R.P/u0x1Y1Z1[1^1b1e1g2j4m4w5Z5]5^5}7U7Z7hQ#UWQ#aYQ%asQ%btQ%duS's#S'vQ'y#VQ(e#qQ(l#uQ(t#{Q(u#|Q(v#}Q(w$OQ(x$PQ(y$QQ(z$RQ({$SQ(|$TQ(}$UQ)O$VQ)Q$XQ)T$^Q)X$bW)c$j)e.l3XQ*x%cQ+^%pS,s&y1vQ-b'dS-g't-iQ-l'|Q-n(TQ.X(iQ._(mQ.c9lQ.e9oQ.f9pQ.g9qQ.v)pQ/x*sQ1q,nQ1t,qQ2U-ZQ2]-oQ2q.]Q2v9tQ2w9uQ2x9vQ2y9wQ2z9xQ2{9yQ2|9zQ2}9{Q3O9|Q3P9}Q3Q:OQ3R:PQ3S.dQ3V:UQ3W:_Q3]:QQ4O/zQ4V0XQ5i:`Q5o2WQ5t2^Q6Q2rQ6R:aQ6W:cQ6X:jQ7P4kQ7n5gQ7r5pQ7{:kQ8P:pQ8Q:qQ8v7tQ9U8cQ9]8tQ9n#OR;Q;^R#WWR&{!cY!qQ'Q,}0u4pS&w!c,uQ']!oS'g!r!uS'i!v4rS,r&x'PS-^'^'_Q-`'`Q1{,{R2Z-_R(k#tR(n#uQ!dQT,|'Q,}]!nQ!o'Q,}0u4pQ#l]R'Z9mT#gZ%ZS#fZ%ZU%y|},ZU(W#d#e#hS-r(X(YQ-v(ZQ0h+hQ2`-sU2a-t-u-wS5v2b2cR7u5w`#YW#S#V%v't'}+e-mt#cZ|}#d#e#h%Z(X(Y(Z+h-s-t-u-w2b2c5wQ1_,ZQ1r,oQ5e1jQ7m5fT:x&y+fT#]W%vS#[W%vS'u#S'}S'z#V+eS,t&y+fT-h't-mT'O!c%wQ$hfR)j$mT)_$h)`R3Z.kT*O$u*QR*W$xQ/}*zQ2e.OQ4s0wQ5{2iQ7X4vQ7x5zQ8e7WQ8w7wQ9W8gQ9`8yQ9e9XR9h9alpOXr!X#`%]&d&f&g&i,],b1b1eQ&^!TR,Q&ZV%z|},ZR0q+qR,P&XQ%szR+c%tR+X%nT&b!U&eT&c!U&eT1d,b1e",nodeNames:"⚠ ArithOp ArithOp LineComment BlockComment Script ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > TypeParamList TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . ?. PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewExpression new TypeArgList CompareOp < ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in const CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXStartTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast ArrowFunction TypeParamList SequenceExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:364,context:Jf,nodeProps:[["group",-26,6,14,16,62,199,203,206,207,209,212,215,225,227,233,235,237,239,242,248,254,256,258,260,262,264,265,"Statement",-32,10,11,25,28,29,35,45,48,49,51,56,64,72,76,78,80,81,103,104,113,114,131,134,136,137,138,139,141,142,162,163,165,"Expression",-23,24,26,30,34,36,38,166,168,170,171,173,174,175,177,178,179,181,182,183,193,195,197,198,"Type",-3,84,96,102,"ClassItem"],["openedBy",31,"InterpolationStart",50,"[",54,"{",69,"(",143,"JSXStartTag",155,"JSXStartTag JSXStartCloseTag"],["closedBy",33,"InterpolationEnd",44,"]",55,"}",70,")",144,"JSXSelfCloseEndTag JSXEndTag",160,"JSXEndTag"]],propSources:[ip],skippedNodes:[0,3,4,268],repeatNodeCount:33,tokenData:"$>y(CSR!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tu>PuvBavwDxwxGgxyMvyz! Qz{!![{|!%O|}!&]}!O!%O!O!P!'g!P!Q!1w!Q!R#0t!R![#3T![!]#@T!]!^#Aa!^!_#Bk!_!`#GS!`!a#In!a!b#N{!b!c$$z!c!}>P!}#O$&U#O#P$'`#P#Q$,w#Q#R$.R#R#S>P#S#T$/`#T#o$0j#o#p$4z#p#q$5p#q#r$7Q#r#s$8^#s$f%Z$f$g+g$g#BY>P#BY#BZ$9h#BZ$IS>P$IS$I_$9h$I_$I|>P$I|$I}$<s$I}$JO$<s$JO$JT>P$JT$JU$9h$JU$KV>P$KV$KW$9h$KW&FU>P&FU&FV$9h&FV;'S>P;'S;=`BZ<%l?HT>P?HT?HU$9h?HUO>P(n%d_$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$d&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$d&j'z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU'z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$d&j'wpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU'wpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX'wp'z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z(CS+rq$d&j'wp'z!b'm(;dOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z(CS.ST'x#S$d&j'n(;dO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c(CS.n_$d&j'wp'z!b'n(;dOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`/x`$d&j!l$Ip'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S1V`#q$Id$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S2d_#q$Id$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$2b3l_'v$(n$d&j'z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k*r4r_$d&j'z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k)`5vX$d&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q)`6jT$_#t$d&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#t6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y#t7bO$_#t#t7eP;=`<%l6y)`7kP;=`<%l5q*r7w]$_#t$d&j'z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}%W8uZ'z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p%W9oU$_#t'z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}%W:UP;=`<%l8p*r:[P;=`<%l4k#%|:hg$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}st%Ztu<Puw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}<P!}#O%Z#O#P&c#P#R%Z#R#S<P#S#T%Z#T#o<P#o#p*g#p$g%Z$g;'S<P;'S;=`=y<%lO<P#%|<[i$d&j(a!L^'wp'z!bOY%ZYZ&cZr%Zrs&}st%Ztu<Puw%Zwx(rx!Q%Z!Q![<P![!^%Z!^!_*g!_!c%Z!c!}<P!}#O%Z#O#P&c#P#R%Z#R#S<P#S#T%Z#T#o<P#o#p*g#p$g%Z$g;'S<P;'S;=`=y<%lO<P#%|=|P;=`<%l<P(CS>`k$d&j'wp'z!b(U!LY't&;d$W#tOY%ZYZ&cZr%Zrs&}st%Ztu>Puw%Zwx(rx}%Z}!O@T!O!Q%Z!Q![>P![!^%Z!^!_*g!_!c%Z!c!}>P!}#O%Z#O#P&c#P#R%Z#R#S>P#S#T%Z#T#o>P#o#p*g#p$g%Z$g;'S>P;'S;=`BZ<%lO>P+d@`k$d&j'wp'z!b$W#tOY%ZYZ&cZr%Zrs&}st%Ztu@Tuw%Zwx(rx}%Z}!O@T!O!Q%Z!Q![@T![!^%Z!^!_*g!_!c%Z!c!}@T!}#O%Z#O#P&c#P#R%Z#R#S@T#S#T%Z#T#o@T#o#p*g#p$g%Z$g;'S@T;'S;=`BT<%lO@T+dBWP;=`<%l@T(CSB^P;=`<%l>P%#SBl`$d&j'wp'z!b#i$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SCy_$d&j#{$Id'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%DfETa(j%<v$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sv%ZvwFYwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SFe`$d&j#u$Id'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$2bGp_'y$)`$d&j'wpOYHoYZIuZrHorsIuswHowxKVx!^Ho!^!_LX!_#OHo#O#PIu#P#oHo#o#pLX#p;'SHo;'S;=`Mp<%lOHo*QHv_$d&j'wpOYHoYZIuZrHorsIuswHowxKVx!^Ho!^!_LX!_#OHo#O#PIu#P#oHo#o#pLX#p;'SHo;'S;=`Mp<%lOHo)`IzX$d&jOwIuwx6cx!^Iu!^!_Jg!_#oIu#o#pJg#p;'SIu;'S;=`KP<%lOIu#tJjTOwJgwx7]x;'SJg;'S;=`Jy<%lOJg#tJ|P;=`<%lJg)`KSP;=`<%lIu*QK`]$_#t$d&j'wpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r$fL^Z'wpOYLXYZJgZrLXrsJgswLXwxMPx#OLX#O#PJg#P;'SLX;'S;=`Mj<%lOLX$fMWU$_#t'wpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r$fMmP;=`<%lLX*QMsP;=`<%lHo(*QNR_!h(!b$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'l! ]_!gM|$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h!!ib$d&j'wp'z!b'u#)d#j$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!#q{!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S!#|`$d&j'wp'z!b#g$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&-O!%Z`$d&j'wp'z!bk&%`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&C[!&h_!V&;l$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!'rc$d&j'wp'z!by'<nOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!(}!P!Q%Z!Q![!+g![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!)Wa$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!*]!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!*h_!UMt$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!+rg$d&j'wp'z!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!+g![!^%Z!^!_*g!_!g%Z!g!h!-Z!h#O%Z#O#P&c#P#R%Z#R#S!+g#S#X%Z#X#Y!-Z#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!-dg$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!.{|}%Z}!O!.{!O!Q%Z!Q![!0a![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!0a#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!/Uc$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!0a![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!0a#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!0lc$d&j'wp'z!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!0a![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!0a#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!2Sf$d&j'wp'z!b#h$IdOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}xz!3hz{#$s{!P!3h!P!Q#&Y!Q!^!3h!^!_!Mh!_!`#-x!`!a#/_!a!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h(r!3sb$d&j'wp'z!b!RSOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}x!P!3h!P!Q!Kh!Q!^!3h!^!_!Mh!_!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h(Q!5U`$d&j'z!b!RSOY!4{YZ&cZw!4{wx!6Wx!P!4{!P!Q!=o!Q!^!4{!^!_!?g!_!}!4{!}#O!Bn#O#P!<w#P#o!4{#o#p!?g#p;'S!4{;'S;=`!Cw<%lO!4{&n!6_^$d&j!RSOY!6WYZ&cZ!P!6W!P!Q!7Z!Q!^!6W!^!_!8g!_!}!6W!}#O!;U#O#P!<w#P#o!6W#o#p!8g#p;'S!6W;'S;=`!=i<%lO!6W&n!7ba$d&j!RSO!^&c!_#Z&c#Z#[!7Z#[#]&c#]#^!7Z#^#a&c#a#b!7Z#b#g&c#g#h!7Z#h#i&c#i#j!7Z#j#m&c#m#n!7Z#n#o&c#p;'S&c;'S;=`&w<%lO&cS!8lX!RSOY!8gZ!P!8g!P!Q!9X!Q!}!8g!}#O!9p#O#P!:o#P;'S!8g;'S;=`!;O<%lO!8gS!9^U!RS#Z#[!9X#]#^!9X#a#b!9X#g#h!9X#i#j!9X#m#n!9XS!9sVOY!9pZ#O!9p#O#P!:Y#P#Q!8g#Q;'S!9p;'S;=`!:i<%lO!9pS!:]SOY!9pZ;'S!9p;'S;=`!:i<%lO!9pS!:lP;=`<%l!9pS!:rSOY!8gZ;'S!8g;'S;=`!;O<%lO!8gS!;RP;=`<%l!8g&n!;Z[$d&jOY!;UYZ&cZ!^!;U!^!_!9p!_#O!;U#O#P!<P#P#Q!6W#Q#o!;U#o#p!9p#p;'S!;U;'S;=`!<q<%lO!;U&n!<UX$d&jOY!;UYZ&cZ!^!;U!^!_!9p!_#o!;U#o#p!9p#p;'S!;U;'S;=`!<q<%lO!;U&n!<tP;=`<%l!;U&n!<|X$d&jOY!6WYZ&cZ!^!6W!^!_!8g!_#o!6W#o#p!8g#p;'S!6W;'S;=`!=i<%lO!6W&n!=lP;=`<%l!6W(Q!=xi$d&j'z!b!RSOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#Z&}#Z#[!=o#[#]&}#]#^!=o#^#a&}#a#b!=o#b#g&}#g#h!=o#h#i&}#i#j!=o#j#m&}#m#n!=o#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!f!?nZ'z!b!RSOY!?gZw!?gwx!8gx!P!?g!P!Q!@a!Q!}!?g!}#O!Ap#O#P!:o#P;'S!?g;'S;=`!Bh<%lO!?g!f!@hb'z!b!RSOY'}Zw'}x#O'}#P#Z'}#Z#[!@a#[#]'}#]#^!@a#^#a'}#a#b!@a#b#g'}#g#h!@a#h#i'}#i#j!@a#j#m'}#m#n!@a#n;'S'};'S;=`(f<%lO'}!f!AuX'z!bOY!ApZw!Apwx!9px#O!Ap#O#P!:Y#P#Q!?g#Q;'S!Ap;'S;=`!Bb<%lO!Ap!f!BeP;=`<%l!Ap!f!BkP;=`<%l!?g(Q!Bu^$d&j'z!bOY!BnYZ&cZw!Bnwx!;Ux!^!Bn!^!_!Ap!_#O!Bn#O#P!<P#P#Q!4{#Q#o!Bn#o#p!Ap#p;'S!Bn;'S;=`!Cq<%lO!Bn(Q!CtP;=`<%l!Bn(Q!CzP;=`<%l!4{'`!DW`$d&j'wp!RSOY!C}YZ&cZr!C}rs!6Ws!P!C}!P!Q!EY!Q!^!C}!^!_!GQ!_!}!C}!}#O!JX#O#P!<w#P#o!C}#o#p!GQ#p;'S!C};'S;=`!Kb<%lO!C}'`!Eci$d&j'wp!RSOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#Z(r#Z#[!EY#[#](r#]#^!EY#^#a(r#a#b!EY#b#g(r#g#h!EY#h#i(r#i#j!EY#j#m(r#m#n!EY#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rt!GXZ'wp!RSOY!GQZr!GQrs!8gs!P!GQ!P!Q!Gz!Q!}!GQ!}#O!IZ#O#P!:o#P;'S!GQ;'S;=`!JR<%lO!GQt!HRb'wp!RSOY)rZr)rs#O)r#P#Z)r#Z#[!Gz#[#])r#]#^!Gz#^#a)r#a#b!Gz#b#g)r#g#h!Gz#h#i)r#i#j!Gz#j#m)r#m#n!Gz#n;'S)r;'S;=`*Z<%lO)rt!I`X'wpOY!IZZr!IZrs!9ps#O!IZ#O#P!:Y#P#Q!GQ#Q;'S!IZ;'S;=`!I{<%lO!IZt!JOP;=`<%l!IZt!JUP;=`<%l!GQ'`!J`^$d&j'wpOY!JXYZ&cZr!JXrs!;Us!^!JX!^!_!IZ!_#O!JX#O#P!<P#P#Q!C}#Q#o!JX#o#p!IZ#p;'S!JX;'S;=`!K[<%lO!JX'`!K_P;=`<%l!JX'`!KeP;=`<%l!C}(r!Ksk$d&j'wp'z!b!RSOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#Z%Z#Z#[!Kh#[#]%Z#]#^!Kh#^#a%Z#a#b!Kh#b#g%Z#g#h!Kh#h#i%Z#i#j!Kh#j#m%Z#m#n!Kh#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#W!Mq]'wp'z!b!RSOY!MhZr!Mhrs!?gsw!Mhwx!GQx!P!Mh!P!Q!Nj!Q!}!Mh!}#O#!U#O#P!:o#P;'S!Mh;'S;=`##U<%lO!Mh#W!Nse'wp'z!b!RSOY*gZr*grs'}sw*gwx)rx#O*g#P#Z*g#Z#[!Nj#[#]*g#]#^!Nj#^#a*g#a#b!Nj#b#g*g#g#h!Nj#h#i*g#i#j!Nj#j#m*g#m#n!Nj#n;'S*g;'S;=`+Z<%lO*g#W#!]Z'wp'z!bOY#!UZr#!Urs!Apsw#!Uwx!IZx#O#!U#O#P!:Y#P#Q!Mh#Q;'S#!U;'S;=`##O<%lO#!U#W##RP;=`<%l#!U#W##XP;=`<%l!Mh(r##e`$d&j'wp'z!bOY##[YZ&cZr##[rs!Bnsw##[wx!JXx!^##[!^!_#!U!_#O##[#O#P!<P#P#Q!3h#Q#o##[#o#p#!U#p;'S##[;'S;=`#$g<%lO##[(r#$jP;=`<%l##[(r#$pP;=`<%l!3h(CS#%Qb$d&j'wp'z!b'o(;d!RSOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}x!P!3h!P!Q!Kh!Q!^!3h!^!_!Mh!_!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h(CS#&e_$d&j'wp'z!bR(;dOY#&YYZ&cZr#&Yrs#'dsw#&Ywx#*tx!^#&Y!^!_#,s!_#O#&Y#O#P#(f#P#o#&Y#o#p#,s#p;'S#&Y;'S;=`#-r<%lO#&Y(Bb#'m]$d&j'z!bR(;dOY#'dYZ&cZw#'dwx#(fx!^#'d!^!_#)w!_#O#'d#O#P#(f#P#o#'d#o#p#)w#p;'S#'d;'S;=`#*n<%lO#'d(AO#(mX$d&jR(;dOY#(fYZ&cZ!^#(f!^!_#)Y!_#o#(f#o#p#)Y#p;'S#(f;'S;=`#)q<%lO#(f(;d#)_SR(;dOY#)YZ;'S#)Y;'S;=`#)k<%lO#)Y(;d#)nP;=`<%l#)Y(AO#)tP;=`<%l#(f(<v#*OW'z!bR(;dOY#)wZw#)wwx#)Yx#O#)w#O#P#)Y#P;'S#)w;'S;=`#*h<%lO#)w(<v#*kP;=`<%l#)w(Bb#*qP;=`<%l#'d(Ap#*}]$d&j'wpR(;dOY#*tYZ&cZr#*trs#(fs!^#*t!^!_#+v!_#O#*t#O#P#(f#P#o#*t#o#p#+v#p;'S#*t;'S;=`#,m<%lO#*t(<U#+}W'wpR(;dOY#+vZr#+vrs#)Ys#O#+v#O#P#)Y#P;'S#+v;'S;=`#,g<%lO#+v(<U#,jP;=`<%l#+v(Ap#,pP;=`<%l#*t(=h#,|Y'wp'z!bR(;dOY#,sZr#,srs#)wsw#,swx#+vx#O#,s#O#P#)Y#P;'S#,s;'S;=`#-l<%lO#,s(=h#-oP;=`<%l#,s(CS#-uP;=`<%l#&Y%#W#.Vb$d&j#{$Id'wp'z!b!RSOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}x!P!3h!P!Q!Kh!Q!^!3h!^!_!Mh!_!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h+h#/lb$T#t$d&j'wp'z!b!RSOY!3hYZ&cZr!3hrs!4{sw!3hwx!C}x!P!3h!P!Q!Kh!Q!^!3h!^!_!Mh!_!}!3h!}#O##[#O#P!<w#P#o!3h#o#p!Mh#p;'S!3h;'S;=`#$m<%lO!3h$/l#1Pp$d&j'wp'z!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!+g!P!Q%Z!Q![#3T![!^%Z!^!_*g!_!g%Z!g!h!-Z!h#O%Z#O#P&c#P#R%Z#R#S#3T#S#U%Z#U#V#6_#V#X%Z#X#Y!-Z#Y#b%Z#b#c#5T#c#d#9g#d#l%Z#l#m#<i#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#3`k$d&j'wp'z!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!+g!P!Q%Z!Q![#3T![!^%Z!^!_*g!_!g%Z!g!h!-Z!h#O%Z#O#P&c#P#R%Z#R#S#3T#S#X%Z#X#Y!-Z#Y#b%Z#b#c#5T#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#5`_$d&j'wp'z!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#6hd$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#7v!R!S#7v!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#7v#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#8Rf$d&j'wp'z!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#7v!R!S#7v!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#7v#S#b%Z#b#c#5T#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#9pc$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#:{!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#:{#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#;We$d&j'wp'z!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#:{!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#:{#S#b%Z#b#c#5T#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#<rg$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#>Z![!^%Z!^!_*g!_!c%Z!c!i#>Z!i#O%Z#O#P&c#P#R%Z#R#S#>Z#S#T%Z#T#Z#>Z#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#>fi$d&j'wp'z!bl$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#>Z![!^%Z!^!_*g!_!c%Z!c!i#>Z!i#O%Z#O#P&c#P#R%Z#R#S#>Z#S#T%Z#T#Z#>Z#Z#b%Z#b#c#5T#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh#@b_!a$b$d&j#y%<f'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Al_^l$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS#Bz^'}!*v!e'.r'wp'z!b$U)d(nSOY*gZr*grs'}sw*gwx)rx!P*g!P!Q#Cv!Q!^*g!^!_#Dl!_!`#F^!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#DPX$f&j'wp'z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#DuZ#k$Id'wp'z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Eh!`#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#EqX#{$Id'wp'z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#FgX#l$Id'wp'z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Gh#G_a#X%?x$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a#Hd!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#W#Ho_#d$Ih$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh#I}adBf#l$Id$a#|$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`#KS!`!a#L^!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S#K__#l$Id$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S#Lia#k$Id$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`!a#Mn!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S#My`#k$Id$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h$ Wc(b$Ip$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P$!c!P!^%Z!^!_*g!_!a%Z!a!b$#m!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+`$!n_z'#p$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$#x`$d&j#v$Id'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&^$%V_!x!Ln$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(@^$&a_|(8n$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$'eZ$d&jO!^$(W!^!_$(n!_#i$(W#i#j$(s#j#l$(W#l#m$*f#m#o$(W#o#p$(n#p;'S$(W;'S;=`$,q<%lO$(W(n$(_T[#S$d&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$(sO[#S(n$(x[$d&jO!Q&c!Q![$)n![!^&c!_!c&c!c!i$)n!i#T&c#T#Z$)n#Z#o&c#o#p$,U#p;'S&c;'S;=`&w<%lO&c(n$)sZ$d&jO!Q&c!Q![$*f![!^&c!_!c&c!c!i$*f!i#T&c#T#Z$*f#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$*kZ$d&jO!Q&c!Q![$+^![!^&c!_!c&c!c!i$+^!i#T&c#T#Z$+^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$+cZ$d&jO!Q&c!Q![$(W![!^&c!_!c&c!c!i$(W!i#T&c#T#Z$(W#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$,XR!Q![$,b!c!i$,b#T#Z$,b#S$,eS!Q![$,b!c!i$,b#T#Z$,b#q#r$(n(n$,tP;=`<%l$(W!'l$-S_!SM|$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$.^`#s$Id$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&,v$/k_$d&j'wp'z!b(R&%WOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$0yk$d&j'wp'z!b(U!LY't&;d$Y#tOY%ZYZ&cZr%Zrs&}st%Ztu$0juw%Zwx(rx}%Z}!O$2n!O!Q%Z!Q![$0j![!^%Z!^!_*g!_!c%Z!c!}$0j!}#O%Z#O#P&c#P#R%Z#R#S$0j#S#T%Z#T#o$0j#o#p*g#p$g%Z$g;'S$0j;'S;=`$4t<%lO$0j+d$2yk$d&j'wp'z!b$Y#tOY%ZYZ&cZr%Zrs&}st%Ztu$2nuw%Zwx(rx}%Z}!O$2n!O!Q%Z!Q![$2n![!^%Z!^!_*g!_!c%Z!c!}$2n!}#O%Z#O#P&c#P#R%Z#R#S$2n#S#T%Z#T#o$2n#o#p*g#p$g%Z$g;'S$2n;'S;=`$4n<%lO$2n+d$4qP;=`<%l$2n(CS$4wP;=`<%l$0j!5p$5TX!X!3l'wp'z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Df$5{a(i%<v$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Cn!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$#m#q;'S%Z;'S;=`+a<%lO%Z%#`$7__!W$I`o`$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(r$8i_!mS$d&j'wp'z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$9y|$d&j'wp'z!b'm(;d(U!LY't&;d$W#tOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%Ztu>Puw%Zwx(rx}%Z}!O@T!O!Q%Z!Q![>P![!^%Z!^!_*g!_!c%Z!c!}>P!}#O%Z#O#P&c#P#R%Z#R#S>P#S#T%Z#T#o>P#o#p*g#p$f%Z$f$g+g$g#BY>P#BY#BZ$9h#BZ$IS>P$IS$I_$9h$I_$JT>P$JT$JU$9h$JU$KV>P$KV$KW$9h$KW&FU>P&FU&FV$9h&FV;'S>P;'S;=`BZ<%l?HT>P?HT?HU$9h?HUO>P(CS$=Uk$d&j'wp'z!b'n(;d(U!LY't&;d$W#tOY%ZYZ&cZr%Zrs&}st%Ztu>Puw%Zwx(rx}%Z}!O@T!O!Q%Z!Q![>P![!^%Z!^!_*g!_!c%Z!c!}>P!}#O%Z#O#P&c#P#R%Z#R#S>P#S#T%Z#T#o>P#o#p*g#p$g%Z$g;'S>P;'S;=`BZ<%lO>P",tokenizers:[tp,ep,2,3,4,5,6,7,8,9,10,11,12,13,Kf,new Zf("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOq~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!O~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(T~~",141,326),new Zf("j~RQYZXz{^~^O'q~~aP!P!Qd~iO'r~~",25,308)],topRules:{Script:[0,5],SingleExpression:[1,266],SingleClassItem:[2,267]},dialects:{jsx:12686,ts:12688},dynamicPrecedences:{76:1,78:1,163:1,191:1},specialized:[{term:312,get:t=>np[t]||-1},{term:328,get:t=>sp[t]||-1},{term:67,get:t=>rp[t]||-1}],tokenPrec:12712}),ap=[Iu("function ${name}(${params}) {\n\t${}\n}",{label:"function",detail:"definition",type:"keyword"}),Iu("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n\t${}\n}",{label:"for",detail:"loop",type:"keyword"}),Iu("for (let ${name} of ${collection}) {\n\t${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Iu("do {\n\t${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Iu("while (${}) {\n\t${}\n}",{label:"while",detail:"loop",type:"keyword"}),Iu("try {\n\t${}\n} catch (${error}) {\n\t${}\n}",{label:"try",detail:"/ catch block",type:"keyword"}),Iu("if (${}) {\n\t${}\n}",{label:"if",detail:"block",type:"keyword"}),Iu("if (${}) {\n\t${}\n} else {\n\t${}\n}",{label:"if",detail:"/ else block",type:"keyword"}),Iu("class ${name} {\n\tconstructor(${params}) {\n\t\t${}\n\t}\n}",{label:"class",detail:"definition",type:"keyword"}),Iu('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Iu('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],lp=new Yo,hp=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function cp(t){return(e,i)=>{let n=e.node.getChild("VariableDefinition");return n&&i(n,t),!0}}const dp=["FunctionDeclaration"],up={FunctionDeclaration:cp("function"),ClassDeclaration:cp("class"),ClassExpression:()=>!0,EnumDeclaration:cp("constant"),TypeAliasDeclaration:cp("type"),NamespaceDeclaration:cp("namespace"),VariableDefinition(t,e){t.matchContext(dp)||e(t,"variable")},TypeDefinition(t,e){e(t,"type")},__proto__:null};function fp(t,e){let i=lp.get(e);if(i)return i;let n=[],s=!0;function r(e,i){let s=t.sliceString(e.from,e.to);n.push({label:s,type:i})}return e.cursor(ko.IncludeAnonymous).iterate((e=>{if(s)s=!1;else if(e.name){let t=up[e.name];if(t&&t(e,r)||hp.has(e.name))return!1}else if(e.to-e.from>8192){for(let i of fp(t,e.node))n.push(i);return!1}})),lp.set(e,n),n}const pp=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,Op=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName"];function gp(t){let e=Ma(t.state).resolveInner(t.pos,-1);if(Op.indexOf(e.name)>-1)return null;let i="VariableName"==e.name||e.to-e.from<20&&pp.test(t.state.sliceDoc(e.from,e.to));if(!i&&!t.explicit)return null;let n=[];for(let i=e;i;i=i.parent)hp.has(i.name)&&(n=n.concat(fp(t.state.doc,i)));return{options:n,from:i?e.from:t.pos,validFor:pp}}const mp=Va.define({name:"javascript",parser:op.configure({props:[el.add({IfStatement:hl({except:/^\s*({|else\b)/}),TryStatement:hl({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:t=>t.baseIndent,SwitchBody:t=>{let e=t.textAfter,i=/^\s*\}/.test(e),n=/^\s*(case|default)\b/.test(e);return t.baseIndent+(i?0:n?1:2)*t.unit},Block:al({closing:"}"}),ArrowFunction:t=>t.baseIndent+t.unit,"TemplateString BlockComment":()=>null,"Statement Property":hl({except:/^{/}),JSXElement(t){let e=/^\s*<\//.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},JSXEscape(t){let e=/\s*\}/.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},"JSXOpenTag JSXSelfClosingTag":t=>t.column(t.node.from)+t.unit}),ul.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression":fl,BlockComment:t=>({from:t.from+2,to:t.to-2})})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),wp={test:t=>/^JSX/.test(t.name),facet:Aa({commentTokens:{block:{open:"{/*",close:"*/}"}}})},bp=mp.configure({dialect:"ts"},"typescript"),vp=mp.configure({dialect:"jsx",props:[Ta.add((t=>t.isTop?[wp]:void 0))]}),yp=mp.configure({dialect:"jsx ts",props:[Ta.add((t=>t.isTop?[wp]:void 0))]},"typescript"),Sp="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map((t=>({label:t,type:"keyword"})));function xp(t={}){let e=t.jsx?t.typescript?yp:vp:t.typescript?bp:mp;return new ja(e,[mp.data.of({autocomplete:(i=Op,n=Fd(ap.concat(Sp)),t=>{for(let e=Ma(t.state).resolveInner(t.pos,-1);e;e=e.parent){if(i.indexOf(e.name)>-1)return null;if(e.type.isTop)break}return n(t)})}),mp.data.of({autocomplete:gp}),t.jsx?$p:[]]);var i,n}function kp(t,e,i=t.length){for(let n=null==e?void 0:e.firstChild;n;n=n.nextSibling)if("JSXIdentifier"==n.name||"JSXBuiltin"==n.name||"JSXNamespacedName"==n.name||"JSXMemberExpression"==n.name)return t.sliceString(n.from,Math.min(n.to,i));return""}const Qp="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),$p=Ts.inputHandler.of(((t,e,i,n)=>{if((Qp?t.composing:t.compositionStarted)||t.state.readOnly||e!=i||">"!=n&&"/"!=n||!mp.isActiveAt(t.state,e,-1))return!1;let{state:s}=t,r=s.changeByRange((t=>{var e,i;let r,{head:o}=t,a=Ma(s).resolveInner(o,-1);if("JSXStartTag"==a.name&&(a=a.parent),">"==n&&"JSXFragmentTag"==a.name)return{range:A.cursor(o+1),changes:{from:o,insert:"></>"}};if("/"==n&&"JSXFragmentTag"==a.name){let t=a.parent,i=null==t?void 0:t.parent;if(t.from==o-1&&"JSXEndTag"!=(null===(e=i.lastChild)||void 0===e?void 0:e.name)&&(r=kp(s.doc,null==i?void 0:i.firstChild,o))){let t=`/${r}>`;return{range:A.cursor(o+t.length),changes:{from:o,insert:t}}}}else if(">"==n){let t=function(t){for(;;){if("JSXOpenTag"==t.name||"JSXSelfClosingTag"==t.name||"JSXFragmentTag"==t.name)return t;if(!t.parent)return null;t=t.parent}}(a);if(t&&"JSXEndTag"!=(null===(i=t.lastChild)||void 0===i?void 0:i.name)&&"</"!=s.sliceDoc(o,o+2)&&(r=kp(s.doc,t,o)))return{range:A.cursor(o+1),changes:{from:o,insert:`></${r}>`}}}return{range:t}}));return!r.changes.empty&&(t.dispatch(r,{userEvent:"input.type",scrollIntoView:!0}),!0)}));class Pp{constructor(t,e,i,n,s,r,o){this.type=t,this.value=e,this.from=i,this.hash=n,this.end=s,this.children=r,this.positions=o,this.hashProp=[[mo.contextHash,n]]}static create(t,e,i,n,s){return new Pp(t,e,i,n+(n<<8)+t+(e<<4)|0,s,[],[])}addChild(t,e){t.prop(mo.contextHash)!=this.hash&&(t=new Qo(t.type,t.children,t.positions,t.length,this.hashProp)),this.children.push(t),this.positions.push(e)}toTree(t,e=this.end){let i=this.children.length-1;return i>=0&&(e=Math.max(e,this.positions[i]+this.children[i].length+this.from)),new Qo(t.types[this.type],this.children,this.positions,e-this.from).balance({makeTree:(t,e,i)=>new Qo(vo.none,t,e,i,this.hashProp)})}}var Cp;!function(t){t[t.Document=1]="Document",t[t.CodeBlock=2]="CodeBlock",t[t.FencedCode=3]="FencedCode",t[t.Blockquote=4]="Blockquote",t[t.HorizontalRule=5]="HorizontalRule",t[t.BulletList=6]="BulletList",t[t.OrderedList=7]="OrderedList",t[t.ListItem=8]="ListItem",t[t.ATXHeading1=9]="ATXHeading1",t[t.ATXHeading2=10]="ATXHeading2",t[t.ATXHeading3=11]="ATXHeading3",t[t.ATXHeading4=12]="ATXHeading4",t[t.ATXHeading5=13]="ATXHeading5",t[t.ATXHeading6=14]="ATXHeading6",t[t.SetextHeading1=15]="SetextHeading1",t[t.SetextHeading2=16]="SetextHeading2",t[t.HTMLBlock=17]="HTMLBlock",t[t.LinkReference=18]="LinkReference",t[t.Paragraph=19]="Paragraph",t[t.CommentBlock=20]="CommentBlock",t[t.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",t[t.Escape=22]="Escape",t[t.Entity=23]="Entity",t[t.HardBreak=24]="HardBreak",t[t.Emphasis=25]="Emphasis",t[t.StrongEmphasis=26]="StrongEmphasis",t[t.Link=27]="Link",t[t.Image=28]="Image",t[t.InlineCode=29]="InlineCode",t[t.HTMLTag=30]="HTMLTag",t[t.Comment=31]="Comment",t[t.ProcessingInstruction=32]="ProcessingInstruction",t[t.URL=33]="URL",t[t.HeaderMark=34]="HeaderMark",t[t.QuoteMark=35]="QuoteMark",t[t.ListMark=36]="ListMark",t[t.LinkMark=37]="LinkMark",t[t.EmphasisMark=38]="EmphasisMark",t[t.CodeMark=39]="CodeMark",t[t.CodeText=40]="CodeText",t[t.CodeInfo=41]="CodeInfo",t[t.LinkTitle=42]="LinkTitle",t[t.LinkLabel=43]="LinkLabel"}(Cp||(Cp={}));class _p{constructor(t,e){this.start=t,this.content=e,this.marks=[],this.parsers=[]}}class Xp{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let t=this.skipSpace(this.basePos);this.indent=this.countIndent(t,this.pos,this.indent),this.pos=t,this.next=t==this.text.length?-1:this.text.charCodeAt(t)}skipSpace(t){return Rp(this.text,t)}reset(t){for(this.text=t,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(t){this.basePos=t,this.baseIndent=this.countIndent(t,this.pos,this.indent)}moveBaseColumn(t){this.baseIndent=t,this.basePos=this.findColumn(t)}addMarker(t){this.markers.push(t)}countIndent(t,e=0,i=0){for(let n=e;n<t;n++)i+=9==this.text.charCodeAt(n)?4-i%4:1;return i}findColumn(t){let e=0;for(let i=0;e<this.text.length&&i<t;e++)i+=9==this.text.charCodeAt(e)?4-i%4:1;return e}scrub(){if(!this.baseIndent)return this.text;let t="";for(let e=0;e<this.basePos;e++)t+=" ";return t+this.text.slice(this.basePos)}}function Zp(t,e,i){if(i.pos==i.text.length||t!=e.block&&i.indent>=e.stack[i.depth+1].value+i.baseIndent)return!0;if(i.indent>=i.baseIndent+4)return!1;let n=(t.type==Cp.OrderedList?Yp:Up)(i,e,!1);return n>0&&(t.type!=Cp.BulletList||Dp(i,e,!1)<0)&&i.text.charCodeAt(i.pos+n-1)==t.value}const Ap={[Cp.Blockquote]:(t,e,i)=>62==i.next&&(i.markers.push(OO(Cp.QuoteMark,e.lineStart+i.pos,e.lineStart+i.pos+1)),i.moveBase(i.pos+(Tp(i.text.charCodeAt(i.pos+1))?2:1)),t.end=e.lineStart+i.text.length,!0),[Cp.ListItem]:(t,e,i)=>!(i.indent<i.baseIndent+t.value&&i.next>-1)&&(i.moveBaseColumn(i.baseIndent+t.value),!0),[Cp.OrderedList]:Zp,[Cp.BulletList]:Zp,[Cp.Document]:()=>!0};function Tp(t){return 32==t||9==t||10==t||13==t}function Rp(t,e=0){for(;e<t.length&&Tp(t.charCodeAt(e));)e++;return e}function Ep(t,e,i){for(;e>i&&Tp(t.charCodeAt(e-1));)e--;return e}function Vp(t){if(96!=t.next&&126!=t.next)return-1;let e=t.pos+1;for(;e<t.text.length&&t.text.charCodeAt(e)==t.next;)e++;if(e<t.pos+3)return-1;if(96==t.next)for(let i=e;i<t.text.length;i++)if(96==t.text.charCodeAt(i))return-1;return e}function Mp(t){return 62!=t.next?-1:32==t.text.charCodeAt(t.pos+1)?2:1}function Dp(t,e,i){if(42!=t.next&&45!=t.next&&95!=t.next)return-1;let n=1;for(let e=t.pos+1;e<t.text.length;e++){let i=t.text.charCodeAt(e);if(i==t.next)n++;else if(!Tp(i))return-1}return i&&45==t.next&&Lp(t)>-1&&t.depth==e.stack.length||n<3?-1:1}function Wp(t,e){for(let i=t.stack.length-1;i>=0;i--)if(t.stack[i].type==e)return!0;return!1}function Up(t,e,i){return 45!=t.next&&43!=t.next&&42!=t.next||t.pos!=t.text.length-1&&!Tp(t.text.charCodeAt(t.pos+1))||!(!i||Wp(e,Cp.BulletList)||t.skipSpace(t.pos+2)<t.text.length)?-1:1}function Yp(t,e,i){let n=t.pos,s=t.next;for(;s>=48&&s<=57;){if(n++,n==t.text.length)return-1;s=t.text.charCodeAt(n)}return n==t.pos||n>t.pos+9||46!=s&&41!=s||n<t.text.length-1&&!Tp(t.text.charCodeAt(n+1))||i&&!Wp(e,Cp.OrderedList)&&(t.skipSpace(n+1)==t.text.length||n>t.pos+1||49!=t.next)?-1:n+1-t.pos}function qp(t){if(35!=t.next)return-1;let e=t.pos+1;for(;e<t.text.length&&35==t.text.charCodeAt(e);)e++;if(e<t.text.length&&32!=t.text.charCodeAt(e))return-1;let i=e-t.pos;return i>6?-1:i}function Lp(t){if(45!=t.next&&61!=t.next||t.indent>=t.baseIndent+4)return-1;let e=t.pos+1;for(;e<t.text.length&&t.text.charCodeAt(e)==t.next;)e++;let i=e;for(;e<t.text.length&&Tp(t.text.charCodeAt(e));)e++;return e==t.text.length?i:-1}const zp=/^[ \t]*$/,Ip=/-->/,Bp=/\?>/,jp=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,Ip],[/^\s*<\?/,Bp],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,zp],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,zp]];function Np(t,e,i){if(60!=t.next)return-1;let n=t.text.slice(t.pos);for(let t=0,e=jp.length-(i?1:0);t<e;t++)if(jp[t][0].test(n))return t;return-1}function Gp(t,e){let i=t.countIndent(e,t.pos,t.indent),n=t.countIndent(t.skipSpace(e),e,i);return n>=i+5?i+1:n}function Hp(t,e,i){let n=t.length-1;n>=0&&t[n].to==e&&t[n].type==Cp.CodeText?t[n].to=i:t.push(OO(Cp.CodeText,e,i))}const Fp={LinkReference:void 0,IndentedCode(t,e){let i=e.baseIndent+4;if(e.indent<i)return!1;let n=e.findColumn(i),s=t.lineStart+n,r=t.lineStart+e.text.length,o=[],a=[];for(Hp(o,s,r);t.nextLine()&&e.depth>=t.stack.length;)if(e.pos==e.text.length){Hp(a,t.lineStart-1,t.lineStart);for(let t of e.markers)a.push(t)}else{if(e.indent<i)break;{if(a.length){for(let t of a)t.type==Cp.CodeText?Hp(o,t.from,t.to):o.push(t);a=[]}Hp(o,t.lineStart-1,t.lineStart);for(let t of e.markers)o.push(t);r=t.lineStart+e.text.length;let i=t.lineStart+e.findColumn(e.baseIndent+4);i<r&&Hp(o,i,r)}}return a.length&&(a=a.filter((t=>t.type!=Cp.CodeText)),a.length&&(e.markers=a.concat(e.markers))),t.addNode(t.buffer.writeElements(o,-s).finish(Cp.CodeBlock,r-s),s),!0},FencedCode(t,e){let i=Vp(e);if(i<0)return!1;let n=t.lineStart+e.pos,s=e.next,r=i-e.pos,o=e.skipSpace(i),a=Ep(e.text,e.text.length,o),l=[OO(Cp.CodeMark,n,n+r)];o<a&&l.push(OO(Cp.CodeInfo,t.lineStart+o,t.lineStart+a));for(let i=!0;t.nextLine()&&e.depth>=t.stack.length;i=!1){let n=e.pos;if(e.indent-e.baseIndent<4)for(;n<e.text.length&&e.text.charCodeAt(n)==s;)n++;if(n-e.pos>=r&&e.skipSpace(n)==e.text.length){for(let t of e.markers)l.push(t);l.push(OO(Cp.CodeMark,t.lineStart+e.pos,t.lineStart+n)),t.nextLine();break}{i||Hp(l,t.lineStart-1,t.lineStart);for(let t of e.markers)l.push(t);let n=t.lineStart+e.basePos,s=t.lineStart+e.text.length;n<s&&Hp(l,n,s)}}return t.addNode(t.buffer.writeElements(l,-n).finish(Cp.FencedCode,t.prevLineEnd()-n),n),!0},Blockquote(t,e){let i=Mp(e);return!(i<0)&&(t.startContext(Cp.Blockquote,e.pos),t.addNode(Cp.QuoteMark,t.lineStart+e.pos,t.lineStart+e.pos+1),e.moveBase(e.pos+i),null)},HorizontalRule(t,e){if(Dp(e,t,!1)<0)return!1;let i=t.lineStart+e.pos;return t.nextLine(),t.addNode(Cp.HorizontalRule,i),!0},BulletList(t,e){let i=Up(e,t,!1);if(i<0)return!1;t.block.type!=Cp.BulletList&&t.startContext(Cp.BulletList,e.basePos,e.next);let n=Gp(e,e.pos+1);return t.startContext(Cp.ListItem,e.basePos,n-e.baseIndent),t.addNode(Cp.ListMark,t.lineStart+e.pos,t.lineStart+e.pos+i),e.moveBaseColumn(n),null},OrderedList(t,e){let i=Yp(e,t,!1);if(i<0)return!1;t.block.type!=Cp.OrderedList&&t.startContext(Cp.OrderedList,e.basePos,e.text.charCodeAt(e.pos+i-1));let n=Gp(e,e.pos+i);return t.startContext(Cp.ListItem,e.basePos,n-e.baseIndent),t.addNode(Cp.ListMark,t.lineStart+e.pos,t.lineStart+e.pos+i),e.moveBaseColumn(n),null},ATXHeading(t,e){let i=qp(e);if(i<0)return!1;let n=e.pos,s=t.lineStart+n,r=Ep(e.text,e.text.length,n),o=r;for(;o>n&&e.text.charCodeAt(o-1)==e.next;)o--;o!=r&&o!=n&&Tp(e.text.charCodeAt(o-1))||(o=e.text.length);let a=t.buffer.write(Cp.HeaderMark,0,i).writeElements(t.parser.parseInline(e.text.slice(n+i+1,o),s+i+1),-s);o<e.text.length&&a.write(Cp.HeaderMark,o-n,r-n);let l=a.finish(Cp.ATXHeading1-1+i,e.text.length-n);return t.nextLine(),t.addNode(l,s),!0},HTMLBlock(t,e){let i=Np(e,0,!1);if(i<0)return!1;let n=t.lineStart+e.pos,s=jp[i][1],r=[],o=s!=zp;for(;!s.test(e.text)&&t.nextLine();){if(e.depth<t.stack.length){o=!1;break}for(let t of e.markers)r.push(t)}o&&t.nextLine();let a=s==Ip?Cp.CommentBlock:s==Bp?Cp.ProcessingInstructionBlock:Cp.HTMLBlock,l=t.prevLineEnd();return t.addNode(t.buffer.writeElements(r,-n).finish(a,l-n),n),!0},SetextHeading:void 0};class Jp{constructor(t){this.stage=0,this.elts=[],this.pos=0,this.start=t.start,this.advance(t.content)}nextLine(t,e,i){if(-1==this.stage)return!1;let n=i.content+"\n"+e.scrub(),s=this.advance(n);return s>-1&&s<n.length&&this.complete(t,i,s)}finish(t,e){return(2==this.stage||3==this.stage)&&Rp(e.content,this.pos)==e.content.length&&this.complete(t,e,e.content.length)}complete(t,e,i){return t.addLeafElement(e,OO(Cp.LinkReference,this.start,this.start+i,this.elts)),!0}nextStage(t){return t?(this.pos=t.to-this.start,this.elts.push(t),this.stage++,!0):(!1===t&&(this.stage=-1),!1)}advance(t){for(;;){if(-1==this.stage)return-1;if(0==this.stage){if(!this.nextStage(PO(t,this.pos,this.start,!0)))return-1;if(58!=t.charCodeAt(this.pos))return this.stage=-1;this.elts.push(OO(Cp.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else{if(1!=this.stage){if(2==this.stage){let e=Rp(t,this.pos),i=0;if(e>this.pos){let n=$O(t,e,this.start);if(n){let e=Kp(t,n.to-this.start);e>0&&(this.nextStage(n),i=e)}}return i||(i=Kp(t,this.pos)),i>0&&i<t.length?i:-1}return Kp(t,this.pos)}if(!this.nextStage(QO(t,Rp(t,this.pos),this.start)))return-1}}}}function Kp(t,e){for(;e<t.length;e++){let i=t.charCodeAt(e);if(10==i)break;if(!Tp(i))return-1}return e}class tO{nextLine(t,e,i){let n=e.depth<t.stack.length?-1:Lp(e),s=e.next;if(n<0)return!1;let r=OO(Cp.HeaderMark,t.lineStart+e.pos,t.lineStart+n);return t.nextLine(),t.addLeafElement(i,OO(61==s?Cp.SetextHeading1:Cp.SetextHeading2,i.start,t.prevLineEnd(),[...t.parser.parseInline(i.content,i.start),r])),!0}finish(){return!1}}const eO={LinkReference:(t,e)=>91==e.content.charCodeAt(0)?new Jp(e):null,SetextHeading:()=>new tO},iO=[(t,e)=>qp(e)>=0,(t,e)=>Vp(e)>=0,(t,e)=>Mp(e)>=0,(t,e)=>Up(e,t,!0)>=0,(t,e)=>Yp(e,t,!0)>=0,(t,e)=>Dp(e,t,!0)>=0,(t,e)=>Np(e,0,!0)>=0],nO={text:"",end:0};class sO{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.line=new Xp,this.atEnd=!1,this.dontInject=new Set,this.stoppedAt=null,this.rangeI=0,this.to=n[n.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=n[0].from,this.block=Pp.create(Cp.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=i.length?new ZO(i,e):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(null!=this.stoppedAt&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:t}=this;for(;;){for(;t.depth<this.stack.length;)this.finishContext();for(let e of t.markers)this.addNode(e.type,e.from,e.to);if(t.pos<t.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(t.basePos))return null;t:for(;;){for(let e of this.parser.blockParsers)if(e){let i=e(this,t);if(0!=i){if(1==i)return null;t.forward();continue t}}break}let e=new _p(this.lineStart+t.pos,t.text.slice(t.pos));for(let t of this.parser.leafBlockParsers)if(t){let i=t(this,e);i&&e.parsers.push(i)}t:for(;this.nextLine()&&t.pos!=t.text.length;){if(t.indent<t.baseIndent+4)for(let i of this.parser.endLeafBlock)if(i(this,t,e))break t;for(let i of e.parsers)if(i.nextLine(this,t,e))return null;e.content+="\n"+t.scrub();for(let i of t.markers)e.marks.push(i)}return this.finishLeaf(e),null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}reuseFragment(t){if(!this.fragments.moveTo(this.absoluteLineStart+t,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let e=this.fragments.takeNodes(this);if(!e)return!1;let i=e,n=this.absoluteLineStart+e;for(let t=1;t<this.ranges.length;t++){let e=this.ranges[t-1].to,s=this.ranges[t].from;e>=this.lineStart&&s<n&&(i-=s-e)}return this.lineStart+=i,this.absoluteLineStart+=e,this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0}get depth(){return this.stack.length}parentType(t=this.depth-1){return this.parser.nodeSet.types[this.stack[t].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(t){let e=nO;if(e.end=t,t>=this.to)e.text="";else if(e.text=this.lineChunkAt(t),e.end+=e.text.length,this.ranges.length>1){let t=this.absoluteLineStart,i=this.rangeI;for(;this.ranges[i].to<e.end;){i++;let n=this.ranges[i].from,s=this.lineChunkAt(n);e.end=n+s.length,e.text=e.text.slice(0,this.ranges[i-1].to-t)+s,t=e.end-e.text.length}}return e}readLine(){let{line:t}=this,{text:e,end:i}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=i,t.reset(e);t.depth<this.stack.length;t.depth++){let e=this.stack[t.depth],i=this.parser.skipContextMarkup[e.type];if(!i)throw new Error("Unhandled block context "+Cp[e.type]);if(!i(e,this,t))break;t.forward()}}lineChunkAt(t){let e,i=this.input.chunk(t);if(this.input.lineChunks)e="\n"==i?"":i;else{let t=i.indexOf("\n");e=t<0?i:i.slice(0,t)}return t+e.length>this.to?e.slice(0,this.to-t):e}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(t,e,i=0){this.block=Pp.create(t,i,this.lineStart+e,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(t,e,i=0){this.startContext(this.parser.getNodeType(t),e,i)}addNode(t,e,i){"number"==typeof t&&(t=new Qo(this.parser.nodeSet.types[t],dO,dO,(null!=i?i:this.prevLineEnd())-e)),this.block.addChild(t,e-this.block.from)}addElement(t){this.block.addChild(t.toTree(this.parser.nodeSet),t.from-this.block.from)}addLeafElement(t,e){this.addNode(this.buffer.writeElements(_O(e.children,t.marks),-e.from).finish(e.type,e.to-e.from),e.from)}finishContext(){let t=this.stack.pop(),e=this.stack[this.stack.length-1];e.addChild(t.toTree(this.parser.nodeSet),t.from-e.from),this.block=e}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(t){return this.ranges.length>1?rO(this.ranges,0,t.topNode,this.ranges[0].from,this.dontInject):t}finishLeaf(t){for(let e of t.parsers)if(e.finish(this,t))return;let e=_O(this.parser.parseInline(t.content,t.start),t.marks);this.addNode(this.buffer.writeElements(e,-t.start).finish(Cp.Paragraph,t.content.length),t.start)}elt(t,e,i,n){return"string"==typeof t?OO(this.parser.getNodeType(t),e,i,n):new pO(t,e)}get buffer(){return new uO(this.parser.nodeSet)}}function rO(t,e,i,n,s){if(s.has(i.tree))return i.tree;let r=t[e].to,o=[],a=[],l=i.from+n;function h(i,s){for(;s?i>=r:i>r;){let s=t[e+1].from-r;n+=s,i+=s,e++,r=t[e].to}}for(let c=i.firstChild;c;c=c.nextSibling){h(c.from+n,!0);let i,d=c.from+n;c.to+n>r?(i=rO(t,e,c,n,s),h(c.to+n,!1)):i=c.toTree(),o.push(i),a.push(d-l)}return h(i.to+n,!1),new Qo(i.type,o,a,i.to+n-l,i.tree?i.tree.propValues:void 0)}class oO extends Lo{constructor(t,e,i,n,s,r,o,a,l){super(),this.nodeSet=t,this.blockParsers=e,this.leafBlockParsers=i,this.blockNames=n,this.endLeafBlock=s,this.skipContextMarkup=r,this.inlineParsers=o,this.inlineNames=a,this.wrappers=l,this.nodeTypes=Object.create(null);for(let e of t.types)this.nodeTypes[e.name]=e.id}createParse(t,e,i){let n=new sO(this,t,e,i);for(let s of this.wrappers)n=s(n,t,e,i);return n}configure(t){let e=lO(t);if(!e)return this;let{nodeSet:i,skipContextMarkup:n}=this,s=this.blockParsers.slice(),r=this.leafBlockParsers.slice(),o=this.blockNames.slice(),a=this.inlineParsers.slice(),l=this.inlineNames.slice(),h=this.endLeafBlock.slice(),c=this.wrappers;if(aO(e.defineNodes)){n=Object.assign({},n);let t,s=i.types.slice();for(let i of e.defineNodes){let{name:e,block:r,composite:o,style:a}="string"==typeof i?{name:i}:i;if(s.some((t=>t.name==e)))continue;o&&(n[s.length]=(t,e,i)=>o(e,i,t.value));let l=s.length,h=o?["Block","BlockContext"]:r?l>=Cp.ATXHeading1&&l<=Cp.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;s.push(vo.define({id:l,name:e,props:h&&[[mo.group,h]]})),a&&(t||(t={}),Array.isArray(a)||a instanceof ra?t[e]=a:Object.assign(t,a))}i=new yo(s),t&&(i=i.extend(la(t)))}if(aO(e.props)&&(i=i.extend(...e.props)),aO(e.remove))for(let t of e.remove){let e=this.blockNames.indexOf(t),i=this.inlineNames.indexOf(t);e>-1&&(s[e]=r[e]=void 0),i>-1&&(a[i]=void 0)}if(aO(e.parseBlock))for(let t of e.parseBlock){let e=o.indexOf(t.name);if(e>-1)s[e]=t.parse,r[e]=t.leaf;else{let e=t.before?hO(o,t.before):t.after?hO(o,t.after)+1:o.length-1;s.splice(e,0,t.parse),r.splice(e,0,t.leaf),o.splice(e,0,t.name)}t.endLeaf&&h.push(t.endLeaf)}if(aO(e.parseInline))for(let t of e.parseInline){let e=l.indexOf(t.name);if(e>-1)a[e]=t.parse;else{let e=t.before?hO(l,t.before):t.after?hO(l,t.after)+1:l.length-1;a.splice(e,0,t.parse),l.splice(e,0,t.name)}}return e.wrap&&(c=c.concat(e.wrap)),new oO(i,s,r,o,h,n,a,l,c)}getNodeType(t){let e=this.nodeTypes[t];if(null==e)throw new RangeError(`Unknown node type '${t}'`);return e}parseInline(t,e){let i=new CO(this,t,e);t:for(let t=e;t<i.end;){let e=i.char(t);for(let n of this.inlineParsers)if(n){let s=n(i,e,t);if(s>=0){t=s;continue t}}t++}return i.resolveMarkers(0)}}function aO(t){return null!=t&&t.length>0}function lO(t){if(!Array.isArray(t))return t;if(0==t.length)return null;let e=lO(t[0]);if(1==t.length)return e;let i=lO(t.slice(1));if(!i||!e)return e||i;let n=(t,e)=>(t||dO).concat(e||dO),s=e.wrap,r=i.wrap;return{props:n(e.props,i.props),defineNodes:n(e.defineNodes,i.defineNodes),parseBlock:n(e.parseBlock,i.parseBlock),parseInline:n(e.parseInline,i.parseInline),remove:n(e.remove,i.remove),wrap:s?r?(t,e,i,n)=>s(r(t,e,i,n),e,i,n):s:r}}function hO(t,e){let i=t.indexOf(e);if(i<0)throw new RangeError(`Position specified relative to unknown parser ${e}`);return i}let cO=[vo.none];for(let t,e=1;t=Cp[e];e++)cO[e]=vo.define({id:e,name:t,props:e>=Cp.Escape?[]:[[mo.group,e in Ap?["Block","BlockContext"]:["Block","LeafBlock"]]]});const dO=[];class uO{constructor(t){this.nodeSet=t,this.content=[],this.nodes=[]}write(t,e,i,n=0){return this.content.push(t,e,i,4+4*n),this}writeElements(t,e=0){for(let i of t)i.writeTo(this,e);return this}finish(t,e){return Qo.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:t,length:e})}}let fO=class{constructor(t,e,i,n=dO){this.type=t,this.from=e,this.to=i,this.children=n}writeTo(t,e){let i=t.content.length;t.writeElements(this.children,e),t.content.push(this.type,this.from+e,this.to+e,t.content.length+4-i)}toTree(t){return new uO(t).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}};class pO{constructor(t,e){this.tree=t,this.from=e}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return dO}writeTo(t,e){t.nodes.push(this.tree),t.content.push(t.nodes.length-1,this.from+e,this.to+e,-1)}toTree(){return this.tree}}function OO(t,e,i,n){return new fO(t,e,i,n)}const gO={resolve:"Emphasis",mark:"EmphasisMark"},mO={resolve:"Emphasis",mark:"EmphasisMark"},wO={},bO={};class vO{constructor(t,e,i,n){this.type=t,this.from=e,this.to=i,this.side=n}}const yO="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let SO=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{SO=new RegExp("[\\p{Pc}|\\p{Pd}|\\p{Pe}|\\p{Pf}|\\p{Pi}|\\p{Po}|\\p{Ps}]","u")}catch(t){}const xO={Escape(t,e,i){if(92!=e||i==t.end-1)return-1;let n=t.char(i+1);for(let e=0;e<32;e++)if(yO.charCodeAt(e)==n)return t.append(OO(Cp.Escape,i,i+2));return-1},Entity(t,e,i){if(38!=e)return-1;let n=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(t.slice(i+1,i+31));return n?t.append(OO(Cp.Entity,i,i+1+n[0].length)):-1},InlineCode(t,e,i){if(96!=e||i&&96==t.char(i-1))return-1;let n=i+1;for(;n<t.end&&96==t.char(n);)n++;let s=n-i,r=0;for(;n<t.end;n++)if(96==t.char(n)){if(r++,r==s&&96!=t.char(n+1))return t.append(OO(Cp.InlineCode,i,n+1,[OO(Cp.CodeMark,i,i+s),OO(Cp.CodeMark,n+1-s,n+1)]))}else r=0;return-1},HTMLTag(t,e,i){if(60!=e||i==t.end-1)return-1;let n=t.slice(i+1,t.end),s=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(n);if(s)return t.append(OO(Cp.URL,i,i+1+s[0].length));let r=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(n);if(r)return t.append(OO(Cp.Comment,i,i+1+r[0].length));let o=/^\?[^]*?\?>/.exec(n);if(o)return t.append(OO(Cp.ProcessingInstruction,i,i+1+o[0].length));let a=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(n);return a?t.append(OO(Cp.HTMLTag,i,i+1+a[0].length)):-1},Emphasis(t,e,i){if(95!=e&&42!=e)return-1;let n=i+1;for(;t.char(n)==e;)n++;let s=t.slice(i-1,i),r=t.slice(n,n+1),o=SO.test(s),a=SO.test(r),l=/\s|^$/.test(s),h=/\s|^$/.test(r),c=!h&&(!a||l||o),d=!l&&(!o||h||a),u=c&&(42==e||!d||o),f=d&&(42==e||!c||a);return t.append(new vO(95==e?gO:mO,i,n,(u?1:0)|(f?2:0)))},HardBreak(t,e,i){if(92==e&&10==t.char(i+1))return t.append(OO(Cp.HardBreak,i,i+2));if(32==e){let e=i+1;for(;32==t.char(e);)e++;if(10==t.char(e)&&e>=i+2)return t.append(OO(Cp.HardBreak,i,e+1))}return-1},Link:(t,e,i)=>91==e?t.append(new vO(wO,i,i+1,1)):-1,Image:(t,e,i)=>33==e&&91==t.char(i+1)?t.append(new vO(bO,i,i+2,1)):-1,LinkEnd(t,e,i){if(93!=e)return-1;for(let e=t.parts.length-1;e>=0;e--){let n=t.parts[e];if(n instanceof vO&&(n.type==wO||n.type==bO)){if(!n.side||t.skipSpace(n.to)==i&&!/[(\[]/.test(t.slice(i+1,i+2)))return t.parts[e]=null,-1;let s=t.takeContent(e),r=t.parts[e]=kO(t,s,n.type==wO?Cp.Link:Cp.Image,n.from,i+1);if(n.type==wO)for(let i=0;i<e;i++){let e=t.parts[i];e instanceof vO&&e.type==wO&&(e.side=0)}return r.to}}return-1}};function kO(t,e,i,n,s){let{text:r}=t,o=t.char(s),a=s;if(e.unshift(OO(Cp.LinkMark,n,n+(i==Cp.Image?2:1))),e.push(OO(Cp.LinkMark,s-1,s)),40==o){let i,n=t.skipSpace(s+1),o=QO(r,n-t.offset,t.offset);o&&(n=t.skipSpace(o.to),i=$O(r,n-t.offset,t.offset),i&&(n=t.skipSpace(i.to))),41==t.char(n)&&(e.push(OO(Cp.LinkMark,s,s+1)),a=n+1,o&&e.push(o),i&&e.push(i),e.push(OO(Cp.LinkMark,n,a)))}else if(91==o){let i=PO(r,s-t.offset,t.offset,!1);i&&(e.push(i),a=i.to)}return OO(i,n,a,e)}function QO(t,e,i){if(60==t.charCodeAt(e)){for(let n=e+1;n<t.length;n++){let s=t.charCodeAt(n);if(62==s)return OO(Cp.URL,e+i,n+1+i);if(60==s||10==s)return!1}return null}{let n=0,s=e;for(let e=!1;s<t.length;s++){let i=t.charCodeAt(s);if(Tp(i))break;if(e)e=!1;else if(40==i)n++;else if(41==i){if(!n)break;n--}else 92==i&&(e=!0)}return s>e?OO(Cp.URL,e+i,s+i):s==t.length&&null}}function $O(t,e,i){let n=t.charCodeAt(e);if(39!=n&&34!=n&&40!=n)return!1;let s=40==n?41:n;for(let n=e+1,r=!1;n<t.length;n++){let o=t.charCodeAt(n);if(r)r=!1;else{if(o==s)return OO(Cp.LinkTitle,e+i,n+1+i);92==o&&(r=!0)}}return null}function PO(t,e,i,n){for(let s=!1,r=e+1,o=Math.min(t.length,r+999);r<o;r++){let o=t.charCodeAt(r);if(s)s=!1;else{if(93==o)return!n&&OO(Cp.LinkLabel,e+i,r+1+i);if(n&&!Tp(o)&&(n=!1),91==o)return!1;92==o&&(s=!0)}}return null}class CO{constructor(t,e,i){this.parser=t,this.text=e,this.offset=i,this.parts=[]}char(t){return t>=this.end?-1:this.text.charCodeAt(t-this.offset)}get end(){return this.offset+this.text.length}slice(t,e){return this.text.slice(t-this.offset,e-this.offset)}append(t){return this.parts.push(t),t.to}addDelimiter(t,e,i,n,s){return this.append(new vO(t,e,i,(n?1:0)|(s?2:0)))}addElement(t){return this.append(t)}resolveMarkers(t){for(let e=t;e<this.parts.length;e++){let i=this.parts[e];if(!(i instanceof vO&&i.type.resolve&&2&i.side))continue;let n,s=i.type==gO||i.type==mO,r=i.to-i.from,o=e-1;for(;o>=t;o--){let t=this.parts[o];if(t instanceof vO&&1&t.side&&t.type==i.type&&!(s&&(1&i.side||2&t.side)&&(t.to-t.from+r)%3==0&&((t.to-t.from)%3||r%3))){n=t;break}}if(!n)continue;let a=i.type.resolve,l=[],h=n.from,c=i.to;if(s){let t=Math.min(2,n.to-n.from,r);h=n.to-t,c=i.from+t,a=1==t?"Emphasis":"StrongEmphasis"}n.type.mark&&l.push(this.elt(n.type.mark,h,n.to));for(let t=o+1;t<e;t++)this.parts[t]instanceof fO&&l.push(this.parts[t]),this.parts[t]=null;i.type.mark&&l.push(this.elt(i.type.mark,i.from,c));let d=this.elt(a,h,c,l);this.parts[o]=s&&n.from!=h?new vO(n.type,n.from,h,n.side):null,(this.parts[e]=s&&i.to!=c?new vO(i.type,c,i.to,i.side):null)?this.parts.splice(e,0,d):this.parts[e]=d}let e=[];for(let i=t;i<this.parts.length;i++){let t=this.parts[i];t instanceof fO&&e.push(t)}return e}findOpeningDelimiter(t){for(let e=this.parts.length-1;e>=0;e--){let i=this.parts[e];if(i instanceof vO&&i.type==t)return e}return null}takeContent(t){let e=this.resolveMarkers(t);return this.parts.length=t,e}skipSpace(t){return Rp(this.text,t-this.offset)+this.offset}elt(t,e,i,n){return"string"==typeof t?OO(this.parser.getNodeType(t),e,i,n):new pO(t,e)}}function _O(t,e){if(!e.length)return t;if(!t.length)return e;let i=t.slice(),n=0;for(let t of e){for(;n<i.length&&i[n].to<t.to;)n++;if(n<i.length&&i[n].from<t.from){let e=i[n];e instanceof fO&&(i[n]=new fO(e.type,e.from,e.to,_O(e.children,[t])))}else i.splice(n++,0,t)}return i}const XO=[Cp.CodeBlock,Cp.ListItem,Cp.OrderedList,Cp.BulletList];class ZO{constructor(t,e){this.fragments=t,this.input=e,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,t.length&&(this.fragment=t[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(t,e){for(;this.fragment&&this.fragment.to<=t;)this.nextFragment();if(!this.fragment||this.fragment.from>(t?t-1:0))return!1;if(this.fragmentEnd<0){let t=this.fragment.to;for(;t>0&&"\n"!=this.input.read(t-1,t);)t--;this.fragmentEnd=t?t-1:0}let i=this.cursor;i||(i=this.cursor=this.fragment.tree.cursor(),i.firstChild());let n=t+this.fragment.offset;for(;i.to<=n;)if(!i.parent())return!1;for(;;){if(i.from>=n)return this.fragment.from<=e;if(!i.childAfter(n))return!1}}matches(t){let e=this.cursor.tree;return e&&e.prop(mo.contextHash)==t}takeNodes(t){let e=this.cursor,i=this.fragment.offset,n=this.fragmentEnd-(this.fragment.openEnd?1:0),s=t.absoluteLineStart,r=s,o=t.block.children.length,a=r,l=o;for(;;){if(e.to-i>n){if(e.type.isAnonymous&&e.firstChild())continue;break}if(t.dontInject.add(e.tree),t.addNode(e.tree,e.from-i),e.type.is("Block")&&(XO.indexOf(e.type.id)<0?(r=e.to-i,o=t.block.children.length):(r=a,o=l,a=e.to-i,l=t.block.children.length)),!e.nextSibling())break}for(;t.block.children.length>o;)t.block.children.pop(),t.block.positions.pop();return r-s}}const AO=la({"Blockquote/...":_a.quote,HorizontalRule:_a.contentSeparator,"ATXHeading1/... SetextHeading1/...":_a.heading1,"ATXHeading2/... SetextHeading2/...":_a.heading2,"ATXHeading3/...":_a.heading3,"ATXHeading4/...":_a.heading4,"ATXHeading5/...":_a.heading5,"ATXHeading6/...":_a.heading6,"Comment CommentBlock":_a.comment,Escape:_a.escape,Entity:_a.character,"Emphasis/...":_a.emphasis,"StrongEmphasis/...":_a.strong,"Link/... Image/...":_a.link,"OrderedList/... BulletList/...":_a.list,"BlockQuote/...":_a.quote,"InlineCode CodeText":_a.monospace,URL:_a.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":_a.processingInstruction,"CodeInfo LinkLabel":_a.labelName,LinkTitle:_a.string,Paragraph:_a.content}),TO=new oO(new yo(cO).extend(AO),Object.keys(Fp).map((t=>Fp[t])),Object.keys(Fp).map((t=>eO[t])),Object.keys(Fp),iO,Ap,Object.keys(xO).map((t=>xO[t])),Object.keys(xO),[]);function RO(t,e,i){let n=[];for(let s=t.firstChild,r=e;;s=s.nextSibling){let t=s?s.from:i;if(t>r&&n.push({from:r,to:t}),!s)break;r=s.to}return n}const EO={resolve:"Strikethrough",mark:"StrikethroughMark"},VO={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":_a.strikethrough}},{name:"StrikethroughMark",style:_a.processingInstruction}],parseInline:[{name:"Strikethrough",parse(t,e,i){if(126!=e||126!=t.char(i+1)||126==t.char(i+2))return-1;let n=t.slice(i-1,i),s=t.slice(i+2,i+3),r=/\s|^$/.test(n),o=/\s|^$/.test(s),a=SO.test(n),l=SO.test(s);return t.addDelimiter(EO,i,i+2,!o&&(!l||r||a),!r&&(!a||o||l))},after:"Emphasis"}]};function MO(t,e,i=0,n,s=0){let r=0,o=!0,a=-1,l=-1,h=!1,c=()=>{n.push(t.elt("TableCell",s+a,s+l,t.parser.parseInline(e.slice(a,l),s+a)))};for(let d=i;d<e.length;d++){let i=e.charCodeAt(d);124!=i||h?(h||32!=i&&9!=i)&&(a<0&&(a=d),l=d+1):((!o||a>-1)&&r++,o=!1,n&&(a>-1&&c(),n.push(t.elt("TableDelimiter",d+s,d+s+1))),a=l=-1),h=!h&&92==i}return a>-1&&(r++,n&&c()),r}function DO(t,e){for(let i=e;i<t.length;i++){let e=t.charCodeAt(i);if(124==e)return!0;92==e&&i++}return!1}const WO=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class UO{constructor(){this.rows=null}nextLine(t,e,i){if(null==this.rows){let n;if(this.rows=!1,(45==e.next||58==e.next||124==e.next)&&WO.test(n=e.text.slice(e.pos))){let s=[];MO(t,i.content,0,s,i.start)==MO(t,n,e.pos)&&(this.rows=[t.elt("TableHeader",i.start,i.start+i.content.length,s),t.elt("TableDelimiter",t.lineStart+e.pos,t.lineStart+e.text.length)])}}else if(this.rows){let i=[];MO(t,e.text,e.pos,i,t.lineStart),this.rows.push(t.elt("TableRow",t.lineStart+e.pos,t.lineStart+e.text.length,i))}return!1}finish(t,e){return!!this.rows&&(t.addLeafElement(e,t.elt("Table",e.start,e.start+e.content.length,this.rows)),!0)}}const YO={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":_a.heading}},"TableRow",{name:"TableCell",style:_a.content},{name:"TableDelimiter",style:_a.processingInstruction}],parseBlock:[{name:"Table",leaf:(t,e)=>DO(e.content,0)?new UO:null,endLeaf(t,e,i){if(i.parsers.some((t=>t instanceof UO))||!DO(e.text,e.basePos))return!1;let n=t.scanLine(t.absoluteLineEnd+1).text;return WO.test(n)&&MO(t,e.text,e.basePos)==MO(t,n,e.basePos)},before:"SetextHeading"}]};class qO{nextLine(){return!1}finish(t,e){return t.addLeafElement(e,t.elt("Task",e.start,e.start+e.content.length,[t.elt("TaskMarker",e.start,e.start+3),...t.parser.parseInline(e.content.slice(3),e.start+3)])),!0}}const LO=[YO,{defineNodes:[{name:"Task",block:!0,style:_a.list},{name:"TaskMarker",style:_a.atom}],parseBlock:[{name:"TaskList",leaf:(t,e)=>/^\[[ xX]\]/.test(e.content)&&"ListItem"==t.parentType().name?new qO:null,after:"SetextHeading"}]},VO];function zO(t,e,i){return(n,s,r)=>{if(s!=t||n.char(r+1)==t)return-1;let o=[n.elt(i,r,r+1)];for(let s=r+1;s<n.end;s++){let a=n.char(s);if(a==t)return n.addElement(n.elt(e,r,s+1,o.concat(n.elt(i,s,s+1))));if(92==a&&o.push(n.elt("Escape",s,2+s++)),Tp(a))break}return-1}}const IO={defineNodes:[{name:"Superscript",style:_a.special(_a.content)},{name:"SuperscriptMark",style:_a.processingInstruction}],parseInline:[{name:"Superscript",parse:zO(94,"Superscript","SuperscriptMark")}]},BO={defineNodes:[{name:"Subscript",style:_a.special(_a.content)},{name:"SubscriptMark",style:_a.processingInstruction}],parseInline:[{name:"Subscript",parse:zO(126,"Subscript","SubscriptMark")}]},jO={defineNodes:[{name:"Emoji",style:_a.character}],parseInline:[{name:"Emoji",parse(t,e,i){let n;return 58==e&&(n=/^[a-zA-Z_0-9]+:/.exec(t.slice(i+1,t.end)))?t.addElement(t.elt("Emoji",i,i+1+n[0].length)):-1}}]},NO=20,GO=22,HO=23,FO=24,JO=26,KO=27,tg=28,eg=31,ig=34,ng=37,sg={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},rg={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},og={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function ag(t){return 9==t||10==t||13==t||32==t}let lg=null,hg=null,cg=0;function dg(t,e){let i=t.pos+e;if(cg==i&&hg==t)return lg;let n=t.peek(e);for(;ag(n);)n=t.peek(++e);let s="";for(;45==(r=n)||46==r||58==r||r>=65&&r<=90||95==r||r>=97&&r<=122||r>=161;)s+=String.fromCharCode(n),n=t.peek(++e);var r;return hg=t,cg=i,lg=s?s.toLowerCase():n==ug||n==fg?void 0:null}const ug=63,fg=33;function pg(t,e){this.name=t,this.parent=e,this.hash=e?e.hash:0;for(let e=0;e<t.length;e++)this.hash+=(this.hash<<4)+t.charCodeAt(e)+(t.charCodeAt(e)<<8)}const Og=[6,10,7,8,9],gg=new jf({start:null,shift:(t,e,i,n)=>Og.indexOf(e)>-1?new pg(dg(n,1)||"",t):t,reduce:(t,e)=>e==NO&&t?t.parent:t,reuse(t,e,i,n){let s=e.type.id;return 6==s||36==s?new pg(dg(n,1)||"",t):t},hash:t=>t?t.hash:0,strict:!1}),mg=new Af(((t,e)=>{if(60!=t.next)return void(t.next<0&&e.context&&t.acceptToken(57));t.advance();let i=47==t.next;i&&t.advance();let n=dg(t,0);if(void 0===n)return;if(!n)return t.acceptToken(i?14:6);let s=e.context?e.context.name:null;if(i){if(n==s)return t.acceptToken(11);if(s&&rg[s])return t.acceptToken(57,-2);if(e.dialectEnabled(0))return t.acceptToken(12);for(let t=e.context;t;t=t.parent)if(t.name==n)return;t.acceptToken(13)}else{if("script"==n)return t.acceptToken(7);if("style"==n)return t.acceptToken(8);if("textarea"==n)return t.acceptToken(9);if(sg.hasOwnProperty(n))return t.acceptToken(10);s&&og[s]&&og[s][n]?t.acceptToken(57,-1):t.acceptToken(6)}}),{contextual:!0}),wg=new Af((t=>{for(let e=0,i=0;;i++){if(t.next<0){i&&t.acceptToken(58);break}if(45==t.next)e++;else{if(62==t.next&&e>=2){i>3&&t.acceptToken(58,-2);break}e=0}t.advance()}}));const bg=new Af(((t,e)=>{if(47==t.next&&62==t.peek(1)){let i=e.dialectEnabled(1)||function(t){for(;t;t=t.parent)if("svg"==t.name||"math"==t.name)return!0;return!1}(e.context);t.acceptToken(i?5:4,2)}else 62==t.next&&t.acceptToken(4,1)}));function vg(t,e,i){let n=2+t.length;return new Af((s=>{for(let r=0,o=0,a=0;;a++){if(s.next<0){a&&s.acceptToken(e);break}if(0==r&&60==s.next||1==r&&47==s.next||r>=2&&r<n&&s.next==t.charCodeAt(r-2))r++,o++;else if(2!=r&&r!=n||!ag(s.next)){if(r==n&&62==s.next){a>o?s.acceptToken(e,-o):s.acceptToken(i,-(o-2));break}if((10==s.next||13==s.next)&&a){s.acceptToken(e,1);break}r=o=0}else o++;s.advance()}}))}const yg=vg("script",54,1),Sg=vg("style",55,2),xg=vg("textarea",56,3),kg=la({"Text RawText":_a.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":_a.angleBracket,TagName:_a.tagName,"MismatchedCloseTag/TagName":[_a.tagName,_a.invalid],AttributeName:_a.attributeName,"AttributeValue UnquotedAttributeValue":_a.attributeValue,Is:_a.definitionOperator,"EntityReference CharacterReference":_a.character,Comment:_a.blockComment,ProcessingInst:_a.processingInstruction,DoctypeDecl:_a.documentMeta}),Qg=Nf.deserialize({version:14,states:",xOVO!rOOO!WQ#tO'#CqO!]Q#tO'#CzO!bQ#tO'#C}O!gQ#tO'#DQO!lQ#tO'#DSO!qOaO'#CpO!|ObO'#CpO#XOdO'#CpO$eO!rO'#CpOOO`'#Cp'#CpO$lO$fO'#DTO$tQ#tO'#DVO$yQ#tO'#DWOOO`'#Dk'#DkOOO`'#DY'#DYQVO!rOOO%OQ&rO,59]O%WQ&rO,59fO%`Q&rO,59iO%hQ&rO,59lO%sQ&rO,59nOOOa'#D^'#D^O%{OaO'#CxO&WOaO,59[OOOb'#D_'#D_O&`ObO'#C{O&kObO,59[OOOd'#D`'#D`O&sOdO'#DOO'OOdO,59[OOO`'#Da'#DaO'WO!rO,59[O'_Q#tO'#DROOO`,59[,59[OOOp'#Db'#DbO'dO$fO,59oOOO`,59o,59oO'lQ#|O,59qO'qQ#|O,59rOOO`-E7W-E7WO'vQ&rO'#CsOOQW'#DZ'#DZO(UQ&rO1G.wOOOa1G.w1G.wO(^Q&rO1G/QOOOb1G/Q1G/QO(fQ&rO1G/TOOOd1G/T1G/TO(nQ&rO1G/WOOO`1G/W1G/WOOO`1G/Y1G/YO(yQ&rO1G/YOOOa-E7[-E7[O)RQ#tO'#CyOOO`1G.v1G.vOOOb-E7]-E7]O)WQ#tO'#C|OOOd-E7^-E7^O)]Q#tO'#DPOOO`-E7_-E7_O)bQ#|O,59mOOOp-E7`-E7`OOO`1G/Z1G/ZOOO`1G/]1G/]OOO`1G/^1G/^O)gQ,UO,59_OOQW-E7X-E7XOOOa7+$c7+$cOOOb7+$l7+$lOOOd7+$o7+$oOOO`7+$r7+$rOOO`7+$t7+$tO)rQ#|O,59eO)wQ#|O,59hO)|Q#|O,59kOOO`1G/X1G/XO*RO7[O'#CvO*dOMhO'#CvOOQW1G.y1G.yOOO`1G/P1G/POOO`1G/S1G/SOOO`1G/V1G/VOOOO'#D['#D[O*uO7[O,59bOOQW,59b,59bOOOO'#D]'#D]O+WOMhO,59bOOOO-E7Y-E7YOOQW1G.|1G.|OOOO-E7Z-E7Z",stateData:"+s~O!^OS~OUSOVPOWQOXROYTO[]O][O^^O`^Oa^Ob^Oc^Ox^O{_O!dZO~OfaO~OfbO~OfcO~OfdO~OfeO~O!WfOPlP!ZlP~O!XiOQoP!ZoP~O!YlORrP!ZrP~OUSOVPOWQOXROYTOZqO[]O][O^^O`^Oa^Ob^Oc^Ox^O!dZO~O!ZrO~P#dO![sO!euO~OfvO~OfwO~OS|OhyO~OS!OOhyO~OS!QOhyO~OS!SOT!TOhyO~OS!TOhyO~O!WfOPlX!ZlX~OP!WO!Z!XO~O!XiOQoX!ZoX~OQ!ZO!Z!XO~O!YlORrX!ZrX~OR!]O!Z!XO~O!Z!XO~P#dOf!_O~O![sO!e!aO~OS!bO~OS!cO~Oi!dOSgXhgXTgX~OS!fOhyO~OS!gOhyO~OS!hOhyO~OS!iOT!jOhyO~OS!jOhyO~Of!kO~Of!lO~Of!mO~OS!nO~Ok!qO!`!oO!b!pO~OS!rO~OS!sO~OS!tO~Oa!uOb!uOc!uO!`!wO!a!uO~Oa!xOb!xOc!xO!b!wO!c!xO~Oa!uOb!uOc!uO!`!{O!a!uO~Oa!xOb!xOc!xO!b!{O!c!xO~OT~bac!dx{!d~",goto:"%p!`PPPPPPPPPPPPPPPPPPPP!a!gP!mPP!yP!|#P#S#Y#]#`#f#i#l#r#x!aP!a!aP$O$U$l$r$x%O%U%[%bPPPPPPPP%hX^OX`pXUOX`pezabcde{}!P!R!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ}bQ!PcQ!RdQ!UeZ!e{}!P!R!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:"⚠ StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:67,context:gg,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,21,30,33,36,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,29,32,35,37,"OpenTag"],["group",-9,14,17,18,19,20,39,40,41,42,"Entity",16,"Entity TextContent",-3,28,31,34,"TextContent Entity"]],propSources:[kg],skippedNodes:[0],repeatNodeCount:9,tokenData:"#%g!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs4ysv-_vw5iwxJ^x}-_}!OKP!O!P-_!P!Q$q!Q![-_![!]!!O!]!^-_!^!_!&W!_!`#$o!`!a&X!a!c-_!c!}!!O!}#R-_#R#S!!O#S#T3V#T#o!!O#o#s-_#s$f$q$f%W-_%W%o!!O%o%p-_%p&a!!O&a&b-_&b1p!!O1p4U-_4U4d!!O4d4e-_4e$IS!!O$IS$I`-_$I`$Ib!!O$Ib$Kh-_$Kh%#t!!O%#t&/x-_&/x&Et!!O&Et&FV-_&FV;'S!!O;'S;:j!&Q;:j;=`4s<%l?&r-_?&r?Ah!!O?Ah?BY$q?BY?Mn!!O?MnO$q!Z$|c`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bX`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UV`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pT`POv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!cpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({W`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!a`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!a`!cpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYkWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]``P!a`!cp!^^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_1n!_!a&X!a#S-_#S#T3V#T#s-_#s$f$q$f;'S-_;'S;=`4s<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/echSkWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!^!_0p!a#S/^#S#T0p#T#s/^#s$f+P$f;'S/^;'S;=`1h<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0uXhSqr0psw0px!P0p!Q!_0p!a#s0p$f;'S0p;'S;=`1b<%l?Ah0p?BY?Mn0pS1eP;=`<%l0p[1kP;=`<%l/^!U1wbhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!U3SP;=`<%l1n!V3bchS`P!a`!cpOq&Xqr3Vrs&}sv3Vvw0pwx(tx!P3V!P!Q&X!Q!^3V!^!_1n!_!a&X!a#s3V#s$f&X$f;'S3V;'S;=`4m<%l?Ah3V?Ah?BY&X?BY?Mn3V?MnO&X!V4pP;=`<%l3V!_4vP;=`<%l-_!Z5SV!`h`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_5rjhSkWc!ROX7dXZ8qZ[7d[^8q^p7dqr:crs8qst@Ttw:cwx8qx!P:c!P!Q7d!Q!]:c!]!^/^!^!_=p!_!a8q!a#S:c#S#T=p#T#s:c#s$f7d$f;'S:c;'S;=`?}<%l?Ah:c?Ah?BY7d?BY?Mn:c?MnO7d!Z7ibkWOX7dXZ8qZ[7d[^8q^p7dqr7drs8qst+Ptw7dwx8qx!]7d!]!^9f!^!a8q!a#S7d#S#T8q#T;'S7d;'S;=`:]<%lO7d!R8tVOp8qqs8qt!]8q!]!^9Z!^;'S8q;'S;=`9`<%lO8q!R9`Oa!R!R9cP;=`<%l8q!Z9mYkWa!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z:`P;=`<%l7d!_:jjhSkWOX7dXZ8qZ[7d[^8q^p7dqr:crs8qst/^tw:cwx8qx!P:c!P!Q7d!Q!]:c!]!^<[!^!_=p!_!a8q!a#S:c#S#T=p#T#s:c#s$f7d$f;'S:c;'S;=`?}<%l?Ah:c?Ah?BY7d?BY?Mn:c?MnO7d!_<echSkWa!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!^!_0p!a#S/^#S#T0p#T#s/^#s$f+P$f;'S/^;'S;=`1h<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V=udhSOp8qqr=prs8qst0ptw=pwx8qx!P=p!P!Q8q!Q!]=p!]!^?T!^!_=p!_!a8q!a#s=p#s$f8q$f;'S=p;'S;=`?w<%l?Ah=p?Ah?BY8q?BY?Mn=p?MnO8q!V?[XhSa!Rqr0psw0px!P0p!Q!_0p!a#s0p$f;'S0p;'S;=`1b<%l?Ah0p?BY?Mn0p!V?zP;=`<%l=p!_@QP;=`<%l:c!_@[ihSkWOXAyXZCTZ[Ay[^CT^pAyqrDrrsCTswDrwxCTx!PDr!P!QAy!Q!]Dr!]!^/^!^!_G|!_!aCT!a#SDr#S#TG|#T#sDr#s$fAy$f;'SDr;'S;=`JW<%l?AhDr?Ah?BYAy?BY?MnDr?MnOAy!ZBOakWOXAyXZCTZ[Ay[^CT^pAyqrAyrsCTswAywxCTx!]Ay!]!^Cu!^!aCT!a#SAy#S#TCT#T;'SAy;'S;=`Dl<%lOAy!RCWUOpCTq!]CT!]!^Cj!^;'SCT;'S;=`Co<%lOCT!RCoOb!R!RCrP;=`<%lCT!ZC|YkWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZDoP;=`<%lAy!_DyihSkWOXAyXZCTZ[Ay[^CT^pAyqrDrrsCTswDrwxCTx!PDr!P!QAy!Q!]Dr!]!^Fh!^!_G|!_!aCT!a#SDr#S#TG|#T#sDr#s$fAy$f;'SDr;'S;=`JW<%l?AhDr?Ah?BYAy?BY?MnDr?MnOAy!_FqchSkWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!^!_0p!a#S/^#S#T0p#T#s/^#s$f+P$f;'S/^;'S;=`1h<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VHRchSOpCTqrG|rsCTswG|wxCTx!PG|!P!QCT!Q!]G|!]!^I^!^!_G|!_!aCT!a#sG|#s$fCT$f;'SG|;'S;=`JQ<%l?AhG|?Ah?BYCT?BY?MnG|?MnOCT!VIeXhSb!Rqr0psw0px!P0p!Q!_0p!a#s0p$f;'S0p;'S;=`1b<%l?Ah0p?BY?Mn0p!VJTP;=`<%lG|!_JZP;=`<%lDr!ZJgW!bx`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aK^lhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMU!O!P-_!P!Q$q!Q!^-_!^!_1n!_!a&X!a#S-_#S#T3V#T#s-_#s$f$q$f;'S-_;'S;=`4s<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aMckhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_1n!_!`&X!`!a! W!a#S-_#S#T3V#T#s-_#s$f$q$f;'S-_;'S;=`4s<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!T! cX`P!a`!cp!eQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!a!!_!ZhSfQ`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!O!!O!O!P!!O!P!Q$q!Q![!!O![!]!!O!]!^-_!^!_1n!_!a&X!a!c-_!c!}!!O!}#R-_#R#S!!O#S#T3V#T#o!!O#o#s-_#s$f$q$f$}-_$}%O!!O%O%W-_%W%o!!O%o%p-_%p&a!!O&a&b-_&b1p!!O1p4U!!O4U4d!!O4d4e-_4e$IS!!O$IS$I`-_$I`$Ib!!O$Ib$Je-_$Je$Jg!!O$Jg$Kh-_$Kh%#t!!O%#t&/x-_&/x&Et!!O&Et&FV-_&FV;'S!!O;'S;:j!&Q;:j;=`4s<%l?&r-_?&r?Ah!!O?Ah?BY$q?BY?Mn!!O?MnO$q!a!&TP;=`<%l!!O!V!&achS!a`!cpOq*Vqr!'lrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!b!Ey!b#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!'uhhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex}1n}!O!)a!O!P1n!P!Q*V!Q!_1n!_!a*V!a!f1n!f!g!,]!g#W1n#W#X!<y#X#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!)jdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex}1n}!O!*x!O!P1n!P!Q*V!Q!_1n!_!a*V!a#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!+TbhS!a`!cp!dPOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!,fdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!q1n!q!r!-t!r#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!-}dhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!e1n!e!f!/]!f#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!/fdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!v1n!v!w!0t!w#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!0}dhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!{1n!{!|!2]!|#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!2fdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!r1n!r!s!3t!s#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!3}dhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a!g1n!g!h!5]!h#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!5fchS!a`!cpOq!6qqr!5]rs!7hsv!5]vw!;`wx!9[x!P!5]!P!Q!6q!Q!_!5]!_!`!6q!`!a!:j!a#s!5]#s$f!6q$f;'S!5];'S;=`!<s<%l?Ah!5]?Ah?BY!6q?BY?Mn!5]?MnO!6q!R!6xY!a`!cpOr!6qrs!7hsv!6qvw!8Swx!9[x!`!6q!`!a!:j!a;'S!6q;'S;=`!;Y<%lO!6qq!7mV!cpOv!7hvx!8Sx!`!7h!`!a!8q!a;'S!7h;'S;=`!9U<%lO!7hP!8VTO!`!8S!`!a!8f!a;'S!8S;'S;=`!8k<%lO!8SP!8kO{PP!8nP;=`<%l!8Sq!8xS!cp{POv(Vx;'S(V;'S;=`(h<%lO(Vq!9XP;=`<%l!7ha!9aX!a`Or!9[rs!8Ssv!9[vw!8Sw!`!9[!`!a!9|!a;'S!9[;'S;=`!:d<%lO!9[a!:TT!a`{POr)esv)ew;'S)e;'S;=`)y<%lO)ea!:gP;=`<%l!9[!R!:sV!a`!cp{POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;]P;=`<%l!6qT!;ebhSOq!8Sqr!;`rs!8Ssw!;`wx!8Sx!P!;`!P!Q!8S!Q!_!;`!_!`!8S!`!a!8f!a#s!;`#s$f!8S$f;'S!;`;'S;=`!<m<%l?Ah!;`?Ah?BY!8S?BY?Mn!;`?MnO!8ST!<pP;=`<%l!;`!V!<vP;=`<%l!5]!V!=SdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#c1n#c#d!>b#d#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!>kdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#V1n#V#W!?y#W#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!@SdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#h1n#h#i!Ab#i#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!AkdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#m1n#m#n!By#n#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!CSdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#d1n#d#e!Db#e#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!DkdhS!a`!cpOq*Vqr1nrs(Vsv1nvw0pwx)ex!P1n!P!Q*V!Q!_1n!_!a*V!a#X1n#X#Y!5]#Y#s1n#s$f*V$f;'S1n;'S;=`3P<%l?Ah1n?Ah?BY*V?BY?Mn1n?MnO*V!V!FSchS!a`!cpOq!G_qr!Eyrs!HUsv!Eyvw!Ncwx!Jvx!P!Ey!P!Q!G_!Q!_!Ey!_!a!G_!a!b##T!b#s!Ey#s$f!G_$f;'S!Ey;'S;=`#$i<%l?Ah!Ey?Ah?BY!G_?BY?Mn!Ey?MnO!G_!R!GfY!a`!cpOr!G_rs!HUsv!G_vw!Hpwx!Jvx!a!G_!a!b!Lv!b;'S!G_;'S;=`!N]<%lO!G_q!HZV!cpOv!HUvx!Hpx!a!HU!a!b!Iq!b;'S!HU;'S;=`!Jp<%lO!HUP!HsTO!a!Hp!a!b!IS!b;'S!Hp;'S;=`!Ik<%lO!HpP!IVTO!`!Hp!`!a!If!a;'S!Hp;'S;=`!Ik<%lO!HpP!IkOxPP!InP;=`<%l!Hpq!IvV!cpOv!HUvx!Hpx!`!HU!`!a!J]!a;'S!HU;'S;=`!Jp<%lO!HUq!JdS!cpxPOv(Vx;'S(V;'S;=`(h<%lO(Vq!JsP;=`<%l!HUa!J{X!a`Or!Jvrs!Hpsv!Jvvw!Hpw!a!Jv!a!b!Kh!b;'S!Jv;'S;=`!Lp<%lO!Jva!KmX!a`Or!Jvrs!Hpsv!Jvvw!Hpw!`!Jv!`!a!LY!a;'S!Jv;'S;=`!Lp<%lO!Jva!LaT!a`xPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!LsP;=`<%l!Jv!R!L}Y!a`!cpOr!G_rs!HUsv!G_vw!Hpwx!Jvx!`!G_!`!a!Mm!a;'S!G_;'S;=`!N]<%lO!G_!R!MvV!a`!cpxPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!N`P;=`<%l!G_T!NhbhSOq!Hpqr!Ncrs!Hpsw!Ncwx!Hpx!P!Nc!P!Q!Hp!Q!_!Nc!_!a!Hp!a!b# p!b#s!Nc#s$f!Hp$f;'S!Nc;'S;=`#!}<%l?Ah!Nc?Ah?BY!Hp?BY?Mn!Nc?MnO!HpT# ubhSOq!Hpqr!Ncrs!Hpsw!Ncwx!Hpx!P!Nc!P!Q!Hp!Q!_!Nc!_!`!Hp!`!a!If!a#s!Nc#s$f!Hp$f;'S!Nc;'S;=`#!}<%l?Ah!Nc?Ah?BY!Hp?BY?Mn!Nc?MnO!HpT##QP;=`<%l!Nc!V##^chS!a`!cpOq!G_qr!Eyrs!HUsv!Eyvw!Ncwx!Jvx!P!Ey!P!Q!G_!Q!_!Ey!_!`!G_!`!a!Mm!a#s!Ey#s$f!G_$f;'S!Ey;'S;=`#$i<%l?Ah!Ey?Ah?BY!G_?BY?Mn!Ey?MnO!G_!V#$lP;=`<%l!Ey!V#$zXiS`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[yg,Sg,xg,bg,mg,wg,0,1,2,3,4,5],topRules:{Document:[0,15]},dialects:{noMatch:0,selfClosing:485},tokenPrec:487});function $g(t,e){let i=Object.create(null);for(let n of t.getChildren(HO)){let t=n.getChild(FO),s=n.getChild(JO)||n.getChild(KO);t&&(i[e.read(t.from,t.to)]=s?s.type.id==JO?e.read(s.from+1,s.to-1):e.read(s.from,s.to):"")}return i}function Pg(t,e){let i=t.getChild(GO);return i?e.read(i.from,i.to):" "}function Cg(t,e,i){let n;for(let s of i)if(!s.attrs||s.attrs(n||(n=$g(t.node.parent.firstChild,e))))return{parser:s.parser};return null}function _g(t=[],e=[]){let i=[],n=[],s=[],r=[];for(let e of t){("script"==e.tag?i:"style"==e.tag?n:"textarea"==e.tag?s:r).push(e)}let o=e.length?Object.create(null):null;for(let t of e)(o[t.name]||(o[t.name]=[])).push(t);return Io(((t,e)=>{let a=t.type.id;if(a==tg)return Cg(t,e,i);if(a==eg)return Cg(t,e,n);if(a==ig)return Cg(t,e,s);if(a==NO&&r.length){let i,n=t.node,s=n.firstChild,o=s&&Pg(s,e);if(o)for(let t of r)if(t.tag==o&&(!t.attrs||t.attrs(i||(i=$g(n,e))))){let e=n.lastChild;return{parser:t.parser,overlay:[{from:s.to,to:e.type.id==ng?e.from:n.to}]}}}if(o&&a==HO){let i,n=t.node;if(i=n.firstChild){let t=o[e.read(i.from,i.to)];if(t)for(let i of t){if(i.tagName&&i.tagName!=Pg(n.parent,e))continue;let t=n.lastChild;if(t.type.id==JO){let e=t.from+1,n=t.lastChild,s=t.to-(n&&n.isError?0:1);if(s>e)return{parser:i.parser,overlay:[{from:e,to:s}]}}else if(t.type.id==KO)return{parser:i.parser,overlay:[{from:t.from,to:t.to}]}}}}return null}))}const Xg=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288];function Zg(t){return t>=65&&t<=90||t>=97&&t<=122||t>=161}const Ag=new Af(((t,e)=>{for(let n=!1,s=0,r=0;;r++){let{next:o}=t;if(!(Zg(o)||45==o||95==o||n&&(i=o,i>=48&&i<=57))){n&&t.acceptToken(40==o?95:2==s&&e.canShift(2)?2:96);break}!n&&(45!=o||r>0)&&(n=!0),s===r&&45==o&&s++,t.advance()}var i})),Tg=new Af((t=>{if(Xg.includes(t.peek(-1))){let{next:e}=t;(Zg(e)||95==e||35==e||46==e||91==e||58==e||45==e)&&t.acceptToken(94)}})),Rg=new Af((t=>{if(!Xg.includes(t.peek(-1))){let{next:e}=t;if(37==e&&(t.advance(),t.acceptToken(1)),Zg(e)){do{t.advance()}while(Zg(t.next));t.acceptToken(1)}}})),Eg=la({"AtKeyword import charset namespace keyframes media supports":_a.definitionKeyword,"from to selector":_a.keyword,NamespaceName:_a.namespace,KeyframeName:_a.labelName,TagName:_a.tagName,ClassName:_a.className,PseudoClassName:_a.constant(_a.className),IdName:_a.labelName,"FeatureName PropertyName":_a.propertyName,AttributeName:_a.attributeName,NumberLiteral:_a.number,KeywordQuery:_a.keyword,UnaryQueryOp:_a.operatorKeyword,"CallTag ValueName":_a.atom,VariableName:_a.variableName,Callee:_a.operatorKeyword,Unit:_a.unit,"UniversalSelector NestingSelector":_a.definitionOperator,MatchOp:_a.compareOperator,"ChildOp SiblingOp, LogicOp":_a.logicOperator,BinOp:_a.arithmeticOperator,Important:_a.modifier,Comment:_a.blockComment,ParenthesizedContent:_a.special(_a.name),ColorLiteral:_a.color,StringLiteral:_a.string,":":_a.punctuation,"PseudoOp #":_a.derefOperator,"; ,":_a.separator,"( )":_a.paren,"[ ]":_a.squareBracket,"{ }":_a.brace}),Vg={__proto__:null,lang:32,"nth-child":32,"nth-last-child":32,"nth-of-type":32,"nth-last-of-type":32,dir:32,"host-context":32,url:60,"url-prefix":60,domain:60,regexp:60,selector:134},Mg={__proto__:null,"@import":114,"@media":138,"@charset":142,"@namespace":146,"@keyframes":152,"@supports":164},Dg={__proto__:null,not:128,only:128,from:158,to:160},Wg=Nf.deserialize({version:14,states:"7WQYQ[OOO#_Q[OOOOQP'#Cd'#CdOOQP'#Cc'#CcO#fQ[O'#CfO$YQXO'#CaO$aQ[O'#ChO$lQ[O'#DPO$qQ[O'#DTOOQP'#Ed'#EdO$vQdO'#DeO%bQ[O'#DrO$vQdO'#DtO%sQ[O'#DvO&OQ[O'#DyO&TQ[O'#EPO&cQ[O'#EROOQS'#Ec'#EcOOQS'#ET'#ETQYQ[OOO&jQXO'#CdO'_QWO'#DaO'dQWO'#EjO'oQ[O'#EjQOQWOOOOQP'#Cg'#CgOOQP,59Q,59QO#fQ[O,59QO'yQ[O'#EWO(eQWO,58{O(mQ[O,59SO$lQ[O,59kO$qQ[O,59oO'yQ[O,59sO'yQ[O,59uO'yQ[O,59vO(xQ[O'#D`OOQS,58{,58{OOQP'#Ck'#CkOOQO'#C}'#C}OOQP,59S,59SO)PQWO,59SO)UQWO,59SOOQP'#DR'#DROOQP,59k,59kOOQO'#DV'#DVO)ZQ`O,59oOOQS'#Cp'#CpO$vQdO'#CqO)cQvO'#CsO*pQtO,5:POOQO'#Cx'#CxO)UQWO'#CwO+UQWO'#CyOOQS'#Eg'#EgOOQO'#Dh'#DhO+ZQ[O'#DoO+iQWO'#EkO&TQ[O'#DmO+wQWO'#DpOOQO'#El'#ElO(hQWO,5:^O+|QpO,5:`OOQS'#Dx'#DxO,UQWO,5:bO,ZQ[O,5:bOOQO'#D{'#D{O,cQWO,5:eO,hQWO,5:kO,pQWO,5:mOOQS-E8R-E8RO$vQdO,59{O,xQ[O'#EYO-VQWO,5;UO-VQWO,5;UOOQP1G.l1G.lO-|QXO,5:rOOQO-E8U-E8UOOQS1G.g1G.gOOQP1G.n1G.nO)PQWO1G.nO)UQWO1G.nOOQP1G/V1G/VO.ZQ`O1G/ZO.tQXO1G/_O/[QXO1G/aO/rQXO1G/bO0YQWO,59zO0_Q[O'#DOO0fQdO'#CoOOQP1G/Z1G/ZO$vQdO1G/ZO0mQpO,59]OOQS,59_,59_O$vQdO,59aO0uQWO1G/kOOQS,59c,59cO0zQ!bO,59eO1SQWO'#DhO1_QWO,5:TO1dQWO,5:ZO&TQ[O,5:VO&TQ[O'#EZO1lQWO,5;VO1wQWO,5:XO'yQ[O,5:[OOQS1G/x1G/xOOQS1G/z1G/zOOQS1G/|1G/|O2YQWO1G/|O2_QdO'#D|OOQS1G0P1G0POOQS1G0V1G0VOOQS1G0X1G0XO2mQtO1G/gOOQO,5:t,5:tO3TQ[O,5:tOOQO-E8W-E8WO3bQWO1G0pOOQP7+$Y7+$YOOQP7+$u7+$uO$vQdO7+$uOOQS1G/f1G/fO3mQXO'#EiO3tQWO,59jO3yQtO'#EUO4nQdO'#EfO4xQWO,59ZO4}QpO7+$uOOQS1G.w1G.wOOQS1G.{1G.{OOQS7+%V7+%VO5VQWO1G/PO$vQdO1G/oOOQO1G/u1G/uOOQO1G/q1G/qO5[QWO,5:uOOQO-E8X-E8XO5jQXO1G/vOOQS7+%h7+%hO5qQYO'#CsO(hQWO'#E[O5yQdO,5:hOOQS,5:h,5:hO6XQtO'#EXO$vQdO'#EXO7VQdO7+%ROOQO7+%R7+%ROOQO1G0`1G0`O7jQpO<<HaO7rQWO,5;TOOQP1G/U1G/UOOQS-E8S-E8SO$vQdO'#EVO7zQWO,5;QOOQT1G.u1G.uOOQP<<Ha<<HaOOQS7+$k7+$kO8SQdO7+%ZOOQO7+%b7+%bOOQS,5:v,5:vOOQS-E8Y-E8YOOQS1G0S1G0SO8ZQtO,5:sOOQS-E8V-E8VOOQO<<Hm<<HmOOQPAN={AN={O9XQdO,5:qOOQO-E8T-E8TOOQO<<Hu<<Hu",stateData:"9i~O#UOSROS~OUXOXXO]UO^UOtVOxWO!Y`O!ZYO!gZO!i[O!k]O!n^O!t_O#SQO#XSO~OQeOUXOXXO]UO^UOtVOxWO!Y`O!ZYO!gZO!i[O!k]O!n^O!t_O#SdO#XSO~O#P#^P~P!ZO#SiO~O]nO^nOplOtoOxpO|qO!PsO#QrO#XkO~O!RtO~P#kO`zO#RwO#SvO~O#S{O~O#S}O~OQ!WOb!QOf!WOh!WOn!VO#R!TO#S!PO#[!RO~Ob!YO!b![O!e!]O#S!XO!R#_P~Oh!bOn!VO#S!aO~O#S!dO~Ob!YO!b![O!e!]O#S!XO~O!W#_P~P%bO]WX]!UX^WXpWXtWXxWX|WX!PWX!RWX#QWX#XWX~O]!iO~O!W!jO#P#^X!Q#^X~O#P#^X!Q#^X~P!ZOUXOXXO]UO^UOtVOxWO#SQO#XSO~OplO!RtO~O`!sO#RwO#SvO~O!Q#^P~P!ZOb!zO~Ob!{O~Ov!|Oz!}O~OP#PObgXjgX!WgX!bgX!egX#SgXagXQgXfgXhgXngXpgX!VgX#PgX#RgX#[gXvgX!QgX~Ob!YOj#QO!b![O!e!]O#S!XO!W#_P~Ob#TO~Ob!YO!b![O!e!]O#S#UO~Op#YO!`#XO!R#_X!W#_X~Ob#]O~Oj#QO!W#_O~O!W#`O~Oh#aOn!VO~O!R#bO~O!RtO!`#XO~O!RtO!W#eO~O!W!|X#P!|X!Q!|X~P!ZO!W!jO#P#^a!Q#^a~O]nO^nOtoOxpO|qO!PsO#QrO#XkO~Op!za!R!zaa!za~P-bOv#lOz#mO~O]nO^nOtoOxpO#XkO~Op{i|{i!P{i!R{i#Q{ia{i~P.cOp}i|}i!P}i!R}i#Q}ia}i~P.cOp!Oi|!Oi!P!Oi!R!Oi#Q!Oia!Oi~P.cO!Q#nO~Oa#]P~P'yOa#YP~P$vOa#uOj#QO~O!W#wO~Oh#xOo#xO~O]!^Xa![X!`![X~O]#yO~Oa#zO!`#XO~Op#YO!R#_a!W#_a~O!`#XOp!aa!R!aa!W!aaa!aa~O!W$PO~O!Q$TO!q$RO!r$RO#[$QO~Oj#QOp$VO!V$XO!W!Ti#P!Ti!Q!Ti~P$vO!W!|a#P!|a!Q!|a~P!ZO!W!jO#P#^i!Q#^i~Oa#]X~P#kOa$]O~Oj#QOQ!xXa!xXb!xXf!xXh!xXn!xXp!xX#R!xX#S!xX#[!xX~Op$_Oa#YX~P$vOa$aO~Oj#QOv$bO~Oa$cO~O!`#XOp!}a!R!}a!W!}a~Oa$eO~P-bOP#PO!RgX~O!Q$hO!q$RO!r$RO#[$QO~Oj#QOQ!{Xb!{Xf!{Xh!{Xn!{Xp!{X!V!{X!W!{X#P!{X#R!{X#S!{X#[!{X!Q!{X~Op$VO!V$kO!W!Tq#P!Tq!Q!Tq~P$vOj#QOv$lO~OplOa#]a~Op$_Oa#Ya~Oa$oO~P$vOj#QOQ!{ab!{af!{ah!{an!{ap!{a!V!{a!W!{a#P!{a#R!{a#S!{a#[!{a!Q!{a~Oa!yap!ya~P$vOo#[j!Pj~",goto:",`#aPPPPP#bP#k#zP#k$Z#kPP$aPPP$g$p$pP%SP$pP$p%j%|PPP&f&l#kP&rP#kP&xP#kP#k#kPPP'O'b'oPP#bPP'v'v(Q'vP'vP'v'vP#bP#bP#bP(T#bP(W(ZPP#bP#bP(^(m({)R)])c)m)sPPPPPP)y*SP*o*rP+h+k+q+z_aOPcgt!j#hkXOPcglqrst!j!z#]#hkROPcglqrst!j!z#]#hQjSR!mkQxUR!qnQ!qzQ#S!UR#k!sq!WY[!Q!i!{!}#Q#f#m#r#y$V$W$_$d$mp!WY[!Q!i!{!}#Q#f#m#r#y$V$W$_$d$mT$R#b$Sq!UY[!Q!i!{!}#Q#f#m#r#y$V$W$_$d$mp!WY[!Q!i!{!}#Q#f#m#r#y$V$W$_$d$mQ!b]R#a!cQyUR!rnQ!qyR#k!rQ|VR!toQ!OWR!upQuTQ!pmQ#^!_Q#d!fQ#e!gR$f$RSfPtQ!lgQ#g!jR$Y#hZePgt!j#ha!^Z_`!S!Y![#X#YR#V!YR!c]R!e^R#c!eQcOSgPtU!hcg#hR#h!jQ#r!{U$^#r$d$mQ$d#yR$m$_Q$`#rR$n$`QmTS!om$[R$[#oQ$W#fR$j$WQ!kfS#i!k#jR#j!lQ#Z!ZR#}#ZQ$S#bR$g$S_bOPcgt!j#h^TOPcgt!j#hQ!nlQ!vqQ!wrQ!xsQ#o!zR$O#]R#s!{Q!SYQ!`[Q#O!QQ#f!i[#q!{#r#y$_$d$mQ#t!}Q#v#QS$U#f$WQ$Z#mR$i$VR#p!zQhPR!ytQ!_ZQ!g`R#R!SU!ZZ`!SQ!f_Q#W!YQ#[![Q#{#XR#|#Y",nodeNames:"⚠ Unit VariableName Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent , PseudoClassName ArgList IdSelector # IdName ] AttributeSelector [ AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp } { Block Declaration PropertyName Important ; ImportStatement AtKeyword import KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList from to SupportsStatement supports AtRule Styles",maxTerm:108,nodeProps:[["openedBy",17,"(",48,"{"],["closedBy",18,")",49,"}"]],propSources:[Eg],skippedNodes:[0,3],repeatNodeCount:8,tokenData:"Lq~R!^OX$}X^%u^p$}pq%uqr)Xrs.Rst/utu6duv$}vw7^wx7oxy9^yz9oz{9t{|:_|}?Q}!O?c!O!P@Q!P!Q@i!Q![Cu![!]Dp!]!^El!^!_$}!_!`E}!`!aF`!a!b$}!b!cG[!c!}$}!}#OHt#O#P$}#P#QIV#Q#R6d#R#T$}#T#UIh#U#c$}#c#dJy#d#o$}#o#pK`#p#q6d#q#rKq#r#sLS#s#y$}#y#z%u#z$f$}$f$g%u$g#BY$}#BY#BZ%u#BZ$IS$}$IS$I_%u$I_$I|$}$I|$JO%u$JO$JT$}$JT$JU%u$JU$KV$}$KV$KW%u$KW&FU$}&FU&FV%u&FV;'S$};'S;=`Lk<%lO$}W%QSOy%^z;'S%^;'S;=`%o<%lO%^W%cSoWOy%^z;'S%^;'S;=`%o<%lO%^W%rP;=`<%l%^~%zh#U~OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^~'mh#U~oWOX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^^)[UOy%^z#]%^#]#^)n#^;'S%^;'S;=`%o<%lO%^^)sUoWOy%^z#a%^#a#b*V#b;'S%^;'S;=`%o<%lO%^^*[UoWOy%^z#d%^#d#e*n#e;'S%^;'S;=`%o<%lO%^^*sUoWOy%^z#c%^#c#d+V#d;'S%^;'S;=`%o<%lO%^^+[UoWOy%^z#f%^#f#g+n#g;'S%^;'S;=`%o<%lO%^^+sUoWOy%^z#h%^#h#i,V#i;'S%^;'S;=`%o<%lO%^^,[UoWOy%^z#T%^#T#U,n#U;'S%^;'S;=`%o<%lO%^^,sUoWOy%^z#b%^#b#c-V#c;'S%^;'S;=`%o<%lO%^^-[UoWOy%^z#h%^#h#i-n#i;'S%^;'S;=`%o<%lO%^^-uS!VUoWOy%^z;'S%^;'S;=`%o<%lO%^~.UWOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o<%lO.R~.sOh~~.vRO;'S.R;'S;=`/P;=`O.R~/SXOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o;=`<%l.R<%lO.R~/rP;=`<%l.R_/zYtPOy%^z!Q%^!Q![0j![!c%^!c!i0j!i#T%^#T#Z0j#Z;'S%^;'S;=`%o<%lO%^^0oYoWOy%^z!Q%^!Q![1_![!c%^!c!i1_!i#T%^#T#Z1_#Z;'S%^;'S;=`%o<%lO%^^1dYoWOy%^z!Q%^!Q![2S![!c%^!c!i2S!i#T%^#T#Z2S#Z;'S%^;'S;=`%o<%lO%^^2ZYfUoWOy%^z!Q%^!Q![2y![!c%^!c!i2y!i#T%^#T#Z2y#Z;'S%^;'S;=`%o<%lO%^^3QYfUoWOy%^z!Q%^!Q![3p![!c%^!c!i3p!i#T%^#T#Z3p#Z;'S%^;'S;=`%o<%lO%^^3uYoWOy%^z!Q%^!Q![4e![!c%^!c!i4e!i#T%^#T#Z4e#Z;'S%^;'S;=`%o<%lO%^^4lYfUoWOy%^z!Q%^!Q![5[![!c%^!c!i5[!i#T%^#T#Z5[#Z;'S%^;'S;=`%o<%lO%^^5aYoWOy%^z!Q%^!Q![6P![!c%^!c!i6P!i#T%^#T#Z6P#Z;'S%^;'S;=`%o<%lO%^^6WSfUoWOy%^z;'S%^;'S;=`%o<%lO%^Y6gUOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^Y7QSzQoWOy%^z;'S%^;'S;=`%o<%lO%^X7cSXPOy%^z;'S%^;'S;=`%o<%lO%^~7rWOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W<%lO7o~8_RO;'S7o;'S;=`8h;=`O7o~8kXOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W;=`<%l7o<%lO7o~9ZP;=`<%l7o_9cSbVOy%^z;'S%^;'S;=`%o<%lO%^~9tOa~_9{UUPjSOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^_:fWjS!PPOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^^;TUoWOy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^^;nYoW#[UOy%^z!Q%^!Q![;g![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^^<cYoWOy%^z{%^{|=R|}%^}!O=R!O!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^^=WUoWOy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^^=qUoW#[UOy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^^>[[oW#[UOy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^_?VSpVOy%^z;'S%^;'S;=`%o<%lO%^^?hWjSOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^_@VU#XPOy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^~@nTjSOy%^z{@}{;'S%^;'S;=`%o<%lO%^~ASUoWOy@}yzAfz{Bm{;'S@};'S;=`Co<%lO@}~AiTOzAfz{Ax{;'SAf;'S;=`Bg<%lOAf~A{VOzAfz{Ax{!PAf!P!QBb!Q;'SAf;'S;=`Bg<%lOAf~BgOR~~BjP;=`<%lAf~BrWoWOy@}yzAfz{Bm{!P@}!P!QC[!Q;'S@};'S;=`Co<%lO@}~CcSoWR~Oy%^z;'S%^;'S;=`%o<%lO%^~CrP;=`<%l@}^Cz[#[UOy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^XDuU]POy%^z![%^![!]EX!];'S%^;'S;=`%o<%lO%^XE`S^PoWOy%^z;'S%^;'S;=`%o<%lO%^_EqS!WVOy%^z;'S%^;'S;=`%o<%lO%^YFSSzQOy%^z;'S%^;'S;=`%o<%lO%^XFeU|POy%^z!`%^!`!aFw!a;'S%^;'S;=`%o<%lO%^XGOS|PoWOy%^z;'S%^;'S;=`%o<%lO%^XG_WOy%^z!c%^!c!}Gw!}#T%^#T#oGw#o;'S%^;'S;=`%o<%lO%^XHO[!YPoWOy%^z}%^}!OGw!O!Q%^!Q![Gw![!c%^!c!}Gw!}#T%^#T#oGw#o;'S%^;'S;=`%o<%lO%^XHySxPOy%^z;'S%^;'S;=`%o<%lO%^^I[SvUOy%^z;'S%^;'S;=`%o<%lO%^XIkUOy%^z#b%^#b#cI}#c;'S%^;'S;=`%o<%lO%^XJSUoWOy%^z#W%^#W#XJf#X;'S%^;'S;=`%o<%lO%^XJmS!`PoWOy%^z;'S%^;'S;=`%o<%lO%^XJ|UOy%^z#f%^#f#gJf#g;'S%^;'S;=`%o<%lO%^XKeS!RPOy%^z;'S%^;'S;=`%o<%lO%^_KvS!QVOy%^z;'S%^;'S;=`%o<%lO%^ZLXU!PPOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^WLnP;=`<%l$}",tokenizers:[Tg,Rg,Ag,0,1,2,3],topRules:{StyleSheet:[0,4],Styles:[1,84]},specialized:[{term:95,get:t=>Vg[t]||-1},{term:56,get:t=>Mg[t]||-1},{term:96,get:t=>Dg[t]||-1}],tokenPrec:1123});let Ug=null;function Yg(){if(!Ug&&"object"==typeof document&&document.body){let{style:t}=document.body,e=[],i=new Set;for(let n in t)"cssText"!=n&&"cssFloat"!=n&&"string"==typeof t[n]&&(/[A-Z]/.test(n)&&(n=n.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()))),i.has(n)||(e.push(n),i.add(n)));Ug=e.sort().map((t=>({type:"property",label:t})))}return Ug||[]}const qg=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map((t=>({type:"class",label:t}))),Lg=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map((t=>({type:"keyword",label:t}))).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map((t=>({type:"constant",label:t})))),zg=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map((t=>({type:"type",label:t}))),Ig=/^(\w[\w-]*|-\w[\w-]*|)$/,Bg=/^-(-[\w-]*)?$/;const jg=new Yo,Ng=["Declaration"];function Gg(t){for(let e=t;;){if(e.type.isTop)return e;if(!(e=e.parent))return t}}function Hg(t,e,i){if(e.to-e.from>4096){let n=jg.get(e);if(n)return n;let s=[],r=new Set,o=e.cursor(ko.IncludeAnonymous);if(o.firstChild())do{for(let e of Hg(t,o.node,i))r.has(e.label)||(r.add(e.label),s.push(e))}while(o.nextSibling());return jg.set(e,s),s}{let n=[],s=new Set;return e.cursor().iterate((e=>{var r;if(i(e)&&e.matchContext(Ng)&&":"==(null===(r=e.node.nextSibling)||void 0===r?void 0:r.name)){let i=t.sliceString(e.from,e.to);s.has(i)||(s.add(i),n.push({label:i,type:"variable"}))}})),n}}const Fg=t=>e=>{let{state:i,pos:n}=e,s=Ma(i).resolveInner(n,-1),r=s.type.isError&&s.from==s.to-1&&"-"==i.doc.sliceString(s.from,s.to);if("PropertyName"==s.name||(r||"TagName"==s.name)&&/^(Block|Styles)$/.test(s.resolve(s.to).name))return{from:s.from,options:Yg(),validFor:Ig};if("ValueName"==s.name)return{from:s.from,options:Lg,validFor:Ig};if("PseudoClassName"==s.name)return{from:s.from,options:qg,validFor:Ig};if(t(s)||(e.explicit||r)&&function(t,e){var i;if(("("==t.name||t.type.isError)&&(t=t.parent||t),"ArgList"!=t.name)return!1;let n=null===(i=t.parent)||void 0===i?void 0:i.firstChild;return"Callee"==(null==n?void 0:n.name)&&"var"==e.sliceString(n.from,n.to)}(s,i.doc))return{from:t(s)||r?s.from:n,options:Hg(i.doc,Gg(s),t),validFor:Bg};if("TagName"==s.name){for(let{parent:t}=s;t;t=t.parent)if("Block"==t.name)return{from:s.from,options:Yg(),validFor:Ig};return{from:s.from,options:zg,validFor:Ig}}if(!e.explicit)return null;let o=s.resolve(n),a=o.childBefore(n);return a&&":"==a.name&&"PseudoClassSelector"==o.name?{from:n,options:qg,validFor:Ig}:a&&":"==a.name&&"Declaration"==o.name||"ArgList"==o.name?{from:n,options:Lg,validFor:Ig}:"Block"==o.name||"Styles"==o.name?{from:n,options:Yg(),validFor:Ig}:null},Jg=Fg((t=>"VariableName"==t.name)),Kg=Va.define({name:"css",parser:Wg.configure({props:[el.add({Declaration:hl()}),ul.add({"Block KeyframeList":fl})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function tm(){return new ja(Kg,Kg.data.of({autocomplete:Jg}))}const em=["_blank","_self","_top","_parent"],im=["ascii","utf-8","utf-16","latin1","latin1"],nm=["get","post","put","delete"],sm=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],rm=["true","false"],om={},am={a:{attrs:{href:null,ping:null,type:null,media:null,target:em,hreflang:null}},abbr:om,address:om,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:om,aside:om,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:om,base:{attrs:{href:null,target:em}},bdi:om,bdo:om,blockquote:{attrs:{cite:null}},body:om,br:om,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:sm,formmethod:nm,formnovalidate:["novalidate"],formtarget:em,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:om,center:om,cite:om,code:om,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:om,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:om,div:om,dl:om,dt:om,em:om,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:om,figure:om,footer:om,form:{attrs:{action:null,name:null,"accept-charset":im,autocomplete:["on","off"],enctype:sm,method:nm,novalidate:["novalidate"],target:em}},h1:om,h2:om,h3:om,h4:om,h5:om,h6:om,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:om,hgroup:om,hr:om,html:{attrs:{manifest:null}},i:om,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:sm,formmethod:nm,formnovalidate:["novalidate"],formtarget:em,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:om,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:om,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:om,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:im,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:om,noscript:om,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:om,param:{attrs:{name:null,value:null}},pre:om,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:om,rt:om,ruby:om,samp:om,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:im}},section:om,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:om,source:{attrs:{src:null,type:null,media:null}},span:om,strong:om,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:om,summary:om,sup:om,table:om,tbody:om,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:om,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:om,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:om,time:{attrs:{datetime:null}},title:om,tr:om,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:om,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:om},lm={accesskey:null,class:null,contenteditable:rm,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:rm,autocorrect:rm,autocapitalize:rm,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":rm,"aria-autocomplete":["inline","list","both","none"],"aria-busy":rm,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":rm,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":rm,"aria-hidden":rm,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":rm,"aria-multiselectable":rm,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":rm,"aria-relevant":null,"aria-required":rm,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},hm="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map((t=>"on"+t));for(let t of hm)lm[t]=null;class cm{constructor(t,e){this.tags=Object.assign(Object.assign({},am),t),this.globalAttrs=Object.assign(Object.assign({},lm),e),this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}function dm(t,e,i=t.length){if(!e)return"";let n=e.firstChild,s=n&&n.getChild("TagName");return s?t.sliceString(s.from,Math.min(s.to,i)):""}function um(t,e=!1){for(let i=t.parent;i;i=i.parent)if("Element"==i.name){if(!e)return i;e=!1}return null}function fm(t,e,i){let n=i.tags[dm(t,um(e,!0))];return(null==n?void 0:n.children)||i.allTags}function pm(t,e){let i=[];for(let n=e;n=um(n);){let s=dm(t,n);if(s&&"CloseTag"==n.lastChild.name)break;s&&i.indexOf(s)<0&&("EndTag"==e.name||e.from>=n.firstChild.to)&&i.push(s)}return i}cm.default=new cm;const Om=/^[:\-\.\w\u00b7-\uffff]*$/;function gm(t,e,i,n,s){let r=/\s*>/.test(t.sliceDoc(s,s+5))?"":">";return{from:n,to:s,options:fm(t.doc,i,e).map((t=>({label:t,type:"type"}))).concat(pm(t.doc,i).map(((t,e)=>({label:"/"+t,apply:"/"+t+r,type:"type",boost:99-e})))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function mm(t,e,i,n){let s=/\s*>/.test(t.sliceDoc(n,n+5))?"":">";return{from:i,to:n,options:pm(t.doc,e).map(((t,e)=>({label:t,apply:t+s,type:"type",boost:99-e}))),validFor:Om}}function wm(t,e){let{state:i,pos:n}=e,s=Ma(i).resolveInner(n),r=s.resolve(n,-1);for(let t,e=n;s==r&&(t=r.childBefore(e));){let i=t.lastChild;if(!i||!i.type.isError||i.from<i.to)break;s=r=t,e=i.from}return"TagName"==r.name?r.parent&&/CloseTag$/.test(r.parent.name)?mm(i,r,r.from,n):gm(i,t,r,r.from,n):"StartTag"==r.name?gm(i,t,r,n,n):"StartCloseTag"==r.name||"IncompleteCloseTag"==r.name?mm(i,r,n,n):e.explicit&&("OpenTag"==r.name||"SelfClosingTag"==r.name)||"AttributeName"==r.name?function(t,e,i,n,s){let r=um(i),o=r?e.tags[dm(t.doc,r)]:null,a=o&&o.attrs?Object.keys(o.attrs):[];return{from:n,to:s,options:(o&&!1===o.globalAttrs?a:a.length?a.concat(e.globalAttrNames):e.globalAttrNames).map((t=>({label:t,type:"property"}))),validFor:Om}}(i,t,r,"AttributeName"==r.name?r.from:n,n):"Is"==r.name||"AttributeValue"==r.name||"UnquotedAttributeValue"==r.name?function(t,e,i,n,s){var r;let o,a=null===(r=i.parent)||void 0===r?void 0:r.getChild("AttributeName"),l=[];if(a){let r=t.sliceDoc(a.from,a.to),h=e.globalAttrs[r];if(!h){let n=um(i),s=n?e.tags[dm(t.doc,n)]:null;h=(null==s?void 0:s.attrs)&&s.attrs[r]}if(h){let e=t.sliceDoc(n,s).toLowerCase(),i='"',r='"';/^['"]/.test(e)?(o='"'==e[0]?/^[^"]*$/:/^[^']*$/,i="",r=t.sliceDoc(s,s+1)==e[0]?"":e[0],e=e.slice(1),n++):o=/^[^\s<>='"]*$/;for(let t of h)l.push({label:t,apply:i+t+r,type:"constant"})}}return{from:n,to:s,options:l,validFor:o}}(i,t,r,"Is"==r.name?n:r.from,n):!e.explicit||"Element"!=s.name&&"Text"!=s.name&&"Document"!=s.name?null:function(t,e,i,n){let s=[],r=0;for(let n of fm(t.doc,i,e))s.push({label:"<"+n,type:"type"});for(let e of pm(t.doc,i))s.push({label:"</"+e+">",type:"type",boost:99-r++});return{from:n,to:n,options:s,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}(i,t,r,n)}function bm(t){let{extraTags:e,extraGlobalAttributes:i}=t,n=i||e?new cm(e,i):cm.default;return t=>wm(n,t)}const vm=[{tag:"script",attrs:t=>"text/typescript"==t.type||"ts"==t.lang,parser:bp.parser},{tag:"script",attrs:t=>"text/babel"==t.type||"text/jsx"==t.type,parser:vp.parser},{tag:"script",attrs:t=>"text/typescript-jsx"==t.type,parser:yp.parser},{tag:"script",attrs:t=>!t.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(t.type),parser:mp.parser},{tag:"style",attrs:t=>(!t.lang||"css"==t.lang)&&(!t.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(t.type)),parser:Kg.parser}],ym=[{name:"style",parser:Kg.parser.configure({top:"Styles"})}].concat(hm.map((t=>({name:t,parser:mp.parser})))),Sm=Va.define({name:"html",parser:Qg.configure({props:[el.add({Element(t){let e=/^(\s*)(<\/)?/.exec(t.textAfter);return t.node.to<=t.pos+e[0].length?t.continue():t.lineIndent(t.node.from)+(e[2]?0:t.unit)},"OpenTag CloseTag SelfClosingTag":t=>t.column(t.node.from)+t.unit,Document(t){if(t.pos+/\s*/.exec(t.textAfter)[0].length<t.node.to)return t.continue();let e,i=null;for(let e=t.node;;){let t=e.lastChild;if(!t||"Element"!=t.name||t.to!=e.to)break;i=e=t}return i&&(!(e=i.lastChild)||"CloseTag"!=e.name&&"SelfClosingTag"!=e.name)?t.lineIndent(i.from)+t.unit:null}}),ul.add({Element(t){let e=t.firstChild,i=t.lastChild;return e&&"OpenTag"==e.name?{from:e.to,to:"CloseTag"==i.name?i.from:t.to}:null}}),jl.add({"OpenTag CloseTag":t=>t.getChild("TagName")})],wrap:_g(vm,ym)}),languageData:{commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-._"}});function xm(t={}){let e,i="";!1===t.matchClosingTags&&(i="noMatch"),!0===t.selfClosingTags&&(i=(i?i+" ":"")+"selfClosing"),(t.nestedLanguages&&t.nestedLanguages.length||t.nestedAttributes&&t.nestedAttributes.length)&&(e=_g((t.nestedLanguages||[]).concat(vm),(t.nestedAttributes||[]).concat(ym)));let n=e||i?Sm.configure({dialect:i,wrap:e}):Sm;return new ja(n,[Sm.data.of({autocomplete:bm(t)}),!1!==t.autoCloseTags?Qm:[],xp().support,tm().support])}const km=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),Qm=Ts.inputHandler.of(((t,e,i,n)=>{if(t.composing||t.state.readOnly||e!=i||">"!=n&&"/"!=n||!Sm.isActiveAt(t.state,e,-1))return!1;let{state:s}=t,r=s.changeByRange((e=>{var i,r,o;let a,{head:l}=e,h=Ma(s).resolveInner(l,-1);if("TagName"!=h.name&&"StartTag"!=h.name||(h=h.parent),">"==n&&"OpenTag"==h.name){if("CloseTag"!=(null===(r=null===(i=h.parent)||void 0===i?void 0:i.lastChild)||void 0===r?void 0:r.name)&&(a=dm(s.doc,h.parent,l))&&!km.has(a)){let e=">"===t.state.doc.sliceString(l,l+1),i=`${e?"":">"}</${a}>`;return{range:A.cursor(l+1),changes:{from:l+(e?1:0),insert:i}}}}else if("/"==n&&"OpenTag"==h.name){let e=h.parent,i=null==e?void 0:e.parent;if(e.from==l-1&&"CloseTag"!=(null===(o=i.lastChild)||void 0===o?void 0:o.name)&&(a=dm(s.doc,i,l))&&!km.has(a)){let e=">"===t.state.doc.sliceString(l,l+1),i=`/${a}${e?"":">"}`,n=l+i.length+(e?1:0);return{range:A.cursor(n),changes:{from:l,insert:i}}}}return{range:e}}));return!r.changes.empty&&(t.dispatch(r,{userEvent:"input.type",scrollIntoView:!0}),!0)})),$m=Aa({commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}}}),Pm=new mo,Cm=TO.configure({props:[ul.add((t=>!t.is("Block")||t.is("Document")||null!=_m(t)?void 0:(t,e)=>({from:e.doc.lineAt(t.from).to,to:t.to}))),Pm.add(_m),el.add({Document:()=>null}),Za.add({Document:$m})]});function _m(t){let e=/^(?:ATX|Setext)Heading(\d)$/.exec(t.name);return e?+e[1]:void 0}function Xm(t,e){let i=t;for(;;){let t,n=i.nextSibling;if(!n||null!=(t=_m(n.type))&&t<=e)break;i=n}return i.to}const Zm=dl.of(((t,e,i)=>{for(let n=Ma(t).resolveInner(i,-1);n&&!(n.from<e);n=n.parent){let t=n.type.prop(Pm);if(null==t)continue;let e=Xm(n,t);if(e>i)return{from:i,to:e}}return null}));function Am(t){return new Ra($m,t,[Zm],"markdown")}const Tm=Am(Cm),Rm=Am(Cm.configure([LO,BO,IO,jO]));class Em{constructor(t,e,i,n,s,r,o){this.node=t,this.from=e,this.to=i,this.spaceBefore=n,this.spaceAfter=s,this.type=r,this.item=o}blank(t,e=!0){let i=this.spaceBefore+("Blockquote"==this.node.name?">":"");if(null!=t){for(;i.length<t;)i+=" ";return i}for(let t=this.to-this.from-i.length-this.spaceAfter.length;t>0;t--)i+=" ";return i+(e?this.spaceAfter:"")}marker(t,e){let i="OrderedList"==this.node.name?String(+Mm(this.item,t)[2]+e):"";return this.spaceBefore+i+this.type+this.spaceAfter}}function Vm(t,e){let i=[];for(let e=t;e&&"Document"!=e.name;e=e.parent)"ListItem"!=e.name&&"Blockquote"!=e.name&&"FencedCode"!=e.name||i.push(e);let n=[];for(let t=i.length-1;t>=0;t--){let s,r=i[t],o=e.lineAt(r.from),a=r.from-o.from;if("FencedCode"==r.name)n.push(new Em(r,a,a,"","","",null));else if("Blockquote"==r.name&&(s=/^[ \t]*>( ?)/.exec(o.text.slice(a))))n.push(new Em(r,a,a+s[0].length,"",s[1],">",null));else if("ListItem"==r.name&&"OrderedList"==r.parent.name&&(s=/^([ \t]*)\d+([.)])([ \t]*)/.exec(o.text.slice(a)))){let t=s[3],e=s[0].length;t.length>=4&&(t=t.slice(0,t.length-4),e-=4),n.push(new Em(r.parent,a,a+e,s[1],t,s[2],r))}else if("ListItem"==r.name&&"BulletList"==r.parent.name&&(s=/^([ \t]*)([-+*])([ \t]{1,4}\[[ xX]\])?([ \t]+)/.exec(o.text.slice(a)))){let t=s[4],e=s[0].length;t.length>4&&(t=t.slice(0,t.length-4),e-=4);let i=s[2];s[3]&&(i+=s[3].replace(/[xX]/," ")),n.push(new Em(r.parent,a,a+e,s[1],t,i,r))}}return n}function Mm(t,e){return/^(\s*)(\d+)(?=[.)])/.exec(e.sliceString(t.from,t.from+10))}function Dm(t,e,i,n=0){for(let s=-1,r=t;;){if("ListItem"==r.name){let t=Mm(r,e),o=+t[2];if(s>=0){if(o!=s+1)return;i.push({from:r.from+t[1].length,to:r.from+t[0].length,insert:String(s+2+n)})}s=o}let t=r.nextSibling;if(!t)break;r=t}}function Wm(t){return"QuoteMark"==t.name||"ListMark"==t.name}const Um=[{key:"Enter",run:({state:t,dispatch:e})=>{let i=Ma(t),{doc:n}=t,s=null,r=t.changeByRange((e=>{if(!e.empty||!Rm.isActiveAt(t,e.from))return s={range:e};let r=e.from,o=n.lineAt(r),a=Vm(i.resolveInner(r,-1),n);for(;a.length&&a[a.length-1].from>r-o.from;)a.pop();if(!a.length)return s={range:e};let l=a[a.length-1];if(l.to-l.spaceAfter.length>r-o.from)return s={range:e};let h=r>=l.to-l.spaceAfter.length&&!/\S/.test(o.text.slice(l.to));if(l.item&&h){if(l.node.firstChild.to>=r||o.from>0&&!/[^\s>]/.test(n.lineAt(o.from-1).text)){let t,e=a.length>1?a[a.length-2]:null,i="";e&&e.item?(t=o.from+e.from,i=e.marker(n,1)):t=o.from+(e?e.to:0);let s=[{from:t,to:r,insert:i}];return"OrderedList"==l.node.name&&Dm(l.item,n,s,-2),e&&"OrderedList"==e.node.name&&Dm(e.item,n,s),{range:A.cursor(t+i.length),changes:s}}{let e="";for(let t=0,i=a.length-2;t<=i;t++)e+=a[t].blank(t<i?a[t+1].from-e.length:null,t<i);return e+=t.lineBreak,{range:A.cursor(r+e.length),changes:{from:o.from,insert:e}}}}if("Blockquote"==l.node.name&&h&&o.from){let i=n.lineAt(o.from-1),s=/>\s*$/.exec(i.text);if(s&&s.index==l.from){let n=t.changes([{from:i.from+s.index,to:i.to},{from:o.from+l.from,to:o.to}]);return{range:e.map(n),changes:n}}}let c=[];"OrderedList"==l.node.name&&Dm(l.item,n,c);let d=l.item&&l.item.from<o.from,u="";if(!d||/^[\s\d.)\-+*>]*/.exec(o.text)[0].length>=l.to)for(let t=0,e=a.length-1;t<=e;t++)u+=t!=e||d?a[t].blank(t<e?a[t+1].from-u.length:null):a[t].marker(n,1);let f=r;for(;f>o.from&&/\s/.test(o.text.charAt(f-o.from-1));)f--;return u=t.lineBreak+u,c.push({from:f,to:r,insert:u}),{range:A.cursor(f+u.length),changes:c}}));return!s&&(e(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0)}},{key:"Backspace",run:({state:t,dispatch:e})=>{let i=Ma(t),n=null,s=t.changeByRange((e=>{let s=e.from,{doc:r}=t;if(e.empty&&Rm.isActiveAt(t,e.from)){let t=r.lineAt(s),n=Vm(function(t,e){let i=t.resolveInner(e,-1),n=e;Wm(i)&&(n=i.from,i=i.parent);for(let t;t=i.childBefore(n);)if(Wm(t))n=t.from;else{if("OrderedList"!=t.name&&"BulletList"!=t.name)break;i=t.lastChild,n=i.to}return i}(i,s),r);if(n.length){let i=n[n.length-1],r=i.to-i.spaceAfter.length+(i.spaceAfter?1:0);if(s-t.from>r&&!/\S/.test(t.text.slice(r,s-t.from)))return{range:A.cursor(t.from+r),changes:{from:t.from+r,to:s}};if(s-t.from==r&&(!i.item||t.from<=i.item.from||!/\S/.test(t.text.slice(0,i.to)))){let n=t.from+i.from;if(i.item&&i.node.from<i.item.from&&/\S/.test(t.text.slice(i.from,i.to)))return{range:e,changes:{from:n,to:t.from+i.to,insert:i.blank(i.to-i.from)}};if(n<s)return{range:A.cursor(n),changes:{from:n,to:s}}}}}return n={range:e}}));return!n&&(e(t.update(s,{scrollIntoView:!0,userEvent:"delete"})),!0)}}],Ym=xm({matchClosingTags:!1});_i.fromClass(class{decorations;constructor(t){this.decorations=this.getBracketDecorations(t)}update(t){(t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.getBracketDecorations(t.view))}getBracketDecorations(t){const{doc:e}=t.state,i=[],n=[],s=["red","orange","yellow","green","blue","indigo","violet"];for(let t=0;t<e.length;t+=1){const r=e.sliceString(t,t+1);if("("===r||"["===r||"{"===r)n.push({type:r,from:t});else if(")"===r||"]"===r||"}"===r){const e=n.pop();if(e&&e.type===this.getMatchingBracket(r)){const r=s[n.length%s.length];i.push(ni.mark({class:`rainbow-bracket-${r}`}).range(e.from,e.from+1),ni.mark({class:`rainbow-bracket-${r}`}).range(t,t+1))}}}return i.sort(((t,e)=>t.from-e.from||t.startSide-e.startSide)),ni.set(i)}getMatchingBracket(t){switch(t){case")":return"(";case"]":return"[";case"}":return"{";default:return null}}},{decorations:t=>t.decorations});var qm="[a-zA-Z\\$][a-zA-Z0-9\\$]*",Lm="(?:\\.\\d+|\\d+\\.\\d*|\\d+)",zm="(?:`(?:`?"+Lm+")?)",Im=new RegExp("(?:(?:\\d+)(?:\\^\\^(?:\\.\\w+|\\w+\\.\\w*|\\w+)"+zm+"?(?:\\*\\^[+-]?\\d+)?))"),Bm=new RegExp("(?:"+Lm+zm+"?(?:\\*\\^[+-]?\\d+)?)"),jm=new RegExp("(?:`?)(?:"+qm+")(?:`(?:"+qm+"))*(?:`?)");let Nm=[];const Gm=["True","False","All","None","Null","Full","$Failed","$Aborted"];function Hm(t,e){var i;return'"'===(i=t.next())?(e.tokenize=Fm,e.tokenize(t,e)):"("===i&&t.eat("*")?(e.commentLevel++,e.tokenize=Jm,e.tokenize(t,e)):(t.backUp(1),t.match(Im,!0,!1)||t.match(Bm,!0,!1)?"number":t.match(/([a-zA-Z\$][a-zA-Z0-9\$]*(?:`[a-zA-Z0-9\$]+)*::usage)/,!0,!1)?"meta":t.match(/([a-zA-Z\$][a-zA-Z0-9\$]*(?:`[a-zA-Z0-9\$]+)*::[a-zA-Z\$][a-zA-Z0-9\$]*):?/,!0,!1)?"string.special":t.match(/([a-zA-Z\$][a-zA-Z0-9\$]*\s*:)(?:(?:[a-zA-Z\$][a-zA-Z0-9\$]*)|(?:[^:=>~@\^\&\*\)\[\]'\?,\|])).*/,!0,!1)||t.match(/[a-zA-Z\$][a-zA-Z0-9\$]*_+[a-zA-Z\$][a-zA-Z0-9\$]*/,!0,!1)||t.match(/[a-zA-Z\$][a-zA-Z0-9\$]*_+/,!0,!1)||t.match(/_+[a-zA-Z\$][a-zA-Z0-9\$]*/,!0,!1)?"variableName.special":t.match(/\\\[[a-zA-Z\$][a-zA-Z0-9\$]*\]/,!0,!1)?"character":t.match(/(?:\[|\]|{|}|\(|\))/,!0,!1)?"bracket":t.match(/(?:#[a-zA-Z\$][a-zA-Z0-9\$]*|#+[0-9]?)/,!0,!1)?"variableName.constant":t.match(jm,!0,!1)?Gm.indexOf(t.current())>-1?"number":Nm.indexOf(t.current())>-1||0==Nm.length?"keyword":t.current()in e.localVars?"atom":(e.localVars[t.current()]=!0,"function"):t.match(/(?:\\|\+|\-|\*|\/|,|;|\.|:|@|~|=|>|<|&|\||_|`|'|\^|\?|!|%)/,!0,!1)?"operator":(t.next(),"error"))}function Fm(t,e){for(var i,n=!1,s=!1;null!=(i=t.next());){if('"'===i&&!s){n=!0;break}s=!s&&"\\"===i}return n&&!s&&(e.tokenize=Hm),"string"}function Jm(t,e){for(var i,n;e.commentLevel>0&&null!=(n=t.next());)"("===i&&"*"===n&&e.commentLevel++,"*"===i&&")"===n&&e.commentLevel--,i=n;return e.commentLevel<=0&&(e.tokenize=Hm),"comment"}const Km={name:"mathematica",extendVariables:function(t){},startState:function(){return{tokenize:Hm,commentLevel:0,localVars:{}}},token:function(t,e){return t.eatSpace()?null:e.tokenize(t,e)},languageData:{commentTokens:{block:{open:"(*",close:"*)"}}}};let tw={of:t=>[ih.define(Km),Nu({override:[async e=>function(t,e){let i=t.matchBefore(/\w*/);return i.from!==i.to||t.explicit?{from:i.from,options:e.data}:null}(e,t)]}),Ys.of([{key:"Escape",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((t=>{let{from:e,to:i}=t;return{changes:{from:e,to:i,insert:"EC"},range:A.cursor(e+2)}}));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}])],reBuild:t=>{Nm=t.map((t=>t.label))}};const ew=(t,e,i,n)=>{if(0==t.length)return;const s=(new Date).valueOf();let r=0;i.dom.loadingMark=!0;const o=i.dom.style.background;let a=0;console.log("Start animation");const l=setInterval((()=>{i.dom.style.setProperty("background","hsl("+a+"deg 100% 97%)","important"),a+=2,a>360&&(a=0)}),30);n.transaction(e,i,s,t.length);for(const a of t)iw(a,((a,h)=>{n.file(e,i,s,a,h),r++,r>=t.length&&i.dom&&i.dom.loadingMark&&(i.dom.loadingMark=!1,setTimeout((()=>{i.dom.style.background=o,clearInterval(l),console.log("Stop animation")}),2e3))}),(()=>{console.warn("Fauilure");const t=i.dom.style.background;i.dom.style.background="rgb(255 189 189 / 97%)";let e=97;const n=setInterval((()=>{i.dom.style.background="rgb(255 189 189 / "+Math.round(e)+"%)",e*=.95}),30);clearInterval(l),setTimeout((()=>{clearInterval(n),i.dom.style.background=t}),3e3)}))};function iw(t,e,i){const n=new FileReader;n.addEventListener("load",(n=>{const s=n.target.result;if(s.byteLength/1024/1024>100)return alert("Files > 100Mb are not supported for drag and drop"),void i();let r=base64ArrayBuffer(s);e(t.name,r)})),n.addEventListener("progress",(t=>{if(t.loaded&&t.total){const e=t.loaded/t.total*100;console.log(e)}})),n.readAsArrayBuffer(t)}const nw=new RegExp("^jsfc4uri"),sw=(t,e,i=console.log)=>Ts.domEventHandlers({drop(e,i){e.preventDefault();const n=[];e.dataTransfer.items?[...e.dataTransfer.items].forEach(((t,e)=>{if("file"===t.kind){const i=t.getAsFile();console.log(`… file[${e}].name = ${i.name}`),n.push(i)}})):[...e.dataTransfer.files].forEach(((t,e)=>{console.log(`… file[${e}].name = ${t.name}`),n.push(t)})),ew(n,e,i,t)},paste(t,n){let s=t.clipboardData||window.clipboardData;for(const r of s.items)if("string"===r.kind)switch(r.type){case"text/plain":const o=s.getData("text");nw.test(o)&&(t.preventDefault(),i(t,n,o.slice(8)));break;case"image/png":t.preventDefault(),ew([r.getAsFile()],t,n,e)}else t.preventDefault(),ew([r.getAsFile()],t,n,e)}}),rw=new pr({regexp:/\\\[(\w+)\]/g,decoration:t=>ni.replace({widget:new hw(t[1])})}),ow=_i.fromClass(class{constructor(t){this.Greekholder=rw.createDeco(t)}update(t){this.Greekholder=rw.updateDeco(t,this.Greekholder)}},{decorations:t=>t.Greekholder,provide:t=>Ts.atomicRanges.of((e=>e.plugin(t)?.Greekholder||ni.none))}),aw=/(sqrt|undirectededge|directededge|transpose|degree|capital|curly|formal|script|.*)(.*)/,lw=(t,e,i=!0)=>{if(i){const i=e.toLowerCase().match(aw);t.innerHTML=((t,e,i,n)=>{switch(i){case"sqrt":return"&radic;";case"undirectededge":return"&harr;";case"directededge":return"&rarr;";case"element":return"&#8712;";case"transpose":return"&#7488;";case"degree":return"&deg;";case"capital":return"&"+n.charAt(0).toUpperCase()+n.slice(1)+";";case"curly":return t.style.fontStyle="italic","&"+n+";";case"formal":return t.style.color="#91794a",n.length>1?"&"+n+";":n;case"script":return t.style.color="#4a916e","&el"+n+";";default:return"&"+e+";"}})(t,i[0],i[1],i[2])}else t.innerHTML=e.replace(/\\\[(\w+)\]/,(t=>"&"+t.toLowerCase().slice(2,-1)+";"))};class hw extends ei{constructor(t){super(),this.name=t}eq(t){return this.name===t.name}toDOM(){let t=document.createElement("span");return lw(t,this.name),t}ignoreEvent(){return!1}}const cw=new pr({regexp:/(->|<-)/g,decoration:t=>ni.replace({widget:new dw(t[1])})});_i.fromClass(class{constructor(t){this.Arrowholder=cw.createDeco(t)}update(t){this.Arrowholder=cw.updateDeco(t,this.Arrowholder)}},{decorations:t=>t.Arrowholder,provide:t=>Ts.atomicRanges.of((e=>e.plugin(t)?.Arrowholder||ni.none))});class dw extends ei{constructor(t){super(),this.dir=t}eq(t){return this.dir===t.dir}toDOM(){let t=document.createElement("span");return"->"===this.dir?t.innerText="→":t.innerText="←",t}ignoreEvent(){return!1}}function uw(t){if(!(t=t||{}).open)throw new Error('Balanced: please provide a "open" property');if(!t.close)throw new Error('Balanced: please provide a "close" property');if(this.balance=t.balance||!1,this.exceptions=t.exceptions||!1,this.caseInsensitive=t.caseInsensitive,this.head=t.head||t.open,this.head=Array.isArray(this.head)?this.head:[this.head],this.open=Array.isArray(t.open)?t.open:[t.open],this.close=Array.isArray(t.close)?t.close:[t.close],!Array.isArray(this.head)||!Array.isArray(this.open)||!Array.isArray(this.close)||this.head.length!==this.open.length||this.open.length!==this.close.length)throw new Error('Balanced: if you use arrays for a "head,open,close" you must use matching arrays for all options');var e=gw(this.head.map(this.regExpFromArrayGroupedMap,this)),i=gw(this.open.map(this.regExpFromArrayGroupedMap,this)),n=gw(this.close.map(this.regExpFromArrayGroupedMap,this));this.regExp=gw([e,i,n],"g"+(this.caseInsensitive?"i":"")),this.regExpGroupLength=this.head.length}function fw(t,e,i){for(var n=Ow(e.substr(0,i+1),/^.*\n?$/gim),s=Ow(e,/^.*\n?$/gim),r=n.length-1,o=i+1-(n.length?n[n.length-1].index:0),a="",l=2;l>=0;l--)r-l>=0&&s[r-l]&&(a+=e.substr(s[r-l].index,s[r-l].length)+"\n");for(l=0;l<o-1;l++)a+="-";for(a+="^\n",l=1;l<=2;l++)r+l>=0&&s[r+l]&&(a+=e.substr(s[r+l].index,s[r+l].length)+"\n");a=a.replace(/\t/g," ").replace(/\n$/,"");var h=new Error(t+" at "+(r+1)+":"+o+"\n\n"+a);return h.line=r+1,h.column=o,h.index=i,h}function pw(t,e){return t>=e.index&&t<=e.index+e.length-1}function Ow(t,e){var i,n=new RegExp(e),s=[];if(t)for(;i=n.exec(t);)s.push({index:i.index,length:i[0].length,match:i[0]}),i[0].length||n.lastIndex++;return s}function gw(t,e,i){var n=t.map((function(t){return t instanceof RegExp?t.source:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}(t)}),this).join("|");return n=i?"("+n+")":"(?:"+n+")",new RegExp(n,e||void 0)}uw.prototype={regExpFromArrayGroupedMap:function(t){return gw([t],null,!0)},matchContentsInBetweenBrackets:function(t,e){for(var i,n=new RegExp(this.regExp),s=[],r=[],o=null,a=!0;i=n.exec(t);){if(e){for(var l=!1,h=0;h<e.length;h++)pw(i.index,e[h])&&(l=!0);if(l)continue}var c=i.indexOf(i[0],1)-1,d=Math.floor(c/this.regExpGroupLength),u=c-Math.floor(c/this.regExpGroupLength)*this.regExpGroupLength;if(o||0!==d||this.balance&&(!this.balance||s.length)){if(1===d||0===d)s.push(u);else if(2===d){var f=s.pop();if(f===u)null!==o&&0===s.length&&(r.push({index:o.index,length:i.index+i[0].length-o.index,head:o[0],tail:i[0]}),o=null);else if(this.balance&&(a=!1,this.exceptions)){if(void 0===f)throw fw("Balanced: unexpected close bracket",t,i.index);if(f!==u)throw fw('Balanced: mismatching close bracket, expected "'+this.close[f]+'" but found "'+this.close[u]+'"',t,i.index)}}}else o=i,this.balance?s.push(u):s=[u]}if(this.balance){if(this.exceptions&&(!a||0!==s.length))throw fw("Balanced: expected close bracket",t,t.length-1);return a&&0===s.length?r:null}return r},replaceMatchesInBetweenBrackets:function(t,e,i){return function(t,e,i){for(var n=0,s=0;s<t.length;s++){var r=t[s],o=i(e.substr(r.index+n+r.head.length,r.length-r.head.length-r.tail.length),r.head,r.tail);e=e.substr(0,r.index+n)+o+e.substr(r.index+n+r.length,e.length-(r.index+n+r.length)),n+=o.length-r.length}return e}(this.matchContentsInBetweenBrackets(t,i),t,e)}};var mw=Ow,ww=pw,bw=function(t,e){return t.filter((function(t){for(var i=!1,n=0;n<e.length;n++)if(pw(t.index,e[n])){i=!0;break}return!i}))},vw=uw;String.prototype.splitNoQuotes=function(t){const e=[],i=this;var n=mw(i,/\"[^\"]*\"/g),s=mw(i,new RegExp(t,"g"));s=bw(s,n);let r=0;for(let t=0;t<s.length;++t)e.push(i.substring(r,s[t].index)),r=s[t].index+1;return r<i.length&&e.push(i.substring(r)),e};const yw=(t,e)=>{const i=((t,e,i)=>{var n,s=new RegExp(t),r=[];if(e)for(;n=s.exec(e);){if(i){for(var o=!1,a=0;a<i.length;a++)ww(n.index,i[a])&&(o=!0);if(o)continue}r.push({index:n.index,length:n[0].length,match:n[0]}),n[0].length||s.lastIndex++}return r})(e,t,new vw({open:/\(\*\w+\[\*\)/,close:/\(\*\]\w+\*\)/}).matchContentsInBetweenBrackets(t,[])),n=[];let s,r,o=0;for(t.length;r=i.shift();){s&&(o=s.index+s.length);const e=t.slice(o,r.index);n.push({from:o,length:e.length,body:e}),s=r}let a=0;if(s&&(a=s.index+s.length),a!=t.length){const e=t.slice(a);n.push({from:a,length:e.length,body:e})}return n};function Sw(t,e,i,n,s){for(var r=function(t,i,n){t.lineBreak||((t,e,i,n)=>{new vw({open:"(*"+t+"[*)",close:"(*]"+t+"*)",balance:!1}).matchContentsInBetweenBrackets(e.value,[]).forEach((function(t){const s=e.value.slice(t.index+t.head.length,t.index+t.length-t.tail.length);n(i+t.index,{length:t.length,pos:i+t.index,argsPos:i+t.index+t.head.length,str:s})}))})(e,t,i,s)},o=t.iterRange(i,n),a=i;!o.next().done;a+=o.value.length)r(o,a)}var xw,kw=function(){function t(t){var e=t.tag,i=t.decoration,n=t.decorate,s=t.boundary,r=t.maxLength,o=void 0===r?1e7:r;if(this.tag=e,n)this.addMatch=function(t,e,i,s){return n(s,i,i+t.length,t,e)};else if("function"==typeof i)this.addMatch=function(t,e,n,s){var r=i(t,e,n);r&&s(n,n+t.length,r)};else{if(!i)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=function(t,e,n,s){return s(n,n+t.length,i)}}this.boundary=s,this.maxLength=o}return t.prototype.createDeco=function(t){for(var e=this,i=new Xt,n=i.add.bind(i),s=0,r=function(t,e){var i=t.visibleRanges;if(1==i.length&&i[0].from==t.viewport.from&&i[0].to==t.viewport.to)return i;for(var n=[],s=0,r=i;s<r.length;s++){var o=r[s],a=o.from,l=o.to;a=Math.max(t.state.doc.lineAt(a).from,a-e),l=Math.min(t.state.doc.lineAt(l).to,l+e),n.length&&n[n.length-1].to>=a?n[n.length-1].to=l:n.push({from:a,to:l})}return n}(t,this.maxLength);s<r.length;s++){var o=r[s],a=o.from,l=o.to;Sw(t.state.doc,this.tag,a,l,(function(i,s){return e.addMatch(s,t,i,n)}))}return i.finish()},t.prototype.updateDeco=function(t,e){var i=1e9,n=-1;return t.docChanged&&t.changes.iterChanges((function(e,s,r,o){o>t.view.viewport.from&&r<t.view.viewport.to&&(i=Math.min(r,i),n=Math.max(o,n))})),t.viewportChanged||n-i>1e3?this.createDeco(t.view):n>-1?this.updateRange(t.view,e.map(t.changes),i,n):e},t.prototype.updateRange=function(t,e,i,n){for(var s=this,r=function(r){var a=Math.max(r.from,i),l=Math.min(r.to,n);if(l>a){var h=t.state.doc.lineAt(a),c=h.to<l?t.state.doc.lineAt(l):h,d=Math.max(r.from,h.from),u=Math.min(r.to,c.to);if(o.boundary){for(;a>h.from;a--)if(o.boundary.test(h.text[a-1-h.from])){d=a;break}for(;l<c.to;l++)if(o.boundary.test(c.text[l-c.from])){u=l;break}}var f=[],p=function(t,e,i){return f.push(i.range(t,e))};h==c?(console.warn("It migtht not works, since it did not implement it correctly #1"),console.log({fromLine:h,toLine:c,"view.state.doc":t.state.doc,"this_1.tag":o.tag,start_1:d,end_1:u}),Sw(t.state.doc,o.tag,d,u,(function(e,i){return s.addMatch(i,t,e,p)}))):(console.warn("It migtht not works, since it did not implement it correctly #2"),Sw(t.state.doc,o.tag,d,u,(function(e,i){return s.addMatch(i,t,e,p)}))),e=e.update({filterFrom:d,filterTo:u,filter:function(t,e){return t<d||e>u},add:f})}},o=this,a=0,l=t.visibleRanges;a<l.length;a++){r(l[a])}return e},t}();function Qw(t){xw=t;return[_w({}),Ys.of([{key:"Ctrl-/",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((e=>{let{from:i,to:n}=e;const s=t.sliceDoc(i,n);return 0===s.length?{changes:{from:i,to:n,insert:"(*FB[*)((_)(*,*)/(*,*)(_))(*]FB*)"},range:A.cursor(i)}:{changes:{from:i,to:n,insert:"(*FB[*)(("+s+")(*,*)/(*,*)(_))(*]FB*)"},range:A.cursor(i)}}));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}])]}let $w=class{constructor(t,e,i,n,s,r){this.view=e,this.visibleValue=t,this.placeholder=r,console.log(r),this.args=yw(t.str,/\(\*,\*\)/gm);const o=this;let a,l;console.log("creating InstanceWidget");let h=!0;const c=o.args[0].body.slice(2,-1);if('"'==c.charAt(0)&&(/\(\*/.exec(c)||(h=!1)),h)a=xw({doc:c,parent:i,update:t=>this.applyChanges(t,0),eval:()=>{e.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowLeft",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return console.log(o.visibleValue.pos),e.dispatch({selection:{anchor:o.visibleValue.pos}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,e){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return l.dispatch({selection:{anchor:0}}),l.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowDown",run:function(t,e){l.focus(),t.editorLastCursor=void 0}}])]});else{a={destroy:()=>{},setState:t=>{"string"==typeof t?lw(i.firstChild,t.slice(1,-1),!1):(i.innerHTML="",this.topEditor=new Ts({newState:t,parent:i}))}};const t=document.createElement("span");lw(t,c.slice(1,-1),!1),i.appendChild(t)}h=!0;const d=o.args[2].body.slice(1,-2);if('"'==d.charAt(0)&&(/\(\*/.exec(d)||(h=!1)),h)l=xw({doc:d,parent:n,update:t=>this.applyChanges(t,2),eval:()=>{e.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowLeft",run:function(t,e){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return a.dispatch({selection:{anchor:a.state.doc.length}}),a.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.dispatch({selection:{anchor:o.visibleValue.pos+o.visibleValue.length}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowUp",run:function(t,e){a.focus(),t.editorLastCursor=void 0}}])]});else{l={destroy:()=>{},setState:t=>{"string"==typeof t?lw(n.firstChild,t.slice(1,-1),!1):(n.innerHTML="",this.bottomEditor=new Ts({newState:t,parent:n}))}};const t=document.createElement("span");lw(t,d.slice(1,-1),!1),n.appendChild(t)}o.args[0].length=o.args[0].body.length,o.args[2].length=o.args[2].body.length,delete o.args[2].body,delete o.args[1].body,delete o.args[0].body,this.topEditor=a,this.bottomEditor=l}applyChanges(t,e){const i=this.args,n=this.visibleValue.argsPos;if(0==e){const e="(("+t+")",s={from:n+i[0].from,to:n+i[0].from+i[0].length,insert:e};this.visibleValue.str=this.visibleValue.str.substring(0,i[0].from).concat(e,this.visibleValue.str.substring(i[0].from+i[0].length));const r=e.length-i[0].length;i[0].to=i[0].to+r,i[2].from=i[2].from+r,i[0].length=e.length,this.visibleValue.length=this.visibleValue.length+r,this.view.dispatch({changes:s})}else{const e="("+t+"))",s={from:n+i[2].from,to:n+i[2].from+i[2].length,insert:e};this.visibleValue.str=this.visibleValue.str.substring(0,i[2].from).concat(e,this.visibleValue.str.substring(i[2].from+i[2].length));const r=e.length-i[2].length;i[2].to=i[2].to+r,i[2].length=e.length,this.visibleValue.length=this.visibleValue.length+r,this.view.dispatch({changes:s})}}update(t,e){if(this.visibleValue.str!=t.str){console.warn("Out of sync");const e=this,i=this.view;let n,s;this.visibleValue=t,this.args=yw(t.str,/\(\*,\*\)/gm),console.log("recreating InstanceWidget");let r=!0;const o=e.args[0].body.slice(2,-1);'"'==o.charAt(0)&&(/\(\*/.exec(o)||(r=!1)),n=r?xw.state({doc:o,update:t=>e.applyChanges(t,0),eval:()=>{i.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowLeft",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return console.log(e.visibleValue.pos),i.dispatch({selection:{anchor:e.visibleValue.pos}}),i.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.bottomEditor.dispatch({selection:{anchor:0}}),e.bottomEditor.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowDown",run:function(t,i){e.bottomEditor.focus(),t.editorLastCursor=void 0}}])]}):o,r=!0;const a=e.args[2].body.slice(1,-2);return'"'==a.charAt(0)&&(/\(\*/.exec(a)||(r=!1)),s=r?xw.state({doc:a,update:t=>e.applyChanges(t,2),eval:()=>{e.view.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowLeft",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.topEditor.dispatch({selection:{anchor:e.topEditor.state.doc.length}}),e.topEditor.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return i.dispatch({selection:{anchor:e.visibleValue.pos+e.visibleValue.length}}),i.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowUp",run:function(t,i){e.topEditor.focus(),t.editorLastCursor=void 0}}])]}):a,this.topEditor.setState(n),this.bottomEditor.setState(s),console.log(e),e.args[0].length=e.args[0].body.length,void(e.args[2].length=e.args[2].body.length)}this.visibleValue.pos=t.pos,this.placeholder=e,this.visibleValue.argsPos=t.argsPos}destroy(){this.topEditor.destroy(),this.bottomEditor.destroy()}},Pw=class extends ei{constructor(t,e,i,n){super(),this.view=i,this.visibleValue=t,this.reference=e,this.placeholder=n}eq(t){return!1}updateDOM(t,e){return this.DOMElement=t,t.EditorWidget.update(this.visibleValue,this),!0}skipPosition(t,e,i){if(e.from!=e.to||i)return t;if(t.from-e.from>0)this.DOMElement.EditorWidget.topEditor.dispatch({selection:{anchor:0}}),this.DOMElement.EditorWidget.topEditor.focus();else{const t=this.DOMElement.EditorWidget.bottomEditor;t.dispatch({selection:{anchor:t.state.doc.length}}),t.focus()}return e}toDOM(t){console.log("Create a new one!");let e=document.createElement("span");e.classList.add("fraction");const i=document.createElement("table");i.classList.add("container"),e.appendChild(i);const n=document.createElement("tbody");i.appendChild(n);const s=document.createElement("tr"),r=document.createElement("tr");n.appendChild(s),n.appendChild(r);const o=document.createElement("td");o.classList.add("enumenator"),s.appendChild(o);const a=document.createElement("td");r.appendChild(a);const l=this;return e.EditorWidget=new $w(this.visibleValue,t,o,a,[],this),this.DOMElement=e,this.reference.push({destroy:()=>{l.destroy(e)}}),e}ignoreEvent(){return!0}destroy(t){t.EditorWidget.destroy()}};const Cw=(t,e,i)=>new kw({tag:"FB",decoration:n=>ni.replace({widget:new Pw(n,t,e,i)})}),_w=t=>_i.fromClass(class{constructor(e){this.disposable=[],this.placeholder=Cw(this.disposable,e,this).createDeco(e),t.placeholder=this}update(t){this.placeholder=Cw(this.disposable,t,this).updateDeco(t,this.placeholder)}destroy(){this.disposable.forEach((t=>{t.destroy()}))}},{decorations:t=>t.placeholder,provide:t=>Ts.atomicRanges.of((e=>{var i;return(null===(i=e.plugin(t))||void 0===i?void 0:i.placeholder)||ni.none}))});var Xw;function Zw(t){return Xw=t,[Ew,Ys.of([{key:"Ctrl-2",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((e=>{let{from:i,to:n}=e;const s=t.sliceDoc(i,n);return 0===s.length?{changes:{from:i,to:n,insert:"(*SqB[*)Sqrt[_](*]SqB*)"},range:A.cursor(i)}:{changes:{from:i,to:n,insert:"(*SqB[*)Sqrt["+s+"](*]SqB*)"},range:A.cursor(i)}}));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}])]}let Aw=class{constructor(t,e,i,n,s){this.view=e,this.visibleValue=t;const r=this;this.sliceRanges=n,this.length=t.str.length,console.log("creating InstanceWidget"),this.editor=Xw({doc:t.str.slice(...n),parent:i,update:t=>r.applyChanges(t),eval:()=>{e.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowRight",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.dispatch({selection:{anchor:r.visibleValue.pos+r.visibleValue.length}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowLeft",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.dispatch({selection:{anchor:r.visibleValue.pos}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}}])]})}applyChanges(t){const e=t,i={from:this.visibleValue.argsPos+5,to:this.visibleValue.argsPos+this.length-1,insert:e};console.log(this.visibleValue);const n=e.length+6-this.length;this.length=this.length+n,this.visibleValue.length=this.visibleValue.length+n,this.visibleValue.str="Sqrt["+e+"]",this.view.dispatch({changes:i})}update(t){if(this.visibleValue.str==t.str)this.visibleValue.pos=t.pos,this.visibleValue.argsPos=t.argsPos;else{console.warn("Out of sync"),this.visibleValue=t;const e=this.sliceRanges,i=this.editor,n=this,s=this.view;this.length=t.str.length;const r=Xw.state({doc:t.str.slice(...e),update:t=>n.applyChanges(t),eval:()=>{s.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowRight",run:function(t,e){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return s.dispatch({selection:{anchor:n.visibleValue.pos+n.visibleValue.length}}),s.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowLeft",run:function(t,e){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return s.dispatch({selection:{anchor:n.visibleValue.pos}}),s.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}}])]});i.setState(r)}}destroy(){console.warn("destroy Instance of Widget!"),this.editor.destroy()}},Tw=class extends ei{constructor(t,e,i){super(),this.view=i,this.visibleValue=t,this.reference=e}eq(t){return!1}updateDOM(t,e){return this.DOMElement=t,t.EditorWidget.update(this.visibleValue),!0}toDOM(t){console.log("Create a new one!");let e=document.createElement("span");e.classList.add("sqroot");const i=this,n=document.createElement("span");return n.classList.add("radicand"),e.EditorWidget=new Aw(this.visibleValue,t,n,[5,-1],[]),e.appendChild(n),this.reference.push({destroy:()=>{i.destroy(e)}}),this.DOMElement=e,e}skipPosition(t,e,i){if(e.from!=e.to||i)return t;if(t.from-e.from>0)this.DOMElement.EditorWidget.editor.dispatch({selection:{anchor:0}}),this.DOMElement.EditorWidget.editor.focus();else{const t=this.DOMElement.EditorWidget.editor;t.dispatch({selection:{anchor:t.state.doc.length}}),t.focus()}return e}ignoreEvent(){return!0}destroy(t){t.EditorWidget.destroy()}};const Rw=(t,e)=>new kw({tag:"SqB",decoration:i=>ni.replace({widget:new Tw(i,t,e)})}),Ew=_i.fromClass(class{constructor(t){this.disposable=[],this.placeholder=Rw(this.disposable,t).createDeco(t)}update(t){this.placeholder=Rw(this.disposable,t).updateDeco(t,this.placeholder)}destroy(){this.disposable.forEach((t=>{t.destroy()}))}},{decorations:t=>t.placeholder,provide:t=>Ts.atomicRanges.of((e=>{var i;return(null===(i=e.plugin(t))||void 0===i?void 0:i.placeholder)||ni.none}))});var Vw;function Mw(t){return Vw=t,[Yw,Ys.of([{key:"Ctrl--",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((e=>{let{from:i,to:n}=e;const s=t.sliceDoc(i,n);return 0===s.length?{changes:{from:i,to:n,insert:"(*SbB[*)Subscript[_(*|*),(*|*)_](*]SbB*)"},range:A.cursor(i)}:{changes:{from:i,to:n,insert:"(*SbB[*)Subscript["+s+"(*|*),(*|*)_](*]SbB*)"},range:A.cursor(i)}}));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}])]}let Dw=class{constructor(t,e,i,n,s){this.view=e,this.visibleValue=t;const r=this;let o,a;this.args=yw(t.str,/\(\*\|\*\)/gm),console.log("creating InstanceWidget"),console.log(r.visibleValue);let l=!0;const h=r.args[0].body.slice(10);if('"'==h.charAt(0)&&(/\(\*/.exec(h)||(l=!1)),l)o=Vw({doc:h,parent:i,update:t=>this.applyChanges(t,0),eval:()=>{e.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowLeft",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.dispatch({selection:{anchor:r.visibleValue.pos}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,e){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return a.dispatch({selection:{anchor:0}}),a.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowDown",run:function(t,e){a.focus()}}])]});else{o={destroy:()=>{},setState:t=>{"string"==typeof t?lw(i.firstChild,t.slice(1,-1),!1):(i.innerHTML="",this.topEditor=new Ts({newState:t,parent:i}))}};const t=document.createElement("span");lw(t,h.slice(1,-1),!1),i.appendChild(t)}l=!0;const c=r.args[2].body.slice(0,-1);if('"'==c.charAt(0)&&(/\(\*/.exec(c)||(l=!1)),l)a=Vw({doc:c,parent:n,update:t=>this.applyChanges(t,2),eval:()=>{e.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowRight",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.dispatch({selection:{anchor:r.visibleValue.pos+r.visibleValue.length}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowLeft",run:function(t,e){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return o.dispatch({selection:{anchor:o.state.doc.length}}),o.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowUp",run:function(t,e){o.focus()}}])]});else{a={destroy:()=>{},setState:t=>{"string"==typeof t?lw(n.firstChild,t.slice(1,-1),!1):(n.innerHTML="",this.bottomEditor=new Ts({newState:t,parent:n}))}};const t=document.createElement("span");lw(t,c.slice(1,-1),!1),n.appendChild(t)}this.topEditor=o,this.bottomEditor=a,r.args[0].length=r.args[0].body.length,r.args[2].length=r.args[2].body.length,delete r.args[2].body,delete r.args[1].body,delete r.args[0].body}applyChanges(t,e){const i=this.args,n=this.visibleValue.argsPos;if(0==e){const e="Subscript["+t,s={from:n+i[0].from,to:n+i[0].from+i[0].length,insert:e};this.visibleValue.str=this.visibleValue.str.substring(0,i[0].from).concat(e,this.visibleValue.str.substring(i[0].from+i[0].length)),i[0].to=i[0].to+(e.length-i[0].length),i[2].from=i[2].from+(e.length-i[0].length);const r=e.length-i[0].length;i[0].length=e.length,this.visibleValue.length=this.visibleValue.length+r,this.view.dispatch({changes:s})}else{const e=t+"]",s={from:n+i[2].from,to:n+i[2].from+i[2].length,insert:e};this.visibleValue.str=this.visibleValue.str.substring(0,i[2].from).concat(e,this.visibleValue.str.substring(i[2].from+i[2].length)),i[2].to=i[2].to+(e.length-i[2].length);const r=e.length-i[2].length;i[2].length=e.length,this.visibleValue.length=this.visibleValue.length+r,this.view.dispatch({changes:s})}}update(t){if(this.visibleValue.str!=t.str){console.warn("Out of sync");const e=this,i=this.view;let n,s;this.visibleValue=t,this.args=yw(t.str,/\(\*\|\*\)/gm),console.log("recreating InstanceWidget"),console.log(e.visibleValue);let r=!0;const o=e.args[0].body.slice(10);'"'==o.charAt(0)&&(/\(\*/.exec(o)||(r=!1)),n=r?Vw.state({doc:o,update:t=>e.applyChanges(t,0),extensions:[Ys.of([{key:"ArrowLeft",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return i.dispatch({selection:{anchor:e.visibleValue.pos}}),i.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.bottomEditor.dispatch({selection:{anchor:0}}),e.bottomEditor.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowDown",run:function(t,i){e.bottomEditor.focus()}}])]}):o,r=!0;const a=e.args[2].body.slice(0,-1);return'"'==a.charAt(0)&&(/\(\*/.exec(a)||(r=!1)),s=r?Vw.state({doc:a,update:t=>e.applyChanges(t,2),extensions:[Ys.of([{key:"ArrowRight",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return i.dispatch({selection:{anchor:e.visibleValue.pos+e.visibleValue.length}}),i.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowLeft",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.topEditor.dispatch({selection:{anchor:e.topEditor.state.doc.length}}),e.topEditor.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowUp",run:function(t,i){e.topEditor.focus()}}])]}):a,this.topEditor.setState(n),this.bottomEditor.setState(s),e.args[0].length=e.args[0].body.length,void(e.args[2].length=e.args[2].body.length)}this.visibleValue.pos=t.pos,this.visibleValue.argsPos=t.argsPos}destroy(){console.warn("destroy Instance of Widget!"),this.topEditor.destroy(),this.bottomEditor.destroy()}},Ww=class extends ei{constructor(t,e,i){super(),this.view=i,this.visibleValue=t,this.reference=e}eq(t){return!1}skipPosition(t,e,i){if(e.from!=e.to||i)return t;if(t.from-e.from>0)this.DOMElement.EditorWidget.topEditor.dispatch({selection:{anchor:0}}),this.DOMElement.EditorWidget.topEditor.focus();else{const t=this.DOMElement.EditorWidget.bottomEditor;t.dispatch({selection:{anchor:t.state.doc.length}}),t.focus()}return e}updateDOM(t,e){return console.log("update widget DOM"),this.DOMElement=t,t.EditorWidget.update(this.visibleValue),!0}toDOM(t){console.log("Create a new one!");const e=document.createElement("span"),i=document.createElement("span");i.classList.add("subscript-tail");const n=document.createElement("sub");n.classList.add("subscript-tail"),e.appendChild(i),e.appendChild(n),e.EditorWidget=new Dw(this.visibleValue,t,i,n,[]);const s=this;return this.reference.push({destroy:()=>{s.destroy(e)}}),this.DOMElement=e,e}ignoreEvent(){return!0}destroy(t){t.EditorWidget.destroy()}};const Uw=(t,e)=>new kw({tag:"SbB",decoration:i=>ni.replace({widget:new Ww(i,t,e)})}),Yw=_i.fromClass(class{constructor(t){this.disposable=[],this.placeholder=Uw(this.disposable,t).createDeco(t)}update(t){this.placeholder=Uw(this.disposable,t).updateDeco(t,this.placeholder)}destroy(){this.disposable.forEach((t=>{t.destroy()}))}},{decorations:t=>t.placeholder,provide:t=>Ts.atomicRanges.of((e=>{var i;return(null===(i=e.plugin(t))||void 0===i?void 0:i.placeholder)||ni.none}))});var qw;function Lw(t){return qw=t,[jw,Ys.of([{key:"Ctrl-6",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((e=>{let{from:i,to:n}=e;const s=t.sliceDoc(i,n);return 0===s.length?{changes:{from:i,to:n,insert:"(*SpB[*)Power[_(*|*),(*|*)_](*]SpB*)"},range:A.cursor(i)}:{changes:{from:i,to:n,insert:"(*SpB[*)Power["+s+"(*|*),(*|*)_](*]SpB*)"},range:A.cursor(i)}}));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}])]}let zw=class{constructor(t,e,i,n,s){this.view=e,this.visibleValue=t;const r=this;let o,a;this.args=yw(t.str,/\(\*\|\*\)/gm),console.log("creating InstanceWidget"),o=qw({doc:r.args[0].body.slice(6),parent:i,update:t=>this.applyChanges(t,0),eval:()=>{e.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowLeft",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.dispatch({selection:{anchor:r.visibleValue.pos}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,e){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return a.dispatch({selection:{anchor:0}}),a.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowUp",run:function(t,e){a.focus()}}])]}),a=qw({doc:r.args[2].body.slice(0,-1),parent:n,update:t=>this.applyChanges(t,2),eval:()=>{e.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowRight",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.dispatch({selection:{anchor:r.visibleValue.pos+r.visibleValue.length}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowLeft",run:function(t,e){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return o.dispatch({selection:{anchor:o.state.doc.length}}),o.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowDown",run:function(t,e){o.focus()}}])]}),this.topEditor=o,this.bottomEditor=a,r.args[0].length=r.args[0].body.length,r.args[2].length=r.args[2].body.length,delete r.args[2].body,delete r.args[1].body,delete r.args[0].body}applyChanges(t,e){const i=this.args,n=this.visibleValue.argsPos;if(0==e){const e="Power["+t,s={from:n+i[0].from,to:n+i[0].from+i[0].length,insert:e};this.visibleValue.str=this.visibleValue.str.substring(0,i[0].from).concat(e,this.visibleValue.str.substring(i[0].from+i[0].length)),i[0].to=i[0].to+(e.length-i[0].length),i[2].from=i[2].from+(e.length-i[0].length);const r=e.length-i[0].length;i[0].length=e.length,this.visibleValue.length=this.visibleValue.length+r,this.view.dispatch({changes:s})}else{const e=t+"]",s={from:n+i[2].from,to:n+i[2].from+i[2].length,insert:e};this.visibleValue.str=this.visibleValue.str.substring(0,i[2].from).concat(e,this.visibleValue.str.substring(i[2].from+i[2].length)),i[2].to=i[2].to+(e.length-i[2].length);const r=e.length-i[2].length;i[2].length=e.length,this.visibleValue.length=this.visibleValue.length+r,this.view.dispatch({changes:s})}}update(t){if(this.visibleValue.str!=t.str){console.warn("Out of sync");const e=this,i=this.view;let n,s;return this.visibleValue=t,this.args=yw(t.str,/\(\*\|\*\)/gm),console.log("recreating InstanceWidget"),n=qw.state({doc:e.args[0].body.slice(6),update:t=>e.applyChanges(t,0),extensions:[Ys.of([{key:"ArrowLeft",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return i.dispatch({selection:{anchor:e.visibleValue.pos}}),i.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.bottomEditor.dispatch({selection:{anchor:0}}),e.bottomEditor.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowUp",run:function(t,i){e.bottomEditor.focus()}}])]}),s=qw.state({doc:e.args[2].body.slice(0,-1),update:t=>e.applyChanges(t,2),extensions:[Ys.of([{key:"ArrowRight",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return i.dispatch({selection:{anchor:e.visibleValue.pos+e.visibleValue.length}}),i.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowLeft",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return e.topEditor.dispatch({selection:{anchor:e.topEditor.state.doc.length}}),e.topEditor.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowDown",run:function(t,i){e.topEditor.focus()}}])]}),this.topEditor.setState(n),this.bottomEditor.setState(s),e.args[0].length=e.args[0].body.length,void(e.args[2].length=e.args[2].body.length)}this.visibleValue.pos=t.pos,this.visibleValue.argsPos=t.argsPos}destroy(){console.warn("destroy Instance of Widget!"),this.topEditor.destroy(),this.bottomEditor.destroy()}},Iw=class extends ei{constructor(t,e,i){super(),this.view=i,this.visibleValue=t,this.reference=e}eq(t){return!1}updateDOM(t,e){return console.log("update widget DOM"),this.DOMElement=t,t.EditorWidget.update(this.visibleValue),!0}toDOM(t){console.log("Create a new one!");const e=document.createElement("span"),i=document.createElement("span");i.classList.add("subscript-tail");const n=document.createElement("sup");n.classList.add("subscript-tail"),e.appendChild(i),e.appendChild(n),e.EditorWidget=new zw(this.visibleValue,t,i,n,[]);const s=this;return this.reference.push({destroy:()=>{s.destroy(e)}}),this.DOMElement=e,e}ignoreEvent(){return!0}skipPosition(t,e,i){if(e.from!=e.to||i)return t;if(t.from-e.from>0)this.DOMElement.EditorWidget.topEditor.dispatch({selection:{anchor:0}}),this.DOMElement.EditorWidget.topEditor.focus();else{const t=this.DOMElement.EditorWidget.bottomEditor;t.dispatch({selection:{anchor:t.state.doc.length}}),t.focus()}return e}destroy(t){t.EditorWidget.destroy()}};const Bw=(t,e)=>new kw({tag:"SpB",decoration:i=>ni.replace({widget:new Iw(i,t,e)})}),jw=_i.fromClass(class{constructor(t){this.disposable=[],this.placeholder=Bw(this.disposable,t).createDeco(t)}update(t){this.placeholder=Bw(this.disposable,t).updateDeco(t,this.placeholder)}destroy(){this.disposable.forEach((t=>{t.destroy()}))}},{decorations:t=>t.placeholder,provide:t=>Ts.atomicRanges.of((e=>{var i;return(null===(i=e.plugin(t))||void 0===i?void 0:i.placeholder)||ni.none}))});var Nw={},Gw={},Hw={},Fw={};function Jw(t){let e=t.length;for(;--e>=0;)t[e]=0}const Kw=256,tb=286,eb=30,ib=15,nb=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),sb=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),rb=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ob=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ab=new Array(576);Jw(ab);const lb=new Array(60);Jw(lb);const hb=new Array(512);Jw(hb);const cb=new Array(256);Jw(cb);const db=new Array(29);Jw(db);const ub=new Array(eb);function fb(t,e,i,n,s){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=s,this.has_stree=t&&t.length}let pb,Ob,gb;function mb(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}Jw(ub);const wb=t=>t<256?hb[t]:hb[256+(t>>>7)],bb=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},vb=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,bb(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},yb=(t,e,i)=>{vb(t,i[2*e],i[2*e+1])},Sb=(t,e)=>{let i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1},xb=(t,e,i)=>{const n=new Array(16);let s,r,o=0;for(s=1;s<=ib;s++)o=o+i[s-1]<<1,n[s]=o;for(r=0;r<=e;r++){let e=t[2*r+1];0!==e&&(t[2*r]=Sb(n[e]++,e))}},kb=t=>{let e;for(e=0;e<tb;e++)t.dyn_ltree[2*e]=0;for(e=0;e<eb;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Qb=t=>{t.bi_valid>8?bb(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},$b=(t,e,i,n)=>{const s=2*e,r=2*i;return t[s]<t[r]||t[s]===t[r]&&n[e]<=n[i]},Pb=(t,e,i)=>{const n=t.heap[i];let s=i<<1;for(;s<=t.heap_len&&(s<t.heap_len&&$b(e,t.heap[s+1],t.heap[s],t.depth)&&s++,!$b(e,n,t.heap[s],t.depth));)t.heap[i]=t.heap[s],i=s,s<<=1;t.heap[i]=n},Cb=(t,e,i)=>{let n,s,r,o,a=0;if(0!==t.sym_next)do{n=255&t.pending_buf[t.sym_buf+a++],n+=(255&t.pending_buf[t.sym_buf+a++])<<8,s=t.pending_buf[t.sym_buf+a++],0===n?yb(t,s,e):(r=cb[s],yb(t,r+Kw+1,e),o=nb[r],0!==o&&(s-=db[r],vb(t,s,o)),n--,r=wb(n),yb(t,r,i),o=sb[r],0!==o&&(n-=ub[r],vb(t,n,o)))}while(a<t.sym_next);yb(t,256,e)},_b=(t,e)=>{const i=e.dyn_tree,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,r=e.stat_desc.elems;let o,a,l,h=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<r;o++)0!==i[2*o]?(t.heap[++t.heap_len]=h=o,t.depth[o]=0):i[2*o+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=h<2?++h:0,i[2*l]=1,t.depth[l]=0,t.opt_len--,s&&(t.static_len-=n[2*l+1]);for(e.max_code=h,o=t.heap_len>>1;o>=1;o--)Pb(t,i,o);l=r;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Pb(t,i,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,i[2*l]=i[2*o]+i[2*a],t.depth[l]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,i[2*o+1]=i[2*a+1]=l,t.heap[1]=l++,Pb(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const i=e.dyn_tree,n=e.max_code,s=e.stat_desc.static_tree,r=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length;let h,c,d,u,f,p,O=0;for(u=0;u<=ib;u++)t.bl_count[u]=0;for(i[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)c=t.heap[h],u=i[2*i[2*c+1]+1]+1,u>l&&(u=l,O++),i[2*c+1]=u,c>n||(t.bl_count[u]++,f=0,c>=a&&(f=o[c-a]),p=i[2*c],t.opt_len+=p*(u+f),r&&(t.static_len+=p*(s[2*c+1]+f)));if(0!==O){do{for(u=l-1;0===t.bl_count[u];)u--;t.bl_count[u]--,t.bl_count[u+1]+=2,t.bl_count[l]--,O-=2}while(O>0);for(u=l;0!==u;u--)for(c=t.bl_count[u];0!==c;)d=t.heap[--h],d>n||(i[2*d+1]!==u&&(t.opt_len+=(u-i[2*d+1])*i[2*d],i[2*d+1]=u),c--)}})(t,e),xb(i,h,t.bl_count)},Xb=(t,e,i)=>{let n,s,r=-1,o=e[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)s=o,o=e[2*(n+1)+1],++a<l&&s===o||(a<h?t.bl_tree[2*s]+=a:0!==s?(s!==r&&t.bl_tree[2*s]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=s,0===o?(l=138,h=3):s===o?(l=6,h=3):(l=7,h=4))},Zb=(t,e,i)=>{let n,s,r=-1,o=e[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),n=0;n<=i;n++)if(s=o,o=e[2*(n+1)+1],!(++a<l&&s===o)){if(a<h)do{yb(t,s,t.bl_tree)}while(0!=--a);else 0!==s?(s!==r&&(yb(t,s,t.bl_tree),a--),yb(t,16,t.bl_tree),vb(t,a-3,2)):a<=10?(yb(t,17,t.bl_tree),vb(t,a-3,3)):(yb(t,18,t.bl_tree),vb(t,a-11,7));a=0,r=s,0===o?(l=138,h=3):s===o?(l=6,h=3):(l=7,h=4)}};let Ab=!1;const Tb=(t,e,i,n)=>{vb(t,0+(n?1:0),3),Qb(t),bb(t,i),bb(t,~i),i&&t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i};Fw._tr_init=t=>{Ab||((()=>{let t,e,i,n,s;const r=new Array(16);for(i=0,n=0;n<28;n++)for(db[n]=i,t=0;t<1<<nb[n];t++)cb[i++]=n;for(cb[i-1]=n,s=0,n=0;n<16;n++)for(ub[n]=s,t=0;t<1<<sb[n];t++)hb[s++]=n;for(s>>=7;n<eb;n++)for(ub[n]=s<<7,t=0;t<1<<sb[n]-7;t++)hb[256+s++]=n;for(e=0;e<=ib;e++)r[e]=0;for(t=0;t<=143;)ab[2*t+1]=8,t++,r[8]++;for(;t<=255;)ab[2*t+1]=9,t++,r[9]++;for(;t<=279;)ab[2*t+1]=7,t++,r[7]++;for(;t<=287;)ab[2*t+1]=8,t++,r[8]++;for(xb(ab,287,r),t=0;t<eb;t++)lb[2*t+1]=5,lb[2*t]=Sb(t,5);pb=new fb(ab,nb,257,tb,ib),Ob=new fb(lb,sb,0,eb,ib),gb=new fb(new Array(0),rb,0,19,7)})(),Ab=!0),t.l_desc=new mb(t.dyn_ltree,pb),t.d_desc=new mb(t.dyn_dtree,Ob),t.bl_desc=new mb(t.bl_tree,gb),t.bi_buf=0,t.bi_valid=0,kb(t)},Fw._tr_stored_block=Tb,Fw._tr_flush_block=(t,e,i,n)=>{let s,r,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<Kw;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),_b(t,t.l_desc),_b(t,t.d_desc),o=(t=>{let e;for(Xb(t,t.dyn_ltree,t.l_desc.max_code),Xb(t,t.dyn_dtree,t.d_desc.max_code),_b(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*ob[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),s=t.opt_len+3+7>>>3,r=t.static_len+3+7>>>3,r<=s&&(s=r)):s=r=i+5,i+4<=s&&-1!==e?Tb(t,e,i,n):4===t.strategy||r===s?(vb(t,2+(n?1:0),3),Cb(t,ab,lb)):(vb(t,4+(n?1:0),3),((t,e,i,n)=>{let s;for(vb(t,e-257,5),vb(t,i-1,5),vb(t,n-4,4),s=0;s<n;s++)vb(t,t.bl_tree[2*ob[s]+1],3);Zb(t,t.dyn_ltree,e-1),Zb(t,t.dyn_dtree,i-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),Cb(t,t.dyn_ltree,t.dyn_dtree)),kb(t),n&&Qb(t)},Fw._tr_tally=(t,e,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(cb[i]+Kw+1)]++,t.dyn_dtree[2*wb(e)]++),t.sym_next===t.sym_end),Fw._tr_align=t=>{vb(t,2,3),yb(t,256,ab),(t=>{16===t.bi_valid?(bb(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)};var Rb=(t,e,i,n)=>{let s=65535&t|0,r=t>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{s=s+e[n++]|0,r=r+s|0}while(--o);s%=65521,r%=65521}return s|r<<16|0};const Eb=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var Vb=(t,e,i,n)=>{const s=Eb,r=n+i;t^=-1;for(let i=n;i<r;i++)t=t>>>8^s[255&(t^e[i])];return-1^t},Mb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Db={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Wb,_tr_stored_block:Ub,_tr_flush_block:Yb,_tr_tally:qb,_tr_align:Lb}=Fw,zb=Rb,Ib=Vb,Bb=Mb,{Z_NO_FLUSH:jb,Z_PARTIAL_FLUSH:Nb,Z_FULL_FLUSH:Gb,Z_FINISH:Hb,Z_BLOCK:Fb,Z_OK:Jb,Z_STREAM_END:Kb,Z_STREAM_ERROR:tv,Z_DATA_ERROR:ev,Z_BUF_ERROR:iv,Z_DEFAULT_COMPRESSION:nv,Z_FILTERED:sv,Z_HUFFMAN_ONLY:rv,Z_RLE:ov,Z_FIXED:av,Z_DEFAULT_STRATEGY:lv,Z_UNKNOWN:hv,Z_DEFLATED:cv}=Db,dv=258,uv=262,fv=42,pv=113,Ov=666,gv=(t,e)=>(t.msg=Bb[e],e),mv=t=>2*t-(t>4?9:0),wv=t=>{let e=t.length;for(;--e>=0;)t[e]=0},bv=t=>{let e,i,n,s=t.w_size;e=t.hash_size,n=e;do{i=t.head[--n],t.head[n]=i>=s?i-s:0}while(--e);e=s,n=e;do{i=t.prev[--n],t.prev[n]=i>=s?i-s:0}while(--e)};let vv=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const yv=t=>{const e=t.state;let i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))},Sv=(t,e)=>{Yb(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,yv(t.strm)},xv=(t,e)=>{t.pending_buf[t.pending++]=e},kv=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Qv=(t,e,i,n)=>{let s=t.avail_in;return s>n&&(s=n),0===s?0:(t.avail_in-=s,e.set(t.input.subarray(t.next_in,t.next_in+s),i),1===t.state.wrap?t.adler=zb(t.adler,e,s,i):2===t.state.wrap&&(t.adler=Ib(t.adler,e,s,i)),t.next_in+=s,t.total_in+=s,s)},$v=(t,e)=>{let i,n,s=t.max_chain_length,r=t.strstart,o=t.prev_length,a=t.nice_match;const l=t.strstart>t.w_size-uv?t.strstart-(t.w_size-uv):0,h=t.window,c=t.w_mask,d=t.prev,u=t.strstart+dv;let f=h[r+o-1],p=h[r+o];t.prev_length>=t.good_match&&(s>>=2),a>t.lookahead&&(a=t.lookahead);do{if(i=e,h[i+o]===p&&h[i+o-1]===f&&h[i]===h[r]&&h[++i]===h[r+1]){r+=2,i++;do{}while(h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&r<u);if(n=dv-(u-r),r=u-dv,n>o){if(t.match_start=e,o=n,n>=a)break;f=h[r+o-1],p=h[r+o]}}}while((e=d[e&c])>l&&0!=--s);return o<=t.lookahead?o:t.lookahead},Pv=t=>{const e=t.w_size;let i,n,s;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-uv)&&(t.window.set(t.window.subarray(e,e+e-n),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),bv(t),n+=e),0===t.strm.avail_in)break;if(i=Qv(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=i,t.lookahead+t.insert>=3)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=vv(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=vv(t,t.ins_h,t.window[s+3-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<uv&&0!==t.strm.avail_in)},Cv=(t,e)=>{let i,n,s,r=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,a=t.strm.avail_in;do{if(i=65535,s=t.bi_valid+42>>3,t.strm.avail_out<s)break;if(s=t.strm.avail_out-s,n=t.strstart-t.block_start,i>n+t.strm.avail_in&&(i=n+t.strm.avail_in),i>s&&(i=s),i<r&&(0===i&&e!==Hb||e===jb||i!==n+t.strm.avail_in))break;o=e===Hb&&i===n+t.strm.avail_in?1:0,Ub(t,0,0,o),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,yv(t.strm),n&&(n>i&&(n=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+n),t.strm.next_out),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n,t.block_start+=n,i-=n),i&&(Qv(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===o);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?4:e!==jb&&e!==Hb&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(s=t.window_size-t.strstart,t.strm.avail_in>s&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,s+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),s>t.strm.avail_in&&(s=t.strm.avail_in),s&&(Qv(t.strm,t.window,t.strstart,s),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.high_water<t.strstart&&(t.high_water=t.strstart),s=t.bi_valid+42>>3,s=t.pending_buf_size-s>65535?65535:t.pending_buf_size-s,r=s>t.w_size?t.w_size:s,n=t.strstart-t.block_start,(n>=r||(n||e===Hb)&&e!==jb&&0===t.strm.avail_in&&n<=s)&&(i=n>s?s:n,o=e===Hb&&0===t.strm.avail_in&&i===n?1:0,Ub(t,t.block_start,i,o),t.block_start+=i,yv(t.strm)),o?3:1)},_v=(t,e)=>{let i,n;for(;;){if(t.lookahead<uv){if(Pv(t),t.lookahead<uv&&e===jb)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=vv(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-uv&&(t.match_length=$v(t,i)),t.match_length>=3)if(n=qb(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=vv(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=vv(t,t.ins_h,t.window[t.strstart+1]);else n=qb(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Sv(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===Hb?(Sv(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Sv(t,!1),0===t.strm.avail_out)?1:2},Xv=(t,e)=>{let i,n,s;for(;;){if(t.lookahead<uv){if(Pv(t),t.lookahead<uv&&e===jb)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=vv(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-uv&&(t.match_length=$v(t,i),t.match_length<=5&&(t.strategy===sv||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){s=t.strstart+t.lookahead-3,n=qb(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=s&&(t.ins_h=vv(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(Sv(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(n=qb(t,0,t.window[t.strstart-1]),n&&Sv(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=qb(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===Hb?(Sv(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Sv(t,!1),0===t.strm.avail_out)?1:2};function Zv(t,e,i,n,s){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=s}const Av=[new Zv(0,0,0,0,Cv),new Zv(4,4,8,4,_v),new Zv(4,5,16,8,_v),new Zv(4,6,32,32,_v),new Zv(4,4,16,16,Xv),new Zv(8,16,32,32,Xv),new Zv(8,16,128,128,Xv),new Zv(8,32,128,256,Xv),new Zv(32,128,258,1024,Xv),new Zv(32,258,258,4096,Xv)];function Tv(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=cv,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),wv(this.dyn_ltree),wv(this.dyn_dtree),wv(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),wv(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),wv(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Rv=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==fv&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==pv&&e.status!==Ov?1:0},Ev=t=>{if(Rv(t))return gv(t,tv);t.total_in=t.total_out=0,t.data_type=hv;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?fv:pv,t.adler=2===e.wrap?0:1,e.last_flush=-2,Wb(e),Jb},Vv=t=>{const e=Ev(t);var i;return e===Jb&&((i=t.state).window_size=2*i.w_size,wv(i.head),i.max_lazy_match=Av[i.level].max_lazy,i.good_match=Av[i.level].good_length,i.nice_match=Av[i.level].nice_length,i.max_chain_length=Av[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),e},Mv=(t,e,i,n,s,r)=>{if(!t)return tv;let o=1;if(e===nv&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>9||i!==cv||n<8||n>15||e<0||e>9||r<0||r>av||8===n&&1!==o)return gv(t,tv);8===n&&(n=9);const a=new Tv;return t.state=a,a.strm=t,a.status=fv,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=e,a.strategy=r,a.method=i,Vv(t)};Hw.deflateInit=(t,e)=>Mv(t,e,cv,15,8,lv),Hw.deflateInit2=Mv,Hw.deflateReset=Vv,Hw.deflateResetKeep=Ev,Hw.deflateSetHeader=(t,e)=>Rv(t)||2!==t.state.wrap?tv:(t.state.gzhead=e,Jb),Hw.deflate=(t,e)=>{if(Rv(t)||e>Fb||e<0)return t?gv(t,tv):tv;const i=t.state;if(!t.output||0!==t.avail_in&&!t.input||i.status===Ov&&e!==Hb)return gv(t,0===t.avail_out?iv:tv);const n=i.last_flush;if(i.last_flush=e,0!==i.pending){if(yv(t),0===t.avail_out)return i.last_flush=-1,Jb}else if(0===t.avail_in&&mv(e)<=mv(n)&&e!==Hb)return gv(t,iv);if(i.status===Ov&&0!==t.avail_in)return gv(t,iv);if(i.status===fv&&0===i.wrap&&(i.status=pv),i.status===fv){let e=cv+(i.w_bits-8<<4)<<8,n=-1;if(n=i.strategy>=rv||i.level<2?0:i.level<6?1:6===i.level?2:3,e|=n<<6,0!==i.strstart&&(e|=32),e+=31-e%31,kv(i,e),0!==i.strstart&&(kv(i,t.adler>>>16),kv(i,65535&t.adler)),t.adler=1,i.status=pv,yv(t),0!==i.pending)return i.last_flush=-1,Jb}if(57===i.status)if(t.adler=0,xv(i,31),xv(i,139),xv(i,8),i.gzhead)xv(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),xv(i,255&i.gzhead.time),xv(i,i.gzhead.time>>8&255),xv(i,i.gzhead.time>>16&255),xv(i,i.gzhead.time>>24&255),xv(i,9===i.level?2:i.strategy>=rv||i.level<2?4:0),xv(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(xv(i,255&i.gzhead.extra.length),xv(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=Ib(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(xv(i,0),xv(i,0),xv(i,0),xv(i,0),xv(i,0),xv(i,9===i.level?2:i.strategy>=rv||i.level<2?4:0),xv(i,3),i.status=pv,yv(t),0!==i.pending)return i.last_flush=-1,Jb;if(69===i.status){if(i.gzhead.extra){let e=i.pending,n=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+n>i.pending_buf_size;){let s=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+s),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>e&&(t.adler=Ib(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex+=s,yv(t),0!==i.pending)return i.last_flush=-1,Jb;e=0,n-=s}let s=new Uint8Array(i.gzhead.extra);i.pending_buf.set(s.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending+=n,i.gzhead.hcrc&&i.pending>e&&(t.adler=Ib(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let e,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(t.adler=Ib(t.adler,i.pending_buf,i.pending-n,n)),yv(t),0!==i.pending)return i.last_flush=-1,Jb;n=0}e=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,xv(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>n&&(t.adler=Ib(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let e,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(t.adler=Ib(t.adler,i.pending_buf,i.pending-n,n)),yv(t),0!==i.pending)return i.last_flush=-1,Jb;n=0}e=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,xv(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>n&&(t.adler=Ib(t.adler,i.pending_buf,i.pending-n,n))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(yv(t),0!==i.pending))return i.last_flush=-1,Jb;xv(i,255&t.adler),xv(i,t.adler>>8&255),t.adler=0}if(i.status=pv,yv(t),0!==i.pending)return i.last_flush=-1,Jb}if(0!==t.avail_in||0!==i.lookahead||e!==jb&&i.status!==Ov){let n=0===i.level?Cv(i,e):i.strategy===rv?((t,e)=>{let i;for(;;){if(0===t.lookahead&&(Pv(t),0===t.lookahead)){if(e===jb)return 1;break}if(t.match_length=0,i=qb(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(Sv(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Hb?(Sv(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Sv(t,!1),0===t.strm.avail_out)?1:2})(i,e):i.strategy===ov?((t,e)=>{let i,n,s,r;const o=t.window;for(;;){if(t.lookahead<=dv){if(Pv(t),t.lookahead<=dv&&e===jb)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(s=t.strstart-1,n=o[s],n===o[++s]&&n===o[++s]&&n===o[++s])){r=t.strstart+dv;do{}while(n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&s<r);t.match_length=dv-(r-s),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=qb(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=qb(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(Sv(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Hb?(Sv(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Sv(t,!1),0===t.strm.avail_out)?1:2})(i,e):Av[i.level].func(i,e);if(3!==n&&4!==n||(i.status=Ov),1===n||3===n)return 0===t.avail_out&&(i.last_flush=-1),Jb;if(2===n&&(e===Nb?Lb(i):e!==Fb&&(Ub(i,0,0,!1),e===Gb&&(wv(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),yv(t),0===t.avail_out))return i.last_flush=-1,Jb}return e!==Hb?Jb:i.wrap<=0?Kb:(2===i.wrap?(xv(i,255&t.adler),xv(i,t.adler>>8&255),xv(i,t.adler>>16&255),xv(i,t.adler>>24&255),xv(i,255&t.total_in),xv(i,t.total_in>>8&255),xv(i,t.total_in>>16&255),xv(i,t.total_in>>24&255)):(kv(i,t.adler>>>16),kv(i,65535&t.adler)),yv(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?Jb:Kb)},Hw.deflateEnd=t=>{if(Rv(t))return tv;const e=t.state.status;return t.state=null,e===pv?gv(t,ev):Jb},Hw.deflateSetDictionary=(t,e)=>{let i=e.length;if(Rv(t))return tv;const n=t.state,s=n.wrap;if(2===s||1===s&&n.status!==fv||n.lookahead)return tv;if(1===s&&(t.adler=zb(t.adler,e,i,0)),n.wrap=0,i>=n.w_size){0===s&&(wv(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(i-n.w_size,i),0),e=t,i=n.w_size}const r=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,Pv(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do{n.ins_h=vv(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++}while(--e);n.strstart=t,n.lookahead=2,Pv(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=o,t.input=a,t.avail_in=r,n.wrap=s,Jb},Hw.deflateInfo="pako deflate (from Nodeca project)";var Dv={};const Wv=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);Dv.assign=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const e in i)Wv(i,e)&&(t[e]=i[e])}}return t},Dv.flattenChunks=t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const i=new Uint8Array(e);for(let e=0,n=0,s=t.length;e<s;e++){let s=t[e];i.set(s,n),n+=s.length}return i};var Uv={};let Yv=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Yv=!1}const qv=new Uint8Array(256);for(let t=0;t<256;t++)qv[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;qv[254]=qv[254]=1,Uv.string2buf=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,i,n,s,r,o=t.length,a=0;for(s=0;s<o;s++)i=t.charCodeAt(s),55296==(64512&i)&&s+1<o&&(n=t.charCodeAt(s+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),s++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(a),r=0,s=0;r<a;s++)i=t.charCodeAt(s),55296==(64512&i)&&s+1<o&&(n=t.charCodeAt(s+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),s++)),i<128?e[r++]=i:i<2048?(e[r++]=192|i>>>6,e[r++]=128|63&i):i<65536?(e[r++]=224|i>>>12,e[r++]=128|i>>>6&63,e[r++]=128|63&i):(e[r++]=240|i>>>18,e[r++]=128|i>>>12&63,e[r++]=128|i>>>6&63,e[r++]=128|63&i);return e};Uv.buf2string=(t,e)=>{const i=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let n,s;const r=new Array(2*i);for(s=0,n=0;n<i;){let e=t[n++];if(e<128){r[s++]=e;continue}let o=qv[e];if(o>4)r[s++]=65533,n+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&n<i;)e=e<<6|63&t[n++],o--;o>1?r[s++]=65533:e<65536?r[s++]=e:(e-=65536,r[s++]=55296|e>>10&1023,r[s++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Yv)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i="";for(let n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i})(r,s)},Uv.utf8border=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+qv[t[i]]>e?i:e};var Lv=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const zv=Hw,Iv=Dv,Bv=Uv,jv=Mb,Nv=Lv,Gv=Object.prototype.toString,{Z_NO_FLUSH:Hv,Z_SYNC_FLUSH:Fv,Z_FULL_FLUSH:Jv,Z_FINISH:Kv,Z_OK:ty,Z_STREAM_END:ey,Z_DEFAULT_COMPRESSION:iy,Z_DEFAULT_STRATEGY:ny,Z_DEFLATED:sy}=Db;function ry(t){this.options=Iv.assign({level:iy,method:sy,chunkSize:16384,windowBits:15,memLevel:8,strategy:ny},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Nv,this.strm.avail_out=0;let i=zv.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==ty)throw new Error(jv[i]);if(e.header&&zv.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Bv.string2buf(e.dictionary):"[object ArrayBuffer]"===Gv.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,i=zv.deflateSetDictionary(this.strm,t),i!==ty)throw new Error(jv[i]);this._dict_set=!0}}function oy(t,e){const i=new ry(e);if(i.push(t,!0),i.err)throw i.msg||jv[i.err];return i.result}ry.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize;let s,r;if(this.ended)return!1;for(r=e===~~e?e:!0===e?Kv:Hv,"string"==typeof t?i.input=Bv.string2buf(t):"[object ArrayBuffer]"===Gv.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(r===Fv||r===Jv)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(s=zv.deflate(i,r),s===ey)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),s=zv.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===ty;if(0!==i.avail_out){if(r>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},ry.prototype.onData=function(t){this.chunks.push(t)},ry.prototype.onEnd=function(t){t===ty&&(this.result=Iv.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},Gw.Deflate=ry,Gw.deflate=oy,Gw.deflateRaw=function(t,e){return(e=e||{}).raw=!0,oy(t,e)},Gw.gzip=function(t,e){return(e=e||{}).gzip=!0,oy(t,e)},Gw.constants=Db;var ay={},ly={};const hy=16209;const cy=15,dy=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),uy=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),fy=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),py=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Oy=(t,e,i,n,s,r,o,a)=>{const l=a.bits;let h,c,d,u,f,p,O=0,g=0,m=0,w=0,b=0,v=0,y=0,S=0,x=0,k=0,Q=null;const $=new Uint16Array(16),P=new Uint16Array(16);let C,_,X,Z=null;for(O=0;O<=cy;O++)$[O]=0;for(g=0;g<n;g++)$[e[i+g]]++;for(b=l,w=cy;w>=1&&0===$[w];w--);if(b>w&&(b=w),0===w)return s[r++]=20971520,s[r++]=20971520,a.bits=1,0;for(m=1;m<w&&0===$[m];m++);for(b<m&&(b=m),S=1,O=1;O<=cy;O++)if(S<<=1,S-=$[O],S<0)return-1;if(S>0&&(0===t||1!==w))return-1;for(P[1]=0,O=1;O<cy;O++)P[O+1]=P[O]+$[O];for(g=0;g<n;g++)0!==e[i+g]&&(o[P[e[i+g]]++]=g);if(0===t?(Q=Z=o,p=20):1===t?(Q=dy,Z=uy,p=257):(Q=fy,Z=py,p=0),k=0,g=0,O=m,f=r,v=b,y=0,d=-1,x=1<<b,u=x-1,1===t&&x>852||2===t&&x>592)return 1;for(;;){C=O-y,o[g]+1<p?(_=0,X=o[g]):o[g]>=p?(_=Z[o[g]-p],X=Q[o[g]-p]):(_=96,X=0),h=1<<O-y,c=1<<v,m=c;do{c-=h,s[f+(k>>y)+c]=C<<24|_<<16|X|0}while(0!==c);for(h=1<<O-1;k&h;)h>>=1;if(0!==h?(k&=h-1,k+=h):k=0,g++,0==--$[O]){if(O===w)break;O=e[i+o[g]]}if(O>b&&(k&u)!==d){for(0===y&&(y=b),f+=m,v=O-y,S=1<<v;v+y<w&&(S-=$[v+y],!(S<=0));)v++,S<<=1;if(x+=1<<v,1===t&&x>852||2===t&&x>592)return 1;d=k&u,s[d]=b<<24|v<<16|f-r|0}}return 0!==k&&(s[f+k]=O-y<<24|64<<16|0),a.bits=b,0};const gy=Rb,my=Vb,wy=function(t,e){let i,n,s,r,o,a,l,h,c,d,u,f,p,O,g,m,w,b,v,y,S,x,k,Q;const $=t.state;i=t.next_in,k=t.input,n=i+(t.avail_in-5),s=t.next_out,Q=t.output,r=s-(e-t.avail_out),o=s+(t.avail_out-257),a=$.dmax,l=$.wsize,h=$.whave,c=$.wnext,d=$.window,u=$.hold,f=$.bits,p=$.lencode,O=$.distcode,g=(1<<$.lenbits)-1,m=(1<<$.distbits)-1;t:do{f<15&&(u+=k[i++]<<f,f+=8,u+=k[i++]<<f,f+=8),w=p[u&g];e:for(;;){if(b=w>>>24,u>>>=b,f-=b,b=w>>>16&255,0===b)Q[s++]=65535&w;else{if(!(16&b)){if(0==(64&b)){w=p[(65535&w)+(u&(1<<b)-1)];continue e}if(32&b){$.mode=16191;break t}t.msg="invalid literal/length code",$.mode=hy;break t}v=65535&w,b&=15,b&&(f<b&&(u+=k[i++]<<f,f+=8),v+=u&(1<<b)-1,u>>>=b,f-=b),f<15&&(u+=k[i++]<<f,f+=8,u+=k[i++]<<f,f+=8),w=O[u&m];i:for(;;){if(b=w>>>24,u>>>=b,f-=b,b=w>>>16&255,!(16&b)){if(0==(64&b)){w=O[(65535&w)+(u&(1<<b)-1)];continue i}t.msg="invalid distance code",$.mode=hy;break t}if(y=65535&w,b&=15,f<b&&(u+=k[i++]<<f,f+=8,f<b&&(u+=k[i++]<<f,f+=8)),y+=u&(1<<b)-1,y>a){t.msg="invalid distance too far back",$.mode=hy;break t}if(u>>>=b,f-=b,b=s-r,y>b){if(b=y-b,b>h&&$.sane){t.msg="invalid distance too far back",$.mode=hy;break t}if(S=0,x=d,0===c){if(S+=l-b,b<v){v-=b;do{Q[s++]=d[S++]}while(--b);S=s-y,x=Q}}else if(c<b){if(S+=l+c-b,b-=c,b<v){v-=b;do{Q[s++]=d[S++]}while(--b);if(S=0,c<v){b=c,v-=b;do{Q[s++]=d[S++]}while(--b);S=s-y,x=Q}}}else if(S+=c-b,b<v){v-=b;do{Q[s++]=d[S++]}while(--b);S=s-y,x=Q}for(;v>2;)Q[s++]=x[S++],Q[s++]=x[S++],Q[s++]=x[S++],v-=3;v&&(Q[s++]=x[S++],v>1&&(Q[s++]=x[S++]))}else{S=s-y;do{Q[s++]=Q[S++],Q[s++]=Q[S++],Q[s++]=Q[S++],v-=3}while(v>2);v&&(Q[s++]=Q[S++],v>1&&(Q[s++]=Q[S++]))}break}}break}}while(i<n&&s<o);v=f>>3,i-=v,f-=v<<3,u&=(1<<f)-1,t.next_in=i,t.next_out=s,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=s<o?o-s+257:257-(s-o),$.hold=u,$.bits=f},by=Oy,{Z_FINISH:vy,Z_BLOCK:yy,Z_TREES:Sy,Z_OK:xy,Z_STREAM_END:ky,Z_NEED_DICT:Qy,Z_STREAM_ERROR:$y,Z_DATA_ERROR:Py,Z_MEM_ERROR:Cy,Z_BUF_ERROR:_y,Z_DEFLATED:Xy}=Db,Zy=16180,Ay=16190,Ty=16191,Ry=16192,Ey=16194,Vy=16199,My=16200,Dy=16206,Wy=16209,Uy=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Yy(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qy=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Zy||e.mode>16211?1:0},Ly=t=>{if(qy(t))return $y;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=Zy,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,xy},zy=t=>{if(qy(t))return $y;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Ly(t)},Iy=(t,e)=>{let i;if(qy(t))return $y;const n=t.state;return e<0?(i=0,e=-e):(i=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?$y:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,zy(t))},By=(t,e)=>{if(!t)return $y;const i=new Yy;t.state=i,i.strm=t,i.window=null,i.mode=Zy;const n=Iy(t,e);return n!==xy&&(t.state=null),n};let jy,Ny,Gy=!0;const Hy=t=>{if(Gy){jy=new Int32Array(512),Ny=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(by(1,t.lens,0,288,jy,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;by(2,t.lens,0,32,Ny,0,t.work,{bits:5}),Gy=!1}t.lencode=jy,t.lenbits=9,t.distcode=Ny,t.distbits=5},Fy=(t,e,i,n)=>{let s;const r=t.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),n>=r.wsize?(r.window.set(e.subarray(i-r.wsize,i),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>n&&(s=n),r.window.set(e.subarray(i-n,i-n+s),r.wnext),(n-=s)?(r.window.set(e.subarray(i-n,i),0),r.wnext=n,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0};ly.inflateReset=zy,ly.inflateReset2=Iy,ly.inflateResetKeep=Ly,ly.inflateInit=t=>By(t,15),ly.inflateInit2=By,ly.inflate=(t,e)=>{let i,n,s,r,o,a,l,h,c,d,u,f,p,O,g,m,w,b,v,y,S,x,k=0;const Q=new Uint8Array(4);let $,P;const C=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qy(t)||!t.output||!t.input&&0!==t.avail_in)return $y;i=t.state,i.mode===Ty&&(i.mode=Ry),o=t.next_out,s=t.output,l=t.avail_out,r=t.next_in,n=t.input,a=t.avail_in,h=i.hold,c=i.bits,d=a,u=l,x=xy;t:for(;;)switch(i.mode){case Zy:if(0===i.wrap){i.mode=Ry;break}for(;c<16;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if(2&i.wrap&&35615===h){0===i.wbits&&(i.wbits=15),i.check=0,Q[0]=255&h,Q[1]=h>>>8&255,i.check=my(i.check,Q,2,0),h=0,c=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",i.mode=Wy;break}if((15&h)!==Xy){t.msg="unknown compression method",i.mode=Wy;break}if(h>>>=4,c-=4,S=8+(15&h),0===i.wbits&&(i.wbits=S),S>15||S>i.wbits){t.msg="invalid window size",i.mode=Wy;break}i.dmax=1<<i.wbits,i.flags=0,t.adler=i.check=1,i.mode=512&h?16189:Ty,h=0,c=0;break;case 16181:for(;c<16;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if(i.flags=h,(255&i.flags)!==Xy){t.msg="unknown compression method",i.mode=Wy;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=Wy;break}i.head&&(i.head.text=h>>8&1),512&i.flags&&4&i.wrap&&(Q[0]=255&h,Q[1]=h>>>8&255,i.check=my(i.check,Q,2,0)),h=0,c=0,i.mode=16182;case 16182:for(;c<32;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}i.head&&(i.head.time=h),512&i.flags&&4&i.wrap&&(Q[0]=255&h,Q[1]=h>>>8&255,Q[2]=h>>>16&255,Q[3]=h>>>24&255,i.check=my(i.check,Q,4,0)),h=0,c=0,i.mode=16183;case 16183:for(;c<16;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}i.head&&(i.head.xflags=255&h,i.head.os=h>>8),512&i.flags&&4&i.wrap&&(Q[0]=255&h,Q[1]=h>>>8&255,i.check=my(i.check,Q,2,0)),h=0,c=0,i.mode=16184;case 16184:if(1024&i.flags){for(;c<16;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}i.length=h,i.head&&(i.head.extra_len=h),512&i.flags&&4&i.wrap&&(Q[0]=255&h,Q[1]=h>>>8&255,i.check=my(i.check,Q,2,0)),h=0,c=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(f=i.length,f>a&&(f=a),f&&(i.head&&(S=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(r,r+f),S)),512&i.flags&&4&i.wrap&&(i.check=my(i.check,n,f,r)),a-=f,r+=f,i.length-=f),i.length))break t;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===a)break t;f=0;do{S=n[r+f++],i.head&&S&&i.length<65536&&(i.head.name+=String.fromCharCode(S))}while(S&&f<a);if(512&i.flags&&4&i.wrap&&(i.check=my(i.check,n,f,r)),a-=f,r+=f,S)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===a)break t;f=0;do{S=n[r+f++],i.head&&S&&i.length<65536&&(i.head.comment+=String.fromCharCode(S))}while(S&&f<a);if(512&i.flags&&4&i.wrap&&(i.check=my(i.check,n,f,r)),a-=f,r+=f,S)break t}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;c<16;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if(4&i.wrap&&h!==(65535&i.check)){t.msg="header crc mismatch",i.mode=Wy;break}h=0,c=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Ty;break;case 16189:for(;c<32;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}t.adler=i.check=Uy(h),h=0,c=0,i.mode=Ay;case Ay:if(0===i.havedict)return t.next_out=o,t.avail_out=l,t.next_in=r,t.avail_in=a,i.hold=h,i.bits=c,Qy;t.adler=i.check=1,i.mode=Ty;case Ty:if(e===yy||e===Sy)break t;case Ry:if(i.last){h>>>=7&c,c-=7&c,i.mode=Dy;break}for(;c<3;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}switch(i.last=1&h,h>>>=1,c-=1,3&h){case 0:i.mode=16193;break;case 1:if(Hy(i),i.mode=Vy,e===Sy){h>>>=2,c-=2;break t}break;case 2:i.mode=16196;break;case 3:t.msg="invalid block type",i.mode=Wy}h>>>=2,c-=2;break;case 16193:for(h>>>=7&c,c-=7&c;c<32;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",i.mode=Wy;break}if(i.length=65535&h,h=0,c=0,i.mode=Ey,e===Sy)break t;case Ey:i.mode=16195;case 16195:if(f=i.length,f){if(f>a&&(f=a),f>l&&(f=l),0===f)break t;s.set(n.subarray(r,r+f),o),a-=f,r+=f,l-=f,o+=f,i.length-=f;break}i.mode=Ty;break;case 16196:for(;c<14;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if(i.nlen=257+(31&h),h>>>=5,c-=5,i.ndist=1+(31&h),h>>>=5,c-=5,i.ncode=4+(15&h),h>>>=4,c-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=Wy;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;c<3;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}i.lens[C[i.have++]]=7&h,h>>>=3,c-=3}for(;i.have<19;)i.lens[C[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,$={bits:i.lenbits},x=by(0,i.lens,0,19,i.lencode,0,i.work,$),i.lenbits=$.bits,x){t.msg="invalid code lengths set",i.mode=Wy;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;k=i.lencode[h&(1<<i.lenbits)-1],g=k>>>24,m=k>>>16&255,w=65535&k,!(g<=c);){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if(w<16)h>>>=g,c-=g,i.lens[i.have++]=w;else{if(16===w){for(P=g+2;c<P;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if(h>>>=g,c-=g,0===i.have){t.msg="invalid bit length repeat",i.mode=Wy;break}S=i.lens[i.have-1],f=3+(3&h),h>>>=2,c-=2}else if(17===w){for(P=g+3;c<P;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}h>>>=g,c-=g,S=0,f=3+(7&h),h>>>=3,c-=3}else{for(P=g+7;c<P;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}h>>>=g,c-=g,S=0,f=11+(127&h),h>>>=7,c-=7}if(i.have+f>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=Wy;break}for(;f--;)i.lens[i.have++]=S}}if(i.mode===Wy)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=Wy;break}if(i.lenbits=9,$={bits:i.lenbits},x=by(1,i.lens,0,i.nlen,i.lencode,0,i.work,$),i.lenbits=$.bits,x){t.msg="invalid literal/lengths set",i.mode=Wy;break}if(i.distbits=6,i.distcode=i.distdyn,$={bits:i.distbits},x=by(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,$),i.distbits=$.bits,x){t.msg="invalid distances set",i.mode=Wy;break}if(i.mode=Vy,e===Sy)break t;case Vy:i.mode=My;case My:if(a>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=r,t.avail_in=a,i.hold=h,i.bits=c,wy(t,u),o=t.next_out,s=t.output,l=t.avail_out,r=t.next_in,n=t.input,a=t.avail_in,h=i.hold,c=i.bits,i.mode===Ty&&(i.back=-1);break}for(i.back=0;k=i.lencode[h&(1<<i.lenbits)-1],g=k>>>24,m=k>>>16&255,w=65535&k,!(g<=c);){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if(m&&0==(240&m)){for(b=g,v=m,y=w;k=i.lencode[y+((h&(1<<b+v)-1)>>b)],g=k>>>24,m=k>>>16&255,w=65535&k,!(b+g<=c);){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}h>>>=b,c-=b,i.back+=b}if(h>>>=g,c-=g,i.back+=g,i.length=w,0===m){i.mode=16205;break}if(32&m){i.back=-1,i.mode=Ty;break}if(64&m){t.msg="invalid literal/length code",i.mode=Wy;break}i.extra=15&m,i.mode=16201;case 16201:if(i.extra){for(P=i.extra;c<P;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}i.length+=h&(1<<i.extra)-1,h>>>=i.extra,c-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;k=i.distcode[h&(1<<i.distbits)-1],g=k>>>24,m=k>>>16&255,w=65535&k,!(g<=c);){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if(0==(240&m)){for(b=g,v=m,y=w;k=i.distcode[y+((h&(1<<b+v)-1)>>b)],g=k>>>24,m=k>>>16&255,w=65535&k,!(b+g<=c);){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}h>>>=b,c-=b,i.back+=b}if(h>>>=g,c-=g,i.back+=g,64&m){t.msg="invalid distance code",i.mode=Wy;break}i.offset=w,i.extra=15&m,i.mode=16203;case 16203:if(i.extra){for(P=i.extra;c<P;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}i.offset+=h&(1<<i.extra)-1,h>>>=i.extra,c-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=Wy;break}i.mode=16204;case 16204:if(0===l)break t;if(f=u-l,i.offset>f){if(f=i.offset-f,f>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=Wy;break}f>i.wnext?(f-=i.wnext,p=i.wsize-f):p=i.wnext-f,f>i.length&&(f=i.length),O=i.window}else O=s,p=o-i.offset,f=i.length;f>l&&(f=l),l-=f,i.length-=f;do{s[o++]=O[p++]}while(--f);0===i.length&&(i.mode=My);break;case 16205:if(0===l)break t;s[o++]=i.length,l--,i.mode=My;break;case Dy:if(i.wrap){for(;c<32;){if(0===a)break t;a--,h|=n[r++]<<c,c+=8}if(u-=l,t.total_out+=u,i.total+=u,4&i.wrap&&u&&(t.adler=i.check=i.flags?my(i.check,s,u,o-u):gy(i.check,s,u,o-u)),u=l,4&i.wrap&&(i.flags?h:Uy(h))!==i.check){t.msg="incorrect data check",i.mode=Wy;break}h=0,c=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;c<32;){if(0===a)break t;a--,h+=n[r++]<<c,c+=8}if(4&i.wrap&&h!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=Wy;break}h=0,c=0}i.mode=16208;case 16208:x=ky;break t;case Wy:x=Py;break t;case 16210:return Cy;default:return $y}return t.next_out=o,t.avail_out=l,t.next_in=r,t.avail_in=a,i.hold=h,i.bits=c,(i.wsize||u!==t.avail_out&&i.mode<Wy&&(i.mode<Dy||e!==vy))&&Fy(t,t.output,t.next_out,u-t.avail_out),d-=t.avail_in,u-=t.avail_out,t.total_in+=d,t.total_out+=u,i.total+=u,4&i.wrap&&u&&(t.adler=i.check=i.flags?my(i.check,s,u,t.next_out-u):gy(i.check,s,u,t.next_out-u)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Ty?128:0)+(i.mode===Vy||i.mode===Ey?256:0),(0===d&&0===u||e===vy)&&x===xy&&(x=_y),x},ly.inflateEnd=t=>{if(qy(t))return $y;let e=t.state;return e.window&&(e.window=null),t.state=null,xy},ly.inflateGetHeader=(t,e)=>{if(qy(t))return $y;const i=t.state;return 0==(2&i.wrap)?$y:(i.head=e,e.done=!1,xy)},ly.inflateSetDictionary=(t,e)=>{const i=e.length;let n,s,r;return qy(t)?$y:(n=t.state,0!==n.wrap&&n.mode!==Ay?$y:n.mode===Ay&&(s=1,s=gy(s,e,i,0),s!==n.check)?Py:(r=Fy(t,e,i,i),r?(n.mode=16210,Cy):(n.havedict=1,xy)))},ly.inflateInfo="pako inflate (from Nodeca project)";const Jy=ly,Ky=Dv,tS=Uv,eS=Mb,iS=Lv,nS=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},sS=Object.prototype.toString,{Z_NO_FLUSH:rS,Z_FINISH:oS,Z_OK:aS,Z_STREAM_END:lS,Z_NEED_DICT:hS,Z_STREAM_ERROR:cS,Z_DATA_ERROR:dS,Z_MEM_ERROR:uS}=Db;function fS(t){this.options=Ky.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iS,this.strm.avail_out=0;let i=Jy.inflateInit2(this.strm,e.windowBits);if(i!==aS)throw new Error(eS[i]);if(this.header=new nS,Jy.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=tS.string2buf(e.dictionary):"[object ArrayBuffer]"===sS.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=Jy.inflateSetDictionary(this.strm,e.dictionary),i!==aS)))throw new Error(eS[i])}function pS(t,e){const i=new fS(e);if(i.push(t),i.err)throw i.msg||eS[i.err];return i.result}fS.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let r,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?oS:rS,"[object ArrayBuffer]"===sS.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),r=Jy.inflate(i,o),r===hS&&s&&(r=Jy.inflateSetDictionary(i,s),r===aS?r=Jy.inflate(i,o):r===dS&&(r=hS));i.avail_in>0&&r===lS&&i.state.wrap>0&&0!==t[i.next_in];)Jy.inflateReset(i),r=Jy.inflate(i,o);switch(r){case cS:case dS:case hS:case uS:return this.onEnd(r),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||r===lS))if("string"===this.options.to){let t=tS.utf8border(i.output,i.next_out),e=i.next_out-t,s=tS.buf2string(i.output,t);i.next_out=e,i.avail_out=n-e,e&&i.output.set(i.output.subarray(t,t+e),0),this.onData(s)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(r!==aS||0!==a){if(r===lS)return r=Jy.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},fS.prototype.onData=function(t){this.chunks.push(t)},fS.prototype.onEnd=function(t){t===aS&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ky.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},ay.Inflate=fS,ay.inflate=pS,ay.inflateRaw=function(t,e){return(e=e||{}).raw=!0,pS(t,e)},ay.ungzip=pS,ay.constants=Db;const{Deflate:OS,deflate:gS,deflateRaw:mS,gzip:wS}=Gw,{Inflate:bS,inflate:vS,inflateRaw:yS,ungzip:SS}=ay,xS=Db;Nw.Deflate=OS,Nw.deflate=gS,Nw.deflateRaw=mS,Nw.gzip=wS,Nw.Inflate=bS,Nw.inflate=vS,Nw.inflateRaw=yS,Nw.ungzip=SS,Nw.constants=xS;const kS=Nw;let QS={};var $S;function PS(t){return $S=t,[AS]}QS.Util={},QS.Decode={},QS.Messages=[],QS.Log=function(t){QS.Messages.push(["I",t]),console.log("Mma.js INFO: ",t)},QS.Warn=function(t){QS.Messages.push(["W",t]),console.log("Mma.js WARNING: ",t)},QS.Fail=function(t,e){QS.Messages.push(["E",t]),console.error("Mma.js ERROR: "+t+", but got "+JSON.stringify(e))},QS.Util.Base64Decode=function(t){for(var e=atob(t),i=e.length>>>0,n=new Uint8Array(i),s=0;s<i;s++)n[s]=e.charCodeAt(s);return n},QS.Util.U8ArrayToString=function(t){for(var e=[],i=0;i<t.length;i+=32768)e.push(String.fromCharCode.apply(null,t.subarray(i,i+32768)));return e.join("")},QS.Util.DeleteCharAt=function(t,e){return t.substr(0,e)+t.substr(e+1)},QS.IntegerMP=function(t){"number"==typeof t&&Number.isInteger(t)?this.n=t:void 0===t?this.n=void 0:QS.Fail("IntegerMP: invalid input")},QS.IntegerAP=function(t){if("string"==typeof t){for(var e=0;e<t.length;e++)NaN===Number(t[e])&&QS.Fail("IntegerAP: invalid input, contains non-digit: "+String(t));t.length>1&&0===t[0]&&QS.Fail("IntegerAP: input starts with 0: "+String(t)),this.nstring=t}else void 0===t?this.nstring=void 0:QS.Fail("Integer: invalid input: "+String(t))},QS.RealMP=function(t){"number"==typeof t?this.n=t:void 0===t?this.n=void 0:QS.Fail("RealMP: invalid input")},QS.RealAP=function(t){"string"==typeof t?(t.length>1&&0===t[0]&&QS.Fail("RealAP: input starts with 0: "+String(t)),this.nstring=t):void 0===t?this.nstring=void 0:QS.Fail("RealAP: invalid input: "+String(t))},QS.Symbol=function(t){"string"==typeof t?this.name=t:void 0===t?this.name=void 0:QS.Fail("Symbol: invalid input: "+String(t))},QS.String=function(t){"string"==typeof t?this.str=t:void 0===t?this.str=void 0:QS.Fail("String: invalid input: "+String(t))},QS.Expression=function(t,e){t instanceof QS.Symbol||t instanceof QS.Expression||(QS.Fail("Expression: uncovered case of subsvalues: head must be an Mma.Symbol",t),QS.Warn("We will try to fix it")),e instanceof Array||QS.Fail("Expression: parts must be an Array"),this.head=t,this.parts=e},QS.Decode.Int32=function(t,e){try{return new DataView(t.buffer).getInt32(e,!0)}catch(t){return 0}},QS.Decode.Float64=function(t,e){try{return new DataView(t.buffer).getFloat64(e,!0)}catch(t){return 0}},QS.Decode.String=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=t.length),QS.Util.U8ArrayToString(t.slice(e,e+i))},QS.Decode.StringEntry=function(t,e){void 0===e&&(e=0);var i=QS.Decode.Int32(t,e);return{length:i,string:QS.Decode.String(t,e+4,i),bytesRead:i+4}},QS.Decode.Any=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=1/0);var n=e;for(var s=0,r=[];e<t.length&&r.length<i;)switch(s){case 0:var o=t[e];switch(String.fromCharCode(o)){case"i":s=1;break;case"I":s=2;break;case"r":s=3;break;case"R":s=4;break;case"s":s=5;break;case"S":s=6;break;case"f":s=7;break;case"e":s=8;break;default:QS.Warn("Decode.Any (READY): byte "+String(o)+" ("+String.fromCharCode(o)+") at offset "+String(e)+" is not a known type signature")}e+=1;break;case 1:var a=QS.Decode.Int32(t,e);r.push(new QS.IntegerMP(a)),e+=4,s=0;break;case 2:var l=QS.Decode.StringEntry(t,e);r.push(new QS.IntegerAP(l.string)),e+=l.bytesRead,s=0;break;case 3:var h=QS.Decode.Float64(t,e);r.push(new QS.RealMP(h)),e+=8,s=0;break;case 4:l=QS.Decode.StringEntry(t,e);r.push(new QS.RealAP(l.string)),e+=l.bytesRead,s=0;break;case 5:l=QS.Decode.StringEntry(t,e);r.push(new QS.Symbol(l.string)),e+=l.bytesRead,s=0;break;case 6:l=QS.Decode.StringEntry(t,e);r.push(new QS.String(l.string)),e+=l.bytesRead,s=0;break;case 7:var c=QS.Decode.Int32(t,e);e+=4;var d=QS.Decode.Any(t,e,c+1);e+=d.bytesRead;var u=d.parts[0],f=d.parts.slice(1);r.push(new QS.Expression(u,f)),s=0;break;case 8:var p=QS.Decode.Int32(t,e);e+=4;for(var O=[],g=0;g<p;g++)O[g]=QS.Decode.Int32(t,e),e+=4;var m=function(t,e,i,n){var s=[],r=e;if(0===n)for(var o=0;o<i[i.length-1];o++){var a=QS.Decode.Float64(t,e);s.push(new QS.RealMP(a)),e+=8}else for(o=0;o<i[i.length-n-1];o++){var l=m(t,e,i,n-1);e+=l.bytesRead,s.push(l.expr)}return{expr:new QS.Expression(new QS.Symbol("List"),s),bytesRead:e-r}},w=m(t,e,O,p-1);e+=w.bytesRead,r.push(w.expr),s=0}return{parts:r,bytesRead:e-n}},QS.Decompress=function(t){for(var e=0;e<t.length;e++)"\\"!=t[e]&&"\n"!=t[e]&&'"'!=t[e]||(t=QS.Util.DeleteCharAt(t,e),e--);var i=t.trim().slice(2),n=QS.Util.Base64Decode(i),s=kS.inflate(n),r=QS.Util.U8ArrayToString(s.slice(0,4));return"!boR"!==r&&QS.Warn("Decompress: unknown header string "+r+" (expected !boR)"),s.slice(4)},QS.DecompressDecode=function(t){return QS.Decode.Any(QS.Decompress(t))},QS.toArray=function(t){var e,i=[];if(t instanceof QS.IntegerMP||t instanceof QS.RealMP)return t.n;if(t instanceof QS.IntegerAP||t instanceof QS.RealAP)return t.nstring;if(t instanceof QS.Symbol)return t.name;if(t instanceof QS.String)return"'"+t.str+"'";if(t instanceof QS.Expression){t.head instanceof QS.Expression?i.push(QS.toArray(t.head)):(e=t.head.name,i.push(e));for(var n=0;n<t.parts.length;n++)i.push(QS.toArray(t.parts[n]))}return i};const CS=/"(.+)"\(\*VB\[\*\)\(\*\*\)\(\*\,\*\)\(\*\"([\w:\d=+-/]*)/;let _S=class{constructor(t,e,i,n){this.view=e,this.visibleValue=t;const s=this;this.tbody=i,this.args=yw(t.str,/\(\*\|\|\*\)/gm).map(((t,e)=>e%2!=0?t:{...t,body:yw(t.body,/\(\*\|\*\)/gm)})),Array.isArray(this.args[this.args.length-1].body)||(this.decorator=this.args.pop());const r=this.args;console.log("creating InstanceWidget");for(let t=0;t<this.args.length;t+=2){const n=document.createElement("tr"),o=this.args[t].body;for(let i=0;i<o.length;i+=2){const a=document.createElement("td");let l=o[i].body;if(0==i&&0==t&&(l=l.slice(2)),0==i&&0!=t&&(l=l.slice(1)),i==o.length-1&&t==this.args.length-1&&(l=l.slice(0,-2)),i==o.length-1&&t!=this.args.length-1&&(l=l.slice(0,-1)),'"'!=l.charAt(0))o[i].editor=$S({doc:l,parent:a,eval:()=>{e.viewState.state.config.eval()},update:e=>this.applyChanges(e,t,i),extensions:[Ys.of([{key:"ArrowLeft",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to&&!t.stringOnly)return i-2>=0?(o[i-2].editor.dispatch({selection:{anchor:o[i-2].editor.state.doc.length}}),o[i-2].editor.focus(),void(t.editorLastCursor=void 0)):(e.dispatch({selection:{anchor:s.visibleValue.pos}}),e.focus(),void(t.editorLastCursor=void 0));t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to&&!t.stringOnly)return i+2<o.length?(o[i+2].editor.dispatch({selection:{anchor:0}}),o[i+2].editor.focus(),void(t.editorLastCursor=void 0)):(e.dispatch({selection:{anchor:s.visibleValue.pos+s.visibleValue.length}}),e.focus(),void(t.editorLastCursor=void 0));t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowUp",run:function(e,n){if(t-2>=0)return r[t-2].body[i].editor.focus(),void(e.editorLastCursor=void 0)}},{key:"ArrowDown",run:function(e,n){if(t+2<r.length)return r[t+2].body[i].editor.focus(),void(e.editorLastCursor=void 0)}}])]});else{o[i].editor={destroy:()=>{},focus:()=>{},dispatch:()=>{},stringOnly:!0};const t=l.match(CS);if(t){a.innerHTML=t[1],a.classList.add("selectable");const e=QS.DecompressDecode(t[2]),i=QS.toArray(e.parts[0]),n=uuidv4();interpretate(i,{global:{call:n},element:a})}else a.innerHTML=l.slice(1,-1),a.classList.add("selectable")}delete o[i].body,n.appendChild(a)}i.appendChild(n)}if(this.decorator){const t=QS.DecompressDecode(this.decorator.body.slice(2,-2)),e=QS.toArray(t.parts[0]);let n={global:{call:uuidv4(),EditorWidget:s},element:i};this.interpretated=interpretate(e,n)}}applyChanges(t,e,i){const n=this.args,s=this.args[e].body,r=this.visibleValue.argsPos,o=this.args[e].from;let a=t;0==i&&0==e&&(a="{{"+a),0==i&&0!=e&&(a="{"+a),i==s.length-1&&e==n.length-1&&(a+="}}"),i==s.length-1&&e!=n.length-1&&(a+="}");const l=s[i].length,h={from:r+o+s[i].from,to:r+o+s[i].from+l,insert:a},c=a.length-l;for(let t=i+1;t<s.length;t+=1)s[t].from+=c;for(let t=e+1;t<n.length;t+=1)n[t].from+=c;this.args[e].length+=c,this.visibleValue.length=this.visibleValue.length+c,s[i].length=a.length,this.view.dispatch({changes:h})}update(t){console.log("We cant verify if changes were applied from the widget itself!"),this.visibleValue.pos=t.pos,this.visibleValue.argsPos=t.argsPos}destroy(){console.warn("destroy Instance of Widget!");for(let t=0;t<this.args.length;t+=2){const e=this.args[t].body;for(let t=0;t<e.length;t+=2)e[t].editor.destroy()}}},XS=class extends ei{constructor(t,e,i){super(),this.view=i,this.visibleValue=t,this.reference=e}eq(t){return!1}updateDOM(t,e){return console.log("update widget DOM"),this.DOMElement=t,t.EditorWidget.update(this.visibleValue),!0}toDOM(t){console.log("Create a new one!");let e=document.createElement("span");e.classList.add("matrix");const i=document.createElement("table");i.classList.add("container"),e.appendChild(i);const n=document.createElement("tbody");i.appendChild(n),e.EditorWidget=new _S(this.visibleValue,t,n,[]);const s=this;return this.reference.push({destroy:()=>{s.destroy(e)}}),this.DOMElement=e,e}skipPosition(t,e,i){if(e.from!=e.to||i)return t;if(t.from-e.from>0)this.DOMElement.EditorWidget.args[0].body[0].editor.dispatch({selection:{anchor:0}}),this.DOMElement.EditorWidget.args[0].body[0].editor.focus();else{const t=this.DOMElement.EditorWidget.args,e=t[t.length-1].body[t[t.length-1].body.length-1].editor;e.dispatch({selection:{anchor:e.state.doc.length}}),e.focus()}return e}ignoreEvent(){return!0}destroy(t){t.EditorWidget.destroy()}};const ZS=(t,e)=>new kw({tag:"GB",decoration:i=>ni.replace({widget:new XS(i,t,e)})}),AS=_i.fromClass(class{constructor(t){this.disposable=[],this.placeholder=ZS(this.disposable,t).createDeco(t)}update(t){this.placeholder=ZS(this.disposable,t).updateDeco(t,this.placeholder)}destroy(){this.disposable.forEach((t=>{t.destroy()}))}},{decorations:t=>t.placeholder,provide:t=>Ts.atomicRanges.of((e=>{var i;return(null===(i=e.plugin(t))||void 0===i?void 0:i.placeholder)||ni.none}))});function TS(t){return[MS]}let RS=class{constructor(t,e,i,n){return this._construct(t,e,i,n)}_construct(t,e,i,n){this.view=e,this.visibleValue=t,this.span=i,this.args=yw(t.str,/\(\*,\*\)/gm);const s=this,r=this.args[1].body.slice(3,-3),o=QS.DecompressDecode(r),a=QS.toArray(o.parts[0]);this.data=a;const l="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}));this.cuid=l;let h={call:l,EditorWidget:s},c={global:h,element:i};this.expression=a,this.env=c,this.interpretated=interpretate(a,c),this.interpretated.then((()=>{if(c.options?.Event){console.warn("Event listeners are enabled!"),s.events=c.options.Event;let t=c;if(h.stack){const e=Object.values(h.stack);e.length>0&&(console.log("Attaching first found instance..."),t=e[0].env)}interpretate(["FrontInstanceReference","'"+l+"'"],t),server.kernel.io.fire(s.events,{Instance:l},"Mounted")}}))}getDoc(){return this.args[0].body.slice(1,-1)}applyChanges(t,e){const i=this.args,n=this.visibleValue.argsPos,s="("+t+")",r={from:n+i[0].from,to:n+i[0].from+i[0].length,insert:s};this.visibleValue.str=this.visibleValue.str.substring(0,i[0].from).concat(s,this.visibleValue.str.substring(i[0].from+i[0].length)),i[0].length=s.length,this.view.dispatch({changes:r})}applyOuterChanges(t){const e=this.visibleValue,i=t,n={from:e.pos,to:e.pos+e.length,insert:i};this.view.dispatch({changes:n})}update(t){if(!this.deactivated){if(t.str!=this.visibleValue.str){console.warn("Out of sync"),console.log("recreate..."),this.destroy();const e=this.span;return e.replaceChildren(),void this._construct(t,this.view,e)}this.visibleValue.pos=t.pos,this.visibleValue.argsPos=t.argsPos}}destroy(t){if(console.warn("destroy Instance of Widget"),console.log(this),this.env.global.stack)for(const t of Object.values(this.env.global.stack))t.dispose();this.events&&server.kernel.io.fire(this.events,{Instance:this.cuid},"Destroy"),delete this.data}},ES=class extends ei{constructor(t,e,i){super(),this.view=i,this.visibleValue=t,this.reference=e}eq(t){return!1}updateDOM(t,e){return console.log("update widget DOM"),t.EditorWidget.update(this.visibleValue),!0}toDOM(t){console.log("Create a new one!");const e=this;let i=document.createElement("span");return i.classList.add("frontend-view"),i.EditorWidget=new RS(this.visibleValue,t,i),this.reference.push({destroy:()=>{e.destroy(i)}}),i}ignoreEvent(){return!0}destroy(t){console.log("destroy in general*"),t.EditorWidget.destroy()}};const VS=(t,e)=>new kw({tag:"VB",decoration:i=>ni.replace({widget:new ES(i,t,e)})}),MS=_i.fromClass(class{constructor(t){this.disposable=[],this.placeholder=VS(this.disposable,t).createDeco(t)}update(t){this.placeholder=VS(this.disposable,t).updateDeco(t,this.placeholder)}destroy(){this.disposable.forEach((t=>{t.destroy()}))}},{decorations:t=>t.placeholder,provide:t=>Ts.atomicRanges.of((e=>{var i;return(null===(i=e.plugin(t))||void 0===i?void 0:i.placeholder)||ni.none}))});var DS;function WS(t){return DS=t,[LS]}let US=class{constructor(t,e,i,n){return this._construct(t,e,i,n)}_construct(t,e,i,n){this.view=e,this.span=i,this.visibleValue=t,this.args=yw(t.str,/\(\*,\*\)/gm);const s=this;this.epilog={offset:0,string:""},this.prolog={offset:0,string:""};const r=this.args[1].body.slice(3,-3),o=QS.DecompressDecode(r),a=QS.toArray(o.parts[0]);this.data=a;let l={global:{call:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})),element:i,origin:s},element:i};this.env=l,interpretate(a,l).then((()=>{if(l.options?.Head&&(s.prolog.offset=l.options.Head.length+1,s.prolog.string=l.options.Head+"[",s.epilog.offset=1,s.epilog.string="]"),l.options?.Event&&(console.warn("Event listeners are enabled!"),s.events=l.options.Event),l.options?.String){s.prolog.offset=1,s.prolog.string='"',s.epilog.offset=1,s.epilog.string='"',l.options?.HeadString&&(s.prolog.string=l.options.HeadString,s.prolog.offset=s.prolog.string.length),l.options?.TailString&&(s.epilog.string=l.options.TailString,s.epilog.offset=s.epilog.string.length),s.editor={destroy:()=>{console.log("Nothing to destroy, this is just a text field.")}};const t=document.createElement("span");return this.aa,t.onkeydown=function(t){13===t.keyCode&&t.preventDefault()},t.contentEditable="plaintext-only",t.innerText=s.args[0].body.slice(1+s.prolog.offset,-1-s.epilog.offset),t.addEventListener("input",console.log),t.addEventListener("input",(()=>{console.log("Update"),console.log(t.innerText),this.applyChanges(t.innerText)})),l.global.element.appendChild(t),void(s.events&&server.kernel.emitt(s.events,"Null","Mounted"))}s.editor=DS({doc:s.args[0].body.slice(1+s.prolog.offset,-1-s.epilog.offset),parent:l.global.element,update:t=>this.applyChanges(t),eval:()=>{e.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowLeft",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return console.log(s.visibleValue.pos),e.dispatch({selection:{anchor:s.visibleValue.pos}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,i){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return console.log(s.visibleValue.pos),e.dispatch({selection:{anchor:s.visibleValue.pos+s.visibleValue.length}}),e.focus(),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}}])]}),s.events&&server.kernel.emitt(s.events,"Null","Mounted")}))}applyChanges(t,e){const i=this.args,n=this.visibleValue.argsPos,s="("+this.prolog.string+t+this.epilog.string+")",r={from:n+i[0].from,to:n+i[0].from+i[0].length,insert:s};this.visibleValue.str=this.visibleValue.str.substring(0,i[0].from).concat(s,this.visibleValue.str.substring(i[0].from+i[0].length));const o=s.length-i[0].length;i[0].length=s.length,this.visibleValue.length=this.visibleValue.length+o,this.view.dispatch({changes:r})}update(t){if(this.visibleValue.str!=t.str)return console.warn("Out of sync"),console.log("recreating InstanceWidget"),this.destroy(),this.span.replaceChildren(),void this._construct(t,this.view,this.span);this.visibleValue.pos=t.pos,this.visibleValue.argsPos=t.argsPos}destroy(){if(console.warn("destroy Instance of Widget"),console.log(this),this.env.global.stack)for(const t of Object.values(this.env.global.stack))t.dispose();this.editor.destroy(),this.events&&server.kernel.emitt(this.events,"Null","Destroy"),delete this.data}},YS=class extends ei{constructor(t,e,i){super(),this.view=i,this.visibleValue=t,this.reference=e}eq(t){return!1}updateDOM(t,e){return console.log("update widget DOM"),this.DOMElement=t,t.EditorWidget.update(this.visibleValue),!0}toDOM(t){console.log("Create a new one!");let e=document.createElement("span");e.classList.add("subscript-tail"),e.EditorWidget=new US(this.visibleValue,t,e,[]);const i=this;return this.reference.push({destroy:()=>{i.destroy(e)}}),this.DOMElement=e,e}skipPosition(t,e,i){if(e.from!=e.to||i)return t;if(t.from-e.from>0)this.DOMElement.EditorWidget.editor.dispatch({selection:{anchor:0}}),this.DOMElement.EditorWidget.editor.focus();else{const t=this.DOMElement.EditorWidget.editor;t.dispatch({selection:{anchor:t.state.doc.length}}),t.focus()}return e}ignoreEvent(){return!0}destroy(t){t.EditorWidget.destroy()}};const qS=(t,e)=>new kw({tag:"BB",decoration:i=>ni.replace({widget:new YS(i,t,e)})}),LS=_i.fromClass(class{constructor(t){this.disposable=[],this.placeholder=qS(this.disposable,t).createDeco(t)}update(t){this.placeholder=qS(this.disposable,t).updateDeco(t,this.placeholder)}destroy(){this.disposable.forEach((t=>{t.destroy()}))}},{decorations:t=>t.placeholder,provide:t=>Ts.atomicRanges.of((e=>{var i;return(null===(i=e.plugin(t))||void 0===i?void 0:i.placeholder)||ni.none}))});var zS;function IS(t){return zS=t,[GS]}class BS{constructor(t,e,i,n){return this._construct(t,e,i,n)}_construct(t,e,i,n){this.view=e,this.visibleValue=t,this.args=yw(t.str,/\(\*\|\*\)/gm);const s=this,r=Array.from({length:Math.ceil((s.args.length-3)/2)},((t,e)=>2*e+1));s.indexes=r;const o=[];this.span=i,this.spans=o;for(let t=0;t<r.length;++t)o.push(document.createElement("span"));const a=this.args[this.args.length-1].body.slice(2,-2),l=QS.DecompressDecode(a),h=QS.toArray(l.parts[0]);this.data=h;let c={global:{call:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})),element:i,children:o,origin:s},element:i,children:o};this.env=c,interpretate(h,c).then((()=>{c.options?.Event&&(console.warn("Event listeners are enabled!"),s.events=c.options.Event),s.editors=r.map(((t,i)=>zS({doc:s.args[t].body,parent:o[i],update:e=>this.applyChanges(e,t),eval:()=>{e.viewState.state.config.eval()},extensions:[Ys.of([{key:"ArrowLeft",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return i>0?s.editors[i-1].focus():(e.dispatch({selection:{anchor:s.visibleValue.pos}}),e.focus()),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,n){if(t?.editorLastCursor===t.state.selection.ranges[0].to)return i<r.length-1?s.editors[i+1].focus():(e.dispatch({selection:{anchor:s.visibleValue.pos+s.visibleValue.length}}),e.focus()),void(t.editorLastCursor=void 0);t.editorLastCursor=t.state.selection.ranges[0].to}}])]}))),s.events&&server.kernel.emitt(s.events,"Null","Mounted")}))}applyChanges(t,e){const i=this.args,n=this.visibleValue.argsPos,s={from:n+i[e].from,to:n+i[e].from+i[e].length,insert:t};this.visibleValue.str=this.visibleValue.str.substring(0,i[e].from).concat(t,this.visibleValue.str.substring(i[e].from+i[e].length));const r=t.length-i[e].length;i[e].length=t.length;for(let t=e+1;t<i.length;++t)i[t].from=i[t].from+r;this.visibleValue.length+=r,this.view.dispatch({changes:s})}update(t){this.visibleValue.str!=t.str&&(console.warn("Out of sync"),this.view,this.visibleValue=t,this.destroy(),this.span.replaceChildren(),this._construct(t,this.view,this.span)),this.visibleValue.pos=t.pos,this.visibleValue.argsPos=t.argsPos}destroy(){if(console.warn("destroy Instance of Widget"),console.log(this),this.env.global.stack)for(const t of Object.values(this.env.global.stack))t.dispose();this.editors.forEach((t=>t.destroy())),this.events&&server.kernel.emitt(this.events,"Null","Destroy"),delete this.data}}class jS extends ei{constructor(t,e,i){super(),this.view=i,this.visibleValue=t,this.reference=e}eq(t){return!1}updateDOM(t,e){return this.DOMElement=t,console.log("update widget DOM"),t.EditorWidget.update(this.visibleValue),!0}toDOM(t){console.log("Create a new one!");let e=document.createElement("span");e.classList.add("inline-flex"),e.EditorWidget=new BS(this.visibleValue,t,e,[]);const i=this;return this.DOMElement=e,this.reference.push({destroy:()=>{i.destroy(e)}}),e}skipPosition(t,e,i){if(e.from!=e.to||i)return t;const n=this.DOMElement.EditorWidget.editors;return t.from-e.from<0?(n[n.length-1].dispatch({selection:{anchor:n[n.length-1].state.doc.length}}),n[n.length-1].focus()):(n[0].dispatch({selection:{anchor:0}}),n[0].focus()),e}ignoreEvent(){return!0}destroy(t){t.EditorWidget.destroy()}}const NS=(t,e)=>new kw({tag:"TB",decoration:i=>ni.replace({widget:new jS(i,t,e)})}),GS=_i.fromClass(class{constructor(t){this.disposable=[],this.placeholder=NS(this.disposable,t).createDeco(t)}update(t){this.placeholder=NS(this.disposable,t).updateDeco(t,this.placeholder)}destroy(){this.disposable.forEach((t=>{t.destroy()}))}},{decorations:t=>t.placeholder,provide:t=>Ts.atomicRanges.of((e=>{var i;return(null===(i=e.plugin(t))||void 0===i?void 0:i.placeholder)||ni.none}))});const HS=_i.fromClass(class{decorations=ni.none;constructor(t){this.view=t,this.recompute()}recompute(t){let e,i,n=[];for(let{from:t,to:e}of this.view.visibleRanges)this.getDecorationsFor(t,e,n);this.decorations=ni.set(n,!0),this.decorations=this.decorations.update({filter:(n,s)=>!(n>e&&s<i)&&(e=n,i=s,!t||!function(t,e,i,n=!0){let s=t.transactions[t.transactions.length-1];if(s&&s.selection){if(n&&s.selection.main.head>=e&&s.selection.main.head<=i)return!0;if(!n&&s.selection.main.head>e&&s.selection.main.head<i)return!0}return!1}(t,n,s))})}update(t){(t.docChanged||t.selectionSet||t.viewportChanged)&&this.recompute(t)}getDecorationsFor(t,e,i){let{doc:n}=this.view.state,s=/^[\w|\d]*\.[\w| |-|=|\d|.]+\s*$/g;for(let r,o=t,a=n.iterRange(t,e);!a.next().done&&!a.lineBreak;){for(;r=s.exec(a.value);){let t=ni.replace({widget:new FS(r[0],r[1])});i.push(t.range(o+r.index,o+r.index+r[0].length))}o+=a.value.length}}},{decorations:t=>t.decorations});class FS extends ei{constructor(t,e){super(),this.rawValue=t,this.visibleValue=e}eq(t){return this.rawValue===t.rawValue}toDOM(){let t=document.createElement("div");t.classList.add("cell-type-widget");const e=this.rawValue.split(" "),i=e[0].split(".");if(console.log(i),t.classList.add("cell-type-"+i[1].trim()),t.innerText=e[0].trim(),e.length>1){const n=e.slice(1),s=document.createElement("span");return s.appendChild(t),n.forEach((t=>{const e=document.createElement("span");e.innerText=t,e.classList.add("cell-type-"+i[1].trim()+"-"+t.split("=")[0]),s.appendChild(e)})),s}return t}ignoreEvent(){return!1}}const JS=new H,KS=new H,tx=[],ex=_l.define([{tag:_a.meta,color:"var(--editor-key-meta)"},{tag:_a.link,textDecoration:"underline"},{tag:_a.heading,textDecoration:"underline",fontWeight:"bold"},{tag:_a.emphasis,fontStyle:"italic"},{tag:_a.strong,fontWeight:"bold"},{tag:_a.strikethrough,textDecoration:"line-through"},{tag:_a.keyword,color:"var(--editor-key-keyword)"},{tag:[_a.atom,_a.bool,_a.url,_a.contentSeparator,_a.labelName],color:"var(--editor-key-atom)"},{tag:[_a.literal,_a.inserted],color:"var(--editor-key-literal)"},{tag:[_a.string,_a.deleted],color:"var(--editor-key-string)"},{tag:[_a.regexp,_a.escape,_a.special(_a.string)],color:"var(--editor-key-escape)"},{tag:_a.definition(_a.variableName),color:"var(--editor-key-variable)"},{tag:_a.local(_a.variableName),color:"var(--editor-local-variable)"},{tag:[_a.typeName,_a.namespace],color:"var(--editor-key-type)"},{tag:_a.className,color:"var(--editor-key-class)"},{tag:[_a.special(_a.variableName),_a.macroName],color:"var(--editor-special-variable)"},{tag:_a.definition(_a.propertyName),color:"var(--editor-key-property)"},{tag:_a.comment,color:"var(--editor-key-comment)"},{tag:_a.invalid,color:"var(--editor-key-invalid)"}]),ix={data:[],extend:t=>{ix.data.push(...t),tw.reBuild(ix.data)},replaceAll:t=>{ix.data=t,tw.reBuild(ix.data)}},nx=ih.define({name:"spreadsheet",startState:function(){return{stringType:null,stack:[]}},token:function(t,e){if(t){switch(0===e.stack.length&&('"'!=t.peek()&&"'"!=t.peek()||(e.stringType=t.peek(),t.next(),e.stack.unshift("string"))),e.stack[0]){case"string":for(;"string"===e.stack[0]&&!t.eol();)t.peek()===e.stringType?(t.next(),e.stack.shift()):"\\"===t.peek()?(t.next(),t.next()):t.match(/^.[^\\\"\']*/);return"string";case"characterClass":for(;"characterClass"===e.stack[0]&&!t.eol();)t.match(/^[^\]\\]+/)||t.match(/^\\./)||e.stack.shift();return"operator"}var i=t.peek();switch(i){case"[":return t.next(),e.stack.unshift("characterClass"),"bracket";case":":return t.next(),"operator";case"\\":return t.match(/\\[a-z]+/)?"string.special":(t.next(),"atom");case".":case",":case";":case"*":case"-":case"+":case"^":case"<":case"/":case"=":return t.next(),"atom";case"$":return t.next(),"builtin"}return t.match(/\d+/)?t.match(/^\w+/)?"error":"number":t.match(/^[a-zA-Z_]\w*/)?t.match(/(?=[\(.])/,!1)?"keyword":"variable":-1!=["[","]","(",")","{","}"].indexOf(i)?(t.next(),"bracket"):(t.eatSpace()||t.next(),null)}}}),sx=new RegExp(/^[\w]*\.[\w]+/);function rx(t){const e=sx.exec(t),i=Object.values(window.SupportedLanguages);for(let t=0;t<i.length;++t)if(i[t].check(e))return i[t];return{plugins:nx,name:"spreadsheet",legacy:!0}}const ox=E.define(),ax=xt.transactionExtender.of((t=>{if(!t.docChanged)return null;let e=rx(t.newDoc.line(1).text);if(e.legacy){const i=t.startState.facet(Ba);if(i){if(i.name==e.name)return null}else if(t.startState.facet(ox)==e.name)return null;return console.log("switching... to "+e.name),{effects:JS.reconfigure(e.plugins)}}return e.name===t.startState.facet(Ba).name?null:(console.log("switching... to "+e.name),{effects:JS.reconfigure(e.plugins)})}));let lx,hx=null;const cx=t=>{const e=t||lx;return e&&e.viewState?(console.log(),rx(e.state.doc.line(1).text).name):""},dx=t=>{const e=t||lx;if(!e)return"";if(!e.viewState)return"";const i=e.viewState.state.selection.ranges;if(!i.length)return!1;const n=i[0];return[n.from,n.to]},ux=t=>{const e=t||lx;return e&&e.viewState?e.state.doc.toString():""},fx=t=>{const e=t||lx;if(!e)return"";if(!e.viewState)return"";const i=e.viewState.state.selection.ranges;if(!i.length)return"";const n=i[0];return console.log("yoko"),console.log(n),console.log(e.state.doc.toString().slice(n.from,n.to)),console.log("processing"),e.state.doc.toString().slice(n.from,n.to)},px=(t,e)=>{const i=e||lx;if(!i)return;if(!i.viewState)return;const n=i.viewState.state.selection.ranges;if(!n.length)return;const s=n[0];console.log("result"),console.log(t),i.dispatch({changes:{...s,insert:t}})},Ox=()=>lx,gx=(t,e)=>{const i=e||lx;i&&i.viewState&&(console.log("result"),console.log(t),i.dispatch({changes:{from:0,to:i.viewState.state.doc.length,insert:t}}))};hx=t=>{let e=new Ts({doc:t.doc,extensions:[Ys.of([{key:"Tab",run:function(t,e){return du(t)}},{key:"Enter",preventDefault:!0,run:function(t,e){return!0}}]),Ys.of([{key:"Shift-Enter",preventDefault:!0,run:function(e,i){return t.eval(),!0}}]),t.extensions||[],vf,Sx,tw.of(ix),Qw(hx),Zw(hx),Mw(hx),Lw(hx),PS(hx),TS(),WS(hx),IS(hx),ow,tx,Ts.updateListener.of((e=>{e.docChanged&&t.update(e.state.doc.toString()),e.selectionSet&&(lx=e.view)}))],parent:t.parent});return e.viewState.state.config.eval=t.eval,e},hx.state=t=>{let e=xt.create({doc:t.doc,extensions:[Ys.of([{key:"Tab",run:function(t,e){return du(t)}},{key:"Enter",preventDefault:!0,run:function(t,e){return!0}}]),Ys.of([{key:"Shift-Enter",preventDefault:!0,run:function(e,i){return t.eval(),!0}}]),t.extensions||[],vf,Sx,tw.of(ix),Qw(hx),Zw(hx),Mw(hx),Lw(hx),PS(hx),TS(),WS(hx),IS(hx),ow,tx,Ts.updateListener.of((e=>{e.docChanged&&t.update(e.state.doc.toString()),e.selectionSet&&(lx=e.view)}))]});return e.config.eval=t.eval,e};const mx=(t,e)=>{if(!t||e<=0)return[];const i=[];for(let n=0;n<t.length;n+=e)i.push(t.slice(n,Math.min(n+e,t.length)));return i},wx={transaction:(t,e,i,n)=>{if(console.log(e.dom.ocellref),lx=e,e.dom.ocellref){const t=e.dom.ocellref.origin.channel;server._emitt(t,`<|"Channel"->"${i}", "Length"->${n}, "CellType"->"wl"|>`,'Forwarded["CM:DropEvent"]')}},file:(t,e,i,n,s)=>{if(e.dom.ocellref)if(s.length>5242880){const t=mx(s,5242880);t.forEach(((e,s)=>{server.emitt(i,`<|"Data"->"${e}", "Name"->"${n}", "Chunk"->${s+1}, "Chunks"->${t.length}|>`,"Chunk")}))}else server.emitt(i,`<|"Data"->"${s}", "Name"->"${n}"|>`,"File")}},bx={transaction:(t,e,i,n)=>{if(console.log(e.dom.ocellref),e.dom.ocellref){const t=e.dom.ocellref.origin.channel;server._emitt(t,`<|"Channel"->"${i}", "Length"->${n}, "CellType"->"wl"|>`,'Forwarded["CM:PasteEvent"]')}},file:(t,e,i,n,s)=>{if(console.log(e.dom.ocellref),e.dom.ocellref)if(s.length>5242880){const t=mx(s,5242880);t.forEach(((e,s)=>{server.emitt(i,`<|"Data"->"${e}", "Name"->"${n}", "Chunk"->${s+1}, "Chunks"->${t.length}|>`,"Chunk")}))}else server.emitt(i,`<|"Data"->"${s}", "Name"->"${n}"|>`,"File")}},vx=[tw.of(ix),Qw(hx),Zw(hx),Mw(hx),Lw(hx),PS(hx),TS(),WS(hx),IS(hx),Bl(),ow,tx,sw(wx,bx,((t,e,i)=>{if(console.log(e.dom.ocellref),e.dom.ocellref){const t=e.dom.ocellref.origin.channel,n=e.dom.ocellref.origin.uid;server._emitt(t,`<|"CellUID"->"${n}", "Content"->"${i}", "CellType"->"wl"|>`,'Forwarded["CM:PasteCellEvent"]')}}))];let yx=Ts.theme({"&.cm-focused":{outline:"1px dashed var(--editor-outline)",background:"inherit"},".cm-line":{padding:0,"padding-left":"2px","align-items":"center"},".cm-activeLine":{"background-color":"transparent"}}),Sx=Ts.theme({"&.cm-focused":{outline:"1px dashed var(--editor-outline)",background:"inherit"},".cm-line":{padding:0,"padding-left":"2px","align-items":"center"},".cm-activeLine":{"background-color":"transparent"},".cm-scroller":{"line-height":"inherit","overflow-x":"overlay","overflow-y":"overlay","align-items":"initial"},".cm-content":{padding:"0px 0"},".rainbow-bracket-red":{color:"var(--editor-bracket-1)"},".rainbow-bracket-orange":{color:"var(--editor-bracket-2)"},".rainbow-bracket-yellow":{color:"var(--editor-bracket-3)"},".rainbow-bracket-green":{color:"var(--editor-bracket-4)"},".rainbow-bracket-blue":{color:"var(--editor-bracket-5)"},".rainbow-bracket-indigo":{color:"var(--editor-bracket-6)"},".rainbow-bracket-violet":{color:"var(--editor-bracket-7)"},".rainbow-bracket-red > span":{color:"var(--editor-bracket-1-a)"},".rainbow-bracket-orange > span":{color:"var(--editor-bracket-2-a)"},".rainbow-bracket-yellow > span":{color:"var(--editor-bracket-3-a)"},".rainbow-bracket-green > span":{color:"var(--editor-bracket-4-a)"},".rainbow-bracket-blue > span":{color:"var(--editor-bracket-5-a)"},".rainbow-bracket-indigo > span":{color:"var(--editor-bracket-6-a)"},".rainbow-bracket-violet > span":{color:"var(--editor-bracket-7-a)"}}),xx=!1;const kx=[()=>vr(),()=>_h(),()=>ir(),()=>ur(),()=>cl(),()=>Bl(),()=>Ts.lineWrapping,()=>Nu(),()=>Tl(ex,{fallback:!1}),()=>ad()],Qx={},$x=[()=>vr(),()=>_h(),()=>ir(),()=>ur(),t=>Px.of(t),()=>Qx.gutter?function(t={}){return[lo.of(t),to(),uo]}():[],()=>cl(),()=>Bl(),()=>Ts.lineWrapping,()=>Nu(),()=>Tl(ex,{fallback:!1}),()=>ad(),()=>HS,()=>function(t){return _i.fromClass(class{constructor(e){this.view=e,this.placeholder=ni.set([ni.widget({widget:new kr(t),side:1}).range(0)])}get decorations(){return this.view.state.doc.length?ni.none:this.placeholder}},{decorations:t=>t.decorations})}("Type WL Expression / .md / .js"),()=>xt.allowMultipleSelections.of(!0),(t,e)=>JS.of(e),()=>KS.of(xt.readOnly.of(!1)),()=>ax,()=>{return t?[fd.of(t),Nd]:Nd;var t},(t,e)=>Ys.of([{key:"Tab",run:function(t,e){const i=du(t);return i||Yc(t)},shift:qc},{key:"Backspace",run:function(e,i){if(0===e.state.doc.length)return t.origin.remove(),!0}},{key:"ArrowLeft",run:function(t,e){t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowRight",run:function(t,e){t.editorLastCursor=t.state.selection.ranges[0].to}},{key:"ArrowUp",run:function(e,i){if(e?.editorLastCursor===e.state.selection.ranges[0].to)return console.log("focus prev"),t.origin.focusPrev(),void(e.editorLastCursor=void 0);e.editorLastCursor=e.state.selection.ranges[0].to}},{key:"ArrowDown",run:function(e,i){if(e?.editorLastCursor===e.state.selection.ranges[0].to)return console.log("focus next"),t.origin.focusNext(),void(e.editorLastCursor=void 0);e.editorLastCursor=e.state.selection.ranges[0].to}},{key:"Shift-Enter",preventDefault:!0,run:function(e,i){console.log(e.state.doc.toString()),t.origin.eval(e.state.doc.toString())}},...Lc,...Bh,...Yd]),(t,e)=>Ts.updateListener.of((e=>{e.docChanged&&t.origin.save(encodeURIComponent(e.state.doc.toString())),e.selectionSet&&(lx=e.view)})),()=>yx];const Px=E.define();function Cx(t){return t.replace(/\\\\:[\da-f]{4}/gi,(function(t){return String.fromCharCode(parseInt(t.replace(/\\\\:/g,""),16))})).replaceAll("\\:F74E","I").replace(/\\:[\da-f]{4}/gi,(function(t){return String.fromCharCode(parseInt(t.replace(/\\:/g,""),16))}))}function _x(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(t=>(+t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+t/4).toString(16)))}core.ReadOnly=()=>"ReadOnly",core.EditorView=async(t,e)=>{let i=await interpretate(t[0],e);i=Cx(i),console.log("UNICODE Disaster");const n=await core._getRules(t,e);let s=()=>{},r=()=>{},o=i;const a=[];n.ReadOnly&&a.push(xt.readOnly.of(!0)),"Selectable"in n&&(n.Selectable||a.push(xt.transactionFilter.of((t=>!1)))),n.ForceUpdate&&(e.local.forceUpdate=n.ForceUpdate),n.FullReset&&(e.local.fullReset=n.FullReset),n.KeepMaxHeight&&(e.local.height=0,e.local.heightKeeper=setInterval((()=>{const t=Math.max(e.local.height,e.element.offsetHeight);e.local.height!=t&&(e.local.height=t,e.element.style.minHeight=e.local.height+"px")}),1e3)),n.Event&&(r=t=>{o=t,e.local.skip?e.local.skip=!1:(console.log("editor view emitt data: "+t),server.kernel.emitt(n.Event,'"'+t.replaceAll('\\"','\\\\"').replaceAll('"','\\"')+'"',"Input"))},s=()=>{server.kernel.emitt(n.Event,'"'+o.replaceAll('\\"','\\\\"').replaceAll('"','\\"')+'"',"Evaluate")}),e.local,e.local.editor=hx({doc:i,parent:e.element,eval:s,update:r,extensions:a}),e.element.style.verticalAlign="inherit"},core.StripOnInput=async()=>{},core.EditorView.update=async(t,e)=>{if(!e.local.editor)return;const i=Cx(await interpretate(t[0],e));console.log("editor view: dispatch"),e.local.forceUpdate,e.local.skip=!0,e.local.fullReset&&(console.log("Editor full reset!!!"),e.local.editor.dispatch({changes:{from:0,to:e.local.editor.state.doc.length,insert:""}})),e.local.editor.dispatch({changes:{from:0,to:e.local.editor.state.doc.length,insert:i}})},core.EditorView.destroy=async(t,e)=>{e.local.heightKeeper&&clearInterval(e.local.heightKeeper),e.local.editor.destroy()},core.EditorView.virtual=!0,core.PreviewCell=(t,e)=>{},window.SupportedLanguages.push({check:t=>null===t,legacy:!0,plugins:vx,name:"mathematica"}),window.SupportedLanguages.push({check:t=>null!=t[0].match(/\w+\.(wl|wls)$/),plugins:vx,legacy:!0,name:"mathematica"}),window.SupportedCells.codemirror={view:class{origin={};editor={};trash=[];forceFocusNext(){xx=!0}focus(t){t>0?this.editor.dispatch({selection:{anchor:0}}):t<0&&this.editor.dispatch({selection:{anchor:this.editor.state.doc.length}}),this.editor.focus()}setContent(t){if(console.warn("content mutation!"),!this.editor.viewState)return;const e=this.editor;console.log("result"),console.log(t),this.editor.dispatch({changes:{from:0,to:e.viewState.state.doc.length,insert:t}})}addDisposable(t){this.trash.push(t)}dispose(){this.editor.destroy()}readOnly(t){this.editor.dispatch({effects:KS.reconfigure(xt.readOnly.of(t))})}constructor(t,e){this.origin=t;const i=this.origin,n=rx(e).plugins,s=this;this.origin.element.ocellref=s;const r=new Ts({doc:(o=e,o.replace(/\\:[\da-f]{4}/gi,(function(t){return String.fromCharCode(parseInt(t.replace(/\\:/g,""),16))}))),extensions:$x.map((t=>t(s,n))),parent:this.origin.element});var o;return this.editor=r,this.editor.dom.ocellref=s,this.editor.viewState.state.config.eval=()=>{i.eval(this.editor.state.doc.toString())},xx&&r.focus(),xx=!1,this}},context:{EditorAutocomplete:ix,javascriptLanguage:mp,javascript:xp,markdownLanguage:Rm,markdown:function(t={}){let{codeLanguages:e,defaultCodeLanguage:i,addKeymap:n=!0,base:{parser:s}=Tm}=t;if(!(s instanceof oO))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let r,o=t.extensions?[t.extensions]:[],a=[Ym.support];i instanceof ja?(a.push(i.support),r=i.language):i&&(r=i);let l=e||r?(h=e,c=r,t=>{if(t&&h){let e=null;if(t=/\S*/.exec(t)[0],e="function"==typeof h?h(t):Na.matchLanguageName(h,t,!0),e instanceof Na)return e.support?e.support.language.parser:Ua.getSkippingParser(e.load());if(e)return e.parser}return c?c.parser:null}):void 0;var h,c;return o.push(function(t){let{codeParser:e,htmlParser:i}=t,n=Io(((t,n)=>{let s=t.type.id;if(!e||s!=Cp.CodeBlock&&s!=Cp.FencedCode){if(i&&(s==Cp.HTMLBlock||s==Cp.HTMLTag))return{parser:i,overlay:RO(t.node,t.from,t.to)}}else{let i="";if(s==Cp.FencedCode){let e=t.node.getChild(Cp.CodeInfo);e&&(i=n.read(e.from,e.to))}let r=e(i);if(r)return{parser:r,overlay:t=>t.type.id==Cp.CodeText}}return null}));return{wrap:n}}({codeParser:l,htmlParser:Ym.language.parser})),n&&a.push(N.high(Ys.of(Um))),new ja(Am(s.configure(o)),a)},htmlLanguage:Sm,html:xm,cssLanguage:Kg,css:tm,syntaxTree:Ma,linter:function(t,e={}){return[df.of({source:t,config:e}),cf,bf]},EditorView:Ts,EditorState:xt,highlightSpecialChars:vr,syntaxHighlighting:Tl,defaultHighlightStyle:ex,editorCustomTheme:yx,foldGutter:function(t={}){let e=Object.assign(Object.assign({},$l),t),i=new Pl(e,!0),n=new Pl(e,!1),s=_i.fromClass(class{constructor(t){this.from=t.viewport.from,this.markers=this.buildMarkers(t)}update(t){(t.docChanged||t.viewportChanged||t.startState.facet(Ba)!=t.state.facet(Ba)||t.startState.field(bl,!1)!=t.state.field(bl,!1)||Ma(t.startState)!=Ma(t.state)||e.foldingChanged(t))&&(this.markers=this.buildMarkers(t.view))}buildMarkers(t){let e=new Xt;for(let s of t.viewportLineBlocks){let r=vl(t.state,s.from,s.to)?n:Ol(t.state,s.from,s.to)?i:null;r&&e.add(s.from,s.from,r)}return e.finish()}}),{domEventHandlers:r}=e;return[s,Jr({class:"cm-foldGutter",markers(t){var e;return(null===(e=t.plugin(s))||void 0===e?void 0:e.markers)||_t.empty},initialSpacer:()=>new Pl(e,!1),domEventHandlers:Object.assign(Object.assign({},r),{click:(t,e,i)=>{if(r.click&&r.click(t,e,i))return!0;let n=vl(t.state,e.from,e.to);if(n)return t.dispatch({effects:wl.of(n)}),!0;let s=Ol(t.state,e.from,e.to);return!!s&&(t.dispatch({effects:ml.of(s)}),!0)}})}),kl()]},Facet:E,Compartment:H,mathematicaPlugins:vx,legacyLangNameFacet:ox,DropPasteHandlers:sw,EditorExtensionsMinimal:kx,EditorParameters:Qx,EditorExtensions:$x,StateField:q,StateEffect:dt,Decoration:ni,Prec:N,EditorSelection:A,keymap:Ys,ViewPlugin:_i,WidgetType:ei,originFacet:Px,MatchDecorator:pr}},window.OfflineMode&&tx.push(xt.readOnly.of(!0)),core.CellView=async(t,e)=>{const i=await core._getRules(t,e);i.Display||(i.Display="codemirror");const n=await interpretate(t[0],e),s={element:e.element,uid:_x()};i.Style&&(e.element.style=i.Style),i.Class&&e.element.classList.add(...i.Class.split(" ")),i.ImageSize&&(Array.isArray(i.ImageSize)?(e.element.style.width=i.ImageSize[0]+"px",e.element.style.height=i.ImageSize[1]+"px"):e.element.style.width=i.ImageSize+"px"),new window.SupportedCells[i.Display].view(s,n)};const Xx={};core.FrontEditorSelected=async(t,e)=>{console.log("check");const i=await interpretate(t[0],e),n=await core._getRules(t,e);let s;switch(n.Editor&&(s=Xx[n.Editor],console.log("Editor"),console.log(n.Editor),console.log(s)),i){case"Get":return fx(s);case"Set":let i=await interpretate(t[1],e);px(i,s);break;case"GetDoc":return ux(s);case"SetDoc":let n=await interpretate(t[1],e);gx(n,s);break;case"Cursor":return dx(s);case"Type":return cx(s);case"Editor":const r=_x();return Xx[r]=Ox(),r}};window.SupportedCells.shell={view:class{dispose(){}constructor(t,e){this.origin=t;const i=document.createElement("div");return i.classList.add(..."flex sc-b max-h-60 text-sm overflow-y-scroll".split(" ")),i.style.overflowAnchor="auto",i.style.flexDirection="column-reverse",i.innerText=e,this.origin.element.appendChild(i),this}}};</script>
<script type="module">
  let boxes = {};
  boxes.name = "WebObjects/Boxes";

  interpretate.contextExpand(boxes);

  boxes.LineBreakWithin = () => {}

  boxes.NumberMarks = () => "NumberMarks"
  boxes.ShowStringCharacters = () => "ShowStringCharacters"

  boxes.Magnification = () => "Magnification"

  boxes.Baseline = () => "Baseline"
  boxes.Background = () => "Background"
  boxes.DefaultBaseStyle = () => "DefaultBaseStyle"
  boxes.Alignment = () => "Alignment"
  boxes.BasePosition  = () => "BasePosition"

  boxes.Center = () => "center"
  boxes.Left = () => "left"
  boxes.Right = () => "right"
  
  boxes.ShowContents = () => "ShowContents"

  function unicodeToChar2(text) {
    return text.replace(/\\\\:[\da-f]{4}/gi, 
           function (match) {
                return String.fromCharCode(parseInt(match.replace(/\\\\:/g, ''), 16));
           }).replaceAll('\\:F74E', 'I').replace(/\\:[\da-f]{4}/gi, 
            function (match) {
                 return String.fromCharCode(parseInt(match.replace(/\\:/g, ''), 16));
            });
  }

  boxes.ViewDecorator = async (args, env) => {
    const type = interpretate(args[0], env);
    await boxes.ViewDecorator[type](args.slice(1), {...env, context:boxes});
  }

  const legends = {}
  legends.name = 'Legends utils'


  legends.EdgeForm = () => {}

  legends.GrayLevel = async (args, env) => {
    const r = Math.round((await interpretate(args[0], env)) * 255);
    env.color = "rgb("+r+","+r+","+r+")";
  }

  legends.Directive = async (args, env) => {
    for (const i of args) {
      await interpretate(i, env);
    }
  }

  legends.PointSize = async (args, env) => {
    const size = await interpretate(args[0], env);
    env.pointSize = size;
  }

  legends.AbsoluteThickness = async (args, env) => {
    const size = await interpretate(args[0], env);
    env.thickness = size;
  }  

  legends.RGBColor = async (args, env) => {      
  if (args.length == 3) {
    const r = (await interpretate(args[0], env)) * 255;
    const g = (await interpretate(args[1], env)) * 255;
    const b = (await interpretate(args[2], env)) * 255;
    env.color = "rgb("+r+","+g+","+b+")";
  } else {
    let a = await interpretate(args[0], env);
    a = a.map((e) => e*255)
    env.color = "rgb("+a[0]+","+a[1]+","+a[2]+")";
  }}

  const requestLabel = async (label, env) => {
    const hash = String(interpretate.hash(label))+'legend';

    let obj;
    console.log('check cache');
    if (ObjectHashMap[hash]) {
        obj = ObjectHashMap[hash];
    } else {
      obj = new ObjectStorage(hash); 
    }
      
    let storage;

    try {
      storage = await obj.get();
    } catch(e) {
      
      const res = await server.kernel.io.fetch('BoxForm`LegendMakeLabel', [hash, JSON.stringify(label)]);
      console.log('We got the result: ', res);
      storage = await obj.get();
    }

    const instance = new ExecutableObject('legend-stored-'+uuidv4(), env, storage, true);
    instance.assignScope(env);
    obj.assign(instance);
    instance.execute();    
  }

  boxes.LineLegend = async (args, env) => {
    return await boxes.GeneralLegend(args, env, function(menv) {
      const marker = document.createElement('div');

      marker.style.backgroundColor = menv.color;
      marker.style.height = menv.thickness*devicePixelRatio + 'px';
      marker.style.width = "1rem";
      return marker;
    });
  }

  boxes.PointLegend = async (args, env) => {
    return await boxes.GeneralLegend(args, env, function(menv) {
      const marker = document.createElement('div');

      marker.style.backgroundColor = menv.color;
      marker.style.borderRadius = "50%";
      marker.style.height = 5*menv.pointsize*devicePixelRatio + 'px';
      marker.style.width = 5*menv.pointsize*devicePixelRatio + 'px';
      return marker;
    });
  }  

  boxes.SwatchLegend = async (args, env) => {
    return await boxes.GeneralLegend(args, env, function(menv) {
      const marker = document.createElement('div');

      marker.style.backgroundColor = menv.color;
      marker.style.borderRadius = "20%";
      marker.style.height = 6*menv.pointsize*devicePixelRatio + 'px';
      marker.style.width = 6*menv.pointsize*devicePixelRatio + 'px';
      return marker;
    });    
  }

  boxes.BarLegend = async (args, env) => {
    const hash = String(interpretate.hash(args))+'bar';

    let obj;
    console.log('check cache');
    if (ObjectHashMap[hash]) {
        obj = ObjectHashMap[hash];
    } else {
      obj = new ObjectStorage(hash); 
    }
      
    let storage;

    try {
      storage = await obj.get();
    } catch(e) {
      
      const res = await server.kernel.io.fetch('BoxForm`makeBarLegend', [hash, JSON.stringify(['List', ...args])]);
      console.log('We got the result: ', res);
      storage = await obj.get();
    }

    const instance = new ExecutableObject('bar-stored-'+uuidv4(), env, storage, true);
    instance.assignScope(env);
    obj.assign(instance);
    instance.execute(); 
  }

  boxes.GeneralLegend = async (args, env, markerFunction) => {
    //const copy = {...env, context: legends, color: black, thickness: 1, pointSize: 1};
 
    const markers = await interpretate(args[0], {...env, hold:true});
    const labels = await interpretate(args[1], {...env, hold:true});

    if (!Array.isArray(markers) || !Array.isArray(labels)) {
      console.error('Markers and labels are not lists');
      console.warn(args);
      return;
    }

    const container = env.element;
    
    container.classList.add('flex', 'flex-col', 'gap-y-1', 'text-left');
    container.style.alignItems = "flex-start";

    for (let i=0; i<markers.length; ++i) {
      const cell = document.createElement('div');
      cell.classList.add('flex', 'flex-row', 'gap-x-2', 'items-baseline');

      const markerEnv = {...env, context: legends, color: 'black', thickness: 2, pointsize: 1};
      await interpretate(markers[i], markerEnv);
      const markerWrapper = document.createElement('div');
      markerWrapper.style.margin = "auto";

      markerWrapper.appendChild(markerFunction(markerEnv));
      cell.appendChild(markerWrapper);

      const label = document.createElement('span');
      label.classList.add('text-sm', 'sm-controls');

      if (typeof labels[i] == 'string') {
        if (labels[i].charAt(0) == "'") {
          if (/\(\*/.exec(labels[i])) {
            await requestLabel(labels[i], {...env, element: label});
          } else {
            label.innerText = unicodeToChar2(labels[i].slice(1,-1));
          }
          
          //cell.classList.add('items-center');
          //cell.classList.remove('items-baseline');
        } else {
          await requestLabel(labels[i], {...env, element: label});
        }
      } else {
        await requestLabel(labels[i], {...env, element: label});
      }

      cell.appendChild(label);

      //const hash = interpretate.hash(labels[i]);


      container.appendChild(cell);
    }
    
  }

  const placedContext = {};

  placedContext.After = async (args, env) => {
    const container = document.createElement('div');
    env.element.parent.appendChild(container);
    return container;
  }

  placedContext.Before = async (args, env) => {
    const container = document.createElement('div');
    env.element.parent.prepend(container);
    return container;
  }

  placedContext.Left = () => 0.2;
  placedContext.Right = () => 0.8;
  placedContext.Top = () => 0.7;
  placedContext.Bottom = () => 0.3;

  const delay = async (time = 1000) => {
    const p = new Promise((resolve) => {
      setTimeout(() => resolve(), time)
    });
    return p;
  }

  placedContext.List = async (args, env) => {
    const x = await interpretate(args[0], env);
    const y = await interpretate(args[1], env);

    await delay(100);
    
    while (env.element.expr.offsetHeight < 100) {
      console.log('the element is too small... probably too early');
      await delay(500);
    }

    const [cliW, cliH] = [env.element.expr.clientWidth, env.element.expr.clientHeight];
    const [offW, offH] = [env.element.expr.offsetWidth, env.element.expr.offsetHeight];

    const left = Math.round((offW - cliW) * 0.5 + cliW * x);
    const bottom = Math.round((offH - cliH) * 0.5 + cliH * y);


    const container = document.createElement('div');
    env.element.parent.appendChild(container);
    container.classList.add('absolute');
    container.style.bottom = bottom + 'px';
    container.style.left = left + 'px';

    return container;
  }


  boxes.Placed = async (args, env) => {
    const place = await interpretate(args[1], {...env, context: placedContext});
    await interpretate(args[0], {...env, context: boxes, element: place});
  }

  boxes.ViewDecorator.Legend = async (args, env) => {
    await boxes.ViewDecorator.Legend2([args[0], ['Placed', args[1], 'After']], env);
    return;
  }

  boxes.ViewDecorator.Legend2 = async (args, env) => {
    const container = document.createElement('div');
    container.classList.add('flex', 'flex-row', 'gap-x-3', 'items-center', 'relative');
    const exprContainer = document.createElement('div');
    env.element.appendChild(container);
    

    container.appendChild(exprContainer);
    await interpretate(args[0], {...env, context:[], element: exprContainer});
    
    await interpretate(args[1], {...env, element: {
      parent: container,
      expr: exprContainer
    } });

    return;
  }

  boxes.ViewDecorator.Semantic = async (args, env) => {
    
    const span = env.global.element;

    const eq = document.createElement('span');
    eq.innerText = '=';
    eq.classList.add('eq-sign', 'bg-white', 'rounded');
    eq.style.position = 'absolute';
    eq.style.left = '-0.28rem';
    const label = document.createElement('span');
    label.style.caretColor = 'black';
    label.style.minHeight = "1.25rem";
    label.style.minWidth = "1rem";
    env.global.element = label;

    span.appendChild(eq);
    span.appendChild(label);
    span.classList.add('px-2', 'py-0.5', 'relative', 'rounded', 'text-sm');
    span.style.border = '2px solid rgb(230, 167, 0)';
    span.style.display = 'inline-flex';
    span.style.alignItems = 'center';
  }

  boxes.ViewDecorator.Rotation = async (args, env) => {
    const degrees = await interpretate(args[0], env);
    env.element.style.transform = `rotate(${Math.floor(degrees/Math.PI*180.0)}deg)`
  }

  boxes.ViewDecorator.Bra = async (args, env) => {
    const pre = document.createElement('span');
    const post = document.createElement('span');
  
    post.innerHTML = "|";
    pre.innerHTML = "&#10216;";
  
    const editor = document.createElement('span');
    env.global.element = editor;
  
    env.element.style.display = "inline-flex";
    env.element.style.alignItems = "baseline";
  
    env.element.appendChild(pre);
    env.element.appendChild(editor);
    env.element.appendChild(post);
  }

  boxes.ViewDecorator.Date = async (args, env) => {
    const element = document.createElement('span');
    element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 pl-3 bg-gray-50 pr-2 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs'.split(' ')));
    element.style.verticalAlign = "baseline";
    //env.element.classList.add('frame-box');
    env.context = boxes;

    const date = await interpretate(args[0], env);
    element.innerText = date.slice(1,-1); 
    env.element.appendChild(element);   
  }

  boxes.ViewDecorator.Indexed = async (args, env) => {
    const data = env.children;

    //console.error(data);

    const sub = document.createElement('sub');
    
    env.element.appendChild(data[0]);
    env.element.appendChild(sub);

    sub.appendChild(data[1]);
    data[0].classList.add("subscript-tail");
    sub.classList.add("subscript-tail", 'mt-auto');    
  }

  boxes.ViewDecorator.RawText = async (args, env) => {
    const text = await interpretate(args[0], {...env, context: boxes});
    env.element.innerHTML = text;
    env.element.style = "font-family: system-ui"    
  }

  boxes.ViewDecorator.Pane = async (args, env) => {
    env.element.classList.add(...('sm-controls cursor-default 0 py-1 text-left text-gray-500 flex flex-row'.split(' '))); 
   // console.warn(args);
    
    const opts = await core._getRules(args, {...env, context: boxes});
    if (opts.ImageSize) {
      const size = opts.ImageSize;
      if (size instanceof Object === true) {
        env.element.style.width = size[0] + 'px';
        env.element.style.height = size[1] + 'px';
      } else {
        env.element.style.maxWidth = size + 'px';
      }
    }

    if (opts.Alignment) {
      const align = opts.Alignment;
      if (Array.isArray(align)) {
        env.element.style.textAlign = align[0];
      } else {
        env.element.style.textAlign = align;
      }
    }

    if (opts.Background) env.element.style.backgroundColor = opts.Background;
    //if (opts.Background) env.element.style.backgroundColor = opts.Background;

    if (opts.Event) {
      const ev = await interpretate(opts.Event, env);
      env.element.addEventListener('click', () => {
        console.log('clicked!');
        server.kernel.emitt(ev, 'True', 'Click')
      })
    }    
  }

  boxes.ViewDecorator.Iconized = async (args, env) => {
    env.context = boxes;
    const opts = await core._getRules(args, env);
    
    if (opts.File) {

      env.element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs'.split(' ')));
      const count = await interpretate(args[0], env);

      if (opts.Label && opts.Label != 'None') {
        env.element.innerHTML = `
        <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none"><path d="M12.6385 3.05526L12.8719 2.08289L12.6385 3.05526ZM13.9373 3.93726L13.2302 4.64437L13.9373 3.93726ZM13.2166 3.29472L13.7391 2.44208L13.2166 3.29472ZM6.09202 20.782L6.54601 19.891L6.09202 20.782ZM5.21799 19.908L6.10899 19.454L5.21799 19.908ZM17.908 20.782L17.454 19.891L17.908 20.782ZM18.782 19.908L17.891 19.454L18.782 19.908ZM18.0627 8.06274L18.7698 7.35563L18.0627 8.06274ZM18.7053 8.78343L19.5579 8.26093L18.7053 8.78343ZM18.9447 9.36154L19.9171 9.12809L18.9447 9.36154ZM5.21799 4.09202L6.10899 4.54601L5.21799 4.09202ZM6.09202 3.21799L6.54601 4.10899L6.09202 3.21799ZM13.9701 11.7575C13.8362 11.2217 13.2933 10.8959 12.7575 11.0299C12.2217 11.1638 11.8959 11.7067 12.0299 12.2425L13.9701 11.7575ZM14.5 18L13.5299 18.2425C13.6411 18.6877 14.0411 19 14.5 19C14.9589 19 15.3589 18.6877 15.4701 18.2425L14.5 18ZM16.9701 12.2425C17.1041 11.7067 16.7783 11.1638 16.2425 11.0299C15.7067 10.8959 15.1638 11.2217 15.0299 11.7575L16.9701 12.2425ZM11 19C11.5523 19 12 18.5523 12 18C12 17.4477 11.5523 17 11 17V19ZM9.23463 17.8478L8.85195 18.7716H8.85195L9.23463 17.8478ZM8.15224 16.7654L7.22836 17.1481H7.22836L8.15224 16.7654ZM11 13C11.5523 13 12 12.5523 12 12C12 11.4477 11.5523 11 11 11V13ZM9.23463 12.1522L8.85195 11.2284L9.23463 12.1522ZM8.15224 13.2346L7.22836 12.8519L8.15224 13.2346ZM14 3.17981C14 2.62752 13.5523 2.17981 13 2.17981C12.4477 2.17981 12 2.62752 12 3.17981H14ZM18.82 10C19.3723 10 19.82 9.55229 19.82 9C19.82 8.44772 19.3723 8 18.82 8V10ZM15.8 20H8.2V22H15.8V20ZM6 17.8V6.2H4V17.8H6ZM8.2 4H11.6745V2H8.2V4ZM18 10.3255V17.8H20V10.3255H18ZM11.6745 4C12.2113 4 12.3167 4.00643 12.405 4.02763L12.8719 2.08289C12.4999 1.99357 12.1161 2 11.6745 2V4ZM14.6444 3.23015C14.3321 2.91791 14.0653 2.64199 13.7391 2.44208L12.6941 4.14736C12.7715 4.19482 12.8506 4.2648 13.2302 4.64437L14.6444 3.23015ZM12.405 4.02763C12.5071 4.05213 12.6046 4.09253 12.6941 4.14736L13.7391 2.44208C13.4707 2.27759 13.178 2.15638 12.8719 2.08289L12.405 4.02763ZM8.2 20C7.62345 20 7.25117 19.9992 6.96784 19.9761C6.69617 19.9539 6.59545 19.9162 6.54601 19.891L5.63803 21.673C6.01641 21.8658 6.40963 21.9371 6.80497 21.9694C7.18864 22.0008 7.65645 22 8.2 22V20ZM4 17.8C4 18.3436 3.99922 18.8114 4.03057 19.195C4.06287 19.5904 4.13419 19.9836 4.32698 20.362L6.10899 19.454C6.0838 19.4045 6.04612 19.3038 6.02393 19.0322C6.00078 18.7488 6 18.3766 6 17.8H4ZM6.54601 19.891C6.35785 19.7951 6.20487 19.6422 6.10899 19.454L4.32698 20.362C4.6146 20.9265 5.07354 21.3854 5.63803 21.673L6.54601 19.891ZM15.8 22C16.3436 22 16.8114 22.0008 17.195 21.9694C17.5904 21.9371 17.9836 21.8658 18.362 21.673L17.454 19.891C17.4045 19.9162 17.3038 19.9539 17.0322 19.9761C16.7488 19.9992 16.3766 20 15.8 20V22ZM18 17.8C18 18.3766 17.9992 18.7488 17.9761 19.0322C17.9539 19.3038 17.9162 19.4045 17.891 19.454L19.673 20.362C19.8658 19.9836 19.9371 19.5904 19.9694 19.195C20.0008 18.8114 20 18.3436 20 17.8H18ZM18.362 21.673C18.9265 21.3854 19.3854 20.9265 19.673 20.362L17.891 19.454C17.7951 19.6422 17.6422 19.7951 17.454 19.891L18.362 21.673ZM17.3556 8.76985C17.7352 9.14941 17.8052 9.22849 17.8526 9.30593L19.5579 8.26093C19.358 7.93471 19.0821 7.66788 18.7698 7.35563L17.3556 8.76985ZM20 10.3255C20 9.8839 20.0064 9.50012 19.9171 9.12809L17.9724 9.59498C17.9936 9.6833 18 9.7887 18 10.3255H20ZM17.8526 9.30593C17.9075 9.3954 17.9479 9.49295 17.9724 9.59498L19.9171 9.12809C19.8436 8.82198 19.7224 8.52935 19.5579 8.26093L17.8526 9.30593ZM6 6.2C6 5.62345 6.00078 5.25117 6.02393 4.96784C6.04612 4.69617 6.0838 4.59545 6.10899 4.54601L4.32698 3.63803C4.13419 4.01641 4.06287 4.40963 4.03057 4.80497C3.99922 5.18864 4 5.65645 4 6.2H6ZM8.2 2C7.65645 2 7.18864 1.99922 6.80497 2.03057C6.40963 2.06287 6.01641 2.13419 5.63803 2.32698L6.54601 4.10899C6.59545 4.0838 6.69617 4.04612 6.96784 4.02393C7.25117 4.00078 7.62345 4 8.2 4V2ZM6.10899 4.54601C6.20487 4.35785 6.35785 4.20487 6.54601 4.10899L5.63803 2.32698C5.07354 2.6146 4.6146 3.07354 4.32698 3.63803L6.10899 4.54601ZM12.0299 12.2425L13.5299 18.2425L15.4701 17.7575L13.9701 11.7575L12.0299 12.2425ZM15.4701 18.2425L16.9701 12.2425L15.0299 11.7575L13.5299 17.7575L15.4701 18.2425ZM11 17C10.5204 17 10.2107 16.9995 9.97376 16.9833C9.74576 16.9677 9.65893 16.9411 9.61732 16.9239L8.85195 18.7716C9.17788 18.9066 9.50779 18.9561 9.83762 18.9787C10.1585 19.0005 10.5477 19 11 19V17ZM7 15C7 15.4523 6.99946 15.8415 7.02135 16.1624C7.04385 16.4922 7.09336 16.8221 7.22836 17.1481L9.07612 16.3827C9.05888 16.3411 9.03227 16.2542 9.01671 16.0262C9.00054 15.7893 9 15.4796 9 15H7ZM9.61732 16.9239C9.37229 16.8224 9.17761 16.6277 9.07612 16.3827L7.22836 17.1481C7.53284 17.8831 8.11687 18.4672 8.85195 18.7716L9.61732 16.9239ZM11 11C10.5477 11 10.1585 10.9995 9.83762 11.0213C9.50779 11.0439 9.17788 11.0934 8.85195 11.2284L9.61732 13.0761C9.65893 13.0589 9.74576 13.0323 9.97376 13.0167C10.2107 13.0005 10.5204 13 11 13V11ZM9 15C9 14.5204 9.00054 14.2107 9.01671 13.9738C9.03227 13.7458 9.05888 13.6589 9.07612 13.6173L7.22836 12.8519C7.09336 13.1779 7.04385 13.5078 7.02135 13.8376C6.99946 14.1585 7 14.5477 7 15H9ZM8.85195 11.2284C8.11686 11.5328 7.53284 12.1169 7.22836 12.8519L9.07612 13.6173C9.17761 13.3723 9.37229 13.1776 9.61732 13.0761L8.85195 11.2284ZM12 3.17981V8H14V3.17981H12ZM14 10H18.82V8H14V10ZM12 8C12 9.10457 12.8954 10 14 10V8V8H12ZM13.2302 4.64437L17.3556 8.76985L18.7698 7.35563L14.6444 3.23015L13.2302 4.64437Z" fill="currentColor"></path> </svg> 
        <span class="leading-normal pl-1">${opts.Label}</span>`;
      } else {
        env.element.innerHTML = `
        <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none"><path d="M12.6385 3.05526L12.8719 2.08289L12.6385 3.05526ZM13.9373 3.93726L13.2302 4.64437L13.9373 3.93726ZM13.2166 3.29472L13.7391 2.44208L13.2166 3.29472ZM6.09202 20.782L6.54601 19.891L6.09202 20.782ZM5.21799 19.908L6.10899 19.454L5.21799 19.908ZM17.908 20.782L17.454 19.891L17.908 20.782ZM18.782 19.908L17.891 19.454L18.782 19.908ZM18.0627 8.06274L18.7698 7.35563L18.0627 8.06274ZM18.7053 8.78343L19.5579 8.26093L18.7053 8.78343ZM18.9447 9.36154L19.9171 9.12809L18.9447 9.36154ZM5.21799 4.09202L6.10899 4.54601L5.21799 4.09202ZM6.09202 3.21799L6.54601 4.10899L6.09202 3.21799ZM13.9701 11.7575C13.8362 11.2217 13.2933 10.8959 12.7575 11.0299C12.2217 11.1638 11.8959 11.7067 12.0299 12.2425L13.9701 11.7575ZM14.5 18L13.5299 18.2425C13.6411 18.6877 14.0411 19 14.5 19C14.9589 19 15.3589 18.6877 15.4701 18.2425L14.5 18ZM16.9701 12.2425C17.1041 11.7067 16.7783 11.1638 16.2425 11.0299C15.7067 10.8959 15.1638 11.2217 15.0299 11.7575L16.9701 12.2425ZM11 19C11.5523 19 12 18.5523 12 18C12 17.4477 11.5523 17 11 17V19ZM9.23463 17.8478L8.85195 18.7716H8.85195L9.23463 17.8478ZM8.15224 16.7654L7.22836 17.1481H7.22836L8.15224 16.7654ZM11 13C11.5523 13 12 12.5523 12 12C12 11.4477 11.5523 11 11 11V13ZM9.23463 12.1522L8.85195 11.2284L9.23463 12.1522ZM8.15224 13.2346L7.22836 12.8519L8.15224 13.2346ZM14 3.17981C14 2.62752 13.5523 2.17981 13 2.17981C12.4477 2.17981 12 2.62752 12 3.17981H14ZM18.82 10C19.3723 10 19.82 9.55229 19.82 9C19.82 8.44772 19.3723 8 18.82 8V10ZM15.8 20H8.2V22H15.8V20ZM6 17.8V6.2H4V17.8H6ZM8.2 4H11.6745V2H8.2V4ZM18 10.3255V17.8H20V10.3255H18ZM11.6745 4C12.2113 4 12.3167 4.00643 12.405 4.02763L12.8719 2.08289C12.4999 1.99357 12.1161 2 11.6745 2V4ZM14.6444 3.23015C14.3321 2.91791 14.0653 2.64199 13.7391 2.44208L12.6941 4.14736C12.7715 4.19482 12.8506 4.2648 13.2302 4.64437L14.6444 3.23015ZM12.405 4.02763C12.5071 4.05213 12.6046 4.09253 12.6941 4.14736L13.7391 2.44208C13.4707 2.27759 13.178 2.15638 12.8719 2.08289L12.405 4.02763ZM8.2 20C7.62345 20 7.25117 19.9992 6.96784 19.9761C6.69617 19.9539 6.59545 19.9162 6.54601 19.891L5.63803 21.673C6.01641 21.8658 6.40963 21.9371 6.80497 21.9694C7.18864 22.0008 7.65645 22 8.2 22V20ZM4 17.8C4 18.3436 3.99922 18.8114 4.03057 19.195C4.06287 19.5904 4.13419 19.9836 4.32698 20.362L6.10899 19.454C6.0838 19.4045 6.04612 19.3038 6.02393 19.0322C6.00078 18.7488 6 18.3766 6 17.8H4ZM6.54601 19.891C6.35785 19.7951 6.20487 19.6422 6.10899 19.454L4.32698 20.362C4.6146 20.9265 5.07354 21.3854 5.63803 21.673L6.54601 19.891ZM15.8 22C16.3436 22 16.8114 22.0008 17.195 21.9694C17.5904 21.9371 17.9836 21.8658 18.362 21.673L17.454 19.891C17.4045 19.9162 17.3038 19.9539 17.0322 19.9761C16.7488 19.9992 16.3766 20 15.8 20V22ZM18 17.8C18 18.3766 17.9992 18.7488 17.9761 19.0322C17.9539 19.3038 17.9162 19.4045 17.891 19.454L19.673 20.362C19.8658 19.9836 19.9371 19.5904 19.9694 19.195C20.0008 18.8114 20 18.3436 20 17.8H18ZM18.362 21.673C18.9265 21.3854 19.3854 20.9265 19.673 20.362L17.891 19.454C17.7951 19.6422 17.6422 19.7951 17.454 19.891L18.362 21.673ZM17.3556 8.76985C17.7352 9.14941 17.8052 9.22849 17.8526 9.30593L19.5579 8.26093C19.358 7.93471 19.0821 7.66788 18.7698 7.35563L17.3556 8.76985ZM20 10.3255C20 9.8839 20.0064 9.50012 19.9171 9.12809L17.9724 9.59498C17.9936 9.6833 18 9.7887 18 10.3255H20ZM17.8526 9.30593C17.9075 9.3954 17.9479 9.49295 17.9724 9.59498L19.9171 9.12809C19.8436 8.82198 19.7224 8.52935 19.5579 8.26093L17.8526 9.30593ZM6 6.2C6 5.62345 6.00078 5.25117 6.02393 4.96784C6.04612 4.69617 6.0838 4.59545 6.10899 4.54601L4.32698 3.63803C4.13419 4.01641 4.06287 4.40963 4.03057 4.80497C3.99922 5.18864 4 5.65645 4 6.2H6ZM8.2 2C7.65645 2 7.18864 1.99922 6.80497 2.03057C6.40963 2.06287 6.01641 2.13419 5.63803 2.32698L6.54601 4.10899C6.59545 4.0838 6.69617 4.04612 6.96784 4.02393C7.25117 4.00078 7.62345 4 8.2 4V2ZM6.10899 4.54601C6.20487 4.35785 6.35785 4.20487 6.54601 4.10899L5.63803 2.32698C5.07354 2.6146 4.6146 3.07354 4.32698 3.63803L6.10899 4.54601ZM12.0299 12.2425L13.5299 18.2425L15.4701 17.7575L13.9701 11.7575L12.0299 12.2425ZM15.4701 18.2425L16.9701 12.2425L15.0299 11.7575L13.5299 17.7575L15.4701 18.2425ZM11 17C10.5204 17 10.2107 16.9995 9.97376 16.9833C9.74576 16.9677 9.65893 16.9411 9.61732 16.9239L8.85195 18.7716C9.17788 18.9066 9.50779 18.9561 9.83762 18.9787C10.1585 19.0005 10.5477 19 11 19V17ZM7 15C7 15.4523 6.99946 15.8415 7.02135 16.1624C7.04385 16.4922 7.09336 16.8221 7.22836 17.1481L9.07612 16.3827C9.05888 16.3411 9.03227 16.2542 9.01671 16.0262C9.00054 15.7893 9 15.4796 9 15H7ZM9.61732 16.9239C9.37229 16.8224 9.17761 16.6277 9.07612 16.3827L7.22836 17.1481C7.53284 17.8831 8.11687 18.4672 8.85195 18.7716L9.61732 16.9239ZM11 11C10.5477 11 10.1585 10.9995 9.83762 11.0213C9.50779 11.0439 9.17788 11.0934 8.85195 11.2284L9.61732 13.0761C9.65893 13.0589 9.74576 13.0323 9.97376 13.0167C10.2107 13.0005 10.5204 13 11 13V11ZM9 15C9 14.5204 9.00054 14.2107 9.01671 13.9738C9.03227 13.7458 9.05888 13.6589 9.07612 13.6173L7.22836 12.8519C7.09336 13.1779 7.04385 13.5078 7.02135 13.8376C6.99946 14.1585 7 14.5477 7 15H9ZM8.85195 11.2284C8.11686 11.5328 7.53284 12.1169 7.22836 12.8519L9.07612 13.6173C9.17761 13.3723 9.37229 13.1776 9.61732 13.0761L8.85195 11.2284ZM12 3.17981V8H14V3.17981H12ZM14 10H18.82V8H14V10ZM12 8C12 9.10457 12.8954 10 14 10V8V8H12ZM13.2302 4.64437L17.3556 8.76985L18.7698 7.35563L14.6444 3.23015L13.2302 4.64437Z" fill="currentColor"></path> </svg> 
        <span class="leading-normal pl-1">${count} bytes</span>`;
      }

    } else {

      
      env.element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs'.split(' ')));
      const count = await interpretate(args[0], env);
      

      if (opts.Label && opts.Label != 'None') {
        env.element.innerHTML = `
        <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none">
    <path d="M18 2L6 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M18 22L6 22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M12 5V10M12 10L15 7M12 10L9 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M12 19V14M12 14L15 17M12 14L9 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg> <span class="leading-normal pl-1">${opts.Label}</span>`;
      } else {
        env.element.innerHTML = `
        <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none">
    <path d="M18 2L6 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M18 22L6 22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M12 5V10M12 10L15 7M12 10L9 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M12 19V14M12 14L15 17M12 14L9 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg> <span class="leading-normal pl-1">${count} bytes</span>`;
      }
    }

  }

  boxes.ViewDecorator.CSWT = async (args, env) => {
    const element = document.createElement('span');

    element.classList.add(...('sm-controls cursor-default rounded-md 0 h-4 w-4 shadow-sm'.split(' ')));
    element.style.verticalAlign = "baseline";

    //env.element.classList.add('frame-box');
    env.context = boxes;

    const color = await interpretate(args[0], env);
    element.style.backgroundColor = color;

    env.element.appendChild(element);    
  }

  boxes.ViewDecorator.Conditional = async (args, env) => {
    const childred = env.children;
    console.log(childred)

    env.element.classList.add('p-1');
    
    const outer = document.createElement('span');

    outer.style.alignItems = "baseline";
    outer.classList.add(...(('flex flex-row gap-x-2 text-sm rounded-md 0 py-1 pl-3 bg-gray-50 pr-2 text-gray-500 ring-1 ring-inset ring-gray-400').split(' ')));

    const textNode = document.createElement('span');
    textNode.innerText = "if";
    textNode.classList.add('text-gray-500', 'font-medium', 'sm-controls');


    
    outer.appendChild(childred[0]);
    outer.appendChild(textNode);
    outer.appendChild(childred[1]);
    env.element.appendChild(outer);    
  }

  boxes.ViewDecorator.Ket = async (args, env) => {
    const pre = document.createElement('span');
    const post = document.createElement('span');
  
    pre.innerHTML = "|";
    post.innerHTML = "&#10217;";
  
    const editor = document.createElement('span');
    env.global.element = editor;
  
    env.element.style.display = "inline-flex";
    env.element.style.alignItems = "baseline";
  
    env.element.appendChild(pre);
    env.element.appendChild(editor);
    env.element.appendChild(post);    
  }  
  
  boxes.ViewDecorator.Entity = async (args, env) => {
    const type = await interpretate(args[0], env);
    const value = await interpretate(args[1], env);

    env.element.classList.add(...('sm-controls gap-x-1 cursor-default rounded-md 0 py-1 px-2 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs'.split(' ')));
    env.element.style.backgroundColor = "#fff291";
    env.element.style.verticalAlign = "baseline";

    const t = document.createElement('span');
    const v = document.createElement('span');

    t.innerText = type;
    v.innerText = value;
    v.classList.add('font-semibold');

    
    env.element.appendChild(v);
    env.element.appendChild(t);    
  }


  boxes.ViewDecorator.Root = async (args, env) => {
    const approx = await interpretate(args[0], env);

    env.element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs flex flex-row items-center'.split(' '))); 
    
    
    const logo = document.createElement('span');
    logo.innerHTML = `<svg class="w-5 h-5 text-teal-500" viewBox="0 0 512 512" >
<g fill="currentColor">
	<g>
		<path d="M491.841,156.427c-19.471-45.946-51.936-85.013-92.786-112.637C358.217,16.166,308.893-0.007,256,0
			c-35.254-0.002-68.946,7.18-99.571,20.158C110.484,39.63,71.416,72.093,43.791,112.943C16.167,153.779-0.007,203.104,0,256
			c-0.002,35.255,7.181,68.948,20.159,99.573c19.471,45.946,51.937,85.013,92.786,112.637C153.783,495.834,203.107,512.007,256,512
			c35.253,0.002,68.946-7.18,99.571-20.158c45.945-19.471,85.013-51.935,112.638-92.785C495.834,358.22,512.007,308.894,512,256
			C512.002,220.744,504.819,187.052,491.841,156.427z M460.413,342.257c-16.851,39.781-45.045,73.724-80.476,97.677
			c-35.443,23.953-78.02,37.926-123.936,37.933c-30.619-0.002-59.729-6.218-86.255-17.454
			c-39.781-16.85-73.724-45.044-97.677-80.475C48.114,344.495,34.14,301.917,34.133,256c0.002-30.62,6.219-59.731,17.454-86.257
			c16.851-39.781,45.045-73.724,80.476-97.677C167.506,48.112,210.084,34.139,256,34.132c30.619,0.002,59.729,6.218,86.255,17.454
			c39.781,16.85,73.724,45.044,97.677,80.475c23.953,35.443,37.927,78.02,37.934,123.938
			C477.864,286.62,471.648,315.731,460.413,342.257z"/>
	</g>
</g>
<g fill="currentColor">
	<g>
		<path d="M389.594,128.108v-0.136h-77.93c-6.234,0-11.905,3.64-14.693,9.217L189.203,352.792l-52.104-104.309
			c-2.789-5.576-8.459-9.182-14.693-9.182H89.007c-9.073,0-16.428,7.626-16.428,16.699c0,9.072,7.355,16.699,16.428,16.699h23.245
			l62.256,124.377c2.789,5.576,8.459,9.013,14.693,9.013c6.234,0,11.905-3.402,14.693-8.979l117.923-235.74h67.777
			c9.072,0,16.428-7.558,16.428-16.631C406.022,135.667,398.668,128.108,389.594,128.108z"/>
	</g>
</g>
</svg>`;
    const a = document.createElement('span');
    if (Complex.isComplex(approx)) {
      a.innerText = `${approx.re} + i ${approx.im}`;
    } else {
      a.innerText = approx;
    }
    a.classList.add('px-1');
    env.element.appendChild(logo);
    env.element.appendChild(a);
  }

  boxes.ViewDecorator.Transpose = async (args, env) => {
    const post = document.createElement('sup');
    post.innerHTML = await interpretate(args[0], env)
    const editor = document.createElement('span');
    env.global.element = editor;
    env.element.style.display = "inline-flex";
    env.element.style.alignItems = "baseline";
    env.element.appendChild(editor);
    env.element.appendChild(post); 
  }



  boxes.ViewDecorator.Quantity = async (args, env) => {
    const n = await interpretate(args[0], env);
    const units = await interpretate(args[1], {...env, context:quantity});

    
    env.element.classList.add(...('text-gray-500 ring-gray-300 ring-1 rounded-lg px-2 text-sm'.split(' ')));
    env.element.style.verticalAlign = 'baseline';

    const add = (nn, nunits, gap = false) => {
      const text = document.createTextNode(nn);
      const u = document.createElement('span');
      u.classList.add('ml-1');
      if (gap) u.classList.add('mr-1');

      if (isDOM(nunits))
        u.appendChild(nunits);
      else
        u.innerText = nunits;

      env.element.appendChild(text);
      env.element.appendChild(u);
    }

    //console.error([n, units, args]);
    
    if (Array.isArray(n)) {
      n[0].forEach((number, index) => {
        //console.error({number, index});
        if (index === n[0].length - 1) 
          add(number, units[0][index], false);
        else 
          add(number, units[0][index], true);
      });
    } else {
      add(n, units);
    }
  }

  boxes.ViewDecorator.Item = async (args, env) => {
    let el = env.global.EditorWidget;
    
    if (!el) {
      el = env.element;
    } else {
      el = el.view.dom;
      const parent = env.global.EditorWidget.view.dom.parentNode;
      if (parent) {
        el = parent;
      }

      env.element.style.display = 'none';
    }

    const opts = await core._getRules(args, {...env, context: boxes});

    if (opts.DefaultBaseStyle) {
      if (opts.DefaultBaseStyle == 'LabeledLabel') {
        el.classList.add('text-sm')
        el.style.fontSize = '0.875rem';
        el.style.lineHeight = '1.25rem';
        el.style.textAlign = 'center';
      }
    }

    if (opts.Alignment) {
      const align = opts.Alignment;
      if (Array.isArray(align)) {
        el.style.textAlign = align[0];
      } else {
        el.style.textAlign = align;
      }
    }
    //console.log(env.global.EditorWidget.view.dom.parentNode);
    //mutate the outer editor

    boxes.StyleDecorator(args, {...env, element: el});    
  }

  boxes.ViewDecorator.Sum = async (args, env) => {
    let vars = await interpretate(args[0], env);
    let bonds = await interpretate(args[1], env);
    
    const number = vars;
    const taken = env.children.slice(1);
    vars = [];
    bonds = [];
    for (let i=0; i<taken.length; i = i + 3) {
      vars.push(taken[i]);
      bonds.push([taken[i+1], taken[i+2]]);
    }   

    const outerDiv = document.createElement('div');
    env.element.appendChild(outerDiv);
    outerDiv.classList.add('flex', 'flex-row', 'items-center');
    // Create the SVG container div
    for (let i=0; i<vars.length; ++i) {
      const svgContainer = document.createElement('div');
      svgContainer.innerHTML = `<svg class="w-7 h-13 text-gray-800" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.809 22H3.46l8.386-10.483L3.386 2H19v3h-1V3H5.613l7.541 8.483L5.54 21h12.65l.92-1.838.894.447z"/><path fill="none" d="M0 0h24v24H0z"/></svg>`;
    
      // Append the SVG container to the outer div
      //outerDiv.appendChild(svgContainer);
      if (bonds) {
        if (i == vars.length - 1) continue;
        const flexColDiv = document.createElement('div');
        flexColDiv.classList.add('flex', 'flex-col', 'h-full', 'justify-between', 'mr-1');
        bonds[i][1].classList.add('text-xs');
        flexColDiv.appendChild(bonds[i][1]);

        const wrapper = document.createElement('span');
        wrapper.classList.add('text-xs', 'flex', 'flex-row');
        wrapper.appendChild(vars[i]);
        wrapper.appendChild(document.createTextNode('='));
        wrapper.appendChild(bonds[i][0]);
        flexColDiv.appendChild(svgContainer);
        flexColDiv.appendChild(wrapper); 
        outerDiv.appendChild(flexColDiv);       
      }
    }
    // Create the flex-col div
    const flexColDiv = document.createElement('div');
    flexColDiv.classList.add('flex', 'flex-col');
    // Create the first text div

    // Create the middle div containing spans
    const middleDiv = document.createElement('div');
    middleDiv.classList.add('flex', 'flex-row');

    if (bonds) {
      const lastBound = bonds[bonds.length - 1];
      lastBound[0].classList.add('text-xs');
      lastBound[1].classList.add('text-xs');
      


      lastBound[1].classList.add('text-xs');
      flexColDiv.appendChild(lastBound[1]);

      const svgContainer = document.createElement('div');
      svgContainer.innerHTML = `<svg class="w-7 h-13 text-gray-800" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.809 22H3.46l8.386-10.483L3.386 2H19v3h-1V3H5.613l7.541 8.483L5.54 21h12.65l.92-1.838.894.447z"/><path fill="none" d="M0 0h24v24H0z"/></svg>`;
    

      const wrapper = document.createElement('span');
      wrapper.classList.add('text-xs', 'flex', 'flex-row');
      wrapper.appendChild(vars[bonds.length - 1]);
      wrapper.appendChild(document.createTextNode('='));
      wrapper.appendChild(lastBound[0]);
      flexColDiv.appendChild(svgContainer);
      flexColDiv.appendChild(wrapper); 

    } else {
      flexColDiv.appendChild(middleDiv);
    }

    outerDiv.appendChild(flexColDiv);

    outerDiv.appendChild(env.children[0]);
    // Create the second text div
    // Append the text and middle divs to the flex-col div
    return;
  }

  boxes.ViewDecorator.Derivative = async (args, env) => {
    const post = document.createElement('sup');
    const powers = await interpretate(args[0], env);
  
    post.innerHTML = "("+powers.join(',')+")";
  
    const editor = document.createElement('span');
    env.global.element = editor;
  
    env.element.style.display = "inline-flex";
    env.element.style.alignItems = "baseline";
  
    env.element.appendChild(editor);
    env.element.appendChild(post);        
  }

  

  boxes.ViewDecorator.Integrate = async (args, env) => {
    //const options = await core._getRules(args, env);

    let vars = await interpretate(args[0], env);
    let bonds = await interpretate(args[1], env);

    const number = vars;
    if (bonds) {
      const taken = env.children.slice(1);
      vars = [];
      bonds = [];
      for (let i=0; i<taken.length; i = i + 3) {
        vars.push(taken[i]);
        bonds.push([taken[i+1], taken[i+2]]);
      }
    } else {
      vars = env.children.slice(1, number + 1); 
    }



    const outerDiv = document.createElement('div');
    env.element.appendChild(outerDiv);
    outerDiv.classList.add('flex', 'flex-row', 'items-center');
    // Create the SVG container div
    for (let i=0; i<vars.length; ++i) {
      const svgContainer = document.createElement('div');
      svgContainer.innerHTML = `<svg class="w-4 h-10 text-gray-800" viewBox="28 7 2.000000 55.000000" preserveAspectRatio="xMidYMid meet">
    
    <g transform="translate(0.000000,75.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
    <path d="M342 648 c-24 -29 -49 -130 -87 -343 -19 -107 -33 -155 -46 -155 -5 0 -8 3 -7 7 2 5 0 9 -4 11 -5 1 -8 0 -8 -3 0 -3 0 -9 0 -15 0 -5 9 -10 20 -10 32 0 48 47 90 262 40 203 59 271 67 236 6 -23 26 -23 21 -1 -4 22 -31 28 -46 11z"></path>
    </g>
    </svg>`;
    
      // Append the SVG container to the outer div
      outerDiv.appendChild(svgContainer);
      if (bonds) {
        if (i == vars.length - 1) continue;
        const flexColDiv = document.createElement('div');
        flexColDiv.classList.add('flex', 'flex-col', 'h-full', 'justify-between', 'mr-1');
        bonds[i][0].classList.add('text-xs', '-ml-2');
      
        bonds[i][1].classList.add('text-xs');
        flexColDiv.appendChild(bonds[i][1]);
        flexColDiv.appendChild(bonds[i][0]); 
        outerDiv.appendChild(flexColDiv);       
      }
    }
    // Create the flex-col div
    const flexColDiv = document.createElement('div');
    flexColDiv.classList.add('flex', 'flex-col');
    // Create the first text div

    // Create the middle div containing spans
    const middleDiv = document.createElement('div');
    middleDiv.classList.add('flex', 'flex-row');

    if (bonds) {
      const lastBound = bonds[bonds.length - 1];
      lastBound[0].classList.add('text-xs', '-ml-2');
      lastBound[1].classList.add('text-xs');

      flexColDiv.appendChild(lastBound[1]);
      flexColDiv.appendChild(middleDiv);
      flexColDiv.appendChild(lastBound[0]);
    } else {
      flexColDiv.appendChild(middleDiv);
    }

    outerDiv.appendChild(flexColDiv);

    middleDiv.appendChild(env.children[0]);

    for (let i=0; i<vars.length; ++i) {
      const sign = document.createElement('span');
      sign.innerHTML = "&dd;";
      sign.classList.add('ml-1');
      middleDiv.appendChild(sign);
      middleDiv.appendChild(vars[i]);
    }
    // Create the second text div
    // Append the text and middle divs to the flex-col div
    return;    
  }

  boxes.ViewDecorator.Intergate = boxes.ViewDecorator.Integrate;

  boxes.ViewDecorator.Grid = async (args, env) => {
    const opts = await core._getRules(args, {...env, context:boxes});
   // console.warn(env);
   // console.warn(opts);
    if (opts.GridBoxDividers) {
      if (!Array.isArray(opts.GridBoxDividers)) return;
      const rows = env.element.children;
      opts.GridBoxDividers.forEach((item) => {
        switch(item.lhs) {
          case 'Columns':
            if (!Array.isArray(item.rhs)) break;
        
            for (let i=0; i<item.rhs.length; ++i) {
              if (item.rhs[i] == true) {
                for(let j=0; j<rows.length; ++j) {
                  if (i>0) {
                    rows[j].children[i-1].classList.add('pr-2');
                  }
                  rows[j].children[i].style.borderLeft = 'solid 1px darkgray';
                  rows[j].children[i].classList.add('pl-2');
                } 
              }
            }
          break;

          case 'Rows':
            if (!Array.isArray(item.rhs)) break;
            for (let i=0; i<item.rhs.length; ++i) {
              if (item.rhs[i] == true) {
                rows[i].style.borderTop = 'solid 1px darkgray';
              }
            }
          break;
        }
      })
    }
  }

  boxes.ViewDecorator.Piecewise = async (args, env) => {
    //let vars = await interpretate(args[0], env);
    const taken = env.children;
    const bonds = [];
    for (let i=0; i<taken.length; i = i + 2) {
      bonds.push([taken[i], taken[i+1]]);
    }       

    const outerDiv = document.createElement('table');
    outerDiv.style.paddingLeft = "0.5rem";
    outerDiv.style.borderLeft = "1px solid black";
    outerDiv.style.borderBottomLeftRadius ="10px";
    outerDiv.style.borderTopLeftRadius = "10px";
    env.element.appendChild(outerDiv);
    outerDiv.classList.add('flex', 'flex-row', 'items-center');

    const table = document.createElement('tbody');
    //table.classList.add('flex', 'flex-col');
    bonds.forEach((pair) => {
      const p = document.createElement('tr');
      //p.classList.add('flex', 'flex-row');
      const cell1 = document.createElement('td');
      cell1.appendChild(pair[0]);
      const cell2 = document.createElement('td');
      cell2.classList.add('pl-5');
      cell2.appendChild(pair[1]);
      p.appendChild(cell1);
      p.appendChild(cell2);

      table.appendChild(p);
    });

    outerDiv.appendChild(table);
  }

  boxes.ViewDecorator.Panel = async (args, env) => {
    const options = await core._getRules(args, {...env, context: boxes});

    let title = undefined;

    if (Object.keys(options).length < args.length) {
      title = await interpretate(args[0], env);
    }

    let margin = 0.7; 
    
    if (options.FrameMargins) margin = Math.round(10.0 * options.FrameMargins / 10.0)/10.0;

    if (options.ImageSize) {
      const size = await interpretate(options.ImageSize, env);
      if (size instanceof Object === true) {
        env.element.style.width = size[0] + 'px';
        env.element.style.height = size[1] + 'px';
      } else {
        env.element.style.maxWidth = size + 'px';
      }
    }


    const editor = document.createElement('span');
    env.global.element = editor;

    env.element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 flex-row'.split(' '))); 
  
    env.element.style.display = "inline-flex";
    env.element.style.alignItems = "baseline";
    env.element.style.padding = margin + "em";

    if (options.Background) env.element.style.backgroundColor = opts.Background;


    if (title) {
      const t = document.createElement('span');
      t.innerText = title;
      env.element.appendChild(t);
    }

    env.element.appendChild(editor); 
    if (options.Event) {
      env.element.addEventListener('click', () => {
        server.kernel.emitt(options.Event, 'True', 'Click')
      })
    }    
  }

  boxes.ViewDecorator.Spacer = async (args, env) => {
    const size = await interpretate(args[0], env);
    if (Array.isArray(size)) {
      env.element.style.width = (size[0]/10.0)+"rem";
      env.element.style.height = (size[1]/10.0)+"rem";
    } else {
      env.element.style.width = (size/10.0)+"rem";
    }

    env.element.innerText=' ';    
  }

  boxes.StyleDecorator = async (args, env) => {
    env.context = boxes;
    const options = await core._getRules(args, env) || {};

    /*if (args.length > Object.keys(options).length) {
      const type = interpretate(args[0], env);
      return await boxes.StyleDecorator[type](args.slice(1), {...env, context:boxes});
    }*/

    //standard
    console.log('style box');
    
    //sort all rules to the end
    args.sort((el) => {
      if(Array.isArray(el)) {
        if (el[0] == 'Rule') return 1;
      }
      return -1;
    });

    if ('Background' in options) {
      env.element.style.backgroundColor = options.Background;
    } 

    if ('FontSize' in options) {
      env.element.style.fontSize = String(options.FontSize) + 'pt';
    } 

    if ('FontFamily' in options) {
      env.element.style.fontFamily = options.FontFamily.toLowerCase();
    }

    if ('Magnification' in options) {
      
      if (typeof options.Magnification == 'number' && !Number.isNaN(options.Magnification )) {
        env.element.style.transform = 'scale('+options.Magnification+')';
        env.element.style.padding = options.Magnification + 'rem';
      } else {
        env.element.style.transform = 'scale(3)';
        console.log({e: env.element.style.transform, options});
        env.element.style.padding = options.Magnification + 'rem';
      }
      
    }

    if ('Underlined' in options) {
      env.element.style.textDecorationLine = 'underline';
      if (typeof options.Underlined == 'string') {
        env.element.style.textDecorationColor = options.Underlined;
      }
    }

    if ('Frame' in options) {
      if (options.Frame) env.element.classList.add('frame-box');
    }

    if ('ShowContents' in options) {
      if (!options.ShowContents) env.element.style.opacity = 0;
    }

    const data = [];
    for (let i=0; i<(args.length - Object.keys(options).length); ++i) {
      let result = await interpretate(args[i], env);
    
      if (typeof result == 'string') {
        result = result.toLocaleLowerCase();

        if (result.slice(0,3) == 'rgb') {
          //this is a color
          env.element.style.color = result;
        } else {
          //this is a font-face
          if (result == 'italic') {
            env.element.style.fontStyle = result;
          } else if (result == 'bold') {
            env.element.style.fontWeight = result;
          } else {
            env.element.style.textDecoration = result;
          }
        }
        continue;
      }
    

      if (typeof result === 'number') {
      
        env.element.style.fontSize = String(result) + 'pt';
        continue;
      }
    }   
  }

  boxes.Smaller = async (args, env) => {
    return 11;
  }

  //!!!LEGACY!!! Only for the compatibillyty with old notebooks
  //!!!LEGACY!!! Only for the compatibillyty with old notebooks
  //!!!LEGACY!!! Only for the compatibillyty with old notebooks
  //!!!LEGACY!!! Only for the compatibillyty with old notebooks


  boxes.RotationBox = async (args, env) => {
    const degrees = await interpretate(args[0], env);
    env.element.style.transform = `rotate(${Math.floor(degrees/Math.PI*180.0)}deg)`
  }

  boxes.ItemBox = async (args, env) => {
    let el = env.global.EditorWidget;
    
    if (!el) {
      el = env.element;
    } else {
      el = el.view.dom;
      const parent = env.global.EditorWidget.view.dom.parentNode;
      if (parent) {
        el = parent;
      }

      env.element.style.display = 'none';
    }

    const opts = await core._getRules(args, {...env, context: boxes});

    if (opts.DefaultBaseStyle) {
      if (opts.DefaultBaseStyle == 'LabeledLabel') {
        el.classList.add('text-sm')
        el.style.fontSize = '0.875rem';
        el.style.lineHeight = '1.25rem';
        el.style.textAlign = 'center';
      }
    }

    if (opts.Alignment) {
      const align = opts.Alignment;
      if (Array.isArray(align)) {
        el.style.textAlign = align[0];
      } else {
        el.style.textAlign = align;
      }
    }
    //console.log(env.global.EditorWidget.view.dom.parentNode);
    //mutate the outer editor

    boxes.StyleBox(args, {...env, element: el});
  }

  boxes.RowBox = async (args, env) => {
    console.log(args);
  }

  boxes.PaneBox = async (args, env) => {
    
    env.element.classList.add(...('sm-controls cursor-default 0 py-1 text-left text-gray-500 flex flex-row'.split(' '))); 
   // console.warn(args);
    
    const opts = await core._getRules(args, {...env, context: boxes});
    if (opts.ImageSize) {
      const size = opts.ImageSize;
      if (size instanceof Object === true) {
        env.element.style.width = size[0] + 'px';
        env.element.style.height = size[1] + 'px';
      } else {
        env.element.style.maxWidth = size + 'px';
      }
    }

    if (opts.Alignment) {
      const align = opts.Alignment;
      if (Array.isArray(align)) {
        env.element.style.textAlign = align[0];
      } else {
        env.element.style.textAlign = align;
      }
    }

    if (opts.Background) env.element.style.backgroundColor = opts.Background;
    //if (opts.Background) env.element.style.backgroundColor = opts.Background;

    if (opts.Event) {
      const ev = await interpretate(opts.Event, env);
      env.element.addEventListener('click', () => {
        console.log('clicked!');
        server.kernel.emitt(ev, 'True', 'Click')
      })
    }
  }

  boxes.RootBox = async (args, env) => {
    const approx = await interpretate(args[0], env);

    env.element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs flex flex-row items-center'.split(' '))); 
    
    
    const logo = document.createElement('span');
    logo.innerHTML = `<svg class="w-5 h-5 text-teal-500" viewBox="0 0 512 512" >
<g fill="currentColor">
	<g>
		<path d="M491.841,156.427c-19.471-45.946-51.936-85.013-92.786-112.637C358.217,16.166,308.893-0.007,256,0
			c-35.254-0.002-68.946,7.18-99.571,20.158C110.484,39.63,71.416,72.093,43.791,112.943C16.167,153.779-0.007,203.104,0,256
			c-0.002,35.255,7.181,68.948,20.159,99.573c19.471,45.946,51.937,85.013,92.786,112.637C153.783,495.834,203.107,512.007,256,512
			c35.253,0.002,68.946-7.18,99.571-20.158c45.945-19.471,85.013-51.935,112.638-92.785C495.834,358.22,512.007,308.894,512,256
			C512.002,220.744,504.819,187.052,491.841,156.427z M460.413,342.257c-16.851,39.781-45.045,73.724-80.476,97.677
			c-35.443,23.953-78.02,37.926-123.936,37.933c-30.619-0.002-59.729-6.218-86.255-17.454
			c-39.781-16.85-73.724-45.044-97.677-80.475C48.114,344.495,34.14,301.917,34.133,256c0.002-30.62,6.219-59.731,17.454-86.257
			c16.851-39.781,45.045-73.724,80.476-97.677C167.506,48.112,210.084,34.139,256,34.132c30.619,0.002,59.729,6.218,86.255,17.454
			c39.781,16.85,73.724,45.044,97.677,80.475c23.953,35.443,37.927,78.02,37.934,123.938
			C477.864,286.62,471.648,315.731,460.413,342.257z"/>
	</g>
</g>
<g fill="currentColor">
	<g>
		<path d="M389.594,128.108v-0.136h-77.93c-6.234,0-11.905,3.64-14.693,9.217L189.203,352.792l-52.104-104.309
			c-2.789-5.576-8.459-9.182-14.693-9.182H89.007c-9.073,0-16.428,7.626-16.428,16.699c0,9.072,7.355,16.699,16.428,16.699h23.245
			l62.256,124.377c2.789,5.576,8.459,9.013,14.693,9.013c6.234,0,11.905-3.402,14.693-8.979l117.923-235.74h67.777
			c9.072,0,16.428-7.558,16.428-16.631C406.022,135.667,398.668,128.108,389.594,128.108z"/>
	</g>
</g>
</svg>`;
    const a = document.createElement('span');
    if (Complex.isComplex(approx)) {
      a.innerText = `${approx.re} + i ${approx.im}`;
    } else {
      a.innerText = approx;
    }
    a.classList.add('px-1');
    env.element.appendChild(logo);
    env.element.appendChild(a);


  }
  boxes.TransposeBox = async (args, env) => {
    const post = document.createElement('sup');
  
    post.innerHTML = await interpretate(args[0], env)
    
  
    const editor = document.createElement('span');
    env.global.element = editor;
  
    env.element.style.display = "inline-flex";
    env.element.style.alignItems = "baseline";
  
    env.element.appendChild(editor);
    env.element.appendChild(post); 
  }

  boxes.DerivativeBox = async (args, env) => {
    const post = document.createElement('sup');
    const powers = await interpretate(args[0], env);
  
    post.innerHTML = "("+powers.join(',')+")";
  
    const editor = document.createElement('span');
    env.global.element = editor;
  
    env.element.style.display = "inline-flex";
    env.element.style.alignItems = "baseline";
  
    env.element.appendChild(editor);
    env.element.appendChild(post);    
  }

  boxes.PiecewiseBox = async (args, env) => {
    //let vars = await interpretate(args[0], env);
    const taken = env.children;
    const bonds = [];
    for (let i=0; i<taken.length; i = i + 2) {
      bonds.push([taken[i], taken[i+1]]);
    }       

    const outerDiv = document.createElement('table');
    outerDiv.style.paddingLeft = "0.5rem";
    outerDiv.style.borderLeft = "1px solid black";
    outerDiv.style.borderBottomLeftRadius ="10px";
    outerDiv.style.borderTopLeftRadius = "10px";
    env.element.appendChild(outerDiv);
    outerDiv.classList.add('flex', 'flex-row', 'items-center');

    const table = document.createElement('tbody');
    //table.classList.add('flex', 'flex-col');
    bonds.forEach((pair) => {
      const p = document.createElement('tr');
      //p.classList.add('flex', 'flex-row');
      const cell1 = document.createElement('td');
      cell1.appendChild(pair[0]);
      const cell2 = document.createElement('td');
      cell2.classList.add('pl-5');
      cell2.appendChild(pair[1]);
      p.appendChild(cell1);
      p.appendChild(cell2);

      table.appendChild(p);
    });

    outerDiv.appendChild(table);


  }

  boxes.ConditionalBox = async (args, env) => {
    const childred = env.children;
    console.log(childred)

    env.element.classList.add('p-1');
    
    const outer = document.createElement('span');

    outer.style.alignItems = "baseline";
    outer.classList.add(...(('flex flex-row gap-x-2 text-sm rounded-md 0 py-1 pl-3 bg-gray-50 pr-2 text-gray-500 ring-1 ring-inset ring-gray-400').split(' ')));

    const textNode = document.createElement('span');
    textNode.innerText = "if";
    textNode.classList.add('text-gray-500', 'font-medium', 'sm-controls');


    
    outer.appendChild(childred[0]);
    outer.appendChild(textNode);
    outer.appendChild(childred[1]);
    env.element.appendChild(outer);
  }

  boxes.IndexedBox = async (args, env) => {
    const data = env.children;

    //console.error(data);

    const sub = document.createElement('sub');
    
    env.element.appendChild(data[0]);
    env.element.appendChild(sub);

    sub.appendChild(data[1]);
    data[0].classList.add("subscript-tail");
    sub.classList.add("subscript-tail", 'mt-auto');

  
    //env.element.style.display = "inline-flex";
    //env.element.style.alignItems = "baseline";
  
    
          

  }

  boxes.SumBox = async (args, env) => {
    let vars = await interpretate(args[0], env);
    let bonds = await interpretate(args[1], env);
    
    const number = vars;
    const taken = env.children.slice(1);
    vars = [];
    bonds = [];
    for (let i=0; i<taken.length; i = i + 3) {
      vars.push(taken[i]);
      bonds.push([taken[i+1], taken[i+2]]);
    }   

    const outerDiv = document.createElement('div');
    env.element.appendChild(outerDiv);
    outerDiv.classList.add('flex', 'flex-row', 'items-center');
    // Create the SVG container div
    for (let i=0; i<vars.length; ++i) {
      const svgContainer = document.createElement('div');
      svgContainer.innerHTML = `<svg class="w-7 h-13 text-gray-800" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.809 22H3.46l8.386-10.483L3.386 2H19v3h-1V3H5.613l7.541 8.483L5.54 21h12.65l.92-1.838.894.447z"/><path fill="none" d="M0 0h24v24H0z"/></svg>`;
    
      // Append the SVG container to the outer div
      //outerDiv.appendChild(svgContainer);
      if (bonds) {
        if (i == vars.length - 1) continue;
        const flexColDiv = document.createElement('div');
        flexColDiv.classList.add('flex', 'flex-col', 'h-full', 'justify-between', 'mr-1');
        bonds[i][1].classList.add('text-xs');
        flexColDiv.appendChild(bonds[i][1]);

        const wrapper = document.createElement('span');
        wrapper.classList.add('text-xs', 'flex', 'flex-row');
        wrapper.appendChild(vars[i]);
        wrapper.appendChild(document.createTextNode('='));
        wrapper.appendChild(bonds[i][0]);
        flexColDiv.appendChild(svgContainer);
        flexColDiv.appendChild(wrapper); 
        outerDiv.appendChild(flexColDiv);       
      }
    }
    // Create the flex-col div
    const flexColDiv = document.createElement('div');
    flexColDiv.classList.add('flex', 'flex-col');
    // Create the first text div

    // Create the middle div containing spans
    const middleDiv = document.createElement('div');
    middleDiv.classList.add('flex', 'flex-row');

    if (bonds) {
      const lastBound = bonds[bonds.length - 1];
      lastBound[0].classList.add('text-xs');
      lastBound[1].classList.add('text-xs');
      


      lastBound[1].classList.add('text-xs');
      flexColDiv.appendChild(lastBound[1]);

      const svgContainer = document.createElement('div');
      svgContainer.innerHTML = `<svg class="w-7 h-13 text-gray-800" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.809 22H3.46l8.386-10.483L3.386 2H19v3h-1V3H5.613l7.541 8.483L5.54 21h12.65l.92-1.838.894.447z"/><path fill="none" d="M0 0h24v24H0z"/></svg>`;
    

      const wrapper = document.createElement('span');
      wrapper.classList.add('text-xs', 'flex', 'flex-row');
      wrapper.appendChild(vars[bonds.length - 1]);
      wrapper.appendChild(document.createTextNode('='));
      wrapper.appendChild(lastBound[0]);
      flexColDiv.appendChild(svgContainer);
      flexColDiv.appendChild(wrapper); 

    } else {
      flexColDiv.appendChild(middleDiv);
    }

    outerDiv.appendChild(flexColDiv);

    outerDiv.appendChild(env.children[0]);
    // Create the second text div
    // Append the text and middle divs to the flex-col div
    return;
  }

  boxes.IntegrateBox = async (args, env) => {
    //const options = await core._getRules(args, env);

    let vars = await interpretate(args[0], env);
    let bonds = await interpretate(args[1], env);

    const number = vars;
    if (bonds) {
      const taken = env.children.slice(1);
      vars = [];
      bonds = [];
      for (let i=0; i<taken.length; i = i + 3) {
        vars.push(taken[i]);
        bonds.push([taken[i+1], taken[i+2]]);
      }
    } else {
      vars = env.children.slice(1, number + 1); 
    }

   

    const outerDiv = document.createElement('div');
    env.element.appendChild(outerDiv);
    outerDiv.classList.add('flex', 'flex-row', 'items-center');
    // Create the SVG container div
    for (let i=0; i<vars.length; ++i) {
      const svgContainer = document.createElement('div');
      svgContainer.innerHTML = `<svg class="w-4 h-10 text-gray-800" viewBox="28 7 2.000000 55.000000" preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,75.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
<path d="M342 648 c-24 -29 -49 -130 -87 -343 -19 -107 -33 -155 -46 -155 -5 0 -8 3 -7 7 2 5 0 9 -4 11 -5 1 -8 0 -8 -3 0 -3 0 -9 0 -15 0 -5 9 -10 20 -10 32 0 48 47 90 262 40 203 59 271 67 236 6 -23 26 -23 21 -1 -4 22 -31 28 -46 11z"></path>
</g>
</svg>`;
    
      // Append the SVG container to the outer div
      outerDiv.appendChild(svgContainer);
      if (bonds) {
        if (i == vars.length - 1) continue;
        const flexColDiv = document.createElement('div');
        flexColDiv.classList.add('flex', 'flex-col', 'h-full', 'justify-between', 'mr-1');
        bonds[i][0].classList.add('text-xs', '-ml-2');

        bonds[i][1].classList.add('text-xs');
        flexColDiv.appendChild(bonds[i][1]);
        flexColDiv.appendChild(bonds[i][0]); 
        outerDiv.appendChild(flexColDiv);       
      }
    }
    // Create the flex-col div
    const flexColDiv = document.createElement('div');
    flexColDiv.classList.add('flex', 'flex-col');
    // Create the first text div

    // Create the middle div containing spans
    const middleDiv = document.createElement('div');
    middleDiv.classList.add('flex', 'flex-row');

    if (bonds) {
      const lastBound = bonds[bonds.length - 1];
      lastBound[0].classList.add('text-xs', '-ml-2');
      lastBound[1].classList.add('text-xs');
      
      flexColDiv.appendChild(lastBound[1]);
      flexColDiv.appendChild(middleDiv);
      flexColDiv.appendChild(lastBound[0]);
    } else {
      flexColDiv.appendChild(middleDiv);
    }

    outerDiv.appendChild(flexColDiv);

    middleDiv.appendChild(env.children[0]);

    for (let i=0; i<vars.length; ++i) {
      const sign = document.createElement('span');
      sign.innerHTML = "&dd;";
      sign.classList.add('ml-1');
      middleDiv.appendChild(sign);
      middleDiv.appendChild(vars[i]);
    }
    // Create the second text div
    // Append the text and middle divs to the flex-col div
    return;

  }

  boxes["CoffeeLiqueur`Extensions`Boxes`Tools`InnerExpression"] = async (args, env) => {
    if (args.length == 0) {
      //console.log(env.global.EditorWidget.getDoc());
      return env.global.EditorWidget.getDoc();
    } 

    const changes = await interpretate(args[0], env);
    env.global.EditorWidget.applyChanges(changes);
    return changes;
  }

  boxes["CoffeeLiqueur`Extensions`Boxes`Tools`OuterExpression"] = async (args, env) => {
    const changes = await interpretate(args[0], env);
    env.global.EditorWidget.applyOuterChanges(changes);
  }  

  boxes.FrameStyle = () => "FrameStyle"

  boxes.FrameBox = async (args, env) => {
      
      env.context = boxes;

      const options = await core._getRules(args, env) || {};
      
      if ('Background' in options) {
          env.element.style.backgroundColor = options.Background;
      }

      if ('DefaultBaseStyle' in options) {
        if (options['DefaultBaseStyle'] == "HighlightedInput") {
          env.element.style.backgroundColor = "yellow"
        }
      }

      if ('FrameStyle' in options) {
        if (!options.FrameStyle) {

        } else {
          env.element.classList.add('frame-box');
        }
      } else {
        env.element.classList.add('frame-box');
      }

      
  }

  boxes.IconizeFileBox = async (args, env) => {
    env.context = boxes;
    env.element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs'.split(' ')));
    const count = await interpretate(args[0], env);
    const opts = await core._getRules(args, env);
    if (opts.Label && opts.Label != 'None') {
      env.element.innerHTML = `
      <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none"><path d="M12.6385 3.05526L12.8719 2.08289L12.6385 3.05526ZM13.9373 3.93726L13.2302 4.64437L13.9373 3.93726ZM13.2166 3.29472L13.7391 2.44208L13.2166 3.29472ZM6.09202 20.782L6.54601 19.891L6.09202 20.782ZM5.21799 19.908L6.10899 19.454L5.21799 19.908ZM17.908 20.782L17.454 19.891L17.908 20.782ZM18.782 19.908L17.891 19.454L18.782 19.908ZM18.0627 8.06274L18.7698 7.35563L18.0627 8.06274ZM18.7053 8.78343L19.5579 8.26093L18.7053 8.78343ZM18.9447 9.36154L19.9171 9.12809L18.9447 9.36154ZM5.21799 4.09202L6.10899 4.54601L5.21799 4.09202ZM6.09202 3.21799L6.54601 4.10899L6.09202 3.21799ZM13.9701 11.7575C13.8362 11.2217 13.2933 10.8959 12.7575 11.0299C12.2217 11.1638 11.8959 11.7067 12.0299 12.2425L13.9701 11.7575ZM14.5 18L13.5299 18.2425C13.6411 18.6877 14.0411 19 14.5 19C14.9589 19 15.3589 18.6877 15.4701 18.2425L14.5 18ZM16.9701 12.2425C17.1041 11.7067 16.7783 11.1638 16.2425 11.0299C15.7067 10.8959 15.1638 11.2217 15.0299 11.7575L16.9701 12.2425ZM11 19C11.5523 19 12 18.5523 12 18C12 17.4477 11.5523 17 11 17V19ZM9.23463 17.8478L8.85195 18.7716H8.85195L9.23463 17.8478ZM8.15224 16.7654L7.22836 17.1481H7.22836L8.15224 16.7654ZM11 13C11.5523 13 12 12.5523 12 12C12 11.4477 11.5523 11 11 11V13ZM9.23463 12.1522L8.85195 11.2284L9.23463 12.1522ZM8.15224 13.2346L7.22836 12.8519L8.15224 13.2346ZM14 3.17981C14 2.62752 13.5523 2.17981 13 2.17981C12.4477 2.17981 12 2.62752 12 3.17981H14ZM18.82 10C19.3723 10 19.82 9.55229 19.82 9C19.82 8.44772 19.3723 8 18.82 8V10ZM15.8 20H8.2V22H15.8V20ZM6 17.8V6.2H4V17.8H6ZM8.2 4H11.6745V2H8.2V4ZM18 10.3255V17.8H20V10.3255H18ZM11.6745 4C12.2113 4 12.3167 4.00643 12.405 4.02763L12.8719 2.08289C12.4999 1.99357 12.1161 2 11.6745 2V4ZM14.6444 3.23015C14.3321 2.91791 14.0653 2.64199 13.7391 2.44208L12.6941 4.14736C12.7715 4.19482 12.8506 4.2648 13.2302 4.64437L14.6444 3.23015ZM12.405 4.02763C12.5071 4.05213 12.6046 4.09253 12.6941 4.14736L13.7391 2.44208C13.4707 2.27759 13.178 2.15638 12.8719 2.08289L12.405 4.02763ZM8.2 20C7.62345 20 7.25117 19.9992 6.96784 19.9761C6.69617 19.9539 6.59545 19.9162 6.54601 19.891L5.63803 21.673C6.01641 21.8658 6.40963 21.9371 6.80497 21.9694C7.18864 22.0008 7.65645 22 8.2 22V20ZM4 17.8C4 18.3436 3.99922 18.8114 4.03057 19.195C4.06287 19.5904 4.13419 19.9836 4.32698 20.362L6.10899 19.454C6.0838 19.4045 6.04612 19.3038 6.02393 19.0322C6.00078 18.7488 6 18.3766 6 17.8H4ZM6.54601 19.891C6.35785 19.7951 6.20487 19.6422 6.10899 19.454L4.32698 20.362C4.6146 20.9265 5.07354 21.3854 5.63803 21.673L6.54601 19.891ZM15.8 22C16.3436 22 16.8114 22.0008 17.195 21.9694C17.5904 21.9371 17.9836 21.8658 18.362 21.673L17.454 19.891C17.4045 19.9162 17.3038 19.9539 17.0322 19.9761C16.7488 19.9992 16.3766 20 15.8 20V22ZM18 17.8C18 18.3766 17.9992 18.7488 17.9761 19.0322C17.9539 19.3038 17.9162 19.4045 17.891 19.454L19.673 20.362C19.8658 19.9836 19.9371 19.5904 19.9694 19.195C20.0008 18.8114 20 18.3436 20 17.8H18ZM18.362 21.673C18.9265 21.3854 19.3854 20.9265 19.673 20.362L17.891 19.454C17.7951 19.6422 17.6422 19.7951 17.454 19.891L18.362 21.673ZM17.3556 8.76985C17.7352 9.14941 17.8052 9.22849 17.8526 9.30593L19.5579 8.26093C19.358 7.93471 19.0821 7.66788 18.7698 7.35563L17.3556 8.76985ZM20 10.3255C20 9.8839 20.0064 9.50012 19.9171 9.12809L17.9724 9.59498C17.9936 9.6833 18 9.7887 18 10.3255H20ZM17.8526 9.30593C17.9075 9.3954 17.9479 9.49295 17.9724 9.59498L19.9171 9.12809C19.8436 8.82198 19.7224 8.52935 19.5579 8.26093L17.8526 9.30593ZM6 6.2C6 5.62345 6.00078 5.25117 6.02393 4.96784C6.04612 4.69617 6.0838 4.59545 6.10899 4.54601L4.32698 3.63803C4.13419 4.01641 4.06287 4.40963 4.03057 4.80497C3.99922 5.18864 4 5.65645 4 6.2H6ZM8.2 2C7.65645 2 7.18864 1.99922 6.80497 2.03057C6.40963 2.06287 6.01641 2.13419 5.63803 2.32698L6.54601 4.10899C6.59545 4.0838 6.69617 4.04612 6.96784 4.02393C7.25117 4.00078 7.62345 4 8.2 4V2ZM6.10899 4.54601C6.20487 4.35785 6.35785 4.20487 6.54601 4.10899L5.63803 2.32698C5.07354 2.6146 4.6146 3.07354 4.32698 3.63803L6.10899 4.54601ZM12.0299 12.2425L13.5299 18.2425L15.4701 17.7575L13.9701 11.7575L12.0299 12.2425ZM15.4701 18.2425L16.9701 12.2425L15.0299 11.7575L13.5299 17.7575L15.4701 18.2425ZM11 17C10.5204 17 10.2107 16.9995 9.97376 16.9833C9.74576 16.9677 9.65893 16.9411 9.61732 16.9239L8.85195 18.7716C9.17788 18.9066 9.50779 18.9561 9.83762 18.9787C10.1585 19.0005 10.5477 19 11 19V17ZM7 15C7 15.4523 6.99946 15.8415 7.02135 16.1624C7.04385 16.4922 7.09336 16.8221 7.22836 17.1481L9.07612 16.3827C9.05888 16.3411 9.03227 16.2542 9.01671 16.0262C9.00054 15.7893 9 15.4796 9 15H7ZM9.61732 16.9239C9.37229 16.8224 9.17761 16.6277 9.07612 16.3827L7.22836 17.1481C7.53284 17.8831 8.11687 18.4672 8.85195 18.7716L9.61732 16.9239ZM11 11C10.5477 11 10.1585 10.9995 9.83762 11.0213C9.50779 11.0439 9.17788 11.0934 8.85195 11.2284L9.61732 13.0761C9.65893 13.0589 9.74576 13.0323 9.97376 13.0167C10.2107 13.0005 10.5204 13 11 13V11ZM9 15C9 14.5204 9.00054 14.2107 9.01671 13.9738C9.03227 13.7458 9.05888 13.6589 9.07612 13.6173L7.22836 12.8519C7.09336 13.1779 7.04385 13.5078 7.02135 13.8376C6.99946 14.1585 7 14.5477 7 15H9ZM8.85195 11.2284C8.11686 11.5328 7.53284 12.1169 7.22836 12.8519L9.07612 13.6173C9.17761 13.3723 9.37229 13.1776 9.61732 13.0761L8.85195 11.2284ZM12 3.17981V8H14V3.17981H12ZM14 10H18.82V8H14V10ZM12 8C12 9.10457 12.8954 10 14 10V8V8H12ZM13.2302 4.64437L17.3556 8.76985L18.7698 7.35563L14.6444 3.23015L13.2302 4.64437Z" fill="currentColor"></path> </svg> 
      <span class="leading-normal pl-1">${opts.Label}</span>`;
    } else {
      env.element.innerHTML = `
      <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none"><path d="M12.6385 3.05526L12.8719 2.08289L12.6385 3.05526ZM13.9373 3.93726L13.2302 4.64437L13.9373 3.93726ZM13.2166 3.29472L13.7391 2.44208L13.2166 3.29472ZM6.09202 20.782L6.54601 19.891L6.09202 20.782ZM5.21799 19.908L6.10899 19.454L5.21799 19.908ZM17.908 20.782L17.454 19.891L17.908 20.782ZM18.782 19.908L17.891 19.454L18.782 19.908ZM18.0627 8.06274L18.7698 7.35563L18.0627 8.06274ZM18.7053 8.78343L19.5579 8.26093L18.7053 8.78343ZM18.9447 9.36154L19.9171 9.12809L18.9447 9.36154ZM5.21799 4.09202L6.10899 4.54601L5.21799 4.09202ZM6.09202 3.21799L6.54601 4.10899L6.09202 3.21799ZM13.9701 11.7575C13.8362 11.2217 13.2933 10.8959 12.7575 11.0299C12.2217 11.1638 11.8959 11.7067 12.0299 12.2425L13.9701 11.7575ZM14.5 18L13.5299 18.2425C13.6411 18.6877 14.0411 19 14.5 19C14.9589 19 15.3589 18.6877 15.4701 18.2425L14.5 18ZM16.9701 12.2425C17.1041 11.7067 16.7783 11.1638 16.2425 11.0299C15.7067 10.8959 15.1638 11.2217 15.0299 11.7575L16.9701 12.2425ZM11 19C11.5523 19 12 18.5523 12 18C12 17.4477 11.5523 17 11 17V19ZM9.23463 17.8478L8.85195 18.7716H8.85195L9.23463 17.8478ZM8.15224 16.7654L7.22836 17.1481H7.22836L8.15224 16.7654ZM11 13C11.5523 13 12 12.5523 12 12C12 11.4477 11.5523 11 11 11V13ZM9.23463 12.1522L8.85195 11.2284L9.23463 12.1522ZM8.15224 13.2346L7.22836 12.8519L8.15224 13.2346ZM14 3.17981C14 2.62752 13.5523 2.17981 13 2.17981C12.4477 2.17981 12 2.62752 12 3.17981H14ZM18.82 10C19.3723 10 19.82 9.55229 19.82 9C19.82 8.44772 19.3723 8 18.82 8V10ZM15.8 20H8.2V22H15.8V20ZM6 17.8V6.2H4V17.8H6ZM8.2 4H11.6745V2H8.2V4ZM18 10.3255V17.8H20V10.3255H18ZM11.6745 4C12.2113 4 12.3167 4.00643 12.405 4.02763L12.8719 2.08289C12.4999 1.99357 12.1161 2 11.6745 2V4ZM14.6444 3.23015C14.3321 2.91791 14.0653 2.64199 13.7391 2.44208L12.6941 4.14736C12.7715 4.19482 12.8506 4.2648 13.2302 4.64437L14.6444 3.23015ZM12.405 4.02763C12.5071 4.05213 12.6046 4.09253 12.6941 4.14736L13.7391 2.44208C13.4707 2.27759 13.178 2.15638 12.8719 2.08289L12.405 4.02763ZM8.2 20C7.62345 20 7.25117 19.9992 6.96784 19.9761C6.69617 19.9539 6.59545 19.9162 6.54601 19.891L5.63803 21.673C6.01641 21.8658 6.40963 21.9371 6.80497 21.9694C7.18864 22.0008 7.65645 22 8.2 22V20ZM4 17.8C4 18.3436 3.99922 18.8114 4.03057 19.195C4.06287 19.5904 4.13419 19.9836 4.32698 20.362L6.10899 19.454C6.0838 19.4045 6.04612 19.3038 6.02393 19.0322C6.00078 18.7488 6 18.3766 6 17.8H4ZM6.54601 19.891C6.35785 19.7951 6.20487 19.6422 6.10899 19.454L4.32698 20.362C4.6146 20.9265 5.07354 21.3854 5.63803 21.673L6.54601 19.891ZM15.8 22C16.3436 22 16.8114 22.0008 17.195 21.9694C17.5904 21.9371 17.9836 21.8658 18.362 21.673L17.454 19.891C17.4045 19.9162 17.3038 19.9539 17.0322 19.9761C16.7488 19.9992 16.3766 20 15.8 20V22ZM18 17.8C18 18.3766 17.9992 18.7488 17.9761 19.0322C17.9539 19.3038 17.9162 19.4045 17.891 19.454L19.673 20.362C19.8658 19.9836 19.9371 19.5904 19.9694 19.195C20.0008 18.8114 20 18.3436 20 17.8H18ZM18.362 21.673C18.9265 21.3854 19.3854 20.9265 19.673 20.362L17.891 19.454C17.7951 19.6422 17.6422 19.7951 17.454 19.891L18.362 21.673ZM17.3556 8.76985C17.7352 9.14941 17.8052 9.22849 17.8526 9.30593L19.5579 8.26093C19.358 7.93471 19.0821 7.66788 18.7698 7.35563L17.3556 8.76985ZM20 10.3255C20 9.8839 20.0064 9.50012 19.9171 9.12809L17.9724 9.59498C17.9936 9.6833 18 9.7887 18 10.3255H20ZM17.8526 9.30593C17.9075 9.3954 17.9479 9.49295 17.9724 9.59498L19.9171 9.12809C19.8436 8.82198 19.7224 8.52935 19.5579 8.26093L17.8526 9.30593ZM6 6.2C6 5.62345 6.00078 5.25117 6.02393 4.96784C6.04612 4.69617 6.0838 4.59545 6.10899 4.54601L4.32698 3.63803C4.13419 4.01641 4.06287 4.40963 4.03057 4.80497C3.99922 5.18864 4 5.65645 4 6.2H6ZM8.2 2C7.65645 2 7.18864 1.99922 6.80497 2.03057C6.40963 2.06287 6.01641 2.13419 5.63803 2.32698L6.54601 4.10899C6.59545 4.0838 6.69617 4.04612 6.96784 4.02393C7.25117 4.00078 7.62345 4 8.2 4V2ZM6.10899 4.54601C6.20487 4.35785 6.35785 4.20487 6.54601 4.10899L5.63803 2.32698C5.07354 2.6146 4.6146 3.07354 4.32698 3.63803L6.10899 4.54601ZM12.0299 12.2425L13.5299 18.2425L15.4701 17.7575L13.9701 11.7575L12.0299 12.2425ZM15.4701 18.2425L16.9701 12.2425L15.0299 11.7575L13.5299 17.7575L15.4701 18.2425ZM11 17C10.5204 17 10.2107 16.9995 9.97376 16.9833C9.74576 16.9677 9.65893 16.9411 9.61732 16.9239L8.85195 18.7716C9.17788 18.9066 9.50779 18.9561 9.83762 18.9787C10.1585 19.0005 10.5477 19 11 19V17ZM7 15C7 15.4523 6.99946 15.8415 7.02135 16.1624C7.04385 16.4922 7.09336 16.8221 7.22836 17.1481L9.07612 16.3827C9.05888 16.3411 9.03227 16.2542 9.01671 16.0262C9.00054 15.7893 9 15.4796 9 15H7ZM9.61732 16.9239C9.37229 16.8224 9.17761 16.6277 9.07612 16.3827L7.22836 17.1481C7.53284 17.8831 8.11687 18.4672 8.85195 18.7716L9.61732 16.9239ZM11 11C10.5477 11 10.1585 10.9995 9.83762 11.0213C9.50779 11.0439 9.17788 11.0934 8.85195 11.2284L9.61732 13.0761C9.65893 13.0589 9.74576 13.0323 9.97376 13.0167C10.2107 13.0005 10.5204 13 11 13V11ZM9 15C9 14.5204 9.00054 14.2107 9.01671 13.9738C9.03227 13.7458 9.05888 13.6589 9.07612 13.6173L7.22836 12.8519C7.09336 13.1779 7.04385 13.5078 7.02135 13.8376C6.99946 14.1585 7 14.5477 7 15H9ZM8.85195 11.2284C8.11686 11.5328 7.53284 12.1169 7.22836 12.8519L9.07612 13.6173C9.17761 13.3723 9.37229 13.1776 9.61732 13.0761L8.85195 11.2284ZM12 3.17981V8H14V3.17981H12ZM14 10H18.82V8H14V10ZM12 8C12 9.10457 12.8954 10 14 10V8V8H12ZM13.2302 4.64437L17.3556 8.76985L18.7698 7.35563L14.6444 3.23015L13.2302 4.64437Z" fill="currentColor"></path> </svg> 
      <span class="leading-normal pl-1">${count} bytes</span>`;
    }

  }

  boxes.EntityBox = async (args, env) => {
    const type = await interpretate(args[0], env);
    const value = await interpretate(args[1], env);

    env.element.classList.add(...('sm-controls gap-x-1 cursor-default rounded-md 0 py-1 px-2 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs'.split(' ')));
    env.element.style.backgroundColor = "#fff291";
    env.element.style.verticalAlign = "baseline";

    const t = document.createElement('span');
    const v = document.createElement('span');

    t.innerText = type;
    v.innerText = value;
    v.classList.add('font-semibold');

    
    env.element.appendChild(v);
    env.element.appendChild(t);
  }

  boxes.IconizeBox = async (args, env) => {
    env.context = boxes;
    env.element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs'.split(' ')));
    const count = await interpretate(args[0], env);
    const opts = await core._getRules(args, env);

    if (opts.Label && opts.Label != 'None') {
      env.element.innerHTML = `
      <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none">
  <path d="M18 2L6 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M18 22L6 22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M12 5V10M12 10L15 7M12 10L9 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M12 19V14M12 14L15 17M12 14L9 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  </svg> <span class="leading-normal pl-1">${opts.Label}</span>`;
    } else {
      env.element.innerHTML = `
      <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none">
  <path d="M18 2L6 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M18 22L6 22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M12 5V10M12 10L15 7M12 10L9 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M12 19V14M12 14L15 17M12 14L9 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  </svg> <span class="leading-normal pl-1">${count} bytes</span>`;
    }

  }

  boxes.Inherited = () => 1.0

  boxes.Italic = () => "Italic"
  boxes.Bold = () => "Bold"
  boxes.Underlined = () => "Underlined"
  boxes.FontSize = () => "FontSize"
  boxes.FontFamily = () => "FontFamily"

  boxes.SpacerBox = async (args, env) => {
    const size = await interpretate(args[0], env);
    if (Array.isArray(size)) {
      env.element.style.width = (size[0]/10.0)+"rem";
      env.element.style.height = (size[1]/10.0)+"rem";
    } else {
      env.element.style.width = (size/10.0)+"rem";
    }

    env.element.innerText=' ';
  }

  boxes.StringBox = async (args, env) => {
    env.context = boxes;
    console.log('string style box');
    
    console.log(args);

    //sort all rules to the end
    args.sort((el) => {
      if(Array.isArray(el)) {
        if (el[0] == 'Rule') return 1;
      }
      return -1;
    });

    const options = await core._getRules(args, env) || {};

    env.element.style.fontFamily = 'system-ui';
    
    if ('Background' in options) {
      env.element.style.backgroundColor = options.Background;
    } 

    if ('FontSize' in options) {
      env.element.style.fontSize = String(options.FontSize) + 'pt';
    } 

    if ('FontFamily' in options) {
      env.element.style.fontFamily = options.FontFamily.toLowerCase();
    }
    if ('Underlined' in options) {
      env.element.style.textDecorationLine = 'underline';
      if (typeof options.Underlined == 'string') {
        env.element.style.textDecorationColor = options.Underlined;
      }
    }    
    
    const data = [];
    for (let i=0; i<(args.length - Object.keys(options).length); ++i) {
      let result = await interpretate(args[i], env);

      if (typeof result == 'string') {
        result = result.toLocaleLowerCase();
        
        if (result.slice(0,3) == 'rgb') {
          //this is a color
          env.element.style.color = result;
        } else {
          //this is a font-face
          if (result == 'italic') {
            env.element.style.fontStyle = result;
          } else if (result == 'bold') {
            env.element.style.fontWeight = result;
          } else {
            env.element.style.textDecoration = result;
          }
        }
        continue;
      }

      
      if (typeof result === 'number') {

        env.element.style.fontSize = String(result) + 'pt';
        continue;
      }
    }

    console.log(data);
  }

  boxes.CommentBox = async (args, env) => {
    env.context = boxes;
    const color = await interpretate(args[0], env);
    env.element.style.color = color;
    env.element.classList.add('subscript-tail', 'sm-controls', 'text-sm');
  }

  boxes.StyleBox = async (args, env) => {
      env.context = boxes;
      console.log('style box');
      
      //sort all rules to the end
      args.sort((el) => {
        if(Array.isArray(el)) {
          if (el[0] == 'Rule') return 1;
        }
        return -1;
      });

      const options = await core._getRules(args, env) || {};

      //env.element.style.fontFamily = 'system-ui';

      if ('Background' in options) {
        env.element.style.backgroundColor = options.Background;
      } 

      if ('FontSize' in options) {
        env.element.style.fontSize = String(options.FontSize) + 'pt';
      } 

      if ('FontFamily' in options) {
        env.element.style.fontFamily = options.FontFamily.toLowerCase();
      }

      if ('Magnification' in options) {
        
        if (typeof options.Magnification == 'number' && !Number.isNaN(options.Magnification )) {
          env.element.style.transform = 'scale('+options.Magnification+')';
          env.element.style.padding = options.Magnification + 'rem';
        } else {
          env.element.style.transform = 'scale(3)';
          console.log({e: env.element.style.transform, options});
          env.element.style.padding = options.Magnification + 'rem';
        }
        
      }

      if ('Underlined' in options) {
        env.element.style.textDecorationLine = 'underline';
        if (typeof options.Underlined == 'string') {
          env.element.style.textDecorationColor = options.Underlined;
        }
      }

      if ('Frame' in options) {
        if (options.Frame) env.element.classList.add('frame-box');
      }

      if ('ShowContents' in options) {
        if (!options.ShowContents) env.element.style.opacity = 0;
      }

      const data = [];
      for (let i=0; i<(args.length - Object.keys(options).length); ++i) {
        let result = await interpretate(args[i], env);
      
        if (typeof result == 'string') {
          result = result.toLocaleLowerCase();

          if (result.slice(0,3) == 'rgb') {
            //this is a color
            env.element.style.color = result;
          } else {
            //this is a font-face
            if (result == 'italic') {
              env.element.style.fontStyle = result;
            } else if (result == 'bold') {
              env.element.style.fontWeight = result;
            } else {
              env.element.style.textDecoration = result;
            }
          }
          continue;
        }
      

        if (typeof result === 'number') {
        
          env.element.style.fontSize = String(result) + 'pt';
          continue;
        }
      }      
  }

  boxes.DateObjectTemplate = async (args, env) => {
      const element = document.createElement('span');
      element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 pl-3 bg-gray-50 pr-2 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs'.split(' ')));
      element.style.verticalAlign = "baseline";
      //env.element.classList.add('frame-box');
      env.context = boxes;

      const date = await interpretate(args[0], env);
      element.innerText = date.slice(1,-1); 
      env.element.appendChild(element);
  }

  boxes.RGBColorSwatchTemplate = async (args, env) => {
      const element = document.createElement('span');

      element.classList.add(...('sm-controls cursor-default rounded-md 0 h-4 w-4 shadow-sm'.split(' ')));
      element.style.verticalAlign = "baseline";

      //env.element.classList.add('frame-box');
      env.context = boxes;

      const color = await interpretate(args[0], env);
      element.style.backgroundColor = color;

      env.element.appendChild(element);
  }

  boxes.Opacity = async (args, env) => {
      return (await interpretate(args[0], env));
  }

  let hsv2hsl = (h,s,v,l=v-v*s/2, m=Math.min(l,1-l)) => [h,m?(v-l)/m:0,l];

  boxes.Hue = async (args, env) => {
      let color = await Promise.all(args.map(el => interpretate(el, env)));
      if (color.length < 3) {
        color = [color[0], 1,1];
      }
      color = hsv2hsl(...color);
      color = [color[0], (color[1]*100).toFixed(2), (color[2]*100).toFixed(2)];

      return "hsl("+(3.14*100*color[0]).toFixed(2)+","+color[1]+"%,"+color[2]+"%)";


  }   

  boxes.GrayLevel = async (args, env) => {
    const r = Math.round((await interpretate(args[0], env)) * 255);
    return "rgb("+r+","+r+","+r+")";
  }

  
  boxes.RGBColor = async (args, env) => {
      if (args.length == 3) {
        const r = (await interpretate(args[0], env)) * 255;
        const g = (await interpretate(args[1], env)) * 255;
        const b = (await interpretate(args[2], env)) * 255;

        return "rgb("+r+","+g+","+b+")";
      } else {
        let a = await interpretate(args[0], env);

        a = a.map((e) => e*255);

        return "rgb("+a[0]+","+a[1]+","+a[2]+")";
      }

      return undefined;
  }

  boxes.FontWeight = () => 'FontWeight'

  /*boxes.PaneSelectorBox = async (args, env) => {
      const list = await interpretate(args[0], {...env, hold:true});
      //needs an editor View
      env.element.innerText = "EditorView is in development";
      env.element.style.border = "1px solid gray";
      env.element.style.borderRadius = "4px";
  }*/

  boxes.DynamicModuleBox = async (args, env) => {
      return await interpretate(args[1], {...env, context: boxes});
    }
    
    boxes.PaneSelectorBox = async (args, env) => {
      const list = await interpretate(args[0], {...env, hold:true});
      //env.element.innerText = data.slice(1,-1);
      env.element.style.paddingLeft = "0.5em";
      env.element.style.paddingRight = "0.5em";
      env.element.style.borderRadius = "4px";
      env.element.style.border = "1px solid gray";
      env.element.style.verticalAlign = "initial";

      const data = await interpretate(list[0][2], env);

      env.element.innerText = data.flat().join(',').slice(1,-1);
    }

    boxes.CM6Grid = async (args, env) => {
      console.warn('this is an temporal fallback to boxes CM6Grid virtual type! Be careful!');
      const data = await interpretate(args[0], env);
      return data;
    }

    boxes.GridBoxDividers = () => "GridBoxDividers"
    
    boxes.GridBox = async (args, env) => {
      const opts = await core._getRules(args, {...env, context:boxes});
     // console.warn(env);
     // console.warn(opts);
      if (opts.GridBoxDividers) {
        if (!Array.isArray(opts.GridBoxDividers)) return;
        const rows = env.element.children;
        opts.GridBoxDividers.forEach((item) => {
          switch(item.lhs) {
            case 'Columns':
              if (!Array.isArray(item.rhs)) break;
          
              for (let i=0; i<item.rhs.length; ++i) {
                if (item.rhs[i] == true) {
                  for(let j=0; j<rows.length; ++j) {
                    if (i>0) {
                      rows[j].children[i-1].classList.add('pr-2');
                    }
                    rows[j].children[i].style.borderLeft = 'solid 1px darkgray';
                    rows[j].children[i].classList.add('pl-2');
                  } 
                }
              }
            break;

            case 'Rows':
              if (!Array.isArray(item.rhs)) break;
              for (let i=0; i<item.rhs.length; ++i) {
                if (item.rhs[i] == true) {
                  rows[i].style.borderTop = 'solid 1px darkgray';
                }
              }
            break;
          }
        })
      }
    }

    
    
    boxes.TagBox = async (args, env) => {
      const name = await interpretate(args[1], env);
      const data = await interpretate(args[0], env);
      const doc = document.createElement('div');
      const result = await boxes.TagBox[name](data, {...env, element:doc});
      env.element.appendChild(doc);
      return result;
    }
    
    boxes.TagBox['SummaryItem'] = async (data, env) => {
      env.element.innerText = data.slice(1,-1);
      env.element.style.paddingLeft = "0.5em";
      env.element.style.paddingRight = "0.5em";
      env.element.style.borderRadius = "4px";
      env.element.style.border = "1px solid gray";
      env.element.style.verticalAlign = "initial";
    }


    boxes.BraDecorator = async (args, env) => {
      const pre = document.createElement('span');
      const post = document.createElement('span');
    
      post.innerHTML = "|";
      pre.innerHTML = "&#10216;";
    
      const editor = document.createElement('span');
      env.global.element = editor;
    
      env.element.style.display = "inline-flex";
      env.element.style.alignItems = "baseline";
    
      env.element.appendChild(pre);
      env.element.appendChild(editor);
      env.element.appendChild(post);
    }
    
    boxes.KetDecorator = async (args, env) => {
      const pre = document.createElement('span');
      const post = document.createElement('span');
    
      pre.innerHTML = "|";
      post.innerHTML = "&#10217;";
    
      const editor = document.createElement('span');
      env.global.element = editor;
    
      env.element.style.display = "inline-flex";
      env.element.style.alignItems = "baseline";
    
      env.element.appendChild(pre);
      env.element.appendChild(editor);
      env.element.appendChild(post);
    }

    boxes.FrameMargins = () => "FrameMargins"

    boxes.PanelBox = async (args, env) => {   
      const options = await core._getRules(args, {...env, context: boxes});

      let title = undefined;

      if (Object.keys(options).length < args.length) {
        title = await interpretate(args[0], env);
      }

      let margin = 0.7; 
      
      if (options.FrameMargins) margin = Math.round(10.0 * options.FrameMargins / 10.0)/10.0;

      if (options.ImageSize) {
        const size = await interpretate(options.ImageSize, env);
        if (size instanceof Object === true) {
          env.element.style.width = size[0] + 'px';
          env.element.style.height = size[1] + 'px';
        } else {
          env.element.style.maxWidth = size + 'px';
        }
      }
  

      const editor = document.createElement('span');
      env.global.element = editor;

      env.element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 flex-row'.split(' '))); 
    
      env.element.style.display = "inline-flex";
      env.element.style.alignItems = "baseline";
      env.element.style.padding = margin + "em";

      if (options.Background) env.element.style.backgroundColor = opts.Background;


      if (title) {
        const t = document.createElement('span');
        t.innerText = title;
        env.element.appendChild(t);
      }

      env.element.appendChild(editor); 
      if (options.Event) {
        env.element.addEventListener('click', () => {
          server.kernel.emitt(options.Event, 'True', 'Click')
        })
      }
    }

    boxes["Internal`RawText"] = async (args, env) => {
      const text = await interpretate(args[0], {...env, context: boxes});
      env.element.innerHTML = text;
      env.element.style = "font-family: system-ui"
    }


    boxes.SpanFromLeft = () => "SpanFromLeft"

    boxes.None = () => "None"
    
    boxes["BoxForm`SummaryItemView"] = async (args, env) => {
      const tr = document.createElement('tr');
      const label = document.createElement('td');
      const content = document.createElement('td');

      content.style.maxWidth = "200px";
    
      label.innerText = (await interpretate(args[0], env)).trim();
    
      
    
      tr.appendChild(label);
      tr.appendChild(content);
    
      env.element.appendChild(tr);

      

      await interpretate(args[1], {...env, context:boxes, element: content});
      //console.warn({...env, context:boxes, element: content});
    
      
    }

    const quantity = {};

    function isDOM(Obj) { 
              
      // Function that checks whether  
      // object is of type Element 
     return Obj instanceof Element; 
 } 


    core.URLDecode = async (args, env) => {
      const str = await interpretate(args[0], env);
      return decodeURIComponent(str)
    }

    core.URLEncode = async (args, env) => {
      const str = await interpretate(args[0], env);
      return encodeURIComponent(str)
    }

    boxes.MixedMagnitude = core.List
    quantity.MixedUnit = core.List

    quantity.Power = (args, env) => {
      const string = interpretate(args[0], env);
      const power = interpretate(args[1], env);

      const container = document.createElement('span');
      const sup = document.createElement('sup');
      if (isDOM(string)) {
        container.appendChild(string);
      } else {
        container.innerText = string;
      }

      if (isDOM(string)) {
        sup.appendChild(power);
      } else {
        sup.innerText = power;
      }

      container.appendChild(sup);
      
      return container;
    }

    core.Interval = (args, env) => {
      return `${interpretate(args[0][1], {}).toFixed(2)}-${interpretate(args[0][2], {}).toFixed(2)}`;
    }

    quantity.Times = (args, env) => {
      const a = args.map((el) => interpretate(el, env));
      const doc = document.createElement('span');

      a.forEach((el, index) => {
        if (isDOM(el)) {
          doc.appendChild(el);
        } else {
          const item = document.createElement('text');
          item.innerText = el;
          doc.appendChild(item);
        } 
        if (index < a.length - 1) {
          const sep = document.createElement('text');
          sep.innerHTML = "&middot;";
          doc.appendChild(sep);
        }
      });

      return doc;
    }

    boxes.QuantityBox = async (args, env) => {
      const n = await interpretate(args[0], env);
      const units = await interpretate(args[1], {...env, context:quantity});

      
      env.element.classList.add(...('text-gray-500 ring-gray-300 ring-1 rounded-lg px-2 text-sm'.split(' ')));
      env.element.style.verticalAlign = 'baseline';

      const add = (nn, nunits, gap = false) => {
        const text = document.createTextNode(nn);
        const u = document.createElement('span');
        u.classList.add('ml-1');
        if (gap) u.classList.add('mr-1');

        if (isDOM(nunits))
          u.appendChild(nunits);
        else
          u.innerText = nunits;
  
        env.element.appendChild(text);
        env.element.appendChild(u);
      }

      //console.error([n, units, args]);
      
      if (Array.isArray(n)) {
        n[0].forEach((number, index) => {
          //console.error({number, index});
          if (index === n[0].length - 1) 
            add(number, units[0][index], false);
          else 
            add(number, units[0][index], true);
        });
      } else {
        add(n, units);
      }


    }

    boxes.ShowStringCharacters = () => "ShowStringCharacters"
    boxes.ShowSpecialCharacters = () => "ShowSpecialCharacters"
    
    boxes.Row = async (args, env) => {
      console.warn('RowBox is not implemented properly for BoxForm`ArrangedSummaryBox!!!');
      args.forEach((el) => {
        interpretate(el, env);
      });
    }
    
    boxes["BoxForm`ArrangedSummaryBox"] = async (args, env) => {
      //console.log(args);

      env.element.style.verticalAlign = 'middle';
      env.element.classList.add(...('sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs flex flex-row'.split(' ')));
    
      let iconElement = document.createElement('span');
      iconElement.classList.add(...('text-gray-500 inline-block mt-auto mb-auto pr-1'.split(' ')));
    
      env.element.appendChild(iconElement);
    
      const table = document.createElement('table');
      table.classList.add(...('pl-1 table-auto'.split(' ')));
      
      let tbodyElement = document.createElement('tbody');
      
      table.appendChild(tbodyElement);
    
      env.element.appendChild(table);
    
      console.log(iconElement.getBoundingClientRect());
    
      const iconWidth = 35 * window.devicePixelRatio;
    
      
      //FIXME: if i skip that, then it messes up with an editors!!!
      await interpretate(args[0], {...env, element: iconElement, imageSize:[iconWidth, iconWidth]});
      await interpretate(args[1], {...env, context: boxes, element: tbodyElement, static:true, local: false});

      if (env.options) {
        if (env.options.DataOnKernel) {
          const warn = document.createElement('span');
          warn.innerText = "Data is on Kernel";
          warn.classList.add('text-gray-400');
        
          tbodyElement.appendChild(warn);
        }
      }
    }
  
  

  boxes["BoxForm`TabViewBox"] = async (args, env) => {
    const labels = await interpretate(args[0], {...env, hold:true});
    const values = await interpretate(args[1], {...env, hold:true});

    const init   = await interpretate(args[2], env);

    //console.warn({labels, values, init});

    env.element.classList.add(...('subscript-tail sm-controls cursor-default rounded-md 0 py-1 px-1 bg-gray-50 text-left text-gray-500 ring-1 ring-inset ring-gray-400 flex-row'.split(' ')));

    const uid = uuidv4();

    env.element.innerHTML = `<div class="flex flex-col">
  <fieldset id="${'fieldset-' + uid}" class="text-sm mb-2 px-2 py-1 rounded"><div class="flex gap-x-4 items-center justify-between">
  </div></fieldset>
  <div class="ml-auto mr-auto relative mb-1" id="${'container-' + uid}">
    
  </div>
  </div>`;

   const fieldset = document.getElementById('fieldset-' + uid);
   const container = document.getElementById('container-' + uid);

   const buttons = [];
   const editors = [];

   const makeActive = (i, st) => {
    if (!st) {
      buttons[i].classList.remove('ring-1', 'ring-inset', 'ring-gray-200', 'bg-white'); 
      editors[i].classList.remove('relative', 'z-10');
      editors[i].classList.add('absolute', 'opacity-0', 'z-0');
    } else {
      buttons[i].classList.add('ring-1', 'ring-inset', 'ring-gray-200', 'bg-white');
      editors[i].classList.remove('absolute', 'opacity-0', 'z-0');
      editors[i].classList.add('relative', 'z-10');
    }
   } 

   let index = 0;
   let active = -1;

   for (const label of labels) {
    const button = document.createElement('button');

    button.classList.add('px-2', 'py-1', 'rounded'); 

    const d = document.createElement('div');
    d.style.pointerEvents = 'none';
    button.appendChild(d);

    fieldset.appendChild(button);

    const result = await interpretate(label, {...env, element: d});
    console.log(result)
    
    if (typeof result != 'object' && result) {
      button.innerText = result;
    }

    const currentIndex = index;
    button.addEventListener('click', () => {
      if (currentIndex == active) return;
      makeActive(currentIndex, true);

      if (active >= 0) makeActive(active, false);
      active = currentIndex;
    })

    buttons.push(button);
    

    index++;
   }

   for (const editor of values) {
    const dom = document.createElement('div');
    dom.classList.add('absolute', 'opacity-0', 'z-0', 'top-0');
    container.appendChild(dom);
    await interpretate(editor, {...env, element: dom});
    editors.push(dom);
   }

   makeActive(init-1, true);
   active = init-1;



   
  }

  boxes.TabViewBox =   boxes["BoxForm`TabViewBox"];</script>
<script type="module">window.ObjectHashMap = {}
//storage for the frontend objects / executables
let garbageCollector = true;

window.ObjectStorage = class {
    refs = {}
    uid = ''
    cached = false
    cache = []
    doNotCollect = false
  
    garbageCollect() {
      console.warn('garbage collector started...');
      let toBeRemoved = true;
      const refs = this.refs;
      Object.keys(refs).forEach((key) => {
        if (refs[key].dead) {
          delete refs[key];
        } else {
          toBeRemoved = false;
        }
      });

      if (toBeRemoved && !this.doNotCollect && garbageCollector) {
        console.warn('No active refs. Removing...');
        delete ObjectHashMap[this.uid];
        delete this.cache;
        delete this.refs;
      }
    }         
  
    constructor(uid) {
      this.uid = uid;
      ObjectHashMap[uid] = this;
      //check garbage
      //renewGarbageTimer();
    }           
  
    //assign an instance of FrontEndExecutable to it
    assign(obj) {
      this.refs[obj.instance] = obj;
    }         
  
    //remove a reference to the instance of FrontEndExecutable
    dropref(obj) {
      console.log('dropped ref: ' + obj.instance);
      delete this.refs[obj.instance];
    }         
  
    //update the data in the storage and go over all assigned objects
    update(newdata) {
      this.cache = newdata;
      Object.keys(this.refs).forEach((ref)=>{
        //console.log('Updating... ' + this.refs[ref].uid);
        this.refs[ref].update();
      });
    }         
  
    //just get the object (if not in the client -> ask for it and wait)
    get() {
      if (this.cached) return this.cache;
      const self = this;
      //throw('Object not found!');

      let target = server;

      const promise = new Deferred();
      console.log(target);
      getObject(target, self.uid).then((result) => {
        self.cache = result;
        //console.log('resolved');
        //console.log(self.cache);
        promise.resolve(self.cache);
      }, (rejected) => {
        console.warn('Rejected! Trying evaluation server instance');
        target = server.kernel;
        
        if (typeof target != 'object') {
          console.error('Object not found on both Frontend & Evaluation Kernel: '+self.uid);
          console.warn(rejected);
          promise.reject('Object not found');
          return;
        }
        
        getObject(target, self.uid).then((result) => {
            self.cache = result;
            //console.log('resolved');
            //console.log(self.cache);
            promise.resolve(self.cache);
        }, (rejected) => {
            console.error('Did not manage to get frontend object '+self.uid);
            console.warn(rejected);
            promise.reject('Object not found');
        });
      })

      return promise.promise;
    }
}



//firstly ask server.kernel.ask()
//if not an object or return $Failed, ask server.ask()

core['CoffeeLiqueur`Extensions`FrontendObject`Internal`Compressed'] = async (args, env) => {
  let string = args[0].slice(1,-1);
  string = await interpretate.unzlib64String(string);

  return await interpretate(JSON.parse(string), env);
}

//Extend Server Class
function getObject(server, id) {
    //console.log(server);
    return server.ask('CoffeeLiqueur`Extensions`FrontendObject`Internal`GetObject["'+id+'"]'); 
}

core.FrontEndVirtual = async (args, env) => {
  const copy = {...env};
  const store = args[0];
  const instance = new ExecutableObject('fevirtual-'+uuidv4(), copy, store);
  instance.assignScope(copy);


  return await instance.execute();
}


//element will be provided in 
core.FrontEndExecutable = async (args, env) => {
    console.log('executable object');
    const uid = await interpretate(args[0], env);

    let obj;
    console.log('check cache');
    if (ObjectHashMap[uid]) {
        obj = ObjectHashMap[uid];
    } else {
        obj = new ObjectStorage(uid);
    }
    //console.log(obj);

    const copy = {...env};
    let store;
    try {
      store = await obj.get();
    } catch (err) {
      if (env.element) {
        env.element.innerText = err;
        env.element.style.color = "rgb(255, 85, 85)";
        env.element.style.background = "rgba(255, 179, 179, 0.2)";
        env.element.classList.add('px-2', 'py-1', 'rounded-md', 'text-xs');
      }
    }

    const instance = new ExecutableObject('static-'+uuidv4(), copy, store, true); // STATIC
    instance.assignScope(copy);
    obj.assign(instance);

    return await instance.execute();
}

core.FrontEndExecutable.destroy = async (args, env) => {
  console.warn("Nothing to do. Will be purged automatically...");
}

//bug fix when importing an old format notebook, context gets lost
core["Global`FrontEndExecutable"] = core.FrontEndExecutable;

const protectedObjects = new Map();

const garbageCollect = () => {
  if (!garbageCollector) return;
  const list = Object.keys(ObjectHashMap);
  for (let i=0; i<list.length; i++) {
    const uid = list[i];
    if (protectedObjects.has(uid)) continue;
    ObjectHashMap[uid].garbageCollect();
  }  
}


core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"] = async (args, env) => {
  const type = await interpretate(args[0], env);
  return core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"][type](args.slice(1), env);
}


core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].GarbageCollector = async (args, env) => {
  garbageCollector = await interpretate(args[0], env);
  if (garbageCollector) console.warn('Garbage collection was enabled!'); else console.warn('Garbage collection was disabled!');
}

core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].Protect = async (args, env) => {
  const list = await interpretate(args, env);
  list.forEach((e) => protectedObjects.set(e, true));
}

core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].Unprotect = async (args, env) => {
  const list = await interpretate(args, env);
  list.forEach((e) => protectedObjects.delete(e));
}

core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].GetAll = async (args, env) => {
  garbageCollect();
  const list = Object.values(ObjectHashMap);
  const message = [];
  for (let i=0; i<list.length; i++) {
    message.push(['Rule', "'"+list[i].uid+"'", list[i].cache]);
  }
  message.unshift('Association');
  //console.log(message);
  return message;
}

core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].GetAllUids = async (args, env) => {
  garbageCollect();
  const list = Object.values(ObjectHashMap);
  const message = [];
  for (let i=0; i<list.length; i++) {
    message.push("'"+list[i].uid+"'");
  }
  message.unshift('List');
  console.log(message);
  return message;
}

core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].GetById = async (args, env) => {
  const uid = await interpretate(args[0], env);
  const opts = await core._getRules(args, env);

  if ('MonitorEvent' in opts) {
    server.emitt(opts['MonitorEvent'], '"'+uid+'"');
  }

  const message = ObjectHashMap[uid].cache;
  console.log(message);
  return message;
}


core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].GetAllSymbols = async (args, env) => {
  //garbageCollect();
  const list = Object.keys(server.kernel.trackedSymbols);
  const message = [];
  for (let i=0; i<list.length; i++) {
    if (Object.keys(core[list[i]].instances).length == 0) {
      console.warn('Dead symbol: '+list[i] + ' found!');
      continue;
    }
    message.push(['Rule', "'"+list[i]+"'", core[list[i]].data]);
  }
  message.unshift('Association');

  return message;
}

core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].GetAllSymbolsNames = async (args, env) => {
  //garbageCollect();
  const list = Object.keys(server.kernel.trackedSymbols);
  const message = [];
  for (let i=0; i<list.length; i++) {
    if (Object.keys(core[list[i]].instances).length == 0) {
      console.warn('Dead symbol: '+list[i] + ' found!');
      continue;
    }
    message.push("'"+list[i]+"'");
  }
  message.unshift('List');
  console.log(message);
  return message;
}

core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].GetSymbolByName = async (args, env) => {
  //garbageCollect();
  const name = await interpretate(args[0], env);
  const opts = await core._getRules(args, env);

  if ('MonitorEvent' in opts) {
    server.emitt(opts['MonitorEvent'], '"'+name+'"');
  }
 
  return core[name].data;
}

core["CoffeeLiqueur`Extensions`FrontendObject`Tools`UIObjects"].Get = async (args, env) => {
  //garbageCollect();
  //const list = Object.values(ObjectHashMap);
  const uid = await interpretate(args[0], env);
  if (ObjectHashMap[uid]) { 
    return ObjectHashMap[uid].cache;
  } else {
    console.error('UIObjects get could not find an object');
    return ['$Failed'];
  }
}</script>
<script type="module">//helps to find instance from server
const MetaMarkers = {};

//DEPRICATED!!!
//DEPRICATED!!!

core.MetaMarker = async (args, env) => {
  if (env.hold) {
    console.log('Held meta-marker expression!');
    return ["MetaMarker", ...args];
  }

  const marker = await interpretate(args[0], env);

  //an exception if no instance provided
  if (!env.root) {
    console.log('NO instance provided!!!');
    console.log('Attaching env only');

    MetaMarkers[marker] = {
      noInstanceQ: true,
      env: env
    };

    return null;
  }


  const inst = env.root.instance;

  console.log('instance '+inst+'is marked as '+marker);
  if (marker in MetaMarkers) {
    MetaMarkers[marker][inst] = env;
  } else {
    MetaMarkers[marker] = {};
    MetaMarkers[marker][inst] = env;
  }


  return null;
}

//DEPRICATED!!!//DEPRICATED!!!

core.MetaMarker.update = (args, env) => {
  //void
}

//DEPRICATED!!!//DEPRICATED!!!
//DEPRICATED!!!//DEPRICATED!!!

core.MetaMarker.destroy = async (args, env) => {
  const marker = await interpretate(args[0], env);
  console.log('dispose marker for instance '+env.root.instance);
  //console.log('in the context');
  //console.log(env);
  //console.log(MetaMarkers[marker]);

  delete MetaMarkers[marker][env.root.instance];
}  

core.FindMetaMarker = async (args, env) => {
  const marker = await interpretate(args[0], env);

  if (marker in MetaMarkers) {
    console.log('found one!');
    const arr =  Object.values(MetaMarkers[marker]);
    const list = arr.map((el) => {
      return ['MetaMarkers', el]
    });

    //console.log('list of markers');
    //console.log(list);

    return list;
  }

  return null;
}

//DEPRICATED!!!//DEPRICATED!!!

const instancesGroups = {};

core.FrontEndInstanceGroup = async (args, env) => {
  const before = Object.keys(env.global.stack);

  const uid = await interpretate(args[1], env);
  const result = await interpretate(args[0], env);

  const after = Object.keys(env.global.stack);

  instancesGroups[uid] = after.filter(x => !before.includes(x)).map((e)=>env.global.stack[e]);
  

  return result;
}

//DEPRICATED!!!//DEPRICATED!!!

core.FrontEndInstanceGroupDestroy = async (args, env) => {
  const uid = await interpretate(args[0], env); 
  instancesGroups[uid].forEach((el) => {
    el.dispose();
  });

  delete instancesGroups[uid];
}

//DEPRICATED!!!//DEPRICATED!!!

core.MarkerContainer = async (args, env) => {
    const expr = args[0];
    const marker = await interpretate(args[1], {...env, hold:true});

    if (marker[0] !== 'MetaMarker') 
        throw 'Last argument is not a MetaMarker object!';
    
    const uid = await interpretate(marker[1], env);
    const results = [];

    if (uid in MetaMarkers) {
      console.log('found Marker');

      if (MetaMarkers[uid].noInstanceQ) {
        console.log('plain env. No instance specified');
        //execute inside given env
        console.log('try!');

        const copy = {...MetaMarkers[uid].env};
  
        //merge the scope
        copy.scope = {...copy.scope, ...env.scope};

        const result = await interpretate(expr, copy);
        results.push(result);

        return results;
      }

      const arr =  Object.values(MetaMarkers[uid]);
      
      for (const instance of arr) {

        //execute inside the container
        console.log('try!');

        if (instance.root.dead) {
          console.log('instance is dead!');
          delete MetaMarkers[uid][instance.root.instance];
          continue;
        }
        //console.log(instanceEnv);
        const copy = {...instance};
  
        //merge the scope
        copy.scope = {...copy.scope, ...env.scope};
  
        //if sleeping?
        if (copy.wake) copy.wake();

        const result = await interpretate(expr, copy);
        results.push(result);
      }
    }  
  
    return results;    
}

//DEPRICATED!!!//DEPRICATED!!!
//DEPRICATED!!!//DEPRICATED!!!

const contrainersBox = {};

core.DeleteExecutablesBox = async (args, env) => {
  let containersBoxIDs =  await interpretate(args[0], env);
  if (!containersBoxIDs.length) containersBoxIDs = [containersBoxIDs];

  containersBoxIDs.forEach((e) => {
    console.log("disposing object...");
    e.dispose();
  })
  //somehow remove them
}

//DEPRICATED!!!//DEPRICATED!!!
//DEPRICATED!!!//DEPRICATED!!!

//a much more complicated version, where you are using object to return
core.MarkerContainerExtended = async (args, env) => {
  if (args.length < 3) {
    console.log('MarkerContainerExtended cannot be evaluated on the frontend with only 2 argument!');
    throw 'MarkerContainerExtended cannot be evaluated on the frontend with only 2 argument!';
  }

  const expr = args[0];

  //where this thing will be placed
  //to omitt communication between WLJS and WL
  const containersBoxID =  await interpretate(args[2], env);

  const Box = [];

  //CORRENTLY SUPPORTS ONLY METAMARKER OBJECTS
  const marker = await interpretate(args[1], {...env, hold:true});

  if (marker[0] !== 'MetaMarker') {
    throw 'FrontSubmit cannot be evaluated on the frontend with only MetaMarker as a second argument';
  }

  const uid = await interpretate(marker[1], env);
  const results = [];

  if (uid in MetaMarkers) {
    console.log('found one! ');
    const arr =  Object.values(MetaMarkers[uid]);
    
    for (const instance of arr) {
      //execute inside the container
      console.log('try!');
      //console.log(instanceEnv);
      const copy = {...instance};

      //merge the scope
      copy.scope = {...copy.scope, ...env.scope};
      if (!copy.global.hooks) copy.global.hooks = [];
      copy.global.hooks.push((obj)=>{
        Box.push(obj);
      });

      const result = await interpretate(expr, copy);

      results.push(result);
    }
  }  

  contrainersBox[containersBoxID] = Box;
  return results;
}</script>
<script type="module">core.FSAskKernelSocket = async (args, env) => {
    return await server.kernel.ask('Global`$Client');
}

core.FSAsk = async (args, env) => {
    const result = await interpretate(args[0], env);
    const uid = await interpretate(args[1], env);
    console.warn("A request from kernel server");
    //console.log(result);
    //console.log(JSON.stringify(result));

    server.kernel.emitt(uid, '"' + encodeURIComponent(JSON.stringify(result)) + '"');
}

const references = {};

core.FrontInstanceReference = (args, env) => {
    if (env.hold) {
      console.log('Held FrontInstanceReference expression!');
      return ["FrontInstanceReference", ...args];
    }
  
    const uid = interpretate(args[0], env);
  
    //an exception if no instance provided
    if (!env.root) {
      console.log('No instance provided!!!');
      console.log('Attaching env only');
  
      references[uid] = {
        noInstanceQ: true,
        env: env
      };
  
      return null;
    }
  
  
    const inst = env.root.instance;
  
    console.log('instance '+inst+' is referenced as '+uid);

    references[uid] = env;
  
  
    return null;
  }
  
core.FrontInstanceReference.update = (args, env) => {
    //void
}
  
core.FrontInstanceReference.destroy = (args, env) => {
  //FIXME: Probably will never be called!!!
    const uid = interpretate(args[0], env);
    console.log('dispose instancereference for instance '+env.root.instance);

    delete references[uid];
}  

core['CoffeeLiqueur`Extensions`Communication`Private`exec'] = async (args, env) => {
    const expr = args[0];
    const uid = interpretate(args[1], env);

    if (uid in references) {
        let r = references[uid];

        if (r.noInstanceQ) {
            r = r.env;
            console.log('plain env. No instance specified'); 
            //will be normally disposed
            const copy = {...r};
            //merge the scope
            copy.scope = {...copy.scope, ...env.scope};
    
            return (await interpretate(expr, copy))
        }

        if (r.root.dead) {
          console.log('instance is dead!');
          delete references[uid];
          return undefined;
        }

        //~~NOneeed: create an independent stack
        //will be normally disposed
        const copy = {...r};
      
        //merge the scope
        copy.scope = {...copy.scope, ...env.scope};
  
        //if sleeping?
        if (copy.wake) copy.wake();

        return (await interpretate(expr, copy));  
    }
}

const instancesGroups = {};

core.FrontInstanceGroup = async (args, env) => {
  const uid = interpretate(args[0], env);
  //throw env.global.stack;
  const stack = {};
  instancesGroups[uid] = stack; //replace stack with a new one, cuz anyway it will be manually disposed.

  const result = await interpretate(args[1], {...env, global: {...env.global, stack: stack}});

  

  /*const after = Object.keys(env.global.stack);
  instancesGroups[uid] = after.filter(x => !before.includes(x)).map((e)=>env.global.stack[e]);*/
  

  return result;
}

core['CoffeeLiqueur`Extensions`Communication`Private`groupRemove'] = (args, env) => {
  const uid = interpretate(args[0], env); 
  const g = instancesGroups[uid];
  if (!g) return;

  Object.values(g).forEach((el) => {
    el.dispose();
  });

  delete instancesGroups[uid];
}

core['CoffeeLiqueur`Extensions`Communication`Private`groupRemoveAll'] = async (args, env) => {
    const uids = await interpretate(args[0], env); 

    for (const k of uids) {
        const g = instancesGroups[k];
        if (!g) continue;
        Object.values(g).forEach((el) => {
          el.dispose();
        });
    
        delete instancesGroups[k];
    }
}
</script>
<script type="module">const loader = async (self) => {
    self["d3"] = await Promise.resolve().then(function () { return index$1; });
    self["d3-interpolate-path"] = await Promise.resolve().then(function () { return d3InterpolatePath; });
    self["d3-arrow"] = await Promise.resolve().then(function () { return index; });
    console.log('D3 shared library loaded!');
  };

  new interpretate.shared(
    "d3",
    loader
  );

function ascending$3(a, b) {
  return a == null || b == null ? NaN : a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;
}

function descending$2(a, b) {
  return a == null || b == null ? NaN
    : b < a ? -1
    : b > a ? 1
    : b >= a ? 0
    : NaN;
}

function bisector(f) {
  let compare1, compare2, delta;

  // If an accessor is specified, promote it to a comparator. In this case we
  // can test whether the search value is (self-) comparable. We can’t do this
  // for a comparator (except for specific, known comparators) because we can’t
  // tell if the comparator is symmetric, and an asymmetric comparator can’t be
  // used to test whether a single value is comparable.
  if (f.length !== 2) {
    compare1 = ascending$3;
    compare2 = (d, x) => ascending$3(f(d), x);
    delta = (d, x) => f(d) - x;
  } else {
    compare1 = f === ascending$3 || f === descending$2 ? f : zero$1;
    compare2 = f;
    delta = f;
  }

  function left(a, x, lo = 0, hi = a.length) {
    if (lo < hi) {
      if (compare1(x, x) !== 0) return hi;
      do {
        const mid = (lo + hi) >>> 1;
        if (compare2(a[mid], x) < 0) lo = mid + 1;
        else hi = mid;
      } while (lo < hi);
    }
    return lo;
  }

  function right(a, x, lo = 0, hi = a.length) {
    if (lo < hi) {
      if (compare1(x, x) !== 0) return hi;
      do {
        const mid = (lo + hi) >>> 1;
        if (compare2(a[mid], x) <= 0) lo = mid + 1;
        else hi = mid;
      } while (lo < hi);
    }
    return lo;
  }

  function center(a, x, lo = 0, hi = a.length) {
    const i = left(a, x, lo, hi - 1);
    return i > lo && delta(a[i - 1], x) > -delta(a[i], x) ? i - 1 : i;
  }

  return {left, center, right};
}

function zero$1() {
  return 0;
}

function number$3(x) {
  return x === null ? NaN : +x;
}

function* numbers(values, valueof) {
  if (valueof === undefined) {
    for (let value of values) {
      if (value != null && (value = +value) >= value) {
        yield value;
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null && (value = +value) >= value) {
        yield value;
      }
    }
  }
}

const ascendingBisect = bisector(ascending$3);
const bisectRight = ascendingBisect.right;
const bisectLeft = ascendingBisect.left;
const bisectCenter = bisector(number$3).center;
var bisect = bisectRight;

function blur(values, r) {
  if (!((r = +r) >= 0)) throw new RangeError("invalid r");
  let length = values.length;
  if (!((length = Math.floor(length)) >= 0)) throw new RangeError("invalid length");
  if (!length || !r) return values;
  const blur = blurf(r);
  const temp = values.slice();
  blur(values, temp, 0, length, 1);
  blur(temp, values, 0, length, 1);
  blur(values, temp, 0, length, 1);
  return values;
}

const blur2 = Blur2(blurf);

const blurImage = Blur2(blurfImage);

function Blur2(blur) {
  return function(data, rx, ry = rx) {
    if (!((rx = +rx) >= 0)) throw new RangeError("invalid rx");
    if (!((ry = +ry) >= 0)) throw new RangeError("invalid ry");
    let {data: values, width, height} = data;
    if (!((width = Math.floor(width)) >= 0)) throw new RangeError("invalid width");
    if (!((height = Math.floor(height !== undefined ? height : values.length / width)) >= 0)) throw new RangeError("invalid height");
    if (!width || !height || (!rx && !ry)) return data;
    const blurx = rx && blur(rx);
    const blury = ry && blur(ry);
    const temp = values.slice();
    if (blurx && blury) {
      blurh(blurx, temp, values, width, height);
      blurh(blurx, values, temp, width, height);
      blurh(blurx, temp, values, width, height);
      blurv(blury, values, temp, width, height);
      blurv(blury, temp, values, width, height);
      blurv(blury, values, temp, width, height);
    } else if (blurx) {
      blurh(blurx, values, temp, width, height);
      blurh(blurx, temp, values, width, height);
      blurh(blurx, values, temp, width, height);
    } else if (blury) {
      blurv(blury, values, temp, width, height);
      blurv(blury, temp, values, width, height);
      blurv(blury, values, temp, width, height);
    }
    return data;
  };
}

function blurh(blur, T, S, w, h) {
  for (let y = 0, n = w * h; y < n;) {
    blur(T, S, y, y += w, 1);
  }
}

function blurv(blur, T, S, w, h) {
  for (let x = 0, n = w * h; x < w; ++x) {
    blur(T, S, x, x + n, w);
  }
}

function blurfImage(radius) {
  const blur = blurf(radius);
  return (T, S, start, stop, step) => {
    start <<= 2, stop <<= 2, step <<= 2;
    blur(T, S, start + 0, stop + 0, step);
    blur(T, S, start + 1, stop + 1, step);
    blur(T, S, start + 2, stop + 2, step);
    blur(T, S, start + 3, stop + 3, step);
  };
}

// Given a target array T, a source array S, sets each value T[i] to the average
// of {S[i - r], …, S[i], …, S[i + r]}, where r = ⌊radius⌋, start <= i < stop,
// for each i, i + step, i + 2 * step, etc., and where S[j] is clamped between
// S[start] (inclusive) and S[stop] (exclusive). If the given radius is not an
// integer, S[i - r - 1] and S[i + r + 1] are added to the sum, each weighted
// according to r - ⌊radius⌋.
function blurf(radius) {
  const radius0 = Math.floor(radius);
  if (radius0 === radius) return bluri(radius);
  const t = radius - radius0;
  const w = 2 * radius + 1;
  return (T, S, start, stop, step) => { // stop must be aligned!
    if (!((stop -= step) >= start)) return; // inclusive stop
    let sum = radius0 * S[start];
    const s0 = step * radius0;
    const s1 = s0 + step;
    for (let i = start, j = start + s0; i < j; i += step) {
      sum += S[Math.min(stop, i)];
    }
    for (let i = start, j = stop; i <= j; i += step) {
      sum += S[Math.min(stop, i + s0)];
      T[i] = (sum + t * (S[Math.max(start, i - s1)] + S[Math.min(stop, i + s1)])) / w;
      sum -= S[Math.max(start, i - s0)];
    }
  };
}

// Like blurf, but optimized for integer radius.
function bluri(radius) {
  const w = 2 * radius + 1;
  return (T, S, start, stop, step) => { // stop must be aligned!
    if (!((stop -= step) >= start)) return; // inclusive stop
    let sum = radius * S[start];
    const s = step * radius;
    for (let i = start, j = start + s; i < j; i += step) {
      sum += S[Math.min(stop, i)];
    }
    for (let i = start, j = stop; i <= j; i += step) {
      sum += S[Math.min(stop, i + s)];
      T[i] = sum / w;
      sum -= S[Math.max(start, i - s)];
    }
  };
}

function count$1(values, valueof) {
  let count = 0;
  if (valueof === undefined) {
    for (let value of values) {
      if (value != null && (value = +value) >= value) {
        ++count;
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null && (value = +value) >= value) {
        ++count;
      }
    }
  }
  return count;
}

function length$3(array) {
  return array.length | 0;
}

function empty$2(length) {
  return !(length > 0);
}

function arrayify(values) {
  return typeof values !== "object" || "length" in values ? values : Array.from(values);
}

function reducer(reduce) {
  return values => reduce(...values);
}

function cross$2(...values) {
  const reduce = typeof values[values.length - 1] === "function" && reducer(values.pop());
  values = values.map(arrayify);
  const lengths = values.map(length$3);
  const j = values.length - 1;
  const index = new Array(j + 1).fill(0);
  const product = [];
  if (j < 0 || lengths.some(empty$2)) return product;
  while (true) {
    product.push(index.map((j, i) => values[i][j]));
    let i = j;
    while (++index[i] === lengths[i]) {
      if (i === 0) return reduce ? product.map(reduce) : product;
      index[i--] = 0;
    }
  }
}

function cumsum(values, valueof) {
  var sum = 0, index = 0;
  return Float64Array.from(values, valueof === undefined
    ? v => (sum += +v || 0)
    : v => (sum += +valueof(v, index++, values) || 0));
}

function variance(values, valueof) {
  let count = 0;
  let delta;
  let mean = 0;
  let sum = 0;
  if (valueof === undefined) {
    for (let value of values) {
      if (value != null && (value = +value) >= value) {
        delta = value - mean;
        mean += delta / ++count;
        sum += delta * (value - mean);
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null && (value = +value) >= value) {
        delta = value - mean;
        mean += delta / ++count;
        sum += delta * (value - mean);
      }
    }
  }
  if (count > 1) return sum / (count - 1);
}

function deviation(values, valueof) {
  const v = variance(values, valueof);
  return v ? Math.sqrt(v) : v;
}

function extent$1(values, valueof) {
  let min;
  let max;
  if (valueof === undefined) {
    for (const value of values) {
      if (value != null) {
        if (min === undefined) {
          if (value >= value) min = max = value;
        } else {
          if (min > value) min = value;
          if (max < value) max = value;
        }
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null) {
        if (min === undefined) {
          if (value >= value) min = max = value;
        } else {
          if (min > value) min = value;
          if (max < value) max = value;
        }
      }
    }
  }
  return [min, max];
}

// https://github.com/python/cpython/blob/a74eea238f5baba15797e2e8b570d153bc8690a7/Modules/mathmodule.c#L1423
class Adder {
  constructor() {
    this._partials = new Float64Array(32);
    this._n = 0;
  }
  add(x) {
    const p = this._partials;
    let i = 0;
    for (let j = 0; j < this._n && j < 32; j++) {
      const y = p[j],
        hi = x + y,
        lo = Math.abs(x) < Math.abs(y) ? x - (hi - y) : y - (hi - x);
      if (lo) p[i++] = lo;
      x = hi;
    }
    p[i] = x;
    this._n = i + 1;
    return this;
  }
  valueOf() {
    const p = this._partials;
    let n = this._n, x, y, lo, hi = 0;
    if (n > 0) {
      hi = p[--n];
      while (n > 0) {
        x = hi;
        y = p[--n];
        hi = x + y;
        lo = y - (hi - x);
        if (lo) break;
      }
      if (n > 0 && ((lo < 0 && p[n - 1] < 0) || (lo > 0 && p[n - 1] > 0))) {
        y = lo * 2;
        x = hi + y;
        if (y == x - hi) hi = x;
      }
    }
    return hi;
  }
}

function fsum(values, valueof) {
  const adder = new Adder();
  if (valueof === undefined) {
    for (let value of values) {
      if (value = +value) {
        adder.add(value);
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if (value = +valueof(value, ++index, values)) {
        adder.add(value);
      }
    }
  }
  return +adder;
}

function fcumsum(values, valueof) {
  const adder = new Adder();
  let index = -1;
  return Float64Array.from(values, valueof === undefined
      ? v => adder.add(+v || 0)
      : v => adder.add(+valueof(v, ++index, values) || 0)
  );
}

class InternMap extends Map {
  constructor(entries, key = keyof) {
    super();
    Object.defineProperties(this, {_intern: {value: new Map()}, _key: {value: key}});
    if (entries != null) for (const [key, value] of entries) this.set(key, value);
  }
  get(key) {
    return super.get(intern_get(this, key));
  }
  has(key) {
    return super.has(intern_get(this, key));
  }
  set(key, value) {
    return super.set(intern_set(this, key), value);
  }
  delete(key) {
    return super.delete(intern_delete(this, key));
  }
}

class InternSet extends Set {
  constructor(values, key = keyof) {
    super();
    Object.defineProperties(this, {_intern: {value: new Map()}, _key: {value: key}});
    if (values != null) for (const value of values) this.add(value);
  }
  has(value) {
    return super.has(intern_get(this, value));
  }
  add(value) {
    return super.add(intern_set(this, value));
  }
  delete(value) {
    return super.delete(intern_delete(this, value));
  }
}

function intern_get({_intern, _key}, value) {
  const key = _key(value);
  return _intern.has(key) ? _intern.get(key) : value;
}

function intern_set({_intern, _key}, value) {
  const key = _key(value);
  if (_intern.has(key)) return _intern.get(key);
  _intern.set(key, value);
  return value;
}

function intern_delete({_intern, _key}, value) {
  const key = _key(value);
  if (_intern.has(key)) {
    value = _intern.get(key);
    _intern.delete(key);
  }
  return value;
}

function keyof(value) {
  return value !== null && typeof value === "object" ? value.valueOf() : value;
}

function identity$9(x) {
  return x;
}

function group(values, ...keys) {
  return nest(values, identity$9, identity$9, keys);
}

function groups(values, ...keys) {
  return nest(values, Array.from, identity$9, keys);
}

function flatten$1(groups, keys) {
  for (let i = 1, n = keys.length; i < n; ++i) {
    groups = groups.flatMap(g => g.pop().map(([key, value]) => [...g, key, value]));
  }
  return groups;
}

function flatGroup(values, ...keys) {
  return flatten$1(groups(values, ...keys), keys);
}

function flatRollup(values, reduce, ...keys) {
  return flatten$1(rollups(values, reduce, ...keys), keys);
}

function rollup(values, reduce, ...keys) {
  return nest(values, identity$9, reduce, keys);
}

function rollups(values, reduce, ...keys) {
  return nest(values, Array.from, reduce, keys);
}

function index$6(values, ...keys) {
  return nest(values, identity$9, unique, keys);
}

function indexes(values, ...keys) {
  return nest(values, Array.from, unique, keys);
}

function unique(values) {
  if (values.length !== 1) throw new Error("duplicate key");
  return values[0];
}

function nest(values, map, reduce, keys) {
  return (function regroup(values, i) {
    if (i >= keys.length) return reduce(values);
    const groups = new InternMap();
    const keyof = keys[i++];
    let index = -1;
    for (const value of values) {
      const key = keyof(value, ++index, values);
      const group = groups.get(key);
      if (group) group.push(value);
      else groups.set(key, [value]);
    }
    for (const [key, values] of groups) {
      groups.set(key, regroup(values, i));
    }
    return map(groups);
  })(values, 0);
}

function permute(source, keys) {
  return Array.from(keys, key => source[key]);
}

function sort(values, ...F) {
  if (typeof values[Symbol.iterator] !== "function") throw new TypeError("values is not iterable");
  values = Array.from(values);
  let [f] = F;
  if ((f && f.length !== 2) || F.length > 1) {
    const index = Uint32Array.from(values, (d, i) => i);
    if (F.length > 1) {
      F = F.map(f => values.map(f));
      index.sort((i, j) => {
        for (const f of F) {
          const c = ascendingDefined(f[i], f[j]);
          if (c) return c;
        }
      });
    } else {
      f = values.map(f);
      index.sort((i, j) => ascendingDefined(f[i], f[j]));
    }
    return permute(values, index);
  }
  return values.sort(compareDefined(f));
}

function compareDefined(compare = ascending$3) {
  if (compare === ascending$3) return ascendingDefined;
  if (typeof compare !== "function") throw new TypeError("compare is not a function");
  return (a, b) => {
    const x = compare(a, b);
    if (x || x === 0) return x;
    return (compare(b, b) === 0) - (compare(a, a) === 0);
  };
}

function ascendingDefined(a, b) {
  return (a == null || !(a >= a)) - (b == null || !(b >= b)) || (a < b ? -1 : a > b ? 1 : 0);
}

function groupSort(values, reduce, key) {
  return (reduce.length !== 2
    ? sort(rollup(values, reduce, key), (([ak, av], [bk, bv]) => ascending$3(av, bv) || ascending$3(ak, bk)))
    : sort(group(values, key), (([ak, av], [bk, bv]) => reduce(av, bv) || ascending$3(ak, bk))))
    .map(([key]) => key);
}

var array$5 = Array.prototype;

var slice$3 = array$5.slice;

function constant$b(x) {
  return () => x;
}

const e10 = Math.sqrt(50),
    e5 = Math.sqrt(10),
    e2 = Math.sqrt(2);

function tickSpec(start, stop, count) {
  const step = (stop - start) / Math.max(0, count),
      power = Math.floor(Math.log10(step)),
      error = step / Math.pow(10, power),
      factor = error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1;
  let i1, i2, inc;
  if (power < 0) {
    inc = Math.pow(10, -power) / factor;
    i1 = Math.round(start * inc);
    i2 = Math.round(stop * inc);
    if (i1 / inc < start) ++i1;
    if (i2 / inc > stop) --i2;
    inc = -inc;
  } else {
    inc = Math.pow(10, power) * factor;
    i1 = Math.round(start / inc);
    i2 = Math.round(stop / inc);
    if (i1 * inc < start) ++i1;
    if (i2 * inc > stop) --i2;
  }
  if (i2 < i1 && 0.5 <= count && count < 2) return tickSpec(start, stop, count * 2);
  return [i1, i2, inc];
}

function ticks(start, stop, count) {
  stop = +stop, start = +start, count = +count;
  if (!(count > 0)) return [];
  if (start === stop) return [start];
  const reverse = stop < start, [i1, i2, inc] = reverse ? tickSpec(stop, start, count) : tickSpec(start, stop, count);
  if (!(i2 >= i1)) return [];
  const n = i2 - i1 + 1, ticks = new Array(n);
  if (reverse) {
    if (inc < 0) for (let i = 0; i < n; ++i) ticks[i] = (i2 - i) / -inc;
    else for (let i = 0; i < n; ++i) ticks[i] = (i2 - i) * inc;
  } else {
    if (inc < 0) for (let i = 0; i < n; ++i) ticks[i] = (i1 + i) / -inc;
    else for (let i = 0; i < n; ++i) ticks[i] = (i1 + i) * inc;
  }
  return ticks;
}

function tickIncrement(start, stop, count) {
  stop = +stop, start = +start, count = +count;
  return tickSpec(start, stop, count)[2];
}

function tickStep(start, stop, count) {
  stop = +stop, start = +start, count = +count;
  const reverse = stop < start, inc = reverse ? tickIncrement(stop, start, count) : tickIncrement(start, stop, count);
  return (reverse ? -1 : 1) * (inc < 0 ? 1 / -inc : inc);
}

function nice$1(start, stop, count) {
  let prestep;
  while (true) {
    const step = tickIncrement(start, stop, count);
    if (step === prestep || step === 0 || !isFinite(step)) {
      return [start, stop];
    } else if (step > 0) {
      start = Math.floor(start / step) * step;
      stop = Math.ceil(stop / step) * step;
    } else if (step < 0) {
      start = Math.ceil(start * step) / step;
      stop = Math.floor(stop * step) / step;
    }
    prestep = step;
  }
}

function thresholdSturges(values) {
  return Math.max(1, Math.ceil(Math.log(count$1(values)) / Math.LN2) + 1);
}

function bin() {
  var value = identity$9,
      domain = extent$1,
      threshold = thresholdSturges;

  function histogram(data) {
    if (!Array.isArray(data)) data = Array.from(data);

    var i,
        n = data.length,
        x,
        step,
        values = new Array(n);

    for (i = 0; i < n; ++i) {
      values[i] = value(data[i], i, data);
    }

    var xz = domain(values),
        x0 = xz[0],
        x1 = xz[1],
        tz = threshold(values, x0, x1);

    // Convert number of thresholds into uniform thresholds, and nice the
    // default domain accordingly.
    if (!Array.isArray(tz)) {
      const max = x1, tn = +tz;
      if (domain === extent$1) [x0, x1] = nice$1(x0, x1, tn);
      tz = ticks(x0, x1, tn);

      // If the domain is aligned with the first tick (which it will by
      // default), then we can use quantization rather than bisection to bin
      // values, which is substantially faster.
      if (tz[0] <= x0) step = tickIncrement(x0, x1, tn);

      // If the last threshold is coincident with the domain’s upper bound, the
      // last bin will be zero-width. If the default domain is used, and this
      // last threshold is coincident with the maximum input value, we can
      // extend the niced upper bound by one tick to ensure uniform bin widths;
      // otherwise, we simply remove the last threshold. Note that we don’t
      // coerce values or the domain to numbers, and thus must be careful to
      // compare order (>=) rather than strict equality (===)!
      if (tz[tz.length - 1] >= x1) {
        if (max >= x1 && domain === extent$1) {
          const step = tickIncrement(x0, x1, tn);
          if (isFinite(step)) {
            if (step > 0) {
              x1 = (Math.floor(x1 / step) + 1) * step;
            } else if (step < 0) {
              x1 = (Math.ceil(x1 * -step) + 1) / -step;
            }
          }
        } else {
          tz.pop();
        }
      }
    }

    // Remove any thresholds outside the domain.
    // Be careful not to mutate an array owned by the user!
    var m = tz.length, a = 0, b = m;
    while (tz[a] <= x0) ++a;
    while (tz[b - 1] > x1) --b;
    if (a || b < m) tz = tz.slice(a, b), m = b - a;

    var bins = new Array(m + 1),
        bin;

    // Initialize bins.
    for (i = 0; i <= m; ++i) {
      bin = bins[i] = [];
      bin.x0 = i > 0 ? tz[i - 1] : x0;
      bin.x1 = i < m ? tz[i] : x1;
    }

    // Assign data to bins by value, ignoring any outside the domain.
    if (isFinite(step)) {
      if (step > 0) {
        for (i = 0; i < n; ++i) {
          if ((x = values[i]) != null && x0 <= x && x <= x1) {
            bins[Math.min(m, Math.floor((x - x0) / step))].push(data[i]);
          }
        }
      } else if (step < 0) {
        for (i = 0; i < n; ++i) {
          if ((x = values[i]) != null && x0 <= x && x <= x1) {
            const j = Math.floor((x0 - x) * step);
            bins[Math.min(m, j + (tz[j] <= x))].push(data[i]); // handle off-by-one due to rounding
          }
        }
      }
    } else {
      for (i = 0; i < n; ++i) {
        if ((x = values[i]) != null && x0 <= x && x <= x1) {
          bins[bisect(tz, x, 0, m)].push(data[i]);
        }
      }
    }

    return bins;
  }

  histogram.value = function(_) {
    return arguments.length ? (value = typeof _ === "function" ? _ : constant$b(_), histogram) : value;
  };

  histogram.domain = function(_) {
    return arguments.length ? (domain = typeof _ === "function" ? _ : constant$b([_[0], _[1]]), histogram) : domain;
  };

  histogram.thresholds = function(_) {
    return arguments.length ? (threshold = typeof _ === "function" ? _ : constant$b(Array.isArray(_) ? slice$3.call(_) : _), histogram) : threshold;
  };

  return histogram;
}

function max$3(values, valueof) {
  let max;
  if (valueof === undefined) {
    for (const value of values) {
      if (value != null
          && (max < value || (max === undefined && value >= value))) {
        max = value;
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null
          && (max < value || (max === undefined && value >= value))) {
        max = value;
      }
    }
  }
  return max;
}

function maxIndex(values, valueof) {
  let max;
  let maxIndex = -1;
  let index = -1;
  if (valueof === undefined) {
    for (const value of values) {
      ++index;
      if (value != null
          && (max < value || (max === undefined && value >= value))) {
        max = value, maxIndex = index;
      }
    }
  } else {
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null
          && (max < value || (max === undefined && value >= value))) {
        max = value, maxIndex = index;
      }
    }
  }
  return maxIndex;
}

function min$2(values, valueof) {
  let min;
  if (valueof === undefined) {
    for (const value of values) {
      if (value != null
          && (min > value || (min === undefined && value >= value))) {
        min = value;
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null
          && (min > value || (min === undefined && value >= value))) {
        min = value;
      }
    }
  }
  return min;
}

function minIndex(values, valueof) {
  let min;
  let minIndex = -1;
  let index = -1;
  if (valueof === undefined) {
    for (const value of values) {
      ++index;
      if (value != null
          && (min > value || (min === undefined && value >= value))) {
        min = value, minIndex = index;
      }
    }
  } else {
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null
          && (min > value || (min === undefined && value >= value))) {
        min = value, minIndex = index;
      }
    }
  }
  return minIndex;
}

// Based on https://github.com/mourner/quickselect
// ISC license, Copyright 2018 Vladimir Agafonkin.
function quickselect(array, k, left = 0, right = Infinity, compare) {
  k = Math.floor(k);
  left = Math.floor(Math.max(0, left));
  right = Math.floor(Math.min(array.length - 1, right));

  if (!(left <= k && k <= right)) return array;

  compare = compare === undefined ? ascendingDefined : compareDefined(compare);

  while (right > left) {
    if (right - left > 600) {
      const n = right - left + 1;
      const m = k - left + 1;
      const z = Math.log(n);
      const s = 0.5 * Math.exp(2 * z / 3);
      const sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);
      const newLeft = Math.max(left, Math.floor(k - m * s / n + sd));
      const newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));
      quickselect(array, k, newLeft, newRight, compare);
    }

    const t = array[k];
    let i = left;
    let j = right;

    swap$1(array, left, k);
    if (compare(array[right], t) > 0) swap$1(array, left, right);

    while (i < j) {
      swap$1(array, i, j), ++i, --j;
      while (compare(array[i], t) < 0) ++i;
      while (compare(array[j], t) > 0) --j;
    }

    if (compare(array[left], t) === 0) swap$1(array, left, j);
    else ++j, swap$1(array, j, right);

    if (j <= k) left = j + 1;
    if (k <= j) right = j - 1;
  }

  return array;
}

function swap$1(array, i, j) {
  const t = array[i];
  array[i] = array[j];
  array[j] = t;
}

function greatest(values, compare = ascending$3) {
  let max;
  let defined = false;
  if (compare.length === 1) {
    let maxValue;
    for (const element of values) {
      const value = compare(element);
      if (defined
          ? ascending$3(value, maxValue) > 0
          : ascending$3(value, value) === 0) {
        max = element;
        maxValue = value;
        defined = true;
      }
    }
  } else {
    for (const value of values) {
      if (defined
          ? compare(value, max) > 0
          : compare(value, value) === 0) {
        max = value;
        defined = true;
      }
    }
  }
  return max;
}

function quantile$1(values, p, valueof) {
  values = Float64Array.from(numbers(values, valueof));
  if (!(n = values.length) || isNaN(p = +p)) return;
  if (p <= 0 || n < 2) return min$2(values);
  if (p >= 1) return max$3(values);
  var n,
      i = (n - 1) * p,
      i0 = Math.floor(i),
      value0 = max$3(quickselect(values, i0).subarray(0, i0 + 1)),
      value1 = min$2(values.subarray(i0 + 1));
  return value0 + (value1 - value0) * (i - i0);
}

function quantileSorted(values, p, valueof = number$3) {
  if (!(n = values.length) || isNaN(p = +p)) return;
  if (p <= 0 || n < 2) return +valueof(values[0], 0, values);
  if (p >= 1) return +valueof(values[n - 1], n - 1, values);
  var n,
      i = (n - 1) * p,
      i0 = Math.floor(i),
      value0 = +valueof(values[i0], i0, values),
      value1 = +valueof(values[i0 + 1], i0 + 1, values);
  return value0 + (value1 - value0) * (i - i0);
}

function quantileIndex(values, p, valueof = number$3) {
  if (isNaN(p = +p)) return;
  numbers = Float64Array.from(values, (_, i) => number$3(valueof(values[i], i, values)));
  if (p <= 0) return minIndex(numbers);
  if (p >= 1) return maxIndex(numbers);
  var numbers,
      index = Uint32Array.from(values, (_, i) => i),
      j = numbers.length - 1,
      i = Math.floor(j * p);
  quickselect(index, i, 0, j, (i, j) => ascendingDefined(numbers[i], numbers[j]));
  i = greatest(index.subarray(0, i + 1), (i) => numbers[i]);
  return i >= 0 ? i : -1;
}

function thresholdFreedmanDiaconis(values, min, max) {
  const c = count$1(values), d = quantile$1(values, 0.75) - quantile$1(values, 0.25);
  return c && d ? Math.ceil((max - min) / (2 * d * Math.pow(c, -1 / 3))) : 1;
}

function thresholdScott(values, min, max) {
  const c = count$1(values), d = deviation(values);
  return c && d ? Math.ceil((max - min) * Math.cbrt(c) / (3.49 * d)) : 1;
}

function mean(values, valueof) {
  let count = 0;
  let sum = 0;
  if (valueof === undefined) {
    for (let value of values) {
      if (value != null && (value = +value) >= value) {
        ++count, sum += value;
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null && (value = +value) >= value) {
        ++count, sum += value;
      }
    }
  }
  if (count) return sum / count;
}

function median(values, valueof) {
  return quantile$1(values, 0.5, valueof);
}

function medianIndex(values, valueof) {
  return quantileIndex(values, 0.5, valueof);
}

function* flatten(arrays) {
  for (const array of arrays) {
    yield* array;
  }
}

function merge(arrays) {
  return Array.from(flatten(arrays));
}

function mode(values, valueof) {
  const counts = new InternMap();
  if (valueof === undefined) {
    for (let value of values) {
      if (value != null && value >= value) {
        counts.set(value, (counts.get(value) || 0) + 1);
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if ((value = valueof(value, ++index, values)) != null && value >= value) {
        counts.set(value, (counts.get(value) || 0) + 1);
      }
    }
  }
  let modeValue;
  let modeCount = 0;
  for (const [value, count] of counts) {
    if (count > modeCount) {
      modeCount = count;
      modeValue = value;
    }
  }
  return modeValue;
}

function pairs(values, pairof = pair) {
  const pairs = [];
  let previous;
  let first = false;
  for (const value of values) {
    if (first) pairs.push(pairof(previous, value));
    previous = value;
    first = true;
  }
  return pairs;
}

function pair(a, b) {
  return [a, b];
}

function range$2(start, stop, step) {
  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;

  var i = -1,
      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,
      range = new Array(n);

  while (++i < n) {
    range[i] = start + i * step;
  }

  return range;
}

function rank(values, valueof = ascending$3) {
  if (typeof values[Symbol.iterator] !== "function") throw new TypeError("values is not iterable");
  let V = Array.from(values);
  const R = new Float64Array(V.length);
  if (valueof.length !== 2) V = V.map(valueof), valueof = ascending$3;
  const compareIndex = (i, j) => valueof(V[i], V[j]);
  let k, r;
  values = Uint32Array.from(V, (_, i) => i);
  // Risky chaining due to Safari 14 https://github.com/d3/d3-array/issues/123
  values.sort(valueof === ascending$3 ? (i, j) => ascendingDefined(V[i], V[j]) : compareDefined(compareIndex));
  values.forEach((j, i) => {
      const c = compareIndex(j, k === undefined ? j : k);
      if (c >= 0) {
        if (k === undefined || c > 0) k = j, r = i;
        R[j] = r;
      } else {
        R[j] = NaN;
      }
    });
  return R;
}

function least(values, compare = ascending$3) {
  let min;
  let defined = false;
  if (compare.length === 1) {
    let minValue;
    for (const element of values) {
      const value = compare(element);
      if (defined
          ? ascending$3(value, minValue) < 0
          : ascending$3(value, value) === 0) {
        min = element;
        minValue = value;
        defined = true;
      }
    }
  } else {
    for (const value of values) {
      if (defined
          ? compare(value, min) < 0
          : compare(value, value) === 0) {
        min = value;
        defined = true;
      }
    }
  }
  return min;
}

function leastIndex(values, compare = ascending$3) {
  if (compare.length === 1) return minIndex(values, compare);
  let minValue;
  let min = -1;
  let index = -1;
  for (const value of values) {
    ++index;
    if (min < 0
        ? compare(value, value) === 0
        : compare(value, minValue) < 0) {
      minValue = value;
      min = index;
    }
  }
  return min;
}

function greatestIndex(values, compare = ascending$3) {
  if (compare.length === 1) return maxIndex(values, compare);
  let maxValue;
  let max = -1;
  let index = -1;
  for (const value of values) {
    ++index;
    if (max < 0
        ? compare(value, value) === 0
        : compare(value, maxValue) > 0) {
      maxValue = value;
      max = index;
    }
  }
  return max;
}

function scan(values, compare) {
  const index = leastIndex(values, compare);
  return index < 0 ? undefined : index;
}

var shuffle$1 = shuffler(Math.random);

function shuffler(random) {
  return function shuffle(array, i0 = 0, i1 = array.length) {
    let m = i1 - (i0 = +i0);
    while (m) {
      const i = random() * m-- | 0, t = array[m + i0];
      array[m + i0] = array[i + i0];
      array[i + i0] = t;
    }
    return array;
  };
}

function sum$2(values, valueof) {
  let sum = 0;
  if (valueof === undefined) {
    for (let value of values) {
      if (value = +value) {
        sum += value;
      }
    }
  } else {
    let index = -1;
    for (let value of values) {
      if (value = +valueof(value, ++index, values)) {
        sum += value;
      }
    }
  }
  return sum;
}

function transpose(matrix) {
  if (!(n = matrix.length)) return [];
  for (var i = -1, m = min$2(matrix, length$2), transpose = new Array(m); ++i < m;) {
    for (var j = -1, n, row = transpose[i] = new Array(n); ++j < n;) {
      row[j] = matrix[j][i];
    }
  }
  return transpose;
}

function length$2(d) {
  return d.length;
}

function zip() {
  return transpose(arguments);
}

function every(values, test) {
  if (typeof test !== "function") throw new TypeError("test is not a function");
  let index = -1;
  for (const value of values) {
    if (!test(value, ++index, values)) {
      return false;
    }
  }
  return true;
}

function some(values, test) {
  if (typeof test !== "function") throw new TypeError("test is not a function");
  let index = -1;
  for (const value of values) {
    if (test(value, ++index, values)) {
      return true;
    }
  }
  return false;
}

function filter$1(values, test) {
  if (typeof test !== "function") throw new TypeError("test is not a function");
  const array = [];
  let index = -1;
  for (const value of values) {
    if (test(value, ++index, values)) {
      array.push(value);
    }
  }
  return array;
}

function map$1(values, mapper) {
  if (typeof values[Symbol.iterator] !== "function") throw new TypeError("values is not iterable");
  if (typeof mapper !== "function") throw new TypeError("mapper is not a function");
  return Array.from(values, (value, index) => mapper(value, index, values));
}

function reduce(values, reducer, value) {
  if (typeof reducer !== "function") throw new TypeError("reducer is not a function");
  const iterator = values[Symbol.iterator]();
  let done, next, index = -1;
  if (arguments.length < 3) {
    ({done, value} = iterator.next());
    if (done) return;
    ++index;
  }
  while (({done, value: next} = iterator.next()), !done) {
    value = reducer(value, next, ++index, values);
  }
  return value;
}

function reverse$1(values) {
  if (typeof values[Symbol.iterator] !== "function") throw new TypeError("values is not iterable");
  return Array.from(values).reverse();
}

function difference(values, ...others) {
  values = new InternSet(values);
  for (const other of others) {
    for (const value of other) {
      values.delete(value);
    }
  }
  return values;
}

function disjoint(values, other) {
  const iterator = other[Symbol.iterator](), set = new InternSet();
  for (const v of values) {
    if (set.has(v)) return false;
    let value, done;
    while (({value, done} = iterator.next())) {
      if (done) break;
      if (Object.is(v, value)) return false;
      set.add(value);
    }
  }
  return true;
}

function intersection(values, ...others) {
  values = new InternSet(values);
  others = others.map(set$2);
  out: for (const value of values) {
    for (const other of others) {
      if (!other.has(value)) {
        values.delete(value);
        continue out;
      }
    }
  }
  return values;
}

function set$2(values) {
  return values instanceof InternSet ? values : new InternSet(values);
}

function superset(values, other) {
  const iterator = values[Symbol.iterator](), set = new Set();
  for (const o of other) {
    const io = intern(o);
    if (set.has(io)) continue;
    let value, done;
    while (({value, done} = iterator.next())) {
      if (done) return false;
      const ivalue = intern(value);
      set.add(ivalue);
      if (Object.is(io, ivalue)) break;
    }
  }
  return true;
}

function intern(value) {
  return value !== null && typeof value === "object" ? value.valueOf() : value;
}

function subset(values, other) {
  return superset(other, values);
}

function union(...others) {
  const set = new InternSet();
  for (const other of others) {
    for (const o of other) {
      set.add(o);
    }
  }
  return set;
}

function identity$8(x) {
  return x;
}

var top = 1,
    right = 2,
    bottom = 3,
    left = 4,
    epsilon$6 = 1e-6;

function translateX(x) {
  return "translate(" + x + ",0)";
}

function translateY(y) {
  return "translate(0," + y + ")";
}

function number$2(scale) {
  return d => +scale(d);
}

function center$1(scale, offset) {
  offset = Math.max(0, scale.bandwidth() - offset * 2) / 2;
  if (scale.round()) offset = Math.round(offset);
  return d => +scale(d) + offset;
}

function entering() {
  return !this.__axis;
}

function axis(orient, scale) {
  var tickArguments = [],
      tickValues = null,
      tickFormat = null,
      tickSizeInner = 6,
      tickSizeOuter = 6,
      tickPadding = 3,
      offset = typeof window !== "undefined" && window.devicePixelRatio > 1 ? 0 : 0.5,
      k = orient === top || orient === left ? -1 : 1,
      x = orient === left || orient === right ? "x" : "y",
      transform = orient === top || orient === bottom ? translateX : translateY;

  function axis(context) {
    var values = tickValues == null ? (scale.ticks ? scale.ticks.apply(scale, tickArguments) : scale.domain()) : tickValues,
        format = tickFormat == null ? (scale.tickFormat ? scale.tickFormat.apply(scale, tickArguments) : identity$8) : tickFormat,
        spacing = Math.max(tickSizeInner, 0) + tickPadding,
        range = scale.range(),
        range0 = +range[0] + offset,
        range1 = +range[range.length - 1] + offset,
        position = (scale.bandwidth ? center$1 : number$2)(scale.copy(), offset),
        selection = context.selection ? context.selection() : context,
        path = selection.selectAll(".domain").data([null]),
        tick = selection.selectAll(".tick").data(values, scale).order(),
        tickExit = tick.exit(),
        tickEnter = tick.enter().append("g").attr("class", "tick"),
        line = tick.select("line"),
        text = tick.select("text");

    path = path.merge(path.enter().insert("path", ".tick")
        .attr("class", "domain")
        .attr("stroke", "currentColor"));

    tick = tick.merge(tickEnter);

    line = line.merge(tickEnter.append("line")
        .attr("stroke", "currentColor")
        .attr(x + "2", k * tickSizeInner));

    text = text.merge(tickEnter.append("text")
        .attr("fill", "currentColor")
        .attr(x, k * spacing)
        .attr("dy", orient === top ? "0em" : orient === bottom ? "0.71em" : "0.32em"));

    if (context !== selection) {
      path = path.transition(context);
      tick = tick.transition(context);
      line = line.transition(context);
      text = text.transition(context);

      tickExit = tickExit.transition(context)
          .attr("opacity", epsilon$6)
          .attr("transform", function(d) { return isFinite(d = position(d)) ? transform(d + offset) : this.getAttribute("transform"); });

      tickEnter
          .attr("opacity", epsilon$6)
          .attr("transform", function(d) { var p = this.parentNode.__axis; return transform((p && isFinite(p = p(d)) ? p : position(d)) + offset); });
    }

    tickExit.remove();

    path
        .attr("d", orient === left || orient === right
            ? (tickSizeOuter ? "M" + k * tickSizeOuter + "," + range0 + "H" + offset + "V" + range1 + "H" + k * tickSizeOuter : "M" + offset + "," + range0 + "V" + range1)
            : (tickSizeOuter ? "M" + range0 + "," + k * tickSizeOuter + "V" + offset + "H" + range1 + "V" + k * tickSizeOuter : "M" + range0 + "," + offset + "H" + range1));

    tick
        .attr("opacity", 1)
        .attr("transform", function(d) { return transform(position(d) + offset); });

    line
        .attr(x + "2", k * tickSizeInner);

    text
        .attr(x, k * spacing)
        .text(format);

    selection.filter(entering)
        .attr("fill", "none")
        .attr("font-size", 10)
        .attr("font-family", "sans-serif")
        .attr("text-anchor", orient === right ? "start" : orient === left ? "end" : "middle");

    selection
        .each(function() { this.__axis = position; });
  }

  axis.scale = function(_) {
    return arguments.length ? (scale = _, axis) : scale;
  };

  axis.ticks = function() {
    return tickArguments = Array.from(arguments), axis;
  };

  axis.tickArguments = function(_) {
    return arguments.length ? (tickArguments = _ == null ? [] : Array.from(_), axis) : tickArguments.slice();
  };

  axis.tickValues = function(_) {
    return arguments.length ? (tickValues = _ == null ? null : Array.from(_), axis) : tickValues && tickValues.slice();
  };

  axis.tickFormat = function(_) {
    return arguments.length ? (tickFormat = _, axis) : tickFormat;
  };

  axis.tickSize = function(_) {
    return arguments.length ? (tickSizeInner = tickSizeOuter = +_, axis) : tickSizeInner;
  };

  axis.tickSizeInner = function(_) {
    return arguments.length ? (tickSizeInner = +_, axis) : tickSizeInner;
  };

  axis.tickSizeOuter = function(_) {
    return arguments.length ? (tickSizeOuter = +_, axis) : tickSizeOuter;
  };

  axis.tickPadding = function(_) {
    return arguments.length ? (tickPadding = +_, axis) : tickPadding;
  };

  axis.offset = function(_) {
    return arguments.length ? (offset = +_, axis) : offset;
  };

  return axis;
}

function axisTop(scale) {
  return axis(top, scale);
}

function axisRight(scale) {
  return axis(right, scale);
}

function axisBottom(scale) {
  return axis(bottom, scale);
}

function axisLeft(scale) {
  return axis(left, scale);
}

var noop$3 = {value: () => {}};

function dispatch() {
  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {
    if (!(t = arguments[i] + "") || (t in _) || /[\s.]/.test(t)) throw new Error("illegal type: " + t);
    _[t] = [];
  }
  return new Dispatch(_);
}

function Dispatch(_) {
  this._ = _;
}

function parseTypenames$1(typenames, types) {
  return typenames.trim().split(/^|\s+/).map(function(t) {
    var name = "", i = t.indexOf(".");
    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);
    if (t && !types.hasOwnProperty(t)) throw new Error("unknown type: " + t);
    return {type: t, name: name};
  });
}

Dispatch.prototype = dispatch.prototype = {
  constructor: Dispatch,
  on: function(typename, callback) {
    var _ = this._,
        T = parseTypenames$1(typename + "", _),
        t,
        i = -1,
        n = T.length;

    // If no callback was specified, return the callback of the given type and name.
    if (arguments.length < 2) {
      while (++i < n) if ((t = (typename = T[i]).type) && (t = get$1(_[t], typename.name))) return t;
      return;
    }

    // If a type was specified, set the callback for the given type and name.
    // Otherwise, if a null callback was specified, remove callbacks of the given name.
    if (callback != null && typeof callback !== "function") throw new Error("invalid callback: " + callback);
    while (++i < n) {
      if (t = (typename = T[i]).type) _[t] = set$1(_[t], typename.name, callback);
      else if (callback == null) for (t in _) _[t] = set$1(_[t], typename.name, null);
    }

    return this;
  },
  copy: function() {
    var copy = {}, _ = this._;
    for (var t in _) copy[t] = _[t].slice();
    return new Dispatch(copy);
  },
  call: function(type, that) {
    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];
    if (!this._.hasOwnProperty(type)) throw new Error("unknown type: " + type);
    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);
  },
  apply: function(type, that, args) {
    if (!this._.hasOwnProperty(type)) throw new Error("unknown type: " + type);
    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);
  }
};

function get$1(type, name) {
  for (var i = 0, n = type.length, c; i < n; ++i) {
    if ((c = type[i]).name === name) {
      return c.value;
    }
  }
}

function set$1(type, name, callback) {
  for (var i = 0, n = type.length; i < n; ++i) {
    if (type[i].name === name) {
      type[i] = noop$3, type = type.slice(0, i).concat(type.slice(i + 1));
      break;
    }
  }
  if (callback != null) type.push({name: name, value: callback});
  return type;
}

var xhtml = "http://www.w3.org/1999/xhtml";

var namespaces = {
  svg: "http://www.w3.org/2000/svg",
  xhtml: xhtml,
  xlink: "http://www.w3.org/1999/xlink",
  xml: "http://www.w3.org/XML/1998/namespace",
  xmlns: "http://www.w3.org/2000/xmlns/"
};

function namespace(name) {
  var prefix = name += "", i = prefix.indexOf(":");
  if (i >= 0 && (prefix = name.slice(0, i)) !== "xmlns") name = name.slice(i + 1);
  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name; // eslint-disable-line no-prototype-builtins
}

function creatorInherit(name) {
  return function() {
    var document = this.ownerDocument,
        uri = this.namespaceURI;
    return uri === xhtml && document.documentElement.namespaceURI === xhtml
        ? document.createElement(name)
        : document.createElementNS(uri, name);
  };
}

function creatorFixed(fullname) {
  return function() {
    return this.ownerDocument.createElementNS(fullname.space, fullname.local);
  };
}

function creator(name) {
  var fullname = namespace(name);
  return (fullname.local
      ? creatorFixed
      : creatorInherit)(fullname);
}

function none$2() {}

function selector(selector) {
  return selector == null ? none$2 : function() {
    return this.querySelector(selector);
  };
}

function selection_select(select) {
  if (typeof select !== "function") select = selector(select);

  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {
      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {
        if ("__data__" in node) subnode.__data__ = node.__data__;
        subgroup[i] = subnode;
      }
    }
  }

  return new Selection$1(subgroups, this._parents);
}

// Given something array like (or null), returns something that is strictly an
// array. This is used to ensure that array-like objects passed to d3.selectAll
// or selection.selectAll are converted into proper arrays when creating a
// selection; we don’t ever want to create a selection backed by a live
// HTMLCollection or NodeList. However, note that selection.selectAll will use a
// static NodeList as a group, since it safely derived from querySelectorAll.
function array$4(x) {
  return x == null ? [] : Array.isArray(x) ? x : Array.from(x);
}

function empty$1() {
  return [];
}

function selectorAll(selector) {
  return selector == null ? empty$1 : function() {
    return this.querySelectorAll(selector);
  };
}

function arrayAll(select) {
  return function() {
    return array$4(select.apply(this, arguments));
  };
}

function selection_selectAll(select) {
  if (typeof select === "function") select = arrayAll(select);
  else select = selectorAll(select);

  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        subgroups.push(select.call(node, node.__data__, i, group));
        parents.push(node);
      }
    }
  }

  return new Selection$1(subgroups, parents);
}

function matcher(selector) {
  return function() {
    return this.matches(selector);
  };
}

function childMatcher(selector) {
  return function(node) {
    return node.matches(selector);
  };
}

var find$1 = Array.prototype.find;

function childFind(match) {
  return function() {
    return find$1.call(this.children, match);
  };
}

function childFirst() {
  return this.firstElementChild;
}

function selection_selectChild(match) {
  return this.select(match == null ? childFirst
      : childFind(typeof match === "function" ? match : childMatcher(match)));
}

var filter = Array.prototype.filter;

function children() {
  return Array.from(this.children);
}

function childrenFilter(match) {
  return function() {
    return filter.call(this.children, match);
  };
}

function selection_selectChildren(match) {
  return this.selectAll(match == null ? children
      : childrenFilter(typeof match === "function" ? match : childMatcher(match)));
}

function selection_filter(match) {
  if (typeof match !== "function") match = matcher(match);

  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {
      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {
        subgroup.push(node);
      }
    }
  }

  return new Selection$1(subgroups, this._parents);
}

function sparse(update) {
  return new Array(update.length);
}

function selection_enter() {
  return new Selection$1(this._enter || this._groups.map(sparse), this._parents);
}

function EnterNode(parent, datum) {
  this.ownerDocument = parent.ownerDocument;
  this.namespaceURI = parent.namespaceURI;
  this._next = null;
  this._parent = parent;
  this.__data__ = datum;
}

EnterNode.prototype = {
  constructor: EnterNode,
  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },
  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },
  querySelector: function(selector) { return this._parent.querySelector(selector); },
  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }
};

function constant$a(x) {
  return function() {
    return x;
  };
}

function bindIndex(parent, group, enter, update, exit, data) {
  var i = 0,
      node,
      groupLength = group.length,
      dataLength = data.length;

  // Put any non-null nodes that fit into update.
  // Put any null nodes into enter.
  // Put any remaining data into enter.
  for (; i < dataLength; ++i) {
    if (node = group[i]) {
      node.__data__ = data[i];
      update[i] = node;
    } else {
      enter[i] = new EnterNode(parent, data[i]);
    }
  }

  // Put any non-null nodes that don’t fit into exit.
  for (; i < groupLength; ++i) {
    if (node = group[i]) {
      exit[i] = node;
    }
  }
}

function bindKey(parent, group, enter, update, exit, data, key) {
  var i,
      node,
      nodeByKeyValue = new Map,
      groupLength = group.length,
      dataLength = data.length,
      keyValues = new Array(groupLength),
      keyValue;

  // Compute the key for each node.
  // If multiple nodes have the same key, the duplicates are added to exit.
  for (i = 0; i < groupLength; ++i) {
    if (node = group[i]) {
      keyValues[i] = keyValue = key.call(node, node.__data__, i, group) + "";
      if (nodeByKeyValue.has(keyValue)) {
        exit[i] = node;
      } else {
        nodeByKeyValue.set(keyValue, node);
      }
    }
  }

  // Compute the key for each datum.
  // If there a node associated with this key, join and add it to update.
  // If there is not (or the key is a duplicate), add it to enter.
  for (i = 0; i < dataLength; ++i) {
    keyValue = key.call(parent, data[i], i, data) + "";
    if (node = nodeByKeyValue.get(keyValue)) {
      update[i] = node;
      node.__data__ = data[i];
      nodeByKeyValue.delete(keyValue);
    } else {
      enter[i] = new EnterNode(parent, data[i]);
    }
  }

  // Add any remaining nodes that were not bound to data to exit.
  for (i = 0; i < groupLength; ++i) {
    if ((node = group[i]) && (nodeByKeyValue.get(keyValues[i]) === node)) {
      exit[i] = node;
    }
  }
}

function datum(node) {
  return node.__data__;
}

function selection_data(value, key) {
  if (!arguments.length) return Array.from(this, datum);

  var bind = key ? bindKey : bindIndex,
      parents = this._parents,
      groups = this._groups;

  if (typeof value !== "function") value = constant$a(value);

  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {
    var parent = parents[j],
        group = groups[j],
        groupLength = group.length,
        data = arraylike(value.call(parent, parent && parent.__data__, j, parents)),
        dataLength = data.length,
        enterGroup = enter[j] = new Array(dataLength),
        updateGroup = update[j] = new Array(dataLength),
        exitGroup = exit[j] = new Array(groupLength);

    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);

    // Now connect the enter nodes to their following update node, such that
    // appendChild can insert the materialized enter node before this node,
    // rather than at the end of the parent node.
    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {
      if (previous = enterGroup[i0]) {
        if (i0 >= i1) i1 = i0 + 1;
        while (!(next = updateGroup[i1]) && ++i1 < dataLength);
        previous._next = next || null;
      }
    }
  }

  update = new Selection$1(update, parents);
  update._enter = enter;
  update._exit = exit;
  return update;
}

// Given some data, this returns an array-like view of it: an object that
// exposes a length property and allows numeric indexing. Note that unlike
// selectAll, this isn’t worried about “live” collections because the resulting
// array will only be used briefly while data is being bound. (It is possible to
// cause the data to change while iterating by using a key function, but please
// don’t; we’d rather avoid a gratuitous copy.)
function arraylike(data) {
  return typeof data === "object" && "length" in data
    ? data // Array, TypedArray, NodeList, array-like
    : Array.from(data); // Map, Set, iterable, string, or anything else
}

function selection_exit() {
  return new Selection$1(this._exit || this._groups.map(sparse), this._parents);
}

function selection_join(onenter, onupdate, onexit) {
  var enter = this.enter(), update = this, exit = this.exit();
  if (typeof onenter === "function") {
    enter = onenter(enter);
    if (enter) enter = enter.selection();
  } else {
    enter = enter.append(onenter + "");
  }
  if (onupdate != null) {
    update = onupdate(update);
    if (update) update = update.selection();
  }
  if (onexit == null) exit.remove(); else onexit(exit);
  return enter && update ? enter.merge(update).order() : update;
}

function selection_merge(context) {
  var selection = context.selection ? context.selection() : context;

  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {
    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {
      if (node = group0[i] || group1[i]) {
        merge[i] = node;
      }
    }
  }

  for (; j < m0; ++j) {
    merges[j] = groups0[j];
  }

  return new Selection$1(merges, this._parents);
}

function selection_order() {

  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {
    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {
      if (node = group[i]) {
        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);
        next = node;
      }
    }
  }

  return this;
}

function selection_sort(compare) {
  if (!compare) compare = ascending$2;

  function compareNode(a, b) {
    return a && b ? compare(a.__data__, b.__data__) : !a - !b;
  }

  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        sortgroup[i] = node;
      }
    }
    sortgroup.sort(compareNode);
  }

  return new Selection$1(sortgroups, this._parents).order();
}

function ascending$2(a, b) {
  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;
}

function selection_call() {
  var callback = arguments[0];
  arguments[0] = this;
  callback.apply(null, arguments);
  return this;
}

function selection_nodes() {
  return Array.from(this);
}

function selection_node() {

  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {
      var node = group[i];
      if (node) return node;
    }
  }

  return null;
}

function selection_size() {
  let size = 0;
  for (const node of this) ++size; // eslint-disable-line no-unused-vars
  return size;
}

function selection_empty() {
  return !this.node();
}

function selection_each(callback) {

  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {
      if (node = group[i]) callback.call(node, node.__data__, i, group);
    }
  }

  return this;
}

function attrRemove$1(name) {
  return function() {
    this.removeAttribute(name);
  };
}

function attrRemoveNS$1(fullname) {
  return function() {
    this.removeAttributeNS(fullname.space, fullname.local);
  };
}

function attrConstant$1(name, value) {
  return function() {
    this.setAttribute(name, value);
  };
}

function attrConstantNS$1(fullname, value) {
  return function() {
    this.setAttributeNS(fullname.space, fullname.local, value);
  };
}

function attrFunction$1(name, value) {
  return function() {
    var v = value.apply(this, arguments);
    if (v == null) this.removeAttribute(name);
    else this.setAttribute(name, v);
  };
}

function attrFunctionNS$1(fullname, value) {
  return function() {
    var v = value.apply(this, arguments);
    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);
    else this.setAttributeNS(fullname.space, fullname.local, v);
  };
}

function selection_attr(name, value) {
  var fullname = namespace(name);

  if (arguments.length < 2) {
    var node = this.node();
    return fullname.local
        ? node.getAttributeNS(fullname.space, fullname.local)
        : node.getAttribute(fullname);
  }

  return this.each((value == null
      ? (fullname.local ? attrRemoveNS$1 : attrRemove$1) : (typeof value === "function"
      ? (fullname.local ? attrFunctionNS$1 : attrFunction$1)
      : (fullname.local ? attrConstantNS$1 : attrConstant$1)))(fullname, value));
}

function defaultView(node) {
  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node
      || (node.document && node) // node is a Window
      || node.defaultView; // node is a Document
}

function styleRemove$1(name) {
  return function() {
    this.style.removeProperty(name);
  };
}

function styleConstant$1(name, value, priority) {
  return function() {
    this.style.setProperty(name, value, priority);
  };
}

function styleFunction$1(name, value, priority) {
  return function() {
    var v = value.apply(this, arguments);
    if (v == null) this.style.removeProperty(name);
    else this.style.setProperty(name, v, priority);
  };
}

function selection_style(name, value, priority) {
  return arguments.length > 1
      ? this.each((value == null
            ? styleRemove$1 : typeof value === "function"
            ? styleFunction$1
            : styleConstant$1)(name, value, priority == null ? "" : priority))
      : styleValue(this.node(), name);
}

function styleValue(node, name) {
  return node.style.getPropertyValue(name)
      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);
}

function propertyRemove(name) {
  return function() {
    delete this[name];
  };
}

function propertyConstant(name, value) {
  return function() {
    this[name] = value;
  };
}

function propertyFunction(name, value) {
  return function() {
    var v = value.apply(this, arguments);
    if (v == null) delete this[name];
    else this[name] = v;
  };
}

function selection_property(name, value) {
  return arguments.length > 1
      ? this.each((value == null
          ? propertyRemove : typeof value === "function"
          ? propertyFunction
          : propertyConstant)(name, value))
      : this.node()[name];
}

function classArray(string) {
  return string.trim().split(/^|\s+/);
}

function classList(node) {
  return node.classList || new ClassList(node);
}

function ClassList(node) {
  this._node = node;
  this._names = classArray(node.getAttribute("class") || "");
}

ClassList.prototype = {
  add: function(name) {
    var i = this._names.indexOf(name);
    if (i < 0) {
      this._names.push(name);
      this._node.setAttribute("class", this._names.join(" "));
    }
  },
  remove: function(name) {
    var i = this._names.indexOf(name);
    if (i >= 0) {
      this._names.splice(i, 1);
      this._node.setAttribute("class", this._names.join(" "));
    }
  },
  contains: function(name) {
    return this._names.indexOf(name) >= 0;
  }
};

function classedAdd(node, names) {
  var list = classList(node), i = -1, n = names.length;
  while (++i < n) list.add(names[i]);
}

function classedRemove(node, names) {
  var list = classList(node), i = -1, n = names.length;
  while (++i < n) list.remove(names[i]);
}

function classedTrue(names) {
  return function() {
    classedAdd(this, names);
  };
}

function classedFalse(names) {
  return function() {
    classedRemove(this, names);
  };
}

function classedFunction(names, value) {
  return function() {
    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);
  };
}

function selection_classed(name, value) {
  var names = classArray(name + "");

  if (arguments.length < 2) {
    var list = classList(this.node()), i = -1, n = names.length;
    while (++i < n) if (!list.contains(names[i])) return false;
    return true;
  }

  return this.each((typeof value === "function"
      ? classedFunction : value
      ? classedTrue
      : classedFalse)(names, value));
}

function textRemove() {
  this.textContent = "";
}

function textConstant$1(value) {
  return function() {
    this.textContent = value;
  };
}

function textFunction$1(value) {
  return function() {
    var v = value.apply(this, arguments);
    this.textContent = v == null ? "" : v;
  };
}

function selection_text(value) {
  return arguments.length
      ? this.each(value == null
          ? textRemove : (typeof value === "function"
          ? textFunction$1
          : textConstant$1)(value))
      : this.node().textContent;
}

function htmlRemove() {
  this.innerHTML = "";
}

function htmlConstant(value) {
  return function() {
    this.innerHTML = value;
  };
}

function htmlFunction(value) {
  return function() {
    var v = value.apply(this, arguments);
    this.innerHTML = v == null ? "" : v;
  };
}

function selection_html(value) {
  return arguments.length
      ? this.each(value == null
          ? htmlRemove : (typeof value === "function"
          ? htmlFunction
          : htmlConstant)(value))
      : this.node().innerHTML;
}

function raise() {
  if (this.nextSibling) this.parentNode.appendChild(this);
}

function selection_raise() {
  return this.each(raise);
}

function lower() {
  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);
}

function selection_lower() {
  return this.each(lower);
}

function selection_append(name) {
  var create = typeof name === "function" ? name : creator(name);
  return this.select(function() {
    return this.appendChild(create.apply(this, arguments));
  });
}

function constantNull() {
  return null;
}

function selection_insert(name, before) {
  var create = typeof name === "function" ? name : creator(name),
      select = before == null ? constantNull : typeof before === "function" ? before : selector(before);
  return this.select(function() {
    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);
  });
}

function remove() {
  var parent = this.parentNode;
  if (parent) parent.removeChild(this);
}

function selection_remove() {
  return this.each(remove);
}

function selection_cloneShallow() {
  var clone = this.cloneNode(false), parent = this.parentNode;
  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;
}

function selection_cloneDeep() {
  var clone = this.cloneNode(true), parent = this.parentNode;
  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;
}

function selection_clone(deep) {
  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);
}

function selection_datum(value) {
  return arguments.length
      ? this.property("__data__", value)
      : this.node().__data__;
}

function contextListener(listener) {
  return function(event) {
    listener.call(this, event, this.__data__);
  };
}

function parseTypenames(typenames) {
  return typenames.trim().split(/^|\s+/).map(function(t) {
    var name = "", i = t.indexOf(".");
    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);
    return {type: t, name: name};
  });
}

function onRemove(typename) {
  return function() {
    var on = this.__on;
    if (!on) return;
    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {
      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {
        this.removeEventListener(o.type, o.listener, o.options);
      } else {
        on[++i] = o;
      }
    }
    if (++i) on.length = i;
    else delete this.__on;
  };
}

function onAdd(typename, value, options) {
  return function() {
    var on = this.__on, o, listener = contextListener(value);
    if (on) for (var j = 0, m = on.length; j < m; ++j) {
      if ((o = on[j]).type === typename.type && o.name === typename.name) {
        this.removeEventListener(o.type, o.listener, o.options);
        this.addEventListener(o.type, o.listener = listener, o.options = options);
        o.value = value;
        return;
      }
    }
    this.addEventListener(typename.type, listener, options);
    o = {type: typename.type, name: typename.name, value: value, listener: listener, options: options};
    if (!on) this.__on = [o];
    else on.push(o);
  };
}

function selection_on(typename, value, options) {
  var typenames = parseTypenames(typename + ""), i, n = typenames.length, t;

  if (arguments.length < 2) {
    var on = this.node().__on;
    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {
      for (i = 0, o = on[j]; i < n; ++i) {
        if ((t = typenames[i]).type === o.type && t.name === o.name) {
          return o.value;
        }
      }
    }
    return;
  }

  on = value ? onAdd : onRemove;
  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, options));
  return this;
}

function dispatchEvent(node, type, params) {
  var window = defaultView(node),
      event = window.CustomEvent;

  if (typeof event === "function") {
    event = new event(type, params);
  } else {
    event = window.document.createEvent("Event");
    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;
    else event.initEvent(type, false, false);
  }

  node.dispatchEvent(event);
}

function dispatchConstant(type, params) {
  return function() {
    return dispatchEvent(this, type, params);
  };
}

function dispatchFunction(type, params) {
  return function() {
    return dispatchEvent(this, type, params.apply(this, arguments));
  };
}

function selection_dispatch(type, params) {
  return this.each((typeof params === "function"
      ? dispatchFunction
      : dispatchConstant)(type, params));
}

function* selection_iterator() {
  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {
    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {
      if (node = group[i]) yield node;
    }
  }
}

var root$1 = [null];

function Selection$1(groups, parents) {
  this._groups = groups;
  this._parents = parents;
}

function selection() {
  return new Selection$1([[document.documentElement]], root$1);
}

function selection_selection() {
  return this;
}

Selection$1.prototype = selection.prototype = {
  constructor: Selection$1,
  select: selection_select,
  selectAll: selection_selectAll,
  selectChild: selection_selectChild,
  selectChildren: selection_selectChildren,
  filter: selection_filter,
  data: selection_data,
  enter: selection_enter,
  exit: selection_exit,
  join: selection_join,
  merge: selection_merge,
  selection: selection_selection,
  order: selection_order,
  sort: selection_sort,
  call: selection_call,
  nodes: selection_nodes,
  node: selection_node,
  size: selection_size,
  empty: selection_empty,
  each: selection_each,
  attr: selection_attr,
  style: selection_style,
  property: selection_property,
  classed: selection_classed,
  text: selection_text,
  html: selection_html,
  raise: selection_raise,
  lower: selection_lower,
  append: selection_append,
  insert: selection_insert,
  remove: selection_remove,
  clone: selection_clone,
  datum: selection_datum,
  on: selection_on,
  dispatch: selection_dispatch,
  [Symbol.iterator]: selection_iterator
};

function select(selector) {
  return typeof selector === "string"
      ? new Selection$1([[document.querySelector(selector)]], [document.documentElement])
      : new Selection$1([[selector]], root$1);
}

function create$1(name) {
  return select(creator(name).call(document.documentElement));
}

var nextId = 0;

function local$1() {
  return new Local;
}

function Local() {
  this._ = "@" + (++nextId).toString(36);
}

Local.prototype = local$1.prototype = {
  constructor: Local,
  get: function(node) {
    var id = this._;
    while (!(id in node)) if (!(node = node.parentNode)) return;
    return node[id];
  },
  set: function(node, value) {
    return node[this._] = value;
  },
  remove: function(node) {
    return this._ in node && delete node[this._];
  },
  toString: function() {
    return this._;
  }
};

function sourceEvent(event) {
  let sourceEvent;
  while (sourceEvent = event.sourceEvent) event = sourceEvent;
  return event;
}

function pointer(event, node) {
  event = sourceEvent(event);
  if (node === undefined) node = event.currentTarget;
  if (node) {
    var svg = node.ownerSVGElement || node;
    if (svg.createSVGPoint) {
      var point = svg.createSVGPoint();
      point.x = event.clientX, point.y = event.clientY;
      point = point.matrixTransform(node.getScreenCTM().inverse());
      return [point.x, point.y];
    }
    if (node.getBoundingClientRect) {
      var rect = node.getBoundingClientRect();
      return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];
    }
  }
  return [event.pageX, event.pageY];
}

function pointers(events, node) {
  if (events.target) { // i.e., instanceof Event, not TouchList or iterable
    events = sourceEvent(events);
    if (node === undefined) node = events.currentTarget;
    events = events.touches || [events];
  }
  return Array.from(events, event => pointer(event, node));
}

function selectAll(selector) {
  return typeof selector === "string"
      ? new Selection$1([document.querySelectorAll(selector)], [document.documentElement])
      : new Selection$1([array$4(selector)], root$1);
}

// These are typically used in conjunction with noevent to ensure that we can
// preventDefault on the event.
const nonpassive = {passive: false};
const nonpassivecapture = {capture: true, passive: false};

function nopropagation$2(event) {
  event.stopImmediatePropagation();
}

function noevent$2(event) {
  event.preventDefault();
  event.stopImmediatePropagation();
}

function dragDisable(view) {
  var root = view.document.documentElement,
      selection = select(view).on("dragstart.drag", noevent$2, nonpassivecapture);
  if ("onselectstart" in root) {
    selection.on("selectstart.drag", noevent$2, nonpassivecapture);
  } else {
    root.__noselect = root.style.MozUserSelect;
    root.style.MozUserSelect = "none";
  }
}

function yesdrag(view, noclick) {
  var root = view.document.documentElement,
      selection = select(view).on("dragstart.drag", null);
  if (noclick) {
    selection.on("click.drag", noevent$2, nonpassivecapture);
    setTimeout(function() { selection.on("click.drag", null); }, 0);
  }
  if ("onselectstart" in root) {
    selection.on("selectstart.drag", null);
  } else {
    root.style.MozUserSelect = root.__noselect;
    delete root.__noselect;
  }
}

var constant$9 = x => () => x;

function DragEvent(type, {
  sourceEvent,
  subject,
  target,
  identifier,
  active,
  x, y, dx, dy,
  dispatch
}) {
  Object.defineProperties(this, {
    type: {value: type, enumerable: true, configurable: true},
    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},
    subject: {value: subject, enumerable: true, configurable: true},
    target: {value: target, enumerable: true, configurable: true},
    identifier: {value: identifier, enumerable: true, configurable: true},
    active: {value: active, enumerable: true, configurable: true},
    x: {value: x, enumerable: true, configurable: true},
    y: {value: y, enumerable: true, configurable: true},
    dx: {value: dx, enumerable: true, configurable: true},
    dy: {value: dy, enumerable: true, configurable: true},
    _: {value: dispatch}
  });
}

DragEvent.prototype.on = function() {
  var value = this._.on.apply(this._, arguments);
  return value === this._ ? this : value;
};

// Ignore right-click, since that should open the context menu.
function defaultFilter$2(event) {
  return !event.ctrlKey && !event.button;
}

function defaultContainer() {
  return this.parentNode;
}

function defaultSubject(event, d) {
  return d == null ? {x: event.x, y: event.y} : d;
}

function defaultTouchable$2() {
  return navigator.maxTouchPoints || ("ontouchstart" in this);
}

function drag() {
  var filter = defaultFilter$2,
      container = defaultContainer,
      subject = defaultSubject,
      touchable = defaultTouchable$2,
      gestures = {},
      listeners = dispatch("start", "drag", "end"),
      active = 0,
      mousedownx,
      mousedowny,
      mousemoving,
      touchending,
      clickDistance2 = 0;

  function drag(selection) {
    selection
        .on("mousedown.drag", mousedowned)
      .filter(touchable)
        .on("touchstart.drag", touchstarted)
        .on("touchmove.drag", touchmoved, nonpassive)
        .on("touchend.drag touchcancel.drag", touchended)
        .style("touch-action", "none")
        .style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }

  function mousedowned(event, d) {
    if (touchending || !filter.call(this, event, d)) return;
    var gesture = beforestart(this, container.call(this, event, d), event, d, "mouse");
    if (!gesture) return;
    select(event.view)
      .on("mousemove.drag", mousemoved, nonpassivecapture)
      .on("mouseup.drag", mouseupped, nonpassivecapture);
    dragDisable(event.view);
    nopropagation$2(event);
    mousemoving = false;
    mousedownx = event.clientX;
    mousedowny = event.clientY;
    gesture("start", event);
  }

  function mousemoved(event) {
    noevent$2(event);
    if (!mousemoving) {
      var dx = event.clientX - mousedownx, dy = event.clientY - mousedowny;
      mousemoving = dx * dx + dy * dy > clickDistance2;
    }
    gestures.mouse("drag", event);
  }

  function mouseupped(event) {
    select(event.view).on("mousemove.drag mouseup.drag", null);
    yesdrag(event.view, mousemoving);
    noevent$2(event);
    gestures.mouse("end", event);
  }

  function touchstarted(event, d) {
    if (!filter.call(this, event, d)) return;
    var touches = event.changedTouches,
        c = container.call(this, event, d),
        n = touches.length, i, gesture;

    for (i = 0; i < n; ++i) {
      if (gesture = beforestart(this, c, event, d, touches[i].identifier, touches[i])) {
        nopropagation$2(event);
        gesture("start", event, touches[i]);
      }
    }
  }

  function touchmoved(event) {
    var touches = event.changedTouches,
        n = touches.length, i, gesture;

    for (i = 0; i < n; ++i) {
      if (gesture = gestures[touches[i].identifier]) {
        noevent$2(event);
        gesture("drag", event, touches[i]);
      }
    }
  }

  function touchended(event) {
    var touches = event.changedTouches,
        n = touches.length, i, gesture;

    if (touchending) clearTimeout(touchending);
    touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!
    for (i = 0; i < n; ++i) {
      if (gesture = gestures[touches[i].identifier]) {
        nopropagation$2(event);
        gesture("end", event, touches[i]);
      }
    }
  }

  function beforestart(that, container, event, d, identifier, touch) {
    var dispatch = listeners.copy(),
        p = pointer(touch || event, container), dx, dy,
        s;

    if ((s = subject.call(that, new DragEvent("beforestart", {
        sourceEvent: event,
        target: drag,
        identifier,
        active,
        x: p[0],
        y: p[1],
        dx: 0,
        dy: 0,
        dispatch
      }), d)) == null) return;

    dx = s.x - p[0] || 0;
    dy = s.y - p[1] || 0;

    return function gesture(type, event, touch) {
      var p0 = p, n;
      switch (type) {
        case "start": gestures[identifier] = gesture, n = active++; break;
        case "end": delete gestures[identifier], --active; // falls through
        case "drag": p = pointer(touch || event, container), n = active; break;
      }
      dispatch.call(
        type,
        that,
        new DragEvent(type, {
          sourceEvent: event,
          subject: s,
          target: drag,
          identifier,
          active: n,
          x: p[0] + dx,
          y: p[1] + dy,
          dx: p[0] - p0[0],
          dy: p[1] - p0[1],
          dispatch
        }),
        d
      );
    };
  }

  drag.filter = function(_) {
    return arguments.length ? (filter = typeof _ === "function" ? _ : constant$9(!!_), drag) : filter;
  };

  drag.container = function(_) {
    return arguments.length ? (container = typeof _ === "function" ? _ : constant$9(_), drag) : container;
  };

  drag.subject = function(_) {
    return arguments.length ? (subject = typeof _ === "function" ? _ : constant$9(_), drag) : subject;
  };

  drag.touchable = function(_) {
    return arguments.length ? (touchable = typeof _ === "function" ? _ : constant$9(!!_), drag) : touchable;
  };

  drag.on = function() {
    var value = listeners.on.apply(listeners, arguments);
    return value === listeners ? drag : value;
  };

  drag.clickDistance = function(_) {
    return arguments.length ? (clickDistance2 = (_ = +_) * _, drag) : Math.sqrt(clickDistance2);
  };

  return drag;
}

function define(constructor, factory, prototype) {
  constructor.prototype = factory.prototype = prototype;
  prototype.constructor = constructor;
}

function extend$1(parent, definition) {
  var prototype = Object.create(parent.prototype);
  for (var key in definition) prototype[key] = definition[key];
  return prototype;
}

function Color() {}

var darker = 0.7;
var brighter = 1 / darker;

var reI = "\\s*([+-]?\\d+)\\s*",
    reN = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",
    reP = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",
    reHex = /^#([0-9a-f]{3,8})$/,
    reRgbInteger = new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),
    reRgbPercent = new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),
    reRgbaInteger = new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),
    reRgbaPercent = new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),
    reHslPercent = new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),
    reHslaPercent = new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`);

var named = {
  aliceblue: 0xf0f8ff,
  antiquewhite: 0xfaebd7,
  aqua: 0x00ffff,
  aquamarine: 0x7fffd4,
  azure: 0xf0ffff,
  beige: 0xf5f5dc,
  bisque: 0xffe4c4,
  black: 0x000000,
  blanchedalmond: 0xffebcd,
  blue: 0x0000ff,
  blueviolet: 0x8a2be2,
  brown: 0xa52a2a,
  burlywood: 0xdeb887,
  cadetblue: 0x5f9ea0,
  chartreuse: 0x7fff00,
  chocolate: 0xd2691e,
  coral: 0xff7f50,
  cornflowerblue: 0x6495ed,
  cornsilk: 0xfff8dc,
  crimson: 0xdc143c,
  cyan: 0x00ffff,
  darkblue: 0x00008b,
  darkcyan: 0x008b8b,
  darkgoldenrod: 0xb8860b,
  darkgray: 0xa9a9a9,
  darkgreen: 0x006400,
  darkgrey: 0xa9a9a9,
  darkkhaki: 0xbdb76b,
  darkmagenta: 0x8b008b,
  darkolivegreen: 0x556b2f,
  darkorange: 0xff8c00,
  darkorchid: 0x9932cc,
  darkred: 0x8b0000,
  darksalmon: 0xe9967a,
  darkseagreen: 0x8fbc8f,
  darkslateblue: 0x483d8b,
  darkslategray: 0x2f4f4f,
  darkslategrey: 0x2f4f4f,
  darkturquoise: 0x00ced1,
  darkviolet: 0x9400d3,
  deeppink: 0xff1493,
  deepskyblue: 0x00bfff,
  dimgray: 0x696969,
  dimgrey: 0x696969,
  dodgerblue: 0x1e90ff,
  firebrick: 0xb22222,
  floralwhite: 0xfffaf0,
  forestgreen: 0x228b22,
  fuchsia: 0xff00ff,
  gainsboro: 0xdcdcdc,
  ghostwhite: 0xf8f8ff,
  gold: 0xffd700,
  goldenrod: 0xdaa520,
  gray: 0x808080,
  green: 0x008000,
  greenyellow: 0xadff2f,
  grey: 0x808080,
  honeydew: 0xf0fff0,
  hotpink: 0xff69b4,
  indianred: 0xcd5c5c,
  indigo: 0x4b0082,
  ivory: 0xfffff0,
  khaki: 0xf0e68c,
  lavender: 0xe6e6fa,
  lavenderblush: 0xfff0f5,
  lawngreen: 0x7cfc00,
  lemonchiffon: 0xfffacd,
  lightblue: 0xadd8e6,
  lightcoral: 0xf08080,
  lightcyan: 0xe0ffff,
  lightgoldenrodyellow: 0xfafad2,
  lightgray: 0xd3d3d3,
  lightgreen: 0x90ee90,
  lightgrey: 0xd3d3d3,
  lightpink: 0xffb6c1,
  lightsalmon: 0xffa07a,
  lightseagreen: 0x20b2aa,
  lightskyblue: 0x87cefa,
  lightslategray: 0x778899,
  lightslategrey: 0x778899,
  lightsteelblue: 0xb0c4de,
  lightyellow: 0xffffe0,
  lime: 0x00ff00,
  limegreen: 0x32cd32,
  linen: 0xfaf0e6,
  magenta: 0xff00ff,
  maroon: 0x800000,
  mediumaquamarine: 0x66cdaa,
  mediumblue: 0x0000cd,
  mediumorchid: 0xba55d3,
  mediumpurple: 0x9370db,
  mediumseagreen: 0x3cb371,
  mediumslateblue: 0x7b68ee,
  mediumspringgreen: 0x00fa9a,
  mediumturquoise: 0x48d1cc,
  mediumvioletred: 0xc71585,
  midnightblue: 0x191970,
  mintcream: 0xf5fffa,
  mistyrose: 0xffe4e1,
  moccasin: 0xffe4b5,
  navajowhite: 0xffdead,
  navy: 0x000080,
  oldlace: 0xfdf5e6,
  olive: 0x808000,
  olivedrab: 0x6b8e23,
  orange: 0xffa500,
  orangered: 0xff4500,
  orchid: 0xda70d6,
  palegoldenrod: 0xeee8aa,
  palegreen: 0x98fb98,
  paleturquoise: 0xafeeee,
  palevioletred: 0xdb7093,
  papayawhip: 0xffefd5,
  peachpuff: 0xffdab9,
  peru: 0xcd853f,
  pink: 0xffc0cb,
  plum: 0xdda0dd,
  powderblue: 0xb0e0e6,
  purple: 0x800080,
  rebeccapurple: 0x663399,
  red: 0xff0000,
  rosybrown: 0xbc8f8f,
  royalblue: 0x4169e1,
  saddlebrown: 0x8b4513,
  salmon: 0xfa8072,
  sandybrown: 0xf4a460,
  seagreen: 0x2e8b57,
  seashell: 0xfff5ee,
  sienna: 0xa0522d,
  silver: 0xc0c0c0,
  skyblue: 0x87ceeb,
  slateblue: 0x6a5acd,
  slategray: 0x708090,
  slategrey: 0x708090,
  snow: 0xfffafa,
  springgreen: 0x00ff7f,
  steelblue: 0x4682b4,
  tan: 0xd2b48c,
  teal: 0x008080,
  thistle: 0xd8bfd8,
  tomato: 0xff6347,
  turquoise: 0x40e0d0,
  violet: 0xee82ee,
  wheat: 0xf5deb3,
  white: 0xffffff,
  whitesmoke: 0xf5f5f5,
  yellow: 0xffff00,
  yellowgreen: 0x9acd32
};

define(Color, color, {
  copy(channels) {
    return Object.assign(new this.constructor, this, channels);
  },
  displayable() {
    return this.rgb().displayable();
  },
  hex: color_formatHex, // Deprecated! Use color.formatHex.
  formatHex: color_formatHex,
  formatHex8: color_formatHex8,
  formatHsl: color_formatHsl,
  formatRgb: color_formatRgb,
  toString: color_formatRgb
});

function color_formatHex() {
  return this.rgb().formatHex();
}

function color_formatHex8() {
  return this.rgb().formatHex8();
}

function color_formatHsl() {
  return hslConvert(this).formatHsl();
}

function color_formatRgb() {
  return this.rgb().formatRgb();
}

function color(format) {
  var m, l;
  format = (format + "").trim().toLowerCase();
  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000
      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00
      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000
      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000
      : null) // invalid hex
      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)
      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)
      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)
      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)
      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)
      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)
      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins
      : format === "transparent" ? new Rgb(NaN, NaN, NaN, 0)
      : null;
}

function rgbn(n) {
  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);
}

function rgba(r, g, b, a) {
  if (a <= 0) r = g = b = NaN;
  return new Rgb(r, g, b, a);
}

function rgbConvert(o) {
  if (!(o instanceof Color)) o = color(o);
  if (!o) return new Rgb;
  o = o.rgb();
  return new Rgb(o.r, o.g, o.b, o.opacity);
}

function rgb(r, g, b, opacity) {
  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);
}

function Rgb(r, g, b, opacity) {
  this.r = +r;
  this.g = +g;
  this.b = +b;
  this.opacity = +opacity;
}

define(Rgb, rgb, extend$1(Color, {
  brighter(k) {
    k = k == null ? brighter : Math.pow(brighter, k);
    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);
  },
  darker(k) {
    k = k == null ? darker : Math.pow(darker, k);
    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);
  },
  rgb() {
    return this;
  },
  clamp() {
    return new Rgb(clampi(this.r), clampi(this.g), clampi(this.b), clampa(this.opacity));
  },
  displayable() {
    return (-0.5 <= this.r && this.r < 255.5)
        && (-0.5 <= this.g && this.g < 255.5)
        && (-0.5 <= this.b && this.b < 255.5)
        && (0 <= this.opacity && this.opacity <= 1);
  },
  hex: rgb_formatHex, // Deprecated! Use color.formatHex.
  formatHex: rgb_formatHex,
  formatHex8: rgb_formatHex8,
  formatRgb: rgb_formatRgb,
  toString: rgb_formatRgb
}));

function rgb_formatHex() {
  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`;
}

function rgb_formatHex8() {
  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;
}

function rgb_formatRgb() {
  const a = clampa(this.opacity);
  return `${a === 1 ? "rgb(" : "rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${a === 1 ? ")" : `, ${a})`}`;
}

function clampa(opacity) {
  return isNaN(opacity) ? 1 : Math.max(0, Math.min(1, opacity));
}

function clampi(value) {
  return Math.max(0, Math.min(255, Math.round(value) || 0));
}

function hex(value) {
  value = clampi(value);
  return (value < 16 ? "0" : "") + value.toString(16);
}

function hsla(h, s, l, a) {
  if (a <= 0) h = s = l = NaN;
  else if (l <= 0 || l >= 1) h = s = NaN;
  else if (s <= 0) h = NaN;
  return new Hsl(h, s, l, a);
}

function hslConvert(o) {
  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);
  if (!(o instanceof Color)) o = color(o);
  if (!o) return new Hsl;
  if (o instanceof Hsl) return o;
  o = o.rgb();
  var r = o.r / 255,
      g = o.g / 255,
      b = o.b / 255,
      min = Math.min(r, g, b),
      max = Math.max(r, g, b),
      h = NaN,
      s = max - min,
      l = (max + min) / 2;
  if (s) {
    if (r === max) h = (g - b) / s + (g < b) * 6;
    else if (g === max) h = (b - r) / s + 2;
    else h = (r - g) / s + 4;
    s /= l < 0.5 ? max + min : 2 - max - min;
    h *= 60;
  } else {
    s = l > 0 && l < 1 ? 0 : h;
  }
  return new Hsl(h, s, l, o.opacity);
}

function hsl$2(h, s, l, opacity) {
  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);
}

function Hsl(h, s, l, opacity) {
  this.h = +h;
  this.s = +s;
  this.l = +l;
  this.opacity = +opacity;
}

define(Hsl, hsl$2, extend$1(Color, {
  brighter(k) {
    k = k == null ? brighter : Math.pow(brighter, k);
    return new Hsl(this.h, this.s, this.l * k, this.opacity);
  },
  darker(k) {
    k = k == null ? darker : Math.pow(darker, k);
    return new Hsl(this.h, this.s, this.l * k, this.opacity);
  },
  rgb() {
    var h = this.h % 360 + (this.h < 0) * 360,
        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,
        l = this.l,
        m2 = l + (l < 0.5 ? l : 1 - l) * s,
        m1 = 2 * l - m2;
    return new Rgb(
      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),
      hsl2rgb(h, m1, m2),
      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),
      this.opacity
    );
  },
  clamp() {
    return new Hsl(clamph(this.h), clampt(this.s), clampt(this.l), clampa(this.opacity));
  },
  displayable() {
    return (0 <= this.s && this.s <= 1 || isNaN(this.s))
        && (0 <= this.l && this.l <= 1)
        && (0 <= this.opacity && this.opacity <= 1);
  },
  formatHsl() {
    const a = clampa(this.opacity);
    return `${a === 1 ? "hsl(" : "hsla("}${clamph(this.h)}, ${clampt(this.s) * 100}%, ${clampt(this.l) * 100}%${a === 1 ? ")" : `, ${a})`}`;
  }
}));

function clamph(value) {
  value = (value || 0) % 360;
  return value < 0 ? value + 360 : value;
}

function clampt(value) {
  return Math.max(0, Math.min(1, value || 0));
}

/* From FvD 13.37, CSS Color Module Level 3 */
function hsl2rgb(h, m1, m2) {
  return (h < 60 ? m1 + (m2 - m1) * h / 60
      : h < 180 ? m2
      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60
      : m1) * 255;
}

const radians$1 = Math.PI / 180;
const degrees$2 = 180 / Math.PI;

// https://observablehq.com/@mbostock/lab-and-rgb
const K = 18,
    Xn = 0.96422,
    Yn = 1,
    Zn = 0.82521,
    t0$1 = 4 / 29,
    t1$1 = 6 / 29,
    t2 = 3 * t1$1 * t1$1,
    t3 = t1$1 * t1$1 * t1$1;

function labConvert(o) {
  if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);
  if (o instanceof Hcl) return hcl2lab(o);
  if (!(o instanceof Rgb)) o = rgbConvert(o);
  var r = rgb2lrgb(o.r),
      g = rgb2lrgb(o.g),
      b = rgb2lrgb(o.b),
      y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn), x, z;
  if (r === g && g === b) x = z = y; else {
    x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);
    z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);
  }
  return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);
}

function gray(l, opacity) {
  return new Lab(l, 0, 0, opacity == null ? 1 : opacity);
}

function lab$1(l, a, b, opacity) {
  return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);
}

function Lab(l, a, b, opacity) {
  this.l = +l;
  this.a = +a;
  this.b = +b;
  this.opacity = +opacity;
}

define(Lab, lab$1, extend$1(Color, {
  brighter(k) {
    return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);
  },
  darker(k) {
    return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);
  },
  rgb() {
    var y = (this.l + 16) / 116,
        x = isNaN(this.a) ? y : y + this.a / 500,
        z = isNaN(this.b) ? y : y - this.b / 200;
    x = Xn * lab2xyz(x);
    y = Yn * lab2xyz(y);
    z = Zn * lab2xyz(z);
    return new Rgb(
      lrgb2rgb( 3.1338561 * x - 1.6168667 * y - 0.4906146 * z),
      lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),
      lrgb2rgb( 0.0719453 * x - 0.2289914 * y + 1.4052427 * z),
      this.opacity
    );
  }
}));

function xyz2lab(t) {
  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0$1;
}

function lab2xyz(t) {
  return t > t1$1 ? t * t * t : t2 * (t - t0$1);
}

function lrgb2rgb(x) {
  return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);
}

function rgb2lrgb(x) {
  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);
}

function hclConvert(o) {
  if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);
  if (!(o instanceof Lab)) o = labConvert(o);
  if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0 < o.l && o.l < 100 ? 0 : NaN, o.l, o.opacity);
  var h = Math.atan2(o.b, o.a) * degrees$2;
  return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);
}

function lch(l, c, h, opacity) {
  return arguments.length === 1 ? hclConvert(l) : new Hcl(h, c, l, opacity == null ? 1 : opacity);
}

function hcl$2(h, c, l, opacity) {
  return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);
}

function Hcl(h, c, l, opacity) {
  this.h = +h;
  this.c = +c;
  this.l = +l;
  this.opacity = +opacity;
}

function hcl2lab(o) {
  if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);
  var h = o.h * radians$1;
  return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);
}

define(Hcl, hcl$2, extend$1(Color, {
  brighter(k) {
    return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);
  },
  darker(k) {
    return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);
  },
  rgb() {
    return hcl2lab(this).rgb();
  }
}));

var A = -0.14861,
    B$1 = +1.78277,
    C = -0.29227,
    D$1 = -0.90649,
    E = +1.97294,
    ED = E * D$1,
    EB = E * B$1,
    BC_DA = B$1 * C - D$1 * A;

function cubehelixConvert(o) {
  if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);
  if (!(o instanceof Rgb)) o = rgbConvert(o);
  var r = o.r / 255,
      g = o.g / 255,
      b = o.b / 255,
      l = (BC_DA * b + ED * r - EB * g) / (BC_DA + ED - EB),
      bl = b - l,
      k = (E * (g - l) - C * bl) / D$1,
      s = Math.sqrt(k * k + bl * bl) / (E * l * (1 - l)), // NaN if l=0 or l=1
      h = s ? Math.atan2(k, bl) * degrees$2 - 120 : NaN;
  return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);
}

function cubehelix$3(h, s, l, opacity) {
  return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);
}

function Cubehelix(h, s, l, opacity) {
  this.h = +h;
  this.s = +s;
  this.l = +l;
  this.opacity = +opacity;
}

define(Cubehelix, cubehelix$3, extend$1(Color, {
  brighter(k) {
    k = k == null ? brighter : Math.pow(brighter, k);
    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);
  },
  darker(k) {
    k = k == null ? darker : Math.pow(darker, k);
    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);
  },
  rgb() {
    var h = isNaN(this.h) ? 0 : (this.h + 120) * radians$1,
        l = +this.l,
        a = isNaN(this.s) ? 0 : this.s * l * (1 - l),
        cosh = Math.cos(h),
        sinh = Math.sin(h);
    return new Rgb(
      255 * (l + a * (A * cosh + B$1 * sinh)),
      255 * (l + a * (C * cosh + D$1 * sinh)),
      255 * (l + a * (E * cosh)),
      this.opacity
    );
  }
}));

function basis$1(t1, v0, v1, v2, v3) {
  var t2 = t1 * t1, t3 = t2 * t1;
  return ((1 - 3 * t1 + 3 * t2 - t3) * v0
      + (4 - 6 * t2 + 3 * t3) * v1
      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2
      + t3 * v3) / 6;
}

function basis$2(values) {
  var n = values.length - 1;
  return function(t) {
    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),
        v1 = values[i],
        v2 = values[i + 1],
        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,
        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;
    return basis$1((t - i / n) * n, v0, v1, v2, v3);
  };
}

function basisClosed$1(values) {
  var n = values.length;
  return function(t) {
    var i = Math.floor(((t %= 1) < 0 ? ++t : t) * n),
        v0 = values[(i + n - 1) % n],
        v1 = values[i % n],
        v2 = values[(i + 1) % n],
        v3 = values[(i + 2) % n];
    return basis$1((t - i / n) * n, v0, v1, v2, v3);
  };
}

var constant$8 = x => () => x;

function linear$2(a, d) {
  return function(t) {
    return a + t * d;
  };
}

function exponential$1(a, b, y) {
  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {
    return Math.pow(a + t * b, y);
  };
}

function hue$1(a, b) {
  var d = b - a;
  return d ? linear$2(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant$8(isNaN(a) ? b : a);
}

function gamma$1(y) {
  return (y = +y) === 1 ? nogamma : function(a, b) {
    return b - a ? exponential$1(a, b, y) : constant$8(isNaN(a) ? b : a);
  };
}

function nogamma(a, b) {
  var d = b - a;
  return d ? linear$2(a, d) : constant$8(isNaN(a) ? b : a);
}

var interpolateRgb = (function rgbGamma(y) {
  var color = gamma$1(y);

  function rgb$1(start, end) {
    var r = color((start = rgb(start)).r, (end = rgb(end)).r),
        g = color(start.g, end.g),
        b = color(start.b, end.b),
        opacity = nogamma(start.opacity, end.opacity);
    return function(t) {
      start.r = r(t);
      start.g = g(t);
      start.b = b(t);
      start.opacity = opacity(t);
      return start + "";
    };
  }

  rgb$1.gamma = rgbGamma;

  return rgb$1;
})(1);

function rgbSpline(spline) {
  return function(colors) {
    var n = colors.length,
        r = new Array(n),
        g = new Array(n),
        b = new Array(n),
        i, color;
    for (i = 0; i < n; ++i) {
      color = rgb(colors[i]);
      r[i] = color.r || 0;
      g[i] = color.g || 0;
      b[i] = color.b || 0;
    }
    r = spline(r);
    g = spline(g);
    b = spline(b);
    color.opacity = 1;
    return function(t) {
      color.r = r(t);
      color.g = g(t);
      color.b = b(t);
      return color + "";
    };
  };
}

var rgbBasis = rgbSpline(basis$2);
var rgbBasisClosed = rgbSpline(basisClosed$1);

function numberArray(a, b) {
  if (!b) b = [];
  var n = a ? Math.min(b.length, a.length) : 0,
      c = b.slice(),
      i;
  return function(t) {
    for (i = 0; i < n; ++i) c[i] = a[i] * (1 - t) + b[i] * t;
    return c;
  };
}

function isNumberArray(x) {
  return ArrayBuffer.isView(x) && !(x instanceof DataView);
}

function array$3(a, b) {
  return (isNumberArray(b) ? numberArray : genericArray)(a, b);
}

function genericArray(a, b) {
  var nb = b ? b.length : 0,
      na = a ? Math.min(nb, a.length) : 0,
      x = new Array(na),
      c = new Array(nb),
      i;

  for (i = 0; i < na; ++i) x[i] = interpolate$2(a[i], b[i]);
  for (; i < nb; ++i) c[i] = b[i];

  return function(t) {
    for (i = 0; i < na; ++i) c[i] = x[i](t);
    return c;
  };
}

function date$1(a, b) {
  var d = new Date;
  return a = +a, b = +b, function(t) {
    return d.setTime(a * (1 - t) + b * t), d;
  };
}

function interpolateNumber(a, b) {
  return a = +a, b = +b, function(t) {
    return a * (1 - t) + b * t;
  };
}

function object$1(a, b) {
  var i = {},
      c = {},
      k;

  if (a === null || typeof a !== "object") a = {};
  if (b === null || typeof b !== "object") b = {};

  for (k in b) {
    if (k in a) {
      i[k] = interpolate$2(a[k], b[k]);
    } else {
      c[k] = b[k];
    }
  }

  return function(t) {
    for (k in i) c[k] = i[k](t);
    return c;
  };
}

var reA = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,
    reB = new RegExp(reA.source, "g");

function zero(b) {
  return function() {
    return b;
  };
}

function one(b) {
  return function(t) {
    return b(t) + "";
  };
}

function interpolateString(a, b) {
  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b
      am, // current match in a
      bm, // current match in b
      bs, // string preceding current number in b, if any
      i = -1, // index in s
      s = [], // string constants and placeholders
      q = []; // number interpolators

  // Coerce inputs to strings.
  a = a + "", b = b + "";

  // Interpolate pairs of numbers in a & b.
  while ((am = reA.exec(a))
      && (bm = reB.exec(b))) {
    if ((bs = bm.index) > bi) { // a string precedes the next number in b
      bs = b.slice(bi, bs);
      if (s[i]) s[i] += bs; // coalesce with previous string
      else s[++i] = bs;
    }
    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match
      if (s[i]) s[i] += bm; // coalesce with previous string
      else s[++i] = bm;
    } else { // interpolate non-matching numbers
      s[++i] = null;
      q.push({i: i, x: interpolateNumber(am, bm)});
    }
    bi = reB.lastIndex;
  }

  // Add remains of b.
  if (bi < b.length) {
    bs = b.slice(bi);
    if (s[i]) s[i] += bs; // coalesce with previous string
    else s[++i] = bs;
  }

  // Special optimization for only a single match.
  // Otherwise, interpolate each of the numbers and rejoin the string.
  return s.length < 2 ? (q[0]
      ? one(q[0].x)
      : zero(b))
      : (b = q.length, function(t) {
          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);
          return s.join("");
        });
}

function interpolate$2(a, b) {
  var t = typeof b, c;
  return b == null || t === "boolean" ? constant$8(b)
      : (t === "number" ? interpolateNumber
      : t === "string" ? ((c = color(b)) ? (b = c, interpolateRgb) : interpolateString)
      : b instanceof color ? interpolateRgb
      : b instanceof Date ? date$1
      : isNumberArray(b) ? numberArray
      : Array.isArray(b) ? genericArray
      : typeof b.valueOf !== "function" && typeof b.toString !== "function" || isNaN(b) ? object$1
      : interpolateNumber)(a, b);
}

function discrete(range) {
  var n = range.length;
  return function(t) {
    return range[Math.max(0, Math.min(n - 1, Math.floor(t * n)))];
  };
}

function hue(a, b) {
  var i = hue$1(+a, +b);
  return function(t) {
    var x = i(t);
    return x - 360 * Math.floor(x / 360);
  };
}

function interpolateRound(a, b) {
  return a = +a, b = +b, function(t) {
    return Math.round(a * (1 - t) + b * t);
  };
}

var degrees$1 = 180 / Math.PI;

var identity$7 = {
  translateX: 0,
  translateY: 0,
  rotate: 0,
  skewX: 0,
  scaleX: 1,
  scaleY: 1
};

function decompose(a, b, c, d, e, f) {
  var scaleX, scaleY, skewX;
  if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;
  if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;
  if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;
  if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;
  return {
    translateX: e,
    translateY: f,
    rotate: Math.atan2(b, a) * degrees$1,
    skewX: Math.atan(skewX) * degrees$1,
    scaleX: scaleX,
    scaleY: scaleY
  };
}

var svgNode;

/* eslint-disable no-undef */
function parseCss(value) {
  const m = new (typeof DOMMatrix === "function" ? DOMMatrix : WebKitCSSMatrix)(value + "");
  return m.isIdentity ? identity$7 : decompose(m.a, m.b, m.c, m.d, m.e, m.f);
}

function parseSvg(value) {
  if (value == null) return identity$7;
  if (!svgNode) svgNode = document.createElementNS("http://www.w3.org/2000/svg", "g");
  svgNode.setAttribute("transform", value);
  if (!(value = svgNode.transform.baseVal.consolidate())) return identity$7;
  value = value.matrix;
  return decompose(value.a, value.b, value.c, value.d, value.e, value.f);
}

function interpolateTransform(parse, pxComma, pxParen, degParen) {

  function pop(s) {
    return s.length ? s.pop() + " " : "";
  }

  function translate(xa, ya, xb, yb, s, q) {
    if (xa !== xb || ya !== yb) {
      var i = s.push("translate(", null, pxComma, null, pxParen);
      q.push({i: i - 4, x: interpolateNumber(xa, xb)}, {i: i - 2, x: interpolateNumber(ya, yb)});
    } else if (xb || yb) {
      s.push("translate(" + xb + pxComma + yb + pxParen);
    }
  }

  function rotate(a, b, s, q) {
    if (a !== b) {
      if (a - b > 180) b += 360; else if (b - a > 180) a += 360; // shortest path
      q.push({i: s.push(pop(s) + "rotate(", null, degParen) - 2, x: interpolateNumber(a, b)});
    } else if (b) {
      s.push(pop(s) + "rotate(" + b + degParen);
    }
  }

  function skewX(a, b, s, q) {
    if (a !== b) {
      q.push({i: s.push(pop(s) + "skewX(", null, degParen) - 2, x: interpolateNumber(a, b)});
    } else if (b) {
      s.push(pop(s) + "skewX(" + b + degParen);
    }
  }

  function scale(xa, ya, xb, yb, s, q) {
    if (xa !== xb || ya !== yb) {
      var i = s.push(pop(s) + "scale(", null, ",", null, ")");
      q.push({i: i - 4, x: interpolateNumber(xa, xb)}, {i: i - 2, x: interpolateNumber(ya, yb)});
    } else if (xb !== 1 || yb !== 1) {
      s.push(pop(s) + "scale(" + xb + "," + yb + ")");
    }
  }

  return function(a, b) {
    var s = [], // string constants and placeholders
        q = []; // number interpolators
    a = parse(a), b = parse(b);
    translate(a.translateX, a.translateY, b.translateX, b.translateY, s, q);
    rotate(a.rotate, b.rotate, s, q);
    skewX(a.skewX, b.skewX, s, q);
    scale(a.scaleX, a.scaleY, b.scaleX, b.scaleY, s, q);
    a = b = null; // gc
    return function(t) {
      var i = -1, n = q.length, o;
      while (++i < n) s[(o = q[i]).i] = o.x(t);
      return s.join("");
    };
  };
}

var interpolateTransformCss = interpolateTransform(parseCss, "px, ", "px)", "deg)");
var interpolateTransformSvg = interpolateTransform(parseSvg, ", ", ")", ")");

var epsilon2$1 = 1e-12;

function cosh(x) {
  return ((x = Math.exp(x)) + 1 / x) / 2;
}

function sinh(x) {
  return ((x = Math.exp(x)) - 1 / x) / 2;
}

function tanh(x) {
  return ((x = Math.exp(2 * x)) - 1) / (x + 1);
}

var interpolateZoom = (function zoomRho(rho, rho2, rho4) {

  // p0 = [ux0, uy0, w0]
  // p1 = [ux1, uy1, w1]
  function zoom(p0, p1) {
    var ux0 = p0[0], uy0 = p0[1], w0 = p0[2],
        ux1 = p1[0], uy1 = p1[1], w1 = p1[2],
        dx = ux1 - ux0,
        dy = uy1 - uy0,
        d2 = dx * dx + dy * dy,
        i,
        S;

    // Special case for u0 ≅ u1.
    if (d2 < epsilon2$1) {
      S = Math.log(w1 / w0) / rho;
      i = function(t) {
        return [
          ux0 + t * dx,
          uy0 + t * dy,
          w0 * Math.exp(rho * t * S)
        ];
      };
    }

    // General case.
    else {
      var d1 = Math.sqrt(d2),
          b0 = (w1 * w1 - w0 * w0 + rho4 * d2) / (2 * w0 * rho2 * d1),
          b1 = (w1 * w1 - w0 * w0 - rho4 * d2) / (2 * w1 * rho2 * d1),
          r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0),
          r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1);
      S = (r1 - r0) / rho;
      i = function(t) {
        var s = t * S,
            coshr0 = cosh(r0),
            u = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));
        return [
          ux0 + u * dx,
          uy0 + u * dy,
          w0 * coshr0 / cosh(rho * s + r0)
        ];
      };
    }

    i.duration = S * 1000 * rho / Math.SQRT2;

    return i;
  }

  zoom.rho = function(_) {
    var _1 = Math.max(1e-3, +_), _2 = _1 * _1, _4 = _2 * _2;
    return zoomRho(_1, _2, _4);
  };

  return zoom;
})(Math.SQRT2, 2, 4);

function hsl(hue) {
  return function(start, end) {
    var h = hue((start = hsl$2(start)).h, (end = hsl$2(end)).h),
        s = nogamma(start.s, end.s),
        l = nogamma(start.l, end.l),
        opacity = nogamma(start.opacity, end.opacity);
    return function(t) {
      start.h = h(t);
      start.s = s(t);
      start.l = l(t);
      start.opacity = opacity(t);
      return start + "";
    };
  }
}

var hsl$1 = hsl(hue$1);
var hslLong = hsl(nogamma);

function lab(start, end) {
  var l = nogamma((start = lab$1(start)).l, (end = lab$1(end)).l),
      a = nogamma(start.a, end.a),
      b = nogamma(start.b, end.b),
      opacity = nogamma(start.opacity, end.opacity);
  return function(t) {
    start.l = l(t);
    start.a = a(t);
    start.b = b(t);
    start.opacity = opacity(t);
    return start + "";
  };
}

function hcl(hue) {
  return function(start, end) {
    var h = hue((start = hcl$2(start)).h, (end = hcl$2(end)).h),
        c = nogamma(start.c, end.c),
        l = nogamma(start.l, end.l),
        opacity = nogamma(start.opacity, end.opacity);
    return function(t) {
      start.h = h(t);
      start.c = c(t);
      start.l = l(t);
      start.opacity = opacity(t);
      return start + "";
    };
  }
}

var hcl$1 = hcl(hue$1);
var hclLong = hcl(nogamma);

function cubehelix$1(hue) {
  return (function cubehelixGamma(y) {
    y = +y;

    function cubehelix(start, end) {
      var h = hue((start = cubehelix$3(start)).h, (end = cubehelix$3(end)).h),
          s = nogamma(start.s, end.s),
          l = nogamma(start.l, end.l),
          opacity = nogamma(start.opacity, end.opacity);
      return function(t) {
        start.h = h(t);
        start.s = s(t);
        start.l = l(Math.pow(t, y));
        start.opacity = opacity(t);
        return start + "";
      };
    }

    cubehelix.gamma = cubehelixGamma;

    return cubehelix;
  })(1);
}

var cubehelix$2 = cubehelix$1(hue$1);
var cubehelixLong = cubehelix$1(nogamma);

function piecewise(interpolate, values) {
  if (values === undefined) values = interpolate, interpolate = interpolate$2;
  var i = 0, n = values.length - 1, v = values[0], I = new Array(n < 0 ? 0 : n);
  while (i < n) I[i] = interpolate(v, v = values[++i]);
  return function(t) {
    var i = Math.max(0, Math.min(n - 1, Math.floor(t *= n)));
    return I[i](t - i);
  };
}

function quantize$1(interpolator, n) {
  var samples = new Array(n);
  for (var i = 0; i < n; ++i) samples[i] = interpolator(i / (n - 1));
  return samples;
}

var frame = 0, // is an animation frame pending?
    timeout$1 = 0, // is a timeout pending?
    interval$1 = 0, // are any timers active?
    pokeDelay = 1000, // how frequently we check for clock skew
    taskHead,
    taskTail,
    clockLast = 0,
    clockNow = 0,
    clockSkew = 0,
    clock = typeof performance === "object" && performance.now ? performance : Date,
    setFrame = typeof window === "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(f) { setTimeout(f, 17); };

function now() {
  return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);
}

function clearNow() {
  clockNow = 0;
}

function Timer() {
  this._call =
  this._time =
  this._next = null;
}

Timer.prototype = timer.prototype = {
  constructor: Timer,
  restart: function(callback, delay, time) {
    if (typeof callback !== "function") throw new TypeError("callback is not a function");
    time = (time == null ? now() : +time) + (delay == null ? 0 : +delay);
    if (!this._next && taskTail !== this) {
      if (taskTail) taskTail._next = this;
      else taskHead = this;
      taskTail = this;
    }
    this._call = callback;
    this._time = time;
    sleep();
  },
  stop: function() {
    if (this._call) {
      this._call = null;
      this._time = Infinity;
      sleep();
    }
  }
};

function timer(callback, delay, time) {
  var t = new Timer;
  t.restart(callback, delay, time);
  return t;
}

function timerFlush() {
  now(); // Get the current time, if not already set.
  ++frame; // Pretend we’ve set an alarm, if we haven’t already.
  var t = taskHead, e;
  while (t) {
    if ((e = clockNow - t._time) >= 0) t._call.call(undefined, e);
    t = t._next;
  }
  --frame;
}

function wake() {
  clockNow = (clockLast = clock.now()) + clockSkew;
  frame = timeout$1 = 0;
  try {
    timerFlush();
  } finally {
    frame = 0;
    nap();
    clockNow = 0;
  }
}

function poke() {
  var now = clock.now(), delay = now - clockLast;
  if (delay > pokeDelay) clockSkew -= delay, clockLast = now;
}

function nap() {
  var t0, t1 = taskHead, t2, time = Infinity;
  while (t1) {
    if (t1._call) {
      if (time > t1._time) time = t1._time;
      t0 = t1, t1 = t1._next;
    } else {
      t2 = t1._next, t1._next = null;
      t1 = t0 ? t0._next = t2 : taskHead = t2;
    }
  }
  taskTail = t0;
  sleep(time);
}

function sleep(time) {
  if (frame) return; // Soonest alarm already set, or will be.
  if (timeout$1) timeout$1 = clearTimeout(timeout$1);
  var delay = time - clockNow; // Strictly less than if we recomputed clockNow.
  if (delay > 24) {
    if (time < Infinity) timeout$1 = setTimeout(wake, time - clock.now() - clockSkew);
    if (interval$1) interval$1 = clearInterval(interval$1);
  } else {
    if (!interval$1) clockLast = clock.now(), interval$1 = setInterval(poke, pokeDelay);
    frame = 1, setFrame(wake);
  }
}

function timeout(callback, delay, time) {
  var t = new Timer;
  delay = delay == null ? 0 : +delay;
  t.restart(elapsed => {
    t.stop();
    callback(elapsed + delay);
  }, delay, time);
  return t;
}

function interval(callback, delay, time) {
  var t = new Timer, total = delay;
  if (delay == null) return t.restart(callback, delay, time), t;
  t._restart = t.restart;
  t.restart = function(callback, delay, time) {
    delay = +delay, time = time == null ? now() : +time;
    t._restart(function tick(elapsed) {
      elapsed += total;
      t._restart(tick, total += delay, time);
      callback(elapsed);
    }, delay, time);
  };
  t.restart(callback, delay, time);
  return t;
}

var emptyOn = dispatch("start", "end", "cancel", "interrupt");
var emptyTween = [];

var CREATED = 0;
var SCHEDULED = 1;
var STARTING = 2;
var STARTED = 3;
var RUNNING = 4;
var ENDING = 5;
var ENDED = 6;

function schedule(node, name, id, index, group, timing) {
  var schedules = node.__transition;
  if (!schedules) node.__transition = {};
  else if (id in schedules) return;
  create(node, id, {
    name: name,
    index: index, // For context during callback.
    group: group, // For context during callback.
    on: emptyOn,
    tween: emptyTween,
    time: timing.time,
    delay: timing.delay,
    duration: timing.duration,
    ease: timing.ease,
    timer: null,
    state: CREATED
  });
}

function init(node, id) {
  var schedule = get(node, id);
  if (schedule.state > CREATED) throw new Error("too late; already scheduled");
  return schedule;
}

function set(node, id) {
  var schedule = get(node, id);
  if (schedule.state > STARTED) throw new Error("too late; already running");
  return schedule;
}

function get(node, id) {
  var schedule = node.__transition;
  if (!schedule || !(schedule = schedule[id])) throw new Error("transition not found");
  return schedule;
}

function create(node, id, self) {
  var schedules = node.__transition,
      tween;

  // Initialize the self timer when the transition is created.
  // Note the actual delay is not known until the first callback!
  schedules[id] = self;
  self.timer = timer(schedule, 0, self.time);

  function schedule(elapsed) {
    self.state = SCHEDULED;
    self.timer.restart(start, self.delay, self.time);

    // If the elapsed delay is less than our first sleep, start immediately.
    if (self.delay <= elapsed) start(elapsed - self.delay);
  }

  function start(elapsed) {
    var i, j, n, o;

    // If the state is not SCHEDULED, then we previously errored on start.
    if (self.state !== SCHEDULED) return stop();

    for (i in schedules) {
      o = schedules[i];
      if (o.name !== self.name) continue;

      // While this element already has a starting transition during this frame,
      // defer starting an interrupting transition until that transition has a
      // chance to tick (and possibly end); see d3/d3-transition#54!
      if (o.state === STARTED) return timeout(start);

      // Interrupt the active transition, if any.
      if (o.state === RUNNING) {
        o.state = ENDED;
        o.timer.stop();
        o.on.call("interrupt", node, node.__data__, o.index, o.group);
        delete schedules[i];
      }

      // Cancel any pre-empted transitions.
      else if (+i < id) {
        o.state = ENDED;
        o.timer.stop();
        o.on.call("cancel", node, node.__data__, o.index, o.group);
        delete schedules[i];
      }
    }

    // Defer the first tick to end of the current frame; see d3/d3#1576.
    // Note the transition may be canceled after start and before the first tick!
    // Note this must be scheduled before the start event; see d3/d3-transition#16!
    // Assuming this is successful, subsequent callbacks go straight to tick.
    timeout(function() {
      if (self.state === STARTED) {
        self.state = RUNNING;
        self.timer.restart(tick, self.delay, self.time);
        tick(elapsed);
      }
    });

    // Dispatch the start event.
    // Note this must be done before the tween are initialized.
    self.state = STARTING;
    self.on.call("start", node, node.__data__, self.index, self.group);
    if (self.state !== STARTING) return; // interrupted
    self.state = STARTED;

    // Initialize the tween, deleting null tween.
    tween = new Array(n = self.tween.length);
    for (i = 0, j = -1; i < n; ++i) {
      if (o = self.tween[i].value.call(node, node.__data__, self.index, self.group)) {
        tween[++j] = o;
      }
    }
    tween.length = j + 1;
  }

  function tick(elapsed) {
    var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop), self.state = ENDING, 1),
        i = -1,
        n = tween.length;

    while (++i < n) {
      tween[i].call(node, t);
    }

    // Dispatch the end event.
    if (self.state === ENDING) {
      self.on.call("end", node, node.__data__, self.index, self.group);
      stop();
    }
  }

  function stop() {
    self.state = ENDED;
    self.timer.stop();
    delete schedules[id];
    for (var i in schedules) return; // eslint-disable-line no-unused-vars
    delete node.__transition;
  }
}

function interrupt(node, name) {
  var schedules = node.__transition,
      schedule,
      active,
      empty = true,
      i;

  if (!schedules) return;

  name = name == null ? null : name + "";

  for (i in schedules) {
    if ((schedule = schedules[i]).name !== name) { empty = false; continue; }
    active = schedule.state > STARTING && schedule.state < ENDING;
    schedule.state = ENDED;
    schedule.timer.stop();
    schedule.on.call(active ? "interrupt" : "cancel", node, node.__data__, schedule.index, schedule.group);
    delete schedules[i];
  }

  if (empty) delete node.__transition;
}

function selection_interrupt(name) {
  return this.each(function() {
    interrupt(this, name);
  });
}

function tweenRemove(id, name) {
  var tween0, tween1;
  return function() {
    var schedule = set(this, id),
        tween = schedule.tween;

    // If this node shared tween with the previous node,
    // just assign the updated shared tween and we’re done!
    // Otherwise, copy-on-write.
    if (tween !== tween0) {
      tween1 = tween0 = tween;
      for (var i = 0, n = tween1.length; i < n; ++i) {
        if (tween1[i].name === name) {
          tween1 = tween1.slice();
          tween1.splice(i, 1);
          break;
        }
      }
    }

    schedule.tween = tween1;
  };
}

function tweenFunction(id, name, value) {
  var tween0, tween1;
  if (typeof value !== "function") throw new Error;
  return function() {
    var schedule = set(this, id),
        tween = schedule.tween;

    // If this node shared tween with the previous node,
    // just assign the updated shared tween and we’re done!
    // Otherwise, copy-on-write.
    if (tween !== tween0) {
      tween1 = (tween0 = tween).slice();
      for (var t = {name: name, value: value}, i = 0, n = tween1.length; i < n; ++i) {
        if (tween1[i].name === name) {
          tween1[i] = t;
          break;
        }
      }
      if (i === n) tween1.push(t);
    }

    schedule.tween = tween1;
  };
}

function transition_tween(name, value) {
  var id = this._id;

  name += "";

  if (arguments.length < 2) {
    var tween = get(this.node(), id).tween;
    for (var i = 0, n = tween.length, t; i < n; ++i) {
      if ((t = tween[i]).name === name) {
        return t.value;
      }
    }
    return null;
  }

  return this.each((value == null ? tweenRemove : tweenFunction)(id, name, value));
}

function tweenValue(transition, name, value) {
  var id = transition._id;

  transition.each(function() {
    var schedule = set(this, id);
    (schedule.value || (schedule.value = {}))[name] = value.apply(this, arguments);
  });

  return function(node) {
    return get(node, id).value[name];
  };
}

function interpolate$1(a, b) {
  var c;
  return (typeof b === "number" ? interpolateNumber
      : b instanceof color ? interpolateRgb
      : (c = color(b)) ? (b = c, interpolateRgb)
      : interpolateString)(a, b);
}

function attrRemove(name) {
  return function() {
    this.removeAttribute(name);
  };
}

function attrRemoveNS(fullname) {
  return function() {
    this.removeAttributeNS(fullname.space, fullname.local);
  };
}

function attrConstant(name, interpolate, value1) {
  var string00,
      string1 = value1 + "",
      interpolate0;
  return function() {
    var string0 = this.getAttribute(name);
    return string0 === string1 ? null
        : string0 === string00 ? interpolate0
        : interpolate0 = interpolate(string00 = string0, value1);
  };
}

function attrConstantNS(fullname, interpolate, value1) {
  var string00,
      string1 = value1 + "",
      interpolate0;
  return function() {
    var string0 = this.getAttributeNS(fullname.space, fullname.local);
    return string0 === string1 ? null
        : string0 === string00 ? interpolate0
        : interpolate0 = interpolate(string00 = string0, value1);
  };
}

function attrFunction(name, interpolate, value) {
  var string00,
      string10,
      interpolate0;
  return function() {
    var string0, value1 = value(this), string1;
    if (value1 == null) return void this.removeAttribute(name);
    string0 = this.getAttribute(name);
    string1 = value1 + "";
    return string0 === string1 ? null
        : string0 === string00 && string1 === string10 ? interpolate0
        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
  };
}

function attrFunctionNS(fullname, interpolate, value) {
  var string00,
      string10,
      interpolate0;
  return function() {
    var string0, value1 = value(this), string1;
    if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);
    string0 = this.getAttributeNS(fullname.space, fullname.local);
    string1 = value1 + "";
    return string0 === string1 ? null
        : string0 === string00 && string1 === string10 ? interpolate0
        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
  };
}

function transition_attr(name, value) {
  var fullname = namespace(name), i = fullname === "transform" ? interpolateTransformSvg : interpolate$1;
  return this.attrTween(name, typeof value === "function"
      ? (fullname.local ? attrFunctionNS : attrFunction)(fullname, i, tweenValue(this, "attr." + name, value))
      : value == null ? (fullname.local ? attrRemoveNS : attrRemove)(fullname)
      : (fullname.local ? attrConstantNS : attrConstant)(fullname, i, value));
}

function attrInterpolate(name, i) {
  return function(t) {
    this.setAttribute(name, i.call(this, t));
  };
}

function attrInterpolateNS(fullname, i) {
  return function(t) {
    this.setAttributeNS(fullname.space, fullname.local, i.call(this, t));
  };
}

function attrTweenNS(fullname, value) {
  var t0, i0;
  function tween() {
    var i = value.apply(this, arguments);
    if (i !== i0) t0 = (i0 = i) && attrInterpolateNS(fullname, i);
    return t0;
  }
  tween._value = value;
  return tween;
}

function attrTween(name, value) {
  var t0, i0;
  function tween() {
    var i = value.apply(this, arguments);
    if (i !== i0) t0 = (i0 = i) && attrInterpolate(name, i);
    return t0;
  }
  tween._value = value;
  return tween;
}

function transition_attrTween(name, value) {
  var key = "attr." + name;
  if (arguments.length < 2) return (key = this.tween(key)) && key._value;
  if (value == null) return this.tween(key, null);
  if (typeof value !== "function") throw new Error;
  var fullname = namespace(name);
  return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value));
}

function delayFunction(id, value) {
  return function() {
    init(this, id).delay = +value.apply(this, arguments);
  };
}

function delayConstant(id, value) {
  return value = +value, function() {
    init(this, id).delay = value;
  };
}

function transition_delay(value) {
  var id = this._id;

  return arguments.length
      ? this.each((typeof value === "function"
          ? delayFunction
          : delayConstant)(id, value))
      : get(this.node(), id).delay;
}

function durationFunction(id, value) {
  return function() {
    set(this, id).duration = +value.apply(this, arguments);
  };
}

function durationConstant(id, value) {
  return value = +value, function() {
    set(this, id).duration = value;
  };
}

function transition_duration(value) {
  var id = this._id;

  return arguments.length
      ? this.each((typeof value === "function"
          ? durationFunction
          : durationConstant)(id, value))
      : get(this.node(), id).duration;
}

function easeConstant(id, value) {
  if (typeof value !== "function") throw new Error;
  return function() {
    set(this, id).ease = value;
  };
}

function transition_ease(value) {
  var id = this._id;

  return arguments.length
      ? this.each(easeConstant(id, value))
      : get(this.node(), id).ease;
}

function easeVarying(id, value) {
  return function() {
    var v = value.apply(this, arguments);
    if (typeof v !== "function") throw new Error;
    set(this, id).ease = v;
  };
}

function transition_easeVarying(value) {
  if (typeof value !== "function") throw new Error;
  return this.each(easeVarying(this._id, value));
}

function transition_filter(match) {
  if (typeof match !== "function") match = matcher(match);

  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {
      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {
        subgroup.push(node);
      }
    }
  }

  return new Transition(subgroups, this._parents, this._name, this._id);
}

function transition_merge(transition) {
  if (transition._id !== this._id) throw new Error;

  for (var groups0 = this._groups, groups1 = transition._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {
    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {
      if (node = group0[i] || group1[i]) {
        merge[i] = node;
      }
    }
  }

  for (; j < m0; ++j) {
    merges[j] = groups0[j];
  }

  return new Transition(merges, this._parents, this._name, this._id);
}

function start(name) {
  return (name + "").trim().split(/^|\s+/).every(function(t) {
    var i = t.indexOf(".");
    if (i >= 0) t = t.slice(0, i);
    return !t || t === "start";
  });
}

function onFunction(id, name, listener) {
  var on0, on1, sit = start(name) ? init : set;
  return function() {
    var schedule = sit(this, id),
        on = schedule.on;

    // If this node shared a dispatch with the previous node,
    // just assign the updated shared dispatch and we’re done!
    // Otherwise, copy-on-write.
    if (on !== on0) (on1 = (on0 = on).copy()).on(name, listener);

    schedule.on = on1;
  };
}

function transition_on(name, listener) {
  var id = this._id;

  return arguments.length < 2
      ? get(this.node(), id).on.on(name)
      : this.each(onFunction(id, name, listener));
}

function removeFunction(id) {
  return function() {
    var parent = this.parentNode;
    for (var i in this.__transition) if (+i !== id) return;
    if (parent) parent.removeChild(this);
  };
}

function transition_remove() {
  return this.on("end.remove", removeFunction(this._id));
}

function transition_select(select) {
  var name = this._name,
      id = this._id;

  if (typeof select !== "function") select = selector(select);

  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {
      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {
        if ("__data__" in node) subnode.__data__ = node.__data__;
        subgroup[i] = subnode;
        schedule(subgroup[i], name, id, i, subgroup, get(node, id));
      }
    }
  }

  return new Transition(subgroups, this._parents, name, id);
}

function transition_selectAll(select) {
  var name = this._name,
      id = this._id;

  if (typeof select !== "function") select = selectorAll(select);

  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        for (var children = select.call(node, node.__data__, i, group), child, inherit = get(node, id), k = 0, l = children.length; k < l; ++k) {
          if (child = children[k]) {
            schedule(child, name, id, k, children, inherit);
          }
        }
        subgroups.push(children);
        parents.push(node);
      }
    }
  }

  return new Transition(subgroups, parents, name, id);
}

var Selection = selection.prototype.constructor;

function transition_selection() {
  return new Selection(this._groups, this._parents);
}

function styleNull(name, interpolate) {
  var string00,
      string10,
      interpolate0;
  return function() {
    var string0 = styleValue(this, name),
        string1 = (this.style.removeProperty(name), styleValue(this, name));
    return string0 === string1 ? null
        : string0 === string00 && string1 === string10 ? interpolate0
        : interpolate0 = interpolate(string00 = string0, string10 = string1);
  };
}

function styleRemove(name) {
  return function() {
    this.style.removeProperty(name);
  };
}

function styleConstant(name, interpolate, value1) {
  var string00,
      string1 = value1 + "",
      interpolate0;
  return function() {
    var string0 = styleValue(this, name);
    return string0 === string1 ? null
        : string0 === string00 ? interpolate0
        : interpolate0 = interpolate(string00 = string0, value1);
  };
}

function styleFunction(name, interpolate, value) {
  var string00,
      string10,
      interpolate0;
  return function() {
    var string0 = styleValue(this, name),
        value1 = value(this),
        string1 = value1 + "";
    if (value1 == null) string1 = value1 = (this.style.removeProperty(name), styleValue(this, name));
    return string0 === string1 ? null
        : string0 === string00 && string1 === string10 ? interpolate0
        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));
  };
}

function styleMaybeRemove(id, name) {
  var on0, on1, listener0, key = "style." + name, event = "end." + key, remove;
  return function() {
    var schedule = set(this, id),
        on = schedule.on,
        listener = schedule.value[key] == null ? remove || (remove = styleRemove(name)) : undefined;

    // If this node shared a dispatch with the previous node,
    // just assign the updated shared dispatch and we’re done!
    // Otherwise, copy-on-write.
    if (on !== on0 || listener0 !== listener) (on1 = (on0 = on).copy()).on(event, listener0 = listener);

    schedule.on = on1;
  };
}

function transition_style(name, value, priority) {
  var i = (name += "") === "transform" ? interpolateTransformCss : interpolate$1;
  return value == null ? this
      .styleTween(name, styleNull(name, i))
      .on("end.style." + name, styleRemove(name))
    : typeof value === "function" ? this
      .styleTween(name, styleFunction(name, i, tweenValue(this, "style." + name, value)))
      .each(styleMaybeRemove(this._id, name))
    : this
      .styleTween(name, styleConstant(name, i, value), priority)
      .on("end.style." + name, null);
}

function styleInterpolate(name, i, priority) {
  return function(t) {
    this.style.setProperty(name, i.call(this, t), priority);
  };
}

function styleTween(name, value, priority) {
  var t, i0;
  function tween() {
    var i = value.apply(this, arguments);
    if (i !== i0) t = (i0 = i) && styleInterpolate(name, i, priority);
    return t;
  }
  tween._value = value;
  return tween;
}

function transition_styleTween(name, value, priority) {
  var key = "style." + (name += "");
  if (arguments.length < 2) return (key = this.tween(key)) && key._value;
  if (value == null) return this.tween(key, null);
  if (typeof value !== "function") throw new Error;
  return this.tween(key, styleTween(name, value, priority == null ? "" : priority));
}

function textConstant(value) {
  return function() {
    this.textContent = value;
  };
}

function textFunction(value) {
  return function() {
    var value1 = value(this);
    this.textContent = value1 == null ? "" : value1;
  };
}

function transition_text(value) {
  return this.tween("text", typeof value === "function"
      ? textFunction(tweenValue(this, "text", value))
      : textConstant(value == null ? "" : value + ""));
}

function textInterpolate(i) {
  return function(t) {
    this.textContent = i.call(this, t);
  };
}

function textTween(value) {
  var t0, i0;
  function tween() {
    var i = value.apply(this, arguments);
    if (i !== i0) t0 = (i0 = i) && textInterpolate(i);
    return t0;
  }
  tween._value = value;
  return tween;
}

function transition_textTween(value) {
  var key = "text";
  if (arguments.length < 1) return (key = this.tween(key)) && key._value;
  if (value == null) return this.tween(key, null);
  if (typeof value !== "function") throw new Error;
  return this.tween(key, textTween(value));
}

function transition_transition() {
  var name = this._name,
      id0 = this._id,
      id1 = newId();

  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        var inherit = get(node, id0);
        schedule(node, name, id1, i, group, {
          time: inherit.time + inherit.delay + inherit.duration,
          delay: 0,
          duration: inherit.duration,
          ease: inherit.ease
        });
      }
    }
  }

  return new Transition(groups, this._parents, name, id1);
}

function transition_end() {
  var on0, on1, that = this, id = that._id, size = that.size();
  return new Promise(function(resolve, reject) {
    var cancel = {value: reject},
        end = {value: function() { if (--size === 0) resolve(); }};

    that.each(function() {
      var schedule = set(this, id),
          on = schedule.on;

      // If this node shared a dispatch with the previous node,
      // just assign the updated shared dispatch and we’re done!
      // Otherwise, copy-on-write.
      if (on !== on0) {
        on1 = (on0 = on).copy();
        on1._.cancel.push(cancel);
        on1._.interrupt.push(cancel);
        on1._.end.push(end);
      }

      schedule.on = on1;
    });

    // The selection was empty, resolve end immediately
    if (size === 0) resolve();
  });
}

var id = 0;

function Transition(groups, parents, name, id) {
  this._groups = groups;
  this._parents = parents;
  this._name = name;
  this._id = id;
}

function transition(name) {
  return selection().transition(name);
}

function newId() {
  return ++id;
}

var selection_prototype = selection.prototype;

Transition.prototype = transition.prototype = {
  constructor: Transition,
  select: transition_select,
  selectAll: transition_selectAll,
  selectChild: selection_prototype.selectChild,
  selectChildren: selection_prototype.selectChildren,
  filter: transition_filter,
  merge: transition_merge,
  selection: transition_selection,
  transition: transition_transition,
  call: selection_prototype.call,
  nodes: selection_prototype.nodes,
  node: selection_prototype.node,
  size: selection_prototype.size,
  empty: selection_prototype.empty,
  each: selection_prototype.each,
  on: transition_on,
  attr: transition_attr,
  attrTween: transition_attrTween,
  style: transition_style,
  styleTween: transition_styleTween,
  text: transition_text,
  textTween: transition_textTween,
  remove: transition_remove,
  tween: transition_tween,
  delay: transition_delay,
  duration: transition_duration,
  ease: transition_ease,
  easeVarying: transition_easeVarying,
  end: transition_end,
  [Symbol.iterator]: selection_prototype[Symbol.iterator]
};

const linear$1 = t => +t;

function quadIn(t) {
  return t * t;
}

function quadOut(t) {
  return t * (2 - t);
}

function quadInOut(t) {
  return ((t *= 2) <= 1 ? t * t : --t * (2 - t) + 1) / 2;
}

function cubicIn(t) {
  return t * t * t;
}

function cubicOut(t) {
  return --t * t * t + 1;
}

function cubicInOut(t) {
  return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;
}

var exponent$1 = 3;

var polyIn = (function custom(e) {
  e = +e;

  function polyIn(t) {
    return Math.pow(t, e);
  }

  polyIn.exponent = custom;

  return polyIn;
})(exponent$1);

var polyOut = (function custom(e) {
  e = +e;

  function polyOut(t) {
    return 1 - Math.pow(1 - t, e);
  }

  polyOut.exponent = custom;

  return polyOut;
})(exponent$1);

var polyInOut = (function custom(e) {
  e = +e;

  function polyInOut(t) {
    return ((t *= 2) <= 1 ? Math.pow(t, e) : 2 - Math.pow(2 - t, e)) / 2;
  }

  polyInOut.exponent = custom;

  return polyInOut;
})(exponent$1);

var pi$4 = Math.PI,
    halfPi$3 = pi$4 / 2;

function sinIn(t) {
  return (+t === 1) ? 1 : 1 - Math.cos(t * halfPi$3);
}

function sinOut(t) {
  return Math.sin(t * halfPi$3);
}

function sinInOut(t) {
  return (1 - Math.cos(pi$4 * t)) / 2;
}

// tpmt is two power minus ten times t scaled to [0,1]
function tpmt(x) {
  return (Math.pow(2, -10 * x) - 0.0009765625) * 1.0009775171065494;
}

function expIn(t) {
  return tpmt(1 - +t);
}

function expOut(t) {
  return 1 - tpmt(t);
}

function expInOut(t) {
  return ((t *= 2) <= 1 ? tpmt(1 - t) : 2 - tpmt(t - 1)) / 2;
}

function circleIn(t) {
  return 1 - Math.sqrt(1 - t * t);
}

function circleOut(t) {
  return Math.sqrt(1 - --t * t);
}

function circleInOut(t) {
  return ((t *= 2) <= 1 ? 1 - Math.sqrt(1 - t * t) : Math.sqrt(1 - (t -= 2) * t) + 1) / 2;
}

var b1 = 4 / 11,
    b2 = 6 / 11,
    b3 = 8 / 11,
    b4 = 3 / 4,
    b5 = 9 / 11,
    b6 = 10 / 11,
    b7 = 15 / 16,
    b8 = 21 / 22,
    b9 = 63 / 64,
    b0 = 1 / b1 / b1;

function bounceIn(t) {
  return 1 - bounceOut(1 - t);
}

function bounceOut(t) {
  return (t = +t) < b1 ? b0 * t * t : t < b3 ? b0 * (t -= b2) * t + b4 : t < b6 ? b0 * (t -= b5) * t + b7 : b0 * (t -= b8) * t + b9;
}

function bounceInOut(t) {
  return ((t *= 2) <= 1 ? 1 - bounceOut(1 - t) : bounceOut(t - 1) + 1) / 2;
}

var overshoot = 1.70158;

var backIn = (function custom(s) {
  s = +s;

  function backIn(t) {
    return (t = +t) * t * (s * (t - 1) + t);
  }

  backIn.overshoot = custom;

  return backIn;
})(overshoot);

var backOut = (function custom(s) {
  s = +s;

  function backOut(t) {
    return --t * t * ((t + 1) * s + t) + 1;
  }

  backOut.overshoot = custom;

  return backOut;
})(overshoot);

var backInOut = (function custom(s) {
  s = +s;

  function backInOut(t) {
    return ((t *= 2) < 1 ? t * t * ((s + 1) * t - s) : (t -= 2) * t * ((s + 1) * t + s) + 2) / 2;
  }

  backInOut.overshoot = custom;

  return backInOut;
})(overshoot);

var tau$5 = 2 * Math.PI,
    amplitude = 1,
    period = 0.3;

var elasticIn = (function custom(a, p) {
  var s = Math.asin(1 / (a = Math.max(1, a))) * (p /= tau$5);

  function elasticIn(t) {
    return a * tpmt(-(--t)) * Math.sin((s - t) / p);
  }

  elasticIn.amplitude = function(a) { return custom(a, p * tau$5); };
  elasticIn.period = function(p) { return custom(a, p); };

  return elasticIn;
})(amplitude, period);

var elasticOut = (function custom(a, p) {
  var s = Math.asin(1 / (a = Math.max(1, a))) * (p /= tau$5);

  function elasticOut(t) {
    return 1 - a * tpmt(t = +t) * Math.sin((t + s) / p);
  }

  elasticOut.amplitude = function(a) { return custom(a, p * tau$5); };
  elasticOut.period = function(p) { return custom(a, p); };

  return elasticOut;
})(amplitude, period);

var elasticInOut = (function custom(a, p) {
  var s = Math.asin(1 / (a = Math.max(1, a))) * (p /= tau$5);

  function elasticInOut(t) {
    return ((t = t * 2 - 1) < 0
        ? a * tpmt(-t) * Math.sin((s - t) / p)
        : 2 - a * tpmt(t) * Math.sin((s + t) / p)) / 2;
  }

  elasticInOut.amplitude = function(a) { return custom(a, p * tau$5); };
  elasticInOut.period = function(p) { return custom(a, p); };

  return elasticInOut;
})(amplitude, period);

var defaultTiming = {
  time: null, // Set on use.
  delay: 0,
  duration: 250,
  ease: cubicInOut
};

function inherit(node, id) {
  var timing;
  while (!(timing = node.__transition) || !(timing = timing[id])) {
    if (!(node = node.parentNode)) {
      throw new Error(`transition ${id} not found`);
    }
  }
  return timing;
}

function selection_transition(name) {
  var id,
      timing;

  if (name instanceof Transition) {
    id = name._id, name = name._name;
  } else {
    id = newId(), (timing = defaultTiming).time = now(), name = name == null ? null : name + "";
  }

  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {
    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {
      if (node = group[i]) {
        schedule(node, name, id, i, group, timing || inherit(node, id));
      }
    }
  }

  return new Transition(groups, this._parents, name, id);
}

selection.prototype.interrupt = selection_interrupt;
selection.prototype.transition = selection_transition;

var root = [null];

function active(node, name) {
  var schedules = node.__transition,
      schedule,
      i;

  if (schedules) {
    name = name == null ? null : name + "";
    for (i in schedules) {
      if ((schedule = schedules[i]).state > SCHEDULED && schedule.name === name) {
        return new Transition([[node]], root, name, +i);
      }
    }
  }

  return null;
}

var constant$7 = x => () => x;

function BrushEvent(type, {
  sourceEvent,
  target,
  selection,
  mode,
  dispatch
}) {
  Object.defineProperties(this, {
    type: {value: type, enumerable: true, configurable: true},
    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},
    target: {value: target, enumerable: true, configurable: true},
    selection: {value: selection, enumerable: true, configurable: true},
    mode: {value: mode, enumerable: true, configurable: true},
    _: {value: dispatch}
  });
}

function nopropagation$1(event) {
  event.stopImmediatePropagation();
}

function noevent$1(event) {
  event.preventDefault();
  event.stopImmediatePropagation();
}

var MODE_DRAG = {name: "drag"},
    MODE_SPACE = {name: "space"},
    MODE_HANDLE = {name: "handle"},
    MODE_CENTER = {name: "center"};

const {abs: abs$3, max: max$2, min: min$1} = Math;

function number1(e) {
  return [+e[0], +e[1]];
}

function number2(e) {
  return [number1(e[0]), number1(e[1])];
}

var X = {
  name: "x",
  handles: ["w", "e"].map(type),
  input: function(x, e) { return x == null ? null : [[+x[0], e[0][1]], [+x[1], e[1][1]]]; },
  output: function(xy) { return xy && [xy[0][0], xy[1][0]]; }
};

var Y = {
  name: "y",
  handles: ["n", "s"].map(type),
  input: function(y, e) { return y == null ? null : [[e[0][0], +y[0]], [e[1][0], +y[1]]]; },
  output: function(xy) { return xy && [xy[0][1], xy[1][1]]; }
};

var XY = {
  name: "xy",
  handles: ["n", "w", "e", "s", "nw", "ne", "sw", "se"].map(type),
  input: function(xy) { return xy == null ? null : number2(xy); },
  output: function(xy) { return xy; }
};

var cursors = {
  overlay: "crosshair",
  selection: "move",
  n: "ns-resize",
  e: "ew-resize",
  s: "ns-resize",
  w: "ew-resize",
  nw: "nwse-resize",
  ne: "nesw-resize",
  se: "nwse-resize",
  sw: "nesw-resize"
};

var flipX = {
  e: "w",
  w: "e",
  nw: "ne",
  ne: "nw",
  se: "sw",
  sw: "se"
};

var flipY = {
  n: "s",
  s: "n",
  nw: "sw",
  ne: "se",
  se: "ne",
  sw: "nw"
};

var signsX = {
  overlay: +1,
  selection: +1,
  n: null,
  e: +1,
  s: null,
  w: -1,
  nw: -1,
  ne: +1,
  se: +1,
  sw: -1
};

var signsY = {
  overlay: +1,
  selection: +1,
  n: -1,
  e: null,
  s: +1,
  w: null,
  nw: -1,
  ne: -1,
  se: +1,
  sw: +1
};

function type(t) {
  return {type: t};
}

// Ignore right-click, since that should open the context menu.
function defaultFilter$1(event) {
  return !event.ctrlKey && !event.button;
}

function defaultExtent$1() {
  var svg = this.ownerSVGElement || this;
  if (svg.hasAttribute("viewBox")) {
    svg = svg.viewBox.baseVal;
    return [[svg.x, svg.y], [svg.x + svg.width, svg.y + svg.height]];
  }
  return [[0, 0], [svg.width.baseVal.value, svg.height.baseVal.value]];
}

function defaultTouchable$1() {
  return navigator.maxTouchPoints || ("ontouchstart" in this);
}

// Like d3.local, but with the name “__brush” rather than auto-generated.
function local(node) {
  while (!node.__brush) if (!(node = node.parentNode)) return;
  return node.__brush;
}

function empty(extent) {
  return extent[0][0] === extent[1][0]
      || extent[0][1] === extent[1][1];
}

function brushSelection(node) {
  var state = node.__brush;
  return state ? state.dim.output(state.selection) : null;
}

function brushX() {
  return brush$1(X);
}

function brushY() {
  return brush$1(Y);
}

function brush() {
  return brush$1(XY);
}

function brush$1(dim) {
  var extent = defaultExtent$1,
      filter = defaultFilter$1,
      touchable = defaultTouchable$1,
      keys = true,
      listeners = dispatch("start", "brush", "end"),
      handleSize = 6,
      touchending;

  function brush(group) {
    var overlay = group
        .property("__brush", initialize)
      .selectAll(".overlay")
      .data([type("overlay")]);

    overlay.enter().append("rect")
        .attr("class", "overlay")
        .attr("pointer-events", "all")
        .attr("cursor", cursors.overlay)
      .merge(overlay)
        .each(function() {
          var extent = local(this).extent;
          select(this)
              .attr("x", extent[0][0])
              .attr("y", extent[0][1])
              .attr("width", extent[1][0] - extent[0][0])
              .attr("height", extent[1][1] - extent[0][1]);
        });

    group.selectAll(".selection")
      .data([type("selection")])
      .enter().append("rect")
        .attr("class", "selection")
        .attr("cursor", cursors.selection)
        .attr("fill", "#777")
        .attr("fill-opacity", 0.3)
        .attr("stroke", "#fff")
        .attr("shape-rendering", "crispEdges");

    var handle = group.selectAll(".handle")
      .data(dim.handles, function(d) { return d.type; });

    handle.exit().remove();

    handle.enter().append("rect")
        .attr("class", function(d) { return "handle handle--" + d.type; })
        .attr("cursor", function(d) { return cursors[d.type]; });

    group
        .each(redraw)
        .attr("fill", "none")
        .attr("pointer-events", "all")
        .on("mousedown.brush", started)
      .filter(touchable)
        .on("touchstart.brush", started)
        .on("touchmove.brush", touchmoved)
        .on("touchend.brush touchcancel.brush", touchended)
        .style("touch-action", "none")
        .style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }

  brush.move = function(group, selection, event) {
    if (group.tween) {
      group
          .on("start.brush", function(event) { emitter(this, arguments).beforestart().start(event); })
          .on("interrupt.brush end.brush", function(event) { emitter(this, arguments).end(event); })
          .tween("brush", function() {
            var that = this,
                state = that.__brush,
                emit = emitter(that, arguments),
                selection0 = state.selection,
                selection1 = dim.input(typeof selection === "function" ? selection.apply(this, arguments) : selection, state.extent),
                i = interpolate$2(selection0, selection1);

            function tween(t) {
              state.selection = t === 1 && selection1 === null ? null : i(t);
              redraw.call(that);
              emit.brush();
            }

            return selection0 !== null && selection1 !== null ? tween : tween(1);
          });
    } else {
      group
          .each(function() {
            var that = this,
                args = arguments,
                state = that.__brush,
                selection1 = dim.input(typeof selection === "function" ? selection.apply(that, args) : selection, state.extent),
                emit = emitter(that, args).beforestart();

            interrupt(that);
            state.selection = selection1 === null ? null : selection1;
            redraw.call(that);
            emit.start(event).brush(event).end(event);
          });
    }
  };

  brush.clear = function(group, event) {
    brush.move(group, null, event);
  };

  function redraw() {
    var group = select(this),
        selection = local(this).selection;

    if (selection) {
      group.selectAll(".selection")
          .style("display", null)
          .attr("x", selection[0][0])
          .attr("y", selection[0][1])
          .attr("width", selection[1][0] - selection[0][0])
          .attr("height", selection[1][1] - selection[0][1]);

      group.selectAll(".handle")
          .style("display", null)
          .attr("x", function(d) { return d.type[d.type.length - 1] === "e" ? selection[1][0] - handleSize / 2 : selection[0][0] - handleSize / 2; })
          .attr("y", function(d) { return d.type[0] === "s" ? selection[1][1] - handleSize / 2 : selection[0][1] - handleSize / 2; })
          .attr("width", function(d) { return d.type === "n" || d.type === "s" ? selection[1][0] - selection[0][0] + handleSize : handleSize; })
          .attr("height", function(d) { return d.type === "e" || d.type === "w" ? selection[1][1] - selection[0][1] + handleSize : handleSize; });
    }

    else {
      group.selectAll(".selection,.handle")
          .style("display", "none")
          .attr("x", null)
          .attr("y", null)
          .attr("width", null)
          .attr("height", null);
    }
  }

  function emitter(that, args, clean) {
    var emit = that.__brush.emitter;
    return emit && (!clean || !emit.clean) ? emit : new Emitter(that, args, clean);
  }

  function Emitter(that, args, clean) {
    this.that = that;
    this.args = args;
    this.state = that.__brush;
    this.active = 0;
    this.clean = clean;
  }

  Emitter.prototype = {
    beforestart: function() {
      if (++this.active === 1) this.state.emitter = this, this.starting = true;
      return this;
    },
    start: function(event, mode) {
      if (this.starting) this.starting = false, this.emit("start", event, mode);
      else this.emit("brush", event);
      return this;
    },
    brush: function(event, mode) {
      this.emit("brush", event, mode);
      return this;
    },
    end: function(event, mode) {
      if (--this.active === 0) delete this.state.emitter, this.emit("end", event, mode);
      return this;
    },
    emit: function(type, event, mode) {
      var d = select(this.that).datum();
      listeners.call(
        type,
        this.that,
        new BrushEvent(type, {
          sourceEvent: event,
          target: brush,
          selection: dim.output(this.state.selection),
          mode,
          dispatch: listeners
        }),
        d
      );
    }
  };

  function started(event) {
    if (touchending && !event.touches) return;
    if (!filter.apply(this, arguments)) return;

    var that = this,
        type = event.target.__data__.type,
        mode = (keys && event.metaKey ? type = "overlay" : type) === "selection" ? MODE_DRAG : (keys && event.altKey ? MODE_CENTER : MODE_HANDLE),
        signX = dim === Y ? null : signsX[type],
        signY = dim === X ? null : signsY[type],
        state = local(that),
        extent = state.extent,
        selection = state.selection,
        W = extent[0][0], w0, w1,
        N = extent[0][1], n0, n1,
        E = extent[1][0], e0, e1,
        S = extent[1][1], s0, s1,
        dx = 0,
        dy = 0,
        moving,
        shifting = signX && signY && keys && event.shiftKey,
        lockX,
        lockY,
        points = Array.from(event.touches || [event], t => {
          const i = t.identifier;
          t = pointer(t, that);
          t.point0 = t.slice();
          t.identifier = i;
          return t;
        });

    interrupt(that);
    var emit = emitter(that, arguments, true).beforestart();

    if (type === "overlay") {
      if (selection) moving = true;
      const pts = [points[0], points[1] || points[0]];
      state.selection = selection = [[
          w0 = dim === Y ? W : min$1(pts[0][0], pts[1][0]),
          n0 = dim === X ? N : min$1(pts[0][1], pts[1][1])
        ], [
          e0 = dim === Y ? E : max$2(pts[0][0], pts[1][0]),
          s0 = dim === X ? S : max$2(pts[0][1], pts[1][1])
        ]];
      if (points.length > 1) move(event);
    } else {
      w0 = selection[0][0];
      n0 = selection[0][1];
      e0 = selection[1][0];
      s0 = selection[1][1];
    }

    w1 = w0;
    n1 = n0;
    e1 = e0;
    s1 = s0;

    var group = select(that)
        .attr("pointer-events", "none");

    var overlay = group.selectAll(".overlay")
        .attr("cursor", cursors[type]);

    if (event.touches) {
      emit.moved = moved;
      emit.ended = ended;
    } else {
      var view = select(event.view)
          .on("mousemove.brush", moved, true)
          .on("mouseup.brush", ended, true);
      if (keys) view
          .on("keydown.brush", keydowned, true)
          .on("keyup.brush", keyupped, true);

      dragDisable(event.view);
    }

    redraw.call(that);
    emit.start(event, mode.name);

    function moved(event) {
      for (const p of event.changedTouches || [event]) {
        for (const d of points)
          if (d.identifier === p.identifier) d.cur = pointer(p, that);
      }
      if (shifting && !lockX && !lockY && points.length === 1) {
        const point = points[0];
        if (abs$3(point.cur[0] - point[0]) > abs$3(point.cur[1] - point[1]))
          lockY = true;
        else
          lockX = true;
      }
      for (const point of points)
        if (point.cur) point[0] = point.cur[0], point[1] = point.cur[1];
      moving = true;
      noevent$1(event);
      move(event);
    }

    function move(event) {
      const point = points[0], point0 = point.point0;
      var t;

      dx = point[0] - point0[0];
      dy = point[1] - point0[1];

      switch (mode) {
        case MODE_SPACE:
        case MODE_DRAG: {
          if (signX) dx = max$2(W - w0, min$1(E - e0, dx)), w1 = w0 + dx, e1 = e0 + dx;
          if (signY) dy = max$2(N - n0, min$1(S - s0, dy)), n1 = n0 + dy, s1 = s0 + dy;
          break;
        }
        case MODE_HANDLE: {
          if (points[1]) {
            if (signX) w1 = max$2(W, min$1(E, points[0][0])), e1 = max$2(W, min$1(E, points[1][0])), signX = 1;
            if (signY) n1 = max$2(N, min$1(S, points[0][1])), s1 = max$2(N, min$1(S, points[1][1])), signY = 1;
          } else {
            if (signX < 0) dx = max$2(W - w0, min$1(E - w0, dx)), w1 = w0 + dx, e1 = e0;
            else if (signX > 0) dx = max$2(W - e0, min$1(E - e0, dx)), w1 = w0, e1 = e0 + dx;
            if (signY < 0) dy = max$2(N - n0, min$1(S - n0, dy)), n1 = n0 + dy, s1 = s0;
            else if (signY > 0) dy = max$2(N - s0, min$1(S - s0, dy)), n1 = n0, s1 = s0 + dy;
          }
          break;
        }
        case MODE_CENTER: {
          if (signX) w1 = max$2(W, min$1(E, w0 - dx * signX)), e1 = max$2(W, min$1(E, e0 + dx * signX));
          if (signY) n1 = max$2(N, min$1(S, n0 - dy * signY)), s1 = max$2(N, min$1(S, s0 + dy * signY));
          break;
        }
      }

      if (e1 < w1) {
        signX *= -1;
        t = w0, w0 = e0, e0 = t;
        t = w1, w1 = e1, e1 = t;
        if (type in flipX) overlay.attr("cursor", cursors[type = flipX[type]]);
      }

      if (s1 < n1) {
        signY *= -1;
        t = n0, n0 = s0, s0 = t;
        t = n1, n1 = s1, s1 = t;
        if (type in flipY) overlay.attr("cursor", cursors[type = flipY[type]]);
      }

      if (state.selection) selection = state.selection; // May be set by brush.move!
      if (lockX) w1 = selection[0][0], e1 = selection[1][0];
      if (lockY) n1 = selection[0][1], s1 = selection[1][1];

      if (selection[0][0] !== w1
          || selection[0][1] !== n1
          || selection[1][0] !== e1
          || selection[1][1] !== s1) {
        state.selection = [[w1, n1], [e1, s1]];
        redraw.call(that);
        emit.brush(event, mode.name);
      }
    }

    function ended(event) {
      nopropagation$1(event);
      if (event.touches) {
        if (event.touches.length) return;
        if (touchending) clearTimeout(touchending);
        touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!
      } else {
        yesdrag(event.view, moving);
        view.on("keydown.brush keyup.brush mousemove.brush mouseup.brush", null);
      }
      group.attr("pointer-events", "all");
      overlay.attr("cursor", cursors.overlay);
      if (state.selection) selection = state.selection; // May be set by brush.move (on start)!
      if (empty(selection)) state.selection = null, redraw.call(that);
      emit.end(event, mode.name);
    }

    function keydowned(event) {
      switch (event.keyCode) {
        case 16: { // SHIFT
          shifting = signX && signY;
          break;
        }
        case 18: { // ALT
          if (mode === MODE_HANDLE) {
            if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;
            if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;
            mode = MODE_CENTER;
            move(event);
          }
          break;
        }
        case 32: { // SPACE; takes priority over ALT
          if (mode === MODE_HANDLE || mode === MODE_CENTER) {
            if (signX < 0) e0 = e1 - dx; else if (signX > 0) w0 = w1 - dx;
            if (signY < 0) s0 = s1 - dy; else if (signY > 0) n0 = n1 - dy;
            mode = MODE_SPACE;
            overlay.attr("cursor", cursors.selection);
            move(event);
          }
          break;
        }
        default: return;
      }
      noevent$1(event);
    }

    function keyupped(event) {
      switch (event.keyCode) {
        case 16: { // SHIFT
          if (shifting) {
            lockX = lockY = shifting = false;
            move(event);
          }
          break;
        }
        case 18: { // ALT
          if (mode === MODE_CENTER) {
            if (signX < 0) e0 = e1; else if (signX > 0) w0 = w1;
            if (signY < 0) s0 = s1; else if (signY > 0) n0 = n1;
            mode = MODE_HANDLE;
            move(event);
          }
          break;
        }
        case 32: { // SPACE
          if (mode === MODE_SPACE) {
            if (event.altKey) {
              if (signX) e0 = e1 - dx * signX, w0 = w1 + dx * signX;
              if (signY) s0 = s1 - dy * signY, n0 = n1 + dy * signY;
              mode = MODE_CENTER;
            } else {
              if (signX < 0) e0 = e1; else if (signX > 0) w0 = w1;
              if (signY < 0) s0 = s1; else if (signY > 0) n0 = n1;
              mode = MODE_HANDLE;
            }
            overlay.attr("cursor", cursors[type]);
            move(event);
          }
          break;
        }
        default: return;
      }
      noevent$1(event);
    }
  }

  function touchmoved(event) {
    emitter(this, arguments).moved(event);
  }

  function touchended(event) {
    emitter(this, arguments).ended(event);
  }

  function initialize() {
    var state = this.__brush || {selection: null};
    state.extent = number2(extent.apply(this, arguments));
    state.dim = dim;
    return state;
  }

  brush.extent = function(_) {
    return arguments.length ? (extent = typeof _ === "function" ? _ : constant$7(number2(_)), brush) : extent;
  };

  brush.filter = function(_) {
    return arguments.length ? (filter = typeof _ === "function" ? _ : constant$7(!!_), brush) : filter;
  };

  brush.touchable = function(_) {
    return arguments.length ? (touchable = typeof _ === "function" ? _ : constant$7(!!_), brush) : touchable;
  };

  brush.handleSize = function(_) {
    return arguments.length ? (handleSize = +_, brush) : handleSize;
  };

  brush.keyModifiers = function(_) {
    return arguments.length ? (keys = !!_, brush) : keys;
  };

  brush.on = function() {
    var value = listeners.on.apply(listeners, arguments);
    return value === listeners ? brush : value;
  };

  return brush;
}

var abs$2 = Math.abs;
var cos$2 = Math.cos;
var sin$2 = Math.sin;
var pi$3 = Math.PI;
var halfPi$2 = pi$3 / 2;
var tau$4 = pi$3 * 2;
var max$1 = Math.max;
var epsilon$5 = 1e-12;

function range$1(i, j) {
  return Array.from({length: j - i}, (_, k) => i + k);
}

function compareValue(compare) {
  return function(a, b) {
    return compare(
      a.source.value + a.target.value,
      b.source.value + b.target.value
    );
  };
}

function chord() {
  return chord$1(false, false);
}

function chordTranspose() {
  return chord$1(false, true);
}

function chordDirected() {
  return chord$1(true, false);
}

function chord$1(directed, transpose) {
  var padAngle = 0,
      sortGroups = null,
      sortSubgroups = null,
      sortChords = null;

  function chord(matrix) {
    var n = matrix.length,
        groupSums = new Array(n),
        groupIndex = range$1(0, n),
        chords = new Array(n * n),
        groups = new Array(n),
        k = 0, dx;

    matrix = Float64Array.from({length: n * n}, transpose
        ? (_, i) => matrix[i % n][i / n | 0]
        : (_, i) => matrix[i / n | 0][i % n]);

    // Compute the scaling factor from value to angle in [0, 2pi].
    for (let i = 0; i < n; ++i) {
      let x = 0;
      for (let j = 0; j < n; ++j) x += matrix[i * n + j] + directed * matrix[j * n + i];
      k += groupSums[i] = x;
    }
    k = max$1(0, tau$4 - padAngle * n) / k;
    dx = k ? padAngle : tau$4 / n;

    // Compute the angles for each group and constituent chord.
    {
      let x = 0;
      if (sortGroups) groupIndex.sort((a, b) => sortGroups(groupSums[a], groupSums[b]));
      for (const i of groupIndex) {
        const x0 = x;
        if (directed) {
          const subgroupIndex = range$1(~n + 1, n).filter(j => j < 0 ? matrix[~j * n + i] : matrix[i * n + j]);
          if (sortSubgroups) subgroupIndex.sort((a, b) => sortSubgroups(a < 0 ? -matrix[~a * n + i] : matrix[i * n + a], b < 0 ? -matrix[~b * n + i] : matrix[i * n + b]));
          for (const j of subgroupIndex) {
            if (j < 0) {
              const chord = chords[~j * n + i] || (chords[~j * n + i] = {source: null, target: null});
              chord.target = {index: i, startAngle: x, endAngle: x += matrix[~j * n + i] * k, value: matrix[~j * n + i]};
            } else {
              const chord = chords[i * n + j] || (chords[i * n + j] = {source: null, target: null});
              chord.source = {index: i, startAngle: x, endAngle: x += matrix[i * n + j] * k, value: matrix[i * n + j]};
            }
          }
          groups[i] = {index: i, startAngle: x0, endAngle: x, value: groupSums[i]};
        } else {
          const subgroupIndex = range$1(0, n).filter(j => matrix[i * n + j] || matrix[j * n + i]);
          if (sortSubgroups) subgroupIndex.sort((a, b) => sortSubgroups(matrix[i * n + a], matrix[i * n + b]));
          for (const j of subgroupIndex) {
            let chord;
            if (i < j) {
              chord = chords[i * n + j] || (chords[i * n + j] = {source: null, target: null});
              chord.source = {index: i, startAngle: x, endAngle: x += matrix[i * n + j] * k, value: matrix[i * n + j]};
            } else {
              chord = chords[j * n + i] || (chords[j * n + i] = {source: null, target: null});
              chord.target = {index: i, startAngle: x, endAngle: x += matrix[i * n + j] * k, value: matrix[i * n + j]};
              if (i === j) chord.source = chord.target;
            }
            if (chord.source && chord.target && chord.source.value < chord.target.value) {
              const source = chord.source;
              chord.source = chord.target;
              chord.target = source;
            }
          }
          groups[i] = {index: i, startAngle: x0, endAngle: x, value: groupSums[i]};
        }
        x += dx;
      }
    }

    // Remove empty chords.
    chords = Object.values(chords);
    chords.groups = groups;
    return sortChords ? chords.sort(sortChords) : chords;
  }

  chord.padAngle = function(_) {
    return arguments.length ? (padAngle = max$1(0, _), chord) : padAngle;
  };

  chord.sortGroups = function(_) {
    return arguments.length ? (sortGroups = _, chord) : sortGroups;
  };

  chord.sortSubgroups = function(_) {
    return arguments.length ? (sortSubgroups = _, chord) : sortSubgroups;
  };

  chord.sortChords = function(_) {
    return arguments.length ? (_ == null ? sortChords = null : (sortChords = compareValue(_))._ = _, chord) : sortChords && sortChords._;
  };

  return chord;
}

const pi$2 = Math.PI,
    tau$3 = 2 * pi$2,
    epsilon$4 = 1e-6,
    tauEpsilon = tau$3 - epsilon$4;

function append$1(strings) {
  this._ += strings[0];
  for (let i = 1, n = strings.length; i < n; ++i) {
    this._ += arguments[i] + strings[i];
  }
}

function appendRound$1(digits) {
  let d = Math.floor(digits);
  if (!(d >= 0)) throw new Error(`invalid digits: ${digits}`);
  if (d > 15) return append$1;
  const k = 10 ** d;
  return function(strings) {
    this._ += strings[0];
    for (let i = 1, n = strings.length; i < n; ++i) {
      this._ += Math.round(arguments[i] * k) / k + strings[i];
    }
  };
}

let Path$1 = class Path {
  constructor(digits) {
    this._x0 = this._y0 = // start of current subpath
    this._x1 = this._y1 = null; // end of current subpath
    this._ = "";
    this._append = digits == null ? append$1 : appendRound$1(digits);
  }
  moveTo(x, y) {
    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}`;
  }
  closePath() {
    if (this._x1 !== null) {
      this._x1 = this._x0, this._y1 = this._y0;
      this._append`Z`;
    }
  }
  lineTo(x, y) {
    this._append`L${this._x1 = +x},${this._y1 = +y}`;
  }
  quadraticCurveTo(x1, y1, x, y) {
    this._append`Q${+x1},${+y1},${this._x1 = +x},${this._y1 = +y}`;
  }
  bezierCurveTo(x1, y1, x2, y2, x, y) {
    this._append`C${+x1},${+y1},${+x2},${+y2},${this._x1 = +x},${this._y1 = +y}`;
  }
  arcTo(x1, y1, x2, y2, r) {
    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;

    // Is the radius negative? Error.
    if (r < 0) throw new Error(`negative radius: ${r}`);

    let x0 = this._x1,
        y0 = this._y1,
        x21 = x2 - x1,
        y21 = y2 - y1,
        x01 = x0 - x1,
        y01 = y0 - y1,
        l01_2 = x01 * x01 + y01 * y01;

    // Is this path empty? Move to (x1,y1).
    if (this._x1 === null) {
      this._append`M${this._x1 = x1},${this._y1 = y1}`;
    }

    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.
    else if (!(l01_2 > epsilon$4));

    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?
    // Equivalently, is (x1,y1) coincident with (x2,y2)?
    // Or, is the radius zero? Line to (x1,y1).
    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon$4) || !r) {
      this._append`L${this._x1 = x1},${this._y1 = y1}`;
    }

    // Otherwise, draw an arc!
    else {
      let x20 = x2 - x0,
          y20 = y2 - y0,
          l21_2 = x21 * x21 + y21 * y21,
          l20_2 = x20 * x20 + y20 * y20,
          l21 = Math.sqrt(l21_2),
          l01 = Math.sqrt(l01_2),
          l = r * Math.tan((pi$2 - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),
          t01 = l / l01,
          t21 = l / l21;

      // If the start tangent is not coincident with (x0,y0), line to.
      if (Math.abs(t01 - 1) > epsilon$4) {
        this._append`L${x1 + t01 * x01},${y1 + t01 * y01}`;
      }

      this._append`A${r},${r},0,0,${+(y01 * x20 > x01 * y20)},${this._x1 = x1 + t21 * x21},${this._y1 = y1 + t21 * y21}`;
    }
  }
  arc(x, y, r, a0, a1, ccw) {
    x = +x, y = +y, r = +r, ccw = !!ccw;

    // Is the radius negative? Error.
    if (r < 0) throw new Error(`negative radius: ${r}`);

    let dx = r * Math.cos(a0),
        dy = r * Math.sin(a0),
        x0 = x + dx,
        y0 = y + dy,
        cw = 1 ^ ccw,
        da = ccw ? a0 - a1 : a1 - a0;

    // Is this path empty? Move to (x0,y0).
    if (this._x1 === null) {
      this._append`M${x0},${y0}`;
    }

    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).
    else if (Math.abs(this._x1 - x0) > epsilon$4 || Math.abs(this._y1 - y0) > epsilon$4) {
      this._append`L${x0},${y0}`;
    }

    // Is this arc empty? We’re done.
    if (!r) return;

    // Does the angle go the wrong way? Flip the direction.
    if (da < 0) da = da % tau$3 + tau$3;

    // Is this a complete circle? Draw two arcs to complete the circle.
    if (da > tauEpsilon) {
      this._append`A${r},${r},0,1,${cw},${x - dx},${y - dy}A${r},${r},0,1,${cw},${this._x1 = x0},${this._y1 = y0}`;
    }

    // Is this arc non-empty? Draw an arc!
    else if (da > epsilon$4) {
      this._append`A${r},${r},0,${+(da >= pi$2)},${cw},${this._x1 = x + r * Math.cos(a1)},${this._y1 = y + r * Math.sin(a1)}`;
    }
  }
  rect(x, y, w, h) {
    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}h${w = +w}v${+h}h${-w}Z`;
  }
  toString() {
    return this._;
  }
};

function path() {
  return new Path$1;
}

// Allow instanceof d3.path
path.prototype = Path$1.prototype;

function pathRound(digits = 3) {
  return new Path$1(+digits);
}

var slice$2 = Array.prototype.slice;

function constant$6(x) {
  return function() {
    return x;
  };
}

function defaultSource$1(d) {
  return d.source;
}

function defaultTarget(d) {
  return d.target;
}

function defaultRadius$1(d) {
  return d.radius;
}

function defaultStartAngle(d) {
  return d.startAngle;
}

function defaultEndAngle(d) {
  return d.endAngle;
}

function defaultPadAngle() {
  return 0;
}

function defaultArrowheadRadius() {
  return 10;
}

function ribbon(headRadius) {
  var source = defaultSource$1,
      target = defaultTarget,
      sourceRadius = defaultRadius$1,
      targetRadius = defaultRadius$1,
      startAngle = defaultStartAngle,
      endAngle = defaultEndAngle,
      padAngle = defaultPadAngle,
      context = null;

  function ribbon() {
    var buffer,
        s = source.apply(this, arguments),
        t = target.apply(this, arguments),
        ap = padAngle.apply(this, arguments) / 2,
        argv = slice$2.call(arguments),
        sr = +sourceRadius.apply(this, (argv[0] = s, argv)),
        sa0 = startAngle.apply(this, argv) - halfPi$2,
        sa1 = endAngle.apply(this, argv) - halfPi$2,
        tr = +targetRadius.apply(this, (argv[0] = t, argv)),
        ta0 = startAngle.apply(this, argv) - halfPi$2,
        ta1 = endAngle.apply(this, argv) - halfPi$2;

    if (!context) context = buffer = path();

    if (ap > epsilon$5) {
      if (abs$2(sa1 - sa0) > ap * 2 + epsilon$5) sa1 > sa0 ? (sa0 += ap, sa1 -= ap) : (sa0 -= ap, sa1 += ap);
      else sa0 = sa1 = (sa0 + sa1) / 2;
      if (abs$2(ta1 - ta0) > ap * 2 + epsilon$5) ta1 > ta0 ? (ta0 += ap, ta1 -= ap) : (ta0 -= ap, ta1 += ap);
      else ta0 = ta1 = (ta0 + ta1) / 2;
    }

    context.moveTo(sr * cos$2(sa0), sr * sin$2(sa0));
    context.arc(0, 0, sr, sa0, sa1);
    if (sa0 !== ta0 || sa1 !== ta1) {
      if (headRadius) {
        var hr = +headRadius.apply(this, arguments), tr2 = tr - hr, ta2 = (ta0 + ta1) / 2;
        context.quadraticCurveTo(0, 0, tr2 * cos$2(ta0), tr2 * sin$2(ta0));
        context.lineTo(tr * cos$2(ta2), tr * sin$2(ta2));
        context.lineTo(tr2 * cos$2(ta1), tr2 * sin$2(ta1));
      } else {
        context.quadraticCurveTo(0, 0, tr * cos$2(ta0), tr * sin$2(ta0));
        context.arc(0, 0, tr, ta0, ta1);
      }
    }
    context.quadraticCurveTo(0, 0, sr * cos$2(sa0), sr * sin$2(sa0));
    context.closePath();

    if (buffer) return context = null, buffer + "" || null;
  }

  if (headRadius) ribbon.headRadius = function(_) {
    return arguments.length ? (headRadius = typeof _ === "function" ? _ : constant$6(+_), ribbon) : headRadius;
  };

  ribbon.radius = function(_) {
    return arguments.length ? (sourceRadius = targetRadius = typeof _ === "function" ? _ : constant$6(+_), ribbon) : sourceRadius;
  };

  ribbon.sourceRadius = function(_) {
    return arguments.length ? (sourceRadius = typeof _ === "function" ? _ : constant$6(+_), ribbon) : sourceRadius;
  };

  ribbon.targetRadius = function(_) {
    return arguments.length ? (targetRadius = typeof _ === "function" ? _ : constant$6(+_), ribbon) : targetRadius;
  };

  ribbon.startAngle = function(_) {
    return arguments.length ? (startAngle = typeof _ === "function" ? _ : constant$6(+_), ribbon) : startAngle;
  };

  ribbon.endAngle = function(_) {
    return arguments.length ? (endAngle = typeof _ === "function" ? _ : constant$6(+_), ribbon) : endAngle;
  };

  ribbon.padAngle = function(_) {
    return arguments.length ? (padAngle = typeof _ === "function" ? _ : constant$6(+_), ribbon) : padAngle;
  };

  ribbon.source = function(_) {
    return arguments.length ? (source = _, ribbon) : source;
  };

  ribbon.target = function(_) {
    return arguments.length ? (target = _, ribbon) : target;
  };

  ribbon.context = function(_) {
    return arguments.length ? ((context = _ == null ? null : _), ribbon) : context;
  };

  return ribbon;
}

function ribbon$1() {
  return ribbon();
}

function ribbonArrow() {
  return ribbon(defaultArrowheadRadius);
}

var array$2 = Array.prototype;

var slice$1 = array$2.slice;

function ascending$1(a, b) {
  return a - b;
}

function area$3(ring) {
  var i = 0, n = ring.length, area = ring[n - 1][1] * ring[0][0] - ring[n - 1][0] * ring[0][1];
  while (++i < n) area += ring[i - 1][1] * ring[i][0] - ring[i - 1][0] * ring[i][1];
  return area;
}

var constant$5 = x => () => x;

function contains$2(ring, hole) {
  var i = -1, n = hole.length, c;
  while (++i < n) if (c = ringContains(ring, hole[i])) return c;
  return 0;
}

function ringContains(ring, point) {
  var x = point[0], y = point[1], contains = -1;
  for (var i = 0, n = ring.length, j = n - 1; i < n; j = i++) {
    var pi = ring[i], xi = pi[0], yi = pi[1], pj = ring[j], xj = pj[0], yj = pj[1];
    if (segmentContains(pi, pj, point)) return 0;
    if (((yi > y) !== (yj > y)) && ((x < (xj - xi) * (y - yi) / (yj - yi) + xi))) contains = -contains;
  }
  return contains;
}

function segmentContains(a, b, c) {
  var i; return collinear$1(a, b, c) && within(a[i = +(a[0] === b[0])], c[i], b[i]);
}

function collinear$1(a, b, c) {
  return (b[0] - a[0]) * (c[1] - a[1]) === (c[0] - a[0]) * (b[1] - a[1]);
}

function within(p, q, r) {
  return p <= q && q <= r || r <= q && q <= p;
}

function noop$2() {}

var cases = [
  [],
  [[[1.0, 1.5], [0.5, 1.0]]],
  [[[1.5, 1.0], [1.0, 1.5]]],
  [[[1.5, 1.0], [0.5, 1.0]]],
  [[[1.0, 0.5], [1.5, 1.0]]],
  [[[1.0, 1.5], [0.5, 1.0]], [[1.0, 0.5], [1.5, 1.0]]],
  [[[1.0, 0.5], [1.0, 1.5]]],
  [[[1.0, 0.5], [0.5, 1.0]]],
  [[[0.5, 1.0], [1.0, 0.5]]],
  [[[1.0, 1.5], [1.0, 0.5]]],
  [[[0.5, 1.0], [1.0, 0.5]], [[1.5, 1.0], [1.0, 1.5]]],
  [[[1.5, 1.0], [1.0, 0.5]]],
  [[[0.5, 1.0], [1.5, 1.0]]],
  [[[1.0, 1.5], [1.5, 1.0]]],
  [[[0.5, 1.0], [1.0, 1.5]]],
  []
];

function Contours() {
  var dx = 1,
      dy = 1,
      threshold = thresholdSturges,
      smooth = smoothLinear;

  function contours(values) {
    var tz = threshold(values);

    // Convert number of thresholds into uniform thresholds.
    if (!Array.isArray(tz)) {
      const e = extent$1(values, finite);
      tz = ticks(...nice$1(e[0], e[1], tz), tz);
      while (tz[tz.length - 1] >= e[1]) tz.pop();
      while (tz[1] < e[0]) tz.shift();
    } else {
      tz = tz.slice().sort(ascending$1);
    }

    return tz.map(value => contour(values, value));
  }

  // Accumulate, smooth contour rings, assign holes to exterior rings.
  // Based on https://github.com/mbostock/shapefile/blob/v0.6.2/shp/polygon.js
  function contour(values, value) {
    const v = value == null ? NaN : +value;
    if (isNaN(v)) throw new Error(`invalid value: ${value}`);

    var polygons = [],
        holes = [];

    isorings(values, v, function(ring) {
      smooth(ring, values, v);
      if (area$3(ring) > 0) polygons.push([ring]);
      else holes.push(ring);
    });

    holes.forEach(function(hole) {
      for (var i = 0, n = polygons.length, polygon; i < n; ++i) {
        if (contains$2((polygon = polygons[i])[0], hole) !== -1) {
          polygon.push(hole);
          return;
        }
      }
    });

    return {
      type: "MultiPolygon",
      value: value,
      coordinates: polygons
    };
  }

  // Marching squares with isolines stitched into rings.
  // Based on https://github.com/topojson/topojson-client/blob/v3.0.0/src/stitch.js
  function isorings(values, value, callback) {
    var fragmentByStart = new Array,
        fragmentByEnd = new Array,
        x, y, t0, t1, t2, t3;

    // Special case for the first row (y = -1, t2 = t3 = 0).
    x = y = -1;
    t1 = above(values[0], value);
    cases[t1 << 1].forEach(stitch);
    while (++x < dx - 1) {
      t0 = t1, t1 = above(values[x + 1], value);
      cases[t0 | t1 << 1].forEach(stitch);
    }
    cases[t1 << 0].forEach(stitch);

    // General case for the intermediate rows.
    while (++y < dy - 1) {
      x = -1;
      t1 = above(values[y * dx + dx], value);
      t2 = above(values[y * dx], value);
      cases[t1 << 1 | t2 << 2].forEach(stitch);
      while (++x < dx - 1) {
        t0 = t1, t1 = above(values[y * dx + dx + x + 1], value);
        t3 = t2, t2 = above(values[y * dx + x + 1], value);
        cases[t0 | t1 << 1 | t2 << 2 | t3 << 3].forEach(stitch);
      }
      cases[t1 | t2 << 3].forEach(stitch);
    }

    // Special case for the last row (y = dy - 1, t0 = t1 = 0).
    x = -1;
    t2 = values[y * dx] >= value;
    cases[t2 << 2].forEach(stitch);
    while (++x < dx - 1) {
      t3 = t2, t2 = above(values[y * dx + x + 1], value);
      cases[t2 << 2 | t3 << 3].forEach(stitch);
    }
    cases[t2 << 3].forEach(stitch);

    function stitch(line) {
      var start = [line[0][0] + x, line[0][1] + y],
          end = [line[1][0] + x, line[1][1] + y],
          startIndex = index(start),
          endIndex = index(end),
          f, g;
      if (f = fragmentByEnd[startIndex]) {
        if (g = fragmentByStart[endIndex]) {
          delete fragmentByEnd[f.end];
          delete fragmentByStart[g.start];
          if (f === g) {
            f.ring.push(end);
            callback(f.ring);
          } else {
            fragmentByStart[f.start] = fragmentByEnd[g.end] = {start: f.start, end: g.end, ring: f.ring.concat(g.ring)};
          }
        } else {
          delete fragmentByEnd[f.end];
          f.ring.push(end);
          fragmentByEnd[f.end = endIndex] = f;
        }
      } else if (f = fragmentByStart[endIndex]) {
        if (g = fragmentByEnd[startIndex]) {
          delete fragmentByStart[f.start];
          delete fragmentByEnd[g.end];
          if (f === g) {
            f.ring.push(end);
            callback(f.ring);
          } else {
            fragmentByStart[g.start] = fragmentByEnd[f.end] = {start: g.start, end: f.end, ring: g.ring.concat(f.ring)};
          }
        } else {
          delete fragmentByStart[f.start];
          f.ring.unshift(start);
          fragmentByStart[f.start = startIndex] = f;
        }
      } else {
        fragmentByStart[startIndex] = fragmentByEnd[endIndex] = {start: startIndex, end: endIndex, ring: [start, end]};
      }
    }
  }

  function index(point) {
    return point[0] * 2 + point[1] * (dx + 1) * 4;
  }

  function smoothLinear(ring, values, value) {
    ring.forEach(function(point) {
      var x = point[0],
          y = point[1],
          xt = x | 0,
          yt = y | 0,
          v1 = valid(values[yt * dx + xt]);
      if (x > 0 && x < dx && xt === x) {
        point[0] = smooth1(x, valid(values[yt * dx + xt - 1]), v1, value);
      }
      if (y > 0 && y < dy && yt === y) {
        point[1] = smooth1(y, valid(values[(yt - 1) * dx + xt]), v1, value);
      }
    });
  }

  contours.contour = contour;

  contours.size = function(_) {
    if (!arguments.length) return [dx, dy];
    var _0 = Math.floor(_[0]), _1 = Math.floor(_[1]);
    if (!(_0 >= 0 && _1 >= 0)) throw new Error("invalid size");
    return dx = _0, dy = _1, contours;
  };

  contours.thresholds = function(_) {
    return arguments.length ? (threshold = typeof _ === "function" ? _ : Array.isArray(_) ? constant$5(slice$1.call(_)) : constant$5(_), contours) : threshold;
  };

  contours.smooth = function(_) {
    return arguments.length ? (smooth = _ ? smoothLinear : noop$2, contours) : smooth === smoothLinear;
  };

  return contours;
}

// When computing the extent, ignore infinite values (as well as invalid ones).
function finite(x) {
  return isFinite(x) ? x : NaN;
}

// Is the (possibly invalid) x greater than or equal to the (known valid) value?
// Treat any invalid value as below negative infinity.
function above(x, value) {
  return x == null ? false : +x >= value;
}

// During smoothing, treat any invalid value as negative infinity.
function valid(v) {
  return v == null || isNaN(v = +v) ? -Infinity : v;
}

function smooth1(x, v0, v1, value) {
  const a = value - v0;
  const b = v1 - v0;
  const d = isFinite(a) || isFinite(b) ? a / b : Math.sign(a) / Math.sign(b);
  return isNaN(d) ? x : x + d - 0.5;
}

function defaultX$1(d) {
  return d[0];
}

function defaultY$1(d) {
  return d[1];
}

function defaultWeight() {
  return 1;
}

function density() {
  var x = defaultX$1,
      y = defaultY$1,
      weight = defaultWeight,
      dx = 960,
      dy = 500,
      r = 20, // blur radius
      k = 2, // log2(grid cell size)
      o = r * 3, // grid offset, to pad for blur
      n = (dx + o * 2) >> k, // grid width
      m = (dy + o * 2) >> k, // grid height
      threshold = constant$5(20);

  function grid(data) {
    var values = new Float32Array(n * m),
        pow2k = Math.pow(2, -k),
        i = -1;

    for (const d of data) {
      var xi = (x(d, ++i, data) + o) * pow2k,
          yi = (y(d, i, data) + o) * pow2k,
          wi = +weight(d, i, data);
      if (wi && xi >= 0 && xi < n && yi >= 0 && yi < m) {
        var x0 = Math.floor(xi),
            y0 = Math.floor(yi),
            xt = xi - x0 - 0.5,
            yt = yi - y0 - 0.5;
        values[x0 + y0 * n] += (1 - xt) * (1 - yt) * wi;
        values[x0 + 1 + y0 * n] += xt * (1 - yt) * wi;
        values[x0 + 1 + (y0 + 1) * n] += xt * yt * wi;
        values[x0 + (y0 + 1) * n] += (1 - xt) * yt * wi;
      }
    }

    blur2({data: values, width: n, height: m}, r * pow2k);
    return values;
  }

  function density(data) {
    var values = grid(data),
        tz = threshold(values),
        pow4k = Math.pow(2, 2 * k);

    // Convert number of thresholds into uniform thresholds.
    if (!Array.isArray(tz)) {
      tz = ticks(Number.MIN_VALUE, max$3(values) / pow4k, tz);
    }

    return Contours()
        .size([n, m])
        .thresholds(tz.map(d => d * pow4k))
      (values)
        .map((c, i) => (c.value = +tz[i], transform(c)));
  }

  density.contours = function(data) {
    var values = grid(data),
        contours = Contours().size([n, m]),
        pow4k = Math.pow(2, 2 * k),
        contour = value => {
          value = +value;
          var c = transform(contours.contour(values, value * pow4k));
          c.value = value; // preserve exact threshold value
          return c;
        };
    Object.defineProperty(contour, "max", {get: () => max$3(values) / pow4k});
    return contour;
  };

  function transform(geometry) {
    geometry.coordinates.forEach(transformPolygon);
    return geometry;
  }

  function transformPolygon(coordinates) {
    coordinates.forEach(transformRing);
  }

  function transformRing(coordinates) {
    coordinates.forEach(transformPoint);
  }

  // TODO Optimize.
  function transformPoint(coordinates) {
    coordinates[0] = coordinates[0] * Math.pow(2, k) - o;
    coordinates[1] = coordinates[1] * Math.pow(2, k) - o;
  }

  function resize() {
    o = r * 3;
    n = (dx + o * 2) >> k;
    m = (dy + o * 2) >> k;
    return density;
  }

  density.x = function(_) {
    return arguments.length ? (x = typeof _ === "function" ? _ : constant$5(+_), density) : x;
  };

  density.y = function(_) {
    return arguments.length ? (y = typeof _ === "function" ? _ : constant$5(+_), density) : y;
  };

  density.weight = function(_) {
    return arguments.length ? (weight = typeof _ === "function" ? _ : constant$5(+_), density) : weight;
  };

  density.size = function(_) {
    if (!arguments.length) return [dx, dy];
    var _0 = +_[0], _1 = +_[1];
    if (!(_0 >= 0 && _1 >= 0)) throw new Error("invalid size");
    return dx = _0, dy = _1, resize();
  };

  density.cellSize = function(_) {
    if (!arguments.length) return 1 << k;
    if (!((_ = +_) >= 1)) throw new Error("invalid cell size");
    return k = Math.floor(Math.log(_) / Math.LN2), resize();
  };

  density.thresholds = function(_) {
    return arguments.length ? (threshold = typeof _ === "function" ? _ : Array.isArray(_) ? constant$5(slice$1.call(_)) : constant$5(_), density) : threshold;
  };

  density.bandwidth = function(_) {
    if (!arguments.length) return Math.sqrt(r * (r + 1));
    if (!((_ = +_) >= 0)) throw new Error("invalid bandwidth");
    return r = (Math.sqrt(4 * _ * _ + 1) - 1) / 2, resize();
  };

  return density;
}

const epsilon$3 = 1.1102230246251565e-16;
const splitter = 134217729;
const resulterrbound = (3 + 8 * epsilon$3) * epsilon$3;

// fast_expansion_sum_zeroelim routine from oritinal code
function sum$1(elen, e, flen, f, h) {
    let Q, Qnew, hh, bvirt;
    let enow = e[0];
    let fnow = f[0];
    let eindex = 0;
    let findex = 0;
    if ((fnow > enow) === (fnow > -enow)) {
        Q = enow;
        enow = e[++eindex];
    } else {
        Q = fnow;
        fnow = f[++findex];
    }
    let hindex = 0;
    if (eindex < elen && findex < flen) {
        if ((fnow > enow) === (fnow > -enow)) {
            Qnew = enow + Q;
            hh = Q - (Qnew - enow);
            enow = e[++eindex];
        } else {
            Qnew = fnow + Q;
            hh = Q - (Qnew - fnow);
            fnow = f[++findex];
        }
        Q = Qnew;
        if (hh !== 0) {
            h[hindex++] = hh;
        }
        while (eindex < elen && findex < flen) {
            if ((fnow > enow) === (fnow > -enow)) {
                Qnew = Q + enow;
                bvirt = Qnew - Q;
                hh = Q - (Qnew - bvirt) + (enow - bvirt);
                enow = e[++eindex];
            } else {
                Qnew = Q + fnow;
                bvirt = Qnew - Q;
                hh = Q - (Qnew - bvirt) + (fnow - bvirt);
                fnow = f[++findex];
            }
            Q = Qnew;
            if (hh !== 0) {
                h[hindex++] = hh;
            }
        }
    }
    while (eindex < elen) {
        Qnew = Q + enow;
        bvirt = Qnew - Q;
        hh = Q - (Qnew - bvirt) + (enow - bvirt);
        enow = e[++eindex];
        Q = Qnew;
        if (hh !== 0) {
            h[hindex++] = hh;
        }
    }
    while (findex < flen) {
        Qnew = Q + fnow;
        bvirt = Qnew - Q;
        hh = Q - (Qnew - bvirt) + (fnow - bvirt);
        fnow = f[++findex];
        Q = Qnew;
        if (hh !== 0) {
            h[hindex++] = hh;
        }
    }
    if (Q !== 0 || hindex === 0) {
        h[hindex++] = Q;
    }
    return hindex;
}

function estimate(elen, e) {
    let Q = e[0];
    for (let i = 1; i < elen; i++) Q += e[i];
    return Q;
}

function vec(n) {
    return new Float64Array(n);
}

const ccwerrboundA = (3 + 16 * epsilon$3) * epsilon$3;
const ccwerrboundB = (2 + 12 * epsilon$3) * epsilon$3;
const ccwerrboundC = (9 + 64 * epsilon$3) * epsilon$3 * epsilon$3;

const B = vec(4);
const C1 = vec(8);
const C2 = vec(12);
const D = vec(16);
const u = vec(4);

function orient2dadapt(ax, ay, bx, by, cx, cy, detsum) {
    let acxtail, acytail, bcxtail, bcytail;
    let bvirt, c, ahi, alo, bhi, blo, _i, _j, _0, s1, s0, t1, t0, u3;

    const acx = ax - cx;
    const bcx = bx - cx;
    const acy = ay - cy;
    const bcy = by - cy;

    s1 = acx * bcy;
    c = splitter * acx;
    ahi = c - (c - acx);
    alo = acx - ahi;
    c = splitter * bcy;
    bhi = c - (c - bcy);
    blo = bcy - bhi;
    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);
    t1 = acy * bcx;
    c = splitter * acy;
    ahi = c - (c - acy);
    alo = acy - ahi;
    c = splitter * bcx;
    bhi = c - (c - bcx);
    blo = bcx - bhi;
    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);
    _i = s0 - t0;
    bvirt = s0 - _i;
    B[0] = s0 - (_i + bvirt) + (bvirt - t0);
    _j = s1 + _i;
    bvirt = _j - s1;
    _0 = s1 - (_j - bvirt) + (_i - bvirt);
    _i = _0 - t1;
    bvirt = _0 - _i;
    B[1] = _0 - (_i + bvirt) + (bvirt - t1);
    u3 = _j + _i;
    bvirt = u3 - _j;
    B[2] = _j - (u3 - bvirt) + (_i - bvirt);
    B[3] = u3;

    let det = estimate(4, B);
    let errbound = ccwerrboundB * detsum;
    if (det >= errbound || -det >= errbound) {
        return det;
    }

    bvirt = ax - acx;
    acxtail = ax - (acx + bvirt) + (bvirt - cx);
    bvirt = bx - bcx;
    bcxtail = bx - (bcx + bvirt) + (bvirt - cx);
    bvirt = ay - acy;
    acytail = ay - (acy + bvirt) + (bvirt - cy);
    bvirt = by - bcy;
    bcytail = by - (bcy + bvirt) + (bvirt - cy);

    if (acxtail === 0 && acytail === 0 && bcxtail === 0 && bcytail === 0) {
        return det;
    }

    errbound = ccwerrboundC * detsum + resulterrbound * Math.abs(det);
    det += (acx * bcytail + bcy * acxtail) - (acy * bcxtail + bcx * acytail);
    if (det >= errbound || -det >= errbound) return det;

    s1 = acxtail * bcy;
    c = splitter * acxtail;
    ahi = c - (c - acxtail);
    alo = acxtail - ahi;
    c = splitter * bcy;
    bhi = c - (c - bcy);
    blo = bcy - bhi;
    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);
    t1 = acytail * bcx;
    c = splitter * acytail;
    ahi = c - (c - acytail);
    alo = acytail - ahi;
    c = splitter * bcx;
    bhi = c - (c - bcx);
    blo = bcx - bhi;
    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);
    _i = s0 - t0;
    bvirt = s0 - _i;
    u[0] = s0 - (_i + bvirt) + (bvirt - t0);
    _j = s1 + _i;
    bvirt = _j - s1;
    _0 = s1 - (_j - bvirt) + (_i - bvirt);
    _i = _0 - t1;
    bvirt = _0 - _i;
    u[1] = _0 - (_i + bvirt) + (bvirt - t1);
    u3 = _j + _i;
    bvirt = u3 - _j;
    u[2] = _j - (u3 - bvirt) + (_i - bvirt);
    u[3] = u3;
    const C1len = sum$1(4, B, 4, u, C1);

    s1 = acx * bcytail;
    c = splitter * acx;
    ahi = c - (c - acx);
    alo = acx - ahi;
    c = splitter * bcytail;
    bhi = c - (c - bcytail);
    blo = bcytail - bhi;
    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);
    t1 = acy * bcxtail;
    c = splitter * acy;
    ahi = c - (c - acy);
    alo = acy - ahi;
    c = splitter * bcxtail;
    bhi = c - (c - bcxtail);
    blo = bcxtail - bhi;
    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);
    _i = s0 - t0;
    bvirt = s0 - _i;
    u[0] = s0 - (_i + bvirt) + (bvirt - t0);
    _j = s1 + _i;
    bvirt = _j - s1;
    _0 = s1 - (_j - bvirt) + (_i - bvirt);
    _i = _0 - t1;
    bvirt = _0 - _i;
    u[1] = _0 - (_i + bvirt) + (bvirt - t1);
    u3 = _j + _i;
    bvirt = u3 - _j;
    u[2] = _j - (u3 - bvirt) + (_i - bvirt);
    u[3] = u3;
    const C2len = sum$1(C1len, C1, 4, u, C2);

    s1 = acxtail * bcytail;
    c = splitter * acxtail;
    ahi = c - (c - acxtail);
    alo = acxtail - ahi;
    c = splitter * bcytail;
    bhi = c - (c - bcytail);
    blo = bcytail - bhi;
    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);
    t1 = acytail * bcxtail;
    c = splitter * acytail;
    ahi = c - (c - acytail);
    alo = acytail - ahi;
    c = splitter * bcxtail;
    bhi = c - (c - bcxtail);
    blo = bcxtail - bhi;
    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);
    _i = s0 - t0;
    bvirt = s0 - _i;
    u[0] = s0 - (_i + bvirt) + (bvirt - t0);
    _j = s1 + _i;
    bvirt = _j - s1;
    _0 = s1 - (_j - bvirt) + (_i - bvirt);
    _i = _0 - t1;
    bvirt = _0 - _i;
    u[1] = _0 - (_i + bvirt) + (bvirt - t1);
    u3 = _j + _i;
    bvirt = u3 - _j;
    u[2] = _j - (u3 - bvirt) + (_i - bvirt);
    u[3] = u3;
    const Dlen = sum$1(C2len, C2, 4, u, D);

    return D[Dlen - 1];
}

function orient2d(ax, ay, bx, by, cx, cy) {
    const detleft = (ay - cy) * (bx - cx);
    const detright = (ax - cx) * (by - cy);
    const det = detleft - detright;

    const detsum = Math.abs(detleft + detright);
    if (Math.abs(det) >= ccwerrboundA * detsum) return det;

    return -orient2dadapt(ax, ay, bx, by, cx, cy, detsum);
}

const EPSILON = Math.pow(2, -52);
const EDGE_STACK = new Uint32Array(512);

class Delaunator {

    static from(points, getX = defaultGetX, getY = defaultGetY) {
        const n = points.length;
        const coords = new Float64Array(n * 2);

        for (let i = 0; i < n; i++) {
            const p = points[i];
            coords[2 * i] = getX(p);
            coords[2 * i + 1] = getY(p);
        }

        return new Delaunator(coords);
    }

    constructor(coords) {
        const n = coords.length >> 1;
        if (n > 0 && typeof coords[0] !== 'number') throw new Error('Expected coords to contain numbers.');

        this.coords = coords;

        // arrays that will store the triangulation graph
        const maxTriangles = Math.max(2 * n - 5, 0);
        this._triangles = new Uint32Array(maxTriangles * 3);
        this._halfedges = new Int32Array(maxTriangles * 3);

        // temporary arrays for tracking the edges of the advancing convex hull
        this._hashSize = Math.ceil(Math.sqrt(n));
        this._hullPrev = new Uint32Array(n); // edge to prev edge
        this._hullNext = new Uint32Array(n); // edge to next edge
        this._hullTri = new Uint32Array(n); // edge to adjacent triangle
        this._hullHash = new Int32Array(this._hashSize); // angular edge hash

        // temporary arrays for sorting points
        this._ids = new Uint32Array(n);
        this._dists = new Float64Array(n);

        this.update();
    }

    update() {
        const {coords, _hullPrev: hullPrev, _hullNext: hullNext, _hullTri: hullTri, _hullHash: hullHash} =  this;
        const n = coords.length >> 1;

        // populate an array of point indices; calculate input data bbox
        let minX = Infinity;
        let minY = Infinity;
        let maxX = -Infinity;
        let maxY = -Infinity;

        for (let i = 0; i < n; i++) {
            const x = coords[2 * i];
            const y = coords[2 * i + 1];
            if (x < minX) minX = x;
            if (y < minY) minY = y;
            if (x > maxX) maxX = x;
            if (y > maxY) maxY = y;
            this._ids[i] = i;
        }
        const cx = (minX + maxX) / 2;
        const cy = (minY + maxY) / 2;

        let i0, i1, i2;

        // pick a seed point close to the center
        for (let i = 0, minDist = Infinity; i < n; i++) {
            const d = dist(cx, cy, coords[2 * i], coords[2 * i + 1]);
            if (d < minDist) {
                i0 = i;
                minDist = d;
            }
        }
        const i0x = coords[2 * i0];
        const i0y = coords[2 * i0 + 1];

        // find the point closest to the seed
        for (let i = 0, minDist = Infinity; i < n; i++) {
            if (i === i0) continue;
            const d = dist(i0x, i0y, coords[2 * i], coords[2 * i + 1]);
            if (d < minDist && d > 0) {
                i1 = i;
                minDist = d;
            }
        }
        let i1x = coords[2 * i1];
        let i1y = coords[2 * i1 + 1];

        let minRadius = Infinity;

        // find the third point which forms the smallest circumcircle with the first two
        for (let i = 0; i < n; i++) {
            if (i === i0 || i === i1) continue;
            const r = circumradius(i0x, i0y, i1x, i1y, coords[2 * i], coords[2 * i + 1]);
            if (r < minRadius) {
                i2 = i;
                minRadius = r;
            }
        }
        let i2x = coords[2 * i2];
        let i2y = coords[2 * i2 + 1];

        if (minRadius === Infinity) {
            // order collinear points by dx (or dy if all x are identical)
            // and return the list as a hull
            for (let i = 0; i < n; i++) {
                this._dists[i] = (coords[2 * i] - coords[0]) || (coords[2 * i + 1] - coords[1]);
            }
            quicksort(this._ids, this._dists, 0, n - 1);
            const hull = new Uint32Array(n);
            let j = 0;
            for (let i = 0, d0 = -Infinity; i < n; i++) {
                const id = this._ids[i];
                const d = this._dists[id];
                if (d > d0) {
                    hull[j++] = id;
                    d0 = d;
                }
            }
            this.hull = hull.subarray(0, j);
            this.triangles = new Uint32Array(0);
            this.halfedges = new Uint32Array(0);
            return;
        }

        // swap the order of the seed points for counter-clockwise orientation
        if (orient2d(i0x, i0y, i1x, i1y, i2x, i2y) < 0) {
            const i = i1;
            const x = i1x;
            const y = i1y;
            i1 = i2;
            i1x = i2x;
            i1y = i2y;
            i2 = i;
            i2x = x;
            i2y = y;
        }

        const center = circumcenter(i0x, i0y, i1x, i1y, i2x, i2y);
        this._cx = center.x;
        this._cy = center.y;

        for (let i = 0; i < n; i++) {
            this._dists[i] = dist(coords[2 * i], coords[2 * i + 1], center.x, center.y);
        }

        // sort the points by distance from the seed triangle circumcenter
        quicksort(this._ids, this._dists, 0, n - 1);

        // set up the seed triangle as the starting hull
        this._hullStart = i0;
        let hullSize = 3;

        hullNext[i0] = hullPrev[i2] = i1;
        hullNext[i1] = hullPrev[i0] = i2;
        hullNext[i2] = hullPrev[i1] = i0;

        hullTri[i0] = 0;
        hullTri[i1] = 1;
        hullTri[i2] = 2;

        hullHash.fill(-1);
        hullHash[this._hashKey(i0x, i0y)] = i0;
        hullHash[this._hashKey(i1x, i1y)] = i1;
        hullHash[this._hashKey(i2x, i2y)] = i2;

        this.trianglesLen = 0;
        this._addTriangle(i0, i1, i2, -1, -1, -1);

        for (let k = 0, xp, yp; k < this._ids.length; k++) {
            const i = this._ids[k];
            const x = coords[2 * i];
            const y = coords[2 * i + 1];

            // skip near-duplicate points
            if (k > 0 && Math.abs(x - xp) <= EPSILON && Math.abs(y - yp) <= EPSILON) continue;
            xp = x;
            yp = y;

            // skip seed triangle points
            if (i === i0 || i === i1 || i === i2) continue;

            // find a visible edge on the convex hull using edge hash
            let start = 0;
            for (let j = 0, key = this._hashKey(x, y); j < this._hashSize; j++) {
                start = hullHash[(key + j) % this._hashSize];
                if (start !== -1 && start !== hullNext[start]) break;
            }

            start = hullPrev[start];
            let e = start, q;
            while (q = hullNext[e], orient2d(x, y, coords[2 * e], coords[2 * e + 1], coords[2 * q], coords[2 * q + 1]) >= 0) {
                e = q;
                if (e === start) {
                    e = -1;
                    break;
                }
            }
            if (e === -1) continue; // likely a near-duplicate point; skip it

            // add the first triangle from the point
            let t = this._addTriangle(e, i, hullNext[e], -1, -1, hullTri[e]);

            // recursively flip triangles from the point until they satisfy the Delaunay condition
            hullTri[i] = this._legalize(t + 2);
            hullTri[e] = t; // keep track of boundary triangles on the hull
            hullSize++;

            // walk forward through the hull, adding more triangles and flipping recursively
            let n = hullNext[e];
            while (q = hullNext[n], orient2d(x, y, coords[2 * n], coords[2 * n + 1], coords[2 * q], coords[2 * q + 1]) < 0) {
                t = this._addTriangle(n, i, q, hullTri[i], -1, hullTri[n]);
                hullTri[i] = this._legalize(t + 2);
                hullNext[n] = n; // mark as removed
                hullSize--;
                n = q;
            }

            // walk backward from the other side, adding more triangles and flipping
            if (e === start) {
                while (q = hullPrev[e], orient2d(x, y, coords[2 * q], coords[2 * q + 1], coords[2 * e], coords[2 * e + 1]) < 0) {
                    t = this._addTriangle(q, i, e, -1, hullTri[e], hullTri[q]);
                    this._legalize(t + 2);
                    hullTri[q] = t;
                    hullNext[e] = e; // mark as removed
                    hullSize--;
                    e = q;
                }
            }

            // update the hull indices
            this._hullStart = hullPrev[i] = e;
            hullNext[e] = hullPrev[n] = i;
            hullNext[i] = n;

            // save the two new edges in the hash table
            hullHash[this._hashKey(x, y)] = i;
            hullHash[this._hashKey(coords[2 * e], coords[2 * e + 1])] = e;
        }

        this.hull = new Uint32Array(hullSize);
        for (let i = 0, e = this._hullStart; i < hullSize; i++) {
            this.hull[i] = e;
            e = hullNext[e];
        }

        // trim typed triangle mesh arrays
        this.triangles = this._triangles.subarray(0, this.trianglesLen);
        this.halfedges = this._halfedges.subarray(0, this.trianglesLen);
    }

    _hashKey(x, y) {
        return Math.floor(pseudoAngle(x - this._cx, y - this._cy) * this._hashSize) % this._hashSize;
    }

    _legalize(a) {
        const {_triangles: triangles, _halfedges: halfedges, coords} = this;

        let i = 0;
        let ar = 0;

        // recursion eliminated with a fixed-size stack
        while (true) {
            const b = halfedges[a];

            /* if the pair of triangles doesn't satisfy the Delaunay condition
             * (p1 is inside the circumcircle of [p0, pl, pr]), flip them,
             * then do the same check/flip recursively for the new pair of triangles
             *
             *           pl                    pl
             *          /||\                  /  \
             *       al/ || \bl            al/    \a
             *        /  ||  \              /      \
             *       /  a||b  \    flip    /___ar___\
             *     p0\   ||   /p1   =>   p0\---bl---/p1
             *        \  ||  /              \      /
             *       ar\ || /br             b\    /br
             *          \||/                  \  /
             *           pr                    pr
             */
            const a0 = a - a % 3;
            ar = a0 + (a + 2) % 3;

            if (b === -1) { // convex hull edge
                if (i === 0) break;
                a = EDGE_STACK[--i];
                continue;
            }

            const b0 = b - b % 3;
            const al = a0 + (a + 1) % 3;
            const bl = b0 + (b + 2) % 3;

            const p0 = triangles[ar];
            const pr = triangles[a];
            const pl = triangles[al];
            const p1 = triangles[bl];

            const illegal = inCircle(
                coords[2 * p0], coords[2 * p0 + 1],
                coords[2 * pr], coords[2 * pr + 1],
                coords[2 * pl], coords[2 * pl + 1],
                coords[2 * p1], coords[2 * p1 + 1]);

            if (illegal) {
                triangles[a] = p1;
                triangles[b] = p0;

                const hbl = halfedges[bl];

                // edge swapped on the other side of the hull (rare); fix the halfedge reference
                if (hbl === -1) {
                    let e = this._hullStart;
                    do {
                        if (this._hullTri[e] === bl) {
                            this._hullTri[e] = a;
                            break;
                        }
                        e = this._hullPrev[e];
                    } while (e !== this._hullStart);
                }
                this._link(a, hbl);
                this._link(b, halfedges[ar]);
                this._link(ar, bl);

                const br = b0 + (b + 1) % 3;

                // don't worry about hitting the cap: it can only happen on extremely degenerate input
                if (i < EDGE_STACK.length) {
                    EDGE_STACK[i++] = br;
                }
            } else {
                if (i === 0) break;
                a = EDGE_STACK[--i];
            }
        }

        return ar;
    }

    _link(a, b) {
        this._halfedges[a] = b;
        if (b !== -1) this._halfedges[b] = a;
    }

    // add a new triangle given vertex indices and adjacent half-edge ids
    _addTriangle(i0, i1, i2, a, b, c) {
        const t = this.trianglesLen;

        this._triangles[t] = i0;
        this._triangles[t + 1] = i1;
        this._triangles[t + 2] = i2;

        this._link(t, a);
        this._link(t + 1, b);
        this._link(t + 2, c);

        this.trianglesLen += 3;

        return t;
    }
}

// monotonically increases with real angle, but doesn't need expensive trigonometry
function pseudoAngle(dx, dy) {
    const p = dx / (Math.abs(dx) + Math.abs(dy));
    return (dy > 0 ? 3 - p : 1 + p) / 4; // [0..1]
}

function dist(ax, ay, bx, by) {
    const dx = ax - bx;
    const dy = ay - by;
    return dx * dx + dy * dy;
}

function inCircle(ax, ay, bx, by, cx, cy, px, py) {
    const dx = ax - px;
    const dy = ay - py;
    const ex = bx - px;
    const ey = by - py;
    const fx = cx - px;
    const fy = cy - py;

    const ap = dx * dx + dy * dy;
    const bp = ex * ex + ey * ey;
    const cp = fx * fx + fy * fy;

    return dx * (ey * cp - bp * fy) -
           dy * (ex * cp - bp * fx) +
           ap * (ex * fy - ey * fx) < 0;
}

function circumradius(ax, ay, bx, by, cx, cy) {
    const dx = bx - ax;
    const dy = by - ay;
    const ex = cx - ax;
    const ey = cy - ay;

    const bl = dx * dx + dy * dy;
    const cl = ex * ex + ey * ey;
    const d = 0.5 / (dx * ey - dy * ex);

    const x = (ey * bl - dy * cl) * d;
    const y = (dx * cl - ex * bl) * d;

    return x * x + y * y;
}

function circumcenter(ax, ay, bx, by, cx, cy) {
    const dx = bx - ax;
    const dy = by - ay;
    const ex = cx - ax;
    const ey = cy - ay;

    const bl = dx * dx + dy * dy;
    const cl = ex * ex + ey * ey;
    const d = 0.5 / (dx * ey - dy * ex);

    const x = ax + (ey * bl - dy * cl) * d;
    const y = ay + (dx * cl - ex * bl) * d;

    return {x, y};
}

function quicksort(ids, dists, left, right) {
    if (right - left <= 20) {
        for (let i = left + 1; i <= right; i++) {
            const temp = ids[i];
            const tempDist = dists[temp];
            let j = i - 1;
            while (j >= left && dists[ids[j]] > tempDist) ids[j + 1] = ids[j--];
            ids[j + 1] = temp;
        }
    } else {
        const median = (left + right) >> 1;
        let i = left + 1;
        let j = right;
        swap(ids, median, i);
        if (dists[ids[left]] > dists[ids[right]]) swap(ids, left, right);
        if (dists[ids[i]] > dists[ids[right]]) swap(ids, i, right);
        if (dists[ids[left]] > dists[ids[i]]) swap(ids, left, i);

        const temp = ids[i];
        const tempDist = dists[temp];
        while (true) {
            do i++; while (dists[ids[i]] < tempDist);
            do j--; while (dists[ids[j]] > tempDist);
            if (j < i) break;
            swap(ids, i, j);
        }
        ids[left + 1] = ids[j];
        ids[j] = temp;

        if (right - i + 1 >= j - left) {
            quicksort(ids, dists, i, right);
            quicksort(ids, dists, left, j - 1);
        } else {
            quicksort(ids, dists, left, j - 1);
            quicksort(ids, dists, i, right);
        }
    }
}

function swap(arr, i, j) {
    const tmp = arr[i];
    arr[i] = arr[j];
    arr[j] = tmp;
}

function defaultGetX(p) {
    return p[0];
}
function defaultGetY(p) {
    return p[1];
}

const epsilon$2 = 1e-6;

class Path {
  constructor() {
    this._x0 = this._y0 = // start of current subpath
    this._x1 = this._y1 = null; // end of current subpath
    this._ = "";
  }
  moveTo(x, y) {
    this._ += `M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}`;
  }
  closePath() {
    if (this._x1 !== null) {
      this._x1 = this._x0, this._y1 = this._y0;
      this._ += "Z";
    }
  }
  lineTo(x, y) {
    this._ += `L${this._x1 = +x},${this._y1 = +y}`;
  }
  arc(x, y, r) {
    x = +x, y = +y, r = +r;
    const x0 = x + r;
    const y0 = y;
    if (r < 0) throw new Error("negative radius");
    if (this._x1 === null) this._ += `M${x0},${y0}`;
    else if (Math.abs(this._x1 - x0) > epsilon$2 || Math.abs(this._y1 - y0) > epsilon$2) this._ += "L" + x0 + "," + y0;
    if (!r) return;
    this._ += `A${r},${r},0,1,1,${x - r},${y}A${r},${r},0,1,1,${this._x1 = x0},${this._y1 = y0}`;
  }
  rect(x, y, w, h) {
    this._ += `M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}h${+w}v${+h}h${-w}Z`;
  }
  value() {
    return this._ || null;
  }
}

class Polygon {
  constructor() {
    this._ = [];
  }
  moveTo(x, y) {
    this._.push([x, y]);
  }
  closePath() {
    this._.push(this._[0].slice());
  }
  lineTo(x, y) {
    this._.push([x, y]);
  }
  value() {
    return this._.length ? this._ : null;
  }
}

class Voronoi {
  constructor(delaunay, [xmin, ymin, xmax, ymax] = [0, 0, 960, 500]) {
    if (!((xmax = +xmax) >= (xmin = +xmin)) || !((ymax = +ymax) >= (ymin = +ymin))) throw new Error("invalid bounds");
    this.delaunay = delaunay;
    this._circumcenters = new Float64Array(delaunay.points.length * 2);
    this.vectors = new Float64Array(delaunay.points.length * 2);
    this.xmax = xmax, this.xmin = xmin;
    this.ymax = ymax, this.ymin = ymin;
    this._init();
  }
  update() {
    this.delaunay.update();
    this._init();
    return this;
  }
  _init() {
    const {delaunay: {points, hull, triangles}, vectors} = this;
    let bx, by; // lazily computed barycenter of the hull

    // Compute circumcenters.
    const circumcenters = this.circumcenters = this._circumcenters.subarray(0, triangles.length / 3 * 2);
    for (let i = 0, j = 0, n = triangles.length, x, y; i < n; i += 3, j += 2) {
      const t1 = triangles[i] * 2;
      const t2 = triangles[i + 1] * 2;
      const t3 = triangles[i + 2] * 2;
      const x1 = points[t1];
      const y1 = points[t1 + 1];
      const x2 = points[t2];
      const y2 = points[t2 + 1];
      const x3 = points[t3];
      const y3 = points[t3 + 1];

      const dx = x2 - x1;
      const dy = y2 - y1;
      const ex = x3 - x1;
      const ey = y3 - y1;
      const ab = (dx * ey - dy * ex) * 2;

      if (Math.abs(ab) < 1e-9) {
        // For a degenerate triangle, the circumcenter is at the infinity, in a
        // direction orthogonal to the halfedge and away from the “center” of
        // the diagram <bx, by>, defined as the hull’s barycenter.
        if (bx === undefined) {
          bx = by = 0;
          for (const i of hull) bx += points[i * 2], by += points[i * 2 + 1];
          bx /= hull.length, by /= hull.length;
        }
        const a = 1e9 * Math.sign((bx - x1) * ey - (by - y1) * ex);
        x = (x1 + x3) / 2 - a * ey;
        y = (y1 + y3) / 2 + a * ex;
      } else {
        const d = 1 / ab;
        const bl = dx * dx + dy * dy;
        const cl = ex * ex + ey * ey;
        x = x1 + (ey * bl - dy * cl) * d;
        y = y1 + (dx * cl - ex * bl) * d;
      }
      circumcenters[j] = x;
      circumcenters[j + 1] = y;
    }

    // Compute exterior cell rays.
    let h = hull[hull.length - 1];
    let p0, p1 = h * 4;
    let x0, x1 = points[2 * h];
    let y0, y1 = points[2 * h + 1];
    vectors.fill(0);
    for (let i = 0; i < hull.length; ++i) {
      h = hull[i];
      p0 = p1, x0 = x1, y0 = y1;
      p1 = h * 4, x1 = points[2 * h], y1 = points[2 * h + 1];
      vectors[p0 + 2] = vectors[p1] = y0 - y1;
      vectors[p0 + 3] = vectors[p1 + 1] = x1 - x0;
    }
  }
  render(context) {
    const buffer = context == null ? context = new Path : undefined;
    const {delaunay: {halfedges, inedges, hull}, circumcenters, vectors} = this;
    if (hull.length <= 1) return null;
    for (let i = 0, n = halfedges.length; i < n; ++i) {
      const j = halfedges[i];
      if (j < i) continue;
      const ti = Math.floor(i / 3) * 2;
      const tj = Math.floor(j / 3) * 2;
      const xi = circumcenters[ti];
      const yi = circumcenters[ti + 1];
      const xj = circumcenters[tj];
      const yj = circumcenters[tj + 1];
      this._renderSegment(xi, yi, xj, yj, context);
    }
    let h0, h1 = hull[hull.length - 1];
    for (let i = 0; i < hull.length; ++i) {
      h0 = h1, h1 = hull[i];
      const t = Math.floor(inedges[h1] / 3) * 2;
      const x = circumcenters[t];
      const y = circumcenters[t + 1];
      const v = h0 * 4;
      const p = this._project(x, y, vectors[v + 2], vectors[v + 3]);
      if (p) this._renderSegment(x, y, p[0], p[1], context);
    }
    return buffer && buffer.value();
  }
  renderBounds(context) {
    const buffer = context == null ? context = new Path : undefined;
    context.rect(this.xmin, this.ymin, this.xmax - this.xmin, this.ymax - this.ymin);
    return buffer && buffer.value();
  }
  renderCell(i, context) {
    const buffer = context == null ? context = new Path : undefined;
    const points = this._clip(i);
    if (points === null || !points.length) return;
    context.moveTo(points[0], points[1]);
    let n = points.length;
    while (points[0] === points[n-2] && points[1] === points[n-1] && n > 1) n -= 2;
    for (let i = 2; i < n; i += 2) {
      if (points[i] !== points[i-2] || points[i+1] !== points[i-1])
        context.lineTo(points[i], points[i + 1]);
    }
    context.closePath();
    return buffer && buffer.value();
  }
  *cellPolygons() {
    const {delaunay: {points}} = this;
    for (let i = 0, n = points.length / 2; i < n; ++i) {
      const cell = this.cellPolygon(i);
      if (cell) cell.index = i, yield cell;
    }
  }
  cellPolygon(i) {
    const polygon = new Polygon;
    this.renderCell(i, polygon);
    return polygon.value();
  }
  _renderSegment(x0, y0, x1, y1, context) {
    let S;
    const c0 = this._regioncode(x0, y0);
    const c1 = this._regioncode(x1, y1);
    if (c0 === 0 && c1 === 0) {
      context.moveTo(x0, y0);
      context.lineTo(x1, y1);
    } else if (S = this._clipSegment(x0, y0, x1, y1, c0, c1)) {
      context.moveTo(S[0], S[1]);
      context.lineTo(S[2], S[3]);
    }
  }
  contains(i, x, y) {
    if ((x = +x, x !== x) || (y = +y, y !== y)) return false;
    return this.delaunay._step(i, x, y) === i;
  }
  *neighbors(i) {
    const ci = this._clip(i);
    if (ci) for (const j of this.delaunay.neighbors(i)) {
      const cj = this._clip(j);
      // find the common edge
      if (cj) loop: for (let ai = 0, li = ci.length; ai < li; ai += 2) {
        for (let aj = 0, lj = cj.length; aj < lj; aj += 2) {
          if (ci[ai] === cj[aj]
              && ci[ai + 1] === cj[aj + 1]
              && ci[(ai + 2) % li] === cj[(aj + lj - 2) % lj]
              && ci[(ai + 3) % li] === cj[(aj + lj - 1) % lj]) {
            yield j;
            break loop;
          }
        }
      }
    }
  }
  _cell(i) {
    const {circumcenters, delaunay: {inedges, halfedges, triangles}} = this;
    const e0 = inedges[i];
    if (e0 === -1) return null; // coincident point
    const points = [];
    let e = e0;
    do {
      const t = Math.floor(e / 3);
      points.push(circumcenters[t * 2], circumcenters[t * 2 + 1]);
      e = e % 3 === 2 ? e - 2 : e + 1;
      if (triangles[e] !== i) break; // bad triangulation
      e = halfedges[e];
    } while (e !== e0 && e !== -1);
    return points;
  }
  _clip(i) {
    // degenerate case (1 valid point: return the box)
    if (i === 0 && this.delaunay.hull.length === 1) {
      return [this.xmax, this.ymin, this.xmax, this.ymax, this.xmin, this.ymax, this.xmin, this.ymin];
    }
    const points = this._cell(i);
    if (points === null) return null;
    const {vectors: V} = this;
    const v = i * 4;
    return this._simplify(V[v] || V[v + 1]
        ? this._clipInfinite(i, points, V[v], V[v + 1], V[v + 2], V[v + 3])
        : this._clipFinite(i, points));
  }
  _clipFinite(i, points) {
    const n = points.length;
    let P = null;
    let x0, y0, x1 = points[n - 2], y1 = points[n - 1];
    let c0, c1 = this._regioncode(x1, y1);
    let e0, e1 = 0;
    for (let j = 0; j < n; j += 2) {
      x0 = x1, y0 = y1, x1 = points[j], y1 = points[j + 1];
      c0 = c1, c1 = this._regioncode(x1, y1);
      if (c0 === 0 && c1 === 0) {
        e0 = e1, e1 = 0;
        if (P) P.push(x1, y1);
        else P = [x1, y1];
      } else {
        let S, sx0, sy0, sx1, sy1;
        if (c0 === 0) {
          if ((S = this._clipSegment(x0, y0, x1, y1, c0, c1)) === null) continue;
          [sx0, sy0, sx1, sy1] = S;
        } else {
          if ((S = this._clipSegment(x1, y1, x0, y0, c1, c0)) === null) continue;
          [sx1, sy1, sx0, sy0] = S;
          e0 = e1, e1 = this._edgecode(sx0, sy0);
          if (e0 && e1) this._edge(i, e0, e1, P, P.length);
          if (P) P.push(sx0, sy0);
          else P = [sx0, sy0];
        }
        e0 = e1, e1 = this._edgecode(sx1, sy1);
        if (e0 && e1) this._edge(i, e0, e1, P, P.length);
        if (P) P.push(sx1, sy1);
        else P = [sx1, sy1];
      }
    }
    if (P) {
      e0 = e1, e1 = this._edgecode(P[0], P[1]);
      if (e0 && e1) this._edge(i, e0, e1, P, P.length);
    } else if (this.contains(i, (this.xmin + this.xmax) / 2, (this.ymin + this.ymax) / 2)) {
      return [this.xmax, this.ymin, this.xmax, this.ymax, this.xmin, this.ymax, this.xmin, this.ymin];
    }
    return P;
  }
  _clipSegment(x0, y0, x1, y1, c0, c1) {
    // for more robustness, always consider the segment in the same order
    const flip = c0 < c1;
    if (flip) [x0, y0, x1, y1, c0, c1] = [x1, y1, x0, y0, c1, c0];
    while (true) {
      if (c0 === 0 && c1 === 0) return flip ? [x1, y1, x0, y0] : [x0, y0, x1, y1];
      if (c0 & c1) return null;
      let x, y, c = c0 || c1;
      if (c & 0b1000) x = x0 + (x1 - x0) * (this.ymax - y0) / (y1 - y0), y = this.ymax;
      else if (c & 0b0100) x = x0 + (x1 - x0) * (this.ymin - y0) / (y1 - y0), y = this.ymin;
      else if (c & 0b0010) y = y0 + (y1 - y0) * (this.xmax - x0) / (x1 - x0), x = this.xmax;
      else y = y0 + (y1 - y0) * (this.xmin - x0) / (x1 - x0), x = this.xmin;
      if (c0) x0 = x, y0 = y, c0 = this._regioncode(x0, y0);
      else x1 = x, y1 = y, c1 = this._regioncode(x1, y1);
    }
  }
  _clipInfinite(i, points, vx0, vy0, vxn, vyn) {
    let P = Array.from(points), p;
    if (p = this._project(P[0], P[1], vx0, vy0)) P.unshift(p[0], p[1]);
    if (p = this._project(P[P.length - 2], P[P.length - 1], vxn, vyn)) P.push(p[0], p[1]);
    if (P = this._clipFinite(i, P)) {
      for (let j = 0, n = P.length, c0, c1 = this._edgecode(P[n - 2], P[n - 1]); j < n; j += 2) {
        c0 = c1, c1 = this._edgecode(P[j], P[j + 1]);
        if (c0 && c1) j = this._edge(i, c0, c1, P, j), n = P.length;
      }
    } else if (this.contains(i, (this.xmin + this.xmax) / 2, (this.ymin + this.ymax) / 2)) {
      P = [this.xmin, this.ymin, this.xmax, this.ymin, this.xmax, this.ymax, this.xmin, this.ymax];
    }
    return P;
  }
  _edge(i, e0, e1, P, j) {
    while (e0 !== e1) {
      let x, y;
      switch (e0) {
        case 0b0101: e0 = 0b0100; continue; // top-left
        case 0b0100: e0 = 0b0110, x = this.xmax, y = this.ymin; break; // top
        case 0b0110: e0 = 0b0010; continue; // top-right
        case 0b0010: e0 = 0b1010, x = this.xmax, y = this.ymax; break; // right
        case 0b1010: e0 = 0b1000; continue; // bottom-right
        case 0b1000: e0 = 0b1001, x = this.xmin, y = this.ymax; break; // bottom
        case 0b1001: e0 = 0b0001; continue; // bottom-left
        case 0b0001: e0 = 0b0101, x = this.xmin, y = this.ymin; break; // left
      }
      // Note: this implicitly checks for out of bounds: if P[j] or P[j+1] are
      // undefined, the conditional statement will be executed.
      if ((P[j] !== x || P[j + 1] !== y) && this.contains(i, x, y)) {
        P.splice(j, 0, x, y), j += 2;
      }
    }
    return j;
  }
  _project(x0, y0, vx, vy) {
    let t = Infinity, c, x, y;
    if (vy < 0) { // top
      if (y0 <= this.ymin) return null;
      if ((c = (this.ymin - y0) / vy) < t) y = this.ymin, x = x0 + (t = c) * vx;
    } else if (vy > 0) { // bottom
      if (y0 >= this.ymax) return null;
      if ((c = (this.ymax - y0) / vy) < t) y = this.ymax, x = x0 + (t = c) * vx;
    }
    if (vx > 0) { // right
      if (x0 >= this.xmax) return null;
      if ((c = (this.xmax - x0) / vx) < t) x = this.xmax, y = y0 + (t = c) * vy;
    } else if (vx < 0) { // left
      if (x0 <= this.xmin) return null;
      if ((c = (this.xmin - x0) / vx) < t) x = this.xmin, y = y0 + (t = c) * vy;
    }
    return [x, y];
  }
  _edgecode(x, y) {
    return (x === this.xmin ? 0b0001
        : x === this.xmax ? 0b0010 : 0b0000)
        | (y === this.ymin ? 0b0100
        : y === this.ymax ? 0b1000 : 0b0000);
  }
  _regioncode(x, y) {
    return (x < this.xmin ? 0b0001
        : x > this.xmax ? 0b0010 : 0b0000)
        | (y < this.ymin ? 0b0100
        : y > this.ymax ? 0b1000 : 0b0000);
  }
  _simplify(P) {
    if (P && P.length > 4) {
      for (let i = 0; i < P.length; i+= 2) {
        const j = (i + 2) % P.length, k = (i + 4) % P.length;
        if (P[i] === P[j] && P[j] === P[k] || P[i + 1] === P[j + 1] && P[j + 1] === P[k + 1]) {
          P.splice(j, 2), i -= 2;
        }
      }
      if (!P.length) P = null;
    }
    return P;
  }
}

const tau$2 = 2 * Math.PI, pow$2 = Math.pow;

function pointX(p) {
  return p[0];
}

function pointY(p) {
  return p[1];
}

// A triangulation is collinear if all its triangles have a non-null area
function collinear(d) {
  const {triangles, coords} = d;
  for (let i = 0; i < triangles.length; i += 3) {
    const a = 2 * triangles[i],
          b = 2 * triangles[i + 1],
          c = 2 * triangles[i + 2],
          cross = (coords[c] - coords[a]) * (coords[b + 1] - coords[a + 1])
                - (coords[b] - coords[a]) * (coords[c + 1] - coords[a + 1]);
    if (cross > 1e-10) return false;
  }
  return true;
}

function jitter(x, y, r) {
  return [x + Math.sin(x + y) * r, y + Math.cos(x - y) * r];
}

class Delaunay {
  static from(points, fx = pointX, fy = pointY, that) {
    return new Delaunay("length" in points
        ? flatArray(points, fx, fy, that)
        : Float64Array.from(flatIterable(points, fx, fy, that)));
  }
  constructor(points) {
    this._delaunator = new Delaunator(points);
    this.inedges = new Int32Array(points.length / 2);
    this._hullIndex = new Int32Array(points.length / 2);
    this.points = this._delaunator.coords;
    this._init();
  }
  update() {
    this._delaunator.update();
    this._init();
    return this;
  }
  _init() {
    const d = this._delaunator, points = this.points;

    // check for collinear
    if (d.hull && d.hull.length > 2 && collinear(d)) {
      this.collinear = Int32Array.from({length: points.length/2}, (_,i) => i)
        .sort((i, j) => points[2 * i] - points[2 * j] || points[2 * i + 1] - points[2 * j + 1]); // for exact neighbors
      const e = this.collinear[0], f = this.collinear[this.collinear.length - 1],
        bounds = [ points[2 * e], points[2 * e + 1], points[2 * f], points[2 * f + 1] ],
        r = 1e-8 * Math.hypot(bounds[3] - bounds[1], bounds[2] - bounds[0]);
      for (let i = 0, n = points.length / 2; i < n; ++i) {
        const p = jitter(points[2 * i], points[2 * i + 1], r);
        points[2 * i] = p[0];
        points[2 * i + 1] = p[1];
      }
      this._delaunator = new Delaunator(points);
    } else {
      delete this.collinear;
    }

    const halfedges = this.halfedges = this._delaunator.halfedges;
    const hull = this.hull = this._delaunator.hull;
    const triangles = this.triangles = this._delaunator.triangles;
    const inedges = this.inedges.fill(-1);
    const hullIndex = this._hullIndex.fill(-1);

    // Compute an index from each point to an (arbitrary) incoming halfedge
    // Used to give the first neighbor of each point; for this reason,
    // on the hull we give priority to exterior halfedges
    for (let e = 0, n = halfedges.length; e < n; ++e) {
      const p = triangles[e % 3 === 2 ? e - 2 : e + 1];
      if (halfedges[e] === -1 || inedges[p] === -1) inedges[p] = e;
    }
    for (let i = 0, n = hull.length; i < n; ++i) {
      hullIndex[hull[i]] = i;
    }

    // degenerate case: 1 or 2 (distinct) points
    if (hull.length <= 2 && hull.length > 0) {
      this.triangles = new Int32Array(3).fill(-1);
      this.halfedges = new Int32Array(3).fill(-1);
      this.triangles[0] = hull[0];
      inedges[hull[0]] = 1;
      if (hull.length === 2) {
        inedges[hull[1]] = 0;
        this.triangles[1] = hull[1];
        this.triangles[2] = hull[1];
      }
    }
  }
  voronoi(bounds) {
    return new Voronoi(this, bounds);
  }
  *neighbors(i) {
    const {inedges, hull, _hullIndex, halfedges, triangles, collinear} = this;

    // degenerate case with several collinear points
    if (collinear) {
      const l = collinear.indexOf(i);
      if (l > 0) yield collinear[l - 1];
      if (l < collinear.length - 1) yield collinear[l + 1];
      return;
    }

    const e0 = inedges[i];
    if (e0 === -1) return; // coincident point
    let e = e0, p0 = -1;
    do {
      yield p0 = triangles[e];
      e = e % 3 === 2 ? e - 2 : e + 1;
      if (triangles[e] !== i) return; // bad triangulation
      e = halfedges[e];
      if (e === -1) {
        const p = hull[(_hullIndex[i] + 1) % hull.length];
        if (p !== p0) yield p;
        return;
      }
    } while (e !== e0);
  }
  find(x, y, i = 0) {
    if ((x = +x, x !== x) || (y = +y, y !== y)) return -1;
    const i0 = i;
    let c;
    while ((c = this._step(i, x, y)) >= 0 && c !== i && c !== i0) i = c;
    return c;
  }
  _step(i, x, y) {
    const {inedges, hull, _hullIndex, halfedges, triangles, points} = this;
    if (inedges[i] === -1 || !points.length) return (i + 1) % (points.length >> 1);
    let c = i;
    let dc = pow$2(x - points[i * 2], 2) + pow$2(y - points[i * 2 + 1], 2);
    const e0 = inedges[i];
    let e = e0;
    do {
      let t = triangles[e];
      const dt = pow$2(x - points[t * 2], 2) + pow$2(y - points[t * 2 + 1], 2);
      if (dt < dc) dc = dt, c = t;
      e = e % 3 === 2 ? e - 2 : e + 1;
      if (triangles[e] !== i) break; // bad triangulation
      e = halfedges[e];
      if (e === -1) {
        e = hull[(_hullIndex[i] + 1) % hull.length];
        if (e !== t) {
          if (pow$2(x - points[e * 2], 2) + pow$2(y - points[e * 2 + 1], 2) < dc) return e;
        }
        break;
      }
    } while (e !== e0);
    return c;
  }
  render(context) {
    const buffer = context == null ? context = new Path : undefined;
    const {points, halfedges, triangles} = this;
    for (let i = 0, n = halfedges.length; i < n; ++i) {
      const j = halfedges[i];
      if (j < i) continue;
      const ti = triangles[i] * 2;
      const tj = triangles[j] * 2;
      context.moveTo(points[ti], points[ti + 1]);
      context.lineTo(points[tj], points[tj + 1]);
    }
    this.renderHull(context);
    return buffer && buffer.value();
  }
  renderPoints(context, r) {
    if (r === undefined && (!context || typeof context.moveTo !== "function")) r = context, context = null;
    r = r == undefined ? 2 : +r;
    const buffer = context == null ? context = new Path : undefined;
    const {points} = this;
    for (let i = 0, n = points.length; i < n; i += 2) {
      const x = points[i], y = points[i + 1];
      context.moveTo(x + r, y);
      context.arc(x, y, r, 0, tau$2);
    }
    return buffer && buffer.value();
  }
  renderHull(context) {
    const buffer = context == null ? context = new Path : undefined;
    const {hull, points} = this;
    const h = hull[0] * 2, n = hull.length;
    context.moveTo(points[h], points[h + 1]);
    for (let i = 1; i < n; ++i) {
      const h = 2 * hull[i];
      context.lineTo(points[h], points[h + 1]);
    }
    context.closePath();
    return buffer && buffer.value();
  }
  hullPolygon() {
    const polygon = new Polygon;
    this.renderHull(polygon);
    return polygon.value();
  }
  renderTriangle(i, context) {
    const buffer = context == null ? context = new Path : undefined;
    const {points, triangles} = this;
    const t0 = triangles[i *= 3] * 2;
    const t1 = triangles[i + 1] * 2;
    const t2 = triangles[i + 2] * 2;
    context.moveTo(points[t0], points[t0 + 1]);
    context.lineTo(points[t1], points[t1 + 1]);
    context.lineTo(points[t2], points[t2 + 1]);
    context.closePath();
    return buffer && buffer.value();
  }
  *trianglePolygons() {
    const {triangles} = this;
    for (let i = 0, n = triangles.length / 3; i < n; ++i) {
      yield this.trianglePolygon(i);
    }
  }
  trianglePolygon(i) {
    const polygon = new Polygon;
    this.renderTriangle(i, polygon);
    return polygon.value();
  }
}

function flatArray(points, fx, fy, that) {
  const n = points.length;
  const array = new Float64Array(n * 2);
  for (let i = 0; i < n; ++i) {
    const p = points[i];
    array[i * 2] = fx.call(that, p, i, points);
    array[i * 2 + 1] = fy.call(that, p, i, points);
  }
  return array;
}

function* flatIterable(points, fx, fy, that) {
  let i = 0;
  for (const p of points) {
    yield fx.call(that, p, i, points);
    yield fy.call(that, p, i, points);
    ++i;
  }
}

var EOL = {},
    EOF = {},
    QUOTE = 34,
    NEWLINE = 10,
    RETURN = 13;

function objectConverter(columns) {
  return new Function("d", "return {" + columns.map(function(name, i) {
    return JSON.stringify(name) + ": d[" + i + "] || \"\"";
  }).join(",") + "}");
}

function customConverter(columns, f) {
  var object = objectConverter(columns);
  return function(row, i) {
    return f(object(row), i, columns);
  };
}

// Compute unique columns in order of discovery.
function inferColumns(rows) {
  var columnSet = Object.create(null),
      columns = [];

  rows.forEach(function(row) {
    for (var column in row) {
      if (!(column in columnSet)) {
        columns.push(columnSet[column] = column);
      }
    }
  });

  return columns;
}

function pad$1(value, width) {
  var s = value + "", length = s.length;
  return length < width ? new Array(width - length + 1).join(0) + s : s;
}

function formatYear$1(year) {
  return year < 0 ? "-" + pad$1(-year, 6)
    : year > 9999 ? "+" + pad$1(year, 6)
    : pad$1(year, 4);
}

function formatDate(date) {
  var hours = date.getUTCHours(),
      minutes = date.getUTCMinutes(),
      seconds = date.getUTCSeconds(),
      milliseconds = date.getUTCMilliseconds();
  return isNaN(date) ? "Invalid Date"
      : formatYear$1(date.getUTCFullYear()) + "-" + pad$1(date.getUTCMonth() + 1, 2) + "-" + pad$1(date.getUTCDate(), 2)
      + (milliseconds ? "T" + pad$1(hours, 2) + ":" + pad$1(minutes, 2) + ":" + pad$1(seconds, 2) + "." + pad$1(milliseconds, 3) + "Z"
      : seconds ? "T" + pad$1(hours, 2) + ":" + pad$1(minutes, 2) + ":" + pad$1(seconds, 2) + "Z"
      : minutes || hours ? "T" + pad$1(hours, 2) + ":" + pad$1(minutes, 2) + "Z"
      : "");
}

function dsvFormat(delimiter) {
  var reFormat = new RegExp("[\"" + delimiter + "\n\r]"),
      DELIMITER = delimiter.charCodeAt(0);

  function parse(text, f) {
    var convert, columns, rows = parseRows(text, function(row, i) {
      if (convert) return convert(row, i - 1);
      columns = row, convert = f ? customConverter(row, f) : objectConverter(row);
    });
    rows.columns = columns || [];
    return rows;
  }

  function parseRows(text, f) {
    var rows = [], // output rows
        N = text.length,
        I = 0, // current character index
        n = 0, // current line number
        t, // current token
        eof = N <= 0, // current token followed by EOF?
        eol = false; // current token followed by EOL?

    // Strip the trailing newline.
    if (text.charCodeAt(N - 1) === NEWLINE) --N;
    if (text.charCodeAt(N - 1) === RETURN) --N;

    function token() {
      if (eof) return EOF;
      if (eol) return eol = false, EOL;

      // Unescape quotes.
      var i, j = I, c;
      if (text.charCodeAt(j) === QUOTE) {
        while (I++ < N && text.charCodeAt(I) !== QUOTE || text.charCodeAt(++I) === QUOTE);
        if ((i = I) >= N) eof = true;
        else if ((c = text.charCodeAt(I++)) === NEWLINE) eol = true;
        else if (c === RETURN) { eol = true; if (text.charCodeAt(I) === NEWLINE) ++I; }
        return text.slice(j + 1, i - 1).replace(/""/g, "\"");
      }

      // Find next delimiter or newline.
      while (I < N) {
        if ((c = text.charCodeAt(i = I++)) === NEWLINE) eol = true;
        else if (c === RETURN) { eol = true; if (text.charCodeAt(I) === NEWLINE) ++I; }
        else if (c !== DELIMITER) continue;
        return text.slice(j, i);
      }

      // Return last token before EOF.
      return eof = true, text.slice(j, N);
    }

    while ((t = token()) !== EOF) {
      var row = [];
      while (t !== EOL && t !== EOF) row.push(t), t = token();
      if (f && (row = f(row, n++)) == null) continue;
      rows.push(row);
    }

    return rows;
  }

  function preformatBody(rows, columns) {
    return rows.map(function(row) {
      return columns.map(function(column) {
        return formatValue(row[column]);
      }).join(delimiter);
    });
  }

  function format(rows, columns) {
    if (columns == null) columns = inferColumns(rows);
    return [columns.map(formatValue).join(delimiter)].concat(preformatBody(rows, columns)).join("\n");
  }

  function formatBody(rows, columns) {
    if (columns == null) columns = inferColumns(rows);
    return preformatBody(rows, columns).join("\n");
  }

  function formatRows(rows) {
    return rows.map(formatRow).join("\n");
  }

  function formatRow(row) {
    return row.map(formatValue).join(delimiter);
  }

  function formatValue(value) {
    return value == null ? ""
        : value instanceof Date ? formatDate(value)
        : reFormat.test(value += "") ? "\"" + value.replace(/"/g, "\"\"") + "\""
        : value;
  }

  return {
    parse: parse,
    parseRows: parseRows,
    format: format,
    formatBody: formatBody,
    formatRows: formatRows,
    formatRow: formatRow,
    formatValue: formatValue
  };
}

var csv$1 = dsvFormat(",");

var csvParse = csv$1.parse;
var csvParseRows = csv$1.parseRows;
var csvFormat = csv$1.format;
var csvFormatBody = csv$1.formatBody;
var csvFormatRows = csv$1.formatRows;
var csvFormatRow = csv$1.formatRow;
var csvFormatValue = csv$1.formatValue;

var tsv$1 = dsvFormat("\t");

var tsvParse = tsv$1.parse;
var tsvParseRows = tsv$1.parseRows;
var tsvFormat = tsv$1.format;
var tsvFormatBody = tsv$1.formatBody;
var tsvFormatRows = tsv$1.formatRows;
var tsvFormatRow = tsv$1.formatRow;
var tsvFormatValue = tsv$1.formatValue;

function autoType(object) {
  for (var key in object) {
    var value = object[key].trim(), number, m;
    if (!value) value = null;
    else if (value === "true") value = true;
    else if (value === "false") value = false;
    else if (value === "NaN") value = NaN;
    else if (!isNaN(number = +value)) value = number;
    else if (m = value.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)) {
      if (fixtz && !!m[4] && !m[7]) value = value.replace(/-/g, "/").replace(/T/, " ");
      value = new Date(value);
    }
    else continue;
    object[key] = value;
  }
  return object;
}

// https://github.com/d3/d3-dsv/issues/45
const fixtz = new Date("2019-01-01T00:00").getHours() || new Date("2019-07-01T00:00").getHours();

function responseBlob(response) {
  if (!response.ok) throw new Error(response.status + " " + response.statusText);
  return response.blob();
}

function blob(input, init) {
  return fetch(input, init).then(responseBlob);
}

function responseArrayBuffer(response) {
  if (!response.ok) throw new Error(response.status + " " + response.statusText);
  return response.arrayBuffer();
}

function buffer(input, init) {
  return fetch(input, init).then(responseArrayBuffer);
}

function responseText(response) {
  if (!response.ok) throw new Error(response.status + " " + response.statusText);
  return response.text();
}

function text(input, init) {
  return fetch(input, init).then(responseText);
}

function dsvParse(parse) {
  return function(input, init, row) {
    if (arguments.length === 2 && typeof init === "function") row = init, init = undefined;
    return text(input, init).then(function(response) {
      return parse(response, row);
    });
  };
}

function dsv(delimiter, input, init, row) {
  if (arguments.length === 3 && typeof init === "function") row = init, init = undefined;
  var format = dsvFormat(delimiter);
  return text(input, init).then(function(response) {
    return format.parse(response, row);
  });
}

var csv = dsvParse(csvParse);
var tsv = dsvParse(tsvParse);

function image(input, init) {
  return new Promise(function(resolve, reject) {
    var image = new Image;
    for (var key in init) image[key] = init[key];
    image.onerror = reject;
    image.onload = function() { resolve(image); };
    image.src = input;
  });
}

function responseJson(response) {
  if (!response.ok) throw new Error(response.status + " " + response.statusText);
  if (response.status === 204 || response.status === 205) return;
  return response.json();
}

function json(input, init) {
  return fetch(input, init).then(responseJson);
}

function parser(type) {
  return (input, init) => text(input, init)
    .then(text => (new DOMParser).parseFromString(text, type));
}

var xml = parser("application/xml");

var html = parser("text/html");

var svg = parser("image/svg+xml");

function center(x, y) {
  var nodes, strength = 1;

  if (x == null) x = 0;
  if (y == null) y = 0;

  function force() {
    var i,
        n = nodes.length,
        node,
        sx = 0,
        sy = 0;

    for (i = 0; i < n; ++i) {
      node = nodes[i], sx += node.x, sy += node.y;
    }

    for (sx = (sx / n - x) * strength, sy = (sy / n - y) * strength, i = 0; i < n; ++i) {
      node = nodes[i], node.x -= sx, node.y -= sy;
    }
  }

  force.initialize = function(_) {
    nodes = _;
  };

  force.x = function(_) {
    return arguments.length ? (x = +_, force) : x;
  };

  force.y = function(_) {
    return arguments.length ? (y = +_, force) : y;
  };

  force.strength = function(_) {
    return arguments.length ? (strength = +_, force) : strength;
  };

  return force;
}

function tree_add(d) {
  const x = +this._x.call(null, d),
      y = +this._y.call(null, d);
  return add(this.cover(x, y), x, y, d);
}

function add(tree, x, y, d) {
  if (isNaN(x) || isNaN(y)) return tree; // ignore invalid points

  var parent,
      node = tree._root,
      leaf = {data: d},
      x0 = tree._x0,
      y0 = tree._y0,
      x1 = tree._x1,
      y1 = tree._y1,
      xm,
      ym,
      xp,
      yp,
      right,
      bottom,
      i,
      j;

  // If the tree is empty, initialize the root as a leaf.
  if (!node) return tree._root = leaf, tree;

  // Find the existing leaf for the new point, or add it.
  while (node.length) {
    if (right = x >= (xm = (x0 + x1) / 2)) x0 = xm; else x1 = xm;
    if (bottom = y >= (ym = (y0 + y1) / 2)) y0 = ym; else y1 = ym;
    if (parent = node, !(node = node[i = bottom << 1 | right])) return parent[i] = leaf, tree;
  }

  // Is the new point is exactly coincident with the existing point?
  xp = +tree._x.call(null, node.data);
  yp = +tree._y.call(null, node.data);
  if (x === xp && y === yp) return leaf.next = node, parent ? parent[i] = leaf : tree._root = leaf, tree;

  // Otherwise, split the leaf node until the old and new point are separated.
  do {
    parent = parent ? parent[i] = new Array(4) : tree._root = new Array(4);
    if (right = x >= (xm = (x0 + x1) / 2)) x0 = xm; else x1 = xm;
    if (bottom = y >= (ym = (y0 + y1) / 2)) y0 = ym; else y1 = ym;
  } while ((i = bottom << 1 | right) === (j = (yp >= ym) << 1 | (xp >= xm)));
  return parent[j] = node, parent[i] = leaf, tree;
}

function addAll(data) {
  var d, i, n = data.length,
      x,
      y,
      xz = new Array(n),
      yz = new Array(n),
      x0 = Infinity,
      y0 = Infinity,
      x1 = -Infinity,
      y1 = -Infinity;

  // Compute the points and their extent.
  for (i = 0; i < n; ++i) {
    if (isNaN(x = +this._x.call(null, d = data[i])) || isNaN(y = +this._y.call(null, d))) continue;
    xz[i] = x;
    yz[i] = y;
    if (x < x0) x0 = x;
    if (x > x1) x1 = x;
    if (y < y0) y0 = y;
    if (y > y1) y1 = y;
  }

  // If there were no (valid) points, abort.
  if (x0 > x1 || y0 > y1) return this;

  // Expand the tree to cover the new points.
  this.cover(x0, y0).cover(x1, y1);

  // Add the new points.
  for (i = 0; i < n; ++i) {
    add(this, xz[i], yz[i], data[i]);
  }

  return this;
}

function tree_cover(x, y) {
  if (isNaN(x = +x) || isNaN(y = +y)) return this; // ignore invalid points

  var x0 = this._x0,
      y0 = this._y0,
      x1 = this._x1,
      y1 = this._y1;

  // If the quadtree has no extent, initialize them.
  // Integer extent are necessary so that if we later double the extent,
  // the existing quadrant boundaries don’t change due to floating point error!
  if (isNaN(x0)) {
    x1 = (x0 = Math.floor(x)) + 1;
    y1 = (y0 = Math.floor(y)) + 1;
  }

  // Otherwise, double repeatedly to cover.
  else {
    var z = x1 - x0 || 1,
        node = this._root,
        parent,
        i;

    while (x0 > x || x >= x1 || y0 > y || y >= y1) {
      i = (y < y0) << 1 | (x < x0);
      parent = new Array(4), parent[i] = node, node = parent, z *= 2;
      switch (i) {
        case 0: x1 = x0 + z, y1 = y0 + z; break;
        case 1: x0 = x1 - z, y1 = y0 + z; break;
        case 2: x1 = x0 + z, y0 = y1 - z; break;
        case 3: x0 = x1 - z, y0 = y1 - z; break;
      }
    }

    if (this._root && this._root.length) this._root = node;
  }

  this._x0 = x0;
  this._y0 = y0;
  this._x1 = x1;
  this._y1 = y1;
  return this;
}

function tree_data() {
  var data = [];
  this.visit(function(node) {
    if (!node.length) do data.push(node.data); while (node = node.next)
  });
  return data;
}

function tree_extent(_) {
  return arguments.length
      ? this.cover(+_[0][0], +_[0][1]).cover(+_[1][0], +_[1][1])
      : isNaN(this._x0) ? undefined : [[this._x0, this._y0], [this._x1, this._y1]];
}

function Quad(node, x0, y0, x1, y1) {
  this.node = node;
  this.x0 = x0;
  this.y0 = y0;
  this.x1 = x1;
  this.y1 = y1;
}

function tree_find(x, y, radius) {
  var data,
      x0 = this._x0,
      y0 = this._y0,
      x1,
      y1,
      x2,
      y2,
      x3 = this._x1,
      y3 = this._y1,
      quads = [],
      node = this._root,
      q,
      i;

  if (node) quads.push(new Quad(node, x0, y0, x3, y3));
  if (radius == null) radius = Infinity;
  else {
    x0 = x - radius, y0 = y - radius;
    x3 = x + radius, y3 = y + radius;
    radius *= radius;
  }

  while (q = quads.pop()) {

    // Stop searching if this quadrant can’t contain a closer node.
    if (!(node = q.node)
        || (x1 = q.x0) > x3
        || (y1 = q.y0) > y3
        || (x2 = q.x1) < x0
        || (y2 = q.y1) < y0) continue;

    // Bisect the current quadrant.
    if (node.length) {
      var xm = (x1 + x2) / 2,
          ym = (y1 + y2) / 2;

      quads.push(
        new Quad(node[3], xm, ym, x2, y2),
        new Quad(node[2], x1, ym, xm, y2),
        new Quad(node[1], xm, y1, x2, ym),
        new Quad(node[0], x1, y1, xm, ym)
      );

      // Visit the closest quadrant first.
      if (i = (y >= ym) << 1 | (x >= xm)) {
        q = quads[quads.length - 1];
        quads[quads.length - 1] = quads[quads.length - 1 - i];
        quads[quads.length - 1 - i] = q;
      }
    }

    // Visit this point. (Visiting coincident points isn’t necessary!)
    else {
      var dx = x - +this._x.call(null, node.data),
          dy = y - +this._y.call(null, node.data),
          d2 = dx * dx + dy * dy;
      if (d2 < radius) {
        var d = Math.sqrt(radius = d2);
        x0 = x - d, y0 = y - d;
        x3 = x + d, y3 = y + d;
        data = node.data;
      }
    }
  }

  return data;
}

function tree_remove(d) {
  if (isNaN(x = +this._x.call(null, d)) || isNaN(y = +this._y.call(null, d))) return this; // ignore invalid points

  var parent,
      node = this._root,
      retainer,
      previous,
      next,
      x0 = this._x0,
      y0 = this._y0,
      x1 = this._x1,
      y1 = this._y1,
      x,
      y,
      xm,
      ym,
      right,
      bottom,
      i,
      j;

  // If the tree is empty, initialize the root as a leaf.
  if (!node) return this;

  // Find the leaf node for the point.
  // While descending, also retain the deepest parent with a non-removed sibling.
  if (node.length) while (true) {
    if (right = x >= (xm = (x0 + x1) / 2)) x0 = xm; else x1 = xm;
    if (bottom = y >= (ym = (y0 + y1) / 2)) y0 = ym; else y1 = ym;
    if (!(parent = node, node = node[i = bottom << 1 | right])) return this;
    if (!node.length) break;
    if (parent[(i + 1) & 3] || parent[(i + 2) & 3] || parent[(i + 3) & 3]) retainer = parent, j = i;
  }

  // Find the point to remove.
  while (node.data !== d) if (!(previous = node, node = node.next)) return this;
  if (next = node.next) delete node.next;

  // If there are multiple coincident points, remove just the point.
  if (previous) return (next ? previous.next = next : delete previous.next), this;

  // If this is the root point, remove it.
  if (!parent) return this._root = next, this;

  // Remove this leaf.
  next ? parent[i] = next : delete parent[i];

  // If the parent now contains exactly one leaf, collapse superfluous parents.
  if ((node = parent[0] || parent[1] || parent[2] || parent[3])
      && node === (parent[3] || parent[2] || parent[1] || parent[0])
      && !node.length) {
    if (retainer) retainer[j] = node;
    else this._root = node;
  }

  return this;
}

function removeAll(data) {
  for (var i = 0, n = data.length; i < n; ++i) this.remove(data[i]);
  return this;
}

function tree_root() {
  return this._root;
}

function tree_size() {
  var size = 0;
  this.visit(function(node) {
    if (!node.length) do ++size; while (node = node.next)
  });
  return size;
}

function tree_visit(callback) {
  var quads = [], q, node = this._root, child, x0, y0, x1, y1;
  if (node) quads.push(new Quad(node, this._x0, this._y0, this._x1, this._y1));
  while (q = quads.pop()) {
    if (!callback(node = q.node, x0 = q.x0, y0 = q.y0, x1 = q.x1, y1 = q.y1) && node.length) {
      var xm = (x0 + x1) / 2, ym = (y0 + y1) / 2;
      if (child = node[3]) quads.push(new Quad(child, xm, ym, x1, y1));
      if (child = node[2]) quads.push(new Quad(child, x0, ym, xm, y1));
      if (child = node[1]) quads.push(new Quad(child, xm, y0, x1, ym));
      if (child = node[0]) quads.push(new Quad(child, x0, y0, xm, ym));
    }
  }
  return this;
}

function tree_visitAfter(callback) {
  var quads = [], next = [], q;
  if (this._root) quads.push(new Quad(this._root, this._x0, this._y0, this._x1, this._y1));
  while (q = quads.pop()) {
    var node = q.node;
    if (node.length) {
      var child, x0 = q.x0, y0 = q.y0, x1 = q.x1, y1 = q.y1, xm = (x0 + x1) / 2, ym = (y0 + y1) / 2;
      if (child = node[0]) quads.push(new Quad(child, x0, y0, xm, ym));
      if (child = node[1]) quads.push(new Quad(child, xm, y0, x1, ym));
      if (child = node[2]) quads.push(new Quad(child, x0, ym, xm, y1));
      if (child = node[3]) quads.push(new Quad(child, xm, ym, x1, y1));
    }
    next.push(q);
  }
  while (q = next.pop()) {
    callback(q.node, q.x0, q.y0, q.x1, q.y1);
  }
  return this;
}

function defaultX(d) {
  return d[0];
}

function tree_x(_) {
  return arguments.length ? (this._x = _, this) : this._x;
}

function defaultY(d) {
  return d[1];
}

function tree_y(_) {
  return arguments.length ? (this._y = _, this) : this._y;
}

function quadtree(nodes, x, y) {
  var tree = new Quadtree(x == null ? defaultX : x, y == null ? defaultY : y, NaN, NaN, NaN, NaN);
  return nodes == null ? tree : tree.addAll(nodes);
}

function Quadtree(x, y, x0, y0, x1, y1) {
  this._x = x;
  this._y = y;
  this._x0 = x0;
  this._y0 = y0;
  this._x1 = x1;
  this._y1 = y1;
  this._root = undefined;
}

function leaf_copy(leaf) {
  var copy = {data: leaf.data}, next = copy;
  while (leaf = leaf.next) next = next.next = {data: leaf.data};
  return copy;
}

var treeProto = quadtree.prototype = Quadtree.prototype;

treeProto.copy = function() {
  var copy = new Quadtree(this._x, this._y, this._x0, this._y0, this._x1, this._y1),
      node = this._root,
      nodes,
      child;

  if (!node) return copy;

  if (!node.length) return copy._root = leaf_copy(node), copy;

  nodes = [{source: node, target: copy._root = new Array(4)}];
  while (node = nodes.pop()) {
    for (var i = 0; i < 4; ++i) {
      if (child = node.source[i]) {
        if (child.length) nodes.push({source: child, target: node.target[i] = new Array(4)});
        else node.target[i] = leaf_copy(child);
      }
    }
  }

  return copy;
};

treeProto.add = tree_add;
treeProto.addAll = addAll;
treeProto.cover = tree_cover;
treeProto.data = tree_data;
treeProto.extent = tree_extent;
treeProto.find = tree_find;
treeProto.remove = tree_remove;
treeProto.removeAll = removeAll;
treeProto.root = tree_root;
treeProto.size = tree_size;
treeProto.visit = tree_visit;
treeProto.visitAfter = tree_visitAfter;
treeProto.x = tree_x;
treeProto.y = tree_y;

function constant$4(x) {
  return function() {
    return x;
  };
}

function jiggle(random) {
  return (random() - 0.5) * 1e-6;
}

function x$3(d) {
  return d.x + d.vx;
}

function y$3(d) {
  return d.y + d.vy;
}

function collide(radius) {
  var nodes,
      radii,
      random,
      strength = 1,
      iterations = 1;

  if (typeof radius !== "function") radius = constant$4(radius == null ? 1 : +radius);

  function force() {
    var i, n = nodes.length,
        tree,
        node,
        xi,
        yi,
        ri,
        ri2;

    for (var k = 0; k < iterations; ++k) {
      tree = quadtree(nodes, x$3, y$3).visitAfter(prepare);
      for (i = 0; i < n; ++i) {
        node = nodes[i];
        ri = radii[node.index], ri2 = ri * ri;
        xi = node.x + node.vx;
        yi = node.y + node.vy;
        tree.visit(apply);
      }
    }

    function apply(quad, x0, y0, x1, y1) {
      var data = quad.data, rj = quad.r, r = ri + rj;
      if (data) {
        if (data.index > node.index) {
          var x = xi - data.x - data.vx,
              y = yi - data.y - data.vy,
              l = x * x + y * y;
          if (l < r * r) {
            if (x === 0) x = jiggle(random), l += x * x;
            if (y === 0) y = jiggle(random), l += y * y;
            l = (r - (l = Math.sqrt(l))) / l * strength;
            node.vx += (x *= l) * (r = (rj *= rj) / (ri2 + rj));
            node.vy += (y *= l) * r;
            data.vx -= x * (r = 1 - r);
            data.vy -= y * r;
          }
        }
        return;
      }
      return x0 > xi + r || x1 < xi - r || y0 > yi + r || y1 < yi - r;
    }
  }

  function prepare(quad) {
    if (quad.data) return quad.r = radii[quad.data.index];
    for (var i = quad.r = 0; i < 4; ++i) {
      if (quad[i] && quad[i].r > quad.r) {
        quad.r = quad[i].r;
      }
    }
  }

  function initialize() {
    if (!nodes) return;
    var i, n = nodes.length, node;
    radii = new Array(n);
    for (i = 0; i < n; ++i) node = nodes[i], radii[node.index] = +radius(node, i, nodes);
  }

  force.initialize = function(_nodes, _random) {
    nodes = _nodes;
    random = _random;
    initialize();
  };

  force.iterations = function(_) {
    return arguments.length ? (iterations = +_, force) : iterations;
  };

  force.strength = function(_) {
    return arguments.length ? (strength = +_, force) : strength;
  };

  force.radius = function(_) {
    return arguments.length ? (radius = typeof _ === "function" ? _ : constant$4(+_), initialize(), force) : radius;
  };

  return force;
}

function index$5(d) {
  return d.index;
}

function find(nodeById, nodeId) {
  var node = nodeById.get(nodeId);
  if (!node) throw new Error("node not found: " + nodeId);
  return node;
}

function link$2(links) {
  var id = index$5,
      strength = defaultStrength,
      strengths,
      distance = constant$4(30),
      distances,
      nodes,
      count,
      bias,
      random,
      iterations = 1;

  if (links == null) links = [];

  function defaultStrength(link) {
    return 1 / Math.min(count[link.source.index], count[link.target.index]);
  }

  function force(alpha) {
    for (var k = 0, n = links.length; k < iterations; ++k) {
      for (var i = 0, link, source, target, x, y, l, b; i < n; ++i) {
        link = links[i], source = link.source, target = link.target;
        x = target.x + target.vx - source.x - source.vx || jiggle(random);
        y = target.y + target.vy - source.y - source.vy || jiggle(random);
        l = Math.sqrt(x * x + y * y);
        l = (l - distances[i]) / l * alpha * strengths[i];
        x *= l, y *= l;
        target.vx -= x * (b = bias[i]);
        target.vy -= y * b;
        source.vx += x * (b = 1 - b);
        source.vy += y * b;
      }
    }
  }

  function initialize() {
    if (!nodes) return;

    var i,
        n = nodes.length,
        m = links.length,
        nodeById = new Map(nodes.map((d, i) => [id(d, i, nodes), d])),
        link;

    for (i = 0, count = new Array(n); i < m; ++i) {
      link = links[i], link.index = i;
      if (typeof link.source !== "object") link.source = find(nodeById, link.source);
      if (typeof link.target !== "object") link.target = find(nodeById, link.target);
      count[link.source.index] = (count[link.source.index] || 0) + 1;
      count[link.target.index] = (count[link.target.index] || 0) + 1;
    }

    for (i = 0, bias = new Array(m); i < m; ++i) {
      link = links[i], bias[i] = count[link.source.index] / (count[link.source.index] + count[link.target.index]);
    }

    strengths = new Array(m), initializeStrength();
    distances = new Array(m), initializeDistance();
  }

  function initializeStrength() {
    if (!nodes) return;

    for (var i = 0, n = links.length; i < n; ++i) {
      strengths[i] = +strength(links[i], i, links);
    }
  }

  function initializeDistance() {
    if (!nodes) return;

    for (var i = 0, n = links.length; i < n; ++i) {
      distances[i] = +distance(links[i], i, links);
    }
  }

  force.initialize = function(_nodes, _random) {
    nodes = _nodes;
    random = _random;
    initialize();
  };

  force.links = function(_) {
    return arguments.length ? (links = _, initialize(), force) : links;
  };

  force.id = function(_) {
    return arguments.length ? (id = _, force) : id;
  };

  force.iterations = function(_) {
    return arguments.length ? (iterations = +_, force) : iterations;
  };

  force.strength = function(_) {
    return arguments.length ? (strength = typeof _ === "function" ? _ : constant$4(+_), initializeStrength(), force) : strength;
  };

  force.distance = function(_) {
    return arguments.length ? (distance = typeof _ === "function" ? _ : constant$4(+_), initializeDistance(), force) : distance;
  };

  return force;
}

// https://en.wikipedia.org/wiki/Linear_congruential_generator#Parameters_in_common_use
const a$2 = 1664525;
const c$4 = 1013904223;
const m$1 = 4294967296; // 2^32

function lcg$2() {
  let s = 1;
  return () => (s = (a$2 * s + c$4) % m$1) / m$1;
}

function x$2(d) {
  return d.x;
}

function y$2(d) {
  return d.y;
}

var initialRadius = 10,
    initialAngle = Math.PI * (3 - Math.sqrt(5));

function simulation(nodes) {
  var simulation,
      alpha = 1,
      alphaMin = 0.001,
      alphaDecay = 1 - Math.pow(alphaMin, 1 / 300),
      alphaTarget = 0,
      velocityDecay = 0.6,
      forces = new Map(),
      stepper = timer(step),
      event = dispatch("tick", "end"),
      random = lcg$2();

  if (nodes == null) nodes = [];

  function step() {
    tick();
    event.call("tick", simulation);
    if (alpha < alphaMin) {
      stepper.stop();
      event.call("end", simulation);
    }
  }

  function tick(iterations) {
    var i, n = nodes.length, node;

    if (iterations === undefined) iterations = 1;

    for (var k = 0; k < iterations; ++k) {
      alpha += (alphaTarget - alpha) * alphaDecay;

      forces.forEach(function(force) {
        force(alpha);
      });

      for (i = 0; i < n; ++i) {
        node = nodes[i];
        if (node.fx == null) node.x += node.vx *= velocityDecay;
        else node.x = node.fx, node.vx = 0;
        if (node.fy == null) node.y += node.vy *= velocityDecay;
        else node.y = node.fy, node.vy = 0;
      }
    }

    return simulation;
  }

  function initializeNodes() {
    for (var i = 0, n = nodes.length, node; i < n; ++i) {
      node = nodes[i], node.index = i;
      if (node.fx != null) node.x = node.fx;
      if (node.fy != null) node.y = node.fy;
      if (isNaN(node.x) || isNaN(node.y)) {
        var radius = initialRadius * Math.sqrt(0.5 + i), angle = i * initialAngle;
        node.x = radius * Math.cos(angle);
        node.y = radius * Math.sin(angle);
      }
      if (isNaN(node.vx) || isNaN(node.vy)) {
        node.vx = node.vy = 0;
      }
    }
  }

  function initializeForce(force) {
    if (force.initialize) force.initialize(nodes, random);
    return force;
  }

  initializeNodes();

  return simulation = {
    tick: tick,

    restart: function() {
      return stepper.restart(step), simulation;
    },

    stop: function() {
      return stepper.stop(), simulation;
    },

    nodes: function(_) {
      return arguments.length ? (nodes = _, initializeNodes(), forces.forEach(initializeForce), simulation) : nodes;
    },

    alpha: function(_) {
      return arguments.length ? (alpha = +_, simulation) : alpha;
    },

    alphaMin: function(_) {
      return arguments.length ? (alphaMin = +_, simulation) : alphaMin;
    },

    alphaDecay: function(_) {
      return arguments.length ? (alphaDecay = +_, simulation) : +alphaDecay;
    },

    alphaTarget: function(_) {
      return arguments.length ? (alphaTarget = +_, simulation) : alphaTarget;
    },

    velocityDecay: function(_) {
      return arguments.length ? (velocityDecay = 1 - _, simulation) : 1 - velocityDecay;
    },

    randomSource: function(_) {
      return arguments.length ? (random = _, forces.forEach(initializeForce), simulation) : random;
    },

    force: function(name, _) {
      return arguments.length > 1 ? ((_ == null ? forces.delete(name) : forces.set(name, initializeForce(_))), simulation) : forces.get(name);
    },

    find: function(x, y, radius) {
      var i = 0,
          n = nodes.length,
          dx,
          dy,
          d2,
          node,
          closest;

      if (radius == null) radius = Infinity;
      else radius *= radius;

      for (i = 0; i < n; ++i) {
        node = nodes[i];
        dx = x - node.x;
        dy = y - node.y;
        d2 = dx * dx + dy * dy;
        if (d2 < radius) closest = node, radius = d2;
      }

      return closest;
    },

    on: function(name, _) {
      return arguments.length > 1 ? (event.on(name, _), simulation) : event.on(name);
    }
  };
}

function manyBody() {
  var nodes,
      node,
      random,
      alpha,
      strength = constant$4(-30),
      strengths,
      distanceMin2 = 1,
      distanceMax2 = Infinity,
      theta2 = 0.81;

  function force(_) {
    var i, n = nodes.length, tree = quadtree(nodes, x$2, y$2).visitAfter(accumulate);
    for (alpha = _, i = 0; i < n; ++i) node = nodes[i], tree.visit(apply);
  }

  function initialize() {
    if (!nodes) return;
    var i, n = nodes.length, node;
    strengths = new Array(n);
    for (i = 0; i < n; ++i) node = nodes[i], strengths[node.index] = +strength(node, i, nodes);
  }

  function accumulate(quad) {
    var strength = 0, q, c, weight = 0, x, y, i;

    // For internal nodes, accumulate forces from child quadrants.
    if (quad.length) {
      for (x = y = i = 0; i < 4; ++i) {
        if ((q = quad[i]) && (c = Math.abs(q.value))) {
          strength += q.value, weight += c, x += c * q.x, y += c * q.y;
        }
      }
      quad.x = x / weight;
      quad.y = y / weight;
    }

    // For leaf nodes, accumulate forces from coincident quadrants.
    else {
      q = quad;
      q.x = q.data.x;
      q.y = q.data.y;
      do strength += strengths[q.data.index];
      while (q = q.next);
    }

    quad.value = strength;
  }

  function apply(quad, x1, _, x2) {
    if (!quad.value) return true;

    var x = quad.x - node.x,
        y = quad.y - node.y,
        w = x2 - x1,
        l = x * x + y * y;

    // Apply the Barnes-Hut approximation if possible.
    // Limit forces for very close nodes; randomize direction if coincident.
    if (w * w / theta2 < l) {
      if (l < distanceMax2) {
        if (x === 0) x = jiggle(random), l += x * x;
        if (y === 0) y = jiggle(random), l += y * y;
        if (l < distanceMin2) l = Math.sqrt(distanceMin2 * l);
        node.vx += x * quad.value * alpha / l;
        node.vy += y * quad.value * alpha / l;
      }
      return true;
    }

    // Otherwise, process points directly.
    else if (quad.length || l >= distanceMax2) return;

    // Limit forces for very close nodes; randomize direction if coincident.
    if (quad.data !== node || quad.next) {
      if (x === 0) x = jiggle(random), l += x * x;
      if (y === 0) y = jiggle(random), l += y * y;
      if (l < distanceMin2) l = Math.sqrt(distanceMin2 * l);
    }

    do if (quad.data !== node) {
      w = strengths[quad.data.index] * alpha / l;
      node.vx += x * w;
      node.vy += y * w;
    } while (quad = quad.next);
  }

  force.initialize = function(_nodes, _random) {
    nodes = _nodes;
    random = _random;
    initialize();
  };

  force.strength = function(_) {
    return arguments.length ? (strength = typeof _ === "function" ? _ : constant$4(+_), initialize(), force) : strength;
  };

  force.distanceMin = function(_) {
    return arguments.length ? (distanceMin2 = _ * _, force) : Math.sqrt(distanceMin2);
  };

  force.distanceMax = function(_) {
    return arguments.length ? (distanceMax2 = _ * _, force) : Math.sqrt(distanceMax2);
  };

  force.theta = function(_) {
    return arguments.length ? (theta2 = _ * _, force) : Math.sqrt(theta2);
  };

  return force;
}

function radial$1(radius, x, y) {
  var nodes,
      strength = constant$4(0.1),
      strengths,
      radiuses;

  if (typeof radius !== "function") radius = constant$4(+radius);
  if (x == null) x = 0;
  if (y == null) y = 0;

  function force(alpha) {
    for (var i = 0, n = nodes.length; i < n; ++i) {
      var node = nodes[i],
          dx = node.x - x || 1e-6,
          dy = node.y - y || 1e-6,
          r = Math.sqrt(dx * dx + dy * dy),
          k = (radiuses[i] - r) * strengths[i] * alpha / r;
      node.vx += dx * k;
      node.vy += dy * k;
    }
  }

  function initialize() {
    if (!nodes) return;
    var i, n = nodes.length;
    strengths = new Array(n);
    radiuses = new Array(n);
    for (i = 0; i < n; ++i) {
      radiuses[i] = +radius(nodes[i], i, nodes);
      strengths[i] = isNaN(radiuses[i]) ? 0 : +strength(nodes[i], i, nodes);
    }
  }

  force.initialize = function(_) {
    nodes = _, initialize();
  };

  force.strength = function(_) {
    return arguments.length ? (strength = typeof _ === "function" ? _ : constant$4(+_), initialize(), force) : strength;
  };

  force.radius = function(_) {
    return arguments.length ? (radius = typeof _ === "function" ? _ : constant$4(+_), initialize(), force) : radius;
  };

  force.x = function(_) {
    return arguments.length ? (x = +_, force) : x;
  };

  force.y = function(_) {
    return arguments.length ? (y = +_, force) : y;
  };

  return force;
}

function x$1(x) {
  var strength = constant$4(0.1),
      nodes,
      strengths,
      xz;

  if (typeof x !== "function") x = constant$4(x == null ? 0 : +x);

  function force(alpha) {
    for (var i = 0, n = nodes.length, node; i < n; ++i) {
      node = nodes[i], node.vx += (xz[i] - node.x) * strengths[i] * alpha;
    }
  }

  function initialize() {
    if (!nodes) return;
    var i, n = nodes.length;
    strengths = new Array(n);
    xz = new Array(n);
    for (i = 0; i < n; ++i) {
      strengths[i] = isNaN(xz[i] = +x(nodes[i], i, nodes)) ? 0 : +strength(nodes[i], i, nodes);
    }
  }

  force.initialize = function(_) {
    nodes = _;
    initialize();
  };

  force.strength = function(_) {
    return arguments.length ? (strength = typeof _ === "function" ? _ : constant$4(+_), initialize(), force) : strength;
  };

  force.x = function(_) {
    return arguments.length ? (x = typeof _ === "function" ? _ : constant$4(+_), initialize(), force) : x;
  };

  return force;
}

function y$1(y) {
  var strength = constant$4(0.1),
      nodes,
      strengths,
      yz;

  if (typeof y !== "function") y = constant$4(y == null ? 0 : +y);

  function force(alpha) {
    for (var i = 0, n = nodes.length, node; i < n; ++i) {
      node = nodes[i], node.vy += (yz[i] - node.y) * strengths[i] * alpha;
    }
  }

  function initialize() {
    if (!nodes) return;
    var i, n = nodes.length;
    strengths = new Array(n);
    yz = new Array(n);
    for (i = 0; i < n; ++i) {
      strengths[i] = isNaN(yz[i] = +y(nodes[i], i, nodes)) ? 0 : +strength(nodes[i], i, nodes);
    }
  }

  force.initialize = function(_) {
    nodes = _;
    initialize();
  };

  force.strength = function(_) {
    return arguments.length ? (strength = typeof _ === "function" ? _ : constant$4(+_), initialize(), force) : strength;
  };

  force.y = function(_) {
    return arguments.length ? (y = typeof _ === "function" ? _ : constant$4(+_), initialize(), force) : y;
  };

  return force;
}

function formatDecimal(x) {
  return Math.abs(x = Math.round(x)) >= 1e21
      ? x.toLocaleString("en").replace(/,/g, "")
      : x.toString(10);
}

// Computes the decimal coefficient and exponent of the specified number x with
// significant digits p, where x is positive and p is in [1, 21] or undefined.
// For example, formatDecimalParts(1.23) returns ["123", 0].
function formatDecimalParts(x, p) {
  if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf("e")) < 0) return null; // NaN, ±Infinity
  var i, coefficient = x.slice(0, i);

  // The string returned by toExponential either has the form \d\.\d+e[-+]\d+
  // (e.g., 1.2e+3) or the form \de[-+]\d+ (e.g., 1e+3).
  return [
    coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient,
    +x.slice(i + 1)
  ];
}

function exponent(x) {
  return x = formatDecimalParts(Math.abs(x)), x ? x[1] : NaN;
}

function formatGroup(grouping, thousands) {
  return function(value, width) {
    var i = value.length,
        t = [],
        j = 0,
        g = grouping[0],
        length = 0;

    while (i > 0 && g > 0) {
      if (length + g + 1 > width) g = Math.max(1, width - length);
      t.push(value.substring(i -= g, i + g));
      if ((length += g + 1) > width) break;
      g = grouping[j = (j + 1) % grouping.length];
    }

    return t.reverse().join(thousands);
  };
}

function formatNumerals(numerals) {
  return function(value) {
    return value.replace(/[0-9]/g, function(i) {
      return numerals[+i];
    });
  };
}

// [[fill]align][sign][symbol][0][width][,][.precision][~][type]
var re = /^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;

function formatSpecifier(specifier) {
  if (!(match = re.exec(specifier))) throw new Error("invalid format: " + specifier);
  var match;
  return new FormatSpecifier({
    fill: match[1],
    align: match[2],
    sign: match[3],
    symbol: match[4],
    zero: match[5],
    width: match[6],
    comma: match[7],
    precision: match[8] && match[8].slice(1),
    trim: match[9],
    type: match[10]
  });
}

formatSpecifier.prototype = FormatSpecifier.prototype; // instanceof

function FormatSpecifier(specifier) {
  this.fill = specifier.fill === undefined ? " " : specifier.fill + "";
  this.align = specifier.align === undefined ? ">" : specifier.align + "";
  this.sign = specifier.sign === undefined ? "-" : specifier.sign + "";
  this.symbol = specifier.symbol === undefined ? "" : specifier.symbol + "";
  this.zero = !!specifier.zero;
  this.width = specifier.width === undefined ? undefined : +specifier.width;
  this.comma = !!specifier.comma;
  this.precision = specifier.precision === undefined ? undefined : +specifier.precision;
  this.trim = !!specifier.trim;
  this.type = specifier.type === undefined ? "" : specifier.type + "";
}

FormatSpecifier.prototype.toString = function() {
  return this.fill
      + this.align
      + this.sign
      + this.symbol
      + (this.zero ? "0" : "")
      + (this.width === undefined ? "" : Math.max(1, this.width | 0))
      + (this.comma ? "," : "")
      + (this.precision === undefined ? "" : "." + Math.max(0, this.precision | 0))
      + (this.trim ? "~" : "")
      + this.type;
};

// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.
function formatTrim(s) {
  out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {
    switch (s[i]) {
      case ".": i0 = i1 = i; break;
      case "0": if (i0 === 0) i0 = i; i1 = i; break;
      default: if (!+s[i]) break out; if (i0 > 0) i0 = 0; break;
    }
  }
  return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;
}

var prefixExponent;

function formatPrefixAuto(x, p) {
  var d = formatDecimalParts(x, p);
  if (!d) return x + "";
  var coefficient = d[0],
      exponent = d[1],
      i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,
      n = coefficient.length;
  return i === n ? coefficient
      : i > n ? coefficient + new Array(i - n + 1).join("0")
      : i > 0 ? coefficient.slice(0, i) + "." + coefficient.slice(i)
      : "0." + new Array(1 - i).join("0") + formatDecimalParts(x, Math.max(0, p + i - 1))[0]; // less than 1y!
}

function formatRounded(x, p) {
  var d = formatDecimalParts(x, p);
  if (!d) return x + "";
  var coefficient = d[0],
      exponent = d[1];
  return exponent < 0 ? "0." + new Array(-exponent).join("0") + coefficient
      : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + "." + coefficient.slice(exponent + 1)
      : coefficient + new Array(exponent - coefficient.length + 2).join("0");
}

var formatTypes = {
  "%": (x, p) => (x * 100).toFixed(p),
  "b": (x) => Math.round(x).toString(2),
  "c": (x) => x + "",
  "d": formatDecimal,
  "e": (x, p) => x.toExponential(p),
  "f": (x, p) => x.toFixed(p),
  "g": (x, p) => x.toPrecision(p),
  "o": (x) => Math.round(x).toString(8),
  "p": (x, p) => formatRounded(x * 100, p),
  "r": formatRounded,
  "s": formatPrefixAuto,
  "X": (x) => Math.round(x).toString(16).toUpperCase(),
  "x": (x) => Math.round(x).toString(16)
};

function identity$6(x) {
  return x;
}

var map = Array.prototype.map,
    prefixes = ["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];

function formatLocale$1(locale) {
  var group = locale.grouping === undefined || locale.thousands === undefined ? identity$6 : formatGroup(map.call(locale.grouping, Number), locale.thousands + ""),
      currencyPrefix = locale.currency === undefined ? "" : locale.currency[0] + "",
      currencySuffix = locale.currency === undefined ? "" : locale.currency[1] + "",
      decimal = locale.decimal === undefined ? "." : locale.decimal + "",
      numerals = locale.numerals === undefined ? identity$6 : formatNumerals(map.call(locale.numerals, String)),
      percent = locale.percent === undefined ? "%" : locale.percent + "",
      minus = locale.minus === undefined ? "−" : locale.minus + "",
      nan = locale.nan === undefined ? "NaN" : locale.nan + "";

  function newFormat(specifier) {
    specifier = formatSpecifier(specifier);

    var fill = specifier.fill,
        align = specifier.align,
        sign = specifier.sign,
        symbol = specifier.symbol,
        zero = specifier.zero,
        width = specifier.width,
        comma = specifier.comma,
        precision = specifier.precision,
        trim = specifier.trim,
        type = specifier.type;

    // The "n" type is an alias for ",g".
    if (type === "n") comma = true, type = "g";

    // The "" type, and any invalid type, is an alias for ".12~g".
    else if (!formatTypes[type]) precision === undefined && (precision = 12), trim = true, type = "g";

    // If zero fill is specified, padding goes after sign and before digits.
    if (zero || (fill === "0" && align === "=")) zero = true, fill = "0", align = "=";

    // Compute the prefix and suffix.
    // For SI-prefix, the suffix is lazily computed.
    var prefix = symbol === "$" ? currencyPrefix : symbol === "#" && /[boxX]/.test(type) ? "0" + type.toLowerCase() : "",
        suffix = symbol === "$" ? currencySuffix : /[%p]/.test(type) ? percent : "";

    // What format function should we use?
    // Is this an integer type?
    // Can this type generate exponential notation?
    var formatType = formatTypes[type],
        maybeSuffix = /[defgprs%]/.test(type);

    // Set the default precision if not specified,
    // or clamp the specified precision to the supported range.
    // For significant precision, it must be in [1, 21].
    // For fixed precision, it must be in [0, 20].
    precision = precision === undefined ? 6
        : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision))
        : Math.max(0, Math.min(20, precision));

    function format(value) {
      var valuePrefix = prefix,
          valueSuffix = suffix,
          i, n, c;

      if (type === "c") {
        valueSuffix = formatType(value) + valueSuffix;
        value = "";
      } else {
        value = +value;

        // Determine the sign. -0 is not less than 0, but 1 / -0 is!
        var valueNegative = value < 0 || 1 / value < 0;

        // Perform the initial formatting.
        value = isNaN(value) ? nan : formatType(Math.abs(value), precision);

        // Trim insignificant zeros.
        if (trim) value = formatTrim(value);

        // If a negative value rounds to zero after formatting, and no explicit positive sign is requested, hide the sign.
        if (valueNegative && +value === 0 && sign !== "+") valueNegative = false;

        // Compute the prefix and suffix.
        valuePrefix = (valueNegative ? (sign === "(" ? sign : minus) : sign === "-" || sign === "(" ? "" : sign) + valuePrefix;
        valueSuffix = (type === "s" ? prefixes[8 + prefixExponent / 3] : "") + valueSuffix + (valueNegative && sign === "(" ? ")" : "");

        // Break the formatted value into the integer “value” part that can be
        // grouped, and fractional or exponential “suffix” part that is not.
        if (maybeSuffix) {
          i = -1, n = value.length;
          while (++i < n) {
            if (c = value.charCodeAt(i), 48 > c || c > 57) {
              valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;
              value = value.slice(0, i);
              break;
            }
          }
        }
      }

      // If the fill character is not "0", grouping is applied before padding.
      if (comma && !zero) value = group(value, Infinity);

      // Compute the padding.
      var length = valuePrefix.length + value.length + valueSuffix.length,
          padding = length < width ? new Array(width - length + 1).join(fill) : "";

      // If the fill character is "0", grouping is applied after padding.
      if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = "";

      // Reconstruct the final output based on the desired alignment.
      switch (align) {
        case "<": value = valuePrefix + value + valueSuffix + padding; break;
        case "=": value = valuePrefix + padding + value + valueSuffix; break;
        case "^": value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length); break;
        default: value = padding + valuePrefix + value + valueSuffix; break;
      }

      return numerals(value);
    }

    format.toString = function() {
      return specifier + "";
    };

    return format;
  }

  function formatPrefix(specifier, value) {
    var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = "f", specifier)),
        e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,
        k = Math.pow(10, -e),
        prefix = prefixes[8 + e / 3];
    return function(value) {
      return f(k * value) + prefix;
    };
  }

  return {
    format: newFormat,
    formatPrefix: formatPrefix
  };
}

var locale$1;
var format;
var formatPrefix;

defaultLocale$1({
  thousands: ",",
  grouping: [3],
  currency: ["$", ""]
});

function defaultLocale$1(definition) {
  locale$1 = formatLocale$1(definition);
  format = locale$1.format;
  formatPrefix = locale$1.formatPrefix;
  return locale$1;
}

function precisionFixed(step) {
  return Math.max(0, -exponent(Math.abs(step)));
}

function precisionPrefix(step, value) {
  return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));
}

function precisionRound(step, max) {
  step = Math.abs(step), max = Math.abs(max) - step;
  return Math.max(0, exponent(max) - exponent(step)) + 1;
}

var epsilon$1 = 1e-6;
var epsilon2 = 1e-12;
var pi$1 = Math.PI;
var halfPi$1 = pi$1 / 2;
var quarterPi = pi$1 / 4;
var tau$1 = pi$1 * 2;

var degrees = 180 / pi$1;
var radians = pi$1 / 180;

var abs$1 = Math.abs;
var atan = Math.atan;
var atan2$1 = Math.atan2;
var cos$1 = Math.cos;
var ceil = Math.ceil;
var exp = Math.exp;
var hypot = Math.hypot;
var log$1 = Math.log;
var pow$1 = Math.pow;
var sin$1 = Math.sin;
var sign$1 = Math.sign || function(x) { return x > 0 ? 1 : x < 0 ? -1 : 0; };
var sqrt$2 = Math.sqrt;
var tan = Math.tan;

function acos$1(x) {
  return x > 1 ? 0 : x < -1 ? pi$1 : Math.acos(x);
}

function asin$1(x) {
  return x > 1 ? halfPi$1 : x < -1 ? -halfPi$1 : Math.asin(x);
}

function haversin(x) {
  return (x = sin$1(x / 2)) * x;
}

function noop$1() {}

function streamGeometry(geometry, stream) {
  if (geometry && streamGeometryType.hasOwnProperty(geometry.type)) {
    streamGeometryType[geometry.type](geometry, stream);
  }
}

var streamObjectType = {
  Feature: function(object, stream) {
    streamGeometry(object.geometry, stream);
  },
  FeatureCollection: function(object, stream) {
    var features = object.features, i = -1, n = features.length;
    while (++i < n) streamGeometry(features[i].geometry, stream);
  }
};

var streamGeometryType = {
  Sphere: function(object, stream) {
    stream.sphere();
  },
  Point: function(object, stream) {
    object = object.coordinates;
    stream.point(object[0], object[1], object[2]);
  },
  MultiPoint: function(object, stream) {
    var coordinates = object.coordinates, i = -1, n = coordinates.length;
    while (++i < n) object = coordinates[i], stream.point(object[0], object[1], object[2]);
  },
  LineString: function(object, stream) {
    streamLine(object.coordinates, stream, 0);
  },
  MultiLineString: function(object, stream) {
    var coordinates = object.coordinates, i = -1, n = coordinates.length;
    while (++i < n) streamLine(coordinates[i], stream, 0);
  },
  Polygon: function(object, stream) {
    streamPolygon(object.coordinates, stream);
  },
  MultiPolygon: function(object, stream) {
    var coordinates = object.coordinates, i = -1, n = coordinates.length;
    while (++i < n) streamPolygon(coordinates[i], stream);
  },
  GeometryCollection: function(object, stream) {
    var geometries = object.geometries, i = -1, n = geometries.length;
    while (++i < n) streamGeometry(geometries[i], stream);
  }
};

function streamLine(coordinates, stream, closed) {
  var i = -1, n = coordinates.length - closed, coordinate;
  stream.lineStart();
  while (++i < n) coordinate = coordinates[i], stream.point(coordinate[0], coordinate[1], coordinate[2]);
  stream.lineEnd();
}

function streamPolygon(coordinates, stream) {
  var i = -1, n = coordinates.length;
  stream.polygonStart();
  while (++i < n) streamLine(coordinates[i], stream, 1);
  stream.polygonEnd();
}

function geoStream(object, stream) {
  if (object && streamObjectType.hasOwnProperty(object.type)) {
    streamObjectType[object.type](object, stream);
  } else {
    streamGeometry(object, stream);
  }
}

var areaRingSum$1 = new Adder();

// hello?

var areaSum$1 = new Adder(),
    lambda00$2,
    phi00$2,
    lambda0$2,
    cosPhi0$1,
    sinPhi0$1;

var areaStream$1 = {
  point: noop$1,
  lineStart: noop$1,
  lineEnd: noop$1,
  polygonStart: function() {
    areaRingSum$1 = new Adder();
    areaStream$1.lineStart = areaRingStart$1;
    areaStream$1.lineEnd = areaRingEnd$1;
  },
  polygonEnd: function() {
    var areaRing = +areaRingSum$1;
    areaSum$1.add(areaRing < 0 ? tau$1 + areaRing : areaRing);
    this.lineStart = this.lineEnd = this.point = noop$1;
  },
  sphere: function() {
    areaSum$1.add(tau$1);
  }
};

function areaRingStart$1() {
  areaStream$1.point = areaPointFirst$1;
}

function areaRingEnd$1() {
  areaPoint$1(lambda00$2, phi00$2);
}

function areaPointFirst$1(lambda, phi) {
  areaStream$1.point = areaPoint$1;
  lambda00$2 = lambda, phi00$2 = phi;
  lambda *= radians, phi *= radians;
  lambda0$2 = lambda, cosPhi0$1 = cos$1(phi = phi / 2 + quarterPi), sinPhi0$1 = sin$1(phi);
}

function areaPoint$1(lambda, phi) {
  lambda *= radians, phi *= radians;
  phi = phi / 2 + quarterPi; // half the angular distance from south pole

  // Spherical excess E for a spherical triangle with vertices: south pole,
  // previous point, current point.  Uses a formula derived from Cagnoli’s
  // theorem.  See Todhunter, Spherical Trig. (1871), Sec. 103, Eq. (2).
  var dLambda = lambda - lambda0$2,
      sdLambda = dLambda >= 0 ? 1 : -1,
      adLambda = sdLambda * dLambda,
      cosPhi = cos$1(phi),
      sinPhi = sin$1(phi),
      k = sinPhi0$1 * sinPhi,
      u = cosPhi0$1 * cosPhi + k * cos$1(adLambda),
      v = k * sdLambda * sin$1(adLambda);
  areaRingSum$1.add(atan2$1(v, u));

  // Advance the previous points.
  lambda0$2 = lambda, cosPhi0$1 = cosPhi, sinPhi0$1 = sinPhi;
}

function area$2(object) {
  areaSum$1 = new Adder();
  geoStream(object, areaStream$1);
  return areaSum$1 * 2;
}

function spherical(cartesian) {
  return [atan2$1(cartesian[1], cartesian[0]), asin$1(cartesian[2])];
}

function cartesian(spherical) {
  var lambda = spherical[0], phi = spherical[1], cosPhi = cos$1(phi);
  return [cosPhi * cos$1(lambda), cosPhi * sin$1(lambda), sin$1(phi)];
}

function cartesianDot(a, b) {
  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
}

function cartesianCross(a, b) {
  return [a[1] * b[2] - a[2] * b[1], a[2] * b[0] - a[0] * b[2], a[0] * b[1] - a[1] * b[0]];
}

// TODO return a
function cartesianAddInPlace(a, b) {
  a[0] += b[0], a[1] += b[1], a[2] += b[2];
}

function cartesianScale(vector, k) {
  return [vector[0] * k, vector[1] * k, vector[2] * k];
}

// TODO return d
function cartesianNormalizeInPlace(d) {
  var l = sqrt$2(d[0] * d[0] + d[1] * d[1] + d[2] * d[2]);
  d[0] /= l, d[1] /= l, d[2] /= l;
}

var lambda0$1, phi0, lambda1, phi1, // bounds
    lambda2, // previous lambda-coordinate
    lambda00$1, phi00$1, // first point
    p0, // previous 3D point
    deltaSum,
    ranges,
    range;

var boundsStream$2 = {
  point: boundsPoint$1,
  lineStart: boundsLineStart,
  lineEnd: boundsLineEnd,
  polygonStart: function() {
    boundsStream$2.point = boundsRingPoint;
    boundsStream$2.lineStart = boundsRingStart;
    boundsStream$2.lineEnd = boundsRingEnd;
    deltaSum = new Adder();
    areaStream$1.polygonStart();
  },
  polygonEnd: function() {
    areaStream$1.polygonEnd();
    boundsStream$2.point = boundsPoint$1;
    boundsStream$2.lineStart = boundsLineStart;
    boundsStream$2.lineEnd = boundsLineEnd;
    if (areaRingSum$1 < 0) lambda0$1 = -(lambda1 = 180), phi0 = -(phi1 = 90);
    else if (deltaSum > epsilon$1) phi1 = 90;
    else if (deltaSum < -epsilon$1) phi0 = -90;
    range[0] = lambda0$1, range[1] = lambda1;
  },
  sphere: function() {
    lambda0$1 = -(lambda1 = 180), phi0 = -(phi1 = 90);
  }
};

function boundsPoint$1(lambda, phi) {
  ranges.push(range = [lambda0$1 = lambda, lambda1 = lambda]);
  if (phi < phi0) phi0 = phi;
  if (phi > phi1) phi1 = phi;
}

function linePoint(lambda, phi) {
  var p = cartesian([lambda * radians, phi * radians]);
  if (p0) {
    var normal = cartesianCross(p0, p),
        equatorial = [normal[1], -normal[0], 0],
        inflection = cartesianCross(equatorial, normal);
    cartesianNormalizeInPlace(inflection);
    inflection = spherical(inflection);
    var delta = lambda - lambda2,
        sign = delta > 0 ? 1 : -1,
        lambdai = inflection[0] * degrees * sign,
        phii,
        antimeridian = abs$1(delta) > 180;
    if (antimeridian ^ (sign * lambda2 < lambdai && lambdai < sign * lambda)) {
      phii = inflection[1] * degrees;
      if (phii > phi1) phi1 = phii;
    } else if (lambdai = (lambdai + 360) % 360 - 180, antimeridian ^ (sign * lambda2 < lambdai && lambdai < sign * lambda)) {
      phii = -inflection[1] * degrees;
      if (phii < phi0) phi0 = phii;
    } else {
      if (phi < phi0) phi0 = phi;
      if (phi > phi1) phi1 = phi;
    }
    if (antimeridian) {
      if (lambda < lambda2) {
        if (angle(lambda0$1, lambda) > angle(lambda0$1, lambda1)) lambda1 = lambda;
      } else {
        if (angle(lambda, lambda1) > angle(lambda0$1, lambda1)) lambda0$1 = lambda;
      }
    } else {
      if (lambda1 >= lambda0$1) {
        if (lambda < lambda0$1) lambda0$1 = lambda;
        if (lambda > lambda1) lambda1 = lambda;
      } else {
        if (lambda > lambda2) {
          if (angle(lambda0$1, lambda) > angle(lambda0$1, lambda1)) lambda1 = lambda;
        } else {
          if (angle(lambda, lambda1) > angle(lambda0$1, lambda1)) lambda0$1 = lambda;
        }
      }
    }
  } else {
    ranges.push(range = [lambda0$1 = lambda, lambda1 = lambda]);
  }
  if (phi < phi0) phi0 = phi;
  if (phi > phi1) phi1 = phi;
  p0 = p, lambda2 = lambda;
}

function boundsLineStart() {
  boundsStream$2.point = linePoint;
}

function boundsLineEnd() {
  range[0] = lambda0$1, range[1] = lambda1;
  boundsStream$2.point = boundsPoint$1;
  p0 = null;
}

function boundsRingPoint(lambda, phi) {
  if (p0) {
    var delta = lambda - lambda2;
    deltaSum.add(abs$1(delta) > 180 ? delta + (delta > 0 ? 360 : -360) : delta);
  } else {
    lambda00$1 = lambda, phi00$1 = phi;
  }
  areaStream$1.point(lambda, phi);
  linePoint(lambda, phi);
}

function boundsRingStart() {
  areaStream$1.lineStart();
}

function boundsRingEnd() {
  boundsRingPoint(lambda00$1, phi00$1);
  areaStream$1.lineEnd();
  if (abs$1(deltaSum) > epsilon$1) lambda0$1 = -(lambda1 = 180);
  range[0] = lambda0$1, range[1] = lambda1;
  p0 = null;
}

// Finds the left-right distance between two longitudes.
// This is almost the same as (lambda1 - lambda0 + 360°) % 360°, except that we want
// the distance between ±180° to be 360°.
function angle(lambda0, lambda1) {
  return (lambda1 -= lambda0) < 0 ? lambda1 + 360 : lambda1;
}

function rangeCompare(a, b) {
  return a[0] - b[0];
}

function rangeContains(range, x) {
  return range[0] <= range[1] ? range[0] <= x && x <= range[1] : x < range[0] || range[1] < x;
}

function bounds(feature) {
  var i, n, a, b, merged, deltaMax, delta;

  phi1 = lambda1 = -(lambda0$1 = phi0 = Infinity);
  ranges = [];
  geoStream(feature, boundsStream$2);

  // First, sort ranges by their minimum longitudes.
  if (n = ranges.length) {
    ranges.sort(rangeCompare);

    // Then, merge any ranges that overlap.
    for (i = 1, a = ranges[0], merged = [a]; i < n; ++i) {
      b = ranges[i];
      if (rangeContains(a, b[0]) || rangeContains(a, b[1])) {
        if (angle(a[0], b[1]) > angle(a[0], a[1])) a[1] = b[1];
        if (angle(b[0], a[1]) > angle(a[0], a[1])) a[0] = b[0];
      } else {
        merged.push(a = b);
      }
    }

    // Finally, find the largest gap between the merged ranges.
    // The final bounding box will be the inverse of this gap.
    for (deltaMax = -Infinity, n = merged.length - 1, i = 0, a = merged[n]; i <= n; a = b, ++i) {
      b = merged[i];
      if ((delta = angle(a[1], b[0])) > deltaMax) deltaMax = delta, lambda0$1 = b[0], lambda1 = a[1];
    }
  }

  ranges = range = null;

  return lambda0$1 === Infinity || phi0 === Infinity
      ? [[NaN, NaN], [NaN, NaN]]
      : [[lambda0$1, phi0], [lambda1, phi1]];
}

var W0, W1,
    X0$1, Y0$1, Z0$1,
    X1$1, Y1$1, Z1$1,
    X2$1, Y2$1, Z2$1,
    lambda00, phi00, // first point
    x0$4, y0$4, z0; // previous point

var centroidStream$1 = {
  sphere: noop$1,
  point: centroidPoint$1,
  lineStart: centroidLineStart$1,
  lineEnd: centroidLineEnd$1,
  polygonStart: function() {
    centroidStream$1.lineStart = centroidRingStart$1;
    centroidStream$1.lineEnd = centroidRingEnd$1;
  },
  polygonEnd: function() {
    centroidStream$1.lineStart = centroidLineStart$1;
    centroidStream$1.lineEnd = centroidLineEnd$1;
  }
};

// Arithmetic mean of Cartesian vectors.
function centroidPoint$1(lambda, phi) {
  lambda *= radians, phi *= radians;
  var cosPhi = cos$1(phi);
  centroidPointCartesian(cosPhi * cos$1(lambda), cosPhi * sin$1(lambda), sin$1(phi));
}

function centroidPointCartesian(x, y, z) {
  ++W0;
  X0$1 += (x - X0$1) / W0;
  Y0$1 += (y - Y0$1) / W0;
  Z0$1 += (z - Z0$1) / W0;
}

function centroidLineStart$1() {
  centroidStream$1.point = centroidLinePointFirst;
}

function centroidLinePointFirst(lambda, phi) {
  lambda *= radians, phi *= radians;
  var cosPhi = cos$1(phi);
  x0$4 = cosPhi * cos$1(lambda);
  y0$4 = cosPhi * sin$1(lambda);
  z0 = sin$1(phi);
  centroidStream$1.point = centroidLinePoint;
  centroidPointCartesian(x0$4, y0$4, z0);
}

function centroidLinePoint(lambda, phi) {
  lambda *= radians, phi *= radians;
  var cosPhi = cos$1(phi),
      x = cosPhi * cos$1(lambda),
      y = cosPhi * sin$1(lambda),
      z = sin$1(phi),
      w = atan2$1(sqrt$2((w = y0$4 * z - z0 * y) * w + (w = z0 * x - x0$4 * z) * w + (w = x0$4 * y - y0$4 * x) * w), x0$4 * x + y0$4 * y + z0 * z);
  W1 += w;
  X1$1 += w * (x0$4 + (x0$4 = x));
  Y1$1 += w * (y0$4 + (y0$4 = y));
  Z1$1 += w * (z0 + (z0 = z));
  centroidPointCartesian(x0$4, y0$4, z0);
}

function centroidLineEnd$1() {
  centroidStream$1.point = centroidPoint$1;
}

// See J. E. Brock, The Inertia Tensor for a Spherical Triangle,
// J. Applied Mechanics 42, 239 (1975).
function centroidRingStart$1() {
  centroidStream$1.point = centroidRingPointFirst;
}

function centroidRingEnd$1() {
  centroidRingPoint(lambda00, phi00);
  centroidStream$1.point = centroidPoint$1;
}

function centroidRingPointFirst(lambda, phi) {
  lambda00 = lambda, phi00 = phi;
  lambda *= radians, phi *= radians;
  centroidStream$1.point = centroidRingPoint;
  var cosPhi = cos$1(phi);
  x0$4 = cosPhi * cos$1(lambda);
  y0$4 = cosPhi * sin$1(lambda);
  z0 = sin$1(phi);
  centroidPointCartesian(x0$4, y0$4, z0);
}

function centroidRingPoint(lambda, phi) {
  lambda *= radians, phi *= radians;
  var cosPhi = cos$1(phi),
      x = cosPhi * cos$1(lambda),
      y = cosPhi * sin$1(lambda),
      z = sin$1(phi),
      cx = y0$4 * z - z0 * y,
      cy = z0 * x - x0$4 * z,
      cz = x0$4 * y - y0$4 * x,
      m = hypot(cx, cy, cz),
      w = asin$1(m), // line weight = angle
      v = m && -w / m; // area weight multiplier
  X2$1.add(v * cx);
  Y2$1.add(v * cy);
  Z2$1.add(v * cz);
  W1 += w;
  X1$1 += w * (x0$4 + (x0$4 = x));
  Y1$1 += w * (y0$4 + (y0$4 = y));
  Z1$1 += w * (z0 + (z0 = z));
  centroidPointCartesian(x0$4, y0$4, z0);
}

function centroid$1(object) {
  W0 = W1 =
  X0$1 = Y0$1 = Z0$1 =
  X1$1 = Y1$1 = Z1$1 = 0;
  X2$1 = new Adder();
  Y2$1 = new Adder();
  Z2$1 = new Adder();
  geoStream(object, centroidStream$1);

  var x = +X2$1,
      y = +Y2$1,
      z = +Z2$1,
      m = hypot(x, y, z);

  // If the area-weighted ccentroid is undefined, fall back to length-weighted ccentroid.
  if (m < epsilon2) {
    x = X1$1, y = Y1$1, z = Z1$1;
    // If the feature has zero length, fall back to arithmetic mean of point vectors.
    if (W1 < epsilon$1) x = X0$1, y = Y0$1, z = Z0$1;
    m = hypot(x, y, z);
    // If the feature still has an undefined ccentroid, then return.
    if (m < epsilon2) return [NaN, NaN];
  }

  return [atan2$1(y, x) * degrees, asin$1(z / m) * degrees];
}

function constant$3(x) {
  return function() {
    return x;
  };
}

function compose(a, b) {

  function compose(x, y) {
    return x = a(x, y), b(x[0], x[1]);
  }

  if (a.invert && b.invert) compose.invert = function(x, y) {
    return x = b.invert(x, y), x && a.invert(x[0], x[1]);
  };

  return compose;
}

function rotationIdentity(lambda, phi) {
  if (abs$1(lambda) > pi$1) lambda -= Math.round(lambda / tau$1) * tau$1;
  return [lambda, phi];
}

rotationIdentity.invert = rotationIdentity;

function rotateRadians(deltaLambda, deltaPhi, deltaGamma) {
  return (deltaLambda %= tau$1) ? (deltaPhi || deltaGamma ? compose(rotationLambda(deltaLambda), rotationPhiGamma(deltaPhi, deltaGamma))
    : rotationLambda(deltaLambda))
    : (deltaPhi || deltaGamma ? rotationPhiGamma(deltaPhi, deltaGamma)
    : rotationIdentity);
}

function forwardRotationLambda(deltaLambda) {
  return function(lambda, phi) {
    lambda += deltaLambda;
    if (abs$1(lambda) > pi$1) lambda -= Math.round(lambda / tau$1) * tau$1;
    return [lambda, phi];
  };
}

function rotationLambda(deltaLambda) {
  var rotation = forwardRotationLambda(deltaLambda);
  rotation.invert = forwardRotationLambda(-deltaLambda);
  return rotation;
}

function rotationPhiGamma(deltaPhi, deltaGamma) {
  var cosDeltaPhi = cos$1(deltaPhi),
      sinDeltaPhi = sin$1(deltaPhi),
      cosDeltaGamma = cos$1(deltaGamma),
      sinDeltaGamma = sin$1(deltaGamma);

  function rotation(lambda, phi) {
    var cosPhi = cos$1(phi),
        x = cos$1(lambda) * cosPhi,
        y = sin$1(lambda) * cosPhi,
        z = sin$1(phi),
        k = z * cosDeltaPhi + x * sinDeltaPhi;
    return [
      atan2$1(y * cosDeltaGamma - k * sinDeltaGamma, x * cosDeltaPhi - z * sinDeltaPhi),
      asin$1(k * cosDeltaGamma + y * sinDeltaGamma)
    ];
  }

  rotation.invert = function(lambda, phi) {
    var cosPhi = cos$1(phi),
        x = cos$1(lambda) * cosPhi,
        y = sin$1(lambda) * cosPhi,
        z = sin$1(phi),
        k = z * cosDeltaGamma - y * sinDeltaGamma;
    return [
      atan2$1(y * cosDeltaGamma + z * sinDeltaGamma, x * cosDeltaPhi + k * sinDeltaPhi),
      asin$1(k * cosDeltaPhi - x * sinDeltaPhi)
    ];
  };

  return rotation;
}

function rotation(rotate) {
  rotate = rotateRadians(rotate[0] * radians, rotate[1] * radians, rotate.length > 2 ? rotate[2] * radians : 0);

  function forward(coordinates) {
    coordinates = rotate(coordinates[0] * radians, coordinates[1] * radians);
    return coordinates[0] *= degrees, coordinates[1] *= degrees, coordinates;
  }

  forward.invert = function(coordinates) {
    coordinates = rotate.invert(coordinates[0] * radians, coordinates[1] * radians);
    return coordinates[0] *= degrees, coordinates[1] *= degrees, coordinates;
  };

  return forward;
}

// Generates a circle centered at [0°, 0°], with a given radius and precision.
function circleStream(stream, radius, delta, direction, t0, t1) {
  if (!delta) return;
  var cosRadius = cos$1(radius),
      sinRadius = sin$1(radius),
      step = direction * delta;
  if (t0 == null) {
    t0 = radius + direction * tau$1;
    t1 = radius - step / 2;
  } else {
    t0 = circleRadius(cosRadius, t0);
    t1 = circleRadius(cosRadius, t1);
    if (direction > 0 ? t0 < t1 : t0 > t1) t0 += direction * tau$1;
  }
  for (var point, t = t0; direction > 0 ? t > t1 : t < t1; t -= step) {
    point = spherical([cosRadius, -sinRadius * cos$1(t), -sinRadius * sin$1(t)]);
    stream.point(point[0], point[1]);
  }
}

// Returns the signed angle of a cartesian point relative to [cosRadius, 0, 0].
function circleRadius(cosRadius, point) {
  point = cartesian(point), point[0] -= cosRadius;
  cartesianNormalizeInPlace(point);
  var radius = acos$1(-point[1]);
  return ((-point[2] < 0 ? -radius : radius) + tau$1 - epsilon$1) % tau$1;
}

function circle$1() {
  var center = constant$3([0, 0]),
      radius = constant$3(90),
      precision = constant$3(2),
      ring,
      rotate,
      stream = {point: point};

  function point(x, y) {
    ring.push(x = rotate(x, y));
    x[0] *= degrees, x[1] *= degrees;
  }

  function circle() {
    var c = center.apply(this, arguments),
        r = radius.apply(this, arguments) * radians,
        p = precision.apply(this, arguments) * radians;
    ring = [];
    rotate = rotateRadians(-c[0] * radians, -c[1] * radians, 0).invert;
    circleStream(stream, r, p, 1);
    c = {type: "Polygon", coordinates: [ring]};
    ring = rotate = null;
    return c;
  }

  circle.center = function(_) {
    return arguments.length ? (center = typeof _ === "function" ? _ : constant$3([+_[0], +_[1]]), circle) : center;
  };

  circle.radius = function(_) {
    return arguments.length ? (radius = typeof _ === "function" ? _ : constant$3(+_), circle) : radius;
  };

  circle.precision = function(_) {
    return arguments.length ? (precision = typeof _ === "function" ? _ : constant$3(+_), circle) : precision;
  };

  return circle;
}

function clipBuffer() {
  var lines = [],
      line;
  return {
    point: function(x, y, m) {
      line.push([x, y, m]);
    },
    lineStart: function() {
      lines.push(line = []);
    },
    lineEnd: noop$1,
    rejoin: function() {
      if (lines.length > 1) lines.push(lines.pop().concat(lines.shift()));
    },
    result: function() {
      var result = lines;
      lines = [];
      line = null;
      return result;
    }
  };
}

function pointEqual(a, b) {
  return abs$1(a[0] - b[0]) < epsilon$1 && abs$1(a[1] - b[1]) < epsilon$1;
}

function Intersection(point, points, other, entry) {
  this.x = point;
  this.z = points;
  this.o = other; // another intersection
  this.e = entry; // is an entry?
  this.v = false; // visited
  this.n = this.p = null; // next & previous
}

// A generalized polygon clipping algorithm: given a polygon that has been cut
// into its visible line segments, and rejoins the segments by interpolating
// along the clip edge.
function clipRejoin(segments, compareIntersection, startInside, interpolate, stream) {
  var subject = [],
      clip = [],
      i,
      n;

  segments.forEach(function(segment) {
    if ((n = segment.length - 1) <= 0) return;
    var n, p0 = segment[0], p1 = segment[n], x;

    if (pointEqual(p0, p1)) {
      if (!p0[2] && !p1[2]) {
        stream.lineStart();
        for (i = 0; i < n; ++i) stream.point((p0 = segment[i])[0], p0[1]);
        stream.lineEnd();
        return;
      }
      // handle degenerate cases by moving the point
      p1[0] += 2 * epsilon$1;
    }

    subject.push(x = new Intersection(p0, segment, null, true));
    clip.push(x.o = new Intersection(p0, null, x, false));
    subject.push(x = new Intersection(p1, segment, null, false));
    clip.push(x.o = new Intersection(p1, null, x, true));
  });

  if (!subject.length) return;

  clip.sort(compareIntersection);
  link$1(subject);
  link$1(clip);

  for (i = 0, n = clip.length; i < n; ++i) {
    clip[i].e = startInside = !startInside;
  }

  var start = subject[0],
      points,
      point;

  while (1) {
    // Find first unvisited intersection.
    var current = start,
        isSubject = true;
    while (current.v) if ((current = current.n) === start) return;
    points = current.z;
    stream.lineStart();
    do {
      current.v = current.o.v = true;
      if (current.e) {
        if (isSubject) {
          for (i = 0, n = points.length; i < n; ++i) stream.point((point = points[i])[0], point[1]);
        } else {
          interpolate(current.x, current.n.x, 1, stream);
        }
        current = current.n;
      } else {
        if (isSubject) {
          points = current.p.z;
          for (i = points.length - 1; i >= 0; --i) stream.point((point = points[i])[0], point[1]);
        } else {
          interpolate(current.x, current.p.x, -1, stream);
        }
        current = current.p;
      }
      current = current.o;
      points = current.z;
      isSubject = !isSubject;
    } while (!current.v);
    stream.lineEnd();
  }
}

function link$1(array) {
  if (!(n = array.length)) return;
  var n,
      i = 0,
      a = array[0],
      b;
  while (++i < n) {
    a.n = b = array[i];
    b.p = a;
    a = b;
  }
  a.n = b = array[0];
  b.p = a;
}

function longitude(point) {
  return abs$1(point[0]) <= pi$1 ? point[0] : sign$1(point[0]) * ((abs$1(point[0]) + pi$1) % tau$1 - pi$1);
}

function polygonContains(polygon, point) {
  var lambda = longitude(point),
      phi = point[1],
      sinPhi = sin$1(phi),
      normal = [sin$1(lambda), -cos$1(lambda), 0],
      angle = 0,
      winding = 0;

  var sum = new Adder();

  if (sinPhi === 1) phi = halfPi$1 + epsilon$1;
  else if (sinPhi === -1) phi = -halfPi$1 - epsilon$1;

  for (var i = 0, n = polygon.length; i < n; ++i) {
    if (!(m = (ring = polygon[i]).length)) continue;
    var ring,
        m,
        point0 = ring[m - 1],
        lambda0 = longitude(point0),
        phi0 = point0[1] / 2 + quarterPi,
        sinPhi0 = sin$1(phi0),
        cosPhi0 = cos$1(phi0);

    for (var j = 0; j < m; ++j, lambda0 = lambda1, sinPhi0 = sinPhi1, cosPhi0 = cosPhi1, point0 = point1) {
      var point1 = ring[j],
          lambda1 = longitude(point1),
          phi1 = point1[1] / 2 + quarterPi,
          sinPhi1 = sin$1(phi1),
          cosPhi1 = cos$1(phi1),
          delta = lambda1 - lambda0,
          sign = delta >= 0 ? 1 : -1,
          absDelta = sign * delta,
          antimeridian = absDelta > pi$1,
          k = sinPhi0 * sinPhi1;

      sum.add(atan2$1(k * sign * sin$1(absDelta), cosPhi0 * cosPhi1 + k * cos$1(absDelta)));
      angle += antimeridian ? delta + sign * tau$1 : delta;

      // Are the longitudes either side of the point’s meridian (lambda),
      // and are the latitudes smaller than the parallel (phi)?
      if (antimeridian ^ lambda0 >= lambda ^ lambda1 >= lambda) {
        var arc = cartesianCross(cartesian(point0), cartesian(point1));
        cartesianNormalizeInPlace(arc);
        var intersection = cartesianCross(normal, arc);
        cartesianNormalizeInPlace(intersection);
        var phiArc = (antimeridian ^ delta >= 0 ? -1 : 1) * asin$1(intersection[2]);
        if (phi > phiArc || phi === phiArc && (arc[0] || arc[1])) {
          winding += antimeridian ^ delta >= 0 ? 1 : -1;
        }
      }
    }
  }

  // First, determine whether the South pole is inside or outside:
  //
  // It is inside if:
  // * the polygon winds around it in a clockwise direction.
  // * the polygon does not (cumulatively) wind around it, but has a negative
  //   (counter-clockwise) area.
  //
  // Second, count the (signed) number of times a segment crosses a lambda
  // from the point to the South pole.  If it is zero, then the point is the
  // same side as the South pole.

  return (angle < -epsilon$1 || angle < epsilon$1 && sum < -epsilon2) ^ (winding & 1);
}

function clip(pointVisible, clipLine, interpolate, start) {
  return function(sink) {
    var line = clipLine(sink),
        ringBuffer = clipBuffer(),
        ringSink = clipLine(ringBuffer),
        polygonStarted = false,
        polygon,
        segments,
        ring;

    var clip = {
      point: point,
      lineStart: lineStart,
      lineEnd: lineEnd,
      polygonStart: function() {
        clip.point = pointRing;
        clip.lineStart = ringStart;
        clip.lineEnd = ringEnd;
        segments = [];
        polygon = [];
      },
      polygonEnd: function() {
        clip.point = point;
        clip.lineStart = lineStart;
        clip.lineEnd = lineEnd;
        segments = merge(segments);
        var startInside = polygonContains(polygon, start);
        if (segments.length) {
          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;
          clipRejoin(segments, compareIntersection, startInside, interpolate, sink);
        } else if (startInside) {
          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;
          sink.lineStart();
          interpolate(null, null, 1, sink);
          sink.lineEnd();
        }
        if (polygonStarted) sink.polygonEnd(), polygonStarted = false;
        segments = polygon = null;
      },
      sphere: function() {
        sink.polygonStart();
        sink.lineStart();
        interpolate(null, null, 1, sink);
        sink.lineEnd();
        sink.polygonEnd();
      }
    };

    function point(lambda, phi) {
      if (pointVisible(lambda, phi)) sink.point(lambda, phi);
    }

    function pointLine(lambda, phi) {
      line.point(lambda, phi);
    }

    function lineStart() {
      clip.point = pointLine;
      line.lineStart();
    }

    function lineEnd() {
      clip.point = point;
      line.lineEnd();
    }

    function pointRing(lambda, phi) {
      ring.push([lambda, phi]);
      ringSink.point(lambda, phi);
    }

    function ringStart() {
      ringSink.lineStart();
      ring = [];
    }

    function ringEnd() {
      pointRing(ring[0][0], ring[0][1]);
      ringSink.lineEnd();

      var clean = ringSink.clean(),
          ringSegments = ringBuffer.result(),
          i, n = ringSegments.length, m,
          segment,
          point;

      ring.pop();
      polygon.push(ring);
      ring = null;

      if (!n) return;

      // No intersections.
      if (clean & 1) {
        segment = ringSegments[0];
        if ((m = segment.length - 1) > 0) {
          if (!polygonStarted) sink.polygonStart(), polygonStarted = true;
          sink.lineStart();
          for (i = 0; i < m; ++i) sink.point((point = segment[i])[0], point[1]);
          sink.lineEnd();
        }
        return;
      }

      // Rejoin connected segments.
      // TODO reuse ringBuffer.rejoin()?
      if (n > 1 && clean & 2) ringSegments.push(ringSegments.pop().concat(ringSegments.shift()));

      segments.push(ringSegments.filter(validSegment));
    }

    return clip;
  };
}

function validSegment(segment) {
  return segment.length > 1;
}

// Intersections are sorted along the clip edge. For both antimeridian cutting
// and circle clipping, the same comparison is used.
function compareIntersection(a, b) {
  return ((a = a.x)[0] < 0 ? a[1] - halfPi$1 - epsilon$1 : halfPi$1 - a[1])
       - ((b = b.x)[0] < 0 ? b[1] - halfPi$1 - epsilon$1 : halfPi$1 - b[1]);
}

var clipAntimeridian = clip(
  function() { return true; },
  clipAntimeridianLine,
  clipAntimeridianInterpolate,
  [-pi$1, -halfPi$1]
);

// Takes a line and cuts into visible segments. Return values: 0 - there were
// intersections or the line was empty; 1 - no intersections; 2 - there were
// intersections, and the first and last segments should be rejoined.
function clipAntimeridianLine(stream) {
  var lambda0 = NaN,
      phi0 = NaN,
      sign0 = NaN,
      clean; // no intersections

  return {
    lineStart: function() {
      stream.lineStart();
      clean = 1;
    },
    point: function(lambda1, phi1) {
      var sign1 = lambda1 > 0 ? pi$1 : -pi$1,
          delta = abs$1(lambda1 - lambda0);
      if (abs$1(delta - pi$1) < epsilon$1) { // line crosses a pole
        stream.point(lambda0, phi0 = (phi0 + phi1) / 2 > 0 ? halfPi$1 : -halfPi$1);
        stream.point(sign0, phi0);
        stream.lineEnd();
        stream.lineStart();
        stream.point(sign1, phi0);
        stream.point(lambda1, phi0);
        clean = 0;
      } else if (sign0 !== sign1 && delta >= pi$1) { // line crosses antimeridian
        if (abs$1(lambda0 - sign0) < epsilon$1) lambda0 -= sign0 * epsilon$1; // handle degeneracies
        if (abs$1(lambda1 - sign1) < epsilon$1) lambda1 -= sign1 * epsilon$1;
        phi0 = clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1);
        stream.point(sign0, phi0);
        stream.lineEnd();
        stream.lineStart();
        stream.point(sign1, phi0);
        clean = 0;
      }
      stream.point(lambda0 = lambda1, phi0 = phi1);
      sign0 = sign1;
    },
    lineEnd: function() {
      stream.lineEnd();
      lambda0 = phi0 = NaN;
    },
    clean: function() {
      return 2 - clean; // if intersections, rejoin first and last segments
    }
  };
}

function clipAntimeridianIntersect(lambda0, phi0, lambda1, phi1) {
  var cosPhi0,
      cosPhi1,
      sinLambda0Lambda1 = sin$1(lambda0 - lambda1);
  return abs$1(sinLambda0Lambda1) > epsilon$1
      ? atan((sin$1(phi0) * (cosPhi1 = cos$1(phi1)) * sin$1(lambda1)
          - sin$1(phi1) * (cosPhi0 = cos$1(phi0)) * sin$1(lambda0))
          / (cosPhi0 * cosPhi1 * sinLambda0Lambda1))
      : (phi0 + phi1) / 2;
}

function clipAntimeridianInterpolate(from, to, direction, stream) {
  var phi;
  if (from == null) {
    phi = direction * halfPi$1;
    stream.point(-pi$1, phi);
    stream.point(0, phi);
    stream.point(pi$1, phi);
    stream.point(pi$1, 0);
    stream.point(pi$1, -phi);
    stream.point(0, -phi);
    stream.point(-pi$1, -phi);
    stream.point(-pi$1, 0);
    stream.point(-pi$1, phi);
  } else if (abs$1(from[0] - to[0]) > epsilon$1) {
    var lambda = from[0] < to[0] ? pi$1 : -pi$1;
    phi = direction * lambda / 2;
    stream.point(-lambda, phi);
    stream.point(0, phi);
    stream.point(lambda, phi);
  } else {
    stream.point(to[0], to[1]);
  }
}

function clipCircle(radius) {
  var cr = cos$1(radius),
      delta = 2 * radians,
      smallRadius = cr > 0,
      notHemisphere = abs$1(cr) > epsilon$1; // TODO optimise for this common case

  function interpolate(from, to, direction, stream) {
    circleStream(stream, radius, delta, direction, from, to);
  }

  function visible(lambda, phi) {
    return cos$1(lambda) * cos$1(phi) > cr;
  }

  // Takes a line and cuts into visible segments. Return values used for polygon
  // clipping: 0 - there were intersections or the line was empty; 1 - no
  // intersections 2 - there were intersections, and the first and last segments
  // should be rejoined.
  function clipLine(stream) {
    var point0, // previous point
        c0, // code for previous point
        v0, // visibility of previous point
        v00, // visibility of first point
        clean; // no intersections
    return {
      lineStart: function() {
        v00 = v0 = false;
        clean = 1;
      },
      point: function(lambda, phi) {
        var point1 = [lambda, phi],
            point2,
            v = visible(lambda, phi),
            c = smallRadius
              ? v ? 0 : code(lambda, phi)
              : v ? code(lambda + (lambda < 0 ? pi$1 : -pi$1), phi) : 0;
        if (!point0 && (v00 = v0 = v)) stream.lineStart();
        if (v !== v0) {
          point2 = intersect(point0, point1);
          if (!point2 || pointEqual(point0, point2) || pointEqual(point1, point2))
            point1[2] = 1;
        }
        if (v !== v0) {
          clean = 0;
          if (v) {
            // outside going in
            stream.lineStart();
            point2 = intersect(point1, point0);
            stream.point(point2[0], point2[1]);
          } else {
            // inside going out
            point2 = intersect(point0, point1);
            stream.point(point2[0], point2[1], 2);
            stream.lineEnd();
          }
          point0 = point2;
        } else if (notHemisphere && point0 && smallRadius ^ v) {
          var t;
          // If the codes for two points are different, or are both zero,
          // and there this segment intersects with the small circle.
          if (!(c & c0) && (t = intersect(point1, point0, true))) {
            clean = 0;
            if (smallRadius) {
              stream.lineStart();
              stream.point(t[0][0], t[0][1]);
              stream.point(t[1][0], t[1][1]);
              stream.lineEnd();
            } else {
              stream.point(t[1][0], t[1][1]);
              stream.lineEnd();
              stream.lineStart();
              stream.point(t[0][0], t[0][1], 3);
            }
          }
        }
        if (v && (!point0 || !pointEqual(point0, point1))) {
          stream.point(point1[0], point1[1]);
        }
        point0 = point1, v0 = v, c0 = c;
      },
      lineEnd: function() {
        if (v0) stream.lineEnd();
        point0 = null;
      },
      // Rejoin first and last segments if there were intersections and the first
      // and last points were visible.
      clean: function() {
        return clean | ((v00 && v0) << 1);
      }
    };
  }

  // Intersects the great circle between a and b with the clip circle.
  function intersect(a, b, two) {
    var pa = cartesian(a),
        pb = cartesian(b);

    // We have two planes, n1.p = d1 and n2.p = d2.
    // Find intersection line p(t) = c1 n1 + c2 n2 + t (n1 ⨯ n2).
    var n1 = [1, 0, 0], // normal
        n2 = cartesianCross(pa, pb),
        n2n2 = cartesianDot(n2, n2),
        n1n2 = n2[0], // cartesianDot(n1, n2),
        determinant = n2n2 - n1n2 * n1n2;

    // Two polar points.
    if (!determinant) return !two && a;

    var c1 =  cr * n2n2 / determinant,
        c2 = -cr * n1n2 / determinant,
        n1xn2 = cartesianCross(n1, n2),
        A = cartesianScale(n1, c1),
        B = cartesianScale(n2, c2);
    cartesianAddInPlace(A, B);

    // Solve |p(t)|^2 = 1.
    var u = n1xn2,
        w = cartesianDot(A, u),
        uu = cartesianDot(u, u),
        t2 = w * w - uu * (cartesianDot(A, A) - 1);

    if (t2 < 0) return;

    var t = sqrt$2(t2),
        q = cartesianScale(u, (-w - t) / uu);
    cartesianAddInPlace(q, A);
    q = spherical(q);

    if (!two) return q;

    // Two intersection points.
    var lambda0 = a[0],
        lambda1 = b[0],
        phi0 = a[1],
        phi1 = b[1],
        z;

    if (lambda1 < lambda0) z = lambda0, lambda0 = lambda1, lambda1 = z;

    var delta = lambda1 - lambda0,
        polar = abs$1(delta - pi$1) < epsilon$1,
        meridian = polar || delta < epsilon$1;

    if (!polar && phi1 < phi0) z = phi0, phi0 = phi1, phi1 = z;

    // Check that the first point is between a and b.
    if (meridian
        ? polar
          ? phi0 + phi1 > 0 ^ q[1] < (abs$1(q[0] - lambda0) < epsilon$1 ? phi0 : phi1)
          : phi0 <= q[1] && q[1] <= phi1
        : delta > pi$1 ^ (lambda0 <= q[0] && q[0] <= lambda1)) {
      var q1 = cartesianScale(u, (-w + t) / uu);
      cartesianAddInPlace(q1, A);
      return [q, spherical(q1)];
    }
  }

  // Generates a 4-bit vector representing the location of a point relative to
  // the small circle's bounding box.
  function code(lambda, phi) {
    var r = smallRadius ? radius : pi$1 - radius,
        code = 0;
    if (lambda < -r) code |= 1; // left
    else if (lambda > r) code |= 2; // right
    if (phi < -r) code |= 4; // below
    else if (phi > r) code |= 8; // above
    return code;
  }

  return clip(visible, clipLine, interpolate, smallRadius ? [0, -radius] : [-pi$1, radius - pi$1]);
}

function clipLine(a, b, x0, y0, x1, y1) {
  var ax = a[0],
      ay = a[1],
      bx = b[0],
      by = b[1],
      t0 = 0,
      t1 = 1,
      dx = bx - ax,
      dy = by - ay,
      r;

  r = x0 - ax;
  if (!dx && r > 0) return;
  r /= dx;
  if (dx < 0) {
    if (r < t0) return;
    if (r < t1) t1 = r;
  } else if (dx > 0) {
    if (r > t1) return;
    if (r > t0) t0 = r;
  }

  r = x1 - ax;
  if (!dx && r < 0) return;
  r /= dx;
  if (dx < 0) {
    if (r > t1) return;
    if (r > t0) t0 = r;
  } else if (dx > 0) {
    if (r < t0) return;
    if (r < t1) t1 = r;
  }

  r = y0 - ay;
  if (!dy && r > 0) return;
  r /= dy;
  if (dy < 0) {
    if (r < t0) return;
    if (r < t1) t1 = r;
  } else if (dy > 0) {
    if (r > t1) return;
    if (r > t0) t0 = r;
  }

  r = y1 - ay;
  if (!dy && r < 0) return;
  r /= dy;
  if (dy < 0) {
    if (r > t1) return;
    if (r > t0) t0 = r;
  } else if (dy > 0) {
    if (r < t0) return;
    if (r < t1) t1 = r;
  }

  if (t0 > 0) a[0] = ax + t0 * dx, a[1] = ay + t0 * dy;
  if (t1 < 1) b[0] = ax + t1 * dx, b[1] = ay + t1 * dy;
  return true;
}

var clipMax = 1e9, clipMin = -clipMax;

// TODO Use d3-polygon’s polygonContains here for the ring check?
// TODO Eliminate duplicate buffering in clipBuffer and polygon.push?

function clipRectangle(x0, y0, x1, y1) {

  function visible(x, y) {
    return x0 <= x && x <= x1 && y0 <= y && y <= y1;
  }

  function interpolate(from, to, direction, stream) {
    var a = 0, a1 = 0;
    if (from == null
        || (a = corner(from, direction)) !== (a1 = corner(to, direction))
        || comparePoint(from, to) < 0 ^ direction > 0) {
      do stream.point(a === 0 || a === 3 ? x0 : x1, a > 1 ? y1 : y0);
      while ((a = (a + direction + 4) % 4) !== a1);
    } else {
      stream.point(to[0], to[1]);
    }
  }

  function corner(p, direction) {
    return abs$1(p[0] - x0) < epsilon$1 ? direction > 0 ? 0 : 3
        : abs$1(p[0] - x1) < epsilon$1 ? direction > 0 ? 2 : 1
        : abs$1(p[1] - y0) < epsilon$1 ? direction > 0 ? 1 : 0
        : direction > 0 ? 3 : 2; // abs(p[1] - y1) < epsilon
  }

  function compareIntersection(a, b) {
    return comparePoint(a.x, b.x);
  }

  function comparePoint(a, b) {
    var ca = corner(a, 1),
        cb = corner(b, 1);
    return ca !== cb ? ca - cb
        : ca === 0 ? b[1] - a[1]
        : ca === 1 ? a[0] - b[0]
        : ca === 2 ? a[1] - b[1]
        : b[0] - a[0];
  }

  return function(stream) {
    var activeStream = stream,
        bufferStream = clipBuffer(),
        segments,
        polygon,
        ring,
        x__, y__, v__, // first point
        x_, y_, v_, // previous point
        first,
        clean;

    var clipStream = {
      point: point,
      lineStart: lineStart,
      lineEnd: lineEnd,
      polygonStart: polygonStart,
      polygonEnd: polygonEnd
    };

    function point(x, y) {
      if (visible(x, y)) activeStream.point(x, y);
    }

    function polygonInside() {
      var winding = 0;

      for (var i = 0, n = polygon.length; i < n; ++i) {
        for (var ring = polygon[i], j = 1, m = ring.length, point = ring[0], a0, a1, b0 = point[0], b1 = point[1]; j < m; ++j) {
          a0 = b0, a1 = b1, point = ring[j], b0 = point[0], b1 = point[1];
          if (a1 <= y1) { if (b1 > y1 && (b0 - a0) * (y1 - a1) > (b1 - a1) * (x0 - a0)) ++winding; }
          else { if (b1 <= y1 && (b0 - a0) * (y1 - a1) < (b1 - a1) * (x0 - a0)) --winding; }
        }
      }

      return winding;
    }

    // Buffer geometry within a polygon and then clip it en masse.
    function polygonStart() {
      activeStream = bufferStream, segments = [], polygon = [], clean = true;
    }

    function polygonEnd() {
      var startInside = polygonInside(),
          cleanInside = clean && startInside,
          visible = (segments = merge(segments)).length;
      if (cleanInside || visible) {
        stream.polygonStart();
        if (cleanInside) {
          stream.lineStart();
          interpolate(null, null, 1, stream);
          stream.lineEnd();
        }
        if (visible) {
          clipRejoin(segments, compareIntersection, startInside, interpolate, stream);
        }
        stream.polygonEnd();
      }
      activeStream = stream, segments = polygon = ring = null;
    }

    function lineStart() {
      clipStream.point = linePoint;
      if (polygon) polygon.push(ring = []);
      first = true;
      v_ = false;
      x_ = y_ = NaN;
    }

    // TODO rather than special-case polygons, simply handle them separately.
    // Ideally, coincident intersection points should be jittered to avoid
    // clipping issues.
    function lineEnd() {
      if (segments) {
        linePoint(x__, y__);
        if (v__ && v_) bufferStream.rejoin();
        segments.push(bufferStream.result());
      }
      clipStream.point = point;
      if (v_) activeStream.lineEnd();
    }

    function linePoint(x, y) {
      var v = visible(x, y);
      if (polygon) ring.push([x, y]);
      if (first) {
        x__ = x, y__ = y, v__ = v;
        first = false;
        if (v) {
          activeStream.lineStart();
          activeStream.point(x, y);
        }
      } else {
        if (v && v_) activeStream.point(x, y);
        else {
          var a = [x_ = Math.max(clipMin, Math.min(clipMax, x_)), y_ = Math.max(clipMin, Math.min(clipMax, y_))],
              b = [x = Math.max(clipMin, Math.min(clipMax, x)), y = Math.max(clipMin, Math.min(clipMax, y))];
          if (clipLine(a, b, x0, y0, x1, y1)) {
            if (!v_) {
              activeStream.lineStart();
              activeStream.point(a[0], a[1]);
            }
            activeStream.point(b[0], b[1]);
            if (!v) activeStream.lineEnd();
            clean = false;
          } else if (v) {
            activeStream.lineStart();
            activeStream.point(x, y);
            clean = false;
          }
        }
      }
      x_ = x, y_ = y, v_ = v;
    }

    return clipStream;
  };
}

function extent() {
  var x0 = 0,
      y0 = 0,
      x1 = 960,
      y1 = 500,
      cache,
      cacheStream,
      clip;

  return clip = {
    stream: function(stream) {
      return cache && cacheStream === stream ? cache : cache = clipRectangle(x0, y0, x1, y1)(cacheStream = stream);
    },
    extent: function(_) {
      return arguments.length ? (x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1], cache = cacheStream = null, clip) : [[x0, y0], [x1, y1]];
    }
  };
}

var lengthSum$1,
    lambda0,
    sinPhi0,
    cosPhi0;

var lengthStream$1 = {
  sphere: noop$1,
  point: noop$1,
  lineStart: lengthLineStart,
  lineEnd: noop$1,
  polygonStart: noop$1,
  polygonEnd: noop$1
};

function lengthLineStart() {
  lengthStream$1.point = lengthPointFirst$1;
  lengthStream$1.lineEnd = lengthLineEnd;
}

function lengthLineEnd() {
  lengthStream$1.point = lengthStream$1.lineEnd = noop$1;
}

function lengthPointFirst$1(lambda, phi) {
  lambda *= radians, phi *= radians;
  lambda0 = lambda, sinPhi0 = sin$1(phi), cosPhi0 = cos$1(phi);
  lengthStream$1.point = lengthPoint$1;
}

function lengthPoint$1(lambda, phi) {
  lambda *= radians, phi *= radians;
  var sinPhi = sin$1(phi),
      cosPhi = cos$1(phi),
      delta = abs$1(lambda - lambda0),
      cosDelta = cos$1(delta),
      sinDelta = sin$1(delta),
      x = cosPhi * sinDelta,
      y = cosPhi0 * sinPhi - sinPhi0 * cosPhi * cosDelta,
      z = sinPhi0 * sinPhi + cosPhi0 * cosPhi * cosDelta;
  lengthSum$1.add(atan2$1(sqrt$2(x * x + y * y), z));
  lambda0 = lambda, sinPhi0 = sinPhi, cosPhi0 = cosPhi;
}

function length$1(object) {
  lengthSum$1 = new Adder();
  geoStream(object, lengthStream$1);
  return +lengthSum$1;
}

var coordinates = [null, null],
    object = {type: "LineString", coordinates: coordinates};

function distance(a, b) {
  coordinates[0] = a;
  coordinates[1] = b;
  return length$1(object);
}

var containsObjectType = {
  Feature: function(object, point) {
    return containsGeometry(object.geometry, point);
  },
  FeatureCollection: function(object, point) {
    var features = object.features, i = -1, n = features.length;
    while (++i < n) if (containsGeometry(features[i].geometry, point)) return true;
    return false;
  }
};

var containsGeometryType = {
  Sphere: function() {
    return true;
  },
  Point: function(object, point) {
    return containsPoint(object.coordinates, point);
  },
  MultiPoint: function(object, point) {
    var coordinates = object.coordinates, i = -1, n = coordinates.length;
    while (++i < n) if (containsPoint(coordinates[i], point)) return true;
    return false;
  },
  LineString: function(object, point) {
    return containsLine(object.coordinates, point);
  },
  MultiLineString: function(object, point) {
    var coordinates = object.coordinates, i = -1, n = coordinates.length;
    while (++i < n) if (containsLine(coordinates[i], point)) return true;
    return false;
  },
  Polygon: function(object, point) {
    return containsPolygon(object.coordinates, point);
  },
  MultiPolygon: function(object, point) {
    var coordinates = object.coordinates, i = -1, n = coordinates.length;
    while (++i < n) if (containsPolygon(coordinates[i], point)) return true;
    return false;
  },
  GeometryCollection: function(object, point) {
    var geometries = object.geometries, i = -1, n = geometries.length;
    while (++i < n) if (containsGeometry(geometries[i], point)) return true;
    return false;
  }
};

function containsGeometry(geometry, point) {
  return geometry && containsGeometryType.hasOwnProperty(geometry.type)
      ? containsGeometryType[geometry.type](geometry, point)
      : false;
}

function containsPoint(coordinates, point) {
  return distance(coordinates, point) === 0;
}

function containsLine(coordinates, point) {
  var ao, bo, ab;
  for (var i = 0, n = coordinates.length; i < n; i++) {
    bo = distance(coordinates[i], point);
    if (bo === 0) return true;
    if (i > 0) {
      ab = distance(coordinates[i], coordinates[i - 1]);
      if (
        ab > 0 &&
        ao <= ab &&
        bo <= ab &&
        (ao + bo - ab) * (1 - Math.pow((ao - bo) / ab, 2)) < epsilon2 * ab
      )
        return true;
    }
    ao = bo;
  }
  return false;
}

function containsPolygon(coordinates, point) {
  return !!polygonContains(coordinates.map(ringRadians), pointRadians(point));
}

function ringRadians(ring) {
  return ring = ring.map(pointRadians), ring.pop(), ring;
}

function pointRadians(point) {
  return [point[0] * radians, point[1] * radians];
}

function contains$1(object, point) {
  return (object && containsObjectType.hasOwnProperty(object.type)
      ? containsObjectType[object.type]
      : containsGeometry)(object, point);
}

function graticuleX(y0, y1, dy) {
  var y = range$2(y0, y1 - epsilon$1, dy).concat(y1);
  return function(x) { return y.map(function(y) { return [x, y]; }); };
}

function graticuleY(x0, x1, dx) {
  var x = range$2(x0, x1 - epsilon$1, dx).concat(x1);
  return function(y) { return x.map(function(x) { return [x, y]; }); };
}

function graticule() {
  var x1, x0, X1, X0,
      y1, y0, Y1, Y0,
      dx = 10, dy = dx, DX = 90, DY = 360,
      x, y, X, Y,
      precision = 2.5;

  function graticule() {
    return {type: "MultiLineString", coordinates: lines()};
  }

  function lines() {
    return range$2(ceil(X0 / DX) * DX, X1, DX).map(X)
        .concat(range$2(ceil(Y0 / DY) * DY, Y1, DY).map(Y))
        .concat(range$2(ceil(x0 / dx) * dx, x1, dx).filter(function(x) { return abs$1(x % DX) > epsilon$1; }).map(x))
        .concat(range$2(ceil(y0 / dy) * dy, y1, dy).filter(function(y) { return abs$1(y % DY) > epsilon$1; }).map(y));
  }

  graticule.lines = function() {
    return lines().map(function(coordinates) { return {type: "LineString", coordinates: coordinates}; });
  };

  graticule.outline = function() {
    return {
      type: "Polygon",
      coordinates: [
        X(X0).concat(
        Y(Y1).slice(1),
        X(X1).reverse().slice(1),
        Y(Y0).reverse().slice(1))
      ]
    };
  };

  graticule.extent = function(_) {
    if (!arguments.length) return graticule.extentMinor();
    return graticule.extentMajor(_).extentMinor(_);
  };

  graticule.extentMajor = function(_) {
    if (!arguments.length) return [[X0, Y0], [X1, Y1]];
    X0 = +_[0][0], X1 = +_[1][0];
    Y0 = +_[0][1], Y1 = +_[1][1];
    if (X0 > X1) _ = X0, X0 = X1, X1 = _;
    if (Y0 > Y1) _ = Y0, Y0 = Y1, Y1 = _;
    return graticule.precision(precision);
  };

  graticule.extentMinor = function(_) {
    if (!arguments.length) return [[x0, y0], [x1, y1]];
    x0 = +_[0][0], x1 = +_[1][0];
    y0 = +_[0][1], y1 = +_[1][1];
    if (x0 > x1) _ = x0, x0 = x1, x1 = _;
    if (y0 > y1) _ = y0, y0 = y1, y1 = _;
    return graticule.precision(precision);
  };

  graticule.step = function(_) {
    if (!arguments.length) return graticule.stepMinor();
    return graticule.stepMajor(_).stepMinor(_);
  };

  graticule.stepMajor = function(_) {
    if (!arguments.length) return [DX, DY];
    DX = +_[0], DY = +_[1];
    return graticule;
  };

  graticule.stepMinor = function(_) {
    if (!arguments.length) return [dx, dy];
    dx = +_[0], dy = +_[1];
    return graticule;
  };

  graticule.precision = function(_) {
    if (!arguments.length) return precision;
    precision = +_;
    x = graticuleX(y0, y1, 90);
    y = graticuleY(x0, x1, precision);
    X = graticuleX(Y0, Y1, 90);
    Y = graticuleY(X0, X1, precision);
    return graticule;
  };

  return graticule
      .extentMajor([[-180, -90 + epsilon$1], [180, 90 - epsilon$1]])
      .extentMinor([[-180, -80 - epsilon$1], [180, 80 + epsilon$1]]);
}

function graticule10() {
  return graticule()();
}

function interpolate(a, b) {
  var x0 = a[0] * radians,
      y0 = a[1] * radians,
      x1 = b[0] * radians,
      y1 = b[1] * radians,
      cy0 = cos$1(y0),
      sy0 = sin$1(y0),
      cy1 = cos$1(y1),
      sy1 = sin$1(y1),
      kx0 = cy0 * cos$1(x0),
      ky0 = cy0 * sin$1(x0),
      kx1 = cy1 * cos$1(x1),
      ky1 = cy1 * sin$1(x1),
      d = 2 * asin$1(sqrt$2(haversin(y1 - y0) + cy0 * cy1 * haversin(x1 - x0))),
      k = sin$1(d);

  var interpolate = d ? function(t) {
    var B = sin$1(t *= d) / k,
        A = sin$1(d - t) / k,
        x = A * kx0 + B * kx1,
        y = A * ky0 + B * ky1,
        z = A * sy0 + B * sy1;
    return [
      atan2$1(y, x) * degrees,
      atan2$1(z, sqrt$2(x * x + y * y)) * degrees
    ];
  } : function() {
    return [x0 * degrees, y0 * degrees];
  };

  interpolate.distance = d;

  return interpolate;
}

var identity$5 = x => x;

var areaSum = new Adder(),
    areaRingSum = new Adder(),
    x00$2,
    y00$2,
    x0$3,
    y0$3;

var areaStream = {
  point: noop$1,
  lineStart: noop$1,
  lineEnd: noop$1,
  polygonStart: function() {
    areaStream.lineStart = areaRingStart;
    areaStream.lineEnd = areaRingEnd;
  },
  polygonEnd: function() {
    areaStream.lineStart = areaStream.lineEnd = areaStream.point = noop$1;
    areaSum.add(abs$1(areaRingSum));
    areaRingSum = new Adder();
  },
  result: function() {
    var area = areaSum / 2;
    areaSum = new Adder();
    return area;
  }
};

function areaRingStart() {
  areaStream.point = areaPointFirst;
}

function areaPointFirst(x, y) {
  areaStream.point = areaPoint;
  x00$2 = x0$3 = x, y00$2 = y0$3 = y;
}

function areaPoint(x, y) {
  areaRingSum.add(y0$3 * x - x0$3 * y);
  x0$3 = x, y0$3 = y;
}

function areaRingEnd() {
  areaPoint(x00$2, y00$2);
}

var pathArea = areaStream;

var x0$2 = Infinity,
    y0$2 = x0$2,
    x1 = -x0$2,
    y1 = x1;

var boundsStream = {
  point: boundsPoint,
  lineStart: noop$1,
  lineEnd: noop$1,
  polygonStart: noop$1,
  polygonEnd: noop$1,
  result: function() {
    var bounds = [[x0$2, y0$2], [x1, y1]];
    x1 = y1 = -(y0$2 = x0$2 = Infinity);
    return bounds;
  }
};

function boundsPoint(x, y) {
  if (x < x0$2) x0$2 = x;
  if (x > x1) x1 = x;
  if (y < y0$2) y0$2 = y;
  if (y > y1) y1 = y;
}

var boundsStream$1 = boundsStream;

// TODO Enforce positive area for exterior, negative area for interior?

var X0 = 0,
    Y0 = 0,
    Z0 = 0,
    X1 = 0,
    Y1 = 0,
    Z1 = 0,
    X2 = 0,
    Y2 = 0,
    Z2 = 0,
    x00$1,
    y00$1,
    x0$1,
    y0$1;

var centroidStream = {
  point: centroidPoint,
  lineStart: centroidLineStart,
  lineEnd: centroidLineEnd,
  polygonStart: function() {
    centroidStream.lineStart = centroidRingStart;
    centroidStream.lineEnd = centroidRingEnd;
  },
  polygonEnd: function() {
    centroidStream.point = centroidPoint;
    centroidStream.lineStart = centroidLineStart;
    centroidStream.lineEnd = centroidLineEnd;
  },
  result: function() {
    var centroid = Z2 ? [X2 / Z2, Y2 / Z2]
        : Z1 ? [X1 / Z1, Y1 / Z1]
        : Z0 ? [X0 / Z0, Y0 / Z0]
        : [NaN, NaN];
    X0 = Y0 = Z0 =
    X1 = Y1 = Z1 =
    X2 = Y2 = Z2 = 0;
    return centroid;
  }
};

function centroidPoint(x, y) {
  X0 += x;
  Y0 += y;
  ++Z0;
}

function centroidLineStart() {
  centroidStream.point = centroidPointFirstLine;
}

function centroidPointFirstLine(x, y) {
  centroidStream.point = centroidPointLine;
  centroidPoint(x0$1 = x, y0$1 = y);
}

function centroidPointLine(x, y) {
  var dx = x - x0$1, dy = y - y0$1, z = sqrt$2(dx * dx + dy * dy);
  X1 += z * (x0$1 + x) / 2;
  Y1 += z * (y0$1 + y) / 2;
  Z1 += z;
  centroidPoint(x0$1 = x, y0$1 = y);
}

function centroidLineEnd() {
  centroidStream.point = centroidPoint;
}

function centroidRingStart() {
  centroidStream.point = centroidPointFirstRing;
}

function centroidRingEnd() {
  centroidPointRing(x00$1, y00$1);
}

function centroidPointFirstRing(x, y) {
  centroidStream.point = centroidPointRing;
  centroidPoint(x00$1 = x0$1 = x, y00$1 = y0$1 = y);
}

function centroidPointRing(x, y) {
  var dx = x - x0$1,
      dy = y - y0$1,
      z = sqrt$2(dx * dx + dy * dy);

  X1 += z * (x0$1 + x) / 2;
  Y1 += z * (y0$1 + y) / 2;
  Z1 += z;

  z = y0$1 * x - x0$1 * y;
  X2 += z * (x0$1 + x);
  Y2 += z * (y0$1 + y);
  Z2 += z * 3;
  centroidPoint(x0$1 = x, y0$1 = y);
}

var pathCentroid = centroidStream;

function PathContext(context) {
  this._context = context;
}

PathContext.prototype = {
  _radius: 4.5,
  pointRadius: function(_) {
    return this._radius = _, this;
  },
  polygonStart: function() {
    this._line = 0;
  },
  polygonEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._point = 0;
  },
  lineEnd: function() {
    if (this._line === 0) this._context.closePath();
    this._point = NaN;
  },
  point: function(x, y) {
    switch (this._point) {
      case 0: {
        this._context.moveTo(x, y);
        this._point = 1;
        break;
      }
      case 1: {
        this._context.lineTo(x, y);
        break;
      }
      default: {
        this._context.moveTo(x + this._radius, y);
        this._context.arc(x, y, this._radius, 0, tau$1);
        break;
      }
    }
  },
  result: noop$1
};

var lengthSum = new Adder(),
    lengthRing,
    x00,
    y00,
    x0,
    y0;

var lengthStream = {
  point: noop$1,
  lineStart: function() {
    lengthStream.point = lengthPointFirst;
  },
  lineEnd: function() {
    if (lengthRing) lengthPoint(x00, y00);
    lengthStream.point = noop$1;
  },
  polygonStart: function() {
    lengthRing = true;
  },
  polygonEnd: function() {
    lengthRing = null;
  },
  result: function() {
    var length = +lengthSum;
    lengthSum = new Adder();
    return length;
  }
};

function lengthPointFirst(x, y) {
  lengthStream.point = lengthPoint;
  x00 = x0 = x, y00 = y0 = y;
}

function lengthPoint(x, y) {
  x0 -= x, y0 -= y;
  lengthSum.add(sqrt$2(x0 * x0 + y0 * y0));
  x0 = x, y0 = y;
}

var pathMeasure = lengthStream;

// Simple caching for constant-radius points.
let cacheDigits, cacheAppend, cacheRadius, cacheCircle;

class PathString {
  constructor(digits) {
    this._append = digits == null ? append : appendRound(digits);
    this._radius = 4.5;
    this._ = "";
  }
  pointRadius(_) {
    this._radius = +_;
    return this;
  }
  polygonStart() {
    this._line = 0;
  }
  polygonEnd() {
    this._line = NaN;
  }
  lineStart() {
    this._point = 0;
  }
  lineEnd() {
    if (this._line === 0) this._ += "Z";
    this._point = NaN;
  }
  point(x, y) {
    switch (this._point) {
      case 0: {
        this._append`M${x},${y}`;
        this._point = 1;
        break;
      }
      case 1: {
        this._append`L${x},${y}`;
        break;
      }
      default: {
        this._append`M${x},${y}`;
        if (this._radius !== cacheRadius || this._append !== cacheAppend) {
          const r = this._radius;
          const s = this._;
          this._ = ""; // stash the old string so we can cache the circle path fragment
          this._append`m0,${r}a${r},${r} 0 1,1 0,${-2 * r}a${r},${r} 0 1,1 0,${2 * r}z`;
          cacheRadius = r;
          cacheAppend = this._append;
          cacheCircle = this._;
          this._ = s;
        }
        this._ += cacheCircle;
        break;
      }
    }
  }
  result() {
    const result = this._;
    this._ = "";
    return result.length ? result : null;
  }
}

function append(strings) {
  let i = 1;
  this._ += strings[0];
  for (const j = strings.length; i < j; ++i) {
    this._ += arguments[i] + strings[i];
  }
}

function appendRound(digits) {
  const d = Math.floor(digits);
  if (!(d >= 0)) throw new RangeError(`invalid digits: ${digits}`);
  if (d > 15) return append;
  if (d !== cacheDigits) {
    const k = 10 ** d;
    cacheDigits = d;
    cacheAppend = function append(strings) {
      let i = 1;
      this._ += strings[0];
      for (const j = strings.length; i < j; ++i) {
        this._ += Math.round(arguments[i] * k) / k + strings[i];
      }
    };
  }
  return cacheAppend;
}

function index$4(projection, context) {
  let digits = 3,
      pointRadius = 4.5,
      projectionStream,
      contextStream;

  function path(object) {
    if (object) {
      if (typeof pointRadius === "function") contextStream.pointRadius(+pointRadius.apply(this, arguments));
      geoStream(object, projectionStream(contextStream));
    }
    return contextStream.result();
  }

  path.area = function(object) {
    geoStream(object, projectionStream(pathArea));
    return pathArea.result();
  };

  path.measure = function(object) {
    geoStream(object, projectionStream(pathMeasure));
    return pathMeasure.result();
  };

  path.bounds = function(object) {
    geoStream(object, projectionStream(boundsStream$1));
    return boundsStream$1.result();
  };

  path.centroid = function(object) {
    geoStream(object, projectionStream(pathCentroid));
    return pathCentroid.result();
  };

  path.projection = function(_) {
    if (!arguments.length) return projection;
    projectionStream = _ == null ? (projection = null, identity$5) : (projection = _).stream;
    return path;
  };

  path.context = function(_) {
    if (!arguments.length) return context;
    contextStream = _ == null ? (context = null, new PathString(digits)) : new PathContext(context = _);
    if (typeof pointRadius !== "function") contextStream.pointRadius(pointRadius);
    return path;
  };

  path.pointRadius = function(_) {
    if (!arguments.length) return pointRadius;
    pointRadius = typeof _ === "function" ? _ : (contextStream.pointRadius(+_), +_);
    return path;
  };

  path.digits = function(_) {
    if (!arguments.length) return digits;
    if (_ == null) digits = null;
    else {
      const d = Math.floor(_);
      if (!(d >= 0)) throw new RangeError(`invalid digits: ${_}`);
      digits = d;
    }
    if (context === null) contextStream = new PathString(digits);
    return path;
  };

  return path.projection(projection).digits(digits).context(context);
}

function transform$1(methods) {
  return {
    stream: transformer$3(methods)
  };
}

function transformer$3(methods) {
  return function(stream) {
    var s = new TransformStream;
    for (var key in methods) s[key] = methods[key];
    s.stream = stream;
    return s;
  };
}

function TransformStream() {}

TransformStream.prototype = {
  constructor: TransformStream,
  point: function(x, y) { this.stream.point(x, y); },
  sphere: function() { this.stream.sphere(); },
  lineStart: function() { this.stream.lineStart(); },
  lineEnd: function() { this.stream.lineEnd(); },
  polygonStart: function() { this.stream.polygonStart(); },
  polygonEnd: function() { this.stream.polygonEnd(); }
};

function fit(projection, fitBounds, object) {
  var clip = projection.clipExtent && projection.clipExtent();
  projection.scale(150).translate([0, 0]);
  if (clip != null) projection.clipExtent(null);
  geoStream(object, projection.stream(boundsStream$1));
  fitBounds(boundsStream$1.result());
  if (clip != null) projection.clipExtent(clip);
  return projection;
}

function fitExtent(projection, extent, object) {
  return fit(projection, function(b) {
    var w = extent[1][0] - extent[0][0],
        h = extent[1][1] - extent[0][1],
        k = Math.min(w / (b[1][0] - b[0][0]), h / (b[1][1] - b[0][1])),
        x = +extent[0][0] + (w - k * (b[1][0] + b[0][0])) / 2,
        y = +extent[0][1] + (h - k * (b[1][1] + b[0][1])) / 2;
    projection.scale(150 * k).translate([x, y]);
  }, object);
}

function fitSize(projection, size, object) {
  return fitExtent(projection, [[0, 0], size], object);
}

function fitWidth(projection, width, object) {
  return fit(projection, function(b) {
    var w = +width,
        k = w / (b[1][0] - b[0][0]),
        x = (w - k * (b[1][0] + b[0][0])) / 2,
        y = -k * b[0][1];
    projection.scale(150 * k).translate([x, y]);
  }, object);
}

function fitHeight(projection, height, object) {
  return fit(projection, function(b) {
    var h = +height,
        k = h / (b[1][1] - b[0][1]),
        x = -k * b[0][0],
        y = (h - k * (b[1][1] + b[0][1])) / 2;
    projection.scale(150 * k).translate([x, y]);
  }, object);
}

var maxDepth = 16, // maximum depth of subdivision
    cosMinDistance = cos$1(30 * radians); // cos(minimum angular distance)

function resample(project, delta2) {
  return +delta2 ? resample$1(project, delta2) : resampleNone(project);
}

function resampleNone(project) {
  return transformer$3({
    point: function(x, y) {
      x = project(x, y);
      this.stream.point(x[0], x[1]);
    }
  });
}

function resample$1(project, delta2) {

  function resampleLineTo(x0, y0, lambda0, a0, b0, c0, x1, y1, lambda1, a1, b1, c1, depth, stream) {
    var dx = x1 - x0,
        dy = y1 - y0,
        d2 = dx * dx + dy * dy;
    if (d2 > 4 * delta2 && depth--) {
      var a = a0 + a1,
          b = b0 + b1,
          c = c0 + c1,
          m = sqrt$2(a * a + b * b + c * c),
          phi2 = asin$1(c /= m),
          lambda2 = abs$1(abs$1(c) - 1) < epsilon$1 || abs$1(lambda0 - lambda1) < epsilon$1 ? (lambda0 + lambda1) / 2 : atan2$1(b, a),
          p = project(lambda2, phi2),
          x2 = p[0],
          y2 = p[1],
          dx2 = x2 - x0,
          dy2 = y2 - y0,
          dz = dy * dx2 - dx * dy2;
      if (dz * dz / d2 > delta2 // perpendicular projected distance
          || abs$1((dx * dx2 + dy * dy2) / d2 - 0.5) > 0.3 // midpoint close to an end
          || a0 * a1 + b0 * b1 + c0 * c1 < cosMinDistance) { // angular distance
        resampleLineTo(x0, y0, lambda0, a0, b0, c0, x2, y2, lambda2, a /= m, b /= m, c, depth, stream);
        stream.point(x2, y2);
        resampleLineTo(x2, y2, lambda2, a, b, c, x1, y1, lambda1, a1, b1, c1, depth, stream);
      }
    }
  }
  return function(stream) {
    var lambda00, x00, y00, a00, b00, c00, // first point
        lambda0, x0, y0, a0, b0, c0; // previous point

    var resampleStream = {
      point: point,
      lineStart: lineStart,
      lineEnd: lineEnd,
      polygonStart: function() { stream.polygonStart(); resampleStream.lineStart = ringStart; },
      polygonEnd: function() { stream.polygonEnd(); resampleStream.lineStart = lineStart; }
    };

    function point(x, y) {
      x = project(x, y);
      stream.point(x[0], x[1]);
    }

    function lineStart() {
      x0 = NaN;
      resampleStream.point = linePoint;
      stream.lineStart();
    }

    function linePoint(lambda, phi) {
      var c = cartesian([lambda, phi]), p = project(lambda, phi);
      resampleLineTo(x0, y0, lambda0, a0, b0, c0, x0 = p[0], y0 = p[1], lambda0 = lambda, a0 = c[0], b0 = c[1], c0 = c[2], maxDepth, stream);
      stream.point(x0, y0);
    }

    function lineEnd() {
      resampleStream.point = point;
      stream.lineEnd();
    }

    function ringStart() {
      lineStart();
      resampleStream.point = ringPoint;
      resampleStream.lineEnd = ringEnd;
    }

    function ringPoint(lambda, phi) {
      linePoint(lambda00 = lambda, phi), x00 = x0, y00 = y0, a00 = a0, b00 = b0, c00 = c0;
      resampleStream.point = linePoint;
    }

    function ringEnd() {
      resampleLineTo(x0, y0, lambda0, a0, b0, c0, x00, y00, lambda00, a00, b00, c00, maxDepth, stream);
      resampleStream.lineEnd = lineEnd;
      lineEnd();
    }

    return resampleStream;
  };
}

var transformRadians = transformer$3({
  point: function(x, y) {
    this.stream.point(x * radians, y * radians);
  }
});

function transformRotate(rotate) {
  return transformer$3({
    point: function(x, y) {
      var r = rotate(x, y);
      return this.stream.point(r[0], r[1]);
    }
  });
}

function scaleTranslate(k, dx, dy, sx, sy) {
  function transform(x, y) {
    x *= sx; y *= sy;
    return [dx + k * x, dy - k * y];
  }
  transform.invert = function(x, y) {
    return [(x - dx) / k * sx, (dy - y) / k * sy];
  };
  return transform;
}

function scaleTranslateRotate(k, dx, dy, sx, sy, alpha) {
  if (!alpha) return scaleTranslate(k, dx, dy, sx, sy);
  var cosAlpha = cos$1(alpha),
      sinAlpha = sin$1(alpha),
      a = cosAlpha * k,
      b = sinAlpha * k,
      ai = cosAlpha / k,
      bi = sinAlpha / k,
      ci = (sinAlpha * dy - cosAlpha * dx) / k,
      fi = (sinAlpha * dx + cosAlpha * dy) / k;
  function transform(x, y) {
    x *= sx; y *= sy;
    return [a * x - b * y + dx, dy - b * x - a * y];
  }
  transform.invert = function(x, y) {
    return [sx * (ai * x - bi * y + ci), sy * (fi - bi * x - ai * y)];
  };
  return transform;
}

function projection(project) {
  return projectionMutator(function() { return project; })();
}

function projectionMutator(projectAt) {
  var project,
      k = 150, // scale
      x = 480, y = 250, // translate
      lambda = 0, phi = 0, // center
      deltaLambda = 0, deltaPhi = 0, deltaGamma = 0, rotate, // pre-rotate
      alpha = 0, // post-rotate angle
      sx = 1, // reflectX
      sy = 1, // reflectX
      theta = null, preclip = clipAntimeridian, // pre-clip angle
      x0 = null, y0, x1, y1, postclip = identity$5, // post-clip extent
      delta2 = 0.5, // precision
      projectResample,
      projectTransform,
      projectRotateTransform,
      cache,
      cacheStream;

  function projection(point) {
    return projectRotateTransform(point[0] * radians, point[1] * radians);
  }

  function invert(point) {
    point = projectRotateTransform.invert(point[0], point[1]);
    return point && [point[0] * degrees, point[1] * degrees];
  }

  projection.stream = function(stream) {
    return cache && cacheStream === stream ? cache : cache = transformRadians(transformRotate(rotate)(preclip(projectResample(postclip(cacheStream = stream)))));
  };

  projection.preclip = function(_) {
    return arguments.length ? (preclip = _, theta = undefined, reset()) : preclip;
  };

  projection.postclip = function(_) {
    return arguments.length ? (postclip = _, x0 = y0 = x1 = y1 = null, reset()) : postclip;
  };

  projection.clipAngle = function(_) {
    return arguments.length ? (preclip = +_ ? clipCircle(theta = _ * radians) : (theta = null, clipAntimeridian), reset()) : theta * degrees;
  };

  projection.clipExtent = function(_) {
    return arguments.length ? (postclip = _ == null ? (x0 = y0 = x1 = y1 = null, identity$5) : clipRectangle(x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]), reset()) : x0 == null ? null : [[x0, y0], [x1, y1]];
  };

  projection.scale = function(_) {
    return arguments.length ? (k = +_, recenter()) : k;
  };

  projection.translate = function(_) {
    return arguments.length ? (x = +_[0], y = +_[1], recenter()) : [x, y];
  };

  projection.center = function(_) {
    return arguments.length ? (lambda = _[0] % 360 * radians, phi = _[1] % 360 * radians, recenter()) : [lambda * degrees, phi * degrees];
  };

  projection.rotate = function(_) {
    return arguments.length ? (deltaLambda = _[0] % 360 * radians, deltaPhi = _[1] % 360 * radians, deltaGamma = _.length > 2 ? _[2] % 360 * radians : 0, recenter()) : [deltaLambda * degrees, deltaPhi * degrees, deltaGamma * degrees];
  };

  projection.angle = function(_) {
    return arguments.length ? (alpha = _ % 360 * radians, recenter()) : alpha * degrees;
  };

  projection.reflectX = function(_) {
    return arguments.length ? (sx = _ ? -1 : 1, recenter()) : sx < 0;
  };

  projection.reflectY = function(_) {
    return arguments.length ? (sy = _ ? -1 : 1, recenter()) : sy < 0;
  };

  projection.precision = function(_) {
    return arguments.length ? (projectResample = resample(projectTransform, delta2 = _ * _), reset()) : sqrt$2(delta2);
  };

  projection.fitExtent = function(extent, object) {
    return fitExtent(projection, extent, object);
  };

  projection.fitSize = function(size, object) {
    return fitSize(projection, size, object);
  };

  projection.fitWidth = function(width, object) {
    return fitWidth(projection, width, object);
  };

  projection.fitHeight = function(height, object) {
    return fitHeight(projection, height, object);
  };

  function recenter() {
    var center = scaleTranslateRotate(k, 0, 0, sx, sy, alpha).apply(null, project(lambda, phi)),
        transform = scaleTranslateRotate(k, x - center[0], y - center[1], sx, sy, alpha);
    rotate = rotateRadians(deltaLambda, deltaPhi, deltaGamma);
    projectTransform = compose(project, transform);
    projectRotateTransform = compose(rotate, projectTransform);
    projectResample = resample(projectTransform, delta2);
    return reset();
  }

  function reset() {
    cache = cacheStream = null;
    return projection;
  }

  return function() {
    project = projectAt.apply(this, arguments);
    projection.invert = project.invert && invert;
    return recenter();
  };
}

function conicProjection(projectAt) {
  var phi0 = 0,
      phi1 = pi$1 / 3,
      m = projectionMutator(projectAt),
      p = m(phi0, phi1);

  p.parallels = function(_) {
    return arguments.length ? m(phi0 = _[0] * radians, phi1 = _[1] * radians) : [phi0 * degrees, phi1 * degrees];
  };

  return p;
}

function cylindricalEqualAreaRaw(phi0) {
  var cosPhi0 = cos$1(phi0);

  function forward(lambda, phi) {
    return [lambda * cosPhi0, sin$1(phi) / cosPhi0];
  }

  forward.invert = function(x, y) {
    return [x / cosPhi0, asin$1(y * cosPhi0)];
  };

  return forward;
}

function conicEqualAreaRaw(y0, y1) {
  var sy0 = sin$1(y0), n = (sy0 + sin$1(y1)) / 2;

  // Are the parallels symmetrical around the Equator?
  if (abs$1(n) < epsilon$1) return cylindricalEqualAreaRaw(y0);

  var c = 1 + sy0 * (2 * n - sy0), r0 = sqrt$2(c) / n;

  function project(x, y) {
    var r = sqrt$2(c - 2 * n * sin$1(y)) / n;
    return [r * sin$1(x *= n), r0 - r * cos$1(x)];
  }

  project.invert = function(x, y) {
    var r0y = r0 - y,
        l = atan2$1(x, abs$1(r0y)) * sign$1(r0y);
    if (r0y * n < 0)
      l -= pi$1 * sign$1(x) * sign$1(r0y);
    return [l / n, asin$1((c - (x * x + r0y * r0y) * n * n) / (2 * n))];
  };

  return project;
}

function conicEqualArea() {
  return conicProjection(conicEqualAreaRaw)
      .scale(155.424)
      .center([0, 33.6442]);
}

function albers() {
  return conicEqualArea()
      .parallels([29.5, 45.5])
      .scale(1070)
      .translate([480, 250])
      .rotate([96, 0])
      .center([-0.6, 38.7]);
}

// The projections must have mutually exclusive clip regions on the sphere,
// as this will avoid emitting interleaving lines and polygons.
function multiplex(streams) {
  var n = streams.length;
  return {
    point: function(x, y) { var i = -1; while (++i < n) streams[i].point(x, y); },
    sphere: function() { var i = -1; while (++i < n) streams[i].sphere(); },
    lineStart: function() { var i = -1; while (++i < n) streams[i].lineStart(); },
    lineEnd: function() { var i = -1; while (++i < n) streams[i].lineEnd(); },
    polygonStart: function() { var i = -1; while (++i < n) streams[i].polygonStart(); },
    polygonEnd: function() { var i = -1; while (++i < n) streams[i].polygonEnd(); }
  };
}

// A composite projection for the United States, configured by default for
// 960×500. The projection also works quite well at 960×600 if you change the
// scale to 1285 and adjust the translate accordingly. The set of standard
// parallels for each region comes from USGS, which is published here:
// http://egsc.usgs.gov/isb/pubs/MapProjections/projections.html#albers
function albersUsa() {
  var cache,
      cacheStream,
      lower48 = albers(), lower48Point,
      alaska = conicEqualArea().rotate([154, 0]).center([-2, 58.5]).parallels([55, 65]), alaskaPoint, // EPSG:3338
      hawaii = conicEqualArea().rotate([157, 0]).center([-3, 19.9]).parallels([8, 18]), hawaiiPoint, // ESRI:102007
      point, pointStream = {point: function(x, y) { point = [x, y]; }};

  function albersUsa(coordinates) {
    var x = coordinates[0], y = coordinates[1];
    return point = null,
        (lower48Point.point(x, y), point)
        || (alaskaPoint.point(x, y), point)
        || (hawaiiPoint.point(x, y), point);
  }

  albersUsa.invert = function(coordinates) {
    var k = lower48.scale(),
        t = lower48.translate(),
        x = (coordinates[0] - t[0]) / k,
        y = (coordinates[1] - t[1]) / k;
    return (y >= 0.120 && y < 0.234 && x >= -0.425 && x < -0.214 ? alaska
        : y >= 0.166 && y < 0.234 && x >= -0.214 && x < -0.115 ? hawaii
        : lower48).invert(coordinates);
  };

  albersUsa.stream = function(stream) {
    return cache && cacheStream === stream ? cache : cache = multiplex([lower48.stream(cacheStream = stream), alaska.stream(stream), hawaii.stream(stream)]);
  };

  albersUsa.precision = function(_) {
    if (!arguments.length) return lower48.precision();
    lower48.precision(_), alaska.precision(_), hawaii.precision(_);
    return reset();
  };

  albersUsa.scale = function(_) {
    if (!arguments.length) return lower48.scale();
    lower48.scale(_), alaska.scale(_ * 0.35), hawaii.scale(_);
    return albersUsa.translate(lower48.translate());
  };

  albersUsa.translate = function(_) {
    if (!arguments.length) return lower48.translate();
    var k = lower48.scale(), x = +_[0], y = +_[1];

    lower48Point = lower48
        .translate(_)
        .clipExtent([[x - 0.455 * k, y - 0.238 * k], [x + 0.455 * k, y + 0.238 * k]])
        .stream(pointStream);

    alaskaPoint = alaska
        .translate([x - 0.307 * k, y + 0.201 * k])
        .clipExtent([[x - 0.425 * k + epsilon$1, y + 0.120 * k + epsilon$1], [x - 0.214 * k - epsilon$1, y + 0.234 * k - epsilon$1]])
        .stream(pointStream);

    hawaiiPoint = hawaii
        .translate([x - 0.205 * k, y + 0.212 * k])
        .clipExtent([[x - 0.214 * k + epsilon$1, y + 0.166 * k + epsilon$1], [x - 0.115 * k - epsilon$1, y + 0.234 * k - epsilon$1]])
        .stream(pointStream);

    return reset();
  };

  albersUsa.fitExtent = function(extent, object) {
    return fitExtent(albersUsa, extent, object);
  };

  albersUsa.fitSize = function(size, object) {
    return fitSize(albersUsa, size, object);
  };

  albersUsa.fitWidth = function(width, object) {
    return fitWidth(albersUsa, width, object);
  };

  albersUsa.fitHeight = function(height, object) {
    return fitHeight(albersUsa, height, object);
  };

  function reset() {
    cache = cacheStream = null;
    return albersUsa;
  }

  return albersUsa.scale(1070);
}

function azimuthalRaw(scale) {
  return function(x, y) {
    var cx = cos$1(x),
        cy = cos$1(y),
        k = scale(cx * cy);
        if (k === Infinity) return [2, 0];
    return [
      k * cy * sin$1(x),
      k * sin$1(y)
    ];
  }
}

function azimuthalInvert(angle) {
  return function(x, y) {
    var z = sqrt$2(x * x + y * y),
        c = angle(z),
        sc = sin$1(c),
        cc = cos$1(c);
    return [
      atan2$1(x * sc, z * cc),
      asin$1(z && y * sc / z)
    ];
  }
}

var azimuthalEqualAreaRaw = azimuthalRaw(function(cxcy) {
  return sqrt$2(2 / (1 + cxcy));
});

azimuthalEqualAreaRaw.invert = azimuthalInvert(function(z) {
  return 2 * asin$1(z / 2);
});

function azimuthalEqualArea() {
  return projection(azimuthalEqualAreaRaw)
      .scale(124.75)
      .clipAngle(180 - 1e-3);
}

var azimuthalEquidistantRaw = azimuthalRaw(function(c) {
  return (c = acos$1(c)) && c / sin$1(c);
});

azimuthalEquidistantRaw.invert = azimuthalInvert(function(z) {
  return z;
});

function azimuthalEquidistant() {
  return projection(azimuthalEquidistantRaw)
      .scale(79.4188)
      .clipAngle(180 - 1e-3);
}

function mercatorRaw(lambda, phi) {
  return [lambda, log$1(tan((halfPi$1 + phi) / 2))];
}

mercatorRaw.invert = function(x, y) {
  return [x, 2 * atan(exp(y)) - halfPi$1];
};

function mercator() {
  return mercatorProjection(mercatorRaw)
      .scale(961 / tau$1);
}

function mercatorProjection(project) {
  var m = projection(project),
      center = m.center,
      scale = m.scale,
      translate = m.translate,
      clipExtent = m.clipExtent,
      x0 = null, y0, x1, y1; // clip extent

  m.scale = function(_) {
    return arguments.length ? (scale(_), reclip()) : scale();
  };

  m.translate = function(_) {
    return arguments.length ? (translate(_), reclip()) : translate();
  };

  m.center = function(_) {
    return arguments.length ? (center(_), reclip()) : center();
  };

  m.clipExtent = function(_) {
    return arguments.length ? ((_ == null ? x0 = y0 = x1 = y1 = null : (x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1])), reclip()) : x0 == null ? null : [[x0, y0], [x1, y1]];
  };

  function reclip() {
    var k = pi$1 * scale(),
        t = m(rotation(m.rotate()).invert([0, 0]));
    return clipExtent(x0 == null
        ? [[t[0] - k, t[1] - k], [t[0] + k, t[1] + k]] : project === mercatorRaw
        ? [[Math.max(t[0] - k, x0), y0], [Math.min(t[0] + k, x1), y1]]
        : [[x0, Math.max(t[1] - k, y0)], [x1, Math.min(t[1] + k, y1)]]);
  }

  return reclip();
}

function tany(y) {
  return tan((halfPi$1 + y) / 2);
}

function conicConformalRaw(y0, y1) {
  var cy0 = cos$1(y0),
      n = y0 === y1 ? sin$1(y0) : log$1(cy0 / cos$1(y1)) / log$1(tany(y1) / tany(y0)),
      f = cy0 * pow$1(tany(y0), n) / n;

  if (!n) return mercatorRaw;

  function project(x, y) {
    if (f > 0) { if (y < -halfPi$1 + epsilon$1) y = -halfPi$1 + epsilon$1; }
    else { if (y > halfPi$1 - epsilon$1) y = halfPi$1 - epsilon$1; }
    var r = f / pow$1(tany(y), n);
    return [r * sin$1(n * x), f - r * cos$1(n * x)];
  }

  project.invert = function(x, y) {
    var fy = f - y, r = sign$1(n) * sqrt$2(x * x + fy * fy),
      l = atan2$1(x, abs$1(fy)) * sign$1(fy);
    if (fy * n < 0)
      l -= pi$1 * sign$1(x) * sign$1(fy);
    return [l / n, 2 * atan(pow$1(f / r, 1 / n)) - halfPi$1];
  };

  return project;
}

function conicConformal() {
  return conicProjection(conicConformalRaw)
      .scale(109.5)
      .parallels([30, 30]);
}

function equirectangularRaw(lambda, phi) {
  return [lambda, phi];
}

equirectangularRaw.invert = equirectangularRaw;

function equirectangular() {
  return projection(equirectangularRaw)
      .scale(152.63);
}

function conicEquidistantRaw(y0, y1) {
  var cy0 = cos$1(y0),
      n = y0 === y1 ? sin$1(y0) : (cy0 - cos$1(y1)) / (y1 - y0),
      g = cy0 / n + y0;

  if (abs$1(n) < epsilon$1) return equirectangularRaw;

  function project(x, y) {
    var gy = g - y, nx = n * x;
    return [gy * sin$1(nx), g - gy * cos$1(nx)];
  }

  project.invert = function(x, y) {
    var gy = g - y,
        l = atan2$1(x, abs$1(gy)) * sign$1(gy);
    if (gy * n < 0)
      l -= pi$1 * sign$1(x) * sign$1(gy);
    return [l / n, g - sign$1(n) * sqrt$2(x * x + gy * gy)];
  };

  return project;
}

function conicEquidistant() {
  return conicProjection(conicEquidistantRaw)
      .scale(131.154)
      .center([0, 13.9389]);
}

var A1 = 1.340264,
    A2 = -0.081106,
    A3 = 0.000893,
    A4 = 0.003796,
    M = sqrt$2(3) / 2,
    iterations = 12;

function equalEarthRaw(lambda, phi) {
  var l = asin$1(M * sin$1(phi)), l2 = l * l, l6 = l2 * l2 * l2;
  return [
    lambda * cos$1(l) / (M * (A1 + 3 * A2 * l2 + l6 * (7 * A3 + 9 * A4 * l2))),
    l * (A1 + A2 * l2 + l6 * (A3 + A4 * l2))
  ];
}

equalEarthRaw.invert = function(x, y) {
  var l = y, l2 = l * l, l6 = l2 * l2 * l2;
  for (var i = 0, delta, fy, fpy; i < iterations; ++i) {
    fy = l * (A1 + A2 * l2 + l6 * (A3 + A4 * l2)) - y;
    fpy = A1 + 3 * A2 * l2 + l6 * (7 * A3 + 9 * A4 * l2);
    l -= delta = fy / fpy, l2 = l * l, l6 = l2 * l2 * l2;
    if (abs$1(delta) < epsilon2) break;
  }
  return [
    M * x * (A1 + 3 * A2 * l2 + l6 * (7 * A3 + 9 * A4 * l2)) / cos$1(l),
    asin$1(sin$1(l) / M)
  ];
};

function equalEarth() {
  return projection(equalEarthRaw)
      .scale(177.158);
}

function gnomonicRaw(x, y) {
  var cy = cos$1(y), k = cos$1(x) * cy;
  return [cy * sin$1(x) / k, sin$1(y) / k];
}

gnomonicRaw.invert = azimuthalInvert(atan);

function gnomonic() {
  return projection(gnomonicRaw)
      .scale(144.049)
      .clipAngle(60);
}

function identity$4() {
  var k = 1, tx = 0, ty = 0, sx = 1, sy = 1, // scale, translate and reflect
      alpha = 0, ca, sa, // angle
      x0 = null, y0, x1, y1, // clip extent
      kx = 1, ky = 1,
      transform = transformer$3({
        point: function(x, y) {
          var p = projection([x, y]);
          this.stream.point(p[0], p[1]);
        }
      }),
      postclip = identity$5,
      cache,
      cacheStream;

  function reset() {
    kx = k * sx;
    ky = k * sy;
    cache = cacheStream = null;
    return projection;
  }

  function projection (p) {
    var x = p[0] * kx, y = p[1] * ky;
    if (alpha) {
      var t = y * ca - x * sa;
      x = x * ca + y * sa;
      y = t;
    }    
    return [x + tx, y + ty];
  }
  projection.invert = function(p) {
    var x = p[0] - tx, y = p[1] - ty;
    if (alpha) {
      var t = y * ca + x * sa;
      x = x * ca - y * sa;
      y = t;
    }
    return [x / kx, y / ky];
  };
  projection.stream = function(stream) {
    return cache && cacheStream === stream ? cache : cache = transform(postclip(cacheStream = stream));
  };
  projection.postclip = function(_) {
    return arguments.length ? (postclip = _, x0 = y0 = x1 = y1 = null, reset()) : postclip;
  };
  projection.clipExtent = function(_) {
    return arguments.length ? (postclip = _ == null ? (x0 = y0 = x1 = y1 = null, identity$5) : clipRectangle(x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1]), reset()) : x0 == null ? null : [[x0, y0], [x1, y1]];
  };
  projection.scale = function(_) {
    return arguments.length ? (k = +_, reset()) : k;
  };
  projection.translate = function(_) {
    return arguments.length ? (tx = +_[0], ty = +_[1], reset()) : [tx, ty];
  };
  projection.angle = function(_) {
    return arguments.length ? (alpha = _ % 360 * radians, sa = sin$1(alpha), ca = cos$1(alpha), reset()) : alpha * degrees;
  };
  projection.reflectX = function(_) {
    return arguments.length ? (sx = _ ? -1 : 1, reset()) : sx < 0;
  };
  projection.reflectY = function(_) {
    return arguments.length ? (sy = _ ? -1 : 1, reset()) : sy < 0;
  };
  projection.fitExtent = function(extent, object) {
    return fitExtent(projection, extent, object);
  };
  projection.fitSize = function(size, object) {
    return fitSize(projection, size, object);
  };
  projection.fitWidth = function(width, object) {
    return fitWidth(projection, width, object);
  };
  projection.fitHeight = function(height, object) {
    return fitHeight(projection, height, object);
  };

  return projection;
}

function naturalEarth1Raw(lambda, phi) {
  var phi2 = phi * phi, phi4 = phi2 * phi2;
  return [
    lambda * (0.8707 - 0.131979 * phi2 + phi4 * (-0.013791 + phi4 * (0.003971 * phi2 - 0.001529 * phi4))),
    phi * (1.007226 + phi2 * (0.015085 + phi4 * (-0.044475 + 0.028874 * phi2 - 0.005916 * phi4)))
  ];
}

naturalEarth1Raw.invert = function(x, y) {
  var phi = y, i = 25, delta;
  do {
    var phi2 = phi * phi, phi4 = phi2 * phi2;
    phi -= delta = (phi * (1.007226 + phi2 * (0.015085 + phi4 * (-0.044475 + 0.028874 * phi2 - 0.005916 * phi4))) - y) /
        (1.007226 + phi2 * (0.015085 * 3 + phi4 * (-0.044475 * 7 + 0.028874 * 9 * phi2 - 0.005916 * 11 * phi4)));
  } while (abs$1(delta) > epsilon$1 && --i > 0);
  return [
    x / (0.8707 + (phi2 = phi * phi) * (-0.131979 + phi2 * (-0.013791 + phi2 * phi2 * phi2 * (0.003971 - 0.001529 * phi2)))),
    phi
  ];
};

function naturalEarth1() {
  return projection(naturalEarth1Raw)
      .scale(175.295);
}

function orthographicRaw(x, y) {
  return [cos$1(y) * sin$1(x), sin$1(y)];
}

orthographicRaw.invert = azimuthalInvert(asin$1);

function orthographic() {
  return projection(orthographicRaw)
      .scale(249.5)
      .clipAngle(90 + epsilon$1);
}

function stereographicRaw(x, y) {
  var cy = cos$1(y), k = 1 + cos$1(x) * cy;
  return [cy * sin$1(x) / k, sin$1(y) / k];
}

stereographicRaw.invert = azimuthalInvert(function(z) {
  return 2 * atan(z);
});

function stereographic() {
  return projection(stereographicRaw)
      .scale(250)
      .clipAngle(142);
}

function transverseMercatorRaw(lambda, phi) {
  return [log$1(tan((halfPi$1 + phi) / 2)), -lambda];
}

transverseMercatorRaw.invert = function(x, y) {
  return [-y, 2 * atan(exp(x)) - halfPi$1];
};

function transverseMercator() {
  var m = mercatorProjection(transverseMercatorRaw),
      center = m.center,
      rotate = m.rotate;

  m.center = function(_) {
    return arguments.length ? center([-_[1], _[0]]) : (_ = center(), [_[1], -_[0]]);
  };

  m.rotate = function(_) {
    return arguments.length ? rotate([_[0], _[1], _.length > 2 ? _[2] + 90 : 90]) : (_ = rotate(), [_[0], _[1], _[2] - 90]);
  };

  return rotate([0, 0, 90])
      .scale(159.155);
}

function defaultSeparation$1(a, b) {
  return a.parent === b.parent ? 1 : 2;
}

function meanX(children) {
  return children.reduce(meanXReduce, 0) / children.length;
}

function meanXReduce(x, c) {
  return x + c.x;
}

function maxY(children) {
  return 1 + children.reduce(maxYReduce, 0);
}

function maxYReduce(y, c) {
  return Math.max(y, c.y);
}

function leafLeft(node) {
  var children;
  while (children = node.children) node = children[0];
  return node;
}

function leafRight(node) {
  var children;
  while (children = node.children) node = children[children.length - 1];
  return node;
}

function cluster() {
  var separation = defaultSeparation$1,
      dx = 1,
      dy = 1,
      nodeSize = false;

  function cluster(root) {
    var previousNode,
        x = 0;

    // First walk, computing the initial x & y values.
    root.eachAfter(function(node) {
      var children = node.children;
      if (children) {
        node.x = meanX(children);
        node.y = maxY(children);
      } else {
        node.x = previousNode ? x += separation(node, previousNode) : 0;
        node.y = 0;
        previousNode = node;
      }
    });

    var left = leafLeft(root),
        right = leafRight(root),
        x0 = left.x - separation(left, right) / 2,
        x1 = right.x + separation(right, left) / 2;

    // Second walk, normalizing x & y to the desired size.
    return root.eachAfter(nodeSize ? function(node) {
      node.x = (node.x - root.x) * dx;
      node.y = (root.y - node.y) * dy;
    } : function(node) {
      node.x = (node.x - x0) / (x1 - x0) * dx;
      node.y = (1 - (root.y ? node.y / root.y : 1)) * dy;
    });
  }

  cluster.separation = function(x) {
    return arguments.length ? (separation = x, cluster) : separation;
  };

  cluster.size = function(x) {
    return arguments.length ? (nodeSize = false, dx = +x[0], dy = +x[1], cluster) : (nodeSize ? null : [dx, dy]);
  };

  cluster.nodeSize = function(x) {
    return arguments.length ? (nodeSize = true, dx = +x[0], dy = +x[1], cluster) : (nodeSize ? [dx, dy] : null);
  };

  return cluster;
}

function count(node) {
  var sum = 0,
      children = node.children,
      i = children && children.length;
  if (!i) sum = 1;
  else while (--i >= 0) sum += children[i].value;
  node.value = sum;
}

function node_count() {
  return this.eachAfter(count);
}

function node_each(callback, that) {
  let index = -1;
  for (const node of this) {
    callback.call(that, node, ++index, this);
  }
  return this;
}

function node_eachBefore(callback, that) {
  var node = this, nodes = [node], children, i, index = -1;
  while (node = nodes.pop()) {
    callback.call(that, node, ++index, this);
    if (children = node.children) {
      for (i = children.length - 1; i >= 0; --i) {
        nodes.push(children[i]);
      }
    }
  }
  return this;
}

function node_eachAfter(callback, that) {
  var node = this, nodes = [node], next = [], children, i, n, index = -1;
  while (node = nodes.pop()) {
    next.push(node);
    if (children = node.children) {
      for (i = 0, n = children.length; i < n; ++i) {
        nodes.push(children[i]);
      }
    }
  }
  while (node = next.pop()) {
    callback.call(that, node, ++index, this);
  }
  return this;
}

function node_find(callback, that) {
  let index = -1;
  for (const node of this) {
    if (callback.call(that, node, ++index, this)) {
      return node;
    }
  }
}

function node_sum(value) {
  return this.eachAfter(function(node) {
    var sum = +value(node.data) || 0,
        children = node.children,
        i = children && children.length;
    while (--i >= 0) sum += children[i].value;
    node.value = sum;
  });
}

function node_sort(compare) {
  return this.eachBefore(function(node) {
    if (node.children) {
      node.children.sort(compare);
    }
  });
}

function node_path(end) {
  var start = this,
      ancestor = leastCommonAncestor(start, end),
      nodes = [start];
  while (start !== ancestor) {
    start = start.parent;
    nodes.push(start);
  }
  var k = nodes.length;
  while (end !== ancestor) {
    nodes.splice(k, 0, end);
    end = end.parent;
  }
  return nodes;
}

function leastCommonAncestor(a, b) {
  if (a === b) return a;
  var aNodes = a.ancestors(),
      bNodes = b.ancestors(),
      c = null;
  a = aNodes.pop();
  b = bNodes.pop();
  while (a === b) {
    c = a;
    a = aNodes.pop();
    b = bNodes.pop();
  }
  return c;
}

function node_ancestors() {
  var node = this, nodes = [node];
  while (node = node.parent) {
    nodes.push(node);
  }
  return nodes;
}

function node_descendants() {
  return Array.from(this);
}

function node_leaves() {
  var leaves = [];
  this.eachBefore(function(node) {
    if (!node.children) {
      leaves.push(node);
    }
  });
  return leaves;
}

function node_links() {
  var root = this, links = [];
  root.each(function(node) {
    if (node !== root) { // Don’t include the root’s parent, if any.
      links.push({source: node.parent, target: node});
    }
  });
  return links;
}

function* node_iterator() {
  var node = this, current, next = [node], children, i, n;
  do {
    current = next.reverse(), next = [];
    while (node = current.pop()) {
      yield node;
      if (children = node.children) {
        for (i = 0, n = children.length; i < n; ++i) {
          next.push(children[i]);
        }
      }
    }
  } while (next.length);
}

function hierarchy(data, children) {
  if (data instanceof Map) {
    data = [undefined, data];
    if (children === undefined) children = mapChildren;
  } else if (children === undefined) {
    children = objectChildren;
  }

  var root = new Node$1(data),
      node,
      nodes = [root],
      child,
      childs,
      i,
      n;

  while (node = nodes.pop()) {
    if ((childs = children(node.data)) && (n = (childs = Array.from(childs)).length)) {
      node.children = childs;
      for (i = n - 1; i >= 0; --i) {
        nodes.push(child = childs[i] = new Node$1(childs[i]));
        child.parent = node;
        child.depth = node.depth + 1;
      }
    }
  }

  return root.eachBefore(computeHeight);
}

function node_copy() {
  return hierarchy(this).eachBefore(copyData);
}

function objectChildren(d) {
  return d.children;
}

function mapChildren(d) {
  return Array.isArray(d) ? d[1] : null;
}

function copyData(node) {
  if (node.data.value !== undefined) node.value = node.data.value;
  node.data = node.data.data;
}

function computeHeight(node) {
  var height = 0;
  do node.height = height;
  while ((node = node.parent) && (node.height < ++height));
}

function Node$1(data) {
  this.data = data;
  this.depth =
  this.height = 0;
  this.parent = null;
}

Node$1.prototype = hierarchy.prototype = {
  constructor: Node$1,
  count: node_count,
  each: node_each,
  eachAfter: node_eachAfter,
  eachBefore: node_eachBefore,
  find: node_find,
  sum: node_sum,
  sort: node_sort,
  path: node_path,
  ancestors: node_ancestors,
  descendants: node_descendants,
  leaves: node_leaves,
  links: node_links,
  copy: node_copy,
  [Symbol.iterator]: node_iterator
};

function optional(f) {
  return f == null ? null : required(f);
}

function required(f) {
  if (typeof f !== "function") throw new Error;
  return f;
}

function constantZero() {
  return 0;
}

function constant$2(x) {
  return function() {
    return x;
  };
}

// https://en.wikipedia.org/wiki/Linear_congruential_generator#Parameters_in_common_use
const a$1 = 1664525;
const c$3 = 1013904223;
const m = 4294967296; // 2^32

function lcg$1() {
  let s = 1;
  return () => (s = (a$1 * s + c$3) % m) / m;
}

function array$1(x) {
  return typeof x === "object" && "length" in x
    ? x // Array, TypedArray, NodeList, array-like
    : Array.from(x); // Map, Set, iterable, string, or anything else
}

function shuffle(array, random) {
  let m = array.length,
      t,
      i;

  while (m) {
    i = random() * m-- | 0;
    t = array[m];
    array[m] = array[i];
    array[i] = t;
  }

  return array;
}

function enclose(circles) {
  return packEncloseRandom(circles, lcg$1());
}

function packEncloseRandom(circles, random) {
  var i = 0, n = (circles = shuffle(Array.from(circles), random)).length, B = [], p, e;

  while (i < n) {
    p = circles[i];
    if (e && enclosesWeak(e, p)) ++i;
    else e = encloseBasis(B = extendBasis(B, p)), i = 0;
  }

  return e;
}

function extendBasis(B, p) {
  var i, j;

  if (enclosesWeakAll(p, B)) return [p];

  // If we get here then B must have at least one element.
  for (i = 0; i < B.length; ++i) {
    if (enclosesNot(p, B[i])
        && enclosesWeakAll(encloseBasis2(B[i], p), B)) {
      return [B[i], p];
    }
  }

  // If we get here then B must have at least two elements.
  for (i = 0; i < B.length - 1; ++i) {
    for (j = i + 1; j < B.length; ++j) {
      if (enclosesNot(encloseBasis2(B[i], B[j]), p)
          && enclosesNot(encloseBasis2(B[i], p), B[j])
          && enclosesNot(encloseBasis2(B[j], p), B[i])
          && enclosesWeakAll(encloseBasis3(B[i], B[j], p), B)) {
        return [B[i], B[j], p];
      }
    }
  }

  // If we get here then something is very wrong.
  throw new Error;
}

function enclosesNot(a, b) {
  var dr = a.r - b.r, dx = b.x - a.x, dy = b.y - a.y;
  return dr < 0 || dr * dr < dx * dx + dy * dy;
}

function enclosesWeak(a, b) {
  var dr = a.r - b.r + Math.max(a.r, b.r, 1) * 1e-9, dx = b.x - a.x, dy = b.y - a.y;
  return dr > 0 && dr * dr > dx * dx + dy * dy;
}

function enclosesWeakAll(a, B) {
  for (var i = 0; i < B.length; ++i) {
    if (!enclosesWeak(a, B[i])) {
      return false;
    }
  }
  return true;
}

function encloseBasis(B) {
  switch (B.length) {
    case 1: return encloseBasis1(B[0]);
    case 2: return encloseBasis2(B[0], B[1]);
    case 3: return encloseBasis3(B[0], B[1], B[2]);
  }
}

function encloseBasis1(a) {
  return {
    x: a.x,
    y: a.y,
    r: a.r
  };
}

function encloseBasis2(a, b) {
  var x1 = a.x, y1 = a.y, r1 = a.r,
      x2 = b.x, y2 = b.y, r2 = b.r,
      x21 = x2 - x1, y21 = y2 - y1, r21 = r2 - r1,
      l = Math.sqrt(x21 * x21 + y21 * y21);
  return {
    x: (x1 + x2 + x21 / l * r21) / 2,
    y: (y1 + y2 + y21 / l * r21) / 2,
    r: (l + r1 + r2) / 2
  };
}

function encloseBasis3(a, b, c) {
  var x1 = a.x, y1 = a.y, r1 = a.r,
      x2 = b.x, y2 = b.y, r2 = b.r,
      x3 = c.x, y3 = c.y, r3 = c.r,
      a2 = x1 - x2,
      a3 = x1 - x3,
      b2 = y1 - y2,
      b3 = y1 - y3,
      c2 = r2 - r1,
      c3 = r3 - r1,
      d1 = x1 * x1 + y1 * y1 - r1 * r1,
      d2 = d1 - x2 * x2 - y2 * y2 + r2 * r2,
      d3 = d1 - x3 * x3 - y3 * y3 + r3 * r3,
      ab = a3 * b2 - a2 * b3,
      xa = (b2 * d3 - b3 * d2) / (ab * 2) - x1,
      xb = (b3 * c2 - b2 * c3) / ab,
      ya = (a3 * d2 - a2 * d3) / (ab * 2) - y1,
      yb = (a2 * c3 - a3 * c2) / ab,
      A = xb * xb + yb * yb - 1,
      B = 2 * (r1 + xa * xb + ya * yb),
      C = xa * xa + ya * ya - r1 * r1,
      r = -(Math.abs(A) > 1e-6 ? (B + Math.sqrt(B * B - 4 * A * C)) / (2 * A) : C / B);
  return {
    x: x1 + xa + xb * r,
    y: y1 + ya + yb * r,
    r: r
  };
}

function place(b, a, c) {
  var dx = b.x - a.x, x, a2,
      dy = b.y - a.y, y, b2,
      d2 = dx * dx + dy * dy;
  if (d2) {
    a2 = a.r + c.r, a2 *= a2;
    b2 = b.r + c.r, b2 *= b2;
    if (a2 > b2) {
      x = (d2 + b2 - a2) / (2 * d2);
      y = Math.sqrt(Math.max(0, b2 / d2 - x * x));
      c.x = b.x - x * dx - y * dy;
      c.y = b.y - x * dy + y * dx;
    } else {
      x = (d2 + a2 - b2) / (2 * d2);
      y = Math.sqrt(Math.max(0, a2 / d2 - x * x));
      c.x = a.x + x * dx - y * dy;
      c.y = a.y + x * dy + y * dx;
    }
  } else {
    c.x = a.x + c.r;
    c.y = a.y;
  }
}

function intersects(a, b) {
  var dr = a.r + b.r - 1e-6, dx = b.x - a.x, dy = b.y - a.y;
  return dr > 0 && dr * dr > dx * dx + dy * dy;
}

function score(node) {
  var a = node._,
      b = node.next._,
      ab = a.r + b.r,
      dx = (a.x * b.r + b.x * a.r) / ab,
      dy = (a.y * b.r + b.y * a.r) / ab;
  return dx * dx + dy * dy;
}

function Node(circle) {
  this._ = circle;
  this.next = null;
  this.previous = null;
}

function packSiblingsRandom(circles, random) {
  if (!(n = (circles = array$1(circles)).length)) return 0;

  var a, b, c, n, aa, ca, i, j, k, sj, sk;

  // Place the first circle.
  a = circles[0], a.x = 0, a.y = 0;
  if (!(n > 1)) return a.r;

  // Place the second circle.
  b = circles[1], a.x = -b.r, b.x = a.r, b.y = 0;
  if (!(n > 2)) return a.r + b.r;

  // Place the third circle.
  place(b, a, c = circles[2]);

  // Initialize the front-chain using the first three circles a, b and c.
  a = new Node(a), b = new Node(b), c = new Node(c);
  a.next = c.previous = b;
  b.next = a.previous = c;
  c.next = b.previous = a;

  // Attempt to place each remaining circle…
  pack: for (i = 3; i < n; ++i) {
    place(a._, b._, c = circles[i]), c = new Node(c);

    // Find the closest intersecting circle on the front-chain, if any.
    // “Closeness” is determined by linear distance along the front-chain.
    // “Ahead” or “behind” is likewise determined by linear distance.
    j = b.next, k = a.previous, sj = b._.r, sk = a._.r;
    do {
      if (sj <= sk) {
        if (intersects(j._, c._)) {
          b = j, a.next = b, b.previous = a, --i;
          continue pack;
        }
        sj += j._.r, j = j.next;
      } else {
        if (intersects(k._, c._)) {
          a = k, a.next = b, b.previous = a, --i;
          continue pack;
        }
        sk += k._.r, k = k.previous;
      }
    } while (j !== k.next);

    // Success! Insert the new circle c between a and b.
    c.previous = a, c.next = b, a.next = b.previous = b = c;

    // Compute the new closest circle pair to the centroid.
    aa = score(a);
    while ((c = c.next) !== b) {
      if ((ca = score(c)) < aa) {
        a = c, aa = ca;
      }
    }
    b = a.next;
  }

  // Compute the enclosing circle of the front chain.
  a = [b._], c = b; while ((c = c.next) !== b) a.push(c._); c = packEncloseRandom(a, random);

  // Translate the circles to put the enclosing circle around the origin.
  for (i = 0; i < n; ++i) a = circles[i], a.x -= c.x, a.y -= c.y;

  return c.r;
}

function siblings(circles) {
  packSiblingsRandom(circles, lcg$1());
  return circles;
}

function defaultRadius(d) {
  return Math.sqrt(d.value);
}

function index$3() {
  var radius = null,
      dx = 1,
      dy = 1,
      padding = constantZero;

  function pack(root) {
    const random = lcg$1();
    root.x = dx / 2, root.y = dy / 2;
    if (radius) {
      root.eachBefore(radiusLeaf(radius))
          .eachAfter(packChildrenRandom(padding, 0.5, random))
          .eachBefore(translateChild(1));
    } else {
      root.eachBefore(radiusLeaf(defaultRadius))
          .eachAfter(packChildrenRandom(constantZero, 1, random))
          .eachAfter(packChildrenRandom(padding, root.r / Math.min(dx, dy), random))
          .eachBefore(translateChild(Math.min(dx, dy) / (2 * root.r)));
    }
    return root;
  }

  pack.radius = function(x) {
    return arguments.length ? (radius = optional(x), pack) : radius;
  };

  pack.size = function(x) {
    return arguments.length ? (dx = +x[0], dy = +x[1], pack) : [dx, dy];
  };

  pack.padding = function(x) {
    return arguments.length ? (padding = typeof x === "function" ? x : constant$2(+x), pack) : padding;
  };

  return pack;
}

function radiusLeaf(radius) {
  return function(node) {
    if (!node.children) {
      node.r = Math.max(0, +radius(node) || 0);
    }
  };
}

function packChildrenRandom(padding, k, random) {
  return function(node) {
    if (children = node.children) {
      var children,
          i,
          n = children.length,
          r = padding(node) * k || 0,
          e;

      if (r) for (i = 0; i < n; ++i) children[i].r += r;
      e = packSiblingsRandom(children, random);
      if (r) for (i = 0; i < n; ++i) children[i].r -= r;
      node.r = e + r;
    }
  };
}

function translateChild(k) {
  return function(node) {
    var parent = node.parent;
    node.r *= k;
    if (parent) {
      node.x = parent.x + k * node.x;
      node.y = parent.y + k * node.y;
    }
  };
}

function roundNode(node) {
  node.x0 = Math.round(node.x0);
  node.y0 = Math.round(node.y0);
  node.x1 = Math.round(node.x1);
  node.y1 = Math.round(node.y1);
}

function treemapDice(parent, x0, y0, x1, y1) {
  var nodes = parent.children,
      node,
      i = -1,
      n = nodes.length,
      k = parent.value && (x1 - x0) / parent.value;

  while (++i < n) {
    node = nodes[i], node.y0 = y0, node.y1 = y1;
    node.x0 = x0, node.x1 = x0 += node.value * k;
  }
}

function partition() {
  var dx = 1,
      dy = 1,
      padding = 0,
      round = false;

  function partition(root) {
    var n = root.height + 1;
    root.x0 =
    root.y0 = padding;
    root.x1 = dx;
    root.y1 = dy / n;
    root.eachBefore(positionNode(dy, n));
    if (round) root.eachBefore(roundNode);
    return root;
  }

  function positionNode(dy, n) {
    return function(node) {
      if (node.children) {
        treemapDice(node, node.x0, dy * (node.depth + 1) / n, node.x1, dy * (node.depth + 2) / n);
      }
      var x0 = node.x0,
          y0 = node.y0,
          x1 = node.x1 - padding,
          y1 = node.y1 - padding;
      if (x1 < x0) x0 = x1 = (x0 + x1) / 2;
      if (y1 < y0) y0 = y1 = (y0 + y1) / 2;
      node.x0 = x0;
      node.y0 = y0;
      node.x1 = x1;
      node.y1 = y1;
    };
  }

  partition.round = function(x) {
    return arguments.length ? (round = !!x, partition) : round;
  };

  partition.size = function(x) {
    return arguments.length ? (dx = +x[0], dy = +x[1], partition) : [dx, dy];
  };

  partition.padding = function(x) {
    return arguments.length ? (padding = +x, partition) : padding;
  };

  return partition;
}

var preroot = {depth: -1},
    ambiguous = {},
    imputed = {};

function defaultId(d) {
  return d.id;
}

function defaultParentId(d) {
  return d.parentId;
}

function stratify() {
  var id = defaultId,
      parentId = defaultParentId,
      path;

  function stratify(data) {
    var nodes = Array.from(data),
        currentId = id,
        currentParentId = parentId,
        n,
        d,
        i,
        root,
        parent,
        node,
        nodeId,
        nodeKey,
        nodeByKey = new Map;

    if (path != null) {
      const I = nodes.map((d, i) => normalize$1(path(d, i, data)));
      const P = I.map(parentof);
      const S = new Set(I).add("");
      for (const i of P) {
        if (!S.has(i)) {
          S.add(i);
          I.push(i);
          P.push(parentof(i));
          nodes.push(imputed);
        }
      }
      currentId = (_, i) => I[i];
      currentParentId = (_, i) => P[i];
    }

    for (i = 0, n = nodes.length; i < n; ++i) {
      d = nodes[i], node = nodes[i] = new Node$1(d);
      if ((nodeId = currentId(d, i, data)) != null && (nodeId += "")) {
        nodeKey = node.id = nodeId;
        nodeByKey.set(nodeKey, nodeByKey.has(nodeKey) ? ambiguous : node);
      }
      if ((nodeId = currentParentId(d, i, data)) != null && (nodeId += "")) {
        node.parent = nodeId;
      }
    }

    for (i = 0; i < n; ++i) {
      node = nodes[i];
      if (nodeId = node.parent) {
        parent = nodeByKey.get(nodeId);
        if (!parent) throw new Error("missing: " + nodeId);
        if (parent === ambiguous) throw new Error("ambiguous: " + nodeId);
        if (parent.children) parent.children.push(node);
        else parent.children = [node];
        node.parent = parent;
      } else {
        if (root) throw new Error("multiple roots");
        root = node;
      }
    }

    if (!root) throw new Error("no root");

    // When imputing internal nodes, only introduce roots if needed.
    // Then replace the imputed marker data with null.
    if (path != null) {
      while (root.data === imputed && root.children.length === 1) {
        root = root.children[0], --n;
      }
      for (let i = nodes.length - 1; i >= 0; --i) {
        node = nodes[i];
        if (node.data !== imputed) break;
        node.data = null;
      }
    }

    root.parent = preroot;
    root.eachBefore(function(node) { node.depth = node.parent.depth + 1; --n; }).eachBefore(computeHeight);
    root.parent = null;
    if (n > 0) throw new Error("cycle");

    return root;
  }

  stratify.id = function(x) {
    return arguments.length ? (id = optional(x), stratify) : id;
  };

  stratify.parentId = function(x) {
    return arguments.length ? (parentId = optional(x), stratify) : parentId;
  };

  stratify.path = function(x) {
    return arguments.length ? (path = optional(x), stratify) : path;
  };

  return stratify;
}

// To normalize a path, we coerce to a string, strip the trailing slash if any
// (as long as the trailing slash is not immediately preceded by another slash),
// and add leading slash if missing.
function normalize$1(path) {
  path = `${path}`;
  let i = path.length;
  if (slash(path, i - 1) && !slash(path, i - 2)) path = path.slice(0, -1);
  return path[0] === "/" ? path : `/${path}`;
}

// Walk backwards to find the first slash that is not the leading slash, e.g.:
// "/foo/bar" ⇥ "/foo", "/foo" ⇥ "/", "/" ↦ "". (The root is special-cased
// because the id of the root must be a truthy value.)
function parentof(path) {
  let i = path.length;
  if (i < 2) return "";
  while (--i > 1) if (slash(path, i)) break;
  return path.slice(0, i);
}

// Slashes can be escaped; to determine whether a slash is a path delimiter, we
// count the number of preceding backslashes escaping the forward slash: an odd
// number indicates an escaped forward slash.
function slash(path, i) {
  if (path[i] === "/") {
    let k = 0;
    while (i > 0 && path[--i] === "\\") ++k;
    if ((k & 1) === 0) return true;
  }
  return false;
}

function defaultSeparation(a, b) {
  return a.parent === b.parent ? 1 : 2;
}

// function radialSeparation(a, b) {
//   return (a.parent === b.parent ? 1 : 2) / a.depth;
// }

// This function is used to traverse the left contour of a subtree (or
// subforest). It returns the successor of v on this contour. This successor is
// either given by the leftmost child of v or by the thread of v. The function
// returns null if and only if v is on the highest level of its subtree.
function nextLeft(v) {
  var children = v.children;
  return children ? children[0] : v.t;
}

// This function works analogously to nextLeft.
function nextRight(v) {
  var children = v.children;
  return children ? children[children.length - 1] : v.t;
}

// Shifts the current subtree rooted at w+. This is done by increasing
// prelim(w+) and mod(w+) by shift.
function moveSubtree(wm, wp, shift) {
  var change = shift / (wp.i - wm.i);
  wp.c -= change;
  wp.s += shift;
  wm.c += change;
  wp.z += shift;
  wp.m += shift;
}

// All other shifts, applied to the smaller subtrees between w- and w+, are
// performed by this function. To prepare the shifts, we have to adjust
// change(w+), shift(w+), and change(w-).
function executeShifts(v) {
  var shift = 0,
      change = 0,
      children = v.children,
      i = children.length,
      w;
  while (--i >= 0) {
    w = children[i];
    w.z += shift;
    w.m += shift;
    shift += w.s + (change += w.c);
  }
}

// If vi-’s ancestor is a sibling of v, returns vi-’s ancestor. Otherwise,
// returns the specified (default) ancestor.
function nextAncestor(vim, v, ancestor) {
  return vim.a.parent === v.parent ? vim.a : ancestor;
}

function TreeNode(node, i) {
  this._ = node;
  this.parent = null;
  this.children = null;
  this.A = null; // default ancestor
  this.a = this; // ancestor
  this.z = 0; // prelim
  this.m = 0; // mod
  this.c = 0; // change
  this.s = 0; // shift
  this.t = null; // thread
  this.i = i; // number
}

TreeNode.prototype = Object.create(Node$1.prototype);

function treeRoot(root) {
  var tree = new TreeNode(root, 0),
      node,
      nodes = [tree],
      child,
      children,
      i,
      n;

  while (node = nodes.pop()) {
    if (children = node._.children) {
      node.children = new Array(n = children.length);
      for (i = n - 1; i >= 0; --i) {
        nodes.push(child = node.children[i] = new TreeNode(children[i], i));
        child.parent = node;
      }
    }
  }

  (tree.parent = new TreeNode(null, 0)).children = [tree];
  return tree;
}

// Node-link tree diagram using the Reingold-Tilford "tidy" algorithm
function tree() {
  var separation = defaultSeparation,
      dx = 1,
      dy = 1,
      nodeSize = null;

  function tree(root) {
    var t = treeRoot(root);

    // Compute the layout using Buchheim et al.’s algorithm.
    t.eachAfter(firstWalk), t.parent.m = -t.z;
    t.eachBefore(secondWalk);

    // If a fixed node size is specified, scale x and y.
    if (nodeSize) root.eachBefore(sizeNode);

    // If a fixed tree size is specified, scale x and y based on the extent.
    // Compute the left-most, right-most, and depth-most nodes for extents.
    else {
      var left = root,
          right = root,
          bottom = root;
      root.eachBefore(function(node) {
        if (node.x < left.x) left = node;
        if (node.x > right.x) right = node;
        if (node.depth > bottom.depth) bottom = node;
      });
      var s = left === right ? 1 : separation(left, right) / 2,
          tx = s - left.x,
          kx = dx / (right.x + s + tx),
          ky = dy / (bottom.depth || 1);
      root.eachBefore(function(node) {
        node.x = (node.x + tx) * kx;
        node.y = node.depth * ky;
      });
    }

    return root;
  }

  // Computes a preliminary x-coordinate for v. Before that, FIRST WALK is
  // applied recursively to the children of v, as well as the function
  // APPORTION. After spacing out the children by calling EXECUTE SHIFTS, the
  // node v is placed to the midpoint of its outermost children.
  function firstWalk(v) {
    var children = v.children,
        siblings = v.parent.children,
        w = v.i ? siblings[v.i - 1] : null;
    if (children) {
      executeShifts(v);
      var midpoint = (children[0].z + children[children.length - 1].z) / 2;
      if (w) {
        v.z = w.z + separation(v._, w._);
        v.m = v.z - midpoint;
      } else {
        v.z = midpoint;
      }
    } else if (w) {
      v.z = w.z + separation(v._, w._);
    }
    v.parent.A = apportion(v, w, v.parent.A || siblings[0]);
  }

  // Computes all real x-coordinates by summing up the modifiers recursively.
  function secondWalk(v) {
    v._.x = v.z + v.parent.m;
    v.m += v.parent.m;
  }

  // The core of the algorithm. Here, a new subtree is combined with the
  // previous subtrees. Threads are used to traverse the inside and outside
  // contours of the left and right subtree up to the highest common level. The
  // vertices used for the traversals are vi+, vi-, vo-, and vo+, where the
  // superscript o means outside and i means inside, the subscript - means left
  // subtree and + means right subtree. For summing up the modifiers along the
  // contour, we use respective variables si+, si-, so-, and so+. Whenever two
  // nodes of the inside contours conflict, we compute the left one of the
  // greatest uncommon ancestors using the function ANCESTOR and call MOVE
  // SUBTREE to shift the subtree and prepare the shifts of smaller subtrees.
  // Finally, we add a new thread (if necessary).
  function apportion(v, w, ancestor) {
    if (w) {
      var vip = v,
          vop = v,
          vim = w,
          vom = vip.parent.children[0],
          sip = vip.m,
          sop = vop.m,
          sim = vim.m,
          som = vom.m,
          shift;
      while (vim = nextRight(vim), vip = nextLeft(vip), vim && vip) {
        vom = nextLeft(vom);
        vop = nextRight(vop);
        vop.a = v;
        shift = vim.z + sim - vip.z - sip + separation(vim._, vip._);
        if (shift > 0) {
          moveSubtree(nextAncestor(vim, v, ancestor), v, shift);
          sip += shift;
          sop += shift;
        }
        sim += vim.m;
        sip += vip.m;
        som += vom.m;
        sop += vop.m;
      }
      if (vim && !nextRight(vop)) {
        vop.t = vim;
        vop.m += sim - sop;
      }
      if (vip && !nextLeft(vom)) {
        vom.t = vip;
        vom.m += sip - som;
        ancestor = v;
      }
    }
    return ancestor;
  }

  function sizeNode(node) {
    node.x *= dx;
    node.y = node.depth * dy;
  }

  tree.separation = function(x) {
    return arguments.length ? (separation = x, tree) : separation;
  };

  tree.size = function(x) {
    return arguments.length ? (nodeSize = false, dx = +x[0], dy = +x[1], tree) : (nodeSize ? null : [dx, dy]);
  };

  tree.nodeSize = function(x) {
    return arguments.length ? (nodeSize = true, dx = +x[0], dy = +x[1], tree) : (nodeSize ? [dx, dy] : null);
  };

  return tree;
}

function treemapSlice(parent, x0, y0, x1, y1) {
  var nodes = parent.children,
      node,
      i = -1,
      n = nodes.length,
      k = parent.value && (y1 - y0) / parent.value;

  while (++i < n) {
    node = nodes[i], node.x0 = x0, node.x1 = x1;
    node.y0 = y0, node.y1 = y0 += node.value * k;
  }
}

var phi = (1 + Math.sqrt(5)) / 2;

function squarifyRatio(ratio, parent, x0, y0, x1, y1) {
  var rows = [],
      nodes = parent.children,
      row,
      nodeValue,
      i0 = 0,
      i1 = 0,
      n = nodes.length,
      dx, dy,
      value = parent.value,
      sumValue,
      minValue,
      maxValue,
      newRatio,
      minRatio,
      alpha,
      beta;

  while (i0 < n) {
    dx = x1 - x0, dy = y1 - y0;

    // Find the next non-empty node.
    do sumValue = nodes[i1++].value; while (!sumValue && i1 < n);
    minValue = maxValue = sumValue;
    alpha = Math.max(dy / dx, dx / dy) / (value * ratio);
    beta = sumValue * sumValue * alpha;
    minRatio = Math.max(maxValue / beta, beta / minValue);

    // Keep adding nodes while the aspect ratio maintains or improves.
    for (; i1 < n; ++i1) {
      sumValue += nodeValue = nodes[i1].value;
      if (nodeValue < minValue) minValue = nodeValue;
      if (nodeValue > maxValue) maxValue = nodeValue;
      beta = sumValue * sumValue * alpha;
      newRatio = Math.max(maxValue / beta, beta / minValue);
      if (newRatio > minRatio) { sumValue -= nodeValue; break; }
      minRatio = newRatio;
    }

    // Position and record the row orientation.
    rows.push(row = {value: sumValue, dice: dx < dy, children: nodes.slice(i0, i1)});
    if (row.dice) treemapDice(row, x0, y0, x1, value ? y0 += dy * sumValue / value : y1);
    else treemapSlice(row, x0, y0, value ? x0 += dx * sumValue / value : x1, y1);
    value -= sumValue, i0 = i1;
  }

  return rows;
}

var squarify = (function custom(ratio) {

  function squarify(parent, x0, y0, x1, y1) {
    squarifyRatio(ratio, parent, x0, y0, x1, y1);
  }

  squarify.ratio = function(x) {
    return custom((x = +x) > 1 ? x : 1);
  };

  return squarify;
})(phi);

function index$2() {
  var tile = squarify,
      round = false,
      dx = 1,
      dy = 1,
      paddingStack = [0],
      paddingInner = constantZero,
      paddingTop = constantZero,
      paddingRight = constantZero,
      paddingBottom = constantZero,
      paddingLeft = constantZero;

  function treemap(root) {
    root.x0 =
    root.y0 = 0;
    root.x1 = dx;
    root.y1 = dy;
    root.eachBefore(positionNode);
    paddingStack = [0];
    if (round) root.eachBefore(roundNode);
    return root;
  }

  function positionNode(node) {
    var p = paddingStack[node.depth],
        x0 = node.x0 + p,
        y0 = node.y0 + p,
        x1 = node.x1 - p,
        y1 = node.y1 - p;
    if (x1 < x0) x0 = x1 = (x0 + x1) / 2;
    if (y1 < y0) y0 = y1 = (y0 + y1) / 2;
    node.x0 = x0;
    node.y0 = y0;
    node.x1 = x1;
    node.y1 = y1;
    if (node.children) {
      p = paddingStack[node.depth + 1] = paddingInner(node) / 2;
      x0 += paddingLeft(node) - p;
      y0 += paddingTop(node) - p;
      x1 -= paddingRight(node) - p;
      y1 -= paddingBottom(node) - p;
      if (x1 < x0) x0 = x1 = (x0 + x1) / 2;
      if (y1 < y0) y0 = y1 = (y0 + y1) / 2;
      tile(node, x0, y0, x1, y1);
    }
  }

  treemap.round = function(x) {
    return arguments.length ? (round = !!x, treemap) : round;
  };

  treemap.size = function(x) {
    return arguments.length ? (dx = +x[0], dy = +x[1], treemap) : [dx, dy];
  };

  treemap.tile = function(x) {
    return arguments.length ? (tile = required(x), treemap) : tile;
  };

  treemap.padding = function(x) {
    return arguments.length ? treemap.paddingInner(x).paddingOuter(x) : treemap.paddingInner();
  };

  treemap.paddingInner = function(x) {
    return arguments.length ? (paddingInner = typeof x === "function" ? x : constant$2(+x), treemap) : paddingInner;
  };

  treemap.paddingOuter = function(x) {
    return arguments.length ? treemap.paddingTop(x).paddingRight(x).paddingBottom(x).paddingLeft(x) : treemap.paddingTop();
  };

  treemap.paddingTop = function(x) {
    return arguments.length ? (paddingTop = typeof x === "function" ? x : constant$2(+x), treemap) : paddingTop;
  };

  treemap.paddingRight = function(x) {
    return arguments.length ? (paddingRight = typeof x === "function" ? x : constant$2(+x), treemap) : paddingRight;
  };

  treemap.paddingBottom = function(x) {
    return arguments.length ? (paddingBottom = typeof x === "function" ? x : constant$2(+x), treemap) : paddingBottom;
  };

  treemap.paddingLeft = function(x) {
    return arguments.length ? (paddingLeft = typeof x === "function" ? x : constant$2(+x), treemap) : paddingLeft;
  };

  return treemap;
}

function binary(parent, x0, y0, x1, y1) {
  var nodes = parent.children,
      i, n = nodes.length,
      sum, sums = new Array(n + 1);

  for (sums[0] = sum = i = 0; i < n; ++i) {
    sums[i + 1] = sum += nodes[i].value;
  }

  partition(0, n, parent.value, x0, y0, x1, y1);

  function partition(i, j, value, x0, y0, x1, y1) {
    if (i >= j - 1) {
      var node = nodes[i];
      node.x0 = x0, node.y0 = y0;
      node.x1 = x1, node.y1 = y1;
      return;
    }

    var valueOffset = sums[i],
        valueTarget = (value / 2) + valueOffset,
        k = i + 1,
        hi = j - 1;

    while (k < hi) {
      var mid = k + hi >>> 1;
      if (sums[mid] < valueTarget) k = mid + 1;
      else hi = mid;
    }

    if ((valueTarget - sums[k - 1]) < (sums[k] - valueTarget) && i + 1 < k) --k;

    var valueLeft = sums[k] - valueOffset,
        valueRight = value - valueLeft;

    if ((x1 - x0) > (y1 - y0)) {
      var xk = value ? (x0 * valueRight + x1 * valueLeft) / value : x1;
      partition(i, k, valueLeft, x0, y0, xk, y1);
      partition(k, j, valueRight, xk, y0, x1, y1);
    } else {
      var yk = value ? (y0 * valueRight + y1 * valueLeft) / value : y1;
      partition(i, k, valueLeft, x0, y0, x1, yk);
      partition(k, j, valueRight, x0, yk, x1, y1);
    }
  }
}

function sliceDice(parent, x0, y0, x1, y1) {
  (parent.depth & 1 ? treemapSlice : treemapDice)(parent, x0, y0, x1, y1);
}

var resquarify = (function custom(ratio) {

  function resquarify(parent, x0, y0, x1, y1) {
    if ((rows = parent._squarify) && (rows.ratio === ratio)) {
      var rows,
          row,
          nodes,
          i,
          j = -1,
          n,
          m = rows.length,
          value = parent.value;

      while (++j < m) {
        row = rows[j], nodes = row.children;
        for (i = row.value = 0, n = nodes.length; i < n; ++i) row.value += nodes[i].value;
        if (row.dice) treemapDice(row, x0, y0, x1, value ? y0 += (y1 - y0) * row.value / value : y1);
        else treemapSlice(row, x0, y0, value ? x0 += (x1 - x0) * row.value / value : x1, y1);
        value -= row.value;
      }
    } else {
      parent._squarify = rows = squarifyRatio(ratio, parent, x0, y0, x1, y1);
      rows.ratio = ratio;
    }
  }

  resquarify.ratio = function(x) {
    return custom((x = +x) > 1 ? x : 1);
  };

  return resquarify;
})(phi);

function area$1(polygon) {
  var i = -1,
      n = polygon.length,
      a,
      b = polygon[n - 1],
      area = 0;

  while (++i < n) {
    a = b;
    b = polygon[i];
    area += a[1] * b[0] - a[0] * b[1];
  }

  return area / 2;
}

function centroid(polygon) {
  var i = -1,
      n = polygon.length,
      x = 0,
      y = 0,
      a,
      b = polygon[n - 1],
      c,
      k = 0;

  while (++i < n) {
    a = b;
    b = polygon[i];
    k += c = a[0] * b[1] - b[0] * a[1];
    x += (a[0] + b[0]) * c;
    y += (a[1] + b[1]) * c;
  }

  return k *= 3, [x / k, y / k];
}

// Returns the 2D cross product of AB and AC vectors, i.e., the z-component of
// the 3D cross product in a quadrant I Cartesian coordinate system (+x is
// right, +y is up). Returns a positive value if ABC is counter-clockwise,
// negative if clockwise, and zero if the points are collinear.
function cross$1(a, b, c) {
  return (b[0] - a[0]) * (c[1] - a[1]) - (b[1] - a[1]) * (c[0] - a[0]);
}

function lexicographicOrder(a, b) {
  return a[0] - b[0] || a[1] - b[1];
}

// Computes the upper convex hull per the monotone chain algorithm.
// Assumes points.length >= 3, is sorted by x, unique in y.
// Returns an array of indices into points in left-to-right order.
function computeUpperHullIndexes(points) {
  const n = points.length,
      indexes = [0, 1];
  let size = 2, i;

  for (i = 2; i < n; ++i) {
    while (size > 1 && cross$1(points[indexes[size - 2]], points[indexes[size - 1]], points[i]) <= 0) --size;
    indexes[size++] = i;
  }

  return indexes.slice(0, size); // remove popped points
}

function hull(points) {
  if ((n = points.length) < 3) return null;

  var i,
      n,
      sortedPoints = new Array(n),
      flippedPoints = new Array(n);

  for (i = 0; i < n; ++i) sortedPoints[i] = [+points[i][0], +points[i][1], i];
  sortedPoints.sort(lexicographicOrder);
  for (i = 0; i < n; ++i) flippedPoints[i] = [sortedPoints[i][0], -sortedPoints[i][1]];

  var upperIndexes = computeUpperHullIndexes(sortedPoints),
      lowerIndexes = computeUpperHullIndexes(flippedPoints);

  // Construct the hull polygon, removing possible duplicate endpoints.
  var skipLeft = lowerIndexes[0] === upperIndexes[0],
      skipRight = lowerIndexes[lowerIndexes.length - 1] === upperIndexes[upperIndexes.length - 1],
      hull = [];

  // Add upper hull in right-to-l order.
  // Then add lower hull in left-to-right order.
  for (i = upperIndexes.length - 1; i >= 0; --i) hull.push(points[sortedPoints[upperIndexes[i]][2]]);
  for (i = +skipLeft; i < lowerIndexes.length - skipRight; ++i) hull.push(points[sortedPoints[lowerIndexes[i]][2]]);

  return hull;
}

function contains(polygon, point) {
  var n = polygon.length,
      p = polygon[n - 1],
      x = point[0], y = point[1],
      x0 = p[0], y0 = p[1],
      x1, y1,
      inside = false;

  for (var i = 0; i < n; ++i) {
    p = polygon[i], x1 = p[0], y1 = p[1];
    if (((y1 > y) !== (y0 > y)) && (x < (x0 - x1) * (y - y1) / (y0 - y1) + x1)) inside = !inside;
    x0 = x1, y0 = y1;
  }

  return inside;
}

function length(polygon) {
  var i = -1,
      n = polygon.length,
      b = polygon[n - 1],
      xa,
      ya,
      xb = b[0],
      yb = b[1],
      perimeter = 0;

  while (++i < n) {
    xa = xb;
    ya = yb;
    b = polygon[i];
    xb = b[0];
    yb = b[1];
    xa -= xb;
    ya -= yb;
    perimeter += Math.hypot(xa, ya);
  }

  return perimeter;
}

var defaultSource = Math.random;

var uniform = (function sourceRandomUniform(source) {
  function randomUniform(min, max) {
    min = min == null ? 0 : +min;
    max = max == null ? 1 : +max;
    if (arguments.length === 1) max = min, min = 0;
    else max -= min;
    return function() {
      return source() * max + min;
    };
  }

  randomUniform.source = sourceRandomUniform;

  return randomUniform;
})(defaultSource);

var int = (function sourceRandomInt(source) {
  function randomInt(min, max) {
    if (arguments.length < 2) max = min, min = 0;
    min = Math.floor(min);
    max = Math.floor(max) - min;
    return function() {
      return Math.floor(source() * max + min);
    };
  }

  randomInt.source = sourceRandomInt;

  return randomInt;
})(defaultSource);

var normal = (function sourceRandomNormal(source) {
  function randomNormal(mu, sigma) {
    var x, r;
    mu = mu == null ? 0 : +mu;
    sigma = sigma == null ? 1 : +sigma;
    return function() {
      var y;

      // If available, use the second previously-generated uniform random.
      if (x != null) y = x, x = null;

      // Otherwise, generate a new x and y.
      else do {
        x = source() * 2 - 1;
        y = source() * 2 - 1;
        r = x * x + y * y;
      } while (!r || r > 1);

      return mu + sigma * y * Math.sqrt(-2 * Math.log(r) / r);
    };
  }

  randomNormal.source = sourceRandomNormal;

  return randomNormal;
})(defaultSource);

var logNormal = (function sourceRandomLogNormal(source) {
  var N = normal.source(source);

  function randomLogNormal() {
    var randomNormal = N.apply(this, arguments);
    return function() {
      return Math.exp(randomNormal());
    };
  }

  randomLogNormal.source = sourceRandomLogNormal;

  return randomLogNormal;
})(defaultSource);

var irwinHall = (function sourceRandomIrwinHall(source) {
  function randomIrwinHall(n) {
    if ((n = +n) <= 0) return () => 0;
    return function() {
      for (var sum = 0, i = n; i > 1; --i) sum += source();
      return sum + i * source();
    };
  }

  randomIrwinHall.source = sourceRandomIrwinHall;

  return randomIrwinHall;
})(defaultSource);

var bates = (function sourceRandomBates(source) {
  var I = irwinHall.source(source);

  function randomBates(n) {
    // use limiting distribution at n === 0
    if ((n = +n) === 0) return source;
    var randomIrwinHall = I(n);
    return function() {
      return randomIrwinHall() / n;
    };
  }

  randomBates.source = sourceRandomBates;

  return randomBates;
})(defaultSource);

var exponential = (function sourceRandomExponential(source) {
  function randomExponential(lambda) {
    return function() {
      return -Math.log1p(-source()) / lambda;
    };
  }

  randomExponential.source = sourceRandomExponential;

  return randomExponential;
})(defaultSource);

var pareto = (function sourceRandomPareto(source) {
  function randomPareto(alpha) {
    if ((alpha = +alpha) < 0) throw new RangeError("invalid alpha");
    alpha = 1 / -alpha;
    return function() {
      return Math.pow(1 - source(), alpha);
    };
  }

  randomPareto.source = sourceRandomPareto;

  return randomPareto;
})(defaultSource);

var bernoulli = (function sourceRandomBernoulli(source) {
  function randomBernoulli(p) {
    if ((p = +p) < 0 || p > 1) throw new RangeError("invalid p");
    return function() {
      return Math.floor(source() + p);
    };
  }

  randomBernoulli.source = sourceRandomBernoulli;

  return randomBernoulli;
})(defaultSource);

var geometric = (function sourceRandomGeometric(source) {
  function randomGeometric(p) {
    if ((p = +p) < 0 || p > 1) throw new RangeError("invalid p");
    if (p === 0) return () => Infinity;
    if (p === 1) return () => 1;
    p = Math.log1p(-p);
    return function() {
      return 1 + Math.floor(Math.log1p(-source()) / p);
    };
  }

  randomGeometric.source = sourceRandomGeometric;

  return randomGeometric;
})(defaultSource);

var gamma = (function sourceRandomGamma(source) {
  var randomNormal = normal.source(source)();

  function randomGamma(k, theta) {
    if ((k = +k) < 0) throw new RangeError("invalid k");
    // degenerate distribution if k === 0
    if (k === 0) return () => 0;
    theta = theta == null ? 1 : +theta;
    // exponential distribution if k === 1
    if (k === 1) return () => -Math.log1p(-source()) * theta;

    var d = (k < 1 ? k + 1 : k) - 1 / 3,
        c = 1 / (3 * Math.sqrt(d)),
        multiplier = k < 1 ? () => Math.pow(source(), 1 / k) : () => 1;
    return function() {
      do {
        do {
          var x = randomNormal(),
              v = 1 + c * x;
        } while (v <= 0);
        v *= v * v;
        var u = 1 - source();
      } while (u >= 1 - 0.0331 * x * x * x * x && Math.log(u) >= 0.5 * x * x + d * (1 - v + Math.log(v)));
      return d * v * multiplier() * theta;
    };
  }

  randomGamma.source = sourceRandomGamma;

  return randomGamma;
})(defaultSource);

var beta = (function sourceRandomBeta(source) {
  var G = gamma.source(source);

  function randomBeta(alpha, beta) {
    var X = G(alpha),
        Y = G(beta);
    return function() {
      var x = X();
      return x === 0 ? 0 : x / (x + Y());
    };
  }

  randomBeta.source = sourceRandomBeta;

  return randomBeta;
})(defaultSource);

var binomial = (function sourceRandomBinomial(source) {
  var G = geometric.source(source),
      B = beta.source(source);

  function randomBinomial(n, p) {
    n = +n;
    if ((p = +p) >= 1) return () => n;
    if (p <= 0) return () => 0;
    return function() {
      var acc = 0, nn = n, pp = p;
      while (nn * pp > 16 && nn * (1 - pp) > 16) {
        var i = Math.floor((nn + 1) * pp),
            y = B(i, nn - i + 1)();
        if (y <= pp) {
          acc += i;
          nn -= i;
          pp = (pp - y) / (1 - y);
        } else {
          nn = i - 1;
          pp /= y;
        }
      }
      var sign = pp < 0.5,
          pFinal = sign ? pp : 1 - pp,
          g = G(pFinal);
      for (var s = g(), k = 0; s <= nn; ++k) s += g();
      return acc + (sign ? k : nn - k);
    };
  }

  randomBinomial.source = sourceRandomBinomial;

  return randomBinomial;
})(defaultSource);

var weibull = (function sourceRandomWeibull(source) {
  function randomWeibull(k, a, b) {
    var outerFunc;
    if ((k = +k) === 0) {
      outerFunc = x => -Math.log(x);
    } else {
      k = 1 / k;
      outerFunc = x => Math.pow(x, k);
    }
    a = a == null ? 0 : +a;
    b = b == null ? 1 : +b;
    return function() {
      return a + b * outerFunc(-Math.log1p(-source()));
    };
  }

  randomWeibull.source = sourceRandomWeibull;

  return randomWeibull;
})(defaultSource);

var cauchy = (function sourceRandomCauchy(source) {
  function randomCauchy(a, b) {
    a = a == null ? 0 : +a;
    b = b == null ? 1 : +b;
    return function() {
      return a + b * Math.tan(Math.PI * source());
    };
  }

  randomCauchy.source = sourceRandomCauchy;

  return randomCauchy;
})(defaultSource);

var logistic = (function sourceRandomLogistic(source) {
  function randomLogistic(a, b) {
    a = a == null ? 0 : +a;
    b = b == null ? 1 : +b;
    return function() {
      var u = source();
      return a + b * Math.log(u / (1 - u));
    };
  }

  randomLogistic.source = sourceRandomLogistic;

  return randomLogistic;
})(defaultSource);

var poisson = (function sourceRandomPoisson(source) {
  var G = gamma.source(source),
      B = binomial.source(source);

  function randomPoisson(lambda) {
    return function() {
      var acc = 0, l = lambda;
      while (l > 16) {
        var n = Math.floor(0.875 * l),
            t = G(n)();
        if (t > l) return acc + B(n - 1, l / t)();
        acc += n;
        l -= t;
      }
      for (var s = -Math.log1p(-source()), k = 0; s <= l; ++k) s -= Math.log1p(-source());
      return acc + k;
    };
  }

  randomPoisson.source = sourceRandomPoisson;

  return randomPoisson;
})(defaultSource);

// https://en.wikipedia.org/wiki/Linear_congruential_generator#Parameters_in_common_use
const mul = 0x19660D;
const inc = 0x3C6EF35F;
const eps = 1 / 0x100000000;

function lcg(seed = Math.random()) {
  let state = (0 <= seed && seed < 1 ? seed / eps : Math.abs(seed)) | 0;
  return () => (state = mul * state + inc | 0, eps * (state >>> 0));
}

function initRange(domain, range) {
  switch (arguments.length) {
    case 0: break;
    case 1: this.range(domain); break;
    default: this.range(range).domain(domain); break;
  }
  return this;
}

function initInterpolator(domain, interpolator) {
  switch (arguments.length) {
    case 0: break;
    case 1: {
      if (typeof domain === "function") this.interpolator(domain);
      else this.range(domain);
      break;
    }
    default: {
      this.domain(domain);
      if (typeof interpolator === "function") this.interpolator(interpolator);
      else this.range(interpolator);
      break;
    }
  }
  return this;
}

const implicit = Symbol("implicit");

function ordinal() {
  var index = new InternMap(),
      domain = [],
      range = [],
      unknown = implicit;

  function scale(d) {
    let i = index.get(d);
    if (i === undefined) {
      if (unknown !== implicit) return unknown;
      index.set(d, i = domain.push(d) - 1);
    }
    return range[i % range.length];
  }

  scale.domain = function(_) {
    if (!arguments.length) return domain.slice();
    domain = [], index = new InternMap();
    for (const value of _) {
      if (index.has(value)) continue;
      index.set(value, domain.push(value) - 1);
    }
    return scale;
  };

  scale.range = function(_) {
    return arguments.length ? (range = Array.from(_), scale) : range.slice();
  };

  scale.unknown = function(_) {
    return arguments.length ? (unknown = _, scale) : unknown;
  };

  scale.copy = function() {
    return ordinal(domain, range).unknown(unknown);
  };

  initRange.apply(scale, arguments);

  return scale;
}

function band() {
  var scale = ordinal().unknown(undefined),
      domain = scale.domain,
      ordinalRange = scale.range,
      r0 = 0,
      r1 = 1,
      step,
      bandwidth,
      round = false,
      paddingInner = 0,
      paddingOuter = 0,
      align = 0.5;

  delete scale.unknown;

  function rescale() {
    var n = domain().length,
        reverse = r1 < r0,
        start = reverse ? r1 : r0,
        stop = reverse ? r0 : r1;
    step = (stop - start) / Math.max(1, n - paddingInner + paddingOuter * 2);
    if (round) step = Math.floor(step);
    start += (stop - start - step * (n - paddingInner)) * align;
    bandwidth = step * (1 - paddingInner);
    if (round) start = Math.round(start), bandwidth = Math.round(bandwidth);
    var values = range$2(n).map(function(i) { return start + step * i; });
    return ordinalRange(reverse ? values.reverse() : values);
  }

  scale.domain = function(_) {
    return arguments.length ? (domain(_), rescale()) : domain();
  };

  scale.range = function(_) {
    return arguments.length ? ([r0, r1] = _, r0 = +r0, r1 = +r1, rescale()) : [r0, r1];
  };

  scale.rangeRound = function(_) {
    return [r0, r1] = _, r0 = +r0, r1 = +r1, round = true, rescale();
  };

  scale.bandwidth = function() {
    return bandwidth;
  };

  scale.step = function() {
    return step;
  };

  scale.round = function(_) {
    return arguments.length ? (round = !!_, rescale()) : round;
  };

  scale.padding = function(_) {
    return arguments.length ? (paddingInner = Math.min(1, paddingOuter = +_), rescale()) : paddingInner;
  };

  scale.paddingInner = function(_) {
    return arguments.length ? (paddingInner = Math.min(1, _), rescale()) : paddingInner;
  };

  scale.paddingOuter = function(_) {
    return arguments.length ? (paddingOuter = +_, rescale()) : paddingOuter;
  };

  scale.align = function(_) {
    return arguments.length ? (align = Math.max(0, Math.min(1, _)), rescale()) : align;
  };

  scale.copy = function() {
    return band(domain(), [r0, r1])
        .round(round)
        .paddingInner(paddingInner)
        .paddingOuter(paddingOuter)
        .align(align);
  };

  return initRange.apply(rescale(), arguments);
}

function pointish(scale) {
  var copy = scale.copy;

  scale.padding = scale.paddingOuter;
  delete scale.paddingInner;
  delete scale.paddingOuter;

  scale.copy = function() {
    return pointish(copy());
  };

  return scale;
}

function point$4() {
  return pointish(band.apply(null, arguments).paddingInner(1));
}

function constants(x) {
  return function() {
    return x;
  };
}

function number$1(x) {
  return +x;
}

var unit = [0, 1];

function identity$3(x) {
  return x;
}

function normalize(a, b) {
  return (b -= (a = +a))
      ? function(x) { return (x - a) / b; }
      : constants(isNaN(b) ? NaN : 0.5);
}

function clamper(a, b) {
  var t;
  if (a > b) t = a, a = b, b = t;
  return function(x) { return Math.max(a, Math.min(b, x)); };
}

// normalize(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].
// interpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding range value x in [a,b].
function bimap(domain, range, interpolate) {
  var d0 = domain[0], d1 = domain[1], r0 = range[0], r1 = range[1];
  if (d1 < d0) d0 = normalize(d1, d0), r0 = interpolate(r1, r0);
  else d0 = normalize(d0, d1), r0 = interpolate(r0, r1);
  return function(x) { return r0(d0(x)); };
}

function polymap(domain, range, interpolate) {
  var j = Math.min(domain.length, range.length) - 1,
      d = new Array(j),
      r = new Array(j),
      i = -1;

  // Reverse descending domains.
  if (domain[j] < domain[0]) {
    domain = domain.slice().reverse();
    range = range.slice().reverse();
  }

  while (++i < j) {
    d[i] = normalize(domain[i], domain[i + 1]);
    r[i] = interpolate(range[i], range[i + 1]);
  }

  return function(x) {
    var i = bisect(domain, x, 1, j) - 1;
    return r[i](d[i](x));
  };
}

function copy$1(source, target) {
  return target
      .domain(source.domain())
      .range(source.range())
      .interpolate(source.interpolate())
      .clamp(source.clamp())
      .unknown(source.unknown());
}

function transformer$2() {
  var domain = unit,
      range = unit,
      interpolate = interpolate$2,
      transform,
      untransform,
      unknown,
      clamp = identity$3,
      piecewise,
      output,
      input;

  function rescale() {
    var n = Math.min(domain.length, range.length);
    if (clamp !== identity$3) clamp = clamper(domain[0], domain[n - 1]);
    piecewise = n > 2 ? polymap : bimap;
    output = input = null;
    return scale;
  }

  function scale(x) {
    return x == null || isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate)))(transform(clamp(x)));
  }

  scale.invert = function(y) {
    return clamp(untransform((input || (input = piecewise(range, domain.map(transform), interpolateNumber)))(y)));
  };

  scale.domain = function(_) {
    return arguments.length ? (domain = Array.from(_, number$1), rescale()) : domain.slice();
  };

  scale.range = function(_) {
    return arguments.length ? (range = Array.from(_), rescale()) : range.slice();
  };

  scale.rangeRound = function(_) {
    return range = Array.from(_), interpolate = interpolateRound, rescale();
  };

  scale.clamp = function(_) {
    return arguments.length ? (clamp = _ ? true : identity$3, rescale()) : clamp !== identity$3;
  };

  scale.interpolate = function(_) {
    return arguments.length ? (interpolate = _, rescale()) : interpolate;
  };

  scale.unknown = function(_) {
    return arguments.length ? (unknown = _, scale) : unknown;
  };

  return function(t, u) {
    transform = t, untransform = u;
    return rescale();
  };
}

function continuous() {
  return transformer$2()(identity$3, identity$3);
}

function tickFormat(start, stop, count, specifier) {
  var step = tickStep(start, stop, count),
      precision;
  specifier = formatSpecifier(specifier == null ? ",f" : specifier);
  switch (specifier.type) {
    case "s": {
      var value = Math.max(Math.abs(start), Math.abs(stop));
      if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;
      return formatPrefix(specifier, value);
    }
    case "":
    case "e":
    case "g":
    case "p":
    case "r": {
      if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === "e");
      break;
    }
    case "f":
    case "%": {
      if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === "%") * 2;
      break;
    }
  }
  return format(specifier);
}

function linearish(scale) {
  var domain = scale.domain;

  scale.ticks = function(count) {
    var d = domain();
    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);
  };

  scale.tickFormat = function(count, specifier) {
    var d = domain();
    return tickFormat(d[0], d[d.length - 1], count == null ? 10 : count, specifier);
  };

  scale.nice = function(count) {
    if (count == null) count = 10;

    var d = domain();
    var i0 = 0;
    var i1 = d.length - 1;
    var start = d[i0];
    var stop = d[i1];
    var prestep;
    var step;
    var maxIter = 10;

    if (stop < start) {
      step = start, start = stop, stop = step;
      step = i0, i0 = i1, i1 = step;
    }
    
    while (maxIter-- > 0) {
      step = tickIncrement(start, stop, count);
      if (step === prestep) {
        d[i0] = start;
        d[i1] = stop;
        return domain(d);
      } else if (step > 0) {
        start = Math.floor(start / step) * step;
        stop = Math.ceil(stop / step) * step;
      } else if (step < 0) {
        start = Math.ceil(start * step) / step;
        stop = Math.floor(stop * step) / step;
      } else {
        break;
      }
      prestep = step;
    }

    return scale;
  };

  return scale;
}

function linear() {
  var scale = continuous();

  scale.copy = function() {
    return copy$1(scale, linear());
  };

  initRange.apply(scale, arguments);

  return linearish(scale);
}

function identity$2(domain) {
  var unknown;

  function scale(x) {
    return x == null || isNaN(x = +x) ? unknown : x;
  }

  scale.invert = scale;

  scale.domain = scale.range = function(_) {
    return arguments.length ? (domain = Array.from(_, number$1), scale) : domain.slice();
  };

  scale.unknown = function(_) {
    return arguments.length ? (unknown = _, scale) : unknown;
  };

  scale.copy = function() {
    return identity$2(domain).unknown(unknown);
  };

  domain = arguments.length ? Array.from(domain, number$1) : [0, 1];

  return linearish(scale);
}

function nice(domain, interval) {
  domain = domain.slice();

  var i0 = 0,
      i1 = domain.length - 1,
      x0 = domain[i0],
      x1 = domain[i1],
      t;

  if (x1 < x0) {
    t = i0, i0 = i1, i1 = t;
    t = x0, x0 = x1, x1 = t;
  }

  domain[i0] = interval.floor(x0);
  domain[i1] = interval.ceil(x1);
  return domain;
}

function transformLog(x) {
  return Math.log(x);
}

function transformExp(x) {
  return Math.exp(x);
}

function transformLogn(x) {
  return -Math.log(-x);
}

function transformExpn(x) {
  return -Math.exp(-x);
}

function pow10(x) {
  return isFinite(x) ? +("1e" + x) : x < 0 ? 0 : x;
}

function powp(base) {
  return base === 10 ? pow10
      : base === Math.E ? Math.exp
      : x => Math.pow(base, x);
}

function logp(base) {
  return base === Math.E ? Math.log
      : base === 10 && Math.log10
      || base === 2 && Math.log2
      || (base = Math.log(base), x => Math.log(x) / base);
}

function reflect(f) {
  return (x, k) => -f(-x, k);
}

function loggish(transform) {
  const scale = transform(transformLog, transformExp);
  const domain = scale.domain;
  let base = 10;
  let logs;
  let pows;

  function rescale() {
    logs = logp(base), pows = powp(base);
    if (domain()[0] < 0) {
      logs = reflect(logs), pows = reflect(pows);
      transform(transformLogn, transformExpn);
    } else {
      transform(transformLog, transformExp);
    }
    return scale;
  }

  scale.base = function(_) {
    return arguments.length ? (base = +_, rescale()) : base;
  };

  scale.domain = function(_) {
    return arguments.length ? (domain(_), rescale()) : domain();
  };

  scale.ticks = count => {
    const d = domain();
    let u = d[0];
    let v = d[d.length - 1];
    const r = v < u;

    if (r) ([u, v] = [v, u]);

    let i = logs(u);
    let j = logs(v);
    let k;
    let t;
    const n = count == null ? 10 : +count;
    let z = [];

    if (!(base % 1) && j - i < n) {
      i = Math.floor(i), j = Math.ceil(j);
      if (u > 0) for (; i <= j; ++i) {
        for (k = 1; k < base; ++k) {
          t = i < 0 ? k / pows(-i) : k * pows(i);
          if (t < u) continue;
          if (t > v) break;
          z.push(t);
        }
      } else for (; i <= j; ++i) {
        for (k = base - 1; k >= 1; --k) {
          t = i > 0 ? k / pows(-i) : k * pows(i);
          if (t < u) continue;
          if (t > v) break;
          z.push(t);
        }
      }
      if (z.length * 2 < n) z = ticks(u, v, n);
    } else {
      z = ticks(i, j, Math.min(j - i, n)).map(pows);
    }
    return r ? z.reverse() : z;
  };

  scale.tickFormat = (count, specifier) => {
    if (count == null) count = 10;
    if (specifier == null) specifier = base === 10 ? "s" : ",";
    if (typeof specifier !== "function") {
      if (!(base % 1) && (specifier = formatSpecifier(specifier)).precision == null) specifier.trim = true;
      specifier = format(specifier);
    }
    if (count === Infinity) return specifier;
    const k = Math.max(1, base * count / scale.ticks().length); // TODO fast estimate?
    return d => {
      let i = d / pows(Math.round(logs(d)));
      if (i * base < base - 0.5) i *= base;
      return i <= k ? specifier(d) : "";
    };
  };

  scale.nice = () => {
    return domain(nice(domain(), {
      floor: x => pows(Math.floor(logs(x))),
      ceil: x => pows(Math.ceil(logs(x)))
    }));
  };

  return scale;
}

function log() {
  const scale = loggish(transformer$2()).domain([1, 10]);
  scale.copy = () => copy$1(scale, log()).base(scale.base());
  initRange.apply(scale, arguments);
  return scale;
}

function transformSymlog(c) {
  return function(x) {
    return Math.sign(x) * Math.log1p(Math.abs(x / c));
  };
}

function transformSymexp(c) {
  return function(x) {
    return Math.sign(x) * Math.expm1(Math.abs(x)) * c;
  };
}

function symlogish(transform) {
  var c = 1, scale = transform(transformSymlog(c), transformSymexp(c));

  scale.constant = function(_) {
    return arguments.length ? transform(transformSymlog(c = +_), transformSymexp(c)) : c;
  };

  return linearish(scale);
}

function symlog() {
  var scale = symlogish(transformer$2());

  scale.copy = function() {
    return copy$1(scale, symlog()).constant(scale.constant());
  };

  return initRange.apply(scale, arguments);
}

function transformPow(exponent) {
  return function(x) {
    return x < 0 ? -Math.pow(-x, exponent) : Math.pow(x, exponent);
  };
}

function transformSqrt(x) {
  return x < 0 ? -Math.sqrt(-x) : Math.sqrt(x);
}

function transformSquare(x) {
  return x < 0 ? -x * x : x * x;
}

function powish(transform) {
  var scale = transform(identity$3, identity$3),
      exponent = 1;

  function rescale() {
    return exponent === 1 ? transform(identity$3, identity$3)
        : exponent === 0.5 ? transform(transformSqrt, transformSquare)
        : transform(transformPow(exponent), transformPow(1 / exponent));
  }

  scale.exponent = function(_) {
    return arguments.length ? (exponent = +_, rescale()) : exponent;
  };

  return linearish(scale);
}

function pow() {
  var scale = powish(transformer$2());

  scale.copy = function() {
    return copy$1(scale, pow()).exponent(scale.exponent());
  };

  initRange.apply(scale, arguments);

  return scale;
}

function sqrt$1() {
  return pow.apply(null, arguments).exponent(0.5);
}

function square$1(x) {
  return Math.sign(x) * x * x;
}

function unsquare(x) {
  return Math.sign(x) * Math.sqrt(Math.abs(x));
}

function radial() {
  var squared = continuous(),
      range = [0, 1],
      round = false,
      unknown;

  function scale(x) {
    var y = unsquare(squared(x));
    return isNaN(y) ? unknown : round ? Math.round(y) : y;
  }

  scale.invert = function(y) {
    return squared.invert(square$1(y));
  };

  scale.domain = function(_) {
    return arguments.length ? (squared.domain(_), scale) : squared.domain();
  };

  scale.range = function(_) {
    return arguments.length ? (squared.range((range = Array.from(_, number$1)).map(square$1)), scale) : range.slice();
  };

  scale.rangeRound = function(_) {
    return scale.range(_).round(true);
  };

  scale.round = function(_) {
    return arguments.length ? (round = !!_, scale) : round;
  };

  scale.clamp = function(_) {
    return arguments.length ? (squared.clamp(_), scale) : squared.clamp();
  };

  scale.unknown = function(_) {
    return arguments.length ? (unknown = _, scale) : unknown;
  };

  scale.copy = function() {
    return radial(squared.domain(), range)
        .round(round)
        .clamp(squared.clamp())
        .unknown(unknown);
  };

  initRange.apply(scale, arguments);

  return linearish(scale);
}

function quantile() {
  var domain = [],
      range = [],
      thresholds = [],
      unknown;

  function rescale() {
    var i = 0, n = Math.max(1, range.length);
    thresholds = new Array(n - 1);
    while (++i < n) thresholds[i - 1] = quantileSorted(domain, i / n);
    return scale;
  }

  function scale(x) {
    return x == null || isNaN(x = +x) ? unknown : range[bisect(thresholds, x)];
  }

  scale.invertExtent = function(y) {
    var i = range.indexOf(y);
    return i < 0 ? [NaN, NaN] : [
      i > 0 ? thresholds[i - 1] : domain[0],
      i < thresholds.length ? thresholds[i] : domain[domain.length - 1]
    ];
  };

  scale.domain = function(_) {
    if (!arguments.length) return domain.slice();
    domain = [];
    for (let d of _) if (d != null && !isNaN(d = +d)) domain.push(d);
    domain.sort(ascending$3);
    return rescale();
  };

  scale.range = function(_) {
    return arguments.length ? (range = Array.from(_), rescale()) : range.slice();
  };

  scale.unknown = function(_) {
    return arguments.length ? (unknown = _, scale) : unknown;
  };

  scale.quantiles = function() {
    return thresholds.slice();
  };

  scale.copy = function() {
    return quantile()
        .domain(domain)
        .range(range)
        .unknown(unknown);
  };

  return initRange.apply(scale, arguments);
}

function quantize() {
  var x0 = 0,
      x1 = 1,
      n = 1,
      domain = [0.5],
      range = [0, 1],
      unknown;

  function scale(x) {
    return x != null && x <= x ? range[bisect(domain, x, 0, n)] : unknown;
  }

  function rescale() {
    var i = -1;
    domain = new Array(n);
    while (++i < n) domain[i] = ((i + 1) * x1 - (i - n) * x0) / (n + 1);
    return scale;
  }

  scale.domain = function(_) {
    return arguments.length ? ([x0, x1] = _, x0 = +x0, x1 = +x1, rescale()) : [x0, x1];
  };

  scale.range = function(_) {
    return arguments.length ? (n = (range = Array.from(_)).length - 1, rescale()) : range.slice();
  };

  scale.invertExtent = function(y) {
    var i = range.indexOf(y);
    return i < 0 ? [NaN, NaN]
        : i < 1 ? [x0, domain[0]]
        : i >= n ? [domain[n - 1], x1]
        : [domain[i - 1], domain[i]];
  };

  scale.unknown = function(_) {
    return arguments.length ? (unknown = _, scale) : scale;
  };

  scale.thresholds = function() {
    return domain.slice();
  };

  scale.copy = function() {
    return quantize()
        .domain([x0, x1])
        .range(range)
        .unknown(unknown);
  };

  return initRange.apply(linearish(scale), arguments);
}

function threshold() {
  var domain = [0.5],
      range = [0, 1],
      unknown,
      n = 1;

  function scale(x) {
    return x != null && x <= x ? range[bisect(domain, x, 0, n)] : unknown;
  }

  scale.domain = function(_) {
    return arguments.length ? (domain = Array.from(_), n = Math.min(domain.length, range.length - 1), scale) : domain.slice();
  };

  scale.range = function(_) {
    return arguments.length ? (range = Array.from(_), n = Math.min(domain.length, range.length - 1), scale) : range.slice();
  };

  scale.invertExtent = function(y) {
    var i = range.indexOf(y);
    return [domain[i - 1], domain[i]];
  };

  scale.unknown = function(_) {
    return arguments.length ? (unknown = _, scale) : unknown;
  };

  scale.copy = function() {
    return threshold()
        .domain(domain)
        .range(range)
        .unknown(unknown);
  };

  return initRange.apply(scale, arguments);
}

const t0 = new Date, t1 = new Date;

function timeInterval(floori, offseti, count, field) {

  function interval(date) {
    return floori(date = arguments.length === 0 ? new Date : new Date(+date)), date;
  }

  interval.floor = (date) => {
    return floori(date = new Date(+date)), date;
  };

  interval.ceil = (date) => {
    return floori(date = new Date(date - 1)), offseti(date, 1), floori(date), date;
  };

  interval.round = (date) => {
    const d0 = interval(date), d1 = interval.ceil(date);
    return date - d0 < d1 - date ? d0 : d1;
  };

  interval.offset = (date, step) => {
    return offseti(date = new Date(+date), step == null ? 1 : Math.floor(step)), date;
  };

  interval.range = (start, stop, step) => {
    const range = [];
    start = interval.ceil(start);
    step = step == null ? 1 : Math.floor(step);
    if (!(start < stop) || !(step > 0)) return range; // also handles Invalid Date
    let previous;
    do range.push(previous = new Date(+start)), offseti(start, step), floori(start);
    while (previous < start && start < stop);
    return range;
  };

  interval.filter = (test) => {
    return timeInterval((date) => {
      if (date >= date) while (floori(date), !test(date)) date.setTime(date - 1);
    }, (date, step) => {
      if (date >= date) {
        if (step < 0) while (++step <= 0) {
          while (offseti(date, -1), !test(date)) {} // eslint-disable-line no-empty
        } else while (--step >= 0) {
          while (offseti(date, +1), !test(date)) {} // eslint-disable-line no-empty
        }
      }
    });
  };

  if (count) {
    interval.count = (start, end) => {
      t0.setTime(+start), t1.setTime(+end);
      floori(t0), floori(t1);
      return Math.floor(count(t0, t1));
    };

    interval.every = (step) => {
      step = Math.floor(step);
      return !isFinite(step) || !(step > 0) ? null
          : !(step > 1) ? interval
          : interval.filter(field
              ? (d) => field(d) % step === 0
              : (d) => interval.count(0, d) % step === 0);
    };
  }

  return interval;
}

const millisecond = timeInterval(() => {
  // noop
}, (date, step) => {
  date.setTime(+date + step);
}, (start, end) => {
  return end - start;
});

// An optimized implementation for this simple case.
millisecond.every = (k) => {
  k = Math.floor(k);
  if (!isFinite(k) || !(k > 0)) return null;
  if (!(k > 1)) return millisecond;
  return timeInterval((date) => {
    date.setTime(Math.floor(date / k) * k);
  }, (date, step) => {
    date.setTime(+date + step * k);
  }, (start, end) => {
    return (end - start) / k;
  });
};

const milliseconds = millisecond.range;

const durationSecond = 1000;
const durationMinute = durationSecond * 60;
const durationHour = durationMinute * 60;
const durationDay = durationHour * 24;
const durationWeek = durationDay * 7;
const durationMonth = durationDay * 30;
const durationYear = durationDay * 365;

const second = timeInterval((date) => {
  date.setTime(date - date.getMilliseconds());
}, (date, step) => {
  date.setTime(+date + step * durationSecond);
}, (start, end) => {
  return (end - start) / durationSecond;
}, (date) => {
  return date.getUTCSeconds();
});

const seconds = second.range;

const timeMinute = timeInterval((date) => {
  date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond);
}, (date, step) => {
  date.setTime(+date + step * durationMinute);
}, (start, end) => {
  return (end - start) / durationMinute;
}, (date) => {
  return date.getMinutes();
});

const timeMinutes = timeMinute.range;

const utcMinute = timeInterval((date) => {
  date.setUTCSeconds(0, 0);
}, (date, step) => {
  date.setTime(+date + step * durationMinute);
}, (start, end) => {
  return (end - start) / durationMinute;
}, (date) => {
  return date.getUTCMinutes();
});

const utcMinutes = utcMinute.range;

const timeHour = timeInterval((date) => {
  date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond - date.getMinutes() * durationMinute);
}, (date, step) => {
  date.setTime(+date + step * durationHour);
}, (start, end) => {
  return (end - start) / durationHour;
}, (date) => {
  return date.getHours();
});

const timeHours = timeHour.range;

const utcHour = timeInterval((date) => {
  date.setUTCMinutes(0, 0, 0);
}, (date, step) => {
  date.setTime(+date + step * durationHour);
}, (start, end) => {
  return (end - start) / durationHour;
}, (date) => {
  return date.getUTCHours();
});

const utcHours = utcHour.range;

const timeDay = timeInterval(
  date => date.setHours(0, 0, 0, 0),
  (date, step) => date.setDate(date.getDate() + step),
  (start, end) => (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationDay,
  date => date.getDate() - 1
);

const timeDays = timeDay.range;

const utcDay = timeInterval((date) => {
  date.setUTCHours(0, 0, 0, 0);
}, (date, step) => {
  date.setUTCDate(date.getUTCDate() + step);
}, (start, end) => {
  return (end - start) / durationDay;
}, (date) => {
  return date.getUTCDate() - 1;
});

const utcDays = utcDay.range;

const unixDay = timeInterval((date) => {
  date.setUTCHours(0, 0, 0, 0);
}, (date, step) => {
  date.setUTCDate(date.getUTCDate() + step);
}, (start, end) => {
  return (end - start) / durationDay;
}, (date) => {
  return Math.floor(date / durationDay);
});

const unixDays = unixDay.range;

function timeWeekday(i) {
  return timeInterval((date) => {
    date.setDate(date.getDate() - (date.getDay() + 7 - i) % 7);
    date.setHours(0, 0, 0, 0);
  }, (date, step) => {
    date.setDate(date.getDate() + step * 7);
  }, (start, end) => {
    return (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationWeek;
  });
}

const timeSunday = timeWeekday(0);
const timeMonday = timeWeekday(1);
const timeTuesday = timeWeekday(2);
const timeWednesday = timeWeekday(3);
const timeThursday = timeWeekday(4);
const timeFriday = timeWeekday(5);
const timeSaturday = timeWeekday(6);

const timeSundays = timeSunday.range;
const timeMondays = timeMonday.range;
const timeTuesdays = timeTuesday.range;
const timeWednesdays = timeWednesday.range;
const timeThursdays = timeThursday.range;
const timeFridays = timeFriday.range;
const timeSaturdays = timeSaturday.range;

function utcWeekday(i) {
  return timeInterval((date) => {
    date.setUTCDate(date.getUTCDate() - (date.getUTCDay() + 7 - i) % 7);
    date.setUTCHours(0, 0, 0, 0);
  }, (date, step) => {
    date.setUTCDate(date.getUTCDate() + step * 7);
  }, (start, end) => {
    return (end - start) / durationWeek;
  });
}

const utcSunday = utcWeekday(0);
const utcMonday = utcWeekday(1);
const utcTuesday = utcWeekday(2);
const utcWednesday = utcWeekday(3);
const utcThursday = utcWeekday(4);
const utcFriday = utcWeekday(5);
const utcSaturday = utcWeekday(6);

const utcSundays = utcSunday.range;
const utcMondays = utcMonday.range;
const utcTuesdays = utcTuesday.range;
const utcWednesdays = utcWednesday.range;
const utcThursdays = utcThursday.range;
const utcFridays = utcFriday.range;
const utcSaturdays = utcSaturday.range;

const timeMonth = timeInterval((date) => {
  date.setDate(1);
  date.setHours(0, 0, 0, 0);
}, (date, step) => {
  date.setMonth(date.getMonth() + step);
}, (start, end) => {
  return end.getMonth() - start.getMonth() + (end.getFullYear() - start.getFullYear()) * 12;
}, (date) => {
  return date.getMonth();
});

const timeMonths = timeMonth.range;

const utcMonth = timeInterval((date) => {
  date.setUTCDate(1);
  date.setUTCHours(0, 0, 0, 0);
}, (date, step) => {
  date.setUTCMonth(date.getUTCMonth() + step);
}, (start, end) => {
  return end.getUTCMonth() - start.getUTCMonth() + (end.getUTCFullYear() - start.getUTCFullYear()) * 12;
}, (date) => {
  return date.getUTCMonth();
});

const utcMonths = utcMonth.range;

const timeYear = timeInterval((date) => {
  date.setMonth(0, 1);
  date.setHours(0, 0, 0, 0);
}, (date, step) => {
  date.setFullYear(date.getFullYear() + step);
}, (start, end) => {
  return end.getFullYear() - start.getFullYear();
}, (date) => {
  return date.getFullYear();
});

// An optimized implementation for this simple case.
timeYear.every = (k) => {
  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : timeInterval((date) => {
    date.setFullYear(Math.floor(date.getFullYear() / k) * k);
    date.setMonth(0, 1);
    date.setHours(0, 0, 0, 0);
  }, (date, step) => {
    date.setFullYear(date.getFullYear() + step * k);
  });
};

const timeYears = timeYear.range;

const utcYear = timeInterval((date) => {
  date.setUTCMonth(0, 1);
  date.setUTCHours(0, 0, 0, 0);
}, (date, step) => {
  date.setUTCFullYear(date.getUTCFullYear() + step);
}, (start, end) => {
  return end.getUTCFullYear() - start.getUTCFullYear();
}, (date) => {
  return date.getUTCFullYear();
});

// An optimized implementation for this simple case.
utcYear.every = (k) => {
  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : timeInterval((date) => {
    date.setUTCFullYear(Math.floor(date.getUTCFullYear() / k) * k);
    date.setUTCMonth(0, 1);
    date.setUTCHours(0, 0, 0, 0);
  }, (date, step) => {
    date.setUTCFullYear(date.getUTCFullYear() + step * k);
  });
};

const utcYears = utcYear.range;

function ticker(year, month, week, day, hour, minute) {

  const tickIntervals = [
    [second,  1,      durationSecond],
    [second,  5,  5 * durationSecond],
    [second, 15, 15 * durationSecond],
    [second, 30, 30 * durationSecond],
    [minute,  1,      durationMinute],
    [minute,  5,  5 * durationMinute],
    [minute, 15, 15 * durationMinute],
    [minute, 30, 30 * durationMinute],
    [  hour,  1,      durationHour  ],
    [  hour,  3,  3 * durationHour  ],
    [  hour,  6,  6 * durationHour  ],
    [  hour, 12, 12 * durationHour  ],
    [   day,  1,      durationDay   ],
    [   day,  2,  2 * durationDay   ],
    [  week,  1,      durationWeek  ],
    [ month,  1,      durationMonth ],
    [ month,  3,  3 * durationMonth ],
    [  year,  1,      durationYear  ]
  ];

  function ticks(start, stop, count) {
    const reverse = stop < start;
    if (reverse) [start, stop] = [stop, start];
    const interval = count && typeof count.range === "function" ? count : tickInterval(start, stop, count);
    const ticks = interval ? interval.range(start, +stop + 1) : []; // inclusive stop
    return reverse ? ticks.reverse() : ticks;
  }

  function tickInterval(start, stop, count) {
    const target = Math.abs(stop - start) / count;
    const i = bisector(([,, step]) => step).right(tickIntervals, target);
    if (i === tickIntervals.length) return year.every(tickStep(start / durationYear, stop / durationYear, count));
    if (i === 0) return millisecond.every(Math.max(tickStep(start, stop, count), 1));
    const [t, step] = tickIntervals[target / tickIntervals[i - 1][2] < tickIntervals[i][2] / target ? i - 1 : i];
    return t.every(step);
  }

  return [ticks, tickInterval];
}

const [utcTicks, utcTickInterval] = ticker(utcYear, utcMonth, utcSunday, unixDay, utcHour, utcMinute);
const [timeTicks, timeTickInterval] = ticker(timeYear, timeMonth, timeSunday, timeDay, timeHour, timeMinute);

function localDate(d) {
  if (0 <= d.y && d.y < 100) {
    var date = new Date(-1, d.m, d.d, d.H, d.M, d.S, d.L);
    date.setFullYear(d.y);
    return date;
  }
  return new Date(d.y, d.m, d.d, d.H, d.M, d.S, d.L);
}

function utcDate(d) {
  if (0 <= d.y && d.y < 100) {
    var date = new Date(Date.UTC(-1, d.m, d.d, d.H, d.M, d.S, d.L));
    date.setUTCFullYear(d.y);
    return date;
  }
  return new Date(Date.UTC(d.y, d.m, d.d, d.H, d.M, d.S, d.L));
}

function newDate(y, m, d) {
  return {y: y, m: m, d: d, H: 0, M: 0, S: 0, L: 0};
}

function formatLocale(locale) {
  var locale_dateTime = locale.dateTime,
      locale_date = locale.date,
      locale_time = locale.time,
      locale_periods = locale.periods,
      locale_weekdays = locale.days,
      locale_shortWeekdays = locale.shortDays,
      locale_months = locale.months,
      locale_shortMonths = locale.shortMonths;

  var periodRe = formatRe(locale_periods),
      periodLookup = formatLookup(locale_periods),
      weekdayRe = formatRe(locale_weekdays),
      weekdayLookup = formatLookup(locale_weekdays),
      shortWeekdayRe = formatRe(locale_shortWeekdays),
      shortWeekdayLookup = formatLookup(locale_shortWeekdays),
      monthRe = formatRe(locale_months),
      monthLookup = formatLookup(locale_months),
      shortMonthRe = formatRe(locale_shortMonths),
      shortMonthLookup = formatLookup(locale_shortMonths);

  var formats = {
    "a": formatShortWeekday,
    "A": formatWeekday,
    "b": formatShortMonth,
    "B": formatMonth,
    "c": null,
    "d": formatDayOfMonth,
    "e": formatDayOfMonth,
    "f": formatMicroseconds,
    "g": formatYearISO,
    "G": formatFullYearISO,
    "H": formatHour24,
    "I": formatHour12,
    "j": formatDayOfYear,
    "L": formatMilliseconds,
    "m": formatMonthNumber,
    "M": formatMinutes,
    "p": formatPeriod,
    "q": formatQuarter,
    "Q": formatUnixTimestamp,
    "s": formatUnixTimestampSeconds,
    "S": formatSeconds,
    "u": formatWeekdayNumberMonday,
    "U": formatWeekNumberSunday,
    "V": formatWeekNumberISO,
    "w": formatWeekdayNumberSunday,
    "W": formatWeekNumberMonday,
    "x": null,
    "X": null,
    "y": formatYear,
    "Y": formatFullYear,
    "Z": formatZone,
    "%": formatLiteralPercent
  };

  var utcFormats = {
    "a": formatUTCShortWeekday,
    "A": formatUTCWeekday,
    "b": formatUTCShortMonth,
    "B": formatUTCMonth,
    "c": null,
    "d": formatUTCDayOfMonth,
    "e": formatUTCDayOfMonth,
    "f": formatUTCMicroseconds,
    "g": formatUTCYearISO,
    "G": formatUTCFullYearISO,
    "H": formatUTCHour24,
    "I": formatUTCHour12,
    "j": formatUTCDayOfYear,
    "L": formatUTCMilliseconds,
    "m": formatUTCMonthNumber,
    "M": formatUTCMinutes,
    "p": formatUTCPeriod,
    "q": formatUTCQuarter,
    "Q": formatUnixTimestamp,
    "s": formatUnixTimestampSeconds,
    "S": formatUTCSeconds,
    "u": formatUTCWeekdayNumberMonday,
    "U": formatUTCWeekNumberSunday,
    "V": formatUTCWeekNumberISO,
    "w": formatUTCWeekdayNumberSunday,
    "W": formatUTCWeekNumberMonday,
    "x": null,
    "X": null,
    "y": formatUTCYear,
    "Y": formatUTCFullYear,
    "Z": formatUTCZone,
    "%": formatLiteralPercent
  };

  var parses = {
    "a": parseShortWeekday,
    "A": parseWeekday,
    "b": parseShortMonth,
    "B": parseMonth,
    "c": parseLocaleDateTime,
    "d": parseDayOfMonth,
    "e": parseDayOfMonth,
    "f": parseMicroseconds,
    "g": parseYear,
    "G": parseFullYear,
    "H": parseHour24,
    "I": parseHour24,
    "j": parseDayOfYear,
    "L": parseMilliseconds,
    "m": parseMonthNumber,
    "M": parseMinutes,
    "p": parsePeriod,
    "q": parseQuarter,
    "Q": parseUnixTimestamp,
    "s": parseUnixTimestampSeconds,
    "S": parseSeconds,
    "u": parseWeekdayNumberMonday,
    "U": parseWeekNumberSunday,
    "V": parseWeekNumberISO,
    "w": parseWeekdayNumberSunday,
    "W": parseWeekNumberMonday,
    "x": parseLocaleDate,
    "X": parseLocaleTime,
    "y": parseYear,
    "Y": parseFullYear,
    "Z": parseZone,
    "%": parseLiteralPercent
  };

  // These recursive directive definitions must be deferred.
  formats.x = newFormat(locale_date, formats);
  formats.X = newFormat(locale_time, formats);
  formats.c = newFormat(locale_dateTime, formats);
  utcFormats.x = newFormat(locale_date, utcFormats);
  utcFormats.X = newFormat(locale_time, utcFormats);
  utcFormats.c = newFormat(locale_dateTime, utcFormats);

  function newFormat(specifier, formats) {
    return function(date) {
      var string = [],
          i = -1,
          j = 0,
          n = specifier.length,
          c,
          pad,
          format;

      if (!(date instanceof Date)) date = new Date(+date);

      while (++i < n) {
        if (specifier.charCodeAt(i) === 37) {
          string.push(specifier.slice(j, i));
          if ((pad = pads[c = specifier.charAt(++i)]) != null) c = specifier.charAt(++i);
          else pad = c === "e" ? " " : "0";
          if (format = formats[c]) c = format(date, pad);
          string.push(c);
          j = i + 1;
        }
      }

      string.push(specifier.slice(j, i));
      return string.join("");
    };
  }

  function newParse(specifier, Z) {
    return function(string) {
      var d = newDate(1900, undefined, 1),
          i = parseSpecifier(d, specifier, string += "", 0),
          week, day;
      if (i != string.length) return null;

      // If a UNIX timestamp is specified, return it.
      if ("Q" in d) return new Date(d.Q);
      if ("s" in d) return new Date(d.s * 1000 + ("L" in d ? d.L : 0));

      // If this is utcParse, never use the local timezone.
      if (Z && !("Z" in d)) d.Z = 0;

      // The am-pm flag is 0 for AM, and 1 for PM.
      if ("p" in d) d.H = d.H % 12 + d.p * 12;

      // If the month was not specified, inherit from the quarter.
      if (d.m === undefined) d.m = "q" in d ? d.q : 0;

      // Convert day-of-week and week-of-year to day-of-year.
      if ("V" in d) {
        if (d.V < 1 || d.V > 53) return null;
        if (!("w" in d)) d.w = 1;
        if ("Z" in d) {
          week = utcDate(newDate(d.y, 0, 1)), day = week.getUTCDay();
          week = day > 4 || day === 0 ? utcMonday.ceil(week) : utcMonday(week);
          week = utcDay.offset(week, (d.V - 1) * 7);
          d.y = week.getUTCFullYear();
          d.m = week.getUTCMonth();
          d.d = week.getUTCDate() + (d.w + 6) % 7;
        } else {
          week = localDate(newDate(d.y, 0, 1)), day = week.getDay();
          week = day > 4 || day === 0 ? timeMonday.ceil(week) : timeMonday(week);
          week = timeDay.offset(week, (d.V - 1) * 7);
          d.y = week.getFullYear();
          d.m = week.getMonth();
          d.d = week.getDate() + (d.w + 6) % 7;
        }
      } else if ("W" in d || "U" in d) {
        if (!("w" in d)) d.w = "u" in d ? d.u % 7 : "W" in d ? 1 : 0;
        day = "Z" in d ? utcDate(newDate(d.y, 0, 1)).getUTCDay() : localDate(newDate(d.y, 0, 1)).getDay();
        d.m = 0;
        d.d = "W" in d ? (d.w + 6) % 7 + d.W * 7 - (day + 5) % 7 : d.w + d.U * 7 - (day + 6) % 7;
      }

      // If a time zone is specified, all fields are interpreted as UTC and then
      // offset according to the specified time zone.
      if ("Z" in d) {
        d.H += d.Z / 100 | 0;
        d.M += d.Z % 100;
        return utcDate(d);
      }

      // Otherwise, all fields are in local time.
      return localDate(d);
    };
  }

  function parseSpecifier(d, specifier, string, j) {
    var i = 0,
        n = specifier.length,
        m = string.length,
        c,
        parse;

    while (i < n) {
      if (j >= m) return -1;
      c = specifier.charCodeAt(i++);
      if (c === 37) {
        c = specifier.charAt(i++);
        parse = parses[c in pads ? specifier.charAt(i++) : c];
        if (!parse || ((j = parse(d, string, j)) < 0)) return -1;
      } else if (c != string.charCodeAt(j++)) {
        return -1;
      }
    }

    return j;
  }

  function parsePeriod(d, string, i) {
    var n = periodRe.exec(string.slice(i));
    return n ? (d.p = periodLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;
  }

  function parseShortWeekday(d, string, i) {
    var n = shortWeekdayRe.exec(string.slice(i));
    return n ? (d.w = shortWeekdayLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;
  }

  function parseWeekday(d, string, i) {
    var n = weekdayRe.exec(string.slice(i));
    return n ? (d.w = weekdayLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;
  }

  function parseShortMonth(d, string, i) {
    var n = shortMonthRe.exec(string.slice(i));
    return n ? (d.m = shortMonthLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;
  }

  function parseMonth(d, string, i) {
    var n = monthRe.exec(string.slice(i));
    return n ? (d.m = monthLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;
  }

  function parseLocaleDateTime(d, string, i) {
    return parseSpecifier(d, locale_dateTime, string, i);
  }

  function parseLocaleDate(d, string, i) {
    return parseSpecifier(d, locale_date, string, i);
  }

  function parseLocaleTime(d, string, i) {
    return parseSpecifier(d, locale_time, string, i);
  }

  function formatShortWeekday(d) {
    return locale_shortWeekdays[d.getDay()];
  }

  function formatWeekday(d) {
    return locale_weekdays[d.getDay()];
  }

  function formatShortMonth(d) {
    return locale_shortMonths[d.getMonth()];
  }

  function formatMonth(d) {
    return locale_months[d.getMonth()];
  }

  function formatPeriod(d) {
    return locale_periods[+(d.getHours() >= 12)];
  }

  function formatQuarter(d) {
    return 1 + ~~(d.getMonth() / 3);
  }

  function formatUTCShortWeekday(d) {
    return locale_shortWeekdays[d.getUTCDay()];
  }

  function formatUTCWeekday(d) {
    return locale_weekdays[d.getUTCDay()];
  }

  function formatUTCShortMonth(d) {
    return locale_shortMonths[d.getUTCMonth()];
  }

  function formatUTCMonth(d) {
    return locale_months[d.getUTCMonth()];
  }

  function formatUTCPeriod(d) {
    return locale_periods[+(d.getUTCHours() >= 12)];
  }

  function formatUTCQuarter(d) {
    return 1 + ~~(d.getUTCMonth() / 3);
  }

  return {
    format: function(specifier) {
      var f = newFormat(specifier += "", formats);
      f.toString = function() { return specifier; };
      return f;
    },
    parse: function(specifier) {
      var p = newParse(specifier += "", false);
      p.toString = function() { return specifier; };
      return p;
    },
    utcFormat: function(specifier) {
      var f = newFormat(specifier += "", utcFormats);
      f.toString = function() { return specifier; };
      return f;
    },
    utcParse: function(specifier) {
      var p = newParse(specifier += "", true);
      p.toString = function() { return specifier; };
      return p;
    }
  };
}

var pads = {"-": "", "_": " ", "0": "0"},
    numberRe = /^\s*\d+/, // note: ignores next directive
    percentRe = /^%/,
    requoteRe = /[\\^$*+?|[\]().{}]/g;

function pad(value, fill, width) {
  var sign = value < 0 ? "-" : "",
      string = (sign ? -value : value) + "",
      length = string.length;
  return sign + (length < width ? new Array(width - length + 1).join(fill) + string : string);
}

function requote(s) {
  return s.replace(requoteRe, "\\$&");
}

function formatRe(names) {
  return new RegExp("^(?:" + names.map(requote).join("|") + ")", "i");
}

function formatLookup(names) {
  return new Map(names.map((name, i) => [name.toLowerCase(), i]));
}

function parseWeekdayNumberSunday(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 1));
  return n ? (d.w = +n[0], i + n[0].length) : -1;
}

function parseWeekdayNumberMonday(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 1));
  return n ? (d.u = +n[0], i + n[0].length) : -1;
}

function parseWeekNumberSunday(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 2));
  return n ? (d.U = +n[0], i + n[0].length) : -1;
}

function parseWeekNumberISO(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 2));
  return n ? (d.V = +n[0], i + n[0].length) : -1;
}

function parseWeekNumberMonday(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 2));
  return n ? (d.W = +n[0], i + n[0].length) : -1;
}

function parseFullYear(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 4));
  return n ? (d.y = +n[0], i + n[0].length) : -1;
}

function parseYear(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 2));
  return n ? (d.y = +n[0] + (+n[0] > 68 ? 1900 : 2000), i + n[0].length) : -1;
}

function parseZone(d, string, i) {
  var n = /^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(string.slice(i, i + 6));
  return n ? (d.Z = n[1] ? 0 : -(n[2] + (n[3] || "00")), i + n[0].length) : -1;
}

function parseQuarter(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 1));
  return n ? (d.q = n[0] * 3 - 3, i + n[0].length) : -1;
}

function parseMonthNumber(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 2));
  return n ? (d.m = n[0] - 1, i + n[0].length) : -1;
}

function parseDayOfMonth(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 2));
  return n ? (d.d = +n[0], i + n[0].length) : -1;
}

function parseDayOfYear(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 3));
  return n ? (d.m = 0, d.d = +n[0], i + n[0].length) : -1;
}

function parseHour24(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 2));
  return n ? (d.H = +n[0], i + n[0].length) : -1;
}

function parseMinutes(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 2));
  return n ? (d.M = +n[0], i + n[0].length) : -1;
}

function parseSeconds(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 2));
  return n ? (d.S = +n[0], i + n[0].length) : -1;
}

function parseMilliseconds(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 3));
  return n ? (d.L = +n[0], i + n[0].length) : -1;
}

function parseMicroseconds(d, string, i) {
  var n = numberRe.exec(string.slice(i, i + 6));
  return n ? (d.L = Math.floor(n[0] / 1000), i + n[0].length) : -1;
}

function parseLiteralPercent(d, string, i) {
  var n = percentRe.exec(string.slice(i, i + 1));
  return n ? i + n[0].length : -1;
}

function parseUnixTimestamp(d, string, i) {
  var n = numberRe.exec(string.slice(i));
  return n ? (d.Q = +n[0], i + n[0].length) : -1;
}

function parseUnixTimestampSeconds(d, string, i) {
  var n = numberRe.exec(string.slice(i));
  return n ? (d.s = +n[0], i + n[0].length) : -1;
}

function formatDayOfMonth(d, p) {
  return pad(d.getDate(), p, 2);
}

function formatHour24(d, p) {
  return pad(d.getHours(), p, 2);
}

function formatHour12(d, p) {
  return pad(d.getHours() % 12 || 12, p, 2);
}

function formatDayOfYear(d, p) {
  return pad(1 + timeDay.count(timeYear(d), d), p, 3);
}

function formatMilliseconds(d, p) {
  return pad(d.getMilliseconds(), p, 3);
}

function formatMicroseconds(d, p) {
  return formatMilliseconds(d, p) + "000";
}

function formatMonthNumber(d, p) {
  return pad(d.getMonth() + 1, p, 2);
}

function formatMinutes(d, p) {
  return pad(d.getMinutes(), p, 2);
}

function formatSeconds(d, p) {
  return pad(d.getSeconds(), p, 2);
}

function formatWeekdayNumberMonday(d) {
  var day = d.getDay();
  return day === 0 ? 7 : day;
}

function formatWeekNumberSunday(d, p) {
  return pad(timeSunday.count(timeYear(d) - 1, d), p, 2);
}

function dISO(d) {
  var day = d.getDay();
  return (day >= 4 || day === 0) ? timeThursday(d) : timeThursday.ceil(d);
}

function formatWeekNumberISO(d, p) {
  d = dISO(d);
  return pad(timeThursday.count(timeYear(d), d) + (timeYear(d).getDay() === 4), p, 2);
}

function formatWeekdayNumberSunday(d) {
  return d.getDay();
}

function formatWeekNumberMonday(d, p) {
  return pad(timeMonday.count(timeYear(d) - 1, d), p, 2);
}

function formatYear(d, p) {
  return pad(d.getFullYear() % 100, p, 2);
}

function formatYearISO(d, p) {
  d = dISO(d);
  return pad(d.getFullYear() % 100, p, 2);
}

function formatFullYear(d, p) {
  return pad(d.getFullYear() % 10000, p, 4);
}

function formatFullYearISO(d, p) {
  var day = d.getDay();
  d = (day >= 4 || day === 0) ? timeThursday(d) : timeThursday.ceil(d);
  return pad(d.getFullYear() % 10000, p, 4);
}

function formatZone(d) {
  var z = d.getTimezoneOffset();
  return (z > 0 ? "-" : (z *= -1, "+"))
      + pad(z / 60 | 0, "0", 2)
      + pad(z % 60, "0", 2);
}

function formatUTCDayOfMonth(d, p) {
  return pad(d.getUTCDate(), p, 2);
}

function formatUTCHour24(d, p) {
  return pad(d.getUTCHours(), p, 2);
}

function formatUTCHour12(d, p) {
  return pad(d.getUTCHours() % 12 || 12, p, 2);
}

function formatUTCDayOfYear(d, p) {
  return pad(1 + utcDay.count(utcYear(d), d), p, 3);
}

function formatUTCMilliseconds(d, p) {
  return pad(d.getUTCMilliseconds(), p, 3);
}

function formatUTCMicroseconds(d, p) {
  return formatUTCMilliseconds(d, p) + "000";
}

function formatUTCMonthNumber(d, p) {
  return pad(d.getUTCMonth() + 1, p, 2);
}

function formatUTCMinutes(d, p) {
  return pad(d.getUTCMinutes(), p, 2);
}

function formatUTCSeconds(d, p) {
  return pad(d.getUTCSeconds(), p, 2);
}

function formatUTCWeekdayNumberMonday(d) {
  var dow = d.getUTCDay();
  return dow === 0 ? 7 : dow;
}

function formatUTCWeekNumberSunday(d, p) {
  return pad(utcSunday.count(utcYear(d) - 1, d), p, 2);
}

function UTCdISO(d) {
  var day = d.getUTCDay();
  return (day >= 4 || day === 0) ? utcThursday(d) : utcThursday.ceil(d);
}

function formatUTCWeekNumberISO(d, p) {
  d = UTCdISO(d);
  return pad(utcThursday.count(utcYear(d), d) + (utcYear(d).getUTCDay() === 4), p, 2);
}

function formatUTCWeekdayNumberSunday(d) {
  return d.getUTCDay();
}

function formatUTCWeekNumberMonday(d, p) {
  return pad(utcMonday.count(utcYear(d) - 1, d), p, 2);
}

function formatUTCYear(d, p) {
  return pad(d.getUTCFullYear() % 100, p, 2);
}

function formatUTCYearISO(d, p) {
  d = UTCdISO(d);
  return pad(d.getUTCFullYear() % 100, p, 2);
}

function formatUTCFullYear(d, p) {
  return pad(d.getUTCFullYear() % 10000, p, 4);
}

function formatUTCFullYearISO(d, p) {
  var day = d.getUTCDay();
  d = (day >= 4 || day === 0) ? utcThursday(d) : utcThursday.ceil(d);
  return pad(d.getUTCFullYear() % 10000, p, 4);
}

function formatUTCZone() {
  return "+0000";
}

function formatLiteralPercent() {
  return "%";
}

function formatUnixTimestamp(d) {
  return +d;
}

function formatUnixTimestampSeconds(d) {
  return Math.floor(+d / 1000);
}

var locale;
var timeFormat;
var timeParse;
var utcFormat;
var utcParse;

defaultLocale({
  dateTime: "%x, %X",
  date: "%-m/%-d/%Y",
  time: "%-I:%M:%S %p",
  periods: ["AM", "PM"],
  days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
  shortDays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
  months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
  shortMonths: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
});

function defaultLocale(definition) {
  locale = formatLocale(definition);
  timeFormat = locale.format;
  timeParse = locale.parse;
  utcFormat = locale.utcFormat;
  utcParse = locale.utcParse;
  return locale;
}

var isoSpecifier = "%Y-%m-%dT%H:%M:%S.%LZ";

function formatIsoNative(date) {
  return date.toISOString();
}

var formatIso = Date.prototype.toISOString
    ? formatIsoNative
    : utcFormat(isoSpecifier);

var formatIso$1 = formatIso;

function parseIsoNative(string) {
  var date = new Date(string);
  return isNaN(date) ? null : date;
}

var parseIso = +new Date("2000-01-01T00:00:00.000Z")
    ? parseIsoNative
    : utcParse(isoSpecifier);

var parseIso$1 = parseIso;

function date(t) {
  return new Date(t);
}

function number(t) {
  return t instanceof Date ? +t : +new Date(+t);
}

function calendar(ticks, tickInterval, year, month, week, day, hour, minute, second, format) {
  var scale = continuous(),
      invert = scale.invert,
      domain = scale.domain;

  var formatMillisecond = format(".%L"),
      formatSecond = format(":%S"),
      formatMinute = format("%I:%M"),
      formatHour = format("%I %p"),
      formatDay = format("%a %d"),
      formatWeek = format("%b %d"),
      formatMonth = format("%B"),
      formatYear = format("%Y");

  function tickFormat(date) {
    return (second(date) < date ? formatMillisecond
        : minute(date) < date ? formatSecond
        : hour(date) < date ? formatMinute
        : day(date) < date ? formatHour
        : month(date) < date ? (week(date) < date ? formatDay : formatWeek)
        : year(date) < date ? formatMonth
        : formatYear)(date);
  }

  scale.invert = function(y) {
    return new Date(invert(y));
  };

  scale.domain = function(_) {
    return arguments.length ? domain(Array.from(_, number)) : domain().map(date);
  };

  scale.ticks = function(interval) {
    var d = domain();
    return ticks(d[0], d[d.length - 1], interval == null ? 10 : interval);
  };

  scale.tickFormat = function(count, specifier) {
    return specifier == null ? tickFormat : format(specifier);
  };

  scale.nice = function(interval) {
    var d = domain();
    if (!interval || typeof interval.range !== "function") interval = tickInterval(d[0], d[d.length - 1], interval == null ? 10 : interval);
    return interval ? domain(nice(d, interval)) : scale;
  };

  scale.copy = function() {
    return copy$1(scale, calendar(ticks, tickInterval, year, month, week, day, hour, minute, second, format));
  };

  return scale;
}

function time() {
  return initRange.apply(calendar(timeTicks, timeTickInterval, timeYear, timeMonth, timeSunday, timeDay, timeHour, timeMinute, second, timeFormat).domain([new Date(2000, 0, 1), new Date(2000, 0, 2)]), arguments);
}

function utcTime() {
  return initRange.apply(calendar(utcTicks, utcTickInterval, utcYear, utcMonth, utcSunday, utcDay, utcHour, utcMinute, second, utcFormat).domain([Date.UTC(2000, 0, 1), Date.UTC(2000, 0, 2)]), arguments);
}

function transformer$1() {
  var x0 = 0,
      x1 = 1,
      t0,
      t1,
      k10,
      transform,
      interpolator = identity$3,
      clamp = false,
      unknown;

  function scale(x) {
    return x == null || isNaN(x = +x) ? unknown : interpolator(k10 === 0 ? 0.5 : (x = (transform(x) - t0) * k10, clamp ? Math.max(0, Math.min(1, x)) : x));
  }

  scale.domain = function(_) {
    return arguments.length ? ([x0, x1] = _, t0 = transform(x0 = +x0), t1 = transform(x1 = +x1), k10 = t0 === t1 ? 0 : 1 / (t1 - t0), scale) : [x0, x1];
  };

  scale.clamp = function(_) {
    return arguments.length ? (clamp = !!_, scale) : clamp;
  };

  scale.interpolator = function(_) {
    return arguments.length ? (interpolator = _, scale) : interpolator;
  };

  function range(interpolate) {
    return function(_) {
      var r0, r1;
      return arguments.length ? ([r0, r1] = _, interpolator = interpolate(r0, r1), scale) : [interpolator(0), interpolator(1)];
    };
  }

  scale.range = range(interpolate$2);

  scale.rangeRound = range(interpolateRound);

  scale.unknown = function(_) {
    return arguments.length ? (unknown = _, scale) : unknown;
  };

  return function(t) {
    transform = t, t0 = t(x0), t1 = t(x1), k10 = t0 === t1 ? 0 : 1 / (t1 - t0);
    return scale;
  };
}

function copy(source, target) {
  return target
      .domain(source.domain())
      .interpolator(source.interpolator())
      .clamp(source.clamp())
      .unknown(source.unknown());
}

function sequential() {
  var scale = linearish(transformer$1()(identity$3));

  scale.copy = function() {
    return copy(scale, sequential());
  };

  return initInterpolator.apply(scale, arguments);
}

function sequentialLog() {
  var scale = loggish(transformer$1()).domain([1, 10]);

  scale.copy = function() {
    return copy(scale, sequentialLog()).base(scale.base());
  };

  return initInterpolator.apply(scale, arguments);
}

function sequentialSymlog() {
  var scale = symlogish(transformer$1());

  scale.copy = function() {
    return copy(scale, sequentialSymlog()).constant(scale.constant());
  };

  return initInterpolator.apply(scale, arguments);
}

function sequentialPow() {
  var scale = powish(transformer$1());

  scale.copy = function() {
    return copy(scale, sequentialPow()).exponent(scale.exponent());
  };

  return initInterpolator.apply(scale, arguments);
}

function sequentialSqrt() {
  return sequentialPow.apply(null, arguments).exponent(0.5);
}

function sequentialQuantile() {
  var domain = [],
      interpolator = identity$3;

  function scale(x) {
    if (x != null && !isNaN(x = +x)) return interpolator((bisect(domain, x, 1) - 1) / (domain.length - 1));
  }

  scale.domain = function(_) {
    if (!arguments.length) return domain.slice();
    domain = [];
    for (let d of _) if (d != null && !isNaN(d = +d)) domain.push(d);
    domain.sort(ascending$3);
    return scale;
  };

  scale.interpolator = function(_) {
    return arguments.length ? (interpolator = _, scale) : interpolator;
  };

  scale.range = function() {
    return domain.map((d, i) => interpolator(i / (domain.length - 1)));
  };

  scale.quantiles = function(n) {
    return Array.from({length: n + 1}, (_, i) => quantile$1(domain, i / n));
  };

  scale.copy = function() {
    return sequentialQuantile(interpolator).domain(domain);
  };

  return initInterpolator.apply(scale, arguments);
}

function transformer() {
  var x0 = 0,
      x1 = 0.5,
      x2 = 1,
      s = 1,
      t0,
      t1,
      t2,
      k10,
      k21,
      interpolator = identity$3,
      transform,
      clamp = false,
      unknown;

  function scale(x) {
    return isNaN(x = +x) ? unknown : (x = 0.5 + ((x = +transform(x)) - t1) * (s * x < s * t1 ? k10 : k21), interpolator(clamp ? Math.max(0, Math.min(1, x)) : x));
  }

  scale.domain = function(_) {
    return arguments.length ? ([x0, x1, x2] = _, t0 = transform(x0 = +x0), t1 = transform(x1 = +x1), t2 = transform(x2 = +x2), k10 = t0 === t1 ? 0 : 0.5 / (t1 - t0), k21 = t1 === t2 ? 0 : 0.5 / (t2 - t1), s = t1 < t0 ? -1 : 1, scale) : [x0, x1, x2];
  };

  scale.clamp = function(_) {
    return arguments.length ? (clamp = !!_, scale) : clamp;
  };

  scale.interpolator = function(_) {
    return arguments.length ? (interpolator = _, scale) : interpolator;
  };

  function range(interpolate) {
    return function(_) {
      var r0, r1, r2;
      return arguments.length ? ([r0, r1, r2] = _, interpolator = piecewise(interpolate, [r0, r1, r2]), scale) : [interpolator(0), interpolator(0.5), interpolator(1)];
    };
  }

  scale.range = range(interpolate$2);

  scale.rangeRound = range(interpolateRound);

  scale.unknown = function(_) {
    return arguments.length ? (unknown = _, scale) : unknown;
  };

  return function(t) {
    transform = t, t0 = t(x0), t1 = t(x1), t2 = t(x2), k10 = t0 === t1 ? 0 : 0.5 / (t1 - t0), k21 = t1 === t2 ? 0 : 0.5 / (t2 - t1), s = t1 < t0 ? -1 : 1;
    return scale;
  };
}

function diverging$1() {
  var scale = linearish(transformer()(identity$3));

  scale.copy = function() {
    return copy(scale, diverging$1());
  };

  return initInterpolator.apply(scale, arguments);
}

function divergingLog() {
  var scale = loggish(transformer()).domain([0.1, 1, 10]);

  scale.copy = function() {
    return copy(scale, divergingLog()).base(scale.base());
  };

  return initInterpolator.apply(scale, arguments);
}

function divergingSymlog() {
  var scale = symlogish(transformer());

  scale.copy = function() {
    return copy(scale, divergingSymlog()).constant(scale.constant());
  };

  return initInterpolator.apply(scale, arguments);
}

function divergingPow() {
  var scale = powish(transformer());

  scale.copy = function() {
    return copy(scale, divergingPow()).exponent(scale.exponent());
  };

  return initInterpolator.apply(scale, arguments);
}

function divergingSqrt() {
  return divergingPow.apply(null, arguments).exponent(0.5);
}

function colors(specifier) {
  var n = specifier.length / 6 | 0, colors = new Array(n), i = 0;
  while (i < n) colors[i] = "#" + specifier.slice(i * 6, ++i * 6);
  return colors;
}

var category10 = colors("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");

var Accent = colors("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666");

var Dark2 = colors("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666");

var observable10 = colors("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0");

var Paired = colors("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");

var Pastel1 = colors("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2");

var Pastel2 = colors("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc");

var Set1 = colors("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999");

var Set2 = colors("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3");

var Set3 = colors("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");

var Tableau10 = colors("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");

var ramp$1 = scheme => rgbBasis(scheme[scheme.length - 1]);

var scheme$q = new Array(3).concat(
  "d8b365f5f5f55ab4ac",
  "a6611adfc27d80cdc1018571",
  "a6611adfc27df5f5f580cdc1018571",
  "8c510ad8b365f6e8c3c7eae55ab4ac01665e",
  "8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e",
  "8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e",
  "8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e",
  "5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30",
  "5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30"
).map(colors);

var BrBG = ramp$1(scheme$q);

var scheme$p = new Array(3).concat(
  "af8dc3f7f7f77fbf7b",
  "7b3294c2a5cfa6dba0008837",
  "7b3294c2a5cff7f7f7a6dba0008837",
  "762a83af8dc3e7d4e8d9f0d37fbf7b1b7837",
  "762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837",
  "762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837",
  "762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837",
  "40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b",
  "40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b"
).map(colors);

var PRGn = ramp$1(scheme$p);

var scheme$o = new Array(3).concat(
  "e9a3c9f7f7f7a1d76a",
  "d01c8bf1b6dab8e1864dac26",
  "d01c8bf1b6daf7f7f7b8e1864dac26",
  "c51b7de9a3c9fde0efe6f5d0a1d76a4d9221",
  "c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221",
  "c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221",
  "c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221",
  "8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419",
  "8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419"
).map(colors);

var PiYG = ramp$1(scheme$o);

var scheme$n = new Array(3).concat(
  "998ec3f7f7f7f1a340",
  "5e3c99b2abd2fdb863e66101",
  "5e3c99b2abd2f7f7f7fdb863e66101",
  "542788998ec3d8daebfee0b6f1a340b35806",
  "542788998ec3d8daebf7f7f7fee0b6f1a340b35806",
  "5427888073acb2abd2d8daebfee0b6fdb863e08214b35806",
  "5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806",
  "2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08",
  "2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08"
).map(colors);

var PuOr = ramp$1(scheme$n);

var scheme$m = new Array(3).concat(
  "ef8a62f7f7f767a9cf",
  "ca0020f4a58292c5de0571b0",
  "ca0020f4a582f7f7f792c5de0571b0",
  "b2182bef8a62fddbc7d1e5f067a9cf2166ac",
  "b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac",
  "b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac",
  "b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac",
  "67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061",
  "67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061"
).map(colors);

var RdBu = ramp$1(scheme$m);

var scheme$l = new Array(3).concat(
  "ef8a62ffffff999999",
  "ca0020f4a582bababa404040",
  "ca0020f4a582ffffffbababa404040",
  "b2182bef8a62fddbc7e0e0e09999994d4d4d",
  "b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d",
  "b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d",
  "b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d",
  "67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a",
  "67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a"
).map(colors);

var RdGy = ramp$1(scheme$l);

var scheme$k = new Array(3).concat(
  "fc8d59ffffbf91bfdb",
  "d7191cfdae61abd9e92c7bb6",
  "d7191cfdae61ffffbfabd9e92c7bb6",
  "d73027fc8d59fee090e0f3f891bfdb4575b4",
  "d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4",
  "d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4",
  "d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4",
  "a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695",
  "a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695"
).map(colors);

var RdYlBu = ramp$1(scheme$k);

var scheme$j = new Array(3).concat(
  "fc8d59ffffbf91cf60",
  "d7191cfdae61a6d96a1a9641",
  "d7191cfdae61ffffbfa6d96a1a9641",
  "d73027fc8d59fee08bd9ef8b91cf601a9850",
  "d73027fc8d59fee08bffffbfd9ef8b91cf601a9850",
  "d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850",
  "d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850",
  "a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837",
  "a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837"
).map(colors);

var RdYlGn = ramp$1(scheme$j);

var scheme$i = new Array(3).concat(
  "fc8d59ffffbf99d594",
  "d7191cfdae61abdda42b83ba",
  "d7191cfdae61ffffbfabdda42b83ba",
  "d53e4ffc8d59fee08be6f59899d5943288bd",
  "d53e4ffc8d59fee08bffffbfe6f59899d5943288bd",
  "d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd",
  "d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd",
  "9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2",
  "9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2"
).map(colors);

var Spectral = ramp$1(scheme$i);

var scheme$h = new Array(3).concat(
  "e5f5f999d8c92ca25f",
  "edf8fbb2e2e266c2a4238b45",
  "edf8fbb2e2e266c2a42ca25f006d2c",
  "edf8fbccece699d8c966c2a42ca25f006d2c",
  "edf8fbccece699d8c966c2a441ae76238b45005824",
  "f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824",
  "f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b"
).map(colors);

var BuGn = ramp$1(scheme$h);

var scheme$g = new Array(3).concat(
  "e0ecf49ebcda8856a7",
  "edf8fbb3cde38c96c688419d",
  "edf8fbb3cde38c96c68856a7810f7c",
  "edf8fbbfd3e69ebcda8c96c68856a7810f7c",
  "edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b",
  "f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b",
  "f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b"
).map(colors);

var BuPu = ramp$1(scheme$g);

var scheme$f = new Array(3).concat(
  "e0f3dba8ddb543a2ca",
  "f0f9e8bae4bc7bccc42b8cbe",
  "f0f9e8bae4bc7bccc443a2ca0868ac",
  "f0f9e8ccebc5a8ddb57bccc443a2ca0868ac",
  "f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e",
  "f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e",
  "f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081"
).map(colors);

var GnBu = ramp$1(scheme$f);

var scheme$e = new Array(3).concat(
  "fee8c8fdbb84e34a33",
  "fef0d9fdcc8afc8d59d7301f",
  "fef0d9fdcc8afc8d59e34a33b30000",
  "fef0d9fdd49efdbb84fc8d59e34a33b30000",
  "fef0d9fdd49efdbb84fc8d59ef6548d7301f990000",
  "fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000",
  "fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000"
).map(colors);

var OrRd = ramp$1(scheme$e);

var scheme$d = new Array(3).concat(
  "ece2f0a6bddb1c9099",
  "f6eff7bdc9e167a9cf02818a",
  "f6eff7bdc9e167a9cf1c9099016c59",
  "f6eff7d0d1e6a6bddb67a9cf1c9099016c59",
  "f6eff7d0d1e6a6bddb67a9cf3690c002818a016450",
  "fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450",
  "fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636"
).map(colors);

var PuBuGn = ramp$1(scheme$d);

var scheme$c = new Array(3).concat(
  "ece7f2a6bddb2b8cbe",
  "f1eef6bdc9e174a9cf0570b0",
  "f1eef6bdc9e174a9cf2b8cbe045a8d",
  "f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d",
  "f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b",
  "fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b",
  "fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858"
).map(colors);

var PuBu = ramp$1(scheme$c);

var scheme$b = new Array(3).concat(
  "e7e1efc994c7dd1c77",
  "f1eef6d7b5d8df65b0ce1256",
  "f1eef6d7b5d8df65b0dd1c77980043",
  "f1eef6d4b9dac994c7df65b0dd1c77980043",
  "f1eef6d4b9dac994c7df65b0e7298ace125691003f",
  "f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f",
  "f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f"
).map(colors);

var PuRd = ramp$1(scheme$b);

var scheme$a = new Array(3).concat(
  "fde0ddfa9fb5c51b8a",
  "feebe2fbb4b9f768a1ae017e",
  "feebe2fbb4b9f768a1c51b8a7a0177",
  "feebe2fcc5c0fa9fb5f768a1c51b8a7a0177",
  "feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177",
  "fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177",
  "fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a"
).map(colors);

var RdPu = ramp$1(scheme$a);

var scheme$9 = new Array(3).concat(
  "edf8b17fcdbb2c7fb8",
  "ffffcca1dab441b6c4225ea8",
  "ffffcca1dab441b6c42c7fb8253494",
  "ffffccc7e9b47fcdbb41b6c42c7fb8253494",
  "ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84",
  "ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84",
  "ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58"
).map(colors);

var YlGnBu = ramp$1(scheme$9);

var scheme$8 = new Array(3).concat(
  "f7fcb9addd8e31a354",
  "ffffccc2e69978c679238443",
  "ffffccc2e69978c67931a354006837",
  "ffffccd9f0a3addd8e78c67931a354006837",
  "ffffccd9f0a3addd8e78c67941ab5d238443005a32",
  "ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32",
  "ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529"
).map(colors);

var YlGn = ramp$1(scheme$8);

var scheme$7 = new Array(3).concat(
  "fff7bcfec44fd95f0e",
  "ffffd4fed98efe9929cc4c02",
  "ffffd4fed98efe9929d95f0e993404",
  "ffffd4fee391fec44ffe9929d95f0e993404",
  "ffffd4fee391fec44ffe9929ec7014cc4c028c2d04",
  "ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04",
  "ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506"
).map(colors);

var YlOrBr = ramp$1(scheme$7);

var scheme$6 = new Array(3).concat(
  "ffeda0feb24cf03b20",
  "ffffb2fecc5cfd8d3ce31a1c",
  "ffffb2fecc5cfd8d3cf03b20bd0026",
  "ffffb2fed976feb24cfd8d3cf03b20bd0026",
  "ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026",
  "ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026",
  "ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026"
).map(colors);

var YlOrRd = ramp$1(scheme$6);

var scheme$5 = new Array(3).concat(
  "deebf79ecae13182bd",
  "eff3ffbdd7e76baed62171b5",
  "eff3ffbdd7e76baed63182bd08519c",
  "eff3ffc6dbef9ecae16baed63182bd08519c",
  "eff3ffc6dbef9ecae16baed64292c62171b5084594",
  "f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594",
  "f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b"
).map(colors);

var Blues = ramp$1(scheme$5);

var scheme$4 = new Array(3).concat(
  "e5f5e0a1d99b31a354",
  "edf8e9bae4b374c476238b45",
  "edf8e9bae4b374c47631a354006d2c",
  "edf8e9c7e9c0a1d99b74c47631a354006d2c",
  "edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32",
  "f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32",
  "f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b"
).map(colors);

var Greens = ramp$1(scheme$4);

var scheme$3 = new Array(3).concat(
  "f0f0f0bdbdbd636363",
  "f7f7f7cccccc969696525252",
  "f7f7f7cccccc969696636363252525",
  "f7f7f7d9d9d9bdbdbd969696636363252525",
  "f7f7f7d9d9d9bdbdbd969696737373525252252525",
  "fffffff0f0f0d9d9d9bdbdbd969696737373525252252525",
  "fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000"
).map(colors);

var Greys = ramp$1(scheme$3);

var scheme$2 = new Array(3).concat(
  "efedf5bcbddc756bb1",
  "f2f0f7cbc9e29e9ac86a51a3",
  "f2f0f7cbc9e29e9ac8756bb154278f",
  "f2f0f7dadaebbcbddc9e9ac8756bb154278f",
  "f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486",
  "fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486",
  "fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d"
).map(colors);

var Purples = ramp$1(scheme$2);

var scheme$1 = new Array(3).concat(
  "fee0d2fc9272de2d26",
  "fee5d9fcae91fb6a4acb181d",
  "fee5d9fcae91fb6a4ade2d26a50f15",
  "fee5d9fcbba1fc9272fb6a4ade2d26a50f15",
  "fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d",
  "fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d",
  "fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d"
).map(colors);

var Reds = ramp$1(scheme$1);

var scheme = new Array(3).concat(
  "fee6cefdae6be6550d",
  "feeddefdbe85fd8d3cd94701",
  "feeddefdbe85fd8d3ce6550da63603",
  "feeddefdd0a2fdae6bfd8d3ce6550da63603",
  "feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04",
  "fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04",
  "fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704"
).map(colors);

var Oranges = ramp$1(scheme);

function cividis(t) {
  t = Math.max(0, Math.min(1, t));
  return "rgb("
      + Math.max(0, Math.min(255, Math.round(-4.54 - t * (35.34 - t * (2381.73 - t * (6402.7 - t * (7024.72 - t * 2710.57))))))) + ", "
      + Math.max(0, Math.min(255, Math.round(32.49 + t * (170.73 + t * (52.82 - t * (131.46 - t * (176.58 - t * 67.37))))))) + ", "
      + Math.max(0, Math.min(255, Math.round(81.24 + t * (442.36 - t * (2482.43 - t * (6167.24 - t * (6614.94 - t * 2475.67)))))))
      + ")";
}

var cubehelix = cubehelixLong(cubehelix$3(300, 0.5, 0.0), cubehelix$3(-240, 0.5, 1.0));

var warm = cubehelixLong(cubehelix$3(-100, 0.75, 0.35), cubehelix$3(80, 1.50, 0.8));

var cool = cubehelixLong(cubehelix$3(260, 0.75, 0.35), cubehelix$3(80, 1.50, 0.8));

var c$2 = cubehelix$3();

function rainbow(t) {
  if (t < 0 || t > 1) t -= Math.floor(t);
  var ts = Math.abs(t - 0.5);
  c$2.h = 360 * t - 100;
  c$2.s = 1.5 - 1.5 * ts;
  c$2.l = 0.8 - 0.9 * ts;
  return c$2 + "";
}

var c$1 = rgb(),
    pi_1_3 = Math.PI / 3,
    pi_2_3 = Math.PI * 2 / 3;

function sinebow(t) {
  var x;
  t = (0.5 - t) * Math.PI;
  c$1.r = 255 * (x = Math.sin(t)) * x;
  c$1.g = 255 * (x = Math.sin(t + pi_1_3)) * x;
  c$1.b = 255 * (x = Math.sin(t + pi_2_3)) * x;
  return c$1 + "";
}

function turbo(t) {
  t = Math.max(0, Math.min(1, t));
  return "rgb("
      + Math.max(0, Math.min(255, Math.round(34.61 + t * (1172.33 - t * (10793.56 - t * (33300.12 - t * (38394.49 - t * 14825.05))))))) + ", "
      + Math.max(0, Math.min(255, Math.round(23.31 + t * (557.33 + t * (1225.33 - t * (3574.96 - t * (1073.77 + t * 707.56))))))) + ", "
      + Math.max(0, Math.min(255, Math.round(27.2 + t * (3211.1 - t * (15327.97 - t * (27814 - t * (22569.18 - t * 6838.66)))))))
      + ")";
}

function ramp(range) {
  var n = range.length;
  return function(t) {
    return range[Math.max(0, Math.min(n - 1, Math.floor(t * n)))];
  };
}

var viridis = ramp(colors("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));

var magma = ramp(colors("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));

var inferno = ramp(colors("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));

var plasma = ramp(colors("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));

function constant$1(x) {
  return function constant() {
    return x;
  };
}

const abs = Math.abs;
const atan2 = Math.atan2;
const cos = Math.cos;
const max = Math.max;
const min = Math.min;
const sin = Math.sin;
const sqrt = Math.sqrt;

const epsilon = 1e-12;
const pi = Math.PI;
const halfPi = pi / 2;
const tau = 2 * pi;

function acos(x) {
  return x > 1 ? 0 : x < -1 ? pi : Math.acos(x);
}

function asin(x) {
  return x >= 1 ? halfPi : x <= -1 ? -halfPi : Math.asin(x);
}

function withPath(shape) {
  let digits = 3;

  shape.digits = function(_) {
    if (!arguments.length) return digits;
    if (_ == null) {
      digits = null;
    } else {
      const d = Math.floor(_);
      if (!(d >= 0)) throw new RangeError(`invalid digits: ${_}`);
      digits = d;
    }
    return shape;
  };

  return () => new Path$1(digits);
}

function arcInnerRadius(d) {
  return d.innerRadius;
}

function arcOuterRadius(d) {
  return d.outerRadius;
}

function arcStartAngle(d) {
  return d.startAngle;
}

function arcEndAngle(d) {
  return d.endAngle;
}

function arcPadAngle(d) {
  return d && d.padAngle; // Note: optional!
}

function intersect(x0, y0, x1, y1, x2, y2, x3, y3) {
  var x10 = x1 - x0, y10 = y1 - y0,
      x32 = x3 - x2, y32 = y3 - y2,
      t = y32 * x10 - x32 * y10;
  if (t * t < epsilon) return;
  t = (x32 * (y0 - y2) - y32 * (x0 - x2)) / t;
  return [x0 + t * x10, y0 + t * y10];
}

// Compute perpendicular offset line of length rc.
// http://mathworld.wolfram.com/Circle-LineIntersection.html
function cornerTangents(x0, y0, x1, y1, r1, rc, cw) {
  var x01 = x0 - x1,
      y01 = y0 - y1,
      lo = (cw ? rc : -rc) / sqrt(x01 * x01 + y01 * y01),
      ox = lo * y01,
      oy = -lo * x01,
      x11 = x0 + ox,
      y11 = y0 + oy,
      x10 = x1 + ox,
      y10 = y1 + oy,
      x00 = (x11 + x10) / 2,
      y00 = (y11 + y10) / 2,
      dx = x10 - x11,
      dy = y10 - y11,
      d2 = dx * dx + dy * dy,
      r = r1 - rc,
      D = x11 * y10 - x10 * y11,
      d = (dy < 0 ? -1 : 1) * sqrt(max(0, r * r * d2 - D * D)),
      cx0 = (D * dy - dx * d) / d2,
      cy0 = (-D * dx - dy * d) / d2,
      cx1 = (D * dy + dx * d) / d2,
      cy1 = (-D * dx + dy * d) / d2,
      dx0 = cx0 - x00,
      dy0 = cy0 - y00,
      dx1 = cx1 - x00,
      dy1 = cy1 - y00;

  // Pick the closer of the two intersection points.
  // TODO Is there a faster way to determine which intersection to use?
  if (dx0 * dx0 + dy0 * dy0 > dx1 * dx1 + dy1 * dy1) cx0 = cx1, cy0 = cy1;

  return {
    cx: cx0,
    cy: cy0,
    x01: -ox,
    y01: -oy,
    x11: cx0 * (r1 / r - 1),
    y11: cy0 * (r1 / r - 1)
  };
}

function arc() {
  var innerRadius = arcInnerRadius,
      outerRadius = arcOuterRadius,
      cornerRadius = constant$1(0),
      padRadius = null,
      startAngle = arcStartAngle,
      endAngle = arcEndAngle,
      padAngle = arcPadAngle,
      context = null,
      path = withPath(arc);

  function arc() {
    var buffer,
        r,
        r0 = +innerRadius.apply(this, arguments),
        r1 = +outerRadius.apply(this, arguments),
        a0 = startAngle.apply(this, arguments) - halfPi,
        a1 = endAngle.apply(this, arguments) - halfPi,
        da = abs(a1 - a0),
        cw = a1 > a0;

    if (!context) context = buffer = path();

    // Ensure that the outer radius is always larger than the inner radius.
    if (r1 < r0) r = r1, r1 = r0, r0 = r;

    // Is it a point?
    if (!(r1 > epsilon)) context.moveTo(0, 0);

    // Or is it a circle or annulus?
    else if (da > tau - epsilon) {
      context.moveTo(r1 * cos(a0), r1 * sin(a0));
      context.arc(0, 0, r1, a0, a1, !cw);
      if (r0 > epsilon) {
        context.moveTo(r0 * cos(a1), r0 * sin(a1));
        context.arc(0, 0, r0, a1, a0, cw);
      }
    }

    // Or is it a circular or annular sector?
    else {
      var a01 = a0,
          a11 = a1,
          a00 = a0,
          a10 = a1,
          da0 = da,
          da1 = da,
          ap = padAngle.apply(this, arguments) / 2,
          rp = (ap > epsilon) && (padRadius ? +padRadius.apply(this, arguments) : sqrt(r0 * r0 + r1 * r1)),
          rc = min(abs(r1 - r0) / 2, +cornerRadius.apply(this, arguments)),
          rc0 = rc,
          rc1 = rc,
          t0,
          t1;

      // Apply padding? Note that since r1 ≥ r0, da1 ≥ da0.
      if (rp > epsilon) {
        var p0 = asin(rp / r0 * sin(ap)),
            p1 = asin(rp / r1 * sin(ap));
        if ((da0 -= p0 * 2) > epsilon) p0 *= (cw ? 1 : -1), a00 += p0, a10 -= p0;
        else da0 = 0, a00 = a10 = (a0 + a1) / 2;
        if ((da1 -= p1 * 2) > epsilon) p1 *= (cw ? 1 : -1), a01 += p1, a11 -= p1;
        else da1 = 0, a01 = a11 = (a0 + a1) / 2;
      }

      var x01 = r1 * cos(a01),
          y01 = r1 * sin(a01),
          x10 = r0 * cos(a10),
          y10 = r0 * sin(a10);

      // Apply rounded corners?
      if (rc > epsilon) {
        var x11 = r1 * cos(a11),
            y11 = r1 * sin(a11),
            x00 = r0 * cos(a00),
            y00 = r0 * sin(a00),
            oc;

        // Restrict the corner radius according to the sector angle. If this
        // intersection fails, it’s probably because the arc is too small, so
        // disable the corner radius entirely.
        if (da < pi) {
          if (oc = intersect(x01, y01, x00, y00, x11, y11, x10, y10)) {
            var ax = x01 - oc[0],
                ay = y01 - oc[1],
                bx = x11 - oc[0],
                by = y11 - oc[1],
                kc = 1 / sin(acos((ax * bx + ay * by) / (sqrt(ax * ax + ay * ay) * sqrt(bx * bx + by * by))) / 2),
                lc = sqrt(oc[0] * oc[0] + oc[1] * oc[1]);
            rc0 = min(rc, (r0 - lc) / (kc - 1));
            rc1 = min(rc, (r1 - lc) / (kc + 1));
          } else {
            rc0 = rc1 = 0;
          }
        }
      }

      // Is the sector collapsed to a line?
      if (!(da1 > epsilon)) context.moveTo(x01, y01);

      // Does the sector’s outer ring have rounded corners?
      else if (rc1 > epsilon) {
        t0 = cornerTangents(x00, y00, x01, y01, r1, rc1, cw);
        t1 = cornerTangents(x11, y11, x10, y10, r1, rc1, cw);

        context.moveTo(t0.cx + t0.x01, t0.cy + t0.y01);

        // Have the corners merged?
        if (rc1 < rc) context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);

        // Otherwise, draw the two corners and the ring.
        else {
          context.arc(t0.cx, t0.cy, rc1, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);
          context.arc(0, 0, r1, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), !cw);
          context.arc(t1.cx, t1.cy, rc1, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);
        }
      }

      // Or is the outer ring just a circular arc?
      else context.moveTo(x01, y01), context.arc(0, 0, r1, a01, a11, !cw);

      // Is there no inner ring, and it’s a circular sector?
      // Or perhaps it’s an annular sector collapsed due to padding?
      if (!(r0 > epsilon) || !(da0 > epsilon)) context.lineTo(x10, y10);

      // Does the sector’s inner ring (or point) have rounded corners?
      else if (rc0 > epsilon) {
        t0 = cornerTangents(x10, y10, x11, y11, r0, -rc0, cw);
        t1 = cornerTangents(x01, y01, x00, y00, r0, -rc0, cw);

        context.lineTo(t0.cx + t0.x01, t0.cy + t0.y01);

        // Have the corners merged?
        if (rc0 < rc) context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t1.y01, t1.x01), !cw);

        // Otherwise, draw the two corners and the ring.
        else {
          context.arc(t0.cx, t0.cy, rc0, atan2(t0.y01, t0.x01), atan2(t0.y11, t0.x11), !cw);
          context.arc(0, 0, r0, atan2(t0.cy + t0.y11, t0.cx + t0.x11), atan2(t1.cy + t1.y11, t1.cx + t1.x11), cw);
          context.arc(t1.cx, t1.cy, rc0, atan2(t1.y11, t1.x11), atan2(t1.y01, t1.x01), !cw);
        }
      }

      // Or is the inner ring just a circular arc?
      else context.arc(0, 0, r0, a10, a00, cw);
    }

    context.closePath();

    if (buffer) return context = null, buffer + "" || null;
  }

  arc.centroid = function() {
    var r = (+innerRadius.apply(this, arguments) + +outerRadius.apply(this, arguments)) / 2,
        a = (+startAngle.apply(this, arguments) + +endAngle.apply(this, arguments)) / 2 - pi / 2;
    return [cos(a) * r, sin(a) * r];
  };

  arc.innerRadius = function(_) {
    return arguments.length ? (innerRadius = typeof _ === "function" ? _ : constant$1(+_), arc) : innerRadius;
  };

  arc.outerRadius = function(_) {
    return arguments.length ? (outerRadius = typeof _ === "function" ? _ : constant$1(+_), arc) : outerRadius;
  };

  arc.cornerRadius = function(_) {
    return arguments.length ? (cornerRadius = typeof _ === "function" ? _ : constant$1(+_), arc) : cornerRadius;
  };

  arc.padRadius = function(_) {
    return arguments.length ? (padRadius = _ == null ? null : typeof _ === "function" ? _ : constant$1(+_), arc) : padRadius;
  };

  arc.startAngle = function(_) {
    return arguments.length ? (startAngle = typeof _ === "function" ? _ : constant$1(+_), arc) : startAngle;
  };

  arc.endAngle = function(_) {
    return arguments.length ? (endAngle = typeof _ === "function" ? _ : constant$1(+_), arc) : endAngle;
  };

  arc.padAngle = function(_) {
    return arguments.length ? (padAngle = typeof _ === "function" ? _ : constant$1(+_), arc) : padAngle;
  };

  arc.context = function(_) {
    return arguments.length ? ((context = _ == null ? null : _), arc) : context;
  };

  return arc;
}

var slice = Array.prototype.slice;

function array(x) {
  return typeof x === "object" && "length" in x
    ? x // Array, TypedArray, NodeList, array-like
    : Array.from(x); // Map, Set, iterable, string, or anything else
}

function Linear(context) {
  this._context = context;
}

Linear.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._point = 0;
  },
  lineEnd: function() {
    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();
    this._line = 1 - this._line;
  },
  point: function(x, y) {
    x = +x, y = +y;
    switch (this._point) {
      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;
      case 1: this._point = 2; // falls through
      default: this._context.lineTo(x, y); break;
    }
  }
};

function curveLinear(context) {
  return new Linear(context);
}

function x(p) {
  return p[0];
}

function y(p) {
  return p[1];
}

function line(x$1, y$1) {
  var defined = constant$1(true),
      context = null,
      curve = curveLinear,
      output = null,
      path = withPath(line);

  x$1 = typeof x$1 === "function" ? x$1 : (x$1 === undefined) ? x : constant$1(x$1);
  y$1 = typeof y$1 === "function" ? y$1 : (y$1 === undefined) ? y : constant$1(y$1);

  function line(data) {
    var i,
        n = (data = array(data)).length,
        d,
        defined0 = false,
        buffer;

    if (context == null) output = curve(buffer = path());

    for (i = 0; i <= n; ++i) {
      if (!(i < n && defined(d = data[i], i, data)) === defined0) {
        if (defined0 = !defined0) output.lineStart();
        else output.lineEnd();
      }
      if (defined0) output.point(+x$1(d, i, data), +y$1(d, i, data));
    }

    if (buffer) return output = null, buffer + "" || null;
  }

  line.x = function(_) {
    return arguments.length ? (x$1 = typeof _ === "function" ? _ : constant$1(+_), line) : x$1;
  };

  line.y = function(_) {
    return arguments.length ? (y$1 = typeof _ === "function" ? _ : constant$1(+_), line) : y$1;
  };

  line.defined = function(_) {
    return arguments.length ? (defined = typeof _ === "function" ? _ : constant$1(!!_), line) : defined;
  };

  line.curve = function(_) {
    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;
  };

  line.context = function(_) {
    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;
  };

  return line;
}

function area(x0, y0, y1) {
  var x1 = null,
      defined = constant$1(true),
      context = null,
      curve = curveLinear,
      output = null,
      path = withPath(area);

  x0 = typeof x0 === "function" ? x0 : (x0 === undefined) ? x : constant$1(+x0);
  y0 = typeof y0 === "function" ? y0 : (y0 === undefined) ? constant$1(0) : constant$1(+y0);
  y1 = typeof y1 === "function" ? y1 : (y1 === undefined) ? y : constant$1(+y1);

  function area(data) {
    var i,
        j,
        k,
        n = (data = array(data)).length,
        d,
        defined0 = false,
        buffer,
        x0z = new Array(n),
        y0z = new Array(n);

    if (context == null) output = curve(buffer = path());

    for (i = 0; i <= n; ++i) {
      if (!(i < n && defined(d = data[i], i, data)) === defined0) {
        if (defined0 = !defined0) {
          j = i;
          output.areaStart();
          output.lineStart();
        } else {
          output.lineEnd();
          output.lineStart();
          for (k = i - 1; k >= j; --k) {
            output.point(x0z[k], y0z[k]);
          }
          output.lineEnd();
          output.areaEnd();
        }
      }
      if (defined0) {
        x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);
        output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);
      }
    }

    if (buffer) return output = null, buffer + "" || null;
  }

  function arealine() {
    return line().defined(defined).curve(curve).context(context);
  }

  area.x = function(_) {
    return arguments.length ? (x0 = typeof _ === "function" ? _ : constant$1(+_), x1 = null, area) : x0;
  };

  area.x0 = function(_) {
    return arguments.length ? (x0 = typeof _ === "function" ? _ : constant$1(+_), area) : x0;
  };

  area.x1 = function(_) {
    return arguments.length ? (x1 = _ == null ? null : typeof _ === "function" ? _ : constant$1(+_), area) : x1;
  };

  area.y = function(_) {
    return arguments.length ? (y0 = typeof _ === "function" ? _ : constant$1(+_), y1 = null, area) : y0;
  };

  area.y0 = function(_) {
    return arguments.length ? (y0 = typeof _ === "function" ? _ : constant$1(+_), area) : y0;
  };

  area.y1 = function(_) {
    return arguments.length ? (y1 = _ == null ? null : typeof _ === "function" ? _ : constant$1(+_), area) : y1;
  };

  area.lineX0 =
  area.lineY0 = function() {
    return arealine().x(x0).y(y0);
  };

  area.lineY1 = function() {
    return arealine().x(x0).y(y1);
  };

  area.lineX1 = function() {
    return arealine().x(x1).y(y0);
  };

  area.defined = function(_) {
    return arguments.length ? (defined = typeof _ === "function" ? _ : constant$1(!!_), area) : defined;
  };

  area.curve = function(_) {
    return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;
  };

  area.context = function(_) {
    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;
  };

  return area;
}

function descending$1(a, b) {
  return b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;
}

function identity$1(d) {
  return d;
}

function pie() {
  var value = identity$1,
      sortValues = descending$1,
      sort = null,
      startAngle = constant$1(0),
      endAngle = constant$1(tau),
      padAngle = constant$1(0);

  function pie(data) {
    var i,
        n = (data = array(data)).length,
        j,
        k,
        sum = 0,
        index = new Array(n),
        arcs = new Array(n),
        a0 = +startAngle.apply(this, arguments),
        da = Math.min(tau, Math.max(-tau, endAngle.apply(this, arguments) - a0)),
        a1,
        p = Math.min(Math.abs(da) / n, padAngle.apply(this, arguments)),
        pa = p * (da < 0 ? -1 : 1),
        v;

    for (i = 0; i < n; ++i) {
      if ((v = arcs[index[i] = i] = +value(data[i], i, data)) > 0) {
        sum += v;
      }
    }

    // Optionally sort the arcs by previously-computed values or by data.
    if (sortValues != null) index.sort(function(i, j) { return sortValues(arcs[i], arcs[j]); });
    else if (sort != null) index.sort(function(i, j) { return sort(data[i], data[j]); });

    // Compute the arcs! They are stored in the original data's order.
    for (i = 0, k = sum ? (da - n * pa) / sum : 0; i < n; ++i, a0 = a1) {
      j = index[i], v = arcs[j], a1 = a0 + (v > 0 ? v * k : 0) + pa, arcs[j] = {
        data: data[j],
        index: i,
        value: v,
        startAngle: a0,
        endAngle: a1,
        padAngle: p
      };
    }

    return arcs;
  }

  pie.value = function(_) {
    return arguments.length ? (value = typeof _ === "function" ? _ : constant$1(+_), pie) : value;
  };

  pie.sortValues = function(_) {
    return arguments.length ? (sortValues = _, sort = null, pie) : sortValues;
  };

  pie.sort = function(_) {
    return arguments.length ? (sort = _, sortValues = null, pie) : sort;
  };

  pie.startAngle = function(_) {
    return arguments.length ? (startAngle = typeof _ === "function" ? _ : constant$1(+_), pie) : startAngle;
  };

  pie.endAngle = function(_) {
    return arguments.length ? (endAngle = typeof _ === "function" ? _ : constant$1(+_), pie) : endAngle;
  };

  pie.padAngle = function(_) {
    return arguments.length ? (padAngle = typeof _ === "function" ? _ : constant$1(+_), pie) : padAngle;
  };

  return pie;
}

var curveRadialLinear = curveRadial(curveLinear);

function Radial(curve) {
  this._curve = curve;
}

Radial.prototype = {
  areaStart: function() {
    this._curve.areaStart();
  },
  areaEnd: function() {
    this._curve.areaEnd();
  },
  lineStart: function() {
    this._curve.lineStart();
  },
  lineEnd: function() {
    this._curve.lineEnd();
  },
  point: function(a, r) {
    this._curve.point(r * Math.sin(a), r * -Math.cos(a));
  }
};

function curveRadial(curve) {

  function radial(context) {
    return new Radial(curve(context));
  }

  radial._curve = curve;

  return radial;
}

function lineRadial(l) {
  var c = l.curve;

  l.angle = l.x, delete l.x;
  l.radius = l.y, delete l.y;

  l.curve = function(_) {
    return arguments.length ? c(curveRadial(_)) : c()._curve;
  };

  return l;
}

function lineRadial$1() {
  return lineRadial(line().curve(curveRadialLinear));
}

function areaRadial() {
  var a = area().curve(curveRadialLinear),
      c = a.curve,
      x0 = a.lineX0,
      x1 = a.lineX1,
      y0 = a.lineY0,
      y1 = a.lineY1;

  a.angle = a.x, delete a.x;
  a.startAngle = a.x0, delete a.x0;
  a.endAngle = a.x1, delete a.x1;
  a.radius = a.y, delete a.y;
  a.innerRadius = a.y0, delete a.y0;
  a.outerRadius = a.y1, delete a.y1;
  a.lineStartAngle = function() { return lineRadial(x0()); }, delete a.lineX0;
  a.lineEndAngle = function() { return lineRadial(x1()); }, delete a.lineX1;
  a.lineInnerRadius = function() { return lineRadial(y0()); }, delete a.lineY0;
  a.lineOuterRadius = function() { return lineRadial(y1()); }, delete a.lineY1;

  a.curve = function(_) {
    return arguments.length ? c(curveRadial(_)) : c()._curve;
  };

  return a;
}

function pointRadial(x, y) {
  return [(y = +y) * Math.cos(x -= Math.PI / 2), y * Math.sin(x)];
}

class Bump {
  constructor(context, x) {
    this._context = context;
    this._x = x;
  }
  areaStart() {
    this._line = 0;
  }
  areaEnd() {
    this._line = NaN;
  }
  lineStart() {
    this._point = 0;
  }
  lineEnd() {
    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();
    this._line = 1 - this._line;
  }
  point(x, y) {
    x = +x, y = +y;
    switch (this._point) {
      case 0: {
        this._point = 1;
        if (this._line) this._context.lineTo(x, y);
        else this._context.moveTo(x, y);
        break;
      }
      case 1: this._point = 2; // falls through
      default: {
        if (this._x) this._context.bezierCurveTo(this._x0 = (this._x0 + x) / 2, this._y0, this._x0, y, x, y);
        else this._context.bezierCurveTo(this._x0, this._y0 = (this._y0 + y) / 2, x, this._y0, x, y);
        break;
      }
    }
    this._x0 = x, this._y0 = y;
  }
}

class BumpRadial {
  constructor(context) {
    this._context = context;
  }
  lineStart() {
    this._point = 0;
  }
  lineEnd() {}
  point(x, y) {
    x = +x, y = +y;
    if (this._point === 0) {
      this._point = 1;
    } else {
      const p0 = pointRadial(this._x0, this._y0);
      const p1 = pointRadial(this._x0, this._y0 = (this._y0 + y) / 2);
      const p2 = pointRadial(x, this._y0);
      const p3 = pointRadial(x, y);
      this._context.moveTo(...p0);
      this._context.bezierCurveTo(...p1, ...p2, ...p3);
    }
    this._x0 = x, this._y0 = y;
  }
}

function bumpX(context) {
  return new Bump(context, true);
}

function bumpY(context) {
  return new Bump(context, false);
}

function bumpRadial(context) {
  return new BumpRadial(context);
}

function linkSource(d) {
  return d.source;
}

function linkTarget(d) {
  return d.target;
}

function link(curve) {
  let source = linkSource,
      target = linkTarget,
      x$1 = x,
      y$1 = y,
      context = null,
      output = null,
      path = withPath(link);

  function link() {
    let buffer;
    const argv = slice.call(arguments);
    const s = source.apply(this, argv);
    const t = target.apply(this, argv);
    if (context == null) output = curve(buffer = path());
    output.lineStart();
    argv[0] = s, output.point(+x$1.apply(this, argv), +y$1.apply(this, argv));
    argv[0] = t, output.point(+x$1.apply(this, argv), +y$1.apply(this, argv));
    output.lineEnd();
    if (buffer) return output = null, buffer + "" || null;
  }

  link.source = function(_) {
    return arguments.length ? (source = _, link) : source;
  };

  link.target = function(_) {
    return arguments.length ? (target = _, link) : target;
  };

  link.x = function(_) {
    return arguments.length ? (x$1 = typeof _ === "function" ? _ : constant$1(+_), link) : x$1;
  };

  link.y = function(_) {
    return arguments.length ? (y$1 = typeof _ === "function" ? _ : constant$1(+_), link) : y$1;
  };

  link.context = function(_) {
    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), link) : context;
  };

  return link;
}

function linkHorizontal() {
  return link(bumpX);
}

function linkVertical() {
  return link(bumpY);
}

function linkRadial() {
  const l = link(bumpRadial);
  l.angle = l.x, delete l.x;
  l.radius = l.y, delete l.y;
  return l;
}

const sqrt3$2 = sqrt(3);

var asterisk = {
  draw(context, size) {
    const r = sqrt(size + min(size / 28, 0.75)) * 0.59436;
    const t = r / 2;
    const u = t * sqrt3$2;
    context.moveTo(0, r);
    context.lineTo(0, -r);
    context.moveTo(-u, -t);
    context.lineTo(u, t);
    context.moveTo(-u, t);
    context.lineTo(u, -t);
  }
};

var circle = {
  draw(context, size) {
    const r = sqrt(size / pi);
    context.moveTo(r, 0);
    context.arc(0, 0, r, 0, tau);
  }
};

var cross = {
  draw(context, size) {
    const r = sqrt(size / 5) / 2;
    context.moveTo(-3 * r, -r);
    context.lineTo(-r, -r);
    context.lineTo(-r, -3 * r);
    context.lineTo(r, -3 * r);
    context.lineTo(r, -r);
    context.lineTo(3 * r, -r);
    context.lineTo(3 * r, r);
    context.lineTo(r, r);
    context.lineTo(r, 3 * r);
    context.lineTo(-r, 3 * r);
    context.lineTo(-r, r);
    context.lineTo(-3 * r, r);
    context.closePath();
  }
};

const tan30 = sqrt(1 / 3);
const tan30_2 = tan30 * 2;

var diamond = {
  draw(context, size) {
    const y = sqrt(size / tan30_2);
    const x = y * tan30;
    context.moveTo(0, -y);
    context.lineTo(x, 0);
    context.lineTo(0, y);
    context.lineTo(-x, 0);
    context.closePath();
  }
};

var diamond2 = {
  draw(context, size) {
    const r = sqrt(size) * 0.62625;
    context.moveTo(0, -r);
    context.lineTo(r, 0);
    context.lineTo(0, r);
    context.lineTo(-r, 0);
    context.closePath();
  }
};

var plus = {
  draw(context, size) {
    const r = sqrt(size - min(size / 7, 2)) * 0.87559;
    context.moveTo(-r, 0);
    context.lineTo(r, 0);
    context.moveTo(0, r);
    context.lineTo(0, -r);
  }
};

var square = {
  draw(context, size) {
    const w = sqrt(size);
    const x = -w / 2;
    context.rect(x, x, w, w);
  }
};

var square2 = {
  draw(context, size) {
    const r = sqrt(size) * 0.4431;
    context.moveTo(r, r);
    context.lineTo(r, -r);
    context.lineTo(-r, -r);
    context.lineTo(-r, r);
    context.closePath();
  }
};

const ka = 0.89081309152928522810;
const kr = sin(pi / 10) / sin(7 * pi / 10);
const kx = sin(tau / 10) * kr;
const ky = -cos(tau / 10) * kr;

var star = {
  draw(context, size) {
    const r = sqrt(size * ka);
    const x = kx * r;
    const y = ky * r;
    context.moveTo(0, -r);
    context.lineTo(x, y);
    for (let i = 1; i < 5; ++i) {
      const a = tau * i / 5;
      const c = cos(a);
      const s = sin(a);
      context.lineTo(s * r, -c * r);
      context.lineTo(c * x - s * y, s * x + c * y);
    }
    context.closePath();
  }
};

const sqrt3$1 = sqrt(3);

var triangle = {
  draw(context, size) {
    const y = -sqrt(size / (sqrt3$1 * 3));
    context.moveTo(0, y * 2);
    context.lineTo(-sqrt3$1 * y, -y);
    context.lineTo(sqrt3$1 * y, -y);
    context.closePath();
  }
};

const sqrt3 = sqrt(3);

var triangle2 = {
  draw(context, size) {
    const s = sqrt(size) * 0.6824;
    const t = s  / 2;
    const u = (s * sqrt3) / 2; // cos(Math.PI / 6)
    context.moveTo(0, -s);
    context.lineTo(u, t);
    context.lineTo(-u, t);
    context.closePath();
  }
};

const c = -0.5;
const s = sqrt(3) / 2;
const k = 1 / sqrt(12);
const a = (k / 2 + 1) * 3;

var wye = {
  draw(context, size) {
    const r = sqrt(size / a);
    const x0 = r / 2, y0 = r * k;
    const x1 = x0, y1 = r * k + r;
    const x2 = -x1, y2 = y1;
    context.moveTo(x0, y0);
    context.lineTo(x1, y1);
    context.lineTo(x2, y2);
    context.lineTo(c * x0 - s * y0, s * x0 + c * y0);
    context.lineTo(c * x1 - s * y1, s * x1 + c * y1);
    context.lineTo(c * x2 - s * y2, s * x2 + c * y2);
    context.lineTo(c * x0 + s * y0, c * y0 - s * x0);
    context.lineTo(c * x1 + s * y1, c * y1 - s * x1);
    context.lineTo(c * x2 + s * y2, c * y2 - s * x2);
    context.closePath();
  }
};

var times = {
  draw(context, size) {
    const r = sqrt(size - min(size / 6, 1.7)) * 0.6189;
    context.moveTo(-r, -r);
    context.lineTo(r, r);
    context.moveTo(-r, r);
    context.lineTo(r, -r);
  }
};

// These symbols are designed to be filled.
const symbolsFill = [
  circle,
  cross,
  diamond,
  square,
  star,
  triangle,
  wye
];

// These symbols are designed to be stroked (with a width of 1.5px and round caps).
const symbolsStroke = [
  circle,
  plus,
  times,
  triangle2,
  asterisk,
  square2,
  diamond2
];

function Symbol$1(type, size) {
  let context = null,
      path = withPath(symbol);

  type = typeof type === "function" ? type : constant$1(type || circle);
  size = typeof size === "function" ? size : constant$1(size === undefined ? 64 : +size);

  function symbol() {
    let buffer;
    if (!context) context = buffer = path();
    type.apply(this, arguments).draw(context, +size.apply(this, arguments));
    if (buffer) return context = null, buffer + "" || null;
  }

  symbol.type = function(_) {
    return arguments.length ? (type = typeof _ === "function" ? _ : constant$1(_), symbol) : type;
  };

  symbol.size = function(_) {
    return arguments.length ? (size = typeof _ === "function" ? _ : constant$1(+_), symbol) : size;
  };

  symbol.context = function(_) {
    return arguments.length ? (context = _ == null ? null : _, symbol) : context;
  };

  return symbol;
}

function noop() {}

function point$3(that, x, y) {
  that._context.bezierCurveTo(
    (2 * that._x0 + that._x1) / 3,
    (2 * that._y0 + that._y1) / 3,
    (that._x0 + 2 * that._x1) / 3,
    (that._y0 + 2 * that._y1) / 3,
    (that._x0 + 4 * that._x1 + x) / 6,
    (that._y0 + 4 * that._y1 + y) / 6
  );
}

function Basis(context) {
  this._context = context;
}

Basis.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._x0 = this._x1 =
    this._y0 = this._y1 = NaN;
    this._point = 0;
  },
  lineEnd: function() {
    switch (this._point) {
      case 3: point$3(this, this._x1, this._y1); // falls through
      case 2: this._context.lineTo(this._x1, this._y1); break;
    }
    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();
    this._line = 1 - this._line;
  },
  point: function(x, y) {
    x = +x, y = +y;
    switch (this._point) {
      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;
      case 1: this._point = 2; break;
      case 2: this._point = 3; this._context.lineTo((5 * this._x0 + this._x1) / 6, (5 * this._y0 + this._y1) / 6); // falls through
      default: point$3(this, x, y); break;
    }
    this._x0 = this._x1, this._x1 = x;
    this._y0 = this._y1, this._y1 = y;
  }
};

function basis(context) {
  return new Basis(context);
}

function BasisClosed(context) {
  this._context = context;
}

BasisClosed.prototype = {
  areaStart: noop,
  areaEnd: noop,
  lineStart: function() {
    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 =
    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = NaN;
    this._point = 0;
  },
  lineEnd: function() {
    switch (this._point) {
      case 1: {
        this._context.moveTo(this._x2, this._y2);
        this._context.closePath();
        break;
      }
      case 2: {
        this._context.moveTo((this._x2 + 2 * this._x3) / 3, (this._y2 + 2 * this._y3) / 3);
        this._context.lineTo((this._x3 + 2 * this._x2) / 3, (this._y3 + 2 * this._y2) / 3);
        this._context.closePath();
        break;
      }
      case 3: {
        this.point(this._x2, this._y2);
        this.point(this._x3, this._y3);
        this.point(this._x4, this._y4);
        break;
      }
    }
  },
  point: function(x, y) {
    x = +x, y = +y;
    switch (this._point) {
      case 0: this._point = 1; this._x2 = x, this._y2 = y; break;
      case 1: this._point = 2; this._x3 = x, this._y3 = y; break;
      case 2: this._point = 3; this._x4 = x, this._y4 = y; this._context.moveTo((this._x0 + 4 * this._x1 + x) / 6, (this._y0 + 4 * this._y1 + y) / 6); break;
      default: point$3(this, x, y); break;
    }
    this._x0 = this._x1, this._x1 = x;
    this._y0 = this._y1, this._y1 = y;
  }
};

function basisClosed(context) {
  return new BasisClosed(context);
}

function BasisOpen(context) {
  this._context = context;
}

BasisOpen.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._x0 = this._x1 =
    this._y0 = this._y1 = NaN;
    this._point = 0;
  },
  lineEnd: function() {
    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();
    this._line = 1 - this._line;
  },
  point: function(x, y) {
    x = +x, y = +y;
    switch (this._point) {
      case 0: this._point = 1; break;
      case 1: this._point = 2; break;
      case 2: this._point = 3; var x0 = (this._x0 + 4 * this._x1 + x) / 6, y0 = (this._y0 + 4 * this._y1 + y) / 6; this._line ? this._context.lineTo(x0, y0) : this._context.moveTo(x0, y0); break;
      case 3: this._point = 4; // falls through
      default: point$3(this, x, y); break;
    }
    this._x0 = this._x1, this._x1 = x;
    this._y0 = this._y1, this._y1 = y;
  }
};

function basisOpen(context) {
  return new BasisOpen(context);
}

function Bundle(context, beta) {
  this._basis = new Basis(context);
  this._beta = beta;
}

Bundle.prototype = {
  lineStart: function() {
    this._x = [];
    this._y = [];
    this._basis.lineStart();
  },
  lineEnd: function() {
    var x = this._x,
        y = this._y,
        j = x.length - 1;

    if (j > 0) {
      var x0 = x[0],
          y0 = y[0],
          dx = x[j] - x0,
          dy = y[j] - y0,
          i = -1,
          t;

      while (++i <= j) {
        t = i / j;
        this._basis.point(
          this._beta * x[i] + (1 - this._beta) * (x0 + t * dx),
          this._beta * y[i] + (1 - this._beta) * (y0 + t * dy)
        );
      }
    }

    this._x = this._y = null;
    this._basis.lineEnd();
  },
  point: function(x, y) {
    this._x.push(+x);
    this._y.push(+y);
  }
};

var bundle = (function custom(beta) {

  function bundle(context) {
    return beta === 1 ? new Basis(context) : new Bundle(context, beta);
  }

  bundle.beta = function(beta) {
    return custom(+beta);
  };

  return bundle;
})(0.85);

function point$2(that, x, y) {
  that._context.bezierCurveTo(
    that._x1 + that._k * (that._x2 - that._x0),
    that._y1 + that._k * (that._y2 - that._y0),
    that._x2 + that._k * (that._x1 - x),
    that._y2 + that._k * (that._y1 - y),
    that._x2,
    that._y2
  );
}

function Cardinal(context, tension) {
  this._context = context;
  this._k = (1 - tension) / 6;
}

Cardinal.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._x0 = this._x1 = this._x2 =
    this._y0 = this._y1 = this._y2 = NaN;
    this._point = 0;
  },
  lineEnd: function() {
    switch (this._point) {
      case 2: this._context.lineTo(this._x2, this._y2); break;
      case 3: point$2(this, this._x1, this._y1); break;
    }
    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();
    this._line = 1 - this._line;
  },
  point: function(x, y) {
    x = +x, y = +y;
    switch (this._point) {
      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;
      case 1: this._point = 2; this._x1 = x, this._y1 = y; break;
      case 2: this._point = 3; // falls through
      default: point$2(this, x, y); break;
    }
    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
  }
};

var cardinal = (function custom(tension) {

  function cardinal(context) {
    return new Cardinal(context, tension);
  }

  cardinal.tension = function(tension) {
    return custom(+tension);
  };

  return cardinal;
})(0);

function CardinalClosed(context, tension) {
  this._context = context;
  this._k = (1 - tension) / 6;
}

CardinalClosed.prototype = {
  areaStart: noop,
  areaEnd: noop,
  lineStart: function() {
    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 =
    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;
    this._point = 0;
  },
  lineEnd: function() {
    switch (this._point) {
      case 1: {
        this._context.moveTo(this._x3, this._y3);
        this._context.closePath();
        break;
      }
      case 2: {
        this._context.lineTo(this._x3, this._y3);
        this._context.closePath();
        break;
      }
      case 3: {
        this.point(this._x3, this._y3);
        this.point(this._x4, this._y4);
        this.point(this._x5, this._y5);
        break;
      }
    }
  },
  point: function(x, y) {
    x = +x, y = +y;
    switch (this._point) {
      case 0: this._point = 1; this._x3 = x, this._y3 = y; break;
      case 1: this._point = 2; this._context.moveTo(this._x4 = x, this._y4 = y); break;
      case 2: this._point = 3; this._x5 = x, this._y5 = y; break;
      default: point$2(this, x, y); break;
    }
    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
  }
};

var cardinalClosed = (function custom(tension) {

  function cardinal(context) {
    return new CardinalClosed(context, tension);
  }

  cardinal.tension = function(tension) {
    return custom(+tension);
  };

  return cardinal;
})(0);

function CardinalOpen(context, tension) {
  this._context = context;
  this._k = (1 - tension) / 6;
}

CardinalOpen.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._x0 = this._x1 = this._x2 =
    this._y0 = this._y1 = this._y2 = NaN;
    this._point = 0;
  },
  lineEnd: function() {
    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();
    this._line = 1 - this._line;
  },
  point: function(x, y) {
    x = +x, y = +y;
    switch (this._point) {
      case 0: this._point = 1; break;
      case 1: this._point = 2; break;
      case 2: this._point = 3; this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2); break;
      case 3: this._point = 4; // falls through
      default: point$2(this, x, y); break;
    }
    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
  }
};

var cardinalOpen = (function custom(tension) {

  function cardinal(context) {
    return new CardinalOpen(context, tension);
  }

  cardinal.tension = function(tension) {
    return custom(+tension);
  };

  return cardinal;
})(0);

function point$1(that, x, y) {
  var x1 = that._x1,
      y1 = that._y1,
      x2 = that._x2,
      y2 = that._y2;

  if (that._l01_a > epsilon) {
    var a = 2 * that._l01_2a + 3 * that._l01_a * that._l12_a + that._l12_2a,
        n = 3 * that._l01_a * (that._l01_a + that._l12_a);
    x1 = (x1 * a - that._x0 * that._l12_2a + that._x2 * that._l01_2a) / n;
    y1 = (y1 * a - that._y0 * that._l12_2a + that._y2 * that._l01_2a) / n;
  }

  if (that._l23_a > epsilon) {
    var b = 2 * that._l23_2a + 3 * that._l23_a * that._l12_a + that._l12_2a,
        m = 3 * that._l23_a * (that._l23_a + that._l12_a);
    x2 = (x2 * b + that._x1 * that._l23_2a - x * that._l12_2a) / m;
    y2 = (y2 * b + that._y1 * that._l23_2a - y * that._l12_2a) / m;
  }

  that._context.bezierCurveTo(x1, y1, x2, y2, that._x2, that._y2);
}

function CatmullRom(context, alpha) {
  this._context = context;
  this._alpha = alpha;
}

CatmullRom.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._x0 = this._x1 = this._x2 =
    this._y0 = this._y1 = this._y2 = NaN;
    this._l01_a = this._l12_a = this._l23_a =
    this._l01_2a = this._l12_2a = this._l23_2a =
    this._point = 0;
  },
  lineEnd: function() {
    switch (this._point) {
      case 2: this._context.lineTo(this._x2, this._y2); break;
      case 3: this.point(this._x2, this._y2); break;
    }
    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();
    this._line = 1 - this._line;
  },
  point: function(x, y) {
    x = +x, y = +y;

    if (this._point) {
      var x23 = this._x2 - x,
          y23 = this._y2 - y;
      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));
    }

    switch (this._point) {
      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;
      case 1: this._point = 2; break;
      case 2: this._point = 3; // falls through
      default: point$1(this, x, y); break;
    }

    this._l01_a = this._l12_a, this._l12_a = this._l23_a;
    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;
    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
  }
};

var catmullRom = (function custom(alpha) {

  function catmullRom(context) {
    return alpha ? new CatmullRom(context, alpha) : new Cardinal(context, 0);
  }

  catmullRom.alpha = function(alpha) {
    return custom(+alpha);
  };

  return catmullRom;
})(0.5);

function CatmullRomClosed(context, alpha) {
  this._context = context;
  this._alpha = alpha;
}

CatmullRomClosed.prototype = {
  areaStart: noop,
  areaEnd: noop,
  lineStart: function() {
    this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 =
    this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN;
    this._l01_a = this._l12_a = this._l23_a =
    this._l01_2a = this._l12_2a = this._l23_2a =
    this._point = 0;
  },
  lineEnd: function() {
    switch (this._point) {
      case 1: {
        this._context.moveTo(this._x3, this._y3);
        this._context.closePath();
        break;
      }
      case 2: {
        this._context.lineTo(this._x3, this._y3);
        this._context.closePath();
        break;
      }
      case 3: {
        this.point(this._x3, this._y3);
        this.point(this._x4, this._y4);
        this.point(this._x5, this._y5);
        break;
      }
    }
  },
  point: function(x, y) {
    x = +x, y = +y;

    if (this._point) {
      var x23 = this._x2 - x,
          y23 = this._y2 - y;
      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));
    }

    switch (this._point) {
      case 0: this._point = 1; this._x3 = x, this._y3 = y; break;
      case 1: this._point = 2; this._context.moveTo(this._x4 = x, this._y4 = y); break;
      case 2: this._point = 3; this._x5 = x, this._y5 = y; break;
      default: point$1(this, x, y); break;
    }

    this._l01_a = this._l12_a, this._l12_a = this._l23_a;
    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;
    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
  }
};

var catmullRomClosed = (function custom(alpha) {

  function catmullRom(context) {
    return alpha ? new CatmullRomClosed(context, alpha) : new CardinalClosed(context, 0);
  }

  catmullRom.alpha = function(alpha) {
    return custom(+alpha);
  };

  return catmullRom;
})(0.5);

function CatmullRomOpen(context, alpha) {
  this._context = context;
  this._alpha = alpha;
}

CatmullRomOpen.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._x0 = this._x1 = this._x2 =
    this._y0 = this._y1 = this._y2 = NaN;
    this._l01_a = this._l12_a = this._l23_a =
    this._l01_2a = this._l12_2a = this._l23_2a =
    this._point = 0;
  },
  lineEnd: function() {
    if (this._line || (this._line !== 0 && this._point === 3)) this._context.closePath();
    this._line = 1 - this._line;
  },
  point: function(x, y) {
    x = +x, y = +y;

    if (this._point) {
      var x23 = this._x2 - x,
          y23 = this._y2 - y;
      this._l23_a = Math.sqrt(this._l23_2a = Math.pow(x23 * x23 + y23 * y23, this._alpha));
    }

    switch (this._point) {
      case 0: this._point = 1; break;
      case 1: this._point = 2; break;
      case 2: this._point = 3; this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2); break;
      case 3: this._point = 4; // falls through
      default: point$1(this, x, y); break;
    }

    this._l01_a = this._l12_a, this._l12_a = this._l23_a;
    this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a;
    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;
    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;
  }
};

var catmullRomOpen = (function custom(alpha) {

  function catmullRom(context) {
    return alpha ? new CatmullRomOpen(context, alpha) : new CardinalOpen(context, 0);
  }

  catmullRom.alpha = function(alpha) {
    return custom(+alpha);
  };

  return catmullRom;
})(0.5);

function LinearClosed(context) {
  this._context = context;
}

LinearClosed.prototype = {
  areaStart: noop,
  areaEnd: noop,
  lineStart: function() {
    this._point = 0;
  },
  lineEnd: function() {
    if (this._point) this._context.closePath();
  },
  point: function(x, y) {
    x = +x, y = +y;
    if (this._point) this._context.lineTo(x, y);
    else this._point = 1, this._context.moveTo(x, y);
  }
};

function linearClosed(context) {
  return new LinearClosed(context);
}

function sign(x) {
  return x < 0 ? -1 : 1;
}

// Calculate the slopes of the tangents (Hermite-type interpolation) based on
// the following paper: Steffen, M. 1990. A Simple Method for Monotonic
// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.
// NOV(II), P. 443, 1990.
function slope3(that, x2, y2) {
  var h0 = that._x1 - that._x0,
      h1 = x2 - that._x1,
      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),
      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),
      p = (s0 * h1 + s1 * h0) / (h0 + h1);
  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;
}

// Calculate a one-sided slope.
function slope2(that, t) {
  var h = that._x1 - that._x0;
  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;
}

// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations
// "you can express cubic Hermite interpolation in terms of cubic Bézier curves
// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1".
function point(that, t0, t1) {
  var x0 = that._x0,
      y0 = that._y0,
      x1 = that._x1,
      y1 = that._y1,
      dx = (x1 - x0) / 3;
  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);
}

function MonotoneX(context) {
  this._context = context;
}

MonotoneX.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._x0 = this._x1 =
    this._y0 = this._y1 =
    this._t0 = NaN;
    this._point = 0;
  },
  lineEnd: function() {
    switch (this._point) {
      case 2: this._context.lineTo(this._x1, this._y1); break;
      case 3: point(this, this._t0, slope2(this, this._t0)); break;
    }
    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();
    this._line = 1 - this._line;
  },
  point: function(x, y) {
    var t1 = NaN;

    x = +x, y = +y;
    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.
    switch (this._point) {
      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;
      case 1: this._point = 2; break;
      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;
      default: point(this, this._t0, t1 = slope3(this, x, y)); break;
    }

    this._x0 = this._x1, this._x1 = x;
    this._y0 = this._y1, this._y1 = y;
    this._t0 = t1;
  }
};

function MonotoneY(context) {
  this._context = new ReflectContext(context);
}

(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {
  MonotoneX.prototype.point.call(this, y, x);
};

function ReflectContext(context) {
  this._context = context;
}

ReflectContext.prototype = {
  moveTo: function(x, y) { this._context.moveTo(y, x); },
  closePath: function() { this._context.closePath(); },
  lineTo: function(x, y) { this._context.lineTo(y, x); },
  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }
};

function monotoneX(context) {
  return new MonotoneX(context);
}

function monotoneY(context) {
  return new MonotoneY(context);
}

function Natural(context) {
  this._context = context;
}

Natural.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._x = [];
    this._y = [];
  },
  lineEnd: function() {
    var x = this._x,
        y = this._y,
        n = x.length;

    if (n) {
      this._line ? this._context.lineTo(x[0], y[0]) : this._context.moveTo(x[0], y[0]);
      if (n === 2) {
        this._context.lineTo(x[1], y[1]);
      } else {
        var px = controlPoints(x),
            py = controlPoints(y);
        for (var i0 = 0, i1 = 1; i1 < n; ++i0, ++i1) {
          this._context.bezierCurveTo(px[0][i0], py[0][i0], px[1][i0], py[1][i0], x[i1], y[i1]);
        }
      }
    }

    if (this._line || (this._line !== 0 && n === 1)) this._context.closePath();
    this._line = 1 - this._line;
    this._x = this._y = null;
  },
  point: function(x, y) {
    this._x.push(+x);
    this._y.push(+y);
  }
};

// See https://www.particleincell.com/2012/bezier-splines/ for derivation.
function controlPoints(x) {
  var i,
      n = x.length - 1,
      m,
      a = new Array(n),
      b = new Array(n),
      r = new Array(n);
  a[0] = 0, b[0] = 2, r[0] = x[0] + 2 * x[1];
  for (i = 1; i < n - 1; ++i) a[i] = 1, b[i] = 4, r[i] = 4 * x[i] + 2 * x[i + 1];
  a[n - 1] = 2, b[n - 1] = 7, r[n - 1] = 8 * x[n - 1] + x[n];
  for (i = 1; i < n; ++i) m = a[i] / b[i - 1], b[i] -= m, r[i] -= m * r[i - 1];
  a[n - 1] = r[n - 1] / b[n - 1];
  for (i = n - 2; i >= 0; --i) a[i] = (r[i] - a[i + 1]) / b[i];
  b[n - 1] = (x[n] + a[n - 1]) / 2;
  for (i = 0; i < n - 1; ++i) b[i] = 2 * x[i + 1] - a[i + 1];
  return [a, b];
}

function natural(context) {
  return new Natural(context);
}

function Step(context, t) {
  this._context = context;
  this._t = t;
}

Step.prototype = {
  areaStart: function() {
    this._line = 0;
  },
  areaEnd: function() {
    this._line = NaN;
  },
  lineStart: function() {
    this._x = this._y = NaN;
    this._point = 0;
  },
  lineEnd: function() {
    if (0 < this._t && this._t < 1 && this._point === 2) this._context.lineTo(this._x, this._y);
    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();
    if (this._line >= 0) this._t = 1 - this._t, this._line = 1 - this._line;
  },
  point: function(x, y) {
    x = +x, y = +y;
    switch (this._point) {
      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;
      case 1: this._point = 2; // falls through
      default: {
        if (this._t <= 0) {
          this._context.lineTo(this._x, y);
          this._context.lineTo(x, y);
        } else {
          var x1 = this._x * (1 - this._t) + x * this._t;
          this._context.lineTo(x1, this._y);
          this._context.lineTo(x1, y);
        }
        break;
      }
    }
    this._x = x, this._y = y;
  }
};

function step(context) {
  return new Step(context, 0.5);
}

function stepBefore(context) {
  return new Step(context, 0);
}

function stepAfter(context) {
  return new Step(context, 1);
}

function none$1(series, order) {
  if (!((n = series.length) > 1)) return;
  for (var i = 1, j, s0, s1 = series[order[0]], n, m = s1.length; i < n; ++i) {
    s0 = s1, s1 = series[order[i]];
    for (j = 0; j < m; ++j) {
      s1[j][1] += s1[j][0] = isNaN(s0[j][1]) ? s0[j][0] : s0[j][1];
    }
  }
}

function none(series) {
  var n = series.length, o = new Array(n);
  while (--n >= 0) o[n] = n;
  return o;
}

function stackValue(d, key) {
  return d[key];
}

function stackSeries(key) {
  const series = [];
  series.key = key;
  return series;
}

function stack() {
  var keys = constant$1([]),
      order = none,
      offset = none$1,
      value = stackValue;

  function stack(data) {
    var sz = Array.from(keys.apply(this, arguments), stackSeries),
        i, n = sz.length, j = -1,
        oz;

    for (const d of data) {
      for (i = 0, ++j; i < n; ++i) {
        (sz[i][j] = [0, +value(d, sz[i].key, j, data)]).data = d;
      }
    }

    for (i = 0, oz = array(order(sz)); i < n; ++i) {
      sz[oz[i]].index = i;
    }

    offset(sz, oz);
    return sz;
  }

  stack.keys = function(_) {
    return arguments.length ? (keys = typeof _ === "function" ? _ : constant$1(Array.from(_)), stack) : keys;
  };

  stack.value = function(_) {
    return arguments.length ? (value = typeof _ === "function" ? _ : constant$1(+_), stack) : value;
  };

  stack.order = function(_) {
    return arguments.length ? (order = _ == null ? none : typeof _ === "function" ? _ : constant$1(Array.from(_)), stack) : order;
  };

  stack.offset = function(_) {
    return arguments.length ? (offset = _ == null ? none$1 : _, stack) : offset;
  };

  return stack;
}

function expand(series, order) {
  if (!((n = series.length) > 0)) return;
  for (var i, n, j = 0, m = series[0].length, y; j < m; ++j) {
    for (y = i = 0; i < n; ++i) y += series[i][j][1] || 0;
    if (y) for (i = 0; i < n; ++i) series[i][j][1] /= y;
  }
  none$1(series, order);
}

function diverging(series, order) {
  if (!((n = series.length) > 0)) return;
  for (var i, j = 0, d, dy, yp, yn, n, m = series[order[0]].length; j < m; ++j) {
    for (yp = yn = 0, i = 0; i < n; ++i) {
      if ((dy = (d = series[order[i]][j])[1] - d[0]) > 0) {
        d[0] = yp, d[1] = yp += dy;
      } else if (dy < 0) {
        d[1] = yn, d[0] = yn += dy;
      } else {
        d[0] = 0, d[1] = dy;
      }
    }
  }
}

function silhouette(series, order) {
  if (!((n = series.length) > 0)) return;
  for (var j = 0, s0 = series[order[0]], n, m = s0.length; j < m; ++j) {
    for (var i = 0, y = 0; i < n; ++i) y += series[i][j][1] || 0;
    s0[j][1] += s0[j][0] = -y / 2;
  }
  none$1(series, order);
}

function wiggle(series, order) {
  if (!((n = series.length) > 0) || !((m = (s0 = series[order[0]]).length) > 0)) return;
  for (var y = 0, j = 1, s0, m, n; j < m; ++j) {
    for (var i = 0, s1 = 0, s2 = 0; i < n; ++i) {
      var si = series[order[i]],
          sij0 = si[j][1] || 0,
          sij1 = si[j - 1][1] || 0,
          s3 = (sij0 - sij1) / 2;
      for (var k = 0; k < i; ++k) {
        var sk = series[order[k]],
            skj0 = sk[j][1] || 0,
            skj1 = sk[j - 1][1] || 0;
        s3 += skj0 - skj1;
      }
      s1 += sij0, s2 += s3 * sij0;
    }
    s0[j - 1][1] += s0[j - 1][0] = y;
    if (s1) y -= s2 / s1;
  }
  s0[j - 1][1] += s0[j - 1][0] = y;
  none$1(series, order);
}

function appearance(series) {
  var peaks = series.map(peak);
  return none(series).sort(function(a, b) { return peaks[a] - peaks[b]; });
}

function peak(series) {
  var i = -1, j = 0, n = series.length, vi, vj = -Infinity;
  while (++i < n) if ((vi = +series[i][1]) > vj) vj = vi, j = i;
  return j;
}

function ascending(series) {
  var sums = series.map(sum);
  return none(series).sort(function(a, b) { return sums[a] - sums[b]; });
}

function sum(series) {
  var s = 0, i = -1, n = series.length, v;
  while (++i < n) if (v = +series[i][1]) s += v;
  return s;
}

function descending(series) {
  return ascending(series).reverse();
}

function insideOut(series) {
  var n = series.length,
      i,
      j,
      sums = series.map(sum),
      order = appearance(series),
      top = 0,
      bottom = 0,
      tops = [],
      bottoms = [];

  for (i = 0; i < n; ++i) {
    j = order[i];
    if (top < bottom) {
      top += sums[j];
      tops.push(j);
    } else {
      bottom += sums[j];
      bottoms.push(j);
    }
  }

  return bottoms.reverse().concat(tops);
}

function reverse(series) {
  return none(series).reverse();
}

var constant = x => () => x;

function ZoomEvent(type, {
  sourceEvent,
  target,
  transform,
  dispatch
}) {
  Object.defineProperties(this, {
    type: {value: type, enumerable: true, configurable: true},
    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},
    target: {value: target, enumerable: true, configurable: true},
    transform: {value: transform, enumerable: true, configurable: true},
    _: {value: dispatch}
  });
}

function Transform(k, x, y) {
  this.k = k;
  this.x = x;
  this.y = y;
}

Transform.prototype = {
  constructor: Transform,
  scale: function(k) {
    return k === 1 ? this : new Transform(this.k * k, this.x, this.y);
  },
  translate: function(x, y) {
    return x === 0 & y === 0 ? this : new Transform(this.k, this.x + this.k * x, this.y + this.k * y);
  },
  apply: function(point) {
    return [point[0] * this.k + this.x, point[1] * this.k + this.y];
  },
  applyX: function(x) {
    return x * this.k + this.x;
  },
  applyY: function(y) {
    return y * this.k + this.y;
  },
  invert: function(location) {
    return [(location[0] - this.x) / this.k, (location[1] - this.y) / this.k];
  },
  invertX: function(x) {
    return (x - this.x) / this.k;
  },
  invertY: function(y) {
    return (y - this.y) / this.k;
  },
  rescaleX: function(x) {
    return x.copy().domain(x.range().map(this.invertX, this).map(x.invert, x));
  },
  rescaleY: function(y) {
    return y.copy().domain(y.range().map(this.invertY, this).map(y.invert, y));
  },
  toString: function() {
    return "translate(" + this.x + "," + this.y + ") scale(" + this.k + ")";
  }
};

var identity = new Transform(1, 0, 0);

transform.prototype = Transform.prototype;

function transform(node) {
  while (!node.__zoom) if (!(node = node.parentNode)) return identity;
  return node.__zoom;
}

function nopropagation(event) {
  event.stopImmediatePropagation();
}

function noevent(event) {
  event.preventDefault();
  event.stopImmediatePropagation();
}

// Ignore right-click, since that should open the context menu.
// except for pinch-to-zoom, which is sent as a wheel+ctrlKey event
function defaultFilter(event) {
  return (!event.ctrlKey || event.type === 'wheel') && !event.button;
}

function defaultExtent() {
  var e = this;
  if (e instanceof SVGElement) {
    e = e.ownerSVGElement || e;
    if (e.hasAttribute("viewBox")) {
      e = e.viewBox.baseVal;
      return [[e.x, e.y], [e.x + e.width, e.y + e.height]];
    }
    return [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]];
  }
  return [[0, 0], [e.clientWidth, e.clientHeight]];
}

function defaultTransform() {
  return this.__zoom || identity;
}

function defaultWheelDelta(event) {
  return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002) * (event.ctrlKey ? 10 : 1);
}

function defaultTouchable() {
  return navigator.maxTouchPoints || ("ontouchstart" in this);
}

function defaultConstrain(transform, extent, translateExtent) {
  var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],
      dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],
      dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],
      dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];
  return transform.translate(
    dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1),
    dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1)
  );
}

function zoom() {
  var filter = defaultFilter,
      extent = defaultExtent,
      constrain = defaultConstrain,
      wheelDelta = defaultWheelDelta,
      touchable = defaultTouchable,
      scaleExtent = [0, Infinity],
      translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],
      duration = 250,
      interpolate = interpolateZoom,
      listeners = dispatch("start", "zoom", "end"),
      touchstarting,
      touchfirst,
      touchending,
      touchDelay = 500,
      wheelDelay = 150,
      clickDistance2 = 0,
      tapDistance = 10;

  function zoom(selection) {
    selection
        .property("__zoom", defaultTransform)
        .on("wheel.zoom", wheeled, {passive: false})
        .on("mousedown.zoom", mousedowned)
        .on("dblclick.zoom", dblclicked)
      .filter(touchable)
        .on("touchstart.zoom", touchstarted)
        .on("touchmove.zoom", touchmoved)
        .on("touchend.zoom touchcancel.zoom", touchended)
        .style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }

  zoom.transform = function(collection, transform, point, event) {
    var selection = collection.selection ? collection.selection() : collection;
    selection.property("__zoom", defaultTransform);
    if (collection !== selection) {
      schedule(collection, transform, point, event);
    } else {
      selection.interrupt().each(function() {
        gesture(this, arguments)
          .event(event)
          .start()
          .zoom(null, typeof transform === "function" ? transform.apply(this, arguments) : transform)
          .end();
      });
    }
  };

  zoom.scaleBy = function(selection, k, p, event) {
    zoom.scaleTo(selection, function() {
      var k0 = this.__zoom.k,
          k1 = typeof k === "function" ? k.apply(this, arguments) : k;
      return k0 * k1;
    }, p, event);
  };

  zoom.scaleTo = function(selection, k, p, event) {
    zoom.transform(selection, function() {
      var e = extent.apply(this, arguments),
          t0 = this.__zoom,
          p0 = p == null ? centroid(e) : typeof p === "function" ? p.apply(this, arguments) : p,
          p1 = t0.invert(p0),
          k1 = typeof k === "function" ? k.apply(this, arguments) : k;
      return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);
    }, p, event);
  };

  zoom.translateBy = function(selection, x, y, event) {
    zoom.transform(selection, function() {
      return constrain(this.__zoom.translate(
        typeof x === "function" ? x.apply(this, arguments) : x,
        typeof y === "function" ? y.apply(this, arguments) : y
      ), extent.apply(this, arguments), translateExtent);
    }, null, event);
  };

  zoom.translateTo = function(selection, x, y, p, event) {
    zoom.transform(selection, function() {
      var e = extent.apply(this, arguments),
          t = this.__zoom,
          p0 = p == null ? centroid(e) : typeof p === "function" ? p.apply(this, arguments) : p;
      return constrain(identity.translate(p0[0], p0[1]).scale(t.k).translate(
        typeof x === "function" ? -x.apply(this, arguments) : -x,
        typeof y === "function" ? -y.apply(this, arguments) : -y
      ), e, translateExtent);
    }, p, event);
  };

  function scale(transform, k) {
    k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));
    return k === transform.k ? transform : new Transform(k, transform.x, transform.y);
  }

  function translate(transform, p0, p1) {
    var x = p0[0] - p1[0] * transform.k, y = p0[1] - p1[1] * transform.k;
    return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);
  }

  function centroid(extent) {
    return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];
  }

  function schedule(transition, transform, point, event) {
    transition
        .on("start.zoom", function() { gesture(this, arguments).event(event).start(); })
        .on("interrupt.zoom end.zoom", function() { gesture(this, arguments).event(event).end(); })
        .tween("zoom", function() {
          var that = this,
              args = arguments,
              g = gesture(that, args).event(event),
              e = extent.apply(that, args),
              p = point == null ? centroid(e) : typeof point === "function" ? point.apply(that, args) : point,
              w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),
              a = that.__zoom,
              b = typeof transform === "function" ? transform.apply(that, args) : transform,
              i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));
          return function(t) {
            if (t === 1) t = b; // Avoid rounding error on end.
            else { var l = i(t), k = w / l[2]; t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k); }
            g.zoom(null, t);
          };
        });
  }

  function gesture(that, args, clean) {
    return (!clean && that.__zooming) || new Gesture(that, args);
  }

  function Gesture(that, args) {
    this.that = that;
    this.args = args;
    this.active = 0;
    this.sourceEvent = null;
    this.extent = extent.apply(that, args);
    this.taps = 0;
  }

  Gesture.prototype = {
    event: function(event) {
      if (event) this.sourceEvent = event;
      return this;
    },
    start: function() {
      if (++this.active === 1) {
        this.that.__zooming = this;
        this.emit("start");
      }
      return this;
    },
    zoom: function(key, transform) {
      if (this.mouse && key !== "mouse") this.mouse[1] = transform.invert(this.mouse[0]);
      if (this.touch0 && key !== "touch") this.touch0[1] = transform.invert(this.touch0[0]);
      if (this.touch1 && key !== "touch") this.touch1[1] = transform.invert(this.touch1[0]);
      this.that.__zoom = transform;
      this.emit("zoom");
      return this;
    },
    end: function() {
      if (--this.active === 0) {
        delete this.that.__zooming;
        this.emit("end");
      }
      return this;
    },
    emit: function(type) {
      var d = select(this.that).datum();
      listeners.call(
        type,
        this.that,
        new ZoomEvent(type, {
          sourceEvent: this.sourceEvent,
          target: zoom,
          type,
          transform: this.that.__zoom,
          dispatch: listeners
        }),
        d
      );
    }
  };

  function wheeled(event, ...args) {
    if (!filter.apply(this, arguments)) return;
    var g = gesture(this, args).event(event),
        t = this.__zoom,
        k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),
        p = pointer(event);

    // If the mouse is in the same location as before, reuse it.
    // If there were recent wheel events, reset the wheel idle timeout.
    if (g.wheel) {
      if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {
        g.mouse[1] = t.invert(g.mouse[0] = p);
      }
      clearTimeout(g.wheel);
    }

    // If this wheel event won’t trigger a transform change, ignore it.
    else if (t.k === k) return;

    // Otherwise, capture the mouse point and location at the start.
    else {
      g.mouse = [p, t.invert(p)];
      interrupt(this);
      g.start();
    }

    noevent(event);
    g.wheel = setTimeout(wheelidled, wheelDelay);
    g.zoom("mouse", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));

    function wheelidled() {
      g.wheel = null;
      g.end();
    }
  }

  function mousedowned(event, ...args) {
    if (touchending || !filter.apply(this, arguments)) return;
    var currentTarget = event.currentTarget,
        g = gesture(this, args, true).event(event),
        v = select(event.view).on("mousemove.zoom", mousemoved, true).on("mouseup.zoom", mouseupped, true),
        p = pointer(event, currentTarget),
        x0 = event.clientX,
        y0 = event.clientY;

    dragDisable(event.view);
    nopropagation(event);
    g.mouse = [p, this.__zoom.invert(p)];
    interrupt(this);
    g.start();

    function mousemoved(event) {
      noevent(event);
      if (!g.moved) {
        var dx = event.clientX - x0, dy = event.clientY - y0;
        g.moved = dx * dx + dy * dy > clickDistance2;
      }
      g.event(event)
       .zoom("mouse", constrain(translate(g.that.__zoom, g.mouse[0] = pointer(event, currentTarget), g.mouse[1]), g.extent, translateExtent));
    }

    function mouseupped(event) {
      v.on("mousemove.zoom mouseup.zoom", null);
      yesdrag(event.view, g.moved);
      noevent(event);
      g.event(event).end();
    }
  }

  function dblclicked(event, ...args) {
    if (!filter.apply(this, arguments)) return;
    var t0 = this.__zoom,
        p0 = pointer(event.changedTouches ? event.changedTouches[0] : event, this),
        p1 = t0.invert(p0),
        k1 = t0.k * (event.shiftKey ? 0.5 : 2),
        t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, args), translateExtent);

    noevent(event);
    if (duration > 0) select(this).transition().duration(duration).call(schedule, t1, p0, event);
    else select(this).call(zoom.transform, t1, p0, event);
  }

  function touchstarted(event, ...args) {
    if (!filter.apply(this, arguments)) return;
    var touches = event.touches,
        n = touches.length,
        g = gesture(this, args, event.changedTouches.length === n).event(event),
        started, i, t, p;

    nopropagation(event);
    for (i = 0; i < n; ++i) {
      t = touches[i], p = pointer(t, this);
      p = [p, this.__zoom.invert(p), t.identifier];
      if (!g.touch0) g.touch0 = p, started = true, g.taps = 1 + !!touchstarting;
      else if (!g.touch1 && g.touch0[2] !== p[2]) g.touch1 = p, g.taps = 0;
    }

    if (touchstarting) touchstarting = clearTimeout(touchstarting);

    if (started) {
      if (g.taps < 2) touchfirst = p[0], touchstarting = setTimeout(function() { touchstarting = null; }, touchDelay);
      interrupt(this);
      g.start();
    }
  }

  function touchmoved(event, ...args) {
    if (!this.__zooming) return;
    var g = gesture(this, args).event(event),
        touches = event.changedTouches,
        n = touches.length, i, t, p, l;

    noevent(event);
    for (i = 0; i < n; ++i) {
      t = touches[i], p = pointer(t, this);
      if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;
      else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;
    }
    t = g.that.__zoom;
    if (g.touch1) {
      var p0 = g.touch0[0], l0 = g.touch0[1],
          p1 = g.touch1[0], l1 = g.touch1[1],
          dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,
          dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;
      t = scale(t, Math.sqrt(dp / dl));
      p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];
      l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];
    }
    else if (g.touch0) p = g.touch0[0], l = g.touch0[1];
    else return;

    g.zoom("touch", constrain(translate(t, p, l), g.extent, translateExtent));
  }

  function touchended(event, ...args) {
    if (!this.__zooming) return;
    var g = gesture(this, args).event(event),
        touches = event.changedTouches,
        n = touches.length, i, t;

    nopropagation(event);
    if (touchending) clearTimeout(touchending);
    touchending = setTimeout(function() { touchending = null; }, touchDelay);
    for (i = 0; i < n; ++i) {
      t = touches[i];
      if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;
      else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;
    }
    if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;
    if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);
    else {
      g.end();
      // If this was a dbltap, reroute to the (optional) dblclick.zoom handler.
      if (g.taps === 2) {
        t = pointer(t, this);
        if (Math.hypot(touchfirst[0] - t[0], touchfirst[1] - t[1]) < tapDistance) {
          var p = select(this).on("dblclick.zoom");
          if (p) p.apply(this, arguments);
        }
      }
    }
  }

  zoom.wheelDelta = function(_) {
    return arguments.length ? (wheelDelta = typeof _ === "function" ? _ : constant(+_), zoom) : wheelDelta;
  };

  zoom.filter = function(_) {
    return arguments.length ? (filter = typeof _ === "function" ? _ : constant(!!_), zoom) : filter;
  };

  zoom.touchable = function(_) {
    return arguments.length ? (touchable = typeof _ === "function" ? _ : constant(!!_), zoom) : touchable;
  };

  zoom.extent = function(_) {
    return arguments.length ? (extent = typeof _ === "function" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;
  };

  zoom.scaleExtent = function(_) {
    return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];
  };

  zoom.translateExtent = function(_) {
    return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];
  };

  zoom.constrain = function(_) {
    return arguments.length ? (constrain = _, zoom) : constrain;
  };

  zoom.duration = function(_) {
    return arguments.length ? (duration = +_, zoom) : duration;
  };

  zoom.interpolate = function(_) {
    return arguments.length ? (interpolate = _, zoom) : interpolate;
  };

  zoom.on = function() {
    var value = listeners.on.apply(listeners, arguments);
    return value === listeners ? zoom : value;
  };

  zoom.clickDistance = function(_) {
    return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);
  };

  zoom.tapDistance = function(_) {
    return arguments.length ? (tapDistance = +_, zoom) : tapDistance;
  };

  return zoom;
}

var index$1 = /*#__PURE__*/Object.freeze({
  __proto__: null,
  Adder: Adder,
  Delaunay: Delaunay,
  FormatSpecifier: FormatSpecifier,
  InternMap: InternMap,
  InternSet: InternSet,
  Node: Node$1,
  Path: Path$1,
  Voronoi: Voronoi,
  ZoomTransform: Transform,
  active: active,
  arc: arc,
  area: area,
  areaRadial: areaRadial,
  ascending: ascending$3,
  autoType: autoType,
  axisBottom: axisBottom,
  axisLeft: axisLeft,
  axisRight: axisRight,
  axisTop: axisTop,
  bin: bin,
  bisect: bisect,
  bisectCenter: bisectCenter,
  bisectLeft: bisectLeft,
  bisectRight: bisectRight,
  bisector: bisector,
  blob: blob,
  blur: blur,
  blur2: blur2,
  blurImage: blurImage,
  brush: brush,
  brushSelection: brushSelection,
  brushX: brushX,
  brushY: brushY,
  buffer: buffer,
  chord: chord,
  chordDirected: chordDirected,
  chordTranspose: chordTranspose,
  cluster: cluster,
  color: color,
  contourDensity: density,
  contours: Contours,
  count: count$1,
  create: create$1,
  creator: creator,
  cross: cross$2,
  csv: csv,
  csvFormat: csvFormat,
  csvFormatBody: csvFormatBody,
  csvFormatRow: csvFormatRow,
  csvFormatRows: csvFormatRows,
  csvFormatValue: csvFormatValue,
  csvParse: csvParse,
  csvParseRows: csvParseRows,
  cubehelix: cubehelix$3,
  cumsum: cumsum,
  curveBasis: basis,
  curveBasisClosed: basisClosed,
  curveBasisOpen: basisOpen,
  curveBumpX: bumpX,
  curveBumpY: bumpY,
  curveBundle: bundle,
  curveCardinal: cardinal,
  curveCardinalClosed: cardinalClosed,
  curveCardinalOpen: cardinalOpen,
  curveCatmullRom: catmullRom,
  curveCatmullRomClosed: catmullRomClosed,
  curveCatmullRomOpen: catmullRomOpen,
  curveLinear: curveLinear,
  curveLinearClosed: linearClosed,
  curveMonotoneX: monotoneX,
  curveMonotoneY: monotoneY,
  curveNatural: natural,
  curveStep: step,
  curveStepAfter: stepAfter,
  curveStepBefore: stepBefore,
  descending: descending$2,
  deviation: deviation,
  difference: difference,
  disjoint: disjoint,
  dispatch: dispatch,
  drag: drag,
  dragDisable: dragDisable,
  dragEnable: yesdrag,
  dsv: dsv,
  dsvFormat: dsvFormat,
  easeBack: backInOut,
  easeBackIn: backIn,
  easeBackInOut: backInOut,
  easeBackOut: backOut,
  easeBounce: bounceOut,
  easeBounceIn: bounceIn,
  easeBounceInOut: bounceInOut,
  easeBounceOut: bounceOut,
  easeCircle: circleInOut,
  easeCircleIn: circleIn,
  easeCircleInOut: circleInOut,
  easeCircleOut: circleOut,
  easeCubic: cubicInOut,
  easeCubicIn: cubicIn,
  easeCubicInOut: cubicInOut,
  easeCubicOut: cubicOut,
  easeElastic: elasticOut,
  easeElasticIn: elasticIn,
  easeElasticInOut: elasticInOut,
  easeElasticOut: elasticOut,
  easeExp: expInOut,
  easeExpIn: expIn,
  easeExpInOut: expInOut,
  easeExpOut: expOut,
  easeLinear: linear$1,
  easePoly: polyInOut,
  easePolyIn: polyIn,
  easePolyInOut: polyInOut,
  easePolyOut: polyOut,
  easeQuad: quadInOut,
  easeQuadIn: quadIn,
  easeQuadInOut: quadInOut,
  easeQuadOut: quadOut,
  easeSin: sinInOut,
  easeSinIn: sinIn,
  easeSinInOut: sinInOut,
  easeSinOut: sinOut,
  every: every,
  extent: extent$1,
  fcumsum: fcumsum,
  filter: filter$1,
  flatGroup: flatGroup,
  flatRollup: flatRollup,
  forceCenter: center,
  forceCollide: collide,
  forceLink: link$2,
  forceManyBody: manyBody,
  forceRadial: radial$1,
  forceSimulation: simulation,
  forceX: x$1,
  forceY: y$1,
  get format () { return format; },
  formatDefaultLocale: defaultLocale$1,
  formatLocale: formatLocale$1,
  get formatPrefix () { return formatPrefix; },
  formatSpecifier: formatSpecifier,
  fsum: fsum,
  geoAlbers: albers,
  geoAlbersUsa: albersUsa,
  geoArea: area$2,
  geoAzimuthalEqualArea: azimuthalEqualArea,
  geoAzimuthalEqualAreaRaw: azimuthalEqualAreaRaw,
  geoAzimuthalEquidistant: azimuthalEquidistant,
  geoAzimuthalEquidistantRaw: azimuthalEquidistantRaw,
  geoBounds: bounds,
  geoCentroid: centroid$1,
  geoCircle: circle$1,
  geoClipAntimeridian: clipAntimeridian,
  geoClipCircle: clipCircle,
  geoClipExtent: extent,
  geoClipRectangle: clipRectangle,
  geoConicConformal: conicConformal,
  geoConicConformalRaw: conicConformalRaw,
  geoConicEqualArea: conicEqualArea,
  geoConicEqualAreaRaw: conicEqualAreaRaw,
  geoConicEquidistant: conicEquidistant,
  geoConicEquidistantRaw: conicEquidistantRaw,
  geoContains: contains$1,
  geoDistance: distance,
  geoEqualEarth: equalEarth,
  geoEqualEarthRaw: equalEarthRaw,
  geoEquirectangular: equirectangular,
  geoEquirectangularRaw: equirectangularRaw,
  geoGnomonic: gnomonic,
  geoGnomonicRaw: gnomonicRaw,
  geoGraticule: graticule,
  geoGraticule10: graticule10,
  geoIdentity: identity$4,
  geoInterpolate: interpolate,
  geoLength: length$1,
  geoMercator: mercator,
  geoMercatorRaw: mercatorRaw,
  geoNaturalEarth1: naturalEarth1,
  geoNaturalEarth1Raw: naturalEarth1Raw,
  geoOrthographic: orthographic,
  geoOrthographicRaw: orthographicRaw,
  geoPath: index$4,
  geoProjection: projection,
  geoProjectionMutator: projectionMutator,
  geoRotation: rotation,
  geoStereographic: stereographic,
  geoStereographicRaw: stereographicRaw,
  geoStream: geoStream,
  geoTransform: transform$1,
  geoTransverseMercator: transverseMercator,
  geoTransverseMercatorRaw: transverseMercatorRaw,
  gray: gray,
  greatest: greatest,
  greatestIndex: greatestIndex,
  group: group,
  groupSort: groupSort,
  groups: groups,
  hcl: hcl$2,
  hierarchy: hierarchy,
  histogram: bin,
  hsl: hsl$2,
  html: html,
  image: image,
  index: index$6,
  indexes: indexes,
  interpolate: interpolate$2,
  interpolateArray: array$3,
  interpolateBasis: basis$2,
  interpolateBasisClosed: basisClosed$1,
  interpolateBlues: Blues,
  interpolateBrBG: BrBG,
  interpolateBuGn: BuGn,
  interpolateBuPu: BuPu,
  interpolateCividis: cividis,
  interpolateCool: cool,
  interpolateCubehelix: cubehelix$2,
  interpolateCubehelixDefault: cubehelix,
  interpolateCubehelixLong: cubehelixLong,
  interpolateDate: date$1,
  interpolateDiscrete: discrete,
  interpolateGnBu: GnBu,
  interpolateGreens: Greens,
  interpolateGreys: Greys,
  interpolateHcl: hcl$1,
  interpolateHclLong: hclLong,
  interpolateHsl: hsl$1,
  interpolateHslLong: hslLong,
  interpolateHue: hue,
  interpolateInferno: inferno,
  interpolateLab: lab,
  interpolateMagma: magma,
  interpolateNumber: interpolateNumber,
  interpolateNumberArray: numberArray,
  interpolateObject: object$1,
  interpolateOrRd: OrRd,
  interpolateOranges: Oranges,
  interpolatePRGn: PRGn,
  interpolatePiYG: PiYG,
  interpolatePlasma: plasma,
  interpolatePuBu: PuBu,
  interpolatePuBuGn: PuBuGn,
  interpolatePuOr: PuOr,
  interpolatePuRd: PuRd,
  interpolatePurples: Purples,
  interpolateRainbow: rainbow,
  interpolateRdBu: RdBu,
  interpolateRdGy: RdGy,
  interpolateRdPu: RdPu,
  interpolateRdYlBu: RdYlBu,
  interpolateRdYlGn: RdYlGn,
  interpolateReds: Reds,
  interpolateRgb: interpolateRgb,
  interpolateRgbBasis: rgbBasis,
  interpolateRgbBasisClosed: rgbBasisClosed,
  interpolateRound: interpolateRound,
  interpolateSinebow: sinebow,
  interpolateSpectral: Spectral,
  interpolateString: interpolateString,
  interpolateTransformCss: interpolateTransformCss,
  interpolateTransformSvg: interpolateTransformSvg,
  interpolateTurbo: turbo,
  interpolateViridis: viridis,
  interpolateWarm: warm,
  interpolateYlGn: YlGn,
  interpolateYlGnBu: YlGnBu,
  interpolateYlOrBr: YlOrBr,
  interpolateYlOrRd: YlOrRd,
  interpolateZoom: interpolateZoom,
  interrupt: interrupt,
  intersection: intersection,
  interval: interval,
  isoFormat: formatIso$1,
  isoParse: parseIso$1,
  json: json,
  lab: lab$1,
  lch: lch,
  least: least,
  leastIndex: leastIndex,
  line: line,
  lineRadial: lineRadial$1,
  link: link,
  linkHorizontal: linkHorizontal,
  linkRadial: linkRadial,
  linkVertical: linkVertical,
  local: local$1,
  map: map$1,
  matcher: matcher,
  max: max$3,
  maxIndex: maxIndex,
  mean: mean,
  median: median,
  medianIndex: medianIndex,
  merge: merge,
  min: min$2,
  minIndex: minIndex,
  mode: mode,
  namespace: namespace,
  namespaces: namespaces,
  nice: nice$1,
  now: now,
  pack: index$3,
  packEnclose: enclose,
  packSiblings: siblings,
  pairs: pairs,
  partition: partition,
  path: path,
  pathRound: pathRound,
  permute: permute,
  pie: pie,
  piecewise: piecewise,
  pointRadial: pointRadial,
  pointer: pointer,
  pointers: pointers,
  polygonArea: area$1,
  polygonCentroid: centroid,
  polygonContains: contains,
  polygonHull: hull,
  polygonLength: length,
  precisionFixed: precisionFixed,
  precisionPrefix: precisionPrefix,
  precisionRound: precisionRound,
  quadtree: quadtree,
  quantile: quantile$1,
  quantileIndex: quantileIndex,
  quantileSorted: quantileSorted,
  quantize: quantize$1,
  quickselect: quickselect,
  radialArea: areaRadial,
  radialLine: lineRadial$1,
  randomBates: bates,
  randomBernoulli: bernoulli,
  randomBeta: beta,
  randomBinomial: binomial,
  randomCauchy: cauchy,
  randomExponential: exponential,
  randomGamma: gamma,
  randomGeometric: geometric,
  randomInt: int,
  randomIrwinHall: irwinHall,
  randomLcg: lcg,
  randomLogNormal: logNormal,
  randomLogistic: logistic,
  randomNormal: normal,
  randomPareto: pareto,
  randomPoisson: poisson,
  randomUniform: uniform,
  randomWeibull: weibull,
  range: range$2,
  rank: rank,
  reduce: reduce,
  reverse: reverse$1,
  rgb: rgb,
  ribbon: ribbon$1,
  ribbonArrow: ribbonArrow,
  rollup: rollup,
  rollups: rollups,
  scaleBand: band,
  scaleDiverging: diverging$1,
  scaleDivergingLog: divergingLog,
  scaleDivergingPow: divergingPow,
  scaleDivergingSqrt: divergingSqrt,
  scaleDivergingSymlog: divergingSymlog,
  scaleIdentity: identity$2,
  scaleImplicit: implicit,
  scaleLinear: linear,
  scaleLog: log,
  scaleOrdinal: ordinal,
  scalePoint: point$4,
  scalePow: pow,
  scaleQuantile: quantile,
  scaleQuantize: quantize,
  scaleRadial: radial,
  scaleSequential: sequential,
  scaleSequentialLog: sequentialLog,
  scaleSequentialPow: sequentialPow,
  scaleSequentialQuantile: sequentialQuantile,
  scaleSequentialSqrt: sequentialSqrt,
  scaleSequentialSymlog: sequentialSymlog,
  scaleSqrt: sqrt$1,
  scaleSymlog: symlog,
  scaleThreshold: threshold,
  scaleTime: time,
  scaleUtc: utcTime,
  scan: scan,
  schemeAccent: Accent,
  schemeBlues: scheme$5,
  schemeBrBG: scheme$q,
  schemeBuGn: scheme$h,
  schemeBuPu: scheme$g,
  schemeCategory10: category10,
  schemeDark2: Dark2,
  schemeGnBu: scheme$f,
  schemeGreens: scheme$4,
  schemeGreys: scheme$3,
  schemeObservable10: observable10,
  schemeOrRd: scheme$e,
  schemeOranges: scheme,
  schemePRGn: scheme$p,
  schemePaired: Paired,
  schemePastel1: Pastel1,
  schemePastel2: Pastel2,
  schemePiYG: scheme$o,
  schemePuBu: scheme$c,
  schemePuBuGn: scheme$d,
  schemePuOr: scheme$n,
  schemePuRd: scheme$b,
  schemePurples: scheme$2,
  schemeRdBu: scheme$m,
  schemeRdGy: scheme$l,
  schemeRdPu: scheme$a,
  schemeRdYlBu: scheme$k,
  schemeRdYlGn: scheme$j,
  schemeReds: scheme$1,
  schemeSet1: Set1,
  schemeSet2: Set2,
  schemeSet3: Set3,
  schemeSpectral: scheme$i,
  schemeTableau10: Tableau10,
  schemeYlGn: scheme$8,
  schemeYlGnBu: scheme$9,
  schemeYlOrBr: scheme$7,
  schemeYlOrRd: scheme$6,
  select: select,
  selectAll: selectAll,
  selection: selection,
  selector: selector,
  selectorAll: selectorAll,
  shuffle: shuffle$1,
  shuffler: shuffler,
  some: some,
  sort: sort,
  stack: stack,
  stackOffsetDiverging: diverging,
  stackOffsetExpand: expand,
  stackOffsetNone: none$1,
  stackOffsetSilhouette: silhouette,
  stackOffsetWiggle: wiggle,
  stackOrderAppearance: appearance,
  stackOrderAscending: ascending,
  stackOrderDescending: descending,
  stackOrderInsideOut: insideOut,
  stackOrderNone: none,
  stackOrderReverse: reverse,
  stratify: stratify,
  style: styleValue,
  subset: subset,
  sum: sum$2,
  superset: superset,
  svg: svg,
  symbol: Symbol$1,
  symbolAsterisk: asterisk,
  symbolCircle: circle,
  symbolCross: cross,
  symbolDiamond: diamond,
  symbolDiamond2: diamond2,
  symbolPlus: plus,
  symbolSquare: square,
  symbolSquare2: square2,
  symbolStar: star,
  symbolTimes: times,
  symbolTriangle: triangle,
  symbolTriangle2: triangle2,
  symbolWye: wye,
  symbolX: times,
  symbols: symbolsFill,
  symbolsFill: symbolsFill,
  symbolsStroke: symbolsStroke,
  text: text,
  thresholdFreedmanDiaconis: thresholdFreedmanDiaconis,
  thresholdScott: thresholdScott,
  thresholdSturges: thresholdSturges,
  tickFormat: tickFormat,
  tickIncrement: tickIncrement,
  tickStep: tickStep,
  ticks: ticks,
  timeDay: timeDay,
  timeDays: timeDays,
  get timeFormat () { return timeFormat; },
  timeFormatDefaultLocale: defaultLocale,
  timeFormatLocale: formatLocale,
  timeFriday: timeFriday,
  timeFridays: timeFridays,
  timeHour: timeHour,
  timeHours: timeHours,
  timeInterval: timeInterval,
  timeMillisecond: millisecond,
  timeMilliseconds: milliseconds,
  timeMinute: timeMinute,
  timeMinutes: timeMinutes,
  timeMonday: timeMonday,
  timeMondays: timeMondays,
  timeMonth: timeMonth,
  timeMonths: timeMonths,
  get timeParse () { return timeParse; },
  timeSaturday: timeSaturday,
  timeSaturdays: timeSaturdays,
  timeSecond: second,
  timeSeconds: seconds,
  timeSunday: timeSunday,
  timeSundays: timeSundays,
  timeThursday: timeThursday,
  timeThursdays: timeThursdays,
  timeTickInterval: timeTickInterval,
  timeTicks: timeTicks,
  timeTuesday: timeTuesday,
  timeTuesdays: timeTuesdays,
  timeWednesday: timeWednesday,
  timeWednesdays: timeWednesdays,
  timeWeek: timeSunday,
  timeWeeks: timeSundays,
  timeYear: timeYear,
  timeYears: timeYears,
  timeout: timeout,
  timer: timer,
  timerFlush: timerFlush,
  transition: transition,
  transpose: transpose,
  tree: tree,
  treemap: index$2,
  treemapBinary: binary,
  treemapDice: treemapDice,
  treemapResquarify: resquarify,
  treemapSlice: treemapSlice,
  treemapSliceDice: sliceDice,
  treemapSquarify: squarify,
  tsv: tsv,
  tsvFormat: tsvFormat,
  tsvFormatBody: tsvFormatBody,
  tsvFormatRow: tsvFormatRow,
  tsvFormatRows: tsvFormatRows,
  tsvFormatValue: tsvFormatValue,
  tsvParse: tsvParse,
  tsvParseRows: tsvParseRows,
  union: union,
  unixDay: unixDay,
  unixDays: unixDays,
  utcDay: utcDay,
  utcDays: utcDays,
  get utcFormat () { return utcFormat; },
  utcFriday: utcFriday,
  utcFridays: utcFridays,
  utcHour: utcHour,
  utcHours: utcHours,
  utcMillisecond: millisecond,
  utcMilliseconds: milliseconds,
  utcMinute: utcMinute,
  utcMinutes: utcMinutes,
  utcMonday: utcMonday,
  utcMondays: utcMondays,
  utcMonth: utcMonth,
  utcMonths: utcMonths,
  get utcParse () { return utcParse; },
  utcSaturday: utcSaturday,
  utcSaturdays: utcSaturdays,
  utcSecond: second,
  utcSeconds: seconds,
  utcSunday: utcSunday,
  utcSundays: utcSundays,
  utcThursday: utcThursday,
  utcThursdays: utcThursdays,
  utcTickInterval: utcTickInterval,
  utcTicks: utcTicks,
  utcTuesday: utcTuesday,
  utcTuesdays: utcTuesdays,
  utcWednesday: utcWednesday,
  utcWednesdays: utcWednesdays,
  utcWeek: utcSunday,
  utcWeeks: utcSundays,
  utcYear: utcYear,
  utcYears: utcYears,
  variance: variance,
  window: defaultView,
  xml: xml,
  zip: zip,
  zoom: zoom,
  zoomIdentity: identity,
  zoomTransform: transform
});

function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);

    if (enumerableOnly) {
      symbols = symbols.filter(function (sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      });
    }

    keys.push.apply(keys, symbols);
  }

  return keys;
}

function _objectSpread2(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};

    if (i % 2) {
      ownKeys(Object(source), true).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }

  return target;
}

function _typeof(obj) {
  "@babel/helpers - typeof";

  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    _typeof = function (obj) {
      return typeof obj;
    };
  } else {
    _typeof = function (obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };
  }

  return _typeof(obj);
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

function _extends() {
  _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

function _unsupportedIterableToArray(o, minLen) {
  if (!o) return;
  if (typeof o === "string") return _arrayLikeToArray(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor) n = o.constructor.name;
  if (n === "Map" || n === "Set") return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}

function _arrayLikeToArray(arr, len) {
  if (len == null || len > arr.length) len = arr.length;

  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];

  return arr2;
}

function _createForOfIteratorHelper(o, allowArrayLike) {
  var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"];

  if (!it) {
    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {
      if (it) o = it;
      var i = 0;

      var F = function () {};

      return {
        s: F,
        n: function () {
          if (i >= o.length) return {
            done: true
          };
          return {
            done: false,
            value: o[i++]
          };
        },
        e: function (e) {
          throw e;
        },
        f: F
      };
    }

    throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  var normalCompletion = true,
      didErr = false,
      err;
  return {
    s: function () {
      it = it.call(o);
    },
    n: function () {
      var step = it.next();
      normalCompletion = step.done;
      return step;
    },
    e: function (e) {
      didErr = true;
      err = e;
    },
    f: function () {
      try {
        if (!normalCompletion && it.return != null) it.return();
      } finally {
        if (didErr) throw err;
      }
    }
  };
}

/**
 * de Casteljau's algorithm for drawing and splitting bezier curves.
 * Inspired by https://pomax.github.io/bezierinfo/
 *
 * @param {Number[][]} points Array of [x,y] points: [start, control1, control2, ..., end]
 *   The original segment to split.
 * @param {Number} t Where to split the curve (value between [0, 1])
 * @return {Object} An object { left, right } where left is the segment from 0..t and
 *   right is the segment from t..1.
 */
function decasteljau(points, t) {
  var left = [];
  var right = [];

  function decasteljauRecurse(points, t) {
    if (points.length === 1) {
      left.push(points[0]);
      right.push(points[0]);
    } else {
      var newPoints = Array(points.length - 1);

      for (var i = 0; i < newPoints.length; i++) {
        if (i === 0) {
          left.push(points[0]);
        }

        if (i === newPoints.length - 1) {
          right.push(points[i + 1]);
        }

        newPoints[i] = [(1 - t) * points[i][0] + t * points[i + 1][0], (1 - t) * points[i][1] + t * points[i + 1][1]];
      }

      decasteljauRecurse(newPoints, t);
    }
  }

  if (points.length) {
    decasteljauRecurse(points, t);
  }

  return {
    left: left,
    right: right.reverse()
  };
}
/**
 * Convert segments represented as points back into a command object
 *
 * @param {Number[][]} points Array of [x,y] points: [start, control1, control2, ..., end]
 *   Represents a segment
 * @return {Object} A command object representing the segment.
 */


function pointsToCommand(points) {
  var command = {};

  if (points.length === 4) {
    command.x2 = points[2][0];
    command.y2 = points[2][1];
  }

  if (points.length >= 3) {
    command.x1 = points[1][0];
    command.y1 = points[1][1];
  }

  command.x = points[points.length - 1][0];
  command.y = points[points.length - 1][1];

  if (points.length === 4) {
    // start, control1, control2, end
    command.type = 'C';
  } else if (points.length === 3) {
    // start, control, end
    command.type = 'Q';
  } else {
    // start, end
    command.type = 'L';
  }

  return command;
}
/**
 * Runs de Casteljau's algorithm enough times to produce the desired number of segments.
 *
 * @param {Number[][]} points Array of [x,y] points for de Casteljau (the initial segment to split)
 * @param {Number} segmentCount Number of segments to split the original into
 * @return {Number[][][]} Array of segments
 */


function splitCurveAsPoints(points, segmentCount) {
  segmentCount = segmentCount || 2;
  var segments = [];
  var remainingCurve = points;
  var tIncrement = 1 / segmentCount; // x-----x-----x-----x
  // t=  0.33   0.66   1
  // x-----o-----------x
  // r=  0.33
  //       x-----o-----x
  // r=         0.5  (0.33 / (1 - 0.33))  === tIncrement / (1 - (tIncrement * (i - 1))
  // x-----x-----x-----x----x
  // t=  0.25   0.5   0.75  1
  // x-----o----------------x
  // r=  0.25
  //       x-----o----------x
  // r=         0.33  (0.25 / (1 - 0.25))
  //             x-----o----x
  // r=         0.5  (0.25 / (1 - 0.5))

  for (var i = 0; i < segmentCount - 1; i++) {
    var tRelative = tIncrement / (1 - tIncrement * i);
    var split = decasteljau(remainingCurve, tRelative);
    segments.push(split.left);
    remainingCurve = split.right;
  } // last segment is just to the end from the last point


  segments.push(remainingCurve);
  return segments;
}
/**
 * Convert command objects to arrays of points, run de Casteljau's algorithm on it
 * to split into to the desired number of segments.
 *
 * @param {Object} commandStart The start command object
 * @param {Object} commandEnd The end command object
 * @param {Number} segmentCount The number of segments to create
 * @return {Object[]} An array of commands representing the segments in sequence
 */


function splitCurve(commandStart, commandEnd, segmentCount) {
  var points = [[commandStart.x, commandStart.y]];

  if (commandEnd.x1 != null) {
    points.push([commandEnd.x1, commandEnd.y1]);
  }

  if (commandEnd.x2 != null) {
    points.push([commandEnd.x2, commandEnd.y2]);
  }

  points.push([commandEnd.x, commandEnd.y]);
  return splitCurveAsPoints(points, segmentCount).map(pointsToCommand);
}

var commandTokenRegex = /[MLCSTQAHVZmlcstqahv]|-?[\d.e+-]+/g;
/**
 * List of params for each command type in a path `d` attribute
 */

var typeMap = {
  M: ['x', 'y'],
  L: ['x', 'y'],
  H: ['x'],
  V: ['y'],
  C: ['x1', 'y1', 'x2', 'y2', 'x', 'y'],
  S: ['x2', 'y2', 'x', 'y'],
  Q: ['x1', 'y1', 'x', 'y'],
  T: ['x', 'y'],
  A: ['rx', 'ry', 'xAxisRotation', 'largeArcFlag', 'sweepFlag', 'x', 'y'],
  Z: []
}; // Add lower case entries too matching uppercase (e.g. 'm' == 'M')

Object.keys(typeMap).forEach(function (key) {
  typeMap[key.toLowerCase()] = typeMap[key];
});

function arrayOfLength(length, value) {
  var array = Array(length);

  for (var i = 0; i < length; i++) {
    array[i] = value;
  }

  return array;
}
/**
 * Converts a command object to a string to be used in a `d` attribute
 * @param {Object} command A command object
 * @return {String} The string for the `d` attribute
 */


function commandToString(command) {
  return "".concat(command.type).concat(typeMap[command.type].map(function (p) {
    return command[p];
  }).join(','));
}
/**
 * Converts command A to have the same type as command B.
 *
 * e.g., L0,5 -> C0,5,0,5,0,5
 *
 * Uses these rules:
 * x1 <- x
 * x2 <- x
 * y1 <- y
 * y2 <- y
 * rx <- 0
 * ry <- 0
 * xAxisRotation <- read from B
 * largeArcFlag <- read from B
 * sweepflag <- read from B
 *
 * @param {Object} aCommand Command object from path `d` attribute
 * @param {Object} bCommand Command object from path `d` attribute to match against
 * @return {Object} aCommand converted to type of bCommand
 */


function convertToSameType(aCommand, bCommand) {
  var conversionMap = {
    x1: 'x',
    y1: 'y',
    x2: 'x',
    y2: 'y'
  };
  var readFromBKeys = ['xAxisRotation', 'largeArcFlag', 'sweepFlag']; // convert (but ignore M types)

  if (aCommand.type !== bCommand.type && bCommand.type.toUpperCase() !== 'M') {
    var aConverted = {};
    Object.keys(bCommand).forEach(function (bKey) {
      var bValue = bCommand[bKey]; // first read from the A command

      var aValue = aCommand[bKey]; // if it is one of these values, read from B no matter what

      if (aValue === undefined) {
        if (readFromBKeys.includes(bKey)) {
          aValue = bValue;
        } else {
          // if it wasn't in the A command, see if an equivalent was
          if (aValue === undefined && conversionMap[bKey]) {
            aValue = aCommand[conversionMap[bKey]];
          } // if it doesn't have a converted value, use 0


          if (aValue === undefined) {
            aValue = 0;
          }
        }
      }

      aConverted[bKey] = aValue;
    }); // update the type to match B

    aConverted.type = bCommand.type;
    aCommand = aConverted;
  }

  return aCommand;
}
/**
 * Interpolate between command objects commandStart and commandEnd segmentCount times.
 * If the types are L, Q, or C then the curves are split as per de Casteljau's algorithm.
 * Otherwise we just copy commandStart segmentCount - 1 times, finally ending with commandEnd.
 *
 * @param {Object} commandStart Command object at the beginning of the segment
 * @param {Object} commandEnd Command object at the end of the segment
 * @param {Number} segmentCount The number of segments to split this into. If only 1
 *   Then [commandEnd] is returned.
 * @return {Object[]} Array of ~segmentCount command objects between commandStart and
 *   commandEnd. (Can be segmentCount+1 objects if commandStart is type M).
 */


function splitSegment(commandStart, commandEnd, segmentCount) {
  var segments = []; // line, quadratic bezier, or cubic bezier

  if (commandEnd.type === 'L' || commandEnd.type === 'Q' || commandEnd.type === 'C') {
    segments = segments.concat(splitCurve(commandStart, commandEnd, segmentCount)); // general case - just copy the same point
  } else {
    var copyCommand = _extends({}, commandStart); // convert M to L


    if (copyCommand.type === 'M') {
      copyCommand.type = 'L';
    }

    segments = segments.concat(arrayOfLength(segmentCount - 1).map(function () {
      return copyCommand;
    }));
    segments.push(commandEnd);
  }

  return segments;
}
/**
 * Extends an array of commandsToExtend to the length of the referenceCommands by
 * splitting segments until the number of commands match. Ensures all the actual
 * points of commandsToExtend are in the extended array.
 *
 * @param {Object[]} commandsToExtend The command object array to extend
 * @param {Object[]} referenceCommands The command object array to match in length
 * @param {Function} excludeSegment a function that takes a start command object and
 *   end command object and returns true if the segment should be excluded from splitting.
 * @return {Object[]} The extended commandsToExtend array
 */


function extend(commandsToExtend, referenceCommands, excludeSegment) {
  // compute insertion points:
  // number of segments in the path to extend
  var numSegmentsToExtend = commandsToExtend.length - 1; // number of segments in the reference path.

  var numReferenceSegments = referenceCommands.length - 1; // this value is always between [0, 1].

  var segmentRatio = numSegmentsToExtend / numReferenceSegments; // create a map, mapping segments in referenceCommands to how many points
  // should be added in that segment (should always be >= 1 since we need each
  // point itself).
  // 0 = segment 0-1, 1 = segment 1-2, n-1 = last vertex

  var countPointsPerSegment = arrayOfLength(numReferenceSegments).reduce(function (accum, d, i) {
    var insertIndex = Math.floor(segmentRatio * i); // handle excluding segments

    if (excludeSegment && insertIndex < commandsToExtend.length - 1 && excludeSegment(commandsToExtend[insertIndex], commandsToExtend[insertIndex + 1])) {
      // set the insertIndex to the segment that this point should be added to:
      // round the insertIndex essentially so we split half and half on
      // neighbouring segments. hence the segmentRatio * i < 0.5
      var addToPriorSegment = segmentRatio * i % 1 < 0.5; // only skip segment if we already have 1 point in it (can't entirely remove a segment)

      if (accum[insertIndex]) {
        // TODO - Note this is a naive algorithm that should work for most d3-area use cases
        // but if two adjacent segments are supposed to be skipped, this will not perform as
        // expected. Could be updated to search for nearest segment to place the point in, but
        // will only do that if necessary.
        // add to the prior segment
        if (addToPriorSegment) {
          if (insertIndex > 0) {
            insertIndex -= 1; // not possible to add to previous so adding to next
          } else if (insertIndex < commandsToExtend.length - 1) {
            insertIndex += 1;
          } // add to next segment

        } else if (insertIndex < commandsToExtend.length - 1) {
          insertIndex += 1; // not possible to add to next so adding to previous
        } else if (insertIndex > 0) {
          insertIndex -= 1;
        }
      }
    }

    accum[insertIndex] = (accum[insertIndex] || 0) + 1;
    return accum;
  }, []); // extend each segment to have the correct number of points for a smooth interpolation

  var extended = countPointsPerSegment.reduce(function (extended, segmentCount, i) {
    // if last command, just add `segmentCount` number of times
    if (i === commandsToExtend.length - 1) {
      var lastCommandCopies = arrayOfLength(segmentCount, _extends({}, commandsToExtend[commandsToExtend.length - 1])); // convert M to L

      if (lastCommandCopies[0].type === 'M') {
        lastCommandCopies.forEach(function (d) {
          d.type = 'L';
        });
      }

      return extended.concat(lastCommandCopies);
    } // otherwise, split the segment segmentCount times.


    return extended.concat(splitSegment(commandsToExtend[i], commandsToExtend[i + 1], segmentCount));
  }, []); // add in the very first point since splitSegment only adds in the ones after it

  extended.unshift(commandsToExtend[0]);
  return extended;
}
/**
 * Takes a path `d` string and converts it into an array of command
 * objects. Drops the `Z` character.
 *
 * @param {String|null} d A path `d` string
 */


function pathCommandsFromString(d) {
  // split into valid tokens
  var tokens = (d || '').match(commandTokenRegex) || [];
  var commands = [];
  var commandArgs;
  var command; // iterate over each token, checking if we are at a new command
  // by presence in the typeMap

  for (var i = 0; i < tokens.length; ++i) {
    commandArgs = typeMap[tokens[i]]; // new command found:

    if (commandArgs) {
      command = {
        type: tokens[i]
      }; // add each of the expected args for this command:

      for (var a = 0; a < commandArgs.length; ++a) {
        command[commandArgs[a]] = +tokens[i + a + 1];
      } // need to increment our token index appropriately since
      // we consumed token args


      i += commandArgs.length;
      commands.push(command);
    }
  }

  return commands;
}
/**
 * Interpolate from A to B by extending A and B during interpolation to have
 * the same number of points. This allows for a smooth transition when they
 * have a different number of points.
 *
 * Ignores the `Z` command in paths unless both A and B end with it.
 *
 * This function works directly with arrays of command objects instead of with
 * path `d` strings (see interpolatePath for working with `d` strings).
 *
 * @param {Object[]} aCommandsInput Array of path commands
 * @param {Object[]} bCommandsInput Array of path commands
 * @param {(Function|Object)} interpolateOptions
 * @param {Function} interpolateOptions.excludeSegment a function that takes a start command object and
 *   end command object and returns true if the segment should be excluded from splitting.
 * @param {Boolean} interpolateOptions.snapEndsToInput a boolean indicating whether end of input should
 *   be sourced from input argument or computed.
 * @returns {Function} Interpolation function that maps t ([0, 1]) to an array of path commands.
 */

function interpolatePathCommands(aCommandsInput, bCommandsInput, interpolateOptions) {
  // make a copy so we don't mess with the input arrays
  var aCommands = aCommandsInput == null ? [] : aCommandsInput.slice();
  var bCommands = bCommandsInput == null ? [] : bCommandsInput.slice();

  var _ref = _typeof(interpolateOptions) === 'object' ? interpolateOptions : {
    excludeSegment: interpolateOptions,
    snapEndsToInput: true
  },
      excludeSegment = _ref.excludeSegment,
      snapEndsToInput = _ref.snapEndsToInput; // both input sets are empty, so we don't interpolate


  if (!aCommands.length && !bCommands.length) {
    return function nullInterpolator() {
      return [];
    };
  } // do we add Z during interpolation? yes if both have it. (we'd expect both to have it or not)


  var addZ = (aCommands.length === 0 || aCommands[aCommands.length - 1].type === 'Z') && (bCommands.length === 0 || bCommands[bCommands.length - 1].type === 'Z'); // we temporarily remove Z

  if (aCommands.length > 0 && aCommands[aCommands.length - 1].type === 'Z') {
    aCommands.pop();
  }

  if (bCommands.length > 0 && bCommands[bCommands.length - 1].type === 'Z') {
    bCommands.pop();
  } // if A is empty, treat it as if it used to contain just the first point
  // of B. This makes it so the line extends out of from that first point.


  if (!aCommands.length) {
    aCommands.push(bCommands[0]); // otherwise if B is empty, treat it as if it contains the first point
    // of A. This makes it so the line retracts into the first point.
  } else if (!bCommands.length) {
    bCommands.push(aCommands[0]);
  } // extend to match equal size


  var numPointsToExtend = Math.abs(bCommands.length - aCommands.length);

  if (numPointsToExtend !== 0) {
    // B has more points than A, so add points to A before interpolating
    if (bCommands.length > aCommands.length) {
      aCommands = extend(aCommands, bCommands, excludeSegment); // else if A has more points than B, add more points to B
    } else if (bCommands.length < aCommands.length) {
      bCommands = extend(bCommands, aCommands, excludeSegment);
    }
  } // commands have same length now.
  // convert commands in A to the same type as those in B


  aCommands = aCommands.map(function (aCommand, i) {
    return convertToSameType(aCommand, bCommands[i]);
  }); // create mutable interpolated command objects

  var interpolatedCommands = aCommands.map(function (aCommand) {
    return _objectSpread2({}, aCommand);
  });

  if (addZ) {
    interpolatedCommands.push({
      type: 'Z'
    });
    aCommands.push({
      type: 'Z'
    }); // required for when returning at t == 0
  }

  return function pathCommandInterpolator(t) {
    // at 1 return the final value without the extensions used during interpolation
    if (t === 1 && snapEndsToInput) {
      return bCommandsInput == null ? [] : bCommandsInput;
    } // work with aCommands directly since interpolatedCommands are mutated


    if (t === 0) {
      return aCommands;
    } // interpolate the commands using the mutable interpolated command objs


    for (var i = 0; i < interpolatedCommands.length; ++i) {
      // if (interpolatedCommands[i].type === 'Z') continue;
      var aCommand = aCommands[i];
      var bCommand = bCommands[i];
      var interpolatedCommand = interpolatedCommands[i];

      var _iterator = _createForOfIteratorHelper(typeMap[interpolatedCommand.type]),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var arg = _step.value;
          interpolatedCommand[arg] = (1 - t) * aCommand[arg] + t * bCommand[arg]; // do not use floats for flags (#27), round to integer

          if (arg === 'largeArcFlag' || arg === 'sweepFlag') {
            interpolatedCommand[arg] = Math.round(interpolatedCommand[arg]);
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }
    }

    return interpolatedCommands;
  };
}
/** @typedef InterpolateOptions  */

/**
 * Interpolate from A to B by extending A and B during interpolation to have
 * the same number of points. This allows for a smooth transition when they
 * have a different number of points.
 *
 * Ignores the `Z` character in paths unless both A and B end with it.
 *
 * @param {String} a The `d` attribute for a path
 * @param {String} b The `d` attribute for a path
 * @param {((command1, command2) => boolean|{
 *   excludeSegment?: (command1, command2) => boolean;
 *   snapEndsToInput?: boolean
 * })} interpolateOptions The excludeSegment function or an options object
 *    - interpolateOptions.excludeSegment a function that takes a start command object and
 *      end command object and returns true if the segment should be excluded from splitting.
 *    - interpolateOptions.snapEndsToInput a boolean indicating whether end of input should
 *      be sourced from input argument or computed.
 * @returns {Function} Interpolation function that maps t ([0, 1]) to a path `d` string.
 */

function interpolatePath(a, b, interpolateOptions) {
  var aCommands = pathCommandsFromString(a);
  var bCommands = pathCommandsFromString(b);

  var _ref2 = _typeof(interpolateOptions) === 'object' ? interpolateOptions : {
    excludeSegment: interpolateOptions,
    snapEndsToInput: true
  },
      excludeSegment = _ref2.excludeSegment,
      snapEndsToInput = _ref2.snapEndsToInput;

  if (!aCommands.length && !bCommands.length) {
    return function nullInterpolator() {
      return '';
    };
  }

  var commandInterpolator = interpolatePathCommands(aCommands, bCommands, {
    excludeSegment: excludeSegment,
    snapEndsToInput: snapEndsToInput
  });
  return function pathStringInterpolator(t) {
    // at 1 return the final value without the extensions used during interpolation
    if (t === 1 && snapEndsToInput) {
      return b == null ? '' : b;
    }

    var interpolatedCommands = commandInterpolator(t); // convert to a string (fastest concat: https://jsperf.com/join-concat/150)

    var interpolatedString = '';

    var _iterator2 = _createForOfIteratorHelper(interpolatedCommands),
        _step2;

    try {
      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
        var interpolatedCommand = _step2.value;
        interpolatedString += commandToString(interpolatedCommand);
      }
    } catch (err) {
      _iterator2.e(err);
    } finally {
      _iterator2.f();
    }

    return interpolatedString;
  };
}

var d3InterpolatePath = /*#__PURE__*/Object.freeze({
  __proto__: null,
  interpolatePath: interpolatePath,
  interpolatePathCommands: interpolatePathCommands,
  pathCommandsFromString: pathCommandsFromString
});

function iterate(attrs, path) {
  const keys = Object.keys(attrs), l = keys.length;
  for (let i = 0; i < l; i++){
    const key = keys[i];
    path.attr(key, attrs[key]);
  }
}

function draw(context, attrs, id, scale, refX, refY, d){
  let defs = context.select("defs");
  if (defs.empty()) {
    defs = context.append("defs");
  }

  const path = defs.append("marker")
      .attr("id", id)
      .attr("refX", refX * scale)
      .attr("refY", refY * scale)
      .attr("markerWidth", refX + 2 * scale)
      .attr("markerHeight", refY * 2 * scale)
      .attr("markerUnits", "userSpaceOnUse")
      .attr("orient", "auto-start-reverse")
    .append("path")
      .attr("d", d);

  iterate(attrs, path);
}

function arrow1() {
  let attrs = {
    fill: "black",
    stroke: "black"
  };
  let id = "d3-arrow-1";
  let scale = 1;
  
  function arrow(context){
    draw(
      context,
      attrs,
      id,
      scale,
      15,
      8,
      `M 1 1 Q ${7 * scale} ${5 * scale} ${16 * scale} ${8 * scale} Q ${7 * scale} ${11 * scale} 1 ${15 * scale} L ${4 * scale} ${8 * scale} Z`
    );
  }
  
  arrow.id = function(string){ return arguments.length ? (id = string, arrow) : id; };
  arrow.scale = function(number){ return arguments.length ? (scale = number, arrow) : scale; };
  arrow.attr = function(key, value){ return arguments.length === 2 ? (attrs[key] = value, arrow) : attrs[key]; };
  
  return arrow;
}

function arrow2() {
  let attrs = {
    fill: "black",
    stroke: "black"
  };
  let id = "d3-arrow-2";
  let scale = 1;
  
  function arrow(context){
    draw(
      context,
      attrs,
      id,
      scale,
      17,
      7.5,
      `M 1 1 L ${18 * scale} ${7.5 * scale} L 1 ${14 * scale} L ${5 * scale} ${7.5 * scale} z`
    );
  }
  
  arrow.id = function(string){ return arguments.length ? (id = string, arrow) : id; };
  arrow.scale = function(number){ return arguments.length ? (scale = number, arrow) : scale; };
  arrow.attr = function(key, value){ return arguments.length === 2 ? (attrs[key] = value, arrow) : attrs[key]; };
  
  return arrow;
}

function arrow3() {
  let attrs = {
    fill: "black",
    stroke: "black"
  };
  let id = "d3-arrow-3";
  let scale = 1;
  
  function arrow(context){
    draw(
      context,
      attrs,
      id,
      scale,
      21,
      7,
      `M 1 1 Q ${9 * scale} ${5 * scale} ${22 * scale} ${7 * scale} Q ${9 * scale} ${9 * scale} 1 ${13 * scale} L ${4 * scale} ${7 * scale} Z`
    );
  }
  
  arrow.id = function(string){ return arguments.length ? (id = string, arrow) : id; };
  arrow.scale = function(number){ return arguments.length ? (scale = number, arrow) : scale; };
  arrow.attr = function(key, value){ return arguments.length === 2 ? (attrs[key] = value, arrow) : attrs[key]; };
  
  return arrow;
}

function arrow5() {
  let attrs = {
    fill: "black",
    stroke: "black"
  };
  let id = "d3-arrow-5";
  let scale = 1;
  
  function arrow(context){
    draw(
      context,
      attrs,
      id,
      scale,
      14,
      7,
      `M 1 1 L ${15 * scale} ${7 * scale} L 1 ${13 * scale} L ${3 * scale} ${7 * scale} z`
    );
  }
  
  arrow.id = function(string){ return arguments.length ? (id = string, arrow) : id; };
  arrow.scale = function(number){ return arguments.length ? (scale = number, arrow) : scale; };
  arrow.attr = function(key, value){ return arguments.length === 2 ? (attrs[key] = value, arrow) : attrs[key]; };
  
  return arrow;
}

function arrow10(){
  let attrs = {
    fill: "none",
    stroke: "black",
    "stroke-width": 1
  };
  let id = "d3-arrow-10";
  let scale = 1;
  
  function arrow(context){
    draw(
      context,
      attrs,
      id,
      scale,
      5,
      4.5,
      `M 1 1 L ${5 * scale } ${4.5 * scale} L 1 ${8 * scale}`
    );
  }
  
  arrow.id = function(string){ return arguments.length ? (id = string, arrow) : id; };
  arrow.scale = function(number){ return arguments.length ? (scale = number, arrow) : scale; };
  arrow.attr = function(key, value){ return arguments.length === 2 ? (attrs[key] = value, arrow) : attrs[key]; };
  
  return arrow;
}

function arrow11() {
  let attrs = {
    fill: "none",
    stroke: "black",
    "stroke-width": 1
  };
  let id = "d3-arrow-11";
  let scale = 1;
  
  function arrow(context){
    draw(
      context,
      attrs,
      id,
      scale,
      8,
      8,
      `M 1 1 L ${8 * scale} ${8 * scale} L 1 ${15 * scale}`
    );
  }
  
  arrow.id = function(string){ return arguments.length ? (id = string, arrow) : id; };
  arrow.scale = function(number){ return arguments.length ? (scale = number, arrow) : scale; };
  arrow.attr = function(key, value){ return arguments.length === 2 ? (attrs[key] = value, arrow) : attrs[key]; };
  
  return arrow;
}

function arrow13() {
  let attrs = {
    fill: "none",
    stroke: "black",
    "stroke-width": 1
  };
  let id = "d3-arrow-13";
  let scale = 1;
  
  function arrow(context){
    draw(
      context,
      attrs,
      id,
      scale,
      13,
      10,
      `M 1 1 L ${13 * scale} ${10 * scale} L 1 ${19 * scale}`
    );
  }
  
  arrow.id = function(string){ return arguments.length ? (id = string, arrow) : id; };
  arrow.scale = function(number){ return arguments.length ? (scale = number, arrow) : scale; };
  arrow.attr = function(key, value){ return arguments.length === 2 ? (attrs[key] = value, arrow) : attrs[key]; };
  
  return arrow;
}

var index = /*#__PURE__*/Object.freeze({
  __proto__: null,
  arrow1: arrow1,
  arrow10: arrow10,
  arrow11: arrow11,
  arrow13: arrow13,
  arrow2: arrow2,
  arrow3: arrow3,
  arrow5: arrow5
});</script>
<script type="module">class HTMLCell {
    dispose() {
      
    }
    
    constructor(parent, data) {
      setInnerHTML(parent.element, data);
      parent.element.classList.add('margin-bottom-fix');
      return this;
    }
  }
  

  const codemirror = window.SupportedCells['codemirror'].context;

  window.SupportedLanguages.push({
    check: (r) => {return(r[0].match(/\w*\.(html)$/) != null)},
    plugins: [codemirror.html()],
    name: codemirror.htmlLanguage.name
  });

  window.SupportedCells['html'] = {
    view: HTMLCell
  };



  core.HTMLForm = async function (args, env) {
    let options = {};
    options.Method = "innerHTML"; 
    if (args.length > 1) options = core._getRules(args, env);
    env.local.Method = options.Method;
    console.log('options');
    console.log(options);

    const data = await interpretate(args[0], env);

    switch(options.Method) {
        case "Full":
            setInnerHTML(env.element, data);
        break;

        case "innerHTML":
            env.element.innerHTML = data;
        break;

        case "innerText":
            env.element.innerText = data;
        break;
    }    

    
}



core.HTMLForm.update = async (args, env) => {
    console.log('HTMLFrom update');
    console.log(env);
    const method = env.local.Method;

    const data = await interpretate(args[0], env);

    switch(method) {
        case "Full":
            setInnerHTML(env.element, data);
        break;

        case "innerHTML":
            env.element.innerHTML = data;
        break;

        case "innerText":
            env.element.innerText = data;
        break;
    }    
}

core.HTMLForm.destroy = (args, env) => {/* just go to the inner three */ interpretate(args[0], env)}

core.TextForm = async function (args, env) {
    const data = await interpretate(args[0], env);
    env.element.innerText = data;
}

core.TextForm.update = async (args, env) => {
    const data = await interpretate(args[0], env);
    env.element.innerText = data;   
}

core.TextForm.destroy = (args, env) => {/* just go to the inner three */ interpretate(args[0], env)}</script>
<script type="module">function __isElement(element) {
    return element instanceof Element || element instanceof HTMLDocument;  
  }

const codemirror = window.SupportedCells['codemirror'].context;  
  
class ScopedEval {
  ondestroy = function() {}
  after = function() {}
  error  = false
    
  constructor(scope, script, asyncQ = false) {
    if (asyncQ) {
      this.script = '(async (g0this) => {'+ script + '})(this)';
      this.asyncQ = new Deferred();
      const copy = this.asyncQ;
      this.return = (object) => copy.resolve(object);
    } else {
      this.script = '(() => {'+ script + '})()';
    }

    return this;
  }
    
  eval() {
    const self = this;
    //console.warn(self);

    try {

      if (self.asyncQ) {
        eval(self.script);
        
        return self.asyncQ.promise;
      }

      return eval(self.script);
    } catch(err) {
      self.error = err;
      if (self.asyncQ) {
        self.asyncQ.resolve();
        return self.asyncQ.promise;
      }
    }
  }
} 

class JSCell {
    scope = {}
    createScopedEval = (scope, script) => {return({
      ondestroy: function() {},
      after: function() {},
      result: Function(`${script}`)
    })}  
    
    dispose() {
      this.scope.ondestroy();
    }
    
    constructor(parent, data) {
      this.origin = parent;
      this.scope = new ScopedEval({}, data)
      
      const result = this.scope.eval();

      if (this.scope.error) {
        const errorDiv = document.createElement('div');
        errorDiv.innerText = this.scope.error;
        errorDiv.classList.add('err-js');
        this.origin.element.appendChild(errorDiv);
        return this;
      }

      if (__isElement(result)) {
        this.origin.element.appendChild(result);
        this.scope.after(result);
        return this;
      }
      
      const outputDom = document.createElement('div');
      outputDom.innerText = String(result);
      outputDom.classList.add('text-sm');

      this.origin.element.appendChild(outputDom);
      this.scope.after(outputDom);
      
      return this;
    }
  }
  
  window.SupportedLanguages.push({
    check: (r) => {return(r[0].match(/\w*\.(js|esm)$/) != null)},
    plugins: [codemirror.javascript()],
    name: codemirror.javascriptLanguage.name
  });

  window.SupportedCells['js'] = {
    view: JSCell
  };

  class ESMCell {
    scope = {}
    createScopedEval = (scope, script) => {return({
      ondestroy: function() {},
      after: function() {},
      result: Function(`${script}`)
    })}  
    
    dispose() {
      this.scope.ondestroy();
    }
    
    constructor(parent, data) {
      this.origin = parent;
      this.scope = new ScopedEval({}, data, true);

      const self = this;
      
      this.scope.eval().then((result) => {
        if (self.scope.error) {
          const errorDiv = document.createElement('div');
          errorDiv.innerText = self.scope.error;
          errorDiv.classList.add('err-js');
          self.origin.element.appendChild(errorDiv);
          return;
        }

        if (__isElement(result)) {
          self.origin.element.appendChild(result);
          self.scope.after(result);
          return;
        }

        const outputDom = document.createElement('div');
        outputDom.innerText = String(result);
        outputDom.classList.add('text-sm');
  
        self.origin.element.appendChild(outputDom);
        self.scope.after(outputDom);        
      });

      return this;
    }
  }  
    
  window.SupportedCells['esm'] = {
    view: ESMCell
  };</script>
<script type="module">
let Marked;
let Renderer;

await window.interpretate.shared.Marked.load();
Marked = window.interpretate.shared.Marked.default;
Renderer = window.interpretate.shared.Marked.Renderer;

const renderer = new Renderer();
const linkRenderer = renderer.link;
renderer.link = (href, title, text) => {
  const localLink = href.startsWith(`${location.protocol}//${location.hostname}`);
  const html = linkRenderer.call(renderer, href, title, text);
  return localLink ? html : html.replace(/^<a /, `<a target="_blank" rel="noreferrer noopener nofollow" `);
};

/*const renderer = new Marked.Renderer();
const linkRenderer = renderer.link;
renderer.link = (href, title, text) => {
  const localLink = href.startsWith(`${location.protocol}//${location.hostname}`);
  const html = linkRenderer.call(renderer, href, title, text);
  return localLink ? html : html.replace(/^<a /, `<a target="_blank" rel="noreferrer noopener nofollow" `);
};*/

let katex;

const codemirror = window.SupportedCells['codemirror'].context; 


await window.interpretate.shared.katex.load();
katex = window.interpretate.shared.katex.default;

const splitStringIntoChunks0 = (str, chunkSize) => {
  if (!str || chunkSize <= 0) return [];
  
  const chunks = [];
  for (let i = 0; i < str.length; i += chunkSize) {
    chunks.push(str.slice(i, Math.min(i + chunkSize, str.length)));
  }
  return chunks;
}

const pasteFile = {
  transaction: (ev, view, id, length) => {
    console.log(view.dom.ocellref);
    if (view.dom.ocellref) {
      const channel = view.dom.ocellref.origin.channel;
      server._emitt(channel, `<|"Channel"->"${id}", "Length"->${length}, "CellType"->"md"|>`, 'Forwarded["CM:PasteEvent"]');
    }
  },

  file: (ev, view, id, name, result) => {
    console.log(view.dom.ocellref);
    if (view.dom.ocellref) {
      if (result.length > 5 * 1024 * 1024) {
        const chunks = splitStringIntoChunks0(result, 5 * 1024 * 1024);
        chunks.forEach((chunk, index) => {
          server.emitt(id, `<|"Data"->"${chunk}", "Name"->"${name}", "Chunk"->${index+1}, "Chunks"->${chunks.length}|>`, 'Chunk');
        });
      } else {
        server.emitt(id, `<|"Data"->"${result}", "Name"->"${name}"|>`, 'File');
      }
    }
  }
}

const pasteDrop = {
  transaction: (ev, view, id, length) => {
    console.log(view.dom.ocellref);
    if (view.dom.ocellref) {
      const channel = view.dom.ocellref.origin.channel;
      server._emitt(channel, `<|"Channel"->"${id}", "Length"->${length}, "CellType"->"md"|>`, 'Forwarded["CM:DropEvent"]');
    }
  },

  file: (ev, view, id, name, result) => {
    console.log(view.dom.ocellref);
    if (view.dom.ocellref) {
      if (result.length > 5 * 1024 * 1024) {
        const chunks = splitStringIntoChunks0(result, 5 * 1024 * 1024);
        chunks.forEach((chunk, index) => {
          server.emitt(id, `<|"Data"->"${chunk}", "Name"->"${name}", "Chunk"->${index+1}, "Chunks"->${chunks.length}|>`, 'Chunk');
        });
      } else {
        server.emitt(id, `<|"Data"->"${result}", "Name"->"${name}"|>`, 'File');
      }
    }
  }
}

function inlineKatex(options) {
  return {
    name: 'inlineKatex',
    level: 'inline',
    start(src) { return src.indexOf('$'); },
    tokenizer(src, tokens) {
      const match = src.match(/^\$+([^$\n]+?)\$+/);
      if (match) {
        return {
          type: 'inlineKatex',
          raw: match[0],
          text: match[1].trim()
        };
      }
    },
    renderer(token) {
      console.warn('inlineKatex');
      return katex.renderToString(token.text.replaceAll('\\\\', '\\'), options);
    }
  };
}

function mark(options) {
  return {
    name: 'mark',
    level: 'inline',
    start(src) { return src.indexOf('=='); },
    tokenizer(src, tokens) {
      const match = src.match(/^==+([^=\n]+?)==+/);
      if (match) {
        return {
          type: 'mark',
          raw: match[0],
          text: match[1].trim()
        };
      }
    },
    renderer(token) {
      console.warn('mark');
      return '<mark>'+token.text+'</mark>';
    }
  };
}

function bookmark(parent) {
  return {
    name: 'bookmark',
    level: 'inline',
    start(src) { return src.indexOf('@bookmark'); },
    tokenizer(src, tokens) {
      const match = src.match(/^@bookmark/);
      if (match) {
        parent.bookmark();

        return {
          type: 'bookmark',
          raw: match[0]
        };
      }
    },
    renderer(token) {
      console.warn('bookmark');
      return `<div style="color: rgb(200 0 0)">
   <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5 6.2C5 5.07989 5 4.51984 5.21799 4.09202C5.40973 3.71569 5.71569 3.40973 6.09202 3.21799C6.51984 3 7.07989 3 8.2 3H15.8C16.9201 3 17.4802 3 17.908 3.21799C18.2843 3.40973 18.5903 3.71569 18.782 4.09202C19 4.51984 19 5.07989 19 6.2V21L12 16L5 21V6.2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"></path>
</svg>   
      </div>`;
    }
  };
}

const feReg = new RegExp(/FrontEndExecutable\[([^\[|\]]+)\]/g);

function feObjects(options, string) {
  const feReplacer = (match, index) => {
    const uid = match.slice(19,-1);
    const obj = {uid: uid, elementId: 'femarkdown-'+uuidv4()};
    options.buffer.push(obj);
    return `<div class="markdown-feobject" id="${obj.elementId}"></div>`;
  }

  return string.replace(feReg, feReplacer);
}

function blockKatex(options) {
  return {
    name: 'blockKatex',
    level: 'block',
    start(src) { return src.indexOf('\n$$'); },
    tokenizer(src, tokens) {
      const match = src.match(/^\$\$\n([^$]+?)\n\$\$/);
      if (match) {
        return {
          type: 'blockKatex',
          raw: match[0],
          text: match[1].trim()
        };
      }
    },
    renderer(token) {
      
      console.warn('blockKatex');
      return `<p style="padding-top: 1em; padding-bottom: 1em;">${katex.renderToString(token.text.replaceAll('\\\\', '\\'), {displayMode: true})}</p>`;
    }
  };
}


const admonitionExtension = (parent) => {return {
  name: 'admonition',
  level: 'block', // Define it as a block-level token
  start(src) {
    // Locate the position where `:::` starts
    return src.indexOf(/:::/);
  },
  tokenizer(src, tokens) {
    const rule = /^:::(\w+)\n([\s\S]*?)\n:::/; 
    const match = rule.exec(src);

    //console.warn(match);

    if (match) {
      const innerTokens = [];
      this.lexer.blockTokens(match[2].trim(), innerTokens);

      if (match[1] === 'todo') {
        const count = (match[2].match(/^-\s\[\s\]\s/gm) || []).length;
        parent.todo(count);
         
      }

      return {
        type: 'admonition',
        raw: match[0], // Full matched string
        kind: match[1], // Extract admonition type (e.g., warning)
        inner: innerTokens, // Extract inner content
      };
    }
  },
  renderer(token) {
    const inner = this.parser.parse(token.inner);

    return `<div class="text-sm admonition ${token.kind}">
              <strong>${token.kind.toUpperCase()}</strong>
              <p>${inner}</p>
            </div>`;
  }
}};


const TexOptions = {
  throwOnError: false
};


//marked.use({extensions: [inlineKatex(TexOptions), blockKatex(TexOptions), feObjects()], renderer});

function fixArrowBug(text) {
  if (text.charAt(0) == '>') {
    return text.slice(1);
  }
  return text;
}

function unicodeToChar(text) {
  return text.replace(/\\:[\da-f]{4}/gi, 
         function (match) {
              return String.fromCharCode(parseInt(match.replace(/\\:/g, ''), 16));
         });
}


let todoCount = -1;
let todoDOM = {};
let iconsParentElement = undefined;

const checkIconsContainer = () => {
  if (iconsParentElement) return;

  if (!iconsParentElement) {
    iconsParentElement = document.getElementsByTagName('main');
    if (!iconsParentElement) {
      iconsParentElement = document.body;
    } else {
      iconsParentElement = iconsParentElement[0];
    }
  }

  const c = document.createElement('div');
  c.classList.add('gap-x-1');
  c.style = "margin-top: 0.5rem;right: 1.5rem;position: fixed;display: flex;flex-direction: row;";

  iconsParentElement.appendChild(c);
  iconsParentElement = c;
}

const updateTodo = () => {
  if (!todoDOM.button) {
    if (_todoList.length == 0) return;

    console.warn('Initialization of automatic TODO list');
    const el = `
<button class="p-0.5 bg-gray-50 text-gray-500 rounded flex items-center flex-row gap-x-1" id="todolist_marked" style="color: rgb(230, 167, 0);">
<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="m20.215 2.387-8.258 10.547-2.704-3.092a1 1 0 1 0-1.506 1.316l3.103 3.548a1.5 1.5 0 0 0 2.31-.063L21.79 3.62a1 1 0 1 0-1.575-1.233zM20 11a1 1 0 0 0-1 1v6.077c0 .459-.021.57-.082.684a.364.364 0 0 1-.157.157c-.113.06-.225.082-.684.082H5.923c-.459 0-.57-.022-.684-.082a.363.363 0 0 1-.157-.157c-.06-.113-.082-.225-.082-.684V5.5a.5.5 0 0 1 .5-.5l8.5.004a1 1 0 1 0 0-2L5.5 3A2.5 2.5 0 0 0 3 5.5v12.577c0 .76.082 1.185.319 1.627.224.419.558.753.977.977.442.237.866.319 1.627.319h12.154c.76 0 1.185-.082 1.627-.319.42-.224.754-.558.978-.977.236-.442.318-.866.318-1.627V12a1 1 0 0 0-1-1z" fill="currentColor"></path></svg> <span id="todolist_counter" class="text-sm">3</span>
  </button>   
    `;

    checkIconsContainer();
    iconsParentElement.insertAdjacentHTML("beforeend", el);

    todoDOM.button = document.getElementById("todolist_marked");
    todoDOM.counter = document.getElementById("todolist_counter");
    todoDOM.button.addEventListener('click', () => {
      todoDOM.element.scrollIntoView({ behavior: "instant", block: "center", inline: "nearest" });
    });
  }

  const newValue = _todoList.reduce((acc, el) => (acc + el.count), 0);
  
  if (newValue == todoCount) return;

  if (newValue == 0) {
    todoDOM.button.remove();
    todoDOM.button = undefined;
    return;
  }

  todoDOM.element = _todoList[0].ref.element;


  todoCount = newValue;
  todoDOM.counter.innerText = newValue;
}

const _todoList = [];
const todoList = {
  push: (element) => {
    if (!element) return;

    _todoList.push(element);
    updateTodo();
  },

  remove: (element) => {
    if (!element) return;

    const index = _todoList.indexOf(element);
    if (index > -1) {
      _todoList.splice(index, 1);
      updateTodo();
    }
  }
}

let bookmarkElement = undefined;
let bookmarkElementRef = undefined;

const bookmarkAssign = (element) => {
  if (!bookmarkElement) {
    const element = `<button class="p-0.5 bg-gray-50 text-gray-500 rounded" id="bookmark_marked" style="color: rgba(230, 0, 0, 0.7);">
<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5 6.2C5 5.07989 5 4.51984 5.21799 4.09202C5.40973 3.71569 5.71569 3.40973 6.09202 3.21799C6.51984 3 7.07989 3 8.2 3H15.8C16.9201 3 17.4802 3 17.908 3.21799C18.2843 3.40973 18.5903 3.71569 18.782 4.09202C19 4.51984 19 5.07989 19 6.2V21L12 16L5 21V6.2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
</svg>
  </button>`;

    checkIconsContainer();
    iconsParentElement.insertAdjacentHTML('beforeend', element);

    bookmarkElement = document.getElementById("bookmark_marked");
    bookmarkElement.addEventListener('click', () => {
      bookmarkElementRef.scrollIntoView({ behavior: "instant", block: "center", inline: "nearest" })
    });
  }

  bookmarkElementRef = element;

  if (!bookmarkElementRef) {
    bookmarkElement.remove();
    bookmarkElement = undefined;
    return;
  }


}

class MarkdownCell {
    origin = {}
    feObjects = []
    envs = []


    todoListObject = undefined

    bookmark() {
      const self = this;
      bookmarkAssign(self.element);
    }

    todo(number = 1) {
      if (number == 0) return;

      const self = this;
      this.todoListObject = {
        ref: self,
        count: number
      };

      todoList.push(this.todoListObject);
    }

    dispose() {
      todoList.remove(this.todoListObject);
      delete this.element;

      console.warn('Markdown cell dispose...');
      for (const env of this.envs) {
        for (const obj of Object.values(env.global.stack))  {
          console.log('dispose');
          obj.dispose();
        }
      }
    }
    
    constructor(parent, data) {
      console.log('marked data:::');
      console.log(data);
      const self = this;
      
      const marked = new Marked({async: true, renderer, extensions: [bookmark(self), admonitionExtension(self), inlineKatex(TexOptions), mark(), blockKatex(TexOptions)]});

      marked.parse(feObjects({buffer: self.feObjects}, fixArrowBug(unicodeToChar(data)))).then((res) => {
        parent.element.innerHTML = res.replace(/RVJSEvent\["([^"]+)","([^"]+)"\]/g, '');
        self.feObjects.forEach(async (el) => {
          const cuid = Date.now() + Math.floor(Math.random() * 10009);
          var global = {call: cuid};

          console.warn('loading executable on a markdown field...');
          console.log(el.uid);
          
      
          let env = {global: global, element: document.getElementById(el.elementId)}; 
          console.log("Marked: creating an object");


          console.log('forntend executable');

          let obj;
          console.log('check cache');
          if (ObjectHashMap[el.uid]) {
              obj = ObjectHashMap[el.uid];
          } else {
              obj = new ObjectStorage(el.uid);
          }
          console.log(obj);
      
          const copy = env;
          const store = await obj.get();
          const instance = new ExecutableObject('marked-static-'+uuidv4(), copy, store, true);
          instance.assignScope(copy);
          obj.assign(instance);
      
          instance.execute();          
      
          self.envs.push(env);     
        });
      });

      parent.element.classList.add('markdown', 'margin-bottom-fix');
      this.element = parent.element;

      return this;
    }
  }




  window.SupportedLanguages.push({
    check: (r) => {return(r[0].match(/\w*\.(md)$/) != null)},
    plugins: [codemirror.markdown(), codemirror.DropPasteHandlers(pasteDrop, pasteFile)],
    name: codemirror.markdownLanguage.name
  });

  window.SupportedCells['markdown'] = {
    view: MarkdownCell
  };


  class LaTeXCell {
    dispose() {
      delete this.element;
    }
    
    constructor(parent, data) {
      console.log('latex data:::');
      console.log(data);
      const self = this;

      
      parent.element.innerHTML = katex.renderToString(unicodeToChar(data), {displayMode: true})
      
      

      parent.element.classList.add('markdown', 'margin-bottom-fix');
      this.element = parent.element;

      return this;
    }
  }

  window.SupportedCells['latex'] = {
    view: LaTeXCell
  };</script>
<script type="module">function e(e,t){var r=e.__state.conversionName.toString(),n=Math.round(e.r),o=Math.round(e.g),a=Math.round(e.b),i=e.a,s=Math.round(e.h),l=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===r||"SIX_CHAR_HEX"===r){for(var u=e.hex.toString(16);u.length<6;)u="0"+u;return"#"+u}return"CSS_RGB"===r?"rgb("+n+","+o+","+a+")":"CSS_RGBA"===r?"rgba("+n+","+o+","+a+","+i+")":"HEX"===r?"0x"+e.hex.toString(16):"RGB_ARRAY"===r?"["+n+","+o+","+a+"]":"RGBA_ARRAY"===r?"["+n+","+o+","+a+","+i+"]":"RGB_OBJ"===r?"{r:"+n+",g:"+o+",b:"+a+"}":"RGBA_OBJ"===r?"{r:"+n+",g:"+o+",b:"+a+",a:"+i+"}":"HSV_OBJ"===r?"{h:"+s+",s:"+l+",v:"+c+"}":"HSVA_OBJ"===r?"{h:"+s+",s:"+l+",v:"+c+",a:"+i+"}":"unknown format"}var t=Array.prototype.forEach,r=Array.prototype.slice,n={BREAK:{},extend:function(e){return this.each(r.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(t[r])||(e[r]=t[r])}.bind(this))}),this),e},defaults:function(e){return this.each(r.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(e[r])&&(e[r]=t[r])}.bind(this))}),this),e},compose:function(){var e=r.call(arguments);return function(){for(var t=r.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,r,n){if(e)if(t&&e.forEach&&e.forEach===t)e.forEach(r,n);else if(e.length===e.length+0){var o,a=void 0;for(a=0,o=e.length;a<o;a++)if(a in e&&r.call(n,e[a],a)===this.BREAK)return}else for(var i in e)if(r.call(n,e[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,r){var n=void 0;return function(){var o=this,a=arguments;var i=r||!n;clearTimeout(n),n=setTimeout((function(){n=null,r||e.apply(o,a)}),t),i&&e.apply(o,a)}},toArray:function(e){return e.toArray?e.toArray():r.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},o=[{litmus:n.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:n.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:n.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:n.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(n.isNumber(e.r)&&n.isNumber(e.g)&&n.isNumber(e.b)&&n.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(n.isNumber(e.r)&&n.isNumber(e.g)&&n.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(n.isNumber(e.h)&&n.isNumber(e.s)&&n.isNumber(e.v)&&n.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(n.isNumber(e.h)&&n.isNumber(e.s)&&n.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],a=void 0,i=void 0,s=function(){i=!1;var e=arguments.length>1?n.toArray(arguments):arguments[0];return n.each(o,(function(t){if(t.litmus(e))return n.each(t.conversions,(function(t,r){if(a=t.read(e),!1===i&&!1!==a)return i=a,a.conversionName=r,a.conversion=t,n.BREAK})),n.BREAK})),i},l=void 0,c={hsv_to_rgb:function(e,t,r){var n=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),a=r*(1-t),i=r*(1-o*t),s=r*(1-(1-o)*t),l=[[r,s,a],[i,r,a],[a,r,s],[a,i,r],[s,a,r],[r,a,i]][n];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,r){var n=Math.min(e,t,r),o=Math.max(e,t,r),a=o-n,i=void 0;return 0===o?{h:NaN,s:0,v:0}:(i=e===o?(t-r)/a:t===o?2+(r-e)/a:4+(e-t)/a,(i/=6)<0&&(i+=1),{h:360*i,s:a/o,v:o/255})},rgb_to_hex:function(e,t,r){var n=this.hex_with_component(0,2,e);return n=this.hex_with_component(n,1,t),n=this.hex_with_component(n,0,r)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,r){return r<<(l=8*t)|e&~(255<<l)}},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),p=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(n):void 0},m=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},h=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},y=function(){function t(){if(d(this,t),this.__state=s.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return f(t,[{key:"toString",value:function(){return e(this)}},{key:"toHexString",value:function(){return e(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function g(e,t,r){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||y.recalculateRGB(this,t,r),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(y.recalculateRGB(this,t,r),this.__state.space="RGB"),this.__state[t]=e}})}function b(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||y.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(y.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}y.recalculateRGB=function(e,t,r){if("HEX"===e.__state.space)e.__state[t]=c.component_from_hex(e.__state.hex,r);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");n.extend(e.__state,c.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},y.recalculateHSV=function(e){var t=c.rgb_to_hsv(e.r,e.g,e.b);n.extend(e.__state,{s:t.s,v:t.v}),n.isNaN(t.h)?n.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},y.COMPONENTS=["r","g","b","h","s","v","hex","a"],g(y.prototype,"r",2),g(y.prototype,"g",1),g(y.prototype,"b",0),b(y.prototype,"h"),b(y.prototype,"s"),b(y.prototype,"v"),Object.defineProperty(y.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(y.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=c.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var x=function(){function e(t,r){d(this,e),this.initialValue=t[r],this.domElement=document.createElement("div"),this.object=t,this.property=r,this.__onChange=void 0,this.__onFinishChange=void 0}return f(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),_={};n.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(e,t){n.each(e,(function(e){_[e]=t}))}));var v=/(\d+(\.\d+)?)px/;function w(e){if("0"===e||n.isUndefined(e))return 0;var t=e.match(v);return n.isNull(t)?0:parseFloat(t[1])}var A={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,r){var o=r,a=t;n.isUndefined(a)&&(a=!0),n.isUndefined(o)&&(o=!0),e.style.position="absolute",a&&(e.style.left=0,e.style.right=0),o&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,r,o){var a=r||{},i=_[t];if(!i)throw new Error("Event type "+t+" not supported.");var s=document.createEvent(i);switch(i){case"MouseEvents":var l=a.x||a.clientX||0,c=a.y||a.clientY||0;s.initMouseEvent(t,a.bubbles||!1,a.cancelable||!0,window,a.clickCount||1,0,0,l,c,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var u=s.initKeyboardEvent||s.initKeyEvent;n.defaults(a,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),u(t,a.bubbles||!1,a.cancelable,window,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.keyCode,a.charCode);break;default:s.initEvent(t,a.bubbles||!1,a.cancelable||!0)}n.defaults(s,o),e.dispatchEvent(s)},bind:function(e,t,r,n){var o=n||!1;return e.addEventListener?e.addEventListener(t,r,o):e.attachEvent&&e.attachEvent("on"+t,r),A},unbind:function(e,t,r,n){var o=n||!1;return e.removeEventListener?e.removeEventListener(t,r,o):e.detachEvent&&e.detachEvent("on"+t,r),A},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var r=e.className.split(/ +/);-1===r.indexOf(t)&&(r.push(t),e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return A},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var r=e.className.split(/ +/),n=r.indexOf(t);-1!==n&&(r.splice(n,1),e.className=r.join(" "))}else e.className=void 0;return A},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return w(t["border-left-width"])+w(t["border-right-width"])+w(t["padding-left"])+w(t["padding-right"])+w(t.width)},getHeight:function(e){var t=getComputedStyle(e);return w(t["border-top-width"])+w(t["border-bottom-width"])+w(t["padding-top"])+w(t["padding-bottom"])+w(t.height)},getOffset:function(e){var t=e,r={left:0,top:0};if(t.offsetParent)do{r.left+=t.offsetLeft,r.top+=t.offsetTop,t=t.offsetParent}while(t);return r},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},k=function(){function e(t,r){d(this,e);var n=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),o=n;return n.__prev=n.getValue(),n.__checkbox=document.createElement("input"),n.__checkbox.setAttribute("type","checkbox"),A.bind(n.__checkbox,"change",(function(){o.setValue(!o.__prev)}),!1),n.domElement.appendChild(n.__checkbox),n.updateDisplay(),n}return m(e,x),f(e,[{key:"setValue",value:function(t){var r=p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(),T=function(){function e(t,r,o){d(this,e);var a=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),i=o,s=a;if(a.__select=document.createElement("select"),n.isArray(i)){var l={};n.each(i,(function(e){l[e]=e})),i=l}return n.each(i,(function(e,t){var r=document.createElement("option");r.innerHTML=t,r.setAttribute("value",e),s.__select.appendChild(r)})),a.updateDisplay(),A.bind(a.__select,"change",(function(){var e=this.options[this.selectedIndex].value;s.setValue(e)})),a.domElement.appendChild(a.__select),a}return m(e,x),f(e,[{key:"setValue",value:function(t){var r=p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return A.isActive(this.__select)?this:(this.__select.value=this.getValue(),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(),E=function(){function e(t,r){d(this,e);var n=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),o=n;function a(){o.setValue(o.__input.value)}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),A.bind(n.__input,"keyup",a),A.bind(n.__input,"change",a),A.bind(n.__input,"blur",(function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())})),A.bind(n.__input,"keydown",(function(e){13===e.keyCode&&this.blur()})),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return m(e,x),f(e,[{key:"updateDisplay",value:function(){return A.isActive(this.__input)||(this.__input.value=this.getValue()),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}();function F(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var S=function(){function e(t,r,o){d(this,e);var a=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),i=o||{};return a.__min=i.min,a.__max=i.max,a.__step=i.step,n.isUndefined(a.__step)?0===a.initialValue?a.__impliedStep=1:a.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(a.initialValue))/Math.LN10))/10:a.__impliedStep=a.__step,a.__precision=F(a.__impliedStep),a}return m(e,x),f(e,[{key:"setValue",value:function(t){var r=t;return void 0!==this.__min&&r<this.__min?r=this.__min:void 0!==this.__max&&r>this.__max&&(r=this.__max),void 0!==this.__step&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=F(e),this}}]),e}();var C=function(){function e(t,r,o){d(this,e);var a=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,o));a.__truncationSuspended=!1;var i=a,s=void 0;function l(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}function c(e){var t=s-e.clientY;i.setValue(i.getValue()+t*i.__impliedStep),s=e.clientY}function u(){A.unbind(window,"mousemove",c),A.unbind(window,"mouseup",u),l()}return a.__input=document.createElement("input"),a.__input.setAttribute("type","text"),A.bind(a.__input,"change",(function(){var e=parseFloat(i.__input.value);n.isNaN(e)||i.setValue(e)})),A.bind(a.__input,"blur",(function(){l()})),A.bind(a.__input,"mousedown",(function(e){A.bind(window,"mousemove",c),A.bind(window,"mouseup",u),s=e.clientY})),A.bind(a.__input,"keydown",(function(e){13===e.keyCode&&(i.__truncationSuspended=!0,this.blur(),i.__truncationSuspended=!1,l())})),a.updateDisplay(),a.domElement.appendChild(a.__input),a}return m(e,S),f(e,[{key:"updateDisplay",value:function(){var t,r,n;return this.__input.value=this.__truncationSuspended?this.getValue():(t=this.getValue(),r=this.__precision,n=Math.pow(10,r),Math.round(t*n)/n),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}();function R(e,t,r,n,o){return n+(e-t)/(r-t)*(o-n)}var P=function(){function e(t,r,n,o,a){d(this,e);var i=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,{min:n,max:o,step:a})),s=i;function l(e){e.preventDefault();var t=s.__background.getBoundingClientRect();return s.setValue(R(e.clientX,t.left,t.right,s.__min,s.__max)),!1}function c(){A.unbind(window,"mousemove",l),A.unbind(window,"mouseup",c),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function u(e){var t=e.touches[0].clientX,r=s.__background.getBoundingClientRect();s.setValue(R(t,r.left,r.right,s.__min,s.__max))}function f(){A.unbind(window,"touchmove",u),A.unbind(window,"touchend",f),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return i.__background=document.createElement("div"),i.__foreground=document.createElement("div"),A.bind(i.__background,"mousedown",(function(e){document.activeElement.blur(),A.bind(window,"mousemove",l),A.bind(window,"mouseup",c),l(e)})),A.bind(i.__background,"touchstart",(function(e){if(1!==e.touches.length)return;A.bind(window,"touchmove",u),A.bind(window,"touchend",f),u(e)})),A.addClass(i.__background,"slider"),A.addClass(i.__foreground,"slider-fg"),i.updateDisplay(),i.__background.appendChild(i.__foreground),i.domElement.appendChild(i.__background),i}return m(e,S),f(e,[{key:"updateDisplay",value:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(),O=function(){function e(t,r,n){d(this,e);var o=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),a=o;return o.__button=document.createElement("div"),o.__button.innerHTML=void 0===n?"Fire":n,A.bind(o.__button,"click",(function(e){return e.preventDefault(),a.fire(),!1})),A.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return m(e,x),f(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(),I=function(){function e(t,r){d(this,e);var o=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));o.__color=new y(o.getValue()),o.__temp=new y(0);var a=o;o.domElement=document.createElement("div"),A.makeSelectable(o.domElement,!1),o.__selector=document.createElement("div"),o.__selector.className="selector",o.__saturation_field=document.createElement("div"),o.__saturation_field.className="saturation-field",o.__field_knob=document.createElement("div"),o.__field_knob.className="field-knob",o.__field_knob_border="2px solid ",o.__hue_knob=document.createElement("div"),o.__hue_knob.className="hue-knob",o.__hue_field=document.createElement("div"),o.__hue_field.className="hue-field",o.__input=document.createElement("input"),o.__input.type="text",o.__input_textShadow="0 1px 1px ",A.bind(o.__input,"keydown",(function(e){13===e.keyCode&&m.call(this)})),A.bind(o.__input,"blur",m),A.bind(o.__selector,"mousedown",(function(){A.addClass(this,"drag").bind(window,"mouseup",(function(){A.removeClass(a.__selector,"drag")}))})),A.bind(o.__selector,"touchstart",(function(){A.addClass(this,"drag").bind(window,"touchend",(function(){A.removeClass(a.__selector,"drag")}))}));var i,l=document.createElement("div");function c(e){b(e),A.bind(window,"mousemove",b),A.bind(window,"touchmove",b),A.bind(window,"mouseup",f),A.bind(window,"touchend",f)}function u(e){x(e),A.bind(window,"mousemove",x),A.bind(window,"touchmove",x),A.bind(window,"mouseup",p),A.bind(window,"touchend",p)}function f(){A.unbind(window,"mousemove",b),A.unbind(window,"touchmove",b),A.unbind(window,"mouseup",f),A.unbind(window,"touchend",f),g()}function p(){A.unbind(window,"mousemove",x),A.unbind(window,"touchmove",x),A.unbind(window,"mouseup",p),A.unbind(window,"touchend",p),g()}function m(){var e=s(this.value);!1!==e?(a.__color.__state=e,a.setValue(a.__color.toOriginal())):this.value=a.__color.toString()}function g(){a.__onFinishChange&&a.__onFinishChange.call(a,a.__color.toOriginal())}function b(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=a.__saturation_field.getBoundingClientRect(),r=e.touches&&e.touches[0]||e,n=r.clientX,o=r.clientY,i=(n-t.left)/(t.right-t.left),s=1-(o-t.top)/(t.bottom-t.top);return s>1?s=1:s<0&&(s=0),i>1?i=1:i<0&&(i=0),a.__color.v=s,a.__color.s=i,a.setValue(a.__color.toOriginal()),!1}function x(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=a.__hue_field.getBoundingClientRect(),r=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return r>1?r=1:r<0&&(r=0),a.__color.h=360*r,a.setValue(a.__color.toOriginal()),!1}return n.extend(o.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),n.extend(o.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:o.__field_knob_border+(o.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),n.extend(o.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),n.extend(o.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),n.extend(l.style,{width:"100%",height:"100%",background:"none"}),z(l,"top","rgba(0,0,0,0)","#000"),n.extend(o.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(i=o.__hue_field).style.background="",i.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",i.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.extend(o.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:o.__input_textShadow+"rgba(0,0,0,0.7)"}),A.bind(o.__saturation_field,"mousedown",c),A.bind(o.__saturation_field,"touchstart",c),A.bind(o.__field_knob,"mousedown",c),A.bind(o.__field_knob,"touchstart",c),A.bind(o.__hue_field,"mousedown",u),A.bind(o.__hue_field,"touchstart",u),o.__saturation_field.appendChild(l),o.__selector.appendChild(o.__field_knob),o.__selector.appendChild(o.__saturation_field),o.__selector.appendChild(o.__hue_field),o.__hue_field.appendChild(o.__hue_knob),o.domElement.appendChild(o.__input),o.domElement.appendChild(o.__selector),o.updateDisplay(),o}return m(e,x),f(e,[{key:"updateDisplay",value:function(){var e=s(this.getValue());if(!1!==e){var t=!1;n.each(y.COMPONENTS,(function(r){if(!n.isUndefined(e[r])&&!n.isUndefined(this.__color.__state[r])&&e[r]!==this.__color.__state[r])return t=!0,{}}),this),t&&n.extend(this.__color.__state,e)}n.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var r=this.__color.v<.5||this.__color.s>.5?255:0,o=255-r;n.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+r+","+r+","+r+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,z(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),n.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+r+","+r+","+r+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),e}(),L=["-moz-","-o-","-webkit-","-ms-",""];function z(e,t,r,o){e.style.background="",n.each(L,(function(n){e.style.cssText+="background: "+n+"linear-gradient("+t+", "+r+" 0%, "+o+" 100%); "}))}var B=function(e,t){var r=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var o=r.getElementsByTagName("head")[0];try{o.appendChild(n)}catch(e){}},M=function(e,t){var r=e[t];return n.isArray(arguments[2])||n.isObject(arguments[2])?new T(e,t,arguments[2]):n.isNumber(r)?n.isNumber(arguments[2])&&n.isNumber(arguments[3])?n.isNumber(arguments[4])?new P(e,t,arguments[2],arguments[3],arguments[4]):new P(e,t,arguments[2],arguments[3]):n.isNumber(arguments[4])?new C(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new C(e,t,{min:arguments[2],max:arguments[3]}):n.isString(r)?new E(e,t):n.isFunction(r)?new O(e,t,""):n.isBoolean(r)?new k(e,t):null};var D=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},j=function(){function e(){d(this,e),this.backgroundElement=document.createElement("div"),n.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),A.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),n.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;A.bind(this.backgroundElement,"click",(function(){t.hide()}))}return f(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),n.defer((function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",A.unbind(e.domElement,"webkitTransitionEnd",t),A.unbind(e.domElement,"transitionend",t),A.unbind(e.domElement,"oTransitionEnd",t)};A.bind(this.domElement,"webkitTransitionEnd",t),A.bind(this.domElement,"transitionend",t),A.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-A.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-A.getHeight(this.domElement)/2+"px"}}]),e}(),N=function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");B(N);var U="Default",V=function(){try{return!!window.localStorage}catch(e){return!1}}(),G=void 0,H=!0,$=void 0,W=!1,X=[],Z=function e(t){var r=this,o=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),A.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=n.defaults(o,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),o=n.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),n.isUndefined(o.load)?o.load={preset:U}:o.preset&&(o.load.preset=o.preset),n.isUndefined(o.parent)&&o.hideable&&X.push(this),o.resizable=n.isUndefined(o.parent)&&o.resizable,o.autoPlace&&n.isUndefined(o.scrollable)&&(o.scrollable=!0);var a,i=V&&"true"===localStorage.getItem(ee(this,"isLocal")),s=void 0,l=void 0;if(Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return r.parent?r.getRoot().preset:o.load.preset},set:function(e){r.parent?r.getRoot().preset=e:o.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),r.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,oe(r,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,l&&(l.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(t){o.closed=t,o.closed?A.addClass(r.__ul,e.CLASS_CLOSED):A.removeClass(r.__ul,e.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return i},set:function(e){V&&(i=e,e?A.bind(window,"unload",s):A.unbind(window,"unload",s),localStorage.setItem(ee(r,"isLocal"),e))}}}),n.isUndefined(o.parent)){if(this.closed=o.closed||!1,A.addClass(this.domElement,e.CLASS_MAIN),A.makeSelectable(this.domElement,!1),V&&i){r.useLocalStorage=!0;var c=localStorage.getItem(ee(this,"gui"));c&&(o.load=JSON.parse(c))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,A.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),o.closeOnTop?(A.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(A.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),A.bind(this.__closeButton,"click",(function(){r.closed=!r.closed}))}else{void 0===o.closed&&(o.closed=!0);var u=document.createTextNode(o.name);A.addClass(u,"controller-name"),l=Y(r,u);A.addClass(this.__ul,e.CLASS_CLOSED),A.addClass(l,"title"),A.bind(l,"click",(function(e){return e.preventDefault(),r.closed=!r.closed,!1})),o.closed||(this.closed=!1)}o.autoPlace&&(n.isUndefined(o.parent)&&(H&&($=document.createElement("div"),A.addClass($,"dg"),A.addClass($,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild($),H=!1),$.appendChild(this.domElement),A.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||oe(r,o.width)),this.__resizeHandler=function(){r.onResizeDebounced()},A.bind(window,"resize",this.__resizeHandler),A.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),A.bind(this.__ul,"transitionend",this.__resizeHandler),A.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&ne(this),s=function(){V&&"true"===localStorage.getItem(ee(r,"isLocal"))&&localStorage.setItem(ee(r,"gui"),JSON.stringify(r.getSaveObject()))},this.saveToLocalStorageIfPossible=s,o.parent||((a=r.getRoot()).width+=1,n.defer((function(){a.width-=1})))};function Y(e,t,r){var n=document.createElement("li");return t&&n.appendChild(t),r?e.__ul.insertBefore(n,r):e.__ul.appendChild(n),e.onResize(),n}function K(e){A.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&A.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function q(e,t){var r=e.__preset_select[e.__preset_select.selectedIndex];r.innerHTML=t?r.value+"*":r.value}function J(e,t){var r=e.getRoot(),n=r.__rememberedObjects.indexOf(t.object);if(-1!==n){var o=r.__rememberedObjectIndecesToControllers[n];if(void 0===o&&(o={},r.__rememberedObjectIndecesToControllers[n]=o),o[t.property]=t,r.load&&r.load.remembered){var a=r.load.remembered,i=void 0;if(a[e.preset])i=a[e.preset];else{if(!a[U])return;i=a[U]}if(i[n]&&void 0!==i[n][t.property]){var s=i[n][t.property];t.initialValue=s,t.setValue(s)}}}}function Q(e,t,r,o){if(void 0===t[r])throw new Error('Object "'+t+'" has no property "'+r+'"');var a=void 0;if(o.color)a=new I(t,r);else{var i=[t,r].concat(o.factoryArgs);a=M.apply(e,i)}o.before instanceof x&&(o.before=o.before.__li),J(e,a),A.addClass(a.domElement,"c");var s=document.createElement("span");A.addClass(s,"property-name"),s.innerHTML=a.property;var l=document.createElement("div");l.appendChild(s),l.appendChild(a.domElement);var c=Y(e,l,o.before);return A.addClass(c,Z.CLASS_CONTROLLER_ROW),a instanceof I?A.addClass(c,"color"):A.addClass(c,u(a.getValue())),function(e,t,r){if(r.__li=t,r.__gui=e,n.extend(r,{options:function(t){if(arguments.length>1){var o=r.__li.nextElementSibling;return r.remove(),Q(e,r.object,r.property,{before:o,factoryArgs:[n.toArray(arguments)]})}if(n.isArray(t)||n.isObject(t)){var a=r.__li.nextElementSibling;return r.remove(),Q(e,r.object,r.property,{before:a,factoryArgs:[t]})}},name:function(e){return r.__li.firstElementChild.firstElementChild.innerHTML=e,r},listen:function(){return r.__gui.listen(r),r},remove:function(){return r.__gui.remove(r),r}}),r instanceof P){var o=new C(r.object,r.property,{min:r.__min,max:r.__max,step:r.__step});n.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(e){var t=r[e],n=o[e];r[e]=o[e]=function(){var e=Array.prototype.slice.call(arguments);return n.apply(o,e),t.apply(r,e)}})),A.addClass(t,"has-slider"),r.domElement.insertBefore(o.domElement,r.domElement.firstElementChild)}else if(r instanceof C){var a=function(t){if(n.isNumber(r.__min)&&n.isNumber(r.__max)){var o=r.__li.firstElementChild.firstElementChild.innerHTML,a=r.__gui.__listening.indexOf(r)>-1;r.remove();var i=Q(e,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[r.__min,r.__max,r.__step]});return i.name(o),a&&i.listen(),i}return t};r.min=n.compose(a,r.min),r.max=n.compose(a,r.max)}else r instanceof k?(A.bind(t,"click",(function(){A.fakeEvent(r.__checkbox,"click")})),A.bind(r.__checkbox,"click",(function(e){e.stopPropagation()}))):r instanceof O?(A.bind(t,"click",(function(){A.fakeEvent(r.__button,"click")})),A.bind(t,"mouseover",(function(){A.addClass(r.__button,"hover")})),A.bind(t,"mouseout",(function(){A.removeClass(r.__button,"hover")}))):r instanceof I&&(A.addClass(t,"color"),r.updateDisplay=n.compose((function(e){return t.style.borderLeftColor=r.__color.toString(),e}),r.updateDisplay),r.updateDisplay());r.setValue=n.compose((function(t){return e.getRoot().__preset_select&&r.isModified()&&q(e.getRoot(),!0),t}),r.setValue)}(e,c,a),e.__controllers.push(a),a}function ee(e,t){return document.location.href+"."+t}function te(e,t,r){var n=document.createElement("option");n.innerHTML=t,n.value=t,e.__preset_select.appendChild(n),r&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function re(e,t){t.style.display=e.useLocalStorage?"block":"none"}function ne(e){var t=void 0;function r(r){return r.preventDefault(),e.width+=t-r.clientX,e.onResize(),t=r.clientX,!1}function o(){A.removeClass(e.__closeButton,Z.CLASS_DRAG),A.unbind(window,"mousemove",r),A.unbind(window,"mouseup",o)}function a(n){return n.preventDefault(),t=n.clientX,A.addClass(e.__closeButton,Z.CLASS_DRAG),A.bind(window,"mousemove",r),A.bind(window,"mouseup",o),!1}e.__resize_handle=document.createElement("div"),n.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),A.bind(e.__resize_handle,"mousedown",a),A.bind(e.__closeButton,"mousedown",a),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function oe(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function ae(e,t){var r={};return n.each(e.__rememberedObjects,(function(o,a){var i={},s=e.__rememberedObjectIndecesToControllers[a];n.each(s,(function(e,r){i[r]=t?e.initialValue:e.getValue()})),r[a]=i})),r}function ie(e){0!==e.length&&D.call(window,(function(){ie(e)})),n.each(e,(function(e){e.updateDisplay()}))}Z.toggleHide=function(){W=!W,n.each(X,(function(e){e.domElement.style.display=W?"none":""}))},Z.CLASS_AUTO_PLACE="a",Z.CLASS_AUTO_PLACE_CONTAINER="ac",Z.CLASS_MAIN="main",Z.CLASS_CONTROLLER_ROW="cr",Z.CLASS_TOO_TALL="taller-than-window",Z.CLASS_CLOSED="closed",Z.CLASS_CLOSE_BUTTON="close-button",Z.CLASS_CLOSE_TOP="close-top",Z.CLASS_CLOSE_BOTTOM="close-bottom",Z.CLASS_DRAG="drag",Z.DEFAULT_WIDTH=245,Z.TEXT_CLOSED="Close Controls",Z.TEXT_OPEN="Open Controls",Z._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||Z.toggleHide()},A.bind(window,"keydown",Z._keydownHandler,!1),n.extend(Z.prototype,{add:function(e,t){return Q(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Q(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;n.defer((function(){t.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&$.removeChild(this.domElement);var e=this;n.each(this.__folders,(function(t){e.removeFolder(t)})),A.unbind(window,"keydown",Z._keydownHandler,!1),K(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var r=new Z(t);this.__folders[e]=r;var n=Y(this,r.domElement);return A.addClass(n,"folder"),r},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],K(e);var t=this;n.each(e.__folders,(function(t){e.removeFolder(t)})),n.defer((function(){t.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=A.getOffset(e.__ul).top,r=0;n.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(r+=A.getHeight(t))})),window.innerHeight-t-20<r?(A.addClass(e.domElement,Z.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(A.removeClass(e.domElement,Z.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&n.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:n.debounce((function(){this.onResize()}),50),remember:function(){if(n.isUndefined(G)&&((G=new j).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;n.each(Array.prototype.slice.call(arguments),(function(t){0===e.__rememberedObjects.length&&function(e){var t=e.__save_row=document.createElement("li");A.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),A.addClass(t,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",A.addClass(r,"button gears");var o=document.createElement("span");o.innerHTML="Save",A.addClass(o,"button"),A.addClass(o,"save");var a=document.createElement("span");a.innerHTML="New",A.addClass(a,"button"),A.addClass(a,"save-as");var i=document.createElement("span");i.innerHTML="Revert",A.addClass(i,"button"),A.addClass(i,"revert");var s=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?n.each(e.load.remembered,(function(t,r){te(e,r,r===e.preset)})):te(e,U,!1);if(A.bind(s,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value})),t.appendChild(s),t.appendChild(r),t.appendChild(o),t.appendChild(a),t.appendChild(i),V){var l=document.getElementById("dg-local-explain"),c=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(ee(e,"isLocal"))&&c.setAttribute("checked","checked"),re(e,l),A.bind(c,"change",(function(){e.useLocalStorage=!e.useLocalStorage,re(e,l)}))}var u=document.getElementById("dg-new-constructor");A.bind(u,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||G.hide()})),A.bind(r,"click",(function(){u.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),G.show(),u.focus(),u.select()})),A.bind(o,"click",(function(){e.save()})),A.bind(a,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)})),A.bind(i,"click",(function(){e.revert()}))}(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)})),this.autoPlace&&oe(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=ae(this)),e.folders={},n.each(this.__folders,(function(t,r){e.folders[r]=t.getSaveObject()})),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=ae(this),q(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[U]=ae(this,!0)),this.load.remembered[e]=ae(this),this.preset=e,te(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){n.each(this.__controllers,(function(t){this.getRoot().load.remembered?J(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this),n.each(this.__folders,(function(e){e.revert(e)})),e||q(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&ie(this.__listening)},updateDisplay:function(){n.each(this.__controllers,(function(e){e.updateDisplay()})),n.each(this.__folders,(function(e){e.updateDisplay()}))}});var se=Z,le={};Object.defineProperty(le,"__esModule",{value:!0});var ce=le.default=void 0;const ue=6/29,de=3*ue*ue,fe=e=>Math.round(255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055))||0,pe=e=>e>ue?e*e*e:de*(e-4/29);function me(e){return 0===e.length?0:void 0===e[0].length?1:void 0===e[0][0].length?2:void 0===e[0][0][0].length?3:void 0}ce=le.default=({luminance:e,a:t,b:r})=>{const n=(e+16)/116,o=.96422*pe(n+t/500),a=Number(pe(n)),i=.82521*pe(n-r/200);return{red:fe(3.1338561*o-1.6168667*a-.4906146*i),green:fe(-.9787684*o+1.9161415*a+.033454*i),blue:fe(.0719453*o-.2289914*a+1.4052427*i)}},core["Charting`DateTicksFunction"]=()=>"DateTicksFunction",core.DateListPlot=()=>{},core["Graphics`DPR"]=()=>window.devicePixelRatio;let he=!1,ye=!1,ge={name:"WebObjects/Graphics"};const be={name:"GraphicsComplex 2D"};ge.Pane=(e,t)=>{},interpretate.contextExpand(ge),["FaceForm","ImageSizeRaw","Selectable","ViewMatrix","CurrentValue","FontColor","Tiny","VertexColors","Antialiasing","Small","Plot","ListCurvePathPlot","ListLinePlot","ListPlot","Automatic","Controls","All","TickLabels","FrameTicksStyle","AlignmentPoint","AspectRatio","Axes","AxesLabel","AxesOrigin","AxesStyle","Background","BaselinePosition","BaseStyle","ColorOutput","ContentSelectable","CoordinatesToolOptions","DisplayFunction","Epilog","FormatType","Frame","FrameLabel","FrameStyle","FrameTicks","FrameTicksStyle","GridLines","GridLinesStyle","ImageMargins","ImagePadding","ImageSize","Full","LabelStyle","Method","PlotLabel","PlotRange","PlotRangeClipping","PlotRangePadding","PlotRegion","PreserveImageOptions","Prolog","RotateLabel","Ticks","TicksStyle","TransitionDuration"].map((e=>{ge[e]=()=>e,ge[e].update=()=>e})),ge.Spacer=()=>{},core.GoldenRatio=()=>1.618,ge["Graphics`Canvas"]=async(e,t)=>{let r={k:1,x:0,y:0};t.onZoom.push((e=>{r=e}));const n={xAxis:t.xAxis,yAxis:t.yAxis};return t.xAxis=e=>0,t.yAxis=e=>0,t.xAxis.invert=e=>{const o=(e-r.x-t.panZoomEntites.left)/r.k;return n.xAxis.invert(o)},t.yAxis.invert=e=>{const o=(e-r.y-t.panZoomEntites.top)/r.k;return n.yAxis.invert(o)},t.panZoomEntites.canvas},ge.HoldForm=async(e,t)=>await interpretate(e[0],t),ge.HoldForm.update=async(e,t)=>await interpretate(e[0],t),ge.Scale=async(e,t)=>await interpretate(e[0],t),ge.Scale.update=async(e,t)=>await interpretate(e[0],t),ge.NamespaceBox=async(e,t)=>await interpretate(e[1],t),ge.DynamicModuleBox=async(e,t)=>await interpretate(e[1],t),ge.TagBox=async(e,t)=>await interpretate(e[0],t),ge.DynamicModule=async(e,t)=>await interpretate(e[1],t),ge["Charting`DelayedClickEffect"]=async(e,t)=>await interpretate(e[0],t),ge.ColorProfileData=()=>{},ge.ParametricPlot=()=>{},ge.TransitionDuration=()=>"TransitionDuration",ge.TransitionType=()=>"TransitionType";let xe;ge.Offset=async(e,t)=>{const r=await interpretate(e[1],t),n={x:r[0],y:r[1]},o=await interpretate(e[0],{...t,offset:n});if(Array.isArray(o)){return[t.xAxis.invert(o[0])-t.xAxis.invert(0)+n.x,t.xAxis.invert(o[1])+n.y-t.xAxis.invert(0)]}return o},ge.Offset.update=ge.Offset,ge.AbsoluteDashing=async(e,t)=>{const r=await interpretate(e[0],t);t.dasharray=r},xe=()=>{he.selection.prototype.maybeTransition=function(e,t){return e?this.transition().ease(e).duration(t):this},he.selection.prototype.maybeTransitionTween=function(e,t,r,n){return e?this.transition().ease(e).duration(t).attrTween(r,n):this.attr(r,n.apply(this.node(),this.data())(1))},xe=()=>{}},ge.Graphics=async(e,t)=>{await interpretate.shared.d3.load(),he||(he=interpretate.shared.d3.d3),ye||(ye=interpretate.shared.d3["d3-interpolate-path"].interpolatePath),ge.interpolatePath=ye,ge.d3=he,xe();let r=await core._getRules(e,{...t,context:ge,hold:!0});if(0==Object.keys(r).length&&e.length>1)if("List"===e[1][0]){const n=e[1].slice(1);r="List"===n[0][0]?await core._getRules(n[0].slice(1),{...t,context:ge,hold:!0}):await core._getRules(n,{...t,context:ge,hold:!0})}else r=await core._getRules(await interpretate(e[1],{...t,context:ge,hold:!0}),{...t,context:ge,hold:!0});console.log(r);let n=r.PlotLabel;var o=t.element;let a=await interpretate(r.ImageSize,{...t,context:ge});if("number"==typeof a?a<1&&(a=1e4*a/2):"string"==typeof a&&(a=core.DefaultWidth),a||(a=t.imageSize?Array.isArray(t.imageSize)?t.imageSize:[t.imageSize,.618034*t.imageSize]:core.DefaultWidth),r.ImageSizeRaw){const e=await interpretate(r.ImageSizeRaw,t);Array.isArray(e)?"number"==typeof e[0]&&"number"==typeof e[1]&&(a=e.map((e=>e/window.devicePixelRatio))):"number"==typeof e&&(a=[e/window.devicePixelRatio,.618034*e/window.devicePixelRatio])}let i,s,l,c=[!1,!1],u=!1,d=[5,5,5,5],f=[!0,!1,!0,!1],p=!1;if(console.log(r),r.Frame&&(r.Frame=await interpretate(r.Frame,t),!0===r.Frame?p=!0:(!0===r.Frame[0][0]&&(p=!0),!0===r.Frame[0]&&(p=!0),r.Frame[1]&&!0===r.Frame[1][0]&&(c=[!0,!1]))),r.Axes&&(r.Axes=await interpretate(r.Axes,t),!0===r.Axes?c=[!0,!0]:Array.isArray(r.Axes)&&(c=r.Axes)),p&&(u=!0,c=[!0,!0,!0,!0]),r.Ticks&&(r.Ticks=await interpretate(r.Ticks,t),Array.isArray(r.Ticks)&&Array.isArray(r.Ticks[0])&&(Number.isInteger(r.Ticks[0][0])||Array.isArray(r.Ticks[0][0]))&&(i=[...r.Ticks,...r.Ticks])),r.FrameTicks&&p&&(r.FrameTicks=await interpretate(r.FrameTicks,t),i=[!0,!0,!0,!0],Array.isArray(r.FrameTicks)&&(Array.isArray(r.FrameTicks[0])&&(Array.isArray(r.FrameTicks[0][0])?(Number.isInteger(r.FrameTicks[0][0][0])||"string"==typeof r.FrameTicks[0][0]||Array.isArray(r.FrameTicks[0][0][0]))&&(i[1]=r.FrameTicks[0][0],i[3]=r.FrameTicks[0][1]):(i[1]=r.FrameTicks[0][0],i[3]=r.FrameTicks[0][1])),Array.isArray(r.FrameTicks[1])&&(Array.isArray(r.FrameTicks[1][0])?(Number.isInteger(r.FrameTicks[1][0][0])||"string"==typeof r.FrameTicks[1][0]||Array.isArray(r.FrameTicks[1][0][0]))&&(i[0]=r.FrameTicks[1][0],i[2]=r.FrameTicks[1][1]):(i[0]=r.FrameTicks[1][0],i[2]=r.FrameTicks[1][1])))),r.FrameTicks&&r.FrameTicks[2]&&r.FrameTicks[2][1]){let e=r.FrameTicks[2][1];Array.isArray(e)&&(e=e[1],Array.isArray(e)&&"Charting`getDateTicks"==e[0]&&(p=!1,c=[!0,!1]))}if(r.TickDirection){const e=await interpretate(r.TickDirection,t);"Inward"===e&&(u=!0),"Outward"===e&&(u=!1)}r.TickLengths&&(r.TickLengths=await interpretate(r.TickLengths,t),Array.isArray(r.TickLengths)||(d=[r.TickLengths,r.TickLengths,r.TickLengths,r.TickLengths])),r.TickLabels&&(r.TickLabels=await interpretate(r.TickLabels,t),f=Array.isArray(r.TickLabels)?r.TickLabels.flat():[!1,!1,!1,!1]);let m={top:0,right:0,bottom:10,left:40},h={top:0,right:0,bottom:15,left:0};c[2]&&(m.top=m.bottom,m.left=m.right),r.AxesLabel&&(h.bottom=10,m.top=30,m.right=50,h.right=50),p&&(h.left=40,h.left=30,m.left=30,m.right=40,m.top=30,h.bottom=10,m.bottom=35),r.ImagePadding&&(console.log("padding: "),console.log(r.ImagePadding),r.ImagePadding=await interpretate(r.ImagePadding,t),console.log(r.ImagePadding),"None"===r.ImagePadding?(m.top=0,m.bottom=0,m.left=0,m.right=0):Number.isInteger(r.ImagePadding)?(m.top=r.ImagePadding,m.bottom=r.ImagePadding,m.left=r.ImagePadding,m.right=r.ImagePadding):Array.isArray(r.ImagePadding)?(Array.isArray(r.ImagePadding[0])&&(Number.isInteger(r.ImagePadding[0][0])&&(m.left=r.ImagePadding[0][0]),Number.isInteger(r.ImagePadding[0][1])&&(m.right=r.ImagePadding[0][1])),Array.isArray(r.ImagePadding[1])&&(Number.isInteger(r.ImagePadding[1][0])&&(m.bottom=r.ImagePadding[1][0]),Number.isInteger(r.ImagePadding[1][1])&&(m.top=r.ImagePadding[1][1]))):"All"===r.ImagePadding||(!1===r.ImagePadding?(m.top=0,m.bottom=0,m.left=0,m.right=0):console.error("given ImagePadding is not supported!"))),r.ImageSizeRaw&&(m.top=0,m.bottom=0,m.left=0,m.right=0,h.top=0,h.bottom=0,h.left=0,h.right=0),r.Axes||r.Frame||r.ImagePadding||r.AxesLabel||(console.warn("Axes are absent, removing padding..."),m.top=0,m.bottom=0,m.left=0,m.right=0,h.top=0,h.bottom=0,h.left=0,h.right=0),a instanceof Array?a[0]<100&&!r.PaddingIsImportant&&(console.warn("too small, removing padding..."),m.top=0,m.bottom=0,m.left=0,m.right=0,h.top=0,h.bottom=0,h.left=0,h.right=0):a<100&&!r.PaddingIsImportant&&(console.warn("too small, removing padding..."),m.top=0,m.bottom=0,m.left=0,m.right=0,h.top=0,h.bottom=0,h.left=0,h.right=0);let y=await interpretate(r.AspectRatio,t)||1;"number"!=typeof y&&(y=1),a instanceof Array||(y=(y*(a-m.left-m.right)+m.top+m.bottom)/a,a=[a,a*y]);let g,b=a[0]-m.left-m.right,x=a[1]-m.top-m.bottom;if((b<0||x<0)&&(m.top=0,m.bottom=0,m.left=0,m.right=0,h={top:0,right:0,bottom:0,left:0},b=a[0],x=a[1]),g=he.select(o).append("svg"),"Background"in r&&(r.Background=await interpretate(r.Background,{...t,context:ge}),r.Background&&(g.node().style.backgroundColor=r.Background,console.log("Background color:"+r.Background))),"ViewBox"in r){let e=await interpretate(r.ViewBox,t);e instanceof Array||(e=[0,0,e,e*y]),g.attr("viewBox",e),t.viewBox=e}else g.attr("width",b+m.left+m.right+h.left).attr("height",x+m.top+m.bottom+h.bottom),t.svgWidth=b+m.left+m.right+h.left,t.svgHeight=x+m.top+m.bottom+h.bottom,t.clipWidth=b,t.clipHeight=x;let _=g.append("svg:defs"),v=0,w=2,A=[0,0];p&&(v=7,w=0),g.attr("tabindex","0");const k=g;g=g.append("g").attr("transform","translate("+(m.left+h.left)+","+m.top+")");const T="clp"+Math.random().toFixed(4).toString().replace(".","");g.append("clipPath").attr("id",T).append("rect").attr("width",b-2*v+w).attr("height",x-2*v+w).attr("x",v-w).attr("y",v-w);let E=[[-1.15,1.15],[-1.15,1.15]],F=!0;if(r.PlotRange||t.plotRange){const e=t.plotRange||await interpretate(r.PlotRange,t);Number.isFinite(e[0][0])&&(Number.isFinite(e[1][0])?(E=e,F=!1):(E[0]=e[0],E[1]=[-1.15,1.15]))}p&&(A=[10*(E[0][1]-E[0][0])/b,10*(E[1][1]-E[1][0])/x]);{const e=(E[0][0]+E[0][1])/2,t=(E[1][0]+E[1][1])/2;E=[[e+1*(E[0][0]-e)-A[0],e+1*(E[0][1]-e)+A[0]],[t+1*(E[1][0]-t)-A[1],t+1*(E[1][1]-t)+A[1]]]}let S,C,R,P,O=he.easeLinear;if(r.TransitionType){switch(await interpretate(r.TransitionType,{...t,context:ge})){case"Linear":O=he.easeLinear;break;case"CubicInOut":O=he.easeCubicInOut;break;default:O=void 0}}console.log(E);let I=he.scaleLinear().domain(E[0]).range([0,b]),L=he.axisBottom(I),z=he.axisTop(I);if(console.log(c),i)if(i[0])if("string"==typeof i[0])switch(i[0]){case"Automatic":break;case"None":L=L.tickValues([]);break;case"DateTicksFunction":I=he.scaleTime().domain(E[0].map((e=>1e3*e-2208996e6))).range([0,b]),z=he.axisTop(I),L=he.axisBottom(I);const e=I;I=t=>e(1e3*t-2208996e6),I.copy=e.copy,I.range=e.range,I.domain=e.domain,I.invert=e.invert}else if(!0===i[0])console.log("Default ticks");else if(Array.isArray(i[0][0])){const e=i[0].map((e=>e[1]));L=L.tickValues(i[0].map((e=>e[0]))).tickFormat((function(t,r){return e[r]}))}else L=L.tickValues(i[0]);else L=L.tickValues([]);if(i)if(i[2])if("string"==typeof i[2])switch(i[2]){case"Automatic":break;case"None":z=z.tickValues([]);break;case"DateTicksFunction":I=he.scaleTime().domain(E[0].map((e=>1e3*e-2208996e6))).range([0,b]),z=he.axisTop(I).ticks(4),L=he.axisBottom(I).ticks(4);const e=I;I=t=>e(1e3*t-2208996e6),I.copy=e.copy,I.range=e.range,I.domain=e.domain,I.invert=e.invert}else if(!0===i[2])console.log("Default ticks");else if(Array.isArray(i[2][0])){const e=i[2].map((e=>e[1]));z=z.tickValues(i[2].map((e=>e[0]))).tickFormat((function(t,r){return e[r]}))}else z=z.tickValues(i[2]);else z=z.tickValues([]);let B=!1;r.GridLines&&r.GridLines[1]&&(B="Automatic"==r.GridLines[1]),f[0]||(L=L.tickFormat((e=>""))),f[1]||(z=z.tickFormat((e=>""))),u?(L=L.tickSizeInner(-d[0]).tickSizeOuter(0),z=z.tickSizeInner(-d[2]).tickSizeOuter(0)):(L=L.tickSizeInner(d[0]).tickSizeOuter(0),z=z.tickSizeInner(d[2]).tickSizeOuter(0));let M,D,j,N,U=he.scaleLinear().domain(E[1]).range([x,0]),V=he.axisLeft(U),G=he.axisRight(U);if(i)if(i[1])if("string"==typeof i[1])switch(i[1]){case"Automatic":break;case"None":V=V.tickValues([]);break;case"DateTicksFunction":U=he.scaleTime().domain(E[1].map((e=>1e3*e-2208996e6))).range([0,x]),G=he.axisRight(U),V=he.axisLeft(U);const e=U;U=t=>e(1e3*t-2208996e6),U.copy=e.copy,U.range=e.range,U.domain=e.domain,U.invert=e.invert}else if(!0===i[1])console.log("Default ticks");else if(Array.isArray(i[1][0])){const e=i[1].map((e=>e[1]));V=V.tickValues(i[1].map((e=>e[0]))).tickFormat((function(t,r){return e[r]}))}else V=V.tickValues(i[1]);else V=V.tickValues([]);if(i)if(i[3])if("string"==typeof i[3])switch(i[3]){case"Automatic":break;case"None":G=G.tickValues([]);break;case"DateTicksFunction":U=he.scaleTime().domain(E[1].map((e=>1e3*e-2208996e6))).range([0,x]),G=he.axisRight(U),V=he.axisLeft(U);const e=U;U=t=>e(1e3*t-2208996e6),U.copy=e.copy,U.range=e.range,U.domain=e.domain,U.invert=e.invert}else if(!0===i[3])console.log("Default ticks");else if(Array.isArray(i[3][0])){const e=i[3].map((e=>e[1]));G=G.tickValues(i[3].map((e=>e[0]))).tickFormat((function(t,r){return e[r]}))}else G=G.tickValues(i[3]);else G=G.tickValues([]);if(f[2]||(V=V.tickFormat((e=>""))),f[3]||(G=G.tickFormat((e=>""))),u?(V=V.tickSizeInner(-d[1]).tickSizeOuter(0),G=G.tickSizeInner(-d[3]).tickSizeOuter(0)):(V=V.tickSizeInner(d[1]).tickSizeOuter(0),G=G.tickSizeInner(d[3]).tickSizeOuter(0)),i&&B&&(c[0]&&(M=e=>t=>t.selectAll("line").data(e.ticks()).join("line").attr("x1",(t=>e(t))).attr("x2",(t=>e(t))).attr("y1",0).attr("y2",x)),c[1]&&(D=e=>t=>t.selectAll("line").data(e.ticks()).join("line").attr("x1",0).attr("x2",b).attr("y1",(t=>e(t))).attr("y2",(t=>e(t))))),t.context=ge,t.svg=g.append("g"),"PlotRangeClipping"in r){const e=await interpretate(r.PlotRangeClipping,t);t.svg=e?t.svg.attr("clip-path","url(#"+T+")").append("g"):t.svg.append("g")}else t.svg=t.svg.attr("clip-path","url(#"+T+")").append("g");t.rootSVG=t.svg,t.xAxis=I,t.yAxis=U,t.defs=_,t.xGrid=M,t.yGrid=D,t.numerical=!0,t.tostring=!1,t.offset={x:0,y:0},t.color="rgb(68, 68, 68)",t.stroke=void 0,t.opacity=1,t.fontsize=10,t.fontfamily="sans-serif",t.strokeWidth=1.5,t.pointSize=.023,t.arrowHead=1,t.onZoom=[],t.transitionDuration=50,t.transitionType=O,t.plotRange=E,s={...t},l={...t},r.AxesStyle&&await interpretate(r.AxesStyle,s),r.FrameStyle&&(console.warn("FrameStyle"),console.log(r.FrameStyle),await interpretate(r.FrameStyle,s),console.log(s)),r.FrameTicksStyle&&await interpretate(r.FrameTicksStyle,l),D&&(N=g.append("g").attr("stroke","#0000002e").attr("stroke-dasharray","4 2").call(D(U))),M&&(j=g.append("g").attr("stroke","#0000002e").attr("stroke-dasharray","4 2").call(M(I))),c[0]&&(S=g.append("g").attr("transform","translate(0,"+x+")").call(L).attr("font-size",l.fontsize).attr("fill",l.color)),c[2]&&(R=g.append("g").attr("transform","translate(0,0)").call(z).attr("font-size",l.fontsize).attr("fill",l.color)),c[1]&&(C=g.append("g").call(V).attr("font-size",l.fontsize).attr("fill",l.color)),c[3]&&(P=g.append("g").attr("transform","translate("+b+", 0)").call(G).attr("font-size",l.fontsize).attr("fill",l.color));let H={...s};if(r.LabelStyle&&await interpretate(r.LabelStyle,H),n&&(n=await interpretate(n,H),ge.Text.PutText(g.append("text").attr("x",b/2+H.offset.x).attr("y",0-m.top/2+H.offset.y).attr("text-anchor","middle").attr("fill",H.color).style("font-size",H.fontsize).style("font-family",H.fontfamily),n,H)),r.AxesLabel&&!p&&(r.AxesLabel=await interpretate(r.AxesLabel,{...t,hold:!0}),Array.isArray(r.AxesLabel))){let e={...t},n=await interpretate(r.AxesLabel[0],e);if("None"!=n&&S){let t=0,r=0;Array.isArray(n)&&(t=n[1][0],r=n[1][1],n=n[0]),ge.Text.PutText(S.append("text").attr("x",b+e.offset.x+10+t).attr("y",m.bottom+e.offset.y+r).attr("font-size",s.fontsize).attr("fill",s.color).attr("text-anchor","start"),n,s)}if(e={...t},n=await interpretate(r.AxesLabel[1],e),"None"!=n&&C){let t=0,r=0;Array.isArray(n)&&(t=n[1][0],r=n[1][1],n=n[0]),ge.Text.PutText(C.append("text").attr("x",0+e.offset.x+t).attr("y",-m.top/2+e.offset.y+r).attr("font-size",s.fontsize).attr("fill",s.color).attr("text-anchor","start"),n,s)}}if(r.FrameLabel&&p&&(r.FrameLabel=await interpretate(r.FrameLabel,{...t}),Array.isArray(r.FrameLabel))){let e,n,o=r.FrameLabel[0],a=r.FrameLabel[1];if("string"==typeof o){const e=[o,a];o=[e[1],"None"],a=[e[0],"None"]}if("None"!=o&&o){if(e={...t},n=o[0],"None"!=n&&C){let t=0,r=0;Array.isArray(n)&&(t=n[1][0],r=n[1][1],n=n[0]),ge.Text.PutText(C.append("text").attr("transform","rotate(-90)").attr("y",-m.left+e.offset.x+t).attr("x",-x/2-e.offset.y+r).attr("font-size",s.fontsize).attr("fill",s.color).attr("text-anchor","middle"),n,s)}if(e={...t},n=o[1],"None"!=n&&P){let t=0,r=0;Array.isArray(n)&&(t=n[1][0],r=n[1][1],n=n[0]),ge.Text.PutText(P.append("text").attr("x",0+e.offset.x+t).attr("y",m.bottom+e.offset.y+r).attr("font-size",s.fontsize).attr("fill",s.color).attr("text-anchor","middle"),n,s)}}if("None"!=a&&a){if(e={...t},n=a[1],"None"!=n&&R){let t=0,r=0;Array.isArray(n)&&(t=n[1][0],r=n[1][1],n=n[0]),ge.Text.PutText(R.append("text").attr("x",b/2+e.offset.x+t).attr("y",m.bottom+e.offset.y+r).attr("font-size",s.fontsize).attr("fill",s.color).attr("text-anchor","middle"),n,s)}if(e={...t},n=a[0],"None"!=n&&S){let t=0,r=0;Array.isArray(n)&&(t=n[1][0],r=n[1][1],n=n[0]),ge.Text.PutText(S.append("text").attr("x",b/2+e.offset.x+t).attr("y",m.bottom+e.offset.y+r).attr("font-size",s.fontsize).attr("fill",s.color).attr("text-anchor","middle"),n,s)}}}r.TransitionDuration&&(t.transitionDuration=await interpretate(r.TransitionDuration,t)),t.local.xAxis=I,t.local.yAxis=U;let $=!1;if((r.Controls||void 0===r.Controls)&&(void 0===r.Controls||await interpretate(r.Controls,t))&&($=!0,Ae(k,g,t.svg,S,C,R,P,j,N,L,V,z,G,M,D,I,U,t)),t.panZoomEntites={canvas:k,svg:t.svg,left:m.left+h.left,top:m.top,gX:S,gY:C,gTX:R,gRY:P,gGX:j,gGY:N,xGrid:M,yGrid:D,xAxis:L,yAxis:V,txAxis:z,ryAxis:G,x:I,y:U},!t.inset&&b>=160&&x>=98&&$){const e=new se({autoPlace:!1,name:"...",closed:!0}),r=document.createElement("div");r.classList.add("graphics2d-controller"),r.appendChild(e.domElement);const n={Save:function(){!function(e,t){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{const r=document.createElement("a");document.body.appendChild(r);const n=window.URL.createObjectURL(e);r.href=n,r.download=t,r.click(),setTimeout((()=>{window.URL.revokeObjectURL(n),document.body.removeChild(r)}),0)}}(we(o.firstChild),"plot.svg")}};e.add(n,"Save"),t.element.appendChild(r)}const W=Object.keys(t.global.stack);if(await interpretate(r.Prolog,t),await interpretate(e[0],t),interpretate(r.Epilog,t),F){if(t.reRendered)return console.error("Something is wrong with ranges. We could not determine them properly"),void console.warn(t);g.node().style.opacity=0,console.warn("d3.js autoscale! Requires double evaluation!!!");const r=a[0]-(m.left+m.right),n=a[1]-(m.top+m.bottom);let i=t.svg.node().getBBox();if(console.log([r,n]),console.log(i),0==i.width||0==i.height){for(let e=0;e<12&&(console.warn("Element is too small... Waiting for CSS reflow"),console.log([i.width,i.height]),await ve(300),i=t.svg.node().getBBox(),0==i.width||0==i.height);++e);if(0==i.width||0==i.height)throw g.node().style.opacity=1,console.log(g.node()),"Plot range has zero size. Content is hidden probably"}const s=[[I.invert(i.x),I.invert(i.x+i.width)],[U.invert(i.height+i.y),U.invert(i.height+i.y-i.height)]];console.log(s),console.warn("Kill all created instances");const l=Object.keys(t.global.stack).filter((e=>!W.some((t=>t===e))));for(const e of l)t.global.stack[e].dispose();return g.remove(),o.replaceChildren(),await ge.Graphics(e,{...t,plotRange:s,reRendered:!0})}return t},ge["Graphics`Serialize"]=async(e,t)=>{const r=await core._getRules(e,t);let n=t.element;r.TemporalDOM&&(n=document.createElement("div"),n.style.pointerEvents="none",n.style.opacity=0,n.style.position="absolute",document.body.appendChild(n));const o=await interpretate(e[0],{...t,element:n}),a=await we(o.element.firstChild).text();return Object.values(t.global.stack).forEach((e=>{e.dispose()})),r.TemporalDOM&&n.remove(),a},ge.Graphics.update=(e,t)=>{console.error("root update method for Graphics is not supported")},ge.Graphics.destroy=(e,t)=>{console.error("Nothing to destroy...")},ge.JoinForm=(e,t)=>{t.joinform=interpretate(e[0],t),console.warn("JoinForm is not implemented!")};const _e={BezierCurve:async(e,t)=>{let r=await interpretate(e[0],t);var n=t.path;const o=t.xAxis,a=t.yAxis;r=r.map((e=>[o(e[0]),a(e[1])]));let i=r.length-1;if(t.startQ){n.moveTo(...r[0]);for(let e=1;e<r.length-2;e+=3)i-=3,n.bezierCurveTo(...r[e],...r[e+1],...r[e+2]);t.startQ=!1}else for(let e=0;e<r.length-2;e+=3)i-=3,n.bezierCurveTo(...r[e],...r[e+1],...r[e+2]);i>0&&n.quadraticCurveTo(...r[r.length-2],...r[r.length-1])}};ge.FaceForm=async(e,t)=>{const r={...t,hold:!0},n=await interpretate(e[0],r);if(Array.isArray(n)){r.hold=!1;for(const e of n)await interpretate(e,r)}t.thickness=r.thickness,t.width=r.width,t.opacity=r.opacity,t.color=r.color},_e.Line=async(e,t)=>{let r=await interpretate(e[0],t);var n=t.path;const o=t.xAxis,a=t.yAxis;if(r=r.map((e=>[o(e[0]),a(e[1])])),t.startQ){n.moveTo(...r[0]);for(let e=1;e<r.length;++e)n.lineTo(...r[e]);t.startQ=!1}else for(let e=0;e<r.length;++e)n.lineTo(...r[e])},ge.RegularPolygon=async(e,t)=>{let r=3,n=1,[o,a]=[0,0],i=Math.PI/2;1==e.length&&(r=await interpretate(e[0],t)),2==e.length&&(r=await interpretate(e[1],t),n=await interpretate(e[0],t)),3==e.length&&([o,a]=await interpretate(e[0],t),r=await interpretate(e[2],t),n=await interpretate(e[1],t)),Array.isArray(n)&&(i+=n[1],n=n[0]);const s=he.line().x((function(e){return t.xAxis(e[0])})).y((function(e){return t.yAxis(e[1])})),l=2*Math.PI/r,c=he.range(r).map((e=>{const t=i+e*l;return[o+n*Math.cos(t),a+n*Math.sin(t)]})),u=t.svg.append("path").datum(c).attr("d",s).attr("fill",t.color).attr("fill-opacity",t.opacity).attr("stroke-opacity",t.strokeOpacity||t.opacity).attr("vector-effect","non-scaling-stroke").attr("stroke-width",t.strokeWidth).attr("stroke",t.stroke||t.color);return t.dasharray&&u.attr("stroke-dasharray",t.dasharray.join()),t.local.polygon=u,u},ge.JoinedCurve=async(e,t)=>{const r=he.path();return await interpretate(e[0],{...t,path:r,context:[_e,ge],startQ:!0}),t.svg.append("path").attr("fill","none").attr("vector-effect","non-scaling-stroke").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",r)},ge.CapForm=()=>{},ge.FilledCurve=async(e,t)=>{const r=he.path();return await interpretate(e[0],{...t,path:r,context:[_e,ge],startQ:!0}),t.svg.append("path").attr("fill",t.color).attr("vector-effect","non-scaling-stroke").attr("opacity",t.opacity).attr("fill-rule","evenodd").attr("stroke","none").attr("stroke-width",t.strokeWidth).attr("d",r)};const ve=e=>new Promise((t=>{setTimeout(t,e)}));ge.Inset=async(e,t)=>{let r,n=[0,0];const o=await core._getRules(e,t),a=Object.keys(o).length;let i;e.length-a>1&&(n=await interpretate(e[1],t)),n instanceof NumericArrayObject&&(n=n.normal()),e.length-a>2&&(i=await interpretate(e[2],t)),e.length-a>3&&(r=await interpretate(e[3],t));const s=t.svg.append("g"),l=s.append("foreignObject"),c={global:t.global,inset:!0,element:l.node()};r&&("number"==typeof r&&(r=[r,r/1.6]),r=[Math.abs(t.xAxis(r[0])-t.xAxis(0)),Math.abs(t.yAxis(r[1])-t.yAxis(0))],l.attr("width",r[0]),l.attr("height",r[1])),await interpretate(e[0],c);const u=l.node();await ve(50);if((u.offsetHeight||u.firstChild?.offsetHeight||u.firstChild?.height)<10)for(let e=0;e<15&&(await ve(300),!((u.offsetHeight||u.firstChild?.offsetHeight||u.firstChild?.height)>10));++e);let d={width:u.offsetWidth||u.firstChild?.offsetWidth||u.firstChild?.width,height:u.offsetHeight||u.firstChild?.offsetHeight||u.firstChild?.height};return d.width instanceof SVGAnimatedLength&&(d.width=d.width.animVal.valueInSpecifiedUnits),d.height instanceof SVGAnimatedLength&&(d.height=d.height.animVal.valueInSpecifiedUnits),console.warn(d),(d.width<1||!d.width)&&d.height>1&&(d.width=1.66*d.height),r||(l.attr("width",d.width),l.attr("height",d.height)),"ViewMatrix"in o&&!o.ViewMatrix?(l.attr("x",0),l.attr("y",0),s):(t.local.box=d,i?(l.attr("x",t.xAxis(n[0]-i[0])).attr("y",t.yAxis(n[1]-i[1])-d.height),i=[Math.abs(t.xAxis(i[0])-t.xAxis(0)),-Math.abs(t.yAxis(i[1])-t.yAxis(0))]):(i=[d.width/2,-d.height/2],l.attr("x",t.xAxis(n[0])-i[0]).attr("y",t.yAxis(n[1])-i[1]-d.height)),t.local.foreignObject=l,t.local.opos=i,s)},ge.Inset.update=async(e,t)=>{let r=await interpretate(e[1],t);r instanceof NumericArrayObject&&(r=r.normal());const n=t.local.opos;return t.local.foreignObject.attr("x",t.xAxis(r[0])-n[0]).attr("y",t.yAxis(r[1])-n[1]-t.local.box.height),t.local.foreignObject},ge.Inset.destroy=async(e,t)=>{console.warn("Destory method is not defined for Inset")},ge.Inset.virtual=!0;const we=e=>{const t="http://www.w3.org/2000/xmlns/";e=e.cloneNode(!0);const r=window.location.href+"#",n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT);for(;n.nextNode();)for(const e of n.currentNode.attributes)e.value.includes(r)&&(e.value=e.value.replace(r,"#"));e.setAttributeNS(t,"xmlns","http://www.w3.org/2000/svg"),e.setAttributeNS(t,"xmlns:xlink","http://www.w3.org/1999/xlink");const o=(new window.XMLSerializer).serializeToString(e);return new Blob([o],{type:"image/svg+xml"})};const Ae=(e,t,r,n,o,a,i,s,l,c,u,d,f,p,m,h,y,g)=>{console.log({listener:e,raw:t,view:r,gX:n,gY:o,gTX:a,gRY:i,xAxis:c,yAxis:u,txAxis:d,ryAxis:f,xGrid:p,yGrid:m,x:h,y:y,env:g});const b=he.zoom().filter((function(e){return e.preventDefault(),!(e.ctrlKey&&"wheel"!==e.type||e.button)})).on("zoom",(function({transform:e}){r.attr("transform",e);const t=e.rescaleX(h),b=e.rescaleY(y);n&&n.call(c.scale(t));o&&o.call(u.scale(b));a&&a.call(d.scale(t));i&&i.call(f.scale(b));s&&s.call(p(t));l&&l.call(m(b));g.onZoom.forEach((t=>t(e)))}));e.call(b),g._zoom=b};let ke;ge.Texture=async(e,t)=>{const r=await interpretate(e[0],{...t,offscreen:!0});console.log("got it!");const n=await createImageBitmap(r);r.remove();return t.local.img=n,t.exposed.texture={image:n,get:e=>(t.local.texture||(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),t.local.texture=Ee.createTexture(e,{src:n,flipY:!1,minMag:e.LINEAR})),t.local.texture)},n},ge.Texture.destroy=(e,t)=>{t.local.img.close()},ge.Texture.virtual=!0,ge.SVGAttribute=async(e,t)=>{const r=await core._getRules(e,t);let n=await interpretate(e[0],t);return Object.keys(r).forEach((e=>{n=n.attr(e,r[e])})),t.local.object=n,n},ge.SVGAttribute.update=async(e,t)=>{const r=await core._getRules(e,t);let n=t.local.object.maybeTransition(t.transitionType,t.transitionDuration);return Object.keys(r).forEach((e=>{n=n.attr(e,r[e])})),n},ge.SVGAttribute.destroy=async(e,t)=>{console.log("SVGAttribute: nothing to destroy")},ge.SVGAttribute.virtual=!0,ge.LABColor=async(e,t)=>{let r;r=e.length>1?[await interpretate(e[0],t),await interpretate(e[1],t),await interpretate(e[2],t)]:await interpretate(e[0],t);const n=ce({luminance:100*r[0],a:100*r[1],b:100*r[2]});return t.color="rgb("+Math.floor(n.red)+","+Math.floor(n.green)+","+Math.floor(n.blue)+")",e.length>3&&(t.opacity=await interpretate(e[3],t)),t.color},ge.LABColor.update=()=>{},ge.arrowGenerator=void 0,be.BezierCurve=async(e,t)=>(await interpretate(e[0],t)).filter((e=>!Array.isArray(e))),be.Arrow=async(e,t)=>{await interpretate.shared.d3.load(),ke||(ke=(await interpretate.shared.d3["d3-arrow"]).arrow1);let r=await interpretate(e[0],t);if(!Array.isArray(r)){let e;const n=uuidv4(),o=ke().id(n).attr("fill",t.color).attr("stroke","none").scale([t.arrowHead]);return t.svg.call(o),e=r.attr("marker-end","url(#"+n+")"),e}if(r[0][0]){console.log("Multiple isntances"),console.log(r);const e=t.svg.append("g");e.attr("fill","none").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth);const n=uuidv4(),o=ke().id(n).attr("fill",t.color).attr("stroke","none").scale([t.arrowHead]);return t.svg.call(o),r.forEach((r=>{e.append("path").datum(r.map((e=>t.wgl.fallbackVertices[e-1]))).attr("vector-effect","non-scaling-stroke").attr("d",he.line().x((function(e){return e[0]})).y((function(e){return e[1]}))).attr("marker-end","url(#"+n+")")})),e}{const e=uuidv4(),n=ke().id(e).attr("fill",t.color).attr("stroke","none").scale([t.arrowHead]);t.svg.call(n);return t.svg.append("path").datum(r.map((e=>t.wgl.fallbackVertices[e-1]))).attr("fill","none").attr("vector-effect","non-scaling-stroke").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",he.line().x((function(e){return e[0]})).y((function(e){return e[1]}))).attr("marker-end","url(#"+e+")")}},ge.Arrow=async(e,t)=>{await interpretate.shared.d3.load(),ke||(ke=(await interpretate.shared.d3["d3-arrow"]).arrow1),t.xAxis,t.yAxis;const r=uuidv4(),n=ke().id(r).attr("fill",t.color).attr("stroke","none").scale([t.arrowHead]);t.local.marker=r,t.svg.call(n);let o=await interpretate(e[0],t);if(o instanceof NumericArrayObject&&(o=o.normal()),!Array.isArray(o)){let e;return e=o.attr("marker-end","url(#"+r+")"),e}if(t.local.line=he.line().x((function(e){return t.xAxis(e[0])})).y((function(e){return t.yAxis(e[1])})),o[0][0][0]||"number"==typeof o[0][0][0]){const e=[];return o.forEach((n=>{e.push(t.svg.append("path").datum(n).attr("vector-effect","non-scaling-stroke").attr("fill","none").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",t.local.line).attr("marker-end","url(#"+r+")"))})),t.local.arrows=e,e}{const e=t.svg.append("path").datum(o).attr("vector-effect","non-scaling-stroke").attr("fill","none").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",t.local.line).attr("marker-end","url(#"+r+")");return t.local.arrow=e,t.colorRefs&&(t.colorRefs[t.root.uid]=t.root),t.opacityRefs&&(t.opacityRefs[t.root.uid]=t.root),e}},ge.Arrow.update=async(e,t)=>{t.xAxis,t.yAxis;let r=await interpretate(e[0],t);if(r instanceof NumericArrayObject&&(r=r.normal()),r[0][0][0])throw"Arrows update method does not support multiple traces";return t.local.arrow.datum(r).maybeTransitionTween(t.TransitionType,t.TransitionDuration,"d",(function(e){var r=he.select(this).attr("d"),n=t.local.line(e);return ye(r,n)}))};const Te={};Te.DynamicName=async(e,t)=>{const r=await interpretate(e[0],{...t,context:[ge,Te]}),n=await interpretate(e[1],t);return t.contextSpace.put(n,r),r},Te.DynamicLocation=async(e,t)=>{const r=await interpretate(e[0],t),n=(await t.contextSpace.get(r)).node().getBBox(),o=[n.x+n.width/2,n.y+n.height/2];return o[0]=t.xAxis.invert(o[0]),o[1]=t.yAxis.invert(o[1]),o},ge.DynamicNamespace=async(e,t)=>{const r={names:{},que:{},get:async e=>{if(e in r.names)return r.names[e];const t=new Deferred;return e in r.que||(r.que[e]=[]),r.que[e].push(t),t.promise},put:(e,t)=>{r.names[e]=t,e in r.que&&r.que[e].forEach((e=>e.resolve(t)))}},n={...t,contextSpace:r,context:[Te,ge],hold:!0},o=await interpretate(e[0],n),a=[],i=[];if(Array.isArray(o))for(const e of o.reverse()){const t=n.svg.append("g");i.push(t),a.push(interpretate(e,{...n,hold:!1,svg:t}))}else a.push(o);await Promise.all(a);for(const e of i)n.svg.node().prepend(e.node())},ge.Arrow.updateColor=(e,t)=>{"string"==typeof t.local.marker&&(t.local.marker=he.select(document.getElementById(t.local.marker).firstChild)),t.local.marker.attr("fill",t.color),Array.isArray(t.local.arrows)?t.local.arrows.map((e=>e.attr("stroke",t.color))):t.local.arrow.attr("stroke",t.color)},ge.Arrow.updateOpacity=(e,t)=>{"string"==typeof t.local.marker&&(t.local.marker=he.select(document.getElementById(t.local.marker).firstChild)),t.local.marker.attr("opacity",t.opacity),Array.isArray(t.local.arrows)?t.local.arrows.map((e=>e.attr("opacity",t.opacity))):t.local.arrow.attr("opacity",t.opacity)},ge.Arrow.virtual=!0,ge.Arrow.destroy=async(e,t)=>{if(t.colorRefs&&delete t.colorRefs[t.root.uid],t.opacityRefs&&delete t.opacityRefs[t.root.uid],Array.isArray(t.local.arrows)?t.local.arrows.map((e=>e.remove)):t.local?.arrow?.remove(),"string"==typeof t.local.marker){const e=document.getElementById(t.local.marker);t.local.marker=he.select(e.firstChild),t.local.marker.remove(),e.remove()}else t.local?.marker?.remove()},ge.ImageScaled=async(e,t)=>{const r=await interpretate(e[0],t);return[r[0]*(t.plotRange[0][1]-t.plotRange[0][0])+t.plotRange[0][0],r[1]*(t.plotRange[1][1]-t.plotRange[1][0])+t.plotRange[1][0]]},ge.Arrowheads=async(e,t)=>{const r=await interpretate(e[0],t);Array.isArray(r)?t.arrowHead=10*r.flat()[0]:t.arrowHead=10*r},ge.Text=async(e,t)=>{const r=await interpretate(e[0],t);let n=await interpretate(e[1],t);n instanceof NumericArrayObject&&(n=n.normal()),t.local.text=r;let o={x:0,y:0};t.offset&&(o=t.offset);const a=t.svg.append("text").attr("font-family",t.fontfamily).attr("font-size",t.fontsize).attr("fill",t.color);if(e.length>2){let r=[0,0];"Rule"!=e[2][0]&&(r=(await interpretate(e[2],{...t,plotRange:[[-1,1],[-1,1]]})).map((e=>Math.round(e)))),console.warn("OFFSET"),console.warn(r),t.offset&&(o=t.offset),a.attr("x",t.xAxis(n[0])+o.x).attr("y",t.yAxis(n[1])+o.y),0===r[0]?a.attr("text-anchor","middle"):r[0]>0?a.attr("text-anchor","end"):r[0]<0&&a.attr("text-anchor","start"),0===r[1]?a.attr("alignment-baseline","middle"):r[1]>0?a.attr("alignment-baseline","hanging"):r[1]<0&&a.attr("alignment-baseline","text-after")}else a.attr("x",t.xAxis(n[0])+o.x).attr("y",t.yAxis(n[1])+o.y);return ge.Text.PutText(a,r,t),t.local.object=a,t.colorRefs&&(t.colorRefs[t.root.uid]=t.root),t.opacityRefs&&(t.opacityRefs[t.root.uid]=t.root),a},ge.Text.PutText=(e,t,r)=>{if(!t)return;let n=t;"number"==typeof t&&(n=t.toString());const o=[ge.Text.TokensSplit(n.replaceAll(/\\([a-zA-z]+)/g,ge.Text.GreekReplacer),ge.Text.TextOperators)].flat(1/0);let a;console.log(o),e.html(o.shift());let i=0;for(;null!=(a=o.shift());)"string"==typeof a?(e.append("tspan").html(a).attr("font-size",r.fontsize).attr("dy",-i),i=0):(i=-r.fontsize*a.ky,e.append("tspan").html(a.data).attr("font-size",Math.round(r.fontsize*a.kf)).attr("dy",i))},ge.Text.TextOperators=[{type:"sup",handler:e=>e,regexp:/\^{([^{|}]*)}/,meta:{ky:.5,kf:.5}},{type:"sub",handler:e=>e,regexp:/\_{([^{|}]*)}/,meta:{ky:-.5,kf:.5}}],ge.Text.GreekReplacer=(e,t,r)=>"&"+t.toLowerCase().replace("sqrt","radic").replace("degree","deg")+";",ge.Text.TokensSplit=(e,t,r=0)=>{if(r===t.length||r<0)return e;const n=e.match(t[r].regexp);if(null===n)return ge.Text.TokensSplit(e,t,r+1);const o={type:t[r].type,data:t[r].handler(n[1]),...t[r].meta};return[ge.Text.TokensSplit(e.slice(0,n.index),t,r+1),o,ge.Text.TokensSplit(e.slice(n.index+n[0].length),t,0)]},ge.Text.virtual=!0,ge.Text.updateColor=(e,t)=>{t.local.object.attr("fill",t.color)},ge.Text.updateOpacity=(e,t)=>{t.local.object.attr("opacity",t.opacity)},ge.Text.update=async(e,t)=>{const r=await interpretate(e[0],t);let n,o=await interpretate(e[1],t);return o instanceof NumericArrayObject&&(o=o.normal()),n=t.local.text!=r?t.local.object.maybeTransition(t.transitionType,t.transitionDuration).text(r).attr("x",t.xAxis(o[0])).attr("y",t.yAxis(o[1])):t.local.object.maybeTransition(t.transitionType,t.transitionDuration).attr("x",t.xAxis(o[0])).attr("y",t.yAxis(o[1])),n},ge.Text.destroy=(e,t)=>{t.local.object.remove(),delete t.local.object,t.colorRefs&&delete t.colorRefs[t.root.uid],t.opacityRefs&&delete t.opacityRefs[t.root.uid]},ge.Text.subcontext={},ge.FontSize=()=>"FontSize",ge.FontSize.update=ge.FontSize,ge.FontFamily=()=>"FontFamily",ge.FontFamily.update=ge.FontFamily,ge.Style=async(e,t)=>{const r=t,n=await core._getRules(e,t);n.FontSize&&(r.fontsize=n.FontSize),n.FontColor&&(r.color=n.FontColor),n.FontFamily&&(r.fontfamily=n.FontFamily);for(let t=1;t<e.length-Object.keys(n).length;++t)await interpretate(e[t],r);return await interpretate(e[0],r)},ge.Style.update=async(e,t)=>{const r=await core._getRules(e,t);return r.FontSize&&(t.fontsize=r.FontSize),r.FontFamily&&(t.fontfamily=r.FontFamily),await interpretate(e[0],t)},ge.AnimationFrameListener=async(e,t)=>{await interpretate(e[0],t);const r=await core._getRules(e,{...t,hold:!0});t.local.event=await interpretate(r.Event,t),t.local.fire=()=>{server.kernel.io.poke(t.local.event)},window.requestAnimationFrame(t.local.fire)},ge.AnimationFrameListener.update=async(e,t)=>{window.requestAnimationFrame(t.local.fire)},ge.AnimationFrameListener.destroy=async(e,t)=>{console.warn("AnimationFrameListener does not exist anymore")},ge.AnimationFrameListener.virtual=!0;var Ee;ge.GraphicsComplex=async(e,t)=>{Ee||(Ee=await Promise.resolve().then((function(){return Qo})));const r=(await interpretate(e[0],t)).map((e=>[t.xAxis(e[0]),t.yAxis(e[1])]));let n=1/0,o=1/0,a=-1/0,i=-1/0;for(const[e,t]of r)e<n&&(n=e),t<o&&(o=t),e>a&&(a=e),t>i&&(i=t);t.svg.append("rect").attr("x",n).attr("y",o).attr("width",a-n).attr("height",i-o).attr("opacity",0);const s=await core._getRules(e,t),l={...t,context:[be,ge]},c=t.svg.append("foreignObject").attr("width",t.clipWidth).attr("height",t.clipHeight).append("xhtml:canvas");c.attr("width",Math.round(1*t.clipWidth)).attr("height",Math.round(1*t.clipHeight));const u=c.node().getContext("webgl"),d=Ee.createProgramInfo(u,["\n    attribute vec2 position;\n    uniform vec2 u_resolution;\n    uniform bool u_vertexColor;\n    uniform bool u_vertexTexture;\n    uniform float u_pointSize;\n    attribute vec4 color;\n    varying vec4 v_color;\n\n    attribute vec2 texcoord;\n    varying vec2 v_texcoord;\n    \n\n    void main() {\n        vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;\n        gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n        if (u_vertexColor) v_color = color;  // Pass color to fragment shader\n        if (u_vertexTexture) v_texcoord = texcoord; // Pass texture (if applicable)\n        gl_PointSize = u_pointSize;\n    }\n  ","\n    precision mediump float;\n    uniform vec4 u_color;\n    uniform bool u_vertexColor;\n    uniform bool u_vertexTexture;\n    varying vec4 v_color;\n\n    uniform sampler2D u_texture;\n    varying vec2 v_texcoord;\n\n    void main() {\n        if (u_vertexColor) {\n          gl_FragColor = v_color;\n          return;\n        }\n\n        if (u_vertexTexture) {\n          gl_FragColor = texture2D(u_texture, v_texcoord);\n          return;\n        }    \n        \n        gl_FragColor = u_color;\n    }\n  "]);l.wgl={gl:u,programInfo:d},l.wgl.fallbackVertices=r;const f=t.opacity,p={position:{numComponents:2,data:r.flat(1/0).map((e=>1*e))}};if(s.VertexColors){let e=[];switch(l.wgl.vertexColors=!0,l.wgl.fallbackColors=s.VertexColors,s.VertexColors[0].length){case 3:for(let t=0;t<s.VertexColors.length;++t){const r=s.VertexColors[t];e.push(...r,f)}break;case 4:e=s.VertexColors.flat(1/0);break;default:if("string"==typeof s.VertexColors[0]){console.warn("FIXME: This is the worst case");for(let t=0;t<s.VertexColors.length;++t){const r=he.color(s.VertexColors[t]);e.push(r.r/255,r.g/255,r.b/255,f)}}}p.color={numComponents:4,data:e}}if(s.VertexTextureCoordinates){const e=s.VertexTextureCoordinates.flat(1/0);p.texcoord={numComponents:2,data:e},l.wgl.vertexTexture=!0}const m=Ee.createBufferInfoFromArrays(u,p);return u.viewport(0,0,u.canvas.width,u.canvas.height),u.clearColor(0,0,0,0),u.clear(u.COLOR_BUFFER_BIT),u.useProgram(d.program),Ee.setBuffersAndAttributes(u,d,m),await interpretate(e[1],l),function(e){const t=e.canvas,r=t.toDataURL("image/png"),n=new Image;n.src=r,n.width=t.width,n.height=t.height,n.style.padding=0,t.parentNode.replaceChild(n,t)}(u),function(e){const t=e.getExtension("WEBGL_lose_context");t&&t.loseContext()}(u),l.canvas},ge.GraphicsComplex.update=()=>{throw"Updates of GraphicsComplex are not supported!"},ge.GraphicsComplex.destroy=()=>{console.log("Nothing to destroy")},ge.GraphicsComplex.virtual=!0,ge.Medium=()=>.08,ge.Large=()=>1.1/10,ge.Small=()=>.05,ge.GraphicsGroup=async(e,t)=>await interpretate(e[0],t),ge.Invisible=async(e,t)=>{const r=t.svg.append("g");return r.attr("style","visibility:hidden"),await interpretate(e[0],{...t,svg:r})},ge.Thickness=()=>{},ge.AbsoluteThickness=(e,t)=>{t.strokeWidth=interpretate(e[0],t)},ge.PointSize=async(e,t)=>{t.pointSize=await interpretate(e[0],t)},ge.Annotation=core.List,ge.ZoomAt=async(e,t)=>{let r=await interpretate(e[0],t);const n={width:t.xAxis((t.plotRange[0][0]+t.plotRange[0][1])/2),height:t.yAxis((t.plotRange[1][0]+t.plotRange[1][1])/2)};let o=[(t.plotRange[0][0]+t.plotRange[0][1])/2,-(t.plotRange[1][0]+t.plotRange[1][1])/2];e.length>1&&(o=await interpretate(e[1],t)),o=[t.xAxis(o[0]),t.yAxis(o[1])],console.log(o);const a=t.panZoomEntites;console.log(t.svg.attr("transform"));const i=he.zoomIdentity.translate(n.width,n.height).scale(r).translate(-o[0],-o[1]);a.svg.maybeTransition(t.transitionType,t.transitionDuration).attr("transform",i),a.gX&&a.gX.maybeTransition(t.transitionType,t.transitionDuration).call(a.xAxis.scale(i.rescaleX(a.x))),a.gY&&a.gY.maybeTransition(t.transitionType,t.transitionDuration).call(a.yAxis.scale(i.rescaleY(a.y))),a.gGX&&a.gGX.maybeTransition(t.transitionType,t.transitionDuration).call(a.xGrid(i.rescaleY(a.x))),a.gGY&&a.gGY.maybeTransition(t.transitionType,t.transitionDuration).call(a.yGrid(i.rescaleY(a.y))),a.gTX&&a.gTX.maybeTransition(t.transitionType,t.transitionDuration).call(a.txAxis.scale(i.rescaleX(a.x))),a.gRY&&a.gRY.maybeTransition(t.transitionType,t.transitionDuration).call(a.ryAxis.scale(i.rescaleY(a.y)))};ge.Directive=async(e,t)=>{const r=await core._getRules(e,t);for(const e of Object.keys(r))t[e.toLowerCase()]=r[e];if((e=>{if("transitiontype"in e)switch(e.transitiontype){case"Linear":e.transitionType=he.easeLinear;break;case"CubicInOut":e.transitionType=he.easeCubicInOut;break;default:e.transitionType=!1}e.transitionduration&&(e.transitionDuration=e.transitionduration)})(t),"PlotRange"in r){r.PlotRange;(()=>{throw"not implemented"})(0,t.plotRange,t.panZoomEntites)}for(let n=0;n<e.length-Object.keys(r).length;++n)await interpretate(e[n],t)},ge.EdgeForm=async(e,t)=>{const r={...t,hold:!0},n=await interpretate(e[0],r);if(Array.isArray(n)){r.hold=!1;for(const e of n)await interpretate(e,r)}t.strokeWidth=r.strokeWidth,t.strokeOpacity=r.opacity,"rgb(68, 68, 68)"!==r.color&&(t.stroke=r.color)},ge.EdgeForm.update=async(e,t)=>{},ge.Opacity=async(e,t)=>{if(t.opacity=await interpretate(e[0],t),t.exposed.opacity=t.opacity,t.root.child){console.log("Dynamic env variable caught");const e={};t.exposed.opacityRefs=e,t.local.refs=e}return t.opacity},ge.Opacity.update=async(e,t)=>{const r=await interpretate(e[0],t),n=Object.values(t.local.refs);for(const e of n)e.execute({method:"updateOpacity",opacity:r})},ge.Opacity.destroy=(e,t)=>{delete t.local.refs},ge.Opacity.virtual=!0,ge.GrayLevel=async(e,t)=>{let r=await interpretate(e[0],t);return r.length&&(r=r[0]),r=Math.floor(255*r),t.color=`rgb(${r},${r},${r})`,t.color},ge.RGBColor=async(e,t)=>{let r;if(3==e.length)r="rgb(",r+=String(Math.floor(255*await interpretate(e[0],t)))+",",r+=String(Math.floor(255*await interpretate(e[1],t)))+",",r+=String(Math.floor(255*await interpretate(e[2],t)))+")";else{let n=await interpretate(e[0],t);n instanceof NumericArrayObject&&(n=n.normal()),r="rgb(",r+=String(Math.floor(255*n[0]))+",",r+=String(Math.floor(255*n[1]))+",",r+=String(Math.floor(255*n[2]))+")"}if(t.root.child){console.log("Dynamic env variable caught");const e={};t.exposed.colorRefs=e,t.local.refs=e}return t.exposed.color=r,r},ge.RGBColor.update=async(e,t)=>{let r;if(3==e.length)r="rgb(",r+=String(Math.floor(255*await interpretate(e[0],t)))+",",r+=String(Math.floor(255*await interpretate(e[1],t)))+",",r+=String(Math.floor(255*await interpretate(e[2],t)))+")";else{let n=await interpretate(e[0],t);n instanceof NumericArrayObject&&(n=n.normal()),r="rgb(",r+=String(Math.floor(255*n[0]))+",",r+=String(Math.floor(255*n[1]))+",",r+=String(Math.floor(255*n[2]))+")"}const n=Object.values(t.local.refs);for(const e of n)e.execute({method:"updateColor",color:r})},ge.RGBColor.destroy=(e,t)=>{delete t.local.refs},ge.RGBColor.virtual=!0;let Fe=(e,t,r,n=r-r*t/2,o=Math.min(n,1-n))=>[e,o?(r-n)/o:0,n];var Se;ge.Hue=async(e,t)=>{let r=await Promise.all(e.map((e=>interpretate(e,t))));if(r.length<3&&(r=[r[0],1,1]),r=Fe(...r),r=[r[0],(100*r[1]).toFixed(2),(100*r[2]).toFixed(2)],t.color="hsl("+(314*r[0]).toFixed(2)+","+r[1]+"%,"+r[2]+"%)",t.root.child){console.log("Dynamic env variable caught");const e={};t.exposed.colorRefs=e,t.local.refs=e}return t.exposed.color=t.color,t.color},ge.Hue.update=async(e,t)=>{let r=await Promise.all(e.map((e=>interpretate(e,t))));r.length<3&&(r=[r[0],1,1]),r=Fe(...r),r=[r[0],(100*r[1]).toFixed(2),(100*r[2]).toFixed(2)];const n="hsl("+(314*r[0]).toFixed(2)+","+r[1]+"%,"+r[2]+"%)",o=Object.values(t.local.refs);for(const e of o)e.execute({method:"updateColor",color:n})},ge.Hue.destroy=(e,t)=>{delete t.local.refs},ge.Hue.virtual=!0,ge.CubicInOut=()=>"CubicInOut",ge.Linear=()=>"Linear",ge.Tooltip=()=>{console.log("Tooltip is not implemented.")},be.List=core.List,be.Polygon=async(e,t)=>{let r=await interpretate(e[0],t),n=he.color(t.color);n=[n.r/255,n.g/255,n.b/255,t.opacity],r[0][0]||(r=[r]);const{gl:o,programInfo:a}=t.wgl;let i;switch(r[0].length){case 3:i=Ee.createBufferInfoFromArrays(o,{indices:r.flat(1/0).map((e=>e-1))});break;case 4:{const e=[];for(let t=0;t<r.length;++t){const n=r[t];e.push(n[0]-1,n[1]-1,n[2]-1,n[0]-1,n[2]-1,n[3]-1)}i=Ee.createBufferInfoFromArrays(o,{indices:e})}break;case 5:{const e=[];for(let t=0;t<r.length;++t){const n=r[t];e.push(n[0]-1,n[1]-1,n[2]-1,n[0]-1,n[2]-1,n[3]-1,n[0]-1,n[3]-1,n[4]-1)}i=Ee.createBufferInfoFromArrays(o,{indices:e})}break;case 6:{const e=[];for(let t=0;t<r.length;++t){const n=r[t];e.push(n[0]-1,n[1]-1,n[2]-1,n[0]-1,n[2]-1,n[3]-1,n[0]-1,n[3]-1,n[4]-1,n[0]-1,n[4]-1,n[5]-1)}i=Ee.createBufferInfoFromArrays(o,{indices:e})}break;default:const e=t.wgl.fallbackVertices,n=[];Se||(Se=(await Promise.resolve().then((function(){return Ta}))).default);for(let t of r){t=t.map((e=>e-1));const r=t.flatMap((t=>e[t]));n.push(Se(r).map((e=>t[e])))}i=Ee.createBufferInfoFromArrays(o,{indices:n.flat()})}if(Ee.setBuffersAndAttributes(o,a,i),t.wgl.vertexTexture){if(!t.texture)throw"Texture is not provided!";const e=t.texture.get(o);return Ee.setUniforms(a,{u_resolution:[o.canvas.width,o.canvas.height],u_texture:e,u_vertexTexture:!0}),void o.drawElements(o.TRIANGLES,i.numElements,o.UNSIGNED_SHORT,0)}Ee.setUniforms(a,{u_resolution:[o.canvas.width,o.canvas.height],u_color:n,u_vertexColor:Boolean(t.wgl.vertexColors)}),o.drawElements(o.TRIANGLES,i.numElements,o.UNSIGNED_SHORT,0)},ge.Polygon=async(e,t)=>{let r=await interpretate(e[0],t);if(r instanceof NumericArrayObject&&(r=data.normal()),t.local.line=he.line().x((function(e){return t.xAxis(e[0])})).y((function(e){return t.yAxis(e[1])})),Array.isArray(r[0][0])){console.log("most likely there are many polygons");const e=t.svg.append("g").attr("fill",t.color).attr("fill-opacity",t.opacity).attr("stroke-opacity",t.strokeOpacity||t.opacity).attr("vector-effect","non-scaling-stroke").attr("stroke-width",t.strokeWidth).attr("stroke",t.stroke||t.color);return t.texture&&t.local.area.attr("fill","url(#"+t.texture+")"),t.dasharray&&e.attr("stroke-dasharray",t.dasharray.join()),r.forEach((r=>{r.push(r[0]),e.append("path").datum(r).attr("d",t.local.line)})),t.local.polygons=e,e}return r.push(r[0]),t.local.area=t.svg.append("path").datum(r).attr("fill",t.color).attr("fill-opacity",t.opacity).attr("stroke-opacity",t.strokeOpacity||t.opacity).attr("vector-effect","non-scaling-stroke").attr("stroke-width",t.strokeWidth).attr("stroke",t.stroke||t.color).attr("d",t.local.line),t.texture&&t.local.area.attr("fill","url(#"+t.texture+")"),t.dasharray&&t.local.area.attr("stroke-dasharray",t.dasharray.join()),t.colorRefs&&(t.colorRefs[t.root.uid]=t.root),t.local.area},ge.Polygon.updateColor=(e,t)=>{if(t.local.polygons)for(const e of t.local.polygons)e.attr("fill",t.color);else t.local.area.attr("fill",t.color)},ge.Polygon.updateOpacity=(e,t)=>{if(t.local.polygons)for(const e of t.local.polygons)e.attr("fill-opacity",t.opacity),e.attr("stroke-opacity",t.strokeOpacity||t.opacity);else t.local.area.attr("fill-opacity",t.opacity),t.local.area.attr("stroke-opacity",t.strokeOpacity||t.opacity)},ge.Polygon.update=async(e,t)=>{let r=await interpretate(e[0],t);if(r instanceof NumericArrayObject&&(r=r.normal()),t.local.polygons)throw"update method for many polygons in not supported";t.xAxis,t.yAxis;return t.local.area.datum(r).maybeTransitionTween(t.transitionType,t.transitionDuration,"d",(function(e){var r=he.select(this).attr("d"),n=t.local.line(e);return ye(r,n)}))},ge.Polygon.destroy=(e,t)=>{if(console.log("area destroyed"),t.local){if(t.colorRefs&&delete t.colorRefs[t.root.uid],t.opacityRefs&&delete t.opacityRefs[t.root.uid],t.local.area)return t.local.area.remove(),void delete t.local.area;t.local.polygons&&(t.local.polygons.remove(),delete t.local.polygons)}},ge.Polygon.virtual=!0,ge.IdentityFunction=async(e,t)=>await interpretate(e[0],t),ge.Tooltip=ge.IdentityFunction,ge.StatusArea=ge.IdentityFunction,ge["Charting`DelayedMouseEffect"]=ge.IdentityFunction,be.Line=async(e,t)=>{const r=await interpretate(e[0],t);if(r[0][0]){const e=t.svg.append("g");return e.attr("fill","none").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth),r.forEach((r=>{e.append("path").datum(r.map((e=>t.vertices[e-1]))).attr("vector-effect","non-scaling-stroke").attr("d",he.line().x((function(e){return e[0]})).y((function(e){return e[1]})))})),e}{const e=t.svg.append("path").datum(r.map((e=>t.wgl.fallbackVertices[e-1]))).attr("fill","none").attr("vector-effect","non-scaling-stroke").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",he.line().x((function(e){return e[0]})).y((function(e){return e[1]})));return t.dasharray&&e.attr("stroke-dasharray",t.dasharray.join()),e}},ge.SplineKnots=()=>"SplineKnots",ge.SplineDegree=()=>"SplineDegree",ge.BSplineCurve=async(e,t)=>{const r=await core._getRules(e,t);let n=await interpretate(e[0],t);const o=t.xAxis,a=t.yAxis,i=n.map((e=>3===e.length?{x:e[0],y:e[1],w:e[2]}:{x:e[0],y:e[1],w:1}));let s=r.SplineDegree;"number"!=typeof s&&(s=3);const l=i.length-1,c=s;let u=r.SplineKnots;function d(e,t,r,n){if(0===t)return n[e]<=r&&r<n[e+1]?1:0;const o=n[e+t]-n[e],a=n[e+t+1]-n[e+1];return(o?(r-n[e])/o*d(e,t-1,r,n):0)+(a?(n[e+t+1]-r)/a*d(e+1,t-1,r,n):0)}function f(e){let t={x:0,y:0},r=0;for(let n=0;n<=l;n++){const o=d(n,c,e,u)*i[n].w;t.x+=o*i[n].x,t.y+=o*i[n].y,r+=o}return[o(t.x/r),a(t.y/r)]}Array.isArray(u)||(u=(()=>{const e=l+c+1;let t=[];for(let r=0;r<=e;r++)r<=c?t.push(0):r>=e-c?t.push(1):t.push((r-c)/(e-2*c));return t})());const p=he.path(),m=t.steps||100;for(let e=0;e<=m;e++){const t=f(u[c]+(u[l+1]-u[c])*e/m);0===e?p.moveTo(...t):p.lineTo(...t)}return t.svg.append("path").attr("fill","none").attr("vector-effect","non-scaling-stroke").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",p)},ge.BezierCurve=async(e,t)=>{let r=await interpretate(e[0],t);var n=he.path();const o=t.xAxis,a=t.yAxis;r=r.map((e=>[o(e[0]),a(e[1])])),n.moveTo(...r[0]);let i=r.length-1;for(let e=1;e<r.length-2;e+=3)i-=3,n.bezierCurveTo(...r[e],...r[e+1],...r[e+2]);return i>0&&n.quadraticCurveTo(...r[r.length-2],...r[r.length-1]),t.svg.append("path").attr("fill","none").attr("vector-effect","non-scaling-stroke").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",n)},ge.Line=async(e,t)=>{t.offset;let r=await interpretate(e[0],t);r instanceof NumericArrayObject&&(r=r.normal());const n=t.xAxis,o=t.yAxis,a=uuidv4();let i;switch(t.local.uid=a,t.local.uid=a,me(r)){case 0:i=t.svg.append("path").datum([]).attr("class","line-"+a).attr("fill","none").attr("vector-effect","non-scaling-stroke").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",he.line().x((function(e){return n(e[0])})).y((function(e){return o(e[1])}))),t.dasharray&&i.attr("stroke-dasharray",t.dasharray.join());break;case 2:if(t.returnPath)throw i=null,"Not implemented!";i=t.svg.append("path").datum(r).attr("class","line-"+a).attr("vector-effect","non-scaling-stroke").attr("fill","none").attr("opacity",t.opacity).attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",he.line().x((function(e){return n(e[0])})).y((function(e){return o(e[1])}))),t.dasharray&&i.attr("stroke-dasharray",t.dasharray.join());break;case 3:console.log(r),r.forEach(((e,r)=>{i=t.svg.append("path").datum(e).join("path").attr("class","line-"+a+"-"+r).attr("vector-effect","non-scaling-stroke").attr("fill","none").attr("stroke",t.color).attr("stroke-width",t.strokeWidth).attr("d",he.line().x((function(e){return n(e[0])})).y((function(e){return o(e[1])}))),t.dasharray&&i.attr("stroke-dasharray",t.dasharray.join())}))}return t.local.nsets=r.length,t.local.line=he.line().x((function(e){return t.xAxis(e[0])})).y((function(e){return t.yAxis(e[1])})),t.local.object=i,t.colorRefs&&(t.colorRefs[t.root.uid]=t.root),i},ge.Line.updateColor=(e,t)=>{t.local.object.style("stroke",t.color)},ge.Line.update=async(e,t)=>{let r=await interpretate(e[0],t);r instanceof NumericArrayObject&&(r=r.normal());const n=t.xAxis,o=t.yAxis;let a;switch(me(r)){case 0:a=t.svg.selectAll(".line-"+t.local.uid).datum([]).attr("class","line-"+t.local.uid).maybeTransitionTween(t.transitionType,t.transitionDuration,"d",(function(e){var r=he.select(this).attr("d"),n=t.local.line(e);return ye(r,n)}));break;case 2:Math.min(r.length,t.local.nsets),a=t.svg.selectAll(".line-"+t.local.uid).datum(r).attr("class","line-"+t.local.uid).maybeTransitionTween(t.transitionType,t.transitionDuration,"d",(function(e){var r=he.select(this).attr("d"),n=t.local.line(e);return ye(r,n)}));break;case 3:for(let e=0;e<Math.min(r.length,t.local.nsets);++e)console.log("upd 1"),a=t.svg.selectAll(".line-"+t.local.uid+"-"+e).datum(r[e]).attr("class","line-"+t.local.uid+"-"+e).maybeTransitionTween(t.transitionType,t.transitionDuration,"d",(function(e){var r=he.select(this).attr("d"),n=t.local.line(e);return ye(r,n)}));if(r.length>t.local.nsets){console.log("upd 2"),console.log("new lines");for(let e=t.local.nsets;e<r.length;++e)a=t.svg.append("path").datum(r[e]).attr("class","line-"+t.local.uid+"-"+e).attr("fill","none").attr("stroke",t.color).attr("stroke-width",t.strokeWidth).maybeTransition(t.transitionType,t.transitionDuration).attr("d",he.line().x((function(e){return n(e[0])})).y((function(e){return o(e[1])})))}if(r.length<t.local.nsets){console.log("upd 3");for(let e=r.length;e<t.local.nsets;++e)a=t.svg.selectAll(".line-"+t.local.uid+"-"+e).datum(r[0]).join("path").attr("class","line-"+t.local.uid+"-"+e).maybeTransition(t.transitionType,t.transitionDuration).attr("d",t.local.line)}}return t.local.nsets=Math.max(r.length,t.local.nsets),a},ge.Line.virtual=!0,ge.Line.destroy=(e,t)=>{console.log("nothing to destroy"),t.local&&t.local.object&&(Array.isArray(t.local.object)?t.local.object.forEach((e=>e.remove())):t.local.object.remove(),delete t.local.object)},ge.Circle=async(e,t)=>{let r=await interpretate(e[0],t);r instanceof NumericArrayObject&&(r=r.normal());let n=[1,1];e.length>1&&(n=await interpretate(e[1],t),Array.isArray(n)||(n=[n,n]));const o=t.xAxis,a=t.yAxis;t.local.coords=[o(r[0]),a(r[1])],t.local.r=[o(n[0])-o(0),Math.abs(a(n[1])-a(0))];const i=t.svg.append("ellipse").attr("vector-effect","non-scaling-stroke").attr("cx",o(r[0])).attr("cy",a(r[1])).attr("rx",t.local.r[0]).attr("ry",t.local.r[1]).style("stroke",t.color).attr("vector-effect","non-scaling-stroke").attr("stroke-width",t.strokeWidth).style("fill","none").style("opacity",t.opacity);return t.local.object=i,t.dasharray&&i.attr("stroke-dasharray",t.dasharray.join()),t.colorRefs&&(t.colorRefs[t.root.uid]=t.root),t.opacityRefs&&(t.opacityRefs[t.root.uid]=t.root),i},ge.Circle.updateColor=(e,t)=>{t.local.object.style("stroke",t.color)},ge.Circle.updateOpacity=(e,t)=>{t.local.object.style("opacity",t.opacity)},ge.Circle.update=async(e,t)=>{let r=await interpretate(e[0],t);r instanceof NumericArrayObject&&(r=r.normal());let n=1;e.length>1&&(n=await interpretate(e[1],t),Array.isArray(n)||(n=[n,n]));const o=t.xAxis,a=t.yAxis;return t.local.r=[o(n[0])-o(0),Math.abs(a(n[1])-a(0))],t.local.object.maybeTransition(t.transitionType,t.transitionDuration).attr("cx",o(r[0])).attr("cy",a(r[1])).attr("rx",t.local.r[0]).attr("ry",t.local.r[1]),t.local.object},ge.Circle.destroy=(e,t)=>{t.local.object.remove(),t.colorRefs&&delete t.colorRefs[t.root.uid],t.opacityRefs&&delete t.opacityRefs[t.root.uid]},ge.Circle.virtual=!0;const Ce=function(e){return 180*e/Math.PI},Re=function(e){return e*Math.PI/180};function Pe(e,t,r,n,o,a){const{abs:i,sin:s,cos:l}=Math,c=i(r)*l(a),u=i(n)*s(a);return[e+l(o)*c-s(o)*u,t+s(o)*c+l(o)*u]}function Oe([e,t],[r,n]){const{acos:o,sqrt:a}=Math;return(e*n-t*r<0?-1:1)*o((e*r+t*n)/(a(e*e+t*t)*a(r*r+n*n)))}ge.Annulus=async(e,t)=>{let r=await interpretate(e[0],t),n=await interpretate(e[1],t);Array.isArray(n)||(n=[n,n]);let o=(await interpretate(e[2],t)).map((e=>2*Math.PI-e));const a=t.xAxis,i=t.yAxis,[s,l]=n,c=a(s)-a(0),u=Math.abs(i(s)-i(0)),d=a(l)-a(0),f=Math.abs(i(l)-i(0)),p=a(r[0]),m=i(r[1]),[h,y]=o,g=y-h>Math.PI?0:1,b=[`M ${p+c*Math.cos(h)} ${m+u*Math.sin(h)}`,`A ${c} ${u} 0 ${g} 0 ${p+c*Math.cos(y)} ${m+u*Math.sin(y)}`,`L ${p+d*Math.cos(y)} ${m+f*Math.sin(y)}`,`A ${d} ${f} 0 ${g} 1 ${p+d*Math.cos(h)} ${m+f*Math.sin(h)}`,"Z"].join(" ");return t.svg.append("path").attr("vector-effect","non-scaling-stroke").style("fill",t.color).style("opacity",t.opacity).attr("d",b)},ge._arc=async(e,t)=>{let r=await interpretate(e[0],t),n=await interpretate(e[1],t);Array.isArray(n)||(n=[n,n]);let o=(await interpretate(e[2],t)).map((e=>2*Math.PI-e));const a=t.xAxis,i=t.yAxis,s={cx:a(r[0]),cy:i(r[1]),phi:0,rx:a(n[0])-a(0),ry:Math.abs(i(n[1])-i(0)),start:o[0],delta:o[1]-o[0]},{x1:l,y1:c,x2:u,y2:d,fa:f,fs:p}=function(e,t,r,n,o,a,i){const[s,l]=Pe(e,t,r,n,o,a),[c,u]=Pe(e,t,r,n,o,a+i);return{x1:s,y1:l,x2:c,y2:u,fa:Math.abs(i)>Math.PI?1:0,fs:i>0?1:0}}(s.cx,s.cy,s.rx,s.ry,s.phi,s.start,s.delta),{cx:m,cy:h,theta:y,dTheta:g}=function(e,t,r,n,o,a,i,s,l){const{abs:c,sin:u,cos:d,sqrt:f}=Math,p=e=>Math.pow(e,2),m=u(l),h=d(l),y=h*(e-r)/2+m*(t-n)/2,g=-m*(e-r)/2+h*(t-n)/2,b=p(y),x=p(g),_=p(i),v=p(s),w=b/_+x/v;w>1?(i=f(w)*c(i),s=f(w)*c(s)):(i=c(i),s=c(s));const A=o===a?-1:1,k=f((_*v-_*x-v*b)/(_*x+v*b))*A,T=k*(i*g)/s,E=k*(-s*y)/i,F=h*T-m*E+(e+r)/2,S=m*T+h*E+(t+n)/2,C=Oe([1,0],[(y-T)/i,(g-E)/s]);let R=Ce(Oe([(y-T)/i,(g-E)/s],[(-y-T)/i,(-g-E)/s]))%360;return 0===a&&R>0&&(R-=360),1===a&&R<0&&(R+=360),{cx:F,cy:S,theta:C,dTheta:Re(R)}}(l,c,u,d,f,p,s.rx,s.ry,s.phi);return t.svg.append("path").attr("vector-effect","non-scaling-stroke").style("fill",t.color).style("stroke",t.stroke).style("stroke-width",t.strokeWidth).style("opacity",t.opacity).attr("d",`M ${m} ${h}\n         L ${l} ${c}\n         A ${s.rx} ${s.ry} ${Ce(s.phi)} ${f} ${p} ${u} ${d}\n         Z`)},be.Disk=async(e,t)=>{if(e.length>2)throw"Graphics complex with arcs is not supported";let r=await interpretate(e[0],t),n=1;e.length>1&&(n=await interpretate(e[1],t),Array.isArray(n)&&(n=(n[0]+n[1])/2));const o=t.xAxis;if(t.yAxis,r[0]){const e=[],a=o(n)-o(0);return r.map((e=>t.wgl.fallbackVertices[e-1])).map((r=>{e.push(t.svg.append("circle").attr("vector-effect","non-scaling-stroke").attr("cx",r[0]).attr("cy",r[1]).attr("r",a).style("stroke","none").style("fill",t.color).style("opacity",t.opacity))})),e}{const e=t.wgl.fallbackVertices[r-1],a=[e[0],e[1]],i=o(n)-o(0);return t.svg.append("circle").attr("vector-effect","non-scaling-stroke").attr("cx",a[0]).attr("cy",a[1]).attr("r",i).style("stroke","none").style("fill",t.color).style("opacity",t.opacity)}},ge.Disk=async(e,t)=>{if(e.length>2)return await ge._arc(e,t);let r=await interpretate(e[0],t);r instanceof NumericArrayObject&&(r=r.normal());let n=[1,1];e.length>1&&(n=await interpretate(e[1],t),Array.isArray(n)||(n=[n,n]));const o=t.xAxis,a=t.yAxis;t.local.coords=[o(r[0]),a(r[1])],t.local.r=[o(n[0])-o(0),Math.abs(a(n[1])-a(0))];const i=t.svg.append("ellipse").attr("vector-effect","non-scaling-stroke").attr("cx",o(r[0])).attr("cy",a(r[1])).attr("rx",t.local.r[0]).attr("ry",t.local.r[1]).style("stroke",t.stroke).attr("stroke-width",t.strokeWidth).style("fill",t.color).style("opacity",t.opacity);return t.local.object=i,t.colorRefs&&(t.colorRefs[t.root.uid]=t.root),t.opacityRefs&&(t.opacityRefs[t.root.uid]=t.root),i},ge.Disk.update=async(e,t)=>{let r=await interpretate(e[0],t);r instanceof NumericArrayObject&&(r=r.normal());let n=t.local.r;e.length>1&&(n=await interpretate(e[1],t),Array.isArray(n)||(n=[n,n]));const o=t.xAxis,a=t.yAxis;t.local.coords=[o(r[0]),a(r[1])],t.local.r=[o(n[0])-o(0),Math.abs(a(n[1])-a(0))],t.local.object.maybeTransition(t.transitionType,t.transitionDuration).attr("cx",t.local.coords[0]).attr("cy",t.local.coords[1]).attr("rx",t.local.r[0]).attr("ry",t.local.r[1])},ge.Disk.updateColor=(e,t)=>{t.local.object.style("fill",t.color)},ge.Disk.updateOpacity=(e,t)=>{t.local.object.style("opacity",t.opacity)},ge.Disk.virtual=!0,ge.Disk.destroy=(e,t)=>{console.log("nothing to destroy"),t.local&&t.local.object&&(t.colorRefs&&delete t.colorRefs[t.root.uid],t.opacityRefs&&delete t.opacityRefs[t.root.uid],t.local.object.remove(),delete t.local.object)},be.Point=async(e,t)=>{let r=await interpretate(e[0],t),n=he.color(t.color);if(n=[n.r/255,n.g/255,n.b/255,t.opacity],r[0][0])return;const{gl:o,programInfo:a}=t.wgl;let i;i=Ee.createBufferInfoFromArrays(o,{indices:r.flat(1/0).map((e=>e-1))}),Ee.setBuffersAndAttributes(o,a,i),Ee.setUniforms(a,{u_resolution:[o.canvas.width,o.canvas.height],u_color:n,u_pointSize:t.pointSize*window.devicePixelRatio*100*2,u_vertexColor:Boolean(t.wgl.vertexColors)}),o.drawElements(o.POINTS,i.numElements,o.UNSIGNED_SHORT,0)},ge.Point=async(e,t)=>{let r=await interpretate(e[0],t);r instanceof NumericArrayObject&&(r=r.normal());const n=t.xAxis,o=t.yAxis,a=me(r);0===a?r=[]:a<2&&(r=[r]);const i=uuidv4();t.local.uid=i;const s=t.svg.append("g").style("stroke-width",100*t.pointSize*2).style("stroke-linecap","round").style("stroke",t.color).style("opacity",t.opacity);t.colorRefs&&(t.colorRefs[t.root.uid]=t.root),t.opacityRefs&&(t.opacityRefs[t.root.uid]=t.root);const l=[];return r.forEach(((e,t)=>{l.push(s.append("path").attr("d",`M ${n(e[0])} ${o(e[1])} l 0.0001 0`).attr("vector-effect","non-scaling-stroke"))})),t.local.points=l,t.local.object=s,s},ge.Point.updateColor=(e,t)=>{t.local.object.style("stroke",t.color)},ge.Point.updateOpacity=(e,t)=>{t.local.object.style("opacity",t.opacity)},ge.Point.update=async(e,t)=>{let r=await interpretate(e[0],t);r instanceof NumericArrayObject&&(r=r.normal());const n=me(r);0===n?r=[]:n<2&&(r=[r]);const o=t.xAxis,a=t.yAxis;let i;const s=t.local.object,l=Math.min(t.local.points.length,r.length);let c=[0,0];for(let e=t.local.points.length;e<r.length;e++)e-1>=0&&(c=r[e-1]),i=s.append("path").attr("d",`M ${o(c[0])} ${a(c[1])} l 0.0001 0`).style("opacity",t.opacity/5).attr("vector-effect","non-scaling-stroke"),t.local.points.push(i),i=i.maybeTransition(t.transitionType,t.transitionDuration).attr("d",`M ${o(r[e][0])} ${a(r[e][1])} l 0.0001 0`).style("opacity",t.opacity);for(let e=t.local.points.length;e>r.length;e--)i=t.local.points.pop(),i.maybeTransition(t.transitionType,t.transitionDuration).style("opacity",0).remove();for(let e=0;e<l;e++)i=t.local.points[e].maybeTransition(t.transitionType,t.transitionDuration).attr("d",`M ${o(r[e][0])} ${a(r[e][1])} l 0.0001 0`);return i},ge.Point.virtual=!0,ge.Point.destroy=(e,t)=>{console.log("nothing to destroy"),t.local&&t.local.object&&(t.colorRefs&&delete t.colorRefs[t.root.uid],Array.isArray(t.local.object)?t.local.object.forEach((e=>e.remove())):t.local.object.remove(),delete t.local.object)};ge.EventListener=async(e,t)=>{const r=await interpretate(e[1],t),n={...t};let o=await interpretate(e[0],n);return o?Array.isArray(o)&&(o=o[0]):o=(e=>{let t={k:1,x:0,y:0};e.onZoom.push((e=>{t=e}));const r={xAxis:e.xAxis,yAxis:e.yAxis};return e.xAxis=e=>0,e.yAxis=e=>0,e.xAxis.invert=n=>{const o=(n-t.x-e.panZoomEntites.left)/t.k;return r.xAxis.invert(o)},e.yAxis.invert=n=>{const o=(n-t.y-e.panZoomEntites.top)/t.k;return r.yAxis.invert(o)},e.panZoomEntites.canvas})(n),o.on_list||(o.on_list={}),r.forEach((e=>{ge.EventListener[e.lhs](e.rhs,o,n)})),null},ge.EventListener.update=async(e,t)=>{console.log("EventListener does not support updates")},ge.EventListener.onload=(e,t,r)=>{console.log("onload event generator"),server.kernel.emitt(e,"True","onload")},ge.MiddlewareListener=async(e,t)=>{const r=await core._getRules(e,t),n=await interpretate(e[1],t),o=await interpretate(e[2],t);return console.log(e),t.local.middleware=ge.MiddlewareListener[n](o,r,t),await interpretate(e[0],t)},ge.MiddlewareListener.update=(e,t)=>interpretate(e[0],t),ge.MiddlewareListener.end=(e,t,r)=>{const n=t.Threshold||1;return server.kernel.emitt(e,"True","end"),console.log("pre Fire"),t=>{let r=!1;return t.then((t=>t.tween(e,(function(t){return function(t){t>=n&&!r&&(server.kernel.emitt(e,"True","end"),r=!0)}}))))}},ge.MiddlewareListener.endtransition=ge.MiddlewareListener.end,ge.EventListener.drag=(e,t,r)=>{console.log("drag event generator"),console.log(r.local);const n=r.xAxis,o=r.yAxis;let a=[];const i=throttle(((t,r)=>{server.kernel.emitt(e,`{${t}, ${r}}`.replace("e","*^").replace("e","*^"),"drag")}));t.call(he.drag().on("start",(function(e,t){0===a.length&&(a=[e.x,e.y])})).on("drag",(function(e,t){he.select(this).raise().attr("transform",(t=>"translate("+[e.x-a[0],e.y-a[1]]+")")),i(n.invert(e.x),o.invert(e.y))})).on("end",(function(e,t){})))},ge.EventListener.dragall=(e,t,r)=>{console.log("drag event generator"),console.log(r.local);const n=r.xAxis,o=r.yAxis;const a=throttle(((t,r,n)=>{server.kernel.emitt(e,`{"${n}", {${t}, ${r}}}`.replace("e","*^").replace("e","*^"),"dragall")}));t.call(he.drag().on("start",(function(e,t){a(n.invert(e.x),o.invert(e.y),"dragstarted")})).on("drag",(function(e,t){a(n.invert(e.x),o.invert(e.y),"dragged")})).on("end",(function(e,t){a(n.invert(e.x),o.invert(e.y),"dragended")})))},ge.EventListener.click=(e,t,r)=>{console.log("click event generator"),console.log(r.local);const n=r.xAxis,o=r.yAxis,a=throttle(((t,r)=>{server.kernel.emitt(e,`{${t}, ${r}}`.replace("e","*^").replace("e","*^"),"click")}));function i(e,t){e.altKey||a(n.invert(t[0]),o.invert(t[1]))}t.classed("cursor-pointer",!0),"click"in t.on_list?t.on_list.click.push((e=>i(e,he.pointer(e)))):(t.on_list.click=[e=>i(e,he.pointer(e))],t.on("click",(e=>{for(let r=0;r<t.on_list.click.length;++r)t.on_list.click[r](e)})))},ge.EventListener.mousedown=(e,t,r)=>{console.log("mousedown event generator"),console.log(r.local);const n=r.xAxis,o=r.yAxis,a=throttle(((t,r)=>{server.kernel.emitt(e,`{${t}, ${r}}`.replace("e","*^").replace("e","*^"),"mousedown")}));t.on("mousedown",(e=>{return t=he.pointer(e),void a(n.invert(t[0]),o.invert(t[1]));var t}))},ge.EventListener.mouseup=(e,t,r)=>{console.log("mouseup event generator"),console.log(r.local);const n=r.xAxis,o=r.yAxis,a=throttle(((t,r)=>{server.kernel.emitt(e,`{${t}, ${r}}`.replace("e","*^").replace("e","*^"),"mouseup")}));t.on("mouseup",(e=>{return t=he.pointer(e),void a(n.invert(t[0]),o.invert(t[1]));var t}))},ge.EventListener.altclick=(e,t,r)=>{console.log("click event generator"),console.log(r.local);const n=r.xAxis,o=r.yAxis,a=throttle(((t,r)=>{server.kernel.emitt(e,`{${t}, ${r}}`.replace("e","*^").replace("e","*^"),"altclick")}));function i(e,t){e.altKey&&a(n.invert(t[0]),o.invert(t[1]))}"click"in t.on_list?t.on_list.click.push((e=>i(e,he.pointer(e)))):(t.on_list.click=[e=>i(e,he.pointer(e))],t.on("click",(e=>{for(let r=0;r<t.on_list.click.length;++r)t.on_list.click[r](e)})))},ge.EventListener.capturekeydown=(e,t,r)=>{let n,o=!0;const a=t;n=()=>{o&&(a.node().focus(),o=!1)};var i;i=n,"click"in t.on_list?t.on_list.click.push(i):(t.on_list.click=[i],t.on("click",(e=>{for(let r=0;r<t.on_list.click.length;++r)t.on_list.click[r](e)}))),a.on("blur",(()=>{o=!0})),a.node().addEventListener("keydown",(t=>{server.kernel.emitt(e,'"'+t.code+'"',"capturekeydown"),t.preventDefault()}))},ge.EventListener.keydown=(e,t,r)=>{let n,o=!0;const a=t;n=()=>{o&&(a.node().focus(),o=!1)};var i;i=n,"click"in t.on_list?t.on_list.click.push(i):(t.on_list.click=[i],t.on("click",(e=>{for(let r=0;r<t.on_list.click.length;++r)t.on_list.click[r](e)}))),a.on("blur",(()=>{o=!0})),a.addEventListener("keydown",(t=>{server.kernel.emitt(e,'"'+t.code+'"',"keydown")}))},ge.EventListener.mousemove=(e,t,r)=>{console.log("mouse event generator"),console.log(r.local);const n=r.xAxis,o=r.yAxis,a=throttle(((t,r)=>{server.kernel.emitt(e,`{${t}, ${r}}`.replace("e","*^").replace("e","*^"),"mousemove")}));t.on("mousemove",(e=>{return t=he.pointer(e),void a(n.invert(t[0]),o.invert(t[1]));var t}))},ge.EventListener.mouseover=(e,t,r)=>{console.log("mouse event generator"),console.log(r.local);const n=r.xAxis,o=r.yAxis,a=throttle(((t,r)=>{server.kernel.emitt(e,`{${t}, ${r}}`.replace("e","*^").replace("e","*^"),"mouseover")}));t.on("mouseover",(e=>{return t=he.pointer(e),void a(n.invert(t[0]),o.invert(t[1]));var t}))},ge.EventListener.zoom=(e,t,r)=>{console.log("zoom event generator"),console.log(r.local);const n=throttle((t=>{server.kernel.emitt(e,`${t}`,"zoom")}));t.call(he.zoom().on("zoom",(function(e){console.log(),n(e.transform.k)})))},ge.Rotate=async(e,t)=>{const r=await interpretate(e[1],t);let n;e.length>2&&(n=await interpretate(e[2],t),t.local.aligment=n);const o=t.svg.append("g");t.local.group=o,await interpretate(e[0],{...t,svg:o});let a=o.node().getBBox();n?(a.x=t.xAxis(n[0]),a.y=t.yAxis(n[1])):(a.x=a.x+a.width/2,a.y=a.y+a.height/2);const i="rotate("+r/Math.PI*180+", "+a.x+", "+a.y+")";o.attr("transform",i),t.local.rotation=i},ge.Rotate.update=async(e,t)=>{const r=await interpretate(e[1],t);let n;n=t.local.group.node().getBBox(),t.local.aligment?(n.x=t.xAxis(t.local.aligment[0]),n.y=t.yAxis(t.local.aligment[1])):(n.x=n.x+n.width/2,n.y=n.y+n.height/2);const o="rotate("+r/Math.PI*180+", "+n.x+", "+n.y+")";var a=he.interpolateString(t.local.rotation,o);t.local.group.maybeTransitionTween(t.transitionType,t.transitionDuration,"transform",(function(e,t,r){return a})),t.local.rotation=o},ge.Rotate.virtual=!0,ge.Rotate.destroy=(e,t)=>{console.log("nothing to destroy")},ge.GeometricTransformation=async(e,t)=>{let r=await interpretate(e[1],t);const n=t.svg.append("g");t.local.group=n;const o=t.xAxis,a=t.yAxis;return await interpretate(e[0],{...t,svg:n}),console.warn(r),2==r.length?(r[0][0][1]=-r[0][0][1],r[0][1][0]=-r[0][1][0],r[0]=r[0].flat(1/0),r[1]=[o(r[1][0])-o(0),a(r[1][1])-a(0)],n.attr("transform",`matrix(${r[0].join(",")},${r[1].join(",")})`)):(r[0][1]=-r[0][1],r[1][0]=-r[1][0],r=r.flat(1/0),n.attr("transform",`matrix(${r.join(",")})`))},ge.Translate=async(e,t)=>{const r=await interpretate(e[1],t),n=t.svg.append("g");t.local.group=n;const o=t.xAxis,a=t.yAxis;return await interpretate(e[0],{...t,svg:n}),n.attr("transform",`translate(${o(r[0])-o(0)}, ${a(r[1])-a(0)})`)},ge.Translate.update=async(e,t)=>{let r=await interpretate(e[1],t);r instanceof NumericArrayObject&&(r=r.normal());const n=t.xAxis,o=t.yAxis;return t.local.group.maybeTransition(t.transitionType,t.transitionDuration).attr("transform",`translate(${n(r[0])-n(0)}, ${o(r[1])-o(0)})`)},ge.Translate.virtual=!0,ge.Translate.destroy=(e,t)=>{console.log("nothing to destroy")},ge.Center=()=>"Center",ge.Center.update=ge.Center,ge.Degree=()=>Math.PI/180,ge.Degree.update=ge.Degree,ge.Rectangle=async(e,t)=>{let r=await interpretate(e[0],t),n=await interpretate(e[1],t);if(r instanceof NumericArrayObject&&(r=r.normal()),n instanceof NumericArrayObject&&(n=n.normal()),r[1]>n[1]){const e=r[1];r[1]=n[1],n[1]=e}if(r[0]>n[0]){const e=r[0];r[0]=n[0],n[0]=e}const o=t.xAxis,a=t.yAxis;r[0]=o(r[0]),r[1]=a(r[1]),n[0]=o(n[0]),n[1]=a(n[1]);const i=[Math.abs(n[0]-r[0]),Math.abs(n[1]-r[1])];return t.local.rect=t.svg.append("rect").attr("x",r[0]).attr("y",r[1]-i[1]).attr("width",i[0]).attr("height",i[1]).attr("vector-effect","non-scaling-stroke").attr("stroke",t.stroke).attr("stroke-width",t.strokeWidth).attr("opacity",t.opacity).attr("fill",t.color),t.dasharray&&t.local.rect.attr("stroke-dasharray",t.dasharray.join()),t.colorRefs&&(t.colorRefs[t.root.uid]=t.root),t.opacityRefs&&(t.opacityRefs[t.root.uid]=t.root),t.local.rect},ge.Rectangle.updateColor=(e,t)=>{t.local.rect.attr("fill",t.color)},ge.Rectangle.updateOpacity=(e,t)=>{t.local.rect.attr("opacity",t.opacity)},ge.Rectangle.update=async(e,t)=>{let r=await interpretate(e[0],t),n=await interpretate(e[1],t);if(r instanceof NumericArrayObject&&(r=r.normal()),n instanceof NumericArrayObject&&(n=n.normal()),r[1]>n[1]){const e=r[1];r[1]=n[1],n[1]=e}if(r[0]>n[0]){const e=r[0];r[0]=n[0],n[0]=e}const o=t.xAxis,a=t.yAxis;r[0]=o(r[0]),r[1]=a(r[1]),n[0]=o(n[0]),n[1]=a(n[1]);const i=[Math.abs(n[0]-r[0]),Math.abs(n[1]-r[1])];t.local.rect.maybeTransition(t.transitionType,t.transitionDuration).attr("x",r[0]).attr("y",r[1]-i[1]).attr("width",i[0]).attr("height",i[1])},ge.Rectangle.virtual=!0,ge.Rectangle.destroy=(e,t)=>{console.log("nothing to destroy"),t.local&&t.local.rect&&(t.colorRefs&&delete t.colorRefs[t.root.uid],t.opacityRefs&&delete t.opacityRefs[t.root.uid],t.local.rect.remove(),delete t.local.rect)},ge.Void=(e,t)=>{},ge.Identity=ge.Void,ge.Scaled=async(e,t)=>{if(1==e.length){const r=await interpretate(e[0],t);return[r[0]*(t.plotRange[0][1]-t.plotRange[0][0])+t.plotRange[0][0],r[1]*(t.plotRange[1][1]-t.plotRange[1][0])+t.plotRange[1][0]]}{const r=await interpretate(e[0],t),n=await interpretate(e[1],t);return[r[0]*(t.plotRange[0][1]-t.plotRange[0][0])+n[0],r[1]*(t.plotRange[1][1]-t.plotRange[1][0])+n[1]]}},ge.Scaled.update=ge.Scaled,ge.GoldenRatio=ge.Void,ge.None=()=>!1,ge.AbsolutePointSize=ge.Void,ge.CopiedValueFunction=ge.Void,ge.Raster=async(e,t)=>{if(t.image)return await interpretate(e[0],t);const r=await interpretate(e[0],{...t,context:ge,nfast:!0,numeric:!0});console.log(e);const n=r.length,o=r[0].length,a=r[0][0].length,i=t.xAxis,s=t.yAxis;let l=[[0,o],[0,n]];if(e.length>1){const r=await interpretate(e[1],t);l[0][0]=r[0][0],l[0][1]=r[1][0],l[1][0]=r[0][1],l[1][1]=r[1][1]}e.length>2&&(await interpretate(e[2],t),console.warn("scaling is not implemented!"));const c=Math.abs((i(l[0][1])-i(l[0][0]))/o),u=Math.abs((s(l[1][1])-s(l[1][0]))/n),d=(l[0][1]-l[0][0])/o,f=(l[1][1]-l[1][0])/n,p=t.svg;if(a)if(2!==a)if(3!==a)if(4!==a);else for(let e=0;e<n;++e)for(let t=0;t<o;++t)p.append("rect").attr("x",i(d*t+l[0][0])).attr("y",s(f*e+l[1][0])-u).attr("width",c).attr("height",u).attr("opacity",r[e][t][3]).attr("fill",`rgb(${Math.floor(255*r[e][t][0])}, ${Math.floor(255*r[e][t][1])}, ${Math.floor(255*r[e][t][2])})`);else for(let e=0;e<n;++e)for(let n=0;n<o;++n)p.append("rect").attr("x",i(d*n+l[0][0])).attr("y",s(f*e+l[1][0])-u).attr("width",c).attr("height",u).attr("opacity",t.opacity).attr("fill",`rgb(${Math.floor(255*r[e][n][0])}, ${Math.floor(255*r[e][n][1])}, ${Math.floor(255*r[e][n][2])})`);else for(let e=0;e<n;++e)for(let t=0;t<o;++t)p.append("rect").attr("x",i(d*t+l[0][0])).attr("y",s(f*e+l[1][0])-u).attr("width",c).attr("height",u).attr("opacity",r[e][t][1]).attr("fill",`rgb(${Math.floor(255*r[e][t][0])}, ${Math.floor(255*r[e][t][0])}, ${Math.floor(255*r[e][t][0])})`);else for(let e=0;e<n;++e)for(let n=0;n<o;++n)p.append("rect").attr("x",i(d*n+l[0][0])).attr("y",s(f*e+l[1][0])-u).attr("width",c).attr("height",u).attr("opacity",t.opacity).attr("fill",`rgb(${Math.floor(255*r[e][n])}, ${Math.floor(255*r[e][n])}, ${Math.floor(255*r[e][n])})`)},ge.Magnification=()=>"Magnification",ge.ColorSpace=()=>"ColorSpace",ge.Interleaving=()=>"Interleaving",ge.MetaInformation=()=>"MetaInformation",ge.ImageResolution=()=>"ImageResolution",ge.DateObject=()=>{console.warn("Date Object is not supported for now")};const Ie={TypeReal:{},TypeInteger:{}},Le={Real64:{context:Ie.TypeReal,constructor:Float64Array},Real32:{context:Ie.TypeReal,constructor:Float32Array},Integer32:{context:Ie.TypeInteger,constructor:Int32Array},Integer64:{context:Ie.TypeInteger,constructor:BigInt64Array},Integer16:{context:Ie.TypeInteger,constructor:Int16Array},Integer8:{context:Ie.TypeInteger,constructor:Int8Array},UnsignedInteger32:{context:Ie.TypeInteger,constructor:Uint32Array},UnsignedInteger64:{context:Ie.TypeInteger,constructor:BigUint64Array},UnsignedInteger16:{context:Ie.TypeInteger,constructor:Uint16Array},UnsignedInteger8:{context:Ie.TypeInteger,constructor:Uint8Array}};function ze(e,t=[]){return Array.isArray(e)?(t.push(e.length),ze(e[0],t)):t}const Be=new RegExp(/^(-?\d+)(.?\d*)(\*\^)?(\d*)/),Me=window.isNumeric;function De(e,t){if(Array.isArray(e[1]))for(let r=1;r<e.length;++r)De(e[r],t);else t.array.set(e.slice(1).map((e=>{if("string"==typeof e){if(Me(e))return parseInt(e);if(Be.test(e)){let[t,r,n,o,a]=e.split(Be);return r+="."===n?n+"0":n,o&&(r+="E"+a),parseFloat(r)}}return e})),t.index),t.index+=e.length-1}function je(e,t,r){var n,o=0;for(n=0;n<r<<2;)t[n++]=255*e[o++]>>>0,t[n++]=255*e[o++]>>>0,t[n++]=255*e[o++]>>>0,t[n++]=255*e[o++]>>>0}function Ne(e,t,r){var n,o=0;const a=new Uint32Array(t.buffer);for(n=0;n<r;n++)a[n]=4278190080+(255*e[o++]>>>0)+(255*e[o++]>>>0<<8)+(255*e[o++]>>>0<<16)}function Ue(e,t,r){var n,o=0;const a=new Uint32Array(t.buffer);for(n=0;n<r;n++)a[n]=4278190080+(255*e[o++]>>>0)+(255*e[o++]>>>0<<8)}function Ve(e,t,r){var n;const o=new Uint32Array(t.buffer);for(n=0;n<r;n++){const t=255*e[n]>>>0;o[n]=4278190080+(t<<16)+(t<<8)+t}}Ie.NumericArray=(e,t)=>{const r=Le[interpretate(e[1])],n=[];let o=e[0].length-1;n.push(o),"List"===e[0][1][0]&&(o*=e[0][1].length-1,n.push(e[0][1].length-1),"List"===e[0][1][1][0]&&(o*=e[0][1][1].length-1,n.push(e[0][1][1].length-1)));const a=new r.constructor(o);return De(e[0],{index:0,array:a}),{buffer:a,dims:n}},Ie.NumericArray.update=Ie.NumericArray;const Ge={Byte:{constructor:Uint8Array,convert:e=>{if(3===e.dims.length){if(4===e.dims[2]){return new Uint8ClampedArray(e.buffer)}if(3===e.dims[2]){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return function(e,t,r){var n,o=0;const a=new Uint32Array(t.buffer);for(n=0;n<r;n++)a[n]=4278190080+e[o++]+(e[o++]<<8)+(e[o++]<<16)}(e.buffer,r,t),r}if(2===e.dims[2]){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return function(e,t,r){var n,o=0;const a=new Uint32Array(t.buffer);for(n=0;n<r;n++)a[n]=4278190080+e[o++]+(e[o++]<<8)}(e.buffer,r,t),r}throw console.error(e),"It must be RGB or RGBA or RG!"}if(2===e.dims.length){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return function(e,t,r){var n;const o=new Uint32Array(t.buffer);for(n=0;n<r;n++){const t=e[n];o[n]=4278190080+(t<<16)+(t<<8)+t}}(e.buffer,r,t),r}throw"This is not an image data!"}},Bit:{constructor:Uint8Array,convert:e=>{const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return function(e,t,r){var n;const o=new Uint32Array(t.buffer);for(n=0;n<r;n++){const t=e[n]<<8;o[n]=4278190080+(t<<16)+(t<<8)+t}}(e.buffer,r,t),r}},Real32:{constructor:Float32Array,convert:e=>{if(3===e.dims.length){if(4===e.dims[2]){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return je(e.buffer,r,t),r}if(3===e.dims[2]){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return Ne(e.buffer,r,t),r}if(2===e.dims[2]){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return Ue(e.buffer,r,t),r}throw console.error(e),"It must be RGB or RGBA or RG!"}if(2===e.dims.length){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return Ve(e.buffer,r,t),r}throw"This is not an image data!"},convert_nonInterleaved:e=>{if(3===e.dims[0]){const t=e.dims[2]*e.dims[1],r=new Uint8ClampedArray(t<<2);return function(e,t,r){const n=new Uint32Array(t.buffer),o=r,a=2*r;for(let t=0;t<r;t++){const r=255*e[t]>>>0,i=255*e[o+t]>>>0,s=255*e[a+t]>>>0;n[t]=4278190080+r+(i<<8)+(s<<16)}}(e.buffer,r,t),r}throw"convert_nonInterleaved has a limited support"}},Real64:{contructor:Float64Array,convert:e=>{if(3===e.dims.length){if(4===e.dims[2]){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return je(e.buffer,r,t),r}if(3===e.dims[2]){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return Ne(e.buffer,r,t),r}if(2===e.dims[2]){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return Ue(e.buffer,r,t),r}throw console.error(e),"It must be RGB or RGBA!"}if(2===e.dims.length){const t=e.dims[0]*e.dims[1],r=new Uint8ClampedArray(t<<2);return Ve(e.buffer,r,t),r}throw"This is not an image data!"}}};ge.Antialiasing=()=>"Antialiasing",ge.Image=async(e,t)=>{const r=await core._getRules(e,{...t,context:ge,hold:!0});let n,o=await interpretate(e[0],{...t,context:[Ie,ge]}),a="Real32";e.length-Object.keys(r).length>1&&(a=interpretate(e[1])),a=Ge[a];let i,s,l=!0;"Interleaving"in r&&(l=interpretate(r.Interleaving,{})),Array.isArray(o)&&(console.warn("Will be slow. Not a typed array"),o={buffer:o.flat(1/0),dims:ze(o)}),l?(console.warn(a),n=a.convert(o)):n=a.convert_nonInterleaved(o),t.local.type=a,console.log("ImageSize"),console.log(o.dims),l?(s=o.dims[0],i=o.dims[1]):(s=o.dims[1],i=o.dims[2]),t.local.interleaving=l,t.local.dims=o.dims,n=new ImageData(new Uint8ClampedArray(n),i,s);let c=r.ImageSize;if(c=await interpretate(r.ImageSize,{...t,context:ge}),r.Magnification){const e=await interpretate(r.Magnification,{...t,context:ge});c=Math.floor(i*e)}c||(c=t.imageSize?t.imageSize:i),Array.isArray(c)?"number"!=typeof c[0]&&(c=[i,s]):"number"!=typeof c&&(c=i),Array.isArray(c)&&(c=c[0]);const u=Math.floor(c),d=Math.floor(s/i*c);let f;console.warn("ImageSize"),console.warn({target_width:u,target_height:d}),t.local.targetDims=[d,u];const p=window.devicePixelRatio;var m=document.createElement("canvas");return m.width=u,m.height=d,t.offscreen||t.element.appendChild(m),m.style.width=u/p+"px",m.style.height=d/p+"px",f=m.getContext("2d"),t.local.ctx=f,"Antialiasing"in r&&(f.imageSmoothingEnabled=await interpretate(r.Antialiasing,{...t,context:ge})),u!=i||d!=s?(t.local.resized=!0,console.warn("Resizing might be slow"),n=await createImageBitmap(n),f.drawImage(n,0,0,u,d)):f.putImageData(n,0,0),r.Epilog&&interpretate(r.Epilog,{...t,context:ge}),m},ge.Image.update=async(e,t)=>{let r=await interpretate(e[0],{...t,context:[Ie,ge]});if(Array.isArray(r)&&(console.warn("Image:update: not a typed array. It will be slow..."),r={buffer:r.flat(1/0),dims:ze(r)}),!t.local.interleaving)throw"Update with no interleaving is not supported!";let n=t.local.type.convert(r);n=new ImageData(new Uint8ClampedArray(n),t.local.dims[1],t.local.dims[0]),t.local.resized?(n=await createImageBitmap(n),t.local.ctx.clearRect(0,0,t.local.targetDims[1],t.local.targetDims[0]),t.local.ctx.drawImage(n,0,0,t.local.targetDims[1],t.local.targetDims[0])):t.local.ctx.putImageData(n,0,0)},ge.Image.destroy=(e,t)=>{},ge.Image.virtual=!0,ge.Graphics.virtual=!0,ge.GraphicsGroupBox=ge.GraphicsGroup,ge.GraphicsComplexBox=ge.GraphicsComplex,ge.DiskBox=ge.Disk,ge.LineBox=ge.Line;
/* @license twgl.js 5.5.3 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */
const He=5120,$e=5121,We=5122,Xe=5123,Ze=5124,Ye=5125,Ke=5126,qe={};{const e=qe;e[5120]=Int8Array,e[5121]=Uint8Array,e[5122]=Int16Array,e[5123]=Uint16Array,e[5124]=Int32Array,e[5125]=Uint32Array,e[5126]=Float32Array,e[32819]=Uint16Array,e[32820]=Uint16Array,e[33635]=Uint16Array,e[5131]=Uint16Array,e[33640]=Uint32Array,e[35899]=Uint32Array,e[35902]=Uint32Array,e[36269]=Uint32Array,e[34042]=Uint32Array}function Je(e){if(e instanceof Int8Array)return He;if(e instanceof Uint8Array)return $e;if(e instanceof Uint8ClampedArray)return $e;if(e instanceof Int16Array)return We;if(e instanceof Uint16Array)return Xe;if(e instanceof Int32Array)return Ze;if(e instanceof Uint32Array)return Ye;if(e instanceof Float32Array)return Ke;throw new Error("unsupported typed array type")}function Qe(e){if(e===Int8Array)return He;if(e===Uint8Array)return $e;if(e===Uint8ClampedArray)return $e;if(e===Int16Array)return We;if(e===Uint16Array)return Xe;if(e===Int32Array)return Ze;if(e===Uint32Array)return Ye;if(e===Float32Array)return Ke;throw new Error("unsupported typed array type")}function et(e){const t=qe[e];if(!t)throw new Error("unknown gl type");return t}const tt="undefined"!=typeof SharedArrayBuffer?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};var rt=Object.freeze({__proto__:null,getGLTypeForTypedArray:Je,getGLTypeForTypedArrayType:Qe,getTypedArrayTypeForGLType:et,isArrayBuffer:tt});function nt(e,t){Object.keys(t).forEach((function(r){t.hasOwnProperty(r)&&e.hasOwnProperty(r)&&(t[r]=e[r])}))}function ot(...e){console.error(...e)}function at(...e){console.warn(...e)}const it=new Map;function st(e,t){if(!e||"object"!=typeof e)return!1;let r=it.get(t);r||(r=new WeakMap,it.set(t,r));let n=r.get(e);if(void 0===n){const o=Object.prototype.toString.call(e);n=o.substring(8,o.length-1)===t,r.set(e,n)}return n}function lt(e,t){return"undefined"!=typeof WebGLRenderbuffer&&st(t,"WebGLRenderbuffer")}function ct(e,t){return"undefined"!=typeof WebGLTexture&&st(t,"WebGLTexture")}const ut=34962,dt={attribPrefix:""};function ft(e){dt.attribPrefix=e}function pt(e){nt(e,dt)}function mt(e,t,r,n,o){e.bindBuffer(t,r),e.bufferData(t,n,o||35044)}function ht(e,t,r,n){if(o=t,"undefined"!=typeof WebGLBuffer&&st(o,"WebGLBuffer"))return t;var o;r=r||ut;const a=e.createBuffer();return mt(e,r,a,t,n),a}function yt(e){return"indices"===e}function gt(e){return e.length?e:e.data}const bt=/coord|texture/i,xt=/color|colour/i;function _t(e,t,r){return e.numComponents||e.size||function(e,t){let r;if(r=bt.test(e)?2:xt.test(e)?4:3,t%r>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${r} but ${t} values is not evenly divisible by ${r}. You should specify it.`);return r}(t,r||gt(e).length)}function vt(e,t){if(tt(e))return e;if(tt(e.data))return e.data;Array.isArray(e)&&(e={data:e});let r=e.type?wt(e.type):void 0;return r||(r=yt(t)?Uint16Array:Float32Array),new r(e.data)}function wt(e){return"number"==typeof e?et(e):e||Float32Array}function At(e,t){return{buffer:t.buffer,numValues:24,type:(r=t.type,"number"==typeof r?r:r?Qe(r):5126),arrayType:wt(t.type)};var r}function kt(e,t){const r=t.data||t,n=wt(t.type),o=r*n.BYTES_PER_ELEMENT,a=e.createBuffer();return e.bindBuffer(ut,a),e.bufferData(ut,o,t.drawType||35044),{buffer:a,numValues:r,type:Qe(n),arrayType:n}}function Tt(e,t,r){const n=vt(t,r);return{arrayType:n.constructor,buffer:ht(e,n,void 0,t.drawType),type:Je(n),numValues:0}}function Et(e,t){const r={};return Object.keys(t).forEach((function(n){if(!yt(n)){const a=t[n],i=a.attrib||a.name||a.attribName||dt.attribPrefix+n;if(a.value){if(!Array.isArray(a.value)&&!tt(a.value))throw new Error("array.value is not array or typedarray");r[i]={value:a.value}}else{let t;t=a.buffer&&a.buffer instanceof WebGLBuffer?At:"number"==typeof a||"number"==typeof a.data?kt:Tt;const{buffer:s,type:l,numValues:c,arrayType:u}=t(e,a,n),d=void 0!==a.normalize?a.normalize:(o=u)===Int8Array||o===Uint8Array,f=_t(a,n,c);r[i]={buffer:s,numComponents:f,type:l,normalize:d,stride:a.stride||0,offset:a.offset||0,divisor:void 0===a.divisor?void 0:a.divisor,drawType:a.drawType}}}var o})),e.bindBuffer(ut,null),r}function Ft(e,t,r,n){r=vt(r),void 0!==n?(e.bindBuffer(ut,t.buffer),e.bufferSubData(ut,n,r)):mt(e,ut,t.buffer,r,t.drawType)}const St=["position","positions","a_position"];function Ct(e,t,r){const n=Et(e,t),o=Object.assign({},r||{});o.attribs=Object.assign({},r?r.attribs:{},n);const a=t.indices;if(a){const t=vt(a,"indices");o.indices=ht(e,t,34963),o.numElements=t.length,o.elementType=Je(t)}else o.numElements||(o.numElements=function(e,t){let r,n;for(n=0;n<St.length&&(r=St[n],!(r in t))&&(r=dt.attribPrefix+r,!(r in t));++n);n===St.length&&(r=Object.keys(t)[0]);const o=t[r];if(!o.buffer)return 1;e.bindBuffer(ut,o.buffer);const a=e.getBufferParameter(ut,34660);var i;e.bindBuffer(ut,null);const s=a/(5120===(i=o.type)||5121===i?1:5122===i||5123===i?2:5124===i||5125===i||5126===i?4:0),l=o.numComponents||o.size,c=s/l;if(c%1!=0)throw new Error(`numComponents ${l} not correct for length ${length}`);return c}(e,o.attribs));return o}function Rt(e,t,r){const n="indices"===r?34963:ut;return ht(e,vt(t,r),n)}function Pt(e,t){const r={};return Object.keys(t).forEach((function(n){r[n]=Rt(e,t[n],n)})),t.indices?(r.numElements=t.indices.length,r.elementType=Je(vt(t.indices))):r.numElements=function(e){let t,r;for(r=0;r<St.length&&(t=St[r],!(t in e));++r);r===St.length&&(t=Object.keys(e)[0]);const n=e[t],o=gt(n).length;if(void 0===o)return 1;const a=_t(n,t),i=o/a;if(o%a>0)throw new Error(`numComponents ${a} not correct for length ${o}`);return i}(t),r}var Ot=Object.freeze({__proto__:null,createAttribsFromArrays:Et,createBuffersFromArrays:Pt,createBufferFromArray:Rt,createBufferFromTypedArray:ht,createBufferInfoFromArrays:Ct,setAttribInfoBufferFromArray:Ft,setAttributePrefix:ft,setAttributeDefaults_:pt,getNumComponents_:_t,getArray_:gt});function It(e){return!!e.texStorage2D}function Lt(e){return!e.texStorage2D}const zt=function(){const e={},t={};return function(r,n){return function(r){const n=r.constructor.name;if(!e[n]){for(const e in r)if("number"==typeof r[e]){const n=t[r[e]];t[r[e]]=n?`${n} | ${e}`:e}e[n]=!0}}(r),t[n]||("number"==typeof n?`0x${n.toString(16)}`:n)}}();var Bt=Object.freeze({__proto__:null,glEnumToString:zt,isWebGL1:Lt,isWebGL2:It});const Mt={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},Dt=tt,jt=function(){let e;return function(){return e=e||("undefined"!=typeof document&&document.createElement?document.createElement("canvas").getContext("2d"):null),e}}(),Nt=6406,Ut=6407,Vt=6408,Gt=6409,Ht=6410,$t=6402,Wt=34041,Xt=33071,Zt=3553,Yt=34067,Kt=32879,qt=35866,Jt=34069,Qt=10241,er=10240,tr=10242,rr=10243,nr=3317,or=5120,ar=5121,ir=5122,sr=5123,lr=5124,cr=5125,ur=5126,dr=5131,fr=36193,pr=33640,mr=33319,hr=33320,yr=6403,gr=36244,br=36248,xr=36249,_r={};{const e=_r;e[6406]={numColorComponents:1},e[6409]={numColorComponents:1},e[6410]={numColorComponents:2},e[Ut]={numColorComponents:3},e[6408]={numColorComponents:4},e[yr]={numColorComponents:1},e[36244]={numColorComponents:1},e[mr]={numColorComponents:2},e[33320]={numColorComponents:2},e[Ut]={numColorComponents:3},e[36248]={numColorComponents:3},e[6408]={numColorComponents:4},e[36249]={numColorComponents:4},e[6402]={numColorComponents:1},e[34041]={numColorComponents:2}}let vr;function wr(e){if(!vr){const e={};e[6406]={textureFormat:Nt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ar,dr,fr,ur]},e[6409]={textureFormat:Gt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ar,dr,fr,ur]},e[6410]={textureFormat:Ht,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[ar,dr,fr,ur]},e[Ut]={textureFormat:Ut,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[ar,dr,fr,ur,33635]},e[6408]={textureFormat:Vt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[ar,dr,fr,ur,32819,32820]},e[6402]={textureFormat:$t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[cr,sr]},e[33321]={textureFormat:yr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[ar]},e[36756]={textureFormat:yr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[or]},e[33325]={textureFormat:yr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[ur,dr]},e[33326]={textureFormat:yr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[ur]},e[33330]={textureFormat:gr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[ar]},e[33329]={textureFormat:gr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[or]},e[33332]={textureFormat:gr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[sr]},e[33331]={textureFormat:gr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ir]},e[33334]={textureFormat:gr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[cr]},e[33333]={textureFormat:gr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[lr]},e[33323]={textureFormat:mr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[ar]},e[36757]={textureFormat:mr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[or]},e[33327]={textureFormat:mr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[ur,dr]},e[33328]={textureFormat:mr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[ur]},e[33336]={textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ar]},e[33335]={textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[or]},e[33338]={textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[sr]},e[33337]={textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ir]},e[33340]={textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[cr]},e[33339]={textureFormat:hr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[lr]},e[32849]={textureFormat:Ut,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[ar]},e[35905]={textureFormat:Ut,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[ar]},e[36194]={textureFormat:Ut,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[ar,33635]},e[36758]={textureFormat:Ut,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[or]},e[35898]={textureFormat:Ut,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ur,dr,35899]},e[35901]={textureFormat:Ut,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ur,dr,35902]},e[34843]={textureFormat:Ut,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[ur,dr]},e[34837]={textureFormat:Ut,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[ur]},e[36221]={textureFormat:br,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[ar]},e[36239]={textureFormat:br,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[or]},e[36215]={textureFormat:br,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[sr]},e[36233]={textureFormat:br,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[ir]},e[36209]={textureFormat:br,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[cr]},e[36227]={textureFormat:br,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[lr]},e[32856]={textureFormat:Vt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ar]},e[35907]={textureFormat:Vt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ar]},e[36759]={textureFormat:Vt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[or]},e[32855]={textureFormat:Vt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[ar,32820,pr]},e[32854]={textureFormat:Vt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[ar,32819]},e[32857]={textureFormat:Vt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[pr]},e[34842]={textureFormat:Vt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[ur,dr]},e[34836]={textureFormat:Vt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[ur]},e[36220]={textureFormat:xr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ar]},e[36238]={textureFormat:xr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[or]},e[36975]={textureFormat:xr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[pr]},e[36214]={textureFormat:xr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[sr]},e[36232]={textureFormat:xr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[ir]},e[36226]={textureFormat:xr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[lr]},e[36208]={textureFormat:xr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[cr]},e[33189]={textureFormat:$t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[sr,cr]},e[33190]={textureFormat:$t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[cr]},e[36012]={textureFormat:$t,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ur]},e[35056]={textureFormat:Wt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[34042]},e[36013]={textureFormat:Wt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[36269]},Object.keys(e).forEach((function(t){const r=e[t];r.bytesPerElementMap={},r.bytesPerElement.forEach((function(e,t){const n=r.type[t];r.bytesPerElementMap[n]=e}))})),vr=e}return vr[e]}function Ar(e,t){const r=wr(e);if(!r)throw"unknown internal format";const n=r.bytesPerElementMap[t];if(void 0===n)throw"unknown internal format";return n}function kr(e){const t=wr(e);if(!t)throw"unknown internal format";return{format:t.textureFormat,type:t.type[0]}}function Tr(e){return!(e&e-1)}function Er(e,t,r,n){if(!It(e))return Tr(t)&&Tr(r);const o=wr(n);if(!o)throw"unknown internal format";return o.colorRenderable&&o.textureFilterable}function Fr(e){const t=wr(e);if(!t)throw"unknown internal format";return t.textureFilterable}function Sr(e){const t=_r[e];if(!t)throw"unknown format: "+e;return t.numColorComponents}function Cr(e,t,r){return Dt(t)?Je(t):r||ar}function Rr(e,t,r,n,o){if(o%1!=0)throw"can't guess dimensions";if(r||n){if(n){if(!r&&(r=o/n)%1)throw"can't guess dimensions"}else if((n=o/r)%1)throw"can't guess dimensions"}else{const e=Math.sqrt(o/(t===Yt?6:1));e%1==0?(r=e,n=e):(r=o,n=1)}return{width:r,height:n}}function Pr(e){Mt.textureColor=new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}function Or(e){nt(e,Mt),e.textureColor&&Pr(e.textureColor)}function Ir(e,t){void 0!==t.colorspaceConversion&&e.pixelStorei(37443,t.colorspaceConversion),void 0!==t.premultiplyAlpha&&e.pixelStorei(37441,t.premultiplyAlpha),void 0!==t.flipY&&e.pixelStorei(37440,t.flipY)}function Lr(e){e.pixelStorei(nr,4),It(e)&&(e.pixelStorei(3314,0),e.pixelStorei(32878,0),e.pixelStorei(3316,0),e.pixelStorei(3315,0),e.pixelStorei(32877,0))}function zr(e,t,r,n){var o;n.minMag&&(r.call(e,t,Qt,n.minMag),r.call(e,t,er,n.minMag)),n.min&&r.call(e,t,Qt,n.min),n.mag&&r.call(e,t,er,n.mag),n.wrap&&(r.call(e,t,tr,n.wrap),r.call(e,t,rr,n.wrap),(t===Kt||(o=t,"undefined"!=typeof WebGLSampler&&st(o,"WebGLSampler")))&&r.call(e,t,32882,n.wrap)),n.wrapR&&r.call(e,t,32882,n.wrapR),n.wrapS&&r.call(e,t,tr,n.wrapS),n.wrapT&&r.call(e,t,rr,n.wrapT),void 0!==n.minLod&&r.call(e,t,33082,n.minLod),void 0!==n.maxLod&&r.call(e,t,33083,n.maxLod),void 0!==n.baseLevel&&r.call(e,t,33084,n.baseLevel),void 0!==n.maxLevel&&r.call(e,t,33085,n.maxLevel),void 0!==n.compareFunc&&r.call(e,t,34893,n.compareFunc),void 0!==n.compareMode&&r.call(e,t,34892,n.compareMode)}function Br(e,t,r){const n=r.target||Zt;e.bindTexture(n,t),zr(e,n,e.texParameteri,r)}function Mr(e,t,r){zr(e,t,e.samplerParameteri,r)}function Dr(e,t){const r=e.createSampler();return Mr(e,r,t),r}function jr(e,t){const r={};return Object.keys(t).forEach((function(n){r[n]=Dr(e,t[n])})),r}function Nr(e,t,r,n,o,a){r=r||Mt.textureOptions,a=a||Vt;const i=r.target||Zt;if(n=n||r.width,o=o||r.height,e.bindTexture(i,t),Er(e,n,o,a))e.generateMipmap(i);else{const t=Fr(a)?9729:9728;e.texParameteri(i,Qt,t),e.texParameteri(i,er,t),e.texParameteri(i,tr,Xt),e.texParameteri(i,rr,Xt)}}function Ur(e){return!0===e.auto||void 0===e.auto&&void 0===e.level}function Vr(e,t){return(t=t||{}).cubeFaceOrder||[Jt,34070,34071,34072,34073,34074]}function Gr(e,t){const r=Vr(0,t).map((function(e,t){return{face:e,ndx:t}}));return r.sort((function(e,t){return e.face-t.face})),r}function Hr(e,t,r,n){const o=(n=n||Mt.textureOptions).target||Zt,a=n.level||0;let i=r.width,s=r.height;const l=n.internalFormat||n.format||Vt,c=kr(l),u=n.format||c.format,d=n.type||c.type;if(Ir(e,n),e.bindTexture(o,t),o===Yt){const c=r.width,f=r.height;let p,m;if(c/6===f)p=f,m=[0,0,1,0,2,0,3,0,4,0,5,0];else if(f/6===c)p=c,m=[0,0,0,1,0,2,0,3,0,4,0,5];else if(c/3==f/2)p=c/3,m=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(c/2!=f/3)throw"can't figure out cube map from element: "+(r.src?r.src:r.nodeName);p=c/2,m=[0,0,1,0,0,1,1,1,0,2,1,2]}const h=jt();h?(h.canvas.width=p,h.canvas.height=p,i=p,s=p,Gr(0,n).forEach((function(t){const n=m[2*t.ndx+0]*p,o=m[2*t.ndx+1]*p;h.drawImage(r,n,o,p,p,0,0,p,p),e.texImage2D(t.face,a,l,u,d,h.canvas)})),h.canvas.width=1,h.canvas.height=1):"undefined"!=typeof createImageBitmap&&(i=p,s=p,Gr(0,n).forEach((function(c){const f=m[2*c.ndx+0]*p,h=m[2*c.ndx+1]*p;e.texImage2D(c.face,a,l,p,p,0,u,d,null),createImageBitmap(r,f,h,p,p,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then((function(r){Ir(e,n),e.bindTexture(o,t),e.texImage2D(c.face,a,l,u,d,r),Ur(n)&&Nr(e,t,n,i,s,l)}))})))}else if(o===Kt||o===qt){const t=Math.min(r.width,r.height),n=Math.max(r.width,r.height),i=n/t;if(i%1!=0)throw"can not compute 3D dimensions of element";const s=r.width===n?1:0,c=r.height===n?1:0;e.pixelStorei(nr,1),e.pixelStorei(3314,r.width),e.pixelStorei(32878,0),e.pixelStorei(32877,0),e.texImage3D(o,a,l,t,t,t,0,u,d,null);for(let n=0;n<i;++n){const i=n*t*s,l=n*t*c;e.pixelStorei(3316,i),e.pixelStorei(3315,l),e.texSubImage3D(o,a,0,0,n,t,t,1,u,d,r)}Lr(e)}else e.texImage2D(o,a,l,u,d,r);Ur(n)&&Nr(e,t,n,i,s,l),Br(e,t,n)}function $r(){}function Wr(e,t){return void 0!==t||function(e){if("undefined"!=typeof document){const t=document.createElement("a");return t.href=e,t.hostname===location.hostname&&t.port===location.port&&t.protocol===location.protocol}{const t=new URL(location.href).origin;return new URL(e,location.href).origin===t}}(e)?t:"anonymous"}function Xr(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}function Zr(e,t,r){return Xr(e)?(setTimeout((function(){r(null,e)})),e):function(e,t,r){let n;if(r=r||$r,t=void 0!==t?t:Mt.crossOrigin,t=Wr(e,t),"undefined"!=typeof Image){n=new Image,void 0!==t&&(n.crossOrigin=t);const o=function(){n.removeEventListener("error",a),n.removeEventListener("load",i),n=null},a=function(){const t="couldn't load image: "+e;ot(t),r(t,n),o()},i=function(){r(null,n),o()};return n.addEventListener("error",a),n.addEventListener("load",i),n.src=e,n}if("undefined"!=typeof ImageBitmap){let o,a;const i=function(){r(o,a)},s={};t&&(s.mode="cors"),fetch(e,s).then((function(e){if(!e.ok)throw e;return e.blob()})).then((function(e){return createImageBitmap(e,{premultiplyAlpha:"none",colorSpaceConversion:"none"})})).then((function(e){a=e,setTimeout(i)})).catch((function(e){o=e,setTimeout(i)})),n=null}return n}(e,t,r)}function Yr(e,t,r){const n=(r=r||Mt.textureOptions).target||Zt;if(e.bindTexture(n,t),!1===r.color)return;const o=function(e){return e=e||Mt.textureColor,Dt(e)?e:new Uint8Array([255*e[0],255*e[1],255*e[2],255*e[3]])}(r.color);if(n===Yt)for(let t=0;t<6;++t)e.texImage2D(Jt+t,0,Vt,1,1,0,Vt,ar,o);else n===Kt||n===qt?e.texImage3D(n,0,Vt,1,1,1,0,Vt,ar,o):e.texImage2D(n,0,Vt,1,1,0,Vt,ar,o)}function Kr(e,t,r,n){n=n||$r,r=r||Mt.textureOptions,Yr(e,t,r);return Zr((r=Object.assign({},r)).src,r.crossOrigin,(function(o,a){o?n(o,t,a):(Hr(e,t,a,r),n(null,t,a))}))}function qr(e,t,r,n){n=n||$r;const o=r.src;if(6!==o.length)throw"there must be 6 urls for a cubemap";const a=r.level||0,i=r.internalFormat||r.format||Vt,s=kr(i),l=r.format||s.format,c=r.type||ar,u=r.target||Zt;if(u!==Yt)throw"target must be TEXTURE_CUBE_MAP";Yr(e,t,r),r=Object.assign({},r);let d=6;const f=[],p=Vr(0,r);let m;m=o.map((function(o,s){return Zr(o,r.crossOrigin,(h=p[s],function(o,s){--d,o?f.push(o):s.width!==s.height?f.push("cubemap face img is not a square: "+s.src):(Ir(e,r),e.bindTexture(u,t),5===d?Vr().forEach((function(t){e.texImage2D(t,a,i,l,c,s)})):e.texImage2D(h,a,i,l,c,s),Ur(r)&&e.generateMipmap(u)),0===d&&n(f.length?f:void 0,t,m)}));var h}))}function Jr(e,t,r,n){n=n||$r;const o=r.src,a=r.internalFormat||r.format||Vt,i=kr(a),s=r.format||i.format,l=r.type||ar,c=r.target||qt;if(c!==Kt&&c!==qt)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";Yr(e,t,r),r=Object.assign({},r);let u=o.length;const d=[];let f;const p=r.level||0;let m=r.width,h=r.height;const y=o.length;let g=!0;f=o.map((function(o,i){return Zr(o,r.crossOrigin,(b=i,function(o,i){if(--u,o)d.push(o);else{if(Ir(e,r),e.bindTexture(c,t),g){g=!1,m=r.width||i.width,h=r.height||i.height,e.texImage3D(c,p,a,m,h,y,0,s,l,null);for(let t=0;t<y;++t)e.texSubImage3D(c,p,0,0,t,m,h,1,s,l,i)}else{let t,r=i;i.width===m&&i.height===h||(t=jt(),r=t.canvas,t.canvas.width=m,t.canvas.height=h,t.drawImage(i,0,0,m,h)),e.texSubImage3D(c,p,0,0,b,m,h,1,s,l,r),t&&r===t.canvas&&(t.canvas.width=0,t.canvas.height=0)}Ur(r)&&e.generateMipmap(c)}0===u&&n(d.length?d:void 0,t,f)}));var b}))}function Qr(e,t,r,n){const o=(n=n||Mt.textureOptions).target||Zt;e.bindTexture(o,t);let a=n.width,i=n.height,s=n.depth;const l=n.level||0,c=n.internalFormat||n.format||Vt,u=kr(c),d=n.format||u.format,f=n.type||Cr(0,r,u.type);if(Dt(r))r instanceof Uint8ClampedArray&&(r=new Uint8Array(r.buffer));else{const e=et(f);r=new e(r)}const p=Ar(c,f),m=r.byteLength/p;if(m%1)throw"length wrong size for format: "+zt(e,d);let h;if(o===Kt||o===qt)if(a||i||s)!a||i&&s?!i||a&&s?(h=Rr(0,o,a,i,m/s),a=h.width,i=h.height):(h=Rr(0,o,a,s,m/i),a=h.width,s=h.height):(h=Rr(0,o,i,s,m/a),i=h.width,s=h.height);else{const e=Math.cbrt(m);if(e%1!=0)throw"can't guess cube size of array of numElements: "+m;a=e,i=e,s=e}else h=Rr(0,o,a,i,m),a=h.width,i=h.height;if(Lr(e),e.pixelStorei(nr,n.unpackAlignment||1),Ir(e,n),o===Yt){const t=m/6*(p/r.BYTES_PER_ELEMENT);Gr(0,n).forEach((n=>{const o=t*n.ndx,s=r.subarray(o,o+t);e.texImage2D(n.face,l,c,a,i,0,d,f,s)}))}else o===Kt||o===qt?e.texImage3D(o,l,c,a,i,s,0,d,f,r):e.texImage2D(o,l,c,a,i,0,d,f,r);return{width:a,height:i,depth:s,type:f}}function en(e,t,r){const n=r.target||Zt;e.bindTexture(n,t);const o=r.level||0,a=r.internalFormat||r.format||Vt,i=kr(a),s=r.format||i.format,l=r.type||i.type;if(Ir(e,r),n===Yt)for(let t=0;t<6;++t)e.texImage2D(Jt+t,o,a,r.width,r.height,0,s,l,null);else n===Kt||n===qt?e.texImage3D(n,o,a,r.width,r.height,r.depth,0,s,l,null):e.texImage2D(n,o,a,r.width,r.height,0,s,l,null)}function tn(e,t,r){r=r||$r,t=t||Mt.textureOptions;const n=e.createTexture(),o=t.target||Zt;let a=t.width||1,i=t.height||1;const s=t.internalFormat||Vt;e.bindTexture(o,n),o===Yt&&(e.texParameteri(o,tr,Xt),e.texParameteri(o,rr,Xt));let l=t.src;if(l)if("function"==typeof l&&(l=l(e,t)),"string"==typeof l)Kr(e,n,t,r);else if(Dt(l)||Array.isArray(l)&&("number"==typeof l[0]||Array.isArray(l[0])||Dt(l[0]))){const r=Qr(e,n,l,t);a=r.width,i=r.height}else Array.isArray(l)&&("string"==typeof l[0]||Xr(l[0]))?o===Yt?qr(e,n,t,r):Jr(e,n,t,r):(Hr(e,n,l,t),a=l.width,i=l.height);else en(e,n,t);return Ur(t)&&Nr(e,n,t,a,i,s),Br(e,n,t),n}function rn(e,t,r,n,o,a){n=n||r.width,o=o||r.height,a=a||r.depth;const i=r.target||Zt;e.bindTexture(i,t);const s=r.level||0,l=r.internalFormat||r.format||Vt,c=kr(l),u=r.format||c.format;let d;const f=r.src;if(d=f&&(Dt(f)||Array.isArray(f)&&"number"==typeof f[0])?r.type||Cr(0,f,c.type):r.type||c.type,i===Yt)for(let t=0;t<6;++t)e.texImage2D(Jt+t,s,l,n,o,0,u,d,null);else i===Kt||i===qt?e.texImage3D(i,s,l,n,o,a,0,u,d,null):e.texImage2D(i,s,l,n,o,0,u,d,null)}function nn(e,t,r){r=r||$r;let n=0;const o=[],a={},i={};function s(){0===n&&setTimeout((function(){r(o.length?o:void 0,a,i)}),0)}return Object.keys(t).forEach((function(r){const l=t[r];let c;var u;("string"==typeof(u=l.src)||Array.isArray(u)&&"string"==typeof u[0])&&(c=function(e,t,a){i[r]=a,--n,e&&o.push(e),s()},++n),a[r]=tn(e,l,c)})),s(),a}var on=Object.freeze({__proto__:null,setTextureDefaults_:Or,createSampler:Dr,createSamplers:jr,setSamplerParameters:Mr,createTexture:tn,setEmptyTexture:en,setTextureFromArray:Qr,loadTextureFromUrl:Kr,setTextureFromElement:Hr,setTextureFilteringForSize:Nr,setTextureParameters:Br,setDefaultTextureColor:Pr,createTextures:nn,resizeTexture:rn,canGenerateMipmap:Er,canFilter:Fr,getNumComponentsForFormat:Sr,getBytesPerElementForInternalFormat:Ar,getFormatAndTypeForInternalFormat:kr});const an=ot,sn=at;function ln(e){return"undefined"!=typeof document&&document.getElementById?document.getElementById(e):null}const cn=33984,un=34962,dn=35345,fn=5126,pn=5124,mn=5125,hn=3553,yn=34067,gn=32879,bn=35866,xn={};function _n(e,t){return xn[t].bindPoint}function vn(e,t){return function(r){e.uniform1i(t,r)}}function wn(e,t){return function(r){e.uniform1iv(t,r)}}function An(e,t){return function(r){e.uniform2iv(t,r)}}function kn(e,t){return function(r){e.uniform3iv(t,r)}}function Tn(e,t){return function(r){e.uniform4iv(t,r)}}function En(e,t,r,n){const o=_n(0,t);return It(e)?function(t){let a,i;!t||ct(0,t)?(a=t,i=null):(a=t.texture,i=t.sampler),e.uniform1i(n,r),e.activeTexture(cn+r),e.bindTexture(o,a),e.bindSampler(r,i)}:function(t){e.uniform1i(n,r),e.activeTexture(cn+r),e.bindTexture(o,t)}}function Fn(e,t,r,n,o){const a=_n(0,t),i=new Int32Array(o);for(let e=0;e<o;++e)i[e]=r+e;return It(e)?function(t){e.uniform1iv(n,i),t.forEach((function(t,n){let o,s;e.activeTexture(cn+i[n]),!t||ct(0,t)?(o=t,s=null):(o=t.texture,s=t.sampler),e.bindSampler(r,s),e.bindTexture(a,o)}))}:function(t){e.uniform1iv(n,i),t.forEach((function(t,r){e.activeTexture(cn+i[r]),e.bindTexture(a,t)}))}}function Sn(e,t){return function(r){if(r.value)switch(e.disableVertexAttribArray(t),r.value.length){case 4:e.vertexAttrib4fv(t,r.value);break;case 3:e.vertexAttrib3fv(t,r.value);break;case 2:e.vertexAttrib2fv(t,r.value);break;case 1:e.vertexAttrib1fv(t,r.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(un,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.numComponents||r.size,r.type||fn,r.normalize||!1,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function Cn(e,t){return function(r){if(r.value){if(e.disableVertexAttribArray(t),4!==r.value.length)throw new Error("The length of an integer constant value must be 4!");e.vertexAttrib4iv(t,r.value)}else e.bindBuffer(un,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.numComponents||r.size,r.type||pn,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function Rn(e,t){return function(r){if(r.value){if(e.disableVertexAttribArray(t),4!==r.value.length)throw new Error("The length of an unsigned integer constant value must be 4!");e.vertexAttrib4uiv(t,r.value)}else e.bindBuffer(un,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.numComponents||r.size,r.type||mn,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function Pn(e,t,r){const n=r.size,o=r.count;return function(r){e.bindBuffer(un,r.buffer);const a=r.size||r.numComponents||n,i=a/o,s=r.type||fn,l=xn[s].size*a,c=r.normalize||!1,u=r.offset||0,d=l/o;for(let n=0;n<o;++n)e.enableVertexAttribArray(t+n),e.vertexAttribPointer(t+n,i,s,c,l,u+d*n),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+n,r.divisor||0)}}xn[5126]={Type:Float32Array,size:4,setter:function(e,t){return function(r){e.uniform1f(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1fv(t,r)}}},xn[35664]={Type:Float32Array,size:8,setter:function(e,t){return function(r){e.uniform2fv(t,r)}},cols:2},xn[35665]={Type:Float32Array,size:12,setter:function(e,t){return function(r){e.uniform3fv(t,r)}},cols:3},xn[35666]={Type:Float32Array,size:16,setter:function(e,t){return function(r){e.uniform4fv(t,r)}},cols:4},xn[pn]={Type:Int32Array,size:4,setter:vn,arraySetter:wn},xn[35667]={Type:Int32Array,size:8,setter:An,cols:2},xn[35668]={Type:Int32Array,size:12,setter:kn,cols:3},xn[35669]={Type:Int32Array,size:16,setter:Tn,cols:4},xn[5125]={Type:Uint32Array,size:4,setter:function(e,t){return function(r){e.uniform1ui(t,r)}},arraySetter:function(e,t){return function(r){e.uniform1uiv(t,r)}}},xn[36294]={Type:Uint32Array,size:8,setter:function(e,t){return function(r){e.uniform2uiv(t,r)}},cols:2},xn[36295]={Type:Uint32Array,size:12,setter:function(e,t){return function(r){e.uniform3uiv(t,r)}},cols:3},xn[36296]={Type:Uint32Array,size:16,setter:function(e,t){return function(r){e.uniform4uiv(t,r)}},cols:4},xn[35670]={Type:Uint32Array,size:4,setter:vn,arraySetter:wn},xn[35671]={Type:Uint32Array,size:8,setter:An,cols:2},xn[35672]={Type:Uint32Array,size:12,setter:kn,cols:3},xn[35673]={Type:Uint32Array,size:16,setter:Tn,cols:4},xn[35674]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix2fv(t,!1,r)}},rows:2,cols:2},xn[35675]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix3fv(t,!1,r)}},rows:3,cols:3},xn[35676]={Type:Float32Array,size:64,setter:function(e,t){return function(r){e.uniformMatrix4fv(t,!1,r)}},rows:4,cols:4},xn[35685]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix2x3fv(t,!1,r)}},rows:2,cols:3},xn[35686]={Type:Float32Array,size:32,setter:function(e,t){return function(r){e.uniformMatrix2x4fv(t,!1,r)}},rows:2,cols:4},xn[35687]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix3x2fv(t,!1,r)}},rows:3,cols:2},xn[35688]={Type:Float32Array,size:48,setter:function(e,t){return function(r){e.uniformMatrix3x4fv(t,!1,r)}},rows:3,cols:4},xn[35689]={Type:Float32Array,size:64,setter:function(e,t){return function(r){e.uniformMatrix4x2fv(t,!1,r)}},rows:4,cols:2},xn[35690]={Type:Float32Array,size:64,setter:function(e,t){return function(r){e.uniformMatrix4x3fv(t,!1,r)}},rows:4,cols:3},xn[35678]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:hn},xn[35680]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:yn},xn[35679]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:gn},xn[35682]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:hn},xn[36289]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:bn},xn[36292]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:bn},xn[36293]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:yn},xn[36298]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:hn},xn[36299]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:gn},xn[36300]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:yn},xn[36303]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:bn},xn[36306]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:hn},xn[36307]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:gn},xn[36308]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:yn},xn[36311]={Type:null,size:0,setter:En,arraySetter:Fn,bindPoint:bn};const On={};On[5126]={size:4,setter:Sn},On[35664]={size:8,setter:Sn},On[35665]={size:12,setter:Sn},On[35666]={size:16,setter:Sn},On[pn]={size:4,setter:Cn},On[35667]={size:8,setter:Cn},On[35668]={size:12,setter:Cn},On[35669]={size:16,setter:Cn},On[5125]={size:4,setter:Rn},On[36294]={size:8,setter:Rn},On[36295]={size:12,setter:Rn},On[36296]={size:16,setter:Rn},On[35670]={size:4,setter:Cn},On[35671]={size:8,setter:Cn},On[35672]={size:12,setter:Cn},On[35673]={size:16,setter:Cn},On[35674]={size:4,setter:Pn,count:2},On[35675]={size:9,setter:Pn,count:3},On[35676]={size:16,setter:Pn,count:4};const In=/ERROR:\s*\d+:(\d+)/gi;const Ln=/^[ \t]*\n/;function zn(e){let t=0;return Ln.test(e)&&(t=1,e=e.replace(Ln,"")),{lineOffset:t,shaderSource:e}}function Bn(e,t){return e.errorCallback(t),e.callback&&setTimeout((()=>{e.callback(`${t}\n${e.errors.join("\n")}`)})),null}function Mn(e,t,r,n){n=n||an;if(!e.getShaderParameter(r,35713)){const o=e.getShaderInfoLog(r),{lineOffset:a,shaderSource:i}=zn(e.getShaderSource(r)),s=`${function(e,t="",r=0){const n=[...t.matchAll(In)],o=new Map(n.map(((e,r)=>{const o=parseInt(e[1]),a=n[r+1],i=a?a.index:t.length;return[o-1,t.substring(e.index,i)]})));return e.split("\n").map(((e,t)=>{const n=o.get(t);return`${t+1+r}: ${e}${n?`\n\n^^^ ${n}`:""}`})).join("\n")}(i,o,a)}\nError compiling ${zt(e,t)}: ${o}`;return n(s),s}return""}function Dn(e,t,r){let n,o,a;if("function"==typeof t&&(r=t,t=void 0),"function"==typeof e)r=e,e=void 0;else if(e&&!Array.isArray(e)){const t=e;r=t.errorCallback,e=t.attribLocations,n=t.transformFeedbackVaryings,o=t.transformFeedbackMode,a=t.callback}const i=r||an,s=[],l={errorCallback(e,...t){s.push(e),i(e,...t)},transformFeedbackVaryings:n,transformFeedbackMode:o,callback:a,errors:s};{let r={};Array.isArray(e)?e.forEach((function(e,n){r[e]=t?t[n]:n})):r=e||{},l.attribLocations=r}return l}const jn=["VERTEX_SHADER","FRAGMENT_SHADER"];const Nn=(e=0)=>new Promise((t=>setTimeout(t,e)));function Un(e,t,r){const n=e.createProgram(),{attribLocations:o,transformFeedbackVaryings:a,transformFeedbackMode:i}=Dn(r);for(let r=0;r<t.length;++r){let o=t[r];if("string"==typeof o){const t=ln(o),a=t?t.text:o;let i=e[jn[r]];t&&t.type&&(i=((s=t.type).indexOf("frag")>=0?35632:s.indexOf("vert")>=0?35633:void 0)||i),o=e.createShader(i),e.shaderSource(o,zn(a).shaderSource),e.compileShader(o),e.attachShader(n,o)}}var s;Object.entries(o).forEach((([t,r])=>e.bindAttribLocation(n,r,t)));{let t=a;t&&(t.attribs&&(t=t.attribs),Array.isArray(t)||(t=Object.keys(t)),e.transformFeedbackVaryings(n,t,i||35981))}return e.linkProgram(n),n}function Vn(e,t,r,n,o){const a=Dn(r,n,o),i=new Set(t),s=Un(e,t,a);function l(e,t){const r=Xn(e,t,a.errorCallback);return r&&function(e,t,r){const n=e.getAttachedShaders(t);for(const t of n)r.has(t)&&e.deleteShader(t);e.deleteProgram(t)}(e,t,i),r}if(!a.callback)return l(e,s)?void 0:s;Wn(e,s).then((()=>{const t=l(e,s);a.callback(t,t?void 0:s)}))}function Gn(e){return function(t,r,...n){return new Promise(((o,a)=>{const i=Dn(...n);i.callback=(e,t)=>{e?a(e):o(t)},e(t,r,i)}))}}const Hn=Gn(Vn),$n=Gn(_o);async function Wn(e,t){const r=e.getExtension("KHR_parallel_shader_compile"),n=r?(e,t)=>e.getProgramParameter(t,r.COMPLETION_STATUS_KHR):()=>!0;let o=0;do{await Nn(o),o=1e3/60}while(!n(e,t))}function Xn(e,t,r){r=r||an;if(!e.getProgramParameter(t,35714)){const n=e.getProgramInfoLog(t);r(`Error in program linking: ${n}`);return`${n}\n${e.getAttachedShaders(t).map((t=>Mn(e,e.getShaderParameter(t,e.SHADER_TYPE),t,r))).filter((e=>e)).join("\n")}`}}function Zn(e,t,r,n,o){const a=Dn(r,n,o),i=[];for(const e of t){const t=ln(e);if(!t)return Bn(a,`unknown script element: ${e}`);i.push(t.text)}return Vn(e,i,a)}function Yn(e,t,r,n,o){return Vn(e,t,r,n,o)}function Kn(e){const t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}const qn=/(\.|\[|]|\w+)/g,Jn=e=>e>="0"&&e<="9";function Qn(e,t,r,n){const o=e.split(qn).filter((e=>""!==e));let a=0,i="";for(;;){const e=o[a++];i+=e;const s=Jn(e[0]),l=s?parseInt(e):e;s&&(i+=o[a++]);if(a===o.length){r[l]=t;break}{const e=o[a++],t="["===e,s=r[l]||(t?[]:{});r[l]=s,r=s,n[i]=n[i]||function(e){return function(t){fo(e,t)}}(s),i+=e}}}function eo(e,t){let r=0;function n(t,n,o){const a=n.name.endsWith("[0]"),i=n.type,s=xn[i];if(!s)throw new Error(`unknown type: 0x${i.toString(16)}`);let l;if(s.bindPoint){const t=r;r+=n.size,l=a?s.arraySetter(e,i,t,o,n.size):s.setter(e,i,t,o,n.size)}else l=s.arraySetter&&a?s.arraySetter(e,o):s.setter(e,o);return l.location=o,l}const o={},a={},i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const i=e.getActiveUniform(t,r);if(Kn(i))continue;let s=i.name;s.endsWith("[0]")&&(s=s.substr(0,s.length-3));const l=e.getUniformLocation(t,i.name);if(l){const e=n(0,i,l);o[s]=e,Qn(s,e,a,o)}}return o}function to(e,t){const r={},n=e.getProgramParameter(t,35971);for(let o=0;o<n;++o){const n=e.getTransformFeedbackVarying(t,o);r[n.name]={index:o,type:n.type,size:n.size}}return r}function ro(e,t,r){t.transformFeedbackInfo&&(t=t.transformFeedbackInfo),r.attribs&&(r=r.attribs);for(const n in r){const o=t[n];if(o){const t=r[n];t.offset?e.bindBufferRange(35982,o.index,t.buffer,t.offset,t.size):e.bindBufferBase(35982,o.index,t.buffer)}}}function no(e,t,r){const n=e.createTransformFeedback();return e.bindTransformFeedback(36386,n),e.useProgram(t.program),ro(e,t,r),e.bindTransformFeedback(36386,null),n}function oo(e,t){const r=e.getProgramParameter(t,35718),n=[],o=[];for(let a=0;a<r;++a){o.push(a),n.push({});const r=e.getActiveUniform(t,a);n[a].name=r.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach((function(r){const a=r[0],i=r[1];e.getActiveUniforms(t,o,e[a]).forEach((function(e,t){n[t][i]=e}))}));const a={},i=e.getProgramParameter(t,35382);for(let r=0;r<i;++r){const n=e.getActiveUniformBlockName(t,r),o={index:e.getUniformBlockIndex(t,n),usedByVertexShader:e.getActiveUniformBlockParameter(t,r,35396),usedByFragmentShader:e.getActiveUniformBlockParameter(t,r,35398),size:e.getActiveUniformBlockParameter(t,r,35392),uniformIndices:e.getActiveUniformBlockParameter(t,r,35395)};o.used=o.usedByVertexShader||o.usedByFragmentShader,a[n]=o}return{blockSpecs:a,uniformData:n}}const ao=/\[\d+\]\.$/;function io(e,t,r,n){const o=r.blockSpecs,a=r.uniformData,i=o[n];if(!i)return sn("no uniform block object named:",n),{name:n,uniforms:{}};const s=new ArrayBuffer(i.size),l=e.createBuffer(),c=i.index;e.bindBuffer(dn,l),e.uniformBlockBinding(t,i.index,c);let u=n+".";ao.test(u)&&(u=u.replace(ao,"."));const d={},f={},p={};return i.uniformIndices.forEach((function(e){const t=a[e];let r=t.name;r.startsWith(u)&&(r=r.substr(u.length));const n=r.endsWith("[0]");n&&(r=r.substr(0,r.length-3));const o=xn[t.type],i=o.Type,l=n?((o.size+((c=16)-1))/c|0)*c*t.size:o.size*t.size;var c;const m=new i(s,t.offset,l/i.BYTES_PER_ELEMENT);d[r]=m;const h=function(e,t,r,n){if(t||r){n=n||1;const t=e.length/4;return function(r){let o=0,a=0;for(let i=0;i<t;++i){for(let t=0;t<n;++t)e[o++]=r[a++];o+=4-n}}}return function(t){t.length?e.set(t):e[0]=t}}(m,n,o.rows,o.cols);f[r]=h,Qn(r,h,p,f)})),{name:n,array:s,asFloat:new Float32Array(s),buffer:l,uniforms:d,setters:f}}function so(e,t,r){return io(e,t.program,t.uniformBlockSpec,r)}function lo(e,t,r){const n=(t.uniformBlockSpec||t).blockSpecs[r.name];if(n){const t=n.index;return e.bindBufferRange(dn,t,r.buffer,r.offset||0,r.array.byteLength),!0}return!1}function co(e,t,r){lo(e,t,r)&&e.bufferData(dn,r.array,35048)}function uo(e,t){const r=e.setters;for(const e in t){const n=r[e];if(n){n(t[e])}}}function fo(e,t){for(const r in t){const n=e[r];"function"==typeof n?n(t[r]):fo(e[r],t[r])}}function po(e,...t){const r=e.uniformSetters||e,n=t.length;for(let e=0;e<n;++e){const n=t[e];if(Array.isArray(n)){const e=n.length;for(let t=0;t<e;++t)po(r,n[t])}else for(const e in n){const t=r[e];t&&t(n[e])}}}const mo=po;function ho(e,t){const r={},n=e.getProgramParameter(t,35721);for(let o=0;o<n;++o){const n=e.getActiveAttrib(t,o);if(Kn(n))continue;const a=e.getAttribLocation(t,n.name),i=On[n.type],s=i.setter(e,a,i);s.location=a,r[n.name]=s}return r}function yo(e,t){for(const r in t){const n=e[r];n&&n(t[r])}}function go(e,t,r){r.vertexArrayObject?e.bindVertexArray(r.vertexArrayObject):(yo(t.attribSetters||t,r.attribs),r.indices&&e.bindBuffer(34963,r.indices))}function bo(e,t){const r={program:t,uniformSetters:eo(e,t),attribSetters:ho(e,t)};return It(e)&&(r.uniformBlockSpec=oo(e,t),r.transformFeedbackInfo=to(e,t)),r}const xo=/\s|{|}|;/;function _o(e,t,r,n,o){const a=Dn(r,n,o),i=[];if(t=t.map((function(e){if(!xo.test(e)){const t=ln(e);if(t)e=t.text;else{const t=`no element with id: ${e}`;a.errorCallback(t),i.push(t)}}return e})),i.length)return Bn(a,"");const s=a.callback;s&&(a.callback=(t,r)=>{s(t,t?void 0:bo(e,r))});const l=Yn(e,t,a);return l?bo(e,l):null}function vo(e,t,r,n,o){for(const[a,i]of Object.entries(t)){const s={...o},l=r[a];Array.isArray(l)||Object.assign(s,l);const c=Xn(e,i,s.errorCallback);if(c){for(const r of Object.values(t)){const t=e.getAttachedShaders(r);e.deleteProgram(r);for(const r of t)n.has(r)||e.deleteShader(r)}return c}}}function wo(e,t,r={}){const n=new Set,o=Object.fromEntries(Object.entries(t).map((([t,o])=>{const a={...r},i=Array.isArray(o)?o:o.shaders;return Array.isArray(o)||Object.assign(a,o),i.forEach(n.add,n),[t,Un(e,i,a)]})));if(r.callback)return void async function(e,t){for(const r of Object.values(t))await Wn(e,r)}(e,o).then((()=>{const a=vo(e,o,t,n,r);r.callback(a,a?void 0:o)}));return vo(e,o,t,n,r)?void 0:o}function Ao(e,t,r){function n(e,t){return Object.fromEntries(Object.entries(t).map((([t,r])=>[t,bo(e,r)])))}const o=(r=Dn(r)).callback;o&&(r.callback=(t,r)=>{o(t,t?void 0:n(e,r))});const a=wo(e,t,r);if(!o&&a)return n(e,a)}const ko=Gn(wo),To=Gn(Ao);var Eo=Object.freeze({__proto__:null,createAttributeSetters:ho,createProgram:Vn,createProgramAsync:Hn,createPrograms:wo,createProgramsAsync:ko,createProgramFromScripts:Zn,createProgramFromSources:Yn,createProgramInfo:_o,createProgramInfoAsync:$n,createProgramInfos:Ao,createProgramInfosAsync:To,createProgramInfoFromProgram:bo,createUniformSetters:eo,createUniformBlockSpecFromProgram:oo,createUniformBlockInfoFromProgram:io,createUniformBlockInfo:so,createTransformFeedback:no,createTransformFeedbackInfo:to,bindTransformFeedbackInfo:ro,setAttributes:yo,setBuffersAndAttributes:go,setUniforms:po,setUniformsAndBindTextures:mo,setUniformBlock:co,setBlockUniforms:uo,bindUniformBlock:lo});function Fo(e,t,r,n,o,a){r=void 0===r?4:r;const i=t.indices,s=t.elementType,l=void 0===n?t.numElements:n;o=void 0===o?0:o,s||i?void 0!==a?e.drawElementsInstanced(r,l,void 0===s?5123:t.elementType,o,a):e.drawElements(r,l,void 0===s?5123:t.elementType,o):void 0!==a?e.drawArraysInstanced(r,o,l,a):e.drawArrays(r,o,l)}function So(e,t){let r=null,n=null;t.forEach((function(t){if(!1===t.active)return;const o=t.programInfo,a=t.vertexArrayInfo||t.bufferInfo;let i=!1;const s=void 0===t.type?4:t.type;o!==r&&(r=o,e.useProgram(o.program),i=!0),(i||a!==n)&&(n&&n.vertexArrayObject&&!a.vertexArrayObject&&e.bindVertexArray(null),n=a,go(e,o,a)),po(o,t.uniforms),Fo(e,a,s,t.count,t.offset,t.instanceCount)})),n&&n.vertexArrayObject&&e.bindVertexArray(null)}var Co=Object.freeze({__proto__:null,drawBufferInfo:Fo,drawObjectList:So});const Ro=36161,Po=34041,Oo=36064,Io=36096,Lo=33306,zo=33071,Bo=9729,Mo=[{format:6408,type:5121,min:Bo,wrap:zo},{format:Po}],Do={};Do[34041]=Lo,Do[6401]=36128,Do[36168]=36128,Do[6402]=Io,Do[33189]=Io,Do[33190]=Io,Do[36012]=Io,Do[35056]=Lo,Do[36013]=Lo;const jo={};jo[32854]=!0,jo[32855]=!0,jo[36194]=!0,jo[34041]=!0,jo[33189]=!0,jo[6401]=!0,jo[36168]=!0;function No(e,t,r,n){const o=36160,a=e.createFramebuffer();e.bindFramebuffer(o,a),r=r||e.drawingBufferWidth,n=n||e.drawingBufferHeight;const i=[],s={framebuffer:a,attachments:[],width:r,height:n};return(t=t||Mo).forEach((function(t,a){let l=t.attachment;const c=t.samples,u=t.format;let d=t.attachmentPoint||function(e,t){return Do[e]||Do[t]}(u,t.internalFormat);if(d||(d=Oo+a),function(e){return e>=Oo&&e<36096}(d)&&i.push(d),!l)if(void 0!==c||function(e){return jo[e]}(u))l=e.createRenderbuffer(),e.bindRenderbuffer(Ro,l),c>1?e.renderbufferStorageMultisample(Ro,c,u,r,n):e.renderbufferStorage(Ro,u,r,n);else{const o=Object.assign({},t);o.width=r,o.height=n,void 0===o.auto&&(o.auto=!1,o.min=o.min||o.minMag||Bo,o.mag=o.mag||o.minMag||Bo,o.wrapS=o.wrapS||o.wrap||zo,o.wrapT=o.wrapT||o.wrap||zo),l=tn(e,o)}if(lt(0,l))e.framebufferRenderbuffer(o,d,Ro,l);else{if(!ct(0,l))throw new Error("unknown attachment type");void 0!==t.layer?e.framebufferTextureLayer(o,d,l,t.level||0,t.layer):e.framebufferTexture2D(o,d,t.target||3553,l,t.level||0)}s.attachments.push(l)})),e.drawBuffers&&e.drawBuffers(i),s}function Uo(e,t,r,n,o){n=n||e.drawingBufferWidth,o=o||e.drawingBufferHeight,t.width=n,t.height=o,(r=r||Mo).forEach((function(r,a){const i=t.attachments[a],s=r.format,l=r.samples;if(void 0!==l||lt(0,i))e.bindRenderbuffer(Ro,i),l>1?e.renderbufferStorageMultisample(Ro,l,s,n,o):e.renderbufferStorage(Ro,s,n,o);else{if(!ct(0,i))throw new Error("unknown attachment type");rn(e,i,r,n,o)}}))}function Vo(e,t,r){r=r||36160,t?(e.bindFramebuffer(r,t.framebuffer),e.viewport(0,0,t.width,t.height)):(e.bindFramebuffer(r,null),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight))}var Go=Object.freeze({__proto__:null,bindFramebufferInfo:Vo,createFramebufferInfo:No,resizeFramebufferInfo:Uo});function Ho(e,t,r){const n=e.createVertexArray();return e.bindVertexArray(n),t.length||(t=[t]),t.forEach((function(t){go(e,t,r)})),e.bindVertexArray(null),{numElements:r.numElements,elementType:r.elementType,vertexArrayObject:n}}function $o(e,t,r,n){const o=e.createVertexArray();return e.bindVertexArray(o),yo(t,r),n&&e.bindBuffer(34963,n),e.bindVertexArray(null),o}function Wo(e,t,r){return $o(e,t.attribSetters||t,r.attribs,r.indices)}var Xo=Object.freeze({__proto__:null,createVertexArrayInfo:Ho,createVAOAndSetAttributes:$o,createVAOFromBufferInfo:Wo});const Zo={addExtensionsToContext:!0};const Yo=/^(.*?)_/;function Ko(e,t){zt(e,0);const r=e.getExtension(t);if(r){const n={},o=Yo.exec(t)[1],a="_"+o;for(const t in r){const i=r[t],s="function"==typeof i,l=s?o:a;let c=t;t.endsWith(l)&&(c=t.substring(0,t.length-l.length)),void 0!==e[c]?s||e[c]===i||at(c,e[c],i,t):s?e[c]=function(e){return function(){return e.apply(r,arguments)}}(i):(e[c]=i,n[c]=i)}n.constructor={name:r.constructor.name},zt(n,0)}return r}const qo=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function Jo(e){for(let t=0;t<qo.length;++t)Ko(e,qo[t])}var Qo=Object.freeze({__proto__:null,addExtensionsToContext:Jo,attributes:Ot,bindFramebufferInfo:Vo,bindTransformFeedbackInfo:ro,bindUniformBlock:lo,canFilter:Fr,canGenerateMipmap:Er,createAttribsFromArrays:Et,createAttributeSetters:ho,createBufferFromArray:Rt,createBufferFromTypedArray:ht,createBufferInfoFromArrays:Ct,createBuffersFromArrays:Pt,createFramebufferInfo:No,createProgram:Vn,createProgramAsync:Hn,createProgramFromScripts:Zn,createProgramFromSources:Yn,createProgramInfo:_o,createProgramInfoAsync:$n,createProgramInfoFromProgram:bo,createProgramInfos:Ao,createProgramInfosAsync:To,createPrograms:wo,createProgramsAsync:ko,createSampler:Dr,createSamplers:jr,createTexture:tn,createTextures:nn,createTransformFeedback:no,createTransformFeedbackInfo:to,createUniformBlockInfo:so,createUniformBlockInfoFromProgram:io,createUniformBlockSpecFromProgram:oo,createUniformSetters:eo,createVAOAndSetAttributes:$o,createVAOFromBufferInfo:Wo,createVertexArrayInfo:Ho,draw:Co,drawBufferInfo:Fo,drawObjectList:So,framebuffers:Go,getArray_:gt,getBytesPerElementForInternalFormat:Ar,getContext:function(e,t){return function(e,t){const r=["webgl2","webgl","experimental-webgl"];let n=null;for(let o=0;o<r.length;++o)if(n=e.getContext(r[o],t),n){Zo.addExtensionsToContext&&Jo(n);break}return n}(e,t)},getFormatAndTypeForInternalFormat:kr,getGLTypeForTypedArray:Je,getGLTypeForTypedArrayType:Qe,getNumComponentsForFormat:Sr,getNumComponents_:_t,getTypedArrayTypeForGLType:et,getWebGLContext:function(e,t){return function(e,t){const r=["webgl","experimental-webgl"];let n=null;for(let o=0;o<r.length;++o)if(n=e.getContext(r[o],t),n){Zo.addExtensionsToContext&&Jo(n);break}return n}(e,t)},glEnumToString:zt,isArrayBuffer:tt,isWebGL1:Lt,isWebGL2:It,loadTextureFromUrl:Kr,programs:Eo,resizeCanvasToDisplaySize:function(e,t){t=t||1,t=Math.max(0,t);const r=e.clientWidth*t|0,n=e.clientHeight*t|0;return(e.width!==r||e.height!==n)&&(e.width=r,e.height=n,!0)},resizeFramebufferInfo:Uo,resizeTexture:rn,setAttribInfoBufferFromArray:Ft,setAttributeDefaults_:pt,setAttributePrefix:ft,setAttributes:yo,setBlockUniforms:uo,setBuffersAndAttributes:go,setDefaultTextureColor:Pr,setDefaults:function(e){nt(e,Zo),pt(e),Or(e)},setEmptyTexture:en,setSamplerParameters:Mr,setTextureDefaults_:Or,setTextureFilteringForSize:Nr,setTextureFromArray:Qr,setTextureFromElement:Hr,setTextureParameters:Br,setUniformBlock:co,setUniforms:po,setUniformsAndBindTextures:mo,textures:on,typedarrays:rt,utils:Bt,vertexArrays:Xo});function ea(e,t,r,n,o){let a;if(o===function(e,t,r,n){let o=0;for(let a=t,i=r-n;a<r;a+=n)o+=(e[i]-e[a])*(e[a+1]+e[i+1]),i=a;return o}(e,t,r,n)>0)for(let o=t;o<r;o+=n)a=wa(o/n|0,e[o],e[o+1],a);else for(let o=r-n;o>=t;o-=n)a=wa(o/n|0,e[o],e[o+1],a);return a&&ya(a,a.next)&&(Aa(a),a=a.next),a}function ta(e,t){if(!e)return e;t||(t=e);let r,n=e;do{if(r=!1,n.steiner||!ya(n,n.next)&&0!==ha(n.prev,n,n.next))n=n.next;else{if(Aa(n),n=t=n.prev,n===n.next)break;r=!0}}while(r||n!==t);return t}function ra(e,t,r,n,o,a,i){if(!e)return;!i&&a&&function(e,t,r,n){let o=e;do{0===o.z&&(o.z=ua(o.x,o.y,t,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){let t,r=1;do{let n,o=e;e=null;let a=null;for(t=0;o;){t++;let i=o,s=0;for(let e=0;e<r&&(s++,i=i.nextZ,i);e++);let l=r;for(;s>0||l>0&&i;)0!==s&&(0===l||!i||o.z<=i.z)?(n=o,o=o.nextZ,s--):(n=i,i=i.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;o=i}a.nextZ=null,r*=2}while(t>1)}(o)}(e,n,o,a);let s=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(a?oa(e,n,o,a):na(e))t.push(l.i,e.i,c.i),Aa(e),e=c.next,s=c.next;else if((e=c)===s){i?1===i?ra(e=aa(ta(e),t),t,r,n,o,a,2):2===i&&ia(e,t,r,n,o,a):ra(ta(e),t,r,n,o,a,1);break}}}function na(e){const t=e.prev,r=e,n=e.next;if(ha(t,r,n)>=0)return!1;const o=t.x,a=r.x,i=n.x,s=t.y,l=r.y,c=n.y,u=Math.min(o,a,i),d=Math.min(s,l,c),f=Math.max(o,a,i),p=Math.max(s,l,c);let m=n.next;for(;m!==t;){if(m.x>=u&&m.x<=f&&m.y>=d&&m.y<=p&&pa(o,s,a,l,i,c,m.x,m.y)&&ha(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function oa(e,t,r,n){const o=e.prev,a=e,i=e.next;if(ha(o,a,i)>=0)return!1;const s=o.x,l=a.x,c=i.x,u=o.y,d=a.y,f=i.y,p=Math.min(s,l,c),m=Math.min(u,d,f),h=Math.max(s,l,c),y=Math.max(u,d,f),g=ua(p,m,t,r,n),b=ua(h,y,t,r,n);let x=e.prevZ,_=e.nextZ;for(;x&&x.z>=g&&_&&_.z<=b;){if(x.x>=p&&x.x<=h&&x.y>=m&&x.y<=y&&x!==o&&x!==i&&pa(s,u,l,d,c,f,x.x,x.y)&&ha(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,_.x>=p&&_.x<=h&&_.y>=m&&_.y<=y&&_!==o&&_!==i&&pa(s,u,l,d,c,f,_.x,_.y)&&ha(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=h&&x.y>=m&&x.y<=y&&x!==o&&x!==i&&pa(s,u,l,d,c,f,x.x,x.y)&&ha(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;_&&_.z<=b;){if(_.x>=p&&_.x<=h&&_.y>=m&&_.y<=y&&_!==o&&_!==i&&pa(s,u,l,d,c,f,_.x,_.y)&&ha(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function aa(e,t){let r=e;do{const n=r.prev,o=r.next.next;!ya(n,o)&&ga(n,r,r.next,o)&&_a(n,o)&&_a(o,n)&&(t.push(n.i,r.i,o.i),Aa(r),Aa(r.next),r=e=o),r=r.next}while(r!==e);return ta(r)}function ia(e,t,r,n,o,a){let i=e;do{let e=i.next.next;for(;e!==i.prev;){if(i.i!==e.i&&ma(i,e)){let s=va(i,e);return i=ta(i,i.next),s=ta(s,s.next),ra(i,t,r,n,o,a,0),void ra(s,t,r,n,o,a,0)}e=e.next}i=i.next}while(i!==e)}function sa(e,t){let r=e.x-t.x;if(0===r&&(r=e.y-t.y,0===r)){r=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)}return r}function la(e,t){const r=function(e,t){let r=t;const n=e.x,o=e.y;let a,i=-1/0;if(ya(e,r))return r;do{if(ya(e,r.next))return r.next;if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){const e=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=n&&e>i&&(i=e,a=r.x<r.next.x?r:r.next,e===n))return a}r=r.next}while(r!==t);if(!a)return null;const s=a,l=a.x,c=a.y;let u=1/0;r=a;do{if(n>=r.x&&r.x>=l&&n!==r.x&&fa(o<c?n:i,o,l,c,o<c?i:n,o,r.x,r.y)){const t=Math.abs(o-r.y)/(n-r.x);_a(r,e)&&(t<u||t===u&&(r.x>a.x||r.x===a.x&&ca(a,r)))&&(a=r,u=t)}r=r.next}while(r!==s);return a}(e,t);if(!r)return t;const n=va(r,e);return ta(n,n.next),ta(r,r.next)}function ca(e,t){return ha(e.prev,e,t.prev)<0&&ha(t.next,e,e.next)<0}function ua(e,t,r,n,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function da(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function fa(e,t,r,n,o,a,i,s){return(o-i)*(t-s)>=(e-i)*(a-s)&&(e-i)*(n-s)>=(r-i)*(t-s)&&(r-i)*(a-s)>=(o-i)*(n-s)}function pa(e,t,r,n,o,a,i,s){return!(e===i&&t===s)&&fa(e,t,r,n,o,a,i,s)}function ma(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&ga(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(_a(e,t)&&_a(t,e)&&function(e,t){let r=e,n=!1;const o=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&o<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(ha(e.prev,e,t.prev)||ha(e,t.prev,t))||ya(e,t)&&ha(e.prev,e,e.next)>0&&ha(t.prev,t,t.next)>0)}function ha(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function ya(e,t){return e.x===t.x&&e.y===t.y}function ga(e,t,r,n){const o=xa(ha(e,t,r)),a=xa(ha(e,t,n)),i=xa(ha(r,n,e)),s=xa(ha(r,n,t));return o!==a&&i!==s||(!(0!==o||!ba(e,r,t))||(!(0!==a||!ba(e,n,t))||(!(0!==i||!ba(r,e,n))||!(0!==s||!ba(r,t,n)))))}function ba(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function xa(e){return e>0?1:e<0?-1:0}function _a(e,t){return ha(e.prev,e,e.next)<0?ha(e,t,e.next)>=0&&ha(e,e.prev,t)>=0:ha(e,t,e.prev)<0||ha(e,e.next,t)<0}function va(e,t){const r=ka(e.i,e.x,e.y),n=ka(t.i,t.x,t.y),o=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=o,o.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function wa(e,t,r,n){const o=ka(e,t,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Aa(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ka(e,t,r){return{i:e,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}var Ta=Object.freeze({__proto__:null,default:function(e,t,r=2){const n=t&&t.length,o=n?t[0]*r:e.length;let a=ea(e,0,o,r,!0);const i=[];if(!a||a.next===a.prev)return i;let s,l,c;if(n&&(a=function(e,t,r,n){const o=[];for(let r=0,a=t.length;r<a;r++){const i=ea(e,t[r]*n,r<a-1?t[r+1]*n:e.length,n,!1);i===i.next&&(i.steiner=!0),o.push(da(i))}o.sort(sa);for(let e=0;e<o.length;e++)r=la(o[e],r);return r}(e,t,a,r)),e.length>80*r){s=1/0,l=1/0;let t=-1/0,n=-1/0;for(let a=r;a<o;a+=r){const r=e[a],o=e[a+1];r<s&&(s=r),o<l&&(l=o),r>t&&(t=r),o>n&&(n=o)}c=Math.max(t-s,n-l),c=0!==c?32767/c:0}return ra(a,i,r,s,l,c,0),i}});</script>
<script type="module">let count = 0;

class WLXCell {
    envs = []

    dispose() {
      console.warn('WLX cell dispose...');
      for (const env of this.envs) {
        for (const obj of Object.values(env.global.stack))  {
          console.log('dispose');
          obj.dispose();
        }
      }
    }
    
    constructor(parent, data) {
      let string = data;
      count++;

      const r = {
        fe: new RegExp(/FrontEndExecutable\[([^\[|\]]+)\]/g),
        feh: new RegExp(/FrontEndExecutableHold\[([^\[|\]]+)\]/g)
      };
      
      const fe = [];

      const self = this;

      const feReplacer = (fe, offset=0) => {
        return function (match, index) {
          const uid = match.slice(19 + offset,-1);
          count++;
          fe.push([uid, count]);
          return `<div id="wlx-${count}-${uid}" class="wlx-frontend-object"></div>`;
        }
      } 

      //extract FE objects
      string = string.replace(r.fe, feReplacer(fe));
      string = string.replace(r.feh, feReplacer(fe, 4));

      setInnerHTML(parent.element, string);
      parent.element.classList.add('padding-fix');

      const runOverFe = async function () {
        for (const o of fe) {
          const uid = o[0];
          const c   = o[1];

          const cuid = Date.now() + Math.floor(Math.random() * 10009);
          var global = {call: cuid};
      
          let env = {global: global, element: document.getElementById(`wlx-${c}-${uid}`)}; 
          console.log("WLX: creating an object with key "+self.name);


          console.log('forntend executable');

          let obj;
          console.log('check cache');
          if (ObjectHashMap[uid]) {
              obj = ObjectHashMap[uid];
          } else {
              obj = new ObjectStorage(uid);
          }
          console.log(obj);
      
          const copy = env;
          const store = await obj.get();
          const instance = new ExecutableObject('wlx-static-'+uuidv4(), copy, store, true);
          instance.assignScope(copy);
          obj.assign(instance);
      
          instance.execute();          
      
          self.envs.push(env);          
      };
    };

    runOverFe();

      return this;
    }
  }

  const codemirror = window.SupportedCells['codemirror'].context; 
  
  window.SupportedLanguages.push({
    check: (r) => {return(r[0] === '.wlx')},
    plugins: [codemirror.html()],
    name: codemirror.htmlLanguage.name
  });

  window.SupportedCells['wlx'] = {
    view: WLXCell
  };
</script>
<script type="module">let e;core.CreateUUID=async()=>uuidv4(),core["HTMLView`TemplateProcessor"]=async(e,t)=>{const n=await interpretate(e[0],t);t.htmlString=function(e,t){return e.replace(/#(\w+)/g,((e,n)=>void 0!==t[n]?t[n]:e))}(t.htmlString,n)},core["CoffeeLiqueur`Extensions`InputsOutputs`Tools`TemplateProcessor"]=core["HTMLView`TemplateProcessor"],core["HTMLView`InlineJSModule"]=async(e,t)=>{let n=await interpretate(e[0],t);n.includes("<script>")&&(n=n.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""));const o=document.createElement("script");o.appendChild(document.createTextNode("{\n"+n+"\n}")),t.element.appendChild(o)},core["CoffeeLiqueur`Extensions`InputsOutputs`Tools`InlineJSModule"]=core["HTMLView`InlineJSModule"],core["CoffeeLiqueur`Extensions`InputsOutputs`Tools`AnonymousJavascript"]=core["HTMLView`InlineJSModule"],core.HTMLView=async(e,t)=>{let n=await interpretate(e[0],t);const o=await core._getRules(e,{...t,hold:!0});Array.isArray(n)&&(n=n.join("\n")),t.htmlString=n,"Prolog"in o&&await interpretate(o.Prolog,t);const i=await setInnerHTMLAsync(t.element,t.htmlString);"Epilog"in o&&(console.log("Epilog"),await interpretate(o.Epilog,{...t,element:i}))},core.Prolog=()=>"Prolog",core.Epilog=()=>"Epilog",core["CoffeeLiqueur`Extensions`InputsOutputs`Private`HandleGroup"]=async(e,t)=>{const n=await interpretate(e[0],{...t,hold:!0}),o=t.element.querySelectorAll('[data-type="group"]')[0];for(const e of n){const n=document.createElement("div");o.appendChild(n),await interpretate(e,{...t,element:n})}},core["Notebook`Kernel`Inputs`Private`HandleGroup"]=core["CoffeeLiqueur`Extensions`InputsOutputs`Private`HandleGroup"],core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"]=async(e,t)=>{const n=await interpretate(e[1],t),o=await interpretate(e[0],t);t.local.uid=o;const i=core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"][o];t.local.el=i,i&&i.init(n,t)},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"].update=async(e,t)=>{const n=await interpretate(e[1],t);t.local.el.update(n,t)},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"].destroy=(e,t)=>{console.log("InternalElementCallback destroyed!"),delete t.local.el,delete core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"][t.local.uid]},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"].virtual=!0,core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"]=async(e,t)=>{const n=await interpretate(e[0],t),o=await interpretate(e[1],t),i=await interpretate(e[2],t);t.local.element=t.element.querySelectorAll(`[data-type="${o}"]`)[0],t.local.field=i,t.local.element[i]=n},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"].update=async(e,t)=>{const n=await interpretate(e[0],t);t.local.element[t.local.field]=n},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"].destroy=()=>{console.log("InternalElementUpdate destroyed!")},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"].virtual=!0,core["Notebook`Kernel`Inputs`Private`InternalElementUpdate"]=core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"],core.InternalWLXDestructor=async(e,t)=>{const n=await interpretate(e[0],t);t.local.uid=n,console.log("Registered an instance")},core.InternalWLXDestructor.destroy=async(e,t)=>{console.log(t.local.uid),core.InternalWLXDestructor[t.local.uid]||core.InternalWLXDestructor[t.local.uid](t),console.log("Removed an instance")},core.InternalWLXDestructor.virtual=!0,core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalWLXDestructor"]=core.InternalWLXDestructor,core.InternalHandleGroup=async(e,t)=>{const n=await interpretate(e[0],t),o=await interpretate(e[1],{...t,hold:!0}),i=document.getElementById(n);for(const e of o){const n=document.createElement("div");i.appendChild(n),await interpretate(e,{...t,element:n})}},core.InternalHandleTextView=async(e,t)=>{const n=await interpretate(e[0],t),o=await interpretate(e[1],t);t.local.element=document.getElementById(o),t.local.element.value=n},core.InternalHandleTextView.update=async(e,t)=>{const n=await interpretate(e[0],t);t.local.element.value=n},core.InternalHandleTextView.destroy=async(e,t)=>{console.log("InternalHandleTextView destroyed!")},core.InternalHandleTextView.virtual=!0,core.InternalHandleHTMLView=async(e,t)=>{const n=await interpretate(e[0],t),o=await interpretate(e[1],t);t.local.element=document.getElementById(o),t.local.element.innerHTML=n},core.InternalHandleHTMLView.update=async(e,t)=>{const n=await interpretate(e[0],t);t.local.element.innerHTML=n},core.InternalHandleHTMLView.destroy=async(e,t)=>{console.log("InternalHandleHTMLView destroyed!")},core.InternalHandleHTMLView.virtual=!0,window.base64ArrayBuffer=e=>{for(var t,n="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(e),s=i.byteLength,r=s%3,l=s-r,a=0;a<l;a+=3)n+=o[(16515072&(t=i[a]<<16|i[a+1]<<8|i[a+2]))>>18]+o[(258048&t)>>12]+o[(4032&t)>>6]+o[63&t];return 1==r?n+=o[(252&(t=i[l]))>>2]+o[(3&t)<<4]+"==":2==r&&(n+=o[(64512&(t=i[l]<<8|i[l+1]))>>10]+o[(1008&t)>>4]+o[(15&t)<<2]+"="),n};const t={"TypeSystem`Vector":async(e,t)=>({structure:await interpretate(e[0],t),number:await interpretate(e[1],t),vector:!0}),"TypeSystem`AnyLength":()=>{},"TypeSystem`Tuple":(e,t)=>interpretate(e[0],t),"TypeSystem`Assoc":async(e,t)=>{console.error(e);const n=await interpretate(e[0],t),o=await interpretate(e[1],t);console.warn(n);const i={};return Array.isArray(n)?(Array.isArray(o)?n.forEach(((e,t)=>{i[e]=o[t]})):n.forEach(((e,t)=>{i[e]=o})),i):o},"TypeSystem`Struct":async(e,t)=>{const n=await interpretate(e[0],t),o=await interpretate(e[1],t),i={};return n.forEach(((e,t)=>{Array.isArray(o[t])?(console.warn("KEY"),console.warn(o[t]),"object"==typeof o[t][0]||"function"==typeof o[t][0]?i[e]=o[t]:i[e]=async function(e,t,n){n.classList.add("font-medium","selectable"),n.innerText=await interpretate(e,t)}):i[e]=o[t]})),i}},n={};function o(e){return e instanceof Element}t["TypeSystem`Atom"]=async(e,t)=>await interpretate(e[0],{...t,context:n}),n.List=core.List,n["TypeSystem`Enumeration"]=async(e,t)=>e.map((e=>interpretate(e,t))),n.Integer=async(e,t)=>async function(e,t,n){const o=await interpretate(e,t);n.classList.add("selectable"),n.innerText=o};const i={};i.MixedUnit=core.List,i.Power=(e,t)=>{const n=interpretate(e[0],t),i=interpretate(e[1],t),s=document.createElement("span"),r=document.createElement("sup");return o(n)?s.appendChild(n):s.innerText=n,o(n)?r.appendChild(i):r.innerText=i,s.appendChild(r),s},i.Times=(e,t)=>{const n=e.map((e=>interpretate(e,t))),i=document.createElement("span");return n.forEach(((e,t)=>{if(o(e))i.appendChild(e);else{const t=document.createElement("text");t.innerText=e,i.appendChild(t)}if(t<n.length-1){const e=document.createElement("text");e.innerHTML="&middot;",i.appendChild(e)}})),i},n.Quantity=async(e,t)=>async function(e,t,n){if(n.classList.add("selectable"),"Association"==e[0]){const t=Object.keys(await interpretate(e,{hold:!0})),o=document.createElement("ul");for(const e of t){const t=document.createElement("li");t.innerText=e,o.appendChild(t)}o.style.maxHeight="4rem",n.style.overflowY="scroll",n.appendChild(o)}else if("Quantity"==e[0]){const o=await interpretate(e[1],t),s=await interpretate(e[2],{...t,context:i});s instanceof Element?(n.innerText=`${o} `,n.appendChild(s)):n.innerText=`${o} ${s}`}},n.Entity=async(e,t)=>async function(e,t,n){console.warn(e),n.classList.add("selectable"),n.innerText="No implemented"},n.Real=n.Integer,n.String=async(e,t)=>async function(e,t,n){const o=await interpretate(e,t);n.classList.add("selectable"),n.innerText=o},n["TypeSystem`Boolean"]=async(e,t)=>async function(e,t,n){const o=await interpretate(e,t);n.innerText=o?"✅":"❌"},n.DateObject=async(e,t)=>async function(e,t,n){const o=await interpretate(e[1],t),i=new Date(o[0],o[1]-1,o[2],o[3],o[4],o[5]);n.classList.add("text-xs","text-center","text-gray-800","selectable");const s=document.createElement("div");s.innerText=i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),n.appendChild(s);const r=document.createElement("span");r.innerText=i.toLocaleDateString(),n.appendChild(r)},n.Graphics=()=>async function(e,t,n,o){t.heavyLoad=!0;let i={global:{},element:n};console.log("frontend executable");const s=i,r=new ExecutableObject("dataset-stored-"+uuidv4(),s,e,!0);r.assignScope(s),r.execute(),o.instances.push(r)},n.Graphics3D=n.Graphics,n.Image=n.Graphics,t["TypeSystem`AnyType"]=()=>async function(e,t,n,o){t.heavyLoad=!0;const i=String(interpretate.hash(e));i in ObjectHashMap||(console.warn("Creating FE object by id "+i),server.kernel.send('CoffeeLiqueur`Extensions`InputsOutputs`Private`DatasetMakeBox["'+encodeURIComponent(JSON.stringify(e))+'", "'+i+'"]'));let s,r={global:{},element:n};console.log("Dataset: creating an object"),console.log("frontend executable"),console.log("check cache"),ObjectHashMap[i]?s=ObjectHashMap[i]:(s=new ObjectStorage(i),s.doNotCollect=!0,o.objects.push(s)),console.log(s);const l=r,a=await s.get(),h=new ExecutableObject("dataset-stored-"+uuidv4(),l,a,!0);h.assignScope(l),s.assign(h),h.execute(),o.instances.push(h)};const s={Entity:(e,t)=>interpretate(e[0],t)};core.Dataset=async(e,n)=>{const o=await core._getRules(e,n);console.log(n.options);const i=await interpretate(e[0],{...n,hold:!0,context:s});console.log(e);let r,l,a=await interpretate(e[1],{...n,context:t});console.warn(a);let h,c=[];const u=async e=>{let t;return Array.isArray(e)?(await Promise.all(e.map((async(t,o)=>{"Association"!=t[0]&&"List"!=t[0]?e[o]=t:e[o]=await interpretate(t,{...n,hold:!0})}))),Array.isArray(e[0])?(o.TableHeadings&&(r=o.TableHeadings),t=await Promise.all(e.map((async e=>Promise.all(e.map((async e=>e))))))):"function"==typeof a.structure||Array.isArray(a)?t=e.map((e=>[e])):(r=Object.keys(e[0]),t=await Promise.all(e.map((async e=>Promise.all(r.map((async t=>e[t])))))))):(l=Object.keys(e),t=await Promise.all(l.map((async t=>await interpretate(e[t],{...n,hold:!0})))),Array.isArray(t[0])?t=await Promise.all(t.map((async e=>Promise.all(e.map((async e=>e)))))):(r=Object.keys(t[0]),t=await Promise.all(t.map((async e=>Promise.all(r.map((async t=>e[t])))))))),t};if(Array.isArray(i))await Promise.all(i.map((async(e,t)=>{"Association"!=e[0]&&"List"!=e[0]?i[t]=e:i[t]=await interpretate(e,{...n,hold:!0})}))),Array.isArray(i[0])?(o.TableHeadings&&(r=o.TableHeadings),c=await Promise.all(i.map((async e=>Promise.all(e.map((async e=>e)))))),h=(e,t,n,o,i,s)=>{Array.isArray(a.structure)?a.structure[t](n,o,i,s):a.structure.structure(n,o,i,s)}):"function"==typeof a.structure||Array.isArray(a)?(h=Array.isArray(a)?(e,t,n,o,i,s)=>(console.warn(a[t]),a[e](n,o,i,s)):(e,t,n,o,i,s)=>a.structure(n,o,i,s),c=i.map((e=>[e]))):(r=Object.keys(i[0]),h=(e,t,n,o,i,s)=>a.structure[r[t]](n,o,i,s),c=await Promise.all(i.map((async e=>Promise.all(r.map((async t=>e[t])))))));else{l=Object.keys(i),console.error(i);let e=!1;if(c=await Promise.all(l.map((async t=>"Association"!=i[t][0]&&"List"!=i[t][0]?(console.log(i[t]),e=!0,i[t]):await interpretate(i[t],{...n,hold:!0,context:s})))),console.log(e),e&&(c=c.map((e=>[e]))),Array.isArray(c[0])){if(e){if(!Array.isArray(a)&&1==l.length){console.warn("Dirty fix applied for single-key items. I hate you Wolfram!");const e=a;a={},a[l[0]]=e}h=(e,t,n,o,i,s)=>{let r=a[l[e]];if(r||(r=a),r.structure){if(Array.isArray(n)){const e=document.createElement("table"),t=document.createElement("tbody");if(e.appendChild(t),n.length<5){const e=document.createElement("tr");n.forEach((t=>{const n=document.createElement("td");e.appendChild(n),r.structure(t,o,n,s)})),t.appendChild(e)}else n.forEach((e=>{const n=document.createElement("tr"),i=document.createElement("td");n.appendChild(i),t.appendChild(n),r.structure(e,o,i,s)}));return void i.appendChild(e)}return r.structure(n,o,i,s)}if(Array.isArray(r)){if(Array.isArray(n)){const e=document.createElement("table"),l=document.createElement("tbody");if(e.appendChild(l),n.length<5){const e=document.createElement("tr");n.forEach((n=>{const i=document.createElement("td");e.appendChild(i),r[t](n,o,i,s)})),l.appendChild(e)}else n.forEach((e=>{const n=document.createElement("tr"),i=document.createElement("td");n.appendChild(i),l.appendChild(n),r[t](e,o,i,s)}));return void i.appendChild(e)}return r[t](n,o,i,s)}return"object"==typeof r?Object.values(r)[0](n,o,i,s):r(n,o,i,s)}}else h=(e,t,n,o,i,s)=>{let r=a[l[e]];if(r||(r=a),r.structure){if(Array.isArray(n)){const e=document.createElement("table"),t=document.createElement("tbody");if(e.appendChild(t),n.length<5){const e=document.createElement("tr");n.forEach((t=>{const n=document.createElement("td");e.appendChild(n),r.structure(t,o,n,s)})),t.appendChild(e)}else n.forEach((e=>{const n=document.createElement("tr"),i=document.createElement("td");n.appendChild(i),t.appendChild(n),r.structure(e,o,i,s)}));return void i.appendChild(e)}return r.structure(n,o,i,s)}return Array.isArray(r)?r[t](n,o,i,s):(console.warn(a),console.warn(l),console.error("Unknown structure in data types!"),"")};c=await Promise.all(c.map((async e=>Promise.all(e.map((async e=>e))))))}else console.warn(c[0]),r=Object.keys(c[0]),e&&console.log("1D"),console.warn(r),console.warn(a),h=(e,t,n,o,i,s)=>"object"==typeof a[r[t]]?Object.values(a[r[t]])[0](n,o,i,s):(console.log(r[t]),console.log(a[r[t]]),a[r[t]](n,o,i,s)),c=await Promise.all(c.map((async e=>Promise.all(r.map((async t=>e[t])))))),console.log(c)}const d=n.element;d.classList.add(..."sm-controls cursor-default rounded-md 0 py-1 pl-3 bg-gray-100 pr-2 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs".split(" "));const g=document.createElement("div");g.classList.add(..."-m-1.5 overflow-x-auto".split(" "));const f=document.createElement("div");f.classList.add(..."p-1.5 inline-block align-middle".split(" "));const m=document.createElement("div");m.classList.add("overflow-hidden");const p=document.createElement("table");p.classList.add(..."block max-h-60 overflow-y-scroll sc-b pr-2 divide-y divide-gray-200".split(" ")),p.style.wordBreak="normal",p.style.wordWrap="initial",p.style.resize="both",p.style.maxWidth=Math.max(window.innerWidth-200*window.devicePixelRatio,300)+"px";let w,C=!1;if(p.addEventListener("mousedown",(()=>{C||(C=!0,p.style.height=p.clientHeight+"px",p.style.maxWidth="",p.classList.remove("max-h-60"),console.log("class removed"))})),o.ImageSize&&(Array.isArray(o.ImageSize)?("number"==typeof o.ImageSize[0]&&(p.style.width=o.ImageSize[0]+"px"),"number"==typeof o.ImageSize[1]&&(p.style.height=o.ImageSize[1]+"px")):"number"==typeof o.ImageSize&&(p.style.width=o.ImageSize+"px")),r){w=document.createElement("thead"),w.classList.add(..."sticky top-0 bg-gray-100".split(" "));const e=document.createElement("tr");if(w.appendChild(e),l){const t=document.createElement("th");t.classList.add(..."px-2 py-1 text-start text-xs font-medium text-gray-500 uppercase".split(" ")),e.appendChild(t)}r.forEach((t=>{const n=document.createElement("th");n.classList.add(..."px-2 py-1 text-start text-xs font-medium text-gray-500 uppercase".split(" ")),n.innerText=t,e.appendChild(n)}))}const y=document.createElement("tbody");let v;y.classList.add(..."max-h-10 divide-y divide-gray-200".split(" "));const b={instances:[],objects:[]};n.local.store=b;let S=0,R=0,E=0,M=1,T=0,x=0;const O=50,A=200,_={};let I=Math.ceil(c.length/A);if(_.rebuild=(e,t=50)=>{b.instances.forEach((e=>e.dispose())),b.instances=[],v=void 0,y.replaceChildren(),_.update(e,t,x)},_.update=(e,t=50)=>{v||(v=new Array(t).fill(null)),_.operate(e,0,t,x*A,((e,t)=>{v[t]?y.replaceChild(e,v[t]):y.appendChild(e),v[t]=e}))},_.extend=(e,t)=>{T+=t,_.operate(e,O+T-t,O+T,x*A,((e,t)=>{y.appendChild(e),v.push(e)}))},_.operate=(e,t,o,i,s)=>{for(let r=t;r<o&&r+i<e.length;++r){const t=document.createElement("tr");if(t.classList.add("hover:bg-gray-200"),l){const e=document.createElement("td");e.classList.add(..."px-2 py-1 whitespace-nowrap text-sm font-medium text-gray-800".split(" ")),e.innerText=l[r+i],t.appendChild(e)}e[r+i].forEach(((e,o)=>{const s=document.createElement("td");s.classList.add(..."px-2 py-1 whitespace-nowrap text-sm text-gray-800".split(" ")),h(r+i,o,e,n,s,b),t.appendChild(s)})),s(t,r)}},T=0,_.rebuild(c,O),g.appendChild(f),f.appendChild(m),m.appendChild(p),w&&p.appendChild(w),p.appendChild(y),I>1){const e=document.createElement("div");e.classList.add(..."py-1 border-solid items-center h-6 px-1 mb-1 w-full flex flex-row-reverse gap-x-2".split(" ")),e.style.borderTop="1px solid #999";const t=document.createElement("button");t.style.transform="rotate(180deg)",t.innerHTML='<svg class="w-3 h-3 text-gray-500 hover:text-gray-400" viewBox="0 0 24 24" fill="none" >\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5.46484 3.92349C4.79896 3.5739 4 4.05683 4 4.80888V19.1911C4 19.9432 4.79896 20.4261 5.46483 20.0765L19.1622 12.8854C19.8758 12.5108 19.8758 11.4892 19.1622 11.1146L5.46484 3.92349ZM2 4.80888C2 2.55271 4.3969 1.10395 6.39451 2.15269L20.0919 9.34382C22.2326 10.4677 22.2325 13.5324 20.0919 14.6562L6.3945 21.8473C4.39689 22.8961 2 21.4473 2 19.1911V4.80888Z" fill="currentColor"/>\n</svg>';const o=document.createElement("button");o.innerHTML='<svg class="w-3 h-3 text-gray-500 hover:text-gray-400" viewBox="0 0 24 24" fill="none" >\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18.3956 19.7691C19.0541 20.2687 20 19.799 20 18.9724L20 5.02764C20 4.20106 19.0541 3.73137 18.3956 4.23095L9.20476 11.2033C8.67727 11.6035 8.67727 12.3965 9.20476 12.7967L18.3956 19.7691ZM22 18.9724C22 21.4521 19.1624 22.8612 17.1868 21.3625L7.99598 14.3901C6.41353 13.1896 6.41353 10.8104 7.99599 9.60994L17.1868 2.63757C19.1624 1.13885 22 2.5479 22 5.02764L22 18.9724Z" fill="currentColor"/>\n<path d="M2 3C2 2.44772 2.44772 2 3 2C3.55228 2 4 2.44772 4 3V21C4 21.5523 3.55228 22 3 22C2.44772 22 2 21.5523 2 21V3Z" fill="currentColor"/>\n</svg>';const i=document.createElement("button");i.style.transform="rotate(180deg)",i.innerHTML=o.innerHTML;const s=document.createElement("button");s.innerHTML=t.innerHTML;const r=document.createElement("span");r.classList.add("mr-auto"),S=c.length,R=0;const l=e=>{const t=Math.min((e+1)*A+R,S);r.innerText=`${t}/${S}`};if(e.appendChild(i),e.appendChild(s),e.appendChild(t),e.appendChild(o),e.appendChild(r),n.options&&n.options.Parts){const t=document.createElement("span");t.innerText="Data is partially on Kernel",e.appendChild(t),S=n.options.Total,M=n.options.Parts,n.local.callback=()=>{},n.local.event=n.options.RequestEvent,core[n.options.RequestCallback]=async e=>{const t=await interpretate(e[0],{...n,hold:!0});n.local.callback(t)}}l(0);let a=!1;o.addEventListener("click",(()=>{a||(x=0,T=0,_.rebuild(c,O),l(x),p.scrollTop=0)})),i.addEventListener("click",(()=>{a||(x=I-1,T=0,_.rebuild(c,O),l(x),p.scrollTop=p.scrollHeight-p.clientHeight-10)})),s.addEventListener("click",(()=>{if(!a){if(x===I-1){if(E===M-1)return;return E+=1,R+=c.length,x=0,T=0,n.local.callback=async e=>{c=await u(e),I=Math.ceil(c.length/A),_.rebuild(c,O),l(x),p.scrollTop=0,a=!1},a=!0,void server.kernel.emitt(n.local.event,E+1)}x+=1,T=0,_.rebuild(c,O),l(x),p.scrollTop=0}})),t.addEventListener("click",(()=>{if(!a){if(0===x){if(0===E)return;return E-=1,R-=c.length,x=0,T=0,n.local.callback=async e=>{c=await u(e),I=Math.ceil(c.length/A),_.rebuild(c,O),l(x),p.scrollTop=0,a=!1},a=!0,void server.kernel.emitt(n.local.event,E+1)}x-=1,T=0,_.rebuild(c,O),l(x),p.scrollTop=p.scrollHeight-p.clientHeight-10}})),g.appendChild(e)}p.addEventListener("scroll",(()=>{if(p.scrollTop+p.clientHeight>=p.scrollHeight-10){if(T+O>=A)return;let e=20;e+T+O>=c.length&&(e=c.length-O-T),console.log("scroll overflow"),e>=0&&_.extend(c,e)}})),d.appendChild(g)},core.Dataset.destroy=(e,t)=>{t.local.store.instances.forEach((e=>{e.dispose()})),t.local.store.objects.forEach((e=>{e.doNotCollect=!1,e.garbageCollect()}))},core.Dataset.virtual=!0,core.Missing=()=>{},core.TableHeadings=()=>"TableHeadings",core.HandsontableView=async(t,n)=>{e||(e=(await Promise.resolve().then((function(){return LO}))).default),console.log(e);let o=async()=>"EOF";const i=await core._getRules(t,n),s=i.Height||200,r=i.Width||500;i.Loader&&(o=async(e,t)=>{console.log("ASk server!!!!!111");const o=await server.kernel.ask(i.Loader+"["+(e+1)+","+t+"]");console.log(o);const s=await interpretate(o,n);return"string"==typeof s?"EOF":[s.length,s]});const l=n.element;l.classList.add("font-sm","sm-controls"),l.style.display="inline-block";const a=document.createElement("div");l.appendChild(a),a.position="relative",a.display="block";const h=i.Overlay||150,c=i.Buffer||50;let u=await interpretate(t[0],n);if(server.kernel){const e=await server.kernel.ask(i.Loader+"[1,"+u.length+"]");console.log(e),"List"===e[0]&&(u=await interpretate(e,n))}let d=Math.min(u.length,h);i.Heading||u[0].forEach((()=>{}));let g=0,f=console.log;i.Event&&(f=(e,t)=>{"edit"===e&&(null==t[3]?server.kernel.emitt(i.Event,`{"Remove",${t[0]+g+1}, ${t[1]+1}, ${t[2]}}`):null==t[2]?server.kernel.emitt(i.Event,`{"Add",${t[0]+g+1}, ${t[1]+1}, ${t[3]}}`):server.kernel.emitt(i.Event,`{"Replace",${t[0]+g+1}, ${t[1]+1}, ${t[2]}, ${t[3]}}`)),"afterCreateRow"===e&&server.kernel.emitt(i.Event,`{"RowsAdd",${t[0]+g+1}, ${t[1]}}`),"afterRemoveRow"===e&&server.kernel.emitt(i.Event,`{"RowsRemove",${t[0]+g+1}, ${t[1]}}`),"afterCreateCol"===e&&server.kernel.emitt(i.Event,`{"ColsAdd",${t[0]+1}, ${t[1]}}`),"afterRemoveCol"===e&&server.kernel.emitt(i.Event,`{"ColsRemove",${t[0]+1}, ${t[1]}}`)}),console.log(u.slice(0,d));const m=new e(a,{data:u.slice(0,d),width:r,height:s,rowHeights:20,manualRowResize:!0,manualColumnResize:!0,manualColumnMove:!0,multiColumnSorting:!0,filters:!0,rowHeaders:e=>String(g+e+1),colHeaders:i.TableHeadings,manualRowMove:!0,renderAllRows:!1,contextMenu:!0,licenseKey:"non-commercial-and-evaluation",afterChange:function(e,t){"loadData"!==t&&"updateData"!==t&&(console.log(t),e.forEach((e=>f("edit",e))))}});m.addHook("afterScrollVertically",(async function(){const e=m.getPlugin("AutoRowSize").getLastVisibleRow(),t=m.getPlugin("AutoRowSize").getFirstVisibleRow();if(e>=d-1){const e=await o(g+c,h);if("EOF"===e)return void console.log("EOF");d=e[0],g+=c,m.suspendRender(),m.updateSettings({data:e[1]}),m.scrollViewportTo(t-c),m.resumeRender()}if(g>0&&t<1){g-=c;const e=await o(g,h);d=e[0],m.suspendRender(),m.updateSettings({data:e[1]}),m.scrollViewportTo(t+c),m.resumeRender()}})),m.addHook("afterCreateRow",((e,t)=>{f("afterCreateRow",[e,t]),console.log(`${t} row(s) were created, starting at index ${e}`)})),m.addHook("afterRemoveRow",((e,t)=>{f("afterRemoveRow",[e,t]),console.log(`${t} row(s) were removed, starting at index ${e}`)})),m.addHook("afterCreateCol",((e,t)=>{f("afterCreateCol",[e,t]),console.log(`${t} Col(s) were created, starting at index ${e}`)})),m.addHook("afterRemoveCol",((e,t)=>{f("afterRemoveCol",[e,t]),console.log(`${t} Col(s) were removed, starting at index ${e}`)})),n.local.hot=m},core.HandsontableView.virtual=!0,core.HandsontableView.update=()=>{console.error("HandsontableView updates are still not supported :(")},core.HandsontableView.destroy=(e,t)=>{console.warn("HandsontableView was destoryed"),t.local.hot&&t.local.hot.destroy()},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`HandsontableView"]=core.HandsontableView;var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function l(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var a=function(e){return e&&e.Math===Math&&e},h=a("object"==typeof globalThis&&globalThis)||a("object"==typeof window&&window)||a("object"==typeof self&&self)||a("object"==typeof r&&r)||a("object"==typeof r&&r)||function(){return this}()||Function("return this")(),c={},u=function(e){try{return!!e()}catch(e){return!0}},d=!u((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),g=!u((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),f=g,m=Function.prototype.call,p=f?m.bind(m):function(){return m.apply(m,arguments)},w={},C={}.propertyIsEnumerable,y=Object.getOwnPropertyDescriptor,v=y&&!C.call({1:2},1);w.f=v?function(e){var t=y(this,e);return!!t&&t.enumerable}:C;var b,S,R=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},E=g,M=Function.prototype,T=M.call,x=E&&M.bind.bind(T,T),O=E?x:function(e){return function(){return T.apply(e,arguments)}},A=O,_=A({}.toString),I=A("".slice),k=function(e){return I(_(e),8,-1)},H=u,D=k,N=Object,P=O("".split),L=H((function(){return!N("z").propertyIsEnumerable(0)}))?function(e){return"String"===D(e)?P(e,""):N(e)}:N,V=function(e){return null==e},F=V,B=TypeError,W=function(e){if(F(e))throw new B("Can't call method on "+e);return e},U=L,j=W,z=function(e){return U(j(e))},Y="object"==typeof document&&document.all,$=void 0===Y&&void 0!==Y?function(e){return"function"==typeof e||e===Y}:function(e){return"function"==typeof e},G=$,K=function(e){return"object"==typeof e?null!==e:G(e)},q=h,X=$,Z=function(e,t){return arguments.length<2?(n=q[e],X(n)?n:void 0):q[e]&&q[e][t];var n},J=O({}.isPrototypeOf),Q=h.navigator,ee=Q&&Q.userAgent,te=ee?String(ee):"",ne=h,oe=te,ie=ne.process,se=ne.Deno,re=ie&&ie.versions||se&&se.version,le=re&&re.v8;le&&(S=(b=le.split("."))[0]>0&&b[0]<4?1:+(b[0]+b[1])),!S&&oe&&(!(b=oe.match(/Edge\/(\d+)/))||b[1]>=74)&&(b=oe.match(/Chrome\/(\d+)/))&&(S=+b[1]);var ae=S,he=u,ce=h.String,ue=!!Object.getOwnPropertySymbols&&!he((function(){var e=Symbol("symbol detection");return!ce(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ae&&ae<41})),de=ue&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ge=Z,fe=$,me=J,pe=Object,we=de?function(e){return"symbol"==typeof e}:function(e){var t=ge("Symbol");return fe(t)&&me(t.prototype,pe(e))},Ce=String,ye=function(e){try{return Ce(e)}catch(e){return"Object"}},ve=$,be=ye,Se=TypeError,Re=function(e){if(ve(e))return e;throw new Se(be(e)+" is not a function")},Ee=Re,Me=V,Te=p,xe=$,Oe=K,Ae=TypeError,_e={exports:{}},Ie=h,ke=Object.defineProperty,He=function(e,t){try{ke(Ie,e,{value:t,configurable:!0,writable:!0})}catch(n){Ie[e]=t}return t},De=h,Ne=He,Pe="__core-js_shared__",Le=_e.exports=De[Pe]||Ne(Pe,{});(Le.versions||(Le.versions=[])).push({version:"3.41.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Ve=_e.exports,Fe=Ve,Be=function(e,t){return Fe[e]||(Fe[e]=t||{})},We=W,Ue=Object,je=function(e){return Ue(We(e))},ze=je,Ye=O({}.hasOwnProperty),$e=Object.hasOwn||function(e,t){return Ye(ze(e),t)},Ge=O,Ke=0,qe=Math.random(),Xe=Ge(1..toString),Ze=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Xe(++Ke+qe,36)},Je=Be,Qe=$e,et=Ze,tt=ue,nt=de,ot=h.Symbol,it=Je("wks"),st=nt?ot.for||ot:ot&&ot.withoutSetter||et,rt=function(e){return Qe(it,e)||(it[e]=tt&&Qe(ot,e)?ot[e]:st("Symbol."+e)),it[e]},lt=p,at=K,ht=we,ct=function(e,t){var n=e[t];return Me(n)?void 0:Ee(n)},ut=function(e,t){var n,o;if("string"===t&&xe(n=e.toString)&&!Oe(o=Te(n,e)))return o;if(xe(n=e.valueOf)&&!Oe(o=Te(n,e)))return o;if("string"!==t&&xe(n=e.toString)&&!Oe(o=Te(n,e)))return o;throw new Ae("Can't convert object to primitive value")},dt=TypeError,gt=rt("toPrimitive"),ft=function(e,t){if(!at(e)||ht(e))return e;var n,o=ct(e,gt);if(o){if(void 0===t&&(t="default"),n=lt(o,e,t),!at(n)||ht(n))return n;throw new dt("Can't convert object to primitive value")}return void 0===t&&(t="number"),ut(e,t)},mt=we,pt=function(e){var t=ft(e,"string");return mt(t)?t:t+""},wt=K,Ct=h.document,yt=wt(Ct)&&wt(Ct.createElement),vt=function(e){return yt?Ct.createElement(e):{}},bt=vt,St=!d&&!u((function(){return 7!==Object.defineProperty(bt("div"),"a",{get:function(){return 7}}).a})),Rt=d,Et=p,Mt=w,Tt=R,xt=z,Ot=pt,At=$e,_t=St,It=Object.getOwnPropertyDescriptor;c.f=Rt?It:function(e,t){if(e=xt(e),t=Ot(t),_t)try{return It(e,t)}catch(e){}if(At(e,t))return Tt(!Et(Mt.f,e,t),e[t])};var kt={},Ht=d&&u((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Dt=K,Nt=String,Pt=TypeError,Lt=function(e){if(Dt(e))return e;throw new Pt(Nt(e)+" is not an object")},Vt=d,Ft=St,Bt=Ht,Wt=Lt,Ut=pt,jt=TypeError,zt=Object.defineProperty,Yt=Object.getOwnPropertyDescriptor,$t="enumerable",Gt="configurable",Kt="writable";kt.f=Vt?Bt?function(e,t,n){if(Wt(e),t=Ut(t),Wt(n),"function"==typeof e&&"prototype"===t&&"value"in n&&Kt in n&&!n[Kt]){var o=Yt(e,t);o&&o[Kt]&&(e[t]=n.value,n={configurable:Gt in n?n[Gt]:o[Gt],enumerable:$t in n?n[$t]:o[$t],writable:!1})}return zt(e,t,n)}:zt:function(e,t,n){if(Wt(e),t=Ut(t),Wt(n),Ft)try{return zt(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new jt("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var qt=kt,Xt=R,Zt=d?function(e,t,n){return qt.f(e,t,Xt(1,n))}:function(e,t,n){return e[t]=n,e},Jt={exports:{}},Qt=d,en=$e,tn=Function.prototype,nn=Qt&&Object.getOwnPropertyDescriptor,on=en(tn,"name"),sn={EXISTS:on,PROPER:on&&"something"===function(){}.name,CONFIGURABLE:on&&(!Qt||Qt&&nn(tn,"name").configurable)},rn=$,ln=Ve,an=O(Function.toString);rn(ln.inspectSource)||(ln.inspectSource=function(e){return an(e)});var hn,cn,un,dn=ln.inspectSource,gn=$,fn=h.WeakMap,mn=gn(fn)&&/native code/.test(String(fn)),pn=Ze,wn=Be("keys"),Cn=function(e){return wn[e]||(wn[e]=pn(e))},yn={},vn=mn,bn=h,Sn=K,Rn=Zt,En=$e,Mn=Ve,Tn=Cn,xn=yn,On="Object already initialized",An=bn.TypeError,_n=bn.WeakMap;if(vn||Mn.state){var In=Mn.state||(Mn.state=new _n);In.get=In.get,In.has=In.has,In.set=In.set,hn=function(e,t){if(In.has(e))throw new An(On);return t.facade=e,In.set(e,t),t},cn=function(e){return In.get(e)||{}},un=function(e){return In.has(e)}}else{var kn=Tn("state");xn[kn]=!0,hn=function(e,t){if(En(e,kn))throw new An(On);return t.facade=e,Rn(e,kn,t),t},cn=function(e){return En(e,kn)?e[kn]:{}},un=function(e){return En(e,kn)}}var Hn={set:hn,get:cn,has:un,enforce:function(e){return un(e)?cn(e):hn(e,{})},getterFor:function(e){return function(t){var n;if(!Sn(t)||(n=cn(t)).type!==e)throw new An("Incompatible receiver, "+e+" required");return n}}},Dn=O,Nn=u,Pn=$,Ln=$e,Vn=d,Fn=sn.CONFIGURABLE,Bn=dn,Wn=Hn.enforce,Un=Hn.get,jn=String,zn=Object.defineProperty,Yn=Dn("".slice),$n=Dn("".replace),Gn=Dn([].join),Kn=Vn&&!Nn((function(){return 8!==zn((function(){}),"length",{value:8}).length})),qn=String(String).split("String"),Xn=Jt.exports=function(e,t,n){"Symbol("===Yn(jn(t),0,7)&&(t="["+$n(jn(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!Ln(e,"name")||Fn&&e.name!==t)&&(Vn?zn(e,"name",{value:t,configurable:!0}):e.name=t),Kn&&n&&Ln(n,"arity")&&e.length!==n.arity&&zn(e,"length",{value:n.arity});try{n&&Ln(n,"constructor")&&n.constructor?Vn&&zn(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var o=Wn(e);return Ln(o,"source")||(o.source=Gn(qn,"string"==typeof t?t:"")),e};Function.prototype.toString=Xn((function(){return Pn(this)&&Un(this).source||Bn(this)}),"toString");var Zn=Jt.exports,Jn=$,Qn=kt,eo=Zn,to=He,no={},oo=Math.ceil,io=Math.floor,so=Math.trunc||function(e){var t=+e;return(t>0?io:oo)(t)},ro=function(e){var t=+e;return t!=t||0===t?0:so(t)},lo=ro,ao=Math.max,ho=Math.min,co=ro,uo=Math.min,go=function(e){var t=co(e);return t>0?uo(t,9007199254740991):0},fo=function(e){return go(e.length)},mo=z,po=function(e,t){var n=lo(e);return n<0?ao(n+t,0):ho(n,t)},wo=fo,Co=function(e){return function(t,n,o){var i=mo(t),s=wo(i);if(0===s)return!e&&-1;var r,l=po(o,s);if(e&&n!=n){for(;s>l;)if((r=i[l++])!=r)return!0}else for(;s>l;l++)if((e||l in i)&&i[l]===n)return e||l||0;return!e&&-1}},yo={includes:Co(!0),indexOf:Co(!1)},vo=$e,bo=z,So=yo.indexOf,Ro=yn,Eo=O([].push),Mo=function(e,t){var n,o=bo(e),i=0,s=[];for(n in o)!vo(Ro,n)&&vo(o,n)&&Eo(s,n);for(;t.length>i;)vo(o,n=t[i++])&&(~So(s,n)||Eo(s,n));return s},To=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],xo=Mo,Oo=To.concat("length","prototype");no.f=Object.getOwnPropertyNames||function(e){return xo(e,Oo)};var Ao={};Ao.f=Object.getOwnPropertySymbols;var _o=Z,Io=no,ko=Ao,Ho=Lt,Do=O([].concat),No=_o("Reflect","ownKeys")||function(e){var t=Io.f(Ho(e)),n=ko.f;return n?Do(t,n(e)):t},Po=$e,Lo=No,Vo=c,Fo=kt,Bo=function(e,t,n){for(var o=Lo(t),i=Fo.f,s=Vo.f,r=0;r<o.length;r++){var l=o[r];Po(e,l)||n&&Po(n,l)||i(e,l,s(t,l))}},Wo=u,Uo=$,jo=/#|\.prototype\./,zo=function(e,t){var n=$o[Yo(e)];return n===Ko||n!==Go&&(Uo(t)?Wo(t):!!t)},Yo=zo.normalize=function(e){return String(e).replace(jo,".").toLowerCase()},$o=zo.data={},Go=zo.NATIVE="N",Ko=zo.POLYFILL="P",qo=zo,Xo=h,Zo=c.f,Jo=Zt,Qo=function(e,t,n,o){o||(o={});var i=o.enumerable,s=void 0!==o.name?o.name:t;if(Jn(n)&&eo(n,s,o),o.global)i?e[t]=n:to(t,n);else{try{o.unsafe?e[t]&&(i=!0):delete e[t]}catch(e){}i?e[t]=n:Qn.f(e,t,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e},ei=He,ti=Bo,ni=qo,oi=function(e,t){var n,o,i,s,r,l=e.target,a=e.global,h=e.stat;if(n=a?Xo:h?Xo[l]||ei(l,{}):Xo[l]&&Xo[l].prototype)for(o in t){if(s=t[o],i=e.dontCallGetSet?(r=Zo(n,o))&&r.value:n[o],!ni(a?o:l+(h?".":"#")+o,e.forced)&&void 0!==i){if(typeof s==typeof i)continue;ti(s,i)}(e.sham||i&&i.sham)&&Jo(s,"sham",!0),Qo(n,o,s,e)}},ii=k,si=Array.isArray||function(e){return"Array"===ii(e)},ri=d,li=si,ai=TypeError,hi=Object.getOwnPropertyDescriptor,ci=ri&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),ui=ci?function(e,t){if(li(e)&&!hi(e,"length").writable)throw new ai("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},di=TypeError,gi=function(e){if(e>9007199254740991)throw di("Maximum allowed index exceeded");return e},fi=oi,mi=je,pi=fo,wi=ui,Ci=gi,yi=u((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}();fi({target:"Array",proto:!0,arity:1,forced:yi},{push:function(e){var t=mi(this),n=pi(t),o=arguments.length;Ci(n+o);for(var i=0;i<o;i++)t[n]=arguments[i],n++;return wi(t,n),n}});var vi=g,bi=Function.prototype,Si=bi.apply,Ri=bi.call,Ei="object"==typeof Reflect&&Reflect.apply||(vi?Ri.bind(Si):function(){return Ri.apply(Si,arguments)}),Mi=O,Ti=Re,xi=K,Oi=function(e){return xi(e)||null===e},Ai=String,_i=TypeError,Ii=function(e,t,n){try{return Mi(Ti(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}},ki=K,Hi=W,Di=function(e){if(Oi(e))return e;throw new _i("Can't set "+Ai(e)+" as a prototype")},Ni=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Ii(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,o){return Hi(n),Di(o),ki(n)?(t?e(n,o):n.__proto__=o,n):n}}():void 0),Pi=kt.f,Li=$,Vi=K,Fi=Ni,Bi={};Bi[rt("toStringTag")]="z";var Wi="[object z]"===String(Bi),Ui=$,ji=k,zi=rt("toStringTag"),Yi=Object,$i="Arguments"===ji(function(){return arguments}()),Gi=Wi?ji:function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Yi(e),zi))?n:$i?ji(t):"Object"===(o=ji(t))&&Ui(t.callee)?"Arguments":o},Ki=String,qi=function(e){if("Symbol"===Gi(e))throw new TypeError("Cannot convert a Symbol value to a string");return Ki(e)},Xi=qi,Zi=K,Ji=Zt,Qi=Error,es=O("".replace),ts=String(new Qi("zxcasd").stack),ns=/\n\s*at [^:]*:[^\n]*/,os=ns.test(ts),is=R,ss=!u((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",is(1,7)),7!==e.stack)})),rs=Zt,ls=function(e,t){if(os&&"string"==typeof e&&!Qi.prepareStackTrace)for(;t--;)e=es(e,ns,"");return e},as=ss,hs=Error.captureStackTrace,cs=Z,us=$e,ds=Zt,gs=J,fs=Ni,ms=Bo,ps=function(e,t,n){n in e||Pi(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})},ws=function(e,t,n){var o,i;return Fi&&Li(o=t.constructor)&&o!==n&&Vi(i=o.prototype)&&i!==n.prototype&&Fi(e,i),e},Cs=function(e,t){return void 0===e?arguments.length<2?"":t:Xi(e)},ys=function(e,t){Zi(t)&&"cause"in t&&Ji(e,"cause",t.cause)},vs=function(e,t,n,o){as&&(hs?hs(e,t):rs(e,"stack",ls(n,o)))},bs=d,Ss=oi,Rs=Ei,Es=function(e,t,n,o){var i="stackTraceLimit",s=o?2:1,r=e.split("."),l=r[r.length-1],a=cs.apply(null,r);if(a){var h=a.prototype;if(us(h,"cause")&&delete h.cause,!n)return a;var c=cs("Error"),u=t((function(e,t){var n=Cs(o?t:e,void 0),i=o?new a(e):new a;return void 0!==n&&ds(i,"message",n),vs(i,u,i.stack,2),this&&gs(h,this)&&ws(i,this,u),arguments.length>s&&ys(i,arguments[s]),i}));u.prototype=h,"Error"!==l?fs?fs(u,c):ms(u,c,{name:!0}):bs&&i in a&&(ps(u,a,i),ps(u,a,"prepareStackTrace")),ms(u,a);try{h.name!==l&&ds(h,"name",l),h.constructor=u}catch(e){}return u}},Ms="WebAssembly",Ts=h[Ms],xs=7!==new Error("e",{cause:7}).cause,Os=function(e,t){var n={};n[e]=Es(e,t,xs),Ss({global:!0,constructor:!0,arity:1,forced:xs},n)},As=function(e,t){if(Ts&&Ts[e]){var n={};n[e]=Es(Ms+"."+e,t,xs),Ss({target:Ms,stat:!0,constructor:!0,arity:1,forced:xs},n)}};Os("Error",(function(e){return function(t){return Rs(e,this,arguments)}})),Os("EvalError",(function(e){return function(t){return Rs(e,this,arguments)}})),Os("RangeError",(function(e){return function(t){return Rs(e,this,arguments)}})),Os("ReferenceError",(function(e){return function(t){return Rs(e,this,arguments)}})),Os("SyntaxError",(function(e){return function(t){return Rs(e,this,arguments)}})),Os("TypeError",(function(e){return function(t){return Rs(e,this,arguments)}})),Os("URIError",(function(e){return function(t){return Rs(e,this,arguments)}})),As("CompileError",(function(e){return function(t){return Rs(e,this,arguments)}})),As("LinkError",(function(e){return function(t){return Rs(e,this,arguments)}})),As("RuntimeError",(function(e){return function(t){return Rs(e,this,arguments)}}));var _s,Is,ks,Hs,Ds=k,Ns=O,Ps=function(e){if("Function"===Ds(e))return Ns(e)},Ls=Re,Vs=g,Fs=Ps(Ps.bind),Bs=Z("document","documentElement"),Ws=O([].slice),Us=TypeError,js=function(e,t){if(e<t)throw new Us("Not enough arguments");return e},zs=/(?:ipad|iphone|ipod).*applewebkit/i.test(te),Ys=h,$s=te,Gs=k,Ks=function(e){return $s.slice(0,e.length)===e},qs=Ks("Bun/")?"BUN":Ks("Cloudflare-Workers")?"CLOUDFLARE":Ks("Deno/")?"DENO":Ks("Node.js/")?"NODE":Ys.Bun&&"string"==typeof Bun.version?"BUN":Ys.Deno&&"object"==typeof Deno.version?"DENO":"process"===Gs(Ys.process)?"NODE":Ys.window&&Ys.document?"BROWSER":"REST",Xs=h,Zs=Ei,Js=function(e,t){return Ls(e),void 0===t?e:Vs?Fs(e,t):function(){return e.apply(t,arguments)}},Qs=$,er=$e,tr=u,nr=Bs,or=Ws,ir=vt,sr=js,rr=zs,lr="NODE"===qs,ar=Xs.setImmediate,hr=Xs.clearImmediate,cr=Xs.process,ur=Xs.Dispatch,dr=Xs.Function,gr=Xs.MessageChannel,fr=Xs.String,mr=0,pr={},wr="onreadystatechange";tr((function(){_s=Xs.location}));var Cr=function(e){if(er(pr,e)){var t=pr[e];delete pr[e],t()}},yr=function(e){return function(){Cr(e)}},vr=function(e){Cr(e.data)},br=function(e){Xs.postMessage(fr(e),_s.protocol+"//"+_s.host)};ar&&hr||(ar=function(e){sr(arguments.length,1);var t=Qs(e)?e:dr(e),n=or(arguments,1);return pr[++mr]=function(){Zs(t,void 0,n)},Is(mr),mr},hr=function(e){delete pr[e]},lr?Is=function(e){cr.nextTick(yr(e))}:ur&&ur.now?Is=function(e){ur.now(yr(e))}:gr&&!rr?(Hs=(ks=new gr).port2,ks.port1.onmessage=vr,Is=Js(Hs.postMessage,Hs)):Xs.addEventListener&&Qs(Xs.postMessage)&&!Xs.importScripts&&_s&&"file:"!==_s.protocol&&!tr(br)?(Is=br,Xs.addEventListener("message",vr,!1)):Is=wr in ir("script")?function(e){nr.appendChild(ir("script"))[wr]=function(){nr.removeChild(this),Cr(e)}}:function(e){setTimeout(yr(e),0)});var Sr={set:ar,clear:hr},Rr=Sr.clear;oi({global:!0,bind:!0,enumerable:!0,forced:h.clearImmediate!==Rr},{clearImmediate:Rr});var Er=h,Mr=Ei,Tr=$,xr=qs,Or=te,Ar=Ws,_r=js,Ir=Er.Function,kr=/MSIE .\./.test(Or)||"BUN"===xr&&function(){var e=Er.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),Hr=oi,Dr=h,Nr=Sr.set,Pr=function(e,t){var n=t?2:1;return kr?function(o,i){var s=_r(arguments.length,1)>n,r=Tr(o)?o:Ir(o),l=s?Ar(arguments,n):[],a=s?function(){Mr(r,this,l)}:r;return t?e(a,i):e(a)}:e},Lr=Dr.setImmediate?Pr(Nr,!1):Nr;
/*! @license DOMPurify 2.5.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.8/LICENSE */
function Vr(e){return Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vr(e)}function Fr(e,t){return Fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Fr(e,t)}function Br(e,t,n){return Br=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&Fr(i,n.prototype),i},Br.apply(null,arguments)}function Wr(e){return function(e){if(Array.isArray(e))return Ur(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ur(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ur(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ur(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}Hr({global:!0,bind:!0,enumerable:!0,forced:Dr.setImmediate!==Lr},{setImmediate:Lr});var jr=Object.hasOwnProperty,zr=Object.setPrototypeOf,Yr=Object.isFrozen,$r=Object.getPrototypeOf,Gr=Object.getOwnPropertyDescriptor,Kr=Object.freeze,qr=Object.seal,Xr=Object.create,Zr="undefined"!=typeof Reflect&&Reflect,Jr=Zr.apply,Qr=Zr.construct;Jr||(Jr=function(e,t,n){return e.apply(t,n)}),Kr||(Kr=function(e){return e}),qr||(qr=function(e){return e}),Qr||(Qr=function(e,t){return Br(e,Wr(t))});var el,tl=dl(Array.prototype.forEach),nl=dl(Array.prototype.pop),ol=dl(Array.prototype.push),il=dl(String.prototype.toLowerCase),sl=dl(String.prototype.toString),rl=dl(String.prototype.match),ll=dl(String.prototype.replace),al=dl(String.prototype.indexOf),hl=dl(String.prototype.trim),cl=dl(RegExp.prototype.test),ul=(el=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qr(el,t)});function dl(e){return function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return Jr(e,t,o)}}function gl(e,t,n){var o;n=null!==(o=n)&&void 0!==o?o:il,zr&&zr(e,null);for(var i=t.length;i--;){var s=t[i];if("string"==typeof s){var r=n(s);r!==s&&(Yr(t)||(t[i]=r),s=r)}e[s]=!0}return e}function fl(e){var t,n=Xr(null);for(t in e)!0===Jr(jr,e,[t])&&(n[t]=e[t]);return n}function ml(e,t){for(;null!==e;){var n=Gr(e,t);if(n){if(n.get)return dl(n.get);if("function"==typeof n.value)return dl(n.value)}e=$r(e)}return function(e){return console.warn("fallback value for",e),null}}var pl=Kr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),wl=Kr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Cl=Kr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),yl=Kr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),vl=Kr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),bl=Kr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Sl=Kr(["#text"]),Rl=Kr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),El=Kr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ml=Kr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Tl=Kr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xl=qr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ol=qr(/<%[\w\W]*|[\w\W]*%>/gm),Al=qr(/\${[\w\W]*}/gm),_l=qr(/^data-[\-\w.\u00B7-\uFFFF]+$/),Il=qr(/^aria-[\-\w]+$/),kl=qr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Hl=qr(/^(?:\w+script|data):/i),Dl=qr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Nl=qr(/^html$/i),Pl=qr(/^[a-z][.\w]*(-[.\w]+)+$/i),Ll=function(){return"undefined"==typeof window?null:window};var Vl=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ll(),n=function(t){return e(t)};if(n.version="2.5.8",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var o=t.document,i=t.document,s=t.DocumentFragment,r=t.HTMLTemplateElement,l=t.Node,a=t.Element,h=t.NodeFilter,c=t.NamedNodeMap,u=void 0===c?t.NamedNodeMap||t.MozNamedAttrMap:c,d=t.HTMLFormElement,g=t.DOMParser,f=t.trustedTypes,m=a.prototype,p=ml(m,"cloneNode"),w=ml(m,"nextSibling"),C=ml(m,"childNodes"),y=ml(m,"parentNode");if("function"==typeof r){var v=i.createElement("template");v.content&&v.content.ownerDocument&&(i=v.content.ownerDocument)}var b=function(e,t){if("object"!==Vr(e)||"function"!=typeof e.createPolicy)return null;var n=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(n=t.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(f,o),S=b?b.createHTML(""):"",R=i,E=R.implementation,M=R.createNodeIterator,T=R.createDocumentFragment,x=R.getElementsByTagName,O=o.importNode,A={};try{A=fl(i).documentMode?i.documentMode:{}}catch(e){}var _={};n.isSupported="function"==typeof y&&E&&void 0!==E.createHTMLDocument&&9!==A;var I,k,H=xl,D=Ol,N=Al,P=_l,L=Il,V=Hl,F=Dl,B=Pl,W=kl,U=null,j=gl({},[].concat(Wr(pl),Wr(wl),Wr(Cl),Wr(vl),Wr(Sl))),z=null,Y=gl({},[].concat(Wr(Rl),Wr(El),Wr(Ml),Wr(Tl))),$=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),G=null,K=null,q=!0,X=!0,Z=!1,J=!0,Q=!1,ee=!0,te=!1,ne=!1,oe=!1,ie=!1,se=!1,re=!1,le=!0,ae=!1,he=!0,ce=!1,ue={},de=null,ge=gl({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),fe=null,me=gl({},["audio","video","img","source","image","track"]),pe=null,we=gl({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ce="http://www.w3.org/1998/Math/MathML",ye="http://www.w3.org/2000/svg",ve="http://www.w3.org/1999/xhtml",be=ve,Se=!1,Re=null,Ee=gl({},[Ce,ye,ve],sl),Me=["application/xhtml+xml","text/html"],Te=null,xe=i.createElement("form"),Oe=function(e){return e instanceof RegExp||e instanceof Function},Ae=function(e){Te&&Te===e||(e&&"object"===Vr(e)||(e={}),e=fl(e),I=I=-1===Me.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,k="application/xhtml+xml"===I?sl:il,U="ALLOWED_TAGS"in e?gl({},e.ALLOWED_TAGS,k):j,z="ALLOWED_ATTR"in e?gl({},e.ALLOWED_ATTR,k):Y,Re="ALLOWED_NAMESPACES"in e?gl({},e.ALLOWED_NAMESPACES,sl):Ee,pe="ADD_URI_SAFE_ATTR"in e?gl(fl(we),e.ADD_URI_SAFE_ATTR,k):we,fe="ADD_DATA_URI_TAGS"in e?gl(fl(me),e.ADD_DATA_URI_TAGS,k):me,de="FORBID_CONTENTS"in e?gl({},e.FORBID_CONTENTS,k):ge,G="FORBID_TAGS"in e?gl({},e.FORBID_TAGS,k):{},K="FORBID_ATTR"in e?gl({},e.FORBID_ATTR,k):{},ue="USE_PROFILES"in e&&e.USE_PROFILES,q=!1!==e.ALLOW_ARIA_ATTR,X=!1!==e.ALLOW_DATA_ATTR,Z=e.ALLOW_UNKNOWN_PROTOCOLS||!1,J=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Q=e.SAFE_FOR_TEMPLATES||!1,ee=!1!==e.SAFE_FOR_XML,te=e.WHOLE_DOCUMENT||!1,ie=e.RETURN_DOM||!1,se=e.RETURN_DOM_FRAGMENT||!1,re=e.RETURN_TRUSTED_TYPE||!1,oe=e.FORCE_BODY||!1,le=!1!==e.SANITIZE_DOM,ae=e.SANITIZE_NAMED_PROPS||!1,he=!1!==e.KEEP_CONTENT,ce=e.IN_PLACE||!1,W=e.ALLOWED_URI_REGEXP||W,be=e.NAMESPACE||ve,$=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Oe(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&($.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Oe(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&($.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&($.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Q&&(X=!1),se&&(ie=!0),ue&&(U=gl({},Wr(Sl)),z=[],!0===ue.html&&(gl(U,pl),gl(z,Rl)),!0===ue.svg&&(gl(U,wl),gl(z,El),gl(z,Tl)),!0===ue.svgFilters&&(gl(U,Cl),gl(z,El),gl(z,Tl)),!0===ue.mathMl&&(gl(U,vl),gl(z,Ml),gl(z,Tl))),e.ADD_TAGS&&(U===j&&(U=fl(U)),gl(U,e.ADD_TAGS,k)),e.ADD_ATTR&&(z===Y&&(z=fl(z)),gl(z,e.ADD_ATTR,k)),e.ADD_URI_SAFE_ATTR&&gl(pe,e.ADD_URI_SAFE_ATTR,k),e.FORBID_CONTENTS&&(de===ge&&(de=fl(de)),gl(de,e.FORBID_CONTENTS,k)),he&&(U["#text"]=!0),te&&gl(U,["html","head","body"]),U.table&&(gl(U,["tbody"]),delete G.tbody),Kr&&Kr(e),Te=e)},_e=gl({},["mi","mo","mn","ms","mtext"]),Ie=gl({},["annotation-xml"]),ke=gl({},["title","style","font","a","script"]),He=gl({},wl);gl(He,Cl),gl(He,yl);var De=gl({},vl);gl(De,bl);var Ne=function(e){ol(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=S}catch(t){e.remove()}}},Pe=function(e,t){try{ol(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){ol(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!z[e])if(ie||se)try{Ne(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Le=function(e){var t,n;if(oe)e="<remove></remove>"+e;else{var o=rl(e,/^[\r\n\t ]+/);n=o&&o[0]}"application/xhtml+xml"===I&&be===ve&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var s=b?b.createHTML(e):e;if(be===ve)try{t=(new g).parseFromString(s,I)}catch(e){}if(!t||!t.documentElement){t=E.createDocument(be,"template",null);try{t.documentElement.innerHTML=Se?S:s}catch(e){}}var r=t.body||t.documentElement;return e&&n&&r.insertBefore(i.createTextNode(n),r.childNodes[0]||null),be===ve?x.call(t,te?"html":"body")[0]:te?t.documentElement:r},Ve=function(e){return M.call(e.ownerDocument||e,e,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null,!1)},Fe=function(e){return e instanceof d&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof u)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Be=function(e){return"object"===Vr(l)?e instanceof l:e&&"object"===Vr(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},We=function(e,t,o){_[e]&&tl(_[e],(function(e){e.call(n,t,o,Te)}))},Ue=function(e){var t;if(We("beforeSanitizeElements",e,null),Fe(e))return Ne(e),!0;if(cl(/[\u0080-\uFFFF]/,e.nodeName))return Ne(e),!0;var o=k(e.nodeName);if(We("uponSanitizeElement",e,{tagName:o,allowedTags:U}),e.hasChildNodes()&&!Be(e.firstElementChild)&&(!Be(e.content)||!Be(e.content.firstElementChild))&&cl(/<[/\w]/g,e.innerHTML)&&cl(/<[/\w]/g,e.textContent))return Ne(e),!0;if("select"===o&&cl(/<template/i,e.innerHTML))return Ne(e),!0;if(7===e.nodeType)return Ne(e),!0;if(ee&&8===e.nodeType&&cl(/<[/\w]/g,e.data))return Ne(e),!0;if(!U[o]||G[o]){if(!G[o]&&ze(o)){if($.tagNameCheck instanceof RegExp&&cl($.tagNameCheck,o))return!1;if($.tagNameCheck instanceof Function&&$.tagNameCheck(o))return!1}if(he&&!de[o]){var i=y(e)||e.parentNode,s=C(e)||e.childNodes;if(s&&i)for(var r=s.length-1;r>=0;--r){var l=p(s[r],!0);l.__removalCount=(e.__removalCount||0)+1,i.insertBefore(l,w(e))}}return Ne(e),!0}return e instanceof a&&!function(e){var t=y(e);t&&t.tagName||(t={namespaceURI:be,tagName:"template"});var n=il(e.tagName),o=il(t.tagName);return!!Re[e.namespaceURI]&&(e.namespaceURI===ye?t.namespaceURI===ve?"svg"===n:t.namespaceURI===Ce?"svg"===n&&("annotation-xml"===o||_e[o]):Boolean(He[n]):e.namespaceURI===Ce?t.namespaceURI===ve?"math"===n:t.namespaceURI===ye?"math"===n&&Ie[o]:Boolean(De[n]):e.namespaceURI===ve?!(t.namespaceURI===ye&&!Ie[o])&&!(t.namespaceURI===Ce&&!_e[o])&&!De[n]&&(ke[n]||!He[n]):!("application/xhtml+xml"!==I||!Re[e.namespaceURI]))}(e)?(Ne(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!cl(/<\/no(script|embed|frames)/i,e.innerHTML)?(Q&&3===e.nodeType&&(t=e.textContent,t=ll(t,H," "),t=ll(t,D," "),t=ll(t,N," "),e.textContent!==t&&(ol(n.removed,{element:e.cloneNode()}),e.textContent=t)),We("afterSanitizeElements",e,null),!1):(Ne(e),!0)},je=function(e,t,n){if(le&&("id"===t||"name"===t)&&(n in i||n in xe))return!1;if(X&&!K[t]&&cl(P,t));else if(q&&cl(L,t));else if(!z[t]||K[t]){if(!(ze(e)&&($.tagNameCheck instanceof RegExp&&cl($.tagNameCheck,e)||$.tagNameCheck instanceof Function&&$.tagNameCheck(e))&&($.attributeNameCheck instanceof RegExp&&cl($.attributeNameCheck,t)||$.attributeNameCheck instanceof Function&&$.attributeNameCheck(t))||"is"===t&&$.allowCustomizedBuiltInElements&&($.tagNameCheck instanceof RegExp&&cl($.tagNameCheck,n)||$.tagNameCheck instanceof Function&&$.tagNameCheck(n))))return!1}else if(pe[t]);else if(cl(W,ll(n,F,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==al(n,"data:")||!fe[e]){if(Z&&!cl(V,ll(n,F,"")));else if(n)return!1}else;return!0},ze=function(e){return"annotation-xml"!==e&&rl(e,B)},Ye=function(e){var t,o,i,s;We("beforeSanitizeAttributes",e,null);var r=e.attributes;if(r&&!Fe(e)){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:z};for(s=r.length;s--;){var a=t=r[s],h=a.name,c=a.namespaceURI;if(o="value"===h?t.value:hl(t.value),i=k(h),l.attrName=i,l.attrValue=o,l.keepAttr=!0,l.forceKeepAttr=void 0,We("uponSanitizeAttribute",e,l),o=l.attrValue,!l.forceKeepAttr&&(Pe(h,e),l.keepAttr))if(J||!cl(/\/>/i,o)){Q&&(o=ll(o,H," "),o=ll(o,D," "),o=ll(o,N," "));var u=k(e.nodeName);if(je(u,i,o))if(!ae||"id"!==i&&"name"!==i||(Pe(h,e),o="user-content-"+o),ee&&cl(/((--!?|])>)|<\/(style|title)/i,o))Pe(h,e);else{if(b&&"object"===Vr(f)&&"function"==typeof f.getAttributeType)if(c);else switch(f.getAttributeType(u,i)){case"TrustedHTML":o=b.createHTML(o);break;case"TrustedScriptURL":o=b.createScriptURL(o)}try{c?e.setAttributeNS(c,h,o):e.setAttribute(h,o),Fe(e)?Ne(e):nl(n.removed)}catch(e){}}}else Pe(h,e)}We("afterSanitizeAttributes",e,null)}},$e=function e(t){var n,o=Ve(t);for(We("beforeSanitizeShadowDOM",t,null);n=o.nextNode();)We("uponSanitizeShadowNode",n,null),Ue(n),Ye(n),n.content instanceof s&&e(n.content);We("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e){var i,r,a,h,c,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((Se=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Be(e)){if("function"!=typeof e.toString)throw ul("toString is not a function");if("string"!=typeof(e=e.toString()))throw ul("dirty is not a string, aborting")}if(!n.isSupported){if("object"===Vr(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(Be(e))return t.toStaticHTML(e.outerHTML)}return e}if(ne||Ae(u),n.removed=[],"string"==typeof e&&(ce=!1),ce){if(e.nodeName){var d=k(e.nodeName);if(!U[d]||G[d])throw ul("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)1===(r=(i=Le("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===r.nodeName||"HTML"===r.nodeName?i=r:i.appendChild(r);else{if(!ie&&!Q&&!te&&-1===e.indexOf("<"))return b&&re?b.createHTML(e):e;if(!(i=Le(e)))return ie?null:re?S:""}i&&oe&&Ne(i.firstChild);for(var g=Ve(ce?e:i);a=g.nextNode();)3===a.nodeType&&a===h||(Ue(a),Ye(a),a.content instanceof s&&$e(a.content),h=a);if(h=null,ce)return e;if(ie){if(se)for(c=T.call(i.ownerDocument);i.firstChild;)c.appendChild(i.firstChild);else c=i;return(z.shadowroot||z.shadowrootmod)&&(c=O.call(o,c,!0)),c}var f=te?i.outerHTML:i.innerHTML;return te&&U["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&cl(Nl,i.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+f),Q&&(f=ll(f,H," "),f=ll(f,D," "),f=ll(f,N," ")),b&&re?b.createHTML(f):f},n.setConfig=function(e){Ae(e),ne=!0},n.clearConfig=function(){Te=null,ne=!1},n.isValidAttribute=function(e,t,n){Te||Ae({});var o=k(e),i=k(t);return je(o,i,n)},n.addHook=function(e,t){"function"==typeof t&&(_[e]=_[e]||[],ol(_[e],t))},n.removeHook=function(e){if(_[e])return nl(_[e])},n.removeHooks=function(e){_[e]&&(_[e]=[])},n.removeAllHooks=function(){_={}},n}();function Fl(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Bl,Wl={exports:{}};(Bl=Wl).exports=function(){var e,t;function n(){return e.apply(null,arguments)}function o(t){e=t}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(r(e,t))return!1;return!0}function a(e){return void 0===e}function h(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function c(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function u(e,t){var n,o=[],i=e.length;for(n=0;n<i;++n)o.push(t(e[n],n));return o}function d(e,t){for(var n in t)r(t,n)&&(e[n]=t[n]);return r(t,"toString")&&(e.toString=t.toString),r(t,"valueOf")&&(e.valueOf=t.valueOf),e}function g(e,t,n,o){return Gn(e,t,n,o,!0).utc()}function f(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(e){return null==e._pf&&(e._pf=f()),e._pf}function p(e){if(null==e._isValid){var n=m(e),o=t.call(n.parsedDateParts,(function(e){return null!=e})),i=!isNaN(e._d.getTime())&&n.overflow<0&&!n.empty&&!n.invalidEra&&!n.invalidMonth&&!n.invalidWeekday&&!n.weekdayMismatch&&!n.nullInput&&!n.invalidFormat&&!n.userInvalidated&&(!n.meridiem||n.meridiem&&o);if(e._strict&&(i=i&&0===n.charsLeftOver&&0===n.unusedTokens.length&&void 0===n.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function w(e){var t=g(NaN);return null!=e?d(m(t),e):m(t).userInvalidated=!0,t}t=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),o=n.length>>>0;for(t=0;t<o;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var C=n.momentProperties=[],y=!1;function v(e,t){var n,o,i,s=C.length;if(a(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),a(t._i)||(e._i=t._i),a(t._f)||(e._f=t._f),a(t._l)||(e._l=t._l),a(t._strict)||(e._strict=t._strict),a(t._tzm)||(e._tzm=t._tzm),a(t._isUTC)||(e._isUTC=t._isUTC),a(t._offset)||(e._offset=t._offset),a(t._pf)||(e._pf=m(t)),a(t._locale)||(e._locale=t._locale),s>0)for(n=0;n<s;n++)a(i=t[o=C[n]])||(e[o]=i);return e}function b(e){v(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===y&&(y=!0,n.updateOffset(this),y=!1)}function S(e){return e instanceof b||null!=e&&null!=e._isAMomentObject}function R(e){!1===n.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function E(e,t){var o=!0;return d((function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,e),o){var i,s,l,a=[],h=arguments.length;for(s=0;s<h;s++){if(i="","object"==typeof arguments[s]){for(l in i+="\n["+s+"] ",arguments[0])r(arguments[0],l)&&(i+=l+": "+arguments[0][l]+", ");i=i.slice(0,-2)}else i=arguments[s];a.push(i)}R(e+"\nArguments: "+Array.prototype.slice.call(a).join("")+"\n"+(new Error).stack),o=!1}return t.apply(this,arguments)}),t)}var M,T={};function x(e,t){null!=n.deprecationHandler&&n.deprecationHandler(e,t),T[e]||(R(t),T[e]=!0)}function O(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function A(e){var t,n;for(n in e)r(e,n)&&(O(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function _(e,t){var n,o=d({},e);for(n in t)r(t,n)&&(s(e[n])&&s(t[n])?(o[n]={},d(o[n],e[n]),d(o[n],t[n])):null!=t[n]?o[n]=t[n]:delete o[n]);for(n in e)r(e,n)&&!r(t,n)&&s(e[n])&&(o[n]=d({},o[n]));return o}function I(e){null!=e&&this.set(e)}n.suppressDeprecationWarnings=!1,n.deprecationHandler=null,M=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)r(e,t)&&n.push(t);return n};var k={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function H(e,t,n){var o=this._calendar[e]||this._calendar.sameElse;return O(o)?o.call(t,n):o}function D(e,t,n){var o=""+Math.abs(e),i=t-o.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+o}var N=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,P=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,L={},V={};function F(e,t,n,o){var i=o;"string"==typeof o&&(i=function(){return this[o]()}),e&&(V[e]=i),t&&(V[t[0]]=function(){return D(i.apply(this,arguments),t[1],t[2])}),n&&(V[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function B(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var t,n,o=e.match(N);for(t=0,n=o.length;t<n;t++)V[o[t]]?o[t]=V[o[t]]:o[t]=B(o[t]);return function(t){var i,s="";for(i=0;i<n;i++)s+=O(o[i])?o[i].call(t,e):o[i];return s}}function U(e,t){return e.isValid()?(t=j(t,e.localeData()),L[t]=L[t]||W(t),L[t](e)):e.localeData().invalidDate()}function j(e,t){var n=5;function o(e){return t.longDateFormat(e)||e}for(P.lastIndex=0;n>=0&&P.test(e);)e=e.replace(P,o),P.lastIndex=0,n-=1;return e}var z={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Y(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(N).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var $="Invalid date";function G(){return this._invalidDate}var K="%d",q=/\d{1,2}/;function X(e){return this._ordinal.replace("%d",e)}var Z={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function J(e,t,n,o){var i=this._relativeTime[n];return O(i)?i(e,t,n,o):i.replace(/%d/i,e)}function Q(e,t){var n=this._relativeTime[e>0?"future":"past"];return O(n)?n(t):n.replace(/%s/i,t)}var ee={};function te(e,t){var n=e.toLowerCase();ee[n]=ee[n+"s"]=ee[t]=e}function ne(e){return"string"==typeof e?ee[e]||ee[e.toLowerCase()]:void 0}function oe(e){var t,n,o={};for(n in e)r(e,n)&&(t=ne(n))&&(o[t]=e[n]);return o}var ie={};function se(e,t){ie[e]=t}function re(e){var t,n=[];for(t in e)r(e,t)&&n.push({unit:t,priority:ie[t]});return n.sort((function(e,t){return e.priority-t.priority})),n}function le(e){return e%4==0&&e%100!=0||e%400==0}function ae(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function he(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=ae(t)),n}function ce(e,t){return function(o){return null!=o?(de(this,e,o),n.updateOffset(this,t),this):ue(this,e)}}function ue(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function de(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&le(e.year())&&1===e.month()&&29===e.date()?(n=he(n),e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Je(n,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function ge(e){return O(this[e=ne(e)])?this[e]():this}function fe(e,t){if("object"==typeof e){var n,o=re(e=oe(e)),i=o.length;for(n=0;n<i;n++)this[o[n].unit](e[o[n].unit])}else if(O(this[e=ne(e)]))return this[e](t);return this}var me,pe=/\d/,we=/\d\d/,Ce=/\d{3}/,ye=/\d{4}/,ve=/[+-]?\d{6}/,be=/\d\d?/,Se=/\d\d\d\d?/,Re=/\d\d\d\d\d\d?/,Ee=/\d{1,3}/,Me=/\d{1,4}/,Te=/[+-]?\d{1,6}/,xe=/\d+/,Oe=/[+-]?\d+/,Ae=/Z|[+-]\d\d:?\d\d/gi,_e=/Z|[+-]\d\d(?::?\d\d)?/gi,Ie=/[+-]?\d+(\.\d{1,3})?/,ke=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function He(e,t,n){me[e]=O(t)?t:function(e,o){return e&&n?n:t}}function De(e,t){return r(me,e)?me[e](t._strict,t._locale):new RegExp(Ne(e))}function Ne(e){return Pe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,o,i){return t||n||o||i})))}function Pe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}me={};var Le={};function Ve(e,t){var n,o,i=t;for("string"==typeof e&&(e=[e]),h(t)&&(i=function(e,n){n[t]=he(e)}),o=e.length,n=0;n<o;n++)Le[e[n]]=i}function Fe(e,t){Ve(e,(function(e,n,o,i){o._w=o._w||{},t(e,o._w,o,i)}))}function Be(e,t,n){null!=t&&r(Le,e)&&Le[e](t,n._a,n,e)}var We,Ue=0,je=1,ze=2,Ye=3,$e=4,Ge=5,Ke=6,qe=7,Xe=8;function Ze(e,t){return(e%t+t)%t}function Je(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=Ze(t,12);return e+=(t-n)/12,1===n?le(e)?29:28:31-n%7%2}We=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},F("M",["MM",2],"Mo",(function(){return this.month()+1})),F("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),F("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),te("month","M"),se("month",8),He("M",be),He("MM",be,we),He("MMM",(function(e,t){return t.monthsShortRegex(e)})),He("MMMM",(function(e,t){return t.monthsRegex(e)})),Ve(["M","MM"],(function(e,t){t[je]=he(e)-1})),Ve(["MMM","MMMM"],(function(e,t,n,o){var i=n._locale.monthsParse(e,o,n._strict);null!=i?t[je]=i:m(n).invalidMonth=e}));var Qe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),et="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),tt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,nt=ke,ot=ke;function it(e,t){return e?i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||tt).test(t)?"format":"standalone"][e.month()]:i(this._months)?this._months:this._months.standalone}function st(e,t){return e?i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[tt.test(t)?"format":"standalone"][e.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function rt(e,t,n){var o,i,s,r=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],o=0;o<12;++o)s=g([2e3,o]),this._shortMonthsParse[o]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[o]=this.months(s,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=We.call(this._shortMonthsParse,r))?i:null:-1!==(i=We.call(this._longMonthsParse,r))?i:null:"MMM"===t?-1!==(i=We.call(this._shortMonthsParse,r))||-1!==(i=We.call(this._longMonthsParse,r))?i:null:-1!==(i=We.call(this._longMonthsParse,r))||-1!==(i=We.call(this._shortMonthsParse,r))?i:null}function lt(e,t,n){var o,i,s;if(this._monthsParseExact)return rt.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;o<12;o++){if(i=g([2e3,o]),n&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[o]||(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[o]=new RegExp(s.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[o].test(e))return o;if(n&&"MMM"===t&&this._shortMonthsParse[o].test(e))return o;if(!n&&this._monthsParse[o].test(e))return o}}function at(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=he(t);else if(!h(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Je(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function ht(e){return null!=e?(at(this,e),n.updateOffset(this,!0),this):ue(this,"Month")}function ct(){return Je(this.year(),this.month())}function ut(e){return this._monthsParseExact?(r(this,"_monthsRegex")||gt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(r(this,"_monthsShortRegex")||(this._monthsShortRegex=nt),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function dt(e){return this._monthsParseExact?(r(this,"_monthsRegex")||gt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(r(this,"_monthsRegex")||(this._monthsRegex=ot),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function gt(){function e(e,t){return t.length-e.length}var t,n,o=[],i=[],s=[];for(t=0;t<12;t++)n=g([2e3,t]),o.push(this.monthsShort(n,"")),i.push(this.months(n,"")),s.push(this.months(n,"")),s.push(this.monthsShort(n,""));for(o.sort(e),i.sort(e),s.sort(e),t=0;t<12;t++)o[t]=Pe(o[t]),i[t]=Pe(i[t]);for(t=0;t<24;t++)s[t]=Pe(s[t]);this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+o.join("|")+")","i")}function ft(e){return le(e)?366:365}F("Y",0,0,(function(){var e=this.year();return e<=9999?D(e,4):"+"+e})),F(0,["YY",2],0,(function(){return this.year()%100})),F(0,["YYYY",4],0,"year"),F(0,["YYYYY",5],0,"year"),F(0,["YYYYYY",6,!0],0,"year"),te("year","y"),se("year",1),He("Y",Oe),He("YY",be,we),He("YYYY",Me,ye),He("YYYYY",Te,ve),He("YYYYYY",Te,ve),Ve(["YYYYY","YYYYYY"],Ue),Ve("YYYY",(function(e,t){t[Ue]=2===e.length?n.parseTwoDigitYear(e):he(e)})),Ve("YY",(function(e,t){t[Ue]=n.parseTwoDigitYear(e)})),Ve("Y",(function(e,t){t[Ue]=parseInt(e,10)})),n.parseTwoDigitYear=function(e){return he(e)+(he(e)>68?1900:2e3)};var mt=ce("FullYear",!0);function pt(){return le(this.year())}function wt(e,t,n,o,i,s,r){var l;return e<100&&e>=0?(l=new Date(e+400,t,n,o,i,s,r),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,n,o,i,s,r),l}function Ct(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function yt(e,t,n){var o=7+t-n;return-(7+Ct(e,0,o).getUTCDay()-t)%7+o-1}function vt(e,t,n,o,i){var s,r,l=1+7*(t-1)+(7+n-o)%7+yt(e,o,i);return l<=0?r=ft(s=e-1)+l:l>ft(e)?(s=e+1,r=l-ft(e)):(s=e,r=l),{year:s,dayOfYear:r}}function bt(e,t,n){var o,i,s=yt(e.year(),t,n),r=Math.floor((e.dayOfYear()-s-1)/7)+1;return r<1?o=r+St(i=e.year()-1,t,n):r>St(e.year(),t,n)?(o=r-St(e.year(),t,n),i=e.year()+1):(i=e.year(),o=r),{week:o,year:i}}function St(e,t,n){var o=yt(e,t,n),i=yt(e+1,t,n);return(ft(e)-o+i)/7}function Rt(e){return bt(e,this._week.dow,this._week.doy).week}F("w",["ww",2],"wo","week"),F("W",["WW",2],"Wo","isoWeek"),te("week","w"),te("isoWeek","W"),se("week",5),se("isoWeek",5),He("w",be),He("ww",be,we),He("W",be),He("WW",be,we),Fe(["w","ww","W","WW"],(function(e,t,n,o){t[o.substr(0,1)]=he(e)}));var Et={dow:0,doy:6};function Mt(){return this._week.dow}function Tt(){return this._week.doy}function xt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Ot(e){var t=bt(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function At(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function _t(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function It(e,t){return e.slice(t,7).concat(e.slice(0,t))}F("d",0,"do","day"),F("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),F("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),F("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),F("e",0,0,"weekday"),F("E",0,0,"isoWeekday"),te("day","d"),te("weekday","e"),te("isoWeekday","E"),se("day",11),se("weekday",11),se("isoWeekday",11),He("d",be),He("e",be),He("E",be),He("dd",(function(e,t){return t.weekdaysMinRegex(e)})),He("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),He("dddd",(function(e,t){return t.weekdaysRegex(e)})),Fe(["dd","ddd","dddd"],(function(e,t,n,o){var i=n._locale.weekdaysParse(e,o,n._strict);null!=i?t.d=i:m(n).invalidWeekday=e})),Fe(["d","e","E"],(function(e,t,n,o){t[o]=he(e)}));var kt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ht="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Dt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Nt=ke,Pt=ke,Lt=ke;function Vt(e,t){var n=i(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?It(n,this._week.dow):e?n[e.day()]:n}function Ft(e){return!0===e?It(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Bt(e){return!0===e?It(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Wt(e,t,n){var o,i,s,r=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],o=0;o<7;++o)s=g([2e3,1]).day(o),this._minWeekdaysParse[o]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[o]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[o]=this.weekdays(s,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=We.call(this._weekdaysParse,r))?i:null:"ddd"===t?-1!==(i=We.call(this._shortWeekdaysParse,r))?i:null:-1!==(i=We.call(this._minWeekdaysParse,r))?i:null:"dddd"===t?-1!==(i=We.call(this._weekdaysParse,r))||-1!==(i=We.call(this._shortWeekdaysParse,r))||-1!==(i=We.call(this._minWeekdaysParse,r))?i:null:"ddd"===t?-1!==(i=We.call(this._shortWeekdaysParse,r))||-1!==(i=We.call(this._weekdaysParse,r))||-1!==(i=We.call(this._minWeekdaysParse,r))?i:null:-1!==(i=We.call(this._minWeekdaysParse,r))||-1!==(i=We.call(this._weekdaysParse,r))||-1!==(i=We.call(this._shortWeekdaysParse,r))?i:null}function Ut(e,t,n){var o,i,s;if(this._weekdaysParseExact)return Wt.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),o=0;o<7;o++){if(i=g([2e3,1]).day(o),n&&!this._fullWeekdaysParse[o]&&(this._fullWeekdaysParse[o]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[o]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[o]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[o]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[o]=new RegExp(s.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[o].test(e))return o;if(n&&"ddd"===t&&this._shortWeekdaysParse[o].test(e))return o;if(n&&"dd"===t&&this._minWeekdaysParse[o].test(e))return o;if(!n&&this._weekdaysParse[o].test(e))return o}}function jt(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=At(e,this.localeData()),this.add(e-t,"d")):t}function zt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Yt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=_t(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function $t(e){return this._weekdaysParseExact?(r(this,"_weekdaysRegex")||qt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(r(this,"_weekdaysRegex")||(this._weekdaysRegex=Nt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Gt(e){return this._weekdaysParseExact?(r(this,"_weekdaysRegex")||qt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(r(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Pt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Kt(e){return this._weekdaysParseExact?(r(this,"_weekdaysRegex")||qt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(r(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Lt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function qt(){function e(e,t){return t.length-e.length}var t,n,o,i,s,r=[],l=[],a=[],h=[];for(t=0;t<7;t++)n=g([2e3,1]).day(t),o=Pe(this.weekdaysMin(n,"")),i=Pe(this.weekdaysShort(n,"")),s=Pe(this.weekdays(n,"")),r.push(o),l.push(i),a.push(s),h.push(o),h.push(i),h.push(s);r.sort(e),l.sort(e),a.sort(e),h.sort(e),this._weekdaysRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Xt(){return this.hours()%12||12}function Zt(){return this.hours()||24}function Jt(e,t){F(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function Qt(e,t){return t._meridiemParse}function en(e){return"p"===(e+"").toLowerCase().charAt(0)}F("H",["HH",2],0,"hour"),F("h",["hh",2],0,Xt),F("k",["kk",2],0,Zt),F("hmm",0,0,(function(){return""+Xt.apply(this)+D(this.minutes(),2)})),F("hmmss",0,0,(function(){return""+Xt.apply(this)+D(this.minutes(),2)+D(this.seconds(),2)})),F("Hmm",0,0,(function(){return""+this.hours()+D(this.minutes(),2)})),F("Hmmss",0,0,(function(){return""+this.hours()+D(this.minutes(),2)+D(this.seconds(),2)})),Jt("a",!0),Jt("A",!1),te("hour","h"),se("hour",13),He("a",Qt),He("A",Qt),He("H",be),He("h",be),He("k",be),He("HH",be,we),He("hh",be,we),He("kk",be,we),He("hmm",Se),He("hmmss",Re),He("Hmm",Se),He("Hmmss",Re),Ve(["H","HH"],Ye),Ve(["k","kk"],(function(e,t,n){var o=he(e);t[Ye]=24===o?0:o})),Ve(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),Ve(["h","hh"],(function(e,t,n){t[Ye]=he(e),m(n).bigHour=!0})),Ve("hmm",(function(e,t,n){var o=e.length-2;t[Ye]=he(e.substr(0,o)),t[$e]=he(e.substr(o)),m(n).bigHour=!0})),Ve("hmmss",(function(e,t,n){var o=e.length-4,i=e.length-2;t[Ye]=he(e.substr(0,o)),t[$e]=he(e.substr(o,2)),t[Ge]=he(e.substr(i)),m(n).bigHour=!0})),Ve("Hmm",(function(e,t,n){var o=e.length-2;t[Ye]=he(e.substr(0,o)),t[$e]=he(e.substr(o))})),Ve("Hmmss",(function(e,t,n){var o=e.length-4,i=e.length-2;t[Ye]=he(e.substr(0,o)),t[$e]=he(e.substr(o,2)),t[Ge]=he(e.substr(i))}));var tn=/[ap]\.?m?\.?/i,nn=ce("Hours",!0);function on(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}var sn,rn={calendar:k,longDateFormat:z,invalidDate:$,ordinal:K,dayOfMonthOrdinalParse:q,relativeTime:Z,months:Qe,monthsShort:et,week:Et,weekdays:kt,weekdaysMin:Dt,weekdaysShort:Ht,meridiemParse:tn},ln={},an={};function hn(e,t){var n,o=Math.min(e.length,t.length);for(n=0;n<o;n+=1)if(e[n]!==t[n])return n;return o}function cn(e){return e?e.toLowerCase().replace("_","-"):e}function un(e){for(var t,n,o,i,s=0;s<e.length;){for(t=(i=cn(e[s]).split("-")).length,n=(n=cn(e[s+1]))?n.split("-"):null;t>0;){if(o=gn(i.slice(0,t).join("-")))return o;if(n&&n.length>=t&&hn(i,n)>=t-1)break;t--}s++}return sn}function dn(e){return null!=e.match("^[^/\\\\]*$")}function gn(e){var t=null;if(void 0===ln[e]&&Bl&&Bl.exports&&dn(e))try{t=sn._abbr,Fl("./locale/"+e),fn(t)}catch(t){ln[e]=null}return ln[e]}function fn(e,t){var n;return e&&((n=a(t)?wn(e):mn(e,t))?sn=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),sn._abbr}function mn(e,t){if(null!==t){var n,o=rn;if(t.abbr=e,null!=ln[e])x("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),o=ln[e]._config;else if(null!=t.parentLocale)if(null!=ln[t.parentLocale])o=ln[t.parentLocale]._config;else{if(null==(n=gn(t.parentLocale)))return an[t.parentLocale]||(an[t.parentLocale]=[]),an[t.parentLocale].push({name:e,config:t}),null;o=n._config}return ln[e]=new I(_(o,t)),an[e]&&an[e].forEach((function(e){mn(e.name,e.config)})),fn(e),ln[e]}return delete ln[e],null}function pn(e,t){if(null!=t){var n,o,i=rn;null!=ln[e]&&null!=ln[e].parentLocale?ln[e].set(_(ln[e]._config,t)):(null!=(o=gn(e))&&(i=o._config),t=_(i,t),null==o&&(t.abbr=e),(n=new I(t)).parentLocale=ln[e],ln[e]=n),fn(e)}else null!=ln[e]&&(null!=ln[e].parentLocale?(ln[e]=ln[e].parentLocale,e===fn()&&fn(e)):null!=ln[e]&&delete ln[e]);return ln[e]}function wn(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return sn;if(!i(e)){if(t=gn(e))return t;e=[e]}return un(e)}function Cn(){return M(ln)}function yn(e){var t,n=e._a;return n&&-2===m(e).overflow&&(t=n[je]<0||n[je]>11?je:n[ze]<1||n[ze]>Je(n[Ue],n[je])?ze:n[Ye]<0||n[Ye]>24||24===n[Ye]&&(0!==n[$e]||0!==n[Ge]||0!==n[Ke])?Ye:n[$e]<0||n[$e]>59?$e:n[Ge]<0||n[Ge]>59?Ge:n[Ke]<0||n[Ke]>999?Ke:-1,m(e)._overflowDayOfYear&&(t<Ue||t>ze)&&(t=ze),m(e)._overflowWeeks&&-1===t&&(t=qe),m(e)._overflowWeekday&&-1===t&&(t=Xe),m(e).overflow=t),e}var vn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,bn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sn=/Z|[+-]\d\d(?::?\d\d)?/,Rn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],En=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Mn=/^\/?Date\((-?\d+)/i,Tn=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,xn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function On(e){var t,n,o,i,s,r,l=e._i,a=vn.exec(l)||bn.exec(l),h=Rn.length,c=En.length;if(a){for(m(e).iso=!0,t=0,n=h;t<n;t++)if(Rn[t][1].exec(a[1])){i=Rn[t][0],o=!1!==Rn[t][2];break}if(null==i)return void(e._isValid=!1);if(a[3]){for(t=0,n=c;t<n;t++)if(En[t][1].exec(a[3])){s=(a[2]||" ")+En[t][0];break}if(null==s)return void(e._isValid=!1)}if(!o&&null!=s)return void(e._isValid=!1);if(a[4]){if(!Sn.exec(a[4]))return void(e._isValid=!1);r="Z"}e._f=i+(s||"")+(r||""),Bn(e)}else e._isValid=!1}function An(e,t,n,o,i,s){var r=[_n(e),et.indexOf(t),parseInt(n,10),parseInt(o,10),parseInt(i,10)];return s&&r.push(parseInt(s,10)),r}function _n(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function In(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function kn(e,t,n){return!e||Ht.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(m(n).weekdayMismatch=!0,n._isValid=!1,!1)}function Hn(e,t,n){if(e)return xn[e];if(t)return 0;var o=parseInt(n,10),i=o%100;return(o-i)/100*60+i}function Dn(e){var t,n=Tn.exec(In(e._i));if(n){if(t=An(n[4],n[3],n[2],n[5],n[6],n[7]),!kn(n[1],t,e))return;e._a=t,e._tzm=Hn(n[8],n[9],n[10]),e._d=Ct.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0}else e._isValid=!1}function Nn(e){var t=Mn.exec(e._i);null===t?(On(e),!1===e._isValid&&(delete e._isValid,Dn(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:n.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Pn(e,t,n){return null!=e?e:null!=t?t:n}function Ln(e){var t=new Date(n.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Vn(e){var t,n,o,i,s,r=[];if(!e._d){for(o=Ln(e),e._w&&null==e._a[ze]&&null==e._a[je]&&Fn(e),null!=e._dayOfYear&&(s=Pn(e._a[Ue],o[Ue]),(e._dayOfYear>ft(s)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),n=Ct(s,0,e._dayOfYear),e._a[je]=n.getUTCMonth(),e._a[ze]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=r[t]=o[t];for(;t<7;t++)e._a[t]=r[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Ye]&&0===e._a[$e]&&0===e._a[Ge]&&0===e._a[Ke]&&(e._nextDay=!0,e._a[Ye]=0),e._d=(e._useUTC?Ct:wt).apply(null,r),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ye]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(m(e).weekdayMismatch=!0)}}function Fn(e){var t,n,o,i,s,r,l,a,h;null!=(t=e._w).GG||null!=t.W||null!=t.E?(s=1,r=4,n=Pn(t.GG,e._a[Ue],bt(Kn(),1,4).year),o=Pn(t.W,1),((i=Pn(t.E,1))<1||i>7)&&(a=!0)):(s=e._locale._week.dow,r=e._locale._week.doy,h=bt(Kn(),s,r),n=Pn(t.gg,e._a[Ue],h.year),o=Pn(t.w,h.week),null!=t.d?((i=t.d)<0||i>6)&&(a=!0):null!=t.e?(i=t.e+s,(t.e<0||t.e>6)&&(a=!0)):i=s),o<1||o>St(n,s,r)?m(e)._overflowWeeks=!0:null!=a?m(e)._overflowWeekday=!0:(l=vt(n,o,i,s,r),e._a[Ue]=l.year,e._dayOfYear=l.dayOfYear)}function Bn(e){if(e._f!==n.ISO_8601)if(e._f!==n.RFC_2822){e._a=[],m(e).empty=!0;var t,o,i,s,r,l,a,h=""+e._i,c=h.length,u=0;for(a=(i=j(e._f,e._locale).match(N)||[]).length,t=0;t<a;t++)s=i[t],(o=(h.match(De(s,e))||[])[0])&&((r=h.substr(0,h.indexOf(o))).length>0&&m(e).unusedInput.push(r),h=h.slice(h.indexOf(o)+o.length),u+=o.length),V[s]?(o?m(e).empty=!1:m(e).unusedTokens.push(s),Be(s,o,e)):e._strict&&!o&&m(e).unusedTokens.push(s);m(e).charsLeftOver=c-u,h.length>0&&m(e).unusedInput.push(h),e._a[Ye]<=12&&!0===m(e).bigHour&&e._a[Ye]>0&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[Ye]=Wn(e._locale,e._a[Ye],e._meridiem),null!==(l=m(e).era)&&(e._a[Ue]=e._locale.erasConvertYear(l,e._a[Ue])),Vn(e),yn(e)}else Dn(e);else On(e)}function Wn(e,t,n){var o;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((o=e.isPM(n))&&t<12&&(t+=12),o||12!==t||(t=0),t):t}function Un(e){var t,n,o,i,s,r,l=!1,a=e._f.length;if(0===a)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<a;i++)s=0,r=!1,t=v({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Bn(t),p(t)&&(r=!0),s+=m(t).charsLeftOver,s+=10*m(t).unusedTokens.length,m(t).score=s,l?s<o&&(o=s,n=t):(null==o||s<o||r)&&(o=s,n=t,r&&(l=!0));d(e,n||t)}function jn(e){if(!e._d){var t=oe(e._i),n=void 0===t.day?t.date:t.day;e._a=u([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Vn(e)}}function zn(e){var t=new b(yn(Yn(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Yn(e){var t=e._i,n=e._f;return e._locale=e._locale||wn(e._l),null===t||void 0===n&&""===t?w({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),S(t)?new b(yn(t)):(c(t)?e._d=t:i(n)?Un(e):n?Bn(e):$n(e),p(e)||(e._d=null),e))}function $n(e){var t=e._i;a(t)?e._d=new Date(n.now()):c(t)?e._d=new Date(t.valueOf()):"string"==typeof t?Nn(e):i(t)?(e._a=u(t.slice(0),(function(e){return parseInt(e,10)})),Vn(e)):s(t)?jn(e):h(t)?e._d=new Date(t):n.createFromInputFallback(e)}function Gn(e,t,n,o,r){var a={};return!0!==t&&!1!==t||(o=t,t=void 0),!0!==n&&!1!==n||(o=n,n=void 0),(s(e)&&l(e)||i(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=r,a._l=n,a._i=e,a._f=t,a._strict=o,zn(a)}function Kn(e,t,n,o){return Gn(e,t,n,o,!1)}n.createFromInputFallback=E("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),n.ISO_8601=function(){},n.RFC_2822=function(){};var qn=E("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Kn.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:w()})),Xn=E("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Kn.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:w()}));function Zn(e,t){var n,o;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Kn();for(n=t[0],o=1;o<t.length;++o)t[o].isValid()&&!t[o][e](n)||(n=t[o]);return n}function Jn(){return Zn("isBefore",[].slice.call(arguments,0))}function Qn(){return Zn("isAfter",[].slice.call(arguments,0))}var eo=function(){return Date.now?Date.now():+new Date},to=["year","quarter","month","week","day","hour","minute","second","millisecond"];function no(e){var t,n,o=!1,i=to.length;for(t in e)if(r(e,t)&&(-1===We.call(to,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<i;++n)if(e[to[n]]){if(o)return!1;parseFloat(e[to[n]])!==he(e[to[n]])&&(o=!0)}return!0}function oo(){return this._isValid}function io(){return Oo(NaN)}function so(e){var t=oe(e),n=t.year||0,o=t.quarter||0,i=t.month||0,s=t.week||t.isoWeek||0,r=t.day||0,l=t.hour||0,a=t.minute||0,h=t.second||0,c=t.millisecond||0;this._isValid=no(t),this._milliseconds=+c+1e3*h+6e4*a+1e3*l*60*60,this._days=+r+7*s,this._months=+i+3*o+12*n,this._data={},this._locale=wn(),this._bubble()}function ro(e){return e instanceof so}function lo(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function ao(e,t,n){var o,i=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),r=0;for(o=0;o<i;o++)(n&&e[o]!==t[o]||!n&&he(e[o])!==he(t[o]))&&r++;return r+s}function ho(e,t){F(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+D(~~(e/60),2)+t+D(~~e%60,2)}))}ho("Z",":"),ho("ZZ",""),He("Z",_e),He("ZZ",_e),Ve(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=uo(_e,e)}));var co=/([\+\-]|\d\d)/gi;function uo(e,t){var n,o,i=(t||"").match(e);return null===i?null:0===(o=60*(n=((i[i.length-1]||[])+"").match(co)||["-",0,0])[1]+he(n[2]))?0:"+"===n[0]?o:-o}function go(e,t){var o,i;return t._isUTC?(o=t.clone(),i=(S(e)||c(e)?e.valueOf():Kn(e).valueOf())-o.valueOf(),o._d.setTime(o._d.valueOf()+i),n.updateOffset(o,!1),o):Kn(e).local()}function fo(e){return-Math.round(e._d.getTimezoneOffset())}function mo(e,t,o){var i,s=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=uo(_e,e)))return this}else Math.abs(e)<16&&!o&&(e*=60);return!this._isUTC&&t&&(i=fo(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),s!==e&&(!t||this._changeInProgress?Ho(this,Oo(e-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?s:fo(this)}function po(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function wo(e){return this.utcOffset(0,e)}function Co(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(fo(this),"m")),this}function yo(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=uo(Ae,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function vo(e){return!!this.isValid()&&(e=e?Kn(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function bo(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function So(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e,t={};return v(t,this),(t=Yn(t))._a?(e=t._isUTC?g(t._a):Kn(t._a),this._isDSTShifted=this.isValid()&&ao(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Ro(){return!!this.isValid()&&!this._isUTC}function Eo(){return!!this.isValid()&&this._isUTC}function Mo(){return!!this.isValid()&&this._isUTC&&0===this._offset}n.updateOffset=function(){};var To=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,xo=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Oo(e,t){var n,o,i,s=e,l=null;return ro(e)?s={ms:e._milliseconds,d:e._days,M:e._months}:h(e)||!isNaN(+e)?(s={},t?s[t]=+e:s.milliseconds=+e):(l=To.exec(e))?(n="-"===l[1]?-1:1,s={y:0,d:he(l[ze])*n,h:he(l[Ye])*n,m:he(l[$e])*n,s:he(l[Ge])*n,ms:he(lo(1e3*l[Ke]))*n}):(l=xo.exec(e))?(n="-"===l[1]?-1:1,s={y:Ao(l[2],n),M:Ao(l[3],n),w:Ao(l[4],n),d:Ao(l[5],n),h:Ao(l[6],n),m:Ao(l[7],n),s:Ao(l[8],n)}):null==s?s={}:"object"==typeof s&&("from"in s||"to"in s)&&(i=Io(Kn(s.from),Kn(s.to)),(s={}).ms=i.milliseconds,s.M=i.months),o=new so(s),ro(e)&&r(e,"_locale")&&(o._locale=e._locale),ro(e)&&r(e,"_isValid")&&(o._isValid=e._isValid),o}function Ao(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function _o(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Io(e,t){var n;return e.isValid()&&t.isValid()?(t=go(t,e),e.isBefore(t)?n=_o(e,t):((n=_o(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function ko(e,t){return function(n,o){var i;return null===o||isNaN(+o)||(x(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=o,o=i),Ho(this,Oo(n,o),e),this}}function Ho(e,t,o,i){var s=t._milliseconds,r=lo(t._days),l=lo(t._months);e.isValid()&&(i=null==i||i,l&&at(e,ue(e,"Month")+l*o),r&&de(e,"Date",ue(e,"Date")+r*o),s&&e._d.setTime(e._d.valueOf()+s*o),i&&n.updateOffset(e,r||l))}Oo.fn=so.prototype,Oo.invalid=io;var Do=ko(1,"add"),No=ko(-1,"subtract");function Po(e){return"string"==typeof e||e instanceof String}function Lo(e){return S(e)||c(e)||Po(e)||h(e)||Fo(e)||Vo(e)||null==e}function Vo(e){var t,n,o=s(e)&&!l(e),i=!1,a=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],h=a.length;for(t=0;t<h;t+=1)n=a[t],i=i||r(e,n);return o&&i}function Fo(e){var t=i(e),n=!1;return t&&(n=0===e.filter((function(t){return!h(t)&&Po(e)})).length),t&&n}function Bo(e){var t,n,o=s(e)&&!l(e),i=!1,a=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<a.length;t+=1)n=a[t],i=i||r(e,n);return o&&i}function Wo(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Uo(e,t){1===arguments.length&&(arguments[0]?Lo(arguments[0])?(e=arguments[0],t=void 0):Bo(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var o=e||Kn(),i=go(o,this).startOf("day"),s=n.calendarFormat(this,i)||"sameElse",r=t&&(O(t[s])?t[s].call(this,o):t[s]);return this.format(r||this.localeData().calendar(s,this,Kn(o)))}function jo(){return new b(this)}function zo(e,t){var n=S(e)?e:Kn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function Yo(e,t){var n=S(e)?e:Kn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function $o(e,t,n,o){var i=S(e)?e:Kn(e),s=S(t)?t:Kn(t);return!!(this.isValid()&&i.isValid()&&s.isValid())&&("("===(o=o||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===o[1]?this.isBefore(s,n):!this.isAfter(s,n))}function Go(e,t){var n,o=S(e)?e:Kn(e);return!(!this.isValid()||!o.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()===o.valueOf():(n=o.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function Ko(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function qo(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Xo(e,t,n){var o,i,s;if(!this.isValid())return NaN;if(!(o=go(e,this)).isValid())return NaN;switch(i=6e4*(o.utcOffset()-this.utcOffset()),t=ne(t)){case"year":s=Zo(this,o)/12;break;case"month":s=Zo(this,o);break;case"quarter":s=Zo(this,o)/3;break;case"second":s=(this-o)/1e3;break;case"minute":s=(this-o)/6e4;break;case"hour":s=(this-o)/36e5;break;case"day":s=(this-o-i)/864e5;break;case"week":s=(this-o-i)/6048e5;break;default:s=this-o}return n?s:ae(s)}function Zo(e,t){if(e.date()<t.date())return-Zo(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),o=e.clone().add(n,"months");return-(n+(t-o<0?(t-o)/(o-e.clone().add(n-1,"months")):(t-o)/(e.clone().add(n+1,"months")-o)))||0}function Jo(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Qo(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?U(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):O(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",U(n,"Z")):U(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ei(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,o,i="moment",s="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",s="Z"),e="["+i+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",o=s+'[")]',this.format(e+t+n+o)}function ti(e){e||(e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var t=U(this,e);return this.localeData().postformat(t)}function ni(e,t){return this.isValid()&&(S(e)&&e.isValid()||Kn(e).isValid())?Oo({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function oi(e){return this.from(Kn(),e)}function ii(e,t){return this.isValid()&&(S(e)&&e.isValid()||Kn(e).isValid())?Oo({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function si(e){return this.to(Kn(),e)}function ri(e){var t;return void 0===e?this._locale._abbr:(null!=(t=wn(e))&&(this._locale=t),this)}n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var li=E("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function ai(){return this._locale}var hi=1e3,ci=60*hi,ui=60*ci,di=3506328*ui;function gi(e,t){return(e%t+t)%t}function fi(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-di:new Date(e,t,n).valueOf()}function mi(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-di:Date.UTC(e,t,n)}function pi(e){var t,o;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(o=this._isUTC?mi:fi,e){case"year":t=o(this.year(),0,1);break;case"quarter":t=o(this.year(),this.month()-this.month()%3,1);break;case"month":t=o(this.year(),this.month(),1);break;case"week":t=o(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=o(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=o(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=gi(t+(this._isUTC?0:this.utcOffset()*ci),ui);break;case"minute":t=this._d.valueOf(),t-=gi(t,ci);break;case"second":t=this._d.valueOf(),t-=gi(t,hi)}return this._d.setTime(t),n.updateOffset(this,!0),this}function wi(e){var t,o;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(o=this._isUTC?mi:fi,e){case"year":t=o(this.year()+1,0,1)-1;break;case"quarter":t=o(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=o(this.year(),this.month()+1,1)-1;break;case"week":t=o(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=o(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=o(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=ui-gi(t+(this._isUTC?0:this.utcOffset()*ci),ui)-1;break;case"minute":t=this._d.valueOf(),t+=ci-gi(t,ci)-1;break;case"second":t=this._d.valueOf(),t+=hi-gi(t,hi)-1}return this._d.setTime(t),n.updateOffset(this,!0),this}function Ci(){return this._d.valueOf()-6e4*(this._offset||0)}function yi(){return Math.floor(this.valueOf()/1e3)}function vi(){return new Date(this.valueOf())}function bi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Si(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ri(){return this.isValid()?this.toISOString():null}function Ei(){return p(this)}function Mi(){return d({},m(this))}function Ti(){return m(this).overflow}function xi(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Oi(e,t){var o,i,s,r=this._eras||wn("en")._eras;for(o=0,i=r.length;o<i;++o)switch("string"==typeof r[o].since&&(s=n(r[o].since).startOf("day"),r[o].since=s.valueOf()),typeof r[o].until){case"undefined":r[o].until=1/0;break;case"string":s=n(r[o].until).startOf("day").valueOf(),r[o].until=s.valueOf()}return r}function Ai(e,t,n){var o,i,s,r,l,a=this.eras();for(e=e.toUpperCase(),o=0,i=a.length;o<i;++o)if(s=a[o].name.toUpperCase(),r=a[o].abbr.toUpperCase(),l=a[o].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(r===e)return a[o];break;case"NNNN":if(s===e)return a[o];break;case"NNNNN":if(l===e)return a[o]}else if([s,r,l].indexOf(e)>=0)return a[o]}function _i(e,t){var o=e.since<=e.until?1:-1;return void 0===t?n(e.since).year():n(e.since).year()+(t-e.offset)*o}function Ii(){var e,t,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until)return o[e].name;if(o[e].until<=n&&n<=o[e].since)return o[e].name}return""}function ki(){var e,t,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until)return o[e].narrow;if(o[e].until<=n&&n<=o[e].since)return o[e].narrow}return""}function Hi(){var e,t,n,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),o[e].since<=n&&n<=o[e].until)return o[e].abbr;if(o[e].until<=n&&n<=o[e].since)return o[e].abbr}return""}function Di(){var e,t,o,i,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e)if(o=s[e].since<=s[e].until?1:-1,i=this.clone().startOf("day").valueOf(),s[e].since<=i&&i<=s[e].until||s[e].until<=i&&i<=s[e].since)return(this.year()-n(s[e].since).year())*o+s[e].offset;return this.year()}function Ni(e){return r(this,"_erasNameRegex")||Ui.call(this),e?this._erasNameRegex:this._erasRegex}function Pi(e){return r(this,"_erasAbbrRegex")||Ui.call(this),e?this._erasAbbrRegex:this._erasRegex}function Li(e){return r(this,"_erasNarrowRegex")||Ui.call(this),e?this._erasNarrowRegex:this._erasRegex}function Vi(e,t){return t.erasAbbrRegex(e)}function Fi(e,t){return t.erasNameRegex(e)}function Bi(e,t){return t.erasNarrowRegex(e)}function Wi(e,t){return t._eraYearOrdinalRegex||xe}function Ui(){var e,t,n=[],o=[],i=[],s=[],r=this.eras();for(e=0,t=r.length;e<t;++e)o.push(Pe(r[e].name)),n.push(Pe(r[e].abbr)),i.push(Pe(r[e].narrow)),s.push(Pe(r[e].name)),s.push(Pe(r[e].abbr)),s.push(Pe(r[e].narrow));this._erasRegex=new RegExp("^("+s.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+o.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+i.join("|")+")","i")}function ji(e,t){F(0,[e,e.length],0,t)}function zi(e){return Xi.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Yi(e){return Xi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function $i(){return St(this.year(),1,4)}function Gi(){return St(this.isoWeekYear(),1,4)}function Ki(){var e=this.localeData()._week;return St(this.year(),e.dow,e.doy)}function qi(){var e=this.localeData()._week;return St(this.weekYear(),e.dow,e.doy)}function Xi(e,t,n,o,i){var s;return null==e?bt(this,o,i).year:(t>(s=St(e,o,i))&&(t=s),Zi.call(this,e,t,n,o,i))}function Zi(e,t,n,o,i){var s=vt(e,t,n,o,i),r=Ct(s.year,0,s.dayOfYear);return this.year(r.getUTCFullYear()),this.month(r.getUTCMonth()),this.date(r.getUTCDate()),this}function Ji(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}F("N",0,0,"eraAbbr"),F("NN",0,0,"eraAbbr"),F("NNN",0,0,"eraAbbr"),F("NNNN",0,0,"eraName"),F("NNNNN",0,0,"eraNarrow"),F("y",["y",1],"yo","eraYear"),F("y",["yy",2],0,"eraYear"),F("y",["yyy",3],0,"eraYear"),F("y",["yyyy",4],0,"eraYear"),He("N",Vi),He("NN",Vi),He("NNN",Vi),He("NNNN",Fi),He("NNNNN",Bi),Ve(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,n,o){var i=n._locale.erasParse(e,o,n._strict);i?m(n).era=i:m(n).invalidEra=e})),He("y",xe),He("yy",xe),He("yyy",xe),He("yyyy",xe),He("yo",Wi),Ve(["y","yy","yyy","yyyy"],Ue),Ve(["yo"],(function(e,t,n,o){var i;n._locale._eraYearOrdinalRegex&&(i=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[Ue]=n._locale.eraYearOrdinalParse(e,i):t[Ue]=parseInt(e,10)})),F(0,["gg",2],0,(function(){return this.weekYear()%100})),F(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),ji("gggg","weekYear"),ji("ggggg","weekYear"),ji("GGGG","isoWeekYear"),ji("GGGGG","isoWeekYear"),te("weekYear","gg"),te("isoWeekYear","GG"),se("weekYear",1),se("isoWeekYear",1),He("G",Oe),He("g",Oe),He("GG",be,we),He("gg",be,we),He("GGGG",Me,ye),He("gggg",Me,ye),He("GGGGG",Te,ve),He("ggggg",Te,ve),Fe(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,o){t[o.substr(0,2)]=he(e)})),Fe(["gg","GG"],(function(e,t,o,i){t[i]=n.parseTwoDigitYear(e)})),F("Q",0,"Qo","quarter"),te("quarter","Q"),se("quarter",7),He("Q",pe),Ve("Q",(function(e,t){t[je]=3*(he(e)-1)})),F("D",["DD",2],"Do","date"),te("date","D"),se("date",9),He("D",be),He("DD",be,we),He("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),Ve(["D","DD"],ze),Ve("Do",(function(e,t){t[ze]=he(e.match(be)[0])}));var Qi=ce("Date",!0);function es(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}F("DDD",["DDDD",3],"DDDo","dayOfYear"),te("dayOfYear","DDD"),se("dayOfYear",4),He("DDD",Ee),He("DDDD",Ce),Ve(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=he(e)})),F("m",["mm",2],0,"minute"),te("minute","m"),se("minute",14),He("m",be),He("mm",be,we),Ve(["m","mm"],$e);var ts=ce("Minutes",!1);F("s",["ss",2],0,"second"),te("second","s"),se("second",15),He("s",be),He("ss",be,we),Ve(["s","ss"],Ge);var ns,os,is=ce("Seconds",!1);for(F("S",0,0,(function(){return~~(this.millisecond()/100)})),F(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),F(0,["SSS",3],0,"millisecond"),F(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),F(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),F(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),F(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),F(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),F(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),te("millisecond","ms"),se("millisecond",16),He("S",Ee,pe),He("SS",Ee,we),He("SSS",Ee,Ce),ns="SSSS";ns.length<=9;ns+="S")He(ns,xe);function ss(e,t){t[Ke]=he(1e3*("0."+e))}for(ns="S";ns.length<=9;ns+="S")Ve(ns,ss);function rs(){return this._isUTC?"UTC":""}function ls(){return this._isUTC?"Coordinated Universal Time":""}os=ce("Milliseconds",!1),F("z",0,0,"zoneAbbr"),F("zz",0,0,"zoneName");var as=b.prototype;function hs(e){return Kn(1e3*e)}function cs(){return Kn.apply(null,arguments).parseZone()}function us(e){return e}as.add=Do,as.calendar=Uo,as.clone=jo,as.diff=Xo,as.endOf=wi,as.format=ti,as.from=ni,as.fromNow=oi,as.to=ii,as.toNow=si,as.get=ge,as.invalidAt=Ti,as.isAfter=zo,as.isBefore=Yo,as.isBetween=$o,as.isSame=Go,as.isSameOrAfter=Ko,as.isSameOrBefore=qo,as.isValid=Ei,as.lang=li,as.locale=ri,as.localeData=ai,as.max=Xn,as.min=qn,as.parsingFlags=Mi,as.set=fe,as.startOf=pi,as.subtract=No,as.toArray=bi,as.toObject=Si,as.toDate=vi,as.toISOString=Qo,as.inspect=ei,"undefined"!=typeof Symbol&&null!=Symbol.for&&(as[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),as.toJSON=Ri,as.toString=Jo,as.unix=yi,as.valueOf=Ci,as.creationData=xi,as.eraName=Ii,as.eraNarrow=ki,as.eraAbbr=Hi,as.eraYear=Di,as.year=mt,as.isLeapYear=pt,as.weekYear=zi,as.isoWeekYear=Yi,as.quarter=as.quarters=Ji,as.month=ht,as.daysInMonth=ct,as.week=as.weeks=xt,as.isoWeek=as.isoWeeks=Ot,as.weeksInYear=Ki,as.weeksInWeekYear=qi,as.isoWeeksInYear=$i,as.isoWeeksInISOWeekYear=Gi,as.date=Qi,as.day=as.days=jt,as.weekday=zt,as.isoWeekday=Yt,as.dayOfYear=es,as.hour=as.hours=nn,as.minute=as.minutes=ts,as.second=as.seconds=is,as.millisecond=as.milliseconds=os,as.utcOffset=mo,as.utc=wo,as.local=Co,as.parseZone=yo,as.hasAlignedHourOffset=vo,as.isDST=bo,as.isLocal=Ro,as.isUtcOffset=Eo,as.isUtc=Mo,as.isUTC=Mo,as.zoneAbbr=rs,as.zoneName=ls,as.dates=E("dates accessor is deprecated. Use date instead.",Qi),as.months=E("months accessor is deprecated. Use month instead",ht),as.years=E("years accessor is deprecated. Use year instead",mt),as.zone=E("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",po),as.isDSTShifted=E("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",So);var ds=I.prototype;function gs(e,t,n,o){var i=wn(),s=g().set(o,t);return i[n](s,e)}function fs(e,t,n){if(h(e)&&(t=e,e=void 0),e=e||"",null!=t)return gs(e,t,n,"month");var o,i=[];for(o=0;o<12;o++)i[o]=gs(e,o,n,"month");return i}function ms(e,t,n,o){"boolean"==typeof e?(h(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,h(t)&&(n=t,t=void 0),t=t||"");var i,s=wn(),r=e?s._week.dow:0,l=[];if(null!=n)return gs(t,(n+r)%7,o,"day");for(i=0;i<7;i++)l[i]=gs(t,(i+r)%7,o,"day");return l}function ps(e,t){return fs(e,t,"months")}function ws(e,t){return fs(e,t,"monthsShort")}function Cs(e,t,n){return ms(e,t,n,"weekdays")}function ys(e,t,n){return ms(e,t,n,"weekdaysShort")}function vs(e,t,n){return ms(e,t,n,"weekdaysMin")}ds.calendar=H,ds.longDateFormat=Y,ds.invalidDate=G,ds.ordinal=X,ds.preparse=us,ds.postformat=us,ds.relativeTime=J,ds.pastFuture=Q,ds.set=A,ds.eras=Oi,ds.erasParse=Ai,ds.erasConvertYear=_i,ds.erasAbbrRegex=Pi,ds.erasNameRegex=Ni,ds.erasNarrowRegex=Li,ds.months=it,ds.monthsShort=st,ds.monthsParse=lt,ds.monthsRegex=dt,ds.monthsShortRegex=ut,ds.week=Rt,ds.firstDayOfYear=Tt,ds.firstDayOfWeek=Mt,ds.weekdays=Vt,ds.weekdaysMin=Bt,ds.weekdaysShort=Ft,ds.weekdaysParse=Ut,ds.weekdaysRegex=$t,ds.weekdaysShortRegex=Gt,ds.weekdaysMinRegex=Kt,ds.isPM=en,ds.meridiem=on,fn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===he(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),n.lang=E("moment.lang is deprecated. Use moment.locale instead.",fn),n.langData=E("moment.langData is deprecated. Use moment.localeData instead.",wn);var bs=Math.abs;function Ss(){var e=this._data;return this._milliseconds=bs(this._milliseconds),this._days=bs(this._days),this._months=bs(this._months),e.milliseconds=bs(e.milliseconds),e.seconds=bs(e.seconds),e.minutes=bs(e.minutes),e.hours=bs(e.hours),e.months=bs(e.months),e.years=bs(e.years),this}function Rs(e,t,n,o){var i=Oo(t,n);return e._milliseconds+=o*i._milliseconds,e._days+=o*i._days,e._months+=o*i._months,e._bubble()}function Es(e,t){return Rs(this,e,t,1)}function Ms(e,t){return Rs(this,e,t,-1)}function Ts(e){return e<0?Math.floor(e):Math.ceil(e)}function xs(){var e,t,n,o,i,s=this._milliseconds,r=this._days,l=this._months,a=this._data;return s>=0&&r>=0&&l>=0||s<=0&&r<=0&&l<=0||(s+=864e5*Ts(As(l)+r),r=0,l=0),a.milliseconds=s%1e3,e=ae(s/1e3),a.seconds=e%60,t=ae(e/60),a.minutes=t%60,n=ae(t/60),a.hours=n%24,r+=ae(n/24),l+=i=ae(Os(r)),r-=Ts(As(i)),o=ae(l/12),l%=12,a.days=r,a.months=l,a.years=o,this}function Os(e){return 4800*e/146097}function As(e){return 146097*e/4800}function _s(e){if(!this.isValid())return NaN;var t,n,o=this._milliseconds;if("month"===(e=ne(e))||"quarter"===e||"year"===e)switch(t=this._days+o/864e5,n=this._months+Os(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(As(this._months)),e){case"week":return t/7+o/6048e5;case"day":return t+o/864e5;case"hour":return 24*t+o/36e5;case"minute":return 1440*t+o/6e4;case"second":return 86400*t+o/1e3;case"millisecond":return Math.floor(864e5*t)+o;default:throw new Error("Unknown unit "+e)}}function Is(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*he(this._months/12):NaN}function ks(e){return function(){return this.as(e)}}var Hs=ks("ms"),Ds=ks("s"),Ns=ks("m"),Ps=ks("h"),Ls=ks("d"),Vs=ks("w"),Fs=ks("M"),Bs=ks("Q"),Ws=ks("y");function Us(){return Oo(this)}function js(e){return e=ne(e),this.isValid()?this[e+"s"]():NaN}function zs(e){return function(){return this.isValid()?this._data[e]:NaN}}var Ys=zs("milliseconds"),$s=zs("seconds"),Gs=zs("minutes"),Ks=zs("hours"),qs=zs("days"),Xs=zs("months"),Zs=zs("years");function Js(){return ae(this.days()/7)}var Qs=Math.round,er={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function tr(e,t,n,o,i){return i.relativeTime(t||1,!!n,e,o)}function nr(e,t,n,o){var i=Oo(e).abs(),s=Qs(i.as("s")),r=Qs(i.as("m")),l=Qs(i.as("h")),a=Qs(i.as("d")),h=Qs(i.as("M")),c=Qs(i.as("w")),u=Qs(i.as("y")),d=s<=n.ss&&["s",s]||s<n.s&&["ss",s]||r<=1&&["m"]||r<n.m&&["mm",r]||l<=1&&["h"]||l<n.h&&["hh",l]||a<=1&&["d"]||a<n.d&&["dd",a];return null!=n.w&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),(d=d||h<=1&&["M"]||h<n.M&&["MM",h]||u<=1&&["y"]||["yy",u])[2]=t,d[3]=+e>0,d[4]=o,tr.apply(null,d)}function or(e){return void 0===e?Qs:"function"==typeof e&&(Qs=e,!0)}function ir(e,t){return void 0!==er[e]&&(void 0===t?er[e]:(er[e]=t,"s"===e&&(er.ss=t-1),!0))}function sr(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,o,i=!1,s=er;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(i=e),"object"==typeof t&&(s=Object.assign({},er,t),null!=t.s&&null==t.ss&&(s.ss=t.s-1)),o=nr(this,!i,s,n=this.localeData()),i&&(o=n.pastFuture(+this,o)),n.postformat(o)}var rr=Math.abs;function lr(e){return(e>0)-(e<0)||+e}function ar(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,o,i,s,r,l,a=rr(this._milliseconds)/1e3,h=rr(this._days),c=rr(this._months),u=this.asSeconds();return u?(e=ae(a/60),t=ae(e/60),a%=60,e%=60,n=ae(c/12),c%=12,o=a?a.toFixed(3).replace(/\.?0+$/,""):"",i=u<0?"-":"",s=lr(this._months)!==lr(u)?"-":"",r=lr(this._days)!==lr(u)?"-":"",l=lr(this._milliseconds)!==lr(u)?"-":"",i+"P"+(n?s+n+"Y":"")+(c?s+c+"M":"")+(h?r+h+"D":"")+(t||e||a?"T":"")+(t?l+t+"H":"")+(e?l+e+"M":"")+(a?l+o+"S":"")):"P0D"}var hr=so.prototype;return hr.isValid=oo,hr.abs=Ss,hr.add=Es,hr.subtract=Ms,hr.as=_s,hr.asMilliseconds=Hs,hr.asSeconds=Ds,hr.asMinutes=Ns,hr.asHours=Ps,hr.asDays=Ls,hr.asWeeks=Vs,hr.asMonths=Fs,hr.asQuarters=Bs,hr.asYears=Ws,hr.valueOf=Is,hr._bubble=xs,hr.clone=Us,hr.get=js,hr.milliseconds=Ys,hr.seconds=$s,hr.minutes=Gs,hr.hours=Ks,hr.days=qs,hr.weeks=Js,hr.months=Xs,hr.years=Zs,hr.humanize=sr,hr.toISOString=ar,hr.toString=ar,hr.toJSON=ar,hr.locale=ri,hr.localeData=ai,hr.toIsoString=E("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ar),hr.lang=li,F("X",0,0,"unix"),F("x",0,0,"valueOf"),He("x",Oe),He("X",Ie),Ve("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e))})),Ve("x",(function(e,t,n){n._d=new Date(he(e))})),
//! moment.js
n.version="2.29.4",o(Kn),n.fn=as,n.min=Jn,n.max=Qn,n.now=eo,n.utc=g,n.unix=hs,n.months=ps,n.isDate=c,n.locale=fn,n.invalid=w,n.duration=Oo,n.isMoment=S,n.weekdays=Cs,n.parseZone=cs,n.localeData=wn,n.isDuration=ro,n.monthsShort=ws,n.weekdaysMin=vs,n.defineLocale=mn,n.updateLocale=pn,n.locales=Cn,n.weekdaysShort=ys,n.normalizeUnits=ne,n.relativeTimeRounding=or,n.relativeTimeThreshold=ir,n.calendarFormat=Wo,n.prototype=as,n.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},n}();var Ul=Wl.exports,jl=l(Ul);function zl(e){const t=e.length;let n=0;for(;n<t;)e[n]=[e[n]],n+=1}function Yl(e,t){const n=t.length;let o=0;for(;o<n;)e.push(t[o]),o+=1}function $l(e){const t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;const n=e.length,o=e[0].length;for(let i=0;i<n;i++)for(let n=0;n<o;n++)t[n]||(t[n]=[]),t[n][i]=e[i][n];return t}function Gl(e,t,n,o){let i=-1,s=e,r=n;Array.isArray(e)||(s=Array.from(e));const l=s.length;for(o&&l&&(i+=1,r=s[i]),i+=1;i<l;)r=t(r,s[i],i,s),i+=1;return r}function Kl(e,t){let n=0,o=e;Array.isArray(e)||(o=Array.from(e));const i=o.length,s=[];let r=-1;for(;n<i;){const e=o[n];t(e,n,o)&&(r+=1,s[r]=e),n+=1}return s}function ql(e,t){let n=0,o=e;Array.isArray(e)||(o=Array.from(e));const i=o.length,s=[];let r=-1;for(;n<i;){const e=o[n];r+=1,s[r]=t(e,n,o),n+=1}return s}function Xl(e,t){let n=0,o=e;Array.isArray(e)||(o=Array.from(e));const i=o.length;for(;n<i&&!1!==t(o[n],n,o);)n+=1;return e}function Zl(e){return Gl(e,((e,t)=>e+t),0)}function Jl(e){const t=[];return Xl(e,(e=>{-1===t.indexOf(e)&&t.push(e)})),t}function Ql(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[o,...i]=[...t];let s=o;return Xl(i,(e=>{s=s.filter((t=>!e.includes(t)))})),s}function ea(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}var ta=Object.freeze({__proto__:null,arrayAvg:function(e){return e.length?Zl(e)/e.length:0},arrayEach:Xl,arrayFilter:Kl,arrayFlatten:function e(t){return Gl(t,((t,n)=>t.concat(Array.isArray(n)?e(n):n)),[])},arrayMap:ql,arrayMax:function(e){return Gl(e,((e,t)=>e>t?e:t),Array.isArray(e)?e[0]:void 0)},arrayMin:function(e){return Gl(e,((e,t)=>e<t?e:t),Array.isArray(e)?e[0]:void 0)},arrayReduce:Gl,arraySum:Zl,arrayUnique:Jl,extendArray:Yl,getDifferenceOfArrays:Ql,getIntersectionOfArrays:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[o,...i]=[...t];let s=o;return Xl(i,(e=>{s=s.filter((t=>e.includes(t)))})),s},getUnionOfArrays:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[o,...i]=[...t],s=new Set(o);return Xl(i,(e=>{Xl(e,(e=>{s.has(e)||s.add(e)}))})),Array.from(s)},pivot:$l,stringToArray:ea,to2dArray:zl});function na(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const i=Gl(e,((e,t,o)=>e+t.replace(/\r?\n\s*/g,"")+(n[o]?n[o]:"")),"");return i.trim()}function oa(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function ia(e){return void 0!==e}function sa(e){return void 0===e}function ra(e){return null===e||""===e||sa(e)}function la(e){return"[object RegExp]"===Object.prototype.toString.call(e)}const aa="length",ha=e=>parseInt(e,16),ca=e=>parseInt(e,10),ua=(e,t,n)=>e.substr(t,n),da=e=>e.codePointAt(0)-65,ga=e=>`${e}`.replace(/\-/g,"");let fa=!1;const ma={invalid:()=>na`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return na`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>na`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},pa={invalid:()=>na`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return na`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>na`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function wa(e,t){const n=!ra(e),o="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="13.1.0";let s,r="invalid",l="invalid";const a=function(e){let t=[][aa],n=t;if(e[aa]!==da("Z"))return!1;for(let t="",o="B<H4P+".split(""),i=da(o.shift());i;i=da(o.shift()||"A"))--i<""[aa]?n|=(ca(`${ca(ha(t)+(ha(ua(e,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:t=ua(e,i,i?1===o[aa]?9:8:6);return n===t}(e=ga(e||""));if(n||o||a)if(a){const t=jl("31/08/2023","DD/MM/YYYY"),n=Math.floor(t.toDate().getTime()/864e5),o=ha(ua(ga(h=e),ha("12"),da("F")))/(ha(ua(ga(h),da("B"),~~![][aa]))||9);s=jl(864e5*(o+1),"x").format("MMMM DD, YYYY"),n>o?(r="expired",l="expired"):(r="valid",l="valid")}else o?(r="non_commercial",l="valid"):(r="invalid",l="invalid");else r="missing",l="missing";var h;if("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(r="valid",l="valid"),!fa&&"valid"!==r){ma[r]({keyValidityDate:s,hotVersion:i})&&console["non_commercial"===r?"info":"warn"](ma[r]({keyValidityDate:s,hotVersion:i})),fa=!0}if("valid"!==l&&t.parentNode){if(pa[l]({keyValidityDate:s,hotVersion:i})){const e=document.createElement("div");e.className="hot-display-license-info",e.innerHTML=pa[l]({keyValidityDate:s,hotVersion:i}),t.parentNode.insertBefore(e,t.nextSibling)}}}var Ca=Object.freeze({__proto__:null,_injectProductInfo:wa,isDefined:ia,isEmpty:ra,isRegExp:la,isUndefined:sa,stringify:oa});function ya(e){return e[0].toUpperCase()+e.substr(1)}function va(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function ba(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function Sa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,((e,n)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]))}function Ra(e){return Ea(`${e}`,{ALLOWED_TAGS:[]})}function Ea(e,t){return Vl.sanitize(e,t)}var Ma=Object.freeze({__proto__:null,equalsIgnoreCase:function(){const e=[];for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];let i=n.length;for(;i;){i-=1;const t=oa(n[i]).toLowerCase();-1===e.indexOf(t)&&e.push(t)}return 1===e.length},isPercentValue:ba,randomString:va,sanitize:Ea,stripTags:Ra,substitute:Sa,toUpperCaseFirst:ya});function Ta(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,o=null,i=e;for(;null!==i;){if(n===t){o=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return o}function xa(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Oa(e){return xa(e)&&e.parent}function Aa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:o,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=e;for(;null!=s&&s!==n;){const{nodeType:e,nodeName:n}=s;if(e===o&&(t.includes(n)||t.includes(s)))return s;const{host:r}=s;s=r&&e===i?r:s.parentNode}return null}function _a(e,t,n){const o=[];let i=e;for(;i&&(i=Aa(i,t,n),i&&(!n||n.contains(i)));)o.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const s=o.length;return s?o[s-1]:null}function Ia(e,t){let n=e.parentNode,o=[];for("string"==typeof t?o=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):o.push(t);null!==n;){if(o.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function ka(e){let t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t}function Ha(e,t,n){const o=n.parentElement.querySelector(`.ht_clone_${e}`);return o?o.contains(t):null}function Da(e){return e&&e.length?e.filter((e=>!!e)):[]}function Na(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)}function Pa(e,t){"string"==typeof t&&(t=t.split(" ")),(t=Da(t)).length>0&&e.classList.add(...t)}function La(e,t){"string"==typeof t&&(t=t.split(" ")),(t=Da(t)).length>0&&e.classList.remove(...t)}function Va(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let e=t.length-1;e>=0;e--)Va(t[e])}}function Fa(e){let t;for(;t=e.lastChild;)e.removeChild(t)}const Ba=/(<(.*)>|&(.*);)/;function Wa(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Ba.test(t)?e.innerHTML=n?Ea(t):t:Ua(e,t)}function Ua(e,t){const n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=t:(Fa(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function ja(e){const t=e.ownerDocument.documentElement;let n=e;for(;n!==t;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return ja(n.host.impl);if(n.host)return ja(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function za(e){const t=e.ownerDocument,n=t.defaultView,o=t.documentElement;let i,s,r,l=e;for(i=l.offsetLeft,s=l.offsetTop,r=l;(l=l.offsetParent)&&l!==t.body;)i+=l.offsetLeft,s+=l.offsetTop,r=l;return r&&"fixed"===r.style.position&&(i+=n.pageXOffset||o.scrollLeft,s+=n.pageYOffset||o.scrollTop),{left:i,top:s}}function Ya(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function $a(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function Ga(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Ya(t):e.scrollTop}function Ka(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?$a(t):e.scrollLeft}function qa(e){let t=e.ownerDocument,n=t?t.defaultView:void 0;t||(t=e.document?e.document:e,n=t.defaultView);const o=["auto","scroll"];let i=e.parentNode;for(;i&&i.style&&t.body!==i;){let{overflow:e,overflowX:t,overflowY:s}=i.style;if([e,t,s].includes("scroll"))return i;if(({overflow:e,overflowX:t,overflowY:s}=n.getComputedStyle(i)),o.includes(e)||o.includes(t)||o.includes(s))return i;if(i.clientHeight<=i.scrollHeight+1&&(o.includes(s)||o.includes(e)))return i;if(i.clientWidth<=i.scrollWidth+1&&(o.includes(t)||o.includes(e)))return i;i=i.parentNode}return n}function Xa(e){const t=e.ownerDocument,n=t.defaultView;let o=e.parentNode;for(;o&&o.style&&t.body!==o;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;const e=Ja(o,n),t=["scroll","hidden","auto"],i=e.getPropertyValue("overflow"),s=e.getPropertyValue("overflow-y"),r=e.getPropertyValue("overflow-x");if(t.includes(i)||t.includes(s)||t.includes(r))return o;o=o.parentNode}return n}function Za(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!e)return;if(e===n)return"width"===t?`${n.innerWidth}px`:"height"===t?`${n.innerHeight}px`:void 0;const o=e.style[t];if(""!==o&&void 0!==o)return o;const i=Ja(e,n);return""!==i[t]&&void 0!==i[t]?i[t]:void 0}function Ja(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function Qa(e){return e.offsetWidth}function eh(e){return e.offsetHeight}function th(e){return e.clientHeight||e.innerHeight}function nh(e){return e.clientWidth||e.innerWidth}function oh(e){return e.selectionStart?e.selectionStart:0}function ih(e){return e.selectionEnd?e.selectionEnd:0}function sh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const t=e.document;let n="";return e.getSelection?n=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(n=t.selection.createRange().text),n}function rh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function lh(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(o){const i=e.parentNode,s=i.style.display;i.style.display="block",e.setSelectionRange(t,n),i.style.display=s}}}let ah;function hh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===ah&&(ah=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);const o=t.offsetWidth;n.style.overflow="scroll";let i=t.offsetWidth;return o===i&&(i=n.clientWidth),(e.body||e.documentElement).removeChild(n),o-i}(e)),ah}function ch(e){return e.offsetWidth!==e.clientWidth}function uh(e){return e.offsetHeight!==e.clientHeight}function dh(e,t,n){e.style.transform=`translate3d(${t},${n},0)`}function gh(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function fh(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function mh(e){return fh(e)&&!1===e.hasAttribute("data-hot-input")}function ph(e){mh(e.ownerDocument.activeElement)||e.select()}function wh(e){return!e.parentNode}function Ch(e,t){new IntersectionObserver(((n,o)=>{n.forEach((n=>{n.isIntersecting&&null!==e.offsetParent&&(t(),o.unobserve(e))}))}),{root:e.ownerDocument.body}).observe(e)}var yh=Object.freeze({__proto__:null,HTML_CHARACTERS:Ba,addClass:Pa,addEvent:function(e,t,n){e.addEventListener(t,n,!1)},clearTextSelection:rh,closest:Aa,closestDown:_a,empty:Fa,fastInnerHTML:Wa,fastInnerText:Ua,getCaretPosition:oh,getComputedStyle:Ja,getCssTransform:function(e){let t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:-1},getFrameElement:xa,getParent:Ta,getParentWindow:Oa,getScrollLeft:Ka,getScrollTop:Ga,getScrollableElement:qa,getScrollbarWidth:hh,getSelectionEndPosition:ih,getSelectionText:sh,getStyle:Za,getTrimmingContainer:Xa,getWindowScrollLeft:$a,getWindowScrollTop:Ya,hasAccessToParentWindow:function(e){return!!Object.getPrototypeOf(e.parent)},hasClass:Na,hasHorizontalScrollbar:uh,hasVerticalScrollbar:ch,index:ka,innerHeight:th,innerWidth:nh,isChildOf:Ia,isDetached:wh,isInput:fh,isOutsideInput:mh,isVisible:ja,matchesCSSRules:function(e,t){const{selectorText:n}=t;let o=!1;return t.type===CSSRule.STYLE_RULE&&n&&(e.msMatchesSelector?o=e.msMatchesSelector(n):e.matches&&(o=e.matches(n))),o},observeVisibilityChangeOnce:Ch,offset:za,outerHeight:eh,outerWidth:Qa,overlayContainsElement:Ha,removeClass:La,removeEvent:function(e,t,n){e.removeEventListener(t,n,!1)},removeTextNodes:Va,resetCssTransform:gh,selectElementIfAllowed:ph,setCaretPosition:lh,setOverlayPosition:dh});function vh(e){return"function"==typeof e}function bh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0;const o={lastCallThrottled:!0};let i=null;return function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];const a=Date.now();let h=!1;o.lastCallThrottled=!0,n||(n=a,h=!0);const c=t-(a-n);return h?(o.lastCallThrottled=!1,e.apply(this,r)):(i&&clearTimeout(i),i=setTimeout((()=>{o.lastCallThrottled=!1,e.apply(this,r),n=0,i=void 0}),c)),o}}function Sh(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=null;return function(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return o&&clearTimeout(o),o=setTimeout((()=>{t=e.apply(this,s)}),n),t}}function Rh(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return e.apply(this,n.concat(o))}}function Eh(e){const t=e.length;return function n(o){return function(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];const l=o.concat(s);let a;return a=l.length>=t?e.apply(this,l):n(l),a}}([])}function Mh(e,t,n,o,i,s,r,l){return ia(l)?e.call(t,n,o,i,s,r,l):ia(r)?e.call(t,n,o,i,s,r):ia(s)?e.call(t,n,o,i,s):ia(i)?e.call(t,n,o,i):ia(o)?e.call(t,n,o):ia(n)?e.call(t,n):e.call(t)}var Th=Object.freeze({__proto__:null,curry:Eh,curryRight:function(e){const t=e.length;return function n(o){return function(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];const l=o.concat(s.reverse());let a;return a=l.length>=t?e.apply(this,l):n(l),a}}([])},debounce:Sh,fastCall:Mh,isFunction:vh,partial:Rh,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[o,...i]=t;return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Gl(i,((e,t)=>t(e)),o.apply(this,t))}},throttle:bh,throttleAfterHits:function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const n=bh(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:200);let o=t;function i(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return o?(o-=1,e.apply(this,i)):n.apply(this,i)}return i.clearHits=function(){o=t},i}}),xh=si,Oh=$,Ah=k,_h=qi,Ih=O([].push),kh=oi,Hh=Z,Dh=Ei,Nh=p,Ph=O,Lh=u,Vh=$,Fh=we,Bh=Ws,Wh=function(e){if(Oh(e))return e;if(xh(e)){for(var t=e.length,n=[],o=0;o<t;o++){var i=e[o];"string"==typeof i?Ih(n,i):"number"!=typeof i&&"Number"!==Ah(i)&&"String"!==Ah(i)||Ih(n,_h(i))}var s=n.length,r=!0;return function(e,t){if(r)return r=!1,t;if(xh(this))return t;for(var o=0;o<s;o++)if(n[o]===e)return t}}},Uh=ue,jh=String,zh=Hh("JSON","stringify"),Yh=Ph(/./.exec),$h=Ph("".charAt),Gh=Ph("".charCodeAt),Kh=Ph("".replace),qh=Ph(1..toString),Xh=/[\uD800-\uDFFF]/g,Zh=/^[\uD800-\uDBFF]$/,Jh=/^[\uDC00-\uDFFF]$/,Qh=!Uh||Lh((function(){var e=Hh("Symbol")("stringify detection");return"[null]"!==zh([e])||"{}"!==zh({a:e})||"{}"!==zh(Object(e))})),ec=Lh((function(){return'"\\udf06\\ud834"'!==zh("\udf06\ud834")||'"\\udead"'!==zh("\udead")})),tc=function(e,t){var n=Bh(arguments),o=Wh(t);if(Vh(o)||void 0!==e&&!Fh(e))return n[1]=function(e,t){if(Vh(o)&&(t=Nh(o,this,jh(e),t)),!Fh(t))return t},Dh(zh,null,n)},nc=function(e,t,n){var o=$h(n,t-1),i=$h(n,t+1);return Yh(Zh,e)&&!Yh(Jh,i)||Yh(Jh,e)&&!Yh(Zh,o)?"\\u"+qh(Gh(e,0),16):e};function oc(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},gc(e,((e,n)=>{"__children"!==n&&(e&&"object"==typeof e&&!Array.isArray(e)?t[n]=oc(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?t[n]=[oc(e[0])]:t[n]=[]:t[n]=null)}))),t}function ic(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function sc(e,t,n){const o=Array.isArray(n);return gc(t,((t,i)=>{(!1===o||n.includes(i))&&(e[i]=t)})),e}function rc(e,t){gc(t,((n,o)=>{t[o]&&"object"==typeof t[o]?(e[o]||(Array.isArray(t[o])?e[o]=[]:"[object Date]"===Object.prototype.toString.call(t[o])?e[o]=t[o]:e[o]={}),rc(e[o],t[o])):e[o]=t[o]}))}function lc(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function ac(e){const t={};return gc(e,((e,n)=>{t[n]=e})),t}function hc(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return Xl(n,(t=>{e.MIXINS.push(t.MIXIN_NAME),gc(t,((t,n)=>{if(void 0!==e.prototype[n])throw new Error(`Mixin conflict. Property '${n}' already exist and cannot be overwritten.`);if("function"==typeof t)e.prototype[n]=t;else{const o=function(e,t){const n=`_${e}`;return function(){return void 0===this[n]&&(this[n]=(e=>{let t=e;return(Array.isArray(t)||uc(t))&&(t=lc(t)),t})(t)),this[n]}},i=function(e){const t=`_${e}`;return function(e){this[t]=e}};Object.defineProperty(e.prototype,n,{get:o(n,t),set:i(n),configurable:!0})}}))})),e}function cc(e,t){return JSON.stringify(e)===JSON.stringify(t)}function uc(e){return"[object Object]"===Object.prototype.toString.call(e)}function dc(e,t,n,o){o.value=n,o.writable=!1!==o.writable,o.enumerable=!1!==o.enumerable,o.configurable=!1!==o.configurable,Object.defineProperty(e,t,o)}function gc(e,t){for(const n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function fc(e,t){const n=t.split(".");let o=e;return gc(n,(e=>{if(o=o[e],void 0===o)return o=void 0,!1})),o}function mc(e,t,n){const o=t.split(".");let i=e;o.forEach(((e,t)=>{t!==o.length-1?(Cc(i,e)||(i[e]={}),i=i[e]):i[e]=n}))}function pc(e){if(!uc(e))return 0;const t=function(e){let n=0;return uc(e)?gc(e,((e,o)=>{"__children"!==o&&(n+=t(e))})):n+=1,n};return t(e)}function wc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const n=`_${t}`,o={_touched:!1,[n]:e,isTouched(){return this._touched}};return Object.defineProperty(o,t,{get(){return this[n]},set(e){this._touched=!0,this[n]=e},enumerable:!0,configurable:!0}),o}function Cc(e,t){return Object.prototype.hasOwnProperty.call(e,t)}zh&&kh({target:"JSON",stat:!0,arity:3,forced:Qh||ec},{stringify:function(e,t,n){var o=Bh(arguments),i=Dh(Qh?tc:zh,null,o);return ec&&"string"==typeof i?Kh(i,Xh,nc):i}});var yc=Object.freeze({__proto__:null,clone:ac,createObjectPropListener:wc,deepClone:lc,deepExtend:rc,deepObjectSize:pc,defineGetter:dc,duckSchema:oc,extend:sc,getProperty:fc,hasOwnProperty:Cc,inherit:ic,isObject:uc,isObjectEqual:cc,mixin:hc,objectEach:gc,setProperty:mc});const vc=e=>{const t={value:!1,test:(n,o)=>{t.value=e(n,o)}};return t},bc={chrome:vc(((e,t)=>/Chrome/.test(e)&&/Google/.test(t))),chromeWebKit:vc((e=>/CriOS/.test(e))),edge:vc((e=>/Edge/.test(e))),edgeWebKit:vc((e=>/EdgiOS/.test(e))),firefox:vc((e=>/Firefox/.test(e))),firefoxWebKit:vc((e=>/FxiOS/.test(e))),mobile:vc((e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e))),safari:vc(((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t)))},Sc={mac:vc((e=>/^Mac/.test(e))),win:vc((e=>/^Win/.test(e))),linux:vc((e=>/^Linux/.test(e))),ios:vc((e=>/iPhone|iPad|iPod/i.test(e)))};function Rc(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};gc(bc,(n=>{let{test:o}=n;o(e,t)}))}function Ec(){let{platform:e=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};gc(Sc,(t=>{let{test:n}=t;n(e)}))}function Mc(){return bc.chrome.value}function Tc(){return bc.chromeWebKit.value}function xc(){return bc.firefox.value}function Oc(){return bc.firefoxWebKit.value}function Ac(){return bc.edge.value}function _c(){return bc.mobile.value}function Ic(){return Sc.ios.value}function kc(){let{maxTouchPoints:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e>2&&Sc.mac.value}function Hc(){return Sc.win.value}function Dc(){return Sc.mac.value}Rc(),Ec();var Nc=Object.freeze({__proto__:null,isChrome:Mc,isChromeWebKit:Tc,isEdge:Ac,isEdgeWebKit:function(){return bc.edgeWebKit.value},isFirefox:xc,isFirefoxWebKit:Oc,isIOS:Ic,isIpadOS:kc,isLinuxOS:function(){return Sc.linux.value},isMacOS:Dc,isMobileBrowser:_c,isSafari:function(){return bc.safari.value},isWindowsOS:Hc,setBrowserMeta:Rc,setPlatformMeta:Ec});const Pc={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:xc()?182:174,AUDIO_MUTE:xc()?181:173,AUDIO_UP:xc()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Lc=[Pc.ALT,Pc.ARROW_DOWN,Pc.ARROW_LEFT,Pc.ARROW_RIGHT,Pc.ARROW_UP,Pc.AUDIO_DOWN,Pc.AUDIO_MUTE,Pc.AUDIO_UP,Pc.BACKSPACE,Pc.CAPS_LOCK,Pc.DELETE,Pc.END,Pc.ENTER,Pc.ESCAPE,Pc.F1,Pc.F2,Pc.F3,Pc.F4,Pc.F5,Pc.F6,Pc.F7,Pc.F8,Pc.F9,Pc.F10,Pc.F11,Pc.F12,Pc.F13,Pc.F14,Pc.F15,Pc.F16,Pc.F17,Pc.F18,Pc.F19,Pc.HOME,Pc.INSERT,Pc.MEDIA_NEXT,Pc.MEDIA_PLAY_PAUSE,Pc.MEDIA_PREV,Pc.MEDIA_STOP,Pc.NULL,Pc.NUM_LOCK,Pc.PAGE_DOWN,Pc.PAGE_UP,Pc.PAUSE,Pc.SCROLL_LOCK,Pc.SHIFT,Pc.TAB];function Vc(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function Fc(e){return Lc.includes(e)}function Bc(e){return[Pc.CONTROL,Pc.COMMAND_LEFT,Pc.COMMAND_RIGHT,Pc.COMMAND_FIREFOX].includes(e)}function Wc(e,t){const n=t.split("|");let o=!1;return Xl(n,(t=>{if(e===Pc[t])return o=!0,!1})),o}var Uc=Object.freeze({__proto__:null,KEY_CODES:Pc,isCtrlKey:function(e){const t=[];return Dc()?t.push(Pc.COMMAND_LEFT,Pc.COMMAND_RIGHT,Pc.COMMAND_FIREFOX):t.push(Pc.CONTROL),t.includes(e)},isCtrlMetaKey:Bc,isFunctionKey:Fc,isKey:Wc,isPrintableChar:Vc});function jc(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function zc(e){return!1===e.isImmediatePropagationEnabled}function Yc(e){return 2===e.button}function $c(e){return 0===e.button}var Gc=Object.freeze({__proto__:null,isImmediatePropagationStopped:zc,isLeftClick:$c,isRightClick:Yc,stopImmediatePropagation:jc});function Kc(){ia(console)&&console.warn(...arguments)}function qc(){ia(console)&&console.error(...arguments)}const Xc=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Zc=na`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Jc=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Qc=new Map([]);class eu{static getSingleton(){return tu}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return Xl(Xc,(t=>e[t]=[])),e}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))Xl(t,(t=>this.add(e,t,n)));else{Jc.has(e)&&Kc(Sa(Zc,{hookName:e,removedInVersion:Jc.get(e)})),Qc.has(e)&&Kc(Qc.get(e));const o=this.getBucket(n);if(void 0===o[e]&&(this.register(e),o[e]=[]),t.skip=!1,-1===o[e].indexOf(t)){let n=!1;t.initialHook&&Xl(o[e],((i,s)=>{if(i.initialHook)return o[e][s]=t,n=!0,!1})),n||o[e].push(t)}}return this}once(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?Xl(t,(t=>this.once(e,t,n))):(t.runOnce=!0,this.add(e,t,n))}remove(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=this.getBucket(n);return void 0!==o[e]&&o[e].indexOf(t)>=0&&(t.skip=!0,!0)}has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}run(e,t,n,o,i,s,r,l){{const a=this.globalBucket[t],h=a?a.length:0;let c=0;if(h)for(;c<h;){if(!a[c]||a[c].skip){c+=1;continue}const h=Mh(a[c],e,n,o,i,s,r,l);void 0!==h&&(n=h),a[c]&&a[c].runOnce&&this.remove(t,a[c]),c+=1}}{const a=this.getBucket(e)[t],h=a?a.length:0;let c=0;if(h)for(;c<h;){if(!a[c]||a[c].skip){c+=1;continue}const h=Mh(a[c],e,n,o,i,s,r,l);void 0!==h&&(n=h),a[c]&&a[c].runOnce&&this.remove(t,a[c],e),c+=1}}return n}destroy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;gc(this.getBucket(e),((e,t,n)=>n[t].length=0))}register(e){this.isRegistered(e)||Xc.push(e)}deregister(e){this.isRegistered(e)&&Xc.splice(Xc.indexOf(e),1)}isDeprecated(e){return Qc.has(e)||Jc.has(e)}isRegistered(e){return Xc.indexOf(e)>=0}getRegistered(){return Xc}}const tu=new eu;var nu=eu;const ou=new Map;function iu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";ou.has(e)||ou.set(e,new Map);const t=ou.get(e);return{register:function(e,n){t.set(e,n)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return[...t.keys()]},getValues:function(){return[...t.values()]}}}const su=new WeakMap,{register:ru,getItem:lu,hasItem:au,getNames:hu,getValues:cu}=iu("editors");function uu(e){const t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},nu.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function du(e,t){let n;if("function"==typeof e)su.get(e)||fu(null,e),n=su.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=lu(e)}if(!n)throw Error(`No editor registered under name "${e}"`);return n.getInstance(t)}function gu(e){if("function"==typeof e)return e;if(!au(e))throw Error(`No registered editor found under "${e}" name`);return lu(e).getConstructor()}function fu(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);const n=new uu(t);"string"==typeof e&&ru(e,n),su.set(t,n)}let mu=0;var pu=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(e){n.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),jc(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:o,eventManager:this}),e.addEventListener(t,i,o),mu+=1,()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){let o,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.context.eventListeners.length;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===t&&o.element===e){if(n&&n!==o.callback)continue;if(i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),mu-=1}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),mu-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,o=e;n||(n=e.ownerDocument?e.ownerDocument:e,o=n.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==t,view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${t}`,s)}};const wu="editorManager.navigation",Cu="editorManager.handlingEditor";class yu{constructor(e,t,n){this.instance=e,this.tableMeta=t,this.selection=n,this.eventManager=new pu(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(e=>this.onAfterDocumentKeyDown(e))),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(e=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",e)})),this.instance.view._wt.update("onCellDblClick",((e,t,n)=>this.onCellDblClick(e,t,n)))}registerShortcuts(){const e=this.instance.getShortcutManager(),t=e.getContext("grid"),n=e.getContext("editor"),o={group:Cu};n.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(t,n)=>{this.closeEditorAndSaveChanges(e.isCtrlPressed()),this.moveSelectionAfterEnter(n.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>{this.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),this.activeEditor.focus()}}],o),t.addShortcuts([{keys:[["F2"]],callback:e=>{this.openEditor(null,e,!0)}},{keys:[["Backspace"],["Delete"]],callback:()=>{this.instance.emptySelectedCells(),this.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>{this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.openEditor(null,e,!0):this.moveSelectionAfterEnter(t.includes("shift")),jc(e)}}],{...o,runOnlyIf:()=>ia(this.instance.getSelected())})}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(e=>{e&&this.prepareEditor()}));const{row:e,col:t}=this.instance.getSelectedRangeLast().highlight,n=this.instance.runHooks("modifyGetCellCoords",e,t);let o=e,i=t;Array.isArray(n)&&([o,i]=n),this.cellProperties=this.instance.getCellMeta(o,i);const{activeElement:s}=this.instance.rootDocument;if(s&&mh(s)&&s.blur(),!this.isCellEditable())return void this.clearActiveEditor();const r=this.instance.getCell(e,t,!0);if(r){const n=this.instance.getCellEditor(this.cellProperties),s=this.instance.colToProp(i),l=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(o),i);this.activeEditor=du(n,this.instance),this.activeEditor.prepare(e,t,s,r,l,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isCellEditable()){if(!this.activeEditor){const{row:e,col:t}=this.instance.getSelectedRangeLast().highlight,n=this.instance.rowIndexMapper.getRenderableFromVisualIndex(e),o=this.instance.columnIndexMapper.getRenderableFromVisualIndex(t);this.instance.view.scrollViewport(this.instance._createCellCoords(n,o)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}else this.clearActiveEditor()}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.instance.getCellEditor(this.cellProperties),{row:t,col:n}=this.instance.getSelectedRangeLast().highlight,{rowIndexMapper:o,columnIndexMapper:i}=this.instance,s=o.isHidden(this.instance.toPhysicalRow(t))||i.isHidden(this.instance.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!e||s)}moveSelectionAfterEnter(e){const t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}onAfterDocumentKeyDown(e){if(!this.instance.isListening())return;const{keyCode:t}=e;if(!this.selection.isSelected())return;const n=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!(Fc(t)||Bc(t)||n||this.isEditorOpened())){const t=this.instance.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>ia(this.instance.getSelected()),group:wu};t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],n),this.openEditor("",e)}}onCellDblClick(e,t,n){"TD"===n.nodeName&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const vu=new WeakMap;yu.getInstance=function(e,t,n){let o=vu.get(e);return o||(o=new yu(e,t,n),vu.set(e,o)),o};var bu=yu;const Su={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Ru=new RegExp(Object.keys(Su).map((e=>`(${e})`)).join("|"),"gi");function Eu(e){const t=e.hasColHeaders(),n=e.hasRowHeaders(),o=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData(...o),s=i.length,r=s>0?i[0].length:0,l=["<table>","</table>"],a=t?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=n?1:0,u=t?1:0;for(let o=0;o<s;o+=1){const s=t&&0===o,l=[];for(let t=0;t<r;t+=1){const r=!s&&n&&0===t;let a="";if(s)a=`<th>${e.getColHeader(t-c)}</th>`;else if(r)a=`<th>${e.getRowHeader(o-u)}</th>`;else{const n=i[o][t],{hidden:s,rowspan:r,colspan:l}=e.getCellMeta(o-u,t-c);if(!s){const e=[];if(r&&e.push(`rowspan="${r}"`),l&&e.push(`colspan="${l}"`),ra(n))a=`<td ${e.join(" ")}></td>`;else{const t=n.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a=`<td ${e.join(" ")}>${t}</td>`}}}l.push(a)}const d=["<tr>",...l,"</tr>"].join("");s?a.splice(1,0,d):h.splice(-1,0,d)}return l.splice(1,0,a.join(""),h.join("")),l.join("")}function Mu(e){const t=e.length,n=["<table>"];for(let o=0;o<t;o+=1){const i=e[o],s=i.length,r=[];0===o&&n.push("<tbody>");for(let e=0;e<s;e+=1){const t=i[e],n=ra(t)?"":t.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`)).replace(/\t/gi,"&#9;");r.push(`<td>${n}</td>`)}n.push("<tr>",...r,"</tr>"),o+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function Tu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const n={},o=t.createDocumentFragment(),i=t.createElement("div");o.appendChild(i);let s=e;if("string"==typeof s){const e=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(e=>{const t=e.match(/<td\b[^>]*?>/g)[0];return`${t}${e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"")}</td>`}));i.insertAdjacentHTML("afterbegin",`${e}`),s=i.querySelector("table")}if(!s||!function(e){return"TABLE"===(e&&e.nodeName||"")}(s))return;const r=i.querySelector('meta[name$="enerator"]'),l=null!==s.querySelector("tbody th"),a=s.querySelector("tr"),h=a?Array.from(a.cells).reduce(((e,t)=>e+t.colSpan),0)-(l?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],u=[];let d=!1,g=0,f=0;if(s.tHead){const e=Array.from(s.tHead.rows).filter((e=>{const t=null!==e.querySelector("td");return t&&u.push(e),!t}));g=e.length,d=g>0,g>1?n.nestedHeaders=Array.from(e).reduce(((e,t)=>{const n=Array.from(t.cells).reduce(((e,t,n)=>{if(l&&0===n)return e;const{colSpan:o,innerHTML:i}=t,s=o>1?{label:i,colspan:o}:i;return e.push(s),e}),[]);return e.push(n),e}),[]):d&&(n.colHeaders=Array.from(e[0].children).reduce(((e,t,n)=>(l&&0===n||e.push(t.innerHTML),e)),[]))}u.length&&(n.fixedRowsTop=u.length),c.length&&(n.fixedRowsBottom=c.length);const m=[...u,...Array.from(s.tBodies).reduce(((e,t)=>(e.push(...Array.from(t.rows)),e)),[]),...c];f=m.length;const p=new Array(f);for(let e=0;e<f;e++)p[e]=new Array(h);const w=[],C=[];for(let e=0;e<f;e++){const t=m[e],n=Array.from(t.cells),o=n.length;for(let t=0;t<o;t++){const o=n[t],{nodeName:i,innerHTML:s,rowSpan:l,colSpan:a}=o,h=p[e].findIndex((e=>void 0===e));if("TD"===i){if(l>1||a>1){for(let t=e;t<e+l;t++)if(t<f)for(let e=h;e<h+a;e++)p[t][e]=null;const t=o.getAttribute("style");t&&t.includes("mso-ignore:colspan")||w.push({col:h,row:e,rowspan:l,colspan:a})}let t="";t=r&&/excel/gi.test(r.content)?s.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):s.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),p[e][h]=t.replace(Ru,(e=>Su[e]))}else C.push(s)}}return w.length&&(n.mergeCells=w),C.length&&(n.rowHeaders=C),p.length&&(n.data=p),n}var xu=Object.freeze({__proto__:null,_dataToHTML:Mu,htmlToGridSettings:Tu,instanceToHTML:Eu});function Ou(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=typeof e;if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);const n=Array.from(new Set([".",...t])).map((e=>`\\${e}`)).join("|");return new RegExp(`^[+-]?\\s*(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}return"object"===n&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function Au(e){return Ou(e,[","])}function _u(e,t,n){let o=-1;for("function"==typeof t?(n=t,t=e):o=e-1;++o<=t&&!1!==n(o););}function Iu(e,t,n){let o=e+1;for("function"==typeof t&&(n=t,t=0);--o>=t&&!1!==n(o););}function ku(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}var Hu=Object.freeze({__proto__:null,isNumeric:Ou,isNumericLike:Au,rangeEach:_u,rangeEachReverse:Iu,valueAccordingPercent:ku});const Du="asc",Nu=new Map([[Du,[-1,1]],["desc",[1,-1]]]),Pu=e=>`The priority '${e}' is already declared in a map.`,Lu=e=>`The priority '${e}' is not a number.`;const Vu=e=>`The id '${e}' is already declared in a map.`;function Fu(){let{errorIdExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map;function n(){return[...t]}function o(e){return t.has(e)}return e=vh(e)?e:Vu,{addItem:function(n,i){if(o(n))throw new Error(e(n));t.set(n,i)},clear:function(){t.clear()},getId:function(e){const[t]=n().find((t=>{let[n,o]=t;return e===o&&n}))||[null];return t},getItem:function(e){return t.get(e)},getItems:n,hasItem:o,removeItem:function(e){return t.delete(e)}}}const Bu=e=>`'${e}' value is already declared in a unique set.`;const Wu=e=>`There is already registered "${e}" plugin.`,Uu=function(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Map;return e=vh(e)?e:Pu,t=vh(t)?t:Lu,{addItem:function(o,i){if(!Ou(o))throw new Error(t(o));if(n.has(o))throw new Error(e(o));n.set(o,i)},getItems:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Du;const[t,o]=Nu.get(e)||Nu.get(Du);return[...n].sort(((e,n)=>e[0]<n[0]?t:o)).map((e=>e[1]))}}}({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),ju=function(){let{errorItemExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Set;return e=vh(e)?e:Bu,{addItem:function(n){if(t.has(n))throw new Error(e(n));t.add(n)},clear:function(){t.clear()},getItems:function(){return[...t]}}}({errorItemExists:Wu}),zu=Fu({errorIdExists:Wu});function Yu(){return[...Uu.getItems(),...ju.getItems()]}function $u(e){const t=ya(e);return zu.getItem(t)}function Gu(e,t,n){[e,t,n]=function(e,t,n){"function"==typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),void 0===$u(e)&&function(e,t,n){const o=ya(e);if(zu.hasItem(o))throw new Error(Wu(o));void 0===n?ju.addItem(o):Uu.addItem(n,o);zu.addItem(o,t)}(e,t,n)}const{register:Ku,getItem:qu,hasItem:Xu,getNames:Zu,getValues:Ju}=iu("renderers");function Qu(e){if("function"==typeof e)return e;if(!Xu(e))throw Error(`No registered renderer found under "${e}" name`);return qu(e)}function ed(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),Ku(e,t)}const{register:td,getItem:nd,hasItem:od,getNames:id,getValues:sd}=iu("validators");function rd(e){if("function"==typeof e)return e;if(!od(e))throw Error(`No registered validator found under "${e}" name`);return nd(e)}function ld(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),td(e,t)}var ad={},hd=Mo,cd=To,ud=Object.keys||function(e){return hd(e,cd)},dd=d,gd=Ht,fd=kt,md=Lt,pd=z,wd=ud;ad.f=dd&&!gd?Object.defineProperties:function(e,t){md(e);for(var n,o=pd(t),i=wd(t),s=i.length,r=0;s>r;)fd.f(e,n=i[r++],o[n]);return e};var Cd,yd=Lt,vd=ad,bd=To,Sd=yn,Rd=Bs,Ed=vt,Md="prototype",Td="script",xd=Cn("IE_PROTO"),Od=function(){},Ad=function(e){return"<"+Td+">"+e+"</"+Td+">"},_d=function(e){e.write(Ad("")),e.close();var t=e.parentWindow.Object;return e=null,t},Id=function(){try{Cd=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;Id="undefined"!=typeof document?document.domain&&Cd?_d(Cd):(t=Ed("iframe"),n="java"+Td+":",t.style.display="none",Rd.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(Ad("document.F=Object")),e.close(),e.F):_d(Cd);for(var o=bd.length;o--;)delete Id[Md][bd[o]];return Id()};Sd[xd]=!0;var kd=rt,Hd=Object.create||function(e,t){var n;return null!==e?(Od[Md]=yd(e),n=new Od,Od[Md]=null,n[xd]=e):n=Id(),void 0===t?n:vd.f(n,t)},Dd=kt.f,Nd=kd("unscopables"),Pd=Array.prototype;void 0===Pd[Nd]&&Dd(Pd,Nd,{configurable:!0,value:Hd(null)});var Ld=je,Vd=fo,Fd=ro,Bd=function(e){Pd[Nd][e]=!0};oi({target:"Array",proto:!0},{at:function(e){var t=Ld(this),n=Vd(t),o=Fd(e),i=o>=0?o:n+o;return i<0||i>=n?void 0:t[i]}}),Bd("at");const Wd=new WeakMap;class Ud{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:n,itemSizeFn:o,overrideFn:i,calculationType:s,stretchMode:r,stretchingItemWidthFn:l=e=>e,inlineStartOffset:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Wd.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:n,columnWidthFn:o,overrideFn:i,calculationType:s,stretchingColumnWidthFn:l,inlineStartOffset:a}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=r,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let e=0,t=!0;const n=[];let o,i=0,s=0;const r=Wd.get(this),l=r.calculationType,a=r.overrideFn,h=r.scrollOffset,c=Math.max(r.scrollOffset,0),u=r.totalColumns,d=r.viewportWidth,g=c>0?d+1:d;for(let r=0;r<u;r++)if(o=this._getColumnWidth(r),e<=c&&2!==l&&(this.startColumn=r,i=o),e>=c&&e+(2===l?o:0)<=c+g&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=r,i=o),this.endColumn=r),n.push(e),e+=o,s=o,2!==l&&(this.endColumn=r),e>=c+d){t=!1;break}const f=2===l?0:s,m=2===l?i:0;if(h+d-g<-1*r.inlineStartOffset||h>n.at(-1)+f||-1*r.scrollOffset-r.viewportWidth>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===u-1&&t)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=n[this.endColumn]+o-n[this.startColumn-1];if((e<=d||2!==l)&&(this.startColumn-=1),e>d)break}1===l&&null!==this.startColumn&&a&&a(this),this.startPosition=n[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),u<this.endColumn&&(this.endColumn=u-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if("none"===this.stretch)return;let t=e;this.totalTargetWidth=t;const n=Wd.get(this),o=n.totalColumns;let i=0;for(let e=0;e<o;e++){const o=this._getColumnWidth(e),s=n.stretchingColumnWidthFn(void 0,e);"number"==typeof s?t-=s:i+=o}const s=t-i;if("all"===this.stretch&&s>0)this.stretchAllRatio=t/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){const e=this._getColumnWidth(o-1),t=s+e;this.stretchLastWidth=t>=0?t:e}}getStretchedColumnWidth(e,t){let n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}_getStretchedAllColumnWidth(e,t){let n=0;const o=Wd.get(this),i=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){const n=Math.round(t*this.stretchAllRatio),i=o.stretchingColumnWidthFn(n,e);this.stretchAllColumnsWidth[e]=void 0===i?n:isNaN(i)?this._getColumnWidth(e):i}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let e=0;e<this.stretchAllColumnsWidth.length;e++)n+=this.stretchAllColumnsWidth[e];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===Wd.get(this).totalColumns-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=Wd.get(this).columnWidthFn(e);return isNaN(t)&&(t=Ud.DEFAULT_WIDTH),t}}var jd=Ud;const zd=new WeakMap;class Yd{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:n,itemSizeFn:o,overrideFn:i,calculationType:s,scrollbarHeight:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};zd.set(this,{viewportHeight:e,scrollOffset:t,totalRows:n,rowHeightFn:o,overrideFn:i,calculationType:s,horizontalScrollbarHeight:r}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const e=zd.get(this),t=e.calculationType,n=e.overrideFn,o=e.rowHeightFn,i=e.scrollOffset,s=Math.max(e.scrollOffset,0),r=e.totalRows,l=e.viewportHeight,a=e.horizontalScrollbarHeight||0;let h=0,c=!0;const u=[];let d,g=0,f=0;for(let e=0;e<r;e++)if(d=o(e),isNaN(d)&&(d=Yd.DEFAULT_HEIGHT),h<=s&&2!==t&&(this.startRow=e,g=d),h>=s&&h+(2===t?d:0)<=s+l-a&&(null===this.startRow&&(this.startRow=e,g=d),this.endRow=e),u.push(h),h+=d,f=d,2!==t&&(this.endRow=e),h>=s+l-a){c=!1;break}const m=2===t?0:f;if(i+l-a<(2===t?g:0)||i>u.at(-1)+m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===r-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const e=u[this.endRow]+d-u[this.startRow-1];if((e<=l-a||2!==t)&&(this.startRow-=1),e>=l-a)break}1===t&&null!==this.startRow&&n&&n(this),this.startPosition=u[this.startRow],void 0===this.startPosition&&(this.startPosition=null),r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}var $d=Yd;function Gd(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Kd(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qd(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Zd(e,t,"get"))}function Xd(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Zd(e,t,"set"),n),n}function Zd(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Jd=new WeakMap;class Qd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Kd(this,"row",null),Kd(this,"col",null),Gd(this,Jd,{writable:!0,value:!1}),Xd(this,Jd,n),void 0!==e&&void 0!==t&&(this.row=e,this.col=t)}isValid(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isSouthEastOf(e){return this.row>=e.row&&(qd(this,Jd)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(qd(this,Jd)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(qd(this,Jd)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(qd(this,Jd)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}clone(){return new Qd(this.row,this.col,qd(this,Jd))}toObject(){return{row:this.row,col:this.col}}}var eg=Qd;function tg(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function ng(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function og(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,sg(e,t,"get"))}function ig(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,sg(e,t,"set"),n),n}function sg(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var rg=new WeakMap;class lg{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ng(this,"highlight",null),ng(this,"from",null),ng(this,"to",null),tg(this,rg,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=t.clone(),this.to=n.clone(),ig(this,rg,o)}setHighlight(e){return this.highlight=e.clone().normalize(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:n}=e,o=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return o.row<=t&&i.row>=t&&o.col<=n&&i.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=this.getDirection(),i=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),r=Math.min(t.row,i.row),l=Math.min(t.col,i.col),a=Math.max(n.row,s.row),h=Math.max(n.col,s.col),c=this._createCellCoords(r,l),u=this._createCellCoords(a,h);return this.from=c,this.to=u,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return og(this,rg)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return og(this,rg)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return og(this,rg)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return og(this,rg)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return og(this,rg)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return og(this,rg)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return og(this,rg)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return og(this,rg)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col))))||(e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner()))}getOppositeCorner(e,t){if(!(e instanceof eg))return!1;if(t){const{from:n,to:o}=t;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}return e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),o=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),s=Math.min(e.from.row,e.to.row),r=Math.max(e.from.row,e.to.row),l=Math.min(e.from.col,e.to.col),a=Math.max(e.from.col,e.to.col),h=[];return t===s&&h.push("top"),i===a&&h.push("right"),n===r&&h.push("bottom"),o===l&&h.push("left"),h}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let o=e.row;o<=t.row;o++)for(let i=e.col;i<=t.col;i++)this.from.row===o&&this.from.col===i||this.to.row===o&&this.to.col===i||n.push(this._createCellCoords(o,i));return n}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let o=e.row;o<=t.row;o++)for(let i=e.col;i<=t.col;i++)e.row===o&&e.col===i?n.push(e):t.row===o&&t.col===i?n.push(t):n.push(this._createCellCoords(o,i));return n}forAll(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let o=t.row;o<=n.row;o++)for(let i=t.col;i<=n.col;i++){if(!1===e(o,i))return}}clone(){return new lg(this.highlight,this.from,this.to,og(this,rg))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new eg(e,t,og(this,rg))}}var ag=lg;function hg(e){return window.requestAnimationFrame(e)}function cg(e){window.cancelAnimationFrame(e)}function ug(){return"ontouchstart"in window}let dg;function gg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dg||(dg="object"==typeof Intl?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?(e,t)=>`${e}`.localeCompare(t):(e,t)=>e===t?0:e>t?-1:1,dg)}var fg=Object.freeze({__proto__:null,cancelAnimationFrame:cg,getComparisonFunction:gg,isTouchSupported:ug,requestAnimationFrame:hg});const mg=new WeakMap;var pg=class{constructor(e,t,n,o,i,s){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.wtSettings=n,this.domBindings=t,this.wtTable=i,this.selections=s,this.parent=r,this.eventManager=o,this.facadeGetter=e,mg.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(e=>this.onContextMenu(e))),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(e=>this.onMouseOver(e))),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(e=>this.onMouseOut(e)));const e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",(e=>this.onTouchStart(e))),this.eventManager.addEventListener(this.wtTable.holder,"touchend",(e=>this.onTouchEnd(e))),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))},t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",(e=>this.onMouseUp(e))),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",(e=>this.onMouseDown(e)))};_c()?e():(ug()&&e(),t())}selectedCellWasTouched(e){const t=mg.get(this),n=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&n){const[e,o]=[n.row,t.selectedCellBeforeTouchEnd.from.row],[i,s]=[n.col,t.selectedCellBeforeTouchEnd.from.col];return e===o&&i===s}return!1}parentCell(e){const t={},n=_a(e,["TD","TH"],this.wtTable.TABLE);return n?(t.coords=this.wtTable.getCoords(n),t.TD=n):Na(e,"wtBorder")&&Na(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Na(e,"wtBorder")&&Na(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}onMouseDown(e){const t=mg.get(this),n=this.domBindings.rootDocument.activeElement,o=Rh(Ta,e.target),i=e.target;if(i===n||o(0)===n||o(1)===n)return;const s=this.parentCell(i);Na(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,i):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(0===e.button||this.touchApplied)&&s.TD&&(t.dblClickOrigin[0]=s.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((()=>{t.dblClickOrigin[0]=null}),1e3))}onContextMenu(e){if(this.wtSettings.has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!this.wtSettings.has("onCellMouseOver"))return;const t=this.wtTable.TABLE,n=_a(e.target,["TD","TH"],t),o=this.parent||this;n&&n!==o.lastMouseOver&&Ia(n,t)&&(o.lastMouseOver=n,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(n),n))}onMouseOut(e){if(!this.wtSettings.has("onCellMouseOut"))return;const t=this.wtTable.TABLE,n=_a(e.target,["TD","TH"],t),o=_a(e.relatedTarget,["TD","TH"],t),i=this.parent||this;n&&n!==o&&Ia(n,t)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(n),n),null===o&&(i.lastMouseOver=null))}onMouseUp(e){const t=mg.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),(0===e.button||this.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?(Na(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((()=>{t.dblClickOrigin[1]=null}),500)))}onTouchStart(e){mg.get(this).selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,o=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,i=ia(o)&&o.row>=0&&o.col>=0;if(e.cancelable&&i&&this.wtSettings.getSetting("isDataViewInstance")){const t=["A","BUTTON","INPUT"];Ic()&&(Tc()||Oc())&&this.selectedCellWasTouched(n)&&!t.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,o){const i=this.wtSettings.getSettingPure(e);i&&i(t,n,o,this.facadeGetter())}destroy(){const e=mg.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}};var wg=class{constructor(e,t,n){this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}};var Cg=class{constructor(e,t,n){this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}};class yg{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}class vg{constructor(){this.size=new yg,this.workingSpace=0,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof yg}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}class bg{constructor(e,t,n){this.rootNode=e,this.nodesPool=t,this.sizeSet=new vg,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let n=0;if(this.isSharedViewSet()){let o=e.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(1))break;o=o.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,n=this.isSharedViewSet(),{nextSize:o}=t.getViewSize();let i=this.getRenderedChildCount();for(;i<o;){const o=this.nodesPool();!n||n&&t.isPlaceOn(2)?e.appendChild(o):e.insertBefore(o,e.firstChild),i+=1}const s=n&&t.isPlaceOn(1);for(;i>o;)e.removeChild(s?e.firstChild:e.lastChild),i-=1}render(){const{rootNode:e,sizeSet:t}=this;let n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(n+=t.sharedSize.nextSize);let o=e.childNodes[n];if(o.tagName!==this.childNodeType){const t=this.nodesPool();e.replaceChild(t,o),o=t}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class Sg extends bg{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class Rg{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}class Eg{constructor(e,t){this.nodesPool="string"==typeof e?new Rg(e):null,this.nodeType=e,this.rootNode=t,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}class Mg extends Eg{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Sg(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:o,cells:i}=this.table;for(let s=0;s<e;s++){const e=this.table.renderedRowToSource(s),r=o.getRenderedNode(s);this.sourceRowIndex=e;const l=this.obtainOrderView(r),a=i.obtainOrderView(r);l.appendView(a).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<n;o++){l.render();const n=l.getCurrentNode();n.className="",n.removeAttribute("style"),t[o](e,n,o)}l.end()}}}class Tg extends Eg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:o}=this.table,i=o+t;for(let t=0,o=e;t<o;t++){for(n=this.rootNode.childNodes[t],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let t=e;t<s;t++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Fa(n)}render(){const{columnHeadersCount:e}=this.table;for(let t=0;t<e;t+=1){const{columnHeaderFunctions:e,columnsToRender:n,rowHeadersCount:o}=this.table,i=this.rootNode.childNodes[t];for(let s=-1*o;s<n;s+=1){const n=this.table.renderedColumnToSource(s),r=i.childNodes[s+o];r.className="",r.removeAttribute("style"),e[t](n,r,t)}}}}class xg extends Eg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;for(let e=0;e<t;e++){const t=this.table.renderedColumnToSource(e),n=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[e].style.width=`${n}px`}for(let n=0;n<e;n++){const e=this.table.renderedColumnToSource(n),o=this.table.columnUtils.getStretchedColumnWidth(e);this.rootNode.childNodes[n+t].style.width=`${o}px`}const n=this.rootNode.firstChild;n&&Pa(n,"rowHeader")}}let Og=!1;class Ag extends Eg{constructor(e){super("TR",e),this.orderView=new bg(e,(e=>this.nodesPool.obtain(e)),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!Og&&e>1e3&&(Og=!0,Kc(na`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let t=0;t<e;t++)this.orderView.render();this.orderView.end()}}class _g extends Eg{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Sg(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:o}=this.table;for(let i=0;i<e;i++){const e=this.table.renderedRowToSource(i),s=n.getRenderedNode(i);this.sourceRowIndex=e;const r=this.obtainOrderView(s),l=o.obtainOrderView(s);r.prependView(l).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<t;n++){r.render();const t=r.getCurrentNode(),o=this.table.renderedColumnToSource(n);Na(t,"hide")||(t.className=""),t.removeAttribute("style"),t.removeAttribute("dir"),this.table.cellRenderer(e,o,t)}r.end()}}}class Ig{constructor(e){let{cellRenderer:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:o,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=o,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const e=t.getRenderedNode(n);if(e.firstChild){const t=this.renderedRowToSource(n),o=this.rowUtils.getHeight(t);e.firstChild.style.height=o?o-1+"px":""}}}}class kg{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:o,rowUtils:i,columnUtils:s,cellRenderer:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new Ig(e,{cellRenderer:r}),this.renderer.setRenderers({rowHeaders:new Mg,columnHeaders:new Tg(t),colGroup:new xg(n),rows:new Ag(o),cells:new _g}),this.renderer.setAxisUtils(i,s)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class Hg{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const t=this.dataAccessObject.wtViewport.columnsRenderCalculator;let n=this.getWidth(e);if(t){const o=t.getStretchedColumnWidth(e,n);o&&(n=o)}return n}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:t,wtViewport:n,cloneSource:o}=this.dataAccessObject,i=o?o.wtTable.holder:t.holder,s=i.offsetHeight<i.scrollHeight?hh():0;let r=e.getSetting("rowHeaderWidth");if(n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-s),r=e.getSetting("onModifyRowHeaderWidth",r),null!=r){const t=e.getSetting("rowHeaders").length,n=e.getSetting("defaultColumnWidth");for(let e=0;e<t;e++){let t=Array.isArray(r)?r[e]:r;t=null==t?n:t,this.headerWidths.set(e,t)}}}}class Dg{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}function Ng(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pg=class{constructor(e,t,n,o,i){Ng(this,"wtSettings",null),Ng(this,"domBindings",void 0),Ng(this,"TBODY",null),Ng(this,"THEAD",null),Ng(this,"COLGROUP",null),Ng(this,"hasTableHeight",!0),Ng(this,"hasTableWidth",!0),Ng(this,"isTableVisible",!1),Ng(this,"tableOffset",0),Ng(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Va(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(s))),this.rowUtils=new Dg(this.dataAccessObject,this.wtSettings),this.columnUtils=new Hg(this.dataAccessObject,this.wtSettings),this.tableRenderer=new kg({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&Na(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",n}createHider(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&Na(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),n}createHolder(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&Na(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),n.appendChild(e)),n}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,{wtOverlays:n,wtViewport:o}=this.dataAccessObject,i=t.getSetting("totalRows"),s=t.getSetting("totalColumns"),r=t.getSetting("rowHeaders"),l=r.length,a=t.getSetting("columnHeaders"),h=a.length;let c=!1,u=e;if(this.isMaster&&(this.holderOffset=za(this.holder),u=o.createRenderCalculators(u),l&&!t.getSetting("fixedColumnsStart"))){const e=n.inlineStartOverlay.getScrollPosition(),t=this.correctHeaderWidth;this.correctHeaderWidth=0!==e,t!==this.correctHeaderWidth&&(u=!1)}if(this.isMaster&&(c=n.updateStateOfRendering()),u)this.isMaster&&o.createVisibleCalculators(),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=za(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const e=i>0?this.getFirstRenderedRow():0,t=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Cg(e,i,h),this.columnFilter=new wg(t,s,l);let n=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const e={};this.wtSettings.getSetting("beforeDraw",!0,e),n=!0!==e.skipRender}if(n){let e;if(this.tableRenderer.setHeaderContentRenderers(r,a),(this.is(zg)||this.is(Gg))&&this.tableRenderer.setHeaderContentRenderers(r,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(e=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(zg))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const t=Qa(this.hider),n=Qa(this.TABLE);0!==t&&n!==t&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),e!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(zg)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.refreshSelections(u),c&&n.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const o=this.wtSettings.getSetting("defaultRowHeight");let i,s,r;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),s=this.getColumnHeader(t,n),s&&(r=th(s),(!i&&o<r||i<r)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=r),Array.isArray(l)?null!==l[n]&&void 0!==l[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let o=0,i=e.getSetting("columnHeaders").length;o<i;o++)if(n[o]){if(!t[o]||0===t[o].childNodes.length)return;t[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(zg))&&!e.getSetting("externalRowCalculator")){const e=this.getRenderedRowsCount();for(let n=0;n<e;n++){const e=this.rowFilter.renderedToSource(n);t.oversizedRows&&t.oversizedRows[e]&&(t.oversizedRows[e]=void 0)}}}removeClassFromCells(e){const t=this.TABLE.querySelectorAll(`.${e}`);for(let n=0,o=t.length;n<o;n++)La(t[n],e)}refreshSelections(e){const{wtSettings:t}=this,{selections:n}=this.dataAccessObject;if(!n)return;const o=Array.from(n),i=o.length;if(e){const e=[];for(let t=0;t<i;t++){const{highlightHeaderClassName:n,highlightRowClassName:i,highlightColumnClassName:s}=o[t].settings,r=o[t].classNames,l=r.length;for(let t=0;t<l;t++)e.includes(r[t])||e.push(r[t]);n&&!e.includes(n)&&e.push(n),i&&!e.includes(i)&&e.push(i),s&&!e.includes(s)&&e.push(s)}const n=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(n))for(let t=0;t<n.length;t++)e.push(n[t]);const s=e.length;for(let t=0;t<s;t++)this.removeClassFromCells(e[t])}for(let t=0;t<i;t++)o[t].draw(this.facadeGetter(),e)}getCell(e){let t=e.row,n=e.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",t,n);if(o&&Array.isArray(o)&&([t,n]=o),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const s=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let t=null,n=null;var o,i;e<0?(t=null===(o=this.rowFilter)||void 0===o?void 0:o.sourceRowToVisibleColHeadedRow(e),n=this.THEAD):(t=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(e),n=this.TBODY);return void 0!==t&&void 0!==n&&(!(n.childNodes.length<t+1)&&n.childNodes[t])}getColumnHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.THEAD.childNodes[t];return null==n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((e=>{const o=e.childNodes[n];o&&t.push(o)})),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return null==n?void 0:n.childNodes[t]}getRowHeaders(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<n;o++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null==n?void 0:n.childNodes[o];i&&t.push(i)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Aa(t,["TD","TH"])),null===t)return null;const n=t.parentNode,o=n.parentNode;let i=ka(n),s=t.cellIndex;if(Ha($g,t,this.wtRootElement)||Ha(jg,t,this.wtRootElement))"THEAD"===o.nodeName&&(i-=o.childNodes.length);else if(Ha(Gg,t,this.wtRootElement)||Ha(zg,t,this.wtRootElement)){i=this.wtSettings.getSetting("totalRows")-o.childNodes.length+i}else i=o===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i);return s=Ha($g,t,this.wtRootElement)||Ha(Yg,t,this.wtRootElement)||Ha(Gg,t,this.wtRootElement)?this.columnFilter.offsettedTH(s):this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(i,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;let t,n,o,i,s;if(e*this.wtSettings.getSetting("defaultRowHeight")!==th(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),t=this.getRowHeight(o),i=this.getTrForRow(o),s=i.querySelector("th"),n=s?th(s):th(i)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<n||t<n)&&(n+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=n)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}isRowHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Qa(this.TABLE)}getHeight(){return eh(this.TABLE)}getTotalWidth(){const e=Qa(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){const e=eh(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return ja(this.TABLE)}_modifyRowHeaderWidth(e){let t=vh(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}};const Lg={getFirstRenderedRow(){const e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};dc(Lg,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var Vg=Lg;const Fg={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};dc(Fg,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});var Bg=Fg;class Wg extends Pg{constructor(e,t,n,o){super(e,t,n,o,Gg)}}hc(Wg,Vg),hc(Wg,Bg);var Ug=Wg;const jg="top",zg="bottom",Yg="inline_start",$g="top_inline_start_corner",Gg="bottom_inline_start_corner",Kg=[jg,zg,Yg,$g,Gg],qg=new Map([[jg,`ht_clone_${jg}`],[zg,`ht_clone_${zg}`],[Yg,`ht_clone_${Yg} ht_clone_left`],[$g,`ht_clone_${$g} ht_clone_top_left_corner`],[Gg,`ht_clone_${Gg} ht_clone_bottom_left_corner`]]);function Xg(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zg=class{constructor(e){Xg(this,"dataAccessObject",void 0),Xg(this,"lastScrolledColumnPos",-1),Xg(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,n,o,i){const s=this.scrollViewportHorizontally(e.col,n,i),r=this.scrollViewportVertically(e.row,t,o);return s||r}scrollViewportHorizontally(e,t,n){const{drawn:o,totalColumns:i}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;const s=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn(),l=void 0===t&&void 0===n,{fixedColumnsStart:a,inlineStartOverlay:h}=this.dataAccessObject;if(l&&e<a)return!1;let c=!1;return-1===s?c=h.scrollTo(e,l?e>this.lastScrolledColumnPos:t):(l&&(e<s||e>r)||!l)&&(c=h.scrollTo(e,l?e>r:t)),c&&(this.lastScrolledColumnPos=e),c}scrollViewportVertically(e,t,n){const{drawn:o,totalRows:i}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;const s=this.getFirstVisibleRow(),r=this.getLastVisibleRow(),l=void 0===t&&void 0===n,{fixedRowsBottom:a,fixedRowsTop:h,topOverlay:c}=this.dataAccessObject;if(l&&(e<h||e>i-a-1))return!1;let u=!1;return-1===s?u=c.scrollTo(e,l?e>this.lastScrolledRowPos:n):(l&&(e<s||e>r)||!l)&&(u=c.scrollTo(e,l?e>r:n)),u&&(this.lastScrolledRowPos=e),u}getFirstVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:n,totalRows:o,fixedRowsTop:i,rootWindow:s}=this.dataAccessObject;let r=t.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=za(t.wtRootElement),a=th(t.hider),h=th(s),c=Ga(s,s);if(l.top+a-h<=c){let t=n.getColumnHeaderHeight();t+=e.sumCellSizes(0,i);for(let n=o;n>0;n--)if(t+=e.sumCellSizes(n-1,n),l.top+a-t<=c){r=n;break}}}return r}getLastVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:n,totalRows:o,rootWindow:i}=this.dataAccessObject;let s=t.getLastVisibleRow();if(e.mainTableScrollableElement===i){const r=za(t.wtRootElement),l=Ga(i,i);if(r.top>l){const t=th(i);let a=n.getColumnHeaderHeight();for(let n=1;n<=o;n++)if(a+=e.sumCellSizes(n-1,n),r.top+a-l>=t){s=n-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:t,wtViewport:n,totalColumns:o,rootWindow:i}=this.dataAccessObject;let s=t.getFirstVisibleColumn();if(e.mainTableScrollableElement===i){const r=za(t.wtRootElement),l=nh(t.hider),a=nh(i),h=Math.abs(Ka(i,i));if(r.left+l-a<=h){let t=n.getRowHeaderWidth();for(let n=o;n>0;n--)if(t+=e.sumCellSizes(n-1,n),r.left+l-t<=h){s=n;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:t,wtTable:n,wtViewport:o,totalColumns:i,rootWindow:s}=this.dataAccessObject;let r=n.getLastVisibleColumn();if(t.mainTableScrollableElement===s){let l=null;if(e.getSetting("rtlMode")){const e=n.TABLE.getBoundingClientRect(),t=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(e.right-t)}else{l=za(n.wtRootElement).left}const a=Math.abs(Ka(s,s));if(l>a){const e=nh(s);let n=o.getRowHeaderWidth();for(let o=1;o<=i;o++)if(n+=t.sumCellSizes(o-1,o),l+n-a>=e){r=o-2;break}}}return r}};function Jg(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Qg{get eventManager(){return new pu(this)}constructor(e,t){Jg(this,"wtTable",void 0),Jg(this,"wtScroll",void 0),Jg(this,"wtViewport",void 0),Jg(this,"wtOverlays",void 0),Jg(this,"selections",void 0),Jg(this,"wtEvent",void 0),Jg(this,"guid",`wt_${va()}`),Jg(this,"drawInterrupted",!1),Jg(this,"drawn",!1),Jg(this,"domBindings",void 0),Jg(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new Zg(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){Ua(n,e[t])}])}}createCellCoords(e,t){return new eg(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new ag(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);const t=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n,o,i){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,o,i)}scrollViewportHorizontally(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}function ef(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tf extends Qg{constructor(e,t,n){super(e,t),ef(this,"cloneSource",void 0),ef(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selections=n.selections,this.wtEvent=new pg(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections,n.event),this.findOriginalHeaders()}}function nf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class of{constructor(e,t,n,o,i){nf(this,"wtSettings",null),dc(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=o;const{TABLE:s,hider:r,spreader:l,holder:a,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=r,this.spreader=l,this.holder=a,this.wtRootElement=h,this.trimmingContainer=Xa(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Xa(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=qa(e.TABLE)}getRelativeCellPosition(e,t,n){if(!1===this.clone.wtTable.holder.contains(e))return void Kc(`The provided element is not a child of the ${this.type} overlay`);const o=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),s=t<this.wtSettings.getSetting("fixedRowsTop"),r=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(e),top:e.offsetTop};let c=null;return c=o?this.getRelativeCellPositionWithinWindow(s,i,h,a):this.getRelativeCellPositionWithinHolder(s,r,i,h,a),c}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,o){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,r=0;if(t){let e=i.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(i.left+i.width+hh())),s=e<=0?-1*e:0}else s=o.start;if(e){r=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top}else r=o.top;return{start:n.start+s,top:n.top+r}}getRelativeCellPositionWithinHolder(e,t,n,o,i){const s=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),r=this.wot.wtOverlays.topOverlay.getScrollPosition();let l=0,a=0;if(n||(l=s-i.start),t){const e=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+e.top}else e||(a=r-i.top);return{start:o.start-l,top:o.top-a}}makeClone(){if(-1===Kg.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,o=t.createElement("DIV"),i=t.createElement("TABLE"),s=e.wtRootElement.parentNode;o.className=`${qg.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,i.className=e.TABLE.className,o.appendChild(i),s.appendChild(o);const r=this.wtSettings.getSetting("preventOverflow");return!0===r||"horizontal"===r&&this.type===jg||"vertical"===r&&this.type===Yg?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=qa(e.TABLE),new tf(i,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;Xl([e.style,t.style,e.parentNode.style],(e=>{e.width="",e.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class sf extends of{constructor(e,t,n,o,i,s){super(e,t,Gg,n,o),this.bottomOverlay=i,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Ug(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${e}px`,t.style.bottom=`${n}px`}else gh(t),this.repositionOverlay();let n=eh(this.clone.wtTable.TABLE);const o=Qa(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height=`${n}px`,t.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=hh(n)),o.style.bottom=`${i}px`}}const rf={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible}};dc(rf,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var lf=rf;class af extends Pg{constructor(e,t,n,o){super(e,t,n,o,zg)}}hc(af,Vg),hc(af,lf);var hf=af;function cf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class uf extends of{constructor(e,t,n,o){super(e,t,zg,n,o),cf(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new hf(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||o&&"vertical"===o?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom=`${n}px`);const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=hh(n)),o.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.mainTableScrollableElement===t?(t.scrollTo($a(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,wtSettings:o}=this.wot,i=o.getSetting("defaultRowHeight");let s=e,r=0;for(;s<t;){const e=n.getRowHeight(s);r+=void 0===e?i:e,s+=1}return r}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:o}=this.domBindings,i=hh(n),s=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===r){let n=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(n-=i),n=Math.min(n,e.wtRootElement.scrollWidth),s.width=`${n}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=eh(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;t&&o.offsetHeight!==o.clientHeight&&(i=hh(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ga(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight(),t=e-this.clone.wtTable.getTotalHeight(),o=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-o+e,0),n>t&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,o=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||0===t)&&o.length>0){const t=this.wot.wtTable.holder.parentNode,n=Na(t,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(Pa(t,"innerBorderBottom"),i=!n):(La(t,"innerBorderBottom"),i=n)}return i}}const df={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible}};dc(df,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var gf=df;class ff extends Pg{constructor(e,t,n,o){super(e,t,n,o,Yg)}}hc(ff,gf),hc(ff,Bg);var mf=ff;class pf extends of{constructor(e,t,n,o){super(e,t,Yg,n,o)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new mf(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==t||o&&"horizontal"===o?(i=this.getScrollPosition(),gh(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),dh(n,`${i}px`,"0px"));const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Ya(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let o=e,i=0;for(;o<t;)i+=this.wot.wtTable.getStretchedColumnWidth(o)||n,o+=1;return i}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,o=hh(t),i=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"vertical"===s){let t=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(t-=o),t=Math.min(t,e.wtRootElement.scrollHeight),i.height=`${t}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const r=Qa(this.clone.wtTable.TABLE);i.width=`${r}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:n}=this.wot,o=this.facadeGetter(),i=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(o).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;if(t){this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1)}return t&&o.offsetWidth!==o.clientWidth&&(i=hh(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=i,this.setScrollPosition(n)}getTableParentOffset(){let e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(Ka(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);n>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?La(t,"emptyRows"):Pa(t,"emptyRows");let i=!1;if(o&&!n.length)Pa(t,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){const n=Na(t,"innerBorderInlineStart");e?(Pa(t,"innerBorderLeft innerBorderInlineStart"),i=!n):(La(t,"innerBorderLeft innerBorderInlineStart"),i=n)}return i}}const wf={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};dc(wf,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var Cf=wf;class yf extends Pg{constructor(e,t,n,o){super(e,t,n,o,$g)}}hc(yf,Cf),hc(yf,Bg);var vf=yf;function bf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Sf extends of{constructor(e,t,n,o,i,s){super(e,t,$g,n,o),bf(this,"topOverlay",void 0),bf(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new vf(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){dh(e,`${this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)}px`,`${this.topOverlay.getOverlayOffset()}px`)}else gh(e);let t=eh(this.clone.wtTable.TABLE);const n=Qa(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${n}px`,!1}}class Rf extends Pg{constructor(e,t,n,o){super(e,t,n,o,jg)}}hc(Rf,Cf),hc(Rf,lf);var Ef=Rf;function Mf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Tf extends of{constructor(e,t,n,o){super(e,t,jg,n,o),Mf(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Ef(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let o=0,i=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)o=this.getScrollPosition(),gh(e);else{const{wtTable:t}=this.wot,n=t.hider.getBoundingClientRect();i=Math.ceil(n.bottom)===e.offsetHeight,o=this.getOverlayOffset(),dh(e,"0px",`${o}px`)}const s=this.adjustHeaderBordersPosition(o,i);return this.adjustElementsSize(),s}setScrollPosition(e){const t=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo($a(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultRowHeight");let o=e,i=0;for(;o<t;){const e=this.wot.wtTable.getRowHeight(o);i+=void 0===e?n:e,o+=1}return i}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,o=hh(t),i=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===s){let t=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(t-=o),t=Math.min(t,e.wtRootElement.scrollWidth),i.width=`${t}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let r=eh(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(r=0),i.height=`${r}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:n}=this.wot,o=this.facadeGetter(),i=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(o).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:o}=this,i=(n.cloneSource?n.cloneSource:n).wtTable.holder;let s=this.getTableParentOffset(),r=0;if(t){this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1)}if(t&&i.offsetHeight!==i.clientHeight&&(r=hh(this.domBindings.rootDocument)),t){const t=o.getSetting("fixedRowsBottom"),i=o.getSetting("totalRows");s+=this.sumCellSizes(0,e+1),s-=n.wtViewport.getViewportHeight()-this.sumCellSizes(i-t,i),s+=1}else s+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);return s+=r,this.setScrollPosition(s)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ga(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>e&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?La(n,"emptyColumns"):Pa(n,"emptyColumns");let o=!1;if(!t){const t=this.wtSettings.getSetting("fixedRowsTop"),i=this.cachedFixedRowsTop!==t,s=this.wtSettings.getSetting("columnHeaders");if((i||0===t)&&s.length>0){const t=Na(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||0===this.wtSettings.getSetting("totalRows")?(Pa(n,"innerBorderTop"),o=!t):(La(n,"innerBorderTop"),o=t)}}return o}}function xf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Of=class{constructor(e,t,n,o,i,s){xf(this,"wot",null),xf(this,"topOverlay",null),xf(this,"bottomOverlay",null),xf(this,"inlineStartOverlay",null),xf(this,"topInlineStartCornerOverlay",null),xf(this,"bottomInlineStartCornerOverlay",null),xf(this,"browserLineHeight",void 0),xf(this,"wtSettings",null),xf(this,"resizeObserver",new ResizeObserver((e=>{hg((()=>{Array.isArray(e)&&e.length&&this.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=e,this.wtSettings=o,this.domBindings=n,this.facadeGetter=t,this.wtTable=s;const{rootDocument:r,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=hh(r);const a="hidden"===l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=a?s.holder:qa(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),o=parseInt(n.lineHeight,10),i=1.2*parseInt(n.fontSize,10);this.browserLineHeight=o||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Tf(...e),this.bottomOverlay=new uf(...e),this.inlineStartOverlay=new pf(...e),this.topInlineStartCornerOverlay=new Sf(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new sf(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",(e=>this.onKeyDown(e))),this.eventManager.addEventListener(e.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(e,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(n,"scroll",(e=>this.onTableScroll(e)),{passive:!0}),n!==o&&this.eventManager.addEventListener(o,"scroll",(e=>this.onTableScroll(e)),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,s=this.scrollableElement===t,r=this.wtSettings.getSetting("preventWheel"),l={passive:s};(r||i||!Mc())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(e=>this.onCloneWheel(e,r)),l);let a;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((e=>{if(e&&e.needFullRender){const{holder:t}=e.clone.wtTable;this.eventManager.addEventListener(t,"wheel",(e=>this.onCloneWheel(e,r)),l)}})),this.eventManager.addEventListener(t,"resize",(()=>{clearTimeout(a),a=setTimeout((()=>{this.wtSettings.getSetting("onWindowResize")}),200)})),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(o!==t&&i!==t&&!e.target.contains(o)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:n}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target,r=i!==n&&s!==n&&!s.contains(i),l=o!==n&&s!==n&&!s.contains(o);if(this.keyPressed&&(r||l))return;const a=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&a)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Wc(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const o=this.scrollVertically(t),i=this.scrollHorizontally(n);return o||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[o,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;const e=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;e&&(e.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=qa(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,o=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),o}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtViewport:t}=this.wot,{wtTable:n}=this,o=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),s=t.getRowHeaderWidth(),r=t.getColumnHeaderHeight(),l=n.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,o)}px`,l.height=`${r+this.topOverlay.sumCellSizes(0,i)+1}px`,this.scrollbarSize>0){const{scrollHeight:e,scrollWidth:t}=n.wtRootElement,{scrollHeight:o,scrollWidth:i}=n.holder;this.hasScrollbarRight=e<o,this.hasScrollbarBottom=t<i,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>t?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>e&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Xl(t,(t=>{t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)})),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE;Xl([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(t=>{t&&(t.clone.wtTable.TABLE.className=e.className)}))}};function Af(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class _f{constructor(e){Af(this,"settings",{}),Af(this,"defaults",Object.freeze(this.getDefaults())),gc(this.defaults,((t,n)=>{if(void 0!==e[n])this.settings[n]=e[n];else{if(void 0===t)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=t}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const o=this.getSetting("data",e,t);Ua(n,null==o?"":o)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}update(e,t){return void 0===t?gc(e,((e,t)=>{this.settings[t]=e})):this.settings[e]=t,this}getSetting(e,t,n,o,i){return"function"==typeof this.settings[e]?this.settings[e](t,n,o,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class If extends Pg{constructor(e,t,n,o){super(e,t,n,o,"master")}alignOverlaysWithTrimmingContainer(){const e=Xa(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const n=e.parentElement,o=Za(e,"height",t),i=Za(e,"overflow",t),s=this.holder.style,{scrollWidth:r,scrollHeight:l}=e;let{width:a,height:h}=e.getBoundingClientRect();if(n&&["auto","hidden","scroll"].includes(i)){const o=e.cloneNode(!1);o.style.overflow="auto",o.style.position="absolute",e.nextElementSibling?n.insertBefore(o,e.nextElementSibling):n.appendChild(o);const i=parseInt(Ja(o,t).height,10);n.removeChild(o),0===i&&(h=0)}h=Math.min(h,l),s.height="auto"===o?"auto":`${h}px`,a=Math.min(a,r),s.width=`${a}px`,s.overflow="",this.hasTableHeight="auto"===s.height||h>0,this.hasTableWidth=a>0}this.isTableVisible=ja(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!t.hasOversizedColumnHeadersMarked[n]){const i=e.getSetting("rowHeaders").length,s=this.getRenderedColumnsCount();for(let e=0;e<o;e++)for(let e=-1*i;e<s;e++)this.markIfOversizedColumnHeader(e);t.hasOversizedColumnHeadersMarked[n]=!0}}}hc(If,gf),hc(If,lf);var kf=If;var Hf=class{constructor(e,t,n,o,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;if(t===this.domBindings.rootWindow)n=e.documentElement.clientHeight;else{n=eh(t)>0&&t.clientHeight>0?t.clientHeight:1/0}return n}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:n}=this.domBindings,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=t.documentElement.offsetWidth,s=e.getSetting("totalColumns"),r=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),a=this.wtTable.TABLE.getBoundingClientRect(),h=i-(l?a.right-i:a.left);let c,u;if(r)return Qa(this.wtTable.wtRootElement);if(c=e.getSetting("freezeOverlays")?Math.min(h,i):Math.min(this.getContainerFillWidth(),h,i),o===n&&s>0&&this.sumColumnWidths(0,s-1)>c)return t.documentElement.clientWidth;if(o!==n&&(u=Za(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),"scroll"===u||"hidden"===u||"auto"===u))return Math.max(c,o.clientWidth);const d=e.getSetting("stretchH");return"none"!==d&&d?c:Math.max(c,Qa(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let n=0,o=e;for(;o<t;)n+=this.wtTable.getColumnWidth(o),o+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}getWorkspaceOffset(){return za(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=eh(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,o=t.length;n<o;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let e=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,o=t.length;n<o;n++)e?(this.rowHeaderWidth+=Qa(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const{wtSettings:t,wtTable:n}=this;let o,i,s;this.rowHeaderWidth=NaN,o=t.getSetting("renderAllRows")&&1===e?1/0:this.getViewportHeight();let r=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),a=t.getSetting("fixedRowsBottom"),h=t.getSetting("totalRows");return l&&r>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),r+=s,o-=s),a&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(h-a,h),o-=s),i=n.holder.clientHeight===n.holder.offsetHeight?0:hh(this.domBindings.rootDocument),new $d({viewportSize:o,scrollOffset:r,totalItems:t.getSetting("totalRows"),itemSizeFn:e=>n.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:i})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const{wtSettings:t,wtTable:n}=this;let o=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=t.getSetting("fixedColumnsStart");if(s&&i>=0){const e=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);i+=e,o-=e}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=hh(this.domBindings.rootDocument)),new jd({viewportSize:o,scrollOffset:i,totalItems:t.getSetting("totalColumns"),itemSizeFn:e=>n.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:(e,n)=>t.getSetting("onBeforeStretchingColumnWidth",e,n),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){const t=this.createRowsCalculator(2),n=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:t,endRow:n,isVisibleInTrimmingContainer:o}=e;if(null===t&&null===n)return!o;const{startRow:i,endRow:s}=this.rowsRenderCalculator;return!(t<i||t===i&&t>0)&&!(n>s||n===s&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:t,endColumn:n,isVisibleInTrimmingContainer:o}=e;if(null===t&&null===n)return!o;const{startColumn:i,endColumn:s}=this.columnsRenderCalculator;return!(t<i||t===i&&t>0)&&!(n>s||n===s&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){gc(this.hasOversizedColumnHeadersMarked,((e,t,n)=>{n[t]=void 0}))}};class Df extends Qg{constructor(e,t){super(e,new _f(t));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new kf(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new Hf(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selections=this.wtSettings.getSetting("selections"),this.wtEvent=new pg(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections),this.wtOverlays=new Of(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e=[],t=[];gc({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((n,o)=>{this.wtSettings.getSetting(o).length&&t.push(n),e.push(n)})),La(this.wtTable.wtRootElement.parentNode,e),Pa(this.wtTable.wtRootElement.parentNode,t)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Nf{constructor(e){e instanceof Qg?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new Nf(e);return()=>t},this._wot=new Df(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selections(){return this._wot.selections}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}scrollViewport(e,t,n,o,i){return this._wot.scrollViewport(e,t,n,o,i)}scrollViewportHorizontally(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,o,i){return this._wot.wtSettings.getSetting(e,t,n,o,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}var Pf=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp()));for(let e=0,t=this.main.childNodes.length;e<t;e++){const t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",(t=>this.onMouseEnter(t,this.main.childNodes[e])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),jc(e);const n=this,o=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(o,"mousemove",(function e(s){var r;((r=s).clientY<Math.floor(i.top)||r.clientY>Math.ceil(i.top+i.height)||r.clientX<Math.floor(i.left)||r.clientX>Math.ceil(i.left+i.width))&&(n.eventManager.removeEventListener(o,"mousemove",e),t.style.display="block")}))}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let i=0;i<5;i++){const s=n[i],r=t.createElement("div");r.className=`wtBorder ${this.settings.className||""}`,this.settings[s]&&this.settings[s].hide&&(r.className+=" hidden"),o=r.style,o.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:e.border.color,o.height=this.settings[s]&&this.settings[s].width?`${this.settings[s].width}px`:`${e.border.width}px`,o.width=this.settings[s]&&this.settings[s].width?`${this.settings[s].width}px`:`${e.border.width}px`,this.main.appendChild(r)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),_c()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let s=i.bordersHolder;s||(s=t.createElement("div"),s.className="htBorders",i.bordersHolder=s,i.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};gc({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},((e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e}));gc({position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"},((e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selections.createOrGetArea();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,n,o,i,s){const r=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:l,topHitArea:a,bottom:h,bottomHitArea:c}=this.selectionHandles.styles,u=parseInt(l.borderWidth,10),d=parseInt(l.width,10),g=parseInt(a.width,10),f=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();l.top=`${parseInt(n-d-1,10)}px`,l[r]=`${parseInt(o-d-1,10)}px`,a.top=`${parseInt(n-g/4*3,10)}px`,a[r]=`${parseInt(o-g/4*3,10)}px`;const p=Math.min(parseInt(o+i,10),f-d-2*u),w=Math.min(parseInt(o+i-g/4,10),f-g-2*u);h[r]=`${p}px`,c[r]=`${w}px`;const C=Math.min(parseInt(n+s,10),m-d-2*u),y=Math.min(parseInt(n+s-g/4,10),m-g-2*u);h.top=`${C}px`,c.top=`${y}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(l.display="block",a.display="block",this.isPartRange(e,t)?(h.display="none",c.display="none"):(h.display="block",c.display="block")):(l.display="none",h.display="none",a.display="none",c.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(l.zIndex="9999",a.zIndex="9999"):(l.zIndex="",a.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:n,rootWindow:o}=this.wot;let i,s,r,l,a,h;const c=t.getRenderedRowsCount();for(let n=0;n<c;n+=1){const o=t.rowFilter.renderedToSource(n);if(o>=e[0]&&o<=e[2]){i=o,a=e[0];break}}for(let n=c-1;n>=0;n-=1){const o=t.rowFilter.renderedToSource(n);if(o>=e[0]&&o<=e[2]){s=o;break}}const u=t.getRenderedColumnsCount();for(let n=0;n<u;n+=1){const o=t.columnFilter.renderedToSource(n);if(o>=e[1]&&o<=e[3]){r=o,h=e[1];break}}for(let n=u-1;n>=0;n-=1){const o=t.columnFilter.renderedToSource(n);if(o>=e[1]&&o<=e[3]){l=o;break}}if(void 0===i||void 0===r)return void this.disappear();let d=t.getCell(this.wot.createCellCoords(i,r));const g=i!==s||r!==l,f=g?t.getCell(this.wot.createCellCoords(s,l)):d,m=za(d),p=g?za(f):m,w=za(t.TABLE),C=Qa(t.TABLE),y=m.top,v=m.left,b=this.wot.wtSettings.getSetting("rtlMode");let S=0,R=0;if(b){const e=Qa(d),t=o.innerWidth-w.left-C;R=v+e-p.left,S=o.innerWidth-v-e-t-1}else R=p.left+Qa(f)-v,S=v-w.left-1;if(this.isEntireColumnSelected(i,s)){const e=this.getDimensionsFromHeader("columns",r,l,a,w);let t=null;e&&([t,S,R]=e),t&&(d=t)}let E=y-w.top-1,M=p.top+eh(f)-y;if(this.isEntireRowSelected(r,l)){const e=this.getDimensionsFromHeader("rows",i,s,h,w);let t=null;e&&([t,E,M]=e),t&&(d=t)}const T=Ja(d,o);parseInt(T.borderTopWidth,10)>0&&(E+=1,M=M>0?M-1:0),parseInt(T[b?"borderRightWidth":"borderLeftWidth"],10)>0&&(S+=1,R=R>0?R-1:0);const x=b?"right":"left";this.topStyle.top=`${E}px`,this.topStyle[x]=`${S}px`,this.topStyle.width=`${R}px`,this.topStyle.display="block",this.startStyle.top=`${E}px`,this.startStyle[x]=`${S}px`,this.startStyle.height=`${M}px`,this.startStyle.display="block";const O=Math.floor(this.settings.border.width/2);this.bottomStyle.top=E+M-O+"px",this.bottomStyle[x]=`${S}px`,this.bottomStyle.width=`${R}px`,this.bottomStyle.display="block",this.endStyle.top=`${E}px`,this.endStyle[x]=S+R-O+"px",this.endStyle.height=`${M+1}px`,this.endStyle.display="block";let A=this.settings.border.cornerVisible;A="function"==typeof A?A(this.settings.layerLevel):A;const _=this.wot.getSetting("onModifyGetCellCoords",s,l);let[I,k]=[s,l];if(_&&Array.isArray(_)&&([,,I,k]=_),_c()||!A||this.isPartRange(I,k))this.cornerStyle.display="none";else{this.cornerStyle.top=E+M+this.cornerCenterPointOffset-1+"px",this.cornerStyle[x]=S+R+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let e=Xa(t.TABLE);const i=e===o;i&&(e=n.documentElement);const r=parseInt(this.cornerDefaultStyle.width,10)/2,a=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const t=i?f.getBoundingClientRect().left:f.offsetLeft;let n=!1,o=0;b?(o=t-parseInt(this.cornerDefaultStyle.width,10)/2,n=o<0):(o=t+Qa(f)+parseInt(this.cornerDefaultStyle.width,10)/2,n=o>=nh(e)),n&&(this.cornerStyle[x]=`${Math.floor(S+R+this.cornerCenterPointOffset-r)}px`,this.cornerStyle[b?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){(i?f.getBoundingClientRect().top:f.offsetTop)+eh(f)+parseInt(this.cornerDefaultStyle.height,10)/2>=th(e)&&(this.cornerStyle.top=`${Math.floor(E+M+this.cornerCenterPointOffset-a)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}_c()&&this.updateMultipleSelectionHandlesPosition(s,l,E,S,R,M)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,o,i){const{wtTable:s}=this.wot,r=s.wtRootElement.parentNode;let l=null,a=null,h=null,c=null,u=null,d=null,g=null,f=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},a=function(){return eh(...arguments)},h="ht__selection--rows",d="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},a=function(){return Qa(...arguments)},h="ht__selection--columns",d="left"}if(r.classList.contains(h)){const e=this.wot.getSetting("columnHeaders").length;if(g=l(t,e-o),f=l(n,e-o),!g||!f)return!1;const s=za(g),r=za(f);return g&&f&&(c=s[d]-i[d]-1,u=r[d]+a(f)-s[d]),[g,c,u]}return!1}changeBorderStyle(e,t){const n=this[e].style,o=t[e];!o||o.hide?Pa(this[e],"hidden"):(Na(this[e],"hidden")&&La(this[e],"hidden"),n.backgroundColor=o.color,"top"!==e&&"bottom"!==e||(n.height=`${o.width}px`),"start"!==e&&"end"!==e||(n.width=`${o.width}px`))}changeBorderToDefaultStyle(e){const t=1,n="#000",o=this[e].style;o.backgroundColor=n,o.width=`${t}px`,o.height=`${t}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?Pa(this[e],"hidden"):La(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",_c()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};var Lf=class{constructor(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}getBorder(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new Pf(e,this.settings)),this.instanceBorders[e.guid]}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}addClassAtCoords(e,t,n,o){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=e.wtTable.getCell(this.settings.createCellCoords(t,n));if("object"==typeof s){let e=o;i&&(e=this.classNameGenerator(s),this.classNames.includes(e)||this.classNames.push(e)),Pa(s,e)}return this}linearClassNameGenerator(e,t){return function n(o){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===i)return e;let s=i>=0?i:t,r=e;s-=1;if(Na(o,0===s?e:`${e}-${s}`)){r=`${e}-${s+1}`}else r=n(o,s);return r}}draw(e){if(this.isEmpty())return void(this.settings.border&&this.getBorder(e).disappear());const t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),o=this.getCorners(),[i,s,r,l]=o,{highlightHeaderClassName:a,highlightColumnClassName:h,highlightRowClassName:c,highlightOnlyClosestHeader:u,selectionType:d}=this.settings,g=void 0===d||["active-header","header"].includes(d);if(g&&null!==s&&null!==l){let t=0;for(let o=0;o<n;o+=1){const n=e.wtTable.columnFilter.renderedToSource(o);if(n>=s&&n<=l){let o=e.wtTable.getColumnHeaders(n);const i=o.length-1;u&&o.length>1&&(o=[o[i]]);for(let r=0;r<o.length;r+=1){const c=[];let g=o[r];a&&c.push(a),h&&c.push(h),r=u?i:r;const f=e.getSetting("onBeforeHighlightingColumnHeader",n,r,{selectionType:d,columnCursor:t,selectionWidth:l-s+1,classNames:c});f!==n&&(g=e.wtTable.getColumnHeader(f,r)),Pa(g,c)}t+=1}}}if(null!==i&&null!==r){let o=0;for(let f=0;f<t;f+=1){const t=e.wtTable.rowFilter.renderedToSource(f);if(g&&t>=i&&t<=r){let n=e.wtTable.getRowHeaders(t);const s=n.length-1;u&&n.length>1&&(n=[n[s]]);for(let l=0;l<n.length;l+=1){const h=[];let g=n[l];a&&h.push(a),c&&h.push(c),l=u?s:l;const f=e.getSetting("onBeforeHighlightingRowHeader",t,l,{selectionType:d,rowCursor:o,selectionHeight:r-i+1,classNames:h});f!==t&&(g=e.wtTable.getRowHeader(f,l)),Pa(g,h)}o+=1}if(null!==s&&null!==l)for(let o=0;o<n;o+=1){const n=e.wtTable.columnFilter.renderedToSource(o);t>=i&&t<=r&&n>=s&&n<=l?this.settings.className&&this.addClassAtCoords(e,t,n,this.settings.className,this.settings.markIntersections):t>=i&&t<=r?c&&this.addClassAtCoords(e,t,n,c):n>=s&&n<=l&&h&&this.addClassAtCoords(e,t,n,h);const a=e.getSetting("onAfterDrawSelection",t,n,this.settings.layerLevel);"string"==typeof a&&this.addClassAtCoords(e,t,n,a)}}}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(e).appear(o)}destroy(){Object.values(this.instanceBorders).forEach((e=>e.destroy()))}};function Vf(e){let{isShiftKey:t,isLeftClick:n,isRightClick:o,coords:i,selection:s,controller:r,cellCoordsFactory:l}=e;const a=s.isSelected()?s.getSelectedRange().current():null,h=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(t&&a)i.row>=0&&i.col>=0&&!r.cell?s.setRangeEnd(i):(h||c)&&i.row>=0&&i.col>=0&&!r.cell?s.setRangeEnd(l(i.row,i.col)):h&&i.row<0&&!r.column?s.setRangeEnd(l(a.to.row,i.col)):c&&i.col<0&&!r.row?s.setRangeEnd(l(i.row,a.to.col)):(!h&&!c&&i.col<0||h&&i.col<0)&&!r.row?s.selectRows(Math.max(a.from.row,0),i.row,i.col):(!h&&!c&&i.row<0||c&&i.row<0)&&!r.column&&s.selectColumns(Math.max(a.from.col,0),i.col,i.row);else{const e=!s.inInSelection(i),t=n||o&&e;i.row<0&&i.col>=0&&!r.column?t&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!r.row?t&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!r.cell?t&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0)}}const Ff=new Map([["mousedown",Vf],["mouseover",function(e){let{isLeftClick:t,coords:n,selection:o,controller:i,cellCoordsFactory:s}=e;if(!t)return;const r=o.isSelectedByRowHeader(),l=o.isSelectedByColumnHeader(),a=o.tableProps.countCols(),h=o.tableProps.countRows();l&&!i.column?o.setRangeEnd(s(h-1,n.col)):r&&!i.row?o.setRangeEnd(s(n.row,a-1)):i.cell||o.setRangeEnd(n)}],["touchstart",Vf]]);function Bf(e,t){let{coords:n,selection:o,controller:i,cellCoordsFactory:s}=t;Ff.get(e.type)({coords:n,selection:o,controller:i,cellCoordsFactory:s,isShiftKey:e.shiftKey,isLeftClick:$c(e)||"touchstart"===e.type,isRightClick:Yc(e)})}const Wf=new WeakMap,Uf=Symbol("rootInstance");function jf(e){return e===Uf}function zf(e){return Wf.has(e)}function Yf(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function $f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gf(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,qf(e,t,"get"))}function Kf(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,qf(e,t,"set"),n),n}function qf(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}const Xf=new WeakMap;var Zf=new WeakMap,Jf=new WeakMap;var Qf=class{constructor(e){$f(this,"instance",void 0),$f(this,"eventManager",void 0),$f(this,"settings",void 0),$f(this,"THEAD",void 0),$f(this,"TBODY",void 0),$f(this,"_wt",void 0),$f(this,"activeWt",void 0),Yf(this,Zf,{writable:!0,value:0}),Yf(this,Jf,{writable:!0,value:0}),$f(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new pu(this.instance),this.settings=this.instance.getSettings(),Xf.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n,o,i){return this._wt.scrollViewport(e,t,n,o,i)}scrollViewportHorizontally(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}createElements(){const e=Xf.get(this),{rootElement:t,rootDocument:n}=this.instance,o=t.getAttribute("style");o&&t.setAttribute("data-originalstyle",o),Pa(t,"handsontable"),e.table=n.createElement("TABLE"),Pa(e.table,"htCore"),this.instance.getSettings().tableClassName&&Pa(e.table,this.instance.getSettings().tableClassName),this.THEAD=n.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){const e=Xf.get(this),{rootElement:t,rootDocument:n,selection:o}=this.instance,i=n.documentElement;this.eventManager.addEventListener(t,"mousedown",(t=>{if(e.selectionMouseDown=!0,!this.isTextSelectionAllowed(t.target)){const{rootWindow:e}=this.instance;rh(e),t.preventDefault(),e.focus()}})),this.eventManager.addEventListener(t,"mouseup",(()=>{e.selectionMouseDown=!1})),this.eventManager.addEventListener(t,"mousemove",(t=>{e.selectionMouseDown&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&rh(this.instance.rootWindow),t.preventDefault())})),this.eventManager.addEventListener(i,"keyup",(e=>{o.isInProgress()&&!e.shiftKey&&o.finish()})),this.eventManager.addEventListener(i,"mouseup",(i=>{o.isInProgress()&&$c(i)&&o.finish(),e.mouseDown=!1,!mh(n.activeElement)&&(o.isSelected()||o.isSelectedByAnyHeader()||t.contains(i.target)||Yc(i))||this.instance.unlisten()})),this.eventManager.addEventListener(i,"contextmenu",(t=>{o.isInProgress()&&Yc(t)&&(o.finish(),e.mouseDown=!1)})),this.eventManager.addEventListener(i,"touchend",(()=>{o.isInProgress()&&o.finish(),e.mouseDown=!1})),this.eventManager.addEventListener(i,"mousedown",(o=>{const s=o.target,r=o.x||o.clientX,l=o.y||o.clientY;let a=o.target;if(e.mouseDown||!t||!this.instance.view)return;const{holder:h}=this.instance.view._wt.wtTable;if(a===h){const e=hh(n);if(n.elementFromPoint(r+e,l)!==h||n.elementFromPoint(r,l+e)!==h)return}else for(;a!==i;){if(null===a){if(o.isTargetWebComponent)break;return}if(a===t)return;a=a.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)})),this.eventManager.addEventListener(e.table,"selectstart",(e=>{this.settings.fragmentSelection||fh(e.target)||e.preventDefault()}))}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===o&&(o=t),[n,o]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),o=e.getNearestNotHiddenIndex(n-1,-1);return null===o?0:e.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,o){if(isNaN(e)||e<0)return 0;const i=n.getNearestNotHiddenIndex(e,t),s=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(s))return 0;let r=0;return t<0?r=s+1:t>0&&(r=o-s),r}countNotHiddenFixedColumnsStart(){const e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}initializeWalkontable(){const e=Xf.get(this),t={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:()=>zf(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(e,t)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const e=[];return this.instance.hasRowHeaders()&&e.push(((e,t)=>{const n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(n,t)})),this.instance.runHooks("afterGetRowHeaderRenderers",e),Kf(this,Jf,e.length),e},columnHeaders:()=>{const e=[];return this.instance.hasColHeaders()&&e.push(((e,t)=>{const n=e>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(n,t)})),this.instance.runHooks("afterGetColumnHeaderRenderers",e),Kf(this,Zf,e.length),e},columnWidth:e=>{const t=this.instance.columnIndexMapper.getVisualFromRenderableIndex(e);return this.instance.getColWidth(null===t?e:t)},rowHeight:e=>{const t=this.instance.rowIndexMapper.getVisualFromRenderableIndex(e);return this.instance.getRowHeight(null===t?e:t)},cellRenderer:(e,t,n)=>{const[o,i]=this.translateFromRenderableToVisualIndex(e,t),s=this.instance.runHooks("modifyGetCellCoords",o,i);let r=o,l=i;Array.isArray(s)&&([r,l]=s);const a=this.instance.getCellMeta(r,l),h=this.instance.colToProp(l);let c=this.instance.getDataAtRowProp(r,h);this.instance.hasHook("beforeValueRender")&&(c=this.instance.runHooks("beforeValueRender",c,a)),this.instance.runHooks("beforeRenderer",n,o,i,h,c,a),this.instance.getCellRenderer(a)(this.instance,n,o,i,h,c,a),this.instance.runHooks("afterRenderer",n,o,i,h,c,a)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(t,n,o,i)=>{const s=this.translateFromRenderableToVisualCoords(n),r={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=i,e.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",t,s,o,r),zc(t)||(Bf(t,{coords:s,selection:this.instance.selection,controller:r,cellCoordsFactory:(e,t)=>this.instance._createCellCoords(e,t)}),this.instance.runHooks("afterOnCellMouseDown",t,s,o),this.activeWt=this._wt)},onCellContextMenu:(t,n,o,i)=>{const s=this.translateFromRenderableToVisualCoords(n);this.activeWt=i,e.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",t,s,o),zc(t)||(this.instance.runHooks("afterOnCellContextMenu",t,s,o),this.activeWt=this._wt)},onCellMouseOut:(e,t,n,o)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=o,this.instance.runHooks("beforeOnCellMouseOut",e,i,n),zc(e)||(this.instance.runHooks("afterOnCellMouseOut",e,i,n),this.activeWt=this._wt)},onCellMouseOver:(t,n,o,i)=>{const s=this.translateFromRenderableToVisualCoords(n),r={row:!1,column:!1,cell:!1};this.activeWt=i,this.instance.runHooks("beforeOnCellMouseOver",t,s,o,r),zc(t)||(e.mouseDown&&Bf(t,{coords:s,selection:this.instance.selection,controller:r,cellCoordsFactory:(e,t)=>this.instance._createCellCoords(e,t)}),this.instance.runHooks("afterOnCellMouseOver",t,s,o),this.activeWt=this._wt)},onCellMouseUp:(e,t,n,o)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=o,this.instance.runHooks("beforeOnCellMouseUp",e,i,n),zc(e)||this.instance.isDestroyed||(this.instance.runHooks("afterOnCellMouseUp",e,i,n),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,n)=>{const o=this.instance.rowIndexMapper,i=o.getVisualFromRenderableIndex(e),s=this.instance.runHooks("beforeHighlightingRowHeader",i,t,n);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(e,t,n)=>{const o=this.instance.columnIndexMapper,i=o.getVisualFromRenderableIndex(e),s=this.instance.runHooks("beforeHighlightingColumnHeader",i,t,n);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(e,t,n)=>{let o;const[i,s]=this.translateFromRenderableToVisualIndex(e,t),r=this.instance.selection.getSelectedRange(),l=r.size();if(l>0){const e=(null!=n?n:0)+1-l,t=r.peekByIndex(e);o=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.instance.runHooks("afterDrawSelection",i,s,o,n)},onBeforeDrawBorders:(e,t)=>{const[n,o,i,s]=e,r=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(n),this.instance.columnIndexMapper.getVisualFromRenderableIndex(o),this.instance.rowIndexMapper.getVisualFromRenderableIndex(i),this.instance.columnIndexMapper.getVisualFromRenderableIndex(s)];return this.instance.runHooks("beforeDrawBorders",r,t)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(e,t)=>{const n=this.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return this.instance.runHooks("beforeStretchingColumnWidth",e,n)},onModifyRowHeaderWidth:e=>this.instance.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,n)=>{const o=this.instance.rowIndexMapper,i=this.instance.columnIndexMapper,s=t>=0?i.getVisualFromRenderableIndex(t):t,r=e>=0?o.getVisualFromRenderableIndex(e):e,l=this.instance.runHooks("modifyGetCellCoords",r,s,n);if(Array.isArray(l)){const[e,t,n,s]=l;return[e>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(e,1)):e,t>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(t,1)):t,n>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1)):n,s>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)):s]}},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;if("auto"===t&&this.settings.fixedRowsTop&&(t=10),t>0||"auto"===t){const n=this.countRenderableRows(),o=e.startRow,i=e.endRow;if("number"==typeof t)e.startRow=Math.max(o-t,0),e.endRow=Math.min(i+t,n-1);else if("auto"===t){const t=Math.ceil(i/n*12);e.startRow=Math.max(o-t,0),e.endRow=Math.min(i+t,n-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;if("auto"===t&&this.settings.fixedColumnsStart&&(t=10),t>0||"auto"===t){const n=this.countRenderableColumns(),o=e.startColumn,i=e.endColumn;if("number"==typeof t&&(e.startColumn=Math.max(o-t,0),e.endColumn=Math.min(i+t,n-1)),"auto"===t){const t=Math.ceil(i/n*6);e.startColumn=Math.max(o-t,0),e.endColumn=Math.min(i+t,n-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const e=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}};this.instance.runHooks("beforeInitWalkontable",t),this._wt=new Nf(t),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:o,height:i}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(o,i),this.eventManager.addEventListener(n,"mousedown",(e=>{e.target===n&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(n,"contextmenu",(e=>{e.target===n&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(e){if(fh(e))return!0;const t=Ia(e,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return Xf.get(this).mouseDown}isSelectedOnlyCell(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}isCellEdited(){const e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!Na(n,"relative"))return Fa(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{const{rootDocument:n,getRowHeader:o}=this.instance,i=n.createElement("div"),s=n.createElement("span");i.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,o),i.appendChild(s),t.appendChild(i)}this.instance.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t.firstChild){const i=t.firstChild;Na(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),e,n,o):(Fa(t),this.appendColHeader(e,t,n,o))}else{const{rootDocument:i}=this.instance,s=i.createElement("div"),r=i.createElement("span");s.className="relative",r.className="colHeader",this.updateCellHeader(r,e,n,o),s.appendChild(r),t.appendChild(s)}this.instance.runHooks("afterGetColHeader",e,t,o)}updateCellHeader(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Na(e,"colHeader")?i=s.wtTable.columnFilter.sourceToRendered(t):Na(e,"rowHeader")&&(i=s.wtTable.rowFilter.sourceToRendered(t))),i>-1?Wa(e,n(t,o)):(Ua(e,String.fromCharCode(160)),Pa(e,"cornerHeader"))}maximumVisibleElementWidth(e){const t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}maximumVisibleElementHeight(e){const t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}setLastSize(e,t){const n=Xf.get(this);[n.lastWidth,n.lastHeight]=[e,t]}getLastSize(){const e=Xf.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return Gf(this,Zf)}getRowHeadersCount(){return Gf(this,Jf)}destroy(){this._wt.destroy(),this.eventManager.destroy()}};const em="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function tm(e){let t,n=e+1,o="";for(;n>0;)t=(n-1)%26,o=String.fromCharCode(65+t)+o,n=parseInt((n-t)/26,10);return o}function nm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;const o=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach(((e,n)=>{Array.isArray(e)?e.forEach(((e,i)=>{o.push([n+t,i,e])})):Object.keys(e).forEach((i=>{o.push([n+t,i,e[i]])}))})),o}function om(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&uc(e[0])&&(t=pc(e[0]))),t}function im(e){return!!(Array.isArray(e)&&e.length&&e.every((e=>Array.isArray(e))))}function sm(e){return!!(Array.isArray(e)&&e.length&&e.every((e=>"object"==typeof e&&!Array.isArray(e)&&null!==e)))}var rm=Object.freeze({__proto__:null,countFirstRowKeys:om,createEmptySpreadsheetData:function(e,t){const n=[];let o;for(let i=0;i<e;i++){o=[];for(let e=0;e<t;e++)o.push("");n.push(o)}return n},createSpreadsheetData:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let o,i;for(o=0;o<e;o++){const e=[];for(i=0;i<t;i++)e.push(tm(i)+(o+1));n.push(e)}return n},createSpreadsheetObjectData:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let o,i;for(o=0;o<e;o++){const e={};for(i=0;i<t;i++)e[`prop${i}`]=tm(i)+(o+1);n.push(e)}return n},dataRowToChangesArray:nm,isArrayOfArrays:im,isArrayOfObjects:sm,spreadsheetColumnIndex:function(e){let t=0;if(e)for(let n=0,o=e.length-1;n<e.length;n+=1,o-=1)t+=26**o*(em.indexOf(e[n])+1);return t-=1,t},spreadsheetColumnLabel:tm});var lm=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.hot=e,this.data=t,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}setData(e){this.data=e}getAtColumn(e){const t=[];return Xl(this.data,((n,o)=>{const i=this.getAtCell(o,e);t.push(i)})),t}getAtRow(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===t&&void 0===n;let s=null,r=null;if(s=this.modifyRowData(e),Array.isArray(s))r=[],i?s.forEach(((t,n)=>{r[n]=this.getAtPhysicalCell(e,n,s)})):_u(t,n,(n=>{r[n-t]=this.getAtPhysicalCell(e,n,s)}));else if(uc(s)||vh(s))if(r=o?[]:{},!i||o){const i=0,l=this.countFirstRowKeys()-1;_u(i,l,(a=>{const h=this.colToProp(a);if(a>=(t||i)&&a<=(n||l)&&!Number.isInteger(h)){const t=this.getAtPhysicalCell(e,h,s);o?r.push(t):mc(r,h,t)}}))}else gc(s,((t,n)=>{mc(r,n,this.getAtPhysicalCell(e,n,s))}));return r}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=wc(n);this.hot.runHooks("modifySourceData",e,t,o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(t)?this.data[e][t]=n:mc(this.data[e],t,n)}}getAtPhysicalCell(e,t,n){let o=null;if(n&&(o="string"==typeof t?fc(n,t):"function"==typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){const n=wc(o);this.hot.runHooks("modifySourceData",e,t,n,"get"),n.isTouched()&&(o=n.value)}return o}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,s=null,r=null,l=null;null===e||null===t?(o=!0,i=0,r=this.countRows()-1):(i=Math.min(e.row,t.row),s=Math.min(e.col,t.col),r=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const a=[];return _u(i,r,(e=>{a.push(o?this.getAtRow(e,void 0,void 0,n):this.getAtRow(e,s,l,n))})),a}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return om(this.data)}destroy(){this.data=null,this.hot=null}};const am={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,n,o,i,s,r){if(this._localHooks[e]){const l=this._localHooks[e].length;for(let a=0;a<l;a++)Mh(this._localHooks[e][a],this,t,n,o,i,s,r)}},clearLocalHooks(){return this._localHooks={},this}};dc(am,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});var hm=am;class cm{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,vh(this.initValueOrFn)?_u(e-1,(e=>this.indexedValues.push(this.initValueOrFn(e)))):_u(e-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function um(e,t,n,o){const i=n.length?n[0]:void 0;return[...e.slice(0,i),...n.map(((e,t)=>vh(o)?o(e,t):o)),...void 0===i?[]:e.slice(i)]}function dm(e,t){return Kl(e,((e,n)=>!1===t.includes(n)))}hc(cm,hm);class gm extends cm{insert(e,t){this.indexedValues=um(this.indexedValues,0,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=dm(this.indexedValues,e),super.remove(e)}}class fm extends gm{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return Gl(this.getValues(),((e,t,n)=>(t&&e.push(n),e)),[])}}function mm(e,t,n){return[...e.slice(0,t),...n,...e.slice(t)]}function pm(e,t){return Kl(e,(e=>!1===t.includes(e)))}function wm(e,t){return ql(e,(e=>e-t.filter((t=>t<e)).length))}function Cm(e,t){const n=t[0],o=t.length;return ql(e,(e=>e>=n?e+o:e))}function ym(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class vm extends cm{constructor(){super(...arguments),ym(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((e=>this.indexedValues[e]))}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=pm(this.orderOfIndexes,[e]),vh(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=um(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=Cm(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=dm(this.indexedValues,e),this.orderOfIndexes=pm(this.orderOfIndexes,e),this.orderOfIndexes=wm(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map((e=>[e,this.getValueAtIndex(e)]))}}class bm extends gm{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return Gl(this.getValues(),((e,t,n)=>(t&&e.push(n),e)),[])}}const Sm=new Map([["indexesSequence",{getListWithInsertedItems:mm,getListWithRemovedItems:pm}],["physicallyIndexed",{getListWithInsertedItems:um,getListWithRemovedItems:dm}]]),Rm=e=>{if(!1===Sm.has(e))throw new Error(`Alter strategy with ID '${e}' does not exist.`);return Sm.get(e)};class Em extends cm{constructor(){super((e=>e))}insert(e,t){const n=Cm(this.indexedValues,t);this.indexedValues=mm(n,e,t),super.insert(e,t)}remove(e){const t=pm(this.indexedValues,e);this.indexedValues=wm(t,e),super.remove(e)}}const Mm=new Map([["hiding",fm],["index",cm],["linkedPhysicalIndexToValue",vm],["physicalIndexToValue",gm],["trimming",bm]]);let Tm=0;class xm{constructor(){this.collection=new Map}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(()=>this.runLocalHooks("change",t))),Tm+=1)}unregister(e){const t=this.collection.get(e);ia(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),Tm-=1)}unregisterAll(){this.collection.forEach(((e,t)=>this.unregister(t))),this.collection.clear()}get(e){return sa(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach((t=>{t.remove(e)}))}insertToEvery(e,t){this.collection.forEach((n=>{n.insert(e,t)}))}initEvery(e){this.collection.forEach((t=>{t.init(e)}))}}hc(xm,hm);class Om extends xm{constructor(e,t){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const e=ql(this.get(),(e=>e.getValues())),t=[],n=ia(e[0])&&e[0].length||0;for(let o=0;o<n;o+=1){const n=[];for(let t=0;t<this.getLength();t+=1)n.push(e[t][o]);t.push(n)}return ql(t,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return ia(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Am(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function _m(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Im(e,t,"set"),n),n}function Im(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var km=new WeakMap;class Hm{constructor(){Am(this,km,{writable:!0,value:[]})}subscribe(e){var t;return this.addLocalHook("change",e),this._write(function(e,t){return t.get?t.get.call(e):t.value}(t=this,Im(t,km,"get"))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){_m(this,km,e)}}function Dm(e,t){const n=[];let o=0,i=0;for(;o<e.length&&i<t.length;o++,i++)e[o]!==t[i]&&n.push({op:"replace",index:i,oldValue:e[o],newValue:t[i]});for(;o<t.length;o++)n.push({op:"insert",index:o,oldValue:void 0,newValue:t[o]});for(;i<e.length;i++)n.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return n}function Nm(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Pm(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Vm(e,t,"get"))}function Lm(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Vm(e,t,"set"),n),n}function Vm(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}hc(Hm,hm);var Fm=new WeakMap,Bm=new WeakMap,Wm=new WeakMap,Um=new WeakMap,jm=new WeakMap;class zm{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Nm(this,Fm,{writable:!0,value:new Set}),Nm(this,Bm,{writable:!0,value:[]}),Nm(this,Wm,{writable:!0,value:[]}),Nm(this,Um,{writable:!0,value:!1}),Nm(this,jm,{writable:!0,value:!1}),Lm(this,jm,null!=e&&e)}createObserver(){const e=new Hm;return Pm(this,Fm).add(e),e.addLocalHook("unsubscribe",(()=>{Pm(this,Fm).delete(e)})),e._writeInitialChanges(Dm(Pm(this,Bm),Pm(this,Wm))),e}emit(e){let t=Pm(this,Wm);Pm(this,Um)&&Pm(this,Bm).length===e.length||(0===e.length?e=new Array(t.length).fill(Pm(this,jm)):Lm(this,Bm,new Array(e.length).fill(Pm(this,jm))),Pm(this,Um)||(Lm(this,Um,!0),t=Pm(this,Bm)));const n=Dm(t,e);Pm(this,Fm).forEach((e=>e._write(n))),Lm(this,Wm,e)}}class Ym{constructor(){this.indexesSequence=new Em,this.trimmingMapsCollection=new Om((e=>e.some((e=>!0===e))),!1),this.hidingMapsCollection=new Om((e=>e.some((e=>!0===e))),!1),this.variousMapsCollection=new xm,this.hidingChangesObservable=new zm({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(e=>{this.runLocalHooks("change",e,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Mm.has(e))throw new Error(`The provided map type ("${e}") does not exist.`);return new(Mm.get(e))(t)}(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof bm?this.trimmingMapsCollection.register(e,t):t instanceof fm?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return ia(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return ia(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return ia(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return ia(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=t>0?o.findIndex((t=>t>e)):o.reverse().findIndex((t=>t<e)),-1===i?n?this.getNearestNotHiddenIndex(e,-t,!1):null:o[i]}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const t=[...Array(this.getNumberOfIndexes()-e).keys()].map((t=>t+e));this.removeIndexes(t)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isTrimmed(e)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isHidden(e)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter((e=>!1===this.isHidden(e)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"==typeof e&&(e=[e]);const n=ql(e,(e=>this.getPhysicalFromVisualIndex(e))),o=this.getNotTrimmedIndexesLength(),i=e.length,s=pm(this.getIndexesSequence(),n),r=s.filter((e=>!1===this.isTrimmed(e)));let l=s.indexOf(r[r.length-1])+1;if(t+i<o){const e=r[t];l=s.indexOf(e)}this.indexesChangeSource="move",this.setIndexesSequence(mm(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const n=this.getNotTrimmedIndexes()[e],o=ia(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),s=ql(new Array(t).fill(o),((e,t)=>e+t));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,s),this.hidingMapsCollection.insertToEvery(i,s),this.variousMapsCollection.insertToEvery(i,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(e,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromRenderableIndex(t),n=this.getVisualFromPhysicalIndex(e);this.fromVisualToRenderableIndexesCache.set(n,t)}}}function $m(e){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:e}function Gm(e){ia(e)&&qc(na`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}hc(Ym,hm);const{register:Km,getValues:qm}=iu("phraseFormatters");Km("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));const Xm="ContextMenu:items",Zm=`${Xm}.noItems`,Jm=`${Xm}.insertRowAbove`,Qm=`${Xm}.insertRowBelow`,ep=`${Xm}.insertColumnOnTheLeft`,tp=`${Xm}.insertColumnOnTheRight`,np=`${Xm}.removeRow`,op=`${Xm}.removeColumn`,ip=`${Xm}.undo`,sp=`${Xm}.redo`,rp=`${Xm}.readOnly`,lp=`${Xm}.clearColumn`,ap=`${Xm}.copy`,hp=`${Xm}.copyWithHeaders`,cp=`${Xm}.copyWithGroupHeaders`,up=`${Xm}.copyHeadersOnly`,dp=`${Xm}.cut`,gp=`${Xm}.freezeColumn`,fp=`${Xm}.unfreezeColumn`,mp=`${Xm}.mergeCells`,pp=`${Xm}.unmergeCells`,wp=`${Xm}.addComment`,Cp=`${Xm}.editComment`,yp=`${Xm}.removeComment`,vp=`${Xm}.readOnlyComment`,bp=`${Xm}.align`,Sp=`${Xm}.align.left`,Rp=`${Xm}.align.center`,Ep=`${Xm}.align.right`,Mp=`${Xm}.align.justify`,Tp=`${Xm}.align.top`,xp=`${Xm}.align.middle`,Op=`${Xm}.align.bottom`,Ap=`${Xm}.borders`,_p=`${Xm}.borders.top`,Ip=`${Xm}.borders.right`,kp=`${Xm}.borders.bottom`,Hp=`${Xm}.borders.left`,Dp=`${Xm}.borders.remove`,Np=`${Xm}.nestedHeaders.insertChildRow`,Pp=`${Xm}.nestedHeaders.detachFromParent`,Lp=`${Xm}.hideColumn`,Vp=`${Xm}.showColumn`,Fp=`${Xm}.hideRow`,Bp=`${Xm}.showRow`,Wp="Filters:",Up=`${Wp}conditions`,jp=`${Up}.none`,zp=`${Up}.isEmpty`,Yp=`${Up}.isNotEmpty`,$p=`${Up}.isEqualTo`,Gp=`${Up}.isNotEqualTo`,Kp=`${Up}.beginsWith`,qp=`${Up}.endsWith`,Xp=`${Up}.contains`,Zp=`${Up}.doesNotContain`,Jp=`${Up}.byValue`,Qp=`${Up}.greaterThan`,ew=`${Up}.greaterThanOrEqualTo`,tw=`${Up}.lessThan`,nw=`${Up}.lessThanOrEqualTo`,ow=`${Up}.isBetween`,iw=`${Up}.isNotBetween`,sw=`${Up}.after`,rw=`${Up}.before`,lw=`${Up}.today`,aw=`${Up}.tomorrow`,hw=`${Up}.yesterday`,cw=`${Wp}labels.filterByCondition`,uw=`${Wp}labels.filterByValue`,dw=`${Wp}labels.conjunction`,gw=`${Wp}labels.disjunction`,fw=`${Wp}values.blankCells`,mw=`${Wp}buttons.selectAll`,pw=`${Wp}buttons.clear`,ww=`${Wp}buttons.ok`,Cw=`${Wp}buttons.cancel`,yw=`${Wp}buttons.placeholder.search`,vw=`${Wp}buttons.placeholder.value`,bw=`${Wp}buttons.placeholder.secondValue`;var Sw=Object.freeze({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:wp,CONTEXTMENU_ITEMS_ALIGNMENT:bp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Op,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Rp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Mp,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Sp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:xp,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Ep,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Tp,CONTEXTMENU_ITEMS_BORDERS:Ap,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:kp,CONTEXTMENU_ITEMS_BORDERS_LEFT:Hp,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Ip,CONTEXTMENU_ITEMS_BORDERS_TOP:_p,CONTEXTMENU_ITEMS_CLEAR_COLUMN:lp,CONTEXTMENU_ITEMS_COPY:ap,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:up,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:cp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:hp,CONTEXTMENU_ITEMS_CUT:dp,CONTEXTMENU_ITEMS_EDIT_COMMENT:Cp,CONTEXTMENU_ITEMS_FREEZE_COLUMN:gp,CONTEXTMENU_ITEMS_HIDE_COLUMN:Lp,CONTEXTMENU_ITEMS_HIDE_ROW:Fp,CONTEXTMENU_ITEMS_INSERT_LEFT:ep,CONTEXTMENU_ITEMS_INSERT_RIGHT:tp,CONTEXTMENU_ITEMS_MERGE_CELLS:mp,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Pp,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Np,CONTEXTMENU_ITEMS_NO_ITEMS:Zm,CONTEXTMENU_ITEMS_READ_ONLY:rp,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:vp,CONTEXTMENU_ITEMS_REDO:sp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Dp,CONTEXTMENU_ITEMS_REMOVE_COLUMN:op,CONTEXTMENU_ITEMS_REMOVE_COMMENT:yp,CONTEXTMENU_ITEMS_REMOVE_ROW:np,CONTEXTMENU_ITEMS_ROW_ABOVE:Jm,CONTEXTMENU_ITEMS_ROW_BELOW:Qm,CONTEXTMENU_ITEMS_SHOW_COLUMN:Vp,CONTEXTMENU_ITEMS_SHOW_ROW:Bp,CONTEXTMENU_ITEMS_UNDO:ip,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:fp,CONTEXTMENU_ITEMS_UNMERGE_CELLS:pp,CONTEXT_MENU_ITEMS_NAMESPACE:Xm,FILTERS_BUTTONS_CANCEL:Cw,FILTERS_BUTTONS_CLEAR:pw,FILTERS_BUTTONS_OK:ww,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:yw,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:bw,FILTERS_BUTTONS_PLACEHOLDER_VALUE:vw,FILTERS_BUTTONS_SELECT_ALL:mw,FILTERS_CONDITIONS_AFTER:sw,FILTERS_CONDITIONS_BEFORE:rw,FILTERS_CONDITIONS_BEGINS_WITH:Kp,FILTERS_CONDITIONS_BETWEEN:ow,FILTERS_CONDITIONS_BY_VALUE:Jp,FILTERS_CONDITIONS_CONTAINS:Xp,FILTERS_CONDITIONS_EMPTY:zp,FILTERS_CONDITIONS_ENDS_WITH:qp,FILTERS_CONDITIONS_EQUAL:$p,FILTERS_CONDITIONS_GREATER_THAN:Qp,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:ew,FILTERS_CONDITIONS_LESS_THAN:tw,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:nw,FILTERS_CONDITIONS_NAMESPACE:Up,FILTERS_CONDITIONS_NONE:jp,FILTERS_CONDITIONS_NOT_BETWEEN:iw,FILTERS_CONDITIONS_NOT_CONTAIN:Zp,FILTERS_CONDITIONS_NOT_EMPTY:Yp,FILTERS_CONDITIONS_NOT_EQUAL:Gp,FILTERS_CONDITIONS_TODAY:lw,FILTERS_CONDITIONS_TOMORROW:aw,FILTERS_CONDITIONS_YESTERDAY:hw,FILTERS_DIVS_FILTER_BY_CONDITION:cw,FILTERS_DIVS_FILTER_BY_VALUE:uw,FILTERS_LABELS_CONJUNCTION:dw,FILTERS_LABELS_DISJUNCTION:gw,FILTERS_NAMESPACE:Wp,FILTERS_VALUES_BLANK_CELLS:fw});
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var Rw={languageCode:"en-US",[Zm]:"No available options",[Jm]:"Insert row above",[Qm]:"Insert row below",[ep]:"Insert column left",[tp]:"Insert column right",[np]:["Remove row","Remove rows"],[op]:["Remove column","Remove columns"],[ip]:"Undo",[sp]:"Redo",[rp]:"Read only",[lp]:"Clear column",[bp]:"Alignment",[Sp]:"Left",[Rp]:"Center",[Ep]:"Right",[Mp]:"Justify",[Tp]:"Top",[xp]:"Middle",[Op]:"Bottom",[gp]:"Freeze column",[fp]:"Unfreeze column",[Ap]:"Borders",[_p]:"Top",[Ip]:"Right",[kp]:"Bottom",[Hp]:"Left",[Dp]:"Remove border(s)",[wp]:"Add comment",[Cp]:"Edit comment",[yp]:"Delete comment",[vp]:"Read-only comment",[mp]:"Merge cells",[pp]:"Unmerge cells",[ap]:"Copy",[hp]:["Copy with header","Copy with headers"],[cp]:["Copy with group header","Copy with group headers"],[up]:["Copy header only","Copy headers only"],[dp]:"Cut",[Np]:"Insert child row",[Pp]:"Detach from parent",[Lp]:["Hide column","Hide columns"],[Vp]:["Show column","Show columns"],[Fp]:["Hide row","Hide rows"],[Bp]:["Show row","Show rows"],[jp]:"None",[zp]:"Is empty",[Yp]:"Is not empty",[$p]:"Is equal to",[Gp]:"Is not equal to",[Kp]:"Begins with",[qp]:"Ends with",[Xp]:"Contains",[Zp]:"Does not contain",[Qp]:"Greater than",[ew]:"Greater than or equal to",[tw]:"Less than",[nw]:"Less than or equal to",[ow]:"Is between",[iw]:"Is not between",[sw]:"After",[rw]:"Before",[lw]:"Today",[aw]:"Tomorrow",[hw]:"Yesterday",[fw]:"Blank cells",[cw]:"Filter by condition",[uw]:"Filter by value",[dw]:"And",[gw]:"Or",[mw]:"Select all",[pw]:"Clear",[ww]:"OK",[Cw]:"Cancel",[yw]:"Search",[vw]:"Value",[bw]:"Second value"};const Ew=Sw,Mw=Rw.languageCode,{register:Tw,getItem:xw,hasItem:Ow,getValues:Aw}=iu("languagesDictionaries");function _w(e,t){let n=e,o=t;return uc(e)&&(o=e,n=o.languageCode),function(e,t){e!==Mw&&(n=t,gc(xw(Mw),((e,t)=>{sa(n[t])&&(n[t]=e)})));var n}(n,o),Tw(n,lc(o)),lc(o)}function Iw(e){return kw(e)?lc(xw(e)):null}function kw(e){return Ow(e)}function Hw(e,t,n){const o=Iw(e);if(null===o)return null;const i=o[t];if(sa(i))return null;const s=function(e,t){let n=e;return Xl(function(){return qm()}(),(o=>{n=o(e,t)})),n}(i,n);return Array.isArray(s)?s[0]:s}_w(Rw);const Dw="active-header",Nw="area",Pw="cell",Lw="fill",Vw="header",Fw="custom-selection";function Bw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ww=class extends Lf{constructor(e,t){super(e,null),Bw(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:n}=e,o=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(n,-1);if(null===o||null===i)return null;if(o.row>i.row||o.col>i.col){if(!("header"===this.settings.type||"active-header"===this.settings.type))return null;o=t,i=n}return this.settings.createCellRange(o,o,i)}getNearestNotHiddenCoords(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(null===o)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,n);return null===i?null:this.settings.createCellCoords(o,i)}getNearestNotHiddenIndex(e,t,n){if(t<0)return t;const o=e.getNearestNotHiddenIndex(t,n);return("header"===this.settings.type||"active-header"===this.settings.type)&&null===o?-1:o}commit(){if(null===this.visualCellRange)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,o=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,n);if(null!==o&&e.overlaps(o)){if(null===this.cellRange){const e=this.settings.visualToRenderableCoords(o);this.cellRange=this.settings.createCellRange(e)}return e.setHighlight(o),this}return e.setHighlight(e.from),this}getCorners(){const{from:e,to:t}=this.cellRange,n=null===e.row||null===t.row,o=null===e.col||null===t.col,i=this.settings.createCellCoords(n?null:Math.min(e.row,t.row),o?null:Math.min(e.col,t.col)),s=this.settings.createCellCoords(n?null:Math.max(e.row,t.row),o?null:Math.max(e.col,t.col));return[i.row,i.col,s.row,s.col]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const n=this.settings.visualToRenderableCoords(e),o=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(n,n,o)}};const{register:Uw,getItem:jw}=iu("highlight/types");function zw(e,t){return jw(e)({type:e,...t})}Uw(Dw,(function(e){let{activeHeaderClassName:t,...n}=e;return new Ww({highlightHeaderClassName:t,...n,selectionType:Dw})})),Uw(Nw,(function(e){let{layerLevel:t,areaCornerVisible:n,...o}=e;return new Ww({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n},...o,selectionType:Nw})})),Uw(Pw,(function(e){let{cellCornerVisible:t,...n}=e;return new Ww({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t},...n,selectionType:Pw})})),Uw(Fw,(function(e){let{border:t,visualCellRange:n,...o}=e;return new Ww({...t,...o,selectionType:Fw},n)})),Uw(Lw,(function(e){let{...t}=e;return new Ww({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:Lw})})),Uw(Vw,(function(e){let{headerClassName:t,rowClassName:n,columnClassName:o,...i}=e;return new Ww({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:o,...i,highlightOnlyClosestHeader:!0,selectionType:Vw})}));class Yw{constructor(e){this.options=e,this.layerLevel=0,this.cell=zw(Pw,e),this.fill=zw(Lw,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}isEnabledFor(e,t){let n=e;e===Pw&&(n="current");let o=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof o&&(o=[o]),!1===o||Array.isArray(o)&&!o.includes(n)}useLayerLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){const e=this.layerLevel;let t;return this.areas.has(e)?t=this.areas.get(e):(t=zw(Nw,{layerLevel:e,...this.options}),this.areas.set(e,t)),t}getAreas(){return[...this.areas.values()]}createOrGetHeader(){const e=this.layerLevel;let t;return this.headers.has(e)?t=this.headers.get(e):(t=zw(Vw,{...this.options}),this.headers.set(e,t)),t}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){const e=this.layerLevel;let t;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=zw(Dw,{...this.options}),this.activeHeaders.set(e,t)),t}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(zw(Fw,{...this.options,...e}))}clear(){this.cell.clear(),this.fill.clear(),Xl(this.areas.values(),(e=>{e.clear()})),Xl(this.headers.values(),(e=>{e.clear()})),Xl(this.activeHeaders.values(),(e=>{e.clear()}))}[Symbol.iterator](){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections][Symbol.iterator]()}}var $w=Yw;class Gw{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(e){return this.ranges.some((t=>t.includes(e)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this.size()+e-1;let n;return t>=0&&(n=this.ranges[t]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var Kw=Gw;class qw{constructor(e,t){this.range=e,this.options=t}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.options.createCellCoords(e,t),i=this.range.current().highlight,{row:s,col:r}=this.options.visualToRenderableCoords(i);let l=i,a=0,h=0;if(this.runLocalHooks("beforeTransformStart",o),null!==s&&null!==r){let t=this.options.countRows(),i=this.options.countCols();const c=this.options.fixedRowsBottom(),u=this.options.minSpareRows(),d=this.options.minSpareCols(),g=this.options.autoWrapRow(),f=this.options.autoWrapCol();s+e>t-1?n&&u>0&&!(c&&s>=t-c-1)?(this.runLocalHooks("insertRowRequire",t),t=this.options.countRows()):f&&(o.row=1-t,o.col=r+o.col===i-1?1-i:1):f&&s+o.row<0&&r+o.col>=0&&(o.row=t-1,o.col=r+o.col===0?i-1:-1),r+o.col>i-1?n&&d>0?(this.runLocalHooks("insertColRequire",i),i=this.options.countCols()):g&&(o.row=s+o.row===t-1?1-t:1,o.col=1-i):g&&r+o.col<0&&s+o.row>=0&&(o.row=s+o.row===0?t-1:-1,o.col=i-1);const m=this.options.createCellCoords(s+o.row,r+o.col);a=0,h=0,m.row<0?(a=-1,m.row=0):m.row>0&&m.row>=t&&(a=1,m.row=t-1),m.col<0?(h=-1,m.col=0):m.col>0&&m.col>=i&&(h=1,m.col=i-1),l=this.options.renderableToVisualCoords(m)}return this.runLocalHooks("afterTransformStart",l,a,h),l}transformEnd(e,t){const n=this.options.createCellCoords(e,t),o=this.range.current();let i=o.to,s=0,r=0;this.runLocalHooks("beforeTransformEnd",n);const{row:l,col:a}=this.options.visualToRenderableCoords(o.highlight);if(null!==l&&null!==a){const e=this.options.countRows(),t=this.options.countCols(),{row:l,col:a}=this.options.visualToRenderableCoords(o.to),h=this.options.createCellCoords(l+n.row,a+n.col);s=0,r=0,h.row<0?(s=-1,h.row=0):h.row>0&&h.row>=e&&(s=1,h.row=e-1),h.col<0?(r=-1,h.col=0):h.col>0&&h.col>=t&&(r=1,h.col=t-1),i=this.options.renderableToVisualCoords(h)}return this.runLocalHooks("afterTransformEnd",i,s,r),i}}hc(qw,hm);var Xw=qw;const Zw=[3,2],Jw=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Qw=Symbol("root"),eC=Symbol("child");function tC(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qw;if(t!==Qw&&t!==eC)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(e),o=t===Qw;let i=0;if(n){const t=e[0];if(0===e.length)i=1;else if(o&&t instanceof ag)i=3;else if(o&&Array.isArray(t))i=tC(t,eC);else if(e.length>=2&&e.length<=4){const t=!e.some(((e,t)=>!Jw[t].includes(typeof e)));t&&(i=2)}}return i}function nC(e){let{keepDirection:t=!1,propToCol:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Zw.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const i=3===e;let s=i?o.from.row:o[0],r=i?o.from.col:o[1],l=i?o.to.row:o[2],a=i?o.to.col:o[3];if("function"==typeof n&&("string"==typeof r&&(r=n(r)),"string"==typeof a&&(a=n(a))),sa(l)&&(l=s),sa(a)&&(a=r),!t){const e=s,t=r,n=l,o=a;s=Math.min(e,n),r=Math.min(t,o),l=Math.max(e,n),a=Math.max(t,o)}return[s,r,l,a]}}function oC(e){return"number"==typeof e&&e>=0&&e<(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0)}class iC{constructor(e,t){var n=this;this.settings=e,this.tableProps=t,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Kw(((e,t,n)=>this.tableProps.createCellRange(e,t,n))),this.highlight=new $w({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,n)=>this.tableProps.createCellRange(e,t,n),rowIndexMapper:()=>this.tableProps.rowIndexMapper(),columnIndexMapper:()=>this.tableProps.columnIndexMapper()}),this.transformation=new Xw(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...t)})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...t)})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...t)})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...t)})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...t)})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.runLocalHooks("insertColRequire",...t)}))}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o="multiple"===this.settings.selectionMode,i=sa(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,s=e.row<0,r=e.col<0,l=s&&r,a=e.clone();this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart"+(n?"Only":""),a),(!o||o&&!i&&sa(t))&&this.selectedRange.clear(),this.selectedRange.add(a),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&r&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){this.setRangeStart(e,t,!0)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Pw,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);const o=this.getLayerLevel();o<this.highlight.layerLevel&&(Xl(this.highlight.getAreas(),(e=>{e.clear()})),Xl(this.highlight.getHeaders(),(e=>{e.clear()})),Xl(this.highlight.getActiveHeaders(),(e=>{e.clear()}))),this.highlight.useLayerLevel(o);const i=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),r=this.highlight.createOrGetActiveHeader();if(i.clear(),s.clear(),r.clear(),this.highlight.isEnabledFor(Nw,n.highlight)&&(this.isMultiple()||o>=1)&&(i.add(n.from).add(n.to).commit(),1===o)){const e=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(e.from).commit().syncWith(e),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(Vw,n.highlight)){const e=0===this.tableProps.countRowsTranslated(),t=0===this.tableProps.countColsTranslated();let o=n;if((e||t)&&(o=n.clone()),e&&(o.from.row=-1),t&&(o.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&o.from.normalize(),s.add(o.from).commit()):s.add(o.from).add(o.to).commit(),this.isEntireRowSelected()){this.tableProps.countCols()===n.getWidth()&&r.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit()}if(this.isEntireColumnSelected()){this.tableProps.countRows()===n.getHeight()&&r.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=wc(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(e,t,n))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByCorner}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(e||t||0!==n&&0!==o))return;const i=this.tableProps.createCellCoords(t?-1:0,e?-1:0),s=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(i),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}selectCells(e){const t=tC(e);if(1===t)return!1;if(0===t)throw new Error(na`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const n=nC(t,{propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),o=this.tableProps.countRows(),i=this.tableProps.countCols(),s=!e.some((e=>{const[t,s,r,l]=n(e);return!(oC(t,o)&&oC(s,i)&&oC(r,o)&&oC(l,i))}));return s&&(this.clear(),Xl(e,(e=>{const[t,o,i,s]=n(e);this.setRangeStartOnly(this.tableProps.createCellCoords(t,o),!1),this.setRangeEnd(this.tableProps.createCellCoords(i,s)),this.finish()}))),s}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;const o="string"==typeof e?this.tableProps.propToCol(e):e,i="string"==typeof t?this.tableProps.propToCol(t):t,s=this.tableProps.countCols(),r=this.tableProps.countRows(),l=oC(o,s)&&oC(i,s);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,o)),this.setRangeEnd(this.tableProps.createCellCoords(r-1,i)),this.finish()),l}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;const o=this.tableProps.countRows(),i=this.tableProps.countCols(),s=oC(e,o)&&oC(t,o);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(t,i-1)),this.finish()),s}refresh(){if(this.highlight.getCustomSelections().forEach((e=>{e.commit()})),!this.isSelected())return;const e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let e=0;e<this.selectedRange.size();e+=1){this.highlight.useLayerLevel(e);const t=this.highlight.createOrGetArea(),n=this.highlight.createOrGetHeader(),o=this.highlight.createOrGetActiveHeader();t.commit(),n.commit(),o.commit()}this.highlight.useLayerLevel(t)}}hc(iC,hm);var sC=iC;const rC=/^(\r\n|\n\r|\r|\n)/,lC=/^[^\t\r\n]+/,aC=/^\t/;function hC(e){let t,n,o,i,s,r="";for(t=0,n=e.length;t<n;t+=1){for(i=e[t].length,o=0;o<i;o+=1)o>0&&(r+="\t"),s=e[t][o],"string"==typeof s?s.indexOf("\n")>-1?r+=`"${s.replace(/"/g,'""')}"`:r+=s:r+=null==s?"":s;t!==n-1&&(r+="\n")}return r}class cC{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let o=0,i=0,s=!1;if("function"==typeof t){const t=pc(e);o=t>0?t:this.countFirstRowKeys(),s=!0}else{const e=this.tableMeta.maxCols;o=Math.min(e,t.length)}for(n=0;n<o;n++){const e=s?t(n):t[n];if(uc(e)){if(void 0!==e.data){const t=s?i:n;this.colToPropCache[t]=e.data,this.propToColCache.set(e.data,t)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return om(this.dataSource)}recursiveDuckColumns(e,t,n){let o,i=t,s=n;return void 0===i&&(i=0,s=""),"object"!=typeof e||Array.isArray(e)||gc(e,((e,t)=>{null===e?(o=s+t,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(e,i,`${t}.`)})),i}colToProp(e){if(!1===Number.isInteger(e))return e;const t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&ia(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(ia(t))return this.instance.toVisualColumn(t);const n=this.instance.toVisualColumn(e);return null===n?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?oc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:o="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.instance.countSourceRows();let s=i,r=0,l=e;("number"!=typeof l||l>=i)&&(l=i),l<this.instance.countRows()&&(s=this.instance.toPhysicalRow(l));if(!1===this.instance.runHooks("beforeCreateRow",l,t,n)||null===s)return{delta:0};const a=this.tableMeta.maxRows,h=this.getSchema().length,c=[];for(;r<t&&i+r<a;){let e=null;"array"===this.instance.dataType?this.tableMeta.dataSchema?e=lc(this.getSchema()):(e=[],_u(h-1,(()=>e.push(null)))):"function"===this.instance.dataType?e=this.tableMeta.dataSchema(l+r):(e={},rc(e,this.getSchema())),c.push(e),r+=1}this.instance.rowIndexMapper.insertIndexes(l,r),"below"===o&&(s=Math.min(s+1,i)),this.spliceData(s,0,c);const u=this.instance.toVisualRow(s);return this.instance.countSourceRows()===c.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),r>0&&(null==e?this.metaManager.createRow(null,r):"auto"!==n&&this.metaManager.createRow(s,t)),this.instance.runHooks("afterCreateRow",u,r,n),this.instance.forceFullRender=!0,{delta:r,startPhysicalIndex:s}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:o="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,s=this.tableMeta.maxCols,r=this.instance.countSourceCols();let l=e;("number"!=typeof l||l>=r)&&(l=r);if(!1===this.instance.runHooks("beforeCreateCol",l,t,n))return{delta:0};let a=r;l<this.instance.countCols()&&(a=this.instance.toPhysicalColumn(l));const h=this.instance.countSourceRows();let c=this.instance.countCols(),u=0,d=a;"end"===o&&(d=Math.min(d+1,r));const g=d;for(;u<t&&c<s;){if("number"!=typeof l||l>=c)if(h>0)for(let e=0;e<h;e+=1)void 0===i[e]&&(i[e]=[]),i[e].push(null);else i.push([null]);else for(let e=0;e<h;e++)i[e].splice(d,0,null);u+=1,d+=1,c+=1}this.instance.columnIndexMapper.insertIndexes(l,u),u>0&&(null==e?this.metaManager.createColumn(null,u):"auto"!==n&&this.metaManager.createColumn(g,t));const f=this.instance.toVisualColumn(g);return this.instance.runHooks("afterCreateCol",f,u,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:u,startPhysicalIndex:g}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(o,t),s=this.instance.countSourceRows();o=(s+o)%s;if(!1===this.instance.runHooks("beforeRemoveRow",o,i.length,i,n))return!1;const r=i.length;if(this.filterData(o,r,i),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(i);const e=ia(this.tableMeta.columns)||ia(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===e&&this.instance.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort(((e,t)=>t-e)).forEach((e=>{this.metaManager.removeRow(e,1)})),this.instance.runHooks("afterRemoveRow",o,r,i,n),this.instance.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o="number"!=typeof e?-t:e;o=(this.instance.countCols()+o)%this.instance.countCols();const i=this.visualColumnsToPhysical(o,t),s=i.slice(0).sort(((e,t)=>t-e));if(!1===this.instance.runHooks("beforeRemoveCol",o,t,i,n))return!1;let r=!0;const l=s.length,a=this.dataSource;for(let e=0;e<l;e++)r&&i[0]!==i[e]-e&&(r=!1);if(r)for(let e=0,n=this.instance.countSourceRows();e<n;e++)a[e].splice(i[0],t),0===e&&this.metaManager.removeColumn(i[0],t);else for(let e=0,t=this.instance.countSourceRows();e<t;e++)for(let t=0;t<l;t++)a[e].splice(s[t],1),0===e&&this.metaManager.removeColumn(s[t],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(i),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,t,i,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,n){const o=this.instance.getDataAtCol(e),i=o.slice(t,t+n),s=o.slice(t+n);for(var r=arguments.length,l=new Array(r>3?r-3:0),a=3;a<r;a++)l[a-3]=arguments[a];Yl(l,s);let h=0;for(;h<n;)l.push(null),h+=1;return zl(l),this.instance.populateFromArray(t,e,l,null,null,"spliceCol"),i}spliceRow(e,t,n){const o=this.instance.getSourceDataAtRow(e),i=o.slice(t,t+n),s=o.slice(t+n);for(var r=arguments.length,l=new Array(r>3?r-3:0),a=3;a<r;a++)l[a-3]=arguments[a];Yl(l,s);let h=0;for(;h<n;)l.push(null),h+=1;return this.instance.populateFromArray(e,t,[l],null,null,"spliceRow"),i}spliceData(e,t,n){if(!1!==this.instance.runHooks("beforeDataSplice",e,t,n)){const t=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,t.forEach((e=>this.dataSource.push(e)))}}filterData(e,t,n){let o=this.instance.runHooks("filterData",e,t,n);!1===Array.isArray(o)&&(o=this.dataSource.filter(((e,t)=>-1===n.indexOf(t)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(e,t){const n=this.instance.toPhysicalRow(e);let o=this.dataSource[n];const i=this.instance.runHooks("modifyRowData",n);o=isNaN(i)?i:o;let s=null;if(o&&o.hasOwnProperty&&Cc(o,t))s=o[t];else if("string"==typeof t&&t.indexOf(".")>-1){const e=t.split(".");let n=o;if(!n)return null;for(let t=0,o=e.length;t<o;t++)if(n=n[e[t]],void 0===n)return null;s=n}else"function"==typeof t&&(s=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){const e=wc(s);this.instance.runHooks("modifyData",n,this.propToCol(t),e,"get"),e.isTouched()&&(s=e.value)}return s}getCopyable(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const o=this.instance.toPhysicalRow(e);let i=n,s=this.dataSource[o];const r=this.instance.runHooks("modifyRowData",o);if(s=isNaN(r)?r:s,this.instance.hasHook("modifyData")){const e=wc(i);this.instance.runHooks("modifyData",o,this.propToCol(t),e,"set"),e.isTouched()&&(i=e.value)}if(s&&s.hasOwnProperty&&Cc(s,t))s[t]=i;else if("string"==typeof t&&t.indexOf(".")>-1){const e=t.split(".");let n,o=s,r=0;for(r=0,n=e.length-1;r<n;r++)void 0===o[e[r]]&&(o[e[r]]={}),o=o[e[r]];o[e[r]]=i}else"function"==typeof t?t(this.dataSource.slice(o,o+1)[0],i):s[t]=i}visualRowsToPhysical(e,t){const n=this.instance.countSourceRows(),o=[];let i,s=(n+e)%n,r=t;for(;s<n&&r;)i=this.instance.toPhysicalRow(s),o.push(i),r-=1,s+=1;return o}visualColumnsToPhysical(e,t){const n=this.instance.countCols(),o=[];let i=(n+e)%n,s=t;for(;i<n&&s;){const e=this.instance.toPhysicalColumn(i);o.push(e),s-=1,i+=1}return o}clear(){for(let e=0;e<this.instance.countSourceRows();e++)for(let t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;t=e<0||0===e?0:e||1/0;const n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row!=0||this.instance.countSourceRows()?this.getRange(e,t,cC.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const o=[];let i,s,r;const l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];const h=n===cC.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),u=Math.min(Math.max(a-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=c;i++){r=[];const n=i>=0?this.instance.toPhysicalRow(i):i;for(s=Math.min(e.col,t.col);s<=u&&null!==n;s++)r.push(h.call(this,i,this.colToProp(s)));null!==n&&o.push(r)}return o}getText(e,t){return hC(this.getRange(e,t,cC.DESTINATION_RENDERER))}getCopyableText(e,t){return hC(this.getRange(e,t,cC.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var uC=cC;const{register:dC,getItem:gC,hasItem:fC,getNames:mC,getValues:pC}=iu("cellTypes");function wC(e){if(!fC(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return gC(e)}function CC(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);const{editor:n,renderer:o,validator:i}=t;n&&fu(e,n),o&&ed(e,o),i&&ld(e,i),dC(e,t)}function yC(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const o="string"==typeof t.type?wC(t.type):t.type;if(e._automaticallyAssignedMetaProps&&gc(t,((t,n)=>{e._automaticallyAssignedMetaProps.delete(n)})),!uc(o))return;n!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);const i={};gc(o,((t,o)=>{var s;(function(e,t){var n;return"CELL_TYPE"!==e&&((null===(n=t._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(e))||!Cc(t,e))})(o,n)&&(i[o]=t,null===(s=e._automaticallyAssignedMetaProps)||void 0===s||s.add(o))})),sc(e,i)}function vC(e){return Number.isInteger(e)&&e>=0}function bC(e,t){if(!e())throw new Error(`Assertion failed: ${t}`)}function SC(e){return null==e}var RC=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol(e){let t,n,o;for(t=0,n=this.countRows();t<n;t++)if(o=this.getDataAtCell(t,e),!1===ra(o))return!1;return!0},isEmptyRow(e){let t,n,o,i;for(t=0,n=this.countCols();t<n;t++)if(o=this.getDataAtCell(e,t),!1===ra(o))return"object"==typeof o&&(i=this.getCellMeta(e,t),cc(this.getSchema()[i.prop],o));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});class EC{constructor(e){this.metaCtor=class{},this.meta=this.metaCtor.prototype,sc(this.meta,RC()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;sc(this.meta,e),yC(this.meta,{...e,type:null!==(t=e.type)&&void 0!==t?t:this.meta.type},e)}}class MC{constructor(e){const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){sc(this.meta,e),yC(this.meta,e,e)}}class TC{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){bC((()=>vC(e)),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],void 0===n&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const t=this.holes.values().next().value;this.holes.delete(t),this.data[t]=n,this.index[e]=t}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;bC((()=>vC(e)||SC(e)),"Expecting an unsigned number or null/undefined argument.");const n=[],o=this.data.length;for(let e=0;e<t;e++)n.push(o+e),this.data.push(void 0);const i=SC(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;bC((()=>vC(e)||SC(e)),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(SC(e)?this.index.length-t:e,t);for(let e=0;e<n.length;e++){const t=n[e];"number"==typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return Kl(this.data,((e,t)=>!this.holes.has(t)))[Symbol.iterator]()}entries(){const e=[];for(let t=0;t<this.data.length;t++){const n=this._getKeyByStorageIndex(t);-1!==n&&e.push([n,this.data[t]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}const xC=["data","width"];class OC{constructor(e){this.globalMeta=e,this.metas=new TC((()=>this._createMeta()))}updateMeta(e,t){const n=this.getMeta(e);sc(n,t),yC(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}ic(n,e);for(let e=0;e<t.length;e++)n.prototype[t[e]]=void 0;return n}(this.globalMeta.getMetaConstructor(),xC).prototype}}class AC{constructor(e){this.columnMeta=e,this.metas=new TC((()=>this._createRow()))}updateMeta(e,t,n){const o=this.getMeta(e,t);sc(o,n),yC(o,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const o=this.metas.obtain(e).obtain(t);return void 0===n?o:o[n]}setMeta(e,t,n,o){var i;const s=this.metas.obtain(e).obtain(t);null===(i=s._automaticallyAssignedMetaProps)||void 0===i||i.delete(n),s[n]=o}removeMeta(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)e.push(...t[n].values());return e}getMetasAtRow(e){bC((()=>vC(e)),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new TC((e=>this._createMeta(e)))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}class _C{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new EC(e),this.tableMeta=new MC(this.globalMeta),this.columnMeta=new OC(this.globalMeta),this.cellMeta=new AC(this.columnMeta),n.forEach((e=>new e(this))),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){let{visualRow:o,visualColumn:i}=n;const s=this.cellMeta.getMeta(e,t);return s.visualRow=o,s.visualCol=i,s.row=e,s.col=t,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,t,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,o){this.cellMeta.setMeta(e,t,n,o)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function IC(e,t,n,o){const{hotInstance:i,dataMap:s,dataSource:r,internalSource:l,source:a,metaManager:h,firstRun:c}=o,u=ya(l),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":vh(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),e=i.runHooks(`before${u}`,e,c,a);const g=new uC(i,e,h);if(t(g),"object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error(`${l} only accepts array of objects or array of arrays (${typeof e} given)`);{const t=g.getSchema();let n;e=[];let o=0,s=0;for(o=0,s=d.startRows;o<s;o++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)n=lc(t[0]),e.push(n);else{n=[];for(let e=0,t=d.startCols;e<t;e++)n.push(null);e.push(n)}else n=lc(t),e.push(n)}}Array.isArray(e[0])&&(i.dataType="array"),d.data=e,g.dataSource=e,r.data=e,r.dataType=i.dataType,r.colToProp=g.colToProp.bind(g),r.propToCol=g.propToCol.bind(g),r.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${u}`,e,c,a),c||(i.runHooks("afterChange",null,l),i.render())}hc(_C,hm);class kC{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",(e=>this.extendCellMeta(e))),nu.getSingleton().add("beforeRender",(e=>{e&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:o}=e;if(null!==(t=this.metaSyncMemo.get(n))&&void 0!==t&&t.has(o))return;const{visualRow:i,visualCol:s}=e,r=this.metaManager.hot,l=r.colToProp(s);e.prop=l,r.runHooks("beforeGetCellMeta",i,s,e);const a=Cc(e,"type")?e.type:null;let h=vh(e.cells)?e.cells(n,o,l):null;var c;a&&(h?h.type=null!==(c=h.type)&&void 0!==c?c:a:h={type:a});h&&this.metaManager.updateCellMeta(n,o,h),r.runHooks("afterGetCellMeta",i,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(o)}}class HC{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(e,t,n){if(!n)throw new Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((e,t)=>{const{target:n,onChange:o=()=>{}}=e,i="string"==typeof n,s=i?n:t,r=`_${s}`;this.metaManager.globalMeta.meta[r]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(t,r,o),i&&this.installPropWatcher(n,r,o)}))}installPropWatcher(e,t,n){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const s=!o.usageTracker.has(e);o.usageTracker.add(e),n.call(o,e,i,s),this[t]=i},enumerable:!0,configurable:!0})}}const DC=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),NC=e=>e.map((e=>{const t=e.toLowerCase();return DC.has(t)?DC.get(t):t})).sort().join("+"),PC=e=>e.toLowerCase();const LC=["meta","alt","shift","control"],VC=function(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed:t=>e.has(t)}}();const FC=e=>{let{ownerWindow:t,handleEvent:n,beforeKeyDown:o,afterKeyDown:i}=e;const s=Fu({errorIdExists:e=>`The "${e}" context name is already registered.`});let r="grid";const l=()=>r,a=e=>s.getItem(e);let h=!1;const c=function(e,t,n,o,i){const s=e=>LC.includes(e),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},l=e=>{if(!1===t(e))return;const l=n(e);if(229===e.keyCode||!1===l||zc(e))return;const a=PC(e.key);let h=[];s(a)?VC.press(a):h=r(e);const c=[a].concat(h);!i(e,c)&&(Dc()&&h.includes("meta")||!Dc()&&h.includes("control"))&&i(e,[a].concat(r(e,!0))),o(e)},a=e=>{if(!1===t(e))return;const n=PC(e.key);!1!==s(n)&&VC.release(n)},h=()=>{VC.releaseAll()};return{mount:()=>{let t=e;for(;t;)t.document.documentElement.addEventListener("keydown",l),t.document.documentElement.addEventListener("keyup",a),t.document.documentElement.addEventListener("blur",h),t=Oa(t)},unmount:()=>{let t=e;for(;t;)t.document.documentElement.removeEventListener("keydown",l),t.document.documentElement.removeEventListener("keyup",a),t.document.documentElement.removeEventListener("blur",h),t=Oa(t)},isPressed:e=>VC.isPressed(e),releasePressedKeys:()=>VC.releaseAll()}}(t,n,o,i,((e,t)=>{const n=a(l());let o=!1;if(!n.hasShortcut(t))return o;const i=n.getShortcuts(t);for(let n=0;n<i.length;n++){const{callback:s,runOnlyIf:r,preventDefault:l,stopPropagation:a,captureCtrl:c}=i[n];if(!1!==r(e)&&(h=c,o=!1===s(e,t),h=!1,l&&e.preventDefault(),a&&e.stopPropagation(),o))break}return o}));return c.mount(),{addContext:e=>{const t=(e=>{const t=Fu({errorIdExists:t=>`The "${t}" shortcut is already registered in the "${e}" context.`}),n=function(){let{keys:e,callback:n,group:o,runOnlyIf:i=()=>!0,captureCtrl:s=!1,preventDefault:r=!0,stopPropagation:l=!1,relativeToGroup:a,position:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(sa(o))throw new Error("You need to define the shortcut's group.");if(!1===vh(n))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error(na`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const c={callback:n,group:o,runOnlyIf:i,captureCtrl:s,preventDefault:r,stopPropagation:l};ia(a)&&([c.relativeToGroup,c.position]=[a,h]),e.forEach((e=>{const n=NC(e);if(t.hasItem(n)){const e=t.getItem(n);let o=e.findIndex((e=>e.group===a));-1!==o?"before"===h?o-=1:o+=1:o=e.length,e.splice(o,0,c)}else t.addItem(n,[c])}))},o=e=>{const n=NC(e);t.removeItem(n)};return{addShortcut:n,addShortcuts:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((e=>{gc(t,((n,o)=>{!1===Object.prototype.hasOwnProperty.call(e,o)&&(e[o]=t[o])})),n(e)}))},getShortcuts:e=>{const n=NC(e),o=t.getItem(n);return ia(o)?o.slice():[]},hasShortcut:e=>{const n=NC(e);return t.hasItem(n)},removeShortcutsByKeys:o,removeShortcutsByGroup:e=>{t.getItems().forEach((t=>{let[n,i]=t;const s=i.filter((t=>t.group!==e));0===s.length?o((e=>e.split("+"))(n)):(i.length=0,i.push(...s))}))}}})(e);return s.addItem(e,t),t},getActiveContextName:l,getContext:a,setActiveContextName:e=>{r=e},isCtrlPressed:()=>!h&&(c.isPressed("control")||c.isPressed("meta")),releasePressedKeys:()=>c.releasePressedKeys(),destroy:()=>c.unmount()}};let BC=null;function WC(e,t){var n;let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1,s=this;const r=new pu(s);let l,a,h,c,u=!0;var d;jf(o)&&(d=this,Wf.set(d,!0)),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=null!==(n=null==t?void 0:t.layoutDirection)&&void 0!==n?n:"inherit",f=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",f),this.isRtl=function(){return"rtl"===f},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},t.language=function(e){let t=$m(e);return kw(t)||(t=Mw,Gm(e)),t}(t.language);const m=new _C(s,t,[kC,HC]),p=m.getTableMeta(),w=m.getGlobalMeta(),C=Fu();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),zf(this)&&wa(t.licenseKey,e),this.guid=`ht_${va()}`,this.columnIndexMapper=new Ym,this.rowIndexMapper=new Ym,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(e=>{s.runHooks("afterColumnSequenceChange",e)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(e=>{s.runHooks("afterRowSequenceChange",e)})),a=new lm(s),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);const y=e=>{const{row:t,col:n}=e;return s._createCellCoords(t>=0?s.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?s.columnIndexMapper.getRenderableFromVisualIndex(n):n)};let v=new sC(p,{rowIndexMapper:()=>s.rowIndexMapper,columnIndexMapper:()=>s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:e=>l.propToCol(e),isEditorOpened:()=>!!s.getActiveEditor()&&s.getActiveEditor().isOpened(),countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(e,t)=>s._createCellCoords(e,t),createCellRange:(e,t,n)=>s._createCellRange(e,t,n),visualToRenderableCoords:y,renderableToVisualCoords:e=>{const{row:t,col:n}=e;return s._createCellCoords(t>=0?s.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?s.columnIndexMapper.getVisualFromRenderableIndex(n):n)},isDisabledCellSelection:(e,t)=>s.getCellMeta(e,t).disableVisualSelection});this.selection=v;const b=e=>{let{hiddenIndexesChanged:t}=e;t&&this.selection.refresh()};function S(e){const t=$m(e);kw(t)?(s.runHooks("beforeLanguageChange",t),w.language=t,s.runHooks("afterLanguageChange",t)):Gm(e)}function R(e,t){const n="className"===e?s.rootElement:s.table;if(u)Pa(n,t);else{let o=[],i=[];w[e]&&(o=Array.isArray(w[e])?w[e]:ea(w[e])),t&&(i=Array.isArray(t)?t:ea(t));const s=Ql(o,i),r=Ql(i,o);s.length&&La(n,s),r.length&&Pa(n,r)}w[e]=t}function E(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function M(e){const t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function T(e,t,n){if(!e.length)return;const o=s.getActiveEditor(),i=new E;let r=!0;i.onQueueEmpty=e=>{o&&r&&o.cancelChanges(),n(e)};for(let n=e.length-1;n>=0;n--){const[o,a,,h]=e[n],c=l.propToCol(a),u=s.getCellMeta(o,c);"numeric"===u.type&&"string"==typeof h&&Au(h)&&(e[n][3]=M(h)),s.getCellValidator(u)&&(i.addValidatorToQueue(),s.validateCell(e[n][3],u,function(t,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");if(!1===o&&!1===n.allowInvalid){r=!1,e.splice(t,1),n.valid=!0;const o=s.getCell(n.visualRow,n.visualCol);null!==o&&La(o,p.invalidCellClassName)}i.removeValidatorFormQueue()}}(n,u),t))}i.checkIfQueueIsEmpty()}function x(e,t){let n=e.length-1;if(n<0)return;for(;n>=0;n--){let o=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(p.allowInsertRow)for(;e[n][0]>s.countRows()-1;){const{delta:e}=l.createRow(void 0,void 0,{source:t});if(0===e){o=!0;break}}if("array"===s.dataType&&(!p.columns||0===p.columns.length)&&p.allowInsertColumn)for(;l.propToCol(e[n][1])>s.countCols()-1;){const{delta:e}=l.createCol(void 0,void 0,{source:t});if(0===e){o=!0;break}}o||l.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}s.forceFullRender=!0,h.adjustRowsAndCols(),s.runHooks("beforeChangeRender",e,t),c.lockEditor(),s._refreshBorders(null),c.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",e,t||"edit");const o=s.getActiveEditor();o&&ia(o.refreshValue)&&o.refreshValue()}function O(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}function A(e,t){const n=s.getActiveEditor(),o=s.runHooks("beforeChange",e,t||"edit"),i=e.filter((e=>null!==e));return!1===o||0===i.length?(n&&n.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",b),this.rowIndexMapper.addLocalHook("cacheUpdated",b),this.selection.addLocalHook("beforeSetRangeStart",(e=>{this.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(e=>{this.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(e=>{this.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=this.view._wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=this.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(e=>{const t=wc(!1),n=this.selection.getSelectedRange(),{from:o,to:r}=n.current(),l=n.size()-1;this.runHooks("afterSelection",o.row,o.col,r.row,r.col,t,l),this.runHooks("afterSelectionByProp",o.row,s.colToProp(o.col),r.row,s.colToProp(r.col),t,l);const a=this.selection.isSelectedByAnyHeader(),h=this.selection.selectedRange.current();let c=!0;i&&(c=!1),t.isTouched()&&(c=!t.value);const u=this.selection.isSelectedByRowHeader(),d=this.selection.isSelectedByColumnHeader();!1!==c&&(a?u?this.view.scrollViewportVertically(s.rowIndexMapper.getRenderableFromVisualIndex(e.row)):d&&this.view.scrollViewportHorizontally(s.columnIndexMapper.getRenderableFromVisualIndex(e.col)):h&&!this.selection.isMultiple()?this.view.scrollViewport(y(h.from)):this.view.scrollViewport(y(e))),u&&d?Pa(this.rootElement,["ht__selection--rows","ht__selection--columns"]):u?(La(this.rootElement,"ht__selection--columns"),Pa(this.rootElement,"ht__selection--rows")):d?(La(this.rootElement,"ht__selection--rows"),Pa(this.rootElement,"ht__selection--columns")):La(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(e=>{const t=e.length-1,{from:n,to:o}=e[t];this.runHooks("afterSelectionEnd",n.row,n.col,o.row,o.col,t),this.runHooks("afterSelectionEndByProp",n.row,s.colToProp(n.col),o.row,s.colToProp(o.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(e=>{const t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(e=>{this.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",((e,t,n)=>{this.runHooks("afterModifyTransformStart",e,t,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(e=>{this.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",((e,t,n)=>{this.runHooks("afterModifyTransformEnd",e,t,n)})),this.selection.addLocalHook("afterDeselect",(()=>{c.destroyEditor(),this._refreshBorders(),La(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(e=>{this.alter("insert_row_above",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(e=>{this.alter("insert_col_start",e,1,"auto")})),h={alter(e,t){var n,o;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const c=e=>{if(0===e.length)return[];const t=[...e];t.sort(((e,t)=>{let[n]=e,[o]=t;return n===o?0:n>o?1:-1}));return Gl(t,((e,t)=>{let[n,o]=t;const i=e[e.length-1],[s,r]=i,l=s+r;if(n<=l){const e=Math.max(o-(l-n),0);i[1]+=e}else e.push([n,o]);return e}),[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":const a=s.countSourceRows();if(p.maxRows===a)return;const u="insert_row_below"===e?"below":"above";t=null!==(n=t)&&void 0!==n?n:"below"===u?a:0;const{delta:d,startPhysicalIndex:g}=l.createRow(t,i,{source:r,mode:u});if(d){const e=v.selectedRange.current(),t=null==e?void 0:e.from,n=null==t?void 0:t.row,o=s.toVisualRow(g);if(v.isSelectedByCorner())s.selectAll();else if(ia(n)&&n>=o){const{row:o,col:i}=e.to;let r=t.col;v.isSelectedByRowHeader()&&(r=-1),v.getSelectedRange().pop(),v.setRangeStartOnly(s._createCellCoords(n+d,r),!0),v.setRangeEnd(s._createCellCoords(o+d,i))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const f="insert_col_end"===e?"end":"start";t=null!==(o=t)&&void 0!==o?o:"end"===f?s.countSourceCols():0;const{delta:m,startPhysicalIndex:w}=l.createCol(t,i,{source:r,mode:f});if(m){if(Array.isArray(p.colHeaders)){const e=[s.toVisualColumn(w),0];e.length+=m,Array.prototype.splice.apply(p.colHeaders,e)}const e=v.selectedRange.current(),t=null==e?void 0:e.from,n=null==t?void 0:t.col,o=s.toVisualColumn(w);if(v.isSelectedByCorner())s.selectAll();else if(ia(n)&&n>=o){const{row:o,col:i}=e.to;let r=t.row;v.isSelectedByColumnHeader()&&(r=-1),v.getSelectedRange().pop(),v.setRangeStartOnly(s._createCellCoords(r,n+m),!0),v.setRangeEnd(s._createCellCoords(o,i+m))}else s._refreshBorders()}break;case"remove_row":const C=e=>{let t=0;Xl(e,(e=>{let[n,o]=e;const i=ra(n)?s.countRows()-1:Math.max(n-t,0);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!l.removeRow(n,o,r))return;const a=s.countRows(),h=p.fixedRowsTop;h>=i+1&&(p.fixedRowsTop-=Math.min(o,h-i));const c=p.fixedRowsBottom;c&&i>=a-c&&(p.fixedRowsBottom-=Math.min(o,c)),t+=o}))};Array.isArray(t)?C(c(t)):C([[t,i]]),h.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const y=e=>{let t=0;Xl(e,(e=>{let[n,o]=e;const i=ra(n)?s.countCols()-1:Math.max(n-t,0);let a=s.toPhysicalColumn(i);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!l.removeCol(n,o,r))return;const h=p.fixedColumnsStart;h>=i+1&&(p.fixedColumnsStart-=Math.min(o,h-i)),Array.isArray(p.colHeaders)&&(void 0===a&&(a=-1),p.colHeaders.splice(a,o)),t+=o}))};Array.isArray(t)?y(c(t)):y([[t,i]]),h.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${e}"`)}a||h.adjustRowsAndCols()},adjustRowsAndCols(){const e=p.minRows,t=p.minSpareRows,n=p.minCols,o=p.minSpareCols;if(0===s.countRows()&&0===s.countCols()&&v.deselect(),e){const t=s.countRows();t<e&&l.createRow(t,e-t,{source:"auto"})}if(t){const e=s.countEmptyRows(!0);if(e<t){const n=t-e,o=Math.min(n,p.maxRows-s.countSourceRows());l.createRow(s.countRows(),o,{source:"auto"})}}{let e;(n||o)&&(e=s.countEmptyCols(!0));let t=s.countCols();if(n&&!p.columns&&t<n){const o=n-t;e+=o,l.createCol(t,o,{source:"auto"})}if(o&&!p.columns&&"array"===s.dataType&&e<o){t=s.countCols();const n=o-e,i=Math.min(n,p.maxCols-t);l.createCol(t,i,{source:"auto"})}}if(v.isSelected()){const e=s.countRows(),t=s.countCols();Xl(v.selectedRange,(n=>{let o=!1,i=n.from.row,r=n.from.col,l=n.to.row,a=n.to.col;i>e-1?(i=e-1,o=!0,l>i&&(l=i)):l>e-1&&(l=e-1,o=!0,i>l&&(i=l)),r>t-1?(r=t-1,o=!0,a>r&&(a=r)):a>t-1&&(a=t-1,o=!0,r>a&&(r=a)),o&&s.selectCell(i,r,l,a)}))}s.view&&s.view.adjustElementsSize()},populateFromArray(e,t,n,o,i){let r,l,a,h;const c=[],u={},d=[],g=e.row,f=e.col;if(l=t.length,0===l)return!1;let m=0,w=0;switch(uc(n)&&(m=n.col-f+1,w=n.row-g+1),i){case"shift_down":const i=$l(t),C=i.length,y=Math.max(C,m),v=s.getData().slice(g),b=$l(v).slice(f,f+y);for(a=0;a<y;a+=1)if(a<C){for(r=0,l=i[a].length;r<w-l;r+=1)i[a].push(i[a][r%l]);a<b.length?d.push(i[a].concat(b[a])):d.push(i[a].concat(new Array(v.length).fill(null)))}else d.push(i[a%C].concat(b[a]));s.populateFromArray(g,f,$l(d));break;case"shift_right":const S=t.length,R=Math.max(S,w),E=s.getData().slice(g).map((e=>e.slice(f)));for(r=0;r<R;r+=1)if(r<S){for(a=0,h=t[r].length;a<m-h;a+=1)t[r].push(t[r][a%h]);if(r<E.length)for(let e=0;e<E[r].length;e+=1)t[r].push(E[r][e]);else t[r].push(...new Array(E[0].length).fill(null))}else t.push(t[r%l].slice(0,R).concat(E[r]));s.populateFromArray(g,f,t);break;default:u.row=e.row,u.col=e.col;let M,T=0,x=0,O=!0;const A=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=t[e%t.length];return null!==n?o[n%o.length]:o},_=t.length,I=n?n.row-e.row+1:0;for(l=n?I:Math.max(_,I),r=0;r<l&&!(n&&u.row>n.row&&I>_||!p.allowInsertRow&&u.row>s.countRows()-1||u.row>=p.maxRows);r++){const t=r-T,i=A(t).length,d=n?n.col-e.col+1:0;if(h=n?d:Math.max(i,d),u.col=e.col,M=s.getCellMeta(u.row,u.col),"CopyPaste.paste"!==o&&"Autofill.fill"!==o||!M.skipRowOnPaste){for(x=0,a=0;a<h&&!(n&&u.col>n.col&&d>i||!p.allowInsertColumn&&u.col>s.countCols()-1||u.col>=p.maxCols);a++){if(M=s.getCellMeta(u.row,u.col),("CopyPaste.paste"===o||"Autofill.fill"===o)&&M.skipColumnOnPaste){x+=1,u.col+=1,h+=1;continue}if(M.readOnly&&"UndoRedo.undo"!==o){u.col+=1;continue}let e=A(t,a-x),n=s.getDataAtCell(u.row,u.col);if(null!==e&&"object"==typeof e)if(Array.isArray(e)&&null===n&&(n=[]),null===n||"object"!=typeof n)O=!1;else{const t=oc(Array.isArray(n)?n:n[0]||n),o=oc(Array.isArray(e)?e:e[0]||e);cc(t,o)||Array.isArray(t)&&Array.isArray(o)?e=lc(e):O=!1}else null!==n&&"object"==typeof n&&(O=!1);O&&c.push([u.row,u.col,e]),O=!0,u.col+=1}u.row+=1}else T+=1,u.row+=1,l+=1}s.setDataAtCell(c,null,null,o||"populateFromArray")}}},this.init=function(){a.setData(p.data),s.runHooks("beforeInit"),(_c()||kc())&&Pa(s.rootElement,"mobile"),this.updateSettings(p,!0),this.view=new Qf(this),c=bu.getInstance(s,p,v),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),u&&null===s.rootElement.offsetParent&&Ch(s.rootElement,(()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()})),"object"==typeof u&&(s.runHooks("afterChange",u[0],u[1]),u=!1),s.runHooks("afterInit")},this._createCellCoords=function(e,t){return s.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return s.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,o){let i=s.getCellValidator(t);function r(e){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===t.hidden)return void n(e);const o=t.visualCol,i=t.visualRow,r=s.getCell(i,o,!0);if(r&&"TH"!==r.nodeName){const e=s.rowIndexMapper.getRenderableFromVisualIndex(i),t=s.columnIndexMapper.getRenderableFromVisualIndex(o);s.view._wt.getSetting("cellRenderer",e,t,r)}n(e)}var l;la(i)&&(l=i,i=function(e,t){t(l.test(e))}),vh(i)?(e=s.runHooks("beforeValidate",e,t.visualRow,t.prop,o),s._registerImmediate((()=>{i.call(t,e,(n=>{s&&(n=s.runHooks("afterValidate",n,e,t.visualRow,t.prop,o),t.valid=n,r(n),s.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,o))}))}))):s._registerImmediate((()=>{t.valid=!0,r(t.valid,!1)}))},this.setDataAtCell=function(e,t,n,o){const i=O(e,t,n),r=[];let h,c,u,d=o;for(h=0,c=i.length;h<c;h++){if("object"!=typeof i[h])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof i[h][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=i[h][1]>=this.countCols()?i[h][1]:l.colToProp(i[h][1]),r.push([i[h][0],u,a.getAtCell(this.toPhysicalRow(i[h][0]),i[h][1]),i[h][2]])}d||"object"!=typeof e||(d=t);const g=A(r,o);s.runHooks("afterSetDataAtCell",g,d),T(g,d,(()=>{x(g,d)}))},this.setDataAtRowProp=function(e,t,n,o){const i=O(e,t,n),r=[];let l,h,c=o;for(l=0,h=i.length;l<h;l++)r.push([i[l][0],i[l][1],a.getAtCell(this.toPhysicalRow(i[l][0]),i[l][1]),i[l][2]]);c||"object"!=typeof e||(c=t);const u=A(r,o);s.runHooks("afterSetDataAtRowProp",u,c),T(u,c,(()=>{x(u,c)}))},this.listen=function(){s&&!s.isListening()&&(BC=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(BC=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return BC===s.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];s._refreshBorders(e,t)},this.populateFromArray=function(e,t,n,o,i,r,l){if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"==typeof o?s._createCellCoords(o,i):null;return h.populateFromArray(s._createCellCoords(e,t),n,a,r,l)},this.spliceCol=function(e,t,n){for(var o=arguments.length,i=new Array(o>3?o-3:0),s=3;s<o;s++)i[s-3]=arguments[s];return l.spliceCol(e,t,n,...i)},this.spliceRow=function(e,t,n){for(var o=arguments.length,i=new Array(o>3?o-3:0),s=3;s<o;s++)i[s-3]=arguments[s];return l.spliceRow(e,t,n,...i)},this.getSelected=function(){if(v.isSelected())return ql(v.getSelectedRange(),(e=>{let{from:t,to:n}=e;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){const e=this.getSelected();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(v.isSelected())return Array.from(v.getSelectedRange())},this.getSelectedRangeLast=function(){const e=this.getSelectedRange();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(e){if(!v.isSelected()||0===this.countRows()||0===this.countCols())return;const t=[];Xl(v.getSelectedRange(),(e=>{const n=e.getTopStartCorner(),o=e.getBottomEndCorner();_u(n.row,o.row,(e=>{_u(n.col,o.col,(n=>{this.getCellMeta(e,n).readOnly||t.push([e,n,null])}))}))})),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(e){this.suspendRender();const t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();const t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!s.view)return;const{width:e,height:t}=s.view.getLastSize(),{width:n,height:o}=s.rootElement.getBoundingClientRect(),i=n!==e||o!==t;!1===s.runHooks("beforeRefreshDimensions",{width:e,height:t},{width:n,height:o},i)||((i||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(n,o),s.render()),s.runHooks("afterRefreshDimensions",{width:e,height:t},{width:n,height:o},i))},this.updateData=function(e,t){IC(e,(e=>{l=e}),(e=>{l=e,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols()}),{hotInstance:s,dataMap:l,dataSource:a,internalSource:"updateData",source:t,metaManager:m,firstRun:u})},this.loadData=function(e,t){IC(e,(e=>{l=e}),(()=>{m.clearCellsCache(),s.initIndexMappers(),h.adjustRowsAndCols(),u&&(u=[null,"loadData"])}),{hotInstance:s,dataMap:l,dataSource:a,internalSource:"loadData",source:t,metaManager:m,firstRun:u})},this.getInitialColumnCount=function(){const e=p.columns;let t=0;if(Array.isArray(e))t=e.length;else if(vh(e))if("array"===s.dataType){const n=this.countSourceCols();for(let o=0;o<n;o+=1)e(o)&&(t+=1)}else"object"!==s.dataType&&"function"!==s.dataType||(t=l.colToPropCache.length);else if(ia(p.dataSchema)){const e=l.getSchema();t=Array.isArray(e)?e.length:pc(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,o){return sa(e)?l.getAll():l.getRange(s._createCellCoords(e,t),s._createCellCoords(n,o),l.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,o){return l.getCopyableText(s._createCellCoords(e,t),s._createCellCoords(n,o))},this.getCopyableData=function(e,t){return l.getCopyable(e,l.colToProp(t))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(u?s.loadData:s.updateData).bind(this);let o,i,r=!1;if(ia(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ia(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ia(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(o in e)"data"===o||("language"===o?S(e.language):"className"===o?R("className",e.className):"tableClassName"===o&&s.table?(R("tableClassName",e.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):nu.getSingleton().isRegistered(o)||nu.getSingleton().isDeprecated(o)?(vh(e[o])||Array.isArray(e[o]))&&(e[o].initialHook=!0,s.addHook(o,e[o])):!t&&Cc(e,o)&&(w[o]=e[o]));void 0===e.data&&void 0===p.data?n(null,"updateSettings"):void 0!==e.data?n(e.data,"updateSettings"):void 0!==e.columns&&(l.createMap(),s.initIndexMappers());const a=s.countCols(),d=p.columns;if(d&&vh(d)&&(r=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||m.clearCache(),a>0)for(o=0,i=0;o<a;o++){if(d){const e=r?d(o):d[i];e&&m.updateColumnMeta(i,e)}i+=1}ia(e.cell)&&gc(e.cell,(e=>{s.setCellMetaObject(e.row,e.col,e)})),s.runHooks("afterCellMetaReset");let g=s.rootElement.style.height;""!==g&&(g=parseInt(s.rootElement.style.height,10));let f=e.height;if(vh(f)&&(f=f()),t){s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"))}if(null===f){const e=s.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",e):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else void 0!==f&&(s.rootElement.style.height=isNaN(f)?`${f}`:`${f}px`,s.rootElement.style.overflow="hidden");if(void 0!==e.width){let t=e.width;vh(t)&&(t=t()),s.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}t||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",e)),h.adjustRowsAndCols(),s.view&&!u&&(s.forceFullRender=!0,c.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),t||!s.view||""!==g&&""!==f&&void 0!==f||g===f||s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const e=s.getSelectedLast();if(p.getValue){if(vh(p.getValue))return p.getValue.call(s);if(e)return s.getData()[e[0][0]][p.getValue]}else if(e)return s.getDataAtCell(e[0],e[1])},this.getSettings=function(){return p},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,o,i){h.alter(e,t,n,o,i)},this.getCell=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t,i=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;o=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===i||null===o?null:s.view.getCellAtCoords(s._createCellCoords(i,o),n)},this.getCoords=function(e){const t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;const{row:n,col:o}=t;let i=n,r=o;return n>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(n)),o>=0&&(r=this.columnIndexMapper.getVisualFromRenderableIndex(o)),s._createCellCoords(i,r)},this.colToProp=function(e){return l.colToProp(e)},this.propToCol=function(e){return l.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return l.get(e,l.colToProp(t))},this.getDataAtRowProp=function(e,t){return l.get(e,t)},this.getDataAtCol=function(e){const t=[],n=l.getRange(s._createCellCoords(0,e),s._createCellCoords(p.data.length-1,e),l.DESTINATION_RENDERER);for(let e=0;e<n.length;e+=1)for(let o=0;o<n[e].length;o+=1)t.push(n[e][o]);return t},this.getDataAtProp=function(e){const t=[],n=l.getRange(s._createCellCoords(0,l.propToCol(e)),s._createCellCoords(p.data.length-1,l.propToCol(e)),l.DESTINATION_RENDERER);for(let e=0;e<n.length;e+=1)for(let o=0;o<n[e].length;o+=1)t.push(n[e][o]);return t},this.getSourceData=function(e,t,n,o){let i;return i=void 0===e?a.getData():a.getByRange(s._createCellCoords(e,t),s._createCellCoords(n,o)),i},this.getSourceDataArray=function(e,t,n,o){let i;return i=void 0===e?a.getData(!0):a.getByRange(s._createCellCoords(e,t),s._createCellCoords(n,o),!0),i},this.getSourceDataAtCol=function(e){return a.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,o){const i=O(e,t,n),r=this.hasHook("afterSetSourceDataAtCell"),l=[];r&&Xl(i,(e=>{let[t,n,o]=e;l.push([t,n,a.getAtCell(t,n),o])})),Xl(i,(e=>{let[t,n,o]=e;a.setAtCell(t,n,o)})),r&&this.runHooks("afterSetSourceDataAtCell",l,o),this.render();const h=s.getActiveEditor();h&&ia(h.refreshValue)&&h.refreshValue()},this.getSourceDataAtRow=function(e){return a.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return a.getAtCell(e,t)},this.getDataAtRow=function(e){return l.getRange(s._createCellCoords(e,0),s._createCellCoords(e,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,o){const i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,o],[s,r]=i;let[,,l,a]=i,h=null,c=null;void 0===l&&(l=s),void 0===a&&(a=r);let u="mixed";return _u(Math.max(Math.min(s,l),0),Math.max(s,l),(e=>{let t=!0;return _u(Math.max(Math.min(r,a),0),Math.max(r,a),(n=>{const o=this.getCellMeta(e,n);return c=o.type,h?t=h===c:h=c,t})),u=t?c:"mixed",t})),u},this.removeCellMeta=function(e,t,n){const[o,i]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)];let r=m.getCellMetaKeyValue(o,i,n);!1!==s.runHooks("beforeRemoveCellMeta",e,t,n,r)&&(m.removeCellMeta(o,i,n),s.runHooks("afterRemoveCellMeta",e,t,n,r)),r=null},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&m.removeRow(this.toPhysicalRow(e),t),o.length>0&&Xl(o.reverse(),(t=>{m.createRow(this.toPhysicalRow(e)),Xl(t,((t,n)=>this.setCellMetaObject(e,n,t)))})),s.render()},this.setCellMetaObject=function(e,t,n){"object"==typeof n&&gc(n,((n,o)=>{this.setCellMeta(e,t,o,n)}))},this.setCellMeta=function(e,t,n,o){if(!1===s.runHooks("beforeSetCellMeta",e,t,n,o))return;let i=e,r=t;e<this.countRows()&&(i=this.toPhysicalRow(e)),t<this.countCols()&&(r=this.toPhysicalColumn(t)),m.setCellMeta(i,r,n,o),s.runHooks("afterSetCellMeta",e,t,n,o)},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(e,t){let n=this.toPhysicalRow(e),o=this.toPhysicalColumn(t);return null===n&&(n=e),null===o&&(o=t),m.getCellMeta(n,o,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return m.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===s.dataType||p.columns)},this.getCellRenderer=function(e,t){const n="number"==typeof e?s.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof n?Qu(n):sa(n)?Qu("text"):n},this.getCellEditor=function(e,t){const n="number"==typeof e?s.getCellMeta(e,t).editor:e.editor;return"string"==typeof n?gu(n):sa(n)?gu("text"):n},this.getCellValidator=function(e,t){const n="number"==typeof e?s.getCellMeta(e,t).validator:e.validator;return"string"==typeof n?rd(n):n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){const o=new E;e&&(o.onQueueEmpty=e);let i=s.countRows()-1;for(;i>=0;){if(void 0!==t&&-1===t.indexOf(i)){i-=1;continue}let e=s.countCols()-1;for(;e>=0;)void 0===n||-1!==n.indexOf(e)?(o.addValidatorToQueue(),s.validateCell(s.getDataAtCell(i,e),s.getCellMeta(i,e),(e=>{if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(o.valid=!1),o.removeValidatorFormQueue()}),"validateCells"),e-=1):e-=1;i-=1}o.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=p.rowHeaders,n=e;return void 0!==n&&(n=s.runHooks("modifyRowHeader",n)),void 0===n?(t=[],_u(s.countRows()-1,(e=>{t.push(s.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:vh(t)?t=t(n):t&&"string"!=typeof t&&"number"!=typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!p.rowHeaders},this.hasColHeaders=function(){if(void 0!==p.colHeaders&&null!==p.colHeaders)return!!p.colHeaders;for(let e=0,t=s.countCols();e<t;e++)if(s.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=s.runHooks("modifyColHeader",e);if(void 0===n){const e=[],t=s.countCols();for(let n=0;n<t;n++)e.push(s.getColHeader(n));return e}let o=p.colHeaders;const i=s.toPhysicalColumn(n),r=function(e){const t=[],n=s.countCols();let o=0;for(;o<n;o++)vh(p.columns)&&p.columns(o)&&t.push(o);return t[e]}(i);return!1===p.colHeaders?o=null:p.columns&&vh(p.columns)&&p.columns(r)&&p.columns(r).title?o=p.columns(r).title:p.columns&&p.columns[i]&&p.columns[i].title?o=p.columns[i].title:Array.isArray(p.colHeaders)&&void 0!==p.colHeaders[i]?o=p.colHeaders[i]:vh(p.colHeaders)?o=p.colHeaders(i):p.colHeaders&&"string"!=typeof p.colHeaders&&"number"!=typeof p.colHeaders&&(o=tm(n)),o=s.runHooks("modifyColumnHeaderValue",o,e,t),o},this._getColWidthFromSettings=function(e){let t;if(e>=0){t=s.getCellMeta(0,e).width}if(void 0!==t&&t!==p.width||(t=p.colWidths),null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){let t=s._getColWidthFromSettings(e);return t=s.runHooks("modifyColWidth",t,e),void 0===t&&(t=jd.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){let t=p.rowHeights;if(null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){let t=s._getRowHeightFromSettings(e);return t=s.runHooks("modifyRowHeight",t,e),t},this.countSourceRows=function(){return a.countRows()},this.countSourceCols=function(){return a.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const e=p.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return Iu(s.countRows()-1,(n=>{if(s.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return Iu(s.countCols()-1,(n=>{if(s.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return p.isEmptyRow.call(s,e)},this.isEmptyCol=function(e){return p.isEmptyCol.call(s,e)},this.selectCell=function(e,t,n,o){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!sa(e)&&!sa(t)&&this.selectCells([[e,t,n,o]],i,s)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(i=!0);const n=v.selectCells(e);return n&&t&&s.listen(),i=!1,n},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return v.selectColumns(e,t)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return v.selectRows(e,t)},this.deselectCell=function(){v.deselect()},this.selectAll=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=e&&this.hasRowHeaders(),n=e&&this.hasColHeaders();i=!0,v.selectAll(t,n),i=!1};const _=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=!n,r=!o;let l=e,a=t;if(!(arguments.length>4&&void 0!==arguments[4])||arguments[4]){const n=Number.isInteger(e),o=Number.isInteger(t),i=n?_(this.rowIndexMapper,e):void 0,r=o?_(this.columnIndexMapper,t):void 0;if(null===i||null===r)return!1;l=n?s.rowIndexMapper.getRenderableFromVisualIndex(i):void 0,a=o?s.columnIndexMapper.getRenderableFromVisualIndex(r):void 0}const h=Number.isInteger(l),c=Number.isInteger(a);return h&&c?s.view.scrollViewport(s._createCellCoords(l,a),i,o,n,r):h&&!1===c?s.view.scrollViewportVertically(l,i,n):!(!c||!1!==h)&&s.view.scrollViewportHorizontally(a,o,r)},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),a&&a.destroy(),a=null,this.getShortcutManager().destroy(),m.clearCache(),zf(s)){const e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}Fa(s.rootElement),r.destroy(),c&&c.destroy(),s.batchExecution((()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),C.getItems().forEach((e=>{let[,t]=e;t.destroy()})),C.clear(),s.runHooks("afterDestroy")}),!0),nu.getSingleton().destroy(s),gc(s,((e,t,n)=>{var o;vh(e)?n[t]=(o=t,()=>{throw new Error(`The "${o}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(n[t]=null)})),s.isDestroyed=!0,l&&l.destroy(),l=null,h=null,v=null,c=null,s=null},this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(e){const t=ya(e);return"UndoRedo"===t?this.undoRedo:C.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(e)},this.getInstance=function(){return s},this.addHook=function(e,t){nu.getSingleton().add(e,t,s)},this.hasHook=function(e){return nu.getSingleton().has(e,s)||nu.getSingleton().has(e)},this.addHookOnce=function(e,t){nu.getSingleton().once(e,t,s)},this.removeHook=function(e,t){nu.getSingleton().remove(e,t,s)},this.runHooks=function(e,t,n,o,i,r,l){return nu.getSingleton().run(s,e,t,n,o,i,r,l)},this.getTranslatedPhrase=function(e,t){return Hw(p.language,e,t)},this.toHTML=()=>Eu(this),this.toTableElement=()=>{const e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",Eu(this)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){let t=e;"function"==typeof t&&(t=setTimeout(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){Xl(this.timeouts,(e=>{clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){Xl(this.immediates,(e=>{clearImmediate(e)}))},this._refreshBorders=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c.destroyEditor(e),s.view.render(),t&&v.isSelected()&&c.prepareEditor()},this.isRtl=function(){return"rtl"===s.rootWindow.getComputedStyle(s.rootElement).direction},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const I=FC({handleEvent(e){const t=s.isListening(),n=void 0!==(null==e?void 0:e.key);return t&&n},beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(e=>{!1===e.ctrlKey&&!1===e.metaKey&&I.releasePressedKeys()})),this.getShortcutManager=function(){return I};const k=I.addContext("grid"),H={runOnlyIf:()=>ia(s.getSelected())&&s.countRenderedRows()>0&&s.countRenderedCols()>0,group:"gridDefault"};I.setActiveContextName("grid"),k.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>{s.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:()=>{const e=s.getSelectedRange(),{row:t,col:n}=e[e.length-1].highlight,o=s.getDataAtCell(t,n),i=new Map;for(let r=0;r<e.length;r++)e[r].forAll(((e,r)=>{if(e>=0&&r>=0&&(e!==t||r!==n)){const{readOnly:t}=s.getCellMeta(e,r);t||i.set(`${e}x${r}`,[e,r,o])}}));s.setDataAtCell(Array.from(i.values()))},runOnlyIf:()=>s.getSelectedRangeLast().getCellsCount()>1},{keys:[["ArrowUp"]],callback:()=>{v.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>{v.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(0,1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:()=>{v.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:e,to:t}=s.getSelectedRangeLast(),n=s.rowIndexMapper.getNearestNotHiddenIndex(0,1);v.setRangeStart(e.clone()),v.setRangeEnd(s._createCellCoords(n,t.col))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>{v.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>{v.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:()=>{v.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:e,to:t}=s.getSelectedRangeLast(),n=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1);v.setRangeStart(e.clone()),v.setRangeEnd(s._createCellCoords(n,t.col))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>{v.transformStart(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>{const e=s.getSelectedRangeLast().highlight.row,t=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[s.countCols()-1,-1]:[0,1]);v.setRangeStart(s._createCellCoords(e,t))}},{keys:[["ArrowLeft","Shift"]],callback:()=>{v.transformEnd(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:e,to:t}=s.getSelectedRangeLast(),n=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[s.countCols()-1,-1]:[0,1]);v.setRangeStart(e.clone()),v.setRangeEnd(s._createCellCoords(t.row,n))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>{v.transformStart(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>{const e=s.getSelectedRangeLast().highlight.row,t=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[0,1]:[s.countCols()-1,-1]);v.setRangeStart(s._createCellCoords(e,t))}},{keys:[["ArrowRight","Shift"]],callback:()=>{v.transformEnd(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:e,to:t}=s.getSelectedRangeLast(),n=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[0,1]:[s.countCols()-1,-1]);v.setRangeStart(e.clone()),v.setRangeEnd(s._createCellCoords(t.row,n))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>{const e=parseInt(s.getSettings().fixedColumnsStart,10),t=s.getSelectedRangeLast().highlight.row,n=s.columnIndexMapper.getNearestNotHiddenIndex(e,1);v.setRangeStart(s._createCellCoords(t,n))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>{v.setRangeEnd(s._createCellCoords(v.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>{const e=parseInt(s.getSettings().fixedRowsTop,10),t=parseInt(s.getSettings().fixedColumnsStart,10),n=s.rowIndexMapper.getNearestNotHiddenIndex(e,1),o=s.columnIndexMapper.getNearestNotHiddenIndex(t,1);v.setRangeStart(s._createCellCoords(n,o))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>{v.setRangeStart(s._createCellCoords(s.getSelectedRangeLast().highlight.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>{v.setRangeEnd(s._createCellCoords(v.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>{const e=parseInt(s.getSettings().fixedRowsBottom,10),t=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-e-1,-1),n=s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1);v.setRangeStart(s._createCellCoords(t,n))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>{v.transformStart(-s.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:()=>{const{to:e}=s.getSelectedRangeLast(),t=Math.max(e.row-s.countVisibleRows(),0),n=s.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(null!==n){const t=s._createCellCoords(n,e.col),o=e.row-s.view.getFirstFullyVisibleRow(),i=Math.max(t.row-o,0);v.setRangeEnd(t),s.scrollViewportTo(i)}}},{keys:[["PageDown"]],callback:()=>{v.transformStart(s.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:()=>{const{to:e}=s.getSelectedRangeLast(),t=Math.min(e.row+s.countVisibleRows(),s.countRows()-1),n=s.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(null!==n){const t=s._createCellCoords(n,e.col),o=e.row-s.view.getFirstFullyVisibleRow(),i=Math.min(t.row-o,s.countRows()-1);v.setRangeEnd(t),s.scrollViewportTo(i)}}},{keys:[["Tab"]],callback:e=>{const t="function"==typeof p.tabMoves?p.tabMoves(e):p.tabMoves;v.transformStart(t.row,t.col,!0)}},{keys:[["Shift","Tab"]],callback:e=>{const t="function"==typeof p.tabMoves?p.tabMoves(e):p.tabMoves;v.transformStart(-t.row,-t.col)}}],H),Yu().forEach((e=>{const t=$u(e);C.addItem(e,new t(this))})),nu.getSingleton().run(s,"construct")}const UC={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){Xl(this._hooksStorage[e]||[],(t=>{this.hot.removeHook(e,t)}))},clearHooks(){gc(this._hooksStorage,((e,t)=>this.removeHooksByKey(t))),this._hooksStorage={}}};dc(UC,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var jC=UC;const zC=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),YC="baseEditor";class $C{static get EDITOR_TYPE(){return"base"}constructor(e){this.hot=e,this.instance=e,this.state=zC.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,o,i,s){this.TD=o,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=s,this.state=zC.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,o,i,s;if(t){const e=this.hot.getSelectedLast();n=Math.max(Math.min(e[0],e[2]),0),o=Math.max(Math.min(e[1],e[3]),0),i=Math.max(e[0],e[2]),s=Math.max(e[1],e[3])}else[n,o,i,s]=[this.row,this.col,null,null];const r=this.hot.runHooks("modifyGetCellCoords",n,o);Array.isArray(r)&&([n,o]=r);const l=this.hot.getShortcutManager().getContext("editor"),a={runOnlyIf:()=>ia(this.hot.getSelected()),group:YC};this.isInFullEditMode()&&l.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],a),this.hot.populateFromArray(n,o,e,i,s,"edit")}beginEditing(e,t){if(this.state!==zC.VIRGIN)return;const n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,i)),this.state=zC.EDITING,this.isInFullEditMode()){const t="string"==typeof e?e:oa(this.originalValue);this.setValue(t)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,n){let o;if(n){const e=this._closeCallback;this._closeCallback=t=>{e&&e(t),n(t),this.hot.view.render()}}if(this.isWaiting())return;const i=this.hot.getShortcutManager().getContext("editor");if(i.removeShortcutsByGroup(YC),i.removeShortcutsByGroup(wu),this.state!==zC.VIRGIN){if(this.state===zC.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();const n=this.getValue();o=this.cellProperties.trimWhitespace?[["string"==typeof n?String.prototype.trim.call(n||""):n]]:[[n]],this.state=zC.WAITING,this.saveValue(o,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(e=>{this.state=zC.FINISHED,this.discardEditor(e)})):(this.state=zC.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=zC.FINISHED,this.discardEditor()}discardEditor(e){if(this.state===zC.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=zC.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=zC.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===zC.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:n,wtViewport:o}=this.hot.view._wt,i=this.hot.rootWindow,s=za(t),r=Qa(t),l=za(this.hot.rootElement),a=Qa(this.hot.rootElement),h=n.topOverlay.holder,c=n.inlineStartOverlay.holder,u=h!==i?h.scrollTop:0,d=c!==i?c.scrollLeft:0,g=i.innerWidth-l.left-a,{wtTable:f}=null!==(e=n.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,m=f.name,p=["master","inline_start"].includes(m)?u:0,w=["master","top","bottom"].includes(m)?d:0,C=s.top===l.top?0:1;let y=s.top-l.top-C-p,v=0;v=this.hot.isRtl()?i.innerWidth-s.left-r-g-1+w:s.left-l.left-1-w,["top","top_inline_start_corner"].includes(m)&&(y+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(v+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const b=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(b&&S<=0||S===E)&&(y+=1),R<=0&&(v+=1);const M=o.rowsRenderCalculator.startPosition,T=o.columnsRenderCalculator.startPosition,x=Math.abs(n.inlineStartOverlay.getScrollPosition()),O=n.topOverlay.getScrollPosition(),A=hh(this.hot.rootDocument),_=t.offsetTop+M-O;let I=0;if(this.hot.isRtl()){const e=t.offsetLeft;I=e>=0?f.getWidth()-t.offsetLeft:Math.abs(e),I+=T-x-r}else I=t.offsetLeft+T-x;const k=Ja(this.TD,this.hot.rootWindow),H=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",D=parseInt(k[H],10)>0?0:1,N=parseInt(k.borderTopWidth,10)>0?0:1,P=Qa(t)+D,L=eh(t)+N,V=ch(h)?A:0,F=uh(c)?A:0,B=this.hot.view.maximumVisibleElementWidth(I)-V+D;return{top:y,start:v,height:L,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(_)-F+N,23),width:P,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}function GC(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,o=document.createTextNode(""),i=document.createElement("SPAN"),s=function(e,t,n){e.addEventListener(t,n,!1)},r=function(e,t,n){e.removeEventListener(t,n,!1)},l=function(s){var r,l;s?/^[a-zA-Z \.,\\\/\|0-9]$/.test(s)||(s="."):s="",void 0!==o.textContent?o.textContent=e.value+s:o.data=e.value+s,i.style.position="absolute",i.style.fontSize=c(e).fontSize,i.style.fontFamily=c(e).fontFamily,i.style.whiteSpace="pre",n.appendChild(i),r=i.clientWidth+2,n.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>r?e.style.width=t.minWidth+"px":r>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=r+"px",l=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>l?e.style.height=t.minHeight+"px":t.maxHeight<l?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=l+"px"},a=function(){window.setTimeout(l,0)},h=function(n,r,h){e=n,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var s=parseInt(n.minHeight);isNaN(s)||(t.minHeight=s)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var r=parseInt(n.maxHeight);isNaN(r)||(t.maxHeight=r)}if(n&&n.minWidth)if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(t.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var a=parseInt(n.maxWidth);isNaN(a)||(t.maxWidth=a)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))}(r),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),h&&(s(e,"change",l),s(e,"cut",a),s(e,"paste",a),s(e,"drop",a),s(e,"keydown",a),s(e,"focus",l),s(e,"compositionstart",a),s(e,"compositionupdate",a),s(e,"compositionend",a)),l()};function c(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function(e,t,n){h(e,t,n)},unObserve:function(){r(e,"change",l),r(e,"cut",a),r(e,"paste",a),r(e,"drop",a),r(e,"keydown",a),r(e,"focus",l),r(e,"compositionstart",a),r(e,"compositionupdate",a),r(e,"compositionend",a)},resize:l}}function KC(e,t){const n=oh(t),o=t.value.split("\n");let i=n,s=0;for(let t=0;t<o.length;t++){const r=o[t];0!==t&&(s+=o[t-1].length+1);const l=s+r.length;if("home"===e?i=s:"end"===e&&(i=l),n<=l)break}lh(t,i)}hc($C,jC);const qC="ht_editor_hidden",XC="textEditor";class ZC extends $C{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),this.eventManager=new pu(this),this.autoResize=GC(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement();this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(e=>this.onAfterDocumentKeyDown(e))),this.registerShortcuts()}close(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,t,n,o,i,s){const r=this.state;if(super.prepare(e,t,n,o,i,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:e,fragmentSelection:t}=s;e&&(this.TEXTAREA.value=""),r!==zC.FINISHED&&this.hideEditableElement();!t&&!_c()&&this.focus()}}beginEditing(e,t){this.state===zC.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),lh(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Pa(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Pa(this.TEXTAREA_PARENT,"handsontableInputHolder"),Na(this.TEXTAREA_PARENT,this.layerClass)&&La(this.TEXTAREA_PARENT,this.layerClass),Pa(this.TEXTAREA_PARENT,qC),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Ac()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",La(this.TEXTAREA_PARENT,this.layerClass),Pa(this.TEXTAREA_PARENT,qC)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;_u(e.length-1,(n=>{if(Na(e[n],"handsontableEditor"))return t=!0,!1})),Na(this.TEXTAREA_PARENT,qC)&&La(this.TEXTAREA_PARENT,qC),t?(this.layerClass="ht_editor_visible",Pa(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Pa(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==zC.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD)return void(e||this.close());const{top:t,start:n,width:o,maxWidth:i,height:s,maxHeight:r}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=Ja(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const a=Ja(this.TEXTAREA),h=parseInt(a.paddingLeft,10)+parseInt(a.paddingRight,10),c=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10),u=o-h,d=s-c,g=i-h,f=r-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(u,g),minHeight:Math.min(d,f),maxWidth:g,maxHeight:f},!0)}bindEvents(){this.eventManager.addEventListener(this.TEXTAREA,"cut",(e=>e.stopPropagation())),this.eventManager.addEventListener(this.TEXTAREA,"paste",(e=>e.stopPropagation())),Ic()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>ia(this.hot.getSelected()),group:XC},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"]],callback:e=>{const t=this.hot.getSettings(),n="function"==typeof t.tabMoves?t.tabMoves(e):t.tabMoves;this.hot.selection.transformStart(n.row,n.col,!0)}},{keys:[["Shift","Tab"]],callback:e=>{const t=this.hot.getSettings(),n="function"==typeof t.tabMoves?t.tabMoves(e):t.tabMoves;this.hot.selection.transformStart(-n.row,-n.col)}},{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey,relativeToGroup:Cu,position:"before"},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple(),relativeToGroup:Cu,position:"before"},{keys:[["Alt","Enter"]],callback:()=>(n(),!1),relativeToGroup:Cu,position:"before"},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(e,t)=>{let[n]=t;KC(n,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{let[n]=t;KC(n,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout((()=>{this.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout((()=>{this.autoResize.resize()}),10)}}],t)}unregisterShortcuts(){const e=this.hot.getShortcutManager().getContext("editor");e.removeShortcutsByGroup(wu),e.removeShortcutsByGroup(XC),e.removeShortcutsByGroup(YC)}onAfterDocumentKeyDown(e){-1===[Pc.ARROW_UP,Pc.ARROW_RIGHT,Pc.ARROW_DOWN,Pc.ARROW_LEFT].indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}function JC(e,t,n,o,i,s,r){const l=[],a=[];r.className&&Pa(t,r.className),r.readOnly&&l.push(r.readOnlyCellClassName),!1===r.valid&&r.invalidCellClassName?l.push(r.invalidCellClassName):a.push(r.invalidCellClassName),!1===r.wordWrap&&r.noWordWrapClassName&&l.push(r.noWordWrapClassName),!s&&r.placeholder&&l.push(r.placeholderCellClassName),La(t,a),Pa(t,l)}JC.RENDERER_TYPE="base";function QC(e,t,n,o,i,s,r){JC.apply(this,[e,t,n,o,i,s,r]);let l=s;if(!l&&r.placeholder&&(l=r.placeholder),l=oa(l),r.trimWhitespace&&(l=l.trim()),r.rendererTemplate){Fa(t);const o=e.rootDocument.createElement("TEMPLATE");o.setAttribute("bind","{{}}"),o.innerHTML=r.rendererTemplate,HTMLTemplateElement.decorate(o),o.model=e.getSourceDataAtRow(n),t.appendChild(o)}else Ua(t,l)}QC.RENDERER_TYPE="text";const ey={CELL_TYPE:"text",editor:ZC,renderer:QC};function ty(e,t){const n=new WC(e,t||{},Uf);return n.init(),n}CC(ey),ty.editors={BaseEditor:$C},ty.Core=function(e){return new WC(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},Uf)},ty.DefaultSettings=RC(),ty.hooks=nu.getSingleton(),ty.CellCoords=eg,ty.CellRange=ag,ty.packageName="handsontable",ty.buildDate="31/08/2023 08:23:33",ty.version="13.1.0",ty.languages={dictionaryKeys:Ew,getLanguageDictionary:Iw,getLanguagesDictionaries:function(){return Aw()},registerLanguageDictionary:_w,getTranslatedPhrase:Hw};const ny="handsontableEditor";class oy extends ZC{static get EDITOR_TYPE(){return"handsontable"}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),lh(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,n,o,i,s){super.prepare(e,t,n,o,i,s);const r=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown(e,t){const n=this.getSourceData(t.row,t.col);void 0!==n&&r.setValue(n),r.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&sc(l,s.handsontable),this.htOptions=l}beginEditing(e,t){const n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const e=this.htEditor.getInstance().getValue();void 0!==e&&this.setValue(e)}super.finishEditing(e,t,n)}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()}))}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const t={group:ny,relativeToGroup:wu,position:"before"},n=(e,t)=>{const n=this.htEditor.getInstance();if(void 0!==e&&(e<0||n.flipped&&e>n.countRows()-1?n.deselectCell():n.selectCell(e,0),n.getData().length))return t.preventDefault(),jc(t),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:e=>{const t=this.htEditor.getInstance();let o,i;return!t.getSelectedLast()&&t.flipped?o=t.countRows()-1:t.getSelectedLast()&&(t.flipped?(i=t.getSelectedLast()[0],o=Math.max(0,i-1)):(i=t.getSelectedLast()[0],o=i-1)),n(o,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:e=>{const t=this.htEditor.getInstance();let o,i;if(t.getSelectedLast()||t.flipped){if(t.getSelectedLast())if(t.flipped)o=t.getSelectedLast()[0]+1;else if(!t.flipped){const e=t.countRows()-1;i=t.getSelectedLast()[0],o=Math.min(e,i+1)}}else o=0;return n(o,e)},preventDefault:!1}],t)}unregisterShortcuts(){super.unregisterShortcuts();this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ny)}}function iy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const sy=new WeakMap;class ry extends oy{static get EDITOR_TYPE(){return"autocomplete"}constructor(e){super(e),iy(this,"sortByRelevance",(function(e,t,n){const o=[],i=[],s=e.length;let r,l,a,h,c=t.length;if(0===s){for(a=0;a<c;a++)i.push(a);return i}for(a=0;a<c;a++){if(l=Ra(oa(t[a])),n)h=l.indexOf(e);else{const t=this.cellProperties.locale;h=l.toLocaleLowerCase(t).indexOf(e.toLocaleLowerCase(t))}-1!==h&&(r=l.length-h-s,o.push({baseIndex:a,index:h,charsLeft:r,value:l}))}for(o.sort(((e,t)=>{if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0})),a=0,c=o.length;a<c;a++)i.push(o[a].baseIndex);return i})),this.query=null,this.strippedChoices=[],this.rawChoices=[],sy.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1})}getValue(){const e=this.rawChoices.find((e=>this.stripValueIfNeeded(e)===this.TEXTAREA.value));return ia(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Pa(this.htContainer,"autocompleteEditor"),Pa(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}open(){const e=sy.get(this);super.open();const t=this.htEditor.getInstance(),n=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();let o=hh();0===o&&e.isMacOS&&(o+=15),this.addHook("beforeKeyDown",(e=>this.onBeforeKeyDown(e))),t.updateSettings({colWidths:n?[Qa(this.TEXTAREA)-2]:void 0,width:n?Qa(this.TEXTAREA)+o:void 0,renderer:(e,t,n,o,i,s,r)=>{QC(e,t,n,o,i,s,r);const{filteringCaseSensitive:l,allowHtml:a,locale:h}=this.cellProperties,c=this.query;let u,d,g=oa(s);g&&!a&&(u=!0===l?g.indexOf(c):g.toLocaleLowerCase(h).indexOf(c.toLocaleLowerCase(h)),-1!==u&&(d=g.substr(u,c.length),g=g.replace(d,`<strong>${d}</strong>`))),t.innerHTML=g},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close()}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,"function"==typeof t?t.call(this.cellProperties,e,(e=>{this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))})):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=oh(this.TEXTAREA),n=ih(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let s=null,r=null,l=e;o&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const a=Array.isArray(s)?s.length:0;if(!1===i)a&&(r=s[0]);else{const e=[];for(let t=0,n=l.length;t<n&&!(o&&a<=t);t++)a?e.push(l[s[t]]):e.push(l[t]);r=0,l=e}this.strippedChoices=l,this.htEditor.loadData($l([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(r),this.hot.listen(),lh(this.TEXTAREA,t,t===n?void 0:n)}flipDropdownIfNeeded(){const e=Xa(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(t||!t&&(n||"horizontal"===n))return!1;const o=za(this.TEXTAREA),i=eh(this.TEXTAREA),s=this.getDropdownHeight(),r=e.scrollTop,l=eh(this.hot.view._wt.wtTable.THEAD),a=za(e),h=o.top-a.top-l+r,c=e.scrollHeight-h-l-i,u=s>c&&h>c;return u?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(u?h:c,s),u}limitDropdownIfNeeded(e,t){if(t>e){let n=0,o=0,i=0,s=null;do{i=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=i,o+=1}while(n<e);s=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-s+"px"),this.setDropdownHeight(n-i)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+hh(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,n=ql(e,(e=>oa(e)));return ql(n,(e=>t?e:Ra(e)))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),n=t?t.from.row:-1;let o=!1;return e===Pc.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(o=!0),e===Pc.ARROW_UP&&n>-1&&(o=!0),o}onBeforeKeyDown(e){const t=sy.get(this);if(t.skipOne=!1,Vc(e.keyCode)||e.keyCode===Pc.BACKSPACE||e.keyCode===Pc.DELETE||e.keyCode===Pc.INSERT){let n=10;if(e.keyCode===Pc.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value),t.skipOne=!0}),n)}}}class ly extends $C{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){if(t&&"mouseup"===t.type){const e=this.TD.querySelector('input[type="checkbox"]');Na(e,"htBadValue")||e.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var ay={exports:{}};
/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */!function(e){!function(){var t;try{t=Ul}catch(e){}e.exports=function(e){var t="function"==typeof e,n=!!window.addEventListener,o=window.document,i=window.setTimeout,s=function(e,t,o,i){n?e.addEventListener(t,o,!!i):e.attachEvent("on"+t,o)},r=function(e,t,o,i){n?e.removeEventListener(t,o,!!i):e.detachEvent("on"+t,o)},l=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},a=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},h=function(e,t){a(e,t)||(e.className=""===e.className?t:e.className+" "+t)},c=function(e,t){e.className=l((" "+e.className+" ").replace(" "+t+" "," "))},u=function(e){return/Array/.test(Object.prototype.toString.call(e))},d=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},g=function(e){var t=e.getDay();return 0===t||6===t},f=function(e){return e%4==0&&e%100!=0||e%400==0},m=function(e,t){return[31,f(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},p=function(e){d(e)&&e.setHours(0,0,0,0)},w=function(e,t){return e.getTime()===t.getTime()},C=function(e,t,n){var o,i;for(o in t)(i=void 0!==e[o])&&"object"==typeof t[o]&&null!==t[o]&&void 0===t[o].nodeName?d(t[o])?n&&(e[o]=new Date(t[o].getTime())):u(t[o])?n&&(e[o]=t[o].slice(0)):e[o]=C({},t[o],n):!n&&i||(e[o]=t[o]);return e},y=function(e,t,n){var i;o.createEvent?((i=o.createEvent("HTMLEvents")).initEvent(t,!0,!1),i=C(i,n),e.dispatchEvent(i)):o.createEventObject&&(i=o.createEventObject(),i=C(i,n),e.fireEvent("on"+t,i))},v=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},b={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},S=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},R=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},E=function(e,t){e.setHours(0,0,0,0);var n=e.getDate(),o=e.getDay(),i=t,s=i-1,r=7,l=function(e){return(e+r-1)%r};e.setDate(n+s-l(o));var a=new Date(e.getFullYear(),0,i),h=864e5,c=(e.getTime()-a.getTime())/h;return 1+Math.round((c-s+l(a.getDay()))/r)},M=function(n,o,i,s){var r=new Date(i,o,n);return'<td class="pika-week">'+(t?e(r).isoWeek():E(r,s))+"</td>"},T=function(e,t,n,o){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(o?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},x=function(e){return"<tbody>"+e.join("")+"</tbody>"},O=function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+S(e,t)+'">'+S(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"},A=function(e,t,n,o,i,s){var r,l,a,h,c,d=e._o,g=n===d.minYear,f=n===d.maxYear,m='<div id="'+s+'" class="pika-title" role="heading" aria-live="assertive">',p=!0,w=!0;for(a=[],r=0;r<12;r++)a.push('<option value="'+(n===i?r-t:12+r-t)+'"'+(r===o?' selected="selected"':"")+(g&&r<d.minMonth||f&&r>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[r]+"</option>");for(h='<div class="pika-label">'+d.i18n.months[o]+'<select class="pika-select pika-select-month" tabindex="-1">'+a.join("")+"</select></div>",u(d.yearRange)?(r=d.yearRange[0],l=d.yearRange[1]+1):(r=n-d.yearRange,l=1+n+d.yearRange),a=[];r<l&&r<=d.maxYear;r++)r>=d.minYear&&a.push('<option value="'+r+'"'+(r===n?' selected="selected"':"")+">"+r+"</option>");return c='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+a.join("")+"</select></div>",d.showMonthAfterYear?m+=c+h:m+=h+c,g&&(0===o||d.minMonth>=o)&&(p=!1),f&&(11===o||d.maxMonth<=o)&&(w=!1),0===t&&(m+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(m+='<button class="pika-next'+(w?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),m+"</div>"},_=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+O(e)+x(t)+"</table>"},I=function(r){var l=this,h=l.config(r);l._onMouseDown=function(e){if(l._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(a(t,"is-disabled")||(!a(t,"pika-button")||a(t,"is-empty")||a(t.parentNode,"is-disabled")?a(t,"pika-prev")?l.prevMonth():a(t,"pika-next")&&l.nextMonth():(l.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),h.bound&&i((function(){l.hide(),h.blurFieldOnSelect&&h.field&&h.field.blur()}),100))),a(t,"pika-select"))l._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},l._onChange=function(e){var t=(e=e||window.event).target||e.srcElement;t&&(a(t,"pika-select-month")?l.gotoMonth(t.value):a(t,"pika-select-year")&&l.gotoYear(t.value))},l._onKeyChange=function(e){if(e=e||window.event,l.isVisible())switch(e.keyCode){case 13:case 27:h.field&&h.field.blur();break;case 37:l.adjustDate("subtract",1);break;case 38:l.adjustDate("subtract",7);break;case 39:l.adjustDate("add",1);break;case 40:l.adjustDate("add",7);break;case 8:case 46:l.setDate(null)}},l._parseFieldValue=function(){if(h.parse)return h.parse(h.field.value,h.format);if(t){var n=e(h.field.value,h.format,h.formatStrict);return n&&n.isValid()?n.toDate():null}return new Date(Date.parse(h.field.value))},l._onInputChange=function(e){var t;e.firedBy!==l&&(t=l._parseFieldValue(),d(t)&&l.setDate(t),l._v||l.show())},l._onInputFocus=function(){l.show()},l._onInputClick=function(){l.show()},l._onInputBlur=function(){var e=o.activeElement;do{if(a(e,"pika-single"))return}while(e=e.parentNode);l._c||(l._b=i((function(){l.hide()}),50)),l._c=!1},l._onClick=function(e){var t=(e=e||window.event).target||e.srcElement,o=t;if(t){!n&&a(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),s(t,"change",l._onChange)));do{if(a(o,"pika-single")||o===h.trigger)return}while(o=o.parentNode);l._v&&t!==h.trigger&&o!==h.trigger&&l.hide()}},l.el=o.createElement("div"),l.el.className="pika-single"+(h.isRTL?" is-rtl":"")+(h.theme?" "+h.theme:""),s(l.el,"mousedown",l._onMouseDown,!0),s(l.el,"touchend",l._onMouseDown,!0),s(l.el,"change",l._onChange),h.keyboardInput&&s(o,"keydown",l._onKeyChange),h.field&&(h.container?h.container.appendChild(l.el):h.bound?o.body.appendChild(l.el):h.field.parentNode.insertBefore(l.el,h.field.nextSibling),s(h.field,"change",l._onInputChange),h.defaultDate||(h.defaultDate=l._parseFieldValue(),h.setDefaultDate=!0));var c=h.defaultDate;d(c)?h.setDefaultDate?l.setDate(c,!0):l.gotoDate(c):l.gotoDate(new Date),h.bound?(this.hide(),l.el.className+=" is-bound",s(h.trigger,"click",l._onInputClick),s(h.trigger,"focus",l._onInputFocus),s(h.trigger,"blur",l._onInputBlur)):this.show()};return I.prototype={config:function(e){this._o||(this._o=C({},b,!0));var t=C(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,d(t.minDate)||(t.minDate=!1),d(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),u(t.yearRange)){var o=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||o,t.yearRange[1]=parseInt(t.yearRange[1],10)||o}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||b.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return n=n||this._o.format,d(this._d)?this._o.toString?this._o.toString(this._d,n):t?e(this._d).format(n):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,o){t&&e.isMoment(n)&&this.setDate(n.toDate(),o)},getDate:function(){return d(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",y(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),d(e)){var n=this._o.minDate,o=this._o.maxDate;d(n)&&e<n?e=n:d(o)&&e>o&&(e=o),this._d=new Date(e.getTime()),p(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),y(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(e){var t=!0;if(d(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),o=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();o.setMonth(o.getMonth()+1),o.setDate(o.getDate()-1),t=i<n.getTime()||o.getTime()<i}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){var n,o=this.getDate()||new Date,i=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(o.valueOf()+i):"subtract"===e&&(n=new Date(o.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=v(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=v({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(p(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=b.minDate,this._o.minYear=b.minYear,this._o.minMonth=b.minMonth,this._o.startRange=b.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(p(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=b.maxDate,this._o.maxYear=b.maxYear,this._o.maxMonth=b.maxMonth,this._o.endRange=b.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,o=n.minYear,s=n.maxYear,r=n.minMonth,l=n.maxMonth,a="";this._y<=o&&(this._y=o,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=s&&(this._y=s,!isNaN(l)&&this._m>l&&(this._m=l));for(var h=0;h<n.numberOfMonths;h++)t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+A(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,t)+this.render(this.calendars[h].year,this.calendars[h].month,t)+"</div>";this.el.innerHTML=a,n.bound&&"hidden"!==n.field.type&&i((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)}},adjustPosition:function(){var e,t,n,i,s,r,l,a,u,d,g,f;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,n=this.el.offsetWidth,i=this.el.offsetHeight,s=window.innerWidth||o.documentElement.clientWidth,r=window.innerHeight||o.documentElement.clientHeight,l=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,g=!0,f=!0,"function"==typeof e.getBoundingClientRect)a=(d=e.getBoundingClientRect()).left+window.pageXOffset,u=d.bottom+window.pageYOffset;else for(a=t.offsetLeft,u=t.offsetTop+t.offsetHeight;t=t.offsetParent;)a+=t.offsetLeft,u+=t.offsetTop;(this._o.reposition&&a+n>s||this._o.position.indexOf("right")>-1&&a-n+e.offsetWidth>0)&&(a=a-n+e.offsetWidth,g=!1),(this._o.reposition&&u+i>r+l||this._o.position.indexOf("top")>-1&&u-i-e.offsetHeight>0)&&(u=u-i-e.offsetHeight,f=!1),this.el.style.left=a+"px",this.el.style.top=u+"px",h(this.el,g?"left-aligned":"right-aligned"),h(this.el,f?"bottom-aligned":"top-aligned"),c(this.el,g?"right-aligned":"left-aligned"),c(this.el,f?"top-aligned":"bottom-aligned")}},render:function(e,t,n){var o=this._o,i=new Date,s=m(e,t),r=new Date(e,t,1).getDay(),l=[],a=[];p(i),o.firstDay>0&&(r-=o.firstDay)<0&&(r+=7);for(var h=0===t?11:t-1,c=11===t?0:t+1,u=0===t?e-1:e,f=11===t?e+1:e,C=m(u,h),y=s+r,v=y;v>7;)v-=7;y+=7-v;for(var b=!1,S=0,E=0;S<y;S++){var x=new Date(e,t,S-r+1),O=!!d(this._d)&&w(x,this._d),A=w(x,i),I=-1!==o.events.indexOf(x.toDateString()),k=S<r||S>=s+r,H=S-r+1,D=t,N=e,P=o.startRange&&w(o.startRange,x),L=o.endRange&&w(o.endRange,x),V=o.startRange&&o.endRange&&o.startRange<x&&x<o.endRange;k&&(S<r?(H=C+H,D=h,N=u):(H-=s,D=c,N=f));var F={day:H,month:D,year:N,hasEvent:I,isSelected:O,isToday:A,isDisabled:o.minDate&&x<o.minDate||o.maxDate&&x>o.maxDate||o.disableWeekends&&g(x)||o.disableDayFn&&o.disableDayFn(x),isEmpty:k,isStartRange:P,isEndRange:L,isInRange:V,showDaysInNextAndPreviousMonths:o.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:o.enableSelectionDaysInNextAndPreviousMonths};o.pickWholeWeek&&O&&(b=!0),a.push(R(F)),7==++E&&(o.showWeekNumber&&a.unshift(M(S-r,t,e,o.firstWeekOfYearMinDays)),l.push(T(a,o.isRTL,o.pickWholeWeek,b)),a=[],E=0,b=!1)}return _(o,l,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),c(this.el,"is-hidden"),this._o.bound&&(s(o,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&r(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var e=this._o;this.hide(),r(this.el,"mousedown",this._onMouseDown,!0),r(this.el,"touchend",this._onMouseDown,!0),r(this.el,"change",this._onChange),e.keyboardInput&&r(o,"keydown",this._onKeyChange),e.field&&(r(e.field,"change",this._onInputChange),e.bound&&(r(e.trigger,"click",this._onInputClick),r(e.trigger,"focus",this._onInputFocus),r(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},I}(t)}()}(ay);var hy=l(ay.exports);const cy="date",uy="dateEditor";class dy extends ZC{static get EDITOR_TYPE(){return cy}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if("function"!=typeof jl)throw new Error("You need to include moment.js to your project.");if("function"!=typeof hy)throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Pa(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);new pu(this).addEventListener(this.datePicker,"mousedown",(e=>e.stopPropagation()))}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,n,o,i,s){super.prepare(e,t,n,o,i,s)}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),t.addShortcut({keys:[["Enter"]],callback:e=>{e.stopPropagation()},group:uy})}close(){var e;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout((()=>{this.instance._refreshBorders()}));this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(uy),super.close()}finishEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){const e=this.originalValue;void 0!==e&&this.setValue(e)}super.finishEditing(e,t)}showDatepicker(e){const t=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),i=!!e&&Fc(e.keyCode);let s;this.datePicker.style.display="block",this.$datePicker=new hy(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+eh(this.TD)}px`;let r=this.hot.rootWindow.pageXOffset;r=this.hot.isRtl()?t.right-Qa(this.datePicker):t.left,this.datePickerStyle.left=`${r}px`,this.originalValue?(s=this.originalValue,jl(s,n,!0).isValid()&&this.$datePicker.setMoment(jl(s,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||o||this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,jl(s,n,!0).isValid()&&this.$datePicker.setMoment(jl(s,n),!0),i||o||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&rc(t,this.cellProperties.datePickerConfig);const n=t.onSelect,o=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=e=>{let t=e;isNaN(t.getTime())||(t=jl(t).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(t),this.hideDatepicker(),n&&n()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},t}}class gy extends ry{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,n,o,i,s){super.prepare(e,t,n,o,i,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}nu.getSingleton().add("beforeValidate",(function(e,t,n){const o=this.getCellMeta(t,this.propToCol(n));o.editor===gy&&void 0===o.strict&&(o.filter=!1,o.strict=!0)}));class fy extends ZC{static get EDITOR_TYPE(){return"numeric"}}class my extends ZC{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Fa(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const py="ht_editor_visible",wy="selectEditor";class Cy extends $C{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("SELECT"),Pa(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Na(this.select,py)&&La(this.select,py),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(e,t,n,o,i,s){super.prepare(e,t,n,o,i,s);const r=this.cellProperties.selectOptions;let l;l="function"==typeof r?this.prepareOptions(r(this.row,this.col,this.prop)):this.prepareOptions(r),Fa(this.select),gc(l,((e,t)=>{const n=this.hot.rootDocument.createElement("OPTION");n.value=t,Wa(n,e),this.select.appendChild(n)}))}prepareOptions(e){let t={};if(Array.isArray(e))for(let n=0,o=e.length;n<o;n++)t[e[n]]=e[n];else"object"==typeof e&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==zC.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:e,start:t,width:n,height:o}=this.getEditedCellRect(),i=this.select.style;i.height=`${o}px`,i.width=`${n}px`,i.top=`${e}px`,i[this.hot.isRtl()?"right":"left"]=`${t}px`,i.margin="0px",Pa(this.select,py)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={group:wy};!1!==this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const e=this.select.selectedIndex-1;e>=0&&(this.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const e=this.select.selectedIndex+1;e<=this.select.length-1&&(this.select[e].selected=!0)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(wy)}}class yy extends ZC{static get EDITOR_TYPE(){return"time"}prepare(e,t,n,o,i,s){super.prepare(e,t,n,o,i,s),this.TEXTAREA.dir="ltr"}}function vy(e,t,n,o,i,s,r){JC.apply(this,[e,t,n,o,i,s,r]),Wa(t,null==s?"":s,!1)}vy.RENDERER_TYPE="html";function by(e,t,n,o,i,s,r){const{rootDocument:l}=e,a=r.allowHtml?vy:QC,h=l.createElement("DIV");if(h.className="htAutocompleteArrow",h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[e,t,n,o,i,s,r]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(h,t.firstChild),Pa(t,"htAutocomplete"),!e.acArrowListener){const i=new pu(e);e.acArrowListener=function(i){Na(i.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,o),t)},i.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}by.RENDERER_TYPE="autocomplete";const Sy=new WeakMap,Ry=new WeakMap,Ey="data-row",My="data-col",Ty="checkboxRenderer",xy="checkbox";function Oy(e,t,n,o,i,s,r){const{rootDocument:l}=e;JC.apply(this,[e,t,n,o,i,s,r]),function(e){let t=Ry.get(e);if(!t){const{rootElement:n}=e;t=new pu(e),t.addEventListener(n,"click",(t=>function(e,t){const{target:n}=e;if(!Ay(n))return;if(!n.hasAttribute(Ey)||!n.hasAttribute(My))return;const o=parseInt(n.getAttribute(Ey),10),i=parseInt(n.getAttribute(My),10),s=t.getCellMeta(o,i);s.readOnly&&e.preventDefault()}(t,e))),t.addEventListener(n,"mouseup",(t=>function(e,t){const{target:n}=e;if(!Ay(n))return;if(!n.hasAttribute(Ey)||!n.hasAttribute(My))return;setTimeout(t.listen,10)}(t,e))),t.addEventListener(n,"change",(t=>function(e,t){const{target:n}=e;if(!Ay(n))return;if(!n.hasAttribute(Ey)||!n.hasAttribute(My))return;const o=parseInt(n.getAttribute(Ey),10),i=parseInt(n.getAttribute(My),10),s=t.getCellMeta(o,i);if(!s.readOnly){let n=null;n=e.target.checked?void 0===s.uncheckedTemplate||s.checkedTemplate:void 0!==s.uncheckedTemplate&&s.uncheckedTemplate,t.setDataAtCell(o,i,n)}}(t,e))),Ry.set(e,t)}}(e);let a=function(e){const t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}(l);const h=r.label;let c=!1;if(void 0===r.checkedTemplate&&(r.checkedTemplate=!0),void 0===r.uncheckedTemplate&&(r.uncheckedTemplate=!1),Fa(t),s===r.checkedTemplate||oa(s).toLocaleLowerCase(r.locale)===oa(r.checkedTemplate).toLocaleLowerCase(r.locale)?a.checked=!0:s===r.uncheckedTemplate||oa(s).toLocaleLowerCase(r.locale)===oa(r.uncheckedTemplate).toLocaleLowerCase(r.locale)?a.checked=!1:ra(s)?Pa(a,"noValue"):(a.style.display="none",Pa(a,"htBadValue"),c=!0),a.setAttribute(Ey,n),a.setAttribute(My,o),!c&&h){let r="";if(h.value)r="function"==typeof h.value?h.value.call(this,n,o,i,s):h.value;else if(h.property){const t=e.getDataAtRowProp(n,h.property);r=null!==t?t:""}const c=function(e,t,n){const o=e.createElement("label");return o.className="htCheckboxRendererLabel "+(n?"fullWidth":""),o.appendChild(e.createTextNode(t)),o.cloneNode(!0)}(l,r,!0!==h.separated);"before"===h.position?h.separated?(t.appendChild(c),t.appendChild(a)):(c.appendChild(a),a=c):h.position&&"after"!==h.position||(h.separated?(t.appendChild(a),t.appendChild(c)):(c.insertBefore(a,c.firstChild),a=c))}function u(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=e.getSelectedRange();if(n)for(let o=0;o<n.length;o++){const{row:i,col:s}=n[o].getTopStartCorner(),{row:r,col:l}=n[o].getBottomEndCorner(),a=[];for(let n=i;n<=r;n+=1)for(let o=s;o<=l;o+=1){const i=e.getCellMeta(n,o);if("checkbox"!==i.type)return;if(!0===i.readOnly)continue;void 0===i.checkedTemplate&&(i.checkedTemplate=!0),void 0===i.uncheckedTemplate&&(i.uncheckedTemplate=!1);const s=e.getDataAtCell(n,o);!1===t?[i.checkedTemplate,i.checkedTemplate.toString()].includes(s)?a.push([n,o,i.uncheckedTemplate]):[i.uncheckedTemplate,i.uncheckedTemplate.toString(),null,void 0].includes(s)&&a.push([n,o,i.checkedTemplate]):a.push([n,o,i.uncheckedTemplate])}a.length>0&&e.setDataAtCell(a)}}function d(){const t=e.getSelectedRange();if(t){for(let n=0;n<t.length;n++){const o=t[n].getTopStartCorner(),i=t[n].getBottomEndCorner();for(let t=o.row;t<=i.row;t++)for(let n=o.col;n<=i.col;n++){const o=e.getCellMeta(t,n);if("checkbox"!==o.type)return!1;const i=e.getCell(t,n);if(null==i)return!0;if(i.querySelectorAll("input[type=checkbox]").length>0&&!o.readOnly)return!0}}return!1}}(!h||h&&!h.separated)&&t.appendChild(a),c&&t.appendChild(l.createTextNode("#bad-value#")),Sy.has(e)||(Sy.set(e,!0),function(){const t=e.getShortcutManager().getContext("grid"),n={group:Ty};t.addShortcuts([{keys:[["space"]],callback:()=>(u(),!d())},{keys:[["enter"]],callback:()=>(u(),!d()),runOnlyIf:()=>e.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(u(!0),!d()),relativeToGroup:Cu,position:"before"}],n)}())}function Ay(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}nu.getSingleton().add("modifyAutoColumnSizeSeed",(function(e,t,n){const{label:o,type:i,row:s,column:r,prop:l}=t;if(i===xy){if(o){const{value:t,property:i}=o;let a=n;if(t)a="function"==typeof t?t(s,r,l,n):t;else if(i){const e=this.getDataAtRowProp(s,i);a=null!==e?e:n}e=a}return e}})),Oy.RENDERER_TYPE=xy;var _y={exports:{}};_y.exports=function e(t,n,o){function i(r,l){if(!n[r]){if(!t[r]){if(!l&&Fl)return Fl(r);if(s)return s(r,!0);var a=new Error("Cannot find module '"+r+"'");throw a.code="MODULE_NOT_FOUND",a}var h=n[r]={exports:{}};t[r][0].call(h.exports,(function(e){return i(t[r][1][e]||e)}),h,h.exports,e,t,n,o)}return n[r].exports}for(var s=Fl,r=0;r<o.length;r++)i(o[r]);return i}({1:[function(e,t,n){!function(e){var n,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,r="[BigNumber Error] ",l=r+"Number primitive has more than 15 significant digits: ",a=1e14,h=14,c=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,g=1e9;function f(e){var t=0|e;return 0<e||e===t?t:t-1}function m(e){for(var t,n,o=1,i=e.length,s=e[0]+"";o<i;){for(t=e[o++]+"",n=h-t.length;n--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function p(e,t){var n,o,i=e.c,s=t.c,r=e.s,l=t.s,a=e.e,h=t.e;if(!r||!l)return null;if(n=i&&!i[0],o=s&&!s[0],n||o)return n?o?0:-l:r;if(r!=l)return r;if(n=r<0,o=a==h,!i||!s)return o?0:!i^n?1:-1;if(!o)return h<a^n?1:-1;for(l=(a=i.length)<(h=s.length)?a:h,r=0;r<l;r++)if(i[r]!=s[r])return i[r]>s[r]^n?1:-1;return a==h?0:h<a^n?1:-1}function w(e,t,n,o){if(e<t||n<e||e!==(e<0?i(e):s(e)))throw Error(r+(o||"Argument")+("number"==typeof e?e<t||n<e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function C(e){var t=e.c.length-1;return f(e.e/h)==t&&e.c[t]%2!=0}function y(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,n){var o,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(o=e.length)){for(i=n,t-=o;--t;i+=n);e+=i}else t<o&&(e=e.slice(0,t)+"."+e.slice(t));return e}(n=function e(t){var n,b,S,R,E,M,T,x,O,A,_=j.prototype={constructor:j,toString:null,valueOf:null},I=new j(1),k=20,H=4,D=-7,N=21,P=-1e7,L=1e7,V=!1,F=1,B=0,W={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},U="0123456789abcdefghijklmnopqrstuvwxyz";function j(e,t){var n,i,r,a,u,d,g,f,m=this;if(!(m instanceof j))return new j(e,t);if(null==t){if(e instanceof j)return m.s=e.s,m.e=e.e,void(m.c=(e=e.c)?e.slice():e);if((d="number"==typeof e)&&0*e==0){if(m.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,u=e;10<=u;u/=10,a++);return m.e=a,void(m.c=[e])}f=String(e)}else{if(f=String(e),!o.test(f))return S(m,f,d);m.s=45==f.charCodeAt(0)?(f=f.slice(1),-1):1}-1<(a=f.indexOf("."))&&(f=f.replace(".","")),0<(u=f.search(/e/i))?(a<0&&(a=u),a+=+f.slice(u+1),f=f.substring(0,u)):a<0&&(a=f.length)}else{if(w(t,2,U.length,"Base"),f=String(e),10==t)return G(m=new j(e instanceof j?e:f),k+m.e+1,H);if(d="number"==typeof e){if(0*e!=0)return S(m,f,d,t);if(m.s=1/e<0?(f=f.slice(1),-1):1,j.DEBUG&&15<f.replace(/^0\.0*|\./,"").length)throw Error(l+e);d=!1}else m.s=45===f.charCodeAt(0)?(f=f.slice(1),-1):1;for(n=U.slice(0,t),a=u=0,g=f.length;u<g;u++)if(n.indexOf(i=f.charAt(u))<0){if("."==i){if(a<u){a=g;continue}}else if(!r&&(f==f.toUpperCase()&&(f=f.toLowerCase())||f==f.toLowerCase()&&(f=f.toUpperCase()))){r=!0,u=-1,a=0;continue}return S(m,String(e),d,t)}-1<(a=(f=b(f,t,10,m.s)).indexOf("."))?f=f.replace(".",""):a=f.length}for(u=0;48===f.charCodeAt(u);u++);for(g=f.length;48===f.charCodeAt(--g););if(f=f.slice(u,++g)){if(g-=u,d&&j.DEBUG&&15<g&&(c<e||e!==s(e)))throw Error(l+m.s*e);if(L<(a=a-u-1))m.c=m.e=null;else if(a<P)m.c=[m.e=0];else{if(m.e=a,m.c=[],u=(a+1)%h,a<0&&(u+=h),u<g){for(u&&m.c.push(+f.slice(0,u)),g-=h;u<g;)m.c.push(+f.slice(u,u+=h));f=f.slice(u),u=h-f.length}else u-=g;for(;u--;f+="0");m.c.push(+f)}}else m.c=[m.e=0]}function z(e,t,n,o){var i,s,r,l,a;if(null==n?n=H:w(n,0,8),!e.c)return e.toString();if(i=e.c[0],r=e.e,null==t)a=m(e.c),a=1==o||2==o&&(r<=D||N<=r)?y(a,r):v(a,r,"0");else if(s=(e=G(new j(e),t,n)).e,l=(a=m(e.c)).length,1==o||2==o&&(t<=s||s<=D)){for(;l<t;a+="0",l++);a=y(a,s)}else if(t-=r,a=v(a,s,"0"),l<s+1){if(0<--t)for(a+=".";t--;a+="0");}else if(0<(t+=s-l))for(s+1==l&&(a+=".");t--;a+="0");return e.s<0&&i?"-"+a:a}function Y(e,t){for(var n,o=1,i=new j(e[0]);o<e.length;o++){if(!(n=new j(e[o])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function $(e,t,n){for(var o=1,i=t.length;!t[--i];t.pop());for(i=t[0];10<=i;i/=10,o++);return(n=o+n*h-1)>L?e.c=e.e=null:e.c=n<P?[e.e=0]:(e.e=n,t),e}function G(e,t,n,o){var r,l,c,d,g,f,m,p=e.c,w=u;if(p){e:{for(r=1,d=p[0];10<=d;d/=10,r++);if((l=t-r)<0)l+=h,c=t,m=(g=p[f=0])/w[r-c-1]%10|0;else if((f=i((l+1)/h))>=p.length){if(!o)break e;for(;p.length<=f;p.push(0));g=m=0,c=(l%=h)-h+(r=1)}else{for(g=d=p[f],r=1;10<=d;d/=10,r++);m=(c=(l%=h)-h+r)<0?0:g/w[r-c-1]%10|0}if(o=o||t<0||null!=p[f+1]||(c<0?g:g%w[r-c-1]),o=n<4?(m||o)&&(0==n||n==(e.s<0?3:2)):5<m||5==m&&(4==n||o||6==n&&(0<l?0<c?g/w[r-c]:0:p[f-1])%10&1||n==(e.s<0?8:7)),t<1||!p[0])return p.length=0,o?(t-=e.e+1,p[0]=w[(h-t%h)%h],e.e=-t||0):p[0]=e.e=0,e;if(0==l?(p.length=f,d=1,f--):(p.length=f+1,d=w[h-l],p[f]=0<c?s(g/w[r-c]%w[c])*d:0),o)for(;;){if(0==f){for(l=1,c=p[0];10<=c;c/=10,l++);for(c=p[0]+=d,d=1;10<=c;c/=10,d++);l!=d&&(e.e++,p[0]==a&&(p[0]=1));break}if(p[f]+=d,p[f]!=a)break;p[f--]=0,d=1}for(l=p.length;0===p[--l];p.pop());}e.e>L?e.c=e.e=null:e.e<P&&(e.c=[e.e=0])}return e}function K(e){var t,n=e.e;return null===n?e.toString():(t=m(e.c),t=n<=D||N<=n?y(t,n):v(t,n,"0"),e.s<0?"-"+t:t)}return j.clone=e,j.ROUND_UP=0,j.ROUND_DOWN=1,j.ROUND_CEIL=2,j.ROUND_FLOOR=3,j.ROUND_HALF_UP=4,j.ROUND_HALF_DOWN=5,j.ROUND_HALF_EVEN=6,j.ROUND_HALF_CEIL=7,j.ROUND_HALF_FLOOR=8,j.EUCLID=9,j.config=j.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(r+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(w(n=e[t],0,g,t),k=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(w(n=e[t],0,8,t),H=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(w(n[0],-g,0,t),w(n[1],0,g,t),D=n[0],N=n[1]):(w(n,-g,g,t),D=-(N=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)w(n[0],-g,-1,t),w(n[1],1,g,t),P=n[0],L=n[1];else{if(w(n,-g,g,t),!n)throw Error(r+t+" cannot be zero: "+n);P=-(L=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(r+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw V=!n,Error(r+"crypto unavailable");V=n}else V=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(w(n=e[t],0,9,t),F=n),e.hasOwnProperty(t="POW_PRECISION")&&(w(n=e[t],0,g,t),B=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(r+t+" not an object: "+n);W=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(r+t+" invalid: "+n);U=n}}return{DECIMAL_PLACES:k,ROUNDING_MODE:H,EXPONENTIAL_AT:[D,N],RANGE:[P,L],CRYPTO:V,MODULO_MODE:F,POW_PRECISION:B,FORMAT:W,ALPHABET:U}},j.isBigNumber=function(e){return e instanceof j||e&&!0===e._isBigNumber||!1},j.maximum=j.max=function(){return Y(arguments,_.lt)},j.minimum=j.min=function(){return Y(arguments,_.gt)},j.random=(R=9007199254740992,E=Math.random()*R&2097151?function(){return s(Math.random()*R)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,o,l,a,c=0,d=[],f=new j(I);if(null==e?e=k:w(e,0,g),l=i(e/h),V)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(l*=2));c<l;)9e15<=(a=131072*t[c]+(t[c+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),t[c]=n[0],t[c+1]=n[1]):(d.push(a%1e14),c+=2);c=l/2}else{if(!crypto.randomBytes)throw V=!1,Error(r+"crypto unavailable");for(t=crypto.randomBytes(l*=7);c<l;)9e15<=(a=281474976710656*(31&t[c])+1099511627776*t[c+1]+4294967296*t[c+2]+16777216*t[c+3]+(t[c+4]<<16)+(t[c+5]<<8)+t[c+6])?crypto.randomBytes(7).copy(t,c):(d.push(a%1e14),c+=7);c=l/7}if(!V)for(;c<l;)(a=E())<9e15&&(d[c++]=a%1e14);for(l=d[--c],e%=h,l&&e&&(a=u[h-e],d[c]=s(l/a)*a);0===d[c];d.pop(),c--);if(c<0)d=[o=0];else{for(o=-1;0===d[0];d.splice(0,1),o-=h);for(c=1,a=d[0];10<=a;a/=10,c++);c<h&&(o-=h-c)}return f.e=o,f.c=d,f}),j.sum=function(){for(var e=1,t=arguments,n=new j(t[0]);e<t.length;)n=n.plus(t[e++]);return n},b=function(){var e="0123456789";function t(e,t,n,o){for(var i,s,r=[0],l=0,a=e.length;l<a;){for(s=r.length;s--;r[s]*=t);for(r[0]+=o.indexOf(e.charAt(l++)),i=0;i<r.length;i++)r[i]>n-1&&(null==r[i+1]&&(r[i+1]=0),r[i+1]+=r[i]/n|0,r[i]%=n)}return r.reverse()}return function(o,i,s,r,l){var a,h,c,u,d,g,f,p,w=o.indexOf("."),C=k,y=H;for(0<=w&&(u=B,B=0,o=o.replace(".",""),g=(p=new j(i)).pow(o.length-w),B=u,p.c=t(v(m(g.c),g.e,"0"),10,s,e),p.e=p.c.length),c=u=(f=t(o,i,s,l?(a=U,e):(a=e,U))).length;0==f[--u];f.pop());if(!f[0])return a.charAt(0);if(w<0?--c:(g.c=f,g.e=c,g.s=r,f=(g=n(g,p,C,y,s)).c,d=g.r,c=g.e),w=f[h=c+C+1],u=s/2,d=d||h<0||null!=f[h+1],d=y<4?(null!=w||d)&&(0==y||y==(g.s<0?3:2)):u<w||w==u&&(4==y||d||6==y&&1&f[h-1]||y==(g.s<0?8:7)),h<1||!f[0])o=d?v(a.charAt(1),-C,a.charAt(0)):a.charAt(0);else{if(f.length=h,d)for(--s;++f[--h]>s;)f[h]=0,h||(++c,f=[1].concat(f));for(u=f.length;!f[--u];);for(w=0,o="";w<=u;o+=a.charAt(f[w++]));o=v(o,c,a.charAt(0))}return o}}(),n=function(){function e(e,t,n){var o,i,s,r,l=0,a=e.length,h=t%d,c=t/d|0;for(e=e.slice();a--;)l=((i=h*(s=e[a]%d)+(o=c*s+(r=e[a]/d|0)*h)%d*d+l)/n|0)+(o/d|0)+c*r,e[a]=i%n;return l&&(e=[l].concat(e)),e}function t(e,t,n,o){var i,s;if(n!=o)s=o<n?1:-1;else for(i=s=0;i<n;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function n(e,t,n,o){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*o+e[n]-t[n];for(;!e[0]&&1<e.length;e.splice(0,1));}return function(o,i,r,l,c){var u,d,g,m,p,w,C,y,v,b,S,R,E,M,T,x,O,A=o.s==i.s?1:-1,_=o.c,I=i.c;if(!(_&&_[0]&&I&&I[0]))return new j(o.s&&i.s&&(_?!I||_[0]!=I[0]:I)?_&&0==_[0]||!I?0*A:A/0:NaN);for(v=(y=new j(A)).c=[],A=r+(d=o.e-i.e)+1,c||(c=a,d=f(o.e/h)-f(i.e/h),A=A/h|0),g=0;I[g]==(_[g]||0);g++);if(I[g]>(_[g]||0)&&d--,A<0)v.push(1),m=!0;else{for(M=_.length,x=I.length,A+=2,1<(p=s(c/(I[g=0]+1)))&&(I=e(I,p,c),_=e(_,p,c),x=I.length,M=_.length),E=x,S=(b=_.slice(0,x)).length;S<x;b[S++]=0);O=I.slice(),O=[0].concat(O),T=I[0],I[1]>=c/2&&T++;do{if(p=0,(u=t(I,b,x,S))<0){if(R=b[0],x!=S&&(R=R*c+(b[1]||0)),1<(p=s(R/T)))for(c<=p&&(p=c-1),C=(w=e(I,p,c)).length,S=b.length;1==t(w,b,C,S);)p--,n(w,x<C?O:I,C,c),C=w.length,u=1;else 0==p&&(u=p=1),C=(w=I.slice()).length;if(C<S&&(w=[0].concat(w)),n(b,w,S,c),S=b.length,-1==u)for(;t(I,b,x,S)<1;)p++,n(b,x<S?O:I,S,c),S=b.length}else 0===u&&(p++,b=[0]);v[g++]=p,b[0]?b[S++]=_[E]||0:(b=[_[E]],S=1)}while((E++<M||null!=b[0])&&A--);m=null!=b[0],v[0]||v.splice(0,1)}if(c==a){for(g=1,A=v[0];10<=A;A/=10,g++);G(y,r+(y.e=g+d*h-1)+1,l,m)}else y.e=d,y.r=+m;return y}}(),M=/^(-?)0([xbo])(?=\w[\w.]*$)/i,T=/^([^.]+)\.$/,x=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,A=/^\s*\+(?=[\w.])|^\s+|\s+$/g,S=function(e,t,n,o){var i,s=n?t:t.replace(A,"");if(O.test(s))e.s=isNaN(s)?null:s<0?-1:1,e.c=e.e=null;else{if(!n&&(s=s.replace(M,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,o&&o!=i?e:t})),o&&(i=o,s=s.replace(T,"$1").replace(x,"0.$1")),t!=s))return new j(s,i);if(j.DEBUG)throw Error(r+"Not a"+(o?" base "+o:"")+" number: "+t);e.c=e.e=e.s=null}},_.absoluteValue=_.abs=function(){var e=new j(this);return e.s<0&&(e.s=1),e},_.comparedTo=function(e,t){return p(this,new j(e,t))},_.decimalPlaces=_.dp=function(e,t){var n,o,i;if(null!=e)return w(e,0,g),null==t?t=H:w(t,0,8),G(new j(this),e+this.e+1,t);if(!(n=this.c))return null;if(o=((i=n.length-1)-f(this.e/h))*h,i=n[i])for(;i%10==0;i/=10,o--);return o<0&&(o=0),o},_.dividedBy=_.div=function(e,t){return n(this,new j(e,t),k,H)},_.dividedToIntegerBy=_.idiv=function(e,t){return n(this,new j(e,t),0,1)},_.exponentiatedBy=_.pow=function(e,t){var n,o,l,a,c,u,d,g,f=this;if((e=new j(e)).c&&!e.isInteger())throw Error(r+"Exponent not an integer: "+K(e));if(null!=t&&(t=new j(t)),c=14<e.e,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!e.c||!e.c[0])return g=new j(Math.pow(+K(f),c?2-C(e):+K(e))),t?g.mod(t):g;if(u=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new j(NaN);(o=!u&&f.isInteger()&&t.isInteger())&&(f=f.mod(t))}else{if(9<e.e&&(0<f.e||f.e<-1||(0==f.e?1<f.c[0]||c&&24e7<=f.c[1]:f.c[0]<8e13||c&&f.c[0]<=9999975e7)))return a=f.s<0&&C(e)?-0:0,-1<f.e&&(a=1/a),new j(u?1/a:a);B&&(a=i(B/h+2))}for(d=c?(n=new j(.5),u&&(e.s=1),C(e)):(l=Math.abs(+K(e)))%2,g=new j(I);;){if(d){if(!(g=g.times(f)).c)break;a?g.c.length>a&&(g.c.length=a):o&&(g=g.mod(t))}if(l){if(0===(l=s(l/2)))break;d=l%2}else if(G(e=e.times(n),e.e+1,1),14<e.e)d=C(e);else{if(0==(l=+K(e)))break;d=l%2}f=f.times(f),a?f.c&&f.c.length>a&&(f.c.length=a):o&&(f=f.mod(t))}return o?g:(u&&(g=I.div(g)),t?g.mod(t):a?G(g,B,H,void 0):g)},_.integerValue=function(e){var t=new j(this);return null==e?e=H:w(e,0,8),G(t,t.e+1,e)},_.isEqualTo=_.eq=function(e,t){return 0===p(this,new j(e,t))},_.isFinite=function(){return!!this.c},_.isGreaterThan=_.gt=function(e,t){return 0<p(this,new j(e,t))},_.isGreaterThanOrEqualTo=_.gte=function(e,t){return 1===(t=p(this,new j(e,t)))||0===t},_.isInteger=function(){return!!this.c&&f(this.e/h)>this.c.length-2},_.isLessThan=_.lt=function(e,t){return p(this,new j(e,t))<0},_.isLessThanOrEqualTo=_.lte=function(e,t){return-1===(t=p(this,new j(e,t)))||0===t},_.isNaN=function(){return!this.s},_.isNegative=function(){return this.s<0},_.isPositive=function(){return 0<this.s},_.isZero=function(){return!!this.c&&0==this.c[0]},_.minus=function(e,t){var n,o,i,s,r=this,l=r.s;if(t=(e=new j(e,t)).s,!l||!t)return new j(NaN);if(l!=t)return e.s=-t,r.plus(e);var c=r.e/h,u=e.e/h,d=r.c,g=e.c;if(!c||!u){if(!d||!g)return d?(e.s=-t,e):new j(g?r:NaN);if(!d[0]||!g[0])return g[0]?(e.s=-t,e):new j(d[0]?r:3==H?-0:0)}if(c=f(c),u=f(u),d=d.slice(),l=c-u){for((i=(s=l<0)?(l=-l,d):(u=c,g)).reverse(),t=l;t--;i.push(0));i.reverse()}else for(o=(s=(l=d.length)<(t=g.length))?l:t,l=t=0;t<o;t++)if(d[t]!=g[t]){s=d[t]<g[t];break}if(s&&(i=d,d=g,g=i,e.s=-e.s),0<(t=(o=g.length)-(n=d.length)))for(;t--;d[n++]=0);for(t=a-1;l<o;){if(d[--o]<g[o]){for(n=o;n&&!d[--n];d[n]=t);--d[n],d[o]+=a}d[o]-=g[o]}for(;0==d[0];d.splice(0,1),--u);return d[0]?$(e,d,u):(e.s=3==H?-1:1,e.c=[e.e=0],e)},_.modulo=_.mod=function(e,t){var o,i,s=this;return e=new j(e,t),!s.c||!e.s||e.c&&!e.c[0]?new j(NaN):!e.c||s.c&&!s.c[0]?new j(s):(9==F?(i=e.s,e.s=1,o=n(s,e,0,3),e.s=i,o.s*=i):o=n(s,e,0,F),(e=s.minus(o.times(e))).c[0]||1!=F||(e.s=s.s),e)},_.multipliedBy=_.times=function(e,t){var n,o,i,s,r,l,c,u,g,m,p,w,C,y,v,b=this,S=b.c,R=(e=new j(e,t)).c;if(!(S&&R&&S[0]&&R[0]))return!b.s||!e.s||S&&!S[0]&&!R||R&&!R[0]&&!S?e.c=e.e=e.s=null:(e.s*=b.s,S&&R?(e.c=[0],e.e=0):e.c=e.e=null),e;for(o=f(b.e/h)+f(e.e/h),e.s*=b.s,(c=S.length)<(m=R.length)&&(C=S,S=R,R=C,i=c,c=m,m=i),i=c+m,C=[];i--;C.push(0));for(y=a,v=d,i=m;0<=--i;){for(n=0,p=R[i]%v,w=R[i]/v|0,s=i+(r=c);i<s;)n=((u=p*(u=S[--r]%v)+(l=w*u+(g=S[r]/v|0)*p)%v*v+C[s]+n)/y|0)+(l/v|0)+w*g,C[s--]=u%y;C[s]=n}return n?++o:C.splice(0,1),$(e,C,o)},_.negated=function(){var e=new j(this);return e.s=-e.s||null,e},_.plus=function(e,t){var n,o=this,i=o.s;if(t=(e=new j(e,t)).s,!i||!t)return new j(NaN);if(i!=t)return e.s=-t,o.minus(e);var s=o.e/h,r=e.e/h,l=o.c,c=e.c;if(!s||!r){if(!l||!c)return new j(i/0);if(!l[0]||!c[0])return c[0]?e:new j(l[0]?o:0*i)}if(s=f(s),r=f(r),l=l.slice(),i=s-r){for((n=0<i?(r=s,c):(i=-i,l)).reverse();i--;n.push(0));n.reverse()}for((i=l.length)-(t=c.length)<0&&(n=c,c=l,l=n,t=i),i=0;t;)i=(l[--t]=l[t]+c[t]+i)/a|0,l[t]=a===l[t]?0:l[t]%a;return i&&(l=[i].concat(l),++r),$(e,l,r)},_.precision=_.sd=function(e,t){var n,o,i;if(null!=e&&e!==!!e)return w(e,1,g),null==t?t=H:w(t,0,8),G(new j(this),e,t);if(!(n=this.c))return null;if(o=(i=n.length-1)*h+1,i=n[i]){for(;i%10==0;i/=10,o--);for(i=n[0];10<=i;i/=10,o++);}return e&&this.e+1>o&&(o=this.e+1),o},_.shiftedBy=function(e){return w(e,-c,c),this.times("1e"+e)},_.squareRoot=_.sqrt=function(){var e,t,o,i,s,r=this,l=r.c,a=r.s,h=r.e,c=k+4,u=new j("0.5");if(1!==a||!l||!l[0])return new j(!a||a<0&&(!l||l[0])?NaN:l?r:1/0);if((o=0==(a=Math.sqrt(+K(r)))||a==1/0?(((t=m(l)).length+h)%2==0&&(t+="0"),a=Math.sqrt(+t),h=f((h+1)/2)-(h<0||h%2),new j(t=a==1/0?"1e"+h:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+h)):new j(a+"")).c[0])for((a=(h=o.e)+c)<3&&(a=0);;)if(s=o,o=u.times(s.plus(n(r,s,c,1))),m(s.c).slice(0,a)===(t=m(o.c)).slice(0,a)){if(o.e<h&&--a,"9999"!=(t=t.slice(a-3,a+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(G(o,o.e+k+2,1),e=!o.times(o).eq(r));break}if(!i&&(G(s,s.e+k+2,0),s.times(s).eq(r))){o=s;break}c+=4,a+=4,i=1}return G(o,o.e+k+1,H,e)},_.toExponential=function(e,t){return null!=e&&(w(e,0,g),e++),z(this,e,t,1)},_.toFixed=function(e,t){return null!=e&&(w(e,0,g),e=e+this.e+1),z(this,e,t)},_.toFormat=function(e,t,n){var o;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=W;else if("object"!=typeof n)throw Error(r+"Argument not an object: "+n);if(o=this.toFixed(e,t),this.c){var i,s=o.split("."),l=+n.groupSize,a=+n.secondaryGroupSize,h=n.groupSeparator||"",c=s[0],u=s[1],d=this.s<0,g=d?c.slice(1):c,f=g.length;if(a&&(i=l,l=a,f-=a=i),0<l&&0<f){for(i=f%l||l,c=g.substr(0,i);i<f;i+=l)c+=h+g.substr(i,l);0<a&&(c+=h+g.slice(i)),d&&(c="-"+c)}o=u?c+(n.decimalSeparator||"")+((a=+n.fractionGroupSize)?u.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):u):c}return(n.prefix||"")+o+(n.suffix||"")},_.toFraction=function(e){var t,o,i,s,l,a,c,d,g,f,p,w,C=this,y=C.c;if(null!=e&&(!(c=new j(e)).isInteger()&&(c.c||1!==c.s)||c.lt(I)))throw Error(r+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+K(c));if(!y)return new j(C);for(t=new j(I),g=o=new j(I),i=d=new j(I),w=m(y),l=t.e=w.length-C.e-1,t.c[0]=u[(a=l%h)<0?h+a:a],e=!e||0<c.comparedTo(t)?0<l?t:g:c,a=L,L=1/0,c=new j(w),d.c[0]=0;f=n(c,t,0,1),1!=(s=o.plus(f.times(i))).comparedTo(e);)o=i,i=s,g=d.plus(f.times(s=g)),d=s,t=c.minus(f.times(s=t)),c=s;return s=n(e.minus(o),i,0,1),d=d.plus(s.times(g)),o=o.plus(s.times(i)),d.s=g.s=C.s,p=n(g,i,l*=2,H).minus(C).abs().comparedTo(n(d,o,l,H).minus(C).abs())<1?[g,i]:[d,o],L=a,p},_.toNumber=function(){return+K(this)},_.toPrecision=function(e,t){return null!=e&&w(e,1,g),z(this,e,t,2)},_.toString=function(e){var t,n=this,o=n.s,i=n.e;return null===i?o?(t="Infinity",o<0&&(t="-"+t)):t="NaN":(t=null==e?i<=D||N<=i?y(m(n.c),i):v(m(n.c),i,"0"):10===e?v(m((n=G(new j(n),k+i+1,H)).c),n.e,"0"):(w(e,2,U.length,"Base"),b(v(m(n.c),i,"0"),10,e,o,!0)),o<0&&n.c[0]&&(t="-"+t)),t},_.valueOf=_.toJSON=function(){return K(this)},_._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(_[Symbol.toStringTag]="BigNumber",_[Symbol.for("nodejs.util.inspect.custom")]=_.valueOf),null!=t&&j.set(t),j}()).default=n.BigNumber=n,void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)},{}],2:[function(e,t,n){t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,n){function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,i=!1,s=void 0;try{for(var r,l=e[Symbol.iterator]();!(o=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){i=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw s}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=e("./globalState"),s=e("./validating"),r=e("./parsing"),l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a={general:{scale:1024,suffixes:l,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:l,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function c(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("string"==typeof t&&(t=r.parseFormat(t)),!s.validateFormat(t))return"ERROR: invalid format";var o=t.prefix||"",l=t.postfix||"",c=function(e,t,n){switch(t.output){case"currency":return function(e,t,n){var o=n.currentCurrency(),i=Object.assign({},h,t),s=void 0,r="",l=!!i.totalLength||!!i.forceAverage||i.average,a=t.currencyPosition||o.position,c=t.currencySymbol||o.symbol;i.spaceSeparated&&(r=" "),"infix"===a&&(s=r+c+r);var u=f({instance:e,providedFormat:t,state:n,decimalSeparator:s});return"prefix"===a&&(u=e._value<0&&"sign"===i.negative?"-".concat(r).concat(c).concat(u.slice(1)):c+r+u),a&&"postfix"!==a||(u=u+(r=l?"":r)+c),u}(e,t=m(t,i.currentCurrencyDefaultFormat()),i);case"percent":return function(e,t,n,o){var i=t.prefixSymbol,s=f({instance:o(100*e._value),providedFormat:t,state:n}),r=Object.assign({},h,t);return i?"%".concat(r.spaceSeparated?" ":"").concat(s):"".concat(s).concat(r.spaceSeparated?" ":"","%")}(e,t=m(t,i.currentPercentageDefaultFormat()),i,n);case"byte":return t=m(t,i.currentByteDefaultFormat()),v=e,S=i,R=n,E=(b=t).base||"binary",M=a[E],x=(T=u(v._value,M.suffixes,M.scale)).value,O=T.suffix,A=f({instance:R(x),providedFormat:b,state:S,defaults:S.currentByteDefaultFormat()}),_=S.currentAbbreviations(),"".concat(A).concat(_.spaced?" ":"").concat(O);case"time":return t=m(t,i.currentTimeDefaultFormat()),p=e,w=Math.floor(p._value/60/60),C=Math.floor((p._value-60*w*60)/60),y=Math.round(p._value-60*w*60-60*C),"".concat(w,":").concat(C<10?"0":"").concat(C,":").concat(y<10?"0":"").concat(y);case"ordinal":return o=e,s=t=m(t,i.currentOrdinalDefaultFormat()),l=(r=i).currentOrdinal(),c=Object.assign({},h,s),d=f({instance:o,providedFormat:s,state:r}),g=l(o._value),"".concat(d).concat(c.spaceSeparated?" ":"").concat(g);default:return f({instance:e,providedFormat:t,numbro:n})}var o,s,r,l,c,d,g,p,w,C,y,v,b,S,R,E,M,T,x,O,A,_}(e,t,n);return(c=o+c)+l}function u(e,t,n){var o=t[0],i=Math.abs(e);if(n<=i){for(var s=1;s<t.length;++s){var r=Math.pow(n,s),l=Math.pow(n,s+1);if(r<=i&&i<l){o=t[s],e/=r;break}}o===t[0]&&(e/=Math.pow(n,t.length-1),o=t[t.length-1])}return{value:e,suffix:o}}function d(e){for(var t="",n=0;n<e;n++)t+="0";return t}function g(e,t){return-1!==e.toString().indexOf("e")?function(e,t){var n=e.toString(),i=o(n.split("e"),2),s=i[0],r=i[1],l=o(s.split("."),2),a=l[0],h=l[1],c=void 0===h?"":h;if(0<+r)n=a+c+d(r-c.length);else{var u=".";u=+a<0?"-0".concat(u):"0".concat(u);var g=(d(-r-1)+Math.abs(a)+c).substr(0,t);g.length<t&&(g+=d(t-g.length)),n=u+g}return 0<+r&&0<t&&(n+=".".concat(d(t))),n}(e,t):(Math.round(+"".concat(e,"e+").concat(t))/Math.pow(10,t)).toFixed(t)}function f(e){var t=e.instance,n=e.providedFormat,s=e.state,r=void 0===s?i:s,l=e.decimalSeparator,a=e.defaults,c=void 0===a?r.currentDefaults():a,u=t._value;if(0===u&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(u))return u.toString();var d,f,m,p,w,C,y,v,b=Object.assign({},h,c,n),S=b.totalLength,R=S?0:b.characteristic,E=b.optionalCharacteristic,M=b.forceAverage,T=!!S||!!M||b.average,x=S?-1:T&&void 0===n.mantissa?0:b.mantissa,O=!S&&(void 0===n.optionalMantissa?-1===x:b.optionalMantissa),A=b.trimMantissa,_=b.thousandSeparated,I=b.spaceSeparated,k=b.negative,H=b.forceSign,D=b.exponential,N="";if(T){var P=function(e){var t=e.value,n=e.forceAverage,o=e.abbreviations,i=e.spaceSeparated,s=void 0!==i&&i,r=e.totalLength,l=void 0===r?0:r,a="",h=Math.abs(t),c=-1;if(h>=Math.pow(10,12)&&!n||"trillion"===n?(a=o.trillion,t/=Math.pow(10,12)):h<Math.pow(10,12)&&h>=Math.pow(10,9)&&!n||"billion"===n?(a=o.billion,t/=Math.pow(10,9)):h<Math.pow(10,9)&&h>=Math.pow(10,6)&&!n||"million"===n?(a=o.million,t/=Math.pow(10,6)):(h<Math.pow(10,6)&&h>=Math.pow(10,3)&&!n||"thousand"===n)&&(a=o.thousand,t/=Math.pow(10,3)),a&&(a=(s?" ":"")+a),l){var u=t.toString().split(".")[0];c=Math.max(l-u.length,0)}return{value:t,abbreviation:a,mantissaPrecision:c}}({value:u,forceAverage:M,abbreviations:r.currentAbbreviations(),spaceSeparated:I,totalLength:S});u=P.value,N+=P.abbreviation,S&&(x=P.mantissaPrecision)}if(D){var L=(f=(d={value:u,characteristicPrecision:R}).value,p=void 0===(m=d.characteristicPrecision)?0:m,C=(w=o(f.toExponential().split("e"),2))[0],y=w[1],v=+C,p&&1<p&&(v*=Math.pow(10,p-1),y=0<=(y=+y-(p-1))?"+".concat(y):y),{value:v,abbreviation:"e".concat(y)});u=L.value,N=L.abbreviation+N}var V,F,B,W=function(e,t,n,i,s){if(-1===i)return e;var r=g(t,i),l=o(r.toString().split("."),2),a=l[0],h=l[1],c=void 0===h?"":h;if(c.match(/^0+$/)&&(n||s))return a;var u=c.match(/0+$/);return s&&u?"".concat(a,".").concat(c.toString().slice(0,u.index)):r.toString()}(u.toString(),u,O,x,A);return W=function(e,t,n,o,i){var s=o.currentDelimiters(),r=s.thousands;i=i||s.decimal;var l=s.thousandsSize||3,a=e.toString(),h=a.split(".")[0],c=a.split(".")[1];return n&&(t<0&&(h=h.slice(1)),function(e,t){for(var n=[],o=0,i=e;0<i;i--)o===t&&(n.unshift(i),o=0),o++;return n}(h.length,l).forEach((function(e,t){h=h.slice(0,e+t)+r+h.slice(e+t)})),t<0&&(h="-".concat(h))),c?h+i+c:h}(W=function(e,t,n,i){var s=e,r=o(s.toString().split("."),2),l=r[0],a=r[1];if(l.match(/^-?0$/)&&n)return a?"".concat(l.replace("0",""),".").concat(a):l.replace("0","");if(l.length<i)for(var h=i-l.length,c=0;c<h;c++)s="0".concat(s);return s.toString()}(W,0,E,R),u,_,r,l),(T||D)&&(W+=N),(H||u<0)&&(V=W,B=k,W=0===(F=u)?V:0==+V?V.replace("-",""):0<F?"+".concat(V):"sign"===B?V:"(".concat(V.replace("-",""),")")),W}function m(e,t){if(!e)return t;var n=Object.keys(e);return 1===n.length&&"output"===n[0]?t:e}t.exports=function(e){return{format:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return c.apply(void 0,n.concat([e]))},getByteUnit:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(e){var t=a.general;return u(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},getBinaryByteUnit:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(e){var t=a.binary;return u(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},getDecimalByteUnit:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(e){var t=a.decimal;return u(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},formatOrDefault:m}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,n){var o=e("./en-US"),i=e("./validating"),s=e("./parsing"),r={},l=void 0,a={},h=null,c={};function u(e){l=e}function d(){return a[l]}r.languages=function(){return Object.assign({},a)},r.currentLanguage=function(){return l},r.currentCurrency=function(){return d().currency},r.currentAbbreviations=function(){return d().abbreviations},r.currentDelimiters=function(){return d().delimiters},r.currentOrdinal=function(){return d().ordinal},r.currentDefaults=function(){return Object.assign({},d().defaults,c)},r.currentOrdinalDefaultFormat=function(){return Object.assign({},r.currentDefaults(),d().ordinalFormat)},r.currentByteDefaultFormat=function(){return Object.assign({},r.currentDefaults(),d().byteFormat)},r.currentPercentageDefaultFormat=function(){return Object.assign({},r.currentDefaults(),d().percentageFormat)},r.currentCurrencyDefaultFormat=function(){return Object.assign({},r.currentDefaults(),d().currencyFormat)},r.currentTimeDefaultFormat=function(){return Object.assign({},r.currentDefaults(),d().timeFormat)},r.setDefaults=function(e){e=s.parseFormat(e),i.validateFormat(e)&&(c=e)},r.getZeroFormat=function(){return h},r.setZeroFormat=function(e){return h="string"==typeof e?e:null},r.hasZeroFormat=function(){return null!==h},r.languageData=function(e){if(e){if(a[e])return a[e];throw new Error('Unknown tag "'.concat(e,'"'))}return d()},r.registerLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!i.validateLanguage(e))throw new Error("Invalid language data");a[e.languageTag]=e,t&&u(e.languageTag)},r.setLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:o.languageTag;if(!a[e]){var n=e.split("-")[0],i=Object.keys(a).find((function(e){return e.split("-")[0]===n}));return a[i]?void u(i):void u(t)}u(e)},r.registerLanguage(o),l=o.languageTag,t.exports=r},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(e,t,n){t.exports=function(t){return{loadLanguagesInNode:function(n){return o=t,void n.forEach((function(t){var n=void 0;try{n=e("../languages/".concat(t))}catch(n){console.error('Unable to load "'.concat(t,'". No matching language file found.'))}n&&o.registerLanguage(n)}));var o}}}},{}],6:[function(e,t,n){var o=e("bignumber.js");function i(e,t,n){var i=new o(e._value),s=t;return n.isNumbro(t)&&(s=t._value),s=new o(s),e._value=i.minus(s).toNumber(),e}t.exports=function(e){return{add:function(t,n){return s=n,r=e,l=new o((i=t)._value),a=s,r.isNumbro(s)&&(a=s._value),a=new o(a),i._value=l.plus(a).toNumber(),i;var i,s,r,l,a},subtract:function(t,n){return i(t,n,e)},multiply:function(t,n){return s=n,r=e,l=new o((i=t)._value),a=s,r.isNumbro(s)&&(a=s._value),a=new o(a),i._value=l.times(a).toNumber(),i;var i,s,r,l,a},divide:function(t,n){return s=n,r=e,l=new o((i=t)._value),a=s,r.isNumbro(s)&&(a=s._value),a=new o(a),i._value=l.dividedBy(a).toNumber(),i;var i,s,r,l,a},set:function(t,n){return o=t,s=i=n,e.isNumbro(i)&&(s=i._value),o._value=s,o;var o,i,s},difference:function(t,n){return o=n,i(r=(s=e)(t._value),o,s),Math.abs(r._value);var o,s,r}}}},{"bignumber.js":1}],7:[function(e,t,n){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=e("./globalState"),s=e("./validating"),r=e("./loading")(g),l=e("./unformatting"),a=e("./formatting")(g),h=e("./manipulating")(g),c=e("./parsing"),u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._value=t}var t;return(t=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a.format(this,e)}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=c.parseFormat(e)),(e=a.formatOrDefault(e,i.currentCurrencyDefaultFormat())).output="currency",a.format(this,e)}},{key:"formatTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",a.format(this,e)}},{key:"binaryByteUnits",value:function(){return a.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return a.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return a.getByteUnit(this)}},{key:"difference",value:function(e){return h.difference(this,e)}},{key:"add",value:function(e){return h.add(this,e)}},{key:"subtract",value:function(e){return h.subtract(this,e)}},{key:"multiply",value:function(e){return h.multiply(this,e)}},{key:"divide",value:function(e){return h.divide(this,e)}},{key:"set",value:function(e){return h.set(this,d(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(e.prototype,t),e}();function d(e){var t=e;return g.isNumbro(e)?t=e._value:"string"==typeof e?t=g.unformat(e):isNaN(e)&&(t=NaN),t}function g(e){return new u(d(e))}g.version="2.1.2",g.isNumbro=function(e){return e instanceof u},g.language=i.currentLanguage,g.registerLanguage=i.registerLanguage,g.setLanguage=i.setLanguage,g.languages=i.languages,g.languageData=i.languageData,g.zeroFormat=i.setZeroFormat,g.defaultFormat=i.currentDefaults,g.setDefaults=i.setDefaults,g.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,g.validate=s.validate,g.loadLanguagesInNode=r.loadLanguagesInNode,g.unformat=l.unformat,t.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,n){t.exports={parseFormat:function(e){var t,n,o,i,s,r,l,a,h,c,u,d,g,f,m,p,w,C,y,v,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(n=b,s=b,function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",t.base="general"):-1!==e.indexOf("b")?(t.output="byte",t.base="binary"):-1!==e.indexOf("d")?(t.output="byte",t.base="decimal"):-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time";t.output="percent"}else t.output="currency"}(e=(r=(i=e=(o=(t=e).match(/^{([^}]*)}/))?(n.prefix=o[1],t.slice(o[0].length)):t).match(/{([^}]*)}$/))?(s.postfix=r[1],i.slice(0,-r[0].length)):i,b),l=b,(a=e.match(/[1-9]+[0-9]*/))&&(l.totalLength=+a[0]),h=b,(c=e.split(".")[0].match(/0+/))&&(h.characteristic=c[0].length),function(e,t){if(-1!==e.indexOf(".")){var n=e.split(".")[0];t.optionalCharacteristic=-1===n.indexOf("0")}}(e,b),u=b,-1!==e.indexOf("a")&&(u.average=!0),g=b,-1!==(d=e).indexOf("K")?g.forceAverage="thousand":-1!==d.indexOf("M")?g.forceAverage="million":-1!==d.indexOf("B")?g.forceAverage="billion":-1!==d.indexOf("T")&&(g.forceAverage="trillion"),function(e,t){var n=e.split(".")[1];if(n){var o=n.match(/0+/);o&&(t.mantissa=o[0].length)}}(e,b),m=b,(f=e).match(/\[\.]/)?m.optionalMantissa=!0:f.match(/\./)&&(m.optionalMantissa=!1),p=b,-1!==e.indexOf(",")&&(p.thousandSeparated=!0),w=b,-1!==e.indexOf(" ")&&(w.spaceSeparated=!0),y=b,(C=e).match(/^\+?\([^)]*\)$/)&&(y.negative="parenthesis"),C.match(/^\+?-/)&&(y.negative="sign"),v=b,e.match(/^\+/)&&(v.forceSign=!0),b)}}},{}],9:[function(e,t,n){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function i(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=3<arguments.length?arguments[3]:void 0,r=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,a=6<arguments.length?arguments[6]:void 0;if(""!==e)return e===r?0:function e(t,n){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=3<arguments.length?arguments[3]:void 0,l=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,h=6<arguments.length?arguments[6]:void 0;if(!isNaN(+t))return+t;var c="",u=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(u!==t)return-1*e(u,n,s,r,l,a,h);for(var d=0;d<o.length;d++){var g=o[d];if((c=t.replace(g.key,""))!==t)return e(c,n,s,r,l,a,h)*g.factor}if((c=t.replace("%",""))!==t)return e(c,n,s,r,l,a,h)/100;var f=parseFloat(t);if(!isNaN(f)){var m=r(f);if(m&&"."!==m&&(c=t.replace(new RegExp("".concat(i(m),"$")),""))!==t)return e(c,n,s,r,l,a,h);var p={};Object.keys(a).forEach((function(e){p[a[e]]=e}));for(var w=Object.keys(p).sort().reverse(),C=w.length,y=0;y<C;y++){var v=w[y],b=p[v];if((c=t.replace(v,""))!==t){var S=void 0;switch(b){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return e(c,n,s,r,l,a,h)*S}}}}(function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=e.replace(n,"");return(o=o.replace(new RegExp("([0-9])".concat(i(t.thousands),"([0-9])"),"g"),"$1$2")).replace(t.decimal,".")}(e,t,n),t,n,s,r,l,a)}t.exports={unformat:function(t,n){var o,i,r,l=e("./globalState"),a=l.currentDelimiters(),h=l.currentCurrency().symbol,c=l.currentOrdinal(),u=l.getZeroFormat(),d=l.currentAbbreviations(),g=void 0;if("string"==typeof t)g=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;var n=e.split(":");if(3!==n.length)return!1;var o=+n[0],i=+n[1],s=+n[2];return!isNaN(o)&&!isNaN(i)&&!isNaN(s)}(t,a)?(i=+(o=t.split(":"))[0],r=+o[1],+o[2]+60*r+3600*i):s(t,a,h,c,u,d,n);else{if("number"!=typeof t)return;g=t}if(void 0!==g)return g}}},{"./globalState":4}],10:[function(e,t,n){function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=e("./unformatting"),r=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,l={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return 0<=e},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},a={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(r)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(e){return!!s.unformat(e)}function c(e,t,n){var s=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=Object.keys(e).map((function(o){if(!t[o])return console.error("".concat(n," Invalid key: ").concat(o)),!1;var s=e[o],r=t[o];if("string"==typeof r&&(r={type:r}),"format"===r.type){if(!c(s,l,"[Validate ".concat(o,"]"),!0))return!1}else if(i(s)!==r.type)return console.error("".concat(n," ").concat(o,' type mismatched: "').concat(r.type,'" expected, "').concat(i(s),'" provided')),!1;if(r.restrictions&&r.restrictions.length)for(var a=r.restrictions.length,h=0;h<a;h++){var u=r.restrictions[h],d=u.restriction,g=u.message;if(!d(s,e))return console.error("".concat(n," ").concat(o," invalid value: ").concat(g)),!1}return r.restriction&&!r.restriction(s,e)?(console.error("".concat(n," ").concat(o," invalid value: ").concat(r.message)),!1):r.validValues&&-1===r.validValues.indexOf(s)?(console.error("".concat(n," ").concat(o," invalid value: must be among ").concat(JSON.stringify(r.validValues),', "').concat(s,'" provided')),!1):!(r.children&&!c(s,r.children,"[Validate ".concat(o,"]")))}));return s||r.push.apply(r,o(Object.keys(t).map((function(o){var i=t[o];if("string"==typeof i&&(i={type:i}),i.mandatory){var s=i.mandatory;if("function"==typeof s&&(s=s(e)),s&&void 0===e[o])return console.error("".concat(n,' Missing mandatory key "').concat(o,'"')),!1}return!0})))),r.reduce((function(e,t){return e&&t}),!0)}function u(e){return c(e,l,"[Validate format]")}t.exports={validate:function(e,t){var n=h(e),o=u(t);return n&&o},validateFormat:u,validateInput:h,validateLanguage:function(e){return c(e,a,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7);var Iy=l(_y.exports);function ky(e,t,n,o,i,s,r){let l=s;if(Ou(l)){const e=r.numericFormat,n=e&&e.culture||"-",o=e&&e.pattern,i=r.className||"",s=i.length?i.split(" "):[];if(void 0!==n&&!Iy.languages()[n]){const e=n.replace("-",""),t=Iy.allLanguages?Iy.allLanguages[n]:Iy[e];t&&Iy.registerLanguage(t)}Iy.setLanguage(n),l=Iy(l).format(o||"0"),s.indexOf("htLeft")<0&&s.indexOf("htCenter")<0&&s.indexOf("htRight")<0&&s.indexOf("htJustify")<0&&s.push("htRight"),s.indexOf("htNumeric")<0&&s.push("htNumeric"),r.className=s.join(" "),t.dir="ltr"}QC(e,t,n,o,i,l,r)}ky.RENDERER_TYPE="numeric";function Hy(e,t,n,o,i,s,r){QC.apply(this,[e,t,n,o,i,s,r]);const l=r.hashLength||t.innerHTML.length,a=r.hashSymbol||"*";let h="";_u(l-1,(()=>{h+=a})),Wa(t,h)}Hy.RENDERER_TYPE="password";function Dy(e,t,n,o,i,s,r){QC.apply(this,[e,t,n,o,i,s,r]),t.dir="ltr"}Dy.RENDERER_TYPE="time";function Ny(e,t){let n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,Py(n,t)):Py(n,t)(this.source):t(!0)}function Py(e,t){const n=e;return function(e){let o=!1;for(let t=0,i=e.length;t<i;t++)if(n===e[t]){o=!0;break}t(o)}}function Ly(e){const t=new Date(e);return isNaN(new Date(`${e}T00:00`).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}Ny.VALIDATOR_TYPE="autocomplete";var Vy=Object.freeze({__proto__:null,getNormalizedDate:Ly});function Fy(e,t){const n=du(cy,this.instance);let o=e,i=!0;null==o&&(o="");let s=jl(o,this.dateFormat||n.defaultDateFormat,!0).isValid(),r=jl(new Date(o)).isValid()||s;if(this.allowEmpty&&""===o&&(r=!0,s=!0),r||(i=!1),!r&&s&&(i=!0),r&&!s)if(!0===this.correctFormat){const e=function(e,t){const n=jl(Ly(e)),o=jl(e,t),i=e.search(/[A-z]/g)>-1;let s;s=n.isValid()&&n.format("x")===o.format("x")||!o.isValid()||i?n:o;return s.format(t)}(o,this.dateFormat),t=this.instance.toVisualRow(this.row),n=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(t,n,e,"dateValidator"),i=!0}else i=!1;t(i)}Fy.VALIDATOR_TYPE="date";function By(e,t){let n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&Ou(e))}By.VALIDATOR_TYPE="numeric";const Wy=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function Uy(e,t){const n=this.timeFormat||"h:mm:ss a";let o=!0,i=e;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const r=jl(i,Wy,!0).isValid()?jl(i):jl(i,n);let l=r.isValid(),a=jl(i,n,!0).isValid()&&!s;if(this.allowEmpty&&""===i&&(l=!0,a=!0),l||(o=!1),!l&&a&&(o=!0),l&&!a)if(!0===this.correctFormat){const e=r.format(n),t=this.instance.toVisualRow(this.row),i=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(t,i,e,"timeValidator"),o=!0}else o=!1;t(o)}Uy.VALIDATOR_TYPE="time";const jy={CELL_TYPE:"autocomplete",editor:ry,renderer:by,validator:Ny},zy={CELL_TYPE:"checkbox",editor:ly,renderer:Oy},Yy={CELL_TYPE:"date",editor:dy,renderer:by,validator:Fy},$y={CELL_TYPE:"dropdown",editor:gy,renderer:by,validator:Ny},Gy={CELL_TYPE:"handsontable",editor:oy,renderer:by},Ky={CELL_TYPE:"numeric",editor:fy,renderer:ky,validator:By,dataType:"number"},qy={CELL_TYPE:"password",editor:my,renderer:Hy,copyable:!1},Xy={CELL_TYPE:"time",editor:yy,renderer:Dy,validator:Uy};function Zy(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}const Jy=new Map([["plugin",function(e){return!!$u(e)}],["cell-type",fC],["editor",au],["renderer",Xu],["validator",od]]),Qy=new WeakMap,ev=[];let tv=null;var nv=new WeakSet;class ov{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){Zy(this,nv),dc(this,"hot",e,{writable:!1}),Qy.set(this,{hooks:{}}),tv=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(e=>this.onUpdateSettings(e))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const e=[];if(t.forEach((t=>{const[n,o]=t.split(":");if(!Jy.has(n))throw new Error(`Unknown plugin dependency type "${n}" was found.`);Jy.get(n)(o)||e.push(` - ${o} (${n})`)})),e.length>0){const t=[`The ${this.pluginName} plugin requires the following modules:\n`,`${e.join("\n")}\n`].join("");ev.push(t)}}tv||(tv=Yu()),tv.indexOf("UndoRedo")>=0&&tv.splice(tv.indexOf("UndoRedo"),1),tv.indexOf(this.pluginName)>=0&&tv.splice(tv.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));if(0===tv.length){if(ev.length>0){const e=[`${ev.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(e)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t){Qy.get(this).hooks[e]=Qy.get(this).hooks[e]||[];const n=Qy.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),Qy.get(this).hooks[e]=n}removeHooks(e){Xl(Qy.get(this).hooks[e]||[],(t=>{this.hot.removeHook(e,t)}))}clearHooks(){const e=Qy.get(this).hooks;gc(e,((e,t)=>this.removeHooks(t))),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Xl(this.pluginsInitializedCallbacks,(e=>e())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,nv,iv).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),gc(this,((e,t)=>{"hot"!==t&&(this[t]=null)})),delete this.t,delete this.hot}}function iv(e){if(!e)return!1;const t=this.constructor.SETTING_KEYS;if("boolean"==typeof t)return t;for(let n=0;n<t.length;n++)if(void 0!==e[t[n]])return!0;return!1}var sv=class{constructor(e){this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(null!=t){const t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Xl(this.rows,(t=>{e(t.row,eh(t.table)-1)}))}getWidths(e){this.injected||this.injectTable(),Xl(this.columns,(t=>{const{width:n}=t.table.getBoundingClientRect();e(t.col,Math.ceil(n))}))}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach((t=>{Xl(t.strings,(t=>{e.appendChild(this.createColElement(t.col))}))})),e}createRow(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),o=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),n.appendChild(o)),this.samples.forEach((o=>{Xl(o.strings,(o=>{const i=o.col,s=this.hot.getCellMeta(e,i);s.col=i,s.row=e;const r=this.hot.getCellRenderer(s),l=t.createElement("td");l.setAttribute("ghost-table",1),r(this.hot,l,e,i,this.hot.colToProp(i),o.value,s),n.appendChild(l)}))})),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const o=e.createElement("th");n.push([-1,o]),t.appendChild(o)}this.samples.forEach((o=>{Xl(o.strings,(o=>{const i=o.col,s=e.createElement("th");n.push([i,s]),t.appendChild(s)}))})),this.table.tHead.appendChild(t),Xl(n,(e=>{const[t,n]=e;this.hot.view.appendColHeader(t,n)}))}createCol(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment();return this.samples.forEach((o=>{Xl(o.strings,(o=>{const i=o.row,s=this.hot.getCellMeta(i,e);s.col=e,s.row=i;const r=this.hot.getCellRenderer(s),l=t.createElement("td"),a=t.createElement("tr");l.setAttribute("ghost-table",1),r(this.hot,l,i,e,this.hot.colToProp(e),o.value,s),a.appendChild(l),n.appendChild(a)}))})),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e){const t=this.hot.rootDocument.createElement("col");return t.style.width=`${this.hot.view._wt.wtTable.getStretchedColumnWidth(e)}px`,t}createTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),o=t.createElement("table"),i=t.createElement("thead"),s=t.createElement("tbody"),r=t.createElement("colgroup"),l=t.createElement("tr"),a=t.createElement("th");return this.isVertical()&&o.appendChild(r),this.isHorizontal()&&(l.appendChild(a),i.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&s.appendChild(l),o.appendChild(s),Pa(o,e),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:s,colGroup:r,tr:l,th:a}}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),o=t.createElement("div");return Pa(o,`htGhostTable htAutoSize ${e.trim()}`),n.appendChild(o),{fragment:n,container:o}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};class rv{static get SAMPLE_COUNT(){return 3}constructor(e){this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount?this.customSampleCount:rv.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,n){const o=new Map,{from:i,to:s}="number"==typeof n?{from:n,to:n}:n;return _u(i,s,(n=>{const i=this.generateSample(e,t,n);o.set(n,i)})),o}generateSample(e,t,n){if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");const o=new Map,i="row"===e?"col":"row",s=[];return _u(t.from,t.to,(t=>{const{value:r,bundleSeed:l}="row"===e?this.dataFactory(n,t):this.dataFactory(t,n),a="string"==typeof l&&l.length>0;let h;h=a?l:uc(r)?`${Object.keys(r).length}`:Array.isArray(r)?`${r.length}`:`${oa(r).length}`,o.has(h)||o.set(h,{needed:this.getSampleCount(),strings:[]});const c=o.get(h);if(c.needed){(!(s.indexOf(r)>-1)||this.allowDuplicates||a)&&(c.strings.push({value:r,[i]:t}),s.push(r),c.needed-=1)}})),o}}var lv=rv;nu.getSingleton().register("modifyAutoColumnSizeSeed");const av="autoColumnSize",hv=new WeakMap;class cv extends ov{static get PLUGIN_KEY(){return av}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),hv.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new sv(this.hot),this.samplesGenerator=new lv(((e,t)=>{const n=this.hot.getCellMeta(e,t);let o="";n.spanned||(o=this.hot.getDataAtCell(e,t));let i="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=this.hot.runHooks("modifyAutoColumnSizeSeed",i,n,o)),{value:o,bundleSeed:i}})),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new gm,this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",((e,t,n)=>this.onBeforeColumnResize(e,t,n)))}isEnabled(){return!1!==this.hot.getSettings()[av]&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[av];t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData(...arguments)})),this.addHook("beforeChangeRender",(e=>this.onBeforeChange(e))),this.addHook("afterFormulasValuesUpdate",(e=>this.onAfterFormulasValuesUpdate(e))),this.addHook("beforeViewRender",(e=>this.onBeforeViewRender(e))),this.addHook("modifyColWidth",((e,t)=>this.getColumnWidth(t,e))),this.addHook("afterInit",(()=>this.onAfterInit())),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((e,t,n)=>this.onBeforeColumnResize(e,t,n)))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.hot.renderCall,t=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1!==t&&-1!==n&&this.calculateColumnsWidth({from:t,to:n},void 0,e)}calculateColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o="number"==typeof e?{from:e,to:e}:e,i="number"==typeof t?{from:t,to:t}:t;_u(o.from,o.to,(e=>{let t=this.hot.toPhysicalColumn(e);if(null===t&&(t=e),n||null===this.columnWidthsMap.getValueAtIndex(t)&&!this.hot._getColWidthFromSettings(t)){Xl(this.samplesGenerator.generateColumnSamples(e,i),(e=>{let[t,n]=e;return this.ghostTable.addColumn(t,n)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((e,t)=>{const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=0;const n=this.hot.countCols()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot)return cg(o),void(this.inProgress=!1);this.calculateColumnsWidth({from:t,to:Math.min(t+cv.CALCULATION_STEP,n)},e),t=t+cv.CALCULATION_STEP+1,t<n?o=hg(i):(cg(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,t=s+1),t<n?i():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[av],t=e&&Cc(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Cc(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[av];let t=cv.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return uc(e)&&(t=e.syncLimit,ba(t)?t=ku(n,t):t>>=0),Math.min(t,n)}getColumnWidth(e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),t&&"number"==typeof n&&(n=Math.max(n,jd.DEFAULT_WIDTH))),n}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getFirstRenderedColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getLastRenderedColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader(),{cachedColumnHeaders:t}=hv.get(this);return Gl(e,((e,n,o)=>{const i=t.length;return(i-1<o||t[o]!==n)&&e.push(o),i-1<o?t.push(n):t[o]=n,e}),[])}clearCache(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?this.hot.batchExecution((()=>{Xl(e,(e=>{this.columnWidthsMap.setValueAtIndex(e,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!Kl(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(e=>null===e)).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout((()=>{this.hot&&this.recalculateAllColumnsWidth()}),0)}onBeforeChange(e){const t=ql(e,(e=>{let[,t]=e;return this.hot.toPhysicalColumn(this.hot.propToCol(t))}));this.clearCache(Array.from(new Set(t)))}onBeforeColumnResize(e,t,n){let o=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),o=this.getColumnWidth(t,void 0,!1)),o}onAfterInit(){hv.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){const t=ql(Kl(e,(e=>{var t;return ia(null===(t=e.address)||void 0===t?void 0:t.col)})),(e=>e.address.col));this.clearCache(Array.from(new Set(t)))}destroy(){this.ghostTable.clean(),super.destroy()}}const uv={horizontal:"horizontal",vertical:"vertical"};nu.getSingleton().register("modifyAutofillRange"),nu.getSingleton().register("beforeAutofill"),nu.getSingleton().register("afterAutofill");const dv="autofill",gv=["fillHandle"];class fv extends ov{static get PLUGIN_KEY(){return dv}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[dv,...gv]}constructor(e){super(e),this.eventManager=new pu(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(e=>this.onAfterCellCornerMouseDown(e))),this.addHook("afterOnCellCornerDblClick",(e=>this.onCellCornerDblClick(e))),this.addHook("beforeOnCellMouseOver",((e,t)=>this.onBeforeCellMouseOver(t))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:n}=e.getTopStartCorner(),{row:o,col:i}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:n,endRow:o,endCol:i}]),r=[],l=[],a=[];return Xl(s,(e=>{for(let t=e.startRow;t<=e.endRow;t+=1)-1===r.indexOf(t)&&r.push(t);for(let t=e.startCol;t<=e.endCol;t+=1)-1===l.indexOf(t)&&l.push(t)})),Xl(r,(e=>{const t=[];Xl(l,(n=>{t.push(this.hot.getCopyableData(e,n))})),a.push(t)})),a}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,n,o]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),s=i.getTopStartCorner(),r=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,r.row,r.col],a=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,t),Math.max(r.row,n),Math.max(r.col,o)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:u}=function(e,t,n){let o,i,s;return t[0]===e[0]&&t[1]<e[1]?(s="left",o=n(t[0],t[1]),i=n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(s="right",o=n(t[0],e[3]+1),i=n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(s="up",o=n(t[0],t[1]),i=n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(s="down",o=n(e[2]+1,t[1]),i=n(t[2],t[3])),o&&o.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:o,endOfDragCoords:i}}(l,a,((e,t)=>this.hot._createCellCoords(e,t)));if(c&&c.row>-1&&c.col>-1){const e=this.getSelectionData(),t=i.clone(),n=this.hot._createCellRange(c,c,u),o=this.hot.runHooks("beforeAutofill",e,t,n,h);if(!1===o)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let s=o;const r=o;if(["up","left"].indexOf(h)>-1&&(1!==r.length||0!==r[0].length))if(s=[],"up"===h){const e=u.row-c.row+1,t=e%r.length;for(let n=0;n<e;n++)s.push(r[(n+(r.length-t))%r.length])}else{const e=u.col-c.col+1,t=e%r[0].length;for(let n=0;n<r.length;n++){s.push([]);for(let o=0;o<e;o++)s[n].push(r[n][(o+(r[n].length-t))%r[n].length])}}this.hot.populateFromArray(c.row,c.col,s,u.row,u.col,`${this.pluginName}.fill`,null),this.setSelection(a),this.hot.runHooks("afterAutofill",s,t,n,h),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner();let o=e;if(this.directions.includes(uv.vertical)&&this.directions.includes(uv.horizontal)){const i=t.getTopStartCorner();(n.col<=e.col||i.col>=e.col)&&(o=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||i.row>e.row)&&(o=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(uv.vertical))o=this.hot._createCellCoords(e.row,n.col);else{if(!this.directions.includes(uv.horizontal))return;o=this.hot._createCellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(o)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),n=this.hot.countRows();let o;for(let i=e[2]+1;i<n;i++){for(let n=e[1];n<=e[3];n++){if(t[i][n])return-1}const n=t[i][e[1]-1],s=t[i][e[3]+1];(n||s)&&(o=i)}return o}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...ql(e,(e=>Math.max(e,0))),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,n=za(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+eh(this.hot.table),o=za(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+Qa(this.hot.table);return e.clientY>n&&e.clientX<=o}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(e,"mousemove",(e=>this.onMouseMove(e)))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){const t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=function(e){const t={};return!0===e?(t.directions=Object.keys(uv),t.autoInsertRow=!0):uc(e)?(ia(e.autoInsertRow)?e.direction===uv.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,ia(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(uv)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}const mv="autoRowSize";class pv extends ov{static get PLUGIN_KEY(){return mv}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new sv(this.hot),this.samplesGenerator=new lv(((e,t)=>{let n;return e>=0?n=this.hot.getDataAtCell(e,t):-1===e&&(n=this.hot.getColHeader(t)),{value:n}})),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new gm,this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",((e,t,n)=>this.onBeforeRowResize(e,t,n)))}isEnabled(){const e=this.hot.getSettings()[mv];return!0===e||uc(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData(...arguments)})),this.addHook("beforeChangeRender",(e=>this.onBeforeChange(e))),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("beforeViewRender",(e=>this.onBeforeViewRender(e))),this.addHook("modifyRowHeight",((e,t)=>this.getRowHeight(t,e))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((e,t,n)=>this.onBeforeRowResize(e,t,n)))}calculateRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o="number"==typeof e?{from:e,to:e}:e,i="number"==typeof t?{from:t,to:t}:t;if(null!==this.hot.getColHeader(0)){const e=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(e.get(-1))}_u(o.from,o.to,(e=>{if(n||null===this.rowHeightsMap.getValueAtIndex(e)){Xl(this.samplesGenerator.generateRowSamples(e,i),(e=>{let[t,n]=e;return this.ghostTable.addRow(t,n)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((e,t)=>{e<0?this.headerHeight=t:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(e),t)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=0;const n=this.hot.countRows()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot)return cg(o),void(this.inProgress=!1);this.calculateRowsHeight({from:t,to:Math.min(t+pv.CALCULATION_STEP,n)},e),t=t+pv.CALCULATION_STEP+1,t<n?o=hg(i):(cg(o),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,t=s+1),t<n?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[mv],t=e&&Cc(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Cc(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllRowsHeight(){ja(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[mv];let t=pv.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return uc(e)&&(t=e.syncLimit,ba(t)?t=ku(n,t):t>>=0),Math.min(t,n)}getRowHeight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let o=t;return null!==n&&n>(t||0)&&(o=n),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:t,to:n}="number"==typeof e?{from:e,to:e}:e;this.hot.batchExecution((()=>{_u(Math.min(t,n),Math.max(t,n),(e=>{this.rowHeightsMap.setValueAtIndex(e,null)}))}),!0)}isNeedRecalculate(){return!!Kl(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(e=>null===e)).length}onBeforeViewRender(){const e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),o=this.getLastVisibleRow();if(-1!==n&&-1!==o){if(this.calculateRowsHeight({from:n,to:o},void 0,e),t){const e=this.hot.countRows()-1;this.calculateRowsHeight({from:e-t,to:e})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}onBeforeRowResize(e,t,n){let o=e;return n&&(this.calculateRowsHeight(t,void 0,!0),o=this.getRowHeight(t)),o}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout((()=>{this.hot&&this.recalculateAllRowsHeight()}),0)}onBeforeChange(e){let t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}destroy(){this.ghostTable.clean(),super.destroy()}}const{getListWithInsertedItems:wv,getListWithRemovedItems:Cv}=Rm("physicallyIndexed");var yv=class extends cm{constructor(){super((e=>e))}insert(e,t){const n=Cm(this.indexedValues,t);this.indexedValues=wv(n,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=Cv(this.indexedValues,e);this.indexedValues=wm(t,e),super.remove(e)}};const{getListWithInsertedItems:vv,getListWithRemovedItems:bv}=Rm("physicallyIndexed");var Sv=class extends cm{constructor(){super((e=>e))}insert(e,t){this.indexedValues=vv(this.indexedValues,e,t,((e,t)=>this.getNextValue(t))),super.insert(e,t)}remove(e){this.indexedValues=bv(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}};const Rv="bindRowsWithHeaders",Ev=new Map([["loose",yv],["strict",Sv]]);class Mv extends ov{static get PLUGIN_KEY(){return Rv}static get PLUGIN_PRIORITY(){return 210}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[Rv]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Rv];"string"!=typeof e&&(e="loose");const t=Ev.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",(e=>this.onModifyRowHeader(e))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}}function Tv(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function xv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ov(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,_v(e,t,"get"))}function Av(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,_v(e,t,"set"),n),n}function _v(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}const Iv="collapsibleColumns",kv=["nestedHeaders"],Hv="collapsibleIndicator",Dv=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Nv=new WeakMap;class Pv extends ov{constructor(){super(...arguments),xv(this,"nestedHeadersPlugin",null),xv(this,"eventManager",new pu(this)),xv(this,"headerStateManager",null),Tv(this,Nv,{writable:!0,value:null})}static get PLUGIN_KEY(){return Iv}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Iv,...kv]}isEnabled(){return!!this.hot.getSettings()[Iv]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||Kc("You need to configure the Nested Headers plugin in order to use collapsible headers."),Av(this,Nv,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>this.onInit())),this.addHook("afterLoadData",(function(){return e.onAfterLoadData(...arguments)})),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader(...arguments)})),this.addHook("beforeOnCellMouseDown",((e,t,n)=>this.onBeforeOnCellMouseDown(e,t,n))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();"boolean"==typeof e?this.headerStateManager.mapState((e=>({collapsible:e.origColspan>1}))):Array.isArray(e)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Av(this,Nv,null),this.nestedHeadersPlugin=null,this.clearButtons(),super.disablePlugin()}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(e){e&&e.parentNode.removeChild(e)};_u(0,e-1,(e=>{const s=t.childNodes[e],r=n.childNodes[e],l=o?o.childNodes[e]:null;_u(0,s.childNodes.length-1,(e=>{let t=s.childNodes[e].querySelector(`.${Hv}`);i(t),r&&r.childNodes[e]&&(t=r.childNodes[e].querySelector(`.${Hv}`),i(t)),o&&l&&l.childNodes[e]&&(t=l.childNodes[e].querySelector(`.${Hv}`),i(t))}))}))}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes((t=>{const{collapsible:n,origColspan:o,headerLevel:i,columnIndex:s,isCollapsed:r}=t;if(!0===n&&o>1&&(r&&"expand"===e||!r&&"collapse"===e))return{row:this.headerStateManager.levelToRowCoords(i),col:s}}));this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!Dv.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const n=Kl(e,(e=>{let{row:t}=e;return t<0}));let o=n.length>0;Xl(n,(e=>{var n;let{row:i,col:s}=e;const{collapsible:r,isCollapsed:l}=null!==(n=this.headerStateManager.getHeaderSettings(i,s))&&void 0!==n?n:{};if(!r||l&&"collapse"===t||!l&&"expand"===t)return o=!1,!1}));const i=[],s=[];o&&Xl(n,(e=>{let{row:n,col:o}=e;const{colspanCompensation:r,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(t,n,o);r>0&&(s.push(...l),i.push(a))}));const r=this.getCollapsedColumns();let l=[];"collapse"===t?l=Jl([...r,...s]):"expand"===t&&(l=Kl(r,(e=>!s.includes(e))));const a=Dv.get(t);if(!1===this.hot.runHooks(a.beforeHook,r,l,o))return void Xl(i,(e=>{e()}));this.hot.batchExecution((()=>{Xl(s,(e=>{Ov(this,Nv).setValueAtIndex(this.hot.toPhysicalColumn(e),a.hideColumn)}))}),!0);const h=this.getCollapsedColumns().length!==r.length;this.hot.runHooks(a.afterHook,r,l,o,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return Ov(this,Nv).getHiddenIndexes()}onAfterGetColHeader(e,t,n){var o;const{collapsible:i,origColspan:s,isCollapsed:r}=null!==(o=this.headerStateManager.getHeaderSettings(n,e))&&void 0!==o?o:{},l=i&&s>1&&e>=this.hot.getSettings().fixedColumnsStart;let a=t.querySelector(`.${Hv}`);var h;l?(a||(a=this.hot.rootDocument.createElement("div"),Pa(a,Hv),t.querySelector("div:first-child").appendChild(a)),La(a,["collapsed","expanded"]),r?(Pa(a,"collapsed"),Ua(a,"+")):(Pa(a,"expanded"),Ua(a,"-"))):null===(h=a)||void 0===h||h.remove()}onBeforeOnCellMouseDown(e,t){Na(e.target,Hv)&&(Na(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Na(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),jc(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){Av(this,Nv,null),super.destroy()}}const Lv=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class Vv{constructor(e,t){this.hot=e,this.sortingStates=new vm,this.sortEmptyCells=false,this.indicator=true,this.headerAction=true,this.compareFunctionFactory=void 0,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){uc(e)&&gc(e,((e,t)=>{Lv.includes(t)&&(this[t]=e)}))}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex((t=>{let[n]=t;return n===e}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return uc(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){if(null===this.sortingStates)return[];return this.sortingStates.getEntries().map((e=>{let[t,n]=e;return{column:this.hot.toVisualColumn(t),...n}}))}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(ia(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Fv="asc",Bv="desc";function Wv(e){if(e.some((e=>!1===function(e){if(!1===uc(e))return!1;const{column:t,sortOrder:n}=e;return Number.isInteger(t)&&[Fv,Bv].includes(n)}(e))))return!1;const t=e.map((e=>{let{column:t}=e;return t}));return new Set(t).size===t.length}function Uv(e){if(e!==Bv)return e===Fv?Bv:Fv}function jv(e){return e.querySelector(".colHeader")}function zv(e,t){if(e<0||!t.parentNode)return!1;const n=t.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(t.parentNode)-n.length}function Yv(e,t,n){return-1===e&&t>=0&&!1===Yc(n)}const $v="indicatorDisabled",Gv="columnSorting",Kv="sortAction",qv=new Map([[Fv,"ascending"],[Bv,"descending"]]);function Xv(e,t,n){const o=t.locale;return function(t,i){const{sortEmptyCells:s}=n;return"string"==typeof t&&(t=t.toLocaleLowerCase(o)),"string"==typeof i&&(i=i.toLocaleLowerCase(o)),t===i?ib:ra(t)?ra(i)?ib:s&&"asc"===e?sb:rb:ra(i)?s&&"asc"===e?rb:sb:isNaN(t)&&!isNaN(i)?"asc"===e?rb:sb:!isNaN(t)&&isNaN(i)?"asc"===e?sb:rb:(isNaN(t)||isNaN(i)||(t=parseFloat(t),i=parseFloat(i)),t<i?"asc"===e?sb:rb:t>i?"asc"===e?rb:sb:ib)}}const Zv="default";const{register:Jv,getItem:Qv,hasItem:eb}=iu("sorting.compareFunctionFactory"),{register:tb,getItem:nb}=iu("sorting.mainSortComparator");function ob(e){return eb(e)?Qv(e):Qv(Zv)}Jv("numeric",(function(e,t,n){return function(t,o){const i=parseFloat(t),s=parseFloat(o),{sortEmptyCells:r}=n;if(i===s||isNaN(i)&&isNaN(s))return ib;if(r){if(ra(t))return"asc"===e?sb:rb;if(ra(o))return"asc"===e?rb:sb}return isNaN(i)?rb:isNaN(s)?sb:i<s?"asc"===e?sb:rb:i>s?"asc"===e?rb:sb:ib}})),Jv("checkbox",(function(e,t,n){const o=t.checkedTemplate,i=t.uncheckedTemplate,{sortEmptyCells:s}=n;return function(r,l){const a=ra(r),h=ra(l),c=a?i:r,u=h?i:l,d=c===i||c===o,g=u===i||u===o;if(!1===s){if(a&&!1===h)return rb;if(!1===a&&h)return sb}return!1===d&&g?"asc"===e?sb:rb:d&&!1===g?"asc"===e?rb:sb:!1===d&&!1===g?Xv(e,t,n)(r,l):c===i&&u===o?"asc"===e?sb:rb:c===o&&u===i?"asc"===e?rb:sb:ib}})),Jv("date",(function(e,t,n){return function(o,i){const{sortEmptyCells:s}=n;if(o===i)return ib;if(ra(o))return ra(i)?ib:s&&"asc"===e?sb:rb;if(ra(i))return s&&"asc"===e?rb:sb;const r=t.dateFormat,l=jl(o,r),a=jl(i,r);return l.isValid()?a.isValid()?a.isAfter(l)?"asc"===e?sb:rb:a.isBefore(l)?"asc"===e?rb:sb:ib:sb:rb}})),Jv(Zv,Xv);const ib=0,sb=-1,rb=1;const lb="columnSorting",ab="append";tb(lb,(function(e,t){return function(n,o){const[,...i]=n,[,...s]=o;return function(n){const o=e[n],r=t[n],l=i[n],a=s[n],h=r.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:ob(r.type))(o,r,h)(l,a)}(0)}})),nu.getSingleton().register("beforeColumnSort"),nu.getSingleton().register("afterColumnSort");class hb extends ov{static get PLUGIN_KEY(){return lb}static get PLUGIN_PRIORITY(){return 50}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=lb,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new Vv(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new gm((e=>{let t=this.hot.toVisualColumn(e);return null===t&&(t=e),this.getMergedPluginSettings(t)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((e,t)=>this.onAfterGetColHeader(e,t))),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown(...arguments)})),this.addHook("afterOnCellMouseDown",((e,t)=>this.onAfterOnCellMouseDown(e,t))),this.addHook("afterInit",(()=>this.loadOrSortBySettings())),this.addHook("afterLoadData",(function(){return e.onAfterLoadData(...arguments)})),this.hot.view&&this.loadOrSortBySettings(),super.enablePlugin())}disablePlugin(){const e=(e,t)=>{const n=jv(t);!1!==zv(e,t)&&null!==n&&this.updateHeaderClasses(n)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",e)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,super.disablePlugin()}sort(e){const t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),o=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",t,n,o)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Em),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,o?n:t,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ia(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return Wv(e)&&e.every((e=>{let{column:n}=e;return n<=t&&n>=0}))}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=ql(e,(e=>{let{column:t,...n}=e;return{column:this.hot.toPhysicalColumn(t),...n}})),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,n=e=>{let{column:t,...n}=e;return{column:this.hot.toVisualColumn(t),...n}};return ia(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=ql(t.initialConfig,n)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(ia(t)){const n=Uv(t);return ia(n)?{column:e,sortOrder:n}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:Uv()}}getNextSortConfig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ab;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),o=-1!==n,i=this.getSortConfig(),s=this.getColumnNextConfig(e);if(o){if(sa(s))return[...i.slice(0,n),...i.slice(n+1)];if(t===ab)return[...i.slice(0,n),...i.slice(n+1),s];if("replace"===t)return[...i.slice(0,n),s,...i.slice(n+1)]}return ia(s)?i.concat(s):i}getPluginColumnConfig(e){if(uc(e)){const t=e[this.pluginKey];if(uc(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,e),i=Object.getPrototypeOf(o);return Array.isArray(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns[e])):vh(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns(e))):Object.assign(n,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(0===e.length)return void this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());const t=[],n=this.hot.countRows(),o=t=>ql(e,(e=>this.hot.getDataAtCell(t,e.column)));for(let e=0;e<this.getNumberOfRowsToSort(n);e+=1)t.push([this.hot.toPhysicalRow(e)].concat(o(e)));const i=ql(t,(e=>e[0]));!function(e,t){const n=nb(t);for(var o=arguments.length,i=new Array(o>2?o-2:0),s=2;s<o;s++)i[s-2]=arguments[s];e.sort(n(...i))}(t,this.pluginKey,ql(e,(e=>e.sortOrder)),ql(e,(e=>this.getFirstCellSettings(e.column))));for(let e=t.length;e<n;e+=1)t.push([e].concat(o(e)));const s=ql(t,(e=>e[0])),r=new Map(ql(i,((e,t)=>[e,s[t]]))),l=ql(this.hot.rowIndexMapper.getIndexesSequence(),(e=>r.has(e)?r.get(e):e));this.hot.rowIndexMapper.setIndexesSequence(l)}loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if(uc(e))this.sortBySettings(e);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}sortBySettings(e){if(uc(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||uc(t))&&this.sort(t)}else this.hot.render()}onAfterGetColHeader(e,t){const n=jv(t);if(!1===zv(e,t)||null===n)return;const o=this.getFirstCellSettings(e)[this.pluginKey],i=o.indicator,s=o.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,e,i,s)}updateHeaderClasses(e){if(La(e,Array.from(qv.values()).concat(Kv,$v,Gv)),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];Pa(e,function(e,t,n,o){const i=[Gv];if(o&&i.push(Kv),!1===n)return i.push($v),i;const s=e.getSortOrderOfColumn(t);return ia(s)&&i.push(qv.get(s)),i}(...n))}}onUpdateSettings(e){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ia(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){!0===e&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&"SPAN"===e.target.nodeName}onBeforeOnCellMouseDown(e,t,n,o){!1!==Yv(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(o.column=!0)}onAfterOnCellMouseDown(e,t){!1!==Yv(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),super.destroy()}}var cb=class{constructor(e,t){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=t,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let n=e;if(n||"function"!=typeof this.settings)return n||(n=this.settings),Xl(n,(e=>{const n={};this.assignSetting(e,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(e,n,"reversedRowCoords",!1),this.assignSetting(e,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"sourceColumn",e.destinationColumn),this.assignSetting(e,n,"type","sum"),this.assignSetting(e,n,"forceNumeric",!1),this.assignSetting(e,n,"suppressDataTypeErrors",!0),this.assignSetting(e,n,"suppressDataTypeErrors",!0),this.assignSetting(e,n,"customFunction",null),this.assignSetting(e,n,"readOnly",!0),this.assignSetting(e,n,"roundFloat",!1),t.push(n)})),t;this.settingsType="function"}assignSetting(e,t,n,o){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(o instanceof Error)throw o;t[n]=o}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=o}resetSetupBeforeStructureAlteration(e,t,n){if("function"!==this.settingsType)return;const o=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();Xl(i,(i=>{"row"===o&&i.destinationRow>=t&&("insert_row"===e?i.alterRowOffset=n:"remove_row"===e&&(i.alterRowOffset=-1*n)),"col"===o&&i.destinationColumn>=t&&("insert_col"===e?i.alterColumnOffset=n:"remove_col"===e&&(i.alterColumnOffset=-1*n))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(e,t,n,o,i){let s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const e=()=>(this.hot.removeHook("beforeViewRender",e),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",e)}const r=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===e.indexOf("move_row"),c=t;Xl(a,(e=>{"row"===r&&e.destinationRow>=c&&(e.alterRowOffset=l*n),"col"===r&&e.destinationColumn>=c&&(e.alterColumnOffset=l*n)})),this.resetAllEndpoints(a,!h),Xl(a,h?e=>{this.extendEndpointRanges(e,c,o[0],o.length),this.recreatePhysicalRanges(e),this.clearOffsetInformation(e)}:e=>{this.shiftEndpointCoordinates(e,c)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,n,o){Xl(e.ranges,(e=>{e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=o:n<e[0]&&(e[0]-=o):n>=e[0]&&n<=e[1]&&(e[1]-=o,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}recreatePhysicalRanges(e){const t=e.ranges,n=[],o=[];Xl(t,(e=>{const t=[];if(e[1])for(let n=e[0];n<=e[1];n++)t.push(this.hot.toPhysicalRow(n));else t.push(this.hot.toPhysicalRow(e[0]));o.push(t)})),Xl(o,(e=>{let t=[];Xl(e,((o,i)=>{0===i?t.push(o):e[i]!==e[i-1]+1&&(t.push(e[i-1]),n.push(t),t=[],t.push(o)),i===e.length-1&&(t.push(o),n.push(t))}))})),e.ranges=n}shiftEndpointCoordinates(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,Xl(e.ranges,(n=>{Xl(n,((o,i)=>{o>=t&&(n[i]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.some((e=>{const t=e.alterRowOffset||0,n=e.alterColumnOffset||0;return e.destinationRow+t>=this.hot.countRows()||e.destinationColumn+n>=this.hot.countCols()}))||(this.cellsToSetCache=[],Xl(e,(e=>{this.resetEndpointValue(e,t)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Xl(this.getAllEndpoints(),(e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],Xl(e,((e,n,o)=>{`${e[2]||""}`!=`${e[3]}`&&Xl(this.getAllEndpoints(),((e,i)=>{this.hot.propToCol(o[n][1])===e.sourceColumn&&-1===t.indexOf(i)&&t.push(i)}))})),Xl(t,(e=>{this.refreshEndpoint(this.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e.alterRowOffset||0,o=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?o:0)),""])}setEndpointValue(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(e.destinationRow);if(null!==i){const n=this.hot.getCellMeta(i,e.destinationColumn);"init"!==t&&n.readOnly===e.readOnly||(n.readOnly=e.readOnly,n.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),n?this.hot.setDataAtCell(o,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Kc("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};function ub(e){return null==e||isNaN(e)}const db="columnSummary";class gb extends ov{static get PLUGIN_KEY(){return db}static get PLUGIN_PRIORITY(){return 220}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[db]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[db],this.endpoints=new cb(this,this.settings),this.addHook("afterInit",(function(){return e.onAfterInit(...arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange(...arguments)})),this.addHook("beforeCreateRow",((e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,n))),this.addHook("beforeCreateCol",((e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,n))),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)})),this.addHook("afterCreateRow",((e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,n))),this.addHook("afterCreateCol",((e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,n))),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)})),this.addHook("afterRowMove",(function(){return e.onAfterRowMove(...arguments)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(e){let t=0;return gc(e.ranges,(n=>{t+=this.getPartialSum(n,e.sourceColumn)})),t}getPartialSum(e,t){let n=0,o=e[1]||e[0],i=null,s=0;do{if(i=this.getCellValue(o,t),i=ub(i)?null:i,null!==i){const e=(`${i}`.split(".")[1]||[]).length||1;e>s&&(s=e)}n+=i||0,o-=1}while(o>=e[0]);return Math.round(n*10**s)/10**s}calculateMinMax(e,t){let n=null;return gc(e.ranges,(o=>{const i=this.getPartialMinMax(o,e.sourceColumn,t);if(null===n&&null!==i&&(n=i),null!==i)switch(t){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i)}})),null===n?"Not enough data":n}getPartialMinMax(e,t,n){let o,i=null,s=e[1]||e[0];do{if(o=this.getCellValue(s,t),o=ub(o)?null:o,null===i)i=o;else if(null!==o)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o)}s-=1}while(s>=e[0]);return i}countEmpty(e,t){let n,o=0,i=e[1]||e[0];do{n=this.getCellValue(i,t),n=ub(n)?null:n,null===n&&(o+=1),i-=1}while(i>=e[0]);return o}countEntries(e){let t=0;return gc(e.ranges,(n=>{const o=void 0===n[1]?1:n[1]-n[0]+1,i=this.countEmpty(n,e.sourceColumn);t+=o,t-=i})),t}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){const n=this.hot.toVisualRow(e),o=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),s="";if(null!==n&&null!==o&&(s=this.hot.getCellMeta(n,o).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(na`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}class fb{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){this.rootDocument=e,this.isRtl=t,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,t){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${t}px`}setSize(e,t){if(e&&t){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${t}px`}}getSize(){return{width:Qa(this.getInputElement()),height:eh(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),t=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Pa(this.container,fb.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Pa(e,fb.CLASS_EDITOR),Pa(t,fb.CLASS_INPUT),e.appendChild(t),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${fb.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}var mb=fb;const pb="---------";function wb(e){return Na(e,"htSeparator")}function Cb(e){return Na(e,"htDisabled")}function yb(e){return Na(e,"htSelectionDisabled")}function vb(e){const t=e.getSelected();return t?t[0]<0?null:t:null}function bb(e,t){const n={};return Xl(e,(e=>{e.forAll(((e,o)=>{e>=0&&o>=0&&(n[e]||(n[e]=[]),n[e][o]=t(e,o))}))})),n}function Sb(e,t,n,o,i){Xl(e,(e=>{e.forAll(((e,s)=>{e>=0&&s>=0&&function(e,t,n,o,i,s){const r=i(e,t);let l=o;r.className&&(l="vertical"===n?function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${t}`}(r.className,o):function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${t}`}(r.className,o));s(e,t,"className",l)}(e,s,t,n,o,i)}))}))}function Rb(e,t){let n=!1;return Array.isArray(e)&&Xl(e,(e=>(e.forAll(((e,o)=>{if(e>=0&&o>=0&&t(e,o))return n=!0,!1})),n))),n}function Eb(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}function Mb(e,t){const n=e.slice(0);for(let e=0;e<n.length&&n[e].name===t;)n.shift();return n}function Tb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pb,n=e.slice(0);return n=Mb(n,t),n=function(e,t){let n=e.slice(0);return n.reverse(),n=Mb(n,t),n.reverse(),n}(n,t),n=function(e){const t=[];return Xl(e,((e,n)=>{n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}(n),n}class xb{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Sh((e=>{this.wasLastActionShow&&this.runLocalHooks("show",e.from.row,e.from.col)}),e)}destroy(){this.clearLocalHooks()}}hc(xb,hm);var Ob=xb;const Ab="comments",_b=new WeakMap,Ib="comment",kb="value",Hb="style",Db="readOnly";class Nb extends ov{static get PLUGIN_KEY(){return Ab}static get PLUGIN_PRIORITY(){return 60}constructor(e){super(e),this.editor=null,this.displaySwitch=null,this.eventManager=null,this.range={},this.preventEditorAutoSwitch=!1,_b.set(this,{tempEditorDimensions:{},cellBelowCursor:null})}isEnabled(){return!!this.hot.getSettings()[Ab]}enablePlugin(){this.enabled||(this.editor||(this.editor=new mb(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new pu(this)),this.displaySwitch||(this.displaySwitch=new Ob(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(e=>this.addToContextMenu(e))),this.addHook("afterRenderer",((e,t,n,o,i,s)=>this.onAfterRenderer(e,s))),this.addHook("afterScrollHorizontally",(()=>this.hide())),this.addHook("afterScrollVertically",(()=>this.hide())),this.addHook("afterBeginEditing",(()=>this.hide())),this.displaySwitch.addLocalHook("hide",(()=>this.hide())),this.displaySwitch.addLocalHook("show",((e,t)=>this.showAtCell(e,t))),this.registerListeners(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin(),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}disablePlugin(){super.disablePlugin()}registerListeners(){const{rootDocument:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",(e=>this.onMouseOver(e))),this.eventManager.addEventListener(e,"mousedown",(e=>this.onMouseDown(e))),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(()=>this.onEditorBlur())),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(e=>this.onEditorMouseDown(e))),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(e=>this.onEditorMouseUp(e)))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=Aa(e.target,"TD","TBODY");return!!(t&&Na(t,"htCommentCell")&&Aa(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.editor.getInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=this.editor.getValue();let n="";null!=e?n=e:null!=t&&(n=t);const o=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(o,i,{[kb]:n}),this.hot.render()}setCommentAtCell(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}removeComment(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ib),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,kb)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,kb)}show(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:t}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||t<0||t>this.hot.countSourceCols()-1)return!1;const n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(n[Ib]?n[Ib][kb]:""),this.editor.show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){this.editor.hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&this.editor.isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:o}=this.hot,{row:i,col:s}=this.range.from;let r=n.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s);const a=null===r;this.editor.setPosition(0,0),null===r&&(r=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),null===l&&(l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,-1)));const h=null===r,c=null===l;r=null!==(e=r)&&void 0!==e?e:0,l=null!==(t=l)&&void 0!==t?t:0;const{rootWindow:u,view:{_wt:d}}=this.hot,{wtTable:g}=d,f=d.getCell({row:r,col:l},!0),m=this.getCommentMeta(i,s,Hb);m?this.editor.setSize(m.width,m.height):this.editor.resetSize();const p=c?0:g.getStretchedColumnWidth(l),w=a&&!h?eh(f):0,{left:C,top:y,width:v,height:b}=f.getBoundingClientRect(),{width:S,height:R}=this.editor.getSize(),{innerWidth:E,innerHeight:M}=this.hot.rootWindow,T=this.hot.rootDocument.documentElement;let x=C+u.scrollX+p,O=y+u.scrollY+w;this.hot.isRtl()&&(x-=S+p),this.hot.isLtr()&&C+v+S>E?x=C+u.scrollX-S-1:this.hot.isRtl()&&x<-(T.scrollWidth-T.clientWidth)&&(x=C+u.scrollX+p+1),y+R>M&&(O-=R-b+1),this.editor.setPosition(x,O),this.editor.setReadOnlyState(this.getCommentMeta(i,s,Db))}checkSelectionCommentsConsistency(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;let t=!1;const n=e.getTopStartCorner();return this.getCommentMeta(n.row,n.col,kb)&&(t=!0),t}updateCommentMeta(e,t,n){const o=this.hot.getCellMeta(e,t)[Ib];let i;o?(i=lc(o),rc(i,n)):i=n,this.hot.setCellMeta(e,t,Ib,i)}getCommentMeta(e,t,n){const o=this.hot.getCellMeta(e,t);if(o[Ib])return o[Ib][n]}onMouseDown(e){if(this.hot.view&&this.hot.view._wt&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){const t=Aa(e.target,"TD","TBODY");let n=null;t&&(n=this.hot.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}onMouseOver(e){const t=_b.get(this),{rootDocument:n}=this.hot;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Na(e.target,"wtBorder")||t.cellBelowCursor===e.target)&&this.editor)if(t.cellBelowCursor=n.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){const t=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(t)}else Ia(e.target,n)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}onMouseUp(){this.preventEditorAutoSwitch=!1}onAfterRenderer(e,t){t[Ib]&&t[Ib][kb]&&Pa(e,t.commentedCellClassName)}onEditorBlur(){this.setComment()}onEditorMouseDown(e){_b.get(this).tempEditorDimensions={width:Qa(e.target),height:eh(e.target)}}onEditorMouseUp(e){const t=_b.get(this),n=Qa(e.target),o=eh(e.target);n===t.tempEditorDimensions.width+1&&o===t.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Hb]:{width:n,height:o}})}onContextMenuAddComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}onContextMenuRemoveComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll(((e,t)=>{e>=0&&t>=0&&this.removeCommentAtCell(e,t,!1)})),this.hot.render()}onContextMenuMakeReadOnly(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll(((e,t)=>{if(e>=0&&t>=0){const n=!!this.getCommentMeta(e,t,Db);this.updateCommentMeta(e,t,{[Db]:!n})}}))}addToContextMenu(e){const t=()=>this.hot.rowIndexMapper.getRenderableIndexesLength()>0&&this.hot.columnIndexMapper.getRenderableIndexesLength()>0;e.items.push({name:"---------"},{key:"commentsAddEdit",name:()=>this.checkSelectionCommentsConsistency()?this.hot.getTranslatedPhrase(Cp):this.hot.getTranslatedPhrase(wp),callback:()=>this.onContextMenuAddComment(),disabled:()=>!t()||!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())},{key:"commentsRemove",name(){return this.getTranslatedPhrase(yp)},callback:()=>this.onContextMenuRemoveComment(),disabled:()=>!t()||!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())},{key:"commentsReadOnly",name(){let e=this.getTranslatedPhrase(vp);return Rb(this.getSelectedRangeLast(),((e,t)=>{let n=this.getCellMeta(e,t)[Ib];if(n&&(n=n[Db]),n)return!0}))&&(e=Eb(e)),e},callback:()=>this.onContextMenuMakeReadOnly(),disabled:()=>!t()||!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()&&this.checkSelectionCommentsConsistency())})}getDisplayDelaySetting(){const e=this.hot.getSettings()[Ab];if(uc(e))return e.displayDelay}destroy(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),super.destroy()}}var Pb=ye,Lb=TypeError,Vb=oi,Fb=je,Bb=fo,Wb=ui,Ub=function(e,t){if(!delete e[t])throw new Lb("Cannot delete property "+Pb(t)+" of "+Pb(e))},jb=gi,zb=1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}();Vb({target:"Array",proto:!0,arity:1,forced:zb},{unshift:function(e){var t=Fb(this),n=Bb(t),o=arguments.length;if(o){jb(n+o);for(var i=n;i--;){var s=i+o;i in t?t[s]=t[i]:Ub(t,s)}for(var r=0;r<o;r++)t[r]=arguments[r]}return Wb(t,n+o)}});var Yb=class{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const i=e.split(":"),s=i[0],r=2===i.length?i[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(r&&l.submenu&&(l=function(e,t){let n;return Xl(t,(t=>{const o=t.key?t.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return n=t,!1})),n}(r,l.submenu.items)),!0===l.disabled)return;if("function"==typeof l.disabled&&!0===l.disabled.call(this.hot))return;if(Cc(l,"submenu"))return;const a=[];"function"==typeof l.callback&&a.push(l.callback),"function"==typeof this.commonCallback&&a.push(this.commonCallback),n.unshift(i.join(":")),Xl(a,(e=>e.apply(this.hot,n)))}};const $b="alignment";const Gb="clear_column";const Kb="col_left";const qb="col_right";const Xb="make_read_only";const Zb="redo";const Jb="remove_col";const Qb="remove_row";const eS="row_above";const tS="row_below";const nS="no_items";const oS="undo";const iS=[eS,tS,Kb,qb,Gb,Qb,Jb,oS,Zb,Xb,$b,pb,nS],sS={[pb]:function(){return{name:pb}},[nS]:function(){return{key:nS,name(){return this.getTranslatedPhrase(Zm)},disabled:!0,isCommand:!1}},[eS]:function(){return{key:eS,name(){return this.getTranslatedPhrase(Jm)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){if(!vb(this))return!0;if(this.selection.isSelectedByCorner()){return 0===this.countRows()}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}},[tS]:function(){return{key:tS,name(){return this.getTranslatedPhrase(Qm)},callback(){const e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){return!vb(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[Kb]:function(){return{key:Kb,name(){return this.getTranslatedPhrase(ep)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;if(!vb(this))return!0;if(this.selection.isSelectedByCorner()){return 0===this.countCols()}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}},[qb]:function(){return{key:qb,name(){return this.getTranslatedPhrase(tp)},callback(){const e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;return!vb(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[Gb]:function(){return{key:Gb,name(){return this.getTranslatedPhrase(lp)},callback(e,t){const n=t[0].start.col,o=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),o,"ContextMenu.clearColumn")},disabled(){return!vb(this)||!this.selection.isSelectedByColumnHeader()}}},[Qb]:function(){return{key:Qb,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[n,,o]=e[0];n-o!=0&&(t=1)}return this.getTranslatedPhrase(np,t)},callback(){this.alter("remove_row",function(e){const t=tC(e);if(0===t||1===t)return[];const n=nC(t),o=new Set;Xl(e,(e=>{const[t,,i]=n(e),s=Math.max(t,0),r=i-s+1;Xl(Array.from(new Array(r),((e,t)=>s+t)),(e=>{o.has(e)||o.add(e)}))}));const i=Gl(Array.from(o).sort(((e,t)=>e-t)),((e,t,n,o)=>(0!==n&&t===o[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e)),[]);return i}(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){if(!vb(this))return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}},[Jb]:function(){return{key:Jb,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[,n,,o]=e[0];n-o!=0&&(t=1)}return this.getTranslatedPhrase(op,t)},callback(){this.alter("remove_col",function(e){const t=tC(e);if(0===t||1===t)return[];const n=nC(t),o=new Set;Xl(e,(e=>{const[,t,,i]=n(e),s=Math.max(t,0),r=i-s+1;Xl(Array.from(new Array(r),((e,t)=>s+t)),(e=>{o.has(e)||o.add(e)}))}));const i=Gl(Array.from(o).sort(((e,t)=>e-t)),((e,t,n,o)=>(0!==n&&t===o[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e)),[]);return i}(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;if(!vb(this))return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}},[oS]:function(){return{key:oS,name(){return this.getTranslatedPhrase(ip)},callback(){this.undo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[Zb]:function(){return{key:Zb,name(){return this.getTranslatedPhrase(sp)},callback(){this.redo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[Xb]:function(){return{key:Xb,name(){let e=this.getTranslatedPhrase(rp);return Rb(this.getSelectedRange(),((e,t)=>this.getCellMeta(e,t).readOnly))&&(e=Eb(e)),e},callback(){const e=this.getSelectedRange(),t=Rb(e,((e,t)=>this.getCellMeta(e,t).readOnly));Xl(e,(e=>{e.forAll(((e,n)=>{e>=0&&n>=0&&this.setCellMeta(e,n,"readOnly",!t)}))})),this.render()},disabled(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}},[$b]:function(){return{key:$b,name(){return this.getTranslatedPhrase(bp)},disabled(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${$b}:left`,name(){let e=this.getTranslatedPhrase(Sp);return Rb(this.getSelectedRange(),((e,t)=>{const n=this.getCellMeta(e,t).className;if(n&&-1!==n.indexOf("htLeft"))return!0}))&&(e=Eb(e)),e},callback(){const e=this.getSelectedRange(),t=bb(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",t,e,n,o),Sb(e,n,o,((e,t)=>this.getCellMeta(e,t)),((e,t,n,o)=>this.setCellMeta(e,t,n,o))),this.render()},disabled:!1},{key:`${$b}:center`,name(){let e=this.getTranslatedPhrase(Rp);return Rb(this.getSelectedRange(),((e,t)=>{const n=this.getCellMeta(e,t).className;if(n&&-1!==n.indexOf("htCenter"))return!0}))&&(e=Eb(e)),e},callback(){const e=this.getSelectedRange(),t=bb(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",t,e,n,o),Sb(e,n,o,((e,t)=>this.getCellMeta(e,t)),((e,t,n,o)=>this.setCellMeta(e,t,n,o))),this.render()},disabled:!1},{key:`${$b}:right`,name(){let e=this.getTranslatedPhrase(Ep);return Rb(this.getSelectedRange(),((e,t)=>{const n=this.getCellMeta(e,t).className;if(n&&-1!==n.indexOf("htRight"))return!0}))&&(e=Eb(e)),e},callback(){const e=this.getSelectedRange(),t=bb(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",o="htRight";this.runHooks("beforeCellAlignment",t,e,n,o),Sb(e,n,o,((e,t)=>this.getCellMeta(e,t)),((e,t,n,o)=>this.setCellMeta(e,t,n,o))),this.render()},disabled:!1},{key:`${$b}:justify`,name(){let e=this.getTranslatedPhrase(Mp);return Rb(this.getSelectedRange(),((e,t)=>{const n=this.getCellMeta(e,t).className;if(n&&-1!==n.indexOf("htJustify"))return!0}))&&(e=Eb(e)),e},callback(){const e=this.getSelectedRange(),t=bb(e,((e,t)=>this.getCellMeta(e,t).className)),n="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",t,e,n,o),Sb(e,n,o,((e,t)=>this.getCellMeta(e,t)),((e,t,n,o)=>this.setCellMeta(e,t,n,o))),this.render()},disabled:!1},{name:pb},{key:`${$b}:top`,name(){let e=this.getTranslatedPhrase(Tp);return Rb(this.getSelectedRange(),((e,t)=>{const n=this.getCellMeta(e,t).className;if(n&&-1!==n.indexOf("htTop"))return!0}))&&(e=Eb(e)),e},callback(){const e=this.getSelectedRange(),t=bb(e,((e,t)=>this.getCellMeta(e,t).className)),n="vertical",o="htTop";this.runHooks("beforeCellAlignment",t,e,n,o),Sb(e,n,o,((e,t)=>this.getCellMeta(e,t)),((e,t,n,o)=>this.setCellMeta(e,t,n,o))),this.render()},disabled:!1},{key:`${$b}:middle`,name(){let e=this.getTranslatedPhrase(xp);return Rb(this.getSelectedRange(),((e,t)=>{const n=this.getCellMeta(e,t).className;if(n&&-1!==n.indexOf("htMiddle"))return!0}))&&(e=Eb(e)),e},callback(){const e=this.getSelectedRange(),t=bb(e,((e,t)=>this.getCellMeta(e,t).className)),n="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",t,e,n,o),Sb(e,n,o,((e,t)=>this.getCellMeta(e,t)),((e,t,n,o)=>this.setCellMeta(e,t,n,o))),this.render()},disabled:!1},{key:`${$b}:bottom`,name(){let e=this.getTranslatedPhrase(Op);return Rb(this.getSelectedRange(),((e,t)=>{const n=this.getCellMeta(e,t).className;if(n&&-1!==n.indexOf("htBottom"))return!0}))&&(e=Eb(e)),e},callback(){const e=this.getSelectedRange(),t=bb(e,((e,t)=>this.getCellMeta(e,t).className)),n="vertical",o="htBottom";this.runHooks("beforeCellAlignment",t,e,n,o),Sb(e,n,o,((e,t)=>this.getCellMeta(e,t)),((e,t,n,o)=>this.setCellMeta(e,t,n,o))),this.render()},disabled:!1}]}}}};function rS(){const e={};return gc(sS,((t,n)=>{e[n]=t()})),e}var lS=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.hot=e,this.predefinedItems=rS(),this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,gc(e,((e,n)=>{let o="";e.name===pb?(t[pb]=e,o=pb):isNaN(parseInt(n,10))?(e.key=void 0===e.key?n:e.key,t[n]=e,o=e.key):(t[e.key]=e,o=e.key),this.defaultOrderPattern.push(o)})),this.predefinedItems=t}getItems(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=[];let i=e;i&&i.items?i=i.items:Array.isArray(i)||(i=t);uc(i)?gc(i,((e,t)=>{let i=n["string"==typeof e?e:t];i||(i=e),uc(e)?sc(i,e):"string"==typeof i&&(i={name:i}),void 0===i.key&&(i.key=t),o.push(i)})):Xl(i,((e,t)=>{let i=n[e];!i&&iS.indexOf(e)>=0||(i||(i={name:e,key:`${t}`}),uc(e)&&sc(i,e),void 0===i.key&&(i.key=t),o.push(i))}));return o}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}};var aS=class{constructor(e,t){const n=Ya(t),o=$a(t);let i,s,r,l,a,h;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(i=parseInt(e.top,10),r=parseInt(e.left,10),a=e.height||0,h=e.width||0,s=i,l=r,i+=n,r+=o):"event"===this.type&&(i=parseInt(e.pageY,10),r=parseInt(e.pageX,10),a=e.target.clientHeight,h=e.target.clientWidth,s=i-n,l=r-o),this.top=i,this.topRelative=s,this.left=r,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=a,this.cellWidth=h}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}};const hS="menu",cS=hS;class uS{constructor(e,t){this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.eventManager=new pu(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",(e=>this.onDocumentMouseDown(e))),this.eventManager.addEventListener(e.document,"contextmenu",(e=>this.onDocumentContextMenu(e))),e=Oa(e)}setMenuItems(e){this.menuItems=e}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[e]=t}isSubMenu(){return null!==this.parentMenu}open(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=Sh((e=>this.openSubMenu(e)),300),n=this.options.minWidth||215;let o=!1,i=Kl(this.menuItems,(e=>(e.key===nS&&(o=!0),function(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}(e,this.hot))));if(i.length<1&&!o)i.push(rS()[nS]);else if(0===i.length)return;i=Tb(i,pb);let s=!1;const r={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:e=>ia(e)&&e<n?n:e,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(e,t,n,o,i,s)=>this.menuItemRenderer(e,t,n,o,i,s)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:(e,n)=>{this.isAllSubMenusClosed()?t(n.row):this.openSubMenu(n.row)},rowHeights:e=>i[e].name===pb?1:23,afterOnCellContextMenu:e=>{e.preventDefault(),Hc()&&s&&this.hasSelectedItem()&&this.close(!0)},beforeOnCellMouseUp:e=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(e))},afterOnCellMouseUp:e=>{Hc()&&Yc(e)||!s||!this.hasSelectedItem()||(_c()||kc()?setTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new WC(this.container,r),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.addHook("afterSelection",(function(){return e.onAfterSelection(...arguments)})),this.hotMenu.init(),this.hotMenu.listen();const l=this.hotMenu.getShortcutManager(),a=l.addContext(cS),h={...{group:hS},runOnlyIf:e=>!1===fh(e.target)||!1===this.container.contains(e.target)};l.setActiveContextName("menu"),a.addShortcuts([{keys:[["Escape"]],callback:()=>{this.keyEvent=!0,this.close(),this.keyEvent=!1}},{keys:[["ArrowDown"]],callback:()=>{const e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e?this.selectNextCell(e[0],e[1]):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowUp"]],callback:()=>{const e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e?this.selectPrevCell(e[0],e[1]):this.selectLastCell(),this.keyEvent=!1}},{keys:[["ArrowRight"]],callback:()=>{const e=this.hotMenu.getSelectedLast();if(this.keyEvent=!0,e){const t=this.openSubMenu(e[0]);t&&t.selectFirstCell()}this.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:()=>{const e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen()),this.keyEvent=!1}},{keys:[["Enter"]],callback:e=>{const t=this.hotMenu.getSelectedLast();this.keyEvent=!0,this.hotMenu.getSourceDataAtRow(t[0]).submenu||(this.executeCommand(e),this.close(!0)),this.keyEvent=!1}},{keys:[["PageUp"]],callback:()=>{const e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["PageDown"]],callback:()=>{const e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.selectLastCell(),this.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}close(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!function(e){return Na(e,"htSubmenu")}(t))return!1;const n=this.hotMenu.getSourceDataAtRow(e),o=new uS(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(n.submenu.items),o.open(),o.setPosition(t.getBoundingClientRect()),this.hotSubMenus[n.key]=o,o}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])}closeAllSubMenus(){Xl(this.hotMenu.getData(),((e,t)=>this.closeSubMenu(t)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const n=this.hot.getSelectedRange(),o=n?function(e){return ql(e,(e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()})))}(n):[];this.runLocalHooks("executeCommand",t.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,o,e)}isCommandPassive(e){const{isCommand:t,name:n,disabled:o,submenu:i}=e,s=!0===o||"function"==typeof o&&!0===o.call(this.hot);return!1===t||n===pb||!0===s||i}setPosition(e){const t=new aS(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),this.hot.isLtr()?this.setHorizontalPositionForLtr(t):this.setHorizontalPositionForRtl(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}setHorizontalPositionForRtl(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}setHorizontalPositionForLtr(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}setPositionAboveCursor(e){let t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=`${t}px`}setPositionBelowCursor(e){let t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top=`${t}px`}setPositionOnRightOfCursor(e){let t=e.left;if(this.isSubMenu()){const{right:n}=this.parentMenu.container.getBoundingClientRect();t+=e.cellWidth+n-(e.left+e.cellWidth)}else t+=this.offset.right;this.container.style.left=`${t}px`}setPositionOnLeftOfCursor(e){let t=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){const{left:n}=this.parentMenu.container.getBoundingClientRect();t-=e.left-n}this.container.style.left=`${t}px`}selectFirstCell(){const e=this.hotMenu.getCell(0,0);wb(e)||Cb(e)||yb(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}selectLastCell(){const e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);wb(t)||Cb(t)||yb(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}selectNextCell(e,t){const n=e+1,o=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,t):null;o&&(wb(o)||Cb(o)||yb(o)?this.selectNextCell(n,t):this.hotMenu.selectCell(n,t))}selectPrevCell(e,t){const n=e-1,o=n>=0?this.hotMenu.getCell(n,t):null;o&&(wb(o)||Cb(o)||yb(o)?this.selectPrevCell(n,t):this.hotMenu.selectCell(n,t))}menuItemRenderer(e,t,n,o,i,s){const r=e.getSourceDataAtRow(n),l=this.hot.rootDocument.createElement("div"),a=e=>e.disableSelection;let h=s;var c;"function"==typeof h&&(h=h.call(this.hot)),Fa(t),Pa(l,"htItemWrapper"),t.appendChild(l),c=r,new RegExp(pb,"i").test(c.name)?Pa(t,"htSeparator"):"function"==typeof r.renderer?(Pa(t,"htCustomMenuRenderer"),t.appendChild(r.renderer(e,l,n,o,i,h))):Wa(l,h),(e=>!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(this.hot))(r)?(Pa(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",(()=>e.deselectCell()))):a(r)?(Pa(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",(()=>e.deselectCell()))):(e=>Cc(e,"submenu"))(r)?(Pa(t,"htSubmenu"),a(r)?this.eventManager.addEventListener(t,"mouseenter",(()=>e.deselectCell())):this.eventManager.addEventListener(t,"mouseenter",(()=>e.selectCell(n,o,void 0,void 0,!1,!1)))):(La(t,["htSubmenu","htDisabled"]),a(r)?this.eventManager.addEventListener(t,"mouseenter",(()=>e.deselectCell())):this.eventManager.addEventListener(t,"mouseenter",(()=>e.selectCell(n,o,void 0,void 0,!1,!1))))}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.options.container.ownerDocument;let n,o=e;return o&&(vh(o)&&(o=o.call(this.hot),o=null===o||sa(o)?"":o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o=`${this.options.className}Sub_${o}`,n=t.querySelector(`.${this.options.className}.${o}`)),n||(n=t.createElement("div"),Pa(n,`htMenu ${this.options.className}`),o&&Pa(n,o),this.options.container.appendChild(n)),n}blockMainTableCallbacks(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}releaseMainTableCallbacks(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,n=e.hider.style,o=e.holder.style,i=parseInt(n.width,10),s=Gl(t,((e,t)=>e+(t.name===pb?1:26)),0);o.width=`${i+3}px`,o.height=`${s+3}px`,n.height=o.height}onAfterSelection(e,t,n,o,i){!1===this.keyEvent&&(i.value=!0)}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ia(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Ia(e.target,".htMenu")||this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Na(e.target,"htCore")&&Ia(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}hc(uS,hm);var dS=uS;const gS="contextMenu";nu.getSingleton().register("afterContextMenuDefaultOptions"),nu.getSingleton().register("beforeContextMenuShow"),nu.getSingleton().register("afterContextMenuShow"),nu.getSingleton().register("afterContextMenuHide"),nu.getSingleton().register("afterContextMenuExecute");class fS extends ov{static get PLUGIN_KEY(){return gS}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[eS,tS,pb,Kb,qb,pb,Qb,Jb,pb,oS,Zb,pb,Xb,pb,$b]}constructor(e){super(e),this.eventManager=new pu(this),this.commandExecutor=new Yb(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[gS]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[gS];"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new dS(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>this.onMenuBeforeOpen())),this.menu.addLocalHook("afterOpen",(()=>this.onMenuAfterOpen())),this.menu.addLocalHook("afterClose",(()=>this.onMenuAfterClose())),this.menu.addLocalHook("executeCommand",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.executeCommand.call(e,...n)})),this.addHook("afterOnCellContextMenu",(e=>this.onAfterOnCellContextMenu(e))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}open(e){if(!this.menu)return;if(this.prepareMenuItems(),this.menu.open(),!this.menu.isOpened())return;let t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:o}=this.hot.rootWindow,{top:i,left:s}=o.getBoundingClientRect();t=i-Ya(e.view),n=s-$a(e.view)}else t=-1*Ya(this.menu.hotMenu.rootWindow),n=-1*$a(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+n})}close(){this.menu&&(this.menu.close(),this.itemsFactory=null)}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new lS(this.hot,fS.DEFAULT_ITEMS);const e=this.hot.getSettings()[gS],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),Xl(n,(e=>this.commandExecutor.registerCommand(e.key,e)))}onAfterOnCellContextMenu(e){const t=this.hot.getSettings(),n=t.rowHeaders,o=t.colHeaders;const i=e.target;this.close(),Na(i,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),(n||o||function(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}(i)||Na(i,"current")&&Na(i,"wtBorder"))&&this.open(e))}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}fS.SEPARATOR={name:pb};class mS{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class pS{constructor(){this.clipboardData=new mS}}class wS{constructor(e){this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new pu(this),this.listenersCount=new WeakSet,this.container=e}useSecondaryElement(){const e=function(e){const t=bS.get(e);if(t)return t.parentElement||e.appendChild(t),t;const n=(e.defaultView?e:e.ownerDocument).createElement("textarea");return bS.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),vS(this.eventManager,e,this)),this.mainElement=e}setFocusableElement(e){this.listenersCount.has(e)||(this.listenersCount.add(e),vS(this.eventManager,e,this)),this.mainElement=e}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",_c()||ph(this.mainElement)}}hc(wS,hm);const CS=new WeakMap;const yS=(e,t)=>n=>t.runLocalHooks(e,n);function vS(e,t,n){e.addEventListener(t,"copy",yS("copy",n)),e.addEventListener(t,"cut",yS("cut",n)),e.addEventListener(t,"paste",yS("paste",n))}const bS=new WeakMap;function SS(e){if(!(e instanceof wS))return;let t=CS.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),function(e){e.eventManager.clear()}(e),t<=0){t=0;const n=bS.get(e.container);n&&n.parentNode&&(n.parentNode.removeChild(n),bS.delete(e.container)),e.mainElement=null}CS.set(e.container,t)}function RS(e,t){MS(e,t),t.add(e)}function ES(e,t,n){MS(e,t),t.set(e,n)}function MS(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TS(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function xS(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,AS(e,t,"get"))}function OS(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,AS(e,t,"set"),n),n}function AS(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var _S=new WeakMap,IS=new WeakMap,kS=new WeakMap,HS=new WeakMap,DS=new WeakMap,NS=new WeakMap,PS=new WeakSet,LS=new WeakSet;class VS{constructor(e){let{countRows:t,countColumns:n,rowsLimit:o,columnsLimit:i,countColumnHeaders:s}=e;RS(this,LS),RS(this,PS),ES(this,_S,{writable:!0,value:void 0}),ES(this,IS,{writable:!0,value:void 0}),ES(this,kS,{writable:!0,value:void 0}),ES(this,HS,{writable:!0,value:void 0}),ES(this,DS,{writable:!0,value:void 0}),ES(this,NS,{writable:!0,value:void 0}),OS(this,IS,t),OS(this,kS,n),OS(this,HS,o),OS(this,DS,i),OS(this,NS,s)}setSelectedRange(e){OS(this,_S,e)}getCellsRange(){if(0===xS(this,IS).call(this)||0===xS(this,kS).call(this))return null;const{row:e,col:t}=xS(this,_S).getTopStartCorner(),{row:n,col:o}=xS(this,_S).getBottomEndCorner(),i=TS(this,LS,BS).call(this,e,n),s=TS(this,PS,FS).call(this,t,o);return{isRangeTrimmed:n!==i||o!==s,startRow:e,startCol:t,endRow:i,endCol:s}}getMostBottomColumnHeadersRange(){if(0===xS(this,kS).call(this)||0===xS(this,NS).call(this))return null;const{col:e}=xS(this,_S).getTopStartCorner(),{col:t}=xS(this,_S).getBottomEndCorner(),n=TS(this,PS,FS).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(0===xS(this,kS).call(this)||0===xS(this,NS).call(this))return null;const{col:e}=xS(this,_S).getTopStartCorner(),{col:t}=xS(this,_S).getBottomEndCorner(),n=TS(this,PS,FS).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-xS(this,NS).call(this),startCol:e,endRow:-1,endCol:n}}}function FS(e,t){return Math.min(t,Math.max(e+xS(this,DS).call(this)-1,e))}function BS(e,t){return Math.min(t,Math.max(e+xS(this,HS).call(this)-1,e))}function WS(e){const t=[],n=[];return Xl(e,(e=>{_u(Math.min(e.startRow,e.endRow),Math.max(e.startRow,e.endRow),(e=>{-1===t.indexOf(e)&&t.push(e)}));_u(Math.min(e.startCol,e.endCol),Math.max(e.startCol,e.endCol),(e=>{-1===n.indexOf(e)&&n.push(e)}))})),{rows:t,columns:n}}function US(e,t,n){jS(e,t),t.set(e,n)}function jS(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YS(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,GS(e,t,"get"))}function $S(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,GS(e,t,"set"),n),n}function GS(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}nu.getSingleton().register("afterCopyLimit"),nu.getSingleton().register("modifyCopyableRange"),nu.getSingleton().register("beforeCut"),nu.getSingleton().register("afterCut"),nu.getSingleton().register("beforePaste"),nu.getSingleton().register("afterPaste"),nu.getSingleton().register("beforeCopy"),nu.getSingleton().register("afterCopy");const KS="copyPaste",qS=["fragmentSelection"],XS=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var ZS=new WeakMap,JS=new WeakMap,QS=new WeakMap,eR=new WeakMap,tR=new WeakMap,nR=new WeakMap,oR=new WeakMap,iR=new WeakSet;class sR extends ov{constructor(){var e,t;super(...arguments),jS(e=this,t=iR),t.add(e),zS(this,"columnsLimit",1/0),zS(this,"rowsLimit",1/0),zS(this,"pasteMode","overwrite"),zS(this,"uiContainer",this.hot.rootDocument.body),US(this,ZS,{writable:!0,value:!1}),US(this,JS,{writable:!0,value:!1}),US(this,QS,{writable:!0,value:!1}),US(this,eR,{writable:!0,value:"cells-only"}),US(this,tR,{writable:!0,value:!1}),US(this,nR,{writable:!0,value:!1}),US(this,oR,{writable:!0,value:new VS({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),zS(this,"copyableRanges",[]),zS(this,"focusableElement",void 0)}static get PLUGIN_KEY(){return KS}static get SETTING_KEYS(){return[KS,...qS]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[KS]}enablePlugin(){if(this.enabled)return;const{[KS]:e}=this.hot.getSettings();var t,n;"object"==typeof e&&(this.pasteMode=null!==(t=e.pasteMode)&&void 0!==t?t:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,$S(this,ZS,!!e.copyColumnHeaders),$S(this,JS,!!e.copyColumnGroupHeaders),$S(this,QS,!!e.copyColumnHeadersOnly),this.uiContainer=null!==(n=e.uiContainer)&&void 0!==n?n:this.uiContainer);this.addHook("afterContextMenuDefaultOptions",(e=>this.onAfterContextMenuDefaultOptions(e))),this.addHook("afterOnCellMouseUp",(()=>this.onAfterOnCellMouseUp())),this.addHook("afterSelectionEnd",(()=>this.onAfterSelectionEnd())),this.addHook("beforeKeyDown",(()=>this.onBeforeKeyDown())),this.focusableElement=function(e){const t=new wS(e);let n=CS.get(e);return n=isNaN(n)?0:n,CS.set(e,n+1),t}(this.uiContainer),this.focusableElement.addLocalHook("copy",(e=>this.onCopy(e))).addLocalHook("cut",(e=>this.onCut(e))).addLocalHook("paste",(e=>this.onPaste(e))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&SS(this.focusableElement),super.disablePlugin()}copy(){$S(this,eR,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),$S(this,tR,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){$S(this,nR,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(e){return hC(this.getRangedData(e))}getRangedData(e){const t=[],{rows:n,columns:o}=WS(e);return Xl(n,(e=>{const n=[];Xl(o,(t=>{e<0?n.push(this.hot.getColHeader(t,e)):n.push(this.hot.getCopyableData(e,t))})),t.push(n)})),t}paste(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e&&!t)return;const n=new pS;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;YS(this,oR).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);"column-headers-only"===YS(this,eR)?t.set("headers",YS(this,oR).getMostBottomColumnHeadersRange()):("with-column-headers"===YS(this,eR)?t.set("headers",YS(this,oR).getMostBottomColumnHeadersRange()):"with-column-group-headers"===YS(this,eR)&&t.set("headers",YS(this,oR).getAllColumnHeadersRange()),t.set("cells",YS(this,oR).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter((e=>null!==e)).map((e=>{let{startRow:t,startCol:n,endRow:o,endCol:i}=e;return{startRow:t,startCol:n,endRow:o,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=t.get("cells");if(null!==n&&n.isRangeTrimmed){const{startRow:e,startCol:t,endRow:o,endCol:i}=n;this.hot.runHooks("afterCopyLimit",o-e+1,i-t+1,this.rowsLimit,this.columnsLimit)}}getOrCreateFocusableElement(){var e;const t=null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.TEXTAREA;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}isEditorOpened(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,o=e[0].length,i=[],{row:s,col:r}=t.getTopStartCorner(),{row:l,col:a}=t.getBottomEndCorner();let h=s,c=r,u=s,d=r;for(;i.length<n||h<=l;){const{skipRowOnPaste:t,visualRow:l}=this.hot.getCellMeta(h,r);if(h=l+1,!0===t)continue;u=l,c=r;const g=[],f=i.length%n;for(;g.length<o||c<=a;){const{skipColumnOnPaste:t,visualCol:n}=this.hot.getCellMeta(s,c);if(c=n+1,!0===t)continue;d=n;const i=g.length%o;g.push(e[f][i])}i.push(g)}return this.hot.populateFromArray(s,r,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,r,u,d]}onCopy(e){if(!this.hot.isListening()&&!YS(this,tR)||this.isEditorOpened())return;this.setCopyableText(),$S(this,tR,!1);const t=this.getRangedData(this.copyableRanges),n=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,iR,rR).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",t,this.copyableRanges,n)){const o=hC(t);if(e&&e.clipboardData){const n=Mu(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[XS,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",t,this.copyableRanges,n)}$S(this,eR,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!YS(this,nR)||this.isEditorOpened())return;this.setCopyableText(),$S(this,nR,!1);const t=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",t,this.copyableRanges)){const n=hC(t);if(e&&e.clipboardData){const o=Mu(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",n),e.clipboardData.setData("text/html",[XS,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened())return;let t;if(e&&e.preventDefault&&e.preventDefault(),e&&void 0!==e.clipboardData){const n=Ea(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(n&&/(<table)|(<TABLE)/g.test(n)){t=Tu(n,this.hot.rootDocument).data}else t=e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof t&&(t=function(e){const t=[[""]];if(0===e.length)return t;let n,o=0,i=0;for(;e.length>0&&n!==e.length;)if(n=e.length,e.match(aC))e=e.replace(aC,""),o+=1,t[i][o]="";else if(e.match(rC))e=e.replace(rC,""),o=0,i+=1,t[i]=[""];else{let n="";if(e.startsWith('"')){let t=0,o=!0;for(;o;){const i=e.slice(0,1);'"'===i&&(t+=1),n+=i,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&t%2==0)&&(o=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(e=>new Array(Math.floor(e.length/2)).fill('"').join("")))}else{const t=e.match(lC);n=t?t[0]:"",e=e.slice(n.length)}t[i][o]=n}return t}(t)),t&&0===t.length)return;if(!1===this.hot.runHooks("beforePaste",t,this.copyableRanges))return;const[n,o,i,s]=this.populateValues(t);this.hot.selectCell(n,o,Math.min(this.hot.countRows()-1,i),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}onAfterContextMenuDefaultOptions(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name(){return this.getTranslatedPhrase(ap)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1})),YS(this,ZS)&&e.items.push(function(e){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(hp,t)},callback(){e.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),YS(this,JS)&&e.items.push(function(e){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(cp,t)},callback(){e.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),YS(this,QS)&&e.items.push(function(e){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(up,t)},callback(){e.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),e.items.push(function(e){return{key:"cut",name(){return this.getTranslatedPhrase(dp)},callback(){e.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}onAfterOnCellMouseUp(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&sh()||(this.setCopyableText(),this.focusableElement.focus()))}onBeforeKeyDown(){if(!this.hot.isListening()||this.isEditorOpened())return;const e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}destroy(){this.focusableElement&&(SS(this.focusableElement),this.focusableElement=null),super.destroy()}}function rR(e){const{rows:t}=WS(e);let n=0;for(let e=0;e<t.length&&!(t[e]>=0);e++)n+=1;return{columnHeadersCount:n}}function lR(e,t){return`border_row${e}col${t}`}function aR(e){var t,n;(ia(e.start)||ia(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left);(ia(e.end)||ia(e.right))&&(e.end=null!==(n=e.end)&&void 0!==n?n:e.right);return delete e.left,delete e.right,e}function hR(e){return ia(e.start)&&(e.left=e.start),ia(e.end)&&(e.right=e.end),e}function cR(e,t){return{id:lR(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function uR(e,t){let n=!1;return Xl(e.getSelectedRange(),(o=>{o.forAll(((o,i)=>{if(o<0||i<0)return;const s=e.getCellMeta(o,i).borders;if(s){if(!t)return n=!0,!1;if(!Cc(s[t],"hide")||!1===s[t].hide)return n=!0,!1}}))})),n}function dR(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}const gR=new Map([["left","start"],["right","end"]]);function fR(e){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(kp);return uR(this,"bottom")&&(e=dR(e)),e},callback(t,n){const o=uR(this,"bottom");e.prepareBorder(n,"bottom",o)}}}function mR(e){const t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let e=this.getTranslatedPhrase(Hp);return uR(this,t)&&(e=dR(e)),e},callback(n,o){const i=uR(this,t);e.prepareBorder(o,t,i)}}}function pR(e){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Dp)},callback(t,n){e.prepareBorder(n,"noBorders")},disabled(){return!uR(this)}}}function wR(e){const t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let e=this.getTranslatedPhrase(Ip);return uR(this,t)&&(e=dR(e)),e},callback(n,o){const i=uR(this,t);e.prepareBorder(o,t,i)}}}function CR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const yR="customBorders";class vR extends ov{constructor(){super(...arguments),CR(this,"savedBorders",[])}static get PLUGIN_KEY(){return yR}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[yR]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(e=>this.onAfterContextMenuDefaultOptions(e))),this.addHook("init",(()=>this.onAfterInit())),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let n=["top","bottom","start","end"],o=null;t&&(this.checkSettingsCohesion([t]),n=Object.keys(t),o=aR(t));const i=nC(tC(e));Xl(e,(e=>{const[t,s,r,l]=i(e);for(let e=t;e<=r;e+=1)for(let t=s;t<=l;t+=1)Xl(n,(n=>{var i,s;this.prepareBorderFromCustomAdded(e,t,o,(i=n,null!==(s=gR.get(i))&&void 0!==s?s:i))}))})),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=nC(tC(e)),n=[];return Xl(e,(e=>{const[o,i,s,r]=t(e);for(let e=o;e<=s;e+=1)for(let t=i;t<=r;t+=1)Xl(this.savedBorders,(o=>{o.row===e&&o.col===t&&n.push(hR(o))}))})),n}clearBorders(e){e?this.setBorders(e):(Xl(this.savedBorders,(e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),this.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const n=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,n,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}prepareBorderFromCustomAdded(e,t,n,o){const i=this.hot.countRows(),s=this.hot.countCols();if(e>=i||t>=s)return;let r=cR(e,t);var l,a;n&&(l=r,Cc(a=n,"border")&&a.border&&(l.border=a.border),Cc(a,"top")&&ia(a.top)&&(a.top?(uc(a.top)||(a.top={width:1,color:"#000"}),l.top=a.top):(a.top={hide:!0},l.top=a.top)),Cc(a,"bottom")&&ia(a.bottom)&&(a.bottom?(uc(a.bottom)||(a.bottom={width:1,color:"#000"}),l.bottom=a.bottom):(a.bottom={hide:!0},l.bottom=a.bottom)),Cc(a,"start")&&ia(a.start)&&(a.start?(uc(a.start)||(a.start={width:1,color:"#000"}),l.start=a.start):(a.start={hide:!0},l.start=a.start)),Cc(a,"end")&&ia(a.end)&&(a.end?(uc(a.end)||(a.end={width:1,color:"#000"}),l.end=a.end):(a.end={hide:!0},l.end=a.end)),r=l,Xl(this.hot.selection.highlight.customSelections,(e=>{if(r.id===e.settings.id)return Object.assign(e.settings,n),r.id=e.settings.id,r.top=e.settings.top,r.bottom=e.settings.bottom,r.start=e.settings.start,r.end=e.settings.end,!1}))),this.hot.setCellMeta(e,t,"borders",hR(r)),this.insertBorderIntoSettings(r,o)}prepareBorderFromCustomAddedRange(e,t){const n=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);_u(e.from.row,n,(n=>{_u(e.from.col,o,(o=>{const i=cR(n,o);let s=0;n===e.from.row&&Cc(t,"top")&&(s+=1,i.top=t.top),n===e.to.row&&Cc(t,"bottom")&&(s+=1,i.bottom=t.bottom),o===e.from.col&&Cc(t,"start")&&(s+=1,i.start=t.start),o===e.to.col&&Cc(t,"end")&&(s+=1,i.end=t.end),s>0&&(this.hot.setCellMeta(n,o,"borders",hR(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(e,t){const n=lR(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,n,o){let i=this.hot.getCellMeta(e,t).borders;if(i=i&&void 0!==i.border?aR(i):cR(e,t),o){i[n]={hide:!0};if(4===this.countHide(i))this.removeAllBorders(e,t);else{this.checkCustomSelectionsFromContextMenu(i,n,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",hR(i))}}else{i[n]={width:1,color:"#000"};this.checkCustomSelectionsFromContextMenu(i,n,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",hR(i))}}prepareBorder(e,t,n){Xl(e,(e=>{let{start:o,end:i}=e;if(o.row===i.row&&o.col===i.col)"noBorders"===t?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,t,n);else switch(t){case"noBorders":_u(o.col,i.col,(e=>{_u(o.row,i.row,(t=>{this.removeAllBorders(t,e)}))}));break;case"top":_u(o.col,i.col,(e=>{this.setBorder(o.row,e,t,n)}));break;case"bottom":_u(o.col,i.col,(e=>{this.setBorder(i.row,e,t,n)}));break;case"start":_u(o.row,i.row,(e=>{this.setBorder(e,o.col,t,n)}));break;case"end":_u(o.row,i.row,(e=>{this.setBorder(e,i.col,t,n)}))}}))}createCustomBorders(e){Xl(e,(e=>{const t=aR(e);e.range?this.prepareBorderFromCustomAddedRange(e.range,t):this.prepareBorderFromCustomAdded(e.row,e.col,t)}))}countHide(e){const{top:t,bottom:n,start:o,end:i}=e;return Gl([t,n,o,i],((e,t)=>{let n=e;return t&&t.hide&&(n+=1),n}),0)}clearBordersFromSelectionSettings(e){const t=ql(this.hot.selection.highlight.customSelections,(e=>e.settings.id)).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){Xl(this.hot.selection.highlight.customSelections,((e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1}))}hideBorders(){Xl(this.savedBorders,(e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()}))}spliceBorder(e){const t=ql(this.savedBorders,(e=>e.id)).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),t=!0):Xl(this.savedBorders,((n,o)=>{if(e.id===n.id)return this.savedBorders[o]=e,t=!0,!1})),t}checkCustomSelectionsFromContextMenu(e,t,n){let o=!1;return Xl(this.hot.selection.highlight.customSelections,(i=>{if(e.id===i.settings.id)return gc(i.instanceBorders,(e=>{e.toggleHiddenClass(t,n)})),o=!0,!1})),o}checkCustomSelections(e,t,n){const o=this.countHide(e);let i=!1;return 4===o?(this.removeAllBorders(e.row,e.col),i=!0):Xl(this.hot.selection.highlight.customSelections,(o=>{if(e.id===o.settings.id)return o.visualCellRange=t,o.commit(),n&&gc(o.instanceBorders,(t=>{t.changeBorderStyle(n,e)})),i=!0,!1})),i}changeBorderSettings(){const e=this.hot.getSettings()[yR];if(Array.isArray(e)){const t=lc(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=e.some((e=>ia(e.left)||ia(e.right)));const n=function(e){return e.some((e=>ia(e.start)||ia(e.end)))}(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){var t;this.hot.getSettings()[yR]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Ap)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[(t=this,{key:"borders:top",name(){let e=this.getTranslatedPhrase(_p);return uR(this,"top")&&(e=dR(e)),e},callback(e,n){const o=uR(this,"top");t.prepareBorder(n,"top",o)}}),wR(this),fR(this),mR(this),pR(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const bR="dragToScroll";class SR extends ov{static get PLUGIN_KEY(){return bR}static get PLUGIN_PRIORITY(){return 100}constructor(e){super(e),this.eventManager=new pu(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[bR]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(e=>this.setupListening(e))),this.addHook("afterOnCellCornerMouseDown",(e=>this.setupListening(e))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let n=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(t.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(t.document,"mousemove",(e=>this.onMouseMove(e))),t=Oa(t)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(Yc(e))return;const t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback(((e,n)=>{e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)})),this.listen())}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}nu.getSingleton().register("afterDropdownMenuDefaultOptions"),nu.getSingleton().register("beforeDropdownMenuShow"),nu.getSingleton().register("afterDropdownMenuShow"),nu.getSingleton().register("afterDropdownMenuHide"),nu.getSingleton().register("afterDropdownMenuExecute");const RR="dropdownMenu",ER="changeType";class MR extends ov{static get PLUGIN_KEY(){return RR}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Kb,qb,pb,Jb,pb,Gb,pb,Xb,pb,$b]}constructor(e){super(e),this.eventManager=new pu(this),this.commandExecutor=new Yb(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",((e,t)=>this.onAfterGetColHeader(e,t)))}isEnabled(){return this.hot.getSettings()[RR]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new lS(this.hot,MR.DEFAULT_ITEMS);const t=this.hot.getSettings()[RR],n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const o=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new dS(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",(()=>this.onMenuBeforeOpen())),this.menu.addLocalHook("afterOpen",(()=>this.onMenuAfterOpen())),this.menu.addLocalHook("afterClose",(()=>this.onMenuAfterClose())),this.menu.addLocalHook("executeCommand",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.executeCommand.call(e,...n)})),Xl(o,(e=>this.commandExecutor.registerCommand(e.key,e)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),super.disablePlugin()}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(e=>this.onTableClick(e)))}open(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}close(){this.menu&&this.menu.close()}executeCommand(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.commandExecutor.execute(e,...n)}setListening(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(e){if(e.stopPropagation(),Na(e.target,ER)&&!this.menu.isOpened()){let t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:e}=this.hot.rootWindow,{top:o,left:i}=e.getBoundingClientRect();t=o,n=i}const o=e.target.getBoundingClientRect();this.open({left:o.left+n,top:o.top+e.target.offsetHeight+3+t,width:o.width,height:o.height})}}onAfterGetColHeader(e,t){const n=t.parentNode;if(!n)return;const o=n.parentNode.childNodes,i=Array.prototype.indexOf.call(o,n);if(e<0||i!==o.length-1)return;const s=t.querySelector(`.${ER}`);if(this.enabled&&s)return;if(!this.enabled)return void(s&&s.parentNode.removeChild(s));const r=this.hot.rootDocument.createElement("button");r.className=ER,r.type="button",r.onclick=function(){return!1},t.firstChild.insertBefore(r,t.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}MR.SEPARATOR={name:pb};var TR=class{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:n,endCol:o}=this._getDataRange(),i=this.options,s=[];return _u(e,n,(e=>{const n=[];!i.exportHiddenRows&&this._isHiddenRow(e)||(_u(t,o,(t=>{!i.exportHiddenColumns&&this._isHiddenColumn(t)||n.push(this.hot.getDataAtCell(e,t))})),s.push(n))})),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:n}=this._getDataRange(),o=this.hot.getRowHeader();_u(t,n,(t=>{!this.options.exportHiddenRows&&this._isHiddenRow(t)||e.push(o[t])}))}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:n}=this._getDataRange(),o=this.hot.getColHeader();_u(t,n,(t=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(t)||e.push(o[t])}))}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[n=0,o=0,i=t,s=e]=this.options.range;return n=Math.max(n,0),o=Math.max(o,0),i=Math.min(i,t),s=Math.min(s,e),{startRow:n,startCol:o,endRow:i,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}};class xR{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=ac(this.constructor.DEFAULT_OPTIONS);const n=new Date;return t=sc(ac(xR.DEFAULT_OPTIONS),t),t=sc(t,e),t.filename=Sa(t.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),t}}var OR=xR;const AR=String.fromCharCode(13),_R=String.fromCharCode(34),IR=String.fromCharCode(10);var kR=class extends OR{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const e=this.options,t=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const o=n.length>0,i=this.dataProvider.getRowHeaders(),s=i.length>0;let r=e.bom?String.fromCharCode(65279):"";return o&&(n=ql(n,(e=>this._escapeCell(e,!0))),s&&(r+=e.columnDelimiter),r+=n.join(e.columnDelimiter),r+=e.rowDelimiter),Xl(t,((t,n)=>{n>0&&(r+=e.rowDelimiter),s&&(r+=this._escapeCell(i[n])+e.columnDelimiter),r+=t.map((e=>this._escapeCell(e))).join(e.columnDelimiter)})),r}_escapeCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=oa(e);return""!==n&&(t||n.indexOf(AR)>=0||n.indexOf(_R)>=0||n.indexOf(IR)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}};const HR="csv",DR={[HR]:kR};class NR extends ov{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:n,rootWindow:o}=this.hot,i=this._createTypeFormatter(e,t),s=this._createBlob(i),r=o.URL||o.webkitURL,l=n.createElement("a"),a=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==l.download){const e=r.createObjectURL(s);l.style.display="none",l.setAttribute("href",e),l.setAttribute("download",a),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout((()=>{r.revokeObjectURL(e)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,a)}_createTypeFormatter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!DR[e])throw new Error(`Export format type "${e}" is not supported.`);return function(e,t,n){return"function"==typeof DR[e]?new DR[e](t,n):null}(e,new TR(this.hot),t)}_createBlob(e){let t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}class PR{constructor(e,t){let{id:n,stateless:o=!0}=t;this.hot=e,this.id=n,this.elements=[],this.hidden=!1,this.stateId=`Filters.component.${this.id}`,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new vm)}reset(){Xl(this.elements,(e=>e.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Xl(this.elements,(e=>e.destroy())),this.state=null,this.elements=null,this.hot=null}}hc(PR,hm);var LR=PR;const VR={};function FR(e,t){if(!VR[e])throw Error(`Filter condition "${e}" does not exist.`);const{condition:n,descriptor:o}=VR[e];let i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(e){return n.apply(e.meta.instance,[].concat([e],[i]))}}function BR(e){if(!VR[e])throw Error(`Filter condition "${e}" does not exist.`);return VR[e].descriptor}function WR(e,t,n){n.key=e,VR[e]={condition:t,descriptor:n}}const UR="none";WR(UR,(function(){return!0}),{name:jp,inputsCount:0,showOperators:!1});const jR="empty";WR(jR,(function(e){return ra(e.value)}),{name:zp,inputsCount:0,showOperators:!0});const zR="not_empty";WR(zR,(function(e,t){return!FR(jR,t)(e)}),{name:Yp,inputsCount:0,showOperators:!0});const YR="eq";WR(YR,(function(e,t){let[n]=t;return oa(e.value).toLocaleLowerCase(e.meta.locale)===oa(n)}),{name:$p,inputsCount:1,showOperators:!0});const $R="neq";WR($R,(function(e,t){return!FR(YR,t)(e)}),{name:Gp,inputsCount:1,showOperators:!0});WR("gt",(function(e,t){let[n]=t,o=n;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value>o}),{name:Qp,inputsCount:1,showOperators:!0});WR("gte",(function(e,t){let[n]=t,o=n;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value>=o}),{name:ew,inputsCount:1,showOperators:!0});WR("lt",(function(e,t){let[n]=t,o=n;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value<o}),{name:tw,inputsCount:1,showOperators:!0});WR("lte",(function(e,t){let[n]=t,o=n;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value<=o}),{name:nw,inputsCount:1,showOperators:!0});const GR="date_after";WR(GR,(function(e,t){let[n]=t;const o=jl(e.value,e.meta.dateFormat),i=jl(n,e.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)>=0}),{name:sw,inputsCount:1,showOperators:!0});const KR="date_before";WR(KR,(function(e,t){let[n]=t;const o=jl(e.value,e.meta.dateFormat),i=jl(n,e.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)<=0}),{name:rw,inputsCount:1,showOperators:!0});const qR="between";WR(qR,(function(e,t){let[n,o]=t,i=n,s=o;if("numeric"===e.meta.type){const e=parseFloat(i,10),t=parseFloat(s,10);i=Math.min(e,t),s=Math.max(e,t)}else if("date"===e.meta.type){const t=FR(KR,[s]),n=FR(GR,[i]);return t(e)&&n(e)}return e.value>=i&&e.value<=s}),{name:ow,inputsCount:2,showOperators:!0});const XR="not_between";WR(XR,(function(e,t){return!FR(qR,t)(e)}),{name:iw,inputsCount:2,showOperators:!0});const ZR="begins_with";WR(ZR,(function(e,t){let[n]=t;return oa(e.value).toLocaleLowerCase(e.meta.locale).startsWith(oa(n))}),{name:Kp,inputsCount:1,showOperators:!0});const JR="ends_with";WR(JR,(function(e,t){let[n]=t;return oa(e.value).toLocaleLowerCase(e.meta.locale).endsWith(oa(n))}),{name:qp,inputsCount:1,showOperators:!0});const QR="contains";WR(QR,(function(e,t){let[n]=t;return oa(e.value).toLocaleLowerCase(e.meta.locale).indexOf(oa(n))>=0}),{name:Xp,inputsCount:1,showOperators:!0});const eE="not_contains";WR(eE,(function(e,t){return!FR(QR,t)(e)}),{name:Zp,inputsCount:1,showOperators:!0});const tE="date_tomorrow";WR(tE,(function(e){const t=jl(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(jl().subtract(-1,"days").startOf("day"),"d")}),{name:aw,inputsCount:0});const nE="date_today";WR(nE,(function(e){const t=jl(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(jl().startOf("day"),"d")}),{name:lw,inputsCount:0});const oE="date_yesterday";function iE(e,t){let n=e;return""===n&&(n=`(${t})`),n}WR(oE,(function(e){const t=jl(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(jl().subtract(1,"days").startOf("day"),"d")}),{name:hw,inputsCount:0}),gg();const sE=new Set([1]).has(1),rE=sE&&"function"==typeof Array.from;function lE(e){let t=e;return sE&&(t=new Set(t)),function(e){let n;return n=sE?t.has(e):!!~t.indexOf(e),n}}function aE(e){return null==e?"":e}function hE(e){let t=e;return t=rE?Array.from(new Set(t)):Jl(t),t=t.sort(((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e===t?0:e>t?1:-1)),t}function cE(e,t,n,o){const i=[],s=e===t;let r;return s||(r=lE(t)),Xl(e,(e=>{let t=!1;(s||r(e))&&(t=!0);const l={checked:t,value:e,visualValue:iE(e,n)};o&&o(l),i.push(l)})),i}const uE="by_value";WR(uE,(function(e,t){let[n]=t;return n(e.value)}),{name:"By value",inputsCount:0,inputValuesDecorator(e){let[t]=e;return[lE(t)]},showOperators:!1});const dE={};function gE(e){return dE[e].name}function fE(e,t,n){dE[e]={name:t,func:n}}const mE="conjunction";fE(mE,dw,(function(e,t){return e.every((e=>e.func(t)))}));const pE="disjunction";fE(pE,gw,(function(e,t){return e.some((e=>e.func(t)))}));const wE="disjunctionWithExtraCondition";fE(wE,gw,(function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((e=>e.func(t)))&&e[e.length-1].func(t)}));const CE="numeric",yE="text",vE="date",bE={[CE]:[UR,pb,jR,zR,pb,YR,$R,pb,"gt","gte","lt","lte",qR,XR],[yE]:[UR,pb,jR,zR,pb,YR,$R,pb,ZR,JR,pb,QR,eE],[vE]:[UR,pb,jR,zR,pb,YR,$R,pb,KR,GR,qR,pb,tE,nE,oE]};const SE="built",RE="building",EE=["click","input","keydown","keypress","keyup","focus","blur","change"];let ME=class e{static get DEFAULTS(){return ac({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,n){this.hot=t,this.eventManager=new pu(this),this.options=sc(e.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===RE?this._element:this.buildState===SE?(this.update(),this._element):(this.buildState=RE,this.build(),this.buildState=SE,this._element)}isBuilt(){return this.buildState===SE}translateIfPossible(e){return"string"==typeof e&&e.startsWith(Wp)?this.hot.getTranslatedPhrase(e):e}build(){const e=(e,t)=>{this.eventManager.addEventListener(e,t,(e=>this.runLocalHooks(t,e,this)))};if(this.buildState||(this.buildState=RE),this.options.className&&Pa(this._element,this.options.className),this.options.children.length)Xl(this.options.children,(e=>this._element.appendChild(e.element)));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);gc(this.options,((e,n)=>{void 0!==t[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(t[n]=this.translateIfPossible(e))})),this._element.appendChild(t),Xl(EE,(n=>e(t,n)))}else Xl(EE,(t=>e(this._element,t)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};hc(ME,hm);var TE=ME;const xE=new WeakMap;class OE extends TE{static get DEFAULTS(){return ac({placeholder:"",type:"text",tagName:"input"})}constructor(e,t){super(e,sc(OE.DEFAULTS,t)),xE.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",(()=>this.onClick())),this.addLocalHook("keyup",(e=>this.onKeyup(e)))}build(){super.build();const e=xE.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,Pa(this._element,"htUIInput"),Pa(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=xE.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}focus(){this.isBuilt()&&xE.get(this).input.focus()}onClick(){}onKeyup(e){this.options.value=e.target.value}}var AE=OE;const _E=new WeakMap;class IE extends TE{static get DEFAULTS(){return ac({className:"htUISelect",wrapIt:!1})}constructor(e,t){super(e,sc(IE.DEFAULTS,t)),_E.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",(()=>this.onClick()))}setItems(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}translateNames(e){return Xl(e,(e=>{e.name=this.translateIfPossible(e.name)})),e}build(){super.build(),this.menu=new dS(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);const e=new TE(this.hot,{className:"htUISelectCaption"}),t=new TE(this.hot,{className:"htUISelectDropdown"}),n=_E.get(this);n.caption=e,n.captionElement=e.element,n.dropdown=t,Xl([e,t],(e=>this._element.appendChild(e.element))),this.menu.addLocalHook("select",(e=>this.onMenuSelect(e))),this.menu.addLocalHook("afterClose",(()=>this.onMenuClosed())),this.update()}update(){if(!this.isBuilt())return;let e;e=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(jp),_E.get(this).captionElement.textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(e){e.name!==pb&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);const{caption:e,dropdown:t}=_E.get(this);e&&e.destroy(),t&&t.destroy(),super.destroy()}}var kE=IE;var HE=class extends LR{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new kE(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new AE(this.hot,{placeholder:vw})),this.elements.push(new AE(this.hot,{placeholder:bw})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(e=>this.onConditionSelect(e))),this.getSelectElement().addLocalHook("afterClose",(()=>this.onSelectUIClosed())),Xl(this.getInputElements(),(e=>{e.addLocalHook("keydown",(e=>this.onInputKeyDown(e)))}))}setState(e){if(this.reset(),!e)return;const t=ac(e.command);t.name.startsWith(Up)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),Xl(e.args,((e,n)=>{if(n>t.inputsCount-1)return!1;const o=this.getInputElement(n);o.setValue(e),o[t.inputsCount>n?"show":"hide"](),n||setTimeout((()=>o.focus()),10)}))}getState(){const e=this.getSelectElement().getValue()||BR(UR),t=[];return Xl(this.getInputElements(),((n,o)=>{e.inputsCount>o&&t.push(n.getValue())})),{command:e,args:t}}updateState(e,t){const n=BR(e?e.name:UR);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||Xl(this.getInputElements(),(e=>e.setValue(null)))}getSelectElement(){return this.elements.filter((e=>e instanceof kE))[0]}getInputElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter((e=>e instanceof AE))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,o,i,s)=>{Pa(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Pa(t.parentNode,"border");const r=this.hot.rootDocument.createElement("div");return Pa(r,"htFiltersMenuLabel"),r.textContent=s,t.appendChild(r),t.parentNode.hasAttribute("ghost-table")||Xl(this.elements,(e=>t.appendChild(e.element))),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[BR(UR)];if(null!==e){const{visualIndex:n}=e;t=function(e){const t=[];let n=e;return bE[n]||(n=yE),Xl(bE[n],(e=>{let n;n=e===pb?{name:pb}:ac(BR(e)),t.push(n)})),t}(this.hot.getDataType(0,n,this.hot.countRows(),n))}Xl(this.getInputElements(),(e=>e.hide())),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}onConditionSelect(e){Xl(this.getInputElements(),((t,n)=>{t[e.inputsCount>n?"show":"hide"](),0===n&&setTimeout((()=>t.focus()),10)})),this.runLocalHooks("change",e)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(e){Wc(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),jc(e)):Wc(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),jc(e))}};const DE=new WeakMap;class NE extends TE{static get DEFAULTS(){return ac({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,sc(NE.DEFAULTS,t)),DE.set(this,{})}build(){super.build();const e=DE.get(this);e.input=this._element.firstChild;const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=DE.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}isChecked(){return this.options.checked}setChecked(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=e,this.update()}focus(){this.isBuilt()&&DE.get(this).input.focus()}}var PE=NE;var LE=class extends LR{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Pa(t.parentNode,"htFiltersMenuOperators"),t.parentNode.hasAttribute("ghost-table")||Xl(this.elements,(e=>t.appendChild(e.element))),t)}}buildOperatorsElement(){const e=[mE,pE];Xl(e,(t=>{const n=new PE(this.hot,{name:"operator",label:{htmlFor:t,textContent:gE(t)},value:t,checked:t===e[0],id:t});n.addLocalHook("change",(e=>this.onRadioInputChange(e))),this.elements.push(n)}))}setChecked(e){if(this.elements.length<e)throw Error(na`Radio button with index ${e} doesn't exist.`);Xl(this.elements,((t,n)=>{t.setChecked(n===e)}))}getActiveOperationId(){const e=this.elements.find((e=>e instanceof PE&&e.isChecked()));return e?e.getValue():mE}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Xl(this.elements,(t=>{t.setChecked(t.getValue()===e)}))}updateState(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mE;t===wE&&(t=pE),this.state.setValueAtIndex(e,t)}reset(){this.setChecked(0)}onRadioInputChange(e){this.setState(e.target.value)}};const VE=new WeakMap;class FE extends TE{static get DEFAULTS(){return ac({href:"#",tagName:"a"})}constructor(e,t){super(e,sc(FE.DEFAULTS,t)),VE.set(this,{})}build(){super.build();VE.get(this).link=this._element.firstChild}update(){this.isBuilt()&&(VE.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}var BE=FE;const WE=new WeakMap;class UE extends TE{static get DEFAULTS(){return ac({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,sc(UE.DEFAULTS,t)),WE.set(this,{}),this.searchInput=new AE(this.hot,{placeholder:yw,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new BE(this.hot,{textContent:mw,className:"htUISelectAll"}),this.clearAllUI=new BE(this.hot,{textContent:pw,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",(e=>this.onInputKeyDown(e))),this.searchInput.addLocalHook("input",(e=>this.onInput(e))),this.selectAllUI.addLocalHook("click",(e=>this.onSelectAllClick(e))),this.clearAllUI.addLocalHook("click",(e=>this.onClearAllClick(e)))}setItems(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(e){this.locale=e}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){return function(e){const t=[];return Xl(e,(e=>{e.checked&&t.push(e.value)})),t}(this.items)}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),n=new TE(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(n.element),this._element.appendChild(t);const o=t=>{if(!this._element)return;this.itemsBox&&this.itemsBox.destroy(),Pa(t,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(t,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(e,t,n,o,i,s)=>{e.title=s.instance.getDataAtRowProp(t,s.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-hh(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init();this.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:e=>{this.runLocalHooks("keydown",e,this)},group:"multipleSelect.itemBox"})};o(t),setTimeout((()=>o(t)),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){this.isBuilt()&&(this.itemsBox.loadData(function(e,t){const n=lE(t);return ql(e,(e=>(e.checked=n(e.value),e)))}(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let n;n=""===t?[...this.items]:Kl(this.items,(e=>`${e.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0)),this.itemsBox.loadData(n)}onInputKeyDown(e){this.runLocalHooks("keydown",e,this);Rh(Wc,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(jc(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(e){const t=[];e.preventDefault(),Xl(this.itemsBox.getSourceData(),((e,n)=>{e.checked=!0,t.push(nm(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}onClearAllClick(e){const t=[];e.preventDefault(),Xl(this.itemsBox.getSourceData(),((e,n)=>{e.checked=!1,t.push(nm(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}}var jE=UE;var zE=class extends LR{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.elements.push(new jE(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(e=>this.onInputKeyDown(e)))}setState(e){if(this.reset(),e&&e.command.key===uE){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?UR:uE},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(t,n,o,i,s)=>{const[r]=Kl(n,(e=>e.name===uE)),l={},a=this.hot.getTranslatedPhrase(fw);if(r){const n=hE(ql(i(t,s),(e=>e.value)));o&&(r.args[0]=o);const h=[],c=cE(n,r.args[0],a,(e=>{e.checked&&h.push(e.value)})),u=e.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,u).locale,l.args=[h],l.command=BR(uE),l.itemsSnapshot=c}else l.args=[],l.command=BR(UR);this.state.setValueAtIndex(t,l)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((e=>e instanceof jE))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,o,i,s)=>{Pa(t.parentNode,"htFiltersMenuValue");const r=this.hot.rootDocument.createElement("div");return Pa(r,"htFiltersMenuLabel"),r.textContent=s,t.appendChild(r),t.parentNode.hasAttribute("ghost-table")||Xl(this.elements,(e=>t.appendChild(e.element))),t}}}reset(){const e=this.hot.getTranslatedPhrase(fw),t=hE(this._getColumnVisibleValues()),n=cE(t,t,e);this.getMultipleSelectElement().setItems(n),super.reset(),this.getMultipleSelectElement().setValue(t);const o=this.hot.getPlugin("filters").getSelectedColumn();null!==o&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}onInputKeyDown(e){Wc(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),jc(e))}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:ql(this.hot.getDataAtCol(e.visualIndex),(e=>aE(e)))}};class YE extends LR{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),this.name=t.name,this.elements.push(new AE(this.hot,{type:"button",value:ww,className:"htUIButton htUIButtonOK",identifier:YE.BUTTON_OK})),this.elements.push(new AE(this.hot,{type:"button",value:Cw,className:"htUIButton htUIButtonCancel",identifier:YE.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Xl(this.elements,(e=>{e.addLocalHook("click",((e,t)=>this.onButtonClick(e,t)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Pa(t.parentNode,"htFiltersMenuActionBar"),t.parentNode.hasAttribute("ghost-table")||Xl(this.elements,(e=>t.appendChild(e.element))),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(e,t){t.options.identifier===YE.BUTTON_OK?this.accept():this.cancel()}}var $E=YE;const GE="ConditionCollection.filteringStates";class KE{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.hot=e,this.isMapRegistrable=t,this.filteringStates=new vm,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(GE,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var n;const o=this.filteringStates.getValueAtIndex(t),i=null!==(n=null==o?void 0:o.conditions)&&void 0!==n?n:[],s=null==o?void 0:o.operation;return this.isMatchInConditions(i,e,s)}isMatchInConditions(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mE;return!e.length||function(e){if(!dE[e])throw Error(`Operation with id "${e}" does not exist.`);const t=dE[e].func;return function(e,n){return t(e,n)}}(n)(e,t)}addCondition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mE,o=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale,s=ql(t.args,(e=>"string"==typeof e?e.toLocaleLowerCase(i):e)),r=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==n)throw Error(na`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(sa(dE[n]))throw new Error(na`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const a=this.getConditions(e);0===a.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:r,args:s,func:FR(r,s)}]},o):a.push({name:r,args:s,func:FR(r,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}getOperation(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((e=>{let[t]=e;return t}))}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Gl(this.filteringStates.getEntries(),((e,t)=>{let[n,{operation:o,conditions:i}]=t;return e.push({column:n,operation:o,conditions:ql(i,(e=>{let{name:t,args:n}=e;return{name:t,args:n}}))}),e}),[])}importAllConditions(e){this.clean(),Xl(e,(e=>{Xl(e.conditions,(t=>this.addCondition(e.column,t)))}))}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const n=this.getConditions(e);return t?n.some((e=>e.name===t)):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(GE),this.filteringStates=null,this.clearLocalHooks()}}hc(KE,hm);var qE=KE;var XE=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return Xl(this.conditionCollection.getFilteredColumns(),((t,n)=>{let o=this.columnDataFactory(t);n&&(o=this._getIntersectData(o,e)),e=this.filterByColumn(t,o)})),e}filterByColumn(e){const t=[];return Xl(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],(n=>{void 0!==n&&this.conditionCollection.isMatch(n,e)&&t.push(n)})),t}_getIntersectData(e,t){const n=[];return Xl(t,(t=>{const o=t.meta.visualRow;void 0!==e[o]&&(n[o]=e[o])})),n}};class ZE{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];this.hot=e,this.conditionCollection=t,this.columnDataFactory=n,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(e=>this._onConditionBeforeModify(e))),this.conditionCollection.addLocalHook("afterRemove",(e=>this.updateStatesAtColumn(e))),this.conditionCollection.addLocalHook("afterAdd",(e=>this.updateStatesAtColumn(e))),this.conditionCollection.addLocalHook("beforeClean",(()=>this._onConditionBeforeClean())),this.conditionCollection.addLocalHook("afterClean",(()=>this._onConditionAfterClean()))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Xl(this.changes,(e=>{this.updateStatesAtColumn(e)})),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(e,t){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(e)&&this.changes.push(e));const o=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(e);-1===i&&(i=this.latestEditedColumnPosition);const s=o.slice(0,i),r=o.slice(i);r.length&&r[0].column===e&&r.shift();const l=Eh((function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new qE(n.hot,!1),s=[].concat(e,o);i.importAllConditions(s);const r=n.columnDataFactory(t);let l;l=i.isEmpty()?r:new XE(i,(e=>n.columnDataFactory(e))).filter(),l=ql(l,(e=>e.meta.visualRow));const a=lE(l);return i.destroy(),Kl(r,(e=>a(e.meta.visualRow)))}))(s),a=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:a},dependentConditionStacks:r,filteredRowsFactory:l,conditionArgsChange:t})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){Xl(this.latestOrderStack,(e=>{this.updateStatesAtColumn(e)}))}destroy(){this.clearLocalHooks(),gc(this,((e,t)=>{this[t]=null}))}}hc(ZE,hm);var JE=ZE;const QE="filters";class eM extends ov{static get PLUGIN_KEY(){return QE}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),this.eventManager=new pu(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",((e,t)=>this.onAfterGetColHeader(e,t)))}isEnabled(){return!!this.hot.getSettings()[QE]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new bm),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,n=e=>(e.addLocalHook("accept",(()=>this.onActionBarSubmit("accept"))),e.addLocalHook("cancel",(()=>this.onActionBarSubmit("cancel"))),e.addLocalHook("change",(t=>this.onComponentChange(e,t))),e),o=()=>`${this.hot.getTranslatedPhrase(cw)}:`,i=()=>`${this.hot.getTranslatedPhrase(uw)}:`;if(!this.components.get("filter_by_condition")){const e=new HE(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:t});e.addLocalHook("afterClose",(()=>this.onSelectUIClosed())),this.components.set("filter_by_condition",n(e))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new LE(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const e=new HE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});e.addLocalHook("afterClose",(()=>this.onSelectUIClosed())),this.components.set("filter_by_condition2",n(e))}this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new zE(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new $E(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new qE(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new JE(this.hot,this.conditionCollection,(e=>this.getDataMapAtColumn(e))),this.conditionUpdateObserver.addLocalHook("update",(e=>this.updateComponents(e)))),this.components.forEach((e=>e.show())),this.addHook("beforeDropdownMenuSetItems",(e=>this.onBeforeDropdownMenuSetItems(e))),this.addHook("afterDropdownMenuDefaultOptions",(e=>this.onAfterDropdownMenuDefaultOptions(e))),this.addHook("afterDropdownMenuShow",(()=>this.onAfterDropdownMenuShow())),this.addHook("afterDropdownMenuHide",(()=>this.onAfterDropdownMenuHide())),this.addHook("afterChange",(e=>this.onAfterChange(e))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),super.enablePlugin()}disablePlugin(){var e;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((e,t)=>{e.destroy(),this.components.set(t,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));super.disablePlugin()}addCondition(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:mE;const i=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(i,{command:{key:t},args:n},o)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(void 0===e)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const e=this._createDataFilter(),t=!this.conditionCollection.isEmpty();let n=[];const o=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",o))if(t){const t=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),n=ql(e.filter(),(e=>e.meta.visualRow));const o=lE(n);_u(this.hot.countSourceRows()-1,(e=>{o(e)||t.push(e)})),Xl(t,(e=>{this.filtersRowsMap.setValueAtIndex(e,!0)}))}),!0),n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}getSelectedColumn(){var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}clearColumnSelection(){const e=this.getSelectedColumn();null!==e&&this.hot.selectCell(0,e.visualIndex)}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),n=[];return Xl(this.hot.getSourceDataAtCol(t),((e,o)=>{var i;const{row:s,col:r,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d}=this.hot.getCellMeta(o,t),g=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(o),t))&&void 0!==i?i:e;n.push({meta:{row:s,col:r,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d},value:aE(g)})})),n}onAfterChange(e){e&&Xl(e,(e=>{const[,t]=e,n=this.hot.propToCol(t);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)}))}updateValueComponentCondition(e){const t=hE(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}restoreComponents(e){var t;const n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach((e=>{e.isHidden()||e.restoreState(n)})),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}onAfterDropdownMenuDefaultOptions(e){e.items.push({name:pb}),this.components.forEach((t=>{e.items.push(t.getMenuItemDescriptor())}))}getOperationBasedOnArguments(e,t,n,o){let i=e;return i===pE&&t.command.key!==UR&&n.command.key!==UR&&o.command.key!==UR?i=wE:o.command.key!==UR&&(t.command.key!==UR&&n.command.key!==UR||(i=mE)),i}onActionBarSubmit(e){var t;if("accept"===e){const e=this.getSelectedColumn();var n;if(null===e)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());const{physicalIndex:t}=e,o=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),s=this.components.get("filter_by_value").getState(),r=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,i,s);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(t);-1===l&&(l=void 0),this.conditionCollection.removeConditions(t),o.command.key!==UR&&(this.conditionCollection.addCondition(t,o,r,l),i.command.key!==UR&&this.conditionCollection.addCondition(t,i,r,l)),s.command.key!==UR&&this.conditionCollection.addCondition(t,s,r,l),this.conditionUpdateObserver.flush(),this.components.forEach((e=>e.saveState(t))),this.filtersRowsMap.clear(),this.filter()}null===(t=this.dropdownMenuPlugin)||void 0===t||t.close()}onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor!==HE||t.inputsCount||this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...n):this.hideComponents(...n)}onAfterGetColHeader(e,t){const n=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(n)?Pa(t,"htFiltersActive"):La(t,"htFiltersActive")}_createDataFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new XE(e,(e=>this.getDataMapAtColumn(e)))}updateComponents(e){var t;if(null===(t=this.dropdownMenuPlugin)||void 0===t||!t.enabled)return;const{editedConditionStack:{conditions:n,column:o}}=e,i=n.filter((e=>e.name===uE)),s=n.filter((e=>e.name!==uE));if(i.length>=2||s.length>=3)Kc(na`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const t=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(s[0],o),this.components.get("filter_by_condition2").updateState(s[1],o),this.components.get("filter_operators").updateState(t,o),this.components.get("filter_by_value").updateState(e)}}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Xl(o,(n=>{Xl(t.menuItems,((t,o)=>{t.key===n.getMenuItemDescriptor().key&&e.push(o)}))})),e}changeComponentsVisibility(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const t=this.dropdownMenuPlugin.menu.hotMenu,n=t.getPlugin("hiddenRows");for(var o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];const r=this.getIndexesOfComponents(...i);e?n.showRows(r):n.hideRows(r),t.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach(((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const tM="internal-use-in-handsontable",nM={licenseKey:tM,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function oM(e){var t;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[YM])||void 0===t||null===(t=t.language)||void 0===t?void 0:t.langCode}}function iM(e){return Object.keys(e).reduce(((t,n)=>("hyperformula"!==n&&(t[n]=e[n]),t)),{})}function sM(){const e="engine_relationship",t=iu(YM);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function rM(){const e="shared_engine_usage",t=iu(YM);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function lM(e){const t=e.getSettings(),n=t[YM],o=null==n?void 0:n.engine;if(!0===n)return null;if(sa(o))return null;var i;if("function"==typeof o.hyperformula||"function"==typeof o)return function(e,t,n){const o=t[YM],i=function(e){var t;const n=e[YM],o=iM(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),i=oM(e);return{...nM,...o,...i}}(t),s=sM(),r=rM();(function(e,t){t&&t.forEach((t=>{const{name:n,plugin:o,translations:i}=t;try{e.registerFunction(n,o,i)}catch(e){Kc(e.message)}}))})(e,o.functions),function(e,t){if(t){const{langCode:n}=t;try{e.registerLanguage(n,t)}catch(e){Kc(e.message)}}}(e,o.language);const l=e.buildEmpty(i);return s.set(l,[n]),r.set(l,[n.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach((t=>{const{name:n,expression:o,scope:i,options:s}=t;try{e.addNamedExpression(n,o,i,s)}catch(e){Kc(e.message)}})),e.resumeEvaluation())}(l,o.namedExpressions),l.on("sheetAdded",(()=>{l.rebuildAndRecalculate()})),l.on("sheetRemoved",(()=>{l.rebuildAndRecalculate()})),l}(null!==(i=o.hyperformula)&&void 0!==i?i:o,t,e);if("object"==typeof o&&sa(o.hyperformula)){const t=sM(),n=rM().get(o);return t.has(o)||t.set(o,[]),t.get(o).push(e),n&&n.push(e.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:tM}),o.getConfig().leapYear1900===nM.leapYear1900&&!1!==cc(o.getConfig().nullDate,nM.nullDate)||Kc(na`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),o}return null}function aM(e){var t;const n=sM(),o=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(o.map((e=>[e.getPlugin("formulas").sheetId,e])))}function hM(e,t){if(e){const n=sM(),o=n.get(e),i=rM(),s=i.get(e);o&&o.includes(t)&&(o.splice(o.indexOf(t),1),0===o.length&&n.delete(e)),s&&s.includes(t.guid)&&(s.splice(s.indexOf(t.guid),1),0===s.length&&(i.delete(e),e.destroy()))}}const cM="DD/MM/YYYY";function uM(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function dM(e,t){return"string"==typeof e&&"date"===t}function gM(e,t){return jl(e,t,!0).isValid()}function fM(e,t){return jl(e,t,!0).format(cM)}function mM(e,t){const n=new Date(Date.UTC(0,0,e+-1));return jl(n).format(t)}function pM(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function wM(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,yM(e,t,"get"))}function CM(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,yM(e,t,"set"),n),n}function yM(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var vM=new WeakMap,bM=new WeakMap,SM=new WeakMap,RM=new WeakMap,EM=new WeakMap,MM=new WeakMap,TM=new WeakMap;var xM=class{constructor(e,t,n){pM(this,vM,{writable:!0,value:void 0}),pM(this,bM,{writable:!0,value:void 0}),pM(this,SM,{writable:!0,value:void 0}),pM(this,RM,{writable:!0,value:[]}),pM(this,EM,{writable:!0,value:[]}),pM(this,MM,{writable:!0,value:void 0}),pM(this,TM,{writable:!0,value:[]}),CM(this,vM,e),CM(this,bM,t),CM(this,SM,n)}setRemovedHfIndexes(e){return CM(this,TM,e.map((e=>{const t=wM(this,bM).getVisualFromPhysicalIndex(e);return this.getHfIndexFromVisualIndex(t)}))),wM(this,TM)}getRemovedHfIndexes(){return wM(this,TM)}getHfIndexFromVisualIndex(e){const t=wM(this,bM).getIndexesSequence(),n=wM(this,bM).getNotTrimmedIndexes();return t.indexOf(n[e])}syncMoves(e){const t=`move${ya(wM(this,vM))}s`;wM(this,SM).getEngine().batch((()=>{e.forEach((e=>{const n=e.from!==e.to,o=e.from+1!==e.to;n&&o&&wM(this,SM).getEngine()[t](wM(this,SM).getSheetId(),e.from,1,e.to)}))}))}storeMovesInformation(e,t,n){!1!==n&&(CM(this,EM,e.map((e=>this.getHfIndexFromVisualIndex(e)))),CM(this,MM,this.getHfIndexFromVisualIndex(t)))}getMoveLine(e,t){const n=wM(this,bM).getNumberOfIndexes(),o=Array.from(Array(n).keys()).filter((t=>!1===e.includes(t)));var i;return 0===t?null!==(i=o[t])&&void 0!==i?i:0:o[t-1]+1}getInitiallyCalculatedMoves(e,t){let n=this.getMoveLine(e,t);const o=[];return e.forEach((e=>{const t={from:e,to:n};o.forEach((e=>{const n=e.from>e.to,o=e.to<=t.from;e.from>t.from&&o&&n&&(t.from+=1)})),t.from>=n&&(n+=1),o.push(t)})),o}adjustedCalculatedMoves(e){return e.forEach(((t,n)=>{e.slice(n+1).forEach((e=>{const n=e.from<e.to;e.from>t.from&&n&&(e.from-=1)}))})),e}calculateAndSyncMoves(e,t){if(wM(this,SM).isPerformingUndoRedo())return;if(!1===e||!1===t)return;const n=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(wM(this,EM),wM(this,MM)));null===wM(this,SM).getSheetId()?wM(this,SM).getPostponeAction((()=>this.syncMoves(n))):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${ya(wM(this,vM))}Order`;return t=>{if(wM(this,SM).isPerformingUndoRedo())return;const n=wM(this,bM).getIndexesSequence();if("update"===t){const t=wM(this,RM).map((e=>n.indexOf(e))),o=wM(this,SM).getEngine().getSheetDimensions(wM(this,SM).getSheetId());let i;i="row"===wM(this,vM)?o.height:o.width;for(let e=t.length;e<i;e+=1)t.push(e);wM(this,SM).getEngine()[e](wM(this,SM).getSheetId(),t)}CM(this,RM,n)}}init(){CM(this,RM,wM(this,bM).getIndexesSequence())}};function OM(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function AM(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,IM(e,t,"get"))}function _M(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,IM(e,t,"set"),n),n}function IM(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var kM=new WeakMap,HM=new WeakMap,DM=new WeakMap,NM=new WeakMap,PM=new WeakMap,LM=new WeakMap,VM=new WeakMap;var FM=class{constructor(e,t,n){OM(this,kM,{writable:!0,value:void 0}),OM(this,HM,{writable:!0,value:void 0}),OM(this,DM,{writable:!0,value:void 0}),OM(this,NM,{writable:!0,value:!1}),OM(this,PM,{writable:!0,value:!1}),OM(this,LM,{writable:!0,value:null}),OM(this,VM,{writable:!0,value:null}),_M(this,kM,new xM("row",e,this)),_M(this,HM,new xM("column",t,this)),_M(this,DM,n)}getForAxis(e){return AM(this,"row"===e?kM:HM)}setPerformUndo(e){_M(this,NM,e)}setPerformRedo(e){_M(this,PM,e)}isPerformingUndoRedo(){return AM(this,NM)||AM(this,PM)}getSheetId(){return AM(this,VM)}getEngine(){return AM(this,LM)}getPostponeAction(){return AM(this,DM)}setupSyncEndpoint(e,t){_M(this,LM,e),_M(this,VM,t),AM(this,kM).init(),AM(this,HM).init()}};function BM(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WM(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function UM(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,zM(e,t,"set"),n),n}function jM(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,zM(e,t,"get"))}function zM(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}const YM="formulas",$M=["maxRows","maxColumns","language"];nu.getSingleton().register("afterNamedExpressionAdded"),nu.getSingleton().register("afterNamedExpressionRemoved"),nu.getSingleton().register("afterSheetAdded"),nu.getSingleton().register("afterSheetRemoved"),nu.getSingleton().register("afterSheetRenamed"),nu.getSingleton().register("afterFormulasValuesUpdate");const GM=e=>"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;var KM=new WeakMap,qM=new WeakMap,XM=new WeakMap;class ZM extends ov{constructor(){var e;super(...arguments),e=this,WM(this,KM,{writable:!0,value:!1}),WM(this,qM,{writable:!0,value:!1}),WM(this,XM,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),BM(this,"staticRegister",iu("formulas")),BM(this,"engine",null),BM(this,"sheetName",null),BM(this,"indexSyncer",null),BM(this,"rowAxisSyncer",null),BM(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return YM}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[YM,...$M]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[YM]}enablePlugin(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=lM(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const e=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==e&&(this.sheetName=e)}this.addHook("beforeLoadData",(function(){return t.onBeforeLoadData(...arguments)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("beforeUpdateData",(function(){return t.onBeforeLoadData(...arguments)})),this.addHook("afterUpdateData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("modifyData",(function(){return t.onModifyData(...arguments)})),this.addHook("modifySourceData",(function(){return t.onModifySourceData(...arguments)})),this.addHook("beforeValidate",(function(){return t.onBeforeValidate(...arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return t.onAfterSetSourceDataAtCell(...arguments)})),this.addHook("afterSetDataAtCell",(function(){return t.onAfterSetDataAtCell(...arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return t.onAfterSetDataAtCell(...arguments)})),this.addHook("beforeCreateRow",(function(){return t.onBeforeCreateRow(...arguments)})),this.addHook("beforeCreateCol",(function(){return t.onBeforeCreateCol(...arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow(...arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol(...arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow(...arguments)})),this.addHook("beforeRemoveCol",(function(){return t.onBeforeRemoveCol(...arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow(...arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol(...arguments)})),this.indexSyncer=new FM(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(e=>{this.hot.addHookOnce("init",(()=>{e()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((e,t,n,o)=>{this.rowAxisSyncer.storeMovesInformation(e,t,o)})),this.hot.addHook("beforeColumnMove",((e,t,n,o)=>{this.columnAxisSyncer.storeMovesInformation(e,t,o)})),this.hot.addHook("afterRowMove",((e,t,n,o,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("afterColumnMove",((e,t,n,o,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("beforeColumnFreeze",((e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart,t)})),this.hot.addHook("afterColumnFreeze",((e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)})),this.hot.addHook("beforeColumnUnfreeze",((e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart-1,t)})),this.hot.addHook("afterColumnUnfreeze",((e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)})),this.addHook("afterCellMetaReset",(function(){return t.onAfterCellMetaReset(...arguments)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild(...arguments)})),this.addHook("beforeAutofill",(function(){return t.onBeforeAutofill(...arguments)})),jM(this,XM).forEach((e=>{let[t,n]=e;return this.engine.on(t,n)})),super.enablePlugin()}else Kc("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){jM(this,XM).forEach((e=>{let[t,n]=e;return this.engine.off(t,n)})),hM(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=function(e){var t;const n=e[YM];return{...iM(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),...oM(e)}}(this.hot.getSettings());(function(e,t){return Object.keys(t).some((n=>void 0!==t[n]&&t[n]!==e[n]))})(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const n=this.hot.getSettings()[YM];if(ia(n)&&ia(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&null===this.sheetName){const e=this.hot.getSettings()[YM].sheetName;e&&this.engine.doesSheetExist(e)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=e?e:void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){jM(this,XM).forEach((e=>{var t;let[n,o]=e;return null===(t=this.engine)||void 0===t?void 0:t.off(n,o)})),UM(this,XM,null),hM(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(ia(t)&&!im(t))return Kc("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return Kc("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(e){return Kc(e.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e))return void qc(`The sheet named \`${e}\` does not exist, switch aborted.`);this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${ya(YM)}.switchSheet`)}getCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==o&&null!==i?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Set;e.forEach((e=>{var t;const o=null==e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==o&&(n.has(o)||n.add(o))})),aM(this.engine).forEach(((e,o)=>{var i;(t||o!==this.sheetId)&&n.has(o)&&(e.render(),null===(i=e.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(e){const t=e=>{var t;const{row:n,col:o,sheet:i}=null!==(t=null==e?void 0:e.address)&&void 0!==t?t:{};return ia(i)?`${i}:${n}x${o}`:""},n=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((e=>t(e))));e.forEach((e=>{var o,i;const{row:s,col:r}=null!==(o=e.address)&&void 0!==o?o:{};if(!1===ia(s)||!1===ia(r)||s>=this.hot.countRows()||r>=this.hot.countCols())return;const l=null==e||null===(i=e.address)||void 0===i?void 0:i.sheet,a=t(e);if(void 0!==l&&!n.has(a)){const e=aM(this.engine).get(l);if(!e)return;e.validateCell(e.getDataAtCell(s,r),e.getCellMeta(s,r),(()=>{}))}}))}syncChangeWithEngine(e,t,n){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o))return void Kc(`Not possible to set cell data at ${JSON.stringify(o)}`);const i=this.hot.getCellMeta(e,t);var s;return dM(n,i.type)&&(gM(n,i.dateFormat)?n=fM(n,i.dateFormat):!1===("string"==typeof(s=n)&&s.startsWith("="))&&(n=`'${n}`)),this.engine.setCellContents(o,n)}onBeforeValidate(e,t,n){const o=this.hot.propToCol(n);if(this.isFormulaCellType(t,o)){const e={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},n=this.hot.getCellMeta(t,o);let i=this.engine.getCellValue(e);return"date"===n.type&&Ou(i)&&(i=mM(i,n.dateFormat)),"object"==typeof i&&null!==i?i.value:i}return e}onBeforeAutofill(e,t,n){const{row:o,col:i}=t.getTopStartCorner(),{row:s,col:r}=t.getBottomEndCorner(),{row:l,col:a}=n.getTopStartCorner(),{row:h,col:c}=n.getBottomEndCorner(),u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const g=this.engine.getFillRangeData(u,d),{row:f,col:m}=u.start,{row:p,col:w}=u.end,C=p-f+1,y=w-m+1;for(let e=0;e<g.length;e+=1)for(let t=0;t<g[e].length;t+=1){const n=g[e][t],o=e%C,i=t%y,s=this.hot.getCellMeta(o,i);dM(n,s.type)&&(n.startsWith("'")?g[e][t]=n.slice(1):!1===this.isFormulaCellType(o,i,this.sheetId)&&(g[e][t]=(v=n,b=s.dateFormat,jl(v,cM,!0).format(b))))}var v,b;return g}onBeforeLoadData(e,t){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(ya(YM))||UM(this,qM,sa(this.hot.getSettings().data))}onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach(((n,o)=>{n.forEach(((n,i)=>{const s=this.hot.getCellMeta(o,i),r=s.dateFormat;dM(n,s.type)&&(t=!0,gM(n,r)?e[o][i]=fM(n,r):!1===this.isFormulaCellType(o,i)&&(e[o][i]=`'${n}`))}))})),!0===t&&(UM(this,KM,!0),this.engine.setSheetContent(this.sheetId,e),UM(this,KM,!1))}onAfterLoadData(e,t){var n,o;if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(ya(YM)))if(this.sheetName=(n=this.engine,!sa(o=this.hot.getSettings()[YM].sheetName)&&n.doesSheetExist(o)||(o=n.addSheet(o)),o),jM(this,qM))this.switchSheet(this.sheetName);else{const e=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,e)){UM(this,KM,!0);const t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),UM(this,KM,!1)}}}onModifyData(e,t,n,o){if("get"!==o||jM(this,KM)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e);if(null===i||null===t)return;if(!this.isFormulaCellType(i,t)){if("ARRAY"!==this.getCellType(i,t))return void(uM(n.value)&&(n.value=uM(s=n.value)?s.substr(1):s))}var s;const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let l=this.engine.getCellValue(r);const a=this.hot.getCellMeta(i,t);"date"===a.type&&Ou(l)&&(l=mM(l,a.dateFormat));const h="object"==typeof l&&null!==l?l.value:l;n.value=h}onModifySourceData(e,t,n,o){if("get"!==o||jM(this,KM)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e),s=this.hot.propToCol(t);if(null===i||null===s)return;if(!this.isFormulaCellType(i,s)){if("ARRAY"!==this.getCellType(i,s))return}const r=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===r.width&&0===r.height)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}onAfterSetDataAtCell(e,t){if(GM(t))return;const n=[],o=[],i=this.engine.batch((()=>{e.forEach((e=>{let[t,i,,s]=e;const r=this.hot.propToCol(i),l=this.hot.toPhysicalRow(t),a=this.hot.toPhysicalColumn(r),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(t,r,s):n.push([t,r,s]),o.push({address:h})}))}));n.length&&this.hot.addHookOnce("afterChange",(()=>{const e=this.engine.batch((()=>{n.forEach((e=>{let[t,n,o]=e;this.syncChangeWithEngine(t,n,o)}))}));this.renderDependentSheets(e,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,o)}onAfterSetSourceDataAtCell(e,t){if(GM(t))return;const n=[],o=[];e.forEach((e=>{let[t,i,,s]=e;const r=this.hot.propToCol(i);if(!Ou(r))return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(l)?(o.push({address:l}),n.push(...this.engine.setCellContents(l,s))):Kc(`Not possible to set source cell data at ${JSON.stringify(l)}`)})),this.renderDependentSheets(n),this.validateDependentCells(n,o)}onBeforeCreateRow(e,t){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,t]))return!1}onBeforeCreateCol(e,t){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,t]))return!1}onBeforeRemoveRow(e,t,n){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(n).every((e=>this.engine.isItPossibleToRemoveRows(this.sheetId,[e,1])))&&void 0}onBeforeRemoveCol(e,t,n){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(n).every((e=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[e,1])))&&void 0}onAfterCreateRow(e,t,n){if(GM(n))return;const o=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(o)}onAfterCreateCol(e,t,n){if(GM(n))return;const o=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(o)}onAfterRemoveRow(e,t,n,o){if(GM(o))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),s=this.engine.batch((()=>{i.forEach((e=>{this.engine.removeRows(this.sheetId,[e,1])}))}));this.renderDependentSheets(s)}onAfterRemoveCol(e,t,n,o){if(GM(o))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),s=this.engine.batch((()=>{i.forEach((e=>{this.engine.removeColumns(this.sheetId,[e,1])}))}));this.renderDependentSheets(s)}onAfterDetachChild(e,t,n){var o;UM(this,KM,!0);const i=this.hot.getSourceDataArray(n,0,n+((null===(o=t.__children)||void 0===o?void 0:o.length)||0),this.hot.countSourceCols());UM(this,KM,!1),i.forEach(((e,t)=>{e.forEach(((e,o)=>{this.engine.setCellContents({col:o,row:n+t,sheet:this.sheetId},[[e]])}))}))}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}function JM(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function QM(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,tT(e,t,"get"))}function eT(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,tT(e,t,"set"),n),n}function tT(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}nu.getSingleton().register("beforeHideColumns"),nu.getSingleton().register("afterHideColumns"),nu.getSingleton().register("beforeUnhideColumns"),nu.getSingleton().register("afterUnhideColumns");const nT="hiddenColumns";var oT=new WeakMap,iT=new WeakMap;class sT extends ov{constructor(){super(...arguments),JM(this,oT,{writable:!0,value:{}}),JM(this,iT,{writable:!0,value:null})}static get PLUGIN_KEY(){return nT}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[nT]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[nT];uc(t)&&(eT(this,oT,t),sa(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),eT(this,iT,new fm),QM(this,iT).addLocalHook("init",(()=>this.onMapInit())),this.hot.columnIndexMapper.registerMap(this.pluginName,QM(this,iT)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions(...arguments)})),this.addHook("afterGetCellMeta",((e,t,n)=>this.onAfterGetCellMeta(e,t,n))),this.addHook("modifyColWidth",((e,t)=>this.onModifyColWidth(e,t))),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader(...arguments)})),this.addHook("modifyCopyableRange",(e=>this.onModifyCopyableRange(e))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),eT(this,oT,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let o=t;const i=QM(this,iT).getValues().slice(),s=e.length>0;if(n&&s){Xl(e.map((e=>this.hot.toPhysicalColumn(e))),(e=>{i[e]=!1})),o=Gl(i,((e,t,n)=>(t&&e.push(this.hot.toVisualColumn(n)),e)),[])}!1!==this.hot.runHooks("beforeUnhideColumns",t,o,n&&s)&&(n&&s&&QM(this,iT).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,o,n&&s,n&&o.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let o=t;n&&(o=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideColumns",t,o,n)&&(n&&this.hot.batchExecution((()=>{Xl(e,(e=>{QM(this,iT).setValueAtIndex(this.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",t,o,n,n&&o.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}getHiddenColumns(){return ql(QM(this,iT).getHiddenIndexes(),(e=>this.hot.toVisualColumn(e)))}isHidden(e){return QM(this,iT).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}resetCellsMeta(){Xl(this.hot.getCellsMeta(),(e=>{e&&(e.skipColumnOnPaste=!1)}))}onModifyColWidth(e,t){return this.isHidden(t)?0:QM(this,oT).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}onAfterGetCellMeta(e,t,n){if(!1===QM(this,oT).copyPasteEnabled&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenColumn");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}onModifyCopyableRange(e){if(QM(this,oT).copyPasteEnabled)return e;const t=[],n=(e,n,o,i)=>{t.push({startRow:e,endRow:n,startCol:o,endCol:i})};return Xl(e,(e=>{let t=!0,o=0;_u(e.startCol,e.endCol,(i=>{this.isHidden(i)?(t||n(e.startRow,e.endRow,o,i-1),t=!0):(t&&(o=i),i===e.endCol&&n(e.startRow,e.endRow,o,i),t=!1)}))})),t}onAfterGetColHeader(e,t){if(!QM(this,oT).indicators||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),Pa(t,n)}onAfterContextMenuDefaultOptions(e){var t;e.items.push({name:pb},(t=this,{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,n,,o]=e;n-o!=0&&(t=1)}return this.getTranslatedPhrase(Lp,t)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),o=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),s=[];for(let e=o;e<=i;e+=1)s.push(e);t.hideColumns(s);const r=s[s.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_columns_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(Vp,e)},callback(){var n,o;if(0===t.length)return;let i=t[0],s=t[t.length-1];i=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,s=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))&&void 0!==o?o:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const n=ql(e.getHiddenColumns(),(e=>this.toPhysicalColumn(e)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,s=o.getBottomEndCorner().col,r=this.columnIndexMapper,l=r.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(s),h=r.getNotTrimmedIndexes(),c=[];if(i!==s){if(s-i+1>a-l+1){const e=h.slice(i,s+1);c.push(...e.filter((e=>n.includes(e))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countCols()));else{const e=this.countCols()-1;a===r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(e,-1))&&e>s&&c.push(...h.slice(s+1))}return Xl(c,(e=>{t.push(this.toVisualColumn(e))})),0===t.length}}}(this))}onMapInit(){Array.isArray(QM(this,oT).columns)&&this.hideColumns(QM(this,oT).columns)}destroy(){eT(this,oT,null),eT(this,iT,null),super.destroy()}}function rT(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function lT(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,hT(e,t,"get"))}function aT(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,hT(e,t,"set"),n),n}function hT(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}nu.getSingleton().register("beforeHideRows"),nu.getSingleton().register("afterHideRows"),nu.getSingleton().register("beforeUnhideRows"),nu.getSingleton().register("afterUnhideRows");const cT="hiddenRows";var uT=new WeakMap,dT=new WeakMap;class gT extends ov{constructor(){super(...arguments),rT(this,uT,{writable:!0,value:{}}),rT(this,dT,{writable:!0,value:null})}static get PLUGIN_KEY(){return cT}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[cT]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[cT];uc(t)&&(aT(this,uT,t),sa(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),aT(this,dT,new fm),lT(this,dT).addLocalHook("init",(()=>this.onMapInit())),this.hot.rowIndexMapper.registerMap(this.pluginName,lT(this,dT)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions(...arguments)})),this.addHook("afterGetCellMeta",((e,t,n)=>this.onAfterGetCellMeta(e,t,n))),this.addHook("modifyRowHeight",((e,t)=>this.onModifyRowHeight(e,t))),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader(...arguments)})),this.addHook("modifyCopyableRange",(e=>this.onModifyCopyableRange(e))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),aT(this,uT,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let o=t;const i=lT(this,dT).getValues().slice(),s=e.length>0;if(n&&s){Xl(e.map((e=>this.hot.toPhysicalRow(e))),(e=>{i[e]=!1})),o=Gl(i,((e,t,n)=>(t&&e.push(this.hot.toVisualRow(n)),e)),[])}!1!==this.hot.runHooks("beforeUnhideRows",t,o,n&&s)&&(n&&s&&lT(this,dT).setValues(i),this.hot.runHooks("afterUnhideRows",t,o,n&&s,n&&o.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let o=t;n&&(o=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideRows",t,o,n)&&(n&&this.hot.batchExecution((()=>{Xl(e,(e=>{lT(this,dT).setValueAtIndex(this.hot.toPhysicalRow(e),!0)}))}),!0),this.hot.runHooks("afterHideRows",t,o,n,n&&o.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}getHiddenRows(){return ql(lT(this,dT).getHiddenIndexes(),(e=>this.hot.toVisualRow(e)))}isHidden(e){return lT(this,dT).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}resetCellsMeta(){Xl(this.hot.getCellsMeta(),(e=>{e&&(e.skipRowOnPaste=!1)}))}onModifyRowHeight(e,t){return this.isHidden(t)?0:e}onAfterGetCellMeta(e,t,n){if(!1===lT(this,uT).copyPasteEnabled&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenRow");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}onModifyCopyableRange(e){if(lT(this,uT).copyPasteEnabled)return e;const t=[],n=(e,n,o,i)=>{t.push({startRow:e,endRow:n,startCol:o,endCol:i})};return Xl(e,(e=>{let t=!0,o=0;_u(e.startRow,e.endRow,(i=>{this.isHidden(i)?(t||n(o,i-1,e.startCol,e.endCol),t=!0):(t&&(o=i),i===e.endRow&&n(o,i,e.startCol,e.endCol),t=!1)}))})),t}onAfterGetRowHeader(e,t){if(!lT(this,uT).indicators||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),Pa(t,n)}onAfterContextMenuDefaultOptions(e){var t;e.items.push({name:pb},(t=this,{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[n,,o]=e;n-o!=0&&(t=1)}return this.getTranslatedPhrase(Fp,t)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),o=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),s=[];for(let e=o;e<=i;e+=1)s.push(e);t.hideRows(s);const r=s[s.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_rows_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(Bp,e)},callback(){var n,o;if(0===t.length)return;let i=t[0],s=t[t.length-1];i=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,s=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))&&void 0!==o?o:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const n=ql(e.getHiddenRows(),(e=>this.toPhysicalRow(e)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,s=o.getBottomEndCorner().row,r=this.rowIndexMapper,l=r.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(s),h=r.getNotTrimmedIndexes(),c=[];if(i!==s){if(s-i+1>a-l+1){const e=h.slice(i,s+1);c.push(...e.filter((e=>n.includes(e))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countRows()));else{const e=this.countRows()-1;a===r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(e,-1))&&e>s&&c.push(...h.slice(s+1))}return Xl(c,(e=>{t.push(this.toVisualRow(e))})),0===t.length}}}(this))}onMapInit(){Array.isArray(lT(this,uT).rows)&&this.hideRows(lT(this,uT).rows)}destroy(){aT(this,uT,null),aT(this,dT,null),super.destroy()}}nu.getSingleton().register("beforeColumnFreeze"),nu.getSingleton().register("afterColumnFreeze"),nu.getSingleton().register("beforeColumnUnfreeze"),nu.getSingleton().register("afterColumnUnfreeze");const fT="manualColumnFreeze",mT=new WeakMap;class pT extends ov{static get PLUGIN_KEY(){return fT}static get PLUGIN_PRIORITY(){return 110}constructor(e){super(e),mT.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[fT]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(e=>this.addContextMenuEntry(e))),this.addHook("beforeColumnMove",((e,t)=>this.onBeforeColumnMove(e,t))),super.enablePlugin())}disablePlugin(){mT.get(this).afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=mT.get(this),n=this.hot.getSettings(),o=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0);!1!==this.hot.runHooks("beforeColumnFreeze",e,o)&&(o&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,o))}unfreezeColumn(e){const t=mT.get(this),n=this.hot.getSettings(),o=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0);!1!==this.hot.runHooks("beforeColumnUnfreeze",e,o)&&(o&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,o))}addContextMenuEntry(e){var t;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(gp)},callback(e,n){const[{start:{col:o}}]=n;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}),function(e){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(fp)},callback(t,n){const[{start:{col:o}}]=n;e.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}(this))}onBeforeColumnMove(e,t){if(mT.get(this).afterFirstUse){const n=this.hot.getSettings().fixedColumnsStart;if(t<n)return!1;if(e.some((e=>e<n)))return!1}}}const wT="px";var CT=class{constructor(e){this.hot=e,this._element=null,this.state=0,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){Ou(e)&&(this._element.style.top=e+wT),Ou(t)&&(this._element.style[this.inlineProperty]=t+wT)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Ou(e)&&(this._element.style.width=e+wT),Ou(t)&&(this._element.style.height=t+wT)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Ou(e)&&(this._element.style.marginTop=e+wT),Ou(t)&&(this._element.style[`margin${ya(this.inlineProperty)}`]=t+wT)}getOffset(){const e=this._element.style,t=`margin${ya(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};var yT=class extends CT{build(){super.build(),Pa(this._element,"ht__manualColumnMove--backlight")}};var vT=class extends CT{build(){super.build(),Pa(this._element,"ht__manualColumnMove--guideline")}};nu.getSingleton().register("beforeColumnMove"),nu.getSingleton().register("afterColumnMove");const bT="manualColumnMove",ST=new WeakMap,RT="ht__manualColumnMove",ET="show-ui",MT="on-moving--columns",TT="after-selection--columns";class xT extends ov{static get PLUGIN_KEY(){return bT}static get PLUGIN_PRIORITY(){return 120}constructor(e){super(e),ST.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new pu(this),this.backlight=new yT(e),this.guideline=new vT(e)}isEnabled(){return!!this.hot.getSettings()[bT]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown(...arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver(...arguments)})),this.addHook("afterScrollVertically",(()=>this.onAfterScrollVertically())),this.addHook("afterLoadData",(function(){return e.onAfterLoadData(...arguments)})),this.buildPluginUI(),this.registerEvents(),Pa(this.hot.rootElement,RT),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){La(this.hot.rootElement,RT),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const n=ST.get(this),o=n.cachedDropIndex,i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeColumnMove",e,t,o,i);if(n.cachedDropIndex=void 0,!1===s)return;i&&this.hot.columnIndexMapper.moveIndexes(e,t);const r=i&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,o,i,r),r}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const n=this.countFinalIndex(e,t);return ST.get(this).cachedDropIndex=t,this.moveColumns(e,n)}isMovePossible(e,t){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>n,i=t<0,s=e.some((e=>e<0)),r=e.some((e=>e>=n));return!(o||i||s||r)}isColumnOrderChanged(e,t){return e.some(((e,n)=>e-n!==t))}countFinalIndex(e,t){const n=Gl(e,((e,n)=>(n<t&&(e+=1),e)),0);return t-n}getColumnsWidth(e,t){const n=this.hot.columnIndexMapper;let o=0;for(let i=e;i<=t;i+=1){const e=n.getRenderableFromVisualIndex(i);i<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==e&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(e)||0)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[bT];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const n=[];return _u(e,t,(e=>{n.push(e)})),n}refreshPositions(){const e=ST.get(this),t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&t>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1));const n=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,i="number"==typeof o.scrollX?o.scrollX:o.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1);const r=n.hider.offsetWidth,l=n.TBODY.offsetLeft,a=this.backlight.getOffset().start,h=this.backlight.getSize().width;let c=0,u=0;if(this.hot.isRtl()){const t=this.hot.rootWindow,n=Qa(this.hot.rootElement),s=t.innerWidth-e.rootElementOffset-n;u=t.innerWidth-e.target.eventPageX-s-(void 0===o.scrollX?i:0)}else u=e.target.eventPageX-(e.rootElementOffset-(void 0===o.scrollX?i:0));if(e.hasRowHeaders&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(s+=i),s+=c,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+s<=u){const t=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=t+1,s+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;let d=u,g=s;u+h+a>=r?d=r-h-a:u+a<l+c&&(d=l+c+Math.abs(a)),s>=r-1?g=r-1:0===g?g=1:void 0!==o.scrollX&&e.hoveredColumn<e.fixedColumnsStart&&(g-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,d),this.guideline.setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",(e=>this.onMouseMove(e))),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp()))}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,n,o){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),r=this.hot.getSelectedRangeLast(),l=ST.get(this),a=Na(e.target,"sortAction");if(!r||!s||l.pressed||0!==e.button||a)return l.pressed=!1,l.columnsToMove.length=0,void La(this.hot.rootElement,[MT,ET]);const h=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&c&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:u,to:d}=r,g=Math.min(u.col,d.col),f=Math.max(u.col,d.col);if(t.row<0&&t.col>=g&&t.col<=f){o.column=!0,l.pressed=!0,l.target.eventPageX=e.pageX,l.target.eventOffsetX=e.offsetX,l.hoveredColumn=t.col,l.target.TD=n,l.target.col=t.col,l.columnsToMove=this.prepareColumnsToMoving(g,f),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=za(this.hot.rootElement).left;const s=l.hasRowHeaders?-1:0,r=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,a=t.col<l.fixedColumnsStart,h=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),c=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),u=this.getColumnsWidth(g,t.col-1)+c,d=this.getColumnsWidth(s,g-1)+(a?h:0)+u;this.backlight.setPosition(r,d),this.backlight.setSize(this.getColumnsWidth(g,f),i.hider.offsetHeight-r),this.backlight.setOffset(null,-u),Pa(this.hot.rootElement,MT)}else La(this.hot.rootElement,TT),l.pressed=!1,l.columnsToMove.length=0}onMouseMove(e){const t=ST.get(this);if(t.pressed){if(e.target===this.backlight.element){const e=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(e)}))}t.target.eventPageX=e.pageX,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,n,o){const i=this.hot.getSelectedRangeLast(),s=ST.get(this);i&&s.pressed&&(s.columnsToMove.indexOf(t.col)>-1?La(this.hot.rootElement,ET):Pa(this.hot.rootElement,ET),o.row=!0,o.column=!0,o.cell=!0,s.hoveredColumn=t.col,s.target.TD=n)}onMouseUp(){const e=ST.get(this),t=e.target.col,n=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,La(this.hot.rootElement,[MT,ET,TT]),this.hot.selection.isSelectedByColumnHeader()&&Pa(this.hot.rootElement,TT),n<1||void 0===t)return;const o=e.columnsToMove[0],i=this.hot.toPhysicalColumn(o),s=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,!0===s){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const e=this.hot.toVisualColumn(i),t=e+n-1;this.hot.selectColumns(e,t)}}onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;this.backlight.setPosition(t),this.backlight.setSize(null,e.hider.offsetHeight-t)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const OT="manualColumnResize",AT="manualColumnWidths",_T=new WeakMap;class IT extends ov{static get PLUGIN_KEY(){return OT}static get PLUGIN_PRIORITY(){return 130}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new pu(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,_T.set(this,{config:void 0}),Pa(this.handle,"manualColumnResizer"),Pa(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[OT]}enablePlugin(){this.enabled||(this.columnWidthsMap=new gm,this.columnWidthsMap.addLocalHook("init",(()=>this.onMapInit())),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",((e,t)=>this.onModifyColWidth(e,t))),this.addHook("beforeStretchingColumnWidth",((e,t)=>this.onBeforeStretchingColumnWidth(e,t))),this.addHook("beforeColumnResize",((e,t,n)=>this.onBeforeColumnResize(e,t,n))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_T.get(this).config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",AT,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",AT,e),e.value}setManualSize(e,t){const n=Math.max(t,20),o=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(o,n),n}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}onMapInit(){const e=_T.get(this),t=this.hot.getSettings()[OT],n=this.loadManualColumnWidths();void 0!==n?this.hot.batchExecution((()=>{n.forEach(((e,t)=>{this.columnWidthsMap.setValueAtIndex(t,e)}))}),!0):Array.isArray(t)?(this.hot.batchExecution((()=>{t.forEach(((e,t)=>{this.columnWidthsMap.setValueAtIndex(t,e)}))}),!0),e.config=t):!0===t&&Array.isArray(e.config)&&this.hot.batchExecution((()=>{e.config.forEach(((e,t)=>{this.columnWidthsMap.setValueAtIndex(t,e)}))}),!0)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:t}=this.hot.view,n=t.wtTable.getCoords(this.currentTH),o=n.col;if(o<0)return;const i=eh(this.currentTH),s=this.currentTH.getBoundingClientRect();let r;o<t.getSetting("fixedColumnsStart")&&(r=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),r||(r=t.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];const l=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&l){Xl(this.hot.getSelectedRange(),(e=>{_u(e.getTopStartCorner().col,e.getBottomEndCorner().col,(e=>{this.selectedCols.includes(e)||this.selectedCols.push(e)}))}))}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=r.start-6,this.startWidth=parseInt(s.width,10),this.handle.style.top=`${r.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${i}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(eh(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Pa(this.handle,"active"),Pa(this.guide,"active"),this.guide.style.top=`${t}px`,this.refreshGuidePosition(),this.guide.style.height=n-e+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){La(this.handle,"active"),La(this.guide,"active")}checkIfColumnHeader(e){return!!Aa(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){if(!wh(e.target)&&!0!==this.isTriggeredByRMB&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const n=t.getAttribute("colspan");!t||null!==n&&"1"!==n||this.pressed||this.setupHandlePosition(t)}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(t,n)=>{const o=this.hot.runHooks("beforeColumnResize",this.newSize,t,!0);void 0!==o&&(this.newSize=o),"all"===this.hot.getSettings().stretchH?this.clearManualSize(t):this.setManualSize(t,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,t,!0),n&&e()};if(this.dblclick>=2){this.selectedCols.length>1?(Xl(this.selectedCols,(e=>{t(e)})),e()):Xl(this.selectedCols,(e=>{t(e,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Na(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((()=>this.afterMouseDownTimeout()),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){if(this.pressed){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+t,Xl(this.selectedCols,(e=>{this.newSize=this.setManualSize(e,this.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(t,n)=>{this.hot.runHooks("beforeColumnResize",this.newSize,t,!1),n&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,t,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){this.selectedCols.length>1?(Xl(this.selectedCols,(e=>{t(e)})),e()):Xl(this.selectedCols,(e=>{t(e,!0)}))}this.setupHandlePosition(this.currentTH)}}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((()=>{this.isTriggeredByRMB=!1}))}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",(e=>this.onMouseOver(e))),this.eventManager.addEventListener(t,"mousedown",(e=>this.onMouseDown(e))),this.eventManager.addEventListener(e,"mousemove",(e=>this.onMouseMove(e))),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(this.handle,"contextmenu",(()=>this.onContextMenu()))}onModifyColWidth(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalColumn(t),o=this.columnWidthsMap.getValueAtIndex(e);this.hot.getSettings()[OT]&&o&&(n=o)}return n}onBeforeStretchingColumnWidth(e,t){let n=this.columnWidthsMap.getValueAtIndex(t);return null===n&&(n=e),n}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const kT="px";var HT=class{constructor(e){this.hot=e,this._element=null,this.state=0}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){void 0!==e&&(this._element.style.top=e+kT),void 0!==t&&(this._element.style.left=t+kT)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+kT),t&&(this._element.style.height=t+kT)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+kT),t&&(this._element.style.marginLeft=t+kT)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};var DT=class extends HT{build(){super.build(),Pa(this._element,"ht__manualRowMove--backlight")}};var NT=class extends HT{build(){super.build(),Pa(this._element,"ht__manualRowMove--guideline")}};nu.getSingleton().register("beforeRowMove"),nu.getSingleton().register("afterRowMove");const PT="manualRowMove",LT=new WeakMap,VT="ht__manualRowMove",FT="show-ui",BT="on-moving--rows",WT="after-selection--rows";class UT extends ov{static get PLUGIN_KEY(){return PT}static get PLUGIN_PRIORITY(){return 140}constructor(e){super(e),LT.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new pu(this),this.backlight=new DT(e),this.guideline=new NT(e)}isEnabled(){return!!this.hot.getSettings()[PT]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown(...arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver(...arguments)})),this.addHook("afterScrollHorizontally",(()=>this.onAfterScrollHorizontally())),this.addHook("afterLoadData",(function(){return e.onAfterLoadData(...arguments)})),this.buildPluginUI(),this.registerEvents(),Pa(this.hot.rootElement,VT),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){La(this.hot.rootElement,VT),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const n=LT.get(this),o=n.cachedDropIndex,i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeRowMove",e,t,o,i);if(n.cachedDropIndex=void 0,!1===s)return;i&&this.hot.rowIndexMapper.moveIndexes(e,t);const r=i&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,o,i,r),r}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const n=this.countFinalIndex(e,t);return LT.get(this).cachedDropIndex=t,this.moveRows(e,n)}isMovePossible(e,t){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>n,i=t<0,s=e.some((e=>e<0)),r=e.some((e=>e>=n));return!(o||i||s||r)}isRowOrderChanged(e,t){return e.some(((e,n)=>e-n!==t))}countFinalIndex(e,t){const n=Gl(e,((e,n)=>(n<t&&(e+=1),e)),0);return t-n}getRowsHeight(e,t){const n=this.hot.rowIndexMapper;let o=0;for(let i=e;i<=t;i++){const e=n.getRenderableFromVisualIndex(i);null!==e&&(o+=this.hot.view._wt.wtTable.getRowHeight(e)||23)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PT];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:n,to:o}=e;return _u(Math.min(n.row,o.row),Math.max(n.row,o.row),(e=>{t.push(e)})),t}refreshPositions(){const e=LT.get(this),t=e.target.coords,n=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(t.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(t.row)&&o<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,r=e.target.TD,l=this.hot.rootElement,a=za(l),h=Xa(l),c=s.holder.scrollTop;let u;u=this.hot.rootWindow===h?h.scrollY:h.scrollTop;const d=a.top-u,g=e.target.eventPageY-d+c,f=s.hider.offsetHeight,m=s.TBODY.offsetTop,p=this.backlight.getOffset().top,w=this.backlight.getSize().height,C=r.offsetHeight/2,y=r.offsetHeight;let v=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const b=g>=v+C;this.isFixedRowTop(t.row)&&(v+=s.holder.scrollTop),t.row<0?e.target.row=n>0?n-1:n:b?(e.target.row=t.row+1,v+=0===t.row?y-1:y):e.target.row=t.row;let S=g,R=v;g+w+p>=f?S=f-w-p:g+p<m&&(S=m+Math.abs(p)),v>=f-1&&(R=f-1),this.backlight.setPosition(S),this.guideline.setPosition(R)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",(e=>this.onMouseMove(e))),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp()))}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,n,o){const{wtTable:i,wtViewport:s}=this.hot.view._wt,r=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),a=LT.get(this);if(!l||!r||a.pressed||0!==e.button)return a.pressed=!1,a.rowsToMove.length=0,void La(this.hot.rootElement,[BT,FT]);const h=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&c&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:u,to:d}=l,g=Math.min(u.row,d.row),f=Math.max(u.row,d.row);if(t.col<0&&t.row>=g&&t.row<=f){o.row=!0,a.pressed=!0,a.target.eventPageY=e.pageY,a.target.coords=t,a.target.TD=n,a.rowsToMove=this.prepareRowsToMoving();const r=i.holder.scrollLeft+s.getRowHeaderWidth();this.backlight.setPosition(null,r),this.backlight.setSize(i.hider.offsetWidth-r,this.getRowsHeight(g,f)),this.backlight.setOffset(-1*(this.getRowsHeight(g,t.row-1)+e.offsetY),null),Pa(this.hot.rootElement,BT),this.refreshPositions()}else La(this.hot.rootElement,WT),a.pressed=!1,a.rowsToMove.length=0}onMouseMove(e){const t=LT.get(this);if(t.pressed){if(e.target===this.backlight.element){const e=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,e)}))}t.target.eventPageY=e.pageY,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,n,o){const i=this.hot.getSelectedRangeLast(),s=LT.get(this);i&&s.pressed&&(s.rowsToMove.indexOf(t.row)>-1?La(this.hot.rootElement,FT):Pa(this.hot.rootElement,FT),o.row=!0,o.column=!0,o.cell=!0,s.target.coords=t,s.target.TD=n)}onMouseUp(){const e=LT.get(this),t=e.target.row,n=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,La(this.hot.rootElement,[BT,FT,WT]),this.hot.selection.isSelectedByRowHeader()&&Pa(this.hot.rootElement,WT),n<1||void 0===t)return;const o=e.rowsToMove[0],i=this.hot.toPhysicalRow(o),s=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,!0===s){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const e=this.hot.toVisualRow(i),t=e+n-1;this.hot.selectRows(e,t)}}onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;this.backlight.setPosition(null,t),this.backlight.setSize(e.hider.offsetWidth-t)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const jT="manualRowResize",zT="manualRowHeights",YT=new WeakMap;class $T extends ov{static get PLUGIN_KEY(){return jT}static get PLUGIN_PRIORITY(){return 30}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new pu(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,YT.set(this,{config:void 0}),Pa(this.handle,"manualRowResizer"),Pa(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[jT]}enablePlugin(){this.enabled||(this.rowHeightsMap=new gm,this.rowHeightsMap.addLocalHook("init",(()=>this.onMapInit())),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",((e,t)=>this.onModifyRowHeight(e,t))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){YT.get(this).config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",zT,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",zT,e),e.value}setManualSize(e,t){const n=this.hot.toPhysicalRow(e),o=Math.max(t,$d.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,o),o}setupHandlePosition(e){this.currentTH=e;const{view:t}=this.hot,{_wt:n}=t,o=n.wtTable.getCoords(this.currentTH),i=o.row;if(i<0)return;const s=Qa(this.currentTH),r=this.currentTH.getBoundingClientRect(),l=i<n.getSetting("fixedRowsTop"),a=i>=t.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let h;l?h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):a&&(h=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),h||(h=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){Xl(this.hot.getSelectedRange(),(e=>{_u(e.getTopStartCorner().row,e.getBottomStartCorner().row,(e=>{this.selectedRows.includes(e)||this.selectedRows.push(e)}))}))}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=h.top-6,this.startHeight=parseInt(r.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${h.start}px`,this.handle.style.width=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(Qa(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Pa(this.handle,"active"),Pa(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${t}px`,this.guide.style.width=n-e+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){La(this.handle,"active"),La(this.guide,"active")}checkIfRowHeader(e){var t;return Aa(e,["TH"],this.hot.rootElement)&&"TBODY"===(null===(t=e.parentNode)||void 0===t||null===(t=t.parentNode)||void 0===t?void 0:t.tagName)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&this.newSize<t?t:this.newSize}onMouseOver(e){if(!wh(e.target)&&!0!==this.isTriggeredByRMB&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(t,n)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!0);void 0!==o&&(this.newSize=o),this.setManualSize(t,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!0),n&&e()};if(this.dblclick>=2){this.selectedRows.length>1?(Xl(this.selectedRows,(e=>{t(e)})),e()):Xl(this.selectedRows,(e=>{t(e,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Na(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((()=>this.afterMouseDownTimeout()),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),Xl(this.selectedRows,(e=>{this.newSize=this.setManualSize(e,this.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(t,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),n&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){this.selectedRows.length>1?(Xl(this.selectedRows,(e=>{t(e)})),e()):Xl(this.selectedRows,(e=>{t(e,!0)}))}this.setupHandlePosition(this.currentTH)}}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((()=>{this.isTriggeredByRMB=!1}))}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",(e=>this.onMouseOver(e))),this.eventManager.addEventListener(e,"mousedown",(e=>this.onMouseDown(e))),this.eventManager.addEventListener(t,"mousemove",(e=>this.onMouseMove(e))),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(this.handle,"contextmenu",(()=>this.onContextMenu()))}onModifyRowHeight(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalRow(t),o=this.rowHeightsMap.getValueAtIndex(e);this.hot.getSettings()[jT]&&o&&(n=o)}return n}onMapInit(){const e=YT.get(this),t=this.hot.getSettings()[jT],n=this.loadManualRowHeights();this.hot.batchExecution((()=>{void 0!==n?n.forEach(((e,t)=>{this.rowHeightsMap.setValueAtIndex(t,e)})):Array.isArray(t)?(t.forEach(((e,t)=>{this.rowHeightsMap.setValueAtIndex(t,e)})),e.config=t):!0===t&&Array.isArray(e.config)&&e.config.forEach(((e,t)=>{this.rowHeightsMap.setValueAtIndex(t,e)}))}),!0)}destroy(){super.destroy()}}var GT=class{constructor(e,t,n,o,i,s){this.row=e,this.col=t,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return na`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return na`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return na`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return na`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return 1===e.colspan&&1===e.rowspan}static containsZeroSpan(e){return 0===e.colspan||0===e.rowspan}static isOutOfBounds(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const n=e[0]||e[1],o=t+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",r=Math.min(t,o),l=Math.max(t,o),a=this[s],h=this[s]+this[i]-1;if(a>=t&&(this[s]+=n),n>0)t<=h&&t>a&&(this[i]+=n);else if(n<0){if(r<=a&&l>=h)return this.removed=!0,!1;if(a>=r&&a<=l){const e=l-a+1,t=Math.abs(n)-e;this[s]-=t+n,this[i]-=e}else if(a<=r&&h>=l)this[i]+=n;else if(a<=r&&h>=r&&h<l){const e=h-r+1;this[i]-=e}}return!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}};function KT(e,t,n,o){t?t.row===n&&t.col===o?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}class qT{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return na`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){const n=this.mergedCells;let o=!1;return Xl(n,(n=>!(n.row<=e&&n.row+n.rowspan-1>=e&&n.col<=t&&n.col+n.colspan-1>=t)||(o=n,!1))),o}getByRange(e){const t=this.mergedCells;let n=!1;return Xl(t,(t=>!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(n=t,n))),n}getWithinRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCells,o=[];let i=e;if(!i.includesRange){const e=this.hot._createCellCoords(i.from.row,i.from.col),t=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(e,e,t)}return Xl(n,(e=>{const n=this.hot._createCellCoords(e.row,e.col),s=this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),r=this.hot._createCellRange(n,n,s);t?i.overlaps(r)&&o.push(e):i.includesRange(r)&&o.push(e)})),!!o.length&&o}add(e){const t=this.mergedCells,n=e.row,o=e.col,i=e.rowspan,s=e.colspan,r=new GT(n,o,i,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,o),a=this.isOverlapping(r);return l||a?(Kc(qT.IS_OVERLAPPING_WARNING(r)),!1):(this.hot&&r.normalize(this.hot),t.push(r),r)}remove(e,t){const n=this.mergedCells,o=this.get(e,t),i=o?this.mergedCells.indexOf(o):-1;return!(!o||-1===i)&&(n.splice(i,1),o)}clear(){const e=this.mergedCells,t=[],n=[];Xl(e,(e=>{const n=this.hot.getCell(e.row,e.col);n&&t.push([n,this.get(e.row,e.col),e.row,e.col])})),this.mergedCells.length=0,Xl(t,((e,o)=>{_u(0,e.rowspan-1,(t=>{_u(0,e.colspan-1,(o=>{if(0!==o||0!==t){const i=this.hot.getCell(e.row+t,e.col+o);i&&n.push([i,null,null,null])}}))})),t[o][1]=null})),Xl(t,(e=>{KT(...e)})),Xl(n,(e=>{KT(...e)}))}isOverlapping(e){const t=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let n=!1;return Xl(this.mergedCells,(e=>!this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)).overlaps(t)||(n=!0,!1))),n}isFirstRenderableMergedCell(e,t){const n=this.get(e,t);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===t}getFirstRenderableCoords(e,t){const n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(o,i)}shiftCollections(e,t,n){const o=[0,0];switch(e){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n}Xl(this.mergedCells,(e=>{e.shift(o,t)})),Iu(this.mergedCells.length-1,0,(e=>{const t=this.mergedCells[e];t&&t.removed&&this.mergedCells.splice(this.mergedCells.indexOf(t),1)}))}}var XT=qT;var ZT=class{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let n=null;return n=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left",n}snapDragArea(e,t,n,o){const i=t.slice(0),s=this.getAutofillSize(e,t,n),[r,l,a,h]=e,c=["up","down"].indexOf(n)>-1?a-r+1:h-l+1,u=s-Math.floor(s/c)*c,d=this.getFarthestCollection(e,t,n,o);if(d)if("down"===n){const e=d.row+d.rowspan-r-u;i[2]+e>=this.plugin.hot.countRows()?i[2]-=u:i[2]+=u?e:0}else if("right"===n){const e=d.col+d.colspan-l-u;i[3]+e>=this.plugin.hot.countCols()?i[3]-=u:i[3]+=u?e:0}else if("up"===n){const e=a-u-d.row+1;i[0]+e<0?i[0]+=u:i[0]-=u?e:0}else if("left"===n){const e=h-u-d.col+1;i[1]+e<0?i[1]+=u:i[1]-=u?e:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:o,fillSize:s,dragArea:i,cycleLength:c}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),sc(this.currentFillData,e)}getAutofillSize(e,t,n){const[o,i,s,r]=e,[l,a,h,c]=t;switch(n){case"up":return o-l;case"down":return h-s;case"left":return i-a;case"right":return c-r;default:return null}}getDragArea(e,t,n){const[o,i,s,r]=e,[l,a,h,c]=t;switch(n){case"up":return[l,a,o-1,r];case"down":return[s+1,i,h,r];case"left":return[l,a,s,i-1];case"right":return[o,r+1,h,c];default:return null}}getFarthestCollection(e,t,n,o){const[i,s,r,l]=e,a=["up","down"].indexOf(n)>-1,h=a?r:l,c=a?i:s,u=this.getAutofillSize(e,t,n),d=a?r-i+1:l-s+1,g=u-Math.floor(u/d)*d;let f=null,m=null,p=null;switch(n){case"up":f="includesVertically",p=h-g+1;break;case"left":f="includesHorizontally",p=h-g+1;break;case"down":f="includesVertically",p=c+g-1;break;case"right":f="includesHorizontally",p=c+g-1}return Xl(o,(e=>{e[f](p)&&e.isFarther(m,n)&&(m=e)})),m}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,i=(e,n)=>{switch(o){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}};let s=0,r=null,l=1;do{for(let e=0;e<n.length;e+=1){if(r=n[e],s=l*this.currentFillData.cycleLength,i(r,s))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:r.row-s,rowspan:r.rowspan,col:r.col,colspan:r.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:r.row+s,rowspan:r.rowspan,col:r.col,colspan:r.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:r.row,rowspan:r.rowspan,col:r.col-s,colspan:r.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:r.row,rowspan:r.rowspan,col:r.col+s,colspan:r.colspan})}e===n.length-1&&(l+=1)}}while(i(r,s));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},n={min:null,max:null};return Xl(e,(e=>{const o=e[0],i=this.plugin.hot.propToCol(e[1]);(null===t.min||o<t.min)&&(t.min=o),(null===t.max||o>t.max)&&(t.max=o),(null===n.min||i<n.min)&&(n.min=i),(null===n.max||i>n.max)&&(n.max=i)})),{from:{row:t.min,column:n.min},to:{row:t.max,column:n.max}}}dragAreaOverlapsCollections(e,t,n){const o=this.getDragArea(e,t,n),[i,s,r,l]=o,a=this.plugin.hot._createCellCoords(i,s),h=this.plugin.hot._createCellCoords(r,l),c=this.plugin.hot._createCellRange(a,a,h);return!!this.mergedCellsCollection.getWithinRange(c,!0)}};var JT=class{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,t,n){const o=t.to,i=o.row+e.row,s=o.col+e.col;e.row?this.jumpOverMergedCell(e,n,i):e.col&&this.jumpOverMergedCell(e,n,s)}jumpOverMergedCell(e,t,n){let o=e.row||e.col,i=null,s=null,r=null;e.row?(i=t.includesVertically(n),s=t.row,r=t.getLastRow()):e.col&&(i=t.includesHorizontally(n),s=t.col,r=t.getLastColumn()),0!==o&&(o>0?i&&n!==s&&(o+=r-n+1):i&&n!==r&&(o-=n-s+1),e.row?e.row=o:e.col&&(e.col=o))}getUpdatedSelectionRange(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}getSelectedMergedCellClassName(e,t,n,o){const i=Math.min(n[0],n[2]),s=Math.min(n[1],n[3]),r=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(void 0===o)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const a=this.plugin.mergedCellsCollection.get(e,t);if(!a)return;const h=a.getLastRow(),c=a.getLastColumn();return i<=a.row&&s<=a.col&&r>=h&&l>=c?`${this.fullySelectedMergedCellClassName}-${o}`:this.plugin.selectionCalculations.isMergeCellFullySelected(a,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(e,t){const n=[];if(!t||!e)return!1;for(let t=0;t<e.rowspan;t+=1)for(let o=0;o<e.colspan;o+=1)n.push(this.hot._createCellCoords(e.row+t,e.col+o));for(let e=0;e<n.length;e+=1){const o=[];for(let i=0;i<t.length;i+=1)o[i]=t[i].includes(n[e]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}};nu.getSingleton().register("beforeMergeCells"),nu.getSingleton().register("afterMergeCells"),nu.getSingleton().register("beforeUnmergeCells"),nu.getSingleton().register("afterUnmergeCells");const QT="mergeCells",ex=new WeakMap,tx=QT;class nx extends ov{static get PLUGIN_KEY(){return QT}static get PLUGIN_PRIORITY(){return 150}constructor(e){super(e),ex.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[QT]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new XT(this),this.autofillCalculations=new ZT(this),this.selectionCalculations=new JT(this),this.addHook("afterInit",(function(){return e.onAfterInit(...arguments)})),this.addHook("modifyTransformStart",(function(){return e.onModifyTransformStart(...arguments)})),this.addHook("afterModifyTransformStart",(function(){return e.onAfterModifyTransformStart(...arguments)})),this.addHook("modifyTransformEnd",(function(){return e.onModifyTransformEnd(...arguments)})),this.addHook("modifyGetCellCoords",(function(){return e.onModifyGetCellCoords(...arguments)})),this.addHook("beforeSetRangeStart",(function(){return e.onBeforeSetRangeStart(...arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return e.onBeforeSetRangeStart(...arguments)})),this.addHook("beforeSetRangeEnd",(function(){return e.onBeforeSetRangeEnd(...arguments)})),this.addHook("afterIsMultipleSelection",(function(){return e.onAfterIsMultipleSelection(...arguments)})),this.addHook("afterRenderer",(function(){return e.onAfterRenderer(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.addMergeActionsToContextMenu(...arguments)})),this.addHook("afterGetCellMeta",(function(){return e.onAfterGetCellMeta(...arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return e.onAfterViewportRowCalculatorOverride(...arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)})),this.addHook("modifyAutofillRange",(function(){return e.onModifyAutofillRange(...arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol(...arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol(...arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow(...arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow(...arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange(...arguments)})),this.addHook("beforeDrawBorders",(function(){return e.onBeforeDrawAreaBorders(...arguments)})),this.addHook("afterDrawSelection",(function(){return e.onAfterDrawSelection(...arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return e.onBeforeRemoveCellClassNames(...arguments)})),this.addHook("beforeUndoStackChange",((e,t)=>{if("MergeCells"===t)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[QT];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!Mc())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach((e=>{const{row:n,rowspan:o}=e;for(let e=n+1;e<n+o;e++)t.push(e)})),t=[...new Set(t)],t.forEach((t=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(t);this.hot.view._wt.wtOverlays.getOverlays(!0).map((e=>"master"===(null==e?void 0:e.name)?e:e.clone.wtTable)).forEach((t=>{const o=t.getRow(n);o&&(o.style.background=Za(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))}))})),this.hot._registerTimeout((()=>{e.forEach((e=>{e.style.background=Za(e,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(e){let t=!0;return!!e&&(GT.containsNegativeValues(e)?(Kc(GT.NEGATIVE_VALUES_WARNING(e)),t=!1):GT.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Kc(GT.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):GT.isSingleCell(e)?(Kc(GT.IS_SINGLE_CELL(e)),t=!1):GT.containsZeroSpan(e)&&(Kc(GT.ZERO_SPAN_WARNING(e)),t=!1),t)}generateFromSettings(e){if(Array.isArray(e)){const t=[];if(Xl(e,(e=>{if(!this.validateSetting(e))return;const n=this.hot._createCellCoords(e.row,e.col),o=this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),i=this.hot._createCellRange(n,n,o);this.mergeRange(i,!0,!0),_u(e.row,e.row+e.rowspan-1,(n=>{_u(e.col,e.col+e.colspan-1,(o=>{!1==(n===e.row&&o===e.col)&&t.push([n,o,null])}))}))})),0===t.length)return;this.hot.setDataAtCell(t)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=e.getTopStartCorner(),i=e.getBottomEndCorner(),s={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},r=[];let l=null;if(!this.canMergeRange(s,t))return!1;this.hot.runHooks("beforeMergeCells",e,t),_u(0,s.rowspan-1,(e=>{_u(0,s.colspan-1,(t=>{let n=null;r[e]||(r[e]=[]),0===e&&0===t?n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+e,s.col+t,"hidden",!0),r[e][t]=n}))})),this.hot.setCellMeta(s.row,s.col,"spanned",!0);return!this.mergedCellsCollection.add(s)||(n?l=[s.row,s.col,r]:this.hot.populateFromArray(s.row,s.col,r,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,t),l)}unmergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCellsCollection.getWithinRange(e);n&&(this.hot.runHooks("beforeUnmergeCells",e,t),Xl(n,(e=>{this.mergedCellsCollection.remove(e.row,e.col),_u(0,e.rowspan-1,(t=>{_u(0,e.colspan-1,(n=>{this.hot.removeCellMeta(e.row+t,e.col+n,"hidden"),this.hot.removeCellMeta(e.row+t,e.col+n,"copyable")}))})),this.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,n,o){const i=this.hot._createCellCoords(e,t),s=this.hot._createCellCoords(n,o);this.mergeRange(this.hot._createCellRange(i,i,s))}unmerge(e,t,n,o){const i=this.hot._createCellCoords(e,t),s=this.hot._createCellCoords(n,o);this.unmergeRange(this.hot._createCellRange(i,i,s))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[QT]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render()},runOnlyIf:e=>!e.altKey,group:tx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tx)}onAfterIsMultipleSelection(e){if(e){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast();for(let n=0;n<e.length;n+=1)if(t.from.row===e[n].row&&t.from.col===e[n].col&&t.to.row===e[n].row+e[n].rowspan-1&&t.to.col===e[n].col+e[n].colspan-1)return!1}return e}onModifyTransformStart(e){const t=ex.get(this),n=this.hot.getSelectedRangeLast();let o={row:e.row,col:e.col},i=null;const s=this.hot._createCellCoords(n.highlight.row,n.highlight.col),r=this.mergedCellsCollection.get(s.row,s.col);if(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),r){const n=this.hot._createCellCoords(r.row,r.col),i=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1);this.hot._createCellRange(n,n,i).includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),o.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-s.row:o.row,o.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-s.col:o.col,e.row>0?o.row=r.row+r.rowspan-1-s.row+e.row:e.row<0&&(o.row=s.row-r.row+e.row),e.col>0?o.col=r.col+r.colspan-1-s.col+e.col:e.col<0&&(o.col=s.col-r.col+e.col)}i=this.hot._createCellCoords(n.highlight.row+o.row,n.highlight.col+o.col);const l=this.mergedCellsCollection.get(i.row,i.col);if(l){const e=this.mergedCellsCollection.getFirstRenderableCoords(l.row,l.col);t.lastDesiredCoords=i,o={row:e.row-s.row,col:e.col-s.col}}0!==o.row&&(e.row=o.row),0!==o.col&&(e.col=o.col)}onModifyTransformEnd(e){const t=this.hot.getSelectedRangeLast(),n=ac(e),o=this.selectionCalculations.getUpdatedSelectionRange(t,e);let i=ac(n);const s=this.mergedCellsCollection.getWithinRange(o,!0);do{i=ac(n),this.selectionCalculations.getUpdatedSelectionRange(t,n),Xl(s,(e=>{this.selectionCalculations.snapDelta(n,t,e)}))}while(n.row!==i.row||n.col!==i.col);e.row=n.row,e.col=n.col}onModifyGetCellCoords(e,t){if(e<0||t<0)return;const n=this.mergedCellsCollection.get(e,t);if(!n)return;const{row:o,col:i,colspan:s,rowspan:r}=n;return[o,i,o+r-1,i+s-1]}addMergeActionsToContextMenu(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(pp)}return this.getTranslatedPhrase(mp)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return!e||GT.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}onAfterRenderer(e,t,n){const o=this.mergedCellsCollection.get(t,n),i=uc(o)?ac(o):void 0;if(uc(i)){const{rowIndexMapper:e,columnIndexMapper:o}=this.hot,{row:s,col:r,colspan:l,rowspan:a}=i,[h,c]=this.translateMergedCellToRenderable(s,a,r,l),u=h-e.getRenderableFromVisualIndex(t)+1,d=c-o.getRenderableFromVisualIndex(n)+1;i.row=e.getNearestNotHiddenIndex(i.row,1),i.col=o.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,u),i.colspan=Math.min(i.colspan,d)}KT(e,i,t,n)}onBeforeSetRangeStart(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){const t=this.mergedCellsCollection.get(e.row,e.col);[e.row,e.col]=[t.row,t.col]}}onBeforeSetRangeEnd(e){const t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;let n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1){const i=this.mergedCellsCollection.mergedCells[o].getRange();t.expandByRange(i)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}onAfterGetCellMeta(e,t,n){const o=this.mergedCellsCollection.get(e,t);o&&(o.row!==e||o.col!==t?n.copyable=!1:(n.rowspan=o.rowspan,n.colspan=o.colspan))}onAfterViewportRowCalculatorOverride(e){const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}modifyViewportRowStart(e,t){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(e.startRow);for(let i=0;i<t;i+=1){const s=this.mergedCellsCollection.get(o,i);if(uc(s)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s.row,1));if(o<e.startRow)return e.startRow=o,void this.modifyViewportRowStart(e,t)}}}modifyViewportRowEnd(e,t){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(e.endRow);for(let i=0;i<t;i+=1){const s=this.mergedCellsCollection.get(o,i);if(uc(s)){const o=s.row+s.rowspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(i>e.endRow)return e.endRow=i,void this.modifyViewportRowEnd(e,t)}}}onAfterViewportColumnCalculatorOverride(e){const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}modifyViewportColumnStart(e,t){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(e.startColumn);for(let i=0;i<t;i+=1){const s=this.mergedCellsCollection.get(i,o);if(uc(s)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s.col,1));if(o<e.startColumn)return e.startColumn=o,void this.modifyViewportColumnStart(e,t)}}}modifyViewportColumnEnd(e,t){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(e.endColumn);for(let i=0;i<t;i+=1){const s=this.mergedCellsCollection.get(i,o);if(uc(s)){const o=s.col+s.colspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(i>e.endColumn)return e.endColumn=i,void this.modifyViewportColumnEnd(e,t)}}}translateMergedCellToRenderable(e,t,n,o){const{rowIndexMapper:i,columnIndexMapper:s}=this.hot;let r,l;r=0===t?i.getNearestNotHiddenIndex(e,1):i.getNearestNotHiddenIndex(e+t-1,-1),l=0===o?s.getNearestNotHiddenIndex(n,1):s.getNearestNotHiddenIndex(n+o-1,-1);return[e>=0?i.getRenderableFromVisualIndex(r):e,n>=0?s.getRenderableFromVisualIndex(l):n]}onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);const n=this.autofillCalculations.getDirection(t,e);let o=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,o,n))return o=t,o;const i=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return i?(o=this.autofillCalculations.snapDragArea(t,o,n,i),o):o}onAfterCreateCol(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}onAfterRemoveCol(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}onAfterCreateRow(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}onAfterRemoveRow(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}onAfterChange(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(e,t){if(t&&"area"===t){const t=this.hot.getSelectedRangeLast();Xl(this.mergedCellsCollection.getWithinRange(t),(n=>{t.getBottomEndCorner().row===n.getLastRow()&&t.getBottomEndCorner().col===n.getLastColumn()&&(e[2]=n.row,e[3]=n.col)}))}}onAfterModifyTransformStart(e,t,n){if(!this.enabled)return;const o=this.mergedCellsCollection.get(e.row,e.col);if(!o)return;const i=t>0,s=t<0,r=n<0,l=n>0,a=o.row+o.rowspan-1==this.hot.countRows()-1,h=0===o.row,c=o.col+o.colspan-1==this.hot.countCols()-1,u=0===o.col;(i&&a||s&&h||l&&c||r&&u)&&(e.row=o.row,e.col=o.col)}onAfterDrawSelection(e,t,n,o){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,o)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}function ox(){Kc(na`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const ix="sort";const sx="multiColumnSorting",rx="columnSorting";tb(sx,(function(e,t){return function(n,o){const[,...i]=n,[,...s]=o;return function n(o){const r=e[o],l=t[o],a=i[o],h=s[o],c=l.multiColumnSorting,u=(c.compareFunctionFactory?c.compareFunctionFactory:ob(l.type))(r,l,c)(a,h);if(u===ib){const e=o+1;if(void 0!==t[e])return n(e)}return u}(0)}}));class lx extends hb{static get PLUGIN_KEY(){return sx}static get PLUGIN_PRIORITY(){return 170}constructor(e){super(e),this.pluginKey=sx}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[rx]&&ox(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];super.updateHeaderClasses(e,...n),La(e,function(e){const t=e.className.split(" "),n=new RegExp(`^${ix}-[0-9]{1,2}$`);return t.filter((e=>n.test(e)))}(e)),!1!==this.enabled&&Pa(e,function(e,t,n){const o=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&o.push(`${ix}-${e.getIndexOfColumnInSortQueue(t)+1}`),o}(...n))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[rx]&&ox(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){!1!==Yv(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,"append"))):this.sort(this.getColumnNextConfig(t.col)))}}class ax extends ov{static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return _c()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new pu(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function n(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;const n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",(t=>{let n;return Na(t.target,"topSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):Na(t.target,"bottomSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(t,"touchend",(t=>Na(t.target,"topSelectionHandle-HitArea")?(n.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):Na(t.target,"bottomSelectionHandle-HitArea")?(n.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0)),this.eventManager.addEventListener(t,"touchmove",(t=>{const{rootDocument:n}=this.hot;let o,i,s,r,l,a;if(0===e.dragged.length)return;const h=n.elementFromPoint(t.touches[0].clientX,t.touches[0].clientY);h&&h!==e.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(o=e.hot.getCoords(h),-1===o.col&&(o.col=0),i=e.hot.getSelectedRangeLast(),s=i.getWidth(),r=i.getHeight(),l=i.getDirection(),1===s&&1===r&&e.hot.selection.setRangeEnd(o),a=e.getCurrentRangeCoords(i,o,e.touchStartRange.direction,l,e.dragged[0]),null!==a.start&&e.hot.selection.setRangeStart(a.start),e.hot.selection.setRangeEnd(a.end),e.lastSetCell=h),t.preventDefault())}))}getCurrentRangeCoords(e,t,n,o,i){const s=e.getTopStartCorner(),r=e.getBottomEndCorner(),l=e.getBottomStartCorner(),a=e.getTopEndCorner();let h={start:null,end:null};switch(n){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":h="top"===i?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,s.col)};break;case"SE-NW":"bottom"===i&&(h={start:this.hot._createCellCoords(r.row,t.col),end:this.hot._createCellCoords(t.row,s.col)})}break;case"NW-SE":switch(o){case"NE-SW":"top"===i?h={start:t,end:l}:h.end=t;break;case"NW-SE":"top"===i?h={start:t,end:r}:h.end=t;break;case"SE-NW":"top"===i?h={start:t,end:s}:h.end=t;break;case"SW-NE":"top"===i?h={start:t,end:a}:h.end=t}break;case"SW-NE":switch(o){case"NW-SE":h="bottom"===i?{start:this.hot._createCellCoords(t.row,s.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(s.row,t.col),end:this.hot._createCellCoords(t.row,r.col)};break;case"SW-NE":h="top"===i?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,r.col)}:{start:this.hot._createCellCoords(t.row,s.col),end:this.hot._createCellCoords(s.row,t.col)};break;case"SE-NW":"bottom"===i?h={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(s.row,t.col)}:"top"===i&&(h={start:l,end:t})}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(h.end=t);break;case"SE-NW":"top"===i?h.end=t:h={start:t,end:s}}}return h}isDragged(){return this.dragged.length>0}}function hx(){let{label:e="",colspan:t=1,origColspan:n=1,collapsible:o=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:r=!1,isRoot:l=!1,isPlaceholder:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:e,colspan:t,origColspan:n,collapsible:o,isCollapsed:s,crossHiddenColumns:i,isHidden:r,isRoot:l,isPlaceholder:a}}function cx(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function ux(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,gx(e,t,"get"))}function dx(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,gx(e,t,"set"),n),n}function gx(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}const fx=["label","collapsible"];var mx=new WeakMap,px=new WeakMap,wx=new WeakMap;class Cx{constructor(){cx(this,mx,{writable:!0,value:[]}),cx(this,px,{writable:!0,value:0}),cx(this,wx,{writable:!0,value:1/0})}setColumnsLimit(e){dx(this,wx,e)}setData(){dx(this,mx,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=[];if(0===t)return n;Xl(e,(e=>{const o=[];let i=0;n.push(o),Xl(e,(e=>{const n=hx();if(uc(e)){const{label:t,colspan:o}=e;n.label=oa(t),"number"==typeof o&&o>1&&(n.colspan=o,n.origColspan=o)}else n.label=oa(e);i+=n.origColspan;let s=!1;if(i>=t&&(n.colspan=n.origColspan-(i-t),n.origColspan=n.colspan,s=!0),o.push(n),n.colspan>1)for(let e=0;e<n.colspan-1;e++)o.push({label:"",isPlaceholder:!0});return!s}))}));const o=Math.max(...ql(n,(e=>e.length)));return Xl(n,(e=>{if(e.length<o){const t=ql(new Array(o-e.length),(()=>hx()));e.splice(e.length,0,...t)}})),n}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],ux(this,wx))),dx(this,px,ux(this,mx).length)}getData(){return ux(this,mx)}mergeWith(e){Xl(e,(e=>{let{row:t,col:n,...o}=e;const i=this.getHeaderSettings(t,n);null!==i&&sc(i,o,fx)}))}map(e){Xl(ux(this,mx),(t=>{Xl(t,(t=>{const n=e({...t});uc(n)&&sc(t,n,fx)}))}))}getHeaderSettings(e,t){var n;if(e>=ux(this,px)||e<0)return null;const o=ux(this,mx)[e];return t>=o.length?null:null!==(n=o[t])&&void 0!==n?n:null}getHeadersSettings(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const o=[];if(e>=ux(this,px)||e<0)return o;const i=ux(this,mx)[e];let s=0;for(let e=t;e<i.length;e++){const t=i[e];if(t.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=t.colspan,o.push(t),t.colspan>1&&(e+=t.colspan-1),s===n)break;if(s>n)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return ux(this,px)}getColumnsCount(){return ux(this,px)>0?ux(this,mx)[0].length:0}clear(){dx(this,mx,[]),dx(this,px,0)}}function yx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const vx=new Map([["DF-pre-order",function e(t,n){let o=t.call(n,this);for(let i=0;i<this.childs.length;i++){if(!1===o)return!1;o=e.call(this.childs[i],t,n)}return o}],["DF-post-order",function e(t,n){for(let o=0;o<this.childs.length;o++){if(!1===e.call(this.childs[o],t,n))return!1}return t.call(n,this)}],["BF",function(e,t){const n=[this];!function o(){if(0===n.length)return;const i=n.shift();n.push(...i.childs),!1!==e.call(t,i)&&o()}()}]]);class bx{constructor(e){yx(this,"data",{}),yx(this,"parent",null),yx(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const t=new bx({...e.data});for(let n=0;n<e.childs.length;n++)t.addChild(this.cloneTree(e.childs[n]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!vx.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);vx.get(t).call(this,e,this)}walkUp(e){const t=this,n=o=>{!1!==e.call(t,o)&&null!==o.parent&&n(o.parent)};n(this)}}function Sx(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Rx(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Mx(e,t,"get"))}function Ex(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Mx(e,t,"set"),n),n}function Mx(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Tx=new WeakMap,xx=new WeakMap,Ox=new WeakMap;class Ax{constructor(e){Sx(this,Tx,{writable:!0,value:new Map}),Sx(this,xx,{writable:!0,value:new Map}),Sx(this,Ox,{writable:!0,value:null}),Ex(this,Ox,e)}getRoots(){return Array.from(Rx(this,Tx).values())}getRootByColumn(e){let t;return Rx(this,xx).has(e)&&(t=Rx(this,Tx).get(Rx(this,xx).get(e))),t}getNode(e,t){const n=this.getRootByColumn(t);if(!n)return;const o=t-Rx(this,xx).get(t);let i,s=0;return n.walkDown((n=>{const{data:{origColspan:r,headerLevel:l}}=n;if(e===l){if(o>=s&&o<=s+r-1)return i=n,i.data.isRoot=t===i.data.columnIndex,!1;s+=r}})),i}rebuildTreeIndex(){let e=0;Rx(this,xx).clear(),Xl(Rx(this,Tx),(t=>{let[,{data:{colspan:n}}]=t;for(let t=e;t<e+n;t++)Rx(this,xx).set(t,e);e+=n}))}buildTree(){this.clear();const e=Rx(this,Ox).getColumnsCount();let t=0;for(;t<e;){const e=Rx(this,Ox).getHeaderSettings(0,t),n=new bx;Rx(this,Tx).set(t,n),this.buildLeaves(n,t,0,e.origColspan),t+=e.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=Rx(this,Ox).getHeadersSettings(n,t,o);n+=1,Xl(i,(o=>{const i={...o,headerLevel:n-1,columnIndex:t};let s;1===n?(e.data=i,s=e):(s=new bx(i),e.addChild(s)),n<Rx(this,Ox).getLayersCount()&&this.buildLeaves(s,t,n,o.origColspan),t+=o.origColspan}))}clear(){Rx(this,Tx).clear(),Rx(this,xx).clear()}}function _x(e,t){e.walkDown((e=>{let{data:n,childs:o}=e;if(!n.isHidden&&(t(n.columnIndex),0===o.length))for(let e=1;e<n.colspan;e++)t(n.columnIndex+e)}))}function Ix(e,t){let{childs:n}=e;if(0!==n.length)return n[0].data[t]}function kx(e){return Ix(e,"origColspan")===e.data.origColspan}function Hx(e){const{data:t,childs:n}=e;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(kx(e))return Hx(n[0]);t.isCollapsed=!1;const o=n.slice(1),i=new Set;let s=0;if(o.length>0)Xl(o,(e=>{e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;const t=e.data;s+=t.colspan,_x(e,(e=>{i.add(e)}))}));else{const{colspan:e,origColspan:n,columnIndex:o}=t;s=n-e;for(let e=1;e<n;e++)i.add(o+e)}return e.walkUp((e=>{const{data:t}=e;t.colspan+=s,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):kx(e)&&(t.isCollapsed=Ix(e,"isCollapsed"))})),{rollbackModification:()=>Dx(e),affectedColumns:Array.from(i),colspanCompensation:s}}function Dx(e){var t;const{data:n,childs:o}=e;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(kx(e))return Dx(o[0]);n.isCollapsed=!0;const i=o.slice(1),s=new Set;if(i.length>0)Xl(i,(e=>{_x(e,(e=>{s.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((e=>{let{data:t}=e;t.isHidden=!0}))}));else{const{origColspan:e,columnIndex:t}=n;for(let n=1;n<e;n++){const e=t+n;s.add(e)}}const r=n.colspan-(null!==(t=Ix(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((e=>{const{data:t}=e;t.colspan-=r,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):kx(e)&&(t.isCollapsed=Ix(e,"isCollapsed"))})),{rollbackModification:()=>Hx(e),affectedColumns:Array.from(s),colspanCompensation:r}}const Nx=new Map([["collapse",Dx],["expand",Hx],["hide-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(na`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=e.data;if(n.includes(t))return;let o=!1;e.walkUp((e=>{const{data:{collapsible:t}}=e;if(t)return o=!0,!1})),o||e.walkUp((e=>{const{data:n}=e;n.crossHiddenColumns.push(t),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}],["show-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(na`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=e.data;if(!n.includes(t))return;let o=!1;e.walkUp((e=>{const{data:{collapsible:t}}=e;if(t)return o=!0,!1})),o||e.walkUp((e=>{const{data:n}=e;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(t),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}]]);function Px(e){const t=[];return Xl(e,(e=>{e.walkDown((e=>{const n=e.data,{origColspan:o,columnIndex:i,headerLevel:s,crossHiddenColumns:r}=n,l=function(e,t){let n;Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n);return n}(t,s);let a=!1;for(let e=i;e<i+o;e++){if(r.includes(e)||a)l.push({label:"",isPlaceholder:!0});else{const e=Lx(n);e.isRoot=!0,l.push(e),a=!0}}}))})),t}function Lx(e){const{crossHiddenColumns:t,...n}=hx(e);return n}function Vx(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Fx(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Wx(e,t,"set"),n),n}function Bx(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Wx(e,t,"get"))}function Wx(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Ux=new WeakMap,jx=new WeakMap,zx=new WeakMap;class Yx{constructor(){Vx(this,Ux,{writable:!0,value:new Cx}),Vx(this,jx,{writable:!0,value:new Ax(Bx(this,Ux))}),Vx(this,zx,{writable:!0,value:[[]]})}setState(e){Bx(this,Ux).setData(e);let t=!1;try{Bx(this,jx).buildTree()}catch(e){Bx(this,jx).clear(),Bx(this,Ux).clear(),t=!0}return Fx(this,zx,Px(Bx(this,jx).getRoots())),t}setColumnsLimit(e){Bx(this,Ux).setColumnsLimit(e)}mergeStateWith(e){const t=ql(e,(e=>{let{row:t,...n}=e;return{row:t<0?this.rowCoordsToLevel(t):t,...n}}));Bx(this,Ux).mergeWith(t),Bx(this,jx).buildTree(),Fx(this,zx,Px(Bx(this,jx).getRoots()))}mapState(e){Bx(this,Ux).map(e),Bx(this,jx).buildTree(),Fx(this,zx,Px(Bx(this,jx).getRoots()))}mapNodes(e){return Gl(Bx(this,jx).getRoots(),((t,n)=>(n.walkDown((n=>{const o=e(n.data);void 0!==o&&t.push(o)})),t)),[])}triggerNodeModification(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));const o=Bx(this,jx).getNode(t,n);let i;return o&&(i=function(e,t,n){if(!Nx.has(e))throw new Error(`The node modifier action ("${e}") does not exist.`);return Nx.get(e)(t,n)}(e,o,n),Fx(this,zx,Px(Bx(this,jx).getRoots()))),i}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var n,o;return e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount()?null:null!==(n=null===(o=Bx(this,zx)[e])||void 0===o?void 0:o[t])&&void 0!==n?n:null}getHeaderTreeNodeData(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount())return null;const n=Bx(this,jx).getNode(e,t);return n?{...n.data}:null}findLeftMostColumnIndex(e,t){var n;const{isRoot:o}=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0};if(o)return t;let i=t-1;for(;i>=0;){var s;const{isRoot:t}=null!==(s=this.getHeaderSettings(e,i))&&void 0!==s?s:{isRoot:!0};if(t)break;i-=1}return i}getLayersCount(){return Bx(this,Ux).getLayersCount()}getColumnsCount(){return Bx(this,Ux).getColumnsCount()}clear(){Fx(this,zx,[]),Bx(this,Ux).clear(),Bx(this,jx).clear()}}function $x(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gx=class{constructor(e,t){$x(this,"hot",void 0),$x(this,"nestedHeaderSettingsGetter",void 0),$x(this,"layersCount",0),$x(this,"container",void 0),$x(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let n=0;n<t;n++){const t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(t);this.widthsMap.setValueAtIndex(o,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:n}=this.hot,o=t.createDocumentFragment(),i=t.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,r=n.getRenderableIndexesLength();for(let e=0;e<this.layersCount;e++){const o=t.createElement("tr");for(let i=0;i<r;i++){let r=n.getVisualFromRenderableIndex(i);null===r&&(r=i);const l=t.createElement("th"),a=this.nestedHeaderSettingsGetter(e,r);if(a&&(!a.isPlaceholder||a.isHidden)){let e=a.label;s&&(e+='<button class="changeType"></button>'),Wa(l,e),l.colSpan=a.colspan,o.appendChild(l)}}i.appendChild(o)}o.appendChild(i),e.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}};function Kx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qx(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Xx(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Jx(e,t,"set"),n),n}function Zx(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Jx(e,t,"get"))}function Jx(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}const Qx="nestedHeaders";var eO=new WeakMap,tO=new WeakMap;class nO extends ov{constructor(){super(...arguments),qx(this,eO,{writable:!0,value:new Yx}),qx(this,tO,{writable:!0,value:null}),Kx(this,"ghostTable",new Gx(this.hot,((e,t)=>this.getHeaderSettings(e,t)))),Kx(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return Qx}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[Qx]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();Array.isArray(t)&&Array.isArray(t[0])||Kc(na`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>this.onInit())),this.addHook("afterLoadData",(function(){return e.onAfterLoadData(...arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown(...arguments)})),this.addHook("afterOnCellMouseDown",(function(){return e.onAfterOnCellMouseDown(...arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver(...arguments)})),this.addHook("afterGetColumnHeaderRenderers",(e=>this.onAfterGetColumnHeaderRenderers(e))),this.addHook("modifyColWidth",(function(){return e.onModifyColWidth(...arguments)})),this.addHook("modifyColumnHeaderValue",(function(){return e.onModifyColumnHeaderValue(...arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return e.onBeforeHighlightingColumnHeader(...arguments)})),this.addHook("beforeCopy",(function(){return e.onBeforeCopy(...arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)})),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Zx(this,eO).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Zx(this,eO).setState(e)),this.detectedOverlappedHeaders&&Kc(na`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((e,t)=>{const n=!0===e?"hide-column":"show-column";Zx(this,eO).triggerColumnModification(n,t)})),!Zx(this,tO)&&this.enabled&&Xx(this,tO,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((e=>{e.forEach((e=>{let{op:t,index:n,newValue:o}=e;if("replace"===t){const e=!0===o?"hide-column":"show-column";Zx(this,eO).triggerColumnModification(e,n)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Zx(this,eO).clear(),Zx(this,tO).unsubscribe(),Xx(this,tO,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Zx(this,eO)}getLayersCount(){return Zx(this,eO).getLayersCount()}getHeaderSettings(e,t){return Zx(this,eO).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,o=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let e=0;e<t;e++){const t=n.childNodes[e];if(!t)break;const s=o.childNodes[e],r=i?i.childNodes[e]:null;for(let e=0,n=t.childNodes.length;e<n;e++)t.childNodes[e].removeAttribute("colspan"),La(t.childNodes[e],"hiddenHeader"),s&&s.childNodes[e]&&(s.childNodes[e].removeAttribute("colspan"),La(s.childNodes[e],"hiddenHeader")),i&&r&&r.childNodes[e]&&(r.childNodes[e].removeAttribute("colspan"),La(r.childNodes[e],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,i)=>{var s;const{columnIndexMapper:r,view:l}=this.hot;let a=r.getVisualFromRenderableIndex(o);null===a&&(a=o),i.removeAttribute("colspan"),La(i,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:u}=null!==(s=Zx(this,eO).getHeaderSettings(e,a))&&void 0!==s?s:{label:""};if(u||c)Pa(i,"hiddenHeader");else if(h>1){var d,g;const{wtOverlays:e}=l._wt,t=null===(d=e.topInlineStartCornerOverlay)||void 0===d?void 0:d.clone.wtTable.THEAD.contains(i),s=null===(g=e.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i),r=t||s?Math.min(h,n-o):h;r>1&&i.setAttribute("colspan",r)}this.hot.view.appendColHeader(a,i,(function(){return t.getColumnHeaderValue(...arguments)}),e)}}getColumnHeaderValue(e,t){var n;const{isHidden:o,isPlaceholder:i}=null!==(n=Zx(this,eO).getHeaderSettings(t,e))&&void 0!==n?n:{};return i||o?"":this.hot.getColHeader(e,t)}onBeforeHighlightingColumnHeader(e,t,n){const o=Zx(this,eO).getHeaderTreeNodeData(t,e);if(!o)return e;const{classNames:i,columnCursor:s,selectionType:r,selectionWidth:l}=n,{isRoot:a,colspan:h}=Zx(this,eO).getHeaderSettings(t,e);if(r===Vw){if(!a)return o.columnIndex}else r===Dw&&(h>l-s||!a)&&(i.length=0);return e}onBeforeCopy(e,t,n){let{columnHeadersCount:o}=n;if(0!==o)for(let n=0;n<t.length;n++){const{startRow:o,startCol:s,endRow:r,endCol:l}=t[n],a=r-o+1;if(o>=0||1===s-l+1)break;for(let t=s;t<=l;t++)for(let n=o;n<=r;n++){var i;const o=a+n,r=t-s;if(0===r)continue;!1===(null===(i=Zx(this,eO).getHeaderTreeNodeData(n,t))||void 0===i?void 0:i.isRoot)&&(e[o][r]="")}}}onBeforeOnCellMouseDown(e,t,n,o){this._getHeaderTreeNodeDataByCoords(t)&&(o.column=!0)}onAfterOnCellMouseDown(e,t){const n=this._getHeaderTreeNodeDataByCoords(t);if(!n)return;const{selection:o}=this.hot,i=o.isSelected()?o.getSelectedRange().current():null,s=[],{columnIndex:r,origColspan:l}=n,a=!o.inInSelection(t);e.shiftKey&&i?t.col<i.from.col?s.push(i.getTopEndCorner().col,r,t.row):t.col>i.from.col?s.push(i.getTopStartCorner().col,r+l-1,t.row):s.push(r,r+l-1,t.row):($c(e)||Yc(e)&&a)&&s.push(r,r+l-1,t.row),o.selectColumns(...s)}onBeforeOnCellMouseOver(e,t,n,o){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;const{columnIndex:s,origColspan:r}=i,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:c}=l;o.column=!0,o.cell=!0;const u=[];t.col<c.col?u.push(h.col,s):t.col>c.col?u.push(a.col,s+r-1):u.push(s,s+r-1),this.hot.selectColumns(...u)}onAfterGetColumnHeaderRenderers(e){e.length=0;for(let t=0;t<Zx(this,eO).getLayersCount();t++)e.push(this.headerRendererFactory(t))}onAfterViewportColumnCalculatorOverride(e){const t=Zx(this,eO).getLayersCount();let n=e.startColumn,o=!!t;for(let i=0;i<t;i++){const t=Zx(this,eO).findLeftMostColumnIndex(i,e.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(t);if(t>=0&&(o=!1),Ou(s)&&s<e.startColumn){n=s;break}}e.startColumn=o?Zx(this,eO).getHeaderTreeNodeData(0,n).columnIndex:n}onModifyColWidth(e,t){const n=this.ghostTable.getWidth(t);return e>n?e:n}onModifyColumnHeaderValue(e,t,n){var o;const{label:i}=null!==(o=Zx(this,eO).getHeaderTreeNodeData(n,t))&&void 0!==o?o:{label:""};return i}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){Xx(this,eO,null),null!==Zx(this,tO)&&(Zx(this,tO).unsubscribe(),Xx(this,tO,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Zx(this,eO).getHeaderTreeNodeData(e.row,e.col)}}var oO=class{constructor(e,t){this.hot=t,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},_u(0,this.data.length-1,(e=>{this.cacheNode(this.data[e],0,null)}))}cacheNode(e,t,n){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&Xl(e.__children,(n=>{this.cacheNode(n,t+1,e)}))}getDataObject(e){return null==e?null:this.cache.rows[e]}readTreeNodes(e,t,n,o){let i=!1,s=t;if(isNaN(s)&&s.end)return s;let r=e;return r||(r={__children:this.data},i=!0,s-=1),null!=n&&s===n?{result:r,end:!0}:null!=o&&r===o?{result:s,end:!0}:(s+=1,r.__children&&Xl(r.__children,(e=>{if(this.parentReference.set(e,i?null:r),s=this.readTreeNodes(e,s,n,o),isNaN(s)&&s.end)return!1})),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return gc(this.data[0],((t,n)=>{e[n]=null})),e}getRowIndex(e){return null==e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);const n=this.getRowParent(e);return null==n?this.data.indexOf(t):n.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(Xl(n.__children,(e=>{t+=1,e.__children&&(t+=this.countChildren(e))})),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"==typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null==e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){var n;return(null===(n=e.__children)||void 0===n?void 0:n[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}addChild(e,t){let n=t;this.hot.runHooks("beforeAddChild",e,n);let o=null;e&&(o=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(e)+1,1);let i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();const s=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,t,n){let o,i=n;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const n=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",n,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(n,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",n,1),o=n}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[t]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const n=this.translateTrimmedRow(e),o=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(o,i+1,null);break;case"above":this.addChildAtIndex(o,i,null)}}detachFromParent(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;const o=[];Array.isArray(e)?(_u(e[0],e[2],(e=>{const t=this.translateTrimmedRow(e);o.push(this.getDataObject(t))})),_u(0,o.length-2,(e=>{this.detachFromParent(o[e],!1)})),n=o[o.length-1]):n=e;const i=this.getRowIndex(n),s=this.countChildren(n),r=this.getRowIndexWithinParent(n),l=this.getRowParent(n),a=this.getRowParent(l),h=this.getRowIndex(a);let c=null;if(this.hot.runHooks("beforeDetachChild",l,n),null!=r){const e=Array.from(new Array(i+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",i,s+1,e,this.plugin.pluginName),l.__children.splice(r,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,s+1,e,this.plugin.pluginName),a){c=h+this.countChildren(a);const e=this.getChild(a,this.countChildren(a)-1),t=this.getRowIndex(e);this.hot.runHooks("beforeCreateRow",t+1,s+1,this.plugin.pluginName),a.__children.push(n)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,s+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,n,this.getRowIndex(n)),t&&this.hot.render()}filterData(e,t,n){const o=[];Xl(n,(e=>{o.push(this.getDataObject(e))})),Xl(o,(e=>{const t=this.getRowIndexWithinParent(e),n=this.getRowParent(e);null===n?this.data.splice(t,1):n.__children.splice(t,1)})),this.rewriteCache()}spliceData(e,t,n){const o=this.getDataObject(e-1);let i=null,s=e;o&&o.__children&&0===o.__children.length?(i=o,s=0):e<this.countAllRows()&&(i=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),i?n?i.__children.splice(s,t,...n):i.__children.splice(s,t):n?this.data.splice(s,t,...n):this.data.splice(s,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,n=null;do{n=this.getRowParent(n),null!==n&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,n,o){const i=t===this.hot.countRows(),s=this.getRowParent(e),r=this.getRowIndexWithinParent(e),l=s.__children.slice(r,r+1),a=e>t;let h=i?this.getRowParent(t-1):this.getRowParent(t);null==h&&(h=this.getRowParent(t-1)),null==h&&(h=this.getDataObject(t-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(t),h.__children=[]);const c=i||n||o?h.__children.length:this.getRowIndexWithinParent(t),u=s===h;h.__children.splice(c,0,l[0]),s.__children.splice(r+(a&&u?1:0),1),this.syncRowWithRawSource(s),u||this.syncRowWithRawSource(h)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}};var iO=class{constructor(e,t){this.hot=t,this.plugin=e}};class sO extends iO{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const n=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),s=t.getElementsByTagName("DIV")[0],r=s.querySelector("span.rowHeader");if(Xl(s.querySelectorAll('[class^="ht_nesting"]'),(e=>{e&&s.removeChild(e)})),Pa(t,sO.CSS_CLASSES.indicatorContainer),o){const{rootDocument:e}=this.hot,t=r.cloneNode(!0);s.innerHTML="",_u(0,o-1,(()=>{const t=e.createElement("SPAN");Pa(t,sO.CSS_CLASSES.emptyIndicator),s.appendChild(t)})),s.appendChild(t)}if(this.dataManager.hasChildren(i)){const e=this.hot.rootDocument.createElement("DIV");Pa(t,sO.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?Pa(e,`${sO.CSS_CLASSES.button} ${sO.CSS_CLASSES.expandButton}`):Pa(e,`${sO.CSS_CLASSES.button} ${sO.CSS_CLASSES.collapseButton}`),s.appendChild(e)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}var rO=sO;var lO=class extends iO{constructor(e,t){var n;super(e,t),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,e)},shiftStash:function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==t&&(t=1/0),Xl(n.lastCollapsedRows,((i,s)=>{i>=e&&i<t&&(n.lastCollapsedRows[s]=i+o)}))},applyStash:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,e),n.lastCollapsedRows=void 0},trimStash:(e,t)=>{_u(e,e+t-1,(e=>{const t=this.lastCollapsedRows.indexOf(e);t>-1&&this.lastCollapsedRows.splice(t,1)}))}}}collapseChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];let i=null,s=null,r=null;return isNaN(e)?(i=e,s=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(i)&&Xl(i.__children,(e=>{o.push(this.dataManager.getRowIndex(e))})),r=this.collapseRows(o,!0,!1),n&&this.trimRows(r),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(s)&&this.collapsedRows.push(s),r}collapseMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];Xl(e,(e=>{o.push(...this.collapseChildren(e,!1,!1))})),n&&this.trimRows(o),t&&this.renderAndAdjust()}collapseRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}collapseRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=[];return Xl(e,(e=>{o.push(e),t&&this.collapseChildRows(e,o)})),n&&this.trimRows(o),o}collapseChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Xl(this.dataManager.getDataObject(e).__children,(e=>{const n=this.dataManager.getRowIndex(e);t.push(n),this.collapseChildRows(n,t)}))}n&&this.trimRows(t)}expandRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}expandRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=[];return Xl(e,(e=>{o.push(e),t&&this.expandChildRows(e,o)})),n&&this.untrimRows(o),o}expandChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Xl(this.dataManager.getDataObject(e).__children,(e=>{if(!this.isAnyParentCollapsed(e)){const n=this.dataManager.getRowIndex(e);t.push(n),this.expandChildRows(n,t)}}))}n&&this.untrimRows(t)}expandChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];let i=null,s=null,r=null;return isNaN(e)?(i=e,s=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(i)&&Xl(i.__children,(e=>{const t=this.dataManager.getRowIndex(e);o.push(t)})),r=this.expandRows(o,!0,!1),n&&this.untrimRows(r),t&&this.renderAndAdjust(),r}expandMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];Xl(e,(e=>{o.push(...this.expandChildren(e,!1,!1))})),n&&this.untrimRows(o),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];Xl(e,(e=>{this.dataManager.hasChildren(e)&&t.push(e)})),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];Xl(e,(e=>{this.dataManager.hasChildren(e)&&t.push(e)})),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution((()=>{Xl(e,(e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}),!0)}untrimRows(e){this.hot.batchExecution((()=>{Xl(e,(e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}),!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&Xl(t.__children,(e=>{const t=this.dataManager.getRowIndex(e);if(!this.plugin.collapsedRowsMap.getValueAtIndex(t))return n=!1,!1})),n}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);const e=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(e)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const n=this.translateTrimmedRow(t.row);Na(e.target,rO.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),jc(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};const aO=new WeakMap;var hO=class extends iO{constructor(e,t){super(e,t),aO.set(this,{row_above:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(Np)},callback:()=>{const e=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),t=this.dataManager.getDataObject(e);this.dataManager.addChild(t)},disabled:()=>{const e=this.hot.getSelectedLast();return!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Pp)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const e=this.hot.getSelectedLast(),t=this.dataManager.translateTrimmedRow(e[0]);return!this.dataManager.getRowParent(t)||!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return _u(0,e.items.length-1,(n=>{if(0===n)return Xl(t,((t,o)=>{e.items.splice(n+o,0,t)})),!1})),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){const t=aO.get(this);return _u(0,e.items.length-1,(n=>{const o=t[e.items[n].key];null!=o&&(e.items[n].callback=o)})),e}};class cO{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,n,o){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:o}))return!1;this.movedToCollapsed=!1;const i=n===this.hot.countRows(),s=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let r=!0;const l=e.map((e=>{if(!r)return!1;const t=this.dataManager.translateTrimmedRow(e);return r=this.shouldAllowMoving(t,s),t})),a=-1===l.indexOf(s);if(!r||!a)return!1;const h=this.getBaseParent(l),c=this.getTargetParent(i,s),u=h===c;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(c),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(l,s,u),this.moveRows(l,s,c),this.dataManager.rewriteCache(),this.moveCellsMeta(l,s),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,o,o&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:n,dropIndex:o,movePossible:i}=e;let s=!1;return sa(o)&&(Kc(na`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,n,o,i,!1),s=!0),s}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let n=this.dataManager.getRowParent(e?t-1:t);return null==n&&(n=this.dataManager.getRowParent(t-1)),n}shiftCollapsibleParentsLocations(e,t,n){n||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,n){const o=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((()=>{e.forEach((e=>{this.dataManager.moveRow(e,t,this.movedToCollapsed,o)}))}))}moveCellsMeta(e,t){const n=[],o=Math.max(...e)<t;e.forEach((e=>{n.push(this.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(o?n.length:0),0,...n)}selectCells(e,t){const n=e.length;let o=0,i=0,s=null,r=null;if(this.movedToCollapsed){let s=null;s=e[n-1]<t?this.dataManager.translateTrimmedRow(t-n):this.dataManager.translateTrimmedRow(t);const r=this.dataManager.getRowParent(null===s?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(r);o=this.dataManager.untranslateTrimmedRow(l),i=o}else e[n-1]<t?(i=t-1,o=i-n+1):(o=t,i=o+n-1);s=this.hot.selection,r=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(o,0)),s.setRangeEnd(this.hot._createCellCoords(i,r),!0)}isRowOrderChanged(e,t){return e.some(((e,n)=>e-n!==t))}}const uO="nestedRows",dO=new WeakMap;class gO extends ov{static get PLUGIN_KEY(){return uO}static get PLUGIN_PRIORITY(){return 300}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,dO.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[uO]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new bm),this.dataManager=new oO(this,this.hot),this.collapsingUI=new lO(this,this.hot),this.headersUI=new rO(this,this.hot),this.contextMenuUI=new hO(this,this.hot),this.rowMoveController=new cO(this),this.addHook("afterInit",(function(){return e.onAfterInit(...arguments)})),this.addHook("beforeViewRender",(function(){return e.onBeforeViewRender(...arguments)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){return e.onFilterData(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions(...arguments)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader(...arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown(...arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow(...arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow(...arguments)})),this.addHook("beforeAddChild",(function(){return e.onBeforeAddChild(...arguments)})),this.addHook("afterAddChild",(function(){return e.onAfterAddChild(...arguments)})),this.addHook("beforeDetachChild",(function(){return e.onBeforeDetachChild(...arguments)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild(...arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return e.onModifyRowHeaderWidth(...arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow(...arguments)})),this.addHook("beforeRowMove",(function(){return e.onBeforeRowMove(...arguments)})),this.addHook("beforeLoadData",(e=>this.onBeforeLoadData(e))),this.addHook("beforeUpdateData",(e=>this.onBeforeLoadData(e))),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}onBeforeRowMove(e,t,n,o){return this.rowMoveController.onBeforeRowMove(e,t,n,o)}disableCoreAPIModifiers(){dO.get(this).skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){dO.get(this).skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,t,n){this.collapsingUI.toggleState(e,t,n)}onModifyRowData(e){if(!dO.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!dO.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,n){return!(!dO.get(this).skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,n),!1)}onFilterData(e,t,n){const o=dO.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),o.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,t){this.headersUI.appendLevelIndicators(e,t)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,t,n,o){if(o===this.pluginName)return;const i=dO.get(this);setTimeout((()=>{i.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}),0)}onBeforeRemoveRow(e,t,n){const o=Array.from(n.reduce(((e,t)=>{if(this.dataManager.isParent(t)){const n=this.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach((t=>e.add(this.dataManager.getRowIndex(t)))),e}return e.add(t)}),new Set));n.length=0,n.push(...o)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){const e=Math.max(...this.dataManager.cache.levels);e>0&&this.headersUI.updateRowHeaderWidth(e)}onBeforeViewRender(e,t){dO.get(this).skipRender&&(t.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){if(!sm(e))return qc("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[uO]=!1,void this.disablePlugin();this.dataManager.setData(e),this.dataManager.rewriteCache()}}var fO=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;this.rootWindow=t,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const n=void 0===e?t:e,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return null===o?void 0:JSON.parse(o)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Xl(this.savedKeys,((e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)})),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};nu.getSingleton().register("persistentStateSave"),nu.getSingleton().register("persistentStateLoad"),nu.getSingleton().register("persistentStateReset");const mO="persistentState";class pO extends ov{static get PLUGIN_KEY(){return mO}static get PLUGIN_PRIORITY(){return 0}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[mO]}enablePlugin(){this.enabled||(this.storage||(this.storage=new fO(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((e,t)=>this.saveValue(e,t))),this.addHook("persistentStateLoad",((e,t)=>this.loadValue(e,t))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}const wO="search",CO=function(e,t,n,o,i){e.getCellMeta(t,n).isSearchResult=i},yO=function(e,t,n){return!(sa(e)||null===e||!e.toLocaleLowerCase||0===e.length)&&(!sa(t)&&null!==t&&-1!==t.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale)))};class vO extends ov{static get PLUGIN_KEY(){return wO}static get PLUGIN_PRIORITY(){return 190}constructor(e){super(e),this.callback=CO,this.queryMethod=yO,this.searchResultClass="htSearchResult"}isEnabled(){return this.hot.getSettings()[wO]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[wO];this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){return e.onBeforeRenderer(...arguments)})),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){return e.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",t)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),i=this.hot.countCols(),s=[],r=this.hot;return _u(0,o-1,(o=>{_u(0,i-1,(i=>{const l=this.hot.getDataAtCell(o,i),a=this.hot.getCellMeta(o,i),h=a.search.callback||t,c=(a.search.queryMethod||n)(e,l,a);if(c){const e={row:o,col:i,data:l};s.push(e)}h&&h(r,o,i,l,c)}))})),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){uc(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}onBeforeRenderer(e,t,n,o,i,s){const r=s.className||[];let l=[];"string"==typeof r?l=r.split(" "):l.push(...r),this.isEnabled()&&s.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),s.className=l.join(" ")}destroy(){super.destroy()}}class bO extends ov{static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return ug()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>this.onAfterViewRender())),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>this.onBeforeTouchScroll())),this.addHook("afterMomentumScroll",(()=>this.onAfterMomentumScroll()))}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:n,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(n),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,Xl(this.clones,(e=>{Pa(e,"hide-tween")}))}onAfterMomentumScroll(){this.freezeOverlays=!1,Xl(this.clones,(e=>{La(e,"hide-tween"),Pa(e,"show-tween")})),this.hot._registerTimeout((()=>{Xl(this.clones,(e=>{La(e,"show-tween")}))}),400),Xl(this.scrollbars,(e=>{e.refresh(),e.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const SO="trimRows";class RO extends ov{static get PLUGIN_KEY(){return SO}static get PLUGIN_PRIORITY(){return 330}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[SO]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new bm),this.trimmedRowsMap.addLocalHook("init",(()=>this.onMapInit())),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[SO];Array.isArray(e)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),Xl(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let o=t;n&&(o=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeTrimRow",t,o,n)&&(n&&this.hot.batchExecution((()=>{Xl(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),this.hot.runHooks("afterTrimRow",t,o,n,n&&o.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let o=t;const i=this.trimmedRowsMap.getValues().slice(),s=e.length>0;n&&s&&(Xl(e,(e=>{i[e]=!1})),o=Gl(i,((e,t,n)=>(t&&e.push(n),e)),[]));!1!==this.hot.runHooks("beforeUntrimRow",t,o,n&&s)&&(n&&s&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,o,n&&s,n&&o.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}onMapInit(){const e=this.hot.getSettings()[SO];Array.isArray(e)&&this.hot.batchExecution((()=>{Xl(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0)}destroy(){super.destroy()}}const EO="undoRedo";function MO(e){const t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",(function(n,o){const i=n&&n.length;if(!i)return;if(!n.find((e=>{const[,,t,n]=e;return t!==n})))return;t.done((()=>{const t=n.reduce(((e,t)=>(e.push([...t]),e)),[]);Xl(t,(t=>{t[1]=e.propToCol(t[1])}));const o=i>1?this.getSelected():[[t[0][0],t[0][1]]];return new MO.ChangeAction(t,o)}),o)})),e.addHook("afterCreateRow",((e,n,o)=>{t.done((()=>new MO.CreateRowAction(e,n)),o)})),e.addHook("beforeRemoveRow",((n,o,i,s)=>{t.done((()=>{const i=e.toPhysicalRow(n),s=lc(t.instance.getSourceData(i,0,i+o-1,t.instance.countSourceCols()-1));return new MO.RemoveRowAction(i,s,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())}),s)})),e.addHook("afterCreateCol",((e,n,o)=>{t.done((()=>new MO.CreateColumnAction(e,n)),o)})),e.addHook("beforeRemoveCol",((n,o,i,s)=>{t.done((()=>{const i=t.instance.getSourceDataArray(),s=(t.instance.countCols()+n)%t.instance.countCols(),r=[],l=[],a=[];_u(i.length-1,(t=>{const n=[],l=i[t];_u(s,s+(o-1),(t=>{n.push(l[e.toPhysicalColumn(t)])})),r.push(n)})),_u(o-1,(t=>{a.push(e.toPhysicalColumn(s+t))})),Array.isArray(e.getSettings().colHeaders)&&_u(o-1,(t=>{l.push(e.getSettings().colHeaders[e.toPhysicalColumn(s+t)]||null)}));const h=e.columnIndexMapper.getIndexesSequence(),c=e.rowIndexMapper.getIndexesSequence();return new MO.RemoveColumnAction(s,a,r,l,h,c,e.getSettings().fixedColumnsStart)}),s)})),e.addHook("beforeCellAlignment",((e,n,o,i)=>{t.done((()=>new MO.CellAlignmentAction(e,n,o,i)))})),e.addHook("beforeFilter",(e=>{t.done((()=>new MO.FiltersAction(e)))})),e.addHook("beforeRowMove",((e,n)=>{!1!==e&&t.done((()=>new MO.RowMoveAction(e,n)))})),e.addHook("beforeMergeCells",((n,o)=>{o||t.done((()=>new MO.MergeCellsAction(e,n)))})),e.addHook("afterUnmergeCells",((n,o)=>{o||t.done((()=>new MO.UnmergeCellsAction(e,n)))})),e.addHook("afterInit",(()=>{t.init()}))}MO.prototype.done=function(e,t){if(this.ignoreNewActions)return;if("UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t)return;const n=this.doneActions.slice();if(!1===this.instance.runHooks("beforeUndoStackChange",n,t))return;const o=e(),i=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice())},MO.prototype.undo=function(){if(this.isUndoAvailable()){const e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=lc(t);if(!1===this.instance.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;const o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,(()=>{o.ignoreNewActions=!1,o.undoneActions.push(t)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},MO.prototype.redo=function(){if(this.isRedoAvailable()){const e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=lc(t);if(!1===this.instance.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;const o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,(()=>{o.ignoreNewActions=!1,o.doneActions.push(t)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},MO.prototype.isUndoAvailable=function(){return this.doneActions.length>0},MO.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},MO.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},MO.prototype.isEnabled=function(){return this.enabled},MO.prototype.enable=function(){if(this.isEnabled())return;const e=this.instance;var t;this.enabled=!0,(t=e).undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()},this.registerShortcuts(),e.addHook("afterChange",OO)},MO.prototype.disable=function(){if(!this.isEnabled())return;const e=this.instance;var t;this.enabled=!1,delete(t=e).undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo,this.unregisterShortcuts(),e.removeHook("afterChange",OO)},MO.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},MO.Action=function(){},MO.Action.prototype.undo=function(){},MO.Action.prototype.redo=function(){},MO.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},ic(MO.ChangeAction,MO.Action),MO.ChangeAction.prototype.undo=function(e,t){const n=lc(this.changes),o=e.countEmptyRows(!0),i=e.countEmptyCols(!0);for(let e=0,t=n.length;e<t;e++)n[e].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.undo");for(let t=0,s=n.length;t<s;t++){const[s,r]=n[t];e.getSettings().minSpareRows&&s+1+e.getSettings().minSpareRows===e.countRows()&&o===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(s+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&r+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(r+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)},MO.ChangeAction.prototype.redo=function(e,t){const n=lc(this.changes);for(let e=0,t=n.length;e<t;e++)n[e].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},MO.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},ic(MO.CreateRowAction,MO.Action),MO.CreateRowAction.prototype.undo=function(e,t){const n=e.countRows(),o=e.getSettings().minSpareRows;this.index>=n&&this.index-o<n&&(this.index-=o),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},MO.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},MO.RemoveRowAction=function(e,t,n,o,i){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=o,this.rowIndexesSequence=i},ic(MO.RemoveRowAction,MO.Action),MO.RemoveRowAction.prototype.undo=function(e,t){const n=e.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((e,t)=>{Object.keys(e).forEach((n=>{const i=parseInt(n,10);o.push([this.index+t,isNaN(i)?n:i,e[n]])}))})),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},MO.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},MO.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},ic(MO.CreateColumnAction,MO.Action),MO.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},MO.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},MO.RemoveColumnAction=function(e,t,n,o,i,s,r){this.index=e,this.indexes=t,this.data=n,this.amount=this.data[0].length,this.headers=o,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=r},ic(MO.RemoveColumnAction,MO.Action),MO.RemoveColumnAction.prototype.undo=function(e,t){e.getSettings().fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),o=(e,t,o)=>o[this.indexes.indexOf(n[t])],i=this.data.length,s=[];for(let e=0;e<i;e++)s.push(ql(this.data[e],o));const r=ql(this.headers,o),l=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Xl(e.getSourceDataArray(),((e,t)=>{Xl(n,((n,o)=>{e[n]=s[t][o],l.push([t,n,e[n]])}))})),e.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&Xl(r,((t,o)=>{e.getSettings().colHeaders[n[o]]=t})),e.batchExecution((()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),e.addHookOnce("afterViewRender",t),e.render()},MO.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},MO.CellAlignmentAction=function(e,t,n,o){this.stateBefore=e,this.range=t,this.type=n,this.alignment=o},MO.CellAlignmentAction.prototype.undo=function(e,t){Xl(this.range,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&e.setCellMeta(t,n,"className",this.stateBefore[t][n]||" htLeft")}))})),e.addHookOnce("afterViewRender",t),e.render()},MO.CellAlignmentAction.prototype.redo=function(e,t){Sb(this.range,this.type,this.alignment,((t,n)=>e.getCellMeta(t,n)),((t,n,o,i)=>e.setCellMeta(t,n,o,i))),e.addHookOnce("afterViewRender",t),e.render()},MO.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},ic(MO.FiltersAction,MO.Action),MO.FiltersAction.prototype.undo=function(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},MO.FiltersAction.prototype.redo=function(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class TO extends MO.Action{constructor(e,t){super(),this.cellRange=t;const n=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(n.row,n.col,o.row,o.col)}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();e.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}MO.MergeCellsAction=TO;class xO extends MO.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}function OO(e,t){if("loadData"===t)return this.undoRedo.clear()}MO.UnmergeCellsAction=xO,MO.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"},ic(MO.RowMoveAction,MO.Action),MO.RowMoveAction.prototype.undo=function(e,t){const n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter((e=>e>this.finalIndex)),s=o.filter((e=>e<=this.finalIndex)),r=i.sort(((e,t)=>t-e)).concat(s.sort(((e,t)=>e-t)));e.addHookOnce("afterViewRender",t);for(let t=0;t<r.length;t+=1){const o=e.toVisualRow(r[t]);n.moveRow(o,r[t])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},MO.RowMoveAction.prototype.redo=function(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},MO.prototype.init=function(){const e=this.instance.getSettings().undo,t=void 0===e||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},MO.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),t={runOnlyIf:e=>!e.altKey,group:EO};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],t)},MO.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(EO)};const AO=nu.getSingleton();var _O,IO,kO,HO,DO;AO.add("afterUpdateSettings",(function(){var e;null===(e=this.getPlugin("undoRedo"))||void 0===e||e.init()})),AO.register("beforeUndo"),AO.register("afterUndo"),AO.register("beforeRedo"),AO.register("afterRedo"),MO.PLUGIN_KEY="undoRedo",MO.SETTING_KEYS=!0,fu($C),fu(ry),fu(ly),fu(dy),fu(gy),fu(oy),fu(fy),fu(my),fu(Cy),fu(ZC),fu(yy),ed(by),ed(JC),ed(Oy),ed(vy),ed(ky),ed(Hy),ed(QC),ed(Dy),ld(Ny),ld(Fy),ld(By),ld(Uy),CC(jy),CC(zy),CC(Yy),CC($y),CC(Gy),CC(Ky),CC(qy),CC(ey),CC(Xy),Gu(cv),Gu(fv),Gu(pv),Gu(Mv),Gu(Pv),Gu(hb),Gu(gb),Gu(Nb),Gu(fS),Gu(sR),Gu(vR),Gu(SR),Gu(MR),Gu(NR),Gu(eM),Gu(ZM),Gu(sT),Gu(gT),Gu(pT),Gu(xT),Gu(IT),Gu(UT),Gu($T),Gu(nx),Gu(lx),Gu(ax),Gu(nO),Gu(gO),Gu(pO),Gu(vO),Gu(bO),Gu(RO),Gu(MO),function(e){const t="undefined"!=typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){const n=this.first();let o,i=n.data("handsontable");if("string"!=typeof t){const o=t||{};return i?i.updateSettings(o):(i=new e.Core(n[0],o),n.data("handsontable",i),i.init()),n}if(i){if(void 0===i[t])throw new Error(`Handsontable do not provide action: ${t}`);for(var s=arguments.length,r=new Array(s>1?s-1:0),l=1;l<s;l++)r[l-1]=arguments[l];o=i[t].call(i,...r),"destroy"===t&&n.removeData()}return o})}(ty),ty.__GhostTable=sv,ty._getListenersCounter=function(){return mu},ty._getRegisteredMapsCounter=function(){return Tm},ty.EventManager=pu;const NO=[ta,Nc,rm,Vy,fg,Th,Ca,Hu,yc,Ma,Uc,xu],PO=[yh,Gc];ty.helper={},ty.dom={},Xl(NO,(e=>{Xl(Object.getOwnPropertyNames(e),(t=>{"_"!==t.charAt(0)&&(ty.helper[t]=e[t])}))})),Xl(PO,(e=>{Xl(Object.getOwnPropertyNames(e),(t=>{"_"!==t.charAt(0)&&(ty.dom[t]=e[t])}))})),ty.cellTypes=null!==(_O=ty.cellTypes)&&void 0!==_O?_O:{},Xl(mC(),(e=>{ty.cellTypes[e]=wC(e)})),ty.cellTypes.registerCellType=CC,ty.cellTypes.getCellType=wC,ty.editors=null!==(IO=ty.editors)&&void 0!==IO?IO:{},Xl(hu(),(e=>{ty.editors[`${ya(e)}Editor`]=gu(e)})),ty.editors.registerEditor=fu,ty.editors.getEditor=gu,ty.renderers=null!==(kO=ty.renderers)&&void 0!==kO?kO:{},Xl(Zu(),(e=>{const t=Qu(e);"base"===e&&(ty.renderers.cellDecorator=t),ty.renderers[`${ya(e)}Renderer`]=t})),ty.renderers.registerRenderer=ed,ty.renderers.getRenderer=Qu,ty.validators=null!==(HO=ty.validators)&&void 0!==HO?HO:{},Xl(id(),(e=>{ty.validators[`${ya(e)}Validator`]=rd(e)})),ty.validators.registerValidator=ld,ty.validators.getValidator=rd,ty.plugins=null!==(DO=ty.plugins)&&void 0!==DO?DO:{},Xl(Yu(),(e=>{ty.plugins[e]=$u(e)})),ty.plugins[`${ya(ov.PLUGIN_KEY)}Plugin`]=ov,ty.plugins.registerPlugin=Gu,ty.plugins.getPlugin=$u;var LO=Object.freeze({__proto__:null,CellCoords:eg,CellRange:ag,default:ty});</script>
<script type="module">function t(t){this.init(t)}t.prototype.init=function(t){this.option=Object.assign({},{encoding:"16bitInt",channels:1,sampleRate:16e3},t),this.callback=this.option.callback,this.callbackTimeAhead=this.option.callbackTimeAhead,this.callbackOnEnd=this.option.callbackOnEnd,this.flush=this.flush.bind(this),this.maxValue=this.getMaxValue(),this.typedArray=this.getTypedArray(),this.playingBufferNode=null,this.scheduledBufferNode=null,this.createContext(),this.resetState()},t.prototype.getMaxValue=function(){var t={"8bitInt":128,"16bitInt":32768,"32bitInt":2147483648,"32bitFloat":1};return t[this.option.encoding]?t[this.option.encoding]:t["16bitInt"]},t.prototype.getTypedArray=function(){var t={"8bitInt":Int8Array,"16bitInt":Int16Array,"32bitInt":Int32Array,"32bitFloat":Float32Array};return t[this.option.encoding]?t[this.option.encoding]:t["16bitInt"]},t.prototype.createContext=function(){this.audioCtx=new(window.AudioContext||window.webkitAudioContext),this.audioCtx.resume(),this.audioCtx.onstatechange=()=>{this.audioCtx&&console.log("audioCtx.state",this.audioCtx.state)},(t=>{if(window.audioCtx=t,"suspended"!==t.state)return;const e=document.body,s=["touchstart","touchend","mousedown","keydown"];function n(){t.resume().then(i)}function i(){s.forEach((t=>e.removeEventListener(t,n)))}s.forEach((t=>e.addEventListener(t,n,!1)))})(this.audioCtx),this.gainNode=this.audioCtx.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioCtx.destination),this.startTime=this.audioCtx.currentTime},t.prototype.resetState=function(){this.playingStartTime=-1,this.lastGotTimestamp=0,this.samples=new Float32Array,this.timeout=void 0,this.flag_request_stop=!1,this.startTime=0},t.prototype.isTypedArray=function(t){return t.byteLength&&t.buffer&&t.buffer.constructor==ArrayBuffer},t.prototype.feed=function(t){if(this.isTypedArray(t)){t=this.getFormatedValue(t);var e=new Float32Array(this.samples.length+t.length);e.set(this.samples,0),e.set(t,this.samples.length),this.samples=e,this.timeout||this.flush()}},t.prototype.getFormatedValue=function(t){t=new this.typedArray(t.buffer);var e,s=new Float32Array(t.length);for(e=0;e<t.length;e++)s[e]=t[e]/this.maxValue;return s},t.prototype.volume=function(t){this.gainNode.gain.value=t},t.prototype.destroy=function(){this.interval&&clearInterval(this.interval),this.samples=null,this.audioCtx.close(),this.audioCtx=null},t.prototype.getTimestamp=function(t){if(this.playingStartTime>=0){if(!t)return this.audioCtx.currentTime-this.playingStartTime;const e=this.lastGotTimestamp;return this.lastGotTimestamp+=t/1e3,e}return 0},t.prototype.setRequestStop=function(){this.flag_request_stop=!0},t.prototype.setOnEnd=function(t){this.onEnd=t},t.prototype.interrupt=function(t){this.scheduledBufferNode&&this.scheduledBufferNode.stop(0),this.playingBufferNode&&this.playingBufferNode.stop(0),this.ensuredClearTimeout(),this.resetState(),this.flag_request_stop=!1},t.prototype.ensuredSetTimeout=function(){let t;return function(e,s,n,i){let o;if(t=performance.now(),n){let r=!1;o=a=>{a-t>=i&&!r&&(r=!0,n(a)),a-t>=s?(this.timeout=void 0,e()):this.timeout=requestAnimationFrame(o)}}else o=n=>{n-t>=s?(this.timeout=void 0,e()):this.timeout=requestAnimationFrame(o)};this.timeout=requestAnimationFrame(o)}}(),t.prototype.ensuredClearTimeout=function(){this.timeout&&(cancelAnimationFrame(this.timeout),this.timeout=void 0)},t.prototype.flush=function(){if(console.log("flush"),!this.samples.length)return console.warn("End"),void(this.callbackOnEnd&&(console.warn("End"),this.callbackOnEnd(!1)));var t,e,s,n,i,o=this.audioCtx.createBufferSource(),r=this.samples.length/this.option.channels,a=this.audioCtx.createBuffer(this.option.channels,r,this.option.sampleRate);for(e=0;e<this.option.channels;e++)for(t=a.getChannelData(e),s=e,i=50,n=0;n<r;n++)t[n]=this.samples[s],n<50&&(t[n]=t[n]*n/50),n>=r-51&&(t[n]=t[n]*i--/50),s+=this.option.channels;if(this.startTime<this.audioCtx.currentTime&&(this.startTime=this.audioCtx.currentTime),this.samples=new Float32Array,o.buffer=a,o.connect(this.gainNode),o.start(this.startTime),this.playingBufferNode=this.scheduledBufferNode,this.scheduledBufferNode=o,this.playingStartTime<0&&(this.playingStartTime=this.startTime),this.startTime+=a.duration,this.flag_request_stop)this.flag_request_stop=!1,o.onended=()=>{this.resetState(),this.onEnd&&this.onEnd()};else{const t=1e3*(this.startTime-this.audioCtx.currentTime);this.ensuredSetTimeout(this.flush,t-50,this.callback,t-this.callbackTimeAhead-50)}};const e={SignedInteger16:{type:"16bitInt",format:Int16Array},SignedInteger8:{type:"8bitInt",format:Int8Array},SignedInteger32:{type:"32bitInt",format:Int32Array}};core.SampleRate=()=>"SampleRate";const s={List:(t,e)=>t.map((t=>interpretate(t,e)))};s.List.update=s.List,core.PCMPlayer=async(n,i)=>{let o;const r=await core._getRules(n,i);let a;n.length-Object.keys(r).length>2?(console.warn("Using stored offline"),interpretate(n[0],{...i}),o=await interpretate(n[1],{...i,context:s}),a=await interpretate(n[2],i)):(o=await interpretate(n[0],{...i}),a=await interpretate(n[1],i)),"AutoPlay"in r||(r.AutoPlay=!0),"GUI"in r||(r.GUI=!0),"SampleRate"in r||(r.SampleRate=44100),i.element||(r.GUI=!1);let c,h,l=e[a];console.warn(l),r.FlushingTime&&(r.FlushingTime=r.FlushingTime/1e3),r.Event&&(c=t=>{server.kernel.emitt(r.Event,t,"More")}),i.local.state=()=>{},h=r.AutoRemove?()=>{console.warn("Autoremove!"),i.root.dispose()}:i.local.state;var u=new t({encoding:l.type,channels:1,sampleRate:r.SampleRate||44100,callback:c,callbackOnEnd:t=>h(t),callbackTimeAhead:r.TimeAhead||200});i.local.encoding=l.format,i.local.player=u;let p=!1;if(!i.noAutoplay&&r.AutoPlay&&(p=!0,o.length>1?u.feed(new l.format(o)):o instanceof NumericArrayObject?u.feed(o.buffer):r.Event&&c(0)),!r.NoGUI&&r.GUI)if(i.element.classList.add(..."sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-100 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs flex flex-col".split(" ")),o.length||o instanceof NumericArrayObject){const t=uuidv4(),e=r.FullLength||o.length||o.buffer.length;let s="hidden",n="";p||(n="hidden",s="");let a="";r.DataOnKernel&&(a="Data is on Kernel"),i.element.innerHTML=`\n    <div class="flex-row flex items-center"><svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none">\n<path class="group-hover:opacity-0" d="M3 11V13M6 10V14M9 11V13M12 9\nV15M15 6V18M18 10V14M21 11V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M3 11V13M6 8V16M9 10V14M12 7V17M15 4V20M18 9V15M21 11V13" class="opacity-0 group-hover:opacity-100" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg> <button id="${t}-stop" class="px-1 ${n}"><svg fill="currentColor" class="w-3 h-3" viewBox="0 0 256 256"> <path d="M48.227 65.473c0-9.183 7.096-16.997 16.762-17.51 9.666-.513 116.887-.487 125.094-.487 8.207 0 17.917 9.212 17.917 17.71 0 8.499.98 117.936.49 126.609-.49 8.673-9.635 15.995-17.011 15.995-7.377 0-117.127-.327-126.341-.327-9.214 0-17.472-7.793-17.192-16.1.28-8.306.28-116.708.28-125.89zm15.951 4.684c-.153 3.953 0 112.665 0 116.19 0 3.524 3.115 5.959 7.236 6.156 4.12.198 112.165.288 114.852 0 2.686-.287 5.811-2.073 5.932-5.456.12-3.383-.609-113.865-.609-116.89 0-3.025-3.358-5.84-6.02-5.924-2.662-.085-110.503 0-114.155 0-3.652 0-7.083 1.972-7.236 5.924z" fill-rule="evenodd"/>\n</svg></button>\n<button id="${t}-play" class="px-1 ${s}"><svg fill="currentColor" class="w-3 h-3" viewBox="0 0 24 24"><path d="M16.6582 9.28638C18.098 10.1862 18.8178 10.6361 19.0647 11.2122C19.2803 11.7152 19.2803 12.2847 19.0647 12.7878C18.8178 13.3638 18.098 13.8137 16.6582 14.7136L9.896 18.94C8.29805 19.9387 7.49907 20.4381 6.83973 20.385C6.26501 20.3388 5.73818 20.0469 5.3944 19.584C5 19.053 5 18.1108 5 16.2264V7.77357C5 5.88919 5 4.94701 5.3944 4.41598C5.73818 3.9531 6.26501 3.66111 6.83973 3.6149C7.49907 3.5619 8.29805 4.06126 9.896 5.05998L16.6582 9.28638Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg></button><span id="${t}-text" class="leading-normal pl-1">${(e/r.SampleRate).toFixed(2)} sec</span></div><div class="text-xs text-gray-400">${a}</div>`;const c=document.getElementById(t+"-play"),h=document.getElementById(t+"-stop");i.local.prevState=!1,c.addEventListener("click",(()=>{i.local.prevState||(c.classList.add("hidden"),h.classList.remove("hidden"),i.local.state(!0),o instanceof NumericArrayObject?u.feed(o.buffer):u.feed(new l.format(o)))})),h.addEventListener("click",(()=>{h.classList.add("hidden"),u.interrupt(),r.Event&&server.kernel.emitt(r.Event,"True","Stop"),i.local.state(!1),c.classList.remove("hidden")}));const d=document.getElementById(t+"-text");i.local.state=(t=!1)=>{i.local.prevState!=t&&(d.innerText=t?"Playing":"Stopped",i.local.prevState=t)}}else{const t=uuidv4();i.element.innerHTML=`\n    <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none">\n<path id="${t}-ico" d="M3 11V13M6 8V16M9 10V14M12 7V17M15 4V20M18 9V15M21 11V13" class="text-red-400" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg> <span class="leading-normal pl-1" id="${t}-text">No buffer</span>`;const e=document.getElementById(t+"-ico"),s=document.getElementById(t+"-text");i.local.state=(t=!1)=>{i.local.prevState!=t&&(t?(e.classList.remove("text-red-400"),e.classList.add("text-green-400"),s.innerText="Playing"):(e.classList.add("text-red-400"),e.classList.remove("text-green-400"),s.innerText="No buffer"),i.local.prevState=t)}}},core.PCMPlayer.update=async(t,e)=>{const n=await interpretate(t[0],{...e,context:s});e.local.state(!0),n instanceof NumericArrayObject?e.local.player.feed(n.buffer):e.local.player.feed(new e.local.encoding(n))},core.PCMPlayer.destroy=(t,e)=>{e.local.player.destroy()},core.PCMPlayer.virtual=!0;const n={name:"Sound"};interpretate.contextExpand(n);const i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];let o,r;n.SoundNote=async(t,e)=>{if(e.hold)return e=>n.SoundNote(t,e);let s=await interpretate(t[0],e),o=await interpretate(t[1],e);o||(o="4n");const r=t=>{let s=t;if("string"==typeof s)s.charAt(s.length-1)<10||(s+="4");else{if("number"!=typeof s)throw console.warn(s),"Not supported!";console.log(s),console.log(s),s=i[Math.abs(s%i.length)]+String(3+Math.floor(s/12)),console.log()}Array.isArray(o)?(e.synth.triggerAttackRelease(s,o[1]-o[0],o[0]),console.log(o[1]-o[0])):e.synth.triggerAttackRelease(s,o,e.now)};Array.isArray(s)?s.map(r):r(s),e.now+=.5},n.SampledSoundFunction=async(t,e)=>{},n.Sound=async(t,e)=>{o||(o=await Promise.resolve().then((function(){return Nc}))),r||(r=new o.PolySynth(o.Synth).set({volume:-8}).toDestination());const s=await interpretate(t[0],{...e,context:n,Tone:o,hold:!0});if(e.element&&(e.element.classList.add(..."sm-controls cursor-default rounded-md 0 py-1 px-2 bg-gray-100 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs".split(" ")),e.element.innerHTML=`\n         <svg class="w-4 h-4 text-gray-500 inline-block mt-auto mb-auto" viewBox="0 0 24 24" fill="none">\n     <path class="group-hover:opacity-0" d="M3 11V13M6 10V14M9 11V13M12 9\n  V15M15 6V18M18 10V14M21 11V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n     <path d="M3 11V13M6 8V16M9 10V14M12 7V17M15 4V20M18 9V15M21 11V13" class="opacity-0 group-hover:opacity-100" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n     </svg> <span class="leading-normal pl-1">${s.length} sec</span>`),null!=(i=s)&&"number"==typeof i.length&&"number"==typeof i.sampleRate&&"function"==typeof i.getChannelData&&"number"==typeof i.duration){const t=await new o.Player(s).toDestination();return t.fadeOut=.05,t.fadeIn=.01,void(e.element?e.element.addEventListener("click",(()=>t.start())):t.start())}var i;const a=async()=>{console.log("Play!"),e.synth=r,e.synth.releaseAll();const t=e.synth,i=o.now();if(e.synth=t,e.now=i,Array.isArray(s)){const t={...e,context:n};for(const e of s)console.log(e),interpretate(e,t)}else s({...e,context:n})};e.element?e.element.addEventListener("click",a):a()},n.SampledSoundList=async(t,e)=>{const s=await interpretate(t[0],e),n=8e3|await interpretate(t[1],e);s.length;const i=e.Tone.context.createBuffer(1,s.length,n);return i.copyToChannel(new Float32Array(s),0),i};const a="15.0.4",c=(t,e,s)=>({endTime:e,insertTime:s,type:"exponentialRampToValue",value:t}),h=(t,e,s)=>({endTime:e,insertTime:s,type:"linearRampToValue",value:t}),l=(t,e)=>({startTime:e,type:"setValue",value:t}),u=(t,e,s)=>({duration:s,startTime:e,type:"setValueCurve",values:t}),p=(t,e,{startTime:s,target:n,timeConstant:i})=>n+(e-n)*Math.exp((s-t)/i),d=t=>"exponentialRampToValue"===t.type,f=t=>"linearRampToValue"===t.type,m=t=>d(t)||f(t),_=t=>"setValue"===t.type,g=t=>"setValueCurve"===t.type,y=(t,e,s,n)=>{const i=t[e];return void 0===i?n:m(i)||_(i)?i.value:g(i)?i.values[i.values.length-1]:p(s,y(t,e-1,i.startTime,n),i)},v=(t,e,s,n,i)=>void 0===s?[n.insertTime,i]:m(s)?[s.endTime,s.value]:_(s)?[s.startTime,s.value]:g(s)?[s.startTime+s.duration,s.values[s.values.length-1]]:[s.startTime,y(t,e-1,s.startTime,i)],x=t=>"cancelAndHold"===t.type,w=t=>"cancelScheduledValues"===t.type,b=t=>x(t)||w(t)?t.cancelTime:d(t)||f(t)?t.endTime:t.startTime,T=(t,e,s,{endTime:n,value:i})=>s===i?i:0<s&&0<i||s<0&&i<0?s*(i/s)**((t-e)/(n-e)):0,S=(t,e,s,{endTime:n,value:i})=>s+(t-e)/(n-e)*(i-s),k=(t,{duration:e,startTime:s,values:n})=>((t,e)=>{const s=Math.floor(e),n=Math.ceil(e);return s===n?t[s]:(1-(e-s))*t[s]+(1-(n-e))*t[n]})(n,(t-s)/e*(n.length-1)),A=t=>"setTarget"===t.type;class C{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){const e=b(t);if(x(t)||w(t)){const s=this._automationEvents.findIndex((s=>w(t)&&g(s)?s.startTime+s.duration>=e:b(s)>=e)),n=this._automationEvents[s];if(-1!==s&&(this._automationEvents=this._automationEvents.slice(0,s)),x(t)){const t=this._automationEvents[this._automationEvents.length-1];if(void 0!==n&&m(n)){if(void 0!==t&&A(t))throw new Error("The internal list is malformed.");const s=void 0===t?n.insertTime:g(t)?t.startTime+t.duration:b(t),i=void 0===t?this._defaultValue:g(t)?t.values[t.values.length-1]:t.value,o=d(n)?T(e,s,i,n):S(e,s,i,n),r=d(n)?c(o,e,this._currenTime):h(o,e,this._currenTime);this._automationEvents.push(r)}if(void 0!==t&&A(t)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==t&&g(t)&&t.startTime+t.duration>e){const s=e-t.startTime,n=(t.values.length-1)/t.duration,i=Math.max(2,1+Math.ceil(s*n)),o=s/(i-1)*n,r=t.values.slice(0,i);if(o<1)for(let e=1;e<i;e+=1){const s=o*e%1;r[e]=t.values[e-1]*(1-s)+t.values[e]*s}this._automationEvents[this._automationEvents.length-1]=u(r,t.startTime,s)}}}else{const s=this._automationEvents.findIndex((t=>b(t)>e)),n=-1===s?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[s-1];if(void 0!==n&&g(n)&&b(n)+n.duration>e)return!1;const i=d(t)?c(t.value,t.endTime,this._currenTime):f(t)?h(t.value,e,this._currenTime):t;if(-1===s)this._automationEvents.push(i);else{if(g(t)&&e+t.duration>b(this._automationEvents[s]))return!1;this._automationEvents.splice(s,0,i)}}return!0}flush(t){const e=this._automationEvents.findIndex((e=>b(e)>t));if(e>1){const t=this._automationEvents.slice(e-1),s=t[0];A(s)&&t.unshift(l(y(this._automationEvents,e-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=t}}getValue(t){if(0===this._automationEvents.length)return this._defaultValue;const e=this._automationEvents.findIndex((e=>b(e)>t)),s=this._automationEvents[e],n=(-1===e?this._automationEvents.length:e)-1,i=this._automationEvents[n];if(void 0!==i&&A(i)&&(void 0===s||!m(s)||s.insertTime>t))return p(t,y(this._automationEvents,n-1,i.startTime,this._defaultValue),i);if(void 0!==i&&_(i)&&(void 0===s||!m(s)))return i.value;if(void 0!==i&&g(i)&&(void 0===s||!m(s)||i.startTime+i.duration>t))return t<i.startTime+i.duration?k(t,i):i.values[i.values.length-1];if(void 0!==i&&m(i)&&(void 0===s||!m(s)))return i.value;if(void 0!==s&&d(s)){const[e,o]=v(this._automationEvents,n,i,s,this._defaultValue);return T(t,e,o,s)}if(void 0!==s&&f(s)){const[e,o]=v(this._automationEvents,n,i,s,this._defaultValue);return S(t,e,o,s)}return this._defaultValue}}const O=new WeakSet,M=new WeakMap,D=new WeakMap,E=new WeakMap,R=new WeakMap,q=new WeakMap,I=new WeakMap,V=new WeakMap,F=new WeakMap,N=new WeakMap,P={construct:()=>P},j=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,L=(t,e)=>{const s=[];let n=t.replace(/^[\s]+/,""),i=n.match(j);for(;null!==i;){const t=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());s.push(o),n=n.slice(i[0].length).replace(/^[\s]+/,""),i=n.match(j)}return[s.join(";"),n]},z=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},B=t=>{if(!(t=>{try{new new Proxy(t,P)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},W=(t,e)=>{const s=t.get(e);if(void 0===s)throw new Error("A value with the given key could not be found.");return s},G=(t,e)=>{const s=Array.from(t).filter(e);if(s.length>1)throw Error("More than one element was found.");if(0===s.length)throw Error("No element was found.");const[n]=s;return t.delete(n),n},U=(t,e,s,n)=>{const i=W(t,e),o=G(i,(t=>t[0]===s&&t[1]===n));return 0===i.size&&t.delete(e),o},Q=t=>W(I,t),Z=t=>{if(O.has(t))throw new Error("The AudioNode is already stored.");O.add(t),Q(t).forEach((t=>t(!0)))},X=t=>"port"in t,Y=t=>{if(!O.has(t))throw new Error("The AudioNode is not stored.");O.delete(t),Q(t).forEach((t=>t(!1)))},$=(t,e)=>{!X(t)&&e.every((t=>0===t.size))&&Y(t)},H={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},J=(t,e)=>t.context===e,K=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},tt=()=>new DOMException("","IndexSizeError"),et=t=>{var e;t.getChannelData=(e=t.getChannelData,s=>{try{return e.call(t,s)}catch(t){if(12===t.code)throw tt();throw t}})},st={numberOfChannels:1},nt=-34028234663852886e22,it=-nt,ot=t=>O.has(t),rt={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},at=t=>W(M,t),ct=t=>W(E,t),ht=(t,e)=>{const{activeInputs:s}=at(t);s.forEach((s=>s.forEach((([s])=>{e.includes(t)||ht(s,[...e,t])}))));const n=(t=>"playbackRate"in t)(t)?[t.playbackRate]:X(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of n){const s=ct(t);void 0!==s&&s.activeInputs.forEach((([t])=>ht(t,e)))}ot(t)&&Y(t)},lt=t=>{ht(t.destination,[])},ut=t=>"context"in t,pt=t=>ut(t[0]),dt=(t,e,s,n)=>{for(const e of t)if(s(e)){if(n)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},ft=(t,e,[s,n],i)=>{dt(t,[e,s,n],(t=>t[0]===e&&t[1]===s),i)},mt=(t,[e,s,n],i)=>{const o=t.get(e);void 0===o?t.set(e,new Set([[s,n]])):dt(o,[s,n],(t=>t[0]===s),i)},_t=t=>"inputs"in t,gt=(t,e,s,n)=>{if(_t(e)){const i=e.inputs[n];return t.connect(i,s,0),[i,s,0]}return t.connect(e,s,n),[e,s,n]},yt=(t,e,s)=>{for(const n of t)if(n[0]===e&&n[1]===s)return t.delete(n),n;return null},vt=(t,e)=>{if(!Q(t).delete(e))throw new Error("Missing the expected event listener.")},xt=(t,e,s)=>{const n=W(t,e),i=G(n,(t=>t[0]===s));return 0===n.size&&t.delete(e),i},wt=(t,e,s,n)=>{_t(e)?t.disconnect(e.inputs[n],s,0):t.disconnect(e,s,n)},bt=t=>W(D,t),Tt=t=>W(R,t),St=t=>V.has(t),kt=t=>!O.has(t),At=(t,e)=>new Promise((s=>{if(null!==e)s(!0);else{const e=t.createScriptProcessor(256,1,1),n=t.createGain(),i=t.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const r=t.createBufferSource();r.buffer=i,r.loop=!0,r.connect(e).connect(t.destination),r.connect(n),r.disconnect(n),e.onaudioprocess=n=>{const i=n.inputBuffer.getChannelData(0);Array.prototype.some.call(i,(t=>1===t))?s(!0):s(!1),r.stop(),e.onaudioprocess=null,r.disconnect(e),e.disconnect(t.destination)},r.start()}})),Ct=(t,e)=>{const s=new Map;for(const e of t)for(const t of e){const e=s.get(t);s.set(t,void 0===e?1:e+1)}s.forEach(((t,s)=>e(s,t)))},Ot=t=>"context"in t,Mt=(t,e,s,n)=>{const{activeInputs:i,passiveInputs:o}=ct(e),{outputs:r}=at(t),a=Q(t),c=r=>{const a=bt(t),c=Tt(e);if(r){const e=xt(o,t,s);ft(i,t,e,!1),n||St(t)||a.connect(c,s)}else{const e=((t,e,s)=>G(t,(t=>t[0]===e&&t[1]===s)))(i,t,s);mt(o,e,!1),n||St(t)||a.disconnect(c,s)}};return!!dt(r,[e,s],(t=>t[0]===e&&t[1]===s),!0)&&(a.add(c),ot(t)?ft(i,t,[s,c],!0):mt(o,[t,s,c],!0),!0)},Dt=(t,e,s,n,i)=>{const[o,r]=((t,e,s,n)=>{const{activeInputs:i,passiveInputs:o}=at(e),r=yt(i[n],t,s);if(null===r)return[U(o,t,s,n)[2],!1];return[r[2],!0]})(t,s,n,i);if(null!==o&&(vt(t,o),!r||e||St(t)||wt(bt(t),bt(s),n,i)),ot(s)){const{activeInputs:t}=at(s);$(s,t)}},Et=(t,e,s,n)=>{const[i,o]=((t,e,s)=>{const{activeInputs:n,passiveInputs:i}=ct(e),o=yt(n,t,s);if(null===o)return[xt(i,t,s)[1],!1];return[o[2],!0]})(t,s,n);null!==i&&(vt(t,i),!o||e||St(t)||bt(t).disconnect(Tt(s),n))};class Rt{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((s,n)=>t.call(e,s,n,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const qt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function It(t,e,s,n,i){if("function"==typeof t.copyFromChannel)0===e[s].byteLength&&(e[s]=new Float32Array(128)),t.copyFromChannel(e[s],n,i);else{const o=t.getChannelData(n);if(0===e[s].byteLength)e[s]=o.slice(i,i+128);else{const t=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[s].set(t)}}}const Vt=(t,e,s,n,i)=>{"function"==typeof t.copyToChannel?0!==e[s].byteLength&&t.copyToChannel(e[s],n,i):0!==e[s].byteLength&&t.getChannelData(n).set(e[s],i)},Ft=(t,e)=>{const s=[];for(let n=0;n<t;n+=1){const t=[],i="number"==typeof e?e:e[n];for(let e=0;e<i;e+=1)t.push(new Float32Array(128));s.push(t)}return s},Nt=async(t,e,s,n,i,o,r)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,c=n.channelCount*n.numberOfInputs,h=i.reduce(((t,e)=>t+e),0),l=0===h?null:s.createBuffer(h,a,s.sampleRate);if(void 0===o)throw new Error("Missing the processor constructor.");const u=at(t),p=await((t,e)=>{const s=W(N,t),n=bt(e);return W(s,n)})(s,t),d=Ft(n.numberOfInputs,n.channelCount),f=Ft(n.numberOfOutputs,i),m=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let h=0;h<a;h+=128){if(n.numberOfInputs>0&&null!==e)for(let t=0;t<n.numberOfInputs;t+=1)for(let s=0;s<n.channelCount;s+=1)It(e,d[t],s,s,h);void 0!==o.parameterDescriptors&&null!==e&&o.parameterDescriptors.forEach((({name:t},s)=>{It(e,m,t,c+s,h)}));for(let t=0;t<n.numberOfInputs;t+=1)for(let e=0;e<i[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=d.map(((t,e)=>0===u.activeInputs[e].size?[]:t)),e=r(h/s.sampleRate,s.sampleRate,(()=>p.process(t,f,m)));if(null!==l)for(let t=0,e=0;t<n.numberOfOutputs;t+=1){for(let s=0;s<i[t];s+=1)Vt(l,f[t],s,e+s,h);e+=i[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return l},Pt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},jt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Lt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},zt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Bt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Wt=t=>{const{port1:e,port2:s}=new MessageChannel;return new Promise((n=>{const i=()=>{s.onmessage=null,e.close(),s.close(),n()};s.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}}))},Gt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ut=(t,e,s)=>{const n=e[s];if(void 0===n)throw t();return n},Qt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Zt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Xt=()=>new DOMException("","InvalidStateError"),Yt=()=>new DOMException("","InvalidAccessError"),$t={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Ht=(t,e,s,n,i,o,r,a,c,h,l)=>{const u=h.length;let p=a;for(let a=0;a<u;a+=1){let u=s[0]*h[a];for(let e=1;e<i;e+=1){const n=p-e&c-1;u+=s[e]*o[n],u-=t[e]*r[n]}for(let t=i;t<n;t+=1)u+=s[t]*o[p-t&c-1];for(let s=i;s<e;s+=1)u-=t[s]*r[p-s&c-1];o[p]=h[a],r[p]=u,p=p+1&c-1,l[a]=u}return p},Jt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Kt=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const s=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==s&&(s.catch((()=>{})),!0)}catch{}return!1},te=(t,e,s)=>{const n=e[s];void 0!==n&&n!==t[s]&&(t[s]=n)},ee=(t,e)=>{te(t,e,"channelCount"),te(t,e,"channelCountMode"),te(t,e,"channelInterpretation")},se=t=>"function"==typeof t.getFloatTimeDomainData,ne=(t,e,s)=>{const n=e[s];void 0!==n&&n!==t[s].value&&(t[s].value=n)},ie=t=>{t.start=(e=>(s=0,n=0,i)=>{if("number"==typeof i&&i<0||n<0||s<0)throw new RangeError("The parameters can't be negative.");e.call(t,s,n,i)})(t.start)},oe=t=>{var e;t.stop=(e=t.stop,(s=0)=>{if(s<0)throw new RangeError("The parameter can't be negative.");e.call(t,s)})},re=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),ae=async(t,e)=>{const s=await(t=>new Promise(((e,s)=>{const{port1:n,port2:i}=new MessageChannel;n.onmessage=({data:t})=>{n.close(),i.close(),e(t)},n.onmessageerror=({data:t})=>{n.close(),i.close(),s(t)},i.postMessage(t)})))(e);return new t(s)},ce=(t,e)=>{const s=t.createBiquadFilter();return ee(s,e),ne(s,e,"Q"),ne(s,e,"detune"),ne(s,e,"frequency"),ne(s,e,"gain"),te(s,e,"type"),s},he=(t,e)=>{const s=t.createChannelSplitter(e.numberOfOutputs);return ee(s,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Xt()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw Xt()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw Xt()}})})(s),s},le=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),ue=(t,e)=>{const s=t.createDelay(e.maxDelayTime);return ee(s,e),ne(s,e,"delayTime"),s},pe=(t,e)=>{const s=t.createGain();return ee(s,e),ne(s,e,"gain"),s};function de(t,e){const s=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/s,(t[1]*e[0]-t[0]*e[1])/s]}function fe(t,e){let s=[0,0];for(let o=t.length-1;o>=0;o-=1)i=e,s=[(n=s)[0]*i[0]-n[1]*i[1],n[0]*i[1]+n[1]*i[0]],s[0]+=t[o];var n,i;return s}const me=(t,e,s,n)=>t.createScriptProcessor(e,s,n),_e=()=>new DOMException("","NotSupportedError"),ge={numberOfChannels:1},ye={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},ve={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},xe={disableNormalization:!1},we={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},be={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Te=(t,e,s)=>void 0===t.copyFromChannel?t.getChannelData(s)[0]:(t.copyFromChannel(e,s),e[0]),Se=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},ke=(t,e,s,n)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:r}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:s(o),set:n(r)})},Ae=(t,e,s)=>{try{t.setValueAtTime(e,s)}catch(n){if(9!==n.code)throw n;Ae(t,e,s+1e-7)}},Ce=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},Oe=t=>{const e=t.createBuffer(1,1,44100),s=t.createBufferSource();s.buffer=e,s.start(),s.stop();try{return s.stop(),!0}catch{return!1}},Me=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},De=()=>{try{new DOMException}catch{return!1}return!0},Ee=()=>new Promise((t=>{const e=new ArrayBuffer(0),{port1:s,port2:n}=new MessageChannel;s.onmessage=({data:e})=>t(null!==e),n.postMessage(e,[e])})),Re=(t,e)=>{const s=e.createGain();t.connect(s);const n=(e=>()=>{e.call(t,s),t.removeEventListener("ended",n)})(t.disconnect);t.addEventListener("ended",n),le(t,s),t.stop=(e=>{let n=!1;return(i=0)=>{if(n)try{e.call(t,i)}catch{s.gain.setValueAtTime(0,i)}else e.call(t,i),n=!0}})(t.stop)},qe=(t,e)=>s=>{const n={value:t};return Object.defineProperties(s,{currentTarget:n,target:n}),"function"==typeof e?e.call(t,s):e.handleEvent.call(t,s)},Ie=(t=>(e,s,[n,i,o],r)=>{t(e[i],[s,n,o],(t=>t[0]===s&&t[1]===n),r)})(dt),Ve=(t=>(e,s,[n,i,o],r)=>{const a=e.get(n);void 0===a?e.set(n,new Set([[i,s,o]])):t(a,[i,s,o],(t=>t[0]===i&&t[1]===s),r)})(dt),Fe=(t=>(e,s,n,i)=>t(e[i],(t=>t[0]===s&&t[1]===n)))(G),Ne=new WeakMap,Pe=(t=>e=>{var s;return null!==(s=t.get(e))&&void 0!==s?s:0})(Ne),je=(Le=new Map,ze=new WeakMap,(t,e)=>{const s=ze.get(t);if(void 0!==s)return s;const n=Le.get(t);if(void 0!==n)return n;try{const s=e();return s instanceof Promise?(Le.set(t,s),s.catch((()=>!1)).then((e=>(Le.delete(t),ze.set(t,e),e)))):(ze.set(t,s),s)}catch{return ze.set(t,!1),!1}});var Le,ze;const Be="undefined"==typeof window?null:window,We=((t,e)=>(s,n)=>{const i=s.createAnalyser();if(ee(i,n),!(n.maxDecibels>n.minDecibels))throw e();return te(i,n,"fftSize"),te(i,n,"maxDecibels"),te(i,n,"minDecibels"),te(i,n,"smoothingTimeConstant"),t(se,(()=>se(i)))||(t=>{t.getFloatTimeDomainData=e=>{const s=new Uint8Array(e.length);t.getByteTimeDomainData(s);const n=Math.max(s.length,t.fftSize);for(let t=0;t<n;t+=1)e[t]=.0078125*(s[t]-128);return e}})(i),i})(je,tt),Ge=(t=>e=>{const s=t(e);if(null===s.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return s.renderer})(at),Ue=((t,e,s)=>async(n,i,o)=>{const r=t(n);await Promise.all(r.activeInputs.map(((t,r)=>Array.from(t).map((async([t,a])=>{const c=e(t),h=await c.render(t,i),l=n.context.destination;s(t)||n===l&&s(n)||h.connect(o,a,r)})))).reduce(((t,e)=>[...t,...e]),[]))})(at,Ge,St),Qe=((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o){const r=n.get(o);return void 0!==r?Promise.resolve(r):(async(i,o)=>{let r=e(i);if(!J(r,o)){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,fftSize:r.fftSize,maxDecibels:r.maxDecibels,minDecibels:r.minDecibels,smoothingTimeConstant:r.smoothingTimeConstant};r=t(o,e)}return n.set(o,r),await s(i,o,r),r})(i,o)}}})(We,bt,Ue),Ze=(Xe=q,t=>{const e=Xe.get(t);if(void 0===e)throw Xt();return e});var Xe;const Ye=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(Be),$e=(t=>e=>null!==t&&e instanceof t)(Ye),He=new WeakMap,Je=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,s,n){if(null!==s){let i=this._listeners.get(s);void 0===i&&(i=t(this,s),"function"==typeof s&&this._listeners.set(s,i)),this._nativeEventTarget.addEventListener(e,i,n)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,s){const n=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===n?null:n,s)}})(qe),Ke=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(Be),ts=(t=>e=>null!==t&&e instanceof t)(Ke),es=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(Be),ss=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(Be),ns=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(Be),is=((t,e,s,n,i,o,r,a,c,h,l,u,p,d,f,m)=>class extends h{constructor(e,n,i,o){super(i),this._context=e,this._nativeAudioNode=i;const r=l(e);u(r)&&!0!==s(At,(()=>At(r,m)))&&(t=>{const e=new Map;t.connect=(t=>(s,n=0,i=0)=>{const o=Ot(s)?t(s,n,i):t(s,n),r=e.get(s);return void 0===r?e.set(s,[{input:i,output:n}]):r.every((t=>t.input!==i||t.output!==n))&&r.push({input:i,output:n}),o})(t.connect.bind(t)),t.disconnect=(s=>(n,i,o)=>{if(s.apply(t),void 0===n)e.clear();else if("number"==typeof n)for(const[t,s]of e){const i=s.filter((t=>t.output!==n));0===i.length?e.delete(t):e.set(t,i)}else if(e.has(n))if(void 0===i)e.delete(n);else{const t=e.get(n);if(void 0!==t){const s=t.filter((t=>t.output!==i&&(t.input!==o||void 0===o)));0===s.length?e.delete(n):e.set(n,s)}}for(const[s,n]of e)n.forEach((e=>{Ot(s)?t.connect(s,e.output,e.input):t.connect(s,e.output)}))})(t.disconnect)})(i),D.set(this,i),I.set(this,new Set),"closed"!==e.state&&n&&Z(this),t(this,o,i)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,s=0,a=0){if(s<0||s>=this._nativeAudioNode.numberOfOutputs)throw i();const h=l(this._context),u=f(h);if(p(t)||d(t))throw o();if(ut(t)){const i=bt(t);try{const e=gt(this._nativeAudioNode,i,s,a),n=kt(this);(u||n)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!n&&kt(t)&&Z(t)}catch(t){if(12===t.code)throw o();throw t}if(e(this,t,s,a,u)){const e=c([this],t);Ct(e,n(u))}return t}const m=Tt(t);if("playbackRate"===m.name&&1024===m.maxValue)throw r();try{this._nativeAudioNode.connect(m,s),(u||kt(this))&&this._nativeAudioNode.disconnect(m,s)}catch(t){if(12===t.code)throw o();throw t}if(Mt(this,t,s,u)){const e=c([this],t);Ct(e,n(u))}}disconnect(t,e,s){let n;const r=l(this._context),h=f(r);if(void 0===t)n=((t,e)=>{const s=at(t),n=[];for(const i of s.outputs)pt(i)?Dt(t,e,...i):Et(t,e,...i),n.push(i[0]);return s.outputs.clear(),n})(this,h);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw i();n=((t,e,s)=>{const n=at(t),i=[];for(const o of n.outputs)o[1]===s&&(pt(o)?Dt(t,e,...o):Et(t,e,...o),i.push(o[0]),n.outputs.delete(o));return i})(this,h,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw i();if(ut(t)&&void 0!==s&&(s<0||s>=t.numberOfInputs))throw i();if(n=((t,e,s,n,i)=>{const o=at(t);return Array.from(o.outputs).filter((t=>!(t[0]!==s||void 0!==n&&t[1]!==n||void 0!==i&&t[2]!==i))).map((s=>(pt(s)?Dt(t,e,...s):Et(t,e,...s),o.outputs.delete(s),s[0])))})(this,h,t,e,s),0===n.length)throw o()}for(const t of n){const e=c([this],t);Ct(e,a)}}})((os=M,(t,e,s)=>{const n=[];for(let t=0;t<s.numberOfInputs;t+=1)n.push(new Set);os.set(t,{activeInputs:n,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,s,n,i,o,r,a,c,h,l,u,p)=>{const d=new WeakMap;return(f,m,_,g,y)=>{const{activeInputs:v,passiveInputs:x}=o(m),{outputs:w}=o(f),b=a(f),T=o=>{const a=c(m),h=c(f);if(o){const e=U(x,f,_,g);t(v,f,e,!1),y||u(f)||s(h,a,_,g),p(m)&&Z(m)}else{const t=n(v,f,_,g);e(x,g,t,!1),y||u(f)||i(h,a,_,g);const s=r(m);if(0===s)l(m)&&$(m,v);else{const t=d.get(m);void 0!==t&&clearTimeout(t),d.set(m,setTimeout((()=>{l(m)&&$(m,v)}),1e3*s))}}};return!!h(w,[m,_,g],(t=>t[0]===m&&t[1]===_&&t[2]===g),!0)&&(b.add(T),l(f)?t(v,f,[_,g,T],!0):e(x,g,[f,_,T],!0),!0)}})(Ie,Ve,gt,Fe,wt,at,Pe,Q,bt,dt,ot,St,kt),je,((t,e,s,n,i,o)=>r=>(a,c)=>{const h=t.get(a);if(void 0===h){if(!r&&o(a)){const t=n(a),{outputs:o}=s(a);for(const s of o)if(pt(s)){const i=n(s[0]);e(t,i,s[1],s[2])}else{const e=i(s[0]);t.disconnect(e,s[1])}}t.set(a,c)}else t.set(a,h+c)})(V,wt,at,bt,Tt,ot),tt,Yt,_e,((t,e,s,n,i,o,r,a)=>(c,h)=>{const l=e.get(c);if(void 0===l)throw new Error("Missing the expected cycle count.");const u=o(c.context),p=a(u);if(l===h){if(e.delete(c),!p&&r(c)){const e=n(c),{outputs:o}=s(c);for(const s of o)if(pt(s)){const i=n(s[0]);t(e,i,s[1],s[2])}else{const t=i(s[0]);e.connect(t,s[1])}}}else e.set(c,l-h)})(gt,V,at,bt,Tt,Ze,ot,$e),((t,e,s)=>function n(i,o){const r=ut(o)?o:s(t,o);if((t=>"delayTime"in t)(r))return[];if(i[0]===r)return[i];if(i.includes(r))return[];const{outputs:a}=e(r);return Array.from(a).map((t=>n([...i,r],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(He,at,W),Je,Ze,ts,es,ss,$e,ns);var os;const rs=((t,e,s,n,i,o)=>class extends t{constructor(t,s){const r=i(t),a={...H,...s},c=n(r,a);super(t,!1,c,o(r)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,s()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,s()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(is,Qe,tt,We,Ze,$e),as=new WeakSet,cs=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(Be),hs=(ls=new Uint32Array(1),t=>(ls[0]=t,ls[0]));var ls;const us=((t,e)=>s=>{s.copyFromChannel=(n,i,o=0)=>{const r=t(o),a=t(i);if(a>=s.numberOfChannels)throw e();const c=s.length,h=s.getChannelData(a),l=n.length;for(let t=r<0?-r:0;t+r<c&&t<l;t+=1)n[t]=h[t+r]},s.copyToChannel=(n,i,o=0)=>{const r=t(o),a=t(i);if(a>=s.numberOfChannels)throw e();const c=s.length,h=s.getChannelData(a),l=n.length;for(let t=r<0?-r:0;t+r<c&&t<l;t+=1)h[t+r]=n[t]}})(hs,tt),ps=(t=>e=>{e.copyFromChannel=(s=>(n,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return s.call(e,n,a,r)})(e.copyFromChannel),e.copyToChannel=(s=>(n,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return s.call(e,n,a,r)})(e.copyToChannel)})(hs),ds=((t,e,s,n,i,o,r,a)=>{let c=null;return class h{constructor(h){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:u,sampleRate:p}={...st,...h};null===c&&(c=new i(1,1,44100));const d=null!==n&&e(o,o)?new n({length:l,numberOfChannels:u,sampleRate:p}):c.createBuffer(u,l,p);if(0===d.numberOfChannels)throw s();return"function"!=typeof d.copyFromChannel?(r(d),et(d)):e(K,(()=>K(d)))||a(d),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===h.prototype||t.has(e)}}})(as,je,_e,cs,Ye,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(cs),us,ps),fs=(t=>(e,s)=>{const n=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.connect(n).connect(e.destination);const i=()=>{s.removeEventListener("ended",i),s.disconnect(n),n.disconnect()};s.addEventListener("ended",i)})(pe),ms=((t,e,s)=>async(n,i,o)=>{const r=e(n);await Promise.all(Array.from(r.activeInputs).map((async([e,n])=>{const r=t(e),a=await r.render(e,i);s(e)||a.connect(o,n)})))})(Ge,ct,St),_s=(t=>(e,s,n)=>t(s,e,n))(ms),gs=((t,e,s,n,i,o,r,a,c,h,l)=>(u,p)=>{const d=u.createBufferSource();return ee(d,p),ne(d,p,"playbackRate"),te(d,p,"buffer"),te(d,p,"loop"),te(d,p,"loopEnd"),te(d,p,"loopStart"),e(s,(()=>s(u)))||(t=>{t.start=(e=>{let s=!1;return(n=0,i=0,o)=>{if(s)throw Xt();e.call(t,n,i,o),s=!0}})(t.start)})(d),e(n,(()=>n(u)))||c(d),e(i,(()=>i(u)))||h(d,u),e(o,(()=>o(u)))||ie(d),e(r,(()=>r(u)))||l(d,u),e(a,(()=>a(u)))||oe(d),t(u,d),d})(fs,je,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),s=t.createBuffer(1,1,44100);e.buffer=s;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),Ce,Oe,Me,(t=>{t.start=(e=>(s=0,n=0,i)=>{const o=t.buffer,r=null===o?n:Math.min(o.duration,n);null!==o&&r>o.duration-.5/t.context.sampleRate?e.call(t,s,0,0):e.call(t,s,r,i)})(t.start)}),(t=>(e,s)=>{const n=s.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=n),t(e,"buffer",(t=>()=>{const s=t.call(e);return s===n?null:s}),(t=>s=>t.call(e,null===s?n:s)))})(ke),Re),ys=((t,e)=>(s,n,i)=>(t(n).replay(i),e(n,s,i)))((t=>e=>{const s=t(e);if(null===s.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return s.renderer})(ct),ms),vs=((t,e,s,n,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,h){const l=o.get(h);return void 0!==l?Promise.resolve(l):(async(c,h)=>{let l=s(c);const u=J(l,h);if(!u){const t={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=e(h,t),null!==r&&l.start(...r),null!==a&&l.stop(a)}return o.set(h,l),u?await t(h,c.playbackRate,l.playbackRate):await n(h,c.playbackRate,l.playbackRate),await i(c,h,l),l})(c,h)}}})(_s,gs,bt,ys,Ue),xs=((t,e,s,n,i,o,r,a,c,h,l,u,p)=>(d,f,m,_=null,g=null)=>{const y=m.value,v=new C(y),x=f?n(v):null,w={get defaultValue(){return y},get maxValue(){return null===_?m.maxValue:_},get minValue(){return null===g?m.minValue:g},get value(){return m.value},set value(t){m.value=t,w.setValueAtTime(t,d.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof m.cancelAndHoldAtTime)null===x&&v.flush(d.context.currentTime),v.add(i(t)),m.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===x&&v.flush(d.context.currentTime),v.add(i(t));const s=Array.from(v).pop();m.cancelScheduledValues(t),e!==s&&void 0!==s&&("exponentialRampToValue"===s.type?m.exponentialRampToValueAtTime(s.value,s.endTime):"linearRampToValue"===s.type?m.linearRampToValueAtTime(s.value,s.endTime):"setValue"===s.type?m.setValueAtTime(s.value,s.startTime):"setValueCurve"===s.type&&m.setValueCurveAtTime(s.values,s.startTime,s.duration))}return w},cancelScheduledValues:t=>(null===x&&v.flush(d.context.currentTime),v.add(o(t)),m.cancelScheduledValues(t),w),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;const s=d.context.currentTime;return null===x&&v.flush(s),0===Array.from(v).length&&(v.add(h(y,s)),m.setValueAtTime(y,s)),v.add(r(t,e)),m.exponentialRampToValueAtTime(t,e),w},linearRampToValueAtTime(t,e){const s=d.context.currentTime;return null===x&&v.flush(s),0===Array.from(v).length&&(v.add(h(y,s)),m.setValueAtTime(y,s)),v.add(a(t,e)),m.linearRampToValueAtTime(t,e),w},setTargetAtTime:(t,e,s)=>(null===x&&v.flush(d.context.currentTime),v.add(c(t,e,s)),m.setTargetAtTime(t,e,s),w),setValueAtTime:(t,e)=>(null===x&&v.flush(d.context.currentTime),v.add(h(t,e)),m.setValueAtTime(t,e),w),setValueCurveAtTime(t,e,s){const n=t instanceof Float32Array?t:new Float32Array(t);if(null!==u&&"webkitAudioContext"===u.name){const t=e+s,i=d.context.sampleRate,o=Math.ceil(e*i),r=Math.floor(t*i),a=r-o,c=new Float32Array(a);for(let t=0;t<a;t+=1){const r=(n.length-1)/s*((o+t)/i-e),a=Math.floor(r),h=Math.ceil(r);c[t]=a===h?n[a]:(1-(r-a))*n[a]+(1-(h-r))*n[h]}null===x&&v.flush(d.context.currentTime),v.add(l(c,e,s)),m.setValueCurveAtTime(c,e,s);const h=r/i;h<t&&p(w,c[c.length-1],h),p(w,n[n.length-1],t)}else null===x&&v.flush(d.context.currentTime),v.add(l(n,e,s)),m.setValueCurveAtTime(n,e,s);return w}};return s.set(w,m),e.set(w,d),t(w,x),w})((ws=E,(t,e)=>{ws.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),He,R,(t=>({replay(e){for(const s of t)if("exponentialRampToValue"===s.type){const{endTime:t,value:n}=s;e.exponentialRampToValueAtTime(n,t)}else if("linearRampToValue"===s.type){const{endTime:t,value:n}=s;e.linearRampToValueAtTime(n,t)}else if("setTarget"===s.type){const{startTime:t,target:n,timeConstant:i}=s;e.setTargetAtTime(n,t,i)}else if("setValue"===s.type){const{startTime:t,value:n}=s;e.setValueAtTime(n,t)}else{if("setValueCurve"!==s.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:n,values:i}=s;e.setValueCurveAtTime(i,n,t)}}}})),(t=>({cancelTime:t,type:"cancelAndHold"})),(t=>({cancelTime:t,type:"cancelScheduledValues"})),((t,e)=>({endTime:e,type:"exponentialRampToValue",value:t})),((t,e)=>({endTime:e,type:"linearRampToValue",value:t})),((t,e,s)=>({startTime:e,target:t,timeConstant:s,type:"setTarget"})),l,u,Ke,Ae);var ws;const bs=((t,e,s,n,i,o,r,a)=>class extends t{constructor(t,n){const a=o(t),c={...rt,...n},h=i(a,c),l=r(a),u=l?e():null;super(t,!1,h,u),this._audioBufferSourceNodeRenderer=u,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=s(this,l,h.playbackRate,it,nt)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const s=this._nativeAudioBufferSourceNode.onended;this._onended=null!==s&&s===e?t:s}get playbackRate(){return this._playbackRate}start(t=0,e=0,s){if(this._nativeAudioBufferSourceNode.start(t,e,s),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===s?[t,e]:[t,e,s]),"closed"!==this.context.state){Z(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),ot(this)&&Y(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(is,vs,xs,Xt,gs,Ze,$e,qe),Ts=((t,e,s,n,i,o,r,a)=>class extends t{constructor(t,s){const n=o(t),c=r(n),h=i(n,s,c);super(t,!1,h,c?e(a):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw s();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(is,(t=>{const e=new WeakMap;return{render(s,n){const i=e.get(n);return void 0!==i?Promise.resolve(i):(async(s,n)=>{const i=n.destination;return e.set(n,i),await t(s,n,i),i})(s,n)}}}),tt,Xt,((t,e)=>(s,n,i)=>{const o=s.destination;if(o.channelCount!==n)try{o.channelCount=n}catch{}i&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{value:n});const r=t(s,{channelCount:n,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(r,"channelCount",(t=>()=>t.call(r)),(t=>e=>{t.call(r,e);try{o.channelCount=e}catch(t){if(e>o.maxChannelCount)throw t}})),e(r,"channelCountMode",(t=>()=>t.call(r)),(t=>e=>{t.call(r,e),o.channelCountMode=e})),e(r,"channelInterpretation",(t=>()=>t.call(r)),(t=>e=>{t.call(r,e),o.channelInterpretation=e})),Object.defineProperty(r,"maxChannelCount",{get:()=>o.maxChannelCount}),r.connect(o),r})(pe,ke),Ze,$e,Ue),Ss=((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a){const c=o.get(a);return void 0!==c?Promise.resolve(c):(async(r,a)=>{let c=s(r);const h=J(c,a);if(!h){const t={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(a,t)}return o.set(a,c),h?(await t(a,r.Q,c.Q),await t(a,r.detune,c.detune),await t(a,r.frequency,c.frequency),await t(a,r.gain,c.gain)):(await n(a,r.Q,c.Q),await n(a,r.detune,c.detune),await n(a,r.frequency,c.frequency),await n(a,r.gain,c.gain)),await i(r,a,c),c})(r,a)}}})(_s,ce,bt,ys,Ue),ks=(t=>(e,s)=>t.set(e,s))(Ne),As=((t,e,s,n,i,o,r,a)=>class extends t{constructor(t,n){const c=o(t),h={...Pt,...n},l=i(c,h),u=r(c);super(t,!1,l,u?s():null),this._Q=e(this,u,l.Q,it,nt),this._detune=e(this,u,l.detune,1200*Math.log2(it),-1200*Math.log2(it)),this._frequency=e(this,u,l.frequency,t.sampleRate/2,0),this._gain=e(this,u,l.gain,40*Math.log10(it),nt),this._nativeBiquadFilterNode=l,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,s){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,s)}catch(t){if(11===t.code)throw n();throw t}if(t.length!==e.length||e.length!==s.length)throw n()}})(is,xs,Ss,Yt,ce,Ze,$e,ks),Cs=((t,e)=>(s,n,i)=>{const o=new Set;return s.connect=(i=>(r,a=0,c=0)=>{const h=0===o.size;if(e(r))return i.call(s,r,a,c),t(o,[r,a,c],(t=>t[0]===r&&t[1]===a&&t[2]===c),!0),h&&n(),r;i.call(s,r,a),t(o,[r,a],(t=>t[0]===r&&t[1]===a),!0),h&&n()})(s.connect),s.disconnect=(t=>(n,r,a)=>{const c=o.size>0;if(void 0===n)t.apply(s),o.clear();else if("number"==typeof n){t.call(s,n);for(const t of o)t[1]===n&&o.delete(t)}else{e(n)?t.call(s,n,r,a):t.call(s,n,r);for(const t of o)t[0]!==n||void 0!==r&&t[1]!==r||void 0!==a&&t[2]!==a||o.delete(t)}const h=0===o.size;c&&h&&i()})(s.disconnect),s})(dt,es),Os=((t,e)=>(s,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=s.createBufferSource();e(n,(()=>{const t=n.numberOfInputs;for(let e=0;e<t;e+=1)i.connect(n,0,e)}),(()=>i.disconnect(n)))})(Xt,Cs),Ms=((t,e)=>(s,n)=>{const i=s.createChannelMerger(n.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(s,i),ee(i,n),i})(Ke,Os),Ds=((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o){const r=n.get(o);return void 0!==r?Promise.resolve(r):(async(i,o)=>{let r=e(i);if(!J(r,o)){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfInputs:r.numberOfInputs};r=t(o,e)}return n.set(o,r),await s(i,o,r),r})(i,o)}}})(Ms,bt,Ue),Es=((t,e,s,n,i)=>class extends t{constructor(t,o){const r=n(t),a={...jt,...o};super(t,!1,s(r,a),i(r)?e():null)}})(is,Ds,Ms,Ze,$e),Rs=((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o){const r=n.get(o);return void 0!==r?Promise.resolve(r):(async(i,o)=>{let r=e(i);if(!J(r,o)){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfOutputs:r.numberOfOutputs};r=t(o,e)}return n.set(o,r),await s(i,o,r),r})(i,o)}}})(he,bt,Ue),qs=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=n(t),c=o({...Lt,...r});super(t,!1,s(a,c),i(a)?e():null)}})(is,Rs,he,Ze,$e,(t=>({...t,channelCount:t.numberOfOutputs}))),Is=((t,e,s,n)=>(i,{offset:o,...r})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),h=s(i,{...r,gain:o}),l=a.getChannelData(0);l[0]=1,l[1]=1,c.buffer=a,c.loop=!0;const u={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){h.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){h.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t},get context(){return h.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get offset(){return h.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2]),start(t=0){c.start.call(c,t)},stop(t=0){c.stop.call(c,t)}};return t(i,c),n(le(u,h),(()=>c.connect(h)),(()=>c.disconnect(h)))})(fs,gs,pe,Cs),Vs=((t,e,s,n,i)=>(o,r)=>{if(void 0===o.createConstantSource)return s(o,r);const a=o.createConstantSource();return ee(a,r),ne(a,r,"offset"),e(n,(()=>n(o)))||ie(a),e(i,(()=>i(o)))||oe(a),t(o,a),a})(fs,je,Is,Ce,Me),Fs=((t,e,s,n,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,h){const l=o.get(h);return void 0!==l?Promise.resolve(l):(async(c,h)=>{let l=s(c);const u=J(l,h);if(!u){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=e(h,t),null!==r&&l.start(r),null!==a&&l.stop(a)}return o.set(h,l),u?await t(h,c.offset,l.offset):await n(h,c.offset,l.offset),await i(c,h,l),l})(c,h)}}})(_s,Vs,bt,ys,Ue),Ns=((t,e,s,n,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...zt,...r},h=n(a,c),l=o(a),u=l?s():null;super(t,!1,h,u),this._constantSourceNodeRenderer=u,this._nativeConstantSourceNode=h,this._offset=e(this,l,h.offset,it,nt),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeConstantSourceNode.onended=e;const s=this._nativeConstantSourceNode.onended;this._onended=null!==s&&s===e?t:s}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){Z(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),ot(this)&&Y(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(is,xs,Fs,Vs,Ze,$e,qe),Ps=((t,e)=>(s,n)=>{const i=s.createConvolver();if(ee(i,n),n.disableNormalization===i.normalize&&(i.normalize=!n.disableNormalization),te(i,n,"buffer"),n.channelCount>2)throw t();if(e(i,"channelCount",(t=>()=>t.call(i)),(e=>s=>{if(s>2)throw t();return e.call(i,s)})),"max"===n.channelCountMode)throw t();return e(i,"channelCountMode",(t=>()=>t.call(i)),(e=>s=>{if("max"===s)throw t();return e.call(i,s)})),i})(_e,ke),js=((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o){const r=n.get(o);return void 0!==r?Promise.resolve(r):(async(i,o)=>{let r=e(i);if(!J(r,o)){const e={buffer:r.buffer,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,disableNormalization:!r.normalize};r=t(o,e)}return n.set(o,r),_t(r)?await s(i,o,r.inputs[0]):await s(i,o,r),r})(i,o)}}})(Ps,bt,Ue),Ls=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=n(t),c={...Bt,...r},h=s(a,c);super(t,!1,h,i(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=h,null!==c.buffer&&o(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,t.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(is,js,Ps,Ze,$e,ks),zs=((t,e,s,n,i)=>o=>{const r=new WeakMap;return{render(a,c){const h=r.get(c);return void 0!==h?Promise.resolve(h):(async(a,c)=>{let h=s(a);const l=J(h,c);if(!l){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:o};h=e(c,t)}return r.set(c,h),l?await t(c,a.delayTime,h.delayTime):await n(c,a.delayTime,h.delayTime),await i(a,c,h),h})(a,c)}}})(_s,ue,bt,ys,Ue),Bs=((t,e,s,n,i,o,r)=>class extends t{constructor(t,a){const c=i(t),h={...Gt,...a},l=n(c,h),u=o(c);super(t,!1,l,u?s(h.maxDelayTime):null),this._delayTime=e(this,u,l.delayTime),r(this,h.maxDelayTime)}get delayTime(){return this._delayTime}})(is,xs,zs,ue,Ze,$e,ks),Ws=(t=>(e,s)=>{const n=e.createDynamicsCompressor();if(ee(n,s),s.channelCount>2)throw t();if("max"===s.channelCountMode)throw t();return ne(n,s,"attack"),ne(n,s,"knee"),ne(n,s,"ratio"),ne(n,s,"release"),ne(n,s,"threshold"),n})(_e),Gs=((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a){const c=o.get(a);return void 0!==c?Promise.resolve(c):(async(r,a)=>{let c=s(r);const h=J(c,a);if(!h){const t={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(a,t)}return o.set(a,c),h?(await t(a,r.attack,c.attack),await t(a,r.knee,c.knee),await t(a,r.ratio,c.ratio),await t(a,r.release,c.release),await t(a,r.threshold,c.threshold)):(await n(a,r.attack,c.attack),await n(a,r.knee,c.knee),await n(a,r.ratio,c.ratio),await n(a,r.release,c.release),await n(a,r.threshold,c.threshold)),await i(r,a,c),c})(r,a)}}})(_s,Ws,bt,ys,Ue),Us=((t,e,s,n,i,o,r,a)=>class extends t{constructor(t,i){const c=o(t),h={...Qt,...i},l=n(c,h),u=r(c);super(t,!1,l,u?s():null),this._attack=e(this,u,l.attack),this._knee=e(this,u,l.knee),this._nativeDynamicsCompressorNode=l,this._ratio=e(this,u,l.ratio),this._release=e(this,u,l.release),this._threshold=e(this,u,l.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(is,xs,Gs,Ws,_e,Ze,$e,ks),Qs=((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a){const c=o.get(a);return void 0!==c?Promise.resolve(c):(async(r,a)=>{let c=s(r);const h=J(c,a);if(!h){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(a,t)}return o.set(a,c),h?await t(a,r.gain,c.gain):await n(a,r.gain,c.gain),await i(r,a,c),c})(r,a)}}})(_s,pe,bt,ys,Ue),Zs=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...Zt,...r},h=n(a,c),l=o(a);super(t,!1,h,l?s():null),this._gain=e(this,l,h.gain,it,nt)}get gain(){return this._gain}})(is,xs,Qs,pe,Ze,$e),Xs=((t,e,s,n)=>(i,o,{channelCount:r,channelCountMode:a,channelInterpretation:c,feedback:h,feedforward:l})=>{const u=re(o,i.sampleRate),p=h instanceof Float64Array?h:new Float64Array(h),d=l instanceof Float64Array?l:new Float64Array(l),f=p.length,m=d.length,_=Math.min(f,m);if(0===f||f>20)throw n();if(0===p[0])throw e();if(0===m||m>20)throw n();if(0===d[0])throw e();if(1!==p[0]){for(let t=0;t<m;t+=1)d[t]/=p[0];for(let t=1;t<f;t+=1)p[t]/=p[0]}const g=s(i,u,r,r);g.channelCount=r,g.channelCountMode=a,g.channelInterpretation=c;const y=[],v=[],x=[];for(let t=0;t<r;t+=1){y.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),v.push(t),x.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,s=t.outputBuffer,n=e.numberOfChannels;for(let t=0;t<n;t+=1){const n=e.getChannelData(t),i=s.getChannelData(t);y[t]=Ht(p,f,d,m,_,v[t],x[t],y[t],32,n,i)}};const w=i.sampleRate/2;return le({get bufferSize(){return u},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,s,n){if(e.length!==s.length||s.length!==n.length)throw t();const i=e.length;for(let t=0;t<i;t+=1){const i=-Math.PI*(e[t]/w),o=[Math.cos(i),Math.sin(i)],r=de(fe(d,o),fe(p,o));s[t]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),n[t]=Math.atan2(r[1],r[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])},g)})(Yt,Xt,me,_e),Ys=((t,e,s,n)=>i=>t(Kt,(()=>Kt(i)))?Promise.resolve(t(n,n)).then((t=>{if(!t){const t=s(i,512,0,1);i.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>i.currentTime,t.connect(i.destination)}return i.startRendering()})):new Promise((t=>{const s=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=e=>{s.disconnect(),t(e.renderedBuffer)},s.connect(i.destination),i.startRendering()})))(je,pe,me,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const s=new e(1,1,44100),n=t(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{s.oncomplete=()=>{n.disconnect(),t(0!==s.currentTime)},s.startRendering()}))})(pe,Ye)),$s=((t,e,s,n,i)=>(o,r)=>{const a=new WeakMap;let c=null;const h=async(h,l)=>{let u=null,p=e(h);const d=J(p,l);if(void 0===l.createIIRFilter?u=t(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):d||(p=l.createIIRFilter(r,o)),a.set(l,null===u?p:u),null!==u){if(null===c){if(null===s)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new s(h.context.destination.channelCount,h.context.length,l.sampleRate);c=(async()=>{await n(h,t,t.destination);return((t,e,s,n)=>{const i=s instanceof Float64Array?s:new Float64Array(s),o=n instanceof Float64Array?n:new Float64Array(n),r=i.length,a=o.length,c=Math.min(r,a);if(1!==i[0]){for(let t=0;t<r;t+=1)o[t]/=i[0];for(let t=1;t<a;t+=1)i[t]/=i[0]}const h=new Float32Array(32),l=new Float32Array(32),u=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),p=t.numberOfChannels;for(let e=0;e<p;e+=1){const s=t.getChannelData(e),n=u.getChannelData(e);h.fill(0),l.fill(0),Ht(i,r,o,a,c,h,l,0,32,s,n)}return u})(await i(t),l,o,r)})()}const t=await c;return u.buffer=t,u.start(0),u}return await n(h,l,p),p};return{render(t,e){const s=a.get(e);return void 0!==s?Promise.resolve(s):h(t,e)}}})(gs,bt,Ye,Ue,Ys),Hs=(t=>(e,s,n)=>{if(void 0===e.createIIRFilter)return t(e,s,n);const i=e.createIIRFilter(n.feedforward,n.feedback);return ee(i,n),i})(Xs),Js=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=n(t),c=i(a),h={...$t,...r},l=e(a,c?null:t.baseLatency,h);super(t,!1,l,c?s(h.feedback,h.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(s,n,i)=>{if(s.length!==n.length||n.length!==i.length)throw Yt();return e.call(t,s,n,i)})})(l),this._nativeIIRFilterNode=l,o(this,1)}getFrequencyResponse(t,e,s){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,s)}})(is,Hs,$s,Ze,$e,ks),Ks=((t,e,s,n,i,o,r,a)=>(c,h)=>{const l=h.listener,{forwardX:u,forwardY:p,forwardZ:d,positionX:f,positionY:m,positionZ:_,upX:g,upY:y,upZ:v}=void 0===l.forwardX?(()=>{const u=new Float32Array(1),p=e(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),d=r(h);let f=!1,m=[0,0,-1,0,1,0],_=[0,0,0];const g=()=>{if(f)return;f=!0;const t=n(h,256,9,0);t.onaudioprocess=({inputBuffer:t})=>{const e=[o(t,u,0),o(t,u,1),o(t,u,2),o(t,u,3),o(t,u,4),o(t,u,5)];e.some(((t,e)=>t!==m[e]))&&(l.setOrientation(...e),m=e);const s=[o(t,u,6),o(t,u,7),o(t,u,8)];s.some(((t,e)=>t!==_[e]))&&(l.setPosition(...s),_=s)},p.connect(t)},y=t=>e=>{e!==m[t]&&(m[t]=e,l.setOrientation(...m))},v=t=>e=>{e!==_[t]&&(_[t]=e,l.setPosition(..._))},x=(e,n,o)=>{const r=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:n});r.connect(p,0,e),r.start(),Object.defineProperty(r.offset,"defaultValue",{get:()=>n});const l=t({context:c},d,r.offset,it,nt);var u,f,m,_,y,v,x;return a(l,"value",(t=>()=>t.call(l)),(t=>e=>{try{t.call(l,e)}catch(t){if(9!==t.code)throw t}g(),d&&o(e)})),l.cancelAndHoldAtTime=(u=l.cancelAndHoldAtTime,d?()=>{throw i()}:(...t)=>{const e=u.apply(l,t);return g(),e}),l.cancelScheduledValues=(f=l.cancelScheduledValues,d?()=>{throw i()}:(...t)=>{const e=f.apply(l,t);return g(),e}),l.exponentialRampToValueAtTime=(m=l.exponentialRampToValueAtTime,d?()=>{throw i()}:(...t)=>{const e=m.apply(l,t);return g(),e}),l.linearRampToValueAtTime=(_=l.linearRampToValueAtTime,d?()=>{throw i()}:(...t)=>{const e=_.apply(l,t);return g(),e}),l.setTargetAtTime=(y=l.setTargetAtTime,d?()=>{throw i()}:(...t)=>{const e=y.apply(l,t);return g(),e}),l.setValueAtTime=(v=l.setValueAtTime,d?()=>{throw i()}:(...t)=>{const e=v.apply(l,t);return g(),e}),l.setValueCurveAtTime=(x=l.setValueCurveAtTime,d?()=>{throw i()}:(...t)=>{const e=x.apply(l,t);return g(),e}),l};return{forwardX:x(0,0,y(0)),forwardY:x(1,0,y(1)),forwardZ:x(2,-1,y(2)),positionX:x(6,0,v(0)),positionY:x(7,0,v(1)),positionZ:x(8,0,v(2)),upX:x(3,0,y(3)),upY:x(4,1,y(4)),upZ:x(5,0,y(5))}})():l;return{get forwardX(){return u},get forwardY(){return p},get forwardZ(){return d},get positionX(){return f},get positionY(){return m},get positionZ(){return _},get upX(){return g},get upY(){return y},get upZ(){return v}}})(xs,Ms,Vs,me,_e,Te,$e,ke),tn=new WeakMap,en=((t,e,s,n,i,o)=>class extends s{constructor(s,o){super(s),this._nativeContext=s,q.set(this,s),n(s)&&i.set(s,new Set),this._destination=new t(this,o),this._listener=e(this,s),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?o(this,t):null;this._nativeContext.onstatechange=e;const s=this._nativeContext.onstatechange;this._onstatechange=null!==s&&s===e?t:s}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Ts,Ks,Je,$e,tn,qe),sn=((t,e,s,n,i,o)=>(r,a)=>{const c=r.createOscillator();return ee(c,a),ne(c,a,"detune"),ne(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):te(c,a,"type"),e(s,(()=>s(r)))||ie(c),e(n,(()=>n(r)))||o(c,r),e(i,(()=>i(r)))||oe(c),t(r,c),c})(fs,je,Ce,Oe,Me,Re),nn=((t,e,s,n,i)=>()=>{const o=new WeakMap;let r=null,a=null,c=null;return{set periodicWave(t){r=t},set start(t){a=t},set stop(t){c=t},render(h,l){const u=o.get(l);return void 0!==u?Promise.resolve(u):(async(h,l)=>{let u=s(h);const p=J(u,l);if(!p){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,periodicWave:null===r?void 0:r,type:u.type};u=e(l,t),null!==a&&u.start(a),null!==c&&u.stop(c)}return o.set(l,u),p?(await t(l,h.detune,u.detune),await t(l,h.frequency,u.frequency)):(await n(l,h.detune,u.detune),await n(l,h.frequency,u.frequency)),await i(h,l,u),u})(h,l)}}})(_s,sn,bt,ys,Ue),on=((t,e,s,n,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...ye,...r},h=s(a,c),l=o(a),u=l?n():null,p=t.sampleRate/2;super(t,!1,h,u),this._detune=e(this,l,h.detune,153600,-153600),this._frequency=e(this,l,h.frequency,p,-p),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=u,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeOscillatorNode.onended=e;const s=this._nativeOscillatorNode.onended;this._onended=null!==s&&s===e?t:s}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){Z(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),ot(this)&&Y(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(is,xs,sn,nn,Ze,$e,qe),rn=(t=>(e,s)=>{const n=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return n.buffer=i,n.loop=!0,n.connect(s),n.start(),()=>{n.stop(),n.disconnect(s)}})(gs),an=((t,e,s,n,i)=>(o,{curve:r,oversample:a,...c})=>{const h=o.createWaveShaper(),l=o.createWaveShaper();ee(h,c),ee(l,c);const u=s(o,{...c,gain:1}),p=s(o,{...c,gain:-1}),d=s(o,{...c,gain:1}),f=s(o,{...c,gain:-1});let m=null,_=!1,g=null;const y={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){u.channelCount=t,p.channelCount=t,h.channelCount=t,d.channelCount=t,l.channelCount=t,f.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){u.channelCountMode=t,p.channelCountMode=t,h.channelCountMode=t,d.channelCountMode=t,l.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t,p.channelInterpretation=t,h.channelInterpretation=t,d.channelInterpretation=t,l.channelInterpretation=t,f.channelInterpretation=t},get context(){return h.context},get curve(){return g},set curve(s){if(null!==s&&s.length<2)throw e();if(null===s)h.curve=s,l.curve=s;else{const t=s.length,e=new Float32Array(t+2-t%2),n=new Float32Array(t+2-t%2);e[0]=s[0],n[0]=-s[t-1];const i=Math.ceil((t+1)/2),o=(t+1)/2-1;for(let r=1;r<i;r+=1){const a=r/i*o,c=Math.floor(a),h=Math.ceil(a);e[r]=c===h?s[c]:(1-(a-c))*s[c]+(1-(h-a))*s[h],n[r]=c===h?-s[t-1-c]:-(1-(a-c))*s[t-1-c]-(1-(h-a))*s[t-1-h]}e[i]=t%2==1?s[i-1]:(s[i-2]+s[i-1])/2,h.curve=e,l.curve=n}g=s,_&&(n(g)&&null===m?m=t(o,u):null!==m&&(m(),m=null))},get inputs(){return[u]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get oversample(){return h.oversample},set oversample(t){h.oversample=t,l.oversample=t},addEventListener:(...t)=>u.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>u.dispatchEvent(t[0]),removeEventListener:(...t)=>u.removeEventListener(t[0],t[1],t[2])};null!==r&&(y.curve=r instanceof Float32Array?r:new Float32Array(r)),a!==y.oversample&&(y.oversample=a);return i(le(y,d),(()=>{u.connect(h).connect(d),u.connect(p).connect(l).connect(f).connect(d),_=!0,n(g)&&(m=t(o,u))}),(()=>{u.disconnect(h),h.disconnect(d),u.disconnect(p),p.disconnect(l),l.disconnect(f),f.disconnect(d),_=!1,null!==m&&(m(),m=null)}))})(rn,Xt,pe,Se,Cs),cn=((t,e,s,n,i,o,r)=>(a,c)=>{const h=a.createWaveShaper();if(null!==o&&"webkitAudioContext"===o.name&&void 0===a.createGain().gain.automationRate)return s(a,c);ee(h,c);const l=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==l&&l.length<2)throw e();te(h,{curve:l},"curve"),te(h,c,"oversample");let u=null,p=!1;r(h,"curve",(t=>()=>t.call(h)),(e=>s=>(e.call(h,s),p&&(n(s)&&null===u?u=t(a,h):n(s)||null===u||(u(),u=null)),s)));return i(h,(()=>{p=!0,n(h.curve)&&(u=t(a,h))}),(()=>{p=!1,null!==u&&(u(),u=null)}))})(rn,Xt,an,Se,Cs,Ke,ke),hn=((t,e,s,n,i,o,r,a,c,h)=>(l,{coneInnerAngle:u,coneOuterAngle:p,coneOuterGain:d,distanceModel:f,maxDistance:m,orientationX:_,orientationY:g,orientationZ:y,panningModel:v,positionX:x,positionY:w,positionZ:b,refDistance:T,rolloffFactor:S,...k})=>{const A=l.createPanner();if(k.channelCount>2)throw r();if("max"===k.channelCountMode)throw r();ee(A,k);const C={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},O=s(l,{...C,channelInterpretation:"speakers",numberOfInputs:6}),M=n(l,{...k,gain:1}),D=n(l,{...C,gain:1}),E=n(l,{...C,gain:0}),R=n(l,{...C,gain:0}),q=n(l,{...C,gain:0}),I=n(l,{...C,gain:0}),V=n(l,{...C,gain:0}),F=i(l,256,6,1),N=o(l,{...C,curve:new Float32Array([1,1]),oversample:"none"});let P=[_,g,y],j=[x,w,b];const L=new Float32Array(1);F.onaudioprocess=({inputBuffer:t})=>{const e=[c(t,L,0),c(t,L,1),c(t,L,2)];e.some(((t,e)=>t!==P[e]))&&(A.setOrientation(...e),P=e);const s=[c(t,L,3),c(t,L,4),c(t,L,5)];s.some(((t,e)=>t!==j[e]))&&(A.setPosition(...s),j=s)},Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0});const z={get bufferSize(){},get channelCount(){return A.channelCount},set channelCount(t){if(t>2)throw r();M.channelCount=t,A.channelCount=t},get channelCountMode(){return A.channelCountMode},set channelCountMode(t){if("max"===t)throw r();M.channelCountMode=t,A.channelCountMode=t},get channelInterpretation(){return A.channelInterpretation},set channelInterpretation(t){M.channelInterpretation=t,A.channelInterpretation=t},get coneInnerAngle(){return A.coneInnerAngle},set coneInnerAngle(t){A.coneInnerAngle=t},get coneOuterAngle(){return A.coneOuterAngle},set coneOuterAngle(t){A.coneOuterAngle=t},get coneOuterGain(){return A.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();A.coneOuterGain=t},get context(){return A.context},get distanceModel(){return A.distanceModel},set distanceModel(t){A.distanceModel=t},get inputs(){return[M]},get maxDistance(){return A.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;A.maxDistance=t},get numberOfInputs(){return A.numberOfInputs},get numberOfOutputs(){return A.numberOfOutputs},get orientationX(){return D.gain},get orientationY(){return E.gain},get orientationZ(){return R.gain},get panningModel(){return A.panningModel},set panningModel(t){A.panningModel=t},get positionX(){return q.gain},get positionY(){return I.gain},get positionZ(){return V.gain},get refDistance(){return A.refDistance},set refDistance(t){if(t<0)throw new RangeError;A.refDistance=t},get rolloffFactor(){return A.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;A.rolloffFactor=t},addEventListener:(...t)=>M.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>M.dispatchEvent(t[0]),removeEventListener:(...t)=>M.removeEventListener(t[0],t[1],t[2])};u!==z.coneInnerAngle&&(z.coneInnerAngle=u),p!==z.coneOuterAngle&&(z.coneOuterAngle=p),d!==z.coneOuterGain&&(z.coneOuterGain=d),f!==z.distanceModel&&(z.distanceModel=f),m!==z.maxDistance&&(z.maxDistance=m),_!==z.orientationX.value&&(z.orientationX.value=_),g!==z.orientationY.value&&(z.orientationY.value=g),y!==z.orientationZ.value&&(z.orientationZ.value=y),v!==z.panningModel&&(z.panningModel=v),x!==z.positionX.value&&(z.positionX.value=x),w!==z.positionY.value&&(z.positionY.value=w),b!==z.positionZ.value&&(z.positionZ.value=b),T!==z.refDistance&&(z.refDistance=T),S!==z.rolloffFactor&&(z.rolloffFactor=S),1===P[0]&&0===P[1]&&0===P[2]||A.setOrientation(...P),0===j[0]&&0===j[1]&&0===j[2]||A.setPosition(...j);return h(le(z,A),(()=>{M.connect(A),t(M,N,0,0),N.connect(D).connect(O,0,0),N.connect(E).connect(O,0,1),N.connect(R).connect(O,0,2),N.connect(q).connect(O,0,3),N.connect(I).connect(O,0,4),N.connect(V).connect(O,0,5),O.connect(F).connect(l.destination)}),(()=>{M.disconnect(A),a(M,N,0,0),N.disconnect(D),D.disconnect(O),N.disconnect(E),E.disconnect(O),N.disconnect(R),R.disconnect(O),N.disconnect(q),q.disconnect(O),N.disconnect(I),I.disconnect(O),N.disconnect(V),V.disconnect(O),O.disconnect(F),F.disconnect(l.destination)}))})(gt,Xt,Ms,pe,me,cn,_e,wt,Te,Cs),ln=(t=>(e,s)=>{const n=e.createPanner();return void 0===n.orientationX?t(e,s):(ee(n,s),ne(n,s,"orientationX"),ne(n,s,"orientationY"),ne(n,s,"orientationZ"),ne(n,s,"positionX"),ne(n,s,"positionY"),ne(n,s,"positionZ"),te(n,s,"coneInnerAngle"),te(n,s,"coneOuterAngle"),te(n,s,"coneOuterGain"),te(n,s,"distanceModel"),te(n,s,"maxDistance"),te(n,s,"panningModel"),te(n,s,"refDistance"),te(n,s,"rolloffFactor"),n)})(hn),un=((t,e,s,n,i,o,r,a,c,h)=>()=>{const l=new WeakMap;let u=null;return{render(p,d){const f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=null,m=o(p);const _={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},g={..._,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},y=J(m,d);if("bufferSize"in m)f=n(d,{..._,gain:1});else if(!y){const t={...g,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=i(d,t)}if(l.set(d,null===f?m:f),null!==f){if(null===u){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new r(6,p.context.length,d.sampleRate),n=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});n.connect(t.destination),u=(async()=>{const e=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map((async(e,n)=>{const i=s(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===n?1:0});return await a(t,e,i.offset),i})));for(let t=0;t<6;t+=1)e[t].connect(n,0,t),e[t].start(0);return h(t)})()}const t=await u,o=n(d,{..._,gain:1});await c(p,d,o);const l=[];for(let e=0;e<t.numberOfChannels;e+=1)l.push(t.getChannelData(e));let m=[l[0][0],l[1][0],l[2][0]],y=[l[3][0],l[4][0],l[5][0]],v=n(d,{..._,gain:1}),x=i(d,{...g,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]});o.connect(v).connect(x.inputs[0]),x.connect(f);for(let e=128;e<t.length;e+=128){const t=[l[0][e],l[1][e],l[2][e]],s=[l[3][e],l[4][e],l[5][e]];if(t.some(((t,e)=>t!==m[e]))||s.some(((t,e)=>t!==y[e]))){m=t,y=s;const r=e/d.sampleRate;v.gain.setValueAtTime(0,r),v=n(d,{..._,gain:0}),x=i(d,{...g,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),v.gain.setValueAtTime(1,r),o.connect(v).connect(x.inputs[0]),x.connect(f)}}return f}return y?(await t(d,p.orientationX,m.orientationX),await t(d,p.orientationY,m.orientationY),await t(d,p.orientationZ,m.orientationZ),await t(d,p.positionX,m.positionX),await t(d,p.positionY,m.positionY),await t(d,p.positionZ,m.positionZ)):(await a(d,p.orientationX,m.orientationX),await a(d,p.orientationY,m.orientationY),await a(d,p.orientationZ,m.orientationZ),await a(d,p.positionX,m.positionX),await a(d,p.positionY,m.positionY),await a(d,p.positionZ,m.positionZ)),_t(m)?await c(p,d,m.inputs[0]):await c(p,d,m),m})(p,d)}}})(_s,Ms,Vs,pe,ln,bt,Ye,ys,Ue,Ys),pn=((t,e,s,n,i,o,r)=>class extends t{constructor(t,a){const c=i(t),h={...ve,...a},l=s(c,h),u=o(c);super(t,!1,l,u?n():null),this._nativePannerNode=l,this._orientationX=e(this,u,l.orientationX,it,nt),this._orientationY=e(this,u,l.orientationY,it,nt),this._orientationZ=e(this,u,l.orientationZ,it,nt),this._positionX=e(this,u,l.positionX,it,nt),this._positionY=e(this,u,l.positionY,it,nt),this._positionZ=e(this,u,l.positionZ,it,nt),r(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(is,xs,ln,un,Ze,$e,ks),dn=(t=>(e,{disableNormalization:s,imag:n,real:i})=>{const o=n instanceof Float32Array?n:new Float32Array(n),r=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(r,o,{disableNormalization:s});if(Array.from(n).length<2)throw t();return a})(tt),fn=((t,e,s,n)=>class i{constructor(i,o){const r=e(i),a=n({...xe,...o}),c=t(r,a);return s.add(c),c}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||s.has(t)}})(dn,Ze,new WeakSet,(t=>{const{imag:e,real:s}=t;return void 0===e?void 0===s?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(s,(()=>0)),real:s}:void 0===s?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:s}})),mn=((t,e,s,n,i,o)=>{const r=16385,a=new Float32Array([1,1]),c=Math.PI/2,h={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...h,oversample:"none"},u=(t,o,u,p,d)=>{if(1===o)return((t,e,i,o)=>{const u=new Float32Array(r),p=new Float32Array(r);for(let t=0;t<r;t+=1){const e=t/16384*c;u[t]=Math.cos(e),p[t]=Math.sin(e)}const d=s(t,{...h,gain:0}),f=n(t,{...l,curve:u}),m=n(t,{...l,curve:a}),_=s(t,{...h,gain:0}),g=n(t,{...l,curve:p});return{connectGraph(){e.connect(d),e.connect(void 0===m.inputs?m:m.inputs[0]),e.connect(_),m.connect(i),i.connect(void 0===f.inputs?f:f.inputs[0]),i.connect(void 0===g.inputs?g:g.inputs[0]),f.connect(d.gain),g.connect(_.gain),d.connect(o,0,0),_.connect(o,0,1)},disconnectGraph(){e.disconnect(d),e.disconnect(void 0===m.inputs?m:m.inputs[0]),e.disconnect(_),m.disconnect(i),i.disconnect(void 0===f.inputs?f:f.inputs[0]),i.disconnect(void 0===g.inputs?g:g.inputs[0]),f.disconnect(d.gain),g.disconnect(_.gain),d.disconnect(o,0,0),_.disconnect(o,0,1)}}})(t,u,p,d);if(2===o)return((t,i,o,u)=>{const p=new Float32Array(r),d=new Float32Array(r),f=new Float32Array(r),m=new Float32Array(r),_=Math.floor(8192.5);for(let t=0;t<r;t+=1)if(t>_){const e=(t-_)/(16384-_)*c;p[t]=Math.cos(e),d[t]=Math.sin(e),f[t]=0,m[t]=1}else{const e=t/(16384-_)*c;p[t]=1,d[t]=0,f[t]=Math.cos(e),m[t]=Math.sin(e)}const g=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),y=s(t,{...h,gain:0}),v=n(t,{...l,curve:p}),x=s(t,{...h,gain:0}),w=n(t,{...l,curve:d}),b=n(t,{...l,curve:a}),T=s(t,{...h,gain:0}),S=n(t,{...l,curve:f}),k=s(t,{...h,gain:0}),A=n(t,{...l,curve:m});return{connectGraph(){i.connect(g),i.connect(void 0===b.inputs?b:b.inputs[0]),g.connect(y,0),g.connect(x,0),g.connect(T,1),g.connect(k,1),b.connect(o),o.connect(void 0===v.inputs?v:v.inputs[0]),o.connect(void 0===w.inputs?w:w.inputs[0]),o.connect(void 0===S.inputs?S:S.inputs[0]),o.connect(void 0===A.inputs?A:A.inputs[0]),v.connect(y.gain),w.connect(x.gain),S.connect(T.gain),A.connect(k.gain),y.connect(u,0,0),T.connect(u,0,0),x.connect(u,0,1),k.connect(u,0,1)},disconnectGraph(){i.disconnect(g),i.disconnect(void 0===b.inputs?b:b.inputs[0]),g.disconnect(y,0),g.disconnect(x,0),g.disconnect(T,1),g.disconnect(k,1),b.disconnect(o),o.disconnect(void 0===v.inputs?v:v.inputs[0]),o.disconnect(void 0===w.inputs?w:w.inputs[0]),o.disconnect(void 0===S.inputs?S:S.inputs[0]),o.disconnect(void 0===A.inputs?A:A.inputs[0]),v.disconnect(y.gain),w.disconnect(x.gain),S.disconnect(T.gain),A.disconnect(k.gain),y.disconnect(u,0,0),T.disconnect(u,0,0),x.disconnect(u,0,1),k.disconnect(u,0,1)}}})(t,u,p,d);throw i()};return(e,{channelCount:n,channelCountMode:r,pan:a,...c})=>{if("max"===r)throw i();const h=t(e,{...c,channelCount:1,channelCountMode:r,numberOfInputs:2}),l=s(e,{...c,channelCount:n,channelCountMode:r,gain:1}),p=s(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:d,disconnectGraph:f}=u(e,n,l,p,h);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"maxValue",{get:()=>1}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});const m={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(_&&f(),({connectGraph:d,disconnectGraph:f}=u(e,t,l,p,h)),_&&d()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw i();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return p.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let _=!1;return o(le(m,h),(()=>{d(),_=!0}),(()=>{f(),_=!1}))}})(Ms,he,pe,cn,_e,Cs),_n=((t,e)=>(s,n)=>{const i=n.channelCountMode;if("clamped-max"===i)throw e();if(void 0===s.createStereoPanner)return t(s,n);const o=s.createStereoPanner();return ee(o,n),ne(o,n,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:t=>{if(t!==i)throw e()}}),o})(mn,_e),gn=((t,e,s,n,i)=>()=>{const o=new WeakMap;return{render(r,a){const c=o.get(a);return void 0!==c?Promise.resolve(c):(async(r,a)=>{let c=s(r);const h=J(c,a);if(!h){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(a,t)}return o.set(a,c),h?await t(a,r.pan,c.pan):await n(a,r.pan,c.pan),_t(c)?await i(r,a,c.inputs[0]):await i(r,a,c),c})(r,a)}}})(_s,_n,bt,ys,Ue),yn=((t,e,s,n,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...we,...r},h=s(a,c),l=o(a);super(t,!1,h,l?n():null),this._pan=e(this,l,h.pan)}get pan(){return this._pan}})(is,xs,_n,gn,Ze,$e),vn=((t,e,s)=>()=>{const n=new WeakMap;return{render(i,o){const r=n.get(o);return void 0!==r?Promise.resolve(r):(async(i,o)=>{let r=e(i);if(!J(r,o)){const e={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,curve:r.curve,oversample:r.oversample};r=t(o,e)}return n.set(o,r),_t(r)?await s(i,o,r.inputs[0]):await s(i,o,r),r})(i,o)}}})(cn,bt,Ue),xn=((t,e,s,n,i,o,r)=>class extends t{constructor(t,e){const a=i(t),c={...be,...e},h=s(a,c);super(t,!0,h,o(a)?n():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,r(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(is,Xt,cn,vn,Ze,$e,ks),wn=(t=>null!==t&&t.isSecureContext)(Be),bn=(t=>(e,s,n)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*s)},currentTime:{configurable:!0,get:()=>e}});try{return n()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(Be),Tn=new WeakMap,Sn=((t,e)=>s=>{let n=t.get(s);if(void 0!==n)return n;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,44100),t.set(s,n),n})(Tn,Ye),kn=wn?((t,e,s,n,i,o,r,a,c,h,l,u,p)=>{let d=0;return(f,m,_={credentials:"omit"})=>{const g=l.get(f);if(void 0!==g&&g.has(m))return Promise.resolve();const y=h.get(f);if(void 0!==y){const t=y.get(m);if(void 0!==t)return t}const v=o(f),x=void 0===v.audioWorklet?i(m).then((([t,e])=>{const[n,i]=L(t,e);return s(`${n};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${i}\n})})(window,'_AWGS')`)})).then((()=>{const t=p._AWGS.pop();if(void 0===t)throw new SyntaxError;n(v.currentTime,v.sampleRate,(()=>t(class{},void 0,((t,s)=>{if(""===t.trim())throw e();const n=F.get(v);if(void 0!==n){if(n.has(t))throw e();B(s),z(s.parameterDescriptors),n.set(t,s)}else B(s),z(s.parameterDescriptors),F.set(v,new Map([[t,s]]))}),v.sampleRate,void 0,void 0)))})):Promise.all([i(m),Promise.resolve(t(u,u))]).then((([[t,e],s])=>{const n=d+1;d=n;const[i,o]=L(t,e),h=new Blob([`${i};((AudioWorkletProcessor,registerProcessor)=>{${o}\n})(${s?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${s?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${s?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${n}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),l=URL.createObjectURL(h);return v.audioWorklet.addModule(l,_).then((()=>{if(a(v))return v;const t=r(v);return t.audioWorklet.addModule(l,_).then((()=>t))})).then((t=>{if(null===c)throw new SyntaxError;try{new c(t,`__sac${n}`)}catch{throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(l)))}));return void 0===y?h.set(f,new Map([[m,x]])):y.set(m,x),x.then((()=>{const t=l.get(f);void 0===t?l.set(f,new Set([m])):t.add(m)})).finally((()=>{const t=h.get(f);void 0!==t&&t.delete(m)})),x}})(je,_e,(t=>e=>new Promise(((s,n)=>{if(null===t)return void n(new SyntaxError);const i=t.document.head;if(null===i)n(new SyntaxError);else{const o=t.document.createElement("script"),r=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(r),c=t.onerror,h=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(e,s,i,o,r)=>s===a||s===t.location.href&&1===i&&1===o?(h(),n(r),!1):null!==c?c(e,s,i,o,r):void 0,o.onerror=()=>{h(),n(new SyntaxError)},o.onload=()=>{h(),s()},o.src=a,o.type="module",i.appendChild(o)}})))(Be),bn,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw t()})((()=>new DOMException("","AbortError"))),Ze,Sn,$e,ns,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const s=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,44100),i=URL.createObjectURL(s);let o=!1,r=!1;try{await n.audioWorklet.addModule(i);const e=new t(n,"a",{numberOfOutputs:0}),s=n.createOscillator();e.port.onmessage=()=>o=!0,e.onprocessorerror=()=>r=!0,s.connect(e),s.start(0),await n.startRendering(),await new Promise((t=>setTimeout(t)))}catch{}finally{URL.revokeObjectURL(i)}return o&&!r})(ns,Ye),Be):void 0,An=((t,e)=>s=>t(s)||e(s))(ts,$e),Cn=((t,e,s,n,i,o,r,a,c,h,l)=>(u,p)=>{const d=r(u)?u:o(u);if(i.has(p)){const t=s();return Promise.reject(t)}try{i.add(p)}catch{}return e(c,(()=>c(d)))?d.decodeAudioData(p).then((s=>(Wt(p).catch((()=>{})),e(a,(()=>a(s)))||l(s),t.add(s),s))):new Promise(((e,s)=>{const i=async()=>{try{await Wt(p)}catch{}},o=t=>{s(t),i()};try{d.decodeAudioData(p,(s=>{"function"!=typeof s.copyFromChannel&&(h(s),et(s)),t.add(s),i().then((()=>e(s)))}),(t=>{o(null===t?n():t)}))}catch(t){o(t)}}))})(as,je,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,Ze,An,K,Kt,us,ps),On=((t,e,s,n,i,o,r,a,c,h,l,u,p,d,f,m,_,g,y,v)=>class extends f{constructor(e,s){super(e,s),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,s)=>t(this,e,s)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(t,e,n){return new s({length:e,numberOfChannels:t,sampleRate:n})}createBufferSource(){return new n(this)}createChannelMerger(t=6){return new o(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new r(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(t=1){return new l(this,{maxDelayTime:t})}createDynamicsCompressor(){return new u(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new d(this,{feedback:e,feedforward:t})}createOscillator(){return new m(this)}createPanner(){return new _(this)}createPeriodicWave(t,e,s={disableNormalization:!1}){return new g(this,{...s,imag:e,real:t})}createStereoPanner(){return new y(this)}createWaveShaper(){return new v(this)}decodeAudioData(t,e,s){return h(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t)),(t=>{throw"function"==typeof s&&s(t),t}))}})(kn,rs,ds,bs,As,Es,qs,Ns,Ls,Cn,Bs,Us,Zs,Js,en,on,pn,fn,yn,xn),Mn=((t,e,s,n)=>class extends t{constructor(t,i){const o=s(t),r=e(o,i);if(n(o))throw TypeError();super(t,!0,r,null),this._nativeMediaElementAudioSourceNode=r}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(is,((t,e)=>t.createMediaElementSource(e.mediaElement)),Ze,$e),Dn=((t,e,s,n)=>class extends t{constructor(t,i){const o=s(t);if(n(o))throw new TypeError;const r={...Jt,...i},a=e(o,r);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(is,((t,e)=>{const s=t.createMediaStreamDestination();return ee(s,e),1===s.numberOfOutputs&&Object.defineProperty(s,"numberOfOutputs",{get:()=>0}),s}),Ze,$e),En=((t,e,s,n)=>class extends t{constructor(t,i){const o=s(t),r=e(o,i);if(n(o))throw new TypeError;super(t,!0,r,null),this._nativeMediaStreamAudioSourceNode=r}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(is,((t,{mediaStream:e})=>{const s=e.getAudioTracks();s.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const n=s.slice(0,1),i=t.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(i,"mediaStream",{value:e}),i}),Ze,$e),Rn=((t,e)=>(s,{mediaStreamTrack:n})=>{if("function"==typeof s.createMediaStreamTrackSource)return s.createMediaStreamTrackSource(n);const i=new MediaStream([n]),o=s.createMediaStreamSource(i);if("audio"!==n.kind)throw t();if(e(s))throw new TypeError;return o})(Xt,$e),qn=((t,e,s)=>class extends t{constructor(t,n){const i=s(t);super(t,!0,e(i,n),null)}})(is,Rn,Ze),In=((t,e,s,n,i,o,r,a,c)=>class extends t{constructor(t={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");let e;try{e=new c(t)}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw s();throw t}if(null===e)throw n();if(!(t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t))(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw s();super(e,2);const{latencyHint:i}=t,{sampleRate:o}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===i?512/o:"interactive"===i||void 0===i?256/o:"playback"===i?1024/o:128*Math.max(2,Math.min(128,Math.round(i*o/128)))/o,this._nativeAudioContext=e,"webkitAudioContext"===c.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),lt(this)})))}createMediaElementSource(t){return new i(this,{mediaElement:t})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(t){return new r(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const s=()=>{this._nativeAudioContext.removeEventListener("statechange",s),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",s)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(On,Xt,_e,(()=>new DOMException("","UnknownError")),Mn,Dn,En,qn,Ke),Vn=(t=>e=>{const s=t.get(e);if(void 0===s)throw new Error("The context has no set of AudioWorkletNodes.");return s})(tn),Fn=(t=>(e,s)=>{t(e).add(s)})(Vn),Nn=(t=>(e,s,n=0,i=0)=>{const o=e[n];if(void 0===o)throw t();return Ot(s)?o.connect(s,0,i):o.connect(s,0)})(tt),Pn=(t=>(e,s)=>{t(e).delete(s)})(Vn),jn=(t=>(e,s=void 0,n=void 0,i=0)=>void 0===s?e.forEach((t=>t.disconnect())):"number"==typeof s?Ut(t,e,s).disconnect():Ot(s)?void 0===n?e.forEach((t=>t.disconnect(s))):void 0===i?Ut(t,e,n).disconnect(s,0):Ut(t,e,n).disconnect(s,0,i):void 0===n?e.forEach((t=>t.disconnect(s))):Ut(t,e,n).disconnect(s,0))(tt),Ln=new WeakMap,zn=((t,e)=>s=>e(t,s))(Ln,W),Bn=((t,e,s,n,i,o,r,a,c,h,l,u,p)=>(d,f,m,_)=>{if(0===_.numberOfInputs&&0===_.numberOfOutputs)throw c();const g=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(g.some((t=>t<1)))throw c();if(g.length!==_.numberOfOutputs)throw e();if("explicit"!==_.channelCountMode)throw c();const y=_.channelCount*_.numberOfInputs,v=g.reduce(((t,e)=>t+e),0),x=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(y+x>6||v>6)throw c();const w=new MessageChannel,b=[],T=[];for(let t=0;t<_.numberOfInputs;t+=1)b.push(r(d,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),T.push(i(d,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const S=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:s,name:n}of m.parameterDescriptors){const i=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==_.parameterData[n]?_.parameterData[n]:void 0===t?0:t});Object.defineProperties(i.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?it:e},minValue:{get:()=>void 0===s?nt:s}}),S.push(i)}const k=n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+x)}),A=re(f,d.sampleRate),C=a(d,A,y+x,Math.max(1,v)),O=i(d,{channelCount:Math.max(1,v),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,v)}),M=[];for(let t=0;t<_.numberOfOutputs;t+=1)M.push(n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[t]}));for(let t=0;t<_.numberOfInputs;t+=1){b[t].connect(T[t]);for(let e=0;e<_.channelCount;e+=1)T[t].connect(k,e,t*_.channelCount+e)}const D=new Rt(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((({name:t},e)=>{const s=S[e];return s.connect(k,0,y+e),s.start(0),[t,s.offset]})));k.connect(C);let E=_.channelInterpretation,R=null;const q=0===_.numberOfOutputs?[C]:M,I={get bufferSize(){return A},get channelCount(){return _.channelCount},set channelCount(t){throw s()},get channelCountMode(){return _.channelCountMode},set channelCountMode(t){throw s()},get channelInterpretation(){return E},set channelInterpretation(t){for(const e of b)e.channelInterpretation=t;E=t},get context(){return C.context},get inputs(){return b},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return R},set onprocessorerror(t){"function"==typeof R&&I.removeEventListener("processorerror",R),R="function"==typeof t?t:null,"function"==typeof R&&I.addEventListener("processorerror",R)},get parameters(){return D},get port(){return w.port2},addEventListener:(...t)=>C.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,q),disconnect:h.bind(null,q),dispatchEvent:(...t)=>C.dispatchEvent(t[0]),removeEventListener:(...t)=>C.removeEventListener(t[0],t[1],t[2])},V=new Map;var F,P;w.port1.addEventListener=(F=w.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const s=V.get(t[1]);void 0!==s?t[1]=s:(t[1]=t=>{l(d.currentTime,d.sampleRate,(()=>e(t)))},V.set(e,t[1]))}}return F.call(w.port1,t[0],t[1],t[2])}),w.port1.removeEventListener=(P=w.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=V.get(t[1]);void 0!==e&&(V.delete(t[1]),t[1]=e)}return P.call(w.port1,t[0],t[1],t[2])});let j=null;Object.defineProperty(w.port1,"onmessage",{get:()=>j,set:t=>{"function"==typeof j&&w.port1.removeEventListener("message",j),j="function"==typeof t?t:null,"function"==typeof j&&(w.port1.addEventListener("message",j),w.port1.start())}}),m.prototype.port=w.port1;let L=null;const z=((t,e,s,n)=>{let i=N.get(t);void 0===i&&(i=new WeakMap,N.set(t,i));const o=ae(s,n);return i.set(e,o),o})(d,I,m,_);z.then((t=>L=t));const B=Ft(_.numberOfInputs,_.channelCount),W=Ft(_.numberOfOutputs,g),G=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let U=!0;const Q=()=>{_.numberOfOutputs>0&&C.disconnect(O);for(let t=0,e=0;t<_.numberOfOutputs;t+=1){const s=M[t];for(let n=0;n<g[t];n+=1)O.disconnect(s,e+n,n);e+=g[t]}},Z=new Map;C.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==L){const s=u(I);for(let n=0;n<A;n+=128){for(let e=0;e<_.numberOfInputs;e+=1)for(let s=0;s<_.channelCount;s+=1)It(t,B[e],s,s,n);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((({name:e},s)=>{It(t,G,e,y+s,n)}));for(let t=0;t<_.numberOfInputs;t+=1)for(let e=0;e<g[t];e+=1)0===W[t][e].byteLength&&(W[t][e]=new Float32Array(128));try{const t=B.map(((t,e)=>{if(s[e].size>0)return Z.set(e,A/128),t;const n=Z.get(e);return void 0===n?[]:(t.every((t=>t.every((t=>0===t))))&&(1===n?Z.delete(e):Z.set(e,n-1)),t)})),i=l(d.currentTime+n/d.sampleRate,d.sampleRate,(()=>L.process(t,W,G)));U=i;for(let t=0,s=0;t<_.numberOfOutputs;t+=1){for(let i=0;i<g[t];i+=1)Vt(e,W[t],i,s+i,n);s+=g[t]}}catch(t){U=!1,I.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!U){for(let t=0;t<_.numberOfInputs;t+=1){b[t].disconnect(T[t]);for(let e=0;e<_.channelCount;e+=1)T[n].disconnect(k,e,t*_.channelCount+e)}if(void 0!==m.parameterDescriptors){const t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=S[e];t.disconnect(k,0,y+e),t.stop()}}k.disconnect(C),C.onaudioprocess=null,X?Q():H();break}}}};let X=!1;const Y=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),$=()=>C.connect(Y).connect(d.destination),H=()=>{C.disconnect(Y),Y.disconnect()};return $(),p(I,(()=>{if(U){H(),_.numberOfOutputs>0&&C.connect(O);for(let t=0,e=0;t<_.numberOfOutputs;t+=1){const s=M[t];for(let n=0;n<g[t];n+=1)O.connect(s,e+n,n);e+=g[t]}}X=!0}),(()=>{U&&($(),Q()),X=!1}))})(Nn,tt,Xt,Ms,he,Vs,pe,me,_e,jn,bn,zn,Cs),Wn=((t,e,s,n,i)=>(o,r,a,c,h,l)=>{if(null!==a)try{const e=new a(o,c,l),n=new Map;let r=null;if(Object.defineProperties(e,{channelCount:{get:()=>l.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>r,set:t=>{"function"==typeof r&&e.removeEventListener("processorerror",r),r="function"==typeof t?t:null,"function"==typeof r&&e.addEventListener("processorerror",r)}}}),e.addEventListener=(p=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const s=n.get(t[1]);void 0!==s?t[1]=s:(t[1]=s=>{"error"===s.type?(Object.defineProperties(s,{type:{value:"processorerror"}}),e(s)):e(new ErrorEvent(t[0],{...s}))},n.set(e,t[1]))}}return p.call(e,"error",t[1],t[2]),p.call(e,...t)}),e.removeEventListener=(u=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=n.get(t[1]);void 0!==e&&(n.delete(t[1]),t[1]=e)}return u.call(e,"error",t[1],t[2]),u.call(e,t[0],t[1],t[2])}),0!==l.numberOfOutputs){const t=s(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(o.destination);return i(e,(()=>t.disconnect()),(()=>t.connect(o.destination)))}return e}catch(t){if(11===t.code)throw n();throw t}var u,p;if(void 0===h)throw n();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(l),e(o,r,h,l)})(Xt,Bn,pe,_e,Cs),Gn=((t,e,s,n,i,o,r,a,c,h,l,u,p,d,f,m)=>(_,g,y)=>{const v=new WeakMap;let x=null;return{render(w,b){a(b,w);const T=v.get(b);return void 0!==T?Promise.resolve(T):(async(a,w)=>{let b=l(a),T=null;const S=J(b,w),k=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===u){const t=k.reduce(((t,e)=>t+e),0),s=i(w,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),o=[];for(let t=0;t<a.numberOfOutputs;t+=1)o.push(n(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:k[t]}));const h=r(w,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});h.connect=e.bind(null,o),h.disconnect=c.bind(null,o),T=[s,o,h]}else S||(b=new u(w,_));if(v.set(w,null===T?b:T[2]),null!==T){if(null===x){if(void 0===y)throw new Error("Missing the processor constructor.");if(null===p)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,s=t+e,c=async()=>{const c=new p(s,128*Math.ceil(a.context.length/128),w.sampleRate),h=[],l=[];for(let t=0;t<g.numberOfInputs;t+=1)h.push(r(c,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),l.push(i(c,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const u=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=o(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await d(c,t,e.offset),e}))),_=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){h[t].connect(l[t]);for(let e=0;e<g.channelCount;e+=1)l[t].connect(_,e,t*g.channelCount+e)}for(const[e,s]of u.entries())s.connect(_,0,t+e),s.start(0);return _.connect(c.destination),await Promise.all(h.map((t=>f(a,c,t)))),m(c)};x=Nt(a,0===s?null:await c(),w,g,k,y,h)}const t=await x,e=s(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,l,u]=T;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const s=l[t];for(let n=0;n<k[t];n+=1)c.connect(s,e+n,n);e+=k[t]}return u}if(S)for(const[e,s]of a.parameters.entries())await t(w,s,b.parameters.get(e));else for(const[t,e]of a.parameters.entries())await d(w,e,b.parameters.get(t));return await f(a,w,b),b})(w,b)}}})(_s,Nn,gs,Ms,he,Vs,pe,Pn,jn,bn,bt,ns,Ye,ys,Ue,Ys),Un=(t=>e=>t.get(e))(Tn),Qn=(t=>(e,s)=>{t.set(e,s)})(Ln),Zn=wn?((t,e,s,n,i,o,r,a,c,h,l,u,p,d)=>class extends e{constructor(e,d,f){var m;const _=a(e),g=c(_),y=l({...qt,...f});p(y);const v=F.get(_),x=null==v?void 0:v.get(d),w=g||"closed"!==_.state?_:null!==(m=r(_))&&void 0!==m?m:_,b=i(w,g?null:e.baseLatency,h,d,x,y);super(e,!0,b,g?n(d,y,x):null);const T=[];b.parameters.forEach(((t,e)=>{const n=s(this,g,t);T.push([e,n])})),this._nativeAudioWorkletNode=b,this._onprocessorerror=null,this._parameters=new Rt(T),g&&t(_,this);const{activeInputs:S}=o(this);u(b,S)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?d(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const s=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==s&&s===e?t:s}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(Fn,is,xs,Gn,Wn,at,Un,Ze,$e,ns,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),Qn,(t=>{const{port1:e,port2:s}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),s.close()}}),qe):void 0,Xn=((t,e)=>(s,n,i)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(s,n,i)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(_e,Ye),Yn=((t,e,s,n,i,o,r,a)=>(c,h)=>s(c).render(c,h).then((()=>Promise.all(Array.from(n(h)).map((t=>s(t).render(t,h)))))).then((()=>i(h))).then((s=>("function"!=typeof s.copyFromChannel?(r(s),et(s)):e(o,(()=>o(s)))||a(s),t.add(s),s))))(as,je,Ge,Vn,Ys,K,us,ps),$n=((t,e,s,n,i)=>class extends t{constructor(t,s,i){let o;if("number"==typeof t&&void 0!==s&&void 0!==i)o={length:s,numberOfChannels:t,sampleRate:i};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");o=t}const{length:r,numberOfChannels:a,sampleRate:c}={...ge,...o},h=n(a,r,c);e(Kt,(()=>Kt(h)))||h.addEventListener("statechange",(()=>{let t=0;const e=s=>{"running"===this._state&&(t>0?(h.removeEventListener("statechange",e),s.stopImmediatePropagation(),this._waitForThePromiseToSettle(s)):t+=1)};return e})()),super(h,a),this._length=r,this._nativeOfflineAudioContext=h,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(s()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,lt(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(On,je,Xt,Xn,Yn),Hn=((t,e)=>s=>{const n=t.get(s);return e(n)||e(s)})(q,ts),Jn=((t,e)=>s=>t.has(s)||e(s))(D,es),Kn=((t,e)=>s=>t.has(s)||e(s))(R,ss),ti=((t,e)=>s=>{const n=t.get(s);return e(n)||e(s)})(q,$e);function ei(t){return void 0===t}function si(t){return void 0!==t}function ni(t){return"function"==typeof t}function ii(t){return"number"==typeof t}function oi(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function ri(t){return"boolean"==typeof t}function ai(t){return Array.isArray(t)}function ci(t){return"string"==typeof t}function hi(t){return ci(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function li(t,e){if(!t)throw new Error(e)}function ui(t,e,s=1/0){if(!(e<=t&&t<=s))throw new RangeError(`Value must be within [${e}, ${s}], got: ${t}`)}function pi(t){t.isOffline||"running"===t.state||vi('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let di=!1,fi=!1;function mi(t){di=t}function _i(t){ei(t)&&di&&!fi&&(fi=!0,vi("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let gi=console;function yi(...t){gi.log(...t)}function vi(...t){gi.warn(...t)}var xi=Object.freeze({__proto__:null,assert:li,assertContextRunning:pi,assertRange:ui,assertUsedScheduleTime:_i,enterScheduledCallback:mi,log:yi,setLogger:function(t){gi=t},warn:vi});const wi="object"==typeof self?self:null,bi=wi&&(wi.hasOwnProperty("AudioContext")||wi.hasOwnProperty("webkitAudioContext"));function Ti(t,e,s,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(o<3?i(r):o>3?i(e,s,r):i(e,s))||r);return o>3&&r&&Object.defineProperty(e,s,r),r}function Si(t,e,s,n){return new(s||(s=Promise))((function(i,o){function r(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}c((n=n.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;class ki{constructor(t,e,s,n){this._callback=t,this._type=e,this._minimumUpdateInterval=Math.max(128/(n||44100),.001),this.updateInterval=s,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),s=new Worker(e);s.onmessage=this._callback.bind(this),this._worker=s}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){var e;this._updateInterval=Math.max(t,this._minimumUpdateInterval),"worker"===this._type&&(null===(e=this._worker)||void 0===e||e.postMessage(1e3*this._updateInterval))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function Ai(t){return Kn(t)}function Ci(t){return Jn(t)}function Oi(t){return ti(t)}function Mi(t){return Hn(t)}function Di(t,e){return"value"===t||Ai(e)||Ci(e)||function(t){return t instanceof ds}(e)}function Ei(t,...e){if(!e.length)return t;const s=e.shift();if(oi(t)&&oi(s))for(const e in s)Di(e,s[e])?t[e]=s[e]:oi(s[e])?(t[e]||Object.assign(t,{[e]:{}}),Ei(t[e],s[e])):Object.assign(t,{[e]:s[e]});return Ei(t,...e)}function Ri(t,e,s=[],n){const i={},o=Array.from(e);if(oi(o[0])&&n&&!Reflect.has(o[0],n)){Object.keys(o[0]).some((e=>Reflect.has(t,e)))||(Ei(i,{[n]:o[0]}),s.splice(s.indexOf(n),1),o.shift())}if(1===o.length&&oi(o[0]))Ei(i,o[0]);else for(let t=0;t<s.length;t++)si(o[t])&&(i[s[t]]=o[t]);return Ei(t,i)}function qi(t,e){return ei(t)?e:t}function Ii(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}
/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class Vi{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||wi&&this.toString()===wi.TONE_DEBUG_CLASS)&&yi(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Vi.version=a;const Fi=1e-6;function Ni(t,e){return t>e+Fi}function Pi(t,e){return Ni(t,e)||Li(t,e)}function ji(t,e){return t+Fi<e}function Li(t,e){return Math.abs(t-e)<Fi}function zi(t,e,s){return Math.max(Math.min(t,s),e)}class Bi extends Vi{constructor(){super(),this.name="Timeline",this._timeline=[];const t=Ri(Bi.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(li(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];li(Pi(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const s=this._search(t,e);return-1!==s?this._timeline[s]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const s=this._search(t,e);return s+1<this._timeline.length?this._timeline[s+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const s=this._search(t);return s-1>=0?this._timeline[s-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Li(this._timeline[e].time,t)){for(let s=e;s>=0&&Li(this._timeline[s].time,t);s--)e=s;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&Pi(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let s=0;const n=this._timeline.length;let i=n;if(n>0&&this._timeline[n-1][e]<=t)return n-1;for(;s<i;){let n=Math.floor(s+(i-s)/2);const o=this._timeline[n],r=this._timeline[n+1];if(Li(o[e],t)){for(let s=n;s<this._timeline.length;s++){if(!Li(this._timeline[s][e],t))break;n=s}return n}if(ji(o[e],t)&&Ni(r[e],t))return n;Ni(o[e],t)?i=n:s=n+1}return-1}_iterate(t,e=0,s=this._timeline.length-1){this._timeline.slice(e,s+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const s=this._search(t);return-1!==s&&this._iterate(e,0,s),this}forEachAfter(t,e){const s=this._search(t);return this._iterate(e,s+1),this}forEachBetween(t,e,s){let n=this._search(t),i=this._search(e);return-1!==n&&-1!==i?(this._timeline[n].time!==t&&(n+=1),this._timeline[i].time===e&&(i-=1),this._iterate(s,n,i)):-1===n&&this._iterate(s,0,i),this}forEachFrom(t,e){let s=this._search(t);for(;s>=0&&this._timeline[s].time>=t;)s--;return this._iterate(e,s+1),this}forEachAtTime(t,e){const s=this._search(t);if(-1!==s&&Li(this._timeline[s].time,t)){let n=s;for(let e=s;e>=0&&Li(this._timeline[e].time,t);e--)n=e;this._iterate((t=>{e(t)}),n,s)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Wi=[];function Gi(t){Wi.push(t)}const Ui=[];function Qi(t){Ui.push(t)}class Zi extends Vi{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{ei(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const s=(...n)=>{e(...n),this.off(t,s)};return this.on(t,s),this}off(t,e){return t.split(/\W+/).forEach((t=>{if(ei(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(ei(e))this._events[t]=[];else{const s=this._events[t];for(let t=s.length-1;t>=0;t--)s[t]===e&&s.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const s=this._events[t].slice(0);for(let t=0,n=s.length;t<n;t++)s[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const s=Object.getOwnPropertyDescriptor(Zi.prototype,e);Object.defineProperty(t.prototype,e,s)}))}dispose(){return super.dispose(),this._events=void 0,this}}class Xi extends Zi{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Yi extends Xi{constructor(){var t,e;super(),this.name="Context",this._constants=new Map,this._timeouts=new Bi,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const s=Ri(Yi.getDefaults(),arguments,["context"]);s.context?(this._context=s.context,this._latencyHint=(null===(t=arguments[0])||void 0===t?void 0:t.latencyHint)||""):(this._context=function(t){return new In(t)}({latencyHint:s.latencyHint}),this._latencyHint=s.latencyHint),this._ticker=new ki(this.emit.bind(this,"tick"),s.clockSource,s.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[(null===(e=arguments[0])||void 0===e?void 0:e.hasOwnProperty("updateInterval"))?"_lookAhead":"lookAhead"]=s.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,Wi.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,s){return this._context.createBuffer(t,e,s)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,s){return this._context.createPeriodicWave(t,e,s)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){li(Mi(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaElementSource(t){li(Mi(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(t)}createMediaStreamDestination(){li(Mi(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){li(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){li(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){li(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){li(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,s){return li(si(Zn),"AudioWorkletNode only works in a secure context (https or localhost)"),new(t instanceof(null==wi?void 0:wi.BaseAudioContext)?null==wi?void 0:wi.AudioWorkletNode:Zn)(t,e,s)}(this.rawContext,t,e)}addAudioWorkletModule(t){return Si(this,void 0,void 0,(function*(){li(si(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(t)),yield this._workletPromise}))}workletsAreReady(){return Si(this,void 0,void 0,(function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get lookAhead(){return this._lookAhead}set lookAhead(t){this._lookAhead=t,this.updateInterval=t?t/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return Mi(this._context)?this._context.resume():Promise.resolve()}close(){return Si(this,void 0,void 0,(function*(){var t;Mi(this._context)&&"closed"!==this.state&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&(t=this,Ui.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),s=e.getChannelData(0);for(let e=0;e<s.length;e++)s[e]=t;const n=this._context.createBufferSource();return n.channelCount=1,n.channelCountMode="explicit",n.buffer=e,n.loop=!0,n.start(0),this._constants.set(t,n),n}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this.close(),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const s=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:s+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const s=++this._timeoutIds,n=()=>{const i=this.now();this._timeouts.add({callback:()=>{t(),n()},id:s,time:i+e})};return n(),s}}function $i(t,e){ai(e)?e.forEach((e=>$i(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Hi(t,e){ai(e)?e.forEach((e=>Hi(t,e))):Object.defineProperty(t,e,{writable:!0})}const Ji=()=>{};class Ki extends Vi{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Ji;const t=Ri(Ki.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,ci(t.url)?this.load(t.url).catch(t.onerror):t.url&&this.set(t.url)}static getDefaults(){return{onerror:Ji,onload:Ji,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:no().sampleRate}set(t){return t instanceof Ki?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return Si(this,void 0,void 0,(function*(){const e=Ki.load(t).then((t=>{this.set(t),this.onload(this)}));Ki.downloads.push(e);try{yield e}finally{const t=Ki.downloads.indexOf(e);Ki.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=ai(t)&&t[0].length>0,s=e?t.length:1,n=e?t[0].length:t.length,i=no(),o=i.createBuffer(s,n,i.sampleRate),r=e||1!==s?t:[t];for(let t=0;t<s;t++)o.copyToChannel(r[t],t);return this._buffer=o,this}toMono(t){if(ii(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let s=0;s<e;s++){const e=this.toArray(s);for(let s=0;s<e.length;s++)t[s]+=e[s]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(ii(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){li(this.loaded,"Buffer is not loaded");const s=Math.floor(t*this.sampleRate),n=Math.floor(e*this.sampleRate);li(s<n,"The start time must be less than the end time");const i=n-s,o=no().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)o.copyToChannel(this.getChannelData(t).subarray(s,n),t);return new Ki(o)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new Ki).fromArray(t)}static fromUrl(t){return Si(this,void 0,void 0,(function*(){const e=new Ki;return yield e.load(t)}))}static load(t){return Si(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const s=e[1].split("|");let n=s[0];for(const t of s)if(Ki.supportsType(t)){n=t;break}t=t.replace(e[0],n)}const s=""===Ki.baseUrl||Ki.baseUrl.endsWith("/")?Ki.baseUrl:Ki.baseUrl+"/",n=document.createElement("a");n.href=s+t,n.pathname=(n.pathname+n.hash).split("/").map(encodeURIComponent).join("/");const i=yield fetch(n.href);if(!i.ok)throw new Error(`could not load url: ${t}`);const o=yield i.arrayBuffer();return yield no().decodeAudioData(o)}))}static supportsType(t){const e=t.split("."),s=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+s)}static loaded(){return Si(this,void 0,void 0,(function*(){for(yield Promise.resolve();Ki.downloads.length;)yield Ki.downloads[0]}))}}Ki.baseUrl="",Ki.downloads=[];class to extends Yi{constructor(){var t,e,s;super({clockSource:"offline",context:Oi(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],s=arguments[2],new $n(t,e,s)),lookAhead:0,updateInterval:Oi(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Oi(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Si(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const s=Math.floor(this.sampleRate/128);t&&e%s==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(){return Si(this,arguments,void 0,(function*(t=!0){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new Ki(e)}))}close(){return Promise.resolve()}}const eo=new class extends Xi{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,s){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,s){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t){return Si(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let so=eo;function no(){return so===eo&&bi&&io(new Yi),so}function io(t,e=!1){e&&so.dispose(),so=Mi(t)?new Yi(t):Oi(t)?new to(t):t}if(wi&&!wi.TONE_SILENCE_LOGGING){const t=` * Tone.js ${"v"}${a} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function oo(t){return Math.pow(10,t/20)}function ro(t){return Math.log(t)/Math.LN10*20}function ao(t){return Math.pow(2,t/12)}let co=440;function ho(t){return Math.round(lo(t))}function lo(t){return 69+12*Math.log2(t/co)}function uo(t){return co*Math.pow(2,(t-69)/12)}class po extends Vi{constructor(t,e,s){super(),this.defaultUnits="s",this._val=e,this._units=s,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const s=parseInt(t,10),n="."===e?1.5:1;return 1===s?this._beatsToUnits(this._getTimeSignature())*n:this._beatsToUnits(4/s)*n},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,s)=>{let n=0;return t&&"0"!==t&&(n+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(n+=this._beatsToUnits(parseFloat(e))),s&&"0"!==s&&(n+=this._beatsToUnits(parseFloat(s)/4)),n},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof po&&this.fromType(this._val),ei(this._val))return this._noArg();if(ci(this._val)&&ei(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(oi(this._val)){let t=0;for(const e in this._val)if(si(this._val[e])){const s=this._val[e];t+=new this.constructor(this.context,e).valueOf()*s}return t}if(si(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return ci(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class fo extends po{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new fo(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const s=new this.constructor(this.context,t).valueOf(),n=this.valueOf();return n+(Math.round(n/s)*s-n)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const s=Math.pow(2,t);e.push(s+"n."),e.push(s+"n"),e.push(s+"t")}e.push("0");let s=e[0],n=new fo(this.context,e[0]).toSeconds();return e.forEach((e=>{const i=new fo(this.context,e).toSeconds();Math.abs(i-t)<Math.abs(n-t)&&(s=e,n=i)})),s}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const s=Math.floor(e/this._getTimeSignature());let n=e%1*4;e=Math.floor(e)%this._getTimeSignature();const i=n.toString();i.length>3&&(n=parseFloat(parseFloat(i).toFixed(3)));return[s,e,n].join(":")}toTicks(){const t=this._beatsToUnits(1);return this.valueOf()/t*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return ho(this.toFrequency())}_now(){return this.context.now()}}class mo extends fo{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return co}static set A4(t){!function(t){co=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:mo.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(t,e){const s=_o[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?s:mo.mtof(s)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,s){let n=1;return t&&"0"!==t&&(n*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(n*=this._beatsToUnits(parseFloat(e))),s&&"0"!==s&&(n*=this._beatsToUnits(parseFloat(s)/4)),n}}})}transpose(t){return new mo(this.context,this.valueOf()*ao(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return ho(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/mo.A4);let s=Math.round(12*e)+57;const n=Math.floor(s/12);n<0&&(s+=-12*n);return go[s%12]+n.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return uo(t)}static ftom(t){return ho(t)}}const _o={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},go=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class yo extends fo{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class vo extends Vi{constructor(){super();const t=Ri(vo.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:no()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return _i(t),new fo(this.context,t).toSeconds()}toFrequency(t){return new mo(this.context,t).toFrequency()}toTicks(t){return new yo(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((s=>{ei(t[s])&&delete e[s]})),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const s=this[e];si(s)&&si(s.value)&&si(s.setValueAtTime)?t[e]=s.value:s instanceof vo?t[e]=s._getPartialProperties(t[e]):ai(s)||ii(s)||ci(s)||ri(s)?t[e]=s:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&si(this[e])&&(this[e]&&si(this[e].value)&&si(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof vo?this[e].set(t[e]):this[e]=t[e])})),this}}class xo extends Bi{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,s){return ui(e,0),this.add(Object.assign({},s,{state:t,time:e})),this}getLastState(t,e){for(let s=this._search(e);s>=0;s--){const e=this._timeline[s];if(e.state===t)return e}}getNextState(t,e){const s=this._search(e);if(-1!==s)for(let e=s;e<this._timeline.length;e++){const s=this._timeline[e];if(s.state===t)return s}}}class wo extends vo{constructor(){const t=Ri(wo.getDefaults(),arguments,["param","units","convert"]);for(super(t),this.name="Param",this.overridden=!1,this._minOutput=1e-7,li(si(t.param)&&(Ai(t.param)||t.param instanceof wo),"param must be an AudioParam");!Ai(t.param);)t.param=t.param._param;this._swappable=!!si(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Bi(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,si(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(vo.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return si(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return si(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return si(this.maxValue)&&si(this.minValue)&&ui(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?oo(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?ro(t):t}setValueAtTime(t,e){const s=this.toSeconds(e),n=this._fromType(t);return li(isFinite(n)&&isFinite(s),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this.log(this.units,"setValueAtTime",t,s),this._events.add({time:s,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,s),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),s=this._events.getAfter(e),n=this._events.get(e);let i=this._initialValue;if(null===n)i=this._initialValue;else if("setTargetAtTime"!==n.type||null!==s&&"setValueAtTime"!==s.type)if(null===s)i=n.value;else if("linearRampToValueAtTime"===s.type||"exponentialRampToValueAtTime"===s.type){let t=n.value;if("setTargetAtTime"===n.type){const e=this._events.getBefore(n.time);t=null===e?this._initialValue:e.value}i="linearRampToValueAtTime"===s.type?this._linearInterpolate(n.time,t,s.time,s.value,e):this._exponentialInterpolate(n.time,t,s.time,s.value,e)}else i=n.value;else{const t=this._events.getBefore(n.time);let s;s=null===t?this._initialValue:t.value,"setTargetAtTime"===n.type&&(i=this._exponentialApproach(n.time,s,n.value,n.constant,e))}return this._toType(i)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const s=this._fromType(t),n=this.toSeconds(e);return li(isFinite(s)&&isFinite(n),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(s),this._events.add({time:n,type:"linearRampToValueAtTime",value:s}),this.log(this.units,"linearRampToValueAtTime",t,n),this._param.linearRampToValueAtTime(s,n),this}exponentialRampToValueAtTime(t,e){let s=this._fromType(t);s=Li(s,0)?this._minOutput:s,this._assertRange(s);const n=this.toSeconds(e);return li(isFinite(s)&&isFinite(n),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:n,type:"exponentialRampToValueAtTime",value:s}),this.log(this.units,"exponentialRampToValueAtTime",t,n),this._param.exponentialRampToValueAtTime(s,n),this}exponentialRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialRampToValueAtTime(t,s+this.toSeconds(e)),this}linearRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.linearRampToValueAtTime(t,s+this.toSeconds(e)),this}targetRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialApproachValueAtTime(t,s,e),this}exponentialApproachValueAtTime(t,e,s){e=this.toSeconds(e),s=this.toSeconds(s);const n=Math.log(s+1)/Math.log(200);return this.setTargetAtTime(t,e,n),this.cancelAndHoldAtTime(e+.9*s),this.linearRampToValueAtTime(t,e+s),this}setTargetAtTime(t,e,s){const n=this._fromType(t);li(isFinite(s)&&s>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(e);return this._assertRange(n),li(isFinite(n)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:s,time:i,type:"setTargetAtTime",value:n}),this.log(this.units,"setTargetAtTime",t,i,s),this._param.setTargetAtTime(n,i,s),this}setValueCurveAtTime(t,e,s,n=1){s=this.toSeconds(s),e=this.toSeconds(e);const i=this._fromType(t[0])*n;this.setValueAtTime(this._toType(i),e);const o=s/(t.length-1);for(let s=1;s<t.length;s++){const i=this._fromType(t[s])*n;this.linearRampToValueAtTime(this._toType(i),e+s*o)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return li(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),s=this._fromType(this.getValueAtTime(e));li(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+s);const n=this._events.get(e),i=this._events.getAfter(e);return n&&Li(n.time,e)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(s),e):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(s),e)),this._events.add({time:e,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,e),this}rampTo(t,e=.1,s){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,s):this.linearRampTo(t,e,s),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const s=this._events.get(e);if(s&&"setTargetAtTime"===s.type){const n=this._events.getAfter(s.time),i=n?n.time:e+2,o=(i-e)/10;for(let s=e;s<i;s+=o)t.linearRampToValueAtTime(this.getValueAtTime(s),s)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){li(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,s,n,i){return s+(e-s)*Math.exp(-(i-t)/n)}_linearInterpolate(t,e,s,n,i){return e+(i-t)/(s-t)*(n-e)}_exponentialInterpolate(t,e,s,n,i){return e*Math.pow(n/e,(i-t)/(s-t))}}class bo extends vo{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return si(this.input)?Ai(this.input)||this.input instanceof wo?1:this.input.numberOfInputs:0}get numberOfOutputs(){return si(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return si(t)&&(t instanceof bo||Ci(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();li(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,s=0){return So(this,t,e,s),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return vi("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,s=0){return ko(this,t,e,s),this}chain(...t){return To(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),si(this.input)&&(this.input instanceof bo?this.input.dispose():Ci(this.input)&&this.input.disconnect()),si(this.output)&&(this.output instanceof bo?this.output.dispose():Ci(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function To(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof bo?t.connect(e):Ci(t)&&So(t,e),e)),e)}function So(t,e,s=0,n=0){for(li(si(t),"Cannot connect from undefined node"),li(si(e),"Cannot connect to undefined node"),(e instanceof bo||Ci(e))&&li(e.numberOfInputs>0,"Cannot connect to node with no inputs"),li(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof bo||e instanceof wo;)si(e.input)&&(e=e.input);for(;t instanceof bo;)si(t.output)&&(t=t.output);Ai(e)?t.connect(e,s):t.connect(e,s,n)}function ko(t,e,s=0,n=0){if(si(e))for(;e instanceof bo;)e=e.input;for(;!Ci(t);)si(t.output)&&(t=t.output);Ai(e)?t.disconnect(e,s):Ci(e)?t.disconnect(e,s,n):t.disconnect()}class Ao extends bo{constructor(){const t=Ri(Ao.getDefaults(),arguments,["gain","units"]);super(t),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new wo({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),$i(this,"gain")}static getDefaults(){return Object.assign(bo.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Co extends bo{constructor(t){super(t),this.onended=Ji,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Ao({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(bo.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Ji})}_startGain(t,e=1){li(-1===this._startTime,"Source cannot be started more than once");const s=this.toSeconds(this._fadeIn);return this._startTime=t+s,this._startTime=Math.max(this._startTime,this.context.currentTime),s>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+s):this._gainNode.gain.exponentialApproachValueAtTime(e,t,s)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){li(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.now()),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Ji&&(this.onended(this),this.onended=Ji,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),li(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Ji,this}}class Oo extends Co{constructor(){const t=Ri(Oo.getDefaults(),arguments,["offset"]);super(t),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),So(this._source,this._gainNode),this.offset=new wo({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Co.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Mo extends bo{constructor(){const t=Ri(Mo.getDefaults(),arguments,["value","units"]);super(t),this.name="Signal",this.override=!0,this.output=this._constantSource=new Oo({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(bo.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,s=0){return Do(this,t,e,s),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,s){return this._param.exponentialRampTo(t,e,s),this}linearRampTo(t,e,s){return this._param.linearRampTo(t,e,s),this}targetRampTo(t,e,s){return this._param.targetRampTo(t,e,s),this}exponentialApproachValueAtTime(t,e,s){return this._param.exponentialApproachValueAtTime(t,e,s),this}setTargetAtTime(t,e,s){return this._param.setTargetAtTime(t,e,s),this}setValueCurveAtTime(t,e,s,n){return this._param.setValueCurveAtTime(t,e,s,n),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,s){return this._param.rampTo(t,e,s),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function Do(t,e,s,n){(e instanceof wo||Ai(e)||e instanceof Mo&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Mo&&(e.overridden=!0)),So(t,e,s,n)}class Eo extends wo{constructor(){const t=Ri(Eo.getDefaults(),arguments,["value"]);super(t),this.name="TickParam",this._events=new Bi(1/0),this._multiplier=1,this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(wo.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,s){e=this.toSeconds(e),this.setRampPoint(e);const n=this._fromType(t),i=this._events.get(e),o=Math.round(Math.max(1/s,1));for(let t=0;t<=o;t++){const o=s*t+e,r=this._exponentialApproach(i.time,i.value,n,s,o);this.linearRampToValueAtTime(this._toType(r),o)}return this}setValueAtTime(t,e){const s=this.toSeconds(e);super.setValueAtTime(t,e);const n=this._events.get(s),i=this._events.previousEvent(n),o=this._getTicksUntilEvent(i,s);return n.ticks=Math.max(o,0),this}linearRampToValueAtTime(t,e){const s=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const n=this._events.get(s),i=this._events.previousEvent(n),o=this._getTicksUntilEvent(i,s);return n.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const s=this._fromType(t),n=this._events.get(e),i=Math.round(Math.max(10*(e-n.time),1)),o=(e-n.time)/i;for(let t=0;t<=i;t++){const i=o*t+n.time,r=this._exponentialInterpolate(n.time,n.value,e,s,i);this.linearRampToValueAtTime(this._toType(r),i)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ei(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const s=this._fromType(this.getValueAtTime(t.time));let n=this._fromType(this.getValueAtTime(e));const i=this._events.get(e);return i&&i.time===e&&"setValueAtTime"===i.type&&(n=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(s+n)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),s=this._events.get(e);return Math.max(this._getTicksUntilEvent(s,e),0)}getDurationOfTicks(t,e){const s=this.toSeconds(e),n=this.getTicksAtTime(e);return this.getTimeOfTick(n+t)-s}getTimeOfTick(t){const e=this._events.get(t,"ticks"),s=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&s&&"linearRampToValueAtTime"===s.type&&e.value!==s.value){const n=this._fromType(this.getValueAtTime(e.time)),i=(this._fromType(this.getValueAtTime(s.time))-n)/(s.time-e.time),o=Math.sqrt(Math.pow(n,2)-2*i*(e.ticks-t)),r=(-n+o)/i;return(r>0?r:(-n-o)/i)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const s=this.toSeconds(e),n=this.toSeconds(t),i=this.getTicksAtTime(s);return this.getTicksAtTime(s+n)-i}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Ro extends Mo{constructor(){const t=Ri(Ro.getDefaults(),arguments,["value"]);super(t),this.name="TickSignal",this.input=this._param=new Eo({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Mo.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class qo extends vo{constructor(){const t=Ri(qo.getDefaults(),arguments,["frequency"]);super(t),this.name="TickSource",this._state=new xo,this._tickOffset=new Bi,this._ticksAtTime=new Bi,this._secondsAtTime=new Bi,this.frequency=new Ro({context:this.context,units:t.units,value:t.frequency}),$i(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},vo.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const s=this.toSeconds(t);return"started"!==this._state.getValueAtTime(s)&&(this._state.setStateAtTime("started",s),si(e)&&this.setTicksAtTime(e,s),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e)),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),s=this._state.getLastState("stopped",e),n=this._ticksAtTime.get(e),i={state:"paused",time:e};this._state.add(i);let o=n||s,r=n?n.ticks:0,a=null;return this._state.forEachBetween(o.time,e+this.sampleTime,(t=>{let e=o.time;const s=this._tickOffset.get(t.time);s&&s.time>=o.time&&(r=s.ticks,e=s.time),"started"===o.state&&"started"!==t.state&&(r+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e),t.time!==i.time&&(a={state:t.state,time:t.time,ticks:r})),o=t})),this._state.remove(i),a&&this._ticksAtTime.add(a),r}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),s=this.frequency.timeToTicks(t,e);this.setTicksAtTime(s,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),s={state:"paused",time:t};this._state.add(s);const n=this._secondsAtTime.get(t);let i=n||e,o=n?n.seconds:0,r=null;return this._state.forEachBetween(i.time,t+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(o=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(o+=t.time-e,t.time!==s.time&&(r={state:t.state,time:t.time,seconds:o})),i=t})),this._state.remove(s),r&&this._secondsAtTime.add(r),o}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const s=this._tickOffset.get(e),n=this._state.get(e),i=Math.max(s.time,n.time),o=this.frequency.getTicksAtTime(i)+t-s.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(t,e,s){let n=this._state.get(t);this._state.forEachBetween(t,e,(e=>{n&&"started"===n.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(n.time,t),e.time-this.sampleTime,s),n=e}));let i=null;if(n&&"started"===n.state){const o=Math.max(n.time,t),r=this.frequency.getTicksAtTime(o),a=r-this.frequency.getTicksAtTime(n.time);let c=Math.ceil(a)-a;c=Li(c,1)?0:c;let h=this.frequency.getTimeOfTick(r+c);for(;h<e;){try{s(h,Math.round(this.getTicksAtTime(h)))}catch(t){i=t;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class Io extends vo{constructor(){const t=Ri(Io.getDefaults(),arguments,["callback","frequency"]);super(t),this.name="Clock",this.callback=Ji,this._lastUpdate=0,this._state=new xo("stopped"),this._boundLoop=this._loop.bind(this),this.callback=t.callback,this._tickSource=new qo({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,$i(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(vo.getDefaults(),{callback:Ji,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){pi(this.context);const s=this.toSeconds(t);return this.log("start",s),"started"!==this._state.getValueAtTime(s)&&(this._state.setStateAtTime("started",s),this._tickSource.start(s,e),s<this._lastUpdate&&this.emit("start",s,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const s=this.toSeconds(e),n=this.getTicksAtTime(s);return this._tickSource.getTimeOfTick(n+t,s)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Zi.mixin(Io);class Vo extends bo{constructor(){const t=Ri(Vo.getDefaults(),arguments,["delayTime","maxDelay"]);super(t),this.name="Delay";const e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new wo({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),$i(this,"delayTime")}static getDefaults(){return Object.assign(bo.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class Fo extends bo{constructor(){const t=Ri(Fo.getDefaults(),arguments,["volume"]);super(t),this.name="Volume",this.input=this.output=new Ao({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,$i(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class No extends bo{constructor(){const t=Ri(No.getDefaults(),arguments);super(t),this.name="Destination",this.input=new Fo({context:this.context}),this.output=new Ao({context:this.context}),this.volume=this.input.volume,To(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),To(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Gi((t=>{t.destination=new No({context:t})})),Qi((t=>{t.destination.dispose()}));class Po extends bo{constructor(){super(...arguments),this.name="Listener",this.positionX=new wo({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new wo({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new wo({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new wo({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new wo({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new wo({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new wo({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new wo({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new wo({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(bo.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Gi((t=>{t.listener=new Po({context:t})})),Qi((t=>{t.listener.dispose()}));class jo extends Vi{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=Ri(jo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const s=t.urls[e];this.add(e,s,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:Ji,onload:Ji,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return li(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,s=Ji,n=Ji){return ci(e)?(this.baseUrl&&"data:audio/"===e.trim().substring(0,11).toLowerCase()&&(this.baseUrl=""),this._buffers.set(t.toString(),new Ki(this.baseUrl+e,s,n))):this._buffers.set(t.toString(),new Ki(e,s,n)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class Lo extends mo{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return ho(super._frequencyToUnits(t))}_ticksToUnits(t){return ho(super._ticksToUnits(t))}_beatsToUnits(t){return ho(super._beatsToUnits(t))}_secondsToUnits(t){return ho(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return uo(this.toMidi())}transpose(t){return new Lo(this.context,this.toMidi()+t)}}class zo extends yo{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Bo extends vo{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Bi,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Gi((t=>{t.draw=new Bo({context:t})})),Qi((t=>{t.draw.dispose()}));class Wo extends Vi{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){li(si(t.time),"Events must have a time property"),li(si(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Go(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const s of e)if(s.event===t){this._removeNode(s),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,s=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,s=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,s=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,s=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,s=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),s&&this._rebalance(s)}t.dispose()}_rotateLeft(t){const e=t.parent,s=t.isLeftChild(),n=t.right;n&&(t.right=n.left,n.left=t),null!==e?s?e.left=n:e.right=n:this._setRoot(n)}_rotateRight(t){const e=t.parent,s=t.isLeftChild(),n=t.left;n&&(t.left=n.right,n.right=t),null!==e?s?e.left=n:e.right=n:this._setRoot(n)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let s=1;s<e.length;s++)e[s].low>t.low&&(t=e[s]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const s=[];this._root.search(t,s),s.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const s=[];this._root.searchAfter(t,s),s.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class Go{constructor(t,e,s){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=s,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}var Uo=Object.freeze({__proto__:null});class Qo extends Vi{constructor(t){super(),this.name="TimelineValue",this._timeline=new Bi({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class Zo extends bo{constructor(){super(Ri(Zo.getDefaults(),arguments,["context"]))}connect(t,e=0,s=0){return Do(this,t,e,s),this}}class Xo extends Zo{constructor(){const t=Ri(Xo.getDefaults(),arguments,["mapping","length"]);super(t),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,ai(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):ni(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Mo.getDefaults(),{length:1024})}setMap(t,e=1024){const s=new Float32Array(e);for(let n=0,i=e;n<i;n++){const e=n/(i-1)*2-1;s[n]=t(e,n)}return this.curve=s,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){li(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Yo extends Zo{constructor(){const t=Ri(Yo.getDefaults(),arguments,["value"]);super(t),this.name="Pow",this._exponentScaler=this.input=this.output=new Xo({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(Zo.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class $o{constructor(t,e){this.id=$o._eventId++,this._remainderTime=0;const s=Object.assign($o.getDefaults(),e);this.transport=t,this.callback=s.callback,this._once=s.once,this.time=Math.floor(s.time),this._remainderTime=s.time-this.time}static getDefaults(){return{callback:Ji,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(t){if(this.callback){const e=this.transport.bpm.getDurationOfTicks(1,t);this.callback(t+this._remainderTime*e),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}$o._eventId=0;class Ho extends $o{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const s=Object.assign(Ho.getDefaults(),e);this.duration=s.duration,this._interval=s.interval,this._nextTick=s.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},$o.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvent(){return ji(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new zo(this.context,this._nextTick).toSeconds()):-1}_createEvents(t){ji(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new zo(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const e=this.transport.getTicksAtTime(t);Ni(e,this.time)&&(this._nextTick=this.floatTime+Math.ceil((e-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class Jo extends vo{constructor(){const t=Ri(Jo.getDefaults(),arguments);super(t),this.name="Transport",this._loop=new Qo(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Bi,this._repeatedEvents=new Wo,this._syncedSignals=[],this._swingAmount=0,this._ppq=t.ppq,this._clock=new Io({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),$i(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(vo.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const s=e%(2*this._swingTicks)/(2*this._swingTicks),n=Math.sin(s*Math.PI)*this._swingAmount;t+=new zo(this.context,2*this._swingTicks/3).toSeconds()*n}mi(!0),this._timeline.forEachAtTime(e,(e=>e.invoke(t))),mi(!1)}schedule(t,e){const s=new $o(this,{callback:t,time:new yo(this.context,e).toTicks()});return this._addEvent(s,this._timeline)}scheduleRepeat(t,e,s,n=1/0){const i=new Ho(this,{callback:t,duration:new fo(this.context,n).toTicks(),interval:new fo(this.context,e).toTicks(),time:new yo(this.context,s).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(t,e){const s=new $o(this,{callback:t,once:!0,time:new yo(this.context,e).toTicks()});return this._addEvent(s,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new zo(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let s;return this.context.resume(),si(e)&&(s=this.toTicks(e)),this._clock.start(t,s),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){ai(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new fo(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new fo(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new zo(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new zo(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),s=this._clock.frequency.timeToTicks(t,e);this.ticks=s}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const s=this._clock.getTicksAtTime(e),n=e+this._clock.frequency.getDurationOfTicks(Math.ceil(s)-s,e);this.emit("stop",n),this._clock.setTicksAtTime(t,n),this.emit("start",n,this._clock.getSecondsAtTime(n))}else this.emit("ticks",e),this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return this._clock.getTicksAtTime(t)}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),s=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(s,e)}}syncSignal(t,e){const s=this.now();let n=this.bpm,i=1/(60/n.getValueAtTime(s)/this.PPQ),o=[];if("time"===t.units){const t=1/64/i,e=new Ao(t),s=new Yo(-1),r=new Ao(t);n.chain(e,s,r),n=r,i=1/i,o=[e,s,r]}e||(e=0!==t.getValueAtTime(s)?t.getValueAtTime(s)/i:0);const r=new Ao(e);return n.connect(r),r.connect(t._param),o.push(r),this._syncedSignals.push({initial:t.value,nodes:o,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const s=this._syncedSignals[e];s.signal===t&&(s.nodes.forEach((t=>t.dispose())),s.signal.value=s.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Hi(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Zi.mixin(Jo),Gi((t=>{t.transport=new Jo({context:t})})),Qi((t=>{t.transport.dispose()}));class Ko extends bo{constructor(t){super(t),this.input=void 0,this._state=new xo("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Ji,this._syncedStop=Ji,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Fo({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,$i(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,onstop:Ji,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,s){let n=ei(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(n=this._clampToCurrentTime(n),this._synced||"started"!==this._state.getValueAtTime(n))if(this.log("start",n),this._state.setStateAtTime("started",n),this._synced){const t=this._state.get(n);t&&(t.offset=this.toSeconds(qi(e,0)),t.duration=s?this.toSeconds(s):void 0);const i=this.context.transport.schedule((t=>{this._start(t,e,s)}),n);this._scheduled.push(i),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>n&&this._syncedStart(this.now(),this.context.transport.seconds)}else pi(this.context),this._start(n,e,s);else li(Ni(n,this._state.get(n).time),"Start time must be strictly greater than previous start time"),this._state.cancel(n),this._state.setStateAtTime("started",n),this.log("restart",n),this.restart(n,e,s);return this}stop(t){let e=ei(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||si(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,s){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,s)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(Ni(e,0)){const s=this._state.get(e);if(s&&"started"===s.state&&s.time!==e){const n=e-this.toSeconds(s.time);let i;s.duration&&(i=this.toSeconds(s.duration)-n),this._start(t,this.toSeconds(s.offset)+n,i)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Ji,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class tr extends Co{constructor(){const t=Ri(tr.getDefaults(),arguments,["url","onload"]);super(t),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,So(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new wo({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Ki(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Co.getDefaults(),{url:new Ki,loop:!1,loopEnd:0,loopStart:0,onload:Ji,onerror:Ji,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,s,n=1){li(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(t);this._startGain(i,n),e=this.loop?qi(e,this.loopStart):qi(e,0);let o=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),s=t-e;Pi(o,t)&&(o=(o-e)%s+e),Li(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,ji(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),si(s)){let t=this.toSeconds(s);t=Math.max(t,0),this.stop(i+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class er extends Ko{constructor(){const t=Ri(er.getDefaults(),arguments,["type"]);super(t),this.name="Noise",this._source=null,this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ko.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(li(t in ir,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=ir[this._type];this._source=new tr({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const sr=220500,nr={brown:null,pink:null,white:null},ir={get brown(){if(!nr.brown){const t=[];for(let e=0;e<2;e++){const s=new Float32Array(sr);t[e]=s;let n=0;for(let t=0;t<sr;t++){const e=2*Math.random()-1;s[t]=(n+.02*e)/1.02,n=s[t],s[t]*=3.5}}nr.brown=(new Ki).fromArray(t)}return nr.brown},get pink(){if(!nr.pink){const t=[];for(let e=0;e<2;e++){const s=new Float32Array(sr);let n,i,o,r,a,c,h;t[e]=s,n=i=o=r=a=c=h=0;for(let t=0;t<sr;t++){const e=2*Math.random()-1;n=.99886*n+.0555179*e,i=.99332*i+.0750759*e,o=.969*o+.153852*e,r=.8665*r+.3104856*e,a=.55*a+.5329522*e,c=-.7616*c-.016898*e,s[t]=n+i+o+r+a+c+h+.5362*e,s[t]*=.11,h=.115926*e}}nr.pink=(new Ki).fromArray(t)}return nr.pink},get white(){if(!nr.white){const t=[];for(let e=0;e<2;e++){const s=new Float32Array(sr);t[e]=s;for(let t=0;t<sr;t++)s[t]=2*Math.random()-1}nr.white=(new Ki).fromArray(t)}return nr.white}};class or extends bo{constructor(){const t=Ri(or.getDefaults(),arguments,["volume"]);super(t),this.name="UserMedia",this._volume=this.output=new Fo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,$i(this,"volume"),this.mute=t.mute}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,volume:0})}open(t){return Si(this,void 0,void 0,(function*(){li(or.supported,"UserMedia is not supported"),"started"===this.state&&this.close();const e=yield or.enumerateDevices();ii(t)?this._device=e[t]:(this._device=e.find((e=>e.label===t||e.deviceId===t)),!this._device&&e.length>0&&(this._device=e[0]),li(si(this._device),`No matching device ${t}`));const s={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(s.audio.deviceId=this._device.deviceId);const n=yield navigator.mediaDevices.getUserMedia(s);if(!this._stream){this._stream=n;const t=this.context.createMediaStreamSource(n);So(t,this.output),this._mediaStream=t}return this}))}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach((t=>{t.stop()})),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return Si(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter((t=>"audioinput"===t.kind))}))}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return si(navigator.mediaDevices)&&si(navigator.mediaDevices.getUserMedia)}}function rr(t,e){return Si(this,void 0,void 0,(function*(){const s=e/t.context.sampleRate,n=new to(1,s,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/s,detune:0,context:n})).toDestination().start(0);return(yield n.render()).getChannelData(0)}))}class ar extends Co{constructor(){const t=Ri(ar.getDefaults(),arguments,["frequency","type"]);super(t),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],So(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new wo({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new wo({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),$i(this,["frequency","detune"])}static getDefaults(){return Object.assign(Co.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class cr extends Ko{constructor(){const t=Ri(cr.getDefaults(),arguments,["frequency","type"]);super(t),this.name="Oscillator",this._oscillator=null,this.frequency=new Mo({context:this.context,units:"frequency",value:t.frequency}),$i(this,"frequency"),this.detune=new Mo({context:this.context,units:"cents",value:t.detune}),$i(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Ko.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),s=new ar({context:this.context,onended:()=>this.onstop(this)});this._oscillator=s,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){const t=cr._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,s=this._partials,e.length===s.length&&e.every(((t,e)=>s[e]===t)));var e,s}));return t}{const t=cr._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(si(e)){const{partials:t,wave:s}=e;this._wave=s,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,s]=this._getRealImaginary(t,this._phase),n=this.context.createPeriodicWave(e,s);this._wave=n,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),cr._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),cr._periodicWaveCache.length>100&&cr._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){ui(t,0);let e=this._type;const s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(s&&(e=s[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,s)=>e[s]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let s=2048;const n=new Float32Array(s),i=new Float32Array(s);let o=1;if("custom"===t){if(o=this._partials.length+1,this._partialCount=this._partials.length,s=o,0===this._partials.length)return[n,i]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(o=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],o=Math.max(o,2),s=o):this._partialCount=0,this._partials=[]}for(let r=1;r<s;++r){const s=2/(r*Math.PI);let a;switch(t){case"sine":a=r<=o?1:0,this._partials[r-1]=a;break;case"square":a=1&r?2*s:0,this._partials[r-1]=a;break;case"sawtooth":a=s*(1&r?1:-1),this._partials[r-1]=a;break;case"triangle":a=1&r?s*s*2*(r-1>>1&1?-1:1):0,this._partials[r-1]=a;break;case"custom":a=this._partials[r-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(n[r]=-a*Math.sin(e*r),i[r]=a*Math.cos(e*r)):(n[r]=0,i[r]=0)}return[n,i]}_inverseFFT(t,e,s){let n=0;const i=t.length;for(let o=0;o<i;o++)n+=t[o]*Math.cos(o*s)+e[o]*Math.sin(o*s);return n}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let s=0;const n=2*Math.PI;for(let i=0;i<32;i++)s=Math.max(this._inverseFFT(t,e,i/32*n),s);return zi(-this._inverseFFT(t,e,this._phase)/s,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(){return Si(this,arguments,void 0,(function*(t=1024){return rr(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}cr._periodicWaveCache=[];class hr extends Zo{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Xo({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class lr extends Mo{constructor(){const t=Ri(lr.getDefaults(),arguments,["value"]);super(t),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new Ao({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Mo.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class ur extends Ko{constructor(){const t=Ri(ur.getDefaults(),arguments,["frequency","type","modulationType"]);super(t),this.name="AMOscillator",this._modulationScale=new hr({context:this.context}),this._modulationNode=new Ao({context:this.context}),this._carrier=new cr({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new cr({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new lr({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),$i(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(cr.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){return Si(this,arguments,void 0,(function*(t=1024){return rr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class pr extends Ko{constructor(){const t=Ri(pr.getDefaults(),arguments,["frequency","type","modulationType"]);super(t),this.name="FMOscillator",this._modulationNode=new Ao({context:this.context,gain:0}),this._carrier=new cr({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Mo({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new cr({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new lr({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new lr({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),$i(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(cr.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){return Si(this,arguments,void 0,(function*(t=1024){return rr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class dr extends Ko{constructor(){const t=Ri(dr.getDefaults(),arguments,["frequency","width"]);super(t),this.name="PulseOscillator",this._widthGate=new Ao({context:this.context,gain:0}),this._thresh=new Xo({context:this.context,mapping:t=>t<=0?-1:1}),this.width=new Mo({context:this.context,units:"audioRange",value:t.width}),this._triangle=new cr({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),$i(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Ko.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(){return Si(this,arguments,void 0,(function*(t=1024){return rr(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class fr extends Ko{constructor(){const t=Ri(fr.getDefaults(),arguments,["frequency","type","spread"]);super(t),this.name="FatOscillator",this._oscillators=[],this.frequency=new Mo({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Mo({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,$i(this,["frequency","detune"])}static getDefaults(){return Object.assign(cr.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,s=t/(this._oscillators.length-1);this._forEach(((t,n)=>t.detune.value=e+s*n))}}get count(){return this._oscillators.length}set count(t){if(ui(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const s=new cr({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):Ji});"custom"===this.type&&(s.partials=this._partials),this.frequency.connect(s.frequency),this.detune.connect(s.detune),s.detune.overridden=!1,s.connect(this.output),this._oscillators[e]=s}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(){return Si(this,arguments,void 0,(function*(t=1024){return rr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class mr extends Ko{constructor(){const t=Ri(mr.getDefaults(),arguments,["frequency","modulationFrequency"]);super(t),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new lr({context:this.context,value:2}),this._pulse=new dr({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new cr({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),$i(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Ko.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(){return Si(this,arguments,void 0,(function*(t=1024){return rr(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const _r={am:ur,fat:fr,fm:pr,oscillator:cr,pulse:dr,pwm:mr};class gr extends Ko{constructor(){const t=Ri(gr.getDefaults(),arguments,["frequency","type"]);super(t),this.name="OmniOscillator",this.frequency=new Mo({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Mo({context:this.context,units:"cents",value:t.detune}),$i(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(cr.getDefaults(),pr.getDefaults(),ur.getDefaults(),fr.getDefaults(),dr.getDefaults(),mr.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=_r[t],s=this.now();if(this._oscillator){const t=this._oscillator;t.stop(s),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(s)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof _r[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&ii(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&ii(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&ci(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(){return Si(this,arguments,void 0,(function*(t=1024){return rr(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class yr extends Mo{constructor(){super(Ri(yr.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new Ao({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,To(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Mo.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class vr extends Zo{constructor(){const t=Ri(vr.getDefaults(),arguments,["min","max"]);super(t),this.name="Scale",this._mult=this.input=new lr({context:this.context,value:t.max-t.min}),this._add=this.output=new yr({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Zo.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class xr extends Zo{constructor(){super(Ri(xr.getDefaults(),arguments)),this.name="Zero",this._gain=new Ao({context:this.context}),this.output=this._gain,this.input=void 0,So(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),ko(this.context.getConstant(0),this._gain),this}}class wr extends bo{constructor(){const t=Ri(wr.getDefaults(),arguments,["frequency","min","max"]);super(t),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=wo.prototype._fromType,this._toType=wo.prototype._toType,this._is=wo.prototype._is,this._clampValue=wo.prototype._clampValue,this._oscillator=new cr(t),this.frequency=this._oscillator.frequency,this._amplitudeGain=new Ao({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Mo({context:this.context,units:"audioRange",value:0}),this._zeros=new xr({context:this.context}),this._a2g=new hr({context:this.context}),this._scaler=this.output=new vr({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),$i(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(cr.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(t){this._oscillator.partials=t,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._setStoppedValue()}get units(){return this._units}set units(t){const e=this.min,s=this.max;this._units=t,this.min=e,this.max=s}get state(){return this._oscillator.state}connect(t,e,s){return(t instanceof wo||t instanceof Mo)&&(this.convert=t.convert,this.units=t.units),Do(this,t,e,s),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function br(t,e=1/0){const s=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return s.get(this)},set:function(n){ui(n,t,e),s.set(this,n)}})}}function Tr(t,e=1/0){const s=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return s.get(this)},set:function(n){ui(this.toSeconds(n),t,e),s.set(this,n)}})}}class Sr extends Ko{constructor(){const t=Ri(Sr.getDefaults(),arguments,["url","onload"]);super(t),this.name="Player",this._activeSources=new Set,this._buffer=new Ki({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ko.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Ji,onerror:Ji,playbackRate:1,reverse:!1})}load(t){return Si(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=Ji){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,s){return super.start(t,e,s),this}_start(t,e,s){e=this._loop?qi(e,this._loopStart):qi(e,0);const n=this.toSeconds(e),i=s;s=qi(s,Math.max(this._buffer.duration-n,0));let o=this.toSeconds(s);o/=this._playbackRate,t=this.toSeconds(t);const r=new tr({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(r),this._loop&&ei(i)?r.start(t,n):r.start(t,n,o-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,s){return super.restart(t,e,s),this}_restart(t,e,s){var n;null===(n=[...this._activeSources].pop())||void 0===n||n.stop(t),this._start(t,e,s)}seek(t,e){const s=this.toSeconds(e);if("started"===this._state.getValueAtTime(s)){const e=this.toSeconds(t);this._stop(s),this._start(s,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&ui(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&ui(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),s=this._state.getNextState("stopped",e);s&&s.implicitEnd&&(this._state.cancel(s.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((s=>{s.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}Ti([Tr(0)],Sr.prototype,"fadeIn",void 0),Ti([Tr(0)],Sr.prototype,"fadeOut",void 0);class kr extends bo{constructor(){const t=Ri(kr.getDefaults(),arguments,["urls","onload"],"urls");super(t),this.name="Players",this.input=void 0,this._players=new Map,this._volume=this.output=new Fo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,$i(this,"volume"),this._buffers=new jo({urls:t.urls,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.mute=t.mute,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ko.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:Ji,onerror:Ji,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._players.forEach((e=>{e.fadeIn=t}))}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._players.forEach((e=>{e.fadeOut=t}))}get state(){return Array.from(this._players).some((([t,e])=>"started"===e.state))?"started":"stopped"}has(t){return this._buffers.has(t)}player(t){if(li(this.has(t),`No Player with the name ${t} exists on this object`),!this._players.has(t)){const e=new Sr({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}get loaded(){return this._buffers.loaded}add(t,e,s){return li(!this._buffers.has(t),"A buffer with that name already exists on this object"),this._buffers.add(t,e,s),this}stopAll(t){return this._players.forEach((e=>e.stop(t))),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach((t=>t.dispose())),this._buffers.dispose(),this}}class Ar extends Ko{constructor(){const t=Ri(Ar.getDefaults(),arguments,["url","onload"]);super(t),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[],this.buffer=new Ki({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new Io({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(Ko.getDefaults(),{onload:Ji,onerror:Ji,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,s){e=qi(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const n=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/n),s&&this.stop(t+this.toSeconds(s))}restart(t,e,s){return super.restart(t,e,s),this}_restart(t,e,s){this._stop(t),this._start(t,e,s)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach((e=>{e.fadeOut=0,e.stop(t)})),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),s=e*this._grainSize;if(this.log("offset",s),!this.loop&&s>this.buffer.duration)return void this.stop(t);const n=s<this._overlap?0:this._overlap,i=new tr({context:this.context,url:this.buffer,fadeIn:n,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:ao(this.detune/100)}).connect(this.output);i.start(t,this._grainSize*e),i.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(i),i.onended=()=>{const t=this._activeSources.indexOf(i);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){ui(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&ui(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&ui(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);ui(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((t=>t.dispose())),this}}class Cr extends Zo{constructor(){super(...arguments),this.name="Abs",this._abs=new Xo({context:this.context,mapping:t=>Math.abs(t)<.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class Or extends Zo{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new Xo({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Mr extends Zo{constructor(){super(...arguments),this.name="Negate",this._multiply=new lr({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class Dr extends Mo{constructor(){super(Ri(Dr.getDefaults(),arguments,["value"])),this.override=!1,this.name="Subtract",this._sum=new Ao({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new Mr({context:this.context}),this.subtrahend=this._param,To(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(Mo.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class Er extends Zo{constructor(){super(Ri(Er.getDefaults(),arguments)),this.name="GreaterThanZero",this._thresh=this.output=new Xo({context:this.context,length:127,mapping:t=>t<=0?0:1}),this._scale=this.input=new lr({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class Rr extends Mo{constructor(){const t=Ri(Rr.getDefaults(),arguments,["value"]);super(t),this.name="GreaterThan",this.override=!1,this._subtract=this.input=new Dr({context:this.context,value:t.value}),this._gtz=this.output=new Er({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,$i(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(Mo.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class qr extends vr{constructor(){const t=Ri(qr.getDefaults(),arguments,["min","max","exponent"]);super(t),this.name="ScaleExp",this.input=this._exp=new Yo({context:this.context,value:t.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(vr.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(t){this._exp.value=t}dispose(){return super.dispose(),this._exp.dispose(),this}}class Ir extends bo{constructor(){const t=Ri(Ir.getDefaults(),arguments,["attack","decay","sustain","release"]);super(t),this.name="Envelope",this._sig=new Mo({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(bo.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(ci(t))return t;{let s;for(s in Vr)if(Vr[s][e]===t)return s;return t}}_setCurve(t,e,s){if(ci(s)&&Reflect.has(Vr,s)){const n=Vr[s];oi(n)?"_decayCurve"!==t&&(this[t]=n[e]):this[t]=n}else{if(!ai(s)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+s);this[t]=s}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(t){this._setCurve("_decayCurve","Out",t)}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let s=this.toSeconds(this.attack);const n=this.toSeconds(this.decay),i=this.getValueAtTime(t);if(i>0){s=(1-i)/(1/s)}if(s<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,s,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,s,t);else{this._sig.cancelAndHoldAtTime(t);let n=this._attackCurve;for(let t=1;t<n.length;t++)if(n[t-1]<=i&&i<=n[t]){n=this._attackCurve.slice(t),n[0]=i;break}this._sig.setValueCurveAtTime(n,t,s,e)}if(n&&this.sustain<1){const i=e*this.sustain,o=t+s;this.log("decay",o),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(i,n+o):this._sig.exponentialApproachValueAtTime(i,o,n)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const s=this.toSeconds(this.release);s<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,s,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,s,t):(li(ai(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,s,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,s=1){return e=this.toSeconds(e),this.triggerAttack(e,s),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,s=0){return Do(this,t,e,s),this}asArray(){return Si(this,arguments,void 0,(function*(t=1024){const e=t/this.context.sampleRate,s=new to(1,e,this.context.sampleRate),n=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=n+this.toSeconds(this.release),o=.1*i,r=i+o,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/r,decay:e*this.toSeconds(this.decay)/r,release:e*this.toSeconds(this.release)/r,context:s}));a._sig.toDestination(),a.triggerAttackRelease(e*(n+o)/r,0);return(yield s.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}Ti([Tr(0)],Ir.prototype,"attack",void 0),Ti([Tr(0)],Ir.prototype,"decay",void 0),Ti([br(0,1)],Ir.prototype,"sustain",void 0),Ti([Tr(0)],Ir.prototype,"release",void 0);const Vr=(()=>{const t=128;let e,s;const n=[];for(e=0;e<t;e++)n[e]=Math.sin(e/127*(Math.PI/2));const i=[];for(e=0;e<127;e++){s=e/127;const t=Math.sin(s*(2*Math.PI)*6.4-Math.PI/2)+1;i[e]=t/10+.83*s}i[127]=1;const o=[];for(e=0;e<t;e++)o[e]=Math.ceil(e/127*5)/5;const r=[];for(e=0;e<t;e++)s=e/127,r[e]=.5*(1-Math.cos(Math.PI*s));const a=[];for(e=0;e<t;e++){s=e/127;const t=4*Math.pow(s,3)+.2,n=Math.cos(t*Math.PI*2*s);a[e]=Math.abs(n*(1-s))}function c(t){const e=new Array(t.length);for(let s=0;s<t.length;s++)e[s]=1-t[s];return e}return{bounce:{In:c(a),Out:a},cosine:{In:n,Out:(h=n,h.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:i,Out:c(i)},sine:{In:r,Out:c(r)},step:{In:o,Out:c(o)}};var h})();class Fr extends bo{constructor(){const t=Ri(Fr.getDefaults(),arguments);super(t),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t),this._volume=this.output=new Fo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,$i(this,"volume")}static getDefaults(){return Object.assign(bo.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const s=this["_original_"+t]=this[t];this[t]=(...t)=>{const n=t[e],i=this.context.transport.schedule((n=>{t[e]=n,s.apply(this,t)}),n);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(t,e,s,n){const i=this.toSeconds(s),o=this.toSeconds(e);return this.triggerAttack(t,i,n),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Nr extends Fr{constructor(){const t=Ri(Nr.getDefaults(),arguments);super(t),this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Fr.getDefaults(),{detune:0,onsilence:Ji,portamento:0})}triggerAttack(t,e,s=1){this.log("triggerAttack",t,e,s);const n=this.toSeconds(e);return this._triggerEnvelopeAttack(n,s),this.setNote(t,n),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const s=this.toSeconds(e),n=t instanceof mo?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(s)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(n,t,s)}else this.frequency.setValueAtTime(n,s);return this}}Ti([Tr(0)],Nr.prototype,"portamento",void 0);class Pr extends Ir{constructor(){super(Ri(Pr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Ao({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class jr extends Nr{constructor(){const t=Ri(jr.getDefaults(),arguments);super(t),this.name="Synth",this.oscillator=new gr(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Pr(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),$i(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Nr.getDefaults(),{envelope:Object.assign(Ii(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ii(gr.getDefaults(),[...Object.keys(Ko.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+s)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Lr extends Nr{constructor(){const t=Ri(Lr.getDefaults(),arguments);super(t),this.name="ModulationSynth",this._carrier=new jr({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new jr({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new Mo({context:this.context,units:"frequency"}),this.detune=new Mo({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new lr({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new Ao({context:this.context,gain:0}),$i(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Nr.getDefaults(),{harmonicity:3,oscillator:Object.assign(Ii(gr.getDefaults(),[...Object.keys(Ko.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Ii(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Ii(gr.getDefaults(),[...Object.keys(Ko.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Ii(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class zr extends Lr{constructor(){super(Ri(zr.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new hr({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class Br extends bo{constructor(){const t=Ri(Br.getDefaults(),arguments,["frequency","type"]);super(t),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new wo({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new wo({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new wo({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new wo({context:this.context,units:"decibels",convert:!1,value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(bo.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){li(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let s=0;s<t;s++){const n=19980*Math.pow(s/t,2)+20;e[s]=n}const s=new Float32Array(t),n=new Float32Array(t),i=this.context.createBiquadFilter();return i.type=this.type,i.Q.value=this.Q.value,i.frequency.value=this.frequency.value,i.gain.value=this.gain.value,i.getFrequencyResponse(e,s,n),s}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Wr extends bo{constructor(){const t=Ri(Wr.getDefaults(),arguments,["frequency","type","rolloff"]);super(t),this.name="Filter",this.input=new Ao({context:this.context}),this.output=new Ao({context:this.context}),this._filters=[],this._filters=[],this.Q=new Mo({context:this.context,units:"positive",value:t.Q}),this.frequency=new Mo({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Mo({context:this.context,units:"cents",value:t.detune}),this.gain=new Mo({context:this.context,units:"decibels",convert:!1,value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,$i(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(bo.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){li(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._type=t,this._filters.forEach((e=>e.type=t))}get rolloff(){return this._rolloff}set rolloff(t){const e=ii(t)?t:parseInt(t,10),s=[-12,-24,-48,-96];let n=s.indexOf(e);li(-1!==n,`rolloff can only be ${s.join(", ")}`),n+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach((t=>t.disconnect())),this._filters=new Array(n);for(let t=0;t<n;t++){const e=new Br({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e}this._internalChannels=this._filters,To(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new Br({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),s=new Float32Array(t).map((()=>1));return this._filters.forEach((()=>{e.getFrequencyResponse(t).forEach(((t,e)=>s[e]*=t))})),e.dispose(),s}dispose(){return super.dispose(),this._filters.forEach((t=>{t.dispose()})),Hi(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class Gr extends Ir{constructor(){const t=Ri(Gr.getDefaults(),arguments,["attack","decay","sustain","release"]);super(t),this.name="FrequencyEnvelope",this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new Yo({context:this.context,value:t.exponent}),this._scale=this.output=new vr({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(Ir.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);ui(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class Ur extends Nr{constructor(){const t=Ri(Ur.getDefaults(),arguments);super(t),this.name="MonoSynth",this.oscillator=new gr(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Wr(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new Gr(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new Pr(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),$i(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(Nr.getDefaults(),{envelope:Object.assign(Ii(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(Ii(Wr.getDefaults(),Object.keys(bo.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(Ii(Gr.getDefaults(),Object.keys(bo.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(Ii(gr.getDefaults(),Object.keys(Ko.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+s)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class Qr extends Nr{constructor(){const t=Ri(Qr.getDefaults(),arguments);super(t),this.name="DuoSynth",this.voice0=new Ur(Object.assign(t.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new Ur(Object.assign(t.voice1,{context:this.context})),this.harmonicity=new lr({context:this.context,units:"positive",value:t.harmonicity}),this._vibrato=new wr({frequency:t.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new Ao({context:this.context,units:"normalRange",gain:t.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new Mo({context:this.context,units:"frequency",value:440}),this.detune=new Mo({context:this.context,units:"cents",value:t.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),$i(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}static getDefaults(){return Ei(Nr.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:Ei(Ii(Ur.getDefaults(),Object.keys(Nr.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:Ei(Ii(Ur.getDefaults(),Object.keys(Nr.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class Zr extends Lr{constructor(){const t=Ri(Zr.getDefaults(),arguments);super(t),this.name="FMSynth",this.modulationIndex=new lr({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(Lr.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const Xr=[1,1.483,1.932,2.546,2.63,3.897];class Yr extends Nr{constructor(){const t=Ri(Yr.getDefaults(),arguments);super(t),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[],this.detune=new Mo({context:this.context,units:"cents",value:t.detune}),this.frequency=new Mo({context:this.context,units:"frequency"}),this._amplitude=new Ao({context:this.context,gain:0}).connect(this.output),this._highpass=new Wr({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let e=0;e<Xr.length;e++){const s=new pr({context:this.context,harmonicity:t.harmonicity,modulationIndex:t.modulationIndex,modulationType:"square",onstop:0===e?()=>this.onsilence(this):Ji,type:"square"});s.connect(this._highpass),this._oscillators[e]=s;const n=new lr({context:this.context,value:Xr[e]});this._freqMultipliers[e]=n,this.frequency.chain(n,s.frequency),this.detune.connect(s.detune)}this._filterFreqScaler=new vr({context:this.context,max:7e3,min:this.toFrequency(t.resonance)}),this.envelope=new Ir({attack:t.envelope.attack,attackCurve:"linear",context:this.context,decay:t.envelope.decay,release:t.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=t.octaves,this.octaves=t.octaves}static getDefaults(){return Ei(Nr.getDefaults(),{envelope:Object.assign(Ii(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(t,e=1){return this.envelope.triggerAttack(t,e),this._oscillators.forEach((e=>e.start(t))),0===this.envelope.sustain&&this._oscillators.forEach((e=>{e.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))})),this}_triggerEnvelopeRelease(t){return this.envelope.triggerRelease(t),this._oscillators.forEach((e=>e.stop(t+this.toSeconds(this.envelope.release)))),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(t){this._oscillators.forEach((e=>e.modulationIndex.value=t))}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(t){this._oscillators.forEach((e=>e.harmonicity.value=t))}get resonance(){return this._filterFreqScaler.min}set resonance(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}dispose(){return super.dispose(),this._oscillators.forEach((t=>t.dispose())),this._freqMultipliers.forEach((t=>t.dispose())),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class $r extends jr{constructor(){const t=Ri($r.getDefaults(),arguments);super(t),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,$i(this,["oscillator","envelope"])}static getDefaults(){return Ei(Nr.getDefaults(),jr.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const s=this.toSeconds(e),n=this.toFrequency(t instanceof mo?t.toFrequency():t),i=n*this.octaves;return this.oscillator.frequency.setValueAtTime(i,s),this.oscillator.frequency.exponentialRampToValueAtTime(n,s+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Ti([br(0)],$r.prototype,"octaves",void 0),Ti([Tr(0)],$r.prototype,"pitchDecay",void 0);class Hr extends Fr{constructor(){const t=Ri(Hr.getDefaults(),arguments);super(t),this.name="NoiseSynth",this.noise=new er(Object.assign({context:this.context},t.noise)),this.envelope=new Pr(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(Fr.getDefaults(),{envelope:Object.assign(Ii(Ir.getDefaults(),Object.keys(bo.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(Ii(er.getDefaults(),Object.keys(Ko.getDefaults())),{type:"white"})})}triggerAttack(t,e=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,e,s=1){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,s),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const Jr=new Set;function Kr(t){Jr.add(t)}function ta(t,e){const s=`registerProcessor("${t}", ${e})`;Jr.add(s)}class ea extends bo{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=Ji;const e=URL.createObjectURL(new Blob([Array.from(Jr).join("\n")],{type:"text/javascript"})),s=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e).then((()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(s,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))}))}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}Kr('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Kr("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Kr("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");const sa="feedback-comb-filter";ta(sa,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class na extends ea{constructor(){const t=Ri(na.getDefaults(),arguments,["delayTime","resonance"]);super(t),this.name="FeedbackCombFilter",this.input=new Ao({context:this.context}),this.output=new Ao({context:this.context}),this.delayTime=new wo({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new wo({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),$i(this,["resonance","delayTime"])}_audioWorkletName(){return sa}static getDefaults(){return Object.assign(bo.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){To(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const s=t.parameters.get("feedback");this.resonance.setParam(s)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class ia extends bo{constructor(){const t=Ri(ia.getDefaults(),arguments,["frequency","type"]);super(t),this.name="OnePoleFilter",this._frequency=t.frequency,this._type=t.type,this.input=new Ao({context:this.context}),this.output=new Ao({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(bo.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),s=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(s*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(s*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout((()=>{this.disposed||(this.input.disconnect(t),t.disconnect())}),this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let s=0;s<t;s++){const n=19980*Math.pow(s/t,2)+20;e[s]=n}const s=new Float32Array(t),n=new Float32Array(t);return this._filter.getFrequencyResponse(e,s,n),s}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class oa extends bo{constructor(){const t=Ri(oa.getDefaults(),arguments,["delayTime","resonance","dampening"]);super(t),this.name="LowpassCombFilter",this._combFilter=this.output=new na({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new ia({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(bo.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class ra extends Fr{constructor(){const t=Ri(ra.getDefaults(),arguments);super(t),this.name="PluckSynth",this._noise=new er({context:this.context,type:"pink"}),this.attackNoise=t.attackNoise,this._lfcf=new oa({context:this.context,dampening:t.dampening,resonance:t.resonance}),this.resonance=t.resonance,this.release=t.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return Ei(Fr.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(t){this._lfcf.dampening=t}triggerAttack(t,e){const s=this.toFrequency(t);e=this.toSeconds(e);const n=1/s;return this._lfcf.delayTime.setValueAtTime(n,e),this._noise.start(e),this._noise.stop(e+n*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}triggerRelease(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class aa extends Fr{constructor(){const t=Ri(aa.getDefaults(),arguments,["voice","options"]);super(t),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=t=>this.releaseAll(t),li(!ii(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const s=this._voices.indexOf(this._dummyVoice);this._voices.splice(s,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Fr.getDefaults(),{maxPolyphony:32,options:{},voice:jr})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex((e=>e.voice===t));this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return li(t instanceof Nr,"Voice must extend Monophonic class"),t.connect(this.output),this._voices.push(t),t}vi("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,s){t.forEach((t=>{const n=new Lo(this.context,t).toMidi(),i=this._getNextAvailableVoice();i&&(i.triggerAttack(t,e,s),this._activeVoices.push({midi:n,voice:i,released:!1}),this.log("triggerAttack",t,e))}))}_triggerRelease(t,e){t.forEach((t=>{const s=new Lo(this.context,t).toMidi(),n=this._activeVoices.find((({midi:t,released:e})=>t===s&&!e));n&&(n.voice.triggerRelease(e),n.released=!0,this.log("triggerRelease",t,e))}))}_scheduleEvent(t,e,s,n){li(!this.disposed,"Synth was already disposed"),s<=this.now()?"attack"===t?this._triggerAttack(e,s,n):this._triggerRelease(e,s):this.context.setTimeout((()=>{this.disposed||this._scheduleEvent(t,e,s,n)}),s-this.now())}triggerAttack(t,e,s){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("attack",t,n,s),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const s=this.toSeconds(e);return this._scheduleEvent("release",t,s),this}triggerAttackRelease(t,e,s,n){const i=this.toSeconds(s);if(this.triggerAttack(t,i,n),ai(e)){li(ai(t),"If the duration is an array, the notes must also be an array");for(let s=0;s<t.length;s++){const n=e[Math.min(s,e.length-1)],o=this.toSeconds(n);li(o>0,"The duration must be greater than 0"),this.triggerRelease(t[s],i+o)}}else{const s=this.toSeconds(e);li(s>0,"The duration must be greater than 0"),this.triggerRelease(t,i+s)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(t){const e=Ii(t,["onsilence","context"]);return this.options=Ei(this.options,e),this._voices.forEach((t=>t.set(e))),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach((({voice:t})=>{t.triggerRelease(e)})),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach((t=>t.dispose())),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class ca extends Fr{constructor(){const t=Ri(ca.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(t),this.name="Sampler",this._activeSources=new Map;const e={};Object.keys(t.urls).forEach((s=>{const n=parseInt(s,10);if(li(hi(s)||ii(n)&&isFinite(n),`url key is neither a note or midi pitch: ${s}`),hi(s)){const n=new mo(this.context,s).toMidi();e[n]=t.urls[s]}else ii(n)&&isFinite(n)&&(e[n]=t.urls[n])})),this._buffers=new jo({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Fr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Ji,onerror:Ji,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,s=1){return this.log("triggerAttack",t,e,s),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=lo(new mo(this.context,t).toFrequency()),i=Math.round(n),o=n-i,r=this._findClosest(i),a=i-r,c=this._buffers.get(a),h=ao(r+o),l=new tr({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);l.start(e,0,c.duration/h,s),ai(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(l),l.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){const t=this._activeSources.get(i),e=t.indexOf(l);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const s=new mo(this.context,t).toMidi();if(this._activeSources.has(s)&&this._activeSources.get(s).length){const t=this._activeSources.get(s);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(s,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,s,n=1){const i=this.toSeconds(s);return this.triggerAttack(t,i,n),ai(e)?(li(ai(t),"notes must be an array when duration is array"),t.forEach(((t,s)=>{const n=e[Math.min(s,e.length-1)];this.triggerRelease(t,i+this.toSeconds(n))}))):this.triggerRelease(t,i+this.toSeconds(e)),this}add(t,e,s){if(li(hi(t)||isFinite(t),`note must be a pitch or midi: ${t}`),hi(t)){const n=new mo(this.context,t).toMidi();this._buffers.add(n,e,s)}else this._buffers.add(t,e,s);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}Ti([Tr(0)],ca.prototype,"attack",void 0),Ti([Tr(0)],ca.prototype,"release",void 0);class ha extends vo{constructor(){const t=Ri(ha.getDefaults(),arguments,["callback","value"]);super(t),this.name="ToneEvent",this._state=new xo("stopped"),this._startOffset=0,this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(vo.getDefaults(),{callback:Ji,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,(t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const s=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||ii(this._loop)&&this._loop>1){e=1/0,ii(this._loop)&&(e=this._loop*this._getLoopDuration());const n=this._state.getAfter(s);null!==n&&(e=Math.min(e,n.time-s)),e!==1/0&&(e=new zo(this.context,e));const i=new zo(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),i,new zo(this.context,s),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new zo(this.context,s))}}))}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let s=e;null!==t&&(s=t.time),this._rescheduleEvents(s)}return this}cancel(t){t=qi(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,(t=>{this.context.transport.clear(t.id)})),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;ri(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new zo(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new zo(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const s=this._getLoopDuration();return(t-e.time)%s/s}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class la extends vo{constructor(){const t=Ri(la.getDefaults(),arguments,["callback","interval"]);super(t),this.name="Loop",this._event=new ha({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability,humanize:t.humanize}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(vo.getDefaults(),{interval:"4n",callback:Ji,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class ua extends ha{constructor(){const t=Ri(ua.getDefaults(),arguments,["callback","events"]);super(t),this.name="Part",this._state=new xo("stopped"),this._events=new Set,this._state.increasing=!0,t.events.forEach((t=>{ai(t)?this.add(t[0],t[1]):this.add(t)}))}static getDefaults(){return Object.assign(ha.getDefaults(),{events:[]})}start(t,e){const s=this.toTicks(t);if("started"!==this._state.getValueAtTime(s)){e=qi(e,this._loop?this._loopStart:0),e=this._loop?qi(e,this._loopStart):qi(e,0);const t=this.toTicks(e);this._state.add({id:-1,offset:t,state:"started",time:s}),this._forEach((e=>{this._startNote(e,s,t)}))}return this}_startNote(t,e,s){e-=s,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<s&&(e+=this._getLoopDuration()),t.start(new zo(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=s&&(t.loop=!1,t.start(new zo(this.context,e))):t.startOffset>=s&&t.start(new zo(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach((t=>{t.startOffset+=this._startOffset}))}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach((e=>{e.stop(t)})),this}at(t,e){const s=new yo(this.context,t).toTicks(),n=new zo(this.context,1).toSeconds(),i=this._events.values();let o=i.next();for(;!o.done;){const t=o.value;if(Math.abs(s-t.startOffset)<n)return si(e)&&(t.value=e),t;o=i.next()}return si(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);const s=this.toTicks(t);let n;return e instanceof ha?(n=e,n.callback=this._tick.bind(this)):n=new ha({callback:this._tick.bind(this),context:this.context,value:e}),n.startOffset=s,n.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(n),this._restartEvent(n),this}_restartEvent(t){this._state.forEach((e=>{"started"===e.state?this._startNote(t,e.time,e.offset):t.stop(new zo(this.context,e.time))}))}remove(t,e){return oi(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach((s=>{s.startOffset===t&&(ei(e)||si(e)&&s.value===e)&&(this._events.delete(s),s.dispose())})),this}clear(){return this._forEach((t=>t.dispose())),this._events.clear(),this}cancel(t){return this._forEach((e=>e.cancel(t))),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach((e=>{e instanceof ua?e._forEach(t):t(e)})),this}_setAll(t,e){this._forEach((s=>{s[t]=e}))}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach((e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)}))}get loopEnd(){return new zo(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach((e=>{e.loopEnd=t,this._testLoopBoundries(e)}))}get loopStart(){return new zo(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach((t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)}))}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*pa(t){let e=0;for(;e<t;)e=zi(e,0,t-1),yield e,e++}function*da(t){let e=t-1;for(;e>=0;)e=zi(e,0,t-1),yield e,e--}function*fa(t,e){for(;;)yield*e(t)}function*ma(t,e){let s=e?0:t-1;for(;;)s=zi(s,0,t-1),yield s,e?(s++,s>=t-1&&(e=!1)):(s--,s<=0&&(e=!0))}function*_a(t){let e=0,s=0;for(;e<t;)e=zi(e,0,t-1),yield e,s++,e+=s%2?2:-1}function*ga(t){let e=t-1,s=0;for(;e>=0;)e=zi(e,0,t-1),yield e,s++,e+=s%2?-2:1}function*ya(t){const e=[];for(let s=0;s<t;s++)e.push(s);for(;e.length>0;){const s=zi(e.splice(Math.floor(e.length*Math.random()),1)[0],0,t-1);yield s}}function*va(t,e="up",s=0){switch(li(t>=1,"The number of values must be at least one"),e){case"up":yield*fa(t,pa);case"down":yield*fa(t,da);case"upDown":yield*ma(t,!0);case"downUp":yield*ma(t,!1);case"alternateUp":yield*fa(t,_a);case"alternateDown":yield*fa(t,ga);case"random":yield*function*(t){for(;;){const e=Math.floor(Math.random()*t);yield e}}(t);case"randomOnce":yield*fa(t,ya);case"randomWalk":yield*function*(t){let e=Math.floor(Math.random()*t);for(;;)0===e?e++:e===t-1||Math.random()<.5?e--:e++,yield e}(t)}}class xa extends la{constructor(){const t=Ri(xa.getDefaults(),arguments,["callback","values","pattern"]);super(t),this.name="Pattern",this.callback=t.callback,this._values=t.values,this._pattern=va(t.values.length,t.pattern),this._type=t.pattern}static getDefaults(){return Object.assign(la.getDefaults(),{pattern:"up",values:[],callback:Ji})}_tick(t){const e=this._pattern.next();this._index=e.value,this._value=this._values[e.value],this.callback(t,this._value)}get values(){return this._values}set values(t){this._values=t,this.pattern=this._type}get value(){return this._value}get index(){return this._index}get pattern(){return this._type}set pattern(t){this._type=t,this._pattern=va(this._values.length,this._type)}}class wa extends ha{constructor(){const t=Ri(wa.getDefaults(),arguments,["callback","events","subdivision"]);super(t),this.name="Sequence",this._part=new ua({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[],this._subdivision=this.toTicks(t.subdivision),this.events=t.events,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.playbackRate=t.playbackRate,this.probability=t.probability,this.humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate}static getDefaults(){return Object.assign(Ii(ha.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(t,e){null===e||this.mute||this.callback(t,e)}get events(){return this._events}set events(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(t,e){return this._part.start(t,e?this._indexTime(e):e),this}stop(t){return this._part.stop(t),this}get subdivision(){return new zo(this.context,this._subdivision).toSeconds()}_createSequence(t){return new Proxy(t,{get:(t,e)=>t[e],set:(t,e,s)=>(ci(e)&&isFinite(parseInt(e,10))&&ai(s)?t[e]=this._createSequence(s):t[e]=s,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(t,e,s){t.forEach(((t,n)=>{const i=n*e+s;if(ai(t))this._rescheduleSequence(t,e/t.length,i);else{const e=new zo(this.context,i,"i").toSeconds();this._part.add(e,t)}}))}_indexTime(t){return new zo(this.context,t*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(t){this._part.loop=t}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t)}get startOffset(){return this._part.startOffset}set startOffset(t){this._part.startOffset=t}get playbackRate(){return this._part.playbackRate}set playbackRate(t){this._part.playbackRate=t}get probability(){return this._part.probability}set probability(t){this._part.probability=t}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(t){this._part.humanize=t}get length(){return this._part.length}}class ba extends bo{constructor(){const t=Ri(ba.getDefaults(),arguments,["fade"]);super(t),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new Or({context:this.context}),this.a=new Ao({context:this.context,gain:0}),this.b=new Ao({context:this.context,gain:0}),this.output=new Ao({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new Mo({context:this.context,units:"normalRange",value:t.fade}),$i(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",So(this._split,this.a.gain,0),So(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(bo.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class Ta extends bo{constructor(t){super(t),this.name="Effect",this._dryWet=new ba({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Ao({context:this.context}),this.effectReturn=new Ao({context:this.context}),this.input=new Ao({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],$i(this,"wet")}static getDefaults(){return Object.assign(bo.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class Sa extends Ta{constructor(t){super(t),this.name="LFOEffect",this._lfo=new wr({context:this.context,frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=t.type,$i(this,["frequency","depth"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{frequency:1,type:"sine",depth:1})}start(t){return this._lfo.start(t),this}stop(t){return this._lfo.stop(t),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class ka extends Sa{constructor(){const t=Ri(ka.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);super(t),this.name="AutoFilter",this.filter=new Wr(Object.assign(t.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency}static getDefaults(){return Object.assign(Sa.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}dispose(){return super.dispose(),this.filter.dispose(),this}}class Aa extends bo{constructor(){const t=Ri(Aa.getDefaults(),arguments,["pan"]);super(t),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new wo({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",$i(this,"pan")}static getDefaults(){return Object.assign(bo.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class Ca extends Sa{constructor(){const t=Ri(Ca.getDefaults(),arguments,["frequency"]);super(t),this.name="AutoPanner",this._panner=new Aa({context:this.context,channelCount:t.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(Sa.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class Oa extends bo{constructor(){const t=Ri(Oa.getDefaults(),arguments,["smoothing"]);super(t),this.name="Follower",this._abs=this.input=new Cr({context:this.context}),this._lowpass=this.output=new ia({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(bo.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class Ma extends Ta{constructor(){const t=Ri(Ma.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);super(t),this.name="AutoWah",this._follower=new Oa({context:this.context,smoothing:t.follower}),this._sweepRange=new qr({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this._inputBoost=new Ao({context:this.context}),this._bandpass=new Wr({context:this.context,rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new Wr({context:this.context,type:"peaking"}),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,$i(this,["gain","Q"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(t){this._follower.smoothing=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}get sensitivity(){return ro(1/this._inputBoost.gain.value)}set sensitivity(t){this._inputBoost.gain.value=1/oo(t)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}const Da="bit-crusher";ta(Da,"\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class Ea extends Ta{constructor(){const t=Ri(Ea.getDefaults(),arguments,["bits"]);super(t),this.name="BitCrusher",this._bitCrusherWorklet=new Ra({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(Ta.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class Ra extends ea{constructor(){const t=Ri(Ra.getDefaults(),arguments);super(t),this.name="BitCrusherWorklet",this.input=new Ao({context:this.context}),this.output=new Ao({context:this.context}),this.bits=new wo({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(ea.getDefaults(),{bits:12})}_audioWorkletName(){return Da}onReady(t){To(this.input,t,this.output);const e=t.parameters.get("bits");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class qa extends Ta{constructor(){const t=Ri(qa.getDefaults(),arguments,["order"]);super(t),this.name="Chebyshev",this._shaper=new Xo({context:this.context,length:4096}),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample}static getDefaults(){return Object.assign(Ta.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(t,e,s){return s.has(e)||(0===e?s.set(e,0):1===e?s.set(e,t):s.set(e,2*t*this._getCoefficient(t,e-1,s)-this._getCoefficient(t,e-2,s))),s.get(e)}get order(){return this._order}set order(t){li(Number.isInteger(t),"'order' must be an integer"),this._order=t,this._shaper.setMap((e=>this._getCoefficient(e,t,new Map)))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Ia extends bo{constructor(){const t=Ri(Ia.getDefaults(),arguments,["channels"]);super(t),this.name="Split",this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(bo.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class Va extends bo{constructor(){const t=Ri(Va.getDefaults(),arguments,["channels"]);super(t),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(bo.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Fa extends bo{constructor(t){super(t),this.name="StereoEffect",this.input=new Ao({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new ba({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new Ia({context:this.context,channels:2}),this._merge=new Va({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),$i(this,["wet"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),To(...t),So(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),To(...t),So(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(bo.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Na extends Fa{constructor(t){super(t),this.feedback=new Mo({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new Ao({context:this.context}),this._feedbackR=new Ao({context:this.context}),this._feedbackSplit=new Ia({context:this.context,channels:2}),this._feedbackMerge=new Va({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),$i(this,["feedback"])}static getDefaults(){return Object.assign(Fa.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class Pa extends Na{constructor(){const t=Ri(Pa.getDefaults(),arguments,["frequency","delayTime","depth"]);super(t),this.name="Chorus",this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new wr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new wr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Vo({context:this.context}),this._delayNodeR=new Vo({context:this.context}),this.frequency=this._lfoL.frequency,$i(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(Na.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class ja extends Ta{constructor(){const t=Ri(ja.getDefaults(),arguments,["distortion"]);super(t),this.name="Distortion",this._shaper=new Xo({context:this.context,length:4096}),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample}static getDefaults(){return Object.assign(Ta.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(t){this._distortion=t;const e=100*t,s=Math.PI/180;this._shaper.setMap((t=>Math.abs(t)<.001?0:(3+e)*t*20*s/(Math.PI+e*Math.abs(t))))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class La extends Ta{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new Ao({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,$i(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Ta.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class za extends La{constructor(){const t=Ri(za.getDefaults(),arguments,["delayTime","feedback"]);super(t),this.name="FeedbackDelay",this._delayNode=new Vo({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),$i(this,"delayTime")}static getDefaults(){return Object.assign(La.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class Ba extends bo{constructor(t){super(t),this.name="PhaseShiftAllpass",this.input=new Ao({context:this.context}),this.output=new Ao({context:this.context}),this.offset90=new Ao({context:this.context});this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),To(this.input,...this._bank0,this._oneSampleDelay,this.output),To(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(t){return t.map((t=>{const e=[[t*t,0,-1],[1,0,-t*t]];return this.context.createIIRFilter(e[0],e[1])}))}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach((t=>t.disconnect())),this._bank1.forEach((t=>t.disconnect())),this._oneSampleDelay.disconnect(),this}}class Wa extends Ta{constructor(){const t=Ri(Wa.getDefaults(),arguments,["frequency"]);super(t),this.name="FrequencyShifter",this.frequency=new Mo({context:this.context,units:"frequency",value:t.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new ar({context:this.context,type:"sine"}),this._cosine=new cr({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new lr({context:this.context}),this._cosineMultiply=new lr({context:this.context}),this._negate=new Mr({context:this.context}),this._add=new yr({context:this.context}),this._phaseShifter=new Ba({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);const e=this.immediate();this._sine.start(e),this._cosine.start(e)}static getDefaults(){return Object.assign(Ta.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}const Ga=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],Ua=[225,556,441,341];class Qa extends Fa{constructor(){const t=Ri(Qa.getDefaults(),arguments,["roomSize","dampening"]);super(t),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[],this.roomSize=new Mo({context:this.context,value:t.roomSize,units:"normalRange"}),this._allpassFiltersL=Ua.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._allpassFiltersR=Ua.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._combFilters=Ga.map(((e,s)=>{const n=new oa({context:this.context,dampening:t.dampening,delayTime:e});return s<Ga.length/2?this.connectEffectLeft(n,...this._allpassFiltersL):this.connectEffectRight(n,...this._allpassFiltersR),this.roomSize.connect(n.resonance),n})),$i(this,["roomSize"])}static getDefaults(){return Object.assign(Fa.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(t){this._combFilters.forEach((e=>e.dampening=t))}dispose(){return super.dispose(),this._allpassFiltersL.forEach((t=>t.disconnect())),this._allpassFiltersR.forEach((t=>t.disconnect())),this._combFilters.forEach((t=>t.dispose())),this.roomSize.dispose(),this}}const Za=[.06748,.06404,.08212,.09004],Xa=[.773,.802,.753,.733],Ya=[347,113,37];class $a extends Fa{constructor(){const t=Ri($a.getDefaults(),arguments,["roomSize"]);super(t),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[],this.roomSize=new Mo({context:this.context,value:t.roomSize,units:"normalRange"}),this._scaleRoomSize=new vr({context:this.context,min:-.733,max:.197}),this._allpassFilters=Ya.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._feedbackCombFilters=Za.map(((t,e)=>{const s=new na({context:this.context,delayTime:t});return this._scaleRoomSize.connect(s.resonance),s.resonance.value=Xa[e],e<Za.length/2?this.connectEffectLeft(...this._allpassFilters,s):this.connectEffectRight(...this._allpassFilters,s),s})),this.roomSize.connect(this._scaleRoomSize),$i(this,["roomSize"])}static getDefaults(){return Object.assign(Fa.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach((t=>t.disconnect())),this._feedbackCombFilters.forEach((t=>t.dispose())),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class Ha extends Na{constructor(t){super(t),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),$i(this,["feedback"])}}class Ja extends Ha{constructor(){const t=Ri(Ja.getDefaults(),arguments,["delayTime","feedback"]);super(t),this.name="PingPongDelay",this._leftDelay=new Vo({context:this.context,maxDelay:t.maxDelay}),this._rightDelay=new Vo({context:this.context,maxDelay:t.maxDelay}),this._rightPreDelay=new Vo({context:this.context,maxDelay:t.maxDelay}),this.delayTime=new Mo({context:this.context,units:"time",value:t.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),$i(this,["delayTime"])}static getDefaults(){return Object.assign(Ha.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class Ka extends La{constructor(){const t=Ri(Ka.getDefaults(),arguments,["pitch"]);super(t),this.name="PitchShift",this._frequency=new Mo({context:this.context}),this._delayA=new Vo({maxDelay:1,context:this.context}),this._lfoA=new wr({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new Vo({maxDelay:1,context:this.context}),this._lfoB=new wr({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new ba({context:this.context}),this._crossFadeLFO=new wr({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new Vo({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,$i(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(La.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=ao(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=ao(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class tc extends Fa{constructor(){const t=Ri(tc.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);super(t),this.name="Phaser",this._lfoL=new wr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new wr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this.Q=new Mo({context:this.context,value:t.Q,units:"positive"}),this._filtersL=this._makeFilters(t.stages,this._lfoL),this._filtersR=this._makeFilters(t.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),$i(this,["frequency","Q"])}static getDefaults(){return Object.assign(Fa.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(t,e){const s=[];for(let n=0;n<t;n++){const t=this.context.createBiquadFilter();t.type="allpass",this.Q.connect(t.Q),e.connect(t.frequency),s.push(t)}return s}get octaves(){return this._octaves}set octaves(t){this._octaves=t;const e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach((t=>t.disconnect())),this._filtersR.forEach((t=>t.disconnect())),this.frequency.dispose(),this}}class ec extends Ta{constructor(){const t=Ri(ec.getDefaults(),arguments,["decay"]);super(t),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve(),this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Ta.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){ui(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){ui(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return Si(this,void 0,void 0,(function*(){const t=this.ready,e=new to(2,this._decay+this._preDelay,this.context.sampleRate),s=new er({context:e}),n=new er({context:e}),i=new Va({context:e});s.connect(i,0,0),n.connect(i,0,1);const o=new Ao({context:e}).toDestination();i.connect(o),s.start(0),n.start(0),o.gain.setValueAtTime(0,0),o.gain.setValueAtTime(1,this._preDelay),o.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const r=e.render();return this.ready=r.then(Ji),yield t,this._convolver.buffer=(yield r).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class sc extends bo{constructor(){super(Ri(sc.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new Ia({channels:2,context:this.context}),this._midAdd=new yr({context:this.context}),this.mid=new lr({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new Dr({context:this.context}),this.side=new lr({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class nc extends bo{constructor(){super(Ri(nc.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new Ao({context:this.context}),this.side=new Ao({context:this.context}),this._left=new yr({context:this.context}),this._leftMult=new lr({context:this.context,value:Math.SQRT1_2}),this._right=new Dr({context:this.context}),this._rightMult=new lr({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new Va({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class ic extends Ta{constructor(t){super(t),this.name="MidSideEffect",this._midSideMerge=new nc({context:this.context}),this._midSideSplit=new sc({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...t){this._midSend.chain(...t,this._midReturn)}connectEffectSide(...t){this._sideSend.chain(...t,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class oc extends ic{constructor(){const t=Ri(oc.getDefaults(),arguments,["width"]);super(t),this.name="StereoWidener",this.width=new Mo({context:this.context,value:t.width,units:"normalRange"}),$i(this,["width"]),this._twoTimesWidthMid=new lr({context:this.context,value:2}),this._twoTimesWidthSide=new lr({context:this.context,value:2}),this._midMult=new lr({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new Dr({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),So(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new lr({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(ic.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class rc extends Fa{constructor(){const t=Ri(rc.getDefaults(),arguments,["frequency","depth"]);super(t),this.name="Tremolo",this._lfoL=new wr({context:this.context,type:t.type,min:1,max:0}),this._lfoR=new wr({context:this.context,type:t.type,min:1,max:0}),this._amplitudeL=new Ao({context:this.context}),this._amplitudeR=new Ao({context:this.context}),this.frequency=new Mo({context:this.context,value:t.frequency,units:"frequency"}),this.depth=new Mo({context:this.context,value:t.depth,units:"normalRange"}),$i(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=t.spread}static getDefaults(){return Object.assign(Fa.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class ac extends Ta{constructor(){const t=Ri(ac.getDefaults(),arguments,["frequency","depth"]);super(t),this.name="Vibrato",this._delayNode=new Vo({context:this.context,delayTime:0,maxDelay:t.maxDelay}),this._lfo=new wr({context:this.context,type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,$i(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Ta.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class cc extends bo{constructor(){const t=Ri(cc.getDefaults(),arguments,["type","size"]);super(t),this.name="Analyser",this._analysers=[],this._buffers=[],this.input=this.output=this._gain=new Ao({context:this.context}),this._split=new Ia({context:this.context,channels:t.channels}),this.input.connect(this._split),ui(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type,this.smoothing=t.smoothing}static getDefaults(){return Object.assign(bo.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach(((t,e)=>{const s=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(s):"waveform"===this._type&&t.getFloatTimeDomainData(s)})),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach(((e,s)=>{e.fftSize=2*t,this._buffers[s]=new Float32Array(t)}))}get channels(){return this._analysers.length}get type(){return this._type}set type(t){li("waveform"===t||"fft"===t,`Analyser: invalid type: ${t}`),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach((e=>e.smoothingTimeConstant=t))}dispose(){return super.dispose(),this._analysers.forEach((t=>t.disconnect())),this._split.dispose(),this._gain.dispose(),this}}class hc extends bo{constructor(){super(Ri(hc.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new cc({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class lc extends hc{constructor(){const t=Ri(lc.getDefaults(),arguments,["smoothing"]);super(t),this.name="Meter",this.input=this.output=this._analyser=new cc({context:this.context,size:256,type:"waveform",channels:t.channelCount}),this.smoothing=t.smoothing,this.normalRange=t.normalRange,this._rms=new Array(t.channelCount),this._rms.fill(0)}static getDefaults(){return Object.assign(hc.getDefaults(),{smoothing:.8,normalRange:!1,channelCount:1})}getLevel(){return vi("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map(((t,e)=>{const s=t.reduce(((t,e)=>t+e*e),0),n=Math.sqrt(s/t.length);return this._rms[e]=Math.max(n,this._rms[e]*this.smoothing),this.normalRange?this._rms[e]:ro(this._rms[e])}));return 1===this.channels?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class uc extends hc{constructor(){const t=Ri(uc.getDefaults(),arguments,["size"]);super(t),this.name="FFT",this.normalRange=t.normalRange,this._analyser.type="fft",this.size=t.size}static getDefaults(){return Object.assign(bo.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map((t=>this.normalRange?oo(t):t))}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return li(0<=t&&t<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),t*this.context.sampleRate/(2*this.size)}}class pc extends hc{constructor(){super(Ri(pc.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class dc extends hc{constructor(){const t=Ri(dc.getDefaults(),arguments,["size"]);super(t),this.name="Waveform",this._analyser.type="waveform",this.size=t.size}static getDefaults(){return Object.assign(hc.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(t){this._analyser.size=t}}class fc extends bo{constructor(){const t=Ri(fc.getDefaults(),arguments,["solo"]);super(t),this.name="Solo",this.input=this.output=new Ao({context:this.context}),fc._allSolos.has(this.context)||fc._allSolos.set(this.context,new Set),fc._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(bo.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),fc._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){fc._soloed.has(this.context)||fc._soloed.set(this.context,new Set),fc._soloed.get(this.context).add(this)}_removeSolo(){fc._soloed.has(this.context)&&fc._soloed.get(this.context).delete(this)}_isSoloed(){return fc._soloed.has(this.context)&&fc._soloed.get(this.context).has(this)}_noSolos(){return!fc._soloed.has(this.context)||fc._soloed.has(this.context)&&0===fc._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),fc._allSolos.get(this.context).delete(this),this._removeSolo(),this}}fc._allSolos=new Map,fc._soloed=new Map;class mc extends bo{constructor(){const t=Ri(mc.getDefaults(),arguments,["pan","volume"]);super(t),this.name="PanVol",this._panner=this.input=new Aa({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Fo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,$i(this,["pan","volume"])}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class _c extends bo{constructor(){const t=Ri(_c.getDefaults(),arguments,["volume","pan"]);super(t),this.name="Channel",this._solo=this.input=new fc({solo:t.solo,context:this.context}),this._panVol=this.output=new mc({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),$i(this,["pan","volume"])}static getDefaults(){return Object.assign(bo.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return _c.buses.has(t)||_c.buses.set(t,new Ao({context:this.context})),_c.buses.get(t)}send(t,e=0){const s=this._getBus(t),n=new Ao({context:this.context,units:"decibels",gain:e});return this.connect(n),n.connect(s),n}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}_c.buses=new Map;class gc extends bo{constructor(){super(Ri(gc.getDefaults(),arguments)),this.name="Mono",this.input=new Ao({context:this.context}),this._merge=this.output=new Va({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}}class yc extends bo{constructor(){const t=Ri(yc.getDefaults(),arguments,["lowFrequency","highFrequency"]);super(t),this.name="MultibandSplit",this.input=new Ao({context:this.context}),this.output=void 0,this.low=new Wr({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Wr({context:this.context,frequency:0,type:"highpass"}),this.mid=new Wr({context:this.context,frequency:0,type:"lowpass"}),this.high=new Wr({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high],this.lowFrequency=new Mo({context:this.context,units:"frequency",value:t.lowFrequency}),this.highFrequency=new Mo({context:this.context,units:"frequency",value:t.highFrequency}),this.Q=new Mo({context:this.context,units:"positive",value:t.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),$i(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(bo.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),Hi(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class vc extends bo{constructor(){const t=Ri(vc.getDefaults(),arguments,["positionX","positionY","positionZ"]);super(t),this.name="Panner3D",this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=t.panningModel,this.maxDistance=t.maxDistance,this.distanceModel=t.distanceModel,this.coneOuterGain=t.coneOuterGain,this.coneOuterAngle=t.coneOuterAngle,this.coneInnerAngle=t.coneInnerAngle,this.refDistance=t.refDistance,this.rolloffFactor=t.rolloffFactor,this.positionX=new wo({context:this.context,param:this._panner.positionX,value:t.positionX}),this.positionY=new wo({context:this.context,param:this._panner.positionY,value:t.positionY}),this.positionZ=new wo({context:this.context,param:this._panner.positionZ,value:t.positionZ}),this.orientationX=new wo({context:this.context,param:this._panner.orientationX,value:t.orientationX}),this.orientationY=new wo({context:this.context,param:this._panner.orientationY,value:t.orientationY}),this.orientationZ=new wo({context:this.context,param:this._panner.orientationZ,value:t.orientationZ})}static getDefaults(){return Object.assign(bo.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(t,e,s){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=s,this}setOrientation(t,e,s){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=s,this}get panningModel(){return this._panner.panningModel}set panningModel(t){this._panner.panningModel=t}get refDistance(){return this._panner.refDistance}set refDistance(t){this._panner.refDistance=t}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(t){this._panner.rolloffFactor=t}get distanceModel(){return this._panner.distanceModel}set distanceModel(t){this._panner.distanceModel=t}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(t){this._panner.coneInnerAngle=t}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(t){this._panner.coneOuterAngle=t}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(t){this._panner.coneOuterGain=t}get maxDistance(){return this._panner.maxDistance}set maxDistance(t){this._panner.maxDistance=t}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class xc extends bo{constructor(){const t=Ri(xc.getDefaults(),arguments);super(t),this.name="Recorder",this.input=new Ao({context:this.context}),li(xc.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:t.mimeType})}static getDefaults(){return bo.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==wi&&Reflect.has(wi,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return Si(this,void 0,void 0,(function*(){li("started"!==this.state,"Recorder is already started");const t=new Promise((t=>{const e=()=>{this._recorder.removeEventListener("start",e,!1),t()};this._recorder.addEventListener("start",e,!1)}));return this._recorder.start(),yield t}))}stop(){return Si(this,void 0,void 0,(function*(){li("stopped"!==this.state,"Recorder is not started");const t=new Promise((t=>{const e=s=>{this._recorder.removeEventListener("dataavailable",e,!1),t(s.data)};this._recorder.addEventListener("dataavailable",e,!1)}));return this._recorder.stop(),yield t}))}pause(){return li("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class wc extends bo{constructor(){const t=Ri(wc.getDefaults(),arguments,["threshold","ratio"]);super(t),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor,this.threshold=new wo({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new wo({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new wo({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new wo({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new wo({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),$i(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(bo.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class bc extends bo{constructor(){const t=Ri(bc.getDefaults(),arguments,["threshold","smoothing"]);super(t),this.name="Gate",this._follower=new Oa({context:this.context,smoothing:t.smoothing}),this._gt=new Rr({context:this.context,value:oo(t.threshold)}),this.input=new Ao({context:this.context}),this._gate=this.output=new Ao({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(bo.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return ro(this._gt.value)}set threshold(t){this._gt.value=oo(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class Tc extends bo{constructor(){const t=Ri(Tc.getDefaults(),arguments,["threshold"]);super(t),this.name="Limiter",this._compressor=this.input=this.output=new wc({context:this.context,ratio:20,attack:.003,release:.01,threshold:t.threshold}),this.threshold=this._compressor.threshold,$i(this,"threshold")}static getDefaults(){return Object.assign(bo.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class Sc extends bo{constructor(){const t=Ri(Sc.getDefaults(),arguments);super(t),this.name="MidSideCompressor",this._midSideSplit=this.input=new sc({context:this.context}),this._midSideMerge=this.output=new nc({context:this.context}),this.mid=new wc(Object.assign(t.mid,{context:this.context})),this.side=new wc(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),$i(this,["mid","side"])}static getDefaults(){return Object.assign(bo.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class kc extends bo{constructor(){const t=Ri(kc.getDefaults(),arguments);super(t),this.name="MultibandCompressor",this._splitter=this.input=new yc({context:this.context,lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new Ao({context:this.context}),this.low=new wc(Object.assign(t.low,{context:this.context})),this.mid=new wc(Object.assign(t.mid,{context:this.context})),this.high=new wc(Object.assign(t.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),$i(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(bo.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class Ac extends bo{constructor(){const t=Ri(Ac.getDefaults(),arguments,["low","mid","high"]);super(t),this.name="EQ3",this.output=new Ao({context:this.context}),this._internalChannels=[],this.input=this._multibandSplit=new yc({context:this.context,highFrequency:t.highFrequency,lowFrequency:t.lowFrequency}),this._lowGain=new Ao({context:this.context,gain:t.low,units:"decibels"}),this._midGain=new Ao({context:this.context,gain:t.mid,units:"decibels"}),this._highGain=new Ao({context:this.context,gain:t.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),$i(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(bo.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),Hi(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class Cc extends bo{constructor(){const t=Ri(Cc.getDefaults(),arguments,["url","onload"]);super(t),this.name="Convolver",this._convolver=this.context.createConvolver(),this._buffer=new Ki(t.url,(e=>{this.buffer=e,t.onload()})),this.input=new Ao({context:this.context}),this.output=new Ao({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=t.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(bo.getDefaults(),{normalize:!0,onload:Ji})}load(t){return Si(this,void 0,void 0,(function*(){this.buffer=yield this._buffer.load(t)}))}get buffer(){return this._buffer.length?this._buffer:null}set buffer(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));const e=this._buffer.get();this._convolver.buffer=e||null}get normalize(){return this._convolver.normalize}set normalize(t){this._convolver.normalize=t}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}const Oc=no().transport;const Mc=no().destination,Dc=no().destination;const Ec=no().listener;const Rc=no().draw;const qc=no();const Ic=Ki,Vc=jo,Fc=tr;var Nc=Object.freeze({__proto__:null,AMOscillator:ur,AMSynth:zr,Abs:Cr,Add:yr,AmplitudeEnvelope:Pr,Analyser:cc,AudioToGain:hr,AutoFilter:ka,AutoPanner:Ca,AutoWah:Ma,BaseContext:Xi,BiquadFilter:Br,BitCrusher:Ea,Buffer:Ic,BufferSource:Fc,Buffers:Vc,Channel:_c,Chebyshev:qa,Chorus:Pa,Clock:Io,Compressor:wc,Context:Yi,Convolver:Cc,CrossFade:ba,DCMeter:pc,Delay:Vo,Destination:Mc,Distortion:ja,Draw:Rc,DuoSynth:Qr,EQ3:Ac,Emitter:Zi,Envelope:Ir,FFT:uc,FMOscillator:pr,FMSynth:Zr,FatOscillator:fr,FeedbackCombFilter:na,FeedbackDelay:za,Filter:Wr,Follower:Oa,Freeverb:Qa,Frequency:function(t,e){return new mo(no(),t,e)},FrequencyClass:mo,FrequencyEnvelope:Gr,FrequencyShifter:Wa,Gain:Ao,GainToAudio:Or,Gate:bc,GrainPlayer:Ar,GreaterThan:Rr,GreaterThanZero:Er,IntervalTimeline:Wo,JCReverb:$a,LFO:wr,Limiter:Tc,Listener:Ec,Loop:la,LowpassCombFilter:oa,Master:Dc,MembraneSynth:$r,Merge:Va,MetalSynth:Yr,Meter:lc,MidSideCompressor:Sc,MidSideMerge:nc,MidSideSplit:sc,Midi:function(t,e){return new Lo(no(),t,e)},MidiClass:Lo,Mono:gc,MonoSynth:Ur,MultibandCompressor:kc,MultibandSplit:yc,Multiply:lr,Negate:Mr,Noise:er,NoiseSynth:Hr,Offline:function(t,e){return Si(this,arguments,void 0,(function*(t,e,s=2,n=no().sampleRate){const i=no(),o=new to(s,e,n);io(o),yield t(o);const r=o.render();io(i);const a=yield r;return new Ki(a)}))},OfflineContext:to,OmniOscillator:gr,OnePoleFilter:ia,Oscillator:cr,PWMOscillator:mr,PanVol:mc,Panner:Aa,Panner3D:vc,Param:wo,Part:ua,Pattern:xa,Phaser:tc,PingPongDelay:Ja,PitchShift:Ka,Player:Sr,Players:kr,PluckSynth:ra,PolySynth:aa,Pow:Yo,PulseOscillator:dr,Recorder:xc,Reverb:ec,Sampler:ca,Scale:vr,ScaleExp:qr,Sequence:wa,Signal:Mo,Solo:fc,Split:Ia,StateTimeline:xo,StereoWidener:oc,Subtract:Dr,SyncedSignal:class extends Mo{constructor(){const t=Ri(Mo.getDefaults(),arguments,["value","units"]);super(t),this.name="SyncedSignal",this.override=!1,this._lastVal=t.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new Oo({context:this.context,offset:t.value,units:t.units}).start(0),this.setValueAtTime(t.value,0)}_onTick(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}_anchorValue(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}getValueAtTime(t){const e=new yo(this.context,t).toSeconds();return super.getValueAtTime(e)}setValueAtTime(t,e){const s=new yo(this.context,e).toSeconds();return super.setValueAtTime(t,s),this}linearRampToValueAtTime(t,e){const s=new yo(this.context,e).toSeconds();return super.linearRampToValueAtTime(t,s),this}exponentialRampToValueAtTime(t,e){const s=new yo(this.context,e).toSeconds();return super.exponentialRampToValueAtTime(t,s),this}setTargetAtTime(t,e,s){const n=new yo(this.context,e).toSeconds();return super.setTargetAtTime(t,n,s),this}cancelScheduledValues(t){const e=new yo(this.context,t).toSeconds();return super.cancelScheduledValues(e),this}setValueCurveAtTime(t,e,s,n){const i=new yo(this.context,e).toSeconds();return s=this.toSeconds(s),super.setValueCurveAtTime(t,i,s,n),this}cancelAndHoldAtTime(t){const e=new yo(this.context,t).toSeconds();return super.cancelAndHoldAtTime(e),this}setRampPoint(t){const e=new yo(this.context,t).toSeconds();return super.setRampPoint(e),this}exponentialRampTo(t,e,s){const n=new yo(this.context,s).toSeconds();return super.exponentialRampTo(t,e,n),this}linearRampTo(t,e,s){const n=new yo(this.context,s).toSeconds();return super.linearRampTo(t,e,n),this}targetRampTo(t,e,s){const n=new yo(this.context,s).toSeconds();return super.targetRampTo(t,e,n),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}},Synth:jr,Ticks:function(t,e){return new zo(no(),t,e)},TicksClass:zo,Time:function(t,e){return new fo(no(),t,e)},TimeClass:fo,Timeline:Bi,ToneAudioBuffer:Ki,ToneAudioBuffers:jo,ToneAudioNode:bo,ToneBufferSource:tr,ToneEvent:ha,ToneOscillatorNode:ar,Transport:Oc,TransportTime:function(t,e){return new yo(no(),t,e)},TransportTimeClass:yo,Tremolo:rc,Unit:Uo,UserMedia:or,Vibrato:ac,Volume:Fo,WaveShaper:Xo,Waveform:dc,Zero:xr,connect:So,connectSeries:To,connectSignal:Do,context:qc,dbToGain:oo,debug:xi,defaultArg:qi,disconnect:ko,fanIn:function(...t){const e=t.pop();si(e)&&t.forEach((t=>So(t,e)))},ftom:ho,gainToDb:ro,getContext:no,getDestination:function(){return no().destination},getDraw:function(){return no().draw},getListener:function(){return no().listener},getTransport:function(){return no().transport},immediate:function(){return no().immediate()},intervalToFrequencyRatio:ao,isArray:ai,isBoolean:ri,isDefined:si,isFunction:ni,isNote:hi,isNumber:ii,isObject:oi,isString:ci,isUndef:ei,loaded:function(){return Ki.loaded()},mtof:uo,now:function(){return no().now()},optionsFromArguments:Ri,setContext:io,start:function(){return so.resume()},supported:()=>(async(t,e,s,n,i,o,r,a,c,h,l,u,p,d,f,m)=>{if(t(e,e)&&t(s,s)&&t(i,i)&&t(o,o)&&t(a,a)&&t(c,c)&&t(h,h)&&t(l,l)&&t(u,u)&&t(p,p)&&t(d,d))return(await Promise.all([t(n,n),t(r,r),t(f,f),t(m,m)])).every((t=>t));return!1})(je,(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createBuffer(1,1,44100);if(void 0===e.copyToChannel)return!0;const s=new Float32Array(2);try{e.copyFromChannel(s,0,0)}catch{return!1}return!0})(Ye),(t=>()=>{if(null===t)return!1;if(void 0!==t.prototype&&void 0!==t.prototype.close)return!0;const e=new t,s=void 0!==e.close;try{e.close()}catch{}return s})(Ke),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);return new Promise((t=>{let s=!0;const n=n=>{s&&(s=!1,e.startRendering(),t(n instanceof TypeError))};let i;try{i=e.decodeAudioData(null,(()=>{}),n)}catch(t){n(t)}void 0!==i&&i.catch(n)}))})(Ye),(t=>()=>{if(null===t)return!1;let e;try{e=new t({latencyHint:"balanced"})}catch{return!1}return e.close(),!0})(Ke),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createGain(),s=e.connect(e)===e;return e.disconnect(e),s})(Ye),((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const s=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new MessageChannel,i=new e(1,128,44100),o=URL.createObjectURL(s);let r=!1;try{await i.audioWorklet.addModule(o);const e=new t(i,"a",{numberOfOutputs:0}),s=i.createOscillator();await new Promise((t=>{e.port.onmessage=()=>t(),e.port.postMessage(n.port2,[n.port2])})),e.port.onmessage=()=>r=!0,s.connect(e),s.start(0),await i.startRendering(),r=await new Promise((t=>{n.port1.onmessage=({data:e})=>t(1===e),n.port1.postMessage(0)}))}catch{}finally{n.port1.close(),URL.revokeObjectURL(o)}return r})(ns,Ye),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createChannelMerger();if("max"===e.channelCountMode)return!0;try{e.channelCount=2}catch{return!0}return!1})(Ye),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100);return void 0===e.createConstantSource||e.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(Ye),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100),s=e.createConvolver();s.buffer=e.createBuffer(1,1,e.sampleRate);try{s.buffer=e.createBuffer(1,1,e.sampleRate)}catch{return!1}return!0})(Ye),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch{return!1}return!0})(Ye),De,(t=>()=>null!==t&&t.hasOwnProperty("isSecureContext"))(Be),(t=>()=>{if(null===t)return!1;const e=new t;try{return e.createMediaStreamSource(new MediaStream),!1}catch(t){return!0}finally{e.close()}})(Ke),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);if(void 0===e.createStereoPanner)return Promise.resolve(!0);if(void 0===e.createConstantSource)return Promise.resolve(!0);const s=e.createConstantSource(),n=e.createStereoPanner();return s.channelCount=1,s.offset.value=1,n.channelCount=1,s.start(),s.connect(n).connect(e.destination),e.startRendering().then((t=>1!==t.getChannelData(0)[0]))})(Ye),Ee),version:a});</script>
<script type="module">
core.RefreshBox = async (args, env) => {
    const event = await interpretate(args[1], env);
    const interval = await interpretate(args[2], env);

    await interpretate(args[0], {...env});

    console.log({event, interval});

    if (interval > 0) {

        env.local.timer = setInterval(() => {
            console.log('Fire!', event);
            server.kernel.emitt(event, 'True');
        }, interval);
    }
}

core['Animate`Shutter'] = async (args, env) => {
    const dataset = await interpretate(args[1], env);
    const rate = await interpretate(args[2], env);

    let index = 0;
    setInterval(() => {
        core[args[0]].data = ['JSObject', dataset[index]];
        for (const inst of Object.values(core[args[0]].instances)) {
            inst.update();
        };

        index++;
        if (index >= dataset.length) index = 0;
    }, (1/rate) * 1000);
}

core['CoffeeLiqueur`Extensions`Manipulate`Internal`AnimationShutter'] = core['Animate`Shutter'];

core.RefreshBox.destroy = async (args, env) => {
    if (env.local.timer) clearInterval(env.local.timer);
    console.log('Time has been stopped');
}

core.RefreshBox.virtual = true;


const helper = async (args, env) => {
    await interpretate(args[0], env);
    const ranges = await interpretate(args[1], env);
    const event = await interpretate(args[2], env);
    const frameRate = 60.0 / (await interpretate(args[3], env));
    const startQ = await interpretate(args[4], env);
    const maxRepetitions = await interpretate(args[5], env);
    let repetitions = 0;

    env.local.event = event;
    let runningQ = false;
    let count = 0;
    let currentValue = ranges[0];

    function nextFrame() {
        server.kernel.io.fire(event, currentValue);
        currentValue += ranges[2];

        if (currentValue > ranges[1]) {
            currentValue = ranges[0];
            repetitions++;

            if (repetitions >= maxRepetitions && maxRepetitions > 0) {
                runningQ = false;
                return false;
            }

            return false;
        }

        return true;
    }
    
    let animate;
    animate = () => {
        if (!runningQ) return;

        count++;
        if (count >= frameRate) {
            count = 0;
            if (!nextFrame() && !startQ) {
                runningQ = false;

                return;
            }

            
        }

        
        env.local.uid = requestAnimationFrame(animate);
    }

    if (!startQ) {
        helper[event] = () => {
            if (runningQ) return;
            runningQ = true;
            repetitions = 0;
            animate(false);
        }
    } else {
        runningQ = true;
        animate(true);
    }
}

helper.destroy = (args, env) => {
    delete helper[env.local.event];
    cancelAnimationFrame(env.local.uid);
}

helper.virtual = true;

core['CoffeeLiqueur`Extensions`Manipulate`Internal`AnimationHelper'] = helper;
core['CoffeeLiqueur`Extensions`Manipulate`Internal`AnimationHelperRun']  = async (args, env) => {
    const event = await interpretate(args[0], env);
    if (helper[event]) helper[event]();
}
</script>
<script type="module">function unicodeToChar(text) {
    return text.replace(/\\:[\da-f]{4}/gi, 
           function (match) {
                return String.fromCharCode(parseInt(match.replace(/\\:/g, ''), 16));
           });
  }

class SystemPrintCells {
    global = {};

    dispose() {
      if (this.global.stack) {
        for (const obj of Object.values(this.global.stack))  {
          obj.dispose();
        }
      }
    }
    
    constructor(parent, data) {
      let elt = document.createElement("div");
      const uid = parent.uid;
      
      elt.classList.add('text-sm', 'ml-0.5', 'text-gray-500');
      elt.style.display = "block";
      
      parent.element.appendChild(elt);
      parent.element.classList.add('padding-fix');
      let str = data;

      if (RegExp(/\(\*/gm).exec(str)) {
        //spawn a code editor
        console.log({str});
        interpretate(['EditorView', ['JSObject', str]], {global: this.global, element: elt}).then((succs) => {}, (reject) => {
          elt.innerText = reject;
        });

        return this;
      } 

      if (str.charAt(0) === '"') {
        str = str.slice(1,-1);
      }

      elt.innerText = unicodeToChar(str);
      
      return this;
    }
  }
  
  window.SupportedCells['print'] = {
    view: SystemPrintCells
  };</script>
<script type="module">function readVarint(dataView, offset) {
    let value = 0, shift = 0, byte = 0;
    do {
        byte = dataView.getUint8(offset++);
        value |= (byte & 0x7F) << shift;
        shift += 7;
    } while (byte & 0x80);
    return { value, offset };
}


function readNumericArray(dataView, offset, length, type) {
    let arr;
    let rawLength;
    switch (type) {
        case 0: // int8
            arr = new Int8Array(dataView.buffer, offset, length);
            rawLength = length;
            break;
        
        case 16:
            arr = new Uint8Array(dataView.buffer, offset, length);
            rawLength = length;
            break;
        
        case 1: // int16
            arr = new Int16Array(dataView.buffer.slice(offset), 0, length);
            rawLength = length * 2;
            break;
        
        case 17:
            arr = new Uint16Array(dataView.buffer.slice(offset), 0, length);
            rawLength = length * 2;
            break;
        
         case 2: // 
            arr = new Int32Array(dataView.buffer.slice(offset), 0, length);
            rawLength = length * 4;
            break;
        
        case 18:
            arr = new Uint32Array(dataView.buffer.slice(offset), 0, length);
            rawLength = length * 4;
            break; 
        
        case 3: // 
            arr = new Int64Array(dataView.buffer.slice(offset), 0, length);
            rawLength = length * 8;
            break;
        
        case 19:
            arr = new Uint64Array(dataView.buffer.slice(offset), 0, length);
            rawLength = length * 8;
            break;        
        
        case 34:
            arr = new Float32Array(dataView.buffer.slice(offset), 0, length);
            rawLength = length * 4;        
            break;
        
        case 35:
            arr = new Float64Array(dataView.buffer.slice(offset), 0, length);
            rawLength = length * 8;
            //console.log(length);
            break;
        default:
            throw new Error(`Unsupported numeric array type: ${type}`);
    }
    return {array: arr, length: rawLength};
}

function readString(dataView, offset, length) {
    let decoder = new TextDecoder("utf-8");
    let bytes = new Uint8Array(dataView.buffer, offset, length);
    return decoder.decode(bytes);
}

//a tiny math library of functions
//as a replacement for window.interpretate (too slow for updates)
const fwxf = {};

fwxf.Ration = (args) => {
    return args[0]/args[1];
}

fwxf.Rational = (args) => {
    return args[0]/args[1];
}

fwxf.Sin = (args) => {
    if (args.length > 1) {
        return args.map(Math.sin)
    }
    
    return Math.sin(args[0])
}

fwxf.Cos = (args) => {
    if (args.length > 1) {
        return args.map(Math.cos)
    }
    
    return Math.cos(args[0])
}

fwxf.Tan = (args) => {
    if (args.length > 1) {
        return args.map(Math.tan)
    }
    
    return Math.tan(args[0])
}

fwxf.Sqrt = (args) => {
    if (args.length > 1) {
        return args.map(Math.sqrt)
    }
    
    return Math.sqrt(args[0])
}

fwxf.Pow = (args) => {
    if (args.length > 1) {
        const p = args[args.length - 1];
        return args.map((el) => Math.pow(el, p))
    }
    
    return Math.pow(args[0], args[1])
}

fwxf.Pi = (args) => Math.PI 
fwxf.E = (args) => Math.E

function deserializeWXF(buffer) {
    let dataView = new DataView(buffer);
    let offset = 0;

    // Parse the WXF version header
    if (dataView.getUint8(offset++) !== 56 || dataView.getUint8(offset++) !== 58) {
        throw new Error("Invalid WXF header.");
    }
    
    //console.log("WXF version header recognized.");

    function parseWXF(opts = {}) {
        if (offset >= dataView.byteLength) {
          throw new Error("Unexpected end of buffer.");
        }

        let token = dataView.getUint8(offset++);
        //console.log(`Processing token: ${token}`);

        switch (token) {
            case 102: { // "f" - function
                let { value: length, offset: newOffset } = readVarint(dataView, offset);
                offset = newOffset;
                let head = parseWXF();
                let args = [];
              
                //optimizations for numerical Lists bypass all checks
                if (head == "List") {
                  for (let i = 0; i < length; i++) {
                      args.push(parseWXF({...opts, listQ: true}));
                  }
                  
                  if (opts.listQ || opts.assocQ) return args;
                  return ['JSObject', args];   
                  
                }

                
                
                //process arguments, bypass all checks
                for (let i = 0; i < length; i++) {
                  args.push(parseWXF(opts));
                }      
                
                //optimization for lists again!
                //if bump into non number, but a simbol being inside a list
                if (opts.listQ || opts.assocQ) {
                    return fwxf[head](args); //run a tiny math library to calculate beforehand
                    //window.interpretate is too slow for updates
                }
                
                return [head, ...args];
                
            }
            case 67: { // "C" - signed 8-bit integer
                return dataView.getInt8(offset++);
            }
            case 106: { // "j" - signed 16-bit integer
                let value = dataView.getInt16(offset, true);
                offset += 2;
                return value;
            }
            case 105: { // "i" - signed 32-bit integer
                let value = dataView.getInt32(offset, true);
                offset += 4;
                return value;
            }
            case 114: { // "r" - IEEE double-precision real
                let value = dataView.getFloat64(offset, true);
                offset += 8;
                return value;
            }
            case 83: { // "S" - string
                let { value: length, offset: newOffset } = readVarint(dataView, offset);
                offset = newOffset;
                let str = readString(dataView, offset, length);
                offset += length;

                if (opts.listQ || opts.assocQ) { //if inside list, just paste JS object directly
                    return str;
                }

                return "'"+str+"'";
            }
            case 193: // "Á" - packed array
            case 194: { // "Â" - numeric array
                let arrayType = dataView.getUint8(offset++);
                let rank = dataView.getUint8(offset++);
                let dims = [];
                let length = 1;
                for (let i=0; i<rank; ++i) {
                  let { value: len, offset: newOffset } =readVarint(dataView, offset)
                  //const len = dataView.getUint8(offset++);
                  offset = newOffset;
                  
                  length *= len;
                  dims.push(len);
                }
                //let { value: length, offset: newOffset } = readVarint(dataView, offset);
                //console.log({value: length, offset: length, dims: dims});
                //offset = newOffset;
                let array = readNumericArray(dataView, offset, length, arrayType);
                offset += array.length;

                if (opts.listQ || opts.assocQ) { //mixure of lists and (packed) arrays FIXME //cannot treat!
                    return (new NumericArrayObject(array.array, dims)).normal();
                }

                return ['JSObject', new NumericArrayObject(array.array, dims)];
            }
            case 45: { // rule in association
                return [parseWXF(opts), parseWXF(opts)];
            }

            case 65: { // "A" - association
                let assoc = {};
                let { value: length, offset: newOffset } = readVarint(dataView, offset);
                offset = newOffset;
                for (let i = 0; i < length; i++) {
                    let keyvalue = parseWXF({...opts, assocQ:true});
                    //let value = parseWXF();
                    assoc[keyvalue[0]] = keyvalue[1];
                }

                if (opts.listQ || opts.assocQ) return assoc;

                return ['JSObject', assoc];
            }
            case 67: { // "C" - signed 8-bit integer
                return dataView.getInt8(offset++);
            }
            case 115: { // "s" - symbol
                let { value: length, offset: newOffset } = readVarint(dataView, offset);
                offset = newOffset;
                let symbol = readString(dataView, offset, length);
                offset += length;
                // Return as a symbol object or just the string for now
                return symbol;
            }
            default:
                throw new Error(`Unknown token: ${token} at offset ${offset - 1}`);
        }
    }

    try {
        return parseWXF();
    } catch (error) {
        console.error(`Deserialization error: ${error.message}`);
        throw error;
    }
}

interpretate.handleMessage = (event) => {
    const uid = Math.floor(Math.random() * 100);
    const global = {call: uid};
    if (event.data instanceof ArrayBuffer) {
        //console.warn('Captured binary frame!');
        const parsed = deserializeWXF(event.data);
        //console.log(parsed);
        interpretate(parsed, {global: global});
    } else {
        //console.warn('Captured text frame!');
        interpretate(JSON.parse(event.data), {global: global});
    }
}

</script><script type="module"> core.UIAsk = async (args, env) => {
            const result = await interpretate(args[0]);
            const uid = await interpretate(args[1]);
            console.warn("A request from server");
            //console.log(result);
            //console.log(JSON.stringify(result));

            server.self.emitt(uid, '"' + encodeURIComponent(JSON.stringify(result)) + '"');
        }

        core.UIClose = async (args, env) => {
            
            console.warn('close');
            if (core.UIClose.unload) return;
            window.close();
        }

        core.UIClose.unload = false;

        window.addEventListener('beforeunload', function (e) {
            console.warn('unload');
            //prevent closing the window if a user reloaded the current one
            core.UIClose.unload = true;
        });

        core.UILocation = async (args, env) => {
            const url = await interpretate(args[0], env);
            server.socket.close();
            window.location = url;
        }

        core.UILocationBlank = async (args, env) => {
            const opts = await core._getRules(args, env);
            const url = await interpretate(args[0], env);

            if (opts.Features) {
                console.warn('Custom window open');
                window.open(url, 'Window', opts.Features);
            } else {
                const fake = document.createElement('a');
                fake.target = "_blank";
                fake.href = url;
                fake.click();
            }
        }        

        core.UILazyContainer = async (args, env) => {
            const type = await interpretate(args[0], env);
            await core.UILazyContainer[type](args.slice(1), env);
        }

        core.UILazyContainer.AppendAfterParent = async (args, env) => {
            const uid = await interpretate(args[0], env);
            const data = await interpretate(args[1], env);

            const after = args[2];

            const element = document.getElementById(uid).parentNode;
            let length = element.childNodes.length;

            element.insertAdjacentHTML("afterbegin", data);
            length = element.childNodes.length - length;

            for (let i=0; i<length; ++i) {
                interpretate(after, {...env, element: element.childNodes[i]});
            }
            //execute scripts
            const scriptList = element.firstChild;
            console.log(scriptList);
            if (scriptList.nodeType === 1) Array.from(scriptList.querySelectorAll("script")).forEach( oldScriptEl => {
              const newScriptEl = document.createElement("script");
              
              Array.from(oldScriptEl.attributes).forEach( attr => {
                newScriptEl.setAttribute(attr.name, attr.value) 
              });
              
              const scriptText = document.createTextNode(oldScriptEl.innerHTML);
              newScriptEl.appendChild(scriptText);
              
              oldScriptEl.parentNode.replaceChild(newScriptEl, oldScriptEl);
          });
        }

        core.UILazyContainer.AppendBeforeParent = async (args, env) => {
            const uid = await interpretate(args[0], env);
            const data = await interpretate(args[1], env);

            const after = args[2];

            const element = document.getElementById(uid).parentNode;
            let length = element.childNodes.length;

            element.insertAdjacentHTML("beforeend", data);

            length = element.childNodes.length - length;
            for (let i=0; i < length; ++i) {
                interpretate(after, {...env, element: element.childNodes[element.childNodes.length - i - 1]});
            }
     
            //execute scripts
            const scriptList = element.lastChild;
            console.log(scriptList);
            if (scriptList.nodeType === 1) Array.from(scriptList.querySelectorAll("script")).forEach( oldScriptEl => {
              const newScriptEl = document.createElement("script");
              
              Array.from(oldScriptEl.attributes).forEach( attr => {
                newScriptEl.setAttribute(attr.name, attr.value) 
              });
              
              const scriptText = document.createTextNode(oldScriptEl.innerHTML);
              newScriptEl.appendChild(scriptText);
              
              oldScriptEl.parentNode.replaceChild(newScriptEl, oldScriptEl);
            });
        }        

        core.UILazyContainer.AppendScript = async (args, env) => {
           
            const data = await interpretate(args[0], env);
            const script = document.createElement('script');
            script.textContent = data;
            document.body.appendChild(script);
        }

        core.UILazyLoad = async (args, env) => {
            const type = await interpretate(args[0], env);
            await core.UILazyLoad[type](args.slice(1), env);
        }

        core.UILazyLoad.Load = async (args, env) => {
            const uid = await interpretate(args[0], env);
            const data = await interpretate(args[1], env);

            setInnerHTML(document.getElementById(uid), data);
        }

        core.UILazyLoad.Hide = async (args, env) => {
            const uid = await interpretate(args[0], env);
            document.getElementById(uid).classList.add("hidden");
        } 

        core.UILazyLoad.Remove = async (args, env) => {
            const uid = await interpretate(args[0], env);
            document.getElementById(uid).innerHTML = "";
            document.getElementById(uid).classList.remove("hidden");
        }         

        core.UILazyLoad.Show = async (args, env) => {
            const uid = await interpretate(args[0], env);
            document.getElementById(uid).classList.remove("hidden");
        }     

        core.UILazyEventDispatch = async (args, env) => {
            const uid = await interpretate(args[0], env);
            const type = await interpretate(args[1], env);
            
            if (!core.UILazyEventDispatch[uid]) throw `Event listener ${uid} does not exist`;
            core.UILazyEventDispatch[uid](type, args[2], env);
        }  

        window.UIJSScript = class {
            event = undefined;
            listeners = {};
            constructor(opts) {
                this.event = opts.uid
                const self = this;
                core.UILazyEventDispatch[this.event] = function (type, data, env) {
                    if (type in self.listeners) {
                        self.listeners[type](data, env);
                    } else {
                        console.warn(`Pattern ${type} does not exist. Ignoring...`);
                    }
                };

                const scoped = opts.target.bind(self);
                scoped();
            }

            on(type, handler) {
                this.listeners[type] = handler;
            }
        }</script>
        <script type="module">
            core.SlientPing = () => {
  console.log('Ppspsp... server is there');
}

class fakeSocket {

q = []

isFakeSocket = true

send = (expr) => {
  console.warn('No connection to a kernel... keeping in a pocket');
  this.q.push(expr)
}

constructor() {

}
}  

const promises = {}

class ServerIO {
  format = "ExpressionJSON";
  headSymbol = "EventFire";

  constructor(server, opts = {}) {
    this.server = server;
  }

  fire(uid, object, pattern = "Default") { //regular event call
    const data = encodeURIComponent(JSON.stringify(object));
    this.server.socket.send(this.headSymbol+'["'+uid+'", "'+pattern+'", ImportString[URLDecode["'+data+'"], "RawJSON"]]');
  }

  poke(uid) { //superfast just send a dummy message (can be used for calling animation frame)
    this.server.socket.send(this.headSymbol+'["'+uid+'", True]');
  }

  request(ev, object, pattern = "Default") { //the same as event call, but returns the result
    const uid = uuidv4();

    const promise = new Deferred();
    promises[uid] = promise;

    const data = encodeURIComponent(JSON.stringify(object));
    this.server.socket.send('WLJSIORequest["'+uid+'"]["'+ev+'", "'+pattern+'", ImportString[URLDecode["'+data+'"], "RawJSON"]]');

    return promise.promise     
  }

  fetch(symbol, args=false) { //fetch any symbol value
    const uid = uuidv4();

    const promise = new Deferred();
    promises[uid] = promise;

    if (args) {
      const data = encodeURIComponent(JSON.stringify(args));
      this.server.socket.send('WLJSIOFetch["'+uid+'"]['+symbol+', ImportString[URLDecode["'+data+'"], "RawJSON"]]');
      return promise.promise     
    }

    this.server.socket.send('WLJSIOFetch["'+uid+'"]['+symbol+']');
    
    return promise.promise     
  }

  dispose() {

  }
}

//Server API
window.Server = class {
 
  socket = new fakeSocket();  

  trackedSymbols = {};
  name = 'Unknown';
  event;

  kernel;

  onMessage(event) {
    const uid = Math.floor(Math.random() * 100);
    const global = {call: uid};
    interpretate(JSON.parse(event.data), {global: global});
  }
  
  constructor(name = "Unknown") {
    console.warn('Server was constructed with name '+name);
    this.name = name;
    this.kernel = this;

    this.self = this;

    this.io = new ServerIO(this);
  }

  init(opts) {
    //opts: socket
    //opts: kernel

    if (!opts.socket) throw('Socket is not provided!');
    
    this.kernel = this;

    const self = this;

    if (opts.kernel) {
      console.log('kernel object was provided');
      this.kernel = opts.kernel;
    }

    if (this.socket.isFakeSocket) {
      console.warn('Sending all quered messages');

      this.socket.q.forEach((message)=>{
        opts.socket.send(message);
      });
    } 

    this.socket = opts.socket;

    
  }

  dispose() {
    //
    console.warn('Disposing all tracked symbols');
    Object.keys(this.trackedSymbols).forEach((sym) => {
      delete core[sym];
    });

    if (this.io) {
      this.io.dispose();
    }
  }

  //evaluate something on the master kernel and make a promise for the reply
  ask(expr, mode = undefined) { // DEPRICATED!!! needs to keep to support legacy code (NOT SECURE)
    const uid = uuidv4();

    const promise = new Deferred();
    promises[uid] = promise;
    console.log('Asking expr');
    console.log(expr);

    if (mode == 'callback') {
      this.socket.send('WLJSIOPromiseCallback["'+uid+'", ""]['+expr+']');
    } else {
      this.socket.send('WLJSIOPromise["'+uid+'", ""]['+expr+']');
    }
    

    return promise.promise 
  };
  //fire event on the secondary kernel (your working area) (no reply)
  emitt(uid, data, type = 'Default') { // DEPRICATED!!! needs to keep to support legacy code (NOT SECURE)
    this.socket.send('EventFire["'+uid+'", "'+type+'", '+data+']');
  };

  _emitt(uid, data, type) { // DEPRICATED!!! needs to keep to support legacy code (NOT SECURE)
    //unescaped version
    console.log({uid:uid, data:data, type:type});
    this.socket.send('EventFire["'+uid+'", '+type+', '+data+']');
  };    

  send(expr) { //// DEPRICATED!!! needs to keep to support legacy code (NOT SECURE)
    this.socket.send(expr);
  };

  getSymbol(expr) {
    const uid = uuidv4();

    const promise = new Deferred();
    promises[uid] = promise;
    //not implemented
    //console.error('askKernel is not implemented');
    //console.log('NotebookPromiseKernel["'+uid+'", ""][Hold['+expr+']]');
    this.socket.send('WLJSIOGetSymbol["'+uid+'", ""][Hold['+expr+']]');

    return promise.promise     
  }

  addTracker(name) {
    console.warn('added tracker for '+name);
    this.socket.send('WLJSIOAddTracking['+name+']')
  }
}

core.WLJSIOUpdateSymbol = async (args, env) => {
  const name = interpretate(args[0], env);
  //console.log("update");
  //update
  core[name].data = args[1];

  //console.log('instance list');
  //console.log(core[name].instances);

  for (const inst of Object.values(core[name].instances)) {
      await inst.update();
  };
}

core.WLJSIOPromiseResolve = (args, env) => {
  const uid = interpretate(args[0], env);
  if (args[1] == '$Failed') {
    promises[uid].reject(args[1]);
  } else {
    promises[uid].resolve(args[1]);
  }
  console.log('promise resolved! : ' + uid);
  delete promises[uid];
}

core.FireEvent = function(args, env) {
  const key = interpretate(args[0], env);
  const data = interpretate(args[1], env);

  server.kernel.emitt(key, data);
}

core.KernelFire = function(args, env) {
  const data = interpretate(args[0], env);

  server.talkKernel(data);
}

core.KernelEvaluate = function(args, env) {
  const data = interpretate(args[0], env);

  server.askKernel(data);
}

core.TalkMaster = async(args, env) => {
  const data = await interpretate(args[0], env);
  const wrapper = await interpretate(args[1], env);
  server.send(wrapper + '["' + JSON.stringify(data).replace(/"/gm, "\\\"") + '"]');
}

core.TalkKernel = async(args, env) => {
  const data = await interpretate(args[0], env);
  const wrapper = await interpretate(args[1], env);
  server.kernel.send(wrapper + '["' + JSON.stringify(data).replace(/"/gm, "\\\"") + '"]');
}

const bjtag = decodeURIComponent('%3Cscript%20type%3D%22module%22%3E');
const ejtsg = decodeURIComponent('%3C%2Fscript%3E');

core.WLXEmbed = async (args, env) => {
  const options = await core._getRules(args, {...env, hold:true});
  let html = await interpretate(args[0], env);

  if (Array.isArray(html)) {
    html = html.join('\n');   
  }

  setInnerHTML(env.element, html);

  if ('SideEffect' in options) {
    await interpretate(options.SideEffect, env);
  }
}   

core.WLXEmbed.destroy = async (args, env) => {
  await core._getRules(args, {...env});
  await interpretate(args[0], env);
}

let tryreload;
let attempts = 0;

tryreload = (failed) => {
  /*var state = history.state || {};
  var reloadCount = state.reloadCount || 0;
  if (performance.navigation.type === 1) { // Reload
      state.reloadCount = ++reloadCount;
      history.replaceState(state, null, document.URL);
  } else if (reloadCount) {
      reloadCount = 0;
      delete state.reloadCount;
      history.replaceState(state, null, document.URL);
  }


  if (reloadCount > 3) {
      reloadCount = 0;
      delete state.reloadCount;
      history.replaceState(state, null, document.URL);
      failed();
      return;
  }*/

  document.body.style.filter = "blur(10px)";
  attempts++;

  if (attempts > 5) {
    failed();
    return;
  }

  console.warn('Checking connection...');

  setTimeout(() => {
    fetch(window.location.protocol+'//'+window.location.host+'/ping').then((res)=>{
      if (res.status === 200) {
        console.warn('Reloading...');
        window.location.reload();
      } else {
        console.warn('Checking connection... FAILED');
        setTimeout(() => tryreload(failed), 500);
      }
    }, (rej)=>{
      console.warn('Checking connection... FAILED');
      setTimeout(() => tryreload(failed), 500);
    });

    
  }, 3000);

}

function jsonStringifyRecursive(obj) {
  const cache = new Set();
  return JSON.stringify(obj, (key, value) => {
      if (typeof value === 'object' && value !== null) {
          if (cache.has(value)) {
              // Circular reference found, discard key
              return;
          }
          // Store value in our collection
          cache.add(value);
      }
      return value;
  }, 4);
}

//default plug for a server object
window.server = undefined;

interpretate.anonymous = async (d, org) => {
  //TODO Check if it set delayed or set... if set, then one need only to cache it
  console.log('Anonimous symbol: ' + JSON.stringify(d));  

  let name;
  //check it is a plain symbol
  if (d instanceof Array) {
    //console.error('stack call: ');
    //console.error(jsonStringifyRecursive(org.global.stack));
    throw('unknown WL expression. Error at '+d[0]);
  } else {
    name = d;   //symbol
  }

  let data;
  let packed = false;

  //request it from the server
  console.log('sending request to a server... for'+name);
  if (!server || !server?.kernel) {
    console.log('no evaluation kernel available, trying master...');
    data = await server.getSymbol(name); //get the data
  } else {
    if (!server.kernel.connected) {
      console.log('no evaluation connected kernel available, trying master...');
      data = await server.getSymbol(name); //get the data
    } else {
      console.log('fetching from evaluation kernel');
      data = await server.kernel.getSymbol(name); //get the data
    }
  }
  console.log('got');
  //console.log(data);
  
  //check for strings 
  let symbolQ = typeof data === 'string';

  if (symbolQ) {
    if (data.charAt(0) == "'") symbolQ = false;
    if (isNumeric(data)) symbolQ = false;
  }

  //if it is a shit
  if ((symbolQ && !(data in core)) || typeof data == 'undefined') {
    console.log('checking... '+name);
    console.log('recived data..');
    console.log(jsonStringifyRecursive(data));
    //console.error('stack call: ');
    //console.error(jsonStringifyRecursive(org.global.stack));
    throw('received symbol '+data+' is not defined in any contextes and packing'); 
  }

  //if it is OK
  if (name in core) {
    //already requested
    console.log('it was already requested');
    return interpretate(d, org);
  }

  core[name] = async (args, env) => {
    console.log('IE: calling our symbol...');
    //evaluate in the context
    const data = await interpretate(core[name].data, env);

    if (env.root && !env.novirtual) core[name].instances[env.root.uid] = env.root; //if it was evaluated insdide the container, then, add it to the tracking list
    //if (env.hold) return ['JSObject', core[name].data];

    return data;
  }

  core[name].update = async (args, env) => {
    //evaluate in the context
    //console.log('IE: update was called...');

    //cache good for numerics
    if (env.useCache) {
      if (!core[name].cached || core[name].currentData != core[name].data) {
        core[name].cached = await interpretate(core[name].data, env);
        core[name].currentData = core[name].data; //just copy the reference
        //console.log('cache miss');
      } 

      return core[name].cached;
    }

    const data = await interpretate(core[name].data, env);
    //if (env.hold) return ['JSObject', data];
    return data;
  }  

  core[name].destroy = async (args, env) => {

    delete core[name].instances[env.root.uid];
    console.warn(env.root.uid + ' was destroyed')
    console.warn('external symbol was destoryed');
  }  

  core[name].data = data; //get the data

  server.kernel.addTracker(name);
  server.kernel.trackedSymbols[name] = true;

  core[name].virtual = true;
  core[name].instances = {};

  //interpretate it AGAIN!
  return interpretate(d, org);
}

core.Offload = (args, env) => {
  if (args.length > 1) {
      //alternative path - checking options
      //do it in ugly superfast way
      if (args[1][1] === "'Static'") {
          if (args[1][2]) {
              return interpretate(args[0], {...env, static: true});
          }
      } else if (args.length > 2) {
          if (args[2][1] === "'Static'") {
              if (args[2][2]) {
                  return interpretate(args[0], {...env, static: true});
              }                
          }
      }
  }

  return interpretate(args[0], env);
}

core.Offload.update = (args, env) => {
  if (args.length > 1) {
      //alternative path - checking options
      //do it in ugly superfast way

      //Volitile -> False -> Reject updates

      //low-level optimizations, we dont' need to spend time on parsing options
      if (args[1][1] === "'Volatile'") {
          if (!args[1][2]) {
              console.log('Update was rejected (Nonvolatile)');
              return;
          }
      } else if (args.length > 2) {
          if (args[2][1] === "'Volatile'") {
              if (!args[2][2]) {
                  console.log('Update was rejected (Nonvolatile)');
                  return;
              }                
          }
      }
  }

  return interpretate(args[0], env);
}

//a default fallback!!!
core.FrontEndVirtual = async (args, env) => {
  const copy = {...env};
  const store = args[0];
  const instance = new ExecutableObject('fevirtual-fallback-'+uuidv4(), copy, store);
  instance.assignScope(copy);


  return await instance.execute();
}

core.Offload.destroy = (args, env) => {
  return interpretate(args[0], env);
}

            ;
            const wport = 0;
            var socket = new WebSocket((window.location.protocol == "https:" ? "wss://" : "ws://")+window.location.hostname+':'+wport);
            window.server = new Server('Master Kernel');

            socket.onopen = function(e) {
              console.log("[open]");
              
              server.init({socket: socket});
            }; 

            socket.onmessage = function(event) {
              //create global context
              //callid
              const uid = Math.floor(Math.random() * 100);
              var global = {call: uid};
              interpretate(JSON.parse(event.data), {global: global});
            };

            socket.onclose = function(event) {
              console.log(event);
              if (wport == 0) return;
              tryreload(() => {
                alert('Connection lost. Please, update the page to see new changes.')
              });
            }; 

            
        </script>
    <style > .cwrapper {
                padding-top: 0.25rem;
                padding-bottom: 0.25rem;
              }</style></head><body class="h-full dark:bg-black bg-white"><div ><div class="px-2" id="frame"><div class="h-full block relative" style="
                width: calc(100vw - 0.5rem);
                overflow-x: hidden;
              "><main class="grow dark:invert dark:contrast-75 dark:brightness-5 dark:hue-rotate-180 bg-white"><div id="ceo-placeholder" class="px-3 pr-4 py-2 sm:px-2 sm:pr-3 ml-4 md:px-4 md:pr-5 overflow-y-auto absolute grow bg-white" style="margin-top: 1rem; height: 100 vh; width:100%; overflow: hidden;"><h2 style="font-size:x-large; font-weight:600; margin-bottom:0.25rem">Bubble chart</h2>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">BubbleChart[RandomReal[1, {5, 7, 3}]]</code>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">BubbleChart[RandomReal[1, {10, 3}], 
 ChartElementFunction -&gt; &quot;NoiseBubble&quot;]</code>
<h2 style="font-size:x-large; font-weight:600; margin-bottom:0.25rem">Bar Charts</h2><pstyle="margin-top: 0.5rem">Generate a bar chart for a list of heights</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">BarChart[{1, 2, 3}]</code>
<pstyle="margin-top: 0.5rem">Multiple datasets</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">BarChart[{{1, 2, 3}, {1, 3, 2}, {5, 2}}, 
 ChartLabels -&gt; {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;}, LabelingFunction -&gt; Above]</code>
<pstyle="margin-top: 0.5rem">Categorical legends</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">BarChart[{{1, 2, 3}, {1, 3, 2}, {5, 2}}, 
 ChartLegends -&gt; {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;}]</code>
<h2 style="font-size:x-large; font-weight:600; margin-bottom:0.25rem">Sector charts</h2><pstyle="margin-top: 0.5rem">A sector chart with the second component representing the radial size</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">SectorChart[{{1, 1}, {1, 2}, {1, 3}}]</code>
<pstyle="margin-top: 0.5rem">An anuual sector chart</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">SectorChart[{{1, 1}, {1, 2}, {1, 3}}, SectorOrigin -&gt; {Automatic, 1}]</code>
<h2 style="font-size:x-large; font-weight:600; margin-bottom:0.25rem">Pie chart</h2><pstyle="margin-top: 0.5rem">Generate a pie chart for a list of values</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">PieChart[{1, 2, 3, 4}]</code>
<pstyle="margin-top: 0.5rem">Multiple datasets and categorical labels</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">PieChart[{{1, 2, 3}, {2, 2, 1}}, ChartLabels -&gt; {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;}]</code>
<pstyle="margin-top: 0.5rem">Or as legends</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">PieChart[{{1, 2, 3}, {2, 2, 1}}, ChartLegends -&gt; {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;}]</code>
<h2 style="font-size:x-large; font-weight:600; margin-bottom:0.25rem">Histogram</h2><pstyle="margin-top: 0.5rem">Generate a histogram for a list of values</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">Histogram[RandomVariate[NormalDistribution[0, 1], 200]]</code>
<pstyle="margin-top: 0.5rem">Multiple datasets</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">data1 = RandomVariate[NormalDistribution[0, 1], 500];
data2 = RandomVariate[NormalDistribution[3, 1/2], 500];

Histogram[{data1, data2}]</code>
<pstyle="margin-top: 0.5rem">__Stylize__ the data</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">Histogram[{data1, data2}, ChartStyle -&gt; &quot;Pastel&quot;]</code>
<pstyle="margin-top: 0.5rem">Use color function</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">Histogram[RandomVariate[NormalDistribution[0, 1], 500], 
 ColorFunction -&gt; Function[{height}, Opacity[height]], 
 ChartStyle -&gt; Purple]</code>
<pstyle="margin-top: 0.5rem">Get the wind data directions</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">data = WeatherData[&quot;KCMI&quot;, 
   &quot;WindDirection&quot;, {{2007, 11, 1}, {2008, 11, 1}}]</code>
<pstyle="margin-top: 0.5rem">Define a chart element function that stores bin width and count data using Sow</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">sowingBar[{{x0_, x1_}, {y0_, y1_}}, __] := (Sow[{x1 - x0, 
    100*(y1 - y0)}]; Rectangle[{x0, y0}, {x1, y1}])</code>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">{histogram, newdata} = 
  Reap[Histogram[data, Automatic, &quot;Probability&quot;, 
    ChartElementFunction -&gt; sowingBar]];

histogram </code>
<pstyle="margin-top: 0.5rem">Create a polar histogram of the wind-direction frequencies:</p>
<code style="font-family: monospace; display:block; margin-top:0.5rem; margin-botoom:0.5rem; padding:0.5rem; ">SectorChart[newdata, SectorOrigin -&gt; {Pi/2, &quot;Clockwise&quot;}, 
 PolarAxes -&gt; True, PolarGridLines -&gt; Automatic, 
 PlotRange-&gt;{2 Pi {-1,1}, 2 Pi {-1,1}},
 ChartBaseStyle -&gt; Directive[Opacity[1], EdgeForm[Thin]]]</code>
<pstyle="margin-top: 0.5rem">Warning: __ticks styling__ in polar plots are not supported for now.</p></div><div id="container-3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6" class="ccontainer px-3 pr-4 py-2 sm:px-2 sm:pr-3 md:px-4 md:pr-5 overflow-y-auto grow bg-white" style=" padding-bottom: 5rem; position: relative; margin-top: 1rem; filter: blur(150px);"><button id="questionmark" class="mt-4 p-1 px-2 hover:bg-gray-100 rounded right-0 absolute text-gray-500" style="right: 1rem; z-index: 150;"><svg version="1.1" class="w-5 h-5 text-gray-400 hover:rotate-90 transition" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" stroke="currentColor"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"></circle><path d="M10.125 8.875C10.125 7.83947 10.9645 7 12 7C13.0355 7 13.875 7.83947 13.875 8.875C13.875 9.56245 13.505 10.1635 12.9534 10.4899C12.478 10.7711 12 11.1977 12 11.75V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"></path><circle cx="12" cy="16" r="1" fill="currentColor" stroke="none"></circle></svg></button><div id="dropdown-web" class="absolute hidden mt-20 right-0 z-inf mt-0 w-56 origin-top-right divide-y divide-gray-100 rounded backdrop-blur-xl bg-white/90 drop-shadow-xl outline outline-gray-300 outline-offset-0 outline-1 text-gray-800 dark:invert dark:contrast-75 dark:brightness-5" style="margin-top: 3rem; margin-right: 1rem;" role="menu" aria-orientation="vertical" aria-labelledby="menu-button" tabindex="-1"><div class="py-0 px-2" role="none"><button id="reopen_in_app" class="block w-full hover:bg-teal-400 hover:text-white text-black group flex items-center px-1 my-1 py-1 rounded text-sm leading-4" role="menuitem" tabindex="-1"><svg class="mr-2 h-4 w-4 text-black" viewBox="18 18 43 43" fill="currentColor" aria-hidden="true"><path stroke-linejoin="round" d="M 54,54L 54,40L 33,40L 33,54L 54,54 Z M 57,34L 57,57L 30,57L 30,34L 57,34 Z M 43,25L 22,25L 22,39L 27,39L 27,42L 19,42L 19,19L 46,19L 46,31L 43,31L 43,25 Z "></path></svg> Open in WLJS Notebook</button></div><div class="py-0 px-2" role="none"><div class="block w-full text-black group flex items-center px-1 my-1 py-1 rounded text-sm leading-4" role="menuitem" tabindex="-1">Static web notebook</div></div><div class="py-0 px-2" role="none"><div class="block w-full text-black group flex items-center px-1 my-1 py-1 rounded text-sm leading-4" role="menuitem" tabindex="-1"> Author kirill</div></div><div class="py-0 px-2" role="none"><div class="block w-full text-black group flex items-center px-1 my-1 py-1 rounded text-sm leading-4" role="menuitem" tabindex="-1"> Created Thu 1 May 2025 20:19:57</div></div></div><script type="module"> let handler;
            const menu = document.getElementById('dropdown-web');

            handler = (ev) => {
                window.removeEventListener('click', handler);
                menu.classList.add('hidden');
            };

            document.getElementById('questionmark').addEventListener('click', (event) => {
              menu.classList.remove('hidden');
              event.stopPropagation();
              window.addEventListener('click', handler);
            });

            document.getElementById('reopen_in_app').addEventListener('click', () => {
              const a = document.createElement('a');
              a.href = 'wljs-url-message://' + encodeURIComponent(JSON.stringify({'type':'open_html', 'url': window.location.href}));
              a.click();
            });</script><style > :root {
            --editor-selected-tint: #0088550d;
        }</style></div></main><div id="sidebar-right" class="relative mt-10 w-full hidden md:flex" style="width: 16rem;height: 100vh;float: right; opacity:0;"><div class="fixed"><div ><div class="text-sm group items-center osx:font-semibold px-4 leading-8 text-gray-454 win:text-gray-500 owin:text-gray-500 linux:text-gray-500 flex" style="-webkit-app-region:none"> Outline</div><div class="flex grow flex-col gap-y-5 overflow-y-auto px-4 sc-b"><nav class="flex flex-1 flex-col" style="-webkit-app-region:none"><ul role="list" class="flex flex-1 flex-col p-0 gap-y-1 pl-2 pb-4 text-sm text-gray-700 dark:text-gray-400"><li style="padding-left: 1.0rem" class="list-none relative w-full cursor-default rounded-md pl-3 pr-2 text-left focus:outline-none focus:ring-2 focus:ring-indigo-600"><a href="#a9b3659d-cc2f-4583-8ae4-3a661cf94759" class="text-left">Bubble chart</a></li>
<li style="padding-left: 1.0rem" class="list-none relative w-full cursor-default rounded-md pl-3 pr-2 text-left focus:outline-none focus:ring-2 focus:ring-indigo-600"><a href="#1b7d31ad-16a2-46e4-bb8d-80be3ff581c1" class="text-left">Bar Charts</a></li>
<li style="padding-left: 1.0rem" class="list-none relative w-full cursor-default rounded-md pl-3 pr-2 text-left focus:outline-none focus:ring-2 focus:ring-indigo-600"><a href="#b11045d8-0ca3-48e0-bb8f-fcecf734046b" class="text-left">Sector charts</a></li>
<li style="padding-left: 1.0rem" class="list-none relative w-full cursor-default rounded-md pl-3 pr-2 text-left focus:outline-none focus:ring-2 focus:ring-indigo-600"><a href="#f45e1bc6-e690-4385-b772-3f8e2250d286" class="text-left">Pie chart</a></li>
<li style="padding-left: 1.0rem" class="list-none relative w-full cursor-default rounded-md pl-3 pr-2 text-left focus:outline-none focus:ring-2 focus:ring-indigo-600"><a href="#033023b0-48b0-4d24-94be-f27d76c84aa6" class="text-left">Histogram</a></li></ul></nav></div></div></div></div></div></div></div><script type="module"> window.server = {
              emitt: () => {}
            }</script><script type="module"> const controls = (opts) => {
            const cell = opts.cell;
            const event = opts.event;
            
            if (cell.type != 'Input') return;
            const group = document.getElementById('group-'+cell.uid);           

            {
                const button = group.getElementsByClassName('button-chide')[0];
                console.log('hide cell');
                const separator = document.getElementById('separator-'+cell.uid);
                button.addEventListener('click', () => {
                    if (!cell.toggle()) return;
                    //inversed state already
                    if (!cell.props["Hidden"]) {
                        if (separator) separator.classList.remove('hidden');
                        button.classList.remove('rotate-90');
                    } else {
                        if (separator) separator.classList.add('hidden');
                        button.classList.add('rotate-90');
                    }
                });
            }            
        }

        //add it to the constructor
        CellWrapper.epilog.push(controls);</script><script type="module"> const jsonstorage = document.getElementById('json-objects');
            const store = JSON.parse(jsonstorage.innerText)["storage"];

            const a = async () => {
              const assoc = await interpretate(store, {hold:true});

              Object.keys(assoc).forEach(element => {
                const o = new ObjectStorage(element);
                o.cached = true;
                o.cache = assoc[element];
              });
            }

            await a(store);</script><script type="module"> const jsonstorage = document.getElementById('cells-data');
            const store = JSON.parse(jsonstorage.innerText)["storage"];

            const placeholder = document.getElementById('ceo-placeholder');
            const sidebar = document.getElementById("sidebar-right");
            const container = document.getElementById('container-3bbb675c-6ffd-4d06-b0d9-cfaf0daaefb6');
          

            const process = async () => {
              const assoc = await interpretate(store, {});
              const list    = assoc.List;

              for (const item of Object.values(assoc.Cells)) {
                const template = item.Template;
                const store    = item.Data;

                new CellWrapper(template, store, list, "", {IgnoreList:true});
              }
            }

          const jsonstorage2 = document.getElementById('json-symbols');
          const store2 = JSON.parse(jsonstorage2.innerText)["storage"];

          const a = async () => {
            const assoc = await interpretate(store2, {hold:true});

            Object.keys(assoc).forEach(element => {

              core[element] = async (args, env) => {
                console.log('IE: calling our symbol...');
                if (env.root && !env.novirtual) core[element].instances[env.root.uid] = env.root;
                const data = await interpretate(core[element].data, env);
                return data;
              };
            
              core[element].update = async (args, env) => {
                const data = await interpretate(core[element].data, env);
                //if (env.hold) return ['JSObject', data];
                return data;
              }  
            
              core[element].destroy = async (args, env) => {
                delete core[element].instances[env.root.uid];
                console.warn(env.root.uid + ' was destroyed')
                console.warn('external symbol was destoryed');
              }                 

              core[element].virtual = true;
              core[element].instances = {};

              core[element].data = assoc[element];
            });
          }

           await a(store);            

          await process();

              const placeholderAnimation = [
                { opacity: "1" },
                { opacity: "0" },
              ];

              const placeholderTiming = {
                duration: 200,
                iterations: 1,
              };

              placeholder.animate(placeholderAnimation, placeholderTiming).finished.then(() => {
                placeholder.remove();
                sidebar.style.opacity = 1;
                container.style.filter = 'none';
              });</script></body></html>