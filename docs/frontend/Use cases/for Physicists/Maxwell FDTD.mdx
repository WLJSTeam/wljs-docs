# FDTD Method
Solving Maxwell's equation for 1D case with two interfaces.
Based on the work of __John B. Schneider__ *"Understanding the Finite-Difference Time-Domain Method"* 2023

import { WLJSHTML, WLJSEditor, WLJSStore } from "@site/src/components/wljs-notebook-react";



<WLJSStore kernel={require('./attachments/kernel-1884789149829811047.txt').default} json={require('./attachments/a35c2ef8-d4c1-48ec-baa4-a49e79739629.txt').default} notebook={require('./attachments/notebook-a35.wln').default}/>




Define constants

<WLJSEditor display={"codemirror"} nid={"a35c2ef8-d4c1-48ec-baa4-a49e79739629"} id={"b2c71039-0851-4297-b111-826bcb0d7bb9"} type={"Input"} opts={{}} >{`%CE%B6%20%3D%20377.0%3B%20%28%2ABB%5B%2A%29%28%2AOhm%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0Asize%20%3D%20400%3B%0A%0Aez%20%3D%20ConstantArray%5B0.%2C%20%7Bsize%7D%5D%3B%0Ahy%20%3D%20ConstantArray%5B0.%2C%20%7Bsize%7D%5D%3B%0A%0Ac%CE%BC%20%3D%20ConstantArray%5B%CE%B6%2C%20%20%20%7Bsize%7D%5D%3B%0Ac%CF%B5%20%3D%20ConstantArray%5B1.%2C%20%20%7Bsize%7D%5D%3B%0A%0A%28%2ABB%5B%2A%29%28%2ADefine%20a%20second%20medium%20with%20losses%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0A%0Ac%CF%B5%5B%5B200%3B%3B220%5D%5D%20%3D%20%28%2AFB%5B%2A%29%28%28%281%20-%200.001%29%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%28%281%20%2B%200.001%29%29%29%28%2A%5DFB%2A%29%3B%0Ac%CE%BC%5B%5B200%3B%3B220%5D%5D%20%3D%20%28%2AFB%5B%2A%29%28%28%CE%B6%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%289.0%29%29%28%2A%5DFB%2A%29%20%2F%20%281%20%2B%200.001%29%3B%0A%0Agenerator%20%3D%20With%5B%7Bie%20%3D%20size%7D%2C%20Compile%5B%7B%7Bsteps%2C%20_Integer%7D%7D%2C%0A%20%20%20%20Module%5B%0A%20%20%20%20%20%7Bez%20%3D%20ez%2C%20hy%20%3D%20hy%7D%2C%0A%20%20%20%20%20Do%5B%0A%0A%20%20%20%20%20%20%20%20%28%2ABB%5B%2A%29%28%2ACalculate%20magnetic%20field%20%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0A%20%20%20%20%20%20%20%20Do%5B%0A%20%20%20%20%20%20%20%20%20%20%20hy%5B%5Bj%5D%5D%20%2B%3D%20%28%2AFB%5B%2A%29%28%28%28ez%5B%5Bj%20%2B%201%5D%5D%20-%20ez%5B%5Bj%5D%5D%29%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%28%CE%B6%29%29%28%2A%5DFB%2A%29%3B%0A%20%20%20%20%20%20%20%20%2C%20%7Bj%2C%201%2C%20ie-1%7D%5D%3B%0A%0A%20%20%20%20%20%20%20%20%28%2ABB%5B%2A%29%28%2ABoundary%20conditions%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0A%20%20%20%20%20%20%20%20hy%5B%5Bie%5D%5D%20%3D%20hy%5B%5Bie-1%5D%5D%3B%0A%20%20%20%20%20%20%20%20ez%5B%5Bie%5D%5D%20%3D%20ez%5B%5Bie-1%5D%5D%3B%0A%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%28%2ABB%5B%2A%29%28%2APulse%20generator%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0A%20%20%20%20%20%20%20%20hy%5B%5B49%5D%5D%20-%3D%20Exp%5B-%20%28%2AFB%5B%2A%29%28%28%28%2ASpB%5B%2A%29Power%5B%28n%20-%2030.%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%292%5D%28%2A%5DSpB%2A%29%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%28100.%29%29%28%2A%5DFB%2A%29%5D%20%2F%20%CE%B6%3B%0A%0A%20%20%20%20%20%20%20%20ez%5B%5B1%5D%5D%20%3D%20ez%5B%5B2%5D%5D%3B%0A%0A%20%20%20%20%20%20%20%20%28%2ABB%5B%2A%29%28%2ACalculate%20electric%20field%20%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0A%20%20%20%20%20%20%20%20Do%5B%0A%20%20%20%20%20%20%20%20%20%20ez%5B%5Bj%5D%5D%20%3D%20c%CF%B5%5B%5Bj%5D%5D%20ez%5B%5Bj%5D%5D%20%2B%20c%CE%BC%5B%5Bj%5D%5D%20%28hy%5B%5Bj%5D%5D%20-%20hy%5B%5Bj%20-%201%5D%5D%29%0A%20%20%20%20%20%20%20%20%2C%20%7Bj%2C%202%2C%20ie%20-%201%7D%5D%3B%0A%0A%20%20%20%20%20%20%20%20%28%2ABB%5B%2A%29%28%2APulse%20generator%2A%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNhYGAo5gcSAUX5ZZkpqSn%2BBSWZ%2BXnFaYwgCS4g4Zyfm5uaV%2BKUXxEMUqxsbm6exgSSBPGCSnNSg9mAjOCSosy8dLBYSFFpKpoKkDkeqYkpEFXBILO1sCgJSczMQVYCAOFrJEU%3D%22%2A%29%28%2A%5DBB%2A%29%0A%20%20%20%20%20%20%20%20ez%5B%5B50%5D%5D%20%2B%3D%20Exp%5B-%20%28%2AFB%5B%2A%29%28%28%28%2ASpB%5B%2A%29Power%5B%28n%20%2B%200.5%20-%20%28-0.5%29%20-%2030.%29%28%2A%7C%2A%29%2C%28%2A%7C%2A%292%5D%28%2A%5DSpB%2A%29%29%28%2A%2C%2A%29%2F%28%2A%2C%2A%29%28100.0%29%29%28%2A%5DFB%2A%29%5D%3B%0A%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%2C%20%7Bn%2C%20steps%7D%5D%3B%20ez%5D%2C%0A%20%20%20%20CompilationOptions%20-%3E%20%7B%22InlineExternalDefinitions%22%20-%3E%20True%7D%2C%20%0A%20%20%20%20%22CompilationTarget%22%20-%3E%20%22C%22%2C%20%22RuntimeOptions%22%20-%3E%20%22Speed%22%5D%5D%3B`}</WLJSEditor>

Plot as a function of x-coordinate

<WLJSEditor display={"codemirror"} nid={"a35c2ef8-d4c1-48ec-baa4-a49e79739629"} id={"1e447640-f63e-4fe0-b9ee-f984bb86dc3e"} type={"Input"} opts={{}} >{`electricField%20%3D%20%7BRange%5B400%5D%2C%20generator%5B3%5D%7D%20%2F%2F%20Transpose%3B%0AGraphics%5B%0A%20%20Line%5BelectricField%20%2F%2F%20Offload%5D%2C%20%0A%20%20PlotRange-%3E%7B%7B0%2C400%7D%2C%20%7B-1%2C1%7D%7D%2C%20%0A%20%20TransitionDuration-%3E5%0A%5D`}</WLJSEditor>

<WLJSEditor display={"codemirror"} nid={"a35c2ef8-d4c1-48ec-baa4-a49e79739629"} id={"df33926b-ce9f-439a-8223-2ce663c28cd4"} type={"Output"} opts={{}} >{`%28%2AVB%5B%2A%29%28Graphics%5BLine%5BOffload%5BelectricField%5D%5D%2C%20PlotRange%20-%3E%20%7B%7B0%2C%20400%7D%2C%20%7B-1%2C%201%7D%7D%2C%20TransitionDuration%20-%3E%205%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxdTVsKAjEQqy%2FUD3%2B8gXcR9WNBKV6g7k41UFrpdO%2FhjTVFZHHnI5NkmGR3S9ZPjDE6J5xS6PysqhXhmN3zgVaHe4MoX7UknL0PyXW6IZcgbcloDxBGTH8Ptg%2Bia5JLSMW6eJfh1kDLvwK3wYsFI%2F%2FNQe0dJW9JrtlFRUGK%2Bz67urGg%2FQE7azJt%22%2A%29%28%2A%5DVB%2A%29`}</WLJSEditor>

Manipulate the time

<WLJSEditor display={"codemirror"} nid={"a35c2ef8-d4c1-48ec-baa4-a49e79739629"} id={"91140d9c-420b-48f1-b75e-99178d3770a5"} type={"Input"} opts={{}} >{`EventHandler%5BInputRange%5B1%2C800%2C10%2C10%5D%2C%20Function%5Bval%2C%20%0A%20%20electricField%20%3D%20%7BRange%5B400%5D%2C%20generator%5Bval%5D%7D%20%2F%2F%20Transpose%3B%0A%5D%5D`}</WLJSEditor>

<WLJSEditor display={"codemirror"} nid={"a35c2ef8-d4c1-48ec-baa4-a49e79739629"} id={"f1c8a9a0-814e-4d68-8daa-8d86610a5ce8"} type={"Output"} opts={{}} >{`%28%2AVB%5B%2A%29%28EventObject%5B%3C%7C%22Id%22%20-%3E%20%22c89daae1-37e8-42c0-8b1d-df9245dee993%22%2C%20%22Initial%22%20-%3E%2010%2C%20%22View%22%20-%3E%20%228f7a33e3-c23f-4773-9462-7d69117199b2%22%7C%3E%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKW6SZJxobpxrrJhsZp%2BmamJsb61qamBnpmqeYWRoamhtaWiYZAQB7JhTJ%22%2A%29%28%2A%5DVB%2A%29`}</WLJSEditor>