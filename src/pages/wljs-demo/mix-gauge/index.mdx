# Dynamic gauge
An example of advanced decoration, which supports changing data

import { WLJSHTML, WLJSEditor, WLJSStore } from "@site/src/components/wljs-reactcells";



<WLJSStore kernel={require('./attachments/kernel.txt').default} json={require('./attachments/223ddc85-d735-497a-8ee8-08e0b8c94360.txt').default} notebook={require('./attachments/notebook-223.wln').default}/>




Define

<WLJSEditor display={"codemirror"} nid={"223ddc85-d735-497a-8ee8-08e0b8c94360"} id={"b69441bf-22be-44d0-b2da-5b7075daac95"} type={"Input"} opts={{}} >{`gauge%20%2F%3A%20MakeBoxes%5Bg_gauge%2C%20StandardForm%5D%20%3A%3D%20ViewBox%5Bg%2C%20g%5D`}</WLJSEditor>

Now we need to implement the interpretation function on the frontend

<WLJSEditor display={"codemirror"} nid={"223ddc85-d735-497a-8ee8-08e0b8c94360"} id={"5bd603c7-d381-4824-b8d4-c16e256e545e"} type={"Input"} opts={{}} >{`.js%0A%0Acore.gauge%20%3D%20async%20%28args%2C%20env%29%20%3D%3E%20%7B%0A%20%20%0A%20%20%2F%2F%20Create%20a%20gauge%20meter%20element%0A%20%20const%20gauge%20%3D%20document.createElement%28%27div%27%29%3B%0A%20%20gauge.style.width%20%3D%20%27100px%27%3B%20%2F%2F%20half%20the%20original%20width%0A%20%20gauge.style.height%20%3D%20%2750px%27%3B%20%2F%2F%20half%20the%20original%20height%0A%20%20gauge.style.border%20%3D%20%271px%20solid%20%23000%27%3B%0A%20%20gauge.style.borderRadius%20%3D%20%2750px%2050px%200%200%27%3B%20%2F%2F%20adjusted%20for%20smaller%20size%0A%20%20gauge.style.position%20%3D%20%27relative%27%3B%0A%20%20gauge.style.background%20%3D%20%27linear-gradient%28to%20right%2C%20red%200%25%2C%20yellow%2050%25%2C%20green%20100%25%29%27%3B%0A%0A%20%20%2F%2F%20Create%20a%20needle%20for%20the%20gauge%0A%20%20const%20needle%20%3D%20document.createElement%28%27div%27%29%3B%0A%20%20needle.style.width%20%3D%20%272px%27%3B%0A%20%20needle.style.height%20%3D%20%2740px%27%3B%20%2F%2F%20made%20the%20needle%20longer%20for%20better%20visibility%0A%20%20needle.style.background%20%3D%20%27%23000%27%3B%0A%20%20needle.style.position%20%3D%20%27absolute%27%3B%0A%20%20needle.style.bottom%20%3D%20%270%27%3B%0A%20%20needle.style.left%20%3D%20%2750%25%27%3B%0A%20%20needle.style.transformOrigin%20%3D%20%27bottom%27%3B%0A%0A%20%20%2F%2F%20Function%20to%20set%20the%20needle%20position%20based%20on%20input%20value%0A%20%20function%20setNeedlePosition%28value%29%20%7B%0A%20%20%20%20%2F%2F%20Ensure%20value%20is%20between%200%20and%201%0A%20%20%20%20value%20%3D%20Math.max%280%2C%20Math.min%281%2C%20value%29%29%3B%0A%20%20%20%20%2F%2F%20Convert%20value%20to%20angle%0A%20%20%20%20const%20angle%20%3D%20value%20%2A%20180%20-%2090%3B%20%2F%2F%20-90%20to%2090%20degrees%0A%20%20%20%20needle.style.transform%20%3D%20%60rotate%28%24%7Bangle%7Ddeg%29%60%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Set%20initial%20needle%20position%0A%20%20const%20pos%20%3D%20await%20interpretate%28args%5B0%5D%2C%20env%29%3B%0A%20%20setNeedlePosition%28pos%29%3B%20%2F%2F%20Middle%20position%0A%20%20%0A%0A%20%20gauge.appendChild%28needle%29%3B%0A%0A%20%20env.element.appendChild%28gauge%29%3B%0A%20%20env.local.update%20%3D%20setNeedlePosition%3B%0A%7D%0A%0Acore.gauge.update%20%3D%20async%20%28args%2C%20env%29%20%3D%3E%20%7B%0A%20%20const%20val%20%3D%20await%20interpretate%28args%5B0%5D%2C%20env%29%3B%0A%20%20env.local.update%28val%29%3B%0A%7D%0A%0Acore.gauge.destroy%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20console.log%28%27Nothing%20to%20do%27%29%3B%0A%7D%0A%0Acore.gauge.virtual%20%3D%20true%3B`}</WLJSEditor>

<WLJSEditor display={"js"} nid={"223ddc85-d735-497a-8ee8-08e0b8c94360"} id={"622ce004-248c-4620-8783-4276bdf46ce0"} type={"Output"} opts={{}} >{`%0Acore.gauge%20%3D%20async%20%28args%2C%20env%29%20%3D%3E%20%7B%0A%20%20%0A%20%20%2F%2F%20Create%20a%20gauge%20meter%20element%0A%20%20const%20gauge%20%3D%20document.createElement%28%27div%27%29%3B%0A%20%20gauge.style.width%20%3D%20%27100px%27%3B%20%2F%2F%20half%20the%20original%20width%0A%20%20gauge.style.height%20%3D%20%2750px%27%3B%20%2F%2F%20half%20the%20original%20height%0A%20%20gauge.style.border%20%3D%20%271px%20solid%20%23000%27%3B%0A%20%20gauge.style.borderRadius%20%3D%20%2750px%2050px%200%200%27%3B%20%2F%2F%20adjusted%20for%20smaller%20size%0A%20%20gauge.style.position%20%3D%20%27relative%27%3B%0A%20%20gauge.style.background%20%3D%20%27linear-gradient%28to%20right%2C%20red%200%25%2C%20yellow%2050%25%2C%20green%20100%25%29%27%3B%0A%0A%20%20%2F%2F%20Create%20a%20needle%20for%20the%20gauge%0A%20%20const%20needle%20%3D%20document.createElement%28%27div%27%29%3B%0A%20%20needle.style.width%20%3D%20%272px%27%3B%0A%20%20needle.style.height%20%3D%20%2740px%27%3B%20%2F%2F%20made%20the%20needle%20longer%20for%20better%20visibility%0A%20%20needle.style.background%20%3D%20%27%23000%27%3B%0A%20%20needle.style.position%20%3D%20%27absolute%27%3B%0A%20%20needle.style.bottom%20%3D%20%270%27%3B%0A%20%20needle.style.left%20%3D%20%2750%25%27%3B%0A%20%20needle.style.transformOrigin%20%3D%20%27bottom%27%3B%0A%0A%20%20%2F%2F%20Function%20to%20set%20the%20needle%20position%20based%20on%20input%20value%0A%20%20function%20setNeedlePosition%28value%29%20%7B%0A%20%20%20%20%2F%2F%20Ensure%20value%20is%20between%200%20and%201%0A%20%20%20%20value%20%3D%20Math.max%280%2C%20Math.min%281%2C%20value%29%29%3B%0A%20%20%20%20%2F%2F%20Convert%20value%20to%20angle%0A%20%20%20%20const%20angle%20%3D%20value%20%2A%20180%20-%2090%3B%20%2F%2F%20-90%20to%2090%20degrees%0A%20%20%20%20needle.style.transform%20%3D%20%60rotate%28%24%7Bangle%7Ddeg%29%60%3B%0A%20%20%7D%0A%0A%20%20%2F%2F%20Set%20initial%20needle%20position%0A%20%20const%20pos%20%3D%20await%20interpretate%28args%5B0%5D%2C%20env%29%3B%0A%20%20setNeedlePosition%28pos%29%3B%20%2F%2F%20Middle%20position%0A%20%20%0A%0A%20%20gauge.appendChild%28needle%29%3B%0A%0A%20%20env.element.appendChild%28gauge%29%3B%0A%20%20env.local.update%20%3D%20setNeedlePosition%3B%0A%7D%0A%0Acore.gauge.update%20%3D%20async%20%28args%2C%20env%29%20%3D%3E%20%7B%0A%20%20const%20val%20%3D%20await%20interpretate%28args%5B0%5D%2C%20env%29%3B%0A%20%20env.local.update%28val%29%3B%0A%7D%0A%0Acore.gauge.destroy%20%3D%20%28%29%20%3D%3E%20%7B%0A%20%20console.log%28%27Nothing%20to%20do%27%29%3B%0A%7D%0A%0Acore.gauge.virtual%20%3D%20true%3B`}</WLJSEditor>

Let us test it!

<WLJSEditor display={"codemirror"} nid={"223ddc85-d735-497a-8ee8-08e0b8c94360"} id={"5958898b-27f8-4249-95d4-4b5f51596552"} type={"Input"} opts={{}} >{`gauge%5B0.3%5D`}</WLJSEditor>

<WLJSEditor display={"codemirror"} nid={"223ddc85-d735-497a-8ee8-08e0b8c94360"} id={"873c5fa4-8a3f-498a-8403-5df5df25c55f"} type={"Output"} opts={{}} >{`%28%2AVB%5B%2A%29%28gauge%5B0.3%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRAeK5BITyxNTy0yBoPL9gCxdwlI%22%2A%29%28%2A%5DVB%2A%29`}</WLJSEditor>


## Dynamics

<WLJSEditor display={"codemirror"} nid={"223ddc85-d735-497a-8ee8-08e0b8c94360"} id={"8970c1b1-37be-4de1-991b-6b5feb6fc5c7"} type={"Input"} opts={{}} >{`gvalue%20%3D%200.1%3B%0AEventHandler%5BInputRange%5B0%2C%201%2C%200.1%2C%200.1%5D%2C%20%28gvalue%20%3D%20%23%29%20%26%5D%0A%0Agauge%5Bgvalue%20%2F%2F%20Offload%5D`}</WLJSEditor>

<WLJSEditor display={"codemirror"} nid={"223ddc85-d735-497a-8ee8-08e0b8c94360"} id={"f2de3cb2-d728-47a1-953b-d917ec6a37a8"} type={"Output"} opts={{}} >{`%28%2AVB%5B%2A%29%28EventObject%5B%3C%7C%22Id%22%20-%3E%20%22779cc45c-7931-400c-a30b-10b1478d8fbd%22%2C%20%22Initial%22%20-%3E%200.1%2C%20%22View%22%20-%3E%20%2243a61dc6-e46a-46ab-a0e1-140f93d421a9%22%7C%3E%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRCeEJBwK8rPK3HNS3GtSE0uLUlMykkNVgEKmxgnmhmmJJvpppqYJeoCcZJuokGqoa6hiUGapXGKiZFhoiUAhbUVjw%3D%3D%22%2A%29%28%2A%5DVB%2A%29`}</WLJSEditor>

<WLJSEditor display={"codemirror"} nid={"223ddc85-d735-497a-8ee8-08e0b8c94360"} id={"e4f3e0de-88ef-415a-8f9d-0064144631f6"} type={"Output"} opts={{}} >{`%28%2AVB%5B%2A%29%28gauge%5BOffload%5Bgvalue%5D%5D%29%28%2A%2C%2A%29%28%2A%221%3AeJxTTMoPSmNkYGAoZgESHvk5KRAeK5BITyxNT4Vw2YGEf1paTn5iSjEbSKosMac0FQBuxw0r%22%2A%29%28%2A%5DVB%2A%29`}</WLJSEditor>